index,text
22330,in this paper the modified couple stress theory mcst is applied to study the effect of fluid surface waves on free vibration of a functionally graded fg microplate in interaction with bounded fluid the bounded fluid is considered inviscid irrotational and incompressible the fluid velocity potential which satisfies the boundary and compatibility conditions is applied to model the effect of bounded fluid assuming that the gradient of material properties varies through the thickness the classical plate theory has been employed to obtain the frequency equations of the fg microplate these equations are solved by rayleigh ritz method to determine the natural frequencies the frequencies are extracted for fg plates homogeneous microplates and fg microplates in vacuum and in interaction with bounded fluid where the microplate has been in interaction with bounded fluid influences of microplate bulging and fluid sloshing are captured both simultaneously and separately effects of plate dimensions fluid tank fluid type power law index and length scale parameter on natural frequencies of the system are presented and discussed in details for various boundary conditions results show that fluid surface waves significantly affect the natural frequencies of high flexible microplates keywords free vibration fg microplates surface waves modified couple stress theory bulging sloshing 1 introduction in recent years wide applications of micro structures have actuated the researchers to study the behavior of them systems such as thin films fu et al 2003 atomic force microscopes afms rahaeifard et al 2009 microplate spectrophotometers hotplate and micro nano electromechanical systems mems and nems witvrouw and mehta 2005 tunable micro nano mechanical resonators and paddle like resonators evoy et al 1999 are of the major applications of these structures in addition their applications in the medical associated industries such as microbiology singh 2009 radiology dilmanian et al 2008 and biotechnology filippini et al 2003 are noticeable experimental works suggest that behavior of structures in micro scale is different from macro scale this is due to the discontinuity of material in mico scale therefore the size effect in microstructures cannot be ignored fleck et al 1994 chong et al 2001 li et al 2003 while the classical theories ct may not predict the size effects in micro scale non classical continuum theories are formed to model the size effect by applying material length scale parameters several size dependent theories have been developed in continuum mechanics to model the size effects in micro and nano scales theories such as nonlocal elasticity theory eringen 1972 strain gradient theory lam et al 2003 couple stress theory mindlin and tiersten 1962 toupin 1962 and its modified version yang et al 2002 has been developed to model the behavior of structures in nano and micro scale the nonlocal elasticity theory eringen 1972 includes two material length scale parameters and the strain gradient theory lam et al 2003 includes three material length scale parameters the couple stress theory with two material length scale parameters was first introduced in researches performed by toupin 1962 mindlin and tiersten 1962 and koiter 1964 afterwards the modified couple stress theory in which one material length scale parameter is employed to analyze the micro structures has been developed by researchers e g yang et al 2002 hypotheses of shear deformation theories such as first order fsdt mindlin 1951 and third order tsdt reddy 1984 shear deformation theories make a more accurate estimation of the frequency for moderately thick and thick microplates this is due to the fact that transverse shear and rotary inertia effects are covered in these hypotheses however the equations of classical plate theory cpt chauchy 1828 poisson 1828 kirchoff 1850 result to simpler and acceptable estimation of the frequencies for moderately thick microplates on the other hand due to difficulties incurred by determination of the material length scale parameters the modified couple stress theory with one material length scale parameter has been popular hence application of the modified couple stress theory in displacement field of cpt leads to reduced equations with excluded unnecessary parameters in this way li yin yin et al 2010 employed modified couple stress theory for vibration analysis of kirchhoff microplate model tsiatas 2009 developed a new kirchhoff theory for the static analysis of a microplate using the cpt jomehzadeh et al 2011 developed a variational approach based on hamilton s principle to obtain the governing equations of motion in this work the basic hypothesis of the modified couple stress theory and cpt are utilized to study the vibrational behavior of microplates the modified couple stress theory and cpt were also employed by askari and tahani 2015 to obtain the natural frequency of microplates with clamped boundary conditions many researchers have been considered the influence of material gradient on vibrational behavior of microplates in various references the modified couple stress theory has been used to study the vibrational behavior of fgmp functionally graded micro plate the works performed by ma et al 2011 thai and choi 2013 thai and vo 2013 reddy and kim 2012 he et al 2015 salehipour et al 2015 ansari et al 2014 and lou and he 2015 are among these researches the study of fluid structure interaction of a flexible plate is an important problem in ocean engineering medical engineering and even biomechanics jobs including the design of artificial limbs of the body the tissues of the body in contact with the blood and blood dialysis machines due to addition of the kinetic and potential energies of the fluid natural frequencies of the plate in interaction with fluid are different from a plate in vacuum dealing with these problems it is important to consider the effects of immersing of the plate i e fully or partially and contacting of the fluid i e boundedly or boundless generally the works done in the field of dynamic behavior of plates in interaction with fluid are related to the macro plates comprehensive presentation of the fundamentals of fluid solid systems are provided in many references including refs morand 1995 moiseev and rumyantsev 1968 dodge 2000 vibration of elastic plate in contact with water was studied for the first time by lamb 1920 after that bathe bathe et al 1995 analyzed both incompressible and compressible fluid flows with free surface and structural interactions using finite element method using the rayleigh ritz method amabili 1996 studied the vibration of plates placed in a circular aperture of an infinite rigid wall in contact with an unbounded fluid of finite depth on one side using the finite element method natural frequencies and related mode shapes for a rectangular plate resting on an elastic foundation and partially in contact with a quiescent fluid were conducted by ugurlu et al uğurlu et al 2008 kozlovsky 2009 employed the lamb s model to analyze the vibration of plates in contact with viscous fluid zhou et al zhou and cheung 2000 investigated the vibration of a vertical rectangular plate in contact with water on one side in their work the effects of free surface waves compressibility of the water and the hydrostatic water pressure were neglected in the analysis bermudez et al bermúdez et al 2001 applied the finite element method to study the vibrations of a plate fluid system with interface damping liang et al 2001 presented a method to calculate the natural frequency of submerged cantilever plates based on an added mass formulation ergin and ugurlu ergin and uğurlu 2003 studied the dynamic characteristics of a vertical cantilever plate partially in contact with fluid hosseini hashemi et al analyzed the free vibration of rectangular mindlin plates with elastic foundations hosseini hashemi et al 2010 and without foundations hosseini hashemi et al 2012 in contact with stationary fluid by the ritz method khorshidi and farhadi khorshid and farhadi 2013 approximated the natural frequency of a laminated composite rectangular plate in contact with a bounded fluid by the third order shear deformation theory wet dynamic transverse displacements of the plate were approximated by a set of admissible trial functions which are required to satisfy the clamped and simply supported geometric boundary conditions the sloshing effects on natural frequency of thick functionally graded rectangular plates coupled with a bounded fluid were studied by khorshidi and bakhsheshy 2015 cho et al 2014 2015a obtained natural frequency of rectangular plates and stiffened panel structures in contact with fluid in another work they also studied cho et al 2015b frequency response of rectangular plate structures in contact with fluid subjected to harmonic point excitation force khorshidi et al 2017 performed theoretical and experimental studies of vibrating rectangular plates in contact with a bounded fluid by acoustic and modal tests canales et al canales and mantari 2017 presented an analytical solution for the free vibration analysis of thick rectangular composite plates in contact with a bounded fluid via unified formulation shahbaztabar et al shahbaztabar and ranji 2017 discussed the free vibration analysis of functionally graded plates on two parameter elastic supports in contact with stationary fluid in their paper the effect of free surface waves were not considered consideration of fluid sloshing is required to accurately analyze vibrational behavior of a flexible plate in contact with fluid the analysis of sloshing fluid behavior has been presented by researchers in various references previously the linear vibration analysis of sloshing fluids in interaction with elastic and rigid containers is done by ohayon et al ohayon and schotté 2017 felippa et al felippa and ohayon 1990 extracted the mixed variational formulation of finite element analysis of acoustoelastic slosh fluid structure interaction the analysis of fluid structure interactions in an elastic tank partially filled with an incompressible inviscid liquid was done by schotte et al schotté and ohayon 2005 faltinsen et al faltinsen and timokha 2012 obtained velocity potential for the liquid sloshing problem in a two dimensional circular tank ikeda et al 2012 presented the nonlinear responses of sloshing in a rigid square tank subjected to obliquely horizontal harmonic excitation elahi et al 2015 simulated the liquid sloshing in 2d containers using the volume of fluid method in sloshing fluid related researches the focus has usually been on fluid flow analysis and the effect of sloshing fluid on the natural frequency of plate has not usually been investigated the only research on the vibration analysis of the microplate in interaction with fluid is performed by omiddezyani et al 2018 in their work the plate is assumed to be isotropic and homogeneous while simultaneous effects of the bulging and sloshing modes were considered the distinct effect of sloshing and bulging modes were not studied indeed gradient of material has significant effect on natural frequencies of a microplate the literature survey shows that free vibration of non homogenous microplates in interaction with bounded fluid has not been studied so the innovation of this paper is mainly reflected in the following two aspects first the modified couple stress theory is developed to study the size dependent effects on natural frequencies of a microplate made of functionally graded materials in interaction with slushing fluid second unlike the most previous studies this paper separately studies effects of sloshing and bulging modes on natural frequencies of a microplate applying the modified couple stress theory the classical theory of thin plates is developed into micro scale and size dependent natural frequencies of the fgmp has been captured mechanical properties of the plate are non homogeneous through the thickness and obey the rule of mixture employing the principle of superposition and using the separation of variables method the fluid velocity potential function is calculated for the bulging and sloshing modes then the ritz method is used and the polynomial functions are expanded to determine the natural frequencies of the fgmp finally effects of various parameters on natural frequencies of the functionally graded microplate fgmp are presented and discussed in detail for a variety of boundary conditions 2 functionally graded microplate model figure 1 shows the side view of a rectangular fg microplate geometry in interaction with bounded fluid mechanical properties of the plate is graded through its thickness the origin of the coordinate system is located at left side of the plate where the material of the plate is assumed to be fully ceramic right side of the plate is fully metal dimension of the plate along the length width and height directions of the plate are shown by a b and h respectively depth of the tank is b 1 and the width is shown by c according to the volume fraction ratio law the variation of material properties of the plate through its thickness is 1 e z e c e m v m e m 2 ρ z ρ c ρ m v m ρ m where e is the young modulus α is the power law index and ρ is the density of the plate moreover c and m denote ceramic and metallic material properties respectively the metal volume fraction is obtained from the following equation 3 v m z h α 3 theoretical formulation 3 1 modified couple stress model based on the modified couple stress theory the strain energy in an fg microplate is 4 π s 1 2 λ σ ε m χ d λ where σ is the cauchy stress tensor definitions of infinitesimal strain tensor ε symmetric curvature tensor χ and deviatoric part of the stress couple tensor m are 5 ε i j 1 2 u i j u j i 6 χ i j 1 2 θ i j θ j i 7 σ i j υ e z 1 υ 1 2 υ ε m m δ i j e z 1 υ ε i j 8 m i j e z 1 υ l 2 χ i j in eq 5 through 8 u is the displacement field μ is the shear modulus and l is the material length scale parameter the rotation vector θ is 9 θ i 1 2 ε i j k u k j 3 2 the classical plate theory based on the classical plate theory cpt the displacement field u 1 u 2 and u 3 along the x y and z directions is defined as follows 10 u 1 x y z t u x y t z h 2 w x y t x u 2 x y z t v x y t z h 2 w x y t y u 3 x y z t w x y t in eq 10 u and v are in plane displacements and w is transverse deflection of the mid surface of the plate the nonzero components of the infinitesimal strain tensor are 11 ε x ε x 0 z h 2 k x ε y ε y 0 z h 2 k y γ x y γ x y 0 z h 2 k x y wherein definition of mid surface strain components ε x 0 ε y 0 γ x y 0 and the mid surface curvatures k x k y and k x y are ε x 0 u x ε y 0 v y γ x y 0 u y v x 12 k x 2 w x 2 k y 2 w y 2 k x y 2 2 w x y the constitutive equations of isotropic nonhomogeneous materials with through thickness gradient of the material are 13 σ x x σ y y σ x y e z 1 υ 2 υ e z 1 υ 2 0 υ e z 1 υ 2 e z 1 υ 2 0 0 0 e z 2 1 υ ε x x ε y y γ x y components of the rotation vector are determined by substituting eq 10 into eq 9 14 θ x 1 2 u 3 y u 2 z w y θ y 1 2 u 1 z u 3 x w x θ z 1 2 u 2 x u 1 y 1 2 v x u y equation 6 is rewritten in expanded form as follows 15 χ x x θ x x χ y y θ y y χ z z θ z z χ x y 1 2 θ x y θ y x χ x z 1 2 θ x z θ z x χ y z 1 2 θ y z θ z y substituting eq 14 in eq 15 results 16 χ x x 2 w x y χ y y 2 w x y χ x y 1 2 2 w y 2 2 w x 2 χ x z 1 4 2 v x 2 2 u y x χ y z 1 4 2 v x y 2 u y 2 the total elastic strain energy u p of a thin fg micro late may be written as follows 17 u p 1 2 0 a 0 b h 2 h 2 σ x x ε x x σ y y ε y y τ x y γ x y m x x χ x x m y y χ y y 2 m x y χ x y 2 m x z χ x z 2 m y z χ y z d z d y d x equations 8 12 13 and 16 corresponding to deviatoric part of stress couple tensor components of mid surface stain and curvature constitutive equations and curvature tensor are substituted into eq 17 to get the total elastic strain energy that is 18 u p 1 2 0 a 0 b n x x u x h 2 2 w x 2 n y y v y h 2 2 w y 2 n x y u y v x 2 h 2 2 w x y m x x 2 w x 2 m y y 2 w y 2 2 m x y 2 w x y y x x 2 w x y y y y 2 w x y y x y 2 w y 2 2 w x 2 y x z 2 2 v x 2 2 u y x y y z 2 2 v x y 2 u y 2 d y d x where 19 n x x h 2 h 2 σ x x d z n y y h 2 h 2 σ y y d z n x y h 2 h 2 σ x y d z m x x h 2 h 2 σ x x z d z m y y h 2 h 2 σ y y z d z m x y h 2 h 2 σ x y z d z 20 y x x h 2 h 2 m x x d z y y y h 2 h 2 m y y d z y x y h 2 h 2 m x y d z y x z h 2 h 2 m x z d z y y z h 2 h 2 m y z d z the kinetic energy t p of the fg microplate is 21 t p 1 2 0 a 0 b h 2 h 2 ρ z u 1 2 u 2 2 u 3 2 d z d y d x in eq 21 overdot denotes time derivative the admissible trial displacement functions may be expressed by the following series of algebraic polynomials 22 u x y t θ u x y m 1 n 1 n 1 m a m n t x m y m n e i ω t v x y t θ v x y m 1 n 1 n 1 m b m n t x m y m n e i ω t w x y t θ w x y m 1 n 1 n 1 m c m n t x m y m n e i ω t where t is the time ω denotes the natural frequency of the system and parameters m and n are the number of half waves in x and y directions respectively coefficients of admissible trial functions θ u θ v and θ w are called fundamental functions these functions satisfy the boundary conditions for various types of boundary conditions considered in the present study the fundamental functions are listed in table 1 4 formulation of the fluid oscillations the fluid is assumed to be inviscid irrotational and incompressible applying the principle of superposition the fluid velocity potential φ o is split as follows 23 φ o φ b φ s where φ b denotes the velocity potential of the fluid due to the plate bulging effect and φ s is the velocity potential due to the fluid sloshing in presence of the rigid plate the fluid velocity potential can be separated into a spatial velocity potential and a harmonic time function as follows 24 φ o x y z t φ o x y z exp i ω t the velocity potential φ o satisfies the following laplace equation 25 2 φ o 0 employing the principle of superposition laplace equation is represented as follows 26 2 φ b 2 φ s 0 the velocity of the fluid must be zero at rigid walls of the tank on the other hand the velocity components are defined by potential function φ that is v x φ x v y φ y and v z φ z therefore boundary conditions on bottom and vertical rigid walls of the tank are 27 φ b x x 0 a 0 φ b y y 0 0 φ b z z c 1 0 φ s x x 0 a 0 φ s y y 0 0 φ s z z c 0 the free surface boundary condition is 28 φ b y b 1 0 the condition for the surface between the elastic plate surface and the peripheral fluid layer is 29 φ b z z o w x y t t now according to boundary conditions 27 and 28 the separation of variable method is employed to obtain the general solution of eq 26 that is 30 φ b x y z t l 0 k 0 e l k t cos l π x a cos 2 k 1 π y 2 b 1 e π l a 2 2 k 1 2 b 1 2 z e π l a 2 2 k 1 2 b 1 2 2 c 1 z for l k 0 1 2 0 x a 0 y b 1 0 z c 1 31 φ s x y z t i 0 n s j 0 m s d i j t cos i π x a cosh π i a 2 j c 1 2 y cos j π z c 1 f o r i j 0 1 2 0 x a 0 y b 1 0 z c 1 where l 2 and k 2 are arbitrary nonnegative integers and d i j t is the unknown coefficient imposing the boundary condition given in eq 29 the coefficient e l k t is determined as follows 32 e l k t c o f f 1 a b 1 0 a 0 b 1 w x y t cos l π x a cos 2 k 1 π y 2 b 1 d y d x π l a 2 2 k 1 2 b 1 2 1 exp 2 c π l a 2 2 k 1 2 b 1 2 c o f f 1 1 i f l a n d k 0 2 i f l o r k 0 4 i f l k 0 now assume that the kinetic energy of the fluid with respect to plate bulging and fluid sloshing is denoted by t f b and t f s respectively with the aid of kinetic energy definition these energies are appeared in the following form 33 t f b 1 2 ρ f 0 a 0 b 1 φ b z 0 w t d y d x 34 t f s 1 2 ρ f 0 a 0 b 1 φ s z 0 w t d y d x the linear sloshing conditions at the fluid free surface of the tank is amabili 2000 35 φ o y y b 1 ω 2 g φ o y b 1 where g is the gravity acceleration substituting eq 23 into eq 35 and using eq 28 one obtains 36 φ b y y b 1 φ s y y b 1 ω 2 g φ s y b 1 multiplying both sides of eq 36 by ρ f φ s then integrating them over the free surface of the fluid in the tank leads 37 u φ b u φ s ω 2 t φ s where 38 u φ b ρ f 0 a 0 c φ s φ b y y b 1 d z d x u φ s ρ f 0 a 0 c φ s φ s y y b 1 d z d x t φ s ρ f g 0 a 0 c φ s 2 y b 1 d z d x u φ b and u φ s are potential energies of the fluid with respect to plate bulging and fluid sloshing 5 solution procedure the lagrangian function for the plate fluid system is written as follows 39 π u max t max where t max is sum of the kinetic energies defined by eqs 21 33 and 34 the term u max is the strain energy of the plate given by eq 18 applying the ritz method the eigenvalue equation is derived 40 π q 0 where q a m n b m n c m n d i j t is the vector of unknown time variable coefficients applied in admissible trial functions following the minimization of eq 39 the subsequent equation is obtained by the assumption of undamped plate and inviscid fluid 41 k p ξ m n ω 2 m p m f b ξ m n m f s d i j 0 where ξ m n a m n b m n c m n t and 42 k p 2 u p q i q j m p 2 t p q i q j m f b 2 t f b q i q j m f s 2 t f s q i q j equation 41 cannot be solved without determination of d i j thus eq 37 is added to equation 41 this increases the dimensions of the associated eigenvalue problem from n n to n n n n where n is the dimension of the coordinates vector c m n t and n is the dimension of coordinates vector d i j t consequently the following galerkin equation is obtained 43 k p 0 k φ b k φ s ξ m n d i j ω 2 m p m f b m f s 0 m φ s ξ m n d i j 0 where 44 k φ b 2 u φ b q i q j k φ s 2 u φ s q i q j m φ s 2 t φ s q i q j 6 numerical results 6 1 comparison studies the following normalized parameters are defined for plate and fluid system 45 δ b h ς a b η b 1 b λ c b ξ ρ f ρ w where ρ f is the fluid density and ρ w is density of the pure water also by dividing the frequency values into sloshing and bulging modes the following normalized parameters are defined 46 e s ω s l o s h i n g ω v a c u u m e b ω b u l g i n g ω where ω v a c u u m is natural frequency of the plate in vacuum and we recall it as vacuum mode for the case which the effect of free surface waves is neglected i e bulging mode the natural frequency of the plate due to oscillation of the liquid is denoted by ω b u l g i n g natural frequency of the plate due to oscillation of the liquid free surface i e sloshing mode is denoted by ω s l o s h i n g for the case which the combined effect of sloshing and bulging is considered the coupled fluid structure natural frequency of the plate is denoted by ω and we recall it as coupled mode the parameter e s expresses sloshing frequency ratio and e b expresses bulging frequency ratio setting the material length scale parameter to zero the microplate is simplified to a macroplate and natural frequencies of current work are compared with ref bermúdez et al 2001 for an rectangular plate table 2 represents the first normalized frequency parameter ω a 2 ω v a c u u m ρ p h d of the bulging mode of a rectangular macroplate in interaction with fluid d e h 3 12 1 ν 2 is flexural rigidity e is young modulus and ν is poisson s ratio in this table results of the current work is compared with ref hosseini hashemi et al 2010 for various η ς and boundary conditions i e ssss scsc and cccc the material properties applied to determine given values of this table are e 207 gpa δ 100 ν 0 3 and ξ 0 1274 as table 2 shows that data of current work and ref hosseini hashemi et al 2010 are in close agreement table 3 represents the first five natural frequency parameter ω of the bulging mode of a rectangular homogenous macro plate in interaction with fluid the results of current work in bulging mode is compared with refs zhou and cheung 2000 and hosseini hashemi et al 2010 for various boundary conditions the macro plate data are ξ 0 1274 δ 20 ς 0 5 and η 1 as it can be seen from this table a good agreement between current work and refs zhou and cheung 2000 and hosseini hashemi et al 2010 is achieved to determine the natural frequencies of the macro plate the classical plate theory cpt and mindlin plate theory has been used in refs zhou and cheung 2000 and hosseini hashemi et al 2010 respectively table 4 compares the first natural frequencies ω ω v a c u u m a 2 h ρ c e c of an fg simply supported microplate between the current work and ref thai and kim 2013 for various values of length scale parameter to thickness ratio l h the natural frequencies in this table are obtained for a plate made of a mixture of aluminum al and alumina al2o3 with material properties listed in table 5 the length scale parameter and thickness ratio are l 17 6 μ m and a h 100 respectively and the poisson s ratio is assumed to be constant through the thickness of the plate represented data in table 4 are in close agreement with ref thai and kim 2013 in figs 2 and 3 the first frequency of the macroplate in contact with the sloshing water obtained in present study is compared with the experimental data of ref khorshidi et al 2017 the clamped boundary conditions is assumed on four sides of the plate the assumptions are h 1 10 3 m a 0 4 m b 0 293 m and c 0 4 m fig 1 shows the results for the aluminum plate e 69 gpa ρ 2700 k g m 3 ν 0 3 and fig 2 shows the results for the stainless steel plate e 210 gpa ρ 7800 k g m 3 ν 0 3 as it can be seen from figs 1 and 2 the results obtained by present method are in good agreement with the experimental data 6 2 parameter studies assuming an fg microplate with material properties given in table 5 this section performs a parameter study on natural frequencies of the fg microplate in interaction with fluid table 6 shows the convergence of the present method for simplify supported fg microplate in interaction with fluid the three first natural frequency have been obtained for the values of λ 0 1 α 100 ξ 1 ς 1 h l 1 and δ 100 based on the represented data in table 6 a 78 dof degrees of freedom model is suggested to calculate the natural frequency values of an fg microplate in interaction with fluid table 7 lists frequency parameter ω of an fg microplate in interaction with fluid for various modes the microplate data are λ 0 1 α 10 ξ 1 ς 1 h l 3 and η 1 this table shows that the numerical value of the frequency parameter ω for sloshing mode is higher than vacuum mode but this difference is slight and this trend increases slightly with increasing the density and thickness ratios while this behavior is reversed for the bulging mode and the frequency parameter for this mode has severe drop in comparison with vacuum mode this trend is intensified by increasing the density and thickness ratios considering that the natural frequency of the coupled fluid structure system is simultaneously affected by bulging and sloshing modes and the influence of the bulging mode is dominant to sloshing mode the frequency parameter for bulging mode is less than the vacuum mode in fig 4 natural frequencies of an fg microplate with simply supported boundary conditions ssss obtained from modified couple stress theory mcst are compared with classical theory for vacuum i e absence of fluid and coupled i e fluid sloshing and plate bulging modes parameters of the microplate for curves plotted in this figure are δ 150 η 1 ς 0 1 α 1 and ξ 1 due to addition of the fluid kinetic energy in coupled mode the natural frequencies in this mode are lower than those of the vacuum mode this figure shows that increasing the length scale parameter ratio reduces the natural frequency of the fg microplate also the figure shows that the differences between natural frequencies of the classical and modified couple stress theories increase with decreasing the length scale parameter ratio the difference between theories are negligible for h l 4 for h l 1 natural frequencies obtained from modified couple stress theory are more than twice those of the classical theory fig 5 represents the effect of boundary condition on the first coupled mode natural frequency of the fg microplate in interaction with fluid the plate parameters in this figure are δ 100 η 1 λ 0 1 α 2 ς 1 and ξ 1 the figure shows that the coupled mode natural frequencies of the microplate for clamped boundary conditions cccc are higher than simply supported boundary conditions ssss for all length scale parameter ratios this is due to higher rigidity of the miroplate with clamped boundary conditions cccc also the difference between the coupled mode natural frequencies of the microplate for simply supported and clamped boundary conditions decreases by increasing the length scale parameter ratio effect of material gradient thorough the thickness of the plate is studied in fig 6 in this figure the first coupled mode natural frequency of an fg microplate is plotted for various length scale parameter ratios h l power law index and boundary conditions the microplate parameters are δ 100 η 1 λ 0 1 ς 1 and ξ 1 increasing the power law index reduces the percent of ceramic and increases the metal contents therefore the stiffness of the microplate reduces and this eventually leads to a decrease in coupled mode natural frequency effect of the fluid depth ratio i e η b 1 b is revealed in figs 7 through 9 for various thickness ratio i e δ b h the microplate parameters are λ 0 1 α 2 ς 1 h l 1 and ξ 13 58 and the thickness ratio δ is 1000 100 and 60 for figs 7 through 9 respectively since the stiffness of the plate improves by clamping the edges of the plate the coupled mode natural frequency of the microplate with cccc boundary condition is higher than the ssss boundary condition on the other hand comparison of these three figures indicates that variation of natural frequency is negligible for lower fluid depth ratio for example in fig 9 where the thickness ratio is δ 60 i e thin plate the natural frequency is constant for η 0 5 and this is η 0 2 for δ 1000 i e very thin plate in fig 7 the reason is that reduction of the plat thickness ratio eventuates to domination of kinetic energy and potential energy of the fluid and the change in fluid depth ratio will not effect on the coupled mode natural frequency of the microplate as the consequence effect of fluid density ratio on first coupled mode natural frequency of the fg microplate with simply supported boundary conditions ssss is shown in fig 10 for various fluid depth ratios the fg microplate parameters are δ 200 λ 0 1 ς 1 and α 10 according to this figure the coupled mode natural frequency of the fg microplate decreases for fluids with higher densities figs 11 and 12 study the effect of the tank width ratio λ c b on the first coupled mode natural frequency of the fg microplate fig 11 is plotted for various length scale parameter ratios and fig 12 is plotted for various fluid depth ratio these figures are plotted based on the following data δ 100 α 2 η 1 ς 1 and ξ 1 both figures indicate that increase in tank width ratio leads to higher natural frequencies this increase is negligible for λ 1 figure 13 depicts variation of sloshing frequency ratio of the fg microplate as a function of power law index α for various boundary conditions the microplate parameters are δ 600 η 1 α 2 h l 4 λ 0 1 ς 1 and ξ 13 58 this figure shows that the sloshing frequency ratio corresponding to ssss boundary conditions i e the plate with higher flexibility is higher than the two other boundary conditions according to definition of sloshing frequency ratio e s ω s l o s h i n g ω v a c u u m the interpretation is that the sloshing effect is more noticeable in flexible plates since the higher value of power law index is identical to increase in flexibility of the microplate the sloshing frequency ratio is raised by increasing the power law index effect of the thickness ratio on the sloshing frequency ratio e s for various density ratios length scale parameter ratios h l and boundary conditions are illustrated in figs 14 and 15 according to definition of e s the curves indicate that microplates with higher thickness are less affected by sloshing this is in coherence with previous conclusion that flexibility of the plates raises the natural frequency of the sloshing mode figs 16 and 17 demonstrate effects of the thickness ratio and density ratio on the bulging frequency ratio e b for various length scale parameter ratios h l and boundary conditions respectively the assumptions in these figures are η 1 λ 0 1 α 100 and ς 1 from fig 16 it is found that higher thickness ratios reduces the bulging frequency ratio figure 18 compares the natural frequency of the simply supported fg microplate in sloshing mode with vacuum for various fluid depth ratios power law indexes and density ratios the plate data are h l 5 λ 0 1 ς 1 for figs 18 a through 18 d the value of thickness ratio δ is 100 300 600 and 1000 respectively the figures show that higher thickness ratio increases the flexibility of the microplate and decreases the natural frequency of the fg microplate these figures show that the sloshing effect is tangible for δ 300 the case which natural frequency of fg microplate is very low moreover the natural frequency of the microplate in sloshing mode increases with tank height for δ 300 figure 19 compares the natural frequency of the fg microplate in bulging mode with coupled mode for various fluid depth ratios and density ratios the plate data are h l 5 λ 0 1 α 100 and ς 1 the bulging effect adds the fluid mass matrix i e resulted from the kinetic energy of the fluid to the eigenvalue problem therefore the bulging effect reduces the natural frequency of the microplate but the interpretation for effect of sloshing fluid is slightly different fig 18 the sloshing fluid adds both fluid mass matrices and stiffness matrices resulted from the potential energy of the fluid to the eigenvalue problem the results show that effect of the sloshing fluid on stiffness matrix is predominant so the sloshing fluid increases the natural frequency of the microplate eventually consideration of both fluid sloshing and plate bulging show that the effect of bulging mode is greater than sloshing mode and the natural frequency of the couple mode decreases with increasing fluid depth ratio 7 conclusion the effect of the sloshing and bulging modes on natural frequencies of the fg microplate in interaction with bounded fluid is studied separately to study the size dependent effects of microplate on natural frequencies results based on the modified couple stress theory is compared with classical theory the fluid velocity potential is employed to calculate the fluid kinetic energy defining the potential and kinetic energies of the microplate and the sloshing fluid and applying the ritz method natural frequencies of the fg microplate are extracted simplifying the plate conditions results are validated against the data given in the literature in summary the following conclusions are obtained based on the results obtained in this paper 1 the classical theory does not provide a proper interpretation of the frequency of the plates for thickness to length ratios higher than four 2 increase in the length scale parameter ratio leads to reduction of the natural frequencies 3 the coupled mode natural frequencies are reduced for higher fluid depth ratio and power law index 4 increasing the tank width ratio increases the coupled mode natural frequencies 5 at the same condition the natural frequencies in sloshing mode are close to the vacuum mode and their corresponding values are higher than those of vacuum mode 6 at the same conditions the natural frequencies in bulging mode are close to the natural frequency in the coupled mode and their corresponding values are smaller than the coupled mode this is due to addition of the sloshing effect in coupled mode 7 the effect of fluid sloshing on natural frequencies of the microplate is tangible for the thickness ratios higher than 300 8 due to high rigidity of the plate with cccc boundary conditions natural frequencies of the microplate for this boundary conditions are higher than other boundary conditions 9 increasing the density and thickness ratios increases the natural frequency values in sloshing mode and reduces the natural frequency values of coupled mode and bulging mode declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper nomenclature a microplate length b microplate width b 1 fluid depth c fluid width d flexural rigidity e c elasticity modulus of ceramic e m elasticity modulus of metal e s sloshing frequency ratio e b bulging frequency ratio g acceleration of gravity h microplate thickness l length scale parameter m deviatoric part of the stress couple tensor n s m s the number of terms in sloshing series n 1 the number of terms in displacement t p kinetic energy of the microplate t f b kinetic energy of the fluid due to the plate bulging effect t f s kinetic energy of the fluid due to the fluid sloshing t m a x maximum kinetic energy of the coupled mode t time u p strain energy of the microplate u φ b potential energy of the fluid due to the plate bulging effect u φ s potential energy of the fluid due to the fluid sloshing u max maximum strain energy of the coupled mode u in plane displacements along x axis v in plane displacements along y axis v m metal volume fraction w transverse displacement of mid plane surface x y z coordinates of system φ fluid potential velocity φ b velocity potential of the fluid due to the plate bulging effect φ s velocity potential of the fluid due to the fluid sloshing θ fundamental function ω s l o s h i n g natural frequency of the plate in sloshing mode ω b u l g i n g natural frequency of the plate in bulging mode ω v a c u u m natural frequency of the plate in vacuum mode ω natural frequency of the plate in coupled mode 2 laplace operator ω ω dimensionless natural frequency α power law index δ thickness ratio ρ c density of ceramic ρ m density of metal ε strain tensor σ stress tensor θ rotation vector η fluid depth ratio υ poisson s ratio χ symmetric curvature tensor ξ density ratio ς aspect ratio 
22330,in this paper the modified couple stress theory mcst is applied to study the effect of fluid surface waves on free vibration of a functionally graded fg microplate in interaction with bounded fluid the bounded fluid is considered inviscid irrotational and incompressible the fluid velocity potential which satisfies the boundary and compatibility conditions is applied to model the effect of bounded fluid assuming that the gradient of material properties varies through the thickness the classical plate theory has been employed to obtain the frequency equations of the fg microplate these equations are solved by rayleigh ritz method to determine the natural frequencies the frequencies are extracted for fg plates homogeneous microplates and fg microplates in vacuum and in interaction with bounded fluid where the microplate has been in interaction with bounded fluid influences of microplate bulging and fluid sloshing are captured both simultaneously and separately effects of plate dimensions fluid tank fluid type power law index and length scale parameter on natural frequencies of the system are presented and discussed in details for various boundary conditions results show that fluid surface waves significantly affect the natural frequencies of high flexible microplates keywords free vibration fg microplates surface waves modified couple stress theory bulging sloshing 1 introduction in recent years wide applications of micro structures have actuated the researchers to study the behavior of them systems such as thin films fu et al 2003 atomic force microscopes afms rahaeifard et al 2009 microplate spectrophotometers hotplate and micro nano electromechanical systems mems and nems witvrouw and mehta 2005 tunable micro nano mechanical resonators and paddle like resonators evoy et al 1999 are of the major applications of these structures in addition their applications in the medical associated industries such as microbiology singh 2009 radiology dilmanian et al 2008 and biotechnology filippini et al 2003 are noticeable experimental works suggest that behavior of structures in micro scale is different from macro scale this is due to the discontinuity of material in mico scale therefore the size effect in microstructures cannot be ignored fleck et al 1994 chong et al 2001 li et al 2003 while the classical theories ct may not predict the size effects in micro scale non classical continuum theories are formed to model the size effect by applying material length scale parameters several size dependent theories have been developed in continuum mechanics to model the size effects in micro and nano scales theories such as nonlocal elasticity theory eringen 1972 strain gradient theory lam et al 2003 couple stress theory mindlin and tiersten 1962 toupin 1962 and its modified version yang et al 2002 has been developed to model the behavior of structures in nano and micro scale the nonlocal elasticity theory eringen 1972 includes two material length scale parameters and the strain gradient theory lam et al 2003 includes three material length scale parameters the couple stress theory with two material length scale parameters was first introduced in researches performed by toupin 1962 mindlin and tiersten 1962 and koiter 1964 afterwards the modified couple stress theory in which one material length scale parameter is employed to analyze the micro structures has been developed by researchers e g yang et al 2002 hypotheses of shear deformation theories such as first order fsdt mindlin 1951 and third order tsdt reddy 1984 shear deformation theories make a more accurate estimation of the frequency for moderately thick and thick microplates this is due to the fact that transverse shear and rotary inertia effects are covered in these hypotheses however the equations of classical plate theory cpt chauchy 1828 poisson 1828 kirchoff 1850 result to simpler and acceptable estimation of the frequencies for moderately thick microplates on the other hand due to difficulties incurred by determination of the material length scale parameters the modified couple stress theory with one material length scale parameter has been popular hence application of the modified couple stress theory in displacement field of cpt leads to reduced equations with excluded unnecessary parameters in this way li yin yin et al 2010 employed modified couple stress theory for vibration analysis of kirchhoff microplate model tsiatas 2009 developed a new kirchhoff theory for the static analysis of a microplate using the cpt jomehzadeh et al 2011 developed a variational approach based on hamilton s principle to obtain the governing equations of motion in this work the basic hypothesis of the modified couple stress theory and cpt are utilized to study the vibrational behavior of microplates the modified couple stress theory and cpt were also employed by askari and tahani 2015 to obtain the natural frequency of microplates with clamped boundary conditions many researchers have been considered the influence of material gradient on vibrational behavior of microplates in various references the modified couple stress theory has been used to study the vibrational behavior of fgmp functionally graded micro plate the works performed by ma et al 2011 thai and choi 2013 thai and vo 2013 reddy and kim 2012 he et al 2015 salehipour et al 2015 ansari et al 2014 and lou and he 2015 are among these researches the study of fluid structure interaction of a flexible plate is an important problem in ocean engineering medical engineering and even biomechanics jobs including the design of artificial limbs of the body the tissues of the body in contact with the blood and blood dialysis machines due to addition of the kinetic and potential energies of the fluid natural frequencies of the plate in interaction with fluid are different from a plate in vacuum dealing with these problems it is important to consider the effects of immersing of the plate i e fully or partially and contacting of the fluid i e boundedly or boundless generally the works done in the field of dynamic behavior of plates in interaction with fluid are related to the macro plates comprehensive presentation of the fundamentals of fluid solid systems are provided in many references including refs morand 1995 moiseev and rumyantsev 1968 dodge 2000 vibration of elastic plate in contact with water was studied for the first time by lamb 1920 after that bathe bathe et al 1995 analyzed both incompressible and compressible fluid flows with free surface and structural interactions using finite element method using the rayleigh ritz method amabili 1996 studied the vibration of plates placed in a circular aperture of an infinite rigid wall in contact with an unbounded fluid of finite depth on one side using the finite element method natural frequencies and related mode shapes for a rectangular plate resting on an elastic foundation and partially in contact with a quiescent fluid were conducted by ugurlu et al uğurlu et al 2008 kozlovsky 2009 employed the lamb s model to analyze the vibration of plates in contact with viscous fluid zhou et al zhou and cheung 2000 investigated the vibration of a vertical rectangular plate in contact with water on one side in their work the effects of free surface waves compressibility of the water and the hydrostatic water pressure were neglected in the analysis bermudez et al bermúdez et al 2001 applied the finite element method to study the vibrations of a plate fluid system with interface damping liang et al 2001 presented a method to calculate the natural frequency of submerged cantilever plates based on an added mass formulation ergin and ugurlu ergin and uğurlu 2003 studied the dynamic characteristics of a vertical cantilever plate partially in contact with fluid hosseini hashemi et al analyzed the free vibration of rectangular mindlin plates with elastic foundations hosseini hashemi et al 2010 and without foundations hosseini hashemi et al 2012 in contact with stationary fluid by the ritz method khorshidi and farhadi khorshid and farhadi 2013 approximated the natural frequency of a laminated composite rectangular plate in contact with a bounded fluid by the third order shear deformation theory wet dynamic transverse displacements of the plate were approximated by a set of admissible trial functions which are required to satisfy the clamped and simply supported geometric boundary conditions the sloshing effects on natural frequency of thick functionally graded rectangular plates coupled with a bounded fluid were studied by khorshidi and bakhsheshy 2015 cho et al 2014 2015a obtained natural frequency of rectangular plates and stiffened panel structures in contact with fluid in another work they also studied cho et al 2015b frequency response of rectangular plate structures in contact with fluid subjected to harmonic point excitation force khorshidi et al 2017 performed theoretical and experimental studies of vibrating rectangular plates in contact with a bounded fluid by acoustic and modal tests canales et al canales and mantari 2017 presented an analytical solution for the free vibration analysis of thick rectangular composite plates in contact with a bounded fluid via unified formulation shahbaztabar et al shahbaztabar and ranji 2017 discussed the free vibration analysis of functionally graded plates on two parameter elastic supports in contact with stationary fluid in their paper the effect of free surface waves were not considered consideration of fluid sloshing is required to accurately analyze vibrational behavior of a flexible plate in contact with fluid the analysis of sloshing fluid behavior has been presented by researchers in various references previously the linear vibration analysis of sloshing fluids in interaction with elastic and rigid containers is done by ohayon et al ohayon and schotté 2017 felippa et al felippa and ohayon 1990 extracted the mixed variational formulation of finite element analysis of acoustoelastic slosh fluid structure interaction the analysis of fluid structure interactions in an elastic tank partially filled with an incompressible inviscid liquid was done by schotte et al schotté and ohayon 2005 faltinsen et al faltinsen and timokha 2012 obtained velocity potential for the liquid sloshing problem in a two dimensional circular tank ikeda et al 2012 presented the nonlinear responses of sloshing in a rigid square tank subjected to obliquely horizontal harmonic excitation elahi et al 2015 simulated the liquid sloshing in 2d containers using the volume of fluid method in sloshing fluid related researches the focus has usually been on fluid flow analysis and the effect of sloshing fluid on the natural frequency of plate has not usually been investigated the only research on the vibration analysis of the microplate in interaction with fluid is performed by omiddezyani et al 2018 in their work the plate is assumed to be isotropic and homogeneous while simultaneous effects of the bulging and sloshing modes were considered the distinct effect of sloshing and bulging modes were not studied indeed gradient of material has significant effect on natural frequencies of a microplate the literature survey shows that free vibration of non homogenous microplates in interaction with bounded fluid has not been studied so the innovation of this paper is mainly reflected in the following two aspects first the modified couple stress theory is developed to study the size dependent effects on natural frequencies of a microplate made of functionally graded materials in interaction with slushing fluid second unlike the most previous studies this paper separately studies effects of sloshing and bulging modes on natural frequencies of a microplate applying the modified couple stress theory the classical theory of thin plates is developed into micro scale and size dependent natural frequencies of the fgmp has been captured mechanical properties of the plate are non homogeneous through the thickness and obey the rule of mixture employing the principle of superposition and using the separation of variables method the fluid velocity potential function is calculated for the bulging and sloshing modes then the ritz method is used and the polynomial functions are expanded to determine the natural frequencies of the fgmp finally effects of various parameters on natural frequencies of the functionally graded microplate fgmp are presented and discussed in detail for a variety of boundary conditions 2 functionally graded microplate model figure 1 shows the side view of a rectangular fg microplate geometry in interaction with bounded fluid mechanical properties of the plate is graded through its thickness the origin of the coordinate system is located at left side of the plate where the material of the plate is assumed to be fully ceramic right side of the plate is fully metal dimension of the plate along the length width and height directions of the plate are shown by a b and h respectively depth of the tank is b 1 and the width is shown by c according to the volume fraction ratio law the variation of material properties of the plate through its thickness is 1 e z e c e m v m e m 2 ρ z ρ c ρ m v m ρ m where e is the young modulus α is the power law index and ρ is the density of the plate moreover c and m denote ceramic and metallic material properties respectively the metal volume fraction is obtained from the following equation 3 v m z h α 3 theoretical formulation 3 1 modified couple stress model based on the modified couple stress theory the strain energy in an fg microplate is 4 π s 1 2 λ σ ε m χ d λ where σ is the cauchy stress tensor definitions of infinitesimal strain tensor ε symmetric curvature tensor χ and deviatoric part of the stress couple tensor m are 5 ε i j 1 2 u i j u j i 6 χ i j 1 2 θ i j θ j i 7 σ i j υ e z 1 υ 1 2 υ ε m m δ i j e z 1 υ ε i j 8 m i j e z 1 υ l 2 χ i j in eq 5 through 8 u is the displacement field μ is the shear modulus and l is the material length scale parameter the rotation vector θ is 9 θ i 1 2 ε i j k u k j 3 2 the classical plate theory based on the classical plate theory cpt the displacement field u 1 u 2 and u 3 along the x y and z directions is defined as follows 10 u 1 x y z t u x y t z h 2 w x y t x u 2 x y z t v x y t z h 2 w x y t y u 3 x y z t w x y t in eq 10 u and v are in plane displacements and w is transverse deflection of the mid surface of the plate the nonzero components of the infinitesimal strain tensor are 11 ε x ε x 0 z h 2 k x ε y ε y 0 z h 2 k y γ x y γ x y 0 z h 2 k x y wherein definition of mid surface strain components ε x 0 ε y 0 γ x y 0 and the mid surface curvatures k x k y and k x y are ε x 0 u x ε y 0 v y γ x y 0 u y v x 12 k x 2 w x 2 k y 2 w y 2 k x y 2 2 w x y the constitutive equations of isotropic nonhomogeneous materials with through thickness gradient of the material are 13 σ x x σ y y σ x y e z 1 υ 2 υ e z 1 υ 2 0 υ e z 1 υ 2 e z 1 υ 2 0 0 0 e z 2 1 υ ε x x ε y y γ x y components of the rotation vector are determined by substituting eq 10 into eq 9 14 θ x 1 2 u 3 y u 2 z w y θ y 1 2 u 1 z u 3 x w x θ z 1 2 u 2 x u 1 y 1 2 v x u y equation 6 is rewritten in expanded form as follows 15 χ x x θ x x χ y y θ y y χ z z θ z z χ x y 1 2 θ x y θ y x χ x z 1 2 θ x z θ z x χ y z 1 2 θ y z θ z y substituting eq 14 in eq 15 results 16 χ x x 2 w x y χ y y 2 w x y χ x y 1 2 2 w y 2 2 w x 2 χ x z 1 4 2 v x 2 2 u y x χ y z 1 4 2 v x y 2 u y 2 the total elastic strain energy u p of a thin fg micro late may be written as follows 17 u p 1 2 0 a 0 b h 2 h 2 σ x x ε x x σ y y ε y y τ x y γ x y m x x χ x x m y y χ y y 2 m x y χ x y 2 m x z χ x z 2 m y z χ y z d z d y d x equations 8 12 13 and 16 corresponding to deviatoric part of stress couple tensor components of mid surface stain and curvature constitutive equations and curvature tensor are substituted into eq 17 to get the total elastic strain energy that is 18 u p 1 2 0 a 0 b n x x u x h 2 2 w x 2 n y y v y h 2 2 w y 2 n x y u y v x 2 h 2 2 w x y m x x 2 w x 2 m y y 2 w y 2 2 m x y 2 w x y y x x 2 w x y y y y 2 w x y y x y 2 w y 2 2 w x 2 y x z 2 2 v x 2 2 u y x y y z 2 2 v x y 2 u y 2 d y d x where 19 n x x h 2 h 2 σ x x d z n y y h 2 h 2 σ y y d z n x y h 2 h 2 σ x y d z m x x h 2 h 2 σ x x z d z m y y h 2 h 2 σ y y z d z m x y h 2 h 2 σ x y z d z 20 y x x h 2 h 2 m x x d z y y y h 2 h 2 m y y d z y x y h 2 h 2 m x y d z y x z h 2 h 2 m x z d z y y z h 2 h 2 m y z d z the kinetic energy t p of the fg microplate is 21 t p 1 2 0 a 0 b h 2 h 2 ρ z u 1 2 u 2 2 u 3 2 d z d y d x in eq 21 overdot denotes time derivative the admissible trial displacement functions may be expressed by the following series of algebraic polynomials 22 u x y t θ u x y m 1 n 1 n 1 m a m n t x m y m n e i ω t v x y t θ v x y m 1 n 1 n 1 m b m n t x m y m n e i ω t w x y t θ w x y m 1 n 1 n 1 m c m n t x m y m n e i ω t where t is the time ω denotes the natural frequency of the system and parameters m and n are the number of half waves in x and y directions respectively coefficients of admissible trial functions θ u θ v and θ w are called fundamental functions these functions satisfy the boundary conditions for various types of boundary conditions considered in the present study the fundamental functions are listed in table 1 4 formulation of the fluid oscillations the fluid is assumed to be inviscid irrotational and incompressible applying the principle of superposition the fluid velocity potential φ o is split as follows 23 φ o φ b φ s where φ b denotes the velocity potential of the fluid due to the plate bulging effect and φ s is the velocity potential due to the fluid sloshing in presence of the rigid plate the fluid velocity potential can be separated into a spatial velocity potential and a harmonic time function as follows 24 φ o x y z t φ o x y z exp i ω t the velocity potential φ o satisfies the following laplace equation 25 2 φ o 0 employing the principle of superposition laplace equation is represented as follows 26 2 φ b 2 φ s 0 the velocity of the fluid must be zero at rigid walls of the tank on the other hand the velocity components are defined by potential function φ that is v x φ x v y φ y and v z φ z therefore boundary conditions on bottom and vertical rigid walls of the tank are 27 φ b x x 0 a 0 φ b y y 0 0 φ b z z c 1 0 φ s x x 0 a 0 φ s y y 0 0 φ s z z c 0 the free surface boundary condition is 28 φ b y b 1 0 the condition for the surface between the elastic plate surface and the peripheral fluid layer is 29 φ b z z o w x y t t now according to boundary conditions 27 and 28 the separation of variable method is employed to obtain the general solution of eq 26 that is 30 φ b x y z t l 0 k 0 e l k t cos l π x a cos 2 k 1 π y 2 b 1 e π l a 2 2 k 1 2 b 1 2 z e π l a 2 2 k 1 2 b 1 2 2 c 1 z for l k 0 1 2 0 x a 0 y b 1 0 z c 1 31 φ s x y z t i 0 n s j 0 m s d i j t cos i π x a cosh π i a 2 j c 1 2 y cos j π z c 1 f o r i j 0 1 2 0 x a 0 y b 1 0 z c 1 where l 2 and k 2 are arbitrary nonnegative integers and d i j t is the unknown coefficient imposing the boundary condition given in eq 29 the coefficient e l k t is determined as follows 32 e l k t c o f f 1 a b 1 0 a 0 b 1 w x y t cos l π x a cos 2 k 1 π y 2 b 1 d y d x π l a 2 2 k 1 2 b 1 2 1 exp 2 c π l a 2 2 k 1 2 b 1 2 c o f f 1 1 i f l a n d k 0 2 i f l o r k 0 4 i f l k 0 now assume that the kinetic energy of the fluid with respect to plate bulging and fluid sloshing is denoted by t f b and t f s respectively with the aid of kinetic energy definition these energies are appeared in the following form 33 t f b 1 2 ρ f 0 a 0 b 1 φ b z 0 w t d y d x 34 t f s 1 2 ρ f 0 a 0 b 1 φ s z 0 w t d y d x the linear sloshing conditions at the fluid free surface of the tank is amabili 2000 35 φ o y y b 1 ω 2 g φ o y b 1 where g is the gravity acceleration substituting eq 23 into eq 35 and using eq 28 one obtains 36 φ b y y b 1 φ s y y b 1 ω 2 g φ s y b 1 multiplying both sides of eq 36 by ρ f φ s then integrating them over the free surface of the fluid in the tank leads 37 u φ b u φ s ω 2 t φ s where 38 u φ b ρ f 0 a 0 c φ s φ b y y b 1 d z d x u φ s ρ f 0 a 0 c φ s φ s y y b 1 d z d x t φ s ρ f g 0 a 0 c φ s 2 y b 1 d z d x u φ b and u φ s are potential energies of the fluid with respect to plate bulging and fluid sloshing 5 solution procedure the lagrangian function for the plate fluid system is written as follows 39 π u max t max where t max is sum of the kinetic energies defined by eqs 21 33 and 34 the term u max is the strain energy of the plate given by eq 18 applying the ritz method the eigenvalue equation is derived 40 π q 0 where q a m n b m n c m n d i j t is the vector of unknown time variable coefficients applied in admissible trial functions following the minimization of eq 39 the subsequent equation is obtained by the assumption of undamped plate and inviscid fluid 41 k p ξ m n ω 2 m p m f b ξ m n m f s d i j 0 where ξ m n a m n b m n c m n t and 42 k p 2 u p q i q j m p 2 t p q i q j m f b 2 t f b q i q j m f s 2 t f s q i q j equation 41 cannot be solved without determination of d i j thus eq 37 is added to equation 41 this increases the dimensions of the associated eigenvalue problem from n n to n n n n where n is the dimension of the coordinates vector c m n t and n is the dimension of coordinates vector d i j t consequently the following galerkin equation is obtained 43 k p 0 k φ b k φ s ξ m n d i j ω 2 m p m f b m f s 0 m φ s ξ m n d i j 0 where 44 k φ b 2 u φ b q i q j k φ s 2 u φ s q i q j m φ s 2 t φ s q i q j 6 numerical results 6 1 comparison studies the following normalized parameters are defined for plate and fluid system 45 δ b h ς a b η b 1 b λ c b ξ ρ f ρ w where ρ f is the fluid density and ρ w is density of the pure water also by dividing the frequency values into sloshing and bulging modes the following normalized parameters are defined 46 e s ω s l o s h i n g ω v a c u u m e b ω b u l g i n g ω where ω v a c u u m is natural frequency of the plate in vacuum and we recall it as vacuum mode for the case which the effect of free surface waves is neglected i e bulging mode the natural frequency of the plate due to oscillation of the liquid is denoted by ω b u l g i n g natural frequency of the plate due to oscillation of the liquid free surface i e sloshing mode is denoted by ω s l o s h i n g for the case which the combined effect of sloshing and bulging is considered the coupled fluid structure natural frequency of the plate is denoted by ω and we recall it as coupled mode the parameter e s expresses sloshing frequency ratio and e b expresses bulging frequency ratio setting the material length scale parameter to zero the microplate is simplified to a macroplate and natural frequencies of current work are compared with ref bermúdez et al 2001 for an rectangular plate table 2 represents the first normalized frequency parameter ω a 2 ω v a c u u m ρ p h d of the bulging mode of a rectangular macroplate in interaction with fluid d e h 3 12 1 ν 2 is flexural rigidity e is young modulus and ν is poisson s ratio in this table results of the current work is compared with ref hosseini hashemi et al 2010 for various η ς and boundary conditions i e ssss scsc and cccc the material properties applied to determine given values of this table are e 207 gpa δ 100 ν 0 3 and ξ 0 1274 as table 2 shows that data of current work and ref hosseini hashemi et al 2010 are in close agreement table 3 represents the first five natural frequency parameter ω of the bulging mode of a rectangular homogenous macro plate in interaction with fluid the results of current work in bulging mode is compared with refs zhou and cheung 2000 and hosseini hashemi et al 2010 for various boundary conditions the macro plate data are ξ 0 1274 δ 20 ς 0 5 and η 1 as it can be seen from this table a good agreement between current work and refs zhou and cheung 2000 and hosseini hashemi et al 2010 is achieved to determine the natural frequencies of the macro plate the classical plate theory cpt and mindlin plate theory has been used in refs zhou and cheung 2000 and hosseini hashemi et al 2010 respectively table 4 compares the first natural frequencies ω ω v a c u u m a 2 h ρ c e c of an fg simply supported microplate between the current work and ref thai and kim 2013 for various values of length scale parameter to thickness ratio l h the natural frequencies in this table are obtained for a plate made of a mixture of aluminum al and alumina al2o3 with material properties listed in table 5 the length scale parameter and thickness ratio are l 17 6 μ m and a h 100 respectively and the poisson s ratio is assumed to be constant through the thickness of the plate represented data in table 4 are in close agreement with ref thai and kim 2013 in figs 2 and 3 the first frequency of the macroplate in contact with the sloshing water obtained in present study is compared with the experimental data of ref khorshidi et al 2017 the clamped boundary conditions is assumed on four sides of the plate the assumptions are h 1 10 3 m a 0 4 m b 0 293 m and c 0 4 m fig 1 shows the results for the aluminum plate e 69 gpa ρ 2700 k g m 3 ν 0 3 and fig 2 shows the results for the stainless steel plate e 210 gpa ρ 7800 k g m 3 ν 0 3 as it can be seen from figs 1 and 2 the results obtained by present method are in good agreement with the experimental data 6 2 parameter studies assuming an fg microplate with material properties given in table 5 this section performs a parameter study on natural frequencies of the fg microplate in interaction with fluid table 6 shows the convergence of the present method for simplify supported fg microplate in interaction with fluid the three first natural frequency have been obtained for the values of λ 0 1 α 100 ξ 1 ς 1 h l 1 and δ 100 based on the represented data in table 6 a 78 dof degrees of freedom model is suggested to calculate the natural frequency values of an fg microplate in interaction with fluid table 7 lists frequency parameter ω of an fg microplate in interaction with fluid for various modes the microplate data are λ 0 1 α 10 ξ 1 ς 1 h l 3 and η 1 this table shows that the numerical value of the frequency parameter ω for sloshing mode is higher than vacuum mode but this difference is slight and this trend increases slightly with increasing the density and thickness ratios while this behavior is reversed for the bulging mode and the frequency parameter for this mode has severe drop in comparison with vacuum mode this trend is intensified by increasing the density and thickness ratios considering that the natural frequency of the coupled fluid structure system is simultaneously affected by bulging and sloshing modes and the influence of the bulging mode is dominant to sloshing mode the frequency parameter for bulging mode is less than the vacuum mode in fig 4 natural frequencies of an fg microplate with simply supported boundary conditions ssss obtained from modified couple stress theory mcst are compared with classical theory for vacuum i e absence of fluid and coupled i e fluid sloshing and plate bulging modes parameters of the microplate for curves plotted in this figure are δ 150 η 1 ς 0 1 α 1 and ξ 1 due to addition of the fluid kinetic energy in coupled mode the natural frequencies in this mode are lower than those of the vacuum mode this figure shows that increasing the length scale parameter ratio reduces the natural frequency of the fg microplate also the figure shows that the differences between natural frequencies of the classical and modified couple stress theories increase with decreasing the length scale parameter ratio the difference between theories are negligible for h l 4 for h l 1 natural frequencies obtained from modified couple stress theory are more than twice those of the classical theory fig 5 represents the effect of boundary condition on the first coupled mode natural frequency of the fg microplate in interaction with fluid the plate parameters in this figure are δ 100 η 1 λ 0 1 α 2 ς 1 and ξ 1 the figure shows that the coupled mode natural frequencies of the microplate for clamped boundary conditions cccc are higher than simply supported boundary conditions ssss for all length scale parameter ratios this is due to higher rigidity of the miroplate with clamped boundary conditions cccc also the difference between the coupled mode natural frequencies of the microplate for simply supported and clamped boundary conditions decreases by increasing the length scale parameter ratio effect of material gradient thorough the thickness of the plate is studied in fig 6 in this figure the first coupled mode natural frequency of an fg microplate is plotted for various length scale parameter ratios h l power law index and boundary conditions the microplate parameters are δ 100 η 1 λ 0 1 ς 1 and ξ 1 increasing the power law index reduces the percent of ceramic and increases the metal contents therefore the stiffness of the microplate reduces and this eventually leads to a decrease in coupled mode natural frequency effect of the fluid depth ratio i e η b 1 b is revealed in figs 7 through 9 for various thickness ratio i e δ b h the microplate parameters are λ 0 1 α 2 ς 1 h l 1 and ξ 13 58 and the thickness ratio δ is 1000 100 and 60 for figs 7 through 9 respectively since the stiffness of the plate improves by clamping the edges of the plate the coupled mode natural frequency of the microplate with cccc boundary condition is higher than the ssss boundary condition on the other hand comparison of these three figures indicates that variation of natural frequency is negligible for lower fluid depth ratio for example in fig 9 where the thickness ratio is δ 60 i e thin plate the natural frequency is constant for η 0 5 and this is η 0 2 for δ 1000 i e very thin plate in fig 7 the reason is that reduction of the plat thickness ratio eventuates to domination of kinetic energy and potential energy of the fluid and the change in fluid depth ratio will not effect on the coupled mode natural frequency of the microplate as the consequence effect of fluid density ratio on first coupled mode natural frequency of the fg microplate with simply supported boundary conditions ssss is shown in fig 10 for various fluid depth ratios the fg microplate parameters are δ 200 λ 0 1 ς 1 and α 10 according to this figure the coupled mode natural frequency of the fg microplate decreases for fluids with higher densities figs 11 and 12 study the effect of the tank width ratio λ c b on the first coupled mode natural frequency of the fg microplate fig 11 is plotted for various length scale parameter ratios and fig 12 is plotted for various fluid depth ratio these figures are plotted based on the following data δ 100 α 2 η 1 ς 1 and ξ 1 both figures indicate that increase in tank width ratio leads to higher natural frequencies this increase is negligible for λ 1 figure 13 depicts variation of sloshing frequency ratio of the fg microplate as a function of power law index α for various boundary conditions the microplate parameters are δ 600 η 1 α 2 h l 4 λ 0 1 ς 1 and ξ 13 58 this figure shows that the sloshing frequency ratio corresponding to ssss boundary conditions i e the plate with higher flexibility is higher than the two other boundary conditions according to definition of sloshing frequency ratio e s ω s l o s h i n g ω v a c u u m the interpretation is that the sloshing effect is more noticeable in flexible plates since the higher value of power law index is identical to increase in flexibility of the microplate the sloshing frequency ratio is raised by increasing the power law index effect of the thickness ratio on the sloshing frequency ratio e s for various density ratios length scale parameter ratios h l and boundary conditions are illustrated in figs 14 and 15 according to definition of e s the curves indicate that microplates with higher thickness are less affected by sloshing this is in coherence with previous conclusion that flexibility of the plates raises the natural frequency of the sloshing mode figs 16 and 17 demonstrate effects of the thickness ratio and density ratio on the bulging frequency ratio e b for various length scale parameter ratios h l and boundary conditions respectively the assumptions in these figures are η 1 λ 0 1 α 100 and ς 1 from fig 16 it is found that higher thickness ratios reduces the bulging frequency ratio figure 18 compares the natural frequency of the simply supported fg microplate in sloshing mode with vacuum for various fluid depth ratios power law indexes and density ratios the plate data are h l 5 λ 0 1 ς 1 for figs 18 a through 18 d the value of thickness ratio δ is 100 300 600 and 1000 respectively the figures show that higher thickness ratio increases the flexibility of the microplate and decreases the natural frequency of the fg microplate these figures show that the sloshing effect is tangible for δ 300 the case which natural frequency of fg microplate is very low moreover the natural frequency of the microplate in sloshing mode increases with tank height for δ 300 figure 19 compares the natural frequency of the fg microplate in bulging mode with coupled mode for various fluid depth ratios and density ratios the plate data are h l 5 λ 0 1 α 100 and ς 1 the bulging effect adds the fluid mass matrix i e resulted from the kinetic energy of the fluid to the eigenvalue problem therefore the bulging effect reduces the natural frequency of the microplate but the interpretation for effect of sloshing fluid is slightly different fig 18 the sloshing fluid adds both fluid mass matrices and stiffness matrices resulted from the potential energy of the fluid to the eigenvalue problem the results show that effect of the sloshing fluid on stiffness matrix is predominant so the sloshing fluid increases the natural frequency of the microplate eventually consideration of both fluid sloshing and plate bulging show that the effect of bulging mode is greater than sloshing mode and the natural frequency of the couple mode decreases with increasing fluid depth ratio 7 conclusion the effect of the sloshing and bulging modes on natural frequencies of the fg microplate in interaction with bounded fluid is studied separately to study the size dependent effects of microplate on natural frequencies results based on the modified couple stress theory is compared with classical theory the fluid velocity potential is employed to calculate the fluid kinetic energy defining the potential and kinetic energies of the microplate and the sloshing fluid and applying the ritz method natural frequencies of the fg microplate are extracted simplifying the plate conditions results are validated against the data given in the literature in summary the following conclusions are obtained based on the results obtained in this paper 1 the classical theory does not provide a proper interpretation of the frequency of the plates for thickness to length ratios higher than four 2 increase in the length scale parameter ratio leads to reduction of the natural frequencies 3 the coupled mode natural frequencies are reduced for higher fluid depth ratio and power law index 4 increasing the tank width ratio increases the coupled mode natural frequencies 5 at the same condition the natural frequencies in sloshing mode are close to the vacuum mode and their corresponding values are higher than those of vacuum mode 6 at the same conditions the natural frequencies in bulging mode are close to the natural frequency in the coupled mode and their corresponding values are smaller than the coupled mode this is due to addition of the sloshing effect in coupled mode 7 the effect of fluid sloshing on natural frequencies of the microplate is tangible for the thickness ratios higher than 300 8 due to high rigidity of the plate with cccc boundary conditions natural frequencies of the microplate for this boundary conditions are higher than other boundary conditions 9 increasing the density and thickness ratios increases the natural frequency values in sloshing mode and reduces the natural frequency values of coupled mode and bulging mode declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper nomenclature a microplate length b microplate width b 1 fluid depth c fluid width d flexural rigidity e c elasticity modulus of ceramic e m elasticity modulus of metal e s sloshing frequency ratio e b bulging frequency ratio g acceleration of gravity h microplate thickness l length scale parameter m deviatoric part of the stress couple tensor n s m s the number of terms in sloshing series n 1 the number of terms in displacement t p kinetic energy of the microplate t f b kinetic energy of the fluid due to the plate bulging effect t f s kinetic energy of the fluid due to the fluid sloshing t m a x maximum kinetic energy of the coupled mode t time u p strain energy of the microplate u φ b potential energy of the fluid due to the plate bulging effect u φ s potential energy of the fluid due to the fluid sloshing u max maximum strain energy of the coupled mode u in plane displacements along x axis v in plane displacements along y axis v m metal volume fraction w transverse displacement of mid plane surface x y z coordinates of system φ fluid potential velocity φ b velocity potential of the fluid due to the plate bulging effect φ s velocity potential of the fluid due to the fluid sloshing θ fundamental function ω s l o s h i n g natural frequency of the plate in sloshing mode ω b u l g i n g natural frequency of the plate in bulging mode ω v a c u u m natural frequency of the plate in vacuum mode ω natural frequency of the plate in coupled mode 2 laplace operator ω ω dimensionless natural frequency α power law index δ thickness ratio ρ c density of ceramic ρ m density of metal ε strain tensor σ stress tensor θ rotation vector η fluid depth ratio υ poisson s ratio χ symmetric curvature tensor ξ density ratio ς aspect ratio 
22331,static immersion studies are commonly used to assess the performance of fouling control coatings while these tests provide valuable data it is also of importance to understand the drag forces associated with the accrued fouling communities and the velocities required for fouling removal replicates of five commercially available coatings were deployed at two test sites located along the east coast of florida after four months of immersion the coatings were subjected to known water velocities in a high speed boat modified for hydrodynamic testing hard fouling adhesion measurements were taken to determine the attachment strength of organisms which remained on the panels the type and extant of fouling varied based on static immersion location this in turn influenced the fouling removal and the associated drag while fouling removal was observed on all coatings the percent removal was related to the coating type and the overall community structure those organisms which have a higher profile were easily removed lower form foulers especially those with hard structures had a minimum removal even at some of the top speeds the data collected from this series of tests enabled the fouling control and fouling release properties of each coating to be characterized keywords biofouling fouling control coatings fouling release antifouling static immersion hydrodynamic test facility abbreviations af antifouling coating astm american standards for testing and materials fr fouling release coating htf hydrodynamic test facility tbt tributyltin ppt parts per thousand pvc polyvinyl chloride 1 introduction biofouling is the unwanted accumulation of growth on submerged surfaces and can broadly be separated into two groups microfouling and macrofouling microfouling also known as biofilms or slime is a conglomeration of cells water and excreted substances macrofouling is the settlement of higher organisms and can further be divided into hard fouling and soft fouling examples of fouling organisms which have soft bodies are macroalgae tunicates and hydroids hard foulers are organisms which have a hard outer layer generally comprised of calcium carbonate and include barnacles calcareous tubeworms oysters and mussels on ship hulls the establishment of both micro and macrofouling communities can lead to many functional and financial consequences such as increases in frictional drag song et al 2019 recently reported an increase up to 93 in the ship frictional resistance due to barnacle fouling low form foulers and biofilms can also have significant impacts on drag schultz 2004 andrewartha et al 2010 heavy biofilms can result in a change in powering requirements between 16 and 21 depending on the vessel speed schultz 2007 in the same paper it is reported that heavy calcareous growth can result in a 59 86 change in powering schultz 2007 changes in ship resistance due to biofouling will ultimately lead to increased greenhouse gas emissions and fuel consumption heavy biofilm formation on a particular class of ship can result in an increase of 10 3 in fuel consumption equating to a cost of 1 2 m per ship per year schultz et al 2011 in addition to changes in ship performance invasive species transport via the hull and niche areas are also of concern drake and lodge 2007 the most common method to control biofouling is through the application of fouling control coatings these either use a biocide to kill the fouling organisms antifouling systems create a surface to which they find it difficult to adhere silicone based fouling release systems or form a hard inert surface that requires cleaning swain 2010 historically the most effective biocide based coatings were the tributyltin tbt self polishing copolymers these prevented fouling at low biocide output levels were self smoothing and could provide protection for periods in excess of five years unfortunately tbt is detrimental to the environment and in 2001 the international maritime organization adopted the international convention on the control of harmful anti fouling systems on ships which called for the ban on the use of organotins imo 2001 this entered into force on 17 september 2008 present day antifouling coatings may now be separated into copper and copper free systems examples of non copper biocides that may be found in these coatings are irgarol 1051 sea nine 211 chlorothalonil dichlofluanid diuron tcms pyridine tcmtb zinc pyrithione copper pyrithione econea and zineb however as with tbt there is still the concern that biocide based systems have the potential for bioaccumulation and other environmental impacts chambers et al 2006 thomas and brooks 2010 an alternative to biocide based systems are the silicone fouling release coatings these systems have a low surface energy low modulus low microroughness and may contain additives which prevent a fouling organism from generating a strong bond to the surface this weak bond allows for removal of the organism either through their own weight or from hydrodynamic forces generated as the vessel moves through water swain 1999 omae 2003 these coatings are considered to be environmentally friendly provide a smooth surface reduce skin friction drag and are easy to clean however they are expensive not easy to apply are not as durable as their biocidal counterparts and the environmental impacts of many of the additives are unknown swain 2010 fouling control coatings will perform the best when they are matched to the operational schedule of the ship understanding how a coating may perform under different operational schedules and environmental conditions will help guide the decision of which coating may be appropriate for a particular vessel type and voyage profile the challenge is how to obtain comparative performance data among different coating formulations currently the most common method used to evaluate fouling control coatings is through static immersion of test panels in a marine environment with high fouling pressure astm d3623 astm d6990 swain and schultz 1996 swain 1997 panels are immersed from a pier or floating raft this represents the conditions a coating will experience when the vessel is pier side or at anchor for antifouling coatings static immersion may be sufficient to determine if the coating is effective at preventing fouling however fouling release coatings are designed to allow fouling to settle but the premise is the attachment should be weaker than to an antifouling or inert coating thus in order to measure the release properties of the coatings additional testing needs to be conducted these may involve the use of pressurized water to determine the adhesion of biofilms schultz and swain 1996 zargiel and swain 2014 or a hand held force gauge to measure the critical removal stress of hard fouling organisms such as barnacles astm d5618 variations of these methods are used in both laboratory and field testing to assess the performance of fouling release coatings hunsucker and swain 2015 swain et al 2007 static immersion combined with adhesion measurements can provide valuable data however it relies on the panel accumulating the appropriate fouling group e g biofilms or barnacles and with significant numbers or coverage for testing these methods do not test how the fouling community as a whole will respond under fully developed seawater flow or determine the impact the fouling accumulation will have on the ship s frictional drag many studies have been published on the hydrodynamic characteristics of marine coatings with regards to variations in conditions and roughness schultz 2007 yeginbayeva and atlar 2018 demirel et al 2014 and biofouling hunsucker et al 2016 schultz et al 2011 others have reported specifically on the impact a particular fouling organism has on frictional drag such as biofilms hunsucker et al 2018 schultz 2015 barnacles song et al 2019 demirel et al 2017 and calcareous tubeworms monty et al 2016 while these tests provide valuable data it is also of importance to understand the velocities required for fouling removal as the community composition may change as a ship transitions from static to dynamic moving away from port the purpose of this study was to combine the static immersion studies with the hydrodynamic testing mentioned above to be able to predict the performance of marine fouling control coatings in order to determine more accurately how biofouling organisms interact with a surface specifically with regards to fouling removal and the subsequent influence on frictional drag a hydrodynamic test facility was built into the aft section of chris craft commander power boat kovach 2002 quinn 2004 swain et al 2007 hunsucker et al 2017a this paper discusses the performance of five commercially available coatings exposed at two static immersion test facilities describing fouling accumulation along with hydrodynamic results to determine the resultant frictional drag and removal of these fouling communities 2 materials and methods 2 1 coatings the fouling control properties of five commercially available ship hull coatings three fouling release fr coatings and two antifouling af coatings were investigated the fr coatings included three silicone based systems fr1 fr3 the antifouling coatings include one that was a silicone matrix combined with a biocide af1 and the second was a traditional ablative copper af2 coatings were applied to single sided panels 25 4 30 5 0 32 cm according to manufacturer s specifications six replicates of each coating type were prepared so that three replicates could be immersed at each of the two static immersion facilities 2 2 static immersion facilities three replicates of each coating were attached to polyvinyl chloride pvc frames with cable ties and submerged so that the panels were at a depth of 0 5 m below the surface this was done at the two static immersion facilities located along the east coast of florida port canaveral and sebastian both test facilities consist of floating platforms which are surrounded by mesh netting to reduce disturbance to the surfaces by grazing and predation swain et al 1998 the port canaveral 28 24 28 76 n 80 37 39 11 w facility is an oceanic test site and has high fouling activity with the average salinity 34 6 1 1 ppt and an average temperature 23 9 4 3 c the sebastian inlet 27 53 59 04 n 80 28 28 31 w facility is an estuarine test site which has an average salinity of 30 1 3 8 ppt with an average temperature of 25 5 5 3 c panels were previously immersed at each location and cleaned back once the data present in this paper reflects fouling data which accumulated on panels between february through june 2016 2 3 hydrodynamic test facility htf the hydrodynamic tests were performed using a test apparatus placed into a wet well built into the aft section of a 8 2 m power boat fig 1 the boat is powered by two 225hp yamaha outboards to allow for testing at speeds up to 15 m s this approximates to a reynolds number of 9 83 107 and a froude number of 1 47 at the position of the test panel hunsucker et al 2017a the testing apparatus consists of an aluminum body which houses a floating element balance for measuring skin friction and a foil shaped strut which houses a high definition video camera for recording fouling removal and a pitot tube for measuring vessel speed fig 2 drag force was measured with a futek model qla 262 submersible strain gauge with a max of 44 5 n and an accuracy of 0 5 full scale vessel speed was measured with a pitot tube d i d o 2 0 m m 3 3 m m and a honeywell differential pressure transducer model fp2000 with a max reading of 206 8 kpa and accuracy of 0 14 full scale fouling removal was recorded with a gopro hero4 session 2 4 frictional drag testing the surface condition of the clean panels was characterized before deployment the maximum peak to trough height was measured by a 50 μm diameter stylus over a length of 50 mm rt50 with the tqc hull roughness analyzer and the root mean square roughness krms was measured with a mahr gauge the drag forces of the clean panels were then measured in the htf to obtain the baseline drag to serve as a control a smooth acrylic panel was also run the panels were subjected to fouling at the static immersion sites and then run in the htf prior to testing each panel was photographed and the fouling assessed see methods in section 2 5 the panel was fastened to the load cell and run at 5 m s for 10 min photographed run at 10 m s for 10 min and photographed videos were taken during each of the 10 min runs following the 10 m s run the boat was run at speeds of 3 6 9 and 10 m s for 1 min each to measure the drag of the remaining fouling this was repeated three times for the frictional drag measurements any data collected while the boat was accelerating or decelerating was filtered out leaving four clusters 3 6 9 and 10 m s this was done because the test panels and fouling have mass and the vessel accelerating increases the measured force and decelerating decreases the measured force a second filter was applied to remove outliers in each cluster using chauvenet s criteria coleman and steele 2009 a regression was fitted to the remaining data and evaluated at 1 m s intervals mean drag force for each panel was determined by averaging the data points from the three drag runs at each interval the uncertainty in mean drag force was calculated from the variability in the three drag runs u f d s n t α 2 n 1 for the purpose of this paper only drag force versus velocity plots are presented 2 5 biofouling assessment and adhesion visual assessment was used to quantify and identify the fouling cover on coatings prior to testing as well as after the 5 m s and 10 m s runs astm d6990 adhesion measurements were collected on any calcareous tubeworms remaining on the coatings after the 10 m s run using a hand held force gauge astm d5618 previous comparisons of the tubeworms before and after hydrodynamic testing showed no significant difference in the adhesion values it can therefore be assumed that the adhesion values of the tubeworms are representative of the whole community and not those which remained after 10 m s 3 results 3 1 static immersion after four months of immersion the composition and quantity of fouling varied between the two test facilities as well as among coatings fig 3 6 and 7 3 1 1 sebastian inlet coatings af1 had less than 10 fouling coverage which consisted of biofilms and a small percentage of arborescent bryozoans fig 3 the af2 coatings were mostly fouled with biofilm the fr1 fr2 and fr3 coatings were fouled with arborescent bryozoans hydroids and encrusting bryozoans fr1 fr2 and fr3 also had a small coverage of calcareous tubeworms 3 1 2 port canaveral with the exception of af1 all test coatings were about 100 fouled after four months of immersion fouling on fr1 fr2 and fr3 was typified by calcareous tubeworms encrusting bryozoans and tunicates with some biofilm af2 coatings were fully fouled however the majority consisted of biofilm with some barnacles and encrusting bryozoans fig 3 the af1 coatings had less than 10 cover of a light biofilm 3 2 hydrodynamic testing baseline drag measurements on all coatings were slightly higher than the smooth acrylic panel but there were no significant differences between the two immersion sites figs 4 and 5 suggesting that surface conditions of all replicates were relatively the same the accumulation of four months of fouling resulted in an increase in drag over the clean as applied condition on all coatings except for af1 at port canaveral fig 4 port canaveral replicates generally measured higher drag than sebastian inlet replicates fig 5 a more detailed description on the specific coatings and how they performed at each test facility at the top speed 10 m s is provided below 3 2 1 sebastian inlet four months of fouling resulted in a 62 increase in frictional drag on fr1 coatings a 33 increase on fr2 coatings and a 104 increase on fr3 coatings af1 coatings had an average increase in drag of 1 with the af2 coatings increasing by 52 due to the presence of fouling 3 2 2 port canaveral the accumulation of fouling at port canaveral led to an increase of in drag of 302 on fr1 coatings over the clean as applied condition with fr2 having 247 increase and fr3 reporting a 231 increase af2 coatings also had a significant change in drag with a 122 increase however the af1 coatings had a 6 decrease in drag it should be noted that the type of fouling present at port canaveral resulted in significant variation among replicates as seen with the large error bars in fig 5 3 3 fouling removal the removal of fouling was recorded with high speed video as well as visually after the top speed 10 m s all coatings showed a decrease in fouling cover as a result of hydrodynamic flow however the extent of the removal varied among coatings figs 3 6 and 7 3 3 1 sebastian inlet fr1 coatings had a decrease in fouling coverage from 83 to 57 as a result of the loss of hydroids and encrusting bryozoans fouling on the fr2 coatings decreased from 52 to 45 also due to the removal of hydroids and encrusting bryozoans as with the other two fouling release coatings the fr3 had a decrease in fouling from 67 to 63 due to removal of encrusting bryozoans and the loss of an oyster af1 had little fouling coverage at the start of testing less than 10 biofilm some of which removed as a result of testing the af2 coatings are not known to have fouling release properties but did show a decrease in fouling coverage as a result of biofilm and silt removal 3 3 2 port canaveral as with the sebastian inlet all coatings had a decrease in the fouling coverage fr1 coatings decreased from 98 to 83 due to the removal of encrusting bryozoans and tunicates fouling on the fr2 coatings decreased from 81 to 71 also as result of encrusting bryozoan removal as well as the loss of sedimentary tubeworms fr3 decreased from 91 to 75 due to the removal of sedimentary tubeworms encrusting bryozoans arborescent bryozoans and tunicates af1 had a low coverage of biofilm less than 10 all of which was removed due to testing af2 coatings had a decrease in fouling 78 68 as a result of encrusting bryozoans sedimentary tubeworms and colonial tunicates removing from the surfaces 3 4 adhesion testing adhesion testing was performed after hydrodynamic testing on any tubeworms remaining on the test coatings fig 8 tubeworm adhesion was collected on all three fouling release coatings 3 4 1 sebastian inlet the highest adhesion was observed on fr3 which had 0 18 0 06 mpa compared to fr1 which had 0 07 0 03 mpa and fr2 which had 0 13 0 05 mpa 3 4 2 port canaveral the highest adhesion was recorded on fr3 with 0 18 0 07 mpa fr1 had a tubeworm adhesion of 0 08 0 06 mpa and fr2 an adhesion of 0 05 0 01 mpa 4 discussion the results of these tests demonstrated the difference in performance between the antifouling and the fouling release coatings the antifouling coatings had lower overall macrofouling coverage and lower resultant drag forces compared to the fouling release coatings with regards to coverage the antifouling coatings outperformed the fouling release coatings at both the port canaveral and sebastian inlet test facilities this is consistent with previous studies which have also reported lower fouling cover on antifouling surfaces comparted to fouling release surfaces hunsucker et al 2017b the frictional drag results were significantly higher on the coatings exposed at port canaveral this is the result of the macrofouling community which was greater in coverage and thickness fr1 fr3 deployed at port canaveral had the presence of the pleated sea squirt styela plicata which contributed to the drag these sea squirts are solitary in nature and can reach up to 90 mm growing outward from the panel or surface port canaveral had an abundance of calcareous tubeworms which also contributed to the greater frictional drag values monty et al 2016 recently assessed the ship drag penalty caused by calcareous tubeworms and predicted a 23 increase in total resistance due to just a light fouling it should be noted that the results presented within the present study are representative of small scale model testing and conversion into full scale data would be complex lindholdt et al 2015 generally the hydrodynamic tests resulted in removal of soft fouling organisms hydroids sedimentary tubeworms solitary and colonial tunicates this was especially true for the sea squirts whose large size allow for them to be easily removed under hydrodynamic forces however there was minimal hard fouling removal on all fouling release coatings regardless of location leaving behind a surface which was at a minimum 50 fouled the low removal of the fouling especially the tubeworms at the top speed 10 m s demonstrate the coatings were unable to remove lower profile hard fouling organisms with an attachment force greater than 0 05 mpa the lowest recorded adhesion value of tubeworms a study by coutts et al 2010 looked at biofouling survival on a hydrodynamic keel at various speeds 0 2 5 5 9 m s and found similar results in which encrusting or hard organisms had a higher survival rate especially at the higher speeds several of the fouling release coatings did have a decrease in the total coverage of encrusting bryozoans on the surface the adhesion strength of the encrusting bryozoans is lower than that of the tubeworms hunsucker personal observation demonstrating this fouling organism is able to be removed at the 10 m s velocity however the removal of the organisms will also be dependent on the surrounding fouling community which may protect the bryozoans from hydrodynamic forces it is unknown if coatings subjected to prolonged exposure on the order of days to weeks of 10 m s as opposed to 10 min intervals would be sufficient at removing a larger portion of the fouling community survival of some organisms such as the arborescent bryozoan was found to not be influenced by voyage duration two to eight days schimanski et al 2016 however it is uncertain how additional organisms and whole communities will handle the prolonged hydrodynamic forces the effect of voyage profile on the survival and condition of fouling communities is something that needs to be studied further while fouling removal was observed on all the coatings a significant portion of the community growing on the fouling release coatings remained even after speeds of 10 m s a ship operating with these fouling conditions would result in significant increases in drag schultz et al 2011 determined a ship operating with a nstm naval ships technical manual foul rating of 60 mixed community of relatively small hard fouling organisms would accumulate costs of 43 8 million per ship over a fifteen year period as a result of coating roughness and fouling if we apply this to the current study the fouling release coatings exposed at port canaveral which had a fouling rating of about 60 could cost an additional 2 9 million per ship per year due to the remaining tubeworm fouling it should be noted that the fouling communities which accrue in static environments are significantly different than those which are formed when a vessel is in service fouling settlement under static environments is generally thicker more diverse and comprised of hard and soft fouling organisms communities which form under dynamic environments are represented by lower form foulers especially biofilms and green algae hunsucker et al 2014 2017b had this study looked at fouling communities grown under dynamic conditions the resultant drag may also have impacted however previous studies have found that despite differences in fouling composition as a result of static vs dynamic immersion the measured drag forces were very similar hunsucker et al 2016 with regards to fouling removal dynamically grown communities may be harder to remove when a ship is underway organisms grown under dynamic conditions appear to have a higher adhesion strength than when grown under static conditions zargiel and swain 2014 using both the static immersion data with the hydrodynamic testing the performance of marine fouling control coatings can be assessed the results presented herein clearly demonstrate that a ship s location will determine the overall type and extant of fouling which is consistent with previously published studies assessing coatings at multiple marine locations swain et al 2000 zargiel et al 2011 the fouling which accumulates in these locations will in turn influence the drag imparted to the ship the fouling removal and the overall performance of the coating if this testing had been conducted only at the sebastian inlet test facility then the coatings may have been qualified for use on navy ships however the fouling at the port canaveral test facility resulted in a community dominated by tubeworms which resulted in significantly higher drag forces and low fouling removal this highlights the importance of utilizing multiple test facilities when testing and qualifying fouling control coatings based on real world fouling communities consideration of which coating to use would also need to factor in the ship s duty cycle which as mentioned above will have an impact on the fouling community and possibly the fouling removal and drag understanding the environmental conditions and resultant impacts on the coating performance is critical for selecting the appropriate coating system for a ship hull author contributions kelli z hunsucker formal analysis investigation writing original review harrison gardner methodology investigation formal analysis writing original review kody lieberman methodology investigation writing review geoff swain conceptualization methodology project administration writing original review declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the office of naval research grants n00014 10 1 0919 and n00014 16 1 3123 as part of a collaboration with the naval surface warfare center the authors would like to thank dr stephen mcelvany at the office of naval research for his support members of the naval surface warfare center carderock division especially elizabeth haslbeck brittany preston mia steinberg and eric holm for their input on the experimental design and data collection the authors would also like to thank members of the center for corrosion and biofouling control for their assistance in collecting and analyzing the data abe stephens travis hunsucker and hannah briant appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106677 
22331,static immersion studies are commonly used to assess the performance of fouling control coatings while these tests provide valuable data it is also of importance to understand the drag forces associated with the accrued fouling communities and the velocities required for fouling removal replicates of five commercially available coatings were deployed at two test sites located along the east coast of florida after four months of immersion the coatings were subjected to known water velocities in a high speed boat modified for hydrodynamic testing hard fouling adhesion measurements were taken to determine the attachment strength of organisms which remained on the panels the type and extant of fouling varied based on static immersion location this in turn influenced the fouling removal and the associated drag while fouling removal was observed on all coatings the percent removal was related to the coating type and the overall community structure those organisms which have a higher profile were easily removed lower form foulers especially those with hard structures had a minimum removal even at some of the top speeds the data collected from this series of tests enabled the fouling control and fouling release properties of each coating to be characterized keywords biofouling fouling control coatings fouling release antifouling static immersion hydrodynamic test facility abbreviations af antifouling coating astm american standards for testing and materials fr fouling release coating htf hydrodynamic test facility tbt tributyltin ppt parts per thousand pvc polyvinyl chloride 1 introduction biofouling is the unwanted accumulation of growth on submerged surfaces and can broadly be separated into two groups microfouling and macrofouling microfouling also known as biofilms or slime is a conglomeration of cells water and excreted substances macrofouling is the settlement of higher organisms and can further be divided into hard fouling and soft fouling examples of fouling organisms which have soft bodies are macroalgae tunicates and hydroids hard foulers are organisms which have a hard outer layer generally comprised of calcium carbonate and include barnacles calcareous tubeworms oysters and mussels on ship hulls the establishment of both micro and macrofouling communities can lead to many functional and financial consequences such as increases in frictional drag song et al 2019 recently reported an increase up to 93 in the ship frictional resistance due to barnacle fouling low form foulers and biofilms can also have significant impacts on drag schultz 2004 andrewartha et al 2010 heavy biofilms can result in a change in powering requirements between 16 and 21 depending on the vessel speed schultz 2007 in the same paper it is reported that heavy calcareous growth can result in a 59 86 change in powering schultz 2007 changes in ship resistance due to biofouling will ultimately lead to increased greenhouse gas emissions and fuel consumption heavy biofilm formation on a particular class of ship can result in an increase of 10 3 in fuel consumption equating to a cost of 1 2 m per ship per year schultz et al 2011 in addition to changes in ship performance invasive species transport via the hull and niche areas are also of concern drake and lodge 2007 the most common method to control biofouling is through the application of fouling control coatings these either use a biocide to kill the fouling organisms antifouling systems create a surface to which they find it difficult to adhere silicone based fouling release systems or form a hard inert surface that requires cleaning swain 2010 historically the most effective biocide based coatings were the tributyltin tbt self polishing copolymers these prevented fouling at low biocide output levels were self smoothing and could provide protection for periods in excess of five years unfortunately tbt is detrimental to the environment and in 2001 the international maritime organization adopted the international convention on the control of harmful anti fouling systems on ships which called for the ban on the use of organotins imo 2001 this entered into force on 17 september 2008 present day antifouling coatings may now be separated into copper and copper free systems examples of non copper biocides that may be found in these coatings are irgarol 1051 sea nine 211 chlorothalonil dichlofluanid diuron tcms pyridine tcmtb zinc pyrithione copper pyrithione econea and zineb however as with tbt there is still the concern that biocide based systems have the potential for bioaccumulation and other environmental impacts chambers et al 2006 thomas and brooks 2010 an alternative to biocide based systems are the silicone fouling release coatings these systems have a low surface energy low modulus low microroughness and may contain additives which prevent a fouling organism from generating a strong bond to the surface this weak bond allows for removal of the organism either through their own weight or from hydrodynamic forces generated as the vessel moves through water swain 1999 omae 2003 these coatings are considered to be environmentally friendly provide a smooth surface reduce skin friction drag and are easy to clean however they are expensive not easy to apply are not as durable as their biocidal counterparts and the environmental impacts of many of the additives are unknown swain 2010 fouling control coatings will perform the best when they are matched to the operational schedule of the ship understanding how a coating may perform under different operational schedules and environmental conditions will help guide the decision of which coating may be appropriate for a particular vessel type and voyage profile the challenge is how to obtain comparative performance data among different coating formulations currently the most common method used to evaluate fouling control coatings is through static immersion of test panels in a marine environment with high fouling pressure astm d3623 astm d6990 swain and schultz 1996 swain 1997 panels are immersed from a pier or floating raft this represents the conditions a coating will experience when the vessel is pier side or at anchor for antifouling coatings static immersion may be sufficient to determine if the coating is effective at preventing fouling however fouling release coatings are designed to allow fouling to settle but the premise is the attachment should be weaker than to an antifouling or inert coating thus in order to measure the release properties of the coatings additional testing needs to be conducted these may involve the use of pressurized water to determine the adhesion of biofilms schultz and swain 1996 zargiel and swain 2014 or a hand held force gauge to measure the critical removal stress of hard fouling organisms such as barnacles astm d5618 variations of these methods are used in both laboratory and field testing to assess the performance of fouling release coatings hunsucker and swain 2015 swain et al 2007 static immersion combined with adhesion measurements can provide valuable data however it relies on the panel accumulating the appropriate fouling group e g biofilms or barnacles and with significant numbers or coverage for testing these methods do not test how the fouling community as a whole will respond under fully developed seawater flow or determine the impact the fouling accumulation will have on the ship s frictional drag many studies have been published on the hydrodynamic characteristics of marine coatings with regards to variations in conditions and roughness schultz 2007 yeginbayeva and atlar 2018 demirel et al 2014 and biofouling hunsucker et al 2016 schultz et al 2011 others have reported specifically on the impact a particular fouling organism has on frictional drag such as biofilms hunsucker et al 2018 schultz 2015 barnacles song et al 2019 demirel et al 2017 and calcareous tubeworms monty et al 2016 while these tests provide valuable data it is also of importance to understand the velocities required for fouling removal as the community composition may change as a ship transitions from static to dynamic moving away from port the purpose of this study was to combine the static immersion studies with the hydrodynamic testing mentioned above to be able to predict the performance of marine fouling control coatings in order to determine more accurately how biofouling organisms interact with a surface specifically with regards to fouling removal and the subsequent influence on frictional drag a hydrodynamic test facility was built into the aft section of chris craft commander power boat kovach 2002 quinn 2004 swain et al 2007 hunsucker et al 2017a this paper discusses the performance of five commercially available coatings exposed at two static immersion test facilities describing fouling accumulation along with hydrodynamic results to determine the resultant frictional drag and removal of these fouling communities 2 materials and methods 2 1 coatings the fouling control properties of five commercially available ship hull coatings three fouling release fr coatings and two antifouling af coatings were investigated the fr coatings included three silicone based systems fr1 fr3 the antifouling coatings include one that was a silicone matrix combined with a biocide af1 and the second was a traditional ablative copper af2 coatings were applied to single sided panels 25 4 30 5 0 32 cm according to manufacturer s specifications six replicates of each coating type were prepared so that three replicates could be immersed at each of the two static immersion facilities 2 2 static immersion facilities three replicates of each coating were attached to polyvinyl chloride pvc frames with cable ties and submerged so that the panels were at a depth of 0 5 m below the surface this was done at the two static immersion facilities located along the east coast of florida port canaveral and sebastian both test facilities consist of floating platforms which are surrounded by mesh netting to reduce disturbance to the surfaces by grazing and predation swain et al 1998 the port canaveral 28 24 28 76 n 80 37 39 11 w facility is an oceanic test site and has high fouling activity with the average salinity 34 6 1 1 ppt and an average temperature 23 9 4 3 c the sebastian inlet 27 53 59 04 n 80 28 28 31 w facility is an estuarine test site which has an average salinity of 30 1 3 8 ppt with an average temperature of 25 5 5 3 c panels were previously immersed at each location and cleaned back once the data present in this paper reflects fouling data which accumulated on panels between february through june 2016 2 3 hydrodynamic test facility htf the hydrodynamic tests were performed using a test apparatus placed into a wet well built into the aft section of a 8 2 m power boat fig 1 the boat is powered by two 225hp yamaha outboards to allow for testing at speeds up to 15 m s this approximates to a reynolds number of 9 83 107 and a froude number of 1 47 at the position of the test panel hunsucker et al 2017a the testing apparatus consists of an aluminum body which houses a floating element balance for measuring skin friction and a foil shaped strut which houses a high definition video camera for recording fouling removal and a pitot tube for measuring vessel speed fig 2 drag force was measured with a futek model qla 262 submersible strain gauge with a max of 44 5 n and an accuracy of 0 5 full scale vessel speed was measured with a pitot tube d i d o 2 0 m m 3 3 m m and a honeywell differential pressure transducer model fp2000 with a max reading of 206 8 kpa and accuracy of 0 14 full scale fouling removal was recorded with a gopro hero4 session 2 4 frictional drag testing the surface condition of the clean panels was characterized before deployment the maximum peak to trough height was measured by a 50 μm diameter stylus over a length of 50 mm rt50 with the tqc hull roughness analyzer and the root mean square roughness krms was measured with a mahr gauge the drag forces of the clean panels were then measured in the htf to obtain the baseline drag to serve as a control a smooth acrylic panel was also run the panels were subjected to fouling at the static immersion sites and then run in the htf prior to testing each panel was photographed and the fouling assessed see methods in section 2 5 the panel was fastened to the load cell and run at 5 m s for 10 min photographed run at 10 m s for 10 min and photographed videos were taken during each of the 10 min runs following the 10 m s run the boat was run at speeds of 3 6 9 and 10 m s for 1 min each to measure the drag of the remaining fouling this was repeated three times for the frictional drag measurements any data collected while the boat was accelerating or decelerating was filtered out leaving four clusters 3 6 9 and 10 m s this was done because the test panels and fouling have mass and the vessel accelerating increases the measured force and decelerating decreases the measured force a second filter was applied to remove outliers in each cluster using chauvenet s criteria coleman and steele 2009 a regression was fitted to the remaining data and evaluated at 1 m s intervals mean drag force for each panel was determined by averaging the data points from the three drag runs at each interval the uncertainty in mean drag force was calculated from the variability in the three drag runs u f d s n t α 2 n 1 for the purpose of this paper only drag force versus velocity plots are presented 2 5 biofouling assessment and adhesion visual assessment was used to quantify and identify the fouling cover on coatings prior to testing as well as after the 5 m s and 10 m s runs astm d6990 adhesion measurements were collected on any calcareous tubeworms remaining on the coatings after the 10 m s run using a hand held force gauge astm d5618 previous comparisons of the tubeworms before and after hydrodynamic testing showed no significant difference in the adhesion values it can therefore be assumed that the adhesion values of the tubeworms are representative of the whole community and not those which remained after 10 m s 3 results 3 1 static immersion after four months of immersion the composition and quantity of fouling varied between the two test facilities as well as among coatings fig 3 6 and 7 3 1 1 sebastian inlet coatings af1 had less than 10 fouling coverage which consisted of biofilms and a small percentage of arborescent bryozoans fig 3 the af2 coatings were mostly fouled with biofilm the fr1 fr2 and fr3 coatings were fouled with arborescent bryozoans hydroids and encrusting bryozoans fr1 fr2 and fr3 also had a small coverage of calcareous tubeworms 3 1 2 port canaveral with the exception of af1 all test coatings were about 100 fouled after four months of immersion fouling on fr1 fr2 and fr3 was typified by calcareous tubeworms encrusting bryozoans and tunicates with some biofilm af2 coatings were fully fouled however the majority consisted of biofilm with some barnacles and encrusting bryozoans fig 3 the af1 coatings had less than 10 cover of a light biofilm 3 2 hydrodynamic testing baseline drag measurements on all coatings were slightly higher than the smooth acrylic panel but there were no significant differences between the two immersion sites figs 4 and 5 suggesting that surface conditions of all replicates were relatively the same the accumulation of four months of fouling resulted in an increase in drag over the clean as applied condition on all coatings except for af1 at port canaveral fig 4 port canaveral replicates generally measured higher drag than sebastian inlet replicates fig 5 a more detailed description on the specific coatings and how they performed at each test facility at the top speed 10 m s is provided below 3 2 1 sebastian inlet four months of fouling resulted in a 62 increase in frictional drag on fr1 coatings a 33 increase on fr2 coatings and a 104 increase on fr3 coatings af1 coatings had an average increase in drag of 1 with the af2 coatings increasing by 52 due to the presence of fouling 3 2 2 port canaveral the accumulation of fouling at port canaveral led to an increase of in drag of 302 on fr1 coatings over the clean as applied condition with fr2 having 247 increase and fr3 reporting a 231 increase af2 coatings also had a significant change in drag with a 122 increase however the af1 coatings had a 6 decrease in drag it should be noted that the type of fouling present at port canaveral resulted in significant variation among replicates as seen with the large error bars in fig 5 3 3 fouling removal the removal of fouling was recorded with high speed video as well as visually after the top speed 10 m s all coatings showed a decrease in fouling cover as a result of hydrodynamic flow however the extent of the removal varied among coatings figs 3 6 and 7 3 3 1 sebastian inlet fr1 coatings had a decrease in fouling coverage from 83 to 57 as a result of the loss of hydroids and encrusting bryozoans fouling on the fr2 coatings decreased from 52 to 45 also due to the removal of hydroids and encrusting bryozoans as with the other two fouling release coatings the fr3 had a decrease in fouling from 67 to 63 due to removal of encrusting bryozoans and the loss of an oyster af1 had little fouling coverage at the start of testing less than 10 biofilm some of which removed as a result of testing the af2 coatings are not known to have fouling release properties but did show a decrease in fouling coverage as a result of biofilm and silt removal 3 3 2 port canaveral as with the sebastian inlet all coatings had a decrease in the fouling coverage fr1 coatings decreased from 98 to 83 due to the removal of encrusting bryozoans and tunicates fouling on the fr2 coatings decreased from 81 to 71 also as result of encrusting bryozoan removal as well as the loss of sedimentary tubeworms fr3 decreased from 91 to 75 due to the removal of sedimentary tubeworms encrusting bryozoans arborescent bryozoans and tunicates af1 had a low coverage of biofilm less than 10 all of which was removed due to testing af2 coatings had a decrease in fouling 78 68 as a result of encrusting bryozoans sedimentary tubeworms and colonial tunicates removing from the surfaces 3 4 adhesion testing adhesion testing was performed after hydrodynamic testing on any tubeworms remaining on the test coatings fig 8 tubeworm adhesion was collected on all three fouling release coatings 3 4 1 sebastian inlet the highest adhesion was observed on fr3 which had 0 18 0 06 mpa compared to fr1 which had 0 07 0 03 mpa and fr2 which had 0 13 0 05 mpa 3 4 2 port canaveral the highest adhesion was recorded on fr3 with 0 18 0 07 mpa fr1 had a tubeworm adhesion of 0 08 0 06 mpa and fr2 an adhesion of 0 05 0 01 mpa 4 discussion the results of these tests demonstrated the difference in performance between the antifouling and the fouling release coatings the antifouling coatings had lower overall macrofouling coverage and lower resultant drag forces compared to the fouling release coatings with regards to coverage the antifouling coatings outperformed the fouling release coatings at both the port canaveral and sebastian inlet test facilities this is consistent with previous studies which have also reported lower fouling cover on antifouling surfaces comparted to fouling release surfaces hunsucker et al 2017b the frictional drag results were significantly higher on the coatings exposed at port canaveral this is the result of the macrofouling community which was greater in coverage and thickness fr1 fr3 deployed at port canaveral had the presence of the pleated sea squirt styela plicata which contributed to the drag these sea squirts are solitary in nature and can reach up to 90 mm growing outward from the panel or surface port canaveral had an abundance of calcareous tubeworms which also contributed to the greater frictional drag values monty et al 2016 recently assessed the ship drag penalty caused by calcareous tubeworms and predicted a 23 increase in total resistance due to just a light fouling it should be noted that the results presented within the present study are representative of small scale model testing and conversion into full scale data would be complex lindholdt et al 2015 generally the hydrodynamic tests resulted in removal of soft fouling organisms hydroids sedimentary tubeworms solitary and colonial tunicates this was especially true for the sea squirts whose large size allow for them to be easily removed under hydrodynamic forces however there was minimal hard fouling removal on all fouling release coatings regardless of location leaving behind a surface which was at a minimum 50 fouled the low removal of the fouling especially the tubeworms at the top speed 10 m s demonstrate the coatings were unable to remove lower profile hard fouling organisms with an attachment force greater than 0 05 mpa the lowest recorded adhesion value of tubeworms a study by coutts et al 2010 looked at biofouling survival on a hydrodynamic keel at various speeds 0 2 5 5 9 m s and found similar results in which encrusting or hard organisms had a higher survival rate especially at the higher speeds several of the fouling release coatings did have a decrease in the total coverage of encrusting bryozoans on the surface the adhesion strength of the encrusting bryozoans is lower than that of the tubeworms hunsucker personal observation demonstrating this fouling organism is able to be removed at the 10 m s velocity however the removal of the organisms will also be dependent on the surrounding fouling community which may protect the bryozoans from hydrodynamic forces it is unknown if coatings subjected to prolonged exposure on the order of days to weeks of 10 m s as opposed to 10 min intervals would be sufficient at removing a larger portion of the fouling community survival of some organisms such as the arborescent bryozoan was found to not be influenced by voyage duration two to eight days schimanski et al 2016 however it is uncertain how additional organisms and whole communities will handle the prolonged hydrodynamic forces the effect of voyage profile on the survival and condition of fouling communities is something that needs to be studied further while fouling removal was observed on all the coatings a significant portion of the community growing on the fouling release coatings remained even after speeds of 10 m s a ship operating with these fouling conditions would result in significant increases in drag schultz et al 2011 determined a ship operating with a nstm naval ships technical manual foul rating of 60 mixed community of relatively small hard fouling organisms would accumulate costs of 43 8 million per ship over a fifteen year period as a result of coating roughness and fouling if we apply this to the current study the fouling release coatings exposed at port canaveral which had a fouling rating of about 60 could cost an additional 2 9 million per ship per year due to the remaining tubeworm fouling it should be noted that the fouling communities which accrue in static environments are significantly different than those which are formed when a vessel is in service fouling settlement under static environments is generally thicker more diverse and comprised of hard and soft fouling organisms communities which form under dynamic environments are represented by lower form foulers especially biofilms and green algae hunsucker et al 2014 2017b had this study looked at fouling communities grown under dynamic conditions the resultant drag may also have impacted however previous studies have found that despite differences in fouling composition as a result of static vs dynamic immersion the measured drag forces were very similar hunsucker et al 2016 with regards to fouling removal dynamically grown communities may be harder to remove when a ship is underway organisms grown under dynamic conditions appear to have a higher adhesion strength than when grown under static conditions zargiel and swain 2014 using both the static immersion data with the hydrodynamic testing the performance of marine fouling control coatings can be assessed the results presented herein clearly demonstrate that a ship s location will determine the overall type and extant of fouling which is consistent with previously published studies assessing coatings at multiple marine locations swain et al 2000 zargiel et al 2011 the fouling which accumulates in these locations will in turn influence the drag imparted to the ship the fouling removal and the overall performance of the coating if this testing had been conducted only at the sebastian inlet test facility then the coatings may have been qualified for use on navy ships however the fouling at the port canaveral test facility resulted in a community dominated by tubeworms which resulted in significantly higher drag forces and low fouling removal this highlights the importance of utilizing multiple test facilities when testing and qualifying fouling control coatings based on real world fouling communities consideration of which coating to use would also need to factor in the ship s duty cycle which as mentioned above will have an impact on the fouling community and possibly the fouling removal and drag understanding the environmental conditions and resultant impacts on the coating performance is critical for selecting the appropriate coating system for a ship hull author contributions kelli z hunsucker formal analysis investigation writing original review harrison gardner methodology investigation formal analysis writing original review kody lieberman methodology investigation writing review geoff swain conceptualization methodology project administration writing original review declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the office of naval research grants n00014 10 1 0919 and n00014 16 1 3123 as part of a collaboration with the naval surface warfare center the authors would like to thank dr stephen mcelvany at the office of naval research for his support members of the naval surface warfare center carderock division especially elizabeth haslbeck brittany preston mia steinberg and eric holm for their input on the experimental design and data collection the authors would also like to thank members of the center for corrosion and biofouling control for their assistance in collecting and analyzing the data abe stephens travis hunsucker and hannah briant appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106677 
22332,the design and optimization of functional surfaces on the basis of many simulations now increasingly called simulation driven design leads to excellent products but still demands skill time and resources this paper discusses the state of the art in simulation driven design as encountered in the maritime industry and in other disciplines such as turbomachinery and automotive design it addresses potential solutions how to realize faster turn around times two promising approaches are presented firstly the massive reduction of parameters that span the design space and secondly the utilization of gradient information as derived from adjoint simulations keywords simulation driven design sdd computer aided engineering cae parametric modeling parametric adjoint optimization parameter reduction karhunen loève expansion kle 1 introduction from a mathematical point of view many highly sophisticated methods of geometric modeling have been developed and made available over the last decades with major contributions from mathematicians computer scientists and engineers even though the chances are high that further excellent methods will be introduced in the future albeit innately unknown so far 1 1 so called black swans the state of the art in parametric modeling is already very advanced comprehensive and capable of representing the shapes designers and engineers cope with in the fields of naval architecture and ocean engineering turbomachinery and automotive design as elaborated in harries et al 2015 this paper discusses parametric modeling in the context of simulation driven design sdd in particular the design and optimization of functional surfaces by means of computational fluid dynamics cfd the term simulation driven design according to karlberg et al 2013 first appeared in the 1990s and basically advocates that simulations are used not just to verify the fulfilment of certain product requirement but rather to develop the product itself by means of a lot of simulations functional surfaces are by definition components that determine the performance of a product primarily with regard to energy efficiency and environmental footprint e g emissions noise strength and safety as well as durability and profitability in naval architecture the ship hull is the most prominent functional surface along with propellers rudders and energy saving devices in turbomachinery impellers diffusors volutes and ducts are the decisive functional surfaces while in automotive design it is the car body including spoilers and wings as well as engine parts such as piston bowls coolant circuits and manifolds the majority of these functional surfaces are complex shapes i e they cannot be modeled by combining primitives such as hexahedrons pyramids cylinders ellipsoids etc but rather come as free form geometry parametric modeling in essence is the definition of a system with as few descriptive and meaningful parameters as possible instead of using a dense cloud of points which renders the most flexible but also the most expensive definition of any geometry the idea is to come up with a pragmatic and often ad hoc balance between freedom within the system and effort to describe and change it as soon as the analysis of system behavior takes a lot of resources necessitating many cpu hours of number crunching per variant the major challenge is the substantial reduction of the number of simulation runs needed the effort to scan and understand design spaces unfortunately scales disproportionately with the system s degrees of freedom dof i e the parameters chosen as free variables from a software developer s perspective there are some limiting factors which frequently occur when undertaking simulation driven design projects the following observations even though not statistically sound have been made over the last years and may be summarized as follows as of 2019 many engineers are intrigued by the potential of simulation driven design nevertheless quite many practicing engineers have not yet received any formal education in automated optimization and are therefore somewhat intimidated by the formalism of the process frequently it is unclear at least to the less experienced engineer which parameters to introduce yet alone choose as free variables parametric models from standard cad systems are often not robust enough i e a considerable number of variants frequently 20 30 fail to re generate when changing the values of the free variables 2 2 this is because standard computer aided design cad systems traditionally target the detailed modeling needed for production most of the systems utilize history based parametric models which are intuitive to build yet the regeneration of geometry for different parameter values may cause changes in the topology possibly without even being noticed by the user as a consequence a new shape may be rebuilt only in parts or not at all or alterations in names numbering and or number of objects occur causing problems in the subsequent step of grid generation while this can be fixed interactively it often disrupts an automatic process the success of an optimization campaign depends a lot on the quality of the parametric model the quality of the parametric model however is difficult to quantify good meaning dedicated yet flexible and robust parametric models are time consuming to build and typically require quite a bit of mathematical expertise the number of free variables even for very good parametric models is still rather high say 20 to 50 which is unaffordable if the simulations require a lot of resources hence in spite of all benefits the majority of companies do not yet utilize formal optimization frequently or regularly some cfd vendors unofficially say that they estimated it to be less than 10 of their user base 3 3 this seems to correlate to the market share of systems for process integration and design optimization pido which is about 5 of the global cae market even though there are many excellent papers and text books on geometric modeling the material on the how to realize faster turn around times for design and optimization on the basis of parametric models seems to be quite scarce therefore building on a brief discussion of the state of the art of simulation driven design as encountered in the industry at large this paper addresses potential solutions how to realize faster turn around times 4 4 n b the approaches shall not be explained here in all their mathematical details will be given for further reading instead the intension is to discuss the general ideas and to put them into context it is hoped that this contributes to further efforts of utilizing sdd at a much wider scale since it is firmly believed to be valuable for both the industry and the society at large 5 5 naturally not all bottlenecks given in the list of observations can be duly addressed here 2 state of the art in simulation driven design 2 1 standard approach in sdd of functional surfaces today s state of the art in simulation driven design sdd is to build a parametric model and connect the geometry to a flow simulation and then to repeat the generation of variants and their assessments as often as the resources allow see harries 2014 the simulations yield after quite a bit of number crunching the flow field for each variant from which objective functions as key performance indicators are derived say resistance pressure drop flow homogeneity wake fraction etc in order to come up with new variants automatically without any need of manual input a meaningful strategy is employed typical strategies are systematic parameter studies 6 6 which are very expensive for many free variables design of experiment doe 7 7 very often sobol or latin hypercube for exploration deterministic search algorithms for local exploitation 8 8 e g simplex by nelder and mead 1965 t search by hilleary 1966 conjugate gradient method and global methods combining both exploration and exploitation 9 9 for instance nsga ii particle swarm for thorough discussions and details see eschenauer et al 1990 birk and harries 2003 beyer and sendhoff 2007 siebertz et al 2010 harries 2014 harries et al 2017 and harries and abt 2019 the standard process of sdd comprises the following steps as illustrated in fig 1 generate a geometry for given cad variables pre process the geometry for input to external simulation s typically for a cfd analysis a watertight triangulation would be needed trigger the simulation s in batch mode by providing the necessary input file s including the geometry of the current variant read data from the simulation tool s such as flow fields and integral values like resistance by parsing the output file s post process the available data for instance determine objective s and constraint s and visualize variants assess all variants available so far and have the optimization strategy decide on changes to the free variables start a new chain of events with new values of the free variables unless the resources are spent and or good designs have been found the true bottleneck of every design task is that the design space scales up very quickly with the number of free variables dof of the system a first guess for the minimum number of variants to be studied is the square of the dof as explained in bergmann et al 2018 if the objective function is well behaved with regard to the free variables a lower number of variants may suffice this however is difficult to judge a priori the free variables are typically those parameters of the model that are under the control of the design team and that shall be deliberately changed within certain bounds consequently parametric modeling is more than anything else the attempt of intelligently reducing design spaces for specific design tasks as much as possible any free variable that can be omitted decreasing the dimensionality of the design space potentially saves a lot of time and costs therefore instead of allowing complete flexibility the design teams typically take into account every available piece of information from experience and constraints known from production operation company strategy market acceptance etc hence all good parametric models stem from a conscious choice of restriction 2 2 geometric modeling for sdd of functional surfaces in general the available parametric methods for the geometric modeling of functional surfaces can be separated into two groups that are tellingly described by the terms partially and fully parametric modeling respectively in fully parametric modeling fpm the entire geometry is built from scratch within a hierarchical system of many objects 10 10 featuring complex dependencies between the various objects yet avoiding or even prohibiting recursions in partially parametric modeling ppm only the changes to an existing shape are defined by means of parameters utilizing a baseline 11 11 as a so called dead geometry that is sufficiently close to the envisioned variants in particular with respect to topology and the potential optimum the most popular methods available in ppm are free form deformation ffd 12 12 as first introduced by sederberg and parry 1986 morphing cartesian shifts and radial basis functions rbf 13 13 see morse et al 2001 as well as botsch and kobbelt 2005 a thorough discussion and examples of both fpm and ppm are given in harries et al 2015 14 14 naturally all these methods have their strong points but also some drawbacks in ffd a baseline geometry be it a mathematically closed definition say a patchwork of b spline surfaces or a shape given in discretized form say a watertight trimesh is associated with a b spline volume the coordinates of the vertices defining the b spline volume are utilized as free variables when moving them to new positions the embedded part of the baseline is modified accordingly bringing about new shapes this is very flexible but it may get a bit tedious to interactively set up a suitable lattice of vertices for the b spline volume a cartesian shift is a simple displacement of points for instance the points of a triangulated geometry by certain amounts taken as offsets from curves and or surfaces defined in the principle planes of a cartesian coordinate system cartesian shifts can be looked at as vector fields that move points depending on their original positions they are very quick to set up and particularly nice to apply for elongated shapes e g ship hulls rudders and wings for highly curved shapes e g the volute of a turbocharger ducts and manifolds of an engine they are less beneficial to apply morphing is the linear combination of two or more baselines that are identical in topology but different in geometry the idea is to generate new shapes by mixing existing solutions that are considered potentially good variants already mostly by interpolation but possibly also by extrapolation the number of existing solutions to mix is usually small say around two to ten this leads to an optimization problem with just a few degrees of freedom namely the number of existing solutions minus one which is nice but this also means that somebody has to put in the time and effort to produce the necessary baselines beforehand in rbf approaches a number of radial basis functions rbf are superimposed forming a vector field of displacement which acts on the baseline geometry different rbfs are available e g piecewise polynomial rbfs and gaussian rbfs their common denominator being that their sphere of influence decreases with the radial distance to the point where the rbf is located in space the vector field may be determined such that a given shape e g a prominent curve or surface transforms to a target shape of that curve or surface once computed this vector field is applied to all relevant geometric entities within the rbfs region of influence alternatively several rbfs are simply used to modify a baseline depending on their positions amplitudes and radii which can be treated as free variables further coverage can be found in sieger et al 2012 and koshakji et al 2013 15 15 for a fully parametric modeling approach to profile shapes and wings see kulfan and bussoletti 2006 mixing fully parametric and partially parametric modeling is supported in dedicated tools such as caeses leading to very powerful hybrid models fig 2 gives the hierarchy of models for variable geometry utilized in simulation driven design 16 16 breps prevail in the geometric modeling of maritime assets since the thickness of the outer shell often is very small in comparison to the main dimensions a difference of three orders of magnitude not being atypical therefore the shapes relevant for hydrodynamic or aerodynamic performance are modeled with breps while parts relevant for mechanical engineering are modeled by means of constructive solid geometry csg subsequently the better of both worlds are combined 2 3 surrogate models very often a design team would have an appreciation yet not any firm knowledge about which parameters within a model may influence the objective s the most consequently a standard approach is to start an sdd campaign with an exploration doe a reasonably small set of parameters is selected for variation an acceptable number of free variables can be practically determined from the square root of the overall time available for the exploration divided by an estimate of the time needed for evaluating a single variant the exploration data allow a number of interesting observations and analyses firstly looking at the spread of the objective function s as well as the performance of the variants in comparison to the baseline gives a qualitative idea about the optimization potential quite many variants which already outperform the baseline indicate ample room for improvement while just a couple of variants with only little enhancement hint at a baseline s rather high level of sophistication secondly sensitivity analyses allow identifying those free variables that have the strongest influence on the objective function s the design team can then consciously reduce the number of free variables and undertake successive exploitations with just a subset of the most important parameters thirdly a mathematical surrogate 17 17 also called meta model or response surface can be built once established the surrogate is typically used instead of the actual simulations at the stage of exploitation this means that an optimization algorithm calls the surrogate model to get an estimate for the objective function s very quickly i e within split seconds every now and then a complementing simulation is undertaken mostly to see if the surrogate yields reasonable results and additionally to improve the surrogate in regions in which little information was initially generated or in which the objectives appear to be close to optimal popular surrogates are polynomial regressions artificial neural networks ann and kriging as explained in harries and abt 2019 and elaborated in kavakli 2019 software tools can support the choice of the most promising surrogate model and subset of design variables based on models of best prognosis see will and most 2009 3 solutions for more and faster sdd in design everyone strives to come up with solutions that are as good as the resources allow it is in every company s interest and in every engineer s dna to search for excellent products either to outperform competition external pressure or simply to enjoy the delight of a good piece of work intrinsic motivation simulation driven design in which many variants are being studied within an automatic process is proven to be a key enabling technology for better product performance see karlberg et al 2013 and harries 2014 for instance in comparison to and starting from traditionally designed hull forms improvements of 3 5 in energy efficiency are frequently reported 18 18 this is a statement many industrial users of caeses have given to the authors over the last 10 years it is substantiated by many studies formally reported in papers and presentations naturally the actual improvement realized depends very much on the quality of the baseline very high gains say of 10 and more can mostly be attributed to rather mediocre starting points quite small improvements as are common in turbomachinery in which also a fraction of a percent is appreciated usually indicate that the current designs are very mature already while the associated savings in fuel consumption and the associated reduction in the emission of greenhouse gases are significant see for instance hinrichsen et al 2007 the effort of undertaking an sdd campaign remains substantial potential solutions for faster and consequently more sdd are provision of high fidelity parametric models off the shelf or alternatively easier definition of tailor made models by the designers themselves or by consultants access to cloud computing to boost external resources for simulations see albert et al 2016 better user experience with graphical user interfaces gui for inherently complex work in design and optimization parameter reduction from design space explorations using sensitivity analysis to identify the free variables with highest influence on the objectives and to freeze those variables with very little impact in subsequent studies utilizing surrogates built from design space explorations for succeeding exploitations see harries and abt 2019 parametric models with massively reduced numbers of free variables via design space transformation utilization of simulation information via adjoint solutions in principle all approaches to speed up the processes could and probably will be utilized in combination even though each solution is meaningful and would merit elaboration we will focus here on the attempt to decrease the number of simulations needed via i massive parameter reduction and ii adjoint simulation respectively 19 19 this means that we will only elaborate further on the last two bullet points of the list 4 illustrating example as an illustrating example let us look at a common duct ducts are widespread in heating ventilation and air conditioning hvac and are found in the maritime industry e g exhaust gas systems in turbomachinery e g inlets and outlets and in automotive applications e g air conditioning a fluid enters an inlet plane and is guided to an outlet plane often undergoing either compression or diffusion while changing the flow direction and or path typically the pressure loss between the inlet and the outlet should be as small as possible while the flow homogeneity at the outlet should be high or alternatively of a dedicated profile e g a desired pre swirl in addition the available space is usually limited i e there are constraints on the volume in which the duct can be placed 20 20 in this sense a duct even though being a simple component is also representative of more complex shapes such as tunnels for bow thruster hull shapes and energy saving devices in ship design 4 1 advanced parametric model a fully parametric model was built using caeses meta surface technique of combining a cross sectional building pattern with a continuous transition of parameters that control the actual cross sectional shape at each position details about meta surfaces are presented in harries et al 2015 the parametric model allows a smooth transition from a pure circular arc at the inlet plane to an almost rectangular cross section at the outlet plane furthermore the path of each cross section s center as well as the maximum height and the maximum beam at each longitudinal position were described with basic curves in the flow direction these longitudinal curves were defined as quadratic b spline curves with five vertices in which the first and last vertices were fixed while the second and second to last vertices for path height and beam were allowed to change in x direction only ensuring a smooth entrance and exit 21 21 b spline curves and surfaces are subsets of non uniform rational b splines nurbs see piegl and tiller 1995 for details the middle vertices were left free to change within the symmetry plane this constituted a cad model of 14 free variables as illustrated in fig 3 an auxiliary surface depicted as a grey surface in fig 3 reduced the available space an inequality constraint was formulated so that the smallest distance between the duct and the auxiliary surface should not fall below a given limit the baseline was simply set to be a smooth transition from the inlet to the outlet plane which would be a common and intuitive choice 22 22 this would constitute the natural duct shape if no special experience was available 4 2 conventional parametric model an alternative to the parametric model depicted in fig 3 would be to represent the duct with a single nurbs surface as shown in fig 4 again taking advantage of symmetry in the x z plane a nurbs surface of four rows of vertices in transverse direction 23 23 note that in fig 4 both halves of the duct are shown namely the one modeled and the complementing half created from mirroring at the x z plane accordingly for each column of vertices six vertices can be seen and six columns of vertices in longitudinal direction could be utilized giving the freedom to position 4 6 24 vertices in space 24 24 more or less columns could have been chosen too naturally in general each vertex has three coordinates along with its weight as degrees of freedom giving rise to a total of 24 3 1 96 parameters fixing the inlet and outlet planes the inner 4 4 16 vertices could be chosen for modification eight of these inner vertices lie in the symmetry plane x z so that they should be restrained to move only in x and z while keeping the y coordinate fixed resulting in a total of 8 2 1 8 3 1 56 free variables this parametric model can be further reduced by freezing entire columns of vertices for instance the second and second to last columns to ensure smooth transitions at the start and end respectively if in addition the x coordinates and some of the weights are kept constant a parametric model of 20 free variables could be proposed as depicted in fig 4 as can be appreciated the choice of a suitable parameterization is not trivial and already decides how many free variables come into play how flexible the model is and hence how many simulation runs at least for the exploration phase would most likely be needed an unfortunate proposal may set the course to high expenditure or even to failure 25 25 note that the advanced parametric model features quite a few free variables too namely 14 it could have been reduced without much loss of versatility but it was deliberately left that way so as to better illustrate the presented parameter reduction by means of kle as will be shown below two ways to judge the quality of a parametric model are i to analyze the model quantitatively via parameter reduction section 5 and ii to study the so called design velocities section 6 4 3 sdd task a low pressure drop being one of the most desirable objectives for any duct a simple sdd task was formulated minimize the pressure drop of a duct with fixed inlet and outlet while fulfilling the inequality constraint of available volume the pressure drop of each variant shall be computed by cfd simulation thus a viscous simulation was set up in star ccm solving the reynolds averaged navier stokes equations rans 26 26 a similar study using snappyhexmesh as the grid generator and openfoam as the solver was reported for the duct in bergmann et al 2018 the actual design task was practically the same but the grid was chosen pretty coarse to realize short turn around times even on a notebook consequently the simulation results reported here and in bergmann et al 2018 should not be directly compared for the kle approach only the primal solution was needed while for the parametric adjoint approach naturally an adjoint ranse simulation was called for 27 27 it should be kept in mind that the aim here is to illustrate how to realize faster turn around times for the design and optimization of functional surfaces and not to propose the best shape for a specific hvac duct to this end the results for the pressure drop as the objective were normalized with the baseline data star ccm was coupled to caeses as the parametric modeling and optimization environment only half of the duct was considered taking advantage of symmetry with regard to the x z plane fig 5 depicts the grid from star ccm depending on the variant the grid comprised some 120 000 to 165 000 cells corresponding to 540 000 to 760 000 points the boundary conditions for the inlet and outlet were set as velocity inlet and pressure outlet respectively zero speed was assumed for the duct s wall the simulation was undertaken for a three dimensional steady state turbulent gas flow of constant density utilizing a realizable k ε turbulence model for the adjoint solver the pressure drop was set as the cost function as can be seen from fig 5 the duct is rather simple still it is representative of many components found in air conditioning systems and similar fields of application the clearance between inlet and outlet is 0 5 m in x direction and 0 2 m in z direction the inlet is circular with a diameter of 0 075 m with an inlet area of 4 418 10 3 m 2 while the outlet is a rounded rectangle with a height of 0 04 m and a beam of 0 14 m with an outlet area of 5 389 10 3 m 2 the fluid is air at 20 c with an inlet speed of 1 m s air density of 1 2041 kg m3 and dynamic viscosity of 1 84829 10 5 pa s the duct s main purpose is to redirect the air to the outlet position acting as a diffusor in doing so fig 6 shows the simulation results for the baseline while fig 7 depicts the simulation results for the best design found on the basis of the advanced parametric model and a standard optimization approach namely des0077 it was found by undertaking a deterministic search from the baseline i e a t search 28 28 the t search also called tangent search by hilleary 1966 is a deterministic local search strategy while staying in the feasible domain it follows a pattern search combining rather local and more global moves when detecting infeasible designs during the pattern search it returns to the last and currently best feasible variant it then adapts its search direction such that the next guess for a possible variant is approximately tangential to the inequality constraint s found to be violated the pattern search within the feasible domain is rather stoic a small step is taken with respect to one free variable while keeping all other variables constant if an improvement is found the next variable is changed now freezing all the other free variables this is simply repeated for each of the free variables in case that a small step into one direction does not yield an improvement of the objective the same small step is taken into the opposite direction if this does not produce an improvement either the current free variable is left unchanged after all of the free variables have been perturbed in turn a global and braver move is made trying to benefit from the favorable direction established by connecting the last base or the baseline at the start of the search and the currently best variant by definition the t search is derivative free nevertheless the two phases of probing with local perturbations and then walking into a favorable overall direction somewhat mimics a gradient based approach for an illustration of the t search in two dimensions see birk and harries 2003 with a restart from the best design found after the first 50 iterations it took 100 variants in total and delivered a relative pressure drop of 66 1 when compared to the baseline stopping the optimization already at an earlier design des0024 would yield a reduction to 75 7 utilizing a sobol as doe would give 81 1 des0013 within the first 100 variants and 77 1 des0141 within the first 200 variants as best results respectively further details are discussed below see fig 21 red polygon and table 2 comparing the baseline fig 6 and des0077 fig 7 it can be seen that the entrance region right after the inlet plane has increased in longitudinal direction while the outlet region has become shorter one should note that flow homogeneity at the outlet was not considered as an objective 5 massive parameter reduction 5 1 idea as discussed the number of free variables by which a design task is described plays a decisive role in simulation driven design the higher a system s degree of freedom the more simulations are usually needed to understand the system and to find improved designs not surprisingly faster turn around times come from intelligently reducing the dof and as a consequence cutting down the necessary number of simulation runs 29 29 it should be noted that in industrial optimization campaigns often derivative free methods are employed if the computation of derivatives is affordable and robust as further discussed in the context of parametric adjoint sdd below the number of necessary cfd simulations goes down quite a bit albeit at the inherent but possibly acceptable limitation of a local optimization a traditional cad model see lowest level of the hierarchy displayed in fig 2 may easily feature hundreds if not thousands of controlling entities such as the vertices of a large set of b spline surfaces in advanced parametric modeling these entities are not individually located in space but are determined in a task specific and highly concerted way fig 3 currently this is the most important and most widely spread solution to reducing design spaces the number of free variables of a well made parametric model is typically around 10 to 20 occasionally goes up to 50 and may exceptionally reach 100 see also fig 23 30 30 as discussed above the conventional parametric model of the duct already features more than 50 free variables if not suitably reduced more free variables are practically unaffordable for most design teams since relevant simulations simply take too much time even if a lot of computer resources are at hand a very promising approach of reducing the dof is to introduce so called super parameters by means of a karhunen loève expansion as will be explained in this section from the preliminary experience gathered so far see pellegrini et al 2018 and bergmann et al 2018 it seems that the design space of super parameters can be as small as five parameters while still having enough freedom variability to control the shape 5 2 karhunen loève expansion and associated sdd process karhunen loève expansion kle is a special form of principal component analysis pca and equivalent to proper orthogonal decomposition pod in the context of hydrodynamic optimization it was first proposed by diez et al 2015 a large sample of shapes is analyzed with regard to an orthonormal basis that minimizes the error of deviations from the mean shape to this end in simulation driven design the cad geometry is discretized by a structured set of points in three dimensional space 31 31 a kle could be done in other dimensions too but three dimensional objects are of main interest here a design of experiment is undertaken to create the sample for the karhunen loève expansion typically several thousands of variants would be generated since no cfd simulations need to take place at this stage the sample is pretty fast to realize even for complex models with several seconds of update time per variant while the points are topologically the same they naturally differ in their coordinates due to the variations in the values of the free variables of the cad model i e the cad variables the coordinates are interpreted as statistically uncorrelated data and a shape modification covariance matrix centered about the mean is built from them the eigenvectors of this covariance matrix then form the basis of a new space the so called kle space while the associated eigenvalues represent the variance retained 32 32 kle is formulated in the continuous domain and reduces to the eigenproblem of an integral operator the discretization of the shape domain and associated integral equation yields the eigenproblem of a matrix namely the autocovariance matrix of the discretized shape modification vector for which a pca is undertaken theoretically an infinite number of eigenvectors and eigenvalues would be needed to capture all possible shapes clearly this would neither be beneficial nor practical therefore a considerably lower set of modes i e coordinate directions of the kle space is chosen deliberately sacrificing some of the cad model s variability these modes are thought of as super parameters and may also be referred to as kle variables 33 33 it is important to note that the super parameters exist in kle space they are not just a subset of the original free variables in cad space in a classical sensitivity analysis the most important free cad variables are identified from a doe which has to run many time consuming simulations to understand how the cad variables influence the objective s for an illustration of how super parameters the modes influence the shape of the duct see bergmann et al 2018 the variability of the new kle model is determined as the sum of the eigenvalues associated with each eigenvector divided by the total geometric variance of the original cad model a variability of 100 would mean that all variants considered within the sample can be exactly reproduced super parameters are ordered according to their importance interestingly quite often 95 of the variability is already attained with just a few of the most influential super parameters this then enables a design team to work within a massively reduced design space as can be appreciated from table 1 since the points computed to make up the sample for the karhunen loève expansion differs from the input typically needed for a simulation code for instance a watertight stl file or a step file a back transformation needs to take place between the super parameters in kle space and the parameters in cad space this is because the super parameters now serve as the free variables addressed by an optimization algorithm while the former free variables in the cad space have become the dependent variables needed to realize a suitable instance of the shape the kle based sdd process is illustrated in fig 8 different to the standard process shown in fig 1 the optimization strategy addresses the cad variables indirectly by actually modifying the kle variables the associated values of the cad variables need then to be determined for details about the back transformation see bergmann et al 2018 it needs to be mentioned that in general the back transformation from kle to cad space is not unique since by choice the cad model s variability is higher this should not be looked at as a limiting issue here since the major aim of the kle is to scan the design space with much fewer simulations naturally once a region has been identified in which very promising variants are located it is always an option to continue with a local optimization on the basis of the original cad variables fig 1 moreover the kle may also be utilized to quantify a parametric model see table 1 if the ratio between the number of cad variables and the number of kle variables to reach a certain variability say 95 is high the cad model apparently contains many variables that do not change the geometry a lot or that act on the same parts of the geometry similarly vice versa if the ratio is low the free variables are pretty independent and it would probably not give any benefit to switch from cad to kle space finally it should be noted that the kle approach as discussed here does not take into account any relationship between geometry and flow field yet this will only be established by means of the flow optimization to follow potentially this implies a certain risk namely that small geometric changes which could have a large impact on the flow are not duly represented by the super parameters selected before cutoff as discussed in the outlook see below there are proposals to overcome this shortcoming 5 3 kle based optimization of the duct the kle approach was applied to the optimization of the duct using the advanced parametric model with 14 cad variables fig 3 for the variability achieved by employing one two and more super parameters see table 1 it was decided to utilize the first five modes of the kle space bringing the variability to over 98 for the optimization a sample of 2000 variants was generated with a sobol algorithm out of caeses the optimization itself was subsequently run with the same deterministic search strategy as the standard optimization namely the t search 34 34 this allows a better comparison between the approaches fig 9 and fig 10 present two variants from a kle based optimization the variant called des0019 performs already really well with a non dimensional pressure drop of 63 6 a reduction by 36 4 when compared to the baseline carrying on with the optimization beyond this point yields an even better design called des0028 that would furnish 61 4 the best design found yields a non dimensional pressure drop of 61 3 indicating that towards the end of the optimization campaign there are only very few improvements coming from subtle changes of geometry on one side this means that it may not be worthwhile to carry on the optimization beyond des0028 on the other side this also shows that the pressure drop found is not too sensitive to small variations suggesting a certain robustness with respect to production tolerances the optimization history is depicted in fig 21 blue polygon 5 4 further example in addition to the duct example which primarily serves as a means of illustration a maritime application shall be briefly shown the details are elaborated in pellegrini et al 2018 two figures shall be given here fig 11 presents the original shape baseline of a swath vessel along with the optimized shape while fig 12 shows a comparison of the wave fields for both the original and the optimized hull as summarized in table 1 see column with the heading swath the cad model featured 27 free variables a kle based optimization was undertaken with four super parameters retaining more than 95 variability this results in a reduction of total resistance by 25 while even increasing displacement 35 35 the regions of influence that the most important super parameters address are shown in detail in pellegrini et al 2018 interestingly the first super parameter acts primarily on the swath s forebody in particular on the forward strut while the second super parameter mainly influences the tip region of the demi hull resembling a submerged bulb the third super parameter mostly affects the swath s aftbody while the fourth super parameter again influences various regions of the forebody 6 parametric adjoint simulation 6 1 idea the second approach of reducing the number of simulation runs is to solve the so called adjoint equations adjoint equations or adjoints are differential equations derived from their primal equations in order to determine gradient values with respect to a chosen quantity i e the objective to be optimized in fluiddynamics this may be resistance pressure drop etc and the primal equations would then be the rans equations adjoint simulations are complicated enough to merit a thorough treatment of their own which is beyond the scope of this paper for elaborations see for instance stück et al 2011 robinson et al 2012 as well as christakopoulos and müller 2012 for a maritime application see brenner et al 2012 the effort to solve the adjoints is of similar order as the effort to solve the primal equations hence gradient information for the objective is relatively cheap to get even though very good mesh quality and very high levels of convergence are required 36 36 one needs to appreciate that the true effort goes into developing a cfd code that is able to solve the adjoints however that is usually not done by the designers and engineers working in the industry but by the code developers who need to take care of the construction of the adjoint operator discrete or continuous and a reverse integration for time dependent problems in a standard optimization a free variable of the cad model is changed with the question in mind how the associated shape modification impacts the objective function fig 1 in an adjoint simulation here meaning the computation of shape gradients the question is posed the other way round namely how does the shape need to change so as to improve the objective the adjoint simulation results in so called adjoint sensitives which give a relative measure where and by how much the shape needs to be pushed in or pulled out so as to improve the objective see fig 16 and fig 17 37 37 unfortunately the magnitude of the normal displacement is not known a common adjoint simulation features as many dof as the grid points or facets resolving the boundary of the shape of course this rapidly adds up to very many dof easily in the range of several hundreds of thousands see also fig 23 but they are coupled via the flow field and hence do not change independently mathematically adjoint sensitivities can be expressed as f n g i e the gradient of the objective function f with regard to the normal displacement of every grid point g on the body s surface 38 38 i e the grid points on the boundary surface of the computational mesh an adjoint simulation treats these grid points as free variables and successively changes them via small steps see for instance stück et al 2011 and kröger and rung 2015 this is often referred to as a parameter free optimization naturally this has advantages and disadvantages clearly the shape can flexibly adjust to yield the most beneficial flow field yet the shape may also slightly degenerate and may not be easy to recapture in a cad system for further processing 39 39 in addition certain production constraints are typically non trivial to incorporate for instance the flankmilling of an impeller therefore a very interesting approach is to combine parametric modeling and adjoint simulation as will be explained below while the parametric model ensures the quality of the shapes the adjoints economically yield the information about where to best introduce shape modifications 6 2 design velocities design velocities are a means to visually inspect parametric models and to understand where and how strongly each cad variable influences the shape to do so each free variable x i is perturbed by a small delta δx i while all the other cad variables are kept unchanged the normal displacement of each point on the geometry k n k x i measured from the original shape is then determined and mapped as a color code onto the baseline 40 40 since the derivatives are not analytically determined they really are approximated by δn k δx i fig 13 depicts the design velocities of three of the 14 cad variables for the advanced parametric model of the duct using the same color code it becomes clear which free variable influences which region the most furthermore the fairness of these displacement maps can be utilized to judge the quality of the parametric model 6 3 parametric adjoint sdd process mathematically parametric modeling and adjoint simulation can be combined as follows image 106464 this means that the adjoint sensitivities and the design velocities are concatenated to yield the gradient of the objective function with regard to the free variables of the cad model since the resolution of the shape usually differs from the grid of the numerical flow analysis a mapping of data needs to take place firstly normalizing the adjoint sensitivities with the surface area of the facet with which the value is associated say a g and afterwards multiplying them with the surface area of the underlying shape representation say a k 41 41 for instance this would be the weighted surface areas of the triangles surrounding a point on the surface as part of a triangulated shape representation moreover a suitable interpolation needs to take place to ensure that the normal directions are sufficiently aligned once the gradient of the objective with respect to the free variables is known f x i for all free variables a local search can be undertaken this reduces the optimization to a sequence of line searches which are far less time consuming than any global investigation though locally confined fig 14 illustrates the situation for an objective f as a function of just two free variables namely x i and x i 1 from fig 14 it can be seen that the gradient itself only yields the direction in which to expect an improvement the ideal step size by which to advance from the current variant shown in blue in fig 14 remains unknown it can be approximated by an educated guess about the expected improvement for the objective or by simply taking a reasonably small yet sufficiently large step 42 42 since the objective function s behavior is normally not known beforehand a very bold step size may lead towards leaving the region of the local optimum and continuing in the region of a neighboring local optimum ideally one would immediately reach the design shown in green in fig 14 that is tangent to an isoline of the objective function 43 43 i e tangent to the hyperplane of constant value of the objective function in n dimensional cad space with n as the number of free variables this however is rather unlikely and one may just fall a little too short grey variant or overshoot red variant in fig 14 the overall process of a parametric adjoint simulation is illustrated in fig 15 starting from the cad variables of a baseline the design velocities are determined and the adjoint sensitivities are computed utilizing the parametric adjoint gradient the line search is undertaken giving new values for the free variables 44 44 note that the free variables do not change independently since they are connected via the parametric adjoint gradient the search really is one dimensional basically there are two options while doing the line search either for any next variant the complete process is repeated right away including a new adjoint simulation or several new variants are evaluated only for the primal equations until a new basepoint is chosen for which the whole process loop is then started anew essentially this is very similar to a classic gradient based local optimization and improvements can be built into the process like using conjugate gradients and or deriving step size estimates for the line search from an iterative approximation of the hessian matrix the decisive difference however lies in the computation of the gradient in the classic approach the gradient of the objective function would be determined numerically by a differencing scheme say a forward difference apart from the inherent problem of having to select a suitable delta for each of the free variables 45 45 large enough to be outside any noise of the simulation but small enough for an acceptable approximation of the differential quotient the additional number of simulation runs equals the number of free variables obviously this makes the gradient very expensive to compute and in contrast an adjoint simulation extremely attractive 46 46 an additional bottleneck arises from potential failures of computing all components of the gradient by a differencing scheme if the cad model does not regenerate cleanly the grid does not adapt or regenerate well and or the actual flow simulation is inaccurate or even divergent for only one of the components the gradient may not be available and or may be heavily skewed fig 16 presents a comparison of gradient components from an adjoint simulation and from direct numerical simulations for different variants computed with star ccm for a twisted wing representative of an airfoil or a rudder shown in the lower left part with the adjoint sensitivities for lift the lift as the objective is plotted vs three of the free variables while each triangle in the diagrams relates to a primal solution of the rans equations the red lines entitled sensitivity gradient stems from one single adjoint simulation for the baseline with a thickness of 0 15 m zero twist and zero camber of the suction side actually only one additional simulation would be needed to compute the gradient component from differencing 47 47 here the many additional analyses were undertaken to get an appreciation of the linearity of the objective in the vicinity of the baseline the quality of the parametric adjoint simulation can be seen from fig 16 48 48 it also gives an appreciation of appropriate step sizes for a numerical approximation of the gradient ideally such a study would be undertaken before deciding which step sizes to utilize here the situation is not critical as quite a few different step sizes would yield pretty similar results for more details see weickgenannt 2015 finally apart from tightly coupling a parametric model to the adjoints as discussed above there is a complementing approach of utilizing adjoint simulations from the parametric adjoint gradient the more important free variables can be distinguished from the less important ones subsequently a much reduced set of free variables can be chosen for a classic optimization campaign fig 1 either the adjoint simulation is done for the baseline only or for several variants distributed in search space by means of a doe this means that the adjoints can also be utilized to reduce the effort of a classic sensitivity analysis see also brenner et al 2012 6 4 parametric adjoint optimization of the duct for the parametric adjoint optimization of the duct the process shown in fig 15 was run while design velocities of the selected cad variables are shown in fig 13 the adjoint sensitivities for the baseline are presented in fig 17 the color code suggests where to push in and where to pull out geometry respectively it can be seen that the adjoint sensitivities are not necessarily smoothly distributed over the shape see also figs 16 and 19 this means that if a pure adjoint simulation i e a parameter free optimization was undertaken some grid points on the body boundary would be pulled out or pushed in more than their neighbors without proper smoothing this may quickly result in bumpy shapes by concatenating the adjoint sensitivities and the design velocities as explained above any undesirable wiggles can be readily avoided since by definition in a parametric adjoint approach the shape is restricted to change only as the parametric model allows 49 49 furthermore there is no need to remodel the final shape again within a cad system in other words the parametric model acts as a filter for the information contained in the adjoint sensitivities fig 18 presents a selected design from the parametric adjoint optimization of the duct it is des0015 which features a non dimensional pressure drop of 67 1 which is very close to the pressure drop from the standard optimization found for des0077 fig 7 with many more variants investigated see above the optimization history for the parametric adjoint approach is shown in fig 21 too green polygon it can be seen that the optimization commences with pretty fast improvements that can be attributed to steep gradients towards the end of the optimization process the changes in geometry are small and so are the changes in pressure drop 50 50 this is similar to what could be observed for the kle based optimization 6 5 further example in addition to the duct example again a maritime application shall be briefly shown the details are elaborated in brönstrup 2017 fig 19 presents the adjoint sensitivities computed with star ccm for the kvlcc tanker the kvlcc is a slow steaming very large crude oil carrier whose resistance primarily stems from frictional and viscous pressure losses 51 51 free surface effects were neglected in the study fig 20 shows a comparison of the original hull shown in black and the hull optimized for lower resistance shown in red a reduction of around 2 9 could be realized when allowing slight losses of displacement for the same displacement an improvement of 1 9 was found naturally also the quality of the wake would have to be considered so as not to compromise propulsive efficiency 52 52 a second parametric adjoint optimization was undertaken see brönstrup 2017 with the aim of improving wake homogeneity not shown here 7 summary of results for the duct table 2 summarizes the results from the various sdd campaigns for the duct comparing data from the state of the art approach with the outcome of using both massive parameter reduction and parametric adjoint simulation the history plots of several optimization campaigns are depicted in fig 21 while table 3 summarizes the most important aspects of these approaches since the parametric adjoint simulation requires about twice the effort per variant its iteration history was stretched by a factor of two for a fair comparison hence the effort associated with des0015 of the parametric adjoint simulation fig 18 lies a little above the effort of des0019 of the kle approach fig 9 furthermore it needs to be noted that for some of the campaigns most importantly for the parametric adjoint and for the sobol the numbering of the designs does not linearly correspond to the iteration number of the abscissa this is because only those variants are presented in fig 21 that were feasible observing the inequality constraint on the available space and for which a cfd simulation really took place it can be readily seen that both the kle approach and the parametric adjoint approach speed up the campaigns substantially a really good result stems from the kle approach in which des0028 yields 61 4 of non dimensional pressure drop fig 10 some of the variants following des0028 are a tiny bit better but the campaign could have been stopped at des0028 just as well subjectively des0019 appears to bring about a very good compromise between effort and improvement namely a non dimensional pressure of 63 6 with just 20 cfd runs 53 53 counting the evaluation of the baseline at iteration number 0 too the effort needed to undertake a parametric adjoint simulation is similar to that of the kle approach with des0015 resulting in a non dimensional pressure of 67 1 the effort associated with des0015 is about the same as the effort of 24 cfd runs that only need a primal solution while the improvement is close to that of a standard approach with many more variants namely des0077 from a t search requiring 78 cfd runs it should be noted that additional t search runs could have brought about further improvements and possibly an even better design than those found by the kle approach as can be observed from the history plots shown in fig 21 the values of the objective for those variants preceding or following the selected designs are not so different when studying the associated geometries they also feature slight changes only this indicates that local plateaus in the objective function were reached based on the selected designs the kle approach and the parametric adjoint approach speed up the campaigns by around 3 9 and 3 3 respectively i e a factor above three if the optimizations had been stopped as soon as the selected designs were found naturally it would not be safe to assume that similar speed ups can be expected for other applications nevertheless the comparison illustrates the potential another interesting variant from the standard approach would be des0024 shown in fig 22 it is also marked in fig 21 while the effort for des0024 is in the range of both the kle approach and the parametric adjoint approach the result is a bit less competitive with 75 7 in other words for more or less the same effort the improvement from a standard approach is smaller while a similar improvement see des0077 in figs 21 and 7 can still be realized albeit at higher costs finally it should be kept in mind that it may just have been a lucky strike that the best design was found by the kle approach a possible explanation could be that via the kle variables the design space can be covered more widely with fewer variants in particular if the search is not confined to the convex hull defined by the lower and upper bounds of the cad variables if the objective function is well behaved meaning that not many local extrema occur the chances of finding a very good design for any given number of variants are higher 54 54 within bergmann et al 2018 various duct optimizations were presented too comparing traditional optimization strates to the kle based approach even higher speed ups were reported there but no comparison to a parametric adjoint approach was made 8 qualitative comparison of approaches naturally the duct example discussed was primarily meant to describe the various approaches of sdd in order to get a wider appreciation of effort vs freedom a qualitative view is presented in fig 23 55 55 it is an abstraction of information gathered from many talks with customers and partners of friendship systems users of caeses and simulation engineers utilizing the cfd codes typically coupled to caeses for instance ansys cfx and fluent converge cfd fine marine and fine open flow 3d fresco and ad fresco openfoam pumplinx shipflow star ccm tcfd it also takes into account presentations at users meetings and conferences as well as publications see also references given in harries 2014 it shows at logarithmic scale the simulation effort i e the typical number of simulation runs undertaken 56 56 if only one design point is accounted for this equals the number of variants produced if several operational points are considered the number of variants reduces accordingly vs the dof i e the typical number of free variables chosen for the sake of clarity well defined regions are depicted even though there would actually be some blurriness the most important aspects of the approaches are summarized in table 3 a standard model that is defined in a traditional cad system is typically too cumbersome to employ since too many dof would be involved hence the region entitled traditional cad red box should be interpreted as an indication of what would actually be called for if a design team really wanted to take this path the lower left corner of the region is what some teams at universities larger companies and specialized consultants have managed to realize while the upper end lying in the greyed out area of several ten thousands of variants simply is impractical as explained above most successful optimizations take place in the region named fpm and ppm green box at the lower level of the number of simulation runs surrogates are typically employed at the upper level involving several thousands of simulation runs a standard combination of exploration and exploitation would be found not surprisingly the experience with parameter reductions kle parametric adjoint and adjoint simulations is still rather limited therefore the regions depicted in fig 23 ought to be regarded as first estimates subject to confirmation or adjustment within the next years for the combined parametric adjoint approach blue box the actual number of free variables is not really decisive since the computational burden does not scale up with the dof 57 57 computing the gradient of the objective function does not really cost much as soon as the adjoint solution is available independent of how many parameters are considered as free variables still an advanced parametric model certainly helps to come up with good results finally it should be noted again that a pure adjoint simulation grey box is routinely termed parameter free meaning that here the dof are those parts of the computational mesh that the design team endorsed for modification moreover since adjoint computations build on the availability of highly converged primal solutions the effort per variant is higher than in the other approaches this has been reasonably accounted for in fig 23 58 58 for an adjoint rans simulation the primal solution requires a higher level of convergence than a standard rans simulation weickgenannt 2015 and brönstrup 2017 in addition the adjoint simulation itself also needs time and resources they are in the range of the primal solution itself thus doubling the effort per variant nevertheless not all variants within an adjoint simulation may actually require both a primal and an associated adjoint solution consequently the simulation effort is judged to be a bit less than two times the number of variants investigated 9 conclusions simulation driven design is considered a key technology to improve products beyond the excellent achievements already realized from experience insight and intuition all of which are important aspects of engineering practice instead of assessing just a few selected and manually generated variants the idea of sdd is to utilize simulations extensively in order to propose new and innovative solutions a limiting factor is that simulations particularly flow simulations are still quite expensive therefore the success of any sdd campaign depends on a thoughtful definition of the design task applying suitable parametric models and furthermore combining them with mathematical means of speeding up the process two rather novel approaches of bringing sdd to a new level of sophistication have been discussed with the overarching aim of achieving faster turn around times for the design and optimization of functional surfaces one approach is the replacement of the original cad model with an orthogonal system of new kle variables whose dimensionality is substantially lower than the cad model s dof sacrificing a small percentage of the model s variability another approach is the combination of parameters that control the shape of the product with the sensitivities from an adjoint simulation that capture the influence that small changes of the geometry would have on a predefined objective function massive parameter reductions can be realized via a principle component analysis known as karhunen loève expansion kle the original cad space is replaced by a kle space subsequently only the most important kle variables retaining an acceptable level of variability say 95 and higher of the original parametric model are utilized within an optimization campaign in which much fewer simulations need to be run it can be considered a global approach since the cad space can still be addressed by and large the parametric adjoint approach meanwhile constitutes a local approach by concatenating design velocities and adjoint sensitivities the gradient of the objective function with regard to the free variables is determined for a selected design this then gives the direction for a one dimensional search necessitating only a few additional simulations before repeating the procedure being local the parametric adjoint approach appears to be particularly appealing at the stage of fine tuning 10 outlook a next level of sophistication is to combine the massive reduction of design spaces from a purely geometric point of view with data from flow simulations for instance diez et al 2016 elegantly utilize low and high fidelity flow simulations within their kle analyses albeit at the additional effort of quite many low fidelity and some additional high fidelity cfd runs further enhancements are introduced by d agostino et al 2017 as well as by serani et al 2018 experimenting with nonlinear extensions of the kle approach a complementing idea would be to merge adjoint solutions and kle by using the adjoint sensitivities for the baseline and possibly a handful of variants strategically distributed in design space to weigh the geometric variability with the influence on the flow field and the objective function s of interest naturally also various hybrid approaches could be envisioned such as a first scanning of the design space by means of kle exploration followed by several parametric adjoint optimizations from promising base points exploitation acknowledgments the work undertaken by simon brönstrup aras kavakli and sebastian weickgenannt all of whom were master students at the technical university berlin under the supervision of stefan harries is gratefully acknowledged here special thanks go to hedi böttcher from friendship systems who supported the work reported here with great enthusiasm and skill parts of the work presented stem from the german r d projects gamma 03et1469d form pro 03sx280b and nowelle 03sx362d these projects were administered by ptj and funded by the federal republic of germany federal ministry of economics and technology on the orders of the german bundestag 
22332,the design and optimization of functional surfaces on the basis of many simulations now increasingly called simulation driven design leads to excellent products but still demands skill time and resources this paper discusses the state of the art in simulation driven design as encountered in the maritime industry and in other disciplines such as turbomachinery and automotive design it addresses potential solutions how to realize faster turn around times two promising approaches are presented firstly the massive reduction of parameters that span the design space and secondly the utilization of gradient information as derived from adjoint simulations keywords simulation driven design sdd computer aided engineering cae parametric modeling parametric adjoint optimization parameter reduction karhunen loève expansion kle 1 introduction from a mathematical point of view many highly sophisticated methods of geometric modeling have been developed and made available over the last decades with major contributions from mathematicians computer scientists and engineers even though the chances are high that further excellent methods will be introduced in the future albeit innately unknown so far 1 1 so called black swans the state of the art in parametric modeling is already very advanced comprehensive and capable of representing the shapes designers and engineers cope with in the fields of naval architecture and ocean engineering turbomachinery and automotive design as elaborated in harries et al 2015 this paper discusses parametric modeling in the context of simulation driven design sdd in particular the design and optimization of functional surfaces by means of computational fluid dynamics cfd the term simulation driven design according to karlberg et al 2013 first appeared in the 1990s and basically advocates that simulations are used not just to verify the fulfilment of certain product requirement but rather to develop the product itself by means of a lot of simulations functional surfaces are by definition components that determine the performance of a product primarily with regard to energy efficiency and environmental footprint e g emissions noise strength and safety as well as durability and profitability in naval architecture the ship hull is the most prominent functional surface along with propellers rudders and energy saving devices in turbomachinery impellers diffusors volutes and ducts are the decisive functional surfaces while in automotive design it is the car body including spoilers and wings as well as engine parts such as piston bowls coolant circuits and manifolds the majority of these functional surfaces are complex shapes i e they cannot be modeled by combining primitives such as hexahedrons pyramids cylinders ellipsoids etc but rather come as free form geometry parametric modeling in essence is the definition of a system with as few descriptive and meaningful parameters as possible instead of using a dense cloud of points which renders the most flexible but also the most expensive definition of any geometry the idea is to come up with a pragmatic and often ad hoc balance between freedom within the system and effort to describe and change it as soon as the analysis of system behavior takes a lot of resources necessitating many cpu hours of number crunching per variant the major challenge is the substantial reduction of the number of simulation runs needed the effort to scan and understand design spaces unfortunately scales disproportionately with the system s degrees of freedom dof i e the parameters chosen as free variables from a software developer s perspective there are some limiting factors which frequently occur when undertaking simulation driven design projects the following observations even though not statistically sound have been made over the last years and may be summarized as follows as of 2019 many engineers are intrigued by the potential of simulation driven design nevertheless quite many practicing engineers have not yet received any formal education in automated optimization and are therefore somewhat intimidated by the formalism of the process frequently it is unclear at least to the less experienced engineer which parameters to introduce yet alone choose as free variables parametric models from standard cad systems are often not robust enough i e a considerable number of variants frequently 20 30 fail to re generate when changing the values of the free variables 2 2 this is because standard computer aided design cad systems traditionally target the detailed modeling needed for production most of the systems utilize history based parametric models which are intuitive to build yet the regeneration of geometry for different parameter values may cause changes in the topology possibly without even being noticed by the user as a consequence a new shape may be rebuilt only in parts or not at all or alterations in names numbering and or number of objects occur causing problems in the subsequent step of grid generation while this can be fixed interactively it often disrupts an automatic process the success of an optimization campaign depends a lot on the quality of the parametric model the quality of the parametric model however is difficult to quantify good meaning dedicated yet flexible and robust parametric models are time consuming to build and typically require quite a bit of mathematical expertise the number of free variables even for very good parametric models is still rather high say 20 to 50 which is unaffordable if the simulations require a lot of resources hence in spite of all benefits the majority of companies do not yet utilize formal optimization frequently or regularly some cfd vendors unofficially say that they estimated it to be less than 10 of their user base 3 3 this seems to correlate to the market share of systems for process integration and design optimization pido which is about 5 of the global cae market even though there are many excellent papers and text books on geometric modeling the material on the how to realize faster turn around times for design and optimization on the basis of parametric models seems to be quite scarce therefore building on a brief discussion of the state of the art of simulation driven design as encountered in the industry at large this paper addresses potential solutions how to realize faster turn around times 4 4 n b the approaches shall not be explained here in all their mathematical details will be given for further reading instead the intension is to discuss the general ideas and to put them into context it is hoped that this contributes to further efforts of utilizing sdd at a much wider scale since it is firmly believed to be valuable for both the industry and the society at large 5 5 naturally not all bottlenecks given in the list of observations can be duly addressed here 2 state of the art in simulation driven design 2 1 standard approach in sdd of functional surfaces today s state of the art in simulation driven design sdd is to build a parametric model and connect the geometry to a flow simulation and then to repeat the generation of variants and their assessments as often as the resources allow see harries 2014 the simulations yield after quite a bit of number crunching the flow field for each variant from which objective functions as key performance indicators are derived say resistance pressure drop flow homogeneity wake fraction etc in order to come up with new variants automatically without any need of manual input a meaningful strategy is employed typical strategies are systematic parameter studies 6 6 which are very expensive for many free variables design of experiment doe 7 7 very often sobol or latin hypercube for exploration deterministic search algorithms for local exploitation 8 8 e g simplex by nelder and mead 1965 t search by hilleary 1966 conjugate gradient method and global methods combining both exploration and exploitation 9 9 for instance nsga ii particle swarm for thorough discussions and details see eschenauer et al 1990 birk and harries 2003 beyer and sendhoff 2007 siebertz et al 2010 harries 2014 harries et al 2017 and harries and abt 2019 the standard process of sdd comprises the following steps as illustrated in fig 1 generate a geometry for given cad variables pre process the geometry for input to external simulation s typically for a cfd analysis a watertight triangulation would be needed trigger the simulation s in batch mode by providing the necessary input file s including the geometry of the current variant read data from the simulation tool s such as flow fields and integral values like resistance by parsing the output file s post process the available data for instance determine objective s and constraint s and visualize variants assess all variants available so far and have the optimization strategy decide on changes to the free variables start a new chain of events with new values of the free variables unless the resources are spent and or good designs have been found the true bottleneck of every design task is that the design space scales up very quickly with the number of free variables dof of the system a first guess for the minimum number of variants to be studied is the square of the dof as explained in bergmann et al 2018 if the objective function is well behaved with regard to the free variables a lower number of variants may suffice this however is difficult to judge a priori the free variables are typically those parameters of the model that are under the control of the design team and that shall be deliberately changed within certain bounds consequently parametric modeling is more than anything else the attempt of intelligently reducing design spaces for specific design tasks as much as possible any free variable that can be omitted decreasing the dimensionality of the design space potentially saves a lot of time and costs therefore instead of allowing complete flexibility the design teams typically take into account every available piece of information from experience and constraints known from production operation company strategy market acceptance etc hence all good parametric models stem from a conscious choice of restriction 2 2 geometric modeling for sdd of functional surfaces in general the available parametric methods for the geometric modeling of functional surfaces can be separated into two groups that are tellingly described by the terms partially and fully parametric modeling respectively in fully parametric modeling fpm the entire geometry is built from scratch within a hierarchical system of many objects 10 10 featuring complex dependencies between the various objects yet avoiding or even prohibiting recursions in partially parametric modeling ppm only the changes to an existing shape are defined by means of parameters utilizing a baseline 11 11 as a so called dead geometry that is sufficiently close to the envisioned variants in particular with respect to topology and the potential optimum the most popular methods available in ppm are free form deformation ffd 12 12 as first introduced by sederberg and parry 1986 morphing cartesian shifts and radial basis functions rbf 13 13 see morse et al 2001 as well as botsch and kobbelt 2005 a thorough discussion and examples of both fpm and ppm are given in harries et al 2015 14 14 naturally all these methods have their strong points but also some drawbacks in ffd a baseline geometry be it a mathematically closed definition say a patchwork of b spline surfaces or a shape given in discretized form say a watertight trimesh is associated with a b spline volume the coordinates of the vertices defining the b spline volume are utilized as free variables when moving them to new positions the embedded part of the baseline is modified accordingly bringing about new shapes this is very flexible but it may get a bit tedious to interactively set up a suitable lattice of vertices for the b spline volume a cartesian shift is a simple displacement of points for instance the points of a triangulated geometry by certain amounts taken as offsets from curves and or surfaces defined in the principle planes of a cartesian coordinate system cartesian shifts can be looked at as vector fields that move points depending on their original positions they are very quick to set up and particularly nice to apply for elongated shapes e g ship hulls rudders and wings for highly curved shapes e g the volute of a turbocharger ducts and manifolds of an engine they are less beneficial to apply morphing is the linear combination of two or more baselines that are identical in topology but different in geometry the idea is to generate new shapes by mixing existing solutions that are considered potentially good variants already mostly by interpolation but possibly also by extrapolation the number of existing solutions to mix is usually small say around two to ten this leads to an optimization problem with just a few degrees of freedom namely the number of existing solutions minus one which is nice but this also means that somebody has to put in the time and effort to produce the necessary baselines beforehand in rbf approaches a number of radial basis functions rbf are superimposed forming a vector field of displacement which acts on the baseline geometry different rbfs are available e g piecewise polynomial rbfs and gaussian rbfs their common denominator being that their sphere of influence decreases with the radial distance to the point where the rbf is located in space the vector field may be determined such that a given shape e g a prominent curve or surface transforms to a target shape of that curve or surface once computed this vector field is applied to all relevant geometric entities within the rbfs region of influence alternatively several rbfs are simply used to modify a baseline depending on their positions amplitudes and radii which can be treated as free variables further coverage can be found in sieger et al 2012 and koshakji et al 2013 15 15 for a fully parametric modeling approach to profile shapes and wings see kulfan and bussoletti 2006 mixing fully parametric and partially parametric modeling is supported in dedicated tools such as caeses leading to very powerful hybrid models fig 2 gives the hierarchy of models for variable geometry utilized in simulation driven design 16 16 breps prevail in the geometric modeling of maritime assets since the thickness of the outer shell often is very small in comparison to the main dimensions a difference of three orders of magnitude not being atypical therefore the shapes relevant for hydrodynamic or aerodynamic performance are modeled with breps while parts relevant for mechanical engineering are modeled by means of constructive solid geometry csg subsequently the better of both worlds are combined 2 3 surrogate models very often a design team would have an appreciation yet not any firm knowledge about which parameters within a model may influence the objective s the most consequently a standard approach is to start an sdd campaign with an exploration doe a reasonably small set of parameters is selected for variation an acceptable number of free variables can be practically determined from the square root of the overall time available for the exploration divided by an estimate of the time needed for evaluating a single variant the exploration data allow a number of interesting observations and analyses firstly looking at the spread of the objective function s as well as the performance of the variants in comparison to the baseline gives a qualitative idea about the optimization potential quite many variants which already outperform the baseline indicate ample room for improvement while just a couple of variants with only little enhancement hint at a baseline s rather high level of sophistication secondly sensitivity analyses allow identifying those free variables that have the strongest influence on the objective function s the design team can then consciously reduce the number of free variables and undertake successive exploitations with just a subset of the most important parameters thirdly a mathematical surrogate 17 17 also called meta model or response surface can be built once established the surrogate is typically used instead of the actual simulations at the stage of exploitation this means that an optimization algorithm calls the surrogate model to get an estimate for the objective function s very quickly i e within split seconds every now and then a complementing simulation is undertaken mostly to see if the surrogate yields reasonable results and additionally to improve the surrogate in regions in which little information was initially generated or in which the objectives appear to be close to optimal popular surrogates are polynomial regressions artificial neural networks ann and kriging as explained in harries and abt 2019 and elaborated in kavakli 2019 software tools can support the choice of the most promising surrogate model and subset of design variables based on models of best prognosis see will and most 2009 3 solutions for more and faster sdd in design everyone strives to come up with solutions that are as good as the resources allow it is in every company s interest and in every engineer s dna to search for excellent products either to outperform competition external pressure or simply to enjoy the delight of a good piece of work intrinsic motivation simulation driven design in which many variants are being studied within an automatic process is proven to be a key enabling technology for better product performance see karlberg et al 2013 and harries 2014 for instance in comparison to and starting from traditionally designed hull forms improvements of 3 5 in energy efficiency are frequently reported 18 18 this is a statement many industrial users of caeses have given to the authors over the last 10 years it is substantiated by many studies formally reported in papers and presentations naturally the actual improvement realized depends very much on the quality of the baseline very high gains say of 10 and more can mostly be attributed to rather mediocre starting points quite small improvements as are common in turbomachinery in which also a fraction of a percent is appreciated usually indicate that the current designs are very mature already while the associated savings in fuel consumption and the associated reduction in the emission of greenhouse gases are significant see for instance hinrichsen et al 2007 the effort of undertaking an sdd campaign remains substantial potential solutions for faster and consequently more sdd are provision of high fidelity parametric models off the shelf or alternatively easier definition of tailor made models by the designers themselves or by consultants access to cloud computing to boost external resources for simulations see albert et al 2016 better user experience with graphical user interfaces gui for inherently complex work in design and optimization parameter reduction from design space explorations using sensitivity analysis to identify the free variables with highest influence on the objectives and to freeze those variables with very little impact in subsequent studies utilizing surrogates built from design space explorations for succeeding exploitations see harries and abt 2019 parametric models with massively reduced numbers of free variables via design space transformation utilization of simulation information via adjoint solutions in principle all approaches to speed up the processes could and probably will be utilized in combination even though each solution is meaningful and would merit elaboration we will focus here on the attempt to decrease the number of simulations needed via i massive parameter reduction and ii adjoint simulation respectively 19 19 this means that we will only elaborate further on the last two bullet points of the list 4 illustrating example as an illustrating example let us look at a common duct ducts are widespread in heating ventilation and air conditioning hvac and are found in the maritime industry e g exhaust gas systems in turbomachinery e g inlets and outlets and in automotive applications e g air conditioning a fluid enters an inlet plane and is guided to an outlet plane often undergoing either compression or diffusion while changing the flow direction and or path typically the pressure loss between the inlet and the outlet should be as small as possible while the flow homogeneity at the outlet should be high or alternatively of a dedicated profile e g a desired pre swirl in addition the available space is usually limited i e there are constraints on the volume in which the duct can be placed 20 20 in this sense a duct even though being a simple component is also representative of more complex shapes such as tunnels for bow thruster hull shapes and energy saving devices in ship design 4 1 advanced parametric model a fully parametric model was built using caeses meta surface technique of combining a cross sectional building pattern with a continuous transition of parameters that control the actual cross sectional shape at each position details about meta surfaces are presented in harries et al 2015 the parametric model allows a smooth transition from a pure circular arc at the inlet plane to an almost rectangular cross section at the outlet plane furthermore the path of each cross section s center as well as the maximum height and the maximum beam at each longitudinal position were described with basic curves in the flow direction these longitudinal curves were defined as quadratic b spline curves with five vertices in which the first and last vertices were fixed while the second and second to last vertices for path height and beam were allowed to change in x direction only ensuring a smooth entrance and exit 21 21 b spline curves and surfaces are subsets of non uniform rational b splines nurbs see piegl and tiller 1995 for details the middle vertices were left free to change within the symmetry plane this constituted a cad model of 14 free variables as illustrated in fig 3 an auxiliary surface depicted as a grey surface in fig 3 reduced the available space an inequality constraint was formulated so that the smallest distance between the duct and the auxiliary surface should not fall below a given limit the baseline was simply set to be a smooth transition from the inlet to the outlet plane which would be a common and intuitive choice 22 22 this would constitute the natural duct shape if no special experience was available 4 2 conventional parametric model an alternative to the parametric model depicted in fig 3 would be to represent the duct with a single nurbs surface as shown in fig 4 again taking advantage of symmetry in the x z plane a nurbs surface of four rows of vertices in transverse direction 23 23 note that in fig 4 both halves of the duct are shown namely the one modeled and the complementing half created from mirroring at the x z plane accordingly for each column of vertices six vertices can be seen and six columns of vertices in longitudinal direction could be utilized giving the freedom to position 4 6 24 vertices in space 24 24 more or less columns could have been chosen too naturally in general each vertex has three coordinates along with its weight as degrees of freedom giving rise to a total of 24 3 1 96 parameters fixing the inlet and outlet planes the inner 4 4 16 vertices could be chosen for modification eight of these inner vertices lie in the symmetry plane x z so that they should be restrained to move only in x and z while keeping the y coordinate fixed resulting in a total of 8 2 1 8 3 1 56 free variables this parametric model can be further reduced by freezing entire columns of vertices for instance the second and second to last columns to ensure smooth transitions at the start and end respectively if in addition the x coordinates and some of the weights are kept constant a parametric model of 20 free variables could be proposed as depicted in fig 4 as can be appreciated the choice of a suitable parameterization is not trivial and already decides how many free variables come into play how flexible the model is and hence how many simulation runs at least for the exploration phase would most likely be needed an unfortunate proposal may set the course to high expenditure or even to failure 25 25 note that the advanced parametric model features quite a few free variables too namely 14 it could have been reduced without much loss of versatility but it was deliberately left that way so as to better illustrate the presented parameter reduction by means of kle as will be shown below two ways to judge the quality of a parametric model are i to analyze the model quantitatively via parameter reduction section 5 and ii to study the so called design velocities section 6 4 3 sdd task a low pressure drop being one of the most desirable objectives for any duct a simple sdd task was formulated minimize the pressure drop of a duct with fixed inlet and outlet while fulfilling the inequality constraint of available volume the pressure drop of each variant shall be computed by cfd simulation thus a viscous simulation was set up in star ccm solving the reynolds averaged navier stokes equations rans 26 26 a similar study using snappyhexmesh as the grid generator and openfoam as the solver was reported for the duct in bergmann et al 2018 the actual design task was practically the same but the grid was chosen pretty coarse to realize short turn around times even on a notebook consequently the simulation results reported here and in bergmann et al 2018 should not be directly compared for the kle approach only the primal solution was needed while for the parametric adjoint approach naturally an adjoint ranse simulation was called for 27 27 it should be kept in mind that the aim here is to illustrate how to realize faster turn around times for the design and optimization of functional surfaces and not to propose the best shape for a specific hvac duct to this end the results for the pressure drop as the objective were normalized with the baseline data star ccm was coupled to caeses as the parametric modeling and optimization environment only half of the duct was considered taking advantage of symmetry with regard to the x z plane fig 5 depicts the grid from star ccm depending on the variant the grid comprised some 120 000 to 165 000 cells corresponding to 540 000 to 760 000 points the boundary conditions for the inlet and outlet were set as velocity inlet and pressure outlet respectively zero speed was assumed for the duct s wall the simulation was undertaken for a three dimensional steady state turbulent gas flow of constant density utilizing a realizable k ε turbulence model for the adjoint solver the pressure drop was set as the cost function as can be seen from fig 5 the duct is rather simple still it is representative of many components found in air conditioning systems and similar fields of application the clearance between inlet and outlet is 0 5 m in x direction and 0 2 m in z direction the inlet is circular with a diameter of 0 075 m with an inlet area of 4 418 10 3 m 2 while the outlet is a rounded rectangle with a height of 0 04 m and a beam of 0 14 m with an outlet area of 5 389 10 3 m 2 the fluid is air at 20 c with an inlet speed of 1 m s air density of 1 2041 kg m3 and dynamic viscosity of 1 84829 10 5 pa s the duct s main purpose is to redirect the air to the outlet position acting as a diffusor in doing so fig 6 shows the simulation results for the baseline while fig 7 depicts the simulation results for the best design found on the basis of the advanced parametric model and a standard optimization approach namely des0077 it was found by undertaking a deterministic search from the baseline i e a t search 28 28 the t search also called tangent search by hilleary 1966 is a deterministic local search strategy while staying in the feasible domain it follows a pattern search combining rather local and more global moves when detecting infeasible designs during the pattern search it returns to the last and currently best feasible variant it then adapts its search direction such that the next guess for a possible variant is approximately tangential to the inequality constraint s found to be violated the pattern search within the feasible domain is rather stoic a small step is taken with respect to one free variable while keeping all other variables constant if an improvement is found the next variable is changed now freezing all the other free variables this is simply repeated for each of the free variables in case that a small step into one direction does not yield an improvement of the objective the same small step is taken into the opposite direction if this does not produce an improvement either the current free variable is left unchanged after all of the free variables have been perturbed in turn a global and braver move is made trying to benefit from the favorable direction established by connecting the last base or the baseline at the start of the search and the currently best variant by definition the t search is derivative free nevertheless the two phases of probing with local perturbations and then walking into a favorable overall direction somewhat mimics a gradient based approach for an illustration of the t search in two dimensions see birk and harries 2003 with a restart from the best design found after the first 50 iterations it took 100 variants in total and delivered a relative pressure drop of 66 1 when compared to the baseline stopping the optimization already at an earlier design des0024 would yield a reduction to 75 7 utilizing a sobol as doe would give 81 1 des0013 within the first 100 variants and 77 1 des0141 within the first 200 variants as best results respectively further details are discussed below see fig 21 red polygon and table 2 comparing the baseline fig 6 and des0077 fig 7 it can be seen that the entrance region right after the inlet plane has increased in longitudinal direction while the outlet region has become shorter one should note that flow homogeneity at the outlet was not considered as an objective 5 massive parameter reduction 5 1 idea as discussed the number of free variables by which a design task is described plays a decisive role in simulation driven design the higher a system s degree of freedom the more simulations are usually needed to understand the system and to find improved designs not surprisingly faster turn around times come from intelligently reducing the dof and as a consequence cutting down the necessary number of simulation runs 29 29 it should be noted that in industrial optimization campaigns often derivative free methods are employed if the computation of derivatives is affordable and robust as further discussed in the context of parametric adjoint sdd below the number of necessary cfd simulations goes down quite a bit albeit at the inherent but possibly acceptable limitation of a local optimization a traditional cad model see lowest level of the hierarchy displayed in fig 2 may easily feature hundreds if not thousands of controlling entities such as the vertices of a large set of b spline surfaces in advanced parametric modeling these entities are not individually located in space but are determined in a task specific and highly concerted way fig 3 currently this is the most important and most widely spread solution to reducing design spaces the number of free variables of a well made parametric model is typically around 10 to 20 occasionally goes up to 50 and may exceptionally reach 100 see also fig 23 30 30 as discussed above the conventional parametric model of the duct already features more than 50 free variables if not suitably reduced more free variables are practically unaffordable for most design teams since relevant simulations simply take too much time even if a lot of computer resources are at hand a very promising approach of reducing the dof is to introduce so called super parameters by means of a karhunen loève expansion as will be explained in this section from the preliminary experience gathered so far see pellegrini et al 2018 and bergmann et al 2018 it seems that the design space of super parameters can be as small as five parameters while still having enough freedom variability to control the shape 5 2 karhunen loève expansion and associated sdd process karhunen loève expansion kle is a special form of principal component analysis pca and equivalent to proper orthogonal decomposition pod in the context of hydrodynamic optimization it was first proposed by diez et al 2015 a large sample of shapes is analyzed with regard to an orthonormal basis that minimizes the error of deviations from the mean shape to this end in simulation driven design the cad geometry is discretized by a structured set of points in three dimensional space 31 31 a kle could be done in other dimensions too but three dimensional objects are of main interest here a design of experiment is undertaken to create the sample for the karhunen loève expansion typically several thousands of variants would be generated since no cfd simulations need to take place at this stage the sample is pretty fast to realize even for complex models with several seconds of update time per variant while the points are topologically the same they naturally differ in their coordinates due to the variations in the values of the free variables of the cad model i e the cad variables the coordinates are interpreted as statistically uncorrelated data and a shape modification covariance matrix centered about the mean is built from them the eigenvectors of this covariance matrix then form the basis of a new space the so called kle space while the associated eigenvalues represent the variance retained 32 32 kle is formulated in the continuous domain and reduces to the eigenproblem of an integral operator the discretization of the shape domain and associated integral equation yields the eigenproblem of a matrix namely the autocovariance matrix of the discretized shape modification vector for which a pca is undertaken theoretically an infinite number of eigenvectors and eigenvalues would be needed to capture all possible shapes clearly this would neither be beneficial nor practical therefore a considerably lower set of modes i e coordinate directions of the kle space is chosen deliberately sacrificing some of the cad model s variability these modes are thought of as super parameters and may also be referred to as kle variables 33 33 it is important to note that the super parameters exist in kle space they are not just a subset of the original free variables in cad space in a classical sensitivity analysis the most important free cad variables are identified from a doe which has to run many time consuming simulations to understand how the cad variables influence the objective s for an illustration of how super parameters the modes influence the shape of the duct see bergmann et al 2018 the variability of the new kle model is determined as the sum of the eigenvalues associated with each eigenvector divided by the total geometric variance of the original cad model a variability of 100 would mean that all variants considered within the sample can be exactly reproduced super parameters are ordered according to their importance interestingly quite often 95 of the variability is already attained with just a few of the most influential super parameters this then enables a design team to work within a massively reduced design space as can be appreciated from table 1 since the points computed to make up the sample for the karhunen loève expansion differs from the input typically needed for a simulation code for instance a watertight stl file or a step file a back transformation needs to take place between the super parameters in kle space and the parameters in cad space this is because the super parameters now serve as the free variables addressed by an optimization algorithm while the former free variables in the cad space have become the dependent variables needed to realize a suitable instance of the shape the kle based sdd process is illustrated in fig 8 different to the standard process shown in fig 1 the optimization strategy addresses the cad variables indirectly by actually modifying the kle variables the associated values of the cad variables need then to be determined for details about the back transformation see bergmann et al 2018 it needs to be mentioned that in general the back transformation from kle to cad space is not unique since by choice the cad model s variability is higher this should not be looked at as a limiting issue here since the major aim of the kle is to scan the design space with much fewer simulations naturally once a region has been identified in which very promising variants are located it is always an option to continue with a local optimization on the basis of the original cad variables fig 1 moreover the kle may also be utilized to quantify a parametric model see table 1 if the ratio between the number of cad variables and the number of kle variables to reach a certain variability say 95 is high the cad model apparently contains many variables that do not change the geometry a lot or that act on the same parts of the geometry similarly vice versa if the ratio is low the free variables are pretty independent and it would probably not give any benefit to switch from cad to kle space finally it should be noted that the kle approach as discussed here does not take into account any relationship between geometry and flow field yet this will only be established by means of the flow optimization to follow potentially this implies a certain risk namely that small geometric changes which could have a large impact on the flow are not duly represented by the super parameters selected before cutoff as discussed in the outlook see below there are proposals to overcome this shortcoming 5 3 kle based optimization of the duct the kle approach was applied to the optimization of the duct using the advanced parametric model with 14 cad variables fig 3 for the variability achieved by employing one two and more super parameters see table 1 it was decided to utilize the first five modes of the kle space bringing the variability to over 98 for the optimization a sample of 2000 variants was generated with a sobol algorithm out of caeses the optimization itself was subsequently run with the same deterministic search strategy as the standard optimization namely the t search 34 34 this allows a better comparison between the approaches fig 9 and fig 10 present two variants from a kle based optimization the variant called des0019 performs already really well with a non dimensional pressure drop of 63 6 a reduction by 36 4 when compared to the baseline carrying on with the optimization beyond this point yields an even better design called des0028 that would furnish 61 4 the best design found yields a non dimensional pressure drop of 61 3 indicating that towards the end of the optimization campaign there are only very few improvements coming from subtle changes of geometry on one side this means that it may not be worthwhile to carry on the optimization beyond des0028 on the other side this also shows that the pressure drop found is not too sensitive to small variations suggesting a certain robustness with respect to production tolerances the optimization history is depicted in fig 21 blue polygon 5 4 further example in addition to the duct example which primarily serves as a means of illustration a maritime application shall be briefly shown the details are elaborated in pellegrini et al 2018 two figures shall be given here fig 11 presents the original shape baseline of a swath vessel along with the optimized shape while fig 12 shows a comparison of the wave fields for both the original and the optimized hull as summarized in table 1 see column with the heading swath the cad model featured 27 free variables a kle based optimization was undertaken with four super parameters retaining more than 95 variability this results in a reduction of total resistance by 25 while even increasing displacement 35 35 the regions of influence that the most important super parameters address are shown in detail in pellegrini et al 2018 interestingly the first super parameter acts primarily on the swath s forebody in particular on the forward strut while the second super parameter mainly influences the tip region of the demi hull resembling a submerged bulb the third super parameter mostly affects the swath s aftbody while the fourth super parameter again influences various regions of the forebody 6 parametric adjoint simulation 6 1 idea the second approach of reducing the number of simulation runs is to solve the so called adjoint equations adjoint equations or adjoints are differential equations derived from their primal equations in order to determine gradient values with respect to a chosen quantity i e the objective to be optimized in fluiddynamics this may be resistance pressure drop etc and the primal equations would then be the rans equations adjoint simulations are complicated enough to merit a thorough treatment of their own which is beyond the scope of this paper for elaborations see for instance stück et al 2011 robinson et al 2012 as well as christakopoulos and müller 2012 for a maritime application see brenner et al 2012 the effort to solve the adjoints is of similar order as the effort to solve the primal equations hence gradient information for the objective is relatively cheap to get even though very good mesh quality and very high levels of convergence are required 36 36 one needs to appreciate that the true effort goes into developing a cfd code that is able to solve the adjoints however that is usually not done by the designers and engineers working in the industry but by the code developers who need to take care of the construction of the adjoint operator discrete or continuous and a reverse integration for time dependent problems in a standard optimization a free variable of the cad model is changed with the question in mind how the associated shape modification impacts the objective function fig 1 in an adjoint simulation here meaning the computation of shape gradients the question is posed the other way round namely how does the shape need to change so as to improve the objective the adjoint simulation results in so called adjoint sensitives which give a relative measure where and by how much the shape needs to be pushed in or pulled out so as to improve the objective see fig 16 and fig 17 37 37 unfortunately the magnitude of the normal displacement is not known a common adjoint simulation features as many dof as the grid points or facets resolving the boundary of the shape of course this rapidly adds up to very many dof easily in the range of several hundreds of thousands see also fig 23 but they are coupled via the flow field and hence do not change independently mathematically adjoint sensitivities can be expressed as f n g i e the gradient of the objective function f with regard to the normal displacement of every grid point g on the body s surface 38 38 i e the grid points on the boundary surface of the computational mesh an adjoint simulation treats these grid points as free variables and successively changes them via small steps see for instance stück et al 2011 and kröger and rung 2015 this is often referred to as a parameter free optimization naturally this has advantages and disadvantages clearly the shape can flexibly adjust to yield the most beneficial flow field yet the shape may also slightly degenerate and may not be easy to recapture in a cad system for further processing 39 39 in addition certain production constraints are typically non trivial to incorporate for instance the flankmilling of an impeller therefore a very interesting approach is to combine parametric modeling and adjoint simulation as will be explained below while the parametric model ensures the quality of the shapes the adjoints economically yield the information about where to best introduce shape modifications 6 2 design velocities design velocities are a means to visually inspect parametric models and to understand where and how strongly each cad variable influences the shape to do so each free variable x i is perturbed by a small delta δx i while all the other cad variables are kept unchanged the normal displacement of each point on the geometry k n k x i measured from the original shape is then determined and mapped as a color code onto the baseline 40 40 since the derivatives are not analytically determined they really are approximated by δn k δx i fig 13 depicts the design velocities of three of the 14 cad variables for the advanced parametric model of the duct using the same color code it becomes clear which free variable influences which region the most furthermore the fairness of these displacement maps can be utilized to judge the quality of the parametric model 6 3 parametric adjoint sdd process mathematically parametric modeling and adjoint simulation can be combined as follows image 106464 this means that the adjoint sensitivities and the design velocities are concatenated to yield the gradient of the objective function with regard to the free variables of the cad model since the resolution of the shape usually differs from the grid of the numerical flow analysis a mapping of data needs to take place firstly normalizing the adjoint sensitivities with the surface area of the facet with which the value is associated say a g and afterwards multiplying them with the surface area of the underlying shape representation say a k 41 41 for instance this would be the weighted surface areas of the triangles surrounding a point on the surface as part of a triangulated shape representation moreover a suitable interpolation needs to take place to ensure that the normal directions are sufficiently aligned once the gradient of the objective with respect to the free variables is known f x i for all free variables a local search can be undertaken this reduces the optimization to a sequence of line searches which are far less time consuming than any global investigation though locally confined fig 14 illustrates the situation for an objective f as a function of just two free variables namely x i and x i 1 from fig 14 it can be seen that the gradient itself only yields the direction in which to expect an improvement the ideal step size by which to advance from the current variant shown in blue in fig 14 remains unknown it can be approximated by an educated guess about the expected improvement for the objective or by simply taking a reasonably small yet sufficiently large step 42 42 since the objective function s behavior is normally not known beforehand a very bold step size may lead towards leaving the region of the local optimum and continuing in the region of a neighboring local optimum ideally one would immediately reach the design shown in green in fig 14 that is tangent to an isoline of the objective function 43 43 i e tangent to the hyperplane of constant value of the objective function in n dimensional cad space with n as the number of free variables this however is rather unlikely and one may just fall a little too short grey variant or overshoot red variant in fig 14 the overall process of a parametric adjoint simulation is illustrated in fig 15 starting from the cad variables of a baseline the design velocities are determined and the adjoint sensitivities are computed utilizing the parametric adjoint gradient the line search is undertaken giving new values for the free variables 44 44 note that the free variables do not change independently since they are connected via the parametric adjoint gradient the search really is one dimensional basically there are two options while doing the line search either for any next variant the complete process is repeated right away including a new adjoint simulation or several new variants are evaluated only for the primal equations until a new basepoint is chosen for which the whole process loop is then started anew essentially this is very similar to a classic gradient based local optimization and improvements can be built into the process like using conjugate gradients and or deriving step size estimates for the line search from an iterative approximation of the hessian matrix the decisive difference however lies in the computation of the gradient in the classic approach the gradient of the objective function would be determined numerically by a differencing scheme say a forward difference apart from the inherent problem of having to select a suitable delta for each of the free variables 45 45 large enough to be outside any noise of the simulation but small enough for an acceptable approximation of the differential quotient the additional number of simulation runs equals the number of free variables obviously this makes the gradient very expensive to compute and in contrast an adjoint simulation extremely attractive 46 46 an additional bottleneck arises from potential failures of computing all components of the gradient by a differencing scheme if the cad model does not regenerate cleanly the grid does not adapt or regenerate well and or the actual flow simulation is inaccurate or even divergent for only one of the components the gradient may not be available and or may be heavily skewed fig 16 presents a comparison of gradient components from an adjoint simulation and from direct numerical simulations for different variants computed with star ccm for a twisted wing representative of an airfoil or a rudder shown in the lower left part with the adjoint sensitivities for lift the lift as the objective is plotted vs three of the free variables while each triangle in the diagrams relates to a primal solution of the rans equations the red lines entitled sensitivity gradient stems from one single adjoint simulation for the baseline with a thickness of 0 15 m zero twist and zero camber of the suction side actually only one additional simulation would be needed to compute the gradient component from differencing 47 47 here the many additional analyses were undertaken to get an appreciation of the linearity of the objective in the vicinity of the baseline the quality of the parametric adjoint simulation can be seen from fig 16 48 48 it also gives an appreciation of appropriate step sizes for a numerical approximation of the gradient ideally such a study would be undertaken before deciding which step sizes to utilize here the situation is not critical as quite a few different step sizes would yield pretty similar results for more details see weickgenannt 2015 finally apart from tightly coupling a parametric model to the adjoints as discussed above there is a complementing approach of utilizing adjoint simulations from the parametric adjoint gradient the more important free variables can be distinguished from the less important ones subsequently a much reduced set of free variables can be chosen for a classic optimization campaign fig 1 either the adjoint simulation is done for the baseline only or for several variants distributed in search space by means of a doe this means that the adjoints can also be utilized to reduce the effort of a classic sensitivity analysis see also brenner et al 2012 6 4 parametric adjoint optimization of the duct for the parametric adjoint optimization of the duct the process shown in fig 15 was run while design velocities of the selected cad variables are shown in fig 13 the adjoint sensitivities for the baseline are presented in fig 17 the color code suggests where to push in and where to pull out geometry respectively it can be seen that the adjoint sensitivities are not necessarily smoothly distributed over the shape see also figs 16 and 19 this means that if a pure adjoint simulation i e a parameter free optimization was undertaken some grid points on the body boundary would be pulled out or pushed in more than their neighbors without proper smoothing this may quickly result in bumpy shapes by concatenating the adjoint sensitivities and the design velocities as explained above any undesirable wiggles can be readily avoided since by definition in a parametric adjoint approach the shape is restricted to change only as the parametric model allows 49 49 furthermore there is no need to remodel the final shape again within a cad system in other words the parametric model acts as a filter for the information contained in the adjoint sensitivities fig 18 presents a selected design from the parametric adjoint optimization of the duct it is des0015 which features a non dimensional pressure drop of 67 1 which is very close to the pressure drop from the standard optimization found for des0077 fig 7 with many more variants investigated see above the optimization history for the parametric adjoint approach is shown in fig 21 too green polygon it can be seen that the optimization commences with pretty fast improvements that can be attributed to steep gradients towards the end of the optimization process the changes in geometry are small and so are the changes in pressure drop 50 50 this is similar to what could be observed for the kle based optimization 6 5 further example in addition to the duct example again a maritime application shall be briefly shown the details are elaborated in brönstrup 2017 fig 19 presents the adjoint sensitivities computed with star ccm for the kvlcc tanker the kvlcc is a slow steaming very large crude oil carrier whose resistance primarily stems from frictional and viscous pressure losses 51 51 free surface effects were neglected in the study fig 20 shows a comparison of the original hull shown in black and the hull optimized for lower resistance shown in red a reduction of around 2 9 could be realized when allowing slight losses of displacement for the same displacement an improvement of 1 9 was found naturally also the quality of the wake would have to be considered so as not to compromise propulsive efficiency 52 52 a second parametric adjoint optimization was undertaken see brönstrup 2017 with the aim of improving wake homogeneity not shown here 7 summary of results for the duct table 2 summarizes the results from the various sdd campaigns for the duct comparing data from the state of the art approach with the outcome of using both massive parameter reduction and parametric adjoint simulation the history plots of several optimization campaigns are depicted in fig 21 while table 3 summarizes the most important aspects of these approaches since the parametric adjoint simulation requires about twice the effort per variant its iteration history was stretched by a factor of two for a fair comparison hence the effort associated with des0015 of the parametric adjoint simulation fig 18 lies a little above the effort of des0019 of the kle approach fig 9 furthermore it needs to be noted that for some of the campaigns most importantly for the parametric adjoint and for the sobol the numbering of the designs does not linearly correspond to the iteration number of the abscissa this is because only those variants are presented in fig 21 that were feasible observing the inequality constraint on the available space and for which a cfd simulation really took place it can be readily seen that both the kle approach and the parametric adjoint approach speed up the campaigns substantially a really good result stems from the kle approach in which des0028 yields 61 4 of non dimensional pressure drop fig 10 some of the variants following des0028 are a tiny bit better but the campaign could have been stopped at des0028 just as well subjectively des0019 appears to bring about a very good compromise between effort and improvement namely a non dimensional pressure of 63 6 with just 20 cfd runs 53 53 counting the evaluation of the baseline at iteration number 0 too the effort needed to undertake a parametric adjoint simulation is similar to that of the kle approach with des0015 resulting in a non dimensional pressure of 67 1 the effort associated with des0015 is about the same as the effort of 24 cfd runs that only need a primal solution while the improvement is close to that of a standard approach with many more variants namely des0077 from a t search requiring 78 cfd runs it should be noted that additional t search runs could have brought about further improvements and possibly an even better design than those found by the kle approach as can be observed from the history plots shown in fig 21 the values of the objective for those variants preceding or following the selected designs are not so different when studying the associated geometries they also feature slight changes only this indicates that local plateaus in the objective function were reached based on the selected designs the kle approach and the parametric adjoint approach speed up the campaigns by around 3 9 and 3 3 respectively i e a factor above three if the optimizations had been stopped as soon as the selected designs were found naturally it would not be safe to assume that similar speed ups can be expected for other applications nevertheless the comparison illustrates the potential another interesting variant from the standard approach would be des0024 shown in fig 22 it is also marked in fig 21 while the effort for des0024 is in the range of both the kle approach and the parametric adjoint approach the result is a bit less competitive with 75 7 in other words for more or less the same effort the improvement from a standard approach is smaller while a similar improvement see des0077 in figs 21 and 7 can still be realized albeit at higher costs finally it should be kept in mind that it may just have been a lucky strike that the best design was found by the kle approach a possible explanation could be that via the kle variables the design space can be covered more widely with fewer variants in particular if the search is not confined to the convex hull defined by the lower and upper bounds of the cad variables if the objective function is well behaved meaning that not many local extrema occur the chances of finding a very good design for any given number of variants are higher 54 54 within bergmann et al 2018 various duct optimizations were presented too comparing traditional optimization strates to the kle based approach even higher speed ups were reported there but no comparison to a parametric adjoint approach was made 8 qualitative comparison of approaches naturally the duct example discussed was primarily meant to describe the various approaches of sdd in order to get a wider appreciation of effort vs freedom a qualitative view is presented in fig 23 55 55 it is an abstraction of information gathered from many talks with customers and partners of friendship systems users of caeses and simulation engineers utilizing the cfd codes typically coupled to caeses for instance ansys cfx and fluent converge cfd fine marine and fine open flow 3d fresco and ad fresco openfoam pumplinx shipflow star ccm tcfd it also takes into account presentations at users meetings and conferences as well as publications see also references given in harries 2014 it shows at logarithmic scale the simulation effort i e the typical number of simulation runs undertaken 56 56 if only one design point is accounted for this equals the number of variants produced if several operational points are considered the number of variants reduces accordingly vs the dof i e the typical number of free variables chosen for the sake of clarity well defined regions are depicted even though there would actually be some blurriness the most important aspects of the approaches are summarized in table 3 a standard model that is defined in a traditional cad system is typically too cumbersome to employ since too many dof would be involved hence the region entitled traditional cad red box should be interpreted as an indication of what would actually be called for if a design team really wanted to take this path the lower left corner of the region is what some teams at universities larger companies and specialized consultants have managed to realize while the upper end lying in the greyed out area of several ten thousands of variants simply is impractical as explained above most successful optimizations take place in the region named fpm and ppm green box at the lower level of the number of simulation runs surrogates are typically employed at the upper level involving several thousands of simulation runs a standard combination of exploration and exploitation would be found not surprisingly the experience with parameter reductions kle parametric adjoint and adjoint simulations is still rather limited therefore the regions depicted in fig 23 ought to be regarded as first estimates subject to confirmation or adjustment within the next years for the combined parametric adjoint approach blue box the actual number of free variables is not really decisive since the computational burden does not scale up with the dof 57 57 computing the gradient of the objective function does not really cost much as soon as the adjoint solution is available independent of how many parameters are considered as free variables still an advanced parametric model certainly helps to come up with good results finally it should be noted again that a pure adjoint simulation grey box is routinely termed parameter free meaning that here the dof are those parts of the computational mesh that the design team endorsed for modification moreover since adjoint computations build on the availability of highly converged primal solutions the effort per variant is higher than in the other approaches this has been reasonably accounted for in fig 23 58 58 for an adjoint rans simulation the primal solution requires a higher level of convergence than a standard rans simulation weickgenannt 2015 and brönstrup 2017 in addition the adjoint simulation itself also needs time and resources they are in the range of the primal solution itself thus doubling the effort per variant nevertheless not all variants within an adjoint simulation may actually require both a primal and an associated adjoint solution consequently the simulation effort is judged to be a bit less than two times the number of variants investigated 9 conclusions simulation driven design is considered a key technology to improve products beyond the excellent achievements already realized from experience insight and intuition all of which are important aspects of engineering practice instead of assessing just a few selected and manually generated variants the idea of sdd is to utilize simulations extensively in order to propose new and innovative solutions a limiting factor is that simulations particularly flow simulations are still quite expensive therefore the success of any sdd campaign depends on a thoughtful definition of the design task applying suitable parametric models and furthermore combining them with mathematical means of speeding up the process two rather novel approaches of bringing sdd to a new level of sophistication have been discussed with the overarching aim of achieving faster turn around times for the design and optimization of functional surfaces one approach is the replacement of the original cad model with an orthogonal system of new kle variables whose dimensionality is substantially lower than the cad model s dof sacrificing a small percentage of the model s variability another approach is the combination of parameters that control the shape of the product with the sensitivities from an adjoint simulation that capture the influence that small changes of the geometry would have on a predefined objective function massive parameter reductions can be realized via a principle component analysis known as karhunen loève expansion kle the original cad space is replaced by a kle space subsequently only the most important kle variables retaining an acceptable level of variability say 95 and higher of the original parametric model are utilized within an optimization campaign in which much fewer simulations need to be run it can be considered a global approach since the cad space can still be addressed by and large the parametric adjoint approach meanwhile constitutes a local approach by concatenating design velocities and adjoint sensitivities the gradient of the objective function with regard to the free variables is determined for a selected design this then gives the direction for a one dimensional search necessitating only a few additional simulations before repeating the procedure being local the parametric adjoint approach appears to be particularly appealing at the stage of fine tuning 10 outlook a next level of sophistication is to combine the massive reduction of design spaces from a purely geometric point of view with data from flow simulations for instance diez et al 2016 elegantly utilize low and high fidelity flow simulations within their kle analyses albeit at the additional effort of quite many low fidelity and some additional high fidelity cfd runs further enhancements are introduced by d agostino et al 2017 as well as by serani et al 2018 experimenting with nonlinear extensions of the kle approach a complementing idea would be to merge adjoint solutions and kle by using the adjoint sensitivities for the baseline and possibly a handful of variants strategically distributed in design space to weigh the geometric variability with the influence on the flow field and the objective function s of interest naturally also various hybrid approaches could be envisioned such as a first scanning of the design space by means of kle exploration followed by several parametric adjoint optimizations from promising base points exploitation acknowledgments the work undertaken by simon brönstrup aras kavakli and sebastian weickgenannt all of whom were master students at the technical university berlin under the supervision of stefan harries is gratefully acknowledged here special thanks go to hedi böttcher from friendship systems who supported the work reported here with great enthusiasm and skill parts of the work presented stem from the german r d projects gamma 03et1469d form pro 03sx280b and nowelle 03sx362d these projects were administered by ptj and funded by the federal republic of germany federal ministry of economics and technology on the orders of the german bundestag 
22333,the lumping block method is usually adopted to reduce the sea states in the wave scatter diagram for the practical engineering fatigue design and the equivalent parameters in the lumping blocks are of vital importance for accurately predicting the long term fatigue damage in this study a comparison of the mooring line fatigue damage calculated by the existing lumping block equivalent methods is conducted and an improved lumping block equivalent method is proposed the fatigue damage for the original sea states is calculated as a benchmark a series of dynamic analysis of the fish cage system for the equivalent sea states obtained by six existing equivalent methods are carried out to estimate the fatigue damage of mooring lines however the existing equivalent methods are unable to achieve the accurate estimation of the fatigue damage of mooring system then the improved lumping block equivalent method through selecting the more severe significant wave period for each mooring line is proposed based on the slightly conservative principle for the individual block and the relationship between the fatigue damage and the significant wave period the results indicate that the proposed improved equivalent method is robust and efficient for accurately evaluating the fatigue damage of mooring system keywords fatigue damage lumping block equivalent method mooring system 1 introduction fatigue damage of mooring system for fish cages may occur and result in a significant consequence of economic loss after a long period operation of the fish cage system as one of the primary potential failure modes of mooring system the fatigue failure requires more attention during the design phase for the safety of fish cage system due to the low computational demanding the spectral fatigue method in the frequency domain is extensively employed in the fatigue assessment of mooring line for the offshore structures e g gao and moan 2007 low and cheung 2012 li et al 2016 chen and basu 2018 however the frequency domain method is less accurate than the time domain method for the fatigue damage assessment naess and moan 2013 especially when the coupled dynamic behavior of the offshore structures under environmental loads is strongly nonlinear and for the fish cage system the frequency domain method may underestimate the mooring line fatigue damage for some wave states xu et al 2014 thus the time domain method should be employed for accurately calculating the mooring line fatigue damage in the long term wave conditions however the dynamic analysis in time domain for a large number of sea states in wave scatter diagram is computationally expensive especially for the fatigue analysis of mooring lines in the irregular waves therefore it is necessary to propose a robust and efficient method to improve the computational efficiency for accurately predicting the fatigue damage of mooring system for the fatigue design of fish cage system the lumping block method through lumping the original sea states into blocks to generate a series of equivalent sea states is one of the available and efficient ways to reduce the number of sea states in the wave scatter diagram for the fatigue damage assessment however the selection of representative sea states in the lumping block plays a critical role in achieving the accurate fatigue damage for the wave scatter diagram several researches were conducted to estimate the equivalent wave parameters in the lumping block of the wave scatter diagram and the primary problem is how to deal with the equivalent significant wave height and significant wave period in the lumping block the software sesam deep 2010 adopted the sum of the largest wave height and the wave height interval as the representative wave height for conservatism and employed the sum of the average of significant wave period and a half wave period interval as the representative significant wave period sheehan et al 2006 and dnvgl rp f204 2017 extracted the largest wave height and the probabilistic average of the wave period in a lumping block as the wave height and wave period of the representative sea state during the fatigue assessment of a riser instead of directly selecting the wave parameters from the original sea states several assumptions about the relationship between the fatigue damage and the wave parameters were adopted based on the fatigue equivalence rule jia 2008 calculated the equivalent wave height based on the assumption of the proportional relationship between the fatigue damage and the 3rd power of the significant wave height 3 is the slope parameter in the s n curve and the weighted significant wave period in the block was selected as the equivalent significant wave period this equivalent method means that the different equivalent significant wave heights are adopted for different materials of the structural system which may be not realistic and practical for the complex system song and wang 2019 estimated the equivalent significant wave height by the spectral moments equivalent method assuming the fatigue damage is proportional to the ith power of the spectral wave energy and calculating the i by the regression method however the relationship between the fatigue damage and the second spectral moment was obtained by analogy to the relationship between the fatigue damage and the spectral wave energy instead of the regression method which will misestimate the equivalent significant wave period of the equivalent sea states and then may lead to significantly non conservative fatigue damage in some lumping blocks the fatigue damage assessment of the fish farm in the time domain analysis was conducted in huang and pan 2010 thomassen and leira 2012 xu et al 2014 and hou et al 2018 however in terms of the lumping block method for the long term wave conditions the fatigue damage of mooring system for the fish cages is necessary to be assessed and it is of vital importance to adopt the most efficient and accurate lumping block method for the fatigue design of mooring system thus a comparison of the lumping block equivalent methods proposed in previous researches is conducted and then an improved lumping block equivalent method for the equivalent sea states is proposed to predict the fatigue damage for the long term wave conditions in this study the paper is organized as follows section 2 presents the fatigue analysis of mooring system for the fish cage under the wave loads section 3 describes the estimation of the equivalent wave parameters by several existing lumping block equivalent methods and then a comparison of the lumping block equivalent methods is conducted in section 4 after that an improved lumping block equivalent method is proposed in section 5 finally some conclusions are presented in section 6 2 fatigue analysis of mooring system for the fish cage in this study the self developed numerical model based on the lumped mass method and the rigid body kinematics theory is adopted to calculate the mooring tension for the fish cage in irregular waves after considering the computational affordability in which the hydrodynamic response was validated in xu et al 2013 by comparing with the experimental data then the fatigue damage evaluation of mooring lines by the s n approach is carried out 2 1 brief description of the wave field the modified jonswap spectrum is used in this study and formulated in eq 1 1 s f β j h s 2 t p 4 f 5 exp 1 25 t p f 4 γ exp f f p 1 2 2 μ 2 where β j 0 06238 0 230 0 0336 γ 0 185 1 9 γ 1 1 094 0 01915 ln γ f and f p are the wave frequency and the spectral peak frequency respectively t p is the spectral peak period and t s is the significant wave period t p t s 1 0 132 γ 0 2 0 559 h s is the significant wave height γ is the peak enhancement factor γ 3 3 μ is the peak shape factor μ 0 07 when 0 f f p and μ 0 09 when f f p the water particles velocity for the irregular waves is obtained by summing the velocity of multiple monochromatic waves calculated by the airy wave theory 2 u x z t i 1 n a i 2 π f i cosh k i z h sinh k i h cos k i x 2 π f i t ε i 3 w x z t i 1 n a i 2 π f i sinh k i z h sinh k i h sin k i x 2 π f i t ε i for sections 4 and 5 the long term wave conditions in one year represented by the 102 short term sea states amrutha and kumar 2015 are shown in table 1 where h s is the significant wave height and t s is the significant wave period 2 2 fish cage and mooring system a sketch of the fish cage with the grid mooring system is shown in figs 1 and 2 and the corresponding detailed parameters are listed in table 2 the fish cage which is moored to the sea ground by a submerged mooring grid with the water depth of 20 m is comprised of the float collar the net and the sinkers the knotless net is mounted as the diamond shape and forms a vertical cylinder the 15 spherical sinkers are used as the weighted system and the mass of each sinker is 23 0 kg the square submerged mooring grid at 4 m below the water surface has a side length of 40 m and consists of four grid lines length 40 m and the submerged mooring grid connects with the middle net cage by four bridle lines length 20 86 m and connects with the buoy by four buoy lines length 4 m and it is connected with the sea bottom by eight anchor lines length 58 8 m the mooring line is composed of the fiber rope and the shackle chains chain connectors the elasticity of the fiber rope in mooring lines is t 562 δ l l 1 132 where t is the tension of mooring line with the unit of kn δ l and l are the elongation and the initial length of mooring line respectively in this study the diameter of shackle chains is 16 mm and the fatigue damage of shackle chains in the mooring lines is considered weller et al 2015 ma et al 2013 2 3 wave loads as the primary cyclic environmental load the wave force on the fish cage system is calculated figs 3 and 4 present the basic elements for the net the mooring line and the float collar subjected to wave loads in the net cage system a local coordinate system τ η ξ for the net and mooring line is defined for rigid collar two sets of coordinate systems are included the fixed coordinate system o xyz and the body coordinate o x y z the hydrodynamic force on the float collar is calculated through summing the external forces on each element of the float collar based on the lumped mass method the external forces on each element of the net and the mooring line are evaluated and then evenly distributed to the corresponding nodes for the element of the fish net and the float collar the ratio of the element size to the wave length d l satisfies the expression that d l 0 2 as demonstrated in fig 5 the effect of the wave diffraction can be neglected isaacson 1979 kappos 2002 sumer and fredsøe 2006 thus the morison equation considering the relative motion to the structural element is applied and given as 4 f 1 2 c d ρ a u r u r ρ v 0 u c m ρ v 0 u r where f is the hydrodynamic force on the element c d and c m are the drag coefficient and the added mass coefficient respectively ρ is the water density a and v 0 are the effective projected area and the water displaced volume of an element u and r are the fluid particle velocity vector at the element center and the central velocity vector of the element u and r are the fluid particle acceleration vector and the element acceleration at the element center respectively the hydrodynamic coefficient can be obtained based on a series of physical model tests for the float collar the drag coefficients and the added mass coefficients are chosen as c d τ c d η c d ξ 0 4 0 6 0 6 and c m τ c m η c m ξ 0 0 0 2 0 2 respectively li et al 2007 for the net twine and the mooring line the hydrodynamic coefficient can be calculated by choo and casarella 1971 5 c η 8 π re η s 1 0 87 s 2 0 re η 1 1 45 8 55 re η 0 90 1 re η 30 1 1 4 re η 0 50 30 re η 10 5 6 c τ π μ 0 55 re η 1 2 0 084 re η 2 3 where c η and c τ are the drag coefficients for the mesh bar in the normal and tangential directions respectively μ is the water viscosity re η ρ v r η d μ s 0 077215665 ln 8 re η ρ is the water density v r η is the normal component of the fluid velocity relative to the bar 2 4 fatigue damage analysis in this study the prediction of the accumulative fatigue damage of mooring lines is performed based on the s n approach through adopting the miner s rule the fatigue damage d i for the ith sea state is determined by the following expression 7 d i j 1 n 1 n s i j where s ij and n s ij are the stress range at the jth loading cycle and the number of cycles to failure at the stress range s ij which can be obtained by the rainflow counting method the single slope s n curve is employed and can be formulated as 8 n s m k where n is the number of cycles of stress range s to failure m and k are the slope and intercept parameters of s n curve respectively for the shackle chains the parameters m and k can be determined as 3 0 and 6 0 10 10 referring to dnv os e301 2013 and standards norway ns 9415 2009 substituting eq 8 into eq 7 the fatigue damage is obtained by 9 d i j 1 n s i j m 1 k the time history of the tension force on the mooring line in the numerical simulations is employed to calculate the fatigue damage of mooring line during the analysis duration 3 h in this study then the accumulative fatigue damage of mooring line in 3 h is calculated by eq 10 10 d i 1 n p i d 3 h i where d is the accumulative fatigue damage p i is the occurrence probability of the ith sea state d 3h i is the short term fatigue damage of mooring line for the ith sea state in the wave scatter diagram 3 equivalent wave parameters a series of equivalent sea states in the lumping blocks are used to calculate the accumulative fatigue damage of the mooring line the lumping block equivalent methods can be employed to estimate the equivalent wave parameters of the equivalent sea states including the significant wave height the significant wave period and the probability of occurrence the probability of occurrence of the equivalent sea state in the jth lumping block containing n j original sea states is conventionally calculated by the sum of the occurrence probability of the original sea states in this block 11 p j i 1 n j p i j the equivalent significant wave height and the equivalent significant wave period obtained by several existing equivalent methods are shown as follows 3 1 equivalent significant wave height for the equivalent significant wave height in the jth lumping block sesam method deep 2010 suggested that the equivalent significant wave height can be expressed by the sum of the largest significant wave height and the wave height interval given as 12 h s j se max 1 i n j h s i j δ h s 2 sheehan et al 2006 adopted the largest significant wave height in the lumping block as the equivalent significant wave height of the block 13 h s j sh max 1 i n j h s i j assuming that the fatigue damage is proportional to the mth power of the significant wave height m is the slope parameter of s n curve jia 2008 calculated the equivalent significant wave height by 14 h s j ji i 1 n j p i j h s i j m i 1 n j p i j m with respect to song and wang 2019 the equivalent significant wave height related to the wave spectral moments can be given as 15 h s j so 4 0 n j 1 4 m n j i 1 n j m 0 i j γ m p i j i 1 n j p i j 1 γ m where m 0i j is the spectral wave energy of ith original sea state γ is the exponent of the spectral wave energy related to the slope of the s n curve and it is determined to be 2 m based on the assembled data by the regression method when the wave spectrum is assumed to be narrow banded eq 15 satisfies that the fatigue damage is proportional to the 4th power of the significant wave height which was consistent with kühn 2001 however the correction related to the number of the original sea states in the blocks and the s n curve slope is considered in eq 15 3 2 equivalent significant wave period for the equivalent significant wave period in the jth lumping block sesam deep 2010 suggested the sum of a half wave period interval and the averaging significant wave period in the block as the equivalent significant wave period written as 16 t s j se i 1 n j t s i j n j δ t z 2 sheehan et al 2006 jia 2008 and dnvgl rp f204 2017 obtained the equivalent significant wave period through averaging the significant wave period in the block based on the occurrence probability of the original sea states which is expressed as 17 t s j sh i 1 n j p i j t s i j i 1 n j p i j in song and wang 2019 the equivalent significant wave period related to the wave spectral moments was given as 18 t s j so 2 π i 1 n j m 0 i j γ m p i j i 1 n j p i j 1 γ m i 1 n j m 2 i j γ m p i j i 1 n j p i j 1 γ m where m 2i j is the second spectral moment of the ith original sea state γ is determined as 2 m which is analogy to eq 15 in addition kühn 2001 adopted the probabilistic wave frequency in the block as the equivalent wave frequency and then the equivalent significant wave period can be obtained by 19 t s j ku i 1 n j p i j t s i j i 1 n j p i j 1 in summary the equivalent wave parameters in the lumping blocks can be evaluated by six lumping block equivalent methods presented in table 3 4 comparison of fatigue damage obtained from several existing equivalent methods numerical simulations for the equivalent sea states with 3 h duration are conducted to obtain the fatigue damage of mooring lines for fish cage the stress range in terms of the loading cycle is calculated by the rainflow counting method and the fatigue damage of mooring line for the long term sea states is predicted by the s n approach since the mooring system is symmetrical with respect to the wave propagation direction the fatigue damage of the eleven mooring lines l 1 l 4 l 9 l 10 l 13 l 14 l 16 l 17 and l 18 is presented the effect of the lumping block equivalent methods and the numbers of the lumping blocks on the fatigue damage of the mooring line is investigated tables 4 6 present the partitions of the wave scatter diagram for different numbers of the lumping blocks the equivalent wave parameters for the equivalent sea states can be obtained through the lumping block equivalent methods depicted in section 3 herein only the equivalent wave parameters by method 6 in table 3 for 42 26 and 16 blocks are given in tables 7 9 respectively the quotient q is defined as the ratio of the fatigue damage for the equivalent sea states d e estimated by the equivalent methods in section 3 and that calculated using the original sea states d o given as 20 q d e d o when the quotient q obtained from the equivalent lumping block method is equal or slightly larger than 1 0 the equivalent method is considered as accurate figs 6 8 present the quotient q of mooring lines calculated from different equivalent methods for 42 26 and 16 lumping blocks respectively the results indicate that method 1 always significantly overestimates the fatigue damage of mooring line especially with the decrease of the lumping blocks this may be too conservative for the fatigue design of mooring lines and will increase the economic cost drastically in the practical engineering design in terms of method 2 the fatigue damage for 42 blocks is conservative however with the decrease of the number of the lumping blocks the fatigue damage of mooring lines obtained by method 2 is overly conservative and obviously sensitive although the fatigue damage of mooring line by method 3 is less sensitive to the number of the lumping blocks than that by method 1 and method 2 the quotient q for some mooring lines is significantly less than 1 0 which demonstrates that the fatigue design by the equivalent sea states using method 3 is dangerous for the integrity of mooring lines and comparing method 2 with method 3 the significant sensitivity of the fatigue damage to the number of the lumping blocks may be attributed to the selection of the equivalent significant wave height thus the equivalent significant wave height should be calculated carefully to avoid the high sensitivity of fatigue damage to the lumping block number fatigue damage calculated using method 4 seems slightly conservative for most of mooring lines which is similar to the results in song and wang 2019 notably the fatigue damage of the l 4 line is surprisingly underestimated which is non conservative for the anchor line design and method 5 underestimates the fatigue damage of the grid line l 13 the fatigue damage results by method 6 are generally between those by method 4 and method 5 for 42 equivalent sea states the fatigue damage of mooring lines by method 6 is the most accurate and slightly conservative thus method 6 seems to be more reasonable than other equivalent methods for providing the slightly conservative fatigue damage of mooring system however for 26 and 16 blocks the fatigue damage of the l 4 line calculated by method 6 is underestimated which may result in dangerous design and should be avoided during the mooring line design to clearly investigate the sensitivity of the number of the lumping blocks in terms of methods 4 6 fig 9 presents the quotient q of the mooring lines for 42 26 and 16 blocks for different mooring lines the underestimation or overestimation of the fatigue damage appears or largely increases with the decrease of the number of equivalent sea states it is found that the fatigue damage of mooring lines calculated by methods 4 6 is not sensitive to the number of the equivalent sea states this demonstrates that the equivalent significant wave period has negligible influence on the sensitivity of the fatigue damage of mooring lines to the lumping blocks partitions in summary the sensitivity of the accuracy of the lumping block equivalent method to the number of the lumping blocks depends on the selection of the equivalent significant wave height and methods 1 6 in table 3 are unable to achieve the accurate estimation of the fatigue damage of mooring system for fish cage considering the individual blocks for 42 equivalent sea states the quotient q j for the jth block is written as 21 q j d e j d o j where d e j is the product of the fatigue damage for the jth block and the corresponding occurrence probability d o j is the sum of the weighted fatigue damage for the original sea states in the jth block fig 10 shows the quotient q of mooring lines for every block calculated from method 4 the results indicate that the fatigue damage of mooring lines l 1 l 4 and l 9 for some individual blocks is underestimated obviously although method 2 gives conservative fatigue damage for the long term sea states the fatigue damage of mooring line l 4 for several blocks is underestimated significantly as shown in fig 11 due to little contribution of the underestimated blocks to the probabilistic average of the fatigue damage the fatigue damage of the l 1 and l 9 lines obtained by method 4 is conservative as shown in fig 6 and similarly method 2 produces the conservative fatigue damage of the l 4 line however method 4 cannot properly predict the fatigue damage of anchor line l 4 it may be attributed to the considerably large occurrence probability of the lumping blocks where the fatigue damage of mooring line is highly underestimated more importantly it is impractical to conduct a fine discretization of the wave scatter diagram for all engineering structures to avoid the underestimation of the fatigue damage for the long term sea states thus method 4 is not robust to the fatigue damage assessment of different mooring lines for the fish cage which may have great influence on the reliable evaluation for the fatigue design of mooring system in the fish farm associated with the equivalent wave parameters by the equivalent methods in the lumping blocks the reason for misestimating the fatigue damage of mooring line is discussed as follows the equivalent wave height obtained by method 1 is larger than that from other equivalent methods and it is also larger than the largest significant wave height in the corresponding lumping block this leads to a considerable error accumulation of fatigue damage from each lumping block comparing method 2 with method 3 the larger significant wave height induces the larger fatigue damage of mooring lines for the same significant wave period the relationship between the fatigue damage of mooring line l 1 and the spectral wave energy employed in method 4 is shown in figs 12 and 13 the black solid line in fig 12 has a slope of 2 0 which is consistent with the assumption in eq 15 with the variation of significant wave height in the lumping block eq 15 can generally capture the characteristic of fatigue damage however due to the high sensitivity to wave period as seen from fig 13 it may be not suitable to adopt the assumption that the fatigue damage of mooring lines is proportional to the second spectral moment which was in analogy to the relationship between the fatigue damage and the spectral wave energy in song and wang 2019 fig 14 shows the quotient q 13 of mooring lines for no 13 block in 42 blocks estimated from methods 4 6 this indicates that the sensitivity to the significant wave period will have a great impact on the fatigue damage of mooring lines in the lumping block with a large range of significant wave period thus it is necessary to propose a robust and accurate equivalent method for selecting the appropriate equivalent significant wave periods in the lumping blocks in the fatigue design of mooring lines 5 improved lumping block equivalent method as discussed in section 4 the existing lumping block equivalent method may lead to an excessive overestimation or underestimation of the fatigue damage of mooring lines for the fish cage in this section an improved equivalent method is proposed to accurately predict the long term fatigue damage for the lumping blocks the objective of the improved equivalent method is to yield the slightly conservative results for the individual lumping blocks as shown in fig 12 it is reasonable that the equivalent significant wave height is determined based on the assumption of the spectral moments equivalent method in song and wang 2019 in term of the equivalent significant wave period the most severe period for the blocks with a high period sensitivity should be calculated as recommended by dnvgl rp f204 2017 to avoid the excessive conservatism of the most severe significant wave period in the lumping block the more severe significant wave period between the equivalent significant wave periods calculated by methods 4 6 is employed as the equivalent significant wave period in the improved lumping block equivalent method as a result according to the relationship between the fatigue damage and the significant wave period the more severe significant wave periods for the equivalent sea states in the lumping blocks can be selected therefore the improved lumping block equivalent method for the long term sea states is put forward based on the selection of the more severe significant wave period in the lumping blocks the flow chart of the improved lumping block equivalent method is presented in fig 15 and the detailed procedures are shown as follows firstly the sensitivity of the fatigue damage of mooring lines for fish cage to the significant wave period is investigated for simplicity it is assumed that the trend for the relationship between the fatigue damage of mooring lines and the significant wave period is similar for different significant wave heights fig 16 plots the fatigue damage of the anchor lines and the upper layer lines the grid lines the buoy lines and the bridle lines with the variation of the significant wave period for the significant wave height of 0 75 m the fatigue damage of mooring lines is very sensitive to the significant wave period in the range of 4 s 11 s for mooring line l 4 the fatigue damage has two local minimum points for the significant wave period of 4 s 7 s and it also has two local maximum points for the significant wave period of 5 s 11 s this indicates that the traditional lumping block equivalent methods are not accurate to adopt a monotonous function for describing the relationship between the fatigue damage of all mooring lines and the equivalent significant wave period especially for the lumping blocks with the high sensitivity to wave periods thus in the improved lumping block equivalent method the more severe significant wave period of the equivalent sea state can be determined based on the relationship between the fatigue damage of different mooring lines and the significant wave period secondly the subdivision of some lumping blocks with the high sensitivity to wave periods is conducted due to the complicated relationship between the fatigue damage and the significant wave period in the range of 5 s 9 s the no 13 block in the 42 equivalent sea states obviously underestimates the fatigue damage of the l 1 and l 4 lines as shown in figs 10 and 11 through subdividing the no 13 block into two blocks with the significant wave period of 5 s 7 s and 9 s the fatigue damage of mooring lines is evaluated through selecting the more severe significant wave period as the equivalent significant wave period for the individual subdivided blocks then the probabilistic fatigue damage of the subdivided blocks is summed as the fatigue damage in the no 13 block to keep the number of the lumping blocks unchanged based on the similar way the no 8 block in the 26 equivalent sea states and the nos 2 5 block in the 16 equivalent sea states are subdivided into the two blocks with the significant wave period of 5 s 7 s and 9 s according to the variation of the fatigue damage of mooring lines with the significant wave period the more severe significant wave period for each mooring line is selected as the equivalent significant wave period for the individual lumping blocks as shown in table 10 only the lumping blocks including more than one significant wave period are presented here and the equivalent significant wave height of a lumping block for all the mooring lines is identical thus a new group of the equivalent sea states with the equivalent significant wave periods in table 10 and the equivalent significant wave height calculated by eq 15 is generated then the numerical simulations for the equivalent sea states in the new group are performed and the corresponding fatigue damage of mooring lines is estimated figs 17 20 present the quotient q of mooring lines for fish cage which is calculated from the improved lumping block equivalent method for different numbers of the equivalent sea states in the individual lumping blocks in general the fatigue damage for the individual lumping blocks and the long term sea states can be estimated by the improved equivalent method with the slight conservatism and the fatigue damage of the l 1 and l 4 lines for the individual blocks calculated by the improved equivalent method is significantly larger than that calculated by method 4 as shown in fig 10 and the quotient q of mooring lines for the long term wave condition estimated from the improved lumping block equivalent method is presented in fig 21 the results indicate that the fatigue damage for the whole mooring system obtained by the improved equivalent method is slightly conservative the largest quotient appears at the l 9 line for the 16 blocks with a value of 1 36 which is close to that in fig 9 of method 4 for the mooring lines except the anchor line l 4 the improved equivalent method still produces a slightly conservative fatigue damage result which is similar to the spectral moments equivalent method however the fatigue damage of the l 4 line obtained by the improved equivalent method is more accurate than that calculated by method 4 this demonstrates that the improved equivalent method can effectively avoid a significant underestimation of the fatigue damage for each block after considering the period sensitivity of fatigue damage therefore the proposed improved lumping block equivalent method is accurate to estimate the fatigue damage of mooring lines for the equivalent sea states the robustness of the improved lumping block method to different block partitions for the mooring lines for the fish cage is investigated as shown in fig 21 the fatigue damage of the l 4 line for different block partitions is still slightly conservative comparing with the reference result of the original sea states and the fluctuation of fatigue damage is not large with the decrease of the numbers of lumping blocks for the other mooring lines the equivalent sea states for different numbers of lumping blocks yield a rather accurate and slightly conservative result thus the improved lumping block equivalent method is robust to the lumping block partitions and different mooring lines with regard to the computational complexity the dynamic analysis for 12 wave cases needs to be performed for calculating the relationship between the fatigue damage of mooring line and the significant wave period for the 42 equivalent sea states in method 4 the extra 13 wave cases for the equivalent significant wave period in table 10 are analyzed for the 26 and 16 lumping blocks the extra 10 and 8 wave cases are analyzed respectively thus the total amount of the wave states for the 42 26 and 16 lumping blocks is 55 36 and 24 respectively this demonstrates that the improved equivalent method effectively reduces the computational effort comparing with that for the original sea states in summary the improved equivalent method for the equivalent wave parameters in the lumping blocks is accurate and efficient to predict the fatigue damage of mooring lines for the fish cage 6 conclusions the accumulative fatigue damage of mooring lines for the fish cage is predicted for the long term wave conditions based on the s n curve and the rainflow counting method the lumping block method is adopted to reduce the sea states in the wave scatter diagram and the equivalent wave parameters in the lumping block are estimated by six existing equivalent methods comparison of the fatigue damage obtained from the six equivalent methods is conducted and then an improved equivalent method is proposed to evaluate the fatigue damage in the lumping blocks several conclusions can be drawn as follows the sensitivity of the accuracy of the lumping block equivalent method to the number of the lumping blocks depends on the selection of equivalent significant wave height the fatigue damage predicted by the spectral moments equivalent method seems to be accurate and slightly conservative for most of mooring lines but the fatigue damage of the l 4 line is surprisingly underestimated it may be because the fatigue damage of the l 4 line has the high sensitivity to wave period which induces that the assumption of the relationship between the fatigue damage and the second spectral moment is no longer applicable although the equivalent significant wave period based on the probabilistic wave frequency seems more reasonable the fatigue damage of the l 4 line is significantly non conservative for the 26 and 16 blocks it may be attributed to the excessive underestimation of the fatigue damage of mooring line l 4 for several individual blocks in addition the equivalent significant wave period has a large influence on the fatigue damage of mooring lines especially for a large range of significant wave period in the lumping block then the improved lumping block equivalent method is proposed based on the selection of the more severe significant wave period for each mooring line and the slightly conservative principle for the individual block the results indicate that the proposed improved lumping block equivalent method is robust and accurate to reduce the equivalent sea states for evaluating the fatigue damage of mooring system in the future work the fatigue damage distribution associated with the uncertainty of the environmental condition based on the improved lumping block equivalent method is worth investigating to predict the fatigue reliability of the grid mooring system for the safety of mooring system in fish farms declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by national key r d program of china 2017yfc1404200 the national natural science foundation nsfc projects no 51979037 and no 51979029 and the fundamental research funds for the central universities no dut18lk41 
22333,the lumping block method is usually adopted to reduce the sea states in the wave scatter diagram for the practical engineering fatigue design and the equivalent parameters in the lumping blocks are of vital importance for accurately predicting the long term fatigue damage in this study a comparison of the mooring line fatigue damage calculated by the existing lumping block equivalent methods is conducted and an improved lumping block equivalent method is proposed the fatigue damage for the original sea states is calculated as a benchmark a series of dynamic analysis of the fish cage system for the equivalent sea states obtained by six existing equivalent methods are carried out to estimate the fatigue damage of mooring lines however the existing equivalent methods are unable to achieve the accurate estimation of the fatigue damage of mooring system then the improved lumping block equivalent method through selecting the more severe significant wave period for each mooring line is proposed based on the slightly conservative principle for the individual block and the relationship between the fatigue damage and the significant wave period the results indicate that the proposed improved equivalent method is robust and efficient for accurately evaluating the fatigue damage of mooring system keywords fatigue damage lumping block equivalent method mooring system 1 introduction fatigue damage of mooring system for fish cages may occur and result in a significant consequence of economic loss after a long period operation of the fish cage system as one of the primary potential failure modes of mooring system the fatigue failure requires more attention during the design phase for the safety of fish cage system due to the low computational demanding the spectral fatigue method in the frequency domain is extensively employed in the fatigue assessment of mooring line for the offshore structures e g gao and moan 2007 low and cheung 2012 li et al 2016 chen and basu 2018 however the frequency domain method is less accurate than the time domain method for the fatigue damage assessment naess and moan 2013 especially when the coupled dynamic behavior of the offshore structures under environmental loads is strongly nonlinear and for the fish cage system the frequency domain method may underestimate the mooring line fatigue damage for some wave states xu et al 2014 thus the time domain method should be employed for accurately calculating the mooring line fatigue damage in the long term wave conditions however the dynamic analysis in time domain for a large number of sea states in wave scatter diagram is computationally expensive especially for the fatigue analysis of mooring lines in the irregular waves therefore it is necessary to propose a robust and efficient method to improve the computational efficiency for accurately predicting the fatigue damage of mooring system for the fatigue design of fish cage system the lumping block method through lumping the original sea states into blocks to generate a series of equivalent sea states is one of the available and efficient ways to reduce the number of sea states in the wave scatter diagram for the fatigue damage assessment however the selection of representative sea states in the lumping block plays a critical role in achieving the accurate fatigue damage for the wave scatter diagram several researches were conducted to estimate the equivalent wave parameters in the lumping block of the wave scatter diagram and the primary problem is how to deal with the equivalent significant wave height and significant wave period in the lumping block the software sesam deep 2010 adopted the sum of the largest wave height and the wave height interval as the representative wave height for conservatism and employed the sum of the average of significant wave period and a half wave period interval as the representative significant wave period sheehan et al 2006 and dnvgl rp f204 2017 extracted the largest wave height and the probabilistic average of the wave period in a lumping block as the wave height and wave period of the representative sea state during the fatigue assessment of a riser instead of directly selecting the wave parameters from the original sea states several assumptions about the relationship between the fatigue damage and the wave parameters were adopted based on the fatigue equivalence rule jia 2008 calculated the equivalent wave height based on the assumption of the proportional relationship between the fatigue damage and the 3rd power of the significant wave height 3 is the slope parameter in the s n curve and the weighted significant wave period in the block was selected as the equivalent significant wave period this equivalent method means that the different equivalent significant wave heights are adopted for different materials of the structural system which may be not realistic and practical for the complex system song and wang 2019 estimated the equivalent significant wave height by the spectral moments equivalent method assuming the fatigue damage is proportional to the ith power of the spectral wave energy and calculating the i by the regression method however the relationship between the fatigue damage and the second spectral moment was obtained by analogy to the relationship between the fatigue damage and the spectral wave energy instead of the regression method which will misestimate the equivalent significant wave period of the equivalent sea states and then may lead to significantly non conservative fatigue damage in some lumping blocks the fatigue damage assessment of the fish farm in the time domain analysis was conducted in huang and pan 2010 thomassen and leira 2012 xu et al 2014 and hou et al 2018 however in terms of the lumping block method for the long term wave conditions the fatigue damage of mooring system for the fish cages is necessary to be assessed and it is of vital importance to adopt the most efficient and accurate lumping block method for the fatigue design of mooring system thus a comparison of the lumping block equivalent methods proposed in previous researches is conducted and then an improved lumping block equivalent method for the equivalent sea states is proposed to predict the fatigue damage for the long term wave conditions in this study the paper is organized as follows section 2 presents the fatigue analysis of mooring system for the fish cage under the wave loads section 3 describes the estimation of the equivalent wave parameters by several existing lumping block equivalent methods and then a comparison of the lumping block equivalent methods is conducted in section 4 after that an improved lumping block equivalent method is proposed in section 5 finally some conclusions are presented in section 6 2 fatigue analysis of mooring system for the fish cage in this study the self developed numerical model based on the lumped mass method and the rigid body kinematics theory is adopted to calculate the mooring tension for the fish cage in irregular waves after considering the computational affordability in which the hydrodynamic response was validated in xu et al 2013 by comparing with the experimental data then the fatigue damage evaluation of mooring lines by the s n approach is carried out 2 1 brief description of the wave field the modified jonswap spectrum is used in this study and formulated in eq 1 1 s f β j h s 2 t p 4 f 5 exp 1 25 t p f 4 γ exp f f p 1 2 2 μ 2 where β j 0 06238 0 230 0 0336 γ 0 185 1 9 γ 1 1 094 0 01915 ln γ f and f p are the wave frequency and the spectral peak frequency respectively t p is the spectral peak period and t s is the significant wave period t p t s 1 0 132 γ 0 2 0 559 h s is the significant wave height γ is the peak enhancement factor γ 3 3 μ is the peak shape factor μ 0 07 when 0 f f p and μ 0 09 when f f p the water particles velocity for the irregular waves is obtained by summing the velocity of multiple monochromatic waves calculated by the airy wave theory 2 u x z t i 1 n a i 2 π f i cosh k i z h sinh k i h cos k i x 2 π f i t ε i 3 w x z t i 1 n a i 2 π f i sinh k i z h sinh k i h sin k i x 2 π f i t ε i for sections 4 and 5 the long term wave conditions in one year represented by the 102 short term sea states amrutha and kumar 2015 are shown in table 1 where h s is the significant wave height and t s is the significant wave period 2 2 fish cage and mooring system a sketch of the fish cage with the grid mooring system is shown in figs 1 and 2 and the corresponding detailed parameters are listed in table 2 the fish cage which is moored to the sea ground by a submerged mooring grid with the water depth of 20 m is comprised of the float collar the net and the sinkers the knotless net is mounted as the diamond shape and forms a vertical cylinder the 15 spherical sinkers are used as the weighted system and the mass of each sinker is 23 0 kg the square submerged mooring grid at 4 m below the water surface has a side length of 40 m and consists of four grid lines length 40 m and the submerged mooring grid connects with the middle net cage by four bridle lines length 20 86 m and connects with the buoy by four buoy lines length 4 m and it is connected with the sea bottom by eight anchor lines length 58 8 m the mooring line is composed of the fiber rope and the shackle chains chain connectors the elasticity of the fiber rope in mooring lines is t 562 δ l l 1 132 where t is the tension of mooring line with the unit of kn δ l and l are the elongation and the initial length of mooring line respectively in this study the diameter of shackle chains is 16 mm and the fatigue damage of shackle chains in the mooring lines is considered weller et al 2015 ma et al 2013 2 3 wave loads as the primary cyclic environmental load the wave force on the fish cage system is calculated figs 3 and 4 present the basic elements for the net the mooring line and the float collar subjected to wave loads in the net cage system a local coordinate system τ η ξ for the net and mooring line is defined for rigid collar two sets of coordinate systems are included the fixed coordinate system o xyz and the body coordinate o x y z the hydrodynamic force on the float collar is calculated through summing the external forces on each element of the float collar based on the lumped mass method the external forces on each element of the net and the mooring line are evaluated and then evenly distributed to the corresponding nodes for the element of the fish net and the float collar the ratio of the element size to the wave length d l satisfies the expression that d l 0 2 as demonstrated in fig 5 the effect of the wave diffraction can be neglected isaacson 1979 kappos 2002 sumer and fredsøe 2006 thus the morison equation considering the relative motion to the structural element is applied and given as 4 f 1 2 c d ρ a u r u r ρ v 0 u c m ρ v 0 u r where f is the hydrodynamic force on the element c d and c m are the drag coefficient and the added mass coefficient respectively ρ is the water density a and v 0 are the effective projected area and the water displaced volume of an element u and r are the fluid particle velocity vector at the element center and the central velocity vector of the element u and r are the fluid particle acceleration vector and the element acceleration at the element center respectively the hydrodynamic coefficient can be obtained based on a series of physical model tests for the float collar the drag coefficients and the added mass coefficients are chosen as c d τ c d η c d ξ 0 4 0 6 0 6 and c m τ c m η c m ξ 0 0 0 2 0 2 respectively li et al 2007 for the net twine and the mooring line the hydrodynamic coefficient can be calculated by choo and casarella 1971 5 c η 8 π re η s 1 0 87 s 2 0 re η 1 1 45 8 55 re η 0 90 1 re η 30 1 1 4 re η 0 50 30 re η 10 5 6 c τ π μ 0 55 re η 1 2 0 084 re η 2 3 where c η and c τ are the drag coefficients for the mesh bar in the normal and tangential directions respectively μ is the water viscosity re η ρ v r η d μ s 0 077215665 ln 8 re η ρ is the water density v r η is the normal component of the fluid velocity relative to the bar 2 4 fatigue damage analysis in this study the prediction of the accumulative fatigue damage of mooring lines is performed based on the s n approach through adopting the miner s rule the fatigue damage d i for the ith sea state is determined by the following expression 7 d i j 1 n 1 n s i j where s ij and n s ij are the stress range at the jth loading cycle and the number of cycles to failure at the stress range s ij which can be obtained by the rainflow counting method the single slope s n curve is employed and can be formulated as 8 n s m k where n is the number of cycles of stress range s to failure m and k are the slope and intercept parameters of s n curve respectively for the shackle chains the parameters m and k can be determined as 3 0 and 6 0 10 10 referring to dnv os e301 2013 and standards norway ns 9415 2009 substituting eq 8 into eq 7 the fatigue damage is obtained by 9 d i j 1 n s i j m 1 k the time history of the tension force on the mooring line in the numerical simulations is employed to calculate the fatigue damage of mooring line during the analysis duration 3 h in this study then the accumulative fatigue damage of mooring line in 3 h is calculated by eq 10 10 d i 1 n p i d 3 h i where d is the accumulative fatigue damage p i is the occurrence probability of the ith sea state d 3h i is the short term fatigue damage of mooring line for the ith sea state in the wave scatter diagram 3 equivalent wave parameters a series of equivalent sea states in the lumping blocks are used to calculate the accumulative fatigue damage of the mooring line the lumping block equivalent methods can be employed to estimate the equivalent wave parameters of the equivalent sea states including the significant wave height the significant wave period and the probability of occurrence the probability of occurrence of the equivalent sea state in the jth lumping block containing n j original sea states is conventionally calculated by the sum of the occurrence probability of the original sea states in this block 11 p j i 1 n j p i j the equivalent significant wave height and the equivalent significant wave period obtained by several existing equivalent methods are shown as follows 3 1 equivalent significant wave height for the equivalent significant wave height in the jth lumping block sesam method deep 2010 suggested that the equivalent significant wave height can be expressed by the sum of the largest significant wave height and the wave height interval given as 12 h s j se max 1 i n j h s i j δ h s 2 sheehan et al 2006 adopted the largest significant wave height in the lumping block as the equivalent significant wave height of the block 13 h s j sh max 1 i n j h s i j assuming that the fatigue damage is proportional to the mth power of the significant wave height m is the slope parameter of s n curve jia 2008 calculated the equivalent significant wave height by 14 h s j ji i 1 n j p i j h s i j m i 1 n j p i j m with respect to song and wang 2019 the equivalent significant wave height related to the wave spectral moments can be given as 15 h s j so 4 0 n j 1 4 m n j i 1 n j m 0 i j γ m p i j i 1 n j p i j 1 γ m where m 0i j is the spectral wave energy of ith original sea state γ is the exponent of the spectral wave energy related to the slope of the s n curve and it is determined to be 2 m based on the assembled data by the regression method when the wave spectrum is assumed to be narrow banded eq 15 satisfies that the fatigue damage is proportional to the 4th power of the significant wave height which was consistent with kühn 2001 however the correction related to the number of the original sea states in the blocks and the s n curve slope is considered in eq 15 3 2 equivalent significant wave period for the equivalent significant wave period in the jth lumping block sesam deep 2010 suggested the sum of a half wave period interval and the averaging significant wave period in the block as the equivalent significant wave period written as 16 t s j se i 1 n j t s i j n j δ t z 2 sheehan et al 2006 jia 2008 and dnvgl rp f204 2017 obtained the equivalent significant wave period through averaging the significant wave period in the block based on the occurrence probability of the original sea states which is expressed as 17 t s j sh i 1 n j p i j t s i j i 1 n j p i j in song and wang 2019 the equivalent significant wave period related to the wave spectral moments was given as 18 t s j so 2 π i 1 n j m 0 i j γ m p i j i 1 n j p i j 1 γ m i 1 n j m 2 i j γ m p i j i 1 n j p i j 1 γ m where m 2i j is the second spectral moment of the ith original sea state γ is determined as 2 m which is analogy to eq 15 in addition kühn 2001 adopted the probabilistic wave frequency in the block as the equivalent wave frequency and then the equivalent significant wave period can be obtained by 19 t s j ku i 1 n j p i j t s i j i 1 n j p i j 1 in summary the equivalent wave parameters in the lumping blocks can be evaluated by six lumping block equivalent methods presented in table 3 4 comparison of fatigue damage obtained from several existing equivalent methods numerical simulations for the equivalent sea states with 3 h duration are conducted to obtain the fatigue damage of mooring lines for fish cage the stress range in terms of the loading cycle is calculated by the rainflow counting method and the fatigue damage of mooring line for the long term sea states is predicted by the s n approach since the mooring system is symmetrical with respect to the wave propagation direction the fatigue damage of the eleven mooring lines l 1 l 4 l 9 l 10 l 13 l 14 l 16 l 17 and l 18 is presented the effect of the lumping block equivalent methods and the numbers of the lumping blocks on the fatigue damage of the mooring line is investigated tables 4 6 present the partitions of the wave scatter diagram for different numbers of the lumping blocks the equivalent wave parameters for the equivalent sea states can be obtained through the lumping block equivalent methods depicted in section 3 herein only the equivalent wave parameters by method 6 in table 3 for 42 26 and 16 blocks are given in tables 7 9 respectively the quotient q is defined as the ratio of the fatigue damage for the equivalent sea states d e estimated by the equivalent methods in section 3 and that calculated using the original sea states d o given as 20 q d e d o when the quotient q obtained from the equivalent lumping block method is equal or slightly larger than 1 0 the equivalent method is considered as accurate figs 6 8 present the quotient q of mooring lines calculated from different equivalent methods for 42 26 and 16 lumping blocks respectively the results indicate that method 1 always significantly overestimates the fatigue damage of mooring line especially with the decrease of the lumping blocks this may be too conservative for the fatigue design of mooring lines and will increase the economic cost drastically in the practical engineering design in terms of method 2 the fatigue damage for 42 blocks is conservative however with the decrease of the number of the lumping blocks the fatigue damage of mooring lines obtained by method 2 is overly conservative and obviously sensitive although the fatigue damage of mooring line by method 3 is less sensitive to the number of the lumping blocks than that by method 1 and method 2 the quotient q for some mooring lines is significantly less than 1 0 which demonstrates that the fatigue design by the equivalent sea states using method 3 is dangerous for the integrity of mooring lines and comparing method 2 with method 3 the significant sensitivity of the fatigue damage to the number of the lumping blocks may be attributed to the selection of the equivalent significant wave height thus the equivalent significant wave height should be calculated carefully to avoid the high sensitivity of fatigue damage to the lumping block number fatigue damage calculated using method 4 seems slightly conservative for most of mooring lines which is similar to the results in song and wang 2019 notably the fatigue damage of the l 4 line is surprisingly underestimated which is non conservative for the anchor line design and method 5 underestimates the fatigue damage of the grid line l 13 the fatigue damage results by method 6 are generally between those by method 4 and method 5 for 42 equivalent sea states the fatigue damage of mooring lines by method 6 is the most accurate and slightly conservative thus method 6 seems to be more reasonable than other equivalent methods for providing the slightly conservative fatigue damage of mooring system however for 26 and 16 blocks the fatigue damage of the l 4 line calculated by method 6 is underestimated which may result in dangerous design and should be avoided during the mooring line design to clearly investigate the sensitivity of the number of the lumping blocks in terms of methods 4 6 fig 9 presents the quotient q of the mooring lines for 42 26 and 16 blocks for different mooring lines the underestimation or overestimation of the fatigue damage appears or largely increases with the decrease of the number of equivalent sea states it is found that the fatigue damage of mooring lines calculated by methods 4 6 is not sensitive to the number of the equivalent sea states this demonstrates that the equivalent significant wave period has negligible influence on the sensitivity of the fatigue damage of mooring lines to the lumping blocks partitions in summary the sensitivity of the accuracy of the lumping block equivalent method to the number of the lumping blocks depends on the selection of the equivalent significant wave height and methods 1 6 in table 3 are unable to achieve the accurate estimation of the fatigue damage of mooring system for fish cage considering the individual blocks for 42 equivalent sea states the quotient q j for the jth block is written as 21 q j d e j d o j where d e j is the product of the fatigue damage for the jth block and the corresponding occurrence probability d o j is the sum of the weighted fatigue damage for the original sea states in the jth block fig 10 shows the quotient q of mooring lines for every block calculated from method 4 the results indicate that the fatigue damage of mooring lines l 1 l 4 and l 9 for some individual blocks is underestimated obviously although method 2 gives conservative fatigue damage for the long term sea states the fatigue damage of mooring line l 4 for several blocks is underestimated significantly as shown in fig 11 due to little contribution of the underestimated blocks to the probabilistic average of the fatigue damage the fatigue damage of the l 1 and l 9 lines obtained by method 4 is conservative as shown in fig 6 and similarly method 2 produces the conservative fatigue damage of the l 4 line however method 4 cannot properly predict the fatigue damage of anchor line l 4 it may be attributed to the considerably large occurrence probability of the lumping blocks where the fatigue damage of mooring line is highly underestimated more importantly it is impractical to conduct a fine discretization of the wave scatter diagram for all engineering structures to avoid the underestimation of the fatigue damage for the long term sea states thus method 4 is not robust to the fatigue damage assessment of different mooring lines for the fish cage which may have great influence on the reliable evaluation for the fatigue design of mooring system in the fish farm associated with the equivalent wave parameters by the equivalent methods in the lumping blocks the reason for misestimating the fatigue damage of mooring line is discussed as follows the equivalent wave height obtained by method 1 is larger than that from other equivalent methods and it is also larger than the largest significant wave height in the corresponding lumping block this leads to a considerable error accumulation of fatigue damage from each lumping block comparing method 2 with method 3 the larger significant wave height induces the larger fatigue damage of mooring lines for the same significant wave period the relationship between the fatigue damage of mooring line l 1 and the spectral wave energy employed in method 4 is shown in figs 12 and 13 the black solid line in fig 12 has a slope of 2 0 which is consistent with the assumption in eq 15 with the variation of significant wave height in the lumping block eq 15 can generally capture the characteristic of fatigue damage however due to the high sensitivity to wave period as seen from fig 13 it may be not suitable to adopt the assumption that the fatigue damage of mooring lines is proportional to the second spectral moment which was in analogy to the relationship between the fatigue damage and the spectral wave energy in song and wang 2019 fig 14 shows the quotient q 13 of mooring lines for no 13 block in 42 blocks estimated from methods 4 6 this indicates that the sensitivity to the significant wave period will have a great impact on the fatigue damage of mooring lines in the lumping block with a large range of significant wave period thus it is necessary to propose a robust and accurate equivalent method for selecting the appropriate equivalent significant wave periods in the lumping blocks in the fatigue design of mooring lines 5 improved lumping block equivalent method as discussed in section 4 the existing lumping block equivalent method may lead to an excessive overestimation or underestimation of the fatigue damage of mooring lines for the fish cage in this section an improved equivalent method is proposed to accurately predict the long term fatigue damage for the lumping blocks the objective of the improved equivalent method is to yield the slightly conservative results for the individual lumping blocks as shown in fig 12 it is reasonable that the equivalent significant wave height is determined based on the assumption of the spectral moments equivalent method in song and wang 2019 in term of the equivalent significant wave period the most severe period for the blocks with a high period sensitivity should be calculated as recommended by dnvgl rp f204 2017 to avoid the excessive conservatism of the most severe significant wave period in the lumping block the more severe significant wave period between the equivalent significant wave periods calculated by methods 4 6 is employed as the equivalent significant wave period in the improved lumping block equivalent method as a result according to the relationship between the fatigue damage and the significant wave period the more severe significant wave periods for the equivalent sea states in the lumping blocks can be selected therefore the improved lumping block equivalent method for the long term sea states is put forward based on the selection of the more severe significant wave period in the lumping blocks the flow chart of the improved lumping block equivalent method is presented in fig 15 and the detailed procedures are shown as follows firstly the sensitivity of the fatigue damage of mooring lines for fish cage to the significant wave period is investigated for simplicity it is assumed that the trend for the relationship between the fatigue damage of mooring lines and the significant wave period is similar for different significant wave heights fig 16 plots the fatigue damage of the anchor lines and the upper layer lines the grid lines the buoy lines and the bridle lines with the variation of the significant wave period for the significant wave height of 0 75 m the fatigue damage of mooring lines is very sensitive to the significant wave period in the range of 4 s 11 s for mooring line l 4 the fatigue damage has two local minimum points for the significant wave period of 4 s 7 s and it also has two local maximum points for the significant wave period of 5 s 11 s this indicates that the traditional lumping block equivalent methods are not accurate to adopt a monotonous function for describing the relationship between the fatigue damage of all mooring lines and the equivalent significant wave period especially for the lumping blocks with the high sensitivity to wave periods thus in the improved lumping block equivalent method the more severe significant wave period of the equivalent sea state can be determined based on the relationship between the fatigue damage of different mooring lines and the significant wave period secondly the subdivision of some lumping blocks with the high sensitivity to wave periods is conducted due to the complicated relationship between the fatigue damage and the significant wave period in the range of 5 s 9 s the no 13 block in the 42 equivalent sea states obviously underestimates the fatigue damage of the l 1 and l 4 lines as shown in figs 10 and 11 through subdividing the no 13 block into two blocks with the significant wave period of 5 s 7 s and 9 s the fatigue damage of mooring lines is evaluated through selecting the more severe significant wave period as the equivalent significant wave period for the individual subdivided blocks then the probabilistic fatigue damage of the subdivided blocks is summed as the fatigue damage in the no 13 block to keep the number of the lumping blocks unchanged based on the similar way the no 8 block in the 26 equivalent sea states and the nos 2 5 block in the 16 equivalent sea states are subdivided into the two blocks with the significant wave period of 5 s 7 s and 9 s according to the variation of the fatigue damage of mooring lines with the significant wave period the more severe significant wave period for each mooring line is selected as the equivalent significant wave period for the individual lumping blocks as shown in table 10 only the lumping blocks including more than one significant wave period are presented here and the equivalent significant wave height of a lumping block for all the mooring lines is identical thus a new group of the equivalent sea states with the equivalent significant wave periods in table 10 and the equivalent significant wave height calculated by eq 15 is generated then the numerical simulations for the equivalent sea states in the new group are performed and the corresponding fatigue damage of mooring lines is estimated figs 17 20 present the quotient q of mooring lines for fish cage which is calculated from the improved lumping block equivalent method for different numbers of the equivalent sea states in the individual lumping blocks in general the fatigue damage for the individual lumping blocks and the long term sea states can be estimated by the improved equivalent method with the slight conservatism and the fatigue damage of the l 1 and l 4 lines for the individual blocks calculated by the improved equivalent method is significantly larger than that calculated by method 4 as shown in fig 10 and the quotient q of mooring lines for the long term wave condition estimated from the improved lumping block equivalent method is presented in fig 21 the results indicate that the fatigue damage for the whole mooring system obtained by the improved equivalent method is slightly conservative the largest quotient appears at the l 9 line for the 16 blocks with a value of 1 36 which is close to that in fig 9 of method 4 for the mooring lines except the anchor line l 4 the improved equivalent method still produces a slightly conservative fatigue damage result which is similar to the spectral moments equivalent method however the fatigue damage of the l 4 line obtained by the improved equivalent method is more accurate than that calculated by method 4 this demonstrates that the improved equivalent method can effectively avoid a significant underestimation of the fatigue damage for each block after considering the period sensitivity of fatigue damage therefore the proposed improved lumping block equivalent method is accurate to estimate the fatigue damage of mooring lines for the equivalent sea states the robustness of the improved lumping block method to different block partitions for the mooring lines for the fish cage is investigated as shown in fig 21 the fatigue damage of the l 4 line for different block partitions is still slightly conservative comparing with the reference result of the original sea states and the fluctuation of fatigue damage is not large with the decrease of the numbers of lumping blocks for the other mooring lines the equivalent sea states for different numbers of lumping blocks yield a rather accurate and slightly conservative result thus the improved lumping block equivalent method is robust to the lumping block partitions and different mooring lines with regard to the computational complexity the dynamic analysis for 12 wave cases needs to be performed for calculating the relationship between the fatigue damage of mooring line and the significant wave period for the 42 equivalent sea states in method 4 the extra 13 wave cases for the equivalent significant wave period in table 10 are analyzed for the 26 and 16 lumping blocks the extra 10 and 8 wave cases are analyzed respectively thus the total amount of the wave states for the 42 26 and 16 lumping blocks is 55 36 and 24 respectively this demonstrates that the improved equivalent method effectively reduces the computational effort comparing with that for the original sea states in summary the improved equivalent method for the equivalent wave parameters in the lumping blocks is accurate and efficient to predict the fatigue damage of mooring lines for the fish cage 6 conclusions the accumulative fatigue damage of mooring lines for the fish cage is predicted for the long term wave conditions based on the s n curve and the rainflow counting method the lumping block method is adopted to reduce the sea states in the wave scatter diagram and the equivalent wave parameters in the lumping block are estimated by six existing equivalent methods comparison of the fatigue damage obtained from the six equivalent methods is conducted and then an improved equivalent method is proposed to evaluate the fatigue damage in the lumping blocks several conclusions can be drawn as follows the sensitivity of the accuracy of the lumping block equivalent method to the number of the lumping blocks depends on the selection of equivalent significant wave height the fatigue damage predicted by the spectral moments equivalent method seems to be accurate and slightly conservative for most of mooring lines but the fatigue damage of the l 4 line is surprisingly underestimated it may be because the fatigue damage of the l 4 line has the high sensitivity to wave period which induces that the assumption of the relationship between the fatigue damage and the second spectral moment is no longer applicable although the equivalent significant wave period based on the probabilistic wave frequency seems more reasonable the fatigue damage of the l 4 line is significantly non conservative for the 26 and 16 blocks it may be attributed to the excessive underestimation of the fatigue damage of mooring line l 4 for several individual blocks in addition the equivalent significant wave period has a large influence on the fatigue damage of mooring lines especially for a large range of significant wave period in the lumping block then the improved lumping block equivalent method is proposed based on the selection of the more severe significant wave period for each mooring line and the slightly conservative principle for the individual block the results indicate that the proposed improved lumping block equivalent method is robust and accurate to reduce the equivalent sea states for evaluating the fatigue damage of mooring system in the future work the fatigue damage distribution associated with the uncertainty of the environmental condition based on the improved lumping block equivalent method is worth investigating to predict the fatigue reliability of the grid mooring system for the safety of mooring system in fish farms declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by national key r d program of china 2017yfc1404200 the national natural science foundation nsfc projects no 51979037 and no 51979029 and the fundamental research funds for the central universities no dut18lk41 
22334,the wave glider is a type of wave propelled persistent unmanned ocean vehicle which has wide application prospects in marine environmental monitoring marine ecological research military etc however due to the low speed and weak maneuvering features it is challenging to control the wave glider accurately under the environmental disturbances in this study a path following approach for the wave glider is proposed based on the line of sight los algorithm and the proposed restricted circle a four degree of freedom mathematical model of the float and submarine glider of the wave glider is adopted the path following simulations of the wave glider under different conditions are conducted to investigate the influences of environmental disturbances radius of the restricted circle look ahead distance of the los algorithm and control mode after entering the restricted circle the simulation results show that the wave glider is able to accomplish the path following task with the proposed path following strategies under different sea states keywords wave glider path following los guidance algorithm restricted circle 1 introduction in recent years marine robot systems have been developed significantly many of these robots such as remotely operated vehicles rovs and autonomous underwater vehicles auvs or unmanned underwater vehicles uuvs play an increasingly important role in science engineering and the military endeavors bingham et al 2012 numerous autonomous vehicles are developed and deployed for search and rescue spill collection surveillance placing nets bathymetric map creation transportation exploration tasks environmental monitoring marine survey etc cruz et al 2012 due to the huge spatial and time scale of the ocean survey vehicles with strong durability are getting more and more attention in this study a new type of ocean survey vehicle i e wave glider which has a principally infinite duration is investigated the wave glider is a two body vehicle consisting of a surface float and a submerged glider which are connected by a flexible tether manley et al 2009 as shown in fig 1 a the energy required by the wave glider to navigate is completely provided by waves so the propulsion system is purely mechanical and does not produce electrical energy manley and willcox 2010 as shown in fig 1 b as ocean surface waves pass by the submerged glider s wings switch their pitch angle passively as the glider moves up and down therefore the vertical motion of the glider is always converted into a forward thrust as an intelligent autonomous surface vehicle the wave glider has a wide range of applications including acoustic data collection communication gateway for subsurface systems military intelligence collection meteorological observation olson 2012 to accomplish these tasks safely and efficiently it is crucial to design robust and efficient motion control strategies for the wave glider however considering the nonlinear effects of hydrodynamics and the underactuated characteristics of the wave glider this problem is interesting and challenging the underactuated ship motion control problem has been tackled in the past years pettersen and nijmeijer 2001 breivik and fossen 2004 lefeber 2000 do et al 2002 ghommam et al 2006 usually motion control scenarios of unmanned surface vessels usvs were mainly classified into three categories station keeping path following and trajectory tracking the path following refers to the problem of converging and staying on a geometrically specified curve without having any time specification for a fully actuated system the path following problem can be solved with advanced nonlinear control laws however in the case of underactuated vehicles such as the wave glider the problem has not been fully tackled therefore in this study the path following problem for the wave glider is investigated several solutions have been proposed for the path following of underactuated marine vehicles a nonlinear robust adaptive control strategy was developed by do and jiang 2004 to force an underactuated surface ship to follow a predefined path at a desired speed despite the presence of environmental disturbances induced by wave wind and ocean current aguiar and pascoal 2007 addressed the problem of dynamic positioning and way point tracking of underactuated autonomous underwater vehicles in the presence of constant unknown ocean currents and parametric modelling uncertainty using a non linear adaptive controller to enhance the control system robustness of an underactuated surface vessel with model uncertainties and environmental disturbances sun et al 2015 proposed a robust adaptive trajectory tracking algorithm based on the proportional integral pi sliding mode control and the backstepping technique numerical simulations were conducted to demonstrate the effectiveness of this novel methodology to achieve path following of usvs several guidance laws have been studied and implemented in the past by the marine control community such as the line of sight los guidance the pure pursuit pp guidance and the constant bearing cb guidance lekkas and fossen 2013 the implementation of the three aforementioned methodologies in the case of autonomous underwater vehicles has been discussed extensively by breivik and fossen 2009 the los guidance algorithm is most popular and its properties have been studied thoroughly in the literatures lekkas and fossen 2013 pettersen and lefeber 2001 frequently the los guidance is considered in connection with the heading autopilot due to the fact that the two systems form together a cascade structure that needs to be stabilized one of the first efforts of this kind was presented by healey and lienard 1993 in fossen et al 2003 an implementation of the los guidance law for straight line path following can be found whereas in breivik and fossen 2004 the motion of a particle was considered and the method was implemented for curved path following a cascaded systems approach was also developed by børhaug and pettersen 2005 where the guidance system is interconnected with a sliding mode controller in order to achieve global k exponential stability when the desired path is a straight line in three dimensional space to solve the problem of the way point tracking of underactuated surface vessels oh and sun 2010 presented a model predictive control mpc scheme with los path generation capability quadratic programming qp is used to solve a linear mpc by successive linearization along the los model of the surface vessel liu et al 2017 applied an improved los guidance algorithm to the path following control problem of the underactuated usvs which can adjust adaptively based on the path following error simulation experiments demonstrate the effectiveness and reliability of the improved los guidance algorithm and the path following controller the above research works prompt the path following control problem of the underactuated vehicle however all of the aforementioned investigations focus on the single body vehicles and the autonomous vehicle has at least two control inputs including a surge force and yaw moment nevertheless the wave glider is propelled entirely by wave energy due to its unique motion mechanism of two body structure the wave glider is inherently unstable nonlinear underactuated multivariable and strongly coupled which makes the path following control of the wave glider very special and challenging liao et al 2016 applied the los guidance to a wave glider and proposed a self adapting proportion integration differentiation pid guidance law to compensate the steady state error caused by marine environment disturbances especially currents however in engineering applications considering the limited energy supply the wave glider can not be controlled continuously for a long time therefore a robust control strategy is needed to reduce energy consumption and maintain a certain control accuracy in the present study a robust path following approach based on the los algorithm and restricted circle for the wave glider is proposed a four degree of freedom 4 dof mathematical model and a pid heading controller in series with the proposed guidance strategy for wave glider path following control is then established finally the path following performances of the wave glider under various environment conditions are investigated the sensitivity analysis to environmental disturbances the values of some key parameters and control modes are conducted the remainder of this paper is organized as follows the dynamic model of the wave glider is presented in section 2 the path following strategies are established in section 3 the simulation results are analyzed and discussed in section 4 the main conclusions are drawn in section 5 2 dynamic model of the wave glider in order to verify the feasibility of the proposed path following guidance algorithm by means of simulation it is necessary to establish an accurate mathematical model for the wave glider there have been some studies regarding wave glider modelling kraus and bingham 2011 kraus 2012 qi et al 2013 here we use the mathematical model based on the newton euler approach proposed by wang et al 2019 this model of the wave glider consists of a 4 dof float and a 4 dof gilder table 1 provides main particulars of the wave glider considered in this study in this model three right handed coordinate systems are established one inertial reference frame o n x n y n z n and two body fixed frames o b 1 x b 1 y b 1 z b 1 and o b 2 x b 2 y b 2 z b 2 as shown in fig 2 the two body fixed frames are used to describe the motion of the float and glider respectively based on the three defined frames the 4 dof kinematic equations of the surface floater with respect to surge sway heave yaw can be presented using an euler angle representation 1 η 1 j θ η 1 υ 1 where η 1 x 1 y 1 z 1 ψ 1 t denotes the vector of position and attitude of the float in the reference frame o n x n y n z n and υ 1 u 1 v 1 w 1 r 1 t is the velocity vector of the float in the reference frame o b 1 x b 1 y b 1 z b 1 j θ η 1 is the rotation matrix from o b 1 x b 1 y b 1 z b 1 to o n x n y n z n the dynamic equations of the float are written as follows 2 m 1 υ 1 c 1 υ 1 υ 1 d 1 υ 1 υ 1 g η 1 τ 1 t e t h e r τ w a v e in the case of irrotational ocean currents the relative velocity vector 3 υ r υ υ c υ c u c v c w c 0 the ocean current velocity vectors in n and b satisfy 4 υ c n j θ η 1 υ c b which contributes to the hydrodynamic terms such that 5 m r b 1 a 1 υ 1 c r b 1 υ 1 υ 1 c a 1 υ 1 r υ 1 r d 1 υ 1 r υ 1 r g η 1 τ 1 t e t h e r τ w a v e where υ 1 r represents the relative velocity of the float in the case of ocean current m r b 1 is the rigid body inertia matrix a 1 0 is the added mass matrix calculated at zero frequency and the constant frequency model in the heave should be formulated at its respective natural frequency the term d 1 υ r includes both linear and quadratic damping c r b 1 υ 1 c a 1 υ 1 r is the coriolis and centripetal matrix τ 1 t e t h e r is the tether forces exerted on the float divide the 4 dof motions of surface floater into the 3 dof low frequency lf horizontal motions and the wave frequency wf heave motion then the equations of motion of the float can be written as follows 6 η 1 j θ η 1 υ 1 m r b 1 a 1 0 υ 1 c r b 1 υ 1 υ 1 c a 1 υ 1 r υ 1 r d 1 υ 1 r υ 1 r τ 1 t e t h e r τ w d m 1 a ω h e a v e z 1 b ω h e a v e z 1 ρ g a w p 0 z 1 τ w f τ 1 t e t h e r where b ω h e a v e is the radiation damping caused by the heave motion of the float τ w d is the second order wave drift forces and τ w f is the first order wave induced forces the jonswap spectrum describing the non fully developed seas is used to describe the irregular waves experienced by the wave glider fig 3 shows the linear relationship between the wave induced forces and the wave heights similar to the mathematical model of the float the 4 dof kinematic and kinetic equations of the submarine glider are written in the following form 7 η 2 j θ η 2 υ 2 m r b 2 a 2 0 υ 2 c r b 2 υ 2 υ 2 c a 2 υ 2 r υ 2 r d 2 υ 2 r υ 2 r g η 2 τ 2 t e t h e r τ δ τ h y d r o f o i l where υ 2 r represents the relative velocity of the glider in the case of ocean current g η 2 represents the vector of gravitational buoyancy forces and moments τ 2 t e t h e r is the tether forces exerted on the submarine glider τ h y d r o f o i l is the hydrofoil forces and τ δ is the rudder induce forces for the submarine glider more details of this model could be found in wang et al 2019 it has been demonstrated an effective and reliable model to evaluate the controller of the wave glider in open seas 3 path following strategy to make the wave glider navigate along the preset trajectory it is necessary to study the path following guidance algorithm for the wave glider in this study a los guidance algorithm is used the los guidance principle embodies an intuitive understanding of the behavior of a ship and the action of a helmsman los schemes have been applied to surface ships by fossen 2002 for the wave glider sailing in open sea the preset sailing path is usually a points way composed of a collection of way points the way point database consists of fossen 2011 8 w p t p o s x 1 y 1 x 2 y 2 x l y l the wave gilder should move from the starting point p 1 x 1 y 1 to the terminal point p l x l y l via the way points p k x k y k k 2 3 l 1 the look ahead distance δ is a key parameter in the los algorithm which is a guidance parameter used to shape the convergence of the ship to the path tangential the cross tracking error e represents the minimum distance from the position of the wave glider to the track segment where the wave glider is currently located based on e and δ the los position can be determined as p los in fig 4 then the desired course is alongside the vector p t p l o s in the problem of the path following of ships δ is typically expressed as a distance of n ship length breivik 2003 however for the present case the wave glider the problem seems different considering that when the wave glider is close to the preset track the desired course will change frequently due to the weak maneuverability of the wave glider its course response ability is poor which will cause the instability of the system and also result in unnecessary energy loss therefore in this study a los path following guidance strategy based on restricted circle theory is proposed the desired course of the wave glider is denoted as ϕ d and the real time course is denoted as ϕ t both indicate the course of submarine glider when the wave glider navigates into the restricted circle as shown in fig 4 the desired course remains unchanged after entering the restricted circle two control modes for the wave glider are proposed it can equal to the desired course at the moment of entering the restricted circle or equal to the course of the track segment where the wave glider is currently located the former is represented by ϕ d ϕ t while the latter is represented by ϕ d ϕ k 1 k the restricted circle radius is set as r furthermore another parameter d has also been introduced as shown in fig 4 d is the distance between the blue dashed line and the points way and can be calculated as 9 d r 2 δ 2 since the position p los is continually changing during the voyage of the wave glider the position of restricted circle is also continually changing which means that there are countless restricted circles along the path during the path following task therefore each time the wave glider enters or leaves the restricted circle it must pass through the intersection of the restricted circle and the blue dashed line as shown in fig 5 thus in the real time course of navigation when the wave glider is within the blue dashed line range the desired course will not change the area within the blue dashed line is the expected sailing area for wave gilder which can be called the ideal area obviously the value of d can also affect the performances of path following and which will also be discussed in section 4 the process of the path following strategy is shown in fig 6 the first step of the guidance algorithm is to determine the track segment where the wave glider is currently located a criteria for switching to the current track segment step 1 find the nearest way point p k to the real time position p t step 2 if k 1 then the current track segment is p 1 p 2 if k l then the current track segment is p l 1 p l step 3 if k 1 and k l then compare the angle θ k k 1 between vectors p k p k 1 and p k p t with the angle θ k k 1 between vectors p k p k 1 and p k p t if θ k k 1 θ k k 1 the current track segment is p k 1 p k otherwise the current track segment is p k p k 1 then the los position p los x d y d can be determined based on the real time position and track segment of the wave glider as well as the look ahead distance δ at last the program determines if the wave glider is in the restricted circle if so the desired course ϕ d is calculated according to the two control modes described above otherwise the desired course ϕ d can be determined according to the real time position x t y t and the los position p los x d y d ϕ d can be expressed as eq 5 10 ϕ d arctan y d y t x d x t x d x t π arctan y d y t x d x t y d y t x d x t π arctan y d y t x d x t y d y t x d x t π 2 y d y t x d x t π 2 y d y t x d x t the heading control algorithm is used to realize the path following task in this study path following for the wave glider is implemented in series with a pid heading controller wang et al 2019 the process of the wave glider path following is shown in fig 7 δ denote the rudder angle of the wave glider 4 simulation and discussion based on the mathematical model of the wave glider introduced in section 2 and the path following guidance algorithm introduced in section 3 a time domain simulation program is developed path following performances with the proposed guidance algorithm for the wave glider under different conditions are simulated as shown in table 2 the sensitivity analysis to the wave height ocean current the values of δ and d and the control modes with respect to the desired course after entering the restricted circle are conducted the directions of wave and current are zero i e they are pointing to the north considering that the hydrodynamic parameters of the float are calculated based on the potential flow theory this model is only applicable under mild sea conditions therefore several smaller significant wave heights and current speeds have been selected the way points database x 1 y 1 x 2 y 2 x 3 y 3 x 4 y 4 is chosen as 0 10 200 50 400 200 450 400 the initial position of the wave glider is 0 0 the sailing path for the wave glider and the time series of its path following performances including the cross tracking error and the rudder angle under condition 1 are presented in fig 8 and fig 9 respectively the dashed line in fig 8 represents the preset points way table 3 presents the statistics of wave glider s path following performances under condition 1 18 mean cross tracking error c represents the average value of the cross tracking error during the voyage and is calculated using eq 6 11 c t 1 n x t x t 0 2 y t y t 0 2 n where x t y t is the real time position of wave glider x t 0 y t 0 is the foot point of the vertical line from the real time position of wave glider to the track segment where the wave glider is currently located n is the number of total time steps mean tracking error outside the ideal area c d represents the average value of distance from the wave glider to the boundary of the ideal area when the wave gilder is outside the ideal area it is given as eq 7 12 c d t 1 n d x t x t 0 2 y t y t 0 2 d n d t t x t x t 0 2 y t y t 0 2 d where d is the distance between the boundary of the ideal area and the points way n d is the number of total time steps of the wave glider sailing outside the ideal area sailing time refers to the time that the wave glider takes to move from the initial position to the vicinity of the last way point energy consumption factor e is introduced here to quantitatively evaluate the energy consumption of wave glider during the voyage it is defined as the average amount of the change of rudder angle per second 13 e t 1 n 1 δ t 1 δ t n where δ is the rudder angle hereinafter control mode i and control mode ii are used to represent the control mode ϕ d ϕ t and the control mode ϕ d ϕ k 1 k respectively the comparisons of wave glider path following performances under conditions 1 6 are shown in figs 10 and 11 to evaluate the effects of significant wave height it can be concluded base on fig 10 that the path following performances of wave gilder using two control modes are both satisfactory under different sea conditions it is worth noting that in the control mode i the sailing path of the wave gilder has some oscillations around the path but this phenomenon does not occur in the control mode ii fig 11 shows that for both control modes the tracking error will increase as the significant wave height increases this is due to the speed of the wave glider is higher when the wave height is larger which makes it difficult to achieve immediate steering due to the weak maneuverability of the wave glider from the perspective of efficiency because of the higher speed sailing time will be reduced as the wave height increases however this also means more frequent steering and higher energy consumption the comparisons of wave glider path following performances under conditions 1 7 8 and 4 9 10 are shown in figs 12 and 13 to evaluate the effect of current speed obviously it can be seen from fig 12 that ocean current has a significant impact on the path following performances of wave glider to both control modes the alignment of the sailing path with the preset path will reduce when the current exists and this phenomenon is more obvious as the current speed increases the error comparisons in fig 13 confirm this conclusion since the direction of the current is roughly close to the direction of the wave glider the speed is faster and the sailing time is shorter from the point of energy consumption control mode i has a better performance than control mode ii in general the designed path following algorithm can still accomplish the tracking mission in the presence of current in addition because the path following algorithm proposed in this paper does not eliminate the effect of ocean current there will be constant tracking error in some track segments in order to study the effect of current on the path tracking performance of wave glider under this guidance strategy nine operating conditions are designed as shown in table 4 keep other conditions unchanged only the velocity and direction of current are changed the simulation results are shown in fig 14 it can be seen that the motion control performance of the wave glider is significantly affected by the current with the increase of the current speed the trajectory tracking error also increases when the current direction is contrary to the desired course of wave glider even reverse driving will occur as shown in condition i therefore how to effectively take advantage of ocean current and reduce the tracking error as well as improve navigation efficiency will be the focus of the research on the path planning and fusion guidance algorithm of wave glider under the influence of ocean currents the comparisons of wave glider path following performances under conditions 1 11 12 and 4 13 14 are shown in figs 15 and 16 to evaluate the effect of look ahead distance δ fig 15 shows that in the control mode i the oscillations around the path have been reduced as the value of δ increases and the sailing path is smoother which is also the reason for the shortened sailing time fig 16 shows that for both control modes as δ increases although the tracking error is greater at the same time less energy is consumed therefore the value of δ should be determined according to the needs of the actual engineering applications to obtain the proper balance between path tracking accuracy and energy consumption the comparisons of wave glider path following performances under conditions 1 15 16 and 4 17 18 are shown in figs 17 and 18 to evaluate the effect of value of d fig 17 shows that in the control mode i the oscillations around the path are more intense as d increases meanwhile the sailing path in the control mode ii is also more deviated from the preset path fig 18 shows that as d increases the tracking error sailing time and energy consumption all increase accordingly which means that the path tracking accuracy and sailing efficiency are both reduced in this sea state therefore it can be concluded that a smaller value of d can improve the path following performances of wave glider under the simulated sea state however considering the influence of positioning error with gps devices in practical applications the value of d can not be too small otherwise there may be a phenomenon that the wave glider is in the ideal sailing area but the current position is incorrectly judged due to the positioning error resulting in an incorrect steering therefore the value of d should be greater than the real time positioning error then an appropriately small value can be taken to improve the path following performances of the wave glider figs 19 21 give an overview of the evaluation parameters of the wave glider path following performances under all the considered 18 conditions to evaluate the effect of different control modes with respect to the desired course after entering the restricted circle in these figures the adjacent two columns represented in the same color represent the same conditions with different control modes i e control mode i is on the left hand side column while control mode ii is on the right hand side column considering the influence of different values of d on the mean cross tracking error mean tracking error outside the ideal area is used as the evaluation parameter of path following accuracy fig 19 shows that in most situations control mode ii has less tracking error which means that it performs better in terms of control accuracy from the point of sailing time when the value of d is large conditions 15 18 control mode i takes longer time due to intense oscillation around the path in other situations the two control modes are not much different and control mode ii takes slightly less sailing time according to the above conclusion that the value of d should be appropriately small it can be considered that the control mode has little effect on the sailing time fig 21 presents the comparison of energy consumption under all conditions it can be seen that control mode i always consumes less energy than control mode ii in combination with the sailing time it can be concluded that control mode i is more efficient in summary both control modes can complete the task of path following well but there are differences in control accuracy and efficiency control mode i is more efficient while control mode ii has less control error the choice of control mode should be based on the consideration of the specific applications 5 conclusions to find robust and efficient motion control strategies for the wave glider a path following approach based on a line of sight los algorithm and restricted circle for the wave glider is proposed and the path following performances of the wave glider under different conditions is also addressed based on the simulated results some conclusions are drawn as follows 1 the proposed restricted circle based los guidance algorithm enables the wave glider to complete the path following task the simulation results show that the proposed control algorithm can maintain relatively good performance under different ocean environmental conditions when the parameters of the control algorithm change despite of some influences on the control performances of path following the wave glider is still able to complete the task of path following well these facts confirm that the algorithm is robust 2 environmental factors including significant wave height and current speed have great influences on the path following performances of wave glider however the proposed control algorithms can achieve the goal satisfactorily the control error is within the allowable range 3 as the value of look ahead distance δ increases the tracking error is greater but less energy is consumed therefore a proper balance is needed between path tracking accuracy and energy consumption for practical applications 4 the greater value of half width of the ideal area d will reduce the accuracy of path tracking and the efficiency of sailing however considering the existence of positioning error the value of d cannot be too small and should be greater than the positioning error with the gps devices 5 the path following task can be achieved by using two control modes i e mode i the desired course of the wave glider after entering the restricted circle is equal to the desired course at the moment of entering the restricted circle and mode ii the desired course of the wave glider after entering the restricted circle is equal to the course of the track segment where the wave glider is currently located although their control accuracies and efficiencies may be different in general mode ii is more accurate but less efficient than mode i acknowledgement the authors would like to thank the supports from natural science foundation of shanghai grant no 19zr1426300 national natural science foundation of china grant nos 11632011 51779141 and ministry of industry and information technology of china project no 2016 546 the third author would like to acknowledge the support from shanghai pujiang program grant no 19pj1405400 
22334,the wave glider is a type of wave propelled persistent unmanned ocean vehicle which has wide application prospects in marine environmental monitoring marine ecological research military etc however due to the low speed and weak maneuvering features it is challenging to control the wave glider accurately under the environmental disturbances in this study a path following approach for the wave glider is proposed based on the line of sight los algorithm and the proposed restricted circle a four degree of freedom mathematical model of the float and submarine glider of the wave glider is adopted the path following simulations of the wave glider under different conditions are conducted to investigate the influences of environmental disturbances radius of the restricted circle look ahead distance of the los algorithm and control mode after entering the restricted circle the simulation results show that the wave glider is able to accomplish the path following task with the proposed path following strategies under different sea states keywords wave glider path following los guidance algorithm restricted circle 1 introduction in recent years marine robot systems have been developed significantly many of these robots such as remotely operated vehicles rovs and autonomous underwater vehicles auvs or unmanned underwater vehicles uuvs play an increasingly important role in science engineering and the military endeavors bingham et al 2012 numerous autonomous vehicles are developed and deployed for search and rescue spill collection surveillance placing nets bathymetric map creation transportation exploration tasks environmental monitoring marine survey etc cruz et al 2012 due to the huge spatial and time scale of the ocean survey vehicles with strong durability are getting more and more attention in this study a new type of ocean survey vehicle i e wave glider which has a principally infinite duration is investigated the wave glider is a two body vehicle consisting of a surface float and a submerged glider which are connected by a flexible tether manley et al 2009 as shown in fig 1 a the energy required by the wave glider to navigate is completely provided by waves so the propulsion system is purely mechanical and does not produce electrical energy manley and willcox 2010 as shown in fig 1 b as ocean surface waves pass by the submerged glider s wings switch their pitch angle passively as the glider moves up and down therefore the vertical motion of the glider is always converted into a forward thrust as an intelligent autonomous surface vehicle the wave glider has a wide range of applications including acoustic data collection communication gateway for subsurface systems military intelligence collection meteorological observation olson 2012 to accomplish these tasks safely and efficiently it is crucial to design robust and efficient motion control strategies for the wave glider however considering the nonlinear effects of hydrodynamics and the underactuated characteristics of the wave glider this problem is interesting and challenging the underactuated ship motion control problem has been tackled in the past years pettersen and nijmeijer 2001 breivik and fossen 2004 lefeber 2000 do et al 2002 ghommam et al 2006 usually motion control scenarios of unmanned surface vessels usvs were mainly classified into three categories station keeping path following and trajectory tracking the path following refers to the problem of converging and staying on a geometrically specified curve without having any time specification for a fully actuated system the path following problem can be solved with advanced nonlinear control laws however in the case of underactuated vehicles such as the wave glider the problem has not been fully tackled therefore in this study the path following problem for the wave glider is investigated several solutions have been proposed for the path following of underactuated marine vehicles a nonlinear robust adaptive control strategy was developed by do and jiang 2004 to force an underactuated surface ship to follow a predefined path at a desired speed despite the presence of environmental disturbances induced by wave wind and ocean current aguiar and pascoal 2007 addressed the problem of dynamic positioning and way point tracking of underactuated autonomous underwater vehicles in the presence of constant unknown ocean currents and parametric modelling uncertainty using a non linear adaptive controller to enhance the control system robustness of an underactuated surface vessel with model uncertainties and environmental disturbances sun et al 2015 proposed a robust adaptive trajectory tracking algorithm based on the proportional integral pi sliding mode control and the backstepping technique numerical simulations were conducted to demonstrate the effectiveness of this novel methodology to achieve path following of usvs several guidance laws have been studied and implemented in the past by the marine control community such as the line of sight los guidance the pure pursuit pp guidance and the constant bearing cb guidance lekkas and fossen 2013 the implementation of the three aforementioned methodologies in the case of autonomous underwater vehicles has been discussed extensively by breivik and fossen 2009 the los guidance algorithm is most popular and its properties have been studied thoroughly in the literatures lekkas and fossen 2013 pettersen and lefeber 2001 frequently the los guidance is considered in connection with the heading autopilot due to the fact that the two systems form together a cascade structure that needs to be stabilized one of the first efforts of this kind was presented by healey and lienard 1993 in fossen et al 2003 an implementation of the los guidance law for straight line path following can be found whereas in breivik and fossen 2004 the motion of a particle was considered and the method was implemented for curved path following a cascaded systems approach was also developed by børhaug and pettersen 2005 where the guidance system is interconnected with a sliding mode controller in order to achieve global k exponential stability when the desired path is a straight line in three dimensional space to solve the problem of the way point tracking of underactuated surface vessels oh and sun 2010 presented a model predictive control mpc scheme with los path generation capability quadratic programming qp is used to solve a linear mpc by successive linearization along the los model of the surface vessel liu et al 2017 applied an improved los guidance algorithm to the path following control problem of the underactuated usvs which can adjust adaptively based on the path following error simulation experiments demonstrate the effectiveness and reliability of the improved los guidance algorithm and the path following controller the above research works prompt the path following control problem of the underactuated vehicle however all of the aforementioned investigations focus on the single body vehicles and the autonomous vehicle has at least two control inputs including a surge force and yaw moment nevertheless the wave glider is propelled entirely by wave energy due to its unique motion mechanism of two body structure the wave glider is inherently unstable nonlinear underactuated multivariable and strongly coupled which makes the path following control of the wave glider very special and challenging liao et al 2016 applied the los guidance to a wave glider and proposed a self adapting proportion integration differentiation pid guidance law to compensate the steady state error caused by marine environment disturbances especially currents however in engineering applications considering the limited energy supply the wave glider can not be controlled continuously for a long time therefore a robust control strategy is needed to reduce energy consumption and maintain a certain control accuracy in the present study a robust path following approach based on the los algorithm and restricted circle for the wave glider is proposed a four degree of freedom 4 dof mathematical model and a pid heading controller in series with the proposed guidance strategy for wave glider path following control is then established finally the path following performances of the wave glider under various environment conditions are investigated the sensitivity analysis to environmental disturbances the values of some key parameters and control modes are conducted the remainder of this paper is organized as follows the dynamic model of the wave glider is presented in section 2 the path following strategies are established in section 3 the simulation results are analyzed and discussed in section 4 the main conclusions are drawn in section 5 2 dynamic model of the wave glider in order to verify the feasibility of the proposed path following guidance algorithm by means of simulation it is necessary to establish an accurate mathematical model for the wave glider there have been some studies regarding wave glider modelling kraus and bingham 2011 kraus 2012 qi et al 2013 here we use the mathematical model based on the newton euler approach proposed by wang et al 2019 this model of the wave glider consists of a 4 dof float and a 4 dof gilder table 1 provides main particulars of the wave glider considered in this study in this model three right handed coordinate systems are established one inertial reference frame o n x n y n z n and two body fixed frames o b 1 x b 1 y b 1 z b 1 and o b 2 x b 2 y b 2 z b 2 as shown in fig 2 the two body fixed frames are used to describe the motion of the float and glider respectively based on the three defined frames the 4 dof kinematic equations of the surface floater with respect to surge sway heave yaw can be presented using an euler angle representation 1 η 1 j θ η 1 υ 1 where η 1 x 1 y 1 z 1 ψ 1 t denotes the vector of position and attitude of the float in the reference frame o n x n y n z n and υ 1 u 1 v 1 w 1 r 1 t is the velocity vector of the float in the reference frame o b 1 x b 1 y b 1 z b 1 j θ η 1 is the rotation matrix from o b 1 x b 1 y b 1 z b 1 to o n x n y n z n the dynamic equations of the float are written as follows 2 m 1 υ 1 c 1 υ 1 υ 1 d 1 υ 1 υ 1 g η 1 τ 1 t e t h e r τ w a v e in the case of irrotational ocean currents the relative velocity vector 3 υ r υ υ c υ c u c v c w c 0 the ocean current velocity vectors in n and b satisfy 4 υ c n j θ η 1 υ c b which contributes to the hydrodynamic terms such that 5 m r b 1 a 1 υ 1 c r b 1 υ 1 υ 1 c a 1 υ 1 r υ 1 r d 1 υ 1 r υ 1 r g η 1 τ 1 t e t h e r τ w a v e where υ 1 r represents the relative velocity of the float in the case of ocean current m r b 1 is the rigid body inertia matrix a 1 0 is the added mass matrix calculated at zero frequency and the constant frequency model in the heave should be formulated at its respective natural frequency the term d 1 υ r includes both linear and quadratic damping c r b 1 υ 1 c a 1 υ 1 r is the coriolis and centripetal matrix τ 1 t e t h e r is the tether forces exerted on the float divide the 4 dof motions of surface floater into the 3 dof low frequency lf horizontal motions and the wave frequency wf heave motion then the equations of motion of the float can be written as follows 6 η 1 j θ η 1 υ 1 m r b 1 a 1 0 υ 1 c r b 1 υ 1 υ 1 c a 1 υ 1 r υ 1 r d 1 υ 1 r υ 1 r τ 1 t e t h e r τ w d m 1 a ω h e a v e z 1 b ω h e a v e z 1 ρ g a w p 0 z 1 τ w f τ 1 t e t h e r where b ω h e a v e is the radiation damping caused by the heave motion of the float τ w d is the second order wave drift forces and τ w f is the first order wave induced forces the jonswap spectrum describing the non fully developed seas is used to describe the irregular waves experienced by the wave glider fig 3 shows the linear relationship between the wave induced forces and the wave heights similar to the mathematical model of the float the 4 dof kinematic and kinetic equations of the submarine glider are written in the following form 7 η 2 j θ η 2 υ 2 m r b 2 a 2 0 υ 2 c r b 2 υ 2 υ 2 c a 2 υ 2 r υ 2 r d 2 υ 2 r υ 2 r g η 2 τ 2 t e t h e r τ δ τ h y d r o f o i l where υ 2 r represents the relative velocity of the glider in the case of ocean current g η 2 represents the vector of gravitational buoyancy forces and moments τ 2 t e t h e r is the tether forces exerted on the submarine glider τ h y d r o f o i l is the hydrofoil forces and τ δ is the rudder induce forces for the submarine glider more details of this model could be found in wang et al 2019 it has been demonstrated an effective and reliable model to evaluate the controller of the wave glider in open seas 3 path following strategy to make the wave glider navigate along the preset trajectory it is necessary to study the path following guidance algorithm for the wave glider in this study a los guidance algorithm is used the los guidance principle embodies an intuitive understanding of the behavior of a ship and the action of a helmsman los schemes have been applied to surface ships by fossen 2002 for the wave glider sailing in open sea the preset sailing path is usually a points way composed of a collection of way points the way point database consists of fossen 2011 8 w p t p o s x 1 y 1 x 2 y 2 x l y l the wave gilder should move from the starting point p 1 x 1 y 1 to the terminal point p l x l y l via the way points p k x k y k k 2 3 l 1 the look ahead distance δ is a key parameter in the los algorithm which is a guidance parameter used to shape the convergence of the ship to the path tangential the cross tracking error e represents the minimum distance from the position of the wave glider to the track segment where the wave glider is currently located based on e and δ the los position can be determined as p los in fig 4 then the desired course is alongside the vector p t p l o s in the problem of the path following of ships δ is typically expressed as a distance of n ship length breivik 2003 however for the present case the wave glider the problem seems different considering that when the wave glider is close to the preset track the desired course will change frequently due to the weak maneuverability of the wave glider its course response ability is poor which will cause the instability of the system and also result in unnecessary energy loss therefore in this study a los path following guidance strategy based on restricted circle theory is proposed the desired course of the wave glider is denoted as ϕ d and the real time course is denoted as ϕ t both indicate the course of submarine glider when the wave glider navigates into the restricted circle as shown in fig 4 the desired course remains unchanged after entering the restricted circle two control modes for the wave glider are proposed it can equal to the desired course at the moment of entering the restricted circle or equal to the course of the track segment where the wave glider is currently located the former is represented by ϕ d ϕ t while the latter is represented by ϕ d ϕ k 1 k the restricted circle radius is set as r furthermore another parameter d has also been introduced as shown in fig 4 d is the distance between the blue dashed line and the points way and can be calculated as 9 d r 2 δ 2 since the position p los is continually changing during the voyage of the wave glider the position of restricted circle is also continually changing which means that there are countless restricted circles along the path during the path following task therefore each time the wave glider enters or leaves the restricted circle it must pass through the intersection of the restricted circle and the blue dashed line as shown in fig 5 thus in the real time course of navigation when the wave glider is within the blue dashed line range the desired course will not change the area within the blue dashed line is the expected sailing area for wave gilder which can be called the ideal area obviously the value of d can also affect the performances of path following and which will also be discussed in section 4 the process of the path following strategy is shown in fig 6 the first step of the guidance algorithm is to determine the track segment where the wave glider is currently located a criteria for switching to the current track segment step 1 find the nearest way point p k to the real time position p t step 2 if k 1 then the current track segment is p 1 p 2 if k l then the current track segment is p l 1 p l step 3 if k 1 and k l then compare the angle θ k k 1 between vectors p k p k 1 and p k p t with the angle θ k k 1 between vectors p k p k 1 and p k p t if θ k k 1 θ k k 1 the current track segment is p k 1 p k otherwise the current track segment is p k p k 1 then the los position p los x d y d can be determined based on the real time position and track segment of the wave glider as well as the look ahead distance δ at last the program determines if the wave glider is in the restricted circle if so the desired course ϕ d is calculated according to the two control modes described above otherwise the desired course ϕ d can be determined according to the real time position x t y t and the los position p los x d y d ϕ d can be expressed as eq 5 10 ϕ d arctan y d y t x d x t x d x t π arctan y d y t x d x t y d y t x d x t π arctan y d y t x d x t y d y t x d x t π 2 y d y t x d x t π 2 y d y t x d x t the heading control algorithm is used to realize the path following task in this study path following for the wave glider is implemented in series with a pid heading controller wang et al 2019 the process of the wave glider path following is shown in fig 7 δ denote the rudder angle of the wave glider 4 simulation and discussion based on the mathematical model of the wave glider introduced in section 2 and the path following guidance algorithm introduced in section 3 a time domain simulation program is developed path following performances with the proposed guidance algorithm for the wave glider under different conditions are simulated as shown in table 2 the sensitivity analysis to the wave height ocean current the values of δ and d and the control modes with respect to the desired course after entering the restricted circle are conducted the directions of wave and current are zero i e they are pointing to the north considering that the hydrodynamic parameters of the float are calculated based on the potential flow theory this model is only applicable under mild sea conditions therefore several smaller significant wave heights and current speeds have been selected the way points database x 1 y 1 x 2 y 2 x 3 y 3 x 4 y 4 is chosen as 0 10 200 50 400 200 450 400 the initial position of the wave glider is 0 0 the sailing path for the wave glider and the time series of its path following performances including the cross tracking error and the rudder angle under condition 1 are presented in fig 8 and fig 9 respectively the dashed line in fig 8 represents the preset points way table 3 presents the statistics of wave glider s path following performances under condition 1 18 mean cross tracking error c represents the average value of the cross tracking error during the voyage and is calculated using eq 6 11 c t 1 n x t x t 0 2 y t y t 0 2 n where x t y t is the real time position of wave glider x t 0 y t 0 is the foot point of the vertical line from the real time position of wave glider to the track segment where the wave glider is currently located n is the number of total time steps mean tracking error outside the ideal area c d represents the average value of distance from the wave glider to the boundary of the ideal area when the wave gilder is outside the ideal area it is given as eq 7 12 c d t 1 n d x t x t 0 2 y t y t 0 2 d n d t t x t x t 0 2 y t y t 0 2 d where d is the distance between the boundary of the ideal area and the points way n d is the number of total time steps of the wave glider sailing outside the ideal area sailing time refers to the time that the wave glider takes to move from the initial position to the vicinity of the last way point energy consumption factor e is introduced here to quantitatively evaluate the energy consumption of wave glider during the voyage it is defined as the average amount of the change of rudder angle per second 13 e t 1 n 1 δ t 1 δ t n where δ is the rudder angle hereinafter control mode i and control mode ii are used to represent the control mode ϕ d ϕ t and the control mode ϕ d ϕ k 1 k respectively the comparisons of wave glider path following performances under conditions 1 6 are shown in figs 10 and 11 to evaluate the effects of significant wave height it can be concluded base on fig 10 that the path following performances of wave gilder using two control modes are both satisfactory under different sea conditions it is worth noting that in the control mode i the sailing path of the wave gilder has some oscillations around the path but this phenomenon does not occur in the control mode ii fig 11 shows that for both control modes the tracking error will increase as the significant wave height increases this is due to the speed of the wave glider is higher when the wave height is larger which makes it difficult to achieve immediate steering due to the weak maneuverability of the wave glider from the perspective of efficiency because of the higher speed sailing time will be reduced as the wave height increases however this also means more frequent steering and higher energy consumption the comparisons of wave glider path following performances under conditions 1 7 8 and 4 9 10 are shown in figs 12 and 13 to evaluate the effect of current speed obviously it can be seen from fig 12 that ocean current has a significant impact on the path following performances of wave glider to both control modes the alignment of the sailing path with the preset path will reduce when the current exists and this phenomenon is more obvious as the current speed increases the error comparisons in fig 13 confirm this conclusion since the direction of the current is roughly close to the direction of the wave glider the speed is faster and the sailing time is shorter from the point of energy consumption control mode i has a better performance than control mode ii in general the designed path following algorithm can still accomplish the tracking mission in the presence of current in addition because the path following algorithm proposed in this paper does not eliminate the effect of ocean current there will be constant tracking error in some track segments in order to study the effect of current on the path tracking performance of wave glider under this guidance strategy nine operating conditions are designed as shown in table 4 keep other conditions unchanged only the velocity and direction of current are changed the simulation results are shown in fig 14 it can be seen that the motion control performance of the wave glider is significantly affected by the current with the increase of the current speed the trajectory tracking error also increases when the current direction is contrary to the desired course of wave glider even reverse driving will occur as shown in condition i therefore how to effectively take advantage of ocean current and reduce the tracking error as well as improve navigation efficiency will be the focus of the research on the path planning and fusion guidance algorithm of wave glider under the influence of ocean currents the comparisons of wave glider path following performances under conditions 1 11 12 and 4 13 14 are shown in figs 15 and 16 to evaluate the effect of look ahead distance δ fig 15 shows that in the control mode i the oscillations around the path have been reduced as the value of δ increases and the sailing path is smoother which is also the reason for the shortened sailing time fig 16 shows that for both control modes as δ increases although the tracking error is greater at the same time less energy is consumed therefore the value of δ should be determined according to the needs of the actual engineering applications to obtain the proper balance between path tracking accuracy and energy consumption the comparisons of wave glider path following performances under conditions 1 15 16 and 4 17 18 are shown in figs 17 and 18 to evaluate the effect of value of d fig 17 shows that in the control mode i the oscillations around the path are more intense as d increases meanwhile the sailing path in the control mode ii is also more deviated from the preset path fig 18 shows that as d increases the tracking error sailing time and energy consumption all increase accordingly which means that the path tracking accuracy and sailing efficiency are both reduced in this sea state therefore it can be concluded that a smaller value of d can improve the path following performances of wave glider under the simulated sea state however considering the influence of positioning error with gps devices in practical applications the value of d can not be too small otherwise there may be a phenomenon that the wave glider is in the ideal sailing area but the current position is incorrectly judged due to the positioning error resulting in an incorrect steering therefore the value of d should be greater than the real time positioning error then an appropriately small value can be taken to improve the path following performances of the wave glider figs 19 21 give an overview of the evaluation parameters of the wave glider path following performances under all the considered 18 conditions to evaluate the effect of different control modes with respect to the desired course after entering the restricted circle in these figures the adjacent two columns represented in the same color represent the same conditions with different control modes i e control mode i is on the left hand side column while control mode ii is on the right hand side column considering the influence of different values of d on the mean cross tracking error mean tracking error outside the ideal area is used as the evaluation parameter of path following accuracy fig 19 shows that in most situations control mode ii has less tracking error which means that it performs better in terms of control accuracy from the point of sailing time when the value of d is large conditions 15 18 control mode i takes longer time due to intense oscillation around the path in other situations the two control modes are not much different and control mode ii takes slightly less sailing time according to the above conclusion that the value of d should be appropriately small it can be considered that the control mode has little effect on the sailing time fig 21 presents the comparison of energy consumption under all conditions it can be seen that control mode i always consumes less energy than control mode ii in combination with the sailing time it can be concluded that control mode i is more efficient in summary both control modes can complete the task of path following well but there are differences in control accuracy and efficiency control mode i is more efficient while control mode ii has less control error the choice of control mode should be based on the consideration of the specific applications 5 conclusions to find robust and efficient motion control strategies for the wave glider a path following approach based on a line of sight los algorithm and restricted circle for the wave glider is proposed and the path following performances of the wave glider under different conditions is also addressed based on the simulated results some conclusions are drawn as follows 1 the proposed restricted circle based los guidance algorithm enables the wave glider to complete the path following task the simulation results show that the proposed control algorithm can maintain relatively good performance under different ocean environmental conditions when the parameters of the control algorithm change despite of some influences on the control performances of path following the wave glider is still able to complete the task of path following well these facts confirm that the algorithm is robust 2 environmental factors including significant wave height and current speed have great influences on the path following performances of wave glider however the proposed control algorithms can achieve the goal satisfactorily the control error is within the allowable range 3 as the value of look ahead distance δ increases the tracking error is greater but less energy is consumed therefore a proper balance is needed between path tracking accuracy and energy consumption for practical applications 4 the greater value of half width of the ideal area d will reduce the accuracy of path tracking and the efficiency of sailing however considering the existence of positioning error the value of d cannot be too small and should be greater than the positioning error with the gps devices 5 the path following task can be achieved by using two control modes i e mode i the desired course of the wave glider after entering the restricted circle is equal to the desired course at the moment of entering the restricted circle and mode ii the desired course of the wave glider after entering the restricted circle is equal to the course of the track segment where the wave glider is currently located although their control accuracies and efficiencies may be different in general mode ii is more accurate but less efficient than mode i acknowledgement the authors would like to thank the supports from natural science foundation of shanghai grant no 19zr1426300 national natural science foundation of china grant nos 11632011 51779141 and ministry of industry and information technology of china project no 2016 546 the third author would like to acknowledge the support from shanghai pujiang program grant no 19pj1405400 
