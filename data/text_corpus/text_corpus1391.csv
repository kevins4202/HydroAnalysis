index,text
6955,to capture the temporal variability of parameters of hydrological models the segmented optimization algorithm soa is usually used which subdivides the calibration period into a number of sub periods and seeks optimal parameters for each sub period by optimizing the objective function based on the measured and estimated data in the same sub period in this paper we developed a new method that is called a progressive segmented optimization algorithm psoa which seeks optimal parameters by optimizing the objective function based on both the current and all the prior sub periods we applied and compared the soa and psoa algorithms to the snowmelt runoff model srm in simulating snow melt streamflow for the manasi river basin northwest of china during snowmelt seasons of 2001 2012 the study showed 1 psoa can effectively calibrate the time variant model parameters while avoiding too much computational time caused by a significant increase of parameter dimensionality 2 psoa outperforms soa for both single snowmelt season and multi snowmelt season simulations 3 for single snowmelt season simulation the length of the sub period has an apparent effect on model performance the shorter the sub period is the better the model performance will be when the model is calibrated using the psoa method 4 for multi snowmelt season simulation an over short sub period may cause overfitting problems in some cases such as the situation of taking nash sutcliffe efficiency nse as the objective function a compromised length of sub period and objective function may have to be chosen as a trade off among evaluation criteria and between the importance of calibration and validation keywords model calibration progressive segmented optimization method snowmelt runoff model time variant parameter manasi river basin 1 introduction model calibration which attempts to estimate values of some critical model parameters that are not usually available or cannot be physically measured is one of the main research topics in the application of hydrological models to real case simulations gupta and sorooshian 1983 beven and binley 1992 shamir et al 2005 the classical single objective approaches primarily focus on matching one aspect of the hydrograph but other important hydrological processes implicit in the observations cannot be captured simultaneously boyle et al 2000 the multi objective approaches take into consideration of different aspects of the hydrograph by accounting for the trade off among different performance indicators gupta et al 1998 yapo et al 1998 boyle et al 2000 madsen 2000 vrugt et al 2003 jie et al 2016 which not only allow for an analysis of the trade offs among the different objective functions but also enable hydrologists to better understand model structures zhou et al 2014 jie et al 2016 the rainfall runoff processes are very complex due to a large number of controlling factors some factors such as climatic conditions and land use land covers vary in time leading to a time varying nature of hydrological responses over different temporal scales e g annual seasonal monthly and daily scales beighley and moglen 2002 merz et al 2006 choi and beven 2007 zhang et al 2011 tian et al 2012 hao et al 2015 the dynamic nature of hydrological systems brings uncertainties into hydrological simulations and predictions posing a challenge to accurate prediction forecasting of streamflow previous studies have shown that hydrological processes switch their dynamics between time steps periods which have not been properly represented by the existing models and dynamic calibration of the time varying hydrological processes will improve the prediction or forecasting ability of the hydrological models choi and beven 2007 levesque et al 2008 zhang et al 2011 kim and lee 2014 kim 2016 chen et al 2018 the most commonly used approach in the dynamic calibration of the time varying hydrological processes is to divide the whole calibration time period e g hydrological year and snowmelt season into several sub periods of hydroclimatic similarity and assume that the model parameters are constant in each sub period for example hay et al 2009 divided the hydrologic year into three groups based on an atmospheric pressure index kim and lee 2014 divided the calibration period into four seasons based on seasonal rainfall and streamflow patterns paik et al 2005 divided the calibration period into three 4 month seasons i e warm and dry rainy and cold and dry zhang et al 2015a b kim 2016 and chen et al 2018 separated the calibration period into dry and wet periods to improve model performance some researchers divided the calibration period into sub periods using clustering methods based on similar characteristics in the data during the model calibration period such as the fuzzy c mean clustering method choi and beven 2007 zhang et al 2011 the traditional k means clustering algorithm de vos et al 2010 and the self organizing maps based clustering method toth 2009 dividing a calibration period into too many sub periods leads to a significant increase in the parameter dimension making parameter calibration much more complex and time consuming to overcome the difficulties a feasible approach has been developed that calibrates parameters independently for each sub period which is referred to as segmented optimization algorithm soa however soa only optimizes parameters of each sub period to match the observed data just for that sub period and not for the whole period hence the optimized parameters of each sub period may not be globally optimal in view of the drawback of soa we proposed a progressive segmented optimization algorithm psoa for calibrating time variant parameters of hydrological models by dividing the calibration period into several sub periods and optimizing those parameters of each sub period to match the observed data of the whole period with such an approach global solution of parameters for all sub periods is obtained consequently and progressively to test the effectiveness of psoa compared to soa we took snowmelt runoff model as an example to simulate snowmelt runoff process with the time variant parameters in the manasi river basin northwest china the main parts of the paper are organized as follows the geographical and hydrological characteristics of the study area including the data sources and data preprocessing are described in section 2 the srm model and the proposed calibration algorithm are explicated in section 3 the results and discussions about possible effects of objective functions and sub period length on model outputs are presented in sections 4 and 5 conclusions are presented in section 6 2 study area and data 2 1 study area the manasi river basin 43 05 n 44 10 n and 85 00 e 86 20 e which is located in the xinjiang uygur autonomous region northwest china has a total area of 5179 km2 above the kensiwate kswt station see fig 1 the manasi river basin is one of the biggest irrigation areas in china the manasi river about 400 km long originates in the northern slope of tianshan mountains and it is the longest inland river in the junggar basin land covers in the manasi river basin take the form of bare soil open shrub lands grassland wood grassland meadow and snow ice the manasi river basin has a typical temperate continental arid climate the elevation of the basin ranges from 500 to 5216 m above mean sea level a m s l and the difference in height within the basin results in significant uneven distributions of temperature and precipitation the mean annual air temperature ranges from below 0 c in the mountainous areas to approximately 9 c at the basin outlet precipitation is abundant within the area of elevation between 1500 m and 3600 m where the mean annual precipitation reaches 600 700 mm but it drops to 100 200 mm in the piedmont plain feng et al 2000 ji and chen 2012 precipitation occurs mainly in summer june july and august and less in winter december january and february in the form of snowfall snow accumulates in winter and ablates mainly in spring and early summer june and it completely disappears in late summer the average annual runoff is about 12 8 108 m3 the intra annual distribution of runoff is uneven with about 9 7 69 8 16 5 and 5 0 of the annual runoff occurring in spring march may summer autumn september november and winter respectively meltwater from snow and glaciers in the spring and summer months accounts for about 35 9 of the annual runoff feng et al 2000 groundwater flow accounts for a small percentage of the total runoff but it dominates the streamflow in winter when there is neither rainfall nor meltwater for simplicity meltwater due to snow and glaciers will not be distinguished in the following discussion because runoff from meltwater of glaciers mainly happens in summer and geographically limited only to a small scale there are four hydrological stations at the lower part of the basin meiyao my kensiwate kswt qingshuihezi qshz and hongshanzui hsz the hsz station has been abandoned since 2006 to take advantage of the observed data at the other three stations the study area is thus taken as the portion of the basin above the kswt station as is shown in fig 1 the geographical and hydro climatic characteristics of the three stations are listed in table 1 2 2 data sources the digital elevation model dem used in this study is the shuttle radar topography mission srtm data with the resolution of 90 m farr et al 2007 the srtm data were downloaded from http srtm csi cgiar org the dem data were used for altitudinal belt partition zonal area estimation and temperature and precipitation interpolation daily precipitation and air temperature data observed at the my kswt and qshz hydrological stations fig 1 from 2001 to 2012 were used as model inputs daily runoff data from 2001 to 2012 at the kswt station were used for model calibration and verification the data were obtained from manasi hydrological bureau the hydro meteorological network is very sparse and the three hydrological stations are at the proximity to the basin outlet data from this network can hardly represent the daily rainfall distribution at the basin level thus the daily precipitation at different elevation zones was estimated through synthetization of the observations at the three hydrological stations with the relative annual precipitation gradient derived from corrected tropical rainfall measuring mission trmm data based on the regression models for the same study area as was discussed by ji and chen 2012 as there is no operational snow monitoring system established in the study area the modis snow cover data were used for model simulation numerous srm applications have had success in using snow data from modis butt and bilal 2011 georgievsky 2009 immerzeel et al 2009 qiu et al 2013 tahir et al 2011 for these studies conducted in watersheds with size between 500 and 27 000 km2 the 500 m resolution of modis was found sufficient for estimating the fraction of snow covered area kult et al 2014 the modis 8 day composite snow cover data product mod10a2 has higher precision in snow classification than modis daily products zhou et al 2005 huang et al 2007 in this study we adopted the modis 8 day composite product mod10a2 from march to june during 2001 to 2012 to derive the fraction of snow covered area for each zone the missing data 2 scenes are missing were obtained by a linear spatial interpolation algorithm assuming that the change with time between two consecutive 8 day snow fractions is linear the daily snow fraction of any date between the two 8 day periods for each zone is also calculated by linear spatial interpolation algorithm the detailed information about the data is summarized in table 2 the daily precipitation at stations my qshz and kswt is the total precipitation of rainfall and snowfall there is no detailed information on whether the total precipitation on a specific day is snow or rainfall 3 methodology 3 1 snow runoff model srm srm is a conceptual semi distributed and degree day temperature index model developed by martinec 1975 it has been used to simulate predict and or forecast daily runoff resulting from snowmelt and rainfall in mountainous regions and has been tested for over 100 basins at different geographical locations and spatial ranges in 29 countries martinec et al 2008 model input variables include daily average air temperature daily total precipitation and snow cover area based on the input values the following equation is used in srm to calculate the daily streamflow q m3 s 1 q i 1 q i k i 1 10000 86400 1 k i 1 l c s l i a l i t i δ t l i s l i c r l i p l i a l where i is the day number i 1 n n is the total number of days q 1 is the observed initial value of daily streamflow value before the simulation begins l is the index for each elevation zone l 1 l l is the total number of elevation zones 10000 86400 is the conversion factor from cm km2 day 1 to m3 s 1 k is the recession coefficient corresponding to the l th elevation zone c s and c r are the runoff coefficients expressing the losses as a ratio of runoff contributed by snowmelt and rain to precipitation respectively of the elevation zone a is the degree day factor cm c 1 d 1 t is the number of degree days of station c d δt is the adjustment by temperature lapse rate when extrapolating the temperature from the station to the average hypsometric elevation of the zone c d s is the fraction of snow covered area p is the precipitation contributing to runoff cm and al is the area of elevation zone l km2 3 2 determination of input variables and parameters srm is set up with daily input data of air temperature precipitation and fraction of snow covered area the basin was divided into four altitudinal zones with a nearly 1000 m difference in hypsometric elevation between each two neighboring zones the elevation boundaries areas land covers of each zone are detailed in table 3 3 2 1 daily zonal mean temperature the daily zonal mean temperatures were determined by extrapolating the mean temperature records available at the three hydrological stations by using the lapse rate value the temperature adjusted δt through temperature lapse rate is computed as follows 2 δ t γ h s t h 1 100 where γ is the temperature lapse rate c 100 m h st is the altitude of the hydrological station where temperature was measured h is the hypsometric mean elevation of a zone m studies in various high mountain catchments have shown spatial and temporal variability of the temperature lapse rate tahir et al 2011 zhang et al 2015a b due to the lack of observed data in the area those values were determined based on the study over the same area by feng et al 2000 table 4 since the difference in height among the observed sites is as large as 400 m validation of those values using observed data is not possible due to lack of observed temperature in higher elevation resolution however from table 4 we can see that except for the lowest zone a the temperature lapse rate increases from march to june in all other zones in march the temperature lapse rate increases with elevation from 0 50 c 100 m for zone a to 0 64 c 100 m for zone d while in april the temperature lapse rate remains almost constant 0 64 0 65 c 100 m in may the temperature lapse rate decreases with elevation from 0 78 c 100 m for zone a to 0 70 c 100 m for zone d in june zones a c show almost constant temperature lapse rate 0 77 0 78 c 100 m but decreases to 0 72 c 100 m in the highest zone zone d the spatial and temporal variability of the temperature lapse rate within these zones may indicate the local climate conditions of the basin 3 2 2 critical temperature a critical temperature t c is used to decide whether a precipitation event is treated as rainfall or snowfall the critical temperature is usually higher than freezing point and diminishes to 0 c as snowmelt season progresses according to meteorological observations at the tianshan snow observation station the critical temperature from the beginning to the end of the snowmelt season was observed to decrease from 3 5 to 0 c xu 1996 since the tianshan snow observation station and the manasi river basin are both located in tianshan mountain and they are about 100 km apart we took the daily t c values from 3 5 c to 0 c for the beginning to the end of a snowmelt season for each zone the times for the beginning and the end of the snowmelt season of each zone in the study area are determined based on the averaged snow ablation curve of multiple years for each zone and they are listed in table 5 the daily t c value for the beginning and the end of each snowmelt season was set to be 3 5 c and 0 c respectively the daily t c value for any day in between was interpolated linearly from 3 5 c to 0 c 3 2 3 precipitation the precipitation in each zone was estimated by synthesizing the observed data at the three hydrological stations with the precipitation gradient since no precipitation data are available for the area with the altitudes above 2000 m and vertical distribution of the precipitation is uneven hu 2004 ji and chen 2012 the precipitation gradient cannot be estimated from the rain gauge observations alone which are located at downstream ji and chen 2012 found the annual precipitation gradient in the area was 14 3 mm 100 m for zone b 8 1 mm 100 m for zone c and 6 6 mm 100 m for zone d based on the corrected tropical rainfall measuring mission trmm data for the period of 1998 to 2009 in this study the daily precipitation in zone a was taken as the average of the observations at the three hydrological stations in other zones they were estimated using the relative precipitation gradients based on the annual precipitation gradient ji and chen 2012 and the base value of the daily precipitation in zone a the daily precipitation in zone l is computed as follows 3 p l p a d l h l where pa is the daily precipitation in zone a p l and h l are the daily precipitation and altitude respectively in zone l l b c or d dl is the relative precipitation gradient of zone l to zone a precipitation contribution to runoff is considered in srm according to different stages of snowmelt season if the air temperature is lower than the critical temperature the precipitation is treated as new snow the new snowfall over the snow free area is considered as precipitation to be added to snowmelt calculation otherwise if the air temperature is above the critical temperature the precipitation as rainfall within the area of the entire zone is added martinec et al 2008 3 2 4 degree day factor the degree day factor was obtained from an empirical relation martinec and rango 1986 4 a 1 1 ρ s ρ w where ρ s is the mass density of snow and ρ w the mass density of water that was set to be 1 g cm3 the density of snow increases as the melt season progresses from winter to summer and the snowpack becomes wetter and denser by referring to the in situ data of ρ s in the tianshan mountain hu 2004 ρ s values were set for different zones from march to june table 6 3 2 5 runoff and recession coefficients the runoff coefficients for rainfall and snowfall c r and c s at a daily scale increase from lower to higher elevation zones given other factors such as soil and topography unchanged as warmer temperatures result in higher losses from evapotranspiration or sublimation in this study c s and c r in the zone a were calibrated as the season progresses and were set to increase by 10 per zone in other zones which produced the best results by using the trial and error calibration method the recession coefficient k indicates the decline of discharge in a period without snowmelt or rainfall corresponding to the ratio of runoff on consecutive days without snowmelt and rainfall k is assumed to vary with discharge q as martinec et al 2008 5 k i 1 q i 1 q i ρ q i σ where i i 1 are the sequence of days during a true recession flow period ρ and σ are parameters eq 5 can be reformatted by taking the natural log on both sides of the equation as 6 ln q i 1 ω φ ln q i where ω ln ρ and φ 1 σ parameters ω and φ in eq 6 can be obtained through linear regression analysis using the observed discharge data in summary due to the non uniformity of snowmelt runoff process throughout the snowmelt season some parameters temperature laps rate snow density runoff coefficients etc of snowmelt runoff model should vary with time to reflect the time varying characteristics of the runoff response mechanisms the temperature lapse rate and snow density were set to vary monthly over different elevation zones the critical temperatures were set to vary daily and their values were determined in advance tables 4 6 the runoff coefficients of snowmelt and rainfall were also allowed to vary for different length of sub periods such as one month half a month ten days and five days they need to be calibrated since they are not measurable by definition and can t be estimated simultaneously with runoff 3 3 calibration algorithm 3 3 1 the segmented optimization algorithm soa algorithm the soa algorithm separates the calibration period e g hydrological year into several sub periods e g four seasons kim and lee 2014 the model parameters to be calibrated in different sub periods are assumed to be independent of each other optimization is then performed consecutively and independently in one sub period followed by the next till the last one the objective function for each sub period is built upon the observed and simulated data of that period any known optimization method can be used in each sub period the procedure of soa is shown in table 7 and fig 2 supposing there is only one time varying parameter β and the whole period is divided into n sub periods with the same length of m e g if one year is divided into 12 months each month has a length of 30 days on average then n 12 m 30 in each sub period there are m observed runoff records then the total observed runoff series in the whole period can be expressed as o 1 o 2 o nm similarly the total simulated runoff series can be expressed as s 1 s 2 s nm corresponding to the β values the objective of calibration is to find the best value of β for each sub period denoted by β 1 β 2 β n making objective function f optimal the simulated runoffs in each sub period i are dependent on β i the calibration can be implemented through n steps in each step the β i is optimized with the objective function built upon the observed and simulated runoff series of sub period i the soa algorithm optimizes model parameters of each sub period independently the drawback of such a method is that the parameters are optimized just based on the observed and simulated runoff of the current sub period rather than the whole calibration period 3 3 2 the progressive segmented optimization algorithm psoa algorithm to overcome the shortcoming of soa mentioned above we propose psoa to optimize parameters the procedure of psoa includes two phases table 8 and fig 3 in the first phase the parameters of the model in each sub period are optimized separately through n steps from sub period 1 to sub period n in step 1 the β 1 is optimized with the objective function built upon the observed and simulated runoff series of sub period 1 in step 2 the β 2 is optimized with the objective function built upon the observed and simulated runoff series of sub period 1 and sub period 2 accordingly in step n the β n is optimized with the objective function built upon the observed and the simulated runoff series of sub period 1 to sub period n the simulated runoff series of sub period 1 to sub period n 1 are the results of hydrological model simulation based on optimized β 1 to β n 1 in this way the parameter optimization of the current sub period takes into account the results of the optimized parameters of all the previous sub periods in the second phase the parameters of the model are still optimized successively through n steps from sub period 1 to sub period n in step i the βi is optimized with the objective function built upon the observed and simulated runoff series of all the sub periods in which the simulated runoff series of sub periods 1 to i 1 and sub periods i 1 to n are from the most lately simulated results the calibration in the second phase will be repeated until the improvement of the whole objective function is less than a given tolerance the characteristic of the calibration in the second phase is that the parameters of each sub period are globally optimized after recursive optimization in such a way the shortcomings in the calibration of time varying parameters using the soa method can be overcome as far as we know there is no similar method in the literature 3 4 the model evaluation criteria in order to evaluate statistically the accuracy of the calibrated and validated runoff outputs using the new calibration method different parts of the hydrograph should be considered with the appropriate evaluation criteria low and high flows need to be simulated well and a good mass balance is also required in this study the following three commonly used criteria were employed the nash sutcliffe efficiency nse the nseln the nse calculated using log transformed discharge and volume difference dv nse is given by nash and sutcliffe 1970 7 nse 1 i 1 n o i s i 2 i 1 n o i o 2 and nseln is given by 8 nse ln 1 i 1 n ln o i l n s i 2 i 1 n ln o i l n o 2 where oi is the observed daily discharge si is the simulated daily discharge if oi or si is equal to 0 it should be set to a small positive value less than 1 o is the average observed discharge and i is the day number i 1 n where n is the total number of daily discharge records the dv is given by 9 dv v v v 100 where v is the observed runoff volume and v is the simulated runoff volume nse has been widely employed to evaluate the performances of hydrological models and it tends to emphasize the high or peak flows nseln places more emphasis on fitting low flows chen et al 2018 the dv is a measure of the average deviation between the simulated and observed volumes from a multi objective viewpoint all criteria could not reach their best values simultaneously a balanced compromised aggregated evaluation considering different criteria should be made in this study the euclidian distance function was adopted as another criterion 10 n n d 1 n s e 2 1 nse l n 2 d v 100 2 where nnd is the euclidian distance from the ideal point of nse nseln and dv all the three components are dimensionless and their ideal values are 1 1 and 0 respectively the smaller the nnd is the better the model performance will be if the three components have different range or scale weighting factors can be used for adjusting the emphasis on different components gupta et al 2009 the four criteria were also taken as objective functions in analyzing the effects of different objective functions on the srm performances using the psoa algorithm 3 5 comparison of the soa and psoa algorithms in snowmelt runoff simulation using srm the parameters of c s and c r were calibrated and the model performance was evaluated by using the calibration algorithms soa and psoa in the following procedure firstly the srm calibration for each snowmelt season from march to june during the 2001 2012 period was conducted separately using the two calibration algorithms obtaining two optimal sets of c s and c r for each snowmelt season by both algorithms secondly the long term snowmelt runoff for all snowmelt seasons was simulated as a whole by the srm model using both algorithms with a split sample procedure calibration and validation phases only two sets of c s and c r were obtained by both algorithms during calibration phase the enumeration approach was adopted in each step of both algorithms to search for optimal values of c s and c r from all possible combined sets of them within adjustment ranges the initial runoff was set as follows for the first sub period it was set to be the observed streamflow of the day before the sub period for the following sub periods it is the simulated streamflow at the end of the previous sub period the effects of different lengths of sub periods and objective functions on the model performance were also analyzed 4 results 4 1 the performance of the soa and psoa algorithms for the srm calibration in each snowmelt season to evaluate the performance of the psoa algorithm in reference to the standard soa algorithm the calibration of snowmelt runoff for each snowmelt season during 2001 2012 was conducted with nse as the objective function the parameters c s and c r to be calibrated were allowed to vary within the range of 0 2 and 0 75 at a discrete size of 0 01 for each sub period the recession coefficient related parameters ρ and σ were calculated to be 1 076 and 0 055 respectively based on the recession discharge data of the snowmelt seasons from 2001 to 2012 at the kswt station 4 1 1 the statistics of the model performance tables 9 and 10 show the summary of the calibration results for 12 year snowmelt seasons in terms of nse nseln dv and nnd respectively using the two calibration methods with different sub periods i e one month half a month ten days and five days the variability of models performance criteria using the two calibration methods is provided using box and whisker diagrams in fig 4 it can be seen from table 9 and fig 4 a that for any given sub period the mean and standard deviation sd of nse obtained by psoa are better than those by soa it is also seen that the mean sd and three quartiles of nse by psoa show continuous improvements when the length of sub period becomes shorter but this is not always the case by soa table 9 and fig 4 b show the changes of nseln with calibration sub period for most sub periods the mean of nseln is improved using the psoa method compared to the soa method although the maximized nse does not guarantee a maximized nseln when the length of sub period becomes shorter the mean and three quartiles of nseln obtained by psoa show a little bit of improvement but those of nseln by soa do not always improve and even deteriorate besides the sds obtained by psoa reach a stable state when the length of sub period becomes shorter whereas sds obtained by soa are unstable even though they are better than those by psoa for some sub periods table 10 and fig 4 c show the changes of dv with calibration sub periods it can be seen that for a given sub period although nse is selected to be maximized the mean the average of all absolute dv values sd and three quartiles of the simulated flow volumes are improved more obviously using psoa than soa when the sub period becomes shorter the mean sd and three quartiles of dv obtained using the psoa method also show a stable state while those using the soa method show an increasing trend table 10 and fig 4 d show the changes of nnd with calibration sub periods for a given sub period both mean and sd of the nnd values are improved using the psoa method compared to the soa method although nse is maximized besides the mean sd and three quartiles of nnd obtained by psoa show improving trends when the length of sub period becomes shorter but those by soa do not always improve and even deteriorate when the sub period becomes shorter in conclusion the statistics of the four criteria obtained by the psoa method are better than those by the soa method for a given sub period the statistics by psoa show improving trend or stable state when the lenth of sub period becomes shorter but those by soa do not always improve and even deteriorate 4 1 2 simulated daily runoff hydrographs fig 5 shows the observed and simulated daily runoff hydrographs using the psoa and soa methods for each snowmelt season between 2001 and 2012 with a sub period of five days it can also be seen apparently from fig 5 that psoa produced an overall better agreement with the observed runoff curve than soa the time of the simulated hydrograph peaks using psoa and soa is similar but the peak values by psoa match better to the observed values all results discussed in section 4 1 show that the psoa method performs better than the soa method in parameter calibration 4 2 the performance of the soa and psoa algorithms in long term snowmelt runoff simulation using srm the long term snowmelt runoff simulation using srm was conducted for the snowmelt seasons of 2001 2012 by using the soa and psoa calibration algorithms model calibration was performed for the snowmelt seasons of 2001 2008 while validation was for 2009 2012 during calibration nse was selected as the objective function c s and c r of zone a were both calibrated for the same sub period for the snowmelt seasons of 2001 2008 e g c s or c r have unique value for each snowmelt month of 2001 2008 taking one month as sub period which were also allowed to vary within the range of 0 20 and 0 75 at a discrete size of 0 01 the parameters ρ and σ that are related to recession coefficient during calibration and validation phases were calculated to be 1 086 and 0 059 respectively using the recession discharge data of the snowmelt seasons from the calibration period 2001 to 2008 at the kswt station assuming that they are unknown during validation phase 4 2 1 calibrated values of cs and cr using psoa algorithm table 11 shows the calibrated c s and c r values from the psoa calibration only since the changing pattern of c s and c r values calculated from soa was similar it can be seen from the table that c s value decreases from march to may and then increases slightly in june and c r decreases from march to april and then increases slightly in may and june for all lengths of sub period although there are some sudden jumps when the length of sub period become short from march to may warmer temperatures result in higher snowmelt or rainfall losses from evaporation and infiltration resulting in the decrease of c s and c r some sudden jumps in c s and c r may be caused by the model considering the varied hydrometeorological snow cover ratio and soil moisture conditions in much more details when the length of sub period become shorter 4 2 2 the model performance in the calibration and validation phases using the soa and psoa algorithms the average values of nse nseln dv and nnd from the calibration and validation phases with different sub periods using the two calibration algorithms are shown in figs 6 and 7 it can be seen that the average nse values obtained using psoa are larger than those using soa for all sub periods in both the calibration and validation phases the average values of nseln dv and nnd are also improved using the psoa method in both the calibration and validation phases it can also be seen that during the calibration phase the average values of nse nseln and nnd obtained using the psoa method show increasing trends of improvements when the length of sub period decreases while there is no such trend using the soa method besides nse nseln and nnd improve more using psoa than soa when the length of sub period is reduced all the results indicate that psoa is more robust than soa and suggest the superiority of psoa to soa especially when the sub period is short 4 3 effects of different objective functions and sub periods on model performance the results of the average values of nse nseln dv and nnd for various sub periods and different objective functions are shown in figs 8 and 9 for the calibration and validation phase respectively it is seen that different objective functions result in similar model performance in both the calibration and the validation phases for a given sub period except for the objective function dv which results in an apparently worse performance for the sub period of five days the impacts of the sub period length on model performance for different objective functions are complex taking all the four evaluation criteria into consideration during the calibration phase the model performance is improved continually when the length of sub period becomes shorter for any objective function except for the dv however in the validation phase there is no improvement or any other varying patterns when the length of sub period is getting shorter this phenomenon is probably due to over fitting over fitted simulation in the calibration phase leads to poor prediction in the validation phase thefore a compromised length of sub period and objective function may have to be chosen as a trade off among evaluation criteria and between the importance of calibration and validation phases based on the objective of the model application generally dv which is usually used as a criterion of model performance focusing on volumes was not recommended to take as the objective function for dynamic streamflow prediction because its weakness in accounting for the day to day difference between observed and simulated discharge hence it is thus expected that the model with dv as an objective function shows unstable performance for different lengths of sub period in this case study 5 discussions the hydrological processes and precipitation runoff relationship are generally complex which change not only within years or decades but also in seasons to capture the time varying nature of hydrological processes and reduce model uncertainty it is necessary to allow key parameters of hydrological models varying with time during model calibration and validation stages levesque et al 2008 zhang et al 2011 kim and lee 2014 kim 2016 a most approachable method is to divide the hydrological year into several sub periods and assume that the model parameters are constant in each sub period this approach is equivalent to approximating a smooth curve in time with a function of steps the smaller the sub periods are the better the approximation will be both the soa and psoa algorithms are such approaches obviously they are not perfect but both are at least better than taking the model parameters as constant during the whole calibration period while they are in fact variable it should be noted that the selection of parameters to be optimized is important the selected parameters must be time variant and a certain jump in parameter values between two adjacent sub periods is tolerable generally constant parameter such as maximum capacity of soil storage can not be optimized in each sub period if such a parameter is optimized sub period by sub period continuity problems in the water balance will occur when the parameter value changes from one sub period to the next for instance if the capacity is 100 mm and the content in the store is 90 mm at the end of the first period and the capacity on the next period is 80 mm what is done with the 10 mm over the capacity therefore the selection of parameters to be optimized must be done with due care when applying a calibration algorithm such as soa and psoa there are two ways to partition the whole data period into sub periods one is dividing the observation data into several periods of hydroclimatic similarity the other way is to directly divide the calibration period into several sub periods with the same length in the second way extensive efforts on classifying the whole calibration period into too many sub periods with different lengths based on hydro meteorological characteristics can be avoided generally the evaluation criteria such as nse nseln and dv will get improvement when the length of sub period becomes shorter using calibration method such as the psoa algorithm this is the situation in calibration phase in our case study however in the validation phase the criteria do not always improve accordingly resulting in overfitting problems which indicates that the model does not always produce better performance with too short sub periods in the validation phase such overfitting problems are not caused by calibration algorithm itself but probably by factors such as the structure of the hydrological model used non stationarity of the snowmelt runoff process between the calibration and validation phases lack of power in the objective function etc gupta et al 2009 other important factors may include that the model considers the hydrological characteristics with too many details when a too short sub period is adopted in the calibration phase a short sub period increases the number of calibrated parameters and makes these parameters vary irregularly see table 11 leading to poor performance in validation phase hence a compromised sub period should be chosen as a trade off between the importance of calibration and validation there are many factors affecting the model performance the quality of the observed data as inputs the accuracy of the values of the non calibrated parameters and accuracy of the calibrated model parameters for srm the important model inputs are the fraction of snow covered area the precipitation snow or rain air temperature data and the number of elevation zones the model s key parameters include the runoff coefficients of snowmelt and rainfall the degree day factor and the temperature lapse rate in the present study although only two model parameters i e the runoff coefficients of snowmelt and rainfall were calibrated there is no limit of the number of parameters to be calibrated in the calibration methods such as psoa and soa themselves however the more parameters to be calibrated is the more difficult it is to obtain their optimal values and to evaluate them on short sequences for the current case study on the manasi river basin due to spare hydro meteorological stations input data such as precipitation for each zone were estimated based on the observed records and corrected trmm data for the same study area some model parameters were predetermined based on the references xu 1996 feng et al 2000 hu 2004 and the time variant parameters such as the temperature lapse rate and the mass density of snow only were allowed to change monthly if daily temperature and precipitation are obtained directly from new data sources such as modis and trmm or the temperature lapse rate and the mass density of snow are allowed to change with different length of sub periods and more elevation zones are considered the model performance using psoa might be different in this study all results show that the proposed new calibration algorithm psoa outperforms the soa algorithm detailed comparison with soa showed that the model performance is better than soa for both single snowmelt season and multi snowmelt season simulations in terms of nse nseln dv and nnd the improvement of model performance using psoa over soa for calibration should be generally true but the extent of the improvement by psoa over soa is expected to depend on a basin s characteristics the model structure the quality of input data the values of non calibrated parameters and sub period length for calibration a further research on the performance of psoa in different basins would need to be carried out 6 summary and conclusions in this study we proposed a progressive segmented optimization algorism psoa for calibrating time variant parameters of hydrological models the algorithm was applied to simulate snowmelt runoff during the snowmelt seasons of 2001 2012 taking the manas river basin of xinjiang china as a test site using the srm model the psoa and standard soa algorithms were compared and evaluated for both single snowmelt season calibration and multi snowmelt season simulation 2001 2008 as the calibration phase and 2009 2012 as the validation phase the effects of objective functions and sub period length on model performance have also been analyzed the study concluded that 1 psoa can effectively calibrate the time variant model parameters while avoiding too much computational time caused by a significant increase of parameter dimensionality 2 for any given sub period psoa outperforms soa in terms of nse nseln dv and nnd both in the model calibration of single snowmelt season and in multi snowmelt season simulation for both calibration and validation periods as soa seeks optimal parameters for the sub period by optimizing the objective function based on the measured and estimated data only in the same sub period while psoa seeks optimal parameters by optimizing the objective function based on both the current and all the prior sub periods 3 for single snowmelt season calibration the length of the sub period has apparent effect on model performance the shorter the sub period is the better the model performance will be when the model is calibrated using the psoa method 4 in multi snowmelt season simulation using the psoa algorithm the model performances have little difference in all evaluation criteria when nse nseln and nnd are used as the objective functions but much better than the case when dv is used as the objective function especially for the sub period of five days 5 for multi snowmelt season simulation too short sub periods may cause overfitting problems when selecting some functions as objectives a compromised length of sub period may have to be chosen as a trade off between the importance of calibration and validation in such a case the proposed psoa method in the present study can be adopted for multi snowmelt season calibration which can identify more effective parameter set and improve model performance besides the idea of the psoa method can be beneficial for multi period optimization searching for global optimal solution according to the principle of the psoa algorithm it can be used for multi snowmelt season calibration not only for a single length of sub period but also for different lengths of sub period in order to better capture the time varying nature of the hydrological process at variant time scales acknowledgements this research is supported by the national natural science foundation of china grant no 41271353 thanks are due to dr hong yang norwegian institute of bioeconomy research norway and zheng duan chair of hydrology and river basin management technical university of munich for their helpful suggestions the authors would also like to thank the editors and anonymous reviewers for their valuable comments that significantly improved the quality of the paper 
6955,to capture the temporal variability of parameters of hydrological models the segmented optimization algorithm soa is usually used which subdivides the calibration period into a number of sub periods and seeks optimal parameters for each sub period by optimizing the objective function based on the measured and estimated data in the same sub period in this paper we developed a new method that is called a progressive segmented optimization algorithm psoa which seeks optimal parameters by optimizing the objective function based on both the current and all the prior sub periods we applied and compared the soa and psoa algorithms to the snowmelt runoff model srm in simulating snow melt streamflow for the manasi river basin northwest of china during snowmelt seasons of 2001 2012 the study showed 1 psoa can effectively calibrate the time variant model parameters while avoiding too much computational time caused by a significant increase of parameter dimensionality 2 psoa outperforms soa for both single snowmelt season and multi snowmelt season simulations 3 for single snowmelt season simulation the length of the sub period has an apparent effect on model performance the shorter the sub period is the better the model performance will be when the model is calibrated using the psoa method 4 for multi snowmelt season simulation an over short sub period may cause overfitting problems in some cases such as the situation of taking nash sutcliffe efficiency nse as the objective function a compromised length of sub period and objective function may have to be chosen as a trade off among evaluation criteria and between the importance of calibration and validation keywords model calibration progressive segmented optimization method snowmelt runoff model time variant parameter manasi river basin 1 introduction model calibration which attempts to estimate values of some critical model parameters that are not usually available or cannot be physically measured is one of the main research topics in the application of hydrological models to real case simulations gupta and sorooshian 1983 beven and binley 1992 shamir et al 2005 the classical single objective approaches primarily focus on matching one aspect of the hydrograph but other important hydrological processes implicit in the observations cannot be captured simultaneously boyle et al 2000 the multi objective approaches take into consideration of different aspects of the hydrograph by accounting for the trade off among different performance indicators gupta et al 1998 yapo et al 1998 boyle et al 2000 madsen 2000 vrugt et al 2003 jie et al 2016 which not only allow for an analysis of the trade offs among the different objective functions but also enable hydrologists to better understand model structures zhou et al 2014 jie et al 2016 the rainfall runoff processes are very complex due to a large number of controlling factors some factors such as climatic conditions and land use land covers vary in time leading to a time varying nature of hydrological responses over different temporal scales e g annual seasonal monthly and daily scales beighley and moglen 2002 merz et al 2006 choi and beven 2007 zhang et al 2011 tian et al 2012 hao et al 2015 the dynamic nature of hydrological systems brings uncertainties into hydrological simulations and predictions posing a challenge to accurate prediction forecasting of streamflow previous studies have shown that hydrological processes switch their dynamics between time steps periods which have not been properly represented by the existing models and dynamic calibration of the time varying hydrological processes will improve the prediction or forecasting ability of the hydrological models choi and beven 2007 levesque et al 2008 zhang et al 2011 kim and lee 2014 kim 2016 chen et al 2018 the most commonly used approach in the dynamic calibration of the time varying hydrological processes is to divide the whole calibration time period e g hydrological year and snowmelt season into several sub periods of hydroclimatic similarity and assume that the model parameters are constant in each sub period for example hay et al 2009 divided the hydrologic year into three groups based on an atmospheric pressure index kim and lee 2014 divided the calibration period into four seasons based on seasonal rainfall and streamflow patterns paik et al 2005 divided the calibration period into three 4 month seasons i e warm and dry rainy and cold and dry zhang et al 2015a b kim 2016 and chen et al 2018 separated the calibration period into dry and wet periods to improve model performance some researchers divided the calibration period into sub periods using clustering methods based on similar characteristics in the data during the model calibration period such as the fuzzy c mean clustering method choi and beven 2007 zhang et al 2011 the traditional k means clustering algorithm de vos et al 2010 and the self organizing maps based clustering method toth 2009 dividing a calibration period into too many sub periods leads to a significant increase in the parameter dimension making parameter calibration much more complex and time consuming to overcome the difficulties a feasible approach has been developed that calibrates parameters independently for each sub period which is referred to as segmented optimization algorithm soa however soa only optimizes parameters of each sub period to match the observed data just for that sub period and not for the whole period hence the optimized parameters of each sub period may not be globally optimal in view of the drawback of soa we proposed a progressive segmented optimization algorithm psoa for calibrating time variant parameters of hydrological models by dividing the calibration period into several sub periods and optimizing those parameters of each sub period to match the observed data of the whole period with such an approach global solution of parameters for all sub periods is obtained consequently and progressively to test the effectiveness of psoa compared to soa we took snowmelt runoff model as an example to simulate snowmelt runoff process with the time variant parameters in the manasi river basin northwest china the main parts of the paper are organized as follows the geographical and hydrological characteristics of the study area including the data sources and data preprocessing are described in section 2 the srm model and the proposed calibration algorithm are explicated in section 3 the results and discussions about possible effects of objective functions and sub period length on model outputs are presented in sections 4 and 5 conclusions are presented in section 6 2 study area and data 2 1 study area the manasi river basin 43 05 n 44 10 n and 85 00 e 86 20 e which is located in the xinjiang uygur autonomous region northwest china has a total area of 5179 km2 above the kensiwate kswt station see fig 1 the manasi river basin is one of the biggest irrigation areas in china the manasi river about 400 km long originates in the northern slope of tianshan mountains and it is the longest inland river in the junggar basin land covers in the manasi river basin take the form of bare soil open shrub lands grassland wood grassland meadow and snow ice the manasi river basin has a typical temperate continental arid climate the elevation of the basin ranges from 500 to 5216 m above mean sea level a m s l and the difference in height within the basin results in significant uneven distributions of temperature and precipitation the mean annual air temperature ranges from below 0 c in the mountainous areas to approximately 9 c at the basin outlet precipitation is abundant within the area of elevation between 1500 m and 3600 m where the mean annual precipitation reaches 600 700 mm but it drops to 100 200 mm in the piedmont plain feng et al 2000 ji and chen 2012 precipitation occurs mainly in summer june july and august and less in winter december january and february in the form of snowfall snow accumulates in winter and ablates mainly in spring and early summer june and it completely disappears in late summer the average annual runoff is about 12 8 108 m3 the intra annual distribution of runoff is uneven with about 9 7 69 8 16 5 and 5 0 of the annual runoff occurring in spring march may summer autumn september november and winter respectively meltwater from snow and glaciers in the spring and summer months accounts for about 35 9 of the annual runoff feng et al 2000 groundwater flow accounts for a small percentage of the total runoff but it dominates the streamflow in winter when there is neither rainfall nor meltwater for simplicity meltwater due to snow and glaciers will not be distinguished in the following discussion because runoff from meltwater of glaciers mainly happens in summer and geographically limited only to a small scale there are four hydrological stations at the lower part of the basin meiyao my kensiwate kswt qingshuihezi qshz and hongshanzui hsz the hsz station has been abandoned since 2006 to take advantage of the observed data at the other three stations the study area is thus taken as the portion of the basin above the kswt station as is shown in fig 1 the geographical and hydro climatic characteristics of the three stations are listed in table 1 2 2 data sources the digital elevation model dem used in this study is the shuttle radar topography mission srtm data with the resolution of 90 m farr et al 2007 the srtm data were downloaded from http srtm csi cgiar org the dem data were used for altitudinal belt partition zonal area estimation and temperature and precipitation interpolation daily precipitation and air temperature data observed at the my kswt and qshz hydrological stations fig 1 from 2001 to 2012 were used as model inputs daily runoff data from 2001 to 2012 at the kswt station were used for model calibration and verification the data were obtained from manasi hydrological bureau the hydro meteorological network is very sparse and the three hydrological stations are at the proximity to the basin outlet data from this network can hardly represent the daily rainfall distribution at the basin level thus the daily precipitation at different elevation zones was estimated through synthetization of the observations at the three hydrological stations with the relative annual precipitation gradient derived from corrected tropical rainfall measuring mission trmm data based on the regression models for the same study area as was discussed by ji and chen 2012 as there is no operational snow monitoring system established in the study area the modis snow cover data were used for model simulation numerous srm applications have had success in using snow data from modis butt and bilal 2011 georgievsky 2009 immerzeel et al 2009 qiu et al 2013 tahir et al 2011 for these studies conducted in watersheds with size between 500 and 27 000 km2 the 500 m resolution of modis was found sufficient for estimating the fraction of snow covered area kult et al 2014 the modis 8 day composite snow cover data product mod10a2 has higher precision in snow classification than modis daily products zhou et al 2005 huang et al 2007 in this study we adopted the modis 8 day composite product mod10a2 from march to june during 2001 to 2012 to derive the fraction of snow covered area for each zone the missing data 2 scenes are missing were obtained by a linear spatial interpolation algorithm assuming that the change with time between two consecutive 8 day snow fractions is linear the daily snow fraction of any date between the two 8 day periods for each zone is also calculated by linear spatial interpolation algorithm the detailed information about the data is summarized in table 2 the daily precipitation at stations my qshz and kswt is the total precipitation of rainfall and snowfall there is no detailed information on whether the total precipitation on a specific day is snow or rainfall 3 methodology 3 1 snow runoff model srm srm is a conceptual semi distributed and degree day temperature index model developed by martinec 1975 it has been used to simulate predict and or forecast daily runoff resulting from snowmelt and rainfall in mountainous regions and has been tested for over 100 basins at different geographical locations and spatial ranges in 29 countries martinec et al 2008 model input variables include daily average air temperature daily total precipitation and snow cover area based on the input values the following equation is used in srm to calculate the daily streamflow q m3 s 1 q i 1 q i k i 1 10000 86400 1 k i 1 l c s l i a l i t i δ t l i s l i c r l i p l i a l where i is the day number i 1 n n is the total number of days q 1 is the observed initial value of daily streamflow value before the simulation begins l is the index for each elevation zone l 1 l l is the total number of elevation zones 10000 86400 is the conversion factor from cm km2 day 1 to m3 s 1 k is the recession coefficient corresponding to the l th elevation zone c s and c r are the runoff coefficients expressing the losses as a ratio of runoff contributed by snowmelt and rain to precipitation respectively of the elevation zone a is the degree day factor cm c 1 d 1 t is the number of degree days of station c d δt is the adjustment by temperature lapse rate when extrapolating the temperature from the station to the average hypsometric elevation of the zone c d s is the fraction of snow covered area p is the precipitation contributing to runoff cm and al is the area of elevation zone l km2 3 2 determination of input variables and parameters srm is set up with daily input data of air temperature precipitation and fraction of snow covered area the basin was divided into four altitudinal zones with a nearly 1000 m difference in hypsometric elevation between each two neighboring zones the elevation boundaries areas land covers of each zone are detailed in table 3 3 2 1 daily zonal mean temperature the daily zonal mean temperatures were determined by extrapolating the mean temperature records available at the three hydrological stations by using the lapse rate value the temperature adjusted δt through temperature lapse rate is computed as follows 2 δ t γ h s t h 1 100 where γ is the temperature lapse rate c 100 m h st is the altitude of the hydrological station where temperature was measured h is the hypsometric mean elevation of a zone m studies in various high mountain catchments have shown spatial and temporal variability of the temperature lapse rate tahir et al 2011 zhang et al 2015a b due to the lack of observed data in the area those values were determined based on the study over the same area by feng et al 2000 table 4 since the difference in height among the observed sites is as large as 400 m validation of those values using observed data is not possible due to lack of observed temperature in higher elevation resolution however from table 4 we can see that except for the lowest zone a the temperature lapse rate increases from march to june in all other zones in march the temperature lapse rate increases with elevation from 0 50 c 100 m for zone a to 0 64 c 100 m for zone d while in april the temperature lapse rate remains almost constant 0 64 0 65 c 100 m in may the temperature lapse rate decreases with elevation from 0 78 c 100 m for zone a to 0 70 c 100 m for zone d in june zones a c show almost constant temperature lapse rate 0 77 0 78 c 100 m but decreases to 0 72 c 100 m in the highest zone zone d the spatial and temporal variability of the temperature lapse rate within these zones may indicate the local climate conditions of the basin 3 2 2 critical temperature a critical temperature t c is used to decide whether a precipitation event is treated as rainfall or snowfall the critical temperature is usually higher than freezing point and diminishes to 0 c as snowmelt season progresses according to meteorological observations at the tianshan snow observation station the critical temperature from the beginning to the end of the snowmelt season was observed to decrease from 3 5 to 0 c xu 1996 since the tianshan snow observation station and the manasi river basin are both located in tianshan mountain and they are about 100 km apart we took the daily t c values from 3 5 c to 0 c for the beginning to the end of a snowmelt season for each zone the times for the beginning and the end of the snowmelt season of each zone in the study area are determined based on the averaged snow ablation curve of multiple years for each zone and they are listed in table 5 the daily t c value for the beginning and the end of each snowmelt season was set to be 3 5 c and 0 c respectively the daily t c value for any day in between was interpolated linearly from 3 5 c to 0 c 3 2 3 precipitation the precipitation in each zone was estimated by synthesizing the observed data at the three hydrological stations with the precipitation gradient since no precipitation data are available for the area with the altitudes above 2000 m and vertical distribution of the precipitation is uneven hu 2004 ji and chen 2012 the precipitation gradient cannot be estimated from the rain gauge observations alone which are located at downstream ji and chen 2012 found the annual precipitation gradient in the area was 14 3 mm 100 m for zone b 8 1 mm 100 m for zone c and 6 6 mm 100 m for zone d based on the corrected tropical rainfall measuring mission trmm data for the period of 1998 to 2009 in this study the daily precipitation in zone a was taken as the average of the observations at the three hydrological stations in other zones they were estimated using the relative precipitation gradients based on the annual precipitation gradient ji and chen 2012 and the base value of the daily precipitation in zone a the daily precipitation in zone l is computed as follows 3 p l p a d l h l where pa is the daily precipitation in zone a p l and h l are the daily precipitation and altitude respectively in zone l l b c or d dl is the relative precipitation gradient of zone l to zone a precipitation contribution to runoff is considered in srm according to different stages of snowmelt season if the air temperature is lower than the critical temperature the precipitation is treated as new snow the new snowfall over the snow free area is considered as precipitation to be added to snowmelt calculation otherwise if the air temperature is above the critical temperature the precipitation as rainfall within the area of the entire zone is added martinec et al 2008 3 2 4 degree day factor the degree day factor was obtained from an empirical relation martinec and rango 1986 4 a 1 1 ρ s ρ w where ρ s is the mass density of snow and ρ w the mass density of water that was set to be 1 g cm3 the density of snow increases as the melt season progresses from winter to summer and the snowpack becomes wetter and denser by referring to the in situ data of ρ s in the tianshan mountain hu 2004 ρ s values were set for different zones from march to june table 6 3 2 5 runoff and recession coefficients the runoff coefficients for rainfall and snowfall c r and c s at a daily scale increase from lower to higher elevation zones given other factors such as soil and topography unchanged as warmer temperatures result in higher losses from evapotranspiration or sublimation in this study c s and c r in the zone a were calibrated as the season progresses and were set to increase by 10 per zone in other zones which produced the best results by using the trial and error calibration method the recession coefficient k indicates the decline of discharge in a period without snowmelt or rainfall corresponding to the ratio of runoff on consecutive days without snowmelt and rainfall k is assumed to vary with discharge q as martinec et al 2008 5 k i 1 q i 1 q i ρ q i σ where i i 1 are the sequence of days during a true recession flow period ρ and σ are parameters eq 5 can be reformatted by taking the natural log on both sides of the equation as 6 ln q i 1 ω φ ln q i where ω ln ρ and φ 1 σ parameters ω and φ in eq 6 can be obtained through linear regression analysis using the observed discharge data in summary due to the non uniformity of snowmelt runoff process throughout the snowmelt season some parameters temperature laps rate snow density runoff coefficients etc of snowmelt runoff model should vary with time to reflect the time varying characteristics of the runoff response mechanisms the temperature lapse rate and snow density were set to vary monthly over different elevation zones the critical temperatures were set to vary daily and their values were determined in advance tables 4 6 the runoff coefficients of snowmelt and rainfall were also allowed to vary for different length of sub periods such as one month half a month ten days and five days they need to be calibrated since they are not measurable by definition and can t be estimated simultaneously with runoff 3 3 calibration algorithm 3 3 1 the segmented optimization algorithm soa algorithm the soa algorithm separates the calibration period e g hydrological year into several sub periods e g four seasons kim and lee 2014 the model parameters to be calibrated in different sub periods are assumed to be independent of each other optimization is then performed consecutively and independently in one sub period followed by the next till the last one the objective function for each sub period is built upon the observed and simulated data of that period any known optimization method can be used in each sub period the procedure of soa is shown in table 7 and fig 2 supposing there is only one time varying parameter β and the whole period is divided into n sub periods with the same length of m e g if one year is divided into 12 months each month has a length of 30 days on average then n 12 m 30 in each sub period there are m observed runoff records then the total observed runoff series in the whole period can be expressed as o 1 o 2 o nm similarly the total simulated runoff series can be expressed as s 1 s 2 s nm corresponding to the β values the objective of calibration is to find the best value of β for each sub period denoted by β 1 β 2 β n making objective function f optimal the simulated runoffs in each sub period i are dependent on β i the calibration can be implemented through n steps in each step the β i is optimized with the objective function built upon the observed and simulated runoff series of sub period i the soa algorithm optimizes model parameters of each sub period independently the drawback of such a method is that the parameters are optimized just based on the observed and simulated runoff of the current sub period rather than the whole calibration period 3 3 2 the progressive segmented optimization algorithm psoa algorithm to overcome the shortcoming of soa mentioned above we propose psoa to optimize parameters the procedure of psoa includes two phases table 8 and fig 3 in the first phase the parameters of the model in each sub period are optimized separately through n steps from sub period 1 to sub period n in step 1 the β 1 is optimized with the objective function built upon the observed and simulated runoff series of sub period 1 in step 2 the β 2 is optimized with the objective function built upon the observed and simulated runoff series of sub period 1 and sub period 2 accordingly in step n the β n is optimized with the objective function built upon the observed and the simulated runoff series of sub period 1 to sub period n the simulated runoff series of sub period 1 to sub period n 1 are the results of hydrological model simulation based on optimized β 1 to β n 1 in this way the parameter optimization of the current sub period takes into account the results of the optimized parameters of all the previous sub periods in the second phase the parameters of the model are still optimized successively through n steps from sub period 1 to sub period n in step i the βi is optimized with the objective function built upon the observed and simulated runoff series of all the sub periods in which the simulated runoff series of sub periods 1 to i 1 and sub periods i 1 to n are from the most lately simulated results the calibration in the second phase will be repeated until the improvement of the whole objective function is less than a given tolerance the characteristic of the calibration in the second phase is that the parameters of each sub period are globally optimized after recursive optimization in such a way the shortcomings in the calibration of time varying parameters using the soa method can be overcome as far as we know there is no similar method in the literature 3 4 the model evaluation criteria in order to evaluate statistically the accuracy of the calibrated and validated runoff outputs using the new calibration method different parts of the hydrograph should be considered with the appropriate evaluation criteria low and high flows need to be simulated well and a good mass balance is also required in this study the following three commonly used criteria were employed the nash sutcliffe efficiency nse the nseln the nse calculated using log transformed discharge and volume difference dv nse is given by nash and sutcliffe 1970 7 nse 1 i 1 n o i s i 2 i 1 n o i o 2 and nseln is given by 8 nse ln 1 i 1 n ln o i l n s i 2 i 1 n ln o i l n o 2 where oi is the observed daily discharge si is the simulated daily discharge if oi or si is equal to 0 it should be set to a small positive value less than 1 o is the average observed discharge and i is the day number i 1 n where n is the total number of daily discharge records the dv is given by 9 dv v v v 100 where v is the observed runoff volume and v is the simulated runoff volume nse has been widely employed to evaluate the performances of hydrological models and it tends to emphasize the high or peak flows nseln places more emphasis on fitting low flows chen et al 2018 the dv is a measure of the average deviation between the simulated and observed volumes from a multi objective viewpoint all criteria could not reach their best values simultaneously a balanced compromised aggregated evaluation considering different criteria should be made in this study the euclidian distance function was adopted as another criterion 10 n n d 1 n s e 2 1 nse l n 2 d v 100 2 where nnd is the euclidian distance from the ideal point of nse nseln and dv all the three components are dimensionless and their ideal values are 1 1 and 0 respectively the smaller the nnd is the better the model performance will be if the three components have different range or scale weighting factors can be used for adjusting the emphasis on different components gupta et al 2009 the four criteria were also taken as objective functions in analyzing the effects of different objective functions on the srm performances using the psoa algorithm 3 5 comparison of the soa and psoa algorithms in snowmelt runoff simulation using srm the parameters of c s and c r were calibrated and the model performance was evaluated by using the calibration algorithms soa and psoa in the following procedure firstly the srm calibration for each snowmelt season from march to june during the 2001 2012 period was conducted separately using the two calibration algorithms obtaining two optimal sets of c s and c r for each snowmelt season by both algorithms secondly the long term snowmelt runoff for all snowmelt seasons was simulated as a whole by the srm model using both algorithms with a split sample procedure calibration and validation phases only two sets of c s and c r were obtained by both algorithms during calibration phase the enumeration approach was adopted in each step of both algorithms to search for optimal values of c s and c r from all possible combined sets of them within adjustment ranges the initial runoff was set as follows for the first sub period it was set to be the observed streamflow of the day before the sub period for the following sub periods it is the simulated streamflow at the end of the previous sub period the effects of different lengths of sub periods and objective functions on the model performance were also analyzed 4 results 4 1 the performance of the soa and psoa algorithms for the srm calibration in each snowmelt season to evaluate the performance of the psoa algorithm in reference to the standard soa algorithm the calibration of snowmelt runoff for each snowmelt season during 2001 2012 was conducted with nse as the objective function the parameters c s and c r to be calibrated were allowed to vary within the range of 0 2 and 0 75 at a discrete size of 0 01 for each sub period the recession coefficient related parameters ρ and σ were calculated to be 1 076 and 0 055 respectively based on the recession discharge data of the snowmelt seasons from 2001 to 2012 at the kswt station 4 1 1 the statistics of the model performance tables 9 and 10 show the summary of the calibration results for 12 year snowmelt seasons in terms of nse nseln dv and nnd respectively using the two calibration methods with different sub periods i e one month half a month ten days and five days the variability of models performance criteria using the two calibration methods is provided using box and whisker diagrams in fig 4 it can be seen from table 9 and fig 4 a that for any given sub period the mean and standard deviation sd of nse obtained by psoa are better than those by soa it is also seen that the mean sd and three quartiles of nse by psoa show continuous improvements when the length of sub period becomes shorter but this is not always the case by soa table 9 and fig 4 b show the changes of nseln with calibration sub period for most sub periods the mean of nseln is improved using the psoa method compared to the soa method although the maximized nse does not guarantee a maximized nseln when the length of sub period becomes shorter the mean and three quartiles of nseln obtained by psoa show a little bit of improvement but those of nseln by soa do not always improve and even deteriorate besides the sds obtained by psoa reach a stable state when the length of sub period becomes shorter whereas sds obtained by soa are unstable even though they are better than those by psoa for some sub periods table 10 and fig 4 c show the changes of dv with calibration sub periods it can be seen that for a given sub period although nse is selected to be maximized the mean the average of all absolute dv values sd and three quartiles of the simulated flow volumes are improved more obviously using psoa than soa when the sub period becomes shorter the mean sd and three quartiles of dv obtained using the psoa method also show a stable state while those using the soa method show an increasing trend table 10 and fig 4 d show the changes of nnd with calibration sub periods for a given sub period both mean and sd of the nnd values are improved using the psoa method compared to the soa method although nse is maximized besides the mean sd and three quartiles of nnd obtained by psoa show improving trends when the length of sub period becomes shorter but those by soa do not always improve and even deteriorate when the sub period becomes shorter in conclusion the statistics of the four criteria obtained by the psoa method are better than those by the soa method for a given sub period the statistics by psoa show improving trend or stable state when the lenth of sub period becomes shorter but those by soa do not always improve and even deteriorate 4 1 2 simulated daily runoff hydrographs fig 5 shows the observed and simulated daily runoff hydrographs using the psoa and soa methods for each snowmelt season between 2001 and 2012 with a sub period of five days it can also be seen apparently from fig 5 that psoa produced an overall better agreement with the observed runoff curve than soa the time of the simulated hydrograph peaks using psoa and soa is similar but the peak values by psoa match better to the observed values all results discussed in section 4 1 show that the psoa method performs better than the soa method in parameter calibration 4 2 the performance of the soa and psoa algorithms in long term snowmelt runoff simulation using srm the long term snowmelt runoff simulation using srm was conducted for the snowmelt seasons of 2001 2012 by using the soa and psoa calibration algorithms model calibration was performed for the snowmelt seasons of 2001 2008 while validation was for 2009 2012 during calibration nse was selected as the objective function c s and c r of zone a were both calibrated for the same sub period for the snowmelt seasons of 2001 2008 e g c s or c r have unique value for each snowmelt month of 2001 2008 taking one month as sub period which were also allowed to vary within the range of 0 20 and 0 75 at a discrete size of 0 01 the parameters ρ and σ that are related to recession coefficient during calibration and validation phases were calculated to be 1 086 and 0 059 respectively using the recession discharge data of the snowmelt seasons from the calibration period 2001 to 2008 at the kswt station assuming that they are unknown during validation phase 4 2 1 calibrated values of cs and cr using psoa algorithm table 11 shows the calibrated c s and c r values from the psoa calibration only since the changing pattern of c s and c r values calculated from soa was similar it can be seen from the table that c s value decreases from march to may and then increases slightly in june and c r decreases from march to april and then increases slightly in may and june for all lengths of sub period although there are some sudden jumps when the length of sub period become short from march to may warmer temperatures result in higher snowmelt or rainfall losses from evaporation and infiltration resulting in the decrease of c s and c r some sudden jumps in c s and c r may be caused by the model considering the varied hydrometeorological snow cover ratio and soil moisture conditions in much more details when the length of sub period become shorter 4 2 2 the model performance in the calibration and validation phases using the soa and psoa algorithms the average values of nse nseln dv and nnd from the calibration and validation phases with different sub periods using the two calibration algorithms are shown in figs 6 and 7 it can be seen that the average nse values obtained using psoa are larger than those using soa for all sub periods in both the calibration and validation phases the average values of nseln dv and nnd are also improved using the psoa method in both the calibration and validation phases it can also be seen that during the calibration phase the average values of nse nseln and nnd obtained using the psoa method show increasing trends of improvements when the length of sub period decreases while there is no such trend using the soa method besides nse nseln and nnd improve more using psoa than soa when the length of sub period is reduced all the results indicate that psoa is more robust than soa and suggest the superiority of psoa to soa especially when the sub period is short 4 3 effects of different objective functions and sub periods on model performance the results of the average values of nse nseln dv and nnd for various sub periods and different objective functions are shown in figs 8 and 9 for the calibration and validation phase respectively it is seen that different objective functions result in similar model performance in both the calibration and the validation phases for a given sub period except for the objective function dv which results in an apparently worse performance for the sub period of five days the impacts of the sub period length on model performance for different objective functions are complex taking all the four evaluation criteria into consideration during the calibration phase the model performance is improved continually when the length of sub period becomes shorter for any objective function except for the dv however in the validation phase there is no improvement or any other varying patterns when the length of sub period is getting shorter this phenomenon is probably due to over fitting over fitted simulation in the calibration phase leads to poor prediction in the validation phase thefore a compromised length of sub period and objective function may have to be chosen as a trade off among evaluation criteria and between the importance of calibration and validation phases based on the objective of the model application generally dv which is usually used as a criterion of model performance focusing on volumes was not recommended to take as the objective function for dynamic streamflow prediction because its weakness in accounting for the day to day difference between observed and simulated discharge hence it is thus expected that the model with dv as an objective function shows unstable performance for different lengths of sub period in this case study 5 discussions the hydrological processes and precipitation runoff relationship are generally complex which change not only within years or decades but also in seasons to capture the time varying nature of hydrological processes and reduce model uncertainty it is necessary to allow key parameters of hydrological models varying with time during model calibration and validation stages levesque et al 2008 zhang et al 2011 kim and lee 2014 kim 2016 a most approachable method is to divide the hydrological year into several sub periods and assume that the model parameters are constant in each sub period this approach is equivalent to approximating a smooth curve in time with a function of steps the smaller the sub periods are the better the approximation will be both the soa and psoa algorithms are such approaches obviously they are not perfect but both are at least better than taking the model parameters as constant during the whole calibration period while they are in fact variable it should be noted that the selection of parameters to be optimized is important the selected parameters must be time variant and a certain jump in parameter values between two adjacent sub periods is tolerable generally constant parameter such as maximum capacity of soil storage can not be optimized in each sub period if such a parameter is optimized sub period by sub period continuity problems in the water balance will occur when the parameter value changes from one sub period to the next for instance if the capacity is 100 mm and the content in the store is 90 mm at the end of the first period and the capacity on the next period is 80 mm what is done with the 10 mm over the capacity therefore the selection of parameters to be optimized must be done with due care when applying a calibration algorithm such as soa and psoa there are two ways to partition the whole data period into sub periods one is dividing the observation data into several periods of hydroclimatic similarity the other way is to directly divide the calibration period into several sub periods with the same length in the second way extensive efforts on classifying the whole calibration period into too many sub periods with different lengths based on hydro meteorological characteristics can be avoided generally the evaluation criteria such as nse nseln and dv will get improvement when the length of sub period becomes shorter using calibration method such as the psoa algorithm this is the situation in calibration phase in our case study however in the validation phase the criteria do not always improve accordingly resulting in overfitting problems which indicates that the model does not always produce better performance with too short sub periods in the validation phase such overfitting problems are not caused by calibration algorithm itself but probably by factors such as the structure of the hydrological model used non stationarity of the snowmelt runoff process between the calibration and validation phases lack of power in the objective function etc gupta et al 2009 other important factors may include that the model considers the hydrological characteristics with too many details when a too short sub period is adopted in the calibration phase a short sub period increases the number of calibrated parameters and makes these parameters vary irregularly see table 11 leading to poor performance in validation phase hence a compromised sub period should be chosen as a trade off between the importance of calibration and validation there are many factors affecting the model performance the quality of the observed data as inputs the accuracy of the values of the non calibrated parameters and accuracy of the calibrated model parameters for srm the important model inputs are the fraction of snow covered area the precipitation snow or rain air temperature data and the number of elevation zones the model s key parameters include the runoff coefficients of snowmelt and rainfall the degree day factor and the temperature lapse rate in the present study although only two model parameters i e the runoff coefficients of snowmelt and rainfall were calibrated there is no limit of the number of parameters to be calibrated in the calibration methods such as psoa and soa themselves however the more parameters to be calibrated is the more difficult it is to obtain their optimal values and to evaluate them on short sequences for the current case study on the manasi river basin due to spare hydro meteorological stations input data such as precipitation for each zone were estimated based on the observed records and corrected trmm data for the same study area some model parameters were predetermined based on the references xu 1996 feng et al 2000 hu 2004 and the time variant parameters such as the temperature lapse rate and the mass density of snow only were allowed to change monthly if daily temperature and precipitation are obtained directly from new data sources such as modis and trmm or the temperature lapse rate and the mass density of snow are allowed to change with different length of sub periods and more elevation zones are considered the model performance using psoa might be different in this study all results show that the proposed new calibration algorithm psoa outperforms the soa algorithm detailed comparison with soa showed that the model performance is better than soa for both single snowmelt season and multi snowmelt season simulations in terms of nse nseln dv and nnd the improvement of model performance using psoa over soa for calibration should be generally true but the extent of the improvement by psoa over soa is expected to depend on a basin s characteristics the model structure the quality of input data the values of non calibrated parameters and sub period length for calibration a further research on the performance of psoa in different basins would need to be carried out 6 summary and conclusions in this study we proposed a progressive segmented optimization algorism psoa for calibrating time variant parameters of hydrological models the algorithm was applied to simulate snowmelt runoff during the snowmelt seasons of 2001 2012 taking the manas river basin of xinjiang china as a test site using the srm model the psoa and standard soa algorithms were compared and evaluated for both single snowmelt season calibration and multi snowmelt season simulation 2001 2008 as the calibration phase and 2009 2012 as the validation phase the effects of objective functions and sub period length on model performance have also been analyzed the study concluded that 1 psoa can effectively calibrate the time variant model parameters while avoiding too much computational time caused by a significant increase of parameter dimensionality 2 for any given sub period psoa outperforms soa in terms of nse nseln dv and nnd both in the model calibration of single snowmelt season and in multi snowmelt season simulation for both calibration and validation periods as soa seeks optimal parameters for the sub period by optimizing the objective function based on the measured and estimated data only in the same sub period while psoa seeks optimal parameters by optimizing the objective function based on both the current and all the prior sub periods 3 for single snowmelt season calibration the length of the sub period has apparent effect on model performance the shorter the sub period is the better the model performance will be when the model is calibrated using the psoa method 4 in multi snowmelt season simulation using the psoa algorithm the model performances have little difference in all evaluation criteria when nse nseln and nnd are used as the objective functions but much better than the case when dv is used as the objective function especially for the sub period of five days 5 for multi snowmelt season simulation too short sub periods may cause overfitting problems when selecting some functions as objectives a compromised length of sub period may have to be chosen as a trade off between the importance of calibration and validation in such a case the proposed psoa method in the present study can be adopted for multi snowmelt season calibration which can identify more effective parameter set and improve model performance besides the idea of the psoa method can be beneficial for multi period optimization searching for global optimal solution according to the principle of the psoa algorithm it can be used for multi snowmelt season calibration not only for a single length of sub period but also for different lengths of sub period in order to better capture the time varying nature of the hydrological process at variant time scales acknowledgements this research is supported by the national natural science foundation of china grant no 41271353 thanks are due to dr hong yang norwegian institute of bioeconomy research norway and zheng duan chair of hydrology and river basin management technical university of munich for their helpful suggestions the authors would also like to thank the editors and anonymous reviewers for their valuable comments that significantly improved the quality of the paper 
6956,after the impoundment of three gorges reservoir algal blooms frequently occurred in the tributaries of the reservoir which has posed a great challenge for the local aquatic environment and ecology to investigate the main causes and key factors of the algal blooms the environmental fluid dynamics code efdc model is applied to the simulation of the three dimensional hydrodynamics and water quality in the yangtze river and xiangxi bay and the concept of water age is adopted to quantitatively analyze the effects of hydrodynamics on the water quality by linking water age and phytoplankton levels which has seldom been explored in previous studies the model results show good agreement with the field data and the simulation reproduces the thermal stratification and density current in xiangxi bay the results show that xiangxi bay exhibits quite complicated hydrodynamic characteristics and could be divided into different zones according to the transport process in the upper reach the water quality is mainly affected by the upstream inflows while it is mainly affected by the intrusion flow from the mainstream near the river mouth water age and water temperature are found to be the key factors influencing the algal blooms in xiangxi bay besides a significant positive correlation has been found between the chlorophyll a chl a concentration in the surface layer and the water age of the dominant water source this conclusion can be adopted to interpret the longitudinal distribution of chl a concentration and to explain why xiangxi bay is susceptible to algal blooms the correlation between water age and chl a concentration is further used to evaluate the effectiveness of water level fluctuation in preventing algal blooms the analyses and findings in this study could help to better understand the complicated hydrodynamic and water quality processes in xiangxi bay following the impoundment and provide insights into ecological and environmental management of three gorges reservoir keywords eutrophication three gorges reservoir numerical simulation water age transport process chlorophyll a concentration 1 introduction along with economic development and human activities eutrophication and algal blooms have threatened many rivers lakes and reservoirs accumulation of nutrients and outbreaks of algal blooms can threaten drinking water supplies public health and the sustainability of ecosystems anderson et al 2002 chen et al 2016 sulcius et al 2017 stone 2011 as the largest hydropower project all over the world the three gorges project has brought remarkable benefits including flood control electricity generation and shipping capacity improvement but it has also changed the environmental conditions of natural rivers after the impoundment of three gorges reservoir in 2003 algal blooms occurred in the daning river shennong stream meixi river xiaojiang river and many other tributaries of the reservoir fu et al 2010 ministry of environmental protection of china mepc 2014 yang et al 2013 which has caused negative ecological and environmental impacts researching on the formation and mechanism of algal blooms in the three gorges reservoir region can help to understand the status of water quality in this region and to propose effective countermeasures to control the algal blooms and improve the ecological environment physical and biogeochemical processes are crucial to water quality and aquatic ecosystems algal blooms are also controlled by these two processes and are mainly influenced by light intensity water temperature nutrients and hydrodynamic characteristics anderson et al 2002 jones and poplawski 1998 merel et al 2013 previous studies have taken these factors into account when investigating the possible causes of algal blooms and the dynamics of phytoplankton community structure in the tributaries of three gorges reservoir dai et al 2013 liu liu et al 2012 wang et al 2011 ye et al 2007 zeng et al 2006 moreover preliminary conclusions have been obtained stating that outbreaks of algal blooms result from a combination of various factors the changes of nutrient concentrations light intensity and temperature in the yangtze river and its tributaries before and after the impoundment are negligible whereas the significant change of hydrodynamic characteristics is probably the main cause of algal blooms liu liu et al 2012 liu yang et al 2016 zeng et al 2007 however the following questions remain to be answered a why did algal blooms occur mostly in the tributaries but not in the mainstream b how can the hydrodynamic conditions and their differences in the mainstream and tributaries be characterized quantitatively or what indicator can be used to represent the hydrodynamic conditions c how can the effects of hydrodynamics on the water quality and algal blooms be analyzed quantitatively to answer these questions the concept of water age is adopted in this study the dissolved and suspended substances and living organisms in the hydrosphere are transported by water flow and it takes a certain time to transport these constituents from one specific location to another which mainly depends on the hydrodynamic conditions therefore transport timescales such as water age residence time and flushing time can be used to quantify the water exchange and transport processes and to assess the assimilative capacity of water water age is defined as the time elapsed since the water parcel under consideration left the region where its age is prescribed to be zero zimmerman 1976 delhez et al 1999 the concept of water age can characterize the temporal and spatial variations of water transport process and has been widely applied to lakes estuaries oceans and other semi enclosed water bodies delhez and deleersnijder 2002 gourgue et al 2007 karna and baptista 2016 ren et al 2014 shen and haas 2004 compared with other timescales water age is time and location dependent and its spatial and temporal distributions are easier to be obtained in practice besides water age can indicate the transport process of different water sources when different boundary conditions are set up a few researchers have investigated the relationships between water quality and transport timescales lucas et al 2009 qi et al 2016 zhang et al 2016 as the balance between phytoplankton growth and loss changes various relationships between phytoplankton biomass and transport time may be observed lucas et al 2009 qi et al 2016 simulated the distribution of water age under different hydrological conditions in poyang lake and found similar patterns of water age and chlorophyll a concentration in their spatial distributions however the quantitative relation between water quality and water age has seldom been reported in previous studies the objectives of this study are to find a suitable indicator to characterize the significant differences of hydrodynamic conditions in the yangtze river and its tributaries and to quantitatively analyze the effects of hydrodynamics on the water quality and algal blooms using this indicator i e water age in our study more importantly the key factors that influence algal bloom dynamics in the three gorges reservoir region are to be identified the environmental fluid dynamics code efdc model is applied to simulate the hydrodynamics and water quality in the yangtze river and xiangxi bay and to identify the temporal and spatial distribution of water age the quantitative relation between surface chl a concentration and water age is then discussed and the effectiveness of water level fluctuation in water quality restoration is also evaluated 2 materials and methods 2 1 study area three gorges reservoir an artificial lake created by the construction of three gorges dam in the upper reach of the yangtze river has a surface area of approximately 1084 km2 and a total storage capacity of 39 3 billion m3 at the normal water level of 175 m the three gorges reservoir region has a humid subtropical climate with an average annual temperature of 17 6 c average annual precipitation of 1122 5 mm and average annual wind speed of 1 3 m s mepc 2014 the rapid development of the economy and growth of population along the yangtze river have resulted in the increase of pollutant emissions the concentration of nutrients primarily nitrogen and phosphorus in the water before and after the impoundment was always high and far beyond the thresholds for eutrophication total phosphorus 0 02 mg l total nitrogen 0 2 mg l yang et al 2010 however no algal bloom was reported prior to the impoundment of three gorges reservoir nevertheless during the impoundment in 2003 algal bloom occurred in the daning river for the first time and various algal blooms in the tributaries were recorded after that from 2003 to 2013 the number of tributaries subjected to algal blooms fluctuated with a rising trend fig 1 and the areas affected by algal blooms gradually extended to the upstream of three gorges reservoir as the water level rose over the past few years the algal blooms in the tributaries have become a prominent problem the xiangxi river is located in hubei province with a length of 94 km it flows south into the yangtze river and the river mouth is about 34 5 km upstream of the dam the total area of the xiangxi river basin 110 25 111 06 e 30 57 31 34 n is about 3099 km2 after the impoundment a backwater zone called xiangxi bay 25 40 km in length formed in the xiangxi river and the flow velocity therein was quite low which was suitable for algal growth algal blooms of different intensity occurred in xiangxi bay almost every year and a severe cyanobacterial bloom broke out during the summer of 2008 in this study the computational domain fig 2 includes the 70 km river reach in the yangtze river from badong county to the three gorges dam and the 30 km river reach in the xiangxi river from gaoyang town to the river mouth ten sampling sites a01 a10 in the xiangxi river and one sampling site cj in the yangtze river were set up to monitor the flow velocity water temperature and water quality variables 2 2 model description the environmental fluid dynamics code efdc model developed by hamrick 1992 is capable of simulating one two or three dimensional water flow sediment transport and water quality and has been applied to a wide range of studies on rivers lakes reservoirs and estuaries bai and lung 2005 gong et al 2016 he et al 2011 ji et al 2002 jin et al 2000 wang et al 2010 the efdc model uses cartesian or curvilinear orthogonal horizontal coordinates and a sigma vertical coordinate the hydrodynamic model consists of continuity equation momentum equations state equation and transport equations for salinity and temperature and the mellor yamada level 2 5 turbulence closure scheme mellor and yamada 1982 galperin et al 1988 is implemented to calculate the vertical turbulent viscosity and diffusivity the water quality module in efdc driven by the hydrodynamic model centers on the primary production by algae and the concentration of dissolved oxygen in the framework of the water quality module fig 3 which contains 22 state variables algae utilize inorganic nutrients and produce oxygen through photosynthesis and consume dissolved oxygen and release organic matter through metabolism organic carbon undergoes numerous transformations and consumes dissolved oxygen organic nitrogen and organic phosphorus are converted to inorganic forms via hydrolysis and mineralization more details can be found in park et al 1995 2 3 simulation of water age water age can be calculated using eulerian models delhez et al 1999 deleersnijder et al 2001 or lagrangian models chen 2007 liu et al 2011 deleersnijder et al 2001 put forward the constituent oriented age and residence time theory cart which has been extensively applied to numerical simulation of water age delhez and deleersnijder 2002 gourgue et al 2007 karna and baptista 2016 ren et al 2014 shen and haas 2004 in this theory the tracer concentration and age concentration are calculated by solving the advection diffusion reaction equations 1 c t x t u c t x k c t x 0 2 α t x t u α t x k α t x c t x where the tracer concentration c t x and age concentration α t x are functions of time t and location x u denotes the velocity vector k is the diffusivity tensor water age a t x can then be obtained as follows 3 a t x α t x c t x 2 4 model configuration the curvilinear and orthogonal horizontal coordinates are used in this study to better fit the river boundary the computational domain in fig 2 is divided into 742 grid cells with a local mesh refinement near the river mouth the grid sizes vary from 35 m to 580 m in the i direction and 170 m to 1900 m in the j direction in the vertical direction 10 uniform layers are deployed in the sigma coordinate the simulation period is from january to december in 2010 and the model time step is set to a constant of 6 0 s the initial conditions including water level and water temperature are specified as constant values the influence of the initial conditions disappears after approximately 30 days under the impacts of the boundary conditions the time series of discharge in the yangtze river and xiangxi river are set as the upstream boundary conditions in 2010 the inflow discharges in the xiangxi river ranged from 7 3 to 542 6 m3 s with an average of 41 2 m3 s while the discharges in the yangtze river ranged from 5300 to 43 200 m3 s with an average of 12 600 m3 s fig s1 in the supplementary material the time series of outflow discharge in the three gorges reservoir is set as the downstream boundary condition as the inflow discharge in the yangtze river is not accurately observed the time series of water level upstream of the dam fig 4 is used to correct the inflow discharge in the yangtze river the water level fluctuated significantly within one year with a minimum of 145 m during the flood period and a maximum of 175 m in the winter in the simulation of water temperature the observed water temperature at different depths are used as the upstream boundary condition and the meteorological data obtained from china meteorological administration including atmospheric pressure air temperature humidity solar radiation and wind are also utilized the daily meteorological data is converted into hourly data required by the efdc model through linear interpolation and hourly solar radiation is obtained by assuming a specific diurnal distribution of the daily data in the water quality model the pollution loads are incorporated into the upstream boundary conditions as point sources fig 5 presents the observed values of total nitrogen and total phosphorus in the inflows of the yangtze river and xiangxi river in 2010 the total nitrogen in the yangtze river is generally higher than that in the xiangxi river while the total phosphorus in the xiangxi river is higher than that in the yangtze river as a result of the phosphorus yield from the phosphate mines and phosphate industry in the upper xiangxi river basin besides the kinetic parameters table s1 in the supplementary material in the water quality model such as maximum growth rates for algae basal metabolism rates for algae and half saturation constants for nutrient uptake are initially specified from default values and literature values cerco and cole 1994 mao et al 2015 and they are eventually identified through model calibration three scenarios are then configured to calculate the water age distributions of different water sources in the study area using the calibrated model the formulas in fig 6 represent the corresponding boundary conditions and the initial values of c t x and α t x are set to zero in scenario 1 and scenario 2 the water age distributions of upstream inflows source 1 and the intrusion flow from the mainstream source 2 in xiangxi bay are simulated in scenario 3 the water age distribution of inflows source 3 in the yangtze river is simulated the differences of these scenarios are that tracers are put at three different locations in order to characterize the flow field and calculate the water age of a certain water source 3 results 3 1 hydrodynamic calibration results the discharges and flow velocities of xiangxi bay are much lower than those of the yangtze river and this is the most significant difference between the hydrodynamics of the mainstream and the tributary the model results show that the annual average value of flow velocity is just 0 03 m s in xiangxi bay while it reaches 0 20 m s in the yangtze river according to the longitudinal gradients and variations of flow velocities xiangxi bay can be divided into four longitudinal zones including riverine zone intermediate zone lacustrine zone and mainstream influenced zone dai et al 2013 mao et al 2015 the flow velocities and velocity gradients are relatively high in the riverine zone while they are low in the intermediate and lacustrine zones in the mainstream influenced zone close to the river mouth the hydrodynamic conditions are strongly disturbed by the mainstream the predicted values of flow velocity and water temperature are compared with the observed values to examine the validity of this model figs 7 and 8 the sign of flow velocity is defined to be positive if the water flows from the yangtze river back into xiangxi bay and vice versa the mean absolute error mae and root mean squared error rmse are used to assess the average model prediction error the model is found to be able to simulate the flow velocity and water temperature with high accuracy however the predicted velocity at the bottom of sites a07 and a10 is lower than the observed one which might be due to the neglect of tributary influence in xiangxi bay and the inaccuracy of the upstream boundary conditions the predicted temperature at site a07 is slightly higher than the observed one which might result from the neglect of the spatial heterogeneity of meteorological conditions and the neglect of the heat exchange between riverbed and bottom water the hydrodynamic characteristics revealed in figs 7 and 8 differ from those of ordinary rivers high flow velocities exist at the bottom of xiangxi bay and intrusion flow from the mainstream into xiangxi bay exist near the river mouth the water temperature difference in the vertical direction is significant and this difference becomes larger in the upstream region 3 2 water quality calibration results phytoplankton play an essential role in the material cycles and energy flows in aquatic ecosystems and is closely related to water quality and algal blooms chlorophyll a chl a concentration could represent the primary production and biomass of phytoplankton and the measurement of chl a concentration is more convenient therefore chl a concentration is usually used as the indicator of eutrophication and algal blooms the biomass of cyanobacteria diatoms and green algae in the model results is converted to chl a concentration and then added up to get the total chl a concentration in order to make comparisons between the predicted and observed values since light intensity declines rapidly with water depth phytoplankton generally grow and multiply in the surface layer where chl a concentration reaches its maximum hence the analyses hereafter will mainly focus on the surface chl a concentration according to the model results the annual average and maximum of surface chl a concentration in xiangxi bay is 17 2 μg l and 108 8 μg l and the average between may and september is 32 9 μg l while the annual average in the yangtze river is only 1 4 μg l which is much lower than that of xiangxi bay the predicted and observed values of water quality variables at sites cj and a07 are compared in fig 9 where the chl a concentration is defined in the surface layer and the other variables are depth averaged in general this model has reasonably simulated the trends and distributions of water quality constituents the predicted values at site cj are in good agreement with the observed ones certain deviations exist between the predictions and observations at site a07 the predicted values of chl a concentration at site a07 are lower than the observed ones in march and april and higher than the observed ones in summer and autumn which might be due to the lack of knowledge of the optimal temperature for algal growth since phytoplankton have a preference for ammonium during photosynthesis cerco and cole 1994 the relatively high concentrations of predicted chl a in summer and autumn lead to the relatively low concentrations of predicted ammonium fig 9f in both the yangtze river and xiangxi river the total phosphorus is much higher than 0 02 mg l and the total nitrogen is much higher than 0 2 mg l which means that the nutrient concentrations exceed the thresholds for eutrophication yang et al 2010 and could satisfy the requirement for algal growth at site cj which is located near the river mouth the chl a concentration is at a low level all year round fig 9a at site a07 which is located about 20 km upstream of the river mouth the variations of chl a concentration exhibit a regular pattern with the increase of water temperature and light intensity in april and may algae begin to grow and multiply quickly consequently chl a concentration increases rapidly and reaches its maximum at the end of may chl a concentration decreases in late july because the algal growth is inhibited due to high temperature and reduction of nutrient concentrations chl a concentration reaches the local maximum in october as the water temperature falls within the optimal range for algal growth fig 9b field observations indicated that an algal bloom broke out in most parts of xiangxi bay from may 19 to june 17 2010 liu et al 2013 the longitudinal distribution of the simulated surface chl a concentration during this period is shown in fig 10 the chl a concentration is at a high level in xiangxi bay except a small area near the river mouth and the maximum is reached in the region located about 19 km upstream of the river mouth besides the severity of algal blooms in the upstream region is higher than that in the downstream region the error bars demonstrate that the variability of chl a concentration is also higher in the upstream region 3 3 potential impacts of transport process on water quality thermal stratification and density current intrusion have been observed in xiangxi bay after the impoundment of three gorges reservoir liu liu et al 2012 yang et al 2010 2013 these special hydrodynamic characteristics distinct from the hydrodynamics in the yangtze river have changed our conventional understanding of the hydrodynamics in the tributaries and are of great significance to the researches on the aquatic environment in this region the calibrated model in this study succeeds in reproducing the thermal stratification and density current figs 11 and 12 the occurrence of thermal stratification is due to two reasons a with the increase of air temperature and solar radiation the water begins to heat up and the water temperature in the surface increases faster than that in the bottom which results in the temperature difference in the vertical direction b the temperature difference leads to the density difference and the velocities and velocity gradients are relatively low in xiangxi bay this weakens the vertical mixing and stabilizes the thermal stratification the model results demonstrate that the thermal stratification in xiangxi bay emerges in mid march and becomes strong in july and august then starts to disappear in october fig s2 in the supplementary material from june 1 to june 5 the maximum temperature difference between the surface and bottom layer can reach 8 5 c and the thermal stratification is more prominent in the upstream region fig 11 the xiangxi bay has low salinity and sediment concentration of which the influences on the water density can be neglected liu et al 2013 therefore the water density is mainly influenced by water temperature the thermal stratification temperature differences of various water bodies and the variations of inflows and water level lead to the emergence and transformation of density current fig 12 shows the longitudinal profile of flow velocity in xiangxi bay during an algal bloom and the blue arrowheads represent the general directions and circulations of water flow during this period the water temperature of upstream inflows in xiangxi bay is relatively low fig 11 therefore the water has a high density and flows downstream at the bottom the water is well mixed but deep in the yangtze river and heats up more slowly which makes the water temperature fall between the surface and bottom temperature of xiangxi bay therefore the water density of the mainstream is close to the density in the middle layer of xiangxi bay driven by the hydrodynamics of the mainstream the water in the middle layer of the river mouth flows back into xiangxi bay leading to the emergence of density current intrusion and then the intrusion flow returns from the surface or bottom at a certain distance the upstream inflows of the xiangxi river flow out of the xiangxi bay along the bottom or form the water circulation in the middle and upper reaches when encountering the intrusion flow fig 12 this flow pattern is prevalent in xiangxi bay liu et al 2013 and it has greatly reduced the transport rates of substances which favors the accumulation of algal biomass and formation of algal blooms in the upstream region i e region d in fig 12 the water quality is mainly affected by the upstream inflows while in the region near the river mouth i e region a in fig 12 the water quality is mainly affected by the intrusion flow from the mainstream the simulation of water age shows that the surface water age of the yangtze river inflows source 3 in part of the mainstream from badong county to site cj about 40 km is 2 49 days on average while the surface water age of the xiangxi river inflows source 1 in xiangxi bay about 30 km is 25 80 days on average this indicates that the transport rate in the yangtze river is much faster than that in xiangxi bay fig 13 shows the longitudinal profile of water age source 1 in xiangxi bay the water age at the bottom is smaller compared to that at the upper layer because the inflows of the xiangxi river flow downstream with high velocities along the bottom the water age increases from the upstream region to the downstream region and distinct stratification exists in the vertical direction but the water age is uniformly distributed near the river mouth during an algal bloom the surface water age distribution of source 1 corresponds well with the spatial distribution of chl a concentration in xiangxi bay between site a05 and a07 fig 14 which implies that high concentration of chl a tends to exist in the water bodies with a large age in the vicinity of site a05 the water age in the right bank is larger than that in the left bank correspondingly the chl a concentration in the right bank is higher a similar pattern could also be found at site a06 water age can be used to quantify the transport rates of substances by water flow and to assess the exchange capacity and assimilative capacity of water it can influence algal biomass by influencing the specific local conditions of algae therefore it is speculated that a certain correlation can be identified between chl a concentration and water age based on the aforementioned water exchange and transport processes in xiangxi bay the correlation between the surface chl a concentration and the surface water age of the xiangxi river inflows source 1 in region d as well as the correlation between the surface chl a concentration and the surface water age of the intrusion flow source 2 in region a is quantitatively analyzed in both of the two regions chl a concentration is positively and significantly correlated with water age pearson p 0 01 namely chl a concentration increases with water age during an algal bloom fig 15 similar correlations could be found during a period without algal blooms using the same approach fig 16 it should be noted that in figs 15 and 16 the slopes of the regression lines have specific physical meaning which implies the accumulation rates of algal biomass and chl a concentration with the increment of water age the slopes can vary with time and locations and might be related to environmental factors including water temperature light intensity and nutrients the slope corresponding to source 1 is larger than that corresponding to source 2 which reveals that region d is more suitable for algal growth than region a the slope during an algal bloom is larger than that during a period without algal blooms and the reason is that the water temperature during an algal bloom is closer to the optimal temperature for algal growth statistical analysis of correlation between the slopes and environmental factors indicates that the slopes are mainly influenced by water temperature and the following empirical formulas have been obtained eqs 4 and 5 are applicable to region d and region a respectively chl a denotes the surface chl a concentration unit μg l t denotes the water temperature unit c wa 1 and wa 2 denote the surface water age unit day of source 1 and source 2 c 1 and c 2 denote the inflow values of chl a concentration unit μg l when the water age equals zero and they are related to the water quality of water sources in this study c 1 or c 2 is generally not more than 10 μg l these empirical formulas could then be used to estimate the surface chl a concentration in xiangxi bay and they are suitable for different hydrological years as long as the dominant groups of algae remain unchanged but it would be better to verify their validity using a calibrated model before they are applied to other cases 4 chl a 0 106 t 2 5 406 t 65 55 w a 1 c 1 21 c t 30 c 5 chl a 0 059 t 2 3 009 t 36 81 w a 2 c 2 21 c t 30 c 3 4 effects of water level fluctuation on water quality reducing pollution loads is the most effective measure to control eutrophication and algal blooms however it is hard to be achieved in the short term because of the large watershed area and excessive pollutant emissions in the three gorges reservoir region some researchers have suggested changing the hydrodynamic characteristics by reservoir operation and water level fluctuation in order to prevent the algal blooms in the tributaries of three gorges reservoir ji et al 2017 sha et al 2015 yang et al 2013 zheng et al 2011 such a measure is considered to be eco friendly and feasible and has attracted much attention here a period from may 20 to june 4 with high concentrations of chl a is selected for simulation and analysis the water level increases from 153 66 m to 155 66 m within 5 days and then decreases from 155 66 m to 148 81 m within 10 days fig 17 the effects of water level fluctuation on the water age and chl a concentration in xiangxi bay are analyzed by comparing the model results with and without water level fluctuation fig 18 presents the changes of surface chl a concentration and water age caused by water level fluctuation in xiangxi bay and the term differences refers to the values under the condition of water level fluctuation subtracted by the original values without water level fluctuation influenced by water level fluctuation the surface chl a concentration decreases slightly in region a while an increase of surface chl a concentration is observed in region d this can be explained by the conclusions in section 3 3 along with the changes of water age a decrease in surface water age of source 2 leads to the decrease of chl a concentration in region a likewise an increase in surface water age of source 1 results in the increase of chl a concentration in region d the average chl a concentration in xiangxi bay is reduced by 1 74 μg l as a result of water level fluctuation there is a decrease of chl a concentration in xiangxi bay except a small part of the upstream region where there is an increase of chl a concentration fig 19 therefore such type of water level fluctuation has both advantages and disadvantages in preventing algal blooms the optimal operational strategy still remains to be explored and this measure might need to be adopted in combination with other restoration measures 4 discussion in the efdc water quality module the following equation is used to represent the effects of nutrient availability light intensity and ambient temperature on algal growth in eq 6 p denotes the actual growth rate unit day 1 pm denotes the maximum growth rate under optimal conditions unit day 1 f 1 n f 2 i and f 3 t denote limiting factors of nutrients light intensity and ambient temperature respectively and these factors are within the range of 0 1 6 p p m f 1 n f 2 i f 3 t to have a better understanding of the key factors influencing the algal biomass and algal bloom dynamics in the three gorges reservoir region the time variable limiting factors of algal growth in 2010 are analyzed fig 20 firstly the nitrogen and phosphorus limiting factors were close to 1 throughout the year implying that nutrient availability did not limit the algal growth in the study area which is consistent with previous studies liu liu et al 2012 xu et al 2010 secondly light intensity was also not a constraint to algal growth in this case the light limitation was reduced at site a07 from april to october only because the high concentrations of chl a fig 9b increased the total light attenuation coefficient and thus decreased the available light thirdly water temperature was important for algal growth both in the yangtze river and xiangxi bay and it mainly affected the annual variations of algal biomass and chl a concentration water temperature could determine the period suitable for formation of algal blooms but it could not fully explain the actual occurrence of algal blooms for example the temperature was in favor of algal growth from june to october in the yangtze river fig 20a but the chl a concentration did not exceed 3 μg l fig 9a and no algal bloom occurred based on the analysis in section 3 3 water age was another important factor that could significantly influence algal biomass although water age does not affect algal growth directly the transport process characterized by water age here can change the positions of algae via advection and diffusion and then change the surrounding environments where algae live it is water age that determines whether the local environmental conditions of a certain region are suitable for the accumulation of algal biomass and formation of algal blooms such indirect effect can be significant especially in xiangxi bay therefore it can be concluded that the key factors influencing algal biomass and algal bloom dynamics in the three gorges reservoir region are water age and water temperature which is also presented in eqs 4 and 5 now the three questions put forward in section 1 can be answered by synthesizing the results and analyses a the reason that algal blooms occurred mostly in the tributaries but not in the yangtze river lies in the significant differences of transport process and water age distribution in the yangtze river and its tributaries in the yangtze river although the water temperature was suitable for algal growth from june to october the water flow with high transport rates and low water age could transport algal cells to the downstream region quickly thus prohibiting the accumulation of algal biomass while in xiangxi bay not only the low flow velocities but also the encounter of the upstream inflows with the intrusion flow caused a rapid increase in water age which favored the accumulation of algal biomass under this condition algal blooms tend to occur with an appropriate water temperature b water age can be a good indicator quantifying the transport process and characterizing the hydrodynamic differences in the yangtze river and its tributaries the great difference of water age indicates that the transport rate in the yangtze river is much faster than that in xiangxi bay besides the water ages of different water sources source 1 and source 2 have been used to identify the special hydrodynamics in xiangxi bay c using linear regression analysis a significant positive correlation has been identified between the surface chl a concentration and water age and two empirical formulas that relate chl a concentration to water temperature and water age have been established the concept of water age can interpret the spatial distribution of chl a concentration and the susceptibility of a certain region to algal blooms due to the special hydrodynamics in xiangxi bay algal biomass and algal blooms are mainly affected by upstream inflows in the upper reach i e region d in fig 12 while they are mainly affected by the intrusion flow from the mainstream near the river mouth i e region a in fig 12 in both of the two regions surface chl a concentration increases with water age and reaches its maximum at the confluence the maximum value appears about 19 km upstream of the river mouth according to fig 10 and this position is consistent with the confluence position in fig 12 5 conclusions to investigate the main causes and key factors of algal blooms that frequently occurred after the impoundment of three gorges reservoir a numerical simulation of the three dimensional hydrodynamics and water quality in the yangtze river and xiangxi bay is conducted using the efdc model the model results have successfully reproduced the special hydrodynamic characteristics including thermal stratification and density current in xiangxi bay and the model results show good agreement with field observations the main findings of this research are as follows 1 the special flow pattern and transport process in xiangxi bay imply that the effects of upstream inflows and intrusion flow from the yangtze river on algal biomass and algal blooms should be analyzed separately and both effects can be quantified by significant positive correlations between surface chlorophyll a concentration and water age 2 water age and water temperature are the key factors that influence algal biomass and algal bloom dynamics in the three gorges reservoir region the surface chlorophyll a concentration in xiangxi bay can be estimated using these two factors 3 water temperature affects the temporal variations of algal biomass and chlorophyll a concentration while the transport process and water age distribution determine that xiangxi bay rather than the yangtze river is susceptible to algal blooms 4 water level fluctuation generated by reservoir operation can slightly reduce algal biomass and alleviate algal blooms but the optimal operational strategy that takes account of flood control electricity generation and water supply needs to be further explored this study provides a new way to quantitatively analyze the effects of hydrodynamics on the water quality by linking water age and phytoplankton levels moreover the model and the method adopted in this study could provide a new perspective on understanding the physical and biogeochemical processes in similar reservoirs and lakes acknowledgments mr qifeng gao and dr guojian he contributed equally to this work this investigation was supported by the national natural science foundation of china no 91647210 111 project no b18031 national key research and development program of china no 2016yfc0402506 and open research fund program of state key laboratory of hydroscience and engineering sklhse 2018 b 02 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2018 09 033 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
6956,after the impoundment of three gorges reservoir algal blooms frequently occurred in the tributaries of the reservoir which has posed a great challenge for the local aquatic environment and ecology to investigate the main causes and key factors of the algal blooms the environmental fluid dynamics code efdc model is applied to the simulation of the three dimensional hydrodynamics and water quality in the yangtze river and xiangxi bay and the concept of water age is adopted to quantitatively analyze the effects of hydrodynamics on the water quality by linking water age and phytoplankton levels which has seldom been explored in previous studies the model results show good agreement with the field data and the simulation reproduces the thermal stratification and density current in xiangxi bay the results show that xiangxi bay exhibits quite complicated hydrodynamic characteristics and could be divided into different zones according to the transport process in the upper reach the water quality is mainly affected by the upstream inflows while it is mainly affected by the intrusion flow from the mainstream near the river mouth water age and water temperature are found to be the key factors influencing the algal blooms in xiangxi bay besides a significant positive correlation has been found between the chlorophyll a chl a concentration in the surface layer and the water age of the dominant water source this conclusion can be adopted to interpret the longitudinal distribution of chl a concentration and to explain why xiangxi bay is susceptible to algal blooms the correlation between water age and chl a concentration is further used to evaluate the effectiveness of water level fluctuation in preventing algal blooms the analyses and findings in this study could help to better understand the complicated hydrodynamic and water quality processes in xiangxi bay following the impoundment and provide insights into ecological and environmental management of three gorges reservoir keywords eutrophication three gorges reservoir numerical simulation water age transport process chlorophyll a concentration 1 introduction along with economic development and human activities eutrophication and algal blooms have threatened many rivers lakes and reservoirs accumulation of nutrients and outbreaks of algal blooms can threaten drinking water supplies public health and the sustainability of ecosystems anderson et al 2002 chen et al 2016 sulcius et al 2017 stone 2011 as the largest hydropower project all over the world the three gorges project has brought remarkable benefits including flood control electricity generation and shipping capacity improvement but it has also changed the environmental conditions of natural rivers after the impoundment of three gorges reservoir in 2003 algal blooms occurred in the daning river shennong stream meixi river xiaojiang river and many other tributaries of the reservoir fu et al 2010 ministry of environmental protection of china mepc 2014 yang et al 2013 which has caused negative ecological and environmental impacts researching on the formation and mechanism of algal blooms in the three gorges reservoir region can help to understand the status of water quality in this region and to propose effective countermeasures to control the algal blooms and improve the ecological environment physical and biogeochemical processes are crucial to water quality and aquatic ecosystems algal blooms are also controlled by these two processes and are mainly influenced by light intensity water temperature nutrients and hydrodynamic characteristics anderson et al 2002 jones and poplawski 1998 merel et al 2013 previous studies have taken these factors into account when investigating the possible causes of algal blooms and the dynamics of phytoplankton community structure in the tributaries of three gorges reservoir dai et al 2013 liu liu et al 2012 wang et al 2011 ye et al 2007 zeng et al 2006 moreover preliminary conclusions have been obtained stating that outbreaks of algal blooms result from a combination of various factors the changes of nutrient concentrations light intensity and temperature in the yangtze river and its tributaries before and after the impoundment are negligible whereas the significant change of hydrodynamic characteristics is probably the main cause of algal blooms liu liu et al 2012 liu yang et al 2016 zeng et al 2007 however the following questions remain to be answered a why did algal blooms occur mostly in the tributaries but not in the mainstream b how can the hydrodynamic conditions and their differences in the mainstream and tributaries be characterized quantitatively or what indicator can be used to represent the hydrodynamic conditions c how can the effects of hydrodynamics on the water quality and algal blooms be analyzed quantitatively to answer these questions the concept of water age is adopted in this study the dissolved and suspended substances and living organisms in the hydrosphere are transported by water flow and it takes a certain time to transport these constituents from one specific location to another which mainly depends on the hydrodynamic conditions therefore transport timescales such as water age residence time and flushing time can be used to quantify the water exchange and transport processes and to assess the assimilative capacity of water water age is defined as the time elapsed since the water parcel under consideration left the region where its age is prescribed to be zero zimmerman 1976 delhez et al 1999 the concept of water age can characterize the temporal and spatial variations of water transport process and has been widely applied to lakes estuaries oceans and other semi enclosed water bodies delhez and deleersnijder 2002 gourgue et al 2007 karna and baptista 2016 ren et al 2014 shen and haas 2004 compared with other timescales water age is time and location dependent and its spatial and temporal distributions are easier to be obtained in practice besides water age can indicate the transport process of different water sources when different boundary conditions are set up a few researchers have investigated the relationships between water quality and transport timescales lucas et al 2009 qi et al 2016 zhang et al 2016 as the balance between phytoplankton growth and loss changes various relationships between phytoplankton biomass and transport time may be observed lucas et al 2009 qi et al 2016 simulated the distribution of water age under different hydrological conditions in poyang lake and found similar patterns of water age and chlorophyll a concentration in their spatial distributions however the quantitative relation between water quality and water age has seldom been reported in previous studies the objectives of this study are to find a suitable indicator to characterize the significant differences of hydrodynamic conditions in the yangtze river and its tributaries and to quantitatively analyze the effects of hydrodynamics on the water quality and algal blooms using this indicator i e water age in our study more importantly the key factors that influence algal bloom dynamics in the three gorges reservoir region are to be identified the environmental fluid dynamics code efdc model is applied to simulate the hydrodynamics and water quality in the yangtze river and xiangxi bay and to identify the temporal and spatial distribution of water age the quantitative relation between surface chl a concentration and water age is then discussed and the effectiveness of water level fluctuation in water quality restoration is also evaluated 2 materials and methods 2 1 study area three gorges reservoir an artificial lake created by the construction of three gorges dam in the upper reach of the yangtze river has a surface area of approximately 1084 km2 and a total storage capacity of 39 3 billion m3 at the normal water level of 175 m the three gorges reservoir region has a humid subtropical climate with an average annual temperature of 17 6 c average annual precipitation of 1122 5 mm and average annual wind speed of 1 3 m s mepc 2014 the rapid development of the economy and growth of population along the yangtze river have resulted in the increase of pollutant emissions the concentration of nutrients primarily nitrogen and phosphorus in the water before and after the impoundment was always high and far beyond the thresholds for eutrophication total phosphorus 0 02 mg l total nitrogen 0 2 mg l yang et al 2010 however no algal bloom was reported prior to the impoundment of three gorges reservoir nevertheless during the impoundment in 2003 algal bloom occurred in the daning river for the first time and various algal blooms in the tributaries were recorded after that from 2003 to 2013 the number of tributaries subjected to algal blooms fluctuated with a rising trend fig 1 and the areas affected by algal blooms gradually extended to the upstream of three gorges reservoir as the water level rose over the past few years the algal blooms in the tributaries have become a prominent problem the xiangxi river is located in hubei province with a length of 94 km it flows south into the yangtze river and the river mouth is about 34 5 km upstream of the dam the total area of the xiangxi river basin 110 25 111 06 e 30 57 31 34 n is about 3099 km2 after the impoundment a backwater zone called xiangxi bay 25 40 km in length formed in the xiangxi river and the flow velocity therein was quite low which was suitable for algal growth algal blooms of different intensity occurred in xiangxi bay almost every year and a severe cyanobacterial bloom broke out during the summer of 2008 in this study the computational domain fig 2 includes the 70 km river reach in the yangtze river from badong county to the three gorges dam and the 30 km river reach in the xiangxi river from gaoyang town to the river mouth ten sampling sites a01 a10 in the xiangxi river and one sampling site cj in the yangtze river were set up to monitor the flow velocity water temperature and water quality variables 2 2 model description the environmental fluid dynamics code efdc model developed by hamrick 1992 is capable of simulating one two or three dimensional water flow sediment transport and water quality and has been applied to a wide range of studies on rivers lakes reservoirs and estuaries bai and lung 2005 gong et al 2016 he et al 2011 ji et al 2002 jin et al 2000 wang et al 2010 the efdc model uses cartesian or curvilinear orthogonal horizontal coordinates and a sigma vertical coordinate the hydrodynamic model consists of continuity equation momentum equations state equation and transport equations for salinity and temperature and the mellor yamada level 2 5 turbulence closure scheme mellor and yamada 1982 galperin et al 1988 is implemented to calculate the vertical turbulent viscosity and diffusivity the water quality module in efdc driven by the hydrodynamic model centers on the primary production by algae and the concentration of dissolved oxygen in the framework of the water quality module fig 3 which contains 22 state variables algae utilize inorganic nutrients and produce oxygen through photosynthesis and consume dissolved oxygen and release organic matter through metabolism organic carbon undergoes numerous transformations and consumes dissolved oxygen organic nitrogen and organic phosphorus are converted to inorganic forms via hydrolysis and mineralization more details can be found in park et al 1995 2 3 simulation of water age water age can be calculated using eulerian models delhez et al 1999 deleersnijder et al 2001 or lagrangian models chen 2007 liu et al 2011 deleersnijder et al 2001 put forward the constituent oriented age and residence time theory cart which has been extensively applied to numerical simulation of water age delhez and deleersnijder 2002 gourgue et al 2007 karna and baptista 2016 ren et al 2014 shen and haas 2004 in this theory the tracer concentration and age concentration are calculated by solving the advection diffusion reaction equations 1 c t x t u c t x k c t x 0 2 α t x t u α t x k α t x c t x where the tracer concentration c t x and age concentration α t x are functions of time t and location x u denotes the velocity vector k is the diffusivity tensor water age a t x can then be obtained as follows 3 a t x α t x c t x 2 4 model configuration the curvilinear and orthogonal horizontal coordinates are used in this study to better fit the river boundary the computational domain in fig 2 is divided into 742 grid cells with a local mesh refinement near the river mouth the grid sizes vary from 35 m to 580 m in the i direction and 170 m to 1900 m in the j direction in the vertical direction 10 uniform layers are deployed in the sigma coordinate the simulation period is from january to december in 2010 and the model time step is set to a constant of 6 0 s the initial conditions including water level and water temperature are specified as constant values the influence of the initial conditions disappears after approximately 30 days under the impacts of the boundary conditions the time series of discharge in the yangtze river and xiangxi river are set as the upstream boundary conditions in 2010 the inflow discharges in the xiangxi river ranged from 7 3 to 542 6 m3 s with an average of 41 2 m3 s while the discharges in the yangtze river ranged from 5300 to 43 200 m3 s with an average of 12 600 m3 s fig s1 in the supplementary material the time series of outflow discharge in the three gorges reservoir is set as the downstream boundary condition as the inflow discharge in the yangtze river is not accurately observed the time series of water level upstream of the dam fig 4 is used to correct the inflow discharge in the yangtze river the water level fluctuated significantly within one year with a minimum of 145 m during the flood period and a maximum of 175 m in the winter in the simulation of water temperature the observed water temperature at different depths are used as the upstream boundary condition and the meteorological data obtained from china meteorological administration including atmospheric pressure air temperature humidity solar radiation and wind are also utilized the daily meteorological data is converted into hourly data required by the efdc model through linear interpolation and hourly solar radiation is obtained by assuming a specific diurnal distribution of the daily data in the water quality model the pollution loads are incorporated into the upstream boundary conditions as point sources fig 5 presents the observed values of total nitrogen and total phosphorus in the inflows of the yangtze river and xiangxi river in 2010 the total nitrogen in the yangtze river is generally higher than that in the xiangxi river while the total phosphorus in the xiangxi river is higher than that in the yangtze river as a result of the phosphorus yield from the phosphate mines and phosphate industry in the upper xiangxi river basin besides the kinetic parameters table s1 in the supplementary material in the water quality model such as maximum growth rates for algae basal metabolism rates for algae and half saturation constants for nutrient uptake are initially specified from default values and literature values cerco and cole 1994 mao et al 2015 and they are eventually identified through model calibration three scenarios are then configured to calculate the water age distributions of different water sources in the study area using the calibrated model the formulas in fig 6 represent the corresponding boundary conditions and the initial values of c t x and α t x are set to zero in scenario 1 and scenario 2 the water age distributions of upstream inflows source 1 and the intrusion flow from the mainstream source 2 in xiangxi bay are simulated in scenario 3 the water age distribution of inflows source 3 in the yangtze river is simulated the differences of these scenarios are that tracers are put at three different locations in order to characterize the flow field and calculate the water age of a certain water source 3 results 3 1 hydrodynamic calibration results the discharges and flow velocities of xiangxi bay are much lower than those of the yangtze river and this is the most significant difference between the hydrodynamics of the mainstream and the tributary the model results show that the annual average value of flow velocity is just 0 03 m s in xiangxi bay while it reaches 0 20 m s in the yangtze river according to the longitudinal gradients and variations of flow velocities xiangxi bay can be divided into four longitudinal zones including riverine zone intermediate zone lacustrine zone and mainstream influenced zone dai et al 2013 mao et al 2015 the flow velocities and velocity gradients are relatively high in the riverine zone while they are low in the intermediate and lacustrine zones in the mainstream influenced zone close to the river mouth the hydrodynamic conditions are strongly disturbed by the mainstream the predicted values of flow velocity and water temperature are compared with the observed values to examine the validity of this model figs 7 and 8 the sign of flow velocity is defined to be positive if the water flows from the yangtze river back into xiangxi bay and vice versa the mean absolute error mae and root mean squared error rmse are used to assess the average model prediction error the model is found to be able to simulate the flow velocity and water temperature with high accuracy however the predicted velocity at the bottom of sites a07 and a10 is lower than the observed one which might be due to the neglect of tributary influence in xiangxi bay and the inaccuracy of the upstream boundary conditions the predicted temperature at site a07 is slightly higher than the observed one which might result from the neglect of the spatial heterogeneity of meteorological conditions and the neglect of the heat exchange between riverbed and bottom water the hydrodynamic characteristics revealed in figs 7 and 8 differ from those of ordinary rivers high flow velocities exist at the bottom of xiangxi bay and intrusion flow from the mainstream into xiangxi bay exist near the river mouth the water temperature difference in the vertical direction is significant and this difference becomes larger in the upstream region 3 2 water quality calibration results phytoplankton play an essential role in the material cycles and energy flows in aquatic ecosystems and is closely related to water quality and algal blooms chlorophyll a chl a concentration could represent the primary production and biomass of phytoplankton and the measurement of chl a concentration is more convenient therefore chl a concentration is usually used as the indicator of eutrophication and algal blooms the biomass of cyanobacteria diatoms and green algae in the model results is converted to chl a concentration and then added up to get the total chl a concentration in order to make comparisons between the predicted and observed values since light intensity declines rapidly with water depth phytoplankton generally grow and multiply in the surface layer where chl a concentration reaches its maximum hence the analyses hereafter will mainly focus on the surface chl a concentration according to the model results the annual average and maximum of surface chl a concentration in xiangxi bay is 17 2 μg l and 108 8 μg l and the average between may and september is 32 9 μg l while the annual average in the yangtze river is only 1 4 μg l which is much lower than that of xiangxi bay the predicted and observed values of water quality variables at sites cj and a07 are compared in fig 9 where the chl a concentration is defined in the surface layer and the other variables are depth averaged in general this model has reasonably simulated the trends and distributions of water quality constituents the predicted values at site cj are in good agreement with the observed ones certain deviations exist between the predictions and observations at site a07 the predicted values of chl a concentration at site a07 are lower than the observed ones in march and april and higher than the observed ones in summer and autumn which might be due to the lack of knowledge of the optimal temperature for algal growth since phytoplankton have a preference for ammonium during photosynthesis cerco and cole 1994 the relatively high concentrations of predicted chl a in summer and autumn lead to the relatively low concentrations of predicted ammonium fig 9f in both the yangtze river and xiangxi river the total phosphorus is much higher than 0 02 mg l and the total nitrogen is much higher than 0 2 mg l which means that the nutrient concentrations exceed the thresholds for eutrophication yang et al 2010 and could satisfy the requirement for algal growth at site cj which is located near the river mouth the chl a concentration is at a low level all year round fig 9a at site a07 which is located about 20 km upstream of the river mouth the variations of chl a concentration exhibit a regular pattern with the increase of water temperature and light intensity in april and may algae begin to grow and multiply quickly consequently chl a concentration increases rapidly and reaches its maximum at the end of may chl a concentration decreases in late july because the algal growth is inhibited due to high temperature and reduction of nutrient concentrations chl a concentration reaches the local maximum in october as the water temperature falls within the optimal range for algal growth fig 9b field observations indicated that an algal bloom broke out in most parts of xiangxi bay from may 19 to june 17 2010 liu et al 2013 the longitudinal distribution of the simulated surface chl a concentration during this period is shown in fig 10 the chl a concentration is at a high level in xiangxi bay except a small area near the river mouth and the maximum is reached in the region located about 19 km upstream of the river mouth besides the severity of algal blooms in the upstream region is higher than that in the downstream region the error bars demonstrate that the variability of chl a concentration is also higher in the upstream region 3 3 potential impacts of transport process on water quality thermal stratification and density current intrusion have been observed in xiangxi bay after the impoundment of three gorges reservoir liu liu et al 2012 yang et al 2010 2013 these special hydrodynamic characteristics distinct from the hydrodynamics in the yangtze river have changed our conventional understanding of the hydrodynamics in the tributaries and are of great significance to the researches on the aquatic environment in this region the calibrated model in this study succeeds in reproducing the thermal stratification and density current figs 11 and 12 the occurrence of thermal stratification is due to two reasons a with the increase of air temperature and solar radiation the water begins to heat up and the water temperature in the surface increases faster than that in the bottom which results in the temperature difference in the vertical direction b the temperature difference leads to the density difference and the velocities and velocity gradients are relatively low in xiangxi bay this weakens the vertical mixing and stabilizes the thermal stratification the model results demonstrate that the thermal stratification in xiangxi bay emerges in mid march and becomes strong in july and august then starts to disappear in october fig s2 in the supplementary material from june 1 to june 5 the maximum temperature difference between the surface and bottom layer can reach 8 5 c and the thermal stratification is more prominent in the upstream region fig 11 the xiangxi bay has low salinity and sediment concentration of which the influences on the water density can be neglected liu et al 2013 therefore the water density is mainly influenced by water temperature the thermal stratification temperature differences of various water bodies and the variations of inflows and water level lead to the emergence and transformation of density current fig 12 shows the longitudinal profile of flow velocity in xiangxi bay during an algal bloom and the blue arrowheads represent the general directions and circulations of water flow during this period the water temperature of upstream inflows in xiangxi bay is relatively low fig 11 therefore the water has a high density and flows downstream at the bottom the water is well mixed but deep in the yangtze river and heats up more slowly which makes the water temperature fall between the surface and bottom temperature of xiangxi bay therefore the water density of the mainstream is close to the density in the middle layer of xiangxi bay driven by the hydrodynamics of the mainstream the water in the middle layer of the river mouth flows back into xiangxi bay leading to the emergence of density current intrusion and then the intrusion flow returns from the surface or bottom at a certain distance the upstream inflows of the xiangxi river flow out of the xiangxi bay along the bottom or form the water circulation in the middle and upper reaches when encountering the intrusion flow fig 12 this flow pattern is prevalent in xiangxi bay liu et al 2013 and it has greatly reduced the transport rates of substances which favors the accumulation of algal biomass and formation of algal blooms in the upstream region i e region d in fig 12 the water quality is mainly affected by the upstream inflows while in the region near the river mouth i e region a in fig 12 the water quality is mainly affected by the intrusion flow from the mainstream the simulation of water age shows that the surface water age of the yangtze river inflows source 3 in part of the mainstream from badong county to site cj about 40 km is 2 49 days on average while the surface water age of the xiangxi river inflows source 1 in xiangxi bay about 30 km is 25 80 days on average this indicates that the transport rate in the yangtze river is much faster than that in xiangxi bay fig 13 shows the longitudinal profile of water age source 1 in xiangxi bay the water age at the bottom is smaller compared to that at the upper layer because the inflows of the xiangxi river flow downstream with high velocities along the bottom the water age increases from the upstream region to the downstream region and distinct stratification exists in the vertical direction but the water age is uniformly distributed near the river mouth during an algal bloom the surface water age distribution of source 1 corresponds well with the spatial distribution of chl a concentration in xiangxi bay between site a05 and a07 fig 14 which implies that high concentration of chl a tends to exist in the water bodies with a large age in the vicinity of site a05 the water age in the right bank is larger than that in the left bank correspondingly the chl a concentration in the right bank is higher a similar pattern could also be found at site a06 water age can be used to quantify the transport rates of substances by water flow and to assess the exchange capacity and assimilative capacity of water it can influence algal biomass by influencing the specific local conditions of algae therefore it is speculated that a certain correlation can be identified between chl a concentration and water age based on the aforementioned water exchange and transport processes in xiangxi bay the correlation between the surface chl a concentration and the surface water age of the xiangxi river inflows source 1 in region d as well as the correlation between the surface chl a concentration and the surface water age of the intrusion flow source 2 in region a is quantitatively analyzed in both of the two regions chl a concentration is positively and significantly correlated with water age pearson p 0 01 namely chl a concentration increases with water age during an algal bloom fig 15 similar correlations could be found during a period without algal blooms using the same approach fig 16 it should be noted that in figs 15 and 16 the slopes of the regression lines have specific physical meaning which implies the accumulation rates of algal biomass and chl a concentration with the increment of water age the slopes can vary with time and locations and might be related to environmental factors including water temperature light intensity and nutrients the slope corresponding to source 1 is larger than that corresponding to source 2 which reveals that region d is more suitable for algal growth than region a the slope during an algal bloom is larger than that during a period without algal blooms and the reason is that the water temperature during an algal bloom is closer to the optimal temperature for algal growth statistical analysis of correlation between the slopes and environmental factors indicates that the slopes are mainly influenced by water temperature and the following empirical formulas have been obtained eqs 4 and 5 are applicable to region d and region a respectively chl a denotes the surface chl a concentration unit μg l t denotes the water temperature unit c wa 1 and wa 2 denote the surface water age unit day of source 1 and source 2 c 1 and c 2 denote the inflow values of chl a concentration unit μg l when the water age equals zero and they are related to the water quality of water sources in this study c 1 or c 2 is generally not more than 10 μg l these empirical formulas could then be used to estimate the surface chl a concentration in xiangxi bay and they are suitable for different hydrological years as long as the dominant groups of algae remain unchanged but it would be better to verify their validity using a calibrated model before they are applied to other cases 4 chl a 0 106 t 2 5 406 t 65 55 w a 1 c 1 21 c t 30 c 5 chl a 0 059 t 2 3 009 t 36 81 w a 2 c 2 21 c t 30 c 3 4 effects of water level fluctuation on water quality reducing pollution loads is the most effective measure to control eutrophication and algal blooms however it is hard to be achieved in the short term because of the large watershed area and excessive pollutant emissions in the three gorges reservoir region some researchers have suggested changing the hydrodynamic characteristics by reservoir operation and water level fluctuation in order to prevent the algal blooms in the tributaries of three gorges reservoir ji et al 2017 sha et al 2015 yang et al 2013 zheng et al 2011 such a measure is considered to be eco friendly and feasible and has attracted much attention here a period from may 20 to june 4 with high concentrations of chl a is selected for simulation and analysis the water level increases from 153 66 m to 155 66 m within 5 days and then decreases from 155 66 m to 148 81 m within 10 days fig 17 the effects of water level fluctuation on the water age and chl a concentration in xiangxi bay are analyzed by comparing the model results with and without water level fluctuation fig 18 presents the changes of surface chl a concentration and water age caused by water level fluctuation in xiangxi bay and the term differences refers to the values under the condition of water level fluctuation subtracted by the original values without water level fluctuation influenced by water level fluctuation the surface chl a concentration decreases slightly in region a while an increase of surface chl a concentration is observed in region d this can be explained by the conclusions in section 3 3 along with the changes of water age a decrease in surface water age of source 2 leads to the decrease of chl a concentration in region a likewise an increase in surface water age of source 1 results in the increase of chl a concentration in region d the average chl a concentration in xiangxi bay is reduced by 1 74 μg l as a result of water level fluctuation there is a decrease of chl a concentration in xiangxi bay except a small part of the upstream region where there is an increase of chl a concentration fig 19 therefore such type of water level fluctuation has both advantages and disadvantages in preventing algal blooms the optimal operational strategy still remains to be explored and this measure might need to be adopted in combination with other restoration measures 4 discussion in the efdc water quality module the following equation is used to represent the effects of nutrient availability light intensity and ambient temperature on algal growth in eq 6 p denotes the actual growth rate unit day 1 pm denotes the maximum growth rate under optimal conditions unit day 1 f 1 n f 2 i and f 3 t denote limiting factors of nutrients light intensity and ambient temperature respectively and these factors are within the range of 0 1 6 p p m f 1 n f 2 i f 3 t to have a better understanding of the key factors influencing the algal biomass and algal bloom dynamics in the three gorges reservoir region the time variable limiting factors of algal growth in 2010 are analyzed fig 20 firstly the nitrogen and phosphorus limiting factors were close to 1 throughout the year implying that nutrient availability did not limit the algal growth in the study area which is consistent with previous studies liu liu et al 2012 xu et al 2010 secondly light intensity was also not a constraint to algal growth in this case the light limitation was reduced at site a07 from april to october only because the high concentrations of chl a fig 9b increased the total light attenuation coefficient and thus decreased the available light thirdly water temperature was important for algal growth both in the yangtze river and xiangxi bay and it mainly affected the annual variations of algal biomass and chl a concentration water temperature could determine the period suitable for formation of algal blooms but it could not fully explain the actual occurrence of algal blooms for example the temperature was in favor of algal growth from june to october in the yangtze river fig 20a but the chl a concentration did not exceed 3 μg l fig 9a and no algal bloom occurred based on the analysis in section 3 3 water age was another important factor that could significantly influence algal biomass although water age does not affect algal growth directly the transport process characterized by water age here can change the positions of algae via advection and diffusion and then change the surrounding environments where algae live it is water age that determines whether the local environmental conditions of a certain region are suitable for the accumulation of algal biomass and formation of algal blooms such indirect effect can be significant especially in xiangxi bay therefore it can be concluded that the key factors influencing algal biomass and algal bloom dynamics in the three gorges reservoir region are water age and water temperature which is also presented in eqs 4 and 5 now the three questions put forward in section 1 can be answered by synthesizing the results and analyses a the reason that algal blooms occurred mostly in the tributaries but not in the yangtze river lies in the significant differences of transport process and water age distribution in the yangtze river and its tributaries in the yangtze river although the water temperature was suitable for algal growth from june to october the water flow with high transport rates and low water age could transport algal cells to the downstream region quickly thus prohibiting the accumulation of algal biomass while in xiangxi bay not only the low flow velocities but also the encounter of the upstream inflows with the intrusion flow caused a rapid increase in water age which favored the accumulation of algal biomass under this condition algal blooms tend to occur with an appropriate water temperature b water age can be a good indicator quantifying the transport process and characterizing the hydrodynamic differences in the yangtze river and its tributaries the great difference of water age indicates that the transport rate in the yangtze river is much faster than that in xiangxi bay besides the water ages of different water sources source 1 and source 2 have been used to identify the special hydrodynamics in xiangxi bay c using linear regression analysis a significant positive correlation has been identified between the surface chl a concentration and water age and two empirical formulas that relate chl a concentration to water temperature and water age have been established the concept of water age can interpret the spatial distribution of chl a concentration and the susceptibility of a certain region to algal blooms due to the special hydrodynamics in xiangxi bay algal biomass and algal blooms are mainly affected by upstream inflows in the upper reach i e region d in fig 12 while they are mainly affected by the intrusion flow from the mainstream near the river mouth i e region a in fig 12 in both of the two regions surface chl a concentration increases with water age and reaches its maximum at the confluence the maximum value appears about 19 km upstream of the river mouth according to fig 10 and this position is consistent with the confluence position in fig 12 5 conclusions to investigate the main causes and key factors of algal blooms that frequently occurred after the impoundment of three gorges reservoir a numerical simulation of the three dimensional hydrodynamics and water quality in the yangtze river and xiangxi bay is conducted using the efdc model the model results have successfully reproduced the special hydrodynamic characteristics including thermal stratification and density current in xiangxi bay and the model results show good agreement with field observations the main findings of this research are as follows 1 the special flow pattern and transport process in xiangxi bay imply that the effects of upstream inflows and intrusion flow from the yangtze river on algal biomass and algal blooms should be analyzed separately and both effects can be quantified by significant positive correlations between surface chlorophyll a concentration and water age 2 water age and water temperature are the key factors that influence algal biomass and algal bloom dynamics in the three gorges reservoir region the surface chlorophyll a concentration in xiangxi bay can be estimated using these two factors 3 water temperature affects the temporal variations of algal biomass and chlorophyll a concentration while the transport process and water age distribution determine that xiangxi bay rather than the yangtze river is susceptible to algal blooms 4 water level fluctuation generated by reservoir operation can slightly reduce algal biomass and alleviate algal blooms but the optimal operational strategy that takes account of flood control electricity generation and water supply needs to be further explored this study provides a new way to quantitatively analyze the effects of hydrodynamics on the water quality by linking water age and phytoplankton levels moreover the model and the method adopted in this study could provide a new perspective on understanding the physical and biogeochemical processes in similar reservoirs and lakes acknowledgments mr qifeng gao and dr guojian he contributed equally to this work this investigation was supported by the national natural science foundation of china no 91647210 111 project no b18031 national key research and development program of china no 2016yfc0402506 and open research fund program of state key laboratory of hydroscience and engineering sklhse 2018 b 02 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2018 09 033 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
6957,hysteresis is a widely reported phenomenon in natural and engineered systems across different temporal and spatial scales its definition is non unique and rather context dependent while systems with hysteretic behavior including hydrological systems are commonly referred to as path dependent systems or systems with memory despite widespread existence of hysteretic processes the current generation of hydrologic models do not directly account for hysteresis in this paper we review the fundamentals theories and general properties of hysteresis in the broad scientific literature and then focus on its representations in hydrological sciences through illustrative examples we show how an incomplete understanding or representation of the underlying processes in a system can lead to considering the system as being path dependent we argue that in most cases hysteresis is a manifestation of our dimensionality reducing approach to process understanding and representation we further explain that modelling hysteresis in an ideal world requires a full dimensional process representation based on a perfect understanding of the processes their heterogeneity and their spatio temporal scale dependency we discuss however that the missing dimensions physics in a hydrologic model may be compensated to some extent by enabling the model with formal hysteretic components moreover we show that the conventional model structure and parameterization may be designed in a way to partially reproduce a desired hysteretic behavior keywords hysteresis hydrology modelling preisach path dependency memory 1 introduction the definition of hysteresis is rather broad and context dependent with its greek root meaning lagging behind the term hysteresis was first used in magnetism by ewing 1885 to describe the lagged thermoelectric characteristics of a wire under different stress conditions since then this term has been used to describe a wide range of natural and engineered processes that share similar behaviors across a range of scientific and engineering disciplines merriam webster online dictionary describes hysteresis as a retardation of an effect when the forces acting upon a body are changed as if from viscosity or internal friction merriam webster 2017 the retardation or lagging of an effect behind its cause marks a loop in their relationship this definition indicates that there is causation in the relationship between the two variables another common definition views systems with hysteretic processes as path dependent systems or the systems with memory hassani et al 2014 in this view history matters and hysteresis is seen as dependence of the output of a system effect on the present and past inputs history of cause to predict the future of such systems not only do we need the current state and input of the system but also the past states and or inputs e g the sequence of events that preceded the current condition for a time window with the system memory length hysteresis has been a widely reported phenomenon in hydrology since the work of haines 1930 and richards 1931 examples from the literature include hysteresis in the relationships between temperature and discharge in snow dominated catchment schaefli 2016 soil moisture and discharge matgen et al 2012 spence et al 2010 water table and runoff mcglynn et al 2004 streamflow discharge and temperature subehi et al 2010 the contributions of hillslope and total catchment to streamflow mcguire and mcdonnell 2010 suspended sediment concentration and streamflow aich et al 2014 streamflow and nutrient loads nitrate and total phosphorus lloyd et al 2016a snow depth and snow covered fractional area magand et al 2014 and normalized snow water equivalent and snow covered fractional area luce and tarboton 2004 most of such relationships reported in the hydrological literature were described using descriptive indicators such as direction clockwise or counterclockwise shape and how shape and direction evolve over time and space langlois et al 2005 lawler et al 2006 lloyd et al 2016b zuecco et al 2016 these studies mainly focused on describing their observations which provided little insight into the fundamentals and underlying functioning of systems demonstrating those hysteretic behaviors beyond hydrology and water resources hysteresis has been instrumental in different engineering applications hysteretic phenomena such as those in the relationships between the stress and electrical voltage in piezoelectric materials strain and stress in smart materials and magnetic field and polarization of ferromagnetic materials are among the many examples exploited for engineering design purposes related to this several simple to complex hysteretic mathematical operators have been developed to simulate the behavior of hysteretic systems examples include the preisach operator preisach 1935 krasnosel skii and pokrovskii operator krasnosel skii and pokrovskii 2012 and prandtl ishlinskii operator brokate and sprekels 2012 janaideh et al 2011 while hysteretic relationships between many pairs of correlated variables in natural systems seem widespread modellers tend to rely on and utilize only functional relationships to describe the relations in a system mathematically speaking a function describes a relationship where each set of inputs i e a vector or scalar is related to exactly one output our current generation of hydrologic models has been built on deterministic functional relationships and in practice the deviations of observational records from these relationships have been commonly attributed to different sources of errors and uncertainty this is despite the fact that many of such relationships are hysteretic as opposed to functional and the deviation of these relationships from their functional surrogates approximations is systematic rather than random the reliance of models on functional relationships can be partially attributed to the ease of their identification and implementation while hysteretic relationships are not easy to identify and reproduce the multiplicity of hysteretic systems and their drivers across disciplines has made this topic quite diverse with a range of definitions interpretations and tools the challenge of navigating through this multiplicity and the lack of a coherent synthesis around this topic motivated this study in this paper we first review the fundamentals theories and general properties of hysteresis in the broad scientific literature and then focus on its representations in hydrological sciences we attempt to bring many known facts into a unified story in order to better define and explain hysteresis in the context of hydrological sciences and modeling efforts we use several examples from hydrology and beyond to elaborate on the theory of hysteresis and to 1 explain the possible reasons for observing hysteresis in different systems in relation to path dependency and memory 2 characterize the range of possible properties of hysteresis including its rate and spatio temporal dependency 3 explore different empirical and physically based ways to produce hysteretic behavior in hydrologic models and 4 investigate the need for models that formally account for hysteresis 2 hysteresis as observed in engineered and natural systems hysteretic behavior has been widely reported across a range of disciplines and contexts in the following we first present four well known examples selected from different disciplines to set the ground for better understanding the underlying behaviors implications and possible engineering usage of hysteresis these examples are then followed by our discipline specific examples of hysteresis in hydrology which motivate the discussion for the rest of the paper 2 1 general examples hysteresis has been used in engineering to design and improve the performance of engineered systems in control engineering for example hysteresis is the basis for the design of a type of controller referred to as a non ideal relay which reacts differently to rising and falling of an input signal apushkinskaya and uraltseva 2015 consider a control system for an air conditioner that is designed to keep the room temperature below 20 c under a non hysteretic design the on and off control switch is set to react once the room temperature goes above or drop below the target temperature fig 1 a in red such a design will result in high frequency on off cycles that can be harmful to the air conditioner a hysteretic design of the controller however reduces this frequency by setting up two thresholds for example at 18 c and 20 c so that the controller switches on when temperature goes above the upper threshold and switches off when it drops below the lower threshold fig 1 a in yellow this is a common example of hysteretic behavior by design in engineering systems the second example involves hysteresis in ferromagnetic materials such as iron that show magnetic characteristics when exposed to a magnetic field these materials demonstrate resistance in their magnetic characteristics to both increasing and decreasing external magnetic fields magnetic particles tend to lag when the external magnetic field rises aligning with the magnetic field direction and the new alignment does not fully return to its initial condition when the external magnetic field weakens this is an example of irreversible processes this irreversibility results in a hysteretic relationship between the alignment of particles in ferromagnetic materials a process referred to as magnetization and a changing external magnetic field fig 1 b smith 2005 this behavior is the basis of how magnetic disks and tapes store data via the memory created in such materials when exposed to a magnetic field for the same reason it is advisable that magnetic disks should be kept away from strong magnetic fields a strong magnetic field changes the polarization of magnetic particles and therefore erases the memory magnetic disks are examples of how engineering can take advantage of a naturally occurring hysteresis the third example is the maxwell slip model which is a mechanical system exhibiting a hysteretic behavior fig 1 c in this model the combined effect of a spring and static kinetic friction displays a hysteresis between the applied force and force displacement when the block is stationary increasing the exerted force from zero does not slide the block until the spring force i e equal to the exerted force in this condition overcomes the static friction between the block and the surface in this condition when the block is stationary the displacement of the force node follows hooke s law and is linearly proportional to the amount of force exerted corresponding to the move from point 1 to point 2 in fig 1 c once the force overcomes the static friction the block starts sliding from point 2 to 3 in fig 1 c and assuming equal static and dynamic friction the force and block moves with no acceleration when the exerted force starts decreasing the block stops moving and the spring starts shrinking back to its original size from point 3 to 4 in fig 1 c when the exerting force becomes zero the spring reaches its original size point 4 in fig 1 c if the exerting force is inversed now negative the spring starts to compress and shrink in length from point 4 to 5 in fig 1 c at the moment that the negative force overcomes the static friction the block starts sliding in the opposite direction see the move from point 5 to 6 the maxwell slip model is used in the pneumatic machineries for further reading refer to al bender et al 2005 quant et al 2009 hysteresis is widely observed in strength mechanics of materials when being subjected to stress and strain for example ductile materials such as aluminum or steel show different phases of deformation for increasing strain relative displacement of particles in the material body inside their elastic range they deform elastically by increasing decreasing the stress point 1 to 2 in fig 1 d beyond this range however when the stress surpasses the yield stress the material undergoes the plastic deformation which is irreversible from point 2 to 3 in fig 1 d because of this irreversibly in the plastic range even if the stress external force is fully removed the material does not go back to its initial condition when both stress and strain were zero some residual strain remains in the absence of any stress from point 3 to 4 in fig 1 d in the next loading of the material new stress the strain rises from this point instead of the initial stress strain free condition until the material shows ultimate strength and then rupture happens from point 4 to 5 and from 5 to 6 in fig 1 d this behavior is the basis for the plastic design of structures and is used to dissipate the energy of extreme forces such as earthquakes 2 2 hydrologic examples hysteresis has widely been reported in hydrology probably the most investigated and discussed hysteretic behavior in the field of hydrology is the so called water retention curve wrc that characterizes the relationship between soil water absorption potential suction head or tension and soil water content in unsaturated porous media experiments have shown that the suction head in a given mass of unsaturated soil is not unique for any given saturation level or water content fig 2 a this hysteretic behavior relates to the fact that the mechanical work required to insert a certain amount of water into a specific volume of soil is less than the work required to remove the same amount of water from the soil hillel 2003 appelbe et al 2009 the reason for such difference in the wetting and drying of soil can be attributed to 1 air resistance in the soil adrian and franzini 1966 2 the contact angle of water with the soil particles yuan and lee 2013 and 3 the ink bottle effect marshall et al 1996 the difference between the work done during wetting and drying is analogous to irreversible thermodynamic cycles where pressure change and volume change correspond to work done by a system or on a system the otto cycle in four stage internal combustion engines refrigeration cycle and the brayton cycle describing jet engines are examples of irreversible thermodynamic processes another well known hysteretic behavior is exhibited in the rating curve that characterizes the stage discharge relationship in open channels in transient flows the highest discharge and the highest stage water level do not coincide in other words during a flood event the maximum stage lags behind the maximum discharge observed at a stationary section of the channel fig 2 b the physics governing this behavior creates different stage discharge relationships in the rising and falling limbs of the passing wave kennedy 1984 however a functional non hysteretic rating curve is commonly used for discharge inference based on the observed water level this simplification in the presence of stage discharge hysteresis might result in substantial uncertainty in the estimation of discharge and discharge related inferences such as model calibration to streamflow hydrological processes are intertwined with ecological systems through different interaction mechanisms and feedback loops e g between vegetation and soil moisture janssen et al 2008 savenije and hrachowitz 2017 such interactions can cause the coupled system to shift from one stable state to another under extreme external perturbations scheffer et al 2001 for example fig 2 c shows the relationship between the annual precipitation and percentage of tree covered land in south america for grid cells with resolution of 1 km2 hirota et al 2011 as long as the precipitation within a region is lower than 1000 mm year 1 the region tends to have less than 40 percent that is of tree covered areas region 1 in fig 2 c by increasing precipitation to 2000 mm year 1 and above the system shifts to a new stable state with a tree coverage area of above 80 percent region 3 in fig 2 c when in region 3 if the precipitation falls below 2000 mm year 1 the 80 percent vegetation demonstrates resilience against water shortage until the precipitation drops below 1000 mm year 1 at which point the system shifts to a the previous stable state with a tree covered area of less than 40 percent the bi stability in region 2 of fig 2 c creates different system trajectories corresponding to wetting and drying phases which manifests itself as a hysteretic behavior in the relationship between vegetation and precipitation bi stability in aquatic ecosystems also leads to hysteretic relationships for example phosphorus concentration and turbidity can show a hysteretic relationship as shown in fig 2 d this can be due to bio manipulation resulting from removal or introduction of species to a system which can subsequently change or alter the system stable states within the system meijer 2000 reported how a reduction of fish in lake veluwe located in the netherlands resulted in an increase in chara population and a clear water state fig 2 d and how this system can have two stable states either turbid or clean 3 fundamentals and dynamical properties of hysteresis scientific developments in particular in the field of hydrology are based on two consecutive steps 1 exploring and identifying possible correlations between different variables of a system and 2 developing relationships based on the identified correlations between the variables to gain predictive ability of one variable when the other variables are available correlation is necessary but is not a sufficient condition for causation where change in one variable is the result of change in other variables in practice however it is much easier to establish correlation based relationships than ones based on cause and effect in hydrological sciences relationships are commonly considered to be in the form of functions by definition a function relates each input or a set of inputs to exactly one output the functional form however may have limited representativeness where the underlying relation is hysteretic there exists more than one output value for a given value of input we discuss some implications of this possible lack of representativeness in the following through soil moisture and streamflow data collected at white gull creek in northern saskatchewan canada barr et al 2012 fig 3 a and b show time series of streamflow and normalized soil moisture over a 60 day period and fig 3 c shows how the two are related the fitted regression function in fig 3 c may have adequate explanatory power in a statistical sense but apparently the underlying relationship forms a directed loop violating the properties of a function here a soil moisture level can correspond to two or more different values of streamflow and the true value is dependent on the direction of the loop and whether the catchment is in a drying or wetting phase the simplification reduction of a hysteretic relation into a functional relation may be deemed favorable due to the ease of identification and implementation of functions as well as their lower computational cost in practice a monotonic function is used and the dispersity of the data points around the fitted function is interpreted as uncertainty in the relationship for example the residuals difference between the function outputs and observations may be used in regression type analyses to generate confidence limits although they would be auto correlated and possess a strong pattern the dynamic properties of hysteretic relationships and their reproduction have arguably received limited or no attention fig 3 d shows the derivative i e sensitivity of streamflow with respect to soil moisture dq ds for different values of soil moisture the true hysteretic behavior of the relation between the soil moisture and streamflow exhibits both positive and negative sensitivities across the range of soil moisture s the fitted monotonically increasing functional relationship however shows only positive sensitivity for any given soil moisture s fig 3 e further demonstrates this behavior by plotting the rate of change in streamflow dq dt versus the rate of change in soil moisture ds dt over time for the fitted function and any other monotonically increasing functions in general dq dt and ds dt are always of the same sign regions 1 and 3 of fig 3 e whereas in reality dq dt and ds dt can take opposite signs as well all four regions 1 to 4 intuitively hydrologists tend to agree that an increase in soil moisture would coincide with result in an increase in streamflow and as such monotonic functions are the basis of many hydrologic models however as shown in fig 3 e the true behavior may run counter to intuition and an increase in soil moisture in a time step can coincide with a decrease in streamflow and vice versa in the following sub sections we look at hysteresis from different perspectives to better understand and characterize its fundamentals and dynamic properties 3 1 memory and path dependency hysteretic systems have been widely referred to as path dependent systems or synonymously systems with memory unlike a system in which the future state depends only upon its present state and forcings the future of a path dependent system depends on the sequence of states preceding the present state here through a physical example we attempt to illuminate the relation between interpretations of a system as being path dependent versus path independent consider an object subjected only to the earth gravitational force a projectile such as a basketball a player throws the ball upward and forward the ball reaches its maximum height and then moves downward and forward towards the basket fig 4 the two dimensional equations of motion can be used to predict the position of the ball at any future time as follows 1 x t k 1 1 2 a x t k δ t 2 v x t k δ t x t k y t k 1 1 2 a y t k δ t 2 v y t k δ t y t k where the position in the two dimensional space is denoted by x t k 1 and y t k 1 at time t k 1 x t k and y t k indicate the position of the ball with respect to the origin at time t k v x t k v y t k a x t k and a y t k represent the velocity and acceleration along x and y axes at time t k given the position velocity and acceleration of the ball at a specific time t k the position of the ball at a future time t k 1 can be calculated δ t t k 1 t k for the sake of simplicity we only focus on the equation of motion along the y axis vertical where the acceleration is only due to gravitational force g then the equation of motion in the y direction can be written as 2 y t k 1 1 2 g δ t 2 v y t k δ t y t k in which the negative sign for the acceleration term indicates the downward earth gravitational acceleration now consider three possible cases case 1 if at the time t k all the terms in the equation including the position y t k velocity v y t k and acceleration g are known then the position of the ball in a future time t k 1 can be calculated fig 4 a case 2 if the acceleration is unknown and only velocity and position of the ball can be measured we need to know the velocity of the ball at another time step in the past t k 1 in order to estimate acceleration and then predict the position of the ball in a future time fig 4 b case 3 if both velocity and acceleration are unknown in the current time step the position of the ball at two preceding time steps t k 2 and t k 1 should be known to estimate the velocity and acceleration fig 4 c according to case 1 the ball is a system where its future positions are only dependent on the current state of the system namely its position and velocity and the external forcing namely gravitational force however examples in case 2 and case 3 demonstrate how lack of knowledge or measurement of one or more components of a path independent system may lead us to treat it as a path dependent system utilizing the information on the previous states of a system may somehow compensate for unknown or missing components and as such the memory length required can be related to the extent of unknown or missing physics in the next section we elaborate on the effect of missing physics on memory and dynamics of a system in the context of hysteresis 3 2 missing physics in relation to hysteresis hysteresis might be a manifestation of missing physics in the representation of a system in this section we elaborate on this point through two examples consider the rod and wagon system displayed in fig 5 in this system the rod can move horizontally to the right and left and when it comes in contact with the wagon it makes the wagon move with it as well example adapted from morris 2012 the following relation describes the position of the wagon x w 3 x w x r d d max 2 where d is the relative position of the rod to the wagon x r is the position of the rod and d max indicates the distance between the right and left walls of the wagon imagine d max is 10 m and the initial x r and x w are both zero this means the rod is located 5 m away from the left edge of the wagon we then move the rod to fifteen positions 5 10 0 10 0 10 0 10 20 10 20 10 20 10 and 0 m we can then find the position of the wagon if we know the relative distance of the rod and the wagon for every rod movement the position of the wagon can be shown in a three dimensional space as a function of the position of the rod x r and the relative distance of the rod and wagon d fig 6 a now imagine for the same case that the internal properties and associated dynamics of this system are unknown or unmeasurable d and d max are unknown then the relationship between the position of the rod and the position of the wagon will be a hysteresis appearing relationship as shown in fig 6 b where a given position of the rod does not coincide with a unique position of the wagon no functional relationship in fact this hysteresis appearing relationship is the projection of the three dimensional function of x w with respect to x r and d shown in fig 6 a onto a two dimensional plane of positions of the rod and the wagon x r and x w this example explains how lack of knowledge missing physics can lead us to infer the existence of hysteresis in a system further it may lead us to consider the system as being path dependent and rely on its past trajectory for prediction fig 6 c shows the position of the rod and the wagon over time for the system trajectory plotted in fig 6 a a lagged looking behavior can be seen in the position of the wagon with respect to the position of the rod and therefore in the absence of a full picture of the system it can be used to provide an estimate of the future position of the wagon given the position of the rod although this estimation is not very accurate even if the full history of the rod and wagon positions is known as a more relevant hydrological example here we focus on a two reservoir nash cascade model fig 7 a with linear reservoir coefficients of 0 2 day 1 assuming no inflow to the bucket the storage is reduced to 83 percent of its initial value in one time step a day the discharge of the model can be written as a function of the two storages q 2 f s 1 s 2 any combination of storages values and their subsequent discharge mark a trajectory in the three dimensional space of s 1 s 2 and q 2 the shape of this trajectory depends on the input time series i and the initial conditions of s 1 and s 2 fig 7 b shows an example trajectory in red for an arbitrary input time series the projection of this trajectory onto the two dimensional space of s 2 and q 2 will be a straight line as shown in black in fig 7 b the reason is that the trajectory always lies on a plane in the three dimensional space as the relationship between s 2 and q 2 is linear however the projection of the trajectory onto the two dimensional space of s 1 and q 2 results in a hysteresis looking relationship in which there are multiple values of q 2 for a given s 1 green line in fig 7 b as such the relationship between the known time series will exhibit a hysteretic behavior because one dimension is missing aggregation or lumping multiple interacting components of a system into one can have implications analogous to losing dimensions as described above and result in hysteretic looking behavior in the nash cascade example aggregation of s 1 and s 2 into one total storage value s t is similar to losing the interaction of the system s internal elements and underlying processes fig 7 c this is basically an example where the heterogeneous properties of a system is not represented in the model overall the simple illustrative examples given in this section explain that hysteresis can be considered as our inability to fully grasp or model the underlying physics and or heterogeneity of a system 3 3 possible missing dimensions physics in water retention and rating curves in this section we discuss two of the most commonly observed hysteretic behaviors in hydrology and the physics that could constitute their missing dimensions contributing to their hysteretic behaviors for the water retention curve explained earlier in section 2 2 and fig 2 a the missing physics can be explained based on the potential energy terms of a volume of soil the total potential energy of soil p t can be written as 4 p t p p p z p g p o in which p p p z p g and p o are the matric the gravitational gas pressure and osmotic potentials respectively or et al 2004 glossary of terms in soil sciences agriculture canada 1976 the terms on the right hand side of the eq 4 are the most commonly used potential terms in the literature for expressing total soil potential every term can be expanded to their subcomponents and empirical relations in typical applications some of the terms of this equation are ignored an example is the water retention curve that characterizes the relationship between the soil matric potential p p and gravitational term p z or soil water content lu and khorshidi 2015 the water retention curve can therefore be seen as a projection of the higher dimensional space described in eq 4 onto a two dimensional space of matric and gravitation potentials this reduction of dimensionality leads to the exhibition of a hysteretic behavior in water retention curves whereas if all potential terms could be measured during the drying and wetting phases the resulting higher dimensional representation might not exhibit any hysteresis two types of models are usually used to describe the hysteretic behavior of water retention curves 1 physically based and 2 empirical models physically based models try to correlate soil particles and soil structure characteristics to the observed hysteretic behavior on the other hand empirical relations make use of the main drying wetting and subsequent scanning curves to reconstruct the hysteretic behavior pahm et al 2005 izady et al 2010 we note that in these modeling strategies the underlying physical components here potential terms are not formally accounted for the hysteresis in the so called rating curve stage discharge relationship can be explained by hydrodynamics here we make use of the one dimensional saint venant equation to elaborate on the physical measurement which enables us to characterize the hysteretic stage discharge relationship 5 1 g u t 1 g u u x ζ x p a τ ρ τ r ρ g where τ u ζ p a ρ and r represent shear stress velocity free surface elevation wetted perimeter area density and hydraulic radius respectively replacing the friction slope in the chézy formula using the diffusive wave derived from the saint venant equation results in 6 q a c r s b h x where q c sb and h x represent discharge chézy coefficient bed slope and pressure gradient along the channel length respectively refer to appendix a for the assumptions and substitutions which result in eq 6 for uniform flow h x will be zero as the pressure gradient along the channel length is zero this simplifies eq 6 to the chézy formula however in the case of a passing wave unsteady flow the term h x is no longer zero the value of h x for the front of the wave is negative thereby increasing the discharge for the same water level compared with the steady state flow condition for the recession limb however this term becomes positive resulting in lower discharge compared with the same water level in the steady flow condition this deviation of discharge from the steady state stage discharge relationship creates the stage discharge hysteresis when observing a passing wave from a stationary point by the open channel we commonly measure h t however to obtain discharge q from eq 6 we need to have an estimation of h x as well which is related to the deformation of the wave as it moves through the channel it should be noted that when h t is zero h x is not necessarily zero for transient flow regimes there have been various simplifications to estimate discharge based on eq 6 a well known approximation proposed by jones 1915 is to replace h x with c h t in which c is celerity of wave in open channels petersen øverleir 2006 in addition note that the chézy coefficient c is not constant during transient flow and its accurate estimation makes the discharge calculation even more challenging 3 4 hysteresis and time scale dependency hysteretic behaviors can be classified as rate dependent or rate independent rate dependent hysteresis refers to the situation where the shape of the hysteresis is dependent on the rate of change of the associated variables in contrast the rate independent hysteresis refers to the situation where the shape of the hysteresis remains the same no matter how quickly the variables are changing in other words a rate independent hysteresis is a type of hysteresis that if one variable is transformed with an affine transformation over time the other variable follows exactly the same transformation mielke 2005 in contrast for a rate dependent hysteresis any affine transformation of one variable will result in a different transformation of the other variable and as a result the shape of the hysteretic relationship will change see to appendix b for more detail in section 3 2 the rod and wagon example exhibited rate independent hysteresis because the relationship between the positions of the wagon and the rod would remain exactly the same no matter how quickly or slowly the rod moves in the nash cascade example however the hysteretic relationship between s 1 and q 2 depends on the rate of change in storage which itself depends on the rate of change in input i to further elaborate on this point let s look at the relationship between s 1 and q 2 for a range of input scenarios with different rates of change all the scenarios begin with an input of 3 mm day 1 for an extended period of time and then reduce to 0 mm day 1 each at a different negative rate of change after a relatively long period of time the input in all the scenarios goes back to 3 mm day 1 at a similar but positive rate for the first scenario the rate of change is faster such that the change in i happens suddenly in one day and for the last scenario the rate of change is slower and the transition occurs over 200 days fig 8 a fig 8b shows the resulting relationships between s 1 and q 2 for these different scenarios of rate of change as can be seen faster rates of change will result in more pronounced hysteretic behaviors whereas slower rates of change will result in narrower hysteretic loops for a system with a very small rate of change the hysteretic relationship approaches a linear function similarly the stage discharge relationship exhibits a rate dependent hysteresis the width of the hysteretic loop varies depending on the rate of change in the water level changes for fast flood waves the hysteretic behavior is pronounced because the term h x in eq 6 is considerable while for a steady flow the stage discharge relationship reduces to a monotonic function as h x approaches zero and can be neglected 3 5 alternative system pathways and its relation to hysteresis suppose the two reservoir nash cascade model of section 3 2 has been under constant forcing i 3 mm day 1 for a sufficiently long period of time such that the system is in equilibrium with no dynamics q2 i and s 1 s 2 15 mm with this initial condition and by dropping the input to zero i 0 the reservoirs go into a transitional phase and become fully emptied after an extended period of time with q2 i 0 mm day 1 now the system is at a new equilibrium state the trajectory or the pathway of this system is shown in blue in fig 9 a along many other possible trajectories starting from different initial conditions shown in gray ending with the same equilibrium now if we force the system again with the constant input of i 3 mm day 1 the system will go in a new transitional phase towards the previous equilibrium state where q2 i and s 1 s 2 15 mm fig 9 b however the transitions between the two steady states are through different pathways the projection of these pathways onto the two dimensional space of s1 and q2 forms a directed loop this example illustrates that the shape of the pathway and the direction of the loop is related to the direction of change in the state of the system in real world hydrology forcings are stochastic and changing over time and as such catchments are always in transition via a variety of non unique pathways to reach a steady state which can result in a variety of hysteretic relationships with complex forms 4 modeling hysteresis in hydrology 4 1 data driven approaches 4 1 1 empirical indices there have been research efforts to derive empirical indices that characterize the properties of hysteretic behaviors observed in hydrology these indices have been limited only to the characterization of the size and direction clockwise or counterclockwise of the hysteretic loops for single events i e single loops they are often linked and attributed to physical characteristics of the underlying system and their inputs to address the hysteretic relationship between suspended sediment and discharge langlois et al 2005 proposed the following hysteresis index that measures the ratio of the areas under the falling and rising limbs of a hysteretic loop as shown in fig 10 a 7 h index 1 x min x max y r x min x max y f in theory this ratio lies between zero and positive infinity with a value close to one indicating a narrow hysteretic loop weak hysteresis the direction of the hysteresis loop is clockwise when this hysteresis index is greater than one and counter clockwise when less than one lawler et al 2006 introduced a similar hysteretic index that only measures the fatness or thickness of the hysteretic loop at a specific value of x that might be chosen rather arbitrarily fig 10 a they suggested using the mid point of the range of observations of x data as follows 8 h index 2 y r x 0 5 y f x 0 5 there are other hysteresis indices in the literature that are effectively the same as the ones in eqs 7 and 8 for example lloyd et al 2016a b and zuecco et al 2016 suggested normalizing data before calculating these indices they also utilized a combination of the two indices to classify hysteretic behaviors both based on the area covered by rising and falling limbs and also hysteresis fatness at different intervals between the minimum and maximum values of x fig 10 b overall these event based indices have limited utility for complex multi event records of hysteretic behavior 4 1 2 preisach operators preisach operators are classic tools to represent rate independent hysteresis behaviors and consist of a finite sometimes infinite number of elements called hysterons preisach 1935 each hysteron is a hysteretic relation that reflects on both the current input as well as the history of the input a simple counterclockwise hysteron β α can be expressed in the following form 9 y t α β x t 0 x t α k k 1 if y t 1 α β 1 k 0 if y t 1 α β 0 α x t β 1 β x t where α and β are the parameters that indicate the lower and upper limits of the hysteron deactivation and activation respectively the hysteron output is one when input xt is higher than β and zero when it is lower than α the output will be the same as on the previous time step when the input is between α and β the functioning of a hysteron is the same as that of the non ideal relay for controlling cooling systems discussed in section 2 1 hysterons can be more complex with more parameters than the one presented above interested readers are referred to janaideh et al 2008 for a review the collection of hysterons forms a preisach half plane shown in fig 11 a each hysteron is assigned a value µα β that represents the contribution of that hysteron to the calculated output of the preisach model this output is the summation of the multiplication of the hysteron output with the assigned contribution for every hysteron the preisach operator has some commonality in concept to feedforward neural networks zakerzadeh et al 2011 with the difference being that each node of a preisach model contributes to the final result in a hysteretic fashion hysteron activation and deactivation is achieved using two rules in a preisach half plane rule 1 applies to an increasing input x which causes inactivated hysterons to be activated horizontally and already activated hysterons to continue to be activated rule 2 applies to a decreasing input which causes activated hysterons to be deactivated vertically depending on the input value an example of a preisach half plane is presented in fig 11 b with the activation and deactivation rules explained the contribution of each hysteron is indicated in the preisach half plane at the beginning the input is 0 and no hysteron is activated consequently the output is also 0 when the input increases to 3 and based on the first rule rule of activation 6 hysterons will be activated and the output will be the summation of the contribution of each hysteron which will be 2 1 when the input decreases to 1 only three hysterons remain activate following the second rule rule of deactivation and therefore the summation will be 0 7 similarly when the input increases to 2 four hysterons will be activated and the output will be 1 0 when the input increases to 4 all the hysterons will be activated and the output reaches to its maximum value of 5 5 when the input returns to 0 all the hysterons will become deactivated and the output reduces to 0 the resulting hysteresis is depicted in fig 11 c the preisach operator explained above reproduces rate independent hysteresis however when it is combined with a mass balance equation we can show the collective system will reproduce rate dependent hysteresis as well not presented here for the sake of brevity o kane and flynn 2007 also mentioned this behavior similarly the combination of a rate independent hysteretic water retention curve and the conservation of mass equation results in a model that mimics the rate dependency of the system there are a few studies in the hydrologic literature where preisach operators have been used to introduce hysteretic components to terrestrial hydrologic models o kane 2005 and similarly o kane and flynn 2007 showed that the preisach operator which was partly constructed based on the van genuchten formula van genuchten 1980 is able to reproduce the grizlly data set between soil water content and soil suction head the best performing preisach operator was then used in the fully vegetated slab of soil and transpiring plants fest model o kane 2005 appelbe et al 2009 4 1 3 other empirical approaches in addition to the preisach operator independent and dependent domain theories and their modifications everett and whitton 1952 topp 1971 are used as empirical tools for hysteresis modeling these theories are based on the assumption that hysteresis is a result of the combination of many smaller elements called domains in general and similar to preisach operator the independent domain theory between the soil suction head and soil moisture can be expressed as 10 θ f ψ w ψ d d ψ w d ψ d in which f is a joint probability distribution based on drying ψ d and wetting ψ w processes for the domains of soil pore space independent domain theory assumes that each domain is acting independently from its neighboring domains for soil this translates as if an empty space is filled and emptied with water regardless of the dryness and wetness of its neighboring pores to account for this dependency dependent domain theory has been exploited as mentioned by mualem and dagan 1975 the generalized form of dependent domain theory for water retention curve can be written as 11 θ p d ψ w ψ d θ ψ p w ψ w ψ d θ ψ f ψ w ψ d d ψ w d ψ d where p d and p w are the weights which correct for the effects of neighboring domains as a functions of the wetting ψ w drying ψ d suction head ψ and soil moisture θ the challenge of the dependent and independent domain theories similar to the one of the presacih operator is the approximation of p d p w and f based on an observed water retention curve its main drying and main wetting curves as well as screening curves pham et al 2005 artificial neural networks anns have been also used to reproduce hysteretic relationships an ann is an interconnected group of nodes the input node s input variables are connected to the output node s output variables through a set of hidden node s organized in hidden layer s each node is characterized by a set of weights and an activation function that are inferred based on the data anns have been widely used in the context of hydrological modeling as it is suitable for cases when underlying physical characteristics of a system is not well known the ability of anns in reproducing hysteresis for different processes in hydrology have been demonstrated nourani et al 2013 bhattacharya and solomatine 2005 in this case anns need to be enabled with a tapped delay line which provides a memory to the model razavi and karamouz 2007 4 2 process based approaches there have been recent efforts to relate different hysteretic behaviors to the underlying physical processes using interconnected functional components fovet et al 2015 modelled the observed hysteresis of saturated storage at hillslope and riparian areas with streamflow by using a range of models they showed that a conceptual model with enough components to differentiate between riparian area and hillslope could reproduce the observed hysteresis in the data shook et al 2013 introduced a conceptualization of a set of interconnected lakes in the canadian prairies they simplified the interconnection of lakes in their study area to a tree of nodes each node representing a lake with a threshold behaving gate keeping characteristic phillips et al 2011 by such a model structure they were able to reproduce one of the most challenging hydrological processes in prairie regions namely the fill and spill mechanism spence 2010 mengistu and spence 2016 showed the ability of an already existing hydrology and routing model in reproducing hysteresis between the contributing area and discharge in the canadian prairie potholes regions the application of full continuity and momentum equations or their simplifications can also be used to reproduce the hysteretic behavior at desire scale davies and beven 2015 investigated the effect of spatial scale on the shape of hysteresis by artificially scaling a catchment model and its discretization they used the multiple interacting pathways concept mips approach davies et al 2011 davies and beven 2012 at the grid scale to generate the storage discharge hysteresis of the catchment di baldassarre and montanari 2009 reconstructed the stage discharge relationship for the po river in italy during flood events by simulating the river physics via a one dimensional hydraulic model the aforementioned studies including examples presented in section 3 2 show that a combination of functional relationships can enable models to reproduce hysteresis at the scale of interest at the scale of modelling in other words for modelling the hysteretic behavior at a specific scale the model components at a smaller scale should not necessarily be hysteretic 4 3 the spectrum of modelling approaches with respect to hysteresis despite the attention that hysteresis modeling in hydrology has attracted there have been limited efforts to design and incorporate hysteretic components into hydrologic models to account for small scale hysteretic processes for example the famous hysteretic relationship between soil moisture and soil hydraulic conductivity i e the existence of different values of hydraulic conductivity for a single value of soil moisture is represented as non hysteretic in all basin scale models van genuchten s van genuchten 1980 or brooks and corey s brooks and corey 1966 empirical functions are used with an approximation of richard s equation to simulate flow of water in unsaturated soil not formally addressing hysteresis might be a shortcoming of the current generation of hydrologic models as mentioned in previous works e g beven 2006 o kane 2005 in general little progress has been made in characterizing the significance of hysteresis and its explicit inclusion in hydrologic modelling and to the authors knowledge the existing models consisting of hysteretic components have only been applied at plot scales a few meters appelbe et al 2009 in sections 4 1 and 4 2 we presented a range of strategies from data driven to process based which can be used for hysteresis modeling it is modelers choice which approach to use given the nature and the purpose of the modeling in theory any model choice lands somewhere in a modeling spectrum that spans a range from fully data driven approaches to fully physically based process based approaches fig 12 an example study of the data driven end point of this spectrum is the work of subehi et al 2010 that only relied on hysteretic indices to explain the relationships between discharge and stream flow temperature westhoff et al 2011 on the other hand tried to explain this relationship by an almost full dimensional representation of a headwater stream the data driven modelling can reproduce hysteresis only at the full scale of a system the scale of the system s input and output data and lacks any representation of hysteretic processes at any scale lower than the modeling scale on the other hand a full dimensional physically based model in theory should be able to reproduce hysteretic processes at any scale from pore scales to watershed scales the development and application of such models of course remains far fetched to be practical therefore the current generation of physically based models can represent hysteresis only at a limited range of scales this is because as previously discussed the collective behavior of a set of non hysteretic components can be capable of reproducing hysteresis at scales larger than components scale the existence of hysteresis at scales that are smaller than the scale of model non hysteretic components can introduce uncertainty to modelling results this source of modelling errors has remained fairly unexplored in the following section we try to investigate this source of errors and how it propagates from the model component scale to the system scale via a synthetic case study 5 the significance of the inclusion of hysteretic components in modelling and the role of model structure parameterization and calibration as shown in the case of a nash cascade model a model consisting of multiple non hysteretic components e g buckets or control volumes can exhibit a hysteretic behavior when only a sub space of its full dimensional space is observed this suggests that models if configured parameterized and tuned properly might be able to reproduce a hysteretic behavior of interest and compensate for the lack of hysteretic components in the following and through a synthetic example we investigate whether or not a model with deterministic functional relationship can approximate the behavior of a model enabled with hysteretic components at different scales this example uses a distributed hydrologic model with six grid cells fig 13 a each grid cell consists of three layers i e buckets or control volumes connected in a cascade fashion fig 13 b the flux from each grid cell q g in fig 13 b is routed using a convolution function presented in fig 13 c to the catchment outlet refer to appendix c for the details of the convolution function used in this study the length of the convolution function is proportional to the distance between the grid cell and the outlet and is identified by the first numbers in the parentheses in fig 13 a the catchment is assumed to be forced by a heterogeneous rainfall field identified by the second set of values in the parentheses in fig 13 a a bucket is effectively a control volume which might be deemed the simplest possible element of conceptual rainfall runoff modeling and in a more physically based model it can be seen to be equivalent to a soil layer in general the governing mass balance equation for a bucket control volume is d s d t q in q out where d s d t is the rate of change in storage over time and q in and q out are the input e g rainfall and infiltration from the upper layer and output e g infiltration to the lower layer or lateral flow respectively q out is typically described as a function of storage s 12 q out f s the function f can take a variety of forms and for this study we assumed it is the product of storage and the reservoir coefficient k which is itself a function of the storage 13 q out k s s now to investigate the effect and significance of including hysteretic components in this model we used a hysteretic operator ƥ s built upon the concept of preisach we replaced k s in eq 13 by ƥ s thereby creating a hysteretic relationship between the storage and output flux fig 13 d shows a schematization of k s and ƥ s in red and blue respectively in the designed preisach operator α and β are from the same dimension as that of the storage mm and the weights of hysterons µ values for the preisach half plane are from the same dimension as that of the reservoir coefficient day 1 the strength of the hysteresis created by the designed preisach half plane is controlled by parameter m we also generated a 4 parameter functional approximation that best fits the designed preisach operator a description on the construction of the preisach half planes and their functional approximations is presented in detail in appendix d we investigated the differences in simulated results of the same model enabled with different hysteretic components in terms of hysteresis strength controlled by m and their functional approximations figs 14 15 and 16 the differences in total streamflow at the outlet q t at the grid scale q g and at the first layer q 1 are quantified using the root mean square error metric i rmse fig 14 a similarly the differences in storage at the first layer s 1 at the grid scale s g s 1 s 2 s 3 and for the entire catchment average storage over all grids s t are quantified fig 14b as expected the simulated fluxes and storages with hysteretic components and their functional approximations diverge as we increase the strength of hysteresis the model results with functional approximation serve as a benchmark which provides insight into the effect of model configuration the three layered grid and six grid cells and river routing the lag functions used for routing without any embedded hysteretic components it should also be noted when m is set to 1 the hysteretic component and its functional approximation are effectively the same fig 15 a b and c show the relationships between the discharge and storage at the layer grid and catchment scales respectively for the models without and with hysteretic components m 10 at the layer scale the two simulations are different by design one is hysteretic and the other one is not no looping behavior but even the model without the hysteretic components exhibits a hysteretic behavior at the grid and catchment scales and this hysteretic behavior largely follows that of the model with the hysteretic components this example points at the role of model structure to partially reproduce a desired hysteretic behavior of hydrologic systems a non hysteretic model structure of a hydrologic model when combined with proper parameterization and calibration may be able to better reproduce a desired hysteretic behavior to evaluate this we perturbed the four parameters of the functional relationship within their ranges as specified in table d1 to generate an ensemble of simulations under a variety of parameter configurations then we compared the resulting time series of q 1 q g q t s 1 s g and s t with those of the hysteretic model runs with m values of 1 no hysteresis 2 5 and 10 fig 16 a b and c show the performance of each ensemble member compared with the result of the hysteretic models as can be seen the cloud of points moves away from the best fit the origin for larger m values indicating that the ability of parameterization and calibration degrades when the hysteretic component amplifies fig 16 d e and f show the best performing non hysteretic model results corresponding to the best i rmse for both q and s in reproducing the hysteretic behavior of the model with hysteretic components m 10 comparing these plots with fig 15 demonstrates some improvement in reproducing the hysteretic behaviors at the grid and catchment scales which can be attributed to calibration 6 discussions 6 1 a hydrologically relevant definition for hysteresis hysteresis can be seen as a manifestation of a lack of full process representation in hydrology the full process representation requires involving all the physical variables and their dynamics within a process yet a full dimensional representation of many hydrological processes is non trivial this results in a lower dimensional representation which is geometrically analogous to projecting mapping a high dimensional space onto its sub space i e a lower dimensional space a function in a high dimensional space when projected onto a lower dimensional sub space can appear as a hysteretic relationship this can be seen as a form of epistemic uncertainty in hydrology where our understanding of a process is not near full dimensional representation 6 2 is hydrology path dependent we showed how a lack of knowledge or data about a system might lead us to treat it as a path dependent system and to rely on its history to capture the missing elements to predict the future of the system s behavior see section 3 1 hydrology has frequently been deemed or assumed to be path dependent and as beven 2006 formulated 14 q f s p d t where q represents the discharge of a catchment at time t s and p are vectors of storage and precipitation notations s and p used by beven 2006 at the current and previous time steps history and dt indicates the time increments this formulation has proven useful particularly when dealing with hysteresis in the absence of a full picture of all processes and their interconnections the model however would not be path dependent if we could identify and formulate a proper model structure that represents the interconnected components of the underlying system for example instead of having a time based vector time series of state variables s in eq 14 for a single control volume that represents a heterogeneous domain we could have an improved representation of that heterogeneous domain by introducing an adequate number of control volumes and their interconnections to the model structure that way the formulation would only require the current state of those interconnected parts rather than the history of their collective behavior in an ideal physically based model all the model components and parameters are known and therefore no calibration is needed the future state of the system is only dependent on its current state and forcings on the other hand in the context of data driven models such as artificial neural networks or statistical time series models refer to bárdossy and hörning 2017 the calibration training of the model on historical data is often conducted in a way that treats the system as path dependent 6 3 missing physics and the notion of state space representation the term missing physics in this paper is used to refer to missing kinematic and or dynamics in the representation of a system the distinction between the two can be explained by the notion of state space representation of a system where the evolution of the system is described by a set of first order differential equations kinematics is related to the degrees of freedom of the system trajectory characterized by the size of the state vector while dynamics is about the properties of the right hand side of the differential process equations missing kinematics to describe a physical system is analogous to missing dimensions in the state vector while missing dynamics is about the inability of the process equations right hand side of the differential equations to fully capture the true dynamics of the system a perfect representation of a system indicates a perfect representation of both kinematics variables involved and dynamics time dependent relationships between the variables of the system such a representation would be equivalent to what we referred to as fully dimensional physically based model in section 4 3 on the other hand a data driven model in that section refers to a representation that only deals with the kinematics of the system and attempts to relate them empirically note that this analogy to state space representation may be generalized to systems described by higher order and or partial differential equations 6 4 should we include hysteretic components in our models in this study we tried to investigate the need for models which formally include hysteretic components through a synthetic example while the analyses based on this example may not be comprehensive and conclusive we argued that a model if complex enough is able to reproduce the hysteresis at the scale of modeling it might not be necessary to include hysteretic components in a model as the model structure in combination with parameterization and calibration can mask the possible effect of smaller scale hysteretic processes we further argued that the practical hydrologic models lie between data driven and physically based end points of a modeling spectrum section 4 3 while it may be impractical to develop a full dimensional physically based model which encapsulates all physical processes at various scales when required hysteretic processes smaller than the scale of model components can be replicated by data driven approaches section 4 3 fig 12 6 5 hysteresis requires a causality context not every loop looking relationship may constitute a hysteretic behavior and be referred to as hysteretic in the absence of any causation for example the stream flows from two adjacent catchments may be correlated and from a loop when plotted against each other where there is no cause and effect relationship between elements of the two catchments in principle the two catchments might have different rainfall runoff mechanisms and the observed correlation might result from the same cause e g the same rainfall pattern in general any observed correlation may require some causality context to be the basis for developing relationships in hydrology establishing a causality relation is fundamental to the physical sciences and falls under the philosophy of the science of physics for further reading refer to bohm 2005 6 6 spatio temporal dependency of hysteresis as mentioned in section 3 4 hysteresis is a time scale dependent concept rate dependency there have been multiple observations reported in the literature that a hysteretic relationship might change over time for example mcguire and mcdonnell 2010 observed that the hysteretic relationship between the contributions of a local hillslope versus the total catchment to streamflow changes from clockwise to counterclockwise when the catchment saturation level increases beyond a threshold similarly lloyd et al 2016a showed that the direction of the hysteretic relationship clockwise or counterclockwise between phosphorus concentration and discharge changes over different seasons it should be noted that these examples are not related to the rate dependency of hysteresis rather they are the result of change of system characteristics such as storage or antecedent soil moisture over time our analysis in section 5 indicates that hysteresis is spatial scale dependent as well from one layer to grid scale and to the entire synthetic set up however the spatial dependency of hysteresis is more difficult to be understood and predicted across different scales in comparison with its temporal dependency this difficulty arises from the complexity of interactions of elements at smaller scale processes to form the collective system s behavior at a desired larger scale although recent studies such as that by davies and beven 2015 showed through a synthetic case that the shape and significance of hysteresis between streamflow and catchment storage changes across scales a general conclusion regarding this dependency might be far fetched 6 7 treatment of uncertainty as stated above hysteresis in hydrology is due to our incomplete knowledge or representation of hydrological processes this incompleteness results in epistemic uncertainty in hydrologic systems identification and subsequently in predictions this uncertainty manifests itself as systematic auto correlated errors between model simulation and observed data in a model where functional relationships are used to approximate hysteretic relationships for example fig 3 b shows how the functional approximation results in auto correlated residuals where for the rising limb the residuals tend to be positive and for the falling limb they tend to be negative 7 conclusions in this paper we synthesized and analyzed the theory fundamentals and implications of hysteresis in hydrological sciences and beyond we conclude this paper by re iterating the following remarks hysteresis in hydrology is a manifestation of a lack of complete knowledge or representation of physics involved in a process hysteresis may not be attributed to path dependency or memory effect in most hydrological processes however in the absence of sufficient knowledge or data utilizing the history of a process can be helpful in predicting its future hysteresis in hydrology is rate dependent meaning that the time scale of observation and or analysis controls the strength and characteristics of the induced hysteresis hysteresis in hydrology is scale dependent meaning that the effect of small scale hysteretic processes may or may not contribute to the hysteretic processes at larger scale model structure and parameterization can be designed in a way to reproduce some observed hysteresis at the scale of modeling this reproduction may not be exact however at the end we recognize that some of the ideas presented in this paper are those of the authors and may be open to question we hope that the hydrologic community will contribute to this discussion and help us better understand characterize and simulate the underlying hydrologic processes that manifest themselves as hysteresis acknowledgement the authors would like to thank alan barr from environment and climate change canada eccc and andy black from university of british colombia who provided us with the data used in fig 3 the authors would also like to thank andrás bárdossy vazken andréassian alberto montanari demetris koutsoyiannis fabrizio fenicia todd rasmussen hubert savenije hoshin gupta mohammad al janaide kevin shook christopher spence james craig and andrew ireson for their constructive comments and fruitful discussions on the presented work this work was financially supported by canada excellence research chair in water security and razavi s nserc natural sciences and engineering research council of canada discovery grant appendix a saint venant system of partial differential equations which describe the 1 d incompressible flow in an open channel is a 1 1 g u t 1 g u u x ζ x p a τ ρ τ r ρ g a 2 a t a u x 0 in which g τ u ζ p a ρ and r represent gravitational acceleration shear stress velocity free surface elevation wetted perimeter area density and hydraulic radius the terms u t u u x and ζ x represent local acceleration convective acceleration and pressure force respectively ζ the surface elevation can be expressed as the summation of the bed elevation and water depth a 3 ζ z b h in which the z b is the elevation of the channel bed and h is the water depth the right hand side of eq a 1 can be expressed as friction gradient and the third term of the left hand side can be expanded using eq a 3 a 4 1 g u t 1 g u u x h x z b x s f in which the term z b x is the bed slope s b and therefore eq a 4 can be written as follow a 5 1 g u t 1 g u u x h x s b s f when discharge q varies slowly and changes in cross sections along the channel is minimal both local and convective acceleration can be ignored this simplifies the fully dynamics wave eq a 5 to diffusive wave a 6 h x s b s f the chézy formula expresses discharge q as a 7 q a u a c r s f in which s f and c represent the friction slope and chézy coefficient respectively the friction slope can be replaced from diffusive wave eq a 6 into the chézy formula eq a 7 resulting in a 8 q a c r s b h x appendix b in fig b1 a and b an imaginary input and its corresponding output are illustrated in blue the input and output time series show a hysteretic relation depicted in fig b1 c if the input to the system undergoes an affine transformation over time by a factor of 0 5 compressed to half of its actual time two option for the output can be considered 1 the output follows exactly the same affine transformation fig b1 b in red or 2 the output differs from the affine transformation fig b1 b in dashed red the hysteresis generated in the first situation when the output follows exactly the same transformation as input will be identical to the original hysteresis fig b1 d this mean the hysteresis presented in fig b1 c and d will be exactly the same the system that generates exactly the same hysteresis under affine transformation is said to be rate independent in contrast if the output of the system does not follow exactly the same affine transformation the input went through compare fig b1 c and e the system is considered to be rate dependent appendix c the lag or the convolution function used in section 5 is based on an increasing linear function it distributes the current flux proportionally to current and future time steps figure c1 a c e and g show the effect of four lag functions with various time length of 1 2 3 and 4 days for a flux with magnitude of one over one day or one time step similarly the effect of these lag functions have been shown in fig c1 b d f h appendix d the hysteretic components used in section 5 were built based on the concept of preisach operator section 4 1 2 the operator ƥ is a summation of a constant value k min and a preisach operator ƥ d 1 ƥ s k min ƥ s the preisach operator was built based on a sinus function d 2 k s k min s s min k min k max k min 2 1 sin s s min s max s min π π 2 s min s s max k max s max s the difference between the upper and lower values of k s bounding a set of hysterons located horizontally between lines y x and y mx are distributed uniformly across those hysterons as an example fig d1 shows a preisach half plane built with resolution of 4 mm in this example k min k max s min and s max are set to 0 2 day 1 0 4 day 1 10 mm and 50 mm respectively we also assume m equals 3 meaning that the hysterons between y x and y 3x have weights more than 0 and outside of this range their weights are set to be 0 in this figure weights of each hysteron between the values of 40 and 44 is equal to k 44 k 40 8 which is approximately 0 0023 day 1 the number 8 in the denominator indicates the number of hysterons between y x y 3x and bounded by 40 and 44 the red rectangle in fig d1 in this study we made use of four different preisach half planes with k min k max s min and s max fixed at 0 2 day 1 0 4 day 1 10 mm and 50 mm respectively and m values of 1 2 5 and 10 the resolution of the preisach half plane was set to 2 5 mm the relationship in fig d2 shows the preisach half planes and their hysteretic relationships for a consecutive rising and falling limb in blue the red lines indicate the approximation of hysteretic behavior the best function was obtained by 10 000 samplings of k min k max s min and s max given their ranges in table d1 and selecting the best values based on root mean square error i rmse when compared with the hysteretic relationships these functions were used for comparing the effect of hysteretic components and its functional approximation in the synthetic case study presented in section 5 
6957,hysteresis is a widely reported phenomenon in natural and engineered systems across different temporal and spatial scales its definition is non unique and rather context dependent while systems with hysteretic behavior including hydrological systems are commonly referred to as path dependent systems or systems with memory despite widespread existence of hysteretic processes the current generation of hydrologic models do not directly account for hysteresis in this paper we review the fundamentals theories and general properties of hysteresis in the broad scientific literature and then focus on its representations in hydrological sciences through illustrative examples we show how an incomplete understanding or representation of the underlying processes in a system can lead to considering the system as being path dependent we argue that in most cases hysteresis is a manifestation of our dimensionality reducing approach to process understanding and representation we further explain that modelling hysteresis in an ideal world requires a full dimensional process representation based on a perfect understanding of the processes their heterogeneity and their spatio temporal scale dependency we discuss however that the missing dimensions physics in a hydrologic model may be compensated to some extent by enabling the model with formal hysteretic components moreover we show that the conventional model structure and parameterization may be designed in a way to partially reproduce a desired hysteretic behavior keywords hysteresis hydrology modelling preisach path dependency memory 1 introduction the definition of hysteresis is rather broad and context dependent with its greek root meaning lagging behind the term hysteresis was first used in magnetism by ewing 1885 to describe the lagged thermoelectric characteristics of a wire under different stress conditions since then this term has been used to describe a wide range of natural and engineered processes that share similar behaviors across a range of scientific and engineering disciplines merriam webster online dictionary describes hysteresis as a retardation of an effect when the forces acting upon a body are changed as if from viscosity or internal friction merriam webster 2017 the retardation or lagging of an effect behind its cause marks a loop in their relationship this definition indicates that there is causation in the relationship between the two variables another common definition views systems with hysteretic processes as path dependent systems or the systems with memory hassani et al 2014 in this view history matters and hysteresis is seen as dependence of the output of a system effect on the present and past inputs history of cause to predict the future of such systems not only do we need the current state and input of the system but also the past states and or inputs e g the sequence of events that preceded the current condition for a time window with the system memory length hysteresis has been a widely reported phenomenon in hydrology since the work of haines 1930 and richards 1931 examples from the literature include hysteresis in the relationships between temperature and discharge in snow dominated catchment schaefli 2016 soil moisture and discharge matgen et al 2012 spence et al 2010 water table and runoff mcglynn et al 2004 streamflow discharge and temperature subehi et al 2010 the contributions of hillslope and total catchment to streamflow mcguire and mcdonnell 2010 suspended sediment concentration and streamflow aich et al 2014 streamflow and nutrient loads nitrate and total phosphorus lloyd et al 2016a snow depth and snow covered fractional area magand et al 2014 and normalized snow water equivalent and snow covered fractional area luce and tarboton 2004 most of such relationships reported in the hydrological literature were described using descriptive indicators such as direction clockwise or counterclockwise shape and how shape and direction evolve over time and space langlois et al 2005 lawler et al 2006 lloyd et al 2016b zuecco et al 2016 these studies mainly focused on describing their observations which provided little insight into the fundamentals and underlying functioning of systems demonstrating those hysteretic behaviors beyond hydrology and water resources hysteresis has been instrumental in different engineering applications hysteretic phenomena such as those in the relationships between the stress and electrical voltage in piezoelectric materials strain and stress in smart materials and magnetic field and polarization of ferromagnetic materials are among the many examples exploited for engineering design purposes related to this several simple to complex hysteretic mathematical operators have been developed to simulate the behavior of hysteretic systems examples include the preisach operator preisach 1935 krasnosel skii and pokrovskii operator krasnosel skii and pokrovskii 2012 and prandtl ishlinskii operator brokate and sprekels 2012 janaideh et al 2011 while hysteretic relationships between many pairs of correlated variables in natural systems seem widespread modellers tend to rely on and utilize only functional relationships to describe the relations in a system mathematically speaking a function describes a relationship where each set of inputs i e a vector or scalar is related to exactly one output our current generation of hydrologic models has been built on deterministic functional relationships and in practice the deviations of observational records from these relationships have been commonly attributed to different sources of errors and uncertainty this is despite the fact that many of such relationships are hysteretic as opposed to functional and the deviation of these relationships from their functional surrogates approximations is systematic rather than random the reliance of models on functional relationships can be partially attributed to the ease of their identification and implementation while hysteretic relationships are not easy to identify and reproduce the multiplicity of hysteretic systems and their drivers across disciplines has made this topic quite diverse with a range of definitions interpretations and tools the challenge of navigating through this multiplicity and the lack of a coherent synthesis around this topic motivated this study in this paper we first review the fundamentals theories and general properties of hysteresis in the broad scientific literature and then focus on its representations in hydrological sciences we attempt to bring many known facts into a unified story in order to better define and explain hysteresis in the context of hydrological sciences and modeling efforts we use several examples from hydrology and beyond to elaborate on the theory of hysteresis and to 1 explain the possible reasons for observing hysteresis in different systems in relation to path dependency and memory 2 characterize the range of possible properties of hysteresis including its rate and spatio temporal dependency 3 explore different empirical and physically based ways to produce hysteretic behavior in hydrologic models and 4 investigate the need for models that formally account for hysteresis 2 hysteresis as observed in engineered and natural systems hysteretic behavior has been widely reported across a range of disciplines and contexts in the following we first present four well known examples selected from different disciplines to set the ground for better understanding the underlying behaviors implications and possible engineering usage of hysteresis these examples are then followed by our discipline specific examples of hysteresis in hydrology which motivate the discussion for the rest of the paper 2 1 general examples hysteresis has been used in engineering to design and improve the performance of engineered systems in control engineering for example hysteresis is the basis for the design of a type of controller referred to as a non ideal relay which reacts differently to rising and falling of an input signal apushkinskaya and uraltseva 2015 consider a control system for an air conditioner that is designed to keep the room temperature below 20 c under a non hysteretic design the on and off control switch is set to react once the room temperature goes above or drop below the target temperature fig 1 a in red such a design will result in high frequency on off cycles that can be harmful to the air conditioner a hysteretic design of the controller however reduces this frequency by setting up two thresholds for example at 18 c and 20 c so that the controller switches on when temperature goes above the upper threshold and switches off when it drops below the lower threshold fig 1 a in yellow this is a common example of hysteretic behavior by design in engineering systems the second example involves hysteresis in ferromagnetic materials such as iron that show magnetic characteristics when exposed to a magnetic field these materials demonstrate resistance in their magnetic characteristics to both increasing and decreasing external magnetic fields magnetic particles tend to lag when the external magnetic field rises aligning with the magnetic field direction and the new alignment does not fully return to its initial condition when the external magnetic field weakens this is an example of irreversible processes this irreversibility results in a hysteretic relationship between the alignment of particles in ferromagnetic materials a process referred to as magnetization and a changing external magnetic field fig 1 b smith 2005 this behavior is the basis of how magnetic disks and tapes store data via the memory created in such materials when exposed to a magnetic field for the same reason it is advisable that magnetic disks should be kept away from strong magnetic fields a strong magnetic field changes the polarization of magnetic particles and therefore erases the memory magnetic disks are examples of how engineering can take advantage of a naturally occurring hysteresis the third example is the maxwell slip model which is a mechanical system exhibiting a hysteretic behavior fig 1 c in this model the combined effect of a spring and static kinetic friction displays a hysteresis between the applied force and force displacement when the block is stationary increasing the exerted force from zero does not slide the block until the spring force i e equal to the exerted force in this condition overcomes the static friction between the block and the surface in this condition when the block is stationary the displacement of the force node follows hooke s law and is linearly proportional to the amount of force exerted corresponding to the move from point 1 to point 2 in fig 1 c once the force overcomes the static friction the block starts sliding from point 2 to 3 in fig 1 c and assuming equal static and dynamic friction the force and block moves with no acceleration when the exerted force starts decreasing the block stops moving and the spring starts shrinking back to its original size from point 3 to 4 in fig 1 c when the exerting force becomes zero the spring reaches its original size point 4 in fig 1 c if the exerting force is inversed now negative the spring starts to compress and shrink in length from point 4 to 5 in fig 1 c at the moment that the negative force overcomes the static friction the block starts sliding in the opposite direction see the move from point 5 to 6 the maxwell slip model is used in the pneumatic machineries for further reading refer to al bender et al 2005 quant et al 2009 hysteresis is widely observed in strength mechanics of materials when being subjected to stress and strain for example ductile materials such as aluminum or steel show different phases of deformation for increasing strain relative displacement of particles in the material body inside their elastic range they deform elastically by increasing decreasing the stress point 1 to 2 in fig 1 d beyond this range however when the stress surpasses the yield stress the material undergoes the plastic deformation which is irreversible from point 2 to 3 in fig 1 d because of this irreversibly in the plastic range even if the stress external force is fully removed the material does not go back to its initial condition when both stress and strain were zero some residual strain remains in the absence of any stress from point 3 to 4 in fig 1 d in the next loading of the material new stress the strain rises from this point instead of the initial stress strain free condition until the material shows ultimate strength and then rupture happens from point 4 to 5 and from 5 to 6 in fig 1 d this behavior is the basis for the plastic design of structures and is used to dissipate the energy of extreme forces such as earthquakes 2 2 hydrologic examples hysteresis has widely been reported in hydrology probably the most investigated and discussed hysteretic behavior in the field of hydrology is the so called water retention curve wrc that characterizes the relationship between soil water absorption potential suction head or tension and soil water content in unsaturated porous media experiments have shown that the suction head in a given mass of unsaturated soil is not unique for any given saturation level or water content fig 2 a this hysteretic behavior relates to the fact that the mechanical work required to insert a certain amount of water into a specific volume of soil is less than the work required to remove the same amount of water from the soil hillel 2003 appelbe et al 2009 the reason for such difference in the wetting and drying of soil can be attributed to 1 air resistance in the soil adrian and franzini 1966 2 the contact angle of water with the soil particles yuan and lee 2013 and 3 the ink bottle effect marshall et al 1996 the difference between the work done during wetting and drying is analogous to irreversible thermodynamic cycles where pressure change and volume change correspond to work done by a system or on a system the otto cycle in four stage internal combustion engines refrigeration cycle and the brayton cycle describing jet engines are examples of irreversible thermodynamic processes another well known hysteretic behavior is exhibited in the rating curve that characterizes the stage discharge relationship in open channels in transient flows the highest discharge and the highest stage water level do not coincide in other words during a flood event the maximum stage lags behind the maximum discharge observed at a stationary section of the channel fig 2 b the physics governing this behavior creates different stage discharge relationships in the rising and falling limbs of the passing wave kennedy 1984 however a functional non hysteretic rating curve is commonly used for discharge inference based on the observed water level this simplification in the presence of stage discharge hysteresis might result in substantial uncertainty in the estimation of discharge and discharge related inferences such as model calibration to streamflow hydrological processes are intertwined with ecological systems through different interaction mechanisms and feedback loops e g between vegetation and soil moisture janssen et al 2008 savenije and hrachowitz 2017 such interactions can cause the coupled system to shift from one stable state to another under extreme external perturbations scheffer et al 2001 for example fig 2 c shows the relationship between the annual precipitation and percentage of tree covered land in south america for grid cells with resolution of 1 km2 hirota et al 2011 as long as the precipitation within a region is lower than 1000 mm year 1 the region tends to have less than 40 percent that is of tree covered areas region 1 in fig 2 c by increasing precipitation to 2000 mm year 1 and above the system shifts to a new stable state with a tree coverage area of above 80 percent region 3 in fig 2 c when in region 3 if the precipitation falls below 2000 mm year 1 the 80 percent vegetation demonstrates resilience against water shortage until the precipitation drops below 1000 mm year 1 at which point the system shifts to a the previous stable state with a tree covered area of less than 40 percent the bi stability in region 2 of fig 2 c creates different system trajectories corresponding to wetting and drying phases which manifests itself as a hysteretic behavior in the relationship between vegetation and precipitation bi stability in aquatic ecosystems also leads to hysteretic relationships for example phosphorus concentration and turbidity can show a hysteretic relationship as shown in fig 2 d this can be due to bio manipulation resulting from removal or introduction of species to a system which can subsequently change or alter the system stable states within the system meijer 2000 reported how a reduction of fish in lake veluwe located in the netherlands resulted in an increase in chara population and a clear water state fig 2 d and how this system can have two stable states either turbid or clean 3 fundamentals and dynamical properties of hysteresis scientific developments in particular in the field of hydrology are based on two consecutive steps 1 exploring and identifying possible correlations between different variables of a system and 2 developing relationships based on the identified correlations between the variables to gain predictive ability of one variable when the other variables are available correlation is necessary but is not a sufficient condition for causation where change in one variable is the result of change in other variables in practice however it is much easier to establish correlation based relationships than ones based on cause and effect in hydrological sciences relationships are commonly considered to be in the form of functions by definition a function relates each input or a set of inputs to exactly one output the functional form however may have limited representativeness where the underlying relation is hysteretic there exists more than one output value for a given value of input we discuss some implications of this possible lack of representativeness in the following through soil moisture and streamflow data collected at white gull creek in northern saskatchewan canada barr et al 2012 fig 3 a and b show time series of streamflow and normalized soil moisture over a 60 day period and fig 3 c shows how the two are related the fitted regression function in fig 3 c may have adequate explanatory power in a statistical sense but apparently the underlying relationship forms a directed loop violating the properties of a function here a soil moisture level can correspond to two or more different values of streamflow and the true value is dependent on the direction of the loop and whether the catchment is in a drying or wetting phase the simplification reduction of a hysteretic relation into a functional relation may be deemed favorable due to the ease of identification and implementation of functions as well as their lower computational cost in practice a monotonic function is used and the dispersity of the data points around the fitted function is interpreted as uncertainty in the relationship for example the residuals difference between the function outputs and observations may be used in regression type analyses to generate confidence limits although they would be auto correlated and possess a strong pattern the dynamic properties of hysteretic relationships and their reproduction have arguably received limited or no attention fig 3 d shows the derivative i e sensitivity of streamflow with respect to soil moisture dq ds for different values of soil moisture the true hysteretic behavior of the relation between the soil moisture and streamflow exhibits both positive and negative sensitivities across the range of soil moisture s the fitted monotonically increasing functional relationship however shows only positive sensitivity for any given soil moisture s fig 3 e further demonstrates this behavior by plotting the rate of change in streamflow dq dt versus the rate of change in soil moisture ds dt over time for the fitted function and any other monotonically increasing functions in general dq dt and ds dt are always of the same sign regions 1 and 3 of fig 3 e whereas in reality dq dt and ds dt can take opposite signs as well all four regions 1 to 4 intuitively hydrologists tend to agree that an increase in soil moisture would coincide with result in an increase in streamflow and as such monotonic functions are the basis of many hydrologic models however as shown in fig 3 e the true behavior may run counter to intuition and an increase in soil moisture in a time step can coincide with a decrease in streamflow and vice versa in the following sub sections we look at hysteresis from different perspectives to better understand and characterize its fundamentals and dynamic properties 3 1 memory and path dependency hysteretic systems have been widely referred to as path dependent systems or synonymously systems with memory unlike a system in which the future state depends only upon its present state and forcings the future of a path dependent system depends on the sequence of states preceding the present state here through a physical example we attempt to illuminate the relation between interpretations of a system as being path dependent versus path independent consider an object subjected only to the earth gravitational force a projectile such as a basketball a player throws the ball upward and forward the ball reaches its maximum height and then moves downward and forward towards the basket fig 4 the two dimensional equations of motion can be used to predict the position of the ball at any future time as follows 1 x t k 1 1 2 a x t k δ t 2 v x t k δ t x t k y t k 1 1 2 a y t k δ t 2 v y t k δ t y t k where the position in the two dimensional space is denoted by x t k 1 and y t k 1 at time t k 1 x t k and y t k indicate the position of the ball with respect to the origin at time t k v x t k v y t k a x t k and a y t k represent the velocity and acceleration along x and y axes at time t k given the position velocity and acceleration of the ball at a specific time t k the position of the ball at a future time t k 1 can be calculated δ t t k 1 t k for the sake of simplicity we only focus on the equation of motion along the y axis vertical where the acceleration is only due to gravitational force g then the equation of motion in the y direction can be written as 2 y t k 1 1 2 g δ t 2 v y t k δ t y t k in which the negative sign for the acceleration term indicates the downward earth gravitational acceleration now consider three possible cases case 1 if at the time t k all the terms in the equation including the position y t k velocity v y t k and acceleration g are known then the position of the ball in a future time t k 1 can be calculated fig 4 a case 2 if the acceleration is unknown and only velocity and position of the ball can be measured we need to know the velocity of the ball at another time step in the past t k 1 in order to estimate acceleration and then predict the position of the ball in a future time fig 4 b case 3 if both velocity and acceleration are unknown in the current time step the position of the ball at two preceding time steps t k 2 and t k 1 should be known to estimate the velocity and acceleration fig 4 c according to case 1 the ball is a system where its future positions are only dependent on the current state of the system namely its position and velocity and the external forcing namely gravitational force however examples in case 2 and case 3 demonstrate how lack of knowledge or measurement of one or more components of a path independent system may lead us to treat it as a path dependent system utilizing the information on the previous states of a system may somehow compensate for unknown or missing components and as such the memory length required can be related to the extent of unknown or missing physics in the next section we elaborate on the effect of missing physics on memory and dynamics of a system in the context of hysteresis 3 2 missing physics in relation to hysteresis hysteresis might be a manifestation of missing physics in the representation of a system in this section we elaborate on this point through two examples consider the rod and wagon system displayed in fig 5 in this system the rod can move horizontally to the right and left and when it comes in contact with the wagon it makes the wagon move with it as well example adapted from morris 2012 the following relation describes the position of the wagon x w 3 x w x r d d max 2 where d is the relative position of the rod to the wagon x r is the position of the rod and d max indicates the distance between the right and left walls of the wagon imagine d max is 10 m and the initial x r and x w are both zero this means the rod is located 5 m away from the left edge of the wagon we then move the rod to fifteen positions 5 10 0 10 0 10 0 10 20 10 20 10 20 10 and 0 m we can then find the position of the wagon if we know the relative distance of the rod and the wagon for every rod movement the position of the wagon can be shown in a three dimensional space as a function of the position of the rod x r and the relative distance of the rod and wagon d fig 6 a now imagine for the same case that the internal properties and associated dynamics of this system are unknown or unmeasurable d and d max are unknown then the relationship between the position of the rod and the position of the wagon will be a hysteresis appearing relationship as shown in fig 6 b where a given position of the rod does not coincide with a unique position of the wagon no functional relationship in fact this hysteresis appearing relationship is the projection of the three dimensional function of x w with respect to x r and d shown in fig 6 a onto a two dimensional plane of positions of the rod and the wagon x r and x w this example explains how lack of knowledge missing physics can lead us to infer the existence of hysteresis in a system further it may lead us to consider the system as being path dependent and rely on its past trajectory for prediction fig 6 c shows the position of the rod and the wagon over time for the system trajectory plotted in fig 6 a a lagged looking behavior can be seen in the position of the wagon with respect to the position of the rod and therefore in the absence of a full picture of the system it can be used to provide an estimate of the future position of the wagon given the position of the rod although this estimation is not very accurate even if the full history of the rod and wagon positions is known as a more relevant hydrological example here we focus on a two reservoir nash cascade model fig 7 a with linear reservoir coefficients of 0 2 day 1 assuming no inflow to the bucket the storage is reduced to 83 percent of its initial value in one time step a day the discharge of the model can be written as a function of the two storages q 2 f s 1 s 2 any combination of storages values and their subsequent discharge mark a trajectory in the three dimensional space of s 1 s 2 and q 2 the shape of this trajectory depends on the input time series i and the initial conditions of s 1 and s 2 fig 7 b shows an example trajectory in red for an arbitrary input time series the projection of this trajectory onto the two dimensional space of s 2 and q 2 will be a straight line as shown in black in fig 7 b the reason is that the trajectory always lies on a plane in the three dimensional space as the relationship between s 2 and q 2 is linear however the projection of the trajectory onto the two dimensional space of s 1 and q 2 results in a hysteresis looking relationship in which there are multiple values of q 2 for a given s 1 green line in fig 7 b as such the relationship between the known time series will exhibit a hysteretic behavior because one dimension is missing aggregation or lumping multiple interacting components of a system into one can have implications analogous to losing dimensions as described above and result in hysteretic looking behavior in the nash cascade example aggregation of s 1 and s 2 into one total storage value s t is similar to losing the interaction of the system s internal elements and underlying processes fig 7 c this is basically an example where the heterogeneous properties of a system is not represented in the model overall the simple illustrative examples given in this section explain that hysteresis can be considered as our inability to fully grasp or model the underlying physics and or heterogeneity of a system 3 3 possible missing dimensions physics in water retention and rating curves in this section we discuss two of the most commonly observed hysteretic behaviors in hydrology and the physics that could constitute their missing dimensions contributing to their hysteretic behaviors for the water retention curve explained earlier in section 2 2 and fig 2 a the missing physics can be explained based on the potential energy terms of a volume of soil the total potential energy of soil p t can be written as 4 p t p p p z p g p o in which p p p z p g and p o are the matric the gravitational gas pressure and osmotic potentials respectively or et al 2004 glossary of terms in soil sciences agriculture canada 1976 the terms on the right hand side of the eq 4 are the most commonly used potential terms in the literature for expressing total soil potential every term can be expanded to their subcomponents and empirical relations in typical applications some of the terms of this equation are ignored an example is the water retention curve that characterizes the relationship between the soil matric potential p p and gravitational term p z or soil water content lu and khorshidi 2015 the water retention curve can therefore be seen as a projection of the higher dimensional space described in eq 4 onto a two dimensional space of matric and gravitation potentials this reduction of dimensionality leads to the exhibition of a hysteretic behavior in water retention curves whereas if all potential terms could be measured during the drying and wetting phases the resulting higher dimensional representation might not exhibit any hysteresis two types of models are usually used to describe the hysteretic behavior of water retention curves 1 physically based and 2 empirical models physically based models try to correlate soil particles and soil structure characteristics to the observed hysteretic behavior on the other hand empirical relations make use of the main drying wetting and subsequent scanning curves to reconstruct the hysteretic behavior pahm et al 2005 izady et al 2010 we note that in these modeling strategies the underlying physical components here potential terms are not formally accounted for the hysteresis in the so called rating curve stage discharge relationship can be explained by hydrodynamics here we make use of the one dimensional saint venant equation to elaborate on the physical measurement which enables us to characterize the hysteretic stage discharge relationship 5 1 g u t 1 g u u x ζ x p a τ ρ τ r ρ g where τ u ζ p a ρ and r represent shear stress velocity free surface elevation wetted perimeter area density and hydraulic radius respectively replacing the friction slope in the chézy formula using the diffusive wave derived from the saint venant equation results in 6 q a c r s b h x where q c sb and h x represent discharge chézy coefficient bed slope and pressure gradient along the channel length respectively refer to appendix a for the assumptions and substitutions which result in eq 6 for uniform flow h x will be zero as the pressure gradient along the channel length is zero this simplifies eq 6 to the chézy formula however in the case of a passing wave unsteady flow the term h x is no longer zero the value of h x for the front of the wave is negative thereby increasing the discharge for the same water level compared with the steady state flow condition for the recession limb however this term becomes positive resulting in lower discharge compared with the same water level in the steady flow condition this deviation of discharge from the steady state stage discharge relationship creates the stage discharge hysteresis when observing a passing wave from a stationary point by the open channel we commonly measure h t however to obtain discharge q from eq 6 we need to have an estimation of h x as well which is related to the deformation of the wave as it moves through the channel it should be noted that when h t is zero h x is not necessarily zero for transient flow regimes there have been various simplifications to estimate discharge based on eq 6 a well known approximation proposed by jones 1915 is to replace h x with c h t in which c is celerity of wave in open channels petersen øverleir 2006 in addition note that the chézy coefficient c is not constant during transient flow and its accurate estimation makes the discharge calculation even more challenging 3 4 hysteresis and time scale dependency hysteretic behaviors can be classified as rate dependent or rate independent rate dependent hysteresis refers to the situation where the shape of the hysteresis is dependent on the rate of change of the associated variables in contrast the rate independent hysteresis refers to the situation where the shape of the hysteresis remains the same no matter how quickly the variables are changing in other words a rate independent hysteresis is a type of hysteresis that if one variable is transformed with an affine transformation over time the other variable follows exactly the same transformation mielke 2005 in contrast for a rate dependent hysteresis any affine transformation of one variable will result in a different transformation of the other variable and as a result the shape of the hysteretic relationship will change see to appendix b for more detail in section 3 2 the rod and wagon example exhibited rate independent hysteresis because the relationship between the positions of the wagon and the rod would remain exactly the same no matter how quickly or slowly the rod moves in the nash cascade example however the hysteretic relationship between s 1 and q 2 depends on the rate of change in storage which itself depends on the rate of change in input i to further elaborate on this point let s look at the relationship between s 1 and q 2 for a range of input scenarios with different rates of change all the scenarios begin with an input of 3 mm day 1 for an extended period of time and then reduce to 0 mm day 1 each at a different negative rate of change after a relatively long period of time the input in all the scenarios goes back to 3 mm day 1 at a similar but positive rate for the first scenario the rate of change is faster such that the change in i happens suddenly in one day and for the last scenario the rate of change is slower and the transition occurs over 200 days fig 8 a fig 8b shows the resulting relationships between s 1 and q 2 for these different scenarios of rate of change as can be seen faster rates of change will result in more pronounced hysteretic behaviors whereas slower rates of change will result in narrower hysteretic loops for a system with a very small rate of change the hysteretic relationship approaches a linear function similarly the stage discharge relationship exhibits a rate dependent hysteresis the width of the hysteretic loop varies depending on the rate of change in the water level changes for fast flood waves the hysteretic behavior is pronounced because the term h x in eq 6 is considerable while for a steady flow the stage discharge relationship reduces to a monotonic function as h x approaches zero and can be neglected 3 5 alternative system pathways and its relation to hysteresis suppose the two reservoir nash cascade model of section 3 2 has been under constant forcing i 3 mm day 1 for a sufficiently long period of time such that the system is in equilibrium with no dynamics q2 i and s 1 s 2 15 mm with this initial condition and by dropping the input to zero i 0 the reservoirs go into a transitional phase and become fully emptied after an extended period of time with q2 i 0 mm day 1 now the system is at a new equilibrium state the trajectory or the pathway of this system is shown in blue in fig 9 a along many other possible trajectories starting from different initial conditions shown in gray ending with the same equilibrium now if we force the system again with the constant input of i 3 mm day 1 the system will go in a new transitional phase towards the previous equilibrium state where q2 i and s 1 s 2 15 mm fig 9 b however the transitions between the two steady states are through different pathways the projection of these pathways onto the two dimensional space of s1 and q2 forms a directed loop this example illustrates that the shape of the pathway and the direction of the loop is related to the direction of change in the state of the system in real world hydrology forcings are stochastic and changing over time and as such catchments are always in transition via a variety of non unique pathways to reach a steady state which can result in a variety of hysteretic relationships with complex forms 4 modeling hysteresis in hydrology 4 1 data driven approaches 4 1 1 empirical indices there have been research efforts to derive empirical indices that characterize the properties of hysteretic behaviors observed in hydrology these indices have been limited only to the characterization of the size and direction clockwise or counterclockwise of the hysteretic loops for single events i e single loops they are often linked and attributed to physical characteristics of the underlying system and their inputs to address the hysteretic relationship between suspended sediment and discharge langlois et al 2005 proposed the following hysteresis index that measures the ratio of the areas under the falling and rising limbs of a hysteretic loop as shown in fig 10 a 7 h index 1 x min x max y r x min x max y f in theory this ratio lies between zero and positive infinity with a value close to one indicating a narrow hysteretic loop weak hysteresis the direction of the hysteresis loop is clockwise when this hysteresis index is greater than one and counter clockwise when less than one lawler et al 2006 introduced a similar hysteretic index that only measures the fatness or thickness of the hysteretic loop at a specific value of x that might be chosen rather arbitrarily fig 10 a they suggested using the mid point of the range of observations of x data as follows 8 h index 2 y r x 0 5 y f x 0 5 there are other hysteresis indices in the literature that are effectively the same as the ones in eqs 7 and 8 for example lloyd et al 2016a b and zuecco et al 2016 suggested normalizing data before calculating these indices they also utilized a combination of the two indices to classify hysteretic behaviors both based on the area covered by rising and falling limbs and also hysteresis fatness at different intervals between the minimum and maximum values of x fig 10 b overall these event based indices have limited utility for complex multi event records of hysteretic behavior 4 1 2 preisach operators preisach operators are classic tools to represent rate independent hysteresis behaviors and consist of a finite sometimes infinite number of elements called hysterons preisach 1935 each hysteron is a hysteretic relation that reflects on both the current input as well as the history of the input a simple counterclockwise hysteron β α can be expressed in the following form 9 y t α β x t 0 x t α k k 1 if y t 1 α β 1 k 0 if y t 1 α β 0 α x t β 1 β x t where α and β are the parameters that indicate the lower and upper limits of the hysteron deactivation and activation respectively the hysteron output is one when input xt is higher than β and zero when it is lower than α the output will be the same as on the previous time step when the input is between α and β the functioning of a hysteron is the same as that of the non ideal relay for controlling cooling systems discussed in section 2 1 hysterons can be more complex with more parameters than the one presented above interested readers are referred to janaideh et al 2008 for a review the collection of hysterons forms a preisach half plane shown in fig 11 a each hysteron is assigned a value µα β that represents the contribution of that hysteron to the calculated output of the preisach model this output is the summation of the multiplication of the hysteron output with the assigned contribution for every hysteron the preisach operator has some commonality in concept to feedforward neural networks zakerzadeh et al 2011 with the difference being that each node of a preisach model contributes to the final result in a hysteretic fashion hysteron activation and deactivation is achieved using two rules in a preisach half plane rule 1 applies to an increasing input x which causes inactivated hysterons to be activated horizontally and already activated hysterons to continue to be activated rule 2 applies to a decreasing input which causes activated hysterons to be deactivated vertically depending on the input value an example of a preisach half plane is presented in fig 11 b with the activation and deactivation rules explained the contribution of each hysteron is indicated in the preisach half plane at the beginning the input is 0 and no hysteron is activated consequently the output is also 0 when the input increases to 3 and based on the first rule rule of activation 6 hysterons will be activated and the output will be the summation of the contribution of each hysteron which will be 2 1 when the input decreases to 1 only three hysterons remain activate following the second rule rule of deactivation and therefore the summation will be 0 7 similarly when the input increases to 2 four hysterons will be activated and the output will be 1 0 when the input increases to 4 all the hysterons will be activated and the output reaches to its maximum value of 5 5 when the input returns to 0 all the hysterons will become deactivated and the output reduces to 0 the resulting hysteresis is depicted in fig 11 c the preisach operator explained above reproduces rate independent hysteresis however when it is combined with a mass balance equation we can show the collective system will reproduce rate dependent hysteresis as well not presented here for the sake of brevity o kane and flynn 2007 also mentioned this behavior similarly the combination of a rate independent hysteretic water retention curve and the conservation of mass equation results in a model that mimics the rate dependency of the system there are a few studies in the hydrologic literature where preisach operators have been used to introduce hysteretic components to terrestrial hydrologic models o kane 2005 and similarly o kane and flynn 2007 showed that the preisach operator which was partly constructed based on the van genuchten formula van genuchten 1980 is able to reproduce the grizlly data set between soil water content and soil suction head the best performing preisach operator was then used in the fully vegetated slab of soil and transpiring plants fest model o kane 2005 appelbe et al 2009 4 1 3 other empirical approaches in addition to the preisach operator independent and dependent domain theories and their modifications everett and whitton 1952 topp 1971 are used as empirical tools for hysteresis modeling these theories are based on the assumption that hysteresis is a result of the combination of many smaller elements called domains in general and similar to preisach operator the independent domain theory between the soil suction head and soil moisture can be expressed as 10 θ f ψ w ψ d d ψ w d ψ d in which f is a joint probability distribution based on drying ψ d and wetting ψ w processes for the domains of soil pore space independent domain theory assumes that each domain is acting independently from its neighboring domains for soil this translates as if an empty space is filled and emptied with water regardless of the dryness and wetness of its neighboring pores to account for this dependency dependent domain theory has been exploited as mentioned by mualem and dagan 1975 the generalized form of dependent domain theory for water retention curve can be written as 11 θ p d ψ w ψ d θ ψ p w ψ w ψ d θ ψ f ψ w ψ d d ψ w d ψ d where p d and p w are the weights which correct for the effects of neighboring domains as a functions of the wetting ψ w drying ψ d suction head ψ and soil moisture θ the challenge of the dependent and independent domain theories similar to the one of the presacih operator is the approximation of p d p w and f based on an observed water retention curve its main drying and main wetting curves as well as screening curves pham et al 2005 artificial neural networks anns have been also used to reproduce hysteretic relationships an ann is an interconnected group of nodes the input node s input variables are connected to the output node s output variables through a set of hidden node s organized in hidden layer s each node is characterized by a set of weights and an activation function that are inferred based on the data anns have been widely used in the context of hydrological modeling as it is suitable for cases when underlying physical characteristics of a system is not well known the ability of anns in reproducing hysteresis for different processes in hydrology have been demonstrated nourani et al 2013 bhattacharya and solomatine 2005 in this case anns need to be enabled with a tapped delay line which provides a memory to the model razavi and karamouz 2007 4 2 process based approaches there have been recent efforts to relate different hysteretic behaviors to the underlying physical processes using interconnected functional components fovet et al 2015 modelled the observed hysteresis of saturated storage at hillslope and riparian areas with streamflow by using a range of models they showed that a conceptual model with enough components to differentiate between riparian area and hillslope could reproduce the observed hysteresis in the data shook et al 2013 introduced a conceptualization of a set of interconnected lakes in the canadian prairies they simplified the interconnection of lakes in their study area to a tree of nodes each node representing a lake with a threshold behaving gate keeping characteristic phillips et al 2011 by such a model structure they were able to reproduce one of the most challenging hydrological processes in prairie regions namely the fill and spill mechanism spence 2010 mengistu and spence 2016 showed the ability of an already existing hydrology and routing model in reproducing hysteresis between the contributing area and discharge in the canadian prairie potholes regions the application of full continuity and momentum equations or their simplifications can also be used to reproduce the hysteretic behavior at desire scale davies and beven 2015 investigated the effect of spatial scale on the shape of hysteresis by artificially scaling a catchment model and its discretization they used the multiple interacting pathways concept mips approach davies et al 2011 davies and beven 2012 at the grid scale to generate the storage discharge hysteresis of the catchment di baldassarre and montanari 2009 reconstructed the stage discharge relationship for the po river in italy during flood events by simulating the river physics via a one dimensional hydraulic model the aforementioned studies including examples presented in section 3 2 show that a combination of functional relationships can enable models to reproduce hysteresis at the scale of interest at the scale of modelling in other words for modelling the hysteretic behavior at a specific scale the model components at a smaller scale should not necessarily be hysteretic 4 3 the spectrum of modelling approaches with respect to hysteresis despite the attention that hysteresis modeling in hydrology has attracted there have been limited efforts to design and incorporate hysteretic components into hydrologic models to account for small scale hysteretic processes for example the famous hysteretic relationship between soil moisture and soil hydraulic conductivity i e the existence of different values of hydraulic conductivity for a single value of soil moisture is represented as non hysteretic in all basin scale models van genuchten s van genuchten 1980 or brooks and corey s brooks and corey 1966 empirical functions are used with an approximation of richard s equation to simulate flow of water in unsaturated soil not formally addressing hysteresis might be a shortcoming of the current generation of hydrologic models as mentioned in previous works e g beven 2006 o kane 2005 in general little progress has been made in characterizing the significance of hysteresis and its explicit inclusion in hydrologic modelling and to the authors knowledge the existing models consisting of hysteretic components have only been applied at plot scales a few meters appelbe et al 2009 in sections 4 1 and 4 2 we presented a range of strategies from data driven to process based which can be used for hysteresis modeling it is modelers choice which approach to use given the nature and the purpose of the modeling in theory any model choice lands somewhere in a modeling spectrum that spans a range from fully data driven approaches to fully physically based process based approaches fig 12 an example study of the data driven end point of this spectrum is the work of subehi et al 2010 that only relied on hysteretic indices to explain the relationships between discharge and stream flow temperature westhoff et al 2011 on the other hand tried to explain this relationship by an almost full dimensional representation of a headwater stream the data driven modelling can reproduce hysteresis only at the full scale of a system the scale of the system s input and output data and lacks any representation of hysteretic processes at any scale lower than the modeling scale on the other hand a full dimensional physically based model in theory should be able to reproduce hysteretic processes at any scale from pore scales to watershed scales the development and application of such models of course remains far fetched to be practical therefore the current generation of physically based models can represent hysteresis only at a limited range of scales this is because as previously discussed the collective behavior of a set of non hysteretic components can be capable of reproducing hysteresis at scales larger than components scale the existence of hysteresis at scales that are smaller than the scale of model non hysteretic components can introduce uncertainty to modelling results this source of modelling errors has remained fairly unexplored in the following section we try to investigate this source of errors and how it propagates from the model component scale to the system scale via a synthetic case study 5 the significance of the inclusion of hysteretic components in modelling and the role of model structure parameterization and calibration as shown in the case of a nash cascade model a model consisting of multiple non hysteretic components e g buckets or control volumes can exhibit a hysteretic behavior when only a sub space of its full dimensional space is observed this suggests that models if configured parameterized and tuned properly might be able to reproduce a hysteretic behavior of interest and compensate for the lack of hysteretic components in the following and through a synthetic example we investigate whether or not a model with deterministic functional relationship can approximate the behavior of a model enabled with hysteretic components at different scales this example uses a distributed hydrologic model with six grid cells fig 13 a each grid cell consists of three layers i e buckets or control volumes connected in a cascade fashion fig 13 b the flux from each grid cell q g in fig 13 b is routed using a convolution function presented in fig 13 c to the catchment outlet refer to appendix c for the details of the convolution function used in this study the length of the convolution function is proportional to the distance between the grid cell and the outlet and is identified by the first numbers in the parentheses in fig 13 a the catchment is assumed to be forced by a heterogeneous rainfall field identified by the second set of values in the parentheses in fig 13 a a bucket is effectively a control volume which might be deemed the simplest possible element of conceptual rainfall runoff modeling and in a more physically based model it can be seen to be equivalent to a soil layer in general the governing mass balance equation for a bucket control volume is d s d t q in q out where d s d t is the rate of change in storage over time and q in and q out are the input e g rainfall and infiltration from the upper layer and output e g infiltration to the lower layer or lateral flow respectively q out is typically described as a function of storage s 12 q out f s the function f can take a variety of forms and for this study we assumed it is the product of storage and the reservoir coefficient k which is itself a function of the storage 13 q out k s s now to investigate the effect and significance of including hysteretic components in this model we used a hysteretic operator ƥ s built upon the concept of preisach we replaced k s in eq 13 by ƥ s thereby creating a hysteretic relationship between the storage and output flux fig 13 d shows a schematization of k s and ƥ s in red and blue respectively in the designed preisach operator α and β are from the same dimension as that of the storage mm and the weights of hysterons µ values for the preisach half plane are from the same dimension as that of the reservoir coefficient day 1 the strength of the hysteresis created by the designed preisach half plane is controlled by parameter m we also generated a 4 parameter functional approximation that best fits the designed preisach operator a description on the construction of the preisach half planes and their functional approximations is presented in detail in appendix d we investigated the differences in simulated results of the same model enabled with different hysteretic components in terms of hysteresis strength controlled by m and their functional approximations figs 14 15 and 16 the differences in total streamflow at the outlet q t at the grid scale q g and at the first layer q 1 are quantified using the root mean square error metric i rmse fig 14 a similarly the differences in storage at the first layer s 1 at the grid scale s g s 1 s 2 s 3 and for the entire catchment average storage over all grids s t are quantified fig 14b as expected the simulated fluxes and storages with hysteretic components and their functional approximations diverge as we increase the strength of hysteresis the model results with functional approximation serve as a benchmark which provides insight into the effect of model configuration the three layered grid and six grid cells and river routing the lag functions used for routing without any embedded hysteretic components it should also be noted when m is set to 1 the hysteretic component and its functional approximation are effectively the same fig 15 a b and c show the relationships between the discharge and storage at the layer grid and catchment scales respectively for the models without and with hysteretic components m 10 at the layer scale the two simulations are different by design one is hysteretic and the other one is not no looping behavior but even the model without the hysteretic components exhibits a hysteretic behavior at the grid and catchment scales and this hysteretic behavior largely follows that of the model with the hysteretic components this example points at the role of model structure to partially reproduce a desired hysteretic behavior of hydrologic systems a non hysteretic model structure of a hydrologic model when combined with proper parameterization and calibration may be able to better reproduce a desired hysteretic behavior to evaluate this we perturbed the four parameters of the functional relationship within their ranges as specified in table d1 to generate an ensemble of simulations under a variety of parameter configurations then we compared the resulting time series of q 1 q g q t s 1 s g and s t with those of the hysteretic model runs with m values of 1 no hysteresis 2 5 and 10 fig 16 a b and c show the performance of each ensemble member compared with the result of the hysteretic models as can be seen the cloud of points moves away from the best fit the origin for larger m values indicating that the ability of parameterization and calibration degrades when the hysteretic component amplifies fig 16 d e and f show the best performing non hysteretic model results corresponding to the best i rmse for both q and s in reproducing the hysteretic behavior of the model with hysteretic components m 10 comparing these plots with fig 15 demonstrates some improvement in reproducing the hysteretic behaviors at the grid and catchment scales which can be attributed to calibration 6 discussions 6 1 a hydrologically relevant definition for hysteresis hysteresis can be seen as a manifestation of a lack of full process representation in hydrology the full process representation requires involving all the physical variables and their dynamics within a process yet a full dimensional representation of many hydrological processes is non trivial this results in a lower dimensional representation which is geometrically analogous to projecting mapping a high dimensional space onto its sub space i e a lower dimensional space a function in a high dimensional space when projected onto a lower dimensional sub space can appear as a hysteretic relationship this can be seen as a form of epistemic uncertainty in hydrology where our understanding of a process is not near full dimensional representation 6 2 is hydrology path dependent we showed how a lack of knowledge or data about a system might lead us to treat it as a path dependent system and to rely on its history to capture the missing elements to predict the future of the system s behavior see section 3 1 hydrology has frequently been deemed or assumed to be path dependent and as beven 2006 formulated 14 q f s p d t where q represents the discharge of a catchment at time t s and p are vectors of storage and precipitation notations s and p used by beven 2006 at the current and previous time steps history and dt indicates the time increments this formulation has proven useful particularly when dealing with hysteresis in the absence of a full picture of all processes and their interconnections the model however would not be path dependent if we could identify and formulate a proper model structure that represents the interconnected components of the underlying system for example instead of having a time based vector time series of state variables s in eq 14 for a single control volume that represents a heterogeneous domain we could have an improved representation of that heterogeneous domain by introducing an adequate number of control volumes and their interconnections to the model structure that way the formulation would only require the current state of those interconnected parts rather than the history of their collective behavior in an ideal physically based model all the model components and parameters are known and therefore no calibration is needed the future state of the system is only dependent on its current state and forcings on the other hand in the context of data driven models such as artificial neural networks or statistical time series models refer to bárdossy and hörning 2017 the calibration training of the model on historical data is often conducted in a way that treats the system as path dependent 6 3 missing physics and the notion of state space representation the term missing physics in this paper is used to refer to missing kinematic and or dynamics in the representation of a system the distinction between the two can be explained by the notion of state space representation of a system where the evolution of the system is described by a set of first order differential equations kinematics is related to the degrees of freedom of the system trajectory characterized by the size of the state vector while dynamics is about the properties of the right hand side of the differential process equations missing kinematics to describe a physical system is analogous to missing dimensions in the state vector while missing dynamics is about the inability of the process equations right hand side of the differential equations to fully capture the true dynamics of the system a perfect representation of a system indicates a perfect representation of both kinematics variables involved and dynamics time dependent relationships between the variables of the system such a representation would be equivalent to what we referred to as fully dimensional physically based model in section 4 3 on the other hand a data driven model in that section refers to a representation that only deals with the kinematics of the system and attempts to relate them empirically note that this analogy to state space representation may be generalized to systems described by higher order and or partial differential equations 6 4 should we include hysteretic components in our models in this study we tried to investigate the need for models which formally include hysteretic components through a synthetic example while the analyses based on this example may not be comprehensive and conclusive we argued that a model if complex enough is able to reproduce the hysteresis at the scale of modeling it might not be necessary to include hysteretic components in a model as the model structure in combination with parameterization and calibration can mask the possible effect of smaller scale hysteretic processes we further argued that the practical hydrologic models lie between data driven and physically based end points of a modeling spectrum section 4 3 while it may be impractical to develop a full dimensional physically based model which encapsulates all physical processes at various scales when required hysteretic processes smaller than the scale of model components can be replicated by data driven approaches section 4 3 fig 12 6 5 hysteresis requires a causality context not every loop looking relationship may constitute a hysteretic behavior and be referred to as hysteretic in the absence of any causation for example the stream flows from two adjacent catchments may be correlated and from a loop when plotted against each other where there is no cause and effect relationship between elements of the two catchments in principle the two catchments might have different rainfall runoff mechanisms and the observed correlation might result from the same cause e g the same rainfall pattern in general any observed correlation may require some causality context to be the basis for developing relationships in hydrology establishing a causality relation is fundamental to the physical sciences and falls under the philosophy of the science of physics for further reading refer to bohm 2005 6 6 spatio temporal dependency of hysteresis as mentioned in section 3 4 hysteresis is a time scale dependent concept rate dependency there have been multiple observations reported in the literature that a hysteretic relationship might change over time for example mcguire and mcdonnell 2010 observed that the hysteretic relationship between the contributions of a local hillslope versus the total catchment to streamflow changes from clockwise to counterclockwise when the catchment saturation level increases beyond a threshold similarly lloyd et al 2016a showed that the direction of the hysteretic relationship clockwise or counterclockwise between phosphorus concentration and discharge changes over different seasons it should be noted that these examples are not related to the rate dependency of hysteresis rather they are the result of change of system characteristics such as storage or antecedent soil moisture over time our analysis in section 5 indicates that hysteresis is spatial scale dependent as well from one layer to grid scale and to the entire synthetic set up however the spatial dependency of hysteresis is more difficult to be understood and predicted across different scales in comparison with its temporal dependency this difficulty arises from the complexity of interactions of elements at smaller scale processes to form the collective system s behavior at a desired larger scale although recent studies such as that by davies and beven 2015 showed through a synthetic case that the shape and significance of hysteresis between streamflow and catchment storage changes across scales a general conclusion regarding this dependency might be far fetched 6 7 treatment of uncertainty as stated above hysteresis in hydrology is due to our incomplete knowledge or representation of hydrological processes this incompleteness results in epistemic uncertainty in hydrologic systems identification and subsequently in predictions this uncertainty manifests itself as systematic auto correlated errors between model simulation and observed data in a model where functional relationships are used to approximate hysteretic relationships for example fig 3 b shows how the functional approximation results in auto correlated residuals where for the rising limb the residuals tend to be positive and for the falling limb they tend to be negative 7 conclusions in this paper we synthesized and analyzed the theory fundamentals and implications of hysteresis in hydrological sciences and beyond we conclude this paper by re iterating the following remarks hysteresis in hydrology is a manifestation of a lack of complete knowledge or representation of physics involved in a process hysteresis may not be attributed to path dependency or memory effect in most hydrological processes however in the absence of sufficient knowledge or data utilizing the history of a process can be helpful in predicting its future hysteresis in hydrology is rate dependent meaning that the time scale of observation and or analysis controls the strength and characteristics of the induced hysteresis hysteresis in hydrology is scale dependent meaning that the effect of small scale hysteretic processes may or may not contribute to the hysteretic processes at larger scale model structure and parameterization can be designed in a way to reproduce some observed hysteresis at the scale of modeling this reproduction may not be exact however at the end we recognize that some of the ideas presented in this paper are those of the authors and may be open to question we hope that the hydrologic community will contribute to this discussion and help us better understand characterize and simulate the underlying hydrologic processes that manifest themselves as hysteresis acknowledgement the authors would like to thank alan barr from environment and climate change canada eccc and andy black from university of british colombia who provided us with the data used in fig 3 the authors would also like to thank andrás bárdossy vazken andréassian alberto montanari demetris koutsoyiannis fabrizio fenicia todd rasmussen hubert savenije hoshin gupta mohammad al janaide kevin shook christopher spence james craig and andrew ireson for their constructive comments and fruitful discussions on the presented work this work was financially supported by canada excellence research chair in water security and razavi s nserc natural sciences and engineering research council of canada discovery grant appendix a saint venant system of partial differential equations which describe the 1 d incompressible flow in an open channel is a 1 1 g u t 1 g u u x ζ x p a τ ρ τ r ρ g a 2 a t a u x 0 in which g τ u ζ p a ρ and r represent gravitational acceleration shear stress velocity free surface elevation wetted perimeter area density and hydraulic radius the terms u t u u x and ζ x represent local acceleration convective acceleration and pressure force respectively ζ the surface elevation can be expressed as the summation of the bed elevation and water depth a 3 ζ z b h in which the z b is the elevation of the channel bed and h is the water depth the right hand side of eq a 1 can be expressed as friction gradient and the third term of the left hand side can be expanded using eq a 3 a 4 1 g u t 1 g u u x h x z b x s f in which the term z b x is the bed slope s b and therefore eq a 4 can be written as follow a 5 1 g u t 1 g u u x h x s b s f when discharge q varies slowly and changes in cross sections along the channel is minimal both local and convective acceleration can be ignored this simplifies the fully dynamics wave eq a 5 to diffusive wave a 6 h x s b s f the chézy formula expresses discharge q as a 7 q a u a c r s f in which s f and c represent the friction slope and chézy coefficient respectively the friction slope can be replaced from diffusive wave eq a 6 into the chézy formula eq a 7 resulting in a 8 q a c r s b h x appendix b in fig b1 a and b an imaginary input and its corresponding output are illustrated in blue the input and output time series show a hysteretic relation depicted in fig b1 c if the input to the system undergoes an affine transformation over time by a factor of 0 5 compressed to half of its actual time two option for the output can be considered 1 the output follows exactly the same affine transformation fig b1 b in red or 2 the output differs from the affine transformation fig b1 b in dashed red the hysteresis generated in the first situation when the output follows exactly the same transformation as input will be identical to the original hysteresis fig b1 d this mean the hysteresis presented in fig b1 c and d will be exactly the same the system that generates exactly the same hysteresis under affine transformation is said to be rate independent in contrast if the output of the system does not follow exactly the same affine transformation the input went through compare fig b1 c and e the system is considered to be rate dependent appendix c the lag or the convolution function used in section 5 is based on an increasing linear function it distributes the current flux proportionally to current and future time steps figure c1 a c e and g show the effect of four lag functions with various time length of 1 2 3 and 4 days for a flux with magnitude of one over one day or one time step similarly the effect of these lag functions have been shown in fig c1 b d f h appendix d the hysteretic components used in section 5 were built based on the concept of preisach operator section 4 1 2 the operator ƥ is a summation of a constant value k min and a preisach operator ƥ d 1 ƥ s k min ƥ s the preisach operator was built based on a sinus function d 2 k s k min s s min k min k max k min 2 1 sin s s min s max s min π π 2 s min s s max k max s max s the difference between the upper and lower values of k s bounding a set of hysterons located horizontally between lines y x and y mx are distributed uniformly across those hysterons as an example fig d1 shows a preisach half plane built with resolution of 4 mm in this example k min k max s min and s max are set to 0 2 day 1 0 4 day 1 10 mm and 50 mm respectively we also assume m equals 3 meaning that the hysterons between y x and y 3x have weights more than 0 and outside of this range their weights are set to be 0 in this figure weights of each hysteron between the values of 40 and 44 is equal to k 44 k 40 8 which is approximately 0 0023 day 1 the number 8 in the denominator indicates the number of hysterons between y x y 3x and bounded by 40 and 44 the red rectangle in fig d1 in this study we made use of four different preisach half planes with k min k max s min and s max fixed at 0 2 day 1 0 4 day 1 10 mm and 50 mm respectively and m values of 1 2 5 and 10 the resolution of the preisach half plane was set to 2 5 mm the relationship in fig d2 shows the preisach half planes and their hysteretic relationships for a consecutive rising and falling limb in blue the red lines indicate the approximation of hysteretic behavior the best function was obtained by 10 000 samplings of k min k max s min and s max given their ranges in table d1 and selecting the best values based on root mean square error i rmse when compared with the hysteretic relationships these functions were used for comparing the effect of hysteretic components and its functional approximation in the synthetic case study presented in section 5 
6958,we propose a novel analytical approach that provides a simple integrated tool for assessing the effects of hydroclimatically driven flow regime variations on fish habitat average habitat quality metrics can be predicted effectively by an analytical equation this is the result of the integration of two functions describing a the flow regime the frequency distribution of discharge and b the relationship between discharge and habitat quality we applied this approach as a proof of concept to a simple model of velocity thresholds for juvenile salmon fry the flow regime was described by a gamma distribution with physically meaningful parameters derived using a mechanistic stochastic approach that explicitly links the flow regime to hydro meteorological conditions and catchment wetness under different flow conditions habitat quality was estimated using hydraulic habitat models an empirical analytical function was then used to describe the relationship between specific discharge and habitat quality six river channel reaches characterized by different bed geometry and morphology were investigated four reaches are located in the girnock burn a natural upland river in the north of scotland while the remaining two reaches are located in the river lyon in the central highlands of scotland that is heavily regulated for hydropower production results show that the stochastic model and the analytical function applied each containing three parameters successfully described girnock in both dry and wet years and lyon naturalised flow regimes and captured the relationship between available habitat and specific discharge reasonably well for each site we obtained heat maps linking climatic and landscape features to bi monthly average available habitat these maps can provide clear generalised insights into the potential effects of hydroclimatic variations on metrics of fish habitat and have potential for wider applications using more complex habitat model keywords atlantic salmon habitat suitability flow regime analytical approach hydroclimatic variability stochastic model 1 introduction freshwater ecosystems are particularly sensitive to hydroclimatic variability and the likely effects of climate change and this has potential implications for aquatic organisms ormerod 2009 likely impacts may include changes to flow regimes poff and zimmerman 2010 increased water temperatures beechie et al 2013 and water quality changes miserendino et al 2011 the primary effects that variations in flow regime have on in channel hydraulics indexed by the spatial and temporal distribution of water velocity depth and wetted area dictate that it is a key control on fish habitat ahmadi nedushan et al 2006 indeed hydrological extremes of floods and droughts can have a significant impact on fish growth and mortality elliott et al 1997 the last decade has seen numerous attempts to assess the effects of hydroclimatic variability and climate change on flow variability and fresh water organisms including salmonids for example in the mink brook a tributary of the connecticut river new hampshire nislow and armstrong 2012 investigated the effects of high and low summer flow regime on 0 age atlantic salmon fry linking flow regime to summer growth and finding that fish grew best in wetter summers lobón cerviá and bradford 2014 utilised long term hydrologic and fish data to investigate the relationship between annual survival and recruitment of brown trout salmo trutta with several environmental variables in contrasting sites of the rio esva spain they demonstrated that annual survival and recruitment were equally maximised by intermediate discharge and that their relationships were well described by parabolic curves alternatively jensen and johnsen 1999 in the river saltdalselv northern norway looked at the effects of high spring floods on both juvenile salmon survival and growth and discovered that in years with high peak spring floods salmon parr grew less though for 1 year or older parr mortality is not significantly affected by discharge peaks climate change predictions and future hydroclimatic conditions on which such predictions are based are rather uncertain this uncertainty is the consequence of several factors including model errors initial conditions forcing errors and the uncertainty linked to general circulation models gcm and to the downscaling method that is used to obtain predictions at a catchment scale chen et al 2011 capell et al 2013 haddeland et al 2014 van schaeybroeck and vannitsem 2016 in fact habitat models assessing climate change effects on fish populations often utilise as inputs very uncertain regional predictions where in some cases even the direction of change is not known bates et al 2008 goode et al 2013 to assess the uncertainty related to climate change predictions habitat models have been commonly applied to a set of most probable scenarios e g muñoz mas et al 2016 papadaki et al 2016 however as the number of scenarios is usually limited these models are unable to provide catchment managers with understanding the uncertainties of climate change predictions in relation to current hydroclimatic variability fish are adapted to in this context more general methods analytically linking the variability of hydroclimatic conditions with metrics of fish habitat quality could provide managers with an evidence base for conservation plans not simply relying on a few most likely scenarios but based on the context of known variability probability based models have been widely used to describe the distribution of hydrologic and climatic data botter et al 2007 husak et al 2007 this has shown that certain types of probability distributions provide remarkably good fits for specific environmental variables for example the gamma distribution is often an appropriate descriptor for daily precipitation and discharge data while a normal distribution might be good for describing the frequency distribution of daily air temperature data in this context we propose a parsimonious analytical approach that combines analytical functions describing river flow regimes based on a stochastic method proposed by botter et al 2007 and metrics of habitat quality which can be derived from detailed ecohydraulic surveys e g fabris et al 2017 buddendorf et al 2017 the stochastic model has three parameters describing the hydro climatic conditions and the effects of morphological and hydrological attributes on water routing at a catchment scale these parameters allow an analytical description of the effects of hydroclimatic changes on flow regime to characterise past flow regimes parameters can be directly estimated based on climatic and landscape data botter et al 2013 a wide range of habitat models are available and are variously used depending on species life stage of interest and available data acreman and dunbar 2004 in theory any habitat model can be utilised and integrated with an appropriate function that approximates the relationship between habitat quality and discharge in the study reported here simple hydraulic models based on velocity thresholds for juvenile salmon were used as a proof of concept e g fabris et al 2017 buddendorf et al 2017 alternatively though for a first screening or when data are limited general instream habitat models can be used as a first approximation to derive the discharge habitat quality relationship lamouroux and jowett 2005 the effects of hydroclimatic variations on average habitat quality can then be assessed by evaluating the effects that stochastic model parameters have on habitat a more simple and intuitive though equivalent approach involves building heat maps relating meaningful flow regime statistics e g mean flow and variability with average habitat quality as in the example we present by analytically linking habitat quality to hydroclimatic variables and flow regime characteristics such models can therefore provide general insights into the effects of hydroclimatic variations on in stream habitat the main advantage of such approach is that it can extend and generalise the results of hydraulic habitat models and help managers who want to protect freshwater species from climate change effects to take more evidence based decisions based on known hydroclimatic variations independently of uncertain climate change predictions here in our example of model application we use salmon fry salmo salar l newly emerged from eggs in river gravels as a target species due to its ecological and economic importance winfield et al 2004 walsh and kilsby 2007 but also because of the intolerance of this life stage to high flow velocities which under high flow conditions may hinder feeding opportunities or cause fish to be swept away e g geist et al 2000 kynard et al 2000 mallet et al 2000 potential available habitat is used in our example as a very simple metric for habitat quality available habitat was derived by combining 2d hydraulic models with simple velocity threshold the critical displacement velocity cdv above which fish cannot hold position and feeding opportunity and therefore fish growth may be limited graham et al 1996 specifically the aims of this paper are to 1 show how a mechanistic stochastic model based on physically based parameters that depend on hydroclimatic and catchment conditions can successfully describe both variable or erratic and persistent or stable flow regimes 2 describe how analytical functions can be used to conceptualise the relationship between discharge and metrics of habitat quality and 3 provide a simple integrated and generalized approach to assessing the effects of hydroclimatically driven flow regime dynamics based on a metric of fish habitat quality as a proof of concept the method is here applied to investigate the effects of hydroclimatic variations in terms of flow regime on atlantic salmon fry in six contrasting river reaches in the scottish highlands 2 study site overall we investigate six reaches fig 1 four reaches are located in the girnock burn a small undisturbed long term salmon monitoring stream known to provide extensive suitable habitat for juvenile salmon glover et al 2018 the remaining two reaches are located in the heavily regulated river lyon a larger tributary of the river tay scotland s largest river system birkel et al 2014 for the girnock sites the catchment is dominated by heather calluna vulgaris and erica tetralix moorland with some scots pine pinus sylvestris forests only in the lower part of the catchment which has an area of about 32 km2 and ranges in altitude from 230 to 862 m a s l gibbins et al 2002 catchment geology is mainly characterized by granite and calcareous schist which is overlain by glacial drift deposits in the valley bottom soils are dominated by organic rich peaty soils in the riparian area mean air t is 6 3 c with annual precipitation relatively evenly distributed throughout the year of 1000 mm of which less than 10 falls as snow the main stem is 9 km long with an average slope of 0 029 moir et al 1998 and the channel bed is dominated by step pool and plane beds moir et al 2006 the mean daily discharge measured 200 m upstream of the catchment outfall is 0 53 m3 s 1 0 14 cm d 1 with peaks 8 m3 s 1 2 3 cm d 1 the investigated reaches which are extensively described by fabris et al 2017 going from upstream to downstream are iron bridge ib hampshire s bridge hb diagonal fence df and forest automatic weather station faws fig 1 ib hb and df are moorland sites with undercut banks and the riparian vegetation is dominated by heather shrubs while faws is a forest site with well defined banks the remaining 2 reaches lubreoch lu upstream and stronuich st downstream fig 1 are located along the lyon river a highly regulated tributary of the river tay in central scotland utilised for hydroelectric power production since 1958 geris et al 2015 the lyon catchment has an area of 391 km2 that ranges from 92 to 1192 m a s l and its land cover is dominated by moorland with some patches of forest distributed along the river the mean annual precipitation is 2290 mm more than twice that of the girnock burn is evenly distributed throughout the year in winter time a large portion of the precipitation falls as snow especially at the higher elevations geris et al 2015 air temperature ranges from 15 to 25 c the river length is 49 km and has a mean discharge of 12 5 m3 s 1 0 28 cm d 1 measured at the outlet section of the catchment the lyon sites are extensively described by buddendorf et al 2017 lu and st are both characterized by a flat plane bed with the presence of some large roughness elements banks are covered by grass with no presence of trees or shrubs the geometry longitudinal length and width the slope and the roughness of all the sites investigated are reported in table 1 bathymetric surveys of each site and their detailed characteristics are described by fabris et al 2017 girnock and buddendorf et al 2017 lyon average site width was calculated by dividing the wetted area by its length under mean discharge conditions mean daily discharge recorded and scaled for each site in proportion to its drainage area slope has been calculated as the average slope of the water surface while roughness was computed as a detrended standard deviation of bed bathymetry using topcat tool olsen et al 2012 3 method for our purposes the flow regime is defined as the frequency distribution of river flows for a particular period of interest which can be described using a gamma distribution according to the stochastic model proposed by botter et al 2007 2013 the version of the model that we utilised contains three parameters that are not simply calibrated against observations but are explicitly related to climatic and catchment conditions allowing a direct linkage of the flow regime variation to rainfall inputs and catchment wetness conditions for the current study we defined the flow regime for the fry post emergence period may june a second analytical function is then utilized to relate the habitat availability metric of habitat quality for our example to specific discharge this relationship is based on habitat availability produced by detailed hydraulic modelling described fully by fabris et al 2017 parameters in this case are calibrated against simulated values and do not have clear physical meaning hence an average value of the available habitat for the period of interest is obtained integrating the product between these two functions in the case we focus on a simple metric for fry habitat but the approach is generic and can be used with any other habitat models dependent on flow 3 1 flow regime p q the flow regime for the post hatch period may june which is one of the most flow sensitive periods for newly emerged small juvenile salmon fry average length of fry caught in the girnock during electrofishing 4 8 cm is represented by a probability density function according to a mechanistic stochastic model in which streamflow q l t 1 dynamics are assumed to be driven by a catchment scale soil water balance forced by stochastic daily rainfall inputs botter et al 2007 in this context runoff events result from the modulation of daily rainfall inputs according to the antecedent wetness of the catchment soils rainfall is modelled as a spatially uniform marked poisson process with mean depth α l and mean rainfall frequency λp t 1 although α quantifies the average daily intensity of rainfall events the runoff frequency λ is smaller than the underlying precipitation frequency λp because any soil water deficit created by evapotranspiration et in the rooting zone needs to be satisfied before water is routed to streams effective rainfall is consequently modelled as a spatially uniform marked poisson process with mean depth α l and mean runoff frequency λ t 1 therefore λ by accounting for the et crucially embeds rainfall attributes soil vegetation properties and other hydroclimatic variables such as temperature humidity and wind speed the time scale of the hydrological response defined as the mean water retention time in the upstream catchment is operationally identified by the inverse of the recession constant k t 1 observed during recessions conveniently assumed to be exponential this allows simulation of the slow release of water from the soil and underlying aquifers to assume that the entire catchment is modelled as a linear reservoir botter et al 2007 the term k quantifies the effect of catchment scale morphological and hydrological attributes controlling water routing high k values imply low duration of the flow pulses released from the catchment after rainfall typical of fast responding catchments the shape of the distributions is determined by the ratio λ k we distinguished between erratic dry and persistent wet flow regimes erratic flow regimes are characterized by exponentially shaped frequency distributions with high frequencies for very low flows that monotonically decrease with q λ k 1 while persistent conditions are characterized by bell shaped frequency distributions with an increase of frequency with q until a maximum after which frequencies begin to decrease increasing q λ k 1 the model allows an analytical expression of the streamflow probability distribution p q botter et al 2007 1 p q α k λ k γ λ k q λ k 1 e x p q α k that can be written 2 p q μ cv 2 cv 2 γ cv 2 q cv 2 1 e x p q μ cv 2 with 3 μ α λ 4 cv k λ where μ is the mean and cv is the coefficient of variation of the specific discharge cv also known as relative standard deviation represents a standardized measure of dispersion of a probability distribution around the mean table 2 shows the ranges of the parameters for the girnock and the lyon respectively 3 2 available habitat ah q the spatial distribution of water depth and velocity and therefore the available habitat ah in river channels are largely determined by the interactions of q and bed morphology leopold and maddock 1953 in this example to determine ah under different q we utilized a simple approach based on a critical displacement velocity index cdv which represents a velocity threshold above which juvenile salmon are unable to hold station and fish feeding activity may be impeded tetzlaff et al 2005 cdv depends upon fish size and stream temperature and was empirically defined through laboratory experiments graham et al 1996 as a function of water temperature t c and fish size l m cdv for salmon fry is defined 5 cdv 4 14 log t 1 74 l considering that the scope of our example is to study the effects of hydroclimatically driven flow regime variations in sites characterized by different bed morphology and geometry for simplicity we fixed values for both t 11 5 c the mean water temperatures for may june period from 2007 to 2011 recorded at the hb site and l 0 046 m the average length of fry in the girnock during electrofishing surveys obtaining a cdv equal to 0 29 m s 1 this was then used to define areas where fry habitat was either present or unavailable for the investigated sites 2d hydraulics models were built to obtain spatial distributions of the average water column velocity under different flow conditions for each flow condition velocity spatial distributions were then combined with cdv to obtain the ah area where water velocity was below cdv a similar process is described in detail for salmon parr by fabris et al 2017 of course we recognise that this is a simplification and conservative estimate of fry habitat availability as fry can hold station on the stream bed and use short swimming bursts in foraging nevertheless it provides a simple habitat metric to test the approach with finally for each site we used an analytical function to fit the estimated available habitat the distribution of the available habitat estimations suggests that these can be relatively well approximated by an exponential function with three parameters 6 a h q c e x p b q q a 1 where the parameters a b l t 1 and c t l 1 depend on bed geometry and morphology and cdv water temperature and fish length for each site the parameters were simply calibrated against values estimated from combining hydraulic models with the cdv threshold according to the non linear least squares method johnson and faunt 1992 theoretically any other function could be chosen however a key point is to find a good trade off between the fit of data and the complexity of the function since ah is site size dependent for each site in order to allow site comparisons ah was normalized by the wetted area wa estimated for each site under mean flow conditions 3 3 average available habitat ah to quantify the capacity of the investigated sites to provide usable habitat for newly emerged fry under different flow regimes we consider an average value of the available habitat ah l2 for the period of interest may june the analytical expression of ah can be obtained by integrating the product between p q and ah q 7 a h 0 p q a h q d q using eqs 1 and 6 ah can be written as 8 a h c α k a 1 1 b α k a λ k 1 γ a λ k 1 γ λ k using eqs 3 and 4 eq 8 can be expressed as a function of mean discharge μ and coefficient of variation cv as 9 a h c μ cv 2 a 1 1 b μ cv 2 a cv 2 1 γ a c v 2 1 γ cv 2 again ah was normalized by wa to allow comparisons among sites 4 results 4 1 mechanistic stochastic model p q fig 2 shows examples of the distribution of specific discharge observations measured at the outlet of the catchment blue bars against the analytical probability density functions estimated using the mechanistic stochastic model red lines for the girnock burn for two contrasting years the mechanistic stochastic model adequately captures the frequency distribution of flow observations both under erratic dry 1974 fig 2 and persistent wet conditions 1983 fig 2 with an average error between modelled and observed 0 2 0 5 and 0 8 quantiles equal to 0 021 0 022 and 0 014 cm d 1 respectively for the erratic flow persistent regime mean daily specific discharge remains below 0 4 cm d 1 1 cm d 1 with higher frequencies occurring for q 0 15 cm d 1 0 4 cm d 1 fig 3 shows the specific discharge distributions against the analytical probability density functions for the river lyon for the years 2010 and 2011 as previously noted since the 1950s the river lyon has been regulated with flows controlled by reservoir releases consequently it was not possible to obtain specific discharge distributions directly from observations and naturalised flow regimes had to be simulated by a rainfall runoff model based on the hbv modelling framework geris et al 2015 even in this case the model successfully captured the flow regime for the fry emergence period even though we could test the stochastic model only under persistent i e wet conditions modelled and observed 0 2 0 5 and 0 8 quantiles differ of 0 030 0 007 and 0 095 cm d 1 respectively for the less persistent i e close to erratic flow regime in 2010 mean specific daily discharge remains below 0 4 cm d 1 with higher frequencies occurring for q 0 15 cm d 1 while for the more persistent flow regime in 2011 frequencies are relatively uniformly distributed with q remaining below 1 2 cm d 1 4 2 analytical habitat availability ah q fig 4 shows the modelled ah for a given specific discharge obtained for the four girnock burn fig 4a and the two lyon fig 4b sites by combining hydraulic models and cdv assessment and normalizing by the wa the relationship between ah wa and q shows the same bell shaped pattern for all the 6 sites even if this is less pronounced for the 2 lyon sites where the bell is compressed against the y axis ah wa is quite high under relatively low flow where we can find a maximum after which it monotonically decreases to values close to 0 in correspondence of relatively high q 1 and 0 4 cm d 1 for the girnock and lyon sites respectively lines show the equivalent relationship described by the functions that we used to describe analytically the dependence of ah from q the exponential function with three parameters with no physical meaning provides an adequate fit to the data with r square ranging between 0 984 st and 0 995 faws 4 3 generalised integrated model as previously observed the flow regime during the period around and soon after fry emergence is well reproduced by gamma distribution that can be simply defined by mean specific discharge μ and the coefficient of variation cv that the mechanistic stochastic model used explicitly relates to mean rainfall depth α mean runoff frequency λ and the inverse of the flow recession constant k effects of flow regime on ah can be therefore investigated either analytically using equation 9 or equivalently by building heat maps that show ah for different combinations of μ α k and cv k λ accordingly figs 5 7 show how ah normalized by wa varies under different flow regime conditions simply defined in terms of the statistics μ and cv for the six investigated sites as the ah q functions have broadly similar shape for all the sites apart from lu even with different absolute values ah shows the same pattern between these sites fig 6 to show the general behaviour of ah fig 5 considers values of μ and cv ranging between 0 and 3 cm d 1 and 0 and 6 cm d 1 respectively covering most of the existing persistent and erratic hydroclimatic settings botter et al 2013 values of the normalised ah range between 0 and 0 8 in the maps we can see the presence of parallel bell shaped lines with constant ah wa for the five sites with similar ah q and exponentially shaped for lu contour lines developing respect to the y axis showing how different flow regimes can provide on average the same ah wa the position of the maximum with respect to the y axis of these curves depends on the shape of the ah q function this results in girnock burn bell shaped ah q sites providing in general more usable habitat under persistent or slightly erratic flow regimes in contrast the lyon almost exponential ah q sites tend to provide more usable habitat under very erratic flow regimes the dispersion of these curves is proportional to the variance of ah q fig 6 highlights the cv that maximizes ah for each value of μ and vice versa for the different sites according to the first part of the curves low μ we have relative maximum of ah in correspondence of cv close to 0 then for higher values of μ the cv that maximizes ah logarithmically increases with μ this dictates that while under low flow regimes low μ ah is maximised by stable flows under wetter conditions higher μ more variable flow regimes can provide greater values of ah as we previously noted the positions of ah relative maximum is strictly related to the position of the maximum in the ah q clearly the higher the q that maximizes ah q the lower the cv that maximize ah for a fixed q furthermore the plot demonstrates that streamflow variability is a critical hydrologic attribute with potentially important implications for river ecosystems and that for many sites and hydrological conditions a certain degree of flow variability is necessary to maximise the habitat availability fig 7 summarizes the response of ah wa for more constrained values of μ and cv for the prevailing low flows during the post emergence period for the girnock burn grey dots show the statistics of each annual flow regime may june observed from 1972 to 2011 while red and blue dots respectively correspond to the erratic 1974 and persistent 1983 years reported in fig 2 the erratic year is characterised by a higher cv and a smaller μ with respect to the persistent one the plot shows how changes in ah are the result of simultaneous variations on both μ and cv df for the girnock burn and st for the lyon give the higher values of ah wa for the entire domain with peaks of ah wa around 0 8 the lowest values of ah wa for the girnock sites around 0 3 occur in df while the lowest values for the lyon sites about 0 1 occur in st in correspondence of cv 2 7 and μ 0 2 the remaining 3 sites faws ib and lu are more moderate with less extreme values of ah wa considering flow regimes characterised by similar μ df and hb show a decrease in ah aw with flow regime moving from persistent wet cv 1 to erratic dry cv 1 1974 vs 1983 in contrast st and lu show an increase in ah aw in correspondence of the persistent erratic transition area 1974 vs 1983 while faws and ib are not characterised by any significant variations 1974 vs 1983 the heterogeneous pattern of ah wa among different sites shown in fig 7 can be related to inter site differences in the effect of μ and cv on habitat availability while increasing μ generally leads to reduced ah ah can either increase or decrease with cv depending on the shape of the function ah q which is related to site morphology and hydraulics to analyse the effect of mean specific discharge and streamflow variability on habitat quality fig 8 shows the pattern of ah wa for the post emergence period for the lyon during four consecutive springs may june in the period 2008 2011 with red and blue dots corresponding to the persistent years 2010 2011 reported in fig 3 the plot shows a systematic decrease of ah with increasing μ here girnock sites are by far the best sites with values of ah wa that go up to 0 8 for the lyon sites st seem to be slightly better even if both site have very low ah wa around 0 for persistent flow regime cv 1 with μ 0 2 5 discussion and conclusion in this paper we have proposed an analytical approach where a simple metric of fish habitat quality is directly and explicitly linked to hydroclimatic variables and catchment conditions that can define the flow regime for a period of ecological interest the model is the result of two functions describing the flow regime and the relationship between discharge and habitat quality a key element is the mechanistic stochastic model proposed by botter et al 2007 which allows us to explicitly link hydroclimatic and catchment characteristics described by physically meaningful parameters to flow regime compared to standard rainfall runoff models the mechanistic stochastic model here adopted has the advantage of requiring a minimal amount of data and using parameters that can be assessed exclusively based on climatic and landscape data and discharge data in this specific case requiring in principle no calibration against discharge time series confirming the positive results obtained by botter et al 2010 2013 basso et al 2015 and others who successfully used the stochastic model to analytically describe the flow regime in different catchments in italy swiss and the us the example reported here underlined the consistency of this mechanistic stochastic model in reproducing the flow regime in both erratic dry and persistent wet conditions it is reassuring that the model can do this even in challenging conditions such as this where parameter estimation has to be based on a limited number of observations e g a 61 day period in may june since it performs equally well the linear version of the model 3 parameters has been preferred with respect to the alternative non linear version 4 parameters that can consider several stages of recession and be applied to more complex flow regimes botter et al 2009 as a proof of concept in our example we utilized rainfall and specific discharge observations or simulations for the may june period to estimate parameters α λ and k however doulatyari et al 2015 showed alternative ways based on catchment morphology stream network and potential evapotranspiration which do not require discharge observations or simulations to determine λ and k parameters in our case it seems that the analytical function chosen is adequate to describe the relationship between available habitat and specific discharge this function includes the effects of bed morphology on in reach hydraulics and it is therefore site specific this implies that the modelling approach can be transferred to other catchments but this function should be calibrated to the specific sites however similar sites have similar curves that might be used as first approximation for particular river reach morphologies our results showed how ah q curves were relatively similar for each river on the other hand the curves diverged substantially between the girnock and lyon due to significant differences of slope roughness and geometry between the two rivers the effects of flow regime variability and change due to hydroclimatic difference climate change or changes in land use on fish habitat have been the focus of many studies in the last decade jonsson and jonsson 2009 wenger et al 2011 hydraulic habitat models are the most common approaches that have been utilised to assess the effects of flow regime alteration on fish habitat ahmadi nedushan et al 2006 dunbar et al 2012 these include simple threshold models fabris et al 2017 semi quantitative approaches e g phabsim gard 2009 gibbins et al 2002 presence absence models e g scott et al 2005 fuzzy models e g mocq et al 2013 and multivariate statistical methods e g genrallised additive models gams buddendorf et al 2017 millidine et al 2012 however despite their complexity all these models are applied to a restricted number of climate change scenarios that are affected by a high degree of uncertainty especially at a catchment scale chen et al 2011 murphy et al 2010 in this context combining results from various kinds of hydraulic habitat models with the analytical flow model proposed here we can overcome this issue and provide a more general approach explicitly showing the effects of hydroclimatic variability e g mean rainfall on various habitat indices therefore even without directly addressing uncertainty compared to more commonly used approaches this method has the advantage of providing valuable information about the effects of hydroclimatic alterations on habitat conditions regardless of uncertain climate change predictions the effects of single or combined parameters representing different hydroclimatic conditions on the habitat quality can then be investigated by an analytical study of the equation or by analysing graphical maps see fig 5 as an example a key advantage of this new analytical approach is that it clearly shows how simple maps can provide useful insights to visualise and assess the potential impacts that flow regime variations therefore hydroclimatic factors and catchment conditions could have on available habitat in sites characterised by different morphology and geometry in particular our results suggest that habitat is strongly influenced by the interplay of mean specific discharge and stream flow variability under flow regimes characterised by low mean specific discharge a few mm d 1 available habitat is maximised by low variability while flow regimes characterised by greater mean specific discharge which is more common and also necessary to sustain smolt migration in this period thorstad et al 2012 require a certain degree of variability to maintain high levels of available habitat therefore flow regimes characterised by intermediate mean specific discharge and a certain degree of flow variability seem to be the best compromise to simultaneously sustain salmon flow requirements at different life stages in line with the natural flow regime paradigm poff et al 1997 this results further emphasises the importance in regulated catchments of management policies that maintain a certain degree of flow variability in order to sustain riverine ecological functions however although we recognise that the example presented here is a simple proof of concept it provides a clear guide of how the modelling approach can be implemented and the information that this method can provide we should stress that we are well aware of the limitations introduced by assessing habitat availability for salmon fry based only upon a velocity threshold cdv in fact other abiotic and biotic factors such as water depth substrate and cover can also significantly influence salmon fry habitat availability however the use of more complex hydraulic habitat models including the effects of other variables for instance water depth not based only on cdv are equally amenable to use with the approach described furthermore by considering mean water column velocity we are likely producing a conservative estimate of habitat availability as water velocity tends to follow a logarithmic profile with depth vito and giorgio 1994 this implies that even when mean velocity is too high fish can still rest in the proximity of the river bed where velocities are much lower höjesjö et al 2015 in fact it has been shown that juvenile salmon can spend time close to the river bed using pectoral fins for stability arnold et al 1991 moving into the water column for short periods for foraging höjesjö et al 2015 instead a limitation of the general 2 d hydraulic modelling approach is that it estimates an average daily quality of the habitat for the entire period of interest may june in our example the importance of this simplification is probably strongly related to site characteristics and life stage and species investigated in fact while some studies demonstrated that the habitat used by juvenile salmon was not substantially affected by short term discharge fluctuations berland et al 2004 robertson et al 2004 others showed that in some situations single extreme events can have greater impacts on fish density and distribution and therefore on habitat quality than more moderate conditions jensen and johnsen 1999 the latter can be theoretically incorporated by adding analytical weight functions to the model but this is beyond the scope of the current study in conclusion considering the high uncertainty on future hydroclimatic conditions especially at a catchment scale we argue that the simple general integrated model proposed in this paper can be successfully combined with commonly used hydraulic habitat models to help river managers to take informed decisions that effectively maintain or improve freshwater habitat based on known hydroclimatic variability acknowledgements thanks to marine scotland science and the university of aberdeen for funding the project many thanks to marine scotland science also for providing meteorological and discharge time series for the girnock thanks to scottish environmental protection agency sepa for precipitation data for the lyon finally thanks to josie geris for providing simulated discharge time series for the lyon 
6958,we propose a novel analytical approach that provides a simple integrated tool for assessing the effects of hydroclimatically driven flow regime variations on fish habitat average habitat quality metrics can be predicted effectively by an analytical equation this is the result of the integration of two functions describing a the flow regime the frequency distribution of discharge and b the relationship between discharge and habitat quality we applied this approach as a proof of concept to a simple model of velocity thresholds for juvenile salmon fry the flow regime was described by a gamma distribution with physically meaningful parameters derived using a mechanistic stochastic approach that explicitly links the flow regime to hydro meteorological conditions and catchment wetness under different flow conditions habitat quality was estimated using hydraulic habitat models an empirical analytical function was then used to describe the relationship between specific discharge and habitat quality six river channel reaches characterized by different bed geometry and morphology were investigated four reaches are located in the girnock burn a natural upland river in the north of scotland while the remaining two reaches are located in the river lyon in the central highlands of scotland that is heavily regulated for hydropower production results show that the stochastic model and the analytical function applied each containing three parameters successfully described girnock in both dry and wet years and lyon naturalised flow regimes and captured the relationship between available habitat and specific discharge reasonably well for each site we obtained heat maps linking climatic and landscape features to bi monthly average available habitat these maps can provide clear generalised insights into the potential effects of hydroclimatic variations on metrics of fish habitat and have potential for wider applications using more complex habitat model keywords atlantic salmon habitat suitability flow regime analytical approach hydroclimatic variability stochastic model 1 introduction freshwater ecosystems are particularly sensitive to hydroclimatic variability and the likely effects of climate change and this has potential implications for aquatic organisms ormerod 2009 likely impacts may include changes to flow regimes poff and zimmerman 2010 increased water temperatures beechie et al 2013 and water quality changes miserendino et al 2011 the primary effects that variations in flow regime have on in channel hydraulics indexed by the spatial and temporal distribution of water velocity depth and wetted area dictate that it is a key control on fish habitat ahmadi nedushan et al 2006 indeed hydrological extremes of floods and droughts can have a significant impact on fish growth and mortality elliott et al 1997 the last decade has seen numerous attempts to assess the effects of hydroclimatic variability and climate change on flow variability and fresh water organisms including salmonids for example in the mink brook a tributary of the connecticut river new hampshire nislow and armstrong 2012 investigated the effects of high and low summer flow regime on 0 age atlantic salmon fry linking flow regime to summer growth and finding that fish grew best in wetter summers lobón cerviá and bradford 2014 utilised long term hydrologic and fish data to investigate the relationship between annual survival and recruitment of brown trout salmo trutta with several environmental variables in contrasting sites of the rio esva spain they demonstrated that annual survival and recruitment were equally maximised by intermediate discharge and that their relationships were well described by parabolic curves alternatively jensen and johnsen 1999 in the river saltdalselv northern norway looked at the effects of high spring floods on both juvenile salmon survival and growth and discovered that in years with high peak spring floods salmon parr grew less though for 1 year or older parr mortality is not significantly affected by discharge peaks climate change predictions and future hydroclimatic conditions on which such predictions are based are rather uncertain this uncertainty is the consequence of several factors including model errors initial conditions forcing errors and the uncertainty linked to general circulation models gcm and to the downscaling method that is used to obtain predictions at a catchment scale chen et al 2011 capell et al 2013 haddeland et al 2014 van schaeybroeck and vannitsem 2016 in fact habitat models assessing climate change effects on fish populations often utilise as inputs very uncertain regional predictions where in some cases even the direction of change is not known bates et al 2008 goode et al 2013 to assess the uncertainty related to climate change predictions habitat models have been commonly applied to a set of most probable scenarios e g muñoz mas et al 2016 papadaki et al 2016 however as the number of scenarios is usually limited these models are unable to provide catchment managers with understanding the uncertainties of climate change predictions in relation to current hydroclimatic variability fish are adapted to in this context more general methods analytically linking the variability of hydroclimatic conditions with metrics of fish habitat quality could provide managers with an evidence base for conservation plans not simply relying on a few most likely scenarios but based on the context of known variability probability based models have been widely used to describe the distribution of hydrologic and climatic data botter et al 2007 husak et al 2007 this has shown that certain types of probability distributions provide remarkably good fits for specific environmental variables for example the gamma distribution is often an appropriate descriptor for daily precipitation and discharge data while a normal distribution might be good for describing the frequency distribution of daily air temperature data in this context we propose a parsimonious analytical approach that combines analytical functions describing river flow regimes based on a stochastic method proposed by botter et al 2007 and metrics of habitat quality which can be derived from detailed ecohydraulic surveys e g fabris et al 2017 buddendorf et al 2017 the stochastic model has three parameters describing the hydro climatic conditions and the effects of morphological and hydrological attributes on water routing at a catchment scale these parameters allow an analytical description of the effects of hydroclimatic changes on flow regime to characterise past flow regimes parameters can be directly estimated based on climatic and landscape data botter et al 2013 a wide range of habitat models are available and are variously used depending on species life stage of interest and available data acreman and dunbar 2004 in theory any habitat model can be utilised and integrated with an appropriate function that approximates the relationship between habitat quality and discharge in the study reported here simple hydraulic models based on velocity thresholds for juvenile salmon were used as a proof of concept e g fabris et al 2017 buddendorf et al 2017 alternatively though for a first screening or when data are limited general instream habitat models can be used as a first approximation to derive the discharge habitat quality relationship lamouroux and jowett 2005 the effects of hydroclimatic variations on average habitat quality can then be assessed by evaluating the effects that stochastic model parameters have on habitat a more simple and intuitive though equivalent approach involves building heat maps relating meaningful flow regime statistics e g mean flow and variability with average habitat quality as in the example we present by analytically linking habitat quality to hydroclimatic variables and flow regime characteristics such models can therefore provide general insights into the effects of hydroclimatic variations on in stream habitat the main advantage of such approach is that it can extend and generalise the results of hydraulic habitat models and help managers who want to protect freshwater species from climate change effects to take more evidence based decisions based on known hydroclimatic variations independently of uncertain climate change predictions here in our example of model application we use salmon fry salmo salar l newly emerged from eggs in river gravels as a target species due to its ecological and economic importance winfield et al 2004 walsh and kilsby 2007 but also because of the intolerance of this life stage to high flow velocities which under high flow conditions may hinder feeding opportunities or cause fish to be swept away e g geist et al 2000 kynard et al 2000 mallet et al 2000 potential available habitat is used in our example as a very simple metric for habitat quality available habitat was derived by combining 2d hydraulic models with simple velocity threshold the critical displacement velocity cdv above which fish cannot hold position and feeding opportunity and therefore fish growth may be limited graham et al 1996 specifically the aims of this paper are to 1 show how a mechanistic stochastic model based on physically based parameters that depend on hydroclimatic and catchment conditions can successfully describe both variable or erratic and persistent or stable flow regimes 2 describe how analytical functions can be used to conceptualise the relationship between discharge and metrics of habitat quality and 3 provide a simple integrated and generalized approach to assessing the effects of hydroclimatically driven flow regime dynamics based on a metric of fish habitat quality as a proof of concept the method is here applied to investigate the effects of hydroclimatic variations in terms of flow regime on atlantic salmon fry in six contrasting river reaches in the scottish highlands 2 study site overall we investigate six reaches fig 1 four reaches are located in the girnock burn a small undisturbed long term salmon monitoring stream known to provide extensive suitable habitat for juvenile salmon glover et al 2018 the remaining two reaches are located in the heavily regulated river lyon a larger tributary of the river tay scotland s largest river system birkel et al 2014 for the girnock sites the catchment is dominated by heather calluna vulgaris and erica tetralix moorland with some scots pine pinus sylvestris forests only in the lower part of the catchment which has an area of about 32 km2 and ranges in altitude from 230 to 862 m a s l gibbins et al 2002 catchment geology is mainly characterized by granite and calcareous schist which is overlain by glacial drift deposits in the valley bottom soils are dominated by organic rich peaty soils in the riparian area mean air t is 6 3 c with annual precipitation relatively evenly distributed throughout the year of 1000 mm of which less than 10 falls as snow the main stem is 9 km long with an average slope of 0 029 moir et al 1998 and the channel bed is dominated by step pool and plane beds moir et al 2006 the mean daily discharge measured 200 m upstream of the catchment outfall is 0 53 m3 s 1 0 14 cm d 1 with peaks 8 m3 s 1 2 3 cm d 1 the investigated reaches which are extensively described by fabris et al 2017 going from upstream to downstream are iron bridge ib hampshire s bridge hb diagonal fence df and forest automatic weather station faws fig 1 ib hb and df are moorland sites with undercut banks and the riparian vegetation is dominated by heather shrubs while faws is a forest site with well defined banks the remaining 2 reaches lubreoch lu upstream and stronuich st downstream fig 1 are located along the lyon river a highly regulated tributary of the river tay in central scotland utilised for hydroelectric power production since 1958 geris et al 2015 the lyon catchment has an area of 391 km2 that ranges from 92 to 1192 m a s l and its land cover is dominated by moorland with some patches of forest distributed along the river the mean annual precipitation is 2290 mm more than twice that of the girnock burn is evenly distributed throughout the year in winter time a large portion of the precipitation falls as snow especially at the higher elevations geris et al 2015 air temperature ranges from 15 to 25 c the river length is 49 km and has a mean discharge of 12 5 m3 s 1 0 28 cm d 1 measured at the outlet section of the catchment the lyon sites are extensively described by buddendorf et al 2017 lu and st are both characterized by a flat plane bed with the presence of some large roughness elements banks are covered by grass with no presence of trees or shrubs the geometry longitudinal length and width the slope and the roughness of all the sites investigated are reported in table 1 bathymetric surveys of each site and their detailed characteristics are described by fabris et al 2017 girnock and buddendorf et al 2017 lyon average site width was calculated by dividing the wetted area by its length under mean discharge conditions mean daily discharge recorded and scaled for each site in proportion to its drainage area slope has been calculated as the average slope of the water surface while roughness was computed as a detrended standard deviation of bed bathymetry using topcat tool olsen et al 2012 3 method for our purposes the flow regime is defined as the frequency distribution of river flows for a particular period of interest which can be described using a gamma distribution according to the stochastic model proposed by botter et al 2007 2013 the version of the model that we utilised contains three parameters that are not simply calibrated against observations but are explicitly related to climatic and catchment conditions allowing a direct linkage of the flow regime variation to rainfall inputs and catchment wetness conditions for the current study we defined the flow regime for the fry post emergence period may june a second analytical function is then utilized to relate the habitat availability metric of habitat quality for our example to specific discharge this relationship is based on habitat availability produced by detailed hydraulic modelling described fully by fabris et al 2017 parameters in this case are calibrated against simulated values and do not have clear physical meaning hence an average value of the available habitat for the period of interest is obtained integrating the product between these two functions in the case we focus on a simple metric for fry habitat but the approach is generic and can be used with any other habitat models dependent on flow 3 1 flow regime p q the flow regime for the post hatch period may june which is one of the most flow sensitive periods for newly emerged small juvenile salmon fry average length of fry caught in the girnock during electrofishing 4 8 cm is represented by a probability density function according to a mechanistic stochastic model in which streamflow q l t 1 dynamics are assumed to be driven by a catchment scale soil water balance forced by stochastic daily rainfall inputs botter et al 2007 in this context runoff events result from the modulation of daily rainfall inputs according to the antecedent wetness of the catchment soils rainfall is modelled as a spatially uniform marked poisson process with mean depth α l and mean rainfall frequency λp t 1 although α quantifies the average daily intensity of rainfall events the runoff frequency λ is smaller than the underlying precipitation frequency λp because any soil water deficit created by evapotranspiration et in the rooting zone needs to be satisfied before water is routed to streams effective rainfall is consequently modelled as a spatially uniform marked poisson process with mean depth α l and mean runoff frequency λ t 1 therefore λ by accounting for the et crucially embeds rainfall attributes soil vegetation properties and other hydroclimatic variables such as temperature humidity and wind speed the time scale of the hydrological response defined as the mean water retention time in the upstream catchment is operationally identified by the inverse of the recession constant k t 1 observed during recessions conveniently assumed to be exponential this allows simulation of the slow release of water from the soil and underlying aquifers to assume that the entire catchment is modelled as a linear reservoir botter et al 2007 the term k quantifies the effect of catchment scale morphological and hydrological attributes controlling water routing high k values imply low duration of the flow pulses released from the catchment after rainfall typical of fast responding catchments the shape of the distributions is determined by the ratio λ k we distinguished between erratic dry and persistent wet flow regimes erratic flow regimes are characterized by exponentially shaped frequency distributions with high frequencies for very low flows that monotonically decrease with q λ k 1 while persistent conditions are characterized by bell shaped frequency distributions with an increase of frequency with q until a maximum after which frequencies begin to decrease increasing q λ k 1 the model allows an analytical expression of the streamflow probability distribution p q botter et al 2007 1 p q α k λ k γ λ k q λ k 1 e x p q α k that can be written 2 p q μ cv 2 cv 2 γ cv 2 q cv 2 1 e x p q μ cv 2 with 3 μ α λ 4 cv k λ where μ is the mean and cv is the coefficient of variation of the specific discharge cv also known as relative standard deviation represents a standardized measure of dispersion of a probability distribution around the mean table 2 shows the ranges of the parameters for the girnock and the lyon respectively 3 2 available habitat ah q the spatial distribution of water depth and velocity and therefore the available habitat ah in river channels are largely determined by the interactions of q and bed morphology leopold and maddock 1953 in this example to determine ah under different q we utilized a simple approach based on a critical displacement velocity index cdv which represents a velocity threshold above which juvenile salmon are unable to hold station and fish feeding activity may be impeded tetzlaff et al 2005 cdv depends upon fish size and stream temperature and was empirically defined through laboratory experiments graham et al 1996 as a function of water temperature t c and fish size l m cdv for salmon fry is defined 5 cdv 4 14 log t 1 74 l considering that the scope of our example is to study the effects of hydroclimatically driven flow regime variations in sites characterized by different bed morphology and geometry for simplicity we fixed values for both t 11 5 c the mean water temperatures for may june period from 2007 to 2011 recorded at the hb site and l 0 046 m the average length of fry in the girnock during electrofishing surveys obtaining a cdv equal to 0 29 m s 1 this was then used to define areas where fry habitat was either present or unavailable for the investigated sites 2d hydraulics models were built to obtain spatial distributions of the average water column velocity under different flow conditions for each flow condition velocity spatial distributions were then combined with cdv to obtain the ah area where water velocity was below cdv a similar process is described in detail for salmon parr by fabris et al 2017 of course we recognise that this is a simplification and conservative estimate of fry habitat availability as fry can hold station on the stream bed and use short swimming bursts in foraging nevertheless it provides a simple habitat metric to test the approach with finally for each site we used an analytical function to fit the estimated available habitat the distribution of the available habitat estimations suggests that these can be relatively well approximated by an exponential function with three parameters 6 a h q c e x p b q q a 1 where the parameters a b l t 1 and c t l 1 depend on bed geometry and morphology and cdv water temperature and fish length for each site the parameters were simply calibrated against values estimated from combining hydraulic models with the cdv threshold according to the non linear least squares method johnson and faunt 1992 theoretically any other function could be chosen however a key point is to find a good trade off between the fit of data and the complexity of the function since ah is site size dependent for each site in order to allow site comparisons ah was normalized by the wetted area wa estimated for each site under mean flow conditions 3 3 average available habitat ah to quantify the capacity of the investigated sites to provide usable habitat for newly emerged fry under different flow regimes we consider an average value of the available habitat ah l2 for the period of interest may june the analytical expression of ah can be obtained by integrating the product between p q and ah q 7 a h 0 p q a h q d q using eqs 1 and 6 ah can be written as 8 a h c α k a 1 1 b α k a λ k 1 γ a λ k 1 γ λ k using eqs 3 and 4 eq 8 can be expressed as a function of mean discharge μ and coefficient of variation cv as 9 a h c μ cv 2 a 1 1 b μ cv 2 a cv 2 1 γ a c v 2 1 γ cv 2 again ah was normalized by wa to allow comparisons among sites 4 results 4 1 mechanistic stochastic model p q fig 2 shows examples of the distribution of specific discharge observations measured at the outlet of the catchment blue bars against the analytical probability density functions estimated using the mechanistic stochastic model red lines for the girnock burn for two contrasting years the mechanistic stochastic model adequately captures the frequency distribution of flow observations both under erratic dry 1974 fig 2 and persistent wet conditions 1983 fig 2 with an average error between modelled and observed 0 2 0 5 and 0 8 quantiles equal to 0 021 0 022 and 0 014 cm d 1 respectively for the erratic flow persistent regime mean daily specific discharge remains below 0 4 cm d 1 1 cm d 1 with higher frequencies occurring for q 0 15 cm d 1 0 4 cm d 1 fig 3 shows the specific discharge distributions against the analytical probability density functions for the river lyon for the years 2010 and 2011 as previously noted since the 1950s the river lyon has been regulated with flows controlled by reservoir releases consequently it was not possible to obtain specific discharge distributions directly from observations and naturalised flow regimes had to be simulated by a rainfall runoff model based on the hbv modelling framework geris et al 2015 even in this case the model successfully captured the flow regime for the fry emergence period even though we could test the stochastic model only under persistent i e wet conditions modelled and observed 0 2 0 5 and 0 8 quantiles differ of 0 030 0 007 and 0 095 cm d 1 respectively for the less persistent i e close to erratic flow regime in 2010 mean specific daily discharge remains below 0 4 cm d 1 with higher frequencies occurring for q 0 15 cm d 1 while for the more persistent flow regime in 2011 frequencies are relatively uniformly distributed with q remaining below 1 2 cm d 1 4 2 analytical habitat availability ah q fig 4 shows the modelled ah for a given specific discharge obtained for the four girnock burn fig 4a and the two lyon fig 4b sites by combining hydraulic models and cdv assessment and normalizing by the wa the relationship between ah wa and q shows the same bell shaped pattern for all the 6 sites even if this is less pronounced for the 2 lyon sites where the bell is compressed against the y axis ah wa is quite high under relatively low flow where we can find a maximum after which it monotonically decreases to values close to 0 in correspondence of relatively high q 1 and 0 4 cm d 1 for the girnock and lyon sites respectively lines show the equivalent relationship described by the functions that we used to describe analytically the dependence of ah from q the exponential function with three parameters with no physical meaning provides an adequate fit to the data with r square ranging between 0 984 st and 0 995 faws 4 3 generalised integrated model as previously observed the flow regime during the period around and soon after fry emergence is well reproduced by gamma distribution that can be simply defined by mean specific discharge μ and the coefficient of variation cv that the mechanistic stochastic model used explicitly relates to mean rainfall depth α mean runoff frequency λ and the inverse of the flow recession constant k effects of flow regime on ah can be therefore investigated either analytically using equation 9 or equivalently by building heat maps that show ah for different combinations of μ α k and cv k λ accordingly figs 5 7 show how ah normalized by wa varies under different flow regime conditions simply defined in terms of the statistics μ and cv for the six investigated sites as the ah q functions have broadly similar shape for all the sites apart from lu even with different absolute values ah shows the same pattern between these sites fig 6 to show the general behaviour of ah fig 5 considers values of μ and cv ranging between 0 and 3 cm d 1 and 0 and 6 cm d 1 respectively covering most of the existing persistent and erratic hydroclimatic settings botter et al 2013 values of the normalised ah range between 0 and 0 8 in the maps we can see the presence of parallel bell shaped lines with constant ah wa for the five sites with similar ah q and exponentially shaped for lu contour lines developing respect to the y axis showing how different flow regimes can provide on average the same ah wa the position of the maximum with respect to the y axis of these curves depends on the shape of the ah q function this results in girnock burn bell shaped ah q sites providing in general more usable habitat under persistent or slightly erratic flow regimes in contrast the lyon almost exponential ah q sites tend to provide more usable habitat under very erratic flow regimes the dispersion of these curves is proportional to the variance of ah q fig 6 highlights the cv that maximizes ah for each value of μ and vice versa for the different sites according to the first part of the curves low μ we have relative maximum of ah in correspondence of cv close to 0 then for higher values of μ the cv that maximizes ah logarithmically increases with μ this dictates that while under low flow regimes low μ ah is maximised by stable flows under wetter conditions higher μ more variable flow regimes can provide greater values of ah as we previously noted the positions of ah relative maximum is strictly related to the position of the maximum in the ah q clearly the higher the q that maximizes ah q the lower the cv that maximize ah for a fixed q furthermore the plot demonstrates that streamflow variability is a critical hydrologic attribute with potentially important implications for river ecosystems and that for many sites and hydrological conditions a certain degree of flow variability is necessary to maximise the habitat availability fig 7 summarizes the response of ah wa for more constrained values of μ and cv for the prevailing low flows during the post emergence period for the girnock burn grey dots show the statistics of each annual flow regime may june observed from 1972 to 2011 while red and blue dots respectively correspond to the erratic 1974 and persistent 1983 years reported in fig 2 the erratic year is characterised by a higher cv and a smaller μ with respect to the persistent one the plot shows how changes in ah are the result of simultaneous variations on both μ and cv df for the girnock burn and st for the lyon give the higher values of ah wa for the entire domain with peaks of ah wa around 0 8 the lowest values of ah wa for the girnock sites around 0 3 occur in df while the lowest values for the lyon sites about 0 1 occur in st in correspondence of cv 2 7 and μ 0 2 the remaining 3 sites faws ib and lu are more moderate with less extreme values of ah wa considering flow regimes characterised by similar μ df and hb show a decrease in ah aw with flow regime moving from persistent wet cv 1 to erratic dry cv 1 1974 vs 1983 in contrast st and lu show an increase in ah aw in correspondence of the persistent erratic transition area 1974 vs 1983 while faws and ib are not characterised by any significant variations 1974 vs 1983 the heterogeneous pattern of ah wa among different sites shown in fig 7 can be related to inter site differences in the effect of μ and cv on habitat availability while increasing μ generally leads to reduced ah ah can either increase or decrease with cv depending on the shape of the function ah q which is related to site morphology and hydraulics to analyse the effect of mean specific discharge and streamflow variability on habitat quality fig 8 shows the pattern of ah wa for the post emergence period for the lyon during four consecutive springs may june in the period 2008 2011 with red and blue dots corresponding to the persistent years 2010 2011 reported in fig 3 the plot shows a systematic decrease of ah with increasing μ here girnock sites are by far the best sites with values of ah wa that go up to 0 8 for the lyon sites st seem to be slightly better even if both site have very low ah wa around 0 for persistent flow regime cv 1 with μ 0 2 5 discussion and conclusion in this paper we have proposed an analytical approach where a simple metric of fish habitat quality is directly and explicitly linked to hydroclimatic variables and catchment conditions that can define the flow regime for a period of ecological interest the model is the result of two functions describing the flow regime and the relationship between discharge and habitat quality a key element is the mechanistic stochastic model proposed by botter et al 2007 which allows us to explicitly link hydroclimatic and catchment characteristics described by physically meaningful parameters to flow regime compared to standard rainfall runoff models the mechanistic stochastic model here adopted has the advantage of requiring a minimal amount of data and using parameters that can be assessed exclusively based on climatic and landscape data and discharge data in this specific case requiring in principle no calibration against discharge time series confirming the positive results obtained by botter et al 2010 2013 basso et al 2015 and others who successfully used the stochastic model to analytically describe the flow regime in different catchments in italy swiss and the us the example reported here underlined the consistency of this mechanistic stochastic model in reproducing the flow regime in both erratic dry and persistent wet conditions it is reassuring that the model can do this even in challenging conditions such as this where parameter estimation has to be based on a limited number of observations e g a 61 day period in may june since it performs equally well the linear version of the model 3 parameters has been preferred with respect to the alternative non linear version 4 parameters that can consider several stages of recession and be applied to more complex flow regimes botter et al 2009 as a proof of concept in our example we utilized rainfall and specific discharge observations or simulations for the may june period to estimate parameters α λ and k however doulatyari et al 2015 showed alternative ways based on catchment morphology stream network and potential evapotranspiration which do not require discharge observations or simulations to determine λ and k parameters in our case it seems that the analytical function chosen is adequate to describe the relationship between available habitat and specific discharge this function includes the effects of bed morphology on in reach hydraulics and it is therefore site specific this implies that the modelling approach can be transferred to other catchments but this function should be calibrated to the specific sites however similar sites have similar curves that might be used as first approximation for particular river reach morphologies our results showed how ah q curves were relatively similar for each river on the other hand the curves diverged substantially between the girnock and lyon due to significant differences of slope roughness and geometry between the two rivers the effects of flow regime variability and change due to hydroclimatic difference climate change or changes in land use on fish habitat have been the focus of many studies in the last decade jonsson and jonsson 2009 wenger et al 2011 hydraulic habitat models are the most common approaches that have been utilised to assess the effects of flow regime alteration on fish habitat ahmadi nedushan et al 2006 dunbar et al 2012 these include simple threshold models fabris et al 2017 semi quantitative approaches e g phabsim gard 2009 gibbins et al 2002 presence absence models e g scott et al 2005 fuzzy models e g mocq et al 2013 and multivariate statistical methods e g genrallised additive models gams buddendorf et al 2017 millidine et al 2012 however despite their complexity all these models are applied to a restricted number of climate change scenarios that are affected by a high degree of uncertainty especially at a catchment scale chen et al 2011 murphy et al 2010 in this context combining results from various kinds of hydraulic habitat models with the analytical flow model proposed here we can overcome this issue and provide a more general approach explicitly showing the effects of hydroclimatic variability e g mean rainfall on various habitat indices therefore even without directly addressing uncertainty compared to more commonly used approaches this method has the advantage of providing valuable information about the effects of hydroclimatic alterations on habitat conditions regardless of uncertain climate change predictions the effects of single or combined parameters representing different hydroclimatic conditions on the habitat quality can then be investigated by an analytical study of the equation or by analysing graphical maps see fig 5 as an example a key advantage of this new analytical approach is that it clearly shows how simple maps can provide useful insights to visualise and assess the potential impacts that flow regime variations therefore hydroclimatic factors and catchment conditions could have on available habitat in sites characterised by different morphology and geometry in particular our results suggest that habitat is strongly influenced by the interplay of mean specific discharge and stream flow variability under flow regimes characterised by low mean specific discharge a few mm d 1 available habitat is maximised by low variability while flow regimes characterised by greater mean specific discharge which is more common and also necessary to sustain smolt migration in this period thorstad et al 2012 require a certain degree of variability to maintain high levels of available habitat therefore flow regimes characterised by intermediate mean specific discharge and a certain degree of flow variability seem to be the best compromise to simultaneously sustain salmon flow requirements at different life stages in line with the natural flow regime paradigm poff et al 1997 this results further emphasises the importance in regulated catchments of management policies that maintain a certain degree of flow variability in order to sustain riverine ecological functions however although we recognise that the example presented here is a simple proof of concept it provides a clear guide of how the modelling approach can be implemented and the information that this method can provide we should stress that we are well aware of the limitations introduced by assessing habitat availability for salmon fry based only upon a velocity threshold cdv in fact other abiotic and biotic factors such as water depth substrate and cover can also significantly influence salmon fry habitat availability however the use of more complex hydraulic habitat models including the effects of other variables for instance water depth not based only on cdv are equally amenable to use with the approach described furthermore by considering mean water column velocity we are likely producing a conservative estimate of habitat availability as water velocity tends to follow a logarithmic profile with depth vito and giorgio 1994 this implies that even when mean velocity is too high fish can still rest in the proximity of the river bed where velocities are much lower höjesjö et al 2015 in fact it has been shown that juvenile salmon can spend time close to the river bed using pectoral fins for stability arnold et al 1991 moving into the water column for short periods for foraging höjesjö et al 2015 instead a limitation of the general 2 d hydraulic modelling approach is that it estimates an average daily quality of the habitat for the entire period of interest may june in our example the importance of this simplification is probably strongly related to site characteristics and life stage and species investigated in fact while some studies demonstrated that the habitat used by juvenile salmon was not substantially affected by short term discharge fluctuations berland et al 2004 robertson et al 2004 others showed that in some situations single extreme events can have greater impacts on fish density and distribution and therefore on habitat quality than more moderate conditions jensen and johnsen 1999 the latter can be theoretically incorporated by adding analytical weight functions to the model but this is beyond the scope of the current study in conclusion considering the high uncertainty on future hydroclimatic conditions especially at a catchment scale we argue that the simple general integrated model proposed in this paper can be successfully combined with commonly used hydraulic habitat models to help river managers to take informed decisions that effectively maintain or improve freshwater habitat based on known hydroclimatic variability acknowledgements thanks to marine scotland science and the university of aberdeen for funding the project many thanks to marine scotland science also for providing meteorological and discharge time series for the girnock thanks to scottish environmental protection agency sepa for precipitation data for the lyon finally thanks to josie geris for providing simulated discharge time series for the lyon 
6959,in recent years west africa has witnessed an increasing number of damaging floods that raise the question of a possible intensification of the hydrological hazards in the region in this study the evolution of extreme floods is analyzed over the period 1950 2015 for seven tributaries in the sudano guinean part of the senegal river basin and four data sets in the sahelian part of the niger river basin non stationary generalized extreme value ns gev distributions including twelve models with time dependent parameters plus a stationary gev are applied to annual maxima of daily discharge amax series an original methodology is proposed for comparing gev models and selecting the best for use the stationary gev is rejected for all stations demonstrating the significant non stationarity of extreme discharge values in west africa over the past six decades the model of best fit most commonly selected is a double linear model for the central tendency parameter μ with the dispersion parameter σ modeled as either stationary linear or a double linear change points in double linear models are relatively consistent for the senegal basin with stations switching from a decreasing streamflow trend to an increasing streamflow trend in the early 1980s in the niger basin the trend in μ is generally positive since the 1970s with an increase in slope after the change point but the change point location is less consistent the recent increasing trends in extreme discharges are reflected in an especially marked increase in return level magnitudes since the 1980s in the studied sahelian rivers the rate of the increase indicated by the study results raises urgent considerations for stakeholders and engineers who are in charge of river basin management and hydraulic works sizing keywords floods flood hazard west africa non stationarity extreme values model selection 1 introduction river floods are one of the deadliest natural hazards in the world they produce major damages on infrastructure lead to economic losses and favor water borne diseases in order to better understand such floods hydrologists have long focused on assessing the rare large in magnitude river discharge values represented by the tails of underlying statistical distributions gumbel 1957 the primary aim besides theoretical understanding is to provide practical tools for flood risk management and civil engineering structure design the main challenge for practical applications is estimating return levels for high return periods typically 10 50 or 100 years the more the return period is larger than the length of the series the greater the challenge of estimating the tail of the distribution extreme value distributions evds are statistical tools designed for the study of such rare values see e g coles et al 2001 katz et al 2002 for several decades the main challenge when applying evds was to have a proper estimation of the tail heavy light or bounded the focus was then on developing robust estimation procedures regional frequency analysis hosking and wallis 1997 gradex and adaptation guillot 1993 paquet et al 2013 bayesian inference coles and tawn 1996 among many other developments and then applying them to the longest hydrological series available koutsoyiannis 2004 the stationarity assumption reigned during this old hydrological world milly et al 2008 however both increases and decreases of extreme discharges have been reported via the evaluation of historical series around the world e g kundzewicz et al 2005 bower 2010 condon et al 2015 a main challenge of hydrological extremes thus concerns the validity of the stationarity assumption and the implications of its rejection ongoing global changes are expected to increase flood hazard mainly through the intensification of the hydrological cycle due to global warming hirabayashi et al 2013 arnell and gosling 2016 and the degradation of land surfaces due to anthropic pressure brath et al 2006 elmer et al 2012 other factors also tend to reduce flood hazards including negative precipitation trends found in drying regions and flood protection structures such as dams while some regions witness resulting changes in flood frequency in other regions no changes have been detected villarini et al 2009 this could be a result of either the absence of substantial changes in drivers that could trigger influence flood trends or competing phenomena that act in opposite ways it could also be due to the use of non robust methodology to detect concrete changes in the evd of discharge the last case necessitates improved methods able to detect trends in series characterized by low signal to noise ratio while numerous studies on flood hazard evolution have been undertaken for developed countries less has been done in the developing world this is the case in particular over the tropics kundzewicz et al 2005 which contain two thirds of the developing countries including the poorest populations living in the tropics are notoriously vulnerable to climate hazards including droughts and floods that can occur within the same year at a given place global changes are expected to strongly impact flood risks in the tropics with studies already reporting significant increases in the frequency of rainfall extremes allan et al 2010 o gorman 2012 asadieh and krakauer 2015 land use cover changes lambin et al 2003 erb et al 2016 rapid rates of urbanization di baldassarre et al 2010 and increasing vulnerability of populations due to very high demographic growth the population of the least developed countries is expected to double from now to 2050 population reference bureau 2016 the strong internal variability of tropical climates the lack of long term hydrological observations and the large uncertainty of climate projections in the tropics challenge the scientific community to provide reliable and relevant information to stakeholders so they can define suitable flood risk management strategies west africa is one of the most critical tropical regions for examining hydrological non stationarities as it is a region in which the issues described above are exacerbated west africa is known for having strong precipitation variability especially at the decadal level nicholson 2013 it underwent a devastating and long lasting drought that abruptly started in the late 1960s and persisted through the 1970s and 1980s lamb 1983 barbé et al 1997 nicholson 2000 camberlin et al 2002 barbé et al 2002 l hote et al 2002 dai et al 2004 panthou et al 2014 bodian et al 2011 bodian et al 2016 at the regional scale this led to a decline in the flow of large rivers that was proportionally greater than the decrease in rainfall lebel et al 2003 andersen and golitzen 2005 mahé and paturel 2009 at the subregional scale however two diametrically opposed hydrological behaviors were observed descroix et al 2018 in the sudano guinean subregion of west africa south of 12 n a decrease in river flow was observed for small to regional scale catchments mahé et al 2005 descroix et al 2009 until the 1970s and 1980s diop et al 2017 the decrease in flow was attributed to a gradual drying up of the groundwater and thus a gradual decrease in the base flow of the rivers mahé et al 2000 mahé and paturel 2009 in the sahelian region belt between roughly 12 n and 16 n runoff coefficients and runoff volumes increased despite the drought this phenomenon the so called sahelian paradox was understood to have been caused by a change in surface conditions albergel 1987 descroix et al 2009 aich et al 2015 cassé et al 2016 droughts played a role in increasing surface crust and decreasing vegetation gal et al 2017 which consequently increased runoff coefficients and counterbalanced the effects of drought boulain et al 2009 anthropogenic changes including land use change appear to be a major factor in some basins seguis et al 2004 li et al 2007 leblanc et al 2008 gal et al 2017 other factors such as an increase in the density of the drainage network may have played a role in the increase of flow e g favreau et al 2009 gal et al 2017 since the early 1990s both total rainfall and streamflow amounts have increased compared to the drought decades of the 1970s and 1980s though they remain lower than in previous pre drought decades lebel and ali 2009 mahé and paturel 2009 panthou et al 2014 tarhule et al 2015 diop et al 2017 in the sahel the increase was accompanied by higher interannual variability ali and lebel 2009 panthou et al 2014 and overall persistence of drought conditions under certain indices l hote et al 2002 ozer et al 2009 of note is the increase in the intensity of rainfall during recent years ly et al 2013 panthou et al 2014 sanogo et al 2015 taylor et al 2017 during the same period an increase in the number and magnitude of extensive floods has been reported tarhule 2005 tschakert et al 2010 samimi et al 2012 sighomnou et al 2013 cassé and gosset 2015 causing extensive fatalities damages and population displacement from the mean hydrographs of the niger river at niamey plotted for six decades from 1951 to 2010 descroix et al 2012 and sighomnou et al 2013 illustrated a strong increase in the intensity of the summer flood peak of the sahelian tributaries during the 2000s while the flood peaks coming from the remote guinean tributaries and arriving at niamey later in the year at niamey were as low as in the 1970s they also noted successive discharge records produced by sahelian floods in 2010 and 2012 exceeding the guinean flood the strong current and projected demographic growth in west africa population reference bureau 2016 is likely to increase the exposure of populations to floods both from intensive and unplanned human settlements in flood prone areas di baldassarre et al 2010 and from human induced changes in land cover which affect runoff changes in hydrological extremes consequentially are particularly pressing for decision makers in west africa as the statistical tools used for infrastructure design have not been updated since the 1970s amani and paturel 2017 an improved quantitative understanding of how extreme flows are changing over time in the region has generated an urgent demand to design and manage structures such as dams and dikes and as a result aid in risk mitigation as well as the development of hydroelectric energy and irrigation systems however there is still very little literature on quantifying extreme flow changes in west africa for sudano guinean regions nka et al 2015 found an overall decreasing trend that closely followed rainfall indices although decreasing at a higher rate this was the case for the falémé branch of the senegal river at fadougou when only a more recent time period is considered since 1970 no significant trends were found in the sudano guinean catchments including the falémé bodian et al 2013 explored trends in annual maximum daily discharge amax values on the bafing tributary of the senegal river bafing makana and daka saidou stations they found that high points in the series occurred during the pre drought period 1967 and 1955 whereas the minima of the amax occurred in 1984 diop et al 2017 found that extreme highs in the bafing makana series decreased by 18 over the series and especially since 1971 while extreme lows stayed stable aich et al 2016 analyzed time series of amax values at several stations along the niger river they found that changes in amax series followed the decadal variability of mean annual precipitation over guinean and benue area catchments a wet period during 1950s and 1960s followed by a dry period during 1970s and 1980s and values close to the long term mean after while the floods produced by sahelian tributaries have recorded a monotonic increase since the beginning of the 1970s nka et al 2015 found positive trends in the extreme values of three sahelian catchments studied dargol river at kakassi the gorouol river at koriziena and the goudebo river at falagontou they also found significant mann kendall test increases in extreme values in both amax series and peak over threshold pot series for the dargol river at kakassi breaks in amax were detected in 1987 and for pot in 1993 mean extreme values were found to be greater twice as high during the later subperiods the aim of this paper is to detect and quantify trends in extreme hydrological values in west africa discharge series are analyzed in tributaries of the niger and the senegal rivers two catchments that reflect two differing hydrological and climatic processes of the sahelian and the sudano guinean west africa the temporal evolution of the amax series is assessed by exploring different generalized extreme value gev models that range from a stationary gev s gev to more complex non stationary gev ns gev models the following study proposes an original methodology for identifying the most significant model to represent the evolution of extremes for a particular data series notably the retained model is accompanied by significance levels and estimates of uncertainty the retained model is used to compute time varying frequencies of extreme flows these changes are represented by the evolution of flow return levels over the last fifty to sixty years our results thus have implications for operational applications as the design and operation of hydraulic structures depend on the magnitude of a flood event at a given return period 2 region of study and data 2 1 west african hydro climatic features the climate of west africa is controlled by the west african monsoon the rainfall belt roughly follows the seasonal migration of the position of the intertropical convergence zone itcz during the boreal winter december february the rainfall belt is located over the gulf of guinea at around 4 n it moves northward during the spring and reaches its northernmost position during boreal summer june september at the regional scale it implies that the hydro eco climatic features vary along a roughly north south gradient the mean annual rainfall amount decreases from south to north ranging from over 1500 mm near the southern guinean coast 5 n to less than 250 mm over the lower saharan desert limit 18 n the sudano guinean and sahelian regions are distinguished by their mean annual rainfall the sudano guinean region extends between the 1300 mm and 750 mm isohyetal lines and the sahel between 750 mm and 250 mm the regions have different seasonal rainfall cycles during the monsoon period bimodal for the sudano guinean region and unimodal signal for the sahel but are both characterized by a main rainfall peak in boreal summer and a dry season in boreal winter the two regions are also differentiated by their respective vegetation dense vegetation featuring tree savannah woodland and tropical forest for the sudano guinean region bodian et al 2016 dry savannah and sparse bush in the sahel these contrasts influence the dominant hydrological processes characterizing the two regions the sahelian hydrology is distinguished by the prevalence of hortonian overland flow horton 1933 in the event of precipitation water infiltrates until the infiltration capacity of the soil is reached as a consequence runoff production is driven by the hydro dynamic properties of soils at the surface the excess rainfall then runs off into the drainage network groundwater flow plays a minor role in the contribution to streamflow if any due to this river basins located in the sahelian region are more sensitive to changes in fine scale rainfall intensity vischel and lebel 2007 to the south on the other hand the sudano guinean catchments have primarily hewlettian hydrological processes cappus 1960 hewlett 1961 hewlett and hibbert 1967 both surface and subsurface flow contribute to streamflow due to the elevated hydraulic conductivity of soils descroix et al 2009 under the same climatic evolution river basins in the sudano guinean zone may be less responsive to changes in rainfall intensity than in sahelian river basins gascon et al 2015 2 2 study catchments and datasets our analysis of changes in extreme flows is based on data available on two contrasted hydro systems in west africa the upper reaches of the senegal river located within the sudano guinean region and the middle reaches of the niger river located within the sahelian region table 1 overviews the data selection for the study and fig 1 displays a map of their locations 2 2 1 sudanian tributaries of the senegal river the second largest river in west africa is the senegal river the senegal river drains a basin of approximately 300 000 km2 rochette 1974 found within the borders of four countries which are from upstream to downstream guinea mali senegal and mauritania it is formed by the confluence of three affluents that take their sources from the fouta djallon highlands in guinea the bafing the bakoye and the falémé due to the delayed contribution of groundwater the annual flood peak occurs a few weeks later than in sahelian niger fig 2 whose seasonal hydrological signal follows that of precipitation more closely seven stations whose major contributions come from within the sudano guinean region are analyzed for the senegal river including the bafing falémé and bakoye affluents covering a total drainage area of 218 000 km2 globally from upstream to downstream the stations are as follows the bafing at daka saidou 1954 2015 15 700 km2 and bafing makana 1961 2015 21 290 km2 the falémé at gourbassi 1954 2015 17 100 km2 and kidira 1951 2015 28 900 km2 the bakoye at oualia 1955 2015 84 700 km2 and the senegal at kayes 1951 2015 157 400 km2 and bakel 1950 2015 218 000 km2 the last two kayes and bakel are located downstream of the manantali dam whose construction was completed in 1988 the bakel station s catchment area includes those of all other stations studied and represents the quantity of water that flows into the downstream valley 2 2 2 sahelian tributaries of the niger river with a drainage area of 2 170 500 km2 the niger is the largest river in west africa although only around 1 400 000 km2 of its surface is estimated to effectively contribute runoff to the niger river tarhule et al 2015 it originates in the fouta djallon highlands in guinea andersen and golitzen 2005 after spreading to form an inland delta in mali it reconverges and continues its course through the sahelian region in niger crossing benin and nigeria before arriving at its outlet in the gulf of guinea for the present study analysis within the niger basin focuses on the drainage area responsible for the sahelian floods of the niger river descroix et al 2012 cassé et al 2016 that discharges its flows downstream of ansongo and upstream of niamey fig 1 an effective drainage area of 125 000 km2 an aggregated data set extracted from the difference between the niger river streamflow series at niamey and ansongo during the local sahelian rainy season 1953 2012 see cassé et al 2016 for more details represents this area for the subsequent analysis this data series is hereafter referred to as the sahelian niger river snr series fig 2 shows the average seasonal signal of the snr series the left bank of the niger river within this catchment is largely endorheic it only contributes to the niger river during heavy rain events which generate small rivers that sporadically reach the main niger river bed although some evidence suggests that endorheic rupture is increasing in recent years mamadou et al 2015 the right bank of the niamey ansongo reach consists of three major catchments the gorouol the sirba and the dargol which together cover a total area of 90 540 km2 three data series are studied for these catchments the gorouol at alcongui 1957 2015 44 850 km2 the sirba at garbe kourou 1956 2015 38 750 km2 and the dargol at kakassi 1957 2015 6 940 km2 all three rivers are intermittent and only flow during the rainy season following the general pattern seen in fig 2 3 theoretical framework and methodology extreme value distributions evds applied in a non stationary context comprise some of the recent robust methods proposed for the detection of non stationarity olsen et al 1998 cunderlik and burn 2003 re and barros 2009 marty and blanchet 2012 park et al 2011 beguería et al 2011 panthou et al 2013 blanchet et al 2016 besides performing detection evds also permit the quantification of trends and the evaluation of uncertainty the principle of these methods is based on fitting evds both in stationary mode stationary parameters and in non stationary mode time dependent parameters the performance of the fitted models is then compared based on the capacity to accurately describe the data sample goodness of fit and the complexity of the model parsimony by searching for the most suitable temporal functions of parameter evolution one can obtain an indication of the shape of the non stationarity the retained non stationary model features vectors of parameters that best describe the data series in a statistically significant manner 3 1 selection of extreme discharge values extreme values can be defined as probabilistically rare occurrences or values that are exceptionally large or small in magnitude extreme values can be extracted from a time series by two main approaches by taking the maximum value within a given period or by considering all values above a determined threshold in this study as in many climate and hydrological studies see previous paragraph for examples extremes are defined as the maximum value of each year a year is considered a long enough period for the extraction of maximum values for use in the subsequent analysis coles et al 2001 at each station the analyzed data series is formed by the annual maxima of daily discharge amax the selected amax values were controlled for data quality all eleven series span at least fifty years which provides sufficient data points for the calibration of a statistical distribution data quality evaluation was focused on peak flow months as demonstrated by west africa s consistent seasonal signal fig 2 the local rainfall generated flood peak occurs on average within the months of august and september in both the sahelian and sudano guinean zones missing values before and after these months are unlikely to have an effect on the quality of the extreme flow data on the other hand a missing value during the peak streamflow months may have been the amax for that year identifying an incorrect data point as an extreme value would have an impact on the analysis with the potential impact of data quality in mind the data series were evaluated for the stations in the senegal river basin the year was removed from the series if any daily streamflow value was missing during the months of august and september for stations in the niger river basin the hydrographs were viewed year by year if values were missing near the flood peak the year was removed years were also removed where recording errors that could affect flood peaks were perceived for example for one year it seemed that 100 m3 s were added to all values fig 3 displays a sample of the amax data used from the bafing makana station for the senegal river fig 3a and snr series for the niger river fig 3b one can note that although there appears to be some trend there is also a high degree of variability the amax values at the bafing makana station started decreasing in magnitude in the 1960s and started increasing in approximately the 1980s this visual trend was also found for the other senegal stations in sahelian niger however the increase appears to have begun earlier during the drought years of the 1970s 3 2 formulation of statistical models 3 2 1 gev distribution a suitable statistical function used to represent the distribution of a random variable y defined by block maxima is the gev distribution coles et al 2001 written as 1 f gev y μ σ ξ exp 1 ξ y μ σ 1 ξ for 1 ξ y μ σ 0 where μ is the location parameter a measure of central tendency σ the scale parameter a measure of dispersion ξ the shape parameter a measure of tail behavior and y the value at which the gev is to be evaluated the gev distribution is fitted on amax series y i with constant parameters s gev eq 2 and various forms of time t in years varying parameters ns gev eq 3 2 y gev μ σ ξ 3 y gev μ t σ t ξ t 3 2 2 identifying appropriate temporal functions for gev parameters the implementation of one ns gev model requires choosing the general form of the appropriate temporal function for each gev parameters as there is no theoretical model for the time dependent function it must be assigned a priori in order to determine a range of suitable functions an initial exploration of trends is done by fitting s gev distributions in moving windows over the study periods a window size of 15 years has been selected as a compromise between having sufficient data to fit the gev and highlighting potential parameter evolution due to the difficulty in estimation the parameter ξ was first calibrated using the entire data sample then kept stationary while μ and σ change with each window fig 4 displays an example of the moving window for μ 4a and σ 4b for the bafing makana station for this station both parameters are characterized by a v shaped pattern which is more distinct for μ than σ based on the moving window analysis for the 11 different stations it was identified that μ and σ can be qualitatively described by one single or several connected linear segments for all stations it was visually observed that changes in μ were more clearly defined than changes in σ one can note here that the moving window method allows for qualitatively assessing the overall trends in gev parameters however unlike ns gevs the moving window does not allow for the quantification of the trend nor its significance 3 2 3 formulation of gev parameter temporal functions according to the qualitative analysis derived from the moving window gev several temporal patterns with varying complexity were identified to describe the gev parameters linear double linear with one breakpoint and triple linear with two breakpoints temporal functions were considered for μ σ or both in the case of both parameters varying μ and σ were permitted to vary independently as with the moving window ξ was kept constant a non linear polynomial model was also considered initially but showed no improvement over the multilinear models to represent this non stationarity mathematically we introduce the function η t where η represents either μ or σ and t is a time dependent covariate η t takes on different forms depending on the trend model stationary parameter model 4 η t η 0 this parameter model has only one degree of freedom η 0 single linear trend 5 η t η 0 η 1 t in this case η t has two degrees of freedom η 0 and η 1 and thus one additional degrees of freedom in comparison with a stationary parameter double linear trend 6 η t η 0 η 1 t t 1 for t t 1 7 η t η 0 η 2 t t 1 for t 1 t t 1 represents the breakpoint in time year index where the two linear segments join i e where the slope of the linear model changes in this case η t has four degrees of freedom η 0 η 1 η 2 and t 1 meaning three additional degrees of freedom in comparison with a stationary parameter model triple linear trend 8 η t η 0 η 1 t t 1 for t t 1 9 η t η 0 η 2 t t 1 for t 1 t t 2 10 η t η 0 η 2 t 2 t 1 η 3 t t 2 for t 2 t in this case η t has six degrees of freedom η 0 η 1 η 2 η 3 t 1 t 2 a total of 13 different gev models are considered one with all parameters stationary s gev and 12 ns gev models that combine the above parameter trend models in eqs 4 5 7 10 for μ and σ they are reported in fig 5 classified according to their degrees of freedom 3 3 model fitting for s gev the parameters are directly fitted using maximum likelihood estimation mle in the ns gev scenario for each temporal function linear multi linear the following procedure is performed 1 if the formulation includes one or two breakpoints the year of each breakpoint t i is defined before estimating the other parameters η i in order to limit border effects the breakpoint s must be positioned not earlier than 10 years after the beginning of the series and no later than ten year before the end likewise two successive breakpoints must be separated by at least 10 years the breakpoints are defined independently for μ t and σ t and can be at a different point in time though not necessarily 2 at each defined breakpoint the parameters η i are estimated according to the formulations of η t in eqs 4 5 7 10 using mle 3 repeat steps 1 and 2 until all possible breakpoint dates have been tested 4 retain the model that gives the maximum likelihood among the different breakpoint dates tested in steps 1 to 3 3 4 selection of the best gev model a more complex model may provide better fit but not to a degree that merits additional parameterization the selection of the best model is done by comparing the maximum likelihood obtained by the 13 different gev models per station and evaluating their significance the selection process consists of two steps first an initial best model is selected via the akaike information criterion aic akaike 1974 then the model choice is validated via a likelihood ratio test lrt coles et al 2001 according to kim et al 2017 aic and lrt are both suitable for evaluating non stationary representations of hydrological data aic in particular is robust with small data sets the aic balances model fit against model complexity in the following equation 11 aic 2 k 2 log l where k is the number of parameters in the model and l is the maximum likelihood value associated with the model the model with the lowest aic value is selected the lrt is a test between two models that must be nested the simpler model is contained within the more complex models while aic compares all models globally lrt validates the addition or subtraction of specific parameters the likelihood ratio test lrt is performed by comparing the following statistic to the χ 2 distribution 12 d 2 log l m 1 log l m 0 where log l is the maximum value of the log likelihood of model m and m 0 is nested in m 1 if d exceeds the α quantile of the χ 2 distribution with n degrees of freedom with n the difference in the number of parameters between the two models additional degrees of freedom then the more complex model is accepted at level α for this study aic is first used to find an initial model of best fit for each station the model selection via aic is then validated using lrts all models that are nested within the model selected via aic are tested in pairs with the selected model using the lrt with α 0 10 this confirms that the added complexity is significant more complex models that have the aic selection as a nested model are likewise tested in pairs against the aic selection using the lrt to validate the exclusion of additional parameters note that the inclusion of the stationary gev model in the comparison allows for the evaluation of the presence of a non zero trend accompanied by a significance level if the selected model is an ns gev then the stationary hypothesis is rejected 3 5 return level evaluation the use of a parametric distribution for representing the data allows for the estimation of return levels r t corresponding to return period t the return level r t is exceeded with a probability p in a given year where p 1 t the return levels can be calculated as follows 13 r t μ σ ξ 1 log 1 p ξ for non stationary models the corresponding value of μ and σ for the ns gev are inserted in eq 13 at each time step in order to obtain the non stationary return levels for a given p a comparison of the relative evolution of return levels was conducted using normalized return level values for each station the normalization was conducted by dividing the values of the non stationary return levels by the value r t calculated under the stationary assumption s gev 14 r t normalized r t ns gev r t s gev 3 6 uncertainty assessment confidence intervals for model parameters were determined via nonparametric bootstrapping efron 1979 efron and tibshirani 1994 davison and hinkley 1997 while approximate confidence intervals can be calculated via approximation to the normal distribution the approximation becomes less valid for the parameter ξ and for values at the tail of the distribution high return periods thus bootstrapping was selected as providing a more accurate representation of the uncertainty for each station a data sample of equal length to the original series was extracted via resampling an ns gev of the same model type and with the same breakpoint as the selected ns gev for the station was calibrated on the sample this was repeated 500 times for each station samples were discarded if their ns gevs had a ξ value greater than 1 or less than 1 or if there were errors while estimating the ns gev and associated uncertainties likely due to particularly skewed samples same values selected many times extreme values overselected etc confidence intervals for the percentiles of interest were then calculated at each time step of the data series in the methodology used for this study the breakpoints were fixed before performing mle to estimate the ns gev parameters the uncertainty evaluation methods detailed above assume that the uncertainty in breakpoint estimation is negligible compared to the uncertainty in the estimation of the other ns gev parameters uncertainty of the η i this assumption is explored further in subsection 5 3 3 4 results 4 1 selected gev model table 2 shows the model of best fit that was selected for each station with a p value α of 0 10 used in the lrt one can note that for all stations an ns gev model always fit the series of amax better than the stationary gev model fig 6 visualizes an example of these models with moving window parameter values circles and selected ns gev model μ values line confidence intervals for μ are shown with dashed lines one can see that the selected models follow the general trends seen in the moving window parameter estimation of μ a double linear model was selected for μ for all stations with the exception of the alcongui station in the gorouol basin which was best represented by a linear model for μ although a double linear model would have been accepted at α 0 15 the selection of a double linear model indicates that the slope of the trend for μ differed significantly between two subperiods of the time series in the senegal river basin significant breakpoints were consistently found for μ between 1980 and 1984 for all stations the slope of the central tendency was negative decreasing trend during the period up until the early mid 1980s then became positive through the modern period the changes in μ were less rapid in all stations during the latter period kayes and bakel the two stations downstream of the manantali dam showed the least relative increase of all stations of the stations in the senegal river basin the daka saidou kidira and oualia stations demonstrated significant non stationarity in the scale parameter σ all non stationarity σ models were double linear daka saidou s breakpoint for σ was in 2000 while kidira and oualia both occurred in the 1990s 1995 and 1994 respectively this reflects the general decrease throughout the majority of the time period under study then rapid increase in variability seen in the moving window for σ during the 1990s at these stations for the sahelian stations in the niger river all stations showed an increasing trend starting as early as the 1970s however the specific model characteristics were less homogeneous between the different stations than for the senegal river stations although all models were double linear for μ breakpoints for μ were found in the 1990 for the dargol at kakassi and 1997 for the sirba at garbe kourou the slope of the trend was positive for both subperiods for these two stations with a greater more rapidly increasing slope during the more recent period for the snr data series the slope was gradually decreasing during the earlier period of record up until 1968 then increasing at a higher absolute magnitude during the more recent period the gorouol series at alcongui was linearly increasing throughout the period for μ the snr and sirba series showed significant trends in the σ parameter for the snr series the change in σ was determined to be linearly increasing for the sirba the model for σ was double linear with a breakpoint in 1977 the models closely follow the moving window estimates 4 2 extreme discharge tails behavior table 2 also shows the most likely ξ values for each distribution a heavy tailed gev distribution ξ 0 indicates that larger values are possible and more probable than if ξ 0 ξ 0 means that the distribution is bounded rare values will approach but not exceed a maximum threshold for the senegal river all ξ values were either close to zero gumbel distribution unbounded but not heavy tailed or negative weibull distribution almost all ξ values for the sahelian niger basin stations were positive frechet distribution which means the distribution of the values is heavy tailed without an upper bound the exception was the gorouol station at alcongui which had a slightly negative ξ value weibull distribution bounded however the 95 confidence intervals for ξ for all stations in both river basins included both positive values and negative values with the exception of the bafing makana station where the interval was entirely in the negative range weibull distribution 4 3 return level estimates of selected models the main practical advantage provided by the ns gev models is the ability to estimate return levels from the fitted distribution this is illustrated in fig 7 where 2 10 and 100 year return levels are plotted with their 90 confidence intervals for the bafing makana and dargol stations return levels in the senegal basin followed the general pattern of bafing makana first decreasing below the stationary level then increasing again return levels for the stations studied in the niger river started increasing earlier than for the senegal river note the increase in the size of the confidence level with the longer return periods for shorter 2 and 5 year return periods the confidence intervals for the non stationary model were more likely to be distinctly higher than those of the stationary model especially at 10 year and longer return levels the confidence intervals of the stationary and non stationary models increasingly overlap fig 8 demonstrates this separation and overlap between the confidence intervals of the stationary model and the chosen ns gev model for each station over time the shades on the graph indicate up to which degree of confidence 80 99 the ns gev model and s gev model return level confidence intervals are disjoint with the color indicating whether the ns gev confidence interval was centered higher red or lower blue than the confidence interval of the s gev model one can note from fig 8 that all of the senegal stations were significantly above the s gev at the beginning of the record for the 2 year return levels 8a only bafing makana in senegal was higher than its corresponding s gev at the end of the data record the uncertainty increases with longer return periods with none of the ns gevs significantly higher than the s gev at the end of the record for 25 year return levels or greater ns gev return levels for the oualia kidira gourbassi and daka saidou stations were at approximately the stationary return level at the end of the study period or below the stationary level for longer return periods overall the return levels of stations in the senegal basin spend much of the period of record significantly below the s gev one can note that the difference persists into the modern period for the bakel data series one of the stations affected by the manantali dam for the stations in the niger river at the most modern data points the 90 confidence intervals surrounding the 2 and 5 year return levels globally surpassed the confidence intervals of the stationary return values for the sirba and dargol this separation existed also at the 99 confidence level and at the 95 confidence level for the gorouol the exception was the snr series whose lower non stationary 90 confidence bound was slightly within the upper confidence bound of the stationary value for 5 year return levels fig 9 compares the 2 and 5 year return level changes between all stations with values normalized by each station s stationary return level i e the return level estimated using the stationary gev model eq 14 the separation in terms of return level evolution between the stations in the senegal and niger river basins is especially clear for the two year return levels the two year return levels of the senegal river stations blue start at around 1 5 times the stationary return level y axis 1 reduce to as low as 0 5 during the 1980s then increase throughout the modern period bakel and kayes the two senegal stations affected by the manantali dam have notably lower relative increases in return level values these two stations reached to near the stationary return level value at the end of the study period whereas the other stations all exceeded it and reaches values between 1 and 1 5 times the stationary return level this shows the influence of the dam on trends in maximum values one can hypothesize that without the influence of the dam the stations bakel and kayes would have more closely followed the trend of the other stations that are located either upstream of the dam or on other tributaries of the senegal river for the niger river stations red all stations started below the stationary 2 year return level and ended well above it for most of stations the 2 year non stationary return levels move from less than 0 7 to more than 1 5 times the stationary return level meaning a doubling discharge for a two year return period in roughly 50 years the snr series in particular tripled its relative value over the study period as for the five year return levels the regional separation becomes less clear due to the greater influence of the scale parameter at higher return levels however the relative decreases and increases by region remained similar bakel and kayes remain relatively lower than the other senegal stations 4 4 scale effects of drainage area the absolute magnitude of the increase in μ was directly correlated with the size of the drainage area of a given station however no correlation was found in the relation between the relative increase in μ and the drainage area for the sahelian niger a moderate correlation pearson s ρ 0 6 was found between drainage area and return level for return periods of 25 years or longer the trend was more evident in the senegal basin when the stations bakel and kayes were removed the correlation was greater than 0 6 for return periods of 5 years and longer a similar correlation ρ 0 6 was found between drainage area and the ξ parameter in both regions the two year return levels demonstrated little to no correlation with drainage area ρ 0 25 given the limited number of data points it is difficult to draw conclusions based on these results 5 discussion 5 1 comparison of results with literature the above results confirm the rising trend in extreme streamflow values since the 1970s and 1980s previously found in other studies cassé and gosset 2015 nka et al 2015 aich et al 2016 the trends found in the guinean stations in the senegal river basin in this study followed the trends found in aich et al 2016 for the guinean stations in the niger river basin in both studies a decreasing trend was found until approximately the mid 1980s followed by an increasing trend results are overall consistent with nka et al 2015 s findings that extreme discharge is reduced in recent years compared to what it was several decades ago the models in the present study also detected a moderate increase in recent years whereas in nka et al 2015 there was no significant trend since the 1970s the relatively lower trends at the kayes and bakel stations can be explained by the construction of the manantali dam upstream in 1988 which would have controlled many of the larger flows this is in agreement with the results in faye 2015 which showed that monthly flow coefficients at bakel were lower for peak season months in the period after dam construction than they were before dam construction at the stations of bafing makana oualia and kidira flow coefficients were higher for peak months when comparing the same time periods the breakpoint found at 1990 in the ns gev for the dargol at kakassi falls in between the breakpoints found by nka et al 2015 at 1987 for amax and 1993 for peak over threshold values for sahelian stations aich et al 2016 found a decreasing trend until the 1970s followed by an increasing trend the initial decrease was found only in the snr and gorouol series but all sahelian stations tested show an increase since the 1970s a breakpoint was found in the mid 1970s for the sirba and early 1970s for the gorouol which is roughly consistent with the results in the present study the shifts in trends found in the snr series 1968 and gorouol series 1972 falls at the same point in time as the general climate shift in the late 1960s as well as the mean discharge breakpoint identified in tarhule et al 2015 however whereas the climate and mean streamflow shifts decreased after the break the snr series and likewise all series for the sahelian niger went from a low or negative slope to a positive slope this is reflective of the well documented sahelian paradox albergel 1987 descroix et al 2018 where locally generated streamflow in the sahel began increasing during the drought period in spite of an overall reduction in rainfall 5 2 evaluation of the parameter ξ in addition to the difference in timing and magnitude of trends between the sudano guinean and sahelian regions differences in the shape parameter ξ were also found the fact that the ns gevs for sudano guinean stations were generally weibull or gumbel ξ 0 and sahelian stations were generally frechet ξ 0 could be due to the differences in hydrological functioning in the sudano guinean region the flow type is hewlettian and groundwater plays a greater role a larger portion of the precipitation first infiltrates and contributes to river discharge at a later time smoothing out the high spatio temporal variability of fine scale rainfall intensities flood generation is thus sensitive to both the initial conditions of the basin groundwater storage subsurface water etc and the amount of rainfall accumulated over the basin in the sahel streamflow is driven by hortonian processes local precipitation generated runoff and therefore is sensitive to the intensity of rainfall at small scales the role of initial conditions seems to be smaller in comparison to factors such as the area affected by high intensities over a short time period these differences in the spatio temporal scale of the processes primarily responsible for flood generation in the two regions could explain in part the differences in the tail behavior of extreme discharges between the two regions indeed it is observed that rainfall at fine spatio temporal scales sahelian flood generation has heavy tail behavior koutsoyiannis 2004 panthou et al 2012 while rainfall averaged over larger spatio temporal scales sudano guinean flood generation is expected to have bounded tail behavior this said great care must be taken in drawing conclusions from results for ξ as the confidence intervals are large table 2 and include both positive frechet and negative weibull values for almost all stations the confidence intervals themselves seem to indicate a difference in tail behavior between the two regions the lower bounds of the 95 confidence intervals for ξ in the senegal catchments are much lower than the lower bounds in the sahelian niger catchments with the exception of the gorouol and the upper bounds are generally lower in the senegal basin as well though less universally however due to the great overlap between the confidence intervals it is difficult to draw conclusions with a high level of certitude 5 3 sensitivity analyses robustness of the results 5 3 1 sensitivity of the model selection process to the different tests and the p value threshold chosen for the lrt for three out of the eleven data series the additional application of the lrt test modified the model selection in all three cases the model became simpler the scale parameter σ for bakel became stationary the location parameter of kayes became double linear instead of triple linear and the gorouol model became simple linear for μ instead of double linear for ten out of the eleven data series the model selection did not change with an increase in lrt test stringency with the p value equaling 0 05 the only change with the stricter requirement were that σ became stationary for the snr series with less strict criteria α 0 15 the results more closely approximated the initial aic selection results σ was modeled as linear non stationary for the bakel station instead of the stationary model for σ selected at the α 0 10 significance level the gorouol station became double linear for μ and stationary for σ the kayes station ns gev at the p value of 0 15 was a double linear model for μ and a simple linear model for σ the general trends strongly positive over the past few decades for μ and return levels did not change with the choice of the model of note at the α 0 15 significance level is the triple linear model selected for μ for kayes the kayes station s flow has clearly been regulated by the installation of the manantali dam in 1988 which may have resulted in three distinct phases over the study period rather than two 5 3 2 sensitivity of the model parameters to optimization methodology the choice of mle parameter optimization method did not have a significant impact on model parameter results nor on model selection results optimization methods tested were nelder mead nelder and mead 1965 bfgs shanno 1970 conjugate gradients fletcher and reeves 1964 l bfgs b byrd et al 1995 and simulated annealing bélisle 1992 however the boundary limit between breakpoints and the edge of the data series did have an impact on the selection of the breakpoint this could be of interest as the main breakpoint in the early mid 1980s in senegal was less than ten years before the construction of the manantali dam as a triple linear model with a distance between breakpoints of one decade was almost selected initial aic model selection for the kayes station which is downstream of the dam the limitation could have had an impact on model selection 5 3 3 additional sources of uncertainty one source of uncertainty lies in the accuracy of the rating curves for each of the stations in this study jalbert et al 2011 morlot et al 2014 rating curves in regions subject to sedimentation such as the sahelian niger river basin risk being nonstationary in time rating curves may also be less accurate for extreme values if measurements of flow of comparable magnitude were not used in the rating curve calibration although some stations notably kidira bakel daka saidou and niamey included such large values this was not the case for all stations however rating curve uncertainties while possibly influencing the specific magnitudes of results are highly unlikely to be the cause of the consistent trends detected and thus do not alter the conclusions of the present study trend detection was conducted using a regional approach with two large river basins within the region and several stations within each river basin the regional approach makes the methods robust and smooths the effect of uncertainty related to rating curves one can also question the influence of the choice of breakpoint on the uncertainty of the results sensitivity testing was performed with the bafing makana and snr series over a breakpoint range of five years before and after the breakpoint of the selected model the spread of the 95 confidence interval of the selected model one fixed breakpoint was compared with the spread of the global confidence interval obtained from the range of breakpoints the area within the global confidence interval but outside the selected model s confidence interval is due to breakpoint uncertainty based on this the contribution of breakpoint estimation uncertainty to the overall uncertainty is on average 13 for bafing makana and 15 for snr for a breakpoint range of plus and minus five years from the selected breakpoint it was thus verified that the primary source of uncertainty comes from the gev calibration process performed in step 2 of subsection 3 3 uncertainty of the η i and not from uncertainty about the position of the breakpoint 6 conclusions and implications the preceding analysis proposed a selection of ns gev models for hydrological annual maxima in west africa in all cases the ns gev model was significantly more representative of the data series than the stationary gev model the trend is positive since the 1970s for the sahelian stations and the mid 1980s in the sudano guinean stations with both regions demonstrating an intensification of the hydrological signal certain parameters and return levels notably the μ parameter and the 2 and 5 year return levels surpass the values expected with a stationary model with a high level of confidence at certain stations the results improve over other studies by providing the underlying statistical distributions for the non stationary data series confidence intervals on parameter values return level estimates and a model selection process with robust criteria it also compares two subregions and notably includes an extracted data series for the cumulative sahelian red flood inputs to the niger river although west africa is used as a test region these analyses can be applied to hydrological time series elsewhere in the world the methods used in this paper have some limitations first only parametric models that were preselected as potential best models are evaluated thus eliminating a large range of other potential models second the study only consider breakpoints that are transitions from one linear slope magnitude to another not abrupt shifts furthermore uncertainty is high which reflects the current reality the methods also require a certain level of expertise for use and interpretation additionally the estimated uncertainties do not take into account the uncertainty in the estimation of streamflow via rating curves which could have a significant impact on the accuracy of extreme values jalbert et al 2011 morlot et al 2014 however the methods proposed in the present study are advantageous for several reasons it is possible to use other trend and breakpoint detection methods but many of these tests assume that the data is normally distributed which is not the case with extremes and thus will not be robust with data sets consisting of extreme values classic breakpoint detection tests such as the pettitt test may work but do not provide an estimate of the magnitude of the trend they also do not permit the estimation of return levels which is a significant advantage of the methods based on fitting probability distributions proposed in this paper the power of classical trend and breakpoint tests to reject the null hypothesis when applied to extreme value series is also known to be lower than when applying tests specific to gevs moreover even if some expertise is required to use them the r packages used in this study are freely available heffernan et al 2016 the results for the return level estimates indicate that if the stationary model were to be used it would underestimate the current return levels in the sahelian reaches of the niger river for example the non stationary ten year return level for the snr series in 2012 is 600 m3 s 1 larger than the value estimated from a stationary model for all four data series in the sahelian niger at the end of the data record 2012 2015 the non stationary 2 year return level exceeds the 5 year stationary return level indicating an increase in frequency of events of greater magnitude the nonstationarity of the return levels has direct implications for hydraulic works construction and river basin management in both sahelian and sudanian areas the identified increase of 2 10 year return levels is important for small structures and might have contributed to the increasing number of damaged and destroyed bridges and roads reported over the last decades amani and paturel 2017 in the senegal basin an accurate estimation of higher return level values for return periods greater than 25 years is needed not only for the management of existing dams such as the ones at manantali diama and félou but also for the construction of additional structures such as spillways and the hydroelectric dams planned by the organization for the valorization of the senegal river in french omvs see bonneau 2001 as the region surrounding niamey in the niger basin continues to be threatened by severe flooding accurate return level estimates are required in order to ensure that flood protection systems can protect against a given flood in all of the above cases if a stationary model is used it risks overestimating or underestimating the magnitude of river discharge uncertainty remains high for longer return periods this is largely tied to the size and variability of the data set estimating a 100 year return level based on only 60 years of data forcibly has a high level of uncertainty as more data is collected uncertainty will decrease and the ability to more precisely estimate return levels for longer return periods will likely improve provided that the data is represented by a model that best suits its trends uncertainty may also be reduced with a greater understanding of flood drivers much speculation and study has occurred in attempt to determine the causes of the changes in flood peaks in the west africa seguis et al 2004 leblanc et al 2008 d orgeval et al 2008 descroix et al 2009 descroix et al 2012 descroix et al 2018 aich et al 2015 cassé and gosset 2015 cassé et al 2016 in addition to climate changes west africa has undergone extensive land cover changes loireau 1998 anyamba and tucker 2005 descroix et al 2009 including a considerable increase in the percentage of cultivated area from the 1950s 2000s cappelaere et al 2009 whereas much of the sahelian paradox during the drought can be attributed to land use land cover changes in recent years changes in river discharge seems to correlate more with changes in precipitation case in point the regional trends found in this study follow those found for mean non zero rainfall in senegal and the central sahel in blanchet et al 2018 the issue is complex for example in the present study the sirba basin streamflow did not increase as much as that of the dargol and gorouol yet it both receives more rainfall 500 mm as opposed to 400 mm annually and had increased runoff coefficients most likely due to the impacts of agriculture descroix et al 2012 land use and climate also have impacts at different scales blöschl et al 2007 an improved understanding of the attributed causes of trends in extremes would give guidelines for the projection of pertinent results into the future such an approach would require coupling ns gev models with projected climate and land use changes factors to be taken take into account are both climate projections at the scale of hydrological processes and socio economic scenarios that allow for the estimation of the anthropic pressure on the soil and the resulting changes in hydrodynamic parameters projection of model results into the future however must be done with caution due to the potential of future shifts in trends and decadal variability not accounted for in the climate and land use trends we recommend that those dimensioning hydraulic works seriously consider the possibility that hydrological extremes are increasing as this is the current evidence available this is especially pertinent for the coming decade over which evidence supports an increasing frequency of extreme rainfall and ongoing hydrological intensification taylor et al 2017 panthou et al 2018 with this in mind we recommend that stakeholders design structures with a shorter design life span 10 20 years with the assumption that extremes will most probably increase such structures include flumes small urban hydraulic structures pumps levees and smaller dams for longer life structures such as large dams and spillways they should continue to consider all factors including the possibility that the trend may change and decrease again despite the potential impacts of projected land use changes and the ongoing warming of the sahara that triggers intense rainfall events the decadal variability of climate in the region is also likely to continue in spite of the uncertainties the present study concludes within a strict level of confidence that hydrological extremes are currently increasing and although uncertainty about the magnitude of this increase is high it is more concrete and certain than speculation about an unknown future the trends are consistent for all stations within each watershed despite flow uncertainties we advise that stakeholders place importance on the possibility of greater and more frequent flood magnitudes especially while designing smaller structures but also for larger structures we further recommend that they take causal factors into account although more studies are needed in order to understand the mechanisms of flood drivers acknowledgements the research leading to these results has received funding from the nerc dfid future climate for africa program under the amma 2050 project grant ne m020428 1 this work was also supported by the french national program ec2co lefe recent evolution of hydro climatic hazards in the sahel detection and attribution ansoumana bodian benefited from a grant received from the french embassy in senegal which financed exchanges with other researchers we warmly acknowledge the niger basin authority abn and the organisation pour la mise en valeur du fleuve sénégal omvs for providing the niger river and senegal river discharge data 
6959,in recent years west africa has witnessed an increasing number of damaging floods that raise the question of a possible intensification of the hydrological hazards in the region in this study the evolution of extreme floods is analyzed over the period 1950 2015 for seven tributaries in the sudano guinean part of the senegal river basin and four data sets in the sahelian part of the niger river basin non stationary generalized extreme value ns gev distributions including twelve models with time dependent parameters plus a stationary gev are applied to annual maxima of daily discharge amax series an original methodology is proposed for comparing gev models and selecting the best for use the stationary gev is rejected for all stations demonstrating the significant non stationarity of extreme discharge values in west africa over the past six decades the model of best fit most commonly selected is a double linear model for the central tendency parameter μ with the dispersion parameter σ modeled as either stationary linear or a double linear change points in double linear models are relatively consistent for the senegal basin with stations switching from a decreasing streamflow trend to an increasing streamflow trend in the early 1980s in the niger basin the trend in μ is generally positive since the 1970s with an increase in slope after the change point but the change point location is less consistent the recent increasing trends in extreme discharges are reflected in an especially marked increase in return level magnitudes since the 1980s in the studied sahelian rivers the rate of the increase indicated by the study results raises urgent considerations for stakeholders and engineers who are in charge of river basin management and hydraulic works sizing keywords floods flood hazard west africa non stationarity extreme values model selection 1 introduction river floods are one of the deadliest natural hazards in the world they produce major damages on infrastructure lead to economic losses and favor water borne diseases in order to better understand such floods hydrologists have long focused on assessing the rare large in magnitude river discharge values represented by the tails of underlying statistical distributions gumbel 1957 the primary aim besides theoretical understanding is to provide practical tools for flood risk management and civil engineering structure design the main challenge for practical applications is estimating return levels for high return periods typically 10 50 or 100 years the more the return period is larger than the length of the series the greater the challenge of estimating the tail of the distribution extreme value distributions evds are statistical tools designed for the study of such rare values see e g coles et al 2001 katz et al 2002 for several decades the main challenge when applying evds was to have a proper estimation of the tail heavy light or bounded the focus was then on developing robust estimation procedures regional frequency analysis hosking and wallis 1997 gradex and adaptation guillot 1993 paquet et al 2013 bayesian inference coles and tawn 1996 among many other developments and then applying them to the longest hydrological series available koutsoyiannis 2004 the stationarity assumption reigned during this old hydrological world milly et al 2008 however both increases and decreases of extreme discharges have been reported via the evaluation of historical series around the world e g kundzewicz et al 2005 bower 2010 condon et al 2015 a main challenge of hydrological extremes thus concerns the validity of the stationarity assumption and the implications of its rejection ongoing global changes are expected to increase flood hazard mainly through the intensification of the hydrological cycle due to global warming hirabayashi et al 2013 arnell and gosling 2016 and the degradation of land surfaces due to anthropic pressure brath et al 2006 elmer et al 2012 other factors also tend to reduce flood hazards including negative precipitation trends found in drying regions and flood protection structures such as dams while some regions witness resulting changes in flood frequency in other regions no changes have been detected villarini et al 2009 this could be a result of either the absence of substantial changes in drivers that could trigger influence flood trends or competing phenomena that act in opposite ways it could also be due to the use of non robust methodology to detect concrete changes in the evd of discharge the last case necessitates improved methods able to detect trends in series characterized by low signal to noise ratio while numerous studies on flood hazard evolution have been undertaken for developed countries less has been done in the developing world this is the case in particular over the tropics kundzewicz et al 2005 which contain two thirds of the developing countries including the poorest populations living in the tropics are notoriously vulnerable to climate hazards including droughts and floods that can occur within the same year at a given place global changes are expected to strongly impact flood risks in the tropics with studies already reporting significant increases in the frequency of rainfall extremes allan et al 2010 o gorman 2012 asadieh and krakauer 2015 land use cover changes lambin et al 2003 erb et al 2016 rapid rates of urbanization di baldassarre et al 2010 and increasing vulnerability of populations due to very high demographic growth the population of the least developed countries is expected to double from now to 2050 population reference bureau 2016 the strong internal variability of tropical climates the lack of long term hydrological observations and the large uncertainty of climate projections in the tropics challenge the scientific community to provide reliable and relevant information to stakeholders so they can define suitable flood risk management strategies west africa is one of the most critical tropical regions for examining hydrological non stationarities as it is a region in which the issues described above are exacerbated west africa is known for having strong precipitation variability especially at the decadal level nicholson 2013 it underwent a devastating and long lasting drought that abruptly started in the late 1960s and persisted through the 1970s and 1980s lamb 1983 barbé et al 1997 nicholson 2000 camberlin et al 2002 barbé et al 2002 l hote et al 2002 dai et al 2004 panthou et al 2014 bodian et al 2011 bodian et al 2016 at the regional scale this led to a decline in the flow of large rivers that was proportionally greater than the decrease in rainfall lebel et al 2003 andersen and golitzen 2005 mahé and paturel 2009 at the subregional scale however two diametrically opposed hydrological behaviors were observed descroix et al 2018 in the sudano guinean subregion of west africa south of 12 n a decrease in river flow was observed for small to regional scale catchments mahé et al 2005 descroix et al 2009 until the 1970s and 1980s diop et al 2017 the decrease in flow was attributed to a gradual drying up of the groundwater and thus a gradual decrease in the base flow of the rivers mahé et al 2000 mahé and paturel 2009 in the sahelian region belt between roughly 12 n and 16 n runoff coefficients and runoff volumes increased despite the drought this phenomenon the so called sahelian paradox was understood to have been caused by a change in surface conditions albergel 1987 descroix et al 2009 aich et al 2015 cassé et al 2016 droughts played a role in increasing surface crust and decreasing vegetation gal et al 2017 which consequently increased runoff coefficients and counterbalanced the effects of drought boulain et al 2009 anthropogenic changes including land use change appear to be a major factor in some basins seguis et al 2004 li et al 2007 leblanc et al 2008 gal et al 2017 other factors such as an increase in the density of the drainage network may have played a role in the increase of flow e g favreau et al 2009 gal et al 2017 since the early 1990s both total rainfall and streamflow amounts have increased compared to the drought decades of the 1970s and 1980s though they remain lower than in previous pre drought decades lebel and ali 2009 mahé and paturel 2009 panthou et al 2014 tarhule et al 2015 diop et al 2017 in the sahel the increase was accompanied by higher interannual variability ali and lebel 2009 panthou et al 2014 and overall persistence of drought conditions under certain indices l hote et al 2002 ozer et al 2009 of note is the increase in the intensity of rainfall during recent years ly et al 2013 panthou et al 2014 sanogo et al 2015 taylor et al 2017 during the same period an increase in the number and magnitude of extensive floods has been reported tarhule 2005 tschakert et al 2010 samimi et al 2012 sighomnou et al 2013 cassé and gosset 2015 causing extensive fatalities damages and population displacement from the mean hydrographs of the niger river at niamey plotted for six decades from 1951 to 2010 descroix et al 2012 and sighomnou et al 2013 illustrated a strong increase in the intensity of the summer flood peak of the sahelian tributaries during the 2000s while the flood peaks coming from the remote guinean tributaries and arriving at niamey later in the year at niamey were as low as in the 1970s they also noted successive discharge records produced by sahelian floods in 2010 and 2012 exceeding the guinean flood the strong current and projected demographic growth in west africa population reference bureau 2016 is likely to increase the exposure of populations to floods both from intensive and unplanned human settlements in flood prone areas di baldassarre et al 2010 and from human induced changes in land cover which affect runoff changes in hydrological extremes consequentially are particularly pressing for decision makers in west africa as the statistical tools used for infrastructure design have not been updated since the 1970s amani and paturel 2017 an improved quantitative understanding of how extreme flows are changing over time in the region has generated an urgent demand to design and manage structures such as dams and dikes and as a result aid in risk mitigation as well as the development of hydroelectric energy and irrigation systems however there is still very little literature on quantifying extreme flow changes in west africa for sudano guinean regions nka et al 2015 found an overall decreasing trend that closely followed rainfall indices although decreasing at a higher rate this was the case for the falémé branch of the senegal river at fadougou when only a more recent time period is considered since 1970 no significant trends were found in the sudano guinean catchments including the falémé bodian et al 2013 explored trends in annual maximum daily discharge amax values on the bafing tributary of the senegal river bafing makana and daka saidou stations they found that high points in the series occurred during the pre drought period 1967 and 1955 whereas the minima of the amax occurred in 1984 diop et al 2017 found that extreme highs in the bafing makana series decreased by 18 over the series and especially since 1971 while extreme lows stayed stable aich et al 2016 analyzed time series of amax values at several stations along the niger river they found that changes in amax series followed the decadal variability of mean annual precipitation over guinean and benue area catchments a wet period during 1950s and 1960s followed by a dry period during 1970s and 1980s and values close to the long term mean after while the floods produced by sahelian tributaries have recorded a monotonic increase since the beginning of the 1970s nka et al 2015 found positive trends in the extreme values of three sahelian catchments studied dargol river at kakassi the gorouol river at koriziena and the goudebo river at falagontou they also found significant mann kendall test increases in extreme values in both amax series and peak over threshold pot series for the dargol river at kakassi breaks in amax were detected in 1987 and for pot in 1993 mean extreme values were found to be greater twice as high during the later subperiods the aim of this paper is to detect and quantify trends in extreme hydrological values in west africa discharge series are analyzed in tributaries of the niger and the senegal rivers two catchments that reflect two differing hydrological and climatic processes of the sahelian and the sudano guinean west africa the temporal evolution of the amax series is assessed by exploring different generalized extreme value gev models that range from a stationary gev s gev to more complex non stationary gev ns gev models the following study proposes an original methodology for identifying the most significant model to represent the evolution of extremes for a particular data series notably the retained model is accompanied by significance levels and estimates of uncertainty the retained model is used to compute time varying frequencies of extreme flows these changes are represented by the evolution of flow return levels over the last fifty to sixty years our results thus have implications for operational applications as the design and operation of hydraulic structures depend on the magnitude of a flood event at a given return period 2 region of study and data 2 1 west african hydro climatic features the climate of west africa is controlled by the west african monsoon the rainfall belt roughly follows the seasonal migration of the position of the intertropical convergence zone itcz during the boreal winter december february the rainfall belt is located over the gulf of guinea at around 4 n it moves northward during the spring and reaches its northernmost position during boreal summer june september at the regional scale it implies that the hydro eco climatic features vary along a roughly north south gradient the mean annual rainfall amount decreases from south to north ranging from over 1500 mm near the southern guinean coast 5 n to less than 250 mm over the lower saharan desert limit 18 n the sudano guinean and sahelian regions are distinguished by their mean annual rainfall the sudano guinean region extends between the 1300 mm and 750 mm isohyetal lines and the sahel between 750 mm and 250 mm the regions have different seasonal rainfall cycles during the monsoon period bimodal for the sudano guinean region and unimodal signal for the sahel but are both characterized by a main rainfall peak in boreal summer and a dry season in boreal winter the two regions are also differentiated by their respective vegetation dense vegetation featuring tree savannah woodland and tropical forest for the sudano guinean region bodian et al 2016 dry savannah and sparse bush in the sahel these contrasts influence the dominant hydrological processes characterizing the two regions the sahelian hydrology is distinguished by the prevalence of hortonian overland flow horton 1933 in the event of precipitation water infiltrates until the infiltration capacity of the soil is reached as a consequence runoff production is driven by the hydro dynamic properties of soils at the surface the excess rainfall then runs off into the drainage network groundwater flow plays a minor role in the contribution to streamflow if any due to this river basins located in the sahelian region are more sensitive to changes in fine scale rainfall intensity vischel and lebel 2007 to the south on the other hand the sudano guinean catchments have primarily hewlettian hydrological processes cappus 1960 hewlett 1961 hewlett and hibbert 1967 both surface and subsurface flow contribute to streamflow due to the elevated hydraulic conductivity of soils descroix et al 2009 under the same climatic evolution river basins in the sudano guinean zone may be less responsive to changes in rainfall intensity than in sahelian river basins gascon et al 2015 2 2 study catchments and datasets our analysis of changes in extreme flows is based on data available on two contrasted hydro systems in west africa the upper reaches of the senegal river located within the sudano guinean region and the middle reaches of the niger river located within the sahelian region table 1 overviews the data selection for the study and fig 1 displays a map of their locations 2 2 1 sudanian tributaries of the senegal river the second largest river in west africa is the senegal river the senegal river drains a basin of approximately 300 000 km2 rochette 1974 found within the borders of four countries which are from upstream to downstream guinea mali senegal and mauritania it is formed by the confluence of three affluents that take their sources from the fouta djallon highlands in guinea the bafing the bakoye and the falémé due to the delayed contribution of groundwater the annual flood peak occurs a few weeks later than in sahelian niger fig 2 whose seasonal hydrological signal follows that of precipitation more closely seven stations whose major contributions come from within the sudano guinean region are analyzed for the senegal river including the bafing falémé and bakoye affluents covering a total drainage area of 218 000 km2 globally from upstream to downstream the stations are as follows the bafing at daka saidou 1954 2015 15 700 km2 and bafing makana 1961 2015 21 290 km2 the falémé at gourbassi 1954 2015 17 100 km2 and kidira 1951 2015 28 900 km2 the bakoye at oualia 1955 2015 84 700 km2 and the senegal at kayes 1951 2015 157 400 km2 and bakel 1950 2015 218 000 km2 the last two kayes and bakel are located downstream of the manantali dam whose construction was completed in 1988 the bakel station s catchment area includes those of all other stations studied and represents the quantity of water that flows into the downstream valley 2 2 2 sahelian tributaries of the niger river with a drainage area of 2 170 500 km2 the niger is the largest river in west africa although only around 1 400 000 km2 of its surface is estimated to effectively contribute runoff to the niger river tarhule et al 2015 it originates in the fouta djallon highlands in guinea andersen and golitzen 2005 after spreading to form an inland delta in mali it reconverges and continues its course through the sahelian region in niger crossing benin and nigeria before arriving at its outlet in the gulf of guinea for the present study analysis within the niger basin focuses on the drainage area responsible for the sahelian floods of the niger river descroix et al 2012 cassé et al 2016 that discharges its flows downstream of ansongo and upstream of niamey fig 1 an effective drainage area of 125 000 km2 an aggregated data set extracted from the difference between the niger river streamflow series at niamey and ansongo during the local sahelian rainy season 1953 2012 see cassé et al 2016 for more details represents this area for the subsequent analysis this data series is hereafter referred to as the sahelian niger river snr series fig 2 shows the average seasonal signal of the snr series the left bank of the niger river within this catchment is largely endorheic it only contributes to the niger river during heavy rain events which generate small rivers that sporadically reach the main niger river bed although some evidence suggests that endorheic rupture is increasing in recent years mamadou et al 2015 the right bank of the niamey ansongo reach consists of three major catchments the gorouol the sirba and the dargol which together cover a total area of 90 540 km2 three data series are studied for these catchments the gorouol at alcongui 1957 2015 44 850 km2 the sirba at garbe kourou 1956 2015 38 750 km2 and the dargol at kakassi 1957 2015 6 940 km2 all three rivers are intermittent and only flow during the rainy season following the general pattern seen in fig 2 3 theoretical framework and methodology extreme value distributions evds applied in a non stationary context comprise some of the recent robust methods proposed for the detection of non stationarity olsen et al 1998 cunderlik and burn 2003 re and barros 2009 marty and blanchet 2012 park et al 2011 beguería et al 2011 panthou et al 2013 blanchet et al 2016 besides performing detection evds also permit the quantification of trends and the evaluation of uncertainty the principle of these methods is based on fitting evds both in stationary mode stationary parameters and in non stationary mode time dependent parameters the performance of the fitted models is then compared based on the capacity to accurately describe the data sample goodness of fit and the complexity of the model parsimony by searching for the most suitable temporal functions of parameter evolution one can obtain an indication of the shape of the non stationarity the retained non stationary model features vectors of parameters that best describe the data series in a statistically significant manner 3 1 selection of extreme discharge values extreme values can be defined as probabilistically rare occurrences or values that are exceptionally large or small in magnitude extreme values can be extracted from a time series by two main approaches by taking the maximum value within a given period or by considering all values above a determined threshold in this study as in many climate and hydrological studies see previous paragraph for examples extremes are defined as the maximum value of each year a year is considered a long enough period for the extraction of maximum values for use in the subsequent analysis coles et al 2001 at each station the analyzed data series is formed by the annual maxima of daily discharge amax the selected amax values were controlled for data quality all eleven series span at least fifty years which provides sufficient data points for the calibration of a statistical distribution data quality evaluation was focused on peak flow months as demonstrated by west africa s consistent seasonal signal fig 2 the local rainfall generated flood peak occurs on average within the months of august and september in both the sahelian and sudano guinean zones missing values before and after these months are unlikely to have an effect on the quality of the extreme flow data on the other hand a missing value during the peak streamflow months may have been the amax for that year identifying an incorrect data point as an extreme value would have an impact on the analysis with the potential impact of data quality in mind the data series were evaluated for the stations in the senegal river basin the year was removed from the series if any daily streamflow value was missing during the months of august and september for stations in the niger river basin the hydrographs were viewed year by year if values were missing near the flood peak the year was removed years were also removed where recording errors that could affect flood peaks were perceived for example for one year it seemed that 100 m3 s were added to all values fig 3 displays a sample of the amax data used from the bafing makana station for the senegal river fig 3a and snr series for the niger river fig 3b one can note that although there appears to be some trend there is also a high degree of variability the amax values at the bafing makana station started decreasing in magnitude in the 1960s and started increasing in approximately the 1980s this visual trend was also found for the other senegal stations in sahelian niger however the increase appears to have begun earlier during the drought years of the 1970s 3 2 formulation of statistical models 3 2 1 gev distribution a suitable statistical function used to represent the distribution of a random variable y defined by block maxima is the gev distribution coles et al 2001 written as 1 f gev y μ σ ξ exp 1 ξ y μ σ 1 ξ for 1 ξ y μ σ 0 where μ is the location parameter a measure of central tendency σ the scale parameter a measure of dispersion ξ the shape parameter a measure of tail behavior and y the value at which the gev is to be evaluated the gev distribution is fitted on amax series y i with constant parameters s gev eq 2 and various forms of time t in years varying parameters ns gev eq 3 2 y gev μ σ ξ 3 y gev μ t σ t ξ t 3 2 2 identifying appropriate temporal functions for gev parameters the implementation of one ns gev model requires choosing the general form of the appropriate temporal function for each gev parameters as there is no theoretical model for the time dependent function it must be assigned a priori in order to determine a range of suitable functions an initial exploration of trends is done by fitting s gev distributions in moving windows over the study periods a window size of 15 years has been selected as a compromise between having sufficient data to fit the gev and highlighting potential parameter evolution due to the difficulty in estimation the parameter ξ was first calibrated using the entire data sample then kept stationary while μ and σ change with each window fig 4 displays an example of the moving window for μ 4a and σ 4b for the bafing makana station for this station both parameters are characterized by a v shaped pattern which is more distinct for μ than σ based on the moving window analysis for the 11 different stations it was identified that μ and σ can be qualitatively described by one single or several connected linear segments for all stations it was visually observed that changes in μ were more clearly defined than changes in σ one can note here that the moving window method allows for qualitatively assessing the overall trends in gev parameters however unlike ns gevs the moving window does not allow for the quantification of the trend nor its significance 3 2 3 formulation of gev parameter temporal functions according to the qualitative analysis derived from the moving window gev several temporal patterns with varying complexity were identified to describe the gev parameters linear double linear with one breakpoint and triple linear with two breakpoints temporal functions were considered for μ σ or both in the case of both parameters varying μ and σ were permitted to vary independently as with the moving window ξ was kept constant a non linear polynomial model was also considered initially but showed no improvement over the multilinear models to represent this non stationarity mathematically we introduce the function η t where η represents either μ or σ and t is a time dependent covariate η t takes on different forms depending on the trend model stationary parameter model 4 η t η 0 this parameter model has only one degree of freedom η 0 single linear trend 5 η t η 0 η 1 t in this case η t has two degrees of freedom η 0 and η 1 and thus one additional degrees of freedom in comparison with a stationary parameter double linear trend 6 η t η 0 η 1 t t 1 for t t 1 7 η t η 0 η 2 t t 1 for t 1 t t 1 represents the breakpoint in time year index where the two linear segments join i e where the slope of the linear model changes in this case η t has four degrees of freedom η 0 η 1 η 2 and t 1 meaning three additional degrees of freedom in comparison with a stationary parameter model triple linear trend 8 η t η 0 η 1 t t 1 for t t 1 9 η t η 0 η 2 t t 1 for t 1 t t 2 10 η t η 0 η 2 t 2 t 1 η 3 t t 2 for t 2 t in this case η t has six degrees of freedom η 0 η 1 η 2 η 3 t 1 t 2 a total of 13 different gev models are considered one with all parameters stationary s gev and 12 ns gev models that combine the above parameter trend models in eqs 4 5 7 10 for μ and σ they are reported in fig 5 classified according to their degrees of freedom 3 3 model fitting for s gev the parameters are directly fitted using maximum likelihood estimation mle in the ns gev scenario for each temporal function linear multi linear the following procedure is performed 1 if the formulation includes one or two breakpoints the year of each breakpoint t i is defined before estimating the other parameters η i in order to limit border effects the breakpoint s must be positioned not earlier than 10 years after the beginning of the series and no later than ten year before the end likewise two successive breakpoints must be separated by at least 10 years the breakpoints are defined independently for μ t and σ t and can be at a different point in time though not necessarily 2 at each defined breakpoint the parameters η i are estimated according to the formulations of η t in eqs 4 5 7 10 using mle 3 repeat steps 1 and 2 until all possible breakpoint dates have been tested 4 retain the model that gives the maximum likelihood among the different breakpoint dates tested in steps 1 to 3 3 4 selection of the best gev model a more complex model may provide better fit but not to a degree that merits additional parameterization the selection of the best model is done by comparing the maximum likelihood obtained by the 13 different gev models per station and evaluating their significance the selection process consists of two steps first an initial best model is selected via the akaike information criterion aic akaike 1974 then the model choice is validated via a likelihood ratio test lrt coles et al 2001 according to kim et al 2017 aic and lrt are both suitable for evaluating non stationary representations of hydrological data aic in particular is robust with small data sets the aic balances model fit against model complexity in the following equation 11 aic 2 k 2 log l where k is the number of parameters in the model and l is the maximum likelihood value associated with the model the model with the lowest aic value is selected the lrt is a test between two models that must be nested the simpler model is contained within the more complex models while aic compares all models globally lrt validates the addition or subtraction of specific parameters the likelihood ratio test lrt is performed by comparing the following statistic to the χ 2 distribution 12 d 2 log l m 1 log l m 0 where log l is the maximum value of the log likelihood of model m and m 0 is nested in m 1 if d exceeds the α quantile of the χ 2 distribution with n degrees of freedom with n the difference in the number of parameters between the two models additional degrees of freedom then the more complex model is accepted at level α for this study aic is first used to find an initial model of best fit for each station the model selection via aic is then validated using lrts all models that are nested within the model selected via aic are tested in pairs with the selected model using the lrt with α 0 10 this confirms that the added complexity is significant more complex models that have the aic selection as a nested model are likewise tested in pairs against the aic selection using the lrt to validate the exclusion of additional parameters note that the inclusion of the stationary gev model in the comparison allows for the evaluation of the presence of a non zero trend accompanied by a significance level if the selected model is an ns gev then the stationary hypothesis is rejected 3 5 return level evaluation the use of a parametric distribution for representing the data allows for the estimation of return levels r t corresponding to return period t the return level r t is exceeded with a probability p in a given year where p 1 t the return levels can be calculated as follows 13 r t μ σ ξ 1 log 1 p ξ for non stationary models the corresponding value of μ and σ for the ns gev are inserted in eq 13 at each time step in order to obtain the non stationary return levels for a given p a comparison of the relative evolution of return levels was conducted using normalized return level values for each station the normalization was conducted by dividing the values of the non stationary return levels by the value r t calculated under the stationary assumption s gev 14 r t normalized r t ns gev r t s gev 3 6 uncertainty assessment confidence intervals for model parameters were determined via nonparametric bootstrapping efron 1979 efron and tibshirani 1994 davison and hinkley 1997 while approximate confidence intervals can be calculated via approximation to the normal distribution the approximation becomes less valid for the parameter ξ and for values at the tail of the distribution high return periods thus bootstrapping was selected as providing a more accurate representation of the uncertainty for each station a data sample of equal length to the original series was extracted via resampling an ns gev of the same model type and with the same breakpoint as the selected ns gev for the station was calibrated on the sample this was repeated 500 times for each station samples were discarded if their ns gevs had a ξ value greater than 1 or less than 1 or if there were errors while estimating the ns gev and associated uncertainties likely due to particularly skewed samples same values selected many times extreme values overselected etc confidence intervals for the percentiles of interest were then calculated at each time step of the data series in the methodology used for this study the breakpoints were fixed before performing mle to estimate the ns gev parameters the uncertainty evaluation methods detailed above assume that the uncertainty in breakpoint estimation is negligible compared to the uncertainty in the estimation of the other ns gev parameters uncertainty of the η i this assumption is explored further in subsection 5 3 3 4 results 4 1 selected gev model table 2 shows the model of best fit that was selected for each station with a p value α of 0 10 used in the lrt one can note that for all stations an ns gev model always fit the series of amax better than the stationary gev model fig 6 visualizes an example of these models with moving window parameter values circles and selected ns gev model μ values line confidence intervals for μ are shown with dashed lines one can see that the selected models follow the general trends seen in the moving window parameter estimation of μ a double linear model was selected for μ for all stations with the exception of the alcongui station in the gorouol basin which was best represented by a linear model for μ although a double linear model would have been accepted at α 0 15 the selection of a double linear model indicates that the slope of the trend for μ differed significantly between two subperiods of the time series in the senegal river basin significant breakpoints were consistently found for μ between 1980 and 1984 for all stations the slope of the central tendency was negative decreasing trend during the period up until the early mid 1980s then became positive through the modern period the changes in μ were less rapid in all stations during the latter period kayes and bakel the two stations downstream of the manantali dam showed the least relative increase of all stations of the stations in the senegal river basin the daka saidou kidira and oualia stations demonstrated significant non stationarity in the scale parameter σ all non stationarity σ models were double linear daka saidou s breakpoint for σ was in 2000 while kidira and oualia both occurred in the 1990s 1995 and 1994 respectively this reflects the general decrease throughout the majority of the time period under study then rapid increase in variability seen in the moving window for σ during the 1990s at these stations for the sahelian stations in the niger river all stations showed an increasing trend starting as early as the 1970s however the specific model characteristics were less homogeneous between the different stations than for the senegal river stations although all models were double linear for μ breakpoints for μ were found in the 1990 for the dargol at kakassi and 1997 for the sirba at garbe kourou the slope of the trend was positive for both subperiods for these two stations with a greater more rapidly increasing slope during the more recent period for the snr data series the slope was gradually decreasing during the earlier period of record up until 1968 then increasing at a higher absolute magnitude during the more recent period the gorouol series at alcongui was linearly increasing throughout the period for μ the snr and sirba series showed significant trends in the σ parameter for the snr series the change in σ was determined to be linearly increasing for the sirba the model for σ was double linear with a breakpoint in 1977 the models closely follow the moving window estimates 4 2 extreme discharge tails behavior table 2 also shows the most likely ξ values for each distribution a heavy tailed gev distribution ξ 0 indicates that larger values are possible and more probable than if ξ 0 ξ 0 means that the distribution is bounded rare values will approach but not exceed a maximum threshold for the senegal river all ξ values were either close to zero gumbel distribution unbounded but not heavy tailed or negative weibull distribution almost all ξ values for the sahelian niger basin stations were positive frechet distribution which means the distribution of the values is heavy tailed without an upper bound the exception was the gorouol station at alcongui which had a slightly negative ξ value weibull distribution bounded however the 95 confidence intervals for ξ for all stations in both river basins included both positive values and negative values with the exception of the bafing makana station where the interval was entirely in the negative range weibull distribution 4 3 return level estimates of selected models the main practical advantage provided by the ns gev models is the ability to estimate return levels from the fitted distribution this is illustrated in fig 7 where 2 10 and 100 year return levels are plotted with their 90 confidence intervals for the bafing makana and dargol stations return levels in the senegal basin followed the general pattern of bafing makana first decreasing below the stationary level then increasing again return levels for the stations studied in the niger river started increasing earlier than for the senegal river note the increase in the size of the confidence level with the longer return periods for shorter 2 and 5 year return periods the confidence intervals for the non stationary model were more likely to be distinctly higher than those of the stationary model especially at 10 year and longer return levels the confidence intervals of the stationary and non stationary models increasingly overlap fig 8 demonstrates this separation and overlap between the confidence intervals of the stationary model and the chosen ns gev model for each station over time the shades on the graph indicate up to which degree of confidence 80 99 the ns gev model and s gev model return level confidence intervals are disjoint with the color indicating whether the ns gev confidence interval was centered higher red or lower blue than the confidence interval of the s gev model one can note from fig 8 that all of the senegal stations were significantly above the s gev at the beginning of the record for the 2 year return levels 8a only bafing makana in senegal was higher than its corresponding s gev at the end of the data record the uncertainty increases with longer return periods with none of the ns gevs significantly higher than the s gev at the end of the record for 25 year return levels or greater ns gev return levels for the oualia kidira gourbassi and daka saidou stations were at approximately the stationary return level at the end of the study period or below the stationary level for longer return periods overall the return levels of stations in the senegal basin spend much of the period of record significantly below the s gev one can note that the difference persists into the modern period for the bakel data series one of the stations affected by the manantali dam for the stations in the niger river at the most modern data points the 90 confidence intervals surrounding the 2 and 5 year return levels globally surpassed the confidence intervals of the stationary return values for the sirba and dargol this separation existed also at the 99 confidence level and at the 95 confidence level for the gorouol the exception was the snr series whose lower non stationary 90 confidence bound was slightly within the upper confidence bound of the stationary value for 5 year return levels fig 9 compares the 2 and 5 year return level changes between all stations with values normalized by each station s stationary return level i e the return level estimated using the stationary gev model eq 14 the separation in terms of return level evolution between the stations in the senegal and niger river basins is especially clear for the two year return levels the two year return levels of the senegal river stations blue start at around 1 5 times the stationary return level y axis 1 reduce to as low as 0 5 during the 1980s then increase throughout the modern period bakel and kayes the two senegal stations affected by the manantali dam have notably lower relative increases in return level values these two stations reached to near the stationary return level value at the end of the study period whereas the other stations all exceeded it and reaches values between 1 and 1 5 times the stationary return level this shows the influence of the dam on trends in maximum values one can hypothesize that without the influence of the dam the stations bakel and kayes would have more closely followed the trend of the other stations that are located either upstream of the dam or on other tributaries of the senegal river for the niger river stations red all stations started below the stationary 2 year return level and ended well above it for most of stations the 2 year non stationary return levels move from less than 0 7 to more than 1 5 times the stationary return level meaning a doubling discharge for a two year return period in roughly 50 years the snr series in particular tripled its relative value over the study period as for the five year return levels the regional separation becomes less clear due to the greater influence of the scale parameter at higher return levels however the relative decreases and increases by region remained similar bakel and kayes remain relatively lower than the other senegal stations 4 4 scale effects of drainage area the absolute magnitude of the increase in μ was directly correlated with the size of the drainage area of a given station however no correlation was found in the relation between the relative increase in μ and the drainage area for the sahelian niger a moderate correlation pearson s ρ 0 6 was found between drainage area and return level for return periods of 25 years or longer the trend was more evident in the senegal basin when the stations bakel and kayes were removed the correlation was greater than 0 6 for return periods of 5 years and longer a similar correlation ρ 0 6 was found between drainage area and the ξ parameter in both regions the two year return levels demonstrated little to no correlation with drainage area ρ 0 25 given the limited number of data points it is difficult to draw conclusions based on these results 5 discussion 5 1 comparison of results with literature the above results confirm the rising trend in extreme streamflow values since the 1970s and 1980s previously found in other studies cassé and gosset 2015 nka et al 2015 aich et al 2016 the trends found in the guinean stations in the senegal river basin in this study followed the trends found in aich et al 2016 for the guinean stations in the niger river basin in both studies a decreasing trend was found until approximately the mid 1980s followed by an increasing trend results are overall consistent with nka et al 2015 s findings that extreme discharge is reduced in recent years compared to what it was several decades ago the models in the present study also detected a moderate increase in recent years whereas in nka et al 2015 there was no significant trend since the 1970s the relatively lower trends at the kayes and bakel stations can be explained by the construction of the manantali dam upstream in 1988 which would have controlled many of the larger flows this is in agreement with the results in faye 2015 which showed that monthly flow coefficients at bakel were lower for peak season months in the period after dam construction than they were before dam construction at the stations of bafing makana oualia and kidira flow coefficients were higher for peak months when comparing the same time periods the breakpoint found at 1990 in the ns gev for the dargol at kakassi falls in between the breakpoints found by nka et al 2015 at 1987 for amax and 1993 for peak over threshold values for sahelian stations aich et al 2016 found a decreasing trend until the 1970s followed by an increasing trend the initial decrease was found only in the snr and gorouol series but all sahelian stations tested show an increase since the 1970s a breakpoint was found in the mid 1970s for the sirba and early 1970s for the gorouol which is roughly consistent with the results in the present study the shifts in trends found in the snr series 1968 and gorouol series 1972 falls at the same point in time as the general climate shift in the late 1960s as well as the mean discharge breakpoint identified in tarhule et al 2015 however whereas the climate and mean streamflow shifts decreased after the break the snr series and likewise all series for the sahelian niger went from a low or negative slope to a positive slope this is reflective of the well documented sahelian paradox albergel 1987 descroix et al 2018 where locally generated streamflow in the sahel began increasing during the drought period in spite of an overall reduction in rainfall 5 2 evaluation of the parameter ξ in addition to the difference in timing and magnitude of trends between the sudano guinean and sahelian regions differences in the shape parameter ξ were also found the fact that the ns gevs for sudano guinean stations were generally weibull or gumbel ξ 0 and sahelian stations were generally frechet ξ 0 could be due to the differences in hydrological functioning in the sudano guinean region the flow type is hewlettian and groundwater plays a greater role a larger portion of the precipitation first infiltrates and contributes to river discharge at a later time smoothing out the high spatio temporal variability of fine scale rainfall intensities flood generation is thus sensitive to both the initial conditions of the basin groundwater storage subsurface water etc and the amount of rainfall accumulated over the basin in the sahel streamflow is driven by hortonian processes local precipitation generated runoff and therefore is sensitive to the intensity of rainfall at small scales the role of initial conditions seems to be smaller in comparison to factors such as the area affected by high intensities over a short time period these differences in the spatio temporal scale of the processes primarily responsible for flood generation in the two regions could explain in part the differences in the tail behavior of extreme discharges between the two regions indeed it is observed that rainfall at fine spatio temporal scales sahelian flood generation has heavy tail behavior koutsoyiannis 2004 panthou et al 2012 while rainfall averaged over larger spatio temporal scales sudano guinean flood generation is expected to have bounded tail behavior this said great care must be taken in drawing conclusions from results for ξ as the confidence intervals are large table 2 and include both positive frechet and negative weibull values for almost all stations the confidence intervals themselves seem to indicate a difference in tail behavior between the two regions the lower bounds of the 95 confidence intervals for ξ in the senegal catchments are much lower than the lower bounds in the sahelian niger catchments with the exception of the gorouol and the upper bounds are generally lower in the senegal basin as well though less universally however due to the great overlap between the confidence intervals it is difficult to draw conclusions with a high level of certitude 5 3 sensitivity analyses robustness of the results 5 3 1 sensitivity of the model selection process to the different tests and the p value threshold chosen for the lrt for three out of the eleven data series the additional application of the lrt test modified the model selection in all three cases the model became simpler the scale parameter σ for bakel became stationary the location parameter of kayes became double linear instead of triple linear and the gorouol model became simple linear for μ instead of double linear for ten out of the eleven data series the model selection did not change with an increase in lrt test stringency with the p value equaling 0 05 the only change with the stricter requirement were that σ became stationary for the snr series with less strict criteria α 0 15 the results more closely approximated the initial aic selection results σ was modeled as linear non stationary for the bakel station instead of the stationary model for σ selected at the α 0 10 significance level the gorouol station became double linear for μ and stationary for σ the kayes station ns gev at the p value of 0 15 was a double linear model for μ and a simple linear model for σ the general trends strongly positive over the past few decades for μ and return levels did not change with the choice of the model of note at the α 0 15 significance level is the triple linear model selected for μ for kayes the kayes station s flow has clearly been regulated by the installation of the manantali dam in 1988 which may have resulted in three distinct phases over the study period rather than two 5 3 2 sensitivity of the model parameters to optimization methodology the choice of mle parameter optimization method did not have a significant impact on model parameter results nor on model selection results optimization methods tested were nelder mead nelder and mead 1965 bfgs shanno 1970 conjugate gradients fletcher and reeves 1964 l bfgs b byrd et al 1995 and simulated annealing bélisle 1992 however the boundary limit between breakpoints and the edge of the data series did have an impact on the selection of the breakpoint this could be of interest as the main breakpoint in the early mid 1980s in senegal was less than ten years before the construction of the manantali dam as a triple linear model with a distance between breakpoints of one decade was almost selected initial aic model selection for the kayes station which is downstream of the dam the limitation could have had an impact on model selection 5 3 3 additional sources of uncertainty one source of uncertainty lies in the accuracy of the rating curves for each of the stations in this study jalbert et al 2011 morlot et al 2014 rating curves in regions subject to sedimentation such as the sahelian niger river basin risk being nonstationary in time rating curves may also be less accurate for extreme values if measurements of flow of comparable magnitude were not used in the rating curve calibration although some stations notably kidira bakel daka saidou and niamey included such large values this was not the case for all stations however rating curve uncertainties while possibly influencing the specific magnitudes of results are highly unlikely to be the cause of the consistent trends detected and thus do not alter the conclusions of the present study trend detection was conducted using a regional approach with two large river basins within the region and several stations within each river basin the regional approach makes the methods robust and smooths the effect of uncertainty related to rating curves one can also question the influence of the choice of breakpoint on the uncertainty of the results sensitivity testing was performed with the bafing makana and snr series over a breakpoint range of five years before and after the breakpoint of the selected model the spread of the 95 confidence interval of the selected model one fixed breakpoint was compared with the spread of the global confidence interval obtained from the range of breakpoints the area within the global confidence interval but outside the selected model s confidence interval is due to breakpoint uncertainty based on this the contribution of breakpoint estimation uncertainty to the overall uncertainty is on average 13 for bafing makana and 15 for snr for a breakpoint range of plus and minus five years from the selected breakpoint it was thus verified that the primary source of uncertainty comes from the gev calibration process performed in step 2 of subsection 3 3 uncertainty of the η i and not from uncertainty about the position of the breakpoint 6 conclusions and implications the preceding analysis proposed a selection of ns gev models for hydrological annual maxima in west africa in all cases the ns gev model was significantly more representative of the data series than the stationary gev model the trend is positive since the 1970s for the sahelian stations and the mid 1980s in the sudano guinean stations with both regions demonstrating an intensification of the hydrological signal certain parameters and return levels notably the μ parameter and the 2 and 5 year return levels surpass the values expected with a stationary model with a high level of confidence at certain stations the results improve over other studies by providing the underlying statistical distributions for the non stationary data series confidence intervals on parameter values return level estimates and a model selection process with robust criteria it also compares two subregions and notably includes an extracted data series for the cumulative sahelian red flood inputs to the niger river although west africa is used as a test region these analyses can be applied to hydrological time series elsewhere in the world the methods used in this paper have some limitations first only parametric models that were preselected as potential best models are evaluated thus eliminating a large range of other potential models second the study only consider breakpoints that are transitions from one linear slope magnitude to another not abrupt shifts furthermore uncertainty is high which reflects the current reality the methods also require a certain level of expertise for use and interpretation additionally the estimated uncertainties do not take into account the uncertainty in the estimation of streamflow via rating curves which could have a significant impact on the accuracy of extreme values jalbert et al 2011 morlot et al 2014 however the methods proposed in the present study are advantageous for several reasons it is possible to use other trend and breakpoint detection methods but many of these tests assume that the data is normally distributed which is not the case with extremes and thus will not be robust with data sets consisting of extreme values classic breakpoint detection tests such as the pettitt test may work but do not provide an estimate of the magnitude of the trend they also do not permit the estimation of return levels which is a significant advantage of the methods based on fitting probability distributions proposed in this paper the power of classical trend and breakpoint tests to reject the null hypothesis when applied to extreme value series is also known to be lower than when applying tests specific to gevs moreover even if some expertise is required to use them the r packages used in this study are freely available heffernan et al 2016 the results for the return level estimates indicate that if the stationary model were to be used it would underestimate the current return levels in the sahelian reaches of the niger river for example the non stationary ten year return level for the snr series in 2012 is 600 m3 s 1 larger than the value estimated from a stationary model for all four data series in the sahelian niger at the end of the data record 2012 2015 the non stationary 2 year return level exceeds the 5 year stationary return level indicating an increase in frequency of events of greater magnitude the nonstationarity of the return levels has direct implications for hydraulic works construction and river basin management in both sahelian and sudanian areas the identified increase of 2 10 year return levels is important for small structures and might have contributed to the increasing number of damaged and destroyed bridges and roads reported over the last decades amani and paturel 2017 in the senegal basin an accurate estimation of higher return level values for return periods greater than 25 years is needed not only for the management of existing dams such as the ones at manantali diama and félou but also for the construction of additional structures such as spillways and the hydroelectric dams planned by the organization for the valorization of the senegal river in french omvs see bonneau 2001 as the region surrounding niamey in the niger basin continues to be threatened by severe flooding accurate return level estimates are required in order to ensure that flood protection systems can protect against a given flood in all of the above cases if a stationary model is used it risks overestimating or underestimating the magnitude of river discharge uncertainty remains high for longer return periods this is largely tied to the size and variability of the data set estimating a 100 year return level based on only 60 years of data forcibly has a high level of uncertainty as more data is collected uncertainty will decrease and the ability to more precisely estimate return levels for longer return periods will likely improve provided that the data is represented by a model that best suits its trends uncertainty may also be reduced with a greater understanding of flood drivers much speculation and study has occurred in attempt to determine the causes of the changes in flood peaks in the west africa seguis et al 2004 leblanc et al 2008 d orgeval et al 2008 descroix et al 2009 descroix et al 2012 descroix et al 2018 aich et al 2015 cassé and gosset 2015 cassé et al 2016 in addition to climate changes west africa has undergone extensive land cover changes loireau 1998 anyamba and tucker 2005 descroix et al 2009 including a considerable increase in the percentage of cultivated area from the 1950s 2000s cappelaere et al 2009 whereas much of the sahelian paradox during the drought can be attributed to land use land cover changes in recent years changes in river discharge seems to correlate more with changes in precipitation case in point the regional trends found in this study follow those found for mean non zero rainfall in senegal and the central sahel in blanchet et al 2018 the issue is complex for example in the present study the sirba basin streamflow did not increase as much as that of the dargol and gorouol yet it both receives more rainfall 500 mm as opposed to 400 mm annually and had increased runoff coefficients most likely due to the impacts of agriculture descroix et al 2012 land use and climate also have impacts at different scales blöschl et al 2007 an improved understanding of the attributed causes of trends in extremes would give guidelines for the projection of pertinent results into the future such an approach would require coupling ns gev models with projected climate and land use changes factors to be taken take into account are both climate projections at the scale of hydrological processes and socio economic scenarios that allow for the estimation of the anthropic pressure on the soil and the resulting changes in hydrodynamic parameters projection of model results into the future however must be done with caution due to the potential of future shifts in trends and decadal variability not accounted for in the climate and land use trends we recommend that those dimensioning hydraulic works seriously consider the possibility that hydrological extremes are increasing as this is the current evidence available this is especially pertinent for the coming decade over which evidence supports an increasing frequency of extreme rainfall and ongoing hydrological intensification taylor et al 2017 panthou et al 2018 with this in mind we recommend that stakeholders design structures with a shorter design life span 10 20 years with the assumption that extremes will most probably increase such structures include flumes small urban hydraulic structures pumps levees and smaller dams for longer life structures such as large dams and spillways they should continue to consider all factors including the possibility that the trend may change and decrease again despite the potential impacts of projected land use changes and the ongoing warming of the sahara that triggers intense rainfall events the decadal variability of climate in the region is also likely to continue in spite of the uncertainties the present study concludes within a strict level of confidence that hydrological extremes are currently increasing and although uncertainty about the magnitude of this increase is high it is more concrete and certain than speculation about an unknown future the trends are consistent for all stations within each watershed despite flow uncertainties we advise that stakeholders place importance on the possibility of greater and more frequent flood magnitudes especially while designing smaller structures but also for larger structures we further recommend that they take causal factors into account although more studies are needed in order to understand the mechanisms of flood drivers acknowledgements the research leading to these results has received funding from the nerc dfid future climate for africa program under the amma 2050 project grant ne m020428 1 this work was also supported by the french national program ec2co lefe recent evolution of hydro climatic hazards in the sahel detection and attribution ansoumana bodian benefited from a grant received from the french embassy in senegal which financed exchanges with other researchers we warmly acknowledge the niger basin authority abn and the organisation pour la mise en valeur du fleuve sénégal omvs for providing the niger river and senegal river discharge data 
