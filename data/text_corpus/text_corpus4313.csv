index,text
21565,this paper proposed a new collision avoidance decision making system designed for autonomous ship the system outputs collision avoidance decisions based on the latest information at a certain frequency which is suitable for real ship application front end and back end are two main components of this system front end provides preliminary information while back end generates collision avoidance decisions based on modified velocity obstacle method the multistage optimization decision model is introduced and various constrains are considered including ship maneuverability multi ship colregs off course and seamanship then the interactive actions taken by other ships during collision avoidance process are further analyzed the modified velocity obstacle method incorporates a finite state machine fsm which can be used to handle the dynamic behavior of other ships finally the case study is completed on the electronic chart system ecs to show that the proposed collision avoidance decision making system is robust and effective under various marine scenarios therefore the system has great potential to be equipped on board in the future keywords ship collision avoidance velocity obstacle autonomous ship decision making system 1 introduction 1 1 background more than 85 of marine accidents are related to ship navigation including grounding and ship collision wróbel et al 2017 wu et al 2020 as one major threat to the safety of maritime navigation ship collision may cause serious casualties economic losses and marine environmental pollution etc according to statistics more than 80 of ship collisions are caused by human error he et al 2017 therefore in order to mitigate the potential navigation risks due to human factors and further increase the level of intelligence in marine transportation the international maritime organization imo has been devoting to the research on the technologies and regulations of the maritime autonomous surface ship mass in recent years the autonomous navigation system ans is the brain of mass and plays a critical role throughout the system ans makes a series of navigation decisions in real time based on external information fig 1 explains the components of ans in details the sensor system includes traditional onboard radars ship automatic identification system ais normal cameras infrared cameras and lidar etc through the information fusion of these multi source sensors the full range of environmental information around the ship can be transmitted to the automatic collision avoidance system cas in accordance with the requirements of the international regulations for preventing collisions at sea colregs cas calculates the desired course and speed through the pivotal collision avoidance decision making algorithms in addition the navigation route is adjusted according to the latest maritime safety information msi the global guidance information and local guidance information are sent to the ship control system together to ensure the safety of mass cas is one of the most important components in the whole ans in this study we design a robust and efficient collision avoidance decision making system to satisfy the real application requirements of mass the collision avoidance model used in this system is based on the modified velocity obstacle vo algorithm and various scenarios are designed to verify the effectiveness of the system 1 2 literature review a lot of valuable research has been carried out on autonomous ship collision avoidance decision making the concepts techniques and key points of ship collision avoidance have been summarized in some literature reviews statheros et al 2008 tam et al 2009 liu et al 2016 huang et al 2020 with the continuous development of intelligent unmanned technology the obstacle avoidance theory of unmanned systems gradually migrated to the marine field researchers have designed many new collision avoidance algorithms and achieved good results such as the improved artificial potential field apf xue et al 2011 lyu and yin 2018 the dynamic window dw eriksen et al 2018 and the modified model predictive control mpc johansen et al 2016 xie et al 2019 it is also worth noting that methods based on deep reinforcement learning have become popular in recent years shen et al 2019 zhao and roh 2019 woo and kim 2020 zhang et al 2019 among these collision avoidance algorithms velocity obstacle method has attracted the attention of many researchers because of its own characteristics vo was first proposed by fiorini and shiller 1998 after that in response to the different problems during the application many variants have been derived which forms a rich vo algorithm cluster such as nlvo nonlinear velocity obstacle large et al 2002 pvo probabilistic velocity obstacle kluge and prassler 2004 rvo reciprocal velocity obstacle van den berg et al 2008 orca optimal reciprocal collision avoidance van den berg et al 2011 and grvo generalized reciprocal velocity obstacle bareiss and van den berg 2015 vo is also widely used in the field of ship collision avoidance nowadays the dcpa distance of the closest point of approach and tcpa time to the closest point of approach are still the two main criteria for the oow officer on watch to make an evasion decision hilgert and baldauf 1997 arpa automatic radar plotting aid is based on these two criteria to make early warning of potential collision hazards and provide decision making support for oow wang et al 2017 moreover the theory of ctpa collision threat parameter area proposed by degré and lefèvr 1981 is close to vo ctpa can collect all velocity vectors that may cause collisions between two ships in the future then it incorporates ship domain sd and colregs separately szlapczynski 2009 szlapczynski and szlapczynska 2015 what s more ctpa is also applied in restricted waters szlapczynski and szlapczynska 2017a b besides the researchers incorporate colregs on the basis of the classic linear velocity obstacle lvo method kuwata et al 2014 zhao et al 2016 modify the orca algorithm and consider the reactive behavior between usvs kufoalor et al 2018 assign the responsibility for collision avoidance between unmanned ships based on the principle of rvo it is worth noting that the research group of gelder p h a j m is a typical representative of vo method used in ship collision avoidance applications in huang et al 2018 the non linear velocity obstacle region is constructed which is based on the assumption that the predicted trajectories of other ships can be obtained it can be used to support oow making the collision avoidance decisions in huang et al 2019 the collision avoidance system named gvo cas is developed which is based on the principle of grvo in addition to that vo is also used for collision risk detection and analysis huang et al 2019 chen et al 2018 2019 recently the research on the consideration and analysis of dynamic characteristics of other ships has become a trend in the field of ship collision avoidance during the real ship navigation the position and trajectory of other ships are uncertain rong et al 2019 zhang et al 2018 furthermore whether other ships will take actions in strict accordance with the colregs such as taking evasive action as give way vessel and keeping course and speed as stand on vessel during the collision avoidance process it hard to be guaranteed du et al 2020 a new collision avoidance decision making mechanism based on observation inference prediction decision oipd can be used when other ships take actions during the collision avoidance process wang et al 2020 wu et al 2020 besides in order to realize the coordinated collision avoidance between own ship and other ships using common collision avoidance algorithm zhao et al 2016 or making collision avoidance strategies from global perspective li et al 2019 are two mainstream methods in fact under the real scenario at sea most ships that are in danger of collision need to communicate and coordinate through vhf very high frequency to ensure the consistent collision avoidance actions therefore some researchers assume that ships can exchange their respective predicted trajectories with each other huang et al 2018 2019 1 3 motivation despite the plenty of research work devoted to the ship collision avoidance problem there are some research gaps in the existing studies first previous research has focused more on designing collision avoidance algorithm while less literature is devoted to developing a complete collision avoidance decision making system with the continuous development of mass the decision making scheme of cas should be more suitable to real ship applications which requires the collision avoidance decision making system to be more robust and have great real time performance the decisions generated by cas should satisfy the requirements of good seamanship second it is obvious that vo has been widely used in the field of ship collision avoidance based on the previous literature review however few papers consider the actions taken by other ships some papers take into account other ships actions but most of them are based on strong assumptions such as using same collision avoidance algorithm or obtaining the predicted trajectories of other ships in fact with the development of mass there will be a long term coexistence situation of mass and manned ships the actions taken by manned ships are highly uncertain such as temporary course turning or violation of colregs however the existing vo method could not handle such problems very well therefore the motivation of this paper is to build a collision avoidance decision making system for mass the system should be fully suitable for real application at sea the system is able to consider various factors including ship maneuverability multi ship encounter situation colregs especially for handling those actions taken by other ships during the collision avoidance process continuous and stable collision avoidance decisions should be output from the collision risk detection to the end of the collision avoidance process 1 4 contributions given the above the contributions of this paper are concluded as follows 1 a collision avoidance decision making system based on the front end and back end structures is designed the system uses modified vo method to output collision avoidance decisions 2 in this paper we combine vo with fsm finite state machine it allows the system to effectively respond to the dynamic behavior of other ships during the avoidance process which makes up the limitations of previous vo models 3 the system presented in this paper is developed by c and embedded in the electronic chart system ecs various simulation cases are designed to verify the effectiveness of system the remainder of this paper is organized as follows section 2 proposes the design ideas and framework of this system section 3 illustrates the algorithms and methods used in the front end and back end and the multistage optimization model is described section 4 analyzes the interactive action taken by other ships and introduces the method which combines vo with fsm the verification and case study are carried out in section 5 discussion and conclusions are drawn in section 6 the main symbols in this paper are shown in table 1 besides own ship is denoted as os target ship as ts they can be used as the footnotes to distinguish variables for example v o s represents the speed of own ship and v t s represents the speed of ts 2 the framework of collision avoidance decision making system the collision avoidance decision making process of autonomous ships is a sequential decision making task we cannot expect to plan a series of evasive actions from the beginning to the end of collision avoidance process in fact we need to adjust and optimize the collision avoidance decision at each time step this process is a typical markov decision making process the decision making at current time only depends on the latest status and it has nothing to do with the past this conforms to the one step dynamic characteristics during the collision avoidance process the autonomous ship should constantly interact with the environment continuously update the relative motion status between other ships and os after that the system selects the optimal action with the lowest cost so as to make the next update cycle reaching the optimal state the process is shown in fig 2 s 0 s k 1 s k s n indicate the status at each sampling moment based on the analysis of decision making process this paper designed a collision avoidance decision making system as shown in fig 3 the system is divided into two parts the front end and the back end the front end is mainly responsible for collecting information of all tss within the alert circle usually 12 nautical miles which centered on os after that front end needs to determine whether there is a collision risk between ships and then discriminate the encounter situations the role of os namely give way vessel or stand on vessel is determined according to colregs at the same time in order to deal with the interactive actions taken by tss the system starts recording the information of ts which have collision risk with os and judging whether the trigger condition of fsm is reached this part is described specifically in section 4 if the trigger condition is reached state transition will be performed in fsm and then transfer to the back end if the condition is not reached the information flow will transfer to the back end immediately the back end performs a multistage optimization process based on the initial decision this process considers ship maneuverability multi ship encounter situation colregs course maintenance and good seamanship finally the optimal decision is delivered to the ship control system and the system enters into the next decision making cycle 3 development of the collision avoidance system 3 1 front end 3 1 1 collision risk detection the calculation results of collision risk value can be used to determine the timing of evasive action by os in addition to that different collision risk values can also support the collision avoidance decision making there are many methods to evaluate ship collision risk szlapczynski and szlapczynska 2017a b chen et al 2019 ozturk and cicek 2019 li et al 2018 in this paper we used different factors to calculate the collision risk including dcpa tcpa d distance b bearing and k speed radio we define the minimum safe encounter distance d s at any time tss are not allowed to pass os within the range of minimum safe encounter distance this paper drew on the sea observation results by goodwin 1975 the size of d s is defined according to the bearing of ts considering the error existed in the observation of dcpa goodwin s results are modified according to the following formula and we can obtain the new d s zheng and wu 2001 1 d s 1 1 b π 0 2 0 b 5 π 8 1 0 b π 0 4 5 π 8 b π 1 0 2 π b π 0 4 π b 11 π 8 1 1 2 π b π 0 4 11 π 8 b 2 π according to the survey and observation results for ships coming to the port side when the initial dcpa is 1 5n miles 98 of the ships do not take evasive action for ships coming to the starboard side or the bow when the initial dcpa is 1 5n miles 94 3 of ships do not take evasive action for stern coming ships when the initial dcpa is 0 9n miles 100 of ships do not take evasive action considering the observation error and the safety we defined the safe passing distance between os and ts as expressed in equation 2 2 d p 2 d s after that the fuzzy membership functions of five factors can be obtained as equations 3 8 3 u dcpa 1 dcpa d s 1 2 1 2 sin π d p d s dcpa d p d s 2 d s dcpa d p 0 d p dcpa 4 u tcpa 1 0 tcpa t 1 t 2 tcpa t 2 t 1 2 t 1 tcpa t 2 0 t 2 tcpa 5 among them t 1 d s 2 dcpa 2 r v dcpa d s d s dcpa r v dcpa d s t 2 d p 2 dcpa 2 r v 6 u d 1 0 d d s d p d d p d s d s d d p 0 d p d 7 u b 1 2 cos b 19 π 180 440 289 cos 2 b 19 π 180 5 17 8 u k 1 2 k k 2 1 2 k sin c o s 1 this paper determined the weight coefficients of five factors as shown in table 2 we can get the collision risk result c r t s of the related ts in terms of equation 9 9 c r t s w 1 u d c p a w 2 u t c p a w 3 u d w 4 u b w 5 u k when c r t s 0 5 there is a collision risk between os and ts and os needs to take collision avoidance action 3 1 2 encounter situation once the collision risk is found between two ships the encounter situation between os and ts should be determined according to colregs in this paper five types of ship encounter situations are proposed head on situation overtaking situation crossing from right situation crossing from left situation and others the scene division model is shown in fig 4 the black arrows in fig 4 represent the velocity vector line corresponding to each ship we use different colors to show different encounter situations ts 1 and os are in head on situation ts 2 and ts 4 cross from right and left of os respectively ts 5 is overtaking os ts 3 is in other situation with os these five types of encounter situations are formulated as equation 10 10 head on π 8 q π 8 3 4 π r c π overtaken q 5 8 π 0 r c 3 8 π v o s v t s cross left 5 8 π q π 8 π 8 r c 5 8 π cross right π 8 q 5 8 π π 8 r c 5 8 π others q r c all bove 3 2 back end 3 2 1 initial decision the collision avoidance decision making system designed in this paper used the linear velocity obstacle method to make the initial decision definition the velocity obstacle vo for os induced by ts is the set of velocities that if chosen from will eventually lead to a dangerous situation between the two vessels let r p indicates the relative position between own ship and target ship which is r p p t s p o s now we define a ray starting from point r p and moving in the direction of r v r v v o s v t s then the ray position after time t is 11 λ r p r v r p r v t t 0 we use the symbol α to represent the circle area with ts as the center and d s as the radius the circle area with d p as the radius is represented by the symbol β then the core velocity obstacle region of os which is relative to ts is 12 v o o s t s v o s λ r p r v α we define that os is not allowed to select any velocity vector in v o o s t s in contrast v o o s t s is defined as the broaden velocity obstacle region os can select velocity vector from it but it needs to pay a price v o o s t s and v o o s t s are shown in fig 5 13 v o o s t s v o s λ r p r v β α considering ships sailing in open sea usually operate at sea speed and most modern ships are fitted with fixed pitch propellers it is difficult for the main engine of the ship to reduce the speed quickly in a short time so we think that reducing ship speed in open sea is not a preferable choice we define the left and right course boundaries of areas v o o s t s and v o o s t s as a l a r and b l b r then the region c c o core course obstacle and b c o broaden course obstacle are defined as 14 c c o c o s a l a r b c o c o s b l a l a r b r 3 2 2 ship maneuverability constrained due to the non linear and dynamic characteristics of the ship s maneuvering model the change of course always takes some time as shown in fig 6 at the initial moment ts moves along the dotted line l t s and os moves along the dotted line l o s 0 if os does not take evasive action the distance between os and ts will be less than the safe passing distance d p at t 1 therefore os need to alert her course to avoid collision the critical angle of port steering and right steering is θ l and θ r respectively if the turning process of os is not considered in other words the turning of the os is instantaneous then the position lines corresponding to the os are straight lines respectively l o s 2 and l o s 1 if the maneuvering model of os is considered the actual position line of the os is a compound curve respectively m o s 1 and m o s 2 the actual position line intersects the outer ring of ts in order to better explain the limitations of ship maneuverability this paper tries to illustrate this constraint by setting up a simple two ship encounter scenario both v o s and v t s are 15kn at the initial moment c o s is 30 and c t s is 210 the distance between two ships is 3 nautical miles two ships are in danger of collision and construct head on situation according to the mechanism of the collision avoidance decision making system from the initial moment we recalculate the new b c o at each subsequent moment and execute b r until v o s leaving the new b c o the current course and object course of os at each moment are shown in fig 7 it is not difficult to see that object course of os is continuously increasing specifically from 54 to 60 in summary figs 6 and 7 indicate that if the system does not take into account the ship s maneuverability constraint the decisions generated by the system cannot guarantee that os and ts will pass at the safe distance therefore we define c c o and b c o boundaries modified by ship maneuverability as 15 c c o a l a l δ δ l a r a r δ δ r b c o b l b l δ η l b r b r δ η r δ δ l δ η l and δ δ r δ η r are the left and right offsets of c c o and b c o respectively from this we can get the new generalized course obstacle region as equation 16 16 g c c o c o s a l a r g b c o c o s b l a l a r b r now we calculate g c c o and g b c o considering the three degree of freedom ship motion mathematical model relevant variable definitions are shown in table 3 because of the left and right symmetry of the ship s weight the horizontal plane motion equation of the ship can be obtained according to newtonian mechanics as follows 17 m u r v x g r 2 x m v r u x g r y i z r m x g v r u n m is the mass of the ship x g is the distance from the origin of coordinates to the center of gravity of the ship i z is the moment of inertia on the ship keel line direction this paper ignores the interference force and the interference moment in the process of ship motion we only consider the ship motion in the static level in addition to this the calculation of rudder angle is carried out by pd controller 18 τ k p ϕ 0 δ c ϕ k d ϕ among them δ c is the steering angle τ is the rudder angle ϕ is the actual course ϕ 0 is the original set course k p is the controller gain coefficient and k d is the controller differential coefficient at the beginning of steering the position coordinate of own ship p o s is 0 0 let c o s be the original course of own ship then we can get target ship position p t s x t y t the coordinates are 19 x t d cos c o s q y t d sin c o s q at any time t after own ship takes evasive action from equations 17 and 18 c o s and v o s can be obtained so the position of os p o s x o t y o t is 20 x o t 0 t v o s cos c o s d t y o t 0 t v o s sin c o s d t then we can get the displacement of os relative to ts 21 δ x x t 0 t v t s cos c t s v o s cos c o s d t δ y y t 0 t v t s sin c t s v o s sin c o s d t the relative bearing q and relative distance d are both the function about time t 22 q t arctan δ y δ x d t δ x 2 δ y 2 relative course r c and relative velocity r v can be expressed as 23 r c t arctan v t s cos c t s v o s cos c o s v t s sin c t s v o s sin c o s r v t v t s 2 v o s 2 2 v t s v o s c o s c t s according to the calculation results of the above parameters we can get the dcpa value wang et al 2017 li et al 2019 between os and ts from the following formula 24 d c p a t d t sin r c t q t π based on the above analysis we can obtain g c c o and g b c o with the consideration of the ship maneuverability a schematic diagram is shown in fig 8 first according to the calculated c c o and b c o in section 3 2 1 we can get their left and right boundaries a l a r and b l b r respectively afterwards the boundary is expanded in the left right direction traversing at 1 intervals and the expanded boundary is set as the new object course when the object course is reached after a period of predicted time t we can get the dcpa value between os and ts according to formula 19 24 then g c c o and g b c o can be obtained by comparing with d s and d p 3 2 3 multi ship constrained the general idea of using the velocity obstacle method to solve the multi ship encounter situation is constructing velocity obstacle region for each ts which exists collision risk with os and the collision avoidance decision c o s n e w should not be selected from these regions at the same time the decision cannot bring new collision risk from those tss which have no collision risk at the beginning of the decision making process let m represent the number of the tss with collision risk n represent the number of the tss with no collision risk under the current situation c o s n e w can be expressed by 25 25 c o s n e w k 1 m v o o s t s k k 1 n v o o s t s k however the collision free course space of the os sometimes will become very limited in order to satisfy the requirements the collision avoidance decision generated by this model will be excessive when ships encounter at a long distance such as ultra large steering greater than 90 or even a u turn however this kind of evasive action is unnecessary and does not satisfy the good seamanship as shown in fig 9 os encounters four tss under the current scene if we strictly follow the original definition of the vo method these two red arrows c o s n e w centered on os should be selected as the collision free course however these two courses are unreasonable the green arrow c o s o p t is more suitable although it slightly invades the velocity obstacle region of the third ts in order to avoid the situation mentioned above this paper no longer defines the velocity obstacle as the region where the velocity vector is completely non selectable instead we proposed g c c o and g b c o as shown in fig 10 the velocity vector c o s n e w is not allowed to select from g c c o it can be selected form g b c o but at the same time there s an extra cost the cost is calculated by the formula 26 26 p t s c o s c o s b l b l a l γ i f c o s a l b l b r c o s b r a r γ i f c o s a r b r in this cost function we chose the basis function y x γ where γ is the tuning parameter its function image is shown in the fig 11 the characteristics of this kind of basis function is that the closer the own ship s course is to the boundary of g c c o the greater its cost increase since the collision risk of each ts is different for m tss under current encounter situation it is necessary to multiply the different cost values by the weights c r t s 0 5 1 for those n tss with no collision risk we need to ensure that new evasion decision do not create another collision risk with these target ships in summary we can get the entire cost function as 27 27 u m u l t i c o s o p t k 1 m c r t s k p t s k c o s o p t k 1 n p t s k c o s o p t 3 2 4 colregs constrained assuming the sea visibility is good the five types encounter situation according to the colregs are shown in fig 12 and the descriptions are shown in table 4 according to the descriptions of the related rules we stipulate that when os is a stand on vessel there is no additional constrains when os is in the head on or cross right encounter situation the collision free course c o s o p t cannot be selected if r p r c z 0 where z pointing downward 3 2 5 off course constrained the collision avoidance decision making system needs to consider the original navigation route of os the decision course c o s o p t should not deviate too far from the original course so as to avoid detours caused by evasive actions and improve the navigation efficiency as shown in fig 13 the light blue line is the planned route of os p 2 x 2 y 2 is the next turning point so we can get the desired course c l o s based on the simplified line of sight method at the current moment 28 c l o s arctan x 2 x o s y 2 y o s if c l o s 0 c l o s c l o s 2 π then we can get the angle θ d between c o s o p t and c l o s 29 θ d c o s o p t c l o s i f c o s o p t c l o s 0 π 2 π c o s o p t c l o s i f c o s o p t c l o s π 2 π c o s o p t c l o s i f c o s o p t c l o s π 0 c o s o p t c l o s 2 π i f c o s o p t c l o s 2 π π θ d 0 π we define the cost function of off course constrained as formula 30 where ω is a weight value 30 u r o u t e c o s o p t ω θ d π 3 2 6 seamanship constrained based on the constrains discussed above the optimal decision c o s o p t taken by os should satisfy 31 c o s o p t ψ ψ c o s c o s g c c o o r r p r c z 0 32 u s u m c o s o p t min u m u l t i c o s o p t u r o u t e c o s o p t based on g c c o and g b c o defined above we first find the selectable space of c o s o p t which is defined in formula 31 c o s o p t should not belong to g c c o and cannot violate colregs the selected c o s o p t is the minimum value of the cost function 32 the equations 26 and 30 have the tuning factor γ and weight value ω respectively these two values can be adjusted as needed in this paper γ 2 5 and ω 1 in addition to that we try to consider the seamanship constrained there are two points the first is to make the decision generated by system become more stable in other words the output decisions should not change frequently the second is to define the judgement condition for past and clear this condition is used to determine when should os return to the original course we set the optimal avoidance decision at the initial moment t 0 as c o s o p t t 0 then the corresponding cost is u s u m t 0 after os takes the collision avoidance action the turning of other ships is not considered temporarily c o s p o s and other state quantities will be different this will change the collision avoidance decision c o s o p t t 1 based on the latest environment information at the next moment t 1 which satisfies u s u m t 0 u s u m t 1 we define the change of course as 33 δ c t 0 c o s o p t t 0 c o s t 0 δ c t 1 c o s o p t t 1 c o s t 0 if δ c t 0 δ c t 1 0 the collision avoidance decision making at moment t 1 is in accordance with equation 34 34 c o s o p t t 1 c o s o p t t 0 i f δ c t 1 δ c t 0 c o s o p t t 1 i f δ c t 1 δ c t 0 it shows that although a smaller turning range of course can be used to avoid collision at time t 1 this kind of evasive action will cause other ships to be alert and even misunderstood such decision is not in accordance with good seamanship on the other hand due to the disturbance of other factors when it is necessary to take a larger turning to complete the collision avoidance operation at time t 1 the collision avoidance decision should be updated to ensure the navigation safety apart from this we define the condition for two ships past and clear the tcpa values of all tss which have collision risk with own ship equal to zero are shown in 35 35 k 1 n t c p a t s k 0 i f t c p a t s k 0 t c p a t s k 0 if 35 is satisfied it means that the collision avoidance process is over and os needs to return to the original route then the new object course is c l o s defined in section 3 2 5 4 the analysis of interactive action taken by ts the multi stage optimization model discussed above is based on a strong assumption that is all tss maintain their course and speed however the interactive behavior of the tss is inevitable under the real scene at sea as shown in fig 14 in scenario a os and ts navigate on the left and right side of the red centerline respectively and the two ships are in head on situation according to the multi stage optimization model os should alter course to starboard side but the manned ship ts chooses to alter course to port side hoping that os can also alter course to port side in this case the evasive action taken by os will be gradually offset by the action taken by ts in scenario b both ts 1 and ts 2 are in cross right situation with os os alters course to starboard side according to the multi stage optimization model at the same time ts 2 is overtaking ts 1 and ts 1 considers that ts 2 is more dangerous than os for this reason ts 1 alters course to port side so as to pass ts 2 at a safe range the action taken by ts 1 will also offset the evasive action taken by os it can be seen that the uncoordinated evasive action will cause serious consequences in summary the actions taken by other ships during collision avoidance process should not be neglected the back end of this system includes a multistage optimization model discussed from section 3 2 1 to 3 2 6 however this decision model can only deal with ideal collision avoidance scenarios ts always keeping course and speed in order to cope with the condition when ts takes temporary actions or violate colregs failure to fulfil the obligations of give way vessel or doesn t comply with colregs this paper proposes the method combined with fsm so as to handle the interactive actions taken by ts fsm records the events and reasons of the research object from the beginning to the end of a period of time it usually contains four elements status events transition conditions and actions the structure of fsm is shown in fig 15 the initial state of os is determined by the front end and divided into give way vessel and stand on vessel there are three triggering conditions in fsm denoted by tc the symbol c represents the state transition condition when os is give way vessel we first divide the actions taken by ts into two categories one is assistance action a m that is taking the coordinate collision avoidance actions with os the other is resistance action r m that is obstructing the os s collision avoidance action we express these two types of actions using velocity vectors assuming r v o is the relative velocity vector between two ships at the initial moment r v o p t is the relative velocity vector after os takes collision avoidance action and r v m is the relative velocity vector after ts taking collision avoidance action the equations for a m and r m are 36 a m r v o r v o p t r v o r v o p t r v o r v m r v o r v m 0 r m r v o r v o p t r v o r v o p t r v o r v m r v o r v m 0 in addition we also define the cumulative course change value δ c t s it refers to the ts s course difference between the current moment and the moment when os takes evasive action according to this we define the trigger condition one tc 1 as tc 1 the δ c t s is greater than 5 and ts takes the second type of action r m it is worth noting that when ts takes the assistant action a m in order to ensure that ts will not confuse the collision avoidance actions taken by os the decision making system will not trigger fsm when tc 1 is reached os enters the state of preparing for action the state of preparing for action is necessary for building a continuous and effective collision avoidance decision making system when os is in a dynamic environment after ts takes action this state can avoid the generation of alternating instructions to os under the state of preparing for action since os does not know the object course of ts os needs to observe the action taken by ts for a period of time we design a simple adaptive observation period μ in 37 37 μ tcpa t s σ tcpa t s is the tcpa value of ts which has taken collision avoidance action and σ is the adaptive tuning factor in this paper σ 25 it means that the larger the tcpa between two ships the longer the observation period the smaller the tcpa the shorter the observation period in the observation period we define the course of ts at the end of the observation period as c t s p r e and the relative velocity vector is r v p r e then we can define the c 1 and c 2 as follows c 1 the action taken by ts completely offsets or even exceeds the effect of the evasive action taken by os which can be expressed as equation 38 38 r v p r e r v o or r v o r v p r e z r v o r v o p t z 0 c 2 the action taken by ts does not completely offset the effect of the evasive action taken by os which can be expressed as equation 39 39 r v o r v p r e z r v o r v o p t z 0 when c 1 is reached os takes action 1 the action strategy is removing the colregs constrains of all tss and resetting its constrains mentioned in section 4 4 for those ts that have taken actions the collision free course c o s o p t cannot be selected if i f r p r c z 0 when c 2 is reached os takes action 2 the action strategy is according to the multi stage optimization model to recalculate the object course based on the latest environment information when os is stand on vessel it is difficult to ensure that the give way vessel ts will take proper actions according to rule 17 action by stand on vessel of colregs when give way vessel finds that stand on vessel has not followed the rules and took appropriate collision avoidance actions give way vessel may take action to avoid collision by her maneuver alone therefore we define tc 2 and tc 3 when the condition is triggered the role of os changes from stand on vessel to give way vessel first tc 2 is defined as follows tc 2 when d d p and δ c t s less than 5 tc 2 states that until the distance between the two ships is equal to the safe passing distance if the give way vessel ts has not taken any evasive action then os can take action alone according to table 4 in section 3 2 4 there are two scenarios when os is stand on vessel one is cross left and the other is overtaken the requirements for the action taken by os are different under different scenarios the definitions of c 3 c 4 and action 3 action 4 are given respectively c 3 the current encounter situation between two ships is cross left when c 3 is reached os takes action 3 the action strategy is for the ts crossing from left os only needs to keep g c c o and c o s o p t g c c o besides os need to remove the colregs constrains of all tss and add new constrains for the ts crossing from left which does not take proper action c o s o p t cannot be selected i f r p r c z 0 action 3 is based on rule 17 c os shall not alter course to port for a vessel on her own port side c 4 the current encounter situation between two ships is overtaken when c 4 is reached os takes action 4 the action strategy is for the ts overtaking os os only needs to keep g c c o and c o s o p t g c c o besides os need to remove the colregs constrains of all tss and add new constrains for the ts which is overtaking os and doesn t take proper action c o s o p t cannot be selected as listed in formula 40 40 i f r p r c z 0 w h e n q 0 π i f r p r c z 0 w h e n q π 0 the basis for c 4 is to comply with navigation practice the overtaken vessel should not turn in the direction of the overtaking side tc 2 is for the situation where the give way vessel does not take action for the situation where give way vessel take action but the action is not enough to ensure two ships passing at a safe distance tc 3 and action 5 are defined tc 3 when d d p δ c t s more than 5 and c o s g c c o when tc 3 is reached os takes action 5 the action strategy is os only needs to keep g c c o and c o s o p t g c c o what s more remove the colregs constrains of all tss os should take assistant action a m according to the actions taken by ts the relative velocity vector at the initial moment is r v o let r v t s be the relative velocity vector at the trigger moment of tc 3 and r v o s be the relative velocity vector after os altering course to c o s o p t the selectable collection of c o s o p t should satisfy 41 r v o r v o s r v o r v o s r v o r v t s r v o r v t s 0 5 case study we embedded the collision avoidance decision making system into the ecs electronic chart system all tss can be generated as virtual ais targets so various encounter situation can be set dynamically compared with other simulation platforms ecs have the following advantages 1 the simulation process and experimental results are more vivid the units of numerical variables used in the experiment such as nautical miles latitude and longitude coordinates etc are consistent with the real marine navigation environment 2 it is generally known that ecs is an information integrated platform on board with rich input and output interfaces the collision avoidance decision system is encapsulated in ecs to prepare for the following real ship test 3 ecs and the presented system are both developed by c which has high operation and execution efficiency it is more suitable for engineering applications in this section we set up 10 different types of ship encounter scenarios from single ship to multi ship from single encounter scenarios to multiple scenarios mixed with each other from other ships keeping course to other ships taking evasive action at the same time in order to prove the effectiveness of the collision avoidance decision making system in a given time we record the dcpa which is relative to each ts during the collision avoidance process the theoretical calculation output object course and current course at every time step in the electronic chart platform interface the blue solid line represents the navigation route of os the double concentric circle represents os the green triangle represents the ais targets and the velocity vector lines of the moving ships are represented by arrows to make the interface more intuitive we make the ship as the center and use the red circle to represent the dcpa value between the selected ts the length of the tangent outside the circle represents the size of tcpa 5 1 scenario 1 head on the initial information of ts and os is shown in table 5 the coordinates are expressed in latitude and longitude the unit of course and true bearing is degree the unit of speed is knot and the unit of distance between the two ships is nautical mile the columns of distance and true bearing indicate the value of ts relative to os and the value of os is expressed by zero the experimental results are shown in the fig 16 a three graphs from left to right correspond to the start time the middle time and the end time during the collision avoidance process the lower right corner of the middle graph is a partially enlarged view of the os s collision avoidance trajectory according to the experimental results there is a collision risk between two ships and they are in head on situation according to colregs rule 14 os alters course to starboard side so as to pass the ts port to port when the tcpa of ts is less than zero os ends evasive action and starts to return to the original route fig 16 b indicates the relationship between the os s current course and the object course generated by this system we can see the object course generated at each time step is stable due to the inertia after reaching the object course the course of os will continue to deviate then recover and tend to be stable the change of dcpa between these two ships is shown in fig 16 c 5 2 scenario 2 crossing the initial information of ts and os is shown in table 6 the experimental results are shown in the fig 17 a according to colregs rule 15 these two ships are in crossing situation ts is on the os s starboard side so os is the give way vessel os needs to turn to the right and avoid crossing the bow of ts os begins to return to the original route when past and clear fig 17 b indicates the relationship between the os s current course and the object course generated by this system the change of dcpa between these two ships is shown in fig 17 c 5 3 scenario 3 overtaking the initial information of ts and os is shown in table 7 the experimental results are shown in the fig 18 a according to rule 13 os is overtaking vessel os can choose to overtake from the port or starboard side of ts considering that the cost of deviation from the original route is less when overtaking is from the starboard side of target ship os turns to the right and starts to return to the original route after past and clear fig 18 b indicates the relationship between os s current course and the object course generated by this system the change of dcpa between these two ships is shown in fig 18 c 5 4 scenario 4 multi ship encounter situation the initial information of tss and os is shown in table 8 os and five tss form a multi ship encounter situation the experimental process is shown in fig 19 a ts 1 is located at the far left of the figure and does not have collision risk with os ts 2 is located at the right of the figure and forms a crossing situation with os ts 3 is the closest to os at the initial moment of the experiment ts 3 is crossing the bow of os and there is no collision risk with os both ts 4 and ts 5 form an head on encounter situation with os where ts 4 is located on the port side of os and ts 5 is on the starboard side of os for os 2 according to colregs rule 15 os is the give way vessel and should alert course to starboard side so as to pass the aft of ts 2 for ts 4 and ts 5 according to colregs rule 14 os should turn to the right fig 19 b indicates the relationship between os s current course and the object course generated by this system the change of dcpa relative to these five tss is shown in fig 19 c 5 5 scenario 5 head on ts takes action the initial information of ts and os is shown in table 9 the experimental process is shown in fig 20 a at the initial moment os and ts are in head on situation according to colregs rule 14 os turns to the right after os takes action ts also alters course to starboard side to cooperate with os completing the collision avoidance as defined in section 4 when ts takes assistance action os will keep the current course until past and clear fig 20 b indicates the relationship between the os s current course and the object course generated by system the change of dcpa between two ships is shown in fig 20 c 5 6 scenario 6 crossing ts takes action the initial information of ts and os is shown in table 10 the experimental results are shown in fig 21 a at the initial moment these two ships are in crossing situation and ts is on the starboard side of os according to colregs rule 15 os is the give way vessel it should turn to the right and pass the aft of ts the object course and current course of os are shown in fig 21 b the dcpa between these two ships is shown in fig 21 c after os takes evasive action ts suddenly turns to the left as defined in section 4 ts takes resistance action this type of encounter situation is satisfied with condition 4 therefore os continues to turn to the right according to the latest information at the current moment fig 21 d indicates the relationship between os s current course and the object course generated by the system the change of dcpa between these two ships is shown in fig 21 e 5 7 scenario 7 crossing ts is give way vessel the initial information of ts and os is shown in table 11 the experimental process is shown in the fig 22 a there is a collision risk between the two ships at the initial moment according to colregs ts is give way vessel and os is stand on vessel however ts does not actively take collision avoidance action so the trigger condition 2 is reached when the distance between two ships is less than d p the condition 3 is reached so os turns to the right side fig 22 b indicates the relationship between os s current course and the object course generated by system the change of dcpa between these two ships is shown in fig 22 c 5 8 scenario 8 overtaking ts takes action the initial information of ts and os is shown in table 12 the experimental process is shown in fig 23 a at the initial moment there is collision risk between os and ts according to colregs rule 13 os is overtaking vessel and give way vessel the current course of os and the object course generated by system at each time step are shown in fig 23 b the change of dcpa between these two ships is shown in fig 23 c after os takes evasive action ts suddenly turns to the right as defined in section 4 the action taken by ts is resistance action it is satisfied with condition 3 therefore os alters course to port side so as to pass the ts within a safe distance fig 23 d indicates the relationship between the os s current course and the object course generated by system the change of dcpa between these two ships is shown in fig 23 e 5 9 scenario 9 overtaking ts is give way vessel the initial information of ts and os is shown in table 13 the experimental process is shown in fig 24 a at the initial moment ts is overtaking os so ts is give way vessel the collision avoidance action taken by ts is to turn left by 5 after that the dcpa value between two ships is about 0 8 nautical miles however this value is less than d s so the trigger condition 3 is reached therefore os should take assistant action turning to the right side and help ts to complete the collision avoidance process fig 24 b indicates the relationship between the os s current course and the object course generated by system the change of dcpa between these two ships is shown in fig 24 c 5 10 scenario 10 multi ship encounter situation ts takes action the initial information of os and tss is shown in table 14 the experimental results are shown in fig 25 a at the beginning of collision avoidance process ts 1 is located at the far left of the current scene and there is no collision risk with os ts 2 is in crossing situation with os which is located at the far right of the scene ts 3 is located in the direction of os s bow and forms a head on situation with os os should alter course to starboard side fig 25 b indicates the relationship between os s current course and the object course generated by system the change of dcpa relative to these three tss is shown in fig 25 c after os takes evasive action ts 2 and ts 3 take active actions separately ts 2 turns to left and ts 3 turns to right according to the definition in section 4 ts 2 takes resistance action and ts 3 takes assistance action os alters course to port side based on the latest information of the current situation fig 25 d indicates the relationship between the os s current course and the object course generated by system the change of dcpa relative to these three tss is shown in fig 25 e 6 conclusion 6 1 discussion on the performance of the developed decision making system in section 5 the system is tested under ideal condition by scenario 1 to scenario 4 when tss always keep original course and speed throughout the collision avoidance process the simulation experiment results show that the system can safely and correctly avoid collision under several typical encounter situations including head on overtaking crossing and mixed scenarios more general and realistic situations are verified by scenario 5 to scenario 10 these scenarios take into account the temporary actions taken by ts when os is give way vessel and ts is stand on vessel whether the action is assistant or resistant should be determined first and the decision will be made based on the action degree of ts when os is stand on vessel and ts is give way vessel if ts does not take proper action until the distance between os and ts is less than the safe passing distance d p os will actively make decisions based on the current situation to ensure safety from the simulation results of these 10 scenarios it can be seen that the system proposed in this paper is adaptable and can deal with a variety of typical scenarios including ts taking actions during the collision avoidance process besides the system can continuously output the latest decisions according to the latest information of the current scene at each time step the decision making framework based on the front and back ends improves the stability and reliability of the system the decision making model based on modified vo method incorporates part of navigation experience and good seamanship we implement a relatively complete system and embed it into ecs 6 2 comparison with other vo algorithms for ship collision avoidance due to the inherent good characteristics of the vo method there are many valuable and effective collision avoidance algorithms based on vo model this paper is exactly inspired by these meaningful work however there are some differences between this paper and the others first from theoretical perspective vo is used to find out all collision free velocities some vo algorithms only give optional velocity space to provide decision making support for oow szlapczynski and szlapczynska 2017a b huang et al 2018 chen et al 2018 these algorithms cannot calculate the optimal collision avoidance decisions although some vo algorithms find out the optimal solution by designing objective function zhao et al 2016 kufoalor et al 2018 or giving constraint rules huang et al 2019 few methods can fully consider the real application scene and be used to design a complete cas the modified vo method proposed in this paper fully considers various limiting factors in the real marine environment including ship maneuverability multi ship encounter situation colregs course maintenance good seamanship and situations in which other vessels take actions second few vo models can handle situations where other ships temporarily take action or violate colregs during the collision avoidance process some algorithms consider the dynamic characteristics of other ships but most of them are based on assumptions for example the common collision avoidance algorithm is used for both os and ts zhao et al 2016 or ts will actively send the predicted trajectory to os huang et al 2018 2019 2020 when ts suddenly takes action these methods may not be suitable in fact the marine environment is highly dynamic so it is difficult for the static vo model to handle all kinds of accidents during collision avoidance process therefore the collision avoidance decision making system in this paper attempts to use fsm to dynamically adjust the constraint rules and parameters of the multi stage optimization model based on the modified vo algorithm the decision making logics can be converted along with the changes in the external environment so that the system can cope with various scenarios that occur during collision avoidance process 6 3 potential improvements of the decision making system the real marine environment is more complicated so equipping the collision avoidance decision making system designed in this paper on mass still faces many challenges the challenges and relevant improvement are discussed first the states actions and trigger conditions defined in the fsm cannot fully guarantee the coverage of all situations that occur during the collision avoidance process this requires further testing to optimize the system besides this paper simplifies the process of identifying the actions taken by other ships in fact the intentions and actions of other ships are a topic worth studying wang et al 2020 wu et al 2020 du et al 2020 rong et al 2019 further research work can learn from the methods of unmanned vehicles or drones such as hidden markov model hmm or dynamic bayesian network dbn second the system and model proposed in this paper are suitable for application in ocean or open waters along the coast for the restricted waters such as harbors and narrow channel there are many static obstacles and restricted regions although some vo algorithms consider the application in restricted waters szlapczynski and szlapczynska 2017a b huang et al 2018 by introducing time windows to construct velocity obstacle regions for static obstacles there are still many challenges and difficulties in restricted waters 7 conclusions the main contribution of this paper is to design a ship collision avoidance decision making system based on modified velocity obstacle method the structure of this system is divided into front end and back end the decision process takes into account a variety of limiting factors in the real marine environment including ship maneuverability multi ship encounter situation colregs course maintenance good seamanship especially the consideration of other ship s actions the system is embedded in ecs and the effectiveness of the system is verified through simulation experiments under 10 different scenarios the comparision is also made between the presented system and existing vo based collision avoidance models however some issues should be carefully handled and be addressed in the future when the system is implemented in the autonomous ships especially for the understanding of other ships intention and more complex application scenarios credit authorship contribution statement wang shaobo conceptualization methodology software formal analysis data curation writing original draft writing review editing visualization zhang yingjun supervision conceptualization resources writing review editing project administration funding acquisition li lianbo validation formal analysis investigation data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledegments this work was financially supported by the national natural science foundation of china grant no 51679025 
21565,this paper proposed a new collision avoidance decision making system designed for autonomous ship the system outputs collision avoidance decisions based on the latest information at a certain frequency which is suitable for real ship application front end and back end are two main components of this system front end provides preliminary information while back end generates collision avoidance decisions based on modified velocity obstacle method the multistage optimization decision model is introduced and various constrains are considered including ship maneuverability multi ship colregs off course and seamanship then the interactive actions taken by other ships during collision avoidance process are further analyzed the modified velocity obstacle method incorporates a finite state machine fsm which can be used to handle the dynamic behavior of other ships finally the case study is completed on the electronic chart system ecs to show that the proposed collision avoidance decision making system is robust and effective under various marine scenarios therefore the system has great potential to be equipped on board in the future keywords ship collision avoidance velocity obstacle autonomous ship decision making system 1 introduction 1 1 background more than 85 of marine accidents are related to ship navigation including grounding and ship collision wróbel et al 2017 wu et al 2020 as one major threat to the safety of maritime navigation ship collision may cause serious casualties economic losses and marine environmental pollution etc according to statistics more than 80 of ship collisions are caused by human error he et al 2017 therefore in order to mitigate the potential navigation risks due to human factors and further increase the level of intelligence in marine transportation the international maritime organization imo has been devoting to the research on the technologies and regulations of the maritime autonomous surface ship mass in recent years the autonomous navigation system ans is the brain of mass and plays a critical role throughout the system ans makes a series of navigation decisions in real time based on external information fig 1 explains the components of ans in details the sensor system includes traditional onboard radars ship automatic identification system ais normal cameras infrared cameras and lidar etc through the information fusion of these multi source sensors the full range of environmental information around the ship can be transmitted to the automatic collision avoidance system cas in accordance with the requirements of the international regulations for preventing collisions at sea colregs cas calculates the desired course and speed through the pivotal collision avoidance decision making algorithms in addition the navigation route is adjusted according to the latest maritime safety information msi the global guidance information and local guidance information are sent to the ship control system together to ensure the safety of mass cas is one of the most important components in the whole ans in this study we design a robust and efficient collision avoidance decision making system to satisfy the real application requirements of mass the collision avoidance model used in this system is based on the modified velocity obstacle vo algorithm and various scenarios are designed to verify the effectiveness of the system 1 2 literature review a lot of valuable research has been carried out on autonomous ship collision avoidance decision making the concepts techniques and key points of ship collision avoidance have been summarized in some literature reviews statheros et al 2008 tam et al 2009 liu et al 2016 huang et al 2020 with the continuous development of intelligent unmanned technology the obstacle avoidance theory of unmanned systems gradually migrated to the marine field researchers have designed many new collision avoidance algorithms and achieved good results such as the improved artificial potential field apf xue et al 2011 lyu and yin 2018 the dynamic window dw eriksen et al 2018 and the modified model predictive control mpc johansen et al 2016 xie et al 2019 it is also worth noting that methods based on deep reinforcement learning have become popular in recent years shen et al 2019 zhao and roh 2019 woo and kim 2020 zhang et al 2019 among these collision avoidance algorithms velocity obstacle method has attracted the attention of many researchers because of its own characteristics vo was first proposed by fiorini and shiller 1998 after that in response to the different problems during the application many variants have been derived which forms a rich vo algorithm cluster such as nlvo nonlinear velocity obstacle large et al 2002 pvo probabilistic velocity obstacle kluge and prassler 2004 rvo reciprocal velocity obstacle van den berg et al 2008 orca optimal reciprocal collision avoidance van den berg et al 2011 and grvo generalized reciprocal velocity obstacle bareiss and van den berg 2015 vo is also widely used in the field of ship collision avoidance nowadays the dcpa distance of the closest point of approach and tcpa time to the closest point of approach are still the two main criteria for the oow officer on watch to make an evasion decision hilgert and baldauf 1997 arpa automatic radar plotting aid is based on these two criteria to make early warning of potential collision hazards and provide decision making support for oow wang et al 2017 moreover the theory of ctpa collision threat parameter area proposed by degré and lefèvr 1981 is close to vo ctpa can collect all velocity vectors that may cause collisions between two ships in the future then it incorporates ship domain sd and colregs separately szlapczynski 2009 szlapczynski and szlapczynska 2015 what s more ctpa is also applied in restricted waters szlapczynski and szlapczynska 2017a b besides the researchers incorporate colregs on the basis of the classic linear velocity obstacle lvo method kuwata et al 2014 zhao et al 2016 modify the orca algorithm and consider the reactive behavior between usvs kufoalor et al 2018 assign the responsibility for collision avoidance between unmanned ships based on the principle of rvo it is worth noting that the research group of gelder p h a j m is a typical representative of vo method used in ship collision avoidance applications in huang et al 2018 the non linear velocity obstacle region is constructed which is based on the assumption that the predicted trajectories of other ships can be obtained it can be used to support oow making the collision avoidance decisions in huang et al 2019 the collision avoidance system named gvo cas is developed which is based on the principle of grvo in addition to that vo is also used for collision risk detection and analysis huang et al 2019 chen et al 2018 2019 recently the research on the consideration and analysis of dynamic characteristics of other ships has become a trend in the field of ship collision avoidance during the real ship navigation the position and trajectory of other ships are uncertain rong et al 2019 zhang et al 2018 furthermore whether other ships will take actions in strict accordance with the colregs such as taking evasive action as give way vessel and keeping course and speed as stand on vessel during the collision avoidance process it hard to be guaranteed du et al 2020 a new collision avoidance decision making mechanism based on observation inference prediction decision oipd can be used when other ships take actions during the collision avoidance process wang et al 2020 wu et al 2020 besides in order to realize the coordinated collision avoidance between own ship and other ships using common collision avoidance algorithm zhao et al 2016 or making collision avoidance strategies from global perspective li et al 2019 are two mainstream methods in fact under the real scenario at sea most ships that are in danger of collision need to communicate and coordinate through vhf very high frequency to ensure the consistent collision avoidance actions therefore some researchers assume that ships can exchange their respective predicted trajectories with each other huang et al 2018 2019 1 3 motivation despite the plenty of research work devoted to the ship collision avoidance problem there are some research gaps in the existing studies first previous research has focused more on designing collision avoidance algorithm while less literature is devoted to developing a complete collision avoidance decision making system with the continuous development of mass the decision making scheme of cas should be more suitable to real ship applications which requires the collision avoidance decision making system to be more robust and have great real time performance the decisions generated by cas should satisfy the requirements of good seamanship second it is obvious that vo has been widely used in the field of ship collision avoidance based on the previous literature review however few papers consider the actions taken by other ships some papers take into account other ships actions but most of them are based on strong assumptions such as using same collision avoidance algorithm or obtaining the predicted trajectories of other ships in fact with the development of mass there will be a long term coexistence situation of mass and manned ships the actions taken by manned ships are highly uncertain such as temporary course turning or violation of colregs however the existing vo method could not handle such problems very well therefore the motivation of this paper is to build a collision avoidance decision making system for mass the system should be fully suitable for real application at sea the system is able to consider various factors including ship maneuverability multi ship encounter situation colregs especially for handling those actions taken by other ships during the collision avoidance process continuous and stable collision avoidance decisions should be output from the collision risk detection to the end of the collision avoidance process 1 4 contributions given the above the contributions of this paper are concluded as follows 1 a collision avoidance decision making system based on the front end and back end structures is designed the system uses modified vo method to output collision avoidance decisions 2 in this paper we combine vo with fsm finite state machine it allows the system to effectively respond to the dynamic behavior of other ships during the avoidance process which makes up the limitations of previous vo models 3 the system presented in this paper is developed by c and embedded in the electronic chart system ecs various simulation cases are designed to verify the effectiveness of system the remainder of this paper is organized as follows section 2 proposes the design ideas and framework of this system section 3 illustrates the algorithms and methods used in the front end and back end and the multistage optimization model is described section 4 analyzes the interactive action taken by other ships and introduces the method which combines vo with fsm the verification and case study are carried out in section 5 discussion and conclusions are drawn in section 6 the main symbols in this paper are shown in table 1 besides own ship is denoted as os target ship as ts they can be used as the footnotes to distinguish variables for example v o s represents the speed of own ship and v t s represents the speed of ts 2 the framework of collision avoidance decision making system the collision avoidance decision making process of autonomous ships is a sequential decision making task we cannot expect to plan a series of evasive actions from the beginning to the end of collision avoidance process in fact we need to adjust and optimize the collision avoidance decision at each time step this process is a typical markov decision making process the decision making at current time only depends on the latest status and it has nothing to do with the past this conforms to the one step dynamic characteristics during the collision avoidance process the autonomous ship should constantly interact with the environment continuously update the relative motion status between other ships and os after that the system selects the optimal action with the lowest cost so as to make the next update cycle reaching the optimal state the process is shown in fig 2 s 0 s k 1 s k s n indicate the status at each sampling moment based on the analysis of decision making process this paper designed a collision avoidance decision making system as shown in fig 3 the system is divided into two parts the front end and the back end the front end is mainly responsible for collecting information of all tss within the alert circle usually 12 nautical miles which centered on os after that front end needs to determine whether there is a collision risk between ships and then discriminate the encounter situations the role of os namely give way vessel or stand on vessel is determined according to colregs at the same time in order to deal with the interactive actions taken by tss the system starts recording the information of ts which have collision risk with os and judging whether the trigger condition of fsm is reached this part is described specifically in section 4 if the trigger condition is reached state transition will be performed in fsm and then transfer to the back end if the condition is not reached the information flow will transfer to the back end immediately the back end performs a multistage optimization process based on the initial decision this process considers ship maneuverability multi ship encounter situation colregs course maintenance and good seamanship finally the optimal decision is delivered to the ship control system and the system enters into the next decision making cycle 3 development of the collision avoidance system 3 1 front end 3 1 1 collision risk detection the calculation results of collision risk value can be used to determine the timing of evasive action by os in addition to that different collision risk values can also support the collision avoidance decision making there are many methods to evaluate ship collision risk szlapczynski and szlapczynska 2017a b chen et al 2019 ozturk and cicek 2019 li et al 2018 in this paper we used different factors to calculate the collision risk including dcpa tcpa d distance b bearing and k speed radio we define the minimum safe encounter distance d s at any time tss are not allowed to pass os within the range of minimum safe encounter distance this paper drew on the sea observation results by goodwin 1975 the size of d s is defined according to the bearing of ts considering the error existed in the observation of dcpa goodwin s results are modified according to the following formula and we can obtain the new d s zheng and wu 2001 1 d s 1 1 b π 0 2 0 b 5 π 8 1 0 b π 0 4 5 π 8 b π 1 0 2 π b π 0 4 π b 11 π 8 1 1 2 π b π 0 4 11 π 8 b 2 π according to the survey and observation results for ships coming to the port side when the initial dcpa is 1 5n miles 98 of the ships do not take evasive action for ships coming to the starboard side or the bow when the initial dcpa is 1 5n miles 94 3 of ships do not take evasive action for stern coming ships when the initial dcpa is 0 9n miles 100 of ships do not take evasive action considering the observation error and the safety we defined the safe passing distance between os and ts as expressed in equation 2 2 d p 2 d s after that the fuzzy membership functions of five factors can be obtained as equations 3 8 3 u dcpa 1 dcpa d s 1 2 1 2 sin π d p d s dcpa d p d s 2 d s dcpa d p 0 d p dcpa 4 u tcpa 1 0 tcpa t 1 t 2 tcpa t 2 t 1 2 t 1 tcpa t 2 0 t 2 tcpa 5 among them t 1 d s 2 dcpa 2 r v dcpa d s d s dcpa r v dcpa d s t 2 d p 2 dcpa 2 r v 6 u d 1 0 d d s d p d d p d s d s d d p 0 d p d 7 u b 1 2 cos b 19 π 180 440 289 cos 2 b 19 π 180 5 17 8 u k 1 2 k k 2 1 2 k sin c o s 1 this paper determined the weight coefficients of five factors as shown in table 2 we can get the collision risk result c r t s of the related ts in terms of equation 9 9 c r t s w 1 u d c p a w 2 u t c p a w 3 u d w 4 u b w 5 u k when c r t s 0 5 there is a collision risk between os and ts and os needs to take collision avoidance action 3 1 2 encounter situation once the collision risk is found between two ships the encounter situation between os and ts should be determined according to colregs in this paper five types of ship encounter situations are proposed head on situation overtaking situation crossing from right situation crossing from left situation and others the scene division model is shown in fig 4 the black arrows in fig 4 represent the velocity vector line corresponding to each ship we use different colors to show different encounter situations ts 1 and os are in head on situation ts 2 and ts 4 cross from right and left of os respectively ts 5 is overtaking os ts 3 is in other situation with os these five types of encounter situations are formulated as equation 10 10 head on π 8 q π 8 3 4 π r c π overtaken q 5 8 π 0 r c 3 8 π v o s v t s cross left 5 8 π q π 8 π 8 r c 5 8 π cross right π 8 q 5 8 π π 8 r c 5 8 π others q r c all bove 3 2 back end 3 2 1 initial decision the collision avoidance decision making system designed in this paper used the linear velocity obstacle method to make the initial decision definition the velocity obstacle vo for os induced by ts is the set of velocities that if chosen from will eventually lead to a dangerous situation between the two vessels let r p indicates the relative position between own ship and target ship which is r p p t s p o s now we define a ray starting from point r p and moving in the direction of r v r v v o s v t s then the ray position after time t is 11 λ r p r v r p r v t t 0 we use the symbol α to represent the circle area with ts as the center and d s as the radius the circle area with d p as the radius is represented by the symbol β then the core velocity obstacle region of os which is relative to ts is 12 v o o s t s v o s λ r p r v α we define that os is not allowed to select any velocity vector in v o o s t s in contrast v o o s t s is defined as the broaden velocity obstacle region os can select velocity vector from it but it needs to pay a price v o o s t s and v o o s t s are shown in fig 5 13 v o o s t s v o s λ r p r v β α considering ships sailing in open sea usually operate at sea speed and most modern ships are fitted with fixed pitch propellers it is difficult for the main engine of the ship to reduce the speed quickly in a short time so we think that reducing ship speed in open sea is not a preferable choice we define the left and right course boundaries of areas v o o s t s and v o o s t s as a l a r and b l b r then the region c c o core course obstacle and b c o broaden course obstacle are defined as 14 c c o c o s a l a r b c o c o s b l a l a r b r 3 2 2 ship maneuverability constrained due to the non linear and dynamic characteristics of the ship s maneuvering model the change of course always takes some time as shown in fig 6 at the initial moment ts moves along the dotted line l t s and os moves along the dotted line l o s 0 if os does not take evasive action the distance between os and ts will be less than the safe passing distance d p at t 1 therefore os need to alert her course to avoid collision the critical angle of port steering and right steering is θ l and θ r respectively if the turning process of os is not considered in other words the turning of the os is instantaneous then the position lines corresponding to the os are straight lines respectively l o s 2 and l o s 1 if the maneuvering model of os is considered the actual position line of the os is a compound curve respectively m o s 1 and m o s 2 the actual position line intersects the outer ring of ts in order to better explain the limitations of ship maneuverability this paper tries to illustrate this constraint by setting up a simple two ship encounter scenario both v o s and v t s are 15kn at the initial moment c o s is 30 and c t s is 210 the distance between two ships is 3 nautical miles two ships are in danger of collision and construct head on situation according to the mechanism of the collision avoidance decision making system from the initial moment we recalculate the new b c o at each subsequent moment and execute b r until v o s leaving the new b c o the current course and object course of os at each moment are shown in fig 7 it is not difficult to see that object course of os is continuously increasing specifically from 54 to 60 in summary figs 6 and 7 indicate that if the system does not take into account the ship s maneuverability constraint the decisions generated by the system cannot guarantee that os and ts will pass at the safe distance therefore we define c c o and b c o boundaries modified by ship maneuverability as 15 c c o a l a l δ δ l a r a r δ δ r b c o b l b l δ η l b r b r δ η r δ δ l δ η l and δ δ r δ η r are the left and right offsets of c c o and b c o respectively from this we can get the new generalized course obstacle region as equation 16 16 g c c o c o s a l a r g b c o c o s b l a l a r b r now we calculate g c c o and g b c o considering the three degree of freedom ship motion mathematical model relevant variable definitions are shown in table 3 because of the left and right symmetry of the ship s weight the horizontal plane motion equation of the ship can be obtained according to newtonian mechanics as follows 17 m u r v x g r 2 x m v r u x g r y i z r m x g v r u n m is the mass of the ship x g is the distance from the origin of coordinates to the center of gravity of the ship i z is the moment of inertia on the ship keel line direction this paper ignores the interference force and the interference moment in the process of ship motion we only consider the ship motion in the static level in addition to this the calculation of rudder angle is carried out by pd controller 18 τ k p ϕ 0 δ c ϕ k d ϕ among them δ c is the steering angle τ is the rudder angle ϕ is the actual course ϕ 0 is the original set course k p is the controller gain coefficient and k d is the controller differential coefficient at the beginning of steering the position coordinate of own ship p o s is 0 0 let c o s be the original course of own ship then we can get target ship position p t s x t y t the coordinates are 19 x t d cos c o s q y t d sin c o s q at any time t after own ship takes evasive action from equations 17 and 18 c o s and v o s can be obtained so the position of os p o s x o t y o t is 20 x o t 0 t v o s cos c o s d t y o t 0 t v o s sin c o s d t then we can get the displacement of os relative to ts 21 δ x x t 0 t v t s cos c t s v o s cos c o s d t δ y y t 0 t v t s sin c t s v o s sin c o s d t the relative bearing q and relative distance d are both the function about time t 22 q t arctan δ y δ x d t δ x 2 δ y 2 relative course r c and relative velocity r v can be expressed as 23 r c t arctan v t s cos c t s v o s cos c o s v t s sin c t s v o s sin c o s r v t v t s 2 v o s 2 2 v t s v o s c o s c t s according to the calculation results of the above parameters we can get the dcpa value wang et al 2017 li et al 2019 between os and ts from the following formula 24 d c p a t d t sin r c t q t π based on the above analysis we can obtain g c c o and g b c o with the consideration of the ship maneuverability a schematic diagram is shown in fig 8 first according to the calculated c c o and b c o in section 3 2 1 we can get their left and right boundaries a l a r and b l b r respectively afterwards the boundary is expanded in the left right direction traversing at 1 intervals and the expanded boundary is set as the new object course when the object course is reached after a period of predicted time t we can get the dcpa value between os and ts according to formula 19 24 then g c c o and g b c o can be obtained by comparing with d s and d p 3 2 3 multi ship constrained the general idea of using the velocity obstacle method to solve the multi ship encounter situation is constructing velocity obstacle region for each ts which exists collision risk with os and the collision avoidance decision c o s n e w should not be selected from these regions at the same time the decision cannot bring new collision risk from those tss which have no collision risk at the beginning of the decision making process let m represent the number of the tss with collision risk n represent the number of the tss with no collision risk under the current situation c o s n e w can be expressed by 25 25 c o s n e w k 1 m v o o s t s k k 1 n v o o s t s k however the collision free course space of the os sometimes will become very limited in order to satisfy the requirements the collision avoidance decision generated by this model will be excessive when ships encounter at a long distance such as ultra large steering greater than 90 or even a u turn however this kind of evasive action is unnecessary and does not satisfy the good seamanship as shown in fig 9 os encounters four tss under the current scene if we strictly follow the original definition of the vo method these two red arrows c o s n e w centered on os should be selected as the collision free course however these two courses are unreasonable the green arrow c o s o p t is more suitable although it slightly invades the velocity obstacle region of the third ts in order to avoid the situation mentioned above this paper no longer defines the velocity obstacle as the region where the velocity vector is completely non selectable instead we proposed g c c o and g b c o as shown in fig 10 the velocity vector c o s n e w is not allowed to select from g c c o it can be selected form g b c o but at the same time there s an extra cost the cost is calculated by the formula 26 26 p t s c o s c o s b l b l a l γ i f c o s a l b l b r c o s b r a r γ i f c o s a r b r in this cost function we chose the basis function y x γ where γ is the tuning parameter its function image is shown in the fig 11 the characteristics of this kind of basis function is that the closer the own ship s course is to the boundary of g c c o the greater its cost increase since the collision risk of each ts is different for m tss under current encounter situation it is necessary to multiply the different cost values by the weights c r t s 0 5 1 for those n tss with no collision risk we need to ensure that new evasion decision do not create another collision risk with these target ships in summary we can get the entire cost function as 27 27 u m u l t i c o s o p t k 1 m c r t s k p t s k c o s o p t k 1 n p t s k c o s o p t 3 2 4 colregs constrained assuming the sea visibility is good the five types encounter situation according to the colregs are shown in fig 12 and the descriptions are shown in table 4 according to the descriptions of the related rules we stipulate that when os is a stand on vessel there is no additional constrains when os is in the head on or cross right encounter situation the collision free course c o s o p t cannot be selected if r p r c z 0 where z pointing downward 3 2 5 off course constrained the collision avoidance decision making system needs to consider the original navigation route of os the decision course c o s o p t should not deviate too far from the original course so as to avoid detours caused by evasive actions and improve the navigation efficiency as shown in fig 13 the light blue line is the planned route of os p 2 x 2 y 2 is the next turning point so we can get the desired course c l o s based on the simplified line of sight method at the current moment 28 c l o s arctan x 2 x o s y 2 y o s if c l o s 0 c l o s c l o s 2 π then we can get the angle θ d between c o s o p t and c l o s 29 θ d c o s o p t c l o s i f c o s o p t c l o s 0 π 2 π c o s o p t c l o s i f c o s o p t c l o s π 2 π c o s o p t c l o s i f c o s o p t c l o s π 0 c o s o p t c l o s 2 π i f c o s o p t c l o s 2 π π θ d 0 π we define the cost function of off course constrained as formula 30 where ω is a weight value 30 u r o u t e c o s o p t ω θ d π 3 2 6 seamanship constrained based on the constrains discussed above the optimal decision c o s o p t taken by os should satisfy 31 c o s o p t ψ ψ c o s c o s g c c o o r r p r c z 0 32 u s u m c o s o p t min u m u l t i c o s o p t u r o u t e c o s o p t based on g c c o and g b c o defined above we first find the selectable space of c o s o p t which is defined in formula 31 c o s o p t should not belong to g c c o and cannot violate colregs the selected c o s o p t is the minimum value of the cost function 32 the equations 26 and 30 have the tuning factor γ and weight value ω respectively these two values can be adjusted as needed in this paper γ 2 5 and ω 1 in addition to that we try to consider the seamanship constrained there are two points the first is to make the decision generated by system become more stable in other words the output decisions should not change frequently the second is to define the judgement condition for past and clear this condition is used to determine when should os return to the original course we set the optimal avoidance decision at the initial moment t 0 as c o s o p t t 0 then the corresponding cost is u s u m t 0 after os takes the collision avoidance action the turning of other ships is not considered temporarily c o s p o s and other state quantities will be different this will change the collision avoidance decision c o s o p t t 1 based on the latest environment information at the next moment t 1 which satisfies u s u m t 0 u s u m t 1 we define the change of course as 33 δ c t 0 c o s o p t t 0 c o s t 0 δ c t 1 c o s o p t t 1 c o s t 0 if δ c t 0 δ c t 1 0 the collision avoidance decision making at moment t 1 is in accordance with equation 34 34 c o s o p t t 1 c o s o p t t 0 i f δ c t 1 δ c t 0 c o s o p t t 1 i f δ c t 1 δ c t 0 it shows that although a smaller turning range of course can be used to avoid collision at time t 1 this kind of evasive action will cause other ships to be alert and even misunderstood such decision is not in accordance with good seamanship on the other hand due to the disturbance of other factors when it is necessary to take a larger turning to complete the collision avoidance operation at time t 1 the collision avoidance decision should be updated to ensure the navigation safety apart from this we define the condition for two ships past and clear the tcpa values of all tss which have collision risk with own ship equal to zero are shown in 35 35 k 1 n t c p a t s k 0 i f t c p a t s k 0 t c p a t s k 0 if 35 is satisfied it means that the collision avoidance process is over and os needs to return to the original route then the new object course is c l o s defined in section 3 2 5 4 the analysis of interactive action taken by ts the multi stage optimization model discussed above is based on a strong assumption that is all tss maintain their course and speed however the interactive behavior of the tss is inevitable under the real scene at sea as shown in fig 14 in scenario a os and ts navigate on the left and right side of the red centerline respectively and the two ships are in head on situation according to the multi stage optimization model os should alter course to starboard side but the manned ship ts chooses to alter course to port side hoping that os can also alter course to port side in this case the evasive action taken by os will be gradually offset by the action taken by ts in scenario b both ts 1 and ts 2 are in cross right situation with os os alters course to starboard side according to the multi stage optimization model at the same time ts 2 is overtaking ts 1 and ts 1 considers that ts 2 is more dangerous than os for this reason ts 1 alters course to port side so as to pass ts 2 at a safe range the action taken by ts 1 will also offset the evasive action taken by os it can be seen that the uncoordinated evasive action will cause serious consequences in summary the actions taken by other ships during collision avoidance process should not be neglected the back end of this system includes a multistage optimization model discussed from section 3 2 1 to 3 2 6 however this decision model can only deal with ideal collision avoidance scenarios ts always keeping course and speed in order to cope with the condition when ts takes temporary actions or violate colregs failure to fulfil the obligations of give way vessel or doesn t comply with colregs this paper proposes the method combined with fsm so as to handle the interactive actions taken by ts fsm records the events and reasons of the research object from the beginning to the end of a period of time it usually contains four elements status events transition conditions and actions the structure of fsm is shown in fig 15 the initial state of os is determined by the front end and divided into give way vessel and stand on vessel there are three triggering conditions in fsm denoted by tc the symbol c represents the state transition condition when os is give way vessel we first divide the actions taken by ts into two categories one is assistance action a m that is taking the coordinate collision avoidance actions with os the other is resistance action r m that is obstructing the os s collision avoidance action we express these two types of actions using velocity vectors assuming r v o is the relative velocity vector between two ships at the initial moment r v o p t is the relative velocity vector after os takes collision avoidance action and r v m is the relative velocity vector after ts taking collision avoidance action the equations for a m and r m are 36 a m r v o r v o p t r v o r v o p t r v o r v m r v o r v m 0 r m r v o r v o p t r v o r v o p t r v o r v m r v o r v m 0 in addition we also define the cumulative course change value δ c t s it refers to the ts s course difference between the current moment and the moment when os takes evasive action according to this we define the trigger condition one tc 1 as tc 1 the δ c t s is greater than 5 and ts takes the second type of action r m it is worth noting that when ts takes the assistant action a m in order to ensure that ts will not confuse the collision avoidance actions taken by os the decision making system will not trigger fsm when tc 1 is reached os enters the state of preparing for action the state of preparing for action is necessary for building a continuous and effective collision avoidance decision making system when os is in a dynamic environment after ts takes action this state can avoid the generation of alternating instructions to os under the state of preparing for action since os does not know the object course of ts os needs to observe the action taken by ts for a period of time we design a simple adaptive observation period μ in 37 37 μ tcpa t s σ tcpa t s is the tcpa value of ts which has taken collision avoidance action and σ is the adaptive tuning factor in this paper σ 25 it means that the larger the tcpa between two ships the longer the observation period the smaller the tcpa the shorter the observation period in the observation period we define the course of ts at the end of the observation period as c t s p r e and the relative velocity vector is r v p r e then we can define the c 1 and c 2 as follows c 1 the action taken by ts completely offsets or even exceeds the effect of the evasive action taken by os which can be expressed as equation 38 38 r v p r e r v o or r v o r v p r e z r v o r v o p t z 0 c 2 the action taken by ts does not completely offset the effect of the evasive action taken by os which can be expressed as equation 39 39 r v o r v p r e z r v o r v o p t z 0 when c 1 is reached os takes action 1 the action strategy is removing the colregs constrains of all tss and resetting its constrains mentioned in section 4 4 for those ts that have taken actions the collision free course c o s o p t cannot be selected if i f r p r c z 0 when c 2 is reached os takes action 2 the action strategy is according to the multi stage optimization model to recalculate the object course based on the latest environment information when os is stand on vessel it is difficult to ensure that the give way vessel ts will take proper actions according to rule 17 action by stand on vessel of colregs when give way vessel finds that stand on vessel has not followed the rules and took appropriate collision avoidance actions give way vessel may take action to avoid collision by her maneuver alone therefore we define tc 2 and tc 3 when the condition is triggered the role of os changes from stand on vessel to give way vessel first tc 2 is defined as follows tc 2 when d d p and δ c t s less than 5 tc 2 states that until the distance between the two ships is equal to the safe passing distance if the give way vessel ts has not taken any evasive action then os can take action alone according to table 4 in section 3 2 4 there are two scenarios when os is stand on vessel one is cross left and the other is overtaken the requirements for the action taken by os are different under different scenarios the definitions of c 3 c 4 and action 3 action 4 are given respectively c 3 the current encounter situation between two ships is cross left when c 3 is reached os takes action 3 the action strategy is for the ts crossing from left os only needs to keep g c c o and c o s o p t g c c o besides os need to remove the colregs constrains of all tss and add new constrains for the ts crossing from left which does not take proper action c o s o p t cannot be selected i f r p r c z 0 action 3 is based on rule 17 c os shall not alter course to port for a vessel on her own port side c 4 the current encounter situation between two ships is overtaken when c 4 is reached os takes action 4 the action strategy is for the ts overtaking os os only needs to keep g c c o and c o s o p t g c c o besides os need to remove the colregs constrains of all tss and add new constrains for the ts which is overtaking os and doesn t take proper action c o s o p t cannot be selected as listed in formula 40 40 i f r p r c z 0 w h e n q 0 π i f r p r c z 0 w h e n q π 0 the basis for c 4 is to comply with navigation practice the overtaken vessel should not turn in the direction of the overtaking side tc 2 is for the situation where the give way vessel does not take action for the situation where give way vessel take action but the action is not enough to ensure two ships passing at a safe distance tc 3 and action 5 are defined tc 3 when d d p δ c t s more than 5 and c o s g c c o when tc 3 is reached os takes action 5 the action strategy is os only needs to keep g c c o and c o s o p t g c c o what s more remove the colregs constrains of all tss os should take assistant action a m according to the actions taken by ts the relative velocity vector at the initial moment is r v o let r v t s be the relative velocity vector at the trigger moment of tc 3 and r v o s be the relative velocity vector after os altering course to c o s o p t the selectable collection of c o s o p t should satisfy 41 r v o r v o s r v o r v o s r v o r v t s r v o r v t s 0 5 case study we embedded the collision avoidance decision making system into the ecs electronic chart system all tss can be generated as virtual ais targets so various encounter situation can be set dynamically compared with other simulation platforms ecs have the following advantages 1 the simulation process and experimental results are more vivid the units of numerical variables used in the experiment such as nautical miles latitude and longitude coordinates etc are consistent with the real marine navigation environment 2 it is generally known that ecs is an information integrated platform on board with rich input and output interfaces the collision avoidance decision system is encapsulated in ecs to prepare for the following real ship test 3 ecs and the presented system are both developed by c which has high operation and execution efficiency it is more suitable for engineering applications in this section we set up 10 different types of ship encounter scenarios from single ship to multi ship from single encounter scenarios to multiple scenarios mixed with each other from other ships keeping course to other ships taking evasive action at the same time in order to prove the effectiveness of the collision avoidance decision making system in a given time we record the dcpa which is relative to each ts during the collision avoidance process the theoretical calculation output object course and current course at every time step in the electronic chart platform interface the blue solid line represents the navigation route of os the double concentric circle represents os the green triangle represents the ais targets and the velocity vector lines of the moving ships are represented by arrows to make the interface more intuitive we make the ship as the center and use the red circle to represent the dcpa value between the selected ts the length of the tangent outside the circle represents the size of tcpa 5 1 scenario 1 head on the initial information of ts and os is shown in table 5 the coordinates are expressed in latitude and longitude the unit of course and true bearing is degree the unit of speed is knot and the unit of distance between the two ships is nautical mile the columns of distance and true bearing indicate the value of ts relative to os and the value of os is expressed by zero the experimental results are shown in the fig 16 a three graphs from left to right correspond to the start time the middle time and the end time during the collision avoidance process the lower right corner of the middle graph is a partially enlarged view of the os s collision avoidance trajectory according to the experimental results there is a collision risk between two ships and they are in head on situation according to colregs rule 14 os alters course to starboard side so as to pass the ts port to port when the tcpa of ts is less than zero os ends evasive action and starts to return to the original route fig 16 b indicates the relationship between the os s current course and the object course generated by this system we can see the object course generated at each time step is stable due to the inertia after reaching the object course the course of os will continue to deviate then recover and tend to be stable the change of dcpa between these two ships is shown in fig 16 c 5 2 scenario 2 crossing the initial information of ts and os is shown in table 6 the experimental results are shown in the fig 17 a according to colregs rule 15 these two ships are in crossing situation ts is on the os s starboard side so os is the give way vessel os needs to turn to the right and avoid crossing the bow of ts os begins to return to the original route when past and clear fig 17 b indicates the relationship between the os s current course and the object course generated by this system the change of dcpa between these two ships is shown in fig 17 c 5 3 scenario 3 overtaking the initial information of ts and os is shown in table 7 the experimental results are shown in the fig 18 a according to rule 13 os is overtaking vessel os can choose to overtake from the port or starboard side of ts considering that the cost of deviation from the original route is less when overtaking is from the starboard side of target ship os turns to the right and starts to return to the original route after past and clear fig 18 b indicates the relationship between os s current course and the object course generated by this system the change of dcpa between these two ships is shown in fig 18 c 5 4 scenario 4 multi ship encounter situation the initial information of tss and os is shown in table 8 os and five tss form a multi ship encounter situation the experimental process is shown in fig 19 a ts 1 is located at the far left of the figure and does not have collision risk with os ts 2 is located at the right of the figure and forms a crossing situation with os ts 3 is the closest to os at the initial moment of the experiment ts 3 is crossing the bow of os and there is no collision risk with os both ts 4 and ts 5 form an head on encounter situation with os where ts 4 is located on the port side of os and ts 5 is on the starboard side of os for os 2 according to colregs rule 15 os is the give way vessel and should alert course to starboard side so as to pass the aft of ts 2 for ts 4 and ts 5 according to colregs rule 14 os should turn to the right fig 19 b indicates the relationship between os s current course and the object course generated by this system the change of dcpa relative to these five tss is shown in fig 19 c 5 5 scenario 5 head on ts takes action the initial information of ts and os is shown in table 9 the experimental process is shown in fig 20 a at the initial moment os and ts are in head on situation according to colregs rule 14 os turns to the right after os takes action ts also alters course to starboard side to cooperate with os completing the collision avoidance as defined in section 4 when ts takes assistance action os will keep the current course until past and clear fig 20 b indicates the relationship between the os s current course and the object course generated by system the change of dcpa between two ships is shown in fig 20 c 5 6 scenario 6 crossing ts takes action the initial information of ts and os is shown in table 10 the experimental results are shown in fig 21 a at the initial moment these two ships are in crossing situation and ts is on the starboard side of os according to colregs rule 15 os is the give way vessel it should turn to the right and pass the aft of ts the object course and current course of os are shown in fig 21 b the dcpa between these two ships is shown in fig 21 c after os takes evasive action ts suddenly turns to the left as defined in section 4 ts takes resistance action this type of encounter situation is satisfied with condition 4 therefore os continues to turn to the right according to the latest information at the current moment fig 21 d indicates the relationship between os s current course and the object course generated by the system the change of dcpa between these two ships is shown in fig 21 e 5 7 scenario 7 crossing ts is give way vessel the initial information of ts and os is shown in table 11 the experimental process is shown in the fig 22 a there is a collision risk between the two ships at the initial moment according to colregs ts is give way vessel and os is stand on vessel however ts does not actively take collision avoidance action so the trigger condition 2 is reached when the distance between two ships is less than d p the condition 3 is reached so os turns to the right side fig 22 b indicates the relationship between os s current course and the object course generated by system the change of dcpa between these two ships is shown in fig 22 c 5 8 scenario 8 overtaking ts takes action the initial information of ts and os is shown in table 12 the experimental process is shown in fig 23 a at the initial moment there is collision risk between os and ts according to colregs rule 13 os is overtaking vessel and give way vessel the current course of os and the object course generated by system at each time step are shown in fig 23 b the change of dcpa between these two ships is shown in fig 23 c after os takes evasive action ts suddenly turns to the right as defined in section 4 the action taken by ts is resistance action it is satisfied with condition 3 therefore os alters course to port side so as to pass the ts within a safe distance fig 23 d indicates the relationship between the os s current course and the object course generated by system the change of dcpa between these two ships is shown in fig 23 e 5 9 scenario 9 overtaking ts is give way vessel the initial information of ts and os is shown in table 13 the experimental process is shown in fig 24 a at the initial moment ts is overtaking os so ts is give way vessel the collision avoidance action taken by ts is to turn left by 5 after that the dcpa value between two ships is about 0 8 nautical miles however this value is less than d s so the trigger condition 3 is reached therefore os should take assistant action turning to the right side and help ts to complete the collision avoidance process fig 24 b indicates the relationship between the os s current course and the object course generated by system the change of dcpa between these two ships is shown in fig 24 c 5 10 scenario 10 multi ship encounter situation ts takes action the initial information of os and tss is shown in table 14 the experimental results are shown in fig 25 a at the beginning of collision avoidance process ts 1 is located at the far left of the current scene and there is no collision risk with os ts 2 is in crossing situation with os which is located at the far right of the scene ts 3 is located in the direction of os s bow and forms a head on situation with os os should alter course to starboard side fig 25 b indicates the relationship between os s current course and the object course generated by system the change of dcpa relative to these three tss is shown in fig 25 c after os takes evasive action ts 2 and ts 3 take active actions separately ts 2 turns to left and ts 3 turns to right according to the definition in section 4 ts 2 takes resistance action and ts 3 takes assistance action os alters course to port side based on the latest information of the current situation fig 25 d indicates the relationship between the os s current course and the object course generated by system the change of dcpa relative to these three tss is shown in fig 25 e 6 conclusion 6 1 discussion on the performance of the developed decision making system in section 5 the system is tested under ideal condition by scenario 1 to scenario 4 when tss always keep original course and speed throughout the collision avoidance process the simulation experiment results show that the system can safely and correctly avoid collision under several typical encounter situations including head on overtaking crossing and mixed scenarios more general and realistic situations are verified by scenario 5 to scenario 10 these scenarios take into account the temporary actions taken by ts when os is give way vessel and ts is stand on vessel whether the action is assistant or resistant should be determined first and the decision will be made based on the action degree of ts when os is stand on vessel and ts is give way vessel if ts does not take proper action until the distance between os and ts is less than the safe passing distance d p os will actively make decisions based on the current situation to ensure safety from the simulation results of these 10 scenarios it can be seen that the system proposed in this paper is adaptable and can deal with a variety of typical scenarios including ts taking actions during the collision avoidance process besides the system can continuously output the latest decisions according to the latest information of the current scene at each time step the decision making framework based on the front and back ends improves the stability and reliability of the system the decision making model based on modified vo method incorporates part of navigation experience and good seamanship we implement a relatively complete system and embed it into ecs 6 2 comparison with other vo algorithms for ship collision avoidance due to the inherent good characteristics of the vo method there are many valuable and effective collision avoidance algorithms based on vo model this paper is exactly inspired by these meaningful work however there are some differences between this paper and the others first from theoretical perspective vo is used to find out all collision free velocities some vo algorithms only give optional velocity space to provide decision making support for oow szlapczynski and szlapczynska 2017a b huang et al 2018 chen et al 2018 these algorithms cannot calculate the optimal collision avoidance decisions although some vo algorithms find out the optimal solution by designing objective function zhao et al 2016 kufoalor et al 2018 or giving constraint rules huang et al 2019 few methods can fully consider the real application scene and be used to design a complete cas the modified vo method proposed in this paper fully considers various limiting factors in the real marine environment including ship maneuverability multi ship encounter situation colregs course maintenance good seamanship and situations in which other vessels take actions second few vo models can handle situations where other ships temporarily take action or violate colregs during the collision avoidance process some algorithms consider the dynamic characteristics of other ships but most of them are based on assumptions for example the common collision avoidance algorithm is used for both os and ts zhao et al 2016 or ts will actively send the predicted trajectory to os huang et al 2018 2019 2020 when ts suddenly takes action these methods may not be suitable in fact the marine environment is highly dynamic so it is difficult for the static vo model to handle all kinds of accidents during collision avoidance process therefore the collision avoidance decision making system in this paper attempts to use fsm to dynamically adjust the constraint rules and parameters of the multi stage optimization model based on the modified vo algorithm the decision making logics can be converted along with the changes in the external environment so that the system can cope with various scenarios that occur during collision avoidance process 6 3 potential improvements of the decision making system the real marine environment is more complicated so equipping the collision avoidance decision making system designed in this paper on mass still faces many challenges the challenges and relevant improvement are discussed first the states actions and trigger conditions defined in the fsm cannot fully guarantee the coverage of all situations that occur during the collision avoidance process this requires further testing to optimize the system besides this paper simplifies the process of identifying the actions taken by other ships in fact the intentions and actions of other ships are a topic worth studying wang et al 2020 wu et al 2020 du et al 2020 rong et al 2019 further research work can learn from the methods of unmanned vehicles or drones such as hidden markov model hmm or dynamic bayesian network dbn second the system and model proposed in this paper are suitable for application in ocean or open waters along the coast for the restricted waters such as harbors and narrow channel there are many static obstacles and restricted regions although some vo algorithms consider the application in restricted waters szlapczynski and szlapczynska 2017a b huang et al 2018 by introducing time windows to construct velocity obstacle regions for static obstacles there are still many challenges and difficulties in restricted waters 7 conclusions the main contribution of this paper is to design a ship collision avoidance decision making system based on modified velocity obstacle method the structure of this system is divided into front end and back end the decision process takes into account a variety of limiting factors in the real marine environment including ship maneuverability multi ship encounter situation colregs course maintenance good seamanship especially the consideration of other ship s actions the system is embedded in ecs and the effectiveness of the system is verified through simulation experiments under 10 different scenarios the comparision is also made between the presented system and existing vo based collision avoidance models however some issues should be carefully handled and be addressed in the future when the system is implemented in the autonomous ships especially for the understanding of other ships intention and more complex application scenarios credit authorship contribution statement wang shaobo conceptualization methodology software formal analysis data curation writing original draft writing review editing visualization zhang yingjun supervision conceptualization resources writing review editing project administration funding acquisition li lianbo validation formal analysis investigation data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledegments this work was financially supported by the national natural science foundation of china grant no 51679025 
21566,water entry of cylindrical structures is a complex multiphase flow problem involving a three phase medium interaction that occurs instantaneously it is a nonlinear and unsteady process which the physical understanding of mechanism in the aspect of evolution of cavity dynamics and multiphase flow field is yet to be fully understood in the present work a three dimensional numerical model of six degrees of freedom dof based on the shear stress transport sst k ω eddy viscosity model was established to capture the complicated characteristics of the vertical water entry of an inclined cylinder at various entry velocities a volume of fluid method for tracking air water interface and a combined dynamic fluid body interaction and overlapping grid technology were used to simulate the complex motion the numerical model with laminar and turbulent model was verified against the published experimental data of cavity evolution and motion characteristics a parametric study was conducted to study the translational and rotational characteristics of the structure due to the effect of water entry velocity the investigation revealed the secondary closure phenomenon during the water entry the asymmetrical multiphase flow field showed that its dynamic characteristics change with space and time under the effect of cavity evolution keywords inclined cylinder water entry cavity evolution multiphase flow field vortex structure dynamic characteristics 1 introduction water entry is the structure impacts on free water surface at a certain velocity from the air which is a typical unsteady and cross phase movement with the complex flow phenomenon such as the evolution of cavity and jet flow field structure distribution and load impacting it existed extensively in various engineering fields such as the seaplane landing von karman 1929a b ship slamming faltinsen 1990 torpedo airdrop may 1952 and launching wei et al 2012 airdrop sonar buoy schmidt 1993 and so on the violent impacting dynamics could affect the kinematic characteristics and the safety of the structures therefore the impacting dynamics should be considered in the water entry mechanism of various types of structures under different working conditions in accordance to the macroscopic physical mechanism of entry cavities highlighted by truscott et al 2014 the entry process could be divided into the water entry with air cavity at low speed water entry with super cavitation at high speed and water entry with leidenfrost effect of hot structural surface reference to the research work of enriquez et al 2012 marston et al 2016 wei and hu 2015 the cavity evolution for water entry of the disk the sphere and the cylinder can be seen in fig 1 the experimental study of water entry initiated at the end of 19th century worthington et al 1897 1908 analyzed the influential factors on the shape evolution process of cavity and splash for vertical water entry of rigid sphere using a single flash camera with the development of particle imaging and high speed camera technology the experimental method could accurately record the complicated flow phenomena in the water entry process considering the various geometrical shapes of the structures the water entry experiments of horizontal cylinders spheres and asymmetric wedges were carried out respectively wei and hu 2014 aristoff et al 2008 shams et al 2015 for the research on surface wettability of various structures the effect of hydrophobicity on the evolution of cavity for water entry of cylinder and sphere was examined ueda y and iguchi m 2012 korkmaz and guzel 2017 aristoff and bush 2009 additionally the water entry problems of various structures under different conditions were also extensively investigated through the experimental method such as the air flow in a collapsing cavity by peters et al 2013 the buckling instability during water entry of spheres by marston et al 2016 the fluid structure interaction during water entry of flexible cylinders by panciroli et al 2015 and the motion of a falling circular cylinder in flows after water entry by lyu et al 2015 apart from the experimental method the theoretical approach was also developed to study the mechanism of complex physical phenomena during the entry process for the theoretical model of the impact load conducted by von karman 1929 the entry process was limited to the elastic collision and the impact load was computed based on the law of conservation of momentum the further study of wagner 1932 for solving the same water entry problem however linearized the free surface boundary conditions the bernoulli equation and the load distribution of impacting surface were derived based on the approximate plate theory on this basis a series of algorithms were widely developed for the theoretical model of the evolution of the cavity logvinovich 1969 proposed the principle of independent cavitation expansion for the first time based on the law of energy conservation to predict the cavity evolution since then the time varying laws of cavity were widely developed based on the theory of potential flow such as the study of the axisymmetric bubble pinch off at high reynolds numbers by gordillo et al 2005 however as the theoretical methods were mostly semi empirical formulas based on the experimental results and mathematical models with assumptions to simplify the water entry process it would be difficult to accurately describe the water entry problems under complex conditions the development of advanced computer imaging technology and computational fluid dynamics enabled the numerical simulation method to accurately capture the global dynamic characteristics and complex flow phenomena that were difficult to obtain in the experiments this development based on the computational technology effectively supplemented the data measured from the experiments the water entry of a free wedge was investigated based on the single fluid numerical model two fluid bem and theoretical models and the results showed the evolution of the pressure the global hydrodynamic loads the air water interface and the wedge motion wang et al 2015a 2015b the unsteady hydrodynamic force of solid objects vertically entering water with an air cavity behind the falling body was investigated and physical models were proposed to represent the force components corresponding to the body acceleration the gravity and the velocity of the body and the fluid particles wang et al 2019 for the correction of numerical algorithms an improved r factor algorithm for implementing total variation diminishing tvd scheme has been proposed and numerical results indicate that the proposed algorithm schemes can avoid the numerical oscillation and reduce the numerical diffusion effectively zhang et al 2020 and a two dimensional fluid structure interaction fsi model has been proposed by coupling sph with smoothed point interpolation method s pim to enhance the performance of mesh distortion insensitivity for large deformation zhang et al 2019 the correction of the algorithm helps to simulate the water entry problem further accurately the coupling between the turbulence models and the reynolds average navier stokes rans which generated the n s equations on time average was one of the method of numerical simulation for solving the water entry problems quan and hua 2008 carried out a numerical simulation to study the formation development necking and closure of the cavity and the results showed that the closure time was proportional to the surface tension and liquid viscosity and not the air density kintea et al 2016 simulated the free water surface based on the volume of fraction vof method for the study of water entry of a rotating sphere with different impact angles iranmanesh and passandiedeh 2017 established a three dimensional numerical model to simulate the water entry of horizontal cylinder at a low froude number the effect of length and diameter of cylinder impact velocity and density on the cavity was investigated further many researchers also carried out numerical simulations of water entry problems through the rans method some of the past research work included the numerical simulation of cylinder water entry of the influence of atmospheric pressure on water cavity formed of by wang et al 2012 the experimental and numerical study of super cavity influenced by turbulent drag reducing additives by jiang and li 2015 and the modeling and numerical simulation of the forces acting on a sphere during early water entry by abraham et al 2014 currently a large number of experiments and numerical simulations had been conducted to study the shape evolution of the cavity and motion characteristics of structures entering water however there were only a few cases related to the velocity characteristics of fluid particles and the evolution of vortex structures especially so for the vertical water entry of cylinder with inclined angles the novelty of this paper is that the secondary closure phenomenon including the surface closure and deep closure of the cavity occurs at a higher entry speed which is completely different from cavity evolution for water entry at a low speed in addition the complicated evolution of the vortices including rotation direction movement fusion and separation are studied after a comprehensive analysis of the velocity field and q value in this paper the vof method was used to capture the shape evolution of air water interface a combined dynamic fluid body interaction dfbi and overlapping grid techniques was adopted to define the large displacement motion of cylinder a three dimensional numerical model of six degree of freedom was built to simulate the vertical water entry of cylinder with an inclined angle fixed at 78 4 and the initial velocity v 0 of 3 05 m s 6 10 m s and 9 15 m s which was established based on the reynolds time averaged s s t k ω two equation turbulence model to provide solutions from the n s equation and the coupling of euler multiphase flow model the cavity dynamics the multi phase flow characteristics which included the pressure and velocity field and multi scale vortex structure and the unsteady changes of motion parameters with time were analyzed to examine in detail the entry mechanical mechanism of various structures and explore the engineering application 2 numerical methodology 2 1 governing equations the water entry process involves the air water two phase flow and there is no change of phase and penetration in the working environment of low entry velocity and normal temperature based on the homogeneous flow theory specified by brennen 2009 the transport of the heat and momentum at the air water interface is assumed instantaneous and no relative slip continuity equation 1 ρ t ρ u i x i 0 where ρ is the fluid density and u i is the velocity component i 1 2 3 in the cartesian coordinate system momentum conservation equation 2 ρ u i t ρ u i u j x j p x i τ i j x i s where p is the flow field pressure s is a user defined source item τ i j is the viscous shear stress with expression as follows 3 τ i j μ u i x j u j x i 2 3 δ i j u k x k where μ is the mixture dynamic viscosity and δ i j 1 i j 0 i j is the kronecker symbol 2 2 vof model the volume of fluid vof model is a simplified multiphase model suitable to simulate the flows of several immiscible fluids on numerical grids and is capable of resolving interfaces between various phases for the air liquid two phase flow problem the volume fraction of liquid phase is α l and the volume fraction of air phase is α a 1 α l α l 0 and α l 1 indicates that the cell is completely void in phase liquid and filled in phase air respectively 0 α l 1 shows the values between the two limits which indicates the presence of interface between phases an example of α l 0 5 can represent the liquid liquid free surface the material properties of the phases that are calculated in the cells containing the interfaces of constituent fluids the fluids that are presented in the containing cells of the same interface are treated as a mixture as follows 4 ρ ρ l α l ρ a α a 5 μ μ l α l μ a α a where ρ l and ρ a are the densities and μ l and μ a are the dynamic viscosities of the liquid and air phase respectively 2 3 turbulence model turbulence is a highly nonlinear flow state with distinct random characteristics which is composed of vortex structures of various scales and the direct solution from n s equation requires extremely high grid scale and time step that is difficult to achieve however the rans is a time averaged n s equation to obtain a time average equation with reynolds stress subsequently the equation is solved based on the relationship between the reynolds stress and the time averaged physical quantity established in the turbulence model 6 ρ u i t ρ u i u j x j p x i x j τ i j ρ u i u j s where ρ u i u j is defined as reynolds stresses the boussinesq hypothesis 7 ρ u i u j τ i j t p t δ i j μ t u i x j u j x i 2 3 μ t δ i j d i v v where μ t is the turbulent viscosity coefficient the number of variables in governing equation increases in time averaging process in the current study the s s t k ω model is used 8 μ t ρ k t where t is the turbulent time scale the transport equation for turbulent kinetic energy and turbulent dissipation rate 9 t ρ k ρ k v μ σ k μ t k p k ρ β f β ω k ω 0 k 0 s k 10 t ρ ω ρ ω v μ σ ω μ t ω p ω ρ β f β ω 2 ω 0 2 s ω where k and ω are the turbulent energy and turbulent dissipation rate respectively s k and s ω are the user specific source items in different situations f β and f β are the respective free shear and eddy current stretching correction factors p k and p ω are the respective parameter taking into account the turbulence and buoyancy and unit and cross dissipation σ k and σ ω are the coefficient associated with the mixing function f 1 2 4 numerical model in the present work the commercial computational fluid dynamics cfd software star ccm 11 02 009 was used to carry out the simulation and a three dimensional numerical model for vertical water entry of the cylinder with the entry velocity of v 0 3 05 m s 6 1 m s 9 15 m s and the inclined angle of 78 4 was created as can be seen in fig 2 the geometrical dimension of the computational domain is 30 d 16 d 36 d the x y and z axes in the fixed coordinate system and the inclined angle of cylinder are indicated in the figure the height diameter and density of the cylinder were l 0 2 m d 50 m m and ρ 0 9 ρ l respectively where ρ l the density of liquid phase the froude number of f r v 0 d g 4 35 13 06 was a similarity criterion that characterized the relationship between the fluid inertial resistance and the gravity and the initial impacting moment was set as time zero the inlet velocity and the outlet pressure were defined as the static water field function and p ρ g h respectively all the grids were generated by a hexahedral structured mesh generator coupled with automatic surface repair and reconstruction a grid convergence study of the grid size has been studied for five different grid levels i e 4 96 million 5 30 million 5 68 million 6 05 million and 6 40 million time histories of the vertical and horizontal velocities and vertical displacement for water entry of the cylinder are given in fig 3 it can be seen that the results from different grid levels agree well with each other which verifies the independence of the grid in order to accurately capture the flow field characteristics and save simulation time and cost a total mesh size of 5 30 million was used in the model for future simulations a wall treatment of the non dimensional wall distance y was used to define the range of sub layer and the prism layer of the cylinder wall was set to eight layers to capture the flow characteristics at wall surface in order to meet the requirement of complex motion a combined overlapping mesh approach and dynamic fluid interaction dfbi were utilized to measure the six degree of freedom motion of cylinder during the entire entry process a gradual transition multi layer mesh size was considered in the regions of overlapping free surface and trajectory which could improve the mesh quality to better capture the evolution of cavities and jets and the structural characteristics of multiphase flow fields the grid size at the intersection of the overlapping and the computational domain was remained constant a linear interpolation method was adopted between the two entities to ensure the information transmission and to realize the accurate simulation of complex entry motion additionally the mesh was rotated at an initial angle to account for the water entry of cylinder with inclined angle of 78 4 deg and the mesh density of the computational domain and the overlapping is shown in fig 4 the current calculation for vertical water entry of inclined cylinder was simulated based on the finite volume method fvm the vof method was set to capture the evolution of air water interface the convection term of separation flow adopted the second order upwind scheme the coupling effect of pressure and velocity was solved based on simple algorithm and the rate of convergence could be accelerated by using the algebraic multi grid amg linear solver the reason was that the conjugate gradient method and the linear equations based on gauss seidel method for solving iteratively was activated the implicit unsteady model was the only unsteady model available with the segregated flow and segregated fluid energy models the discretized grid flux was of second order in order to improve the accuracy of numerical simulation and to ensure the temporal space of rans result the time was implicitly second order scheme and the step was set at 5 10 5 s 3 results and discussion 3 1 validation of numerical model the numerical method with turbulent model for water entry of cylinder was verified against the experimental data of cavity shape evolution and motion characteristics published by wei and hu 2015 a comparison of results of the experiments and the numerical simulation with turbulent model is shown in fig 5 in the previous experiment a high speed camera was used to record the cylinder position and cavity evolution at various times in the current numerical simulation the position of cylinder was recorded by the three direction displacement of dfbi in 6 dof the evolution of cavity shape was captured by the water volume fraction iso surface at v o f 0 5 as is shown in fig 5 a comparison of the experimental and the numerical simulation results showed that the cylinder position relative to the water surface and cavity at various time steps and the formation necking closure and collapse of the cavity were in reasonable agreements the results of the numerical simulation could also be verified qualitatively based on the comparison of velocity translation characteristics and angle rotation characteristics between experiment and numerical simulation with turbulent and laminar model as can be seen in fig 6 the velocity in x and y directions and the angle obtained from the numerical simulation and the experimental results is almost identical with a slightly difference of the velocity in x direction in the mid time steps and the angle in the final time steps one of the possible reasons could be due the effect of surface roughness of the cylinder a comparison of velocity and angle of the vertical water entry of inclined cylinder revealed that the numerical simulation with turbulent and laminar model simulated reasonably well the experiment 3 2 cavity evolution the unsteady characteristics of cavity evolution of vertical water entry of inclined cylinder at velocity v 0 3 05 m s 6 1 m s and 9 15 m s are presented in figs 7 9 respectively the impact of the inclined cylinder on the free water surface transmitted the kinetic energy to the fluid particles around the front end of cylinder which caused the water to move circumferentially in the process of water entry a cavity that filled with air was formed on the trajectory of the cylinder motion then under the effect of surface tension hydrodynamic force and pressure difference between the inside and outside of the cavity the evolution of cavitation undergoes processes such as necking and closing the study on the evolution of cavity shape during the entire entry process was of great significance for analyzing the mechanism and the motion characteristics of the structure the cavity evolution for vertical water entry of inclined cylinder at various velocities is shown as follows as illustrated in figs 7 9 the water entry of inclined cylinder at various velocities showed the evolution mechanism of the cavity which including the formation development closure and collapse whose change at various stages during the entire process was instantaneous and dynamic an initial velocity v 0 6 1 m s was referenced to demonstrate the entire water entry process of inclined cylinder at t 0 01 s the cylinder impacted the water with the formation of initial cavity it can be seen from the top view fig 8c that the contour of cavity on water surface is circular in flow pattern thereafter at t 0 019 0 072 s the cavity continuously elongated as the cylinder fallen completely below the free water surface inside the cavitation both the radius of circular cavity contour at water surface and the influence area of velocity increased with the time steps owing to the inclination the flow pattern at both sides of the cylinder was not identical an arc shaped protrusion gradually occurred at these cavity contours as the fluid particles gained the kinetic energy additionally the inclined angle of the cylinder produced a impacting moment after entering water which gradually increased under the action of counterclockwise coupling moment from the fluid pressure resistance residual resistance buoyancy and structure gravity the evolution of cavity at t 0 097 0 136 s revealed that the collision of its wall occurred in the process of necking and closure of cavity at this stage the diameter of cavitation decreased under the pressure difference between the inside and outside of cavity as well as the surface tension and the necking phenomenon accelerated due to the collision of the wall of cylinder and the cavity which caused the cavity diameter at the tail end of the cylinder decreased and a difference in geometry as a result at t 0 126 0 136 s the cavity closed and collapse the cavity that connected to the free surface performed a funnel like flow pattern a strip splash was formed thereafter and developed an upward motion from the bottom end of the wall which was attached to the bubble at the head of the cylinder it can also be seen from the side elevation view fig 8b that the cylinder does not undergoes lateral displacement and deflection and the shapes of the cavity remain symmetrical for the entire water entry process the longitudinal displacement of the cylinder increased continuously with the initial velocity the torque in counterclockwise direction under the coupling action of various forces caused the rotation angle of cylinder to change the specific performance was that the inclined angle increased slightly at v 0 3 05 m s but it changed greatly at higher velocity and found greater than 90 at v 0 6 1 m s a n d 9 15 m s in another word the rotation angle of the cylinder around the y axis increased with the velocity of water entry the differences of the evolution of cavity and jet could be summarized as follows a since the inclination of cylinder at different entry velocities was at the same angle the water surface area after the cylinder impact was therefore identical however the kinetic energy of the circumferential movement of fluid particles due to water impact increased with the velocity as a result the width and the height of the cavity developed and increased with the fall of the cylinder in concurrent in the early stage of water entry process b as the initial entry velocity increased the development of the jet gradually appeared and moved toward the center to close the cavitation at the free water surface but its height increased continuously under the velocity v 0 9 15 m s the cavity closed at the free surface at t 0 118 s and closed below the free surface at t 0 128 s the increase of the velocity caused the cavity to have a secondary phenomenon of surface and deep closure and its length on the closed face side increased gradually the diameter and the length of the strip like splash increased with the initial entry velocity developing an upward movement from the bottom after the cavity was closed this process resulted on the delay of collapse time c at initial velocity v 0 3 05 m s and 6 1 m s the cavitation closed only under the free water surface this was defined as the deep closed mode and the corresponding closure time was found to be t 0 147 s and t 0 126 s respectively as the cavity collapse the upper cavitation presented an opening irregular funnel shape as the initial velocity to v 0 9 15 m s the surface and the deep closure time of cavity were t 0 118 s and t 0 128 s respectively for a single deep closed mode of the cavity the closure time delayed as the entry velocity increased for the secondary closure mode two closures occurred one after another the second closure caused a closed ellipsoid bubble formed at the upper cavitation which this phenomenon was differed from the other two conditions 3 3 evolution characteristics of multiphase flow field during the entire entry process of the cylinder the effect of instantaneous impact and cavity closure caused a dramatic change with complex behavior in local flow field owing to the similarity in the multi phase flow of various working condition the evolution characteristics of the vertical water entry of inclined cylinder at velocity v 0 6 1 m s was studied the dynamic change of pressure field velocity field and vortex structure were analyzed as follows the evolution characteristics of the multiphase flow field are closely related to the water impact and cavity evolution the impact transfers the kinetic energy between the cylinder and the fluid which affects the pressure and velocity distribution and the motion response of the structure the elongation and necking of the cavity could cause the air to enter and exit respectively which would further affect the change of the flow field characteristics in the whole process of water entry the vortices dominated by shearing and rotation effects also continues to evolve the phenomenon is the result of various factors and the mechanical mechanism 3 3 1 pressure field the pressure distribution for the moment the inclined cylinder enters the water is shown in figs 10 and 11 in the present work the relative pressure which was the difference between the absolute and the atmospheric pressure was used to characterize the fluid pressure distribution in different spatial regions the flow field structure were analyzed based on the plot of isobar pressure diagram at regular time intervals it can be seen from figs 10 and 11 that the pressure field exhibits a dynamic unsteady change of flow field with water entry of cylinder at the initial stage a high pressure formed at the front end of cylinder due to the impact on water the maximum pressure in the high pressure zone decreased as the time increased and the low pressure zone mainly appeared on both sides of the cylinder at these locations the distribution of pressure was asymmetrical under the effect of the initial angle prior to the closure stage of cavity the isobaric lines basically gather to the left and right bottom of the cylinder further it was observed after t 0 03 s that the rotation of cylinder in anticlockwise direction caused the right side wall collided with the cavity wall this was highlighted in the figure as the right isostatic lines gather at the collision position the pressure at the tail end of cylinder always in a low pressure state however it increased slightly with the continuous opening and development of cavitation which the air flow inside at the closure of cavity the air discharge was under the influence of rapidly decreasing cavitation diameter a local annular region of high pressure was thus formed at the closure position behind the cylinder 3 3 2 velocity field in the present work a combined velocity scalar contour and vector was adopted to characterize the distribution of velocity field this approach could effectively be used to analyze the mechanism and dynamic changes in vortices structure and cavity evolution the distribution of velocity field for vertical water entry of inclined cylinder is shown in fig 12 the black outlines and the letter marks in the figure represent the cavity contours and the vortex core respectively it can be seen from fig 12 that the velocity field exhibits a dynamic unsteady change with evolution of cavity at the initial stage t 0 01 s the splash on the free surface were formed as the cylinder entering water then the air entry as the cavitation developed and a high velocity region at the tail end of the cylinder with splash development and cavitation formation developed as the air entered on the left side of cavity the velocity influence region in this location became larger and thus the high velocity was more visible at t 0 03 0 07 s the cavity developed and elongated the high velocity region due to a large proportion of outside air entry is indicated as symbol 1 as shown in fig 12 this phenomenon of large scale high velocity area on the rear side of cylinder was caused by the inclined entry angle of cylinder additionally it could be seen from the velocity scalar contour at this stage that the maximum velocity occurred caused by the air entry was a strip shaped region next to the wall of cavitation which was the parallel velocity direction of fluid particles as the depth of the cylinder entry increased the velocity influence region gradually expanding until the cavity closure above the water surface following the continuous evolution of cavity and jetting the reason for this phenomenon was that the jetting evolution in the free surface was due to the required of fluid energy during the impact of cylinder on water the energy affected the evolution of velocity region and resulted in a far field air flow at t 0 11 s the air was discharged from the cavitation under the action of necking a high velocity region near the closure of cavity was developed the air discharge to the upper region above the free surface also affected the evolution of velocity influence region after the closure at t 0 13 s a high velocity region formed at the air discharge location at this stage a strip region of high velocity developed as the strip splashed upward by the bottom of the cylinder at its left side wall surface 3 3 3 vortex structure a vortex was a group of fluid particles rotated about a common center which was defined as the rotating fluid of a finite volume bounded by a potential or object plane by huang et al 2014 during the entire entry process of cylinder the multi scale vortices were generated in the entire flow field including the free surface the motion path and the cavity the current study is based on the velocity field characteristics as shown in fig 12 the second invariant of the velocity gradient tensor q proposed by hunt et al 1988 was used to describe the vortex structure as follows 11 q 1 2 w 2 s 2 1 2 u i x j u j x i q 0 v o r t i c i t y d o m i n a n t q 0 s t r a i n d o m i n a n t where w 1 2 u i x j u j x i and s 1 2 u i x j u j x i were the rotation tensor of filtered flow and the symmetric strain rate tensor respectively the criterion defined the vortex core as the region of invariant q 0 the invariant q was the difference between the square of the vorticity and that of the shear deformation rate as defined by haller 2005 the distribution of q value of the vortex in symmetry plane for the vertical water entry of inclined cylinder is depicted in fig 13 the dynamic change of vortices including their formation motion rotation mergence separation and dissipation generated in the process of water entry and the variation with time were a complicated mechanism and the following analysis is carried out from the aspects of dynamic characteristics of vortices and dynamic evolution of vortices in two pairs based on the movement of fluid particles in the velocity field and the evolution of the q value a dynamic characteristics of vortices the region surrounded by the vortex of negative q value appeared in the surrounding position of cylinder cavity and jetting at the initial entry stage the second invariant of velocity gradient tensor q of flat thin curved region indicated as f in the front end of cylinder remained a negative value during the entire process this flow mechanism revealed that the vortices in the boundary and the front end of cylinder were dominated by the effect of shear the continuous development of cavity resulted in a complex and a fragmentary in the region of positive and negative alternating q value on the development of cavity this indicated that the formation of cavitation was primarily dominated by a combined effect of rotational and shear the distribution of vortex q value during the entire entry process was asymmetrical under the influence of the inclined angle of cylinder and that above the free surface the vortices gradually dissipated with the cavity evolution the rotational effect of vortices relatively to axial deformation of fluid micro elements in the complex eigenvector plane seemed to be weakened the vortices at the cavity closure and the region next to wall indicated as e in the figure showed a negative q value this indicated that the vortices in this region was primarily dominated by the effect of shear the q value of vortices below the free surface distributed almost entirely inside the cavitation and next to the cylinder the vortices presented a tendency to develop above the water surface with the cavity closure b dynamic evolution of vortices in two pairs the fluid particle at the front end of cylinder moving around under the influence of kinetic energy generated during the water impact the pressure and velocity gradients at cavity formation were large vortices continuously forming merging separating and developing with cavity evolution in the current study the evolution of vortices in two pairs a and b c and d in the entry process was selected to examine the mechanism of the velocity field as can be seen from figs 12 and 13 at t 0 01 s the two pair vortices of positive q value a and b c and d appeared at the velocity gradient position next to the rear end of cylinder and the jetting the two pair vortices gradually generated from the free surface to the upper part of cylinder with the extension of velocity influence region after obtaining sufficient energy as the cavity and jetting developed however this velocity influence region gradually diminished as the energy provided by the impact of water entry is limited for the vortex to develop additionally the amount of initial energy obtained by the two pair eddies and their evolution experiencing a great difference in development from fig 13 at t 0 03 s vortex a gradually merges with other vortices as it moves toward the high velocity region in the cavity at this stage the q value of vortices continuously decreased which showed the rotational strength relatively to shear deformation became weakened on the other hand vortex b merged with another vortex on the upper part of cylinder to form vortex b that rotated counterclockwise as velocity influence region extended under the coupling effect of jetting and vortices vortices c and d merged to form vortex cd and was rotated clockwise in a very thin region of negative q value dominated by the effect of shear at t 0 05 s vortex b moved outward leaving the outer contour region dominated by shear it further separated into vortices b1 and b2 rotated in counterclockwise and clockwise direction respectively under the influence of jet elongation vortex cd separated into two new vortices c and d that were rotated in clockwise direction in the velocity gradient region these vortices were wrapped in a semi arc extremely thin region of negative q value dominated by the effect of shear at t 0 07 s the q value of vortices b1 and c gradually approaching zero as the intensity decreased due to the loss of energy from the velocity diagram the fluid particles next to the two vortices moved in parallel vortex d1 at the velocity gradient moved toward the high velocity region in the cavity then it merged with other vortices to continue evolve at t 0 09 0 11 s the q value of vortex b2 gradually approaching zero after being separated into two small vortices in other words the vortices underwent complex dynamic processes which including the movement mergence separation and dissipation the region of the positive and negative alternating q value in the cavity was complex and fragmentary 3 4 entry velocity on dynamic characteristics in this section the difference of the motion characteristics for vertical water entry of inclined cylinder at various entry velocities was investigated the time history of the vertical acceleration velocity and displacement as well as the angular acceleration angular velocity and inclined angle under different working conditions were presented to examine the impact on the translational and rotational characteristics in the study the vertical l1 and the horizontal l2 displacement were referenced to the height of cylinder the simulation results of the time histories of various motion parameters for cylinder water entry at velocities v 0 3 05 m s 6 1 m s 9 15 m s are shown in figs 14 17 it can be seen from figs 14 and 15 that the entry velocity could have significant influence on the translational characteristics of the cylinder entry the time histories of the acceleration velocity and displacement under the three 3 entry velocities remained identical under the impact of the cylinder on the water in the initial entry stage an abrupt change of acceleration in z axis was specifically noted the impact surface area on water remained constant due to the same entry angle of inclined cylinder the acceleration increased instantaneously with the entry velocity however at the final entry stage the acceleration was first increased but then decreased followed by various degrees of fluctuation under the effect of cavity closure and collapse during the entire entry process the impact force was actually found larger due to the higher entry velocity considering the coupling of various forces from the fluid viscosity residual resistance buoyancy and gravity the opposite direction of acceleration always reduced the velocity under different working conditions and the rate of change of acceleration gradually increased with the entry velocity the rate of change of displacement in z axis decreased at various entry velocities as the inclined cylinder entering the water vertically a horizontal displacement induced and increased with entry velocity due to horizontal component forces the horizontal displacement at various entry velocities varies with time prior to the time step t 0 10 0 103 s the horizontal displacement l2 generated from the water entry at velocities v 0 3 05 m s 6 1 m s 9 15 m s increased continuously thereafter it decreased and remained constant as illustrated in figs 7 9 the counterclockwise rotation of cylinder about y axis immediately occurred after the cylinder entering water at velocities v 0 3 05 m s 6 1 m s 9 15 m s the initial entry velocity could have a significant influence on the rotation characteristics of the inclined cylinder in the initial entry stage where the impact force did not pass through the centroid of the cylinder a rotational moment occurred the cylinder also rotated about its y axis at different degrees due to the moments generated from the fluid viscosity residual resistance buoyancy and gravity as can be seen in figs 16 and 17 the initial angular acceleration change instantaneously from negative to positive values and eventually stabilized with time during the stage of cavity closure at t 0 12 s the angular acceleration fluctuated and oscillated at various degrees under the entry velocities of v 0 3 05 m s 6 1 m s 9 15 m s the dynamic change of angular velocity and rotational angle could be assessed through the formulation ω y a θ y d t and θ y ω y d t respectively the angular velocity constantly increased after the initial entry stage of the fluctuation the cylinder rotated counterclockwise about its y axis with increasing rotation from the figure the angular velocity decreased at t 0 t 1 and t 2 at the entry velocity v 0 3 05 m s the angular velocity was first increased in negative but decreased in positive value at t 5 in other words the cylinder was first rotated counterclockwise with decreasing speed and then changes to clockwise rotation motion with increasing speed during the period t 5 t 7 the angular velocity for the water entry of inclined cylinder at v 0 6 1 m s and 9 15 m s was first decreased but increased after during the period of t 1 t 3 and t 2 t 4 respectively however it decreased continuously after t 3 and t 4 the motion of cylinder at this time was counterclockwise rotation and the change of rotational speed remained constant the cylinder at entry velocity v 0 6 1 m s after t 6 change to clockwise rotation with reduced rotational angle however the cylinder at entry velocity v 0 9 15 m s always rotated counterclockwise with increasing rotational angle and exceeded 90 eventually 4 conclusions in this paper the vertical water entry of cylinder at various entry velocities and entry angle of 78 4 deg is studied through the numerical investigation and the numerical model with laminar and turbulent model is verified against the published experimental data it can be concluded from the numerical study that 1 the rotation of cylinder increases with entry velocity the ellipsoidal cavity in secondary deep and surface closure occurs at higher velocity at the moment of cavity collapse the strip shaped splash increases continuously for certain time 2 a a high and low pressure region is located in the front and tail ends of the cylinder the high pressure region occurs at closure position after the air discharges from cavitation b a high velocity region is located next to the cylinder a large scale high velocity region is first occurred at the side of the cylinder and then gradually expands until the far field airflow is formed finally the high velocity region with largest velocity in closure position developed it is noted that a strip jet appears in a strip shaped high velocity region c the unsteady change of vortex structure is closely related to the cavity evolution and the region of positive and negative alternating q value in cavitation a flat thin layer of arc shaped region at the front end of cylinder is dominated by the effect of shear however the strength of q value above the free water surface weakens continuously where the closure position of cavity is dominated by vortices with shear effect the vortices in the region of velocity gradients always formed and undergo a dynamic complex flow mechanism 3 the vertical acceleration in the stage of impacting and the cavity closure exhibits a nonlinear abrupt change and fluctuation and the rate of change of vertical displacement decreases continuously however the displacement of cylinder in lateral direction increases first then shows a trend of decreasing constant and increasing after t 0 respectively with the increase in entry velocity the rotational angle of cylinder increases with entry velocity note that there is a shift of rotation motion of cylinder from the counterclockwise to the clockwise rotation with the change of angular velocity credit authorship contribution statement hui liu data curation software writing original draft bo zhou conceptualization methodology software xiaoshuang han supervision validation teng zhang investigation beike zhou visualization wie min gho writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the liaoning revitalization talents program grant number xlyc1807190 xlyc1908027 the liaoning provincial natural science foundation guidance project grant number 20180550186 the open project funding of state key laboratory of coastal and offshore engineering dalian university of technology grant number lp1906 and the fundamental research funds for the central universities dut20td108 
21566,water entry of cylindrical structures is a complex multiphase flow problem involving a three phase medium interaction that occurs instantaneously it is a nonlinear and unsteady process which the physical understanding of mechanism in the aspect of evolution of cavity dynamics and multiphase flow field is yet to be fully understood in the present work a three dimensional numerical model of six degrees of freedom dof based on the shear stress transport sst k ω eddy viscosity model was established to capture the complicated characteristics of the vertical water entry of an inclined cylinder at various entry velocities a volume of fluid method for tracking air water interface and a combined dynamic fluid body interaction and overlapping grid technology were used to simulate the complex motion the numerical model with laminar and turbulent model was verified against the published experimental data of cavity evolution and motion characteristics a parametric study was conducted to study the translational and rotational characteristics of the structure due to the effect of water entry velocity the investigation revealed the secondary closure phenomenon during the water entry the asymmetrical multiphase flow field showed that its dynamic characteristics change with space and time under the effect of cavity evolution keywords inclined cylinder water entry cavity evolution multiphase flow field vortex structure dynamic characteristics 1 introduction water entry is the structure impacts on free water surface at a certain velocity from the air which is a typical unsteady and cross phase movement with the complex flow phenomenon such as the evolution of cavity and jet flow field structure distribution and load impacting it existed extensively in various engineering fields such as the seaplane landing von karman 1929a b ship slamming faltinsen 1990 torpedo airdrop may 1952 and launching wei et al 2012 airdrop sonar buoy schmidt 1993 and so on the violent impacting dynamics could affect the kinematic characteristics and the safety of the structures therefore the impacting dynamics should be considered in the water entry mechanism of various types of structures under different working conditions in accordance to the macroscopic physical mechanism of entry cavities highlighted by truscott et al 2014 the entry process could be divided into the water entry with air cavity at low speed water entry with super cavitation at high speed and water entry with leidenfrost effect of hot structural surface reference to the research work of enriquez et al 2012 marston et al 2016 wei and hu 2015 the cavity evolution for water entry of the disk the sphere and the cylinder can be seen in fig 1 the experimental study of water entry initiated at the end of 19th century worthington et al 1897 1908 analyzed the influential factors on the shape evolution process of cavity and splash for vertical water entry of rigid sphere using a single flash camera with the development of particle imaging and high speed camera technology the experimental method could accurately record the complicated flow phenomena in the water entry process considering the various geometrical shapes of the structures the water entry experiments of horizontal cylinders spheres and asymmetric wedges were carried out respectively wei and hu 2014 aristoff et al 2008 shams et al 2015 for the research on surface wettability of various structures the effect of hydrophobicity on the evolution of cavity for water entry of cylinder and sphere was examined ueda y and iguchi m 2012 korkmaz and guzel 2017 aristoff and bush 2009 additionally the water entry problems of various structures under different conditions were also extensively investigated through the experimental method such as the air flow in a collapsing cavity by peters et al 2013 the buckling instability during water entry of spheres by marston et al 2016 the fluid structure interaction during water entry of flexible cylinders by panciroli et al 2015 and the motion of a falling circular cylinder in flows after water entry by lyu et al 2015 apart from the experimental method the theoretical approach was also developed to study the mechanism of complex physical phenomena during the entry process for the theoretical model of the impact load conducted by von karman 1929 the entry process was limited to the elastic collision and the impact load was computed based on the law of conservation of momentum the further study of wagner 1932 for solving the same water entry problem however linearized the free surface boundary conditions the bernoulli equation and the load distribution of impacting surface were derived based on the approximate plate theory on this basis a series of algorithms were widely developed for the theoretical model of the evolution of the cavity logvinovich 1969 proposed the principle of independent cavitation expansion for the first time based on the law of energy conservation to predict the cavity evolution since then the time varying laws of cavity were widely developed based on the theory of potential flow such as the study of the axisymmetric bubble pinch off at high reynolds numbers by gordillo et al 2005 however as the theoretical methods were mostly semi empirical formulas based on the experimental results and mathematical models with assumptions to simplify the water entry process it would be difficult to accurately describe the water entry problems under complex conditions the development of advanced computer imaging technology and computational fluid dynamics enabled the numerical simulation method to accurately capture the global dynamic characteristics and complex flow phenomena that were difficult to obtain in the experiments this development based on the computational technology effectively supplemented the data measured from the experiments the water entry of a free wedge was investigated based on the single fluid numerical model two fluid bem and theoretical models and the results showed the evolution of the pressure the global hydrodynamic loads the air water interface and the wedge motion wang et al 2015a 2015b the unsteady hydrodynamic force of solid objects vertically entering water with an air cavity behind the falling body was investigated and physical models were proposed to represent the force components corresponding to the body acceleration the gravity and the velocity of the body and the fluid particles wang et al 2019 for the correction of numerical algorithms an improved r factor algorithm for implementing total variation diminishing tvd scheme has been proposed and numerical results indicate that the proposed algorithm schemes can avoid the numerical oscillation and reduce the numerical diffusion effectively zhang et al 2020 and a two dimensional fluid structure interaction fsi model has been proposed by coupling sph with smoothed point interpolation method s pim to enhance the performance of mesh distortion insensitivity for large deformation zhang et al 2019 the correction of the algorithm helps to simulate the water entry problem further accurately the coupling between the turbulence models and the reynolds average navier stokes rans which generated the n s equations on time average was one of the method of numerical simulation for solving the water entry problems quan and hua 2008 carried out a numerical simulation to study the formation development necking and closure of the cavity and the results showed that the closure time was proportional to the surface tension and liquid viscosity and not the air density kintea et al 2016 simulated the free water surface based on the volume of fraction vof method for the study of water entry of a rotating sphere with different impact angles iranmanesh and passandiedeh 2017 established a three dimensional numerical model to simulate the water entry of horizontal cylinder at a low froude number the effect of length and diameter of cylinder impact velocity and density on the cavity was investigated further many researchers also carried out numerical simulations of water entry problems through the rans method some of the past research work included the numerical simulation of cylinder water entry of the influence of atmospheric pressure on water cavity formed of by wang et al 2012 the experimental and numerical study of super cavity influenced by turbulent drag reducing additives by jiang and li 2015 and the modeling and numerical simulation of the forces acting on a sphere during early water entry by abraham et al 2014 currently a large number of experiments and numerical simulations had been conducted to study the shape evolution of the cavity and motion characteristics of structures entering water however there were only a few cases related to the velocity characteristics of fluid particles and the evolution of vortex structures especially so for the vertical water entry of cylinder with inclined angles the novelty of this paper is that the secondary closure phenomenon including the surface closure and deep closure of the cavity occurs at a higher entry speed which is completely different from cavity evolution for water entry at a low speed in addition the complicated evolution of the vortices including rotation direction movement fusion and separation are studied after a comprehensive analysis of the velocity field and q value in this paper the vof method was used to capture the shape evolution of air water interface a combined dynamic fluid body interaction dfbi and overlapping grid techniques was adopted to define the large displacement motion of cylinder a three dimensional numerical model of six degree of freedom was built to simulate the vertical water entry of cylinder with an inclined angle fixed at 78 4 and the initial velocity v 0 of 3 05 m s 6 10 m s and 9 15 m s which was established based on the reynolds time averaged s s t k ω two equation turbulence model to provide solutions from the n s equation and the coupling of euler multiphase flow model the cavity dynamics the multi phase flow characteristics which included the pressure and velocity field and multi scale vortex structure and the unsteady changes of motion parameters with time were analyzed to examine in detail the entry mechanical mechanism of various structures and explore the engineering application 2 numerical methodology 2 1 governing equations the water entry process involves the air water two phase flow and there is no change of phase and penetration in the working environment of low entry velocity and normal temperature based on the homogeneous flow theory specified by brennen 2009 the transport of the heat and momentum at the air water interface is assumed instantaneous and no relative slip continuity equation 1 ρ t ρ u i x i 0 where ρ is the fluid density and u i is the velocity component i 1 2 3 in the cartesian coordinate system momentum conservation equation 2 ρ u i t ρ u i u j x j p x i τ i j x i s where p is the flow field pressure s is a user defined source item τ i j is the viscous shear stress with expression as follows 3 τ i j μ u i x j u j x i 2 3 δ i j u k x k where μ is the mixture dynamic viscosity and δ i j 1 i j 0 i j is the kronecker symbol 2 2 vof model the volume of fluid vof model is a simplified multiphase model suitable to simulate the flows of several immiscible fluids on numerical grids and is capable of resolving interfaces between various phases for the air liquid two phase flow problem the volume fraction of liquid phase is α l and the volume fraction of air phase is α a 1 α l α l 0 and α l 1 indicates that the cell is completely void in phase liquid and filled in phase air respectively 0 α l 1 shows the values between the two limits which indicates the presence of interface between phases an example of α l 0 5 can represent the liquid liquid free surface the material properties of the phases that are calculated in the cells containing the interfaces of constituent fluids the fluids that are presented in the containing cells of the same interface are treated as a mixture as follows 4 ρ ρ l α l ρ a α a 5 μ μ l α l μ a α a where ρ l and ρ a are the densities and μ l and μ a are the dynamic viscosities of the liquid and air phase respectively 2 3 turbulence model turbulence is a highly nonlinear flow state with distinct random characteristics which is composed of vortex structures of various scales and the direct solution from n s equation requires extremely high grid scale and time step that is difficult to achieve however the rans is a time averaged n s equation to obtain a time average equation with reynolds stress subsequently the equation is solved based on the relationship between the reynolds stress and the time averaged physical quantity established in the turbulence model 6 ρ u i t ρ u i u j x j p x i x j τ i j ρ u i u j s where ρ u i u j is defined as reynolds stresses the boussinesq hypothesis 7 ρ u i u j τ i j t p t δ i j μ t u i x j u j x i 2 3 μ t δ i j d i v v where μ t is the turbulent viscosity coefficient the number of variables in governing equation increases in time averaging process in the current study the s s t k ω model is used 8 μ t ρ k t where t is the turbulent time scale the transport equation for turbulent kinetic energy and turbulent dissipation rate 9 t ρ k ρ k v μ σ k μ t k p k ρ β f β ω k ω 0 k 0 s k 10 t ρ ω ρ ω v μ σ ω μ t ω p ω ρ β f β ω 2 ω 0 2 s ω where k and ω are the turbulent energy and turbulent dissipation rate respectively s k and s ω are the user specific source items in different situations f β and f β are the respective free shear and eddy current stretching correction factors p k and p ω are the respective parameter taking into account the turbulence and buoyancy and unit and cross dissipation σ k and σ ω are the coefficient associated with the mixing function f 1 2 4 numerical model in the present work the commercial computational fluid dynamics cfd software star ccm 11 02 009 was used to carry out the simulation and a three dimensional numerical model for vertical water entry of the cylinder with the entry velocity of v 0 3 05 m s 6 1 m s 9 15 m s and the inclined angle of 78 4 was created as can be seen in fig 2 the geometrical dimension of the computational domain is 30 d 16 d 36 d the x y and z axes in the fixed coordinate system and the inclined angle of cylinder are indicated in the figure the height diameter and density of the cylinder were l 0 2 m d 50 m m and ρ 0 9 ρ l respectively where ρ l the density of liquid phase the froude number of f r v 0 d g 4 35 13 06 was a similarity criterion that characterized the relationship between the fluid inertial resistance and the gravity and the initial impacting moment was set as time zero the inlet velocity and the outlet pressure were defined as the static water field function and p ρ g h respectively all the grids were generated by a hexahedral structured mesh generator coupled with automatic surface repair and reconstruction a grid convergence study of the grid size has been studied for five different grid levels i e 4 96 million 5 30 million 5 68 million 6 05 million and 6 40 million time histories of the vertical and horizontal velocities and vertical displacement for water entry of the cylinder are given in fig 3 it can be seen that the results from different grid levels agree well with each other which verifies the independence of the grid in order to accurately capture the flow field characteristics and save simulation time and cost a total mesh size of 5 30 million was used in the model for future simulations a wall treatment of the non dimensional wall distance y was used to define the range of sub layer and the prism layer of the cylinder wall was set to eight layers to capture the flow characteristics at wall surface in order to meet the requirement of complex motion a combined overlapping mesh approach and dynamic fluid interaction dfbi were utilized to measure the six degree of freedom motion of cylinder during the entire entry process a gradual transition multi layer mesh size was considered in the regions of overlapping free surface and trajectory which could improve the mesh quality to better capture the evolution of cavities and jets and the structural characteristics of multiphase flow fields the grid size at the intersection of the overlapping and the computational domain was remained constant a linear interpolation method was adopted between the two entities to ensure the information transmission and to realize the accurate simulation of complex entry motion additionally the mesh was rotated at an initial angle to account for the water entry of cylinder with inclined angle of 78 4 deg and the mesh density of the computational domain and the overlapping is shown in fig 4 the current calculation for vertical water entry of inclined cylinder was simulated based on the finite volume method fvm the vof method was set to capture the evolution of air water interface the convection term of separation flow adopted the second order upwind scheme the coupling effect of pressure and velocity was solved based on simple algorithm and the rate of convergence could be accelerated by using the algebraic multi grid amg linear solver the reason was that the conjugate gradient method and the linear equations based on gauss seidel method for solving iteratively was activated the implicit unsteady model was the only unsteady model available with the segregated flow and segregated fluid energy models the discretized grid flux was of second order in order to improve the accuracy of numerical simulation and to ensure the temporal space of rans result the time was implicitly second order scheme and the step was set at 5 10 5 s 3 results and discussion 3 1 validation of numerical model the numerical method with turbulent model for water entry of cylinder was verified against the experimental data of cavity shape evolution and motion characteristics published by wei and hu 2015 a comparison of results of the experiments and the numerical simulation with turbulent model is shown in fig 5 in the previous experiment a high speed camera was used to record the cylinder position and cavity evolution at various times in the current numerical simulation the position of cylinder was recorded by the three direction displacement of dfbi in 6 dof the evolution of cavity shape was captured by the water volume fraction iso surface at v o f 0 5 as is shown in fig 5 a comparison of the experimental and the numerical simulation results showed that the cylinder position relative to the water surface and cavity at various time steps and the formation necking closure and collapse of the cavity were in reasonable agreements the results of the numerical simulation could also be verified qualitatively based on the comparison of velocity translation characteristics and angle rotation characteristics between experiment and numerical simulation with turbulent and laminar model as can be seen in fig 6 the velocity in x and y directions and the angle obtained from the numerical simulation and the experimental results is almost identical with a slightly difference of the velocity in x direction in the mid time steps and the angle in the final time steps one of the possible reasons could be due the effect of surface roughness of the cylinder a comparison of velocity and angle of the vertical water entry of inclined cylinder revealed that the numerical simulation with turbulent and laminar model simulated reasonably well the experiment 3 2 cavity evolution the unsteady characteristics of cavity evolution of vertical water entry of inclined cylinder at velocity v 0 3 05 m s 6 1 m s and 9 15 m s are presented in figs 7 9 respectively the impact of the inclined cylinder on the free water surface transmitted the kinetic energy to the fluid particles around the front end of cylinder which caused the water to move circumferentially in the process of water entry a cavity that filled with air was formed on the trajectory of the cylinder motion then under the effect of surface tension hydrodynamic force and pressure difference between the inside and outside of the cavity the evolution of cavitation undergoes processes such as necking and closing the study on the evolution of cavity shape during the entire entry process was of great significance for analyzing the mechanism and the motion characteristics of the structure the cavity evolution for vertical water entry of inclined cylinder at various velocities is shown as follows as illustrated in figs 7 9 the water entry of inclined cylinder at various velocities showed the evolution mechanism of the cavity which including the formation development closure and collapse whose change at various stages during the entire process was instantaneous and dynamic an initial velocity v 0 6 1 m s was referenced to demonstrate the entire water entry process of inclined cylinder at t 0 01 s the cylinder impacted the water with the formation of initial cavity it can be seen from the top view fig 8c that the contour of cavity on water surface is circular in flow pattern thereafter at t 0 019 0 072 s the cavity continuously elongated as the cylinder fallen completely below the free water surface inside the cavitation both the radius of circular cavity contour at water surface and the influence area of velocity increased with the time steps owing to the inclination the flow pattern at both sides of the cylinder was not identical an arc shaped protrusion gradually occurred at these cavity contours as the fluid particles gained the kinetic energy additionally the inclined angle of the cylinder produced a impacting moment after entering water which gradually increased under the action of counterclockwise coupling moment from the fluid pressure resistance residual resistance buoyancy and structure gravity the evolution of cavity at t 0 097 0 136 s revealed that the collision of its wall occurred in the process of necking and closure of cavity at this stage the diameter of cavitation decreased under the pressure difference between the inside and outside of cavity as well as the surface tension and the necking phenomenon accelerated due to the collision of the wall of cylinder and the cavity which caused the cavity diameter at the tail end of the cylinder decreased and a difference in geometry as a result at t 0 126 0 136 s the cavity closed and collapse the cavity that connected to the free surface performed a funnel like flow pattern a strip splash was formed thereafter and developed an upward motion from the bottom end of the wall which was attached to the bubble at the head of the cylinder it can also be seen from the side elevation view fig 8b that the cylinder does not undergoes lateral displacement and deflection and the shapes of the cavity remain symmetrical for the entire water entry process the longitudinal displacement of the cylinder increased continuously with the initial velocity the torque in counterclockwise direction under the coupling action of various forces caused the rotation angle of cylinder to change the specific performance was that the inclined angle increased slightly at v 0 3 05 m s but it changed greatly at higher velocity and found greater than 90 at v 0 6 1 m s a n d 9 15 m s in another word the rotation angle of the cylinder around the y axis increased with the velocity of water entry the differences of the evolution of cavity and jet could be summarized as follows a since the inclination of cylinder at different entry velocities was at the same angle the water surface area after the cylinder impact was therefore identical however the kinetic energy of the circumferential movement of fluid particles due to water impact increased with the velocity as a result the width and the height of the cavity developed and increased with the fall of the cylinder in concurrent in the early stage of water entry process b as the initial entry velocity increased the development of the jet gradually appeared and moved toward the center to close the cavitation at the free water surface but its height increased continuously under the velocity v 0 9 15 m s the cavity closed at the free surface at t 0 118 s and closed below the free surface at t 0 128 s the increase of the velocity caused the cavity to have a secondary phenomenon of surface and deep closure and its length on the closed face side increased gradually the diameter and the length of the strip like splash increased with the initial entry velocity developing an upward movement from the bottom after the cavity was closed this process resulted on the delay of collapse time c at initial velocity v 0 3 05 m s and 6 1 m s the cavitation closed only under the free water surface this was defined as the deep closed mode and the corresponding closure time was found to be t 0 147 s and t 0 126 s respectively as the cavity collapse the upper cavitation presented an opening irregular funnel shape as the initial velocity to v 0 9 15 m s the surface and the deep closure time of cavity were t 0 118 s and t 0 128 s respectively for a single deep closed mode of the cavity the closure time delayed as the entry velocity increased for the secondary closure mode two closures occurred one after another the second closure caused a closed ellipsoid bubble formed at the upper cavitation which this phenomenon was differed from the other two conditions 3 3 evolution characteristics of multiphase flow field during the entire entry process of the cylinder the effect of instantaneous impact and cavity closure caused a dramatic change with complex behavior in local flow field owing to the similarity in the multi phase flow of various working condition the evolution characteristics of the vertical water entry of inclined cylinder at velocity v 0 6 1 m s was studied the dynamic change of pressure field velocity field and vortex structure were analyzed as follows the evolution characteristics of the multiphase flow field are closely related to the water impact and cavity evolution the impact transfers the kinetic energy between the cylinder and the fluid which affects the pressure and velocity distribution and the motion response of the structure the elongation and necking of the cavity could cause the air to enter and exit respectively which would further affect the change of the flow field characteristics in the whole process of water entry the vortices dominated by shearing and rotation effects also continues to evolve the phenomenon is the result of various factors and the mechanical mechanism 3 3 1 pressure field the pressure distribution for the moment the inclined cylinder enters the water is shown in figs 10 and 11 in the present work the relative pressure which was the difference between the absolute and the atmospheric pressure was used to characterize the fluid pressure distribution in different spatial regions the flow field structure were analyzed based on the plot of isobar pressure diagram at regular time intervals it can be seen from figs 10 and 11 that the pressure field exhibits a dynamic unsteady change of flow field with water entry of cylinder at the initial stage a high pressure formed at the front end of cylinder due to the impact on water the maximum pressure in the high pressure zone decreased as the time increased and the low pressure zone mainly appeared on both sides of the cylinder at these locations the distribution of pressure was asymmetrical under the effect of the initial angle prior to the closure stage of cavity the isobaric lines basically gather to the left and right bottom of the cylinder further it was observed after t 0 03 s that the rotation of cylinder in anticlockwise direction caused the right side wall collided with the cavity wall this was highlighted in the figure as the right isostatic lines gather at the collision position the pressure at the tail end of cylinder always in a low pressure state however it increased slightly with the continuous opening and development of cavitation which the air flow inside at the closure of cavity the air discharge was under the influence of rapidly decreasing cavitation diameter a local annular region of high pressure was thus formed at the closure position behind the cylinder 3 3 2 velocity field in the present work a combined velocity scalar contour and vector was adopted to characterize the distribution of velocity field this approach could effectively be used to analyze the mechanism and dynamic changes in vortices structure and cavity evolution the distribution of velocity field for vertical water entry of inclined cylinder is shown in fig 12 the black outlines and the letter marks in the figure represent the cavity contours and the vortex core respectively it can be seen from fig 12 that the velocity field exhibits a dynamic unsteady change with evolution of cavity at the initial stage t 0 01 s the splash on the free surface were formed as the cylinder entering water then the air entry as the cavitation developed and a high velocity region at the tail end of the cylinder with splash development and cavitation formation developed as the air entered on the left side of cavity the velocity influence region in this location became larger and thus the high velocity was more visible at t 0 03 0 07 s the cavity developed and elongated the high velocity region due to a large proportion of outside air entry is indicated as symbol 1 as shown in fig 12 this phenomenon of large scale high velocity area on the rear side of cylinder was caused by the inclined entry angle of cylinder additionally it could be seen from the velocity scalar contour at this stage that the maximum velocity occurred caused by the air entry was a strip shaped region next to the wall of cavitation which was the parallel velocity direction of fluid particles as the depth of the cylinder entry increased the velocity influence region gradually expanding until the cavity closure above the water surface following the continuous evolution of cavity and jetting the reason for this phenomenon was that the jetting evolution in the free surface was due to the required of fluid energy during the impact of cylinder on water the energy affected the evolution of velocity region and resulted in a far field air flow at t 0 11 s the air was discharged from the cavitation under the action of necking a high velocity region near the closure of cavity was developed the air discharge to the upper region above the free surface also affected the evolution of velocity influence region after the closure at t 0 13 s a high velocity region formed at the air discharge location at this stage a strip region of high velocity developed as the strip splashed upward by the bottom of the cylinder at its left side wall surface 3 3 3 vortex structure a vortex was a group of fluid particles rotated about a common center which was defined as the rotating fluid of a finite volume bounded by a potential or object plane by huang et al 2014 during the entire entry process of cylinder the multi scale vortices were generated in the entire flow field including the free surface the motion path and the cavity the current study is based on the velocity field characteristics as shown in fig 12 the second invariant of the velocity gradient tensor q proposed by hunt et al 1988 was used to describe the vortex structure as follows 11 q 1 2 w 2 s 2 1 2 u i x j u j x i q 0 v o r t i c i t y d o m i n a n t q 0 s t r a i n d o m i n a n t where w 1 2 u i x j u j x i and s 1 2 u i x j u j x i were the rotation tensor of filtered flow and the symmetric strain rate tensor respectively the criterion defined the vortex core as the region of invariant q 0 the invariant q was the difference between the square of the vorticity and that of the shear deformation rate as defined by haller 2005 the distribution of q value of the vortex in symmetry plane for the vertical water entry of inclined cylinder is depicted in fig 13 the dynamic change of vortices including their formation motion rotation mergence separation and dissipation generated in the process of water entry and the variation with time were a complicated mechanism and the following analysis is carried out from the aspects of dynamic characteristics of vortices and dynamic evolution of vortices in two pairs based on the movement of fluid particles in the velocity field and the evolution of the q value a dynamic characteristics of vortices the region surrounded by the vortex of negative q value appeared in the surrounding position of cylinder cavity and jetting at the initial entry stage the second invariant of velocity gradient tensor q of flat thin curved region indicated as f in the front end of cylinder remained a negative value during the entire process this flow mechanism revealed that the vortices in the boundary and the front end of cylinder were dominated by the effect of shear the continuous development of cavity resulted in a complex and a fragmentary in the region of positive and negative alternating q value on the development of cavity this indicated that the formation of cavitation was primarily dominated by a combined effect of rotational and shear the distribution of vortex q value during the entire entry process was asymmetrical under the influence of the inclined angle of cylinder and that above the free surface the vortices gradually dissipated with the cavity evolution the rotational effect of vortices relatively to axial deformation of fluid micro elements in the complex eigenvector plane seemed to be weakened the vortices at the cavity closure and the region next to wall indicated as e in the figure showed a negative q value this indicated that the vortices in this region was primarily dominated by the effect of shear the q value of vortices below the free surface distributed almost entirely inside the cavitation and next to the cylinder the vortices presented a tendency to develop above the water surface with the cavity closure b dynamic evolution of vortices in two pairs the fluid particle at the front end of cylinder moving around under the influence of kinetic energy generated during the water impact the pressure and velocity gradients at cavity formation were large vortices continuously forming merging separating and developing with cavity evolution in the current study the evolution of vortices in two pairs a and b c and d in the entry process was selected to examine the mechanism of the velocity field as can be seen from figs 12 and 13 at t 0 01 s the two pair vortices of positive q value a and b c and d appeared at the velocity gradient position next to the rear end of cylinder and the jetting the two pair vortices gradually generated from the free surface to the upper part of cylinder with the extension of velocity influence region after obtaining sufficient energy as the cavity and jetting developed however this velocity influence region gradually diminished as the energy provided by the impact of water entry is limited for the vortex to develop additionally the amount of initial energy obtained by the two pair eddies and their evolution experiencing a great difference in development from fig 13 at t 0 03 s vortex a gradually merges with other vortices as it moves toward the high velocity region in the cavity at this stage the q value of vortices continuously decreased which showed the rotational strength relatively to shear deformation became weakened on the other hand vortex b merged with another vortex on the upper part of cylinder to form vortex b that rotated counterclockwise as velocity influence region extended under the coupling effect of jetting and vortices vortices c and d merged to form vortex cd and was rotated clockwise in a very thin region of negative q value dominated by the effect of shear at t 0 05 s vortex b moved outward leaving the outer contour region dominated by shear it further separated into vortices b1 and b2 rotated in counterclockwise and clockwise direction respectively under the influence of jet elongation vortex cd separated into two new vortices c and d that were rotated in clockwise direction in the velocity gradient region these vortices were wrapped in a semi arc extremely thin region of negative q value dominated by the effect of shear at t 0 07 s the q value of vortices b1 and c gradually approaching zero as the intensity decreased due to the loss of energy from the velocity diagram the fluid particles next to the two vortices moved in parallel vortex d1 at the velocity gradient moved toward the high velocity region in the cavity then it merged with other vortices to continue evolve at t 0 09 0 11 s the q value of vortex b2 gradually approaching zero after being separated into two small vortices in other words the vortices underwent complex dynamic processes which including the movement mergence separation and dissipation the region of the positive and negative alternating q value in the cavity was complex and fragmentary 3 4 entry velocity on dynamic characteristics in this section the difference of the motion characteristics for vertical water entry of inclined cylinder at various entry velocities was investigated the time history of the vertical acceleration velocity and displacement as well as the angular acceleration angular velocity and inclined angle under different working conditions were presented to examine the impact on the translational and rotational characteristics in the study the vertical l1 and the horizontal l2 displacement were referenced to the height of cylinder the simulation results of the time histories of various motion parameters for cylinder water entry at velocities v 0 3 05 m s 6 1 m s 9 15 m s are shown in figs 14 17 it can be seen from figs 14 and 15 that the entry velocity could have significant influence on the translational characteristics of the cylinder entry the time histories of the acceleration velocity and displacement under the three 3 entry velocities remained identical under the impact of the cylinder on the water in the initial entry stage an abrupt change of acceleration in z axis was specifically noted the impact surface area on water remained constant due to the same entry angle of inclined cylinder the acceleration increased instantaneously with the entry velocity however at the final entry stage the acceleration was first increased but then decreased followed by various degrees of fluctuation under the effect of cavity closure and collapse during the entire entry process the impact force was actually found larger due to the higher entry velocity considering the coupling of various forces from the fluid viscosity residual resistance buoyancy and gravity the opposite direction of acceleration always reduced the velocity under different working conditions and the rate of change of acceleration gradually increased with the entry velocity the rate of change of displacement in z axis decreased at various entry velocities as the inclined cylinder entering the water vertically a horizontal displacement induced and increased with entry velocity due to horizontal component forces the horizontal displacement at various entry velocities varies with time prior to the time step t 0 10 0 103 s the horizontal displacement l2 generated from the water entry at velocities v 0 3 05 m s 6 1 m s 9 15 m s increased continuously thereafter it decreased and remained constant as illustrated in figs 7 9 the counterclockwise rotation of cylinder about y axis immediately occurred after the cylinder entering water at velocities v 0 3 05 m s 6 1 m s 9 15 m s the initial entry velocity could have a significant influence on the rotation characteristics of the inclined cylinder in the initial entry stage where the impact force did not pass through the centroid of the cylinder a rotational moment occurred the cylinder also rotated about its y axis at different degrees due to the moments generated from the fluid viscosity residual resistance buoyancy and gravity as can be seen in figs 16 and 17 the initial angular acceleration change instantaneously from negative to positive values and eventually stabilized with time during the stage of cavity closure at t 0 12 s the angular acceleration fluctuated and oscillated at various degrees under the entry velocities of v 0 3 05 m s 6 1 m s 9 15 m s the dynamic change of angular velocity and rotational angle could be assessed through the formulation ω y a θ y d t and θ y ω y d t respectively the angular velocity constantly increased after the initial entry stage of the fluctuation the cylinder rotated counterclockwise about its y axis with increasing rotation from the figure the angular velocity decreased at t 0 t 1 and t 2 at the entry velocity v 0 3 05 m s the angular velocity was first increased in negative but decreased in positive value at t 5 in other words the cylinder was first rotated counterclockwise with decreasing speed and then changes to clockwise rotation motion with increasing speed during the period t 5 t 7 the angular velocity for the water entry of inclined cylinder at v 0 6 1 m s and 9 15 m s was first decreased but increased after during the period of t 1 t 3 and t 2 t 4 respectively however it decreased continuously after t 3 and t 4 the motion of cylinder at this time was counterclockwise rotation and the change of rotational speed remained constant the cylinder at entry velocity v 0 6 1 m s after t 6 change to clockwise rotation with reduced rotational angle however the cylinder at entry velocity v 0 9 15 m s always rotated counterclockwise with increasing rotational angle and exceeded 90 eventually 4 conclusions in this paper the vertical water entry of cylinder at various entry velocities and entry angle of 78 4 deg is studied through the numerical investigation and the numerical model with laminar and turbulent model is verified against the published experimental data it can be concluded from the numerical study that 1 the rotation of cylinder increases with entry velocity the ellipsoidal cavity in secondary deep and surface closure occurs at higher velocity at the moment of cavity collapse the strip shaped splash increases continuously for certain time 2 a a high and low pressure region is located in the front and tail ends of the cylinder the high pressure region occurs at closure position after the air discharges from cavitation b a high velocity region is located next to the cylinder a large scale high velocity region is first occurred at the side of the cylinder and then gradually expands until the far field airflow is formed finally the high velocity region with largest velocity in closure position developed it is noted that a strip jet appears in a strip shaped high velocity region c the unsteady change of vortex structure is closely related to the cavity evolution and the region of positive and negative alternating q value in cavitation a flat thin layer of arc shaped region at the front end of cylinder is dominated by the effect of shear however the strength of q value above the free water surface weakens continuously where the closure position of cavity is dominated by vortices with shear effect the vortices in the region of velocity gradients always formed and undergo a dynamic complex flow mechanism 3 the vertical acceleration in the stage of impacting and the cavity closure exhibits a nonlinear abrupt change and fluctuation and the rate of change of vertical displacement decreases continuously however the displacement of cylinder in lateral direction increases first then shows a trend of decreasing constant and increasing after t 0 respectively with the increase in entry velocity the rotational angle of cylinder increases with entry velocity note that there is a shift of rotation motion of cylinder from the counterclockwise to the clockwise rotation with the change of angular velocity credit authorship contribution statement hui liu data curation software writing original draft bo zhou conceptualization methodology software xiaoshuang han supervision validation teng zhang investigation beike zhou visualization wie min gho writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the liaoning revitalization talents program grant number xlyc1807190 xlyc1908027 the liaoning provincial natural science foundation guidance project grant number 20180550186 the open project funding of state key laboratory of coastal and offshore engineering dalian university of technology grant number lp1906 and the fundamental research funds for the central universities dut20td108 
21567,many low lying atolls fronted by coral reefs are vulnerable to wave driven coastal flooding during extreme wave events previous laboratory studies on this issue focus mainly on the wave dynamics over one dimensional horizontal 1dh fringing reef profiles in wave flumes to better understand wave transformation and run up in a two dimensional horizontal 2dh reef lagoon channel system a set of laboratory experiments are performed in a wave basin using an idealized physical model subjected to both regular and irregular waves the wave height variation and wave spectrum evolution on the reef flat as well as wave run up on the back reef slope are first analyzed and then the impacts of incident wave height wave period and reef flat wave level on these wave processes are investigated finally the excitation of resonant modes is identified to account for the infragravity ig wave characteristics in the system keywords infragravity waves resonant modes lagoon rip channel coral reef 1 introduction a reef lagoon channel system is a typical reef configuration that can be frequently found at barrier reefs or reef atolls incident waves shoal on the steep fore reef slope and break around the reef edge dissipating the wave energy and producing a wave setup that can drive a current across the shallow reef flat through the deep lagoon and eventually back to the open sea via a rip channel lowe et al 2009 thus this process can build up a nearshore circulation in the reef lagoon channel system which is the main focus of existing studies because such circulation is crucial to the transport of organisms nutrient and sediments hench et al 2008 recently the safety of those reef lined low lying atolls has aroused growing concern in that these atolls are recognized as being especially vulnerable to coastal flooding in the face of sea level rise and extreme storms e g hoeke et al 2013 storlazzi et al 2018 compared to the well studied fringing reefs in the absence of lagoon and rip channel e g merrifield et al 2014 shimozono et al 2015 cheriton et al 2016 the wave driven coastal water level in the reef lagoon channel system has not yet been fully investigated in the literature coastal wave run ups behind reefs are composed of sea and swell ss waves infragravity ig waves and wave setup and they may exhibit a tidal dependence merrifield et al 2014 over decades it has been widely recognized that a large portion of incident wave energy within the ss frequency band 0 04 0 4 hz can be dissipated by wave breaking around the reef edge and the rest of ss wave energy can be further dissipated by bottom friction on the reef flat e g brander et al 2004 hardy and young 1996 pomeroy et al 2012 zhang et al 2017 therefore coastal wave run up is frequently observed to be dominated by wave motions within the ig frequency band 0 001 0 04 hz which are primarily released by the oscillation of ss wave breakpoint near the reef edge e g péquignet et al 2009 pomeroy et al 2012 under certain forcing conditions particularly for large waves in coincidence with high tidal levels the shoreward propagating ig waves could be further amplified due to the excitation of reef resonant modes e g becker et al 2016 péquignet et al 2009 when extending to the alongshore wave processes the released ig waves on the reef flat may be trapped as laterally propagating edge waves e g su and ma 2018 in the past decade wave transformation and run up including the ig wave dynamics over fringing reefs have probably received the most attention in the field studies e g beetham et al 2016 cheriton et al 2016 gawehn et al 2016 lashley et al 2018 merrifield et al 2014 quataert et al 2015 pearson et al 2017 shimozono et al 2015 and many others compared to the field observations there is only a few laboratory experiments focusing on the wave interaction with coral reefs including breaking wave characteristics in the reef surf zone gourlay 1994 yao et al 2013 2019a wave induced setup and wave driven flow across the reef flat e g buckley et al 2015 gourlay 1996 yao et al 2017 2018a and solitary wave propagation over the reef profiles quiroga and cheung 2013 yao et al 2018b regarding the issues of wave transformation and run up nwogu and demirbilek 2010 is the pioneering study to investigate the ig wave motions and wave run up over a physical reef model mimicking a realistic reef site at guam they found that ig wave energy increased from the reef edge to the coastline on the reef flat which was due to an excitation of the fundamental resonant mode recently buckley et al 2018 conducted a series of laboratory experiments on both smooth and rough reef profiles to reveal the mechanisms accounting for the wave driven coastal water level variability they found that wave setup and ig waves were the dominant components of coastal wave runup and the latter was generated by the breakpoint forcing mechanism more recently yao et al 2019b conducted a set of laboratory experiments using an idealized reef profile the wave responses near the shoreline to the reef morphological variations with without the reef crest the lagoon and the surface roughness were examined ig wave generation within the surf zone and wave resonance on the reef flat were also identified in their study however all above studies concentrated on the cross shore wave dynamics over 1dh fringing reef profiles in the wave flumes to date studies of wave transformation and run up over a 2dh reef configuration are even fewer in the literature as far as the authors knowledge we are only aware that smith et al 2012 performed physical model experiments in a three dimensional 3d wave basin to measure wave transformation setup and runup over a 2dh fringing reef their idealized bathymetry was taken from the lidar data in southeast guam they found that ss wave energy rapidly dissipated across the reef whereas ig wave energy remained nearly constant they also conducted additional tests with an angled channel on the reef flat and found that the channel had small effects on both wave height and setup only at the place very close to the channel subsequently su and ma 2018 numerically investigated the ig wave motions by a boussinesq wave model based on smith et al 2012 s laboratory experiments their model was first verified by the measured cross shore alongshore ss wave height wave setup and ig wave height then it was applied to examine the cross shore ig wave motions controlled by the leaky waves as well as the alongshore ig wave motions represented by edge waves however both above studies focused on a 2dh fringing reef configuration although smith et al 2012 considered the presence of a channel on the reef flat their channel size was very small 0 15 m wide and 0 1 m deep compared to the reef flat and there was no lagoon behind the reef flat therefore wave dynamics in a complete reef lagoon channel system still needs to be better understood in this study to remedy the lack of laboratory measurements of wave transformation and run up in a 2dh reef lagoon channel system in the literature we conducted a series of innovative laboratory experiments in a 3d wave basin to investigate both regular and irregular wave processes in such a system based on an idealized physical model both cross shore alongshore variations in total ss and ig wave motions as well as wave run up are examined in a well controlled laboratory environment the impacts of incident wave height wave period and reef flat wave level on these processes are also investigated the mechanism accounting for the ig wave motions in the system is finally discussed the rest of the article is arranged as follows experimental setup of the reef lagoon channel system is described in section 2 result analyses including wave height wave spectrum as well as wave run up in the system are reported in section 3 wave spectrum within the ig band and wave resonance are discussed in section 4 main conclusions drawn from this study are shown in section 5 2 experimental setup the wave basin laboratory experiments are designed to reproduce the main aspects of wave processes in the reef lagoon channel system at paopao bay moorea french polynesia hench et al 2008 this porotype reef site consists of two reefs about 1 km wide separated by a deep channel about 300 m wide in average as well as a deep lagoon about 250 m wide in average behind the reefs fig 1 a the cross shore profile of the reef is featured by a steep fore reef slope about 1 8 and a shallow reef flat with a narrow reef crest about 10 m wide locating at the reef edge fig 1b since there is no detailed bathymetry data for the entire system the cross shore reef profile in the experiments is idealized by a plane slope followed by a horizontal reef flat both the cross shore width of lagoon and alongshore width of channel conform to the porotype the alongshore width of reef flat extends to a distance of 750 m at prototype scale on both sides of the channel to cover the dominant pattern of the reef lagoon channel circulation as reported by hench et al 2008 the physical model is designed with a geometric scale factor of 1 50 according to the froude s law of similarity see fig 1c and d the wave basin 60 m long 36 m wide and 0 8 m deep at the tianjin research institute for water transport engineering p r china is equipped with a piston type wavemaker at its one end wave generation in the wave basin is purely cross shore which means that wave directional spreading is not considered as shown in fig 2 a and b a 1 8 fore reef plane slope is constructed with its toe located at 34 m away from the wavemaker the slope is attached by a horizontal reef flat with a cross shore width of 14 m the reef flat is elevated 0 4 m above the basin bottom with its alongshore width matching the basin width a lagoon with the cross shore width of 5 m is set behind the reef followed by a 1 3 3 plane slope representing the back reef beach a channel with an alongshore width of 6 m is placed in the middle of the reef flat to divide the model configuration into two symmetric reef lagoon channel systems both lagoon and channel depths match the basin depth while their side walls are built with 1 1 slope therefore incident wave coming from the channel can obliquely enter the reef flat due to wave refraction occurring on such lateral slopes the whole physical model is made of sands with an armor cement layer for the cement reef surface reef roughness may be underestimated in the present laboratory settings compared to the field conditions both regular waves and irregular waves are tested in the experiments irregular sea states are produced using the jonswap spectrum with a peak enhancement factor of γ 3 3 a representative default wave condition with the incident deep water significant wave height of h 0 0 06 m peak wave period of t 2 0 s and reef flat water level of h r 0 04 m is tested first based on the default test additional three wave heights of h 0 0 04 m 0 08 m and 0 10 m three wave periods of t 1 5 s 2 5 s and 3 0 s as well as two water levels of h r 0 m and 0 1 m are tested as well in additional runs only one wave parameter is altered while keeping others the same as the default condition thus the total number of test scenarios is 18 according to the model scale of 1 50 above the prototype ranges of wave parameters are 2 5 m for h 0 11 21 s for t and 0 5 m for h r the range of t falls in the range observed at field reef site but the ranges for h 0 and h r are larger than those observed this is because our design covers those extreme wave events that were not reported in existing field studies at this site hench et al 2008 monismith et al 2013 free surface elevations in the reef channel lagoon system are sampled at 41 cross shore locations g1 g41 with the capacitance type water level gauges bo ming co ltd china additional 5 gauges r1 r5 are laid on the back reef beach to measure the wave run up all gauges are sampled with a frequency of 50 hz and their detailed locations are shown in fig 2b all instruments are placed on one side of the channel due to the model s symmetry along its channel centerline the sampling duration is 200 500 wave cycles for regular irregular waves with the last 100 400 wave cycles used in the wave analysis to avoid the transient effect all runs have been repeated three times and the data repeatability is good with less than 5 difference in most wave and runup measurements see e g a repeatability test for the default wave condition in fig 3 the average of the three repeating runs was thus used in the data analysis one hour is waited between the successive runs to ensure that water in the basin becomes calm for irregular waves the significant total wave height h t ss wave height h s s and ig wave height h i g are calculated from the wave energy spectrum s f by 1 h t 4 0 0 5 f s s f d f h s s 4 0 5 f p 0 5 f s s f d f h i g 4 0 0 5 f p s f d f where 0 5 f s is the nyquist frequency and f s is the sampling frequency i e 50 hz in this study 0 5 f p is the splitting frequently between the ig band and the ss band e g buckley et al 2015 and f p is the peak frequency of the spectrum s f is estimated by a fast fourier transform of the wave records after removing the mean smoothed over 10 adjacent frequency bands for regular waves h is calculated by the zero up crossing method we also conducted flow measurements in the experiments and the results for wave induced setup and wave driven currents have been reported in a separate paper zheng et al 2020 3 experimental results 3 1 wave height variation in the reef lagoon channel system taking the representative regular wave condition h 0 0 06 m t 2 0 s and h r 0 04 m for an example the wave height variation in the reef lagoon channel system is investigated along the cross shore central reef transect fig 4 a h increases on the fore reef slope due to wave shoaling it reaches the peak around the reef edge where incipient wave breaking occurs h drops rapidly in the surf zone on the outer reef flat after wave breaking reformed waves continue to propagate on the inner reef flat and into the lagoon a gradual decay of h can be observed in that our reef surface is relatively smooth and the frictional dissipation is supposed to be small on the reef flat the transmitted wave height in the lagoon is about 40 of the offshore incident wave height for this case along the alongshore central reef transect fig 4c h is almost constant along the reef flat until to the area very close to the channel where h is notably increased this is anticipated because the incident waves propagating into the deep channel become steepened when they travel on offshore directed rip currents the above trends are pervasive in the entire reef lagoon channel system when we examine the variation of h using the contour plot based on the wave measurements from all wave gauges fig 5 then we examine the variations of h at selected sampling locations g9 in the surf zone on the reef flat g12 shoreward of the surf zone at the middle reef flat g13 at an cross shore reef flat position next to g12 g24 at an alongshore reef flat position next to g12 g15 in the lagoon in the system with the incident wave height h 0 wave period t and reef flat water level h r for all test regular wave conditions fig 6 the variations of h in the channel follow closely to the incident waves thus they are not shown h on the reef flat g9 g12 g13 g24 and in the lagoon g15 increase with the increase of h 0 fig 6a whereas the effects of t on h at those reef flat locations g12 g13 g24 outside the surf zone are insignificant fig 6b meanwhile both h on the reef flat and in the lagoon increase with the increase of h r due to less energy dissipation resulting from wave breaking and bottom friction at a higher water level fig 6c taking the same wave condition h 0 0 06 m t 2 0 s and h r 0 04 m as an example we also analyze the variation of wave height in the reef lagoon channel system subjected to irregular waves for which the total wave height h t ss wave height h s s and ig wave height h i g are investigated respectively the variations of h t fig 7 a and e and h s s fig 7b and f in the system are similar to those for regular waves as for the cross shore variation of ig waves fig 7c h i g on the fore reef slope is relatively small which is attributed to the presences of both incident shoaling bound waves pomeroy et al 2012 and reflected ig waves from the reef buckley et al 2018 however more ig wave energy is found to be generated around the reef edge due primarily to the breakpoint forcing mechanism e g pomeroy et al 2012 buckley et al 2018 on the reef flat h i g increases from the reef edge to the inner reef flat until to its peak then it declines all the way to the lagoon such trend results from the excitation of resonant modes see section 4 in the lagoon h i g is found to be almost zero as for the alongshore variation of ig waves fig 7g h i g rises gradually from the side wall to the reef flat until to a location near the channel where it begins to drop when the variation of h i g in the whole system is examined fig 8 c it is evident that the maximum h i g appears at central inner reef flat we subsequently investigate the variations of h t h s s and h i g at the aforementioned sampling locations g9 g12 g13 and g24 on the reef flat g15 in the lagoon for all test irregular wave conditions fig 9 similar to h for regular waves h t and h s s on the reef flat g9 g12 g13 and g24 and in the lagoon g15 increase with the increase of h 0 and h r fig 9a c d and f and those from inner reef flat locations g12 g13 and g24 are also not very sensitive to the variation in t fig 9b and e as for h i g it increases with the increase of h 0 fig 9g meanwhile h i g on the reef flat generally rises with the increase of t when t is relatively small but the trend varies among different reef flat locations g12 g13 and g24 as t further increases from 2 5 s to 3 s fig 9h depending on the reef flat positions h i g on the reef flat reaches its maximum at the intermediate h r g12 and g24 or largest h r g13 fig 9i the variations of h i g with both t and h r can be explained by the excitation of different resonant modes as will be discussed in section 4 for wave induced setup in the in the reef lagoon channel system under both regular and irregular waves zheng et al 2020 has shown that the maximum wave setup occurs at the end of surf zone around the mid reef flat wave setup also decreases from the mid reef flat into the lagoon this cross shore wave setup reduction over the reef creates a pressure gradient on the reef flat that drives an onshore current from the reef flat into the lagoon wave setup also drops dramatically from the central reef to the channel the alongshore pressure gradient drives relatively weaker alongshore current from the reef flat to the channel meanwhile the maximum wave setup on the reef flat increases with the increase of h 0 but decreases with the increase of h r however its variation with t is less pronounced these observations are generally consistent with laboratory studies for the reef systems with a rip channel e g gourlay 1996 yao et al 2018a 3 2 wave spectrum evolution in the reef lagoon channel system in this section the evolution of wave spectrum in the system is explored for both regular and irregular waves based on the representative wave condition above sampling locations at offshore g1 on the fore reef slope g6 in the channel g38 together with the previously investigated locations on reef flat g9 g12 g13 and g24 and in the lagoon g15 are chosen for demonstration for regular waves fig 10 most incident wave energy at offshore g1 is from the fundamental harmonic waves but there is also some energy associated with the second harmonics which is a typical feature of the stokes waves as wave shoals on the fore reef slope g6 and in the surf zone g9 higher harmonics as well as low frequency waves are generated due to the nonlinear wave wave interaction nwogu and demirbilek 2010 this kind of nonlinear interaction transfers wave energy to super harmonics sub harmonics through summation subtraction at multiples of the peak frequency behind the surf zone on the central reef flat g12 both the fundamental and higher harmonics are significantly damped but the low frequency waves are almost unvaried there are also almost no changes in wave spectra at further inshore location g13 and alongshore location g24 more energy at the fundamental frequency can be found in the deeper lagoon g15 which is contributed by waves coming from the channel wave spectrum in the channel g38 generally matches that from the offshore location g1 as for irregular waves fig 11 more wave energy within the ig band is found at the fore reef slope g6 than that at the offshore location g1 because of the shoaling bound waves and reflected ig waves previously mentioned and the generation of higher frequency waves is not obvious from the surf zone g9 to the central reef flat behind the surf zone g12 almost all ss wave energy is damped by wave breaking while ig wave energy increases as a result of the aforementioned breakpoint forcing mechanism in accordance with fig 4c the maximum ig wave energy is found on the central reef flat after comparing the spectrum from g12 to that from a location further shoreward g13 in the lagoon the ss wave energy is larger than that on the reef flat similar to the regular waves however there is almost no ig wave energy in the lagoon which is also consistent with fig 8c in the channel g38 wave spectrum follows that from the offshore g1 except for a lower energy level within the ss band 3 3 variation of wave run up on the back reef slope wave run up defined as the vertical distance between the moving shoreline and the still water level is directly related to the coastal inundation it consists of a steady wave setup η r and an unsteady swash due to ss and ig motions the present 2dh reef configuration provides us an opportunity to examine the alongshore variation of wave run up on the back reef beach the cumulative distribution functions of the wave run ups at the five alongshore sampling locations r1 r5 for both wave types fig 12 a and b indicate that wave runups are more dispersive for irregular waves as well as for the locations around the channel among the three reef flat locations r1 r3 similar runup distribution can be found and the largest exceedance probability of wave run up is generally found at r2 for both regular and irregular waves fig 13 a and b present the wave run up values at the five alongshore sampling locations r1 r5 for the regular waves using the maximum wave run up r max extracted from fig 12a and irregular waves using the 2 exceedance level of wave run up r 2 extracted from fig 12b respectively under the aforementioned representative wave condition for both types of waves a peak value of r max or r 2 can be found at the most central reef location r2 among the reef flat locations r1 r3 a further examination of wave run up components ss swash motion s s s ig swash motion s i g and wave setup η r indicates that such behavior of wave run up is primarily attributed by the alongshore variations of s s s for regular waves and both s s s and s i g for irregular waves greater s s s appears at r2 is possibly due to an additional contribution of incident waves with oblique incidence from the channel to the reef flat which is visible during our experiments while a larger s i g at r2 is consistent with the alongshore variation of ig wave height that can be observed in fig 8c consequently the percentage contribution to r max at r2 is 51 2 from ss motions 21 0 from ig motions and 27 8 from wave setup while for r 2 it is 45 0 from ss motions and 36 3 from ig motions 18 7 from wave setup the latter disagrees with the wave flume experiments of buckley et al 2018 in which ss wave motions are found to be less important this can also be explained by the fact that some ss wave energy comes directly from the channel in our experiments meanwhile both r max and r 2 increase notably around the channel r4 and r5 which is more evident to be caused by the incoming ss waves in the channel the variations of r max and r 2 at the alongshore sampling locations r1 r5 with h 0 t and h r are given by figs 14 and 15 respectively since wave run up in this study is dominated by ss and ig wave motions rather than the wave setup as discussed above r max and r 2 generally increase with the increasing h 0 figs 14a and 15a in that the total wave height i e h in fig 6a and h t in fig 9a which is a combination of ss and ig wave heights increases with the increase of h 0 however the variations of r max and r 2 for the reef flat locations r1 r3 fluctuate with the increase of t figs 14b and 15b which are attributed to the resonant modes excited with different t see section 4 for details meanwhile both r max and r 2 increase with the increase of h r figs 14c and 15c which are contributed by the rise of the total wave height with h r figs 6c and 9c 4 a discussion on wave spectrum within the ig band and wave resonance on the reef flat transmitted incoming waves can be reflected from the back reef slope the reflected outgoing waves are superposed by the incoming waves thus producing a standing wave pattern with nodes and antinodes when standing wave node and antinode are located at the reef edge and shoreline respectively wave resonance in this open ended basin system occurs fig 16 a following buckley et al 2018 the natural frequencies for this resonant system be calculated by 2 f n 1 4 2 n 1 0 l t o t a l 1 g h r x η x d x 1 n 0 1 2 where f n is the natural frequency of the n th resonant mode h r x and η x are the water depth and the mean water level respectively at location x across the reef profile l t o t a l is the cross shore reef flat width l r plus the cross shore lagoon width l l in this study and g is the gravitational acceleration wave trapping may also occur when incoming and outgoing waves are reflected at the fore reef edge and back reef edge respectively due to the rapid depth changes that occur on the steep fore reef slope and in the lagoon see e g dean 1964 forming another standing wave pattern when two nodes of these standing waves match the two edges of the reef flat wave resonance in this open basin system occurs fig 16b the natural frequencies for this resonant system be calculated by 3 f n 1 2 n 1 0 l r 1 g h r x η x d x 1 n 0 1 2 yao et al 2019b has revealed that resonant modes can also be excited in the closed lagoon if the lagoon is sufficiently wide fig 16c however our lagoon width is only about one third of the reef flat width thus its theoretical resonant frequencies generally fall outside the ig band in this study the ig wave spectra at the sampling locations along the cross shore central reef transect i e a a in fig 2b subjected to irregular wave conditions h 0 0 06 m and h r 0 04 m with different wave periods t are first investigated energy peaks within the ig band can be found around the resonant modal frequencies on the reef flat fig 17 a d those peaks cannot been found in the spectrum of incident waves when t is greater than 1 5 s which means they are not brought from the offshore thus they can be used to explain the maximum ig wave distribution on the reef flat such as that observed in fig 8c for such wave periods fig 17c d it seems that the fundamental n 0 and first n 1 modes are more energetic for the reef flat closed basin while the first n 1 and the second n 2 modes are more energetic for the reef lagoon open ended basin furthermore energy amplification around the fundamental n 0 modal frequency of the open ended basin can be found in the wave run up spectra and such kind of amplification appears to increase with the increasing t subsequently the effects of reef flat water level h r on the ig wave spectra along the cross shore central reef transect are investigated similar to the effects of wave period above higher modes n 0 are excited on the reef flat for both the reef flat closed basin and the reef lagoon open ended basin such excitation at the middle reef flat is more stronger with the intermediate reef flat water level of 0 04 m fig 18 b than with higher wave levels of h r 0 04 m and 0 1 m fig 18a and c this can account for the observation in fig 9i that the ig wave height reaches its peak at g12 when h r 0 04 m meanwhile the amplification of wave energy around the fundamental n 0 modal frequency of the open ended basin in the run up spectra is found to increase with the increase of h r this trend is generally consistent with previous field observations e g becker et al 2016 péquignet et al 2009 and laboratory measurements e g buckley et al 2018 due to the presence of the channel in this study zheng et al 2020 has shown that wave setup produced by breaking waves drives a mean current across the reef flat through the lagoon and exiting from the channel is the dominant hydrodynamic process in this reef lagoon channel system such kind of circulation has also been found by rey 2019 who performed numerical simulations using the xbeach non hydrostatic model to investigate the influences of reef alongshore geometry on wave runup rey 2019 also found that both long waves and wide channels tend to cause a dual peak runup system with a second peak inside the channel which is very similar to the variation of measured wave runup in this study fig 13b the simulations also suggested that such processes as wave current interaction refraction and diffraction due to the presence of a channel lead to a focusing of wave energy next to the channel thus the ig component of such kind of alongshore energy contribution combined with our identified cross shore reef flat closed basin oscillation fig 16b is believed to be able to explain the maximum ig wave height located around the central reef flat as we found in fig 8c we finally remark that the alongshore variation of ig wave energy on the reef flat in fig 8c is also possibly affected by the presence of edge waves in a 2dh reef configuration e g su and ma 2018 however the sampling locations in the current laboratory setup are not sufficient to support an analysis of such alongshore propagating waves and this issue needs to be further investigated via a numerical model the lack of directional spreading in the wave generation of this study may result in slightly overestimation the ig wave forcing and thus increase ig wave energy generation in the reef system see e g masselink et al 2019 5 conclusions a set of innovative laboratory experiments is carried out in a wave basin to investigate the wave transformation and run up in a 2dh reef lagoon channel system both regular and irregular waves are tested with an idealized physical model results show that incident wave height reduces significantly when waves propagate over the reef flat and into the lagoon there is almost no alongshore variation of total wave height on the reef flat except for the area very close the channel transmitted ss wave height on the reef flat rises with both increasing incident wave height and reef flat water level but it is not very sensitive to the wave period ig wave height is found to be largest at the central inner reef flat and it is insignificant in the lagoon ig wave height on the reef flat also increases with the increase of incident wave height but its dependence on wave period or reef flat water level varies spectral analysis indicates that wave energy is shifted to both low frequency waves and higher harmonics when regular waves transform on the reef flat while ig wave energy is generated and amplified on the reef flat associated with the irregular wave transformation the alongshore peak wave run up appears on the cross shore central reef transect and it is primarily contributed by ss motions for regular waves and by both ss and ig motions for irregular waves the incident wave height wave period and reef flat water level affect the wave run up behind the reef flat in a similar manner to the ss waves on the reef flat a detailed analysis of the cross shore evolution of wave spectrum within the ig band suggests that oscillation modes in both the reef lagoon and reef flat resonant systems are excited resulting in amplification of ig wave energy on the reef flat and at the shoreline the number and magnitude of resonant modes vary with different wave periods and reef flat water levels laboratory dataset reported in this study could also be potentially used to validate the analytical or numerical models developed for modeling coral reef hydrodynamics the variations of reef morphology reef lagoon channel geometry reef bathymetry etc and surface roughness may also affect the conclusions drawn in this study to a more or less degree the alongshore wave dynamics needs to be further investigated via numerical simulations future studies can be directed to these issues credit authorship contribution statement yu yao conceptualization methodology validation formal analysis investigation data curation writing original draft writing review editing visualization funding acquisition supervision songgui chen methodology validation formal analysis investigation data curation writing original draft writing review editing visualization jinhai zheng conceptualization methodology formal analysis writing original draft writing review editing supervision project administration funding acquisition supervision qiming zhang formal analysis investigation resources visualization writing review editing shubin chen validation formal analysis investigation data curation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported financially by the national science fund for distinguished young scholars grant no 51425901 the national natural science foundation of china grant nos 51679014 and 51979013 the scientific research fund of hunan provincial education department china grant no 18a116 young elite scientist sponsorship program by the china association for science and technology grant no 2018qnrc001 research funds for the central universities grant no tks190201 and the special research funding of state key laboratory of hydrology water resources and hydraulic engineering 20195025812 
21567,many low lying atolls fronted by coral reefs are vulnerable to wave driven coastal flooding during extreme wave events previous laboratory studies on this issue focus mainly on the wave dynamics over one dimensional horizontal 1dh fringing reef profiles in wave flumes to better understand wave transformation and run up in a two dimensional horizontal 2dh reef lagoon channel system a set of laboratory experiments are performed in a wave basin using an idealized physical model subjected to both regular and irregular waves the wave height variation and wave spectrum evolution on the reef flat as well as wave run up on the back reef slope are first analyzed and then the impacts of incident wave height wave period and reef flat wave level on these wave processes are investigated finally the excitation of resonant modes is identified to account for the infragravity ig wave characteristics in the system keywords infragravity waves resonant modes lagoon rip channel coral reef 1 introduction a reef lagoon channel system is a typical reef configuration that can be frequently found at barrier reefs or reef atolls incident waves shoal on the steep fore reef slope and break around the reef edge dissipating the wave energy and producing a wave setup that can drive a current across the shallow reef flat through the deep lagoon and eventually back to the open sea via a rip channel lowe et al 2009 thus this process can build up a nearshore circulation in the reef lagoon channel system which is the main focus of existing studies because such circulation is crucial to the transport of organisms nutrient and sediments hench et al 2008 recently the safety of those reef lined low lying atolls has aroused growing concern in that these atolls are recognized as being especially vulnerable to coastal flooding in the face of sea level rise and extreme storms e g hoeke et al 2013 storlazzi et al 2018 compared to the well studied fringing reefs in the absence of lagoon and rip channel e g merrifield et al 2014 shimozono et al 2015 cheriton et al 2016 the wave driven coastal water level in the reef lagoon channel system has not yet been fully investigated in the literature coastal wave run ups behind reefs are composed of sea and swell ss waves infragravity ig waves and wave setup and they may exhibit a tidal dependence merrifield et al 2014 over decades it has been widely recognized that a large portion of incident wave energy within the ss frequency band 0 04 0 4 hz can be dissipated by wave breaking around the reef edge and the rest of ss wave energy can be further dissipated by bottom friction on the reef flat e g brander et al 2004 hardy and young 1996 pomeroy et al 2012 zhang et al 2017 therefore coastal wave run up is frequently observed to be dominated by wave motions within the ig frequency band 0 001 0 04 hz which are primarily released by the oscillation of ss wave breakpoint near the reef edge e g péquignet et al 2009 pomeroy et al 2012 under certain forcing conditions particularly for large waves in coincidence with high tidal levels the shoreward propagating ig waves could be further amplified due to the excitation of reef resonant modes e g becker et al 2016 péquignet et al 2009 when extending to the alongshore wave processes the released ig waves on the reef flat may be trapped as laterally propagating edge waves e g su and ma 2018 in the past decade wave transformation and run up including the ig wave dynamics over fringing reefs have probably received the most attention in the field studies e g beetham et al 2016 cheriton et al 2016 gawehn et al 2016 lashley et al 2018 merrifield et al 2014 quataert et al 2015 pearson et al 2017 shimozono et al 2015 and many others compared to the field observations there is only a few laboratory experiments focusing on the wave interaction with coral reefs including breaking wave characteristics in the reef surf zone gourlay 1994 yao et al 2013 2019a wave induced setup and wave driven flow across the reef flat e g buckley et al 2015 gourlay 1996 yao et al 2017 2018a and solitary wave propagation over the reef profiles quiroga and cheung 2013 yao et al 2018b regarding the issues of wave transformation and run up nwogu and demirbilek 2010 is the pioneering study to investigate the ig wave motions and wave run up over a physical reef model mimicking a realistic reef site at guam they found that ig wave energy increased from the reef edge to the coastline on the reef flat which was due to an excitation of the fundamental resonant mode recently buckley et al 2018 conducted a series of laboratory experiments on both smooth and rough reef profiles to reveal the mechanisms accounting for the wave driven coastal water level variability they found that wave setup and ig waves were the dominant components of coastal wave runup and the latter was generated by the breakpoint forcing mechanism more recently yao et al 2019b conducted a set of laboratory experiments using an idealized reef profile the wave responses near the shoreline to the reef morphological variations with without the reef crest the lagoon and the surface roughness were examined ig wave generation within the surf zone and wave resonance on the reef flat were also identified in their study however all above studies concentrated on the cross shore wave dynamics over 1dh fringing reef profiles in the wave flumes to date studies of wave transformation and run up over a 2dh reef configuration are even fewer in the literature as far as the authors knowledge we are only aware that smith et al 2012 performed physical model experiments in a three dimensional 3d wave basin to measure wave transformation setup and runup over a 2dh fringing reef their idealized bathymetry was taken from the lidar data in southeast guam they found that ss wave energy rapidly dissipated across the reef whereas ig wave energy remained nearly constant they also conducted additional tests with an angled channel on the reef flat and found that the channel had small effects on both wave height and setup only at the place very close to the channel subsequently su and ma 2018 numerically investigated the ig wave motions by a boussinesq wave model based on smith et al 2012 s laboratory experiments their model was first verified by the measured cross shore alongshore ss wave height wave setup and ig wave height then it was applied to examine the cross shore ig wave motions controlled by the leaky waves as well as the alongshore ig wave motions represented by edge waves however both above studies focused on a 2dh fringing reef configuration although smith et al 2012 considered the presence of a channel on the reef flat their channel size was very small 0 15 m wide and 0 1 m deep compared to the reef flat and there was no lagoon behind the reef flat therefore wave dynamics in a complete reef lagoon channel system still needs to be better understood in this study to remedy the lack of laboratory measurements of wave transformation and run up in a 2dh reef lagoon channel system in the literature we conducted a series of innovative laboratory experiments in a 3d wave basin to investigate both regular and irregular wave processes in such a system based on an idealized physical model both cross shore alongshore variations in total ss and ig wave motions as well as wave run up are examined in a well controlled laboratory environment the impacts of incident wave height wave period and reef flat wave level on these processes are also investigated the mechanism accounting for the ig wave motions in the system is finally discussed the rest of the article is arranged as follows experimental setup of the reef lagoon channel system is described in section 2 result analyses including wave height wave spectrum as well as wave run up in the system are reported in section 3 wave spectrum within the ig band and wave resonance are discussed in section 4 main conclusions drawn from this study are shown in section 5 2 experimental setup the wave basin laboratory experiments are designed to reproduce the main aspects of wave processes in the reef lagoon channel system at paopao bay moorea french polynesia hench et al 2008 this porotype reef site consists of two reefs about 1 km wide separated by a deep channel about 300 m wide in average as well as a deep lagoon about 250 m wide in average behind the reefs fig 1 a the cross shore profile of the reef is featured by a steep fore reef slope about 1 8 and a shallow reef flat with a narrow reef crest about 10 m wide locating at the reef edge fig 1b since there is no detailed bathymetry data for the entire system the cross shore reef profile in the experiments is idealized by a plane slope followed by a horizontal reef flat both the cross shore width of lagoon and alongshore width of channel conform to the porotype the alongshore width of reef flat extends to a distance of 750 m at prototype scale on both sides of the channel to cover the dominant pattern of the reef lagoon channel circulation as reported by hench et al 2008 the physical model is designed with a geometric scale factor of 1 50 according to the froude s law of similarity see fig 1c and d the wave basin 60 m long 36 m wide and 0 8 m deep at the tianjin research institute for water transport engineering p r china is equipped with a piston type wavemaker at its one end wave generation in the wave basin is purely cross shore which means that wave directional spreading is not considered as shown in fig 2 a and b a 1 8 fore reef plane slope is constructed with its toe located at 34 m away from the wavemaker the slope is attached by a horizontal reef flat with a cross shore width of 14 m the reef flat is elevated 0 4 m above the basin bottom with its alongshore width matching the basin width a lagoon with the cross shore width of 5 m is set behind the reef followed by a 1 3 3 plane slope representing the back reef beach a channel with an alongshore width of 6 m is placed in the middle of the reef flat to divide the model configuration into two symmetric reef lagoon channel systems both lagoon and channel depths match the basin depth while their side walls are built with 1 1 slope therefore incident wave coming from the channel can obliquely enter the reef flat due to wave refraction occurring on such lateral slopes the whole physical model is made of sands with an armor cement layer for the cement reef surface reef roughness may be underestimated in the present laboratory settings compared to the field conditions both regular waves and irregular waves are tested in the experiments irregular sea states are produced using the jonswap spectrum with a peak enhancement factor of γ 3 3 a representative default wave condition with the incident deep water significant wave height of h 0 0 06 m peak wave period of t 2 0 s and reef flat water level of h r 0 04 m is tested first based on the default test additional three wave heights of h 0 0 04 m 0 08 m and 0 10 m three wave periods of t 1 5 s 2 5 s and 3 0 s as well as two water levels of h r 0 m and 0 1 m are tested as well in additional runs only one wave parameter is altered while keeping others the same as the default condition thus the total number of test scenarios is 18 according to the model scale of 1 50 above the prototype ranges of wave parameters are 2 5 m for h 0 11 21 s for t and 0 5 m for h r the range of t falls in the range observed at field reef site but the ranges for h 0 and h r are larger than those observed this is because our design covers those extreme wave events that were not reported in existing field studies at this site hench et al 2008 monismith et al 2013 free surface elevations in the reef channel lagoon system are sampled at 41 cross shore locations g1 g41 with the capacitance type water level gauges bo ming co ltd china additional 5 gauges r1 r5 are laid on the back reef beach to measure the wave run up all gauges are sampled with a frequency of 50 hz and their detailed locations are shown in fig 2b all instruments are placed on one side of the channel due to the model s symmetry along its channel centerline the sampling duration is 200 500 wave cycles for regular irregular waves with the last 100 400 wave cycles used in the wave analysis to avoid the transient effect all runs have been repeated three times and the data repeatability is good with less than 5 difference in most wave and runup measurements see e g a repeatability test for the default wave condition in fig 3 the average of the three repeating runs was thus used in the data analysis one hour is waited between the successive runs to ensure that water in the basin becomes calm for irregular waves the significant total wave height h t ss wave height h s s and ig wave height h i g are calculated from the wave energy spectrum s f by 1 h t 4 0 0 5 f s s f d f h s s 4 0 5 f p 0 5 f s s f d f h i g 4 0 0 5 f p s f d f where 0 5 f s is the nyquist frequency and f s is the sampling frequency i e 50 hz in this study 0 5 f p is the splitting frequently between the ig band and the ss band e g buckley et al 2015 and f p is the peak frequency of the spectrum s f is estimated by a fast fourier transform of the wave records after removing the mean smoothed over 10 adjacent frequency bands for regular waves h is calculated by the zero up crossing method we also conducted flow measurements in the experiments and the results for wave induced setup and wave driven currents have been reported in a separate paper zheng et al 2020 3 experimental results 3 1 wave height variation in the reef lagoon channel system taking the representative regular wave condition h 0 0 06 m t 2 0 s and h r 0 04 m for an example the wave height variation in the reef lagoon channel system is investigated along the cross shore central reef transect fig 4 a h increases on the fore reef slope due to wave shoaling it reaches the peak around the reef edge where incipient wave breaking occurs h drops rapidly in the surf zone on the outer reef flat after wave breaking reformed waves continue to propagate on the inner reef flat and into the lagoon a gradual decay of h can be observed in that our reef surface is relatively smooth and the frictional dissipation is supposed to be small on the reef flat the transmitted wave height in the lagoon is about 40 of the offshore incident wave height for this case along the alongshore central reef transect fig 4c h is almost constant along the reef flat until to the area very close to the channel where h is notably increased this is anticipated because the incident waves propagating into the deep channel become steepened when they travel on offshore directed rip currents the above trends are pervasive in the entire reef lagoon channel system when we examine the variation of h using the contour plot based on the wave measurements from all wave gauges fig 5 then we examine the variations of h at selected sampling locations g9 in the surf zone on the reef flat g12 shoreward of the surf zone at the middle reef flat g13 at an cross shore reef flat position next to g12 g24 at an alongshore reef flat position next to g12 g15 in the lagoon in the system with the incident wave height h 0 wave period t and reef flat water level h r for all test regular wave conditions fig 6 the variations of h in the channel follow closely to the incident waves thus they are not shown h on the reef flat g9 g12 g13 g24 and in the lagoon g15 increase with the increase of h 0 fig 6a whereas the effects of t on h at those reef flat locations g12 g13 g24 outside the surf zone are insignificant fig 6b meanwhile both h on the reef flat and in the lagoon increase with the increase of h r due to less energy dissipation resulting from wave breaking and bottom friction at a higher water level fig 6c taking the same wave condition h 0 0 06 m t 2 0 s and h r 0 04 m as an example we also analyze the variation of wave height in the reef lagoon channel system subjected to irregular waves for which the total wave height h t ss wave height h s s and ig wave height h i g are investigated respectively the variations of h t fig 7 a and e and h s s fig 7b and f in the system are similar to those for regular waves as for the cross shore variation of ig waves fig 7c h i g on the fore reef slope is relatively small which is attributed to the presences of both incident shoaling bound waves pomeroy et al 2012 and reflected ig waves from the reef buckley et al 2018 however more ig wave energy is found to be generated around the reef edge due primarily to the breakpoint forcing mechanism e g pomeroy et al 2012 buckley et al 2018 on the reef flat h i g increases from the reef edge to the inner reef flat until to its peak then it declines all the way to the lagoon such trend results from the excitation of resonant modes see section 4 in the lagoon h i g is found to be almost zero as for the alongshore variation of ig waves fig 7g h i g rises gradually from the side wall to the reef flat until to a location near the channel where it begins to drop when the variation of h i g in the whole system is examined fig 8 c it is evident that the maximum h i g appears at central inner reef flat we subsequently investigate the variations of h t h s s and h i g at the aforementioned sampling locations g9 g12 g13 and g24 on the reef flat g15 in the lagoon for all test irregular wave conditions fig 9 similar to h for regular waves h t and h s s on the reef flat g9 g12 g13 and g24 and in the lagoon g15 increase with the increase of h 0 and h r fig 9a c d and f and those from inner reef flat locations g12 g13 and g24 are also not very sensitive to the variation in t fig 9b and e as for h i g it increases with the increase of h 0 fig 9g meanwhile h i g on the reef flat generally rises with the increase of t when t is relatively small but the trend varies among different reef flat locations g12 g13 and g24 as t further increases from 2 5 s to 3 s fig 9h depending on the reef flat positions h i g on the reef flat reaches its maximum at the intermediate h r g12 and g24 or largest h r g13 fig 9i the variations of h i g with both t and h r can be explained by the excitation of different resonant modes as will be discussed in section 4 for wave induced setup in the in the reef lagoon channel system under both regular and irregular waves zheng et al 2020 has shown that the maximum wave setup occurs at the end of surf zone around the mid reef flat wave setup also decreases from the mid reef flat into the lagoon this cross shore wave setup reduction over the reef creates a pressure gradient on the reef flat that drives an onshore current from the reef flat into the lagoon wave setup also drops dramatically from the central reef to the channel the alongshore pressure gradient drives relatively weaker alongshore current from the reef flat to the channel meanwhile the maximum wave setup on the reef flat increases with the increase of h 0 but decreases with the increase of h r however its variation with t is less pronounced these observations are generally consistent with laboratory studies for the reef systems with a rip channel e g gourlay 1996 yao et al 2018a 3 2 wave spectrum evolution in the reef lagoon channel system in this section the evolution of wave spectrum in the system is explored for both regular and irregular waves based on the representative wave condition above sampling locations at offshore g1 on the fore reef slope g6 in the channel g38 together with the previously investigated locations on reef flat g9 g12 g13 and g24 and in the lagoon g15 are chosen for demonstration for regular waves fig 10 most incident wave energy at offshore g1 is from the fundamental harmonic waves but there is also some energy associated with the second harmonics which is a typical feature of the stokes waves as wave shoals on the fore reef slope g6 and in the surf zone g9 higher harmonics as well as low frequency waves are generated due to the nonlinear wave wave interaction nwogu and demirbilek 2010 this kind of nonlinear interaction transfers wave energy to super harmonics sub harmonics through summation subtraction at multiples of the peak frequency behind the surf zone on the central reef flat g12 both the fundamental and higher harmonics are significantly damped but the low frequency waves are almost unvaried there are also almost no changes in wave spectra at further inshore location g13 and alongshore location g24 more energy at the fundamental frequency can be found in the deeper lagoon g15 which is contributed by waves coming from the channel wave spectrum in the channel g38 generally matches that from the offshore location g1 as for irregular waves fig 11 more wave energy within the ig band is found at the fore reef slope g6 than that at the offshore location g1 because of the shoaling bound waves and reflected ig waves previously mentioned and the generation of higher frequency waves is not obvious from the surf zone g9 to the central reef flat behind the surf zone g12 almost all ss wave energy is damped by wave breaking while ig wave energy increases as a result of the aforementioned breakpoint forcing mechanism in accordance with fig 4c the maximum ig wave energy is found on the central reef flat after comparing the spectrum from g12 to that from a location further shoreward g13 in the lagoon the ss wave energy is larger than that on the reef flat similar to the regular waves however there is almost no ig wave energy in the lagoon which is also consistent with fig 8c in the channel g38 wave spectrum follows that from the offshore g1 except for a lower energy level within the ss band 3 3 variation of wave run up on the back reef slope wave run up defined as the vertical distance between the moving shoreline and the still water level is directly related to the coastal inundation it consists of a steady wave setup η r and an unsteady swash due to ss and ig motions the present 2dh reef configuration provides us an opportunity to examine the alongshore variation of wave run up on the back reef beach the cumulative distribution functions of the wave run ups at the five alongshore sampling locations r1 r5 for both wave types fig 12 a and b indicate that wave runups are more dispersive for irregular waves as well as for the locations around the channel among the three reef flat locations r1 r3 similar runup distribution can be found and the largest exceedance probability of wave run up is generally found at r2 for both regular and irregular waves fig 13 a and b present the wave run up values at the five alongshore sampling locations r1 r5 for the regular waves using the maximum wave run up r max extracted from fig 12a and irregular waves using the 2 exceedance level of wave run up r 2 extracted from fig 12b respectively under the aforementioned representative wave condition for both types of waves a peak value of r max or r 2 can be found at the most central reef location r2 among the reef flat locations r1 r3 a further examination of wave run up components ss swash motion s s s ig swash motion s i g and wave setup η r indicates that such behavior of wave run up is primarily attributed by the alongshore variations of s s s for regular waves and both s s s and s i g for irregular waves greater s s s appears at r2 is possibly due to an additional contribution of incident waves with oblique incidence from the channel to the reef flat which is visible during our experiments while a larger s i g at r2 is consistent with the alongshore variation of ig wave height that can be observed in fig 8c consequently the percentage contribution to r max at r2 is 51 2 from ss motions 21 0 from ig motions and 27 8 from wave setup while for r 2 it is 45 0 from ss motions and 36 3 from ig motions 18 7 from wave setup the latter disagrees with the wave flume experiments of buckley et al 2018 in which ss wave motions are found to be less important this can also be explained by the fact that some ss wave energy comes directly from the channel in our experiments meanwhile both r max and r 2 increase notably around the channel r4 and r5 which is more evident to be caused by the incoming ss waves in the channel the variations of r max and r 2 at the alongshore sampling locations r1 r5 with h 0 t and h r are given by figs 14 and 15 respectively since wave run up in this study is dominated by ss and ig wave motions rather than the wave setup as discussed above r max and r 2 generally increase with the increasing h 0 figs 14a and 15a in that the total wave height i e h in fig 6a and h t in fig 9a which is a combination of ss and ig wave heights increases with the increase of h 0 however the variations of r max and r 2 for the reef flat locations r1 r3 fluctuate with the increase of t figs 14b and 15b which are attributed to the resonant modes excited with different t see section 4 for details meanwhile both r max and r 2 increase with the increase of h r figs 14c and 15c which are contributed by the rise of the total wave height with h r figs 6c and 9c 4 a discussion on wave spectrum within the ig band and wave resonance on the reef flat transmitted incoming waves can be reflected from the back reef slope the reflected outgoing waves are superposed by the incoming waves thus producing a standing wave pattern with nodes and antinodes when standing wave node and antinode are located at the reef edge and shoreline respectively wave resonance in this open ended basin system occurs fig 16 a following buckley et al 2018 the natural frequencies for this resonant system be calculated by 2 f n 1 4 2 n 1 0 l t o t a l 1 g h r x η x d x 1 n 0 1 2 where f n is the natural frequency of the n th resonant mode h r x and η x are the water depth and the mean water level respectively at location x across the reef profile l t o t a l is the cross shore reef flat width l r plus the cross shore lagoon width l l in this study and g is the gravitational acceleration wave trapping may also occur when incoming and outgoing waves are reflected at the fore reef edge and back reef edge respectively due to the rapid depth changes that occur on the steep fore reef slope and in the lagoon see e g dean 1964 forming another standing wave pattern when two nodes of these standing waves match the two edges of the reef flat wave resonance in this open basin system occurs fig 16b the natural frequencies for this resonant system be calculated by 3 f n 1 2 n 1 0 l r 1 g h r x η x d x 1 n 0 1 2 yao et al 2019b has revealed that resonant modes can also be excited in the closed lagoon if the lagoon is sufficiently wide fig 16c however our lagoon width is only about one third of the reef flat width thus its theoretical resonant frequencies generally fall outside the ig band in this study the ig wave spectra at the sampling locations along the cross shore central reef transect i e a a in fig 2b subjected to irregular wave conditions h 0 0 06 m and h r 0 04 m with different wave periods t are first investigated energy peaks within the ig band can be found around the resonant modal frequencies on the reef flat fig 17 a d those peaks cannot been found in the spectrum of incident waves when t is greater than 1 5 s which means they are not brought from the offshore thus they can be used to explain the maximum ig wave distribution on the reef flat such as that observed in fig 8c for such wave periods fig 17c d it seems that the fundamental n 0 and first n 1 modes are more energetic for the reef flat closed basin while the first n 1 and the second n 2 modes are more energetic for the reef lagoon open ended basin furthermore energy amplification around the fundamental n 0 modal frequency of the open ended basin can be found in the wave run up spectra and such kind of amplification appears to increase with the increasing t subsequently the effects of reef flat water level h r on the ig wave spectra along the cross shore central reef transect are investigated similar to the effects of wave period above higher modes n 0 are excited on the reef flat for both the reef flat closed basin and the reef lagoon open ended basin such excitation at the middle reef flat is more stronger with the intermediate reef flat water level of 0 04 m fig 18 b than with higher wave levels of h r 0 04 m and 0 1 m fig 18a and c this can account for the observation in fig 9i that the ig wave height reaches its peak at g12 when h r 0 04 m meanwhile the amplification of wave energy around the fundamental n 0 modal frequency of the open ended basin in the run up spectra is found to increase with the increase of h r this trend is generally consistent with previous field observations e g becker et al 2016 péquignet et al 2009 and laboratory measurements e g buckley et al 2018 due to the presence of the channel in this study zheng et al 2020 has shown that wave setup produced by breaking waves drives a mean current across the reef flat through the lagoon and exiting from the channel is the dominant hydrodynamic process in this reef lagoon channel system such kind of circulation has also been found by rey 2019 who performed numerical simulations using the xbeach non hydrostatic model to investigate the influences of reef alongshore geometry on wave runup rey 2019 also found that both long waves and wide channels tend to cause a dual peak runup system with a second peak inside the channel which is very similar to the variation of measured wave runup in this study fig 13b the simulations also suggested that such processes as wave current interaction refraction and diffraction due to the presence of a channel lead to a focusing of wave energy next to the channel thus the ig component of such kind of alongshore energy contribution combined with our identified cross shore reef flat closed basin oscillation fig 16b is believed to be able to explain the maximum ig wave height located around the central reef flat as we found in fig 8c we finally remark that the alongshore variation of ig wave energy on the reef flat in fig 8c is also possibly affected by the presence of edge waves in a 2dh reef configuration e g su and ma 2018 however the sampling locations in the current laboratory setup are not sufficient to support an analysis of such alongshore propagating waves and this issue needs to be further investigated via a numerical model the lack of directional spreading in the wave generation of this study may result in slightly overestimation the ig wave forcing and thus increase ig wave energy generation in the reef system see e g masselink et al 2019 5 conclusions a set of innovative laboratory experiments is carried out in a wave basin to investigate the wave transformation and run up in a 2dh reef lagoon channel system both regular and irregular waves are tested with an idealized physical model results show that incident wave height reduces significantly when waves propagate over the reef flat and into the lagoon there is almost no alongshore variation of total wave height on the reef flat except for the area very close the channel transmitted ss wave height on the reef flat rises with both increasing incident wave height and reef flat water level but it is not very sensitive to the wave period ig wave height is found to be largest at the central inner reef flat and it is insignificant in the lagoon ig wave height on the reef flat also increases with the increase of incident wave height but its dependence on wave period or reef flat water level varies spectral analysis indicates that wave energy is shifted to both low frequency waves and higher harmonics when regular waves transform on the reef flat while ig wave energy is generated and amplified on the reef flat associated with the irregular wave transformation the alongshore peak wave run up appears on the cross shore central reef transect and it is primarily contributed by ss motions for regular waves and by both ss and ig motions for irregular waves the incident wave height wave period and reef flat water level affect the wave run up behind the reef flat in a similar manner to the ss waves on the reef flat a detailed analysis of the cross shore evolution of wave spectrum within the ig band suggests that oscillation modes in both the reef lagoon and reef flat resonant systems are excited resulting in amplification of ig wave energy on the reef flat and at the shoreline the number and magnitude of resonant modes vary with different wave periods and reef flat water levels laboratory dataset reported in this study could also be potentially used to validate the analytical or numerical models developed for modeling coral reef hydrodynamics the variations of reef morphology reef lagoon channel geometry reef bathymetry etc and surface roughness may also affect the conclusions drawn in this study to a more or less degree the alongshore wave dynamics needs to be further investigated via numerical simulations future studies can be directed to these issues credit authorship contribution statement yu yao conceptualization methodology validation formal analysis investigation data curation writing original draft writing review editing visualization funding acquisition supervision songgui chen methodology validation formal analysis investigation data curation writing original draft writing review editing visualization jinhai zheng conceptualization methodology formal analysis writing original draft writing review editing supervision project administration funding acquisition supervision qiming zhang formal analysis investigation resources visualization writing review editing shubin chen validation formal analysis investigation data curation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported financially by the national science fund for distinguished young scholars grant no 51425901 the national natural science foundation of china grant nos 51679014 and 51979013 the scientific research fund of hunan provincial education department china grant no 18a116 young elite scientist sponsorship program by the china association for science and technology grant no 2018qnrc001 research funds for the central universities grant no tks190201 and the special research funding of state key laboratory of hydrology water resources and hydraulic engineering 20195025812 
21568,numerical simulation of the propagation of pressure waves in water during the collapse of a spherical air cavity irina v morenko institute of mechanics and engineering frc kazan scientific center russian academy of sciences russian federation institute of mechanics and engineering frc kazan scientific center russian academy of sciences russian federation institute of mechanics and engineering frc kazan scientific center russian academy of sciences russian federation numerical simulation of the collapse of a spherical gas cavity in a liquid under the influence of a pressure drop is performed the unsteady motion of a viscous compressible fluid is described by the equations of continuity momentum and energy supplemented by menter s sst model the vof approach was used to track the interface of the gas liquid multiphase flow the problem was solved using openfoam software comparison of the obtained results with the known data of other authors was carried out in experiments the initial radius of the spherical cavity varied from 0 01 to 0 09 m and the gas pressure varied from 0 05 to 0 5 mpa at a constant liquid pressure of 7 mpa the dependences of the radius of the gas cavity the velocity of the interface and turbulent kinetic energy on time were obtained and the shape of the cavity during the implosion process was calculated the influence of the gas pressure and the radius of the spherical cavity at the initial time on the maximum pressure at the control point was analyzed graphical abstract keywords collapse of spherical air cavity vof pressure wave 1 introduction the dynamics of the gas and vapor gas cavity in a liquid is of scientific and practical interest due to the use of various physical effects in the development of new technologies when a gas cavity collapses the density of the medium pressure and temperature change over a wide range at small characteristic time intervals and reach high values at its center during the final compression stage and rarefaction and compression waves propagate in the liquid the collapse of a spherical cavity in an incompressible fluid was first investigated by rayleigh 1917 and a mathematical model for calculating the radius of the cavity during its compression was developed isaacs and maxwell 1952 and urick 1963 proposed the use of an implosion signaling device for measuring sea depths the collapse of a spherical cavity in a compressible and incompressible fluid was studied by hunter 1960 zababakhin and zababakhin 1988 zel dovich and raizer 2002 and others hunter 1960 found a self similar solution for post collapse flow in the case of spherical symmetry an extensive amount of research has been devoted to the collapse of a small vapor bubble with a diameter of approximately 50 500 μ m the main purpose is to study the conditions of occurrence of sonoluminescence and sonochemical reactions margulis 2000 brenner et al 2002 heating of vapors inside the bubble and their ionization are used to initiate and accelerate chemical reactions converging to a well defined focus shock waves allow the synthesis of new materials with desired characteristics okitsu and cavalieri 2018 in addition the collapse of the vapor gas cavity is one of the stages of the cavitation process yasui 2018 mao et al 2018 the shock wave emission from collapsing cavitation bubbles situated in a liquid of infinite extent or near boundaries has been studied in many papers brujan et al 2012 wijngaarden 2016 shaw and spelt 2010 cavitation effects are used in soldering tinning dispersion and cleaning the surface of parts however cavitation can lead to the destruction of equipment elements changes in their hydrodynamic characteristics and decreases in equipment productivity and efficiency of its operation at the same time understanding the processes helps to minimize the negative impact of cavitation modern minimally invasive treatments are being introduced into medicine such as lithotripsy pishchalnikov et al 2003 for the destruction of stones shock wave therapy in tumors and infectious diseases and ultrasonic phacoemulsification of cataracts brennen 2015 similar in nature physico chemical results occur in a number of effects of other physical nature such as laser cavitation hydrodynamic cavitation electrohydraulic explosion and mechanical impact on the suspension of bubbles in a liquid in hydrodynamic cavitation noise is a set of pressure emissions caused by the slamming of cavities formed in vortices behind a streamlined body according to the initiation method all processes can be divided into those with periodic effects for example acoustic cavitation and single exposure such as hydrodynamic cavitation in a flow laser cavitation electrohydraulic explosion and hydraulic shock with a single exposure a cavity can be created in the process of exposure and introduced into a liquid kamran et al 2013 observed two types of bubble behavior depending on its initial radius and external driving pressure namely weakly oscillating and strongly collapsing the problem of the collapse of a vapor gas cavity in a liquid has been repeatedly considered by different authors in the last century it remains relevant today neppiras 1980 and avdeev 2016 wrote excellent reviews highlighting various aspects of bubble dynamics many current mathematical models describe the dynamics of a spherical bubble they can be divided into two classes one that considers the dynamics of a bubble in an incompressible liquid and a second that takes into account the effects of the compressibility of the liquid additional factors such as viscosity surface tension heat transfer and others may be considered in each class it should be noted that most theoretical studies on the dynamics of the vapor cavity are based on the rayleigh plesset equation and its modifications when studying the dynamics of a gas cavity with a relatively large radius approximately 0 01 0 1 m attention is usually paid not to the processes inside the air cavity but to the propagation of waves in the surrounding liquid the rapid destruction of the solid structural shell that occurs when the hydrostatic pressure exceeds the structure s critical deformation pressure is called underwater implosion a pressure pulse is generated in the surrounding liquid the study of the implosion of shell structures that are filled with low pressure gas and located in high pressure water is of practical interest for designing underwater structures pipelines and hydraulic equipment resistant to implosion and for assessing possible damage to nearby structures due to pressure generated water waves in the implosion the structural shell plays a key role in the process of collapse gupta et al 2014 the complex interaction of the structural shell and the fluid acting on it determines the implosion dynamics typically in physical experiments implosion chambers are thin walled glass spheres turner 2007 and cylindrical shell metal structures gupta et al 2014 shukla et al 2018 ikeda et al 2013 farhat et al 2013 gupta et al 2015 or composite materials pinto and shukla 2015 the results of numerical calculations of the implosion process of a thin walled glass sphere were obtained by farhat et al 2008 using aero f software and by turner 2007 using dynamic system mechanics advanced simulation dysmas software bubble implosion problem was studied numerically using openfoam software package in morenko 2019b d and moezzi rafie and nasiri 2018 previous simulations of the implosion process have focused on test calculations morenko 2019b d and particular aspects of the process and pressure and the temperature inside the bubble moezzi rafie and nasiri 2018 analysis of the literature shows that despite the large number of studies on the dynamics of a gas cavity some aspects such as the propagation of pressure waves in a liquid remain poorly understood the aim of this work is to study the dynamics of a spherical cavity that contains gas in a viscous compressible liquid and the propagation of the compression and rarefaction waves in the liquid when the cavity collapses under the influence of a pressure drop the results of a parametric study of the problem are presented this study indicates in detail how the radius of the gas cavity and the initial gas pressure affect the propagation of pressure waves in the liquid the degree of cavity compression the velocity of interface and the turbulent kinetic energy the form of the interface in different phases of the process is shown 2 mathematical model this study s geometric parameters and conditions are given by analogy with prior experimental work turner 2007 in general when modeling an implosion process the coupled problems of elastic plastic deformation or destruction of the shell of a low pressure chamber and the aerodynamic problem of compressing a gas cavity and propagating rarefaction and compression waves in a two phase medium must be solved the properties of the shell material and the construction of the implosion shell structures significantly affect the wave propagation process to select the right shell construction for a particular application it is important to know the hydrodynamic characteristics and detailed process data in the absence of a shell the numerical simulation can compensate for the shortcomings of the experimental technique by providing detailed information about the process in this paper the collapse of a single gas sphere in a liquid is investigated a cylindrical reservoir with a height of 3 65 m and a radius of 0 76 m is filled with water fig 1 on the left the hydrostatic pressure of the liquid is p l 0 6 996 mpa a spherical cavity containing gas is placed in the center of the reservoir the radius of the cavity at the initial time is r 0 0 038 m the gas pressure is equal to p g 0 0 101 mpa in the simulation the glass sphere is assumed to be destroyed instantly and the problem of destruction of the low pressure chamber s shell is not considered in addition possible liquid evaporation and vapor condensation at the interface are not taken into account the solution of the rayleigh plesset equation and its modifications allows us to obtain data on the pressure density temperature and changes in the radius of the bubble during collapse in this paper the unsteady motion of a viscous compressible fluid is described by the equations of continuity momentum and energy supplemented by menter s sst model the vof approach was used to track the interface of the gas liquid multiphase flow this model allows us to take into account the viscosity thermal conductivity compressibility of the fluid surface tension turbulence and obtain detailed data during the collapse process such as velocity pressure density temperature turbulent kinetic energy analyze the propagation of compression and rarefaction waves and the evolution of the cavity shape the eulerian continuum approach is used to describe the motion of a two phase flow the advantage is solving equations of the same type for both phases gas and liquid and accordingly a single numerical algorithm determining the position of the interface is necessary to study the collapse process the volume of fluid method hirt and nichols 1981 has recently been widely used to calculate free surface flows morenko 2019c a a two phase medium that consists of liquid and gas phases is considered α denotes the volume fraction of the liquid phase in the computational domain s cells in each cell of the calculation domain the marker function is defined as follows α 1 liquid phase 0 1 interface 0 gas phase the thermophysical properties of the medium are calculated from the corresponding values of the liquid index l and gas index g parameters using the marker function α the density ρ ρ l α ρ g 1 α the dynamic viscosity μ μ l α μ g 1 α the specific heat at constant pressure c p c p l α c p g 1 α and the thermal conductivity λ λ l α λ g 1 α the cavity is assumed to contain a perfect gas the equations of state of the gas and liquid are written as 1 ρ g p g r g t ρ l ρ l 0 p l r l t where the values r g r l and ρ l 0 are constants fluid motion caused by compression and expansion of the cavity is assumed to be turbulent a mathematical model to describe the unsteady non isothermal motion of a viscous compressible fluid includes the following equations the continuity equation is written as 2 ρ t ρ u 0 the momentum equation is written as 3 ρ u t ρ uu p μ e f f u σ κ α the advection equation for determining the position of the free surface is 4 α t α u 1 α α u r 0 the energy equation is written as 5 ρ t t ρ u t γ μ p r μ t p r t t α c v l 1 α c v g ρ k t ρ u k u p where u is the averaged velocity vector t is the time p is the average pressure μ e f f μ μ t is the effective viscosity μ t is the turbulent viscosity κ n is the free surface curvature n α α is the unit normal to the interface σ is the surface tension coefficient t is the average temperature γ is the ratio of the specific heats c p c v p r μ c p λ is the prandtl number p r t is the turbulent prandtl number k u 2 2 is the specific kinetic energy and c v is the specific heat at a constant volume the term 1 α α u r was originally proposed by weller 2008 to improve sharpness of interface the term only active in the interface region where 1 α α 0 the relative velocity in the direction of phase gradient is computed as u r ζ u n where ζ is the coefficient ubbink 1997 for the closure of eqs 1 5 menter s shear stress transport sst turbulence model menter 1994 is used the sst model includes equations for the turbulence kinetic energy k and the dissipation rate of the eddies ω the initial and boundary conditions are given as follows at the initial time t 0 the values of the velocity components are zero u 0 there is no movement and the temperature of the fluid t t 0 in the area occupied by the liquid ω l α 1 the pressure is uniform and equal p p l 0 and in area ω g filled with gas α 0 and p p g 0 on the surface of the reservoir γ w the no slip condition the temperature is written as u γ w 0 p n γ w 0 α n γ w 0 t γ w t 0 k γ w 0 and ω γ w 10 6 ν β 1 d 1 2 where β 1 0 075 d 1 is the distance to the first cell centroid from the wall and n is the unit normal on the faces of cylindrical sector γ s the neumann boundary conditions are written as u i n γ s 0 p n γ s 0 α n γ s 0 t n γ s 0 k n γ s 0 and ω n γ s 0 the computational domain used is in the form of a cylindrical sector fig 1 on the right eqs 1 5 with initial and boundary conditions are solved via the finite volume method fvm using the openfoam http www openfoam com with license gnu gpl open integrable platform for the numerical simulation of continuum mechanics problems using the gaussian method the integrals over the control volume are reduced to the surface discrete values of the velocity and pressure are calculated at the centers of the grid cells the coupling between the pressure and the velocity is dealt with using the transient pimple algorithm which is a hybrid of the piso and simple algorithms the transient terms with the euler scheme gradients with the gaussian linear method divergences with the gaussian van leer scheme and laplacians with the gaussian linear uncorrected technique were discretized to solve the system of equations for the pressure the conjugate gradient method with the geometric agglomerated algebraic multigrid preconditioner gamg was used the preconditioned bi conjugate gradient pbicg method was used to solve for the velocity the time step δ t was used in the calculation process so that the courant number c o for all of the cells in the computational domain did not exceed 0 01 the courant number of the cell c o δ t u δ x was determined by the fluid velocity u through the cell and the cell size δ x in the direction of the velocity 3 results and discussion 3 1 gas and liquid properties the following thermophysical properties of the gas are specified ν g 1 46 10 5 m 2 s c p g 1006 j kg k and λ g 0 024 w m k the liquid properties are ρ l 0 10 3 kg m 3 ν l 10 6 m 2 s c p l 4182 j kg k and λ l 0 6 w m k r g 287 j kg k r l 3000 j kg k and σ 0 07 n m at the initial time t 0 the gas pressure is considered uniform and equals p g 0 0 1013 mpa the fluid pressure is p l 0 6 996 mpa and the temperature is t 0 300 k 3 2 grid convergence in an experimental study turner 2007 three pressure sensors were located at a distance of 0 1016 m from the center of the sphere in the horizontal plane before the basic calculations the influence of the number of partitions in the computational domain on the local parameters at the control point is estimated the reference point is located at the same distance from the center of the sphere as the pressure sensors in the physical experiment the number of nodes in the radial axial and tangential directions for different meshes is m 1 100 200 1 m 2 200 300 1 m 3 250 340 1 and m 4 300 400 1 the results of numerical studies of mesh convergence are presented in table 1 where p min and p max are the minimum and maximum pressure at the control point respectively and δ t t 2 t 1 is the time interval between times t 1 and t 2 when the minimum and maximum pressure are recorded at the control point as shown in table 1 the local calculated parameters obtained on mesh m 3 differ by less than 1 from the corresponding parameters obtained on mesh m 4 fig 2 illustrates the pressure wave obtained on converging meshes m 1 m 2 m 3 and m 4 mesh m 3 is used for further calculations 3 3 comparison of numerical results with experiment and the numerical calculations of other authors to assess the reliability of the results of this work the calculated data are compared with the data from a physical experiment turner 2007 and the numerical calculations of other authors are performed using aero f farhat et al 2008 and dynamic system mechanics advanced simulation dysmas software turner 2007 table 2 the obtained values of the pressures p min and p max and the interval δ t are in better agreement with the numerical results farhat et al 2008 the rarefaction wavelength observed in the experiment turner 2007 is longer than the calculated wavelength and the pressure drop at the initial stage occurs more smoothly the difference is because during the numerical simulation the destruction time of a thin walled glass sphere is not taken into account one of the important characteristics of the cavity dynamics that can be controlled experimentally and by calculation is the duration of the cavity collapse the dynamics of a cavitation bubble are described using the rayleigh plesset equation by plesset 1949 and yasui 2015 6 r d 2 r d t 2 3 2 d r d t 2 1 ρ p g p v p 0 p t 2 σ r 4 μ l r d r d t which takes into account the viscosity surface tension gas p g vapor p v pressure and external variable pressure p t the collapse time of a spherical cavity is determined by integrating eq 6 according to rayleigh 1917 the cavity collapse time is 7 τ 0 915 r 0 ρ l 0 p l 0 p g 0 for the given input parameters the cavity collapse time calculated using eq 7 is τ 0 420 ms and according to the numerical experiment the time is τ 0 424 ms thus the cavity collapse time calculated using the volume of fluid method and by integrating the rayleigh plesset equation agrees well a comparison of the obtained dependence of the dimensionless cavity radius on the dimensionless time with the study data kyriazis et al 2017 is shown in fig 3 a similar modeling methodology based on the volume of fluid approach was tested on the problem of collapse of a liquid column in a tank additionally in morenko 2019c a 3 4 influence of pressure drop and initial radius on the cavity collapse the velocity pressure density and temperature fields are calculated the pressure fields in the process of implosion of a spherical gas cavity in a liquid are shown in fig 4 at the initial time t 0 ms the fluid is stationary under the influence of the pressure drop δ p p l 0 p g 0 the liquid rushes to the center of the spherical cavity the gas cavity has a very high compression because during collapse the flow of the surrounding liquid is directed into a small region giving rise to a strong energy focusing in the compression phase of the gas cavity the density pressure and temperature of the gas increase the rarefaction wave propagates from the interface in the liquid t 0 30 ms at the moment when the volume of the cavity reaches its minimum value the liquid suddenly stops and a spherical compression wave is generated at this point the gaseous contents of the cavity act as a spring which leads to the expansion of the cavity both wave propagation and fluid motion are observed in this process the compression wave propagates radially in the liquid to the walls of the tank t 0 45 0 70 and 1 00 ms in this case the maximum pressure significantly exceeds the initial hydrostatic p l 0 the maximum pressure decreases as the wave moves from the center to the periphery reaching the wall the compression wave is reflected from it t 1 50 ms the first cycle is followed by the second cycle of the implosion process the pressure drops again and then another compression wave appears however the most interesting effects occur during the air cavity s first compression expansion cycle since the amplitude of changes in pressure density and temperature is maximal secondary pulsations are less intense the amplitude of the oscillations of the thermodynamic parameters decreases so the pressure amplitude during the passage of the second compression wave is 12 of the amplitude of the first wave at the control point at the end of the process the liquid gas system comes into hydrostatic equilibrium the conducted numerical studies in contrast to the physical experiment obtained detailed data on the dynamics of the cavity and the propagation of the rarefaction and compression waves to calculate the velocity pressures and temperature fields and track the position of the interface at different times a series of numerical calculations was carried out in which the initial radius r 0 of the spherical cavity varied from 0 01 to 0 09 m the initial gas pressure p g 0 varied from 0 05 to 0 5 mpa at a constant initial liquid pressure p l 0 zababakhin 1960 determined the critical reynolds number r e c 8 4 which determines the transition from the collapse of a vacuum cavity relatively slow to fast in a short period of time and with an unlimited increase in velocity in this paper the reynolds number calculated by the formula r e r 0 ν l p l 0 ρ l 0 varies from 0 84 10 6 to 7 53 10 6 and significantly exceeds the critical value of the reynolds number r e r e c as reported in nigmatulin et al 2014 the process of medium compression in a bubble can be either shockless in particular homogeneous or with the formation of converging waves and with the formation of radially converging shock waves in the bubble that are focused near the center of the bubble toegel and lohse 2018 showed that shock waves occur only under specially selected conditions under which a very high acceleration of the interphase boundary of the bubble is provided fig 5 illustrates the distribution of the density and pressure in a gas cavity and its small vicinity of a liquid in the final stage of collapse the shape of the interface is determined by the isosurface α 0 5 during the calculations the evolution of the radius of the spherical gas cavity during implosion is shown in fig 6 the liquid compresses the cavity under the influence of the pressure drop after reaching the minimum radius r min the rebound stage begins which is accompanied by an increase in the radius of the cavity to a value not exceeding r 0 the larger the initial radius r 0 of the cavity the longer the collapse time τ to estimate the depth of the collapse the dimensionless value of the minimum radius r min r 0 is calculated the value r min r 0 increases from 0 168 to 0 205 for the given parameters at p g 0 0 1013 mpa the radial velocity component of the interface during the collapse process is illustrated in fig 7 when the gas is compressed the boundary accelerates to the center of the cavity the velocity modulus reaches the maximum value then the speed abruptly changes sign to the opposite the growth of the volume of the gas cavity occurs with a simultaneous decrease in the velocity u r yasui 2018 noted that the acceleration of the interface is caused by two factors one is the inertia of the surrounding fluid which rushes toward the center of the cavity the other reason for the freely accelerating collapse is the geometry of a spherical collapse due to the conservation of mass the velocity of the liquid toward the center of a bubble increases as the distance from the center of a bubble decreases the compressibility of the liquid does not play a significant role in the initial stage of the cavity evolution at low collapse velocities koch et al 2016 if the collapse speed is comparable to the sound speed then the emitted acoustic energy is not small and the approximation of an incompressible fluid becomes inapplicable at the final stage of cavity compression when its radius is close to the minimum value considering the compressibility of the medium is important kamran et al 2014 found that taking into account the fluid compressibility is important in the formation of waves in the rebound stage which follows the collapse a gas can be considered an incompressible medium at mach numbers m 1 in the calculation of engineering problems m 0 3 zucker and biblarz 2002 in this paper the mach numbers m u c 0 calculated from the maximum value of the medium velocity modulus u 300 m s the sound speed in water c 0 1500 m s and in air 331 m s are equal 0 2 and 0 9 respectively turbulent kinetic energy k is one of the most important parameters characterizing turbulent motion kinetic energy is the sum of the kinetic energies of the fluctuation component of velocity u i in space directions k 1 2 u 1 2 u 2 2 u 3 2 1 2 u i u i calculations have shown that the turbulent kinetic energy increases sharply in the final stage of the cavity collapse at the interface fig 8 turbulent pulsations of the velocity pressure and temperature can contribute to distortions in the cavity s spherical shape small deviations from the spherical shape during evolution increase and lead to deformation of the interface at the end of the process a change in the shape of the gas cavity at different points in the collapse process is shown in fig 9 reducing the cavity volume is accompanied by accelerated movement of the interface of fluids with different densities and ends with a sharp braking of the interface a condition necessary for the development of rayleigh taylor instability arises the liquid particles rush to the gas cavity s center forming jets while the gas particles are outside the cavity s average current radius interface perturbations tend to increase over time fig 9 shows that by the end of the process t 2 0 ms the cavity has mushroom protrusions a detailed analysis of the development of the instabilities ofbirkhoff plesset plesset and mitchell 1956 and rayleigh taylor kull 1991 taking place during the collapse of a vapor bubble is given in nigmatulin et al 2014 the violation of the gas cavity s sphericity can be caused by other factors including small scale perturbations of the velocity field due to turbulent pulsations the presence of a cylindrical reservoir wall causing spherical asymmetry of the velocity field and pressure distribution and the effect of the reflected rarefaction and compression waves the viscosity of the medium and the force of surface tension can contribute to the stabilization of the cavity shape s spherical symmetry the effect of fluid viscosity on the dynamics of a single bubble is discussed in aghdama et al 2012 numerical simulations have shown that for a more detailed analysis of the shape the cavity should simulate the process in the whole area not just its sector this will require the use of a mesh with a significantly larger number of elements and consequently more computational time during the first stage of the process when the gas cavity is compressed a rarefaction wave moves in the liquid from the interface to the reservoir wall the wave front becomes less steep over time the motion of the compression wave in the second stage of the process is shown in fig 10 the maximum pressure decreases over time spherical wave spreads out from the cavity in the form of a spherical shell the surface area of a sphere is 4 π a 2 where a is sphere radius as the distance from the cavity increase the shell surface area increases thus for spherical waves the pressure decreases as the inverse of radial distance as the spherical compression wave propagates its surface and the amount of substance involved in the movement increase and the amplitude of the wave decreases in addition part of the energy of the wave motion is spent heating the layers of the medium through which it has passed zel dovich and raizer 2002 the wave front over time becomes wider and less steep in general when a compression wave propagates the maximum liquid pressure p max will depend on a number of factors including the physical properties of the gas and liquid the distance from the center of the cavity the initial radius r 0 of the cavity and the initial pressure of the gas p g 0 and liquid p l 0 the study of the influence of the initial pressure in the gas cavity on the main parameters of the implosion process was conducted in the case when the initial cavity radius is r 0 0 038 m if the initial air pressure in the cavity p g 0 increases from 0 05 to 0 5 mpa then the maximum pressure p max at the control point will decrease by 38 and the time t 2 during which it will be reached will increase by 6 the initial gas pressure in the spherical cavity also affects the degree of gas compression at the time when the liquid suddenly stops thus at the time of the air cavity s maximum compression its radius is 15 at 0 05 mpa and 27 of the initial value at 0 5 mpa with an increase in the initial radius of the spherical gas cavity by a factor of 9 from 0 01 to 0 09 m the maximum pressure of the compression wave recorded at the control point at a distance of 0 1016 m from the center of the cavity increases 5 32 times from 9 96 to 51 53 mpa and the time of the cavity collapse increases fig 11 shows that the larger the initial radius of the gas cavity the higher the maximum pressure at the control point other things being equal these dependences p max r 0 are close to linear for different initial gas pressure values the maximum pressure value at the control point monotonically decreases with the increasing initial gas pressure and accordingly with decreasing δ p p l 0 p g 0 fig 12 therefore the larger the initial radius r 0 of the gas cavity and the greater the pressure drop δ p p l 0 p g 0 at the initial time the higher the maximum pressure at the control point as a result of the numerical data analysis an approximation formula for calculating the maximum pressure p max mpa at a distance of l 0 1016 m from the center of the cavity depending on the initial radius r 0 of the air cavity and the initial gas pressure p g 0 is proposed 8 p max 200 8 p g 0 0 4 r 0 8 6 p g 0 0 3 eq 8 is obtained when air and water are used as the working media the radius of the spherical cavity varies in the range 0 01 r 0 0 09 m the initial pressure of the liquid is p l 0 6 996 mpa and the initial pressure p g 0 of the gas varies in the range from 0 05 to 0 5 mpa eq 8 shows the linear relationship for the maximum pressure and initial cavity radius and also the fact that the greater the pressure difference in the liquid and gas at the initial time the higher the values of the predicted peak pressure the results of a parametric study show that when the initial gas pressure decreases the collapse of the gas cavity becomes stronger the damage caused by the collapse can be estimated by comparing the maximum pressure with the maximum stress that the ocean equipment surface can withstand before rupture 4 conclusions to describe the dynamics of a gas cavity in a liquid and the propagation of waves when it collapses under the influence of a pressure drop a model of fluid motion is proposed based on the physical laws of conservation of mass momentum and energy taking into account the viscosity compressibility thermal conductivity and turbulence the fluid volume method is used to track the interface this approach obtains sufficiently complete information about the considered aerohydrodynamic process the presented mathematical model is a reliable tool for predicting implosion the simulation results showed that during the collapse of a spherical air cavity with a radius of 0 01 to 0 09 m and gas pressure from 0 05 to 0 5 mpa at a constant liquid pressure of 7 mpa duration of a typical implosion event is not more than one millisecond the sphericity of the gas cavity is disturbed during the implosion rayleigh taylor instability develops at the interface for a more detailed analysis of the shape of the cavity the process in the whole area and not just its sector should be simulated this requires the use of a mesh with a significantly larger number of elements and consequently more computational time this report demonstrated that when a gas cavity collapses in a liquid the compression wave follows the rarefaction wave moreover the peak pressure is much higher than the initial hydrostatic pressure with an increase in the initial radius of the spherical gas cavity by 9 times from 0 01 to 0 09 m the maximum pressure recorded at the control point at a distance of 0 1016 m from the cavity center increases by 5 32 times from 9 96 to 51 53 mpa and the collapse time of the cavity increases when the initial radius of the cavity is r 0 0 038 m an increase in the initial air pressure in the cavity from 0 05 to 0 5 mpa leads to a decrease in the maximum pressure at the control point by 38 and increases the time for which it is achieved by 6 in addition the initial pressure of the gas in the spherical cavity affects the degree of compression of the gas when the liquid suddenly stops thus at the time of the air cavity s maximum compression its radius is 15 at 0 05 mpa and 27 of the initial value at 0 5 mpa an approximation formula for calculating the maximum pressure during the propagation of a spherical compression wave in a liquid is obtained the practical significance of the obtained results lies in the possibility of predicting the hydrodynamic and thermal parameters of two phase media in the collapse of a gas cavity in a liquid the results of this study can also contribute to the development and improvement of technologies and applications based on the generation of pressure waves in the environment during the collapse of a spherical cavity declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by the government assignment for frc kazan scientific center of ras russia 
21568,numerical simulation of the propagation of pressure waves in water during the collapse of a spherical air cavity irina v morenko institute of mechanics and engineering frc kazan scientific center russian academy of sciences russian federation institute of mechanics and engineering frc kazan scientific center russian academy of sciences russian federation institute of mechanics and engineering frc kazan scientific center russian academy of sciences russian federation numerical simulation of the collapse of a spherical gas cavity in a liquid under the influence of a pressure drop is performed the unsteady motion of a viscous compressible fluid is described by the equations of continuity momentum and energy supplemented by menter s sst model the vof approach was used to track the interface of the gas liquid multiphase flow the problem was solved using openfoam software comparison of the obtained results with the known data of other authors was carried out in experiments the initial radius of the spherical cavity varied from 0 01 to 0 09 m and the gas pressure varied from 0 05 to 0 5 mpa at a constant liquid pressure of 7 mpa the dependences of the radius of the gas cavity the velocity of the interface and turbulent kinetic energy on time were obtained and the shape of the cavity during the implosion process was calculated the influence of the gas pressure and the radius of the spherical cavity at the initial time on the maximum pressure at the control point was analyzed graphical abstract keywords collapse of spherical air cavity vof pressure wave 1 introduction the dynamics of the gas and vapor gas cavity in a liquid is of scientific and practical interest due to the use of various physical effects in the development of new technologies when a gas cavity collapses the density of the medium pressure and temperature change over a wide range at small characteristic time intervals and reach high values at its center during the final compression stage and rarefaction and compression waves propagate in the liquid the collapse of a spherical cavity in an incompressible fluid was first investigated by rayleigh 1917 and a mathematical model for calculating the radius of the cavity during its compression was developed isaacs and maxwell 1952 and urick 1963 proposed the use of an implosion signaling device for measuring sea depths the collapse of a spherical cavity in a compressible and incompressible fluid was studied by hunter 1960 zababakhin and zababakhin 1988 zel dovich and raizer 2002 and others hunter 1960 found a self similar solution for post collapse flow in the case of spherical symmetry an extensive amount of research has been devoted to the collapse of a small vapor bubble with a diameter of approximately 50 500 μ m the main purpose is to study the conditions of occurrence of sonoluminescence and sonochemical reactions margulis 2000 brenner et al 2002 heating of vapors inside the bubble and their ionization are used to initiate and accelerate chemical reactions converging to a well defined focus shock waves allow the synthesis of new materials with desired characteristics okitsu and cavalieri 2018 in addition the collapse of the vapor gas cavity is one of the stages of the cavitation process yasui 2018 mao et al 2018 the shock wave emission from collapsing cavitation bubbles situated in a liquid of infinite extent or near boundaries has been studied in many papers brujan et al 2012 wijngaarden 2016 shaw and spelt 2010 cavitation effects are used in soldering tinning dispersion and cleaning the surface of parts however cavitation can lead to the destruction of equipment elements changes in their hydrodynamic characteristics and decreases in equipment productivity and efficiency of its operation at the same time understanding the processes helps to minimize the negative impact of cavitation modern minimally invasive treatments are being introduced into medicine such as lithotripsy pishchalnikov et al 2003 for the destruction of stones shock wave therapy in tumors and infectious diseases and ultrasonic phacoemulsification of cataracts brennen 2015 similar in nature physico chemical results occur in a number of effects of other physical nature such as laser cavitation hydrodynamic cavitation electrohydraulic explosion and mechanical impact on the suspension of bubbles in a liquid in hydrodynamic cavitation noise is a set of pressure emissions caused by the slamming of cavities formed in vortices behind a streamlined body according to the initiation method all processes can be divided into those with periodic effects for example acoustic cavitation and single exposure such as hydrodynamic cavitation in a flow laser cavitation electrohydraulic explosion and hydraulic shock with a single exposure a cavity can be created in the process of exposure and introduced into a liquid kamran et al 2013 observed two types of bubble behavior depending on its initial radius and external driving pressure namely weakly oscillating and strongly collapsing the problem of the collapse of a vapor gas cavity in a liquid has been repeatedly considered by different authors in the last century it remains relevant today neppiras 1980 and avdeev 2016 wrote excellent reviews highlighting various aspects of bubble dynamics many current mathematical models describe the dynamics of a spherical bubble they can be divided into two classes one that considers the dynamics of a bubble in an incompressible liquid and a second that takes into account the effects of the compressibility of the liquid additional factors such as viscosity surface tension heat transfer and others may be considered in each class it should be noted that most theoretical studies on the dynamics of the vapor cavity are based on the rayleigh plesset equation and its modifications when studying the dynamics of a gas cavity with a relatively large radius approximately 0 01 0 1 m attention is usually paid not to the processes inside the air cavity but to the propagation of waves in the surrounding liquid the rapid destruction of the solid structural shell that occurs when the hydrostatic pressure exceeds the structure s critical deformation pressure is called underwater implosion a pressure pulse is generated in the surrounding liquid the study of the implosion of shell structures that are filled with low pressure gas and located in high pressure water is of practical interest for designing underwater structures pipelines and hydraulic equipment resistant to implosion and for assessing possible damage to nearby structures due to pressure generated water waves in the implosion the structural shell plays a key role in the process of collapse gupta et al 2014 the complex interaction of the structural shell and the fluid acting on it determines the implosion dynamics typically in physical experiments implosion chambers are thin walled glass spheres turner 2007 and cylindrical shell metal structures gupta et al 2014 shukla et al 2018 ikeda et al 2013 farhat et al 2013 gupta et al 2015 or composite materials pinto and shukla 2015 the results of numerical calculations of the implosion process of a thin walled glass sphere were obtained by farhat et al 2008 using aero f software and by turner 2007 using dynamic system mechanics advanced simulation dysmas software bubble implosion problem was studied numerically using openfoam software package in morenko 2019b d and moezzi rafie and nasiri 2018 previous simulations of the implosion process have focused on test calculations morenko 2019b d and particular aspects of the process and pressure and the temperature inside the bubble moezzi rafie and nasiri 2018 analysis of the literature shows that despite the large number of studies on the dynamics of a gas cavity some aspects such as the propagation of pressure waves in a liquid remain poorly understood the aim of this work is to study the dynamics of a spherical cavity that contains gas in a viscous compressible liquid and the propagation of the compression and rarefaction waves in the liquid when the cavity collapses under the influence of a pressure drop the results of a parametric study of the problem are presented this study indicates in detail how the radius of the gas cavity and the initial gas pressure affect the propagation of pressure waves in the liquid the degree of cavity compression the velocity of interface and the turbulent kinetic energy the form of the interface in different phases of the process is shown 2 mathematical model this study s geometric parameters and conditions are given by analogy with prior experimental work turner 2007 in general when modeling an implosion process the coupled problems of elastic plastic deformation or destruction of the shell of a low pressure chamber and the aerodynamic problem of compressing a gas cavity and propagating rarefaction and compression waves in a two phase medium must be solved the properties of the shell material and the construction of the implosion shell structures significantly affect the wave propagation process to select the right shell construction for a particular application it is important to know the hydrodynamic characteristics and detailed process data in the absence of a shell the numerical simulation can compensate for the shortcomings of the experimental technique by providing detailed information about the process in this paper the collapse of a single gas sphere in a liquid is investigated a cylindrical reservoir with a height of 3 65 m and a radius of 0 76 m is filled with water fig 1 on the left the hydrostatic pressure of the liquid is p l 0 6 996 mpa a spherical cavity containing gas is placed in the center of the reservoir the radius of the cavity at the initial time is r 0 0 038 m the gas pressure is equal to p g 0 0 101 mpa in the simulation the glass sphere is assumed to be destroyed instantly and the problem of destruction of the low pressure chamber s shell is not considered in addition possible liquid evaporation and vapor condensation at the interface are not taken into account the solution of the rayleigh plesset equation and its modifications allows us to obtain data on the pressure density temperature and changes in the radius of the bubble during collapse in this paper the unsteady motion of a viscous compressible fluid is described by the equations of continuity momentum and energy supplemented by menter s sst model the vof approach was used to track the interface of the gas liquid multiphase flow this model allows us to take into account the viscosity thermal conductivity compressibility of the fluid surface tension turbulence and obtain detailed data during the collapse process such as velocity pressure density temperature turbulent kinetic energy analyze the propagation of compression and rarefaction waves and the evolution of the cavity shape the eulerian continuum approach is used to describe the motion of a two phase flow the advantage is solving equations of the same type for both phases gas and liquid and accordingly a single numerical algorithm determining the position of the interface is necessary to study the collapse process the volume of fluid method hirt and nichols 1981 has recently been widely used to calculate free surface flows morenko 2019c a a two phase medium that consists of liquid and gas phases is considered α denotes the volume fraction of the liquid phase in the computational domain s cells in each cell of the calculation domain the marker function is defined as follows α 1 liquid phase 0 1 interface 0 gas phase the thermophysical properties of the medium are calculated from the corresponding values of the liquid index l and gas index g parameters using the marker function α the density ρ ρ l α ρ g 1 α the dynamic viscosity μ μ l α μ g 1 α the specific heat at constant pressure c p c p l α c p g 1 α and the thermal conductivity λ λ l α λ g 1 α the cavity is assumed to contain a perfect gas the equations of state of the gas and liquid are written as 1 ρ g p g r g t ρ l ρ l 0 p l r l t where the values r g r l and ρ l 0 are constants fluid motion caused by compression and expansion of the cavity is assumed to be turbulent a mathematical model to describe the unsteady non isothermal motion of a viscous compressible fluid includes the following equations the continuity equation is written as 2 ρ t ρ u 0 the momentum equation is written as 3 ρ u t ρ uu p μ e f f u σ κ α the advection equation for determining the position of the free surface is 4 α t α u 1 α α u r 0 the energy equation is written as 5 ρ t t ρ u t γ μ p r μ t p r t t α c v l 1 α c v g ρ k t ρ u k u p where u is the averaged velocity vector t is the time p is the average pressure μ e f f μ μ t is the effective viscosity μ t is the turbulent viscosity κ n is the free surface curvature n α α is the unit normal to the interface σ is the surface tension coefficient t is the average temperature γ is the ratio of the specific heats c p c v p r μ c p λ is the prandtl number p r t is the turbulent prandtl number k u 2 2 is the specific kinetic energy and c v is the specific heat at a constant volume the term 1 α α u r was originally proposed by weller 2008 to improve sharpness of interface the term only active in the interface region where 1 α α 0 the relative velocity in the direction of phase gradient is computed as u r ζ u n where ζ is the coefficient ubbink 1997 for the closure of eqs 1 5 menter s shear stress transport sst turbulence model menter 1994 is used the sst model includes equations for the turbulence kinetic energy k and the dissipation rate of the eddies ω the initial and boundary conditions are given as follows at the initial time t 0 the values of the velocity components are zero u 0 there is no movement and the temperature of the fluid t t 0 in the area occupied by the liquid ω l α 1 the pressure is uniform and equal p p l 0 and in area ω g filled with gas α 0 and p p g 0 on the surface of the reservoir γ w the no slip condition the temperature is written as u γ w 0 p n γ w 0 α n γ w 0 t γ w t 0 k γ w 0 and ω γ w 10 6 ν β 1 d 1 2 where β 1 0 075 d 1 is the distance to the first cell centroid from the wall and n is the unit normal on the faces of cylindrical sector γ s the neumann boundary conditions are written as u i n γ s 0 p n γ s 0 α n γ s 0 t n γ s 0 k n γ s 0 and ω n γ s 0 the computational domain used is in the form of a cylindrical sector fig 1 on the right eqs 1 5 with initial and boundary conditions are solved via the finite volume method fvm using the openfoam http www openfoam com with license gnu gpl open integrable platform for the numerical simulation of continuum mechanics problems using the gaussian method the integrals over the control volume are reduced to the surface discrete values of the velocity and pressure are calculated at the centers of the grid cells the coupling between the pressure and the velocity is dealt with using the transient pimple algorithm which is a hybrid of the piso and simple algorithms the transient terms with the euler scheme gradients with the gaussian linear method divergences with the gaussian van leer scheme and laplacians with the gaussian linear uncorrected technique were discretized to solve the system of equations for the pressure the conjugate gradient method with the geometric agglomerated algebraic multigrid preconditioner gamg was used the preconditioned bi conjugate gradient pbicg method was used to solve for the velocity the time step δ t was used in the calculation process so that the courant number c o for all of the cells in the computational domain did not exceed 0 01 the courant number of the cell c o δ t u δ x was determined by the fluid velocity u through the cell and the cell size δ x in the direction of the velocity 3 results and discussion 3 1 gas and liquid properties the following thermophysical properties of the gas are specified ν g 1 46 10 5 m 2 s c p g 1006 j kg k and λ g 0 024 w m k the liquid properties are ρ l 0 10 3 kg m 3 ν l 10 6 m 2 s c p l 4182 j kg k and λ l 0 6 w m k r g 287 j kg k r l 3000 j kg k and σ 0 07 n m at the initial time t 0 the gas pressure is considered uniform and equals p g 0 0 1013 mpa the fluid pressure is p l 0 6 996 mpa and the temperature is t 0 300 k 3 2 grid convergence in an experimental study turner 2007 three pressure sensors were located at a distance of 0 1016 m from the center of the sphere in the horizontal plane before the basic calculations the influence of the number of partitions in the computational domain on the local parameters at the control point is estimated the reference point is located at the same distance from the center of the sphere as the pressure sensors in the physical experiment the number of nodes in the radial axial and tangential directions for different meshes is m 1 100 200 1 m 2 200 300 1 m 3 250 340 1 and m 4 300 400 1 the results of numerical studies of mesh convergence are presented in table 1 where p min and p max are the minimum and maximum pressure at the control point respectively and δ t t 2 t 1 is the time interval between times t 1 and t 2 when the minimum and maximum pressure are recorded at the control point as shown in table 1 the local calculated parameters obtained on mesh m 3 differ by less than 1 from the corresponding parameters obtained on mesh m 4 fig 2 illustrates the pressure wave obtained on converging meshes m 1 m 2 m 3 and m 4 mesh m 3 is used for further calculations 3 3 comparison of numerical results with experiment and the numerical calculations of other authors to assess the reliability of the results of this work the calculated data are compared with the data from a physical experiment turner 2007 and the numerical calculations of other authors are performed using aero f farhat et al 2008 and dynamic system mechanics advanced simulation dysmas software turner 2007 table 2 the obtained values of the pressures p min and p max and the interval δ t are in better agreement with the numerical results farhat et al 2008 the rarefaction wavelength observed in the experiment turner 2007 is longer than the calculated wavelength and the pressure drop at the initial stage occurs more smoothly the difference is because during the numerical simulation the destruction time of a thin walled glass sphere is not taken into account one of the important characteristics of the cavity dynamics that can be controlled experimentally and by calculation is the duration of the cavity collapse the dynamics of a cavitation bubble are described using the rayleigh plesset equation by plesset 1949 and yasui 2015 6 r d 2 r d t 2 3 2 d r d t 2 1 ρ p g p v p 0 p t 2 σ r 4 μ l r d r d t which takes into account the viscosity surface tension gas p g vapor p v pressure and external variable pressure p t the collapse time of a spherical cavity is determined by integrating eq 6 according to rayleigh 1917 the cavity collapse time is 7 τ 0 915 r 0 ρ l 0 p l 0 p g 0 for the given input parameters the cavity collapse time calculated using eq 7 is τ 0 420 ms and according to the numerical experiment the time is τ 0 424 ms thus the cavity collapse time calculated using the volume of fluid method and by integrating the rayleigh plesset equation agrees well a comparison of the obtained dependence of the dimensionless cavity radius on the dimensionless time with the study data kyriazis et al 2017 is shown in fig 3 a similar modeling methodology based on the volume of fluid approach was tested on the problem of collapse of a liquid column in a tank additionally in morenko 2019c a 3 4 influence of pressure drop and initial radius on the cavity collapse the velocity pressure density and temperature fields are calculated the pressure fields in the process of implosion of a spherical gas cavity in a liquid are shown in fig 4 at the initial time t 0 ms the fluid is stationary under the influence of the pressure drop δ p p l 0 p g 0 the liquid rushes to the center of the spherical cavity the gas cavity has a very high compression because during collapse the flow of the surrounding liquid is directed into a small region giving rise to a strong energy focusing in the compression phase of the gas cavity the density pressure and temperature of the gas increase the rarefaction wave propagates from the interface in the liquid t 0 30 ms at the moment when the volume of the cavity reaches its minimum value the liquid suddenly stops and a spherical compression wave is generated at this point the gaseous contents of the cavity act as a spring which leads to the expansion of the cavity both wave propagation and fluid motion are observed in this process the compression wave propagates radially in the liquid to the walls of the tank t 0 45 0 70 and 1 00 ms in this case the maximum pressure significantly exceeds the initial hydrostatic p l 0 the maximum pressure decreases as the wave moves from the center to the periphery reaching the wall the compression wave is reflected from it t 1 50 ms the first cycle is followed by the second cycle of the implosion process the pressure drops again and then another compression wave appears however the most interesting effects occur during the air cavity s first compression expansion cycle since the amplitude of changes in pressure density and temperature is maximal secondary pulsations are less intense the amplitude of the oscillations of the thermodynamic parameters decreases so the pressure amplitude during the passage of the second compression wave is 12 of the amplitude of the first wave at the control point at the end of the process the liquid gas system comes into hydrostatic equilibrium the conducted numerical studies in contrast to the physical experiment obtained detailed data on the dynamics of the cavity and the propagation of the rarefaction and compression waves to calculate the velocity pressures and temperature fields and track the position of the interface at different times a series of numerical calculations was carried out in which the initial radius r 0 of the spherical cavity varied from 0 01 to 0 09 m the initial gas pressure p g 0 varied from 0 05 to 0 5 mpa at a constant initial liquid pressure p l 0 zababakhin 1960 determined the critical reynolds number r e c 8 4 which determines the transition from the collapse of a vacuum cavity relatively slow to fast in a short period of time and with an unlimited increase in velocity in this paper the reynolds number calculated by the formula r e r 0 ν l p l 0 ρ l 0 varies from 0 84 10 6 to 7 53 10 6 and significantly exceeds the critical value of the reynolds number r e r e c as reported in nigmatulin et al 2014 the process of medium compression in a bubble can be either shockless in particular homogeneous or with the formation of converging waves and with the formation of radially converging shock waves in the bubble that are focused near the center of the bubble toegel and lohse 2018 showed that shock waves occur only under specially selected conditions under which a very high acceleration of the interphase boundary of the bubble is provided fig 5 illustrates the distribution of the density and pressure in a gas cavity and its small vicinity of a liquid in the final stage of collapse the shape of the interface is determined by the isosurface α 0 5 during the calculations the evolution of the radius of the spherical gas cavity during implosion is shown in fig 6 the liquid compresses the cavity under the influence of the pressure drop after reaching the minimum radius r min the rebound stage begins which is accompanied by an increase in the radius of the cavity to a value not exceeding r 0 the larger the initial radius r 0 of the cavity the longer the collapse time τ to estimate the depth of the collapse the dimensionless value of the minimum radius r min r 0 is calculated the value r min r 0 increases from 0 168 to 0 205 for the given parameters at p g 0 0 1013 mpa the radial velocity component of the interface during the collapse process is illustrated in fig 7 when the gas is compressed the boundary accelerates to the center of the cavity the velocity modulus reaches the maximum value then the speed abruptly changes sign to the opposite the growth of the volume of the gas cavity occurs with a simultaneous decrease in the velocity u r yasui 2018 noted that the acceleration of the interface is caused by two factors one is the inertia of the surrounding fluid which rushes toward the center of the cavity the other reason for the freely accelerating collapse is the geometry of a spherical collapse due to the conservation of mass the velocity of the liquid toward the center of a bubble increases as the distance from the center of a bubble decreases the compressibility of the liquid does not play a significant role in the initial stage of the cavity evolution at low collapse velocities koch et al 2016 if the collapse speed is comparable to the sound speed then the emitted acoustic energy is not small and the approximation of an incompressible fluid becomes inapplicable at the final stage of cavity compression when its radius is close to the minimum value considering the compressibility of the medium is important kamran et al 2014 found that taking into account the fluid compressibility is important in the formation of waves in the rebound stage which follows the collapse a gas can be considered an incompressible medium at mach numbers m 1 in the calculation of engineering problems m 0 3 zucker and biblarz 2002 in this paper the mach numbers m u c 0 calculated from the maximum value of the medium velocity modulus u 300 m s the sound speed in water c 0 1500 m s and in air 331 m s are equal 0 2 and 0 9 respectively turbulent kinetic energy k is one of the most important parameters characterizing turbulent motion kinetic energy is the sum of the kinetic energies of the fluctuation component of velocity u i in space directions k 1 2 u 1 2 u 2 2 u 3 2 1 2 u i u i calculations have shown that the turbulent kinetic energy increases sharply in the final stage of the cavity collapse at the interface fig 8 turbulent pulsations of the velocity pressure and temperature can contribute to distortions in the cavity s spherical shape small deviations from the spherical shape during evolution increase and lead to deformation of the interface at the end of the process a change in the shape of the gas cavity at different points in the collapse process is shown in fig 9 reducing the cavity volume is accompanied by accelerated movement of the interface of fluids with different densities and ends with a sharp braking of the interface a condition necessary for the development of rayleigh taylor instability arises the liquid particles rush to the gas cavity s center forming jets while the gas particles are outside the cavity s average current radius interface perturbations tend to increase over time fig 9 shows that by the end of the process t 2 0 ms the cavity has mushroom protrusions a detailed analysis of the development of the instabilities ofbirkhoff plesset plesset and mitchell 1956 and rayleigh taylor kull 1991 taking place during the collapse of a vapor bubble is given in nigmatulin et al 2014 the violation of the gas cavity s sphericity can be caused by other factors including small scale perturbations of the velocity field due to turbulent pulsations the presence of a cylindrical reservoir wall causing spherical asymmetry of the velocity field and pressure distribution and the effect of the reflected rarefaction and compression waves the viscosity of the medium and the force of surface tension can contribute to the stabilization of the cavity shape s spherical symmetry the effect of fluid viscosity on the dynamics of a single bubble is discussed in aghdama et al 2012 numerical simulations have shown that for a more detailed analysis of the shape the cavity should simulate the process in the whole area not just its sector this will require the use of a mesh with a significantly larger number of elements and consequently more computational time during the first stage of the process when the gas cavity is compressed a rarefaction wave moves in the liquid from the interface to the reservoir wall the wave front becomes less steep over time the motion of the compression wave in the second stage of the process is shown in fig 10 the maximum pressure decreases over time spherical wave spreads out from the cavity in the form of a spherical shell the surface area of a sphere is 4 π a 2 where a is sphere radius as the distance from the cavity increase the shell surface area increases thus for spherical waves the pressure decreases as the inverse of radial distance as the spherical compression wave propagates its surface and the amount of substance involved in the movement increase and the amplitude of the wave decreases in addition part of the energy of the wave motion is spent heating the layers of the medium through which it has passed zel dovich and raizer 2002 the wave front over time becomes wider and less steep in general when a compression wave propagates the maximum liquid pressure p max will depend on a number of factors including the physical properties of the gas and liquid the distance from the center of the cavity the initial radius r 0 of the cavity and the initial pressure of the gas p g 0 and liquid p l 0 the study of the influence of the initial pressure in the gas cavity on the main parameters of the implosion process was conducted in the case when the initial cavity radius is r 0 0 038 m if the initial air pressure in the cavity p g 0 increases from 0 05 to 0 5 mpa then the maximum pressure p max at the control point will decrease by 38 and the time t 2 during which it will be reached will increase by 6 the initial gas pressure in the spherical cavity also affects the degree of gas compression at the time when the liquid suddenly stops thus at the time of the air cavity s maximum compression its radius is 15 at 0 05 mpa and 27 of the initial value at 0 5 mpa with an increase in the initial radius of the spherical gas cavity by a factor of 9 from 0 01 to 0 09 m the maximum pressure of the compression wave recorded at the control point at a distance of 0 1016 m from the center of the cavity increases 5 32 times from 9 96 to 51 53 mpa and the time of the cavity collapse increases fig 11 shows that the larger the initial radius of the gas cavity the higher the maximum pressure at the control point other things being equal these dependences p max r 0 are close to linear for different initial gas pressure values the maximum pressure value at the control point monotonically decreases with the increasing initial gas pressure and accordingly with decreasing δ p p l 0 p g 0 fig 12 therefore the larger the initial radius r 0 of the gas cavity and the greater the pressure drop δ p p l 0 p g 0 at the initial time the higher the maximum pressure at the control point as a result of the numerical data analysis an approximation formula for calculating the maximum pressure p max mpa at a distance of l 0 1016 m from the center of the cavity depending on the initial radius r 0 of the air cavity and the initial gas pressure p g 0 is proposed 8 p max 200 8 p g 0 0 4 r 0 8 6 p g 0 0 3 eq 8 is obtained when air and water are used as the working media the radius of the spherical cavity varies in the range 0 01 r 0 0 09 m the initial pressure of the liquid is p l 0 6 996 mpa and the initial pressure p g 0 of the gas varies in the range from 0 05 to 0 5 mpa eq 8 shows the linear relationship for the maximum pressure and initial cavity radius and also the fact that the greater the pressure difference in the liquid and gas at the initial time the higher the values of the predicted peak pressure the results of a parametric study show that when the initial gas pressure decreases the collapse of the gas cavity becomes stronger the damage caused by the collapse can be estimated by comparing the maximum pressure with the maximum stress that the ocean equipment surface can withstand before rupture 4 conclusions to describe the dynamics of a gas cavity in a liquid and the propagation of waves when it collapses under the influence of a pressure drop a model of fluid motion is proposed based on the physical laws of conservation of mass momentum and energy taking into account the viscosity compressibility thermal conductivity and turbulence the fluid volume method is used to track the interface this approach obtains sufficiently complete information about the considered aerohydrodynamic process the presented mathematical model is a reliable tool for predicting implosion the simulation results showed that during the collapse of a spherical air cavity with a radius of 0 01 to 0 09 m and gas pressure from 0 05 to 0 5 mpa at a constant liquid pressure of 7 mpa duration of a typical implosion event is not more than one millisecond the sphericity of the gas cavity is disturbed during the implosion rayleigh taylor instability develops at the interface for a more detailed analysis of the shape of the cavity the process in the whole area and not just its sector should be simulated this requires the use of a mesh with a significantly larger number of elements and consequently more computational time this report demonstrated that when a gas cavity collapses in a liquid the compression wave follows the rarefaction wave moreover the peak pressure is much higher than the initial hydrostatic pressure with an increase in the initial radius of the spherical gas cavity by 9 times from 0 01 to 0 09 m the maximum pressure recorded at the control point at a distance of 0 1016 m from the cavity center increases by 5 32 times from 9 96 to 51 53 mpa and the collapse time of the cavity increases when the initial radius of the cavity is r 0 0 038 m an increase in the initial air pressure in the cavity from 0 05 to 0 5 mpa leads to a decrease in the maximum pressure at the control point by 38 and increases the time for which it is achieved by 6 in addition the initial pressure of the gas in the spherical cavity affects the degree of compression of the gas when the liquid suddenly stops thus at the time of the air cavity s maximum compression its radius is 15 at 0 05 mpa and 27 of the initial value at 0 5 mpa an approximation formula for calculating the maximum pressure during the propagation of a spherical compression wave in a liquid is obtained the practical significance of the obtained results lies in the possibility of predicting the hydrodynamic and thermal parameters of two phase media in the collapse of a gas cavity in a liquid the results of this study can also contribute to the development and improvement of technologies and applications based on the generation of pressure waves in the environment during the collapse of a spherical cavity declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by the government assignment for frc kazan scientific center of ras russia 
21569,this research investigates the planar path planning method particularly where straight survey line in ocean exploration is required the smooth transition path between multiple straight survey segments in origin departing and corner cutting transition modes is studied first different transition modes of autonomous marine vehicles amvs in practical ocean survey navigation are realized and distinguished based on the definition of different transition modes the waypoints can be pre assigned generated online or compatible with online and offline assignments second to avoid wiggles of vehicles zigzags of the tracking trajectory and to satisfy the requirements on second order parametric and geometric continuities the fermat s spiral fs having advantages of low computational load and engineering practicability is selected to design the transition path between multiple straight segments the scaling of fs segments is optimized by considering the maneuverability of amvs besides the fs is parameterized in both transition modes to simplify the subsequent guidance and control scenarios thirdly the closed form analysis on geometric and parametric continuities of spliced transition path are derived finally based on the parameterized smooth path and a slender underactuated auv numerical simulation demonstrates the effectiveness of the fs based path planning method under integrated origin departing and corner cutting transition modes keywords path planning fermat s spiral parametric continuity geometric continuity autonomous marine vehicles 1 introduction autonomous marine vehicles amvs broadly classified as autonomous surface vehicles asvs and autonomous underwater vehicles auvs are considered the most important platforms for oceanic survey applications these are also characterized as self positioning self governing and environment perception intelligent vehicles which can perform pre defined tasks without human interference shi et al 2017 zhang et al 2015 xiang et al 2018 for an effective path planning a dedicated subsystem is required to achieve the desired guidance navigation and control scenarios sans muntadas et al 2019 lekkas and fossen 2014 peng et al 2019a zhang et al 2018 whereas external artificial intervention is considered impracticable in autonomous navigation particularly for the sailing amvs zeng et al 2018 shen et al 2017 the smart maneuvering of the amvs mainly rely on the effective path planning and a robust motion controller song et al 2019 particularly in the rapidly changing environments where the reference path is to be generated or adjusted according to the real time inputs chen and zhu 2019 generally the reference tracking path is defined with a series of ordered control points which are known as key waypoints these key waypoints are connected directly or indirectly to generate a reference path moreover the shape and properties of the reference path directly affect the guidance system and controller performance zeng et al 2015 the demand for the shape of the path differs from the applications of amvs for applications such as scientific mapping and imaging the amvs are desired to navigate on the designated straight lines so that the data post processing can be efficiently conducted based on detection information kavet et al 2016 szyrowski et al 2015 yu et al 2018 however for the applications such as oceanographic surveys and search operations the path is desired to be efficient lee et al 2015 niu et al 2018 shortest mohemmed et al 2008 and collision free davoodi et al 2015 and there is no strict requirement on the path shape xiang et al 2017 hence according to the above mentioned representative applications the path planning methods can be distinguished as two main categories combining straight lines and arc like transition segments piecewise polynomial and splines this paper focuses on the planar path planning method emphasizing on the smooth transition between multiple straight path dubins put forward the intuitive smoothing method by inserting circular arcs and straight segments between oriented waypoints dubins 1957 the dubins path minimizes the path length by using circular arcs to satisfy the maximum curvature limitation of the vehicle at a unity speed the dubins path can be extended as a 3d path by employing pitch angle smoothing to generate the dubins helix path wang et al 2014 and the projection of which in the horizontal plane is a 2 d dubins path the other circular arcs based spliced path is known as the reeds shepp path which is developed by reeds and shepp in 1990 the reeds shepp path is designed for non holonomic mobile vehicles that can easily move forward and backward which is widely used in driverless technology of autonomous cars especially for auto parking systems kim et al 2014 li et al 2016 apart from constraints on oriented waypoints and maximum curvature field of view constraints and path length are considered to perfect the reeds shepp path rathinam et al 2019 duits et al 2018 the significant defect of the dubins path and reeds shepp path is discontinuous curvature and higher order differential of subpaths at joints tsourdos et al 2010 additionally the reeds shepp path is not considered suitable for underactuated marine vehicles due to unpredictable oceanic environment strong dynamic coupling and a significant difference of dynamic characteristics in both forward and backward directions clothoids is the most common choice for path smoothing gonzález et al 2016 vicent devised 2 second order clothoid with linear variations to smooth transitions between 1 circular arc and 2 line segments girbés et al 2011 based on the combination of circular arc line segments and clothoid fraichard proposed a clothoid path with continuous curvature upper bounded curvature and upper bounded curvature derivative so that the path can be tracked at high speed with a much greater accuracy fraichard and scheuer 2004 however clothoid is defined in terms of fresnel integrals milton and stegun 1965 which are transcendental functions that cannot be solved analytically and increase computational cost zeng et al 2015 hence several researchers developed some methods to compute clothoid coordinates approximately brezak and petrović 2014 inspired by bźier curves in computer aided design applications which is invented by pierre bźier in 1962 curvature continue path smoothing methods are devised based on the maximum curvature and an ordered sequence of waypoints yang et al 2013 hassani and lande 2018 to improve the practicability of the path smoothing algorithm varieties of simplified methods have been studied four parameter logistic curves are proposed to fulfill the zero start and zero end curvature on path constraints which are half s and s shaped curve and only depend on 2 control parameters upadhyay and ratnoo 2018 2016 moreover the fermat s spiral is a preferred path smoothing option due to the simple analytical expression and gradient curvature from 0 candeloro et al 2013 lekkas et al 2013 wu proposed a path planning and smoothing integration method for an unmanned aerial vehicle in which rauch tung striebel smoother is applied to smooth the planning results with particle swarm optimization and metropolis criterion wu et al 2018 in addition pythagorean hodograph ph splines is an option for path smoother donatelli et al 2017 the path smoothing algorithm is not required for piecewise polynomial and splines based path planning method because the splicing of multiple subpaths especially for straight lines is not involved shen et al 2017 berglund et al 2010 bertolazzia and fregob 2018 hu et al 2019 to enhance the practicability of path smoothing method and to facilitate consequent guidance motion control scenarios the geometric continuity and parametric continuity of multiple subpaths and physical characteristics of the vehicle should be taken into consideration chu et al 2018 yu et al 2019 peng et al 2019b the contribution of this research is three fold 1 the concept of transition modes of amvs in practical ocean surveys have been presented by segregating different given waypoint sets for path smoothing literature survey so far revealed that no one has ever distinguished the transition modes before and thus the concept presented here may be considered as novel the combination of different transition modes provides more flexible stable and efficient approach especially for high speed amvs than conventional path smoothing methods and waypoint navigation 2 mirrored fermat s spiral segments have been designed as the smooth transition path in different transition modes by considering the dynamic constraints of the amvs such as the maximum path curvature the curvature of the transition path progressively starts from 0 and terminates at 0 furthermore closed form geometric and parametric continuities have been theoretically analyzed for the spliced transition path 3 the proposed fermat s spiral based planar path planning method includes a straightforward path generation process and closed form path confinement condition when compared with existing path planning and smoothing methods such as bésize b spline 4 parameter logistic curve and clothoid moreover the proposed planar path planning method also requires comparatively less computing resources the rest of the paper is organized as follows in section 2 the geometric and parametric continuities of the path are elaborated further two different transition modes between straight segments have also been distinguished in this section in section 3 the fs transition path both in two transition modes have been designed same includes fs parameterization path scale determination waypoint location and path planning pseudo code whereas the motion constraints of the vehicle are considered into the fs path scaling design section 4 provided the closed form path geometric continuity and parametric continuity between the segments in section 5 the effectiveness of the proposed smooth transition method is demonstrated through numerical simulation example the discussions and potential future work are included in section 6 the 3d los guidance law used in numerical simulation is given as appendices 2 preliminaries and problem statement 2 1 preliminaries let us suppose that a complete path is composed of several subpaths and which is propagated based on the variable ϖ the i t h subpath is represented with p i ϖ the geometric and parametric continuities on the path p i ϖ are defined barsky and derose 1989 chiandussi et al 2000 as under remark 1 g 0 and c 0 the adjacent subpaths are joined together and have common terminal way point that is 1 p i ϖ u b p i 1 ϖ l b remark 2 g 1 two adjacent subpaths have the same path tangential vector on terminal waypoints based on the validity of g 0 which is equivalent to the equality of path tangential angle of subpaths the path tangential angle of a regular path can be derived as 2 χ p ϖ atan2 d y p ϖ d ϖ d x p ϖ d ϖ the g 1 continuity claims that 3 χ p i ϖ u b χ p i 1 ϖ l b remark 3 g 2 two adjacent subpaths have the same curvature vectors based on the validity of g 0 and g 1 that is 4 κ p i ϖ u b κ p i 1 ϖ l b with path curvature 5 κ p ϖ x ϖ y ϖ x ϖ y ϖ x 2 ϖ y 2 ϖ 2 3 remark 4 c 1 two adjacent subpaths have the same velocity vectors based on the validity of c 0 which includes the orientation and magnitude of velocities therefore the c 1 continuity claims that 6 d p i ϖ u b d ϖ d p i 1 ϖ l b d ϖ remark 5 c 2 two adjacent subpaths have the same acceleration vectors based on the validity of c 0 and c 1 that is 7 d 2 p i ϖ u b d 2 ϖ d 2 p i 1 ϖ l b d 2 ϖ in fact the c 1 continuity entails g 1 and c 2 continuity entails g 2 but it is not applicable in reverse such as trajectory tracking soylu et al 2016 the parametric continuities are more strict than geometric continuities in same degree apart from c 0 and g 0 2 2 problem statement for subsea exploration applications such as marine geological survey search operations and seabed mapping amvs are required to navigate on the specified survey lines and acquire environmental information at the surface or underwater constant depth considering the subsea cable detection as shown in fig 1 the subsea cable route detection and tracking process can be summarized kavet et al 2016 szyrowski et al 2015 as under the given key waypoint w p 1 is assigned on the straight survey line 1 as starting point the vehicle collects detection data while sailing through the survey line 1 based on sets of exploratory data the subsea cable route point r 1 is located when the auv sailing to w p 2 i r 1 is the intersection of subsea cable and the survey line 1 subsequently the potential cable route point r 2 is predicted then the second survey line 2 from waypoints w p 3 to w p 4 i is calculated accordingly the auv is desired to smoothly sail out of the survey line from waypoint w p 2 i and smoothly sail in the survey line 2 it is observed that a stable survey trajectory determines the available length of data sets to be collected and influence the detection precision whereas tracking jitter of the vehicle decreases the reliability of data collection therefore effective straight survey path and smooth transition path between multiple survey segments need to be provided so as to achieve the desired level of detection path planning accordingly there are two transition missions for the vehicle are shown in fig 1 i e the vehicle smoothly moves out from the first survey line 1 and headed to the waypoint w p 3 and smoothly moves into the second survey line 2 discontinuous path curvature will lead to a sudden lateral acceleration especially for high speed amvs when the curvature changes from 0 step to a nonzero constant waypoint navigation and c 1 path suffer from unknown length of tracking jitter and even results in a potential system instability while switching between the waypoints or c 1 transition path moreover the discontinuous curvature of the reference path in guidance law blocks the application of some control methods such as backstepping based control schemes as the backstepping technique requires all functions differentiable based on the discrepancies of path transition and smoothing situations the two transition modes are distinguished and defined in the following way definition 1 origin departing transition mode consider a waypoint w p n i on the straight path the amv is desired to smoothly depart the first path from prescribed waypoint w p n i and converge to another line at a derived waypoint w p n 1 the curvature of the origin departing transition path should be progressively started form 0 and ended at 0 the point w p n i is the origin of the transition path definition 2 corner cutting transition mode consider a given waypoint w p i which is the intersection of two straight paths the amv is required to smoothly drive out from the first path and converge to the second path the curvature of the corner cutting transition path should be progressively started form 0 and ended at 0 conventional path smoothing methods can be applied for the corner cutting transition mode lekkas and fossen 2014 girbés et al 2011 upadhyay and ratnoo 2016 based on the definition of origin departing and corner cutting transition modes some related waypoints can be classified and defined as listed in table 1 the corner cutting transition mode defined above has already been broadly studied upadhyay and ratnoo 2018 lekkas et al 2013 yang and sukkarieh 2010 there are two steps for path planning under corner cutting mode first step is to determine the set of waypoints and the second is to generate a path which is based on the already identified waypoints it is observed that the sets of the waypoints are pre assigned sequentially and the shape of the path is fixed in the path tracking process however for applications such as subsea cable detection the waypoints are generated online and the transition paths are to be connected to smooth multiple straight survey paths hence the combination of origin departing and corner cutting transition modes provides a more flexible and stable approach than the conventional path smoothing method and waypoint switching the path planning and smoothing method under two transition modes can be applied in marine scientific survey activities where waypoints are generated online based on the dynamic environment and survey results furthermore as shown in fig 1 the origin cutting transition mode is different than the corner cutting mode in that the drive in waypoint of transition path is given and the point w p n is unknown which leads to different path smoothing calculation process hence it is required to separately design the smooth transition path under two modes 3 fs path planner 3 1 path parameterization the fs curve which is propagated from the coordinate origin of polar coordinates is expressed as 8 r k γ where r and γ represent the polar length and polar angle respectively the detailed geometric transition modes are shown in fig 2 for different transition cases the given key waypoints are represented with red five pointed stars and the green key waypoints on the joints of transition paths and straight lines will be designed later as shown in fig 2 the transition path is composed of an fs segment and its mirrored segment the first fs segment is parameterized as 9 fs 1 γ x n i k γ cos ρ l γ χ 0 y n i k γ sin ρ l γ χ 0 and the mirrored segment is parameterized as 10 fs 2 γ x n o k γ e n d γ cos ρ r γ e n d γ χ e n d y n o k γ e n d γ sin ρ r γ e n d γ χ e n d with the polar angle γ 0 γ e n d points x n i y n i and x n o y n o are drive in points and drive out points respectively which are given in the first fs segment and mirrored fs segment in the cartesian coordinate frame these are symmetrical about the l axis the scale of the fs segment depends on the positive constant k χ 0 and χ e n d are route angles at the drive in wp and drive out wp respectively and are given as 11 χ 0 atan2 v i y v i x 12 χ e n d atan2 v o y v o x 13 χ χ e n d χ 0 arccos v i v o where v i v i x v i y t and v o v o x v o y t are direction vectors of the derive in and drive out behavior which are given as 14 v i w p n w p n i w p n w p n i 15 v o w p n o w p n w p n o w p n where w p a w p b denotes the euclidean norm between of two neighboring key way points a and b ρ l and ρ r are spiral directions of the fs segment and its mirrored segment which are given as follows 16 ρ l sign v i y v o x v i x v o y ρ r sign v i y v o x v i x v o y where ρ 1 represent that the spiral path propagates from the origin of polar coordinates in clockwise order and vice versa it is noted that ρ l ρ r 1 and ρ l ρ r 3 2 fs scale determination the scale of the fs segment depends on the positive constant k the curvature on the path is given as 17 κ x γ y γ x γ y γ x 2 γ y 2 γ 2 3 1 k 2 γ 3 4 γ 2 1 4 γ 2 3 2 f γ 18 f 0 0 at the connections between survey lines and fs segments we have γ 0 the curvature of the path is continuous the first order derivative of curvature κ w r t polar angle γ can be denoted as 19 κ 1 k 16 γ 4 36 γ 2 3 γ 1 4 γ 2 5 2 furthermore the relationship between the curvature and the polar angle is detailed as follows hence the extreme point along the domain 0 2 π can be derived 20 γ e x t 7 2 5 4 and the numerical solution are given as γ e x t 15 467 we have the extreme maximum curvature along the full domain 21 κ e x t f γ e x t as shown in fig 2 the scales of the fs segments are different from each other in a different relative position between key wps as shown in fig 3 the polar angle curvature curve of fs is non monotonous the path curvature at the end of the fs segment can be denoted as 22 κ e n d f γ e n d as shown in eqs 9 10 the fs path is expressed about the polar angle γ to design a controller for path following and trajectory tracking problems the path tangential angle is considered necessary as the same is required as the desired tracking angle however it is hard to directly derive the explicit expression of path tangential angle about polar angle according to the first derivative of the fs curve we have the path tangential angle for the normal fs which is propagated from the coordinate origin 23 χ atan2 sin γ 2 γ cos γ cos γ 2 γ sin γ furthermore the path tangential angle can be rewritten as 24 χ γ d d γ arctan sin γ 2 γ cos γ cos γ 2 γ sin γ then 25 χ γ 4 γ 2 3 4 γ 2 1 d γ γ arctan 2 γ hence for the general fs curve shown in eqs 9 10 the polar angle and path tangential angle can be more easily transformed into each other according to the geometric analysis in fig 2 we have the numerical variation in angle corresponding to the maximum curvature 26 χ γ e x t 2 χ γ e x t 87 665 eq 26 shows that the extreme value of the path curvature κ e x t will occur only if the path tangential angle δ χ χ γ e x t besides the transition path should meet the physical rotation characteristics of the underactuated amvs 27 κ a m v 1 r with r represent the minimum turning radius in a 2d horizontal plane and κ a m v is the corresponding allowed maximum curvature in summary the fs scale parameter k for both transition modes can be designed by following way 28 k 1 κ m a x 2 γ k m a x 3 4 γ k m a x 2 1 4 γ k m a x 2 3 2 with 29 κ m a x max κ e x t κ e n d κ a m v and γ k m a x represents the polar angle corresponding to the maximum curvature due to the interchangeability of curvature κ and k which can be given as 30 γ k m a x min γ e x t γ e n d 3 3 key way points location based on the analytic geometry the relevant geometric parameters in fig 2 are deduced as follows 31 l 1 k γ e n d cos γ e n d 32 h k γ e n d sin γ e n d 33 α π χ 2 34 l 2 h tan α 35 l l 1 l 2 given the above path analysis the geometric parameters above are the same in both transition modes the key waypoints which determine the location of fss in two transition modes are given as follows a origin departing transition mode for the origin departing transition case the drive in waypoint in fig 2 is given as w p n i x n i y n i the waypoints w p n and w p n o are deduced as 36 w p n x n i l cos χ 0 y n i l sin χ 0 37 w p n o x n i l cos χ 0 cos χ e n d y n i l sin χ 0 sin χ e n d b corner cutting transition mode for the corner cutting transition case the drive in direction v i drive out direction v o and way point w p n x n y n in fig 2 are given hence the drive in point w p n i and drive out point w p n o are deduced as 38 w p n i x n l cos χ 0 y n l sin χ 0 39 w p n o x n l cos χ e n d y n l sin χ e n d 3 4 path planning algorithm in order to provide better understanding of the path planning algorithm for both transition modes the pseudo code of the planar transitive path planning algorithm is elaborated in table 2 the waypoints w p i 1 w p i i and w p i 1 are given under origin departing transition mode where waypoints w p i 1 and w p i i are used to determine the drive in direction of the vehicle for the corner cutting transition mode the preceding and the forthcoming waypoints w p i 1 and w p i 1 are assigned to determine the drive in and drive out directions respectively 4 path continuity demonstration at the joint of the fs segments we have γ γ e n d for the first fs segment and γ 0 for the mirrored fs segment according to the parameterized fs segments in eqs 9 10 we have 40 fs 1 0 x n i y n i 41 fs 1 γ e n d fs 2 0 42 fs 2 γ e n d x n o y n o hence the terminal waypoints of straight survey and fs segments are interconnected with each other the basic geometric and parametric continuities g 0 and c 0 are satisfied proposition 1 the first order geometric and parametric continuities g 1 and c 1 of the spliced path from fss path planner are continuous at the joints of fs segments and straight lines proof the first order derivative of the first fs segment and its mirrored segment w r t polar angle γ in north and east direction are deduced as 43 d fs 1 γ d γ k 2 γ m ρ l γ χ 0 n ρ l γ χ 0 44 d fs 2 γ d γ k 2 m ρ r χ e n d n ρ r χ e n d with 45 m a b c cos a b c 2 a b sin a b c n d e f sin d e f 2 d e cos d e f and 46 γ e n d γ to avoid singularities at γ 0 and γ γ e n d for the first and mirrored fs segments respectively the substitution method is used 47 ξ γ 0 γ e n d 48 ω γ e n d γ 0 γ e n d hence the first order derivatives of the first fs segment and the mirrored segment can be deduced as 49 d fs 1 ξ d ξ k m ρ l ξ 2 χ 0 n ρ l ξ 2 χ 0 50 d fs 2 ω d ω k m ρ r ω 2 χ e n d n ρ r ω 2 χ e n d for the tracking path in the ned frame the path tangential angle along the path is defined according to eq 2 51 χ p ϖ atan2 d y d ϖ d x d ϖ correspondingly the path tangential angles for the straight survey lines before the drive in point and after the drive out point are given as 52 χ p i tan χ 0 53 χ p o tan χ e n d therefore at the joints between the straight segment and fs segments we have 54 d fs 1 ξ d ξ ξ 0 k cos χ 0 sin χ 0 55 χ p ξ 0 tan χ 0 χ p i 56 d fs 1 ω d ω ω 0 k cos χ e n d sin χ e n d 57 χ p ω 0 tan χ e n d χ p o based on the auxiliary angle formula 58 a sin x b cos x a 2 b 2 sin x arctan b a a sin x b cos x a 2 b 2 sin x arctan b a at the joint of fs segments we have 59 ψ p ξ γ e n d atan2 sin σ 1 cos σ 1 ψ p ω γ e n d atan2 sin σ 2 cos σ 2 with 60 σ 1 ρ l γ e n d χ 0 arctan 2 ρ l γ e n d σ 2 ρ r γ e n d χ e n d arctan 2 ρ r γ e n d furthermore according to the property of the fs segment and its mirrored segment in eq 16 we have 61 σ 1 σ 2 2 ρ l γ e n d ϵ δ χ 2 with 62 ϵ 2 arctan 2 ρ l γ e n d according to the property of the fs in eq 25 we have 63 σ 1 σ 2 hence the following equation at the joint of fs segments can be deduced 64 d fs 1 ξ d ξ ξ γ e n d d fs 2 ω d ω ω γ e n d 65 χ p ξ γ e n d χ p ω γ e n d hence continuity conditions of g 1 and c 1 at the joints among fs segments straight segments first fs segment and mirrored fs segment are satisfied proposition 2 the second order geometric and parametric continuities g 2 and c 2 of the spliced path are satisfied at the joints of fs segments and straight lines proof the second order derivatives of the first and mirrored fs segments w r t polar angle γ in north and east direction can be deduced as 66 d 2 fs 1 γ d γ 2 k 4 γ 1 5 r γ ρ r χ 0 q γ ρ r χ 0 67 d 2 fs 2 γ d γ 2 k 4 1 5 r ρ l χ e n d q ρ l χ e n d with 68 r a b c 4 a 2 1 cos b a c 4 b a sin b a c q d e f 4 d 2 1 sin e d f 4 e d cos e d f based on the deduction in eqs 47 48 the second order derivatives of the first fs segment and the mirrored segment can be expanded as 69 d 2 fs 1 ξ d ξ 2 k w ρ l ξ χ 0 p ρ l ξ χ 0 70 d 2 fs 2 ω d ω 2 k w ρ r ω χ e n d p ρ r ω χ e n d with 71 w a b c 6 a b sin a b 2 c 4 b 3 cos a b 3 c p d e f 6 d e sin d e 2 f 4 e 3 cos d e 3 f hence the second order derivatives of the path at the joints between the straight survey line and first fs segment mirrored fs segment and straight survey line are given as under 72 d 2 fs 1 ξ d ξ 2 ξ 0 0 73 d 2 fs 2 ω d ω 2 ω 0 0 according to the curvature in eq 17 for the fs segments and straight segments we have 74 κ γ 0 κ s t r a i g h t 0 similarly based on the deduction in eqs 25 63 69 70 we have the following deduction 75 d 2 fs 1 ξ d ξ 2 ξ γ e n d d 2 fs 2 ω d ω 2 ω γ e n d based on the definition of the path curvature in eq 17 deduction of the first and second derivatives of fs segments in eqs 64 75 the curvature at the joint of the fs segments are given as 76 κ ξ γ e n d κ ω γ e n d hence the continuity conditions of g 2 and c 2 at the joints of the fs segments and straight survey lines first fs and mirrored segments are satisfied the curvature continuity conditions between fs segments are satisfied consequently the fs path planning results in origin departing and corner cutting transition cases meet the most stringent continuity constraints 5 simulation results and discussion the performance of the fs path planner under origin departing and corner cutting transition modes have been analyzed in this section by comparing the numerical simulation results with variety of available solutions initial condition of path planning and following table 3 list the key model parameters of the tested underactuated auv used in duc and pan 2009 for the fs path planner 8 key waypoints are assigned on the horizontal level z p 50 m as shown in table 4 the origin departing and corner cutting transition modes are assigned for the vehicle around key waypoints one by one except for the first w p 0 and last w p 7 for the path tracking simulation process the initial position and posture of the auv are give as x y z 5 0 47 m and φ θ ψ 0 0 π 4 rad and the initial velocity is given as u v w q r 1 5 m s 0 m s 0 m s 0 rad s 0 rad s based on the 3d los guidance law in appendix the planar path planning and 3d following results for the auv under unknown time varying ocean disturbance is shown in fig 4 the external disturbance utilized in simulation test are modeled as shown in xiang et al 2018 integrated origin departing and corner cutting transition cases accordingly the planar path planning results are detailed in fig 5 we design the survey path which is mainly composed with straight survey lines among w p 0 w p 1 w p 2 w p 3 w p 4 w p 5 and w p 6 w p 7 among these marked waypoints the points w p 0 w p 7 in table 4 are assigned for path planning algorithm that are marked with red pentagrams from 0 0 in order these green auxiliary waypoints are calculated with the fs path planning algorithm the local areas in green and blue circles represent origin departing and corner cutting transition modes as defined in the p r o b l e m s t a t e m e n t subsection as shown in fig 5 it is noted that the generated smoothing path does not pass through given points under corner cutting transition modes and the given points are used to calculate drive in point w p i i and drive out point w p i o for corner cutting modes as shown in eqs 38 39 due to difference in path generation process the origin departing transition modes are different from the corner cutting modes hence the existing path smoothing approaches are ineffective to generate the transition path under origin departing mode discussion on path shape and properties table 6 lists the statistical parameters on the path shape and properties details of the length l are shown in fig 2 based on the path planning algorithm the maximum curvature on each transition area is restricted below the required maximum path curvature of the auv 1 4 l 0 045 m 1 as shown in fig 6 the fs path curvature are restricted under 0 045 m 1 the minimum turning circle of the auv is given as four times of the vehicle length l as shown in figs 3 4 and 6 the 6 transition cases demonstrate the effectiveness of the fs path planning algorithm under origin departing and corner cutting modes for 6 transition cases the variations of path tangential angles are approximate to less than and greater than χ γ e x t respectively furthermore for the second origin departing and third corner cutting transitions around x 120 m and x 330 m respectively there are two peaks around the fs joints due to the change of path tangential angle χ χ γ e x t when compared with cubic bézier curves path planner in yang and sukkarieh 2010 both path smoothing methods meet the continuous curvature and maximum curvature constraints moreover the maximum curvature point is unique and realized at the joint of two curves for cubic bézier curves path planning whereas fs path planning results one or two maximum curvature points as shown in fig 6 and which depends upon the intersection angle between two adjacent straight subpaths furthermore when compared with the 4 parameter logistic paths the maneuverability of the vehicle in upadhyay and ratnoo 2018 have not been considered and thus the maximum curvature constraint is not satisfied a comparison of bézier curve b spline and 4 parameter logistic curve on path segments path generation and confinement have been carried out in upadhyay and ratnoo 2018 table 5 contrasts the proposed path smoothing method with existing approaches including bézier 4 parameter logistic and clothoid path in terms of path shape and nature of computation complexity for generating a feasible smoothing path the computing time of different algorithms varies for different implementation platforms however the proposed fs s smooth path planning for origin departing and corner cutting transitions is considered the only algorithm method which consumes comparatively less computational resources than fresnel integrals and higher order solutions in the design of zero start and zero end curvature for per segments comparatively increased transition path length have been observed in 4 parameter logistic paths upadhyay and ratnoo 2018 fss path planner performance from tracking results to evaluate the path planning and the performance the 2d tracking results have been divided into north and east locations of the auv which are varying with the time as shown in fig 7 moreover azimuth and elevation angles of the fs path planning and the auv are shown in figs 8 and 9 respectively these geometric and parametric properties show that the path transitions at all joints between fs segments and straight survey lines are smooth enough for tracking fig 10 shows the developed guidance yaw angle and response of the vehicle in real time under unknown time varying ocean disturbances fig 11 shows the related velocities in the tracking process moreover the control force and moments for the underactuated auv in the surge pitch and yaw directions are shown in fig 12 the smooth gradient control force and moment avoid mutation of executed control actions and the zigzags of tracking performance fig 13 shows the desired and actual heading angles and yaw control moments for dubins path path following under the same guidance and control framework the yaw control moment varies greatly at the junction of straight lines and segments these comparative simulation results are similar to the results depicted in figs 5 8 in fossen et al 2015 in which the controller is constructed to adaptively compensate the sideslip of drift forces breakpoints around time 350 s and time 1025 s represent drive in and drive out steering point from a straight line to a circular arc and from circular arc to a straight line in a dubins path respectively the breakpoint at time 700 s represents the sudden steering action under a stochastic current disturbance hence the skips of control actions are unavoidable in following a dubins shaped path even with adaptive compensation on sideslip of drift forces due to the discontinuous curvature nature as a comparative conclusion the planar fs path planning results are smooth enough to follow which demonstrates the effectiveness of the proposed distinction on path transition modes and corresponding fs path planning method discussion on feasible region of fs path planner as mentioned in the p r o b l e m s t a t e m e n t that the fermat s spiral based smoothing method is mainly designed for the straight path scenarios whereas the same can be applied to situations with zero start and zero end curvature constraints to minimize the path transition length the maximal curvature should be realized at the joint of fs segments based on eqs 25 28 35 the boundary conditions by setting that κ m a x κ a m v and γ k m a x γ e n d the feasible region of the fs path planner can be derived as shown in fig 14 for the fixed changement of path tangential angle δ χ the length l in fig 2 should be large enough so that the autonomous vehicle can turn inside the fixed angle δ χ under the maneuverability constraints 6 conclusion a fermat spiral based planar path planning and smoothing method was developed for straight survey line demanded applications the origin departing and corner cutting transition modes were distinguished in practical applications by combining with the application of subsea cable detection the key idea behind the path planning and the smoothing method was to insert a pair of mirrored zero propagated fs segments into adjacent straight survey lines thus overcoming the curvature discontinuity problem and high complex computation problem when employing dubins like and clothoid like path planning methods the path generation process is designed for both origin departing and corner cutting modes additionally a rigorous analysis of the geometric and parametric continuities on the spliced path was also provided furthermore numerical simulations based on 3d path tracking guidance law demonstrate the effectiveness of the path planning method and curvature continued path following performance of the auv the developed 2d path planning method has second order geometric and parametric continuities further research work will be carried out to address the fs based trajectory tracking control problem as well as further expanding the research on the 3d fs based smooth path planning it is significant to mention that theoretically it is feasible to extend the 2d fermat s spiral path smoothing method into 3 d space both origin departing and corner cutting transition modes as shown in yang and sukkarieh 2010 the parametric cubic bézier curves are developed to construct the continuous curvature path in 3d space similarly the planar path transition plane can be determined with one key waypoint w p n i and a drive out line v o in 3 d space for origin departing mode or determined with given drive in line v i and drive out line v o in 3d space for corner cutting mode credit authorship contribution statement jialei zhang conceptualization methodology simulation writing original draft xianbo xiang conceptualization funding acquisition supervision resources weijia li validation data curation shaolong yang investigation visualization qin zhang formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported in part by the national natural science foundation of china under grant 51579111 and grant 51209100 in part by the shenzhen science and technology plan china project under grant jcyj201704i311305468 in part by the fundamental research funds for the central universities china under grant 2017kfyxjj005 and grant 2019jycxjj005 and in part by the state key lab research fund of ocean engineering china under grant 201504 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2020 107901 appendix a supplementary data the following is the supplementary material related to this article mmc s1 polar angle curvature of fs in 0 4 mmc s2 3 d geometric path following scenario of underactuated auv mmc s3 2 d graphical interpretation on the path planning results mmc s4 global and partial enlarged path curvature at fs subpath joints mmc s5 north and east location of the auv mmc s6 azimuth angles of the path and auv mmc s7 elevation angles of the path and auv mmc s8 real time desired yaw angle vehicle yaw angle and sideslip angle mmc s9 surge sway heave and yaw velocities mmc s10 surge sway and yaw control force and moment of fss path following mmc s11 desired and actural heading angle yaw control moment for dubins path path following mmc s12 feasible resion of the fs path planning algorithm 
21569,this research investigates the planar path planning method particularly where straight survey line in ocean exploration is required the smooth transition path between multiple straight survey segments in origin departing and corner cutting transition modes is studied first different transition modes of autonomous marine vehicles amvs in practical ocean survey navigation are realized and distinguished based on the definition of different transition modes the waypoints can be pre assigned generated online or compatible with online and offline assignments second to avoid wiggles of vehicles zigzags of the tracking trajectory and to satisfy the requirements on second order parametric and geometric continuities the fermat s spiral fs having advantages of low computational load and engineering practicability is selected to design the transition path between multiple straight segments the scaling of fs segments is optimized by considering the maneuverability of amvs besides the fs is parameterized in both transition modes to simplify the subsequent guidance and control scenarios thirdly the closed form analysis on geometric and parametric continuities of spliced transition path are derived finally based on the parameterized smooth path and a slender underactuated auv numerical simulation demonstrates the effectiveness of the fs based path planning method under integrated origin departing and corner cutting transition modes keywords path planning fermat s spiral parametric continuity geometric continuity autonomous marine vehicles 1 introduction autonomous marine vehicles amvs broadly classified as autonomous surface vehicles asvs and autonomous underwater vehicles auvs are considered the most important platforms for oceanic survey applications these are also characterized as self positioning self governing and environment perception intelligent vehicles which can perform pre defined tasks without human interference shi et al 2017 zhang et al 2015 xiang et al 2018 for an effective path planning a dedicated subsystem is required to achieve the desired guidance navigation and control scenarios sans muntadas et al 2019 lekkas and fossen 2014 peng et al 2019a zhang et al 2018 whereas external artificial intervention is considered impracticable in autonomous navigation particularly for the sailing amvs zeng et al 2018 shen et al 2017 the smart maneuvering of the amvs mainly rely on the effective path planning and a robust motion controller song et al 2019 particularly in the rapidly changing environments where the reference path is to be generated or adjusted according to the real time inputs chen and zhu 2019 generally the reference tracking path is defined with a series of ordered control points which are known as key waypoints these key waypoints are connected directly or indirectly to generate a reference path moreover the shape and properties of the reference path directly affect the guidance system and controller performance zeng et al 2015 the demand for the shape of the path differs from the applications of amvs for applications such as scientific mapping and imaging the amvs are desired to navigate on the designated straight lines so that the data post processing can be efficiently conducted based on detection information kavet et al 2016 szyrowski et al 2015 yu et al 2018 however for the applications such as oceanographic surveys and search operations the path is desired to be efficient lee et al 2015 niu et al 2018 shortest mohemmed et al 2008 and collision free davoodi et al 2015 and there is no strict requirement on the path shape xiang et al 2017 hence according to the above mentioned representative applications the path planning methods can be distinguished as two main categories combining straight lines and arc like transition segments piecewise polynomial and splines this paper focuses on the planar path planning method emphasizing on the smooth transition between multiple straight path dubins put forward the intuitive smoothing method by inserting circular arcs and straight segments between oriented waypoints dubins 1957 the dubins path minimizes the path length by using circular arcs to satisfy the maximum curvature limitation of the vehicle at a unity speed the dubins path can be extended as a 3d path by employing pitch angle smoothing to generate the dubins helix path wang et al 2014 and the projection of which in the horizontal plane is a 2 d dubins path the other circular arcs based spliced path is known as the reeds shepp path which is developed by reeds and shepp in 1990 the reeds shepp path is designed for non holonomic mobile vehicles that can easily move forward and backward which is widely used in driverless technology of autonomous cars especially for auto parking systems kim et al 2014 li et al 2016 apart from constraints on oriented waypoints and maximum curvature field of view constraints and path length are considered to perfect the reeds shepp path rathinam et al 2019 duits et al 2018 the significant defect of the dubins path and reeds shepp path is discontinuous curvature and higher order differential of subpaths at joints tsourdos et al 2010 additionally the reeds shepp path is not considered suitable for underactuated marine vehicles due to unpredictable oceanic environment strong dynamic coupling and a significant difference of dynamic characteristics in both forward and backward directions clothoids is the most common choice for path smoothing gonzález et al 2016 vicent devised 2 second order clothoid with linear variations to smooth transitions between 1 circular arc and 2 line segments girbés et al 2011 based on the combination of circular arc line segments and clothoid fraichard proposed a clothoid path with continuous curvature upper bounded curvature and upper bounded curvature derivative so that the path can be tracked at high speed with a much greater accuracy fraichard and scheuer 2004 however clothoid is defined in terms of fresnel integrals milton and stegun 1965 which are transcendental functions that cannot be solved analytically and increase computational cost zeng et al 2015 hence several researchers developed some methods to compute clothoid coordinates approximately brezak and petrović 2014 inspired by bźier curves in computer aided design applications which is invented by pierre bźier in 1962 curvature continue path smoothing methods are devised based on the maximum curvature and an ordered sequence of waypoints yang et al 2013 hassani and lande 2018 to improve the practicability of the path smoothing algorithm varieties of simplified methods have been studied four parameter logistic curves are proposed to fulfill the zero start and zero end curvature on path constraints which are half s and s shaped curve and only depend on 2 control parameters upadhyay and ratnoo 2018 2016 moreover the fermat s spiral is a preferred path smoothing option due to the simple analytical expression and gradient curvature from 0 candeloro et al 2013 lekkas et al 2013 wu proposed a path planning and smoothing integration method for an unmanned aerial vehicle in which rauch tung striebel smoother is applied to smooth the planning results with particle swarm optimization and metropolis criterion wu et al 2018 in addition pythagorean hodograph ph splines is an option for path smoother donatelli et al 2017 the path smoothing algorithm is not required for piecewise polynomial and splines based path planning method because the splicing of multiple subpaths especially for straight lines is not involved shen et al 2017 berglund et al 2010 bertolazzia and fregob 2018 hu et al 2019 to enhance the practicability of path smoothing method and to facilitate consequent guidance motion control scenarios the geometric continuity and parametric continuity of multiple subpaths and physical characteristics of the vehicle should be taken into consideration chu et al 2018 yu et al 2019 peng et al 2019b the contribution of this research is three fold 1 the concept of transition modes of amvs in practical ocean surveys have been presented by segregating different given waypoint sets for path smoothing literature survey so far revealed that no one has ever distinguished the transition modes before and thus the concept presented here may be considered as novel the combination of different transition modes provides more flexible stable and efficient approach especially for high speed amvs than conventional path smoothing methods and waypoint navigation 2 mirrored fermat s spiral segments have been designed as the smooth transition path in different transition modes by considering the dynamic constraints of the amvs such as the maximum path curvature the curvature of the transition path progressively starts from 0 and terminates at 0 furthermore closed form geometric and parametric continuities have been theoretically analyzed for the spliced transition path 3 the proposed fermat s spiral based planar path planning method includes a straightforward path generation process and closed form path confinement condition when compared with existing path planning and smoothing methods such as bésize b spline 4 parameter logistic curve and clothoid moreover the proposed planar path planning method also requires comparatively less computing resources the rest of the paper is organized as follows in section 2 the geometric and parametric continuities of the path are elaborated further two different transition modes between straight segments have also been distinguished in this section in section 3 the fs transition path both in two transition modes have been designed same includes fs parameterization path scale determination waypoint location and path planning pseudo code whereas the motion constraints of the vehicle are considered into the fs path scaling design section 4 provided the closed form path geometric continuity and parametric continuity between the segments in section 5 the effectiveness of the proposed smooth transition method is demonstrated through numerical simulation example the discussions and potential future work are included in section 6 the 3d los guidance law used in numerical simulation is given as appendices 2 preliminaries and problem statement 2 1 preliminaries let us suppose that a complete path is composed of several subpaths and which is propagated based on the variable ϖ the i t h subpath is represented with p i ϖ the geometric and parametric continuities on the path p i ϖ are defined barsky and derose 1989 chiandussi et al 2000 as under remark 1 g 0 and c 0 the adjacent subpaths are joined together and have common terminal way point that is 1 p i ϖ u b p i 1 ϖ l b remark 2 g 1 two adjacent subpaths have the same path tangential vector on terminal waypoints based on the validity of g 0 which is equivalent to the equality of path tangential angle of subpaths the path tangential angle of a regular path can be derived as 2 χ p ϖ atan2 d y p ϖ d ϖ d x p ϖ d ϖ the g 1 continuity claims that 3 χ p i ϖ u b χ p i 1 ϖ l b remark 3 g 2 two adjacent subpaths have the same curvature vectors based on the validity of g 0 and g 1 that is 4 κ p i ϖ u b κ p i 1 ϖ l b with path curvature 5 κ p ϖ x ϖ y ϖ x ϖ y ϖ x 2 ϖ y 2 ϖ 2 3 remark 4 c 1 two adjacent subpaths have the same velocity vectors based on the validity of c 0 which includes the orientation and magnitude of velocities therefore the c 1 continuity claims that 6 d p i ϖ u b d ϖ d p i 1 ϖ l b d ϖ remark 5 c 2 two adjacent subpaths have the same acceleration vectors based on the validity of c 0 and c 1 that is 7 d 2 p i ϖ u b d 2 ϖ d 2 p i 1 ϖ l b d 2 ϖ in fact the c 1 continuity entails g 1 and c 2 continuity entails g 2 but it is not applicable in reverse such as trajectory tracking soylu et al 2016 the parametric continuities are more strict than geometric continuities in same degree apart from c 0 and g 0 2 2 problem statement for subsea exploration applications such as marine geological survey search operations and seabed mapping amvs are required to navigate on the specified survey lines and acquire environmental information at the surface or underwater constant depth considering the subsea cable detection as shown in fig 1 the subsea cable route detection and tracking process can be summarized kavet et al 2016 szyrowski et al 2015 as under the given key waypoint w p 1 is assigned on the straight survey line 1 as starting point the vehicle collects detection data while sailing through the survey line 1 based on sets of exploratory data the subsea cable route point r 1 is located when the auv sailing to w p 2 i r 1 is the intersection of subsea cable and the survey line 1 subsequently the potential cable route point r 2 is predicted then the second survey line 2 from waypoints w p 3 to w p 4 i is calculated accordingly the auv is desired to smoothly sail out of the survey line from waypoint w p 2 i and smoothly sail in the survey line 2 it is observed that a stable survey trajectory determines the available length of data sets to be collected and influence the detection precision whereas tracking jitter of the vehicle decreases the reliability of data collection therefore effective straight survey path and smooth transition path between multiple survey segments need to be provided so as to achieve the desired level of detection path planning accordingly there are two transition missions for the vehicle are shown in fig 1 i e the vehicle smoothly moves out from the first survey line 1 and headed to the waypoint w p 3 and smoothly moves into the second survey line 2 discontinuous path curvature will lead to a sudden lateral acceleration especially for high speed amvs when the curvature changes from 0 step to a nonzero constant waypoint navigation and c 1 path suffer from unknown length of tracking jitter and even results in a potential system instability while switching between the waypoints or c 1 transition path moreover the discontinuous curvature of the reference path in guidance law blocks the application of some control methods such as backstepping based control schemes as the backstepping technique requires all functions differentiable based on the discrepancies of path transition and smoothing situations the two transition modes are distinguished and defined in the following way definition 1 origin departing transition mode consider a waypoint w p n i on the straight path the amv is desired to smoothly depart the first path from prescribed waypoint w p n i and converge to another line at a derived waypoint w p n 1 the curvature of the origin departing transition path should be progressively started form 0 and ended at 0 the point w p n i is the origin of the transition path definition 2 corner cutting transition mode consider a given waypoint w p i which is the intersection of two straight paths the amv is required to smoothly drive out from the first path and converge to the second path the curvature of the corner cutting transition path should be progressively started form 0 and ended at 0 conventional path smoothing methods can be applied for the corner cutting transition mode lekkas and fossen 2014 girbés et al 2011 upadhyay and ratnoo 2016 based on the definition of origin departing and corner cutting transition modes some related waypoints can be classified and defined as listed in table 1 the corner cutting transition mode defined above has already been broadly studied upadhyay and ratnoo 2018 lekkas et al 2013 yang and sukkarieh 2010 there are two steps for path planning under corner cutting mode first step is to determine the set of waypoints and the second is to generate a path which is based on the already identified waypoints it is observed that the sets of the waypoints are pre assigned sequentially and the shape of the path is fixed in the path tracking process however for applications such as subsea cable detection the waypoints are generated online and the transition paths are to be connected to smooth multiple straight survey paths hence the combination of origin departing and corner cutting transition modes provides a more flexible and stable approach than the conventional path smoothing method and waypoint switching the path planning and smoothing method under two transition modes can be applied in marine scientific survey activities where waypoints are generated online based on the dynamic environment and survey results furthermore as shown in fig 1 the origin cutting transition mode is different than the corner cutting mode in that the drive in waypoint of transition path is given and the point w p n is unknown which leads to different path smoothing calculation process hence it is required to separately design the smooth transition path under two modes 3 fs path planner 3 1 path parameterization the fs curve which is propagated from the coordinate origin of polar coordinates is expressed as 8 r k γ where r and γ represent the polar length and polar angle respectively the detailed geometric transition modes are shown in fig 2 for different transition cases the given key waypoints are represented with red five pointed stars and the green key waypoints on the joints of transition paths and straight lines will be designed later as shown in fig 2 the transition path is composed of an fs segment and its mirrored segment the first fs segment is parameterized as 9 fs 1 γ x n i k γ cos ρ l γ χ 0 y n i k γ sin ρ l γ χ 0 and the mirrored segment is parameterized as 10 fs 2 γ x n o k γ e n d γ cos ρ r γ e n d γ χ e n d y n o k γ e n d γ sin ρ r γ e n d γ χ e n d with the polar angle γ 0 γ e n d points x n i y n i and x n o y n o are drive in points and drive out points respectively which are given in the first fs segment and mirrored fs segment in the cartesian coordinate frame these are symmetrical about the l axis the scale of the fs segment depends on the positive constant k χ 0 and χ e n d are route angles at the drive in wp and drive out wp respectively and are given as 11 χ 0 atan2 v i y v i x 12 χ e n d atan2 v o y v o x 13 χ χ e n d χ 0 arccos v i v o where v i v i x v i y t and v o v o x v o y t are direction vectors of the derive in and drive out behavior which are given as 14 v i w p n w p n i w p n w p n i 15 v o w p n o w p n w p n o w p n where w p a w p b denotes the euclidean norm between of two neighboring key way points a and b ρ l and ρ r are spiral directions of the fs segment and its mirrored segment which are given as follows 16 ρ l sign v i y v o x v i x v o y ρ r sign v i y v o x v i x v o y where ρ 1 represent that the spiral path propagates from the origin of polar coordinates in clockwise order and vice versa it is noted that ρ l ρ r 1 and ρ l ρ r 3 2 fs scale determination the scale of the fs segment depends on the positive constant k the curvature on the path is given as 17 κ x γ y γ x γ y γ x 2 γ y 2 γ 2 3 1 k 2 γ 3 4 γ 2 1 4 γ 2 3 2 f γ 18 f 0 0 at the connections between survey lines and fs segments we have γ 0 the curvature of the path is continuous the first order derivative of curvature κ w r t polar angle γ can be denoted as 19 κ 1 k 16 γ 4 36 γ 2 3 γ 1 4 γ 2 5 2 furthermore the relationship between the curvature and the polar angle is detailed as follows hence the extreme point along the domain 0 2 π can be derived 20 γ e x t 7 2 5 4 and the numerical solution are given as γ e x t 15 467 we have the extreme maximum curvature along the full domain 21 κ e x t f γ e x t as shown in fig 2 the scales of the fs segments are different from each other in a different relative position between key wps as shown in fig 3 the polar angle curvature curve of fs is non monotonous the path curvature at the end of the fs segment can be denoted as 22 κ e n d f γ e n d as shown in eqs 9 10 the fs path is expressed about the polar angle γ to design a controller for path following and trajectory tracking problems the path tangential angle is considered necessary as the same is required as the desired tracking angle however it is hard to directly derive the explicit expression of path tangential angle about polar angle according to the first derivative of the fs curve we have the path tangential angle for the normal fs which is propagated from the coordinate origin 23 χ atan2 sin γ 2 γ cos γ cos γ 2 γ sin γ furthermore the path tangential angle can be rewritten as 24 χ γ d d γ arctan sin γ 2 γ cos γ cos γ 2 γ sin γ then 25 χ γ 4 γ 2 3 4 γ 2 1 d γ γ arctan 2 γ hence for the general fs curve shown in eqs 9 10 the polar angle and path tangential angle can be more easily transformed into each other according to the geometric analysis in fig 2 we have the numerical variation in angle corresponding to the maximum curvature 26 χ γ e x t 2 χ γ e x t 87 665 eq 26 shows that the extreme value of the path curvature κ e x t will occur only if the path tangential angle δ χ χ γ e x t besides the transition path should meet the physical rotation characteristics of the underactuated amvs 27 κ a m v 1 r with r represent the minimum turning radius in a 2d horizontal plane and κ a m v is the corresponding allowed maximum curvature in summary the fs scale parameter k for both transition modes can be designed by following way 28 k 1 κ m a x 2 γ k m a x 3 4 γ k m a x 2 1 4 γ k m a x 2 3 2 with 29 κ m a x max κ e x t κ e n d κ a m v and γ k m a x represents the polar angle corresponding to the maximum curvature due to the interchangeability of curvature κ and k which can be given as 30 γ k m a x min γ e x t γ e n d 3 3 key way points location based on the analytic geometry the relevant geometric parameters in fig 2 are deduced as follows 31 l 1 k γ e n d cos γ e n d 32 h k γ e n d sin γ e n d 33 α π χ 2 34 l 2 h tan α 35 l l 1 l 2 given the above path analysis the geometric parameters above are the same in both transition modes the key waypoints which determine the location of fss in two transition modes are given as follows a origin departing transition mode for the origin departing transition case the drive in waypoint in fig 2 is given as w p n i x n i y n i the waypoints w p n and w p n o are deduced as 36 w p n x n i l cos χ 0 y n i l sin χ 0 37 w p n o x n i l cos χ 0 cos χ e n d y n i l sin χ 0 sin χ e n d b corner cutting transition mode for the corner cutting transition case the drive in direction v i drive out direction v o and way point w p n x n y n in fig 2 are given hence the drive in point w p n i and drive out point w p n o are deduced as 38 w p n i x n l cos χ 0 y n l sin χ 0 39 w p n o x n l cos χ e n d y n l sin χ e n d 3 4 path planning algorithm in order to provide better understanding of the path planning algorithm for both transition modes the pseudo code of the planar transitive path planning algorithm is elaborated in table 2 the waypoints w p i 1 w p i i and w p i 1 are given under origin departing transition mode where waypoints w p i 1 and w p i i are used to determine the drive in direction of the vehicle for the corner cutting transition mode the preceding and the forthcoming waypoints w p i 1 and w p i 1 are assigned to determine the drive in and drive out directions respectively 4 path continuity demonstration at the joint of the fs segments we have γ γ e n d for the first fs segment and γ 0 for the mirrored fs segment according to the parameterized fs segments in eqs 9 10 we have 40 fs 1 0 x n i y n i 41 fs 1 γ e n d fs 2 0 42 fs 2 γ e n d x n o y n o hence the terminal waypoints of straight survey and fs segments are interconnected with each other the basic geometric and parametric continuities g 0 and c 0 are satisfied proposition 1 the first order geometric and parametric continuities g 1 and c 1 of the spliced path from fss path planner are continuous at the joints of fs segments and straight lines proof the first order derivative of the first fs segment and its mirrored segment w r t polar angle γ in north and east direction are deduced as 43 d fs 1 γ d γ k 2 γ m ρ l γ χ 0 n ρ l γ χ 0 44 d fs 2 γ d γ k 2 m ρ r χ e n d n ρ r χ e n d with 45 m a b c cos a b c 2 a b sin a b c n d e f sin d e f 2 d e cos d e f and 46 γ e n d γ to avoid singularities at γ 0 and γ γ e n d for the first and mirrored fs segments respectively the substitution method is used 47 ξ γ 0 γ e n d 48 ω γ e n d γ 0 γ e n d hence the first order derivatives of the first fs segment and the mirrored segment can be deduced as 49 d fs 1 ξ d ξ k m ρ l ξ 2 χ 0 n ρ l ξ 2 χ 0 50 d fs 2 ω d ω k m ρ r ω 2 χ e n d n ρ r ω 2 χ e n d for the tracking path in the ned frame the path tangential angle along the path is defined according to eq 2 51 χ p ϖ atan2 d y d ϖ d x d ϖ correspondingly the path tangential angles for the straight survey lines before the drive in point and after the drive out point are given as 52 χ p i tan χ 0 53 χ p o tan χ e n d therefore at the joints between the straight segment and fs segments we have 54 d fs 1 ξ d ξ ξ 0 k cos χ 0 sin χ 0 55 χ p ξ 0 tan χ 0 χ p i 56 d fs 1 ω d ω ω 0 k cos χ e n d sin χ e n d 57 χ p ω 0 tan χ e n d χ p o based on the auxiliary angle formula 58 a sin x b cos x a 2 b 2 sin x arctan b a a sin x b cos x a 2 b 2 sin x arctan b a at the joint of fs segments we have 59 ψ p ξ γ e n d atan2 sin σ 1 cos σ 1 ψ p ω γ e n d atan2 sin σ 2 cos σ 2 with 60 σ 1 ρ l γ e n d χ 0 arctan 2 ρ l γ e n d σ 2 ρ r γ e n d χ e n d arctan 2 ρ r γ e n d furthermore according to the property of the fs segment and its mirrored segment in eq 16 we have 61 σ 1 σ 2 2 ρ l γ e n d ϵ δ χ 2 with 62 ϵ 2 arctan 2 ρ l γ e n d according to the property of the fs in eq 25 we have 63 σ 1 σ 2 hence the following equation at the joint of fs segments can be deduced 64 d fs 1 ξ d ξ ξ γ e n d d fs 2 ω d ω ω γ e n d 65 χ p ξ γ e n d χ p ω γ e n d hence continuity conditions of g 1 and c 1 at the joints among fs segments straight segments first fs segment and mirrored fs segment are satisfied proposition 2 the second order geometric and parametric continuities g 2 and c 2 of the spliced path are satisfied at the joints of fs segments and straight lines proof the second order derivatives of the first and mirrored fs segments w r t polar angle γ in north and east direction can be deduced as 66 d 2 fs 1 γ d γ 2 k 4 γ 1 5 r γ ρ r χ 0 q γ ρ r χ 0 67 d 2 fs 2 γ d γ 2 k 4 1 5 r ρ l χ e n d q ρ l χ e n d with 68 r a b c 4 a 2 1 cos b a c 4 b a sin b a c q d e f 4 d 2 1 sin e d f 4 e d cos e d f based on the deduction in eqs 47 48 the second order derivatives of the first fs segment and the mirrored segment can be expanded as 69 d 2 fs 1 ξ d ξ 2 k w ρ l ξ χ 0 p ρ l ξ χ 0 70 d 2 fs 2 ω d ω 2 k w ρ r ω χ e n d p ρ r ω χ e n d with 71 w a b c 6 a b sin a b 2 c 4 b 3 cos a b 3 c p d e f 6 d e sin d e 2 f 4 e 3 cos d e 3 f hence the second order derivatives of the path at the joints between the straight survey line and first fs segment mirrored fs segment and straight survey line are given as under 72 d 2 fs 1 ξ d ξ 2 ξ 0 0 73 d 2 fs 2 ω d ω 2 ω 0 0 according to the curvature in eq 17 for the fs segments and straight segments we have 74 κ γ 0 κ s t r a i g h t 0 similarly based on the deduction in eqs 25 63 69 70 we have the following deduction 75 d 2 fs 1 ξ d ξ 2 ξ γ e n d d 2 fs 2 ω d ω 2 ω γ e n d based on the definition of the path curvature in eq 17 deduction of the first and second derivatives of fs segments in eqs 64 75 the curvature at the joint of the fs segments are given as 76 κ ξ γ e n d κ ω γ e n d hence the continuity conditions of g 2 and c 2 at the joints of the fs segments and straight survey lines first fs and mirrored segments are satisfied the curvature continuity conditions between fs segments are satisfied consequently the fs path planning results in origin departing and corner cutting transition cases meet the most stringent continuity constraints 5 simulation results and discussion the performance of the fs path planner under origin departing and corner cutting transition modes have been analyzed in this section by comparing the numerical simulation results with variety of available solutions initial condition of path planning and following table 3 list the key model parameters of the tested underactuated auv used in duc and pan 2009 for the fs path planner 8 key waypoints are assigned on the horizontal level z p 50 m as shown in table 4 the origin departing and corner cutting transition modes are assigned for the vehicle around key waypoints one by one except for the first w p 0 and last w p 7 for the path tracking simulation process the initial position and posture of the auv are give as x y z 5 0 47 m and φ θ ψ 0 0 π 4 rad and the initial velocity is given as u v w q r 1 5 m s 0 m s 0 m s 0 rad s 0 rad s based on the 3d los guidance law in appendix the planar path planning and 3d following results for the auv under unknown time varying ocean disturbance is shown in fig 4 the external disturbance utilized in simulation test are modeled as shown in xiang et al 2018 integrated origin departing and corner cutting transition cases accordingly the planar path planning results are detailed in fig 5 we design the survey path which is mainly composed with straight survey lines among w p 0 w p 1 w p 2 w p 3 w p 4 w p 5 and w p 6 w p 7 among these marked waypoints the points w p 0 w p 7 in table 4 are assigned for path planning algorithm that are marked with red pentagrams from 0 0 in order these green auxiliary waypoints are calculated with the fs path planning algorithm the local areas in green and blue circles represent origin departing and corner cutting transition modes as defined in the p r o b l e m s t a t e m e n t subsection as shown in fig 5 it is noted that the generated smoothing path does not pass through given points under corner cutting transition modes and the given points are used to calculate drive in point w p i i and drive out point w p i o for corner cutting modes as shown in eqs 38 39 due to difference in path generation process the origin departing transition modes are different from the corner cutting modes hence the existing path smoothing approaches are ineffective to generate the transition path under origin departing mode discussion on path shape and properties table 6 lists the statistical parameters on the path shape and properties details of the length l are shown in fig 2 based on the path planning algorithm the maximum curvature on each transition area is restricted below the required maximum path curvature of the auv 1 4 l 0 045 m 1 as shown in fig 6 the fs path curvature are restricted under 0 045 m 1 the minimum turning circle of the auv is given as four times of the vehicle length l as shown in figs 3 4 and 6 the 6 transition cases demonstrate the effectiveness of the fs path planning algorithm under origin departing and corner cutting modes for 6 transition cases the variations of path tangential angles are approximate to less than and greater than χ γ e x t respectively furthermore for the second origin departing and third corner cutting transitions around x 120 m and x 330 m respectively there are two peaks around the fs joints due to the change of path tangential angle χ χ γ e x t when compared with cubic bézier curves path planner in yang and sukkarieh 2010 both path smoothing methods meet the continuous curvature and maximum curvature constraints moreover the maximum curvature point is unique and realized at the joint of two curves for cubic bézier curves path planning whereas fs path planning results one or two maximum curvature points as shown in fig 6 and which depends upon the intersection angle between two adjacent straight subpaths furthermore when compared with the 4 parameter logistic paths the maneuverability of the vehicle in upadhyay and ratnoo 2018 have not been considered and thus the maximum curvature constraint is not satisfied a comparison of bézier curve b spline and 4 parameter logistic curve on path segments path generation and confinement have been carried out in upadhyay and ratnoo 2018 table 5 contrasts the proposed path smoothing method with existing approaches including bézier 4 parameter logistic and clothoid path in terms of path shape and nature of computation complexity for generating a feasible smoothing path the computing time of different algorithms varies for different implementation platforms however the proposed fs s smooth path planning for origin departing and corner cutting transitions is considered the only algorithm method which consumes comparatively less computational resources than fresnel integrals and higher order solutions in the design of zero start and zero end curvature for per segments comparatively increased transition path length have been observed in 4 parameter logistic paths upadhyay and ratnoo 2018 fss path planner performance from tracking results to evaluate the path planning and the performance the 2d tracking results have been divided into north and east locations of the auv which are varying with the time as shown in fig 7 moreover azimuth and elevation angles of the fs path planning and the auv are shown in figs 8 and 9 respectively these geometric and parametric properties show that the path transitions at all joints between fs segments and straight survey lines are smooth enough for tracking fig 10 shows the developed guidance yaw angle and response of the vehicle in real time under unknown time varying ocean disturbances fig 11 shows the related velocities in the tracking process moreover the control force and moments for the underactuated auv in the surge pitch and yaw directions are shown in fig 12 the smooth gradient control force and moment avoid mutation of executed control actions and the zigzags of tracking performance fig 13 shows the desired and actual heading angles and yaw control moments for dubins path path following under the same guidance and control framework the yaw control moment varies greatly at the junction of straight lines and segments these comparative simulation results are similar to the results depicted in figs 5 8 in fossen et al 2015 in which the controller is constructed to adaptively compensate the sideslip of drift forces breakpoints around time 350 s and time 1025 s represent drive in and drive out steering point from a straight line to a circular arc and from circular arc to a straight line in a dubins path respectively the breakpoint at time 700 s represents the sudden steering action under a stochastic current disturbance hence the skips of control actions are unavoidable in following a dubins shaped path even with adaptive compensation on sideslip of drift forces due to the discontinuous curvature nature as a comparative conclusion the planar fs path planning results are smooth enough to follow which demonstrates the effectiveness of the proposed distinction on path transition modes and corresponding fs path planning method discussion on feasible region of fs path planner as mentioned in the p r o b l e m s t a t e m e n t that the fermat s spiral based smoothing method is mainly designed for the straight path scenarios whereas the same can be applied to situations with zero start and zero end curvature constraints to minimize the path transition length the maximal curvature should be realized at the joint of fs segments based on eqs 25 28 35 the boundary conditions by setting that κ m a x κ a m v and γ k m a x γ e n d the feasible region of the fs path planner can be derived as shown in fig 14 for the fixed changement of path tangential angle δ χ the length l in fig 2 should be large enough so that the autonomous vehicle can turn inside the fixed angle δ χ under the maneuverability constraints 6 conclusion a fermat spiral based planar path planning and smoothing method was developed for straight survey line demanded applications the origin departing and corner cutting transition modes were distinguished in practical applications by combining with the application of subsea cable detection the key idea behind the path planning and the smoothing method was to insert a pair of mirrored zero propagated fs segments into adjacent straight survey lines thus overcoming the curvature discontinuity problem and high complex computation problem when employing dubins like and clothoid like path planning methods the path generation process is designed for both origin departing and corner cutting modes additionally a rigorous analysis of the geometric and parametric continuities on the spliced path was also provided furthermore numerical simulations based on 3d path tracking guidance law demonstrate the effectiveness of the path planning method and curvature continued path following performance of the auv the developed 2d path planning method has second order geometric and parametric continuities further research work will be carried out to address the fs based trajectory tracking control problem as well as further expanding the research on the 3d fs based smooth path planning it is significant to mention that theoretically it is feasible to extend the 2d fermat s spiral path smoothing method into 3 d space both origin departing and corner cutting transition modes as shown in yang and sukkarieh 2010 the parametric cubic bézier curves are developed to construct the continuous curvature path in 3d space similarly the planar path transition plane can be determined with one key waypoint w p n i and a drive out line v o in 3 d space for origin departing mode or determined with given drive in line v i and drive out line v o in 3d space for corner cutting mode credit authorship contribution statement jialei zhang conceptualization methodology simulation writing original draft xianbo xiang conceptualization funding acquisition supervision resources weijia li validation data curation shaolong yang investigation visualization qin zhang formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported in part by the national natural science foundation of china under grant 51579111 and grant 51209100 in part by the shenzhen science and technology plan china project under grant jcyj201704i311305468 in part by the fundamental research funds for the central universities china under grant 2017kfyxjj005 and grant 2019jycxjj005 and in part by the state key lab research fund of ocean engineering china under grant 201504 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2020 107901 appendix a supplementary data the following is the supplementary material related to this article mmc s1 polar angle curvature of fs in 0 4 mmc s2 3 d geometric path following scenario of underactuated auv mmc s3 2 d graphical interpretation on the path planning results mmc s4 global and partial enlarged path curvature at fs subpath joints mmc s5 north and east location of the auv mmc s6 azimuth angles of the path and auv mmc s7 elevation angles of the path and auv mmc s8 real time desired yaw angle vehicle yaw angle and sideslip angle mmc s9 surge sway heave and yaw velocities mmc s10 surge sway and yaw control force and moment of fss path following mmc s11 desired and actural heading angle yaw control moment for dubins path path following mmc s12 feasible resion of the fs path planning algorithm 
