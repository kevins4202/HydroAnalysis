index,text
25025,environmental factors associated with climate change such as increasing sea surface temperature sst and solar radiation sr have negatively impacted corals throughout their geographic ranges one such coral which has been seriously impacted by these stressors is the staghorn coral acropora cervicornis to reduce the effects of such stressors this coral utilizes fluorescent proteins fps and melanin m these constitutive immune components quench reactive oxygen species ros produced during thermal stress and absorb or reflect potentially damaging light the synthesis of these components are nonetheless energetically costly hence production of these protective compounds may be traded off against other vital functions such as growth in this study we develop a mathematical model viz a system of ordinary differential equations that simulates the growth of a cervicornis branches under different regimes and combinations of sst and sr the model assumes that polyps are the functional unit of the coral and that the concentration of fps and m are inversely proportional to sst and sr intensity to develop the model we use empirical birth and mortality rate of polyps and the maximum number of polyps per unit area and theoretical parameters concentration of fps m produced and trade offs with growth the model simulates how changes in fps and m due to environmental changes affect the growth capacity of a cervicornis the model as well as its stability analysis show that polyp growth is affected by sr and sst hence the model will help in understanding how corals will respond to future changes in climate keywords acropora cervicornis dynamical system lyapunov stability 1 introduction global climate change is having a profound and potentially devastating effect on many marine environments including coral reef ecosystems climate change is primarily associated to the atmospheric deposition of carbon dioxide co2 among others greenhouse gases a direct consequence of this accumulation of greenhouse gases in the atmosphere is the increase of sea surface temperature sst there is compelling evidence that points towards an increase of 0 4 0 74 c in the mean global sst during the past century hoegh guldberg et al 2007 likewise solar radiation sr reaching the earth s surface in its different wavelengths e g ultraviolet radiation uv and photosynthetic active radiation par has also increased partly as a result of ozone layer depletion häder et al 2007 rising sst and increased sr are physiological stressors to marine organisms such stressors when severe might jeopardize vital functions such as growth reproduction and the capacity to fight diseases thereby threatening the viability of coral reef populations reef building corals are particularly vulnerable to sst and sr slight increments in temperature 1 c over the average summer temperature in conjunction with elevated radiation have caused large scale coral bleaching hoegh guldberg et al 2007 lesser et al 1990 coral bleaching is the phenomenon by which corals lose their algal endosymbionts or the algal pigments degrade iglesias prieto et al 1992 moreover the aforementioned environmental stressors may also promote coral diseases which also reduce the corals s capacity to growth reproduce and survive to minimize or at least reduce the negative impact of sst and sr corals have developed a suite of immune mechanisms including the syntheses of pigments such as fluorescent proteins fps and melanin m fps and m are ubiquitous to corals thus they are primary constituents of coral s innate immune system roth et al 2010 in general these immune constitutive pigments possess multiple functions within corals these chemical compounds have photoprotective properties as they scatter light and absorb potentially harmful high energy radiation salih et al 2000 palmer et al 2010 mydlarz and harvell 2007 and also have the capacity to quench reactive oxygen species ros which dramatically increase under high levels of abiotic stressors leading to coral bleaching as is in the case of other living organisms corals have a finite amount of resources to be allocated into a multitude of vital functions e g immune defense and growth among others given these resource constraints the allocation of resources into a vital function such as immune defense will be traded off against other vital functions such as growth several studies conducted on corals support this paradigm for instance palmer et al 2010 compared the activity of phenoloxidase po an enzyme involved in m biosynthesis with the number of amoebocyte containing m granules melanocytes of two scleractian corals porites sp and acropora millepora that study revealed that porites sp invests considerably more resources into the aforementioned immune constituent than a millepora as it exhibited higher numbers of melanocytes than a millepora this investment of resources into immunity provides porites with higher disease and bleaching resistance by contrast acroporids allocate more resources into growth when compared to porites as acroporid corals may growth several cm in length per month whereas porites corals may growth several cm per year palmer et al 2010 however for acroporids the rather rapid growth is traded off at a cost in reduced immunity as acroporids are among the corals most susceptible to bleaching and disease corals rely on a suite of immune constituents including pigments such fps and m to protect against the threat of bleaching fps and m are ubiquitous to corals and serve as primary constituents of corals s innate immune system due to their multiple functions roth et al 2010 fps for instance have photoprotective properties as they scatter light and absorb potentially harmful high energy radiation salih et al 2000 fps also have the capacity to quench reactive oxygen species ros which dramatically increase under high levels of abiotic stressors leading to coral bleaching as in the case of fps m provides corals with photoprotection as well as it scatters and absorbs over 50 70 of harmful radiation such as uv radiation m is commonly found in a corals epithelial cells creating a physical barrier to prevent and or reduce harmful impact of radiation in addition m plays an important role in the inflammatory responses such as wound healing processes and the response to pathogens palmer et al 2010 as both fp and m are components of the response to the same environmental stressor i e sr and sst we infer that the degree of each response is proportional to the insult the objective of this study is to present and analyze a mathematical model which consists of a system of ordinary differential equations ode that simulates the immune response of a cervicornis under a finite resource budget scenario and different sst and sr regimes the mathematical model embodies a set of assumptions and hypotheses such assumptions and hypotheses can be examined by comparing the model results simulations with the observed behavior of the system that is simulated furthermore although the model is an abstraction of the biological system under consideration this model sufficiently captures the interaction between the coral and its environment so it helps to better understand the impact of environmental challenges within the coral thereby the model could be used to design better conservation policies or strategies to preserve corals i e it could be used as a conservation tool we have chosen a cervicornis coral as our biological model for two reasons 1 throughout their geographical extent a cervicornis populations have suffered unprecedented population declines these declines have motivated the implementation of several local and regional protection initiatives such as the inclusion of this coral species onto the us endangered species act esa and the red list of critically threatened species rlct 2 being in such precarious population state have motivate us to study the effect of sst and sr on the syntheses of fps and m and on its growth rate thus some of the parameters described on this model have been empirically estimated this paper is organized in the following way in section 2 we state the model assumptions describe the mathematical model and the model parameters section 3 is about the asymptotic stability analysis of the model thus we focus on how the model behaves as time increases to infinity in that section we also compute the equilibrium points analytically and assess their stability using different methods such as linearization of the ode system and lyapunov function in section 4 we present simulations results under different environmental conditions determined by the model parameters and initial conditions results regarding the structural stability of model are also presented in section 4 we discuss the results in section 5 for completeness sake we provide in the appendix details about the mathematical concepts that were used for the analysis of the model 2 mathematical model 2 1 model assumptions the following set of assumptions allow us to construct a model that simulates changes in a cervircornis s growth and immune system elements as a function of environmental changes 1 a cervircornis corals as all living organisms have a finite amount of resources including energy to be allocated into several vital functions such as somatic growth the increase in number of polyps or immune defenses given these resource constraints the allocation of resources into any given life history trade will be traded off against others live history traits 2 the syntheses of m and fp require the same amount of resources for both m and fp the behavior in terms of synthesis is similar 3 fp and m are synthesized within the polyps which are the basic units of coral 4 corals have a logistic somatic growth 5 sst and sr exert a similar stress to the coral and these affect both immune system constituents m and fp in a similar way i e as sst and sr increases the synthesis of m and fp decreases 6 sst and sr vary at the same rate with respect to water depth lee et al 2005 7 the effects of the two environmental variables sst and sr on coral polyps are embodied in the functions f d s where d represents normalized water depth normalized depth is defined as the ratio of depth to maximum depth where a cervicornis grows i e d d d max the maximum depth is 30 m according to the work of pang 1973 8 based on the limiting resource theory f 1 d affect the number of polyps as depth increases the number of polyps decreases likewise f 2 d and f 3 d affect the syntheses of fp and m respectively as depth increases the syntheses of fp and m concentration increases 9 f 1 d must be a positive decreasing and continuous functions of d f i d i 2 3 must be positive increasing and continuous functions of d 10 based on how sst and sr vary with depth sr according to lee et al 2005 we defined the environmental functions as 1a f 1 d c 2 e c 1 d 1b f 2 d β f e d 1c f 3 d β m e d where c 1 c 2 β f and β m are constants 11 changes in fp and m concentration are the main responses of the coral s immune system to environmental stress albeit other responses could possibly change the concentration of fp and m these immune constituents are sufficient to describe the coral s reaction to environmental stress based on these assumptions we constructed a mathematical model that consists of a system of ordinary differential equations ode fig 1 shows a schematic diagram of the model observe in the figure that given a finite energy budget at greater depth depth being a proxy for sst and sr less resources are dedicated to polyp growth ergo polyp growth is reduced whereas fp and m concentration is increased 2 2 model equations we constructed a model that simulates the growth of a cervicornis coral with sst and sr changing accordingly to the depth profile as follows 2a x 1 t f 1 d x 1 1 x 1 κ a δ a x 1 δ a f x 2 δ a m x 3 x 1 2b x 2 t f 2 d x 2 x 1 δ f x 2 x 1 δ f m x 3 x 2 2c x 3 t f 3 d x 3 x 1 δ m x 3 x 1 δ m f x 2 x 3 where x 1 represents the growth of a cervicornis coral in units of polyps per cm3 x 2 and x 3 represent fp and m concentrations in mmoles cm3 the parameters are d δ a κ a δ f δ m δ af δ am δ fm and δ mf the normalized depth d was defined in section 2 1 δ a and κ a are the natural death rate and maximal growth capacity of the a cervicornis branches respectively δ f and δ m are the breakdown rates of fp and m respectively δ af and δ am are the death rates of a branch due to the presence of fp and m respectively δ fm is the breakdown rate of fp due to the presence of m δ mf represents the breakdown rate of m owing to the presence of fp f 1 d f 2 d and f 3 d represent the environmental functions they incarnate the relation between d sst sr and the growth rate of a cervicornis or synthesis of fp and m observe in eq 2a that f 1 d acts as a birth rate of polyps β a similarly in eqs 2b 2c f 2 d and f 3 d act as modifiers of the synthesis rate of fp and m respectively moreover for the stability and bifurcation analysis the exact form of the functions is unimportant as long as they satisfy model assumption 9 section 2 1 the values for the c i in eq 1 were determined by fitting the functions to polyp s birth rate data as explained in section 2 3 furthermore the c i s must be positive because of the conditions that the environmental functions must satisfy see section 2 1 β f and β m represent the syntheses rate of fp and m respectively their values are in table 1 2 2 1 normalized model equations in order to facilitate the process of numerically solving the model equations eq 2 and their interpretation we normalize the model by letting y 1 t x 1 t κ a y 2 t x 2 t x 2 max and y 3 t x 3 t x 3 max where x 2 max and x 3 max are the maximum saturation concentration of fluorescent protein and melanin respectively thereby the model becomes 3a y 1 t f 1 d y 1 1 y 1 δ a y 1 δ a f y 2 δ a m y 3 y 1 3b y 2 t f 2 d y 2 y 1 δ f y 2 y 1 δ f m y 3 y 2 3c y 3 t f 3 d y 3 y 1 δ m y 3 y 1 δ m f y 2 y 3 where δ a f δ a f x 2 max δ a m δ a m x 3 max f 2 d κ a f 2 d κ a β f e d δ f δ f κ a δ f m δ f m x 3 max f 3 d κ a f 3 d κ a β m e d δ m δ m κ a and δ m f δ m f x 2 max for simplicity s sake we define β f κ a β f and β m κ a β m note that in system 3 all variables are dimensionless and the parameters are in units of day 1 the details on how the equations are normalized can be seen in appendix f 2 3 parameters the model has two parameters sets those that were estimated empirically and the theoretical parameters the empirical parameters are β a δ a and κ a we emphasize that the values of β a are used to fit the parameters for the environmental function i e c 1 and c 2 the theoretical normalized parameters are β f δ f β m δ m and d table 1 presents the baseline parameter values used in the simulations the empirical parameters were measured at two depths 4 572 and 12 19 m henceforth we define the 4 572 m group of measurements as shallow group and the 12 12 m group of measurements as deep group 2 3 1 empirical parameters 2 3 1 1 estimation of fluorescent proteins fps concentration to estimate fp we collected fragments from 20 colonies which were raised in nursery farms located at two depths 10 fragments per depth once collected each fragment was frozen and stored for further fps analyses through the spectral emission of these proteins following palmer et al 2009 with slight modification each frozen coral fragment e g the growing tips of the fragments was airbrushed individually to separate soft tissue from skeleton using a phosphate extraction buffer 50 mm phosphate buffer ph 7 8 with 0 05 mm dithiotheitol and individually collected into sterile tubes the crude extract was subsequently homogenized using a fisher scientific powergen 125 tissue homogenizer with a medium saw tooth tip for 30 s at low power the homogenized tissue slurry was then centrifuged at 4 c at 1900 g for 5 min the supernatant was aliquoted and stored at 20 c to measure fps concentration 30 μl of the extracted samples was placed in a black 96 well plate along with a control sample buffer only well triplicates of each sample were excited using a infinite 200 pro multimode microplate reader at 410 470 and 520 nm and the emission spectra measured from 400 nm to 850 nm at 5 nm intervals relative fluorescence and absorbance of each sample was normalized to total protein concentration determined using bradford reagent and measuring absorbance at 595 nm 2 3 1 2 estimation of po as a proxy for melanin m concentration po enzymatic activity was quantified as po po is an enzymatic precursor of melanin palmer et al 2011 we used the stored tissue portion obtained for fps biochemical analysis and we processed it as explained by palmer et al 2011 with slight the modifications described above po activity was determined by adding 20 μl of the extracted coral sample to a 96 well plate in addition to 40 μl of 50 mmol l 1 phosphate buffer ph 7 8 and 25 μl of double distilled water ddh2o after incubating at room temperature for 20 min 30 μl of a 10 mmol l 1 dopamine hydrochloride solution was added as a substrate and the change in absorbance of the reaction was monitored every 5 min for 45 min using a biotek elx808 absorbance microplate reader at 490 nm the change in absorbance for the linear portion of the reaction curve was used to determine po activity control reactions under the same condition but with 70 μl of 50 mmol l 1 phosphate buffer ph 7 8 and no substrate was run in parallel po activity was normalized to total protein concentration in each sample total protein concentration of the extracted coral sample was determined using bradford reagent and measuring absorbance at 595 nm utilizing the same protocol described above 2 3 1 3 maximum growth capacity of polyps κ a a cervicornis branches are cylindrical in shape and relatively uniform in diameter at the base of each individual branch within the same colony furthermore across all branches the polyp corallite the skeletal cup in which each independent polyp sits is highly visible to the unassisted vision taking into consideration these branch features we mapped the number of polyps within a cylinder like branch to a volume of 1 cm3 to accomplish this we first fitted a paraffin ribbon of 1 cm in height around the branch and counted the number of marks left on the ribbon by the corallites in the branches thereafter we measured the diameter of the branch were the ribbon was fitted with a caliper to estimate the volume of the cylinder like branches with a height 1 cm afterward we divided the number of corallite marks the equivalent to the number of polyps counted in 18 genetically distinct branches by the cylinder volume of that branch to estimate the number of polyps per cm3 finally we calculated the maximum capacity of polyps in one cm3 κ a by averaging all the estimated number of polyps within 1 cm3 of tissue 2 3 1 4 birth rate of polyps β a inasmuch as in our model eqs 1 2 the environmental function f 1 d acts as a modifier of β a then is crucial to estimate β a at different depths to estimate β a we tracked the changes in length of 245 a cervicornis colonies located at water depths shallow and deep throughout a year then we determined the number of new polyps occurring within each length increment to estimate the maximum capacity of polyps within 1 cm3 of tissue the growth rate of each colony was estimated by taking high resolution digital images of each colony at monthly intervals for one year besides in the laboratory we used the software program coral point counter excel cpce kohler and gill 2006 to estimate the total length in cm of each fragment the total length was further used to estimate the volumes of each of the colonies at the start v i and at the end v f of the study using the expression for the volume of a cylinder with constant radius r and length height l k 4 v k π r 2 l k k i f the subscript in l k and v k denote the total length and volume of the fragment at the start i initial and at the end of the study f final the radius r was estimated by measuring with a caliper the fragment diameter of the 18 colonies previously used to estimate κ a l i and l f finally we used the volumes of each fragment to compute β a in units of days 1 per fragment using the following equation 5 β a α v f v i 364 where α 1 is a constant in units of cm 3 v i and v f are the estimated volumes vide supra and 364 is the elapsed time in days between the start and end of the study observe that eq 5 is the average growth rate over the time interval 0 364 after estimating β a at different depths shallow and deep we proceeded to test the assumption that indeed β a changes with depth furthermore we also needed to statistically test the claim embodied by f 1 d eq 1a that β a decreases with depth such claim is crux to the idea that sst and sr affect polyp s growth a t test was used to test for equality of mean β a for the two depth groups the normality assumption was verified by conducting a normal quantile plot the equal variance assumption was shown to be false by conducting bartlett s test the t test for equality of means assuming unequal variances yielded a p value 3 145 10 5 statistically showing that β a decreases as depth increases 2 3 1 5 death rate of polyps δ a to estimate death rate of polyps we selected 223 colonies that exhibited negative growth shrinking in at least one month during a one year monitoring period we identified the shrinking month and estimated the amount of life tissue lost by subtracting the estimated length of that colony during the month prior to shrinking to the estimated growth during the month of shrinking then we followed the same protocol used in the birth rate estimation to calculate the number of polyps lost in one cubic centimeter similar to birth rate of polyps we tested the data for equality of means using a wilcoxon test yet in this case analysis yielded no statistical differences p value 0 9535 suggesting that δ a does not changes with depth the estimated value is in table 1 2 3 1 6 parameters of environmental function f 1 d the parameters for the environmental functions are the c 1 and c 2 in eq 1 their values were obtained by fitting f 1 d to birth rates measured at shallow and deep depths the fitting algorithm that we used was the levenberg marquardt as implemented in the matlab computing platform we ran algorithm for a set of 10000 randomly generated uniformly initial guesses the values obtained as solutions of the curve fitting problem are c 1 1 1571 unitless and c 2 0 1532 in units of day 1 we reiterate that strictly speaking ocean depth is another model parameter that acts as a proxy for sr and sst 2 4 initial conditions different initial conditions for the ode system 2 were chosen to conduct different simulations see section 4 the overall rationale was to take initial values from a set of typically observed values for number of polyps fp and m concentrations 3 stability analysis asymptotic the goal in this section is to elucidate the behavior of the model as t i e how the model equations behave in the long run to accomplish this we calculated the nullclines and the equilibria of system 2 and study the lyapunov or asymptotic stability of such equilibria 3 1 equilibrium points let g x t μ be the right hand side rhs of the ode system 2 where μ is a tuple with the 12 model parameters thereby system 2 can be written as x t g x t μ and the equilibrium points are defined as the solutions of g x t μ 0 it is important to mention that the results given below do not assume the exact form of the environmental functions in eq 1 but rather that the functions satisfy the assumptions in section 2 1 moreover for simplicity s sake we omit the arguments of the environmental functions i e f i denotes f i d for i 1 2 3 also in order to simplify the algebra we define 6 p 1 f 1 δ a p 2 f 2 δ f and p 3 f 3 δ m 3 1 1 equilibrium points the equilibria of the ode system 2 are obtained by setting its rhs side to zero i e g x t μ 0 and solving the nonlinear system by considering different cases the expressions for the nullclines the details are on appendix a embodied those cases hence the equilibrium points of eq 2 are 7a x 1 0 0 0 t 7b x 2 κ a f 1 p 1 0 0 t 7c x 3 κ a p 1 δ δ f m δ m f δ f m p 3 δ m f p 2 t 7d x 4 0 0 c t c ℝ c 0 7e x 5 0 b 0 t b ℝ b 0 where 8 δ f 1 δ f m δ m f δ a f κ a δ f m p 3 δ a m κ a δ m f p 2 and the p i i 1 2 3 are defined in eq 6 the origin i e eq 7a is trivially obtained whenever x 1 0 eq 7b is obtained when x 1 0 and x 2 x 3 0 see expression in a 3 the expression in eq 7c is obtained by setting x 1 0 x 2 0 and x 3 0 and substituting expressions in eqs a 2 and a 1 into expression in eq a 3 an equilibrium point is biologically feasible when all of its entries are nonnegative i e whenever it is in the first octant observe that x 1 is biologically feasible x 2 eq 7b is biologically feasible whenever p 1 0 owing to the complexity of the algebraic expression that constitute x 3 eq 7c then the biological feasibility of x 3 must be assessed with caution hence we consider the following cases 1 if p 1 0 p 2 0 and p 3 0 then x 3 is biologically feasible 2 if p 1 0 or p 2 0 or p 3 0 then we have the following subcases a if p 1 0 then δ 0 in order to obtain a positive first component of x 3 which in turns implies p 3 0 and p 2 0 in order to obtain positive second and third components of x 3 but observe that this leads to a contradiction because if p 3 0 and p 2 0 then by definition of δ eq 8 δ 0 b if p 2 0 then p 1δ 1 0 but this leads to a biologically unrealistic solution because the first component in eq 7c must be nonnegative c similarly if p 3 0 then p 1δ 1 0 but this leads to an biologically unrealistic solution because the first component in eq 7c must be nonnegative d all other possible subcases also lead to biological unrealistic solutions thereby components of solution x 3 are nonnegative only if p 1 0 p 2 0 and p 3 0 moreover observe that since the first entry of x 3 and x 4 is zero see eqs 7d 7e we regard them as biologically unrealistic 3 2 local stability analysis here we elucidate the stability of the equilibria computed in section 3 1 to do so we calculate the jacobian matrix of eq 2 and determine whether each of the equilibrium points are hyperbolic 1 1 an equilibrium point is hyperbolic if all the eigenvalues of the jacobian matrix of the rhs of the ode system evaluated at the equilibrium point have nonzero real part this analysis is local because it focus in trajectories solutions of eq 2 that start in a neighborhood of each equilibrium point the jacobian matrix of the rhs of eq 2 is 9 d g x x d g 11 δ a f x 1 δ a m x 1 p 2 x 2 d g 22 δ f m x 2 p 3 x 3 δ m f x 3 d g 33 where 10a d g 11 f 1 1 2 x 1 κ a δ a δ a f x 2 δ a m x 3 10b d g 22 p 2 x 1 δ f m x 3 10c d g 33 p 3 x 1 δ m f x 2 3 2 1 stability of x 1 the origin at x 1 the jacobian matrix becomes upper triangular and its eigenvalues are p 1 and 0 with two zero eigenvalues ergo we conclude that the origin is a nonhyperbolic equilibrium and its stability cannot be assessed with the linearization of eq 2 i e hartmann grobman theorem does not apply meiss 2008 thus we proceed to study its stability by constructing a lyapunov function and applying the lasalle invariance principle lasalle 1960 a similar approach has been used by other investigators to assess the stability of other ecological models hsu 1978 hsu and huang 1995 for completeness sake we explain in appendix d the concept of lyapunov function and lasalle invariance principle now we state that x 1 is an asymptotically stable equilibrium whenever p 1 0 p 2 0 and p 3 0 these conditions on the parameters are the main assumptions of proposition 3 1 vide infra proposition 3 1 stability of x 1 the proof is in appendix b and uses the concept of lyapunov function explained in appendix d and the lasalle invariance principle d 1 3 2 2 stability of x 2 x 2 is given by eq 7b the jacobian matrix evaluated at x 2 is upper triangular and its eigenvalues are p 1 κ a f 1 p 2 p 1 and κ a f 1 p 3 p 1 p i s are defined in eq 6 observe that x 2 is hyperbolic if p 1 0 and p 2 0 and p 3 0 in such case then the stability of x 2 is established as follows 1 if p 1 0 p 2 0 and p 3 0 then x 2 is asymptotically stable an attractor or sink in this case the real part of all eigenvalues is negative 2 if p 1 0 p 2 0 and p 3 0 then x 2 is a repulsor source in this case the real part of all eigenvalues is positive 3 x 2 is a saddle point if it is still hyperbolic but none of the previous conditions hold in the case of x 2 being nonhyperbolic the stability of x 2 must be assessed through the lyapunov function technique used to study the stability of x 1 3 2 3 stability of x 3 x 3 is given in eqs 7c 8 the jacobian matrix evaluated at x 3 is d x g x 3 κ a p 1 δ a where 11 a 1 κ a f 1 δ f m δ m f δ a f δ f m δ m f δ a m δ f m δ m f δ f m p 2 p 3 0 δ f m 2 p 3 δ m f p 2 p 3 δ m f 2 p 2 0 moreover the eigenvalues of d x g x 3 are κ a p 1 δ multiplied by the roots of the characteristic polynomial of a the roots of the characteristic polynomial of a are the solutions of 12 0 p λ det a λ i λ 3 b λ 2 c λ d where b f 1 κ a 1 δ m f δ f m c p 2 p 3 δ mf δ fm δ mf δ fm δ af δ fm δ am δ mf and d p 2 p 3 δ m f 2 δ f m 2 κ a 1 δ also the coefficients of the characteristic polynomial in eq 12 satisfy the following conditions 1 b 0 because all the parameters and the environmental functions are positive 2 the expression p 2 p 3 δ mf δ fm 0 because the δs are always positive and in order for x 3 to be biologically feasible p 2 0 and p 3 0 ergo the sign of c is determined by the expression δ mf δ fm δ af δ fm δ am δ mf 3 d 0 since the δs are positive and in order to have a biologically feasible x 3 then p 2 0 p 3 0 and δ 0 the solutions of eq 12 are given by cardano and tartaglia s formulae if we take b 0 and d 0 the formulae simplify we used mathematica to obtain the simplified expressions to expressions for which are difficult to assess the signs of the real part of such solutions to study the stability of x 3 in appendix c we state a list of remarks from which we infer proposition 3 2 the proof of the proposition is also in appendix c the assumptions on that proposition comprise the stability conditions of x 3 proposition 3 2 stability of x 3 if p 1 0 p 2 0 p 3 0 and none of the solutions eigenvalues of eq 12 is neither zero nor purely imaginary then x 3 is either an unstable equilibrium or a saddle equilibrium point 2 2 a saddle equilibrium occurs whenever all the eigenvalues of d x g x 3 have nonzero real part but they do not have the same sign this means that there are some trajectories that start close to x 3 and stay close to x 3 as t whereas other trajectories start close to x 3 but go farther away from x 3 as t proposition 3 2 can be modified by adding the assumption that inequality c 2 holds true in that case x 3 is a saddle equilibrium point the reason for this is that according to the gershgorin disc theorem quateroni et al 2007 geršgorin 1931 the union of the gershgorin discs eq c 1 contains the eigenvalues of a furthermore inequality c 2 ensures that r 1 and r 2 r 3 are disjoint ergo r 1 must contain a real negative eigenvalue thus by the descartes s rule of signs one of other two remaining eigenvalues must be a negative real number and the other a positive one therefore x 3 is a saddle equilibrium point it is noteworthy that if any of the eigenvalues solutions of eq 12 is zero or have a zero real part then the stability of x 3 cannot be assessed by inspecting the eigenvalues of the jacobian matrix at x 3 but rather by constructing a lyapunov function 3 2 4 stability of x 4 and x 5 x 4 is given by eq 7d the jacobian matrix evaluated at x 4 is a lower triangular matrix with eigenvalues p 1 δ am c δ fm c and 0 where c ℝ because of the 0 eigenvalue we cannot use the linearization of eq 2 to assess the stability of x 4 two modifications to proposition 3 1 yield the stability conditions for x 4 the modifications are that the lyapunov function is redefined as v x 1 2 x x 4 2 2 and that it is also assumed that x 3 0 c 0 where c l 3 and l 3 is the maximum concentration of m in a fixed volume of coral this yields another proposition whose proof is analogous to proposition 3 1 the assumptions of such proposition are indeed the stability conditions x 5 is given by eq 7e and its stability conditions are analogous to those of x 4 table 2 summarizes the stability conditions of the equilibrium points 4 results we numerically solved the model eq 2 using the numerical differentiation formulas ndf as implemented in matlab details about the ndf are in quateroni et al 2007 shampine and reichelt 1997 figs 6 and 8 were done using the mathematica platform the computing resource was a linux workstation with 40 computing cores and 128 gb of memory 4 1 results for different parameters configurations we show simulations that correspond to different parameter configurations that satisfy the various stability conditions for the equilibria that were obtained in section 3 the initial condition in this set of simulations was 0 0897 0 1 0 1 t this was with the normalized model 4 1 1 an asymptotically stable x 1 in proposition 3 1 we stated the conditions for asymptotic stability of x 1 see also table 2 fig 2 shows a simulation in that such stability condition is met in this case we had to set β f 0 9 δ f e d β m 0 9 δ m e d and the value given by f 1 was set to 90 of δ a note in fig 2 that x 1 which can be interpreted as total extinction of the polyp s population is an attractor thus under the mentioned parameter configuration if the ic is close in the 2 norm sense to x 1 then the polyp s population solution of eq 2 evolves towards extinction 4 1 2 an asymptotically stable x 2 in section 3 and table 2 we gave the stability conditions x 2 fig 3 shows a simulation in which such stability condition is satisfied hence we set β f 0 9 δ f e d and β m 0 9 δ m e d the condition p 1 0 is satisfied using the parameters in table 1 fig 3 shows that indeed x 2 eq 7b is an attractor or sink for the parameter configuration given above note that x 2 is not biologically realistic because it is expected that some amount of fp and m is going to be present under all circumstances except after polyp s death 4 1 3 x 3 is a saddle equilibrium in section 3 we concluded that x 3 is either a saddle or an unstable equilibrium whenever the conditions in proposition 3 2 are satisfied fig 4 shows a simulation that satisfies the stability condition in proposition 3 2 3 3 that is p j 0 for j 1 2 3 the eigenvalues of d x g x 3 are 0 0678 0 0232 and 0 0472 for deep and 0 0567 0 0471 0 0235i and 0 0471 0 0235i for shallow the parameter values that we used are in table 1 the figure shows that in this case the trajectory solution of eq 2 with the given ic evolves towards x 3 thus we conclude that x 3 is a saddle equilibrium 4 2 results for different initial conditions we numerically solved the model equation to simulate 2 biologically relevant cases each case corresponds to different initial conditions ics with parameter configuration as in table 1 the cases are case 1 fp concentration is less than m concentration case 2 fp concentration is greater than m concentration 4 2 1 case 1 fp less than m fig 5 show simulations in which the ic satisfied the constraint that the fp concentration is less than or equal to the m concentration each color represents a different simulation i e a solution with a different ic we took 27 linearly spaced points from the set 0 08971 0 8971 0 1 0 5 0 5 1 as ics in fig 5 panels a c and e show simulations for shallow configuration whereas panels b d and f show results for deep configuration observe that in some simulations for both shallow and deep the solution evolves toward the equilibrium x 4 eq 7d but we also noted that other simulations including the case in which the initial concentrations of fp and m are similar dashed lines the ode system evolves toward x 3 eq 7c this confirms numerically that x 3 is a saddle equilibrium it is important to mention that in fig 5e and 5 f although the dashed line seems to reach zero the value that they actually reach is about 0 5667 and 4 4486 respectively it is also noteworthy that the proportion of polyps under both configurations have the same order of magnitude throughout the simulation cf fig 5a and 5 b but in contrast for fp and m fraction the variation swings in fraction values under shallow configuration is smaller than under deep configuration for fp cf fig 5c and 5 d for m cf fig 5e and 5 f fig 6 shows the corresponding phase portraits and basins of attraction 4 4 informally the basing of attraction is the maximal trapping region a trapping region is found numerically by computing the vector field and verifying it point inward on the boundary meiss 2008 fig 6 for shallow and deep show that the basing of attraction is indeed the first octant each black curve corresponds to a solution of the model with ic depicted as a either blue or yellow point blue points represent ic randomly uniformly distributed chosen from the region defined for case 1 whereas yellow points were randomly chosen from a neighborhood of x 3 the black green and red point are x 1 x 2 and x 3 respectively in both phase portraits we observe that some solutions evolve toward x 3 whereas others evolve away from it thus the plots show numerically that x 3 is a saddle equilibrium 4 2 2 case 2 fp greater than m fig 7 show simulations for which the ic satisfied the constraint that the fp concentration is greater or equal than m concentration each color represents a different simulation in this case we took 27 linearly spaced points from the set 0 08971 0 8971 0 5 1 0 1 0 5 as ics in fig 7 panels a c and e show simulations for shallow configuration whereas panels b d and f show results for deep configuration observe that in some simulations for both shallow and deep the solution evolves toward the equilibrium x 5 eq 7e but we also noted that other simulations including those in which the initial concentrations of fp and m are similar dashed lines the ode system evolves toward x 3 eq 7c this confirms numerically that x 3 is a saddle equilibrium it is important to mention that in fig 7c although the dashed line seems to reach zero the value that it actually reaches is about 0 5665 it is also noteworthy that the proportion of polyps under both configurations have the same order of magnitude throughout the simulation cf fig 7a and 7 b but in contrast for fp and m fraction the variation under shallow configuration is smaller than under deep configuration for fp cf fig 7c and 7 d for m cf fig 7e and 7 f fig 8 shows the corresponding phase portraits and basins of attraction the figure shows that the basing of attraction is the first octant analogous to fig 6 each black curve corresponds to a trajectory with ic depicted as a either blue or yellow point blue points represent ic randomly chosen from the region defined for case 2 while yellow points were randomly chosen from a neighborhood of x 3 the black green and red point are x 1 x 2 and x 3 respectively we observe in both phase portraits that some solutions evolve toward x 3 whereas others evolve away from it thus similar to the case fp m the plots show numerically that x 3 is indeed a saddle equilibrium 4 3 local bifurcation analysis we say that our model eq 2 is structurally stable whenever a small change in a model parameter do not cause qualitative changes 5 5 the concept of qualitative change is explained with precision in meiss 2008 wiggins 2000 whenever a change in the model parameters cause the orbits generated by the model to not being equivalent topologically conjugate between themselves we say that a qualitative change in the solutions of the model occurs in the solution of the model i e when the model shows no bifurcations we are focusing in bifurcation of the equilibria found in section 3 1 therefore this analysis is a local bifurcation analysis moreover this analysis pays attention to codimension 6 6 loosely speaking the codimension of a bifurcation is the minimal number of parameters that have to be changed in order to observe the bifurcation 1 bifurcations a detailed discussion about bifurcations is in meiss 2008 wiggins 2000 we did the numerical bifurcation analysis using matcont matcont is a numerical continuation and bifurcation analysis software package implemented in matlab the documentation of such package is found in dhooge et al 2003a b 2004 the work of several investigators dhooge et al 2006 govaerts et al 2005 govaerts 2000 was used as a guide in our analysis which we summarize as procedure in g 1 table 3 summarizes the results of the numerical bifurcation analysis for the equilibria of our model before elucidating the results in table 3 we state the following remarks equilibria x 1 x 4 and x 5 were excluded from the table because their jacobian matrix is singular regardless of the parameter values ergo is impossible to generate a continuation equilibrium curve starting from those equilibria moreover x 4 and x 5 are uninteresting from the biological standpoint the parameters were perturbed in two ways toward values greater and toward values lesser than the value in table 1 viz the forward and backward direction respectively table 3 only includes results that are biologically relevant inside first octant observe in table 3 that under the conditions that x 3 starts as a saddle equilibrium we only found parameter values that make either x 2 or x 3 a neutral saddle these results allow us to conclude that because our model does not exhibit codimension 1 bifurcations ergo it is structurally stable in terms of that type of bifurcation 5 discussion the stability analysis section 3 and the simulations in figs 2 4 showed that under a specific set of conditions for the parameters there are 3 biologically relevant equilibria eqs 7a 7c x 1 polyps cease to exist at a certain point in time and consequently there are no fp and m syntheses x 2 the number of polyps eventually reaches a certain value while fp and m syntheses are reduced to their minimum and x 3 number of polyps as well as fp and m syntheses varied with time until they become nonzero constants with respect of time furthermore we showed that there is another set of conditions that determine the asymptotic stability of the equilibria see section 3 and table 2 it is conspicuous that albeit the model has 12 parameters the core feasibility and stability conditions depend on the 3 parameter combinations p 1 p 2 and p 3 defined in eq 6 and on the normalized depth d moreover the signs of the p i s can be changed by changing d in biological terms p 1 can be interpreted as population growth of polyps as it affects the number of polyps born minus the number of polyps dying meanwhile p 2 and p 3 can be interpreted as a difference of rates the rates at which fp and m are synthesized minus the rates at which these chemical compounds are degraded furthermore in some cases the stability condition of an equilibrium precludes the other two from being biologically feasible for example the stability condition of x 1 moves x 2 and x 3 outside the first octant see table 2 in biological terms once the coral is dying that is x 1 t 0 as t there will be no recovery unless some factor which could be an environmental factor affects the stability condition of x 1 vide infra similarly the stability condition of x 2 makes x 3 biologically unfeasible regarding the stability of x 3 the contrapositive statement of proposition 3 2 says that if x 3 is a sink then at least one of the following statements is true at least one p i 0 for i 1 2 3 or there is a solution of eq 12 that is zero or purely imaginary i e x 3 is nonhyperbolic hence in our model eq 2 if x 3 is an attractor sink then it is either biologically unfeasible or nonhyperbolic being a nonhyperbolic equilibrium point means that in a neighborhood of x 3 our model is not equivalent to its linearization thus the nonlinear part of our model determines whether x 3 is stable figs 3 4 show that at equilibrium the proportion of polyps is greater at shallow depth than at deep depth besides fig 4 show that at equilibrium x 3 the amount of fp and m is greater at greater depth these results are in agreement with our field observations and with the limiting resource theory model assumption 1 that states the less resources the coral allocates into immunity more resources could be allocated into growth figs 5 8 show numerically that x 3 is indeed a saddle equilibrium thus from some starting values ics the system evolves toward x 3 whereas from other ics the system evolves away from x 3 furthermore fig 6 and 8 show numerically that trajectories solutions of the ode system that start in the first octant remain in the first octant another important issue to elucidate is whether given some initial condition changes in the environmental variables sst or sr which are represented in the model by the depth parameter d in the environmental functions make the system evolves toward one equilibrium point versus another note that this issue is in essence how a change in a parameter value affects the stability of equilibria thus is an issue related to bifurcations in our model suppose that our model eq 2 is solved with ic close to some equilibrium point under the corresponding stability conditions for such point now if we change d how the solution trajectory is affected as t to answer that consider the following cases case 1 x 1 stable sink i e eventual collapse of the coral colony suppose that our model is solved with ic close to x 1 and with p i 0 i i e under the conditions that makes x 1 an sink and x 2 a repulsor see section 3 as depth decreases 7 7 as depth increases f 1 d decreases whereas f 2 d and f 3 d increases thus there can be a sign change for p 2 and p 3 but not for p 1 f 1 d increases whereas f 2 d and f 3 d decreases thus there may be a sign change for p 1 negative to positive but not for p 2 and p 3 in that case we obtain p 1 0 p 2 0 and p 3 0 therefore x 2 becomes an attractor see 2 and this implies that the trajectory might evolve depending on the ic from x 1 to x 2 note that under this scenario x 2 flips from source to sink similar to a transcritical bifurcation and x 1 stops being a sink moreover in this case it will not be possible to get p i 0 i thus the conditions for x 3 to be a saddle are not satisfied case 2 x 3 stable sink i e a coral colony with number of polyps and amount of protein that have a nonzero constant value in this case proposition 3 2 and its contrapositive vide supra establish that the nonlinearities of our model make a biologically feasible x 3 to be asymptotically stable we hypothesize that changes in one or more model parameters affect the nonlinear part of the model and that determines stability of x 3 case 3 x 3 a saddle i e some trajectories evolve to x 3 and other away from x 3 as t suppose that our model is solved with ic close to x 3 and that all assumptions of proposition 3 2 are satisfied in particular we focus on the assumption p i 0 i as depth decreases 8 8 as depth increases f 1 d decreases whereas f 2 d and f 3 d increases thus there can be a sign change for p 1 but not for p 2 or p 3 f 1 d increases whereas f 2 d and f 3 d decreases thereby p 1 must remain positive but p 2 or p 3 may become negative in that case x 3 becomes biologically unfeasible but x 2 becomes an attractor if both p 2 and p 3 are negative in any case the nonlinearities of our model must play a role in determining the stability of x 3 case 4 x 2 stable suppose that our model is solved with ic close to x 2 and with p 1 0 p 2 0 and p 3 0 that is under the conditions that makes x 2 an sink as depth decreases f 1 d increases whereas f 2 d and f 3 d decreases hence none of the p i i 1 2 3 can change sign and no change in the stability of x 2 occurs if depth increases the signs of p i could flip if all p i become negative the trajectory may evolve toward x 1 because it would become an attractor but if not all of the p i become negative then the trajectory may evolve toward x 1 or elsewhere the numerical bifurcation analysis in section 4 3 showed that our model is structurally stable it is noteworthy that the reason for not finding a value of depth that produce some change of stability of equilibria is that for the baseline value of the other parameters that comprise p i besides d a solution of p i 0 for d lies outside the interval that we looked into this finding does not preclude the model to exhibit global bifurcations or some codimension 2 or higher codimension bifurcations furthermore we found conditions that ensure that the point x 3 is a saddle equilibrium hence there are going to be some orbits solutions of eq 2 that start close to x 3 and evolve towards it whereas other orbits start close to x 3 evolve away from x 3 the mathematical implications of this might be interesting for instance note that whenever p 1 0 p 2 0 and p 3 0 which is one of the conditions for x 3 to be a saddle makes also x 2 to be a saddle ergo a saddle connection or heteroclinic 9 9 informally an heteroclinic orbit is a trajectory that connects two saddle equilibrium points an homoclinic orbit is a special case where the two equilibria are the same orbit is possible such a scenario would be in agreement with the findings of neutral saddle points for these two equilibria in the local bifurcation analysis see section 4 3 in biological terms a saddle point could reflect a change in an environmental condition such as an increase in sst that makes the growth rate of a colony to decrease to extinction phenomena like the appearance or the disappearance of a saddle connection is associated with global bifurcations although the study of the existence of global bifurcations is beyond the scope of this work if they indeed exist in our model then this could indicate that the system that the model seeks to represent have different configurations and that parameter changes affect the system as a whole i e more than one equilibrium point at once 6 conclusions we constructed a mathematical model that simulate the effects of the environment on a cervicornis the model captures the essence of how environmental variables sst and sr affect the resource allocation between polyp population growth and two of its immune system constituents fp and m as a function of time in that regard the model succeeds as a predictor of the effect of climate change on the coral population yet we understand that the biology behind this model is far more complicated as we are beginning to understand the multiple roles of fp and m in corals thus we could have partially missed the roles of these as immune constituents and their trade off against other life history traits such as growth nonetheless this model could still be useful as a conservation tool as it fairly simulates the coral reality with the available knowledge we can modify the model to capture phenomena associated with abrupt seasonal changes this can be done in at least two ways first to make some of the parameters e g birth rate time dependent this will make the model a nonautonomous ode system thereby making it more difficult to analyze second to change some of the parameters at discrete times seasons this will encapsulate our model which is a continuous time model into a discrete time model acknowledgments we thank mariano marcano loretta roberson and juan luis sanchez we also extend our gratitude to fundación toyota ford motor company foundation of puerto rico the university of puerto rico sea grant college program noaa grant number na14oar4170068 project r 102 1 14 university of puerto rico río piedras campus office of research and graduate studies institutional research fund fipi 20fip2550017 00 and 20fip3490018 00 and programa de iniciativas de investigación pii 2017 appendix a description of nullclines a nullcline defines the set of values that makes the corresponding model variable time independent i e derivative with respect of time is zero let g 2 x μ be the rhs of eq 2b by definition of nullcline the x 2 nullcline is given by the equation g 2 x μ 0 this implies a 1 x 2 p 2 x 1 δ f m x 3 0 x 2 0 or x 3 p 2 δ f m x 1 note that for x 3 to be biologically plausible p 2 0 similarly let g 3 x μ be the rhs of eq 2c and take g 3 x μ 0 thus we obtain a 2 x 3 p 3 x 1 δ m f x 2 0 x 3 0 or x 2 p 3 δ m f x 1 observe that for x 2 to have a biological meaning p 3 0 finally let g 1 x μ be the rhs of eq 2a and take g 1 x μ 0 ergo a 3 f 1 x 1 1 x 1 κ a δ a x 1 δ a f x 2 δ a m x 3 x 1 0 x 1 0 or x 1 κ a f 1 p 1 δ a f x 2 δ a m x 3 likewise for x 1 to be biologically feasible p 1 δ af x 2 δ am x 3 0 therefore eqs a 1 a 3 are the nullclines of the ode system 2 appendix b proof of proposition 3 1 the assumptions of proposition 3 1 are the stability conditions of x 1 next we restate the proposition and give its proof let v x 1 2 x 2 2 p 1 0 p 2 0 and p 3 0 then the equilibrium point x 1 is asymptotically stable proof the goal is to apply lasalle invariance principle d 1 thus we define ω 0 l 1 0 l 2 0 l 3 where l 1 κ a and l 2 l 3 are the maximum concentrations of fp and m that a fixed volume of coral polyps in a given volume can produce note that ω is forward invariant for the following reasons first any trajectory solution of eq 2 that starts in ω will not escape the first octant because of the zero nullclines eqs a 1 a 3 second neither the number of polyps nor the protein concentrations is unbounded the number of polyps cannot increase beyond the carrying capacity and the proteins concentrations must be bounded because the polyps synthesize proteins up to a finite positive concentration note also that ω is a closed and bounded subset of ℝ 3 thus it is compact hasser and sullivan 1991 next we show that v is a lyapunov function d observe that v x 1 2 x 2 2 1 2 k 1 3 x k 2 0 x ℝ 3 and v x 1 0 we proceed to establish the nonincreasing property of v along the trajectories given by eq 2 let g x μ be the rhs of eq 2 we assume x ω and obtain the following b 1 d d t v x v x x v x g x μ x 1 2 p 1 f 1 x 1 κ a δ a f x 2 δ a m x 3 x 2 2 p 2 x 1 δ f m x 3 x 3 2 p 3 x 1 δ m f x 2 b 1 d d t v x v x x v x g x μ x 1 2 p 1 f 1 x 1 κ a δ a f x 2 δ a m x 3 x 2 2 p 2 x 1 δ f m x 3 x 3 2 p 3 x 1 δ m f x 2 observe that because p 1 0 p 2 0 p 3 0 and x ω then d d t v x 0 ergo v is a lyapunov function in ω we emphasize that to apply lasalle s principle we only need the nonincreasing property of v to hold true appendix c proof of proposition 3 2 the following remarks lead to proposition 3 2 the proof of the proposition is also shown in this section 1 because the degree of the polynomial in eq 12 is 3 the equation has either 3 real solutions or 1 real solution and 2 complex solutions a complex conjugate pair 2 by descartes s rule of signs see appendix e regardless of the value taken by c we conclude the following a eq 12 has a maximum and exactly 1 positive real root b eq 12 has a maximum of 2 negative real roots furthermore the equation could have 0 or 2 negative real solutions note that the rule of signs leads to the conclusion that if all the solutions of eq 12 are nonzero real numbers then 2 of them must be negative and 1 positive on the other hand if only one solution is real the other are a complex conjugate pair then it must be positive 3 by gerschgorin disc theorem quateroni et al 2007 geršgorin 1931 the eigenvalues of matrix a recall that d x g x 3 κ a p 1 δ a and that κ a p 1 δ 0 are contained within the discs c 1a r 1 z ℂ z f 1 κ a 1 δ mf δ fm r 1 where r 1 δ fm δ mf δ af δ am c 1b r 2 z ℂ z r 2 where r 2 δ fm p 3 p 2 δ fm c 1c r 3 z ℂ z r 3 where r 3 δ mf p 2 p 3 δ mf observe that r 1 s center is at some point in the negative part of the real axis whereas r 2 and r 3 are concentric and their center is the origin inasmuch as we seek a stability condition for x 3 we want to impose a condition on the parameters that yield eigenvalues with a negative real part to achieve that we start by seeking that r 1 is contained in the negative part of the complex plane and disjoint from r 2 r 3 such condition is c 2 f 1 κ a 1 δ m f δ f m r 1 max r 2 r 3 this guarantees that the eigenvalue in r 1 which is one of the solutions of eq 12 is a negative real number moreover since matrix a is irreducible 10 10 a matrix is irreducible if its associated directed graph is strongly connected then the eigenvalue in r 1 is not in its boundary from the previous list of remarks we infer following proposition proposition 3 2 the assumptions on that proposition comprise the stability conditions of x 3 if p 1 0 p 2 0 p 3 0 and none of the solutions eigenvalues of eq 12 is neither zero nor purely imaginary then x 3 is either an unstable equilibrium or a saddle equilibrium point 11 11 a saddle equilibrium occurs whenever all the eigenvalues of d x g x 3 have nonzero real part but they do not have the same sign this means that there are some trajectories that start close to x 3 and stay close to x 3 as t whereas other trajectories start close to x 3 but go farther away from x 3 as t proof if p 1 0 p 2 0 p 3 0 then all the components of x 3 are positive and the characteristic polynomial of the matrix δ κ a p 1 d x g x 3 a is given by eq 12 whose solutions are given by the cardano and tartaglia s formulae since we assumed that none of the expressions in cardano and tartaglia s formulae is purely imaginary or zero then x 3 is an hyperbolic equilibrium and by hartman grobmann theorem meiss 2008 the linearization of eq 2 is sufficient to describe such equation in a neighborhood of x 3 owing to the descartes s rule of signs eq 12 has exactly 1 positive real root thereby just one of the following two cases holds case 1 the discriminant 12 12 the discriminant of the cubic eq 12 is bc 2 4db 3 27d 2 4c 3 18bcd of eq 12 is nonnegative hence all the roots are real inasmuch as we assumed that they are nonzero by descartes s rule of signs then 1 of them is positive and the other 2 must be negative ergo x 3 must be a saddle equilibrium case 2 the discriminant of eq 12 is negative thus one of the roots is real and the other are a complex conjugate pair owing to the descartes s rule of signs and because we assumed nonzero roots the real root must be positive additionally we supposed that the real parts of the complex conjugate pair are nonzero thus if the real parts of the complex conjugate pair are positive then x 3 is an unstable equilibrium whereas if the real parts of the complex conjugate pair are negative then x 3 is a saddle equilibrium appendix d lyapunov function and lasalle invariance principle a lyapunov function is a generalization of the concept of total energy of a physical system the textbook definition see meiss 2008 vidyasagar 2002 wiggins 2000 of lyapunov function is that v ℝ n ℝ is a lyapunov function for equilibrium x if it is a c 1 function with the following properties v x 0 v is positive semidefinite i e v x 0 for all x in a neighborhood of x v is nonincreasing along the trajectories of the ode system that start in a neighborhood of x that is let g x be the rhs of the ode system and d dt v x v x x v x g x 0 x in a neighborhood of x if one can construct a lyapunov function for a given equilibrium then the equilibrium is lyapunov stable if v is decreasing i e dv dt 0 then the equilibrium is asymptotically stable meiss 2008 the lasalle invariance principle generalizes even more the concept of lyapunov function in that only the decreasing property is needed for completeness sake we state the lasalle invariance principle theorem d 1 lasalle 1 let ω be a bounded closed compact set with the property that every solution of a system of ordinary differential equations x g x which begins in ω remains for all future time in ω suppose there is a scalar function v x which has continuous first partials in ω and is such that v x 0 in ω let e be the set of all points in ω where v x 0 let m be the largest invariant set in e a set is an invariant if solutions of the ode system that start in the set remain in the set for all t then every solution starting in ω approaches m as t theorem d 2 lasalle 2 let ω denote the closed region defined by v x l and suppose that v x has continuous first partials in ω if in addition ω is bounded and v x 0 in ω then every solution starting in ω approaches m as t where m is defined as in theorem d 1 the proofs of theorems d 1 and d 2 can be found in lasalle 1960 1968 appendix e descartes s rule of signs we take the following statement of descartes s rule of signs from quateroni et al 2007 theorem e 3 descartes s rule of signs let p n be a polynomial of degree n and n 0 denote by ν the number of sign changes in the set of coefficients a j and by k the number of positive real roots of p n each counted with its multiplicity then k ν and ν k is an even number the rule can be applied to bound the number of negative real roots by applying the rule to the polynomial p n x appendix f normalized model here we normalize model quations 2 let y 1 t x 1 t κ a y 2 t x 2 t x 2 max and y 3 t x 3 t x 3 max where x 2 max and x 3 max are the maximum saturation concentration of fluorescent protein and melanin respectively thereby eq 2 becomes κ a y 1 t f 1 d κ a y 1 1 y 1 δ a κ a y 1 δ a f x 2 max y 2 δ a m x 3 max y 3 κ a y 1 x 2 max y 2 t f 2 d x 2 max κ a y 2 y 1 δ f x 2 max κ a y 2 y 1 δ f m x 2 max x 3 max y 3 y 2 x 3 max y 3 t f 3 d x 3 max κ a y 3 y 1 δ m x 3 max κ a y 3 y 1 δ m f x 2 max x 3 max y 2 y 3 which can be written as y 1 t f 1 d y 1 1 y 1 δ a y 1 δ a f x 2 max y 2 δ a m x 3 max y 3 y 1 y 2 t f 2 d κ a y 2 y 1 δ f κ a y 2 y 1 δ f m x 3 max y 3 y 2 y 3 t f 3 d κ a y 3 y 1 δ m κ a y 3 y 1 δ m f x 2 max y 2 y 3 and further simplified to y 1 t f 1 d y 1 1 y 1 δ a y 1 δ a f y 2 δ a m y 3 y 1 y 2 t f 2 d y 2 y 1 δ f y 2 y 1 δ f m y 3 y 2 y 3 t f 3 d y 3 y 1 δ m y 3 y 1 δ m f y 2 y 3 where δ a f δ a f x 2 max δ a m δ a m x 3 m ax f 2 d κ a f 2 d δ f δ f κ a δ f m δ f m x 3 max f 3 d κ a f 3 d δ m δ m κ a and δ m f δ m f x 2 max note that in system 3 all variables are dimensionless and the parameters are in units of day 1 appendix g remarks on local bifurcation analysis we did a numerical bifurcation analysis using matcont the analysis involves the construction of an equilibrium curve and the classification of the points that comprise it the equilibrium curve is a continuation curve it is constructed starting from an equilibrium point and changing a model parameter the classification of points in the equilibrium curve involves two things the computation of the eigenvalues of the jacobian matrix evaluated at the corresponding point in the equilibrium curve and the evaluation of different test functions a detailed explanation on how the points are classified and about the meaning of the categories can be found in dhooge et al 2006 meiss 2008 the points are classified according to the following categories a fold point also known as limit point is an equilibrium point for which the jacobian matrix evaluated at the equilibrium has an eigenvalue that becomes zero as a parameter crosses certain value bifurcation value a limit point indicates that a saddle node bifurcation might occur a hopf point is an equilibrium point for which the jacobian matrix evaluated at the equilibrium has a pair of complex conjugate eigenvalues that cross the imaginary axis as a parameter crosses certain value a hopf point indicates either that a hopf bifurcation birth of limit cycle or that a more complex codimension 2 bifurcation might be occurring that depends on the sign of the first lyapunov coefficient as well as other factors a neutral saddle point is a point with two real eigenvalues that sum zero a neutral saddle indicates that a codimension 2 bifurcation or a more complex bifurcation related to an homoclinic 13 13 loosely speaking an homoclinic orbit is a trajectory that connects a saddle point to itself or heteroclinic 14 14 informally an heteroclinic orbit is a trajectory that connects two saddle equilibrium points an homoclinic orbit is a special case where the two equilibria are the same orbit might exist it is noteworthy that both neutral saddle and hopf point are zeros of one of the test functions that matcont uses to detect them based on the work of dhooge et al 2006 govaerts et al 2005 govaerts 2000 dhooge et al 2006 govaerts et al 2005 govaerts 2000 we did bifurcation analysis using the following procedure procedure g 1 procedure for local bifurcation analysis input the equilibrium points in section 3 1 we obtained their exact expression in terms of the model parameters output bifurcation points in phase parameter space if there are any and type of bifurcation 
25025,environmental factors associated with climate change such as increasing sea surface temperature sst and solar radiation sr have negatively impacted corals throughout their geographic ranges one such coral which has been seriously impacted by these stressors is the staghorn coral acropora cervicornis to reduce the effects of such stressors this coral utilizes fluorescent proteins fps and melanin m these constitutive immune components quench reactive oxygen species ros produced during thermal stress and absorb or reflect potentially damaging light the synthesis of these components are nonetheless energetically costly hence production of these protective compounds may be traded off against other vital functions such as growth in this study we develop a mathematical model viz a system of ordinary differential equations that simulates the growth of a cervicornis branches under different regimes and combinations of sst and sr the model assumes that polyps are the functional unit of the coral and that the concentration of fps and m are inversely proportional to sst and sr intensity to develop the model we use empirical birth and mortality rate of polyps and the maximum number of polyps per unit area and theoretical parameters concentration of fps m produced and trade offs with growth the model simulates how changes in fps and m due to environmental changes affect the growth capacity of a cervicornis the model as well as its stability analysis show that polyp growth is affected by sr and sst hence the model will help in understanding how corals will respond to future changes in climate keywords acropora cervicornis dynamical system lyapunov stability 1 introduction global climate change is having a profound and potentially devastating effect on many marine environments including coral reef ecosystems climate change is primarily associated to the atmospheric deposition of carbon dioxide co2 among others greenhouse gases a direct consequence of this accumulation of greenhouse gases in the atmosphere is the increase of sea surface temperature sst there is compelling evidence that points towards an increase of 0 4 0 74 c in the mean global sst during the past century hoegh guldberg et al 2007 likewise solar radiation sr reaching the earth s surface in its different wavelengths e g ultraviolet radiation uv and photosynthetic active radiation par has also increased partly as a result of ozone layer depletion häder et al 2007 rising sst and increased sr are physiological stressors to marine organisms such stressors when severe might jeopardize vital functions such as growth reproduction and the capacity to fight diseases thereby threatening the viability of coral reef populations reef building corals are particularly vulnerable to sst and sr slight increments in temperature 1 c over the average summer temperature in conjunction with elevated radiation have caused large scale coral bleaching hoegh guldberg et al 2007 lesser et al 1990 coral bleaching is the phenomenon by which corals lose their algal endosymbionts or the algal pigments degrade iglesias prieto et al 1992 moreover the aforementioned environmental stressors may also promote coral diseases which also reduce the corals s capacity to growth reproduce and survive to minimize or at least reduce the negative impact of sst and sr corals have developed a suite of immune mechanisms including the syntheses of pigments such as fluorescent proteins fps and melanin m fps and m are ubiquitous to corals thus they are primary constituents of coral s innate immune system roth et al 2010 in general these immune constitutive pigments possess multiple functions within corals these chemical compounds have photoprotective properties as they scatter light and absorb potentially harmful high energy radiation salih et al 2000 palmer et al 2010 mydlarz and harvell 2007 and also have the capacity to quench reactive oxygen species ros which dramatically increase under high levels of abiotic stressors leading to coral bleaching as is in the case of other living organisms corals have a finite amount of resources to be allocated into a multitude of vital functions e g immune defense and growth among others given these resource constraints the allocation of resources into a vital function such as immune defense will be traded off against other vital functions such as growth several studies conducted on corals support this paradigm for instance palmer et al 2010 compared the activity of phenoloxidase po an enzyme involved in m biosynthesis with the number of amoebocyte containing m granules melanocytes of two scleractian corals porites sp and acropora millepora that study revealed that porites sp invests considerably more resources into the aforementioned immune constituent than a millepora as it exhibited higher numbers of melanocytes than a millepora this investment of resources into immunity provides porites with higher disease and bleaching resistance by contrast acroporids allocate more resources into growth when compared to porites as acroporid corals may growth several cm in length per month whereas porites corals may growth several cm per year palmer et al 2010 however for acroporids the rather rapid growth is traded off at a cost in reduced immunity as acroporids are among the corals most susceptible to bleaching and disease corals rely on a suite of immune constituents including pigments such fps and m to protect against the threat of bleaching fps and m are ubiquitous to corals and serve as primary constituents of corals s innate immune system due to their multiple functions roth et al 2010 fps for instance have photoprotective properties as they scatter light and absorb potentially harmful high energy radiation salih et al 2000 fps also have the capacity to quench reactive oxygen species ros which dramatically increase under high levels of abiotic stressors leading to coral bleaching as in the case of fps m provides corals with photoprotection as well as it scatters and absorbs over 50 70 of harmful radiation such as uv radiation m is commonly found in a corals epithelial cells creating a physical barrier to prevent and or reduce harmful impact of radiation in addition m plays an important role in the inflammatory responses such as wound healing processes and the response to pathogens palmer et al 2010 as both fp and m are components of the response to the same environmental stressor i e sr and sst we infer that the degree of each response is proportional to the insult the objective of this study is to present and analyze a mathematical model which consists of a system of ordinary differential equations ode that simulates the immune response of a cervicornis under a finite resource budget scenario and different sst and sr regimes the mathematical model embodies a set of assumptions and hypotheses such assumptions and hypotheses can be examined by comparing the model results simulations with the observed behavior of the system that is simulated furthermore although the model is an abstraction of the biological system under consideration this model sufficiently captures the interaction between the coral and its environment so it helps to better understand the impact of environmental challenges within the coral thereby the model could be used to design better conservation policies or strategies to preserve corals i e it could be used as a conservation tool we have chosen a cervicornis coral as our biological model for two reasons 1 throughout their geographical extent a cervicornis populations have suffered unprecedented population declines these declines have motivated the implementation of several local and regional protection initiatives such as the inclusion of this coral species onto the us endangered species act esa and the red list of critically threatened species rlct 2 being in such precarious population state have motivate us to study the effect of sst and sr on the syntheses of fps and m and on its growth rate thus some of the parameters described on this model have been empirically estimated this paper is organized in the following way in section 2 we state the model assumptions describe the mathematical model and the model parameters section 3 is about the asymptotic stability analysis of the model thus we focus on how the model behaves as time increases to infinity in that section we also compute the equilibrium points analytically and assess their stability using different methods such as linearization of the ode system and lyapunov function in section 4 we present simulations results under different environmental conditions determined by the model parameters and initial conditions results regarding the structural stability of model are also presented in section 4 we discuss the results in section 5 for completeness sake we provide in the appendix details about the mathematical concepts that were used for the analysis of the model 2 mathematical model 2 1 model assumptions the following set of assumptions allow us to construct a model that simulates changes in a cervircornis s growth and immune system elements as a function of environmental changes 1 a cervircornis corals as all living organisms have a finite amount of resources including energy to be allocated into several vital functions such as somatic growth the increase in number of polyps or immune defenses given these resource constraints the allocation of resources into any given life history trade will be traded off against others live history traits 2 the syntheses of m and fp require the same amount of resources for both m and fp the behavior in terms of synthesis is similar 3 fp and m are synthesized within the polyps which are the basic units of coral 4 corals have a logistic somatic growth 5 sst and sr exert a similar stress to the coral and these affect both immune system constituents m and fp in a similar way i e as sst and sr increases the synthesis of m and fp decreases 6 sst and sr vary at the same rate with respect to water depth lee et al 2005 7 the effects of the two environmental variables sst and sr on coral polyps are embodied in the functions f d s where d represents normalized water depth normalized depth is defined as the ratio of depth to maximum depth where a cervicornis grows i e d d d max the maximum depth is 30 m according to the work of pang 1973 8 based on the limiting resource theory f 1 d affect the number of polyps as depth increases the number of polyps decreases likewise f 2 d and f 3 d affect the syntheses of fp and m respectively as depth increases the syntheses of fp and m concentration increases 9 f 1 d must be a positive decreasing and continuous functions of d f i d i 2 3 must be positive increasing and continuous functions of d 10 based on how sst and sr vary with depth sr according to lee et al 2005 we defined the environmental functions as 1a f 1 d c 2 e c 1 d 1b f 2 d β f e d 1c f 3 d β m e d where c 1 c 2 β f and β m are constants 11 changes in fp and m concentration are the main responses of the coral s immune system to environmental stress albeit other responses could possibly change the concentration of fp and m these immune constituents are sufficient to describe the coral s reaction to environmental stress based on these assumptions we constructed a mathematical model that consists of a system of ordinary differential equations ode fig 1 shows a schematic diagram of the model observe in the figure that given a finite energy budget at greater depth depth being a proxy for sst and sr less resources are dedicated to polyp growth ergo polyp growth is reduced whereas fp and m concentration is increased 2 2 model equations we constructed a model that simulates the growth of a cervicornis coral with sst and sr changing accordingly to the depth profile as follows 2a x 1 t f 1 d x 1 1 x 1 κ a δ a x 1 δ a f x 2 δ a m x 3 x 1 2b x 2 t f 2 d x 2 x 1 δ f x 2 x 1 δ f m x 3 x 2 2c x 3 t f 3 d x 3 x 1 δ m x 3 x 1 δ m f x 2 x 3 where x 1 represents the growth of a cervicornis coral in units of polyps per cm3 x 2 and x 3 represent fp and m concentrations in mmoles cm3 the parameters are d δ a κ a δ f δ m δ af δ am δ fm and δ mf the normalized depth d was defined in section 2 1 δ a and κ a are the natural death rate and maximal growth capacity of the a cervicornis branches respectively δ f and δ m are the breakdown rates of fp and m respectively δ af and δ am are the death rates of a branch due to the presence of fp and m respectively δ fm is the breakdown rate of fp due to the presence of m δ mf represents the breakdown rate of m owing to the presence of fp f 1 d f 2 d and f 3 d represent the environmental functions they incarnate the relation between d sst sr and the growth rate of a cervicornis or synthesis of fp and m observe in eq 2a that f 1 d acts as a birth rate of polyps β a similarly in eqs 2b 2c f 2 d and f 3 d act as modifiers of the synthesis rate of fp and m respectively moreover for the stability and bifurcation analysis the exact form of the functions is unimportant as long as they satisfy model assumption 9 section 2 1 the values for the c i in eq 1 were determined by fitting the functions to polyp s birth rate data as explained in section 2 3 furthermore the c i s must be positive because of the conditions that the environmental functions must satisfy see section 2 1 β f and β m represent the syntheses rate of fp and m respectively their values are in table 1 2 2 1 normalized model equations in order to facilitate the process of numerically solving the model equations eq 2 and their interpretation we normalize the model by letting y 1 t x 1 t κ a y 2 t x 2 t x 2 max and y 3 t x 3 t x 3 max where x 2 max and x 3 max are the maximum saturation concentration of fluorescent protein and melanin respectively thereby the model becomes 3a y 1 t f 1 d y 1 1 y 1 δ a y 1 δ a f y 2 δ a m y 3 y 1 3b y 2 t f 2 d y 2 y 1 δ f y 2 y 1 δ f m y 3 y 2 3c y 3 t f 3 d y 3 y 1 δ m y 3 y 1 δ m f y 2 y 3 where δ a f δ a f x 2 max δ a m δ a m x 3 max f 2 d κ a f 2 d κ a β f e d δ f δ f κ a δ f m δ f m x 3 max f 3 d κ a f 3 d κ a β m e d δ m δ m κ a and δ m f δ m f x 2 max for simplicity s sake we define β f κ a β f and β m κ a β m note that in system 3 all variables are dimensionless and the parameters are in units of day 1 the details on how the equations are normalized can be seen in appendix f 2 3 parameters the model has two parameters sets those that were estimated empirically and the theoretical parameters the empirical parameters are β a δ a and κ a we emphasize that the values of β a are used to fit the parameters for the environmental function i e c 1 and c 2 the theoretical normalized parameters are β f δ f β m δ m and d table 1 presents the baseline parameter values used in the simulations the empirical parameters were measured at two depths 4 572 and 12 19 m henceforth we define the 4 572 m group of measurements as shallow group and the 12 12 m group of measurements as deep group 2 3 1 empirical parameters 2 3 1 1 estimation of fluorescent proteins fps concentration to estimate fp we collected fragments from 20 colonies which were raised in nursery farms located at two depths 10 fragments per depth once collected each fragment was frozen and stored for further fps analyses through the spectral emission of these proteins following palmer et al 2009 with slight modification each frozen coral fragment e g the growing tips of the fragments was airbrushed individually to separate soft tissue from skeleton using a phosphate extraction buffer 50 mm phosphate buffer ph 7 8 with 0 05 mm dithiotheitol and individually collected into sterile tubes the crude extract was subsequently homogenized using a fisher scientific powergen 125 tissue homogenizer with a medium saw tooth tip for 30 s at low power the homogenized tissue slurry was then centrifuged at 4 c at 1900 g for 5 min the supernatant was aliquoted and stored at 20 c to measure fps concentration 30 μl of the extracted samples was placed in a black 96 well plate along with a control sample buffer only well triplicates of each sample were excited using a infinite 200 pro multimode microplate reader at 410 470 and 520 nm and the emission spectra measured from 400 nm to 850 nm at 5 nm intervals relative fluorescence and absorbance of each sample was normalized to total protein concentration determined using bradford reagent and measuring absorbance at 595 nm 2 3 1 2 estimation of po as a proxy for melanin m concentration po enzymatic activity was quantified as po po is an enzymatic precursor of melanin palmer et al 2011 we used the stored tissue portion obtained for fps biochemical analysis and we processed it as explained by palmer et al 2011 with slight the modifications described above po activity was determined by adding 20 μl of the extracted coral sample to a 96 well plate in addition to 40 μl of 50 mmol l 1 phosphate buffer ph 7 8 and 25 μl of double distilled water ddh2o after incubating at room temperature for 20 min 30 μl of a 10 mmol l 1 dopamine hydrochloride solution was added as a substrate and the change in absorbance of the reaction was monitored every 5 min for 45 min using a biotek elx808 absorbance microplate reader at 490 nm the change in absorbance for the linear portion of the reaction curve was used to determine po activity control reactions under the same condition but with 70 μl of 50 mmol l 1 phosphate buffer ph 7 8 and no substrate was run in parallel po activity was normalized to total protein concentration in each sample total protein concentration of the extracted coral sample was determined using bradford reagent and measuring absorbance at 595 nm utilizing the same protocol described above 2 3 1 3 maximum growth capacity of polyps κ a a cervicornis branches are cylindrical in shape and relatively uniform in diameter at the base of each individual branch within the same colony furthermore across all branches the polyp corallite the skeletal cup in which each independent polyp sits is highly visible to the unassisted vision taking into consideration these branch features we mapped the number of polyps within a cylinder like branch to a volume of 1 cm3 to accomplish this we first fitted a paraffin ribbon of 1 cm in height around the branch and counted the number of marks left on the ribbon by the corallites in the branches thereafter we measured the diameter of the branch were the ribbon was fitted with a caliper to estimate the volume of the cylinder like branches with a height 1 cm afterward we divided the number of corallite marks the equivalent to the number of polyps counted in 18 genetically distinct branches by the cylinder volume of that branch to estimate the number of polyps per cm3 finally we calculated the maximum capacity of polyps in one cm3 κ a by averaging all the estimated number of polyps within 1 cm3 of tissue 2 3 1 4 birth rate of polyps β a inasmuch as in our model eqs 1 2 the environmental function f 1 d acts as a modifier of β a then is crucial to estimate β a at different depths to estimate β a we tracked the changes in length of 245 a cervicornis colonies located at water depths shallow and deep throughout a year then we determined the number of new polyps occurring within each length increment to estimate the maximum capacity of polyps within 1 cm3 of tissue the growth rate of each colony was estimated by taking high resolution digital images of each colony at monthly intervals for one year besides in the laboratory we used the software program coral point counter excel cpce kohler and gill 2006 to estimate the total length in cm of each fragment the total length was further used to estimate the volumes of each of the colonies at the start v i and at the end v f of the study using the expression for the volume of a cylinder with constant radius r and length height l k 4 v k π r 2 l k k i f the subscript in l k and v k denote the total length and volume of the fragment at the start i initial and at the end of the study f final the radius r was estimated by measuring with a caliper the fragment diameter of the 18 colonies previously used to estimate κ a l i and l f finally we used the volumes of each fragment to compute β a in units of days 1 per fragment using the following equation 5 β a α v f v i 364 where α 1 is a constant in units of cm 3 v i and v f are the estimated volumes vide supra and 364 is the elapsed time in days between the start and end of the study observe that eq 5 is the average growth rate over the time interval 0 364 after estimating β a at different depths shallow and deep we proceeded to test the assumption that indeed β a changes with depth furthermore we also needed to statistically test the claim embodied by f 1 d eq 1a that β a decreases with depth such claim is crux to the idea that sst and sr affect polyp s growth a t test was used to test for equality of mean β a for the two depth groups the normality assumption was verified by conducting a normal quantile plot the equal variance assumption was shown to be false by conducting bartlett s test the t test for equality of means assuming unequal variances yielded a p value 3 145 10 5 statistically showing that β a decreases as depth increases 2 3 1 5 death rate of polyps δ a to estimate death rate of polyps we selected 223 colonies that exhibited negative growth shrinking in at least one month during a one year monitoring period we identified the shrinking month and estimated the amount of life tissue lost by subtracting the estimated length of that colony during the month prior to shrinking to the estimated growth during the month of shrinking then we followed the same protocol used in the birth rate estimation to calculate the number of polyps lost in one cubic centimeter similar to birth rate of polyps we tested the data for equality of means using a wilcoxon test yet in this case analysis yielded no statistical differences p value 0 9535 suggesting that δ a does not changes with depth the estimated value is in table 1 2 3 1 6 parameters of environmental function f 1 d the parameters for the environmental functions are the c 1 and c 2 in eq 1 their values were obtained by fitting f 1 d to birth rates measured at shallow and deep depths the fitting algorithm that we used was the levenberg marquardt as implemented in the matlab computing platform we ran algorithm for a set of 10000 randomly generated uniformly initial guesses the values obtained as solutions of the curve fitting problem are c 1 1 1571 unitless and c 2 0 1532 in units of day 1 we reiterate that strictly speaking ocean depth is another model parameter that acts as a proxy for sr and sst 2 4 initial conditions different initial conditions for the ode system 2 were chosen to conduct different simulations see section 4 the overall rationale was to take initial values from a set of typically observed values for number of polyps fp and m concentrations 3 stability analysis asymptotic the goal in this section is to elucidate the behavior of the model as t i e how the model equations behave in the long run to accomplish this we calculated the nullclines and the equilibria of system 2 and study the lyapunov or asymptotic stability of such equilibria 3 1 equilibrium points let g x t μ be the right hand side rhs of the ode system 2 where μ is a tuple with the 12 model parameters thereby system 2 can be written as x t g x t μ and the equilibrium points are defined as the solutions of g x t μ 0 it is important to mention that the results given below do not assume the exact form of the environmental functions in eq 1 but rather that the functions satisfy the assumptions in section 2 1 moreover for simplicity s sake we omit the arguments of the environmental functions i e f i denotes f i d for i 1 2 3 also in order to simplify the algebra we define 6 p 1 f 1 δ a p 2 f 2 δ f and p 3 f 3 δ m 3 1 1 equilibrium points the equilibria of the ode system 2 are obtained by setting its rhs side to zero i e g x t μ 0 and solving the nonlinear system by considering different cases the expressions for the nullclines the details are on appendix a embodied those cases hence the equilibrium points of eq 2 are 7a x 1 0 0 0 t 7b x 2 κ a f 1 p 1 0 0 t 7c x 3 κ a p 1 δ δ f m δ m f δ f m p 3 δ m f p 2 t 7d x 4 0 0 c t c ℝ c 0 7e x 5 0 b 0 t b ℝ b 0 where 8 δ f 1 δ f m δ m f δ a f κ a δ f m p 3 δ a m κ a δ m f p 2 and the p i i 1 2 3 are defined in eq 6 the origin i e eq 7a is trivially obtained whenever x 1 0 eq 7b is obtained when x 1 0 and x 2 x 3 0 see expression in a 3 the expression in eq 7c is obtained by setting x 1 0 x 2 0 and x 3 0 and substituting expressions in eqs a 2 and a 1 into expression in eq a 3 an equilibrium point is biologically feasible when all of its entries are nonnegative i e whenever it is in the first octant observe that x 1 is biologically feasible x 2 eq 7b is biologically feasible whenever p 1 0 owing to the complexity of the algebraic expression that constitute x 3 eq 7c then the biological feasibility of x 3 must be assessed with caution hence we consider the following cases 1 if p 1 0 p 2 0 and p 3 0 then x 3 is biologically feasible 2 if p 1 0 or p 2 0 or p 3 0 then we have the following subcases a if p 1 0 then δ 0 in order to obtain a positive first component of x 3 which in turns implies p 3 0 and p 2 0 in order to obtain positive second and third components of x 3 but observe that this leads to a contradiction because if p 3 0 and p 2 0 then by definition of δ eq 8 δ 0 b if p 2 0 then p 1δ 1 0 but this leads to a biologically unrealistic solution because the first component in eq 7c must be nonnegative c similarly if p 3 0 then p 1δ 1 0 but this leads to an biologically unrealistic solution because the first component in eq 7c must be nonnegative d all other possible subcases also lead to biological unrealistic solutions thereby components of solution x 3 are nonnegative only if p 1 0 p 2 0 and p 3 0 moreover observe that since the first entry of x 3 and x 4 is zero see eqs 7d 7e we regard them as biologically unrealistic 3 2 local stability analysis here we elucidate the stability of the equilibria computed in section 3 1 to do so we calculate the jacobian matrix of eq 2 and determine whether each of the equilibrium points are hyperbolic 1 1 an equilibrium point is hyperbolic if all the eigenvalues of the jacobian matrix of the rhs of the ode system evaluated at the equilibrium point have nonzero real part this analysis is local because it focus in trajectories solutions of eq 2 that start in a neighborhood of each equilibrium point the jacobian matrix of the rhs of eq 2 is 9 d g x x d g 11 δ a f x 1 δ a m x 1 p 2 x 2 d g 22 δ f m x 2 p 3 x 3 δ m f x 3 d g 33 where 10a d g 11 f 1 1 2 x 1 κ a δ a δ a f x 2 δ a m x 3 10b d g 22 p 2 x 1 δ f m x 3 10c d g 33 p 3 x 1 δ m f x 2 3 2 1 stability of x 1 the origin at x 1 the jacobian matrix becomes upper triangular and its eigenvalues are p 1 and 0 with two zero eigenvalues ergo we conclude that the origin is a nonhyperbolic equilibrium and its stability cannot be assessed with the linearization of eq 2 i e hartmann grobman theorem does not apply meiss 2008 thus we proceed to study its stability by constructing a lyapunov function and applying the lasalle invariance principle lasalle 1960 a similar approach has been used by other investigators to assess the stability of other ecological models hsu 1978 hsu and huang 1995 for completeness sake we explain in appendix d the concept of lyapunov function and lasalle invariance principle now we state that x 1 is an asymptotically stable equilibrium whenever p 1 0 p 2 0 and p 3 0 these conditions on the parameters are the main assumptions of proposition 3 1 vide infra proposition 3 1 stability of x 1 the proof is in appendix b and uses the concept of lyapunov function explained in appendix d and the lasalle invariance principle d 1 3 2 2 stability of x 2 x 2 is given by eq 7b the jacobian matrix evaluated at x 2 is upper triangular and its eigenvalues are p 1 κ a f 1 p 2 p 1 and κ a f 1 p 3 p 1 p i s are defined in eq 6 observe that x 2 is hyperbolic if p 1 0 and p 2 0 and p 3 0 in such case then the stability of x 2 is established as follows 1 if p 1 0 p 2 0 and p 3 0 then x 2 is asymptotically stable an attractor or sink in this case the real part of all eigenvalues is negative 2 if p 1 0 p 2 0 and p 3 0 then x 2 is a repulsor source in this case the real part of all eigenvalues is positive 3 x 2 is a saddle point if it is still hyperbolic but none of the previous conditions hold in the case of x 2 being nonhyperbolic the stability of x 2 must be assessed through the lyapunov function technique used to study the stability of x 1 3 2 3 stability of x 3 x 3 is given in eqs 7c 8 the jacobian matrix evaluated at x 3 is d x g x 3 κ a p 1 δ a where 11 a 1 κ a f 1 δ f m δ m f δ a f δ f m δ m f δ a m δ f m δ m f δ f m p 2 p 3 0 δ f m 2 p 3 δ m f p 2 p 3 δ m f 2 p 2 0 moreover the eigenvalues of d x g x 3 are κ a p 1 δ multiplied by the roots of the characteristic polynomial of a the roots of the characteristic polynomial of a are the solutions of 12 0 p λ det a λ i λ 3 b λ 2 c λ d where b f 1 κ a 1 δ m f δ f m c p 2 p 3 δ mf δ fm δ mf δ fm δ af δ fm δ am δ mf and d p 2 p 3 δ m f 2 δ f m 2 κ a 1 δ also the coefficients of the characteristic polynomial in eq 12 satisfy the following conditions 1 b 0 because all the parameters and the environmental functions are positive 2 the expression p 2 p 3 δ mf δ fm 0 because the δs are always positive and in order for x 3 to be biologically feasible p 2 0 and p 3 0 ergo the sign of c is determined by the expression δ mf δ fm δ af δ fm δ am δ mf 3 d 0 since the δs are positive and in order to have a biologically feasible x 3 then p 2 0 p 3 0 and δ 0 the solutions of eq 12 are given by cardano and tartaglia s formulae if we take b 0 and d 0 the formulae simplify we used mathematica to obtain the simplified expressions to expressions for which are difficult to assess the signs of the real part of such solutions to study the stability of x 3 in appendix c we state a list of remarks from which we infer proposition 3 2 the proof of the proposition is also in appendix c the assumptions on that proposition comprise the stability conditions of x 3 proposition 3 2 stability of x 3 if p 1 0 p 2 0 p 3 0 and none of the solutions eigenvalues of eq 12 is neither zero nor purely imaginary then x 3 is either an unstable equilibrium or a saddle equilibrium point 2 2 a saddle equilibrium occurs whenever all the eigenvalues of d x g x 3 have nonzero real part but they do not have the same sign this means that there are some trajectories that start close to x 3 and stay close to x 3 as t whereas other trajectories start close to x 3 but go farther away from x 3 as t proposition 3 2 can be modified by adding the assumption that inequality c 2 holds true in that case x 3 is a saddle equilibrium point the reason for this is that according to the gershgorin disc theorem quateroni et al 2007 geršgorin 1931 the union of the gershgorin discs eq c 1 contains the eigenvalues of a furthermore inequality c 2 ensures that r 1 and r 2 r 3 are disjoint ergo r 1 must contain a real negative eigenvalue thus by the descartes s rule of signs one of other two remaining eigenvalues must be a negative real number and the other a positive one therefore x 3 is a saddle equilibrium point it is noteworthy that if any of the eigenvalues solutions of eq 12 is zero or have a zero real part then the stability of x 3 cannot be assessed by inspecting the eigenvalues of the jacobian matrix at x 3 but rather by constructing a lyapunov function 3 2 4 stability of x 4 and x 5 x 4 is given by eq 7d the jacobian matrix evaluated at x 4 is a lower triangular matrix with eigenvalues p 1 δ am c δ fm c and 0 where c ℝ because of the 0 eigenvalue we cannot use the linearization of eq 2 to assess the stability of x 4 two modifications to proposition 3 1 yield the stability conditions for x 4 the modifications are that the lyapunov function is redefined as v x 1 2 x x 4 2 2 and that it is also assumed that x 3 0 c 0 where c l 3 and l 3 is the maximum concentration of m in a fixed volume of coral this yields another proposition whose proof is analogous to proposition 3 1 the assumptions of such proposition are indeed the stability conditions x 5 is given by eq 7e and its stability conditions are analogous to those of x 4 table 2 summarizes the stability conditions of the equilibrium points 4 results we numerically solved the model eq 2 using the numerical differentiation formulas ndf as implemented in matlab details about the ndf are in quateroni et al 2007 shampine and reichelt 1997 figs 6 and 8 were done using the mathematica platform the computing resource was a linux workstation with 40 computing cores and 128 gb of memory 4 1 results for different parameters configurations we show simulations that correspond to different parameter configurations that satisfy the various stability conditions for the equilibria that were obtained in section 3 the initial condition in this set of simulations was 0 0897 0 1 0 1 t this was with the normalized model 4 1 1 an asymptotically stable x 1 in proposition 3 1 we stated the conditions for asymptotic stability of x 1 see also table 2 fig 2 shows a simulation in that such stability condition is met in this case we had to set β f 0 9 δ f e d β m 0 9 δ m e d and the value given by f 1 was set to 90 of δ a note in fig 2 that x 1 which can be interpreted as total extinction of the polyp s population is an attractor thus under the mentioned parameter configuration if the ic is close in the 2 norm sense to x 1 then the polyp s population solution of eq 2 evolves towards extinction 4 1 2 an asymptotically stable x 2 in section 3 and table 2 we gave the stability conditions x 2 fig 3 shows a simulation in which such stability condition is satisfied hence we set β f 0 9 δ f e d and β m 0 9 δ m e d the condition p 1 0 is satisfied using the parameters in table 1 fig 3 shows that indeed x 2 eq 7b is an attractor or sink for the parameter configuration given above note that x 2 is not biologically realistic because it is expected that some amount of fp and m is going to be present under all circumstances except after polyp s death 4 1 3 x 3 is a saddle equilibrium in section 3 we concluded that x 3 is either a saddle or an unstable equilibrium whenever the conditions in proposition 3 2 are satisfied fig 4 shows a simulation that satisfies the stability condition in proposition 3 2 3 3 that is p j 0 for j 1 2 3 the eigenvalues of d x g x 3 are 0 0678 0 0232 and 0 0472 for deep and 0 0567 0 0471 0 0235i and 0 0471 0 0235i for shallow the parameter values that we used are in table 1 the figure shows that in this case the trajectory solution of eq 2 with the given ic evolves towards x 3 thus we conclude that x 3 is a saddle equilibrium 4 2 results for different initial conditions we numerically solved the model equation to simulate 2 biologically relevant cases each case corresponds to different initial conditions ics with parameter configuration as in table 1 the cases are case 1 fp concentration is less than m concentration case 2 fp concentration is greater than m concentration 4 2 1 case 1 fp less than m fig 5 show simulations in which the ic satisfied the constraint that the fp concentration is less than or equal to the m concentration each color represents a different simulation i e a solution with a different ic we took 27 linearly spaced points from the set 0 08971 0 8971 0 1 0 5 0 5 1 as ics in fig 5 panels a c and e show simulations for shallow configuration whereas panels b d and f show results for deep configuration observe that in some simulations for both shallow and deep the solution evolves toward the equilibrium x 4 eq 7d but we also noted that other simulations including the case in which the initial concentrations of fp and m are similar dashed lines the ode system evolves toward x 3 eq 7c this confirms numerically that x 3 is a saddle equilibrium it is important to mention that in fig 5e and 5 f although the dashed line seems to reach zero the value that they actually reach is about 0 5667 and 4 4486 respectively it is also noteworthy that the proportion of polyps under both configurations have the same order of magnitude throughout the simulation cf fig 5a and 5 b but in contrast for fp and m fraction the variation swings in fraction values under shallow configuration is smaller than under deep configuration for fp cf fig 5c and 5 d for m cf fig 5e and 5 f fig 6 shows the corresponding phase portraits and basins of attraction 4 4 informally the basing of attraction is the maximal trapping region a trapping region is found numerically by computing the vector field and verifying it point inward on the boundary meiss 2008 fig 6 for shallow and deep show that the basing of attraction is indeed the first octant each black curve corresponds to a solution of the model with ic depicted as a either blue or yellow point blue points represent ic randomly uniformly distributed chosen from the region defined for case 1 whereas yellow points were randomly chosen from a neighborhood of x 3 the black green and red point are x 1 x 2 and x 3 respectively in both phase portraits we observe that some solutions evolve toward x 3 whereas others evolve away from it thus the plots show numerically that x 3 is a saddle equilibrium 4 2 2 case 2 fp greater than m fig 7 show simulations for which the ic satisfied the constraint that the fp concentration is greater or equal than m concentration each color represents a different simulation in this case we took 27 linearly spaced points from the set 0 08971 0 8971 0 5 1 0 1 0 5 as ics in fig 7 panels a c and e show simulations for shallow configuration whereas panels b d and f show results for deep configuration observe that in some simulations for both shallow and deep the solution evolves toward the equilibrium x 5 eq 7e but we also noted that other simulations including those in which the initial concentrations of fp and m are similar dashed lines the ode system evolves toward x 3 eq 7c this confirms numerically that x 3 is a saddle equilibrium it is important to mention that in fig 7c although the dashed line seems to reach zero the value that it actually reaches is about 0 5665 it is also noteworthy that the proportion of polyps under both configurations have the same order of magnitude throughout the simulation cf fig 7a and 7 b but in contrast for fp and m fraction the variation under shallow configuration is smaller than under deep configuration for fp cf fig 7c and 7 d for m cf fig 7e and 7 f fig 8 shows the corresponding phase portraits and basins of attraction the figure shows that the basing of attraction is the first octant analogous to fig 6 each black curve corresponds to a trajectory with ic depicted as a either blue or yellow point blue points represent ic randomly chosen from the region defined for case 2 while yellow points were randomly chosen from a neighborhood of x 3 the black green and red point are x 1 x 2 and x 3 respectively we observe in both phase portraits that some solutions evolve toward x 3 whereas others evolve away from it thus similar to the case fp m the plots show numerically that x 3 is indeed a saddle equilibrium 4 3 local bifurcation analysis we say that our model eq 2 is structurally stable whenever a small change in a model parameter do not cause qualitative changes 5 5 the concept of qualitative change is explained with precision in meiss 2008 wiggins 2000 whenever a change in the model parameters cause the orbits generated by the model to not being equivalent topologically conjugate between themselves we say that a qualitative change in the solutions of the model occurs in the solution of the model i e when the model shows no bifurcations we are focusing in bifurcation of the equilibria found in section 3 1 therefore this analysis is a local bifurcation analysis moreover this analysis pays attention to codimension 6 6 loosely speaking the codimension of a bifurcation is the minimal number of parameters that have to be changed in order to observe the bifurcation 1 bifurcations a detailed discussion about bifurcations is in meiss 2008 wiggins 2000 we did the numerical bifurcation analysis using matcont matcont is a numerical continuation and bifurcation analysis software package implemented in matlab the documentation of such package is found in dhooge et al 2003a b 2004 the work of several investigators dhooge et al 2006 govaerts et al 2005 govaerts 2000 was used as a guide in our analysis which we summarize as procedure in g 1 table 3 summarizes the results of the numerical bifurcation analysis for the equilibria of our model before elucidating the results in table 3 we state the following remarks equilibria x 1 x 4 and x 5 were excluded from the table because their jacobian matrix is singular regardless of the parameter values ergo is impossible to generate a continuation equilibrium curve starting from those equilibria moreover x 4 and x 5 are uninteresting from the biological standpoint the parameters were perturbed in two ways toward values greater and toward values lesser than the value in table 1 viz the forward and backward direction respectively table 3 only includes results that are biologically relevant inside first octant observe in table 3 that under the conditions that x 3 starts as a saddle equilibrium we only found parameter values that make either x 2 or x 3 a neutral saddle these results allow us to conclude that because our model does not exhibit codimension 1 bifurcations ergo it is structurally stable in terms of that type of bifurcation 5 discussion the stability analysis section 3 and the simulations in figs 2 4 showed that under a specific set of conditions for the parameters there are 3 biologically relevant equilibria eqs 7a 7c x 1 polyps cease to exist at a certain point in time and consequently there are no fp and m syntheses x 2 the number of polyps eventually reaches a certain value while fp and m syntheses are reduced to their minimum and x 3 number of polyps as well as fp and m syntheses varied with time until they become nonzero constants with respect of time furthermore we showed that there is another set of conditions that determine the asymptotic stability of the equilibria see section 3 and table 2 it is conspicuous that albeit the model has 12 parameters the core feasibility and stability conditions depend on the 3 parameter combinations p 1 p 2 and p 3 defined in eq 6 and on the normalized depth d moreover the signs of the p i s can be changed by changing d in biological terms p 1 can be interpreted as population growth of polyps as it affects the number of polyps born minus the number of polyps dying meanwhile p 2 and p 3 can be interpreted as a difference of rates the rates at which fp and m are synthesized minus the rates at which these chemical compounds are degraded furthermore in some cases the stability condition of an equilibrium precludes the other two from being biologically feasible for example the stability condition of x 1 moves x 2 and x 3 outside the first octant see table 2 in biological terms once the coral is dying that is x 1 t 0 as t there will be no recovery unless some factor which could be an environmental factor affects the stability condition of x 1 vide infra similarly the stability condition of x 2 makes x 3 biologically unfeasible regarding the stability of x 3 the contrapositive statement of proposition 3 2 says that if x 3 is a sink then at least one of the following statements is true at least one p i 0 for i 1 2 3 or there is a solution of eq 12 that is zero or purely imaginary i e x 3 is nonhyperbolic hence in our model eq 2 if x 3 is an attractor sink then it is either biologically unfeasible or nonhyperbolic being a nonhyperbolic equilibrium point means that in a neighborhood of x 3 our model is not equivalent to its linearization thus the nonlinear part of our model determines whether x 3 is stable figs 3 4 show that at equilibrium the proportion of polyps is greater at shallow depth than at deep depth besides fig 4 show that at equilibrium x 3 the amount of fp and m is greater at greater depth these results are in agreement with our field observations and with the limiting resource theory model assumption 1 that states the less resources the coral allocates into immunity more resources could be allocated into growth figs 5 8 show numerically that x 3 is indeed a saddle equilibrium thus from some starting values ics the system evolves toward x 3 whereas from other ics the system evolves away from x 3 furthermore fig 6 and 8 show numerically that trajectories solutions of the ode system that start in the first octant remain in the first octant another important issue to elucidate is whether given some initial condition changes in the environmental variables sst or sr which are represented in the model by the depth parameter d in the environmental functions make the system evolves toward one equilibrium point versus another note that this issue is in essence how a change in a parameter value affects the stability of equilibria thus is an issue related to bifurcations in our model suppose that our model eq 2 is solved with ic close to some equilibrium point under the corresponding stability conditions for such point now if we change d how the solution trajectory is affected as t to answer that consider the following cases case 1 x 1 stable sink i e eventual collapse of the coral colony suppose that our model is solved with ic close to x 1 and with p i 0 i i e under the conditions that makes x 1 an sink and x 2 a repulsor see section 3 as depth decreases 7 7 as depth increases f 1 d decreases whereas f 2 d and f 3 d increases thus there can be a sign change for p 2 and p 3 but not for p 1 f 1 d increases whereas f 2 d and f 3 d decreases thus there may be a sign change for p 1 negative to positive but not for p 2 and p 3 in that case we obtain p 1 0 p 2 0 and p 3 0 therefore x 2 becomes an attractor see 2 and this implies that the trajectory might evolve depending on the ic from x 1 to x 2 note that under this scenario x 2 flips from source to sink similar to a transcritical bifurcation and x 1 stops being a sink moreover in this case it will not be possible to get p i 0 i thus the conditions for x 3 to be a saddle are not satisfied case 2 x 3 stable sink i e a coral colony with number of polyps and amount of protein that have a nonzero constant value in this case proposition 3 2 and its contrapositive vide supra establish that the nonlinearities of our model make a biologically feasible x 3 to be asymptotically stable we hypothesize that changes in one or more model parameters affect the nonlinear part of the model and that determines stability of x 3 case 3 x 3 a saddle i e some trajectories evolve to x 3 and other away from x 3 as t suppose that our model is solved with ic close to x 3 and that all assumptions of proposition 3 2 are satisfied in particular we focus on the assumption p i 0 i as depth decreases 8 8 as depth increases f 1 d decreases whereas f 2 d and f 3 d increases thus there can be a sign change for p 1 but not for p 2 or p 3 f 1 d increases whereas f 2 d and f 3 d decreases thereby p 1 must remain positive but p 2 or p 3 may become negative in that case x 3 becomes biologically unfeasible but x 2 becomes an attractor if both p 2 and p 3 are negative in any case the nonlinearities of our model must play a role in determining the stability of x 3 case 4 x 2 stable suppose that our model is solved with ic close to x 2 and with p 1 0 p 2 0 and p 3 0 that is under the conditions that makes x 2 an sink as depth decreases f 1 d increases whereas f 2 d and f 3 d decreases hence none of the p i i 1 2 3 can change sign and no change in the stability of x 2 occurs if depth increases the signs of p i could flip if all p i become negative the trajectory may evolve toward x 1 because it would become an attractor but if not all of the p i become negative then the trajectory may evolve toward x 1 or elsewhere the numerical bifurcation analysis in section 4 3 showed that our model is structurally stable it is noteworthy that the reason for not finding a value of depth that produce some change of stability of equilibria is that for the baseline value of the other parameters that comprise p i besides d a solution of p i 0 for d lies outside the interval that we looked into this finding does not preclude the model to exhibit global bifurcations or some codimension 2 or higher codimension bifurcations furthermore we found conditions that ensure that the point x 3 is a saddle equilibrium hence there are going to be some orbits solutions of eq 2 that start close to x 3 and evolve towards it whereas other orbits start close to x 3 evolve away from x 3 the mathematical implications of this might be interesting for instance note that whenever p 1 0 p 2 0 and p 3 0 which is one of the conditions for x 3 to be a saddle makes also x 2 to be a saddle ergo a saddle connection or heteroclinic 9 9 informally an heteroclinic orbit is a trajectory that connects two saddle equilibrium points an homoclinic orbit is a special case where the two equilibria are the same orbit is possible such a scenario would be in agreement with the findings of neutral saddle points for these two equilibria in the local bifurcation analysis see section 4 3 in biological terms a saddle point could reflect a change in an environmental condition such as an increase in sst that makes the growth rate of a colony to decrease to extinction phenomena like the appearance or the disappearance of a saddle connection is associated with global bifurcations although the study of the existence of global bifurcations is beyond the scope of this work if they indeed exist in our model then this could indicate that the system that the model seeks to represent have different configurations and that parameter changes affect the system as a whole i e more than one equilibrium point at once 6 conclusions we constructed a mathematical model that simulate the effects of the environment on a cervicornis the model captures the essence of how environmental variables sst and sr affect the resource allocation between polyp population growth and two of its immune system constituents fp and m as a function of time in that regard the model succeeds as a predictor of the effect of climate change on the coral population yet we understand that the biology behind this model is far more complicated as we are beginning to understand the multiple roles of fp and m in corals thus we could have partially missed the roles of these as immune constituents and their trade off against other life history traits such as growth nonetheless this model could still be useful as a conservation tool as it fairly simulates the coral reality with the available knowledge we can modify the model to capture phenomena associated with abrupt seasonal changes this can be done in at least two ways first to make some of the parameters e g birth rate time dependent this will make the model a nonautonomous ode system thereby making it more difficult to analyze second to change some of the parameters at discrete times seasons this will encapsulate our model which is a continuous time model into a discrete time model acknowledgments we thank mariano marcano loretta roberson and juan luis sanchez we also extend our gratitude to fundación toyota ford motor company foundation of puerto rico the university of puerto rico sea grant college program noaa grant number na14oar4170068 project r 102 1 14 university of puerto rico río piedras campus office of research and graduate studies institutional research fund fipi 20fip2550017 00 and 20fip3490018 00 and programa de iniciativas de investigación pii 2017 appendix a description of nullclines a nullcline defines the set of values that makes the corresponding model variable time independent i e derivative with respect of time is zero let g 2 x μ be the rhs of eq 2b by definition of nullcline the x 2 nullcline is given by the equation g 2 x μ 0 this implies a 1 x 2 p 2 x 1 δ f m x 3 0 x 2 0 or x 3 p 2 δ f m x 1 note that for x 3 to be biologically plausible p 2 0 similarly let g 3 x μ be the rhs of eq 2c and take g 3 x μ 0 thus we obtain a 2 x 3 p 3 x 1 δ m f x 2 0 x 3 0 or x 2 p 3 δ m f x 1 observe that for x 2 to have a biological meaning p 3 0 finally let g 1 x μ be the rhs of eq 2a and take g 1 x μ 0 ergo a 3 f 1 x 1 1 x 1 κ a δ a x 1 δ a f x 2 δ a m x 3 x 1 0 x 1 0 or x 1 κ a f 1 p 1 δ a f x 2 δ a m x 3 likewise for x 1 to be biologically feasible p 1 δ af x 2 δ am x 3 0 therefore eqs a 1 a 3 are the nullclines of the ode system 2 appendix b proof of proposition 3 1 the assumptions of proposition 3 1 are the stability conditions of x 1 next we restate the proposition and give its proof let v x 1 2 x 2 2 p 1 0 p 2 0 and p 3 0 then the equilibrium point x 1 is asymptotically stable proof the goal is to apply lasalle invariance principle d 1 thus we define ω 0 l 1 0 l 2 0 l 3 where l 1 κ a and l 2 l 3 are the maximum concentrations of fp and m that a fixed volume of coral polyps in a given volume can produce note that ω is forward invariant for the following reasons first any trajectory solution of eq 2 that starts in ω will not escape the first octant because of the zero nullclines eqs a 1 a 3 second neither the number of polyps nor the protein concentrations is unbounded the number of polyps cannot increase beyond the carrying capacity and the proteins concentrations must be bounded because the polyps synthesize proteins up to a finite positive concentration note also that ω is a closed and bounded subset of ℝ 3 thus it is compact hasser and sullivan 1991 next we show that v is a lyapunov function d observe that v x 1 2 x 2 2 1 2 k 1 3 x k 2 0 x ℝ 3 and v x 1 0 we proceed to establish the nonincreasing property of v along the trajectories given by eq 2 let g x μ be the rhs of eq 2 we assume x ω and obtain the following b 1 d d t v x v x x v x g x μ x 1 2 p 1 f 1 x 1 κ a δ a f x 2 δ a m x 3 x 2 2 p 2 x 1 δ f m x 3 x 3 2 p 3 x 1 δ m f x 2 b 1 d d t v x v x x v x g x μ x 1 2 p 1 f 1 x 1 κ a δ a f x 2 δ a m x 3 x 2 2 p 2 x 1 δ f m x 3 x 3 2 p 3 x 1 δ m f x 2 observe that because p 1 0 p 2 0 p 3 0 and x ω then d d t v x 0 ergo v is a lyapunov function in ω we emphasize that to apply lasalle s principle we only need the nonincreasing property of v to hold true appendix c proof of proposition 3 2 the following remarks lead to proposition 3 2 the proof of the proposition is also shown in this section 1 because the degree of the polynomial in eq 12 is 3 the equation has either 3 real solutions or 1 real solution and 2 complex solutions a complex conjugate pair 2 by descartes s rule of signs see appendix e regardless of the value taken by c we conclude the following a eq 12 has a maximum and exactly 1 positive real root b eq 12 has a maximum of 2 negative real roots furthermore the equation could have 0 or 2 negative real solutions note that the rule of signs leads to the conclusion that if all the solutions of eq 12 are nonzero real numbers then 2 of them must be negative and 1 positive on the other hand if only one solution is real the other are a complex conjugate pair then it must be positive 3 by gerschgorin disc theorem quateroni et al 2007 geršgorin 1931 the eigenvalues of matrix a recall that d x g x 3 κ a p 1 δ a and that κ a p 1 δ 0 are contained within the discs c 1a r 1 z ℂ z f 1 κ a 1 δ mf δ fm r 1 where r 1 δ fm δ mf δ af δ am c 1b r 2 z ℂ z r 2 where r 2 δ fm p 3 p 2 δ fm c 1c r 3 z ℂ z r 3 where r 3 δ mf p 2 p 3 δ mf observe that r 1 s center is at some point in the negative part of the real axis whereas r 2 and r 3 are concentric and their center is the origin inasmuch as we seek a stability condition for x 3 we want to impose a condition on the parameters that yield eigenvalues with a negative real part to achieve that we start by seeking that r 1 is contained in the negative part of the complex plane and disjoint from r 2 r 3 such condition is c 2 f 1 κ a 1 δ m f δ f m r 1 max r 2 r 3 this guarantees that the eigenvalue in r 1 which is one of the solutions of eq 12 is a negative real number moreover since matrix a is irreducible 10 10 a matrix is irreducible if its associated directed graph is strongly connected then the eigenvalue in r 1 is not in its boundary from the previous list of remarks we infer following proposition proposition 3 2 the assumptions on that proposition comprise the stability conditions of x 3 if p 1 0 p 2 0 p 3 0 and none of the solutions eigenvalues of eq 12 is neither zero nor purely imaginary then x 3 is either an unstable equilibrium or a saddle equilibrium point 11 11 a saddle equilibrium occurs whenever all the eigenvalues of d x g x 3 have nonzero real part but they do not have the same sign this means that there are some trajectories that start close to x 3 and stay close to x 3 as t whereas other trajectories start close to x 3 but go farther away from x 3 as t proof if p 1 0 p 2 0 p 3 0 then all the components of x 3 are positive and the characteristic polynomial of the matrix δ κ a p 1 d x g x 3 a is given by eq 12 whose solutions are given by the cardano and tartaglia s formulae since we assumed that none of the expressions in cardano and tartaglia s formulae is purely imaginary or zero then x 3 is an hyperbolic equilibrium and by hartman grobmann theorem meiss 2008 the linearization of eq 2 is sufficient to describe such equation in a neighborhood of x 3 owing to the descartes s rule of signs eq 12 has exactly 1 positive real root thereby just one of the following two cases holds case 1 the discriminant 12 12 the discriminant of the cubic eq 12 is bc 2 4db 3 27d 2 4c 3 18bcd of eq 12 is nonnegative hence all the roots are real inasmuch as we assumed that they are nonzero by descartes s rule of signs then 1 of them is positive and the other 2 must be negative ergo x 3 must be a saddle equilibrium case 2 the discriminant of eq 12 is negative thus one of the roots is real and the other are a complex conjugate pair owing to the descartes s rule of signs and because we assumed nonzero roots the real root must be positive additionally we supposed that the real parts of the complex conjugate pair are nonzero thus if the real parts of the complex conjugate pair are positive then x 3 is an unstable equilibrium whereas if the real parts of the complex conjugate pair are negative then x 3 is a saddle equilibrium appendix d lyapunov function and lasalle invariance principle a lyapunov function is a generalization of the concept of total energy of a physical system the textbook definition see meiss 2008 vidyasagar 2002 wiggins 2000 of lyapunov function is that v ℝ n ℝ is a lyapunov function for equilibrium x if it is a c 1 function with the following properties v x 0 v is positive semidefinite i e v x 0 for all x in a neighborhood of x v is nonincreasing along the trajectories of the ode system that start in a neighborhood of x that is let g x be the rhs of the ode system and d dt v x v x x v x g x 0 x in a neighborhood of x if one can construct a lyapunov function for a given equilibrium then the equilibrium is lyapunov stable if v is decreasing i e dv dt 0 then the equilibrium is asymptotically stable meiss 2008 the lasalle invariance principle generalizes even more the concept of lyapunov function in that only the decreasing property is needed for completeness sake we state the lasalle invariance principle theorem d 1 lasalle 1 let ω be a bounded closed compact set with the property that every solution of a system of ordinary differential equations x g x which begins in ω remains for all future time in ω suppose there is a scalar function v x which has continuous first partials in ω and is such that v x 0 in ω let e be the set of all points in ω where v x 0 let m be the largest invariant set in e a set is an invariant if solutions of the ode system that start in the set remain in the set for all t then every solution starting in ω approaches m as t theorem d 2 lasalle 2 let ω denote the closed region defined by v x l and suppose that v x has continuous first partials in ω if in addition ω is bounded and v x 0 in ω then every solution starting in ω approaches m as t where m is defined as in theorem d 1 the proofs of theorems d 1 and d 2 can be found in lasalle 1960 1968 appendix e descartes s rule of signs we take the following statement of descartes s rule of signs from quateroni et al 2007 theorem e 3 descartes s rule of signs let p n be a polynomial of degree n and n 0 denote by ν the number of sign changes in the set of coefficients a j and by k the number of positive real roots of p n each counted with its multiplicity then k ν and ν k is an even number the rule can be applied to bound the number of negative real roots by applying the rule to the polynomial p n x appendix f normalized model here we normalize model quations 2 let y 1 t x 1 t κ a y 2 t x 2 t x 2 max and y 3 t x 3 t x 3 max where x 2 max and x 3 max are the maximum saturation concentration of fluorescent protein and melanin respectively thereby eq 2 becomes κ a y 1 t f 1 d κ a y 1 1 y 1 δ a κ a y 1 δ a f x 2 max y 2 δ a m x 3 max y 3 κ a y 1 x 2 max y 2 t f 2 d x 2 max κ a y 2 y 1 δ f x 2 max κ a y 2 y 1 δ f m x 2 max x 3 max y 3 y 2 x 3 max y 3 t f 3 d x 3 max κ a y 3 y 1 δ m x 3 max κ a y 3 y 1 δ m f x 2 max x 3 max y 2 y 3 which can be written as y 1 t f 1 d y 1 1 y 1 δ a y 1 δ a f x 2 max y 2 δ a m x 3 max y 3 y 1 y 2 t f 2 d κ a y 2 y 1 δ f κ a y 2 y 1 δ f m x 3 max y 3 y 2 y 3 t f 3 d κ a y 3 y 1 δ m κ a y 3 y 1 δ m f x 2 max y 2 y 3 and further simplified to y 1 t f 1 d y 1 1 y 1 δ a y 1 δ a f y 2 δ a m y 3 y 1 y 2 t f 2 d y 2 y 1 δ f y 2 y 1 δ f m y 3 y 2 y 3 t f 3 d y 3 y 1 δ m y 3 y 1 δ m f y 2 y 3 where δ a f δ a f x 2 max δ a m δ a m x 3 m ax f 2 d κ a f 2 d δ f δ f κ a δ f m δ f m x 3 max f 3 d κ a f 3 d δ m δ m κ a and δ m f δ m f x 2 max note that in system 3 all variables are dimensionless and the parameters are in units of day 1 appendix g remarks on local bifurcation analysis we did a numerical bifurcation analysis using matcont the analysis involves the construction of an equilibrium curve and the classification of the points that comprise it the equilibrium curve is a continuation curve it is constructed starting from an equilibrium point and changing a model parameter the classification of points in the equilibrium curve involves two things the computation of the eigenvalues of the jacobian matrix evaluated at the corresponding point in the equilibrium curve and the evaluation of different test functions a detailed explanation on how the points are classified and about the meaning of the categories can be found in dhooge et al 2006 meiss 2008 the points are classified according to the following categories a fold point also known as limit point is an equilibrium point for which the jacobian matrix evaluated at the equilibrium has an eigenvalue that becomes zero as a parameter crosses certain value bifurcation value a limit point indicates that a saddle node bifurcation might occur a hopf point is an equilibrium point for which the jacobian matrix evaluated at the equilibrium has a pair of complex conjugate eigenvalues that cross the imaginary axis as a parameter crosses certain value a hopf point indicates either that a hopf bifurcation birth of limit cycle or that a more complex codimension 2 bifurcation might be occurring that depends on the sign of the first lyapunov coefficient as well as other factors a neutral saddle point is a point with two real eigenvalues that sum zero a neutral saddle indicates that a codimension 2 bifurcation or a more complex bifurcation related to an homoclinic 13 13 loosely speaking an homoclinic orbit is a trajectory that connects a saddle point to itself or heteroclinic 14 14 informally an heteroclinic orbit is a trajectory that connects two saddle equilibrium points an homoclinic orbit is a special case where the two equilibria are the same orbit might exist it is noteworthy that both neutral saddle and hopf point are zeros of one of the test functions that matcont uses to detect them based on the work of dhooge et al 2006 govaerts et al 2005 govaerts 2000 dhooge et al 2006 govaerts et al 2005 govaerts 2000 we did bifurcation analysis using the following procedure procedure g 1 procedure for local bifurcation analysis input the equilibrium points in section 3 1 we obtained their exact expression in terms of the model parameters output bifurcation points in phase parameter space if there are any and type of bifurcation 
25026,agent individual based models a ibm help to explain in a mechanistic way how spatial plant patterns evolve through time in the past seemingly different and independent types of a ibms were developed for modelling the dynamics of tree populations e g growth interaction gi and shot noise sn models in this paper we present a new advanced methodology of pattern oriented modelling pom for the comparative synoptic analysis of the behaviour of different types of a ibms by using recombinations of model components validation and sensitivity analysis we analysed model behaviour for spatio temporal data from natural forests of interior douglas fir pseudotsuga menziesii var glauca mirb franco and scots pine pinus sylvestris l populations from canada and the uk respectively our detailed analysis clarified that both models gi and sn along with their recombinations performed similarly and belong to the same group of a ibms from the application of our new methodology we learnt that sn models were able to describe interactions more accurately than gi models and additionally produce interaction fields that can be used for other modelling purposes on the other hand the gi model was more robust when using observed data that did not include sufficient information on tree interactions maximum likelihood estimations were more reliable in spatial regression analysis than least squares methods and should be preferred in spatial a ibm parametrisation keywords natural forest dynamics agent individual based models spatial tree interactions growth interaction model shot noise model recombination of model components absolute and relative growth rates point process statistics 1 introduction a common challenge in spatial forest ecology stems from the fact that most data available for spatial analysis are so called snapshot data i e mapped data representing a single instance in time during the past 10 20 years point process statistics has contributed much to uncover intriguing processes behind spatial plant patterns illian et al 2008 wiegand and moloney 2014 dale and fortin 2014 however any conclusions drawn from these inferences are associated with a degree of conjecture and uncertainty since previous instances of the ecological data under consideration are unknown o sullivan and perry 2013 to gain more certainty many spatial point process models have been developed to describe observed patterns and to synthesise them until recently these models were only able to handle either instances in space or time but not both simultaneously so that most spatial point process models are only suitable for snapshot data whilst developing new approaches for analysing and modelling spatio temporal ecological data cressie and wikle 2011 agent individual based models a ibms have gained the attention of both ecologists and statisticians grimm and railsback 2005 illian et al 2008 and inspired much interdisciplinary work this is related to the fact that these models particularly focus on a mechanistic understanding of the interactions between individuals individual based models is the term commonly used in ecology while agent based model is preferred in other fields of science both terms are treated as synonyms grimm and railsback 2005 the results of the spatio temporal evolution of a point pattern of plant locations is primarily the consequence of multiple complex interactions among individual plants and between individual plants and the environment as such ib modelling shares some similarities with game theory falster and westoby 2003 mcnickle and dybzinski 2013 many approaches to ib modelling have in fact their origin outside ecology e g in physics and spatial statistics different names have been given to this type of models e g ecological field theory wu et al 1985 miina and pukkala 2002 competition kernel models schneider et al 2006 adams et al 2011 vogt et al 2010 and ibms grimm 1999 berger et al 2002 fibich and lepš 2011 renshaw and särkkä 2001 and särkkä and renshaw 2006 suggested an intriguing general growth interaction model gi model for spatio temporal marked point processes where marks can for example be arbitrary size variables of plants also here the gi model is not restricted to applications from plant ecology and describes interaction structures in a similar way as gibbs point process models a particular characteristic of the gi model is its linear additive growth model in conjunction with zone of influence zoi based interaction in our interdisciplinary work we studied whether the growth interaction model is a member of the a ibm family of models although originating in point process statistics and if so how it fits in with other models of this type to the best of our knowledge the gi model has so far only been applied to data from even aged plantation forests from sweden and we demonstrated how the model can be generalised to accommodate any forest situation including natural forest development for a better characterisation of the distinctive features of the gi model we introduced the model synoptically by comparing it with the shot noise ibm model sn model pommerening et al 2011 which is an established ibm and appeared to share similarities with the gi model for the ease of comparison this partly involved a re arrangement of otherwise published model terms and sub models through a pattern oriented modelling pom inspired validation based on global sensitivity analysis we studied the behaviour of both models and advanced this methodology by using recombinations of sub models 2 methods in point process statistics points describe the locations of objects of interest e g plants and marks provide additional information thus characterising objects in terms of type size or shape patterns including points and marks are referred to as marked point patterns the objects described by the points and marks usually interact with each other in a complex way these interactions much depend on the nature of the objects e g what species of plants they are and on their biology and ecology illian et al 2008 2 1 model synopsis to facilitate comparison in both the gi and sn models potential mark growth in terms of absolute growth rates agr was modelled in the same way using a growth function described by hugershoff 1936 and zeide 1993 eq 7 see table 1 sub model 1 in contrast to most other growth functions the hugershoff function does not rely on time but on mark e g plant size for generalisation we used the point process term mark in this paper to emphasise that the modelling focus can be on any plant size characteristic or on combinations of plant characteristics e g squared tree stem diameters multiplied by total tree height as an approximation of biomass making growth functions dependent on size is generally helpful for handling data from natural and uneven aged forests where trees are typically of different age and age information is not recorded also the mortality model table 1 sub model 5 was largely the same for both individual based models ibm and it was based on the approach described in pommerening and särkkä 2013 mortality here depends on a 5 year growth performance that in turn is determined by a combination of potential mark growth and interaction the growth performance is derived from the ratio of current and previous mark the so called growth multiplier m i t in table 1 see also eqs 16 and 17 in pommerening and muszta 2016 which is a function of relative growth rate rgr relative growth rates have proved to be good indicators of imminent death bigler and bugmann 2003 gillner et al 2013 for a given tree i a memory function aggregates the growth multipliers m i t of the last five years from which the corresponding rgr p i t 5 is calculated if the simulated five years rgr falls short of a critical value the tree dies after a detailed analysis of the data of dying trees we decided to modify the approach published in pommerening and särkkä 2013 by replacing the critical value p i t 5 crit by the power function p i t 5 crit m i t a m i t b where a and b are model parameters and m i t is the mark of tree i at time t the power function takes the dynamics of relative growth rates better into account specifically the size influence leading to a trend where smaller plants tend to have large and larger plants tend to have small rgrs pommerening and muszta 2016 we therefore made the critical value p i t 5 crit dependent on the size of the tree in question however in the gi model trees with m i t 0 die and those with m i t m limit are exempted from the common mortality rule sub model 5 in table 1 that applies to both models the size limit m limit is applied because we noticed that only trees with small marks tend to develop p i t 5 0 thus trees with p i t 5 0 in the gi model are allowed to shrink to death which eventually occurs when m i t 0 applied to plant and particularly to forest ecology this model feature may seem odd on first sight on second thought the shrinking process is intriguing because it mimics failing tree health and consequently performance due to diseases that may be facilitated by tree interaction sapwood area in trees can vary in extent over time mäkelä and valentine 2006 valentine and mäkelä 2012 and the shrinking of marks can be interpreted as a metaphor of this process the ability of marks to shrink is a unique characteristic of the gi model the main difference between gi and sn model is in the way how 1 interaction and 2 mark growth are quantified when applied to tree patterns särkkä and renshaw 2006 and cronie et al 2013 have favoured an interaction function quantifying the overlap area of the zois of trees in relation to the area of the zoi of the tree under study this function is based on well known principles of quantifying competition suggested by gerrard 1969 and bella 1971 i e two trees interact only if their zois overlap zois can for example be interpreted as areas of crown or root expansion of a tree in comparison with the sn model zois can also be interpreted as uniform kernel density functions in the gi model the interaction function has two model parameters c and r determining the mode of interaction competition or facilitation for the population e g a forest stand as a whole and the radius of the circular zoi respectively table 1 sub models 2 4 cronie et al 2013 have referred to c as force and r as scale of interaction the zoi radius r i t simply is the product of model parameter r and tree mark m i t m i t 2 in our case särkkä and renshaw 2006 as a result r i t linearly increases with increasing tree size thus the range of these uniform kernel density functions simply depends on the mark of tree j emitting the interaction signal whilst the strength of the signal depends on the area of the intersection of the zoi of tree j and its neighbouring tree i and also on the mark of tree i see table 1 sub model 2 and fig 1 in the sn model the interaction function aggregates interaction signals emitted by each tree at the location of the subject tree pommerening et al 2011 the gaussian kernel density function used to model the interaction signals stems from a suggestion made by adler 1996 in contrast to our previous publications pommerening et al 2011 pommerening and särkkä 2013 we replaced the exponential kernel by a gaussian kernel because this helped to stabilise parameter estimations and appeared more realistic to us since the interaction signal does not decrease so rapidly near the signal emitting tree our kernel function differs from most other kernel functions see schneider et al 2006 berger and hildenbrandt 2000 in that the function not only depends on the distance from the subject tree but also on its mark the interaction signal of a tree in the sn model has three model parameters α β and δ table 1 sub model 2 a large value of α increases the strength of the interaction signal whilst β and δ on the contrary affect the range of the interaction signal pommerening et al 2011 fig 1 the term m j t α gives the value of the interaction signal at the location of ξ j of tree j here d i s t j 2 ξ j 0 whilst exp δ d i s t j 2 ξ m j t β describes the decay of the interaction effect with distance since the sn model does not use zois the size of a tree s zoi can be considered infinite in this model as a consequence of this definition of interaction signals a random field is constructed that describes an interaction structure resulting from additively superimposing interaction signals of single trees in a forest which is a key feature of the shot noise model the sum of these interaction signals is then divided by the interaction signal value of the subject tree at its own location a method similar to that in the gi model thus the strength of interaction is affected by neighbouring tree i see table 1 sub model 2 and the interaction functions of both gi and sn models produce asymmetric interaction the standardisation of the interaction term table 1 sub model 3 is particularly important for the multiplicative mark growth model table 1 sub model 4 where there is a requirement to have h i t trans distributed between 0 and 1 and large interaction values need to be converted to small multipliers in sub model 4 in the gi model potential mark growth and interaction are aggregated additively in contrast to the sn model where these two terms are aggregated multiplicatively this implies that marks in the gi model can shrink in contrast to the sn model where this is not possible as a consequence death by interaction särkkä and renshaw 2006 can occur when trees eventually have a mark smaller than or equal to zero mark shrinking is not possible in the sn model due to the multiplicative approach the multiplicative approach implies that potential mark growth as calculated in sub model 1 table 1 is reduced by a multiplier wrapping the interaction load this multiplier is given by h i t trans the terms calculating growth rates in sub model 4 table 1 are set in square brackets for the ease of identification 2 2 parameter estimation we defined stem diameter at breast height 1 3 m above ground level dbh as the mark of our study and proceeded with the parameter estimation in three steps firstly we estimated the parameters of potential mark growth k p and q for both models from the observed data separately from the remainder of the two models in contrast to previous publications of the gi model e g cronie et al 2013 where additional data were used potential mark growth was directly estimated from the data as an upper quantile of the observed mark growth rates applying quantile regression koenker and park 1994 cade and noon 2003 where the quantile selected was set to τ 0 975 for interior douglas fir and to τ 0 900 for scots pine this method ensures that potential growth is estimated adequately even if some trees have not realised their full growth potential as part of the quantile regression the state space approach involved an annual updating of the mark the updates were produced by the growth function and as a result the growth rates correctly followed a nonlinear growth curve rather than a linear one as is often assumed when working with mean annual growth rates from periodic re measurements nord larson 2006 as the observed growth rates used in the quantile regression stem from repeated measurements in the same observational plots we accounted for possible within tree correlations using the first order autoregressive method in addition to the state space approach described in nord larson 2006 secondly the interaction and mark growth parameters were estimated through nonlinear spatial regression we estimated the parameters of model components 2 3 in table 1 simultaneously using annual stem diameter growth rates as dependent variables since such complex spatial regressions are novel we applied both a nonlinear least squares and a maximum likelihood approach for estimating the parameters of model components 2 4 by initially using the same starting values then we evaluated least squares loss at the maximum likelihood location ignoring variance finally we fitted the maximum likelihood model using the least squares parameter estimates as starting points for each regression result we also checked quantile quantile plots homoscedasticity of residuals and the shape size of the interaction kernels zois the parameter estimates of both methods usually were quite similar for interior douglas fir but a comparison of the least squares loss function at the parameter set of both methods commonly let to slightly better results achieved by the maximum likelihood method the scots pine data were somewhat more heterogeneous and here the least squares method even proved unreliable in this estimation process we applied periodic boundary conditions illian et al 2008 for spatial edge correction in a third step we estimated parameters a and b of the critical cumulative 5 years rgr function p i t 5 crit m i t from simulations involving the two models separately conditional on all other parameters more precisely we optimised the difference between the model output and the observed data where the number of trees per hectare and basal area per hectare over the survey years and plots were used as dependent variables in the loss function because of the special nature of the gi model with small marks that can shrink in size we introduced the additional auxiliary parameter m limit which we set to 0 for the sn and to 20 for the gi model so that small trees were allowed to shrink to death according to the original gi model philosophy särkkä and renshaw 2006 for marks m i t m limit we set b 0 in the gi model so that p i t 5 crit was in fact constant in this model in the estimation of the mortality parameters as well as in other model simulations we applied a special type of temporal edge correction to the memory function this correction is necessary at the start of each model simulation because the relative growth rates of the trees prior to the first survey year which also marks the start of the simulation are unknown and yet these are essential to determine the mortality of the first five years of the simulation we solved this problem by estimating growth rates using sub models 1 4 from table 1 for all trees present at the start however based on estimated growth rates we grew the trees back by five years in annual steps from the starting year thus reduced tree sizes were applied to the growth function and in the interaction model during this process we assumed that the point pattern remained unchanged with the exception that tree marks may be reduced to values of less than zero and then disappear and consequently all interactions were largely based on the point pattern of the starting year as a summary of parameter estimation and to provide additional details for the ease of reproducing our research a pseudo code is documented in appendix a as a summary of parameter estimation and to provide additional details for the ease of reproducing our research a pseudo code is documented in appendix b 2 3 model scheduling both models operate in discrete annual time steps and at the beginning of each time step first the mortality rule is applied followed by a removal of all dead trees fig 2 afterwards the interaction term is calculated which contributes to the annual growth rates in the same way as in the parameter estimation the interaction term is calculated using periodic boundary conditions illian et al 2008 after calculating potential interaction and mark growth it is possible to determine growth rates using growth rates the tree stem diameters are now updated synchronously the visualised samples of the observed data and from simulations of the canadian douglas fir forest see section 2 7 using the gi and the sn models table 1 show that the differences in forest structure between the two models and each model and the observed data are not great after 16 years of simulation fig 3 2 4 recombination of model components while preparing the experimental design of this study we understood that we could learn much about model behaviour by recombining the model components that differ in our case this option related to model components 2 4 in table 1 i e we exchanged the interaction and mark growth components as a consequence we were able to simulate and analyse the two models as detailed in table 1 and in addition gi interaction with multiplicative mark growth from the sn model and sn interaction with additive mark growth from the gi model for convenience we abbreviated multiplicative and additive mark growth with the operator symbols and respectively accordingly the base models as described in table 1 were labelled gi and sn in addition we used the recombination gi which includes sub models 2 gi 3 sn and 4 sn and parameters r and ν sn which includes sub models 2 sn 3 gi and 4 gi with parameters α β δ and c the mortality model was the same for the additive gi and sn and multiplicative gi and sn models respectively 2 5 model validation we used pattern oriented modelling in our analysis and validation by considering growth rates mark distributions and spatial characteristics grimm et al 2005 to this end we compared the data and the model outputs of the last survey year by means of the mark weighted version of ripley s k r function namely k γ r i e the cumulative version of the mark variogram γ m r and the mark dbh distribution the functions k γ r and γm r are based on the mark test function m 1 m 2 2 2 exploring the pairwise differences of marks of points up to distance r and at distance r respectively see e g illian et al 2008 section 5 3 3 pommerening and särkkä 2013 the mark weighted k γ r was square root transformed and centred by l γ r l r where l γ r k γ r π and l r k r π and l r represents the behaviour of l γ r under the so called random labelling hypothesis i e the case of no correlations in marks see e g illian et al 2008 section 4 3 1 bias and rmse of the mark growth rates were calculated as 1 n i 1 n d m i d m i ˆ and var d m ˆ bias d m ˆ 2 i 1 n d m i d m i ˆ 2 n 1 1 n i 1 n d m i d m i ˆ 2 respectively where dm i is the observed mark growth rate of tree i and d m i ˆ is the corresponding estimated mark growth rate n is the total number of growth rates across the survey years we used the r package spatstat baddeley et al 2016 for the estimation of k r k γ r and γ m r with translational edge correction the mark distribution corresponded to the empirical cumulative distribution function 2 6 sensitivity analysis for studying model behaviour we applied the extended fourier amplitude sensitivity test a variance based global sensitivity method saltelli et al 2000 pianosi et al 2016 the fourier amplitude sensitivity test fast was first devised in the 1970s by cukier and others see cukier et al 1978 and further developed by saltelli et al 1999 to become the extended fast method efast efast is model independent and is applicable irrespective of the degree of linearity or additivity of the model the method is based on a variance decomposition of a model output variable y i e v a r y d j 1 z d j 1 i j z d i j d 1 2 z for the decomposition z 1 individual input parameters are mathematically interpreted as random variables x x 1 x z the first order contributions of the j 1 z input parameters correspond to the variances of the expected value of y given x j i e d j v a r x j e y x j x j the contributions from higher order interactions between the variables d are defined accordingly the efast method approximates main effects s j d j d which are also known as sobol first order indices and so called sobol total order indices collecting the main effects and all interactions including j from these approximations higher order interaction terms can be obtained by subtracting the main effects from the corresponding total order indices in this way the efast results highlight which input parameters have a significant influence on the simulation with respect to the output variable and give a measure for sensitivity or uncertainty saltelli et al 2000 saloranta and andersen 2007 pommerening et al 2011 in our context the model parameters constitute the input the sensitivity analysis helps to identify those parameters that have the largest influence on the outcome variable hence if a researcher selects the model with the highest sensitivity to the interaction parameters for example the chance of describing the interaction process well is high the variability of the input parameters should be representative of the observational error here a variation of 10 around the standard parameter values was considered including 500 samples we also tested variation percentages larger than 10 but this did not lead to different results due to the considerable computational effort the number of samples was chosen to be as low as possible whilst still giving stable results we analysed the model output using the r package sensitivity as output variables the integrated difference between observed and simulated 1 mark variogram γ m r see e g illian et al 2008 section 5 3 3 pommerening and särkkä 2013 and 2 empirical cumulative mark distribution function were considered since each tree population included several point patterns we used a weighted sum of each of the aforementioned integrated measures 1 and 2 where the weighting was based on the number of trees observed in the patterns in the last survey year per tree population l γ r was not used as it was associated with a multimodal distribution and variance based sensitivity analysis methods should include output variables with unimodal distributions 2 7 sample tree populations firstly we fitted the models to interior douglas fir pseudotsuga menziesii var glauca mirb franco spatio temporal data from an uneven aged stand in the alex fraser research forest in british columbia canada longitude 52 3 latitude 121 52 at approximately 1000 m a s l the mean annual temperature is 4 2 c and the mean annual precipitation is 450 mm the data were collected in six plots starting in 1988 with re measurements in 1992 1997 and 2004 four plots had a size of 0 10 ha 2 plots with higher tree densities comprised 0 05 ha the forest site had not been cut for at least 20 years and was under protection from large scale fires lemay et al 2009 we also received permission to use interesting scots pine pinus sylvestris l data from two monitoring plots in the remnants of the caledonian pinewoods namely abernethy and young glenmore queens 26 plot 5 uk longitude 57 30 latitude 4 15 vast areas of northern scotland were once covered by the caledonian pinewoods for several millennia the forest sites are situated at approximately 330 m a s l mean annual rainfall is 900 mm and mean annual temperature about 6 0 c abernethy represents a well structured old growth natural forest it was first measured in 2002 and then re measured in 2008 on a 0 8 ha plot young glenmore was planted in 1926 to replace an old stand felled during world war i the forest was first measured in 2003 and subsequently re measured in 2008 2013 and 2018 on a 1 ha plot mason et al 2007 no birth processes occurred on any of these sites that is why the ibms do not include them instead the pattern of the first survey in each plot was used as initial pattern and the simulation extended until the last survey year in our experience at least two re measurements i e three spatial tree measurements in time are necessary to estimate reliable model parameters this condition was satisfied for the two sample populations 3 results 3 1 model validation bias and rmse of mark growth rates for the gi gi sn and sn models were of similar magnitude tables 2 and 3 for interior douglas fir the sn model had the lowest rmse and second lowest bias whereas for scots pine in fact sn led to the lowest bias and gi had the lowest rmse we experienced some problems with sn i e the parameter optimisation was sensitive to the starting values restricting the parameters to be positive helped but resulted in α 0 for both tree populations this implies that the outcome led to a simplified kernel where the size of the tree had no effect on the strength of the kernel but only on its range the l γ r functions and mark distributions fig 4 for interior douglas fir and fig 5 for scots pine of the simulations of the fitted models were all rather similar to one another in all plots the centred l γ r functions showed negative values indicating that the marks of nearby trees tended to be similar while the degree of similarity varied from plot to plot all the models appeared flexible enough to produce patterns similar to those of the observed data the most similar l γ r functions across different models occurred in plots 4 and 6 interior douglas fir and in both scots pine plots because in these plots hardly any mortality occurred both in the original data and in the models as more detailed investigations not reported here revealed thus given the fixed starting patterns for all model simulations almost only growth and interaction of trees affected the final patterns for the other interior douglas fir plots there was larger variation in terms of which tree individuals died and thus between the model outputs as expected the mark distributions varied from plot to plot e g plots 5 and 6 interior douglas fir had more small trees than the other plots while plot 4 had less as all models were able to capture the mark distributions well we concluded that the small differences in mark variograms were mainly due to at which locations trees died in different model simulations 3 2 sensitivity analysis the sensitivity analysis was carried out with respect to the spatial patterns of marks as measured by the mark variogram γ m r and the non spatial mark distribution separately for the interior douglas fir and scots pine data inter tree distances up to eight metres were considered for both tree populations as the majority of interactions in temperate forests are observed within this distance pommerening and sánchez meador 2018 parameters of value zero b for gi and sn and α for sn were excluded from the analysis the main effects obtained by the efast method and interaction terms for each of the four considered models gi gi sn and sn were compared for each output variable and tree population fig 6 considering the mark variogram the potential mark growth parameter p was the most important parameter across all models in nearly all four sn models two per species the interaction parameter β was the most influential or at least a very influential parameter mortality parameter b turned out to be crucial for gi and sn the models fitted to the interior douglas fir data fig 6a were more sensitive to growth parameter q than the scots pine models fig 6b in all gi models interaction parameter r tended to be more important than c or ν in all studied cases mortality parameter a turned out to be almost of no influence on the model outcome the high sensitivity to mortality parameter b in gi for interior douglas fir related to the fact that a small change in b could lead to a high reduction of trees in the final pattern when applying efast to the mark distribution parameters p r and β had the greatest impact on the mark distribution again β was the most influential parameter for all sn models interestingly all parameters showed markedly larger interaction terms than in case of the mark variogram as interaction and mortality parameters highly depend on growth parameters and vice versa we re ran the sensitivity analysis keeping k p and q fixed but found no pronounced differences in the efast results for the other parameters thus we concluded that the large interaction terms were not just a result of the stepwise parameter estimation procedure in contrast to the mark variogram based outcome variable the mark distribution based outcome variable showed highly skewed distributions especially for sn for scots pine only and sn for both tree populations where several parameter combinations produced simulated patterns with either no or very few less than 15 trees at the end of the projection period this could explain the large interaction terms in the efast results for the mark distribution which might even be unreliable in the highly skewed cases a simpler explanation may be that non spatial distributions of marks simulated in a model are naturally more dependent on all model processes than a spatial characteristic such as the mark variogram further we studied the grouped main effects with respect to the mark variogram by pooling the effects of the model parameters of the growth g interaction i and mortality m components for each model and tree population fig 7 this analysis summarised the detailed results given in the left columns of figs 6a and b since the effects of parameter interaction were small when using the mark variogram for validation we focussed on the main effects here in figs 4 7 the models were sorted according to the corresponding number of parameters where gi had six gi seven sn eight and sn nine parameters thus the base models gi and sn are the simplest and the most complex model respectively whilst the recombined models gi and sn represent transitional stages for both tree populations a clear trend can be detected for the interaction parameters their importance increased with increasing number of model parameters and thus model complexity however the more complex models tended to be less sensitive to growth parameters in gi more emphasis is placed on growth processes whilst in sn particularly when applied to scots pine the modelling of interaction is of greater importance and the recombinations are situated somewhere between the base models comparing the two tree populations the interaction parameters were more influential in scots pine and the mortality parameters more important in interior douglas fir this partly reflects the higher mortality rate in interior douglas fir compared to scots pine and especially gi but also sn in interior douglas fir were very sensitive to mortality parameter b fig 6a because mortality rates are low interaction processes are perhaps more important in the caledonion pinewoods where environmental effects are less harsh and varied compared with the interior douglas fir woodland 4 discussion our analysis yielded fascinating new insights on the working principles and performance of seemingly different ibms the fitting and validation revealed that both base and recombined models were suitable for simulating the two quite different woodland communities and performed well although their growth and interaction components were markedly different see figs 4 and 5 it is also interesting to recall that we pooled the plot data of each tree population although the spatial patterns of trees varied from plot to plot the good model fit reassured us that it was correct to assume that all plots from one tree population have similar dynamics i e growth interaction and mortality furthermore we found that the data quality of the two tree populations studied affected the model outcome for the more heterogeneous scots pine data the model fitting performed worse than for the interior douglas fir woodland this has been an important lesson obviously for good model fits ibms require data from well designed observational plots or experiments containing sufficient information on spatial tree interactions our results clearly suggest that our four ibms belong to one family and they all performed reasonably well for both tree populations in fact growth interaction model is a splendid name for this ibm family as growth and interaction are indeed the most important processes in plant ibms as in our examples interestingly the fact that tree marks can shrink in size as part of gi and sn models has not turned out to be disadvantage although it may seem counterintuitive on first sight we have found no statistical evidence suggesting any disadvantage stemming from this model property differences in model processes were identified by the results of the sensitivity analysis which clearly demonstrated the value of this type of analysis in the base model gi more importance was attributed to growth processes and less to interaction this is of course partly a result of the less sophisticated interaction model compared to sn the importance of interaction parameter β in this model confirms the findings by pommerening et al 2011 therefore the sensitivity analysis highlighted greater importance of interaction processes in sn interestingly we discovered an interplay between the potential mark growth and tree interaction models where the influence of growth processes decreased with increasing model sensitivity to tree interaction this outcome implies that ibm users or developers can indeed use the sensitivity of model components as decision support for how much importance they would like to assign to the interaction process in the context of ibms where the mechanistic modelling of interactions is rightly pointed out as the most important objective one may be tempted to select the more complex sn model which represents interactions in a more detailed way however we learnt in our research that this selection comes at a certain price since the more complex model is less robust and fitting is more difficult with challenging data which do not include sufficient information on the type of interaction sn also has the advantage that we obtain an interaction field for the whole forest which can be used for other modelling purposes such as the modelling of birth processes theoretically it is possible to derive an approximate equivalent of such a field from the overlapping zoi discs in the gi model but more detailed information on tree interactions is obtained from sn provided that the model is reasonable for the quality of the data available for model fitting the recombinations gi and sn may offer a compromise as we experienced when fitting the four models to scots pine data since in terms of complexity they are between gi and sn however sn is perhaps a problematic recombination because the fitting yielded α 0 in both of our examples and one may wonder whether this is a mere model artefact or a reflection of real processes in the tree populations 5 conclusions growth interaction and shot noise models were suitable and performed similarly in the two applications considered both models and their recombinations belong to the same group of ibms and are mainly different in two aspects i e in interaction and mark growth modelling our new methodology of using recombinations of model components in conjunction with validation and sensitivity analysis made us understand that shot noise models are able to describe plant interactions more accurately than growth interaction models however the latter are more robust which is a valuable feature in situations where the data are noisy or do not sufficiently include the necessary interaction information shot noise models also have the advantage of providing detailed interaction fields with information for any point in the forest which can be used for modelling birth processes through comparative fitting we also found evidence that maximum likelihood estimations were more robust and reliable in spatial regression analysis than least squares estimations however research on the fitting of ecological ibms including spatial regressions has only recently started redenbach and särkkä 2013 and more interdisciplinary work is required authors contribution all authors analysed the data carried out the modelling analyses and contributed to the text acknowledgements we are grateful to peter marshall university of british columbia canada and sophie hale forest research uk for kindly providing the two example data sets h h and m m have been financially supported by the academy of finland project numbers 304212 295100 and 306875 we also thank three anonymous reviewers and the subject editor for their valuable suggestions appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 02 013 appendix a supplementary data the following are the supplementary data to this article 
25026,agent individual based models a ibm help to explain in a mechanistic way how spatial plant patterns evolve through time in the past seemingly different and independent types of a ibms were developed for modelling the dynamics of tree populations e g growth interaction gi and shot noise sn models in this paper we present a new advanced methodology of pattern oriented modelling pom for the comparative synoptic analysis of the behaviour of different types of a ibms by using recombinations of model components validation and sensitivity analysis we analysed model behaviour for spatio temporal data from natural forests of interior douglas fir pseudotsuga menziesii var glauca mirb franco and scots pine pinus sylvestris l populations from canada and the uk respectively our detailed analysis clarified that both models gi and sn along with their recombinations performed similarly and belong to the same group of a ibms from the application of our new methodology we learnt that sn models were able to describe interactions more accurately than gi models and additionally produce interaction fields that can be used for other modelling purposes on the other hand the gi model was more robust when using observed data that did not include sufficient information on tree interactions maximum likelihood estimations were more reliable in spatial regression analysis than least squares methods and should be preferred in spatial a ibm parametrisation keywords natural forest dynamics agent individual based models spatial tree interactions growth interaction model shot noise model recombination of model components absolute and relative growth rates point process statistics 1 introduction a common challenge in spatial forest ecology stems from the fact that most data available for spatial analysis are so called snapshot data i e mapped data representing a single instance in time during the past 10 20 years point process statistics has contributed much to uncover intriguing processes behind spatial plant patterns illian et al 2008 wiegand and moloney 2014 dale and fortin 2014 however any conclusions drawn from these inferences are associated with a degree of conjecture and uncertainty since previous instances of the ecological data under consideration are unknown o sullivan and perry 2013 to gain more certainty many spatial point process models have been developed to describe observed patterns and to synthesise them until recently these models were only able to handle either instances in space or time but not both simultaneously so that most spatial point process models are only suitable for snapshot data whilst developing new approaches for analysing and modelling spatio temporal ecological data cressie and wikle 2011 agent individual based models a ibms have gained the attention of both ecologists and statisticians grimm and railsback 2005 illian et al 2008 and inspired much interdisciplinary work this is related to the fact that these models particularly focus on a mechanistic understanding of the interactions between individuals individual based models is the term commonly used in ecology while agent based model is preferred in other fields of science both terms are treated as synonyms grimm and railsback 2005 the results of the spatio temporal evolution of a point pattern of plant locations is primarily the consequence of multiple complex interactions among individual plants and between individual plants and the environment as such ib modelling shares some similarities with game theory falster and westoby 2003 mcnickle and dybzinski 2013 many approaches to ib modelling have in fact their origin outside ecology e g in physics and spatial statistics different names have been given to this type of models e g ecological field theory wu et al 1985 miina and pukkala 2002 competition kernel models schneider et al 2006 adams et al 2011 vogt et al 2010 and ibms grimm 1999 berger et al 2002 fibich and lepš 2011 renshaw and särkkä 2001 and särkkä and renshaw 2006 suggested an intriguing general growth interaction model gi model for spatio temporal marked point processes where marks can for example be arbitrary size variables of plants also here the gi model is not restricted to applications from plant ecology and describes interaction structures in a similar way as gibbs point process models a particular characteristic of the gi model is its linear additive growth model in conjunction with zone of influence zoi based interaction in our interdisciplinary work we studied whether the growth interaction model is a member of the a ibm family of models although originating in point process statistics and if so how it fits in with other models of this type to the best of our knowledge the gi model has so far only been applied to data from even aged plantation forests from sweden and we demonstrated how the model can be generalised to accommodate any forest situation including natural forest development for a better characterisation of the distinctive features of the gi model we introduced the model synoptically by comparing it with the shot noise ibm model sn model pommerening et al 2011 which is an established ibm and appeared to share similarities with the gi model for the ease of comparison this partly involved a re arrangement of otherwise published model terms and sub models through a pattern oriented modelling pom inspired validation based on global sensitivity analysis we studied the behaviour of both models and advanced this methodology by using recombinations of sub models 2 methods in point process statistics points describe the locations of objects of interest e g plants and marks provide additional information thus characterising objects in terms of type size or shape patterns including points and marks are referred to as marked point patterns the objects described by the points and marks usually interact with each other in a complex way these interactions much depend on the nature of the objects e g what species of plants they are and on their biology and ecology illian et al 2008 2 1 model synopsis to facilitate comparison in both the gi and sn models potential mark growth in terms of absolute growth rates agr was modelled in the same way using a growth function described by hugershoff 1936 and zeide 1993 eq 7 see table 1 sub model 1 in contrast to most other growth functions the hugershoff function does not rely on time but on mark e g plant size for generalisation we used the point process term mark in this paper to emphasise that the modelling focus can be on any plant size characteristic or on combinations of plant characteristics e g squared tree stem diameters multiplied by total tree height as an approximation of biomass making growth functions dependent on size is generally helpful for handling data from natural and uneven aged forests where trees are typically of different age and age information is not recorded also the mortality model table 1 sub model 5 was largely the same for both individual based models ibm and it was based on the approach described in pommerening and särkkä 2013 mortality here depends on a 5 year growth performance that in turn is determined by a combination of potential mark growth and interaction the growth performance is derived from the ratio of current and previous mark the so called growth multiplier m i t in table 1 see also eqs 16 and 17 in pommerening and muszta 2016 which is a function of relative growth rate rgr relative growth rates have proved to be good indicators of imminent death bigler and bugmann 2003 gillner et al 2013 for a given tree i a memory function aggregates the growth multipliers m i t of the last five years from which the corresponding rgr p i t 5 is calculated if the simulated five years rgr falls short of a critical value the tree dies after a detailed analysis of the data of dying trees we decided to modify the approach published in pommerening and särkkä 2013 by replacing the critical value p i t 5 crit by the power function p i t 5 crit m i t a m i t b where a and b are model parameters and m i t is the mark of tree i at time t the power function takes the dynamics of relative growth rates better into account specifically the size influence leading to a trend where smaller plants tend to have large and larger plants tend to have small rgrs pommerening and muszta 2016 we therefore made the critical value p i t 5 crit dependent on the size of the tree in question however in the gi model trees with m i t 0 die and those with m i t m limit are exempted from the common mortality rule sub model 5 in table 1 that applies to both models the size limit m limit is applied because we noticed that only trees with small marks tend to develop p i t 5 0 thus trees with p i t 5 0 in the gi model are allowed to shrink to death which eventually occurs when m i t 0 applied to plant and particularly to forest ecology this model feature may seem odd on first sight on second thought the shrinking process is intriguing because it mimics failing tree health and consequently performance due to diseases that may be facilitated by tree interaction sapwood area in trees can vary in extent over time mäkelä and valentine 2006 valentine and mäkelä 2012 and the shrinking of marks can be interpreted as a metaphor of this process the ability of marks to shrink is a unique characteristic of the gi model the main difference between gi and sn model is in the way how 1 interaction and 2 mark growth are quantified when applied to tree patterns särkkä and renshaw 2006 and cronie et al 2013 have favoured an interaction function quantifying the overlap area of the zois of trees in relation to the area of the zoi of the tree under study this function is based on well known principles of quantifying competition suggested by gerrard 1969 and bella 1971 i e two trees interact only if their zois overlap zois can for example be interpreted as areas of crown or root expansion of a tree in comparison with the sn model zois can also be interpreted as uniform kernel density functions in the gi model the interaction function has two model parameters c and r determining the mode of interaction competition or facilitation for the population e g a forest stand as a whole and the radius of the circular zoi respectively table 1 sub models 2 4 cronie et al 2013 have referred to c as force and r as scale of interaction the zoi radius r i t simply is the product of model parameter r and tree mark m i t m i t 2 in our case särkkä and renshaw 2006 as a result r i t linearly increases with increasing tree size thus the range of these uniform kernel density functions simply depends on the mark of tree j emitting the interaction signal whilst the strength of the signal depends on the area of the intersection of the zoi of tree j and its neighbouring tree i and also on the mark of tree i see table 1 sub model 2 and fig 1 in the sn model the interaction function aggregates interaction signals emitted by each tree at the location of the subject tree pommerening et al 2011 the gaussian kernel density function used to model the interaction signals stems from a suggestion made by adler 1996 in contrast to our previous publications pommerening et al 2011 pommerening and särkkä 2013 we replaced the exponential kernel by a gaussian kernel because this helped to stabilise parameter estimations and appeared more realistic to us since the interaction signal does not decrease so rapidly near the signal emitting tree our kernel function differs from most other kernel functions see schneider et al 2006 berger and hildenbrandt 2000 in that the function not only depends on the distance from the subject tree but also on its mark the interaction signal of a tree in the sn model has three model parameters α β and δ table 1 sub model 2 a large value of α increases the strength of the interaction signal whilst β and δ on the contrary affect the range of the interaction signal pommerening et al 2011 fig 1 the term m j t α gives the value of the interaction signal at the location of ξ j of tree j here d i s t j 2 ξ j 0 whilst exp δ d i s t j 2 ξ m j t β describes the decay of the interaction effect with distance since the sn model does not use zois the size of a tree s zoi can be considered infinite in this model as a consequence of this definition of interaction signals a random field is constructed that describes an interaction structure resulting from additively superimposing interaction signals of single trees in a forest which is a key feature of the shot noise model the sum of these interaction signals is then divided by the interaction signal value of the subject tree at its own location a method similar to that in the gi model thus the strength of interaction is affected by neighbouring tree i see table 1 sub model 2 and the interaction functions of both gi and sn models produce asymmetric interaction the standardisation of the interaction term table 1 sub model 3 is particularly important for the multiplicative mark growth model table 1 sub model 4 where there is a requirement to have h i t trans distributed between 0 and 1 and large interaction values need to be converted to small multipliers in sub model 4 in the gi model potential mark growth and interaction are aggregated additively in contrast to the sn model where these two terms are aggregated multiplicatively this implies that marks in the gi model can shrink in contrast to the sn model where this is not possible as a consequence death by interaction särkkä and renshaw 2006 can occur when trees eventually have a mark smaller than or equal to zero mark shrinking is not possible in the sn model due to the multiplicative approach the multiplicative approach implies that potential mark growth as calculated in sub model 1 table 1 is reduced by a multiplier wrapping the interaction load this multiplier is given by h i t trans the terms calculating growth rates in sub model 4 table 1 are set in square brackets for the ease of identification 2 2 parameter estimation we defined stem diameter at breast height 1 3 m above ground level dbh as the mark of our study and proceeded with the parameter estimation in three steps firstly we estimated the parameters of potential mark growth k p and q for both models from the observed data separately from the remainder of the two models in contrast to previous publications of the gi model e g cronie et al 2013 where additional data were used potential mark growth was directly estimated from the data as an upper quantile of the observed mark growth rates applying quantile regression koenker and park 1994 cade and noon 2003 where the quantile selected was set to τ 0 975 for interior douglas fir and to τ 0 900 for scots pine this method ensures that potential growth is estimated adequately even if some trees have not realised their full growth potential as part of the quantile regression the state space approach involved an annual updating of the mark the updates were produced by the growth function and as a result the growth rates correctly followed a nonlinear growth curve rather than a linear one as is often assumed when working with mean annual growth rates from periodic re measurements nord larson 2006 as the observed growth rates used in the quantile regression stem from repeated measurements in the same observational plots we accounted for possible within tree correlations using the first order autoregressive method in addition to the state space approach described in nord larson 2006 secondly the interaction and mark growth parameters were estimated through nonlinear spatial regression we estimated the parameters of model components 2 3 in table 1 simultaneously using annual stem diameter growth rates as dependent variables since such complex spatial regressions are novel we applied both a nonlinear least squares and a maximum likelihood approach for estimating the parameters of model components 2 4 by initially using the same starting values then we evaluated least squares loss at the maximum likelihood location ignoring variance finally we fitted the maximum likelihood model using the least squares parameter estimates as starting points for each regression result we also checked quantile quantile plots homoscedasticity of residuals and the shape size of the interaction kernels zois the parameter estimates of both methods usually were quite similar for interior douglas fir but a comparison of the least squares loss function at the parameter set of both methods commonly let to slightly better results achieved by the maximum likelihood method the scots pine data were somewhat more heterogeneous and here the least squares method even proved unreliable in this estimation process we applied periodic boundary conditions illian et al 2008 for spatial edge correction in a third step we estimated parameters a and b of the critical cumulative 5 years rgr function p i t 5 crit m i t from simulations involving the two models separately conditional on all other parameters more precisely we optimised the difference between the model output and the observed data where the number of trees per hectare and basal area per hectare over the survey years and plots were used as dependent variables in the loss function because of the special nature of the gi model with small marks that can shrink in size we introduced the additional auxiliary parameter m limit which we set to 0 for the sn and to 20 for the gi model so that small trees were allowed to shrink to death according to the original gi model philosophy särkkä and renshaw 2006 for marks m i t m limit we set b 0 in the gi model so that p i t 5 crit was in fact constant in this model in the estimation of the mortality parameters as well as in other model simulations we applied a special type of temporal edge correction to the memory function this correction is necessary at the start of each model simulation because the relative growth rates of the trees prior to the first survey year which also marks the start of the simulation are unknown and yet these are essential to determine the mortality of the first five years of the simulation we solved this problem by estimating growth rates using sub models 1 4 from table 1 for all trees present at the start however based on estimated growth rates we grew the trees back by five years in annual steps from the starting year thus reduced tree sizes were applied to the growth function and in the interaction model during this process we assumed that the point pattern remained unchanged with the exception that tree marks may be reduced to values of less than zero and then disappear and consequently all interactions were largely based on the point pattern of the starting year as a summary of parameter estimation and to provide additional details for the ease of reproducing our research a pseudo code is documented in appendix a as a summary of parameter estimation and to provide additional details for the ease of reproducing our research a pseudo code is documented in appendix b 2 3 model scheduling both models operate in discrete annual time steps and at the beginning of each time step first the mortality rule is applied followed by a removal of all dead trees fig 2 afterwards the interaction term is calculated which contributes to the annual growth rates in the same way as in the parameter estimation the interaction term is calculated using periodic boundary conditions illian et al 2008 after calculating potential interaction and mark growth it is possible to determine growth rates using growth rates the tree stem diameters are now updated synchronously the visualised samples of the observed data and from simulations of the canadian douglas fir forest see section 2 7 using the gi and the sn models table 1 show that the differences in forest structure between the two models and each model and the observed data are not great after 16 years of simulation fig 3 2 4 recombination of model components while preparing the experimental design of this study we understood that we could learn much about model behaviour by recombining the model components that differ in our case this option related to model components 2 4 in table 1 i e we exchanged the interaction and mark growth components as a consequence we were able to simulate and analyse the two models as detailed in table 1 and in addition gi interaction with multiplicative mark growth from the sn model and sn interaction with additive mark growth from the gi model for convenience we abbreviated multiplicative and additive mark growth with the operator symbols and respectively accordingly the base models as described in table 1 were labelled gi and sn in addition we used the recombination gi which includes sub models 2 gi 3 sn and 4 sn and parameters r and ν sn which includes sub models 2 sn 3 gi and 4 gi with parameters α β δ and c the mortality model was the same for the additive gi and sn and multiplicative gi and sn models respectively 2 5 model validation we used pattern oriented modelling in our analysis and validation by considering growth rates mark distributions and spatial characteristics grimm et al 2005 to this end we compared the data and the model outputs of the last survey year by means of the mark weighted version of ripley s k r function namely k γ r i e the cumulative version of the mark variogram γ m r and the mark dbh distribution the functions k γ r and γm r are based on the mark test function m 1 m 2 2 2 exploring the pairwise differences of marks of points up to distance r and at distance r respectively see e g illian et al 2008 section 5 3 3 pommerening and särkkä 2013 the mark weighted k γ r was square root transformed and centred by l γ r l r where l γ r k γ r π and l r k r π and l r represents the behaviour of l γ r under the so called random labelling hypothesis i e the case of no correlations in marks see e g illian et al 2008 section 4 3 1 bias and rmse of the mark growth rates were calculated as 1 n i 1 n d m i d m i ˆ and var d m ˆ bias d m ˆ 2 i 1 n d m i d m i ˆ 2 n 1 1 n i 1 n d m i d m i ˆ 2 respectively where dm i is the observed mark growth rate of tree i and d m i ˆ is the corresponding estimated mark growth rate n is the total number of growth rates across the survey years we used the r package spatstat baddeley et al 2016 for the estimation of k r k γ r and γ m r with translational edge correction the mark distribution corresponded to the empirical cumulative distribution function 2 6 sensitivity analysis for studying model behaviour we applied the extended fourier amplitude sensitivity test a variance based global sensitivity method saltelli et al 2000 pianosi et al 2016 the fourier amplitude sensitivity test fast was first devised in the 1970s by cukier and others see cukier et al 1978 and further developed by saltelli et al 1999 to become the extended fast method efast efast is model independent and is applicable irrespective of the degree of linearity or additivity of the model the method is based on a variance decomposition of a model output variable y i e v a r y d j 1 z d j 1 i j z d i j d 1 2 z for the decomposition z 1 individual input parameters are mathematically interpreted as random variables x x 1 x z the first order contributions of the j 1 z input parameters correspond to the variances of the expected value of y given x j i e d j v a r x j e y x j x j the contributions from higher order interactions between the variables d are defined accordingly the efast method approximates main effects s j d j d which are also known as sobol first order indices and so called sobol total order indices collecting the main effects and all interactions including j from these approximations higher order interaction terms can be obtained by subtracting the main effects from the corresponding total order indices in this way the efast results highlight which input parameters have a significant influence on the simulation with respect to the output variable and give a measure for sensitivity or uncertainty saltelli et al 2000 saloranta and andersen 2007 pommerening et al 2011 in our context the model parameters constitute the input the sensitivity analysis helps to identify those parameters that have the largest influence on the outcome variable hence if a researcher selects the model with the highest sensitivity to the interaction parameters for example the chance of describing the interaction process well is high the variability of the input parameters should be representative of the observational error here a variation of 10 around the standard parameter values was considered including 500 samples we also tested variation percentages larger than 10 but this did not lead to different results due to the considerable computational effort the number of samples was chosen to be as low as possible whilst still giving stable results we analysed the model output using the r package sensitivity as output variables the integrated difference between observed and simulated 1 mark variogram γ m r see e g illian et al 2008 section 5 3 3 pommerening and särkkä 2013 and 2 empirical cumulative mark distribution function were considered since each tree population included several point patterns we used a weighted sum of each of the aforementioned integrated measures 1 and 2 where the weighting was based on the number of trees observed in the patterns in the last survey year per tree population l γ r was not used as it was associated with a multimodal distribution and variance based sensitivity analysis methods should include output variables with unimodal distributions 2 7 sample tree populations firstly we fitted the models to interior douglas fir pseudotsuga menziesii var glauca mirb franco spatio temporal data from an uneven aged stand in the alex fraser research forest in british columbia canada longitude 52 3 latitude 121 52 at approximately 1000 m a s l the mean annual temperature is 4 2 c and the mean annual precipitation is 450 mm the data were collected in six plots starting in 1988 with re measurements in 1992 1997 and 2004 four plots had a size of 0 10 ha 2 plots with higher tree densities comprised 0 05 ha the forest site had not been cut for at least 20 years and was under protection from large scale fires lemay et al 2009 we also received permission to use interesting scots pine pinus sylvestris l data from two monitoring plots in the remnants of the caledonian pinewoods namely abernethy and young glenmore queens 26 plot 5 uk longitude 57 30 latitude 4 15 vast areas of northern scotland were once covered by the caledonian pinewoods for several millennia the forest sites are situated at approximately 330 m a s l mean annual rainfall is 900 mm and mean annual temperature about 6 0 c abernethy represents a well structured old growth natural forest it was first measured in 2002 and then re measured in 2008 on a 0 8 ha plot young glenmore was planted in 1926 to replace an old stand felled during world war i the forest was first measured in 2003 and subsequently re measured in 2008 2013 and 2018 on a 1 ha plot mason et al 2007 no birth processes occurred on any of these sites that is why the ibms do not include them instead the pattern of the first survey in each plot was used as initial pattern and the simulation extended until the last survey year in our experience at least two re measurements i e three spatial tree measurements in time are necessary to estimate reliable model parameters this condition was satisfied for the two sample populations 3 results 3 1 model validation bias and rmse of mark growth rates for the gi gi sn and sn models were of similar magnitude tables 2 and 3 for interior douglas fir the sn model had the lowest rmse and second lowest bias whereas for scots pine in fact sn led to the lowest bias and gi had the lowest rmse we experienced some problems with sn i e the parameter optimisation was sensitive to the starting values restricting the parameters to be positive helped but resulted in α 0 for both tree populations this implies that the outcome led to a simplified kernel where the size of the tree had no effect on the strength of the kernel but only on its range the l γ r functions and mark distributions fig 4 for interior douglas fir and fig 5 for scots pine of the simulations of the fitted models were all rather similar to one another in all plots the centred l γ r functions showed negative values indicating that the marks of nearby trees tended to be similar while the degree of similarity varied from plot to plot all the models appeared flexible enough to produce patterns similar to those of the observed data the most similar l γ r functions across different models occurred in plots 4 and 6 interior douglas fir and in both scots pine plots because in these plots hardly any mortality occurred both in the original data and in the models as more detailed investigations not reported here revealed thus given the fixed starting patterns for all model simulations almost only growth and interaction of trees affected the final patterns for the other interior douglas fir plots there was larger variation in terms of which tree individuals died and thus between the model outputs as expected the mark distributions varied from plot to plot e g plots 5 and 6 interior douglas fir had more small trees than the other plots while plot 4 had less as all models were able to capture the mark distributions well we concluded that the small differences in mark variograms were mainly due to at which locations trees died in different model simulations 3 2 sensitivity analysis the sensitivity analysis was carried out with respect to the spatial patterns of marks as measured by the mark variogram γ m r and the non spatial mark distribution separately for the interior douglas fir and scots pine data inter tree distances up to eight metres were considered for both tree populations as the majority of interactions in temperate forests are observed within this distance pommerening and sánchez meador 2018 parameters of value zero b for gi and sn and α for sn were excluded from the analysis the main effects obtained by the efast method and interaction terms for each of the four considered models gi gi sn and sn were compared for each output variable and tree population fig 6 considering the mark variogram the potential mark growth parameter p was the most important parameter across all models in nearly all four sn models two per species the interaction parameter β was the most influential or at least a very influential parameter mortality parameter b turned out to be crucial for gi and sn the models fitted to the interior douglas fir data fig 6a were more sensitive to growth parameter q than the scots pine models fig 6b in all gi models interaction parameter r tended to be more important than c or ν in all studied cases mortality parameter a turned out to be almost of no influence on the model outcome the high sensitivity to mortality parameter b in gi for interior douglas fir related to the fact that a small change in b could lead to a high reduction of trees in the final pattern when applying efast to the mark distribution parameters p r and β had the greatest impact on the mark distribution again β was the most influential parameter for all sn models interestingly all parameters showed markedly larger interaction terms than in case of the mark variogram as interaction and mortality parameters highly depend on growth parameters and vice versa we re ran the sensitivity analysis keeping k p and q fixed but found no pronounced differences in the efast results for the other parameters thus we concluded that the large interaction terms were not just a result of the stepwise parameter estimation procedure in contrast to the mark variogram based outcome variable the mark distribution based outcome variable showed highly skewed distributions especially for sn for scots pine only and sn for both tree populations where several parameter combinations produced simulated patterns with either no or very few less than 15 trees at the end of the projection period this could explain the large interaction terms in the efast results for the mark distribution which might even be unreliable in the highly skewed cases a simpler explanation may be that non spatial distributions of marks simulated in a model are naturally more dependent on all model processes than a spatial characteristic such as the mark variogram further we studied the grouped main effects with respect to the mark variogram by pooling the effects of the model parameters of the growth g interaction i and mortality m components for each model and tree population fig 7 this analysis summarised the detailed results given in the left columns of figs 6a and b since the effects of parameter interaction were small when using the mark variogram for validation we focussed on the main effects here in figs 4 7 the models were sorted according to the corresponding number of parameters where gi had six gi seven sn eight and sn nine parameters thus the base models gi and sn are the simplest and the most complex model respectively whilst the recombined models gi and sn represent transitional stages for both tree populations a clear trend can be detected for the interaction parameters their importance increased with increasing number of model parameters and thus model complexity however the more complex models tended to be less sensitive to growth parameters in gi more emphasis is placed on growth processes whilst in sn particularly when applied to scots pine the modelling of interaction is of greater importance and the recombinations are situated somewhere between the base models comparing the two tree populations the interaction parameters were more influential in scots pine and the mortality parameters more important in interior douglas fir this partly reflects the higher mortality rate in interior douglas fir compared to scots pine and especially gi but also sn in interior douglas fir were very sensitive to mortality parameter b fig 6a because mortality rates are low interaction processes are perhaps more important in the caledonion pinewoods where environmental effects are less harsh and varied compared with the interior douglas fir woodland 4 discussion our analysis yielded fascinating new insights on the working principles and performance of seemingly different ibms the fitting and validation revealed that both base and recombined models were suitable for simulating the two quite different woodland communities and performed well although their growth and interaction components were markedly different see figs 4 and 5 it is also interesting to recall that we pooled the plot data of each tree population although the spatial patterns of trees varied from plot to plot the good model fit reassured us that it was correct to assume that all plots from one tree population have similar dynamics i e growth interaction and mortality furthermore we found that the data quality of the two tree populations studied affected the model outcome for the more heterogeneous scots pine data the model fitting performed worse than for the interior douglas fir woodland this has been an important lesson obviously for good model fits ibms require data from well designed observational plots or experiments containing sufficient information on spatial tree interactions our results clearly suggest that our four ibms belong to one family and they all performed reasonably well for both tree populations in fact growth interaction model is a splendid name for this ibm family as growth and interaction are indeed the most important processes in plant ibms as in our examples interestingly the fact that tree marks can shrink in size as part of gi and sn models has not turned out to be disadvantage although it may seem counterintuitive on first sight we have found no statistical evidence suggesting any disadvantage stemming from this model property differences in model processes were identified by the results of the sensitivity analysis which clearly demonstrated the value of this type of analysis in the base model gi more importance was attributed to growth processes and less to interaction this is of course partly a result of the less sophisticated interaction model compared to sn the importance of interaction parameter β in this model confirms the findings by pommerening et al 2011 therefore the sensitivity analysis highlighted greater importance of interaction processes in sn interestingly we discovered an interplay between the potential mark growth and tree interaction models where the influence of growth processes decreased with increasing model sensitivity to tree interaction this outcome implies that ibm users or developers can indeed use the sensitivity of model components as decision support for how much importance they would like to assign to the interaction process in the context of ibms where the mechanistic modelling of interactions is rightly pointed out as the most important objective one may be tempted to select the more complex sn model which represents interactions in a more detailed way however we learnt in our research that this selection comes at a certain price since the more complex model is less robust and fitting is more difficult with challenging data which do not include sufficient information on the type of interaction sn also has the advantage that we obtain an interaction field for the whole forest which can be used for other modelling purposes such as the modelling of birth processes theoretically it is possible to derive an approximate equivalent of such a field from the overlapping zoi discs in the gi model but more detailed information on tree interactions is obtained from sn provided that the model is reasonable for the quality of the data available for model fitting the recombinations gi and sn may offer a compromise as we experienced when fitting the four models to scots pine data since in terms of complexity they are between gi and sn however sn is perhaps a problematic recombination because the fitting yielded α 0 in both of our examples and one may wonder whether this is a mere model artefact or a reflection of real processes in the tree populations 5 conclusions growth interaction and shot noise models were suitable and performed similarly in the two applications considered both models and their recombinations belong to the same group of ibms and are mainly different in two aspects i e in interaction and mark growth modelling our new methodology of using recombinations of model components in conjunction with validation and sensitivity analysis made us understand that shot noise models are able to describe plant interactions more accurately than growth interaction models however the latter are more robust which is a valuable feature in situations where the data are noisy or do not sufficiently include the necessary interaction information shot noise models also have the advantage of providing detailed interaction fields with information for any point in the forest which can be used for modelling birth processes through comparative fitting we also found evidence that maximum likelihood estimations were more robust and reliable in spatial regression analysis than least squares estimations however research on the fitting of ecological ibms including spatial regressions has only recently started redenbach and särkkä 2013 and more interdisciplinary work is required authors contribution all authors analysed the data carried out the modelling analyses and contributed to the text acknowledgements we are grateful to peter marshall university of british columbia canada and sophie hale forest research uk for kindly providing the two example data sets h h and m m have been financially supported by the academy of finland project numbers 304212 295100 and 306875 we also thank three anonymous reviewers and the subject editor for their valuable suggestions appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 02 013 appendix a supplementary data the following are the supplementary data to this article 
25027,matrix population models mpms are powerful tools for translating demographic and life history information into a form that can be used to address a wide range of research topics such as projecting population dynamics evaluating stressor impacts on populations and studying life history evolution however the reliability of such studies depends on the mpm being constructed in a way that accurately reflects the species life history we highlight three errors commonly encountered in published mpms 1 failing to include survival in the fertility coefficient 2 introducing a one year delay in age at first reproduction and 3 incorrectly calculating the growth rate out of a stage class we review the sources of such errors and provide new analyses revealing the impact of such errors on model predictions using lionfish and american alligator models as examples to quantify the prevalence of such errors we examined and scored the original publications underlying the models in the comadre animal matrix database the first two errors were found in 34 and 62 respectively of the published studies nearly all were in models that used a postbreeding census representation of the life cycle in which newborns eggs neonates fledglings etc are explicitly included of the studies where stages may last longer than one time step 53 constructed the growth rate using inappropriate formulas for estimating the asymptotic population growth rate or its sensitivity to demographic parameters these results suggest that further efforts may be required to educate biologists on the construction of mpms perhaps in concert with the development of new software tools furthermore the conclusions of many studies that are based on mpms may need to be re examined and synthetic studies using the comadre database need to be accompanied by careful examination of the underlying studies keywords comadre animal matrix database lefkovitch matrix leslie matrix matrix population models model construction model validity 1 introduction the use of matrix population models mpms for the ecological study of plants and animals has expanded rapidly in recent years salguero gómez et al 2016 2015 mpms are a convenient way to synthesize demographic information about a population and are useful in addressing ecological evolutionary and management questions caswell 2001 morris and doak 2002 most early mpms were developed by collaborations between biologists with expertise on the species at hand and modelers with deep understanding of the subtleties of modeling mpms now having been long promoted as a straightforward translation of life history information into quantitative analysis are often being created by biologists who are primarily empirical ecologists or conservation biologists and may have had little training in modeling beyond a graduate course in population ecology one might then ask do these mpms reliably reproduce the life histories they are meant to represent it is important to remember that mpms are approximations both because they still abstract away much biological detail and because demographic measurements are imprecise there are a variety of subtleties in constructing such models especially when breeding is spread across a substantial fraction of the year or when there is substantial heterogeneity among individuals within an age or stage class much theoretical work has gone into making mpms more complex to account for this and we are starting to better understand the effects of these phenomena on simple models e g fujiwara and diaz lopez 2017 salguero gómez and plotkin 2010 but even setting aside these issues we might hope that if we assume that a simple life history description e g as embodied in a life table or set of stage based life history parameters is a useful description of the population then the constructed mpm should accurately reproduce that description if it does not then we are introducing additional errors into the analysis above and beyond the inherent approximations of modeling one of us kendall has spent two decades teaching mpms to applied masters students this experience has revealed several aspects of mpm construction that are particularly challenging to modelling novices and thus might be similarly challenging to biologists who do not regularly create mathematical models of their system at one level the errors made by these novices are simply accounting issues but some students exhibit a strong attachment to the incorrect formulations we suspect that this difficulty for both students and researchers is partly rooted in the contrast between the often loose way that terms are used to describe biological populations and the very precise meanings of terms in mpms together with some genuine linguistic ambiguity that plagues the field however some of these issues may be instances of what education scholars call a threshold concept an understanding that is essential to mastery of a field but that is troublesome to students because it appears to violate common sense intuition cousin 2006 meyer and land 2006 we have not infrequently encountered published mpms that embody many the same mistakes made by kendall s students our goal in this paper is to highlight these challenges which are described in the next section document their prevalence in the peer reviewed literature and quantify their impacts on the outputs of mpms we conclude with a discussion of why these mpm construction errors are so prevalent and how we might improve future practice 2 challenges in mpm construction we focus on animal population models in which the demography is structured by age leslie matrices leslie 1945 or developmental stage lefkovitch matrices lefkovitch 1965 plant and size structured models present additional challenges which would further complicate our presentation we also focus on species whose reproduction is concentrated in a short breeding season so called birth pulse populations caughley 1967 many animal species satisfy this assumption and this allows us to avoid the extra complications associated with using discrete time models to represent a continuously breeding species note that by breeding season we mean the season in which individuals are born or hatched not the season during which their parents mate age starts counting from birth so that a reproductively mature individual breeds on or about their birthday e g if the age at first reproduction is 5 years then an individual has its first offspring on its fifth birthday mpms project the population from one nominal census date to the next while the census could in principle be at any time in practice many mpms either census the population just before breeding prebreeding census or just after breeding postbreeding census in a prebreeding census the youngest age class is made up of individuals all with age nearly one which we designate as age one in a postbreeding census the first age class would comprise newborn individuals all of age zero the second class would comprise individuals of age exactly one etc we refer to newborn individuals with a subscript of zero as a result our postbreeding leslie models will look different from most textbooks which assign newborns to age class one and use a subscript of one 2 1 ensuring that the fertility coefficient spans a full timestep in a table of demographic parameters e g table 1 age specific survival and birth rates look as if they should make equivalent contributions to a population model but there is an important difference survival which we denote σ x for leslie models and σ i for lefkovitch models where x is the age and i is the stage represents the fraction of individuals in a class x or i that survive for a full timestep from time t to time t 1 in contrast the birth rate which we denote b x for age structured demography and b i for stage structured demography is an almost instantaneous event it is the average number of offspring produced at time t by an individual that is alive at time t it is tempting to draw a life cycle graph like the one in fig 1 a commonly seen in the literature while this works as a conceptual diagram translating it directly into an mpm by converting each arrow in the graph into a matrix element is incorrect each element in the matrix must span a timestep and b x does not accomplish that to get the timestep into the fertility coefficient b x needs to be multiplied by a survival term either that of the parent or of the offspring failing to include survival term will inflate the fertility coefficients for a prebreeding census model the fertility coefficient is f x b x σ 0 the parent in class x produces b x offspring immediately after the census and then these offspring survive to the end of the timestep at rate σ 0 at which point they are age 1 fig 1b for an annual timestep f x represents the number of one year olds next year produced by an individual of age x this year in a postbreeding census the parent which will have just reproduced if it is already an adult must survive for a timestep aging by a timestep and possibly maturing into a new class and then reproduces with a birth rate appropriate to its class at the end of the timestep if we use x to denote the parent s class at time t 1 then the fertility coefficient is f x σ x b x fig 1d for an annual timestep f x is the number of zero year olds newborns produced next year by an individual that was in class x this year properly accounting for x is a separate challenge that we address in the next subsection 2 2 matching the age at first reproduction to the species life history in an age structured population the lowest age with a non zero birth rate represents the age at first reproduction we will call that age x m for age at reproductive maturity in a prebreeding census model fig 1b this does not present a conceptual challenge as the newly matured about to reproduce for the first time individuals are already classified as age x m matching intuition however in a postbreeding census model the individuals who are age x m at the end of the timestep and have just reproduced for the first time were age x m 1 at the beginning of the timestep a model that has the first non zero fertility coefficient associated with age x m instead of x m 1 fig 1c results in the modeled age at first reproduction being x m 1 a year delay relative to the actual life history the solution is to add a fertility coefficient linking age class x m 1 to age class zero the lower of the two fertility arrows in fig 1d embracing this fertility coefficient requires overcoming cognitive dissonance juveniles are reproducing and we have found that students and perhaps other nonmodellers actively resist this an alternative approach for postbreeding census leslie models is to change the indexing scheme associating x with the individual s age at the end of the timestep rather than the age at the beginning of the timestep as we have done above then the individuals who will mature and reproduce before the next census are called age x m and their fertility is f x m σ ˆ x m b x m we use σ ˆ for survival to clarify that it is a differently indexed parameter from σ as used above thus the cognitive dissonance is finessed by hiding the fact that these individuals started the timestep as juveniles indeed many textbooks use this indexing convention for age structured models however this alternative indexing convention cannot be maintained when moving from age structured to stage structured models as not all individuals that start the timestep as juveniles will end it as adults so let us look at stage structured models the simplest stage structured model has newborns a nonreproductive juvenile class that spans multiple timesteps and reproductive adults fig 2 within the juvenile class some individuals remain juveniles in the next timestep should they survive juvenile juvenile transition whereas others mature into adults juvenile adult transition if γ j is the fraction of surviving individuals that mature grow at the end of the timestep then the juvenile juvenile transition is given by p j σ j 1 γ j and the juvenile adult transition is given by g j σ j γ j we will treat the estimation of γ j in the next section as in age structured models the fertility coefficient needs to include a survival term so fig 2a is incorrect in a prebreeding census model the adult birth rate must be multiplied by newborn survival and newborns removed from the stage vector fig 2b whereas in a postbreeding census model the birth rate must be multiplied by the parent s survival figs 2c d if the criterion for being classed as adult is that the individual can reproduce then just matured adults should have non zero fertility in the prebreeding census model fig 2b the individuals that have just matured made the transition from juvenile to adult will reproduce at the beginning of the next timestep however in the intuitive postbreeding census model fig 2c the individuals that just matured won t reproduce until the end of the next timestep a full timestep after their transition to adulthood in reality the individuals that just made the juvenile adult transition were already adults at the just passed breeding season and hence have had their first opportunity to reproduce to represent this we need a fertility coefficient leading out of the juvenile class f j g j b a fig 2d which again seems to defy common sense this is particularly well illustrated in fig 6 3 of mills 2013 fig 7 3 in the 2007 first edition although this is the textbook solution there are a number of other ways one might finesse this issue such as classifying individuals as adults at the beginning of the timestep in which they mature or creating a special pre adult class between juveniles and adults however these methods introduce additional complications such as giving the maturing juveniles adult survival rather than juvenile survival which might or might not be desirable or shortening the juvenile stage duration to account for the extra stage 2 3 ensuring that the mean time in each developmental stage matches the species life history the final challenge is associated with estimating γ i the fraction of individuals growing e g maturing out of stage i in many cases the goal is to combine information on stage specific survival often variously collected with knowledge about the stage duration the number of timesteps that individuals remain in a stage before maturing if stage durations are fixed e g all individuals mature after two years as juveniles as in table 1 then the goal is to create a stage from age model e g ebert 1998 ch 8 where the mean stage duration in the model equals the fixed stage duration in the life history if the real stage durations are variable then the goal is to create a model where the mean stage duration in the model equals the mean stage duration in the life history in principle the model should also match the variance in stage duration but this seems never to be done in practice caswell 2001 has a section of his book describing various ways of doing calculating γ i to attain a specified stage duration t i depending on the species life history the stage duration might be fixed all individuals mature after exactly t i time steps in the stage or variable there is a distribution of times to complete the stage in which case the mean stage duration needs to be calculated this is not entirely straightforward a topic we do not take up here when the life history contains fixed stage durations there is no single best approach as the stage structured model will never match the age structured model completely nevertheless the primary analyses performed on most published mpms are to calculate the asymptotic growth rate λ 1 and the sensitivity of λ 1 to underlying demographic parameters for these calculations there is one and only one recipe to create a stage structured model that will for any life history generate the same results at least to a very close approximation we have not found theory on this as the equivalent age structured model with t i age classes having the demography of stage i as best we can tell it was first introduced by caswell 1989 although its first application to an ecological population may have been by crowder et al 1994 the basic idea is that γ i represents the fraction of individuals in the stage that have spent enough time in the stage to mature this in turn depends on the implicit age structure within the stage in general this age structure could have any form depending on the recent history of the population the one well defined case is when the population is at the stable age stage distribution this is exactly the condition under which λ 1 the asymptotic growth rate is the observed population growth rate λ t under this condition there are two factors that affect the age distribution within the stage and hence the fraction of individuals of an appropriate age to mature the first is the stage specific mortality which determines how a cohort shrinks as it ages within the stage the second is the asymptotic growth rate which determines the degree to which a cohort entering from the previous stage in one year is larger or smaller than that of the previous year under the stable age or stage distribution this makes γ i non trivial to calculate as the resulting formula table 2 involves λ 1 which can only be calculated once the mpm has been parameterized the solution is an iterative approach take an initial guess of λ 1 calculate γ i from the formula calculate the dominant eigenvalue of the resulting matrix use that as a new guess for λ 1 and repeat until the value of λ 1 stops changing we will refer to this as the asymptotic age within stage structure aas model the iterative nature of the aas model may be daunting to non modelers especially those trained before the emergence of quantitative ecology using r such researchers may be tempted by easier to calculate formulas some discover a predecessor to the above crowder et al approach that appears in crouse et al 1987 table 2 this formula is complex looking but straightforward to calculate as it doesn t require iteration it incorporates the within cohort dynamics but assumes that λ 1 1 we will refer to this as the stationary age within stage structure sas model where stationary means that the population is neither growing nor declining although we have seen no comment on this in the literature the sas model seems to be the correct choice when the goal is to calculate statistics such as the reproductive number r 0 that involve following a cohort through the entire life cycle an even simpler approach is to say that if the desired duration of stage i is t i timesteps then the fraction maturing is 1 t i caswell 2001 this relationship between the mean residence time stage duration and the fraction departing maturing is true for a simple markovian departure process e g gallager 1995 however for the population process different number of individuals are entering into the stage as a population may be growing or declining and individuals can also die before maturing consequently this particular relationship between the mean duration and fraction maturing is correct under asymptotic conditions only if σ i λ 1 1 we will refer to this as the flat age within stage structure fas model a rather different approach to estimating γ i does not explicitly attempt to match the mean stage duration but instead merely estimates γ i as the observed fraction of surviving individuals in the stage that mature to the next stage this requires repeated observations of marked individuals capture histories and might make use of tools such as multistate capture mark recapture models e g fujiwara and caswell 2001 as long as the modeled age within stage distribution remains the same as it was in the population during the observation period then the model will get the mean stage duration correct however the estimated γ i may be biased if the age within stage distribution changes unless the estimation process accounts for the age within stage of individuals in particular if γ i is estimated by calculating the fraction of individuals in stage i that were observed to mature in a given year the resulting model will accurately estimate λ 1 only if the observed population happened to be at the stable age structure we will refer to this as the observed age within stage structure oas model among the aas sas and fas models only the aas model will replicate λ 1 and its sensitivities from the fully age structured model of course a final approach if the stage durations really are fixed is to unroll the stage replacing the single stage class with t i age classes with identical survival coefficients or if the assumption of homogeneous survival within the stage was an approximation with actual age specific survival coefficients after analysis the age classes can be collapsed back to their stage to generate a stage structure or sensitivity analyses that are stage specific rather than age specific 3 prevalence of construction errors in published mpms 3 1 methods to evaluate the prevalence of these errors in published mpms we examined a sample of the studies contained in the comadre animal matrix model database salguero gómez et al 2016 using version 2 01 of the database we subset the data to studies of nonhuman animals that had a doi as a simple filter to eliminate non peer reviewed studies this left 65 studies published prior to the year 2000 and roughly twice that number published from 2000 to 2018 we retained all of the 20th century studies and took a random sample of 60 of the 21st century studies although many studies publish multiple models representing different sites or species we take the study as the unit of observation as a similar approach was usually taken in all the models within a publication some of the studies did not actually contain mpms the models in the comadre database were constructed by the comadre digitization team based on information in the cited paper we eliminated these using a haphazard subset of studies we developed a protocol to systematically assess each study appendix b this protocol was applied by 4 of the authors after initial training consistency was ensured by having all assessors independently apply the protocol to the same set of papers until all were getting consistent results if a question didn t apply e g if it was not a stage structure model the answer was coded na if the answer could not be determined from the information in the publication it was coded as unknown we coded a model as a postbreeding census if the first age or stage class appeared to be newborn e g eggs neonates or a small fraction of a timestep old e g hatchlings larvae fledglings we coded a model as a prebreeding census if the first age or stage class appeared to be one timestep old e g yearlings juveniles 1 year olds while a number of other breeding models are possible in practice nearly all models fell into one of these categories we examined the mpm to determine whether the fertility coefficients contained survival terms and if so whether they were appropriate to the model type if the appropriate survival term was not present we coded the model as incorrect to identify the first reproductive stage or age class we examined quantitative e g life table or qualitative e g text description of the life history information about the species as presented in the study for postbreeding census models we then asked whether the individuals maturing into that reproductive class had a nonzero fertility coefficient models lacking this fertility coefficient were coded as incorrect for stage structured models in which there was a target mean stage duration we examined textual model descriptions and symbolic representations of the model to determine whether it was constructed using the aas sas fas or oas formulations or whether the stages were unrolled into a leslie matrix formulation with the implicit age within stage being made explicit we examined the frequency of all formulations and coded aas and unrolled models as correct from the perspective of calculating the asymptotic growth rate λ 1 for each of the three classes of errors we calculated the overall percentage of relevant studies i e studies that had a structure potentially subject to the error and for which we could clearly determine how the model was constructed that made that error we also used logistic regression of error classification against publication year to examine whether these errors had become more or less frequent over time 3 2 results the comadre animal matrix database advertises itself as a repository of peer reviewed published mpms salguero gómez et al 2016 fine print in the user s guide anonymous 2017 reveals that in some cases the matrix does not actually appear in the cited paper but was provided to the database as a personal communication however in the course of assessing articles from the database we found many examples where the original publication did not construct an mpm at all instead it appears that the database collators constructed mpms from published demographic data such as life tables since our goal was to assess the model construction accuracy of authors not the database maintainers we excluded these studies from our analysis this removed 58 studies leaving 67 for us to analyze we were able to unambiguously identify the components of the fecundity term in 30 studies 53 of these studies failed to include an appropriate survival component in the fertility coefficients 100 of these errors were in postbreeding census models the frequency of these errors had no detectable trend over time p 0 198 fig 3 a the potential for missing the reproductive event associated with first reaching reproductive age is only a feature of postbreeding census models of the 24 studies in which we could unambiguously determine both the last pre reproductive stage or age class and in which we could identify fertility coefficients 67 made this error the frequency of these errors had no detectable trend over time p 0 755 fig 3b in our random sample only 19 studies included models having at least one stage class that was meant to last for multiple timesteps to obtain a reasonable sample size we augmented this with the haphazard sample we had used to develop the evaluation protocol which focused on stage structured models published since 2010 this led to 14 in which we were able to unambiguously classify the rule defining the maturation rate out of the stage s however the date range was too narrow to evaluate trends through time of these 64 did not use a rule that would generate a value of λ 1 that would match an age structured model with the target mean stage duration fig 4 4 consequences of incorrect mpm construction we evaluate the impacts of these errors in mpm construction by examining several endpoints that many analyses focus on the asymptotic population growth rate λ 1 sensitivity analysis of λ 1 to changes in underlying vital rates and life history statistics such as generation time we approach this evaluation through theoretical analysis where feasible and informative and by examining two case studies a lionfish pterois sp model with very high population growth morris et al 2011 and a pair of american alligator alligator mississippiensis models that project rapidly declining and nearly constant population dynamics dunham et al 2014 these studies made all three of the errors described above we singled them out not because they are particularly egregious many other studies make these errors but because the authors did an exceptional job of describing the species life history allowing us to infer the model they meant to construct we first focus on the effects on λ 1 and then evaluate the effects on other endpoints a matrix population model for lionfish was constructed by morris et al 2011 to investigate the potential approaches for controlling this invasive species the modeled life history consisted of three stages larvae juvenile and adult and time step of the model was one month the original model was a postbreeding census model but it did not include the survival of adults in the fertility rate the average duration of the juvenile stage was assumed to be 12 months in the model and the fertility coefficient for juveniles was set to zero this meant that the modeled lionfish take 14 months to reach first reproduction one month in larval stage 12 months in juvenile stage and one additional month in fertility rate in contrast to the target reproductive age of 12 months the authors used the fas model for calculating the transition rates for juveniles the full model is described as model l1 in appendix a for the american alligator populations dunham et al 2014 developed two stage structured matrix population models to compare the status of northern and southern populations which differed in stage durations and birth rates the original models consisted of five stages eggs larvae juvenile subadults and adults and the time step of the model was one year similarly to the lionfish model the alligator models were postbreeding census models but the authors did not include the survival of adults in the fertility rate the first stage was egg stage but it only lasted for three months therefore there was clear inconsistency in the time steps among stages dunham et al 2014 used the sas model to calculate transition rates for juvenile and subadult stages the full models are described as models an1 and as1 in appendix a in order to investigate the effects of the errors on λ 1 with the lionfish and american alligator matrices we constructed stage structured population matrices that corrected the three types of errors models l5 an3 and as3 in appendix a then we systematically inserted the errors back to the model and developed the total of nine models for comparison these models vary in maturation models aas sas fas and the presence or absence of reproduction by maturing juveniles with adult survival in the fertility coefficient when the reproduction by maturing juveniles was absent we also allowed adult survival in the fertility coefficient to be absent 4 1 failure to include survival terms in the fertility coefficients failing to include survival terms in the fertility coefficients will make those coefficients too large since survival is less than one this will lead to an overestimate of λ 1 this error most often occurs in postbreeding census models and will be approximately e surv λ 1 x 1 σ x f x s f x where s f x is the sensitivity of λ 1 to the fertility coefficient f x thus if the survival terms are close to one as they often are for adults and the sensitivity of the asymptotic growth rate to survival is small as it often is then this error should generally be fairly small the fertility coefficients in both lionfish and alligator models in the original papers omitted the survival of adults the effects of these errors can be observed by comparing open with survival and filled without survival circles in fig 5 when the survival rate was missing in the fertility coefficient asymptotic population growth rate was always overestimated for both lionfish and alligator populations the survival rate over the time step of a model was high 0 95 per month for lionfish and 0 83 per year for alligator therefore the effects were relatively minor however when we deal with organisms with low adult survival rate or when the time step is extended e g the time step is changed to 1 year in the lionfish model a fertility coefficient could be substantially inflated without adult survival rate being included causing biases in demographic statistics the effect was slightly higher for the southern population of american alligator than the northern population this resulted from a larger fecundity associated with the southern population 5 98 individuals per year compared with the northern population 2 37 individuals per year suggesting the error may be magnified for organisms with high fecundity 4 2 failure to allow individuals to reproduce when they first reach reproductive age the failure to allow individuals to reproduce when they first reach reproductive age will have two consequences r 0 the net reproductive rate will be reduced slightly and the mean generation time t g will be increased by a timestep both effects contribute to an underestimate of λ 1 the error is approximately e mature λ 1 r 0 1 t g σ a r 0 1 t g 1 where σ a is the one timestep survival of the newly matured class this doesn t simplify easily but it is clearly largest when the generation time is short or r 0 is large the original lionfish and alligator models did not include a fertility coefficient associated with individuals transitioning into an adult stage in all cases the missing fertility coefficient caused an underestimation of the asymptotic population growth rate the effects of the missing fertility coefficient depend on the life history strategy of the organisms for example the effects were greater for the southern alligator population than northern alligator population compare open circles and squares in fig 5 because the southern population had a shorter duration from egg to adult stages resulting in smaller generation time and higher birth rate resulting in higher r 0 than the northern population both of these would cause the reproduction in the first year to be smaller reducing the effects of the missing fertility coefficient to be small the effects of the missing fertility coefficient is expected to be large for species for which the contribution of offspring from individuals reproducing the first time is large 4 3 failure to use aas model for transition rate calculation if the stage durations are fixed such that a leslie matrix model with all age classes within the stage having the same survival is the best model then only the aas stage structured model will give the approximately correct λ 1 in general the sas model will be correct only if λ 1 1 if λ 1 1 then the maturation fraction will be too large and λ 1 will be overestimated the opposite will be true if λ 1 1 thus the sas model will bias λ 1 away from one the bias from fas model is similar except that the critical value for λ 1 is σ i thus if there is more than one multi timestep stage with different values of σ i and λ 1 is intermediate between these values then the direction of bias introduced by the fas model is unpredictable the impact of using the observed transition rates is likely to be highly variable depending on the nature of the deviations between the age structure when the population was observed and the asymptotic age structure the use of different maturation models table 2 has substantial effects on λ 1 fig 5 in particular the asymptotic population growth rate was substantially overestimated under the fas models compared with the aas models on the other hand sas models overestimated λ 1 when λ 1 1 lionfish and southern population of american alligator compared with aas models but it underestimated when λ 1 1 northern population of american alligator in general the sas model magnifies the deviation in asymptotic population growth rate from 1 as predicted by the theory above 4 4 effects of errors on sensitivity and elasticity analysis a common goal of constructing a matrix population model is to examine the sensitivity or elasticity of λ 1 to underlying demographic parameters often in the service of informing population management or understanding life history evolution predicting the effects of mpm construction errors on these quantities requires information about the second derivative of λ 1 with respect to model parameters caswell 1996 the theory of which seems to only have been developed for lefkovitch models in a lefkovitch model the second derivative of λ 1 with respect to diagonal matrix elements is positive and with respect to off diagonal elements seems to be generally negative mccarthy et al 2008 this suggests that overestimates of the maturation rate should reduce the sensitivity of λ 1 to both stasis and growth terms thus reducing the overall sensitivity of λ 1 to survival in addition failing to include survival terms in the fertility coefficients will necessarily lead to underestimates of the sensitivity and elasticity of λ 1 to survival to look at the specific effects on elasticities to particular parameters we calculated the elasticities of λ 1 to stage specific survival across the same suite of error combinations as we did for λ 1 for the lionfish population the choice of maturation model had a substantial impact on the elasticity of λ 1 to juvenile survival and the rank order of elasticities to juvenile and adult survival was reversed by the fas model fig 6 a the impacts of errors in the fertility coefficients had a very modest impact on elasticities fig 6b in contrast the elasticities of λ 1 to stage specific survival in the alligator populations were nearly unaffected by any of the matrix construction errors results not shown 4 5 effects of errors on other endpoints as described above the three common errors in constructing matrix population models can affect the population growth rate however calculating other endpoints such as stable stage distribution reproductive value sensitivity elasticity generation time and damping ratio are often the primary goal of constructing an mpm especially for management applications or studies of life history theory here we investigate the effects of the errors on these endpoints using matrices for the lionfish and two populations of american alligators we started with the original matrices as baseline models and constructed models that fixed various subsets of the focal errors to see how these errors affect the model projections and conclusions for the lionfish population we developed four stage structured population models that gradually correct for some or all of the problems and three age structured matrices of which two include the original errors associated with the fertility coefficients appendix a for the american alligator populations we developed two additional stage structured models that correct some or all of the problems and three age structured matrices of which two include the original errors associated with the fertility coefficients for each population all of these models were used to calculate λ 1 stable stage distribution reproductive value sensitivity and elasticity of λ 1 to stage specific survival rate and fecundity damping ratio and generation time the full results are shown in appendix a here we highlight some of the key outcomes the effects of failure to include survival terms in the fertility coefficients can be observed by comparing the age structured matrices with and without the correction the first set of age structured matrices l6 an4 as4 included corrected fertility coefficients with corresponding survival rates multiplied to the original fertility when the survival rate was missing in the fertility coefficient then the adult proportion of the stable stage distribution was underestimated figs a 2 and a 9 and the adult reproductive value was overestimated figs a 8 and a 16 these effects resulted from the fact the models mistakenly assumed more offspring were born inflating the number of younger individuals the effects of the missing fertility coefficient can be found by comparing models l2 and l3 stage structured lionfish models l7 and l8 age structured lionfish models an5 and an6 age structured alligator models for northern population and as5 and as6 age structured alligator models for southern population in all cases the missing fertility coefficient caused an overestimation of the adult proportion of the stable stage distribution figs a 2 and a 9 and an underestimation of adult reproductive value figs a 3 and a 10 the effects of using different maturation models can be observed by comparing the fas l3 sas l4 aas l5 and age structured l8 models for lionfish populations although the stable stage distributions of adults under the four models appear similar fig a 2 the juvenile proportion in the stable stage distributions were underestimated with the fas and sas models compared with the age structured models fig a 2 the reproductive value of adults were substantially underestimated with the fas and sas models compared with the aas or age structured models there are a variety of ways to define generation time in demographic studies coale 1972 in this study we used the mean age of mothers to represent the generation time applying formulas developed by bienvenu and legendre 2015 which is a function of elasticity and fertility coefficients therefore any bias associated with these two quantities affects the estimated generation time figs a 7 and a 16 we found substantial and variable impacts of mpm construction errors on the estimated generation time in addition the estimated generation time tends to be biased with stage structured models fujiwara and diaz lopez 2017 these results suggest that the calculation of generation time needs to be done carefully the damping ratio is given by λ 1 λ 2 where λ 1 is the eigenvalue of the largest magnitude and λ 2 is that of the second largest and it measures how quickly transient dynamics dissipate over time if λ 2 were not affected by the errors in constructing population matrices then the damping ratio and the asymptotic population growth rate should correlate with each other the fact they deviate from each other cf figs a 1 and a 5 figs a 8 and a 15 suggests the estimation of λ 2 is also affected by the errors in constructing population matrices 5 discussion we have described and analyzed three errors that are sometimes made when constructing animal matrix population models these errors involving the fertility coefficients and the maturation rates cause the mpm to misrepresent the intended life history of the species based on our analysis of the comadre animal matrix model database salguero gómez et al 2016 we find that these errors are quite common 60 of the published models that we evaluated have incorrect fertility coefficients missing survival component failure to reproduce upon maturation or both furthermore there is no evidence that these errors in the fertility coefficient are becoming less frequent through time fig 3 among the admittedly small sample of stage structured models fully half calculated the maturation rate in a way that would result in incorrect estimates of the asymptotic population growth rate these errors affect the value of quantities commonly calculated from mpms such as asymptotic growth rate and stage structure elasticity analysis generation time and characteristics of transient dynamics we can make a few generalizations about these effects first the two types of errors in the fertility coefficients have opposite effects on estimates of λ 1 the asymptotic population growth rate second incorrect specification of the maturation rate tends to have a larger impact on these statistics than do the other errors third when the age at maturation is fixed so that a leslie model is the most appropriate representation even a stage structured model that correctly matches the mean time to maturity gives incorrect transient dynamics and generation time finally most but not all of these errors are larger if λ 1 is far from one nevertheless the case studies we analyzed suggest that many analyses conducted with flawed mpms may have broad validity for example in none of the case studies did the errors introduce misclassifications of population decline versus increase furthermore errors in λ 1 are generally modest except when an inappropriate maturation model is used fig 5 finally the rank orders in stage specific values in the stable stage and reproductive value distributions were unaffected by the matrix construction errors however we have only a limited sample of case studies and for some outcomes even this small sample gives inconsistent results for the direction or magnitude of biases introduced by the mpm construction errors for example the rank order of the elasticities of lambda to the vital rates might alligator or might not lionfish be robust to model errors while a more complete understanding of these biases might be derived by analyzing more models spanning a range of life histories ecological understanding and management decisions would be better served by constructing the models correctly in the first place why do these errors occur the failure to include a survival component in the fertility coefficient is most surprising as all textbooks make clear statements about the need for this we suspect that the causes are threefold first different texts use different words to describe the birth rate b x e g the maternity function and the fertility coefficient f x for the latter fertility fecundity and reproduction are used to represent f x in different texts and the terms have different scientific meanings in human demography and various fields of animal ecology in particular many animal ecologists use the term fertility to refer to the potential to have offspring and so associate it with b x rather than f x in contrast demographers refer to this as fecundity the use of a linguistically vague common language word to refer to a precisely defined model element creates the condition for nonmodellers to redefine the model element to match their understanding of the word even when the textbook says otherwise second the visual similarity between the conceptual life cycle graph figs 1a 2 a and the life cycle graph that actually corresponds to the matrix may make it easy to forget to take the extra step of correctly formulating the fertility arrows finally many nonmodellers seem to struggle to grasp the importance of having every transition in the mpm represent the same timestep this may be a threshold concept i e an idea that is essential to mastery of a field but that is troublesome to students because it appears to violate common sense intuition cousin 2006 meyer and land 2006 although students find it more to be unnecessary rather than counter intuitive the need to include reproduction when an individual first matures which is solely found in postbreeding census models seems to be a clear example of a threshold concept here the challenge is the intuition that no juveniles should have positive fertility coefficients the challenge is probably exacerbated by the fact that most textbooks devote the most thorough explanation of mpm construction to age structured models where the confusing nature of postbreeding census models can be hidden by labeling an individual s age class as its age at its next birthday however when these textbooks move to a usually much briefer description of stage structured models where this solution does not work they generally switch notation without comment a notable exception is mills 2007 2013 who calls newborns n zero for all models and provides a very clear graphical depiction of both age structured and stage structured models the poor choice of maturation model is probably most easily understood most textbooks do not treat this issue and those that do e g caswell 2001 ebert 1998 tend to be more mathematical than many nonmodellers may be comfortable with furthermore they do not include clear guidance on which approach is most suitable for a given modeling objective how can the prevalence of these errors in mpm construction be reduced in the future the standard recommendation from experts including both reviewers of this paper is that biologists should think carefully about what happens to individuals over the course of a timestep think carefully about how the data relate to these events and assemble everything in such a way that each transition spans a timestep in essence this advice boils down to think like a modeler in our experience non modelers require a lot of interactive tutorial examples to really learn this process current textbooks do not provide this the best published examples we have seen are in articles describing modeling approaches for migratory species e g fig 28 2 of runge and marra 2005 it is impossible to know how many instructors provide effective classroom teaching on this topic but our analysis of the comadre database indicates that a substantial number of biologists have not adequately internalized this message clearly there is a role for improved training materials see below in the meantime is there anything that biologists seeking to construct an mpm for their species can do to increase the odds of constructing it correctly our analyses suggest two purely mechanical approaches that might substantially reduce error rates first we note that none of the prebreeding census mpms that we examined had errors in the fertility coefficients while we cannot assign causality to this outcome based simply on the data prebreeding models simply do not require dealing with the troublesome reproductive transition by maturing juveniles and it may be that the fact that newborn survival is left over after constructing the survival transitions encourages a closer look at the fertility coefficient it is also important to recognize that if one has information on age or stage specific birth rates and annual survival then that information can be used to create either a prebreeding or a postbreeding census model e g compare figs 1b and 1 d noticing that the same parameters occur in both in particular unless there is large age dependent variation in mortality through the breeding season it doesn t matter whether the survival is measured from the end of one breeding season to the end of the next or from the beginning of one breeding season to the beginning of the next the key is that the survival be measured over a full timestep e g year furthermore the prebreeding and postbreeding censuses are different views into the same model in particular the estimate of λ 1 and the elasticities of λ 1 to underlying demographic parameters will be identical between the two representations thus we recommend that even if the ultimate goal is a postbreeding census model the model be constructed using the prebreeding framework this reduces the likelihood of missing a survival term in the fecundity coefficient as the newborn survival has to be put somewhere and eliminates the non intuitive fertility coefficients associated with transitions into reproductive classes if a postbreeding census model is desired e g so that model output can be compared with census data that includes newborns then the prebreeding census model can be used to check the accuracy of the independently created postbreeding census model e g λ 1 should be identical for the two matrices in addition for the simple sorts of models represented by figs 1 and 2 e g without clonal reproduction or multiple genders the conversion of a matrix from a prebreeding representation to a postbreeding representation is a purely mechanical process that can be automated in software the pre to post function in the mpmtools r package kendall 2019 provides an example of this second we found that most models in which a conceptually age structured population had been collapsed into a small number of stages each with a well defined mean stage duration were constructed in ways that would fail to reproduce the asymptotic growth rate indeed in our case studies this error had the largest impact on λ 1 estimates we interpret this as being because the best stage based approximation the aas model is both conceptually and computationally challenging to produce for simple life histories we recommend using the mpmtools r package kendall 2019 to automatically construct an aas model from information on stage specific demography and duration more generally if the among individual stage variation is not too great i e all individuals mature at about the same age then we recommend that the stage be unrolled into a leslie matrix model this creates a model that makes correct projections under both transient and asymptotic conditions and can be used both for projecting the population and for calculating life history statistics this also allows the demographic rates to vary with age within a stage e g for species such as fish with size dependent demography avoiding further pitfalls highlighted by fujiwara and diaz lopez 2017 we recognize that in long lived species the results of sensitivity and elasticity analyses are often more useful when aggregated by stage fujiwara and diaz lopez 2017 we recommend performing this aggregation after analyzing the age structured model e g by summing the elasticities associated with all the age classes within a stage another reason for preferring age structured to stage structured models when appropriate is for the accurate calculation of generation time stage structured models in general are not particularly suitable for estimating generation time fujiwara and diaz lopez 2017 lebreton 2005 this is because stage structured modes lump individuals in multiple age classes into a single stage treating them equally this is a reasonable simplification if we are only calculating asymptotic population growth rate and stable stage distribution however all individuals regardless of duration of time spent in a stage are treated equally to have the same rate of transitioning to another stage this has a large effect on generation time estimation therefore it is strongly recommended that generation time calculation should be based on an age structured model unless stage transitions are truly age independent when the stage durations are not fixed a more advanced solution is to develop a model that incorporates both age and stage caswell et al 2018 lebreton 2005 in this case an accurate characterization of the distribution of stage durations can be critical for many analytic outcomes as described by de valpine et al 2014 for continuous time models however estimating the parameters of such distributions can be challenging see e g the derivation of parameters for time to next breeding in sea turtles by ebert 1998 experts can also help by developing handbooks and training materials that are both comprehensive and clear to non modelers who are experts in biology and ecology but novices at modeling the comprehensiveness requires in part a thorough treatment of stage structured models which are not described as completely as age structured models in many texts as well as a comprehensive discussion of the consequences of various choices of when the census should occur in the model the clarity certainly requires consistent notation and terminology as well as attention to the knowledge level of the audience but that will probably not be sufficient educational research suggests that when students arrive with misconceptions clear and accessible expositions of correct principles do not lead to learning as the students do not pay sufficient attention to recognize the difference between the exposition and their prior belief better learning occurs when they are first presented with the misconception and then led to an understanding of why it is wrong muller et al 2008a b the biologically based intuitions that underlay incorrect formulations of mpms may have the strength of scientific misconceptions in which case the training material will need to actively uproot them before a better understanding of the model requirements can be learned one pedagogical approach that may be helpful is to build seasonal sub models and use matrix multiplication to generate the integration over the full timestep rather than requiring the integration to be done in the brain of the model builder williams et al 2002 do this for age structured models only section 8 4 2 creating survivorship and reproduction matrices and showing how they can be combined to produce both prebreeding and postbreeding census models periodic matrix models are generally presented as advanced topics the notation in caswell s 2001 treatment of the topic is intimidating to non modelers and are typically applied to either annual species or species that breed continuously at seasonally varying rates throughout the year nevertheless a more accessible presentation of periodic matrix models showing how they can be used to integrate demographic processes that happen at different points in the annual cycle might help alleviate many of the problems identified here such an approach to mpm construction might also encourage the development of models that more fully incorporate the richness of within year life history processes experts must also address the fact that many creators of animal mpms are not comfortable with even the simple programming required to calculate quantities like the aas maturation coefficient while there are tools for easing the analysis an mpm once the matrix has been constructed e g stubben and milligan 2007 little is available to help non programmers construct complex mpms a set of such tools in a software environment with which many ecologists are familiar such as r would be helpful especially in connection with a tutorial we have focused here on three particularly common errors in mpm construction however other problematic errors may occur for example nearly all animal mpms are presented as birth pulse models but in some cases reproduction is continuous over all or a significant fraction of the model timestep the lionfish model analyzed here illustrates this lionfish are described as laying a batch of eggs every 3 days but by building a birth pulse model with a one month timestep morris et al 2011 fail to account for the fact that the total monthly egg production is reduced by parental mortality during the timestep or by the fact that age classes comprise a range of ages both of these issues are addressed by formulas for birth flow models but such models are vanishingly rare in ecological applications another challenge arises when demography is heterogeneous within a stage class as when individuals grow continuously through life and survival and birth rates are size dependent fujiwara and diaz lopez 2017 have studied this and provide new recommendations for how best to calculate average demographic rates within a heterogeneous stage class while our analysis has focused on animal mpms we note that plant mpms may be subject to similar errors as those described here in addition the construction of size structured mpms faces challenges that are qualitatively similar to those for stage structured mpms while differing in detail and ambiguities around the treatment of seeds and seed banks create the potential for additional errors in the fertility coefficient thus a systematic analysis of published plant mpms may be warranted in conclusion we have found that errors in constructing animal population models are widespread that these errors can have substantial quantitative e g mis estimation of the asymptotic growth rate λ 1 and qualitative e g mis ranking the elasticity of λ 1 to various vital rates consequences for the conclusions reached by the mpm analysis this is bad news and shows that we cannot count on peer review to ensure correct model construction while some analysis endpoints seem to be broadly robust to matrix construction errors especially errors in the fertility coefficient there may be some cases in which the scientific conclusions or management recommendations supported by those models could be flawed furthermore comparative studies that use the comadre database to obtain a representative sample of animal demography e g paniw et al 2018 will be subject to extra noise that may bias parameter estimates unless erroneous models are corrected or excluded from the analysis fortunately publications often contain enough life history information to allow the model to be revised to more closely match the species biology allowing the conclusions of particular studies to be updated and comprehensive databases to be improved acknowledgments this work was supported by a ucsb faculty senate grant to bek the analysis of the comadre database was supported by the max planck institute for demographic research we thank rob salguero gómez for feedback on the model evaluation protocol and manuscript and gordon fox dmitrii logofet and two anonymous reviewers for comments on the manuscript appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 03 011 appendix b supplementary data the following are the supplementary data to this article 
25027,matrix population models mpms are powerful tools for translating demographic and life history information into a form that can be used to address a wide range of research topics such as projecting population dynamics evaluating stressor impacts on populations and studying life history evolution however the reliability of such studies depends on the mpm being constructed in a way that accurately reflects the species life history we highlight three errors commonly encountered in published mpms 1 failing to include survival in the fertility coefficient 2 introducing a one year delay in age at first reproduction and 3 incorrectly calculating the growth rate out of a stage class we review the sources of such errors and provide new analyses revealing the impact of such errors on model predictions using lionfish and american alligator models as examples to quantify the prevalence of such errors we examined and scored the original publications underlying the models in the comadre animal matrix database the first two errors were found in 34 and 62 respectively of the published studies nearly all were in models that used a postbreeding census representation of the life cycle in which newborns eggs neonates fledglings etc are explicitly included of the studies where stages may last longer than one time step 53 constructed the growth rate using inappropriate formulas for estimating the asymptotic population growth rate or its sensitivity to demographic parameters these results suggest that further efforts may be required to educate biologists on the construction of mpms perhaps in concert with the development of new software tools furthermore the conclusions of many studies that are based on mpms may need to be re examined and synthetic studies using the comadre database need to be accompanied by careful examination of the underlying studies keywords comadre animal matrix database lefkovitch matrix leslie matrix matrix population models model construction model validity 1 introduction the use of matrix population models mpms for the ecological study of plants and animals has expanded rapidly in recent years salguero gómez et al 2016 2015 mpms are a convenient way to synthesize demographic information about a population and are useful in addressing ecological evolutionary and management questions caswell 2001 morris and doak 2002 most early mpms were developed by collaborations between biologists with expertise on the species at hand and modelers with deep understanding of the subtleties of modeling mpms now having been long promoted as a straightforward translation of life history information into quantitative analysis are often being created by biologists who are primarily empirical ecologists or conservation biologists and may have had little training in modeling beyond a graduate course in population ecology one might then ask do these mpms reliably reproduce the life histories they are meant to represent it is important to remember that mpms are approximations both because they still abstract away much biological detail and because demographic measurements are imprecise there are a variety of subtleties in constructing such models especially when breeding is spread across a substantial fraction of the year or when there is substantial heterogeneity among individuals within an age or stage class much theoretical work has gone into making mpms more complex to account for this and we are starting to better understand the effects of these phenomena on simple models e g fujiwara and diaz lopez 2017 salguero gómez and plotkin 2010 but even setting aside these issues we might hope that if we assume that a simple life history description e g as embodied in a life table or set of stage based life history parameters is a useful description of the population then the constructed mpm should accurately reproduce that description if it does not then we are introducing additional errors into the analysis above and beyond the inherent approximations of modeling one of us kendall has spent two decades teaching mpms to applied masters students this experience has revealed several aspects of mpm construction that are particularly challenging to modelling novices and thus might be similarly challenging to biologists who do not regularly create mathematical models of their system at one level the errors made by these novices are simply accounting issues but some students exhibit a strong attachment to the incorrect formulations we suspect that this difficulty for both students and researchers is partly rooted in the contrast between the often loose way that terms are used to describe biological populations and the very precise meanings of terms in mpms together with some genuine linguistic ambiguity that plagues the field however some of these issues may be instances of what education scholars call a threshold concept an understanding that is essential to mastery of a field but that is troublesome to students because it appears to violate common sense intuition cousin 2006 meyer and land 2006 we have not infrequently encountered published mpms that embody many the same mistakes made by kendall s students our goal in this paper is to highlight these challenges which are described in the next section document their prevalence in the peer reviewed literature and quantify their impacts on the outputs of mpms we conclude with a discussion of why these mpm construction errors are so prevalent and how we might improve future practice 2 challenges in mpm construction we focus on animal population models in which the demography is structured by age leslie matrices leslie 1945 or developmental stage lefkovitch matrices lefkovitch 1965 plant and size structured models present additional challenges which would further complicate our presentation we also focus on species whose reproduction is concentrated in a short breeding season so called birth pulse populations caughley 1967 many animal species satisfy this assumption and this allows us to avoid the extra complications associated with using discrete time models to represent a continuously breeding species note that by breeding season we mean the season in which individuals are born or hatched not the season during which their parents mate age starts counting from birth so that a reproductively mature individual breeds on or about their birthday e g if the age at first reproduction is 5 years then an individual has its first offspring on its fifth birthday mpms project the population from one nominal census date to the next while the census could in principle be at any time in practice many mpms either census the population just before breeding prebreeding census or just after breeding postbreeding census in a prebreeding census the youngest age class is made up of individuals all with age nearly one which we designate as age one in a postbreeding census the first age class would comprise newborn individuals all of age zero the second class would comprise individuals of age exactly one etc we refer to newborn individuals with a subscript of zero as a result our postbreeding leslie models will look different from most textbooks which assign newborns to age class one and use a subscript of one 2 1 ensuring that the fertility coefficient spans a full timestep in a table of demographic parameters e g table 1 age specific survival and birth rates look as if they should make equivalent contributions to a population model but there is an important difference survival which we denote σ x for leslie models and σ i for lefkovitch models where x is the age and i is the stage represents the fraction of individuals in a class x or i that survive for a full timestep from time t to time t 1 in contrast the birth rate which we denote b x for age structured demography and b i for stage structured demography is an almost instantaneous event it is the average number of offspring produced at time t by an individual that is alive at time t it is tempting to draw a life cycle graph like the one in fig 1 a commonly seen in the literature while this works as a conceptual diagram translating it directly into an mpm by converting each arrow in the graph into a matrix element is incorrect each element in the matrix must span a timestep and b x does not accomplish that to get the timestep into the fertility coefficient b x needs to be multiplied by a survival term either that of the parent or of the offspring failing to include survival term will inflate the fertility coefficients for a prebreeding census model the fertility coefficient is f x b x σ 0 the parent in class x produces b x offspring immediately after the census and then these offspring survive to the end of the timestep at rate σ 0 at which point they are age 1 fig 1b for an annual timestep f x represents the number of one year olds next year produced by an individual of age x this year in a postbreeding census the parent which will have just reproduced if it is already an adult must survive for a timestep aging by a timestep and possibly maturing into a new class and then reproduces with a birth rate appropriate to its class at the end of the timestep if we use x to denote the parent s class at time t 1 then the fertility coefficient is f x σ x b x fig 1d for an annual timestep f x is the number of zero year olds newborns produced next year by an individual that was in class x this year properly accounting for x is a separate challenge that we address in the next subsection 2 2 matching the age at first reproduction to the species life history in an age structured population the lowest age with a non zero birth rate represents the age at first reproduction we will call that age x m for age at reproductive maturity in a prebreeding census model fig 1b this does not present a conceptual challenge as the newly matured about to reproduce for the first time individuals are already classified as age x m matching intuition however in a postbreeding census model the individuals who are age x m at the end of the timestep and have just reproduced for the first time were age x m 1 at the beginning of the timestep a model that has the first non zero fertility coefficient associated with age x m instead of x m 1 fig 1c results in the modeled age at first reproduction being x m 1 a year delay relative to the actual life history the solution is to add a fertility coefficient linking age class x m 1 to age class zero the lower of the two fertility arrows in fig 1d embracing this fertility coefficient requires overcoming cognitive dissonance juveniles are reproducing and we have found that students and perhaps other nonmodellers actively resist this an alternative approach for postbreeding census leslie models is to change the indexing scheme associating x with the individual s age at the end of the timestep rather than the age at the beginning of the timestep as we have done above then the individuals who will mature and reproduce before the next census are called age x m and their fertility is f x m σ ˆ x m b x m we use σ ˆ for survival to clarify that it is a differently indexed parameter from σ as used above thus the cognitive dissonance is finessed by hiding the fact that these individuals started the timestep as juveniles indeed many textbooks use this indexing convention for age structured models however this alternative indexing convention cannot be maintained when moving from age structured to stage structured models as not all individuals that start the timestep as juveniles will end it as adults so let us look at stage structured models the simplest stage structured model has newborns a nonreproductive juvenile class that spans multiple timesteps and reproductive adults fig 2 within the juvenile class some individuals remain juveniles in the next timestep should they survive juvenile juvenile transition whereas others mature into adults juvenile adult transition if γ j is the fraction of surviving individuals that mature grow at the end of the timestep then the juvenile juvenile transition is given by p j σ j 1 γ j and the juvenile adult transition is given by g j σ j γ j we will treat the estimation of γ j in the next section as in age structured models the fertility coefficient needs to include a survival term so fig 2a is incorrect in a prebreeding census model the adult birth rate must be multiplied by newborn survival and newborns removed from the stage vector fig 2b whereas in a postbreeding census model the birth rate must be multiplied by the parent s survival figs 2c d if the criterion for being classed as adult is that the individual can reproduce then just matured adults should have non zero fertility in the prebreeding census model fig 2b the individuals that have just matured made the transition from juvenile to adult will reproduce at the beginning of the next timestep however in the intuitive postbreeding census model fig 2c the individuals that just matured won t reproduce until the end of the next timestep a full timestep after their transition to adulthood in reality the individuals that just made the juvenile adult transition were already adults at the just passed breeding season and hence have had their first opportunity to reproduce to represent this we need a fertility coefficient leading out of the juvenile class f j g j b a fig 2d which again seems to defy common sense this is particularly well illustrated in fig 6 3 of mills 2013 fig 7 3 in the 2007 first edition although this is the textbook solution there are a number of other ways one might finesse this issue such as classifying individuals as adults at the beginning of the timestep in which they mature or creating a special pre adult class between juveniles and adults however these methods introduce additional complications such as giving the maturing juveniles adult survival rather than juvenile survival which might or might not be desirable or shortening the juvenile stage duration to account for the extra stage 2 3 ensuring that the mean time in each developmental stage matches the species life history the final challenge is associated with estimating γ i the fraction of individuals growing e g maturing out of stage i in many cases the goal is to combine information on stage specific survival often variously collected with knowledge about the stage duration the number of timesteps that individuals remain in a stage before maturing if stage durations are fixed e g all individuals mature after two years as juveniles as in table 1 then the goal is to create a stage from age model e g ebert 1998 ch 8 where the mean stage duration in the model equals the fixed stage duration in the life history if the real stage durations are variable then the goal is to create a model where the mean stage duration in the model equals the mean stage duration in the life history in principle the model should also match the variance in stage duration but this seems never to be done in practice caswell 2001 has a section of his book describing various ways of doing calculating γ i to attain a specified stage duration t i depending on the species life history the stage duration might be fixed all individuals mature after exactly t i time steps in the stage or variable there is a distribution of times to complete the stage in which case the mean stage duration needs to be calculated this is not entirely straightforward a topic we do not take up here when the life history contains fixed stage durations there is no single best approach as the stage structured model will never match the age structured model completely nevertheless the primary analyses performed on most published mpms are to calculate the asymptotic growth rate λ 1 and the sensitivity of λ 1 to underlying demographic parameters for these calculations there is one and only one recipe to create a stage structured model that will for any life history generate the same results at least to a very close approximation we have not found theory on this as the equivalent age structured model with t i age classes having the demography of stage i as best we can tell it was first introduced by caswell 1989 although its first application to an ecological population may have been by crowder et al 1994 the basic idea is that γ i represents the fraction of individuals in the stage that have spent enough time in the stage to mature this in turn depends on the implicit age structure within the stage in general this age structure could have any form depending on the recent history of the population the one well defined case is when the population is at the stable age stage distribution this is exactly the condition under which λ 1 the asymptotic growth rate is the observed population growth rate λ t under this condition there are two factors that affect the age distribution within the stage and hence the fraction of individuals of an appropriate age to mature the first is the stage specific mortality which determines how a cohort shrinks as it ages within the stage the second is the asymptotic growth rate which determines the degree to which a cohort entering from the previous stage in one year is larger or smaller than that of the previous year under the stable age or stage distribution this makes γ i non trivial to calculate as the resulting formula table 2 involves λ 1 which can only be calculated once the mpm has been parameterized the solution is an iterative approach take an initial guess of λ 1 calculate γ i from the formula calculate the dominant eigenvalue of the resulting matrix use that as a new guess for λ 1 and repeat until the value of λ 1 stops changing we will refer to this as the asymptotic age within stage structure aas model the iterative nature of the aas model may be daunting to non modelers especially those trained before the emergence of quantitative ecology using r such researchers may be tempted by easier to calculate formulas some discover a predecessor to the above crowder et al approach that appears in crouse et al 1987 table 2 this formula is complex looking but straightforward to calculate as it doesn t require iteration it incorporates the within cohort dynamics but assumes that λ 1 1 we will refer to this as the stationary age within stage structure sas model where stationary means that the population is neither growing nor declining although we have seen no comment on this in the literature the sas model seems to be the correct choice when the goal is to calculate statistics such as the reproductive number r 0 that involve following a cohort through the entire life cycle an even simpler approach is to say that if the desired duration of stage i is t i timesteps then the fraction maturing is 1 t i caswell 2001 this relationship between the mean residence time stage duration and the fraction departing maturing is true for a simple markovian departure process e g gallager 1995 however for the population process different number of individuals are entering into the stage as a population may be growing or declining and individuals can also die before maturing consequently this particular relationship between the mean duration and fraction maturing is correct under asymptotic conditions only if σ i λ 1 1 we will refer to this as the flat age within stage structure fas model a rather different approach to estimating γ i does not explicitly attempt to match the mean stage duration but instead merely estimates γ i as the observed fraction of surviving individuals in the stage that mature to the next stage this requires repeated observations of marked individuals capture histories and might make use of tools such as multistate capture mark recapture models e g fujiwara and caswell 2001 as long as the modeled age within stage distribution remains the same as it was in the population during the observation period then the model will get the mean stage duration correct however the estimated γ i may be biased if the age within stage distribution changes unless the estimation process accounts for the age within stage of individuals in particular if γ i is estimated by calculating the fraction of individuals in stage i that were observed to mature in a given year the resulting model will accurately estimate λ 1 only if the observed population happened to be at the stable age structure we will refer to this as the observed age within stage structure oas model among the aas sas and fas models only the aas model will replicate λ 1 and its sensitivities from the fully age structured model of course a final approach if the stage durations really are fixed is to unroll the stage replacing the single stage class with t i age classes with identical survival coefficients or if the assumption of homogeneous survival within the stage was an approximation with actual age specific survival coefficients after analysis the age classes can be collapsed back to their stage to generate a stage structure or sensitivity analyses that are stage specific rather than age specific 3 prevalence of construction errors in published mpms 3 1 methods to evaluate the prevalence of these errors in published mpms we examined a sample of the studies contained in the comadre animal matrix model database salguero gómez et al 2016 using version 2 01 of the database we subset the data to studies of nonhuman animals that had a doi as a simple filter to eliminate non peer reviewed studies this left 65 studies published prior to the year 2000 and roughly twice that number published from 2000 to 2018 we retained all of the 20th century studies and took a random sample of 60 of the 21st century studies although many studies publish multiple models representing different sites or species we take the study as the unit of observation as a similar approach was usually taken in all the models within a publication some of the studies did not actually contain mpms the models in the comadre database were constructed by the comadre digitization team based on information in the cited paper we eliminated these using a haphazard subset of studies we developed a protocol to systematically assess each study appendix b this protocol was applied by 4 of the authors after initial training consistency was ensured by having all assessors independently apply the protocol to the same set of papers until all were getting consistent results if a question didn t apply e g if it was not a stage structure model the answer was coded na if the answer could not be determined from the information in the publication it was coded as unknown we coded a model as a postbreeding census if the first age or stage class appeared to be newborn e g eggs neonates or a small fraction of a timestep old e g hatchlings larvae fledglings we coded a model as a prebreeding census if the first age or stage class appeared to be one timestep old e g yearlings juveniles 1 year olds while a number of other breeding models are possible in practice nearly all models fell into one of these categories we examined the mpm to determine whether the fertility coefficients contained survival terms and if so whether they were appropriate to the model type if the appropriate survival term was not present we coded the model as incorrect to identify the first reproductive stage or age class we examined quantitative e g life table or qualitative e g text description of the life history information about the species as presented in the study for postbreeding census models we then asked whether the individuals maturing into that reproductive class had a nonzero fertility coefficient models lacking this fertility coefficient were coded as incorrect for stage structured models in which there was a target mean stage duration we examined textual model descriptions and symbolic representations of the model to determine whether it was constructed using the aas sas fas or oas formulations or whether the stages were unrolled into a leslie matrix formulation with the implicit age within stage being made explicit we examined the frequency of all formulations and coded aas and unrolled models as correct from the perspective of calculating the asymptotic growth rate λ 1 for each of the three classes of errors we calculated the overall percentage of relevant studies i e studies that had a structure potentially subject to the error and for which we could clearly determine how the model was constructed that made that error we also used logistic regression of error classification against publication year to examine whether these errors had become more or less frequent over time 3 2 results the comadre animal matrix database advertises itself as a repository of peer reviewed published mpms salguero gómez et al 2016 fine print in the user s guide anonymous 2017 reveals that in some cases the matrix does not actually appear in the cited paper but was provided to the database as a personal communication however in the course of assessing articles from the database we found many examples where the original publication did not construct an mpm at all instead it appears that the database collators constructed mpms from published demographic data such as life tables since our goal was to assess the model construction accuracy of authors not the database maintainers we excluded these studies from our analysis this removed 58 studies leaving 67 for us to analyze we were able to unambiguously identify the components of the fecundity term in 30 studies 53 of these studies failed to include an appropriate survival component in the fertility coefficients 100 of these errors were in postbreeding census models the frequency of these errors had no detectable trend over time p 0 198 fig 3 a the potential for missing the reproductive event associated with first reaching reproductive age is only a feature of postbreeding census models of the 24 studies in which we could unambiguously determine both the last pre reproductive stage or age class and in which we could identify fertility coefficients 67 made this error the frequency of these errors had no detectable trend over time p 0 755 fig 3b in our random sample only 19 studies included models having at least one stage class that was meant to last for multiple timesteps to obtain a reasonable sample size we augmented this with the haphazard sample we had used to develop the evaluation protocol which focused on stage structured models published since 2010 this led to 14 in which we were able to unambiguously classify the rule defining the maturation rate out of the stage s however the date range was too narrow to evaluate trends through time of these 64 did not use a rule that would generate a value of λ 1 that would match an age structured model with the target mean stage duration fig 4 4 consequences of incorrect mpm construction we evaluate the impacts of these errors in mpm construction by examining several endpoints that many analyses focus on the asymptotic population growth rate λ 1 sensitivity analysis of λ 1 to changes in underlying vital rates and life history statistics such as generation time we approach this evaluation through theoretical analysis where feasible and informative and by examining two case studies a lionfish pterois sp model with very high population growth morris et al 2011 and a pair of american alligator alligator mississippiensis models that project rapidly declining and nearly constant population dynamics dunham et al 2014 these studies made all three of the errors described above we singled them out not because they are particularly egregious many other studies make these errors but because the authors did an exceptional job of describing the species life history allowing us to infer the model they meant to construct we first focus on the effects on λ 1 and then evaluate the effects on other endpoints a matrix population model for lionfish was constructed by morris et al 2011 to investigate the potential approaches for controlling this invasive species the modeled life history consisted of three stages larvae juvenile and adult and time step of the model was one month the original model was a postbreeding census model but it did not include the survival of adults in the fertility rate the average duration of the juvenile stage was assumed to be 12 months in the model and the fertility coefficient for juveniles was set to zero this meant that the modeled lionfish take 14 months to reach first reproduction one month in larval stage 12 months in juvenile stage and one additional month in fertility rate in contrast to the target reproductive age of 12 months the authors used the fas model for calculating the transition rates for juveniles the full model is described as model l1 in appendix a for the american alligator populations dunham et al 2014 developed two stage structured matrix population models to compare the status of northern and southern populations which differed in stage durations and birth rates the original models consisted of five stages eggs larvae juvenile subadults and adults and the time step of the model was one year similarly to the lionfish model the alligator models were postbreeding census models but the authors did not include the survival of adults in the fertility rate the first stage was egg stage but it only lasted for three months therefore there was clear inconsistency in the time steps among stages dunham et al 2014 used the sas model to calculate transition rates for juvenile and subadult stages the full models are described as models an1 and as1 in appendix a in order to investigate the effects of the errors on λ 1 with the lionfish and american alligator matrices we constructed stage structured population matrices that corrected the three types of errors models l5 an3 and as3 in appendix a then we systematically inserted the errors back to the model and developed the total of nine models for comparison these models vary in maturation models aas sas fas and the presence or absence of reproduction by maturing juveniles with adult survival in the fertility coefficient when the reproduction by maturing juveniles was absent we also allowed adult survival in the fertility coefficient to be absent 4 1 failure to include survival terms in the fertility coefficients failing to include survival terms in the fertility coefficients will make those coefficients too large since survival is less than one this will lead to an overestimate of λ 1 this error most often occurs in postbreeding census models and will be approximately e surv λ 1 x 1 σ x f x s f x where s f x is the sensitivity of λ 1 to the fertility coefficient f x thus if the survival terms are close to one as they often are for adults and the sensitivity of the asymptotic growth rate to survival is small as it often is then this error should generally be fairly small the fertility coefficients in both lionfish and alligator models in the original papers omitted the survival of adults the effects of these errors can be observed by comparing open with survival and filled without survival circles in fig 5 when the survival rate was missing in the fertility coefficient asymptotic population growth rate was always overestimated for both lionfish and alligator populations the survival rate over the time step of a model was high 0 95 per month for lionfish and 0 83 per year for alligator therefore the effects were relatively minor however when we deal with organisms with low adult survival rate or when the time step is extended e g the time step is changed to 1 year in the lionfish model a fertility coefficient could be substantially inflated without adult survival rate being included causing biases in demographic statistics the effect was slightly higher for the southern population of american alligator than the northern population this resulted from a larger fecundity associated with the southern population 5 98 individuals per year compared with the northern population 2 37 individuals per year suggesting the error may be magnified for organisms with high fecundity 4 2 failure to allow individuals to reproduce when they first reach reproductive age the failure to allow individuals to reproduce when they first reach reproductive age will have two consequences r 0 the net reproductive rate will be reduced slightly and the mean generation time t g will be increased by a timestep both effects contribute to an underestimate of λ 1 the error is approximately e mature λ 1 r 0 1 t g σ a r 0 1 t g 1 where σ a is the one timestep survival of the newly matured class this doesn t simplify easily but it is clearly largest when the generation time is short or r 0 is large the original lionfish and alligator models did not include a fertility coefficient associated with individuals transitioning into an adult stage in all cases the missing fertility coefficient caused an underestimation of the asymptotic population growth rate the effects of the missing fertility coefficient depend on the life history strategy of the organisms for example the effects were greater for the southern alligator population than northern alligator population compare open circles and squares in fig 5 because the southern population had a shorter duration from egg to adult stages resulting in smaller generation time and higher birth rate resulting in higher r 0 than the northern population both of these would cause the reproduction in the first year to be smaller reducing the effects of the missing fertility coefficient to be small the effects of the missing fertility coefficient is expected to be large for species for which the contribution of offspring from individuals reproducing the first time is large 4 3 failure to use aas model for transition rate calculation if the stage durations are fixed such that a leslie matrix model with all age classes within the stage having the same survival is the best model then only the aas stage structured model will give the approximately correct λ 1 in general the sas model will be correct only if λ 1 1 if λ 1 1 then the maturation fraction will be too large and λ 1 will be overestimated the opposite will be true if λ 1 1 thus the sas model will bias λ 1 away from one the bias from fas model is similar except that the critical value for λ 1 is σ i thus if there is more than one multi timestep stage with different values of σ i and λ 1 is intermediate between these values then the direction of bias introduced by the fas model is unpredictable the impact of using the observed transition rates is likely to be highly variable depending on the nature of the deviations between the age structure when the population was observed and the asymptotic age structure the use of different maturation models table 2 has substantial effects on λ 1 fig 5 in particular the asymptotic population growth rate was substantially overestimated under the fas models compared with the aas models on the other hand sas models overestimated λ 1 when λ 1 1 lionfish and southern population of american alligator compared with aas models but it underestimated when λ 1 1 northern population of american alligator in general the sas model magnifies the deviation in asymptotic population growth rate from 1 as predicted by the theory above 4 4 effects of errors on sensitivity and elasticity analysis a common goal of constructing a matrix population model is to examine the sensitivity or elasticity of λ 1 to underlying demographic parameters often in the service of informing population management or understanding life history evolution predicting the effects of mpm construction errors on these quantities requires information about the second derivative of λ 1 with respect to model parameters caswell 1996 the theory of which seems to only have been developed for lefkovitch models in a lefkovitch model the second derivative of λ 1 with respect to diagonal matrix elements is positive and with respect to off diagonal elements seems to be generally negative mccarthy et al 2008 this suggests that overestimates of the maturation rate should reduce the sensitivity of λ 1 to both stasis and growth terms thus reducing the overall sensitivity of λ 1 to survival in addition failing to include survival terms in the fertility coefficients will necessarily lead to underestimates of the sensitivity and elasticity of λ 1 to survival to look at the specific effects on elasticities to particular parameters we calculated the elasticities of λ 1 to stage specific survival across the same suite of error combinations as we did for λ 1 for the lionfish population the choice of maturation model had a substantial impact on the elasticity of λ 1 to juvenile survival and the rank order of elasticities to juvenile and adult survival was reversed by the fas model fig 6 a the impacts of errors in the fertility coefficients had a very modest impact on elasticities fig 6b in contrast the elasticities of λ 1 to stage specific survival in the alligator populations were nearly unaffected by any of the matrix construction errors results not shown 4 5 effects of errors on other endpoints as described above the three common errors in constructing matrix population models can affect the population growth rate however calculating other endpoints such as stable stage distribution reproductive value sensitivity elasticity generation time and damping ratio are often the primary goal of constructing an mpm especially for management applications or studies of life history theory here we investigate the effects of the errors on these endpoints using matrices for the lionfish and two populations of american alligators we started with the original matrices as baseline models and constructed models that fixed various subsets of the focal errors to see how these errors affect the model projections and conclusions for the lionfish population we developed four stage structured population models that gradually correct for some or all of the problems and three age structured matrices of which two include the original errors associated with the fertility coefficients appendix a for the american alligator populations we developed two additional stage structured models that correct some or all of the problems and three age structured matrices of which two include the original errors associated with the fertility coefficients for each population all of these models were used to calculate λ 1 stable stage distribution reproductive value sensitivity and elasticity of λ 1 to stage specific survival rate and fecundity damping ratio and generation time the full results are shown in appendix a here we highlight some of the key outcomes the effects of failure to include survival terms in the fertility coefficients can be observed by comparing the age structured matrices with and without the correction the first set of age structured matrices l6 an4 as4 included corrected fertility coefficients with corresponding survival rates multiplied to the original fertility when the survival rate was missing in the fertility coefficient then the adult proportion of the stable stage distribution was underestimated figs a 2 and a 9 and the adult reproductive value was overestimated figs a 8 and a 16 these effects resulted from the fact the models mistakenly assumed more offspring were born inflating the number of younger individuals the effects of the missing fertility coefficient can be found by comparing models l2 and l3 stage structured lionfish models l7 and l8 age structured lionfish models an5 and an6 age structured alligator models for northern population and as5 and as6 age structured alligator models for southern population in all cases the missing fertility coefficient caused an overestimation of the adult proportion of the stable stage distribution figs a 2 and a 9 and an underestimation of adult reproductive value figs a 3 and a 10 the effects of using different maturation models can be observed by comparing the fas l3 sas l4 aas l5 and age structured l8 models for lionfish populations although the stable stage distributions of adults under the four models appear similar fig a 2 the juvenile proportion in the stable stage distributions were underestimated with the fas and sas models compared with the age structured models fig a 2 the reproductive value of adults were substantially underestimated with the fas and sas models compared with the aas or age structured models there are a variety of ways to define generation time in demographic studies coale 1972 in this study we used the mean age of mothers to represent the generation time applying formulas developed by bienvenu and legendre 2015 which is a function of elasticity and fertility coefficients therefore any bias associated with these two quantities affects the estimated generation time figs a 7 and a 16 we found substantial and variable impacts of mpm construction errors on the estimated generation time in addition the estimated generation time tends to be biased with stage structured models fujiwara and diaz lopez 2017 these results suggest that the calculation of generation time needs to be done carefully the damping ratio is given by λ 1 λ 2 where λ 1 is the eigenvalue of the largest magnitude and λ 2 is that of the second largest and it measures how quickly transient dynamics dissipate over time if λ 2 were not affected by the errors in constructing population matrices then the damping ratio and the asymptotic population growth rate should correlate with each other the fact they deviate from each other cf figs a 1 and a 5 figs a 8 and a 15 suggests the estimation of λ 2 is also affected by the errors in constructing population matrices 5 discussion we have described and analyzed three errors that are sometimes made when constructing animal matrix population models these errors involving the fertility coefficients and the maturation rates cause the mpm to misrepresent the intended life history of the species based on our analysis of the comadre animal matrix model database salguero gómez et al 2016 we find that these errors are quite common 60 of the published models that we evaluated have incorrect fertility coefficients missing survival component failure to reproduce upon maturation or both furthermore there is no evidence that these errors in the fertility coefficient are becoming less frequent through time fig 3 among the admittedly small sample of stage structured models fully half calculated the maturation rate in a way that would result in incorrect estimates of the asymptotic population growth rate these errors affect the value of quantities commonly calculated from mpms such as asymptotic growth rate and stage structure elasticity analysis generation time and characteristics of transient dynamics we can make a few generalizations about these effects first the two types of errors in the fertility coefficients have opposite effects on estimates of λ 1 the asymptotic population growth rate second incorrect specification of the maturation rate tends to have a larger impact on these statistics than do the other errors third when the age at maturation is fixed so that a leslie model is the most appropriate representation even a stage structured model that correctly matches the mean time to maturity gives incorrect transient dynamics and generation time finally most but not all of these errors are larger if λ 1 is far from one nevertheless the case studies we analyzed suggest that many analyses conducted with flawed mpms may have broad validity for example in none of the case studies did the errors introduce misclassifications of population decline versus increase furthermore errors in λ 1 are generally modest except when an inappropriate maturation model is used fig 5 finally the rank orders in stage specific values in the stable stage and reproductive value distributions were unaffected by the matrix construction errors however we have only a limited sample of case studies and for some outcomes even this small sample gives inconsistent results for the direction or magnitude of biases introduced by the mpm construction errors for example the rank order of the elasticities of lambda to the vital rates might alligator or might not lionfish be robust to model errors while a more complete understanding of these biases might be derived by analyzing more models spanning a range of life histories ecological understanding and management decisions would be better served by constructing the models correctly in the first place why do these errors occur the failure to include a survival component in the fertility coefficient is most surprising as all textbooks make clear statements about the need for this we suspect that the causes are threefold first different texts use different words to describe the birth rate b x e g the maternity function and the fertility coefficient f x for the latter fertility fecundity and reproduction are used to represent f x in different texts and the terms have different scientific meanings in human demography and various fields of animal ecology in particular many animal ecologists use the term fertility to refer to the potential to have offspring and so associate it with b x rather than f x in contrast demographers refer to this as fecundity the use of a linguistically vague common language word to refer to a precisely defined model element creates the condition for nonmodellers to redefine the model element to match their understanding of the word even when the textbook says otherwise second the visual similarity between the conceptual life cycle graph figs 1a 2 a and the life cycle graph that actually corresponds to the matrix may make it easy to forget to take the extra step of correctly formulating the fertility arrows finally many nonmodellers seem to struggle to grasp the importance of having every transition in the mpm represent the same timestep this may be a threshold concept i e an idea that is essential to mastery of a field but that is troublesome to students because it appears to violate common sense intuition cousin 2006 meyer and land 2006 although students find it more to be unnecessary rather than counter intuitive the need to include reproduction when an individual first matures which is solely found in postbreeding census models seems to be a clear example of a threshold concept here the challenge is the intuition that no juveniles should have positive fertility coefficients the challenge is probably exacerbated by the fact that most textbooks devote the most thorough explanation of mpm construction to age structured models where the confusing nature of postbreeding census models can be hidden by labeling an individual s age class as its age at its next birthday however when these textbooks move to a usually much briefer description of stage structured models where this solution does not work they generally switch notation without comment a notable exception is mills 2007 2013 who calls newborns n zero for all models and provides a very clear graphical depiction of both age structured and stage structured models the poor choice of maturation model is probably most easily understood most textbooks do not treat this issue and those that do e g caswell 2001 ebert 1998 tend to be more mathematical than many nonmodellers may be comfortable with furthermore they do not include clear guidance on which approach is most suitable for a given modeling objective how can the prevalence of these errors in mpm construction be reduced in the future the standard recommendation from experts including both reviewers of this paper is that biologists should think carefully about what happens to individuals over the course of a timestep think carefully about how the data relate to these events and assemble everything in such a way that each transition spans a timestep in essence this advice boils down to think like a modeler in our experience non modelers require a lot of interactive tutorial examples to really learn this process current textbooks do not provide this the best published examples we have seen are in articles describing modeling approaches for migratory species e g fig 28 2 of runge and marra 2005 it is impossible to know how many instructors provide effective classroom teaching on this topic but our analysis of the comadre database indicates that a substantial number of biologists have not adequately internalized this message clearly there is a role for improved training materials see below in the meantime is there anything that biologists seeking to construct an mpm for their species can do to increase the odds of constructing it correctly our analyses suggest two purely mechanical approaches that might substantially reduce error rates first we note that none of the prebreeding census mpms that we examined had errors in the fertility coefficients while we cannot assign causality to this outcome based simply on the data prebreeding models simply do not require dealing with the troublesome reproductive transition by maturing juveniles and it may be that the fact that newborn survival is left over after constructing the survival transitions encourages a closer look at the fertility coefficient it is also important to recognize that if one has information on age or stage specific birth rates and annual survival then that information can be used to create either a prebreeding or a postbreeding census model e g compare figs 1b and 1 d noticing that the same parameters occur in both in particular unless there is large age dependent variation in mortality through the breeding season it doesn t matter whether the survival is measured from the end of one breeding season to the end of the next or from the beginning of one breeding season to the beginning of the next the key is that the survival be measured over a full timestep e g year furthermore the prebreeding and postbreeding censuses are different views into the same model in particular the estimate of λ 1 and the elasticities of λ 1 to underlying demographic parameters will be identical between the two representations thus we recommend that even if the ultimate goal is a postbreeding census model the model be constructed using the prebreeding framework this reduces the likelihood of missing a survival term in the fecundity coefficient as the newborn survival has to be put somewhere and eliminates the non intuitive fertility coefficients associated with transitions into reproductive classes if a postbreeding census model is desired e g so that model output can be compared with census data that includes newborns then the prebreeding census model can be used to check the accuracy of the independently created postbreeding census model e g λ 1 should be identical for the two matrices in addition for the simple sorts of models represented by figs 1 and 2 e g without clonal reproduction or multiple genders the conversion of a matrix from a prebreeding representation to a postbreeding representation is a purely mechanical process that can be automated in software the pre to post function in the mpmtools r package kendall 2019 provides an example of this second we found that most models in which a conceptually age structured population had been collapsed into a small number of stages each with a well defined mean stage duration were constructed in ways that would fail to reproduce the asymptotic growth rate indeed in our case studies this error had the largest impact on λ 1 estimates we interpret this as being because the best stage based approximation the aas model is both conceptually and computationally challenging to produce for simple life histories we recommend using the mpmtools r package kendall 2019 to automatically construct an aas model from information on stage specific demography and duration more generally if the among individual stage variation is not too great i e all individuals mature at about the same age then we recommend that the stage be unrolled into a leslie matrix model this creates a model that makes correct projections under both transient and asymptotic conditions and can be used both for projecting the population and for calculating life history statistics this also allows the demographic rates to vary with age within a stage e g for species such as fish with size dependent demography avoiding further pitfalls highlighted by fujiwara and diaz lopez 2017 we recognize that in long lived species the results of sensitivity and elasticity analyses are often more useful when aggregated by stage fujiwara and diaz lopez 2017 we recommend performing this aggregation after analyzing the age structured model e g by summing the elasticities associated with all the age classes within a stage another reason for preferring age structured to stage structured models when appropriate is for the accurate calculation of generation time stage structured models in general are not particularly suitable for estimating generation time fujiwara and diaz lopez 2017 lebreton 2005 this is because stage structured modes lump individuals in multiple age classes into a single stage treating them equally this is a reasonable simplification if we are only calculating asymptotic population growth rate and stable stage distribution however all individuals regardless of duration of time spent in a stage are treated equally to have the same rate of transitioning to another stage this has a large effect on generation time estimation therefore it is strongly recommended that generation time calculation should be based on an age structured model unless stage transitions are truly age independent when the stage durations are not fixed a more advanced solution is to develop a model that incorporates both age and stage caswell et al 2018 lebreton 2005 in this case an accurate characterization of the distribution of stage durations can be critical for many analytic outcomes as described by de valpine et al 2014 for continuous time models however estimating the parameters of such distributions can be challenging see e g the derivation of parameters for time to next breeding in sea turtles by ebert 1998 experts can also help by developing handbooks and training materials that are both comprehensive and clear to non modelers who are experts in biology and ecology but novices at modeling the comprehensiveness requires in part a thorough treatment of stage structured models which are not described as completely as age structured models in many texts as well as a comprehensive discussion of the consequences of various choices of when the census should occur in the model the clarity certainly requires consistent notation and terminology as well as attention to the knowledge level of the audience but that will probably not be sufficient educational research suggests that when students arrive with misconceptions clear and accessible expositions of correct principles do not lead to learning as the students do not pay sufficient attention to recognize the difference between the exposition and their prior belief better learning occurs when they are first presented with the misconception and then led to an understanding of why it is wrong muller et al 2008a b the biologically based intuitions that underlay incorrect formulations of mpms may have the strength of scientific misconceptions in which case the training material will need to actively uproot them before a better understanding of the model requirements can be learned one pedagogical approach that may be helpful is to build seasonal sub models and use matrix multiplication to generate the integration over the full timestep rather than requiring the integration to be done in the brain of the model builder williams et al 2002 do this for age structured models only section 8 4 2 creating survivorship and reproduction matrices and showing how they can be combined to produce both prebreeding and postbreeding census models periodic matrix models are generally presented as advanced topics the notation in caswell s 2001 treatment of the topic is intimidating to non modelers and are typically applied to either annual species or species that breed continuously at seasonally varying rates throughout the year nevertheless a more accessible presentation of periodic matrix models showing how they can be used to integrate demographic processes that happen at different points in the annual cycle might help alleviate many of the problems identified here such an approach to mpm construction might also encourage the development of models that more fully incorporate the richness of within year life history processes experts must also address the fact that many creators of animal mpms are not comfortable with even the simple programming required to calculate quantities like the aas maturation coefficient while there are tools for easing the analysis an mpm once the matrix has been constructed e g stubben and milligan 2007 little is available to help non programmers construct complex mpms a set of such tools in a software environment with which many ecologists are familiar such as r would be helpful especially in connection with a tutorial we have focused here on three particularly common errors in mpm construction however other problematic errors may occur for example nearly all animal mpms are presented as birth pulse models but in some cases reproduction is continuous over all or a significant fraction of the model timestep the lionfish model analyzed here illustrates this lionfish are described as laying a batch of eggs every 3 days but by building a birth pulse model with a one month timestep morris et al 2011 fail to account for the fact that the total monthly egg production is reduced by parental mortality during the timestep or by the fact that age classes comprise a range of ages both of these issues are addressed by formulas for birth flow models but such models are vanishingly rare in ecological applications another challenge arises when demography is heterogeneous within a stage class as when individuals grow continuously through life and survival and birth rates are size dependent fujiwara and diaz lopez 2017 have studied this and provide new recommendations for how best to calculate average demographic rates within a heterogeneous stage class while our analysis has focused on animal mpms we note that plant mpms may be subject to similar errors as those described here in addition the construction of size structured mpms faces challenges that are qualitatively similar to those for stage structured mpms while differing in detail and ambiguities around the treatment of seeds and seed banks create the potential for additional errors in the fertility coefficient thus a systematic analysis of published plant mpms may be warranted in conclusion we have found that errors in constructing animal population models are widespread that these errors can have substantial quantitative e g mis estimation of the asymptotic growth rate λ 1 and qualitative e g mis ranking the elasticity of λ 1 to various vital rates consequences for the conclusions reached by the mpm analysis this is bad news and shows that we cannot count on peer review to ensure correct model construction while some analysis endpoints seem to be broadly robust to matrix construction errors especially errors in the fertility coefficient there may be some cases in which the scientific conclusions or management recommendations supported by those models could be flawed furthermore comparative studies that use the comadre database to obtain a representative sample of animal demography e g paniw et al 2018 will be subject to extra noise that may bias parameter estimates unless erroneous models are corrected or excluded from the analysis fortunately publications often contain enough life history information to allow the model to be revised to more closely match the species biology allowing the conclusions of particular studies to be updated and comprehensive databases to be improved acknowledgments this work was supported by a ucsb faculty senate grant to bek the analysis of the comadre database was supported by the max planck institute for demographic research we thank rob salguero gómez for feedback on the model evaluation protocol and manuscript and gordon fox dmitrii logofet and two anonymous reviewers for comments on the manuscript appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 03 011 appendix b supplementary data the following are the supplementary data to this article 
25028,worldwide cetacean species have started to be protected but they are still very vulnerable to accidental damage from an expanding range of human activities at sea to properly manage these potential threats we need a detailed understanding of the seasonal distributions of these highly mobile populations to achieve this goal a growing effort has been underway to develop species distribution models sdms that correctly describe and predict preferred species areas however accuracy is not always easy to achieve when physical barriers such as islands are present indeed sdms assume if only implicitly that the spatial effect is stationary and that correlation is only dependent on the distance between observations and not on the direction or a spatial coordinates the application of stationary sdms in these cases could lead to incorrect predictions and consequently to uninformed decision making in this study we identify vulnerable habitats for the bottlenose dolphin in the archipelago de la maddalena northern sardinia italy using bayesian hierarchical sdms that account for the physical barriers issue and provide a full specification of the associated uncertainty the approach we propose constitutes a major step forward in the understanding of cetacean species in many ecosystems where physical geographical and topographical barriers are present keywords archipelago de la maddalena cetaceans hierarchical bayesian spatial models inla spde 1 introduction globally the importance of cetaceans as keystone and umbrella species is being increasingly recognized as protected areas designed on top predator distributions have been demonstrated to be highly efficient leading to higher biodiversity levels and more ecosystem benefits sergio et al 2008 however cetacean populations have been facing various threats including depletion of resources habitat loss interactions with commercial fisheries diseases produced by pollution and physical and acoustic disturbances caused by vessel traffic pennino et al 2017 among cetaceans the bottlenose dolphin tursiops truncatus is a vulnerable species bearzi et al 2012 that is more susceptible to anthropogenic activities due to its occurrence in coastal waters where most threats occur this species is protected by the eu habitats directive 92 43 eec and its coastal ecotype is present in the accobams agreement on the conservation of cetaceans in the black sea mediterranean sea and contiguous atlantic area region notarbartolo di sciara 2002 the protection of cetacean habitats particularly those of bottlenose dolphins should be a priority issue for marine conservation given that protecting these areas constitutes an indirect measure toward global sea management pennino et al 2016a in order to achieve this goal it is essential to have a solid understanding of the relationship that the species has with its habitat and apply robust analyses of existing information and databases to identify special areas of conservation sac pennino et al 2016a sacs should be designed around specific sensitive areas where local bottlenose dolphins are known to have their centers of distribution gnone et al 2011 in this context species distribution models sdms can be a useful tool to achieve these objectives given that they link spatial occurrence or species abundance data with multivariate environmental data that can estimate the relationship between the species and its habitat and subsequently predict spatial occurrence or species abundance in un sampled locations or time periods martínez minaya et al 2018 nonetheless environmental conditions alone may not sufficiently explain species distribution as spatially intrinsic ecological processes such as competition or predation can also contribute therefore sdms that incorporate spatial random effects to account for unexplained spatial dependence in data have been gaining increasing interest in marine ecology indeed spatial random components could account for the spatial correlation driven by unmeasured covariates sdms usually assume if only implicitly that the spatial random effect is stationarity i e that correlation is only dependent on the distance between the points and not on the direction or the spatial coordinates bakka et al 2019 however this assumption could be erroneous in areas where there are physical barriers such islands thus leading to potentially biased predictions of species distributions consequently biased estimations and predictions of species distribution can lead to both uninformed decision making and inefficient management of natural resources bakka et al 2019 this is a fundamental issue in marine ecology where identification of vulnerable habitats e g protected marine areas nurseries etc is one of the most common conservation management tools used to sustain the long term viability of species populations in this paper we identify sensitive habitats for the bottlenose dolphin in the archipelago de la maddalena northern sardinia italy using a hierarchical bayesian approach for spatial sdms that account for physical barriers as a tool to approximate the posterior distributions we use the integrated nested laplace approximation inla rue et al 2009 the spatial effect that accounts for the physical barriers is included and measured by the approximation to a system of stochastic partial differential equations proposed by bakka et al 2019 the maddalena archipelago is included within the pelagos cetacean sanctuary which is the only pelagic marine protected area mpa for marine animals in the mediterranean sea the bottlenose dolphin is one of the most common cetacean species in this area notarbartolo di sciara 2002 with a population of 71 photo identified individuals pennino et al 2013 of which 22 have been defined as residents individuals sighted in all seasons during that one year and at least five times in line with all these an improved understanding of the spatial distribution of the bottlenose dolphin in this area could contribute to management of this vulnerable species 2 materials and methods 2 1 study area this study was conducted in waters within 3 miles off the coast of archipelago de la maddalena northern sardinia italy this area is within a national park located in the strait of bonifacio between the islands of sardinia and corsica and is part of the pelagos cetacean sanctuary that was established by italy france and monaco in 1999 the type of seabed of the inner shelf from 0 to 70 m in depth is mainly composed of rocky or sandy substrata covered with posidonia seagrass posidonia oceanica delile 1813 beds a high hydrodynamism characterizes this area that together with shallow depth and limited tidal range generate very clean waters the general aspect of the coast is indented with small promontories bays and narrow channels the topography of the bottom is variable with large cracks reefs and small islands 2 2 field and study methods in order to equally monitor the area random transects were performed from october 2007 to september 2008 on board a zodiac boat with a speed of 8 10 knots surveys were conducted by experts during light hours from 6 00 a m to 8 00 p m to identify species observers scanned with both the naked eye and binoculars 7 50 and 8 42 to ensure the same visibility across the study area surveys were only performed when the sea state was less than 3 douglas sea force scale and in clear conditions with no precipitation data collected included sighting occurrence date and geographical location geographical information were collected every minute using a gps logged to a computer equipped with mapsource software garmin gps device 2010 to avoid harassing the dolphins sightings were performed from a respectful distance no closer than 30 m with binoculars or telephoto lenses to get a good view of the animals if the dolphins approached the boat the course was maintained to avoid sudden changes in direction or speed that could injure the animals 2 3 environmental variables bottlenose dolphin distribution was modeled using five environmental variables selected for being known to affect their habitat three oceanographic variables sea surface temperature sst in c sea surface salinity sss in psu and chlorophyll a concentration chl in mg m3 and two topographic covariates depth in meters and slope in degrees sst sss and chl are strongly related to marine system productivity as they can affect nutrient availability metabolic rates and water stratification all these variables were derived from the aqua modis sensor as monthly values with a resolution of 2 km https modis gsfc nasa gov with respect to the importance of these selected variables it is worth noting that these topographic covariates have frequently been used as predictors of cetacean species distribution panigada et al 2008 mannocci et al 2014 also bathymetry derived terrain variables such as the slope of the seabed are indicative of seabed morphology and have been widely used as predictors of cetacean distribution lauria et al 2015 fonseca et al 2017 pennino et al 2016a usually low slope values correspond to a flat ocean bottom areas of sediment deposition while higher values indicate consolidate substrata i e rocky substrate fonseca et al 2017 bathymetric variables were derived from the marspec database available at http www marspec org with a spatial resolution of 1 km sbrocco and barber 2013 to maintain the same spatial resolution all environmental data were gridded at 2 km using the raster package hijmans and van etten 2015 in the r software core team 2018 collinearity between explanatory environmental variables was checked using a draftsman s plot and the pearson correlation index the variables were not highly correlated r 0 6 and thus were considered in further analyses finally all explanatory variables were centered and standardized following the approach of gelman 2008 2 4 statistical model a hierarchical bayesian spatial model that accounts for barriers bakka et al 2019 was used to estimate and predict overall occurrence of bottlenose dolphins with respect to environmental predictors this model has already been used in krainski et al 2018 in our case as data are composed by the presences and absences of bottlenose dolphins the response variable y i can be assumed to follow a bernoulli distribution with a mean of π i that can take on values of 1 or 0 depending on whether the habitat is suitable y i 1 or not y i 0 for the species as usual in generalized linear models each π i can be easily linked to a structured additive predictor η i through a link function g so that g π η the structured additive predictor η accounts for the effect of various covariates and the spatial effect in an additive way 1 η i β 0 m 1 m β m x mi u s i where β 0 corresponds to the intercept the coefficients β β 1 β m quantify the effect of the possible factors and covariates x x 1 x m on the response and u s i denotes the spatial random effect sdms usually assume stationarity in the spatial random effect u s i in other words the spatial autocorrelation only depends on the distance between points pennino et al 2013 see for instance paradinas et al 2015 rufener et al 2017 nevertheless if there are physical barriers such as islands this assumption can be erroneous thus prompting biased predictions as a consequence we suppose that the spatial random effect in the model depends also on the direction and the geographic coordinates i e u s is a non stationary spatial random effect using the approximation presented of bakka et al 2019 it can be estimated as the continuous weak solution to the following system of stochastic differential equations 2 u s r 2 8 u s r π 2 σ u w s for s ω n u s r b 2 8 u s r b π 2 σ u w s for s ω b where r and r b are the ranges for the normal and barrier areas respectively σ u is the marginal standard deviation of u x y w s denotes the white noise ω n is the normal terrain ω b is the barrier and their disjoint union gives the whole study area unlike stationary spatial effects the underlying idea is to construct a gaussian markov random field gmrf locally with one governing equation for the normal area sea and another for the barrier area earth the prior spatial effect only depends on two unknown hyperparameters the standard deviation σ u and the range in the normal area r because the range in the barrier area r b is fixed at close to zero as a result the system in 2 represents a local averaging of nearby values if there are two points separated by a landmass the very small range stops the local averaging on the barrier it forces the dependency to focus on moving around the barrier via local averages in the water area the system of differential equations in 2 can be solved by constructing a delaunay triangulation of the study area fig 1 and then applying the finite element method as explained in bakka et al 2019 in addition to the environmental variables and the spatial effect a factor representing the actual season was included in the model to account for temporal variability default priors were assigned for all fixed effect parameters which are approximations of non informative priors designed to have little influence on the posterior distribution pc priors simpson et al 2017 that followed the parametrization depicted in fuglstad et al 2018 were allocated for the only two hyperparameters in the model and define the covariance structure of u s σ u and r we set the median of the prior range to 0 3 the extent of the area in geographic coordinates and the median for the marginal standard deviation to 1 2 5 bayesian inference with inla all the models were fitted i e posteriors of the model parameters computed using the integrated nested laplace approximation inla methodology rue et al 2009 implemented in the r package inla https www r inla org in inla the bernoulli likelihood is approximated by a laplace approximation and the posterior for all parameters conditionally on the two hyperparameters σ r for the spatial field can be computed quickly by sparse matrix algorithms the posterior for the hyperparameters are found by exploring this two dimensional space and is fast due to its low dimension after representative values of the hyper parameters have been chosen these are integrated out to give a full posterior distribution for all the parameters and the spatial effect in the model bayesian posterior distributions unlike the mean and confidence intervals produced by classical analyses enable simple probability statements about the unknown parameters thus the region bounded by the 0 025 and 0 975 quantiles of the posterior distribution has an intuitive interpretation for a specific model the unknown parameter has a 95 chance of falling within this range of values as the interest was to analyze the probability of finding a dolphin in all the study area a grid of prediction locations were included in the model fitting at each grid the posterior predictive distribution of the probability of observing the dolphin was obtained 2 6 model selection model selection was conducted based on choosing the best subset of covariates see for instance heinze et al 2018 for a detailed revision of model selection procedures this method evaluates all 2 k k is the number of components of the model covariates and random effects such as the spatial effect possible models and choose the best model according to an information criterion in our case the watanabe akaike information criterion waic watanabe 2010 and the mean logarithmic of the approximated conditional predictive ordinate lcpo gneiting and raftery 2007 while waic values indicate the goodness of fit of the models the lcpo evaluates the predictive capacity lower values for both waic and lcpo represent the best compromise between fit and parsimony if the models are similar in terms of waic and lcpo following the parsimony criterion the model with less amount of covariates is selected 3 results between october 2007 and september 2008 bottlenose dolphins were sighted in 93 of the 206 surveys of the study area more specifically 34 sightings occurred in winter 29 in spring 8 in summer and 22 in autumn the total sighting rate was about 0 45 0 97 for the winter season 0 32 in spring 0 19 in summer and 0 57 in autumn table 1 due mainly to atmospherically reasons the survey effort was not homogeneous in all the seasons recording is maximum during the spring and summer period table 1 regarding the hierarchical bayesian sdms in addition to the five environmental variables the season factor and the non stationary spatial effect were considered to select the best model a total of 128 models were fitted table 2 displays the best 20 models and their waic and lcpo ordered by lcpo as noticed the presented 20 models were very similar in terms of waic and lcpo and so these models can be considered equivalent thus the parsimony criterion was employed in order to select the best model among those having equivalent values of waic and lcpo the final selected model was the one with only one covariate the seasonal effect after selecting this model we also investigated the importance of the covariates not selected in particular bayesian estimation of the regression coefficients associated to the covariates not selected was negligible in the sense that all the posterior distributions of the regression parameters were centered around zero and with variances smaller that the ones provided in the priors this was a clear proof that those covariates should not be part of the final selected model results in table 3 showed that winter is the season with the highest estimated dolphin occurrence posterior mean 4 46 95 ci 2 32 7 25 with respect to the reference level autumn season conversely summer and spring seasons show lower estimated dolphin occurrence than the reference level respectively posterior mean 2 37 95 ci 3 71 1 18 and posterior mean 0 79 95 ci 1 74 0 14 the median for the posterior predictive distribution of the probability of occurrence showed higher values in the whole area during the winter season fig 2 d conversely in autumn and spring a higher probability of occurrence close to 1 in line with the high sighting rate observed was found in the northwest area fig 2a and c similarly in summer the most frequented area was the northwest but with probabilities of presence close to 0 5 fig 2b the spatial effect that indicates the intrinsic variability of the distribution of bottlenose dolphins after excluding environmental variables was consistent with the probability maps fig 3 moreover the mean of the range of the spatial effect of the normal area was about 0 157 geographical degrees that are equivalent to 17 48 km the physical meaning of this value is that sightings of dolphins that are this distance or greater apart are not spatially correlated it is worth noting that this range value is in line with the one that biologists consider as the distance that observed dolphins are from different groups 4 discussion seasonal sensitive habitats for the bottlenose dolphin in the archipelago de la maddalena were identified using hierarchical bayesian sdms that account for physical barriers the proposed model showed that dolphin occurrence in the archipelago de la maddalena is influenced by a seasonal effect in the area our findings agree with those obtained by brotons et al 2008 in the balearic islands campana et al 2015 in the western mediterranean sea and pennino et al 2015 and pennino et al 2016a in our study area indeed estimated dolphin occurrence is higher during the winter season and especially compared to spring and summer several possible reasons either isolated or combined could explain this seasonal variation natural seasonal movement of dolphins could be related to prey availability or reproduction patterns moreover the intense nautical traffic in summer that characterizes this area could encourage these animals to move to areas where there are fewer pleasure boats and where the risk of collision and the noise is lower pennino et al 2016b another important factor driving dolphin occurrence is the spatial component which is highest in the western zone in this area bottlenose dolphins show a residential attitude with their center of distribution in the identified favourable areas the spatial effect usually captures the impact of important missing predictors and accounts for ecological processes e g predation or competition that may affect the spatial arrangement of a species roos et al 2015 in our case the spatial effect was not directly related to any environmental variable included in the final model but it could be reflecting disturbance from pleasure boating an effective conservation programme should take into account these findings favourable areas for bottlenose dolphins should be identified and protected as sacs special areas of conservation indeed bottlenose dolphins are listed in annex ii of the habitats directive that specifically requires the identification of the sacs cañadas et al 2005 sacs should be designed around special sensitive areas such as the ones identified in this study protection measures should be devoted to limiting the disturbance from recreational boats which is probably the main threat for this species in the area spatial ecology has a direct applied relevance to cetaceans management but it also has a broad ecological significance although it may be complicated to define the boundaries of habitats of these highly mobile species it represents the first step towards facilitating effective spatial management however using a non accurate approach could culminate in misidentification in both the posterior distributions of the fixed and random effects and in species habitat predictions therefore leading to inappropriate management measures that can sometimes be irreversible bakka et al 2019 in line with this we have used here a hierarchical bayesian spatial model that simultaneously deals with the presence of physical geographical and topographical barriers spatial autocorrelation issues and different sources of uncertainties our modeling is based on the novel approach by bakka et al 2019 and allows us to analyze sparsely binary spatial data some advantages result from using our proposal the first is a result of the bayesian methodology itself that is that all multiple sources of uncertainty associated with both the observed data and ecological process can be included in the analysis thus resulting in more robust statistical inference moreover the posterior predictive distribution of the probability of finding the species turns out to be a very suitable tool that allows us to express our uncertainties associated with the entire species habitat prediction phenomenon and to explicitly describe the associated spatio temporal variability the second advantage is that the proposal provides an accuracy that would not be easy to achieve when physical barriers are present the application of stationary models in these cases could lead to uncertain predictions and consequently to uninformed decision making the third advantage is that we can present a map of the spatial effect along with its corresponding uncertainty the final advantage is the computational gain from the use of the inla approach which allows us to easily make inferences and predictions within a highly structured model finally regarding the database used in this study it is worth to be mentioned that it has some flaws especially due to the non standardized sampling effort and limited field quantitative information i e total and seasonal nautical mileage traveled this can probably have affected the sighting rate per season and so the resulting predictive maps nevertheless it is well known that collecting data at sea presents many logistic and financial challenges in particular due to find suitable seagoing vessels for data collection and atmospherically and oceanographic reasons however determining cetacean distribution is essential for proposing conservation policies and any advance in this sense is an improvement of the management and conservation of their populations in conclusion this approach constitutes a major step forward in the understanding of species in many aquatic ecosystems where physical geographical and topographical barriers are present acknowledgements dc would like to thank the ministerio de educación y ciencia spain for financial support jointly financed by the european regional development fund feder via research grants mtm2016 77501 p and tec2016 81900 redt jm m would like to thank generalitat valenciana and the european social fund esf for support via vali d grant acif 2016 455 esf invests in your future authors are very grateful to all people working in the field surveys and in particular to dr andrea rotta 
25028,worldwide cetacean species have started to be protected but they are still very vulnerable to accidental damage from an expanding range of human activities at sea to properly manage these potential threats we need a detailed understanding of the seasonal distributions of these highly mobile populations to achieve this goal a growing effort has been underway to develop species distribution models sdms that correctly describe and predict preferred species areas however accuracy is not always easy to achieve when physical barriers such as islands are present indeed sdms assume if only implicitly that the spatial effect is stationary and that correlation is only dependent on the distance between observations and not on the direction or a spatial coordinates the application of stationary sdms in these cases could lead to incorrect predictions and consequently to uninformed decision making in this study we identify vulnerable habitats for the bottlenose dolphin in the archipelago de la maddalena northern sardinia italy using bayesian hierarchical sdms that account for the physical barriers issue and provide a full specification of the associated uncertainty the approach we propose constitutes a major step forward in the understanding of cetacean species in many ecosystems where physical geographical and topographical barriers are present keywords archipelago de la maddalena cetaceans hierarchical bayesian spatial models inla spde 1 introduction globally the importance of cetaceans as keystone and umbrella species is being increasingly recognized as protected areas designed on top predator distributions have been demonstrated to be highly efficient leading to higher biodiversity levels and more ecosystem benefits sergio et al 2008 however cetacean populations have been facing various threats including depletion of resources habitat loss interactions with commercial fisheries diseases produced by pollution and physical and acoustic disturbances caused by vessel traffic pennino et al 2017 among cetaceans the bottlenose dolphin tursiops truncatus is a vulnerable species bearzi et al 2012 that is more susceptible to anthropogenic activities due to its occurrence in coastal waters where most threats occur this species is protected by the eu habitats directive 92 43 eec and its coastal ecotype is present in the accobams agreement on the conservation of cetaceans in the black sea mediterranean sea and contiguous atlantic area region notarbartolo di sciara 2002 the protection of cetacean habitats particularly those of bottlenose dolphins should be a priority issue for marine conservation given that protecting these areas constitutes an indirect measure toward global sea management pennino et al 2016a in order to achieve this goal it is essential to have a solid understanding of the relationship that the species has with its habitat and apply robust analyses of existing information and databases to identify special areas of conservation sac pennino et al 2016a sacs should be designed around specific sensitive areas where local bottlenose dolphins are known to have their centers of distribution gnone et al 2011 in this context species distribution models sdms can be a useful tool to achieve these objectives given that they link spatial occurrence or species abundance data with multivariate environmental data that can estimate the relationship between the species and its habitat and subsequently predict spatial occurrence or species abundance in un sampled locations or time periods martínez minaya et al 2018 nonetheless environmental conditions alone may not sufficiently explain species distribution as spatially intrinsic ecological processes such as competition or predation can also contribute therefore sdms that incorporate spatial random effects to account for unexplained spatial dependence in data have been gaining increasing interest in marine ecology indeed spatial random components could account for the spatial correlation driven by unmeasured covariates sdms usually assume if only implicitly that the spatial random effect is stationarity i e that correlation is only dependent on the distance between the points and not on the direction or the spatial coordinates bakka et al 2019 however this assumption could be erroneous in areas where there are physical barriers such islands thus leading to potentially biased predictions of species distributions consequently biased estimations and predictions of species distribution can lead to both uninformed decision making and inefficient management of natural resources bakka et al 2019 this is a fundamental issue in marine ecology where identification of vulnerable habitats e g protected marine areas nurseries etc is one of the most common conservation management tools used to sustain the long term viability of species populations in this paper we identify sensitive habitats for the bottlenose dolphin in the archipelago de la maddalena northern sardinia italy using a hierarchical bayesian approach for spatial sdms that account for physical barriers as a tool to approximate the posterior distributions we use the integrated nested laplace approximation inla rue et al 2009 the spatial effect that accounts for the physical barriers is included and measured by the approximation to a system of stochastic partial differential equations proposed by bakka et al 2019 the maddalena archipelago is included within the pelagos cetacean sanctuary which is the only pelagic marine protected area mpa for marine animals in the mediterranean sea the bottlenose dolphin is one of the most common cetacean species in this area notarbartolo di sciara 2002 with a population of 71 photo identified individuals pennino et al 2013 of which 22 have been defined as residents individuals sighted in all seasons during that one year and at least five times in line with all these an improved understanding of the spatial distribution of the bottlenose dolphin in this area could contribute to management of this vulnerable species 2 materials and methods 2 1 study area this study was conducted in waters within 3 miles off the coast of archipelago de la maddalena northern sardinia italy this area is within a national park located in the strait of bonifacio between the islands of sardinia and corsica and is part of the pelagos cetacean sanctuary that was established by italy france and monaco in 1999 the type of seabed of the inner shelf from 0 to 70 m in depth is mainly composed of rocky or sandy substrata covered with posidonia seagrass posidonia oceanica delile 1813 beds a high hydrodynamism characterizes this area that together with shallow depth and limited tidal range generate very clean waters the general aspect of the coast is indented with small promontories bays and narrow channels the topography of the bottom is variable with large cracks reefs and small islands 2 2 field and study methods in order to equally monitor the area random transects were performed from october 2007 to september 2008 on board a zodiac boat with a speed of 8 10 knots surveys were conducted by experts during light hours from 6 00 a m to 8 00 p m to identify species observers scanned with both the naked eye and binoculars 7 50 and 8 42 to ensure the same visibility across the study area surveys were only performed when the sea state was less than 3 douglas sea force scale and in clear conditions with no precipitation data collected included sighting occurrence date and geographical location geographical information were collected every minute using a gps logged to a computer equipped with mapsource software garmin gps device 2010 to avoid harassing the dolphins sightings were performed from a respectful distance no closer than 30 m with binoculars or telephoto lenses to get a good view of the animals if the dolphins approached the boat the course was maintained to avoid sudden changes in direction or speed that could injure the animals 2 3 environmental variables bottlenose dolphin distribution was modeled using five environmental variables selected for being known to affect their habitat three oceanographic variables sea surface temperature sst in c sea surface salinity sss in psu and chlorophyll a concentration chl in mg m3 and two topographic covariates depth in meters and slope in degrees sst sss and chl are strongly related to marine system productivity as they can affect nutrient availability metabolic rates and water stratification all these variables were derived from the aqua modis sensor as monthly values with a resolution of 2 km https modis gsfc nasa gov with respect to the importance of these selected variables it is worth noting that these topographic covariates have frequently been used as predictors of cetacean species distribution panigada et al 2008 mannocci et al 2014 also bathymetry derived terrain variables such as the slope of the seabed are indicative of seabed morphology and have been widely used as predictors of cetacean distribution lauria et al 2015 fonseca et al 2017 pennino et al 2016a usually low slope values correspond to a flat ocean bottom areas of sediment deposition while higher values indicate consolidate substrata i e rocky substrate fonseca et al 2017 bathymetric variables were derived from the marspec database available at http www marspec org with a spatial resolution of 1 km sbrocco and barber 2013 to maintain the same spatial resolution all environmental data were gridded at 2 km using the raster package hijmans and van etten 2015 in the r software core team 2018 collinearity between explanatory environmental variables was checked using a draftsman s plot and the pearson correlation index the variables were not highly correlated r 0 6 and thus were considered in further analyses finally all explanatory variables were centered and standardized following the approach of gelman 2008 2 4 statistical model a hierarchical bayesian spatial model that accounts for barriers bakka et al 2019 was used to estimate and predict overall occurrence of bottlenose dolphins with respect to environmental predictors this model has already been used in krainski et al 2018 in our case as data are composed by the presences and absences of bottlenose dolphins the response variable y i can be assumed to follow a bernoulli distribution with a mean of π i that can take on values of 1 or 0 depending on whether the habitat is suitable y i 1 or not y i 0 for the species as usual in generalized linear models each π i can be easily linked to a structured additive predictor η i through a link function g so that g π η the structured additive predictor η accounts for the effect of various covariates and the spatial effect in an additive way 1 η i β 0 m 1 m β m x mi u s i where β 0 corresponds to the intercept the coefficients β β 1 β m quantify the effect of the possible factors and covariates x x 1 x m on the response and u s i denotes the spatial random effect sdms usually assume stationarity in the spatial random effect u s i in other words the spatial autocorrelation only depends on the distance between points pennino et al 2013 see for instance paradinas et al 2015 rufener et al 2017 nevertheless if there are physical barriers such as islands this assumption can be erroneous thus prompting biased predictions as a consequence we suppose that the spatial random effect in the model depends also on the direction and the geographic coordinates i e u s is a non stationary spatial random effect using the approximation presented of bakka et al 2019 it can be estimated as the continuous weak solution to the following system of stochastic differential equations 2 u s r 2 8 u s r π 2 σ u w s for s ω n u s r b 2 8 u s r b π 2 σ u w s for s ω b where r and r b are the ranges for the normal and barrier areas respectively σ u is the marginal standard deviation of u x y w s denotes the white noise ω n is the normal terrain ω b is the barrier and their disjoint union gives the whole study area unlike stationary spatial effects the underlying idea is to construct a gaussian markov random field gmrf locally with one governing equation for the normal area sea and another for the barrier area earth the prior spatial effect only depends on two unknown hyperparameters the standard deviation σ u and the range in the normal area r because the range in the barrier area r b is fixed at close to zero as a result the system in 2 represents a local averaging of nearby values if there are two points separated by a landmass the very small range stops the local averaging on the barrier it forces the dependency to focus on moving around the barrier via local averages in the water area the system of differential equations in 2 can be solved by constructing a delaunay triangulation of the study area fig 1 and then applying the finite element method as explained in bakka et al 2019 in addition to the environmental variables and the spatial effect a factor representing the actual season was included in the model to account for temporal variability default priors were assigned for all fixed effect parameters which are approximations of non informative priors designed to have little influence on the posterior distribution pc priors simpson et al 2017 that followed the parametrization depicted in fuglstad et al 2018 were allocated for the only two hyperparameters in the model and define the covariance structure of u s σ u and r we set the median of the prior range to 0 3 the extent of the area in geographic coordinates and the median for the marginal standard deviation to 1 2 5 bayesian inference with inla all the models were fitted i e posteriors of the model parameters computed using the integrated nested laplace approximation inla methodology rue et al 2009 implemented in the r package inla https www r inla org in inla the bernoulli likelihood is approximated by a laplace approximation and the posterior for all parameters conditionally on the two hyperparameters σ r for the spatial field can be computed quickly by sparse matrix algorithms the posterior for the hyperparameters are found by exploring this two dimensional space and is fast due to its low dimension after representative values of the hyper parameters have been chosen these are integrated out to give a full posterior distribution for all the parameters and the spatial effect in the model bayesian posterior distributions unlike the mean and confidence intervals produced by classical analyses enable simple probability statements about the unknown parameters thus the region bounded by the 0 025 and 0 975 quantiles of the posterior distribution has an intuitive interpretation for a specific model the unknown parameter has a 95 chance of falling within this range of values as the interest was to analyze the probability of finding a dolphin in all the study area a grid of prediction locations were included in the model fitting at each grid the posterior predictive distribution of the probability of observing the dolphin was obtained 2 6 model selection model selection was conducted based on choosing the best subset of covariates see for instance heinze et al 2018 for a detailed revision of model selection procedures this method evaluates all 2 k k is the number of components of the model covariates and random effects such as the spatial effect possible models and choose the best model according to an information criterion in our case the watanabe akaike information criterion waic watanabe 2010 and the mean logarithmic of the approximated conditional predictive ordinate lcpo gneiting and raftery 2007 while waic values indicate the goodness of fit of the models the lcpo evaluates the predictive capacity lower values for both waic and lcpo represent the best compromise between fit and parsimony if the models are similar in terms of waic and lcpo following the parsimony criterion the model with less amount of covariates is selected 3 results between october 2007 and september 2008 bottlenose dolphins were sighted in 93 of the 206 surveys of the study area more specifically 34 sightings occurred in winter 29 in spring 8 in summer and 22 in autumn the total sighting rate was about 0 45 0 97 for the winter season 0 32 in spring 0 19 in summer and 0 57 in autumn table 1 due mainly to atmospherically reasons the survey effort was not homogeneous in all the seasons recording is maximum during the spring and summer period table 1 regarding the hierarchical bayesian sdms in addition to the five environmental variables the season factor and the non stationary spatial effect were considered to select the best model a total of 128 models were fitted table 2 displays the best 20 models and their waic and lcpo ordered by lcpo as noticed the presented 20 models were very similar in terms of waic and lcpo and so these models can be considered equivalent thus the parsimony criterion was employed in order to select the best model among those having equivalent values of waic and lcpo the final selected model was the one with only one covariate the seasonal effect after selecting this model we also investigated the importance of the covariates not selected in particular bayesian estimation of the regression coefficients associated to the covariates not selected was negligible in the sense that all the posterior distributions of the regression parameters were centered around zero and with variances smaller that the ones provided in the priors this was a clear proof that those covariates should not be part of the final selected model results in table 3 showed that winter is the season with the highest estimated dolphin occurrence posterior mean 4 46 95 ci 2 32 7 25 with respect to the reference level autumn season conversely summer and spring seasons show lower estimated dolphin occurrence than the reference level respectively posterior mean 2 37 95 ci 3 71 1 18 and posterior mean 0 79 95 ci 1 74 0 14 the median for the posterior predictive distribution of the probability of occurrence showed higher values in the whole area during the winter season fig 2 d conversely in autumn and spring a higher probability of occurrence close to 1 in line with the high sighting rate observed was found in the northwest area fig 2a and c similarly in summer the most frequented area was the northwest but with probabilities of presence close to 0 5 fig 2b the spatial effect that indicates the intrinsic variability of the distribution of bottlenose dolphins after excluding environmental variables was consistent with the probability maps fig 3 moreover the mean of the range of the spatial effect of the normal area was about 0 157 geographical degrees that are equivalent to 17 48 km the physical meaning of this value is that sightings of dolphins that are this distance or greater apart are not spatially correlated it is worth noting that this range value is in line with the one that biologists consider as the distance that observed dolphins are from different groups 4 discussion seasonal sensitive habitats for the bottlenose dolphin in the archipelago de la maddalena were identified using hierarchical bayesian sdms that account for physical barriers the proposed model showed that dolphin occurrence in the archipelago de la maddalena is influenced by a seasonal effect in the area our findings agree with those obtained by brotons et al 2008 in the balearic islands campana et al 2015 in the western mediterranean sea and pennino et al 2015 and pennino et al 2016a in our study area indeed estimated dolphin occurrence is higher during the winter season and especially compared to spring and summer several possible reasons either isolated or combined could explain this seasonal variation natural seasonal movement of dolphins could be related to prey availability or reproduction patterns moreover the intense nautical traffic in summer that characterizes this area could encourage these animals to move to areas where there are fewer pleasure boats and where the risk of collision and the noise is lower pennino et al 2016b another important factor driving dolphin occurrence is the spatial component which is highest in the western zone in this area bottlenose dolphins show a residential attitude with their center of distribution in the identified favourable areas the spatial effect usually captures the impact of important missing predictors and accounts for ecological processes e g predation or competition that may affect the spatial arrangement of a species roos et al 2015 in our case the spatial effect was not directly related to any environmental variable included in the final model but it could be reflecting disturbance from pleasure boating an effective conservation programme should take into account these findings favourable areas for bottlenose dolphins should be identified and protected as sacs special areas of conservation indeed bottlenose dolphins are listed in annex ii of the habitats directive that specifically requires the identification of the sacs cañadas et al 2005 sacs should be designed around special sensitive areas such as the ones identified in this study protection measures should be devoted to limiting the disturbance from recreational boats which is probably the main threat for this species in the area spatial ecology has a direct applied relevance to cetaceans management but it also has a broad ecological significance although it may be complicated to define the boundaries of habitats of these highly mobile species it represents the first step towards facilitating effective spatial management however using a non accurate approach could culminate in misidentification in both the posterior distributions of the fixed and random effects and in species habitat predictions therefore leading to inappropriate management measures that can sometimes be irreversible bakka et al 2019 in line with this we have used here a hierarchical bayesian spatial model that simultaneously deals with the presence of physical geographical and topographical barriers spatial autocorrelation issues and different sources of uncertainties our modeling is based on the novel approach by bakka et al 2019 and allows us to analyze sparsely binary spatial data some advantages result from using our proposal the first is a result of the bayesian methodology itself that is that all multiple sources of uncertainty associated with both the observed data and ecological process can be included in the analysis thus resulting in more robust statistical inference moreover the posterior predictive distribution of the probability of finding the species turns out to be a very suitable tool that allows us to express our uncertainties associated with the entire species habitat prediction phenomenon and to explicitly describe the associated spatio temporal variability the second advantage is that the proposal provides an accuracy that would not be easy to achieve when physical barriers are present the application of stationary models in these cases could lead to uncertain predictions and consequently to uninformed decision making the third advantage is that we can present a map of the spatial effect along with its corresponding uncertainty the final advantage is the computational gain from the use of the inla approach which allows us to easily make inferences and predictions within a highly structured model finally regarding the database used in this study it is worth to be mentioned that it has some flaws especially due to the non standardized sampling effort and limited field quantitative information i e total and seasonal nautical mileage traveled this can probably have affected the sighting rate per season and so the resulting predictive maps nevertheless it is well known that collecting data at sea presents many logistic and financial challenges in particular due to find suitable seagoing vessels for data collection and atmospherically and oceanographic reasons however determining cetacean distribution is essential for proposing conservation policies and any advance in this sense is an improvement of the management and conservation of their populations in conclusion this approach constitutes a major step forward in the understanding of species in many aquatic ecosystems where physical geographical and topographical barriers are present acknowledgements dc would like to thank the ministerio de educación y ciencia spain for financial support jointly financed by the european regional development fund feder via research grants mtm2016 77501 p and tec2016 81900 redt jm m would like to thank generalitat valenciana and the european social fund esf for support via vali d grant acif 2016 455 esf invests in your future authors are very grateful to all people working in the field surveys and in particular to dr andrea rotta 
25029,in ecology plant herbivore relationships are the crucial link generating animal biomass from mere sunlight through photosynthesis these interactions are basic in understanding ecology and evolution of virtually any ecosystem the relationship depends also on environmental factors like rainfall temperature and altitude understanding patterns of these environment dependent interactions will help to make better predictions and recommend possible conservation strategies many of existing mathematical models for plant herbivore interactions and their analysis do not include these environmental factors in this study a mathematical model that incorporates variations of some of the parameter values due to changes in temperature and rainfall is formulated and used to determine necessary threshold values for co existence to validate the results of the mathematical model real data from the genale dawa river basin in the southern part of ethiopia is collected and used the river basin represents the three major climatic zones of the country the cool zone temperate zone and hot lowlands numerical simulations were done using the collected data and it is observed that coexistence is possible in all the three regions but it is sensitive to the change in rainfall and temperature if the change is within 10 there is a possibility of population extinction hence this paper shows that co existence of population is highly dependent on the environmental changes 2010 msc 92d40 92b05 37b55 keywords plant herbivore interaction allee effect harvest equilibrium points non autonomous dynamical systems 1 introduction all living things get energy for their survival growth and development from water sunlight and their various sources of food the rule of nature for all living things in any ecosystem is based on the battle for survival and every species acts accordingly ho and pennings 2013 plants and herbivores comprise almost 50 of the organisms on earth and the interaction between them powerfully shapes communities and ecosystems coley 1998 many plant herbivore relationships can be fully described by complex often nonlinear relationships which can lead to a threshold whereby slight and apparently weak changes in processes operating at small scale can result in sudden and dramatic changes at larger scales choquenot and parkes 2001 holl et al 2013 understanding the effect of herbivores on whole plants and plant communities requires a detailed understanding of the complex relationships that drive small scale processes and the manner in which they interact to generate dynamics at larger scales barber and marquis 2011 global environmental change affects all living organisms with complex consequences for biodiversity ecosystem structure and function predicting generalities in the direction of such changes represents one of the major challenges in ecology it is well known that plants need water nutrients air warmth and sunlight to grow and their type and density is time dependent as there is a warm season versus cold season and dry season versus rainy season which vary in time in other words plant growth rate is a function of time consequently herbivore feeding rate can also be considered as a function of time in cases where grazing is the only means of food supply feeding rate can vary with seasons and herbivores feed better when there is moisture in their food temperature is a very important factor affecting herbivore performance and therefore should not be overlooked when predicting the impact on plant herbivore interactions ho and pennings 2013 it is important in regulating rates of physiological processes and influencing growth and development of plants not excessive but sufficient amount of heat is a basic prerequisite for life haferkamp 1987 every vital process in ecology is restricted to a certain temperature range and it has its own optimal operating temperature on either side of which performance declines however the level of other environmental factors such as moisture affect the condition of the temperature response rainfall is one of the most important abiotic factors that limits physiological processes and ecological adaptability of plants availability of water is a factor that limits growth and survival rate of plants plants obtain all the nutrients they need from the environment around them and rainfall plays an important role in this regard for instance being the natural way for plants to obtain moisture rainfall frees nutrients and materials in the soil the plants need to survive so that the roots absorb these particles by diffusion process rainwater is also used by plants alongside photosynthesis to make sugar and to carry it through the plant to feed individual cells these cells convert the sugar to produce leaves flowers and fruits haferkamp 1987 including the effect of environmental factors in the dynamics of the plant herbivore interaction remains a challenge so far however some researchers considered periodic mathematical models to study the contribution of climatic factors in predator prey models cui 2005 cushing 1977a 1977b ding et al 1995 gomez et al 1996 zhidong 1999 these models describe the interactions of predators and their prey using ordinary differential equations the first of such system of differential equation is the lotka volterra model the study of plant herbivore interactions through dynamical systems have been extended far beyond the initial lotka volterra model both in theory and modeling approach to address the whole aspect of the actual interactions classical approaches in constructing a plant herbivore model is based on the predator prey system see feng et al 2011 and the references therein general periodic models were studied for existence permanence and persistence of solutions in cui 2005 cushing 1977a in literature so far the environmental change effects on the plant herbivore interactions have been studied using models with constant death rate cushing 1977a or models with all parameters depending on time zhidong 1996 or without considering the allee effect and or the harvest rate butler and freedman 1981 these issues are addressed in this paper moreover we used field data from a suitably selected region and framed specific functional formulations to test the applicability of the model and to investigate specific effects of variation of temperature and rainfall in the region this work is a climate variation extension of a paper by the same authors asfaw et al 2018 which considers a similar mathematical model but with constant parameters in this paper we study a plant herbivore model by considering factors such as holling type ii feeding response of herbivores allee effect on the herbivore birth rate plant density dependent herbivore death rate and harvest rate we consider the herbivore self limiting logistic term in the idea of density dependent herbivore death rate this means the death rate of herbivore depends on availability of food plants hence it can never reach its carrying capacity as for the parameters we took only the plant growth rate r t and the herbivore feeding rate a t to be time dependent functions and we keep the remaining parameters constant we considered the climatic variation of rainfall and temperature through the time dependent parameters the paper is organized as follows in section 2 we propose and describe a general model with periodic plant growth and herbivore feeding rates to be studied in section 3 we discuss the general effect of temperature and rainfall on the plant herbivore interactions and describe the study area in section 4 numerical simulations are presented for plant herbivore interactions for the three different climatic zones in the last section we present our results discussions and conclusions 2 description of the general model with periodic plant growth and herbivore feeding rates for the formulation and analysis of the model we make the following assumptions based on the interaction of plants and herbivores a1 environmental changes and weather factors for example temperature rainfall etc have significant effects on the growth of plants therefore we assume that the growth rate of the plant r t is governed by the logistic equation in which the coefficients are periodic functions on account of seasonal variations a2 based on assumption a1 due to the periodic growth rate of plants we assume that the feeding or consumption rate of herbivores on plants a t is also periodic and is a continuous function of time under these assumptions let us consider the following predator prey type model for the plant herbivore interaction 1 dp dt r t p 1 p k a t p b p h dh dt h ca t p b p h h h d f p μ p 0 0 h 0 0 here p t represents plant biomass h t represents herbivore biomass r t represents time dependent intrinsic growth rate for plant population and a t denotes time dependent herbivore feeding rate on plant population the other parameters are positive constants independent of time representing carrying capacity of the environment k half saturation constant of herbivores feeding b conversion rate of the consumed plant into herbivore c allee constant h and harvest rate μ respectively we take these parameters as constants because the effect of temperature and rainfall in them is very insignificant to the level that it can be ignored the feeding rate is considered as a holling type ii functional response which is expressed as f p a t p b p in the second equation of the model system 1 the term d f p represents the density dependent herbivore death rate which is a decreasing function of the feeding response and is bounded by the minimum and the maximum death rates d 1 and d 2 asfaw et al 2018 it is given by d f p d 2 f p g f p which reduces after considering d f 0 d 2 and d f k d 1 to determine the constant g to 2 d f p d 2 k 1 d 1 d 2 b p p b k d 2 d 1 d 2 1 k 1 d 1 d 2 b p d 2 d 1 b k p hence we say d 1 d f p d 2 as in asfaw et al 2018 this plant density dependent herbivore death rate also contains in it the idea that since it depends on the availability of plants the herbivore dynamics follows the plant dynamics hence it will never reach its own carrying capacity moreover herbivore population reproduces sexually and therefore to reproduce or to give birth to a new herbivore existence of enough herbivore population is crucial and this is taken care of by the term h h h where h is the allee constant due to the fact that cf p h h h vanishes as h goes to extinction asfaw et al 2018 terry 2015 that is individual female herbivore will struggle to reproduce as the herbivore density falls to zero either because they cannot find a mate or because of a greater risk of inbreeding for the system to be mathematically and biologically meaningful we need to work on positive quantities for population or biomass variables hence we define the domain space by ω p h ℝ 2 p 0 h 0 where the population of both plants and herbivores takes values only from the first quadrant that is the positivity the mathematical analysis of model system 1 persistence and permanence of the system and positivity of the solutions as well as the existence and uniqueness of a periodic solution for the model system are shown mathematically in asfaw 2018 let us now consider the special case where r t and a t are dependent on temperature and rainfall 3 temperature and rainfall temperature and rainfall have direct impact on the growth and development of both plants and herbivore population at high temperature the trans location of photosynthetic is faster so the plants tend to mature earlier in general plants can grow in a temperature range of 0 50 c the favorable or optimal day and night temperature range for plant growth and maximum yields varies among species evans et al 1985 the response in plants to an increase in temperature varies with the stage of plant growth heat stress affecting to a certain extent all vegetative and reproductive stages the observed effects depend on species and genotype with abundant inter and intra species variations of the plant coughenour 1991 heat stress induces changes in respiration and photosynthesis and thus leads to a shortened life cycle reynolds et al 2013 increased temperature increase lignification of plant tissues and reduce the digestibility and degradation of plant species which leads to reduced nutrient availability for herbivores getu 2014 temperature adjusts the metabolism and bodily processes of herbivores herbivore metabolic rates are highly sensitive to temperature increasing with an increase of 10 c across the full range of regularly experienced temperatures holl et al 2013 lemoine showed lemoine 2015 that increase in temperature also increases consumption rate and herbivore performance although the preference of herbivores on the feeding of plant species differs and the feeding time is shifted to cooler hours warming induced population outbreaks have been shown to arise from combination of accelerated development and reduced overwintering mortality holl et al 2013 generally temperature dependence of plants and herbivores for their growth and reproduction rates suggests potential effects of temperature abundance direct extensions of temperature dependent metabolic models to population abundance produce quantitative predictions for how change in temperature warming should affect plant and herbivore populations o connor et al 2011 the primary source of water for vegetation in most region of the world is rainfall the amount and distribution of rainfall have a strong impact on the development of plants podlesny and podlesna 2011 in many ecosystems particularly in grasslands and croplands seasonal plant growth occurs in perfect synchronization with the rainy season in times of drought vegetation in the ecosystem grows poorly if at all abundant rain leads to a burst of green excessive rainfall is not necessarily useful or desirable at all times the rate or amount in which it is received at a time could be too much for the environment some of it is unavoidably wasted while some may even be destructive a certain minimal amount of water is in fact needed to activate biological processes such as reproduction and seed germination if rainfall is concentrated in time over a certain region this minimum amount of soil water is intermittently exceeded and vegetation cover can persist in case rainfall is uniformly spread and soil moisture never exceeds the threshold needed to activate plant reproduction germination and vegetation cover tends to disappear 3 1 study area geographically ethiopia is the world s 27th largest country it lies between latitudes 3 and 15 n and between longitudes 33 and 48 e the country is located in the easternmost part of the african landmass its elevation and geographic location produce three broad climatic zones getu 2014 the cool zone above 2400 m 7900 ft above sea level where temperature ranges from near freezing to 16 c 32 61 f the temperate zone at elevations of 1500 to 2400 meters 4900 7900 ft above sea level with temperatures from 16 c to 30 c 61 86 f and the hot zone below 1500 meters 4900 ft above sea level with both tropical and arid conditions and daytime temperatures ranging from 27 c to 50 c 81 122 f getu 2014 ethiopia because of its geographical position ranges of altitude rainfall pattern and soil variability has an immense ecological diversity and a huge wealth of biological resources this complex topography coupled with environmental heterogeneity offers suitable environments for a wide range of life forms vegetation types in ethiopia are highly diverse ranging from afro alpine to desert vegetation iscaro 2014 asfaw and mesfin asfaw and tadesse 2001 indicated that the number of higher plant types in ethiopia is over 7000 species from which 12 are probably endemic for our study we chose the genale dawa river basin located in the southeastern part of ethiopia the river basin extends from 4 n 7 30 n and 38 00 e 44 00 e it represents the three major climatic zones of the country the cool zone temperate zone and hot lowlands the monthly rainfall distribution of the genale dawa river basin in the years 1996 2016 was collected from ethiopian national meteorology agency nma and the mean annual amount is plotted in fig 1 the blue region indicates places where annual rainfall is greater than 1200 mm this region is mainly the highland area where the bale mountains are located the red region indicates places where annual rainfall is less than 500 mm this region is mainly the hot lowland area where desert type conditions are observed 4 the growth rate r t r and feeding rate a r after the end of the rainy season in the study area the fields are green and herbivores are free to move to graze and browse therefore it is considered that there is a relationship between seasonal variation of temperature rainfall and plant growth and herbivore feeding rate in this model it is assumed that the intrinsic growth rate for plants and the feeding rate for herbivores are functions of temperature and rainfall the parameter r t r t r for the intrinsic growth rate of plants is defined in this study as r t r α r u r t v r r where u r t and v r r account for the effect of temperature and rainfall on a monthly growth rate of new plants the parameter α r represents the correction factor that keeps the rate between 0 and 1 a simultaneous increase in rainfall and temperature in a region results initially in availability of the required water level and heat that favours a steady growth of plant biomass up to the carrying capacity of the environment however the increase in both temperature and rainfall above the required limit will decrease the plant biomass in case of high temperature and low rainfall plants tend to dry or to be dormant until favorable conditions as the temperature rises in addition in case of high rainfall the nutrients in the soil will be washed away by floods or runoff hence plant growth rate decreases in both cases but avoiding the extreme cases the formula works well herbivores move around to graze their feed where a suitable time for them is when there is moderate temperature and low rainfall if the temperature is high they usually prefer to stay in shades during the day and change their time of feeding to cooler hours dusk or during the evening so we assumed that the feeding rate is not significantly affected by temperature however if the rainfall is high they prefer to stay in one place and not move around to graze moreover the soil will be water logged and lack of air prohibits plant growth or plants may die as a result of flooding hence their feeding rate is significantly affected by the variation in the rainfall similarly the consumption rate parameter a r is defined as a r α a y a r where y a r accounts for the effect of rainfall on the feeding rate of herbivores on plants furthermore α a represents the correction factor that keeps the rate between 0 and 1 large mammals have a smaller surface area to volume ratio as well as thicker skin boundary layers than that of smaller mammals because of this large mammals are less capable of dealing with extreme temperatures outside their thermoneutral zone as the ability to dissipate heat becomes more difficult it has been found in cattle that grazing and traveling creates three and five times more heat respectively compared to being idle and direct sun can produce two to four times higher thermal loads than shades vallance 2015 some studies such as vallance 2015 and references therein have looked at the temporal shift in activity levels with respect to temperature that during hot periods animals shift to being more active in feeding at cooler hours and less active during the day the temperature dependent component function u r t is defined as 3 u r t e t t r 2 σ 2 where 4 t t t av a sin ω t ϕ and t r is the most favorable temperature for the growth rate of plants to reach its maximum and σ is the standard deviation from the mean even though the feeding pattern of herbivores is affected by the temperature changes they have their own mechanism to overcome the problem such as shifting the time of feeding to dusk or to night times when the temperature is cooler hence the overall effect of temperature in the feeding rate is assumed to be negligible to capture the effect of rainfall as described above we used component functions 5 v r r e r r r 2 ν 2 6 y a r e r r a 2 υ 2 where 7 r t r av a sin ω t ϕ and r r is the rainfall when the growth rate of plants reaches its maximum ν is the standard deviation from r r r a is the rainfall when herbivore population feel comfortable to feed on the plants and υ is the standard deviation from r a depending on altitude the type of vegetation grass leaves shrub and type of herbivore cattle sheep goat camel differ in the three regions 4 1 cold highlands with annual rainfall 1200 mm from fig 1 areas with annual rainfall 1200 mm are the cool to cold humid highlands this place has a mosaic of croplands vegetation gonfa 1996 in this area vegetation growth starts increasing in june and reaches its maximum growth in september and october which is two months after the highest rainfall in july following the dry season december january and february the lowest vegetation growth is observed from december to may the coordinates of the places for the rainfall range 1200 mm indicated in blue in fig 1 were selected and the monthly rainfall data from 1996 2016 was collected average monthly rainfall for the 252 months in this geographic region is plotted against time using a continuous line in fig 2 and the fitted periodic function curve selected to be periodic on purpose is plotted alongside on the same figure in broken lines in fig 2 the fitted curve has the equation r t 117 4 126 sin 0 6t 2 with accuracy of 95 confidence interval where t is the number of months and 117 4 is the average mean rainfall of the region from this same region and coordinates the monthly maximum and minimum temperature data for the year 1994 to 2014 is collected from the ethiopian national meteorology agency average monthly temperature data for 252 months are plotted in fig 3 the corresponding fitted periodic function curve the broken line selected to be periodic on purpose is plotted alongside in the same figure in fig 3 in order to have a mathematical equation that approximates the data we used a matlab built in program to get t t 16 43 0 95 sin 0 5 t 0 6 where t is the number of months and 16 43 is the average temperature of the region this fitted equation gives a confidence interval of 95 the temperature ranges of cold highlands is from 6 75 c to 27 c we chose the most suitable time for growth rate t r 16 43 and using the equations of the fitted curves using the standard deviation α 10 we have the temperature dependent component of the growth rate as 8 u r t 0 8 exp t 16 43 2 10 2 9 t ave t 16 43 1 5 sin 0 6 t 0 05 fig 4 shows that at both extreme ends of the temperature plant growth rate decreases that is when it is cold below 10 c they loose the warmth of the soil and cannot grow and when it is hot above 24 c due to evaporation they loose a lot of water and plants go to dormancy or die for rainfall we chose the value r r 117 4 mm for which growth rate would reach its maximum with the standard deviation of ν 120 the feeding rate would reach its maximum at r a 200 mm with the standard deviation of υ 85 for the simulation hence we have 10 v r r 0 6 exp r 117 4 2 120 2 11 y a r 0 5 exp r 200 2 85 2 12 r t 117 4 100 sin 0 6 t 0 1 fig 5 shows that at both extreme ends of rainfall plant growth rate decreases that is when it is low lack of enough water plants cannot grow or die and when it is high flood soils will be water logged and lack of air prohibits plant growth or plants may die fig 6 shows that at both extreme ends of rainfall herbivore feeding rate decreases that is when it is low lack of enough water since herbivores need moisture in their feed and when it is high flood herbivores cannot move around and look for feed and or the plants themselves will be washed away and there is no feed therefore the growth rate of plants as a function of temperature and rainfall is defined as eq 13 and plotted in fig 7 where 13 r t r 0 4 exp t 16 4 2 10 2 exp r 117 4 2 120 2 the feeding rate of herbivores 1 1 here it is assumed that the feeding rate of herbivores is only a function of rainfall because in the case of extreme temperature they only change their grazing time and it is assumed that the rate remains almost the same on plants as a function of rainfall is defined as a r 1 675 exp r 200 2 85 2 once again the graphs of temperature and rainfall are assumed to be periodic functions of same period 1 year hence the growth rate function r t r and the feeding rate function a r are also periodic functions of same period as temperature and rainfall functions 1 year plants in this part of the study area are mostly moist evergreen and broad leaved but most of them are non palatable for the animals in the following using this time dependent parameters r t r and a r in the model system 1 and parameter values from table 1 we simulate and show the existence and stability of both populations in the cold highland region numerically from fig 8 one can observe that the plant population decreases as a result of herbivore population increase and a lot of plant biomass is consumed and or damaged then as the food source decreases the herbivore population also starts decreasing this gives the chance for the plant population to grow again and this cycle continues hence coexistence of plant and herbivore populations in the cold highland region is attained furthermore keeping the rainfall the same and varying the temperature from the minimum to maximum in that area varies the rate of growth and the feeding rate in the cold highlands of the genale dawa region if the rainfall amount varies by 10 increase or decrease by 10 the effect on the whole population dynamics is shown in figs 9 and 10 this means due to global climate change if we have up to 10 more rain in the area the herbivore population would disappear and go to extinction in this zone perhaps shifting their locations migration fig 10 4 2 hot lowlands with annual rainfall 500 mm area with annual rainfall 500 mm is hot semi arid lowlands gonfa 1996 this place has a sparse vegetation the hot lowland region has two rainy seasons the first is between march and may and the second is october to november lowest vegetation cover is observed in june and july following the dry months of may and june figs 11 and 12 for average monthly rainfall of the hot lowlands the original data from the red region in fig 1 is drawn in continuous line while the fitted curve is shown in the broken lines in the hot lowlands of genale dawa river basin the temperature ranges from 24 5 c to 38 c we chose the temperature suitable for the growth of plants in this area t to be 30 c and hence have the temperature dependent component of the growth rate which takes the same form as in the previous case except that the plants in this region require a different suitable temperature t to grow the expressions are given by 14 u r t 0 7 exp t 30 2 10 2 15 t t 26 92 1 5 sin 0 8 t 1 as the temperature increases more than t the plant growth rate decreases that is when it is very hot above 34 c due to evaporation they loose a lot of water and plants go to dormancy and loose their leaves to minimize loss of water or die we choose some values of rainfall for which growth rate would reach its maximum r r and the feeding rate would reach its maximum r a for the simulation 16 v r r 0 7 exp r 80 2 4000 17 y a r 1 85 exp r 107 2 4000 18 r t 40 40 sin 0 7 t 0 4 as rainfall increases plant growth rate also increases likewise as rainfall increases herbivore feeding rate also increases since herbivore prefer to consume food when there is moisture in it but as the rainfall reaches too much herbivore find it difficult to move around furthermore the soil will be water logged and lack of air prohibits plant growth as a result of the excess soil moisture therefore the growth rate of plants as a function of temperature and rainfall is given as r t r 0 7 exp t 30 2 10 2 0 7 exp r 80 2 4000 and is plotted in fig 13 the feeding rate of herbivores on plants as a function of rainfall is defined as a r 1 85 exp r 107 2 4000 and is plotted in fig 14 to study the dynamics of the interaction of plants and herbivore in the hot lowlands we use the temperature and rainfall dependent parameters the thresholds for the coexistence of both plant and herbivore populations are discussed furthermore to study the significance of the parameters in the time dependent parameter expressions we use the model 1 with the time dependent parameters r t r and a r in fig 15 one can observe that the plant population starts decreasing as the herbivore population increases this is due to the increased consumption by herbivores as the plant population decreases the herbivore population also decreases as it depends on the availability of feed once again as the herbivore population decreases the plant population starts growing again this cycle continues and it shows the coexistence of plant and herbivore populations in the hot lowlands in the genale dawa plants in hot lowland areas usually grow along the river courses vegetation type is savanna grassland and non palatable bush even though it is green a good part of it is not palatable to herbivores the type of herbivore in the hot lowlands includes goats and camels therefore they have a natural mechanism to stand the temperature and adjust themselves to the hotness of the place so that they can exist in the region it needs the attention of the environment conservation authorities or the government to intervene because the hot lowland area in the genale dawa basin is now expanding to the areas of the temperate zone this might result in the desertification of the region in the hot lowlands if the maximum temperature continues for sometimes while the rainfall is increased by 10 percent one can see that there will be a better number of herbivore population and this drives the system dynamics to be more oscillatory see fig 16 on the other hand if the rainfall decreases by as small as 1 5 then the herbivore population will disappear in this zone and go to extinction or migrate to other regions see fig 17 this should be given much attention since this climatic zone is expanding the herbivores in the area might be at real risk 4 3 sub tropic zone with annual rainfall 501 800 mm the region with annual rainfall between 501 mm and 800 mm is the temperate cool sub humid highlands gonfa 1996 this region has a mosaic of forest shrubs grassland vegetation this area has its peak rainy season in july and august and its dry months are december through march vegetation cover starts increasing in may and reach its maximum in november the lowest vegetation cover of the region is in march immediately after the lowest rainfall in february figs 18 and 19 in the temperate zone the temperature ranges from 16 c to 31 c we chose the favorable temperature t to be 26 and we employed the same formula for the temperature dependent component of the growth rate as in 8 but with different suitable temperature due to the presence of different plant and herbivore species 19 u r t 0 8 exp t 26 2 30 2 20 t t 23 85 1 25 sin 0 6 t 0 1 a decrease in the plant growth rate as the temperature is above 29 can be justified due to evaporation they loose a lot of water and plants go to dormancy or die we chose suitable rainfall values and temperature values for which growth rate would reach its maximum and the feeding rate would reach its maximum for the simulation as 21 v r r 0 9 exp r 206 2 400 2 22 y a r 1 42 exp r 207 2 40 000 23 r t 45 43 sin 0 5 t 0 1 at the initial stage as the rainfall increases plant growth rate also increases and herbivore feeding rate increases that is when rainfall is low lack of enough water and when rainfall is high water logged condition herbivores cannot move around and look for food and or the plants themselves will be washed away and there is no food therefore the growth rate of plants as a function of temperature and rainfall can be expressed as r t r 0 8 exp t 26 2 30 2 0 9 exp r 206 2 400 2 and is plotted in fig 20 the feeding rate of herbivores on plants as a function of rainfall is defined as a r 1 85 exp r 107 2 4000 and is plotted in fig 21 to study the dynamics of the plant herbivore interaction in the temperate subtropic zone we use the model 1 with time dependent parameters r t r and a r in the model 1 we discuss the existence and stability of coexistence limit cycle fig 22 shows that it takes longer time for the herbivore population to grow and once it passes the allee effect reaches a certain amount it oscillates slightly around an average number plants in the subtropic temperate zone are usually scrub grass lands in the subtropic temperate zone of genale dawa basin there is a considerable human population that influence the dynamics there is crop production and hence in addition to grazing herbivore also use crop residue as a source of food to see the effect of temperature and rainfall keeping one constant and varying the other we do the following analysis if rainfall is fixed to the mean as it is and if temperature increases and decreases by 10 there is no significant change in the dynamics see fig 23 however if the temperature is kept to the average and if the rainfall increases decreases by as much as 10 there is a significant change in this region in the temperate zone the 10 increase in rainfall allows the plant to grow faster and this in turn encourage the fast emergence of herbivore but in this case life is short and fast on the other hand a 10 decrease in rainfall leads the herbivore to take a long time to exceed the allee constant and guarantee its existence in the region see fig 24 5 discussion and conclusion a mathematical model that takes the periodic variation of some of the essential climatic parameters is considered in this study using field data for temperature and rainfall the varying parameters are estimated as function of time in all the three climatic zones chosen we are able to use our proposed model 1 to show coexistence of plant and herbivore populations although the amplitudes the periods and phase angels are not similar it has shown coexistence in all the regions keeping the rainfall constant as the temperature varies by 10 upwards and downwards the growth rate parameter increases as a result we can observe variations in the whole dynamics of the plant herbivore interaction as the temperature varies periodically the population dynamics path is perturbed from its smooth path it was taking while considering a constant case see asfaw et al 2018 furthermore varying the amplitudes of the growth rate r t and the feeding rate a t results in the herbivore population extinction and plant population reaching the carrying capacity as altitude varies in the genale dawa river basin there are three climatic zones for the three climatic zones we can observe that there are different plant and animal species which can adapt themselves to the existing environment and sustain the coexistence in the cold highlands the number of herbivores is few because of the temperature constraint furthermore the plants in this region are mostly non palatable species in the hot lowlands the number of herbivore is again few because the rainfall or water shortage is the constraint moreover the number of herbivore is much smaller than the plant population since the plant needs just two rainy seasons to survive in the hot lowlands the herbivore population cannot grow appear in the picture quickly only because of availability of rainfall as there are cases to consider such as the allee effect a problem in the genale dawa river basin is that the hot lowland climatic region is likely to expand due to global climate change in the sub tropic temperate region we have better herbivore population because this part of the basin has high human population and therefore the herbivore feed on crop residues as a supplement acknowledgements the authors thank an anonymous referee of this journal whose suggestions greatly improved the quality of the paper this work is partially supported by the simon s foundation project based in botswana international university of science and technology m d a would like to thank the organization for women in science for the developing world owsd and sida swedish international development cooperation agency the international science program isp project based at addis ababa university for the support she received during the preparation of the manuscript she also thanks the ethiopian national meteorology agency 
25029,in ecology plant herbivore relationships are the crucial link generating animal biomass from mere sunlight through photosynthesis these interactions are basic in understanding ecology and evolution of virtually any ecosystem the relationship depends also on environmental factors like rainfall temperature and altitude understanding patterns of these environment dependent interactions will help to make better predictions and recommend possible conservation strategies many of existing mathematical models for plant herbivore interactions and their analysis do not include these environmental factors in this study a mathematical model that incorporates variations of some of the parameter values due to changes in temperature and rainfall is formulated and used to determine necessary threshold values for co existence to validate the results of the mathematical model real data from the genale dawa river basin in the southern part of ethiopia is collected and used the river basin represents the three major climatic zones of the country the cool zone temperate zone and hot lowlands numerical simulations were done using the collected data and it is observed that coexistence is possible in all the three regions but it is sensitive to the change in rainfall and temperature if the change is within 10 there is a possibility of population extinction hence this paper shows that co existence of population is highly dependent on the environmental changes 2010 msc 92d40 92b05 37b55 keywords plant herbivore interaction allee effect harvest equilibrium points non autonomous dynamical systems 1 introduction all living things get energy for their survival growth and development from water sunlight and their various sources of food the rule of nature for all living things in any ecosystem is based on the battle for survival and every species acts accordingly ho and pennings 2013 plants and herbivores comprise almost 50 of the organisms on earth and the interaction between them powerfully shapes communities and ecosystems coley 1998 many plant herbivore relationships can be fully described by complex often nonlinear relationships which can lead to a threshold whereby slight and apparently weak changes in processes operating at small scale can result in sudden and dramatic changes at larger scales choquenot and parkes 2001 holl et al 2013 understanding the effect of herbivores on whole plants and plant communities requires a detailed understanding of the complex relationships that drive small scale processes and the manner in which they interact to generate dynamics at larger scales barber and marquis 2011 global environmental change affects all living organisms with complex consequences for biodiversity ecosystem structure and function predicting generalities in the direction of such changes represents one of the major challenges in ecology it is well known that plants need water nutrients air warmth and sunlight to grow and their type and density is time dependent as there is a warm season versus cold season and dry season versus rainy season which vary in time in other words plant growth rate is a function of time consequently herbivore feeding rate can also be considered as a function of time in cases where grazing is the only means of food supply feeding rate can vary with seasons and herbivores feed better when there is moisture in their food temperature is a very important factor affecting herbivore performance and therefore should not be overlooked when predicting the impact on plant herbivore interactions ho and pennings 2013 it is important in regulating rates of physiological processes and influencing growth and development of plants not excessive but sufficient amount of heat is a basic prerequisite for life haferkamp 1987 every vital process in ecology is restricted to a certain temperature range and it has its own optimal operating temperature on either side of which performance declines however the level of other environmental factors such as moisture affect the condition of the temperature response rainfall is one of the most important abiotic factors that limits physiological processes and ecological adaptability of plants availability of water is a factor that limits growth and survival rate of plants plants obtain all the nutrients they need from the environment around them and rainfall plays an important role in this regard for instance being the natural way for plants to obtain moisture rainfall frees nutrients and materials in the soil the plants need to survive so that the roots absorb these particles by diffusion process rainwater is also used by plants alongside photosynthesis to make sugar and to carry it through the plant to feed individual cells these cells convert the sugar to produce leaves flowers and fruits haferkamp 1987 including the effect of environmental factors in the dynamics of the plant herbivore interaction remains a challenge so far however some researchers considered periodic mathematical models to study the contribution of climatic factors in predator prey models cui 2005 cushing 1977a 1977b ding et al 1995 gomez et al 1996 zhidong 1999 these models describe the interactions of predators and their prey using ordinary differential equations the first of such system of differential equation is the lotka volterra model the study of plant herbivore interactions through dynamical systems have been extended far beyond the initial lotka volterra model both in theory and modeling approach to address the whole aspect of the actual interactions classical approaches in constructing a plant herbivore model is based on the predator prey system see feng et al 2011 and the references therein general periodic models were studied for existence permanence and persistence of solutions in cui 2005 cushing 1977a in literature so far the environmental change effects on the plant herbivore interactions have been studied using models with constant death rate cushing 1977a or models with all parameters depending on time zhidong 1996 or without considering the allee effect and or the harvest rate butler and freedman 1981 these issues are addressed in this paper moreover we used field data from a suitably selected region and framed specific functional formulations to test the applicability of the model and to investigate specific effects of variation of temperature and rainfall in the region this work is a climate variation extension of a paper by the same authors asfaw et al 2018 which considers a similar mathematical model but with constant parameters in this paper we study a plant herbivore model by considering factors such as holling type ii feeding response of herbivores allee effect on the herbivore birth rate plant density dependent herbivore death rate and harvest rate we consider the herbivore self limiting logistic term in the idea of density dependent herbivore death rate this means the death rate of herbivore depends on availability of food plants hence it can never reach its carrying capacity as for the parameters we took only the plant growth rate r t and the herbivore feeding rate a t to be time dependent functions and we keep the remaining parameters constant we considered the climatic variation of rainfall and temperature through the time dependent parameters the paper is organized as follows in section 2 we propose and describe a general model with periodic plant growth and herbivore feeding rates to be studied in section 3 we discuss the general effect of temperature and rainfall on the plant herbivore interactions and describe the study area in section 4 numerical simulations are presented for plant herbivore interactions for the three different climatic zones in the last section we present our results discussions and conclusions 2 description of the general model with periodic plant growth and herbivore feeding rates for the formulation and analysis of the model we make the following assumptions based on the interaction of plants and herbivores a1 environmental changes and weather factors for example temperature rainfall etc have significant effects on the growth of plants therefore we assume that the growth rate of the plant r t is governed by the logistic equation in which the coefficients are periodic functions on account of seasonal variations a2 based on assumption a1 due to the periodic growth rate of plants we assume that the feeding or consumption rate of herbivores on plants a t is also periodic and is a continuous function of time under these assumptions let us consider the following predator prey type model for the plant herbivore interaction 1 dp dt r t p 1 p k a t p b p h dh dt h ca t p b p h h h d f p μ p 0 0 h 0 0 here p t represents plant biomass h t represents herbivore biomass r t represents time dependent intrinsic growth rate for plant population and a t denotes time dependent herbivore feeding rate on plant population the other parameters are positive constants independent of time representing carrying capacity of the environment k half saturation constant of herbivores feeding b conversion rate of the consumed plant into herbivore c allee constant h and harvest rate μ respectively we take these parameters as constants because the effect of temperature and rainfall in them is very insignificant to the level that it can be ignored the feeding rate is considered as a holling type ii functional response which is expressed as f p a t p b p in the second equation of the model system 1 the term d f p represents the density dependent herbivore death rate which is a decreasing function of the feeding response and is bounded by the minimum and the maximum death rates d 1 and d 2 asfaw et al 2018 it is given by d f p d 2 f p g f p which reduces after considering d f 0 d 2 and d f k d 1 to determine the constant g to 2 d f p d 2 k 1 d 1 d 2 b p p b k d 2 d 1 d 2 1 k 1 d 1 d 2 b p d 2 d 1 b k p hence we say d 1 d f p d 2 as in asfaw et al 2018 this plant density dependent herbivore death rate also contains in it the idea that since it depends on the availability of plants the herbivore dynamics follows the plant dynamics hence it will never reach its own carrying capacity moreover herbivore population reproduces sexually and therefore to reproduce or to give birth to a new herbivore existence of enough herbivore population is crucial and this is taken care of by the term h h h where h is the allee constant due to the fact that cf p h h h vanishes as h goes to extinction asfaw et al 2018 terry 2015 that is individual female herbivore will struggle to reproduce as the herbivore density falls to zero either because they cannot find a mate or because of a greater risk of inbreeding for the system to be mathematically and biologically meaningful we need to work on positive quantities for population or biomass variables hence we define the domain space by ω p h ℝ 2 p 0 h 0 where the population of both plants and herbivores takes values only from the first quadrant that is the positivity the mathematical analysis of model system 1 persistence and permanence of the system and positivity of the solutions as well as the existence and uniqueness of a periodic solution for the model system are shown mathematically in asfaw 2018 let us now consider the special case where r t and a t are dependent on temperature and rainfall 3 temperature and rainfall temperature and rainfall have direct impact on the growth and development of both plants and herbivore population at high temperature the trans location of photosynthetic is faster so the plants tend to mature earlier in general plants can grow in a temperature range of 0 50 c the favorable or optimal day and night temperature range for plant growth and maximum yields varies among species evans et al 1985 the response in plants to an increase in temperature varies with the stage of plant growth heat stress affecting to a certain extent all vegetative and reproductive stages the observed effects depend on species and genotype with abundant inter and intra species variations of the plant coughenour 1991 heat stress induces changes in respiration and photosynthesis and thus leads to a shortened life cycle reynolds et al 2013 increased temperature increase lignification of plant tissues and reduce the digestibility and degradation of plant species which leads to reduced nutrient availability for herbivores getu 2014 temperature adjusts the metabolism and bodily processes of herbivores herbivore metabolic rates are highly sensitive to temperature increasing with an increase of 10 c across the full range of regularly experienced temperatures holl et al 2013 lemoine showed lemoine 2015 that increase in temperature also increases consumption rate and herbivore performance although the preference of herbivores on the feeding of plant species differs and the feeding time is shifted to cooler hours warming induced population outbreaks have been shown to arise from combination of accelerated development and reduced overwintering mortality holl et al 2013 generally temperature dependence of plants and herbivores for their growth and reproduction rates suggests potential effects of temperature abundance direct extensions of temperature dependent metabolic models to population abundance produce quantitative predictions for how change in temperature warming should affect plant and herbivore populations o connor et al 2011 the primary source of water for vegetation in most region of the world is rainfall the amount and distribution of rainfall have a strong impact on the development of plants podlesny and podlesna 2011 in many ecosystems particularly in grasslands and croplands seasonal plant growth occurs in perfect synchronization with the rainy season in times of drought vegetation in the ecosystem grows poorly if at all abundant rain leads to a burst of green excessive rainfall is not necessarily useful or desirable at all times the rate or amount in which it is received at a time could be too much for the environment some of it is unavoidably wasted while some may even be destructive a certain minimal amount of water is in fact needed to activate biological processes such as reproduction and seed germination if rainfall is concentrated in time over a certain region this minimum amount of soil water is intermittently exceeded and vegetation cover can persist in case rainfall is uniformly spread and soil moisture never exceeds the threshold needed to activate plant reproduction germination and vegetation cover tends to disappear 3 1 study area geographically ethiopia is the world s 27th largest country it lies between latitudes 3 and 15 n and between longitudes 33 and 48 e the country is located in the easternmost part of the african landmass its elevation and geographic location produce three broad climatic zones getu 2014 the cool zone above 2400 m 7900 ft above sea level where temperature ranges from near freezing to 16 c 32 61 f the temperate zone at elevations of 1500 to 2400 meters 4900 7900 ft above sea level with temperatures from 16 c to 30 c 61 86 f and the hot zone below 1500 meters 4900 ft above sea level with both tropical and arid conditions and daytime temperatures ranging from 27 c to 50 c 81 122 f getu 2014 ethiopia because of its geographical position ranges of altitude rainfall pattern and soil variability has an immense ecological diversity and a huge wealth of biological resources this complex topography coupled with environmental heterogeneity offers suitable environments for a wide range of life forms vegetation types in ethiopia are highly diverse ranging from afro alpine to desert vegetation iscaro 2014 asfaw and mesfin asfaw and tadesse 2001 indicated that the number of higher plant types in ethiopia is over 7000 species from which 12 are probably endemic for our study we chose the genale dawa river basin located in the southeastern part of ethiopia the river basin extends from 4 n 7 30 n and 38 00 e 44 00 e it represents the three major climatic zones of the country the cool zone temperate zone and hot lowlands the monthly rainfall distribution of the genale dawa river basin in the years 1996 2016 was collected from ethiopian national meteorology agency nma and the mean annual amount is plotted in fig 1 the blue region indicates places where annual rainfall is greater than 1200 mm this region is mainly the highland area where the bale mountains are located the red region indicates places where annual rainfall is less than 500 mm this region is mainly the hot lowland area where desert type conditions are observed 4 the growth rate r t r and feeding rate a r after the end of the rainy season in the study area the fields are green and herbivores are free to move to graze and browse therefore it is considered that there is a relationship between seasonal variation of temperature rainfall and plant growth and herbivore feeding rate in this model it is assumed that the intrinsic growth rate for plants and the feeding rate for herbivores are functions of temperature and rainfall the parameter r t r t r for the intrinsic growth rate of plants is defined in this study as r t r α r u r t v r r where u r t and v r r account for the effect of temperature and rainfall on a monthly growth rate of new plants the parameter α r represents the correction factor that keeps the rate between 0 and 1 a simultaneous increase in rainfall and temperature in a region results initially in availability of the required water level and heat that favours a steady growth of plant biomass up to the carrying capacity of the environment however the increase in both temperature and rainfall above the required limit will decrease the plant biomass in case of high temperature and low rainfall plants tend to dry or to be dormant until favorable conditions as the temperature rises in addition in case of high rainfall the nutrients in the soil will be washed away by floods or runoff hence plant growth rate decreases in both cases but avoiding the extreme cases the formula works well herbivores move around to graze their feed where a suitable time for them is when there is moderate temperature and low rainfall if the temperature is high they usually prefer to stay in shades during the day and change their time of feeding to cooler hours dusk or during the evening so we assumed that the feeding rate is not significantly affected by temperature however if the rainfall is high they prefer to stay in one place and not move around to graze moreover the soil will be water logged and lack of air prohibits plant growth or plants may die as a result of flooding hence their feeding rate is significantly affected by the variation in the rainfall similarly the consumption rate parameter a r is defined as a r α a y a r where y a r accounts for the effect of rainfall on the feeding rate of herbivores on plants furthermore α a represents the correction factor that keeps the rate between 0 and 1 large mammals have a smaller surface area to volume ratio as well as thicker skin boundary layers than that of smaller mammals because of this large mammals are less capable of dealing with extreme temperatures outside their thermoneutral zone as the ability to dissipate heat becomes more difficult it has been found in cattle that grazing and traveling creates three and five times more heat respectively compared to being idle and direct sun can produce two to four times higher thermal loads than shades vallance 2015 some studies such as vallance 2015 and references therein have looked at the temporal shift in activity levels with respect to temperature that during hot periods animals shift to being more active in feeding at cooler hours and less active during the day the temperature dependent component function u r t is defined as 3 u r t e t t r 2 σ 2 where 4 t t t av a sin ω t ϕ and t r is the most favorable temperature for the growth rate of plants to reach its maximum and σ is the standard deviation from the mean even though the feeding pattern of herbivores is affected by the temperature changes they have their own mechanism to overcome the problem such as shifting the time of feeding to dusk or to night times when the temperature is cooler hence the overall effect of temperature in the feeding rate is assumed to be negligible to capture the effect of rainfall as described above we used component functions 5 v r r e r r r 2 ν 2 6 y a r e r r a 2 υ 2 where 7 r t r av a sin ω t ϕ and r r is the rainfall when the growth rate of plants reaches its maximum ν is the standard deviation from r r r a is the rainfall when herbivore population feel comfortable to feed on the plants and υ is the standard deviation from r a depending on altitude the type of vegetation grass leaves shrub and type of herbivore cattle sheep goat camel differ in the three regions 4 1 cold highlands with annual rainfall 1200 mm from fig 1 areas with annual rainfall 1200 mm are the cool to cold humid highlands this place has a mosaic of croplands vegetation gonfa 1996 in this area vegetation growth starts increasing in june and reaches its maximum growth in september and october which is two months after the highest rainfall in july following the dry season december january and february the lowest vegetation growth is observed from december to may the coordinates of the places for the rainfall range 1200 mm indicated in blue in fig 1 were selected and the monthly rainfall data from 1996 2016 was collected average monthly rainfall for the 252 months in this geographic region is plotted against time using a continuous line in fig 2 and the fitted periodic function curve selected to be periodic on purpose is plotted alongside on the same figure in broken lines in fig 2 the fitted curve has the equation r t 117 4 126 sin 0 6t 2 with accuracy of 95 confidence interval where t is the number of months and 117 4 is the average mean rainfall of the region from this same region and coordinates the monthly maximum and minimum temperature data for the year 1994 to 2014 is collected from the ethiopian national meteorology agency average monthly temperature data for 252 months are plotted in fig 3 the corresponding fitted periodic function curve the broken line selected to be periodic on purpose is plotted alongside in the same figure in fig 3 in order to have a mathematical equation that approximates the data we used a matlab built in program to get t t 16 43 0 95 sin 0 5 t 0 6 where t is the number of months and 16 43 is the average temperature of the region this fitted equation gives a confidence interval of 95 the temperature ranges of cold highlands is from 6 75 c to 27 c we chose the most suitable time for growth rate t r 16 43 and using the equations of the fitted curves using the standard deviation α 10 we have the temperature dependent component of the growth rate as 8 u r t 0 8 exp t 16 43 2 10 2 9 t ave t 16 43 1 5 sin 0 6 t 0 05 fig 4 shows that at both extreme ends of the temperature plant growth rate decreases that is when it is cold below 10 c they loose the warmth of the soil and cannot grow and when it is hot above 24 c due to evaporation they loose a lot of water and plants go to dormancy or die for rainfall we chose the value r r 117 4 mm for which growth rate would reach its maximum with the standard deviation of ν 120 the feeding rate would reach its maximum at r a 200 mm with the standard deviation of υ 85 for the simulation hence we have 10 v r r 0 6 exp r 117 4 2 120 2 11 y a r 0 5 exp r 200 2 85 2 12 r t 117 4 100 sin 0 6 t 0 1 fig 5 shows that at both extreme ends of rainfall plant growth rate decreases that is when it is low lack of enough water plants cannot grow or die and when it is high flood soils will be water logged and lack of air prohibits plant growth or plants may die fig 6 shows that at both extreme ends of rainfall herbivore feeding rate decreases that is when it is low lack of enough water since herbivores need moisture in their feed and when it is high flood herbivores cannot move around and look for feed and or the plants themselves will be washed away and there is no feed therefore the growth rate of plants as a function of temperature and rainfall is defined as eq 13 and plotted in fig 7 where 13 r t r 0 4 exp t 16 4 2 10 2 exp r 117 4 2 120 2 the feeding rate of herbivores 1 1 here it is assumed that the feeding rate of herbivores is only a function of rainfall because in the case of extreme temperature they only change their grazing time and it is assumed that the rate remains almost the same on plants as a function of rainfall is defined as a r 1 675 exp r 200 2 85 2 once again the graphs of temperature and rainfall are assumed to be periodic functions of same period 1 year hence the growth rate function r t r and the feeding rate function a r are also periodic functions of same period as temperature and rainfall functions 1 year plants in this part of the study area are mostly moist evergreen and broad leaved but most of them are non palatable for the animals in the following using this time dependent parameters r t r and a r in the model system 1 and parameter values from table 1 we simulate and show the existence and stability of both populations in the cold highland region numerically from fig 8 one can observe that the plant population decreases as a result of herbivore population increase and a lot of plant biomass is consumed and or damaged then as the food source decreases the herbivore population also starts decreasing this gives the chance for the plant population to grow again and this cycle continues hence coexistence of plant and herbivore populations in the cold highland region is attained furthermore keeping the rainfall the same and varying the temperature from the minimum to maximum in that area varies the rate of growth and the feeding rate in the cold highlands of the genale dawa region if the rainfall amount varies by 10 increase or decrease by 10 the effect on the whole population dynamics is shown in figs 9 and 10 this means due to global climate change if we have up to 10 more rain in the area the herbivore population would disappear and go to extinction in this zone perhaps shifting their locations migration fig 10 4 2 hot lowlands with annual rainfall 500 mm area with annual rainfall 500 mm is hot semi arid lowlands gonfa 1996 this place has a sparse vegetation the hot lowland region has two rainy seasons the first is between march and may and the second is october to november lowest vegetation cover is observed in june and july following the dry months of may and june figs 11 and 12 for average monthly rainfall of the hot lowlands the original data from the red region in fig 1 is drawn in continuous line while the fitted curve is shown in the broken lines in the hot lowlands of genale dawa river basin the temperature ranges from 24 5 c to 38 c we chose the temperature suitable for the growth of plants in this area t to be 30 c and hence have the temperature dependent component of the growth rate which takes the same form as in the previous case except that the plants in this region require a different suitable temperature t to grow the expressions are given by 14 u r t 0 7 exp t 30 2 10 2 15 t t 26 92 1 5 sin 0 8 t 1 as the temperature increases more than t the plant growth rate decreases that is when it is very hot above 34 c due to evaporation they loose a lot of water and plants go to dormancy and loose their leaves to minimize loss of water or die we choose some values of rainfall for which growth rate would reach its maximum r r and the feeding rate would reach its maximum r a for the simulation 16 v r r 0 7 exp r 80 2 4000 17 y a r 1 85 exp r 107 2 4000 18 r t 40 40 sin 0 7 t 0 4 as rainfall increases plant growth rate also increases likewise as rainfall increases herbivore feeding rate also increases since herbivore prefer to consume food when there is moisture in it but as the rainfall reaches too much herbivore find it difficult to move around furthermore the soil will be water logged and lack of air prohibits plant growth as a result of the excess soil moisture therefore the growth rate of plants as a function of temperature and rainfall is given as r t r 0 7 exp t 30 2 10 2 0 7 exp r 80 2 4000 and is plotted in fig 13 the feeding rate of herbivores on plants as a function of rainfall is defined as a r 1 85 exp r 107 2 4000 and is plotted in fig 14 to study the dynamics of the interaction of plants and herbivore in the hot lowlands we use the temperature and rainfall dependent parameters the thresholds for the coexistence of both plant and herbivore populations are discussed furthermore to study the significance of the parameters in the time dependent parameter expressions we use the model 1 with the time dependent parameters r t r and a r in fig 15 one can observe that the plant population starts decreasing as the herbivore population increases this is due to the increased consumption by herbivores as the plant population decreases the herbivore population also decreases as it depends on the availability of feed once again as the herbivore population decreases the plant population starts growing again this cycle continues and it shows the coexistence of plant and herbivore populations in the hot lowlands in the genale dawa plants in hot lowland areas usually grow along the river courses vegetation type is savanna grassland and non palatable bush even though it is green a good part of it is not palatable to herbivores the type of herbivore in the hot lowlands includes goats and camels therefore they have a natural mechanism to stand the temperature and adjust themselves to the hotness of the place so that they can exist in the region it needs the attention of the environment conservation authorities or the government to intervene because the hot lowland area in the genale dawa basin is now expanding to the areas of the temperate zone this might result in the desertification of the region in the hot lowlands if the maximum temperature continues for sometimes while the rainfall is increased by 10 percent one can see that there will be a better number of herbivore population and this drives the system dynamics to be more oscillatory see fig 16 on the other hand if the rainfall decreases by as small as 1 5 then the herbivore population will disappear in this zone and go to extinction or migrate to other regions see fig 17 this should be given much attention since this climatic zone is expanding the herbivores in the area might be at real risk 4 3 sub tropic zone with annual rainfall 501 800 mm the region with annual rainfall between 501 mm and 800 mm is the temperate cool sub humid highlands gonfa 1996 this region has a mosaic of forest shrubs grassland vegetation this area has its peak rainy season in july and august and its dry months are december through march vegetation cover starts increasing in may and reach its maximum in november the lowest vegetation cover of the region is in march immediately after the lowest rainfall in february figs 18 and 19 in the temperate zone the temperature ranges from 16 c to 31 c we chose the favorable temperature t to be 26 and we employed the same formula for the temperature dependent component of the growth rate as in 8 but with different suitable temperature due to the presence of different plant and herbivore species 19 u r t 0 8 exp t 26 2 30 2 20 t t 23 85 1 25 sin 0 6 t 0 1 a decrease in the plant growth rate as the temperature is above 29 can be justified due to evaporation they loose a lot of water and plants go to dormancy or die we chose suitable rainfall values and temperature values for which growth rate would reach its maximum and the feeding rate would reach its maximum for the simulation as 21 v r r 0 9 exp r 206 2 400 2 22 y a r 1 42 exp r 207 2 40 000 23 r t 45 43 sin 0 5 t 0 1 at the initial stage as the rainfall increases plant growth rate also increases and herbivore feeding rate increases that is when rainfall is low lack of enough water and when rainfall is high water logged condition herbivores cannot move around and look for food and or the plants themselves will be washed away and there is no food therefore the growth rate of plants as a function of temperature and rainfall can be expressed as r t r 0 8 exp t 26 2 30 2 0 9 exp r 206 2 400 2 and is plotted in fig 20 the feeding rate of herbivores on plants as a function of rainfall is defined as a r 1 85 exp r 107 2 4000 and is plotted in fig 21 to study the dynamics of the plant herbivore interaction in the temperate subtropic zone we use the model 1 with time dependent parameters r t r and a r in the model 1 we discuss the existence and stability of coexistence limit cycle fig 22 shows that it takes longer time for the herbivore population to grow and once it passes the allee effect reaches a certain amount it oscillates slightly around an average number plants in the subtropic temperate zone are usually scrub grass lands in the subtropic temperate zone of genale dawa basin there is a considerable human population that influence the dynamics there is crop production and hence in addition to grazing herbivore also use crop residue as a source of food to see the effect of temperature and rainfall keeping one constant and varying the other we do the following analysis if rainfall is fixed to the mean as it is and if temperature increases and decreases by 10 there is no significant change in the dynamics see fig 23 however if the temperature is kept to the average and if the rainfall increases decreases by as much as 10 there is a significant change in this region in the temperate zone the 10 increase in rainfall allows the plant to grow faster and this in turn encourage the fast emergence of herbivore but in this case life is short and fast on the other hand a 10 decrease in rainfall leads the herbivore to take a long time to exceed the allee constant and guarantee its existence in the region see fig 24 5 discussion and conclusion a mathematical model that takes the periodic variation of some of the essential climatic parameters is considered in this study using field data for temperature and rainfall the varying parameters are estimated as function of time in all the three climatic zones chosen we are able to use our proposed model 1 to show coexistence of plant and herbivore populations although the amplitudes the periods and phase angels are not similar it has shown coexistence in all the regions keeping the rainfall constant as the temperature varies by 10 upwards and downwards the growth rate parameter increases as a result we can observe variations in the whole dynamics of the plant herbivore interaction as the temperature varies periodically the population dynamics path is perturbed from its smooth path it was taking while considering a constant case see asfaw et al 2018 furthermore varying the amplitudes of the growth rate r t and the feeding rate a t results in the herbivore population extinction and plant population reaching the carrying capacity as altitude varies in the genale dawa river basin there are three climatic zones for the three climatic zones we can observe that there are different plant and animal species which can adapt themselves to the existing environment and sustain the coexistence in the cold highlands the number of herbivores is few because of the temperature constraint furthermore the plants in this region are mostly non palatable species in the hot lowlands the number of herbivore is again few because the rainfall or water shortage is the constraint moreover the number of herbivore is much smaller than the plant population since the plant needs just two rainy seasons to survive in the hot lowlands the herbivore population cannot grow appear in the picture quickly only because of availability of rainfall as there are cases to consider such as the allee effect a problem in the genale dawa river basin is that the hot lowland climatic region is likely to expand due to global climate change in the sub tropic temperate region we have better herbivore population because this part of the basin has high human population and therefore the herbivore feed on crop residues as a supplement acknowledgements the authors thank an anonymous referee of this journal whose suggestions greatly improved the quality of the paper this work is partially supported by the simon s foundation project based in botswana international university of science and technology m d a would like to thank the organization for women in science for the developing world owsd and sida swedish international development cooperation agency the international science program isp project based at addis ababa university for the support she received during the preparation of the manuscript she also thanks the ethiopian national meteorology agency 
