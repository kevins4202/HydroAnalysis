index,text
20275,the autonomous underwater vehicle auv studied in this paper can land and rest on the seafloor using a mooring system in order to analyze its landing strategies and influencing factors kinematics and dynamics models of three dimensional motion of the auv are established forces mathematic models of variable buoyancy system and vertical thrusters are developed and control algorithm of vertical thrusters is designed based on the above mentioned models landing simulation system is built using s function of matlab two kinds of landing strategies of the auv with mooring system are proposed i e diving freely under the effect of negative buoyancy and landing under the control of vertical thrusters on these bases the effects of mass and position of the water entering into the auv on landing parameters are analyzed finally the influences of vertical thrusters on landing process are discussed through comparing the two landing strategies keywords autonomous underwater vehicle landing strategy mooring system variable buoyancy system vertical thruster rest on the seafloor 1 introduction in order to survey the environment of a specific sea area a long term investigation is needed marine exploration ship and remote operated vehicle rov can meet such a requirement but a lot of human and financial resources are needed to solve this problem the naval postgraduate school nps proposed an auv that can land and rest on the seafloor healey and marco 1992 the auv that can land and rest on the seafloor can reach the port or strait that needs to be detected after a long range and low speed sail and survey the environment in a low power state resting on the seafloor the way of the auv resting on the seafloor is a static balanced mode it overcomes the shortcomings of hovering auvs which are in an instant balance mode consuming enormous energy and unable to work for a long time this kind of auv shows a lot of advantages such as low detected small volume convenient deployment recyclable and long continuous working hours the auv studied in this paper is an under actuated system with nonlinear time varying and uncertain dynamics model and its control plane provide extremely small forces at low speeds therefore it is important to research how to land safely the nps auv is equipped with a variable buoyancy system and vertical thrusters in order to land softly dynamics model of the nps auv was established and the landing process was simulated using the parameters of the nps phoenix auv riedel et al 2005 ocean explorer ii landed just using a variable buoyancy system stewart et al 2001 in order to find a flat landing site sangekar et al 2010 2011 designed an imaging system equipped with laser sensors and the auv can land at a low speed under the control of vertical thrusters and little negative buoyancy discus glider landed by changing the negative buoyancy by adjusting the mass of water in ballast tanks niewiadomska et al 2003 hou 2006 and wang et al 2008 2009 made research on landing strategy of auv with variable buoyancy system auv vbs and proposed four landing strategies including free landing with water injection landing with controlled water injection free landing with water injection after diving to a specific place two way plan fixed point landing strategy they analyzed landing velocities and pitch angles of the first three strategies and simulated trajectory of the last strategy zhang et al 2018 designed a layout of landing gears for an underwater glider that can rest on the seafloor using a novel optimization process zhu et al 2017 established the kinematic and dynamic mathematical models of the auv that can rest on the seafloor with supporting mechanics and studied the effects of mass and position of water entering into the auv on landing parameters zhu et al 2018 established a mathematical model of 6 dof motion of the auv with a mooring system and analyzed its safety when resting on the seafloor some researches have been made on landing strategy of the auv however there is no analysis of the effects of specific factors on landing for the auv that can rest on the seafloor with the mooring system two landing strategies have been proposed in this paper i e free diving landing strategy and vertical thruster controlling landing strategy in order to provide a theoretical basis for designing and improving landing strategy and overall layout of the auv the influences of variable buoyancy system and vertical thrusters on landing strategy need to be analyzed 2 models of the auv the auv proposed by song et al 2010 fig 1 is taken as the study object and its main parameters are shown in table 1 in order to study the landing strategy and its influencing factors 6 dof motion model mathematical model of variable buoyancy system forces model and control algorithm of vertical thrusters are established 2 1 mathematical model of three dimensional motion in order to analyze the landing strategy and its influencing factors a mathematical model of three dimensional motion including kinematics and dynamics models yu et al 2018 should be developed coordinate systems should be selected in order to establish the motion model fig 2 illustrates coordinate systems adopted in this paper which include the earth fixed coordinate system e x e y e z e the body fixed frame b x y z and the velocity fixed frame b x 1 y 1 z 1 the origin of earth fixed coordinate system is located at the buoyancy center of the auv at the initial time the origin of body fixed coordinate system is always at the buoyancy center of the auv detail information of these coordinate systems and coordinate transformation matrix can refer to the book written by li 2007 kinematics model of the auv can be expressed as 1 η c η ν equation 1 can also be written as 2 r e ω c e b 0 3 3 0 3 3 r w b w e v b ω where η r e t ω t t is the generalized position vector at the buoyancy center of auv with respect to the earth fixed coordinate system r e x e y e z e t denotes the position vector at the buoyancy center of auv in the earth fix coordinate system and ω ψ θ φ t refers to the euler angles ν v b t ω t t signifies the generalized velocity vector at the buoyancy center of the auv in the body fixed frame v b v x v y v z t represents the translational velocity expressed in the body fixed frame and ω ω x ω y ω z t is the rotational velocity expressed in the body fixed frame c e b is the transformation matrix from the body fixed coordinate system to the earth fixed coordinate system r w b w e 0 sec θ cos φ sec θ sin φ 0 sin φ cos φ 1 tan θ cos φ tan θ sin φ dynamics model of the three dimensional motion of auv can be expressed as 3 a m a λ v a v w a m v a f m where a m is the matrix of mass and inertia moment a m m 0 0 0 m z c m y c 0 m 0 m z c 0 m x c 0 0 m m y c m x c 0 0 m z c m y c j x x j x y j x z m z c 0 m x c j y x j y y j y z m y c m x c 0 j z x j z y j z z where m is the mass of the auv x c y c z c denotes the coordinate of the gravity center in the body fixed frame and x c 0 y c 0 z c 0 j i j is the moment of inertia and j x y 0 j x z 0 j y z 0 a λ is the matrix of added mass v is the generalized velocity vector and a v w is the matrix of velocity v and angular velocity ω a λ λ 11 0 0 0 0 0 0 λ 22 0 0 0 λ 26 0 0 λ 33 0 λ 35 0 0 0 0 λ 44 0 0 0 0 λ 53 0 λ 55 0 0 λ 62 0 0 0 λ 66 v v x v y v z ω x ω y ω z a v w 0 ω z ω y ω z 0 ω x ω y ω x 0 0 0 0 0 0 0 0 0 0 0 v z v y v z 0 v x v y v x 0 0 ω z ω y ω z 0 ω x ω y ω x 0 a f m is the resultant external force and moments in the body fixed frame a f m f μ α f μ ω f b g f t where f μ α is the viscous position forces and moments on the vehicle in the body fixed frame f μ ω is the viscous damping forces and moments f b g is the forces and moments caused by gravity and buoyancy in the body fixed frame and f t is the forces and moments caused by propeller 2 2 forces of variable buoyancy system the usage of variable buoyancy system can change the negative buoyancy of the auv by drainage or feedwater parameters of the variable buoyancy system are key factors in the study of the auv landing strategies suppose x c a b s is the position of the variable buoyancy system in the body fixed frame δ g a b s is the weight of water entering into the variable buoyancy system and its direction is consistent with the direction of gravity the forces of variable buoyancy system on the auv in the body fixed frame can be expressed as 4 δ g a b s δ g a b s x δ g a b s y δ g a b s z c b e 0 δ g a b s 0 the position of the variable buoyancy system x c a b s in the body fixed frame can be given by x c a b s x c a b s y c a b s z c a b s t moments of variable buoyancy system on the auv in the body fixed coordinate system can be calculated as 5 m δ g a b s x c a b s δ g a b s 2 3 forces of vertical thrusters whether vertical thrusters should be installed is limited to the size of the auv the influences of vertical thrusters on landing parameters are key concerns in deciding whether vertical thrusters should be installed or not mathematical model of forces and control algorithm of vertical thrusters will be established as following suppose x c a t is the mounting position of vertical thrusters in the body fixed frame f a t is the force of a single vertical thruster and its direction is consistent with the direction of y axis of the body fixed frame components of vertical thruster force in the body fixed coordinate system can be expressed as 6 f a t 0 f a t 0 t the mounting position of vertical thrusters x c a t in the body fixed frame is given by x c a t x c a t 0 0 t moments of vertical thruster in the body fixed coordinate system can be calculated as 7 m a t x c a t f a t 2 4 control algorithm of vertical thrusters there are two vertical thrusters mounted on the auv which are respectively located on the fore hull and the aft hull appropriate control algorithm not only enables the attitude and velocity of the auv maintain within a certain range but also can save energy and reduce landing time according to the features of the auv the algorithm designed is presented in table 2 in this table and respectively indicate the upward and downward directions of vertical thrust force indicates that the vertical thruster does not provide any force the left symbol represents the back vertical thruster f a h the right one represents the front thruster f a q a is a flag variable in the control algorithm which values 0 or 1 3 landing strategies and simulation system modeling two landing strategies are proposed i e free diving landing strategy and vertical thruster controlling landing strategy a variable buoyancy system needs to be mounted to implement landing and resting on the seafloor because of nearly zero negative buoyancy of the auv when cruising auv landing simulation system is established using s function of matlab according to mathematical models of three dimensional motion variable buoyancy system and vertical thruster the numerical algorithm for solving the dynamic model is ode45 which represents fourth fifth order runge kutta algorithm hydrodynamic characteristics of the auv have been obtained by zhu et al 2012 using cfd method and the results are presented in fig 3 the added mass and damping coefficients are calculated using the formulas given in zhang 1998 3 1 free diving landing strategy the process of the free diving landing strategy can be described as following the propeller stops and rudders reset when the auv reaches the target area and then water enters into the variable buoyance system rapidly so that the time of water entering can be ignored then this vehicle will dive freely under the effect of negative buoyancy without any control fig 4 presents the landing process of free diving landing strategy the surge velocity of the vehicle will decelerate and the heave velocity will accelerate at first and finally both of them will reach equilibrium under the effect of hydrodynamics and negative buoyancy due to the initial velocity and lack of main propulsion force in order to verify the feasibility and correctness of the mathematical models the process of landing using free diving landing strategy is simulated by adopting the initial conditions of the auv v e x 5 k n x c a b s 0 85 m and δ g a b s 30 k g in order to show the stability of landing process the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 0005 m s2 in this case time histories of velocity and displacement during landing are presented in fig 5 angles of pitch and attack changing over time are given in fig 6 as seen in fig 5 the total speed v t and axial speed v e x of the auv firstly reduce rapidly and then keep steady the vertical speed v e y increases firstly and then keeps steady at a relatively small value which is convenient for the auv landing as seen in fig 6 the pitch angle fluctuates between 2 and 3 and the angle of attack fluctuates near 65 it can be found from the above analyses that at the end of the landing this auv moves with a low speed and a small pitch angle which means that the auv can land safely and stably the analysis also shows that this simulation system is applicable for simulation and analysis of free diving landing process of the auv 3 2 vertical thruster controlling landing strategy in order to control the attitude of the auv two vertical thrusters could be mounted on it in order to verify the feasibility and correctness of the mathematical models the process of landing using vertical thruster controlling landing strategy was simulated by adopting x c a b s 0 δ g a b s 10 k g the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 001 m s2 time histories of velocity and displacement during landing are presented in fig 7 angles of attitude and attack changing over time are showed in fig 8 actions of vertical thrusters are given in fig 9 as seen in fig 7 the total speed v t and axial speed v e x of the auv firstly reduce rapidly and then keep steady the vertical speed v e y increases firstly and then fluctuates around a certain small value which is convenient for the auv landing it can be found that in fig 8 the pitch angle θ fluctuates between 0 and 6 as showed in fig 9 both of the front and back thruster of the auv work intermittently it can be seen from the above analyses that at the end of the landing this auv moves with a low speed and a stable attitude and these show that the auv can land safely and stably the analysis also shows that this simulation system is applicable for simulation and analysis of the auv landing process with vertical thrusters 4 analysis of influencing factors on landing strategies the weight and position of water entering into the variable buoyancy system has a great effect on landing parameters for each landing strategy both of these two landing strategies are analyzed and the influence of vertical thruster on landing strategy is analyzed by comparing the results of these two landing strategies the method for analyzing the landing strategies in this paper is presented as following landing simulation system is built based on the mathematic models of the auv motion variable buoyancy system and vertical thruster values of attitude angle velocity landing time action time of vertical thrusters landing displacement and other parameters at the end of the landing process can be obtained based on the landing simulation system by applying specific values of influencing factors finally the influence of factors on landing strategy can be analyzed based on the results obtained above this article ignores the actions of wave and current to simplify the analysis of the problem so that the landing motion of this auv is a vertical planar motion under the effect of initial velocity inertial force negative buoyancy hydrodynamics and vertical thrusters the initial speed of this auv is set as 5 kn and the termination condition of the landing process adopts that the axial acceleration is less than 0 001 m s2 in the earth fixed coordinate system 4 1 free diving landing strategy research influencing factors of this landing strategy mainly include the weight and position of water entering into the variable buoyancy system in order to obtain the stable values of landing parameters the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 00001 m s2 in this subsection 4 1 1 effect of weight of water entering the other influence factor the position should be given a specific value when the effect of weight on the landing velocity and attitude angle is analyzed the position of water entering has a great impact on the pitch moment of the auv considering the size and cabin layout of this vehicle six conditions of different water entering position are analyzed which are x c a b s 1 m 0 5 m 0 m 0 5 m 1 m 1 5 m the tends of velocities and pitch angles for the cases x c a b s 1 m 0 5 m 0 m are similar and x c a b s 1 m 1 5 m are similar and thus results of the cases x c a b s 0 5 m 0 5 m 1 5 m are taken as examples curves of velocity and pitch angle at the end of the landing process changing with the weight of water entering into the auv of the cases x c a b s 0 5 m 0 5 m 1 5 m are respectively presented in fig 10 fig 11 and fig 12 as can be seen in fig 10 when x c a b s 0 5 m and the mass of water entering increases from 5 kg to 100 kg 1 the surge velocity increases from 0 9 m s to 3 5 m s 2 the heave speed increases from 0 6 m s to 1 8 m s 3 absolute value of the pitch angle decreases rapidly from θ 29 when δ g a b s 5 k g to θ 19 8 when δ g a b s 100 k g while the decreasing rate slows down gradually as can be seen in fig 11 when x c a b s 0 5 m and the mass of water entering increases from 5 kg to 100 kg 1 at first the surge velocity increases from 0 8 m s to 1 2 m s and then it nearly keeps constant 2 the heave speed increases from 0 45 m s to 0 8 m s 3 absolute value of the pitch angle decreases rapidly from θ 22 when δ g a b s 5 k g to θ 1 5 when δ g a b s 100 k g while the decreasing rate slows down gradually as can be seen in fig 12 when x c a b s 1 5 m and the mass of water entering increases from 5 kg to 25 kg 1 the surge velocity decreases from 0 68 m s to 0 1 m s 2 the heave speed increases from 0 3 m s to 0 5 m s 3 the pitch angle increases rapidly from θ 14 when δ g a b s 5 kg to θ 5 when δ g a b s 25 kg while the increasing rate slows down rapidly at δ g a b s 15 kg 4 1 2 effect of position of water entering four conditions of different mass of water entering have been analyzed which are δ g a b s 10 kg 20 kg 30 kg 40 kg the tends of velocities and pitch angles for the cases δ g a b s 10 kg 20 kg 30 kg 40 kg are similar and thus results of the case δ g a b s 30 kg are taken as examples curves of velocity and pitch angle at the end of landing process changing with position of water entering into the auv are presented in fig 13 as can be seen in fig 13 with the position of water entering moving forward 1 the surge velocity increases from 0 15 m s to 2 2 m s 2 heave speed is almost unchanged when x c a b s values between 1 2 m and 0 4 m while it increases from 0 5 m s to 1 6 m s when the position of water entering moves from 0 4 m to 1 m 3 pitch angle decreases rapidly from 7 to 32 4 2 vertical thruster controlling landing strategy heave speed and attitude can be kept in a safe range when there are vertical thrusters so the key research point of vertical thruster controlling landing strategy is no longer the velocity or attitude but the landing time landing distance and action time of vertical thrusters the influences of mass and position of water entering on the velocity displacement total landing time and action time of vertical thrusters when landing are analyzed in this section based on the simulation system built above the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 001 m s2 4 2 1 effect of weight of water entering the tends of velocities pitch angles total landing time and action time of vertical thrusters for the cases x c a b s 1 m 0 5 m 0 m 0 5 m 1 m 1 5 m are similar and thus results of the case x c a b s 0 5 m are taken as examples surge velocity and displacement in earth fixed coordinate system when landing changing with weight of water entering are presented in fig 14 total landing time and action time of vertical thrusters changing with weight of water entering is given in fig 15 as can be seen from these figures with the mass of water entering increasing from 2 5 kg to 45 kg 1 surge velocity gradually increases from 0 48 m s to 1 08 m s 2 surge displacement shows an overall downward trend decreasing from 125 m to 44 m 3 heave displacement is about 10 m 4 an overall downward trend of total landing time can be observed and it reduces from 127s to 28s 5 total action time of vertical thrusters has an overall w type trend and its minimum value is 6 s when δ g a b s 10 k g 4 2 2 effect of position of water entering the tends of results for the cases δ g a b s 10 kg 20 kg 30 kg 40 kg are similar and thus results of the cases δ g a b s 10 kg are taken as examples surge velocity and displacement in earth fixed coordinate system when landing changing with position of water entering are presented in fig 16 total landing time and action time of vertical thrusters changing with position of water entering are presented in fig 17 as can be seen from these figures when the position of water entering changes from 2 4 m to 1 m 1 surge velocity shows an overall upward trend and it increases from 0 23 m s to 0 86 m s 2 surge displacement has an overall v type trend xe 104 m when x c a b s 2 4 m xe 73 m when x c a b s 0 6 m and xe 97 m when 3 heave displacement is about 13 m 4 total landing time reduces at first and then keeps in a slightly fluctuant state with a maximum value of 142 s when x c a b s 1 8 m and a minimum value of 43 s when x c a b s 0 2 m 5 total action time of vertical thrusters reduces at first and then increases when x c a b s 0 8 m and reaches a minimum value of 2 s when x c a b s 0 8 m 4 3 analysis of effect of vertical thrusters on landing parameters influence of vertical thrusters on landing parameters can be obtained by comparing free diving landing strategy and vertical thruster controlling landing strategy a heave speed v e y there is a great influence of vertical thrusters on v e y and v e y can be kept in a safe range with vertical thrusters so that the auv can land safely b pitch angle θ there is a great influence of vertical thrusters on θ and θ can be kept in a safe range with vertical thrusters so that the auv can land safely c surge velocity v e x there is little influence of vertical thrusters on axial velocity as can be seen from the above vertical thrusters have great benefit on the control of heave speed and pitch angle it is suggested that vertical thruster controlling landing strategy should be adopted when there are vertical thrusters 5 conclusion mathematical models of three dimensional motion of the auv forces mathematic models of variable buoyancy system and vertical thrusters are established in this paper control algorithm of vertical thrusters is designed based on this a landing simulation system is established using s function of matlab two kinds of landing strategies of the auv with mooring system are proposed i e diving freely under the effect of negative buoyancy and landing under the control of vertical thrusters examples of both of these two landing strategies are given to verify the feasibility and correctness of these mathematical models on this basis effects of mass and position of water entering into the auv on landing parameters of free diving landing strategy are studied and rules of diving speed and pitching angle changing with mass and position are obtained effects of parameters of water entering on landing parameters of vertical thruster controlling landing strategy are studied and rules of diving speed landing distance total landing time and action time of vertical thrusters changing with mass and position are obtained finally the influences of vertical thrusters on landing strategy are analyzed by comparing these two landing strategies and these conclusions will provide a theoretical basis for the design and improvement of landing strategy and overall layout credit authorship contribution statement xinyao zhu conceptualization methodology software formal analysis writing original draft writing review editing baowei song validation investigation daiyu zhang supervision writing review editing shuqi wang data curation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this project is supported by the national natural science foundation of china under grant 51309125 and the doctoral scientific research foundation of jiangsu university of science and technology just under grant 1012931605 
20275,the autonomous underwater vehicle auv studied in this paper can land and rest on the seafloor using a mooring system in order to analyze its landing strategies and influencing factors kinematics and dynamics models of three dimensional motion of the auv are established forces mathematic models of variable buoyancy system and vertical thrusters are developed and control algorithm of vertical thrusters is designed based on the above mentioned models landing simulation system is built using s function of matlab two kinds of landing strategies of the auv with mooring system are proposed i e diving freely under the effect of negative buoyancy and landing under the control of vertical thrusters on these bases the effects of mass and position of the water entering into the auv on landing parameters are analyzed finally the influences of vertical thrusters on landing process are discussed through comparing the two landing strategies keywords autonomous underwater vehicle landing strategy mooring system variable buoyancy system vertical thruster rest on the seafloor 1 introduction in order to survey the environment of a specific sea area a long term investigation is needed marine exploration ship and remote operated vehicle rov can meet such a requirement but a lot of human and financial resources are needed to solve this problem the naval postgraduate school nps proposed an auv that can land and rest on the seafloor healey and marco 1992 the auv that can land and rest on the seafloor can reach the port or strait that needs to be detected after a long range and low speed sail and survey the environment in a low power state resting on the seafloor the way of the auv resting on the seafloor is a static balanced mode it overcomes the shortcomings of hovering auvs which are in an instant balance mode consuming enormous energy and unable to work for a long time this kind of auv shows a lot of advantages such as low detected small volume convenient deployment recyclable and long continuous working hours the auv studied in this paper is an under actuated system with nonlinear time varying and uncertain dynamics model and its control plane provide extremely small forces at low speeds therefore it is important to research how to land safely the nps auv is equipped with a variable buoyancy system and vertical thrusters in order to land softly dynamics model of the nps auv was established and the landing process was simulated using the parameters of the nps phoenix auv riedel et al 2005 ocean explorer ii landed just using a variable buoyancy system stewart et al 2001 in order to find a flat landing site sangekar et al 2010 2011 designed an imaging system equipped with laser sensors and the auv can land at a low speed under the control of vertical thrusters and little negative buoyancy discus glider landed by changing the negative buoyancy by adjusting the mass of water in ballast tanks niewiadomska et al 2003 hou 2006 and wang et al 2008 2009 made research on landing strategy of auv with variable buoyancy system auv vbs and proposed four landing strategies including free landing with water injection landing with controlled water injection free landing with water injection after diving to a specific place two way plan fixed point landing strategy they analyzed landing velocities and pitch angles of the first three strategies and simulated trajectory of the last strategy zhang et al 2018 designed a layout of landing gears for an underwater glider that can rest on the seafloor using a novel optimization process zhu et al 2017 established the kinematic and dynamic mathematical models of the auv that can rest on the seafloor with supporting mechanics and studied the effects of mass and position of water entering into the auv on landing parameters zhu et al 2018 established a mathematical model of 6 dof motion of the auv with a mooring system and analyzed its safety when resting on the seafloor some researches have been made on landing strategy of the auv however there is no analysis of the effects of specific factors on landing for the auv that can rest on the seafloor with the mooring system two landing strategies have been proposed in this paper i e free diving landing strategy and vertical thruster controlling landing strategy in order to provide a theoretical basis for designing and improving landing strategy and overall layout of the auv the influences of variable buoyancy system and vertical thrusters on landing strategy need to be analyzed 2 models of the auv the auv proposed by song et al 2010 fig 1 is taken as the study object and its main parameters are shown in table 1 in order to study the landing strategy and its influencing factors 6 dof motion model mathematical model of variable buoyancy system forces model and control algorithm of vertical thrusters are established 2 1 mathematical model of three dimensional motion in order to analyze the landing strategy and its influencing factors a mathematical model of three dimensional motion including kinematics and dynamics models yu et al 2018 should be developed coordinate systems should be selected in order to establish the motion model fig 2 illustrates coordinate systems adopted in this paper which include the earth fixed coordinate system e x e y e z e the body fixed frame b x y z and the velocity fixed frame b x 1 y 1 z 1 the origin of earth fixed coordinate system is located at the buoyancy center of the auv at the initial time the origin of body fixed coordinate system is always at the buoyancy center of the auv detail information of these coordinate systems and coordinate transformation matrix can refer to the book written by li 2007 kinematics model of the auv can be expressed as 1 η c η ν equation 1 can also be written as 2 r e ω c e b 0 3 3 0 3 3 r w b w e v b ω where η r e t ω t t is the generalized position vector at the buoyancy center of auv with respect to the earth fixed coordinate system r e x e y e z e t denotes the position vector at the buoyancy center of auv in the earth fix coordinate system and ω ψ θ φ t refers to the euler angles ν v b t ω t t signifies the generalized velocity vector at the buoyancy center of the auv in the body fixed frame v b v x v y v z t represents the translational velocity expressed in the body fixed frame and ω ω x ω y ω z t is the rotational velocity expressed in the body fixed frame c e b is the transformation matrix from the body fixed coordinate system to the earth fixed coordinate system r w b w e 0 sec θ cos φ sec θ sin φ 0 sin φ cos φ 1 tan θ cos φ tan θ sin φ dynamics model of the three dimensional motion of auv can be expressed as 3 a m a λ v a v w a m v a f m where a m is the matrix of mass and inertia moment a m m 0 0 0 m z c m y c 0 m 0 m z c 0 m x c 0 0 m m y c m x c 0 0 m z c m y c j x x j x y j x z m z c 0 m x c j y x j y y j y z m y c m x c 0 j z x j z y j z z where m is the mass of the auv x c y c z c denotes the coordinate of the gravity center in the body fixed frame and x c 0 y c 0 z c 0 j i j is the moment of inertia and j x y 0 j x z 0 j y z 0 a λ is the matrix of added mass v is the generalized velocity vector and a v w is the matrix of velocity v and angular velocity ω a λ λ 11 0 0 0 0 0 0 λ 22 0 0 0 λ 26 0 0 λ 33 0 λ 35 0 0 0 0 λ 44 0 0 0 0 λ 53 0 λ 55 0 0 λ 62 0 0 0 λ 66 v v x v y v z ω x ω y ω z a v w 0 ω z ω y ω z 0 ω x ω y ω x 0 0 0 0 0 0 0 0 0 0 0 v z v y v z 0 v x v y v x 0 0 ω z ω y ω z 0 ω x ω y ω x 0 a f m is the resultant external force and moments in the body fixed frame a f m f μ α f μ ω f b g f t where f μ α is the viscous position forces and moments on the vehicle in the body fixed frame f μ ω is the viscous damping forces and moments f b g is the forces and moments caused by gravity and buoyancy in the body fixed frame and f t is the forces and moments caused by propeller 2 2 forces of variable buoyancy system the usage of variable buoyancy system can change the negative buoyancy of the auv by drainage or feedwater parameters of the variable buoyancy system are key factors in the study of the auv landing strategies suppose x c a b s is the position of the variable buoyancy system in the body fixed frame δ g a b s is the weight of water entering into the variable buoyancy system and its direction is consistent with the direction of gravity the forces of variable buoyancy system on the auv in the body fixed frame can be expressed as 4 δ g a b s δ g a b s x δ g a b s y δ g a b s z c b e 0 δ g a b s 0 the position of the variable buoyancy system x c a b s in the body fixed frame can be given by x c a b s x c a b s y c a b s z c a b s t moments of variable buoyancy system on the auv in the body fixed coordinate system can be calculated as 5 m δ g a b s x c a b s δ g a b s 2 3 forces of vertical thrusters whether vertical thrusters should be installed is limited to the size of the auv the influences of vertical thrusters on landing parameters are key concerns in deciding whether vertical thrusters should be installed or not mathematical model of forces and control algorithm of vertical thrusters will be established as following suppose x c a t is the mounting position of vertical thrusters in the body fixed frame f a t is the force of a single vertical thruster and its direction is consistent with the direction of y axis of the body fixed frame components of vertical thruster force in the body fixed coordinate system can be expressed as 6 f a t 0 f a t 0 t the mounting position of vertical thrusters x c a t in the body fixed frame is given by x c a t x c a t 0 0 t moments of vertical thruster in the body fixed coordinate system can be calculated as 7 m a t x c a t f a t 2 4 control algorithm of vertical thrusters there are two vertical thrusters mounted on the auv which are respectively located on the fore hull and the aft hull appropriate control algorithm not only enables the attitude and velocity of the auv maintain within a certain range but also can save energy and reduce landing time according to the features of the auv the algorithm designed is presented in table 2 in this table and respectively indicate the upward and downward directions of vertical thrust force indicates that the vertical thruster does not provide any force the left symbol represents the back vertical thruster f a h the right one represents the front thruster f a q a is a flag variable in the control algorithm which values 0 or 1 3 landing strategies and simulation system modeling two landing strategies are proposed i e free diving landing strategy and vertical thruster controlling landing strategy a variable buoyancy system needs to be mounted to implement landing and resting on the seafloor because of nearly zero negative buoyancy of the auv when cruising auv landing simulation system is established using s function of matlab according to mathematical models of three dimensional motion variable buoyancy system and vertical thruster the numerical algorithm for solving the dynamic model is ode45 which represents fourth fifth order runge kutta algorithm hydrodynamic characteristics of the auv have been obtained by zhu et al 2012 using cfd method and the results are presented in fig 3 the added mass and damping coefficients are calculated using the formulas given in zhang 1998 3 1 free diving landing strategy the process of the free diving landing strategy can be described as following the propeller stops and rudders reset when the auv reaches the target area and then water enters into the variable buoyance system rapidly so that the time of water entering can be ignored then this vehicle will dive freely under the effect of negative buoyancy without any control fig 4 presents the landing process of free diving landing strategy the surge velocity of the vehicle will decelerate and the heave velocity will accelerate at first and finally both of them will reach equilibrium under the effect of hydrodynamics and negative buoyancy due to the initial velocity and lack of main propulsion force in order to verify the feasibility and correctness of the mathematical models the process of landing using free diving landing strategy is simulated by adopting the initial conditions of the auv v e x 5 k n x c a b s 0 85 m and δ g a b s 30 k g in order to show the stability of landing process the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 0005 m s2 in this case time histories of velocity and displacement during landing are presented in fig 5 angles of pitch and attack changing over time are given in fig 6 as seen in fig 5 the total speed v t and axial speed v e x of the auv firstly reduce rapidly and then keep steady the vertical speed v e y increases firstly and then keeps steady at a relatively small value which is convenient for the auv landing as seen in fig 6 the pitch angle fluctuates between 2 and 3 and the angle of attack fluctuates near 65 it can be found from the above analyses that at the end of the landing this auv moves with a low speed and a small pitch angle which means that the auv can land safely and stably the analysis also shows that this simulation system is applicable for simulation and analysis of free diving landing process of the auv 3 2 vertical thruster controlling landing strategy in order to control the attitude of the auv two vertical thrusters could be mounted on it in order to verify the feasibility and correctness of the mathematical models the process of landing using vertical thruster controlling landing strategy was simulated by adopting x c a b s 0 δ g a b s 10 k g the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 001 m s2 time histories of velocity and displacement during landing are presented in fig 7 angles of attitude and attack changing over time are showed in fig 8 actions of vertical thrusters are given in fig 9 as seen in fig 7 the total speed v t and axial speed v e x of the auv firstly reduce rapidly and then keep steady the vertical speed v e y increases firstly and then fluctuates around a certain small value which is convenient for the auv landing it can be found that in fig 8 the pitch angle θ fluctuates between 0 and 6 as showed in fig 9 both of the front and back thruster of the auv work intermittently it can be seen from the above analyses that at the end of the landing this auv moves with a low speed and a stable attitude and these show that the auv can land safely and stably the analysis also shows that this simulation system is applicable for simulation and analysis of the auv landing process with vertical thrusters 4 analysis of influencing factors on landing strategies the weight and position of water entering into the variable buoyancy system has a great effect on landing parameters for each landing strategy both of these two landing strategies are analyzed and the influence of vertical thruster on landing strategy is analyzed by comparing the results of these two landing strategies the method for analyzing the landing strategies in this paper is presented as following landing simulation system is built based on the mathematic models of the auv motion variable buoyancy system and vertical thruster values of attitude angle velocity landing time action time of vertical thrusters landing displacement and other parameters at the end of the landing process can be obtained based on the landing simulation system by applying specific values of influencing factors finally the influence of factors on landing strategy can be analyzed based on the results obtained above this article ignores the actions of wave and current to simplify the analysis of the problem so that the landing motion of this auv is a vertical planar motion under the effect of initial velocity inertial force negative buoyancy hydrodynamics and vertical thrusters the initial speed of this auv is set as 5 kn and the termination condition of the landing process adopts that the axial acceleration is less than 0 001 m s2 in the earth fixed coordinate system 4 1 free diving landing strategy research influencing factors of this landing strategy mainly include the weight and position of water entering into the variable buoyancy system in order to obtain the stable values of landing parameters the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 00001 m s2 in this subsection 4 1 1 effect of weight of water entering the other influence factor the position should be given a specific value when the effect of weight on the landing velocity and attitude angle is analyzed the position of water entering has a great impact on the pitch moment of the auv considering the size and cabin layout of this vehicle six conditions of different water entering position are analyzed which are x c a b s 1 m 0 5 m 0 m 0 5 m 1 m 1 5 m the tends of velocities and pitch angles for the cases x c a b s 1 m 0 5 m 0 m are similar and x c a b s 1 m 1 5 m are similar and thus results of the cases x c a b s 0 5 m 0 5 m 1 5 m are taken as examples curves of velocity and pitch angle at the end of the landing process changing with the weight of water entering into the auv of the cases x c a b s 0 5 m 0 5 m 1 5 m are respectively presented in fig 10 fig 11 and fig 12 as can be seen in fig 10 when x c a b s 0 5 m and the mass of water entering increases from 5 kg to 100 kg 1 the surge velocity increases from 0 9 m s to 3 5 m s 2 the heave speed increases from 0 6 m s to 1 8 m s 3 absolute value of the pitch angle decreases rapidly from θ 29 when δ g a b s 5 k g to θ 19 8 when δ g a b s 100 k g while the decreasing rate slows down gradually as can be seen in fig 11 when x c a b s 0 5 m and the mass of water entering increases from 5 kg to 100 kg 1 at first the surge velocity increases from 0 8 m s to 1 2 m s and then it nearly keeps constant 2 the heave speed increases from 0 45 m s to 0 8 m s 3 absolute value of the pitch angle decreases rapidly from θ 22 when δ g a b s 5 k g to θ 1 5 when δ g a b s 100 k g while the decreasing rate slows down gradually as can be seen in fig 12 when x c a b s 1 5 m and the mass of water entering increases from 5 kg to 25 kg 1 the surge velocity decreases from 0 68 m s to 0 1 m s 2 the heave speed increases from 0 3 m s to 0 5 m s 3 the pitch angle increases rapidly from θ 14 when δ g a b s 5 kg to θ 5 when δ g a b s 25 kg while the increasing rate slows down rapidly at δ g a b s 15 kg 4 1 2 effect of position of water entering four conditions of different mass of water entering have been analyzed which are δ g a b s 10 kg 20 kg 30 kg 40 kg the tends of velocities and pitch angles for the cases δ g a b s 10 kg 20 kg 30 kg 40 kg are similar and thus results of the case δ g a b s 30 kg are taken as examples curves of velocity and pitch angle at the end of landing process changing with position of water entering into the auv are presented in fig 13 as can be seen in fig 13 with the position of water entering moving forward 1 the surge velocity increases from 0 15 m s to 2 2 m s 2 heave speed is almost unchanged when x c a b s values between 1 2 m and 0 4 m while it increases from 0 5 m s to 1 6 m s when the position of water entering moves from 0 4 m to 1 m 3 pitch angle decreases rapidly from 7 to 32 4 2 vertical thruster controlling landing strategy heave speed and attitude can be kept in a safe range when there are vertical thrusters so the key research point of vertical thruster controlling landing strategy is no longer the velocity or attitude but the landing time landing distance and action time of vertical thrusters the influences of mass and position of water entering on the velocity displacement total landing time and action time of vertical thrusters when landing are analyzed in this section based on the simulation system built above the termination condition of the landing process is that the axial acceleration of the auv in the earth fixed coordinate system is less than 0 001 m s2 4 2 1 effect of weight of water entering the tends of velocities pitch angles total landing time and action time of vertical thrusters for the cases x c a b s 1 m 0 5 m 0 m 0 5 m 1 m 1 5 m are similar and thus results of the case x c a b s 0 5 m are taken as examples surge velocity and displacement in earth fixed coordinate system when landing changing with weight of water entering are presented in fig 14 total landing time and action time of vertical thrusters changing with weight of water entering is given in fig 15 as can be seen from these figures with the mass of water entering increasing from 2 5 kg to 45 kg 1 surge velocity gradually increases from 0 48 m s to 1 08 m s 2 surge displacement shows an overall downward trend decreasing from 125 m to 44 m 3 heave displacement is about 10 m 4 an overall downward trend of total landing time can be observed and it reduces from 127s to 28s 5 total action time of vertical thrusters has an overall w type trend and its minimum value is 6 s when δ g a b s 10 k g 4 2 2 effect of position of water entering the tends of results for the cases δ g a b s 10 kg 20 kg 30 kg 40 kg are similar and thus results of the cases δ g a b s 10 kg are taken as examples surge velocity and displacement in earth fixed coordinate system when landing changing with position of water entering are presented in fig 16 total landing time and action time of vertical thrusters changing with position of water entering are presented in fig 17 as can be seen from these figures when the position of water entering changes from 2 4 m to 1 m 1 surge velocity shows an overall upward trend and it increases from 0 23 m s to 0 86 m s 2 surge displacement has an overall v type trend xe 104 m when x c a b s 2 4 m xe 73 m when x c a b s 0 6 m and xe 97 m when 3 heave displacement is about 13 m 4 total landing time reduces at first and then keeps in a slightly fluctuant state with a maximum value of 142 s when x c a b s 1 8 m and a minimum value of 43 s when x c a b s 0 2 m 5 total action time of vertical thrusters reduces at first and then increases when x c a b s 0 8 m and reaches a minimum value of 2 s when x c a b s 0 8 m 4 3 analysis of effect of vertical thrusters on landing parameters influence of vertical thrusters on landing parameters can be obtained by comparing free diving landing strategy and vertical thruster controlling landing strategy a heave speed v e y there is a great influence of vertical thrusters on v e y and v e y can be kept in a safe range with vertical thrusters so that the auv can land safely b pitch angle θ there is a great influence of vertical thrusters on θ and θ can be kept in a safe range with vertical thrusters so that the auv can land safely c surge velocity v e x there is little influence of vertical thrusters on axial velocity as can be seen from the above vertical thrusters have great benefit on the control of heave speed and pitch angle it is suggested that vertical thruster controlling landing strategy should be adopted when there are vertical thrusters 5 conclusion mathematical models of three dimensional motion of the auv forces mathematic models of variable buoyancy system and vertical thrusters are established in this paper control algorithm of vertical thrusters is designed based on this a landing simulation system is established using s function of matlab two kinds of landing strategies of the auv with mooring system are proposed i e diving freely under the effect of negative buoyancy and landing under the control of vertical thrusters examples of both of these two landing strategies are given to verify the feasibility and correctness of these mathematical models on this basis effects of mass and position of water entering into the auv on landing parameters of free diving landing strategy are studied and rules of diving speed and pitching angle changing with mass and position are obtained effects of parameters of water entering on landing parameters of vertical thruster controlling landing strategy are studied and rules of diving speed landing distance total landing time and action time of vertical thrusters changing with mass and position are obtained finally the influences of vertical thrusters on landing strategy are analyzed by comparing these two landing strategies and these conclusions will provide a theoretical basis for the design and improvement of landing strategy and overall layout credit authorship contribution statement xinyao zhu conceptualization methodology software formal analysis writing original draft writing review editing baowei song validation investigation daiyu zhang supervision writing review editing shuqi wang data curation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this project is supported by the national natural science foundation of china under grant 51309125 and the doctoral scientific research foundation of jiangsu university of science and technology just under grant 1012931605 
20276,at present the effect of a uniform stream on the hydrodynamic force or moment under the same relative velocity has been studied mostly in inviscid flow and the results are not consistent to build the relative motion principle in viscous flow the relationship of flow fields between the non stream circumstance and stream circumstance is constructed and the flow field of the steam circumstance is decomposed into the corresponding rest far field flow and the stream field then hydrodynamic force and moment formulas that are linearly dependent on the distribution of flow field and valid in both viscous and inviscid flow are proposed subsequently the hydrodynamics in the stream circumstances is decomposed according to the flow field decomposition and the uniform stream s effect is clarified the correctness of the acquired hydrodynamics transformation formulas is verified by comparing numerical results in both inviscid and viscous flow at last the validity of the existing relative motion principle is confirmed or analyzed keywords principle of relative motion vorticity dynamics hydrodynamics 1 introduction many underwater vehicles like submarines remotely operated underwater vehicles rov or bionic underwater vehicles move with low velocities comparable with that of the ocean current in these cases the effect of the ocean current on the hydrodynamics of the underwater vehicle is not negligible and should be reasonably accounted for with the advance of computational fluid dynamics cfd and the experimental technology the calculation or measurement of hydrodynamics acted on these underwater vehicles are possible and more and more experimental results du et al 2016 wang et al 2020 and numerical examples huang et al 2019 have been reported recently to study the dynamics of an underwater vehicle one needs to calculate or measure its hydrodynamics under different motion velocities and different current velocities if the effect of the ocean stream on the underwater vehicles hydrodynamics can be clarified half of the work can be saved this problem also exists in the study of rigs or offshore structures faltinsen 1993 in which the internal waves have severe effects on the safety of these devices and many research interest has been recently focused on studying their hydrodynamics under ocean internal waves lü et al 2016 ding et al 2020 this study is also necessary to covert the body move circumstance to body rest circumstance so that the device scale can be reduced in water tunnel experiments renilson 2018 and the complex dynamic mesh technique can be avoided in cfd simulations patterson et al 1987 the classical relative motion principle is one of the well known results that account for the effect of the incoming flow it had already been taken as a principle in the era of d alembert calero 2018 that the drag in the body move and body rest circumstances are the same under the same relative velocity as long as the stream is uniform and constant d alembert himself further illustrated that this relative motion principle for drag is also valid when the stream is uniform and unsteady with the development of offshore structure equipment morison proposed a semi empirical formula to estimate the hydrodynamic force acting on a long cylinder morison et al 1950 which is used to approximate the shape of the rig s tension legs this formula shows that the hydrodynamic force between the two circumstances under the same relative motion velocity is different at least in the inviscid flow field in 1967 batchelor proposed a brief discussion on the hydrodynamic force in accelerating fluid and concluded that an additional force that is proportional to the fluid density the volume of the body and the acceleration of the fluid would be acted on the body batchelor 1967 p409 this conclusion can be regarded as a kind of relative motion principle and is also adopted by sarpkaya 1976 in experimentally studying the morison formula in 1983 lewis et al studied the motion model of an rov moving in the current lewis et al 1984 the result shows that the inviscid hydrodynamics acted on the rov are different under the same relative motion velocity when the velocity of the stream is uniform and unsteady in 2000 thomasson the third author of ref lewis et al 1984 extended the motion model to the case that the stream is non uniform and unsteady thomasson 2000 woolsey and thomasson woolsey 2011 thomasson and woolsey 2013 later revised and further extended this motion model to the case that the stream is rotational obviously the thomasson and woolsey models are also applicable in the uniform stream circumstance consequently the difference of hydrodynamics between different stream velocities under the same relative velocity or principle of relative motion can be concluded basing on the study of thomasson or woolsey in the study of surface ship dynamics the hydrodynamic force acted on a stationary structure known as exiting force is often divided into the froude krilov force and diffraction force newman 2018 this result is also applied to underwater structures faltinsen 1993 and even moving underwater vehicles fossen 1994 when the wavelength is much longer than the vehicle s size the froude krilov depends on some variation of the stream velocity the diffraction force is the hydrodynamic force acting on the solid when moving in non stream fluid with the same relative velocity this result can be reasonably regarded as a form of relative motion principle as the long ocean wave can be approximated with a uniform and unsteady stream the comparison of these relative motion principles show that these conclusions basing on d alembert batchelor lewis thomasson or the froude krilov force decomposition are all different the review above shows that the principle of relative motion is not clear to many researchers at present even for inviscid flow the exact form of this principle is not consistent for viscous flow the relative motion principle is often limited to the case that the stream is uniform and steady fossen 1994 2002 lewandowski 2004 this phenomenon is due to the difficulty of expressing the hydrodynamics without the pressure distribution of the flow field which is inconvenient to be compared directly between the stream and non stream flow fields in lamb 1945 this kind of pressure independent hydrodynamics formulas were proposed based on the energy conservation theorem which indicated that the increase of the total kinetic energy in the flow field is equal to the work acted by the solid on the fluid this skill was also adopted by thomasson and woolsey to study the motion model of a solid moving in the non uniform and unsteady stream as mentioned above this kind of energy conservation is not valid in viscous flow as the viscosity may convert some kinetic energy into thermal energy the method basing on momentum conservation is an alternative and is applicable even in viscous flow however it is rejected by the earlier scholars as they and many later scholars considered that the total momentum in an infinitely large flow field surrounding the solid is indeterminate lamb 1945 batchelor 1967 wu et al 2015 this difficulty is removed with the appearance of far field pressure approximation technology wu 1978 1981 2014 pressure removal technology noca et al 1999 wu et al 2006 and projection technology quartapelle and napolitano 1983 protas et al 2000 among others however this advance is not adopted to study the relative motion principle at present the purpose of this research is to develop new hydrodynamics formulas basing on some of these techniques and built the relative motion principle that is valid in both viscous and inviscid incompressible flow the remaining part of this paper is organized as follows section 2 built the relationship between the flow field of the stream circumstance and the non stream circumstance section 3 proposes hydrodynamics formulas that are linearly dependent on the relationship of the two flow fields and the transformation method of the hydrodynamics is built section 4 verifies the new derived relative motion principle with analytical and numerical examples and the rationality of the existing relative motion principle is discussed section 5 concludes the paper with some remarks 2 flow fields transformation method as discussed in the introduction hydrodynamics can be evaluated by formulas independent of the pressure distribution consequently a key step to build the relative motion principle is to clarify the velocity distribution between the stream and non stream circumstances this section solves this problem by comparing the models of fluid motion in the non stream and stream circumstances by introducing two intermediate flow fields 2 1 description of the frames and variables to describe the motion of the body and the fluid an inertial frame o x y z is built and the base vector of the three axis o x o y o z is denoted by i j k respectively for a rigid body its motion can be determined by the velocity of a point fixed on it and the angular velocity here the more general case of a deformable but constant volume body is considered the region occupied by the body is denoted by r b and its surface is denoted by s b in this case a particle p on the body can be denoted by the position vector r p pointing from o to p if p lies on the solid surface then the position vector is denoted by r b the motion of a body is solely dependent on the motion of its surface i e v r b t f r b t as the velocity on the body is different for different p a special particle d on the body is selected and its velocity v d t v r d t is defined as the characteristic velocity of the body for a solid v d can be regarded as the translational velocity of the solid and the surface velocity v r b t v d ω r b where ω b is the angular velocity of the solid for the non stream circumstance the stream velocity is zero and the relative motion velocity of the body v r r d is equal to v d a surface s e enclosing the body and some part of the fluid is drawn in the flow field with the minimum distance between s b and s e approaching infinity and the position vector of a point on s e is denoted by r the fluid surface adjacent to the body surface s b is denoted by s i though the volume enclosed by s b and s i is zero they are not overlapped for two adjacent points lie on s b and s i respectively their velocities are the same in viscous flow due to the non slip boundary condition but are different in inviscid flow due to the slip boundary condition the region between s b and s e is denoted by r f the region enclosed by s i is denoted by r b the region enclosed by s i and s e is denoted by r f the position vector of a point in r f is denoted by r the velocity distribution in the flow field is denoted by v its curl the vorticity of the flow field is denoted by ω the flow field of the non stream circumstance viewed in the inertial frame o x y z is denoted by s including the distribution of v and ω the relationships of variables position vectors surfaces and regions described above are illustrated in fig 1 for the convenience of description a translational frame d x d y d z d is built with the origin d fixed on the body and the three axis d x d d y d d z d parallel to o x o y o z respectively as d may move with time variant velocity d x d y d z d is often a non inertial frame and a subscript d is added to the notation of the vectors when they are viewed in this frame for examples r r d v v d r r d etc the flow field of the non stream circumstance viewed in the d x d y d z d is denoted by s d the translational frame d x d y d z d and the vectors relative to it are illustrated on the left side of fig 2 for the stream circumstance a subscript w is added to the notation of the vectors to distinguish them from the corresponding variables in the non stream circumstance for examples r r w v v w r r w etc and the stream flow field is denoted by s w the donation of the inertial frame is also changed to o w x w y w z w the undisturbed stream field is supposed to be uniform and its velocity referencing to the inertial frame is denoted by v r w t v t the translational velocity of the body is denoted by v d w t and its difference between v t is defined as the relative motion velocity of the body i e v r w t v d w t v t in the stream circumstance the body is not necessarily rest consequently v d w t is not necessarily zero and this is why o w is not coincident with d w the inertial frame o w x w y w z w and some vectors relative to it are illustrated on the right of fig 2 the flow field referenced to the translational coordinate in the stream circumstance is denoted by s d w s d and s d w are two intermediate fields that would be used to compare s and s w to further illustrate the difference between a stream field and the corresponding non stream field under the same relative motion velocity the position attitude and velocity of the body are supposed to be the same at moment τ as illustrated in fig 2 for the convenience of comparison s e is temporarily supposed to be rest relative to the inertial coordinate and v d w is set to zero in stream circumstance in the non stream circumstance the body moves relative to the inertial frame o x y z and r d changes with time in the stream circumstance the body keeps position relative to the inertial frame o w x w y w z w and r d w is constant consequently for a point q in the flow field with the same and constant position vector relative to point d its position vector relative to the inertial frame is also constant in stream circumstance but is time variant in the non stream circumstance the discussion above can be clearly illustrated by comparison between the flow field at moment τ and τ δ τ which is illustrated in fig 3 2 2 motion model of the flow fields it is often assumed that the flow field can be modeled by a set of partial differential equations and corresponding boundary and initial conditions wu 2014 this hypothesis can be used to clarify the motion model of the flow fields in both stream and non stream circumstances as the classical model of navier stokes equation set includes pressure which is inconvenient for flow field and hydrodynamics comparison the velocity vorticity based model is considered here the theory of vorticity dynamics wu 2014 shows that the incompressible flow field can be described by continuity equation the definition of vorticity and the vorticity transportation equation considering the description of variables in the previous subsection equations of motion for the non stream flow field are 1 v 0 v ω ω t v ω ω v ν e 2 ω where ν e is the kinematic viscosity of the fluid to solve these equations the boundary condition and initial condition should be given detail discussion on this topic can be referenced to wu 1976 patterson et al 1987 the result shows that an appropriate method for determining the solution in a limited period 0 t t 1 is to prescribe the initial velocity distribution and enforce boundary velocity on s i and s e the velocity on s i can be determined by the non slip and non penetration boundary condition according to the velocity distribution on s b the velocity on s e is approximately zero for the non stream circumstance and in numerical simulation it can be approximated by v r t 0 consequently the motion model with reference to inertial frame for the non stream circumstance is 2 v 0 v ω ω t v ω ω v ν e 2 ω v r i t f r i t v r 0 v r 0 g r if the velocity distribution on s e is changed to v w r w v t the discussion above is also valid for stream circumstance considering the description of variables in the previous subsection the motion model with reference to inertial frame for the non stream circumstance is 3 w v w 0 w v w ω w ω w t v w w ω w ω w w v w ν e w 2 ω w v w r i w t f w r i w t v w r w t v t v w r w 0 g w r w where w x w i w y w j w z w k w is the hamilton operator in the inertial frame and i w j w k w is the base vector of inertial frame o w x w y w z w now consider the motion model with reference to translational frame d x d y d z d for non stream circumstance according to the description of variable in the previous subsection r d 0 t v d d τ r d r r d and v d r d v r v d as the axes of o x d y d z d are parallel with those of d x y z respectively it is not difficult to show that d d v d v d v d v and d ω d d t ω t v d ω the last formula is consistent with formula 6 in ref ostieri et al 2018 and evidences its correctness substitute the formulas discussed above into the third formula in eq 2 the motion model with reference to translational frame d x d y d z d for non stream circumstance can be acquired as 4 d v d 0 d v d ω d d ω d d t v d d ω d ω d d v d ν e d 2 ω d v d r i d f r i t v d t v d r d v d t v d r d 0 g r v d 0 similarly the flow field motion model with reference to the translational frame d w x d w y d w z d w in stream circumstance is 5 d w v d w 0 d w v d w ω d w d w ω d w d w t v d w d w ω d w ω d w d w v d w ν e d w 2 ω d w v d w r i d w f r i w t v d w t v d w r d w v t v d w t v d w r d w 0 g w r w v d w 0 2 3 relationship between the stream and non stream flow fields the purpose of this section is to build the relationship between s and s w the skill adopt here is to introduce the intermediate flow field s d and s d w as s and s d represent the same flow field viewed under different reference frame they can be transformed by 6 r d r r d v d r d t v r t v d t ω d r d t ω r t where r d 0 t v d d τ similarly the transformation between s w and s d w is 7 r d w r w r d w v d w r d w t v w r w t v d w t ω d w r d w t ω w r w t where r d w 0 t v d w d τ the comparison between s and s w is then transformed to the comparison between s d and s d w let the boundary and initial condition of the model 4 and 5 be the same respectively or 8 v w r i w t v r i t v t v d v d w v t v w r w 0 v r 0 v 0 one finds that the model 4 and 5 are the same except for the symbol of the variables the variables are marked with subscription d in equation set 4 and are marked with subscription d w in equation set 5 as different donation of the variables does not change the solution of an equation set one concludes that v d r d t v d w r d w t this means that the velocity or vorticity referenced to the translational frame is the same in the stream and non stream flow fields as long as condition 8 is fulfilled considering transformation 6 and 7 and condition 8 this conclusion can be rewritten as 9 r w r r d r d w v w r w t v r t v t ω w r w t ω r t the results above show that the flow field of a body moving in uniform and unsteady steam can be acquired based on the flow field of a body moving in a non stream flow field according to eq 9 as long as condition 8 is fulfilled the second condition in 8 requires that the relative motion velocities in the two circumstances are the same the first condition in 8 requires that the velocity distribution difference on the body surface is equal to v t for rigid bodies this in fact requires that their angular velocities are the same the third condition in 8 requires that the initial velocity distribution difference in the flow field is equal to v t it should be emphasized that the position vector for r w is different from that of r as clarified in eq 9 or illustrated in fig 3 and the relative discussion thus the relationship of the velocity variation in the two circumstances is not v w r w t t v r t t d v d t but 10 d w v w r w t d t d v r t d t d v d t this conclusion would be further discussed and numerically confirmed the comparison of the ns equation in different reference frames was discussed by batchelor 1967 the result shows that additional terms should be added to the ns equation to account for the motion of the non inertial frame this results in the different forms of ns equation in the different frames which is inconvenient for comparing the flow fields this is another reason why the vorticity transport equation is adopted here instead of the ns equation for inviscid flow ω 0 and the vorticity transport equation is unnecessary for the fluid motion models the left equations in the model is often called the kinematic part and can be converted into the laplace equation when the normal velocity on the body surface and the stream velocity is given the laplace equation is determined wu 2014 consequently the discussion above for viscous flow can be followed and the transformation rule 9 is still valid for inviscid flow at the same time the relationship of initial velocity distribution is not required in the transformation condition i e in eq 8 3 hydrodynamics transformation method as discussed in the introduction a variety of hydrodynamic force or moment formula that is independent of the pressure distribution and is applicable for viscous flow had been proposed since the late 1970s however these formulas are complex for building the hydrodynamics relationship basing on the decomposition of the flow field in eq 9 in this section new hydrodynamics formulas that are linearly dependent on the decomposition of the flow fields are proposed to clarify the hydrodynamics transformation rules 3 1 hydrodynamic force transformation method due to the slip boundary condition in inviscid flow the velocity is not continuous on r f to make sure that the flowing discussion is also applicable in inviscid flow the fluid in r f instead of r f is considered by applying the momentum balance theorem wu et al 2006 on r f the hydrodynamic force f w acted on the body can be expressed as 11 f w r f ρ d v w d t d r s e t w n d s where n is the outwards normal of s e the last term in eq 11 represents the total force acted on surface s e by the fluid outside of s e for newtonian fluid it can be shown that t w n p w n μ ω w n 2 μ n w v w wu et al 2015 by substituting the constitutive equations into t w μ is the kinetics viscosity of the fluid and p w is the static pressure according to the derivative moment transformation dmt formula 44 12 s e p w n d s 1 n 1 s e r w n p w d s where n is the dimension of the flow field p w can now be eliminated by noca s method noca et al 1999 i e replace p w with ρ d v w d t μ 2 v w according to the ns equation further considering that the integral of n v w on a closed surface is zero wu et al 2015 the hydrodynamic force in eq 11 can be rewritten as follow after some algebra operation 13 f w r f ρ d v w d t d r s e μ ω w n d s 1 n 1 s e r w n ρ d v w d t μ 2 v w d s according to eq 11 f w is independent of r w consequently f w should be independent on the starting point of the position vector r w in fact the starting point of the position vector would not affect the validity of the dmt formulas as discussed in wu et al 2015 which is also emphasized in the appendix for either of these two reasons r w in eq 13 can be replaced by r though they are different according to eq 9 according to the flow field transformation formula 9 and 10 f can be decomposed into two terms i e f w f f with 14 f r f ρ d v d t d r s e μ ω n d s 1 n 1 s e r n ρ d v d t μ 2 v d s f r f ρ d v d t d r ρ n 1 s e r n d v d t d s as 2 v v v 0 the term μ 2 v does not appear in f by applying the dmt formula 45 the region integral in f can be further decomposed 15 r f ρ d v d t d r ρ n 1 r f r d v d t d r ρ n 1 s i s e r n d v d t d s where n is the outwards normal of r f surface i e n is positive on s i when pointing to the body noting that v is uniform the first term on the right hand of eq 15 is zero and f can be simplified as 16 f ρ n 1 s i r n d v d t d s by applying the dmt formula 44 and the gauss theorem f can be rewritten as 17 f ρ r b d v d t d r ρ d d t r b v d r ρ v d v d t where v is the volume of r b it is also the volume of the body at last one gets 18 f w f ρ v d v d t the derivation process of eq 13 shows that it is also applicable for the non stream circumstance this means that f in 14 is exactly the hydrodynamic force when the body moves with the same relative velocity in the non stream circumstance consequently eq 18 is the transformation formula for the hydrodynamic force between stream circumstance and non stream circumstance provided that condition 8 is fulfilled transformation 18 is applicable for both viscous and inviscid flow according to its derivation process 3 2 hydrodynamic moment transformation method the hydrodynamic moment transformation method can be derived in a similar way by applying the momentum moment balance theorem wu et al 2015 on the region r f one gets 19 m w r f ρ r 1 w d v w d t d r s e r 1 w t w n d s where r 1 w is the position vector of a fluid particle referencing to the reference point o 1 w of the hydrodynamic moment for convenience o 1 w is enforced to keep constant position vector reference to point d or fixed on a rigid body this is also the treatment in defining the hydrodynamic moment in flight dynamics or studying the mechanics of a submarine in this case r 1 w r d w o 1 w r d w where constant r d w o 1 w is the position vector pointing from o 1 w to d w then r 1 w are the same in the steam and non stream circumstances according to eq 9 and the relevant discussion for this reason the difference between r 1 and r 1 w is not distinguished in the following discussion as t w n p w n μ ω w n 2 μ n v w the last term on the right hand of eq 19 can be decomposed into 20 s e r 1 t w n d s μ s e r 1 ω w n d s 2 μ s e r 1 n v w d s s e r 1 n p w d s by applying the dmt formula 46 on the last term on the right side of eq 20 the integrand can be transformed into a function of p w eliminate the pressure term with ns equation m w can be rewritten as 21 m w r f ρ r 1 d v w d t d r ρ 2 s e r 1 2 n d v w d t d s μ 2 s e r 1 2 n ω w d s μ s e r 1 ω w n d s 2 μ s e r 1 n v w d s according to the flow field transformation formula 9 and 10 m w can be decomposed into two terms i e m w m m with 22 m r f ρ r 1 d v d t d r ρ 2 s e r 1 2 n d v d t d s μ 2 s e r 1 2 n ω d s μ s e r 1 ω n d s 2 μ s e r 1 n v w d s m r f ρ r 1 d v d t d r ρ 2 s e r 1 2 n d v d t d s by applying dmt formula 47 the region integral in m can be rewritten as 23 r f ρ r 1 d v d t d r ρ 2 r f r 1 2 d v d t d r ρ 2 s i s e r 1 2 n d v d t d s as v is uniform on r f r b the first term on the right hand of eq 23 is zero consequently m can be simplified as 24 m ρ 2 s i r 1 2 n d v d t d s ρ r b r 1 d v d t d r ρ v r v d v d t where r v is the position vector pointing from o 1 to the volume center of the body the second equal sign is due to the dmt formula 47 the third equal sign is due to the uniform distribution of d v d t and the definition of position vector r v the derivation process of m w in eq 21 shows that it is also applicable for the stream circumstance this means that the m in eq 22 is exactly the hydrodynamic moment when the body moves with the same relative velocity in the non stream circumstance consequently the hydrodynamic moment transformation method between the stream circumstance and the non stream circumstance is 25 m w m ρ v r v d v d t this transformation formula is valid in both viscous and inviscid flow according to its derivation process the transformation formula 18 and 25 show that the hydrodynamics of a body moving with the same relative velocity do not necessarily keep the same between the stream and non stream circumstance in the circumstance that the stream velocity is uniform and time invariant the hydrodynamics are the same and this result is well known as the principle of relative motion if the stream velocity is time variant the hydrodynamic force and moment between the two circumstances are different and can be transformed by formula 18 and 25 respectively 4 verifications and observations to verify the correctness of the derivation results above flow field transformation formulas 10 and hydrodynamics transformation formulas 18 and 25 are compared with theoretical or numerical results in both inviscid and viscous flow then the rationality of existing results on the relative motion principle is discussed 4 1 comparison with theoretical and numerical result in inviscid flow according to the discussion of anderson 2014 the inviscid flow field includes the steady cyclic flow field in the two dimensional flow however for inviscid fluid the flow field will keep acyclic according to the theorem of kelvin if the flow is acyclic initially in two dimensional flow we consider only this acyclic inviscid flow field here as the cyclic inviscid flow field in fact considered the effect of the fluid viscosity during the transient or unsteady process before the steady state 4 1 1 verification of the flow field transformation formula we first check the flow field transformation formula 9 the inviscid flow field can be numerically calculated basing on the panel method which distributes sources on the surface of the moving body this method had already been well documented by hess and smith 1967 and can also be found in more recent ref cebeci et al 2004 this method clearly shows that the inviscid flow field between the stream and non stream circumstance fulfills the transformation formula 9 consequently we need only to further check the correctness of eq 10 or d w v d t d v d t d v d t to clearly show this relationship the two dimensional flow field induced by a circle is studied analytically instead of numerically as shown in fig 4 the velocity distribution of the flow field is katz and plotkin 2001 26 v r w r w θ w t u t cos θ w 1 r 2 r w 2 v θ w r w θ w t u t sin θ w 1 r 2 r w 2 where u is the velocity of the stream θ w is the angular between r w and o x v r w is the velocity component in the r w direction and v θ w is the velocity component in the θ w direction r is the radius of the cylinder cross section as shown in fig 4 eq 26 can be rewritten as v w v x w i w v z w k w with 27 v x w x w y w t u t u t r 2 x w 2 z w 2 x w 2 z w 2 2 v z w x w y w t u t 2 r 2 x w z w x w 2 z w 2 2 though this stream circumstance flow field is acquired under the hypothesis that the stream is steady it is also applicable if the incoming flow is time variant this is because the laplace equation is valid in both time dependent and time independent inviscid flow fields according to transformation rule 9 the velocity distribution in the corresponding non stream flow field is v r d t v w r w t v or v r r d v w r w v where r d 0 t v d d t and v d u t i is the velocity of the cylinder cross section center consequently 28 v x x y t u t r 2 x x d 2 z z d 2 x x d 2 z z d 2 2 v z x y t u t 2 r 2 x x d z z d x x d 2 z z d 2 2 where v x v z is the two components of vector v now the v w t and v t can be calculated analytically as 29 v w t d u t d t i w d u t d t r 2 x w 2 z w 2 x w 2 z w 2 2 i w d u t d t 2 r 2 x w z w x w 2 z w 2 2 k w 30 v t d u t d t r 2 x x d 2 z z d 2 x x d 2 z z d 2 2 i v x x d d x d d t v x z d d z d d t i d u t d t 2 r 2 x x d z z d x x d 2 z z d 2 2 k v z x d d x d d t v z z d d z d d t k v w t d u t d t i v x x v d x v x z v d z i v z x v d x v z z v d z k v w t v d v d u t d t i v w t v v d u t d t i the result above clearly shows that v w t v t d v t d t this difference according to the calculation process above is due to the fact that the position r d is time variant as d is moving in the non stream circumstance considering that v w v w v v v v v v v v the fluid particle acceleration of the two fields are 31 d v w d t v w t v w v w v w t v v v v d v d t v t v v v w t d v t d t v v v v respectively they obviously fulfill d v w d t d v d t d v t d t and verifies the correctness of eq 10 4 1 2 verification of the hydrodynamic force transformation formula to compute the unsteady hydrodynamic force in inviscid flow the following pressure independent hydrodynamic force formula provided by newman 2018 p141 is considered 32 f ρ d d t s i ϕ n d s ρ s i ϕ n ϕ d s ρ 2 s i ϕ ϕ n d s by applying dmt formula 44 this formula can be rewritten as 33 f ρ n 1 d d t s i r v n d s ρ s i v v n d s ρ 2 s i v v n d s this formula is velocity vector based and is more convenient for program debugging as the velocity distribution of the flow field is more intuitional for an ellipsoid with semi major axis a 0 5 and semi minor axis b 0 1 the non stream flow field is numerically calculated based on the panel method hess and smith 1967 and the hydrodynamic force f in eq 33 is evaluated the result shows that the last two terms do not contribute to the value of f when the ellipsoid moves either steady or unsteady as the starting point of r is arbitrary according to the characteristic of the dmt formulas wu et al 2015 it is fixed on the ellipsoid center d during calculation in this case r is time independent for a fixed point on s i and is convenient for evaluating the integral i 1 ρ s i r v n d s n 1 the result shows that i 1 is exactly the impulse of the flow field i e 34 i 1 m f v v d m f w ω b where m f v and m f w are the added mass tensor representing the effect of the translational and angular acceleration on the hydrodynamic force the corresponding matrix for these tensors are 35 m f v m 11 0 0 m 11 m f w 0 0 for ellipsoids theoretical study shows that m 11 ρ π b 2 m 22 ρ π a 2 newman 2018 p152 the numerical study shows that the relative error of m 11 and m 22 based on formulas 33 and 34 are both less than 0 001 when the panel on the ellipsoid surface is 640 all these studies evidence the correctness and accuracy of the program now the hydrodynamic forces in the stream circumstance and non stream circumstances are calculated under the same relative velocity and the result are plotted in fig 5 in the first scenario the angular velocity of the ellipsoid is set to zero with a constant attack angle 5 in the non stream circumstance the translational velocity is v d 2 sin t m s i and the hydrodynamic force f x parallel to v d is plot on the left side of fig 5 with blue dots in the stream circumstance the ellipsoid is resident in the stream and the hydrodynamic force f x w parallel to v is plot on the left side of fig 5 with the blue line their difference δ f x f x w f x is plot on the right side of fig 5 with blue stars the theoretical result of δ f x according transformation formula 18 is also plot on the right side of fig 5 with the red line it can be clearly seen that the numerical data of δ f x is coincident with the theoretical result in scenario two an angular velocity of ω b 0 1 sin t rad s i is added to the ellipsoid with zero initial attack angle and the calculation process is repeated f x and f x w are plotted on the left side of fig 5 with red dots and a red line respectively it is well known that the angular velocity would not affect the hydrodynamic force of an ellipsoid if the translational velocity is defined as the velocity of its center the difference of f x or f x w between the two scenarios as shown on the left of fig 5 is therefore due to the change of attack angle the difference of δ f x f x w f x is also plot on the right side of fig 5 with red circles it can be clearly seen that the numerical data of δ f x in this scenario is also coincident with the theoretical result this means that the difference of the hydrodynamic force between the stream and non stream circumstances is dependent on the acceleration of the stream and is independent of the motion of the solid this result is consistent with the translation formula 18 and all the discussion above verifies the correctness of this formula 4 1 3 verification of the hydrodynamic moment transformation formula similarly the pressure independent hydrodynamic moment formula can be acquired following newman s discussion newman 2018 p141 36 m d d t s i ϕ r n d s ρ 2 s i r n v v d s s i r v v n d s let r r o 1 r 1 where r o 1 is the position vector of o 1 the reference point of the hydrodynamic moment and r 1 is the position vector of points in the flow field referencing to o 1 noticing that r o 1 is space independent one gets 37 m r o 1 f m o 1 m o 1 v o 1 s i ϕ n d d t s i ϕ r 1 n d s ρ 2 s i r 1 n v v d s s i r 1 v v n d s where f is the hydrodynamic force m is the hydrodynamic moment referencing to point o and m o 1 is the hydrodynamic moment referencing to point o 1 during the calculation o 1 is fixed on the rigid body so that the acquired hydrodynamic moments are the same as those adopted in flight dynamics or submarine mechanics the formula above is velocity potential based and the velocity vector based form can be obtained by applying the dmt formula 45 and 46 38 m o 1 1 2 d d t s i r 1 2 n v d s v o 1 s i r 1 v n n ρ 2 s i r 1 n v v d s s i r 1 v v n d s the numerical study can also be carried out on the same ellipsoid adopt to study the hydrodynamic force similarly the correctness of formula 38 is checked first in the non stream circumstance numerical study shows that the last two terms on the right hand of eq 38 do not contribute to the value of m o 1 the integral in the second term on the right hand of eq 38 is exactly the impulse of the flow field according to the numerical study of hydrodynamic force consequently the hydrodynamic moment formula provided by lamb 1945 is reprised i e 39 m o 1 d l 1 d t v o 1 i 1 l 1 s i r 1 2 n v d s it should be noted that v o 1 is the velocity of the hydrodynamic moment reference point it is not necessary the translational velocity of the solid v d as shown by lamb consequently the lamb formula is only a special case of the hydrodynamic moment formula of 39 theoretical study shows that the impulse moment can be represented by 40 l 1 m m v v d m m w 21 ω b and the corresponding matrix for tensor m f w and m f w are 41 m m v 0 0 m m w 21 m 66 with m 66 ρ π a 2 b 2 2 8 newman 2018 p152 for ellipsoids the numerical study shows that the relative error of m 66 based on formulas 38 and 40 is less than 0 2 when the panel on the ellipsoid surface is 640 all these studies evidence the correctness and accuracy of the program similarly the hydrodynamic moments in both circumstances are calculated under the same relative velocity and are compared with the transformation formula 25 the transformation formula 25 shows that the difference of the hydrodynamic moment would be zero if the reference point o 1 is coincident with the volume center of the ellipsoid d and the numerical result verifies this conclusion to further verify the transformation formula 25 the reference point o 1 is fixed on the body with coordinates 0 1 in the body fixed frame so that the difference of hydrodynamic moment between the two circumstances would be non zero in the first scenario the angular velocity of the ellipsoid is set to zero with a constant attack angle 5 in the non stream circumstance the translational velocity is v d 2 sin t m s i and the hydrodynamic moment m z parallel to o z is plot on the left side of fig 6 with blue dots in the stream circumstance the ellipsoid is resident in the stream and the hydrodynamic moment m z w parallel to o w z w is plot on the left side of fig 6 with a blue line their difference δ m z m z w m z is plot on the right side of fig 6 with blue stars the theoretical result of δ m z according transformation formula 25 is also plot on the right side of fig 6 with red line it can be clearly seen that the numerical data of δ m z is coincident with the theoretical result in scenario two an angular velocity of ω b 0 1 sin t rad s i is added to the ellipsoid with zero initial attack angle and the calculation process is repeated m z and m z w are plotted on the left side of fig 6 with red dots and a red line respectively the difference of angular velocity and attack angle would both affect the hydrodynamic moment and result in its difference between the two scenarios under the same circumstance this difference of hydrodynamic moment between different scenarios are also clearly shown on the left side of fig 6 and the difference of δ m z m z w m z in scenario two is also plot on the right side of fig 6 with red circles it is clear that δ m z s numerical data in this scenario is also coincident with the theoretical result this means that the difference of hydrodynamic moment between the stream and non stream circumstance is dependent on the acceleration of the stream and is independent of the motion of the solid this result is consistent with translation formula 25 and all the discussion above verifies the correctness of this formula in inviscid flow 4 2 comparison with numerical result in viscous flow to check the correctness of the transformation formulas 9 18 and 25 the viscous flow field and hydrodynamics of a naca0015 airfoil are numerically calculated with the software fluent the chord length of the airfoil is 1 the attack angle is 5 the flow field is calculated under the stream circumstance and the non stream circumstance respectively with the same relative velocity for the convenience of description a translational frame is built with the origin d fixed on the leading edge of the airfoil the d x d axis is parallel with the relative velocity and is pointing to the trail of the airfoil the d z d axis is perpendicular to the d x d axis and pointing upwards the flow field is calculated within a circle s e whose radius is 19 and the center coordinates is p 1 5 0 1 the fluid is air with density ρ 1 225 kg m 3 and the far field boundary condition is set to velocity inlet as shown in fig 7 the independence on the grid number is checked and verified first three grids with total number 96800 169830 210000 respectively are applied to numerically calculate the drag and lift of a naca0012 airfoil moving with constant velocity 29 2 m s and reynolds number r e 2 0 1 0 6 the sstk omega turbulence model is adopted and the residuals of the continuity and velocities are all less than 1 0 1 0 6 in absolute criteria when converged the comparison of the result with the experimental data of ladson 1988 is listed in tables 1 and 2 the tables show that the numerical result is coincident with the experimental data and the different grid number does not affect the numerical result significantly consequently a grid with a total number of 119 380 is adopted to study the unsteady state hydrodynamics the time step in the unsteady flow field simulation is 0 005 s and the max iterations in one time step is 20 for the stream circumstance the velocity of the stream is in the d x d direction with amplitude v 1 0 5 sin 2 π t m s and the body is rest the initial condition of the flow field is the steady flow field of the body rest in the stream with v 1 m s for the non stream circumstance the velocity of the body is opposite to the d x d direction with amplitude v d 1 0 5 sin 2 π t m s and the initial condition of the flow field is the steady flow field of the body moving with constant velocity v d 1 m s to avoid the difficulty of re grid during calculation in the non stream circumstance the moving reference frame mrf ansys 2013 technology is adopted numerical simulation results show that the two flow fields fulfill the transformation formula 9 quite well at time t 3 s we transform the non stream velocity field by formula 9 and then compare it with the stream field velocity the difference is normalized by the stream speed at that moment the result shows that the maximum error is within 1 60 and 1 58 in the d x d and d z d direction respectively the average error in these two directions are 0 54 and 0 11 respectively the comparison of lift in the two circumstances shows that they are almost the same this is consistent with formula 18 as the lift is perpendicular to the body translation velocity or stream velocity for the stream circumstance the drag the moment and the stream speed are plotted in fig 8 it can be seen that the drag or moment is not in phase with the stream speed this is because the unsteady hydrodynamics are dependent not only on the relative velocity but also the relative acceleration as the phase between the velocity and acceleration is 90 the drag or moment is not necessarily in phase with velocity the drag difference between the two circumstances and the acceleration of the stream a are plotted in fig 9 it can be seen from fig 9 that the drag difference is in phase with a π cos 2 π t what is more the numerical result δ f x f x w f x matches well with the d x d component of the theoretical result f w f in formula 18 if the error is normalized by the maximum value of the drag the relative error is within 0 22 this consistency verifies the correctness of formula 18 it can be seen from eq 25 that the moment difference is dependent on the reference point of the moment when the position vector r v is almost parallel with the d x d axis the moment difference of the two circumstances would be small the numerical calculation results confirmed this conclusion to further illustrate the correctness of formula 25 the reference point of the moment is set on point o 1 0 1 in this case r v is vertical to d x d or the relative velocity and the difference of the hydrodynamic moment should be distinct the moment difference curve and the acceleration of the stream a are plotted in fig 10 the result shows that the moment s difference is assuredly not small and is in phase with a π cos 2 π t what is more the numerical result of the hydrodynamic moment in d z d direction δ m z m z w m z matches well with the theoretical result in formula 25 if the error is normalized with the maximum value of m z the relative error is within 0 40 this consistence verifies the correctness of the formula 25 4 3 observations as introduced in the introduction several theories concerning the relative motion principle had been proposed by previous scholars we now compare their conclusion with this study the first conclusion for relative motion principle under unsteady and uniform incoming flow is drawn by d alembert who proved that the drags are still the same under the two circumstances in the development of the zeta program patterson et al 1987 p8 14 it is even supposed that the hydrodynamic force and moment are both same when the stream is translating or rotating unsteady this is obviously in conflict with this study and the conclusions of other scholars the reason for this phenomenon is because the far field pressure distribution is unknown to scholars of the d alembert era a hypothesis that the pressure at far field is zero is adopted by d alembert during his derivation calero 2018 p29 this results in no contribution of the pressure on s e to the hydrodynamic force on the solid this conflicts with the modern study which shows that the pressure integral on s e is not necessarily zero in unsteady flow field wu 2014 p94 in fact the pressure integral on s e is still unknown to scholars even in the lamb era lamb 1945 p162 who missed the contribution of velocity potential during its estimation these facts also explain why the principle of relative motion in an unsteady stream cannot be solved in the early days the morison formula shows that the hydrodynamic force act on a unit length circular cylinder by the stream is morison et al 1950 42 f ρ c m π d 2 4 u t ρ c d d 2 u 2 where u is the velocity of the uniform stream which is vertical to the axis of the cylinder and d is the diameter of the circular cylinder for inviscid flow c m is exactly 2 according to the study of ocean engineering newman 2018 the deviation of c m from 2 in some refs zan and lin 2020 is due to the effect of viscosity the first term on the right hand of eq 42 represents the hydrodynamic force related to the acceleration of the stream the second term represents the hydrodynamic force that is related to dynamic pressure for irrotational inviscid flow only the first term exists according to formula 18 the hydrodynamic force acting on the cylinder can be decomposed into two parts the scalar form of the second part is ρ v d u d t π ρ d 2 4 u t as v u is uniform on r b r f the first part on the right of formula 18 is the hydrodynamic force acted on the circular cylinder when it moves in the non stream circumstance with the same relative velocity u as the added mass of a unit length circular cylinder moving perpendicular to its axis is π ρ d 2 4 khoury 2012 p35 the second part on the right hand of eq 18 is π ρ d 2 4 u t according to the concept of added mass consequently the hydrodynamic force evaluated by formula 18 is exactly the first term of the morison formula with c m 2 this means that formula 18 is consistent with the morison formula the relative motion principle drawn from the morison formula is only applicable to long cylinders a more general form of relative motion principle that is the same as transformation formula 18 had been proposed by batchelor 1967 p409 in the meantime batchelor also showed that the difference of the fluid particle accelerations between an inertial reference frame and a translational frame is d v d d t these results can be regarded as evidence of the correctness of transformation formulas 10 and 18 respectively however an acquiescent assumption that the stream flow field observed on a translating frame is the same as the non stream flow field is adopted by batchelor this assumption is exactly transformation rule 9 that had been rigidly proved in this study batchelor s study considered only the hydrodynamic force due to the pressure difference between the two flow fields in this study the effect of the viscous shearing stress is also considered and the result is extended to hydrodynamic moment transformation i e eq 25 in fossen 1994 the concept of froude krilov force is generalized to froude krilov moment and their formulas are expressed by matrix operation form 43 f f k m v m m k m r v v where m ρ v represents the mass of the fluid required to fill the volume occupied by the body f f k m f k and v are the column matrix of the hydrodynamic force f f k the hydrodynamic moment m f k and the stream velocity v respectively when they are projected in the body fixed frame r v is the antisymmetric matrix of r v and r v is the column matrix of the position vector r v when it is projected in the body fixed frame if the body is not rotating v is precisely the column matrix of vector d v d t when it is projected in the body fixed frame consequently the froude krilov force or moment introduce by fossen 1994 is exactly the last term of the transformation formula 18 and 25 this in some way evidences the correctness of the study in this paper for the case that the body is rotating the projection of d v d t in the body fixed frame would be v ω b v where ω b is the antisymmetric matrix of ω b and ω b is the column matrix the body angular velocity vector ω b when it is projected in the body fixed frame this means that the froude krilov force or moment introduced in fossen 1994 is inconsistent with the transformation formula 18 or 25 as ref fossen 1994 does not clarify whether the body frame is rotating or not we regard the transformation formula 18 and 25 in inviscid flow as generalizations of the froude krilov force or moment decomposition methods introduced in fossen 1994 in the study of thomasson 2000 the motion model of a solid moving in the nonuniform and unsteady stream had been proposed by thomasson by moving all the terms that are dependent on the density of the fluid to the right hand of the equations the hydrodynamic force or moment formula acted on the solid can be acquired as these formulas are applicable in both stream and non stream circumstance the relative motion principle can be clarified the result shows that the hydrodynamic force difference between non stream circumstance and stream circumstance is also ρ v v while the hydrodynamic moments are the same when the relative velocities are equal and the stream is uniform this result conflicts with the transformation rule 18 drawn in this study for the case that the solid body is a sphere its hydrodynamic force should be independent of the sphere s angular velocity consequently the difference of the hydrodynamic forces between the two circumstances would not be affected by the angular velocity of the solid thomasson s result is obviously in conflict with this phenomenon and is not acceptable the transformation formula 18 is consistent with this phenomenon and is more reasonable noting that the reference point of hydrodynamic moment is supposed to be coincident with the volume center of the body in thomasson s study one gets r v 0 in formula 25 this means that the transformation formula 25 is consistent with thomasson s result and the hydrodynamic moment transformation method based on thomasson s study is only a special case of the transformation formula 25 when the stream is uniform the motion model of a solid moving in uniform and unsteady stream had also been proposed by lewis et al 1984 and the principle of relative motion can be acquired based on this model similarly the result shows that the hydrodynamic force difference in the two circumstances is m v m ω b v and are consistent with this study however the hydrodynamic moment difference between the two circumstances is m r v v m r v ω b v ω b λ m v v and is different from our result by ω b λ m v v where λ m v is the 3 3 added mass matrix representing the effect of the translational acceleration on the hydrodynamic moment 5 conclusions for a body moving in the incompressible flow the effect of uniform stream velocity on the flow field and the body hydrodynamics are studied under the hypothesis that the relative velocities of the body are the same the result shows that the velocity and vorticity field can be transformed by formula 9 i e the vorticity fields are the same and the velocity field of the non stream circumstance equals to the stream circumstance adding the stream velocity the hydrodynamic forces can be transformed by formula 18 and the hydrodynamic moments can be transformed by formula 25 the hydrodynamics are the same in the two circumstances if the stream velocity is time independent which is well known as the principle of relative motion these transformation formulas are applicable in the inviscid flow as well credit authorship contribution statement xianwu lin conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization funding acquisition shichao wang software data curation visualization writing review editing bing zhu software funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix the following derivative moment transformation dmt formula had been quoted in the paper the detailed proof of these formulas can be found in ref wu et al 2015 p421 422 for a closed surface s let n be its outwards normal n be the dimension of the flow field ϕ is a continuous scalar field r is the position vector of the flow field referencing to an arbitrary point then 44 s ϕ n d s 1 n 1 s r n ϕ d s n 2 3 let r be a region of the flow field enclosed by s and f be a continuous vector field then 45 r f d r 1 n 1 r r f d r 1 n 1 s r f n d s n 2 3 46 s r n ϕ d s 1 2 s x 2 n ϕ d s n 2 3 47 2 r r f d r r r 2 f d r s r 2 n f d s n 2 3 
20276,at present the effect of a uniform stream on the hydrodynamic force or moment under the same relative velocity has been studied mostly in inviscid flow and the results are not consistent to build the relative motion principle in viscous flow the relationship of flow fields between the non stream circumstance and stream circumstance is constructed and the flow field of the steam circumstance is decomposed into the corresponding rest far field flow and the stream field then hydrodynamic force and moment formulas that are linearly dependent on the distribution of flow field and valid in both viscous and inviscid flow are proposed subsequently the hydrodynamics in the stream circumstances is decomposed according to the flow field decomposition and the uniform stream s effect is clarified the correctness of the acquired hydrodynamics transformation formulas is verified by comparing numerical results in both inviscid and viscous flow at last the validity of the existing relative motion principle is confirmed or analyzed keywords principle of relative motion vorticity dynamics hydrodynamics 1 introduction many underwater vehicles like submarines remotely operated underwater vehicles rov or bionic underwater vehicles move with low velocities comparable with that of the ocean current in these cases the effect of the ocean current on the hydrodynamics of the underwater vehicle is not negligible and should be reasonably accounted for with the advance of computational fluid dynamics cfd and the experimental technology the calculation or measurement of hydrodynamics acted on these underwater vehicles are possible and more and more experimental results du et al 2016 wang et al 2020 and numerical examples huang et al 2019 have been reported recently to study the dynamics of an underwater vehicle one needs to calculate or measure its hydrodynamics under different motion velocities and different current velocities if the effect of the ocean stream on the underwater vehicles hydrodynamics can be clarified half of the work can be saved this problem also exists in the study of rigs or offshore structures faltinsen 1993 in which the internal waves have severe effects on the safety of these devices and many research interest has been recently focused on studying their hydrodynamics under ocean internal waves lü et al 2016 ding et al 2020 this study is also necessary to covert the body move circumstance to body rest circumstance so that the device scale can be reduced in water tunnel experiments renilson 2018 and the complex dynamic mesh technique can be avoided in cfd simulations patterson et al 1987 the classical relative motion principle is one of the well known results that account for the effect of the incoming flow it had already been taken as a principle in the era of d alembert calero 2018 that the drag in the body move and body rest circumstances are the same under the same relative velocity as long as the stream is uniform and constant d alembert himself further illustrated that this relative motion principle for drag is also valid when the stream is uniform and unsteady with the development of offshore structure equipment morison proposed a semi empirical formula to estimate the hydrodynamic force acting on a long cylinder morison et al 1950 which is used to approximate the shape of the rig s tension legs this formula shows that the hydrodynamic force between the two circumstances under the same relative motion velocity is different at least in the inviscid flow field in 1967 batchelor proposed a brief discussion on the hydrodynamic force in accelerating fluid and concluded that an additional force that is proportional to the fluid density the volume of the body and the acceleration of the fluid would be acted on the body batchelor 1967 p409 this conclusion can be regarded as a kind of relative motion principle and is also adopted by sarpkaya 1976 in experimentally studying the morison formula in 1983 lewis et al studied the motion model of an rov moving in the current lewis et al 1984 the result shows that the inviscid hydrodynamics acted on the rov are different under the same relative motion velocity when the velocity of the stream is uniform and unsteady in 2000 thomasson the third author of ref lewis et al 1984 extended the motion model to the case that the stream is non uniform and unsteady thomasson 2000 woolsey and thomasson woolsey 2011 thomasson and woolsey 2013 later revised and further extended this motion model to the case that the stream is rotational obviously the thomasson and woolsey models are also applicable in the uniform stream circumstance consequently the difference of hydrodynamics between different stream velocities under the same relative velocity or principle of relative motion can be concluded basing on the study of thomasson or woolsey in the study of surface ship dynamics the hydrodynamic force acted on a stationary structure known as exiting force is often divided into the froude krilov force and diffraction force newman 2018 this result is also applied to underwater structures faltinsen 1993 and even moving underwater vehicles fossen 1994 when the wavelength is much longer than the vehicle s size the froude krilov depends on some variation of the stream velocity the diffraction force is the hydrodynamic force acting on the solid when moving in non stream fluid with the same relative velocity this result can be reasonably regarded as a form of relative motion principle as the long ocean wave can be approximated with a uniform and unsteady stream the comparison of these relative motion principles show that these conclusions basing on d alembert batchelor lewis thomasson or the froude krilov force decomposition are all different the review above shows that the principle of relative motion is not clear to many researchers at present even for inviscid flow the exact form of this principle is not consistent for viscous flow the relative motion principle is often limited to the case that the stream is uniform and steady fossen 1994 2002 lewandowski 2004 this phenomenon is due to the difficulty of expressing the hydrodynamics without the pressure distribution of the flow field which is inconvenient to be compared directly between the stream and non stream flow fields in lamb 1945 this kind of pressure independent hydrodynamics formulas were proposed based on the energy conservation theorem which indicated that the increase of the total kinetic energy in the flow field is equal to the work acted by the solid on the fluid this skill was also adopted by thomasson and woolsey to study the motion model of a solid moving in the non uniform and unsteady stream as mentioned above this kind of energy conservation is not valid in viscous flow as the viscosity may convert some kinetic energy into thermal energy the method basing on momentum conservation is an alternative and is applicable even in viscous flow however it is rejected by the earlier scholars as they and many later scholars considered that the total momentum in an infinitely large flow field surrounding the solid is indeterminate lamb 1945 batchelor 1967 wu et al 2015 this difficulty is removed with the appearance of far field pressure approximation technology wu 1978 1981 2014 pressure removal technology noca et al 1999 wu et al 2006 and projection technology quartapelle and napolitano 1983 protas et al 2000 among others however this advance is not adopted to study the relative motion principle at present the purpose of this research is to develop new hydrodynamics formulas basing on some of these techniques and built the relative motion principle that is valid in both viscous and inviscid incompressible flow the remaining part of this paper is organized as follows section 2 built the relationship between the flow field of the stream circumstance and the non stream circumstance section 3 proposes hydrodynamics formulas that are linearly dependent on the relationship of the two flow fields and the transformation method of the hydrodynamics is built section 4 verifies the new derived relative motion principle with analytical and numerical examples and the rationality of the existing relative motion principle is discussed section 5 concludes the paper with some remarks 2 flow fields transformation method as discussed in the introduction hydrodynamics can be evaluated by formulas independent of the pressure distribution consequently a key step to build the relative motion principle is to clarify the velocity distribution between the stream and non stream circumstances this section solves this problem by comparing the models of fluid motion in the non stream and stream circumstances by introducing two intermediate flow fields 2 1 description of the frames and variables to describe the motion of the body and the fluid an inertial frame o x y z is built and the base vector of the three axis o x o y o z is denoted by i j k respectively for a rigid body its motion can be determined by the velocity of a point fixed on it and the angular velocity here the more general case of a deformable but constant volume body is considered the region occupied by the body is denoted by r b and its surface is denoted by s b in this case a particle p on the body can be denoted by the position vector r p pointing from o to p if p lies on the solid surface then the position vector is denoted by r b the motion of a body is solely dependent on the motion of its surface i e v r b t f r b t as the velocity on the body is different for different p a special particle d on the body is selected and its velocity v d t v r d t is defined as the characteristic velocity of the body for a solid v d can be regarded as the translational velocity of the solid and the surface velocity v r b t v d ω r b where ω b is the angular velocity of the solid for the non stream circumstance the stream velocity is zero and the relative motion velocity of the body v r r d is equal to v d a surface s e enclosing the body and some part of the fluid is drawn in the flow field with the minimum distance between s b and s e approaching infinity and the position vector of a point on s e is denoted by r the fluid surface adjacent to the body surface s b is denoted by s i though the volume enclosed by s b and s i is zero they are not overlapped for two adjacent points lie on s b and s i respectively their velocities are the same in viscous flow due to the non slip boundary condition but are different in inviscid flow due to the slip boundary condition the region between s b and s e is denoted by r f the region enclosed by s i is denoted by r b the region enclosed by s i and s e is denoted by r f the position vector of a point in r f is denoted by r the velocity distribution in the flow field is denoted by v its curl the vorticity of the flow field is denoted by ω the flow field of the non stream circumstance viewed in the inertial frame o x y z is denoted by s including the distribution of v and ω the relationships of variables position vectors surfaces and regions described above are illustrated in fig 1 for the convenience of description a translational frame d x d y d z d is built with the origin d fixed on the body and the three axis d x d d y d d z d parallel to o x o y o z respectively as d may move with time variant velocity d x d y d z d is often a non inertial frame and a subscript d is added to the notation of the vectors when they are viewed in this frame for examples r r d v v d r r d etc the flow field of the non stream circumstance viewed in the d x d y d z d is denoted by s d the translational frame d x d y d z d and the vectors relative to it are illustrated on the left side of fig 2 for the stream circumstance a subscript w is added to the notation of the vectors to distinguish them from the corresponding variables in the non stream circumstance for examples r r w v v w r r w etc and the stream flow field is denoted by s w the donation of the inertial frame is also changed to o w x w y w z w the undisturbed stream field is supposed to be uniform and its velocity referencing to the inertial frame is denoted by v r w t v t the translational velocity of the body is denoted by v d w t and its difference between v t is defined as the relative motion velocity of the body i e v r w t v d w t v t in the stream circumstance the body is not necessarily rest consequently v d w t is not necessarily zero and this is why o w is not coincident with d w the inertial frame o w x w y w z w and some vectors relative to it are illustrated on the right of fig 2 the flow field referenced to the translational coordinate in the stream circumstance is denoted by s d w s d and s d w are two intermediate fields that would be used to compare s and s w to further illustrate the difference between a stream field and the corresponding non stream field under the same relative motion velocity the position attitude and velocity of the body are supposed to be the same at moment τ as illustrated in fig 2 for the convenience of comparison s e is temporarily supposed to be rest relative to the inertial coordinate and v d w is set to zero in stream circumstance in the non stream circumstance the body moves relative to the inertial frame o x y z and r d changes with time in the stream circumstance the body keeps position relative to the inertial frame o w x w y w z w and r d w is constant consequently for a point q in the flow field with the same and constant position vector relative to point d its position vector relative to the inertial frame is also constant in stream circumstance but is time variant in the non stream circumstance the discussion above can be clearly illustrated by comparison between the flow field at moment τ and τ δ τ which is illustrated in fig 3 2 2 motion model of the flow fields it is often assumed that the flow field can be modeled by a set of partial differential equations and corresponding boundary and initial conditions wu 2014 this hypothesis can be used to clarify the motion model of the flow fields in both stream and non stream circumstances as the classical model of navier stokes equation set includes pressure which is inconvenient for flow field and hydrodynamics comparison the velocity vorticity based model is considered here the theory of vorticity dynamics wu 2014 shows that the incompressible flow field can be described by continuity equation the definition of vorticity and the vorticity transportation equation considering the description of variables in the previous subsection equations of motion for the non stream flow field are 1 v 0 v ω ω t v ω ω v ν e 2 ω where ν e is the kinematic viscosity of the fluid to solve these equations the boundary condition and initial condition should be given detail discussion on this topic can be referenced to wu 1976 patterson et al 1987 the result shows that an appropriate method for determining the solution in a limited period 0 t t 1 is to prescribe the initial velocity distribution and enforce boundary velocity on s i and s e the velocity on s i can be determined by the non slip and non penetration boundary condition according to the velocity distribution on s b the velocity on s e is approximately zero for the non stream circumstance and in numerical simulation it can be approximated by v r t 0 consequently the motion model with reference to inertial frame for the non stream circumstance is 2 v 0 v ω ω t v ω ω v ν e 2 ω v r i t f r i t v r 0 v r 0 g r if the velocity distribution on s e is changed to v w r w v t the discussion above is also valid for stream circumstance considering the description of variables in the previous subsection the motion model with reference to inertial frame for the non stream circumstance is 3 w v w 0 w v w ω w ω w t v w w ω w ω w w v w ν e w 2 ω w v w r i w t f w r i w t v w r w t v t v w r w 0 g w r w where w x w i w y w j w z w k w is the hamilton operator in the inertial frame and i w j w k w is the base vector of inertial frame o w x w y w z w now consider the motion model with reference to translational frame d x d y d z d for non stream circumstance according to the description of variable in the previous subsection r d 0 t v d d τ r d r r d and v d r d v r v d as the axes of o x d y d z d are parallel with those of d x y z respectively it is not difficult to show that d d v d v d v d v and d ω d d t ω t v d ω the last formula is consistent with formula 6 in ref ostieri et al 2018 and evidences its correctness substitute the formulas discussed above into the third formula in eq 2 the motion model with reference to translational frame d x d y d z d for non stream circumstance can be acquired as 4 d v d 0 d v d ω d d ω d d t v d d ω d ω d d v d ν e d 2 ω d v d r i d f r i t v d t v d r d v d t v d r d 0 g r v d 0 similarly the flow field motion model with reference to the translational frame d w x d w y d w z d w in stream circumstance is 5 d w v d w 0 d w v d w ω d w d w ω d w d w t v d w d w ω d w ω d w d w v d w ν e d w 2 ω d w v d w r i d w f r i w t v d w t v d w r d w v t v d w t v d w r d w 0 g w r w v d w 0 2 3 relationship between the stream and non stream flow fields the purpose of this section is to build the relationship between s and s w the skill adopt here is to introduce the intermediate flow field s d and s d w as s and s d represent the same flow field viewed under different reference frame they can be transformed by 6 r d r r d v d r d t v r t v d t ω d r d t ω r t where r d 0 t v d d τ similarly the transformation between s w and s d w is 7 r d w r w r d w v d w r d w t v w r w t v d w t ω d w r d w t ω w r w t where r d w 0 t v d w d τ the comparison between s and s w is then transformed to the comparison between s d and s d w let the boundary and initial condition of the model 4 and 5 be the same respectively or 8 v w r i w t v r i t v t v d v d w v t v w r w 0 v r 0 v 0 one finds that the model 4 and 5 are the same except for the symbol of the variables the variables are marked with subscription d in equation set 4 and are marked with subscription d w in equation set 5 as different donation of the variables does not change the solution of an equation set one concludes that v d r d t v d w r d w t this means that the velocity or vorticity referenced to the translational frame is the same in the stream and non stream flow fields as long as condition 8 is fulfilled considering transformation 6 and 7 and condition 8 this conclusion can be rewritten as 9 r w r r d r d w v w r w t v r t v t ω w r w t ω r t the results above show that the flow field of a body moving in uniform and unsteady steam can be acquired based on the flow field of a body moving in a non stream flow field according to eq 9 as long as condition 8 is fulfilled the second condition in 8 requires that the relative motion velocities in the two circumstances are the same the first condition in 8 requires that the velocity distribution difference on the body surface is equal to v t for rigid bodies this in fact requires that their angular velocities are the same the third condition in 8 requires that the initial velocity distribution difference in the flow field is equal to v t it should be emphasized that the position vector for r w is different from that of r as clarified in eq 9 or illustrated in fig 3 and the relative discussion thus the relationship of the velocity variation in the two circumstances is not v w r w t t v r t t d v d t but 10 d w v w r w t d t d v r t d t d v d t this conclusion would be further discussed and numerically confirmed the comparison of the ns equation in different reference frames was discussed by batchelor 1967 the result shows that additional terms should be added to the ns equation to account for the motion of the non inertial frame this results in the different forms of ns equation in the different frames which is inconvenient for comparing the flow fields this is another reason why the vorticity transport equation is adopted here instead of the ns equation for inviscid flow ω 0 and the vorticity transport equation is unnecessary for the fluid motion models the left equations in the model is often called the kinematic part and can be converted into the laplace equation when the normal velocity on the body surface and the stream velocity is given the laplace equation is determined wu 2014 consequently the discussion above for viscous flow can be followed and the transformation rule 9 is still valid for inviscid flow at the same time the relationship of initial velocity distribution is not required in the transformation condition i e in eq 8 3 hydrodynamics transformation method as discussed in the introduction a variety of hydrodynamic force or moment formula that is independent of the pressure distribution and is applicable for viscous flow had been proposed since the late 1970s however these formulas are complex for building the hydrodynamics relationship basing on the decomposition of the flow field in eq 9 in this section new hydrodynamics formulas that are linearly dependent on the decomposition of the flow fields are proposed to clarify the hydrodynamics transformation rules 3 1 hydrodynamic force transformation method due to the slip boundary condition in inviscid flow the velocity is not continuous on r f to make sure that the flowing discussion is also applicable in inviscid flow the fluid in r f instead of r f is considered by applying the momentum balance theorem wu et al 2006 on r f the hydrodynamic force f w acted on the body can be expressed as 11 f w r f ρ d v w d t d r s e t w n d s where n is the outwards normal of s e the last term in eq 11 represents the total force acted on surface s e by the fluid outside of s e for newtonian fluid it can be shown that t w n p w n μ ω w n 2 μ n w v w wu et al 2015 by substituting the constitutive equations into t w μ is the kinetics viscosity of the fluid and p w is the static pressure according to the derivative moment transformation dmt formula 44 12 s e p w n d s 1 n 1 s e r w n p w d s where n is the dimension of the flow field p w can now be eliminated by noca s method noca et al 1999 i e replace p w with ρ d v w d t μ 2 v w according to the ns equation further considering that the integral of n v w on a closed surface is zero wu et al 2015 the hydrodynamic force in eq 11 can be rewritten as follow after some algebra operation 13 f w r f ρ d v w d t d r s e μ ω w n d s 1 n 1 s e r w n ρ d v w d t μ 2 v w d s according to eq 11 f w is independent of r w consequently f w should be independent on the starting point of the position vector r w in fact the starting point of the position vector would not affect the validity of the dmt formulas as discussed in wu et al 2015 which is also emphasized in the appendix for either of these two reasons r w in eq 13 can be replaced by r though they are different according to eq 9 according to the flow field transformation formula 9 and 10 f can be decomposed into two terms i e f w f f with 14 f r f ρ d v d t d r s e μ ω n d s 1 n 1 s e r n ρ d v d t μ 2 v d s f r f ρ d v d t d r ρ n 1 s e r n d v d t d s as 2 v v v 0 the term μ 2 v does not appear in f by applying the dmt formula 45 the region integral in f can be further decomposed 15 r f ρ d v d t d r ρ n 1 r f r d v d t d r ρ n 1 s i s e r n d v d t d s where n is the outwards normal of r f surface i e n is positive on s i when pointing to the body noting that v is uniform the first term on the right hand of eq 15 is zero and f can be simplified as 16 f ρ n 1 s i r n d v d t d s by applying the dmt formula 44 and the gauss theorem f can be rewritten as 17 f ρ r b d v d t d r ρ d d t r b v d r ρ v d v d t where v is the volume of r b it is also the volume of the body at last one gets 18 f w f ρ v d v d t the derivation process of eq 13 shows that it is also applicable for the non stream circumstance this means that f in 14 is exactly the hydrodynamic force when the body moves with the same relative velocity in the non stream circumstance consequently eq 18 is the transformation formula for the hydrodynamic force between stream circumstance and non stream circumstance provided that condition 8 is fulfilled transformation 18 is applicable for both viscous and inviscid flow according to its derivation process 3 2 hydrodynamic moment transformation method the hydrodynamic moment transformation method can be derived in a similar way by applying the momentum moment balance theorem wu et al 2015 on the region r f one gets 19 m w r f ρ r 1 w d v w d t d r s e r 1 w t w n d s where r 1 w is the position vector of a fluid particle referencing to the reference point o 1 w of the hydrodynamic moment for convenience o 1 w is enforced to keep constant position vector reference to point d or fixed on a rigid body this is also the treatment in defining the hydrodynamic moment in flight dynamics or studying the mechanics of a submarine in this case r 1 w r d w o 1 w r d w where constant r d w o 1 w is the position vector pointing from o 1 w to d w then r 1 w are the same in the steam and non stream circumstances according to eq 9 and the relevant discussion for this reason the difference between r 1 and r 1 w is not distinguished in the following discussion as t w n p w n μ ω w n 2 μ n v w the last term on the right hand of eq 19 can be decomposed into 20 s e r 1 t w n d s μ s e r 1 ω w n d s 2 μ s e r 1 n v w d s s e r 1 n p w d s by applying the dmt formula 46 on the last term on the right side of eq 20 the integrand can be transformed into a function of p w eliminate the pressure term with ns equation m w can be rewritten as 21 m w r f ρ r 1 d v w d t d r ρ 2 s e r 1 2 n d v w d t d s μ 2 s e r 1 2 n ω w d s μ s e r 1 ω w n d s 2 μ s e r 1 n v w d s according to the flow field transformation formula 9 and 10 m w can be decomposed into two terms i e m w m m with 22 m r f ρ r 1 d v d t d r ρ 2 s e r 1 2 n d v d t d s μ 2 s e r 1 2 n ω d s μ s e r 1 ω n d s 2 μ s e r 1 n v w d s m r f ρ r 1 d v d t d r ρ 2 s e r 1 2 n d v d t d s by applying dmt formula 47 the region integral in m can be rewritten as 23 r f ρ r 1 d v d t d r ρ 2 r f r 1 2 d v d t d r ρ 2 s i s e r 1 2 n d v d t d s as v is uniform on r f r b the first term on the right hand of eq 23 is zero consequently m can be simplified as 24 m ρ 2 s i r 1 2 n d v d t d s ρ r b r 1 d v d t d r ρ v r v d v d t where r v is the position vector pointing from o 1 to the volume center of the body the second equal sign is due to the dmt formula 47 the third equal sign is due to the uniform distribution of d v d t and the definition of position vector r v the derivation process of m w in eq 21 shows that it is also applicable for the stream circumstance this means that the m in eq 22 is exactly the hydrodynamic moment when the body moves with the same relative velocity in the non stream circumstance consequently the hydrodynamic moment transformation method between the stream circumstance and the non stream circumstance is 25 m w m ρ v r v d v d t this transformation formula is valid in both viscous and inviscid flow according to its derivation process the transformation formula 18 and 25 show that the hydrodynamics of a body moving with the same relative velocity do not necessarily keep the same between the stream and non stream circumstance in the circumstance that the stream velocity is uniform and time invariant the hydrodynamics are the same and this result is well known as the principle of relative motion if the stream velocity is time variant the hydrodynamic force and moment between the two circumstances are different and can be transformed by formula 18 and 25 respectively 4 verifications and observations to verify the correctness of the derivation results above flow field transformation formulas 10 and hydrodynamics transformation formulas 18 and 25 are compared with theoretical or numerical results in both inviscid and viscous flow then the rationality of existing results on the relative motion principle is discussed 4 1 comparison with theoretical and numerical result in inviscid flow according to the discussion of anderson 2014 the inviscid flow field includes the steady cyclic flow field in the two dimensional flow however for inviscid fluid the flow field will keep acyclic according to the theorem of kelvin if the flow is acyclic initially in two dimensional flow we consider only this acyclic inviscid flow field here as the cyclic inviscid flow field in fact considered the effect of the fluid viscosity during the transient or unsteady process before the steady state 4 1 1 verification of the flow field transformation formula we first check the flow field transformation formula 9 the inviscid flow field can be numerically calculated basing on the panel method which distributes sources on the surface of the moving body this method had already been well documented by hess and smith 1967 and can also be found in more recent ref cebeci et al 2004 this method clearly shows that the inviscid flow field between the stream and non stream circumstance fulfills the transformation formula 9 consequently we need only to further check the correctness of eq 10 or d w v d t d v d t d v d t to clearly show this relationship the two dimensional flow field induced by a circle is studied analytically instead of numerically as shown in fig 4 the velocity distribution of the flow field is katz and plotkin 2001 26 v r w r w θ w t u t cos θ w 1 r 2 r w 2 v θ w r w θ w t u t sin θ w 1 r 2 r w 2 where u is the velocity of the stream θ w is the angular between r w and o x v r w is the velocity component in the r w direction and v θ w is the velocity component in the θ w direction r is the radius of the cylinder cross section as shown in fig 4 eq 26 can be rewritten as v w v x w i w v z w k w with 27 v x w x w y w t u t u t r 2 x w 2 z w 2 x w 2 z w 2 2 v z w x w y w t u t 2 r 2 x w z w x w 2 z w 2 2 though this stream circumstance flow field is acquired under the hypothesis that the stream is steady it is also applicable if the incoming flow is time variant this is because the laplace equation is valid in both time dependent and time independent inviscid flow fields according to transformation rule 9 the velocity distribution in the corresponding non stream flow field is v r d t v w r w t v or v r r d v w r w v where r d 0 t v d d t and v d u t i is the velocity of the cylinder cross section center consequently 28 v x x y t u t r 2 x x d 2 z z d 2 x x d 2 z z d 2 2 v z x y t u t 2 r 2 x x d z z d x x d 2 z z d 2 2 where v x v z is the two components of vector v now the v w t and v t can be calculated analytically as 29 v w t d u t d t i w d u t d t r 2 x w 2 z w 2 x w 2 z w 2 2 i w d u t d t 2 r 2 x w z w x w 2 z w 2 2 k w 30 v t d u t d t r 2 x x d 2 z z d 2 x x d 2 z z d 2 2 i v x x d d x d d t v x z d d z d d t i d u t d t 2 r 2 x x d z z d x x d 2 z z d 2 2 k v z x d d x d d t v z z d d z d d t k v w t d u t d t i v x x v d x v x z v d z i v z x v d x v z z v d z k v w t v d v d u t d t i v w t v v d u t d t i the result above clearly shows that v w t v t d v t d t this difference according to the calculation process above is due to the fact that the position r d is time variant as d is moving in the non stream circumstance considering that v w v w v v v v v v v v the fluid particle acceleration of the two fields are 31 d v w d t v w t v w v w v w t v v v v d v d t v t v v v w t d v t d t v v v v respectively they obviously fulfill d v w d t d v d t d v t d t and verifies the correctness of eq 10 4 1 2 verification of the hydrodynamic force transformation formula to compute the unsteady hydrodynamic force in inviscid flow the following pressure independent hydrodynamic force formula provided by newman 2018 p141 is considered 32 f ρ d d t s i ϕ n d s ρ s i ϕ n ϕ d s ρ 2 s i ϕ ϕ n d s by applying dmt formula 44 this formula can be rewritten as 33 f ρ n 1 d d t s i r v n d s ρ s i v v n d s ρ 2 s i v v n d s this formula is velocity vector based and is more convenient for program debugging as the velocity distribution of the flow field is more intuitional for an ellipsoid with semi major axis a 0 5 and semi minor axis b 0 1 the non stream flow field is numerically calculated based on the panel method hess and smith 1967 and the hydrodynamic force f in eq 33 is evaluated the result shows that the last two terms do not contribute to the value of f when the ellipsoid moves either steady or unsteady as the starting point of r is arbitrary according to the characteristic of the dmt formulas wu et al 2015 it is fixed on the ellipsoid center d during calculation in this case r is time independent for a fixed point on s i and is convenient for evaluating the integral i 1 ρ s i r v n d s n 1 the result shows that i 1 is exactly the impulse of the flow field i e 34 i 1 m f v v d m f w ω b where m f v and m f w are the added mass tensor representing the effect of the translational and angular acceleration on the hydrodynamic force the corresponding matrix for these tensors are 35 m f v m 11 0 0 m 11 m f w 0 0 for ellipsoids theoretical study shows that m 11 ρ π b 2 m 22 ρ π a 2 newman 2018 p152 the numerical study shows that the relative error of m 11 and m 22 based on formulas 33 and 34 are both less than 0 001 when the panel on the ellipsoid surface is 640 all these studies evidence the correctness and accuracy of the program now the hydrodynamic forces in the stream circumstance and non stream circumstances are calculated under the same relative velocity and the result are plotted in fig 5 in the first scenario the angular velocity of the ellipsoid is set to zero with a constant attack angle 5 in the non stream circumstance the translational velocity is v d 2 sin t m s i and the hydrodynamic force f x parallel to v d is plot on the left side of fig 5 with blue dots in the stream circumstance the ellipsoid is resident in the stream and the hydrodynamic force f x w parallel to v is plot on the left side of fig 5 with the blue line their difference δ f x f x w f x is plot on the right side of fig 5 with blue stars the theoretical result of δ f x according transformation formula 18 is also plot on the right side of fig 5 with the red line it can be clearly seen that the numerical data of δ f x is coincident with the theoretical result in scenario two an angular velocity of ω b 0 1 sin t rad s i is added to the ellipsoid with zero initial attack angle and the calculation process is repeated f x and f x w are plotted on the left side of fig 5 with red dots and a red line respectively it is well known that the angular velocity would not affect the hydrodynamic force of an ellipsoid if the translational velocity is defined as the velocity of its center the difference of f x or f x w between the two scenarios as shown on the left of fig 5 is therefore due to the change of attack angle the difference of δ f x f x w f x is also plot on the right side of fig 5 with red circles it can be clearly seen that the numerical data of δ f x in this scenario is also coincident with the theoretical result this means that the difference of the hydrodynamic force between the stream and non stream circumstances is dependent on the acceleration of the stream and is independent of the motion of the solid this result is consistent with the translation formula 18 and all the discussion above verifies the correctness of this formula 4 1 3 verification of the hydrodynamic moment transformation formula similarly the pressure independent hydrodynamic moment formula can be acquired following newman s discussion newman 2018 p141 36 m d d t s i ϕ r n d s ρ 2 s i r n v v d s s i r v v n d s let r r o 1 r 1 where r o 1 is the position vector of o 1 the reference point of the hydrodynamic moment and r 1 is the position vector of points in the flow field referencing to o 1 noticing that r o 1 is space independent one gets 37 m r o 1 f m o 1 m o 1 v o 1 s i ϕ n d d t s i ϕ r 1 n d s ρ 2 s i r 1 n v v d s s i r 1 v v n d s where f is the hydrodynamic force m is the hydrodynamic moment referencing to point o and m o 1 is the hydrodynamic moment referencing to point o 1 during the calculation o 1 is fixed on the rigid body so that the acquired hydrodynamic moments are the same as those adopted in flight dynamics or submarine mechanics the formula above is velocity potential based and the velocity vector based form can be obtained by applying the dmt formula 45 and 46 38 m o 1 1 2 d d t s i r 1 2 n v d s v o 1 s i r 1 v n n ρ 2 s i r 1 n v v d s s i r 1 v v n d s the numerical study can also be carried out on the same ellipsoid adopt to study the hydrodynamic force similarly the correctness of formula 38 is checked first in the non stream circumstance numerical study shows that the last two terms on the right hand of eq 38 do not contribute to the value of m o 1 the integral in the second term on the right hand of eq 38 is exactly the impulse of the flow field according to the numerical study of hydrodynamic force consequently the hydrodynamic moment formula provided by lamb 1945 is reprised i e 39 m o 1 d l 1 d t v o 1 i 1 l 1 s i r 1 2 n v d s it should be noted that v o 1 is the velocity of the hydrodynamic moment reference point it is not necessary the translational velocity of the solid v d as shown by lamb consequently the lamb formula is only a special case of the hydrodynamic moment formula of 39 theoretical study shows that the impulse moment can be represented by 40 l 1 m m v v d m m w 21 ω b and the corresponding matrix for tensor m f w and m f w are 41 m m v 0 0 m m w 21 m 66 with m 66 ρ π a 2 b 2 2 8 newman 2018 p152 for ellipsoids the numerical study shows that the relative error of m 66 based on formulas 38 and 40 is less than 0 2 when the panel on the ellipsoid surface is 640 all these studies evidence the correctness and accuracy of the program similarly the hydrodynamic moments in both circumstances are calculated under the same relative velocity and are compared with the transformation formula 25 the transformation formula 25 shows that the difference of the hydrodynamic moment would be zero if the reference point o 1 is coincident with the volume center of the ellipsoid d and the numerical result verifies this conclusion to further verify the transformation formula 25 the reference point o 1 is fixed on the body with coordinates 0 1 in the body fixed frame so that the difference of hydrodynamic moment between the two circumstances would be non zero in the first scenario the angular velocity of the ellipsoid is set to zero with a constant attack angle 5 in the non stream circumstance the translational velocity is v d 2 sin t m s i and the hydrodynamic moment m z parallel to o z is plot on the left side of fig 6 with blue dots in the stream circumstance the ellipsoid is resident in the stream and the hydrodynamic moment m z w parallel to o w z w is plot on the left side of fig 6 with a blue line their difference δ m z m z w m z is plot on the right side of fig 6 with blue stars the theoretical result of δ m z according transformation formula 25 is also plot on the right side of fig 6 with red line it can be clearly seen that the numerical data of δ m z is coincident with the theoretical result in scenario two an angular velocity of ω b 0 1 sin t rad s i is added to the ellipsoid with zero initial attack angle and the calculation process is repeated m z and m z w are plotted on the left side of fig 6 with red dots and a red line respectively the difference of angular velocity and attack angle would both affect the hydrodynamic moment and result in its difference between the two scenarios under the same circumstance this difference of hydrodynamic moment between different scenarios are also clearly shown on the left side of fig 6 and the difference of δ m z m z w m z in scenario two is also plot on the right side of fig 6 with red circles it is clear that δ m z s numerical data in this scenario is also coincident with the theoretical result this means that the difference of hydrodynamic moment between the stream and non stream circumstance is dependent on the acceleration of the stream and is independent of the motion of the solid this result is consistent with translation formula 25 and all the discussion above verifies the correctness of this formula in inviscid flow 4 2 comparison with numerical result in viscous flow to check the correctness of the transformation formulas 9 18 and 25 the viscous flow field and hydrodynamics of a naca0015 airfoil are numerically calculated with the software fluent the chord length of the airfoil is 1 the attack angle is 5 the flow field is calculated under the stream circumstance and the non stream circumstance respectively with the same relative velocity for the convenience of description a translational frame is built with the origin d fixed on the leading edge of the airfoil the d x d axis is parallel with the relative velocity and is pointing to the trail of the airfoil the d z d axis is perpendicular to the d x d axis and pointing upwards the flow field is calculated within a circle s e whose radius is 19 and the center coordinates is p 1 5 0 1 the fluid is air with density ρ 1 225 kg m 3 and the far field boundary condition is set to velocity inlet as shown in fig 7 the independence on the grid number is checked and verified first three grids with total number 96800 169830 210000 respectively are applied to numerically calculate the drag and lift of a naca0012 airfoil moving with constant velocity 29 2 m s and reynolds number r e 2 0 1 0 6 the sstk omega turbulence model is adopted and the residuals of the continuity and velocities are all less than 1 0 1 0 6 in absolute criteria when converged the comparison of the result with the experimental data of ladson 1988 is listed in tables 1 and 2 the tables show that the numerical result is coincident with the experimental data and the different grid number does not affect the numerical result significantly consequently a grid with a total number of 119 380 is adopted to study the unsteady state hydrodynamics the time step in the unsteady flow field simulation is 0 005 s and the max iterations in one time step is 20 for the stream circumstance the velocity of the stream is in the d x d direction with amplitude v 1 0 5 sin 2 π t m s and the body is rest the initial condition of the flow field is the steady flow field of the body rest in the stream with v 1 m s for the non stream circumstance the velocity of the body is opposite to the d x d direction with amplitude v d 1 0 5 sin 2 π t m s and the initial condition of the flow field is the steady flow field of the body moving with constant velocity v d 1 m s to avoid the difficulty of re grid during calculation in the non stream circumstance the moving reference frame mrf ansys 2013 technology is adopted numerical simulation results show that the two flow fields fulfill the transformation formula 9 quite well at time t 3 s we transform the non stream velocity field by formula 9 and then compare it with the stream field velocity the difference is normalized by the stream speed at that moment the result shows that the maximum error is within 1 60 and 1 58 in the d x d and d z d direction respectively the average error in these two directions are 0 54 and 0 11 respectively the comparison of lift in the two circumstances shows that they are almost the same this is consistent with formula 18 as the lift is perpendicular to the body translation velocity or stream velocity for the stream circumstance the drag the moment and the stream speed are plotted in fig 8 it can be seen that the drag or moment is not in phase with the stream speed this is because the unsteady hydrodynamics are dependent not only on the relative velocity but also the relative acceleration as the phase between the velocity and acceleration is 90 the drag or moment is not necessarily in phase with velocity the drag difference between the two circumstances and the acceleration of the stream a are plotted in fig 9 it can be seen from fig 9 that the drag difference is in phase with a π cos 2 π t what is more the numerical result δ f x f x w f x matches well with the d x d component of the theoretical result f w f in formula 18 if the error is normalized by the maximum value of the drag the relative error is within 0 22 this consistency verifies the correctness of formula 18 it can be seen from eq 25 that the moment difference is dependent on the reference point of the moment when the position vector r v is almost parallel with the d x d axis the moment difference of the two circumstances would be small the numerical calculation results confirmed this conclusion to further illustrate the correctness of formula 25 the reference point of the moment is set on point o 1 0 1 in this case r v is vertical to d x d or the relative velocity and the difference of the hydrodynamic moment should be distinct the moment difference curve and the acceleration of the stream a are plotted in fig 10 the result shows that the moment s difference is assuredly not small and is in phase with a π cos 2 π t what is more the numerical result of the hydrodynamic moment in d z d direction δ m z m z w m z matches well with the theoretical result in formula 25 if the error is normalized with the maximum value of m z the relative error is within 0 40 this consistence verifies the correctness of the formula 25 4 3 observations as introduced in the introduction several theories concerning the relative motion principle had been proposed by previous scholars we now compare their conclusion with this study the first conclusion for relative motion principle under unsteady and uniform incoming flow is drawn by d alembert who proved that the drags are still the same under the two circumstances in the development of the zeta program patterson et al 1987 p8 14 it is even supposed that the hydrodynamic force and moment are both same when the stream is translating or rotating unsteady this is obviously in conflict with this study and the conclusions of other scholars the reason for this phenomenon is because the far field pressure distribution is unknown to scholars of the d alembert era a hypothesis that the pressure at far field is zero is adopted by d alembert during his derivation calero 2018 p29 this results in no contribution of the pressure on s e to the hydrodynamic force on the solid this conflicts with the modern study which shows that the pressure integral on s e is not necessarily zero in unsteady flow field wu 2014 p94 in fact the pressure integral on s e is still unknown to scholars even in the lamb era lamb 1945 p162 who missed the contribution of velocity potential during its estimation these facts also explain why the principle of relative motion in an unsteady stream cannot be solved in the early days the morison formula shows that the hydrodynamic force act on a unit length circular cylinder by the stream is morison et al 1950 42 f ρ c m π d 2 4 u t ρ c d d 2 u 2 where u is the velocity of the uniform stream which is vertical to the axis of the cylinder and d is the diameter of the circular cylinder for inviscid flow c m is exactly 2 according to the study of ocean engineering newman 2018 the deviation of c m from 2 in some refs zan and lin 2020 is due to the effect of viscosity the first term on the right hand of eq 42 represents the hydrodynamic force related to the acceleration of the stream the second term represents the hydrodynamic force that is related to dynamic pressure for irrotational inviscid flow only the first term exists according to formula 18 the hydrodynamic force acting on the cylinder can be decomposed into two parts the scalar form of the second part is ρ v d u d t π ρ d 2 4 u t as v u is uniform on r b r f the first part on the right of formula 18 is the hydrodynamic force acted on the circular cylinder when it moves in the non stream circumstance with the same relative velocity u as the added mass of a unit length circular cylinder moving perpendicular to its axis is π ρ d 2 4 khoury 2012 p35 the second part on the right hand of eq 18 is π ρ d 2 4 u t according to the concept of added mass consequently the hydrodynamic force evaluated by formula 18 is exactly the first term of the morison formula with c m 2 this means that formula 18 is consistent with the morison formula the relative motion principle drawn from the morison formula is only applicable to long cylinders a more general form of relative motion principle that is the same as transformation formula 18 had been proposed by batchelor 1967 p409 in the meantime batchelor also showed that the difference of the fluid particle accelerations between an inertial reference frame and a translational frame is d v d d t these results can be regarded as evidence of the correctness of transformation formulas 10 and 18 respectively however an acquiescent assumption that the stream flow field observed on a translating frame is the same as the non stream flow field is adopted by batchelor this assumption is exactly transformation rule 9 that had been rigidly proved in this study batchelor s study considered only the hydrodynamic force due to the pressure difference between the two flow fields in this study the effect of the viscous shearing stress is also considered and the result is extended to hydrodynamic moment transformation i e eq 25 in fossen 1994 the concept of froude krilov force is generalized to froude krilov moment and their formulas are expressed by matrix operation form 43 f f k m v m m k m r v v where m ρ v represents the mass of the fluid required to fill the volume occupied by the body f f k m f k and v are the column matrix of the hydrodynamic force f f k the hydrodynamic moment m f k and the stream velocity v respectively when they are projected in the body fixed frame r v is the antisymmetric matrix of r v and r v is the column matrix of the position vector r v when it is projected in the body fixed frame if the body is not rotating v is precisely the column matrix of vector d v d t when it is projected in the body fixed frame consequently the froude krilov force or moment introduce by fossen 1994 is exactly the last term of the transformation formula 18 and 25 this in some way evidences the correctness of the study in this paper for the case that the body is rotating the projection of d v d t in the body fixed frame would be v ω b v where ω b is the antisymmetric matrix of ω b and ω b is the column matrix the body angular velocity vector ω b when it is projected in the body fixed frame this means that the froude krilov force or moment introduced in fossen 1994 is inconsistent with the transformation formula 18 or 25 as ref fossen 1994 does not clarify whether the body frame is rotating or not we regard the transformation formula 18 and 25 in inviscid flow as generalizations of the froude krilov force or moment decomposition methods introduced in fossen 1994 in the study of thomasson 2000 the motion model of a solid moving in the nonuniform and unsteady stream had been proposed by thomasson by moving all the terms that are dependent on the density of the fluid to the right hand of the equations the hydrodynamic force or moment formula acted on the solid can be acquired as these formulas are applicable in both stream and non stream circumstance the relative motion principle can be clarified the result shows that the hydrodynamic force difference between non stream circumstance and stream circumstance is also ρ v v while the hydrodynamic moments are the same when the relative velocities are equal and the stream is uniform this result conflicts with the transformation rule 18 drawn in this study for the case that the solid body is a sphere its hydrodynamic force should be independent of the sphere s angular velocity consequently the difference of the hydrodynamic forces between the two circumstances would not be affected by the angular velocity of the solid thomasson s result is obviously in conflict with this phenomenon and is not acceptable the transformation formula 18 is consistent with this phenomenon and is more reasonable noting that the reference point of hydrodynamic moment is supposed to be coincident with the volume center of the body in thomasson s study one gets r v 0 in formula 25 this means that the transformation formula 25 is consistent with thomasson s result and the hydrodynamic moment transformation method based on thomasson s study is only a special case of the transformation formula 25 when the stream is uniform the motion model of a solid moving in uniform and unsteady stream had also been proposed by lewis et al 1984 and the principle of relative motion can be acquired based on this model similarly the result shows that the hydrodynamic force difference in the two circumstances is m v m ω b v and are consistent with this study however the hydrodynamic moment difference between the two circumstances is m r v v m r v ω b v ω b λ m v v and is different from our result by ω b λ m v v where λ m v is the 3 3 added mass matrix representing the effect of the translational acceleration on the hydrodynamic moment 5 conclusions for a body moving in the incompressible flow the effect of uniform stream velocity on the flow field and the body hydrodynamics are studied under the hypothesis that the relative velocities of the body are the same the result shows that the velocity and vorticity field can be transformed by formula 9 i e the vorticity fields are the same and the velocity field of the non stream circumstance equals to the stream circumstance adding the stream velocity the hydrodynamic forces can be transformed by formula 18 and the hydrodynamic moments can be transformed by formula 25 the hydrodynamics are the same in the two circumstances if the stream velocity is time independent which is well known as the principle of relative motion these transformation formulas are applicable in the inviscid flow as well credit authorship contribution statement xianwu lin conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization funding acquisition shichao wang software data curation visualization writing review editing bing zhu software funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix the following derivative moment transformation dmt formula had been quoted in the paper the detailed proof of these formulas can be found in ref wu et al 2015 p421 422 for a closed surface s let n be its outwards normal n be the dimension of the flow field ϕ is a continuous scalar field r is the position vector of the flow field referencing to an arbitrary point then 44 s ϕ n d s 1 n 1 s r n ϕ d s n 2 3 let r be a region of the flow field enclosed by s and f be a continuous vector field then 45 r f d r 1 n 1 r r f d r 1 n 1 s r f n d s n 2 3 46 s r n ϕ d s 1 2 s x 2 n ϕ d s n 2 3 47 2 r r f d r r r 2 f d r s r 2 n f d s n 2 3 
20277,acoustic doppler current profilers adcps are the standard tool for measuring tidal currents at tidal stream energy sites they are used to estimate several parameters including turbulent kinetic energy tke however estimates of tke from adcps are often swamped by wave action we surmise that this bias can be detected as a data mode to test this we present an empirical orthogonal function eof analysis of two months of tke estimates from adcp measurements at a tidal energy site with significant wave activity the results of the analysis were compared with linear wave theory using data from a wave buoy the first data mode identified from eof analysis agrees well with the wave bias predicted by linear theory and the resulting decomposition of the data set into wave and turbulent components appears realistic this decomposition is possible from adcp data alone and therefore offers a novel and widely applicable analysis technique for simultaneous assessment of turbulence and waves at highly energetic tidal sites the method can also be applied retrospectively to historical data sets we also show that the decomposition can be improved by including higher eof modes but this requires an independent measurement of waves to determine the optimum number of modes keywords waves turbulence turbulent kinetic energy empirical orthogonal analysis tidal power 1 introduction the combined action of waves and turbulence in energetic tidal currents is the strongest contributor to load variability on tidal energy converters tecs milne et al 2016 elasha et al 2017 mccann 2007 quantifying these phenomena from field measurements at actual or potential deployment sites however is not a trivial task the most widely employed tools for measurement of flow conditions are acoustic doppler current profilers adcps these are recommended by iec standards iec ts 62600 201 and therefore effectively required in an industrial context it is quite straightforward to estimate mean flow properties such as depth profiles of mean current speed and direction from adcp measurements lu and lueck 1999a but calculating properties relating to phenomena that take place on smaller spatial scales than the beam spread of the adcp is more challenging a variety of techniques are available to estimate turbulence and wave quantities from adcps or similar acoustic devices bouferrouk et al 2016 mcmillan and hay 2017 guerra and thomson 2017 in the current paper we focus on the estimation of turbulent kinetic energy tke using the variance method stacey et al 1999 lu and lueck 1999b an important shortcoming of the variance method for estimation of tke is that since it is based on measurements of velocity variance it implicitly assumes that all velocity variance is attributable to turbulent action any source of velocity variance other than the turbulence will therefore introduce a positive bias into the estimate of tke from adcp measurements most significantly this includes the variance associated with orbital wave velocities the bias introduced by this may be so high that a naive estimate of tke can be approximately an order of magnitude higher than the true value the relative importance of waves and turbulence for a given tec will differ depending on its design most significantly whether it is affixed to the bed or is mounted on a floating hull we therefore wish to be able to separately measure the effects of waves and turbulence at an energetic tidal site although we propose a novel approach in this paper the problem of disentangling waves and turbulence has been addressed previously usually through either adaptive filtering af or cospectral fitting cf the basis of af is the assumption that wave motions have a larger vertical length scale than turbulent motions if this assumption holds then it is possible to choose two heights in the water column with a suitable vertical separation and compare simultaneous velocity measurements the coherent portion of the two velocity time series is then attributable to wave motion and the remainder to turbulent motion trowbridge 1998 although some implementations of af required vertically separated point measurements of multiple velocity components from an array of advs shaw and trowbridge 2001 feddersen and williams iii 2007 subsequent developments showed that the method could be successfully adapted for adcp measurements rosman et al 2008 the af method has previously been used at sites that are significantly shallower with weaker currents than the site investigated here see section 2 1 this means that for this site vertical lengthscales of the turbulence will be larger as they are less constrained by the vertical boundaries and the separation between wave and turbulent vertical lengthscales will be more difficult to maintain meaning that the af method will have greater trouble decoupling wave and turbulent motions the cf method similarly relies on a separation between wave and turbulent lengthscales here the assumption is that this will mean certain spectral features corresponding solely to waves or turbulence are clearly distinguishable in the cospectra of the total velocity record kirincich et al 2010 fitting a wavenumber limited subrange of the observed cospectrum to a suitable semi empirical model cospectrum of turbulence alone more strictly the fit is between the ogive curve of the cospectra rather than the cospectra themselves then allows the wave and turbulent contributions to the total velocity record to be disentangled this method proved quite successful and frequently offered more reliable measurements than the af method when applied to the same measurements however it is not always able to yield meaningful results across all sites studied by kirincich and rosman 2011 the cf method was able to decouple waves and turbulence in a maximum of 40 of data records beyond the af and cf methods for conventional adcps the use of pulse coherent doppler methods greatly increases the spatial and temporal resolution of acoustic profiling methods lohrmann et al 1990 facilitating methods such as spectral filtering in the wavenumber frequency domain to separate wave and turbulence contributions veron and melville 1999 however velocity measurements obtained in this way face two important practical restrictions the spatial extent of measurements is much smaller than is possible with a broadband adcp and the maximum distance of measurements from the device is much smaller hay et al 2008 at high energy tidal sites where we wish to have measurements across the entire depth span that may be occupied by a turbine and strong currents mean that it is very difficult to position a measurement device in mid column these practical restrictions are highly salient for most data from tidal stream energy sites then we have a situation where our measurements simultaneously capture two different physical phenomena in a single parameter with no a priori means of disentangling them on purely physical grounds however as noted above the wave contribution is strongly dominant at times of significant wave activity togneri et al 2017b a this suggests another possibility if the spatial profiles of the wave contribution and the true tke are sufficiently different then it should be possible to identify the wave contribution with a statistically significant data mode in this paper we use empirical orthogonal function eof analysis to find the data modes and we present the results from applying this analysis to the separation of waves and turbulence from adcp estimates of tke in a real data set section 2 gives details of the data collection and presents a short introduction to the methods of data analysis the wave contribution to the estimated tke can also be estimated from linear wave theory using data from a simultaneous wave buoy deployment a brief discussion of the wave theory is given in section 2 3 in section 3 we present the key findings from the example data set and discuss the differences between the results from the eof analysis and those predicted by wave theory in section 4 we assess the usefulness of the method and highlight its key strengths and weaknesses finally we present a brief summary and conclusion in section 5 2 methods 2 1 instrumentation and deployment the data used in this study is taken from a measurement campaign carried out in the morlais demonstration zone mdz off the coast of anglesey in wales we use measurements from an rdi sentinel v adcp deployed on the southern edge of the mdz see fig 1 between 19 09 14 and 19 11 14 in addition to this adcp there are also measurements from a waverider buoy whose deployment period fully overlaps that of the adcp this buoy was locared approximately 2 km to the south of the mdz peak spring depth range at the adcp deployment location was approximately 5 m 41 1 46 2 m and the depth averaged peak spring current was 2 5 ms 1 the adcp measured a 15 min burst of data every hour at a sample rate of 2 hz the ping frequency was 614 4 khz for all time series presented in the rest of this paper each burst is represented by a single time step which is calculated using all data from that burst the vertical bin size was 0 6 m and the vertical blanking distance from the transceiver was 1 89 m the beam angle was 25 from vertical where wave buoy measurements are compared to adcp data from a particular burst they are represented by an average across the same 15 min period more details of the site and data collection can be found in lewis et al 2015 piano et al 2015 2 2 estimation of tke from adcp data heretofore we have referred to the parameter that we estimate in this study as the tke more precisely the quantity estimated is the specific tke or tke per unit mass this is denoted k and is related to the cartesian velocity components u v w as 1 k 1 2 u 2 v 2 w 2 where angle brackets denote a time average over a burst and a prime denotes the fluctuation component although the sentinel v has five beams one vertical and four off vertical following the work presented in 30 we note that using the fifth beam does not significantly alter the estimated values of tke and introduces greater uncertainty thus we use the conventional four beam estimate of tke using the variance method throughout this study a detailed description of the variance method for estimation of tke can be found in e g stacey et al 1999 or lu and lueck 1999b so we do not propose to describe the method in depth in the current paper in short if we take the velocity measured along the i th beam to be b i then we can express its variance as b i 2 by assuming that the second order statistics of the turbulence across the beam spread of the adcp are spatially uniform and that they are approximately stationary over the averaging period it can be shown that the adcp can estimate tke as 2 k i 1 4 b i 2 4 sin 2 θ 1 ξ 1 cot 2 θ where θ is the inclination angle of the off vertical beams and ξ parametrises the turbulent anisotropy we use a value of ξ 0 1684 following the semi empirical analysis of open channel flows by nezu and nakagawa 1993 because eq 2 involves only addition of beam variances we can be sure that the effect of doppler noise is a positive bias on each beam s contribution to the calculated k value this makes it quite straightforward to find a conservative estimate of the bias due to instrument noise a detailed description of the noise correction method is given in togneri et al 2017b an overview of the tke calculated using this method and corrected for noise bias is shown in fig 2 calculating the variance of the k value is less straightforward as eq 2 yields a single k value for each burst we therefore estimate the variance of k for a given burst by bootstrapping the variance of b i 2 for each beam and then combining these variances of variances to estimate the variance of k under the assumption that var b i 2 and var b j 2 are uncorrelated i j the estimate of k in eq 2 assumes a given relationship between the alignment of the beams and the directions of the wave velocities if the adcp is tilted from the vertical due to for instance a sloping seabed however then this relationship does not necessarily hold following the approach of lu and lueck 1999b further developed in rosman et al 2008 we suppose that the adcp tilt may be characterised by a pitch angle ϕ p about the axis on which beams 1 and 2 lie and a roll angle ϕ r about the axis on which beams 3 and 4 lie we can then relate the vector of device centric velocities u v w to the vector of earth centric velocities u v w with a simple linearised rotation 3 u v v 1 0 ϕ r 0 1 ϕ p ϕ r ϕ p 1 u v w in this case using a sum of beam variances to estimate k as in eq 2 will not give exactly k but rather k plus some error terms associated with the tilt thus the equation should be rendered as i 1 4 b i 2 4 sin 2 θ 1 ξ 1 cot 2 θ 1 2 u 2 v 2 w 2 and by substituting in the appropriate expressions for u v w from eq 3 we find that for an adcp with tilt 4 i 1 4 b i 2 4 sin 2 θ 1 ξ 1 cot 2 θ 1 2 1 ϕ r 2 u 2 1 ϕ p 2 v 2 1 ϕ p 2 ϕ r 2 w 2 2 ϕ p ϕ r u v the additional terms due to tilt are all second order with respect to the tilt angles the error that they will introduce is therefore below 1 as long as tilt angles remain under 5 7 approximately 1 2 of measurements were found to fail this criterion by excluding data from these times when calculating the beam variances we can be confident that tilt bias in the k estimate is minimal as noted in section 1 this method produces an estimate of k which assumes that all variance in the beam velocities is due to turbulent fluctuations if wave action or some other non turbulent phenomenon generates additional velocity variation the estimated quantity k will not correspond to tke but will capture contributions from both turbulence and waves to clarify this distinction in the remainder of the paper we denote the estimate obtained using eq 2 as k a d c p under the assumption that the waves and turbulence are not statistically correlated cf for instance the analysis of anis and moum 1995 their contributions to k a d c p can be regarded as superposed on one another and we can simply regard the estimate as a sum of turbulent and wave contributions 5 k a d c p k t k w in this formulation k t is the true tke and k w is a pseudo tke associated with wave orbital velocities that causes an upwards bias in the adcp estimate of tke 2 3 velocity variance in linear wave theory from airy wave theory wave orbital velocities in the presence of significant mean currents are the spatial derivatives of the velocity potential function 6 φ x z t σ κ a cosh κ z h sinh κ h s i n κ x ω t here x and z express horizontal and vertical spatial position recall that z is defined as displacement down from the surface t is time a is wave amplitude κ is wavenumber and ω and σ are observed and intrinsic frequency respectively on this basis the expected pseudo tke from wave velocities for an averaging period sufficiently long compared to the wave period will be 7 k w 1 4 σ 2 a 2 sinh 2 κ h sinh 2 κ z h the parameters a κ ω and σ can be obtained from the wave buoy of these the wave buoy only directly measures observed frequency ω although it also provides the significant wave height which is divided in half to yield wave amplitude a to calculate κ we take the observed frequency ω along with the adcp s measurements of water depth z and surface current speed u and the angle θ between wave and current direction these are then used in the dispersion relation 8 ω κ u cos θ 2 g κ tanh κ z which can be solved iteratively for κ cf the procedure described in wolf and prandle 1999 it is then trivial to calculate σ this gives us all the data needed to fully specify the expected pseudo tke profiles due to linear waves as given in eq 7 note that strictly eq 8 is only correct where the current velocity u is uniform in depth analysis of the longitudinal velocity profile in the at this site shows that for floods there is no more than a 5 difference in maximum and minimum velocity in the top 20 m of the measurable portion of the water column for ebbs this figure is 17 m 2 4 eof analysis eofs are a well established technique for analysing climatic and meteorological data mathematically equivalent techniques such as proper orthogonal decomposition pod or principal component analysis pca are also widely applied for identifying or isolating specific features within flow fields where multiple phenomena are acting simultaneously clavero et al 2016 scherl et al 2020 björnsson and venegas 1997 is a very good introduction to the method for readers not familiar with the technique there are also more comprehensive texts describing eof analysis in greater detail preisendorfer 1988 jolliffe 2011 in brief eof analysis decomposes a zero mean spatiotemporal dataset into a spatial basis the members of this basis are the empirical orthogonal functions from which the method takes its name which can be combined linearly with time dependent weightings to reconstruct the original dataset the weight of each basis function at a given time is specified by the time varying expansion coefficient in general if we have some spatiotemporal dataset d x t that is decomposed into n basis functions eof i x and expansion coefficients ec i t with i 1 n then the original data can be fully reconstructed as 9 d x t i 1 n eof i x ec i t here n is the number of points in the spatial grid in this study n is 62 i e the number of bins in the adcp profiles of estimated tke by ordering the eofs by the magnitude of their contribution to the total variability of d it is possible to pick out the most significant data modes from the overall dataset and attempt to identify them with particular physical phenomena as the wave contribution to total pseudo tke is seen to significantly dominate the turbulence contribution at times of strong wave activity we expect that the first eof will correspond almost entirely to wave action if this is indeed the case then the value of ec 1 t will indicate whether wave generated pseudo tke is a significant contribution to k a d c p at time t a high positive value will indicate that waves are acting to positively bias the adcp estimate of tke while a low or negative value will indicate that wave action is negligible as mentioned at the start of this section eof analysis is only able to work with a data set whose time mean is zero so we discard the mean before beginning the analysis and then re add it when reconstructing the decoupled wave and turbulent components however because tke is always positive the wave pseudo tke will also bias the mean value of k a d c p high to fully capture the wave contribution we must have an estimate of this mean bias as well as the time varying component from eof analysis to facilitate this we recast eq 5 in terms of the mean and time varying contribution from waves and turbulence as 10 k a d c p k a d c p k a d c p k t k t k w k w here an overbar indicates a mean value and a tilde indicates the time varying component these apply over the whole two month dataset cf the and notation which were applied to data within a single 15 min burst in eqs 1 and 2 thus we anticipate a non zero value of k w for the mean wave bias across the whole dataset even although at times of low wave action k w will be instantaneously zero if the eof approach outlined above is correct then eof 1 x ec 1 t k w however we still need an estimate of the wave mean bias k w if we are to fully separate waves and turbulence we achieve this by assuming that the first eof does indeed capture the variability of wave generated pseudo tke if this is the case then ec 1 t 0 corresponds to times when wave action is not significant a mean profile of k a d c p calculated from a subsample containing only these times will then be equal to k t and we can then calculate k w k a d c p k t if we are able to verify that the k t profile found in this way is correct then we can in principle affirm the correctness of the assumption that the first eof can be identified with k w this then allows us to separate out all four components on the right hand side of eq 10 the eof method requires a dataset in which the spatial points are the same for each timestep since the water depth changes throughout the cycle we must truncate the data prior to carrying out the eof analysis we elect to do this by truncating downwards from the highest point in the water column containing valid data such that each successive burst contains the same depth range relative to the surface this choice is made on the grounds that wave action extends downwards through the water column so defining the data set such that its location relative to the point of maximum wave activity is fixed will make the eof analysis more likely to pick out modes that correspond to genuine wave phenomena once k w has been identified and subtracted from k a d c p the remainder which should be due solely to turbulent action can then be re analysed taking the seabed as zero the highest point in the water column from which data is available is constrained by the effects of sidelobe interference which means very near the surface strong echoes from the water air boundary make accurate measurement impossible appell et al 1991 nystrom et al 2007 for the inclination angle of 25 in the adcp used in this study this means that measurements from the uppermost 6 6 of the water column do not yield useful data 3 results fig 2 gives an overview of the whole dataset by showing the distribution of the adcp estimate of tke across all water depths for the complete deployment period and comparing it to the depth mean current velocity and buoy measurements of significant wave height during the same period there is a clear coincidence of high waves and high values of k a d c p near the surface up to magnitudes of approximately 1 m 2 s 2 cf the values around 1 5 1 0 2 seen in studies at other tidal sites such as that by milne et al 2017 this indicates that as proposed in sections 1 and 2 the most significant statistical mode is likely to be strongly correlated with wave action we can further demonstrate how strongly the waves dominate the turbulence by examining a sample spectrum of along beam velocities a psd of the velocity measured along the direction of beam 1 for a burst near the start of the deployment period which is not a period of particularly strong wave activity cf fig 2 is given in fig 3 this clearly shows the extent to which the energy associated with wave action dominates the psd as the wave peak is by orders of magnitude the most significant feature 3 1 observed wave properties fig 4 shows the probability distributions of the intrinsic wave period and the wavelength from all 15 min bursts across the duration of the adcp deployment as measured with the wave buoy these distributions are sharply peaked quantitatively the kurtosis of the period distribution is 5 99 and that of the wavelength distribution is 7 43 most wave observations have a period in the range 6 5 1 4 s and a wavelength in the range 65 26 m certain key effects of the wave current interaction on the relationship between observed frequency ω and intrinsic frequency σ are detailed in the data in fig 5 panel a shows that the scatter remains clustered around unity for all observations panels b and c show that the difference between ω and κ behaves as expected with respect to the properties of the currents and waves a greater current speed generally tends to produce a greater discrepancy the simple best fit linear relationship indicated by the black line in panel b has an r2 of 0 42 additionally as the angle between wave and current directions gets closer to orthogonal i e π 2 the difference between ω and σ shrinks 3 2 eof analysis turning to the performance of the eof analysis we can estimate the relative importance of an eof mode by its normalised eigenvalue i e its own eigenvalue divided by the sum of all eigenvalues this gives a measure of the proportion of total variance in the dataset explained by a particular data mode for our dataset the first eof mode explains 97 1 of the overall variance given the apparent strong dominance of the wave pseudo tke as seen in contour plot of fig 2 this is consistent with the first statistical mode corresponding approximately to the wave action recall as per the discussion in section 2 4 that although we hope to capture the time varying component of the wave pseudo tke with eof analysis we must take a different approach to finding the wave associated bias in the mean value of k a d c p in fig 6 we examine the decomposition of the time mean portion k a d c p of the total measured pseudo tke as proposed in section 2 4 and summarised by eq 10 we can see that filtering the profile of mean k a d c p by the proposed low wave criterion i e ec 1 t 0 has yielded an estimated k w profile that is a good approximation to a sinh 2 function as we would expect from eq 7 the k t profile is mostly constant in the lower part of the water column at depths greater than ca 18 m below the surface we see no peak in k near the bed although this may be simply because the expected near bed increase occurs below the lowest measurement point however close to the surface of the water in a depth range roughly between 5 18 m the profile exhibits an approximately exponential behaviour this suggests that the eof analysis has not completely removed the wave pseudo tke from the estimate of k t in section 4 we demonstrate a correlation between the near surface maximum in k t and wind action indicating that wind waves may be a significant contributor to k t near the surface we can also see that the estimated variability of k w is higher than the estimated variability of the profile of mean tke when using all bursts k a d c p this is consistent with wave action being the phenomenon driving velocity variability in excess of that associated with turbulent fluctuations 3 3 comparison of observations and eof to examine how the eof analysis prediction of pseudo tke compares with the observed wave properties throughout the measurement period fig 7 compares the significant wave height with estimates of wave generated pseudo tke k w from the eof method and from airy wave theory at a depth slightly below the surface it is apparent that all three of the time series shown in the figure track one another quite closely this correlation is quantitatively very good the pearson correlation coefficient for any pair of these three variables is in the range 0 94 0 96 we can get a more holistic assessment of the agreement between the two different estimates of wave pseudo tke by examining the depth mean error between the estimates as shown in fig 8 the absolute error is not large but it is clear that the relative error can become very high this is simply due to the fact that both estimates can take very small values resulting in extremely high spikes in the relative error the exact timing of the spikes depends on whether the relative error is calculated with the eof estimate or the linear theory estimate on the denominator a simple time average of the relative error between the two estimation methods is very high on the order of 1 0 2 1 0 4 due to these spikes although in section 4 we argue that a more meaningful estimate of the error is 37 0 finally in fig 9 we show the result of using eof analysis to decompose the total adcp estimate of tke k a d c p into the true turbulent kinetic energy k t and the wave generated pseudo tke k w the two panels of this figure correspond to the same k a d c p dataset plotted in the bottom panel of fig 2 broken into wave and turbulent components according to the simple decomposition of eq 5 i e summing the datasets shown in these two panels will perfectly recover the initial estimate the log10 of each value has been used to generate the contour plot as this allows us to see the difference in magnitude between the k w and k t components while still preserving the visibility of the smaller variations in value at several points one or the other of the components takes a value below zero this is not physically meaningful but is instead an artefact of the decomposition method when a particular contribution is negligibly small at such times the random error between the statistical decomposition and the underlying physical contributions of the waves and turbulence can take a value larger than the true negligibly small value if this error is negative then the eof estimated value of k w or k t can go below zero note that as the eof decomposition technique uses a subset of the total data that is a constant depth range with reference to the surface this leaves a variable number of depth bins near the seabed untreated by this analysis we deal with these by assuming that the wave contribution is negligible at this point and setting k t k a d c p for these few near bed bins using the log scale for plotting k t makes it easy to see the diurnal variation and the spring neap cycle in the upper panel of fig 9 note the four broad peaks in value near the bed centred around 28th september 12th and 26th october and 9th november it is also clear that no similar time variation is visible in the k w plot this is a strong indication that the separation has genuinely found a way of decomposing the data set into two components which are mostly identifiable with turbulence and waves however there are still some aspects of the separation that are less satisfactory near the surface the k t estimate still shows a significant peak as we might expect based on the mean profile shown in fig 6 and there are a few anomalous transient features e g around 5th october which may be wave related we discuss some possibilities for the causes of these discrepancies and ways they might be addressed in the following section 4 discussion we have seen in fig 8 that although the absolute error between the eof and theory estimates of k w may be quite small the relative error can become very large on the face of it this suggests that poor agreement between eof and theory however to better understand the importance of these very large relative errors it is instructive to examine the relationships between the error and other flow parameters the size of the absolute error between estimates of k w is important to understand the behaviour of the corresponding relative error in fig 10 we show how the absolute error depends on key wave parameters and on the near surface value of the estimated pseudo tke itself the relationships between error and wave period or wavelength are not immediately apparent but the peak errors in panels a and c approximately coincide with the most energetic wave conditions the dependence of absolute error on wave height is more straightforward panel b shows an approximately quadratic relationship between error and significant wave height cf the wave amplitude term in 7 most simple however is the approximately linear relationship between error and near surface pseudo tke for the eof based estimate used in panel d the correlation is r 0 63 we do not show the relationship with the linear theory estimate as it is very similar but the correlation in that case is even stronger r 0 70 these results should be borne in mind when interpreting the behaviour of the relative error as seen in fig 11 this shows a very high peak in relative error on the order of 1000 in other words it shows that the eof estimate of wave pseudo tke and the linear theory predictions are often different by approximately an order of magnitude this is not prima facie evidence that the eof analysis is a good means to estimate wave pseudo tke however it is clear that these very high errors occur only when the eof estimate of wave pseudo tke is near zero comparing this to panel d of fig 10 we see that the absolute error for such bursts is not behaving unusually and that therefore the spike in relative error is purely due to very small values of the denominator in the calculation rather than any true divergence in the absolute values of the two pseudo tke estimators this means that attempts to calculate k w from theory or by eof analysis are only robust when the wave pseudo tke is in some sense sufficiently large otherwise the estimates provided by these methods may be erroneous or unhelpful by a robust estimate of k w we mean one that can be well corroborated between the two methods for this to be meaningful however we must be able to more precisely define a sufficiently large pseudo tke if we assume that a very high relative error between the two estimation methods indicates a time at which both methods are returning a poor estimate of k w then we can consider a criterion for selecting good estimates that uses the value of this error as a measure of goodness this selection criterion should ideally be possible to choose a priori without knowledge of the error bearing this constraint in mind the most intuitive choice is to say that suitable estimates of k w are only obtained when the expansion coefficient of the first eof mode of the k a d c p data set is positive i e when ec 1 t 0 fig 12 shows that filtering the dataset by excluding bursts whose ec 1 value is below a certain threshold has a significant impact on the mean error and that if we set this threshold to zero the mean error between the linear theory estimate of k w and the estimate obtained using eof analysis the mean error is approximately 37 fig 9 shows that using eof to decompose k a d c p into its turbulent and wave components seems to be quite successful however there are two significant features to address k t values still have a peak in the surface most stations which indicates that not all wave activity has been removed and there are significant transient features that are not obviously associated with any tidal constituent these may be due to the first eof mode not capturing the whole of the wave physics higher modes might correct these transient spikes to investigate this possibility we use the error criterion from above to test if the agreement between the theory estimate of k w and the eof estimate is improved by including more eof modes in terms of the simple decomposition presented in eq 10 this addition of modes alters how k a d c p is split into its wave and turbulent contributions k w and k t but does not affect the estimate of how waves and turbulence contribute to the estimated k a d c p the results of this test as well as a comparison of the first four eof modes are shown in fig 13 this shows that the error is indeed somewhat reduced by adding the second eof to the first from 37 0 to 36 2 it is clear from the bottom panel of fig 13 just how dominant the first mode is recall from section 3 that the first mode explains approximately 97 of the total variability in the record here we see that the second mode explains approximately 1 8 and no other mode exceeds 0 5 the mode shapes seen in the top left panel do not obviously correspond to a particular physical phenomenon in themselves rather they appear to mostly be corrections to the first mode mirroring its shape through most of the water column but changing sign near the surface to allow the surface most bin to be slightly increased or decreased at a particular time incorporating the second mode visibly improves the decomposition as can be seen in fig 14 the near surface maximum is reduced although still present the transient features in the single mode decomposition are eliminated and the mid depth patches where k t 0 are significantly reduced in size the mode shapes shown in fig 13 are robust to observational variance of the tke field from which they are calculated recalculating the eof modes for tke fields at the extremes of the 95 confidence interval cf fig 6 produces very similar mode shapes with a relative difference in magnitude for the first four mode shapes of 1 01 7 89 0 39 and 1 84 respectively it is possible that the near surface maximum seen in the decomposed k t record may be associated with shorter period waves this would not be picked out by the eof analysis which instead finds statistical modes more closely tied to long period waves which generate pseudo tke throughout the measured water depth we can test the plausibility of this explanation by comparing the near surface estimates of k t with wind measurements from the nearby raf valley weather station and this is illustrated in fig 15 there is no clear correlation between the wind speed and the near surface k t estimate itself however in examining the data set we noticed that high frequency fluctuations appeared to be much more prominent when wind speeds are higher to investigate this we calculated a simple rolling variance of the near surface k t estimate the variance for each burst is calculated from a window of 20 observations centred around itself the results of this are shown in the bottom panel of this figure a comparison of the top and bottom panels makes it clear that this rolling variance is tracking the windspeed quite closely we are therefore confident in saying that the near surface maximum in the k t estimate obtained from eof analysis is associated with wind action although we cannot be certain of the precise mechanism it may be from an additional source of error in the method associated with higher uncertainties in adcp estimates of tke near the surface or on the other hand it may be genuine and associated with a phenomenon such as turbulence generated by wave breaking 5 summary and conclusions in general both waves and turbulence act at energetic tidal sites and both are significant environmental factors affecting tec fatigue and reliability it is possible to measure wave properties alone using a wave buoy although the strong currents associated with tidal energy sites frequently cause practical problems for buoys e g being dragged down at the limits of their mooring these problems may be possible to overcome with acoustic instruments incorporating a vertical beam dedicated to measuring wave properties as previous study has shown that the vertical beam does not greatly improve estimates of tke togneri et al 2017a the bed mounted adcps that are typical of site measurements both those intended for scientific investigations and those recommended by the relevant iec standards for industrial applications iec ts 62600 201 however face unique challenges in measuring key turbulence parameters the measurements from these devices rely on the standard variance method cf eq 2 stacey et al 1999 lu and lueck 1999b and thus as discussed in section 2 2 are prone to contamination from wave action we have examined a set of estimated tke values from an adcp deployed off the welsh coast for a period covering roughly four spring neap cycles which is sufficiently long to capture all the most important modes of tidal variability since the site at which the adcp was deployed was reasonably exposed to waves and we had independent measurements of wave activity from a simultaneously deployed buoy this dataset offered a very good opportunity to investigate how well we can determine the true tke from the estimate that the variance method actually yields it is immediately evident that the estimated tke k a d c p is indeed strongly influenced by waves fig 2 and we can surmise that this kind of wave influence is typical of other non sheltered energetic tidal sites we started by showing that the first eof mode captures a large majority of the variability in the k a d c p record consistent with the observation that estimated tke is seemingly dominated by wave pseudo tke subsequently we were able to show that the mean vertical profile of k a d c p is consistent with the presumption of significant wave activity a significant shortcoming of the eof method for this purpose is that it cannot estimate the bias that wave action introduces to the time average of k a d c p we have worked around this by calculating a mean k a d c p profile using only data from times of low wave action and assuming that this mean profile is a good approximation to the portion of mean k a d c p attributable to turbulence alone the results in fig 6 show that this approach seems to be partially successful the portion of the mean profile that we presume to be attributable to turbulence k t does not exhibit obviously wave like behaviour except very near the surface to assess the effectiveness of the eof analysis at separating waves and turbulence across the whole duration of the record we considered the predicted values of near surface pseudo tke due to wave action from both eof analysis and linear wave theory the comparison of these two estimates as seen in fig 7 showed that the statistical and theoretical predictions of wave pseudo tke track one another very closely a more detailed examination of the error as illustrated by the results shown in figs 8 and 10 12 revealed a more complex picture although the absolute error is never very high the relative error between the eof estimate of wave pseudo tke and the linear theory estimate can spike very high this motivated us to discuss possible criteria for times when it may not be suitable to use these methods to estimate wave pseudo tke we suggest that estimates at times when ec 1 0 i e when the first eof mode is negative may not be particularly meaningful excluding these times results in a sharp decline in the mean error between the two estimation methods the key test of the method presented in the paper is the decomposition shown in fig 9 and the improved version in fig 14 these results indicate that where the wave contribution to this adcp estimate of k significantly swamps the turbulent contribution for at least some times empirical orthogonal function analysis can be used to find separate wave and turbulent contributions to k a d c p using a small number of data modes that contain most of the wave contribution the method studied here permits a statistical if not strictly physical decoupling of the waves and turbulence where waves are sufficiently strong at greater depths and at sites where there is no strong wave activity wave action does not contaminate along beam velocity variances and reliable estimates of tke can be obtained through standard analysis note that the method presented in this paper will work with adcp data alone the wave buoy data is used only to measure parameters informing the linear theory check on the eof estimate of the wave contribution this means the method can be applied even if there is no independent measurement of the wave properties although this additional data is necessary to determine the optimum number of modes to include in the decomposition in the absence of wave buoy data it may be possible to use spectral analysis to estimate wave properties and thereby choose an optimum number of data modes but this is not investigated here since the study presented in this paper does not directly filter measured adcp velocities there is also potential to achieve a better separation of waves and turbulence by combining spectral techniques applied to the velocity records with the statistical method described here applied to the derived bulk flow properties such as tke credit authorship contribution statement m togneri methodology software investigation validation writing original draft funding acquisition i masters supervision funding acquisition writing review editing i fairley conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the support of the welsh assembly government through the sêr cymru national research network for low carbon energy and environment of epsrc united kingdom through the projects surftec ep p008628 1 and wtimts funded via the supergen ore hub ep s000747 1 through the flexible funding scheme and of erdf through the interreg atlantic area project monitor eapa 333 2016 the authors also acknowledge the support of the seacams and seacams 2 projects part funded by the european regional development fund through the welsh government the data analysed in this study were collected by researchers at bangor university under these research programmes and are hosted on the imardis data portal www imardis org 
20277,acoustic doppler current profilers adcps are the standard tool for measuring tidal currents at tidal stream energy sites they are used to estimate several parameters including turbulent kinetic energy tke however estimates of tke from adcps are often swamped by wave action we surmise that this bias can be detected as a data mode to test this we present an empirical orthogonal function eof analysis of two months of tke estimates from adcp measurements at a tidal energy site with significant wave activity the results of the analysis were compared with linear wave theory using data from a wave buoy the first data mode identified from eof analysis agrees well with the wave bias predicted by linear theory and the resulting decomposition of the data set into wave and turbulent components appears realistic this decomposition is possible from adcp data alone and therefore offers a novel and widely applicable analysis technique for simultaneous assessment of turbulence and waves at highly energetic tidal sites the method can also be applied retrospectively to historical data sets we also show that the decomposition can be improved by including higher eof modes but this requires an independent measurement of waves to determine the optimum number of modes keywords waves turbulence turbulent kinetic energy empirical orthogonal analysis tidal power 1 introduction the combined action of waves and turbulence in energetic tidal currents is the strongest contributor to load variability on tidal energy converters tecs milne et al 2016 elasha et al 2017 mccann 2007 quantifying these phenomena from field measurements at actual or potential deployment sites however is not a trivial task the most widely employed tools for measurement of flow conditions are acoustic doppler current profilers adcps these are recommended by iec standards iec ts 62600 201 and therefore effectively required in an industrial context it is quite straightforward to estimate mean flow properties such as depth profiles of mean current speed and direction from adcp measurements lu and lueck 1999a but calculating properties relating to phenomena that take place on smaller spatial scales than the beam spread of the adcp is more challenging a variety of techniques are available to estimate turbulence and wave quantities from adcps or similar acoustic devices bouferrouk et al 2016 mcmillan and hay 2017 guerra and thomson 2017 in the current paper we focus on the estimation of turbulent kinetic energy tke using the variance method stacey et al 1999 lu and lueck 1999b an important shortcoming of the variance method for estimation of tke is that since it is based on measurements of velocity variance it implicitly assumes that all velocity variance is attributable to turbulent action any source of velocity variance other than the turbulence will therefore introduce a positive bias into the estimate of tke from adcp measurements most significantly this includes the variance associated with orbital wave velocities the bias introduced by this may be so high that a naive estimate of tke can be approximately an order of magnitude higher than the true value the relative importance of waves and turbulence for a given tec will differ depending on its design most significantly whether it is affixed to the bed or is mounted on a floating hull we therefore wish to be able to separately measure the effects of waves and turbulence at an energetic tidal site although we propose a novel approach in this paper the problem of disentangling waves and turbulence has been addressed previously usually through either adaptive filtering af or cospectral fitting cf the basis of af is the assumption that wave motions have a larger vertical length scale than turbulent motions if this assumption holds then it is possible to choose two heights in the water column with a suitable vertical separation and compare simultaneous velocity measurements the coherent portion of the two velocity time series is then attributable to wave motion and the remainder to turbulent motion trowbridge 1998 although some implementations of af required vertically separated point measurements of multiple velocity components from an array of advs shaw and trowbridge 2001 feddersen and williams iii 2007 subsequent developments showed that the method could be successfully adapted for adcp measurements rosman et al 2008 the af method has previously been used at sites that are significantly shallower with weaker currents than the site investigated here see section 2 1 this means that for this site vertical lengthscales of the turbulence will be larger as they are less constrained by the vertical boundaries and the separation between wave and turbulent vertical lengthscales will be more difficult to maintain meaning that the af method will have greater trouble decoupling wave and turbulent motions the cf method similarly relies on a separation between wave and turbulent lengthscales here the assumption is that this will mean certain spectral features corresponding solely to waves or turbulence are clearly distinguishable in the cospectra of the total velocity record kirincich et al 2010 fitting a wavenumber limited subrange of the observed cospectrum to a suitable semi empirical model cospectrum of turbulence alone more strictly the fit is between the ogive curve of the cospectra rather than the cospectra themselves then allows the wave and turbulent contributions to the total velocity record to be disentangled this method proved quite successful and frequently offered more reliable measurements than the af method when applied to the same measurements however it is not always able to yield meaningful results across all sites studied by kirincich and rosman 2011 the cf method was able to decouple waves and turbulence in a maximum of 40 of data records beyond the af and cf methods for conventional adcps the use of pulse coherent doppler methods greatly increases the spatial and temporal resolution of acoustic profiling methods lohrmann et al 1990 facilitating methods such as spectral filtering in the wavenumber frequency domain to separate wave and turbulence contributions veron and melville 1999 however velocity measurements obtained in this way face two important practical restrictions the spatial extent of measurements is much smaller than is possible with a broadband adcp and the maximum distance of measurements from the device is much smaller hay et al 2008 at high energy tidal sites where we wish to have measurements across the entire depth span that may be occupied by a turbine and strong currents mean that it is very difficult to position a measurement device in mid column these practical restrictions are highly salient for most data from tidal stream energy sites then we have a situation where our measurements simultaneously capture two different physical phenomena in a single parameter with no a priori means of disentangling them on purely physical grounds however as noted above the wave contribution is strongly dominant at times of significant wave activity togneri et al 2017b a this suggests another possibility if the spatial profiles of the wave contribution and the true tke are sufficiently different then it should be possible to identify the wave contribution with a statistically significant data mode in this paper we use empirical orthogonal function eof analysis to find the data modes and we present the results from applying this analysis to the separation of waves and turbulence from adcp estimates of tke in a real data set section 2 gives details of the data collection and presents a short introduction to the methods of data analysis the wave contribution to the estimated tke can also be estimated from linear wave theory using data from a simultaneous wave buoy deployment a brief discussion of the wave theory is given in section 2 3 in section 3 we present the key findings from the example data set and discuss the differences between the results from the eof analysis and those predicted by wave theory in section 4 we assess the usefulness of the method and highlight its key strengths and weaknesses finally we present a brief summary and conclusion in section 5 2 methods 2 1 instrumentation and deployment the data used in this study is taken from a measurement campaign carried out in the morlais demonstration zone mdz off the coast of anglesey in wales we use measurements from an rdi sentinel v adcp deployed on the southern edge of the mdz see fig 1 between 19 09 14 and 19 11 14 in addition to this adcp there are also measurements from a waverider buoy whose deployment period fully overlaps that of the adcp this buoy was locared approximately 2 km to the south of the mdz peak spring depth range at the adcp deployment location was approximately 5 m 41 1 46 2 m and the depth averaged peak spring current was 2 5 ms 1 the adcp measured a 15 min burst of data every hour at a sample rate of 2 hz the ping frequency was 614 4 khz for all time series presented in the rest of this paper each burst is represented by a single time step which is calculated using all data from that burst the vertical bin size was 0 6 m and the vertical blanking distance from the transceiver was 1 89 m the beam angle was 25 from vertical where wave buoy measurements are compared to adcp data from a particular burst they are represented by an average across the same 15 min period more details of the site and data collection can be found in lewis et al 2015 piano et al 2015 2 2 estimation of tke from adcp data heretofore we have referred to the parameter that we estimate in this study as the tke more precisely the quantity estimated is the specific tke or tke per unit mass this is denoted k and is related to the cartesian velocity components u v w as 1 k 1 2 u 2 v 2 w 2 where angle brackets denote a time average over a burst and a prime denotes the fluctuation component although the sentinel v has five beams one vertical and four off vertical following the work presented in 30 we note that using the fifth beam does not significantly alter the estimated values of tke and introduces greater uncertainty thus we use the conventional four beam estimate of tke using the variance method throughout this study a detailed description of the variance method for estimation of tke can be found in e g stacey et al 1999 or lu and lueck 1999b so we do not propose to describe the method in depth in the current paper in short if we take the velocity measured along the i th beam to be b i then we can express its variance as b i 2 by assuming that the second order statistics of the turbulence across the beam spread of the adcp are spatially uniform and that they are approximately stationary over the averaging period it can be shown that the adcp can estimate tke as 2 k i 1 4 b i 2 4 sin 2 θ 1 ξ 1 cot 2 θ where θ is the inclination angle of the off vertical beams and ξ parametrises the turbulent anisotropy we use a value of ξ 0 1684 following the semi empirical analysis of open channel flows by nezu and nakagawa 1993 because eq 2 involves only addition of beam variances we can be sure that the effect of doppler noise is a positive bias on each beam s contribution to the calculated k value this makes it quite straightforward to find a conservative estimate of the bias due to instrument noise a detailed description of the noise correction method is given in togneri et al 2017b an overview of the tke calculated using this method and corrected for noise bias is shown in fig 2 calculating the variance of the k value is less straightforward as eq 2 yields a single k value for each burst we therefore estimate the variance of k for a given burst by bootstrapping the variance of b i 2 for each beam and then combining these variances of variances to estimate the variance of k under the assumption that var b i 2 and var b j 2 are uncorrelated i j the estimate of k in eq 2 assumes a given relationship between the alignment of the beams and the directions of the wave velocities if the adcp is tilted from the vertical due to for instance a sloping seabed however then this relationship does not necessarily hold following the approach of lu and lueck 1999b further developed in rosman et al 2008 we suppose that the adcp tilt may be characterised by a pitch angle ϕ p about the axis on which beams 1 and 2 lie and a roll angle ϕ r about the axis on which beams 3 and 4 lie we can then relate the vector of device centric velocities u v w to the vector of earth centric velocities u v w with a simple linearised rotation 3 u v v 1 0 ϕ r 0 1 ϕ p ϕ r ϕ p 1 u v w in this case using a sum of beam variances to estimate k as in eq 2 will not give exactly k but rather k plus some error terms associated with the tilt thus the equation should be rendered as i 1 4 b i 2 4 sin 2 θ 1 ξ 1 cot 2 θ 1 2 u 2 v 2 w 2 and by substituting in the appropriate expressions for u v w from eq 3 we find that for an adcp with tilt 4 i 1 4 b i 2 4 sin 2 θ 1 ξ 1 cot 2 θ 1 2 1 ϕ r 2 u 2 1 ϕ p 2 v 2 1 ϕ p 2 ϕ r 2 w 2 2 ϕ p ϕ r u v the additional terms due to tilt are all second order with respect to the tilt angles the error that they will introduce is therefore below 1 as long as tilt angles remain under 5 7 approximately 1 2 of measurements were found to fail this criterion by excluding data from these times when calculating the beam variances we can be confident that tilt bias in the k estimate is minimal as noted in section 1 this method produces an estimate of k which assumes that all variance in the beam velocities is due to turbulent fluctuations if wave action or some other non turbulent phenomenon generates additional velocity variation the estimated quantity k will not correspond to tke but will capture contributions from both turbulence and waves to clarify this distinction in the remainder of the paper we denote the estimate obtained using eq 2 as k a d c p under the assumption that the waves and turbulence are not statistically correlated cf for instance the analysis of anis and moum 1995 their contributions to k a d c p can be regarded as superposed on one another and we can simply regard the estimate as a sum of turbulent and wave contributions 5 k a d c p k t k w in this formulation k t is the true tke and k w is a pseudo tke associated with wave orbital velocities that causes an upwards bias in the adcp estimate of tke 2 3 velocity variance in linear wave theory from airy wave theory wave orbital velocities in the presence of significant mean currents are the spatial derivatives of the velocity potential function 6 φ x z t σ κ a cosh κ z h sinh κ h s i n κ x ω t here x and z express horizontal and vertical spatial position recall that z is defined as displacement down from the surface t is time a is wave amplitude κ is wavenumber and ω and σ are observed and intrinsic frequency respectively on this basis the expected pseudo tke from wave velocities for an averaging period sufficiently long compared to the wave period will be 7 k w 1 4 σ 2 a 2 sinh 2 κ h sinh 2 κ z h the parameters a κ ω and σ can be obtained from the wave buoy of these the wave buoy only directly measures observed frequency ω although it also provides the significant wave height which is divided in half to yield wave amplitude a to calculate κ we take the observed frequency ω along with the adcp s measurements of water depth z and surface current speed u and the angle θ between wave and current direction these are then used in the dispersion relation 8 ω κ u cos θ 2 g κ tanh κ z which can be solved iteratively for κ cf the procedure described in wolf and prandle 1999 it is then trivial to calculate σ this gives us all the data needed to fully specify the expected pseudo tke profiles due to linear waves as given in eq 7 note that strictly eq 8 is only correct where the current velocity u is uniform in depth analysis of the longitudinal velocity profile in the at this site shows that for floods there is no more than a 5 difference in maximum and minimum velocity in the top 20 m of the measurable portion of the water column for ebbs this figure is 17 m 2 4 eof analysis eofs are a well established technique for analysing climatic and meteorological data mathematically equivalent techniques such as proper orthogonal decomposition pod or principal component analysis pca are also widely applied for identifying or isolating specific features within flow fields where multiple phenomena are acting simultaneously clavero et al 2016 scherl et al 2020 björnsson and venegas 1997 is a very good introduction to the method for readers not familiar with the technique there are also more comprehensive texts describing eof analysis in greater detail preisendorfer 1988 jolliffe 2011 in brief eof analysis decomposes a zero mean spatiotemporal dataset into a spatial basis the members of this basis are the empirical orthogonal functions from which the method takes its name which can be combined linearly with time dependent weightings to reconstruct the original dataset the weight of each basis function at a given time is specified by the time varying expansion coefficient in general if we have some spatiotemporal dataset d x t that is decomposed into n basis functions eof i x and expansion coefficients ec i t with i 1 n then the original data can be fully reconstructed as 9 d x t i 1 n eof i x ec i t here n is the number of points in the spatial grid in this study n is 62 i e the number of bins in the adcp profiles of estimated tke by ordering the eofs by the magnitude of their contribution to the total variability of d it is possible to pick out the most significant data modes from the overall dataset and attempt to identify them with particular physical phenomena as the wave contribution to total pseudo tke is seen to significantly dominate the turbulence contribution at times of strong wave activity we expect that the first eof will correspond almost entirely to wave action if this is indeed the case then the value of ec 1 t will indicate whether wave generated pseudo tke is a significant contribution to k a d c p at time t a high positive value will indicate that waves are acting to positively bias the adcp estimate of tke while a low or negative value will indicate that wave action is negligible as mentioned at the start of this section eof analysis is only able to work with a data set whose time mean is zero so we discard the mean before beginning the analysis and then re add it when reconstructing the decoupled wave and turbulent components however because tke is always positive the wave pseudo tke will also bias the mean value of k a d c p high to fully capture the wave contribution we must have an estimate of this mean bias as well as the time varying component from eof analysis to facilitate this we recast eq 5 in terms of the mean and time varying contribution from waves and turbulence as 10 k a d c p k a d c p k a d c p k t k t k w k w here an overbar indicates a mean value and a tilde indicates the time varying component these apply over the whole two month dataset cf the and notation which were applied to data within a single 15 min burst in eqs 1 and 2 thus we anticipate a non zero value of k w for the mean wave bias across the whole dataset even although at times of low wave action k w will be instantaneously zero if the eof approach outlined above is correct then eof 1 x ec 1 t k w however we still need an estimate of the wave mean bias k w if we are to fully separate waves and turbulence we achieve this by assuming that the first eof does indeed capture the variability of wave generated pseudo tke if this is the case then ec 1 t 0 corresponds to times when wave action is not significant a mean profile of k a d c p calculated from a subsample containing only these times will then be equal to k t and we can then calculate k w k a d c p k t if we are able to verify that the k t profile found in this way is correct then we can in principle affirm the correctness of the assumption that the first eof can be identified with k w this then allows us to separate out all four components on the right hand side of eq 10 the eof method requires a dataset in which the spatial points are the same for each timestep since the water depth changes throughout the cycle we must truncate the data prior to carrying out the eof analysis we elect to do this by truncating downwards from the highest point in the water column containing valid data such that each successive burst contains the same depth range relative to the surface this choice is made on the grounds that wave action extends downwards through the water column so defining the data set such that its location relative to the point of maximum wave activity is fixed will make the eof analysis more likely to pick out modes that correspond to genuine wave phenomena once k w has been identified and subtracted from k a d c p the remainder which should be due solely to turbulent action can then be re analysed taking the seabed as zero the highest point in the water column from which data is available is constrained by the effects of sidelobe interference which means very near the surface strong echoes from the water air boundary make accurate measurement impossible appell et al 1991 nystrom et al 2007 for the inclination angle of 25 in the adcp used in this study this means that measurements from the uppermost 6 6 of the water column do not yield useful data 3 results fig 2 gives an overview of the whole dataset by showing the distribution of the adcp estimate of tke across all water depths for the complete deployment period and comparing it to the depth mean current velocity and buoy measurements of significant wave height during the same period there is a clear coincidence of high waves and high values of k a d c p near the surface up to magnitudes of approximately 1 m 2 s 2 cf the values around 1 5 1 0 2 seen in studies at other tidal sites such as that by milne et al 2017 this indicates that as proposed in sections 1 and 2 the most significant statistical mode is likely to be strongly correlated with wave action we can further demonstrate how strongly the waves dominate the turbulence by examining a sample spectrum of along beam velocities a psd of the velocity measured along the direction of beam 1 for a burst near the start of the deployment period which is not a period of particularly strong wave activity cf fig 2 is given in fig 3 this clearly shows the extent to which the energy associated with wave action dominates the psd as the wave peak is by orders of magnitude the most significant feature 3 1 observed wave properties fig 4 shows the probability distributions of the intrinsic wave period and the wavelength from all 15 min bursts across the duration of the adcp deployment as measured with the wave buoy these distributions are sharply peaked quantitatively the kurtosis of the period distribution is 5 99 and that of the wavelength distribution is 7 43 most wave observations have a period in the range 6 5 1 4 s and a wavelength in the range 65 26 m certain key effects of the wave current interaction on the relationship between observed frequency ω and intrinsic frequency σ are detailed in the data in fig 5 panel a shows that the scatter remains clustered around unity for all observations panels b and c show that the difference between ω and κ behaves as expected with respect to the properties of the currents and waves a greater current speed generally tends to produce a greater discrepancy the simple best fit linear relationship indicated by the black line in panel b has an r2 of 0 42 additionally as the angle between wave and current directions gets closer to orthogonal i e π 2 the difference between ω and σ shrinks 3 2 eof analysis turning to the performance of the eof analysis we can estimate the relative importance of an eof mode by its normalised eigenvalue i e its own eigenvalue divided by the sum of all eigenvalues this gives a measure of the proportion of total variance in the dataset explained by a particular data mode for our dataset the first eof mode explains 97 1 of the overall variance given the apparent strong dominance of the wave pseudo tke as seen in contour plot of fig 2 this is consistent with the first statistical mode corresponding approximately to the wave action recall as per the discussion in section 2 4 that although we hope to capture the time varying component of the wave pseudo tke with eof analysis we must take a different approach to finding the wave associated bias in the mean value of k a d c p in fig 6 we examine the decomposition of the time mean portion k a d c p of the total measured pseudo tke as proposed in section 2 4 and summarised by eq 10 we can see that filtering the profile of mean k a d c p by the proposed low wave criterion i e ec 1 t 0 has yielded an estimated k w profile that is a good approximation to a sinh 2 function as we would expect from eq 7 the k t profile is mostly constant in the lower part of the water column at depths greater than ca 18 m below the surface we see no peak in k near the bed although this may be simply because the expected near bed increase occurs below the lowest measurement point however close to the surface of the water in a depth range roughly between 5 18 m the profile exhibits an approximately exponential behaviour this suggests that the eof analysis has not completely removed the wave pseudo tke from the estimate of k t in section 4 we demonstrate a correlation between the near surface maximum in k t and wind action indicating that wind waves may be a significant contributor to k t near the surface we can also see that the estimated variability of k w is higher than the estimated variability of the profile of mean tke when using all bursts k a d c p this is consistent with wave action being the phenomenon driving velocity variability in excess of that associated with turbulent fluctuations 3 3 comparison of observations and eof to examine how the eof analysis prediction of pseudo tke compares with the observed wave properties throughout the measurement period fig 7 compares the significant wave height with estimates of wave generated pseudo tke k w from the eof method and from airy wave theory at a depth slightly below the surface it is apparent that all three of the time series shown in the figure track one another quite closely this correlation is quantitatively very good the pearson correlation coefficient for any pair of these three variables is in the range 0 94 0 96 we can get a more holistic assessment of the agreement between the two different estimates of wave pseudo tke by examining the depth mean error between the estimates as shown in fig 8 the absolute error is not large but it is clear that the relative error can become very high this is simply due to the fact that both estimates can take very small values resulting in extremely high spikes in the relative error the exact timing of the spikes depends on whether the relative error is calculated with the eof estimate or the linear theory estimate on the denominator a simple time average of the relative error between the two estimation methods is very high on the order of 1 0 2 1 0 4 due to these spikes although in section 4 we argue that a more meaningful estimate of the error is 37 0 finally in fig 9 we show the result of using eof analysis to decompose the total adcp estimate of tke k a d c p into the true turbulent kinetic energy k t and the wave generated pseudo tke k w the two panels of this figure correspond to the same k a d c p dataset plotted in the bottom panel of fig 2 broken into wave and turbulent components according to the simple decomposition of eq 5 i e summing the datasets shown in these two panels will perfectly recover the initial estimate the log10 of each value has been used to generate the contour plot as this allows us to see the difference in magnitude between the k w and k t components while still preserving the visibility of the smaller variations in value at several points one or the other of the components takes a value below zero this is not physically meaningful but is instead an artefact of the decomposition method when a particular contribution is negligibly small at such times the random error between the statistical decomposition and the underlying physical contributions of the waves and turbulence can take a value larger than the true negligibly small value if this error is negative then the eof estimated value of k w or k t can go below zero note that as the eof decomposition technique uses a subset of the total data that is a constant depth range with reference to the surface this leaves a variable number of depth bins near the seabed untreated by this analysis we deal with these by assuming that the wave contribution is negligible at this point and setting k t k a d c p for these few near bed bins using the log scale for plotting k t makes it easy to see the diurnal variation and the spring neap cycle in the upper panel of fig 9 note the four broad peaks in value near the bed centred around 28th september 12th and 26th october and 9th november it is also clear that no similar time variation is visible in the k w plot this is a strong indication that the separation has genuinely found a way of decomposing the data set into two components which are mostly identifiable with turbulence and waves however there are still some aspects of the separation that are less satisfactory near the surface the k t estimate still shows a significant peak as we might expect based on the mean profile shown in fig 6 and there are a few anomalous transient features e g around 5th october which may be wave related we discuss some possibilities for the causes of these discrepancies and ways they might be addressed in the following section 4 discussion we have seen in fig 8 that although the absolute error between the eof and theory estimates of k w may be quite small the relative error can become very large on the face of it this suggests that poor agreement between eof and theory however to better understand the importance of these very large relative errors it is instructive to examine the relationships between the error and other flow parameters the size of the absolute error between estimates of k w is important to understand the behaviour of the corresponding relative error in fig 10 we show how the absolute error depends on key wave parameters and on the near surface value of the estimated pseudo tke itself the relationships between error and wave period or wavelength are not immediately apparent but the peak errors in panels a and c approximately coincide with the most energetic wave conditions the dependence of absolute error on wave height is more straightforward panel b shows an approximately quadratic relationship between error and significant wave height cf the wave amplitude term in 7 most simple however is the approximately linear relationship between error and near surface pseudo tke for the eof based estimate used in panel d the correlation is r 0 63 we do not show the relationship with the linear theory estimate as it is very similar but the correlation in that case is even stronger r 0 70 these results should be borne in mind when interpreting the behaviour of the relative error as seen in fig 11 this shows a very high peak in relative error on the order of 1000 in other words it shows that the eof estimate of wave pseudo tke and the linear theory predictions are often different by approximately an order of magnitude this is not prima facie evidence that the eof analysis is a good means to estimate wave pseudo tke however it is clear that these very high errors occur only when the eof estimate of wave pseudo tke is near zero comparing this to panel d of fig 10 we see that the absolute error for such bursts is not behaving unusually and that therefore the spike in relative error is purely due to very small values of the denominator in the calculation rather than any true divergence in the absolute values of the two pseudo tke estimators this means that attempts to calculate k w from theory or by eof analysis are only robust when the wave pseudo tke is in some sense sufficiently large otherwise the estimates provided by these methods may be erroneous or unhelpful by a robust estimate of k w we mean one that can be well corroborated between the two methods for this to be meaningful however we must be able to more precisely define a sufficiently large pseudo tke if we assume that a very high relative error between the two estimation methods indicates a time at which both methods are returning a poor estimate of k w then we can consider a criterion for selecting good estimates that uses the value of this error as a measure of goodness this selection criterion should ideally be possible to choose a priori without knowledge of the error bearing this constraint in mind the most intuitive choice is to say that suitable estimates of k w are only obtained when the expansion coefficient of the first eof mode of the k a d c p data set is positive i e when ec 1 t 0 fig 12 shows that filtering the dataset by excluding bursts whose ec 1 value is below a certain threshold has a significant impact on the mean error and that if we set this threshold to zero the mean error between the linear theory estimate of k w and the estimate obtained using eof analysis the mean error is approximately 37 fig 9 shows that using eof to decompose k a d c p into its turbulent and wave components seems to be quite successful however there are two significant features to address k t values still have a peak in the surface most stations which indicates that not all wave activity has been removed and there are significant transient features that are not obviously associated with any tidal constituent these may be due to the first eof mode not capturing the whole of the wave physics higher modes might correct these transient spikes to investigate this possibility we use the error criterion from above to test if the agreement between the theory estimate of k w and the eof estimate is improved by including more eof modes in terms of the simple decomposition presented in eq 10 this addition of modes alters how k a d c p is split into its wave and turbulent contributions k w and k t but does not affect the estimate of how waves and turbulence contribute to the estimated k a d c p the results of this test as well as a comparison of the first four eof modes are shown in fig 13 this shows that the error is indeed somewhat reduced by adding the second eof to the first from 37 0 to 36 2 it is clear from the bottom panel of fig 13 just how dominant the first mode is recall from section 3 that the first mode explains approximately 97 of the total variability in the record here we see that the second mode explains approximately 1 8 and no other mode exceeds 0 5 the mode shapes seen in the top left panel do not obviously correspond to a particular physical phenomenon in themselves rather they appear to mostly be corrections to the first mode mirroring its shape through most of the water column but changing sign near the surface to allow the surface most bin to be slightly increased or decreased at a particular time incorporating the second mode visibly improves the decomposition as can be seen in fig 14 the near surface maximum is reduced although still present the transient features in the single mode decomposition are eliminated and the mid depth patches where k t 0 are significantly reduced in size the mode shapes shown in fig 13 are robust to observational variance of the tke field from which they are calculated recalculating the eof modes for tke fields at the extremes of the 95 confidence interval cf fig 6 produces very similar mode shapes with a relative difference in magnitude for the first four mode shapes of 1 01 7 89 0 39 and 1 84 respectively it is possible that the near surface maximum seen in the decomposed k t record may be associated with shorter period waves this would not be picked out by the eof analysis which instead finds statistical modes more closely tied to long period waves which generate pseudo tke throughout the measured water depth we can test the plausibility of this explanation by comparing the near surface estimates of k t with wind measurements from the nearby raf valley weather station and this is illustrated in fig 15 there is no clear correlation between the wind speed and the near surface k t estimate itself however in examining the data set we noticed that high frequency fluctuations appeared to be much more prominent when wind speeds are higher to investigate this we calculated a simple rolling variance of the near surface k t estimate the variance for each burst is calculated from a window of 20 observations centred around itself the results of this are shown in the bottom panel of this figure a comparison of the top and bottom panels makes it clear that this rolling variance is tracking the windspeed quite closely we are therefore confident in saying that the near surface maximum in the k t estimate obtained from eof analysis is associated with wind action although we cannot be certain of the precise mechanism it may be from an additional source of error in the method associated with higher uncertainties in adcp estimates of tke near the surface or on the other hand it may be genuine and associated with a phenomenon such as turbulence generated by wave breaking 5 summary and conclusions in general both waves and turbulence act at energetic tidal sites and both are significant environmental factors affecting tec fatigue and reliability it is possible to measure wave properties alone using a wave buoy although the strong currents associated with tidal energy sites frequently cause practical problems for buoys e g being dragged down at the limits of their mooring these problems may be possible to overcome with acoustic instruments incorporating a vertical beam dedicated to measuring wave properties as previous study has shown that the vertical beam does not greatly improve estimates of tke togneri et al 2017a the bed mounted adcps that are typical of site measurements both those intended for scientific investigations and those recommended by the relevant iec standards for industrial applications iec ts 62600 201 however face unique challenges in measuring key turbulence parameters the measurements from these devices rely on the standard variance method cf eq 2 stacey et al 1999 lu and lueck 1999b and thus as discussed in section 2 2 are prone to contamination from wave action we have examined a set of estimated tke values from an adcp deployed off the welsh coast for a period covering roughly four spring neap cycles which is sufficiently long to capture all the most important modes of tidal variability since the site at which the adcp was deployed was reasonably exposed to waves and we had independent measurements of wave activity from a simultaneously deployed buoy this dataset offered a very good opportunity to investigate how well we can determine the true tke from the estimate that the variance method actually yields it is immediately evident that the estimated tke k a d c p is indeed strongly influenced by waves fig 2 and we can surmise that this kind of wave influence is typical of other non sheltered energetic tidal sites we started by showing that the first eof mode captures a large majority of the variability in the k a d c p record consistent with the observation that estimated tke is seemingly dominated by wave pseudo tke subsequently we were able to show that the mean vertical profile of k a d c p is consistent with the presumption of significant wave activity a significant shortcoming of the eof method for this purpose is that it cannot estimate the bias that wave action introduces to the time average of k a d c p we have worked around this by calculating a mean k a d c p profile using only data from times of low wave action and assuming that this mean profile is a good approximation to the portion of mean k a d c p attributable to turbulence alone the results in fig 6 show that this approach seems to be partially successful the portion of the mean profile that we presume to be attributable to turbulence k t does not exhibit obviously wave like behaviour except very near the surface to assess the effectiveness of the eof analysis at separating waves and turbulence across the whole duration of the record we considered the predicted values of near surface pseudo tke due to wave action from both eof analysis and linear wave theory the comparison of these two estimates as seen in fig 7 showed that the statistical and theoretical predictions of wave pseudo tke track one another very closely a more detailed examination of the error as illustrated by the results shown in figs 8 and 10 12 revealed a more complex picture although the absolute error is never very high the relative error between the eof estimate of wave pseudo tke and the linear theory estimate can spike very high this motivated us to discuss possible criteria for times when it may not be suitable to use these methods to estimate wave pseudo tke we suggest that estimates at times when ec 1 0 i e when the first eof mode is negative may not be particularly meaningful excluding these times results in a sharp decline in the mean error between the two estimation methods the key test of the method presented in the paper is the decomposition shown in fig 9 and the improved version in fig 14 these results indicate that where the wave contribution to this adcp estimate of k significantly swamps the turbulent contribution for at least some times empirical orthogonal function analysis can be used to find separate wave and turbulent contributions to k a d c p using a small number of data modes that contain most of the wave contribution the method studied here permits a statistical if not strictly physical decoupling of the waves and turbulence where waves are sufficiently strong at greater depths and at sites where there is no strong wave activity wave action does not contaminate along beam velocity variances and reliable estimates of tke can be obtained through standard analysis note that the method presented in this paper will work with adcp data alone the wave buoy data is used only to measure parameters informing the linear theory check on the eof estimate of the wave contribution this means the method can be applied even if there is no independent measurement of the wave properties although this additional data is necessary to determine the optimum number of modes to include in the decomposition in the absence of wave buoy data it may be possible to use spectral analysis to estimate wave properties and thereby choose an optimum number of data modes but this is not investigated here since the study presented in this paper does not directly filter measured adcp velocities there is also potential to achieve a better separation of waves and turbulence by combining spectral techniques applied to the velocity records with the statistical method described here applied to the derived bulk flow properties such as tke credit authorship contribution statement m togneri methodology software investigation validation writing original draft funding acquisition i masters supervision funding acquisition writing review editing i fairley conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the support of the welsh assembly government through the sêr cymru national research network for low carbon energy and environment of epsrc united kingdom through the projects surftec ep p008628 1 and wtimts funded via the supergen ore hub ep s000747 1 through the flexible funding scheme and of erdf through the interreg atlantic area project monitor eapa 333 2016 the authors also acknowledge the support of the seacams and seacams 2 projects part funded by the european regional development fund through the welsh government the data analysed in this study were collected by researchers at bangor university under these research programmes and are hosted on the imardis data portal www imardis org 
20278,bodies penetrating fluid interfaces is a classical issue that has been considerably investigated especially for water entry problems because of its relevance to slamming phenomena in ocean and coastal engineering this paper is dedicated to investigating the water entry problems of a wedge characterized by different density ratios using multi phase smoothed particle hydrodynamics sph simulations the sph model is combined with an adaptive particle refinement apr incorporating with a phase switch correction to improve the numerical accuracy and computational efficiency of simulations firstly an sph simulation for a classical water entry process of a wedge is employed as a benchmark to validate the accuracy and stability of the utilized sph model subsequently the mechanisms of the spatiotemporal cavity behaviors for different density ratios are simulated and discussed in detail it is demonstrated that the cavity evolutions during penetrating and motion characteristics of the wedge are significantly affected by density ratios it is also suggested that the presented multi phase sph model with apr can be treated as a reliable numerical tool for solving such problems in terms of complex fluid interfaces behind moving structures keywords water entry cavity dynamics different density ratios smoothed particle hydrodynamics multi phase sph model adaptive particle refinement 1 introduction the problems associated with bodies penetrating fluid interfaces have been a canonical and fundamental issue in fluid mechanics as there are many complicated physical phenomena in these processes that deserve our attention due to their relevance to both scientific and industrial applications one of the most important branch of this issue is water entry problems in which solid bodies penetrate a water air interface following numerous complex multi phase interactions truscott et al 2014 it is not surprising that the water entry problems have attracted so much attention since this issue is tightly related to many practical engineering applications e g slamming on fixed or floating offshore structures dias and ghidaglia 2018 faltinsen 1990 ballistics dynamics truscott 2009 truscott et al 2009 ditching of aircrafts woodgate et al 2019 xiao et al 2017 siemann and langrand 2017 etc the cavity dynamics has been considerably investigated over the past decades whereas it remains a challenging issue in water entry problems generally speaking water entry problems can be categorized by whether a cavity is formed there are two types of situations in the cavity forming cases known as the air entrainment and supercavitation truscott et al 2014 this paper is restricted to the former and the latter is beyond the scope of the present work for supercavitation the readers can refer to knapp et al 1970 plesset and prosperetti 1977 rood 1991 hrubes 2001 franc and michel 2004 and weiland and vlachos 2012 the phenomenon regarding air entrainment has been widely studied with various shapes of solid bodies e g sphere cylinder wedge shapes by theoretical numerical or experimental methods the theoretical methods also known as the analytical or semi analytical methods are devoted to developing simplified models with ideal conditions these ideal models however have obvious limitations in practical engineering problems in which many complex physical mechanisms cannot be ignored with simplification consequently experimental and numerical methods have been regarded as two more feasible tools for water entry problems the pioneering works of experimental methods were conducted by worthington and cole 1897 1900 who captured still images using single spark photography and thus obtained the earliest images of water entry problems thanks to the surprising development of high speed cameras the unsteady cavity dynamics can be more accurately captured by employing these advanced devices with thousands of frames per second fps or even one million fps numerous experimental investigations with high speed imaging techniques have been published over the past few decades may 1951 1952 aristoff and bush 2009 bergmann et al 2009 shi et al 2000 thoroddsen et al 2004 duclaux et al 2007 truscott 2009 truscott et al 2009 it is well accepted from these extensive high speed imaging experiments that the questions belong to the general issue of water entry problems can be mainly divided into two different kinds of studies the initial stage of contact and the subsequent cavity forming event duclaux et al 2007 the former mainly focuses attention on the impact jets generated at the moment of contact including initial jet speeds the emergence of jets and the breakup of jets thoroddsen et al 2004 these jets are always responsible for the ultra high slamming pressure which is of significance at the pre design stage of underwater launching of torpedos and structural strength of marine structures and so on for the latter duclaux et al 2007 has performed a comprehensive experimental investigation on the dynamics of transient cavities with the fluid medium being air and water the readers may also refer to 6 64 and truscott et al 2014 for more details although the high speed or ultra high speed imaging experiments are of great benefit to the study of water entry problems their expensive costs are an obvious disadvantage of this manner as a consequence of the fast development of the semiconductor industry the technique of computational fluid dynamics cfd that requires high performance computers hpcs has been more and more popular to investigate this issue abundant studies have been performed to investigate different water entry exit problems using the eulerian mesh based solver e g openfoam star ccm it is demonstrated by these numerical studies that the sharpness of multi phase interfaces always shows apparent diffusion in the mesh methods because of their inherent eulerian nature zhu et al 2006 nguyen et al 2016 iranmanesh and passandideh fard 2017 given the aforementioned drawback another paradigm known as the lagrangian particle based method has been well accepted in such physical processes characterized by large deformation and breaking of fluid interfaces rao and wan 2018 xie et al 2020 among them the truly meshless smoothed particle hydrodynamics sph has been widely carried out for solving fluid structure interactions fsi ming et al 2016 long et al 2021 khayyer et al 2021 peng et al 2021a c over the past two decades the sph has progressed significantly because of its ability to deal with the free surface breaking and the moving boundaries problems cheng et al 2017 these characteristics represent that the sph is inherently suitable to be applied in ocean and coastal engineering gotoh and khayyer 2018 ye et al 2019 he et al 2020 you et al 2021 extensive sph simulations have been implemented for water entry problems in the early years single phase sph models have been widely applied to numerically study such problems oger et al 2006 gong et al 2009 farsi and ghadimi 2014 2015 it can be observed from these numerical simulations that since single phase sph models possess limited abilities for capturing subsequent air entrainment phenomena after penetrating it is usually implemented to simulate the initial stage of contact in other words a multi phase sph model is required for such problems in which the fluid behaviors are strongly affected by complex multi phase interactions at the subsequent cavity forming and cavity splitting stages cao et al 2018 yan et al 2020 sun et al 2021a b peng et al 2021b meng et al 2021 gong et al 2009 and gong et al 2016 performed numerical investigations for the water entry problems of a wedge with a single phase and a multi phase sph model respectively it is revealed that the phenomena are similar at the early stage of an impact whether a single phase or a two phase model was implemented in their latter study gong et al 2016 the multi phase sph model proposed by colagrossi and landrini 2003 was also implemented to investigate the cavity dynamics at the later stage of an impact event in which the phenomena of cavity forming and cavity splitting were considered it can be observed from the numerical results that the process of cavity forming can be well captured once the air effects are involved while the sharpness of the multi phase interfaces was slightly disturbed after pinch off which is possibly caused by the inadequate particle resolution and the lack of numerical treatments for the fluid interface characterized by serious density discontinuity as discussed above although the problems regarding solid bodies penetrating fluid interfaces have been widely investigated the attention paid to this issue has been mainly focused on the classical water entry problems in which the density ratio of heavy fluid to light fluid is restricted to around 1000 few studies have been dedicated to investigating the cases characterized by different density ratios in fact in some experimental studies see e g marston et al 2016 the ambient pressure of the water entry can be reduced to change the density ratio of water to air it has been demonstrated that the phenomena of fluid splash and cavity evolutions are completely different at different ambient pressures but in the experiment marston et al 2016 the ambient pressure was only reduced i e the density ratio of water to air was only increased on the contrary the phenomena due to the decrease of the density ratio of water to air are still unknown and this decrease was not easy to realize in an experiment but this is quite feasible in numerical studies using a multi phase sph model besides many sph simulations adopted relatively coarse particle resolution to solve such problems for the purpose of reducing computational cost whereas this exerts adverse effects on the simulation results when the interactions between different phases are quite complex therefore a methodology to improve local accuracy and maintain relatively low computational costs is also demanded for such problems zhao et al 2021 the present study aims to introduce an accurate and stable multi phase sph model in combination with a technique of adaptive particle refinement apr chiron et al 2018 which is expected to be capable of predicting the cavity dynamics when a wedge penetrates fluid interfaces another important motivation is to investigate the effects caused by different density ratios on the physical mechanism of cavity dynamics during the penetrating process this paper can be treated as an extension and improvement of the works by sun et al 2018b in which a single phase sph with apr was used for the water entry problems of circular cylinders the remainder of this paper is organized as follows in section 2 the numerical procedures regarding the multi phase sph model with apr will be briefly introduced mathematically in section 3 a canonical problem associated with a water entry process of a wedge i e the density ratio equals to 1000 is employed as a benchmark to validate the accuracy and stability of the adopted numerical method in section 4 the cavity dynamics of a wedge penetrating fluid interfaces with different density ratios is simulated and discussed in detail finally conclusions and prospects will be illustrated in the last part of this paper 2 multi phase sph model with apr 2 1 governing equations for the multi phase sph model the δ sph model antuono et al 2010 is an advanced version stemming from the classical sph scheme monaghan 2005 which prevents the phenomenon of high frequency pressure oscillation through adding the so called δ term in the continuity equation it is demonstrated that the sph model with the δ term shows great performance in dealing with the free surface flows characterized by large deformations and fragments marrone et al 2011 recently the δ sph model has been improved by combining the traditional δ sph model with a particle shifting technique pst which results in a more accurate and stable numerical scheme known as the δ sph model sun et al 2017 2019a in the context of a rigid body penetrating fluid interfaces the multi phase interfaces could be disturbed to a large extent because of the considerable kinetic energy of the high speed moving body in this regime the sph model is very suitable furthermore because the cavity evolutions during penetrating involve various multi phase interactions between different fluids e g cavity forming collapsing and splitting the multi phase effects must be considered for the sake of accurately capturing these complex phenomena finally the governing equations solving the investigated physical processes are thus given as sun et al 2019c 1 d ρ i d t ρ i j v j v i i w i j v j δ c 0 i h i j χ i π i j i w i j v j d v i d t 1 ρ i p i tic α c 0 i h i ρ 0 i ρ i j χ i π i j i w i j v j f i ℱ i ℱ i 0 08 j χ i p j p i i w i j v j d r i d t v i r i r i δ r i δ r i cfl ma i 2 h i 2 j 1 r w i j w δ r i n i w i j v j p i c 0 i 2 ρ 0 i γ i ρ i ρ 0 i γ i 1 v i t m i ρ i t where the subscripts i and j denote the target particle and its neighboring particles within the compact support domain p ρ v m r and v represent the pressure density volume mass position and velocity respectively the subscript 0 signifies the reference value of a field quantity i e ρ 0 i and c 0 i stand for the fluid density and the pseudo sound speed of the i th particle at rest respectively f i denotes the vector regarding body force which is the gravitational force in the present study i e f i 9 81 m s 2 in the following simulations the kernel function w i j w r i r j h i adopted in this work is the wendland c 2 kernel wendland 1995 with the smoothing length h i being two times of the initial particle spacing h i 2 δ r i this kernel function is very suitable for multi phase problems with violent free surface breaking cfl stands for the courant friedrichs lewy coefficient and ma i the mach number of the phase that the i th particle belongs to in addition r 0 2 and n 4 are two constants as suggested by lind et al 2012 r i stands for the i th particle position derived from the time integration of its physical velocity v i however in the utilized sph model an additional shifting correction δ r i is applied to r i at every time step for the sake of regularizing particle distribution resulting in the real particle displacement denoted by r i it has been elucidated that this correction is reasonable because the term δ r i converges to zero as the refinement of the particle resolution and therefore the particle trajectories during an sph simulation converges to its lagrangian trajectory if particle resolution is fine enough sun et al 2019a in this work pst is applied for all the inactive particles and the light phase particles both active and inactive for inactive particles their velocities are interpolated from the surrounding active particles as a result it loses the capability of self regularization so particle shifting is mandatory sun et al 2018b for light phase particles shifting is necessary because their distribution is more sensitive to the pressure gradient due to their smaller masses in addition negative pressures could be induced behind the moving structure hence pst and tensile instability control tic should be applied simultaneously sun et al 2018a while for the heavy phase shifting can be exempted for a water entry problem in the following simulations a wedge will penetrate fluid interfaces from the upper layer phase light to the lower layer phase heavy and the heavy phase is always considered as water in all cases as shown in eq 1 the pressure p i for both heavy and light phases are explicitly calculated via an equation of state antuono et al 2011 with different parameters in multi phase sph simulations colagrossi and landrini 2003 the polytropic coefficient γ i is often chosen as γ h 7 for water and γ l 1 4 for air respectively nevertheless in the present work the fluid phases are various with different density ratios and the selection of the value of γ i thereby needs to be tuned carefully fortunately it has been demonstrated that the polytropic coefficient has negligible effects on the final numerical results within the framework of the weakly compressible hypothesis rossi 2014 considering the conclusion by rossi 2014 the parameter γ i is still adopted as γ h 7 for the heavy phase and γ l 1 4 for the light phase in every simulation besides according to the weakly compressible hypothesis the density variation of water must be below 1 of the reference density ρ 0 h which can be realized by guaranteeing the mach number less than 0 1 monaghan 1994 hence the pseudo sound speed c 0 h of the heavy phase i e water in this work and the corresponding mach number ma h can be written as 2 c 0 h 10 max u h max p h max ρ 0 h ma h u h max c 0 h 0 1 where u h max and p h max represent the maximum expected velocity and pressure in the water domain respectively furthermore the pseudo sound speed c 0 l in the light phase and the corresponding mach number ma l can be given as colagrossi and landrini 2003 3 c 0 h 2 ρ 0 h γ h c 0 l 2 ρ 0 l γ l c 0 l c 0 h 2 γ l ρ 0 h γ h ρ 0 l ma l u l max c 0 l it can be observed that two diffusive terms respectively are employed in eq 1 for the continuity and momentum equations with a stability purpose according to marrone et al 2011 π i j in the density diffusive term is given as 4 π i j 2 ρ j ρ i r j r i r j r i 2 ρ i l ρ j l where l stands for the renormalized spatial gradient given as bonet and lok 1999 5 ρ i l j χ i ρ j ρ i l i i w i j v j l i j χ i r j r i i w i j v j 1 where χ i denotes all the neighboring particles that belong to the fluid of the i th particle as for the artificial viscosity term π i j is written as monaghan 2005 6 π i j v j v i r j r i r j r i 2 in eq 1 the diffusive parameters δ 0 1 and α 0 02 are adopted in the following simulations p i tic represents the pressure gradient with tic which can be given as 7 p i tic j f p i p j i w i j v j in which 8 f p i p j p j p i p i 0 i ω f p j p i p i 0 i ω f where ω f stands for the particle set containing free surface particles and its neighboring particles in traditional sph models the pressure gradient in the momentum equation is expressed with the plus format i e p j p i however in eq 8 the pressure of particles with positive pressure or in the free surface region remain its classical form on the other hand other particles characterized by negative pressures and located out of the free surface region are evaluated using the difference format i e p j p i indeed this difference format is non conservative and would cause errors in the momentum conservation fortunately this drawback can be alleviated when particle distribution of a computational domain is homogeneous after using pst sun et al 2018a one striking difference between the multi phase sph model and a single phase version is that the density diffusive term has to be considered to be zero if the i th and j th particles of an interaction pair come from different fluid phases another important difference is that an additional term ℱ i named interface sharpness force is added to the momentum equation for the sake of keeping the sharpness of the multi phase interfaces grenier et al 2009 in ℱ i χ i stands for all the neighboring particles that do not belong to the fluid of the i th particle this corrective force prevents interface penetration but leads to a slight gap between different fluid phases 2 2 advanced adaptive particle refinement with a phase switch correction for particle based numerical methods e g mps and sph the numerical accuracy is directly linked to particle resolution if particle refinement is implemented globally the computational cost will accordingly be unbearable owing to the nonlinear growth of the total number of particles in order to overcome this drawback apr is employed to improve the local accuracy around the wedge as well as its surrounding domain in which the cavity formation and the pinch off event will occur in the present study the algorithm developed by chiron et al 2018 is implemented to realize the generation of multi resolution regions which is an advanced variant of the apr firstly proposed by barcarolo et al 2014 as displayed in fig 1 for 2d cases one coarse particle mother particles will be split into four refined particles daughter particles after entering the pre defined splitting domain the particle spacing in the daughter level is half of that of its mother level according to the algorithm the mother particles will be de activated after splitting and the subsequent daughter particles become active and join in the sph calculation the inactive particles are allowed to be transported in a purely lagrangian manner by interpolating their velocities from the background flow in fact represented by daughter particles and are re activated after moving out of the splitting domain this apr requires a coupling of the flow information on the interface between the daughter level and its mother level i e a transitional region which is required in order to fulfill the coupling in the transitional region the state of the daughter and its mother particles is opposite compared with the one inside the splitting domain nevertheless in the applications of multi phase conditions this apr needs to be corrected for achieving more accurate flow information at the multi phase interfaces especially when interface breaking and splashing occur it is worth noting that the apr developed in the previous works is mostly under the consideration of single phase problems barcarolo et al 2014 chiron et al 2018 for the cavity dynamics concerning wedge penetrating fluid interfaces the single phase arp could encounter some unexpected issues due to the discontinuity of particle density or mass at the multi phase interfaces in this paper a numerical technique of phase switch correction proposed by sun et al 2019b is adopted to tackle these disadvantages of the single phase apr in this algorithm a correction step will be applied to switch the type of the inactive particle to be the same as the surrounding active particles if this inactive particle fails to find at least one active particle of the same phase from its kernel support domain in other words the implementation of this numerical correction prevents the droplet particles from inheriting the velocity of another phase this correction is imperative to ensure the accurate capturing of the worthington jets from the pinch off location as well as the rising bubbles when they pass the transitional region 2 3 boundary conditions in this paper the technique of fixed ghost particles proposed by adami et al 2012 is implemented to model all the solid wall boundaries this technique employs several layers of ghost particles to represent solid boundaries and the sph variables of these ghost particles can be accordingly obtained by interpolation extrapolation at present there have been two different extrapolating methods for this process one of them originates from the works by marrone et al 2011 in which the moving least square mls interpolation is adopted owing to its high accuracy in addition in the technique of marrone et al 2011 some interpolation points are mirrored from the ghost to the fluid region to improve the interpolating accuracy however in practice it is difficult to distribute interpolating points around irregular boundaries with sharp angles in the following simulations another extrapolating method i e the shepard interpolation adami et al 2012 is carried out to obtain the sph variables of ghost particles this method is able to achieve satisfactory accuracy through a direct extrapolation from fluid particles to ghost particles by neglecting the viscous stress between a fluid particle and its ambient ghost particles a free slip boundary condition is enforced furthermore a sponge layer is also performed around the tank walls in order to prevent possible pressure waves reflection from the solid boundaries see also sun et al 2015 2 4 time integration at present second order time integration formats have been widely applied in sph simulations for example the open source sph solver dualsphysics adopts the verlet and the symplectic scheme as its time discretization formats crespo et al 2015 in this paper however the 4th order runge kutta method rk4 allowing for a relatively larger time step is carried out as the time integration scheme due to its accuracy and stability the time change rate of a generic field quantity q can be written as 9 d q d t f q accordingly the pipeline of rk4 is given as antuono et al 2012 10 q 0 q n q 1 q 0 f q 0 δ t 2 q 2 q 0 f q 1 δ t 2 q 3 q 0 f q 2 δ t q 4 q 0 f q 0 2 f q 1 2 f q 2 f q 3 δ t 6 q n 1 q 4 where q i i 1 4 denotes the temporary field values required for the rk4 algorithm within every sub time step q n and q n 1 represent the generic field quantity at n th and n 1 th time step respectively the time step δ t is determined as antuono et al 2012 11 δ t cfl min i h i c 0 h h i c 0 l where cfl is adopted with a relatively large number 1 0 owing to the merit of the rk4 in fact as shown in eq 11 the time step δ t is determined by the density ratio which leads to different values of c 0 l in other words the computational cost is largely controlled by the density ratio in different cases 3 cavity dynamics regarding the classical water entry problems of a wedge a benchmark study 3 1 geometrical layout and numerical parameters before implementing the introduced multi phase sph model with apr scheme to simulate the problems of a wedge penetrating fluid interfaces with different density ratios a strict benchmark study is necessary to verify the numerical accuracy and stability of the utilized numerical scheme actually in practical engineering applications the density ratio at the interface is large around 800 1000 for wave impact and ship slamming problems in ocean engineering extensive experimental data can be found in the literature for such problems hence in this section the experimental and numerical investigation conducted by gong et al 2016 for a wedge penetrating a water air interface is employed as a benchmark to validate the numerical scheme in the laboratory experiment of gong et al 2016 following the procedures suggested by zhao and faltinsen 1993 an iron made wedge with the properties being cross section length w 0 1 m deadrise angle θ 30 and self weight m 3 444 kg was perpendicularly dropped at a vertical distance of h 0 0 2 m above a calm water level we reproduce their experimental conditions herein and the schematic diagram of the numerical implementation is depicted in fig 2 as it can be seen three levels of particle resolution are used around the wedge with the coarsest level 0 w δ r 25 the medium level 1 w δ r 50 and the finest level 2 w δ r 100 the length l of the computational domain is 0 9 m and the height of the air domain h a is 0 4 m to allow enough space for the free surface splashing nevertheless two remarkable differences compared with the laboratory test can be found in fig 2 one of them is that the water depth h b in the following simulations is considered as 0 8 m which is 0 2 m larger than the laboratory test to observe the subsequent cavity evolutions after pinch off and the other one is that the wedge is released with the penetrating velocity u 0 2 g h 0 1 98 m s at the still free surface at the beginning of the simulation i e t g w 0 for the purpose of reducing the computational cost considering that the air effect before the wedge touching the fluid surface is negligible these measures are rational in numerical aspects and exert minimal effects on the physical mechanism of the investigated problem maintaining a good balance between the numerical accuracy and the computational efficiency in the following simulations as outlined by truscott et al 2014 the wedge impacting into the lower layer heavy fluid water with density ρ 1000 kg m 3 surface tension σ 0 07 kg s 2 kinematic viscosity ν 1 0 6 m 2 s 1 is mainly characterized by five non dimensional numbers capillary number ca μ u 0 σ bond number bo ρ g w 2 σ froude number fr u 0 2 g w weber number we ρ u 0 2 w σ and reynolds number r e u 0 w ν where w denotes the characteristic length of the penetrating body and is considered as the width of the wedge in the present work u 0 the penetrating velocity and g the gravitational acceleration the orders of magnitude of these non dimensional numbers are listed in table 1 as reported by duez et al 2007 the critical capillary number for the cavity formation of hydrophobic spheres is at most of the order of o 1 0 2 o 1 0 1 the capillary number in the present study is c a 0 028 this order ensures the occurrence of cavity forming the bond number is always employed to indicate the type of seal event and the deep seal event will occur at bo 1 aristoff and bush 2009 the same as traditional marine hydrodynamics the froude number characterizes the macroscopic behaviors of the cavity in this paper the bond number and froude number are about bo 1 3 1 0 3 and fr 4 0 respectively this combination guarantees the occurrence of a deep seal event during a water entry process aristoff and bush 2009 indeed the wettability wetting angle of solid bodies is also responsible for the cavity formation but this factor is ignored in this paper since the froude number is relatively large fr 4 0 and further the sharp angles on top of the wedge will induce the separation of the flow on the wedge bottom and therefore generates the cavity as for the weber number and the reynolds number the former is often adopted to characterize the cavity breakup and the splash curtain stability and the latter is often related to the jet speeds at the initial impact and therefore can be neglected for the analysis of the later cavity evolution thoroddsen et al 2004 it is also worth noting that the froude number can be recast as fr we bo in other words the cavity dynamics is largely determined by these three parameters it can be observed from table 1 that the following simulations are within the scope of high weber number i e the physical process is dominated by the inertial force instead of the capillary effect as a result the surface tension can be ignored in the following simulations indeed the surface tension could play an important role in the shape of rising bubbles occurring at the latter stage of a water entry process however it is also reasonable to neglect this factor because it only exerts significant effects on small scale rising bubbles ming et al 2017 in the present study the rising bubbles originate from a seal event i e the scale of these bubbles is at the same order of magnitude of the wedge in this regime the surface tension is negligible compared with other environmental forces 3 2 cavity evolutions fig 3 shows a comparison of cavity evolutions between the sph simulations and the experimental snapshots obtained by gong et al 2016 at the beginning of the water entry event see t g w 0 5 a splash curtain is formed on account of the considerable kinetic energy of the moving wedge which is generated from two radial horizontal jets at the first moment of impact meanwhile a cavity occurs at the wake of the wedge owing to the splitting of the free surface followed by the deformation of the splash curtain at t g w 1 0 the wedge continues falling down quickly with the size of the cavity expanding vertically it can be observed that at the early stage of a water entry process the cavity is opening so the air effects can be neglected owing to the absence of cavity collapse this is why the air phase can be ignored in the prediction of slamming pressure at the early stage in such problems zhao and faltinsen 1993 xu et al 2008 but this is not the case when the deadrise angle is very small less than 4 degree in which the air cushioning effects become relevant in addition in order to straightforwardly demonstrate the accuracy of the utilized sph model in fig 4 we depict a comparison of the cavity profile at two typical instants i e at the moment of the pinch off and the generation of the worthington jet respectively it can be observed that the profiles of the cavity and the jet are generally in good agreement with the experimental measurements proving that the sph model possesses satisfactory accuracy for such problems as the simulation time continues increasing the cavity begins to emerge a tendency to collapse caused by the hydrostatic pressure from the liquid bulk see t g w 2 0 and the cavity pinches off at t g w 2 5 eventually it is well known that for a classical water entry process the seal event will create two vertical moving jets that are ejected upwards and downwards respectively at the singularity where the pinch off occurs truscott et al 2014 the upward jet will penetrate the free surface and thus results in the formation of the so called worthington jet antkowiak et al 2007 ogawa et al 2006 and the downward jet will eventually impact the apex of the wedge and thereby split the sealed cavity into two smaller bubbles see t g w 3 0 in fig 3 fig 5 depicts the evolutions of these two jets in detail from which it is demonstrated that the dynamic behaviors of the jets are well captured by the multi phase sph model introduced in section 2 it is worth noting that gong et al 2016 also has numerically investigated the same case via a two phase sph simulation good results were obtained before the downward jet reaching the top surface of the wedge in their simulation whereas the cavity evolutions quickly became less accurate showing disturbances at the multi phase interfaces after the downward jet impacting the wedge one possible explanation is that the accurate capturing of the cavity dynamics in such physical processes requires a high level particle resolution and the absence of arp in their numerical scheme thus leads to the inaccuracy for capturing these complex phenomena moreover in our developed multi phase sph model an additional term ℱ i is added in the momentum equation to guarantee the sharpness of the multi phase interfaces which also contributes to the accuracy of the simulation results indeed in extensive sph simulations corresponding to water entry problems few investigations have been paid to the cavity evolutions after pinch off thanks to the deep computational domain in the present work the cavity dynamics after pinch off can be simulated by the adopted multi phase sph model as displayed in fig 6 after the downward jet slamming the apex of the wedge the sealed cavity is split into two smaller bubbles subsequently these two bubbles are split again caused by rayleigh taylor instability and this secondly splitting leads to two rising bubbles above the wedge as can be seen the appearance of the rising bubbles eventually deforms into the shape of a horseshoe because of the buoyancy effect in addition the time histories of the vertical displacement of the wedge are also plotted in fig 7 as indicated by the comparison the evolutions of the wedge displacement in y axis are in fairly good agreement with the experimental results before pinch off while the numerical results show a slight deviation about 3 3 of the vertical displacement after pinch off one possible reason is that the three dimensional effects and the turbulence effects are neglected in the simulation which could affect the pressure distribution around the wedge and accordingly less predict the vertical displacement of the wedge in spite of that this deviation is acceptable since it is within the scope of 5 from the viewpoint of practical engineering applications 3 3 validation of the performance of the apr incorporating with a phase switch correction as introduced in section 2 the apr is adopted to improve the local accuracy and maintain relatively low computational cost during simulations in addition a phase switch correction is also implemented to improve the performance of the apr for the capturing of the multi phase interfaces which guarantees a smoothing transition and prevents possible non physical particle behaviors when fluid particles pass different resolution levels fig 8 illustrates the local particle patterns concerning the worthington jet generated from the pinch off and the rising bubbles originating from the rayleigh taylor instability of the sealed cavity fig 8 b displays the sharpness of the rising bubbles penetrating the multi resolution interface it can be observed that the sharpness of the rising bubbles is well captured at the finest level it is also indicated that particle resolution plays an important role in capturing the sharpness of the multi phase interfaces in the multi phase sph simulation performed by gong et al 2016 the isotropic particle spacing is about w δ r 61 for the whole computational domain and the total number of particles is about 400 000 in their works however in the present study the particle spacing around the wedge i e the finest level is refined into w δ r 100 whereas the total number of particles is only about 247 500 in other words thanks to the merit of the apr the water entry process is more accurately simulated by employing less fluid particles there is no doubt that if the particle spacing is changed from w δ r 61 to w δ r 100 without applying the apr the total number of particles will increase to an order o 1 0 7 of magnitude it is demonstrated that apr is essential for such problems since the deployment of this numerical format keeps a good balance between numerical accuracy and computational efficiency as for the worthington jet shown in fig 8 a the appearance of the worthington jet keeps its shape and sharpness at different resolution levels and the tip of the worthington jet is also well captured by our proposed multi phase sph model as reported by sun et al 2019b in a simulation of dam breaking flows slamming an elastic plate if the apr is implemented without adopting the phases switch correction the tips of a water tongue could be reflected from the multi resolution interfaces with the velocity of the water particles inheriting from the surrounding gas particles in terms of the worthington jet the same behaviors may occur when it penetrates the multi resolution interface in the absence of a phase switch correction it is demonstrated from the previous investigation and the present work that for the developed multi phase sph model the apr works as desire only by incorporating with the phase switch correction to prevent possible non physical particle behaviors on the whole the proposed multi phase sph model in combination with the apr incorporating with the phase switch correction possesses satisfactory accurate and robust performance in such problems and can be treated as a reliable approach for further studies in the following section the same physical processes extending to different density ratios will be also simulated and discussed in detail 4 cavity dynamics with different density ratios marston et al 2016 have experimental investigated the canonical problem of the crown splash and sealing phenomena during the impact of spheres onto a calm water surface in their test conditions the ambient pressure was from atmospheric pressure down to 1 16 of an atmosphere by employing a vacuum chamber one striking conclusion derived from the sophisticated experiment is that the ambient pressure exerts significant effects on the timescale of the sealing process of a crown splash moreover it is also demonstrated that the lower ambient pressure is the longer sealing time requires in a laboratory test the ambient pressure is uncomplicated to reduce by a vacuum chamber while it is difficult to increase from atmospheric pressure to hundreds or even thousands of times of an atmosphere as a result marston et al 2016 have only investigated the cases in which the density ratio is larger than 1000 one important motivation of this section is to investigate the cases with density ratio lower than 1000 which is easy to realize by numerical simulations as discussed in section 3 it can be found that the five non dimensional numbers are independent of the density ratio namely the multi phase sph model introduced in section 2 is also suitable for different density ratios conditions although the time step will be largely affected and accordingly influences the computational cost in each case the geometrical layout of the simulations shown in this section is the same as that in section 3 see also fig 2 in the following discussions we defined a non dimensional coefficient regarding the pinch off depth d to compare the characteristics of cavity dynamics between different density ratios as illustrated in fig 9 d is defined as d h b h p with h p being the distance between the apex of the wedge to the bottom of the computational domain at the moment of pinch off table 2 lists the extracted values of h p and d corresponding to different density ratios 4 1 cavity evolutions as reported by marston et al 2016 the timescale of a seal event is approximately inversely proportional to the ambient pressure nevertheless it must be highlighted that the froude number in their experiment is considerably large f r 2 1 0 3 namely the splash curtain is always sealed by dome over in the different cases of their investigation nevertheless in the present work the froude number for each case is significantly smaller than in their experiment in fact based on our sph simulations it is found that the cavity sealing in this regime is actually governed by two factors i e dome over or pinch off depending largely on the density ratio in other words the distinctions of cavity dynamics with different density ratios at the fluid interface can be characterized by the profile of the worthington jet and the evolution of the sealed cavity therefore this subsection will investigate the cavity dynamics with different density ratios from these perspectives according to the characteristics of the free surface deformations and cavity evolutions in this paper we defined the cases with 25 ρ h ρ l 1000 as high density ratios hdrs 5 ρ h ρ l 25 as medium density ratios mdrs and ρ h ρ l 5 as low density ratios ldrs figs 10 and 11 illustrate the snapshots of worthington jets at t g w 3 7 and rising bubbles at t g w 4 7 with regard to different density ratios respectively fig 12 shows that comparison of the initial jets corresponding to different typical density ratios because the cases with density ratio larger than 10 share very similar characteristics of the initial jets we choose ρ h ρ l 10 as the representative one figs 13 21 display the cavity evolutions during the whole simulation processes with different typical density ratios ranging from 1 25 to 100 ρ h ρ l 1000 is not shown because it is already displayed in figs 3 6 4 1 1 high density ratios 25 ρ h ρ l 1000 it can be seen from figs 3 6 and 13 14 that in hdrs the cavity evolutions are almost identical these physical processes are already elaborated in section 3 as outlined by aristoff and bush 2009 the cavity evolution can be categorized into four types of seal events quasi static seal deep seal shallow seal and surface seal the deep seal is characterized by the first pinch off occurring at the location where it is one third to one half of the distance between the body and the undisturbed water level according to this definition confirmed by table 2 the sealing behaviors in these cases show typical characteristics of the deep seal because the pinch off locations are about one half distance between the apex of the wedge and the still water level as for the pinch off time it is also almost identical for ρ h ρ l 1000 and ρ h ρ l 100 while a slight increase can be found in ρ h ρ l 50 it can be seen from figs 10 b and 10 c that although the density ratio decreases to 100 or even 50 the worthington jets keep their typical characteristics in ρ h ρ l 100 and ρ h ρ l 50 i e perpendicularly penetrating the free surface with a slim conical profile in terms of the rising bubbles as illustrated in figs 11 b and 11 c in this regime the splitting of the sealed cavity remains its approximately regular and symmetrical characteristics described above it is demonstrated that the density ratio exerts negligible effects on the cavity dynamic when 25 ρ h ρ l 1000 4 1 2 medium density ratios 5 ρ h ρ l 25 although the cavity dynamics is almost unaffected by the density ratio in hdrs it begins to be significantly altered when the density ratio decreases to 25 as indicated in fig 15 at the initial stage of impact a splash curtain is generated owing to the perpendicular slamming of the wedge and the cavity accordingly begins to form this phenomenon is the same as the cases with hdrs despite these similarities some different striking features can be found in ρ h ρ l 25 at the subsequent stage firstly the tips of the splash curtain are quickly attracted towards the central line of the wedge after the impact and the splash curtain subsequently domes over at t g w 2 2 before pinch off this phenomenon is absent in terms of hdrs shortly after pinch off the second remarkable difference can be observed that the resulting worthington jet is dramatically disturbed and thereby no longer penetrates the free surface in a perpendicular trajectory tilting to one side this instability causes the breaking of the worthington jet which leads to the scattered droplets above the free surface as depicted in fig 10 d the final difference can be found in the subsequent splitting of the sealed cavity in hdrs the sealed cavity will be split into two bubbles due to the action of the downward jet before long these two bubbles continue to be split into four smaller bubbles owing to rayleigh taylor instability the newly generated bubbles separated from the two larger bubbles are approximately symmetrical and eventually rise towards the free surface see also figs 11 a 11 c nevertheless in ρ h ρ l 25 the rising bubbles generated from the splitting of the sealed cavity show strong asymmetry i e the rising bubbles are no longer characterized by a pair of horseshoes see also fig 11 d the aforementioned characteristics in ρ h ρ l 25 can be more clearly observed in the remainder of mdrs as illustrated in figs 16 18 in these cases the dome over of the splash curtains are even earlier at t g w 1 2 than that of ρ h ρ l 25 it is interesting that the subsequent collapse after dome over loses its symmetry in total on account of the generation of the splashing jets stemming from the impact of water curtains as the simulation time increases continuously the cavity eventually pinches off between t g w 2 7 3 2 in the remainder of mdrs although the cavity evolutions are basically the same as ρ h ρ l 25 before pinch off one pronounced feature can be observed that instead of generating two rising bubbles the sealed cavity is divided into a large bubble attaching the wedge with a small bubble rising towards the free surface as illustrated in figs 11 e 11 g the smaller bubbles spirally rise upwardly whereas the larger bubble continues falling down with the wedge 4 1 3 low density ratios ρ h ρ l 5 when the density ratio decreases to 5 two pronounced features can be observed in this regime it can be observed from fig 12 that the thickness of the initial jets is obviously enlarged compared with the pre discussed cases on the contrary the behaviors of the initial jets in hdrs and mdrs are almost identical characterized by slender and sharp profiles with the breaking of tips into droplets however in ρ h ρ l 5 the most remarkable difference is that the tip of the initial jet is obviously more rounded than the cases with higher density ratios moreover the number of droplets is less due to the higher stability of the impact jet another pronounced feature is that after pinch off the worthington jet is no longer in a conical profile which can be attributed to the fact that in this case the cavity is sealed by the dome over instead of the pinch off as can be seen from figs 19 e 19 g before the occurrence of the pinch off the free surface is already disturbed considerably by the breaking of initial jets and thereby the subsequent worthington jet will be consequently affected after being ejected from the pinch off location if the density ratio further decreases to 2 5 or lower as depicted in figs 20 and 21 the cavity will be completely sealed by the flow with considerable density above the water surface i e becoming dome over instead of pinch off that is to say that the pinch off event disappears in ρ h ρ l 2 5 and ρ h ρ l 1 25 from the viewpoint of the traditional definition regarding the pinch off behavior see also figs 10 i and 10 j it is interesting that in ρ h ρ l 1 25 see also fig 21 the tip of the jets generated from the initial slamming draws an elegant pattern in a spiral path which eventually results in the two smaller bubbles inside the sealed cavity as for the jets generated at the initial impact it can be observed from fig 12 that the flow characteristics are significantly different at the initial stage being altered by the very low density ratio the most evident feature is that the water phase is detached from the surface of the wedge due to the air cushioning effects by the upper layer fluid which is not discharged in such a short time this behavior is aggravated in the lowest density ratio in addition to the air cushioning effects the impact induced jets seem to be more rounded than that in ρ h ρ l 5 as marked by the dashed circle in fig 12 furthermore it also can be found that the cavity evolutions seem to be more stable and regular in ldrs compared with mdrs in general the cavity evolutions are exactly affected by the density ratio from the initial stage to the subsequent cavity forming and cavity splitting stages indeed the phenomena of pressure drop exhibit in the initial cavity due to the energy transfer from the wedge to the upper layer fluid in other words due to these fsis the cavity dynamics in such physical processes can be also elucidated from another viewpoint i e the motion characteristics of the wedge to this end in the next subsection the time histories of the velocities and displacements of the wedge with different density ratios will be discussed in detail 4 2 motion characteristics of the wedge 4 2 1 vertical motion figs 22 and 23 depict the motion characteristics of the wedge in y direction as shown in fig 22 the variations of the vertical velocity of the wedge can be divided into three stages at the initial stage of the impact i e stage 1 see also fig 22 b the velocity reduction of the wedge increases as the density ratio decreases especially for ldrs the main explanation is that at stage 1 the acceleration of the light phase is induced by the vertical movement of the wedge which leads to continuous energy consumption and consequently the wedge decelerates rapidly in this process the kinematic energy of the wedge transfers to that of the light fluid in this circumstance lower density ratios will dissipate more kinetic energy from the wedge due to larger added mass however this phenomenon is totally reversed between t g w 1 2 2 4 i e stage 2 it can be seen from fig 22 c that in this range the lower the density ratio the greater the vertical velocity which can be also explained from the viewpoint of energy conservation fig 24 displays the jet shapes of five typical density ratios at the beginning of stage 2 i e t g w 1 2 it can be observed that as the density ratio decreases the impact jets are gradually bent towards the central line of the wedge avoiding being significantly raised up implying that less kinetic energy of the wedge is transferred to the potential energy of the heavy fluid therefore at stage 2 the magnitude of the wedge s velocity of lower density ratios is larger than that of higher density ratios which is opposite to the phenomenon at stage 1 finally at the last stage i e stage 3 it can be found from fig 22 d that lower density ratios are in favor of maintaining the higher vertical velocity of the wedge in fact it can be observed from figs 11 b 11 j that the sealed cavity tightly attaches to the apex of the wedge after pinch off as a consequence the wedge continues falling with the large bubble in this sense the bubble with lower density ratios has a larger mass and therefore provides more propulsive effects on the wedge accordingly the ending vertical velocity in lower density ratios keeps a relatively higher magnitude however we note that when the density ratio is larger the phenomenon is more complex since the variation of the vertical velocity of the wedge with respect to the density ratio seems to lose its regularity see also fig 22 d one possible explanation could be that after pinch off the cavity evolutions show extreme complexity in mdrs see also fig 11 in this regime the pressure distribution surrounding the wedge becomes quite complicated which could result in the variation of the wedge s vertical velocity in addition to that the changing of the bubble mass associated with the moving wedge is negligible when the density ratio becomes higher and therefore the velocity differences among higher density ratios are much smaller the variation of the wedge s displacement is tightly linked to the variation of the wedge velocity from fig 23 a it can be found that the vertical displacement before stage 2 increases as the density ratio increases while at stage 3 the wedge in ldrs possesses a larger displacement 4 2 2 horizontal motion fig 25 depicts the time histories of the motion characteristics of the wedge in x direction for different density ratios including both horizontal velocity and displacement as displayed in figs 25 a and 25 b at the beginning of the impact the velocity in x direction with different density ratios is almost zero and hence the displacement is zero too which can be explained by the symmetry of the initial cavity as observed from figs 13 21 before t g w 1 2 the cavities are almost symmetrical i e the pressure distribution around the wedge surface is balanced in x direction and therefore the horizontal net force acting on the wedge approximately equals to zero however as shown in fig 25 there are two instants after which the horizontal velocity of the wedge starts to deviate from zero the first instant is t g w 1 2 after which the wedge s horizontal velocity of the cases of ρ h ρ l 5 and 10 begins to deviate as the simulation time increases this phenomenon could be attributed to the fact that in these two cases when the cavity is sealed due to the dome over event the cavity shape suddenly becomes asymmetrical while in the cases with other density ratios the asymmetry is induced much later see also figs 19 21 the second instant is t g w 4 0 after which the horizontal velocities of ρ h ρ l 2 5 15 and 20 show obvious deviation this is caused by the oblique impact of the downward jet as shown in figs 16 i 17 i and 20 i where the jets show obvious asymmetrical trajectories and consequently result in the deviation of horizontal velocity however in hdrs the downward jet still maintains vertical direction see also figs 6 b 13 i and 14 i which exerts negligible effects on the variation of the horizontal velocity and displacement 5 conclusions and future works in this paper a multi phase sph model with apr is applied to investigate the problem associated with a wedge penetrating fluid interfaces characterized by different density ratios a numerical benchmark with regard to the water entry of a wedge is firstly simulated to verify the accuracy and stability of the presented sph model it is demonstrated that both the cavity evolutions during penetrating and the motion characteristics of the wedge are accurately simulated by the utilized sph model a pronounced advantage of the implemented multi phase sph model is the deployment of the apr incorporating with a phase switch correction therefore with fewer overall particles the accuracy of an sph simulation can be greatly improved in the local regions where the particle resolution is refined in addition to the validation study the cavity dynamics of the water entry of a wedge for different density ratios is also investigated and discussed in detail it is found that the discrepancies of the cavity dynamics between different density ratios are mainly reflected by three factors i e the initial impact jets the worthington jet causing by a pinch off event and the evolutions of the sealed cavity in terms of the initial jets it is shown that the impact jets share the same characteristics when the density ratio is below 10 i e the heavy fluid attaches tightly along the deadrise surface of the wedge with the thin jet tips breaking into droplets nevertheless in ldrs the heavy fluid begins to detach from the wall boundaries and the impact jets become more rounded than those in hdrs and mdrs as for the worthington jet it is clearly demonstrated that in hdrs the worthington jet shows typical characteristics as reported in extensive literature i e it is ejected from the pinch off location and then penetrates the free surface perpendicularly nevertheless as the density ratio decreases from hdrs to mdrs the worthington jet is evidently disturbed and consequently distorted downwards in a random direction which results in the breaking of the worthington jet into droplets however it is interesting that the worthington jet is absent in ldrs because in this regime the cavity is totally sealed by the dome over behavior instead of the pinch off event regarding the evolutions of the sealed cavity the most striking feature is that the generation and scale of the rising bubbles split from the sealed cavity are largely controlled by the density ratio in hdrs the rising bubbles are approximately symmetrical and gradually alter their shapes into a horseshoe during moving towards the free surface nonetheless in mdrs the rising bubbles gradually lose their symmetry as the density ratio decreases showing more instabilities and irregularities as for ldrs the chaos seems to be alleviated apparently and the shape of the bubbles behind the wedge recover its symmetry to a large extent finally it is also found that the motion characteristics of the wedge are tightly related to the cavity evolutions to a large extent generally in hdrs and ldrs the motion of the wedge is more stable and predictable because the cavity evolutions are approximately symmetrical whereas in mdrs the motion of the wedge shows obvious complexity and instability because of the strong nonlinearity of the cavity evolutions in the future the utilized multi phase sph model with apr can be further improved to a more advanced version which is expected to be capable of capturing cavitation effects for those water entry problems characterized by high speed or ultra high speed relevant studies are still ongoing credit authorship contribution statement hong guan lyu formal analysis validation investigation visualization writing original draft rui deng supervision project administration peng nan sun conceptualization methodology software resources data curation funding acquisition writing review editing jian ming miao supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by national natural science foundation of china grant nos 12002404 51679053 guangzhou basic and applied basic research project grant no 202102020371 project of research and development plan in key areas of guangdong province grant no 2020b1111010002 key laboratory of ministry of education for coastal disaster and protection hohai university grant no d202004 the open fund of state key laboratory of coastal and offshore engineering dalian university of technology with grant no lp2017 and natural science foundation of guangdong province of china grant no 2019a1515011405 
20278,bodies penetrating fluid interfaces is a classical issue that has been considerably investigated especially for water entry problems because of its relevance to slamming phenomena in ocean and coastal engineering this paper is dedicated to investigating the water entry problems of a wedge characterized by different density ratios using multi phase smoothed particle hydrodynamics sph simulations the sph model is combined with an adaptive particle refinement apr incorporating with a phase switch correction to improve the numerical accuracy and computational efficiency of simulations firstly an sph simulation for a classical water entry process of a wedge is employed as a benchmark to validate the accuracy and stability of the utilized sph model subsequently the mechanisms of the spatiotemporal cavity behaviors for different density ratios are simulated and discussed in detail it is demonstrated that the cavity evolutions during penetrating and motion characteristics of the wedge are significantly affected by density ratios it is also suggested that the presented multi phase sph model with apr can be treated as a reliable numerical tool for solving such problems in terms of complex fluid interfaces behind moving structures keywords water entry cavity dynamics different density ratios smoothed particle hydrodynamics multi phase sph model adaptive particle refinement 1 introduction the problems associated with bodies penetrating fluid interfaces have been a canonical and fundamental issue in fluid mechanics as there are many complicated physical phenomena in these processes that deserve our attention due to their relevance to both scientific and industrial applications one of the most important branch of this issue is water entry problems in which solid bodies penetrate a water air interface following numerous complex multi phase interactions truscott et al 2014 it is not surprising that the water entry problems have attracted so much attention since this issue is tightly related to many practical engineering applications e g slamming on fixed or floating offshore structures dias and ghidaglia 2018 faltinsen 1990 ballistics dynamics truscott 2009 truscott et al 2009 ditching of aircrafts woodgate et al 2019 xiao et al 2017 siemann and langrand 2017 etc the cavity dynamics has been considerably investigated over the past decades whereas it remains a challenging issue in water entry problems generally speaking water entry problems can be categorized by whether a cavity is formed there are two types of situations in the cavity forming cases known as the air entrainment and supercavitation truscott et al 2014 this paper is restricted to the former and the latter is beyond the scope of the present work for supercavitation the readers can refer to knapp et al 1970 plesset and prosperetti 1977 rood 1991 hrubes 2001 franc and michel 2004 and weiland and vlachos 2012 the phenomenon regarding air entrainment has been widely studied with various shapes of solid bodies e g sphere cylinder wedge shapes by theoretical numerical or experimental methods the theoretical methods also known as the analytical or semi analytical methods are devoted to developing simplified models with ideal conditions these ideal models however have obvious limitations in practical engineering problems in which many complex physical mechanisms cannot be ignored with simplification consequently experimental and numerical methods have been regarded as two more feasible tools for water entry problems the pioneering works of experimental methods were conducted by worthington and cole 1897 1900 who captured still images using single spark photography and thus obtained the earliest images of water entry problems thanks to the surprising development of high speed cameras the unsteady cavity dynamics can be more accurately captured by employing these advanced devices with thousands of frames per second fps or even one million fps numerous experimental investigations with high speed imaging techniques have been published over the past few decades may 1951 1952 aristoff and bush 2009 bergmann et al 2009 shi et al 2000 thoroddsen et al 2004 duclaux et al 2007 truscott 2009 truscott et al 2009 it is well accepted from these extensive high speed imaging experiments that the questions belong to the general issue of water entry problems can be mainly divided into two different kinds of studies the initial stage of contact and the subsequent cavity forming event duclaux et al 2007 the former mainly focuses attention on the impact jets generated at the moment of contact including initial jet speeds the emergence of jets and the breakup of jets thoroddsen et al 2004 these jets are always responsible for the ultra high slamming pressure which is of significance at the pre design stage of underwater launching of torpedos and structural strength of marine structures and so on for the latter duclaux et al 2007 has performed a comprehensive experimental investigation on the dynamics of transient cavities with the fluid medium being air and water the readers may also refer to 6 64 and truscott et al 2014 for more details although the high speed or ultra high speed imaging experiments are of great benefit to the study of water entry problems their expensive costs are an obvious disadvantage of this manner as a consequence of the fast development of the semiconductor industry the technique of computational fluid dynamics cfd that requires high performance computers hpcs has been more and more popular to investigate this issue abundant studies have been performed to investigate different water entry exit problems using the eulerian mesh based solver e g openfoam star ccm it is demonstrated by these numerical studies that the sharpness of multi phase interfaces always shows apparent diffusion in the mesh methods because of their inherent eulerian nature zhu et al 2006 nguyen et al 2016 iranmanesh and passandideh fard 2017 given the aforementioned drawback another paradigm known as the lagrangian particle based method has been well accepted in such physical processes characterized by large deformation and breaking of fluid interfaces rao and wan 2018 xie et al 2020 among them the truly meshless smoothed particle hydrodynamics sph has been widely carried out for solving fluid structure interactions fsi ming et al 2016 long et al 2021 khayyer et al 2021 peng et al 2021a c over the past two decades the sph has progressed significantly because of its ability to deal with the free surface breaking and the moving boundaries problems cheng et al 2017 these characteristics represent that the sph is inherently suitable to be applied in ocean and coastal engineering gotoh and khayyer 2018 ye et al 2019 he et al 2020 you et al 2021 extensive sph simulations have been implemented for water entry problems in the early years single phase sph models have been widely applied to numerically study such problems oger et al 2006 gong et al 2009 farsi and ghadimi 2014 2015 it can be observed from these numerical simulations that since single phase sph models possess limited abilities for capturing subsequent air entrainment phenomena after penetrating it is usually implemented to simulate the initial stage of contact in other words a multi phase sph model is required for such problems in which the fluid behaviors are strongly affected by complex multi phase interactions at the subsequent cavity forming and cavity splitting stages cao et al 2018 yan et al 2020 sun et al 2021a b peng et al 2021b meng et al 2021 gong et al 2009 and gong et al 2016 performed numerical investigations for the water entry problems of a wedge with a single phase and a multi phase sph model respectively it is revealed that the phenomena are similar at the early stage of an impact whether a single phase or a two phase model was implemented in their latter study gong et al 2016 the multi phase sph model proposed by colagrossi and landrini 2003 was also implemented to investigate the cavity dynamics at the later stage of an impact event in which the phenomena of cavity forming and cavity splitting were considered it can be observed from the numerical results that the process of cavity forming can be well captured once the air effects are involved while the sharpness of the multi phase interfaces was slightly disturbed after pinch off which is possibly caused by the inadequate particle resolution and the lack of numerical treatments for the fluid interface characterized by serious density discontinuity as discussed above although the problems regarding solid bodies penetrating fluid interfaces have been widely investigated the attention paid to this issue has been mainly focused on the classical water entry problems in which the density ratio of heavy fluid to light fluid is restricted to around 1000 few studies have been dedicated to investigating the cases characterized by different density ratios in fact in some experimental studies see e g marston et al 2016 the ambient pressure of the water entry can be reduced to change the density ratio of water to air it has been demonstrated that the phenomena of fluid splash and cavity evolutions are completely different at different ambient pressures but in the experiment marston et al 2016 the ambient pressure was only reduced i e the density ratio of water to air was only increased on the contrary the phenomena due to the decrease of the density ratio of water to air are still unknown and this decrease was not easy to realize in an experiment but this is quite feasible in numerical studies using a multi phase sph model besides many sph simulations adopted relatively coarse particle resolution to solve such problems for the purpose of reducing computational cost whereas this exerts adverse effects on the simulation results when the interactions between different phases are quite complex therefore a methodology to improve local accuracy and maintain relatively low computational costs is also demanded for such problems zhao et al 2021 the present study aims to introduce an accurate and stable multi phase sph model in combination with a technique of adaptive particle refinement apr chiron et al 2018 which is expected to be capable of predicting the cavity dynamics when a wedge penetrates fluid interfaces another important motivation is to investigate the effects caused by different density ratios on the physical mechanism of cavity dynamics during the penetrating process this paper can be treated as an extension and improvement of the works by sun et al 2018b in which a single phase sph with apr was used for the water entry problems of circular cylinders the remainder of this paper is organized as follows in section 2 the numerical procedures regarding the multi phase sph model with apr will be briefly introduced mathematically in section 3 a canonical problem associated with a water entry process of a wedge i e the density ratio equals to 1000 is employed as a benchmark to validate the accuracy and stability of the adopted numerical method in section 4 the cavity dynamics of a wedge penetrating fluid interfaces with different density ratios is simulated and discussed in detail finally conclusions and prospects will be illustrated in the last part of this paper 2 multi phase sph model with apr 2 1 governing equations for the multi phase sph model the δ sph model antuono et al 2010 is an advanced version stemming from the classical sph scheme monaghan 2005 which prevents the phenomenon of high frequency pressure oscillation through adding the so called δ term in the continuity equation it is demonstrated that the sph model with the δ term shows great performance in dealing with the free surface flows characterized by large deformations and fragments marrone et al 2011 recently the δ sph model has been improved by combining the traditional δ sph model with a particle shifting technique pst which results in a more accurate and stable numerical scheme known as the δ sph model sun et al 2017 2019a in the context of a rigid body penetrating fluid interfaces the multi phase interfaces could be disturbed to a large extent because of the considerable kinetic energy of the high speed moving body in this regime the sph model is very suitable furthermore because the cavity evolutions during penetrating involve various multi phase interactions between different fluids e g cavity forming collapsing and splitting the multi phase effects must be considered for the sake of accurately capturing these complex phenomena finally the governing equations solving the investigated physical processes are thus given as sun et al 2019c 1 d ρ i d t ρ i j v j v i i w i j v j δ c 0 i h i j χ i π i j i w i j v j d v i d t 1 ρ i p i tic α c 0 i h i ρ 0 i ρ i j χ i π i j i w i j v j f i ℱ i ℱ i 0 08 j χ i p j p i i w i j v j d r i d t v i r i r i δ r i δ r i cfl ma i 2 h i 2 j 1 r w i j w δ r i n i w i j v j p i c 0 i 2 ρ 0 i γ i ρ i ρ 0 i γ i 1 v i t m i ρ i t where the subscripts i and j denote the target particle and its neighboring particles within the compact support domain p ρ v m r and v represent the pressure density volume mass position and velocity respectively the subscript 0 signifies the reference value of a field quantity i e ρ 0 i and c 0 i stand for the fluid density and the pseudo sound speed of the i th particle at rest respectively f i denotes the vector regarding body force which is the gravitational force in the present study i e f i 9 81 m s 2 in the following simulations the kernel function w i j w r i r j h i adopted in this work is the wendland c 2 kernel wendland 1995 with the smoothing length h i being two times of the initial particle spacing h i 2 δ r i this kernel function is very suitable for multi phase problems with violent free surface breaking cfl stands for the courant friedrichs lewy coefficient and ma i the mach number of the phase that the i th particle belongs to in addition r 0 2 and n 4 are two constants as suggested by lind et al 2012 r i stands for the i th particle position derived from the time integration of its physical velocity v i however in the utilized sph model an additional shifting correction δ r i is applied to r i at every time step for the sake of regularizing particle distribution resulting in the real particle displacement denoted by r i it has been elucidated that this correction is reasonable because the term δ r i converges to zero as the refinement of the particle resolution and therefore the particle trajectories during an sph simulation converges to its lagrangian trajectory if particle resolution is fine enough sun et al 2019a in this work pst is applied for all the inactive particles and the light phase particles both active and inactive for inactive particles their velocities are interpolated from the surrounding active particles as a result it loses the capability of self regularization so particle shifting is mandatory sun et al 2018b for light phase particles shifting is necessary because their distribution is more sensitive to the pressure gradient due to their smaller masses in addition negative pressures could be induced behind the moving structure hence pst and tensile instability control tic should be applied simultaneously sun et al 2018a while for the heavy phase shifting can be exempted for a water entry problem in the following simulations a wedge will penetrate fluid interfaces from the upper layer phase light to the lower layer phase heavy and the heavy phase is always considered as water in all cases as shown in eq 1 the pressure p i for both heavy and light phases are explicitly calculated via an equation of state antuono et al 2011 with different parameters in multi phase sph simulations colagrossi and landrini 2003 the polytropic coefficient γ i is often chosen as γ h 7 for water and γ l 1 4 for air respectively nevertheless in the present work the fluid phases are various with different density ratios and the selection of the value of γ i thereby needs to be tuned carefully fortunately it has been demonstrated that the polytropic coefficient has negligible effects on the final numerical results within the framework of the weakly compressible hypothesis rossi 2014 considering the conclusion by rossi 2014 the parameter γ i is still adopted as γ h 7 for the heavy phase and γ l 1 4 for the light phase in every simulation besides according to the weakly compressible hypothesis the density variation of water must be below 1 of the reference density ρ 0 h which can be realized by guaranteeing the mach number less than 0 1 monaghan 1994 hence the pseudo sound speed c 0 h of the heavy phase i e water in this work and the corresponding mach number ma h can be written as 2 c 0 h 10 max u h max p h max ρ 0 h ma h u h max c 0 h 0 1 where u h max and p h max represent the maximum expected velocity and pressure in the water domain respectively furthermore the pseudo sound speed c 0 l in the light phase and the corresponding mach number ma l can be given as colagrossi and landrini 2003 3 c 0 h 2 ρ 0 h γ h c 0 l 2 ρ 0 l γ l c 0 l c 0 h 2 γ l ρ 0 h γ h ρ 0 l ma l u l max c 0 l it can be observed that two diffusive terms respectively are employed in eq 1 for the continuity and momentum equations with a stability purpose according to marrone et al 2011 π i j in the density diffusive term is given as 4 π i j 2 ρ j ρ i r j r i r j r i 2 ρ i l ρ j l where l stands for the renormalized spatial gradient given as bonet and lok 1999 5 ρ i l j χ i ρ j ρ i l i i w i j v j l i j χ i r j r i i w i j v j 1 where χ i denotes all the neighboring particles that belong to the fluid of the i th particle as for the artificial viscosity term π i j is written as monaghan 2005 6 π i j v j v i r j r i r j r i 2 in eq 1 the diffusive parameters δ 0 1 and α 0 02 are adopted in the following simulations p i tic represents the pressure gradient with tic which can be given as 7 p i tic j f p i p j i w i j v j in which 8 f p i p j p j p i p i 0 i ω f p j p i p i 0 i ω f where ω f stands for the particle set containing free surface particles and its neighboring particles in traditional sph models the pressure gradient in the momentum equation is expressed with the plus format i e p j p i however in eq 8 the pressure of particles with positive pressure or in the free surface region remain its classical form on the other hand other particles characterized by negative pressures and located out of the free surface region are evaluated using the difference format i e p j p i indeed this difference format is non conservative and would cause errors in the momentum conservation fortunately this drawback can be alleviated when particle distribution of a computational domain is homogeneous after using pst sun et al 2018a one striking difference between the multi phase sph model and a single phase version is that the density diffusive term has to be considered to be zero if the i th and j th particles of an interaction pair come from different fluid phases another important difference is that an additional term ℱ i named interface sharpness force is added to the momentum equation for the sake of keeping the sharpness of the multi phase interfaces grenier et al 2009 in ℱ i χ i stands for all the neighboring particles that do not belong to the fluid of the i th particle this corrective force prevents interface penetration but leads to a slight gap between different fluid phases 2 2 advanced adaptive particle refinement with a phase switch correction for particle based numerical methods e g mps and sph the numerical accuracy is directly linked to particle resolution if particle refinement is implemented globally the computational cost will accordingly be unbearable owing to the nonlinear growth of the total number of particles in order to overcome this drawback apr is employed to improve the local accuracy around the wedge as well as its surrounding domain in which the cavity formation and the pinch off event will occur in the present study the algorithm developed by chiron et al 2018 is implemented to realize the generation of multi resolution regions which is an advanced variant of the apr firstly proposed by barcarolo et al 2014 as displayed in fig 1 for 2d cases one coarse particle mother particles will be split into four refined particles daughter particles after entering the pre defined splitting domain the particle spacing in the daughter level is half of that of its mother level according to the algorithm the mother particles will be de activated after splitting and the subsequent daughter particles become active and join in the sph calculation the inactive particles are allowed to be transported in a purely lagrangian manner by interpolating their velocities from the background flow in fact represented by daughter particles and are re activated after moving out of the splitting domain this apr requires a coupling of the flow information on the interface between the daughter level and its mother level i e a transitional region which is required in order to fulfill the coupling in the transitional region the state of the daughter and its mother particles is opposite compared with the one inside the splitting domain nevertheless in the applications of multi phase conditions this apr needs to be corrected for achieving more accurate flow information at the multi phase interfaces especially when interface breaking and splashing occur it is worth noting that the apr developed in the previous works is mostly under the consideration of single phase problems barcarolo et al 2014 chiron et al 2018 for the cavity dynamics concerning wedge penetrating fluid interfaces the single phase arp could encounter some unexpected issues due to the discontinuity of particle density or mass at the multi phase interfaces in this paper a numerical technique of phase switch correction proposed by sun et al 2019b is adopted to tackle these disadvantages of the single phase apr in this algorithm a correction step will be applied to switch the type of the inactive particle to be the same as the surrounding active particles if this inactive particle fails to find at least one active particle of the same phase from its kernel support domain in other words the implementation of this numerical correction prevents the droplet particles from inheriting the velocity of another phase this correction is imperative to ensure the accurate capturing of the worthington jets from the pinch off location as well as the rising bubbles when they pass the transitional region 2 3 boundary conditions in this paper the technique of fixed ghost particles proposed by adami et al 2012 is implemented to model all the solid wall boundaries this technique employs several layers of ghost particles to represent solid boundaries and the sph variables of these ghost particles can be accordingly obtained by interpolation extrapolation at present there have been two different extrapolating methods for this process one of them originates from the works by marrone et al 2011 in which the moving least square mls interpolation is adopted owing to its high accuracy in addition in the technique of marrone et al 2011 some interpolation points are mirrored from the ghost to the fluid region to improve the interpolating accuracy however in practice it is difficult to distribute interpolating points around irregular boundaries with sharp angles in the following simulations another extrapolating method i e the shepard interpolation adami et al 2012 is carried out to obtain the sph variables of ghost particles this method is able to achieve satisfactory accuracy through a direct extrapolation from fluid particles to ghost particles by neglecting the viscous stress between a fluid particle and its ambient ghost particles a free slip boundary condition is enforced furthermore a sponge layer is also performed around the tank walls in order to prevent possible pressure waves reflection from the solid boundaries see also sun et al 2015 2 4 time integration at present second order time integration formats have been widely applied in sph simulations for example the open source sph solver dualsphysics adopts the verlet and the symplectic scheme as its time discretization formats crespo et al 2015 in this paper however the 4th order runge kutta method rk4 allowing for a relatively larger time step is carried out as the time integration scheme due to its accuracy and stability the time change rate of a generic field quantity q can be written as 9 d q d t f q accordingly the pipeline of rk4 is given as antuono et al 2012 10 q 0 q n q 1 q 0 f q 0 δ t 2 q 2 q 0 f q 1 δ t 2 q 3 q 0 f q 2 δ t q 4 q 0 f q 0 2 f q 1 2 f q 2 f q 3 δ t 6 q n 1 q 4 where q i i 1 4 denotes the temporary field values required for the rk4 algorithm within every sub time step q n and q n 1 represent the generic field quantity at n th and n 1 th time step respectively the time step δ t is determined as antuono et al 2012 11 δ t cfl min i h i c 0 h h i c 0 l where cfl is adopted with a relatively large number 1 0 owing to the merit of the rk4 in fact as shown in eq 11 the time step δ t is determined by the density ratio which leads to different values of c 0 l in other words the computational cost is largely controlled by the density ratio in different cases 3 cavity dynamics regarding the classical water entry problems of a wedge a benchmark study 3 1 geometrical layout and numerical parameters before implementing the introduced multi phase sph model with apr scheme to simulate the problems of a wedge penetrating fluid interfaces with different density ratios a strict benchmark study is necessary to verify the numerical accuracy and stability of the utilized numerical scheme actually in practical engineering applications the density ratio at the interface is large around 800 1000 for wave impact and ship slamming problems in ocean engineering extensive experimental data can be found in the literature for such problems hence in this section the experimental and numerical investigation conducted by gong et al 2016 for a wedge penetrating a water air interface is employed as a benchmark to validate the numerical scheme in the laboratory experiment of gong et al 2016 following the procedures suggested by zhao and faltinsen 1993 an iron made wedge with the properties being cross section length w 0 1 m deadrise angle θ 30 and self weight m 3 444 kg was perpendicularly dropped at a vertical distance of h 0 0 2 m above a calm water level we reproduce their experimental conditions herein and the schematic diagram of the numerical implementation is depicted in fig 2 as it can be seen three levels of particle resolution are used around the wedge with the coarsest level 0 w δ r 25 the medium level 1 w δ r 50 and the finest level 2 w δ r 100 the length l of the computational domain is 0 9 m and the height of the air domain h a is 0 4 m to allow enough space for the free surface splashing nevertheless two remarkable differences compared with the laboratory test can be found in fig 2 one of them is that the water depth h b in the following simulations is considered as 0 8 m which is 0 2 m larger than the laboratory test to observe the subsequent cavity evolutions after pinch off and the other one is that the wedge is released with the penetrating velocity u 0 2 g h 0 1 98 m s at the still free surface at the beginning of the simulation i e t g w 0 for the purpose of reducing the computational cost considering that the air effect before the wedge touching the fluid surface is negligible these measures are rational in numerical aspects and exert minimal effects on the physical mechanism of the investigated problem maintaining a good balance between the numerical accuracy and the computational efficiency in the following simulations as outlined by truscott et al 2014 the wedge impacting into the lower layer heavy fluid water with density ρ 1000 kg m 3 surface tension σ 0 07 kg s 2 kinematic viscosity ν 1 0 6 m 2 s 1 is mainly characterized by five non dimensional numbers capillary number ca μ u 0 σ bond number bo ρ g w 2 σ froude number fr u 0 2 g w weber number we ρ u 0 2 w σ and reynolds number r e u 0 w ν where w denotes the characteristic length of the penetrating body and is considered as the width of the wedge in the present work u 0 the penetrating velocity and g the gravitational acceleration the orders of magnitude of these non dimensional numbers are listed in table 1 as reported by duez et al 2007 the critical capillary number for the cavity formation of hydrophobic spheres is at most of the order of o 1 0 2 o 1 0 1 the capillary number in the present study is c a 0 028 this order ensures the occurrence of cavity forming the bond number is always employed to indicate the type of seal event and the deep seal event will occur at bo 1 aristoff and bush 2009 the same as traditional marine hydrodynamics the froude number characterizes the macroscopic behaviors of the cavity in this paper the bond number and froude number are about bo 1 3 1 0 3 and fr 4 0 respectively this combination guarantees the occurrence of a deep seal event during a water entry process aristoff and bush 2009 indeed the wettability wetting angle of solid bodies is also responsible for the cavity formation but this factor is ignored in this paper since the froude number is relatively large fr 4 0 and further the sharp angles on top of the wedge will induce the separation of the flow on the wedge bottom and therefore generates the cavity as for the weber number and the reynolds number the former is often adopted to characterize the cavity breakup and the splash curtain stability and the latter is often related to the jet speeds at the initial impact and therefore can be neglected for the analysis of the later cavity evolution thoroddsen et al 2004 it is also worth noting that the froude number can be recast as fr we bo in other words the cavity dynamics is largely determined by these three parameters it can be observed from table 1 that the following simulations are within the scope of high weber number i e the physical process is dominated by the inertial force instead of the capillary effect as a result the surface tension can be ignored in the following simulations indeed the surface tension could play an important role in the shape of rising bubbles occurring at the latter stage of a water entry process however it is also reasonable to neglect this factor because it only exerts significant effects on small scale rising bubbles ming et al 2017 in the present study the rising bubbles originate from a seal event i e the scale of these bubbles is at the same order of magnitude of the wedge in this regime the surface tension is negligible compared with other environmental forces 3 2 cavity evolutions fig 3 shows a comparison of cavity evolutions between the sph simulations and the experimental snapshots obtained by gong et al 2016 at the beginning of the water entry event see t g w 0 5 a splash curtain is formed on account of the considerable kinetic energy of the moving wedge which is generated from two radial horizontal jets at the first moment of impact meanwhile a cavity occurs at the wake of the wedge owing to the splitting of the free surface followed by the deformation of the splash curtain at t g w 1 0 the wedge continues falling down quickly with the size of the cavity expanding vertically it can be observed that at the early stage of a water entry process the cavity is opening so the air effects can be neglected owing to the absence of cavity collapse this is why the air phase can be ignored in the prediction of slamming pressure at the early stage in such problems zhao and faltinsen 1993 xu et al 2008 but this is not the case when the deadrise angle is very small less than 4 degree in which the air cushioning effects become relevant in addition in order to straightforwardly demonstrate the accuracy of the utilized sph model in fig 4 we depict a comparison of the cavity profile at two typical instants i e at the moment of the pinch off and the generation of the worthington jet respectively it can be observed that the profiles of the cavity and the jet are generally in good agreement with the experimental measurements proving that the sph model possesses satisfactory accuracy for such problems as the simulation time continues increasing the cavity begins to emerge a tendency to collapse caused by the hydrostatic pressure from the liquid bulk see t g w 2 0 and the cavity pinches off at t g w 2 5 eventually it is well known that for a classical water entry process the seal event will create two vertical moving jets that are ejected upwards and downwards respectively at the singularity where the pinch off occurs truscott et al 2014 the upward jet will penetrate the free surface and thus results in the formation of the so called worthington jet antkowiak et al 2007 ogawa et al 2006 and the downward jet will eventually impact the apex of the wedge and thereby split the sealed cavity into two smaller bubbles see t g w 3 0 in fig 3 fig 5 depicts the evolutions of these two jets in detail from which it is demonstrated that the dynamic behaviors of the jets are well captured by the multi phase sph model introduced in section 2 it is worth noting that gong et al 2016 also has numerically investigated the same case via a two phase sph simulation good results were obtained before the downward jet reaching the top surface of the wedge in their simulation whereas the cavity evolutions quickly became less accurate showing disturbances at the multi phase interfaces after the downward jet impacting the wedge one possible explanation is that the accurate capturing of the cavity dynamics in such physical processes requires a high level particle resolution and the absence of arp in their numerical scheme thus leads to the inaccuracy for capturing these complex phenomena moreover in our developed multi phase sph model an additional term ℱ i is added in the momentum equation to guarantee the sharpness of the multi phase interfaces which also contributes to the accuracy of the simulation results indeed in extensive sph simulations corresponding to water entry problems few investigations have been paid to the cavity evolutions after pinch off thanks to the deep computational domain in the present work the cavity dynamics after pinch off can be simulated by the adopted multi phase sph model as displayed in fig 6 after the downward jet slamming the apex of the wedge the sealed cavity is split into two smaller bubbles subsequently these two bubbles are split again caused by rayleigh taylor instability and this secondly splitting leads to two rising bubbles above the wedge as can be seen the appearance of the rising bubbles eventually deforms into the shape of a horseshoe because of the buoyancy effect in addition the time histories of the vertical displacement of the wedge are also plotted in fig 7 as indicated by the comparison the evolutions of the wedge displacement in y axis are in fairly good agreement with the experimental results before pinch off while the numerical results show a slight deviation about 3 3 of the vertical displacement after pinch off one possible reason is that the three dimensional effects and the turbulence effects are neglected in the simulation which could affect the pressure distribution around the wedge and accordingly less predict the vertical displacement of the wedge in spite of that this deviation is acceptable since it is within the scope of 5 from the viewpoint of practical engineering applications 3 3 validation of the performance of the apr incorporating with a phase switch correction as introduced in section 2 the apr is adopted to improve the local accuracy and maintain relatively low computational cost during simulations in addition a phase switch correction is also implemented to improve the performance of the apr for the capturing of the multi phase interfaces which guarantees a smoothing transition and prevents possible non physical particle behaviors when fluid particles pass different resolution levels fig 8 illustrates the local particle patterns concerning the worthington jet generated from the pinch off and the rising bubbles originating from the rayleigh taylor instability of the sealed cavity fig 8 b displays the sharpness of the rising bubbles penetrating the multi resolution interface it can be observed that the sharpness of the rising bubbles is well captured at the finest level it is also indicated that particle resolution plays an important role in capturing the sharpness of the multi phase interfaces in the multi phase sph simulation performed by gong et al 2016 the isotropic particle spacing is about w δ r 61 for the whole computational domain and the total number of particles is about 400 000 in their works however in the present study the particle spacing around the wedge i e the finest level is refined into w δ r 100 whereas the total number of particles is only about 247 500 in other words thanks to the merit of the apr the water entry process is more accurately simulated by employing less fluid particles there is no doubt that if the particle spacing is changed from w δ r 61 to w δ r 100 without applying the apr the total number of particles will increase to an order o 1 0 7 of magnitude it is demonstrated that apr is essential for such problems since the deployment of this numerical format keeps a good balance between numerical accuracy and computational efficiency as for the worthington jet shown in fig 8 a the appearance of the worthington jet keeps its shape and sharpness at different resolution levels and the tip of the worthington jet is also well captured by our proposed multi phase sph model as reported by sun et al 2019b in a simulation of dam breaking flows slamming an elastic plate if the apr is implemented without adopting the phases switch correction the tips of a water tongue could be reflected from the multi resolution interfaces with the velocity of the water particles inheriting from the surrounding gas particles in terms of the worthington jet the same behaviors may occur when it penetrates the multi resolution interface in the absence of a phase switch correction it is demonstrated from the previous investigation and the present work that for the developed multi phase sph model the apr works as desire only by incorporating with the phase switch correction to prevent possible non physical particle behaviors on the whole the proposed multi phase sph model in combination with the apr incorporating with the phase switch correction possesses satisfactory accurate and robust performance in such problems and can be treated as a reliable approach for further studies in the following section the same physical processes extending to different density ratios will be also simulated and discussed in detail 4 cavity dynamics with different density ratios marston et al 2016 have experimental investigated the canonical problem of the crown splash and sealing phenomena during the impact of spheres onto a calm water surface in their test conditions the ambient pressure was from atmospheric pressure down to 1 16 of an atmosphere by employing a vacuum chamber one striking conclusion derived from the sophisticated experiment is that the ambient pressure exerts significant effects on the timescale of the sealing process of a crown splash moreover it is also demonstrated that the lower ambient pressure is the longer sealing time requires in a laboratory test the ambient pressure is uncomplicated to reduce by a vacuum chamber while it is difficult to increase from atmospheric pressure to hundreds or even thousands of times of an atmosphere as a result marston et al 2016 have only investigated the cases in which the density ratio is larger than 1000 one important motivation of this section is to investigate the cases with density ratio lower than 1000 which is easy to realize by numerical simulations as discussed in section 3 it can be found that the five non dimensional numbers are independent of the density ratio namely the multi phase sph model introduced in section 2 is also suitable for different density ratios conditions although the time step will be largely affected and accordingly influences the computational cost in each case the geometrical layout of the simulations shown in this section is the same as that in section 3 see also fig 2 in the following discussions we defined a non dimensional coefficient regarding the pinch off depth d to compare the characteristics of cavity dynamics between different density ratios as illustrated in fig 9 d is defined as d h b h p with h p being the distance between the apex of the wedge to the bottom of the computational domain at the moment of pinch off table 2 lists the extracted values of h p and d corresponding to different density ratios 4 1 cavity evolutions as reported by marston et al 2016 the timescale of a seal event is approximately inversely proportional to the ambient pressure nevertheless it must be highlighted that the froude number in their experiment is considerably large f r 2 1 0 3 namely the splash curtain is always sealed by dome over in the different cases of their investigation nevertheless in the present work the froude number for each case is significantly smaller than in their experiment in fact based on our sph simulations it is found that the cavity sealing in this regime is actually governed by two factors i e dome over or pinch off depending largely on the density ratio in other words the distinctions of cavity dynamics with different density ratios at the fluid interface can be characterized by the profile of the worthington jet and the evolution of the sealed cavity therefore this subsection will investigate the cavity dynamics with different density ratios from these perspectives according to the characteristics of the free surface deformations and cavity evolutions in this paper we defined the cases with 25 ρ h ρ l 1000 as high density ratios hdrs 5 ρ h ρ l 25 as medium density ratios mdrs and ρ h ρ l 5 as low density ratios ldrs figs 10 and 11 illustrate the snapshots of worthington jets at t g w 3 7 and rising bubbles at t g w 4 7 with regard to different density ratios respectively fig 12 shows that comparison of the initial jets corresponding to different typical density ratios because the cases with density ratio larger than 10 share very similar characteristics of the initial jets we choose ρ h ρ l 10 as the representative one figs 13 21 display the cavity evolutions during the whole simulation processes with different typical density ratios ranging from 1 25 to 100 ρ h ρ l 1000 is not shown because it is already displayed in figs 3 6 4 1 1 high density ratios 25 ρ h ρ l 1000 it can be seen from figs 3 6 and 13 14 that in hdrs the cavity evolutions are almost identical these physical processes are already elaborated in section 3 as outlined by aristoff and bush 2009 the cavity evolution can be categorized into four types of seal events quasi static seal deep seal shallow seal and surface seal the deep seal is characterized by the first pinch off occurring at the location where it is one third to one half of the distance between the body and the undisturbed water level according to this definition confirmed by table 2 the sealing behaviors in these cases show typical characteristics of the deep seal because the pinch off locations are about one half distance between the apex of the wedge and the still water level as for the pinch off time it is also almost identical for ρ h ρ l 1000 and ρ h ρ l 100 while a slight increase can be found in ρ h ρ l 50 it can be seen from figs 10 b and 10 c that although the density ratio decreases to 100 or even 50 the worthington jets keep their typical characteristics in ρ h ρ l 100 and ρ h ρ l 50 i e perpendicularly penetrating the free surface with a slim conical profile in terms of the rising bubbles as illustrated in figs 11 b and 11 c in this regime the splitting of the sealed cavity remains its approximately regular and symmetrical characteristics described above it is demonstrated that the density ratio exerts negligible effects on the cavity dynamic when 25 ρ h ρ l 1000 4 1 2 medium density ratios 5 ρ h ρ l 25 although the cavity dynamics is almost unaffected by the density ratio in hdrs it begins to be significantly altered when the density ratio decreases to 25 as indicated in fig 15 at the initial stage of impact a splash curtain is generated owing to the perpendicular slamming of the wedge and the cavity accordingly begins to form this phenomenon is the same as the cases with hdrs despite these similarities some different striking features can be found in ρ h ρ l 25 at the subsequent stage firstly the tips of the splash curtain are quickly attracted towards the central line of the wedge after the impact and the splash curtain subsequently domes over at t g w 2 2 before pinch off this phenomenon is absent in terms of hdrs shortly after pinch off the second remarkable difference can be observed that the resulting worthington jet is dramatically disturbed and thereby no longer penetrates the free surface in a perpendicular trajectory tilting to one side this instability causes the breaking of the worthington jet which leads to the scattered droplets above the free surface as depicted in fig 10 d the final difference can be found in the subsequent splitting of the sealed cavity in hdrs the sealed cavity will be split into two bubbles due to the action of the downward jet before long these two bubbles continue to be split into four smaller bubbles owing to rayleigh taylor instability the newly generated bubbles separated from the two larger bubbles are approximately symmetrical and eventually rise towards the free surface see also figs 11 a 11 c nevertheless in ρ h ρ l 25 the rising bubbles generated from the splitting of the sealed cavity show strong asymmetry i e the rising bubbles are no longer characterized by a pair of horseshoes see also fig 11 d the aforementioned characteristics in ρ h ρ l 25 can be more clearly observed in the remainder of mdrs as illustrated in figs 16 18 in these cases the dome over of the splash curtains are even earlier at t g w 1 2 than that of ρ h ρ l 25 it is interesting that the subsequent collapse after dome over loses its symmetry in total on account of the generation of the splashing jets stemming from the impact of water curtains as the simulation time increases continuously the cavity eventually pinches off between t g w 2 7 3 2 in the remainder of mdrs although the cavity evolutions are basically the same as ρ h ρ l 25 before pinch off one pronounced feature can be observed that instead of generating two rising bubbles the sealed cavity is divided into a large bubble attaching the wedge with a small bubble rising towards the free surface as illustrated in figs 11 e 11 g the smaller bubbles spirally rise upwardly whereas the larger bubble continues falling down with the wedge 4 1 3 low density ratios ρ h ρ l 5 when the density ratio decreases to 5 two pronounced features can be observed in this regime it can be observed from fig 12 that the thickness of the initial jets is obviously enlarged compared with the pre discussed cases on the contrary the behaviors of the initial jets in hdrs and mdrs are almost identical characterized by slender and sharp profiles with the breaking of tips into droplets however in ρ h ρ l 5 the most remarkable difference is that the tip of the initial jet is obviously more rounded than the cases with higher density ratios moreover the number of droplets is less due to the higher stability of the impact jet another pronounced feature is that after pinch off the worthington jet is no longer in a conical profile which can be attributed to the fact that in this case the cavity is sealed by the dome over instead of the pinch off as can be seen from figs 19 e 19 g before the occurrence of the pinch off the free surface is already disturbed considerably by the breaking of initial jets and thereby the subsequent worthington jet will be consequently affected after being ejected from the pinch off location if the density ratio further decreases to 2 5 or lower as depicted in figs 20 and 21 the cavity will be completely sealed by the flow with considerable density above the water surface i e becoming dome over instead of pinch off that is to say that the pinch off event disappears in ρ h ρ l 2 5 and ρ h ρ l 1 25 from the viewpoint of the traditional definition regarding the pinch off behavior see also figs 10 i and 10 j it is interesting that in ρ h ρ l 1 25 see also fig 21 the tip of the jets generated from the initial slamming draws an elegant pattern in a spiral path which eventually results in the two smaller bubbles inside the sealed cavity as for the jets generated at the initial impact it can be observed from fig 12 that the flow characteristics are significantly different at the initial stage being altered by the very low density ratio the most evident feature is that the water phase is detached from the surface of the wedge due to the air cushioning effects by the upper layer fluid which is not discharged in such a short time this behavior is aggravated in the lowest density ratio in addition to the air cushioning effects the impact induced jets seem to be more rounded than that in ρ h ρ l 5 as marked by the dashed circle in fig 12 furthermore it also can be found that the cavity evolutions seem to be more stable and regular in ldrs compared with mdrs in general the cavity evolutions are exactly affected by the density ratio from the initial stage to the subsequent cavity forming and cavity splitting stages indeed the phenomena of pressure drop exhibit in the initial cavity due to the energy transfer from the wedge to the upper layer fluid in other words due to these fsis the cavity dynamics in such physical processes can be also elucidated from another viewpoint i e the motion characteristics of the wedge to this end in the next subsection the time histories of the velocities and displacements of the wedge with different density ratios will be discussed in detail 4 2 motion characteristics of the wedge 4 2 1 vertical motion figs 22 and 23 depict the motion characteristics of the wedge in y direction as shown in fig 22 the variations of the vertical velocity of the wedge can be divided into three stages at the initial stage of the impact i e stage 1 see also fig 22 b the velocity reduction of the wedge increases as the density ratio decreases especially for ldrs the main explanation is that at stage 1 the acceleration of the light phase is induced by the vertical movement of the wedge which leads to continuous energy consumption and consequently the wedge decelerates rapidly in this process the kinematic energy of the wedge transfers to that of the light fluid in this circumstance lower density ratios will dissipate more kinetic energy from the wedge due to larger added mass however this phenomenon is totally reversed between t g w 1 2 2 4 i e stage 2 it can be seen from fig 22 c that in this range the lower the density ratio the greater the vertical velocity which can be also explained from the viewpoint of energy conservation fig 24 displays the jet shapes of five typical density ratios at the beginning of stage 2 i e t g w 1 2 it can be observed that as the density ratio decreases the impact jets are gradually bent towards the central line of the wedge avoiding being significantly raised up implying that less kinetic energy of the wedge is transferred to the potential energy of the heavy fluid therefore at stage 2 the magnitude of the wedge s velocity of lower density ratios is larger than that of higher density ratios which is opposite to the phenomenon at stage 1 finally at the last stage i e stage 3 it can be found from fig 22 d that lower density ratios are in favor of maintaining the higher vertical velocity of the wedge in fact it can be observed from figs 11 b 11 j that the sealed cavity tightly attaches to the apex of the wedge after pinch off as a consequence the wedge continues falling with the large bubble in this sense the bubble with lower density ratios has a larger mass and therefore provides more propulsive effects on the wedge accordingly the ending vertical velocity in lower density ratios keeps a relatively higher magnitude however we note that when the density ratio is larger the phenomenon is more complex since the variation of the vertical velocity of the wedge with respect to the density ratio seems to lose its regularity see also fig 22 d one possible explanation could be that after pinch off the cavity evolutions show extreme complexity in mdrs see also fig 11 in this regime the pressure distribution surrounding the wedge becomes quite complicated which could result in the variation of the wedge s vertical velocity in addition to that the changing of the bubble mass associated with the moving wedge is negligible when the density ratio becomes higher and therefore the velocity differences among higher density ratios are much smaller the variation of the wedge s displacement is tightly linked to the variation of the wedge velocity from fig 23 a it can be found that the vertical displacement before stage 2 increases as the density ratio increases while at stage 3 the wedge in ldrs possesses a larger displacement 4 2 2 horizontal motion fig 25 depicts the time histories of the motion characteristics of the wedge in x direction for different density ratios including both horizontal velocity and displacement as displayed in figs 25 a and 25 b at the beginning of the impact the velocity in x direction with different density ratios is almost zero and hence the displacement is zero too which can be explained by the symmetry of the initial cavity as observed from figs 13 21 before t g w 1 2 the cavities are almost symmetrical i e the pressure distribution around the wedge surface is balanced in x direction and therefore the horizontal net force acting on the wedge approximately equals to zero however as shown in fig 25 there are two instants after which the horizontal velocity of the wedge starts to deviate from zero the first instant is t g w 1 2 after which the wedge s horizontal velocity of the cases of ρ h ρ l 5 and 10 begins to deviate as the simulation time increases this phenomenon could be attributed to the fact that in these two cases when the cavity is sealed due to the dome over event the cavity shape suddenly becomes asymmetrical while in the cases with other density ratios the asymmetry is induced much later see also figs 19 21 the second instant is t g w 4 0 after which the horizontal velocities of ρ h ρ l 2 5 15 and 20 show obvious deviation this is caused by the oblique impact of the downward jet as shown in figs 16 i 17 i and 20 i where the jets show obvious asymmetrical trajectories and consequently result in the deviation of horizontal velocity however in hdrs the downward jet still maintains vertical direction see also figs 6 b 13 i and 14 i which exerts negligible effects on the variation of the horizontal velocity and displacement 5 conclusions and future works in this paper a multi phase sph model with apr is applied to investigate the problem associated with a wedge penetrating fluid interfaces characterized by different density ratios a numerical benchmark with regard to the water entry of a wedge is firstly simulated to verify the accuracy and stability of the presented sph model it is demonstrated that both the cavity evolutions during penetrating and the motion characteristics of the wedge are accurately simulated by the utilized sph model a pronounced advantage of the implemented multi phase sph model is the deployment of the apr incorporating with a phase switch correction therefore with fewer overall particles the accuracy of an sph simulation can be greatly improved in the local regions where the particle resolution is refined in addition to the validation study the cavity dynamics of the water entry of a wedge for different density ratios is also investigated and discussed in detail it is found that the discrepancies of the cavity dynamics between different density ratios are mainly reflected by three factors i e the initial impact jets the worthington jet causing by a pinch off event and the evolutions of the sealed cavity in terms of the initial jets it is shown that the impact jets share the same characteristics when the density ratio is below 10 i e the heavy fluid attaches tightly along the deadrise surface of the wedge with the thin jet tips breaking into droplets nevertheless in ldrs the heavy fluid begins to detach from the wall boundaries and the impact jets become more rounded than those in hdrs and mdrs as for the worthington jet it is clearly demonstrated that in hdrs the worthington jet shows typical characteristics as reported in extensive literature i e it is ejected from the pinch off location and then penetrates the free surface perpendicularly nevertheless as the density ratio decreases from hdrs to mdrs the worthington jet is evidently disturbed and consequently distorted downwards in a random direction which results in the breaking of the worthington jet into droplets however it is interesting that the worthington jet is absent in ldrs because in this regime the cavity is totally sealed by the dome over behavior instead of the pinch off event regarding the evolutions of the sealed cavity the most striking feature is that the generation and scale of the rising bubbles split from the sealed cavity are largely controlled by the density ratio in hdrs the rising bubbles are approximately symmetrical and gradually alter their shapes into a horseshoe during moving towards the free surface nonetheless in mdrs the rising bubbles gradually lose their symmetry as the density ratio decreases showing more instabilities and irregularities as for ldrs the chaos seems to be alleviated apparently and the shape of the bubbles behind the wedge recover its symmetry to a large extent finally it is also found that the motion characteristics of the wedge are tightly related to the cavity evolutions to a large extent generally in hdrs and ldrs the motion of the wedge is more stable and predictable because the cavity evolutions are approximately symmetrical whereas in mdrs the motion of the wedge shows obvious complexity and instability because of the strong nonlinearity of the cavity evolutions in the future the utilized multi phase sph model with apr can be further improved to a more advanced version which is expected to be capable of capturing cavitation effects for those water entry problems characterized by high speed or ultra high speed relevant studies are still ongoing credit authorship contribution statement hong guan lyu formal analysis validation investigation visualization writing original draft rui deng supervision project administration peng nan sun conceptualization methodology software resources data curation funding acquisition writing review editing jian ming miao supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by national natural science foundation of china grant nos 12002404 51679053 guangzhou basic and applied basic research project grant no 202102020371 project of research and development plan in key areas of guangdong province grant no 2020b1111010002 key laboratory of ministry of education for coastal disaster and protection hohai university grant no d202004 the open fund of state key laboratory of coastal and offshore engineering dalian university of technology with grant no lp2017 and natural science foundation of guangdong province of china grant no 2019a1515011405 
20279,the bubble motion in the shallow water environment has significant applications in underwater explosion and seabed exploration where the bubble characteristics are mainly associated with the two types of stand off distance parameters γ f and γ s the parameters are defined in section 2 3 based on the assumption that the liquid is inviscid and incompressible the influences of γ f and γ s on the coupling characteristics between the bubble and the free surface in the shallow water environment are solved by the euler equations with the finite volume method and the bubble surface and the free surface are tracked by the front tracking method for the case γ s 0 8 i the water spike always keeps rising during the bubble expansion and contraction when γ f 1 25 ii the water spike velocity increases with the decrease of γ f and the maximum bubble jet velocity is generated when γ f 0 8 iii the bubble top elongated is no longer obvious when γ f 1 5 for the case γ f 0 6 i the toroidal bubble is split into two sub toroidal bubbles when γ s 0 6 and γ s 1 1 ii the water spike velocity and the step pressure decrease with the increase of γ s keywords bubble free surface shallow water environment finite volume method front tracking method 1 introduction bubble characteristics in a shallow water environment have significant applications in ocean engineering field such as underwater explosion in a shallow water environment and seabed exploration in a shallow water environment zhang et al 2016 2021 in the shallow water environment the bubble characteristics are different from the bubble characteristics only near the free surface or seabed which will be affected together by the free surface and the seabed there are two types of stand off distance parameters to decide the bubble characteristics in the shallow environment one is the parameter γ f characterizing the dimensionless distance between the bubble and the free surface and another is the parameter γ s characterizing the distance between the bubble and the solid wall until now the bubble characteristics only near the free surface or seabed have been studied in great detail by many researchers and some meaningful results have also been obtained but the bubble characteristics in the shallow environment affected together by the free surface and the seabed are not completely clear therefore understanding the bubble characteristics near both the free surface and the seabed is of great significance for underwater explosion and seabed exploration in the shallow water environment the bubble will be asymmetrical in the collapse process when located in the vicinity of a free surface meanwhile a water spike directed away from the bubble and a liquid jet directed away from the free surface also will be produced simultaneously the interaction between the bubble and the free surface had been deeply studied by many researchers through various ways in the beginning the growth and collapse of a bubble in close proximity to an initially plane free surface were simulated using the boundary integral method by blake et al 1987 2015 blake and gibson 1981 and the kelvin impulse was used to determine the migratory behaviour of the collapsing bubble subsequently the boundary integral method was improved in aspects of the singular integrals the time step size the nonuniform boundary elements and the vortex ring model which was applied in the simulation of the nonlinear evolution of the toroidal bubble and free surface liu et al 2017b liu et al 2017c wang et al 1996a b wang et al 2015 besides based on the two phase flow solver the volume of fluid method was employed for capturing the bubble surface and the free surface koukouvinis et al 2016 li et al 2019b phan et al 2020 tian et al 2018 where the complex phenomena including the splitting bursting breaking and re closure of the bubble near the free surface were simulated recently based on the finite volume method the phenomena such as the inward jet formed inside the toroidal bubble the toroidal bubble split and the water skirt with different γ f were analyzed by liu et al 2020 using a front tracking method coupled with an extrapolation technique in the experiments the key feature of the collapse bubble and the six distinctive patterns of the free surface motion at different γ f were analyzed by zhang et al 2016 using a high voltage spark generator in general many key characteristics of the bubble near the free surface at different γ f had been basically obtained using the numerical simulation and experiments the bubble near the solid wall has different characteristics from those near the free surface in the collapse stage owing to the attraction of the solid wall a liquid jet directed towards the solid wall will be produced which is usually considered to be one of the main factors of structure eroded by the cavitation bubble therefore the bubble characteristics near the solid wall had always been an important research topic for many researchers the bubble behaviors such as growing collapsing and jet formation near a solid wall for different stand off parameter γ s were investigated numerically by the boundary integral method li et al 2016 zhang et al 2015 2017 zhang and zhang 2004 in more complex boundaries such as a convex plate with and without a hole a corner a moveable sandwich structure etc gan et al 2021 gong et al 2018 jin et al 2018 2019 2019 li et al 2019a liu et al 2018 moloudi et al 2019 tagawa and peters 2018 wang et al 2018 2020 zhang et al 2021 the various bubble motions were analyzed with the help of the open source software package openfoam the bubble expanding and collapsing in the vicinity of the solid boundary and resilient metal surface was studied in dependence on the stand off parameter γ s by numerically solving the navier stokes equations koch et al 2016 lechner et al 2019 2020 sagar and el moctar 2020 based on the finite volume method the bubble motions near a solid wall in a inviscid liquid a viscous liquid and a hypergravity environment were simulated using the front tracking method liu et al 2017a 2021 popinet and zaleski 2002 and some phenomena such as the toroidal bubble split into two sub toroidal bubbles and two pressure peaks produced were studied in order to simulate the bubble characteristics at different stages well some hybrid algorithms fully using the advantages of various algorithms were applied to simulate the entire process of the underwater explosion near the solid wall in the hybrid algorithms the smoothed particle hydrodynamics method and the discontinuous galerkin method were usually used to simulate the charge detonation and shock wave and the boundary element method was used to model the bubble motion wang et al 2016 zhang et al 2019 in the experiments the spark generated bubble the laser induced bubble and the underwater explosion bubble near the solid wall were also extensively studied where some characteristics of the bubble such as the deformation the shock wave and the liquid jet pressure were obtained using the high speed photography system and the pressure transducer cui et al 2016 yingyu et al 2020 zhang et al 2020 generally the most of characteristics of the bubble near the solid wall had been revealed the bubble in the shallow water environment will be affected together by the free surface and the solid wall so the bubble characteristics in the shallow water environment depend on both the stand off parameter γ f and the stand off parameter γ s which will be more complex than those only near the free surface or the solid wall some relevant work had been done by some researchers using the experiments the temporal evolution of the spark generated bubble shape and the free surface motion were analyzed by huang et al 2020 and zhang et al 2013 using the high speed photography and some intriguing phenomena such as bubble split water skirt and double jets were observed based on the beam deflection probe the prolongation of oscillation times near a rigid boundary as well as the shortening of the oscillation times near a free surface was measured by gregorčič et al 2007 in the experiments the bubble shape and the free surface motion are easily obtained however due to the limitation of experimental measurement methods other characteristics such as jet velocity jet pressure splash jet sideway jet and internal shape of toroidal bubble are difficult to obtain the numerical simulation is a useful research method to make up for the deficiency of the experiment who can easily obtain the results in liquid that the experiment is difficult to measure in the numerical methods the finite volume method has advantage in liquid conservation and the front tracking method can track the bubble surface and free surface well so in this paper the finite volume method with the front tracking method is used to study the bubble motion between the free surface and the solid wall in order to obtain the bubble characteristics with different stand off parameters γ f and γ s in the shallow water environment 2 numerical model 2 1 the govern equations for liquid the bubble motion between free surface and solid wall with no elasticity is a common two phase flow problem where the gas and the liquid are separated by the bubble surface and the free surface in this paper the pressure in the gas region the gas inside the bubble and the gas above the free surface is not solved using the govern equations which is directly denoted by the state equation of ideal gas and the bubble size in the present work is relatively large and the liquid velocity induced by the bubble is smaller than the sound velocity so the viscosity and compressibility of the liquid are not taken into account li et al 2016 liu et al 2017c zhang et al 2018 at the initial time the relative position of bubble free surface and solid wall with no elasticity with axisymmetric coordinate system is shown in fig 1 base on those assumptions the liquid govern equations can be denoted by the euler equations in the axisymmetric configuration 1a 1 r ρ r u r ρ v z 0 1b ρ u t 1 r r ρ u 2 z ρ u v z p r 1c ρ v t 1 r r ρ u v r ρ v 2 z p z ρ g z where r is the coordinate in the radial direction z is the coordinate in the vertical direction ρ is the density u is the radial velocity v is the vertical velocity p is the pressure g z is the vertical gravitational acceleration 2 2 the state equation for gas and boundary conditions for the gas region above the free surface the volume of the gas above the free surface will not change significantly with the motion of the free surface so the gas pressure above the free surface is assumed to be a constant for the gas region inside the bubble the gas pressure is associated with the bubble volume it is assumed that the pressure is uniformly distributed and the gas system is adiabatic so the state equation of ideal gas inside the bubble can be expressed as li et al 2016 liu et al 2017c wang et al 1996b 2 p b p v p 0 v 0 v ϑ where p b is the pressure inside the bubble when the bubble volume is v p 0 is the non condensable gas pressure at the initial bubble volume v 0 p v is the vapor pressure and ϑ is the ratio of specific heats the pressure in the gas region is not solved using the govern equations so the pressure in the gas region is used as the pressure boundary condition of the liquid region the pressure acting on the free surface and the bubble surface is expressed as 3 p l p a σ κ free surface p v p 0 v 0 v ϑ σ κ bubble surface where p l is the pressure at the free surface or the bubble surface on the liquid side p a is the atmospheric pressure σ is the surface tension coefficient and κ is the surface curvature liu et al 2017a if the surface size is large the effect of the surface tension on the surface motion can be neglected for other boundaries of the liquid region the axisymmetric boundary condition is set at the symmetric axis z and the normal velocity is set to zero at the bottom and side boundaries 2 3 dimensionless parameters choose some basic characteristic quantities to nondimensionalize the calculated results the displacement and length are scaled with respect to the maximum bubble radius r m the pressure is scaled with respect to the atmospheric pressure p a the velocity is scaled with respect to p a ρ and the time is scaled with respect to r m ρ p a blake et al 1987 liu et al 2017c wang et al 1996a based on those basic characteristic quantities some dimensionless parameters are defined as follows 1 the dimensionless initial bubble radius r 0 r i r m 2 the buoyancy parameter δ ρ g z r m p a 3 the strength parameter ε p 0 p a 4 the stand off distance parameter for free surface γ f d f r m 5 the stand off distance parameter for solid wall γ s d s r m where r i denotes the initial bubble radius p 0 denotes the initial pressure inside the bubble d f denotes the initial distance between the bubble and the free surface and d s denotes the initial distance between the bubble and the solid wall as shown in fig 1 2 4 discrete form for govern equations the computational domain is divided into many same square cells in order to distinguish the position of gas liquid and interface the square cells are divided into three types the cell that only contains the air is defined as the air cell a the cell that only contains the liquid is defined as the liquid cell l and the cell that contains the bubble surface or the free surface is defined as the surface cell s the different cell types are shown in fig 2 based on the staggered grid in fig 2 the euler equations are discretized by the finite volume method fvm the discretization processes of the euler equations in the liquid cell can be treated as a special case in the surface cell so only the discretization processes of the euler equations in the surface cell are given in our study the explicit projection method is adopted to solve the momentum equations in which the unknown pressure terms in the momentum equations are not considered at first step so based on the gauss theorem the intermediate velocity u i 1 2 j and v i j 1 2 can be expressed as liu et al 2017a popinet and zaleski 2002 4a u i 1 2 j u i 1 2 j n δ t υ i 1 2 j ω i 1 2 j s i 1 2 j r u n u n d z ω i 1 2 j s i 1 2 j r u n v n d r s i 1 2 j r p l n d z s i 1 2 j r u n u n d z s i 1 2 j r u n v n d r 4b v i j 1 2 v i j 1 2 n δ t υ i j 1 2 ω i j 1 2 r δ 2 d r d z ω i j 1 2 s i j 1 2 r u n v n d z ω i j 1 2 s i j 1 2 r v n v n d r s i j 1 2 r p l n d r s i j 1 2 r u n v n d z s i j 1 2 r v n v n d r where subscript i i 1 2 j and j 1 2 denote the position of pressure and velocity as shown in fig 2 δ t denotes the time step and the superscript n denotes the value of pressure and velocity at the time n δ t ω i 1 2 j and ω i j 1 2 denote the control volumes of momentum equations in the direction r and z respectively and their boundaries are denoted by ω i 1 2 j and ω i j 1 2 respectively s i 1 2 j and s i j 1 2 denote the bubble surface or the free surface in the control volume ω i 1 2 j and ω i j 1 2 respectively p l denotes the pressure that acts on the free surface or the bubble surface υ i 1 2 j and υ i j 1 2 denote ω i 1 2 j r d r d z and ω i j 1 2 r d r d z respectively the velocity at the bubble surface and the free surface in eq 4 is unknown which can be obtained by the surrounding velocity using the linear interpolation method in the process of obtaining the velocity at the bubble surface and the free surface some surrounding velocities are located in the gas region the values of which are obtained from the velocities located in the liquid region using the least square extrapolation method liu et al 2017a here five velocity nodes located in the liquid region are used in the square extrapolation method after the intermediate velocities u i 1 2 j and v i j 1 2 in eq 4 are computed the velocities u i 1 2 j n 1 and v i j 1 2 n 1 at time n 1 δ t with the unknown pressure terms can be written as liu et al 2017a popinet and zaleski 2002 5a u i 1 2 j n 1 u i 1 2 j f i 1 2 j n 5b v i j 1 2 n 1 v i j 1 2 f i j 1 2 n where f i 1 2 j n δ t υ i 1 2 j ω i 1 2 j s i 1 2 j r p d z ω i 1 2 j p d r d z f i j 1 2 n δ t υ i j 1 2 ω i j 1 2 s i j 1 2 r p d r the velocities u i 1 2 j n 1 and v i j 1 2 n 1 in eq 5 should satisfy the continuity equation so the velocities in eq 1a should be replaced by the velocities u i 1 2 j n 1 and v i j 1 2 n 1 in eq 5 based on the gauss theorem the final form of the continuity equation can be written as liu et al 2017a popinet and zaleski 2002 6 f i j 1 2 f i j 1 2 n f i j 1 2 f i j 1 2 n f i 1 2 j f i 1 2 j n f i 1 2 j f i 1 2 j n f i j 1 2 v i j 1 2 f i j 1 2 v i j 1 2 f i 1 2 j u i 1 2 j f i 1 2 j u i 1 2 j where f i 1 2 j i 1 2 j r d z 1 r i 1 2 r i 1 2 s i j r r i 1 2 r d z f i 1 2 j i 1 2 j r d z 1 r i 1 2 r i 1 2 s i j r r i 1 2 r d z f i j 1 2 i j 1 2 r d r 1 z j 1 2 z j 1 2 s i j r z j 1 2 z d r f i j 1 2 i j 1 2 r d r 1 z j 1 2 z j 1 2 s i j r z j 1 2 z d r after the euler equations in the all surface cells and liquid cells are discretized into the form of eq 6 the n n linear equations for the unknown pressure are formed with the boundary conditions the n n linear equations are solved using the gauss seidel relaxation solver popinet and zaleski 2002 after the unknown pressure in the n n linear equations is solved the velocities u n 1 and v n 1 can be obtained by eq 5 2 5 tracking the surface after the velocities u n 1 and v n 1 in eq 5 are obtained the new positions of the bubble surface and the free surface need to be computed here a front tracking method is used to update the motions of the bubble surface and the free surface it is assumed that the bubble surface and the free surface consist of a series of particles so the motions of the bubble surface and the free surface can be realized by moving each particle the velocity of the particle is computed by the bilinear interpolation method with the surrounding velocities liu et al 2017a popinet and zaleski 1999 after the velocity of the particle is obtained the position of the particle at next time is obtained using the first order forward difference method liu et al 2017a popinet and zaleski 1999 7 r z s n 1 r z s n δ t u v s n with the motions of the bubble surface and the free surface the distance between the particles will change evidently in some local region which will affect the accuracy of the surface motion in order to solve this problem a cubic splines method is used to ensure the uniform distribution of the particles along the bubble surface and the free surface popinet and zaleski 1999 when the liquid jet penetrates the bubble or the bubble is split into multiple sub bubbles the bubble surface at some regions will collide with each other the bubble surface at the collision region should be cut and reconnected and the detailed method to cut and reconnect the bubble surface at the collision region can refer to the relevant literatures liu et al 2017a 3 validation of numerical model 3 1 convergence analysis the mesh number in the computational domain has an important influence on the motions of bubble and free surface so the convergence analysis for the mesh number in the computational domain should be conducted the size of the computational domain is set as 30 r m liu et al 2017a the dimensionless initial bubble radius r 0 0 2848 the buoyancy parameter δ 0 052 the strength parameter ε 21 24 the stand off distance parameter for free surface γ f 0 8 in order to analyze conveniently the center point of solid wall the axisymmetric point of water spike the top point of bubble and the bottom point of bubble are marked in fig 3 the convergence analysis for the bubble surface and the free surface at different mesh number is shown in fig 4 where the shapes of the bubble surface and the free surface at time 0 6 and 1 2 are given when the mesh number is set as 1026 1026 and 2050 2050 the shapes of the bubble surface and the free surface at two mesh numbers are in good agreement with each other besides the convergence analysis for the height of water spike the top point of bubble and the bottom point of bubble for different mesh number at different time are also conducted as shown in fig 5 evidently the height of water spike the top point of bubble and the bottom point of bubble for mesh number 1026 1026 and 2050 2050 also coincide based on the convergence analysis the computational results are almost convergent when the mesh number in the computational domain is set as 1026 1026 so the mesh number in the computational domain is chosen as 1026 1026 3 2 comparison with experiment after the convergence analysis for the computational results at different mesh number in the computational domain is accomplished the accuracy of the numerical method also should be validated a spark generated experiment for the bubble motion near a free surface is used to validate the accuracy of the numerical method in the spark generated experiment the maximum bubble radius r m 28 09 mm the bubble period t b 4 51 ms and the stand off distance parameter for free surface γ f 0 66 based on the maximum bubble radius and the bubble period the initial bubble radius and the initial pressure inside the bubble can be estimated using the rayleigh plesset equation by calculating the dimensionless initial bubble radius r 0 0 2848 and the strength parameter ε 21 24 which is consistent with the initial parameters for the convergence analysis in section iii a in fig 6 the comparison of the numerical results with the spark generated bubble experiment is conducted fig 6 a 6 c show the formation and development of the bubble jet and water spike fig 6 d shows the bubble jet penetrating the bottom surface of the bubble fig 6 e shows that the sideway jet is about to penetrate the toroidal bubble from the sides fig 6 f shows that the toroidal bubble is split into two sub toroidal bubbles by the sideway jet meanwhile the comparison for the height of water spike between the numerical results and the experiment is also displayed in fig 7 through the comparison the bubble motion and the free surface motion in numerical results are in good agreement with the experimental results so the numerical method in the present study can simulate the coupling characteristics between the bubble and the free surface well 4 numerical results and discussion the coupling characteristics between the bubble and the free surface in the shallow water environment are significantly associated with the stand off distance parameters γ f and γ s so the influences of γ f and γ s on the coupling characteristics between the bubble and the free surface in the shallow water environment are analyzed in section 4 1 and 4 2 respectively the initial conditions for the bubble are set as the initial bubble radius r 0 0 1818 the strength parameter ε 74 16 and the buoyancy parameter δ 0 163 when the influence of γ f on the coupling characteristics between the bubble and the free surface is studied in section 4 1 γ s is set as 0 8 and when the influence of γ s on the coupling characteristics between the bubble and the free surface is studied in section 4 2 γ f is set as 0 6 4 1 the interaction between bubble and free surface under different γ f in fig 8 the coupling characteristics between free surface and bubble at different times when γ f 0 7 where the contours in left represent vertical velocity the contours in right represent pressure and the arrow represents velocity vector at the beginning the pressure inside the bubble is much greater than the pressure at infinity the pressure at infinity in the shallow water environment can be approximately regarded as the atmospheric pressure p a so the bubble expands with an acceleration as shown in fig 8 a and b with the bubble expansion the pressure inside the bubble decreases gradually when the pressure inside the bubble is less than the pressure at infinity the bubble expands with a deceleration as shown in fig 8 c and d meanwhile a large portion of the bubble is elongated along the vertical direction and the bubble top is entrained into the bottom of the raised free surface subsequently owing to the impact of water flow from the sides a high pressure stagnation point is formed in the narrow area between the free surface and the bubble owing to the high pressure area the incoming flow is redirected upward to form the water spike and downward to form the liquid jet as shown in fig 8 e after the bubble reaches its maximum volume the bubble begins to shrink and the liquid jet becomes wider gradually during the downward development as shown in fig 8 f after the liquid jet penetrates the bubble a toroidal bubble is formed when the liquid jet impacts on the solid wall a high pressure area on the solid is produced as shown in fig 8 g soon afterwards the liquid jet is divided into splash flow and radial flow after impacts on the solid wall and the splash flow directly moves toward the toroidal bubble interior as shown in fig 8 h when the bubble approaches to its minimum volume the pressure inside the bubble also will approach to the maximum value which will induce a high pressure outward in fig 8 i the torodial bubble has approached to its minimum volume so the pressure on the area where the liquid jet impacts increases again for the water spike it rises all the time from fig 8 a 8 i when the liquid jet is about to penetrate the bubble the coupling characteristics between the bubble and the free surface with different γ f are studiedas shown in fig 9 meanwhile the average liquid jet width with different γ f is also computed as shown in fig 10 the range of the high pressure area formed between the bubble and the free surface is relatively concentrated when γ f 0 6 so the narrow water spike and the narrow liquid jet are formed as shown in fig 9 a when γ f increases to 1 1 the range of the high pressure area formed between the bubble and the free surface increases so that the widths of both water spike and liquid jet also increase as shown in figs 9 b and fig 10 as the stand off distance parameter γ f continues to increase the coupling effect between the free surface and the bubble is gradually weakened as shown from fig 9 c 9 f where the height of the water spike continues to decrease and the liquid jet width also begin to decrease gradually the results show that the liquid jet width increases first and then decreases when γ f changes from 0 6 to 2 0 and the liquid jet width can reach the maximum value when γ f 1 1 the liquid jet width is associated with the high pressure area formed between the bubble and the free surface generally the larger the high pressure area is the larger the liquid jet width is in fig 11 the high pressure distribution on the bubble top at the beginning of the liquid jet formation when γ f 0 6 1 1 and 2 0 it is obvious that the pressure area for γ f 1 1 are larger than the pressure areas for γ f 0 6 and 2 0 so the liquid jet width for γ f 1 1 is larger than the liquid jet widths for γ f 0 6 and 2 0 during the bubble expansion stage the water spike will rise owing to the bubble expansion but during the bubble shrink stage the water spike whether the water spike rises or falls is associated with γ f when γ f is set as a small value or the bubble is very close to the free surface a high pressure area near the free surface will be formed owing to the high pressure area the water spike will rise during the bubble shrike stage when γ f is set as a big value or the bubble is far away from the free surface the high pressure area formed between the bubble and the free surface is also far away from the free surface so the effect of the high pressure area on the water spike rising will not be very obvious in the situations the attraction of bubble shrink to the water spike will play a dominate role so the water spike will fall back with the bubble shrink in fig 12 a the height of water spike with time is displayed when γ f 0 7 1 1 and 1 8 a strong interaction between the bubble and the free surface occurs when γ f 0 7 where the water spike rises sharply during the bubble expansion and contraction when γ f 1 1 the water spike also keeps rising during the bubble expansion and contraction but the rising velocity of the water spike is not as fast as the case with γ f 1 1 when γ f 1 8 the interaction strength between the bubble and the free surface decreases seriously here the water spike does not always rise with the bubble motion at the beginning the water spike rises with the bubble expansion and then falls with the bubble contraction in order to obtain the critical parameter γ f when the water spike begins to fall with the bubble contraction the height of the water spike at the maximum and minimum bubble volume with different γ f is given in fig 12 b when γ f 1 25 the water spike always keeps rising during the bubble expansion and contraction and the closer the bubble is to the free surface the higher the waters spike rises during the bubble contraction when γ f 1 25 the water spike does not always keep rising during the bubble expansion and contraction and the water spike will fall with the bubble contraction so for the case γ s 0 8 to increase the strength of the water spike rising the parameter γ f should be less than 1 25 otherwise it should be greater than 1 25 in fig 13 a the velocity of water spike with time is displayed when γ f 0 7 1 1 and 1 8 meanwhile the bubble expansion velocity with time is also displayed when γ f 0 7 1 1 and 1 8 in fig 13 b during the bubble expansion the water spike pushed by the bubble expansion rises rapidly in the beginning subsequently with the decrease of bubble expansion velocity the velocity of water spike also decreases during the bubble contraction since a local high pressure area is formed between the bubble and the water spike the velocity of water spike increases again when γ f 0 7 and 1 1 and the smaller the parameter γ f is the faster the velocity of water spike increases however since the local high pressure area formed is away from the water spike when γ f 1 8 the velocity of water spike begins to decrease with the bubble contraction this is why the water spike will fall with the bubble contraction when γ f 1 25 in fig 12 b in fig 14 the liquid jet velocity when the liquid jet penetrates the bubble with different γ f and the maximum velocity of water spike during the bubble expansion with different γ f are displayed the smaller the parameter γ f is the bigger the maximum velocity of water spike is during the bubble expansion so when use the velocity of water spike to destroy the floated structure the bubble should be as close as possible to the free surface for the liquid jet velocity when the liquid jet penetrates the bubble it does not change monotonically with the increase of γ f but decreases first and then increases and there is a minimum value when γ f 0 8 therefore in the shallow water environment it is not that the closer the bubble is to the free surface the faster the liquid jet velocity is in order to study the bubble shape along the vertical direction with different γ f the motion of the top point and bottom point of bubble with time is displayed in fig 15 a when γ f 0 7 1 1 and 1 8 when γ f 0 7 the bubble top elongated is the most serious and the liquid jet also penetrates the bubble in advance however owing to the impediment of solid wall the bubble bottom with time has no significant difference when γ f 0 7 1 1 and 1 8 meanwhile the positions of the top point and bottom point at the maximum bubble volume with different γ f are displayed and the difference between them is also given as shown in fig 15 b the parameter γ f has little effect on the motion of bubble bottom which almost adheres to the surface of the solid wall when the bubble reaches it maximum volume when the bubble is close to the free surface the bubble top is elongated evidently along the vertical direction with the increase of γ f the elongation of the bubble top along the vertical direction decreases gradually when γ f 1 5 the phenomenon that the bubble top is elongated by the free surface is no longer obvious in fig 16 a the bubble centroid with time is displayed when γ f 0 7 1 1 and 1 8 the bubble migrates towards the free surface during its expansion and then migrates away from the free surface during its contraction since the bubble top is elongated severely when the bubble is close to the free surface the upward migration of bubble for γ f 0 7 is more obvious than those for γ f 1 1 and 1 8 during the bubble contraction the bubble migrating towards the wall for γ f 0 7 occurs earlier than those for γ f 1 1 and 1 8 the reason is that the liquid jet penetrating the bubble and the bubble reaching its minimum volume will happen earlier when the bubble is closer to the free surface as shown in fig 16 b meanwhile for different γ f the liquid jet penetrating the bubble happens earlier than the bubble reaching its minimum volume if the solid wall is replaced by the submerged structure the submerged structure will be subjected to two different types of pressures successively the first is the impact pressure induced by the liquid jet and the second is the pressure induced by the bubble reaching its minimum volume in fig 17 the pressure on the center of solid wall and the pressure inside the bubble with time are displayed simultaneously when γ f 0 7 1 1 and 1 8 meanwhile the corresponding bubble evolutions are also presented in figs 8 figs 18 and 19 evidently a high pressure is produced immediately on the solid wall after the liquid jet impacts the solid wall subsequently the pressure decays in exponential form when the bubble approaches to its minimum volume the pressure in the liquid induced by the inside pressure of bubble increases gradually so the pressure on the solid wall begins to increase again and a peak pressure is generated again when the bubble reaches its minimum volume soon afterwards the pressure decreases again when the bubble rebounds the peak pressure on the solid wall induced by the liquid jet is greater than the peak pressure induced by the bubble reaching its minimum volume so the threat of the liquid jet to the structures cannot be ignored besides the peak pressure induced by the liquid jet is closely associated with the parameter γ f since the liquid jet velocity increases when the bubble is away from the free surface the peak pressure induced by the liquid jet increases obviously with the increase of γ f and the liquid jet velocity with γ f can be seen in fig 9 4 2 the interaction between bubble and free surface under different γ s in this section the parameter γ f is set as 0 6 and the interaction between bubble and free surface with different γ s is studied in fig 20 the coupling characteristics between free surface and bubble at different times when γ s 0 5 are analyzed when the bubble is close to its maximum volume the free surface is raised and forms a water spike meanwhile the bubble top is elongated evidently along the vertical direction and is wrapped inside the water spike as shown in fig 20 a subsequently a small local high pressure area is formed above the bubble and results in a liquid jet with high velocity produced on the bubble top as shown in fig 20 b because of the high pressure area the liquid jet is developed towards the solid wall gradually and the water spike also moves upward gradually as shown in fig 20 c after the liquid jet penetrates the bubble the bubble becomes a toroidal bubble since the bubble bottom is almost in contact with the solid wall a high pressure area is formed on the solid wall directly after the liquid jet penetrates the bubble bottom moreover a radial liquid jet is formed along the sold wall as shown in fig 20 d subsequently a splash liquid jet is also produced during the radial liquid jet moves outward as shown in fig 20 e finally the toroidal bubble is split into two sub toroidal bubbles by the splash liquid jet as shown in fig 20 f in fig 21 the coupling characteristics between free surface and bubble when the liquid jet is about to penetrate the bubble with γ s 0 2 1 0 and 2 0 are analyzed when γ s 0 2 due to the impediment of the solid wall the bubble bottom completely adheres to the wall surface with the increase of γ s the bubble is gradually away from the solid wall when γ s 1 0 and 2 0 the impediment of the solid wall to the bubble is not very evident so the bubble bottom almost keep spherical shape besides the liquid jet height is higher than the liquid jet height in γ s 0 2 the influence of γ s on the water spike shape when the liquid jet is about to penetrate the bubble is not obvious and the water spike shapes are almost the same for different γ s in fig 22 the toroidal bubble shapes after the liquid jet penetrates the bubble with different γ s are analyzed and it is found that the toroidal bubble shapes are significantly associated with γ s when γ s 0 6 the toroidal bubble is split into two sub toroidal bubbles by the splash liquid jet where only a very small sub toroidal bubble is separated from the whole toroidal bubble when 0 6 γ s 1 1 the splash liquid jet formed near the solid wall is developed the inside liquid jet eventually where the inside liquid jet moves upward along the outer surface of the toroidal bubble but the toroidal bubble is not split into two sub toroidal bubbles by the inside liquid jet when γ s 1 1 the toroidal bubble is split into two sub toroidal bubbles by the inside liquid jet and the volumes of the two sub toroidal bubbles are similar in fig 23 a the height of water spike with time is displayed when γ s 0 5 1 0 and 1 6 where the height of water spike with time in γ s 0 5 is largest even though the height of water spike with time in γ s 1 0 is also greater than the height of water spike with time in γ s 1 6 the difference for both is little in fig 24 the height of water spike at the maximum bubble volume with different γ s is displayed the height of water spike decreases gradually with the increase of γ s but the heights of water spike only have a slight difference for different γ s when γ s 1 5 so the influence of γ s on the height of water spike is very little when γ s 1 5 in fig 23 b the bubble centroid with time is displayed when γ s 0 5 1 0 and 1 6 due to the attraction of the free surface and the impediment of the solid wall during the bubble expansion the closer the bubble is to the solid wall the faster the bubble moves towards the free surface because of the repulsion of the free surface and the attraction of the solid wall during the bubble contraction the bubble in γ s 1 0 and 1 6 moves more obviously towards the solid wall than those in γ s 0 5 in fig 24 the position of bubble centroid at the maximum bubble volume with different γ s is also displayed the movement of bubble towards the free surface during the bubble expansion decreases with the increase of γ s but the movements of bubble towards the free surface only have a slight difference for different γ s when γ s 1 5 so the influence of γ s on the movement of bubble towards the free surface during the bubble expansion is very little when γ s 1 5 in fig 25 a the top point and bottom point of bubble with time are displayed when γ s 0 5 1 0 and 1 6 meanwhile in fig 25 b the positions of the top point and bottom point of bubble at the maximum bubble volume with different γ s are also displayed and in order to explain the overall elongated extent of the bubble along the vertical direction with different γ s the difference between the top point and the bottom point is also computed as shown in fig 25 b when the bubble is initially placed very close to the free surface a strong coupling between the bubble and the free surface will occur so the bubble top is elongated evidently the elongated extent of the bubble top decreases with the increase of γ s but the influence of the parameter γ s on the elongated extent of the bubble top is very little when γ s 1 0 the movement of bubble bottom towards the solid wall increases gradually with the increase of γ s but the movements of bubble bottom towards the solid wall for different γ s only have a little difference when γ s 1 5 from the difference between the top point and the bottom point the overall elongation of the bubble increases with the increase of γ s due to the squeeze of wall and free surface the overall elongation of the bubble along the vertical direction is less than 1 0 when γ s 0 7 when γ s 1 5 the overall elongation of the bubble for different γ s only has a little difference in fig 26 a the velocity of water spike with time is displayed when γ s 0 5 1 0 and 1 6 it is obvious that the water spike rises faster with time when γ s 0 5 than those when γ s 1 0 and 1 6 since the bubble is away from the solid wall when γ s 1 0 and 1 6 the velocity of water spike with time in γ s 1 0 is only slightly higher than that in γ s 1 6 in fig 26 b the maximum velocity of the water spike with different γ s is also analyzed the maximum velocity of the water spike decreases with the increase of γ s but the maximum velocities of the water spike for different γ s only have a little difference when γ s 1 5 so the influence of γ s on the velocity of water spike can be ignored when γ s 1 5 in fig 27 the pressure on the center point of solid wall with time is displayed when γ s 0 5 1 0 and 1 6 when γ s 0 5 after the liquid jet impacts on the solid wall a high step pressure is produced immediately subsequently the pressure decays exponentially and then remains almost constant when γ s 1 0 the step pressure is also produced after the liquid jet impacts on the solid wall however the pressure does not decrease exponentially but increases again in the following time the reason is that the pressure inside bubble will increase when the bubble is close to its minimum volume and in the meantime the pressure inside bubble will induce high pressure outward so the pressure on the solid wall will also increase again when the bubble is gradually close to its minimum volume when γ s 1 6 the step pressure almost disappears after the liquid jet impacts on the solid wall and the pressure also increases in the following time with the increase of γ s the step pressure decreases obviously the reason is that the thickness of water layer between the bubble bottom and the sold wall will increase with the increase of γ s so the liquid jet velocity in the case with larger γ s will be weakened seriously when penetrates the water layer 5 conclusions the bubble characteristics in a shallow water environment are significantly associated with the free surface and the water bottom where the stand off distance parameters γ s and γ f are the two key parameters to decide the bubble characteristics so based on the finite volume method and front tracking method the coupling characteristics between bubble and free surface in a shallow water environment with different parameter γ s and γ f are analyzed and some meaningful results are summarized as follows 1 the liquid jet width increases first and then decreases when γ f changes from 0 6 to 2 0 and can reach the maximum value when γ f 1 1 when γ f 1 25 the water spike always keeps rising during the bubble expansion and contraction and the water spike will fall with the bubble contraction when γ f 1 25 the smaller the parameter γ f is the bigger the maximum velocity of water spike is however the liquid jet velocity decreases first and then increases and there is a minimum value when γ f 0 8 2 when γ f is small the bubble top elongated is the most serious besides the bubble migrating towards the free surface is more obvious during the bubble expansion and the bubble migrating towards the solid wall also occurs earlier during the bubble contraction when γ f 1 5 the bubble top elongated is no longer obvious the liquid jet penetrating the bubble and the bubble reaching its minimum volume will happen in advance when the bubble is closer to the free surface and the peak pressure on the wall induced by the liquid jet increases obviously with the increase of γ f 3 when γ s 0 6 the toroidal bubble is split into two sub toroidal bubbles by the splash liquid jet when 0 6 γ s 1 1 the splash liquid jet formed near the solid wall is developed the inside liquid jet eventually but the toroidal bubble is not split into two sub toroidal bubbles by the inside liquid jet when γ s 1 1 the toroidal bubble is split into two sub toroidal bubbles by the inside liquid jet 4 the height of water spike and the bubble migrating towards the free surface during the bubble expansion decrease gradually with the increase of γ s but the influence of γ s on them is very little when γ s 1 5 the elongated extent of the bubble top and the overall elongation of the bubble along the vertical direction decrease with the increase of γ s due to the squeeze of wall and free surface the overall elongation of the bubble along the vertical direction is less than 1 0 when γ s 0 7 and the overall elongation of the bubble only has a little difference when γ s 1 5 5 the maximum velocity of the water spike decreases with the increase of γ s but the maximum velocities of the water spike only have a little difference when γ s 1 5 the liquid jet velocity in larger parameter γ s will be weakened seriously when penetrates the water layer so the step pressure will decrease obviously with the increase of the parameter γ s credit authorship contribution statement liangtao liu conceptualization methodology validation writing original draft jinxiang wang software investigation visualization writing review editing yifan zhang investigation writing review editing kui tang investigation teng ma investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china no 12002168 the natural science foundation of jiangsu province no bk20200469 and the national key laboratory foundation of china no 6142604190405 no jckys2020606004 
20279,the bubble motion in the shallow water environment has significant applications in underwater explosion and seabed exploration where the bubble characteristics are mainly associated with the two types of stand off distance parameters γ f and γ s the parameters are defined in section 2 3 based on the assumption that the liquid is inviscid and incompressible the influences of γ f and γ s on the coupling characteristics between the bubble and the free surface in the shallow water environment are solved by the euler equations with the finite volume method and the bubble surface and the free surface are tracked by the front tracking method for the case γ s 0 8 i the water spike always keeps rising during the bubble expansion and contraction when γ f 1 25 ii the water spike velocity increases with the decrease of γ f and the maximum bubble jet velocity is generated when γ f 0 8 iii the bubble top elongated is no longer obvious when γ f 1 5 for the case γ f 0 6 i the toroidal bubble is split into two sub toroidal bubbles when γ s 0 6 and γ s 1 1 ii the water spike velocity and the step pressure decrease with the increase of γ s keywords bubble free surface shallow water environment finite volume method front tracking method 1 introduction bubble characteristics in a shallow water environment have significant applications in ocean engineering field such as underwater explosion in a shallow water environment and seabed exploration in a shallow water environment zhang et al 2016 2021 in the shallow water environment the bubble characteristics are different from the bubble characteristics only near the free surface or seabed which will be affected together by the free surface and the seabed there are two types of stand off distance parameters to decide the bubble characteristics in the shallow environment one is the parameter γ f characterizing the dimensionless distance between the bubble and the free surface and another is the parameter γ s characterizing the distance between the bubble and the solid wall until now the bubble characteristics only near the free surface or seabed have been studied in great detail by many researchers and some meaningful results have also been obtained but the bubble characteristics in the shallow environment affected together by the free surface and the seabed are not completely clear therefore understanding the bubble characteristics near both the free surface and the seabed is of great significance for underwater explosion and seabed exploration in the shallow water environment the bubble will be asymmetrical in the collapse process when located in the vicinity of a free surface meanwhile a water spike directed away from the bubble and a liquid jet directed away from the free surface also will be produced simultaneously the interaction between the bubble and the free surface had been deeply studied by many researchers through various ways in the beginning the growth and collapse of a bubble in close proximity to an initially plane free surface were simulated using the boundary integral method by blake et al 1987 2015 blake and gibson 1981 and the kelvin impulse was used to determine the migratory behaviour of the collapsing bubble subsequently the boundary integral method was improved in aspects of the singular integrals the time step size the nonuniform boundary elements and the vortex ring model which was applied in the simulation of the nonlinear evolution of the toroidal bubble and free surface liu et al 2017b liu et al 2017c wang et al 1996a b wang et al 2015 besides based on the two phase flow solver the volume of fluid method was employed for capturing the bubble surface and the free surface koukouvinis et al 2016 li et al 2019b phan et al 2020 tian et al 2018 where the complex phenomena including the splitting bursting breaking and re closure of the bubble near the free surface were simulated recently based on the finite volume method the phenomena such as the inward jet formed inside the toroidal bubble the toroidal bubble split and the water skirt with different γ f were analyzed by liu et al 2020 using a front tracking method coupled with an extrapolation technique in the experiments the key feature of the collapse bubble and the six distinctive patterns of the free surface motion at different γ f were analyzed by zhang et al 2016 using a high voltage spark generator in general many key characteristics of the bubble near the free surface at different γ f had been basically obtained using the numerical simulation and experiments the bubble near the solid wall has different characteristics from those near the free surface in the collapse stage owing to the attraction of the solid wall a liquid jet directed towards the solid wall will be produced which is usually considered to be one of the main factors of structure eroded by the cavitation bubble therefore the bubble characteristics near the solid wall had always been an important research topic for many researchers the bubble behaviors such as growing collapsing and jet formation near a solid wall for different stand off parameter γ s were investigated numerically by the boundary integral method li et al 2016 zhang et al 2015 2017 zhang and zhang 2004 in more complex boundaries such as a convex plate with and without a hole a corner a moveable sandwich structure etc gan et al 2021 gong et al 2018 jin et al 2018 2019 2019 li et al 2019a liu et al 2018 moloudi et al 2019 tagawa and peters 2018 wang et al 2018 2020 zhang et al 2021 the various bubble motions were analyzed with the help of the open source software package openfoam the bubble expanding and collapsing in the vicinity of the solid boundary and resilient metal surface was studied in dependence on the stand off parameter γ s by numerically solving the navier stokes equations koch et al 2016 lechner et al 2019 2020 sagar and el moctar 2020 based on the finite volume method the bubble motions near a solid wall in a inviscid liquid a viscous liquid and a hypergravity environment were simulated using the front tracking method liu et al 2017a 2021 popinet and zaleski 2002 and some phenomena such as the toroidal bubble split into two sub toroidal bubbles and two pressure peaks produced were studied in order to simulate the bubble characteristics at different stages well some hybrid algorithms fully using the advantages of various algorithms were applied to simulate the entire process of the underwater explosion near the solid wall in the hybrid algorithms the smoothed particle hydrodynamics method and the discontinuous galerkin method were usually used to simulate the charge detonation and shock wave and the boundary element method was used to model the bubble motion wang et al 2016 zhang et al 2019 in the experiments the spark generated bubble the laser induced bubble and the underwater explosion bubble near the solid wall were also extensively studied where some characteristics of the bubble such as the deformation the shock wave and the liquid jet pressure were obtained using the high speed photography system and the pressure transducer cui et al 2016 yingyu et al 2020 zhang et al 2020 generally the most of characteristics of the bubble near the solid wall had been revealed the bubble in the shallow water environment will be affected together by the free surface and the solid wall so the bubble characteristics in the shallow water environment depend on both the stand off parameter γ f and the stand off parameter γ s which will be more complex than those only near the free surface or the solid wall some relevant work had been done by some researchers using the experiments the temporal evolution of the spark generated bubble shape and the free surface motion were analyzed by huang et al 2020 and zhang et al 2013 using the high speed photography and some intriguing phenomena such as bubble split water skirt and double jets were observed based on the beam deflection probe the prolongation of oscillation times near a rigid boundary as well as the shortening of the oscillation times near a free surface was measured by gregorčič et al 2007 in the experiments the bubble shape and the free surface motion are easily obtained however due to the limitation of experimental measurement methods other characteristics such as jet velocity jet pressure splash jet sideway jet and internal shape of toroidal bubble are difficult to obtain the numerical simulation is a useful research method to make up for the deficiency of the experiment who can easily obtain the results in liquid that the experiment is difficult to measure in the numerical methods the finite volume method has advantage in liquid conservation and the front tracking method can track the bubble surface and free surface well so in this paper the finite volume method with the front tracking method is used to study the bubble motion between the free surface and the solid wall in order to obtain the bubble characteristics with different stand off parameters γ f and γ s in the shallow water environment 2 numerical model 2 1 the govern equations for liquid the bubble motion between free surface and solid wall with no elasticity is a common two phase flow problem where the gas and the liquid are separated by the bubble surface and the free surface in this paper the pressure in the gas region the gas inside the bubble and the gas above the free surface is not solved using the govern equations which is directly denoted by the state equation of ideal gas and the bubble size in the present work is relatively large and the liquid velocity induced by the bubble is smaller than the sound velocity so the viscosity and compressibility of the liquid are not taken into account li et al 2016 liu et al 2017c zhang et al 2018 at the initial time the relative position of bubble free surface and solid wall with no elasticity with axisymmetric coordinate system is shown in fig 1 base on those assumptions the liquid govern equations can be denoted by the euler equations in the axisymmetric configuration 1a 1 r ρ r u r ρ v z 0 1b ρ u t 1 r r ρ u 2 z ρ u v z p r 1c ρ v t 1 r r ρ u v r ρ v 2 z p z ρ g z where r is the coordinate in the radial direction z is the coordinate in the vertical direction ρ is the density u is the radial velocity v is the vertical velocity p is the pressure g z is the vertical gravitational acceleration 2 2 the state equation for gas and boundary conditions for the gas region above the free surface the volume of the gas above the free surface will not change significantly with the motion of the free surface so the gas pressure above the free surface is assumed to be a constant for the gas region inside the bubble the gas pressure is associated with the bubble volume it is assumed that the pressure is uniformly distributed and the gas system is adiabatic so the state equation of ideal gas inside the bubble can be expressed as li et al 2016 liu et al 2017c wang et al 1996b 2 p b p v p 0 v 0 v ϑ where p b is the pressure inside the bubble when the bubble volume is v p 0 is the non condensable gas pressure at the initial bubble volume v 0 p v is the vapor pressure and ϑ is the ratio of specific heats the pressure in the gas region is not solved using the govern equations so the pressure in the gas region is used as the pressure boundary condition of the liquid region the pressure acting on the free surface and the bubble surface is expressed as 3 p l p a σ κ free surface p v p 0 v 0 v ϑ σ κ bubble surface where p l is the pressure at the free surface or the bubble surface on the liquid side p a is the atmospheric pressure σ is the surface tension coefficient and κ is the surface curvature liu et al 2017a if the surface size is large the effect of the surface tension on the surface motion can be neglected for other boundaries of the liquid region the axisymmetric boundary condition is set at the symmetric axis z and the normal velocity is set to zero at the bottom and side boundaries 2 3 dimensionless parameters choose some basic characteristic quantities to nondimensionalize the calculated results the displacement and length are scaled with respect to the maximum bubble radius r m the pressure is scaled with respect to the atmospheric pressure p a the velocity is scaled with respect to p a ρ and the time is scaled with respect to r m ρ p a blake et al 1987 liu et al 2017c wang et al 1996a based on those basic characteristic quantities some dimensionless parameters are defined as follows 1 the dimensionless initial bubble radius r 0 r i r m 2 the buoyancy parameter δ ρ g z r m p a 3 the strength parameter ε p 0 p a 4 the stand off distance parameter for free surface γ f d f r m 5 the stand off distance parameter for solid wall γ s d s r m where r i denotes the initial bubble radius p 0 denotes the initial pressure inside the bubble d f denotes the initial distance between the bubble and the free surface and d s denotes the initial distance between the bubble and the solid wall as shown in fig 1 2 4 discrete form for govern equations the computational domain is divided into many same square cells in order to distinguish the position of gas liquid and interface the square cells are divided into three types the cell that only contains the air is defined as the air cell a the cell that only contains the liquid is defined as the liquid cell l and the cell that contains the bubble surface or the free surface is defined as the surface cell s the different cell types are shown in fig 2 based on the staggered grid in fig 2 the euler equations are discretized by the finite volume method fvm the discretization processes of the euler equations in the liquid cell can be treated as a special case in the surface cell so only the discretization processes of the euler equations in the surface cell are given in our study the explicit projection method is adopted to solve the momentum equations in which the unknown pressure terms in the momentum equations are not considered at first step so based on the gauss theorem the intermediate velocity u i 1 2 j and v i j 1 2 can be expressed as liu et al 2017a popinet and zaleski 2002 4a u i 1 2 j u i 1 2 j n δ t υ i 1 2 j ω i 1 2 j s i 1 2 j r u n u n d z ω i 1 2 j s i 1 2 j r u n v n d r s i 1 2 j r p l n d z s i 1 2 j r u n u n d z s i 1 2 j r u n v n d r 4b v i j 1 2 v i j 1 2 n δ t υ i j 1 2 ω i j 1 2 r δ 2 d r d z ω i j 1 2 s i j 1 2 r u n v n d z ω i j 1 2 s i j 1 2 r v n v n d r s i j 1 2 r p l n d r s i j 1 2 r u n v n d z s i j 1 2 r v n v n d r where subscript i i 1 2 j and j 1 2 denote the position of pressure and velocity as shown in fig 2 δ t denotes the time step and the superscript n denotes the value of pressure and velocity at the time n δ t ω i 1 2 j and ω i j 1 2 denote the control volumes of momentum equations in the direction r and z respectively and their boundaries are denoted by ω i 1 2 j and ω i j 1 2 respectively s i 1 2 j and s i j 1 2 denote the bubble surface or the free surface in the control volume ω i 1 2 j and ω i j 1 2 respectively p l denotes the pressure that acts on the free surface or the bubble surface υ i 1 2 j and υ i j 1 2 denote ω i 1 2 j r d r d z and ω i j 1 2 r d r d z respectively the velocity at the bubble surface and the free surface in eq 4 is unknown which can be obtained by the surrounding velocity using the linear interpolation method in the process of obtaining the velocity at the bubble surface and the free surface some surrounding velocities are located in the gas region the values of which are obtained from the velocities located in the liquid region using the least square extrapolation method liu et al 2017a here five velocity nodes located in the liquid region are used in the square extrapolation method after the intermediate velocities u i 1 2 j and v i j 1 2 in eq 4 are computed the velocities u i 1 2 j n 1 and v i j 1 2 n 1 at time n 1 δ t with the unknown pressure terms can be written as liu et al 2017a popinet and zaleski 2002 5a u i 1 2 j n 1 u i 1 2 j f i 1 2 j n 5b v i j 1 2 n 1 v i j 1 2 f i j 1 2 n where f i 1 2 j n δ t υ i 1 2 j ω i 1 2 j s i 1 2 j r p d z ω i 1 2 j p d r d z f i j 1 2 n δ t υ i j 1 2 ω i j 1 2 s i j 1 2 r p d r the velocities u i 1 2 j n 1 and v i j 1 2 n 1 in eq 5 should satisfy the continuity equation so the velocities in eq 1a should be replaced by the velocities u i 1 2 j n 1 and v i j 1 2 n 1 in eq 5 based on the gauss theorem the final form of the continuity equation can be written as liu et al 2017a popinet and zaleski 2002 6 f i j 1 2 f i j 1 2 n f i j 1 2 f i j 1 2 n f i 1 2 j f i 1 2 j n f i 1 2 j f i 1 2 j n f i j 1 2 v i j 1 2 f i j 1 2 v i j 1 2 f i 1 2 j u i 1 2 j f i 1 2 j u i 1 2 j where f i 1 2 j i 1 2 j r d z 1 r i 1 2 r i 1 2 s i j r r i 1 2 r d z f i 1 2 j i 1 2 j r d z 1 r i 1 2 r i 1 2 s i j r r i 1 2 r d z f i j 1 2 i j 1 2 r d r 1 z j 1 2 z j 1 2 s i j r z j 1 2 z d r f i j 1 2 i j 1 2 r d r 1 z j 1 2 z j 1 2 s i j r z j 1 2 z d r after the euler equations in the all surface cells and liquid cells are discretized into the form of eq 6 the n n linear equations for the unknown pressure are formed with the boundary conditions the n n linear equations are solved using the gauss seidel relaxation solver popinet and zaleski 2002 after the unknown pressure in the n n linear equations is solved the velocities u n 1 and v n 1 can be obtained by eq 5 2 5 tracking the surface after the velocities u n 1 and v n 1 in eq 5 are obtained the new positions of the bubble surface and the free surface need to be computed here a front tracking method is used to update the motions of the bubble surface and the free surface it is assumed that the bubble surface and the free surface consist of a series of particles so the motions of the bubble surface and the free surface can be realized by moving each particle the velocity of the particle is computed by the bilinear interpolation method with the surrounding velocities liu et al 2017a popinet and zaleski 1999 after the velocity of the particle is obtained the position of the particle at next time is obtained using the first order forward difference method liu et al 2017a popinet and zaleski 1999 7 r z s n 1 r z s n δ t u v s n with the motions of the bubble surface and the free surface the distance between the particles will change evidently in some local region which will affect the accuracy of the surface motion in order to solve this problem a cubic splines method is used to ensure the uniform distribution of the particles along the bubble surface and the free surface popinet and zaleski 1999 when the liquid jet penetrates the bubble or the bubble is split into multiple sub bubbles the bubble surface at some regions will collide with each other the bubble surface at the collision region should be cut and reconnected and the detailed method to cut and reconnect the bubble surface at the collision region can refer to the relevant literatures liu et al 2017a 3 validation of numerical model 3 1 convergence analysis the mesh number in the computational domain has an important influence on the motions of bubble and free surface so the convergence analysis for the mesh number in the computational domain should be conducted the size of the computational domain is set as 30 r m liu et al 2017a the dimensionless initial bubble radius r 0 0 2848 the buoyancy parameter δ 0 052 the strength parameter ε 21 24 the stand off distance parameter for free surface γ f 0 8 in order to analyze conveniently the center point of solid wall the axisymmetric point of water spike the top point of bubble and the bottom point of bubble are marked in fig 3 the convergence analysis for the bubble surface and the free surface at different mesh number is shown in fig 4 where the shapes of the bubble surface and the free surface at time 0 6 and 1 2 are given when the mesh number is set as 1026 1026 and 2050 2050 the shapes of the bubble surface and the free surface at two mesh numbers are in good agreement with each other besides the convergence analysis for the height of water spike the top point of bubble and the bottom point of bubble for different mesh number at different time are also conducted as shown in fig 5 evidently the height of water spike the top point of bubble and the bottom point of bubble for mesh number 1026 1026 and 2050 2050 also coincide based on the convergence analysis the computational results are almost convergent when the mesh number in the computational domain is set as 1026 1026 so the mesh number in the computational domain is chosen as 1026 1026 3 2 comparison with experiment after the convergence analysis for the computational results at different mesh number in the computational domain is accomplished the accuracy of the numerical method also should be validated a spark generated experiment for the bubble motion near a free surface is used to validate the accuracy of the numerical method in the spark generated experiment the maximum bubble radius r m 28 09 mm the bubble period t b 4 51 ms and the stand off distance parameter for free surface γ f 0 66 based on the maximum bubble radius and the bubble period the initial bubble radius and the initial pressure inside the bubble can be estimated using the rayleigh plesset equation by calculating the dimensionless initial bubble radius r 0 0 2848 and the strength parameter ε 21 24 which is consistent with the initial parameters for the convergence analysis in section iii a in fig 6 the comparison of the numerical results with the spark generated bubble experiment is conducted fig 6 a 6 c show the formation and development of the bubble jet and water spike fig 6 d shows the bubble jet penetrating the bottom surface of the bubble fig 6 e shows that the sideway jet is about to penetrate the toroidal bubble from the sides fig 6 f shows that the toroidal bubble is split into two sub toroidal bubbles by the sideway jet meanwhile the comparison for the height of water spike between the numerical results and the experiment is also displayed in fig 7 through the comparison the bubble motion and the free surface motion in numerical results are in good agreement with the experimental results so the numerical method in the present study can simulate the coupling characteristics between the bubble and the free surface well 4 numerical results and discussion the coupling characteristics between the bubble and the free surface in the shallow water environment are significantly associated with the stand off distance parameters γ f and γ s so the influences of γ f and γ s on the coupling characteristics between the bubble and the free surface in the shallow water environment are analyzed in section 4 1 and 4 2 respectively the initial conditions for the bubble are set as the initial bubble radius r 0 0 1818 the strength parameter ε 74 16 and the buoyancy parameter δ 0 163 when the influence of γ f on the coupling characteristics between the bubble and the free surface is studied in section 4 1 γ s is set as 0 8 and when the influence of γ s on the coupling characteristics between the bubble and the free surface is studied in section 4 2 γ f is set as 0 6 4 1 the interaction between bubble and free surface under different γ f in fig 8 the coupling characteristics between free surface and bubble at different times when γ f 0 7 where the contours in left represent vertical velocity the contours in right represent pressure and the arrow represents velocity vector at the beginning the pressure inside the bubble is much greater than the pressure at infinity the pressure at infinity in the shallow water environment can be approximately regarded as the atmospheric pressure p a so the bubble expands with an acceleration as shown in fig 8 a and b with the bubble expansion the pressure inside the bubble decreases gradually when the pressure inside the bubble is less than the pressure at infinity the bubble expands with a deceleration as shown in fig 8 c and d meanwhile a large portion of the bubble is elongated along the vertical direction and the bubble top is entrained into the bottom of the raised free surface subsequently owing to the impact of water flow from the sides a high pressure stagnation point is formed in the narrow area between the free surface and the bubble owing to the high pressure area the incoming flow is redirected upward to form the water spike and downward to form the liquid jet as shown in fig 8 e after the bubble reaches its maximum volume the bubble begins to shrink and the liquid jet becomes wider gradually during the downward development as shown in fig 8 f after the liquid jet penetrates the bubble a toroidal bubble is formed when the liquid jet impacts on the solid wall a high pressure area on the solid is produced as shown in fig 8 g soon afterwards the liquid jet is divided into splash flow and radial flow after impacts on the solid wall and the splash flow directly moves toward the toroidal bubble interior as shown in fig 8 h when the bubble approaches to its minimum volume the pressure inside the bubble also will approach to the maximum value which will induce a high pressure outward in fig 8 i the torodial bubble has approached to its minimum volume so the pressure on the area where the liquid jet impacts increases again for the water spike it rises all the time from fig 8 a 8 i when the liquid jet is about to penetrate the bubble the coupling characteristics between the bubble and the free surface with different γ f are studiedas shown in fig 9 meanwhile the average liquid jet width with different γ f is also computed as shown in fig 10 the range of the high pressure area formed between the bubble and the free surface is relatively concentrated when γ f 0 6 so the narrow water spike and the narrow liquid jet are formed as shown in fig 9 a when γ f increases to 1 1 the range of the high pressure area formed between the bubble and the free surface increases so that the widths of both water spike and liquid jet also increase as shown in figs 9 b and fig 10 as the stand off distance parameter γ f continues to increase the coupling effect between the free surface and the bubble is gradually weakened as shown from fig 9 c 9 f where the height of the water spike continues to decrease and the liquid jet width also begin to decrease gradually the results show that the liquid jet width increases first and then decreases when γ f changes from 0 6 to 2 0 and the liquid jet width can reach the maximum value when γ f 1 1 the liquid jet width is associated with the high pressure area formed between the bubble and the free surface generally the larger the high pressure area is the larger the liquid jet width is in fig 11 the high pressure distribution on the bubble top at the beginning of the liquid jet formation when γ f 0 6 1 1 and 2 0 it is obvious that the pressure area for γ f 1 1 are larger than the pressure areas for γ f 0 6 and 2 0 so the liquid jet width for γ f 1 1 is larger than the liquid jet widths for γ f 0 6 and 2 0 during the bubble expansion stage the water spike will rise owing to the bubble expansion but during the bubble shrink stage the water spike whether the water spike rises or falls is associated with γ f when γ f is set as a small value or the bubble is very close to the free surface a high pressure area near the free surface will be formed owing to the high pressure area the water spike will rise during the bubble shrike stage when γ f is set as a big value or the bubble is far away from the free surface the high pressure area formed between the bubble and the free surface is also far away from the free surface so the effect of the high pressure area on the water spike rising will not be very obvious in the situations the attraction of bubble shrink to the water spike will play a dominate role so the water spike will fall back with the bubble shrink in fig 12 a the height of water spike with time is displayed when γ f 0 7 1 1 and 1 8 a strong interaction between the bubble and the free surface occurs when γ f 0 7 where the water spike rises sharply during the bubble expansion and contraction when γ f 1 1 the water spike also keeps rising during the bubble expansion and contraction but the rising velocity of the water spike is not as fast as the case with γ f 1 1 when γ f 1 8 the interaction strength between the bubble and the free surface decreases seriously here the water spike does not always rise with the bubble motion at the beginning the water spike rises with the bubble expansion and then falls with the bubble contraction in order to obtain the critical parameter γ f when the water spike begins to fall with the bubble contraction the height of the water spike at the maximum and minimum bubble volume with different γ f is given in fig 12 b when γ f 1 25 the water spike always keeps rising during the bubble expansion and contraction and the closer the bubble is to the free surface the higher the waters spike rises during the bubble contraction when γ f 1 25 the water spike does not always keep rising during the bubble expansion and contraction and the water spike will fall with the bubble contraction so for the case γ s 0 8 to increase the strength of the water spike rising the parameter γ f should be less than 1 25 otherwise it should be greater than 1 25 in fig 13 a the velocity of water spike with time is displayed when γ f 0 7 1 1 and 1 8 meanwhile the bubble expansion velocity with time is also displayed when γ f 0 7 1 1 and 1 8 in fig 13 b during the bubble expansion the water spike pushed by the bubble expansion rises rapidly in the beginning subsequently with the decrease of bubble expansion velocity the velocity of water spike also decreases during the bubble contraction since a local high pressure area is formed between the bubble and the water spike the velocity of water spike increases again when γ f 0 7 and 1 1 and the smaller the parameter γ f is the faster the velocity of water spike increases however since the local high pressure area formed is away from the water spike when γ f 1 8 the velocity of water spike begins to decrease with the bubble contraction this is why the water spike will fall with the bubble contraction when γ f 1 25 in fig 12 b in fig 14 the liquid jet velocity when the liquid jet penetrates the bubble with different γ f and the maximum velocity of water spike during the bubble expansion with different γ f are displayed the smaller the parameter γ f is the bigger the maximum velocity of water spike is during the bubble expansion so when use the velocity of water spike to destroy the floated structure the bubble should be as close as possible to the free surface for the liquid jet velocity when the liquid jet penetrates the bubble it does not change monotonically with the increase of γ f but decreases first and then increases and there is a minimum value when γ f 0 8 therefore in the shallow water environment it is not that the closer the bubble is to the free surface the faster the liquid jet velocity is in order to study the bubble shape along the vertical direction with different γ f the motion of the top point and bottom point of bubble with time is displayed in fig 15 a when γ f 0 7 1 1 and 1 8 when γ f 0 7 the bubble top elongated is the most serious and the liquid jet also penetrates the bubble in advance however owing to the impediment of solid wall the bubble bottom with time has no significant difference when γ f 0 7 1 1 and 1 8 meanwhile the positions of the top point and bottom point at the maximum bubble volume with different γ f are displayed and the difference between them is also given as shown in fig 15 b the parameter γ f has little effect on the motion of bubble bottom which almost adheres to the surface of the solid wall when the bubble reaches it maximum volume when the bubble is close to the free surface the bubble top is elongated evidently along the vertical direction with the increase of γ f the elongation of the bubble top along the vertical direction decreases gradually when γ f 1 5 the phenomenon that the bubble top is elongated by the free surface is no longer obvious in fig 16 a the bubble centroid with time is displayed when γ f 0 7 1 1 and 1 8 the bubble migrates towards the free surface during its expansion and then migrates away from the free surface during its contraction since the bubble top is elongated severely when the bubble is close to the free surface the upward migration of bubble for γ f 0 7 is more obvious than those for γ f 1 1 and 1 8 during the bubble contraction the bubble migrating towards the wall for γ f 0 7 occurs earlier than those for γ f 1 1 and 1 8 the reason is that the liquid jet penetrating the bubble and the bubble reaching its minimum volume will happen earlier when the bubble is closer to the free surface as shown in fig 16 b meanwhile for different γ f the liquid jet penetrating the bubble happens earlier than the bubble reaching its minimum volume if the solid wall is replaced by the submerged structure the submerged structure will be subjected to two different types of pressures successively the first is the impact pressure induced by the liquid jet and the second is the pressure induced by the bubble reaching its minimum volume in fig 17 the pressure on the center of solid wall and the pressure inside the bubble with time are displayed simultaneously when γ f 0 7 1 1 and 1 8 meanwhile the corresponding bubble evolutions are also presented in figs 8 figs 18 and 19 evidently a high pressure is produced immediately on the solid wall after the liquid jet impacts the solid wall subsequently the pressure decays in exponential form when the bubble approaches to its minimum volume the pressure in the liquid induced by the inside pressure of bubble increases gradually so the pressure on the solid wall begins to increase again and a peak pressure is generated again when the bubble reaches its minimum volume soon afterwards the pressure decreases again when the bubble rebounds the peak pressure on the solid wall induced by the liquid jet is greater than the peak pressure induced by the bubble reaching its minimum volume so the threat of the liquid jet to the structures cannot be ignored besides the peak pressure induced by the liquid jet is closely associated with the parameter γ f since the liquid jet velocity increases when the bubble is away from the free surface the peak pressure induced by the liquid jet increases obviously with the increase of γ f and the liquid jet velocity with γ f can be seen in fig 9 4 2 the interaction between bubble and free surface under different γ s in this section the parameter γ f is set as 0 6 and the interaction between bubble and free surface with different γ s is studied in fig 20 the coupling characteristics between free surface and bubble at different times when γ s 0 5 are analyzed when the bubble is close to its maximum volume the free surface is raised and forms a water spike meanwhile the bubble top is elongated evidently along the vertical direction and is wrapped inside the water spike as shown in fig 20 a subsequently a small local high pressure area is formed above the bubble and results in a liquid jet with high velocity produced on the bubble top as shown in fig 20 b because of the high pressure area the liquid jet is developed towards the solid wall gradually and the water spike also moves upward gradually as shown in fig 20 c after the liquid jet penetrates the bubble the bubble becomes a toroidal bubble since the bubble bottom is almost in contact with the solid wall a high pressure area is formed on the solid wall directly after the liquid jet penetrates the bubble bottom moreover a radial liquid jet is formed along the sold wall as shown in fig 20 d subsequently a splash liquid jet is also produced during the radial liquid jet moves outward as shown in fig 20 e finally the toroidal bubble is split into two sub toroidal bubbles by the splash liquid jet as shown in fig 20 f in fig 21 the coupling characteristics between free surface and bubble when the liquid jet is about to penetrate the bubble with γ s 0 2 1 0 and 2 0 are analyzed when γ s 0 2 due to the impediment of the solid wall the bubble bottom completely adheres to the wall surface with the increase of γ s the bubble is gradually away from the solid wall when γ s 1 0 and 2 0 the impediment of the solid wall to the bubble is not very evident so the bubble bottom almost keep spherical shape besides the liquid jet height is higher than the liquid jet height in γ s 0 2 the influence of γ s on the water spike shape when the liquid jet is about to penetrate the bubble is not obvious and the water spike shapes are almost the same for different γ s in fig 22 the toroidal bubble shapes after the liquid jet penetrates the bubble with different γ s are analyzed and it is found that the toroidal bubble shapes are significantly associated with γ s when γ s 0 6 the toroidal bubble is split into two sub toroidal bubbles by the splash liquid jet where only a very small sub toroidal bubble is separated from the whole toroidal bubble when 0 6 γ s 1 1 the splash liquid jet formed near the solid wall is developed the inside liquid jet eventually where the inside liquid jet moves upward along the outer surface of the toroidal bubble but the toroidal bubble is not split into two sub toroidal bubbles by the inside liquid jet when γ s 1 1 the toroidal bubble is split into two sub toroidal bubbles by the inside liquid jet and the volumes of the two sub toroidal bubbles are similar in fig 23 a the height of water spike with time is displayed when γ s 0 5 1 0 and 1 6 where the height of water spike with time in γ s 0 5 is largest even though the height of water spike with time in γ s 1 0 is also greater than the height of water spike with time in γ s 1 6 the difference for both is little in fig 24 the height of water spike at the maximum bubble volume with different γ s is displayed the height of water spike decreases gradually with the increase of γ s but the heights of water spike only have a slight difference for different γ s when γ s 1 5 so the influence of γ s on the height of water spike is very little when γ s 1 5 in fig 23 b the bubble centroid with time is displayed when γ s 0 5 1 0 and 1 6 due to the attraction of the free surface and the impediment of the solid wall during the bubble expansion the closer the bubble is to the solid wall the faster the bubble moves towards the free surface because of the repulsion of the free surface and the attraction of the solid wall during the bubble contraction the bubble in γ s 1 0 and 1 6 moves more obviously towards the solid wall than those in γ s 0 5 in fig 24 the position of bubble centroid at the maximum bubble volume with different γ s is also displayed the movement of bubble towards the free surface during the bubble expansion decreases with the increase of γ s but the movements of bubble towards the free surface only have a slight difference for different γ s when γ s 1 5 so the influence of γ s on the movement of bubble towards the free surface during the bubble expansion is very little when γ s 1 5 in fig 25 a the top point and bottom point of bubble with time are displayed when γ s 0 5 1 0 and 1 6 meanwhile in fig 25 b the positions of the top point and bottom point of bubble at the maximum bubble volume with different γ s are also displayed and in order to explain the overall elongated extent of the bubble along the vertical direction with different γ s the difference between the top point and the bottom point is also computed as shown in fig 25 b when the bubble is initially placed very close to the free surface a strong coupling between the bubble and the free surface will occur so the bubble top is elongated evidently the elongated extent of the bubble top decreases with the increase of γ s but the influence of the parameter γ s on the elongated extent of the bubble top is very little when γ s 1 0 the movement of bubble bottom towards the solid wall increases gradually with the increase of γ s but the movements of bubble bottom towards the solid wall for different γ s only have a little difference when γ s 1 5 from the difference between the top point and the bottom point the overall elongation of the bubble increases with the increase of γ s due to the squeeze of wall and free surface the overall elongation of the bubble along the vertical direction is less than 1 0 when γ s 0 7 when γ s 1 5 the overall elongation of the bubble for different γ s only has a little difference in fig 26 a the velocity of water spike with time is displayed when γ s 0 5 1 0 and 1 6 it is obvious that the water spike rises faster with time when γ s 0 5 than those when γ s 1 0 and 1 6 since the bubble is away from the solid wall when γ s 1 0 and 1 6 the velocity of water spike with time in γ s 1 0 is only slightly higher than that in γ s 1 6 in fig 26 b the maximum velocity of the water spike with different γ s is also analyzed the maximum velocity of the water spike decreases with the increase of γ s but the maximum velocities of the water spike for different γ s only have a little difference when γ s 1 5 so the influence of γ s on the velocity of water spike can be ignored when γ s 1 5 in fig 27 the pressure on the center point of solid wall with time is displayed when γ s 0 5 1 0 and 1 6 when γ s 0 5 after the liquid jet impacts on the solid wall a high step pressure is produced immediately subsequently the pressure decays exponentially and then remains almost constant when γ s 1 0 the step pressure is also produced after the liquid jet impacts on the solid wall however the pressure does not decrease exponentially but increases again in the following time the reason is that the pressure inside bubble will increase when the bubble is close to its minimum volume and in the meantime the pressure inside bubble will induce high pressure outward so the pressure on the solid wall will also increase again when the bubble is gradually close to its minimum volume when γ s 1 6 the step pressure almost disappears after the liquid jet impacts on the solid wall and the pressure also increases in the following time with the increase of γ s the step pressure decreases obviously the reason is that the thickness of water layer between the bubble bottom and the sold wall will increase with the increase of γ s so the liquid jet velocity in the case with larger γ s will be weakened seriously when penetrates the water layer 5 conclusions the bubble characteristics in a shallow water environment are significantly associated with the free surface and the water bottom where the stand off distance parameters γ s and γ f are the two key parameters to decide the bubble characteristics so based on the finite volume method and front tracking method the coupling characteristics between bubble and free surface in a shallow water environment with different parameter γ s and γ f are analyzed and some meaningful results are summarized as follows 1 the liquid jet width increases first and then decreases when γ f changes from 0 6 to 2 0 and can reach the maximum value when γ f 1 1 when γ f 1 25 the water spike always keeps rising during the bubble expansion and contraction and the water spike will fall with the bubble contraction when γ f 1 25 the smaller the parameter γ f is the bigger the maximum velocity of water spike is however the liquid jet velocity decreases first and then increases and there is a minimum value when γ f 0 8 2 when γ f is small the bubble top elongated is the most serious besides the bubble migrating towards the free surface is more obvious during the bubble expansion and the bubble migrating towards the solid wall also occurs earlier during the bubble contraction when γ f 1 5 the bubble top elongated is no longer obvious the liquid jet penetrating the bubble and the bubble reaching its minimum volume will happen in advance when the bubble is closer to the free surface and the peak pressure on the wall induced by the liquid jet increases obviously with the increase of γ f 3 when γ s 0 6 the toroidal bubble is split into two sub toroidal bubbles by the splash liquid jet when 0 6 γ s 1 1 the splash liquid jet formed near the solid wall is developed the inside liquid jet eventually but the toroidal bubble is not split into two sub toroidal bubbles by the inside liquid jet when γ s 1 1 the toroidal bubble is split into two sub toroidal bubbles by the inside liquid jet 4 the height of water spike and the bubble migrating towards the free surface during the bubble expansion decrease gradually with the increase of γ s but the influence of γ s on them is very little when γ s 1 5 the elongated extent of the bubble top and the overall elongation of the bubble along the vertical direction decrease with the increase of γ s due to the squeeze of wall and free surface the overall elongation of the bubble along the vertical direction is less than 1 0 when γ s 0 7 and the overall elongation of the bubble only has a little difference when γ s 1 5 5 the maximum velocity of the water spike decreases with the increase of γ s but the maximum velocities of the water spike only have a little difference when γ s 1 5 the liquid jet velocity in larger parameter γ s will be weakened seriously when penetrates the water layer so the step pressure will decrease obviously with the increase of the parameter γ s credit authorship contribution statement liangtao liu conceptualization methodology validation writing original draft jinxiang wang software investigation visualization writing review editing yifan zhang investigation writing review editing kui tang investigation teng ma investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china no 12002168 the natural science foundation of jiangsu province no bk20200469 and the national key laboratory foundation of china no 6142604190405 no jckys2020606004 
