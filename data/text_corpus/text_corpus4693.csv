index,text
23465,a model for simulating oil spills in seas is presented in this study the effects of winds sea currents evaporation emulsification natural dispersion and seashore interaction have been taken into account a significant advantage of the model is the possibility of taking into account inhomogeneities in space and the instability at the time of the atmospheric conditions this model enables the determination of the actual state of oil including its density composition and viscosity etc in both a global as well as a local in any point of space meaning the frame of the model is based on the discrete particle methodology to improve the spreading process description cellular automata approach is also applied a few simulations of oil spills have been performed and described the results are compared with experimental data and other theoretical outcomes a high level of accordance is obtained without the necessity of fitting particular parameters keywords oil spills numerical models 1 introduction oil spills occurring especially during damage to tankers or offshore rigs are particularly catastrophic for coastal and marine environments mitsch 2010 additionally they can cause serious losses in fishery and tourism therefore there is a strong necessity to model the time evolution of such spreading processes the quantities to be determined encompass the rates of changes in the physical and chemical properties of oil as well as the rate of its natural removal we expect the model to return the anticipated evolution of oil spills thereby enabling appropriate actions aimed at minimizing the effects of disasters for the above reasons many models making it possible to simulate these incidents have been developed over the last decades among the available reviews the following papers deserve special attention huang 1983 reed et al 1999 spaulding 1988 one can point out following computer programs for performing oil spill simulations adios2 adios oil spill condindency and response oscar general noaa oil modeling environment beegle krause and medslik ii the course of oil spills at sea is governed by chemical physical and biological processes which are dependent on both oil properties composition density and viscosity etc and external conditions temperature wind sea current pressure and salinity etc among these processes the most important are evaporation natural dispersion emulsification advection spreading and interaction of oil slicks with the shoreline effects of secondary significance may be distinguished as photolysis sedimentation biodegradation and dissolution a schematic diagram shown in fig 1 demonstrates these phenomena to construct a reliable model each of the listed effects should be described by a mathematical formula in section 2 6 we have included comments on different possible approaches to the modeling of the considered processes 2 model 2 1 motivation in the case of the division of crude oil into parts discrete method it is relatively simple to model the advection process by creating a certain velocity field resulting from the sea currents and winds however it is problematic to calculate the correlations between the pieces this causes difficulty in describing of the spreading oil spill process idea of application of cellular automata to some extent solves this problem such application was proposed in an interesting article by karafyllidis 1997 and its follow up by vourkas and sirakoulis including among other fpga implementation and finally 3d ca implementation by rusinovic and bogunovic 2006 in that works environmental conditions can be changed independently in such cases the main disadvantage is the proper simulation of the advection process the probability of inaccuracies is unfortunately large thus after the analysis we decided to work out a solution of connecting langrangian discrete particle algorithm with cellular automata approach regarding spreading oil process we have decided to base on fay s spreading theory fay 1971 however we believe that proposed discrete framework is convenient in high performance computations detailed description of the proposed method is presented in section 2 7 2 2 overview in our model an oil bulk is divided into a large number of small particles oil particle op with assigned initial parameters such as mass density and composition etc the physical space sea coast is divided into square cells every oil particle moves with a certain discrete velocities field related with cell division a velocity vector is assigned to every cell and resulting from the presence of sea currents and winds individual oil particles may be subject to processes such as evaporation emulsification and dispersion whose intensity depends on the external condition assignment to the cell wherein the op is located in order to include correlation between movement of the op the cellular automata ca approach was applied in the model 2 3 physical space representation the simulated area is described by the two dimensional cartesian coordinate system x y additionally it is covered by a grid that divides space into square cells of a length hence the space is discretized i e a square with coordinates x j a j 1 a and y i a i 1 a is assigned to the cell with i j indexes fig 2 each cell may either represent the sea or land the applied division strategy reflects the necessity of taking into account varying external conditions such as temperature winds and sea current these quantities hereinafter referred to as cell external variables cev are set as initial values the model also enables changes in course during the simulation additionally each of the cells is characterized by cell internal variables civ such as thickness of the oil layer water content etc which result from the properties of ops currently located in a specific cell 2 4 oil representation as mentioned previously the oil is discretized by division into identical particles op the mass of every op is adjusted before the start of the simulation each op possesses actual coordinates that allow it to be assigned to a proper cell the motion of the op results from the advection and spreading processes in addition to migration the op can be modified by changes in mass water content volume evaporation and dispersion rate these properties are referred to as oil point state ops based on the ops of every op in the cell the civ is calculated 2 5 data flow fig 3 shows a simplified data flow diagram based on the model the simulation is propagated in time with finite time step δ t the following paragraphs briefly describe individual phases marked on the diagram start of simulation the basic input data for our model is the topography of the area thus it is possible to assign the type sea or land to the cells before starting the simulation one must also enter parameters describing the oil such as density 15 o c viscosity surface tension and composition in addition it is required to set the initial mass value for a single piece of oil oil properties are constant within the simulation change of cev length of time step during each simulation step it is possible to change the cev moreover the length of the time step can be modified adding oil to the selected cells it is possible to add the mass of oil m to the selected cell i j in such a case the portion of oil is divided into n ops n m m k the coordinates of every op are chosen to be consistent with the i j cell randomly with uniform distribution the implementation allows total freedom in spatial choice of the cell therefore it s feasible to simulate oil leaks located at any source at any time additionally the option of multiple oil sources is included modification of ops for each op the new state ops is calculated through the modeling of emulsification evaporation dispersion change in density and viscosity change in op coordinates the op coordinates in the next time step are determined by simulating diffusion advection and seashore interaction assignment ops to cells as a result of the processes from the previous paragraph part of the op may be moved to other cells thus for each time step and each cell a list of all ops associated with the chosen cell is built increasing the total simulation time the time of the simulation is incremented by the current length of the time step calculation of civ for every cell the civ is calculated according to the list of ops assigned to this cell the function represents the output of our algorithm it indicates the state of the oil at a specific region at a specific time stopping condition the basic terminating condition for the present simulation is to exceed the fixed time limit the iterations continue until the time limit is reached 2 6 modeling of physical processes the previous sections provide basic information about the design of our model in this paragraph we describe our approach to the modeling of the relevant physical processes 2 6 1 advection advection is the transport mechanism of a substance by a fluid due to the fluid s bulk motion in the case of oil spills advection can be considered as the drift of oil induced by sea currents an additional factor affecting the motion of the oil is wind in the model we have adopted a uniform linear approximation for the description of the motion of an op similar approach was used in models al rabeh and cekirge wang and shen its velocity is the result of a linear combination of wind and current velocities related to a particular cell hence the advection displacement of the op located at the start of the k th iteration in the i j cell can be expressed as 1 δ r k α v k c u r r e n t i j β v k w i n d i j δ t k where v k c u r r e n t i j v k w i n d i j are vectors of current and wind velocities in the k t h iteration in the i j cell δ t k is the length of a time step the symbols α and β denote parameters chosen to be 1 1 wang et al 2005 and 3 according to boufadel et al 2014 respectively it should be stressed that applied value β and whole approach is correct for consideration a quiescent sea in the presence of waves and langmuir cells spreading due to surface tension becomes negligible boufadel et al 2006 and geng et al 2016 2 7 spreading the spreading process can be modeled as an increase in the area of oil with a simultaneous decrease in its layer thickness in the case of a discrete particle approach the modeling of this phenomenon should rely on the appropriate displacement of the ops in contrast to the advection process it is necessary to consider correlations between ops the spreading motion of an individual op is dependent on the positions of other ops in order to quantify model this process we have treated it in analogy to diffusion however it should be noted that spreading can not be strictly identified with diffusion this was confirmed by simulations reported in ao ieong et al which show that the diffusion with a reliable diffusion coefficient has no effect on the growth oil area nevertheless for a deliberated choice of the spreading diffusion coefficient d which can be a function of oil state the spreading process may be modeled in a way similar to diffusion the current paragraph comprises the adopted strategy the present formulation requires knowledge of the d function whose form is included hereafter we have used the diffusion modeling approach introduced by vick 2007 the method introduced therein is based on cellular automata the main idea lies within the specific way of referring to interactions among cells the flow of mass induced by diffusion is calculated for each pair of neighboring cells separately the authors have shown that for such a pair the flowing mass 1d case δ m can be described by the equation 2 δ m 1 2 m i 1 m i 1 e x p 2 d δ x 2 δ t where δ x is cell length δ t is the time step and m i is the mass in the i t h cell in every step of the simulation this procedure should be performed for every neighboring pair i e 1 2 3 4 and 2 3 4 5 for our case 2d grid the situation is analogous the sequence of interaction calculations is as follows arbitrary choice 1 u i 1 u i 2 u i 3 u i 4 u i 5 u i 6 2 u i 0 u i 1 u i 2 u i 3 u i 4 u i 5 3 u 1 j u 2 j u 3 j u 4 j u 5 j u 6 j 4 u 0 j u 1 j u 2 j u 3 j u 4 j u 5 j it should be underlined that we use the von neumann neighborhood the set of all cells that are orthogonally adjacent to the region of interest according to eq 2 the flow of the oil between neighboring cells is determined by masses in these cells in the present model the total mass of an individual cell is the sum of all ops located in the area of interest the dynamics of mass flow δ m is related to variations in the number of ops from one cell to another we point out the key points of the introduced method below for u i j u i j 1 1 the masses of oil in u i j u i j 1 are calculated m i j m i j 1 respectively 2 using eq 2 and m i j m i j 1 δ m is determined if this value is less than 0 there is flow from u i j 1 to u i j otherwise from u i j to u i j 1 3 for the sourcing cell the r δ m m is calculated 4 for every op in the sourcing cell the θ is randomized in the range 0 1 if θ r the op is moved to another cell this procedure is valid under the condition that the thickness of oil film connected with the cell is greater than the terminal thickness which may be estimated by the following formula 3 δ m i n 10 5 v 0 1 4 where δ m i n and v 0 are the final layer thickness and initial value expressed in meters and cubic meters respectively this procedure is not performed if there is only one op in the sourcing cell this would lead only to move oil bulk an increasing area would not be observed as previously mentioned we have to know the form of the spreading diffusion coefficient d to determine this function we rely on fay s spreading theory fay 1971 j a fay divided spreading into three phases each of the phases is determined by preeminent spreading and impedes forces on the slick the first phase gravity inertial is important in the first hour the second phase gravity viscous is important from 1 h to 1 week whereas the third phase viscous surface is dominant after 7 days in our approach we consider the second phase in which the slick area a can be described by the following equation wang et al 1976 4 a 0 98 2 π v 2 g δ ν w 1 2 1 3 t 1 2 where v indicates oil volume g is gravitational acceleration δ is ratio of the density difference between water and oil to the density of water ν w is kinematic viscosity of sea water and t is time of spill the solution of the diffusion equation in one dimension is a gaussian function with a standard deviation σ related to the diffusion coefficient as follows 5 σ 2 d t if we identify the radius of oil which is determined by eq 4 assuming circular propagation with n times standard deviation σ we can obtain 6 d 0 48 n 2 v 2 g δ ν w 1 2 1 3 t 1 2 using the above relationship in each time step and for each pair of cells the value d is determined t is the arithmetic mean between the beginning and end of the time step δ and ν w are calculated as an average of the values calculated for both cells v represents the total current oil volume the value of n hereinafter called the propagation factor can be selected in the calibration process seems to be a reasonable choice 2 4 2 8 evaporation modeling of the evaporation process is required in order to determine the persistence of the spill it is also important for estimation of changes in the physical and chemical properties of oil of course as previously mentioned one of the input data is the composition of oil it is fulfilled by splitting the oil into n components fractions each of these components is characterized by mass fraction molar mass and boiling point evaporation is calculated for each of the fractions separately using the formula taken from tkalin 7 e i k m i p 0 i x i r t where e i is the evaporation rate of the component i k g m 2 s k is the mass transfer coefficient 1 25 10 3 m s m i is molecular weight k g m o l p 0 i is the vapor pressure of the component i p a x i is the mole fraction of component i r is gas constant 8 314 j m o l k and t is temperature k vapor pressure depends on temperature and may be calculated based on the boiling point using the following expression fingas 8 p 0 i 1000 e x p 4 4 l n t b 1 803 t b i t 1 0 803 l n t b i t for an unknown molar mass of component i we can estimate it on the basis of the following relationship winn 1957 9 m i 2 410 10 6 t b i 2 847 ρ 0 ρ w 4 o c 2 130 where ρ w 4 o c is water density at 4 o c and ρ 0 is oil density the molar fraction x i is calculated on the basis of the mass fractions w i and the molar mass m j 10 x i w i m i j 1 n w j m j we can calculate mass for each fraction δ m i which evaporates during the time step δ t by multiple eq 7 by δ t and specific area a 11 δ m i k m i p 0 i x i r t a δ t this equation is applied for each component at each op the temperature t is a value assigned to the cell wherein the op is located the area a is calculated as the area of the cell divided by the number of ops in a given cell after these calculations for each op we can determine the new total mass and the new mass fraction of each components the authors are aware of works approaches where evaporation is limited by the diffusion of compounds within the oil phase to the oil water interface lee et al 2015 however we have finally decided to use the main stream approach 2 9 emulsification droplets of water under the influence of waves can enter into the oil slick this process leads to the formation of water in oil emulsions for the modeling of this phenomenon we use eq 12 taken from sebastiao and guedes soares 1995 12 d y d t k y v w i n d 1 2 1 y c where k y is the parameter equal to 2 0 10 6 y is the content of water in the emulsion mass fraction v w i n d is wind speed m s and c is max content of water in the emulsion which depends on the type of oil about 0 7 mackay et al 1980 we are aware that we apply quite simple approach we apply the parameters according to averaged oil compounds the issue of emulsification is discussed in fingas 2011 in order to adjust eq 12 to our model we have transformed it to the following form 13 δ y k 2 0 10 6 v w i n d 1 2 1 y k c δ t this makes it possible to calculate for each individual op the change of emulsification rate during a time step δ t the value of v w i n d refers to the wind connected with a cell wherein the considered op is located 2 10 changing the oil density as a result of evaporation and emulsification when considering the emulsification process the density of the emulsion ρ e can be approximated as a weighted mean of the initial density of oil ρ 0 and the density of water ρ w the weights are the respective contents mass fraction of oil and water expressed by the percentage of emulsification 14 ρ e 1 y ρ 0 y ρ w the effect of evaporation which is described by the fraction of evaporated mass f on the density of the oil k g m 3 may be expressed by the formula taken from wang et al 2005 bommele 15 ρ 0 6 ρ 0 340 f ρ 0 combining eqs 14 and 15 we can obtain the relationship describing the density of the emulsion as a function of the progress of evaporation and emulsification 16 ρ e 1 y 0 6 ρ 0 340 f ρ 0 y ρ w this equation applies for each op in each time step in order to upgrade the density of the emulsion assigned to the op the values ρ 0 and ρ w depend on temperature in the case of ρ w in each step of simulation density is estimated based on the temperature assigned to a given cell and salinity expressed in p p t the form of this relation is taken from sharqawy et al 2010 on the other hand the function describing the dependency of oil density was taken from state system for ensuring the uniformity of measurements 2 11 natural dispersion natural dispersion is the phenomenon of forming droplets of oil which are able to incorporate into the water column taking into account this process is very important because besides evaporation it is the main factor in removing oil from the sea surface in order to model this phenomenon we have used the approach proposed by reed 1989 and based on mackay s formulation mackay et al 1980 the fraction of oil removed from the surface is calculated as the following product 17 d d a d b where d a is the fraction oil dispersed per hour and d b is dispersed oil which does not return to the surface these quantities are expressed as follows 18 d a 0 11 v w i n d 1 2 19 d b 1 1 50 μ δ s t where v w i n d is speed of wind m s μ is dynamic viscosity c p δ is slick thickness c m and s t is oil water interfacial tension d y n a c m during an oil slick the change of s t is observed we model this change using the simple relation proposed by mackay mackay d paterson 20 s t s t 0 1 f where s t 0 indicates initial interfacial tension whereas f is the fraction of evaporated oil in order to adapt eq 17 to our model we have rewritten it to the following form 21 δ m d y s p m d a d b 3600 δ t where m is the current oil mass assigned to the op and δ m d y s p is oil mass that was removed by dispersion wind speed and thickness needed to calculate d a and d b correspond to the values assigned to the cell in which the piece of oil is located whereas the surface tension and viscosity are the values that characterize a specific op there is a description of viscosity change in a later section 2 12 viscosity change of oil the viscosity of the oil is significantly increased due to the evaporation and emulsification processes we model this change using the formula obtained by sebastiao and guedes soares 1995 22 d μ d t c 2 μ d f d t 2 5 μ 1 c y 2 d y d t where f is the fraction of evaporated oil y is the content of water in emulsion c is the max content of water in emulsion and c 2 is a specific parameter depending on the type of oil 10 for crude oil after replacing derivatives with difference quotients we obtain the formulation below which is applicable in our model 23 δ μ c 2 μ δ f 2 5 μ δ y 1 c y 2 δ f and δ y change of the fraction of evaporation and water content are calculated in the same step the initial value of viscosity is set at the beginning of the simulation 2 13 seashore interaction as a result of advection and spreading some bulks of oil can reach the shoreline the deposited mass may be re entrained into the sea according to shen s study shen et al 1987 we have assumed that the process of returning oil into the sea can be described by first order kinetics this means that the rate of movement of oil from land to sea oil loss of land per unit of time d m d t is proportional to the mass of that currently located on land m 24 d m d t k m the proportionality constant k is dependent on the type of coast in torgrimson 1980 one can find the half life t 1 2 for different types of shoreline the relationship between the rate constant and the half decay time is as follows 25 k l n 2 t 1 2 comparing eqs 24 and 25 we obtain the following expression describing the change of oil mass contained in the shoreline cell which results from a return to the sea during the time step δ t 26 δ m l n 2 t 1 2 m δ t as in the case of the spreading process simulation of oil fluctuation is performed by moving the ops from a coastal cell to a neighboring marine cell with a probability resulting from the ratio of δ m m if the land cell borders with more than one sea cell the op is transferred to the sea cell selected at random 3 model applications based on the analytic formulations which were presented above we have developed a computer program designed to perform simulations of oil spill spreading disasters subsequently we have carried out a set of simulations to verify our model descriptions of input and output data and their interpretations are demonstrated below 3 1 oil properties for our research we have chosen crude oil of the statfjord type this selection resulted from the availability of literature data associated with spills of this kind of oil table 1 created based on jokuty et al 1999 presents the composition of the considered oil other input parameters are given in table 2 the slick was placed in such a location so as not to reach the land 3 2 select the level of discretization before we proceeded to compare simulation results with experimental and other theoretical data we checked the influence of the choice of cell size mass of op and the length of time step on the achieved results slight differences are expected these parameters describe the degree of discretization respectively space matter and time firstly we fixed the time step on 300 s and we performed 11 simulations with various sizes of cells and masses of ops the rate of evaporation was used to assess the effect of the discretization level fig 4 shows the fraction of the evaporated oil as a time function for those 11 simulations analyzing this chart it can be concluded that the choice of these two parameters did not significantly affect the results achieved at the end of the duration of the simulations the maximum differences are about 2 one can note that for a larger cell the evaporation rate is greater 10 m vs 20 m vs 50 m besides in the case of an excessively high op mass to cell size ratio the lowest evaporation ratio is obtained 10 m 1 k g vs 10 m 5 k g or 20 m 2 k g vs 20 m 10 k g simulations confirmed the statement contained in sec 2 7 the mass of the op should be small enough so that at a minimum thickness of oil in a given cell there is more than one op for the adopted minimal oil thickness there is a ratio of the op mass to the cell area above which the results may become unreliable stopping the growth of the oil spill does not arise from the achievement of minimal thickness but from the fact that the cell contains only one op it seems that in order to increase the accuracy of the simulation the reduction of the cell size is required however on the basis of the above considerations such proceedings also require a reduction in the op mass which in turn leads to longer calculation lower op mass greater number of ops it seems that the reasonable choice is the 20 m and 5 k g after preliminary selection of the level of discretization of space and matter we examined how the length of time step affects on results of simulations we have performed simulations for following time step 20 50 100 200 300 600 1000 s figs 5 8 present the rate of evaporation and natural dispersion as well as changes in the density and viscosity of oil the influence of the length of the time step on the simulation results are as follows for the evaporation process fig 5 monotonic dependency is obtained a shorter time step smaller values of evaporated mass for the times 20 s 50 s and 100 s the differences are not visible it can be concluded that the maximum acceptable length of time step is 300 s unlike the former in the case of the natural dispersion process fig 6 the monotonic dependency is unnoticed however the differences are negligible at the end of the simulation extreme values vary by about 0 5 the density of oil at any time fig 7 as a percentage of the evaporated oil is larger for a longer time step the differences are minuscule for a length of time step less than 300 s the greatest impact of the time step on the obtained results is observed in the case of testing viscosity changes fig 8 the observed relationship is monotonic a decrease in time step length causes an increase in viscosity looking globally at the results it seems that 300 s is the maximum length of time step which can be used for the error resulting from discretization of time to be acceptable here it should be noted that certain passages of the model are probabilistic therefore we have checked the repeatability of the results and have found that all the investigated quantities are almost identical each time 3 3 comparison with experimental and theoretical data we have performed simulation with the parameters selected based on considerations included in previous sections cell size 20 m mass of op 5 k g time step 20 s our outcomes were compared with experimental data taken from buchanan and hurford 1988 and other theoretical results derived from sebastiao and guedes soares 1995 and obtained using the adios2 program adios fig 9 shows the time dependence of selected properties our results connected with the evaporation process comply with experimental and adios2 data in the case of the natural dispersion process reference was made only to the results of adios2 lack of relevant experimental data significant differences were observed for adios2 outcomes such phenomena stop after about a day whereas our model predicts a substantially longer duration of this process such behavior seems more credible a thin layer of oil breaks up into tiny spots which is a factor facilitating the penetration of oil into water in the case of oil density change these three models provide similar results rapid growth in the first several hours and then only a small increase in the value experimental data show that the density significantly increased in the initial phase and then remained more or less constant slight fluctuations may result from changes in temperature if these changes were known it would be possible to take them into account in the presented model this is not possible in the other two the model gives slightly lower values of dynamic viscosity than other theoretical predictions and experimental data this is related to the length of time step for 5 s the results are much closer the content of water in emulsion obtained from our model and the model sebastiao and guedes soares 1995 are more similar to the experimental than adios2 outcomes which are overstated 3 4 deepwater horizon oil spill the deepwater horizon oil spill appeared in the gulf of mexico released oil from april 20th 2010 boufadel et al 2014 it was the largest marine oil spill in history we have prepared exemplary tests of our model in comparison to real data from the oil spill the results of the comparison are presented in fig 10 during our tests we have used following data cell size 200 m time step 1 200 s initial mass of an op 50 kg we have assumed that the oil spill took place continuously 15 000 barrels per day as input we applied wind data from dr yonggang liu ocean circulation group obtained from drifters and ocean currents data from goods service april 20th april 25 2013 it should be emphasized that our dwh simulation is only a preliminary verification we would like to demonstrate approximately that the model s outcomes namely oil imprint on the water surface resembles reality the results obtained suggest that our model reproduces correctly advection as well as spreading processes 3 5 advection process this model in contrast to many existing solutions takes into account the advection in the predictions of chemical and physical properties this process depends on the winds and currents it should be stressed that wind and temperature primarily affect the properties tested in the preceding sections hence in the case of uniform wind and temperature fields which practically is not uncommon advection should not be a significant influence on the considered processes we have confirmed this conclusion by performing some simulations with and without taking advection into account the differences turned out to be irrelevant in such a situation it is possible to run two independent simulations the first one to estimate changes in properties and the second one to predict the motion of oil slicks this approach allows users to save time in the event that heterogeneity of external conditions is not negligible a full simulation should be performed in simulating the movement of a slick the most important aspect is the knowledge of sea currents in the case of their good approximation the model very accurately predicts the location of the oil this is associated with the division of oil into pieces whose motion is due to the presence of a current at a specific time and place one of the ways for estimating the distribution of currents is to use the pom model princeton ocean model model the results obtained in this way can be used in the created model our computer program is designed to gather environmental conditions from external sources 4 conclusions in this study we have created a model describing the spread of oil pollution on the sea surface it enables the main processes occurring during such a disaster advection emulsification evaporation and natural dispersion to be created as well as interaction with different types of shoreline this model is based on the discretization of the simulated matter lagrangian discrete particle algorithm it also uses methodologies familiar with the cellular automata approach the combination of these two methods is innovative and allows to obtain more accurate results an important advantage of the model is the possibility of taking into account inhomogeneities in space and the instability at the time of the atmospheric conditions another benefit is the determination of the state of oil both globally slick taken as a whole and locally in a specific place using this model we have developed a computer program allowing users to perform simulations of the studied phenomena this program provides an easy way to set the initial conditions influence the course of the simulation e g by changing weather conditions and visualization of the obtained results the outcomes of the conducted simulations were compared with other theoretical and experimental data the good agreement received proved the usefulness of our approach acknowledgment we would like to express our gratitude to dr yonggang liu from ocean circulation group for sharing with us oil spill surface and wind data as well as goods service and ncomr https gnome orr noaa gov goods for providing ocean currents data we acknowledge that this research is partially supported by agh university of science and technology complex systems modeling 11 11 120 859 
23465,a model for simulating oil spills in seas is presented in this study the effects of winds sea currents evaporation emulsification natural dispersion and seashore interaction have been taken into account a significant advantage of the model is the possibility of taking into account inhomogeneities in space and the instability at the time of the atmospheric conditions this model enables the determination of the actual state of oil including its density composition and viscosity etc in both a global as well as a local in any point of space meaning the frame of the model is based on the discrete particle methodology to improve the spreading process description cellular automata approach is also applied a few simulations of oil spills have been performed and described the results are compared with experimental data and other theoretical outcomes a high level of accordance is obtained without the necessity of fitting particular parameters keywords oil spills numerical models 1 introduction oil spills occurring especially during damage to tankers or offshore rigs are particularly catastrophic for coastal and marine environments mitsch 2010 additionally they can cause serious losses in fishery and tourism therefore there is a strong necessity to model the time evolution of such spreading processes the quantities to be determined encompass the rates of changes in the physical and chemical properties of oil as well as the rate of its natural removal we expect the model to return the anticipated evolution of oil spills thereby enabling appropriate actions aimed at minimizing the effects of disasters for the above reasons many models making it possible to simulate these incidents have been developed over the last decades among the available reviews the following papers deserve special attention huang 1983 reed et al 1999 spaulding 1988 one can point out following computer programs for performing oil spill simulations adios2 adios oil spill condindency and response oscar general noaa oil modeling environment beegle krause and medslik ii the course of oil spills at sea is governed by chemical physical and biological processes which are dependent on both oil properties composition density and viscosity etc and external conditions temperature wind sea current pressure and salinity etc among these processes the most important are evaporation natural dispersion emulsification advection spreading and interaction of oil slicks with the shoreline effects of secondary significance may be distinguished as photolysis sedimentation biodegradation and dissolution a schematic diagram shown in fig 1 demonstrates these phenomena to construct a reliable model each of the listed effects should be described by a mathematical formula in section 2 6 we have included comments on different possible approaches to the modeling of the considered processes 2 model 2 1 motivation in the case of the division of crude oil into parts discrete method it is relatively simple to model the advection process by creating a certain velocity field resulting from the sea currents and winds however it is problematic to calculate the correlations between the pieces this causes difficulty in describing of the spreading oil spill process idea of application of cellular automata to some extent solves this problem such application was proposed in an interesting article by karafyllidis 1997 and its follow up by vourkas and sirakoulis including among other fpga implementation and finally 3d ca implementation by rusinovic and bogunovic 2006 in that works environmental conditions can be changed independently in such cases the main disadvantage is the proper simulation of the advection process the probability of inaccuracies is unfortunately large thus after the analysis we decided to work out a solution of connecting langrangian discrete particle algorithm with cellular automata approach regarding spreading oil process we have decided to base on fay s spreading theory fay 1971 however we believe that proposed discrete framework is convenient in high performance computations detailed description of the proposed method is presented in section 2 7 2 2 overview in our model an oil bulk is divided into a large number of small particles oil particle op with assigned initial parameters such as mass density and composition etc the physical space sea coast is divided into square cells every oil particle moves with a certain discrete velocities field related with cell division a velocity vector is assigned to every cell and resulting from the presence of sea currents and winds individual oil particles may be subject to processes such as evaporation emulsification and dispersion whose intensity depends on the external condition assignment to the cell wherein the op is located in order to include correlation between movement of the op the cellular automata ca approach was applied in the model 2 3 physical space representation the simulated area is described by the two dimensional cartesian coordinate system x y additionally it is covered by a grid that divides space into square cells of a length hence the space is discretized i e a square with coordinates x j a j 1 a and y i a i 1 a is assigned to the cell with i j indexes fig 2 each cell may either represent the sea or land the applied division strategy reflects the necessity of taking into account varying external conditions such as temperature winds and sea current these quantities hereinafter referred to as cell external variables cev are set as initial values the model also enables changes in course during the simulation additionally each of the cells is characterized by cell internal variables civ such as thickness of the oil layer water content etc which result from the properties of ops currently located in a specific cell 2 4 oil representation as mentioned previously the oil is discretized by division into identical particles op the mass of every op is adjusted before the start of the simulation each op possesses actual coordinates that allow it to be assigned to a proper cell the motion of the op results from the advection and spreading processes in addition to migration the op can be modified by changes in mass water content volume evaporation and dispersion rate these properties are referred to as oil point state ops based on the ops of every op in the cell the civ is calculated 2 5 data flow fig 3 shows a simplified data flow diagram based on the model the simulation is propagated in time with finite time step δ t the following paragraphs briefly describe individual phases marked on the diagram start of simulation the basic input data for our model is the topography of the area thus it is possible to assign the type sea or land to the cells before starting the simulation one must also enter parameters describing the oil such as density 15 o c viscosity surface tension and composition in addition it is required to set the initial mass value for a single piece of oil oil properties are constant within the simulation change of cev length of time step during each simulation step it is possible to change the cev moreover the length of the time step can be modified adding oil to the selected cells it is possible to add the mass of oil m to the selected cell i j in such a case the portion of oil is divided into n ops n m m k the coordinates of every op are chosen to be consistent with the i j cell randomly with uniform distribution the implementation allows total freedom in spatial choice of the cell therefore it s feasible to simulate oil leaks located at any source at any time additionally the option of multiple oil sources is included modification of ops for each op the new state ops is calculated through the modeling of emulsification evaporation dispersion change in density and viscosity change in op coordinates the op coordinates in the next time step are determined by simulating diffusion advection and seashore interaction assignment ops to cells as a result of the processes from the previous paragraph part of the op may be moved to other cells thus for each time step and each cell a list of all ops associated with the chosen cell is built increasing the total simulation time the time of the simulation is incremented by the current length of the time step calculation of civ for every cell the civ is calculated according to the list of ops assigned to this cell the function represents the output of our algorithm it indicates the state of the oil at a specific region at a specific time stopping condition the basic terminating condition for the present simulation is to exceed the fixed time limit the iterations continue until the time limit is reached 2 6 modeling of physical processes the previous sections provide basic information about the design of our model in this paragraph we describe our approach to the modeling of the relevant physical processes 2 6 1 advection advection is the transport mechanism of a substance by a fluid due to the fluid s bulk motion in the case of oil spills advection can be considered as the drift of oil induced by sea currents an additional factor affecting the motion of the oil is wind in the model we have adopted a uniform linear approximation for the description of the motion of an op similar approach was used in models al rabeh and cekirge wang and shen its velocity is the result of a linear combination of wind and current velocities related to a particular cell hence the advection displacement of the op located at the start of the k th iteration in the i j cell can be expressed as 1 δ r k α v k c u r r e n t i j β v k w i n d i j δ t k where v k c u r r e n t i j v k w i n d i j are vectors of current and wind velocities in the k t h iteration in the i j cell δ t k is the length of a time step the symbols α and β denote parameters chosen to be 1 1 wang et al 2005 and 3 according to boufadel et al 2014 respectively it should be stressed that applied value β and whole approach is correct for consideration a quiescent sea in the presence of waves and langmuir cells spreading due to surface tension becomes negligible boufadel et al 2006 and geng et al 2016 2 7 spreading the spreading process can be modeled as an increase in the area of oil with a simultaneous decrease in its layer thickness in the case of a discrete particle approach the modeling of this phenomenon should rely on the appropriate displacement of the ops in contrast to the advection process it is necessary to consider correlations between ops the spreading motion of an individual op is dependent on the positions of other ops in order to quantify model this process we have treated it in analogy to diffusion however it should be noted that spreading can not be strictly identified with diffusion this was confirmed by simulations reported in ao ieong et al which show that the diffusion with a reliable diffusion coefficient has no effect on the growth oil area nevertheless for a deliberated choice of the spreading diffusion coefficient d which can be a function of oil state the spreading process may be modeled in a way similar to diffusion the current paragraph comprises the adopted strategy the present formulation requires knowledge of the d function whose form is included hereafter we have used the diffusion modeling approach introduced by vick 2007 the method introduced therein is based on cellular automata the main idea lies within the specific way of referring to interactions among cells the flow of mass induced by diffusion is calculated for each pair of neighboring cells separately the authors have shown that for such a pair the flowing mass 1d case δ m can be described by the equation 2 δ m 1 2 m i 1 m i 1 e x p 2 d δ x 2 δ t where δ x is cell length δ t is the time step and m i is the mass in the i t h cell in every step of the simulation this procedure should be performed for every neighboring pair i e 1 2 3 4 and 2 3 4 5 for our case 2d grid the situation is analogous the sequence of interaction calculations is as follows arbitrary choice 1 u i 1 u i 2 u i 3 u i 4 u i 5 u i 6 2 u i 0 u i 1 u i 2 u i 3 u i 4 u i 5 3 u 1 j u 2 j u 3 j u 4 j u 5 j u 6 j 4 u 0 j u 1 j u 2 j u 3 j u 4 j u 5 j it should be underlined that we use the von neumann neighborhood the set of all cells that are orthogonally adjacent to the region of interest according to eq 2 the flow of the oil between neighboring cells is determined by masses in these cells in the present model the total mass of an individual cell is the sum of all ops located in the area of interest the dynamics of mass flow δ m is related to variations in the number of ops from one cell to another we point out the key points of the introduced method below for u i j u i j 1 1 the masses of oil in u i j u i j 1 are calculated m i j m i j 1 respectively 2 using eq 2 and m i j m i j 1 δ m is determined if this value is less than 0 there is flow from u i j 1 to u i j otherwise from u i j to u i j 1 3 for the sourcing cell the r δ m m is calculated 4 for every op in the sourcing cell the θ is randomized in the range 0 1 if θ r the op is moved to another cell this procedure is valid under the condition that the thickness of oil film connected with the cell is greater than the terminal thickness which may be estimated by the following formula 3 δ m i n 10 5 v 0 1 4 where δ m i n and v 0 are the final layer thickness and initial value expressed in meters and cubic meters respectively this procedure is not performed if there is only one op in the sourcing cell this would lead only to move oil bulk an increasing area would not be observed as previously mentioned we have to know the form of the spreading diffusion coefficient d to determine this function we rely on fay s spreading theory fay 1971 j a fay divided spreading into three phases each of the phases is determined by preeminent spreading and impedes forces on the slick the first phase gravity inertial is important in the first hour the second phase gravity viscous is important from 1 h to 1 week whereas the third phase viscous surface is dominant after 7 days in our approach we consider the second phase in which the slick area a can be described by the following equation wang et al 1976 4 a 0 98 2 π v 2 g δ ν w 1 2 1 3 t 1 2 where v indicates oil volume g is gravitational acceleration δ is ratio of the density difference between water and oil to the density of water ν w is kinematic viscosity of sea water and t is time of spill the solution of the diffusion equation in one dimension is a gaussian function with a standard deviation σ related to the diffusion coefficient as follows 5 σ 2 d t if we identify the radius of oil which is determined by eq 4 assuming circular propagation with n times standard deviation σ we can obtain 6 d 0 48 n 2 v 2 g δ ν w 1 2 1 3 t 1 2 using the above relationship in each time step and for each pair of cells the value d is determined t is the arithmetic mean between the beginning and end of the time step δ and ν w are calculated as an average of the values calculated for both cells v represents the total current oil volume the value of n hereinafter called the propagation factor can be selected in the calibration process seems to be a reasonable choice 2 4 2 8 evaporation modeling of the evaporation process is required in order to determine the persistence of the spill it is also important for estimation of changes in the physical and chemical properties of oil of course as previously mentioned one of the input data is the composition of oil it is fulfilled by splitting the oil into n components fractions each of these components is characterized by mass fraction molar mass and boiling point evaporation is calculated for each of the fractions separately using the formula taken from tkalin 7 e i k m i p 0 i x i r t where e i is the evaporation rate of the component i k g m 2 s k is the mass transfer coefficient 1 25 10 3 m s m i is molecular weight k g m o l p 0 i is the vapor pressure of the component i p a x i is the mole fraction of component i r is gas constant 8 314 j m o l k and t is temperature k vapor pressure depends on temperature and may be calculated based on the boiling point using the following expression fingas 8 p 0 i 1000 e x p 4 4 l n t b 1 803 t b i t 1 0 803 l n t b i t for an unknown molar mass of component i we can estimate it on the basis of the following relationship winn 1957 9 m i 2 410 10 6 t b i 2 847 ρ 0 ρ w 4 o c 2 130 where ρ w 4 o c is water density at 4 o c and ρ 0 is oil density the molar fraction x i is calculated on the basis of the mass fractions w i and the molar mass m j 10 x i w i m i j 1 n w j m j we can calculate mass for each fraction δ m i which evaporates during the time step δ t by multiple eq 7 by δ t and specific area a 11 δ m i k m i p 0 i x i r t a δ t this equation is applied for each component at each op the temperature t is a value assigned to the cell wherein the op is located the area a is calculated as the area of the cell divided by the number of ops in a given cell after these calculations for each op we can determine the new total mass and the new mass fraction of each components the authors are aware of works approaches where evaporation is limited by the diffusion of compounds within the oil phase to the oil water interface lee et al 2015 however we have finally decided to use the main stream approach 2 9 emulsification droplets of water under the influence of waves can enter into the oil slick this process leads to the formation of water in oil emulsions for the modeling of this phenomenon we use eq 12 taken from sebastiao and guedes soares 1995 12 d y d t k y v w i n d 1 2 1 y c where k y is the parameter equal to 2 0 10 6 y is the content of water in the emulsion mass fraction v w i n d is wind speed m s and c is max content of water in the emulsion which depends on the type of oil about 0 7 mackay et al 1980 we are aware that we apply quite simple approach we apply the parameters according to averaged oil compounds the issue of emulsification is discussed in fingas 2011 in order to adjust eq 12 to our model we have transformed it to the following form 13 δ y k 2 0 10 6 v w i n d 1 2 1 y k c δ t this makes it possible to calculate for each individual op the change of emulsification rate during a time step δ t the value of v w i n d refers to the wind connected with a cell wherein the considered op is located 2 10 changing the oil density as a result of evaporation and emulsification when considering the emulsification process the density of the emulsion ρ e can be approximated as a weighted mean of the initial density of oil ρ 0 and the density of water ρ w the weights are the respective contents mass fraction of oil and water expressed by the percentage of emulsification 14 ρ e 1 y ρ 0 y ρ w the effect of evaporation which is described by the fraction of evaporated mass f on the density of the oil k g m 3 may be expressed by the formula taken from wang et al 2005 bommele 15 ρ 0 6 ρ 0 340 f ρ 0 combining eqs 14 and 15 we can obtain the relationship describing the density of the emulsion as a function of the progress of evaporation and emulsification 16 ρ e 1 y 0 6 ρ 0 340 f ρ 0 y ρ w this equation applies for each op in each time step in order to upgrade the density of the emulsion assigned to the op the values ρ 0 and ρ w depend on temperature in the case of ρ w in each step of simulation density is estimated based on the temperature assigned to a given cell and salinity expressed in p p t the form of this relation is taken from sharqawy et al 2010 on the other hand the function describing the dependency of oil density was taken from state system for ensuring the uniformity of measurements 2 11 natural dispersion natural dispersion is the phenomenon of forming droplets of oil which are able to incorporate into the water column taking into account this process is very important because besides evaporation it is the main factor in removing oil from the sea surface in order to model this phenomenon we have used the approach proposed by reed 1989 and based on mackay s formulation mackay et al 1980 the fraction of oil removed from the surface is calculated as the following product 17 d d a d b where d a is the fraction oil dispersed per hour and d b is dispersed oil which does not return to the surface these quantities are expressed as follows 18 d a 0 11 v w i n d 1 2 19 d b 1 1 50 μ δ s t where v w i n d is speed of wind m s μ is dynamic viscosity c p δ is slick thickness c m and s t is oil water interfacial tension d y n a c m during an oil slick the change of s t is observed we model this change using the simple relation proposed by mackay mackay d paterson 20 s t s t 0 1 f where s t 0 indicates initial interfacial tension whereas f is the fraction of evaporated oil in order to adapt eq 17 to our model we have rewritten it to the following form 21 δ m d y s p m d a d b 3600 δ t where m is the current oil mass assigned to the op and δ m d y s p is oil mass that was removed by dispersion wind speed and thickness needed to calculate d a and d b correspond to the values assigned to the cell in which the piece of oil is located whereas the surface tension and viscosity are the values that characterize a specific op there is a description of viscosity change in a later section 2 12 viscosity change of oil the viscosity of the oil is significantly increased due to the evaporation and emulsification processes we model this change using the formula obtained by sebastiao and guedes soares 1995 22 d μ d t c 2 μ d f d t 2 5 μ 1 c y 2 d y d t where f is the fraction of evaporated oil y is the content of water in emulsion c is the max content of water in emulsion and c 2 is a specific parameter depending on the type of oil 10 for crude oil after replacing derivatives with difference quotients we obtain the formulation below which is applicable in our model 23 δ μ c 2 μ δ f 2 5 μ δ y 1 c y 2 δ f and δ y change of the fraction of evaporation and water content are calculated in the same step the initial value of viscosity is set at the beginning of the simulation 2 13 seashore interaction as a result of advection and spreading some bulks of oil can reach the shoreline the deposited mass may be re entrained into the sea according to shen s study shen et al 1987 we have assumed that the process of returning oil into the sea can be described by first order kinetics this means that the rate of movement of oil from land to sea oil loss of land per unit of time d m d t is proportional to the mass of that currently located on land m 24 d m d t k m the proportionality constant k is dependent on the type of coast in torgrimson 1980 one can find the half life t 1 2 for different types of shoreline the relationship between the rate constant and the half decay time is as follows 25 k l n 2 t 1 2 comparing eqs 24 and 25 we obtain the following expression describing the change of oil mass contained in the shoreline cell which results from a return to the sea during the time step δ t 26 δ m l n 2 t 1 2 m δ t as in the case of the spreading process simulation of oil fluctuation is performed by moving the ops from a coastal cell to a neighboring marine cell with a probability resulting from the ratio of δ m m if the land cell borders with more than one sea cell the op is transferred to the sea cell selected at random 3 model applications based on the analytic formulations which were presented above we have developed a computer program designed to perform simulations of oil spill spreading disasters subsequently we have carried out a set of simulations to verify our model descriptions of input and output data and their interpretations are demonstrated below 3 1 oil properties for our research we have chosen crude oil of the statfjord type this selection resulted from the availability of literature data associated with spills of this kind of oil table 1 created based on jokuty et al 1999 presents the composition of the considered oil other input parameters are given in table 2 the slick was placed in such a location so as not to reach the land 3 2 select the level of discretization before we proceeded to compare simulation results with experimental and other theoretical data we checked the influence of the choice of cell size mass of op and the length of time step on the achieved results slight differences are expected these parameters describe the degree of discretization respectively space matter and time firstly we fixed the time step on 300 s and we performed 11 simulations with various sizes of cells and masses of ops the rate of evaporation was used to assess the effect of the discretization level fig 4 shows the fraction of the evaporated oil as a time function for those 11 simulations analyzing this chart it can be concluded that the choice of these two parameters did not significantly affect the results achieved at the end of the duration of the simulations the maximum differences are about 2 one can note that for a larger cell the evaporation rate is greater 10 m vs 20 m vs 50 m besides in the case of an excessively high op mass to cell size ratio the lowest evaporation ratio is obtained 10 m 1 k g vs 10 m 5 k g or 20 m 2 k g vs 20 m 10 k g simulations confirmed the statement contained in sec 2 7 the mass of the op should be small enough so that at a minimum thickness of oil in a given cell there is more than one op for the adopted minimal oil thickness there is a ratio of the op mass to the cell area above which the results may become unreliable stopping the growth of the oil spill does not arise from the achievement of minimal thickness but from the fact that the cell contains only one op it seems that in order to increase the accuracy of the simulation the reduction of the cell size is required however on the basis of the above considerations such proceedings also require a reduction in the op mass which in turn leads to longer calculation lower op mass greater number of ops it seems that the reasonable choice is the 20 m and 5 k g after preliminary selection of the level of discretization of space and matter we examined how the length of time step affects on results of simulations we have performed simulations for following time step 20 50 100 200 300 600 1000 s figs 5 8 present the rate of evaporation and natural dispersion as well as changes in the density and viscosity of oil the influence of the length of the time step on the simulation results are as follows for the evaporation process fig 5 monotonic dependency is obtained a shorter time step smaller values of evaporated mass for the times 20 s 50 s and 100 s the differences are not visible it can be concluded that the maximum acceptable length of time step is 300 s unlike the former in the case of the natural dispersion process fig 6 the monotonic dependency is unnoticed however the differences are negligible at the end of the simulation extreme values vary by about 0 5 the density of oil at any time fig 7 as a percentage of the evaporated oil is larger for a longer time step the differences are minuscule for a length of time step less than 300 s the greatest impact of the time step on the obtained results is observed in the case of testing viscosity changes fig 8 the observed relationship is monotonic a decrease in time step length causes an increase in viscosity looking globally at the results it seems that 300 s is the maximum length of time step which can be used for the error resulting from discretization of time to be acceptable here it should be noted that certain passages of the model are probabilistic therefore we have checked the repeatability of the results and have found that all the investigated quantities are almost identical each time 3 3 comparison with experimental and theoretical data we have performed simulation with the parameters selected based on considerations included in previous sections cell size 20 m mass of op 5 k g time step 20 s our outcomes were compared with experimental data taken from buchanan and hurford 1988 and other theoretical results derived from sebastiao and guedes soares 1995 and obtained using the adios2 program adios fig 9 shows the time dependence of selected properties our results connected with the evaporation process comply with experimental and adios2 data in the case of the natural dispersion process reference was made only to the results of adios2 lack of relevant experimental data significant differences were observed for adios2 outcomes such phenomena stop after about a day whereas our model predicts a substantially longer duration of this process such behavior seems more credible a thin layer of oil breaks up into tiny spots which is a factor facilitating the penetration of oil into water in the case of oil density change these three models provide similar results rapid growth in the first several hours and then only a small increase in the value experimental data show that the density significantly increased in the initial phase and then remained more or less constant slight fluctuations may result from changes in temperature if these changes were known it would be possible to take them into account in the presented model this is not possible in the other two the model gives slightly lower values of dynamic viscosity than other theoretical predictions and experimental data this is related to the length of time step for 5 s the results are much closer the content of water in emulsion obtained from our model and the model sebastiao and guedes soares 1995 are more similar to the experimental than adios2 outcomes which are overstated 3 4 deepwater horizon oil spill the deepwater horizon oil spill appeared in the gulf of mexico released oil from april 20th 2010 boufadel et al 2014 it was the largest marine oil spill in history we have prepared exemplary tests of our model in comparison to real data from the oil spill the results of the comparison are presented in fig 10 during our tests we have used following data cell size 200 m time step 1 200 s initial mass of an op 50 kg we have assumed that the oil spill took place continuously 15 000 barrels per day as input we applied wind data from dr yonggang liu ocean circulation group obtained from drifters and ocean currents data from goods service april 20th april 25 2013 it should be emphasized that our dwh simulation is only a preliminary verification we would like to demonstrate approximately that the model s outcomes namely oil imprint on the water surface resembles reality the results obtained suggest that our model reproduces correctly advection as well as spreading processes 3 5 advection process this model in contrast to many existing solutions takes into account the advection in the predictions of chemical and physical properties this process depends on the winds and currents it should be stressed that wind and temperature primarily affect the properties tested in the preceding sections hence in the case of uniform wind and temperature fields which practically is not uncommon advection should not be a significant influence on the considered processes we have confirmed this conclusion by performing some simulations with and without taking advection into account the differences turned out to be irrelevant in such a situation it is possible to run two independent simulations the first one to estimate changes in properties and the second one to predict the motion of oil slicks this approach allows users to save time in the event that heterogeneity of external conditions is not negligible a full simulation should be performed in simulating the movement of a slick the most important aspect is the knowledge of sea currents in the case of their good approximation the model very accurately predicts the location of the oil this is associated with the division of oil into pieces whose motion is due to the presence of a current at a specific time and place one of the ways for estimating the distribution of currents is to use the pom model princeton ocean model model the results obtained in this way can be used in the created model our computer program is designed to gather environmental conditions from external sources 4 conclusions in this study we have created a model describing the spread of oil pollution on the sea surface it enables the main processes occurring during such a disaster advection emulsification evaporation and natural dispersion to be created as well as interaction with different types of shoreline this model is based on the discretization of the simulated matter lagrangian discrete particle algorithm it also uses methodologies familiar with the cellular automata approach the combination of these two methods is innovative and allows to obtain more accurate results an important advantage of the model is the possibility of taking into account inhomogeneities in space and the instability at the time of the atmospheric conditions another benefit is the determination of the state of oil both globally slick taken as a whole and locally in a specific place using this model we have developed a computer program allowing users to perform simulations of the studied phenomena this program provides an easy way to set the initial conditions influence the course of the simulation e g by changing weather conditions and visualization of the obtained results the outcomes of the conducted simulations were compared with other theoretical and experimental data the good agreement received proved the usefulness of our approach acknowledgment we would like to express our gratitude to dr yonggang liu from ocean circulation group for sharing with us oil spill surface and wind data as well as goods service and ncomr https gnome orr noaa gov goods for providing ocean currents data we acknowledge that this research is partially supported by agh university of science and technology complex systems modeling 11 11 120 859 
23466,a better understanding of physical process of the fluid seabed structure interaction fssi is beneficial for engineers involved in the design of marine infrastructures most previous studies for the problem of fssi have considered wave only conditions despite the co existence of wave and current in the real ocean environment unlike the previous studies currents are included in the present study for the numerical modelling of fssi using an integrated fvm fem scheme in which the varans equation is used to simulate fluid field while biot s poro elastic model is used for porous flow in a seabed numerical examples show the important influences of currents on the local hydrodynamic process and the resulting dynamics of seabed foundation around a submerged rubble mound breakwater the structure is relatively stable in the presence of counter current waves whereas the co current waves would significantly compromise the instability of structure due to potential of shear failure and liquefaction in its sandy seabed foundation keywords fluid seabed structure interactions fssi varans equation biot s theory co existence of wave and currents submerged breakwater momentary liquefaction 1 introduction protection of coastal zone has become a priority for coastal communities in the last few decades submerged breakwaters which are advantageous in terms of environmental considerations have been commonly constructed in the offshore regions to enhance the utility of coastlines one of the main concerns involved in the design of submerged breakwaters is the dynamic response of its underlying soil layers due to ocean wave loading this is particularly important for the evaluation of the stability of a marine infrastructure during the entire design life oumeraci 1994 jeng 2013 sumer 2014 a large number of studies for the dynamic soil response around marine structures have been conducted for years mainly involving analytical approximations hsu and jeng 1994 jeng 1996 jeng and ou 2010 numerical modeling jeng 2003 ulker et al 2010 or laboratory experiments sumer et al 2008 kirca et al 2013 among these an analytical approximation is an efficient tool in the early stage due to its simplicity and low computational cost it also rises the difficulty in handling the complex boundary value problems as such the configuration of structure considered in the analytical approximations is normally oversimplified and far from the realistic situations compared to the analytical solutions numerical modeling is more flexible in terms of geometrical complexities jeng 2003 developed a generalized fem model by introducing the complex into biot s equations and applying the galerkin method in which all wave induced soil response parameters were to fluctuate periodically in the time domain this model was reported to have been used in two applications wave seabed pipeline interactions jeng et al 2001b and wave seabed caisson interactions jeng et al 2001a ulker et al 2010 developed a fem model to study the elastic seabed underneath a caisson breakwater for three different biot s formulations the quasi static partially dynamic and fully dynamic they concluded that for the frequency range of loading of the seabed underneath a breakwater induced by the structural rocking motions the fully dynamic formulation should be considered in the aforementioned investigations analytical solutions are used as pressure boundary conditions whereas potential flow theory is incapable of capturing the local hydrodynamic processes involved in the fluid structure interactions in many aspects i e contraction of flow vortex shedding turbulence generation and wave breaking in fact computational fluid dynamics cfd models for fluid structure interactions is a relatively mature research project that has been intensively developed before lin and liu 1998 lara et al 2006 in which structures were considered to be fixed or flexible with porous media being considered as non deformable body that has added resistance to fluid flow in these investigations the use of navier stokes equation with an eulerian framework has proven to be useful in reproducing local hydrodynamic processes and is highly accurate from this point of view recent models have been developed as an integrated system in which the cfd models and geotechnical models are semi coupled through pressure continuity at common boundaries or other ways the use of advanced computational fluid dynamics in these multi physics models enhances the understanding of fssi in many cases i e breaking wave impacts on caisson and subsequently on the foundation ye et al 2014 elsafti and oumeraci 2017 porosity of structure on wave field and subsequently dynamics of their seabed foundation hur et al 2010 zhang et al 2011 most previous investigations for the wave seabed interactions around marine structures have considered wave only conditions however in the realistic oceanic environments the propagation of ocean waves is usually accompanied with currents the presence of currents may be further complicate the wave transformations around the structure and the subsequent dynamics of underlying soil layers that are intensively related to the stability of structure to better understand the physical process involved in the wave current seabed structure interactions an integrated fvm fem model is developed in this study by semi coupling the varans equation and biot s poro elastic solution through pressure continuity at the fluid porous material interfaces the proposed model will be validated by comparing with the previous experimental data first both the hydrodynamic and geotechnical process associated with the fluid soil submerged breakwater interactions will be examined finally the influence of the key parameters on the seabed instability around a structure will be quantified through parametric studies 2 numerical model 2 1 geotechnical model in general geomaterials selected as foundations for coastal and offshore structures are inherently heterogeneous which basically consisting of a solid phase with soil skeleton and a fluid phase with water and air herein a 2 d geotechnical model is developed in which the u p approximation zienkiewicz et al 1980 also known as partially dynamic equation ulker et al 2009 is employed the governing equations for a porous flow can be expressed as the follows 1 σ x x τ x z z p s x ρ 2 u t 2 2 τ x z x σ z z ρ g p s z ρ w 2 t 2 3 k s 2 p s γ w n s β s p s t k s ρ f 2 ε s t 2 γ w ε s t where p s is the pore water pressure u s and w s represent the horizontal and vertical components of soil displacements σ x and σ z are the horizontal and vertical components of effective normal stresses respectively τ x z is the shear stress n s is the porosity of soil γ w is the unit weight of pore water ρ n s ρ f 1 n s ρ s is the average density of porous medium k s is the darcy s permeability coefficient which should be the same in all directions for isotropic porous seabed considered in this study in 1 volumetric strain ε s and compressibility of pore fluid β s and are defined as 4 ε s u s x w s z β s 1 k f 1 s r p w 0 in which p w 0 is the absolute static pressure and k f is the bulk modulus of the pore water which is taken as 1 95 109 n m2 for pore water yamamoto et al 1978 s r is the degree of saturation in this study linear reversible soil behavior is considered this assumption has been commonly used in the previous studies for the transient analysis of seabed response and gave satisfactory results hsu and jeng 1994 ulker and rahman 2009 ulker et al 2010 under plain strain conditions the stress strain relationship can be expressed as the follows 5 σ x 2 g u s x μ 1 2 μ ε s 6 σ z 2 g w s z μ 1 2 μ ε s 7 τ x z g u s z w s x τ z x where g is the shear modulus of soil it is noted that a compressive normal stress is taken as a positive sign the finite element method is used to solve the above governing equations 1 3 based on the platform of diana swandyne ii chan 1988 the single step generalized newmark scheme is adopted to integrate the above discretized matrix equations in the time domain more details about the numerical scheme for spatial and temporal discretization can be found in chan 1988 2 2 hydrodynamic model in this study based on the varans equations an fvm hydrodynamic model developed in the open source cfd toolbox openfoam version 2 3 0 jesus et al 2012 is employed to simulate the fluid structure interactions in the presence of uniformed current the equations governing the two phase incompressible flow motion including the conservation of mass and momentum can be expressed as follows 8 u i x i 0 9 ρ f u i t x j 1 n ρ f u i u j n p f x i n g j x j ρ f x i x j μ e f f u i x j c t in which u i denotes the darcy velocity n is the porosity of rubble mound ρ f is the density of fluid p is the pseudo dynamic pressure g is the acceleration of gravity x is the position vector μ e f f is the efficient dynamic viscosity u c is relative velocity field and f stand for darcy s volume averaging operator and the intrinsic averaging operator respectively in 9 the last component representing the resistance of the porous media can be expressed as 10 c t a u i b u u i 0 34 u i t where the closure term ct is the hydraulic gradient a and b are empirical drag force coefficients which can be determined based on the theoretical works frank 1953 burcharth and andersen 1995 in the following way 11 a α 1 n 3 n 2 μ d d 50 2 b β 1 7 5 k c 1 n n 2 ρ d 50 where d 50 represents the mean nominal diameter of the material the keulegan carpenter number k c is defined as 12 k c u m t 0 n d 50 in which u m denotes the maximum oscillatory velocity and t 0 is the period of the oscillatory the modified version of porous interfoam solver is used to solve the varans equations using the combined algorithm pimple for pressure velocity coupling the ihfoam toolbox higuera et al 2013 2014a 2014b is adopted for the simulation of fluid structure interactions 2 3 boundary conditions to solve the wave field appropriate boundary conditions are required at the fluid seabed and fluid structure interface no slip boundary condition for velocities is imposed an atmospheric boundary condition is used at the upper boundary of the numerical wave flume in which the air and the water are allowed to flow out whereas only air is allowed to flow in on the inlet wavemaker boundary the incident waves are generated according to different wave theories that are optionally available in the ihfoam toolbox for regular waves the proper wave theory is selected according to le méhauté 1976 to avoid the reflection of incoming waves an active wave absorption theory is employed at the outlet allowing the waves to be absorbed on the boundaries without adding noticeable computational costs to the model more details for the wave generation absorption can be found in higuera et al 2013 at the seabed surface both the vertical effective normal stress and shear stress vanish whereas the pore water pressure p s is obtained from the wave pressure obtained from the hydrodynamic model the lateral boundaries of seabed are horizontally fixed but flexible in the vertical direction at the soil structure interface no slip boundary condition for the displacement is imposed for the soil resting on an impermeable rigid bottom zero displacements and no vertical flow occur i e p s z u s w s 0 in this study the length of the computing domain was selected as three times of the wave length with the structure being placed in the middle with these long distances the effect of the lateral boundary condition can be eliminated in the concentrated region i e in the vicinity of the breakwater according to ye and jeng 2012 2 4 integration of hydrodynamic and geotechnical models in the model integration a one way coupling algorithm is considered between two different models that are applied on two separate domains and communication takes place at the boundaries between both models in one direction from fvm to fem the coupling procedure is illustrated in fig 1 first of all in accordance with input wave parameters and the adjustable time step calculated by courant friedrichs lewy cfl condition the fvm hydrodynamic model solves the varans and volume of fluid equations by the combined piso simple algorithm for pressure velocity coupling in the fluid domain secondly the dynamic pressure is extracted from the hydrodynamic model and interpolated to the grid points of solid domain at the interface using the radius point interpolation rpi method developed by wang et al 2004 with appropriate boundary conditions the geotechnical model can be solved to obtain the dynamic response of seabed and marine structures the integrated fvm fem model is then forced to the next step simulation until the prescribed total simulation time is reached in the one way coupling process the responsibility of the hydrodynamic model is to determine the pressure and flow field around the structure and to provide the pressure force acting on the seabed and marine structures as surface boundary condition for the geotechnical simulations to ensure the accuracy of the numerical simulations it is necessary to consider the porosity of the breakwater in the hydrodynamic modeling since the large mean size of the breakwater may significantly damp the wave field in its vicinity thus affecting the wave pressure acting on the boundary surface however the solely use of varans equation is incapable of considering the deformation and instability of marine structures due to wave induced liquefaction or shear failure which is the main concerns of the present study this is the reason for using biots equations to investigate the dynamic response of seabed and rubble mound breakwater as a whole assuming that the flow motion in the porous media is obey darcys law this kind of method has been widely used in previous investigations for the wave seabed structure interactions and gave satisfactory results mizutani et al 1998 mostafa et al 1999 jeng et al 2013 3 model validations in this section the developed fvm fem model will be systematically validated using three sets of previous laboratory experimental results configurations of the laboratory experiments are provided in fig 2 both wave and soil parameters used in the numerical simulations for verification unless specified are basically the same as those used in the laboratory experiments 3 1 comparison with umeyama 2011 s laboratory measurement of regular wave uniform current traveling over a rigid bottom in umeyama 2011 s experiments a steady current with a depth averaged velocity of u 0 0 08 m s was generated following the wave propagation during all the tests a constant water depth d 0 2 m and a fixed wave period t 1 0 s was used in this section the piv measurement of horizontal velocity profiles in three tests of waves superimposed on the following current wc1 wc2 and wc3 were used for verification of the varans solver for the wave current interaction but without structures the corresponding incident wave heights for wc1 wc2 and wc3 are 0 0103 0 0234 and 0 0361 m respectively fig 3 shows the simulated and measured horizontal velocity profiles at different phases in all three cases the simulated velocity data appears to be in reasonable accordance with those obtained by the piv measurement in the wave tank it was found that the velocity profile is significantly affected by the surface wave motion the flow velocity above the bottom boundary layer decreases toward the water surface when wave trough arrives see the velocity profile at time t 0 00 s and 1 00 s of fig 3 whereas the velocity increases significantly while the current is superimposed by the wave crest see the velocity profile at time t 0 50 s of fig 3 3 2 comparison with chen et al 2017 s laboratory experiment of wave current interactions over a submerged breakwater a recent experiments for the wave current interactions over a rectangular submerged breakwater was reported in chen et al 2017 in the experiment wave propagation over a submerged breakwater with uniformed current following or opposing the wave propagation direction was tested and time histories of free surface elevations around the breakwater were measured and presented in their experiments no wave breaking was observed in the cases presented chen et al 2017 further applied an hobem model developed by lin et al 2014 to simulate the same problem based on potential flow theory in this section the identical case is reproduced using the present flow model and compared with the measured and calculated results of chen et al 2017 before showing the comparisons we firstly demonstrate the effectiveness of using the developed flow model to reproduce chen et al 2017 s experiment but without breakwaters the wave conditions for the tested case are listed as h 0 08 m d 0 6 m t 1 s fig 4 shows the simulated wave profiles along the longitudinal direction of the numerical wave flume for the cases with and without currents it is obvious that the wave pattern in the wave current co existing field is significantly different from that of wave alone the wave length tends to be enhanced by the co current but shortened by the counter current the predicted wavelengths of the numerical model for u 0 0 2 0 and 0 2 m s are about 1 9 1 4 and 1 1 m respectively which are close to those calculated by the linear dispersion relation phillips 1977 the relative difference of wave length between the present model and linear theoretical result are 10 for co current no current and counter current cases respectively which indicates that the wave nonlinearity decreases for co current waves but increases for counter current waves in fig 5 time histories of the free surface elevations at 5 wave gages g1 g5 for waves with t 2 s and h 0 108 m are plotted both experimental data and numerical prediction are presented in the figure both co current and counter current waves with a current velocity of 0 2 m s were considered it was found that the simulated flow pattern overall agrees with the measured data and shows a more promising agreement to the experimental data compared to those obtained from the numerical simulations based on the hobem model especially at the leeward side of the structure g4 and g5 this is because of the incapability of using potential flow theory in lin et al 2014 to reproduce the energy dissipation attributable to the viscosity of the fluid which becomes significant when there are vortex around structures due to the flow separations 3 3 comparison with mizutani et al 1998 s experimental data for pore pressures in the third comparison experimental data of mizutani et al 1998 will be used for the validation of the wave induced pore water pressures details for the experimental setup and measurement arrangement can be found in mizutani et al 1998 the primary parameters used for verification of the present model are listed as h 5 cm d 30 cm t 1 4 s n s 0 3 d 50 30 mm μ s 0 33 s r 0 99 g 5 108 pa k s 2 2 10 3 m s the computational setup is arranged similar to the experimental setup of mizutani et al 1998 according to the wave steepness 0 03 2 1 0 014 considered in the wave flume tests the second order stokes waves are specified on the inlet wave maker boundary for generating the propagation of water waves in the numerical wave tank fig 6 shows a comparison of wave induced pore water pressures at four pressure gages between the experimental data and the present model as seen in the figure the predicted pore water pressure at all locations are quantitatively similar to those observed in the laboratory experiments 4 applications in this section the validated numerical frameworks are integrated as a one way coupled fvm fem model for fluid seabed structure interactions in the vicinity a submerged rubble mound breakwater the schematic domain is given in fig 7 the current is generated from the inlet or outlet boundary of the numerical wave tank both co current wave wave coexistence with the following current and counter current waves wave coexistence with the opposing current with a velocity of 1 m s are considered in this section all of the wave characteristics properties of sandy bed and structure are given in table 1 unless specified in the numerical examples the meshes used in the fluid domain are structured four node quadrilateral elements and the simulated results are broadly affected by the grid resolutions therefore a model grid sensitivity study was conducted and concludes that the flow model is convergent with the resolution of mainly l 60 in the x and y directions and h 10 in z direction with a refinement factor of 2 herein l is the linear wavelength dean and dalrymple 1984 h is the wave height the mesh size selected for the solid domain is 1 5 2 m in the x direction which is smaller than l 40 such mesh size is small enough to meet the convergence criterion as demonstrated by ye et al 2013 as shown in fig 8 the mesh size in the upper soil layers is denser than that in the lower seabed this would make the numerical results become more smoothly hence providing reliable prediction for the fluid seabed structure interactions 4 1 hydrodynamic process fig 9 illustrates snapshots of velocity field around a submerged breakwater when waves over topping the breakwater both co current and counter current waves with a current velocity of 1 m s were considered in this analysis it is found that the co existence of wave and currents makes a significant difference in the velocity field around the structure compared to the wave alone case as seen a current following the wave propagation direction could make the fluid structure interaction become more intense beneath the near crest layer and above the crown of the breakwater a significant flow separation is observed at the trailing edge of the structure and the flow pattern tends to be curled into a vortex at the shore ward side of the breakwater in case of counter current waves interacting with a submerged breakwater the wavelength is shortened whereas the velocity field is enhanced at the seaward side of a structure fig 10 shows the free surface elevation at three typical locations around the submerged breakwater as shown in the figure the wave height varies periodically to the wave and current motions which is associated with the steeper wave crests flatter wave troughs and the generation of the higher order harmonics around the submerged breakwater this is attributed to the nonlinearity of wave transformations induced by the nonlinear fluid structure interactions basically the effects of wave height are more significant in front of the breakwater because of the blockage effect of the structure whereas it attenuates significantly accompanying with the distorted wave shapes at the lee side of the structure due to wave energy dissipation the shape of wave profiles is significantly affected by the presence of currents at all three locations it is found that the wave height is more likely to be amplified in the counter current waves in comparison with the co current waves or waves without current whereas the co current waves tends to prohibit the wave energy dissipation due to the submergence of the breakwater thus enhancing the wave height in its lee side based on the above discussions it can be concluded that the coexistence of wave and currents interacting with a submerged breakwater yield significant difference in the wave transformations and velocity field around the structure in comparison with the wave alone case this may further affect the subsequent geotechnical components in the seabed foundation which is the concentration part of this study and will be intensively discussed in the following sections 4 2 the process of consolidation in general a natural seabed has experienced the process of consolidation under gravitational forces in engineering practice after the structure is constructed the seabed will reach a new consolidated status associated with the dissipation of pore pressures and subsidence of marine structures this will directly affect the stress status of seabed around the structure appropriately estimating the stress status of seabed foundation through the pre consolidation analysis has proven to be essential in the assessment of the stability of submarine infrastructures due to seabed liquefaction ulker et al 2010 here the consolidation process of a porous seabed was pre assessed by using the present model under dead loadings i e weight of the breakwater the stress status in the final state of consolidation will be used as the initial conditions in the following analysis fig 11 shows the distribution of soil response variables in a seabed after the consolidation process is completed as seen the construction of rubble mound breakwater significantly affect the initial stresses in the seabed the increase of effective normal stresses σ x and σ z is enhanced by the body forces of the structure in the region below the bottom of the structure this is expected to suppress soil liquefaction as demonstrated in the previous numerical investigations jeng et al 2013 zhao et al 2014 for locations away from the structure the influences of the structure on the stress field are restored the distributions of σ x and σ z are layered in these regions which comes from the body forces of seabed foundation furthermore two shear concentration zones underneath both sides of the breakwater are observed in the figure this may lead to shear failure in the practice of engineering 4 3 dynamic analysis of fluid seabed structure interactions fig 12 shows snapshots of dynamic effective normal stresses shear stress and pore water pressures at two typical times around the breakwater under dynamic wave and current loadings the current following the wave propagation direction with velocity of 1 m s is considered in this analysis as seen in the figure the use of an elastic soil model allows the tendency for real soil to dilate or contract under cyclic wave loading generating negative or positive pore pressure and soil stresses in a seabed under wave crests the pore pressure p s is positive dynamic σ x is tensile and σ z is compressive on the other hand an inverse trend in terms of p s σ x and σ z can be found under wave troughs the presence of permeable rubble mound breakwater allows the wave pressure to be transmitted onto its underneath seabed foundation however due to the difference in the stiffness as well as the pore between the rubble mound and foundation soil the wave induced pore pressure and dynamic stress become discontinuous at the soil structure interface this becomes more apparent when wave hitting and over topping the breakwater similar to those observed in the hydrostatic analysis for seabed consolidation there always exist stress concentration zones near both toes of the breakwater as mentioned previously this may compromise the structure instability due to wave induced shear failure in the practice of engineering a bedding layer can be used under the rubble mound structures with proper dimensions and composition in the case of low shear strength native soil oumeraci et al 2001 or some more radical solutions are sought such as soil improvement jeng 2013 hence determine the regions of vulnerability to wave current induced shear failure is necessary for coastal engineers involved in the design of submerged breakwaters this will be discussed in the next section to investigate the dynamic soil response in the region close to the breakwater more precisely we further examine the vertical distributions of soil response variables at three locations in the vicinity of the breakwater both co current and counter current waves with a current velocity of 1 m s were considered in this analysis as illustrated in fig 13 the magnitude of pore pressures and effective normal stresses at all three locations increases in the co current case but decreases in the counter current case in comparison with that without current the difference is caused by the variation of dynamic pressures along the seabed surface due to the complicated wave current structure interaction the shear stresses in all cases are almost identical at the seeward side of the breakwater i e x 235 m at the shore ward side of the breakwater i e x 280 m the magnitude of shear stress is smaller when there is a following current especially at the lower part of the seabed fig 13 also shows a dramatic change in the pore pressure and effective normal stresses near the seabed surface in certain conditions i e poor drainage condition in fine sand this will further cause liquefaction if the excess pore pressure overcome the overburden pressures another interesting observation from fig 13 is that the presence of co current waves contribute to a significant discrepancy in the gradient of pore pressure distributions at the shore ward side of the breakwater compared with the cases of counter current wave and wave only the steeper gradient is more likely to cause the unloading of soil skeleton when there is a wave trough in the co current waves thus compromising the seabed instability due to soil liquefaction the potential of liquefaction will be further discussed in the following sections 5 seabed instability around a breakwater in this section the seabed instability around a submerged rubble mound breakwater will be investigated two common modes of seabed instability shear failure and liquefaction will be discussed due to the difference in the nature of failure modes between two mechanism we considered the shear failure and liquefaction in a separate way using two different criterion assuming that there is no any interaction between them more detailed about the differences between shear failure and liquefaction readers can refer to zen et al 1998 5 1 shear failure shear failure normally occurs when the shear stress at a soil element is greater than its shearing resistance and leads to fail due to the large horizontal movement of soil elements mohr coulomb s criterion has been widely used for the prediction of the occurrence of shear failure due to its simplicity and effectiveness in which the stress angle ϕ is frequently used as the representative physical quantity as shown in fig 14 the criterion for shear failure at a given point and instance can be expressed as zen et al 1998 13 ϕ arcsin σ 1 σ 3 2 c tan ϕ σ 1 σ 3 2 ϕ f where ϕ is the stress angle c 0 and ϕ f are the cohesion and friction angle of the sandy soil respectively σ 1 and σ 3 are the maximum and minimum principal effective stresses respectively in general ϕ f depends on the soil type for example 30 35 for sand and 40 45 for gravel fig 15 illustrated the distributions of the stress angle at three different times t 0 s t 42 s and t 55 s respectively in this study we assume that shear failure occurs if the predicted stress angle ϕ is greater than the friction angle ϕ f 35 the input parameters considered in this case are listed as u 0 1 m s k s 1 10 2 m s before ocean wave loading is applied in the computation t 0 s potential of shear failure already exists which are located at both toes of the breakwater this is attributed to the stress concentration caused by the body forces of the structure see fig 11 when the waves propagate over the porous seabed and interact with the breakwater the pattern of stress angle varies accordingly to the surface wave motions it is found that the potential for shear failure is enhanced under wave crests whereas is released under wave trough correspondingly the potential of shear failure along the center line of the structure is asymmetry in nature this may result in shore ward and seaward tilt of the structure when waves hitting and over topping the breakwater at t 42 s and t 55 s respectively in the regions away from the breakwater the effects of body forces of the structure basically disappear and the wave conditions considered in this case is insufficient to induce shear failure in this region fig 16 quantitatively shows the variation of stress angle at three typical locations around the breakwater under different wave and current conditions as shown in the figure the stress angle varies periodically to the wave and current loadings at all three locations it is found that the presence of currents significantly affects the shear failure around the breakwater the following current tend to enhance the potential for shear failure at the seaward side of the breakwater but decrease the potential at its lee whereas the opposing current does the opposite basically the shear failure is a great concern when the current is following the wave propagation direction reaching up to 68 at the front toe of the breakwater regardless the conditions of hydrodynamic loading considered in this study no potential for shear failure can be observed at the bottom of the breakwater from the above mentioned analysis it can be concluded that the toes of the submerged rubble mound breakwater is highly vulnerable to shear failure under combined wave and current 5 2 liquefaction in general momentary soil liquefaction occurs in an unsaturated seabed which goes from a solid state to a heavy fluid or reached a state as a consequence of increasing pore water pressures with decreasing effective stresses based on the concept of excess pore pressures the criterion proposed by zen and yamazaki 1990 has been used for the evaluation of wave induced momentary liquefaction however this criterion is only valid for the cases without the presence of marine structures when the breakwater is incorporated into the analysis as discussed previously the stress state as initial conditions is modified by the body forces of the structure through consolidation process therefore the criterion needs to be further modified and the liquefaction criterion can be expressed as 14 σ z 0 p s p b 0 where σ z 0 is the initial vertical effective stress in the final state of consolidation based on the above criterion 14 the liquefaction potential around a submerged breakwater can be assessed using the developed model figs 17 and 18 shows the wave induced vertical seepage force j z p s z and liquefaction at two typical times when wave hitting and over topping the breakwater respectively the current following the wave propagation direction with a velocity of 1 m s is considered in this analysis as shown in the figures the vertical seepage force appears in the zone near seabed surface and its distribution is intensively related to the dynamic loading the direction of vertical seepage force is downward under wave crests whereas an upward directed force can be observed under wave trough the results presented in figs 17 and 18 further confirmed that the momentary liquefaction can only occur in the surface soil layers when an upward directed seepage force in seabed foundation can be observed i e under wave troughs furthermore instantaneous liquefaction does not occur in the seabed underneath the structure due to the large initial stress induced by consolidation process despite the large upward directed seepage force being observed in this region at t 55 s see fig 18 it is worth noticing that this conclusion is only valid for wave induced momentary liquefaction considered in this study for another mechanism residual liquefaction as demonstrated by kudella et al 2006 sumer et al 2008 sumer 2014 it is more likely to occur at the bottom of gravity base marine structures where higher shear strains may develop over large soil depth study of this mechanism and the corresponding results will be given in future publications figs 19 and 20 show the time variation of liquefaction depth and area around the breakwater respectively similar to those observed in the wave induced shear failure the variation of depth and area in the potential of soil liquefaction shows a periodic response to the surface water waves as illustrated in the figures the maximum liquefaction depth normally occurs in front of the breakwater while no liquefaction is observed at the bottom of the breakwater it is also concluded from figs 19 and 20 that the presence of uniformed current significantly affect the soil liquefaction which become more apparent at the shore ward side of the breakwater in the region the co current waves tend to make the potential become more significant whereas no liquefaction can be observed in the counter current waves 5 3 parametric study in engineering practice the wave and soil parameters in the candidate site may vary considerably how the wave and soil parameters affect the potential of liquefaction around the structure is an important coastal engineering issue here the wave induced maximum liquefaction depth is used as the representative index to clarify the effects of flow and seabed characteristics fig 21 shows the maximum liquefaction depth in the vicinity of the breakwater for various conditions as seen in the figures the co current waves tend to enhance the potential of maximum liquefaction depth occurring whereas the counter current waves can suppress this to some extents compared with the wave only condition furthermore the maximum liquefaction depth increases with increasing shear modulus g and decreasing soil permeability k s and degree of saturation s r basically liquefaction does not occur in a seabed with a large permeability k s or fully saturated soils i e s r 1 this implies that momentary liquefaction is more likely to occur in an unsaturated seabed with poor drainage conditions and features strongly in dense deposits with large stiffness apart from the soil parameters the wave periods and wave height also significantly affect the liquefaction depth around the breakwater basically the maximum liquefaction depth has a positive correlation with the wave period and wave height because large waves with longer periods can carry more energy hence causing liquefaction in seabed foundation to a larger depth 6 conclusions in this paper a numerical model is developed to quantitatively investigate the interactions between ocean waves currents a submerged rubble mound breakwater and its poro elastic seabed foundations the effect of currents is included in the present fssi model which is the main contribution of the present study computational results demonstrate that the developed numerical framework is capable of reproducing the main features involved in the wave current seabed structure interactions around a submerged rubble mound breakwater it can be further applied to assess the instability of marine installations providing information to coastal engineers for an effective selection of optimal solutions based on the numerical examples the following conclusions can be drawn 1 the validations show the reliability of using the present model to reproduce the mechanism of fluid seabed structure interactions around a submerged rubble mound breakwater 2 under combined wave and current loadings liquefaction and shear failure are likely to occur in the upper soil layers around a rubble mound breakwater the liquefied zone is distinctly different from the shear failure zone the former corresponds to the region where the upward directed seepage force is predominant normally near wave troughs while shear failure is most likely to occur at both toes of the breakwater the wave and current induced shear failure is asymmetric in nature along the centre line of the structure which may results in its seaward or shore tilt when wave hitting and over topping the submerged breakwater respectively during the entire computation no liquefaction or shear failure can be observed in the seabed underneath the breakwater 3 the presence of uniformed current significantly affect the local hydrodynamic process involved in the fluid structure interactions around a submerged breakwater resulting in the dynamics of soil response in its underlying soil layers vary accordingly it is found that the following current tend to prolong the wave length and prohibit the wave attenuation induced by the submergence of the rubble mound breakwater whereas the opposing current does the opposite correspondingly liquefaction around the breakwater is more likely to occur when the current is following the wave propagation direction while the opposing current is beneficial to prevent the seabed from liquefaction or shear failure to some extent 4 parametric studies reveals that momentary liquefaction around a submerged rubble mound breakwater is more likely to occur in unsaturated sand with poor drainage conditions and under large waves the maximum liquefaction depth around the structure increases as wave height h wave period t and current velocity u 0 increase soil permeability k s and degree of saturation s r decrease acknowledgments the authors gratefully acknowledge the support of the griffith university eresearch service team and the use of the high performance computing cluster gowonda to complete this research this research was jointly supported by the national science foundation of china grant nos 51209183 51308259 51409142 and 51779220 the nature fund of zhejiang province grant no ly17e080006 the nature fund of ningbo city grant no 2017a610307 and open foundation of state key laboratory of hydrology water resources and hydraulic engineering hohai university project no 2016491011 the first author thanks for the support of griffith university deputy vice chancellor research international postgraduate scholarship and seet postgraduate research scholarship 
23466,a better understanding of physical process of the fluid seabed structure interaction fssi is beneficial for engineers involved in the design of marine infrastructures most previous studies for the problem of fssi have considered wave only conditions despite the co existence of wave and current in the real ocean environment unlike the previous studies currents are included in the present study for the numerical modelling of fssi using an integrated fvm fem scheme in which the varans equation is used to simulate fluid field while biot s poro elastic model is used for porous flow in a seabed numerical examples show the important influences of currents on the local hydrodynamic process and the resulting dynamics of seabed foundation around a submerged rubble mound breakwater the structure is relatively stable in the presence of counter current waves whereas the co current waves would significantly compromise the instability of structure due to potential of shear failure and liquefaction in its sandy seabed foundation keywords fluid seabed structure interactions fssi varans equation biot s theory co existence of wave and currents submerged breakwater momentary liquefaction 1 introduction protection of coastal zone has become a priority for coastal communities in the last few decades submerged breakwaters which are advantageous in terms of environmental considerations have been commonly constructed in the offshore regions to enhance the utility of coastlines one of the main concerns involved in the design of submerged breakwaters is the dynamic response of its underlying soil layers due to ocean wave loading this is particularly important for the evaluation of the stability of a marine infrastructure during the entire design life oumeraci 1994 jeng 2013 sumer 2014 a large number of studies for the dynamic soil response around marine structures have been conducted for years mainly involving analytical approximations hsu and jeng 1994 jeng 1996 jeng and ou 2010 numerical modeling jeng 2003 ulker et al 2010 or laboratory experiments sumer et al 2008 kirca et al 2013 among these an analytical approximation is an efficient tool in the early stage due to its simplicity and low computational cost it also rises the difficulty in handling the complex boundary value problems as such the configuration of structure considered in the analytical approximations is normally oversimplified and far from the realistic situations compared to the analytical solutions numerical modeling is more flexible in terms of geometrical complexities jeng 2003 developed a generalized fem model by introducing the complex into biot s equations and applying the galerkin method in which all wave induced soil response parameters were to fluctuate periodically in the time domain this model was reported to have been used in two applications wave seabed pipeline interactions jeng et al 2001b and wave seabed caisson interactions jeng et al 2001a ulker et al 2010 developed a fem model to study the elastic seabed underneath a caisson breakwater for three different biot s formulations the quasi static partially dynamic and fully dynamic they concluded that for the frequency range of loading of the seabed underneath a breakwater induced by the structural rocking motions the fully dynamic formulation should be considered in the aforementioned investigations analytical solutions are used as pressure boundary conditions whereas potential flow theory is incapable of capturing the local hydrodynamic processes involved in the fluid structure interactions in many aspects i e contraction of flow vortex shedding turbulence generation and wave breaking in fact computational fluid dynamics cfd models for fluid structure interactions is a relatively mature research project that has been intensively developed before lin and liu 1998 lara et al 2006 in which structures were considered to be fixed or flexible with porous media being considered as non deformable body that has added resistance to fluid flow in these investigations the use of navier stokes equation with an eulerian framework has proven to be useful in reproducing local hydrodynamic processes and is highly accurate from this point of view recent models have been developed as an integrated system in which the cfd models and geotechnical models are semi coupled through pressure continuity at common boundaries or other ways the use of advanced computational fluid dynamics in these multi physics models enhances the understanding of fssi in many cases i e breaking wave impacts on caisson and subsequently on the foundation ye et al 2014 elsafti and oumeraci 2017 porosity of structure on wave field and subsequently dynamics of their seabed foundation hur et al 2010 zhang et al 2011 most previous investigations for the wave seabed interactions around marine structures have considered wave only conditions however in the realistic oceanic environments the propagation of ocean waves is usually accompanied with currents the presence of currents may be further complicate the wave transformations around the structure and the subsequent dynamics of underlying soil layers that are intensively related to the stability of structure to better understand the physical process involved in the wave current seabed structure interactions an integrated fvm fem model is developed in this study by semi coupling the varans equation and biot s poro elastic solution through pressure continuity at the fluid porous material interfaces the proposed model will be validated by comparing with the previous experimental data first both the hydrodynamic and geotechnical process associated with the fluid soil submerged breakwater interactions will be examined finally the influence of the key parameters on the seabed instability around a structure will be quantified through parametric studies 2 numerical model 2 1 geotechnical model in general geomaterials selected as foundations for coastal and offshore structures are inherently heterogeneous which basically consisting of a solid phase with soil skeleton and a fluid phase with water and air herein a 2 d geotechnical model is developed in which the u p approximation zienkiewicz et al 1980 also known as partially dynamic equation ulker et al 2009 is employed the governing equations for a porous flow can be expressed as the follows 1 σ x x τ x z z p s x ρ 2 u t 2 2 τ x z x σ z z ρ g p s z ρ w 2 t 2 3 k s 2 p s γ w n s β s p s t k s ρ f 2 ε s t 2 γ w ε s t where p s is the pore water pressure u s and w s represent the horizontal and vertical components of soil displacements σ x and σ z are the horizontal and vertical components of effective normal stresses respectively τ x z is the shear stress n s is the porosity of soil γ w is the unit weight of pore water ρ n s ρ f 1 n s ρ s is the average density of porous medium k s is the darcy s permeability coefficient which should be the same in all directions for isotropic porous seabed considered in this study in 1 volumetric strain ε s and compressibility of pore fluid β s and are defined as 4 ε s u s x w s z β s 1 k f 1 s r p w 0 in which p w 0 is the absolute static pressure and k f is the bulk modulus of the pore water which is taken as 1 95 109 n m2 for pore water yamamoto et al 1978 s r is the degree of saturation in this study linear reversible soil behavior is considered this assumption has been commonly used in the previous studies for the transient analysis of seabed response and gave satisfactory results hsu and jeng 1994 ulker and rahman 2009 ulker et al 2010 under plain strain conditions the stress strain relationship can be expressed as the follows 5 σ x 2 g u s x μ 1 2 μ ε s 6 σ z 2 g w s z μ 1 2 μ ε s 7 τ x z g u s z w s x τ z x where g is the shear modulus of soil it is noted that a compressive normal stress is taken as a positive sign the finite element method is used to solve the above governing equations 1 3 based on the platform of diana swandyne ii chan 1988 the single step generalized newmark scheme is adopted to integrate the above discretized matrix equations in the time domain more details about the numerical scheme for spatial and temporal discretization can be found in chan 1988 2 2 hydrodynamic model in this study based on the varans equations an fvm hydrodynamic model developed in the open source cfd toolbox openfoam version 2 3 0 jesus et al 2012 is employed to simulate the fluid structure interactions in the presence of uniformed current the equations governing the two phase incompressible flow motion including the conservation of mass and momentum can be expressed as follows 8 u i x i 0 9 ρ f u i t x j 1 n ρ f u i u j n p f x i n g j x j ρ f x i x j μ e f f u i x j c t in which u i denotes the darcy velocity n is the porosity of rubble mound ρ f is the density of fluid p is the pseudo dynamic pressure g is the acceleration of gravity x is the position vector μ e f f is the efficient dynamic viscosity u c is relative velocity field and f stand for darcy s volume averaging operator and the intrinsic averaging operator respectively in 9 the last component representing the resistance of the porous media can be expressed as 10 c t a u i b u u i 0 34 u i t where the closure term ct is the hydraulic gradient a and b are empirical drag force coefficients which can be determined based on the theoretical works frank 1953 burcharth and andersen 1995 in the following way 11 a α 1 n 3 n 2 μ d d 50 2 b β 1 7 5 k c 1 n n 2 ρ d 50 where d 50 represents the mean nominal diameter of the material the keulegan carpenter number k c is defined as 12 k c u m t 0 n d 50 in which u m denotes the maximum oscillatory velocity and t 0 is the period of the oscillatory the modified version of porous interfoam solver is used to solve the varans equations using the combined algorithm pimple for pressure velocity coupling the ihfoam toolbox higuera et al 2013 2014a 2014b is adopted for the simulation of fluid structure interactions 2 3 boundary conditions to solve the wave field appropriate boundary conditions are required at the fluid seabed and fluid structure interface no slip boundary condition for velocities is imposed an atmospheric boundary condition is used at the upper boundary of the numerical wave flume in which the air and the water are allowed to flow out whereas only air is allowed to flow in on the inlet wavemaker boundary the incident waves are generated according to different wave theories that are optionally available in the ihfoam toolbox for regular waves the proper wave theory is selected according to le méhauté 1976 to avoid the reflection of incoming waves an active wave absorption theory is employed at the outlet allowing the waves to be absorbed on the boundaries without adding noticeable computational costs to the model more details for the wave generation absorption can be found in higuera et al 2013 at the seabed surface both the vertical effective normal stress and shear stress vanish whereas the pore water pressure p s is obtained from the wave pressure obtained from the hydrodynamic model the lateral boundaries of seabed are horizontally fixed but flexible in the vertical direction at the soil structure interface no slip boundary condition for the displacement is imposed for the soil resting on an impermeable rigid bottom zero displacements and no vertical flow occur i e p s z u s w s 0 in this study the length of the computing domain was selected as three times of the wave length with the structure being placed in the middle with these long distances the effect of the lateral boundary condition can be eliminated in the concentrated region i e in the vicinity of the breakwater according to ye and jeng 2012 2 4 integration of hydrodynamic and geotechnical models in the model integration a one way coupling algorithm is considered between two different models that are applied on two separate domains and communication takes place at the boundaries between both models in one direction from fvm to fem the coupling procedure is illustrated in fig 1 first of all in accordance with input wave parameters and the adjustable time step calculated by courant friedrichs lewy cfl condition the fvm hydrodynamic model solves the varans and volume of fluid equations by the combined piso simple algorithm for pressure velocity coupling in the fluid domain secondly the dynamic pressure is extracted from the hydrodynamic model and interpolated to the grid points of solid domain at the interface using the radius point interpolation rpi method developed by wang et al 2004 with appropriate boundary conditions the geotechnical model can be solved to obtain the dynamic response of seabed and marine structures the integrated fvm fem model is then forced to the next step simulation until the prescribed total simulation time is reached in the one way coupling process the responsibility of the hydrodynamic model is to determine the pressure and flow field around the structure and to provide the pressure force acting on the seabed and marine structures as surface boundary condition for the geotechnical simulations to ensure the accuracy of the numerical simulations it is necessary to consider the porosity of the breakwater in the hydrodynamic modeling since the large mean size of the breakwater may significantly damp the wave field in its vicinity thus affecting the wave pressure acting on the boundary surface however the solely use of varans equation is incapable of considering the deformation and instability of marine structures due to wave induced liquefaction or shear failure which is the main concerns of the present study this is the reason for using biots equations to investigate the dynamic response of seabed and rubble mound breakwater as a whole assuming that the flow motion in the porous media is obey darcys law this kind of method has been widely used in previous investigations for the wave seabed structure interactions and gave satisfactory results mizutani et al 1998 mostafa et al 1999 jeng et al 2013 3 model validations in this section the developed fvm fem model will be systematically validated using three sets of previous laboratory experimental results configurations of the laboratory experiments are provided in fig 2 both wave and soil parameters used in the numerical simulations for verification unless specified are basically the same as those used in the laboratory experiments 3 1 comparison with umeyama 2011 s laboratory measurement of regular wave uniform current traveling over a rigid bottom in umeyama 2011 s experiments a steady current with a depth averaged velocity of u 0 0 08 m s was generated following the wave propagation during all the tests a constant water depth d 0 2 m and a fixed wave period t 1 0 s was used in this section the piv measurement of horizontal velocity profiles in three tests of waves superimposed on the following current wc1 wc2 and wc3 were used for verification of the varans solver for the wave current interaction but without structures the corresponding incident wave heights for wc1 wc2 and wc3 are 0 0103 0 0234 and 0 0361 m respectively fig 3 shows the simulated and measured horizontal velocity profiles at different phases in all three cases the simulated velocity data appears to be in reasonable accordance with those obtained by the piv measurement in the wave tank it was found that the velocity profile is significantly affected by the surface wave motion the flow velocity above the bottom boundary layer decreases toward the water surface when wave trough arrives see the velocity profile at time t 0 00 s and 1 00 s of fig 3 whereas the velocity increases significantly while the current is superimposed by the wave crest see the velocity profile at time t 0 50 s of fig 3 3 2 comparison with chen et al 2017 s laboratory experiment of wave current interactions over a submerged breakwater a recent experiments for the wave current interactions over a rectangular submerged breakwater was reported in chen et al 2017 in the experiment wave propagation over a submerged breakwater with uniformed current following or opposing the wave propagation direction was tested and time histories of free surface elevations around the breakwater were measured and presented in their experiments no wave breaking was observed in the cases presented chen et al 2017 further applied an hobem model developed by lin et al 2014 to simulate the same problem based on potential flow theory in this section the identical case is reproduced using the present flow model and compared with the measured and calculated results of chen et al 2017 before showing the comparisons we firstly demonstrate the effectiveness of using the developed flow model to reproduce chen et al 2017 s experiment but without breakwaters the wave conditions for the tested case are listed as h 0 08 m d 0 6 m t 1 s fig 4 shows the simulated wave profiles along the longitudinal direction of the numerical wave flume for the cases with and without currents it is obvious that the wave pattern in the wave current co existing field is significantly different from that of wave alone the wave length tends to be enhanced by the co current but shortened by the counter current the predicted wavelengths of the numerical model for u 0 0 2 0 and 0 2 m s are about 1 9 1 4 and 1 1 m respectively which are close to those calculated by the linear dispersion relation phillips 1977 the relative difference of wave length between the present model and linear theoretical result are 10 for co current no current and counter current cases respectively which indicates that the wave nonlinearity decreases for co current waves but increases for counter current waves in fig 5 time histories of the free surface elevations at 5 wave gages g1 g5 for waves with t 2 s and h 0 108 m are plotted both experimental data and numerical prediction are presented in the figure both co current and counter current waves with a current velocity of 0 2 m s were considered it was found that the simulated flow pattern overall agrees with the measured data and shows a more promising agreement to the experimental data compared to those obtained from the numerical simulations based on the hobem model especially at the leeward side of the structure g4 and g5 this is because of the incapability of using potential flow theory in lin et al 2014 to reproduce the energy dissipation attributable to the viscosity of the fluid which becomes significant when there are vortex around structures due to the flow separations 3 3 comparison with mizutani et al 1998 s experimental data for pore pressures in the third comparison experimental data of mizutani et al 1998 will be used for the validation of the wave induced pore water pressures details for the experimental setup and measurement arrangement can be found in mizutani et al 1998 the primary parameters used for verification of the present model are listed as h 5 cm d 30 cm t 1 4 s n s 0 3 d 50 30 mm μ s 0 33 s r 0 99 g 5 108 pa k s 2 2 10 3 m s the computational setup is arranged similar to the experimental setup of mizutani et al 1998 according to the wave steepness 0 03 2 1 0 014 considered in the wave flume tests the second order stokes waves are specified on the inlet wave maker boundary for generating the propagation of water waves in the numerical wave tank fig 6 shows a comparison of wave induced pore water pressures at four pressure gages between the experimental data and the present model as seen in the figure the predicted pore water pressure at all locations are quantitatively similar to those observed in the laboratory experiments 4 applications in this section the validated numerical frameworks are integrated as a one way coupled fvm fem model for fluid seabed structure interactions in the vicinity a submerged rubble mound breakwater the schematic domain is given in fig 7 the current is generated from the inlet or outlet boundary of the numerical wave tank both co current wave wave coexistence with the following current and counter current waves wave coexistence with the opposing current with a velocity of 1 m s are considered in this section all of the wave characteristics properties of sandy bed and structure are given in table 1 unless specified in the numerical examples the meshes used in the fluid domain are structured four node quadrilateral elements and the simulated results are broadly affected by the grid resolutions therefore a model grid sensitivity study was conducted and concludes that the flow model is convergent with the resolution of mainly l 60 in the x and y directions and h 10 in z direction with a refinement factor of 2 herein l is the linear wavelength dean and dalrymple 1984 h is the wave height the mesh size selected for the solid domain is 1 5 2 m in the x direction which is smaller than l 40 such mesh size is small enough to meet the convergence criterion as demonstrated by ye et al 2013 as shown in fig 8 the mesh size in the upper soil layers is denser than that in the lower seabed this would make the numerical results become more smoothly hence providing reliable prediction for the fluid seabed structure interactions 4 1 hydrodynamic process fig 9 illustrates snapshots of velocity field around a submerged breakwater when waves over topping the breakwater both co current and counter current waves with a current velocity of 1 m s were considered in this analysis it is found that the co existence of wave and currents makes a significant difference in the velocity field around the structure compared to the wave alone case as seen a current following the wave propagation direction could make the fluid structure interaction become more intense beneath the near crest layer and above the crown of the breakwater a significant flow separation is observed at the trailing edge of the structure and the flow pattern tends to be curled into a vortex at the shore ward side of the breakwater in case of counter current waves interacting with a submerged breakwater the wavelength is shortened whereas the velocity field is enhanced at the seaward side of a structure fig 10 shows the free surface elevation at three typical locations around the submerged breakwater as shown in the figure the wave height varies periodically to the wave and current motions which is associated with the steeper wave crests flatter wave troughs and the generation of the higher order harmonics around the submerged breakwater this is attributed to the nonlinearity of wave transformations induced by the nonlinear fluid structure interactions basically the effects of wave height are more significant in front of the breakwater because of the blockage effect of the structure whereas it attenuates significantly accompanying with the distorted wave shapes at the lee side of the structure due to wave energy dissipation the shape of wave profiles is significantly affected by the presence of currents at all three locations it is found that the wave height is more likely to be amplified in the counter current waves in comparison with the co current waves or waves without current whereas the co current waves tends to prohibit the wave energy dissipation due to the submergence of the breakwater thus enhancing the wave height in its lee side based on the above discussions it can be concluded that the coexistence of wave and currents interacting with a submerged breakwater yield significant difference in the wave transformations and velocity field around the structure in comparison with the wave alone case this may further affect the subsequent geotechnical components in the seabed foundation which is the concentration part of this study and will be intensively discussed in the following sections 4 2 the process of consolidation in general a natural seabed has experienced the process of consolidation under gravitational forces in engineering practice after the structure is constructed the seabed will reach a new consolidated status associated with the dissipation of pore pressures and subsidence of marine structures this will directly affect the stress status of seabed around the structure appropriately estimating the stress status of seabed foundation through the pre consolidation analysis has proven to be essential in the assessment of the stability of submarine infrastructures due to seabed liquefaction ulker et al 2010 here the consolidation process of a porous seabed was pre assessed by using the present model under dead loadings i e weight of the breakwater the stress status in the final state of consolidation will be used as the initial conditions in the following analysis fig 11 shows the distribution of soil response variables in a seabed after the consolidation process is completed as seen the construction of rubble mound breakwater significantly affect the initial stresses in the seabed the increase of effective normal stresses σ x and σ z is enhanced by the body forces of the structure in the region below the bottom of the structure this is expected to suppress soil liquefaction as demonstrated in the previous numerical investigations jeng et al 2013 zhao et al 2014 for locations away from the structure the influences of the structure on the stress field are restored the distributions of σ x and σ z are layered in these regions which comes from the body forces of seabed foundation furthermore two shear concentration zones underneath both sides of the breakwater are observed in the figure this may lead to shear failure in the practice of engineering 4 3 dynamic analysis of fluid seabed structure interactions fig 12 shows snapshots of dynamic effective normal stresses shear stress and pore water pressures at two typical times around the breakwater under dynamic wave and current loadings the current following the wave propagation direction with velocity of 1 m s is considered in this analysis as seen in the figure the use of an elastic soil model allows the tendency for real soil to dilate or contract under cyclic wave loading generating negative or positive pore pressure and soil stresses in a seabed under wave crests the pore pressure p s is positive dynamic σ x is tensile and σ z is compressive on the other hand an inverse trend in terms of p s σ x and σ z can be found under wave troughs the presence of permeable rubble mound breakwater allows the wave pressure to be transmitted onto its underneath seabed foundation however due to the difference in the stiffness as well as the pore between the rubble mound and foundation soil the wave induced pore pressure and dynamic stress become discontinuous at the soil structure interface this becomes more apparent when wave hitting and over topping the breakwater similar to those observed in the hydrostatic analysis for seabed consolidation there always exist stress concentration zones near both toes of the breakwater as mentioned previously this may compromise the structure instability due to wave induced shear failure in the practice of engineering a bedding layer can be used under the rubble mound structures with proper dimensions and composition in the case of low shear strength native soil oumeraci et al 2001 or some more radical solutions are sought such as soil improvement jeng 2013 hence determine the regions of vulnerability to wave current induced shear failure is necessary for coastal engineers involved in the design of submerged breakwaters this will be discussed in the next section to investigate the dynamic soil response in the region close to the breakwater more precisely we further examine the vertical distributions of soil response variables at three locations in the vicinity of the breakwater both co current and counter current waves with a current velocity of 1 m s were considered in this analysis as illustrated in fig 13 the magnitude of pore pressures and effective normal stresses at all three locations increases in the co current case but decreases in the counter current case in comparison with that without current the difference is caused by the variation of dynamic pressures along the seabed surface due to the complicated wave current structure interaction the shear stresses in all cases are almost identical at the seeward side of the breakwater i e x 235 m at the shore ward side of the breakwater i e x 280 m the magnitude of shear stress is smaller when there is a following current especially at the lower part of the seabed fig 13 also shows a dramatic change in the pore pressure and effective normal stresses near the seabed surface in certain conditions i e poor drainage condition in fine sand this will further cause liquefaction if the excess pore pressure overcome the overburden pressures another interesting observation from fig 13 is that the presence of co current waves contribute to a significant discrepancy in the gradient of pore pressure distributions at the shore ward side of the breakwater compared with the cases of counter current wave and wave only the steeper gradient is more likely to cause the unloading of soil skeleton when there is a wave trough in the co current waves thus compromising the seabed instability due to soil liquefaction the potential of liquefaction will be further discussed in the following sections 5 seabed instability around a breakwater in this section the seabed instability around a submerged rubble mound breakwater will be investigated two common modes of seabed instability shear failure and liquefaction will be discussed due to the difference in the nature of failure modes between two mechanism we considered the shear failure and liquefaction in a separate way using two different criterion assuming that there is no any interaction between them more detailed about the differences between shear failure and liquefaction readers can refer to zen et al 1998 5 1 shear failure shear failure normally occurs when the shear stress at a soil element is greater than its shearing resistance and leads to fail due to the large horizontal movement of soil elements mohr coulomb s criterion has been widely used for the prediction of the occurrence of shear failure due to its simplicity and effectiveness in which the stress angle ϕ is frequently used as the representative physical quantity as shown in fig 14 the criterion for shear failure at a given point and instance can be expressed as zen et al 1998 13 ϕ arcsin σ 1 σ 3 2 c tan ϕ σ 1 σ 3 2 ϕ f where ϕ is the stress angle c 0 and ϕ f are the cohesion and friction angle of the sandy soil respectively σ 1 and σ 3 are the maximum and minimum principal effective stresses respectively in general ϕ f depends on the soil type for example 30 35 for sand and 40 45 for gravel fig 15 illustrated the distributions of the stress angle at three different times t 0 s t 42 s and t 55 s respectively in this study we assume that shear failure occurs if the predicted stress angle ϕ is greater than the friction angle ϕ f 35 the input parameters considered in this case are listed as u 0 1 m s k s 1 10 2 m s before ocean wave loading is applied in the computation t 0 s potential of shear failure already exists which are located at both toes of the breakwater this is attributed to the stress concentration caused by the body forces of the structure see fig 11 when the waves propagate over the porous seabed and interact with the breakwater the pattern of stress angle varies accordingly to the surface wave motions it is found that the potential for shear failure is enhanced under wave crests whereas is released under wave trough correspondingly the potential of shear failure along the center line of the structure is asymmetry in nature this may result in shore ward and seaward tilt of the structure when waves hitting and over topping the breakwater at t 42 s and t 55 s respectively in the regions away from the breakwater the effects of body forces of the structure basically disappear and the wave conditions considered in this case is insufficient to induce shear failure in this region fig 16 quantitatively shows the variation of stress angle at three typical locations around the breakwater under different wave and current conditions as shown in the figure the stress angle varies periodically to the wave and current loadings at all three locations it is found that the presence of currents significantly affects the shear failure around the breakwater the following current tend to enhance the potential for shear failure at the seaward side of the breakwater but decrease the potential at its lee whereas the opposing current does the opposite basically the shear failure is a great concern when the current is following the wave propagation direction reaching up to 68 at the front toe of the breakwater regardless the conditions of hydrodynamic loading considered in this study no potential for shear failure can be observed at the bottom of the breakwater from the above mentioned analysis it can be concluded that the toes of the submerged rubble mound breakwater is highly vulnerable to shear failure under combined wave and current 5 2 liquefaction in general momentary soil liquefaction occurs in an unsaturated seabed which goes from a solid state to a heavy fluid or reached a state as a consequence of increasing pore water pressures with decreasing effective stresses based on the concept of excess pore pressures the criterion proposed by zen and yamazaki 1990 has been used for the evaluation of wave induced momentary liquefaction however this criterion is only valid for the cases without the presence of marine structures when the breakwater is incorporated into the analysis as discussed previously the stress state as initial conditions is modified by the body forces of the structure through consolidation process therefore the criterion needs to be further modified and the liquefaction criterion can be expressed as 14 σ z 0 p s p b 0 where σ z 0 is the initial vertical effective stress in the final state of consolidation based on the above criterion 14 the liquefaction potential around a submerged breakwater can be assessed using the developed model figs 17 and 18 shows the wave induced vertical seepage force j z p s z and liquefaction at two typical times when wave hitting and over topping the breakwater respectively the current following the wave propagation direction with a velocity of 1 m s is considered in this analysis as shown in the figures the vertical seepage force appears in the zone near seabed surface and its distribution is intensively related to the dynamic loading the direction of vertical seepage force is downward under wave crests whereas an upward directed force can be observed under wave trough the results presented in figs 17 and 18 further confirmed that the momentary liquefaction can only occur in the surface soil layers when an upward directed seepage force in seabed foundation can be observed i e under wave troughs furthermore instantaneous liquefaction does not occur in the seabed underneath the structure due to the large initial stress induced by consolidation process despite the large upward directed seepage force being observed in this region at t 55 s see fig 18 it is worth noticing that this conclusion is only valid for wave induced momentary liquefaction considered in this study for another mechanism residual liquefaction as demonstrated by kudella et al 2006 sumer et al 2008 sumer 2014 it is more likely to occur at the bottom of gravity base marine structures where higher shear strains may develop over large soil depth study of this mechanism and the corresponding results will be given in future publications figs 19 and 20 show the time variation of liquefaction depth and area around the breakwater respectively similar to those observed in the wave induced shear failure the variation of depth and area in the potential of soil liquefaction shows a periodic response to the surface water waves as illustrated in the figures the maximum liquefaction depth normally occurs in front of the breakwater while no liquefaction is observed at the bottom of the breakwater it is also concluded from figs 19 and 20 that the presence of uniformed current significantly affect the soil liquefaction which become more apparent at the shore ward side of the breakwater in the region the co current waves tend to make the potential become more significant whereas no liquefaction can be observed in the counter current waves 5 3 parametric study in engineering practice the wave and soil parameters in the candidate site may vary considerably how the wave and soil parameters affect the potential of liquefaction around the structure is an important coastal engineering issue here the wave induced maximum liquefaction depth is used as the representative index to clarify the effects of flow and seabed characteristics fig 21 shows the maximum liquefaction depth in the vicinity of the breakwater for various conditions as seen in the figures the co current waves tend to enhance the potential of maximum liquefaction depth occurring whereas the counter current waves can suppress this to some extents compared with the wave only condition furthermore the maximum liquefaction depth increases with increasing shear modulus g and decreasing soil permeability k s and degree of saturation s r basically liquefaction does not occur in a seabed with a large permeability k s or fully saturated soils i e s r 1 this implies that momentary liquefaction is more likely to occur in an unsaturated seabed with poor drainage conditions and features strongly in dense deposits with large stiffness apart from the soil parameters the wave periods and wave height also significantly affect the liquefaction depth around the breakwater basically the maximum liquefaction depth has a positive correlation with the wave period and wave height because large waves with longer periods can carry more energy hence causing liquefaction in seabed foundation to a larger depth 6 conclusions in this paper a numerical model is developed to quantitatively investigate the interactions between ocean waves currents a submerged rubble mound breakwater and its poro elastic seabed foundations the effect of currents is included in the present fssi model which is the main contribution of the present study computational results demonstrate that the developed numerical framework is capable of reproducing the main features involved in the wave current seabed structure interactions around a submerged rubble mound breakwater it can be further applied to assess the instability of marine installations providing information to coastal engineers for an effective selection of optimal solutions based on the numerical examples the following conclusions can be drawn 1 the validations show the reliability of using the present model to reproduce the mechanism of fluid seabed structure interactions around a submerged rubble mound breakwater 2 under combined wave and current loadings liquefaction and shear failure are likely to occur in the upper soil layers around a rubble mound breakwater the liquefied zone is distinctly different from the shear failure zone the former corresponds to the region where the upward directed seepage force is predominant normally near wave troughs while shear failure is most likely to occur at both toes of the breakwater the wave and current induced shear failure is asymmetric in nature along the centre line of the structure which may results in its seaward or shore tilt when wave hitting and over topping the submerged breakwater respectively during the entire computation no liquefaction or shear failure can be observed in the seabed underneath the breakwater 3 the presence of uniformed current significantly affect the local hydrodynamic process involved in the fluid structure interactions around a submerged breakwater resulting in the dynamics of soil response in its underlying soil layers vary accordingly it is found that the following current tend to prolong the wave length and prohibit the wave attenuation induced by the submergence of the rubble mound breakwater whereas the opposing current does the opposite correspondingly liquefaction around the breakwater is more likely to occur when the current is following the wave propagation direction while the opposing current is beneficial to prevent the seabed from liquefaction or shear failure to some extent 4 parametric studies reveals that momentary liquefaction around a submerged rubble mound breakwater is more likely to occur in unsaturated sand with poor drainage conditions and under large waves the maximum liquefaction depth around the structure increases as wave height h wave period t and current velocity u 0 increase soil permeability k s and degree of saturation s r decrease acknowledgments the authors gratefully acknowledge the support of the griffith university eresearch service team and the use of the high performance computing cluster gowonda to complete this research this research was jointly supported by the national science foundation of china grant nos 51209183 51308259 51409142 and 51779220 the nature fund of zhejiang province grant no ly17e080006 the nature fund of ningbo city grant no 2017a610307 and open foundation of state key laboratory of hydrology water resources and hydraulic engineering hohai university project no 2016491011 the first author thanks for the support of griffith university deputy vice chancellor research international postgraduate scholarship and seet postgraduate research scholarship 
23467,the objective of this paper is to study the cavitation vortex dynamics in compressible turbulent cavitating flow around a naca66 hydrofoil the simulations are conducted based on the open source software openfoam solving the compressible governing equations together with the tait state equation for water and ideal gas state equation for vapor the saito cavitation model is used to model the cavitation phase change process and sas sst turbulence model is adopted to account for the turbulence effects the numerical results showed a good agreement with the experiments the cavity evolution presents quasi periodic behaviors and the alternative re entrant flow movement and shock wave dynamics play an important role in cavitation vortex dynamics strong coherent relationship between cavitation behaviors and vortex dynamics is illustrated based on the budget analysis of vorticity transport equation it shows that during the attached cavity growth the re entrant flow development and the cloud cavity being shed stages the baroclinic torque term dominates the vorticity transport process during the shock wave propagation stage the vortex dilatation term dominates in the attached cavity sheet region besides the baroclinic torque term has strong influence on vorticity transport characteristics keywords cavitating flows cavitation vortex dynamics compressible cavitating solver shock wave openfoam 1 introduction hydrodynamic cavitation is generally undesirable phenomena due to its severe damage to the hydraulic systems such as pumps turbines marine propellers and rocket propulsion inducers in fluid machinery and spillway in hydropower station knapp et al 1970 brennen 1995 wang et al 2001 the very destructive effects such as pressure fluctuations variation noise and erosion are suffered in the condition of sheet cloud cavitation which is characterized by periodic breakup of attached cavity sheet shedding and collapse of cloud cavity soyama et al 1992 joseph 1995 reisman 1996 chen et al 2015 wang et al 2017b wu et al 2015 2018 many researchers have conducted investigations for the shedding mechanism of the cloud cavity among which the shock wave propagation during the cloud cavity collapse is supposed to be the main region for the cloud cavitation instabilities reisman et al 1998 leroux et al 2005 budich et al 2015 wang et al 2017a it has also been pointed out that a marked decrease in the sound speed phenomena appears in liquid gas mixture by wallis 1967 and brennen 1995 and thus it is very likely that the local liquid gas flows reaches to transonic or supersonic speed even when the bulk flow velocity is relatively low hence it is necessary to understand the coherent interaction between the shock phenomena and the multiphase compressible flow dynamics numerous researchers have experimentally measured the pressure pulses in the cavitating flows avellan and farhat 1989 le et al 1994 mckenney and brennen 1994 reisman et al 1994 and investigated the shock wave propagation characteristics in the bubbly mixture noordij and wijngaarden 1974 mørch 1980 1981 hanson et al 1981 reisman and brennen 1996 conducted experiments to investigate the pressure impulses emitted in the cloud cavitation systematically using piezo electric transducers on both stationary and oscillating hydrofoils they observed that pressure pulses are highly related with the large low void fraction region which is supposed to be caused by the cavity collapse event the impulse intensity was enhanced with the increasing of inlet speed and the decreasing of cavitation number after that they further concluded that the shock wave dynamics led to the damage and noise in cavitating flows arndt et al 2001 applied a combined experimental and numerical method to investigate the sheet cloud cavitation dynamics around a naca0015 hydrofoil they concluded that at low value of σ 2α the bubbly shock mechanism is the cause of the cloud cavitation generation leroux et al 2004 employed the wall pressure transducers to investigate partial cavity instabilities around a naca66 hydrofoil they showed that at the condition of σ 1 25 at attack of angle aoa 6 the cloud cavity collapse induced shock wave would significantly cause the newly growth attached sheet cavity being shorten and collapsed and thus resulting in the cavitation cycle increase and the cavitation strouhal number reduction recently ganesh et al 2016 used high speed video and time resolved x ray densitometry to investigate the sheet to cloud cavitation transition mechanism in a venturi section the shock wave propagation in the attached cavity was well observed and it was concluded that the shock wave propagation mechanism dominates the periodic large scale cloud cavity shedding process wu et al 2016a used hydrophone measurements accompanied with high speed videos and time resolved x ray densitometry to investigate the partial cavity shedding dynamics around a naca0015 hydrofoil they observed that with the reduction of the cavitation number the cavity dynamics changed from the pinch off from the rear of the cavity caused by the re entrant jet to a propagation bubbly shockwave mechanism caused by the collapse of the shed cloud cavity with the development of the numerical technique most past simulations adopt the incompressible method in the cavitation calculation bensow and bark 2010 li et al 2008 huang et al 2014 wu et al 2016b yu et al 2017 considering that the shock wave phenomena in complex cavitating flows is highly related to the compressible characteristics it is necessary to employ the compressible solver into the cavitating flow numerical simulations kunz et al 2001 sezal et al 2009 haren et al 2016 gnanaskandan and mahesh 2016 egerer et al 2016 the solving of compressible multiphase equations is a challenging problem carrying a significant computational burden and requires careful treatment in which the selection of time step is critical to guarantee the convergence and should satisfy the maximum courant number criteria venkateswaran et al 2002 applied a preconditioned time marching algorithm to investigate the compressibility effects of cavitating flow the results showed that the method considering the compressibility can improve the cavitation dynamics compared with the previous incompressible computations saito et al 2007 developed the compressible two phase navier stokes equations and applied them to investigate the unsteady behaviors of cloud cavitation around a naca 0015 hydrofoil the method accurately captured the u shape cloud cavity which is supposed to be related to the cavity collapse event schnerr et al 2008 developed the compressible cavitating flow solver to investigate the collapse induced shock wave dynamics with nanosecond time step the pressure peak up to 230 bar was calculated as the shock wave was induced by the cloud cavity collapse however investigation on the cavitation vortex dynamics concerning with the cavitation compressible characteristics especially in the complex cavitating flows along with the shock wave dynamics has been rarely conducted the turbulence model plays an important role in high reynolds number cavitating flows although the rans approach has been widely used to simulate turbulent cavitating flows it has the weakness of the over prediction of turbulent eddy viscosity in multiphase mixture region coutier degosha et al 2003 reboud et al 2008 huang et al 2013a 2013b long et al 2017b the les approach requires much more computational resources wang and ostoja stazewski 2007 ji et al 2015 huang et al 2014 thus some hybrid rans les turbulence models have been developed ducoin et al 2012 huang et al 2013b chen et al 2016 different from the grid based hybrid turbulence mode the rans and les transition of the sst sas scale adaptive simulation turbulence model is based on local turbulence structures von karman length scale considering the multi scale characteristics in both time and space domain in unsteady cavitating flows the sst sas can solve more smaller turbulence eddy structures and better capture the unsteady instabilities involved in the multi scale cavitation dynamics most of the experimental and numerical researches have mainly focused on the cavity patterns and pressure characteristics during the shock wave formation and propagation in cloud cavitating flow however the cavitation region is a high vorticity region and the cavity shedding process is strongly related to the interaction between the cavity and vortex structures although much efforts has been made to investigate the vortex dynamics in cavitating flows huang et al 2013a b ji et al 2014 2015 wang et al 2016 chen et al 2017 long et al 2017a there exist very limited studies of the cavitation vortex dynamics in such complex cavitating flow accompanied by the re entrant flow and the shock wave propagation the present study applied the compressible cavitating flow solver to study the unsteady sheet cloud cavity dynamics around a naca 66 hydrofoil the tait state equation for water and ideal gas state equation for vapor are employed to consider the compressibility effects the objective of this paper are to 1 illustrate the unsteady flow structures during the unsteady sheet cloud cavity evolution 2 study the cavitation vortex dynamics especially under the influence of the cloud cavity collapse induced shock wave propagation 2 physical and mathematical model 2 1 governing equations the set of governing equations based on homogeneous multiphase flows strategy consist of the three dimensional compressible navier stokes equations continuity momentum and energy equations along with a transport equation for the void fraction of vapor 1 ρ m t ρ m u 0 2 ρ m u t ρ m u u p μ m u u t 2 3 u i 3 ρ m c p t t ρ m u c p t κ t 4 ρ l α l t α l ρ l u m m 5 ρ m α ρ v 1 α ρ l 6 μ m α μ v 1 α μ l in the above equations ρ m is the mixture density ρ l is the liquid density ρ v is the vapor density α is the volume fraction u is the velocity tensor i is the unit tensor α l is the liquid fraction α v is the vapor fraction μ m is the mixture dynamic viscosity μ l is the liquid dynamic viscosity μ v is the vapor dynamic viscosity c p is the specific heat t is the temperature k is the thermal conductivity m is the evaporation rate m is the condensation rate respectively the dynamic viscosity of water μ l 1 0018 10 3 pa s and vapor μ v 9 7271 10 6 pa s are assumed constant at 293 15 k due to the weak thermal effects in room temperature the subscripts m l and v denote the mixture liquid and vapor respectively in order to consider the compressibility within the cavitating flows the state of equation for water vapor is used to update the density field in the flow the following tait equation of state for water core 1948 is employed 7 p l b p l s a t b ρ l ρ l s a t n where p sat 2338 6 pa and ρ sat 998 16 kg m3 are the saturation pressure and saturation density of liquid water at 293 15 k according to national institute of standards and technology nist data b 3 06 108 pa and n 7 1 are the fitted constants 2 2 the ideal gas equation of state is applied for vapor 8 p v ρ v r v t v where subscript v denotes vapor phase value and r v 461 6 j kg k is gas constant in the present study the non condensable gas is ignored in the gas phase 2 3 saito cavitation model the cavitation model used in the present work was developed by saito et al 2007 this cavitation model is a transport equation based cavitation model that 9 m c c α 2 1 α 2 max p p v 0 2 π r g t if p p v 10 m c e α 2 1 α 2 ρ l ρ g max p v p 0 2 π r g t if p p v here α is the vapor fraction ρ l is the liquid density ρ v is the vapor density p is the local pressure p v is the saturated vapor pressure t is the temperature and r g 461 6 j kgk is the gas constant c c is the rate coefficient of condensation when local pressure exceeds the saturated vapor pressure and c e is the rate coefficient of evaporation when local pressure below the saturated vapor pressure in the present work c c c e 0 1 is taken according to the study by saito et al 2007 the temperature dependent saturation vapor pressure is given according to the empirical formula schmidt and grigull 1980 as 11 p v p c exp t c t 7 85823 θ 1 83991 θ 1 5 11 7811 θ 3 22 6705 θ 3 5 15 9393 θ 4 1 77516 θ 7 5 with θ 1 t t c the subscript c denotes temperature pressure and density at the critical point for water p c 22 064 mpa ρ c 322 kg m3 t c 647 14 k 2 4 scale adaptive simulation sas sst turbulence model in the present paper the open source software openfoam is used and the compressible urans equations are solved with the sas sst turbulence model menter et al 2003 the sas sst turbulence model is a hybrid rans les model where in the attached flow region like boundary layer the sst model acts showing rans like behaviors and in the unsteady regions the sas is active showing les like behaviors it is not sensitive to the local length scale derived from the computation grid so that can better capture unsteady cavitation instabilities characterized by the multi scale dynamics the von karman length scale l vk based on the second velocity gradients is implemented into the ω equation as a sensor for detecting unsteadiness which allows the sas model to be dynamically scale adaptive to the resolved structures in the unsteady rans calculation the turbulent kinetic energy k equation and the turbulent frequency ω equation are 12 d k d t p k ε x j ν σ k ν t k x j 13 d ω d t γ ν t p k β ω 2 x j ν σ ω ν t ω x j 2 1 f 1 σ ω 2 ω c d k ω q s a s a d d i t i o n t e r m where p k τ i j u i x j is the production of turbulent kinetic energy and c d k ω k x j ω x j is the turbulent cross diffusion term and ε β k ω is the dissipation rate f 1 is the blending function between the ω equation ε equation and f 2 is another blending function the turbulent viscosity is given by ν t a 1 k max a 1 ω s f 2 s s i j s i j the sas term is defined as following 14 q s a s max ρ ζ 2 s 2 l l v k 2 c s a s 2 ρ k σ φ max 1 k 2 k x j k x j 1 ω 2 ω x j ω x j 0 15 l v k κ u y 2 u y 2 where ζ 2 3 51 σ ф 2 3 c sas 2 0 l k c μ 1 4 ω is the length scale of the modeled turbulence when the term ρ ζ 2 s 2 l l v k 2 is larger than c s a s 2 ρ k σ φ max 1 k 2 k x j k x j 1 ω 2 ω x j ω x j the q sas term will be active 3 numerical setup and validation the numerical simulation is conducted through the open source software platform openfoam jasak 1996 which is based on finite volume method the present volume of fraction vof based compressible cavitating flow solver is developed by implementing the phase change algorithm into the native pressure based compressible two phase solver compressibleinterfoam of the open source package openfoam 4 0 the phase change is implicitly treated as a source to implement into the compressible phase volume fraction equation and compressible pressure poisson equation the detailed description of the discretization of the governing equations above and the pressure based numerical method can be found in miller et al 2013 3 1 test case in this paper a two dimensional foil of the naca66 series by leroux et al 2004 is selected the geometry coordinates of the foil can be found in the reference leroux et al 2004 it is characterized by a chord length of c 0 150 m the relative maximum thickness is τ 12 at 45 from the leading edge and the relative maximum chamber is 2 at 50 from the leading edge the experiment data shows that under the condition of attack angle is 6 and the inlet flow velocity is u 5 33 m s at the cavitation number is σ p o u t p v 0 5 ρ l u 2 1 25 lower strouhal number around 0 1 exists and the shock wave dynamics are dominated in the unsteady cavitation instabilities in the present study the large scale cavity cloud collapse emitted shock wave induced newly attached sheet cavity being shorten phenomena and the pressure peaks are focused in the simulation the static pressure is adjusted to vary according to the cavitation number the water temperature is at 293 15 k 3 2 computational domain and boundary conditions the 3d fluid domain is shown in fig 1 a which corresponds to the height of the experimental test section leroux et al 2004 it should be noted that due to the large computational cost to use the real spanwise size of the experimental hydrofoil the spanwise length is chosen as 0 3 c in the present paper the same domain treatment as sagaut 2002 and ji et al 2015 the computational domain has an extent of about 2 c upstream and 6 c downstream of the foil to simulate far field boundary conditions at the inlet and outlet respectively the 3d calculation mesh near the foil surface is shown in fig 1 b the total grid nodes are approximately 2 5 million with 80 nodes uniformly distributed along the spanwise sufficient refinement near the foil surface was generated with the value of y at the first grid point within 1 2 the non reflect boundary conditions are used for inlet and outlet to avoid the pressure reflection a no slip boundary condition is imposed on the hydrofoil surface top and bottom tunnel boundaries and symmetry conditions are imposed on the front and back boundaries the euler scheme for time discretization and gauss upwind scheme for spatial discretization are used in the present simulation in order to reach a high accuracy in time the maximum courant number maxc o is kept below 0 4 and thus the time step 1 10 5 s is chosen the total cavitation simulation time is 0 85 s which includes three complete cavitation cycles to guarantee simulation convergence 3 3 numerical validation fig 2 shows the time evolution of the cavity volume during three cavitation cycles and the power spectral density psd distribution based on fast fourier transform fft analysis of cavity volume it can be found that the sheet cloud cavitation presents quasi periodic behaviors and the cavitation cycle is estimated to be about 3 52 hz according to the psd analysis the comparisons between the experimentally measured and numerically predicted cavitation frequency f and the corresponding cavitation strouhal number st based on the foil chord length are shown in table 1 the relative error is within 3 showing the good accuracy of the present numerical results in predicting the typical cloud cavitation dynamics characterized by low strouhal number 4 results and discussion 4 1 global multiphase structure associated with sheet cloud cavitating flows fig 3 shows the comparisons between the experimentally observed cavity behaviors left leroux et al 2004 the numerically predicted vapor volume fraction iso surface with the absolute pressure contours on symmetry plane and velocity distribution on foil surface middle and the q iso surface q ω ij ω ij s ij s ij 2 70000 by hunt et al 1988 during one typical cavitation cycle in the typical flow condition a complex flow pattern characterized by a lower strouhal number is obtained the leading edge le and trailing edge te of the foil are labeled respectively the flow direction is from right to left as indicated by the red arrow line in fig 3 a meanwhile the temporal space evolution of the vapor volume fraction absolute pressure and velocity distribution at the specific positions as shown in fig 4 during one typical cavity evolution cycle are extracted and shown in fig 5 the positions of the monitors are 1 mm above the foil surface and extended to 1 5 foil chord length it is observed that the sheet cloud cavitation has a distinct quasi periodic patterns the unsteady cavity behaviors can be depicted as the following four stages 1 the growth of the attached cavity sheet in fig 3 a b c d and i 2 the development of re entrant flow and attached cavity sheet breakup in fig 3 e 3 attached cavity sheet being rolled up and cloud cavity shed downstream in fig 3 f and g 4 cloud cavity collapse and shock wave generation and propagation in fig 3 h during the first stage the attached cavity sheet begins to form at the foil leading edge and grows downstream towards the trailing edge as shown in fig 3 a b c and d the q isosurface has the similar shape as the attached cavity shape indicating that the cavitation region is a high vorticity region a vortex pair can also be found concentrate at the foil trailing edge the velocity vector on the foil surface shows the existence of the reverse vortex there as indicated by the red curved arrows as shown in fig 3 b with the attached cavity development the q isosurface becomes broken illustrating small vortex structures within the attached cavitation region as presented in fig 3 b it can be found that the velocity magnitude distribution on the foil surface shows that the velocity within the attached cavity region is relatively lower than that outside of the attached cavity region indicating the relatively stable characteristics within the cavity as shown by the velocity vectors on region covered by the attached cavity it can be concluded that cavitating flows are highly turbulent with many multi scale vortical structures as can be seen in fig 5 c the re entrant flow appears at t t ref 0 053 and then develops with the attached cavity growth during the second stage when the attached cavity sheet reaches to a certain length a relatively high speed re entrant flow as shown in fig 5 c with the blue arrow generates at the rear of the attached cavity sheet and moves upstream when the re entrant flow arrives at the leading edge it will cut off the attached cavity sheet and cause the attached cavity sheet breakup the q isosurface is more broken with small vortex structures generated during the re entrant flow movement higher and lower velocity streaks as shown in fig 3 e can be found during the third stage the broken cavity sheet is being rolled up and shed downstream and eventually a u shape cloud cavity forms the u shape cloud cavity legs consist of high vorticity as shown in the q surface in fig 3 g during the fourth stage when the cloud cavity being transported into high pressure region it will collapse and the shock wave propagation and rebound phenomena along with high absolute pressure propagation takes place as indicated by the white arrows in fig 5 b it can be found that with the shock wave rebound process may be more than one time with the shock wave magnitude attenuation the shock wave will propagate both upstream and downstream originating from the cloud cavity collapse position the averaged shock propagation speed from the cavity cloud collapse position to the foil leading edge is about 49 3 m s based on the temporal spatial diagram in fig 5 b which reflects the sharp reduction in speed of sound in vapor water mixture compared with that in pure water for 1450 m s when the upstream propagating shock wave meets the newly attached cavity sheet it will cause the thin cavity sheet collapse it is supposed the shock wave propagation and rebound is responsible for the reduction of cavitation evolution strouhal number the detailed description of the shock wave propagation process will be given following fig 6 shows the typical instances during the large scale cloud cavity collapse process namely u shape cloud cavity formation u shape cloud cavity head collapse u shape cloud cavity legs collapse and shock wave emission stages respectively it can be observed that the newly cavity sheet grows to beyond x c 0 3 before the cloud cavity collapse event takes place after the collapse event takes place the emitted shock wave propagates rapidly when it arrives at the cavity sheet region it will make the cavity sheet collapse after that the flows induced low pressure region grows towards the downstream from the foil leading edge to trailing edge the absolute pressure fluctuations during the shock wave formation and propagation process at positions x c 0 1 0 9 along the foil surface at the mid plane are plotted in fig 7 a the average void fraction is averaged using the void fraction at start point and end instances during shock wave propagation α v α v t1 α v t2 two shock wave propagation events are observed event i cloud cavity collapse induced shock wave propagation and event ii it is supposed to be happened by the leading edge collapse induced shock wave propagation according to the pressure signals the average absolute pressure propagation speed along with the average void fraction and corresponding wallis sound speed 1 ρ c 2 α v ρ v c v 2 1 α v ρ l c l 2 is shown in fig 7 b the threshold value 25 kpa is used to calculate the cloud cavity collapse induced shock wave propagation speed it can be found that lowest speed of shock wave propagation in the cavitation region reaches 35 7 m s between 0 1 c to 0 2 c with the average void fraction around α v 0 13 it can be found that the vapor fraction has a significant effects on the pressure propagation speed the cloud cavity collapse induced shock wave propagation speed in event i has the lower propagation speed than that during the leading edge sheet cavity collapse induced shock wave propagation in event ii where after the event i the void fraction reduces due to shock wave propagation which can be observed by the average void distribution in fig 7 b during the leading edge sheet cavity collapse induced shock wave propagation in event 2 just after the cloud cavity collapse induced newly cavity sheet collapse the propagation has the fast propagation speed due to collapse created lower vapor fraction it should be noted that the wallis s sound speed variation trend is in agreement with the void fraction variation however the walls sound speed is smaller than the shock wave propagation speed based on the pressure signals the reasons for the discrepancy may be that firstly the average shock wave speed calculation is based on the propagation process and along the propagation path the void fraction is variable while the wallis sound speed calculation is based on the average void fraction on start and end points secondly the wallis s sound speed formula ignores the non equilibrium effects heat transfer and mass transfer which are important in the cavity cloud collapse process 4 2 the cavitation vortex dynamics analysis fig 8 shows the three dimensional isosurfaces of vorticity x vorticity y and vorticity z at typical transient cavity evolution stages the development of attached cavity sheet the movement of re entrant flow the shedding of cloud cavity and the cloud cavity collapse induced shock wave emittion and propagation respectively the black isosurface indicates the vorticity value of 500 and the white isosurface indicates the vorticity value of 500 it can be found that the isosurface of vorticity z has the largest distribution region than that of vorticity x and vorticity y indicating the vorticity z dominates the cavitation vortex dynamics and the high vorticity region in all three directions are all highly related to the cavity regions the trailing edge vortex is mainly composed of vorticity z as shown by the vorticity z isosurface during the attached cavity sheet growth stage as shown in fig 8 a the vorticity x distributes in the region of attached cavity and vorticity y distributes streaks along the streamwise direction during the re entrant flow development stage as shown in fig 8 b the high vorticity region enlarges characterized by the larger vorticity x distribution region and the longer vorticity y streaks during the cloud cavity shedding stage the cloud cavity mainly consists of vorticity x and vorticity y as shown in fig 8 c during the cloud cavity collapse induced shock wave propagation stage vorticity y can be found within the collapse region in the foil wake as indicated by the red dashed circle and the newly attached cavity sheet are composed of vorticity x and vorticity z as indicated by the yellow dashed circles from above it can be obtained that the unsteady flow structures in the cavitating flow process is different especially during the four cavitation development stages in order to investigate the differences of cavitation vortex interaction in the cavitation evolution especially in the process of the re entrant flow development and the shock wave propagation the vorticity transportation equation in the compressible turbulent flow region is employed as follows 16 d ω d t ω ω v ρ m p ρ m 2 ν m ν t 2 ω in the transport equation the first term on the right hand side rhs is the vortex stretching term representing the stretching and tilting of a vortex by velocity gradients the second term on the rhs is the vortex dilatation term representing the volumetric expansion contraction this describes the role of fluid compressibility effects on the vorticity transport the third term on the rhs is the baroclinic torque representing the role of misaligned pressure and density gradients the last term on the rhs is the viscosity diffusion term indicating the rate at which the vorticity changes due to vorticity viscosity diffusion it should be noted that the viscous diffusion term has a much smaller effects on the vorticity transportation than other three terms in high reynolds number flows huang et al 2013b ji et al 2014 the predicted contours of vortex stretching term vortex dilatation term and baroclinic torque term in vorticity z transport equation which dominates the vortex dynamics at the mid plane of the hydrofoil as well as the ratio of baroclinic term and vortex stretching term and the vortex dilatation term are presented in fig 9 at four typical cavitating shedding instances namely the attached cavity growth the re entrant flow movement cloud cavity being shedding and cloud cavity collapse induced shock wave propagation process respectively to study the cavitation vortex interaction more detailed from the contours of the ratio of baroclinic term and the vortex stretching term and the vortex dilatation term respectively it can be clearly seen that the baroclinic term mainly dominates the vorticity transportation process in the process of attached cavity growth in fig 9 a the vortex stretching term and vortex baroclinic term distribution is stronger than that the vortex dilatation term the ratio of the baroclinic term and vortex stretching term shows the dominant influence of baroclinic term on the vorticity transport process in the re entrant flow process as shown in fig 9 b it can be observed that the vortex the baroclinic torque term plays a main role in the vortex transport process than the vortex stretching term and the vortex dilatation term as well as that indicated by the ration of baroclinic term and the vortex stretching term and the vortex dilatation term in the cavity cloud shedding process in fig 9 c the vortex dilatation term and the baroclinic term are stronger than the vortex stretching term and from the ratio distribution it can be observed that the baroclinic term dominates in the cavity collapsed induced shock wave propagation process in fig 9 d the vortex dilatation term plays the major role in the vortex transport indicated by both the budget of vorticity transport equation distribution and the budget ratio it may be the reason that the re entrant flow is induced by the adverse pressure gradient which will significantly influence the baroclinic torque term while the shock wave is highly related with the compressibility effects and thus the vortex dilatation term is mainly influenced by the shock wave propagation 5 discussion and conclusions in this paper the unsteady cavitating flow around a naca66 hydrofoil fixed at the angle of attack aoa 6 at σ 1 25 has been numerically simulated and the unsteady cavitating flow structures and the cavitation vortex dynamics especially in the process of the re entrant flow movement and the cloud cavity collapse induced shock wave formation and propagation have been analyzed the numerical simulation is performed using compressible cavitation solver closured by the tait equation of state for water and ideal gas equation of state for vapor to consider both the water vapor and water vapor mixture compressibility based on the openfoam platform several flow features involved transient cavitation behaviors accompanied with the re entrant flow and shock wave formation and propagation are addressed 1 the cavity evolution presents quasi periodic behaviors and the alternative re entrant flow movement and shock wave dynamics play an important role in cavitation vortex dynamics the unsteady cavitation behaviors can be divided into four stages a the growth of the attached cavity sheet b the development of re entrant flow and attached cavity sheet breakup c attached cavity sheet being rolled up and cloud cavity shed downstream and d cloud cavity collapse and shock wave generation and propagation among which the cloud cavity collapse process can be further depicted into three stages a the formation of the u shape cloud cavity b the collapse of u shape cavity head and c the collapse of u shape cavity legs the collapse of the u shape cavity legs is the main source of shock wave emittion 2 the cavitation vortex dynamics show strong coherent relationship with the transient cavity behaviors the vorticity z dominates the cavitation vortex dynamics during the attached cavity growth stage the vortex stretching term and vortex baroclinic term distribution is stronger than that the vortex dilatation term during the re entrant flow process the vortex the baroclinic torque term plays a main role in the vortex transport process during the cavity cloud shedding process the vortex dilatation term and the baroclinic term dominate the ratio of baroclinic term and the vortex stretching term vortex dilatation term further indicates the dominant role of baroclinic term in the cavity growth development and shedding process during the cavity collapsed induced shock wave propagation process the budget of vorticity transport as well as the ratio of baroclinic torque term to the vortex stretching vortex dilatation shows that the vortex dilatation term plays the major role in the vortex transport in the attached cavity sheet region regarding future work further research on unsteady cavitation vortex structures will be conducted from the lagrangian viewpoint the lagrangian coherent structures lcs method has the advantage that the lcs method could define transient vortex structure boundaries without relying on a threshold and could reveal more vortical structures than classical eulerian fields acknowledgement the authors gratefully acknowledge support by the national postdoctoral program for innovative talents grant no bx201700126 the national foundational of china nsfc grant nos 51239005 and 51679005 national natural science foundation of beijing grant no 3172029 and the open foundation of state key laboratory of ocean engineering shanghai jiao tong university china grant no 1611 
23467,the objective of this paper is to study the cavitation vortex dynamics in compressible turbulent cavitating flow around a naca66 hydrofoil the simulations are conducted based on the open source software openfoam solving the compressible governing equations together with the tait state equation for water and ideal gas state equation for vapor the saito cavitation model is used to model the cavitation phase change process and sas sst turbulence model is adopted to account for the turbulence effects the numerical results showed a good agreement with the experiments the cavity evolution presents quasi periodic behaviors and the alternative re entrant flow movement and shock wave dynamics play an important role in cavitation vortex dynamics strong coherent relationship between cavitation behaviors and vortex dynamics is illustrated based on the budget analysis of vorticity transport equation it shows that during the attached cavity growth the re entrant flow development and the cloud cavity being shed stages the baroclinic torque term dominates the vorticity transport process during the shock wave propagation stage the vortex dilatation term dominates in the attached cavity sheet region besides the baroclinic torque term has strong influence on vorticity transport characteristics keywords cavitating flows cavitation vortex dynamics compressible cavitating solver shock wave openfoam 1 introduction hydrodynamic cavitation is generally undesirable phenomena due to its severe damage to the hydraulic systems such as pumps turbines marine propellers and rocket propulsion inducers in fluid machinery and spillway in hydropower station knapp et al 1970 brennen 1995 wang et al 2001 the very destructive effects such as pressure fluctuations variation noise and erosion are suffered in the condition of sheet cloud cavitation which is characterized by periodic breakup of attached cavity sheet shedding and collapse of cloud cavity soyama et al 1992 joseph 1995 reisman 1996 chen et al 2015 wang et al 2017b wu et al 2015 2018 many researchers have conducted investigations for the shedding mechanism of the cloud cavity among which the shock wave propagation during the cloud cavity collapse is supposed to be the main region for the cloud cavitation instabilities reisman et al 1998 leroux et al 2005 budich et al 2015 wang et al 2017a it has also been pointed out that a marked decrease in the sound speed phenomena appears in liquid gas mixture by wallis 1967 and brennen 1995 and thus it is very likely that the local liquid gas flows reaches to transonic or supersonic speed even when the bulk flow velocity is relatively low hence it is necessary to understand the coherent interaction between the shock phenomena and the multiphase compressible flow dynamics numerous researchers have experimentally measured the pressure pulses in the cavitating flows avellan and farhat 1989 le et al 1994 mckenney and brennen 1994 reisman et al 1994 and investigated the shock wave propagation characteristics in the bubbly mixture noordij and wijngaarden 1974 mørch 1980 1981 hanson et al 1981 reisman and brennen 1996 conducted experiments to investigate the pressure impulses emitted in the cloud cavitation systematically using piezo electric transducers on both stationary and oscillating hydrofoils they observed that pressure pulses are highly related with the large low void fraction region which is supposed to be caused by the cavity collapse event the impulse intensity was enhanced with the increasing of inlet speed and the decreasing of cavitation number after that they further concluded that the shock wave dynamics led to the damage and noise in cavitating flows arndt et al 2001 applied a combined experimental and numerical method to investigate the sheet cloud cavitation dynamics around a naca0015 hydrofoil they concluded that at low value of σ 2α the bubbly shock mechanism is the cause of the cloud cavitation generation leroux et al 2004 employed the wall pressure transducers to investigate partial cavity instabilities around a naca66 hydrofoil they showed that at the condition of σ 1 25 at attack of angle aoa 6 the cloud cavity collapse induced shock wave would significantly cause the newly growth attached sheet cavity being shorten and collapsed and thus resulting in the cavitation cycle increase and the cavitation strouhal number reduction recently ganesh et al 2016 used high speed video and time resolved x ray densitometry to investigate the sheet to cloud cavitation transition mechanism in a venturi section the shock wave propagation in the attached cavity was well observed and it was concluded that the shock wave propagation mechanism dominates the periodic large scale cloud cavity shedding process wu et al 2016a used hydrophone measurements accompanied with high speed videos and time resolved x ray densitometry to investigate the partial cavity shedding dynamics around a naca0015 hydrofoil they observed that with the reduction of the cavitation number the cavity dynamics changed from the pinch off from the rear of the cavity caused by the re entrant jet to a propagation bubbly shockwave mechanism caused by the collapse of the shed cloud cavity with the development of the numerical technique most past simulations adopt the incompressible method in the cavitation calculation bensow and bark 2010 li et al 2008 huang et al 2014 wu et al 2016b yu et al 2017 considering that the shock wave phenomena in complex cavitating flows is highly related to the compressible characteristics it is necessary to employ the compressible solver into the cavitating flow numerical simulations kunz et al 2001 sezal et al 2009 haren et al 2016 gnanaskandan and mahesh 2016 egerer et al 2016 the solving of compressible multiphase equations is a challenging problem carrying a significant computational burden and requires careful treatment in which the selection of time step is critical to guarantee the convergence and should satisfy the maximum courant number criteria venkateswaran et al 2002 applied a preconditioned time marching algorithm to investigate the compressibility effects of cavitating flow the results showed that the method considering the compressibility can improve the cavitation dynamics compared with the previous incompressible computations saito et al 2007 developed the compressible two phase navier stokes equations and applied them to investigate the unsteady behaviors of cloud cavitation around a naca 0015 hydrofoil the method accurately captured the u shape cloud cavity which is supposed to be related to the cavity collapse event schnerr et al 2008 developed the compressible cavitating flow solver to investigate the collapse induced shock wave dynamics with nanosecond time step the pressure peak up to 230 bar was calculated as the shock wave was induced by the cloud cavity collapse however investigation on the cavitation vortex dynamics concerning with the cavitation compressible characteristics especially in the complex cavitating flows along with the shock wave dynamics has been rarely conducted the turbulence model plays an important role in high reynolds number cavitating flows although the rans approach has been widely used to simulate turbulent cavitating flows it has the weakness of the over prediction of turbulent eddy viscosity in multiphase mixture region coutier degosha et al 2003 reboud et al 2008 huang et al 2013a 2013b long et al 2017b the les approach requires much more computational resources wang and ostoja stazewski 2007 ji et al 2015 huang et al 2014 thus some hybrid rans les turbulence models have been developed ducoin et al 2012 huang et al 2013b chen et al 2016 different from the grid based hybrid turbulence mode the rans and les transition of the sst sas scale adaptive simulation turbulence model is based on local turbulence structures von karman length scale considering the multi scale characteristics in both time and space domain in unsteady cavitating flows the sst sas can solve more smaller turbulence eddy structures and better capture the unsteady instabilities involved in the multi scale cavitation dynamics most of the experimental and numerical researches have mainly focused on the cavity patterns and pressure characteristics during the shock wave formation and propagation in cloud cavitating flow however the cavitation region is a high vorticity region and the cavity shedding process is strongly related to the interaction between the cavity and vortex structures although much efforts has been made to investigate the vortex dynamics in cavitating flows huang et al 2013a b ji et al 2014 2015 wang et al 2016 chen et al 2017 long et al 2017a there exist very limited studies of the cavitation vortex dynamics in such complex cavitating flow accompanied by the re entrant flow and the shock wave propagation the present study applied the compressible cavitating flow solver to study the unsteady sheet cloud cavity dynamics around a naca 66 hydrofoil the tait state equation for water and ideal gas state equation for vapor are employed to consider the compressibility effects the objective of this paper are to 1 illustrate the unsteady flow structures during the unsteady sheet cloud cavity evolution 2 study the cavitation vortex dynamics especially under the influence of the cloud cavity collapse induced shock wave propagation 2 physical and mathematical model 2 1 governing equations the set of governing equations based on homogeneous multiphase flows strategy consist of the three dimensional compressible navier stokes equations continuity momentum and energy equations along with a transport equation for the void fraction of vapor 1 ρ m t ρ m u 0 2 ρ m u t ρ m u u p μ m u u t 2 3 u i 3 ρ m c p t t ρ m u c p t κ t 4 ρ l α l t α l ρ l u m m 5 ρ m α ρ v 1 α ρ l 6 μ m α μ v 1 α μ l in the above equations ρ m is the mixture density ρ l is the liquid density ρ v is the vapor density α is the volume fraction u is the velocity tensor i is the unit tensor α l is the liquid fraction α v is the vapor fraction μ m is the mixture dynamic viscosity μ l is the liquid dynamic viscosity μ v is the vapor dynamic viscosity c p is the specific heat t is the temperature k is the thermal conductivity m is the evaporation rate m is the condensation rate respectively the dynamic viscosity of water μ l 1 0018 10 3 pa s and vapor μ v 9 7271 10 6 pa s are assumed constant at 293 15 k due to the weak thermal effects in room temperature the subscripts m l and v denote the mixture liquid and vapor respectively in order to consider the compressibility within the cavitating flows the state of equation for water vapor is used to update the density field in the flow the following tait equation of state for water core 1948 is employed 7 p l b p l s a t b ρ l ρ l s a t n where p sat 2338 6 pa and ρ sat 998 16 kg m3 are the saturation pressure and saturation density of liquid water at 293 15 k according to national institute of standards and technology nist data b 3 06 108 pa and n 7 1 are the fitted constants 2 2 the ideal gas equation of state is applied for vapor 8 p v ρ v r v t v where subscript v denotes vapor phase value and r v 461 6 j kg k is gas constant in the present study the non condensable gas is ignored in the gas phase 2 3 saito cavitation model the cavitation model used in the present work was developed by saito et al 2007 this cavitation model is a transport equation based cavitation model that 9 m c c α 2 1 α 2 max p p v 0 2 π r g t if p p v 10 m c e α 2 1 α 2 ρ l ρ g max p v p 0 2 π r g t if p p v here α is the vapor fraction ρ l is the liquid density ρ v is the vapor density p is the local pressure p v is the saturated vapor pressure t is the temperature and r g 461 6 j kgk is the gas constant c c is the rate coefficient of condensation when local pressure exceeds the saturated vapor pressure and c e is the rate coefficient of evaporation when local pressure below the saturated vapor pressure in the present work c c c e 0 1 is taken according to the study by saito et al 2007 the temperature dependent saturation vapor pressure is given according to the empirical formula schmidt and grigull 1980 as 11 p v p c exp t c t 7 85823 θ 1 83991 θ 1 5 11 7811 θ 3 22 6705 θ 3 5 15 9393 θ 4 1 77516 θ 7 5 with θ 1 t t c the subscript c denotes temperature pressure and density at the critical point for water p c 22 064 mpa ρ c 322 kg m3 t c 647 14 k 2 4 scale adaptive simulation sas sst turbulence model in the present paper the open source software openfoam is used and the compressible urans equations are solved with the sas sst turbulence model menter et al 2003 the sas sst turbulence model is a hybrid rans les model where in the attached flow region like boundary layer the sst model acts showing rans like behaviors and in the unsteady regions the sas is active showing les like behaviors it is not sensitive to the local length scale derived from the computation grid so that can better capture unsteady cavitation instabilities characterized by the multi scale dynamics the von karman length scale l vk based on the second velocity gradients is implemented into the ω equation as a sensor for detecting unsteadiness which allows the sas model to be dynamically scale adaptive to the resolved structures in the unsteady rans calculation the turbulent kinetic energy k equation and the turbulent frequency ω equation are 12 d k d t p k ε x j ν σ k ν t k x j 13 d ω d t γ ν t p k β ω 2 x j ν σ ω ν t ω x j 2 1 f 1 σ ω 2 ω c d k ω q s a s a d d i t i o n t e r m where p k τ i j u i x j is the production of turbulent kinetic energy and c d k ω k x j ω x j is the turbulent cross diffusion term and ε β k ω is the dissipation rate f 1 is the blending function between the ω equation ε equation and f 2 is another blending function the turbulent viscosity is given by ν t a 1 k max a 1 ω s f 2 s s i j s i j the sas term is defined as following 14 q s a s max ρ ζ 2 s 2 l l v k 2 c s a s 2 ρ k σ φ max 1 k 2 k x j k x j 1 ω 2 ω x j ω x j 0 15 l v k κ u y 2 u y 2 where ζ 2 3 51 σ ф 2 3 c sas 2 0 l k c μ 1 4 ω is the length scale of the modeled turbulence when the term ρ ζ 2 s 2 l l v k 2 is larger than c s a s 2 ρ k σ φ max 1 k 2 k x j k x j 1 ω 2 ω x j ω x j the q sas term will be active 3 numerical setup and validation the numerical simulation is conducted through the open source software platform openfoam jasak 1996 which is based on finite volume method the present volume of fraction vof based compressible cavitating flow solver is developed by implementing the phase change algorithm into the native pressure based compressible two phase solver compressibleinterfoam of the open source package openfoam 4 0 the phase change is implicitly treated as a source to implement into the compressible phase volume fraction equation and compressible pressure poisson equation the detailed description of the discretization of the governing equations above and the pressure based numerical method can be found in miller et al 2013 3 1 test case in this paper a two dimensional foil of the naca66 series by leroux et al 2004 is selected the geometry coordinates of the foil can be found in the reference leroux et al 2004 it is characterized by a chord length of c 0 150 m the relative maximum thickness is τ 12 at 45 from the leading edge and the relative maximum chamber is 2 at 50 from the leading edge the experiment data shows that under the condition of attack angle is 6 and the inlet flow velocity is u 5 33 m s at the cavitation number is σ p o u t p v 0 5 ρ l u 2 1 25 lower strouhal number around 0 1 exists and the shock wave dynamics are dominated in the unsteady cavitation instabilities in the present study the large scale cavity cloud collapse emitted shock wave induced newly attached sheet cavity being shorten phenomena and the pressure peaks are focused in the simulation the static pressure is adjusted to vary according to the cavitation number the water temperature is at 293 15 k 3 2 computational domain and boundary conditions the 3d fluid domain is shown in fig 1 a which corresponds to the height of the experimental test section leroux et al 2004 it should be noted that due to the large computational cost to use the real spanwise size of the experimental hydrofoil the spanwise length is chosen as 0 3 c in the present paper the same domain treatment as sagaut 2002 and ji et al 2015 the computational domain has an extent of about 2 c upstream and 6 c downstream of the foil to simulate far field boundary conditions at the inlet and outlet respectively the 3d calculation mesh near the foil surface is shown in fig 1 b the total grid nodes are approximately 2 5 million with 80 nodes uniformly distributed along the spanwise sufficient refinement near the foil surface was generated with the value of y at the first grid point within 1 2 the non reflect boundary conditions are used for inlet and outlet to avoid the pressure reflection a no slip boundary condition is imposed on the hydrofoil surface top and bottom tunnel boundaries and symmetry conditions are imposed on the front and back boundaries the euler scheme for time discretization and gauss upwind scheme for spatial discretization are used in the present simulation in order to reach a high accuracy in time the maximum courant number maxc o is kept below 0 4 and thus the time step 1 10 5 s is chosen the total cavitation simulation time is 0 85 s which includes three complete cavitation cycles to guarantee simulation convergence 3 3 numerical validation fig 2 shows the time evolution of the cavity volume during three cavitation cycles and the power spectral density psd distribution based on fast fourier transform fft analysis of cavity volume it can be found that the sheet cloud cavitation presents quasi periodic behaviors and the cavitation cycle is estimated to be about 3 52 hz according to the psd analysis the comparisons between the experimentally measured and numerically predicted cavitation frequency f and the corresponding cavitation strouhal number st based on the foil chord length are shown in table 1 the relative error is within 3 showing the good accuracy of the present numerical results in predicting the typical cloud cavitation dynamics characterized by low strouhal number 4 results and discussion 4 1 global multiphase structure associated with sheet cloud cavitating flows fig 3 shows the comparisons between the experimentally observed cavity behaviors left leroux et al 2004 the numerically predicted vapor volume fraction iso surface with the absolute pressure contours on symmetry plane and velocity distribution on foil surface middle and the q iso surface q ω ij ω ij s ij s ij 2 70000 by hunt et al 1988 during one typical cavitation cycle in the typical flow condition a complex flow pattern characterized by a lower strouhal number is obtained the leading edge le and trailing edge te of the foil are labeled respectively the flow direction is from right to left as indicated by the red arrow line in fig 3 a meanwhile the temporal space evolution of the vapor volume fraction absolute pressure and velocity distribution at the specific positions as shown in fig 4 during one typical cavity evolution cycle are extracted and shown in fig 5 the positions of the monitors are 1 mm above the foil surface and extended to 1 5 foil chord length it is observed that the sheet cloud cavitation has a distinct quasi periodic patterns the unsteady cavity behaviors can be depicted as the following four stages 1 the growth of the attached cavity sheet in fig 3 a b c d and i 2 the development of re entrant flow and attached cavity sheet breakup in fig 3 e 3 attached cavity sheet being rolled up and cloud cavity shed downstream in fig 3 f and g 4 cloud cavity collapse and shock wave generation and propagation in fig 3 h during the first stage the attached cavity sheet begins to form at the foil leading edge and grows downstream towards the trailing edge as shown in fig 3 a b c and d the q isosurface has the similar shape as the attached cavity shape indicating that the cavitation region is a high vorticity region a vortex pair can also be found concentrate at the foil trailing edge the velocity vector on the foil surface shows the existence of the reverse vortex there as indicated by the red curved arrows as shown in fig 3 b with the attached cavity development the q isosurface becomes broken illustrating small vortex structures within the attached cavitation region as presented in fig 3 b it can be found that the velocity magnitude distribution on the foil surface shows that the velocity within the attached cavity region is relatively lower than that outside of the attached cavity region indicating the relatively stable characteristics within the cavity as shown by the velocity vectors on region covered by the attached cavity it can be concluded that cavitating flows are highly turbulent with many multi scale vortical structures as can be seen in fig 5 c the re entrant flow appears at t t ref 0 053 and then develops with the attached cavity growth during the second stage when the attached cavity sheet reaches to a certain length a relatively high speed re entrant flow as shown in fig 5 c with the blue arrow generates at the rear of the attached cavity sheet and moves upstream when the re entrant flow arrives at the leading edge it will cut off the attached cavity sheet and cause the attached cavity sheet breakup the q isosurface is more broken with small vortex structures generated during the re entrant flow movement higher and lower velocity streaks as shown in fig 3 e can be found during the third stage the broken cavity sheet is being rolled up and shed downstream and eventually a u shape cloud cavity forms the u shape cloud cavity legs consist of high vorticity as shown in the q surface in fig 3 g during the fourth stage when the cloud cavity being transported into high pressure region it will collapse and the shock wave propagation and rebound phenomena along with high absolute pressure propagation takes place as indicated by the white arrows in fig 5 b it can be found that with the shock wave rebound process may be more than one time with the shock wave magnitude attenuation the shock wave will propagate both upstream and downstream originating from the cloud cavity collapse position the averaged shock propagation speed from the cavity cloud collapse position to the foil leading edge is about 49 3 m s based on the temporal spatial diagram in fig 5 b which reflects the sharp reduction in speed of sound in vapor water mixture compared with that in pure water for 1450 m s when the upstream propagating shock wave meets the newly attached cavity sheet it will cause the thin cavity sheet collapse it is supposed the shock wave propagation and rebound is responsible for the reduction of cavitation evolution strouhal number the detailed description of the shock wave propagation process will be given following fig 6 shows the typical instances during the large scale cloud cavity collapse process namely u shape cloud cavity formation u shape cloud cavity head collapse u shape cloud cavity legs collapse and shock wave emission stages respectively it can be observed that the newly cavity sheet grows to beyond x c 0 3 before the cloud cavity collapse event takes place after the collapse event takes place the emitted shock wave propagates rapidly when it arrives at the cavity sheet region it will make the cavity sheet collapse after that the flows induced low pressure region grows towards the downstream from the foil leading edge to trailing edge the absolute pressure fluctuations during the shock wave formation and propagation process at positions x c 0 1 0 9 along the foil surface at the mid plane are plotted in fig 7 a the average void fraction is averaged using the void fraction at start point and end instances during shock wave propagation α v α v t1 α v t2 two shock wave propagation events are observed event i cloud cavity collapse induced shock wave propagation and event ii it is supposed to be happened by the leading edge collapse induced shock wave propagation according to the pressure signals the average absolute pressure propagation speed along with the average void fraction and corresponding wallis sound speed 1 ρ c 2 α v ρ v c v 2 1 α v ρ l c l 2 is shown in fig 7 b the threshold value 25 kpa is used to calculate the cloud cavity collapse induced shock wave propagation speed it can be found that lowest speed of shock wave propagation in the cavitation region reaches 35 7 m s between 0 1 c to 0 2 c with the average void fraction around α v 0 13 it can be found that the vapor fraction has a significant effects on the pressure propagation speed the cloud cavity collapse induced shock wave propagation speed in event i has the lower propagation speed than that during the leading edge sheet cavity collapse induced shock wave propagation in event ii where after the event i the void fraction reduces due to shock wave propagation which can be observed by the average void distribution in fig 7 b during the leading edge sheet cavity collapse induced shock wave propagation in event 2 just after the cloud cavity collapse induced newly cavity sheet collapse the propagation has the fast propagation speed due to collapse created lower vapor fraction it should be noted that the wallis s sound speed variation trend is in agreement with the void fraction variation however the walls sound speed is smaller than the shock wave propagation speed based on the pressure signals the reasons for the discrepancy may be that firstly the average shock wave speed calculation is based on the propagation process and along the propagation path the void fraction is variable while the wallis sound speed calculation is based on the average void fraction on start and end points secondly the wallis s sound speed formula ignores the non equilibrium effects heat transfer and mass transfer which are important in the cavity cloud collapse process 4 2 the cavitation vortex dynamics analysis fig 8 shows the three dimensional isosurfaces of vorticity x vorticity y and vorticity z at typical transient cavity evolution stages the development of attached cavity sheet the movement of re entrant flow the shedding of cloud cavity and the cloud cavity collapse induced shock wave emittion and propagation respectively the black isosurface indicates the vorticity value of 500 and the white isosurface indicates the vorticity value of 500 it can be found that the isosurface of vorticity z has the largest distribution region than that of vorticity x and vorticity y indicating the vorticity z dominates the cavitation vortex dynamics and the high vorticity region in all three directions are all highly related to the cavity regions the trailing edge vortex is mainly composed of vorticity z as shown by the vorticity z isosurface during the attached cavity sheet growth stage as shown in fig 8 a the vorticity x distributes in the region of attached cavity and vorticity y distributes streaks along the streamwise direction during the re entrant flow development stage as shown in fig 8 b the high vorticity region enlarges characterized by the larger vorticity x distribution region and the longer vorticity y streaks during the cloud cavity shedding stage the cloud cavity mainly consists of vorticity x and vorticity y as shown in fig 8 c during the cloud cavity collapse induced shock wave propagation stage vorticity y can be found within the collapse region in the foil wake as indicated by the red dashed circle and the newly attached cavity sheet are composed of vorticity x and vorticity z as indicated by the yellow dashed circles from above it can be obtained that the unsteady flow structures in the cavitating flow process is different especially during the four cavitation development stages in order to investigate the differences of cavitation vortex interaction in the cavitation evolution especially in the process of the re entrant flow development and the shock wave propagation the vorticity transportation equation in the compressible turbulent flow region is employed as follows 16 d ω d t ω ω v ρ m p ρ m 2 ν m ν t 2 ω in the transport equation the first term on the right hand side rhs is the vortex stretching term representing the stretching and tilting of a vortex by velocity gradients the second term on the rhs is the vortex dilatation term representing the volumetric expansion contraction this describes the role of fluid compressibility effects on the vorticity transport the third term on the rhs is the baroclinic torque representing the role of misaligned pressure and density gradients the last term on the rhs is the viscosity diffusion term indicating the rate at which the vorticity changes due to vorticity viscosity diffusion it should be noted that the viscous diffusion term has a much smaller effects on the vorticity transportation than other three terms in high reynolds number flows huang et al 2013b ji et al 2014 the predicted contours of vortex stretching term vortex dilatation term and baroclinic torque term in vorticity z transport equation which dominates the vortex dynamics at the mid plane of the hydrofoil as well as the ratio of baroclinic term and vortex stretching term and the vortex dilatation term are presented in fig 9 at four typical cavitating shedding instances namely the attached cavity growth the re entrant flow movement cloud cavity being shedding and cloud cavity collapse induced shock wave propagation process respectively to study the cavitation vortex interaction more detailed from the contours of the ratio of baroclinic term and the vortex stretching term and the vortex dilatation term respectively it can be clearly seen that the baroclinic term mainly dominates the vorticity transportation process in the process of attached cavity growth in fig 9 a the vortex stretching term and vortex baroclinic term distribution is stronger than that the vortex dilatation term the ratio of the baroclinic term and vortex stretching term shows the dominant influence of baroclinic term on the vorticity transport process in the re entrant flow process as shown in fig 9 b it can be observed that the vortex the baroclinic torque term plays a main role in the vortex transport process than the vortex stretching term and the vortex dilatation term as well as that indicated by the ration of baroclinic term and the vortex stretching term and the vortex dilatation term in the cavity cloud shedding process in fig 9 c the vortex dilatation term and the baroclinic term are stronger than the vortex stretching term and from the ratio distribution it can be observed that the baroclinic term dominates in the cavity collapsed induced shock wave propagation process in fig 9 d the vortex dilatation term plays the major role in the vortex transport indicated by both the budget of vorticity transport equation distribution and the budget ratio it may be the reason that the re entrant flow is induced by the adverse pressure gradient which will significantly influence the baroclinic torque term while the shock wave is highly related with the compressibility effects and thus the vortex dilatation term is mainly influenced by the shock wave propagation 5 discussion and conclusions in this paper the unsteady cavitating flow around a naca66 hydrofoil fixed at the angle of attack aoa 6 at σ 1 25 has been numerically simulated and the unsteady cavitating flow structures and the cavitation vortex dynamics especially in the process of the re entrant flow movement and the cloud cavity collapse induced shock wave formation and propagation have been analyzed the numerical simulation is performed using compressible cavitation solver closured by the tait equation of state for water and ideal gas equation of state for vapor to consider both the water vapor and water vapor mixture compressibility based on the openfoam platform several flow features involved transient cavitation behaviors accompanied with the re entrant flow and shock wave formation and propagation are addressed 1 the cavity evolution presents quasi periodic behaviors and the alternative re entrant flow movement and shock wave dynamics play an important role in cavitation vortex dynamics the unsteady cavitation behaviors can be divided into four stages a the growth of the attached cavity sheet b the development of re entrant flow and attached cavity sheet breakup c attached cavity sheet being rolled up and cloud cavity shed downstream and d cloud cavity collapse and shock wave generation and propagation among which the cloud cavity collapse process can be further depicted into three stages a the formation of the u shape cloud cavity b the collapse of u shape cavity head and c the collapse of u shape cavity legs the collapse of the u shape cavity legs is the main source of shock wave emittion 2 the cavitation vortex dynamics show strong coherent relationship with the transient cavity behaviors the vorticity z dominates the cavitation vortex dynamics during the attached cavity growth stage the vortex stretching term and vortex baroclinic term distribution is stronger than that the vortex dilatation term during the re entrant flow process the vortex the baroclinic torque term plays a main role in the vortex transport process during the cavity cloud shedding process the vortex dilatation term and the baroclinic term dominate the ratio of baroclinic term and the vortex stretching term vortex dilatation term further indicates the dominant role of baroclinic term in the cavity growth development and shedding process during the cavity collapsed induced shock wave propagation process the budget of vorticity transport as well as the ratio of baroclinic torque term to the vortex stretching vortex dilatation shows that the vortex dilatation term plays the major role in the vortex transport in the attached cavity sheet region regarding future work further research on unsteady cavitation vortex structures will be conducted from the lagrangian viewpoint the lagrangian coherent structures lcs method has the advantage that the lcs method could define transient vortex structure boundaries without relying on a threshold and could reveal more vortical structures than classical eulerian fields acknowledgement the authors gratefully acknowledge support by the national postdoctoral program for innovative talents grant no bx201700126 the national foundational of china nsfc grant nos 51239005 and 51679005 national natural science foundation of beijing grant no 3172029 and the open foundation of state key laboratory of ocean engineering shanghai jiao tong university china grant no 1611 
23468,to achieve a continuous and accurate navigation solution that avoids interruption gps is integrated with dead reckoning techniques such as inertial navigation and speed log a common approach to obtain a low cost navigation solution is to utilize a multisensor system consisting of mems based inertial measurement unit imu and the whole system is integrated with gps however these sensors provide significant inherent errors because of their complex error characteristics particle filter pf is considered as a nonlinear filtering technique to accommodate for arbitrary inertial sensor characteristics and motion dynamics an adaptive fission pf afpf method is proposed to overcome the shortcoming of sample impoverishment problem and improve particle quality moreover further improvement of the mems based imu gps integration navigation system performance during gps unavailability is achieved by integrating measurement updates from speed log data the performance of the proposed gps imu log integration using afpf is evaluated by sea trial and results indicate that the afpf solution outperform three different solutions keywords ship navigation particle filter gps inertial sensors mems based imu 1 introduction the integration of the global positioning system gps and inertial navigation systems ins can provide navigation information position velocity and attitude chu et al 2013 and has been widely used for marine navigation applications around the world in the integrated navigation system high precision position and velocity information of ship can be provided by the outputs of gps while accurate and reliable attitude information can be provided by ins in the short time it is clear that integrated navigation system enables to adequately exploit the superiority of the individual systems such as the consistently high precision trajectory information of gps and the short period stability of ins gps ins integrated navigation is the use of gps information to correct a solution from ins however in hostile environment or serious interference the gps satellite signal is non availability and it is difficult to achieve continuous location meanwhile gps suffers from its own drawbacks and errors however it suffers from multipath effects and its signal may easily be blocked or lost under certain environment furthermore ins navigation accuracy degrades rapidly with time on condition that no external aiding source is provided georgy et al 2011 the performance of the ins gps navigation solution descended rapidly over time which lead to severe error growth during periods of gps unavailability the three methods to solve this problem are using higher precision ins adding auxiliary equipment such as speed log and using advanced algorithm and technology this paper will combine the latter two methods to improve the accuracy a low cost inertial measurement unit imu such as mems based is preferred for ship navigation these imus also have other advantages such as small size light weight and low power consumption the accuracy of mems based inertial sensors decreases with time which leads to severe positional error growth in mems imu gps navigation solution during gps unavailability the frequently used linearized kf lkf require a linearized system model for the navigation error states and its effectiveness has been demonstrated in many works chen 2012 loiola et al 2011 roshany yamchi et al 2013 in order to extend kf to the nonlinear system many modified kfs e g extended kf ekf and unscented kf ukf have been provided the commonly used kf based integration algorithms linearized kf and extended kf ekf use linearized system model for the navigation error states nevertheless the performances of these modified kfs depend on the considered system and poor state estimation results will be obtained for the system with high nonlinearity these kf based navigation solutions suffer from divergence during gps unavailability on account of approximations during the linearization process and system mismodeling noureldin et al 2009 nonlinear estimating techniques like the particle filter pf doucet et al 2000 is not limited to model characteristics and deals with nonlinear problems more effectively also pf can unite prior knowledge and observation information to approximate the optimal filters on condition that a monte carlo simulation and recursive bayesian framework are applied pf were recently explored to improve the performance of imu gps integration using different approaches zhou and loffeld 2010 rigatos 2012 georgy et al 2012 jwo et al 2013 li and sun 2014 yin and zhu 2015 rabbou and elrabbany 2015 xia and wang 2016 owing to its ability to handle with nonlinear non gaussian models pf can adapt any sensor characteristics and motion dynamics yet there are still some serious problems encountered in the general pf i e particle impoverishment particle impoverishment is inevitable in virtue of the random particles prediction and re sampling used in generic pf such as under conditions of the likelihood distribution are far away from the generated particles their particle weights will be close to zero with only a few particles carrying significant weights making other particles not efficient to produce accurate estimates causing estimating errors intelligent particle filter ipf yin and zhu 2015 is inspired from the genetic algorithm in ipf the genetic operators based strategy is designed to further improve the particle diversity but the effectiveness of ipf is influenced by the parameters α and p m with the objective to improve the performance of pf in gps ins integrated navigation system an adaptive fission pf afpf method is proposed to overcome the shortcoming of sample impoverishment problem and improve particle quality in this approach the process engenders offspring particles which are called fission a fission factor that is correlative with the particle weight is applied making sure that particle diversity is well maintained the use of this afpf leads to an enhanced performance in addition to the use of afpf further improvement of the navigation system performance during gps unavailability is achieved by integrating measurement updates from other sensors the first enhancement is due to the use of velocity obtained from the ship s log the integrated system solution has another advantage which is that measurement update of the velocities by exploiting the nonholonomic constraints on vessel movements the second approach to achieve an enhanced solution is to apply with roll and pitch reckoned from the transversal and longitudinal accelerometers readouts together with the speed log readouts as a measurement update in afpf so as to updating roll and pitch reckoned from gyroscopes the updates play the role of aid the imu and restrict the growth for positional error during gps degradation or blockage and thus keep a high accuracy navigation solution the performance of the proposed afpf based navigation solution by integrating a mems based gyroscope the speed log and the gps is examined by sea trial near dalian port and compared to other solutions for imu log gps integration on condition that same sources of update as pf and velocity updates during gps outages and to kf solution for imu gps integration without any update during gps unavailability in this paper a loosely coupled integration scheme is used 2 problem statement in order to evaluate the state of the vessel x k at the current time step k given a group of measurements or observations z k z 0 z k achieved at time steps 0 1 k x k is the state vector which includes the position velocity euler angles can be defined as 1 x k φ k λ k h k v k e v k n v k u p k r k a k t where φ k λ k h k are the latitude longitude and altitude v k e v k n v k u are the velocities along east north and vertical up directions and p k r k a k are the pitch roll and azimuth angles the nonlinear system model can be defined as 2 x k f x k 1 u k 1 w k 1 z k h x k v k where u k 1 represents the imu outputs related to the motion between time steps k 1 and k and w k 1 stands for the process noise v k and z k are measurement noise the measurement vector respectively x k 1 is state of the vessel at the time step k 1 the nonlinear model and measurement model are used in gps measurements when they are available and in speed log measurements during gps signal non availability the state of the vessel x k is a vector of stochastic processes and the aim of this problem is to estimate the probability density function pdf p x k z k of the state at each time step k conditioned on the whole set of sensors measurements until time k these models are non linear models and there is no need to linearize them because the technique used can deal with non linear models when using ekf the models need to be linearized and only the first order terms of the taylor series are used this leads to using an error state approach where the kf estimates the error in the navigation states not the states themselves the system model used by kf is the dynamic error model which is a linearized model and there is a separate ins mechanization used for kf on the other hand the approach used in pf is a total state approach not an error state approach as there is no need for linearization so the system and measurement models used by the integration filter for pf are the total state non linear models and there is no separate mechanization used 3 afpf approach before describing the mathematical models used in this integration problem particle filtering is shortly introduced as well as the adaptive fission particle filter which is an enhanced version of the pf 3 1 particle filter x 0 k x 0 x 1 x k and y 1 k y 0 y 1 y k represent the sequences of states and observations in pf respectively therefore on the basis of bayes theorem the posterior distribution of the hidden states x k can be given as 3 p x 0 k y 1 k p x 0 k 1 y 1 k 1 p y k x k p x k x k 1 p y k y 1 k 1 owing to p y k y 1 k 1 is a normalizing constant 3 can be expressed by the following equation 4 p x 0 k y 1 k p x 0 k 1 y 1 k 1 p y k x k p x k x k 1 where denotes the proportional relation as far as nonlinear discrete system 2 is concerned the analytic solution of posterior distribution p x 0 k y 1 k is hard to be achieved in place of analytically calculating p x 0 k y 1 k pf approaches it with a mass of particles x 0 k i i 1 2 n in which n is the particle population the initial particles x 0 i are drawn from initial distribution of states p x 0 to cope with the conundrum in the process of sampling from the posterior distribution the importance sampling technique is proposed suppose samples are drawn from an importance distribution that can be easily sampled as follows 5 q x 0 k y 1 k q x 0 k 1 y 1 k 1 q x k x 0 k 1 y 1 k combined with 3 the importance weight of particles can be formulated in a recursive form as follows 6 w k i p x 0 k y 1 k q x 0 k y 1 k w k 1 i p y k x k i p x k i x k 1 i q x k i x 0 k 1 i y 1 k where w k i is the importance weight of particle i at a time step k and w k i is the normalized w k i thus the posterior distribution of states p x 0 k y 1 k given the measurement y along all times steps k can be approximated by particles as 7 p x 0 k y 1 k i 1 n w k i δ x 0 k x 0 k i where δ is the dirac function in case of the importance distribution meets 8 q x k x 0 k 1 y 1 k q x k x k 1 y k then 9 w k i w k 1 i p y k x k i p x k i x k 1 i q x k i x k 1 i y k therefore p x k y 1 k can be written as 10 p x k y 1 k i 1 n w k i δ x k x k i with the approximated p x k y 1 k the states x k can be estimated by the corresponding methods such as mmse djogatović et al 2014 the particle filter algorithm suffers from the particle degeneracy phenomenon after several iterations all but one particle will have negligible weights the degree of degeneracy can be defined as the sample size n eff which is given by 11 n e f f 1 σ i 1 n w k i 2 the effective sample size is proportional to degeneracy that is the smaller the sample size uses the more degeneracy the particles will be in the standard pf the resampling method is used to solve the particle degeneracy problem over that last few decades several efficient resampling algorithms have been proposed and a review about these algorithms can be found in cen et al 2011 after the process of resampling the particles with large weights are duplicated while those with small weights are eliminated the posterior distribution p x k y 1 k can be approximated as 12 p x k y 1 k 1 n i 1 n n k i δ x k x k i where n k i is the amount of offsprings for the parent particle x k i at k time the pdf p x k z k is constructed on the basis of a set of n random particles s k s k i s k n distributed in the light of the pdf the ith particle is represented as s k i x k i w k i which x k i is the sequences of vessel state and w k i is the importance weight of particle i at a time step k set k 0 initialize the particle set s 0 x 0 i w 0 i i 1 n from initial distribution p x 0 and initialize importance weights w 0 i 1 n with regard to imu gps integration the algorithm is initialized with particles drawn from a gaussian density with mean equal to the gps outputs each iteration of the sampling importance resampling sir algorithm includes three main steps step 1 the prediction stage on the basis of the set of samples of the prior iteration s k 1 x k 1 i w k 1 i i 1 n and w 0 i 1 n the motion model is used for each sample s k 1 i x k 1 i 1 n and one sample s k i x k i 1 n is drawn from p x k x k 1 i u k 1 which is absolutely confirmed by the system model and the process noise pdf p w k in 2 sample set s k is gained that approximates the predictive density p x k z k 1 step 2 the update stage considering the measurement z k each of the samples in s k is weighted by using the observation likelihood p x k x k i which is absolutely confirmed by the measurement model and the measurement noise pdf p v k in 2 afterwards all weights are normalized the weighted sample set s k approximates the density p x k z k step 3 resampling step the weighted sample set s k is achieved by resampling from the weighted sample set s k the obtained s k approximates the density p x k z k for imu log gps integration in the prediction stage the samples are predicted from the imu motion model however in the update stage the gps observation is applied in correcting the weights of the samples when the gps signal is non availability the speed log measurements can be used instead finally resampling can be implemented 3 2 adaptive fission particle filter in the resampling process particles with small weights are eliminated from the state vector estimate and are replaced with particles having large weights this however leads to the loss of diversity of the particles i e particle impoverishment we propose an afpf in order to mitigate the impoverishment problem in this method after the process of weight updating i e particles expressed as x k i w k i i 1 n p all the particles denoted parents undergo a fission process that produces offspring particles to improve the diversity of the particles step 1 the number of offspring is formulated as 13 m k i round n p w k i 2 i 1 2 n p in which round represents the rounding function m k i is the number of offspring generated by the ith parent particle the quality of a particle is depended on its weight hence m k i is proportional to the weight of parents and ensures offspring of high quality parents np is the total number of particles step 2 the offspring particle is sampled from a gaussian distribution the parent particle x k i and its corresponding fission factor a k i are represented as the mean and variance respectively 14 x k i j n x k i a k i j 1 m k i in which x k i j represents the offspring generated by the ith parent particle therefore rather than resampling which duplicates the same particle the fission step improves diversity of particles step 3 to perform the fission step the fission factor is set as 15 a k i 1 1 exp w k i w k avg w k max w k avg in which w k a v g and w k m a x represent the average and maximum weights respectively the unique information that can evaluate the quality of the particles is the weight thus the fission factor a k i draws into the weight in order to regulate the degree of fission as 14 which reflects the error between the parents x k i and their offspring x k i j fission factor value is equal to the degree of fission the relation between the weight of the parent particles and its corresponding degree of fission is seen in fig 1 han et al 2015 if a small weight parent particle undergoes an intense fission progress many new and higher quality offspring will become much more even on the contrary a large weighted parent particle will protect its excellent properties from damage by a weak fission process so it can pass on those properties to its offspring this way the quality of particles is improved and particle impoverishment can be mitigated hence the particle set generated by the fission process is not only diverse but is also of high quality step 4 the weight of the offspring x k i j is denoted as 16 w k i j w k 1 i p y k x k i j p x k i x k 1 i q x k i x k 1 i y k in the end sort particles of the parents x k i w k i i 1 n p and its offspring x k i j w k i j i 1 n p j 1 m k in a descending order on a basis of their weights the top n p particles are extracted as the ultimate particle set x k i w k i i 1 n p step 5 the particle x k can be estimated as 17 x k i 1 n w k i x k i fig 2 shows the adaptive fission particle filter algorithm for imu log gps integration some samples that are predicted on the basis of the latest gps observation are added to those samples that are predicted on the basis of the imu motion model and the importance weight are adjusted as described above if gps signal is non available some samples that are predicted making use of the speed log are added to those predicted according to imu motion model and both importance weights are described as discussed earlier during periods of gps availability samples from both imu motion model and gps observation are used which provides better performance and hence causes better performance during non availably furthermore adding some samples based on speed log to those sampled on the basis of the motion model strengthens the performance during gps availability owing to the limitation of the sir pf described above it leads to the loss of diversity of the particles i e particle impoverishment adaptive fission particle filter overcomes the shortcoming of sample impoverishment problem and improves particle quality 4 system and measurement models for afpf 4 1 system model several transformations of coordinates and coordinate frames are applied in integrated navigation computation wu et al 2017 assuming that the body frame coordinate system of the vessel is defined as follows the x axis along the transversal direction the y axis along the forward longitudinal direction and the z axis along the vertical direction upward completing the right handed orthogonal system the navigation enu east north up frame is defined by the local earth axis with the vector pointing east the vector pointing north and the vector pointing up along the local gravity vector and thus is selected as local level frame in this thesis the transformation matrix from the vessel body frame to the local level frame at time k 1 is r b k 1 l r z a k 1 r x p k 1 r y r k 1 t p k 1 r k 1 a k 1 are the pitch roll and azimuth angles at time k 1 r x r y r z are orthogonal rotation matrix in the nonlinear model of 2 u k 1 represents the imu readings where the accelerometer and the gyroscope triad can be expressed as u k 1 f k 1 x f k 1 y f k 1 z ω k 1 x ω k 1 y ω k 1 z t f k 1 x is the transversal accelerometer measurement f k 1 y is the forward accelerometer measurement f k 1 z is the vertical accelerometer measurement ω k 1 x ω k 1 y and ω k 1 z are the angular rate obtained from the aligned gyroscope the corresponding noise related to each of the these measurements constitutes the process noise vector w k 1 δ f k 1 x δ f k 1 y δ f k 1 z δ ω k 1 x δ ω k 1 y δ ω k 1 z t in which δ f k 1 and δ ω k 1 are the random errors in accelerometers and gyroscopes readings respectively it is assumed that these errors are white gaussian noise vectors in the pf solution 4 1 1 the position and velocity equations the position of a vector φ k λ k h k is given as 18 φ k λ k h k φ k 1 v k 1 n r m h k 1 δ t λ k 1 v k 1 e r n h k 1 c o s φ k 1 δ t h k 1 v k 1 u p δ t in which r m and r n are meridian and normal radii of curvature in the earth s reference ellipsoid δt is the sample time v k 1 n v k 1 e and v k 1 u p are the components of the vessel s velocity along east north and vertical up directions φ k 1 λ k 1 h k 1 are the latitude longitude and altitude at time k 1 the velocity vector of the vessel can be written 19 v k e v k n v k u p v k 1 e v k 1 n v k 1 u p r b k 1 ℓ f k 1 x δ f k 1 x f k 1 y δ f k 1 y f k 1 z δ f k 1 z δ t 0 0 g δ t 0 2 ω e sin φ k 1 v k 1 e tan φ k 1 r n h k 1 2 ω e cos φ k 1 v k 1 e r n h k 1 2 ω e sin φ k 1 v k 1 e tan φ k 1 r n h k 1 0 v k 1 n r m h k 1 2 ω e cos φ k 1 v k 1 e r n h k 1 v k 1 n r m h k 1 0 v k 1 e v k 1 n v k 1 u p δ t where ω e is the rotation rate of earth and g is the acceleration of the gravity r b k 1 l is the transformation matrix from body frame to local level frame at time k 1 the transformation between the local level frame and the body frame is expressed by the rotation matrix r b l which can be written as 20 r b l cos a c o s ϕ s i n a s i n θ s i n ϕ sin a cos θ cos a sin ϕ s i n a s i n θ c o s ϕ s i n a c o s ϕ cos a s i n θ s i n ϕ c o s a cos θ s i n a sin ϕ cos a s i n θ c o s ϕ cos a s i n ϕ s i n θ c o s θ c o s ϕ where θ ϕ a are pitch roll and azimuth 4 1 2 the attitude equations the attitude angles are computed by using quaternions wu et al 2005 the vector r rotates an angle θ around a certain axis n and vector r after rotation can be written 21 r q r q 22 q cos θ 2 sin θ 2 cos α i sin θ 2 cos β j sin θ 2 cos γ k where cosα cosβ cosγ represent the cosine value between the rotation axis n and the inertial coordinate system axis the three gyroscopes outputs should be compensated for the random errors rotation rate of the earth and the alteration in orientation of the local level navigation frame the last two are monitored by the gyroscope and constitute a portion of the outputs therefore they must be eliminated so as to acquire the actual turn 4 2 measurement model two measurement models are used 1 one for gps measurements when they are available and 2 one for speed log measurements during gps signal unavailability the accelerometers and speed log outputs along the transversal and longitudinal directions of the vessel to enable updating the pitch and roll angles in both models the pitch and roll update derived from accelerometers is extremely important because of the accelerometers technology is much more mature and advanced than the gyros technology for low cost mems inertial sensor another reason for the compute of pitch and roll of gyroscopes includes integration however their compute of accelerometers does not the shortcoming of the integration is that it accumulates errors in virtue of any uncompensated sensor bias errors and thus many inertial sensor errors contribute to the positioning accuracy to demonstrate this an uncompensated bias error b w is considered this bias error will introduce an angle error in pitch or roll proportional to time of δθ b w dt b w t this small angle will lead to misalignment of the ins consequently if the acceleration vector from body frame to local level frame is projected the acceleration vector is incorrect for bounded duration t this will introduce an error in acceleration in one of the horizontal channels δa gsin δθ gδθ gb w t the influence of this error will be obvious when gps signal unavailability therefore this will produce an error in velocity δv b w gtdt 1 2 b w gt 2 and in position δp vdt 1 2 b w gt 2 1 6 b w gt 3 a third order error is generated by an uncompensated gyroscope bias in position the influence of these errors is the most powerful in position and velocity errors on condition that ins must work alone which will happen during gps signal unavailability transformation from body frame to local level frame must be applied with the purpose of providing velocity updates from log derived speed and this transformation is a function of the pitch and azimuth angles consequently the more pitch estimates the more transformation obtains until better velocity updates all of this result in improved position accuracy the pitch and roll angles from accelerometers are calculated as follows 23 p sin 1 f y g 24 r sin 1 f x g cos p where p and r are the pitch and roll angles f y and f x are the forward accelerometer measurement and transversal accelerometer measurement for the sake of calculate the pitch angle of a moving vessel its acceleration a k 1 o d is eliminated from the forward accelerometer measurements then the pitch angle used for measurement update can be shown 25 z k p sin 1 f k 1 y a k 1 o d g analogously for the sake of compute the roll angle the transversal accelerometer measurement will be compensated for the vertical component of acceleration therefore the roll angle used for measurement update can be written as 26 z k r sin 1 f k 1 x v k 1 o d ω k 1 z g cos z k p where v k 1 o d and ω k 1 z are the speed log derived and angular rate from the gyroscope respectively it is worth noticing that the gyroscope and accelerometers outputs including in 25 and 26 must be corrected for errors prior to calculating the pitch and roll updates 4 2 1 during gps availability in loosely coupled integration the transversal and longitudinal accelerometers and speed log outputs lead to pitch and roll update yet gps provides position and velocity updates thus the gps observation vector is expressed as z k z k φ z k λ z k h z k v e z k v n z k v u z k p z k r t which consists of the gps latitude longitude altitude and velocity components along with the pitch and roll update values z k φ z k λ z k h are the latitude longitude and altitude z k v e z k v n and z k v u are the velocities along east north and vertical up directions and z k p and z k r are the pitch and roll angles the measurement model will be expressed as 27 z k h x k v k x k v k thus the noise v k of measurement update is expressed as v k v k φ v k λ v k h v k v e v k v n v k v u v k p v k r t in which v k φ v k λ v k h v k v e v k v n v k v u are the noise in the gps it is white gaussian noise v k p and v k r are the noise of accelerometers readings 4 2 2 during gps non availability the observation vector is expressed as z k z k v f z k p z k r t which includes the log derived forward speed pitch and roll update values the measurement model will be expressed as 28 z k z k v f z k p z k r h x k v k v k e 2 v k n 2 v k u p 2 v k v f p k v k p r k v k r in which v k v k v f v k p v k r t is the noise in the observations used for update it is worth mentioning that the sampling with regard to the observation likelihood in terms of the speed originated from log makes full use of the relationship between ship velocity in the body frame and in the local level frame along with the nonholonomic constraints these latter constraints arise from the fact that the vehicle cannot move in the transversal or the vertical directions in the body frame thus the sampling with regard to observation likelihood can be given as 29 z k v e z k v n z k v u r b k ℓ 0 z k v f 0 v k v e v k v n v k v u z k v f sin a k cos p k z k v f cos a k cos p k z k v f sin p k v k v e v k v n v k v u where r b k l is the transformation matrix from body frame to local level frame at time k z k v f is log derived forward speed p k and a k are the pitch and azimuth angles 5 experiments results and analysis 5 1 single dimensioned experiment to demonstrate the performance of the proposed adaptive fission particle filter we consider the experiment example is commonly used in pf testing which can be presented as 30 x k 1 2 x k 1 25 x k 1 1 x k 1 2 8 cos 1 2 k 1 u k y k 1 20 x k 2 v k in which k 1 2 u k n 0 σ w 2 and v k n 0 σ v 2 in this case we utilize the following conditions σ w 2 σ v 1 and x 0 0 1 the initial particles are achieved from a gaussian distribution such as x 0 i n 0 1 2 the experiment is repeatedly run for 30 times moreover to assess the performance of afpf two metrics are given by 31 e m k x m k x ˆ m k u e 1 n s n m 1 n s k 1 n e m k in which x mk is the real state at time step k for the mth simulation and x ˆ m k is the estimated state n is the number of time steps in one simulation n s represents the number of performed simulations for an experiment and n s 30 in order to have a comprehensive evaluation of the performance of afpf an ipf is introduced for comparison with the particle number is 500 general pf ipf afpf execute state estimation on the same observation data set of model 30 table 1 shows the experiment results of the general pf ipf and afpf it can be observed that afpf offers the lowest u e figs 3 and 4 show the estimation states and their absolute errors of the one simulation respectively the simulations of the three filters are executed on the same computer the smallest computing time which is 0 85s attribute to the general pf and the computation times for ipf and afpf are 1 53s and 1 38s respectively compared with the general pf ipf and afpf have the additional procedure i e all the particles undergo a fission process after process of weight updating which expends a small portion of the computing resource according to eq 30 process noise u k satisfies the following probability density 32 p 1 x 1 π σ 8 π 0 2 π exp x b cos θ 2 2 σ 2 d θ in which σ2 is the variance for the gauss component b is amplitude of oscillating signal θ is phase of oscillating signal according to eq 30 measurement noise v k satisfies the following probability density 33 p 2 x 1 σ 8 π exp x b 2 2 σ 2 exp x b 2 2 σ 2 b 2 σ p 3 x 1 σ φ b σ 8 π exp x b s i g n x 2 2 σ 2 b 2 σ in which φ x is the standard normal distribution function sign x is the sign function b is the intercode interference it can be seen from the mathematical model that the eqs 32 and 33 are compatible with gauss noise and some non gauss noises to verify the performance of the afpf algorithm in non gauss noises the particle number is 100 general pf ipf afpf execute state estimation on the same observation data set of model 30 32 and 33 as seen from fig 5 the afpf is more accurate and provide a smaller estimation error than the pf and ipf moreover the results show that the afpf maintains a small level of the true estimation error without any assumption regarding the noise characteristics 5 2 experiment results the performance of the proposed method is evaluated by the ship mounted experimental data a navigation grade imu is employed it consists of gyroscopes and accelerometers the specifications can be found in table 2 the test system comprised one gps receivers one non touch ship s speed sensor log and one navigation grade imu raw imu data gps data and speed log data were collected throughout the test navigation the gps receivers were used in the experiments to demonstrate the performance of the proposed solution the sea trial trajectories using the configuration described above are presented in this paper gps data speed log data and imu data were stored during the sea trial and the navigation solutions were run in post processing on the recorded data of a laptop the performance of the proposed afpf solution for imu log gps integration navigation system with velocity update from log along with pitch and roll updates from accelerometers expressed as afpf is calculated during different conditions including degraded and completely blocked gps in order to facilitate the comparison and analysis sea trials were implemented under the same conditions to estimate the errors of the vessel by using three other solutions that is 1 ipf solution for imu log gps with absolutely the same updates as afpf expressed as ipf 2 kf for imu log gps with velocity update from speed log during gps unavailability expressed as kf v and 3 kf for imu gps without any update during gps unavailability expressed as kf the results of all the estimated solutions are evaluated relative to the dgps reference solution one iteration of the afpf takes only 0 00542s which include 0 00433s with update stage and 0 00109s with prediction stage respectively hence the algorithm meets the real time requirement of the system the sea trial trajectory fig 6 was carried out around dalian port china this sea trial was performed for nearly 6 h of continuous vessel navigation and a distance of about 50n mile was sailed the final verification for the proposed system accuracy is during gps satellite signal is non availability which can be deliberately added in post processing eight gps unavailability are simulated as shown in fig 6 circles each with about 300s outages were chosen in order to they include straight portions and turns circles mean the locations of gps unavailability average root mean square rms error and the maximum error in the estimated 2d horizontal position for the four compared solutions are presented in tables 3 and 4 respectively because the compensation of the stochastic biases for the gyroscopes and accelerometers are not perfect the results of maximum position errors indicate horizontal position errors of 614 m in kf during gps unavailability any uncompensated biases of accelerometers and gyroscopes will produce position error proportional to square and cube of the outage duration respectively in spite of these biases are compensated by kf the residuals of this compensation have a relatively high impact yet particularly owing to the longer gps unavailability compared with kf the kf v obtained 70 improvement during gps unavailability in table 4 this improvement is mainly due to the velocity update that constrains the increase of velocity error in the kf leading to smaller position errors meanwhile table 4 gives the results that the ipf obtained 79 5 improvement over the kf v during gps unavailability this improvement occurs because the pitch and roll given by accelerometer do not involve integration operations hence their errors do not increase with time from the statistics results of table 4 it is known that afpf achieved 31 5 improvement over the ipf by comparing the performances of the four solutions it was known that the capability of afpf to make use of nonlinear system and measurement models outperforms all the other solutions the portions of the trajectory during the gps unavailability number 1 3 5 and 8 are shown in figs 7 9 11 and 13 furthermore for the sake of provide a notion about the vessel dynamics during gps unavailability individually figs 8 10 12 and 14 illustrate the velocity of the vessel and its course gps unavailability number 1 is selected to test the performance during sharp alteration of the vessel s course the 1th unavailability fig 7 is provided during an approximately 180 turn and the longitudinal velocity and lateral velocity of the vessel are about 12kn and 1kn respectively from about 14kn to 13kn of longitudinal velocity during the turn and then to about 12 5kn but lateral velocity is not significant change throughout the process fig 8 the maximum horizontal position error of afpf is 15 93 m whereas ipf kf v and kf it is 43 35 m 167 67 m and 833 87 m respectively the 3th fig 9 gps unavailability indicates the performance during a straight parts of the vessel trajectory where the vessel s longitudinal velocity and lateral velocity are about 14kn and 1kn respectively meanwhile the sailing distance nearly 1 5n mile fig 10 the maximum horizontal position error of afpf is 10 34 m whereas ipf kf v and kf it is 28 38 m 287 64 m and 398 46 m respectively gps unavailability number 4 and 5 are chosen to test the performance during continuous turns the 5th unavailability fig 11 is included several turns the first is approximately 40 with a longitudinal velocity of vessel about 13kn and the second is approximately 40 with a longitudinal velocity decelerating from 13kn to 11kn the subsequent process repeats the first and second steps but longitudinal velocity reduced to about 10kn fig 12 the maximum horizontal position error of afpf is 17 56 m whereas ipf kf v and kf it is 47 46 m 229 76 m and 773 62 m respectively gps unavailability number 2 and 8 are selected to test the performance during alteration of the vessel s course the 8th unavailability fig 13 is provided during an approximately 90 turn and the longitudinal velocity and lateral velocity of the vessel are about 14kn and 1kn respectively from about 14kn to 10kn of longitudinal velocity during the turn and then to about 10kn but lateral velocity is not significant change throughout the process fig 14 the maximum horizontal position error of afpf is 23 34 m whereas ipf kf v and kf it is 30 78 m 106 35 m and 539 73 m respectively in terms of mems based inertial sensors the performance results of the proposed afpf solution show that better performance than all other solutions during gps signal unavailability including straight sections continuous turns and large angle turns 6 conclusion in this letter a low cost navigation solution for vessel involving one mems based imu together with the speed log and gps was proposed the proposed method utilizes an adaptive fission pf as a nonlinear filtering technique to obtain a navigation solution which is adequate for vessel a loosely coupled integration scheme is used in order to improve the mems based imu gps integrated navigation system precision during gps unavailability the speed derived from the speed log is applied to achieve measurement update for the velocities exploiting the nonholonomic constraints the second approach to achieve an enhanced solution is to apply with roll and pitch reckoned from the transversal and longitudinal accelerometers readouts together with the speed log readouts as a measurement update in afpf so as to updating roll and pitch reckoned from gyroscopes the gps imu log integration using adaptive fission pf have been evaluated with sea trial and compared to three other navigation solutions the results elucidate the benefits of the afpf algorithm in comparison to the ipf kf v and kf algorithms this paper focuses on the application of loosely coupled integration for sensor fusion in future work tightly coupled integration will be taken into consideration which is useful in gps challenging environments acknowledgements this work was supported by the national nature science foundation of china nos 51579024 61374114 and doctoral scientific research foundation of liaoning province 20170520243 
23468,to achieve a continuous and accurate navigation solution that avoids interruption gps is integrated with dead reckoning techniques such as inertial navigation and speed log a common approach to obtain a low cost navigation solution is to utilize a multisensor system consisting of mems based inertial measurement unit imu and the whole system is integrated with gps however these sensors provide significant inherent errors because of their complex error characteristics particle filter pf is considered as a nonlinear filtering technique to accommodate for arbitrary inertial sensor characteristics and motion dynamics an adaptive fission pf afpf method is proposed to overcome the shortcoming of sample impoverishment problem and improve particle quality moreover further improvement of the mems based imu gps integration navigation system performance during gps unavailability is achieved by integrating measurement updates from speed log data the performance of the proposed gps imu log integration using afpf is evaluated by sea trial and results indicate that the afpf solution outperform three different solutions keywords ship navigation particle filter gps inertial sensors mems based imu 1 introduction the integration of the global positioning system gps and inertial navigation systems ins can provide navigation information position velocity and attitude chu et al 2013 and has been widely used for marine navigation applications around the world in the integrated navigation system high precision position and velocity information of ship can be provided by the outputs of gps while accurate and reliable attitude information can be provided by ins in the short time it is clear that integrated navigation system enables to adequately exploit the superiority of the individual systems such as the consistently high precision trajectory information of gps and the short period stability of ins gps ins integrated navigation is the use of gps information to correct a solution from ins however in hostile environment or serious interference the gps satellite signal is non availability and it is difficult to achieve continuous location meanwhile gps suffers from its own drawbacks and errors however it suffers from multipath effects and its signal may easily be blocked or lost under certain environment furthermore ins navigation accuracy degrades rapidly with time on condition that no external aiding source is provided georgy et al 2011 the performance of the ins gps navigation solution descended rapidly over time which lead to severe error growth during periods of gps unavailability the three methods to solve this problem are using higher precision ins adding auxiliary equipment such as speed log and using advanced algorithm and technology this paper will combine the latter two methods to improve the accuracy a low cost inertial measurement unit imu such as mems based is preferred for ship navigation these imus also have other advantages such as small size light weight and low power consumption the accuracy of mems based inertial sensors decreases with time which leads to severe positional error growth in mems imu gps navigation solution during gps unavailability the frequently used linearized kf lkf require a linearized system model for the navigation error states and its effectiveness has been demonstrated in many works chen 2012 loiola et al 2011 roshany yamchi et al 2013 in order to extend kf to the nonlinear system many modified kfs e g extended kf ekf and unscented kf ukf have been provided the commonly used kf based integration algorithms linearized kf and extended kf ekf use linearized system model for the navigation error states nevertheless the performances of these modified kfs depend on the considered system and poor state estimation results will be obtained for the system with high nonlinearity these kf based navigation solutions suffer from divergence during gps unavailability on account of approximations during the linearization process and system mismodeling noureldin et al 2009 nonlinear estimating techniques like the particle filter pf doucet et al 2000 is not limited to model characteristics and deals with nonlinear problems more effectively also pf can unite prior knowledge and observation information to approximate the optimal filters on condition that a monte carlo simulation and recursive bayesian framework are applied pf were recently explored to improve the performance of imu gps integration using different approaches zhou and loffeld 2010 rigatos 2012 georgy et al 2012 jwo et al 2013 li and sun 2014 yin and zhu 2015 rabbou and elrabbany 2015 xia and wang 2016 owing to its ability to handle with nonlinear non gaussian models pf can adapt any sensor characteristics and motion dynamics yet there are still some serious problems encountered in the general pf i e particle impoverishment particle impoverishment is inevitable in virtue of the random particles prediction and re sampling used in generic pf such as under conditions of the likelihood distribution are far away from the generated particles their particle weights will be close to zero with only a few particles carrying significant weights making other particles not efficient to produce accurate estimates causing estimating errors intelligent particle filter ipf yin and zhu 2015 is inspired from the genetic algorithm in ipf the genetic operators based strategy is designed to further improve the particle diversity but the effectiveness of ipf is influenced by the parameters α and p m with the objective to improve the performance of pf in gps ins integrated navigation system an adaptive fission pf afpf method is proposed to overcome the shortcoming of sample impoverishment problem and improve particle quality in this approach the process engenders offspring particles which are called fission a fission factor that is correlative with the particle weight is applied making sure that particle diversity is well maintained the use of this afpf leads to an enhanced performance in addition to the use of afpf further improvement of the navigation system performance during gps unavailability is achieved by integrating measurement updates from other sensors the first enhancement is due to the use of velocity obtained from the ship s log the integrated system solution has another advantage which is that measurement update of the velocities by exploiting the nonholonomic constraints on vessel movements the second approach to achieve an enhanced solution is to apply with roll and pitch reckoned from the transversal and longitudinal accelerometers readouts together with the speed log readouts as a measurement update in afpf so as to updating roll and pitch reckoned from gyroscopes the updates play the role of aid the imu and restrict the growth for positional error during gps degradation or blockage and thus keep a high accuracy navigation solution the performance of the proposed afpf based navigation solution by integrating a mems based gyroscope the speed log and the gps is examined by sea trial near dalian port and compared to other solutions for imu log gps integration on condition that same sources of update as pf and velocity updates during gps outages and to kf solution for imu gps integration without any update during gps unavailability in this paper a loosely coupled integration scheme is used 2 problem statement in order to evaluate the state of the vessel x k at the current time step k given a group of measurements or observations z k z 0 z k achieved at time steps 0 1 k x k is the state vector which includes the position velocity euler angles can be defined as 1 x k φ k λ k h k v k e v k n v k u p k r k a k t where φ k λ k h k are the latitude longitude and altitude v k e v k n v k u are the velocities along east north and vertical up directions and p k r k a k are the pitch roll and azimuth angles the nonlinear system model can be defined as 2 x k f x k 1 u k 1 w k 1 z k h x k v k where u k 1 represents the imu outputs related to the motion between time steps k 1 and k and w k 1 stands for the process noise v k and z k are measurement noise the measurement vector respectively x k 1 is state of the vessel at the time step k 1 the nonlinear model and measurement model are used in gps measurements when they are available and in speed log measurements during gps signal non availability the state of the vessel x k is a vector of stochastic processes and the aim of this problem is to estimate the probability density function pdf p x k z k of the state at each time step k conditioned on the whole set of sensors measurements until time k these models are non linear models and there is no need to linearize them because the technique used can deal with non linear models when using ekf the models need to be linearized and only the first order terms of the taylor series are used this leads to using an error state approach where the kf estimates the error in the navigation states not the states themselves the system model used by kf is the dynamic error model which is a linearized model and there is a separate ins mechanization used for kf on the other hand the approach used in pf is a total state approach not an error state approach as there is no need for linearization so the system and measurement models used by the integration filter for pf are the total state non linear models and there is no separate mechanization used 3 afpf approach before describing the mathematical models used in this integration problem particle filtering is shortly introduced as well as the adaptive fission particle filter which is an enhanced version of the pf 3 1 particle filter x 0 k x 0 x 1 x k and y 1 k y 0 y 1 y k represent the sequences of states and observations in pf respectively therefore on the basis of bayes theorem the posterior distribution of the hidden states x k can be given as 3 p x 0 k y 1 k p x 0 k 1 y 1 k 1 p y k x k p x k x k 1 p y k y 1 k 1 owing to p y k y 1 k 1 is a normalizing constant 3 can be expressed by the following equation 4 p x 0 k y 1 k p x 0 k 1 y 1 k 1 p y k x k p x k x k 1 where denotes the proportional relation as far as nonlinear discrete system 2 is concerned the analytic solution of posterior distribution p x 0 k y 1 k is hard to be achieved in place of analytically calculating p x 0 k y 1 k pf approaches it with a mass of particles x 0 k i i 1 2 n in which n is the particle population the initial particles x 0 i are drawn from initial distribution of states p x 0 to cope with the conundrum in the process of sampling from the posterior distribution the importance sampling technique is proposed suppose samples are drawn from an importance distribution that can be easily sampled as follows 5 q x 0 k y 1 k q x 0 k 1 y 1 k 1 q x k x 0 k 1 y 1 k combined with 3 the importance weight of particles can be formulated in a recursive form as follows 6 w k i p x 0 k y 1 k q x 0 k y 1 k w k 1 i p y k x k i p x k i x k 1 i q x k i x 0 k 1 i y 1 k where w k i is the importance weight of particle i at a time step k and w k i is the normalized w k i thus the posterior distribution of states p x 0 k y 1 k given the measurement y along all times steps k can be approximated by particles as 7 p x 0 k y 1 k i 1 n w k i δ x 0 k x 0 k i where δ is the dirac function in case of the importance distribution meets 8 q x k x 0 k 1 y 1 k q x k x k 1 y k then 9 w k i w k 1 i p y k x k i p x k i x k 1 i q x k i x k 1 i y k therefore p x k y 1 k can be written as 10 p x k y 1 k i 1 n w k i δ x k x k i with the approximated p x k y 1 k the states x k can be estimated by the corresponding methods such as mmse djogatović et al 2014 the particle filter algorithm suffers from the particle degeneracy phenomenon after several iterations all but one particle will have negligible weights the degree of degeneracy can be defined as the sample size n eff which is given by 11 n e f f 1 σ i 1 n w k i 2 the effective sample size is proportional to degeneracy that is the smaller the sample size uses the more degeneracy the particles will be in the standard pf the resampling method is used to solve the particle degeneracy problem over that last few decades several efficient resampling algorithms have been proposed and a review about these algorithms can be found in cen et al 2011 after the process of resampling the particles with large weights are duplicated while those with small weights are eliminated the posterior distribution p x k y 1 k can be approximated as 12 p x k y 1 k 1 n i 1 n n k i δ x k x k i where n k i is the amount of offsprings for the parent particle x k i at k time the pdf p x k z k is constructed on the basis of a set of n random particles s k s k i s k n distributed in the light of the pdf the ith particle is represented as s k i x k i w k i which x k i is the sequences of vessel state and w k i is the importance weight of particle i at a time step k set k 0 initialize the particle set s 0 x 0 i w 0 i i 1 n from initial distribution p x 0 and initialize importance weights w 0 i 1 n with regard to imu gps integration the algorithm is initialized with particles drawn from a gaussian density with mean equal to the gps outputs each iteration of the sampling importance resampling sir algorithm includes three main steps step 1 the prediction stage on the basis of the set of samples of the prior iteration s k 1 x k 1 i w k 1 i i 1 n and w 0 i 1 n the motion model is used for each sample s k 1 i x k 1 i 1 n and one sample s k i x k i 1 n is drawn from p x k x k 1 i u k 1 which is absolutely confirmed by the system model and the process noise pdf p w k in 2 sample set s k is gained that approximates the predictive density p x k z k 1 step 2 the update stage considering the measurement z k each of the samples in s k is weighted by using the observation likelihood p x k x k i which is absolutely confirmed by the measurement model and the measurement noise pdf p v k in 2 afterwards all weights are normalized the weighted sample set s k approximates the density p x k z k step 3 resampling step the weighted sample set s k is achieved by resampling from the weighted sample set s k the obtained s k approximates the density p x k z k for imu log gps integration in the prediction stage the samples are predicted from the imu motion model however in the update stage the gps observation is applied in correcting the weights of the samples when the gps signal is non availability the speed log measurements can be used instead finally resampling can be implemented 3 2 adaptive fission particle filter in the resampling process particles with small weights are eliminated from the state vector estimate and are replaced with particles having large weights this however leads to the loss of diversity of the particles i e particle impoverishment we propose an afpf in order to mitigate the impoverishment problem in this method after the process of weight updating i e particles expressed as x k i w k i i 1 n p all the particles denoted parents undergo a fission process that produces offspring particles to improve the diversity of the particles step 1 the number of offspring is formulated as 13 m k i round n p w k i 2 i 1 2 n p in which round represents the rounding function m k i is the number of offspring generated by the ith parent particle the quality of a particle is depended on its weight hence m k i is proportional to the weight of parents and ensures offspring of high quality parents np is the total number of particles step 2 the offspring particle is sampled from a gaussian distribution the parent particle x k i and its corresponding fission factor a k i are represented as the mean and variance respectively 14 x k i j n x k i a k i j 1 m k i in which x k i j represents the offspring generated by the ith parent particle therefore rather than resampling which duplicates the same particle the fission step improves diversity of particles step 3 to perform the fission step the fission factor is set as 15 a k i 1 1 exp w k i w k avg w k max w k avg in which w k a v g and w k m a x represent the average and maximum weights respectively the unique information that can evaluate the quality of the particles is the weight thus the fission factor a k i draws into the weight in order to regulate the degree of fission as 14 which reflects the error between the parents x k i and their offspring x k i j fission factor value is equal to the degree of fission the relation between the weight of the parent particles and its corresponding degree of fission is seen in fig 1 han et al 2015 if a small weight parent particle undergoes an intense fission progress many new and higher quality offspring will become much more even on the contrary a large weighted parent particle will protect its excellent properties from damage by a weak fission process so it can pass on those properties to its offspring this way the quality of particles is improved and particle impoverishment can be mitigated hence the particle set generated by the fission process is not only diverse but is also of high quality step 4 the weight of the offspring x k i j is denoted as 16 w k i j w k 1 i p y k x k i j p x k i x k 1 i q x k i x k 1 i y k in the end sort particles of the parents x k i w k i i 1 n p and its offspring x k i j w k i j i 1 n p j 1 m k in a descending order on a basis of their weights the top n p particles are extracted as the ultimate particle set x k i w k i i 1 n p step 5 the particle x k can be estimated as 17 x k i 1 n w k i x k i fig 2 shows the adaptive fission particle filter algorithm for imu log gps integration some samples that are predicted on the basis of the latest gps observation are added to those samples that are predicted on the basis of the imu motion model and the importance weight are adjusted as described above if gps signal is non available some samples that are predicted making use of the speed log are added to those predicted according to imu motion model and both importance weights are described as discussed earlier during periods of gps availability samples from both imu motion model and gps observation are used which provides better performance and hence causes better performance during non availably furthermore adding some samples based on speed log to those sampled on the basis of the motion model strengthens the performance during gps availability owing to the limitation of the sir pf described above it leads to the loss of diversity of the particles i e particle impoverishment adaptive fission particle filter overcomes the shortcoming of sample impoverishment problem and improves particle quality 4 system and measurement models for afpf 4 1 system model several transformations of coordinates and coordinate frames are applied in integrated navigation computation wu et al 2017 assuming that the body frame coordinate system of the vessel is defined as follows the x axis along the transversal direction the y axis along the forward longitudinal direction and the z axis along the vertical direction upward completing the right handed orthogonal system the navigation enu east north up frame is defined by the local earth axis with the vector pointing east the vector pointing north and the vector pointing up along the local gravity vector and thus is selected as local level frame in this thesis the transformation matrix from the vessel body frame to the local level frame at time k 1 is r b k 1 l r z a k 1 r x p k 1 r y r k 1 t p k 1 r k 1 a k 1 are the pitch roll and azimuth angles at time k 1 r x r y r z are orthogonal rotation matrix in the nonlinear model of 2 u k 1 represents the imu readings where the accelerometer and the gyroscope triad can be expressed as u k 1 f k 1 x f k 1 y f k 1 z ω k 1 x ω k 1 y ω k 1 z t f k 1 x is the transversal accelerometer measurement f k 1 y is the forward accelerometer measurement f k 1 z is the vertical accelerometer measurement ω k 1 x ω k 1 y and ω k 1 z are the angular rate obtained from the aligned gyroscope the corresponding noise related to each of the these measurements constitutes the process noise vector w k 1 δ f k 1 x δ f k 1 y δ f k 1 z δ ω k 1 x δ ω k 1 y δ ω k 1 z t in which δ f k 1 and δ ω k 1 are the random errors in accelerometers and gyroscopes readings respectively it is assumed that these errors are white gaussian noise vectors in the pf solution 4 1 1 the position and velocity equations the position of a vector φ k λ k h k is given as 18 φ k λ k h k φ k 1 v k 1 n r m h k 1 δ t λ k 1 v k 1 e r n h k 1 c o s φ k 1 δ t h k 1 v k 1 u p δ t in which r m and r n are meridian and normal radii of curvature in the earth s reference ellipsoid δt is the sample time v k 1 n v k 1 e and v k 1 u p are the components of the vessel s velocity along east north and vertical up directions φ k 1 λ k 1 h k 1 are the latitude longitude and altitude at time k 1 the velocity vector of the vessel can be written 19 v k e v k n v k u p v k 1 e v k 1 n v k 1 u p r b k 1 ℓ f k 1 x δ f k 1 x f k 1 y δ f k 1 y f k 1 z δ f k 1 z δ t 0 0 g δ t 0 2 ω e sin φ k 1 v k 1 e tan φ k 1 r n h k 1 2 ω e cos φ k 1 v k 1 e r n h k 1 2 ω e sin φ k 1 v k 1 e tan φ k 1 r n h k 1 0 v k 1 n r m h k 1 2 ω e cos φ k 1 v k 1 e r n h k 1 v k 1 n r m h k 1 0 v k 1 e v k 1 n v k 1 u p δ t where ω e is the rotation rate of earth and g is the acceleration of the gravity r b k 1 l is the transformation matrix from body frame to local level frame at time k 1 the transformation between the local level frame and the body frame is expressed by the rotation matrix r b l which can be written as 20 r b l cos a c o s ϕ s i n a s i n θ s i n ϕ sin a cos θ cos a sin ϕ s i n a s i n θ c o s ϕ s i n a c o s ϕ cos a s i n θ s i n ϕ c o s a cos θ s i n a sin ϕ cos a s i n θ c o s ϕ cos a s i n ϕ s i n θ c o s θ c o s ϕ where θ ϕ a are pitch roll and azimuth 4 1 2 the attitude equations the attitude angles are computed by using quaternions wu et al 2005 the vector r rotates an angle θ around a certain axis n and vector r after rotation can be written 21 r q r q 22 q cos θ 2 sin θ 2 cos α i sin θ 2 cos β j sin θ 2 cos γ k where cosα cosβ cosγ represent the cosine value between the rotation axis n and the inertial coordinate system axis the three gyroscopes outputs should be compensated for the random errors rotation rate of the earth and the alteration in orientation of the local level navigation frame the last two are monitored by the gyroscope and constitute a portion of the outputs therefore they must be eliminated so as to acquire the actual turn 4 2 measurement model two measurement models are used 1 one for gps measurements when they are available and 2 one for speed log measurements during gps signal unavailability the accelerometers and speed log outputs along the transversal and longitudinal directions of the vessel to enable updating the pitch and roll angles in both models the pitch and roll update derived from accelerometers is extremely important because of the accelerometers technology is much more mature and advanced than the gyros technology for low cost mems inertial sensor another reason for the compute of pitch and roll of gyroscopes includes integration however their compute of accelerometers does not the shortcoming of the integration is that it accumulates errors in virtue of any uncompensated sensor bias errors and thus many inertial sensor errors contribute to the positioning accuracy to demonstrate this an uncompensated bias error b w is considered this bias error will introduce an angle error in pitch or roll proportional to time of δθ b w dt b w t this small angle will lead to misalignment of the ins consequently if the acceleration vector from body frame to local level frame is projected the acceleration vector is incorrect for bounded duration t this will introduce an error in acceleration in one of the horizontal channels δa gsin δθ gδθ gb w t the influence of this error will be obvious when gps signal unavailability therefore this will produce an error in velocity δv b w gtdt 1 2 b w gt 2 and in position δp vdt 1 2 b w gt 2 1 6 b w gt 3 a third order error is generated by an uncompensated gyroscope bias in position the influence of these errors is the most powerful in position and velocity errors on condition that ins must work alone which will happen during gps signal unavailability transformation from body frame to local level frame must be applied with the purpose of providing velocity updates from log derived speed and this transformation is a function of the pitch and azimuth angles consequently the more pitch estimates the more transformation obtains until better velocity updates all of this result in improved position accuracy the pitch and roll angles from accelerometers are calculated as follows 23 p sin 1 f y g 24 r sin 1 f x g cos p where p and r are the pitch and roll angles f y and f x are the forward accelerometer measurement and transversal accelerometer measurement for the sake of calculate the pitch angle of a moving vessel its acceleration a k 1 o d is eliminated from the forward accelerometer measurements then the pitch angle used for measurement update can be shown 25 z k p sin 1 f k 1 y a k 1 o d g analogously for the sake of compute the roll angle the transversal accelerometer measurement will be compensated for the vertical component of acceleration therefore the roll angle used for measurement update can be written as 26 z k r sin 1 f k 1 x v k 1 o d ω k 1 z g cos z k p where v k 1 o d and ω k 1 z are the speed log derived and angular rate from the gyroscope respectively it is worth noticing that the gyroscope and accelerometers outputs including in 25 and 26 must be corrected for errors prior to calculating the pitch and roll updates 4 2 1 during gps availability in loosely coupled integration the transversal and longitudinal accelerometers and speed log outputs lead to pitch and roll update yet gps provides position and velocity updates thus the gps observation vector is expressed as z k z k φ z k λ z k h z k v e z k v n z k v u z k p z k r t which consists of the gps latitude longitude altitude and velocity components along with the pitch and roll update values z k φ z k λ z k h are the latitude longitude and altitude z k v e z k v n and z k v u are the velocities along east north and vertical up directions and z k p and z k r are the pitch and roll angles the measurement model will be expressed as 27 z k h x k v k x k v k thus the noise v k of measurement update is expressed as v k v k φ v k λ v k h v k v e v k v n v k v u v k p v k r t in which v k φ v k λ v k h v k v e v k v n v k v u are the noise in the gps it is white gaussian noise v k p and v k r are the noise of accelerometers readings 4 2 2 during gps non availability the observation vector is expressed as z k z k v f z k p z k r t which includes the log derived forward speed pitch and roll update values the measurement model will be expressed as 28 z k z k v f z k p z k r h x k v k v k e 2 v k n 2 v k u p 2 v k v f p k v k p r k v k r in which v k v k v f v k p v k r t is the noise in the observations used for update it is worth mentioning that the sampling with regard to the observation likelihood in terms of the speed originated from log makes full use of the relationship between ship velocity in the body frame and in the local level frame along with the nonholonomic constraints these latter constraints arise from the fact that the vehicle cannot move in the transversal or the vertical directions in the body frame thus the sampling with regard to observation likelihood can be given as 29 z k v e z k v n z k v u r b k ℓ 0 z k v f 0 v k v e v k v n v k v u z k v f sin a k cos p k z k v f cos a k cos p k z k v f sin p k v k v e v k v n v k v u where r b k l is the transformation matrix from body frame to local level frame at time k z k v f is log derived forward speed p k and a k are the pitch and azimuth angles 5 experiments results and analysis 5 1 single dimensioned experiment to demonstrate the performance of the proposed adaptive fission particle filter we consider the experiment example is commonly used in pf testing which can be presented as 30 x k 1 2 x k 1 25 x k 1 1 x k 1 2 8 cos 1 2 k 1 u k y k 1 20 x k 2 v k in which k 1 2 u k n 0 σ w 2 and v k n 0 σ v 2 in this case we utilize the following conditions σ w 2 σ v 1 and x 0 0 1 the initial particles are achieved from a gaussian distribution such as x 0 i n 0 1 2 the experiment is repeatedly run for 30 times moreover to assess the performance of afpf two metrics are given by 31 e m k x m k x ˆ m k u e 1 n s n m 1 n s k 1 n e m k in which x mk is the real state at time step k for the mth simulation and x ˆ m k is the estimated state n is the number of time steps in one simulation n s represents the number of performed simulations for an experiment and n s 30 in order to have a comprehensive evaluation of the performance of afpf an ipf is introduced for comparison with the particle number is 500 general pf ipf afpf execute state estimation on the same observation data set of model 30 table 1 shows the experiment results of the general pf ipf and afpf it can be observed that afpf offers the lowest u e figs 3 and 4 show the estimation states and their absolute errors of the one simulation respectively the simulations of the three filters are executed on the same computer the smallest computing time which is 0 85s attribute to the general pf and the computation times for ipf and afpf are 1 53s and 1 38s respectively compared with the general pf ipf and afpf have the additional procedure i e all the particles undergo a fission process after process of weight updating which expends a small portion of the computing resource according to eq 30 process noise u k satisfies the following probability density 32 p 1 x 1 π σ 8 π 0 2 π exp x b cos θ 2 2 σ 2 d θ in which σ2 is the variance for the gauss component b is amplitude of oscillating signal θ is phase of oscillating signal according to eq 30 measurement noise v k satisfies the following probability density 33 p 2 x 1 σ 8 π exp x b 2 2 σ 2 exp x b 2 2 σ 2 b 2 σ p 3 x 1 σ φ b σ 8 π exp x b s i g n x 2 2 σ 2 b 2 σ in which φ x is the standard normal distribution function sign x is the sign function b is the intercode interference it can be seen from the mathematical model that the eqs 32 and 33 are compatible with gauss noise and some non gauss noises to verify the performance of the afpf algorithm in non gauss noises the particle number is 100 general pf ipf afpf execute state estimation on the same observation data set of model 30 32 and 33 as seen from fig 5 the afpf is more accurate and provide a smaller estimation error than the pf and ipf moreover the results show that the afpf maintains a small level of the true estimation error without any assumption regarding the noise characteristics 5 2 experiment results the performance of the proposed method is evaluated by the ship mounted experimental data a navigation grade imu is employed it consists of gyroscopes and accelerometers the specifications can be found in table 2 the test system comprised one gps receivers one non touch ship s speed sensor log and one navigation grade imu raw imu data gps data and speed log data were collected throughout the test navigation the gps receivers were used in the experiments to demonstrate the performance of the proposed solution the sea trial trajectories using the configuration described above are presented in this paper gps data speed log data and imu data were stored during the sea trial and the navigation solutions were run in post processing on the recorded data of a laptop the performance of the proposed afpf solution for imu log gps integration navigation system with velocity update from log along with pitch and roll updates from accelerometers expressed as afpf is calculated during different conditions including degraded and completely blocked gps in order to facilitate the comparison and analysis sea trials were implemented under the same conditions to estimate the errors of the vessel by using three other solutions that is 1 ipf solution for imu log gps with absolutely the same updates as afpf expressed as ipf 2 kf for imu log gps with velocity update from speed log during gps unavailability expressed as kf v and 3 kf for imu gps without any update during gps unavailability expressed as kf the results of all the estimated solutions are evaluated relative to the dgps reference solution one iteration of the afpf takes only 0 00542s which include 0 00433s with update stage and 0 00109s with prediction stage respectively hence the algorithm meets the real time requirement of the system the sea trial trajectory fig 6 was carried out around dalian port china this sea trial was performed for nearly 6 h of continuous vessel navigation and a distance of about 50n mile was sailed the final verification for the proposed system accuracy is during gps satellite signal is non availability which can be deliberately added in post processing eight gps unavailability are simulated as shown in fig 6 circles each with about 300s outages were chosen in order to they include straight portions and turns circles mean the locations of gps unavailability average root mean square rms error and the maximum error in the estimated 2d horizontal position for the four compared solutions are presented in tables 3 and 4 respectively because the compensation of the stochastic biases for the gyroscopes and accelerometers are not perfect the results of maximum position errors indicate horizontal position errors of 614 m in kf during gps unavailability any uncompensated biases of accelerometers and gyroscopes will produce position error proportional to square and cube of the outage duration respectively in spite of these biases are compensated by kf the residuals of this compensation have a relatively high impact yet particularly owing to the longer gps unavailability compared with kf the kf v obtained 70 improvement during gps unavailability in table 4 this improvement is mainly due to the velocity update that constrains the increase of velocity error in the kf leading to smaller position errors meanwhile table 4 gives the results that the ipf obtained 79 5 improvement over the kf v during gps unavailability this improvement occurs because the pitch and roll given by accelerometer do not involve integration operations hence their errors do not increase with time from the statistics results of table 4 it is known that afpf achieved 31 5 improvement over the ipf by comparing the performances of the four solutions it was known that the capability of afpf to make use of nonlinear system and measurement models outperforms all the other solutions the portions of the trajectory during the gps unavailability number 1 3 5 and 8 are shown in figs 7 9 11 and 13 furthermore for the sake of provide a notion about the vessel dynamics during gps unavailability individually figs 8 10 12 and 14 illustrate the velocity of the vessel and its course gps unavailability number 1 is selected to test the performance during sharp alteration of the vessel s course the 1th unavailability fig 7 is provided during an approximately 180 turn and the longitudinal velocity and lateral velocity of the vessel are about 12kn and 1kn respectively from about 14kn to 13kn of longitudinal velocity during the turn and then to about 12 5kn but lateral velocity is not significant change throughout the process fig 8 the maximum horizontal position error of afpf is 15 93 m whereas ipf kf v and kf it is 43 35 m 167 67 m and 833 87 m respectively the 3th fig 9 gps unavailability indicates the performance during a straight parts of the vessel trajectory where the vessel s longitudinal velocity and lateral velocity are about 14kn and 1kn respectively meanwhile the sailing distance nearly 1 5n mile fig 10 the maximum horizontal position error of afpf is 10 34 m whereas ipf kf v and kf it is 28 38 m 287 64 m and 398 46 m respectively gps unavailability number 4 and 5 are chosen to test the performance during continuous turns the 5th unavailability fig 11 is included several turns the first is approximately 40 with a longitudinal velocity of vessel about 13kn and the second is approximately 40 with a longitudinal velocity decelerating from 13kn to 11kn the subsequent process repeats the first and second steps but longitudinal velocity reduced to about 10kn fig 12 the maximum horizontal position error of afpf is 17 56 m whereas ipf kf v and kf it is 47 46 m 229 76 m and 773 62 m respectively gps unavailability number 2 and 8 are selected to test the performance during alteration of the vessel s course the 8th unavailability fig 13 is provided during an approximately 90 turn and the longitudinal velocity and lateral velocity of the vessel are about 14kn and 1kn respectively from about 14kn to 10kn of longitudinal velocity during the turn and then to about 10kn but lateral velocity is not significant change throughout the process fig 14 the maximum horizontal position error of afpf is 23 34 m whereas ipf kf v and kf it is 30 78 m 106 35 m and 539 73 m respectively in terms of mems based inertial sensors the performance results of the proposed afpf solution show that better performance than all other solutions during gps signal unavailability including straight sections continuous turns and large angle turns 6 conclusion in this letter a low cost navigation solution for vessel involving one mems based imu together with the speed log and gps was proposed the proposed method utilizes an adaptive fission pf as a nonlinear filtering technique to obtain a navigation solution which is adequate for vessel a loosely coupled integration scheme is used in order to improve the mems based imu gps integrated navigation system precision during gps unavailability the speed derived from the speed log is applied to achieve measurement update for the velocities exploiting the nonholonomic constraints the second approach to achieve an enhanced solution is to apply with roll and pitch reckoned from the transversal and longitudinal accelerometers readouts together with the speed log readouts as a measurement update in afpf so as to updating roll and pitch reckoned from gyroscopes the gps imu log integration using adaptive fission pf have been evaluated with sea trial and compared to three other navigation solutions the results elucidate the benefits of the afpf algorithm in comparison to the ipf kf v and kf algorithms this paper focuses on the application of loosely coupled integration for sensor fusion in future work tightly coupled integration will be taken into consideration which is useful in gps challenging environments acknowledgements this work was supported by the national nature science foundation of china nos 51579024 61374114 and doctoral scientific research foundation of liaoning province 20170520243 
23469,the objective of this paper is to investigate the high speed compressible supercavitating flows with numerical and theoretical methods in the numerical simulation calculations are performed by solving the unsteady reynolds averaged navier stokes urans equations using a cell centered finite volume method and the k ω sst turbulence model is applied as the closure model compressibility effects in liquid phase are modified by the equation of state eos and vapor phase is treated as ideal gas firstly the numerical results are validated with experiments conducted by hrubes 2001 results are shown for high subsonic and transonic projectiles there is a general agreement between the predicted cavity profiles and the experimental data secondly the influence of the mach number on the flow structure and cavitation dynamics from subsonic to supersonic flows is investigated the results show that with the increase of mach number the radial dimension of the front cavity is reduced which is caused by the dramatic increase of pressure around the projectile an expression is proposed to analyze the flow parameters before and behind the shock wave based on the isentropic and potential assumption at the mach number on the interval 1 ma 2 2 the relationship between pressure and density across the shock wave is also investigated overall these findings are great interest in engineering applications keywords high speed supercavitating flows compressible effects flow parameters shock wave 1 introduction supercavitation refers to the case where a moving underwater vehicles is totally enveloped by a large continuous cavity and is a problem of great interest for many naval applications knapp et al 1970 kawakami and arndt 2011 liu et al 2017 wang et al 2015 the phenomenon of supercavitation can be used to achieve global stability and a significant reduction of hydrodynamic drag wang et al 2017 wu et al 2018 supercavities can be formed either ventilated or naturally and in the past decades many researches focus on the ventilated supercavitation due to the application on torpedoes in the relatively low subsonic regimes nowadays the natural supercavitation have gained the attention and is generally applied to the high speed projectile which operate in transonic and supersonic regimes with remarkable performance to defense against frogloks torpedoes mines etc tulin 2001 jenkins and evans 2004 the increasing naval demands for the high speed projectile are leading to investigate the compressible supercavitating flows high speed supercavitating flows is interesting and challenging due to the difficulties in measurement and analysis for the compressibility effects especially for shock wave some experimental and numerical works have been carried out in recent years in the experiments vlasenko 2003 and savchenko 2001 conducted experiments for supercavitation flow regimes at subsonic and transonic speed qualitative features of the high speed supercavities were described and obvious compressibility effects were visualized in front of the cavitator at mach numbers in the range from 0 54 to 0 77 due to the distortion of lines of the scale grid shown in photographs schaffar et al 2005 carried out experiments in a water tank to investigate the behavior of supercavitating projectiles at velocities 600 m s 1036 m s they found a very good agreement for the beginning of the experimental cavity profiles with theoretical results and some deviations appear for the longer cavity due to the movement of projectile and some outside air entering the cavity furthermore experiments under the condition of subsonic transonic and supersonic projectile flows were performed at the naval undersea warfare center nuwc by hrubes 2001 in their work the projectile trajectory supercavity and shock wave were captured clearly in conclusion the camera images and velocities measured with laser barriers are generally applied for these high speed projectile experiments and it is quite difficult to measure more detailed parameters with the consideration of feasibility and accuracy due to the limitations of measurement techniques various numerical methods have been developed to investigate the compressible supercavitating flows there are two ways for numerical simulation namely potential flow theory and viscous flow method wang et al 2017a in potential flow theory vasin 1998 2001a 2011b 2001 combined the slender body theory sbt and matched asymptotic expansion maem to simulate supercavities in subsonic and supersonic flows the results shown the sbt is more applicable for study on subsonic water flows but has a limited application for the shock effects in supersonic cavitation flows serebryakov 1992 2001 2006 serebryakov et al 2009 employed simple heuristic models together with integral conservation laws sbt models based on maem and nonlinear numerical calculation methods to investigate the supercavitation for both incompressible and compressible fluid in subsonic transonic and supersonic flows the results shown that cavity length and radius increase sharply and then decrease sharply in transonic flows which is due to the significant increase of the extension of the perturbation zone nouri and eslamdoost 2009 applied an iterative algorithm based on the boundary element method bem to investigate the supercavity boundary in potential flows the comparison between the computations and the experimental data showed that the algorithm is reliable to predict the characteristics of a supercavitating flow especially for the cavity capturing in a flow field with low cavitation number rozhdestvensky 2001 demonstrated the maem is efficient applicable to various supercavitating flow problems two model problems were chosen namely the flow around a supercavitating shock free hydrofoil and supercavitating wing of large aspect ratio beneath the free surface although the potential flow theory is time efficient for investigation of supercavities it has a limited application for investigation of detail flow structures and dynamic characteristic of high speed supercavitating flows for the low subsonic supercavitating flows it is often treated generally incompressible and isothermal with constant value of liquid density and the energy equation is ignored as for high speed supercavitating flows many complex hydrodynamic problems must be considered such as phase change with large variations in fluid density and pressure fluctuations multiphase compressible flows and shock wave effects zheng et al 2013 dang et al 2016 in order to account for these complexities the navier stokes equations governing a multiphase are generally required and the compressibility effects plays a significant role on predicting such flows as density of each phases begin to vary with pressure chen et al 2014 2016 in addition the numerical methods must include the energy equation an equation of state eos and the cavitation model aleve 1983 investigated the problem of separation flow of water about a circular cone at subsonic transonic and supersonic regimes by considering water as an ideal compressible fluid the results show that the numerical results for supersonic flow are in good agreement with the data from the linear theory and the separation incompressible flow about a cone vasin 2001 worked out an algorithm of calculation of axisymmetric cavities in subsonic and supersonic compressible flows the results shown that the shock effects weakly prevent from the cavity expansion and the narrowing and change of the cavity shape are not obvious as compared with subsonic flows in supersonic flows in addition the shocks for supersonic flows were deeply discussed in his work and the relationship of the flow parameters across the shock was proposed and validated with the results of cole 1948 owis and nayfeh 2003 investigated high speed cavitating flows by solving unsteady compressible navier stokes and considered compressible energy equation and eos of liquid and vapor phase the results show that the compressible computations are in better agreement with the experimental measurements compared with the incompressible computations schaffar et al 2005 combined the eos and euler model without thermal conduction to investigate the effect of cavitator shapes in high subsonic flows and the results show that there is a general agreement between the predicted cavity profiles and the experimental data for the beginning of the cavity neaves and edwards 2004a b 2006 developed an algorithm based on the time derivative preconditioning strategies and applied the algorithm to investigate the subsonic and transonic projectiles in water general multiphase shock tubes and a high speed water entry problem for high subsonic and transonic projectile flows the prediction of cavity and shock wave forms are in good agreement with theoretical results and experimental imaging results of hrubes 2001 although the supercavitation research in water has significantly increased in the past years the compressibility effects and the specific effects of pressure wave on cavitation dynamics in high subsonic transonic and supersonic flows are still not well understood the objective of this paper is to investigate the high speed compressible supercavitating flows 1 investigate the compressibility effects on supercavitating flow structures and cavitation dynamics in high speed flows and 2 investigate the relationship between pressure and density across the shock wave in water and propose an expression to analyze the flow parameters before and behind the shock wave 2 governing equations and numerical approaches 2 1 governing equations the numerical model solves the navier stokes equations governing a newtonian fluid using a cell centered finite volume method the set of governing equations for compressible supercavitating under the homogeneous multiphase flows consists of the conservative form of the favre averaged navier stokes equations the total energy equation the turbulence closure and a transport equation for phase change goncalvès and patella 2010 the continuity momentum energy and cavitation model equations are given below in cartesian coordinates 2 1 ρ m t ρ m u j x j 0 2 2 ρ m u i t ρ m u i u j x j p x i x j μ m μ t u i x j u j x i 2 3 u k x k δ i j 2 3 ρ h h o t t p t ρ u h h o t λ t u p u τ 2 4 ρ l α l t ρ l α l u j x j m m 2 5 ρ m ρ l α l ρ v α v 2 6 μ m μ l α l μ v α v where ρ m is the mixture density ρ l is the liquid density ρ v is the vapor density α v is the vapor fraction α l is the liquid fraction u is the velocity p is the pressure μ m is the mixture laminar viscosity μ l and μ v are respectively the liquid and vapor dynamic viscosities and μ t is the turbulent viscosity h hot is total enthalpy defined as h u 2 2 u τ is shear stress the subscripts i j k denote the directions of the cartesian coordinates the source term m and the sink term m in eqn 2 4 represent the condensation and evaporation rates respectively as will be discussed below the numerical results shown in this paper are performed using the commercial cfd code fluent to solve the urans equations the k ω sst shear stress transport turbulence model is used which combines the advantages of the original k ε and k ω models by using the k ω model near the wall and the k ε model away from the wall menter 1992 the k ω sst has been found to give good predictions of boundary layer detachment characteristics and it becomes the workhorse of practical engineering flow calculations 2 2 kubota cavitation model the kubota model kubota et al 1992 is a transport equation based cavitation model that assumes a constant nuclei size and nuclei density in the fluid domain the growth and collapse of the bubble clusters are assumed to be governed by the simplified rayleigh plesset equation brennen 1995 huang et al 2014 the cavitation process is governed by the mass transfer equation given in eqn 2 4 and the source and sink terms are defined as follows 2 7 m c e 3 α n u c 1 α v ρ v r b 2 3 p v p ρ l 1 2 p p v 2 8 m c v 3 α v ρ v r b 2 3 p p v ρ l 1 2 p p v where c e is the rate constant for vapor generated from the liquid in a region where the local pressure is less than the vapor pressure conversely c v is the rate constant for re conversion of vapor back into liquid in regions where the local pressure exceeds the vapor pressure α nuc is the nucleation volume fraction r b is the bubble diameter p v is the saturated liquid vapor pressure and p is the local fluid pressure in this work the assumed model constants are α nuc 5 10 4 r b 10 6 m c e 50 and c v 0 01 which are the default values in fluent zwart et al 2004 wu et al 2015 and are used because of their supposed general applicability 2 3 equations of state and effective speed of sound the equation of state for each phase is incorporated into the governing equations to consider the compressibility effects at first the following tait equation of state for water zamyshlyaev et al 1967 is employed 2 9 p k 0 ρ l ρ 0 n 1 p 0 k 0 ρ 0 a 0 2 n n 7 15 where p 0 and ρ 0 are reference value at a reference temperature of t 0 293 15 k and a 0 is the speed of sound 1430 m s in the free stream ahead of the shock if the pressure value on the shock front exceeds the value 3 103mpa the equation can be written in the form zamyshlyaev et al 1967 2 10 p d ρ l ρ 0 k 1 p 0 d 416 mpa k 6 29 the vapor state equation is described as a following form by treating vapor phase as ideal gas 2 11 p ρ v r v t where r v 461 6 j kg k is the gas constant of vapor the effective speed of sound for mixture phase is the function of void fraction density and the sound speed of liquid phase and vapor phase wallis 1969 neaves and edwards 2006 the formula can be written as follow 2 12 c 1 ρ m α v ρ v c v 2 1 α v ρ l c l 2 for a quiescent mixture of liquid and vapor at 1 atm and 300 k the u shaped effective speed of sound for mixture phase is shown in fig 1 the speed of sound for a pure water vapor is 430 m s the speed of sound of 1430 m s for pure water is generally accepted 2 4 numerical setup and description firstly the simulations in present study are compared with the experimental measurements around the high subsonic and transonic projectiles in compressible supercavitating flows investigated by hrubes 2001 in the experiments the length l of the high speed projectile is 157 4 mm with a disk cavitator and a length to base diameter ratio of 12 while the transonic projectile is similar to the high speed projectile except the length to base diameter ratio is 10 the computations are performed by using the commercial cfd code fluent to solve the navier stokes equations the simulations are conducted with a 2d axisymmetric fluid solver and the computational domain and boundary conditions are given according to the experimental setup which is shown in fig 2 the domain inlet is 20l upstream of the cavitator center and outlet is 260l downstream of the projectile base center a no slip boundary condition is imposed on the projectile surface and no slip wall conditions are imposed on the side boundaries the experimental water depth is 4 m and a free stream pressure of approximately 1 5 atm was used for all cases and the cavitation number is defined as σ p p v 0 5ρ l u 2 where p is the free stream pressure p v 2367 8pa is the saturation vapor pressure of water at 20 c ρ l 998 2 kg m3 is the density of the water u is the free stream velocity for the inlet boundary the free stream velocity temperature and turbulent quantities are specified based on the experimental data for the outlet boundary the outlet pressure and other free stream variables are set based on the experimental data the fluid mesh details including the enlarged views of the projectile leading edge and trailing edge are shown in fig 3 the 2d axisymmetric fluid mesh is composed of 150 structured elements across the projectile boundary layer which is selected to ensure y yu τ ν l 30 where y is the thickness of the first cell from the surface of the projectile body u τ is the wall frictional velocity and ν l is the liquid kinetic viscosity it is generally accepted that computational accuracy is guaranteed on the interval 30 y 60 for high reynolds number flows lanfrit 2005 mesh refinements are performed at the projectile leading edge le trailing edge te and in the wake region in this present study the influence of the mesh is performed by monitoring the drag coefficient which is defined as follow 2 13 c d d r a g 0 5 ρ l u 2 s where ρ l 998 2 kg m3 is the free stream water density at the temperature t 300 k u 970 m s is the free stream velocity at the inlet and s is the maximum cross sectional area of the projectile four mesh resolutions are firstly tested as shown in table 1 in order to resolve the real transient evolution of supercavitating flow the time step is set as 1 00 10 8s the results shown in table 1 indicate that the differences can be neglected when the mesh nodes are more than 2 2 105 thus the medium resolution mesh with about 2 2 105 nodes is selected as the final mesh the pressure velocity coupling method vanka 1986 is used to solve the governing equations and the spatial derivatives are computed using a second order upwind scheme barth and jesperson 1989 in the computations the time step δt 1 00 10 8s is selected and the averaged global courant freidricks and levy number cfl u δt δx is approximately equal to 0 2 3 results and discussion 3 1 numerical validation for the high subsonic case the free stream velocity is 970 m s which yields a mach number of ma u c 0 68 where u 970 m s is the free stream velocity c 1430 m s is the speed of sound in the undisturbed flow the comparison between the experimental and predicted cavity shape is shown in fig 4 it should be noted that the experimental projectile appears a slight asymmetry of cavity causing by a slight angle of attack also the predicted cavity profile the predicted cavity edge is measured at the 10 void fraction contour and dc is the diameter of the cavity edge is compared with the experimental data of hrubes 2001 and the munzer reichardt theoretical value grady 1979 in fig 5 there is a general agreement between the predicted cavity shape which enveloped the projectile and the experimental visualization while the theoretical appears to be a generalized ellipsoid which is a function of flow and geometry parameters and is slightly larger than the predicted results and the experimental data for the transonic case the free stream velocity is 1540 m s at the mach number of 1 07 the experimental cavity imaging and calculated density contour plots are compared in fig 6 a a zebra color is applied for density contours to clearly show the bow shock cavity and wake good agreement in these aspects between the predicted and experimental results is obtained it is observed that a detached bow shock appears in front of the cavitator contours between the shock wave and the cavitator show the increasing density as the flow behind the shock wave slows further the experimental and calculated shock wave profiles are shown in fig 6 b the shock wave profile for experimental results is measured from the imaging shown in fig 6 a and the front edge of the density contour lines are used to characterize the predicted shock wave profile the comparison shows the predicted shape and standoff distance of the shock wave are in good agreement with experimental results which indicate the shock wave can be predicted with reasonable accuracy for the supersonic case experimental data of the projectile is absent for such high speed and the asymptotic theory is employed to compared with the results predicted by the present numerical method fig 7 a compares the aspect ratio λ cavity length maximal diameter of supercavity for the case of ma 1 20 1 40 1 68 and 2 0 in which the data of asymptotic theory can be obtained from wang et al 2017 fig 7 b gives the comparison with the numerical results at ma 1 68 the s max is the maximum supercavity section area s n is the projectile tail section area l max is the position of the maximum supercavity section as shown in fig 7 the aspect ratio obtained by the present numerical method is in good agreement with the corresponding data of asymptotic theory and the comparison of the nondimensional supercavity shape before the maximum supercavity section obtained from the theoretical result based on the slender body theory and the matched asymptotic expansion method serebryakov 2001 2006 serebryakov et al 2009 with the present numerical solution shows good agreement despite slight discrepancy it can be found that when ma 1 20 as the mach number increases the cavitation number decreases and the aspect ratio λ of the supercavity increases it also indicates that as the mach number of the projectile increases for the supersonic flow the water compressibility effects on the supercavity aspect ratio enhances and the supercavity becomes more slender 3 2 the effects of the mach number on supercavitating flow structures and cavitation dynamics in high speed flows in this section in order to investigate the effects of the mach number on supercavitating flow structures and cavitation dynamics in high speed flows numerical simulations around the projectile were performed at the free stream mach number varies from 0 42 to 1 68 it should be noted that the flow of projectile circuitous generates a pressure wave on the confronted stream surface and the pressure wave directly alters the flow filed which can be used to reflect the compressibility effects figs 8 and 9 present the density and pressure contours at different free stream mach numbers which can clearly show the cavity shape and the changing tendency of pressure wave a logarithmic scale is used for pressure contours due to rather large range of pressures meanwhile the density and partly enlarged distribution along the central axis are illustrated in fig 10 and as shown in fig 2 the origin of coordinate is set at the stagnation point and the positive direction of the x coordinate refers to the upstream region of the projectile it is generally accepted the pressure wave travels at sound speed 1430 m s in pure water and for the subsonic case at the free stream mach number of 0 42 the pressure wave is considered as a disturbance wave which can spread to the whole computational domain the disturbance wave is sufficiently weak and is not reflected visibly in the density contours in fig 8 a furthermore the density distribution in fig 10 shows the density in front of the cavitator is very close to the free stream density value of 998 2 kg m3 while the intensity of disturbance wave gradually increases with the mach number varying from 0 42 to 0 98 and it can be reflected by the visibly larger density contours in fig 8 b and c and increscent density distribution in the whole region along the central axis in fig 10 when the free stream mach number reaches 1 12 figs 8 d and 9 d clearly show a detached bow shock standing in front of the cavitator it is because that the disturbance wave travels more slowly than the projectile which causes the superposition of the disturbance wave and finally generates the shock it is generally accepted that the shock angle is the angle between the direction of the undisturbed velocity and the oblique shock obviously the normal shock is a special case of the oblique shock as for the detached bow shock it can be considered as the combination of numberless segments of micro oblique shock and one segment of micro normal shock in center thus there is no constant shock angle for a bow shock to better illustrate the change trend of the shock shape the problem is simplified a reference point r ahead the cavitator is selected on the x coordinate the distance from point r to the origin point is 0 055l and a tangent line of the bow shock wave can be got through the point r the angle between the direction of the undisturbed velocity and the tangent line is considered as the shock angle of the bow shock which is shown in fig 8 d the shock angle for this case is close to a right angle which indicates the shock is quite weak hence the part of the bow shock right ahead the cavitator along the axis is considered as a normal shock the standoff distance of which can be calculated by the distance between the stagnation point and the position where the density rises sharply in fig 10 thus fig 10 also shows the change trend of the standoff distance for supersonic results and for this case the standoff distance of the shock is calculated approximately 0 0515l it is worth noting that there is free stream in the flow field before the shock wave and the affected region of pressure wave is controlled within the shock wave which can be reflected in density distribution in fig 10 the water density increases sharply from the free stream value across the normal shock for the subsonic cases at the free stream mach number of 1 40 and 1 68 as shown in fig 8 e f and fig 9 e f it has been found that the supercavity cannot envelop the whole projectile for a cavity closure at one position of the body surface where a relatively weak shock appears furthermore it can be clearly observed that the intensity of the bow shock in front of the cavitator increases visibly for a significant reduction of the standoff distance and shock angle in addition the maximum pressure and density both appear at the stagnation point at the mach number of 0 42 the pressure increases about 1200 times between free stream value and the stagnation point while the corresponding value of density increases about 0 1 times at the mach number of 1 68 the pressure and density increase about 24400 times and 0 5 times respectively between free stream value and the stagnation point in order to investigate the effects of pressure wave variation on cavitation dynamics the front cavity thicknesses of different mach numbers are illustrated in fig 11 it is observed that the cavity shapes are all close to ellipsoid revolution especially in leading edge the cavity thickness are nearly all the same the radial dimension of the front cavity decreases with the increasing mach number especially at the mach numbers 1 40 and 1 68 the cavity closure occurs on the body surface as discussed in previous paragraph in order to explain this phenomenon the ensemble averaged pressure p p 0 at selected locations along the projectile shown in fig 12 a for different mach number are presented in fig 12 b it can be observed that in general the increasing free stream mach number results in the increase of pressure distribution around the surface of the projectile especially in supersonic flows the pressure distribution changes sharply on the profile a c and d for the profile a and b the selected locations are near the leading edge of the projectile where is covered with cavity shown in fig 11 a the dramatic increase of the pressure is due to the effects of the bow shocks in front of the cavitator as shown in fig 8 the differences of pressure distribution between the subsonic and supersonic flows indicates that the pressure behind the shock wave increase sharply and it should be noted that the line of pressure distribution at location a is longitudinally crossing both the cavity and the shock wave causing the significant change of the pressure in supersonic flows as for profile c and d the selected locations are near the trailing edge where the effect of the bow shock is very weak and the significant change of the pressure in supersonic flows is due to the effects of the relatively weak shocks at the cavity closure positions shown in fig 11 a which has the same change trend with the bow shock furthermore larger pressure gradient around the body of projectile can be observed with the increasing mach number which is resulted from the reduction of the shock angle as shown in fig 8 in conclusion as shown in figs 11 and 12 b it has been found that the increasing free stream mach number results in dramatic increase of pressure distribution around the surface of the projectile which restrains the cavitation evolution and cause the reduction of radial dimension of the front cavity as for the cases of ma 1 40 and 1 68 the compressibility effects enhances and the cavity become more slender meanwhile the influence of the geometry of the projectile on the front cavity can not be ignored because of the large slope of the geometry of the projectile it can be observed in figs 8 and 11 b that the growth rate of cavity radial dimension is less than the growth rate of the body radial dimension so that it stops the cavity around the projectile growing streamwise the cavity closure finally occurs at one position of the body surface and the closure position also moves forward with the increasing free stream mach number however the cavity dimension in the wake seems to be fairly similar which is clearly shown in fig 11 b 3 3 theoretical investigation of shock wave in a supersonic compressible water flow in this section the shock wave in supersonic compressible water flow is discussed according to the shape there are three different types of shock namely the normal shock the oblique shock and the detached bow shock and the detached bow shock can be considered as the combination of numberless segments of micro oblique shock and one segment of micro normal shock in center the numerical results discussed in section 3 2 present many details of flow field and show the shock wave can be predicted with reasonable accuracy with refined fluid mesh the theoretical investigation of the shock wave discussed in this section is conducted to analyze the flow parameters before and behind the shock wave in water and find the relationship between pressure and density across the shock wave fig 13 shows the detached bow shock standing in front of the cavitator in a supersonic water flow and diagram of the flow past the projectile a micro control volume was chosen from the bow shock curve the flow velocity across the control volume was decomposed where β is the angle between the direction of the undisturbed velocity v 1t and the shock v 1n and v 1t are the normal and tangential components of the velocity ahead of the shock and v 2n and v 2t are the velocity components behind the shock the basic relations for the shock including the mass momentum and energy conservation equations can be written on the surface of the control volume as follows loitsyanskii 1966 the mass equation 3 1 ρ 1 v 1 n ρ 2 v 2 n the normal and tangential momentum equations 3 2 p 1 p 2 ρ 2 v 2 n 2 ρ 1 v 1 n 2 3 3 v 2 t v 1 t the energy equation 3 4 h 1 v 1 n 2 2 h 2 v 2 n 2 2 c o n s t where p 1 ρ 1 h 1 are the pressure density and internal energy of mass unit ahead of the shock and subscript 2 denotes the quantities behind the shock the equation of the shock adiabatic curve must be added to eqns 3 1 3 4 it is well known zamyshlyaev et al 1967 that at the pressures lower than 3 103mpa the shock and the static adiabatic curves coincide and can be expressed by the tait equation given in eqn 2 9 the expressions for describing the flow velocities ahead of the shock v 1n and behind it v 2n come from eqns 3 1 and 3 2 can be written as follows 3 5 v 1 n 2 p 2 p 1 ρ 2 ρ 1 ρ 2 ρ 1 v 2 n 2 p 2 p 1 ρ 2 ρ 1 ρ 1 ρ 2 the pressure on the shock front will suit for the tait equation and the flow can be considered as equal entropy potential water is rather law compressible fluid as compared with air in water many physical effects tied up with compressibility essentially differ from those in air vasin 2001 it can be assumed that the shock in water is isentropic and the flows are potential and adiabatic at the mach numbers on the interval 1 ma 2 2 and the differential equation according to the law of thermodynamics can be written as follow 3 6 δ q d h v d p 0 where q h v are the quantity of heat enthalpy and specific volume v 1 ρ and with the help of eqn 3 4 eqn 3 6 can be written as follow 3 7 h 2 h 1 v 1 n 2 v 2 n 2 1 2 d p ρ where dp comes from eqn 2 9 and can be written as the form 3 8 d p n k 0 ρ n 1 ρ 0 n d ρ the dependences of the ratio of densities ρ 2 ρ 1 on the pressure come from eqns 2 9 3 5 and 3 7 and 3 8 and can be written as follow 3 9 p 2 p 0 k 0 p 1 p 0 k 0 4 3 ρ 2 ρ 1 1 4 3 ρ 2 ρ 1 where k 0 is assumed constant with value of 3 108 pa comparing to which the value of p 0 101325 pa can be ignored and eqn 3 9 has the form 3 10 p 2 k 0 p 1 k 0 4 3 ρ 2 ρ 1 1 4 3 ρ 2 ρ 1 eqn 3 10 is similar to the rankine hugoniot relation and is proposed to analyze the relation of the flow parameters before and behind the shock wave under the assumption that the shock in water is isentropic and the flows are potential and adiabatic at the mach numbers on the interval 1 ma 2 2 this relation is independent of the shock angle and for any one shock wave a given ratio of pressure p 2 k 0 p 1 k 0 corresponds to a single ratio of density ρ 2 ρ 1 and it is shown in fig 14 it is not difficult to get from fig 14 that when the value of p 2 k 0 p 1 k 0 approaches to 1 the ratio of density ρ 2 ρ 1 is also close to 1 which indicates that the shock intensity is sufficiently small and the shock can be treated as weak shock having low compressibility effects meanwhile as the value of p 2 k 0 p 1 k 0 approaches to the shock intensity is infinite and the ratio of density ρ 2 ρ 1 has an asymptotic value of 4 3 which is much less than that value of 6 in air as supplement fig 14 also shows quantitative comparison of the theoretical results with the numerical simulation results in supersonic flow given in table 2 three mach numbers are chosen as comparison on the interval 1 ma 2 2 it can be observed in table 2 that although the pressure ratio increases by 17 5 times from the mach number 1 12 to 1 68 the density ratio rises by only 8 5 the comparison shows that the numerical results are in good agreement with the results derived in theory for average error less than 3 overall the expression 3 11 can be used to predict the relation of the flow parameters before and behind the shock wave with reasonable accuracy on the interval 1 ma 2 2 4 conclusions in this study the high speed compressible supercavitating flows is investigated with numerical and theoretical method the primary findings include 1 results are shown for high subsonic and transonic projectiles there is a general agreement between the predicted cavity profiles and the experimental data meanwhile the comparison shows the predicted shape and standoff distance of the shock wave are in good agreement with experimental results which indicate the shock wave can be predicted with reasonable accuracy 2 with the increase of mach number pressure wave evolves from disturbance wave into a detached bow shock in front of the cavitator which leads to dramatic increase of pressure around the surface of the projectile the increased pressure restrains the cavitation evolution and cause the reduction of radial dimension of the front cavity following the reducing trend of the radial dimension cavity closure finally occurs at one position of the projectile surface and the closure position also moves forward with the increasing free stream mach number however the cavity dimension in wake seems fairly similar furthermore a relatively weak shock appears at the cavity closure position and the intensity of the bow shock in front of the cavitator increases visibly for a significant reduction of the standoff distance and shock angle 3 an expression is proposed to analyze the flow parameters before and behind the shock wave and the relationship between pressure and density across the shock wave is also investigated the assumption is considered that the shock in water is isentropic and the flows are potential and adiabatic at the mach numbers on the interval 1 ma 2 2 this relation is independent of shock angle and for any kind of shock and a single ratio of density can be calculated by a given ratio of pressure when the value of p 2 k 0 p 1 k 0 approaches to the shock intensity is infinite and the ratio of density ρ 2 ρ 1 has an asymptotic value of 4 3 which is much less than that value of 6 in air thus the study has demonstrated that the numerical and theory methods are reasonable and reliable tools for understanding the cavitation dynamics in high speed compressible flows the authors will further modify the cavitation model with temperature adjusted tait equation to improve the numerical methods as well as demonstrate the applicability of the numerical methods for predicting the cavitating flows in other compressible fields water entry and multiphase shock wave tube et al in our future work besides the simple heuristic models together with integral conservation laws sbt models based on maem and nonlinear numerical calculation methods will be employed to investigate the supercavitation for both incompressible and compressible fluid in subsonic transonic and supersonic flows serebryakov 2001 2006 serebryakov et al 2009 additional experimental and numerical studies are also needed to improve the understanding of the unsteady supercavitating flows in high speed compressible flows acknowledgment the authors gratefully acknowledge support by the national science foundation of china nsfc grant nos 91752105 and 51679005 national natural science foundation of beijing grant no 3172029 the authors also appreciated the funding support from chinese advanced research of equipment fund 61402070401 and 61402070501 
23469,the objective of this paper is to investigate the high speed compressible supercavitating flows with numerical and theoretical methods in the numerical simulation calculations are performed by solving the unsteady reynolds averaged navier stokes urans equations using a cell centered finite volume method and the k ω sst turbulence model is applied as the closure model compressibility effects in liquid phase are modified by the equation of state eos and vapor phase is treated as ideal gas firstly the numerical results are validated with experiments conducted by hrubes 2001 results are shown for high subsonic and transonic projectiles there is a general agreement between the predicted cavity profiles and the experimental data secondly the influence of the mach number on the flow structure and cavitation dynamics from subsonic to supersonic flows is investigated the results show that with the increase of mach number the radial dimension of the front cavity is reduced which is caused by the dramatic increase of pressure around the projectile an expression is proposed to analyze the flow parameters before and behind the shock wave based on the isentropic and potential assumption at the mach number on the interval 1 ma 2 2 the relationship between pressure and density across the shock wave is also investigated overall these findings are great interest in engineering applications keywords high speed supercavitating flows compressible effects flow parameters shock wave 1 introduction supercavitation refers to the case where a moving underwater vehicles is totally enveloped by a large continuous cavity and is a problem of great interest for many naval applications knapp et al 1970 kawakami and arndt 2011 liu et al 2017 wang et al 2015 the phenomenon of supercavitation can be used to achieve global stability and a significant reduction of hydrodynamic drag wang et al 2017 wu et al 2018 supercavities can be formed either ventilated or naturally and in the past decades many researches focus on the ventilated supercavitation due to the application on torpedoes in the relatively low subsonic regimes nowadays the natural supercavitation have gained the attention and is generally applied to the high speed projectile which operate in transonic and supersonic regimes with remarkable performance to defense against frogloks torpedoes mines etc tulin 2001 jenkins and evans 2004 the increasing naval demands for the high speed projectile are leading to investigate the compressible supercavitating flows high speed supercavitating flows is interesting and challenging due to the difficulties in measurement and analysis for the compressibility effects especially for shock wave some experimental and numerical works have been carried out in recent years in the experiments vlasenko 2003 and savchenko 2001 conducted experiments for supercavitation flow regimes at subsonic and transonic speed qualitative features of the high speed supercavities were described and obvious compressibility effects were visualized in front of the cavitator at mach numbers in the range from 0 54 to 0 77 due to the distortion of lines of the scale grid shown in photographs schaffar et al 2005 carried out experiments in a water tank to investigate the behavior of supercavitating projectiles at velocities 600 m s 1036 m s they found a very good agreement for the beginning of the experimental cavity profiles with theoretical results and some deviations appear for the longer cavity due to the movement of projectile and some outside air entering the cavity furthermore experiments under the condition of subsonic transonic and supersonic projectile flows were performed at the naval undersea warfare center nuwc by hrubes 2001 in their work the projectile trajectory supercavity and shock wave were captured clearly in conclusion the camera images and velocities measured with laser barriers are generally applied for these high speed projectile experiments and it is quite difficult to measure more detailed parameters with the consideration of feasibility and accuracy due to the limitations of measurement techniques various numerical methods have been developed to investigate the compressible supercavitating flows there are two ways for numerical simulation namely potential flow theory and viscous flow method wang et al 2017a in potential flow theory vasin 1998 2001a 2011b 2001 combined the slender body theory sbt and matched asymptotic expansion maem to simulate supercavities in subsonic and supersonic flows the results shown the sbt is more applicable for study on subsonic water flows but has a limited application for the shock effects in supersonic cavitation flows serebryakov 1992 2001 2006 serebryakov et al 2009 employed simple heuristic models together with integral conservation laws sbt models based on maem and nonlinear numerical calculation methods to investigate the supercavitation for both incompressible and compressible fluid in subsonic transonic and supersonic flows the results shown that cavity length and radius increase sharply and then decrease sharply in transonic flows which is due to the significant increase of the extension of the perturbation zone nouri and eslamdoost 2009 applied an iterative algorithm based on the boundary element method bem to investigate the supercavity boundary in potential flows the comparison between the computations and the experimental data showed that the algorithm is reliable to predict the characteristics of a supercavitating flow especially for the cavity capturing in a flow field with low cavitation number rozhdestvensky 2001 demonstrated the maem is efficient applicable to various supercavitating flow problems two model problems were chosen namely the flow around a supercavitating shock free hydrofoil and supercavitating wing of large aspect ratio beneath the free surface although the potential flow theory is time efficient for investigation of supercavities it has a limited application for investigation of detail flow structures and dynamic characteristic of high speed supercavitating flows for the low subsonic supercavitating flows it is often treated generally incompressible and isothermal with constant value of liquid density and the energy equation is ignored as for high speed supercavitating flows many complex hydrodynamic problems must be considered such as phase change with large variations in fluid density and pressure fluctuations multiphase compressible flows and shock wave effects zheng et al 2013 dang et al 2016 in order to account for these complexities the navier stokes equations governing a multiphase are generally required and the compressibility effects plays a significant role on predicting such flows as density of each phases begin to vary with pressure chen et al 2014 2016 in addition the numerical methods must include the energy equation an equation of state eos and the cavitation model aleve 1983 investigated the problem of separation flow of water about a circular cone at subsonic transonic and supersonic regimes by considering water as an ideal compressible fluid the results show that the numerical results for supersonic flow are in good agreement with the data from the linear theory and the separation incompressible flow about a cone vasin 2001 worked out an algorithm of calculation of axisymmetric cavities in subsonic and supersonic compressible flows the results shown that the shock effects weakly prevent from the cavity expansion and the narrowing and change of the cavity shape are not obvious as compared with subsonic flows in supersonic flows in addition the shocks for supersonic flows were deeply discussed in his work and the relationship of the flow parameters across the shock was proposed and validated with the results of cole 1948 owis and nayfeh 2003 investigated high speed cavitating flows by solving unsteady compressible navier stokes and considered compressible energy equation and eos of liquid and vapor phase the results show that the compressible computations are in better agreement with the experimental measurements compared with the incompressible computations schaffar et al 2005 combined the eos and euler model without thermal conduction to investigate the effect of cavitator shapes in high subsonic flows and the results show that there is a general agreement between the predicted cavity profiles and the experimental data for the beginning of the cavity neaves and edwards 2004a b 2006 developed an algorithm based on the time derivative preconditioning strategies and applied the algorithm to investigate the subsonic and transonic projectiles in water general multiphase shock tubes and a high speed water entry problem for high subsonic and transonic projectile flows the prediction of cavity and shock wave forms are in good agreement with theoretical results and experimental imaging results of hrubes 2001 although the supercavitation research in water has significantly increased in the past years the compressibility effects and the specific effects of pressure wave on cavitation dynamics in high subsonic transonic and supersonic flows are still not well understood the objective of this paper is to investigate the high speed compressible supercavitating flows 1 investigate the compressibility effects on supercavitating flow structures and cavitation dynamics in high speed flows and 2 investigate the relationship between pressure and density across the shock wave in water and propose an expression to analyze the flow parameters before and behind the shock wave 2 governing equations and numerical approaches 2 1 governing equations the numerical model solves the navier stokes equations governing a newtonian fluid using a cell centered finite volume method the set of governing equations for compressible supercavitating under the homogeneous multiphase flows consists of the conservative form of the favre averaged navier stokes equations the total energy equation the turbulence closure and a transport equation for phase change goncalvès and patella 2010 the continuity momentum energy and cavitation model equations are given below in cartesian coordinates 2 1 ρ m t ρ m u j x j 0 2 2 ρ m u i t ρ m u i u j x j p x i x j μ m μ t u i x j u j x i 2 3 u k x k δ i j 2 3 ρ h h o t t p t ρ u h h o t λ t u p u τ 2 4 ρ l α l t ρ l α l u j x j m m 2 5 ρ m ρ l α l ρ v α v 2 6 μ m μ l α l μ v α v where ρ m is the mixture density ρ l is the liquid density ρ v is the vapor density α v is the vapor fraction α l is the liquid fraction u is the velocity p is the pressure μ m is the mixture laminar viscosity μ l and μ v are respectively the liquid and vapor dynamic viscosities and μ t is the turbulent viscosity h hot is total enthalpy defined as h u 2 2 u τ is shear stress the subscripts i j k denote the directions of the cartesian coordinates the source term m and the sink term m in eqn 2 4 represent the condensation and evaporation rates respectively as will be discussed below the numerical results shown in this paper are performed using the commercial cfd code fluent to solve the urans equations the k ω sst shear stress transport turbulence model is used which combines the advantages of the original k ε and k ω models by using the k ω model near the wall and the k ε model away from the wall menter 1992 the k ω sst has been found to give good predictions of boundary layer detachment characteristics and it becomes the workhorse of practical engineering flow calculations 2 2 kubota cavitation model the kubota model kubota et al 1992 is a transport equation based cavitation model that assumes a constant nuclei size and nuclei density in the fluid domain the growth and collapse of the bubble clusters are assumed to be governed by the simplified rayleigh plesset equation brennen 1995 huang et al 2014 the cavitation process is governed by the mass transfer equation given in eqn 2 4 and the source and sink terms are defined as follows 2 7 m c e 3 α n u c 1 α v ρ v r b 2 3 p v p ρ l 1 2 p p v 2 8 m c v 3 α v ρ v r b 2 3 p p v ρ l 1 2 p p v where c e is the rate constant for vapor generated from the liquid in a region where the local pressure is less than the vapor pressure conversely c v is the rate constant for re conversion of vapor back into liquid in regions where the local pressure exceeds the vapor pressure α nuc is the nucleation volume fraction r b is the bubble diameter p v is the saturated liquid vapor pressure and p is the local fluid pressure in this work the assumed model constants are α nuc 5 10 4 r b 10 6 m c e 50 and c v 0 01 which are the default values in fluent zwart et al 2004 wu et al 2015 and are used because of their supposed general applicability 2 3 equations of state and effective speed of sound the equation of state for each phase is incorporated into the governing equations to consider the compressibility effects at first the following tait equation of state for water zamyshlyaev et al 1967 is employed 2 9 p k 0 ρ l ρ 0 n 1 p 0 k 0 ρ 0 a 0 2 n n 7 15 where p 0 and ρ 0 are reference value at a reference temperature of t 0 293 15 k and a 0 is the speed of sound 1430 m s in the free stream ahead of the shock if the pressure value on the shock front exceeds the value 3 103mpa the equation can be written in the form zamyshlyaev et al 1967 2 10 p d ρ l ρ 0 k 1 p 0 d 416 mpa k 6 29 the vapor state equation is described as a following form by treating vapor phase as ideal gas 2 11 p ρ v r v t where r v 461 6 j kg k is the gas constant of vapor the effective speed of sound for mixture phase is the function of void fraction density and the sound speed of liquid phase and vapor phase wallis 1969 neaves and edwards 2006 the formula can be written as follow 2 12 c 1 ρ m α v ρ v c v 2 1 α v ρ l c l 2 for a quiescent mixture of liquid and vapor at 1 atm and 300 k the u shaped effective speed of sound for mixture phase is shown in fig 1 the speed of sound for a pure water vapor is 430 m s the speed of sound of 1430 m s for pure water is generally accepted 2 4 numerical setup and description firstly the simulations in present study are compared with the experimental measurements around the high subsonic and transonic projectiles in compressible supercavitating flows investigated by hrubes 2001 in the experiments the length l of the high speed projectile is 157 4 mm with a disk cavitator and a length to base diameter ratio of 12 while the transonic projectile is similar to the high speed projectile except the length to base diameter ratio is 10 the computations are performed by using the commercial cfd code fluent to solve the navier stokes equations the simulations are conducted with a 2d axisymmetric fluid solver and the computational domain and boundary conditions are given according to the experimental setup which is shown in fig 2 the domain inlet is 20l upstream of the cavitator center and outlet is 260l downstream of the projectile base center a no slip boundary condition is imposed on the projectile surface and no slip wall conditions are imposed on the side boundaries the experimental water depth is 4 m and a free stream pressure of approximately 1 5 atm was used for all cases and the cavitation number is defined as σ p p v 0 5ρ l u 2 where p is the free stream pressure p v 2367 8pa is the saturation vapor pressure of water at 20 c ρ l 998 2 kg m3 is the density of the water u is the free stream velocity for the inlet boundary the free stream velocity temperature and turbulent quantities are specified based on the experimental data for the outlet boundary the outlet pressure and other free stream variables are set based on the experimental data the fluid mesh details including the enlarged views of the projectile leading edge and trailing edge are shown in fig 3 the 2d axisymmetric fluid mesh is composed of 150 structured elements across the projectile boundary layer which is selected to ensure y yu τ ν l 30 where y is the thickness of the first cell from the surface of the projectile body u τ is the wall frictional velocity and ν l is the liquid kinetic viscosity it is generally accepted that computational accuracy is guaranteed on the interval 30 y 60 for high reynolds number flows lanfrit 2005 mesh refinements are performed at the projectile leading edge le trailing edge te and in the wake region in this present study the influence of the mesh is performed by monitoring the drag coefficient which is defined as follow 2 13 c d d r a g 0 5 ρ l u 2 s where ρ l 998 2 kg m3 is the free stream water density at the temperature t 300 k u 970 m s is the free stream velocity at the inlet and s is the maximum cross sectional area of the projectile four mesh resolutions are firstly tested as shown in table 1 in order to resolve the real transient evolution of supercavitating flow the time step is set as 1 00 10 8s the results shown in table 1 indicate that the differences can be neglected when the mesh nodes are more than 2 2 105 thus the medium resolution mesh with about 2 2 105 nodes is selected as the final mesh the pressure velocity coupling method vanka 1986 is used to solve the governing equations and the spatial derivatives are computed using a second order upwind scheme barth and jesperson 1989 in the computations the time step δt 1 00 10 8s is selected and the averaged global courant freidricks and levy number cfl u δt δx is approximately equal to 0 2 3 results and discussion 3 1 numerical validation for the high subsonic case the free stream velocity is 970 m s which yields a mach number of ma u c 0 68 where u 970 m s is the free stream velocity c 1430 m s is the speed of sound in the undisturbed flow the comparison between the experimental and predicted cavity shape is shown in fig 4 it should be noted that the experimental projectile appears a slight asymmetry of cavity causing by a slight angle of attack also the predicted cavity profile the predicted cavity edge is measured at the 10 void fraction contour and dc is the diameter of the cavity edge is compared with the experimental data of hrubes 2001 and the munzer reichardt theoretical value grady 1979 in fig 5 there is a general agreement between the predicted cavity shape which enveloped the projectile and the experimental visualization while the theoretical appears to be a generalized ellipsoid which is a function of flow and geometry parameters and is slightly larger than the predicted results and the experimental data for the transonic case the free stream velocity is 1540 m s at the mach number of 1 07 the experimental cavity imaging and calculated density contour plots are compared in fig 6 a a zebra color is applied for density contours to clearly show the bow shock cavity and wake good agreement in these aspects between the predicted and experimental results is obtained it is observed that a detached bow shock appears in front of the cavitator contours between the shock wave and the cavitator show the increasing density as the flow behind the shock wave slows further the experimental and calculated shock wave profiles are shown in fig 6 b the shock wave profile for experimental results is measured from the imaging shown in fig 6 a and the front edge of the density contour lines are used to characterize the predicted shock wave profile the comparison shows the predicted shape and standoff distance of the shock wave are in good agreement with experimental results which indicate the shock wave can be predicted with reasonable accuracy for the supersonic case experimental data of the projectile is absent for such high speed and the asymptotic theory is employed to compared with the results predicted by the present numerical method fig 7 a compares the aspect ratio λ cavity length maximal diameter of supercavity for the case of ma 1 20 1 40 1 68 and 2 0 in which the data of asymptotic theory can be obtained from wang et al 2017 fig 7 b gives the comparison with the numerical results at ma 1 68 the s max is the maximum supercavity section area s n is the projectile tail section area l max is the position of the maximum supercavity section as shown in fig 7 the aspect ratio obtained by the present numerical method is in good agreement with the corresponding data of asymptotic theory and the comparison of the nondimensional supercavity shape before the maximum supercavity section obtained from the theoretical result based on the slender body theory and the matched asymptotic expansion method serebryakov 2001 2006 serebryakov et al 2009 with the present numerical solution shows good agreement despite slight discrepancy it can be found that when ma 1 20 as the mach number increases the cavitation number decreases and the aspect ratio λ of the supercavity increases it also indicates that as the mach number of the projectile increases for the supersonic flow the water compressibility effects on the supercavity aspect ratio enhances and the supercavity becomes more slender 3 2 the effects of the mach number on supercavitating flow structures and cavitation dynamics in high speed flows in this section in order to investigate the effects of the mach number on supercavitating flow structures and cavitation dynamics in high speed flows numerical simulations around the projectile were performed at the free stream mach number varies from 0 42 to 1 68 it should be noted that the flow of projectile circuitous generates a pressure wave on the confronted stream surface and the pressure wave directly alters the flow filed which can be used to reflect the compressibility effects figs 8 and 9 present the density and pressure contours at different free stream mach numbers which can clearly show the cavity shape and the changing tendency of pressure wave a logarithmic scale is used for pressure contours due to rather large range of pressures meanwhile the density and partly enlarged distribution along the central axis are illustrated in fig 10 and as shown in fig 2 the origin of coordinate is set at the stagnation point and the positive direction of the x coordinate refers to the upstream region of the projectile it is generally accepted the pressure wave travels at sound speed 1430 m s in pure water and for the subsonic case at the free stream mach number of 0 42 the pressure wave is considered as a disturbance wave which can spread to the whole computational domain the disturbance wave is sufficiently weak and is not reflected visibly in the density contours in fig 8 a furthermore the density distribution in fig 10 shows the density in front of the cavitator is very close to the free stream density value of 998 2 kg m3 while the intensity of disturbance wave gradually increases with the mach number varying from 0 42 to 0 98 and it can be reflected by the visibly larger density contours in fig 8 b and c and increscent density distribution in the whole region along the central axis in fig 10 when the free stream mach number reaches 1 12 figs 8 d and 9 d clearly show a detached bow shock standing in front of the cavitator it is because that the disturbance wave travels more slowly than the projectile which causes the superposition of the disturbance wave and finally generates the shock it is generally accepted that the shock angle is the angle between the direction of the undisturbed velocity and the oblique shock obviously the normal shock is a special case of the oblique shock as for the detached bow shock it can be considered as the combination of numberless segments of micro oblique shock and one segment of micro normal shock in center thus there is no constant shock angle for a bow shock to better illustrate the change trend of the shock shape the problem is simplified a reference point r ahead the cavitator is selected on the x coordinate the distance from point r to the origin point is 0 055l and a tangent line of the bow shock wave can be got through the point r the angle between the direction of the undisturbed velocity and the tangent line is considered as the shock angle of the bow shock which is shown in fig 8 d the shock angle for this case is close to a right angle which indicates the shock is quite weak hence the part of the bow shock right ahead the cavitator along the axis is considered as a normal shock the standoff distance of which can be calculated by the distance between the stagnation point and the position where the density rises sharply in fig 10 thus fig 10 also shows the change trend of the standoff distance for supersonic results and for this case the standoff distance of the shock is calculated approximately 0 0515l it is worth noting that there is free stream in the flow field before the shock wave and the affected region of pressure wave is controlled within the shock wave which can be reflected in density distribution in fig 10 the water density increases sharply from the free stream value across the normal shock for the subsonic cases at the free stream mach number of 1 40 and 1 68 as shown in fig 8 e f and fig 9 e f it has been found that the supercavity cannot envelop the whole projectile for a cavity closure at one position of the body surface where a relatively weak shock appears furthermore it can be clearly observed that the intensity of the bow shock in front of the cavitator increases visibly for a significant reduction of the standoff distance and shock angle in addition the maximum pressure and density both appear at the stagnation point at the mach number of 0 42 the pressure increases about 1200 times between free stream value and the stagnation point while the corresponding value of density increases about 0 1 times at the mach number of 1 68 the pressure and density increase about 24400 times and 0 5 times respectively between free stream value and the stagnation point in order to investigate the effects of pressure wave variation on cavitation dynamics the front cavity thicknesses of different mach numbers are illustrated in fig 11 it is observed that the cavity shapes are all close to ellipsoid revolution especially in leading edge the cavity thickness are nearly all the same the radial dimension of the front cavity decreases with the increasing mach number especially at the mach numbers 1 40 and 1 68 the cavity closure occurs on the body surface as discussed in previous paragraph in order to explain this phenomenon the ensemble averaged pressure p p 0 at selected locations along the projectile shown in fig 12 a for different mach number are presented in fig 12 b it can be observed that in general the increasing free stream mach number results in the increase of pressure distribution around the surface of the projectile especially in supersonic flows the pressure distribution changes sharply on the profile a c and d for the profile a and b the selected locations are near the leading edge of the projectile where is covered with cavity shown in fig 11 a the dramatic increase of the pressure is due to the effects of the bow shocks in front of the cavitator as shown in fig 8 the differences of pressure distribution between the subsonic and supersonic flows indicates that the pressure behind the shock wave increase sharply and it should be noted that the line of pressure distribution at location a is longitudinally crossing both the cavity and the shock wave causing the significant change of the pressure in supersonic flows as for profile c and d the selected locations are near the trailing edge where the effect of the bow shock is very weak and the significant change of the pressure in supersonic flows is due to the effects of the relatively weak shocks at the cavity closure positions shown in fig 11 a which has the same change trend with the bow shock furthermore larger pressure gradient around the body of projectile can be observed with the increasing mach number which is resulted from the reduction of the shock angle as shown in fig 8 in conclusion as shown in figs 11 and 12 b it has been found that the increasing free stream mach number results in dramatic increase of pressure distribution around the surface of the projectile which restrains the cavitation evolution and cause the reduction of radial dimension of the front cavity as for the cases of ma 1 40 and 1 68 the compressibility effects enhances and the cavity become more slender meanwhile the influence of the geometry of the projectile on the front cavity can not be ignored because of the large slope of the geometry of the projectile it can be observed in figs 8 and 11 b that the growth rate of cavity radial dimension is less than the growth rate of the body radial dimension so that it stops the cavity around the projectile growing streamwise the cavity closure finally occurs at one position of the body surface and the closure position also moves forward with the increasing free stream mach number however the cavity dimension in the wake seems to be fairly similar which is clearly shown in fig 11 b 3 3 theoretical investigation of shock wave in a supersonic compressible water flow in this section the shock wave in supersonic compressible water flow is discussed according to the shape there are three different types of shock namely the normal shock the oblique shock and the detached bow shock and the detached bow shock can be considered as the combination of numberless segments of micro oblique shock and one segment of micro normal shock in center the numerical results discussed in section 3 2 present many details of flow field and show the shock wave can be predicted with reasonable accuracy with refined fluid mesh the theoretical investigation of the shock wave discussed in this section is conducted to analyze the flow parameters before and behind the shock wave in water and find the relationship between pressure and density across the shock wave fig 13 shows the detached bow shock standing in front of the cavitator in a supersonic water flow and diagram of the flow past the projectile a micro control volume was chosen from the bow shock curve the flow velocity across the control volume was decomposed where β is the angle between the direction of the undisturbed velocity v 1t and the shock v 1n and v 1t are the normal and tangential components of the velocity ahead of the shock and v 2n and v 2t are the velocity components behind the shock the basic relations for the shock including the mass momentum and energy conservation equations can be written on the surface of the control volume as follows loitsyanskii 1966 the mass equation 3 1 ρ 1 v 1 n ρ 2 v 2 n the normal and tangential momentum equations 3 2 p 1 p 2 ρ 2 v 2 n 2 ρ 1 v 1 n 2 3 3 v 2 t v 1 t the energy equation 3 4 h 1 v 1 n 2 2 h 2 v 2 n 2 2 c o n s t where p 1 ρ 1 h 1 are the pressure density and internal energy of mass unit ahead of the shock and subscript 2 denotes the quantities behind the shock the equation of the shock adiabatic curve must be added to eqns 3 1 3 4 it is well known zamyshlyaev et al 1967 that at the pressures lower than 3 103mpa the shock and the static adiabatic curves coincide and can be expressed by the tait equation given in eqn 2 9 the expressions for describing the flow velocities ahead of the shock v 1n and behind it v 2n come from eqns 3 1 and 3 2 can be written as follows 3 5 v 1 n 2 p 2 p 1 ρ 2 ρ 1 ρ 2 ρ 1 v 2 n 2 p 2 p 1 ρ 2 ρ 1 ρ 1 ρ 2 the pressure on the shock front will suit for the tait equation and the flow can be considered as equal entropy potential water is rather law compressible fluid as compared with air in water many physical effects tied up with compressibility essentially differ from those in air vasin 2001 it can be assumed that the shock in water is isentropic and the flows are potential and adiabatic at the mach numbers on the interval 1 ma 2 2 and the differential equation according to the law of thermodynamics can be written as follow 3 6 δ q d h v d p 0 where q h v are the quantity of heat enthalpy and specific volume v 1 ρ and with the help of eqn 3 4 eqn 3 6 can be written as follow 3 7 h 2 h 1 v 1 n 2 v 2 n 2 1 2 d p ρ where dp comes from eqn 2 9 and can be written as the form 3 8 d p n k 0 ρ n 1 ρ 0 n d ρ the dependences of the ratio of densities ρ 2 ρ 1 on the pressure come from eqns 2 9 3 5 and 3 7 and 3 8 and can be written as follow 3 9 p 2 p 0 k 0 p 1 p 0 k 0 4 3 ρ 2 ρ 1 1 4 3 ρ 2 ρ 1 where k 0 is assumed constant with value of 3 108 pa comparing to which the value of p 0 101325 pa can be ignored and eqn 3 9 has the form 3 10 p 2 k 0 p 1 k 0 4 3 ρ 2 ρ 1 1 4 3 ρ 2 ρ 1 eqn 3 10 is similar to the rankine hugoniot relation and is proposed to analyze the relation of the flow parameters before and behind the shock wave under the assumption that the shock in water is isentropic and the flows are potential and adiabatic at the mach numbers on the interval 1 ma 2 2 this relation is independent of the shock angle and for any one shock wave a given ratio of pressure p 2 k 0 p 1 k 0 corresponds to a single ratio of density ρ 2 ρ 1 and it is shown in fig 14 it is not difficult to get from fig 14 that when the value of p 2 k 0 p 1 k 0 approaches to 1 the ratio of density ρ 2 ρ 1 is also close to 1 which indicates that the shock intensity is sufficiently small and the shock can be treated as weak shock having low compressibility effects meanwhile as the value of p 2 k 0 p 1 k 0 approaches to the shock intensity is infinite and the ratio of density ρ 2 ρ 1 has an asymptotic value of 4 3 which is much less than that value of 6 in air as supplement fig 14 also shows quantitative comparison of the theoretical results with the numerical simulation results in supersonic flow given in table 2 three mach numbers are chosen as comparison on the interval 1 ma 2 2 it can be observed in table 2 that although the pressure ratio increases by 17 5 times from the mach number 1 12 to 1 68 the density ratio rises by only 8 5 the comparison shows that the numerical results are in good agreement with the results derived in theory for average error less than 3 overall the expression 3 11 can be used to predict the relation of the flow parameters before and behind the shock wave with reasonable accuracy on the interval 1 ma 2 2 4 conclusions in this study the high speed compressible supercavitating flows is investigated with numerical and theoretical method the primary findings include 1 results are shown for high subsonic and transonic projectiles there is a general agreement between the predicted cavity profiles and the experimental data meanwhile the comparison shows the predicted shape and standoff distance of the shock wave are in good agreement with experimental results which indicate the shock wave can be predicted with reasonable accuracy 2 with the increase of mach number pressure wave evolves from disturbance wave into a detached bow shock in front of the cavitator which leads to dramatic increase of pressure around the surface of the projectile the increased pressure restrains the cavitation evolution and cause the reduction of radial dimension of the front cavity following the reducing trend of the radial dimension cavity closure finally occurs at one position of the projectile surface and the closure position also moves forward with the increasing free stream mach number however the cavity dimension in wake seems fairly similar furthermore a relatively weak shock appears at the cavity closure position and the intensity of the bow shock in front of the cavitator increases visibly for a significant reduction of the standoff distance and shock angle 3 an expression is proposed to analyze the flow parameters before and behind the shock wave and the relationship between pressure and density across the shock wave is also investigated the assumption is considered that the shock in water is isentropic and the flows are potential and adiabatic at the mach numbers on the interval 1 ma 2 2 this relation is independent of shock angle and for any kind of shock and a single ratio of density can be calculated by a given ratio of pressure when the value of p 2 k 0 p 1 k 0 approaches to the shock intensity is infinite and the ratio of density ρ 2 ρ 1 has an asymptotic value of 4 3 which is much less than that value of 6 in air thus the study has demonstrated that the numerical and theory methods are reasonable and reliable tools for understanding the cavitation dynamics in high speed compressible flows the authors will further modify the cavitation model with temperature adjusted tait equation to improve the numerical methods as well as demonstrate the applicability of the numerical methods for predicting the cavitating flows in other compressible fields water entry and multiphase shock wave tube et al in our future work besides the simple heuristic models together with integral conservation laws sbt models based on maem and nonlinear numerical calculation methods will be employed to investigate the supercavitation for both incompressible and compressible fluid in subsonic transonic and supersonic flows serebryakov 2001 2006 serebryakov et al 2009 additional experimental and numerical studies are also needed to improve the understanding of the unsteady supercavitating flows in high speed compressible flows acknowledgment the authors gratefully acknowledge support by the national science foundation of china nsfc grant nos 91752105 and 51679005 national natural science foundation of beijing grant no 3172029 the authors also appreciated the funding support from chinese advanced research of equipment fund 61402070401 and 61402070501 
