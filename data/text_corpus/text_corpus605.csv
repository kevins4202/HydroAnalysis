index,text
3025,the occurrence of groundwater drought is closely linked to the meteorological input but also to the surface and subsurface properties which function as lagging filter for the input signal knowledge about the potential occurrence of groundwater droughts is relevant for existing and future groundwater users particularly in regions where climate change is expected to extend or increase the number of dry periods this study proposes a method to quantify the groundwater memory as basis for characterising the intrinsic susceptibility of groundwater to drought the memory of groundwater was estimated using a sliding window autocorrelation function applied on 114 groundwater level time series a random forest regressor then modelled the groundwater memory across ireland using national digital maps as input files the key variables explaining groundwater memory are the relative and absolute surface topography and a thick overburden 10 m accordingly the lowest memory appears in elevated areas with overburden thicknesses of 10 m and vice versa areas of low moderate and high groundwater memory relate to high moderate and low groundwater drought susceptibility the uncertainty of the results is lowest in areas of low memory and highest in areas of high memory presumably related to the distribution of the observations the results are considered relevant in the context of water resources planning across sectors agriculture industry domestic particularly in the context of climate change adaptation keywords hydrogeology time series analysis machine learning random forest numerical modelling data availability current groundwater level time series and input variables of the models can be freely downloaded on the web unpublished historic groundwater level time are available upon request to the geological survey ireland all code for carrying out the analysis is available upon request from the corresponding author 1 introduction different types of droughts exist such as meteorological agricultural soil moisture or hydrological droughts kchouk et al 2021 van loon 2015 which reflect drier than average conditions there is no one size fits all definition of drought wmo and gwp 2016 and there are numerous indices to quantify droughts kchouk et al 2021 atmospheric processes are the origin of any drought van loon 2015 mckee 1993 defined a meteorological drought magnitude by fitting a gamma function to the accumulated rainfall and establishing a the probability relationship to then assessing the probability of an observation and the deviation for an inverse normal distribution function with a mean of zero and standard deviation of unity i e the standardised precipitation index spi meteorological drought drives hydrological drought which describes a lack of water in the hydrological system van loon 2015 for assessing a particular type of hydrological drought namely groundwater drought bloomfield and marchant 2013 converted the spi into the standardised groundwater index sgi using a non parametric normal scores transform of monthly groundwater level data ranking the observations by applying the inverse normal cumulative distribution function to the probability of an observation currently the sgi is perhaps one of the most used indices for assessing groundwater drought the meteorological signal precipitation propagates drought through the elements of the hydrological cycle eltahir and yeh 1999 and their storages and memories van loon 2015 van loon and laaha 2015 to delay the aquifer response schreiner mcgraw and ajami 2021 surface topography i e the absolute elevation of catchments plays a major role in propagating droughts which is linked to temperature and potentially snow storage van loon and laaha 2015 or hillslope catchment hydrology hellwig et al 2020 in the unsaturated zone peat soil moisture soil storage and vegetation cover affect and lag the groundwater level response in the aquifer and consequently the occurrence of groundwater drought han et al 2019 van loon 2015 in the saturated zone hydraulic aquifer properties related to groundwater flow e g hydraulic conductivity and aquifer storage e g specific yield are important stores affecting drought bloomfield and marchant 2013 hellwig et al 2020 low storage or fast responding aquifers such as karst and fractured bedrock aquifers are sensitive towards drought stoelzle et al 2014 van lanen et al 2013 while high storage or slower responding aquifers of porous media are less sensitive to drought occurrences stoelzle et al 2014 the speed of propagation of meteorological drought to groundwater drought can further vary between seasons han et al 2019 van loon and laaha 2015 as a result the correlation between the meteorological drought and groundwater drought may be complex and potentially vary in space and according to different accumulation periods kumar et al 2016 hence the variability of climate geology and hydrogeology results in geographically distinct relationships between meteorological drought and groundwater drought which may therefore require the analysis on different e g sub regional scales bloomfield et al 2015 haas and birk 2017 linking the sgi for hydrogeological analyses including surface and subsurface properties over a defined space is challenging for at least two reasons firstly relatively long and continuous time series of at least 30 years are required mckee et al 1993 which should cover a coherent period across all time series and the entire geographical reference space in order to be comparable and secondly the e g hourly or daily raw hydrological data contain valuable information in the time and frequency domain linked to aquifer properties heudorfer et al 2019 schuler et al 2020b and to the geographical scale giese et al 2020 which are lost by transformation into a monthly index knowledge about the susceptibility of groundwater to drought may be beneficial for integrated drought management mwo and gwp 2014 and is a reason to include groundwater as a resource in such guidelines hence the purpose of this paper is to answer the question how susceptible is groundwater to the occurrence of drought considering only the intrinsic surface and subsurface properties because of the two constraints related to the sgi mentioned above long and coherent time series and information loss as a result of indexing the proposed method uses groundwater level time series and their memory as proxy for the effective porosity which in turn may serve towards understanding the susceptibility of groundwater to drought while groundwater memory describes the regulating power of the subsurface on the groundwater dynamics mangin 1984 a highly regulated subsurface corresponds to slow dynamics and higher persistence of a time series and vice versa groundwater hydrographs are the result of the contribution of different water stores within the subsurface atkinson 1977 kovács et al 2015 powers and shevenell 2000 shevenell 1996 fluctuating groundwater levels hydrographs form rising limbs during and after recharge and falling limbs after cessation of recharge during the recession the shape of the hydrograph including the response to recharge is largely controlled by the effective porosity storage which also describes the loss of memory of the system the higher the storage the higher the memory and the more linear an associated groundwater level time series and vice versa mangin 1984 padilla and pulido bosch 1995 stoelzle et al 2014 different approaches regionalise the location based information in space in some instances conclusions can be drawn related to an upstream area of a catchment or aquifer when regionalisation approaches may include clustering and hydrological model calibration or distance based analyses based on the assumption that hydrological systems with similar physical characteristics show a similar hydrological behaviour he et al 2011 pagliero et al 2019 depending on the sample size sampling design and data properties the underlying data may be regionalised using geostatistical non geostatistical or combined methods li and heap 2011 supervised machine learning techniques including random forests rf breiman 2001 ho 1995 are very powerful methods that use training data independent variables for the prediction of dependent nonlinear environmental phenomena shen 2018 in space including lithology harris and grunsky 2015 soil series chaney et al 2016 or root zone soil moisture carranza et al 2021 ecological variables such as macroinvertebrates in streams fox et al 2020 plant species evans et al 2011 or the location of groundwater dependent terrestrial ecosystems hoyos et al 2015 hydrogeological variables such as fluoride concentrations in groundwater rosecrans et al 2022 groundwater recharge martinsen et al 2022 short term groundwater level fluctuations wang et al 2018 or the depth to the water table koch et al 2019 or climate variables such as the monthly spi for drought forecasting chen et al 2012 rfs use randomised classification and regression trees carts and bootstrap aggregation bagging to serve two purposes prediction the value of the dependent variable and inference tyralis et al 2019 for example the relative significance of the independent variables explains the dependent variable and therefore improves the interpretability of the results koch et al 2019 the two major variable importance metrics vims are the mean decrease impurity impurity based feature importance and the mean decrease accuracy mda breiman 2001 or permutation vim this study quantifies the groundwater memory for understanding the susceptibility of groundwater to drought on a national scale to then model this memory using a rf regressor and environmental variables by doing so the model provides information on the environmental variables that explain the memory although with limited certainty drobnič et al 2020 an understanding of the spatial variation of drought susceptibility of groundwater is considered crucial with regards to climate change adaptation that considers groundwater resources and their sensitivity to stress drought for sectors including water utilities planning and forecasting of resources availability industry using groundwater for cooling or processing agriculture using groundwater for irrigation or for the identification of habitats and ecosystems considered crucial for protection in the future 2 material and methods 2 1 study area the republic of ireland covers 69 797 km2 which corresponds to 83 of the area of the island of ireland the average elevation on land is 108 m above sea level m asl and it ranges between sea level and 1 039 m asl at its highest point at carrauntoohil in the southwest of the republic the topography is generally low lying approximately 61 of the republic lies below 100 m asl and 25 below 50 m asl the atlantic ocean and the irish sea influence the maritime and seasonal climate on the island the mean annual temperature 1981 2010 generally ranges between 9 c and 10 c with higher records 12 c along the coast the highest and lowest mean temperatures occur in july and january respectively the mean annual rainfall 1981 2010 ranges between 3 600 mm in the west and 600 800 mm in the east of the isle with an average of 1 230 mm the highest mean rainfall occurs between october and january with approx 130 mm per month while the lowest mean rainfall occurs between april and july with approx 80 mm per month walsh 2012 seasonal variation is projected to increase until the period 2041 2060 notably by decreasing spring and summer precipitation up to 17 projected decline and increasing numbers of extended dry periods nolan and flanagan 2020 since 1900 the documented mean annual air temperature has increased by approx 0 078 c per decade cámaro and dwyer 2021 and it is expected to increase by 1 to 1 6 c including increasing number of heatwave events by the middle of the 21st century nolan and flanagan 2020 the bedrock geology of the republic of ireland comprises precambrian metamorphic schist gneiss and quartzite ordovician to devonian granite tertiary granite and gabbro and overlying younger sedimentary rocks including ordovician and silurian sandstone and shale and lower carboniferous limestone and subordinate sandstones and shales and upper carboniferous sandstones and shales gsi 2015 the carboniferous limestones underlie almost half of the republic of ireland and of these about half are significantly karstified drew 2008 the present day bedrock topographic surface and overlying holocene glacio fluvial sediments are reminders of the geomorphological processes that have shaped the surface and subsurface since the last glacial maximum of the british irish ice sheet 25 ka ago and its deglaciation in ireland 19 ka ago hughes et al 2016 peters et al 2015 there are almost 200 quaternary porous sands and gravel aquifers identified to date gsi 2018a with relatively high transmissivities of approx 36 to 350 m2 d and specific yields in the order of 0 1 to 0 19 in contrast the capacity of the bedrock to store and facilitate flow of groundwater is significantly reduced given its generally low primary and secondary porosity with reported specific yields in the order of 0 011 to 0 017 and typical transmissivities in the order of 1 2 to 70 m2 d kelly et al 2015 the highest bedrock transmissivities relate to karstified limestones that contain tertiary solutionally enlarged porosity and permeability 2 2 data sets the data used comprises historic and current groundwater level observations and digital maps both covering the republic of ireland 2 2 1 groundwater level records groundwater level records include a historic unpublished records originating from the geological survey ireland gsi or local authorities and b current published records originating from local authorities or the irish environmental protection agency epa available at the epa hydronet website https epawebapp epa ie hydronet hydronet includes time series of 129 currently active and 233 currently inactive groundwater monitoring wells in addition gsi archives provided a further 56 time series of monitoring wells these time series were recorded digitally using automated sensors or analogue using drum charts before being digitised hence the suite of available time series comprises 418 monitoring wells fig 1 a shows the locations of the monitoring wells used for modelling in this study 2 2 2 digital maps digital maps include a 25 m resolution european digital elevation model eu dem version 1 1 consistent with eu hydro public beta and with a vertical accuracy of 7 m rmse eea 2016 the relative catchment topography i e the height above the nearest drainage hand was developed by topographically normalising the dem for the drainage network the dataset represents the topographic difference between a pixel and the hydrologically determined nearest water course nobre et al 2011 rennó et al 2008 the selection of publicly available vectorised maps was constrained by the criteria that each of the attributes of every map must coincide with the coordinates of at least one monitoring well otherwise the prediction of the lag time would not be meaningful in geographical areas covered by attributes not used during calibration of the model hence maps of which their attributes do not all appear in the calibration set such as subsoil types lithology or corine landuse eea 2018 were not included the maps considered comprise the following i aquifer types describing the resource potential regionally or locally important or poor and groundwater flow type and attenuation potential through fissures karst conduits or intergranular delg epa gsi 1999 gsi 2018a ii subsoil permeability classifying how easy water can infiltrate subsoils downwards at any point in the land surface as high moderate or low gsi 2018b iii quaternary sediments within 1 m of the surface gsi 2021a iv depth to bedrock gsi 2019 based on lithological logs and field mapping and interpretation considering rock outcrops topography and geomorphology v groundwater vulnerability to contaminants released at depths of 1 2 m below the ground surface based on the type and thicknesses of subsoils sands gravels glacial tills peat lake and alluvial silts and clays and the presence of karst features and classed as x karst e extreme h high m moderate and l low delg epa gsi 1999 gsi 2019 vi mean annual groundwater recharge or recharge rate based on mean annual effective rainfall groundwater vulnerability subsoil type and permeability soil drainage aquifer types gsi 2021b hunter williams et al 2013 vii peat describing the presence or absence of peat gsi 2021b fig 2b h show the geographical extent of the independent variables used for the final rf algorithm in this study 2 3 workflow fig 2 summarises the workflow for assessing the countrywide groundwater memory as outlined below the workflow commences with preparation and processing of the groundwater level records and the digital maps a followed by time series analysis to quantify the memory b in the next step a supervised rf regressor algorithm is trained to predict the dependent variable memory using the most suitable set of independent variables topographic and hydrogeological spatial information for 300 model runs c performance indicators then assess the quality of each set of models and the importance of the independent variables d to iteratively modify and improve the setup of the algorithm c finally the best scoring model was maintained for predicting and evaluating the memory across ireland as raster e spatial analyses and map production were carried out in qgis qgis development team 2022 while data processing time series analysis and rf modelling were undertaken using the programming language python and the development environment spyder raybaut 2009 2 3 1 data preparation and processing 2 3 1 1 groundwater level records the initial groundwater level data comprised 418 time series of individual locations consisting of historical ceased monitoring and present day records ongoing monitoring the data were cleaned and processed using the following steps where necessary 1 aggregating sub daily records to a daily time step 2 filtering out data unrelated to the main part of an aquifer i e time series related to the subsoil or the weathered top of the aquifer transition zone 3 filtering out erroneous sensor readings 4 filtering out periods of data affected by obvious human influences pumping etc or individual sudden head drops or plateaux indicating misplacement of the logger below or above the maximum or minimum water level in a well see supplementary information for a detailed list of wells used and 5 filtering out locations with 1 460 observations i e summing up to at least four years of data in addition four time series of karstified conduit dominated groundwater levels of 1 460 observations were included in the analysis given the very flashy nature and representativeness of shorter length of such data after this process 114 time series of daily time step remained available for analysis and modelling 2 3 1 2 digital maps all raster and vector data were downloaded and catalogued and resampled to a resolution of 100 m covering the same extent and spatial resolution arrays with the dimension 4 900 3 600 2 3 2 time series analysis the autocorrelation function acf describes the strength of linearity of a time series which is the tendency for a record magnitude to be dependent on a record magnitude of the previous time step s also described as persistence machiwal and jha 2006 groundwater level autocorrelations can be explicitly linked to aquifer storage bloomfield and marchant 2013 and even reveal multiple aquifer storages related to aquifer heterogeneity jemcov and petrič 2010 mangin 1975 massei et al 2006 padilla and pulido bosch 1995 schuler et al 2020b in general the higher the effective porosity within an aquifer the higher the persistence of the aquifer s groundwater levels accordingly time series with higher persistence are considered to be less susceptible to meteorological drought than time series with lower persistence therefore the memory expressed by the acf is used as a proxy for groundwater storage duy et al 2021 and further may serve the understanding of drought susceptibility the acf represents a stochastic process that is stationary where a finite time series with n observations has the autocorrelation r k at the lag k box and jenkins 1976 r k c k c 0 with the acf c k 1 n t 1 n k z t z z t k z k 0 1 2 and the variance function c 0 t 1 n z t z 2 n with the mean z given its wide application the cut off values for r k 0 2 mangin 1984 padilla and pulido bosch 1995 was considered most suitable in the context in this study and it was found to be best reproducible by any of the algorithms applied in this study a representative groundwater memory for each site was calculated considering a 4 year window that slide along the time series with intervals of 30 days using the python module statsmodels seabold and perktold 2010 resulting in a distribution of acf values for each site for each window a memory was defined as the first k when r 0 2 quantile 0 5 was considered as the representative value and the stability of the acf was evaluated by computing the difference between quantile 0 84 and quantile 0 16 a range of values including 68 of the results the stability analysis showed that 68 of the sites showed differences smaller than 20 days and that 95 of the showed with differences smaller than 53 days considering the percentage of error in relation to the representative acf value the differences were smaller than 28 and 60 respectively this approach reduces the impact of potential irregular anomalies within the time series that could affect the characterization of the groundwater memory for each site 2 3 3 random forest modelling a rf is a predictor and classifier consisting of a collection of m number of different and randomised regression trees combined to form a finite forest estimate generally the higher the value of m the better the predictions biau and scornet 2016 randomisation reduces the correlation between the trees and therefore also the variance of the predictions tyralis et al 2019 the rf classifier is widely used as it is robust against overfitting it excels in the context of large scale data and where the number of variables is much larger than the number of observations yet the reason for these strengths are not fully understood biau and scornet 2016 breiman 2001 the rf algorithm is a classifier consisting of a collection of tree structured classifiers breiman 2001 each tree is based on a randomised sub sets of training data using a bootstrap aggregating bagging and b random feature selection i e classification and regression trees cart split criterion breiman et al 1984 bagging is an ensemble technique that generates unique bootstrap samples from the original data set to construct a predictor from each sample biau and scornet 2016 usually bagging excludes approximately 1 3 36 8 of the training data breiman 2001 prior to the tree building the remainder share out of bag oob component is used to quantify the oob score or error that allows testing in order to only provide numerical data the attributes of all categorical independent variables were transformed into numerical values using one hot encoding pedregosa et al 2011 the process of finding the optimal and most efficient algorithm in terms of input variables model evaluation parameters was carried out in the following order 1 setting the number of decision trees relatively low with n 100 with trees being fully expanded not pruned 2 using all available one hot encoded independent variables as input 3 define randomised split proportion of training and testing data set 4 run model 300 times and write results of each model run including performance metrics into a table and 5 assess the performance metrics histograms and vims of each model run and select the best one to be used for regionalisation with the focus on maintaining modelling performance the above outlined process was iteratively modified by 1 reducing the number of variables to keep only relevant ones 2 increasing the number of decision trees until no improvement was detected boulesteix et al 2012 and 3 reducing the number of model runs the entire data was randomly split into a calibration and validation set the calibration data for developing the algorithm during training and testing calibration comprised 80 of the entire data 20 remained for independent validation the data for validation showed a similar distribution as the data for calibration finally due to the randomness of each model run induced by bagging and cart the selected model was re run 100 times to generate means of the predictions and their performance metrics and vims presented in the results section rf modelling was carried out using the python module scikit learn 1 0 2 pedregosa et al 2011 2 3 3 1 model validation the algorithm of each model run was evaluated using the following performance and quality metrics applied on the testing i ii and validation iii to vii data sets i out of bag oob score ii stratified 3 fold cross validation iii skill score ss mse describing how much better the model performs than the average observations using the mean squared error mse murphy 1988 where ss 1 m s e z z m s e z z with the observed time lag z t at time t the mean of the observed lag z and the predicted lag z t note by using the mse metrics the ss mse is identical to the nash sutcliffe efficiency nse nash and sutcliffe 1970 iv mean absolute error mae d where mae t 1 n z t z t n with z t z t v accuracy where accuracy 100 m a p e mean absolute percentage error with mape 100 n t 1 n z t z t a t vi r 2 describing the proportion of the variance of the dependent variable explained by the independent variables and vii kling gupta efficiency kge gupta et al 2009 kling et al 2012 while the nse has been widely used in hydrology the more recent kge balances the three components of model errors of the average focussed nse or ss mse i e correlation bias ratio of variances or coefficients of variation in a more balanced way liu 2020 for each model run two vims assessed the variables importance a the mean decrease accuracy mda which averages the decrease over all trees of the gini index see for example biau and scornet 2016 in classification and the residual sum of squares in regression and b the mean decrease impurity which measures the mean decrease in accuracy in the oob sample by randomly permuting the predictor variable of interest permutation importance tyralis et al 2019 the choice of the right vim is subject to debate the mda may suffer from selection biases translated into a gini vim bias based on the experience that the rf model selects predictors with many categories or metric predictors more often in the tree building process than predictors with few categories boulesteix et al 2012 strobl et al 2007 in particular the combination of categorical data along with continuous data including a variable number of categories amongst the predictors as applied in this study vims are unreliable and may even be misleading strobl et al 2007 further collinearity reduces the validity of vims drobnič et al 2020 for each model run the 10 highest importance scores of both indices of 28 variables were reported in this study 2 3 4 random forest predicting in order to predict the dependant variable memory or lag time in days across the republic of ireland the code of the algorithm environment was edited to be applicable to spatial data using the geospatial data abstraction library gdal gdal ogr contributors 2022 because of the randomness of the algorithm an appropriate number of rasters of the dependent variable was created n 100 which were then aggregated to ensemble rasters using the mean and the interquartile range and range as means for spread and uncertainty assessment finally a water mask was applied to assign 0 values to all water surfaces the resolution of all rasters was 100 m 3 results 3 1 time series analysis the processing data correction and filtering of the initial 418 time series yielded 114 usable time series related to individual groundwater monitoring wells distributed across ireland fig 4 plots the histogram and its probability density function pdf of the window groundwater memory across ireland ranging between 45 and 154 d with a median and interquartile range iqr of 74 0 and 13 8 d respectively the histogram is slightly skewed to the right lag times 60 to 80 d dominate over the lag times at the lower end 45 to 60 d and tail 80 to 154 d fig 3 a and fig 3b compares the normalised groundwater levels for the lowest groundwater memory quantile 0 25 and highest groundwater memory quantile 0 75 respectively between 2015 and 2020 the period includes the historical drought of 2018 falzoi et al 2019 the blue lines show individual time series while the red line shows the average in general the two plots show distinct patterns range of levels the range is wider for the low memory a time series compared to the high memory time series b rising limb the rising limb for the low memory time series is composed of steeper steps but less constant than the high memories time series recessions the recessions are steeper for the low memory time series as opposed to flatter recessions of the high memory time series and starts early for the low memory time series after drought response in 2018 the low memory time series recover faster than the high memory time series accordingly fig 3a reflects the behaviour of low storage groundwater systems that are quickly responding to recharge and covering a wider range of extreme values fig 3b reflects the behaviour of high storage groundwater systems that respond more slowly to recharge while recessing much slower than compared to the systems related to low memory time series 3 2 random forest modelling the rf algorithm was set up to model the groundwater memory d as the dependent variable using a set of independent variables after initial training and testing the model was run using 1 hand 2 dem 3 subsoil permeability 4 groundwater recharge coefficient 5 peat 6 depth to bedrock and 7 groundwater vulnerability the seven independent variables account for 28 attributes which ultimately formed 28 variables via one hot encoding 2 continuous variables attributes and 26 categorical variables attributes table 1 summarises the parameters used for the algorithm 80 91 of all 114 samples were used for training and testing calibration while the remainder 23 was held out for validation the trees forming the forest were not pruned hence the maximum tree depth or the minimum sample number for splitting an internal node was not limited bagging used approx 2 3 63 2 of the training data for the construction of a tree while approximately 1 3 36 8 were excluded breiman 2001 increasing the number of trees from 100 improved the modelling performance a number of 700 was found to be a good compromise between performance of the model and the computation time fig 4 shows the slight skewness of the dependent variable 3 2 1 variable importance fig 5 plots the highest 10 scores of the gini importance a and permutation importance b for the variables and or attributes of variables both vims show that the digital elevation model dem the height above nearest drainage hand and the depth to bedrock dtb and its attribute 10 m are most determinant for describing the groundwater memory all other variables appear significantly less important fig 6 illustrate the relationship between the simulated memory and the three most important independent variables dem hand dtb fig 6 a and b show that high memories 115 d are limited to very low elevations 120 m asl below approx 100 d the memory seems to anti correlate with the elevations although the relationship is not coherent fig 6c shows that the classes of dtb between 1 and 5 10 m show very similar ranges and percentiles the lowest median groundwater memory relates to the lowest overburden thickness of 1 m in turn the class of the highest dtb 10 shows a significantly different range groundwater memories of 83 d are limited to an overburden thickness of 10 m 3 2 2 model performance the performance of the model distinguishes between training and testing calibration and validation in order to ensure an appropriate division of data fig 7 plots the probability histogram of lag times along with their probaility density distribution for the calibration and validation data sets both sets are positively skewed the pdfs of the calibration testing data and validation data appears very similar importantly the validation data covers a comparable range as the calibration data which is consiedred acceptable for model validation fig 8 plots the observed against the simulated lag times for the 114 available time series during testing and validation table 2 summarises the performance of the model during independent validation the test data shows a good fit between the observed and simulated groundwater memories the model captured 49 of the variance contained during training as illustrated by the out of bag oob score the accuracy during the 3 fold stratified cross validation ranges between 17 and 74 with a mean of 49 for comparison the prediction of the entire training data has an accurcay of 91 6 the data used for independent validation suggests that the model slightly overestimates the low memories further the predictions show a narrower range and a slightly smaller spread expressed by the interquantile range iqr the mae and the model accuracy is 6 3 d and 91 5 respectively the ss or nse kge and r2 are 0 66 0 74 and 0 94 respectively 3 3 random forest predicting the best performing rf algorithm configuration was applied to predicted 100 national scale groundwater memory rasters averaged to a final ensemble raster the predictions of the ensemble range between 56 7 and 146 9 d fig 9 a the predicted lag times are displayed as 25 50 and 75 percentiles between the minimum and maximum fig 9b shows the coefficient of variation cv while fig 9c shows the range of the estimated memory between 0 3 and 9 3 d in order to evaluate the representativity of the predictions fig 10 plots the histograms and the probaility density distribution of the 114 observed lag times and the predicted lag times across ireland both distributions are skewed to the left but the predicted lag times cover a smaller range than the observed lag times and underrepresents the shorter lag times however the centre of the distributions coincides very well with median values of 74 0 d 114 time series and 72 4 d simulated memory across ireland therefore the distribution of the predicted memory is considered to coincide with the distribution of the observed memories 3 4 uncertainty analysis the uncertainty of the predicted memories across ireland is assessed using the coefficient of variation cv of the 100 exported rasters based on the best performing algorithm fig 9b ranging between 0 001 and 0 015 the highest uncertainty appears to spatially correlate with the memory as well as the range in predictions fig 9c accordingly the lowest groundwater memory generally shows the highest uncertainty and range fig 11 a plots the spread of predictions for each raster cell iqr against the predicted memory the plot suggests an increasing iqr with increasing memory yet between a memory of 105 and 115 d and 130 d the iqr deviates from this relationship these ranges suggest higher certainty of the predictions the iqrs are smaller than the mae 6 3 d table 2 the differences between the maes and the uncertainty analysis may be due to factors not included in the process i e missing some data that could potentially in the future improve the performance of the model fig 11b and c plot the iqr against the absolute dem and relative hand topography respectively both plots show that the highest spread in predictions is limited to low elevation conversely the higher the elevation the lower the maximum of the iqr fig 11d shows a box whisker plot for the iqr grouped by the five classes of depth to bedrock the median iqr is lowest for 5 10 m depth to bedrock and highest for 10 m depth to bedrock iqrs 1 3 d are limited to 10 m depth to bedrock 4 discussion 4 1 purpose and application of the national groundwater memory the climate pattern across ireland is projected to change towards decreasing mean annual and seasonal spring and summer rainfall increasing number of wet 20 mm d and very wet 30 mm d days increasing mean annual and seasonal temperatures and increasing number of extended dry periods and droughts nolan and flanagan 2020 such changes in meteorology would reduce soil moisture storage in summer and autumn across ireland murphy and charlton 2006 alter recharge and hence provide the driver for increased durations and magnitudes of groundwater levels below normal i e groundwater droughts on a catchment scale the expected impacts of a changing climate are still associated with large uncertainties which requires a more profound understanding of catchment characteristics and related hydrological processes meresa et al 2021 at the same time the boundaries of catchments may differ depending on whether it focussed on surface process topographic boundaries vs subsurface processes hydrogeological boundaries given the heterogeneity and complexity of secondary porosity media and in particular solutionally enlarged porosities schuler et al 2018 schuler et al 2020b hence the proposed method is climate independent and compromising between existing topographic surface boundaries induced by hand and absence of hydrogeological subsurface catchment boundaries given the control of subsurface storage on the memory and occurrence of drought van lanen et al 2013 memory is conceptualised to serve understanding and assess the groundwater drought susceptibility faster responding systems short memory are more susceptible to groundwater drought than slower responding systems stoelzle et al 2014 van lanen et al 2013 hence the output of this study is considered to inform more detailed catchment based analyses of the susceptibility of groundwater systems to climate change related extreme events notably droughts the development of a spatially distributed groundwater memory model provides a decision support tool for practical climate change related adaptation measures this applies particularly to where groundwater demand is increasing wang et al 2016 and where climate change expresses particular pressures through drought potentially affecting to different degrees agricultural and irrigation demand fischer et al 2007 wang et al 2016 groundwater dependent terrestrial ecosystems van engelenburg et al 2018 industrial cooling requirements koch and vögele 2009 including data centres mytton 2021 or domestic demand in the context of population growth economic development and changing consumption patterns boretti and rosa 2019 managed aquifer recharge mar is an option for mitigating local discrepancies between supply and demand taylor et al 2013 although associated pollution loads may be significant levantesi et al 2010 and potentially requiring attenuation casanova et al 2016 the proposed method may support identifying relevant areas for mar acknowledging that the suitability of an application depends on various socio economic and hydrogeological parameters zheng et al 2021 4 2 context of lag times this study assessed the lag time k for the autocorrelation r to reach 0 2 i e the groundwater memory using a sliding window the results obtained ranged between 45 and 154 d previous studies reported groundwater memories matching this range 69 and 78 d within ireland schuler 2020 55 and 83 d in greece panagopoulos and lambrakis 2006 29 52 and 63 d in bulgaria padilla and pulido bosch 1995 and 4 15 and 60 d in france mangin 1984 all related to karst aquifers 95 to 137 d 3 1 to 4 5 months in australia duvert et al 2015 12 52 and 47 d in japan imagawa et al 2013 and 35 to 199 d for shallow aquifer units and 70 to 231 d for the deeper aquifer units in vietnam duy et al 2021 all related to porous aquifers for a confined aquifer tu et al 2017 found a memory of at least 500 d although these reported figures were established without a sliding window as applied in this study the numbers are comparable expect in the case of the confined aquifer and hence underline the plausibility of the results of this study 4 3 variable importance the information content of the vims have limited validity in particular in the case of mixed independent variables categorical and continuous data strobl et al 2007 further limitations arise where the input features show collinearity drobnič et al 2020 however conceptually the results of the vims are comprehendible the absolute dem and the relative catchment elevation hand are amongst the three most important variables that control the memory the latter normalizing the topography according to the local relative heights related to the topographic drainage network rennó et al 2008 because of their collinearity these two variables are discussed as topography in general and without distinguishing their importance previous studies have demonstrated the importance of topography in influencing groundwater levels in the context of a low lying 136 m asl study area outside of ireland nobre et al 2011 found strong correlation between the hand layer and soil water conditions corroborated by groundwater records concluding on the control of hand on hydrology in the context of an even more elevated topography arabameri et al 2021 and rahmati et al 2016 showed the strong control of the topography dem and or hand on groundwater and its potential using both machine learning approaches in another example of importance of the relative topography the multi order hydrologic position mohp belitz et al 2019 has demonstrated that the distance to hierarchical segments of streams orders is an important variable for e g predicting the depth to water using a rf approach in higher elevated areas groundwater levels have shown to respond most quickly to rainfall which translates into fastest drought propagation hellwig et al 2020 approx 61 of the republic of ireland is low lying 100 m asl where groundwater heads are usually shallow and within a few metres below the surface for non karst the shallow heads are often conceptualised to follow the surface topography archbold et al 2016 fitzsimons et al 2005 moe et al 2010 hence with regards to the irish hydrogeology and the model set up the high importance of the dem and hand layers appears plausible the depth to bedrock dtb when overburden is 10 m is the third variable amongst the three most important ones at least a fraction of this overburden functions as the unsaturated vadose zone which has shown to delay meteorological droughts and influence the number duration and intensity of groundwater droughts wossenyeleh et al 2020 this is plausible and can be linked to the protective function of the overburden in intrinsic groundwater vulnerability concepts aller et al 2002 vías et al 2006 accordingly the overburden and a part of the unsaturated zone mitigates or controls direct recharge from precipitation while at the same time sustaining recharge to the saturated zone during dry periods tooth and fairchild 2002 the overburden thickness dtb 10 m and absolute elevations are interpreted as the two most important variables while hand is for both vims the third most important variable hence the important variables explaining the lag times are very coherent and can be grouped into two classes i relative topography dem and hand may influence the lag time at a site according to the location upstream or downstream within a catchment higher elevated locations are conceptually more affected by recharge while lower elevated locations are more affected by the upstream groundwater flow hence the relative topography may be considered as the lateral dimension at a given location controlling the impact of lateral groundwater flow memory ii intrinsic subsurface properties the overburden thickness describes indirectly how the subsurface propagates the meteorological signal towards the aquifer hence the intrinsic subsurface properties may be considered as the vertical dimension at a given location controlling the impact of vertical recharge on the groundwater memory the simulated lag time fig 9a correlates well with the variable dem and dtb 10 m and partly with the variable hand fig 1b d in space the lowest groundwater memories appear in areas of low elevation and high overburden thickness classes of low 66 8 d moderate 66 8 84 2 d and high 84 2 d groundwater memory were defined using the 16th and 84th percentiles so that the moderate class represents 68 of the data displayed as density plots in fig 12 a c respectively the colour gradient from bright to dark shows the density of grid cells within 500 m for the ranges of a single cell groundwater memory prediction of the same corresponding class this allows coherent areas of low to high memories to become apparent permanent inland water bodies were not considered significant areas of low groundwater memory figure 13a appear in the east southwest and west within the centre of ireland areas of low groundwater memory are generally absent or limited in size if present high densities of moderate groundwater memory figure 13b are generally distributed across all ireland these high densities are only interrupted in localised areas by the low and high memories relatively large areas of high groundwater memory figure 13c appear in the centre and northern centre of ireland 4 4 model uncertainty fig 10 and fig 11 showed an almost linear relationship between the simulated memory and the uncertainty with exceptions the reason for this relationship may be related to relatively sparse data for 80 d of the estimated groundwater memory and the slight skewness of the probability histogram fig 4 however rfs tend to focus more on the prediction accuracy of the majority class which often results in poor accuracy for the minority classes chen et al 2004 hence the higher uncertainty at the upper end of the data is believed to be at least partly associated with sparse data further each model run produces distinct results driven by the cart and bagging operations as these are the only changing variants between each model run to date the role of the bootstrap in rfs is still poorly understood while the cart splitting strategy is strongly data dependent and its influence is difficult to determine biau and scornet 2016 while the higher groundwater memories are generally simulated with less certainty and accuracy the relative pattern of the simulated memories appears robust fig 8 accordingly using classed memories based on quantiles fig 12 appears perhaps more appropriate than only using the absolute values 5 applicability of methods and limitations the autocorrelation function assumes that the time series can be regarded as stochastic processes that are stationary time invariant box and jenkins 1976 the stationary approach is a limitation considering the time variant dynamics of rainfall recharge and groundwater hydrographs yet quantifying a memory k d where r 0 2 is commonly accepted and carried out in hydrogeological assessments see section 4 2 because significant parts of the groundwater level hydrograph can be linked to physical aquifer properties berkaloff 1966 kovács et al 2015 therefore while the input signal rainfall patterns and intensities and associated recharge may have changed over the course of decades or between years the intrinsic structure of the aquifer may be considered not to have changed over time e g due to physical changes in the subsurface accordingly the use of time series of different lengths potentially relating to different periods in time is considered acceptable further the sliding window autocorrelation functions mitigates effects resulting from time variant dynamics and potential irregular anomalies within the time series the rf is set up using 114 observations with seven independent classes 28 after hot encoding a comparable number of observations was used for example for predicting soil parameters using 120 sampling locations wiesmeier et al 2011 rahmati et al 2016 used 163 wells for predicting the groundwater potential using a rf model these are relatively small data sets and below the number of the amongst others servo n 167 and ozon n 330 data sets used by breimann 2001 there a smaller number of features causes the generalisation error and out of bag error to increase suggesting that larger data sets can produce more accurate results hence the relatively small number of observations in this study is a limitation for the accuracy of the modelling results nevertheless the application of rf in this study appears justified due its recognised accuracy and its ability to deal with small sample sizes biau and scornet 2016 in other areas or regions of the world with higher resolution groundwater monitoring networks the method proposed here may yield more accurate results further limitations arise from internal and external hydrological effects external effects describe nearby influences on the shape of the groundwater level hydrograph and hence its linearity examples include nearby pumping which can distort the hydrograph depending on the magnitude of influence mitigation measures may include removing the observed trend or affected frequency ranges by applying multi resolution analysis mra in the form of discrete wavelets labat et al 2000 schuler et al 2020b or removing the time series from the analysis in case of completely disturbed signals another important influence is the distance to water bodies such as rivers lakes and the sea in particular settings such as low lying karst tidal oscillations or streamflows have shown to control hydrographs charlier et al 2015 gill et al 2013 schuler et al 2020a in such instances the groundwater memory reflects to a large extent the memory of the impacting surface water and not the aquifer this study mitigated these effects by filtering out time series affected by external effects as well as by applying the sliding window autocorrelation function the latter removing any potential influences that may be present for only limited periods of time internal effects relate to the physical properties of the surface and subsurface the bedrock hydrogeology of ireland consists of fractured or karstified media with secondary and partly tertiary porosities and permeabilities however a groundwater monitoring well provides only a highly localised window into the aquifer which cannot fully represent the three dimensional aquifer heterogeneities hence individual time series must be considered specific for the well not for the aquifer as a result adjacent monitoring wells recording the water level at different depths may share the same attributes of the independent variables elevation dtb etc also due to the resolution of 100 m but yield different memories however the model will not be able to differentiate the different observed memories since the input independent variables have the same attributes in such instance 5 1 outlook a rf algorithm was developed using 114 locations time series and different validation procedures the model may be improved by the following activities i potentially further develop the method to include additional hydrological records such as runoff or spring discharge records and ii integrate additional groundwater level time series in the future to further enhance the calibration or validation additional time series of high memory e g above 85 d would reduce the sparsity and skewness of the distribution and may therefore reduce the uncertainty of the modelling results such data of high memory would most likely relate to areas of 10 m depth to bedrock and low topographic elevations the predicted memory across ireland serves understanding groundwater drought susceptibility accordingly fig 12a c shows areas of high moderate and low groundwater drought susceptibility the differences in groundwater memory and susceptibility to drought are linked to observed characteristics of groundwater hydrographs fig 3a and b while the groundwater memory provides a relative scale across ireland the approach has its limitations the unit lag time day that expresses the memory of the time series is abstract and it fails to provide a valid measure transferable to the physical impact of a drought upon a groundwater system therefore future research shall link the memory with quantifiable implications on water resources availability ideally related to discrete groundwater systems groundwater catchments equipped with monitoring wells and drained by discrete spring s could be ideal reference spaces to link the memory to for example intermediate and baseflow components of an aquifer lastly the mapped groundwater memory describes the intrinsic characteristics of the surface subsurface hence the actual occurrence frequencies and duration of groundwater drought depends also on the projected meteorological input therefore future research shall quantify the link between groundwater memory and drought susceptibility with climate projections to assess the probability and uncertainty of groundwater droughts 6 conclusions the study combines machine learning random forest rf modelling with time series analysis in a national hydrogeological framework to predict the memory of groundwater for understanding the intrinsic susceptibility of groundwater to drought the memory of observed groundwater level time series across the republic of ireland ranges between 45 and 154 d the rf regressor has demonstrated that it can successfully explain the variances of the independent variable during training bagging testing and independent validation the model slightly overestimates the very low groundwater memories however the model accurately classifies the relative pattern of estimated memories which is a significant performance therefore it is recommended to interpret the model output in quantile based classes of low moderate and high rather than using the absolute values this is plausible because the goal of the map is to inform on drought susceptibility which can be explained by memory classes rather than the entire range of absolute memories groundwater memory is related to the effective porosity aquifer storage lower memories are associated with higher groundwater susceptibility to drought and vice versa the lowest memory highest groundwater drought susceptibility appears in high elevated areas with overburden thicknesses of less than 10 m and in particular 1 m the highest memory lowest groundwater drought susceptibility is limited to very low elevated areas where the overburden thicknesses is 10 m there the uncertainty of the results is highest presumably either due to the sparse data in this class and or due to effect of the two randomisation processes cart and bagging the study demonstrates the applicability of using rfs for simulating the memory on a national scale the method is well applicable to countries or states that have relatively coherent spatial data sets further research is required to quantify the link between groundwater memory and physically based measures of drought susceptibility this is considered relevant given the expected increase in frequency and magnitude of droughts in the context of climate change however the mapped memory informs on areas where water users are expected to be more or less susceptible to drought and therefore stress for example areas of elevated memory are expected to be favourable for abstraction regimes that are less affected by meteorological droughts and therefore more reliable during dry periods on the other hand areas of low memory may benefit from increased measures to enhance the resilience to drought credit authorship contribution statement philip schuler conceptualization methodology software validation formal analysis data curation visualization writing original draft writing review editing joan campanyà conceptualization methodology software formal analysis writing review editing henning moe conceptualization writing review editing damien doherty data curation resources writing review editing natalya hunter williams writing review editing ted mccormack conceptualization software writing review editing project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was primarily carried out as part of the scientific project groundwater climate funded by geological survey ireland a division of the department of environment climate and communications decc we would like to acknowledge the financial support to j c from the geological survey ireland ref 2019 trp gw 001 the authors would like to gratefully acknowledge the assistance provided by geological survey ireland staff and project team members especially monika kabza ellen mullarkey oisín ó briain shane carey and monica lee we wish to thank the two anonymous reviewers for taking the time and spending the effort to provide very concise and critical remarks which helped to significantly improve the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128277 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3025,the occurrence of groundwater drought is closely linked to the meteorological input but also to the surface and subsurface properties which function as lagging filter for the input signal knowledge about the potential occurrence of groundwater droughts is relevant for existing and future groundwater users particularly in regions where climate change is expected to extend or increase the number of dry periods this study proposes a method to quantify the groundwater memory as basis for characterising the intrinsic susceptibility of groundwater to drought the memory of groundwater was estimated using a sliding window autocorrelation function applied on 114 groundwater level time series a random forest regressor then modelled the groundwater memory across ireland using national digital maps as input files the key variables explaining groundwater memory are the relative and absolute surface topography and a thick overburden 10 m accordingly the lowest memory appears in elevated areas with overburden thicknesses of 10 m and vice versa areas of low moderate and high groundwater memory relate to high moderate and low groundwater drought susceptibility the uncertainty of the results is lowest in areas of low memory and highest in areas of high memory presumably related to the distribution of the observations the results are considered relevant in the context of water resources planning across sectors agriculture industry domestic particularly in the context of climate change adaptation keywords hydrogeology time series analysis machine learning random forest numerical modelling data availability current groundwater level time series and input variables of the models can be freely downloaded on the web unpublished historic groundwater level time are available upon request to the geological survey ireland all code for carrying out the analysis is available upon request from the corresponding author 1 introduction different types of droughts exist such as meteorological agricultural soil moisture or hydrological droughts kchouk et al 2021 van loon 2015 which reflect drier than average conditions there is no one size fits all definition of drought wmo and gwp 2016 and there are numerous indices to quantify droughts kchouk et al 2021 atmospheric processes are the origin of any drought van loon 2015 mckee 1993 defined a meteorological drought magnitude by fitting a gamma function to the accumulated rainfall and establishing a the probability relationship to then assessing the probability of an observation and the deviation for an inverse normal distribution function with a mean of zero and standard deviation of unity i e the standardised precipitation index spi meteorological drought drives hydrological drought which describes a lack of water in the hydrological system van loon 2015 for assessing a particular type of hydrological drought namely groundwater drought bloomfield and marchant 2013 converted the spi into the standardised groundwater index sgi using a non parametric normal scores transform of monthly groundwater level data ranking the observations by applying the inverse normal cumulative distribution function to the probability of an observation currently the sgi is perhaps one of the most used indices for assessing groundwater drought the meteorological signal precipitation propagates drought through the elements of the hydrological cycle eltahir and yeh 1999 and their storages and memories van loon 2015 van loon and laaha 2015 to delay the aquifer response schreiner mcgraw and ajami 2021 surface topography i e the absolute elevation of catchments plays a major role in propagating droughts which is linked to temperature and potentially snow storage van loon and laaha 2015 or hillslope catchment hydrology hellwig et al 2020 in the unsaturated zone peat soil moisture soil storage and vegetation cover affect and lag the groundwater level response in the aquifer and consequently the occurrence of groundwater drought han et al 2019 van loon 2015 in the saturated zone hydraulic aquifer properties related to groundwater flow e g hydraulic conductivity and aquifer storage e g specific yield are important stores affecting drought bloomfield and marchant 2013 hellwig et al 2020 low storage or fast responding aquifers such as karst and fractured bedrock aquifers are sensitive towards drought stoelzle et al 2014 van lanen et al 2013 while high storage or slower responding aquifers of porous media are less sensitive to drought occurrences stoelzle et al 2014 the speed of propagation of meteorological drought to groundwater drought can further vary between seasons han et al 2019 van loon and laaha 2015 as a result the correlation between the meteorological drought and groundwater drought may be complex and potentially vary in space and according to different accumulation periods kumar et al 2016 hence the variability of climate geology and hydrogeology results in geographically distinct relationships between meteorological drought and groundwater drought which may therefore require the analysis on different e g sub regional scales bloomfield et al 2015 haas and birk 2017 linking the sgi for hydrogeological analyses including surface and subsurface properties over a defined space is challenging for at least two reasons firstly relatively long and continuous time series of at least 30 years are required mckee et al 1993 which should cover a coherent period across all time series and the entire geographical reference space in order to be comparable and secondly the e g hourly or daily raw hydrological data contain valuable information in the time and frequency domain linked to aquifer properties heudorfer et al 2019 schuler et al 2020b and to the geographical scale giese et al 2020 which are lost by transformation into a monthly index knowledge about the susceptibility of groundwater to drought may be beneficial for integrated drought management mwo and gwp 2014 and is a reason to include groundwater as a resource in such guidelines hence the purpose of this paper is to answer the question how susceptible is groundwater to the occurrence of drought considering only the intrinsic surface and subsurface properties because of the two constraints related to the sgi mentioned above long and coherent time series and information loss as a result of indexing the proposed method uses groundwater level time series and their memory as proxy for the effective porosity which in turn may serve towards understanding the susceptibility of groundwater to drought while groundwater memory describes the regulating power of the subsurface on the groundwater dynamics mangin 1984 a highly regulated subsurface corresponds to slow dynamics and higher persistence of a time series and vice versa groundwater hydrographs are the result of the contribution of different water stores within the subsurface atkinson 1977 kovács et al 2015 powers and shevenell 2000 shevenell 1996 fluctuating groundwater levels hydrographs form rising limbs during and after recharge and falling limbs after cessation of recharge during the recession the shape of the hydrograph including the response to recharge is largely controlled by the effective porosity storage which also describes the loss of memory of the system the higher the storage the higher the memory and the more linear an associated groundwater level time series and vice versa mangin 1984 padilla and pulido bosch 1995 stoelzle et al 2014 different approaches regionalise the location based information in space in some instances conclusions can be drawn related to an upstream area of a catchment or aquifer when regionalisation approaches may include clustering and hydrological model calibration or distance based analyses based on the assumption that hydrological systems with similar physical characteristics show a similar hydrological behaviour he et al 2011 pagliero et al 2019 depending on the sample size sampling design and data properties the underlying data may be regionalised using geostatistical non geostatistical or combined methods li and heap 2011 supervised machine learning techniques including random forests rf breiman 2001 ho 1995 are very powerful methods that use training data independent variables for the prediction of dependent nonlinear environmental phenomena shen 2018 in space including lithology harris and grunsky 2015 soil series chaney et al 2016 or root zone soil moisture carranza et al 2021 ecological variables such as macroinvertebrates in streams fox et al 2020 plant species evans et al 2011 or the location of groundwater dependent terrestrial ecosystems hoyos et al 2015 hydrogeological variables such as fluoride concentrations in groundwater rosecrans et al 2022 groundwater recharge martinsen et al 2022 short term groundwater level fluctuations wang et al 2018 or the depth to the water table koch et al 2019 or climate variables such as the monthly spi for drought forecasting chen et al 2012 rfs use randomised classification and regression trees carts and bootstrap aggregation bagging to serve two purposes prediction the value of the dependent variable and inference tyralis et al 2019 for example the relative significance of the independent variables explains the dependent variable and therefore improves the interpretability of the results koch et al 2019 the two major variable importance metrics vims are the mean decrease impurity impurity based feature importance and the mean decrease accuracy mda breiman 2001 or permutation vim this study quantifies the groundwater memory for understanding the susceptibility of groundwater to drought on a national scale to then model this memory using a rf regressor and environmental variables by doing so the model provides information on the environmental variables that explain the memory although with limited certainty drobnič et al 2020 an understanding of the spatial variation of drought susceptibility of groundwater is considered crucial with regards to climate change adaptation that considers groundwater resources and their sensitivity to stress drought for sectors including water utilities planning and forecasting of resources availability industry using groundwater for cooling or processing agriculture using groundwater for irrigation or for the identification of habitats and ecosystems considered crucial for protection in the future 2 material and methods 2 1 study area the republic of ireland covers 69 797 km2 which corresponds to 83 of the area of the island of ireland the average elevation on land is 108 m above sea level m asl and it ranges between sea level and 1 039 m asl at its highest point at carrauntoohil in the southwest of the republic the topography is generally low lying approximately 61 of the republic lies below 100 m asl and 25 below 50 m asl the atlantic ocean and the irish sea influence the maritime and seasonal climate on the island the mean annual temperature 1981 2010 generally ranges between 9 c and 10 c with higher records 12 c along the coast the highest and lowest mean temperatures occur in july and january respectively the mean annual rainfall 1981 2010 ranges between 3 600 mm in the west and 600 800 mm in the east of the isle with an average of 1 230 mm the highest mean rainfall occurs between october and january with approx 130 mm per month while the lowest mean rainfall occurs between april and july with approx 80 mm per month walsh 2012 seasonal variation is projected to increase until the period 2041 2060 notably by decreasing spring and summer precipitation up to 17 projected decline and increasing numbers of extended dry periods nolan and flanagan 2020 since 1900 the documented mean annual air temperature has increased by approx 0 078 c per decade cámaro and dwyer 2021 and it is expected to increase by 1 to 1 6 c including increasing number of heatwave events by the middle of the 21st century nolan and flanagan 2020 the bedrock geology of the republic of ireland comprises precambrian metamorphic schist gneiss and quartzite ordovician to devonian granite tertiary granite and gabbro and overlying younger sedimentary rocks including ordovician and silurian sandstone and shale and lower carboniferous limestone and subordinate sandstones and shales and upper carboniferous sandstones and shales gsi 2015 the carboniferous limestones underlie almost half of the republic of ireland and of these about half are significantly karstified drew 2008 the present day bedrock topographic surface and overlying holocene glacio fluvial sediments are reminders of the geomorphological processes that have shaped the surface and subsurface since the last glacial maximum of the british irish ice sheet 25 ka ago and its deglaciation in ireland 19 ka ago hughes et al 2016 peters et al 2015 there are almost 200 quaternary porous sands and gravel aquifers identified to date gsi 2018a with relatively high transmissivities of approx 36 to 350 m2 d and specific yields in the order of 0 1 to 0 19 in contrast the capacity of the bedrock to store and facilitate flow of groundwater is significantly reduced given its generally low primary and secondary porosity with reported specific yields in the order of 0 011 to 0 017 and typical transmissivities in the order of 1 2 to 70 m2 d kelly et al 2015 the highest bedrock transmissivities relate to karstified limestones that contain tertiary solutionally enlarged porosity and permeability 2 2 data sets the data used comprises historic and current groundwater level observations and digital maps both covering the republic of ireland 2 2 1 groundwater level records groundwater level records include a historic unpublished records originating from the geological survey ireland gsi or local authorities and b current published records originating from local authorities or the irish environmental protection agency epa available at the epa hydronet website https epawebapp epa ie hydronet hydronet includes time series of 129 currently active and 233 currently inactive groundwater monitoring wells in addition gsi archives provided a further 56 time series of monitoring wells these time series were recorded digitally using automated sensors or analogue using drum charts before being digitised hence the suite of available time series comprises 418 monitoring wells fig 1 a shows the locations of the monitoring wells used for modelling in this study 2 2 2 digital maps digital maps include a 25 m resolution european digital elevation model eu dem version 1 1 consistent with eu hydro public beta and with a vertical accuracy of 7 m rmse eea 2016 the relative catchment topography i e the height above the nearest drainage hand was developed by topographically normalising the dem for the drainage network the dataset represents the topographic difference between a pixel and the hydrologically determined nearest water course nobre et al 2011 rennó et al 2008 the selection of publicly available vectorised maps was constrained by the criteria that each of the attributes of every map must coincide with the coordinates of at least one monitoring well otherwise the prediction of the lag time would not be meaningful in geographical areas covered by attributes not used during calibration of the model hence maps of which their attributes do not all appear in the calibration set such as subsoil types lithology or corine landuse eea 2018 were not included the maps considered comprise the following i aquifer types describing the resource potential regionally or locally important or poor and groundwater flow type and attenuation potential through fissures karst conduits or intergranular delg epa gsi 1999 gsi 2018a ii subsoil permeability classifying how easy water can infiltrate subsoils downwards at any point in the land surface as high moderate or low gsi 2018b iii quaternary sediments within 1 m of the surface gsi 2021a iv depth to bedrock gsi 2019 based on lithological logs and field mapping and interpretation considering rock outcrops topography and geomorphology v groundwater vulnerability to contaminants released at depths of 1 2 m below the ground surface based on the type and thicknesses of subsoils sands gravels glacial tills peat lake and alluvial silts and clays and the presence of karst features and classed as x karst e extreme h high m moderate and l low delg epa gsi 1999 gsi 2019 vi mean annual groundwater recharge or recharge rate based on mean annual effective rainfall groundwater vulnerability subsoil type and permeability soil drainage aquifer types gsi 2021b hunter williams et al 2013 vii peat describing the presence or absence of peat gsi 2021b fig 2b h show the geographical extent of the independent variables used for the final rf algorithm in this study 2 3 workflow fig 2 summarises the workflow for assessing the countrywide groundwater memory as outlined below the workflow commences with preparation and processing of the groundwater level records and the digital maps a followed by time series analysis to quantify the memory b in the next step a supervised rf regressor algorithm is trained to predict the dependent variable memory using the most suitable set of independent variables topographic and hydrogeological spatial information for 300 model runs c performance indicators then assess the quality of each set of models and the importance of the independent variables d to iteratively modify and improve the setup of the algorithm c finally the best scoring model was maintained for predicting and evaluating the memory across ireland as raster e spatial analyses and map production were carried out in qgis qgis development team 2022 while data processing time series analysis and rf modelling were undertaken using the programming language python and the development environment spyder raybaut 2009 2 3 1 data preparation and processing 2 3 1 1 groundwater level records the initial groundwater level data comprised 418 time series of individual locations consisting of historical ceased monitoring and present day records ongoing monitoring the data were cleaned and processed using the following steps where necessary 1 aggregating sub daily records to a daily time step 2 filtering out data unrelated to the main part of an aquifer i e time series related to the subsoil or the weathered top of the aquifer transition zone 3 filtering out erroneous sensor readings 4 filtering out periods of data affected by obvious human influences pumping etc or individual sudden head drops or plateaux indicating misplacement of the logger below or above the maximum or minimum water level in a well see supplementary information for a detailed list of wells used and 5 filtering out locations with 1 460 observations i e summing up to at least four years of data in addition four time series of karstified conduit dominated groundwater levels of 1 460 observations were included in the analysis given the very flashy nature and representativeness of shorter length of such data after this process 114 time series of daily time step remained available for analysis and modelling 2 3 1 2 digital maps all raster and vector data were downloaded and catalogued and resampled to a resolution of 100 m covering the same extent and spatial resolution arrays with the dimension 4 900 3 600 2 3 2 time series analysis the autocorrelation function acf describes the strength of linearity of a time series which is the tendency for a record magnitude to be dependent on a record magnitude of the previous time step s also described as persistence machiwal and jha 2006 groundwater level autocorrelations can be explicitly linked to aquifer storage bloomfield and marchant 2013 and even reveal multiple aquifer storages related to aquifer heterogeneity jemcov and petrič 2010 mangin 1975 massei et al 2006 padilla and pulido bosch 1995 schuler et al 2020b in general the higher the effective porosity within an aquifer the higher the persistence of the aquifer s groundwater levels accordingly time series with higher persistence are considered to be less susceptible to meteorological drought than time series with lower persistence therefore the memory expressed by the acf is used as a proxy for groundwater storage duy et al 2021 and further may serve the understanding of drought susceptibility the acf represents a stochastic process that is stationary where a finite time series with n observations has the autocorrelation r k at the lag k box and jenkins 1976 r k c k c 0 with the acf c k 1 n t 1 n k z t z z t k z k 0 1 2 and the variance function c 0 t 1 n z t z 2 n with the mean z given its wide application the cut off values for r k 0 2 mangin 1984 padilla and pulido bosch 1995 was considered most suitable in the context in this study and it was found to be best reproducible by any of the algorithms applied in this study a representative groundwater memory for each site was calculated considering a 4 year window that slide along the time series with intervals of 30 days using the python module statsmodels seabold and perktold 2010 resulting in a distribution of acf values for each site for each window a memory was defined as the first k when r 0 2 quantile 0 5 was considered as the representative value and the stability of the acf was evaluated by computing the difference between quantile 0 84 and quantile 0 16 a range of values including 68 of the results the stability analysis showed that 68 of the sites showed differences smaller than 20 days and that 95 of the showed with differences smaller than 53 days considering the percentage of error in relation to the representative acf value the differences were smaller than 28 and 60 respectively this approach reduces the impact of potential irregular anomalies within the time series that could affect the characterization of the groundwater memory for each site 2 3 3 random forest modelling a rf is a predictor and classifier consisting of a collection of m number of different and randomised regression trees combined to form a finite forest estimate generally the higher the value of m the better the predictions biau and scornet 2016 randomisation reduces the correlation between the trees and therefore also the variance of the predictions tyralis et al 2019 the rf classifier is widely used as it is robust against overfitting it excels in the context of large scale data and where the number of variables is much larger than the number of observations yet the reason for these strengths are not fully understood biau and scornet 2016 breiman 2001 the rf algorithm is a classifier consisting of a collection of tree structured classifiers breiman 2001 each tree is based on a randomised sub sets of training data using a bootstrap aggregating bagging and b random feature selection i e classification and regression trees cart split criterion breiman et al 1984 bagging is an ensemble technique that generates unique bootstrap samples from the original data set to construct a predictor from each sample biau and scornet 2016 usually bagging excludes approximately 1 3 36 8 of the training data breiman 2001 prior to the tree building the remainder share out of bag oob component is used to quantify the oob score or error that allows testing in order to only provide numerical data the attributes of all categorical independent variables were transformed into numerical values using one hot encoding pedregosa et al 2011 the process of finding the optimal and most efficient algorithm in terms of input variables model evaluation parameters was carried out in the following order 1 setting the number of decision trees relatively low with n 100 with trees being fully expanded not pruned 2 using all available one hot encoded independent variables as input 3 define randomised split proportion of training and testing data set 4 run model 300 times and write results of each model run including performance metrics into a table and 5 assess the performance metrics histograms and vims of each model run and select the best one to be used for regionalisation with the focus on maintaining modelling performance the above outlined process was iteratively modified by 1 reducing the number of variables to keep only relevant ones 2 increasing the number of decision trees until no improvement was detected boulesteix et al 2012 and 3 reducing the number of model runs the entire data was randomly split into a calibration and validation set the calibration data for developing the algorithm during training and testing calibration comprised 80 of the entire data 20 remained for independent validation the data for validation showed a similar distribution as the data for calibration finally due to the randomness of each model run induced by bagging and cart the selected model was re run 100 times to generate means of the predictions and their performance metrics and vims presented in the results section rf modelling was carried out using the python module scikit learn 1 0 2 pedregosa et al 2011 2 3 3 1 model validation the algorithm of each model run was evaluated using the following performance and quality metrics applied on the testing i ii and validation iii to vii data sets i out of bag oob score ii stratified 3 fold cross validation iii skill score ss mse describing how much better the model performs than the average observations using the mean squared error mse murphy 1988 where ss 1 m s e z z m s e z z with the observed time lag z t at time t the mean of the observed lag z and the predicted lag z t note by using the mse metrics the ss mse is identical to the nash sutcliffe efficiency nse nash and sutcliffe 1970 iv mean absolute error mae d where mae t 1 n z t z t n with z t z t v accuracy where accuracy 100 m a p e mean absolute percentage error with mape 100 n t 1 n z t z t a t vi r 2 describing the proportion of the variance of the dependent variable explained by the independent variables and vii kling gupta efficiency kge gupta et al 2009 kling et al 2012 while the nse has been widely used in hydrology the more recent kge balances the three components of model errors of the average focussed nse or ss mse i e correlation bias ratio of variances or coefficients of variation in a more balanced way liu 2020 for each model run two vims assessed the variables importance a the mean decrease accuracy mda which averages the decrease over all trees of the gini index see for example biau and scornet 2016 in classification and the residual sum of squares in regression and b the mean decrease impurity which measures the mean decrease in accuracy in the oob sample by randomly permuting the predictor variable of interest permutation importance tyralis et al 2019 the choice of the right vim is subject to debate the mda may suffer from selection biases translated into a gini vim bias based on the experience that the rf model selects predictors with many categories or metric predictors more often in the tree building process than predictors with few categories boulesteix et al 2012 strobl et al 2007 in particular the combination of categorical data along with continuous data including a variable number of categories amongst the predictors as applied in this study vims are unreliable and may even be misleading strobl et al 2007 further collinearity reduces the validity of vims drobnič et al 2020 for each model run the 10 highest importance scores of both indices of 28 variables were reported in this study 2 3 4 random forest predicting in order to predict the dependant variable memory or lag time in days across the republic of ireland the code of the algorithm environment was edited to be applicable to spatial data using the geospatial data abstraction library gdal gdal ogr contributors 2022 because of the randomness of the algorithm an appropriate number of rasters of the dependent variable was created n 100 which were then aggregated to ensemble rasters using the mean and the interquartile range and range as means for spread and uncertainty assessment finally a water mask was applied to assign 0 values to all water surfaces the resolution of all rasters was 100 m 3 results 3 1 time series analysis the processing data correction and filtering of the initial 418 time series yielded 114 usable time series related to individual groundwater monitoring wells distributed across ireland fig 4 plots the histogram and its probability density function pdf of the window groundwater memory across ireland ranging between 45 and 154 d with a median and interquartile range iqr of 74 0 and 13 8 d respectively the histogram is slightly skewed to the right lag times 60 to 80 d dominate over the lag times at the lower end 45 to 60 d and tail 80 to 154 d fig 3 a and fig 3b compares the normalised groundwater levels for the lowest groundwater memory quantile 0 25 and highest groundwater memory quantile 0 75 respectively between 2015 and 2020 the period includes the historical drought of 2018 falzoi et al 2019 the blue lines show individual time series while the red line shows the average in general the two plots show distinct patterns range of levels the range is wider for the low memory a time series compared to the high memory time series b rising limb the rising limb for the low memory time series is composed of steeper steps but less constant than the high memories time series recessions the recessions are steeper for the low memory time series as opposed to flatter recessions of the high memory time series and starts early for the low memory time series after drought response in 2018 the low memory time series recover faster than the high memory time series accordingly fig 3a reflects the behaviour of low storage groundwater systems that are quickly responding to recharge and covering a wider range of extreme values fig 3b reflects the behaviour of high storage groundwater systems that respond more slowly to recharge while recessing much slower than compared to the systems related to low memory time series 3 2 random forest modelling the rf algorithm was set up to model the groundwater memory d as the dependent variable using a set of independent variables after initial training and testing the model was run using 1 hand 2 dem 3 subsoil permeability 4 groundwater recharge coefficient 5 peat 6 depth to bedrock and 7 groundwater vulnerability the seven independent variables account for 28 attributes which ultimately formed 28 variables via one hot encoding 2 continuous variables attributes and 26 categorical variables attributes table 1 summarises the parameters used for the algorithm 80 91 of all 114 samples were used for training and testing calibration while the remainder 23 was held out for validation the trees forming the forest were not pruned hence the maximum tree depth or the minimum sample number for splitting an internal node was not limited bagging used approx 2 3 63 2 of the training data for the construction of a tree while approximately 1 3 36 8 were excluded breiman 2001 increasing the number of trees from 100 improved the modelling performance a number of 700 was found to be a good compromise between performance of the model and the computation time fig 4 shows the slight skewness of the dependent variable 3 2 1 variable importance fig 5 plots the highest 10 scores of the gini importance a and permutation importance b for the variables and or attributes of variables both vims show that the digital elevation model dem the height above nearest drainage hand and the depth to bedrock dtb and its attribute 10 m are most determinant for describing the groundwater memory all other variables appear significantly less important fig 6 illustrate the relationship between the simulated memory and the three most important independent variables dem hand dtb fig 6 a and b show that high memories 115 d are limited to very low elevations 120 m asl below approx 100 d the memory seems to anti correlate with the elevations although the relationship is not coherent fig 6c shows that the classes of dtb between 1 and 5 10 m show very similar ranges and percentiles the lowest median groundwater memory relates to the lowest overburden thickness of 1 m in turn the class of the highest dtb 10 shows a significantly different range groundwater memories of 83 d are limited to an overburden thickness of 10 m 3 2 2 model performance the performance of the model distinguishes between training and testing calibration and validation in order to ensure an appropriate division of data fig 7 plots the probability histogram of lag times along with their probaility density distribution for the calibration and validation data sets both sets are positively skewed the pdfs of the calibration testing data and validation data appears very similar importantly the validation data covers a comparable range as the calibration data which is consiedred acceptable for model validation fig 8 plots the observed against the simulated lag times for the 114 available time series during testing and validation table 2 summarises the performance of the model during independent validation the test data shows a good fit between the observed and simulated groundwater memories the model captured 49 of the variance contained during training as illustrated by the out of bag oob score the accuracy during the 3 fold stratified cross validation ranges between 17 and 74 with a mean of 49 for comparison the prediction of the entire training data has an accurcay of 91 6 the data used for independent validation suggests that the model slightly overestimates the low memories further the predictions show a narrower range and a slightly smaller spread expressed by the interquantile range iqr the mae and the model accuracy is 6 3 d and 91 5 respectively the ss or nse kge and r2 are 0 66 0 74 and 0 94 respectively 3 3 random forest predicting the best performing rf algorithm configuration was applied to predicted 100 national scale groundwater memory rasters averaged to a final ensemble raster the predictions of the ensemble range between 56 7 and 146 9 d fig 9 a the predicted lag times are displayed as 25 50 and 75 percentiles between the minimum and maximum fig 9b shows the coefficient of variation cv while fig 9c shows the range of the estimated memory between 0 3 and 9 3 d in order to evaluate the representativity of the predictions fig 10 plots the histograms and the probaility density distribution of the 114 observed lag times and the predicted lag times across ireland both distributions are skewed to the left but the predicted lag times cover a smaller range than the observed lag times and underrepresents the shorter lag times however the centre of the distributions coincides very well with median values of 74 0 d 114 time series and 72 4 d simulated memory across ireland therefore the distribution of the predicted memory is considered to coincide with the distribution of the observed memories 3 4 uncertainty analysis the uncertainty of the predicted memories across ireland is assessed using the coefficient of variation cv of the 100 exported rasters based on the best performing algorithm fig 9b ranging between 0 001 and 0 015 the highest uncertainty appears to spatially correlate with the memory as well as the range in predictions fig 9c accordingly the lowest groundwater memory generally shows the highest uncertainty and range fig 11 a plots the spread of predictions for each raster cell iqr against the predicted memory the plot suggests an increasing iqr with increasing memory yet between a memory of 105 and 115 d and 130 d the iqr deviates from this relationship these ranges suggest higher certainty of the predictions the iqrs are smaller than the mae 6 3 d table 2 the differences between the maes and the uncertainty analysis may be due to factors not included in the process i e missing some data that could potentially in the future improve the performance of the model fig 11b and c plot the iqr against the absolute dem and relative hand topography respectively both plots show that the highest spread in predictions is limited to low elevation conversely the higher the elevation the lower the maximum of the iqr fig 11d shows a box whisker plot for the iqr grouped by the five classes of depth to bedrock the median iqr is lowest for 5 10 m depth to bedrock and highest for 10 m depth to bedrock iqrs 1 3 d are limited to 10 m depth to bedrock 4 discussion 4 1 purpose and application of the national groundwater memory the climate pattern across ireland is projected to change towards decreasing mean annual and seasonal spring and summer rainfall increasing number of wet 20 mm d and very wet 30 mm d days increasing mean annual and seasonal temperatures and increasing number of extended dry periods and droughts nolan and flanagan 2020 such changes in meteorology would reduce soil moisture storage in summer and autumn across ireland murphy and charlton 2006 alter recharge and hence provide the driver for increased durations and magnitudes of groundwater levels below normal i e groundwater droughts on a catchment scale the expected impacts of a changing climate are still associated with large uncertainties which requires a more profound understanding of catchment characteristics and related hydrological processes meresa et al 2021 at the same time the boundaries of catchments may differ depending on whether it focussed on surface process topographic boundaries vs subsurface processes hydrogeological boundaries given the heterogeneity and complexity of secondary porosity media and in particular solutionally enlarged porosities schuler et al 2018 schuler et al 2020b hence the proposed method is climate independent and compromising between existing topographic surface boundaries induced by hand and absence of hydrogeological subsurface catchment boundaries given the control of subsurface storage on the memory and occurrence of drought van lanen et al 2013 memory is conceptualised to serve understanding and assess the groundwater drought susceptibility faster responding systems short memory are more susceptible to groundwater drought than slower responding systems stoelzle et al 2014 van lanen et al 2013 hence the output of this study is considered to inform more detailed catchment based analyses of the susceptibility of groundwater systems to climate change related extreme events notably droughts the development of a spatially distributed groundwater memory model provides a decision support tool for practical climate change related adaptation measures this applies particularly to where groundwater demand is increasing wang et al 2016 and where climate change expresses particular pressures through drought potentially affecting to different degrees agricultural and irrigation demand fischer et al 2007 wang et al 2016 groundwater dependent terrestrial ecosystems van engelenburg et al 2018 industrial cooling requirements koch and vögele 2009 including data centres mytton 2021 or domestic demand in the context of population growth economic development and changing consumption patterns boretti and rosa 2019 managed aquifer recharge mar is an option for mitigating local discrepancies between supply and demand taylor et al 2013 although associated pollution loads may be significant levantesi et al 2010 and potentially requiring attenuation casanova et al 2016 the proposed method may support identifying relevant areas for mar acknowledging that the suitability of an application depends on various socio economic and hydrogeological parameters zheng et al 2021 4 2 context of lag times this study assessed the lag time k for the autocorrelation r to reach 0 2 i e the groundwater memory using a sliding window the results obtained ranged between 45 and 154 d previous studies reported groundwater memories matching this range 69 and 78 d within ireland schuler 2020 55 and 83 d in greece panagopoulos and lambrakis 2006 29 52 and 63 d in bulgaria padilla and pulido bosch 1995 and 4 15 and 60 d in france mangin 1984 all related to karst aquifers 95 to 137 d 3 1 to 4 5 months in australia duvert et al 2015 12 52 and 47 d in japan imagawa et al 2013 and 35 to 199 d for shallow aquifer units and 70 to 231 d for the deeper aquifer units in vietnam duy et al 2021 all related to porous aquifers for a confined aquifer tu et al 2017 found a memory of at least 500 d although these reported figures were established without a sliding window as applied in this study the numbers are comparable expect in the case of the confined aquifer and hence underline the plausibility of the results of this study 4 3 variable importance the information content of the vims have limited validity in particular in the case of mixed independent variables categorical and continuous data strobl et al 2007 further limitations arise where the input features show collinearity drobnič et al 2020 however conceptually the results of the vims are comprehendible the absolute dem and the relative catchment elevation hand are amongst the three most important variables that control the memory the latter normalizing the topography according to the local relative heights related to the topographic drainage network rennó et al 2008 because of their collinearity these two variables are discussed as topography in general and without distinguishing their importance previous studies have demonstrated the importance of topography in influencing groundwater levels in the context of a low lying 136 m asl study area outside of ireland nobre et al 2011 found strong correlation between the hand layer and soil water conditions corroborated by groundwater records concluding on the control of hand on hydrology in the context of an even more elevated topography arabameri et al 2021 and rahmati et al 2016 showed the strong control of the topography dem and or hand on groundwater and its potential using both machine learning approaches in another example of importance of the relative topography the multi order hydrologic position mohp belitz et al 2019 has demonstrated that the distance to hierarchical segments of streams orders is an important variable for e g predicting the depth to water using a rf approach in higher elevated areas groundwater levels have shown to respond most quickly to rainfall which translates into fastest drought propagation hellwig et al 2020 approx 61 of the republic of ireland is low lying 100 m asl where groundwater heads are usually shallow and within a few metres below the surface for non karst the shallow heads are often conceptualised to follow the surface topography archbold et al 2016 fitzsimons et al 2005 moe et al 2010 hence with regards to the irish hydrogeology and the model set up the high importance of the dem and hand layers appears plausible the depth to bedrock dtb when overburden is 10 m is the third variable amongst the three most important ones at least a fraction of this overburden functions as the unsaturated vadose zone which has shown to delay meteorological droughts and influence the number duration and intensity of groundwater droughts wossenyeleh et al 2020 this is plausible and can be linked to the protective function of the overburden in intrinsic groundwater vulnerability concepts aller et al 2002 vías et al 2006 accordingly the overburden and a part of the unsaturated zone mitigates or controls direct recharge from precipitation while at the same time sustaining recharge to the saturated zone during dry periods tooth and fairchild 2002 the overburden thickness dtb 10 m and absolute elevations are interpreted as the two most important variables while hand is for both vims the third most important variable hence the important variables explaining the lag times are very coherent and can be grouped into two classes i relative topography dem and hand may influence the lag time at a site according to the location upstream or downstream within a catchment higher elevated locations are conceptually more affected by recharge while lower elevated locations are more affected by the upstream groundwater flow hence the relative topography may be considered as the lateral dimension at a given location controlling the impact of lateral groundwater flow memory ii intrinsic subsurface properties the overburden thickness describes indirectly how the subsurface propagates the meteorological signal towards the aquifer hence the intrinsic subsurface properties may be considered as the vertical dimension at a given location controlling the impact of vertical recharge on the groundwater memory the simulated lag time fig 9a correlates well with the variable dem and dtb 10 m and partly with the variable hand fig 1b d in space the lowest groundwater memories appear in areas of low elevation and high overburden thickness classes of low 66 8 d moderate 66 8 84 2 d and high 84 2 d groundwater memory were defined using the 16th and 84th percentiles so that the moderate class represents 68 of the data displayed as density plots in fig 12 a c respectively the colour gradient from bright to dark shows the density of grid cells within 500 m for the ranges of a single cell groundwater memory prediction of the same corresponding class this allows coherent areas of low to high memories to become apparent permanent inland water bodies were not considered significant areas of low groundwater memory figure 13a appear in the east southwest and west within the centre of ireland areas of low groundwater memory are generally absent or limited in size if present high densities of moderate groundwater memory figure 13b are generally distributed across all ireland these high densities are only interrupted in localised areas by the low and high memories relatively large areas of high groundwater memory figure 13c appear in the centre and northern centre of ireland 4 4 model uncertainty fig 10 and fig 11 showed an almost linear relationship between the simulated memory and the uncertainty with exceptions the reason for this relationship may be related to relatively sparse data for 80 d of the estimated groundwater memory and the slight skewness of the probability histogram fig 4 however rfs tend to focus more on the prediction accuracy of the majority class which often results in poor accuracy for the minority classes chen et al 2004 hence the higher uncertainty at the upper end of the data is believed to be at least partly associated with sparse data further each model run produces distinct results driven by the cart and bagging operations as these are the only changing variants between each model run to date the role of the bootstrap in rfs is still poorly understood while the cart splitting strategy is strongly data dependent and its influence is difficult to determine biau and scornet 2016 while the higher groundwater memories are generally simulated with less certainty and accuracy the relative pattern of the simulated memories appears robust fig 8 accordingly using classed memories based on quantiles fig 12 appears perhaps more appropriate than only using the absolute values 5 applicability of methods and limitations the autocorrelation function assumes that the time series can be regarded as stochastic processes that are stationary time invariant box and jenkins 1976 the stationary approach is a limitation considering the time variant dynamics of rainfall recharge and groundwater hydrographs yet quantifying a memory k d where r 0 2 is commonly accepted and carried out in hydrogeological assessments see section 4 2 because significant parts of the groundwater level hydrograph can be linked to physical aquifer properties berkaloff 1966 kovács et al 2015 therefore while the input signal rainfall patterns and intensities and associated recharge may have changed over the course of decades or between years the intrinsic structure of the aquifer may be considered not to have changed over time e g due to physical changes in the subsurface accordingly the use of time series of different lengths potentially relating to different periods in time is considered acceptable further the sliding window autocorrelation functions mitigates effects resulting from time variant dynamics and potential irregular anomalies within the time series the rf is set up using 114 observations with seven independent classes 28 after hot encoding a comparable number of observations was used for example for predicting soil parameters using 120 sampling locations wiesmeier et al 2011 rahmati et al 2016 used 163 wells for predicting the groundwater potential using a rf model these are relatively small data sets and below the number of the amongst others servo n 167 and ozon n 330 data sets used by breimann 2001 there a smaller number of features causes the generalisation error and out of bag error to increase suggesting that larger data sets can produce more accurate results hence the relatively small number of observations in this study is a limitation for the accuracy of the modelling results nevertheless the application of rf in this study appears justified due its recognised accuracy and its ability to deal with small sample sizes biau and scornet 2016 in other areas or regions of the world with higher resolution groundwater monitoring networks the method proposed here may yield more accurate results further limitations arise from internal and external hydrological effects external effects describe nearby influences on the shape of the groundwater level hydrograph and hence its linearity examples include nearby pumping which can distort the hydrograph depending on the magnitude of influence mitigation measures may include removing the observed trend or affected frequency ranges by applying multi resolution analysis mra in the form of discrete wavelets labat et al 2000 schuler et al 2020b or removing the time series from the analysis in case of completely disturbed signals another important influence is the distance to water bodies such as rivers lakes and the sea in particular settings such as low lying karst tidal oscillations or streamflows have shown to control hydrographs charlier et al 2015 gill et al 2013 schuler et al 2020a in such instances the groundwater memory reflects to a large extent the memory of the impacting surface water and not the aquifer this study mitigated these effects by filtering out time series affected by external effects as well as by applying the sliding window autocorrelation function the latter removing any potential influences that may be present for only limited periods of time internal effects relate to the physical properties of the surface and subsurface the bedrock hydrogeology of ireland consists of fractured or karstified media with secondary and partly tertiary porosities and permeabilities however a groundwater monitoring well provides only a highly localised window into the aquifer which cannot fully represent the three dimensional aquifer heterogeneities hence individual time series must be considered specific for the well not for the aquifer as a result adjacent monitoring wells recording the water level at different depths may share the same attributes of the independent variables elevation dtb etc also due to the resolution of 100 m but yield different memories however the model will not be able to differentiate the different observed memories since the input independent variables have the same attributes in such instance 5 1 outlook a rf algorithm was developed using 114 locations time series and different validation procedures the model may be improved by the following activities i potentially further develop the method to include additional hydrological records such as runoff or spring discharge records and ii integrate additional groundwater level time series in the future to further enhance the calibration or validation additional time series of high memory e g above 85 d would reduce the sparsity and skewness of the distribution and may therefore reduce the uncertainty of the modelling results such data of high memory would most likely relate to areas of 10 m depth to bedrock and low topographic elevations the predicted memory across ireland serves understanding groundwater drought susceptibility accordingly fig 12a c shows areas of high moderate and low groundwater drought susceptibility the differences in groundwater memory and susceptibility to drought are linked to observed characteristics of groundwater hydrographs fig 3a and b while the groundwater memory provides a relative scale across ireland the approach has its limitations the unit lag time day that expresses the memory of the time series is abstract and it fails to provide a valid measure transferable to the physical impact of a drought upon a groundwater system therefore future research shall link the memory with quantifiable implications on water resources availability ideally related to discrete groundwater systems groundwater catchments equipped with monitoring wells and drained by discrete spring s could be ideal reference spaces to link the memory to for example intermediate and baseflow components of an aquifer lastly the mapped groundwater memory describes the intrinsic characteristics of the surface subsurface hence the actual occurrence frequencies and duration of groundwater drought depends also on the projected meteorological input therefore future research shall quantify the link between groundwater memory and drought susceptibility with climate projections to assess the probability and uncertainty of groundwater droughts 6 conclusions the study combines machine learning random forest rf modelling with time series analysis in a national hydrogeological framework to predict the memory of groundwater for understanding the intrinsic susceptibility of groundwater to drought the memory of observed groundwater level time series across the republic of ireland ranges between 45 and 154 d the rf regressor has demonstrated that it can successfully explain the variances of the independent variable during training bagging testing and independent validation the model slightly overestimates the very low groundwater memories however the model accurately classifies the relative pattern of estimated memories which is a significant performance therefore it is recommended to interpret the model output in quantile based classes of low moderate and high rather than using the absolute values this is plausible because the goal of the map is to inform on drought susceptibility which can be explained by memory classes rather than the entire range of absolute memories groundwater memory is related to the effective porosity aquifer storage lower memories are associated with higher groundwater susceptibility to drought and vice versa the lowest memory highest groundwater drought susceptibility appears in high elevated areas with overburden thicknesses of less than 10 m and in particular 1 m the highest memory lowest groundwater drought susceptibility is limited to very low elevated areas where the overburden thicknesses is 10 m there the uncertainty of the results is highest presumably either due to the sparse data in this class and or due to effect of the two randomisation processes cart and bagging the study demonstrates the applicability of using rfs for simulating the memory on a national scale the method is well applicable to countries or states that have relatively coherent spatial data sets further research is required to quantify the link between groundwater memory and physically based measures of drought susceptibility this is considered relevant given the expected increase in frequency and magnitude of droughts in the context of climate change however the mapped memory informs on areas where water users are expected to be more or less susceptible to drought and therefore stress for example areas of elevated memory are expected to be favourable for abstraction regimes that are less affected by meteorological droughts and therefore more reliable during dry periods on the other hand areas of low memory may benefit from increased measures to enhance the resilience to drought credit authorship contribution statement philip schuler conceptualization methodology software validation formal analysis data curation visualization writing original draft writing review editing joan campanyà conceptualization methodology software formal analysis writing review editing henning moe conceptualization writing review editing damien doherty data curation resources writing review editing natalya hunter williams writing review editing ted mccormack conceptualization software writing review editing project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was primarily carried out as part of the scientific project groundwater climate funded by geological survey ireland a division of the department of environment climate and communications decc we would like to acknowledge the financial support to j c from the geological survey ireland ref 2019 trp gw 001 the authors would like to gratefully acknowledge the assistance provided by geological survey ireland staff and project team members especially monika kabza ellen mullarkey oisín ó briain shane carey and monica lee we wish to thank the two anonymous reviewers for taking the time and spending the effort to provide very concise and critical remarks which helped to significantly improve the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128277 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3026,precipitation is a vital pillar in the most of hydro climatological studies to measure its stochastic behavior recent technological advancements have provided new sources of high resolution precipitation products hrpps which could be utilized to overcome limitations of the ground measurements however accuracy of hrpps is not the same in different regions and climates and therefore should be assessed prior to any practical application in this study monthly datasets of ten hrpps known as chirps cmorph era5 land gpm 3imergm mswep v2 persiann persiann ccs persiann cdr terraclimate and trmm 3b43 are assessed over central plateau watershed located in central iran during 2005 to 2015 lack of previous studies as well as remarkable variations in altitude and climate of this watershed make it a suitable region for studying spatiotemporal pattern of precipitation and evaluating hrpps for this purpose two approaches are implemented comparing the products with ground measurements and together using triple collocation tc through the first approach an error decomposition scheme is utilized besides the other statistical metrics to further investigate total and seasonal accuracy of the hrpps köppen geiger climate classification indicators are used to assess climate based spatial performance of the hrpps according to the results most of the hrpps underestimate and overestimate precipitation values in wetter and drier climates respectively additionally winter contributes more than any other season to the biases of the products while gpm 3imergm is the most accurate hrpp in the region with nrmse nse and kge of 0 95 0 62 and 0 73 respectively persiann ccs results in the lowest accuracy with nrmse nse and kge of 2 09 0 82 and 0 02 respectively keywords triple collocation error decomposition high resolution precipitation products imerg large scale watershed köppen geiger climate classes data availability data will be made available on request nomenclature amsu b advanced microwave sounding unit b ann artificial neural networks aphrodite asian precipitation highly resolved observational data integration towards evaluation chirp climate hazards group infrared precipitation chirps climate hazards group infrared precipitation with stations chpclim climate hazards group precipitation climatology cmorph climate prediction center morphing method cru ts4 0 climate research unit time series data version 4 0 ecmwf european centre for medium range weather forecasts era5 ecmwf reanalysis v5 ecmwf is defined separately gms geostationary meteorological satellite goes geostationary operational environmental satellite gpcp global precipitation climatology project gpm global precipitation measurement gridsat gridded satellite gsmap global satellite mapping of precipitation hrpp s high resolution precipitation product s imerg integrated multi satellite retrievals for gpm gpm is defined separately ir infrared jaxa japan aerospace exploration agency jra 55 japanese 55 year reanalysis kge kling gupta efficiency mswep multi source weighted ensemble precipitation nasa national aeronautics and space administration nexrad next generation weather radar noaa national oceanic and atmospheric administration nrmse normalized rmse rmse is defined separately nse nash sutcliffe efficiency pdf probability distribution function persiann precipitation estimation from remotely sensed information using artificial neural networks persiann ccs persiann cloud classification system persiann is defined separately persiann cdr persiann climate data record persiann is defined separately pgf princeton university global meteorological forcing pmw passive microwave rmse root mean squared error sm2rsin ascat soil moisture to rainfall advanced scatterometer sm2rain cci soil moisture to rainfall climate change initiative ssmi special sensor microwave imager tc triple collocation tmi trmm microwave imager trmm is defined separately tmpa trmm multisatellite precipitation analysis trmm is defined separately trmm tropical rainfall measuring mission 1 introduction precipitation which is a fundamental driver of the water cycle and earth surface energy balance plays a key role in hydro climatological and ecological studies karbalaye ghorbanpour et al 2021 maghsood et al 2020 zandi et al 2022 advancement in technologies such as remote sensing and computational skills like data mining data fusion and assimilation has provided new sources of high resolution precipitation products hrpps specifically blending information from pmw and ir sensors on board low earth orbit and geostationary satellites respectively has led to development of numerous hrpps duan et al 2016 sun et al 2018a tang et al 2020 accuracy of the provided data by the hrpps is not the same in different regions and climates alijanian et al 2017 darand and khandu 2020 miri et al 2019 this could be due to various factors such as topography climate and precipitation intensity for instance capturing precipitation events in arid regions with low precipitation intensity is a difficult task for satellite sensors in contrast detecting precipitation events in humid regions is less complicated lu et al 2018 due to this challenge selection of the most accurate hrpp is a case specific problem which should be followed by an appropriate bias correction method to improve accuracy of the raw data nasseri et al 2022 yu et al 2021 numerous studies have assessed hrpps by comparing them with recorded ground information with rain gauge stations and meteorological radars assuming the latter as a benchmark zero error rainfall data aghakouchak et al 2012 alijanian et al 2019 gao et al 2020 lu et al 2018 ma et al 2021 moazami et al 2016 2013 sharifi et al 2016 sun et al 2018b taghizadeh et al 2021 tang et al 2020 wang et al 2018 yu et al 2021 through this comparison some researchers have decomposed the total error of the hrpps into different components to further investigate sources and characteristics of the error decomposing error into random and systematic components as well as hit missed and false components are amongst the most widely used error decomposition techniques ghajarnia et al 2018 habib et al 2009 tang et al 2020 habib et al 2009 evaluated trmm 3b42 and trmm 3b42rt products with respect to nexrad radar based data during six heavy rainfall events over louisiana usa based on their analyses hit events contributed the most to the overall bias of the products ghajarnia et al 2018 assessed persiann product versus rain gauge measurements over urmia lake basin located in iran during 2000 to 2011 according to their findings missed false and hit events contributed the most to the least towards total bias respectively tang et al 2020 analyzed ten hrpps across china during 2000 to 2018 at daily and hourly temporal resolutions focusing on snowfall estimates they reported false events as the major source of error within the products considering the ground measurements as zero error datasets is not necessarily an accurate assumption rainfall data derived from meteorological radars may be inaccurate due to topographic conditions as well as uncertainties in the retrieval processes in addition rain gauge stations may be subject to environmental factors such as evaporation and as a result their data could be erroneous alemohammad et al 2015 moreover to validate hrpps accurately a dense network of rain gauge stations is required a condition which is not satisfied in many regions especially in developing countries massari et al 2017 to overcome the abovementioned limitations some researchers have utilized tc statistical technique to assess precipitation datasets alemohammad et al 2015 li et al 2018 massari et al 2017 roebeling et al 2012 tang et al 2020 tanim et al 2021 tc which is firstly developed by stoffelen 1998 provides a platform to assess three collocated estimations a triplet of a certain variable in absence of the true values in this study a wide range of hrpps are assessed by various statistical implements new points of the current research are listed as follows i hrpps are assessed by two approaches comparing with the ground measurements and tc method an error decomposition scheme is also utilized in the first approach it is worthwhile to mention that the most of the previous studies have only implemented one of the aforementioned evaluation techniques ii köppen geiger climate classification maps are utilized to further explore the spatial performance of the hrpps using error decomposition and tc methods moreover seasonal accuracy of the products is investigated with the first technique iii prerequisite conditions of tc are investigated in detail to both check the validity of the method and determine triplets in addition the current study is conducted in a large semi arid watershed in central iran over an eleven year period however most of the earlier studies in this region have encompassed smaller study areas shorter timespans or fewer number of products this paper is organized as follows in section 2 the study area datasets and also utilized methods are described in sections 3 results of the study as well as discussions have been released in four main subsections finally a conclusion is drawn in section 4 2 materials and methods this section consists of three main parts the first part describes the study area as well as the ground data in the second part description of the hrpps is provided finally the third part is dedicated to the statistical analysis methods used in this article 2 1 study area fig 1 shows the geographical location of the central plateau watershed as well as 582 rain gauge stations used in this research central plateau watershed which is the largest major watershed in iran encompasses a total area of about 800 000 km2 and lies between 48 07 to 61 25 in longitude and 26 33 to 37 27 in latitude according to the figure central and eastern parts of the watershed are low laying plains with a minimum elevation of 105 msl and low density of rain gauges in contrary northern western and southern parts of the watershed are mountainous slopes with a maximum elevation of 4471 msl and a relatively high density of rain gauges the ground data used in this research consists of monthly precipitation data of rain gauge stations during years 2005 to 2015 132 months this data is recorded by iran water resources management company iwrm co with accuracy of 0 1 mm and not used in development of the evaluated hrpps fig 2 demonstrates the climatological classes of the watershed based on köppen geiger climate index beck et al 2018 as shown in this figure the watershed experiences seven different climates and is classified as an arid and semi arid region remarkable variations in altitude and climate make this watershed a suitable region for studying spatiotemporal pattern of precipitation and evaluating precipitation products 2 2 high resolution precipitation products hrpps ten hrpps with various spatial resolutions higher than or equal to 0 25 are selected to be assessed in this study selected hrpps include satellite reanalysis and ensemble based datasets ensemble based term is used to refer to those hrpps which are developed by combining previously available products chirps funk et al 2015 which is an ensemble based dataset provides precipitation data with 0 05 spatial resolution over a domain of 50 s to 50 n this data is available from 1981 to present with daily temporal resolution chirps is developed by climate hazards center at university of california santa barbara to monitor agricultural drought to develop chirps firstly chpclim dataset is built using both ground and satellite precipitation data secondly chirp dataset is constructed by chpclim satellite cold cloud duration and precipitation data are also utilized in this step finally chirps is developed by correction of chirp dataset cmorph joyce et al 2004 is a satellite based product with spatial resolution of 0 07 spanning from 60 s to 60 n this product provides precipitation data from 2002 to present cmorph which is developed by noaa utilizes both pmw and ir data to achieve a half hourly temporal resolution to this end propagation vectors are computed initially based on half hourly ir data from gms goes and meteosat sensors then these vectors are utilized to propagate and morph 3 hourly pmw data from amsu b ssmi and tmi sensors era5 land hersbach et al 2020 is the land component of the era5 reanalysis dataset era5 is developed by ecmwf based on integrated forecasting system cy41r2 model and four dimensional variational 4d var data assimilation scheme data from various sources are utilized in development of this product era5 land hereafter era5 delivers global information of many surface variables such as precipitation with 0 1 spatial resolution this data is available from 1981 to present with hourly temporal resolution imerg hou et al 2014 precipitation dataset is one of the major products of the gpm international satellite mission launched by nasa and jaxa pmw data from gpm core observatory and gpm constellation in addition to ir data from gms goes and meteosat sensors are implemented in production of imerg three products of imerg are available namely early run late run and final run while early run and late run products require less computational time and have lower latencies 4 h and 12 h respectively the final run product which is a research level product requires much computational time with minimum latency of 3 5 months gpm 3imergm v6b hereafter imerg which is used in this research is the monthly version of the final run product half hourly and daily versions are also available this product provides global rainfall estimations with 0 1 spatial resolution from 2000 to present mswep v2 hereafter mswep is an ensemble based precipitation dataset developed by beck et al 2019 at gloh2o laboratory this data is available globally with 0 1 spatial resolution on a 3 hourly basis from 1979 to 2017 mswep algorithm merges data from six sources namely cmorph era interim gridsat gsmap jra 55 and trmm 3b42rt to attain high quality precipitation estimates to linearly combine these sources weight of each dataset is calculated according to the ground data gathered from various datasets such as worldclim v2 persiann hsu et al 1997 which is the first member of the persiann family satellite based precipitation products offers rainfall estimations with 0 25 spatial resolution from 2000 to present on an hourly basis it should be noted that all of the persiann family members are developed by center for hydrometeorology and remote sensing at university of california irvine and have the same quasi global coverage from 60 s to 60 n persiann hereafter pers exploits an adaptive ann to estimate precipitation based on cloud top temperature measured by long wave ir sensors in addition a bias correction scheme is applied by using data from pmw sensors persiann ccs hereafter pers ccs is the second member of the persiann family hong et al 2004 and delivers precipitation estimations with 0 04 spatial resolution from 2003 to present on an hourly basis pers ccs classifies clouds based on factors such as coldness and geometry via k means clustering and then develops cloud top temperature and precipitation relationships for each cloud type due to higher spatial resolution and more rapid updates pers ccs is more suitable for high resolution and real time applications in comparison with pers however as no bias correction scheme is applied to pers ccs its accuracy is less than pers persiann cdr hereafter pers cdr is the last and the latest member of the persiann family ashouri et al 2015 this product provides 0 25 precipitation data from 1983 to present with daily temporal resolution pers cdr uses ir data different from pers and pers ccs for estimating precipitation this product is the most appropriate member of the family for long term studies nguyen et al 2019 and in contrary to pers utilizes an ann with fixed array of parameters in addition gpcp dataset is utilized in pers cdr to reduce the bias terraclimate is an ensemble based dataset which provides global information of several hydro climatological variables abatzoglou et al 2018 this product which is developed by climatology lab at university of california merced combines data from worldclim v1 4 worldclim v2 cru ts4 0 and jra55 datasets through climatically aided interpolation technique terraclimate precipitation dataset hereafter terra provides rainfall data with 0 04 spatial resolution spanning from 1958 to 2015 on a monthly basis tmpa precipitation dataset huffman et al 2007 is one of the major products of the trmm satellite mission which is the predecessor of the gpm this dataset is developed utilizing both pmw and ir data two real time and post real time versions of tmpa are available trmm 3b43 hereafter trmm which is used in this research is the monthly post real time version of tmpa and provides precipitation data with 0 25 spatial resolution encompassing 50 s to 50 n latitudes this data is available from 1998 to 2020 information of the hrpps is summarized in table 1 all of the precipitation products used in this study are available with monthly temporal resolution else than cmorph to gain monthly data of this product its daily estimates are accumulated in each month to assess hrpps by comparing them with the ground data their original spatial resolution is utilized however for evaluation based on tc all of the datasets are averaged to a same grid forming 1270 grid cells with 0 25 0 25 spatial resolution 2 3 assessment procedures firstly each hrpp is assessed by the statistical metrics provided in subsection 2 3 1 then error decomposition and tc analysis which are described in subsections 2 3 2 and 2 3 3 respectively are implemented to further assess the hrpps 2 3 1 statistical metrics three statistical metrics namely nrmse nse knoben et al 2019 and kge knoben et al 2019 are utilized to assess the hrpps formulations of these metrics are as follows 1 nrmse 1 n i 1 n p est i p obs i 2 μ obs 2 nse 1 i 1 n p est i p obs i 2 i 1 n μ obs p obs i 2 3 kge 1 r 1 2 σ est σ obs 1 2 μ est μ obs 1 2 where p obs i and p est i are the i th precipitation value from ground observation and hrpp estimation datasets respectively μ obs and μ est σ obs and σ est are means standard deviations of the ground and hrpp datasets respectively n denotes number of the observation estimation pairs and r is their correlation coefficient nrmse yields non negative values and as it gets closer to 0 errors get smaller both nse and kge metrics span from to 1 and determine a perfect agreement among observations and estimations if they equal to 1 2 3 2 error decomposition precipitation events reported by an hrpp could be classified into hit false missed and zero events hit events refer to those events in which both estimated and observed values are non zero false events are events with non zero estimations and zero observations missed events happen when precipitation occurrences recorded by the ground data are not detected by the hrpp and finally zero events occur when no rain is reported by both datasets wang et al 2018 it should be noted that to distinguish zero and non zero precipitation events practically a threshold such as ε should be considered due to hrpps uncertainties ghajarnia et al 2018 error decomposition analysis breaks down the total bias tbias of an hrpp into hit hbias false fbias and missed mbias biases 4 tbias h b i a s f b i a s m b i a s while tbias demonstrates differences of the estimated and observed values for all non zero events hbias fbias and mbias account for these differences in hit false and missed events respectively in this study all of these bias variants are divided by sum of the observations in non zero events to be dimensionless values while tbias and hbias could be both positive overestimation and negative underestimation fbias and mbias only take overestimation and underestimation respectively 2 3 3 triple collocation tc tc analysis stoffelen 1998 is a statistical technique to evaluate and compare three independent estimations of a variable in absence of the true values this technique could be also utilized to merge estimations from different sources lyu et al 2021 various extensions of this statistical method such as extended tc mccoll et al 2014 nonparametric tc nearing et al 2017 and correlated tc gonzález gambau et al 2020 are developed in this study extended tc hereafter tc with additive error model is used to compute coefficient of determination r2 and rmse of hrpps regarding the unknown truth it is worthy to note that although multiplicative error model which is utilized by alemohammad et al 2015 in tc context describes precipitation errors more congruously using this model is not suggested in dry climates due to presence of significant zero precipitation values massari et al 2017 additive error model relates each dataset to the unknown truth by considering a linear relationship as follows 5 x i α i β i t δ i i 1 2 3 where x i denotes the i th dataset t is the unknown truth α i and β i are ordinary least squares intercepts and slopes respectively and δ i indicates the residual error of the i th dataset to implement tc residual errors of the all three datasets should mean to zero e δ 0 in addition they should be uncorrelated with the unknown truth c o v δ t 0 and with each other c o v δ i δ j 0 i j for more information about calculation of rmse and r2 values readers are referred to mccoll et al 2014 3 results and discussion this section is organized in four main parts the first part is dedicated to the assessment of the hrpps by statistical metrics in the second and third parts results of error decomposition and tc techniques are provided respectively finally in the fourth part results are compared with findings of other recent researches 3 1 statistical metrics results fig 3 demonstrates scatter plots of the estimated precipitation hrpps versus observed values rain gauge stations according to this figure imerg era5 and trmm outperform the rest of the products as their scatter points are closer to the bisector in contrast estimations provided by pers ccs and cmorph are less accurate than the others scatter points of these two products are not only distant from the bisector but also more dispersed results of evaluating the hrpps by statistical metrics nrmse nse and kge are presented in table 2 while in terms of nrmse metric imerg and era5 have ranked as the best with their values of 0 95 and 0 98 respectively pers ccs cmorph and chirps are the first to the third worse cases with values of 2 09 1 83 and 1 54 respectively regarding nse imerg and era5 have resulted in values of 0 62 and 0 60 respectively which means these products are the most accurate ones the lowest values of nse are belonged to pers ccs cmorph and chirps with 0 82 0 40 and 0 00 values respectively comparison of the products based on kge metric shows that era5 and imerg have resulted in the highest values of this metric with values of 0 74 and 0 73 respectively this is while the lowest values which are 0 02 0 24 and 0 24 are caused by pers ccs cmorph and pers respectively in contrast to nrmse and nse metrics era5 has performed slightly better than imerg according to kge and chirps is replaced by pers as the third product with the lowest accuracy performance of both mswep and terra are mediocre in terms of the all metrics 3 2 error decomposition results table 3 shows the bias components of the hrpps to compute these components 1 mm threshold is considered to distinguish zero and non zero events according to this table while hit events account for 76 of the total non zero events on average false and missed events comprise 19 and 5 of the total events respectively in other words hit events are the dominant type of the events followed by the false and missed events this finding is also reported by previous studies ayat et al 2021 gebregiorgis et al 2017 tan et al 2016 as rainfall occasions are less probable in semi arid regions occurrence of more false events in comparison with the missed events is compatible with the climate of the study area in terms of tbias the most accurate products are pers cdr imerg and era5 with values of 0 077 0 091 and 0 11 respectively pers ccs and pers however are the least accurate ones with tbias values of 0 801 and 0 349 respectively although cmorph is representing a decent performance in terms of tbias 0 129 considerable magnitudes of its decomposed error components reveal that it is not an accurate hrpp in other words although cmorph has resulted in large values of hbias 0 115 fbias 0 105 and mbias 0 120 tbias does not reflect these values as they contribute conversely and compensate each other after decomposing bias components seasonal values of each component are derived to further investigate impacts of the seasonal changes on pattern of the errors fig 4 depicts values of tbias hbias fbias and mbias in each season in terms of tbias fig 4a winter and summer contribute the most and the least respectively in most of the hrpps considering the fact that winter and summer are the wettest and the driest seasons of the region respectively this finding shows proportionality of the tbias to the precipitation amounts based on fig 4b like tbias winter and summer account for the maximum and minimum contribution to the hbias respectively in most of the hrpps moreover the overall pattern of the hbias is the same as tbias these findings determine that hbias contributes more than any other bias component to the tbias in contrast to tbias and hbias fbias data fig 4c shows that winter accounts for the minimum values in most of the products it shows that probability of false events decreases as precipitation amounts increase as fig 4d shows the highest and the lowest values of the mbias are occurred during the summer and winter seasons respectively in most of the products this could be interpreted as precipitation events with small amounts are more probable to be missed in comparison with those with considerable amounts this finding is also claimed by previous studies such as ghajarnia et al 2018 besides seasonal analysis hrpps are evaluated in terms of variations of tbias versus mean monthly precipitation fig s1 depicts tbias value at rain gauge stations versus mean monthly precipitation of the stations according to this figure generally there is a negative correlation within tbias and precipitation amount in fact as precipitation amount increases tbias moves from positive values towards negative values in other words hrpps tend to underestimate in case of large precipitation amounts and tend to overestimate in case of small precipitation amounts to assess spatial patterns of the bias components tbias hbias fbias and mbias of the hrpps are computed at each rain gauge station over the all 132 months then stations are categorized based on the climate class illustrated in fig 2 in which they are located finally for better data analysis and interpretation violin plots are utilized fig 5 illustrates distributions of the tbias for rain gauge stations located in each climate class for the all hrpps while small dots represent the data violins and stars show their pdfs 1st to 99th percentiles and means respectively red color is assigned to the climate classes in which underestimation is occurring climates with negative means in contrary blue color is dedicated to the overestimating ones according to the figure while the first six hrpps pers ccs chirps trmm era5 imerg and pers cdr are overestimating the total precipitation the last four products cmorph terra mswep and pers are underestimating it should be noted that as only two rain gauge stations are located in climate class v no violin plot is generated for this region in addition only four and seven rain gauge stations are located in climate classes iii and vii respectively so their violin plots are generated with limited number of records although these three climate classes cover less than 2 of the study area total area of about 15000 km2 general conclusions regarding performance of the hrpps in these regions should be drawn with caution due to limited number of the records there is a tendency towards overestimation in climate classes i to iii drier climates of the region even in the hrpps with overall underestimation in contrast underestimation is the dominant behavior of the hrpps in climate classes v to vii which are the wetter climates of the region performance of the hrpps in the climate class iv which represents a mediocre dryness wetness condition in the region are compatible with their overall performance as shown in this figure violin plots of the imerg fig 5e era5 fig 5d and trmm fig 5c are shorter and wider in comparison with the rest of the hrpps this could be interpreted as these products perform more uniformly over different climates of the study domain quite the opposite pers ccs fig 5a and cmorph fig 5g have resulted in narrow and long violin plots which means they lack a uniform spatial performance regional distributions of the hbias fbias and mbias are provided in the supplementary documents figs s2 s3 and s4 respectively as shown in fig s2 violin plots of the hbias are similar to those of the tbias similarity of the hbias and tbias which was also detected through seasonal analysis shows that hbias is the most significant error component significant contribution of hbias towards tbias is due to the fact that hit events are the most common type of events in this study which means hrpps detect precipitation occurrences with high accuracy based on figs s3 and s4 in almost all of the products magnitudes of the fbias are larger than those of the mbias in all of the climate classes this shows that fbias is the second contributing error component 3 3 triple collocation tc results all of the hrpps are considered to be assessed by tc else than pers ccs cmorph and pers which are the most erroneous according to the statistical metrics and error decomposition results as stated in section 2 3 3 three conditions should be satisfied to apply tc satisfaction of these conditions are investigated by considering ground measurements as true values in terms of the first and the second conditions averages of the residual errors as well as their covariance values with the true values are infinitesimal for all of the hrpps table s1 and as a result both of these conditions are being satisfied to check the last condition covariance values of the residual errors of the hrpps c o v δ i δ j are calculated and presented in table 4 it should be noted that as the covariance matrix is symmetric values below the main diagonal are not reported in the table in addition main diagonal values represent variances of the residual errors of the hrpps according to this table chirps results in the largest values of the covariance in comparison with other hrpps and therefore is excluded from tc assessment values of covariance between residual errors of imerg pers cdr and trmm are also larger than the other hrpps as a result triplets are created in a way that none of them encompass these hrpps simultaneously considered triplets combinations are as follows a imerg era5 mswep b imerg era5 terra c imerg mswep terra d pers cdr era5 mswep e pers cdr era5 terra f pers cdr mswep terra g trmm era5 mswep h trmm era5 terra i trmm mswep terra j era5 mswep terra fig 6 depicts average rmse and r2 values for each hrpp in all of the triplets based on each climate class separately as well as all of them together by averaging the results reported values would be more robust and reliable according to the performance of the hrpps in all of the climates together red bars the best hrpp is considered to be imerg with rmse and r2 values of 4 73 mm and 0 91 respectively pers cdr and mswep are the second best hrpps jointly these products result in rmse values of 5 48 mm and 5 41 mm and r2 values of 0 89 and 0 87 respectively while the third place belongs to both era5 and terra trmm is the least accurate product according to tc results with rmse and r2 values of 7 94 mm and 0 79 respectively as shown in fig 6 although there is an increasing trend in rmse values by moving from the first climate arid desert hot to the last one cold dry summer warm summer in most of the hrpps rmse values of mswep are smaller in wetter climates in terms of r2 values they tend to increase by moving towards the middle climate classes in which medium precipitation amounts occur this could be interpreted as estimations provided by the hrpps are more inaccurate in case of high and low precipitation amounts mswep however is an exception r2 values of this hrpp increase by moving towards the wet climates considering both rmse and r2 mswep is performing different from other hrpps and provides high quality estimates in wet regions to further investigate accuracy of the hrpps spatial patterns of the rmse and r2 values are depicted for triplets a to j in figs s5 to s14 respectively in the figures voids represent pixels in which invalid values of rmse or r2 are achieved tc may result in values which are not within the valid range of these metrics as depicted in the figures trmm results in the minimum values of the r2 in central regions era5 and terra demonstrate a weak performance in southeastern regions finally imerg pers cdr and mswep show a relatively uniform non erroneous performance in most of the regions according to these figures each hrpp demonstrates a relatively same performance regardless of the triplet in which it is being assessed consequently it could be concluded that combination of the hrpps has not affected the results considerably as stated in section 2 2 all of the hrpps are averaged to a same spatial grid prior to implementation of tc method accordingly results obtained by this method are not prone to double penalty error this error source may cause finer hrpps to be evaluated less accurate than coarser hrpps when being assessed based on their original spatial resolution sierra lorenzo et al 2022 compatibility of tc analysis results with findings of sections 3 1 and 3 2 in terms of detecting the most accurate hrpps suggests that double penalty error has not affected previous analyses to additionally assessing hrpps based on monthly temporal resolution may have diminished the double penalty error through analyses conducted in aforementioned sections 3 4 comparison with recent researches to investigate compatibility of our findings with previous researches results of this study are compared with outcomes of the recent scientific reports with focus on studies conducted over iran the selected works may be different from the current study in terms of spatial domain time frame temporal resolution and other characteristics several studies have reported that precipitation products tend to underestimate overestimate high low precipitation values fallah et al 2020 hosseini moghari et al 2018 hosseini moghari and tang 2020 katiraie boroujerdy et al 2017 saeidizand et al 2018 taghizadeh et al 2021 hosseini moghari and tang 2020 have stated that error characteristics of imerg products are dependent on climate and precipitation intensity specifically errors increase in wetter climates and higher precipitation intensities dependency of error values on precipitation intensity is also reported by taghizadeh et al 2021 for numerous precipitation products in terms of the dominant error source hit missed or false events there is no consensus among previous studies while habib et al 2009 have reported hit events as the dominant error source ghajarnia et al 2018 and tang et al 2020 have reported missed and false events as the most contributing error sources respectively table 5 provides summary of some recent studies in the region as well as around the globe moazami et al 2013 have evaluated three hrpps across iran during 2003 to 2006 and reported trmm 3b42 trmm 3b42rt and persiann to be the most to the least accurate hrpps respectively duan et al 2016 have analyzed eight hrpps over adige basin of italy during 2000 to 2010 and reported trmm 3b42 to be the most accurate hrpp in this region moazami et al 2016 have assessed four hrpps over 12 provinces of iran during 2003 to 2008 based on their findings while trmm 3b42 is the most accurate product cmorph yields the lowest accuracy over the region sharifi et al 2016 have investigated the accuracy of three hrpps over 4 provinces of iran during 2014 to 2015 and reported era interim gpm 3imerghh and trmm 3b42 to be the most to the least accurate products alijanian et al 2017 have assessed five hrpps over iran during 2003 to 2012 according to their results persiann and cmorph are the most inaccurate products saeidizand et al 2018 have evaluated chirps over iran during 2005 to 2014 and reported a relatively weak performance of this hrpp especially during winter miri et al 2019 have assessed gpm 3imergm trmm 3b43 and persiann cdr products across iran throughout 2014 to 2017 and denoted superiority of the gpm 3imergm over the others salmani dehaghi and samani 2019 have analyzed performance of persiann family products over fars province of iran during 2003 to 2015 and concluded that persiann cdr is by far the most accurate member of this family hosseini moghari and tang 2020 have analyzed daily estimates of six imerg products and have reported higher accuracy of the final run products they have outlined much smaller r2 values in comparison with the current study this is due to the point that daily estimates of the hrpps are generally less accurate than the monthly ones alijanian et al 2017 miri et al 2019 shirmohammadi aliakbarkhani and akbari 2020 lu et al 2020 have evaluated fengyun fy2g and imerg final run over yunnan kweichow plateau of china during 2017 and reported superiority of the first hrpp mosaffa et al 2020 have evaluated eight hrpps over karkheh river basin located in iran during 2003 to 2014 they have reported low accuracy of both persiann ccs and cmorph products tan et al 2020 have studied performance of three hrpps over tibetan plateau during 1951 to 2015 and found aphrodite aphro v1101 ma chirps and persiann cdr to be the most to the least accurate products in this region fan et al 2021 have examined performance of imerg early run as well as sm2rain ascat over tibetan plateau during 2015 and reported higher accuracy of imerg eventually nasseri et al 2022 have assessed eight hrpps over urmia lake basin located in north west of iran during 2003 to 2016 according to their findings gpm 3imergm is the most accurate hrpp followed by trmm 3b43 and terraclimate respectively results of the current study are in line with findings of the previous works in terms of both behavior of the hrpps discussed in the second paragraph and accuracy point of view discussed in the third paragraph additionally based on results of this study imerg and era5 are overestimating the precipitation values and cmorph and pers are underestimating this finding is highly aligned with outcomes of the previous works it is worthy to note that there is no agreement between selected studies in terms of pers cdr chirps and pers ccs bias directions consequently outcomes of the current research are partially aligned with previous works regarding these hrpps eventually findings of this work are in contrast with earlier works in terms of mswep trmm and terra bias directions this disagreement could be due to various factors such as version of the assessed hrpps study domain and time span 4 conclusion in this study ten hrpps namely chirps cmorph era5 land gpm 3imergm mswep v2 persiann persiann ccs persiann cdr terraclimate and trmm 3b43 are assessed spatiotemporally over central plateau watershed located in central iran it is worthy to note that lack of similar studies in this region highlights the importance of this research comparing with the ground measurements as well as triple collocation are the main implemented assessment approaches during the first approach an error decomposition scheme with tbias hbias fbias and mbias components is also utilized besides the statistical metrics to further investigate the error sources of the hrpps according to nrmse and nse metrics while imerg era5 trmm and pers cdr are the most accurate products pers ccs cmorph and chirps are the most erroneous ones while imerg has resulted in nrmse and nse values of 0 95 and 0 62 respectively the rest of the products have resulted in nrmse and nse values of 1 37 and 0 16 on average respectively based on kge metric era5 outperforms imerg with superiority of less than 1 4 and chirps is replaced by pers as the third erroneous hrpp based on tbias values while pers ccs chirps trmm era5 imerg and pers cdr have demonstrated the highest to the lowest overestimations respectively pers mswep terra and cmorph have resulted in the maximum to the minimum underestimations respectively considering the magnitude of the tbias pers cdr imerg and era5 are the most accurate products in contrast pers ccs and pers are the most inaccurate ones according to the error decomposition results hbias contributes more than other bias components to tbias followed by fbias and mbias respectively seasonal analysis of the bias components reveals that winter the wettest season and summer the driest season are the most and the least contributing seasons to the tbias this could be interpreted as tbias values are proportional to the precipitation amounts additionally larger tbias values in winter could be due to snow precipitation in which hrpps experience higher uncertainties spatial assessment of the bias components based on köppen geiger climate classification shows that overestimation is the dominant behavior of the hrpps in drier climates adversely most of the products underestimate precipitation values in wetter climates performance of the both mswep and terra products is evaluated to be mediocre in terms of statistical metrics and error decomposition results to assess the hrpps based on tc analysis pers ccs cmorph and pers are excluded due to their weak performances in addition as prerequisite conditions of the tc are not met by chirps this product is also excluded according to the tc results imerg outperforms other products with superiority of 8 and 22 on average in terms of r2 and rmse respectively trmm has resulted in the weakest performances based on tc results in conclusion imerg is the most accurate hrpp in the region based on the analyses additionally pers cdr era5 and mswep are the next high accuracy products trmm and terra stand in medium quality and eventually pers ccs cmorph pers and chirps are the least accurate ones it should be noted that results of this study are compared with other recent works and this comparison reveals compatibility of the results with previous findings for future studies it is suggested to investigate how quality of these evaluated hrpps could be improved by various calibration and downscaling techniques duan and bastiaanssen 2013 ma et al 2020 2018 nasseri et al 2022 in addition fusing datasets by methods such as triple collocation lyu et al 2021 could be of high interest credit authorship contribution statement arash ghomlaghi conceptualization methodology software formal analysis investigation resources data curation writing original draft visualization mohsen nasseri conceptualization methodology software investigation resources writing review editing supervision bardia bayat conceptualization investigation resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128298 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3026,precipitation is a vital pillar in the most of hydro climatological studies to measure its stochastic behavior recent technological advancements have provided new sources of high resolution precipitation products hrpps which could be utilized to overcome limitations of the ground measurements however accuracy of hrpps is not the same in different regions and climates and therefore should be assessed prior to any practical application in this study monthly datasets of ten hrpps known as chirps cmorph era5 land gpm 3imergm mswep v2 persiann persiann ccs persiann cdr terraclimate and trmm 3b43 are assessed over central plateau watershed located in central iran during 2005 to 2015 lack of previous studies as well as remarkable variations in altitude and climate of this watershed make it a suitable region for studying spatiotemporal pattern of precipitation and evaluating hrpps for this purpose two approaches are implemented comparing the products with ground measurements and together using triple collocation tc through the first approach an error decomposition scheme is utilized besides the other statistical metrics to further investigate total and seasonal accuracy of the hrpps köppen geiger climate classification indicators are used to assess climate based spatial performance of the hrpps according to the results most of the hrpps underestimate and overestimate precipitation values in wetter and drier climates respectively additionally winter contributes more than any other season to the biases of the products while gpm 3imergm is the most accurate hrpp in the region with nrmse nse and kge of 0 95 0 62 and 0 73 respectively persiann ccs results in the lowest accuracy with nrmse nse and kge of 2 09 0 82 and 0 02 respectively keywords triple collocation error decomposition high resolution precipitation products imerg large scale watershed köppen geiger climate classes data availability data will be made available on request nomenclature amsu b advanced microwave sounding unit b ann artificial neural networks aphrodite asian precipitation highly resolved observational data integration towards evaluation chirp climate hazards group infrared precipitation chirps climate hazards group infrared precipitation with stations chpclim climate hazards group precipitation climatology cmorph climate prediction center morphing method cru ts4 0 climate research unit time series data version 4 0 ecmwf european centre for medium range weather forecasts era5 ecmwf reanalysis v5 ecmwf is defined separately gms geostationary meteorological satellite goes geostationary operational environmental satellite gpcp global precipitation climatology project gpm global precipitation measurement gridsat gridded satellite gsmap global satellite mapping of precipitation hrpp s high resolution precipitation product s imerg integrated multi satellite retrievals for gpm gpm is defined separately ir infrared jaxa japan aerospace exploration agency jra 55 japanese 55 year reanalysis kge kling gupta efficiency mswep multi source weighted ensemble precipitation nasa national aeronautics and space administration nexrad next generation weather radar noaa national oceanic and atmospheric administration nrmse normalized rmse rmse is defined separately nse nash sutcliffe efficiency pdf probability distribution function persiann precipitation estimation from remotely sensed information using artificial neural networks persiann ccs persiann cloud classification system persiann is defined separately persiann cdr persiann climate data record persiann is defined separately pgf princeton university global meteorological forcing pmw passive microwave rmse root mean squared error sm2rsin ascat soil moisture to rainfall advanced scatterometer sm2rain cci soil moisture to rainfall climate change initiative ssmi special sensor microwave imager tc triple collocation tmi trmm microwave imager trmm is defined separately tmpa trmm multisatellite precipitation analysis trmm is defined separately trmm tropical rainfall measuring mission 1 introduction precipitation which is a fundamental driver of the water cycle and earth surface energy balance plays a key role in hydro climatological and ecological studies karbalaye ghorbanpour et al 2021 maghsood et al 2020 zandi et al 2022 advancement in technologies such as remote sensing and computational skills like data mining data fusion and assimilation has provided new sources of high resolution precipitation products hrpps specifically blending information from pmw and ir sensors on board low earth orbit and geostationary satellites respectively has led to development of numerous hrpps duan et al 2016 sun et al 2018a tang et al 2020 accuracy of the provided data by the hrpps is not the same in different regions and climates alijanian et al 2017 darand and khandu 2020 miri et al 2019 this could be due to various factors such as topography climate and precipitation intensity for instance capturing precipitation events in arid regions with low precipitation intensity is a difficult task for satellite sensors in contrast detecting precipitation events in humid regions is less complicated lu et al 2018 due to this challenge selection of the most accurate hrpp is a case specific problem which should be followed by an appropriate bias correction method to improve accuracy of the raw data nasseri et al 2022 yu et al 2021 numerous studies have assessed hrpps by comparing them with recorded ground information with rain gauge stations and meteorological radars assuming the latter as a benchmark zero error rainfall data aghakouchak et al 2012 alijanian et al 2019 gao et al 2020 lu et al 2018 ma et al 2021 moazami et al 2016 2013 sharifi et al 2016 sun et al 2018b taghizadeh et al 2021 tang et al 2020 wang et al 2018 yu et al 2021 through this comparison some researchers have decomposed the total error of the hrpps into different components to further investigate sources and characteristics of the error decomposing error into random and systematic components as well as hit missed and false components are amongst the most widely used error decomposition techniques ghajarnia et al 2018 habib et al 2009 tang et al 2020 habib et al 2009 evaluated trmm 3b42 and trmm 3b42rt products with respect to nexrad radar based data during six heavy rainfall events over louisiana usa based on their analyses hit events contributed the most to the overall bias of the products ghajarnia et al 2018 assessed persiann product versus rain gauge measurements over urmia lake basin located in iran during 2000 to 2011 according to their findings missed false and hit events contributed the most to the least towards total bias respectively tang et al 2020 analyzed ten hrpps across china during 2000 to 2018 at daily and hourly temporal resolutions focusing on snowfall estimates they reported false events as the major source of error within the products considering the ground measurements as zero error datasets is not necessarily an accurate assumption rainfall data derived from meteorological radars may be inaccurate due to topographic conditions as well as uncertainties in the retrieval processes in addition rain gauge stations may be subject to environmental factors such as evaporation and as a result their data could be erroneous alemohammad et al 2015 moreover to validate hrpps accurately a dense network of rain gauge stations is required a condition which is not satisfied in many regions especially in developing countries massari et al 2017 to overcome the abovementioned limitations some researchers have utilized tc statistical technique to assess precipitation datasets alemohammad et al 2015 li et al 2018 massari et al 2017 roebeling et al 2012 tang et al 2020 tanim et al 2021 tc which is firstly developed by stoffelen 1998 provides a platform to assess three collocated estimations a triplet of a certain variable in absence of the true values in this study a wide range of hrpps are assessed by various statistical implements new points of the current research are listed as follows i hrpps are assessed by two approaches comparing with the ground measurements and tc method an error decomposition scheme is also utilized in the first approach it is worthwhile to mention that the most of the previous studies have only implemented one of the aforementioned evaluation techniques ii köppen geiger climate classification maps are utilized to further explore the spatial performance of the hrpps using error decomposition and tc methods moreover seasonal accuracy of the products is investigated with the first technique iii prerequisite conditions of tc are investigated in detail to both check the validity of the method and determine triplets in addition the current study is conducted in a large semi arid watershed in central iran over an eleven year period however most of the earlier studies in this region have encompassed smaller study areas shorter timespans or fewer number of products this paper is organized as follows in section 2 the study area datasets and also utilized methods are described in sections 3 results of the study as well as discussions have been released in four main subsections finally a conclusion is drawn in section 4 2 materials and methods this section consists of three main parts the first part describes the study area as well as the ground data in the second part description of the hrpps is provided finally the third part is dedicated to the statistical analysis methods used in this article 2 1 study area fig 1 shows the geographical location of the central plateau watershed as well as 582 rain gauge stations used in this research central plateau watershed which is the largest major watershed in iran encompasses a total area of about 800 000 km2 and lies between 48 07 to 61 25 in longitude and 26 33 to 37 27 in latitude according to the figure central and eastern parts of the watershed are low laying plains with a minimum elevation of 105 msl and low density of rain gauges in contrary northern western and southern parts of the watershed are mountainous slopes with a maximum elevation of 4471 msl and a relatively high density of rain gauges the ground data used in this research consists of monthly precipitation data of rain gauge stations during years 2005 to 2015 132 months this data is recorded by iran water resources management company iwrm co with accuracy of 0 1 mm and not used in development of the evaluated hrpps fig 2 demonstrates the climatological classes of the watershed based on köppen geiger climate index beck et al 2018 as shown in this figure the watershed experiences seven different climates and is classified as an arid and semi arid region remarkable variations in altitude and climate make this watershed a suitable region for studying spatiotemporal pattern of precipitation and evaluating precipitation products 2 2 high resolution precipitation products hrpps ten hrpps with various spatial resolutions higher than or equal to 0 25 are selected to be assessed in this study selected hrpps include satellite reanalysis and ensemble based datasets ensemble based term is used to refer to those hrpps which are developed by combining previously available products chirps funk et al 2015 which is an ensemble based dataset provides precipitation data with 0 05 spatial resolution over a domain of 50 s to 50 n this data is available from 1981 to present with daily temporal resolution chirps is developed by climate hazards center at university of california santa barbara to monitor agricultural drought to develop chirps firstly chpclim dataset is built using both ground and satellite precipitation data secondly chirp dataset is constructed by chpclim satellite cold cloud duration and precipitation data are also utilized in this step finally chirps is developed by correction of chirp dataset cmorph joyce et al 2004 is a satellite based product with spatial resolution of 0 07 spanning from 60 s to 60 n this product provides precipitation data from 2002 to present cmorph which is developed by noaa utilizes both pmw and ir data to achieve a half hourly temporal resolution to this end propagation vectors are computed initially based on half hourly ir data from gms goes and meteosat sensors then these vectors are utilized to propagate and morph 3 hourly pmw data from amsu b ssmi and tmi sensors era5 land hersbach et al 2020 is the land component of the era5 reanalysis dataset era5 is developed by ecmwf based on integrated forecasting system cy41r2 model and four dimensional variational 4d var data assimilation scheme data from various sources are utilized in development of this product era5 land hereafter era5 delivers global information of many surface variables such as precipitation with 0 1 spatial resolution this data is available from 1981 to present with hourly temporal resolution imerg hou et al 2014 precipitation dataset is one of the major products of the gpm international satellite mission launched by nasa and jaxa pmw data from gpm core observatory and gpm constellation in addition to ir data from gms goes and meteosat sensors are implemented in production of imerg three products of imerg are available namely early run late run and final run while early run and late run products require less computational time and have lower latencies 4 h and 12 h respectively the final run product which is a research level product requires much computational time with minimum latency of 3 5 months gpm 3imergm v6b hereafter imerg which is used in this research is the monthly version of the final run product half hourly and daily versions are also available this product provides global rainfall estimations with 0 1 spatial resolution from 2000 to present mswep v2 hereafter mswep is an ensemble based precipitation dataset developed by beck et al 2019 at gloh2o laboratory this data is available globally with 0 1 spatial resolution on a 3 hourly basis from 1979 to 2017 mswep algorithm merges data from six sources namely cmorph era interim gridsat gsmap jra 55 and trmm 3b42rt to attain high quality precipitation estimates to linearly combine these sources weight of each dataset is calculated according to the ground data gathered from various datasets such as worldclim v2 persiann hsu et al 1997 which is the first member of the persiann family satellite based precipitation products offers rainfall estimations with 0 25 spatial resolution from 2000 to present on an hourly basis it should be noted that all of the persiann family members are developed by center for hydrometeorology and remote sensing at university of california irvine and have the same quasi global coverage from 60 s to 60 n persiann hereafter pers exploits an adaptive ann to estimate precipitation based on cloud top temperature measured by long wave ir sensors in addition a bias correction scheme is applied by using data from pmw sensors persiann ccs hereafter pers ccs is the second member of the persiann family hong et al 2004 and delivers precipitation estimations with 0 04 spatial resolution from 2003 to present on an hourly basis pers ccs classifies clouds based on factors such as coldness and geometry via k means clustering and then develops cloud top temperature and precipitation relationships for each cloud type due to higher spatial resolution and more rapid updates pers ccs is more suitable for high resolution and real time applications in comparison with pers however as no bias correction scheme is applied to pers ccs its accuracy is less than pers persiann cdr hereafter pers cdr is the last and the latest member of the persiann family ashouri et al 2015 this product provides 0 25 precipitation data from 1983 to present with daily temporal resolution pers cdr uses ir data different from pers and pers ccs for estimating precipitation this product is the most appropriate member of the family for long term studies nguyen et al 2019 and in contrary to pers utilizes an ann with fixed array of parameters in addition gpcp dataset is utilized in pers cdr to reduce the bias terraclimate is an ensemble based dataset which provides global information of several hydro climatological variables abatzoglou et al 2018 this product which is developed by climatology lab at university of california merced combines data from worldclim v1 4 worldclim v2 cru ts4 0 and jra55 datasets through climatically aided interpolation technique terraclimate precipitation dataset hereafter terra provides rainfall data with 0 04 spatial resolution spanning from 1958 to 2015 on a monthly basis tmpa precipitation dataset huffman et al 2007 is one of the major products of the trmm satellite mission which is the predecessor of the gpm this dataset is developed utilizing both pmw and ir data two real time and post real time versions of tmpa are available trmm 3b43 hereafter trmm which is used in this research is the monthly post real time version of tmpa and provides precipitation data with 0 25 spatial resolution encompassing 50 s to 50 n latitudes this data is available from 1998 to 2020 information of the hrpps is summarized in table 1 all of the precipitation products used in this study are available with monthly temporal resolution else than cmorph to gain monthly data of this product its daily estimates are accumulated in each month to assess hrpps by comparing them with the ground data their original spatial resolution is utilized however for evaluation based on tc all of the datasets are averaged to a same grid forming 1270 grid cells with 0 25 0 25 spatial resolution 2 3 assessment procedures firstly each hrpp is assessed by the statistical metrics provided in subsection 2 3 1 then error decomposition and tc analysis which are described in subsections 2 3 2 and 2 3 3 respectively are implemented to further assess the hrpps 2 3 1 statistical metrics three statistical metrics namely nrmse nse knoben et al 2019 and kge knoben et al 2019 are utilized to assess the hrpps formulations of these metrics are as follows 1 nrmse 1 n i 1 n p est i p obs i 2 μ obs 2 nse 1 i 1 n p est i p obs i 2 i 1 n μ obs p obs i 2 3 kge 1 r 1 2 σ est σ obs 1 2 μ est μ obs 1 2 where p obs i and p est i are the i th precipitation value from ground observation and hrpp estimation datasets respectively μ obs and μ est σ obs and σ est are means standard deviations of the ground and hrpp datasets respectively n denotes number of the observation estimation pairs and r is their correlation coefficient nrmse yields non negative values and as it gets closer to 0 errors get smaller both nse and kge metrics span from to 1 and determine a perfect agreement among observations and estimations if they equal to 1 2 3 2 error decomposition precipitation events reported by an hrpp could be classified into hit false missed and zero events hit events refer to those events in which both estimated and observed values are non zero false events are events with non zero estimations and zero observations missed events happen when precipitation occurrences recorded by the ground data are not detected by the hrpp and finally zero events occur when no rain is reported by both datasets wang et al 2018 it should be noted that to distinguish zero and non zero precipitation events practically a threshold such as ε should be considered due to hrpps uncertainties ghajarnia et al 2018 error decomposition analysis breaks down the total bias tbias of an hrpp into hit hbias false fbias and missed mbias biases 4 tbias h b i a s f b i a s m b i a s while tbias demonstrates differences of the estimated and observed values for all non zero events hbias fbias and mbias account for these differences in hit false and missed events respectively in this study all of these bias variants are divided by sum of the observations in non zero events to be dimensionless values while tbias and hbias could be both positive overestimation and negative underestimation fbias and mbias only take overestimation and underestimation respectively 2 3 3 triple collocation tc tc analysis stoffelen 1998 is a statistical technique to evaluate and compare three independent estimations of a variable in absence of the true values this technique could be also utilized to merge estimations from different sources lyu et al 2021 various extensions of this statistical method such as extended tc mccoll et al 2014 nonparametric tc nearing et al 2017 and correlated tc gonzález gambau et al 2020 are developed in this study extended tc hereafter tc with additive error model is used to compute coefficient of determination r2 and rmse of hrpps regarding the unknown truth it is worthy to note that although multiplicative error model which is utilized by alemohammad et al 2015 in tc context describes precipitation errors more congruously using this model is not suggested in dry climates due to presence of significant zero precipitation values massari et al 2017 additive error model relates each dataset to the unknown truth by considering a linear relationship as follows 5 x i α i β i t δ i i 1 2 3 where x i denotes the i th dataset t is the unknown truth α i and β i are ordinary least squares intercepts and slopes respectively and δ i indicates the residual error of the i th dataset to implement tc residual errors of the all three datasets should mean to zero e δ 0 in addition they should be uncorrelated with the unknown truth c o v δ t 0 and with each other c o v δ i δ j 0 i j for more information about calculation of rmse and r2 values readers are referred to mccoll et al 2014 3 results and discussion this section is organized in four main parts the first part is dedicated to the assessment of the hrpps by statistical metrics in the second and third parts results of error decomposition and tc techniques are provided respectively finally in the fourth part results are compared with findings of other recent researches 3 1 statistical metrics results fig 3 demonstrates scatter plots of the estimated precipitation hrpps versus observed values rain gauge stations according to this figure imerg era5 and trmm outperform the rest of the products as their scatter points are closer to the bisector in contrast estimations provided by pers ccs and cmorph are less accurate than the others scatter points of these two products are not only distant from the bisector but also more dispersed results of evaluating the hrpps by statistical metrics nrmse nse and kge are presented in table 2 while in terms of nrmse metric imerg and era5 have ranked as the best with their values of 0 95 and 0 98 respectively pers ccs cmorph and chirps are the first to the third worse cases with values of 2 09 1 83 and 1 54 respectively regarding nse imerg and era5 have resulted in values of 0 62 and 0 60 respectively which means these products are the most accurate ones the lowest values of nse are belonged to pers ccs cmorph and chirps with 0 82 0 40 and 0 00 values respectively comparison of the products based on kge metric shows that era5 and imerg have resulted in the highest values of this metric with values of 0 74 and 0 73 respectively this is while the lowest values which are 0 02 0 24 and 0 24 are caused by pers ccs cmorph and pers respectively in contrast to nrmse and nse metrics era5 has performed slightly better than imerg according to kge and chirps is replaced by pers as the third product with the lowest accuracy performance of both mswep and terra are mediocre in terms of the all metrics 3 2 error decomposition results table 3 shows the bias components of the hrpps to compute these components 1 mm threshold is considered to distinguish zero and non zero events according to this table while hit events account for 76 of the total non zero events on average false and missed events comprise 19 and 5 of the total events respectively in other words hit events are the dominant type of the events followed by the false and missed events this finding is also reported by previous studies ayat et al 2021 gebregiorgis et al 2017 tan et al 2016 as rainfall occasions are less probable in semi arid regions occurrence of more false events in comparison with the missed events is compatible with the climate of the study area in terms of tbias the most accurate products are pers cdr imerg and era5 with values of 0 077 0 091 and 0 11 respectively pers ccs and pers however are the least accurate ones with tbias values of 0 801 and 0 349 respectively although cmorph is representing a decent performance in terms of tbias 0 129 considerable magnitudes of its decomposed error components reveal that it is not an accurate hrpp in other words although cmorph has resulted in large values of hbias 0 115 fbias 0 105 and mbias 0 120 tbias does not reflect these values as they contribute conversely and compensate each other after decomposing bias components seasonal values of each component are derived to further investigate impacts of the seasonal changes on pattern of the errors fig 4 depicts values of tbias hbias fbias and mbias in each season in terms of tbias fig 4a winter and summer contribute the most and the least respectively in most of the hrpps considering the fact that winter and summer are the wettest and the driest seasons of the region respectively this finding shows proportionality of the tbias to the precipitation amounts based on fig 4b like tbias winter and summer account for the maximum and minimum contribution to the hbias respectively in most of the hrpps moreover the overall pattern of the hbias is the same as tbias these findings determine that hbias contributes more than any other bias component to the tbias in contrast to tbias and hbias fbias data fig 4c shows that winter accounts for the minimum values in most of the products it shows that probability of false events decreases as precipitation amounts increase as fig 4d shows the highest and the lowest values of the mbias are occurred during the summer and winter seasons respectively in most of the products this could be interpreted as precipitation events with small amounts are more probable to be missed in comparison with those with considerable amounts this finding is also claimed by previous studies such as ghajarnia et al 2018 besides seasonal analysis hrpps are evaluated in terms of variations of tbias versus mean monthly precipitation fig s1 depicts tbias value at rain gauge stations versus mean monthly precipitation of the stations according to this figure generally there is a negative correlation within tbias and precipitation amount in fact as precipitation amount increases tbias moves from positive values towards negative values in other words hrpps tend to underestimate in case of large precipitation amounts and tend to overestimate in case of small precipitation amounts to assess spatial patterns of the bias components tbias hbias fbias and mbias of the hrpps are computed at each rain gauge station over the all 132 months then stations are categorized based on the climate class illustrated in fig 2 in which they are located finally for better data analysis and interpretation violin plots are utilized fig 5 illustrates distributions of the tbias for rain gauge stations located in each climate class for the all hrpps while small dots represent the data violins and stars show their pdfs 1st to 99th percentiles and means respectively red color is assigned to the climate classes in which underestimation is occurring climates with negative means in contrary blue color is dedicated to the overestimating ones according to the figure while the first six hrpps pers ccs chirps trmm era5 imerg and pers cdr are overestimating the total precipitation the last four products cmorph terra mswep and pers are underestimating it should be noted that as only two rain gauge stations are located in climate class v no violin plot is generated for this region in addition only four and seven rain gauge stations are located in climate classes iii and vii respectively so their violin plots are generated with limited number of records although these three climate classes cover less than 2 of the study area total area of about 15000 km2 general conclusions regarding performance of the hrpps in these regions should be drawn with caution due to limited number of the records there is a tendency towards overestimation in climate classes i to iii drier climates of the region even in the hrpps with overall underestimation in contrast underestimation is the dominant behavior of the hrpps in climate classes v to vii which are the wetter climates of the region performance of the hrpps in the climate class iv which represents a mediocre dryness wetness condition in the region are compatible with their overall performance as shown in this figure violin plots of the imerg fig 5e era5 fig 5d and trmm fig 5c are shorter and wider in comparison with the rest of the hrpps this could be interpreted as these products perform more uniformly over different climates of the study domain quite the opposite pers ccs fig 5a and cmorph fig 5g have resulted in narrow and long violin plots which means they lack a uniform spatial performance regional distributions of the hbias fbias and mbias are provided in the supplementary documents figs s2 s3 and s4 respectively as shown in fig s2 violin plots of the hbias are similar to those of the tbias similarity of the hbias and tbias which was also detected through seasonal analysis shows that hbias is the most significant error component significant contribution of hbias towards tbias is due to the fact that hit events are the most common type of events in this study which means hrpps detect precipitation occurrences with high accuracy based on figs s3 and s4 in almost all of the products magnitudes of the fbias are larger than those of the mbias in all of the climate classes this shows that fbias is the second contributing error component 3 3 triple collocation tc results all of the hrpps are considered to be assessed by tc else than pers ccs cmorph and pers which are the most erroneous according to the statistical metrics and error decomposition results as stated in section 2 3 3 three conditions should be satisfied to apply tc satisfaction of these conditions are investigated by considering ground measurements as true values in terms of the first and the second conditions averages of the residual errors as well as their covariance values with the true values are infinitesimal for all of the hrpps table s1 and as a result both of these conditions are being satisfied to check the last condition covariance values of the residual errors of the hrpps c o v δ i δ j are calculated and presented in table 4 it should be noted that as the covariance matrix is symmetric values below the main diagonal are not reported in the table in addition main diagonal values represent variances of the residual errors of the hrpps according to this table chirps results in the largest values of the covariance in comparison with other hrpps and therefore is excluded from tc assessment values of covariance between residual errors of imerg pers cdr and trmm are also larger than the other hrpps as a result triplets are created in a way that none of them encompass these hrpps simultaneously considered triplets combinations are as follows a imerg era5 mswep b imerg era5 terra c imerg mswep terra d pers cdr era5 mswep e pers cdr era5 terra f pers cdr mswep terra g trmm era5 mswep h trmm era5 terra i trmm mswep terra j era5 mswep terra fig 6 depicts average rmse and r2 values for each hrpp in all of the triplets based on each climate class separately as well as all of them together by averaging the results reported values would be more robust and reliable according to the performance of the hrpps in all of the climates together red bars the best hrpp is considered to be imerg with rmse and r2 values of 4 73 mm and 0 91 respectively pers cdr and mswep are the second best hrpps jointly these products result in rmse values of 5 48 mm and 5 41 mm and r2 values of 0 89 and 0 87 respectively while the third place belongs to both era5 and terra trmm is the least accurate product according to tc results with rmse and r2 values of 7 94 mm and 0 79 respectively as shown in fig 6 although there is an increasing trend in rmse values by moving from the first climate arid desert hot to the last one cold dry summer warm summer in most of the hrpps rmse values of mswep are smaller in wetter climates in terms of r2 values they tend to increase by moving towards the middle climate classes in which medium precipitation amounts occur this could be interpreted as estimations provided by the hrpps are more inaccurate in case of high and low precipitation amounts mswep however is an exception r2 values of this hrpp increase by moving towards the wet climates considering both rmse and r2 mswep is performing different from other hrpps and provides high quality estimates in wet regions to further investigate accuracy of the hrpps spatial patterns of the rmse and r2 values are depicted for triplets a to j in figs s5 to s14 respectively in the figures voids represent pixels in which invalid values of rmse or r2 are achieved tc may result in values which are not within the valid range of these metrics as depicted in the figures trmm results in the minimum values of the r2 in central regions era5 and terra demonstrate a weak performance in southeastern regions finally imerg pers cdr and mswep show a relatively uniform non erroneous performance in most of the regions according to these figures each hrpp demonstrates a relatively same performance regardless of the triplet in which it is being assessed consequently it could be concluded that combination of the hrpps has not affected the results considerably as stated in section 2 2 all of the hrpps are averaged to a same spatial grid prior to implementation of tc method accordingly results obtained by this method are not prone to double penalty error this error source may cause finer hrpps to be evaluated less accurate than coarser hrpps when being assessed based on their original spatial resolution sierra lorenzo et al 2022 compatibility of tc analysis results with findings of sections 3 1 and 3 2 in terms of detecting the most accurate hrpps suggests that double penalty error has not affected previous analyses to additionally assessing hrpps based on monthly temporal resolution may have diminished the double penalty error through analyses conducted in aforementioned sections 3 4 comparison with recent researches to investigate compatibility of our findings with previous researches results of this study are compared with outcomes of the recent scientific reports with focus on studies conducted over iran the selected works may be different from the current study in terms of spatial domain time frame temporal resolution and other characteristics several studies have reported that precipitation products tend to underestimate overestimate high low precipitation values fallah et al 2020 hosseini moghari et al 2018 hosseini moghari and tang 2020 katiraie boroujerdy et al 2017 saeidizand et al 2018 taghizadeh et al 2021 hosseini moghari and tang 2020 have stated that error characteristics of imerg products are dependent on climate and precipitation intensity specifically errors increase in wetter climates and higher precipitation intensities dependency of error values on precipitation intensity is also reported by taghizadeh et al 2021 for numerous precipitation products in terms of the dominant error source hit missed or false events there is no consensus among previous studies while habib et al 2009 have reported hit events as the dominant error source ghajarnia et al 2018 and tang et al 2020 have reported missed and false events as the most contributing error sources respectively table 5 provides summary of some recent studies in the region as well as around the globe moazami et al 2013 have evaluated three hrpps across iran during 2003 to 2006 and reported trmm 3b42 trmm 3b42rt and persiann to be the most to the least accurate hrpps respectively duan et al 2016 have analyzed eight hrpps over adige basin of italy during 2000 to 2010 and reported trmm 3b42 to be the most accurate hrpp in this region moazami et al 2016 have assessed four hrpps over 12 provinces of iran during 2003 to 2008 based on their findings while trmm 3b42 is the most accurate product cmorph yields the lowest accuracy over the region sharifi et al 2016 have investigated the accuracy of three hrpps over 4 provinces of iran during 2014 to 2015 and reported era interim gpm 3imerghh and trmm 3b42 to be the most to the least accurate products alijanian et al 2017 have assessed five hrpps over iran during 2003 to 2012 according to their results persiann and cmorph are the most inaccurate products saeidizand et al 2018 have evaluated chirps over iran during 2005 to 2014 and reported a relatively weak performance of this hrpp especially during winter miri et al 2019 have assessed gpm 3imergm trmm 3b43 and persiann cdr products across iran throughout 2014 to 2017 and denoted superiority of the gpm 3imergm over the others salmani dehaghi and samani 2019 have analyzed performance of persiann family products over fars province of iran during 2003 to 2015 and concluded that persiann cdr is by far the most accurate member of this family hosseini moghari and tang 2020 have analyzed daily estimates of six imerg products and have reported higher accuracy of the final run products they have outlined much smaller r2 values in comparison with the current study this is due to the point that daily estimates of the hrpps are generally less accurate than the monthly ones alijanian et al 2017 miri et al 2019 shirmohammadi aliakbarkhani and akbari 2020 lu et al 2020 have evaluated fengyun fy2g and imerg final run over yunnan kweichow plateau of china during 2017 and reported superiority of the first hrpp mosaffa et al 2020 have evaluated eight hrpps over karkheh river basin located in iran during 2003 to 2014 they have reported low accuracy of both persiann ccs and cmorph products tan et al 2020 have studied performance of three hrpps over tibetan plateau during 1951 to 2015 and found aphrodite aphro v1101 ma chirps and persiann cdr to be the most to the least accurate products in this region fan et al 2021 have examined performance of imerg early run as well as sm2rain ascat over tibetan plateau during 2015 and reported higher accuracy of imerg eventually nasseri et al 2022 have assessed eight hrpps over urmia lake basin located in north west of iran during 2003 to 2016 according to their findings gpm 3imergm is the most accurate hrpp followed by trmm 3b43 and terraclimate respectively results of the current study are in line with findings of the previous works in terms of both behavior of the hrpps discussed in the second paragraph and accuracy point of view discussed in the third paragraph additionally based on results of this study imerg and era5 are overestimating the precipitation values and cmorph and pers are underestimating this finding is highly aligned with outcomes of the previous works it is worthy to note that there is no agreement between selected studies in terms of pers cdr chirps and pers ccs bias directions consequently outcomes of the current research are partially aligned with previous works regarding these hrpps eventually findings of this work are in contrast with earlier works in terms of mswep trmm and terra bias directions this disagreement could be due to various factors such as version of the assessed hrpps study domain and time span 4 conclusion in this study ten hrpps namely chirps cmorph era5 land gpm 3imergm mswep v2 persiann persiann ccs persiann cdr terraclimate and trmm 3b43 are assessed spatiotemporally over central plateau watershed located in central iran it is worthy to note that lack of similar studies in this region highlights the importance of this research comparing with the ground measurements as well as triple collocation are the main implemented assessment approaches during the first approach an error decomposition scheme with tbias hbias fbias and mbias components is also utilized besides the statistical metrics to further investigate the error sources of the hrpps according to nrmse and nse metrics while imerg era5 trmm and pers cdr are the most accurate products pers ccs cmorph and chirps are the most erroneous ones while imerg has resulted in nrmse and nse values of 0 95 and 0 62 respectively the rest of the products have resulted in nrmse and nse values of 1 37 and 0 16 on average respectively based on kge metric era5 outperforms imerg with superiority of less than 1 4 and chirps is replaced by pers as the third erroneous hrpp based on tbias values while pers ccs chirps trmm era5 imerg and pers cdr have demonstrated the highest to the lowest overestimations respectively pers mswep terra and cmorph have resulted in the maximum to the minimum underestimations respectively considering the magnitude of the tbias pers cdr imerg and era5 are the most accurate products in contrast pers ccs and pers are the most inaccurate ones according to the error decomposition results hbias contributes more than other bias components to tbias followed by fbias and mbias respectively seasonal analysis of the bias components reveals that winter the wettest season and summer the driest season are the most and the least contributing seasons to the tbias this could be interpreted as tbias values are proportional to the precipitation amounts additionally larger tbias values in winter could be due to snow precipitation in which hrpps experience higher uncertainties spatial assessment of the bias components based on köppen geiger climate classification shows that overestimation is the dominant behavior of the hrpps in drier climates adversely most of the products underestimate precipitation values in wetter climates performance of the both mswep and terra products is evaluated to be mediocre in terms of statistical metrics and error decomposition results to assess the hrpps based on tc analysis pers ccs cmorph and pers are excluded due to their weak performances in addition as prerequisite conditions of the tc are not met by chirps this product is also excluded according to the tc results imerg outperforms other products with superiority of 8 and 22 on average in terms of r2 and rmse respectively trmm has resulted in the weakest performances based on tc results in conclusion imerg is the most accurate hrpp in the region based on the analyses additionally pers cdr era5 and mswep are the next high accuracy products trmm and terra stand in medium quality and eventually pers ccs cmorph pers and chirps are the least accurate ones it should be noted that results of this study are compared with other recent works and this comparison reveals compatibility of the results with previous findings for future studies it is suggested to investigate how quality of these evaluated hrpps could be improved by various calibration and downscaling techniques duan and bastiaanssen 2013 ma et al 2020 2018 nasseri et al 2022 in addition fusing datasets by methods such as triple collocation lyu et al 2021 could be of high interest credit authorship contribution statement arash ghomlaghi conceptualization methodology software formal analysis investigation resources data curation writing original draft visualization mohsen nasseri conceptualization methodology software investigation resources writing review editing supervision bardia bayat conceptualization investigation resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128298 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3027,river morphology plays an important role in water environment and resources the dominant discharge qd is a crucial indicator for understanding river morphology and bed evolution under the impact of various interacting processes at present the identification of qd mainly depends on the analysis of a large number of hydrological data derived from measuring stations leading to difficulty in obtaining detailed qd distributions along the study reach in this paper qd is approximately expressed as the bed steadying discharge qs which is based on major factors of water level and sediment carrying capacity subsequently an integrated model combining a numerical fluid flow and sediment model with a deep learning algorithm is applied to analyze the changing process of the qs the flow and sediment transport processes are simulated by the calibrated mathematical model which are then adopted as the input sequences for the long short term memory lstm module the verification results of the established lstm model show robustness and accuracy in predicting the flow and sediment transport processes under multi stage incoming flow and sediment conditions furthermore the proposed integrated model is applied to identify the detailed process of qs in the middle huaihe river results show that the changing process of qs along the study reach is characterized by a particular trend of increase decrease rapid increase due to natural changes and human activities additionally the qs agrees well with qd at the hydrological station showing that qs can be applied as an approximation for qd along the study reach by analyzing longitudinal and transverse profiles the rationality of using qs as obtained by the newly presented model is demonstrated its temporal variation is also consistent with the cross sectional changes for the specified stations keywords dominant discharge numerical model lstm riverbed morphology huaihe river data availability the data that has been used is confidential 1 introduction natural rivers have continuously been subjected to significant adjustments in response to various processes such as flow dynamics sediment transport and human activities having an important role in water environment the adjustment of the riverbed determines the river s geometry especially the height of the riverbed and the concentration of the sediment that influences the quality of the water resources and the equilibrium state of the water environment in a river the dominant discharge qd is thus introduced in order to measure and quantify the bed forming effect by those processes pickup and warner 1976 qian et al 1987 generally qd is regarded as an essential parameter that determines major characteristics of the riverbed morphology where bed forming effects are caused by multi year average flow processes crowder and knapp 2005 qd is widely used in the fields of hydraulic structure design and river evolution analysis chen et al 2007 however due to a short duration and low values of the return period characteristic discharges such as of flood peak and mean flow are rarely discussed when studying the riverbed deformation this leads to a difficulty in reasonably determining the qd by hydrology based analysis in terms of long term evolution of river especially when encountering with a rapidly changing conditions of flow and incoming sediment loads yu et al 2010 owing to the different shapes of river cross sections the values of qd are influenced by the various geometries of the river along a reach it means that a specific discharge in a reach can lead to erosion in one sub reach while deposition at another sub reach therefore up to recently qd could be obtained only at locations where flow and sediment values were constantly measured and hence there is no available information on qd in many rivers not to mention the variations of qd along a reach this can limit not only the comprehensive understanding of the evolution of the riverbed morphology but also an efficient implementation of flood management and river engineering design for different sub reaches much effort has been made in exploring qd by analyzing long term discharge and sediment transport processes two typical methods the makayev method and the bankfull discharge method have been widely adopted in the last few decades bankfull discharge qb is the maximum discharge when the flow fills the whole main channel without flooding onto the floodplain wu et al 2007 which is considered as dominant discharge in the bankfull discharge method xia et al 2010 makayev considered the effect of sediment transport capacity the gradient ratio and frequency of the discharge occurrence and regarded the peak value of calculated curves as qd tan et al 2019 some new criteria or improved analyses based on the methods mentioned above have also been proposed wolman and miller 1960 proposed the geomorphological work curve that considers the sediment transport rate and took the flow corresponding to the maximum value of the curve as qd dunne and leopold 1978 considered qb as an important indicator in shaping and maintaining the riverbed morphology while simon et al 2004 suggested that the bankfull discharge method is only suitable for geometrically stable rivers ji et al 1994 regarded the discharge as qd when both the flow and the sediment concentration frequency reach the maximum lenzi et al 2006 defined two qd ranges including a frequent flow and infrequent high flow range for mountain rivers ferro and porto 2012 assumed qd as the discharge responsible for at least 50 of the total suspended sediment load which is close to the discharge with a recurrence interval of 1 5 years ward and moran 2016 adopted a statistical method to analyze the peak daily discharge records and confirmed that the actual frequency of qd occurrence was higher than that derived from traditional analysis hence the definitions of qd can differ in previous studies and all the above mentioned methods to obtain qd either require long term hydrological data or fail to consider the effect of the sediment transport additionally the accuracy of these methods for the river basin is also limited since only the qd at the hydrological station can be obtained while no clear conclusion can be given at other areas in detail furthermore although qd is used for quantifying the bed forming effect the physical interpretation of qd remains vague to some extent because various methods were developed for defining and obtaining the qd based on the navier stokes equations numerical models of the fluid flow can be applied to obtain the processes of hydraulic parameters of irregular topography in study areas zhao et al 1994 hu et al 2017 this can be regarded as a useful tool for getting information of a river usually for the rivers affected by the regulation and storage of connected lakes it is necessary to establish a large scale river lake coupled model 1d 2d coupling for simulating flow and sediment transport processes in river reaches tsakiris and bellos 2014 it is commonly recognized as a good practice to use a proven numerical model to acquire necessary information on hydrodynamic parameters and sediment transport for obtaining qd however this method can be highly computationally expensive and time consuming because classifying the flow process for a specified time interval may lead to hundreds of discharge levels kalita 2020 this means hundreds of numerical simulations have to be carried out if all of those discharge levels are considered by the numerical simulation therefore it is difficult and practically impossible to obtain the qd by the numerical model under all levels of discharge due to the time consuming cases and high computational cost in order to obtain the hydraulic and sediment parameters with high efficiency and low cost emerging deep learning techniques driven by big data can be embedded as has been successfully used in various fields in recent years deep learning techniques such as long short term memory model lstm have been gradually applied to the field of hydrometeorology and water conservancy such as weather forecasting shi et al 2015 zaytar and amrani 2016 reservoir regulation zhang et al 2018 qi et al 2019 and flood prediction hu et al 2019 in the field of sediment research traditional artificial intelligence and machine learning methods have been adopted to predict sediment parameters including sediment concentration lin and namin 2005 bhattacharya et al 2007 kumar et al 2016 total loads márquez and guevara pérez 2010 kumar et al 2014 roushangar and shahnazi 2020a and reservoir sediment management huang et al 2019 chang et al 2020 many studies demonstrated that deep learning could be used for predicting some information of the river with accuracy and efficiency however the sediment transport process often changes rapidly with strong temporal variation and features complex non linear characteristics li et al 2010 thus the traditional artificial intelligence model may yield results with relatively unsatisfying accuracy and robustness if the time history of flow and sediment transport processes is ignored in fact in the process of determining the discharge water level and suspended sediment concentrations ssc at a specific point of the river highly depend on upstream and past conditions roushangar and shahnazi 2019 what s more the relationships of s z and q z in a river of an increasing discharge are thoroughly different from those at a decreasing discharge which is a typical feature of river dynamics as a result the prediction of the process of the discharge water level and scc requires tackling the problem of how to learn the sequence data due to the capability in predicting variation of hydrodynamics and sediment parameters efficiently by learning the internal dependencies of long term sequences zhang et al 2018 nourani and behfar 2021 lstm is suitable to complement numerical models of fluid and sediment transport in order to analyze qd for large river basins this study is focused on evaluating the river bed deformation by obtaining qd with the following novelties 1 from the point of view of the basic physical interpretation of qd this study proposes the concept of bed steadying discharge qs compared with qd the qs has the definition based on a specific physical interpretation a critical discharge that determines the natural equilibrium state of the riverbed and the shape of the river cross section along the river 2 a novel integrated model that combines the numerical model with the lstm model which is developed to solve problems when it is too difficult to obtain sufficient data for obtaining qs and qd due to limited computational and time resources the lstm s sensitivity for hydrodynamic parameters is studied 3 the qs along the huaihe river with different sub reaches is obtained using two analytical methods the sequential analysis and the stepping analysis a further comparison between qs and qd is made and the results show that qs can be seen as an accurate approximation to obtain the distribution of qd along the reach of the huaihe river in terms of long term riverbed deformation this study introduces an integrated model of bed steady discharge and dominant discharge while applying to the middle huaihe river the application of the integrated model in the middle huaihe river is conducted to demonstrate the validity and practical reliability of the presented methods in this paper as illustrated in the flowchart of fig 1 in the first stage a numerical model coupling hydrodynamics and sediment transport is established and calibrated obtaining the simulated flow and sediment transport processes from 2013 to 2017 in the second stage the simulated results extracted from the numerical model are employed as input datasets for the purpose of training the lstm model two analytical methods sequential analysis and stepping analysis are proposed to obtain the range and representative value of qs respectively in addition the rationality of the obtained qs is discussed by analyzing planar and longitudinal profiles and the cross sectional changes of representative stations furthermore it is proved that the obtained qs is similar to qd that is obtained by traditional methods at hydrological stations that is to say the qs obtained by the present method can be used as a supplement or an approximation to the qd process along the river the contribution of this paper is expected to provide a general tool for efficiently and reasonably analyzing the detailed distribution of qd in river basins section 2 introduces the study area and the methodology section 3 presents the validation of the numerical and the lstm models section 4 gives the results of the integrated model and discusses the effects of qs and qd on riverbed deformation of the huaihe river 2 background and methodology 2 1 study area the huaihe river basin covers four provinces of china with an area of about 270 000 km2 the study area is the 180 km long sub reach in the middle reaches of the huaihe river fig 2 featured with deep channels and wide floodplains the cross section width varies from 0 8 to 5 0 km with the bankfull width ranging from 0 2 to 1 0 km owing to the intense human activities such as sand mining the riverbed elevation significantly changes significantly along the middle huaihe river with the water depth varying from 8 5 to 14 5 m liu et al 2012 in addition the sub reach downstream of xiaoliuxiang station enters into the hongze lake with an inverted gradient ratio resulting in complex river lake interactions tang et al 2020 the sediment moving in natural rivers can be divided into bed load and suspended load with the bed load moving near the riverbed and the suspended load moving with the water flow as the main component of total sediment load suspended load plays a decisive role in river bed evolution thus some researchers only considered the effect of suspended sediment in the analysis of river erosion and deposition wolman and miller 1960 simon et al 2004 deng et al 2019 as of the huaihe river the incoming sediment loads from the huaihe river have significantly decreased in recent years for example the annually mean sediment concentration at wujiadu station in 2017 is 0 091 kg m3 which decreased by 72 5 compared to the multi year average value of 0 332 kg m3 1950 2015 ejp 2017 in addition xiao et al 2015 found that for the huaihe river 93 of the total sediment load belongs to suspended sediment featured with fine grained and cohesive characteristics therefore only suspended sediment transport is considered in this study under the conditions of a rapidly changing flow sediment factors and excessive human activities the qd analysis for the middle huaihe river is crucial for understanding the topographic conditions and the evolution trend 2 2 definition of bed steadying discharge in essence the dominant discharge qd can be regarded as the flow parameter controlling the shape of the riverbed thus when discharge of a cross section is equivalent to the qd a state of balance between scour and deposition should be achieved therefore qd can be related to the water level and sediment concentration 1 when the water level of the cross section is close to the bank full stage the flow approximately fills the main channel which forms the basis of shaping the cross section 2 when the sediment concentration is close to the sediment carrying capacity the cross section shows an approximate balance of erosion and deposition in order to maintain the shape of the riverbed based on the two major factors of water level and sediment carrying capacity this paper proposes the concept of qs and establishes the parameter error pe formulation as the mathematical expression of qd the minimum of the pe corresponds to the situation that the water level is similar to the bankfull stage and having a balance between erosion and deposition with the discharge at the cross section being regarded as the qs consequently qs is obtained under the equilibrium condition of the riverbed shape which is similar to the qd the pe can be described as follows 1 goal m i n z sim z bf δ z max 2 s sim s cp δ s max 2 where z sim and z bf represent the simulated and bankfull stage respectively s sim and s cp represent the simulated sediment concentration and sediment carrying capacity respectively δ z max is the maximum difference between the simulated and bankfull stage and δ s max is the maximum difference between the simulated sediment concentration and carrying capacity because of the large difference between the order of magnitude of the water level and sediment concentration a normalization method is adopted to make the two factors having the same numerical influence 2 3 numerical model interpretation in this paper the process of water and sediment movement used for the lstm is obtained by means of a numerical simulation therefore it is necessary to generalize the study area into an appropriate numerical model the middle reaches of the huaihe river feature with complex variation of riverbed coupled with significant interactions between the huaihe river and the hongze lake leading to an urgent need for analyzing flow and sediment transport characteristics on the basis of considering the influence caused by river lake interactions the 1d 2d coupled hydrodynamic model zhang et al 2020 for the middle reaches of the huaihe river is adopted as the fundamental tool with the sediment transport module being added in this work it couples 1d and 2d models by proposing the coupling zone iteration correction method to minimize the errors when transferring hydraulic parameters in the coupling zone for the 1d model the saint venant equations are adopted to govern flows in river network while for the 2d model the shallow water equations are applied to simulate lake hydrodynamics the preissmann four point implicit scheme and roe scheme based on the approximate riemann solver are used to discretize and solve the above two models respectively a module for simulating non uniform suspended sediment transport is added in both the 1d and 2d models with governing equations for sediment transport being solved by the explicit scheme xia et al 2015 due to the cohesion of fine grained sediment in the huaihe river flocculated settling velocity richardson and zaki 1954 are calculated the transport capacity for each fraction is determined by the sediment carrying capacity zhang 1998 which can be obtained according to the corresponding percentage of suspended sediment in the current study the middle huaihe river is generalized in around 300 cross sections with the spatial interval varying from 0 3 to 1 5 km which are derived from the topographic survey in 2013 five sampled fractions obtained from the sand analysis by li et al 2017 are used to simulate the transport process of non uniform suspended sediment the upstream and downstream boundaries of the numerical model are set at wujiadu and laozishan stations respectively with the measured flow and sediment transport processes being given in addition the model also takes into account the lateral inflow and sediment loads of the chihe river as shown in fig 2 seven stations are selected for the qs analysis including the two hydrological stations wujiadu and xiaoliuxiang and five water level gauging stations linhuaiguan wuhe fushan xuyi and laozishan 2 4 lstm model description compared with the traditional recurrent neural networks lstm has an additional memory system for processing temporal sequence inputs not only are the weights and biases transferred as the traditional recurrent neural networks but also the long term predictive results in the previous time steps are adopted for predicting the current time step the operation of the memory system to save or partially forget information is determined by continually inputting the temporal information into lstm in the training process the kernel structure of lstm is shown in fig 3 xn is the input data at nth time step hn is the output obtained by the lstm cell the memory unit is controlled by three gates the input gate the forget gate and the output gate with the mathematical representation being written in the following equations 2 i n σ w i x n u i h n 1 b i f n σ w f x n u f h n 1 b f o n σ w o x n u o h n 1 b o the equations for updating and outputting cell state are as follows 3 c n tanh w c x n u c h n 1 b c c n f n c n 1 i n c n h n o n tanh c n where fn in and on represent the forget input and output gates respectively with the subscript n and n 1 denoting the previous and current time step respectively w u and b are parameters for weights and bias for each of the gates and cells c and c represent the cell state stored in lstm memory and updated state respectively σ x 1 1 e x and tanh x ex e x ex e x are the sigmoid function and the hyperbolic tangent function the input gate controls whether the information in the current step can enter the memory unit or not while the forget gate determines whether the previous information needs to be partially forgotten and the output gate selects the current outputs that will be transmitted into the prediction for next time step hu et al 2019 through the control of the above gates the information in the memory unit is continuously refreshed in the training process until the outputs could be predicted reasonably 3 verification of the integrated model 3 1 calibrating the numerical model results of the numerical simulation will be input into the lstm model for the training process which will directly affect the accuracy of the predicted results thus it is essential to properly select the representative flow and sediment transport processes for verifying the numerical model in 2015 a regional flood occurred with the peak discharge and sediment load three times and five times than that of 2013 respectively fig 4 the flow and sediment transport processes in 2013 and 2015 are adopted to verify the numerical model in the flood and dry year respectively and the nash sutcliffe efficiency nse coefficient is introduced to estimate the model performance nash and sutcliffe 1970 all the nse coefficients and the averaged relative errors of different verification cases are summarized in the table 1 fig 5 shows the water level time histories at the linhuaiguan and xuyi stations during 2013 with nse coefficients of 0 993 and 0 995 corresponding to the averaged relative errors about 0 23 and 0 18 respectively the model is further applied to the flooding process in 2015 with the calculated water level processes of the above two stations shown in fig 6 and the nse coefficients are 0 992 and 0 990 corresponding to the averaged relative errors about 0 24 and 0 31 respectively it can be seen that the numerical results agree well with the corresponding measurements for dry and flood hydrological years in order to calibrate the sediment transport module it is necessary to determine the recovery coefficient and empirical coefficients of the transport capacity formula the sediment carrying capacity is determined by the coefficient β and m fang and wang 2000 after several trial calculations the ranges of β and m of the sediment carrying capacity formula are determined to be from 0 02 to 0 7 and 0 2 to 0 5 respectively with the recovery coefficient 0 25 and 0 1 for the case of erosion and deposition respectively the sediment transport processes of xiaoliuxiang in 2013 and 2015 are shown in fig 7 with the nse coefficients 0 989 and 0 956 corresponding to the relative errors about 0 51 and 1 2 respectively and the error of the peak of the ssc is about 12 in 2015 which is accurate enough for engineering requirement the numerical simulation agrees well with the observed value especially from the june to september when the huaihe experienced its flood peak a little difference can be found before june because the ssc is so small that inevitable errors of measuring and simulation cannot be neglected but it will not influence the discussion of qs from engineering view it can be concluded that the present model is considered to be able to accurately simulate the variation trend of flow condition and sediment concentration in the case of rapidly changing process of boundary conditions 3 2 validating the lstm model since the qd analysis is based on the flow and sediment transport processes under each discharge level the wujiadu inflow is taken as the input dataset to obtain the other required results at the representative locations through the lstm in this study the data from 2013 to 2017 are used for training and testing the lstm the relationship of s z and q z are indeed affected by the river geometry but there is no obvious change of riverbed along the huaihe from 2013 to 2017 with the view of hydraulic engineering there is also little human activity such as sand mining that has affected the processes of flow and sediment during those 5 years this ensures that the established lstm based on the 5 years data can predict the long term natural evolution of the river the simulated results from 2013 to 2016 obtained by the numerical model are adopted for the training process to validate the predictability of lstm the discharge process of wujiadu in 2017 an upstream station of the study area is put into the lstm model and a comparison between the predicted results observed values and the simulated hydrodynamic and sediment transport processes is carried out in this study the number of the units in the hidden layers in the lstm are set as 128 and the total training step is set as 70 times that is sufficient for convergence because the mse is less than 1 0e 4 on the training set the training set contains 729 7 3 data and the test set contains 365 7 3 data sequence length station number hydrodynamic parameter both of which is in the period from 2013 to 2016 the conditions for the controlled gate the weights and basis in the eqs 2 and 3 are automatically optimized by the adaptive moment estimation ame it has been shown that the learning rate plays the most important role in the optimization of the lstm s training and prediction with ame kaveh et al 2021 roushangar and shahnazi 2020b a parametric sensitivity study of the learning rate is carried out as based on the water levels observed at six stations in 2017 namely lhg wh fs xlx xy lzs those data are chosen as a test set to clarify the preformation of lstm for predicting the hydrodynamic parameters with a different learning rate in this study an exponential decay of the learning rate during the training process is employed yielding at 4 η i η 0 θ t i t 0 where η0 and ηi are the initial learning rate and at the ith step learning rate t0 and ti are the total number of training steps and at the ith step respectively and θ is the decay rate comparisons of the lstm prediction and the observed data in the test set with different θ and η0 are listed in table 2 it can be found that the initial learning rate plays a significant role in optimizing the lstm when based on the given data the optimal value of η0 in this study ranges from 1 0e to 4 to 1 0e 5 in the case of η0 1 0e 6 the averaged errors grow significantly because of the small learning rate the decay rate θ influences the accuracy at a specific η0 in this parameter sensitivity study it is found that the two sets of combination of the parameters one set of η0 1 0e 4 and θ 0 1 another set of η0 1 0e 5 and θ 0 08 makes the lstm perform well on the test data in terms of both the small average of the errors over six stations avg and the small standard deviation of errors over the whole stations std as a result η0 1 0e 5 and θ 0 08 are employed in the lstm in this study and other results of lstm on the test data are shown as followed the observed data of water levels and discharges at lzs lhg xlx in 2017 are compared with the lstm results based on the parameters as seen in the fig 8 the numerical simulations results for the water level ssc discharge of all the seven stations in the study area are compared with the lstm results in fig 9 fig 8 shows the comparison of predicted data against the observed data in 2017 it can be found that the predicted data agree well with the observed data generally and are highly consistent with the observed data in lzs and xlx it is seen that not all the scatters in fig 8b gather near the base line in the case of a very high water level which reveals that the accuracy of the lstm decreases when predicting the peak of the sequence in a multimodal process the process of the water level at lhg can be seen in fig 9c despite little differences most of the scatters are near the base line which means that those parameters and training data employed in the lstm are able to train the lstm to yield an effective prediction of the water level ssc and discharge fig 9 shows further test data of the lstm the comparisons between the predicted results and the simulated values for all the seven stations in terms of discharge water level and suspended sediment concentration ssc generally lstm shows a good performance in predicting flow and sediment parameters with the provided unsteady inflow sequences the prediction of the discharge and water level are more accurate than that of ssc the nse coefficients of the predicted discharge vary from 0 95 to 0 98 and the nse coefficients of water level range between 0 94 and 0 98 it should be noted that the predictive accuracy of the water level is relatively less satisfactory in the dry period early and late july due to the mismatched trend between the rapidly decreased water level and a constantly low discharge the lstm also gives a satisfactory prediction of sscs with the nse coefficients ranging from 0 90 to 0 96 except for the nse value of around 0 80 at wujiadu and linhuaiguan this disagreement can partly result from the different process of ssc in wujiadu as compared to other locations especially in the occurrence period of the peak value of ssc as indicated in fig 9 b the measured ssc peak in wujiadu occurred on 9th july with a relatively small peak occurring on 4th october while the other stations showed only one distinct ssc peak in the middle of october furthermore linhuaiguan is directly affected by the sediment loads derived from wujiadu which also leads to an insufficient ssc prediction by the lstm model however the overall trend of sediment transport is consistent with simulated results at all locations with the absolute error of ssc ranging between 0 06 kg m3 and 0 22 kg m3 indicating that the lstm model can reasonably predict the sediment transport processes of each station which can be further used for the qd analysis 4 bed steadying discharge analysis for the middle huaihe river 4 1 range of bed steadying discharge owing to the loop like discharge water level q h relationship the middle huaihe river shows a different flow feature during the rising and recession periods indicating that a certain water level usually corresponds to multi values of discharges therefore based on previous studies on the qd of the huaihe river a similar method is used to estimate the range of the bed steadying discharge a stair step discharge process is set to rise from 2000 m3 s to 5000 m3 s and then fall back to 2000 m3 s with each step level 50 m3 s consequently the length of the discharge sequence is 121 in summary the input of the lstm in this section is a stair step discharge process and the length of the corresponding sequence is 121 by inputting the above discharge sequence into the lstm model the water level ssc s z relationship of the seven stations can be predicted as shown in fig 10 the scatters are the numerical results with the stair step discharge boundary condition it can be seen that the s z relationship obtained from the numerical simulation fluctuated apparently making it difficult to be used for estimating the qs moreover the s z relationship in the process of increasing discharge is different from that in decrease of the discharge which also leads to seemingly irregular scatters in the fig 10 while the lstm predicted ssc under each water level is limited into a specific range that can be easily used to calculate the pe value in eq 1 with the pe curve shown in fig 10 it is noted that the lowest point of the curve indicates the minimum pe value when the water level is close to the bankfull stage and the difference between the ssc and the sediment carrying capacity is small the water level that makes the pe reach the minimum is defined as the bed steading water level zs in which the discharge of the river corresponds to the discharge of qs as shown in table 3 as can be seen in table 3 the zs is generally lower than the bankfull water level zbf for most locations which is similar to the conclusions of pickup and warner 1976 this phenomenon may be explained as follows when the water level reaches the bankfull stage the sediment transport capacity will be higher than the sediment concentration due to the significant decrease of incoming sediment loads which may lead to continuous erosion and disequilibrium state for bed evolution after taking the upper and lower limits of the predicted water level by lstm at each discharge level the discharge water level q z relationship is shown in fig 11 it can be found that there are also fluctuations of the q z relationship obtained by the numerical simulation but the difference of q z relationship when it comes to an increasing or decreasing discharge can be roughly observed from the scatters the predicted results of lstm are smoother than those of numerical simulations and can be used for estimating the qs the zs obtained in the s z relationship corresponds to the qs range according to the q z relationship as shown in table 4 it can be seen that the range of qd from wujiadu to fushan given by this study coincides with previous studies and shows an increasing trend downstream of xiaoliuxiang additionally the qs range of wujiadu calculated in this paper coincides with the qd obtained by yu et al which is close to that yielded by the makayev method while the qs range of xiaoliuxiang is close to that based on bankfull discharge method hence it can be concluded that the proposed method is capable of correctly characterize the changing trend of qs ranges and is within a good agreement with qd this points that qs can be used as a tool to understand and approximate the variation of the qd along the river 4 2 representative value of bed steadying discharge section 4 1 gave the ranges of qs as based on the actual unsteady state flow conditions of the middle huaihe river so to compare the qs with the dominant discharge qd in fact the representative value of qs of each location is commonly calculated for the steady condition for different inflow levels in order to achieve this purpose the input sequence for the lstm should have a characteristic of a constant for each predictive step in this section many constant sequences are set with a length of 10 and each sequence has only one specific value of discharge the values of the discharges of those sequences range from 2000 m3 s to 5000 m3 s with each step level of 50 m3 s consequently 61 sequences established in total that is to say the inputs of the lstm are 61 constant sequences of different values with a length of 10 when those sequences are input into the trained lstm model the lstm will regard them as constant because the length of the window sequence of the lstm model established in this paper is set as 7 which is less than the lengths of those sequences that is to say the lstm can predict flow and sediment parameters in the constant input for each predictive step then the corresponding averaged hydrodynamic values and ssc of each inflow level are calculated as the final predicted result of each inflow level with the corresponding subsequent calculated pe value finally the discharge corresponding to the minimum pe value is considered as the representative value of qs the prediction of water and sediment of representative stations under steady flow conditions namely the average of the predicted value of the lstm model over a specific discharge are obtained as shown in fig 12 it can be seen that all the water levels and ssc can be well predicted at each level of discharges this efficient predictive ability of lstm greatly saves the calculation cost the results also show that the q z relationship based on the steady condition for different inflow levels is different from the stair step unsteady state flow conditions given in section 4 1 furthermore the predicted water levels and sscs with different discharges can be used to calculate pe according to the eq 1 to obtain the representative value of qs the plots of pe as varying with different discharge at each station are given in fig 13 as shown in fig 13 the pe curve shows prominent parabolic characteristics the pe value firstly decreases for a small discharge and then increases dramatically with the discharge growth due to the fact that sediment transport capacity and water level increase rapidly with the discharge for each station the flow corresponding to the minimum value of the pe curve is still taken as qs as listed in table 5 the results show that the qs of wujiadu and xiaoliuxiang are 3600 m3 s and 3700 m3 s respectively which are little higher than the previous results of the qd in essence the sediment carried by the inflow in the middle huaihe river has obviously decreased in recent years and the cross section is significantly affected by dredging and excavation contributing to an increase of qd consequently the qs obtained for those two stations is not only in good agreement with previous results but also reveals a tendency of the riverbed to change in the recent few years the variation law of the qs along the study reach can be used as a reference and supplement the study of the qd 4 3 correlation analysis between riverbed geomorphology and bed steadying discharge a good similarity of qs and qd has been verified by comparing the qs obtained by the proposed method at a specific station with the qd an approximate substitution of qs for the qd can be used to understand and analyze the changing process of the qd along the study area it can be seen that the qd for the middle huaihe river does not show a monotonous increase trend but is characterized by a particular process of increase decrease rapid increase fig 14 the variation of the qd along the reach should be discussed together with the geometry of the reach shown in fig 15 fig 15 shows that generally a dramatic difference of riverbed level occurred in wujiadu and linhuaiguan and there is a significant inverse gradient ratio in the downstream of xiaoliuxiang which was significantly different from most of the other natural rivers the results of figs 14 and 15 are further discussed for each sub reach as follows i the riverbed level of wujiadu and linhuaiguan is much lower than the corresponding average bed elevation which is contrary to the natural trend of the bed evolution the reason for this phenomenon may be that the artificial sand mining exerts a dramatic impact on the sub reach where wujiadu and linhuaiguan are located ni et al 2020 leading to a rapid increase of cross sectional area and sediment transport capacity hence the corresponding qd increases accordingly and even exceeds that of the wuhe fushan sub reach downstream of linhuaiguan ii wuhe and xiaoliuxiang are located in the transitional sub reach near the entrance of the hongze lake and their riverbeds are featured with a relatively stable evolution trend that is mainly dominated by environmental changes as a result the calculated qd within this sub reach shows a trend of steady increase however the width between the left and right levees reduced about 0 3 to 0 5 km less than of wujiadu that is located in the upstream reach this reduction makes the discharge capacity obviously decrease leading to lower values of qd obtained for wuhe xiaoliuxiang sub reach correspondingly iii the reach of xiaoliuxiang where wide floodplains and farmdikes are located having the lowest riverbed in the study area as seen in the zone iv from fig 15 the cross sectional width of xiaoliuxiang expands rapidly and reaches nearly 5 km the riverbed is significantly characterized by an inverted gradient ratio leading to the weakening of hydrodynamic conditions and relatively frequent sediment deposition therefore the calculated qd of the tail sub reach downstream of xiaoliuxiang shows a significant increase compared to that of the upstream locations by combining the riverbed characteristics for each sub reach and the qd process it can be concluded that the value of qd obviously increases with the increase of the cross sectional area caused by natural erosion or dramatic human activities such as sand mining and bank retreat works in addition the changing trend of qd is consistent with the riverbed morphology along the study reach which confirms the reasonability of obtained results in this paper as discussed in section 4 2 the calculated value of qd of wujiadu and xiaoliuxiang is higher than of yu et al 2010 which was based on the hydrological data from 1950 to 2007 in order to prove the rationality of the difference between the obtained results and the previous study the cross sectional profile in 2007 and 2013 at the above two stations are compared as shown in fig 16 from the comparison of the transverse profile in fig 16 a it can be seen that in 2013 the cross section of wujiadu showed a downward cutting trend with the incision position close to the left side of the main trough in addition the lowest point obviously shifted left under the influence of sand mining with the mining depth reached from 5 to 6 m xiaoliuxiang is characterized by a typical u shape cross section with relatively stable variation in recent years compared with the topographic survey in 2007 the change of xiaoliuxiang s cross section was recognized as slight erosion and the scouring position is near the channel fig 16 b therefore it can be concluded that the cross sectional areas of the two stations have significantly become large due to different reasons wujiadu is mainly affected by artificial sand mining while xiaoliuxiang is mainly due to natural erosion therefore having the values of the calculated qd at two stations being larger than that of 2007 is also consistent with the cross sectional change it can be concluded that despite the fact that qd is determined by the water level and ssc the spatio temporal change of qd along the reach is involved in several controlling factors including natural evolution river geometry and human activities therefore much effort is still required to progress the understanding and quantification of the internal effects of these factors on qd 5 conclusions based on the two factors of water level and sediment carrying capacity this paper puts forward the concept of qs which is similar to that of the mathematical interpretation ofqd subsequently a novel integrated model encompassing a numerical model and an lstm model is presented to obtain the spatial distribution of qs as an approximation and supplement to the variation of qd along the river compared to the traditional analysis methods less hydrological data and numerical cost are needed and a more detailed changing process of qd along the study reach can be obtained a parameter sensitivity on lstm is carried out and the qd is obtained by the proposed integrated model with the changing trend of river morphology additionally the representative value of qd varies along the study reach implying that investigating in details the varying process of qd is essential in order to understand the spatial temporal bed evolution under various time changing topographic and hydrodynamic conditions the proposed integrated model thus offers a robust tool for identifying the detail ed spatial variations of qd in river basins efficiently and reasonably the following conclusions can be draw from this study 1 by calibrating and verifying the model with the measurements in 2013 and 2015 the established numerical model can reproduce the flow and sediment transport processes accurately furthermore the simulated results of selected seven locations from 2013 to 2016 are adopted for training the lstm model the sensitivity study and the validation cases show that lstm can predict the hydrodynamic parameters and sediment transport with high accuracy and efficiency 2 the proposed integrated model is applied to analyzing the qs of the middle huaihe river based on the s z and q z relationship predicted by lstm the range of qs can be obtained by selecting the flow range corresponding to the water level with the minimum parameter error pe considering the steady flow conditions the representative value of qs for each location are further obtained the results show that the qs at specific stations is similar to the qd indicating that qs can be approximately used to understand the changing process of the qd along the river reach 3 the changing process of qd along the middle huaihe river is featured with a particular trend of increase decrease rapid increase through the correlation analysis between the qd and the planar and longitudinal profiles it is found that the cross sections along the middle huaihe river have expanded to different extent due to artificial sand mining or natural erosion in addition the obvious inverse gradient ratio downstream from xiaoliuxiang also leads to a rapid increase of qd through the above analysis it can be seen that the obtained spatial temporal process of qd is consistent with the riverbed morphology along the study reach and cross sectional changes for specified stations this study provides a method to obtain the qd and qs by integrating 1d 2d fluid sediment transport numerical simulations with lstm leading to an efficient and effective tool the established lstm preforms well on predicting hydrodynamics in the huaihe river and the general application of deep learning on river engineering deserves further study credit authorship contribution statement jin xu data curation methodology formal analysis writing review editing visualization chengxiao zhang resources software writing original draft formal analysis investigation lingling wang funding acquisition writing review editing supervision hai zhu validation hongwu tang funding acquisition supervision eldad j avital funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national key r d program of china grant no 2022yfc3200032 grant no 2021yfc3200403 the national natural science foundation of china grant no 51879086 the fundamental research funds for the central universities b200204044 research funding of china three gorges corporation 202003251 and the royal society grant iec nsfc 181425 
3027,river morphology plays an important role in water environment and resources the dominant discharge qd is a crucial indicator for understanding river morphology and bed evolution under the impact of various interacting processes at present the identification of qd mainly depends on the analysis of a large number of hydrological data derived from measuring stations leading to difficulty in obtaining detailed qd distributions along the study reach in this paper qd is approximately expressed as the bed steadying discharge qs which is based on major factors of water level and sediment carrying capacity subsequently an integrated model combining a numerical fluid flow and sediment model with a deep learning algorithm is applied to analyze the changing process of the qs the flow and sediment transport processes are simulated by the calibrated mathematical model which are then adopted as the input sequences for the long short term memory lstm module the verification results of the established lstm model show robustness and accuracy in predicting the flow and sediment transport processes under multi stage incoming flow and sediment conditions furthermore the proposed integrated model is applied to identify the detailed process of qs in the middle huaihe river results show that the changing process of qs along the study reach is characterized by a particular trend of increase decrease rapid increase due to natural changes and human activities additionally the qs agrees well with qd at the hydrological station showing that qs can be applied as an approximation for qd along the study reach by analyzing longitudinal and transverse profiles the rationality of using qs as obtained by the newly presented model is demonstrated its temporal variation is also consistent with the cross sectional changes for the specified stations keywords dominant discharge numerical model lstm riverbed morphology huaihe river data availability the data that has been used is confidential 1 introduction natural rivers have continuously been subjected to significant adjustments in response to various processes such as flow dynamics sediment transport and human activities having an important role in water environment the adjustment of the riverbed determines the river s geometry especially the height of the riverbed and the concentration of the sediment that influences the quality of the water resources and the equilibrium state of the water environment in a river the dominant discharge qd is thus introduced in order to measure and quantify the bed forming effect by those processes pickup and warner 1976 qian et al 1987 generally qd is regarded as an essential parameter that determines major characteristics of the riverbed morphology where bed forming effects are caused by multi year average flow processes crowder and knapp 2005 qd is widely used in the fields of hydraulic structure design and river evolution analysis chen et al 2007 however due to a short duration and low values of the return period characteristic discharges such as of flood peak and mean flow are rarely discussed when studying the riverbed deformation this leads to a difficulty in reasonably determining the qd by hydrology based analysis in terms of long term evolution of river especially when encountering with a rapidly changing conditions of flow and incoming sediment loads yu et al 2010 owing to the different shapes of river cross sections the values of qd are influenced by the various geometries of the river along a reach it means that a specific discharge in a reach can lead to erosion in one sub reach while deposition at another sub reach therefore up to recently qd could be obtained only at locations where flow and sediment values were constantly measured and hence there is no available information on qd in many rivers not to mention the variations of qd along a reach this can limit not only the comprehensive understanding of the evolution of the riverbed morphology but also an efficient implementation of flood management and river engineering design for different sub reaches much effort has been made in exploring qd by analyzing long term discharge and sediment transport processes two typical methods the makayev method and the bankfull discharge method have been widely adopted in the last few decades bankfull discharge qb is the maximum discharge when the flow fills the whole main channel without flooding onto the floodplain wu et al 2007 which is considered as dominant discharge in the bankfull discharge method xia et al 2010 makayev considered the effect of sediment transport capacity the gradient ratio and frequency of the discharge occurrence and regarded the peak value of calculated curves as qd tan et al 2019 some new criteria or improved analyses based on the methods mentioned above have also been proposed wolman and miller 1960 proposed the geomorphological work curve that considers the sediment transport rate and took the flow corresponding to the maximum value of the curve as qd dunne and leopold 1978 considered qb as an important indicator in shaping and maintaining the riverbed morphology while simon et al 2004 suggested that the bankfull discharge method is only suitable for geometrically stable rivers ji et al 1994 regarded the discharge as qd when both the flow and the sediment concentration frequency reach the maximum lenzi et al 2006 defined two qd ranges including a frequent flow and infrequent high flow range for mountain rivers ferro and porto 2012 assumed qd as the discharge responsible for at least 50 of the total suspended sediment load which is close to the discharge with a recurrence interval of 1 5 years ward and moran 2016 adopted a statistical method to analyze the peak daily discharge records and confirmed that the actual frequency of qd occurrence was higher than that derived from traditional analysis hence the definitions of qd can differ in previous studies and all the above mentioned methods to obtain qd either require long term hydrological data or fail to consider the effect of the sediment transport additionally the accuracy of these methods for the river basin is also limited since only the qd at the hydrological station can be obtained while no clear conclusion can be given at other areas in detail furthermore although qd is used for quantifying the bed forming effect the physical interpretation of qd remains vague to some extent because various methods were developed for defining and obtaining the qd based on the navier stokes equations numerical models of the fluid flow can be applied to obtain the processes of hydraulic parameters of irregular topography in study areas zhao et al 1994 hu et al 2017 this can be regarded as a useful tool for getting information of a river usually for the rivers affected by the regulation and storage of connected lakes it is necessary to establish a large scale river lake coupled model 1d 2d coupling for simulating flow and sediment transport processes in river reaches tsakiris and bellos 2014 it is commonly recognized as a good practice to use a proven numerical model to acquire necessary information on hydrodynamic parameters and sediment transport for obtaining qd however this method can be highly computationally expensive and time consuming because classifying the flow process for a specified time interval may lead to hundreds of discharge levels kalita 2020 this means hundreds of numerical simulations have to be carried out if all of those discharge levels are considered by the numerical simulation therefore it is difficult and practically impossible to obtain the qd by the numerical model under all levels of discharge due to the time consuming cases and high computational cost in order to obtain the hydraulic and sediment parameters with high efficiency and low cost emerging deep learning techniques driven by big data can be embedded as has been successfully used in various fields in recent years deep learning techniques such as long short term memory model lstm have been gradually applied to the field of hydrometeorology and water conservancy such as weather forecasting shi et al 2015 zaytar and amrani 2016 reservoir regulation zhang et al 2018 qi et al 2019 and flood prediction hu et al 2019 in the field of sediment research traditional artificial intelligence and machine learning methods have been adopted to predict sediment parameters including sediment concentration lin and namin 2005 bhattacharya et al 2007 kumar et al 2016 total loads márquez and guevara pérez 2010 kumar et al 2014 roushangar and shahnazi 2020a and reservoir sediment management huang et al 2019 chang et al 2020 many studies demonstrated that deep learning could be used for predicting some information of the river with accuracy and efficiency however the sediment transport process often changes rapidly with strong temporal variation and features complex non linear characteristics li et al 2010 thus the traditional artificial intelligence model may yield results with relatively unsatisfying accuracy and robustness if the time history of flow and sediment transport processes is ignored in fact in the process of determining the discharge water level and suspended sediment concentrations ssc at a specific point of the river highly depend on upstream and past conditions roushangar and shahnazi 2019 what s more the relationships of s z and q z in a river of an increasing discharge are thoroughly different from those at a decreasing discharge which is a typical feature of river dynamics as a result the prediction of the process of the discharge water level and scc requires tackling the problem of how to learn the sequence data due to the capability in predicting variation of hydrodynamics and sediment parameters efficiently by learning the internal dependencies of long term sequences zhang et al 2018 nourani and behfar 2021 lstm is suitable to complement numerical models of fluid and sediment transport in order to analyze qd for large river basins this study is focused on evaluating the river bed deformation by obtaining qd with the following novelties 1 from the point of view of the basic physical interpretation of qd this study proposes the concept of bed steadying discharge qs compared with qd the qs has the definition based on a specific physical interpretation a critical discharge that determines the natural equilibrium state of the riverbed and the shape of the river cross section along the river 2 a novel integrated model that combines the numerical model with the lstm model which is developed to solve problems when it is too difficult to obtain sufficient data for obtaining qs and qd due to limited computational and time resources the lstm s sensitivity for hydrodynamic parameters is studied 3 the qs along the huaihe river with different sub reaches is obtained using two analytical methods the sequential analysis and the stepping analysis a further comparison between qs and qd is made and the results show that qs can be seen as an accurate approximation to obtain the distribution of qd along the reach of the huaihe river in terms of long term riverbed deformation this study introduces an integrated model of bed steady discharge and dominant discharge while applying to the middle huaihe river the application of the integrated model in the middle huaihe river is conducted to demonstrate the validity and practical reliability of the presented methods in this paper as illustrated in the flowchart of fig 1 in the first stage a numerical model coupling hydrodynamics and sediment transport is established and calibrated obtaining the simulated flow and sediment transport processes from 2013 to 2017 in the second stage the simulated results extracted from the numerical model are employed as input datasets for the purpose of training the lstm model two analytical methods sequential analysis and stepping analysis are proposed to obtain the range and representative value of qs respectively in addition the rationality of the obtained qs is discussed by analyzing planar and longitudinal profiles and the cross sectional changes of representative stations furthermore it is proved that the obtained qs is similar to qd that is obtained by traditional methods at hydrological stations that is to say the qs obtained by the present method can be used as a supplement or an approximation to the qd process along the river the contribution of this paper is expected to provide a general tool for efficiently and reasonably analyzing the detailed distribution of qd in river basins section 2 introduces the study area and the methodology section 3 presents the validation of the numerical and the lstm models section 4 gives the results of the integrated model and discusses the effects of qs and qd on riverbed deformation of the huaihe river 2 background and methodology 2 1 study area the huaihe river basin covers four provinces of china with an area of about 270 000 km2 the study area is the 180 km long sub reach in the middle reaches of the huaihe river fig 2 featured with deep channels and wide floodplains the cross section width varies from 0 8 to 5 0 km with the bankfull width ranging from 0 2 to 1 0 km owing to the intense human activities such as sand mining the riverbed elevation significantly changes significantly along the middle huaihe river with the water depth varying from 8 5 to 14 5 m liu et al 2012 in addition the sub reach downstream of xiaoliuxiang station enters into the hongze lake with an inverted gradient ratio resulting in complex river lake interactions tang et al 2020 the sediment moving in natural rivers can be divided into bed load and suspended load with the bed load moving near the riverbed and the suspended load moving with the water flow as the main component of total sediment load suspended load plays a decisive role in river bed evolution thus some researchers only considered the effect of suspended sediment in the analysis of river erosion and deposition wolman and miller 1960 simon et al 2004 deng et al 2019 as of the huaihe river the incoming sediment loads from the huaihe river have significantly decreased in recent years for example the annually mean sediment concentration at wujiadu station in 2017 is 0 091 kg m3 which decreased by 72 5 compared to the multi year average value of 0 332 kg m3 1950 2015 ejp 2017 in addition xiao et al 2015 found that for the huaihe river 93 of the total sediment load belongs to suspended sediment featured with fine grained and cohesive characteristics therefore only suspended sediment transport is considered in this study under the conditions of a rapidly changing flow sediment factors and excessive human activities the qd analysis for the middle huaihe river is crucial for understanding the topographic conditions and the evolution trend 2 2 definition of bed steadying discharge in essence the dominant discharge qd can be regarded as the flow parameter controlling the shape of the riverbed thus when discharge of a cross section is equivalent to the qd a state of balance between scour and deposition should be achieved therefore qd can be related to the water level and sediment concentration 1 when the water level of the cross section is close to the bank full stage the flow approximately fills the main channel which forms the basis of shaping the cross section 2 when the sediment concentration is close to the sediment carrying capacity the cross section shows an approximate balance of erosion and deposition in order to maintain the shape of the riverbed based on the two major factors of water level and sediment carrying capacity this paper proposes the concept of qs and establishes the parameter error pe formulation as the mathematical expression of qd the minimum of the pe corresponds to the situation that the water level is similar to the bankfull stage and having a balance between erosion and deposition with the discharge at the cross section being regarded as the qs consequently qs is obtained under the equilibrium condition of the riverbed shape which is similar to the qd the pe can be described as follows 1 goal m i n z sim z bf δ z max 2 s sim s cp δ s max 2 where z sim and z bf represent the simulated and bankfull stage respectively s sim and s cp represent the simulated sediment concentration and sediment carrying capacity respectively δ z max is the maximum difference between the simulated and bankfull stage and δ s max is the maximum difference between the simulated sediment concentration and carrying capacity because of the large difference between the order of magnitude of the water level and sediment concentration a normalization method is adopted to make the two factors having the same numerical influence 2 3 numerical model interpretation in this paper the process of water and sediment movement used for the lstm is obtained by means of a numerical simulation therefore it is necessary to generalize the study area into an appropriate numerical model the middle reaches of the huaihe river feature with complex variation of riverbed coupled with significant interactions between the huaihe river and the hongze lake leading to an urgent need for analyzing flow and sediment transport characteristics on the basis of considering the influence caused by river lake interactions the 1d 2d coupled hydrodynamic model zhang et al 2020 for the middle reaches of the huaihe river is adopted as the fundamental tool with the sediment transport module being added in this work it couples 1d and 2d models by proposing the coupling zone iteration correction method to minimize the errors when transferring hydraulic parameters in the coupling zone for the 1d model the saint venant equations are adopted to govern flows in river network while for the 2d model the shallow water equations are applied to simulate lake hydrodynamics the preissmann four point implicit scheme and roe scheme based on the approximate riemann solver are used to discretize and solve the above two models respectively a module for simulating non uniform suspended sediment transport is added in both the 1d and 2d models with governing equations for sediment transport being solved by the explicit scheme xia et al 2015 due to the cohesion of fine grained sediment in the huaihe river flocculated settling velocity richardson and zaki 1954 are calculated the transport capacity for each fraction is determined by the sediment carrying capacity zhang 1998 which can be obtained according to the corresponding percentage of suspended sediment in the current study the middle huaihe river is generalized in around 300 cross sections with the spatial interval varying from 0 3 to 1 5 km which are derived from the topographic survey in 2013 five sampled fractions obtained from the sand analysis by li et al 2017 are used to simulate the transport process of non uniform suspended sediment the upstream and downstream boundaries of the numerical model are set at wujiadu and laozishan stations respectively with the measured flow and sediment transport processes being given in addition the model also takes into account the lateral inflow and sediment loads of the chihe river as shown in fig 2 seven stations are selected for the qs analysis including the two hydrological stations wujiadu and xiaoliuxiang and five water level gauging stations linhuaiguan wuhe fushan xuyi and laozishan 2 4 lstm model description compared with the traditional recurrent neural networks lstm has an additional memory system for processing temporal sequence inputs not only are the weights and biases transferred as the traditional recurrent neural networks but also the long term predictive results in the previous time steps are adopted for predicting the current time step the operation of the memory system to save or partially forget information is determined by continually inputting the temporal information into lstm in the training process the kernel structure of lstm is shown in fig 3 xn is the input data at nth time step hn is the output obtained by the lstm cell the memory unit is controlled by three gates the input gate the forget gate and the output gate with the mathematical representation being written in the following equations 2 i n σ w i x n u i h n 1 b i f n σ w f x n u f h n 1 b f o n σ w o x n u o h n 1 b o the equations for updating and outputting cell state are as follows 3 c n tanh w c x n u c h n 1 b c c n f n c n 1 i n c n h n o n tanh c n where fn in and on represent the forget input and output gates respectively with the subscript n and n 1 denoting the previous and current time step respectively w u and b are parameters for weights and bias for each of the gates and cells c and c represent the cell state stored in lstm memory and updated state respectively σ x 1 1 e x and tanh x ex e x ex e x are the sigmoid function and the hyperbolic tangent function the input gate controls whether the information in the current step can enter the memory unit or not while the forget gate determines whether the previous information needs to be partially forgotten and the output gate selects the current outputs that will be transmitted into the prediction for next time step hu et al 2019 through the control of the above gates the information in the memory unit is continuously refreshed in the training process until the outputs could be predicted reasonably 3 verification of the integrated model 3 1 calibrating the numerical model results of the numerical simulation will be input into the lstm model for the training process which will directly affect the accuracy of the predicted results thus it is essential to properly select the representative flow and sediment transport processes for verifying the numerical model in 2015 a regional flood occurred with the peak discharge and sediment load three times and five times than that of 2013 respectively fig 4 the flow and sediment transport processes in 2013 and 2015 are adopted to verify the numerical model in the flood and dry year respectively and the nash sutcliffe efficiency nse coefficient is introduced to estimate the model performance nash and sutcliffe 1970 all the nse coefficients and the averaged relative errors of different verification cases are summarized in the table 1 fig 5 shows the water level time histories at the linhuaiguan and xuyi stations during 2013 with nse coefficients of 0 993 and 0 995 corresponding to the averaged relative errors about 0 23 and 0 18 respectively the model is further applied to the flooding process in 2015 with the calculated water level processes of the above two stations shown in fig 6 and the nse coefficients are 0 992 and 0 990 corresponding to the averaged relative errors about 0 24 and 0 31 respectively it can be seen that the numerical results agree well with the corresponding measurements for dry and flood hydrological years in order to calibrate the sediment transport module it is necessary to determine the recovery coefficient and empirical coefficients of the transport capacity formula the sediment carrying capacity is determined by the coefficient β and m fang and wang 2000 after several trial calculations the ranges of β and m of the sediment carrying capacity formula are determined to be from 0 02 to 0 7 and 0 2 to 0 5 respectively with the recovery coefficient 0 25 and 0 1 for the case of erosion and deposition respectively the sediment transport processes of xiaoliuxiang in 2013 and 2015 are shown in fig 7 with the nse coefficients 0 989 and 0 956 corresponding to the relative errors about 0 51 and 1 2 respectively and the error of the peak of the ssc is about 12 in 2015 which is accurate enough for engineering requirement the numerical simulation agrees well with the observed value especially from the june to september when the huaihe experienced its flood peak a little difference can be found before june because the ssc is so small that inevitable errors of measuring and simulation cannot be neglected but it will not influence the discussion of qs from engineering view it can be concluded that the present model is considered to be able to accurately simulate the variation trend of flow condition and sediment concentration in the case of rapidly changing process of boundary conditions 3 2 validating the lstm model since the qd analysis is based on the flow and sediment transport processes under each discharge level the wujiadu inflow is taken as the input dataset to obtain the other required results at the representative locations through the lstm in this study the data from 2013 to 2017 are used for training and testing the lstm the relationship of s z and q z are indeed affected by the river geometry but there is no obvious change of riverbed along the huaihe from 2013 to 2017 with the view of hydraulic engineering there is also little human activity such as sand mining that has affected the processes of flow and sediment during those 5 years this ensures that the established lstm based on the 5 years data can predict the long term natural evolution of the river the simulated results from 2013 to 2016 obtained by the numerical model are adopted for the training process to validate the predictability of lstm the discharge process of wujiadu in 2017 an upstream station of the study area is put into the lstm model and a comparison between the predicted results observed values and the simulated hydrodynamic and sediment transport processes is carried out in this study the number of the units in the hidden layers in the lstm are set as 128 and the total training step is set as 70 times that is sufficient for convergence because the mse is less than 1 0e 4 on the training set the training set contains 729 7 3 data and the test set contains 365 7 3 data sequence length station number hydrodynamic parameter both of which is in the period from 2013 to 2016 the conditions for the controlled gate the weights and basis in the eqs 2 and 3 are automatically optimized by the adaptive moment estimation ame it has been shown that the learning rate plays the most important role in the optimization of the lstm s training and prediction with ame kaveh et al 2021 roushangar and shahnazi 2020b a parametric sensitivity study of the learning rate is carried out as based on the water levels observed at six stations in 2017 namely lhg wh fs xlx xy lzs those data are chosen as a test set to clarify the preformation of lstm for predicting the hydrodynamic parameters with a different learning rate in this study an exponential decay of the learning rate during the training process is employed yielding at 4 η i η 0 θ t i t 0 where η0 and ηi are the initial learning rate and at the ith step learning rate t0 and ti are the total number of training steps and at the ith step respectively and θ is the decay rate comparisons of the lstm prediction and the observed data in the test set with different θ and η0 are listed in table 2 it can be found that the initial learning rate plays a significant role in optimizing the lstm when based on the given data the optimal value of η0 in this study ranges from 1 0e to 4 to 1 0e 5 in the case of η0 1 0e 6 the averaged errors grow significantly because of the small learning rate the decay rate θ influences the accuracy at a specific η0 in this parameter sensitivity study it is found that the two sets of combination of the parameters one set of η0 1 0e 4 and θ 0 1 another set of η0 1 0e 5 and θ 0 08 makes the lstm perform well on the test data in terms of both the small average of the errors over six stations avg and the small standard deviation of errors over the whole stations std as a result η0 1 0e 5 and θ 0 08 are employed in the lstm in this study and other results of lstm on the test data are shown as followed the observed data of water levels and discharges at lzs lhg xlx in 2017 are compared with the lstm results based on the parameters as seen in the fig 8 the numerical simulations results for the water level ssc discharge of all the seven stations in the study area are compared with the lstm results in fig 9 fig 8 shows the comparison of predicted data against the observed data in 2017 it can be found that the predicted data agree well with the observed data generally and are highly consistent with the observed data in lzs and xlx it is seen that not all the scatters in fig 8b gather near the base line in the case of a very high water level which reveals that the accuracy of the lstm decreases when predicting the peak of the sequence in a multimodal process the process of the water level at lhg can be seen in fig 9c despite little differences most of the scatters are near the base line which means that those parameters and training data employed in the lstm are able to train the lstm to yield an effective prediction of the water level ssc and discharge fig 9 shows further test data of the lstm the comparisons between the predicted results and the simulated values for all the seven stations in terms of discharge water level and suspended sediment concentration ssc generally lstm shows a good performance in predicting flow and sediment parameters with the provided unsteady inflow sequences the prediction of the discharge and water level are more accurate than that of ssc the nse coefficients of the predicted discharge vary from 0 95 to 0 98 and the nse coefficients of water level range between 0 94 and 0 98 it should be noted that the predictive accuracy of the water level is relatively less satisfactory in the dry period early and late july due to the mismatched trend between the rapidly decreased water level and a constantly low discharge the lstm also gives a satisfactory prediction of sscs with the nse coefficients ranging from 0 90 to 0 96 except for the nse value of around 0 80 at wujiadu and linhuaiguan this disagreement can partly result from the different process of ssc in wujiadu as compared to other locations especially in the occurrence period of the peak value of ssc as indicated in fig 9 b the measured ssc peak in wujiadu occurred on 9th july with a relatively small peak occurring on 4th october while the other stations showed only one distinct ssc peak in the middle of october furthermore linhuaiguan is directly affected by the sediment loads derived from wujiadu which also leads to an insufficient ssc prediction by the lstm model however the overall trend of sediment transport is consistent with simulated results at all locations with the absolute error of ssc ranging between 0 06 kg m3 and 0 22 kg m3 indicating that the lstm model can reasonably predict the sediment transport processes of each station which can be further used for the qd analysis 4 bed steadying discharge analysis for the middle huaihe river 4 1 range of bed steadying discharge owing to the loop like discharge water level q h relationship the middle huaihe river shows a different flow feature during the rising and recession periods indicating that a certain water level usually corresponds to multi values of discharges therefore based on previous studies on the qd of the huaihe river a similar method is used to estimate the range of the bed steadying discharge a stair step discharge process is set to rise from 2000 m3 s to 5000 m3 s and then fall back to 2000 m3 s with each step level 50 m3 s consequently the length of the discharge sequence is 121 in summary the input of the lstm in this section is a stair step discharge process and the length of the corresponding sequence is 121 by inputting the above discharge sequence into the lstm model the water level ssc s z relationship of the seven stations can be predicted as shown in fig 10 the scatters are the numerical results with the stair step discharge boundary condition it can be seen that the s z relationship obtained from the numerical simulation fluctuated apparently making it difficult to be used for estimating the qs moreover the s z relationship in the process of increasing discharge is different from that in decrease of the discharge which also leads to seemingly irregular scatters in the fig 10 while the lstm predicted ssc under each water level is limited into a specific range that can be easily used to calculate the pe value in eq 1 with the pe curve shown in fig 10 it is noted that the lowest point of the curve indicates the minimum pe value when the water level is close to the bankfull stage and the difference between the ssc and the sediment carrying capacity is small the water level that makes the pe reach the minimum is defined as the bed steading water level zs in which the discharge of the river corresponds to the discharge of qs as shown in table 3 as can be seen in table 3 the zs is generally lower than the bankfull water level zbf for most locations which is similar to the conclusions of pickup and warner 1976 this phenomenon may be explained as follows when the water level reaches the bankfull stage the sediment transport capacity will be higher than the sediment concentration due to the significant decrease of incoming sediment loads which may lead to continuous erosion and disequilibrium state for bed evolution after taking the upper and lower limits of the predicted water level by lstm at each discharge level the discharge water level q z relationship is shown in fig 11 it can be found that there are also fluctuations of the q z relationship obtained by the numerical simulation but the difference of q z relationship when it comes to an increasing or decreasing discharge can be roughly observed from the scatters the predicted results of lstm are smoother than those of numerical simulations and can be used for estimating the qs the zs obtained in the s z relationship corresponds to the qs range according to the q z relationship as shown in table 4 it can be seen that the range of qd from wujiadu to fushan given by this study coincides with previous studies and shows an increasing trend downstream of xiaoliuxiang additionally the qs range of wujiadu calculated in this paper coincides with the qd obtained by yu et al which is close to that yielded by the makayev method while the qs range of xiaoliuxiang is close to that based on bankfull discharge method hence it can be concluded that the proposed method is capable of correctly characterize the changing trend of qs ranges and is within a good agreement with qd this points that qs can be used as a tool to understand and approximate the variation of the qd along the river 4 2 representative value of bed steadying discharge section 4 1 gave the ranges of qs as based on the actual unsteady state flow conditions of the middle huaihe river so to compare the qs with the dominant discharge qd in fact the representative value of qs of each location is commonly calculated for the steady condition for different inflow levels in order to achieve this purpose the input sequence for the lstm should have a characteristic of a constant for each predictive step in this section many constant sequences are set with a length of 10 and each sequence has only one specific value of discharge the values of the discharges of those sequences range from 2000 m3 s to 5000 m3 s with each step level of 50 m3 s consequently 61 sequences established in total that is to say the inputs of the lstm are 61 constant sequences of different values with a length of 10 when those sequences are input into the trained lstm model the lstm will regard them as constant because the length of the window sequence of the lstm model established in this paper is set as 7 which is less than the lengths of those sequences that is to say the lstm can predict flow and sediment parameters in the constant input for each predictive step then the corresponding averaged hydrodynamic values and ssc of each inflow level are calculated as the final predicted result of each inflow level with the corresponding subsequent calculated pe value finally the discharge corresponding to the minimum pe value is considered as the representative value of qs the prediction of water and sediment of representative stations under steady flow conditions namely the average of the predicted value of the lstm model over a specific discharge are obtained as shown in fig 12 it can be seen that all the water levels and ssc can be well predicted at each level of discharges this efficient predictive ability of lstm greatly saves the calculation cost the results also show that the q z relationship based on the steady condition for different inflow levels is different from the stair step unsteady state flow conditions given in section 4 1 furthermore the predicted water levels and sscs with different discharges can be used to calculate pe according to the eq 1 to obtain the representative value of qs the plots of pe as varying with different discharge at each station are given in fig 13 as shown in fig 13 the pe curve shows prominent parabolic characteristics the pe value firstly decreases for a small discharge and then increases dramatically with the discharge growth due to the fact that sediment transport capacity and water level increase rapidly with the discharge for each station the flow corresponding to the minimum value of the pe curve is still taken as qs as listed in table 5 the results show that the qs of wujiadu and xiaoliuxiang are 3600 m3 s and 3700 m3 s respectively which are little higher than the previous results of the qd in essence the sediment carried by the inflow in the middle huaihe river has obviously decreased in recent years and the cross section is significantly affected by dredging and excavation contributing to an increase of qd consequently the qs obtained for those two stations is not only in good agreement with previous results but also reveals a tendency of the riverbed to change in the recent few years the variation law of the qs along the study reach can be used as a reference and supplement the study of the qd 4 3 correlation analysis between riverbed geomorphology and bed steadying discharge a good similarity of qs and qd has been verified by comparing the qs obtained by the proposed method at a specific station with the qd an approximate substitution of qs for the qd can be used to understand and analyze the changing process of the qd along the study area it can be seen that the qd for the middle huaihe river does not show a monotonous increase trend but is characterized by a particular process of increase decrease rapid increase fig 14 the variation of the qd along the reach should be discussed together with the geometry of the reach shown in fig 15 fig 15 shows that generally a dramatic difference of riverbed level occurred in wujiadu and linhuaiguan and there is a significant inverse gradient ratio in the downstream of xiaoliuxiang which was significantly different from most of the other natural rivers the results of figs 14 and 15 are further discussed for each sub reach as follows i the riverbed level of wujiadu and linhuaiguan is much lower than the corresponding average bed elevation which is contrary to the natural trend of the bed evolution the reason for this phenomenon may be that the artificial sand mining exerts a dramatic impact on the sub reach where wujiadu and linhuaiguan are located ni et al 2020 leading to a rapid increase of cross sectional area and sediment transport capacity hence the corresponding qd increases accordingly and even exceeds that of the wuhe fushan sub reach downstream of linhuaiguan ii wuhe and xiaoliuxiang are located in the transitional sub reach near the entrance of the hongze lake and their riverbeds are featured with a relatively stable evolution trend that is mainly dominated by environmental changes as a result the calculated qd within this sub reach shows a trend of steady increase however the width between the left and right levees reduced about 0 3 to 0 5 km less than of wujiadu that is located in the upstream reach this reduction makes the discharge capacity obviously decrease leading to lower values of qd obtained for wuhe xiaoliuxiang sub reach correspondingly iii the reach of xiaoliuxiang where wide floodplains and farmdikes are located having the lowest riverbed in the study area as seen in the zone iv from fig 15 the cross sectional width of xiaoliuxiang expands rapidly and reaches nearly 5 km the riverbed is significantly characterized by an inverted gradient ratio leading to the weakening of hydrodynamic conditions and relatively frequent sediment deposition therefore the calculated qd of the tail sub reach downstream of xiaoliuxiang shows a significant increase compared to that of the upstream locations by combining the riverbed characteristics for each sub reach and the qd process it can be concluded that the value of qd obviously increases with the increase of the cross sectional area caused by natural erosion or dramatic human activities such as sand mining and bank retreat works in addition the changing trend of qd is consistent with the riverbed morphology along the study reach which confirms the reasonability of obtained results in this paper as discussed in section 4 2 the calculated value of qd of wujiadu and xiaoliuxiang is higher than of yu et al 2010 which was based on the hydrological data from 1950 to 2007 in order to prove the rationality of the difference between the obtained results and the previous study the cross sectional profile in 2007 and 2013 at the above two stations are compared as shown in fig 16 from the comparison of the transverse profile in fig 16 a it can be seen that in 2013 the cross section of wujiadu showed a downward cutting trend with the incision position close to the left side of the main trough in addition the lowest point obviously shifted left under the influence of sand mining with the mining depth reached from 5 to 6 m xiaoliuxiang is characterized by a typical u shape cross section with relatively stable variation in recent years compared with the topographic survey in 2007 the change of xiaoliuxiang s cross section was recognized as slight erosion and the scouring position is near the channel fig 16 b therefore it can be concluded that the cross sectional areas of the two stations have significantly become large due to different reasons wujiadu is mainly affected by artificial sand mining while xiaoliuxiang is mainly due to natural erosion therefore having the values of the calculated qd at two stations being larger than that of 2007 is also consistent with the cross sectional change it can be concluded that despite the fact that qd is determined by the water level and ssc the spatio temporal change of qd along the reach is involved in several controlling factors including natural evolution river geometry and human activities therefore much effort is still required to progress the understanding and quantification of the internal effects of these factors on qd 5 conclusions based on the two factors of water level and sediment carrying capacity this paper puts forward the concept of qs which is similar to that of the mathematical interpretation ofqd subsequently a novel integrated model encompassing a numerical model and an lstm model is presented to obtain the spatial distribution of qs as an approximation and supplement to the variation of qd along the river compared to the traditional analysis methods less hydrological data and numerical cost are needed and a more detailed changing process of qd along the study reach can be obtained a parameter sensitivity on lstm is carried out and the qd is obtained by the proposed integrated model with the changing trend of river morphology additionally the representative value of qd varies along the study reach implying that investigating in details the varying process of qd is essential in order to understand the spatial temporal bed evolution under various time changing topographic and hydrodynamic conditions the proposed integrated model thus offers a robust tool for identifying the detail ed spatial variations of qd in river basins efficiently and reasonably the following conclusions can be draw from this study 1 by calibrating and verifying the model with the measurements in 2013 and 2015 the established numerical model can reproduce the flow and sediment transport processes accurately furthermore the simulated results of selected seven locations from 2013 to 2016 are adopted for training the lstm model the sensitivity study and the validation cases show that lstm can predict the hydrodynamic parameters and sediment transport with high accuracy and efficiency 2 the proposed integrated model is applied to analyzing the qs of the middle huaihe river based on the s z and q z relationship predicted by lstm the range of qs can be obtained by selecting the flow range corresponding to the water level with the minimum parameter error pe considering the steady flow conditions the representative value of qs for each location are further obtained the results show that the qs at specific stations is similar to the qd indicating that qs can be approximately used to understand the changing process of the qd along the river reach 3 the changing process of qd along the middle huaihe river is featured with a particular trend of increase decrease rapid increase through the correlation analysis between the qd and the planar and longitudinal profiles it is found that the cross sections along the middle huaihe river have expanded to different extent due to artificial sand mining or natural erosion in addition the obvious inverse gradient ratio downstream from xiaoliuxiang also leads to a rapid increase of qd through the above analysis it can be seen that the obtained spatial temporal process of qd is consistent with the riverbed morphology along the study reach and cross sectional changes for specified stations this study provides a method to obtain the qd and qs by integrating 1d 2d fluid sediment transport numerical simulations with lstm leading to an efficient and effective tool the established lstm preforms well on predicting hydrodynamics in the huaihe river and the general application of deep learning on river engineering deserves further study credit authorship contribution statement jin xu data curation methodology formal analysis writing review editing visualization chengxiao zhang resources software writing original draft formal analysis investigation lingling wang funding acquisition writing review editing supervision hai zhu validation hongwu tang funding acquisition supervision eldad j avital funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national key r d program of china grant no 2022yfc3200032 grant no 2021yfc3200403 the national natural science foundation of china grant no 51879086 the fundamental research funds for the central universities b200204044 research funding of china three gorges corporation 202003251 and the royal society grant iec nsfc 181425 
3028,this work for the first time developed an unconditionally stable implicit numerical solution of a one sided spatial fractional advection dispersion equation s fade on a bounded domain to model contaminant transport through porous media during a leaching process we used the zero value robin and neumann conditions with a fractional order derivative as the inlet and outlet boundaries respectively and a constant initial concentration of the contaminant in the whole domain as an initial condition by conducting numerical analyses we found that there is a good agreement between the results of the numerical solution and of its analytical counterpart validating the accuracy of the numerical solution in the case of the α variations meaningfully altered the heterogeneity degree of the porous medium these variations significantly affected the results of the numerical solution especially at intermediate times contrary to the α parameter the numerical solution was insensitive to the spatial node number the noisy observational data led to the maximum uncertainty in the estimated fractional dispersion coefficient the application of the developed numerical solution to simulate sodium chloride nacl leaching curves lcs at a laboratory scale revealed that the numerical solution described the leaching process in the homogeneous and heterogeneous sands better than comsol multiphysics a commercial finite element software package according to the fitting results of the developed numerical solution to the experimental data the mean α values were 1 876 and 1 379 for the homogeneous and heterogeneous sands respectively the α values correctly represented the heterogeneity degrees of the used sands and the deviation rate of the transport process from the fickian transport overall the proposed numerical solution is a reliable numerical model to simulate the leaching process in homogeneous and heterogeneous porous media with bounded domains keywords bees algorithm comsol multiphysics groundwater decontamination shifted grünwald approximation super diffusive transport zero value fractional neumann and robin boundary conditions data availability data will be made available on request 1 introduction groundwater is one of the primary water sources for domestic agricultural and industrial purposes all over the world particularly in arid and semi arid regions it supports one third of human water use jasechko et al 2014 including about 45 of water required for drinking and cooking qasemi et al 2018 and almost 43 of water required for irrigation siebert et al 2010 although groundwater is less prone to contamination than surface water unfortunately groundwater contamination by various pollutants such as nitrate e g rahmati et al 2015 john et al 2017 arsenic e g lu et al 2018 ghosh et al 2019 fluoride e g ameur et al 2019 adimalla and qian 2020 pesticides e g toccalino et al 2014 huang et al 2019 and herbicides e g mao and ren 2004 alletto et al 2012 has been reported globally in recent decades in a specific region the groundwater contamination may be associated to several various pollutants which is represented by groundwater salinity indeed the salinity problem can be related to high levels of total or specific dissolved constituents such as sulfate boron fluoride selenium arsenic nitrate major ions and so on li et al 2020 the previous studies have demonstrated that anthropogenic activities are the origin of most of these pollutants e g alletto et al 2012 rahmati et al 2015 chen et al 2018 ghosh et al 2019 li et al 2019 vareda et al 2019 azad et al 2020 which commonly penetrate groundwater especially in shallow aquifers via leaching process e g john et al 2017 foster et al 2018 banks and banks 2019 li et al 2019 srivastava 2019 varied technologies and approaches have been used for decontamination of groundwater e g chen and woodside 1998 thornton et al 2014 boal et al 2015 zhang et al 2017 ghosh et al 2019 an accurate modeling of contaminant transport in a polluted aquifer during a leaching process is critical to efficiently decontaminate the groundwater source various transport models have been proposed to describe the contaminant transport process in porous media the advection dispersion equation ade based on fickian transport theory has been widely used to simulate the contaminant transport process in porous media however there is a large body of evidence that the contaminant transport process especially in heterogeneous porous media is non fickian and the ade does not accurately describe it e g benson 1998 pachepsky et al 2000 huang et al 2008 gao et al 2009 martinez et al 2010 garrard et al 2017 moradi and mehdinejadiani 2018 sharma et al 2022 non fickian transport process may be due to different mechanisms for example the preferential flow paths enhance the spreading velocity of the plume front yielding a non fickian super diffusion however the mass exchange between relatively mobile and immobile zones retards the movement of aqueous tracers yielding a non fickian sub diffusion zhang et al 2009 fractional order advection dispersion equations fades are promising tools for capturing the non fickian transport process at laboratory and field scales sun et al 2020 the fades may involve fractional derivatives with respect to space time or both which are called spatial fade s fade temporal fade t fade and spatiotemporal fade st fade respectively the s fade t fade and st fade can capture the non fickian super diffusion sub diffusion and their mixture respectively zhang et al 2019 among the fades the s fade is preferred to simulate the super diffusive transport zhang et al 2019 the s fade is a spatial nonlocal transport model which replaces the second order spatial derivative in the ade with a fractional spatial derivative of order α 1 2 indeed the s fade is a generalization of the ade which can be used in the homogeneous and heterogeneous porous media the ade assumes that the contaminant particle jumps during a given δ t resulting in a dispersive flux schumer et al 2001 occur in a very small representative elementary volume rev based on this assumption the dispersive flux depends on the hydraulic properties of the porous medium at the rev scale this is proportional to an integer derivative depending only on the local behavior of a function at an infinitesimally small interval of its domain schumer et al 2001 the dispersive flux based on the integer derivative can only accurately describe the dispersion process if the hydraulic properties of the porous medium are constant at scales larger than the rev scale this feature is only available in a perfectly homogeneous porous medium unlike the perfectly homogeneous porous medium in relatively homogeneous and heterogeneous porous media the contaminant particle jumps during a given δ t do not constrain to a very small rev in this case the hydraulic properties of the entire porous medium affect the dispersive flux this is proportional to a fractional derivative depending on the behavior of a function at its whole domain schumer et al 2001 although the s fade have been widely used to simulate contaminant movement through porous media e g benson 1998 benson et al 2001 huang et al 2008 martinez et al 2010 moradi and mehdinejadiani 2018 sharma et al 2022 there are a few studies pachepsky et al 2000 zaheer et al 2017 on the application of the s fade to simulate the leaching process in porous media pachepsky et al 2000 and zaheer et al 2017 applied an analytical solution of the s fade to simulate the leaching curves lcs the main disadvantage of analytical solution of the s fade is that it has been developed by assuming semi infinite boundary conditions benson 1998 this causes that such analytical solution cannot well describe the contaminant transport process at field and laboratory scales wherein the boundary conditions are typically finite zhang et al 2016 therefore it is necessary to solve the s fade on finite domains given that at present the analytical solutions of the s fade on finite domains are unavailable various numerical solutions have been proposed for the s fade in the last two decades e g deng et al 2004 meerschaert and tadjeran 2004 sousa 2009 martinez et al 2010 ding et al 2010 hejazi et al 2014 sharma et al 2022 these numerical solutions used local boundary conditions such as dirichlet and neumann boundary conditions however some studies have recommended nonlocal boundary conditions such as fractional neumann and robin boundary conditions to improve the performance of numerical solutions zhang et al 2007 huang et al 2008 zhang et al 2016 completely explained the boundary conditions applied to solve the s fade they emphasized that the sign of riemann liouville fractional derivative which captures nonzero value spatial nonlocal boundary conditions should be consistent with the sign of the fractional diffusive flux term in the s fade in recent years the numerical solutions of the spatial fractional diffusion equation s fde and s fade by imposing the fractional boundary conditions have been increasingly attracted by researchers for example baeumer et al 2018 numerically solved the one sided s fde by enforcing zero value dirichlet or zero value fractional neumann boundary conditions they demonstrated that the traditional neumann condition is not satisfied at boundaries kelly et al 2019 derived numerical solutions to the two sided s fde with the zero value dirichlet or the zero value fractional neumann boundary conditions using explicit and implicit euler schemes they proved that the numerical solution based on the explicit scheme was conditionally stable while that based on the implicit scheme was unconditionally stable a finite difference approximation of the s fde with dirichlet and fractional boundary conditions based on crank nicolson method was developed by xie and fang 2019 they proved the unconditionally stability of the numerical solution using gershgorin theorem zhang et al 2019 presented a series of numerical solutions to the one sided s fade by applying explicit euler finite difference schemes they imposed various combinations of zero value dirichlet fractional neumann and fractional robin conditions at inlet and outlet boundaries their numerical analyses showed that the enforcement of the nonlocal boundary condition influenced the contaminant transport in the whole domain while the imposition of the local boundary condition only affected the contaminant transport near the boundary although the numerical solutions of the s fade with zero value nonlocal boundary conditions have been previously developed to the authors knowledge the practical application of numerical solution of the s fade to simulate the leaching process has not been reported so far therefore the main purposes of this work are 1 to present an unconditionally stable numerical solution for the one sided s fade by imposing the zero value fractional robin and neumann conditions at the inlet and outlet boundaries respectively 2 to examine the accuracy of the numerical solution by comparing the results of the s fade numerical solution with those of an analytical solution 3 to investigate the sensitivity of the numerical solution to the fractional derivative order and the number of spatial nodes 4 to evaluate the practical capability of the numerical solutions for simulating leaching process in homogeneous and heterogeneous saturated sand columns and 5 to compare the performance of the developed numerical solution with that of comsol multiphysics a commercial finite element based software package 2 materials and methods 2 1 governing equation boundary and initial conditions benson 1998 proposed the one dimensional s fade to capture the super diffusive transport as follows 1a c x t t v c x t x 1 2 1 β d f α c x t x α 1 2 1 β d f α c x t x α where c x t ml 3 is the contaminant concentration at distance and time t v lt 1 is the average plume velocity df lαt 1 is the fractional dispersion coefficient 1 β 1 dimensionless is the skewness parameter 1 α 2 dimensionless is the order of fractional differentiation and α c x t x α and α c x t x α are respectively the positive left and negative right riemann liouville fractional derivatives of order α defined in a bounded domain 0 l as follows huang et al 2008 1b α c x t x α 1 γ n α n x n 0 x x ζ n 1 α c ζ t d ζ 0 ζ x 1c α c x t x α 1 γ n α n x n x l ζ x n 1 α c ζ t d ζ x ζ l where γ is the gamma function n is a positive integer satisfying n 1 α n ζ is the integration variable and l is the size of the domain i e 0 x l eqs 1b and 1c indicate that the positive left riemann liouville fractional derivative characterizes the contribution from the zone with coordinates no larger than the current position x in the range of 0 l while the negative right riemann liouville fractional derivative characterizes the contribution from the zone with coordinates no less than the current position x in the range of x l zhang et al 2016 note that the β value represents the backward and forward transition probabilities huang et al 2008 when 1 β 0 the transition probability and dispersion are skewed backward describing a slowly evolving contaminant plume while when 0 β 1 the transition probability and dispersion are skewed forward describing a quickly evolving contaminant plume also when β 0 the backward and forward transition probabilities are the same the solutions of eq 1a are positively skewed for β 1 and they are capable of simulating the btcs with early arrivals sun et al 2020 indeed in this case it is assumed that the super diffusion follows the main flow direction which is called forward super diffusion zhang et al 2016 regarding the fact that a complex heterogeneous structure can facilitate the contaminant movement via preferential pathways the positive skewness and consequently the forward super diffusion are physically meaningful zhang et al 2016 sun et al 2020 therefore in this study we used the one sided s fade with the positive riemann liouville fractional derivative i e 1d c x t t v c x t x d f α c x t x α like all other differential equations we require the boundary and initial conditions to solve the s fade the typical boundary conditions applied to derive the numerical solutions of the s fade include dirichlet fractional neumann and fractional robin boundary conditions the dirichlet the first type boundary condition considers a prescribed concentration at the boundary the fractional neumann the second type boundary condition imposes a prescribed fractional dispersive flux without advective flux at the boundary the fractional robin the third type boundary condition is a weighted arithmetic mean of the dirichlet and fractional neumann boundary conditions which enforces a prescribed advective and fractional dispersive flux at the boundary it should be noted that we cannot impose the traditional robin and neumann conditions at the inlet and outlet boundaries to solve the s fade because the s fade includes the fractional dispersion term zhang et al 2016 also the previous studies have demonstrated that the enforcement of the dirichlet condition at the inlet boundary to numerically solve the s fade significantly gives rise to mass balance errors and the enforcement of the fractional robin condition at the inlet boundary removes this problem zhang et al 2007 huang et al 2008 meanwhile we know that the contaminated groundwater is replaced withabetter qualitywater during the groundwater decontamination and leaching process if we assume that the pollutant concentration in the better qualitywater to be zero and the right boundary to a free boundary we can specify the fractional forms of the zero value robin and neumann conditions as the inlet and the outlet boundaries respectively hence in this study we derived the numerical solution of the s fade subject to the following inlet and outlet boundary conditions zero value fractional robin boundary condition zfr bc 2a vc x t d α 1 c x t x α 1 x 0 0 zero value fractional neumann boundary condition zfn bc 2b α 1 c x t x α 1 x l 0 note that the imposition of the zfr at the inlet boundary condition signifies that no contaminant particle enters the flow domain through the advection and dispersion processes and the imposition of the zfn at the outlet boundary condition implies that no contaminant particle leaves the flow domain through the dispersion process the initial condition applied to derive the numerical solutions in this study was based on this assumption that the groundwater has been previously contaminated with a certain concentration cinitial of a specific pollutant hence we developed the numerical solutions of the s fade subject to the following initial condition 2c c x 0 c initial 2 2 numerical solution of the s fade in this subsection we derived an implicit numerical solution for the one sided s fade eq 1d with the boundary and initial conditions mentioned in eqs 2a to 2c using a euler scheme to this end we applied a shifted grünwald formula to discretize the positive riemann liouville fractional derivative eq 1b and adopted baeumer et al s 2018 procedure the shifted grünwald formula can be expressed as follows kelly et al 2019 3a α c x t x α δ x α k 0 x δ x 1 g k α c x k 1 δ x t where δx is the grid size in space x δ x is the integer of x δ x and g k α is the k th grünwald weight given as follows kelly et al 2019 3b g k α 1 k γ α 1 γ k 1 γ α k 1 the numerical solution of the s fade subject to the boundary and initial conditions given by eqs 2a to 2c can be written as follows 4a 1 η μ α 1 c i n 1 μ c i 1 n 1 c i n i 0 4b η c i 1 n 1 1 η c i n 1 μ k 0 i 1 g i k 1 α c k n 1 c i n 0 i m 0 i m 4c η c i 1 n 1 1 η c i n 1 μ k 0 i g i k α 1 c k n 1 c i n i m where c i n is the numerical approximation to c x i t n η v δ t δ x and μ d f δ t δ x α δt is the time step and xi xi iδx i 1 2 m and tn tn nδt n 1 2 n are the mesh points as we know the α parameter and g k α weight are dimensionless and the dimensions of the v d δ t and δ x are l t 1 l α t 1 t and l respectively according to the dimensions of the α g k α v d δ t and δ x one can conclude that the η and μ are dimensionless this dimensional analysis reveals that the two sides of eqs 4a to 4b have dimension m l 3 and consequently the numerical solution developed in this study is dimensionally consistent we can express the developed numerical solution in matrix form as follows 4d c n 1 w c n where c n c 0 n c 1 n c 2 n c m n and w is the iteration matrix the elements of matrix w are calculated as follows w i j 1 η μ α 1 f o r i j 0 μ g j i 1 α f o r i j 1 a n d 0 j m η μ g 2 α f o r i j 1 a n d 0 j m 1 η μ g 1 α f o r i j a n d 0 j m μ g 0 α f o r i j 1 a n d 0 j m 0 f o r i j 1 a n d 0 j m μ g j i α 1 f o r i j 1 a n d j m η μ g 1 α 1 f o r i j 1 a n d j m 1 η μ g 0 α 1 f o r i j a n d j m 2 3 stability investigation of the numerical solution as we know the numerical solution developed above is only unconditionally stable if the eigenvalues of the iteration matrix w are more than or equal to 1 we used the gerschgorin theorem isaacson and keller 1996 to assess the variation ranges of eigenvalues of the iteration matrix w based on this theorem the eigenvalues of the matrix w are inside the disks centered at each diagonal entry of the matrix w i e w i i with radii r w i j 0 j i m w i j hence the eigenvalues of the iteration matrix w lie in the following disks 5a w i i 1 η μ α 1 r w i j 0 j i m w i j μ k 2 m g k α η μ g m α 1 η μ α 1 i 0 5b w i i 1 η μ α r w i j 1 j i m w i j μ k 0 m i g k α μ g 1 α η μ g m i α 1 μ g 1 α η μ α η 0 i m 5c w i i 1 η μ r w i j 1 j i m w i j μ i m a detailed investigation of eq 5 demonstrates that all the eigenvalues of the iteration matrix w have magnitudes larger than 1 and thus this matrix is invertible this implies that the eigenvalues of the matrix w 1 have moduli less than 1 and consequently the spectral radii of the matrix w 1 is less than 1 this finding elucidates that any error in c n 1 does not amplify after each time step as a result the numerical solution of the s fade with the zfr bc as the inlet boundary condition and the zfn bc as the outlet boundary condition are unconditionally stable 2 4 accuracy and performance investigation of the numerical solution this subsection systematically examines the behavior of the numerical solution using synthetic data sets we first compared the results of the numerical solution with those of an analytical solution as mentioned in introduction the s fade does not have analytical solutions on finite domains at present while the ade has analytical solutions on finite domains considering the fact that the s fade reduces to the ade for α 2 we compared the results of the s fade numerical solution for α 2 with those of the ade analytical solution for zero value robin inlet boundary condition and zero value neumann outlet boundary condition the ade analytical solution for a conservative contaminant subject to the boundary and initial conditions mentioned in eqs 2a to 2c can be expressed as follows van genuchten 1982 6 c x t c initial 1 1 2 e r f c x v t 2 dt v 2 t π d exp x v t 2 dt 2 1 2 1 vx d v 2 t d exp vx d e r f c x v t 2 dt 2 v 2 t π d 1 v 4 d 2 l x v t exp vl d 1 4 d t 2 l x v t 2 v d 2 l x 3 v t 2 v 4 d 2 l x v t 2 exp vl d e r f c 2 l x v t 2 dt where d l2t 1 is the dispersion coefficient and the other variables are defined as eq 1a the accuracy comparison of the s fade numerical solution for α 2 with that of the ade analytical solution was carried out using transport parameters of v 1 5 cm min 1 and df d 5 cm2 min 1 in hypothetical soil columns withlengthsof 60 120 180 cm which uniformly contained an initial contaminant concentration of cinitial 500 mg l 1 the difference between the results of the numerical and analytical solutions were evaluated using graphical exhibition i e the comparison of the lcs simulated by the numerical and analytical solutions and statistical metrics including mean bias error mbe hanna and heinold indicator hh nash sutcliffe efficiency nse coefficient of determination r2 and index of agreement dindex note that the hh is a statistical metric which is nowadays recommended instead of root mean square error rmse mentaschi et al 2013 the mbe hh and r2 imply the error of individual points while the nse and dindex imply the overall performance of a model gueymard 2014 the mbe hh nse r2 and dindex were computed as follows mentaschi et al 2013 behar et al 2015 malik et al 2017 mehdizadeh 2020 7a mbe i 1 n c i num c i ana n c ana 7b hh i 1 n c i num c i ana 2 i 1 n c i ana c i num 7c nse 1 i 1 n c i num c i ana 2 i 1 n c i ana c ana 2 7d r 2 i 1 n c i num c num c i ana c ana 2 i 1 n c i num c num 2 i 1 n c i ana c ana 2 7e d index 1 i 1 n c i num c i ana 2 i 1 n c i num c ana c i ana c ana 2 where c i num and c i ana are respectively the concentration values obtained by the numerical and analytical solutions at the i th point c num and c ana are respectively the averages of values obtained by the numerical and analytical solutions and n is the number of the simulated points as we know if the mbe and hh values are closer to 0 and the nse r2 and dindex values are closer to 1 the model performs better mentaschi et al 2013 behar et al 2015 wang et al 2020a after validating the accuracy of the numerical solution we first set the v df and cinitial values to 2 cm min 1 0 4 cmα min 1 and 500 mg l 1 respectively then we examined the performances of the numerical solution under different α values in the range of 1 1 to 2 at the transport distance of 180 cm and under spatial node number of 90 180 and 360 at the transport distances of 60 120 180 cm note that we set δ x 2 cm and δ t 1 min to investigate the numerical solution accuracy and its performance at different α values while we set α 1 5 δ t 1 min and δ x x n nod where x is the transport distance cm and n nod is the spatial node number to investigate the numerical solution performance at different number of spatial nodes 2 5 practical application of the numerical solution to understand the application of the developed numerical solution at laboratory and filed scales we should note that the numerical model developed in this study can be applied to simulate the pollutant transport during the leaching process the enforcement of a weighted arithmetic average of the dirichlet and fractional neumann boundary conditions in an injection well implies the third type boundary condition at the inlet boundary also the enforcement of a prescribed fractional dispersive flux without the advective flux in an extraction well implies the second type boundary condition at the outlet boundary this subsection explains a practical application of the numerical solution to describe leaching process in homogeneous and heterogeneous porous media to this end we estimated the s fade parameters i e v df and α by fitting the s fade numerical solution to the experimental data using an inverse problem method the subsections 2 5 1 and 2 5 2 describe the details of the experimental study and of the inverse model construction before fitting the developed numerical solution to the experimental data we investigated the error effect in the experimental data on the estimated values of the v df and α to this end we synthetically generated a lc using the developed numerical solution at the distance of 180 cm by supposing v 5 cm min 1 df 7 cmα min 1 α 1 5 and cinitial 500 mg l 1 note that the application of the synthetically generated lc eliminates the other inescapable disturbances existing in the measured data mehdinejadiani 2017 after synthetically generating the lc we made noisy lcs by adding random observation errors to the synthetically generated lc for this purpose we used the following formula cromwell et al 2021 8 c x t c x t ε r c x t where c x t is the noisy concentration m l 3 c x t is the concentration without error m l 3 r is arandomnumberobeyinga gaussian distribution with mean 0 and variance 1 ε is the standard deviation of the noise which is usually taken as 1 3 of the observation error mudunuru et al 2021 in this study we considered five different observation errors including 5 10 15 20 and 25 after generating the noisy lcs we appraised the parameters of the developed numerical solution using the inverse problem method finally we analyzed the error effect in the experimental data on the estimated values of the v df and α the subsection 3 4 summarizes the error effect in the lc on the estimated values of the v df and α 2 5 1 laboratory setup and leaching experiments we collected the required experimental data by conducting two series of leaching experiments in homogeneous and heterogeneous saturated sand columns fig 1 shows a sketch of the laboratory setup as observed the laboratory setup consisted of a vertical plexiglass pipe 10 cm in diameter and 200 cm in height and two plastic reservoirs the pipe was mounted on a 20 20 20 cm plexiglass box whose top face was latticed and covered with a nylon screen at the contact place of the pipe and box to establish water flow in the sand column the inner surface of the pipe was roughened by gluing fine sand particles to reduce the wall flow effect to examine the leaching process at different transport distances five sampling ports were created along the height of the column with interval of 30 cm the ports were protected from clogging by wrapping them with nylon gauze the plastic reservoirs which one contained sodium chloride nacl solution as a conservative contaminant and the other contained distilled water were connected to the plexiglass box using hoses an upward water flow through the soil column was established by a pump modelrkm 60 550 w made in prc the water flow rate was regulated manually by means of cut off valves and measured via a flow meter as above mentioned we carried out two series of leaching experiments in this study the first series was conducted in a 120 cm relatively homogeneous saturated sand column packed with a medium textured sand the sand s2 in table 1 whose particle size varies within 0 1060 to 0 6000 mm and its apparent density is approximately 1 710 g cm 3 the second series was conducted in a 180 cm heterogeneous saturated sand column packed with fine medium and coarse textured sands the sands s1 to s5 in table 1 whose particle size varies within 0 0750 to 2 400 mm and its apparent density is approximately 1 591 g cm 3 the sands used in the columns were excavated from a riverbed cleaned air dried and finally sieved by astm standard sieves with mesh numbers of 4 8 10 16 18 20 25 30 40 50 60 80 100 and 140 the homogeneous packing was conducted in layers with a thickness of almost 5 cm and each layer was compacted as uniformly as possible however the heterogeneous packing was conducted in layers with different thicknesses in the range of 3 to 5 cm in the heterogeneous column we randomly selected the sand for each layer among the sands s1 to s5 and we arbitrarily compacted each layer it should be also mentioned that the packing of the sand columns was conducted under saturated condition to minimize air entrapment when the packing was finished the water was drained then the pump established a flow of the nacl solution with concentration of 500 mg l 1 through the sand column to completely saturate the column with the nacl solution whenthecolumnsaturationwasreached steady flows of 260 and 550 mlmin 1 were established in the homogeneous and heterogeneous sand columns respectively prior to the leaching experiments we measured the nacl concentration at all sampling ports to ensure identity of the nacl concentration at the sand column subsequently we commenced the leaching experiments by simultaneously closing and opening valves controlling flow from the reservoirs note that during the leaching experiments the flow rates were held constant at 260 and 550 mlmin 1 in the homogeneous and heterogeneous sand columns respectively to monitor the leaching process of the nacl at the sand column we took water sample at the ports with time interval of 1 min and measured the electrical conductivity ec of the water sample via a calibrated electrical conductivity cell orion model 130a germany the nacl concentration value corresponding to each ec was obtained using a predetermined calibration curve eventually we depicted the measured concentrations versus the time at each transport distance characterizing the lc at that distance 2 5 2 construction of the inverse model as before mentioned the s fade parameters were appraised by the inverse problem method therefore we developed an inverse model which minimized the square sum of the difference between the measured and calculated concentration values using the following function 9 f c 1 n i 1 n c i num c i meas 2 where c i meas is the measured concentration at the i th point and the other variables are defined as eq 7 the inverse model developed in this study applied bees algorithm ba to minimize the f c the ba is a metaheuristic algorithm which was first introduced by pham et al 2006 the ba algorithm mimics the foraging behavior of honeybees to solve optimization problem here we avoid presentingthedetaileddescriptionsonthe ba algorithm for the sake of brevity and refer the interested readers to pham et al 2006 and mehdinejadiani 2017 the main steps of the ba algorithm can be expressed as follows pham et al 2006 1 randomly generate nt initial solution vectors 2 evaluate the solution vectors using eq 8 3 sort the solution vectors in ascending order of f c values 4 select the first nbest solution vectors as the best ones 5 select the first nelite solution vectors among the nbest solution vectors as elite ones 6 select the first nelite solution vectors among the nbest solution vectors as elite ones 7 randomly generate ne and no solution vectors respectively in the neighborhood of the elite and other selected solution vectors 8 select the fittest solution vector from each neighborhood according to the of value 9 randomly generate nt nbest initial solution vectors 10 form the new population of the solution vectors using the fittest one from each neighborhood and those from step 9 11 repeat steps 2 to 10 until stopping criterion is met here it is necessary to mention that all scripts required in this study were prepared in matlab 2016 2 6 comparative study we evaluated the performance of the developed numerical solution by comparing its results with comsol software results the comsol multiphysics formerly femlab is a commercial finite element software package designed to simulate a wide range of physical phenomena karmakar et al 2022 the comsol is a flexible software offering the possibility to implement individual partial differential equations pdes without requiring access to the source code the comsol solves the ade using finite element method to simulate solute transport in porous media in addition the comsol is capable of estimating the solute transport parameters using inverse problem method we fitted the observed lcs in the homogeneous and heterogenous sand columns to the comsol software and appraised the solute transport parameters of the ade the goodness of fitofthe developed numerical solution and the comsol software were evaluated using graphical displays i e the comparison of the measured and simulated lcs and the statistical metrics of the mbe hh nse r2 and dindex note that the values of the mbe hh nse r2 and dindex were calculated using eqs 7a to 7e in which the c i ana and c ana were replaced with c i meas and c meas respectively 3 results and discussion 3 1 accuracy of the numerical solution fig 2 shows the lcs resulted from the numerical and analytical solutions of the s fade for the transport parameters of v 1 5 cm min 1 df d 5 cm2 min 1 and α 2 at the distances of 60 120 and 180 cm as observed the lcs resulted from the two solutions approximately coincide each other especially in the early and late tails the values of the statistical indicators also validate that the accuracy of the numerical solution is comparable with that of the analytical solution see table 2 the statistical metric values are relatively equal at different distances implying the relatively similar and acceptable performance of the numerical solution at all distances however fig 2 and the mbe values reveal that the concentration values obtained by the numerical solution are somewhat larger than those obtained by the analytical solution 3 2 effect of the α parameter on results of the numerical solution fig 3 shows the lcs simulated by the numerical solution for different α values at the transport distance of 180 cm as observed the lcs related to the α 1 5 to α 2 approximately coincide each other however the lcs related to α 1 1 to α 1 4 significantly differ from those related to α 1 5 to α 2 especially at intermediate times a deep analysis of the lcs indicates that the concentration value is halved at times of 102 91 and 89 min after the start of leaching for α 1 1 α 1 5 and α 2 respectively also the concentration value approximately reaches zero at times of 241 210 and 197 min after the start of leaching for α 1 1 α 1 5 and α 2 respectively these findings demonstrate that the α value meaningfully affects the results of the numerical solution when α value varies from 1 1 to 2 but it does not nearly affect the results of the numerical solution when α value varies from 1 5 to 2 this can be resulted from the fact the heterogeneity degree of a porous medium changes from relatively heterogeneous to relatively homogeneous as the α value varies from 1 1 to 2 while it changes from averagely homogeneous to relatively homogeneous as the α value varies from 1 5 to 2 clarke et al 2005 as a result the α variation can significantly impact the results of the developed numerical model if its variation meaningfully alters the heterogeneity degree of the porous medium 3 3 effect of the spatial node number on results of the numerical solution fig 4 depicts the lcs obtained by the numerical solution for different spatial node numbers at transport distances of 60 120 and 180 cm as observed the numerical solution converges to the relatively identical results using different spatial node numbers at a certain transport distance the convergence of the numerical solution using different spatial node numbers is expected because the developed numerical solution is unconditionally stable see subsection 2 3 for more details the insensitivity to size of the space step is a prominent advantage of the numerical solution developed in this work this advantage enables the user to implement this numerical solution using relatively large space steps this feature reduces the volume of the computations and consequently the runtime of the numerical solution to simulate a lc at a certain transport distance 3 4 effect of observational data error on the estimated parameters table 3 presents the parameter values of the developed numerical solution under influences of different error percentages in the synthetically generated lc for distance of 180 cm as observed the error percentage in the estimated parameter values increases with increasing the error percentage in the synthetically generated lc it is inferred from table 3 that the presence of the error in the observational data causes the maximum error in the estimated df value followed by the error in the estimated α and v values respectively as a result the uncertainty in the measured concentration values causes the maximum uncertainty in the fractional dispersion coefficient note that the error presence in the estimated parameter values under the error of 0 in the observational data can be related to the stochastic nature of the ba algorithm used in the developed inverse model 3 5 practical applicability evaluation of the numerical solution tables 4 and 5 present the parameter values of the developed numerical solution and corresponding statistical metric values at different distances of the homogeneous and heterogeneous sand columns respectively as observed the statistical metrics are very close to their ideal values at all distances which imply the good fitness of the numerical solution to the observed lcs the graphical displays of the numerical solution fitness to the experimental lcs measured in the homogeneous and heterogeneous sand columns are respectively shown in figs 5 and 6 it is also evident from these figures that the numerical solution fits quite well to the observed lcs despite the good fitness of the numerical solution to the experimental data it is observed that the mbe values are negative and close to zero see tables 4 and 5 these signify that on average the developed numerical solution slightly under simulates the concentration values at all distances of the homogeneous and heterogeneous sand columns the graphical comparison of the concentrations measured with those simulated by the developed numerical solution reveals that these slight under simulations take place at early and late times see fig 7 in continues we analyze the estimated α values and the experimental lcs to extract deep information about the leaching process and the heterogeneity degree of the sands it can be found from tables 4 and 5 that the mean α values are 1 876 and 1 379 for the homogeneous and heterogeneous sands respectively also figs 5 and 6 illustrate that the experimental lcs are asymmetric with relatively sharp decreases in concentration values at early times and heavy tails at late times the α values less than 2 and the asymmetric lcs imply that the contaminant movement in both the sand columns follows the non fickian transport during the leaching process the comparison of the α values associated to the homogeneous sand with those associated to the heterogeneous sand demonstrates that the contaminant movement in the heterogeneous sand deviate more from the fickian transport these findings are in agreement with a large body of literature on the contaminant movement in the porous media e g benson 1998 pachepsky et al 2000 huang et al 2006 martinez et al 2010 zaheer et al 2017 lu et al 2018 moradi and mehdinejadiani 2018 sharma et al 2022 wang et al 2020b a further inspection of the estimated α values demonstrates that the homogeneous sand column is relatively homogenous at all transport distances while the heterogeneous sand column is averagely heterogeneous up to the transport distance of 120 cm and it is relatively heterogeneous at the transport distances of 150 and 180 cm clarke et al 2005 the heterogeneity degrees inferred according to the α values seem logical and are consistent with the diversity of the sands used to prepare the sand columns see subsection 2 5 1 for more details the above mentioned findings demonstrate that the numerical solution can describe well the non fickian leaching process in both the homogeneous and heterogeneous sand columns 3 6 the numerical solution performance versus the comsol performance tables 4 and 5 compare the parameter values and the statistical metric values related to the developed numerical solution with those related to the comsol software at different distances of the homogeneous and heterogeneous sand columns respectively as observed the developed numerical solution and the comsol software estimate the close values for the velocity parameter at each distance whereas they obtain the quietly different values for dispersion coefficient parameter this can be resulted from the fact that the developed numerical solution applied the fractional order derivative for dispersion term also it is found from tables 4 and 5 that the statistical metric values related to the developed numerical solution are better than those related to the comsol software figs 5 and 6 also confirm better fitness of the developed numerical solution to the observed lcs the graphical comparison of the concentrations measured with those simulated reveals that the developed numerical solution simulates the concentration values much more accurately than the comsol software see fig 7 these findings imply that compared to the comsol software the developed numerical solution better captures the leaching process in the studied porous media 3 7 merits and demerits of the numerical solution regarding the fact that the s fade does not have analytical solutions on the bounded domains the presented numerical model is only solution to simulate the leaching process using the s fade in addition the presented numerical solution has advantages such as the conceptual simplicity of the used numerical method the relatively low sensitivity of the numerical model to the space step size and the high execution speed of the numerical model the only disadvantage of the numerical solution is that the developed numerical model somewhat under simulates the concentration values in the both homogeneous and heterogeneous sand columns 4 conclusion an accurate modeling of contaminant transport in a polluted aquifer during a leaching process is utmost important to rehabilitate the polluted groundwater as well known the contaminant movement in a porous medium usually follows a non fickian transport mechanism spatial fractional advection dispersion equation s fade is a promising tool for simulating non fickian transport in porous media the s fade has been rarely applied to simulate the contaminant transport in the porous media during the leaching process this study for the first time developed an implicit numerical solution for the one sided s fade on a bounded domain to model the contaminant transport through a porous medium during the leaching process we imposed the zero value robin and neumann conditions with a fractional order derivative at the inlet and outlet boundaries respectively also we considered a contaminant concentration uniformly distributed across the porous medium as an initial condition we investigated the stability of the numerical solution usingthegerschgorin theorem the accuracy of the numerical solution by comparing its results with those of an analytical solution the sensitivity of the numerical solution to the fractional differentiation order α and the spatial node number and the error effect in the experimental data on the estimated parameter values finally we evaluated the practical applicability of the proposed numerical solution to simulate sodium chloride nacl leaching curves lcs in homogeneous and heterogeneous sand columns and we compared the applicability of the developed numerical solution with that of the comsol multiphysics a commercial finite element software package the results of the numerical analyses elucidated that the numerical solution is unconditionally stable the results obtained by the numerical solution were consistent with those obtained by the analytical solution validating the accuracyofthenumericalsolution the numerical solution was sensitive to the α variation when these variations altered the heterogeneity degree of the porous medium from relatively heterogeneous to relatively homogeneous or vice versa note that the α variations significantly affected the results of the numerical solution only at intermediate times contrary to the α parameter the results of the numerical solution were significantly unaffected by the spatial node number the results of the error presence in the synthetically generated lc indicated that the noisy observational data led to the maximum and minimum errors in the estimated df and v values respectively the results of practical applicability evaluation of the developed numerical solution revealed that overall the numerical solution captured well the observed lcs at different transport distances of the homogeneous and heterogeneous sand columns except that it slightly under simulated the concentration values at early and late times the fitness of the numerical solution to the observed lcs led to the mean α values of 1 876 and 1 379 for the homogeneous and heterogeneous sands respectively being in consistent with the physical properties of the used sands the estimated α values associated to the homogeneous sand were larger than those associated to the heterogeneous sand representing the contaminant movement in the heterogeneous sand during the leaching process deviated more from the fickian transport the comparison of the simulation results demonstrated that the developed numerical solution described the experimental lcs better than the comsol software both in the homogeneous porous medium and in the heterogeneous one collectively the developed numerical solution can be utilized as a strong and highly efficient numerical model to simulate a contaminant transport in homogeneous and heterogeneous porous media during the leaching process therefore we propose to evaluate the applicability of the numerical solution at a field scale declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge university of kurdistan uok sanandaj iran for funding this work grant no 1567677 
3028,this work for the first time developed an unconditionally stable implicit numerical solution of a one sided spatial fractional advection dispersion equation s fade on a bounded domain to model contaminant transport through porous media during a leaching process we used the zero value robin and neumann conditions with a fractional order derivative as the inlet and outlet boundaries respectively and a constant initial concentration of the contaminant in the whole domain as an initial condition by conducting numerical analyses we found that there is a good agreement between the results of the numerical solution and of its analytical counterpart validating the accuracy of the numerical solution in the case of the α variations meaningfully altered the heterogeneity degree of the porous medium these variations significantly affected the results of the numerical solution especially at intermediate times contrary to the α parameter the numerical solution was insensitive to the spatial node number the noisy observational data led to the maximum uncertainty in the estimated fractional dispersion coefficient the application of the developed numerical solution to simulate sodium chloride nacl leaching curves lcs at a laboratory scale revealed that the numerical solution described the leaching process in the homogeneous and heterogeneous sands better than comsol multiphysics a commercial finite element software package according to the fitting results of the developed numerical solution to the experimental data the mean α values were 1 876 and 1 379 for the homogeneous and heterogeneous sands respectively the α values correctly represented the heterogeneity degrees of the used sands and the deviation rate of the transport process from the fickian transport overall the proposed numerical solution is a reliable numerical model to simulate the leaching process in homogeneous and heterogeneous porous media with bounded domains keywords bees algorithm comsol multiphysics groundwater decontamination shifted grünwald approximation super diffusive transport zero value fractional neumann and robin boundary conditions data availability data will be made available on request 1 introduction groundwater is one of the primary water sources for domestic agricultural and industrial purposes all over the world particularly in arid and semi arid regions it supports one third of human water use jasechko et al 2014 including about 45 of water required for drinking and cooking qasemi et al 2018 and almost 43 of water required for irrigation siebert et al 2010 although groundwater is less prone to contamination than surface water unfortunately groundwater contamination by various pollutants such as nitrate e g rahmati et al 2015 john et al 2017 arsenic e g lu et al 2018 ghosh et al 2019 fluoride e g ameur et al 2019 adimalla and qian 2020 pesticides e g toccalino et al 2014 huang et al 2019 and herbicides e g mao and ren 2004 alletto et al 2012 has been reported globally in recent decades in a specific region the groundwater contamination may be associated to several various pollutants which is represented by groundwater salinity indeed the salinity problem can be related to high levels of total or specific dissolved constituents such as sulfate boron fluoride selenium arsenic nitrate major ions and so on li et al 2020 the previous studies have demonstrated that anthropogenic activities are the origin of most of these pollutants e g alletto et al 2012 rahmati et al 2015 chen et al 2018 ghosh et al 2019 li et al 2019 vareda et al 2019 azad et al 2020 which commonly penetrate groundwater especially in shallow aquifers via leaching process e g john et al 2017 foster et al 2018 banks and banks 2019 li et al 2019 srivastava 2019 varied technologies and approaches have been used for decontamination of groundwater e g chen and woodside 1998 thornton et al 2014 boal et al 2015 zhang et al 2017 ghosh et al 2019 an accurate modeling of contaminant transport in a polluted aquifer during a leaching process is critical to efficiently decontaminate the groundwater source various transport models have been proposed to describe the contaminant transport process in porous media the advection dispersion equation ade based on fickian transport theory has been widely used to simulate the contaminant transport process in porous media however there is a large body of evidence that the contaminant transport process especially in heterogeneous porous media is non fickian and the ade does not accurately describe it e g benson 1998 pachepsky et al 2000 huang et al 2008 gao et al 2009 martinez et al 2010 garrard et al 2017 moradi and mehdinejadiani 2018 sharma et al 2022 non fickian transport process may be due to different mechanisms for example the preferential flow paths enhance the spreading velocity of the plume front yielding a non fickian super diffusion however the mass exchange between relatively mobile and immobile zones retards the movement of aqueous tracers yielding a non fickian sub diffusion zhang et al 2009 fractional order advection dispersion equations fades are promising tools for capturing the non fickian transport process at laboratory and field scales sun et al 2020 the fades may involve fractional derivatives with respect to space time or both which are called spatial fade s fade temporal fade t fade and spatiotemporal fade st fade respectively the s fade t fade and st fade can capture the non fickian super diffusion sub diffusion and their mixture respectively zhang et al 2019 among the fades the s fade is preferred to simulate the super diffusive transport zhang et al 2019 the s fade is a spatial nonlocal transport model which replaces the second order spatial derivative in the ade with a fractional spatial derivative of order α 1 2 indeed the s fade is a generalization of the ade which can be used in the homogeneous and heterogeneous porous media the ade assumes that the contaminant particle jumps during a given δ t resulting in a dispersive flux schumer et al 2001 occur in a very small representative elementary volume rev based on this assumption the dispersive flux depends on the hydraulic properties of the porous medium at the rev scale this is proportional to an integer derivative depending only on the local behavior of a function at an infinitesimally small interval of its domain schumer et al 2001 the dispersive flux based on the integer derivative can only accurately describe the dispersion process if the hydraulic properties of the porous medium are constant at scales larger than the rev scale this feature is only available in a perfectly homogeneous porous medium unlike the perfectly homogeneous porous medium in relatively homogeneous and heterogeneous porous media the contaminant particle jumps during a given δ t do not constrain to a very small rev in this case the hydraulic properties of the entire porous medium affect the dispersive flux this is proportional to a fractional derivative depending on the behavior of a function at its whole domain schumer et al 2001 although the s fade have been widely used to simulate contaminant movement through porous media e g benson 1998 benson et al 2001 huang et al 2008 martinez et al 2010 moradi and mehdinejadiani 2018 sharma et al 2022 there are a few studies pachepsky et al 2000 zaheer et al 2017 on the application of the s fade to simulate the leaching process in porous media pachepsky et al 2000 and zaheer et al 2017 applied an analytical solution of the s fade to simulate the leaching curves lcs the main disadvantage of analytical solution of the s fade is that it has been developed by assuming semi infinite boundary conditions benson 1998 this causes that such analytical solution cannot well describe the contaminant transport process at field and laboratory scales wherein the boundary conditions are typically finite zhang et al 2016 therefore it is necessary to solve the s fade on finite domains given that at present the analytical solutions of the s fade on finite domains are unavailable various numerical solutions have been proposed for the s fade in the last two decades e g deng et al 2004 meerschaert and tadjeran 2004 sousa 2009 martinez et al 2010 ding et al 2010 hejazi et al 2014 sharma et al 2022 these numerical solutions used local boundary conditions such as dirichlet and neumann boundary conditions however some studies have recommended nonlocal boundary conditions such as fractional neumann and robin boundary conditions to improve the performance of numerical solutions zhang et al 2007 huang et al 2008 zhang et al 2016 completely explained the boundary conditions applied to solve the s fade they emphasized that the sign of riemann liouville fractional derivative which captures nonzero value spatial nonlocal boundary conditions should be consistent with the sign of the fractional diffusive flux term in the s fade in recent years the numerical solutions of the spatial fractional diffusion equation s fde and s fade by imposing the fractional boundary conditions have been increasingly attracted by researchers for example baeumer et al 2018 numerically solved the one sided s fde by enforcing zero value dirichlet or zero value fractional neumann boundary conditions they demonstrated that the traditional neumann condition is not satisfied at boundaries kelly et al 2019 derived numerical solutions to the two sided s fde with the zero value dirichlet or the zero value fractional neumann boundary conditions using explicit and implicit euler schemes they proved that the numerical solution based on the explicit scheme was conditionally stable while that based on the implicit scheme was unconditionally stable a finite difference approximation of the s fde with dirichlet and fractional boundary conditions based on crank nicolson method was developed by xie and fang 2019 they proved the unconditionally stability of the numerical solution using gershgorin theorem zhang et al 2019 presented a series of numerical solutions to the one sided s fade by applying explicit euler finite difference schemes they imposed various combinations of zero value dirichlet fractional neumann and fractional robin conditions at inlet and outlet boundaries their numerical analyses showed that the enforcement of the nonlocal boundary condition influenced the contaminant transport in the whole domain while the imposition of the local boundary condition only affected the contaminant transport near the boundary although the numerical solutions of the s fade with zero value nonlocal boundary conditions have been previously developed to the authors knowledge the practical application of numerical solution of the s fade to simulate the leaching process has not been reported so far therefore the main purposes of this work are 1 to present an unconditionally stable numerical solution for the one sided s fade by imposing the zero value fractional robin and neumann conditions at the inlet and outlet boundaries respectively 2 to examine the accuracy of the numerical solution by comparing the results of the s fade numerical solution with those of an analytical solution 3 to investigate the sensitivity of the numerical solution to the fractional derivative order and the number of spatial nodes 4 to evaluate the practical capability of the numerical solutions for simulating leaching process in homogeneous and heterogeneous saturated sand columns and 5 to compare the performance of the developed numerical solution with that of comsol multiphysics a commercial finite element based software package 2 materials and methods 2 1 governing equation boundary and initial conditions benson 1998 proposed the one dimensional s fade to capture the super diffusive transport as follows 1a c x t t v c x t x 1 2 1 β d f α c x t x α 1 2 1 β d f α c x t x α where c x t ml 3 is the contaminant concentration at distance and time t v lt 1 is the average plume velocity df lαt 1 is the fractional dispersion coefficient 1 β 1 dimensionless is the skewness parameter 1 α 2 dimensionless is the order of fractional differentiation and α c x t x α and α c x t x α are respectively the positive left and negative right riemann liouville fractional derivatives of order α defined in a bounded domain 0 l as follows huang et al 2008 1b α c x t x α 1 γ n α n x n 0 x x ζ n 1 α c ζ t d ζ 0 ζ x 1c α c x t x α 1 γ n α n x n x l ζ x n 1 α c ζ t d ζ x ζ l where γ is the gamma function n is a positive integer satisfying n 1 α n ζ is the integration variable and l is the size of the domain i e 0 x l eqs 1b and 1c indicate that the positive left riemann liouville fractional derivative characterizes the contribution from the zone with coordinates no larger than the current position x in the range of 0 l while the negative right riemann liouville fractional derivative characterizes the contribution from the zone with coordinates no less than the current position x in the range of x l zhang et al 2016 note that the β value represents the backward and forward transition probabilities huang et al 2008 when 1 β 0 the transition probability and dispersion are skewed backward describing a slowly evolving contaminant plume while when 0 β 1 the transition probability and dispersion are skewed forward describing a quickly evolving contaminant plume also when β 0 the backward and forward transition probabilities are the same the solutions of eq 1a are positively skewed for β 1 and they are capable of simulating the btcs with early arrivals sun et al 2020 indeed in this case it is assumed that the super diffusion follows the main flow direction which is called forward super diffusion zhang et al 2016 regarding the fact that a complex heterogeneous structure can facilitate the contaminant movement via preferential pathways the positive skewness and consequently the forward super diffusion are physically meaningful zhang et al 2016 sun et al 2020 therefore in this study we used the one sided s fade with the positive riemann liouville fractional derivative i e 1d c x t t v c x t x d f α c x t x α like all other differential equations we require the boundary and initial conditions to solve the s fade the typical boundary conditions applied to derive the numerical solutions of the s fade include dirichlet fractional neumann and fractional robin boundary conditions the dirichlet the first type boundary condition considers a prescribed concentration at the boundary the fractional neumann the second type boundary condition imposes a prescribed fractional dispersive flux without advective flux at the boundary the fractional robin the third type boundary condition is a weighted arithmetic mean of the dirichlet and fractional neumann boundary conditions which enforces a prescribed advective and fractional dispersive flux at the boundary it should be noted that we cannot impose the traditional robin and neumann conditions at the inlet and outlet boundaries to solve the s fade because the s fade includes the fractional dispersion term zhang et al 2016 also the previous studies have demonstrated that the enforcement of the dirichlet condition at the inlet boundary to numerically solve the s fade significantly gives rise to mass balance errors and the enforcement of the fractional robin condition at the inlet boundary removes this problem zhang et al 2007 huang et al 2008 meanwhile we know that the contaminated groundwater is replaced withabetter qualitywater during the groundwater decontamination and leaching process if we assume that the pollutant concentration in the better qualitywater to be zero and the right boundary to a free boundary we can specify the fractional forms of the zero value robin and neumann conditions as the inlet and the outlet boundaries respectively hence in this study we derived the numerical solution of the s fade subject to the following inlet and outlet boundary conditions zero value fractional robin boundary condition zfr bc 2a vc x t d α 1 c x t x α 1 x 0 0 zero value fractional neumann boundary condition zfn bc 2b α 1 c x t x α 1 x l 0 note that the imposition of the zfr at the inlet boundary condition signifies that no contaminant particle enters the flow domain through the advection and dispersion processes and the imposition of the zfn at the outlet boundary condition implies that no contaminant particle leaves the flow domain through the dispersion process the initial condition applied to derive the numerical solutions in this study was based on this assumption that the groundwater has been previously contaminated with a certain concentration cinitial of a specific pollutant hence we developed the numerical solutions of the s fade subject to the following initial condition 2c c x 0 c initial 2 2 numerical solution of the s fade in this subsection we derived an implicit numerical solution for the one sided s fade eq 1d with the boundary and initial conditions mentioned in eqs 2a to 2c using a euler scheme to this end we applied a shifted grünwald formula to discretize the positive riemann liouville fractional derivative eq 1b and adopted baeumer et al s 2018 procedure the shifted grünwald formula can be expressed as follows kelly et al 2019 3a α c x t x α δ x α k 0 x δ x 1 g k α c x k 1 δ x t where δx is the grid size in space x δ x is the integer of x δ x and g k α is the k th grünwald weight given as follows kelly et al 2019 3b g k α 1 k γ α 1 γ k 1 γ α k 1 the numerical solution of the s fade subject to the boundary and initial conditions given by eqs 2a to 2c can be written as follows 4a 1 η μ α 1 c i n 1 μ c i 1 n 1 c i n i 0 4b η c i 1 n 1 1 η c i n 1 μ k 0 i 1 g i k 1 α c k n 1 c i n 0 i m 0 i m 4c η c i 1 n 1 1 η c i n 1 μ k 0 i g i k α 1 c k n 1 c i n i m where c i n is the numerical approximation to c x i t n η v δ t δ x and μ d f δ t δ x α δt is the time step and xi xi iδx i 1 2 m and tn tn nδt n 1 2 n are the mesh points as we know the α parameter and g k α weight are dimensionless and the dimensions of the v d δ t and δ x are l t 1 l α t 1 t and l respectively according to the dimensions of the α g k α v d δ t and δ x one can conclude that the η and μ are dimensionless this dimensional analysis reveals that the two sides of eqs 4a to 4b have dimension m l 3 and consequently the numerical solution developed in this study is dimensionally consistent we can express the developed numerical solution in matrix form as follows 4d c n 1 w c n where c n c 0 n c 1 n c 2 n c m n and w is the iteration matrix the elements of matrix w are calculated as follows w i j 1 η μ α 1 f o r i j 0 μ g j i 1 α f o r i j 1 a n d 0 j m η μ g 2 α f o r i j 1 a n d 0 j m 1 η μ g 1 α f o r i j a n d 0 j m μ g 0 α f o r i j 1 a n d 0 j m 0 f o r i j 1 a n d 0 j m μ g j i α 1 f o r i j 1 a n d j m η μ g 1 α 1 f o r i j 1 a n d j m 1 η μ g 0 α 1 f o r i j a n d j m 2 3 stability investigation of the numerical solution as we know the numerical solution developed above is only unconditionally stable if the eigenvalues of the iteration matrix w are more than or equal to 1 we used the gerschgorin theorem isaacson and keller 1996 to assess the variation ranges of eigenvalues of the iteration matrix w based on this theorem the eigenvalues of the matrix w are inside the disks centered at each diagonal entry of the matrix w i e w i i with radii r w i j 0 j i m w i j hence the eigenvalues of the iteration matrix w lie in the following disks 5a w i i 1 η μ α 1 r w i j 0 j i m w i j μ k 2 m g k α η μ g m α 1 η μ α 1 i 0 5b w i i 1 η μ α r w i j 1 j i m w i j μ k 0 m i g k α μ g 1 α η μ g m i α 1 μ g 1 α η μ α η 0 i m 5c w i i 1 η μ r w i j 1 j i m w i j μ i m a detailed investigation of eq 5 demonstrates that all the eigenvalues of the iteration matrix w have magnitudes larger than 1 and thus this matrix is invertible this implies that the eigenvalues of the matrix w 1 have moduli less than 1 and consequently the spectral radii of the matrix w 1 is less than 1 this finding elucidates that any error in c n 1 does not amplify after each time step as a result the numerical solution of the s fade with the zfr bc as the inlet boundary condition and the zfn bc as the outlet boundary condition are unconditionally stable 2 4 accuracy and performance investigation of the numerical solution this subsection systematically examines the behavior of the numerical solution using synthetic data sets we first compared the results of the numerical solution with those of an analytical solution as mentioned in introduction the s fade does not have analytical solutions on finite domains at present while the ade has analytical solutions on finite domains considering the fact that the s fade reduces to the ade for α 2 we compared the results of the s fade numerical solution for α 2 with those of the ade analytical solution for zero value robin inlet boundary condition and zero value neumann outlet boundary condition the ade analytical solution for a conservative contaminant subject to the boundary and initial conditions mentioned in eqs 2a to 2c can be expressed as follows van genuchten 1982 6 c x t c initial 1 1 2 e r f c x v t 2 dt v 2 t π d exp x v t 2 dt 2 1 2 1 vx d v 2 t d exp vx d e r f c x v t 2 dt 2 v 2 t π d 1 v 4 d 2 l x v t exp vl d 1 4 d t 2 l x v t 2 v d 2 l x 3 v t 2 v 4 d 2 l x v t 2 exp vl d e r f c 2 l x v t 2 dt where d l2t 1 is the dispersion coefficient and the other variables are defined as eq 1a the accuracy comparison of the s fade numerical solution for α 2 with that of the ade analytical solution was carried out using transport parameters of v 1 5 cm min 1 and df d 5 cm2 min 1 in hypothetical soil columns withlengthsof 60 120 180 cm which uniformly contained an initial contaminant concentration of cinitial 500 mg l 1 the difference between the results of the numerical and analytical solutions were evaluated using graphical exhibition i e the comparison of the lcs simulated by the numerical and analytical solutions and statistical metrics including mean bias error mbe hanna and heinold indicator hh nash sutcliffe efficiency nse coefficient of determination r2 and index of agreement dindex note that the hh is a statistical metric which is nowadays recommended instead of root mean square error rmse mentaschi et al 2013 the mbe hh and r2 imply the error of individual points while the nse and dindex imply the overall performance of a model gueymard 2014 the mbe hh nse r2 and dindex were computed as follows mentaschi et al 2013 behar et al 2015 malik et al 2017 mehdizadeh 2020 7a mbe i 1 n c i num c i ana n c ana 7b hh i 1 n c i num c i ana 2 i 1 n c i ana c i num 7c nse 1 i 1 n c i num c i ana 2 i 1 n c i ana c ana 2 7d r 2 i 1 n c i num c num c i ana c ana 2 i 1 n c i num c num 2 i 1 n c i ana c ana 2 7e d index 1 i 1 n c i num c i ana 2 i 1 n c i num c ana c i ana c ana 2 where c i num and c i ana are respectively the concentration values obtained by the numerical and analytical solutions at the i th point c num and c ana are respectively the averages of values obtained by the numerical and analytical solutions and n is the number of the simulated points as we know if the mbe and hh values are closer to 0 and the nse r2 and dindex values are closer to 1 the model performs better mentaschi et al 2013 behar et al 2015 wang et al 2020a after validating the accuracy of the numerical solution we first set the v df and cinitial values to 2 cm min 1 0 4 cmα min 1 and 500 mg l 1 respectively then we examined the performances of the numerical solution under different α values in the range of 1 1 to 2 at the transport distance of 180 cm and under spatial node number of 90 180 and 360 at the transport distances of 60 120 180 cm note that we set δ x 2 cm and δ t 1 min to investigate the numerical solution accuracy and its performance at different α values while we set α 1 5 δ t 1 min and δ x x n nod where x is the transport distance cm and n nod is the spatial node number to investigate the numerical solution performance at different number of spatial nodes 2 5 practical application of the numerical solution to understand the application of the developed numerical solution at laboratory and filed scales we should note that the numerical model developed in this study can be applied to simulate the pollutant transport during the leaching process the enforcement of a weighted arithmetic average of the dirichlet and fractional neumann boundary conditions in an injection well implies the third type boundary condition at the inlet boundary also the enforcement of a prescribed fractional dispersive flux without the advective flux in an extraction well implies the second type boundary condition at the outlet boundary this subsection explains a practical application of the numerical solution to describe leaching process in homogeneous and heterogeneous porous media to this end we estimated the s fade parameters i e v df and α by fitting the s fade numerical solution to the experimental data using an inverse problem method the subsections 2 5 1 and 2 5 2 describe the details of the experimental study and of the inverse model construction before fitting the developed numerical solution to the experimental data we investigated the error effect in the experimental data on the estimated values of the v df and α to this end we synthetically generated a lc using the developed numerical solution at the distance of 180 cm by supposing v 5 cm min 1 df 7 cmα min 1 α 1 5 and cinitial 500 mg l 1 note that the application of the synthetically generated lc eliminates the other inescapable disturbances existing in the measured data mehdinejadiani 2017 after synthetically generating the lc we made noisy lcs by adding random observation errors to the synthetically generated lc for this purpose we used the following formula cromwell et al 2021 8 c x t c x t ε r c x t where c x t is the noisy concentration m l 3 c x t is the concentration without error m l 3 r is arandomnumberobeyinga gaussian distribution with mean 0 and variance 1 ε is the standard deviation of the noise which is usually taken as 1 3 of the observation error mudunuru et al 2021 in this study we considered five different observation errors including 5 10 15 20 and 25 after generating the noisy lcs we appraised the parameters of the developed numerical solution using the inverse problem method finally we analyzed the error effect in the experimental data on the estimated values of the v df and α the subsection 3 4 summarizes the error effect in the lc on the estimated values of the v df and α 2 5 1 laboratory setup and leaching experiments we collected the required experimental data by conducting two series of leaching experiments in homogeneous and heterogeneous saturated sand columns fig 1 shows a sketch of the laboratory setup as observed the laboratory setup consisted of a vertical plexiglass pipe 10 cm in diameter and 200 cm in height and two plastic reservoirs the pipe was mounted on a 20 20 20 cm plexiglass box whose top face was latticed and covered with a nylon screen at the contact place of the pipe and box to establish water flow in the sand column the inner surface of the pipe was roughened by gluing fine sand particles to reduce the wall flow effect to examine the leaching process at different transport distances five sampling ports were created along the height of the column with interval of 30 cm the ports were protected from clogging by wrapping them with nylon gauze the plastic reservoirs which one contained sodium chloride nacl solution as a conservative contaminant and the other contained distilled water were connected to the plexiglass box using hoses an upward water flow through the soil column was established by a pump modelrkm 60 550 w made in prc the water flow rate was regulated manually by means of cut off valves and measured via a flow meter as above mentioned we carried out two series of leaching experiments in this study the first series was conducted in a 120 cm relatively homogeneous saturated sand column packed with a medium textured sand the sand s2 in table 1 whose particle size varies within 0 1060 to 0 6000 mm and its apparent density is approximately 1 710 g cm 3 the second series was conducted in a 180 cm heterogeneous saturated sand column packed with fine medium and coarse textured sands the sands s1 to s5 in table 1 whose particle size varies within 0 0750 to 2 400 mm and its apparent density is approximately 1 591 g cm 3 the sands used in the columns were excavated from a riverbed cleaned air dried and finally sieved by astm standard sieves with mesh numbers of 4 8 10 16 18 20 25 30 40 50 60 80 100 and 140 the homogeneous packing was conducted in layers with a thickness of almost 5 cm and each layer was compacted as uniformly as possible however the heterogeneous packing was conducted in layers with different thicknesses in the range of 3 to 5 cm in the heterogeneous column we randomly selected the sand for each layer among the sands s1 to s5 and we arbitrarily compacted each layer it should be also mentioned that the packing of the sand columns was conducted under saturated condition to minimize air entrapment when the packing was finished the water was drained then the pump established a flow of the nacl solution with concentration of 500 mg l 1 through the sand column to completely saturate the column with the nacl solution whenthecolumnsaturationwasreached steady flows of 260 and 550 mlmin 1 were established in the homogeneous and heterogeneous sand columns respectively prior to the leaching experiments we measured the nacl concentration at all sampling ports to ensure identity of the nacl concentration at the sand column subsequently we commenced the leaching experiments by simultaneously closing and opening valves controlling flow from the reservoirs note that during the leaching experiments the flow rates were held constant at 260 and 550 mlmin 1 in the homogeneous and heterogeneous sand columns respectively to monitor the leaching process of the nacl at the sand column we took water sample at the ports with time interval of 1 min and measured the electrical conductivity ec of the water sample via a calibrated electrical conductivity cell orion model 130a germany the nacl concentration value corresponding to each ec was obtained using a predetermined calibration curve eventually we depicted the measured concentrations versus the time at each transport distance characterizing the lc at that distance 2 5 2 construction of the inverse model as before mentioned the s fade parameters were appraised by the inverse problem method therefore we developed an inverse model which minimized the square sum of the difference between the measured and calculated concentration values using the following function 9 f c 1 n i 1 n c i num c i meas 2 where c i meas is the measured concentration at the i th point and the other variables are defined as eq 7 the inverse model developed in this study applied bees algorithm ba to minimize the f c the ba is a metaheuristic algorithm which was first introduced by pham et al 2006 the ba algorithm mimics the foraging behavior of honeybees to solve optimization problem here we avoid presentingthedetaileddescriptionsonthe ba algorithm for the sake of brevity and refer the interested readers to pham et al 2006 and mehdinejadiani 2017 the main steps of the ba algorithm can be expressed as follows pham et al 2006 1 randomly generate nt initial solution vectors 2 evaluate the solution vectors using eq 8 3 sort the solution vectors in ascending order of f c values 4 select the first nbest solution vectors as the best ones 5 select the first nelite solution vectors among the nbest solution vectors as elite ones 6 select the first nelite solution vectors among the nbest solution vectors as elite ones 7 randomly generate ne and no solution vectors respectively in the neighborhood of the elite and other selected solution vectors 8 select the fittest solution vector from each neighborhood according to the of value 9 randomly generate nt nbest initial solution vectors 10 form the new population of the solution vectors using the fittest one from each neighborhood and those from step 9 11 repeat steps 2 to 10 until stopping criterion is met here it is necessary to mention that all scripts required in this study were prepared in matlab 2016 2 6 comparative study we evaluated the performance of the developed numerical solution by comparing its results with comsol software results the comsol multiphysics formerly femlab is a commercial finite element software package designed to simulate a wide range of physical phenomena karmakar et al 2022 the comsol is a flexible software offering the possibility to implement individual partial differential equations pdes without requiring access to the source code the comsol solves the ade using finite element method to simulate solute transport in porous media in addition the comsol is capable of estimating the solute transport parameters using inverse problem method we fitted the observed lcs in the homogeneous and heterogenous sand columns to the comsol software and appraised the solute transport parameters of the ade the goodness of fitofthe developed numerical solution and the comsol software were evaluated using graphical displays i e the comparison of the measured and simulated lcs and the statistical metrics of the mbe hh nse r2 and dindex note that the values of the mbe hh nse r2 and dindex were calculated using eqs 7a to 7e in which the c i ana and c ana were replaced with c i meas and c meas respectively 3 results and discussion 3 1 accuracy of the numerical solution fig 2 shows the lcs resulted from the numerical and analytical solutions of the s fade for the transport parameters of v 1 5 cm min 1 df d 5 cm2 min 1 and α 2 at the distances of 60 120 and 180 cm as observed the lcs resulted from the two solutions approximately coincide each other especially in the early and late tails the values of the statistical indicators also validate that the accuracy of the numerical solution is comparable with that of the analytical solution see table 2 the statistical metric values are relatively equal at different distances implying the relatively similar and acceptable performance of the numerical solution at all distances however fig 2 and the mbe values reveal that the concentration values obtained by the numerical solution are somewhat larger than those obtained by the analytical solution 3 2 effect of the α parameter on results of the numerical solution fig 3 shows the lcs simulated by the numerical solution for different α values at the transport distance of 180 cm as observed the lcs related to the α 1 5 to α 2 approximately coincide each other however the lcs related to α 1 1 to α 1 4 significantly differ from those related to α 1 5 to α 2 especially at intermediate times a deep analysis of the lcs indicates that the concentration value is halved at times of 102 91 and 89 min after the start of leaching for α 1 1 α 1 5 and α 2 respectively also the concentration value approximately reaches zero at times of 241 210 and 197 min after the start of leaching for α 1 1 α 1 5 and α 2 respectively these findings demonstrate that the α value meaningfully affects the results of the numerical solution when α value varies from 1 1 to 2 but it does not nearly affect the results of the numerical solution when α value varies from 1 5 to 2 this can be resulted from the fact the heterogeneity degree of a porous medium changes from relatively heterogeneous to relatively homogeneous as the α value varies from 1 1 to 2 while it changes from averagely homogeneous to relatively homogeneous as the α value varies from 1 5 to 2 clarke et al 2005 as a result the α variation can significantly impact the results of the developed numerical model if its variation meaningfully alters the heterogeneity degree of the porous medium 3 3 effect of the spatial node number on results of the numerical solution fig 4 depicts the lcs obtained by the numerical solution for different spatial node numbers at transport distances of 60 120 and 180 cm as observed the numerical solution converges to the relatively identical results using different spatial node numbers at a certain transport distance the convergence of the numerical solution using different spatial node numbers is expected because the developed numerical solution is unconditionally stable see subsection 2 3 for more details the insensitivity to size of the space step is a prominent advantage of the numerical solution developed in this work this advantage enables the user to implement this numerical solution using relatively large space steps this feature reduces the volume of the computations and consequently the runtime of the numerical solution to simulate a lc at a certain transport distance 3 4 effect of observational data error on the estimated parameters table 3 presents the parameter values of the developed numerical solution under influences of different error percentages in the synthetically generated lc for distance of 180 cm as observed the error percentage in the estimated parameter values increases with increasing the error percentage in the synthetically generated lc it is inferred from table 3 that the presence of the error in the observational data causes the maximum error in the estimated df value followed by the error in the estimated α and v values respectively as a result the uncertainty in the measured concentration values causes the maximum uncertainty in the fractional dispersion coefficient note that the error presence in the estimated parameter values under the error of 0 in the observational data can be related to the stochastic nature of the ba algorithm used in the developed inverse model 3 5 practical applicability evaluation of the numerical solution tables 4 and 5 present the parameter values of the developed numerical solution and corresponding statistical metric values at different distances of the homogeneous and heterogeneous sand columns respectively as observed the statistical metrics are very close to their ideal values at all distances which imply the good fitness of the numerical solution to the observed lcs the graphical displays of the numerical solution fitness to the experimental lcs measured in the homogeneous and heterogeneous sand columns are respectively shown in figs 5 and 6 it is also evident from these figures that the numerical solution fits quite well to the observed lcs despite the good fitness of the numerical solution to the experimental data it is observed that the mbe values are negative and close to zero see tables 4 and 5 these signify that on average the developed numerical solution slightly under simulates the concentration values at all distances of the homogeneous and heterogeneous sand columns the graphical comparison of the concentrations measured with those simulated by the developed numerical solution reveals that these slight under simulations take place at early and late times see fig 7 in continues we analyze the estimated α values and the experimental lcs to extract deep information about the leaching process and the heterogeneity degree of the sands it can be found from tables 4 and 5 that the mean α values are 1 876 and 1 379 for the homogeneous and heterogeneous sands respectively also figs 5 and 6 illustrate that the experimental lcs are asymmetric with relatively sharp decreases in concentration values at early times and heavy tails at late times the α values less than 2 and the asymmetric lcs imply that the contaminant movement in both the sand columns follows the non fickian transport during the leaching process the comparison of the α values associated to the homogeneous sand with those associated to the heterogeneous sand demonstrates that the contaminant movement in the heterogeneous sand deviate more from the fickian transport these findings are in agreement with a large body of literature on the contaminant movement in the porous media e g benson 1998 pachepsky et al 2000 huang et al 2006 martinez et al 2010 zaheer et al 2017 lu et al 2018 moradi and mehdinejadiani 2018 sharma et al 2022 wang et al 2020b a further inspection of the estimated α values demonstrates that the homogeneous sand column is relatively homogenous at all transport distances while the heterogeneous sand column is averagely heterogeneous up to the transport distance of 120 cm and it is relatively heterogeneous at the transport distances of 150 and 180 cm clarke et al 2005 the heterogeneity degrees inferred according to the α values seem logical and are consistent with the diversity of the sands used to prepare the sand columns see subsection 2 5 1 for more details the above mentioned findings demonstrate that the numerical solution can describe well the non fickian leaching process in both the homogeneous and heterogeneous sand columns 3 6 the numerical solution performance versus the comsol performance tables 4 and 5 compare the parameter values and the statistical metric values related to the developed numerical solution with those related to the comsol software at different distances of the homogeneous and heterogeneous sand columns respectively as observed the developed numerical solution and the comsol software estimate the close values for the velocity parameter at each distance whereas they obtain the quietly different values for dispersion coefficient parameter this can be resulted from the fact that the developed numerical solution applied the fractional order derivative for dispersion term also it is found from tables 4 and 5 that the statistical metric values related to the developed numerical solution are better than those related to the comsol software figs 5 and 6 also confirm better fitness of the developed numerical solution to the observed lcs the graphical comparison of the concentrations measured with those simulated reveals that the developed numerical solution simulates the concentration values much more accurately than the comsol software see fig 7 these findings imply that compared to the comsol software the developed numerical solution better captures the leaching process in the studied porous media 3 7 merits and demerits of the numerical solution regarding the fact that the s fade does not have analytical solutions on the bounded domains the presented numerical model is only solution to simulate the leaching process using the s fade in addition the presented numerical solution has advantages such as the conceptual simplicity of the used numerical method the relatively low sensitivity of the numerical model to the space step size and the high execution speed of the numerical model the only disadvantage of the numerical solution is that the developed numerical model somewhat under simulates the concentration values in the both homogeneous and heterogeneous sand columns 4 conclusion an accurate modeling of contaminant transport in a polluted aquifer during a leaching process is utmost important to rehabilitate the polluted groundwater as well known the contaminant movement in a porous medium usually follows a non fickian transport mechanism spatial fractional advection dispersion equation s fade is a promising tool for simulating non fickian transport in porous media the s fade has been rarely applied to simulate the contaminant transport in the porous media during the leaching process this study for the first time developed an implicit numerical solution for the one sided s fade on a bounded domain to model the contaminant transport through a porous medium during the leaching process we imposed the zero value robin and neumann conditions with a fractional order derivative at the inlet and outlet boundaries respectively also we considered a contaminant concentration uniformly distributed across the porous medium as an initial condition we investigated the stability of the numerical solution usingthegerschgorin theorem the accuracy of the numerical solution by comparing its results with those of an analytical solution the sensitivity of the numerical solution to the fractional differentiation order α and the spatial node number and the error effect in the experimental data on the estimated parameter values finally we evaluated the practical applicability of the proposed numerical solution to simulate sodium chloride nacl leaching curves lcs in homogeneous and heterogeneous sand columns and we compared the applicability of the developed numerical solution with that of the comsol multiphysics a commercial finite element software package the results of the numerical analyses elucidated that the numerical solution is unconditionally stable the results obtained by the numerical solution were consistent with those obtained by the analytical solution validating the accuracyofthenumericalsolution the numerical solution was sensitive to the α variation when these variations altered the heterogeneity degree of the porous medium from relatively heterogeneous to relatively homogeneous or vice versa note that the α variations significantly affected the results of the numerical solution only at intermediate times contrary to the α parameter the results of the numerical solution were significantly unaffected by the spatial node number the results of the error presence in the synthetically generated lc indicated that the noisy observational data led to the maximum and minimum errors in the estimated df and v values respectively the results of practical applicability evaluation of the developed numerical solution revealed that overall the numerical solution captured well the observed lcs at different transport distances of the homogeneous and heterogeneous sand columns except that it slightly under simulated the concentration values at early and late times the fitness of the numerical solution to the observed lcs led to the mean α values of 1 876 and 1 379 for the homogeneous and heterogeneous sands respectively being in consistent with the physical properties of the used sands the estimated α values associated to the homogeneous sand were larger than those associated to the heterogeneous sand representing the contaminant movement in the heterogeneous sand during the leaching process deviated more from the fickian transport the comparison of the simulation results demonstrated that the developed numerical solution described the experimental lcs better than the comsol software both in the homogeneous porous medium and in the heterogeneous one collectively the developed numerical solution can be utilized as a strong and highly efficient numerical model to simulate a contaminant transport in homogeneous and heterogeneous porous media during the leaching process therefore we propose to evaluate the applicability of the numerical solution at a field scale declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge university of kurdistan uok sanandaj iran for funding this work grant no 1567677 
3029,this paper presents a novel method for the estimation of soil water diffusivity that solves the nongravitational richards equation using the variation in the boundary of the advancing wetting front the solution is based on the principle of stationary action the position of the wetting front is determined from the continuity of water content at the wetting front interface as the underlying physical principles of this area are well known and thus it can be described using relatively few assumptions this also eliminates the need for the boltzmann transformation which is commonly required in traditional methods the brooks corey empirical water diffusion function is used to analytically determine the significant parameters of diffusivity the soil water diffusivities of 15 soil samples matched well with their measured soil water diffusivities thereby confirming the reliability of the method all of the measurements required for using this method are rapidly and easily obtained and the experimental apparatus is simple and inexpensive compared with other methods this novel method is more accurate and convenient for use in laboratories for measuring the soil hydraulic properties keywords soil water diffusivity the principle of stationary action wetting front interface richards equation data availability all of data information is provided by solving the equations and source in the paper 1 introduction to enable predictions of the movement of soil water soil hydraulic characteristics must be understood as these underpin the analysis of soil water and simulation of its hydraulic equations of motion muntohar and liao 2010 kropp 2011 hemmati et al 2012 olyansky et al 2016 wu et al 2017 an understanding of soil hydraulic properties is also required for describing the migration and transformation of soil water and the infiltration of precipitation into soil however the complex structure of soil materials and the complicated and time consuming nature of current methods for the measurement of soil water mean that the determination of hydraulic properties remains a major challenge soil hydraulic properties can be determined using direct or indirect methods wang et al 2004 vereecken et al 2010 ma et al 2016 volk et al 2016 direct methods are built on the basic definition of soil hydraulic properties whereas indirect methods are based on values of parameter estimated from readily measured soil conditions espejo et al 2014 ma et al 2016 direct methods often rely on perturbed small scale specimens and thus are expensive require an indeterminate amount of time to test villarreal et al 2019 and can fail to accurately quantify soil hydraulic properties therefore in recent years simple and practical indirect methods have been developed for calculating soil hydraulic properties as detailed below two indirect methods for the estimation of soil hydraulic properties are the pedotransfer functions ptf method wösten et al 2001 vereecken et al 2010 patil and singh 2016 van looy et al 2017 and the numerical inversion method zijlstra and dane 1996 simunek et al 2008 however the scope of application of the ptf method application is restricted by the geographical variability in measured sample datasets and the empirical properties of the model function rubio et al 2008 similarly numerical inversion calculations of the model parameters of soil hydraulic properties have the defects of parameter uniqueness and numerical dispersion toorman et al 1992 eching and hopmans 1993 wang et al 2002 in contrast compared with the direct method and the above indirect methods the approximate analytical method is simpler faster and cheaper ma et al 2016 and its solutions are generally expressed as explicit functions of flux wetting fronts or spatial and temporal soil moisture consequently the corresponding model parameters of soil hydraulic properties can easily be obtained by simple fitting procedures therefore the approximate analysis method is therefore a current focus of attention and development in the implementation of the approximate analytical solution method the richards partial differential equation rpde richards 1931 is invariably the governing equation to be solved the rpde reduces the process of water infiltration in the absence of gravity to a horizontal diffusion equation although ignoring the effects of gravity is a limitation this horizontal diffusion equation is easy to solve and reveals some insights into the aspects of infiltration and thus researchers have developed methods based on this equation for estimating the soil moisture diffusivity bruce and klute 1956 devised an explicit integral expression for estimating soil water diffusivity by using the boltzmann transformation to convert the horizontal diffusion equation into an ordinary differential equation shao and horton 1998 used approximate solutions to the horizontal diffusion equation to generate an integral method for estimating van genuchten vg model parameters van genuchten 1980 wang et al 2002 and ma et al 2009 2010 2016 have further developed this method to determine the brooks corey bc brooks and corey 1964 model parameters from horizontal infiltration soil hydraulic properties include the soil water characteristic curve swcc and the hydraulic conductivity function hcf the unsaturated hcf which is relative to soil suction or volumetric water content is a primary soil parameters that must be determined when performing seepage analysis of unsaturated soil systems gribb et al 2004 li et al 2009 zhai et al 2021 it is typically determined from laboratory based evaporation experiments using expensive equipment schindler et al 2010 whereby obtaining the variable diffusivity in relation to hcf enables the hcf to be captured the product of the hcf and the swcc slope koorevaar et al 1983 is denoted the variable diffusivity and characterizes the movement of soil water in unsaturated conditions wang et al 2004 therefore many researchers have endeavored to determine methods for calibrating the variable diffusivity that are more efficient and less expensive than the above mentioned laboratory based method however most methods that have been developed in the last few years for determining hydraulic parameters have not been fully validated ma et al 2016 villarreal et al 2019 hence the theoretical basis of introducing a boltzmann transformation variable into most methods in addition to the physical interpretation of some eigenvalues e g characteristic length of the wetted zone remain to be further clarified the objective of this study was to develop an analytical method for estimating soil water diffusivity parameters based on the principle of stationary action crucially the developed method does not introduce transformation variables when ignoring gravitational effects on the rpde nor use additional variables to characterize soil water systems instead it uses the continuity of the soil water content continuity at the wetting front interface to derive an exact mathematical description of wetting front distance versus time 2 theory and method this section first introduces the theory that determines soil water diffusivity based on the principle of stationary action and the position of the wetting front subsequently this theory is used to develop the method for estimating the soil water diffusivity parameters based on the cumulative infiltration and wetting front position this method is then implemented for the calculation of bc type soil diffusivity parameters 2 1 solution of the rpde based on the principle of stationary action water flow under isothermal conditions in unsaturated homogeneous media is usually simulated using the rpde which is obtained by combining the mass conservation equation 1 with darcy s flow law equation 2 these equations are defined as follows 1 θ t q x 0 where θis the volumetric soil water content l3 l3 t is the time t x is the spatial position l and q is the flux l t satisfying darcy s law in the absence of gravity 2 q d θ θ x where d is the soil moisture diffusivity l2 t and is defined as the product of the hcf and the swcc slope as follows 3 d θ k θ dh d θ where k is the hydraulic conductivity function l t and h is the water pressure head l for constant initial and constant volume water content boundary homogeneous soil water flow problems the following initial conditions are satisfied 4 θ 0 x θ i x 0 where the boundary conditions are 5 θ t 0 θ 0 t 0 6 θ t x θ i x x f t where θ 0 and θi are the boundary and initial soil water contents l3 l3 respectively which verify that θ r θ i θ θ 0 θ s θ r and θ s are the residual and saturated water soil water contents l3 l3 respectively x f is the change in the position of the wetting front over time l the horizontal infiltration process is shown in fig 1 the principle of stationary action or the principle of least action is one of the most fundamental principles in physics and its application to the action amount of a mechanical system yields the motion equation of the system landau and lifshitz 1976 based on this principle the soil water flow problem can be transformed into a functional minimal value problem su et al 2017a 2017b as follows 7 min t θ 0 x f v 1 d x where v is the characteristic velocity of the pore water flow corresponding to the boundary conditions in equations 5 and 6 the constraint conditions are satisfied as follows 8 θ t 0 θ 0 t 0 9 θ t x θ i x x f t according to philip 1957a v can be expressed as follows 10 v q θ θ d θ θ x in addition according to li et al 2021 solution based on the variational method technique equation 7 can be solved as follows 11 d θ d θ 0 d θ 0 d θ i x x f 2 2 determination of the advance of the wetting front for convenience of calculation the following functional dependence is assumed 12 θ f η where η x x f equation 11 shows that it is generally to explicitly express function f in equation 12 it is typically the case that the inverse function existence theorem holds that is when the water diffusion function is monotonic with respect to the volumetric water content the water diffusion inverse function exists most of the water diffusion functions clearly satisfy this requirement in addition to determine the moisture diffusion function and volumetric water content distribution it is necessary to determine the advance of the wetting front according to equation 11 this is precisely determined below based on the interface volumetric water content continuity at the location of the wetting front in line with the fact that the volumetric water content is continuous at the wetting front interface the following equation is fulfilled 13 θ x x x f θ x x x f where x f x f δ and δ is infinitely small assuming a uniform distribution of the volumetric water content at x x f the volumetric water content is taken as a constant in laboratory experiments the initial constant volumetric water content is often used in horizontal or vertical soil column infiltration experiments when the volumetric water content at x x f is taken as a constant equation 13 becomes 14 θ x x x f 0 integrating the two sides of equation 1 with respect to over the interval 0 xf yields 15 q x 0 x x f 0 x f θ t d x substituting equations 2 and 6 into equation 15 with the aid of equation 14 gives 16 d θ 0 θ x x 0 d dt 0 x f θ d x θ i d x f dt then by inserting equation 14 into equation 16 it is easy to obtain 17 d θ 0 f η η x z 0 d x f dt 0 1 f η d η θ i d x f dt i e 18 a 1 x f a 2 d x f dt where a 1 d θ 0 f η η 0 a 2 0 1 f η d η θ i with respect to equation 18 the change in the position of the wetting front over time is obtained by a conventional integration method as follows 19 x f t 2 a 1 a 2 t 2 a 2 2 c 1 a 2 where c 1 is the integration constant given the physical meaning of the wetting front it is known that xf 0 at t 0 i e 20 x f 0 0 combining equations 19 and 20 yields the position of the wetting front as the following function of time 21 x f t 2 a 1 a 2 t a 2 where xf is the position of the wetting front t is the infiltration time and a 1 and a 2 are diffusivity parameters while xf and t can be experimentally determined a 1 and a 2 must be estimated see section 2 3 equation 21 shows that the advance of the wetting front has a power function relationship with time for horizontal infiltration which coincides with the finding of philip 1957b crucially the above solution method incorporates no prior assumption about the form of the water diffusion function thus it is theoretically applicable to determining horizontal infiltration in unsaturated soils that follows an arbitrary diffusion function 2 3 estimation of diffusivity parameters using the infiltration observables to obtain precise expressions of the relationships between parameters a 1 and a 2 and observables this subsection introduces the methods for the calculation of cumulative infiltration and the position of the wetting front the infiltration rate i is given by 22 i d θ θ x x 0 d θ 0 x f f η η 0 hence the cumulative infiltration and infiltration rate are given by 23 i 0 t idt 0 t d θ 0 x f f η η 0 d t according to equation 14 the relationship between the cumulative infiltration i and the position of the wetting front is expressed as follows 24 i 0 x f θ θ i d x x f 0 1 f η d η θ i x f by combining equations 21 23 and 24 the following equations can be obtained 25 d θ 0 f η η 0 i x f 2 t 26 0 1 f η d η θ i i x f equations 11 12 21 25 and 26 show that when specifying the form of the diffusion function only the data on cumulative infiltration and the advance of the wetting front versus time in addition to the residual water content θ r the initial water content θ i the boundary water content θ 0 and the saturated water content θ s are needed to determine soil hydraulic parameters θ i θ 0 and θ s can be measured by the thermo gravimetric technique susha lekshmi et al 2014 whereas θ r is estimated by determining the water content at a matric pressure of 1 5 mpa typically the monotonic single valued hydrodynamic diffusion function parameters are more easily determined as equation 12 can express these parameters explicitly 2 4 estimation of bc soil water diffusivity a commonly used functional representation of soil hydraulic properties is the aforementioned bc model the bc soil water diffusivity is given by 27 d θ d 0 θ e m where θ e θ θ r θ s θ r and represents the effective saturation d 0 k s h b n θ s θ r and represents the soil water diffusivity at saturation l2 t m 2 n 1 n and is a shape coefficient k s is the saturated hydraulic conductivity l t h b is the air entry head value l or the bubbling pressure and n is the pore size distribution index inserting equation 27 into equation 11 affords the following equation 28 f η θ 0 m θ 0 m θ i m η 1 m where θ 0 θ 0 θ r θ s θ r and θ i θ i θ r θ s θ r equations 27 and 28 can then be brought into equations 25 and 26 to yield the following equations 29 1 m d 0 θ 0 θ 0 m θ i m θ s θ r i x f 2 t 30 m θ s θ r θ 0 m 1 θ i m 1 m 1 θ 0 m θ i m θ s θ i i x f equations 29 and 30 represent a statistically meaningful description of the relationship between the bc diffusion model parameters and the observables this description is necessary as the observables must invariably be determined from several additional experiments thus equations 29 and 30 enable the determination of the propagation of measurement error into uncertainty in the determined model parameters 3 calculations and results although the solutions and results above have obvious advantages it is important to verify that the method allows the rapid and accurate determination of the values of hydraulic parameters for unsaturated soil therefore some comparisons were performed to verify the analysis data on the soil water contents of 15 soil samples table 1 were used to test the efficacy of the method the data on the following 5 samples were obtained from ma et al 2016 ansai sandy loam 8 5 clay 37 5 silt and 54 0 sand lizhuang loam soil 17 6 clay 39 1 silt and 43 3 sand shenmu sand 0 2 clay 13 4 silt 86 3 sand and 0 rock fragment mass suide sandy loam 9 6 clay 34 6 silt and 55 9 sand and yulin sand 3 7 clay 7 8 silt and 88 5 sand the data on the following 10 samples were collected by ma et al 2016 adelanto loam jackson 1963 edina silt loam selim et al 1970 fayette silty clay loam mcbride and horton 1985 hagener sand selim et al 1970 hayden sandy loam whisler et al 1968 manawatu sandy loam clothier and scotter 1982 nicollet sandy clay loam mcbride and horton 1985 panoche clay loam reichardt et al 1972 pine silty clay jackson 1963 and yolo clay nofziger 1978 fig 2 presents the variation in the cumulative infiltration of these 15 soil samples over time and fig 3 shows the variation in the advance of the wetting front of these 15 soil samples over time the slopes of all curves are consistent with the work of ma et al 2016 d 0 and m which are the key parameters in the bc diffusion model can be obtained from equations 29 and 30 as equation 30 is nonlinear it can be solved by using the fzero command in matlab software for the parameters m the estimated d 0 and m values of the 15 soil samples are listed in table 2 fig 4 shows that the hydraulic diffusion functions determined for the samples match well with the previously obtained results this confirms the effectiveness of the proposed method ma et al 2009 2016 have introduced the fractional flow concept and assumed its specific functional form in solving the above problem with the boltzmann transformation method in contrast the method developed in the current study is not based on many assumptions aside from the assumptions of the richards approximation method thus compared with other methods the physical basis of this new method is clearer moreover no additional variables are introduced during its implementation nevertheless there are two limitations to the new method first due to the method s assumption of the homogeneous richards equation it is only valid for estimating the values of hydraulic function parameters for samples of homogeneous soil more exploration is required to develop a version of this method that can estimate such values for samples of non homogeneous soils second the method does not consider gravitational effects despite the fact that most practical problems involve vertical seepage however the infiltration process in the absence of gravitational effects has important theoretical significance because it can reveal the limiting small time behavior of the transient seepage process even if gravity cannot be ignored the solution of this process can also yield valuable information for estimating soil water diffusivity 4 conclusions this study determined soil water diffusivity parameters by developing a new method based on the principle of stationary action for solving the richards equation using the varying boundary position of the wetting front the principal theoretical implications of this study are that its insights into the relationships between the cumulative infiltration the position of the wetting front and the soil water diffusivity parameters with neglect of gravitational effects the physical basis of the new method is clear and based on relatively few assumptions moreover unlike most traditional methods it avoids use of the boltzmann transformation as a result the new method can be used to explicitly express the relationship between the solution parameters and observable measurements for most integrable monotonic diffusion functions rendering it suitable for practical application the generalizability of the method is subject to certain limitations for instance as it ignores the effects of gravity and the heterogeneity of soil texture there are uncertainties associated with its determination of the advance of the wetting front and decreased accuracy in its estimates of soil hydraulic diffusivity properties accordingly the method requires some extensions nevertheless all of the measurements required for this method are uncomplicated to perform and the related experimental apparatus is simple and inexpensive credit authorship contribution statement jiwei li conceptualization methodology writing review editing funding acquisition hui jin data curation writing original draft chunling wang visualization investigation funding acquisition huabin wang validation funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the natural science foundation of zhejiang province under grants no ly 19e080008 and the national natural science foundation of china under grant no 41931286 and 52009087 we would like to thank the editor associate editor and all anonymous reviewers for their insightful and constructive comments which allowed the quality of this paper to be improved 
3029,this paper presents a novel method for the estimation of soil water diffusivity that solves the nongravitational richards equation using the variation in the boundary of the advancing wetting front the solution is based on the principle of stationary action the position of the wetting front is determined from the continuity of water content at the wetting front interface as the underlying physical principles of this area are well known and thus it can be described using relatively few assumptions this also eliminates the need for the boltzmann transformation which is commonly required in traditional methods the brooks corey empirical water diffusion function is used to analytically determine the significant parameters of diffusivity the soil water diffusivities of 15 soil samples matched well with their measured soil water diffusivities thereby confirming the reliability of the method all of the measurements required for using this method are rapidly and easily obtained and the experimental apparatus is simple and inexpensive compared with other methods this novel method is more accurate and convenient for use in laboratories for measuring the soil hydraulic properties keywords soil water diffusivity the principle of stationary action wetting front interface richards equation data availability all of data information is provided by solving the equations and source in the paper 1 introduction to enable predictions of the movement of soil water soil hydraulic characteristics must be understood as these underpin the analysis of soil water and simulation of its hydraulic equations of motion muntohar and liao 2010 kropp 2011 hemmati et al 2012 olyansky et al 2016 wu et al 2017 an understanding of soil hydraulic properties is also required for describing the migration and transformation of soil water and the infiltration of precipitation into soil however the complex structure of soil materials and the complicated and time consuming nature of current methods for the measurement of soil water mean that the determination of hydraulic properties remains a major challenge soil hydraulic properties can be determined using direct or indirect methods wang et al 2004 vereecken et al 2010 ma et al 2016 volk et al 2016 direct methods are built on the basic definition of soil hydraulic properties whereas indirect methods are based on values of parameter estimated from readily measured soil conditions espejo et al 2014 ma et al 2016 direct methods often rely on perturbed small scale specimens and thus are expensive require an indeterminate amount of time to test villarreal et al 2019 and can fail to accurately quantify soil hydraulic properties therefore in recent years simple and practical indirect methods have been developed for calculating soil hydraulic properties as detailed below two indirect methods for the estimation of soil hydraulic properties are the pedotransfer functions ptf method wösten et al 2001 vereecken et al 2010 patil and singh 2016 van looy et al 2017 and the numerical inversion method zijlstra and dane 1996 simunek et al 2008 however the scope of application of the ptf method application is restricted by the geographical variability in measured sample datasets and the empirical properties of the model function rubio et al 2008 similarly numerical inversion calculations of the model parameters of soil hydraulic properties have the defects of parameter uniqueness and numerical dispersion toorman et al 1992 eching and hopmans 1993 wang et al 2002 in contrast compared with the direct method and the above indirect methods the approximate analytical method is simpler faster and cheaper ma et al 2016 and its solutions are generally expressed as explicit functions of flux wetting fronts or spatial and temporal soil moisture consequently the corresponding model parameters of soil hydraulic properties can easily be obtained by simple fitting procedures therefore the approximate analysis method is therefore a current focus of attention and development in the implementation of the approximate analytical solution method the richards partial differential equation rpde richards 1931 is invariably the governing equation to be solved the rpde reduces the process of water infiltration in the absence of gravity to a horizontal diffusion equation although ignoring the effects of gravity is a limitation this horizontal diffusion equation is easy to solve and reveals some insights into the aspects of infiltration and thus researchers have developed methods based on this equation for estimating the soil moisture diffusivity bruce and klute 1956 devised an explicit integral expression for estimating soil water diffusivity by using the boltzmann transformation to convert the horizontal diffusion equation into an ordinary differential equation shao and horton 1998 used approximate solutions to the horizontal diffusion equation to generate an integral method for estimating van genuchten vg model parameters van genuchten 1980 wang et al 2002 and ma et al 2009 2010 2016 have further developed this method to determine the brooks corey bc brooks and corey 1964 model parameters from horizontal infiltration soil hydraulic properties include the soil water characteristic curve swcc and the hydraulic conductivity function hcf the unsaturated hcf which is relative to soil suction or volumetric water content is a primary soil parameters that must be determined when performing seepage analysis of unsaturated soil systems gribb et al 2004 li et al 2009 zhai et al 2021 it is typically determined from laboratory based evaporation experiments using expensive equipment schindler et al 2010 whereby obtaining the variable diffusivity in relation to hcf enables the hcf to be captured the product of the hcf and the swcc slope koorevaar et al 1983 is denoted the variable diffusivity and characterizes the movement of soil water in unsaturated conditions wang et al 2004 therefore many researchers have endeavored to determine methods for calibrating the variable diffusivity that are more efficient and less expensive than the above mentioned laboratory based method however most methods that have been developed in the last few years for determining hydraulic parameters have not been fully validated ma et al 2016 villarreal et al 2019 hence the theoretical basis of introducing a boltzmann transformation variable into most methods in addition to the physical interpretation of some eigenvalues e g characteristic length of the wetted zone remain to be further clarified the objective of this study was to develop an analytical method for estimating soil water diffusivity parameters based on the principle of stationary action crucially the developed method does not introduce transformation variables when ignoring gravitational effects on the rpde nor use additional variables to characterize soil water systems instead it uses the continuity of the soil water content continuity at the wetting front interface to derive an exact mathematical description of wetting front distance versus time 2 theory and method this section first introduces the theory that determines soil water diffusivity based on the principle of stationary action and the position of the wetting front subsequently this theory is used to develop the method for estimating the soil water diffusivity parameters based on the cumulative infiltration and wetting front position this method is then implemented for the calculation of bc type soil diffusivity parameters 2 1 solution of the rpde based on the principle of stationary action water flow under isothermal conditions in unsaturated homogeneous media is usually simulated using the rpde which is obtained by combining the mass conservation equation 1 with darcy s flow law equation 2 these equations are defined as follows 1 θ t q x 0 where θis the volumetric soil water content l3 l3 t is the time t x is the spatial position l and q is the flux l t satisfying darcy s law in the absence of gravity 2 q d θ θ x where d is the soil moisture diffusivity l2 t and is defined as the product of the hcf and the swcc slope as follows 3 d θ k θ dh d θ where k is the hydraulic conductivity function l t and h is the water pressure head l for constant initial and constant volume water content boundary homogeneous soil water flow problems the following initial conditions are satisfied 4 θ 0 x θ i x 0 where the boundary conditions are 5 θ t 0 θ 0 t 0 6 θ t x θ i x x f t where θ 0 and θi are the boundary and initial soil water contents l3 l3 respectively which verify that θ r θ i θ θ 0 θ s θ r and θ s are the residual and saturated water soil water contents l3 l3 respectively x f is the change in the position of the wetting front over time l the horizontal infiltration process is shown in fig 1 the principle of stationary action or the principle of least action is one of the most fundamental principles in physics and its application to the action amount of a mechanical system yields the motion equation of the system landau and lifshitz 1976 based on this principle the soil water flow problem can be transformed into a functional minimal value problem su et al 2017a 2017b as follows 7 min t θ 0 x f v 1 d x where v is the characteristic velocity of the pore water flow corresponding to the boundary conditions in equations 5 and 6 the constraint conditions are satisfied as follows 8 θ t 0 θ 0 t 0 9 θ t x θ i x x f t according to philip 1957a v can be expressed as follows 10 v q θ θ d θ θ x in addition according to li et al 2021 solution based on the variational method technique equation 7 can be solved as follows 11 d θ d θ 0 d θ 0 d θ i x x f 2 2 determination of the advance of the wetting front for convenience of calculation the following functional dependence is assumed 12 θ f η where η x x f equation 11 shows that it is generally to explicitly express function f in equation 12 it is typically the case that the inverse function existence theorem holds that is when the water diffusion function is monotonic with respect to the volumetric water content the water diffusion inverse function exists most of the water diffusion functions clearly satisfy this requirement in addition to determine the moisture diffusion function and volumetric water content distribution it is necessary to determine the advance of the wetting front according to equation 11 this is precisely determined below based on the interface volumetric water content continuity at the location of the wetting front in line with the fact that the volumetric water content is continuous at the wetting front interface the following equation is fulfilled 13 θ x x x f θ x x x f where x f x f δ and δ is infinitely small assuming a uniform distribution of the volumetric water content at x x f the volumetric water content is taken as a constant in laboratory experiments the initial constant volumetric water content is often used in horizontal or vertical soil column infiltration experiments when the volumetric water content at x x f is taken as a constant equation 13 becomes 14 θ x x x f 0 integrating the two sides of equation 1 with respect to over the interval 0 xf yields 15 q x 0 x x f 0 x f θ t d x substituting equations 2 and 6 into equation 15 with the aid of equation 14 gives 16 d θ 0 θ x x 0 d dt 0 x f θ d x θ i d x f dt then by inserting equation 14 into equation 16 it is easy to obtain 17 d θ 0 f η η x z 0 d x f dt 0 1 f η d η θ i d x f dt i e 18 a 1 x f a 2 d x f dt where a 1 d θ 0 f η η 0 a 2 0 1 f η d η θ i with respect to equation 18 the change in the position of the wetting front over time is obtained by a conventional integration method as follows 19 x f t 2 a 1 a 2 t 2 a 2 2 c 1 a 2 where c 1 is the integration constant given the physical meaning of the wetting front it is known that xf 0 at t 0 i e 20 x f 0 0 combining equations 19 and 20 yields the position of the wetting front as the following function of time 21 x f t 2 a 1 a 2 t a 2 where xf is the position of the wetting front t is the infiltration time and a 1 and a 2 are diffusivity parameters while xf and t can be experimentally determined a 1 and a 2 must be estimated see section 2 3 equation 21 shows that the advance of the wetting front has a power function relationship with time for horizontal infiltration which coincides with the finding of philip 1957b crucially the above solution method incorporates no prior assumption about the form of the water diffusion function thus it is theoretically applicable to determining horizontal infiltration in unsaturated soils that follows an arbitrary diffusion function 2 3 estimation of diffusivity parameters using the infiltration observables to obtain precise expressions of the relationships between parameters a 1 and a 2 and observables this subsection introduces the methods for the calculation of cumulative infiltration and the position of the wetting front the infiltration rate i is given by 22 i d θ θ x x 0 d θ 0 x f f η η 0 hence the cumulative infiltration and infiltration rate are given by 23 i 0 t idt 0 t d θ 0 x f f η η 0 d t according to equation 14 the relationship between the cumulative infiltration i and the position of the wetting front is expressed as follows 24 i 0 x f θ θ i d x x f 0 1 f η d η θ i x f by combining equations 21 23 and 24 the following equations can be obtained 25 d θ 0 f η η 0 i x f 2 t 26 0 1 f η d η θ i i x f equations 11 12 21 25 and 26 show that when specifying the form of the diffusion function only the data on cumulative infiltration and the advance of the wetting front versus time in addition to the residual water content θ r the initial water content θ i the boundary water content θ 0 and the saturated water content θ s are needed to determine soil hydraulic parameters θ i θ 0 and θ s can be measured by the thermo gravimetric technique susha lekshmi et al 2014 whereas θ r is estimated by determining the water content at a matric pressure of 1 5 mpa typically the monotonic single valued hydrodynamic diffusion function parameters are more easily determined as equation 12 can express these parameters explicitly 2 4 estimation of bc soil water diffusivity a commonly used functional representation of soil hydraulic properties is the aforementioned bc model the bc soil water diffusivity is given by 27 d θ d 0 θ e m where θ e θ θ r θ s θ r and represents the effective saturation d 0 k s h b n θ s θ r and represents the soil water diffusivity at saturation l2 t m 2 n 1 n and is a shape coefficient k s is the saturated hydraulic conductivity l t h b is the air entry head value l or the bubbling pressure and n is the pore size distribution index inserting equation 27 into equation 11 affords the following equation 28 f η θ 0 m θ 0 m θ i m η 1 m where θ 0 θ 0 θ r θ s θ r and θ i θ i θ r θ s θ r equations 27 and 28 can then be brought into equations 25 and 26 to yield the following equations 29 1 m d 0 θ 0 θ 0 m θ i m θ s θ r i x f 2 t 30 m θ s θ r θ 0 m 1 θ i m 1 m 1 θ 0 m θ i m θ s θ i i x f equations 29 and 30 represent a statistically meaningful description of the relationship between the bc diffusion model parameters and the observables this description is necessary as the observables must invariably be determined from several additional experiments thus equations 29 and 30 enable the determination of the propagation of measurement error into uncertainty in the determined model parameters 3 calculations and results although the solutions and results above have obvious advantages it is important to verify that the method allows the rapid and accurate determination of the values of hydraulic parameters for unsaturated soil therefore some comparisons were performed to verify the analysis data on the soil water contents of 15 soil samples table 1 were used to test the efficacy of the method the data on the following 5 samples were obtained from ma et al 2016 ansai sandy loam 8 5 clay 37 5 silt and 54 0 sand lizhuang loam soil 17 6 clay 39 1 silt and 43 3 sand shenmu sand 0 2 clay 13 4 silt 86 3 sand and 0 rock fragment mass suide sandy loam 9 6 clay 34 6 silt and 55 9 sand and yulin sand 3 7 clay 7 8 silt and 88 5 sand the data on the following 10 samples were collected by ma et al 2016 adelanto loam jackson 1963 edina silt loam selim et al 1970 fayette silty clay loam mcbride and horton 1985 hagener sand selim et al 1970 hayden sandy loam whisler et al 1968 manawatu sandy loam clothier and scotter 1982 nicollet sandy clay loam mcbride and horton 1985 panoche clay loam reichardt et al 1972 pine silty clay jackson 1963 and yolo clay nofziger 1978 fig 2 presents the variation in the cumulative infiltration of these 15 soil samples over time and fig 3 shows the variation in the advance of the wetting front of these 15 soil samples over time the slopes of all curves are consistent with the work of ma et al 2016 d 0 and m which are the key parameters in the bc diffusion model can be obtained from equations 29 and 30 as equation 30 is nonlinear it can be solved by using the fzero command in matlab software for the parameters m the estimated d 0 and m values of the 15 soil samples are listed in table 2 fig 4 shows that the hydraulic diffusion functions determined for the samples match well with the previously obtained results this confirms the effectiveness of the proposed method ma et al 2009 2016 have introduced the fractional flow concept and assumed its specific functional form in solving the above problem with the boltzmann transformation method in contrast the method developed in the current study is not based on many assumptions aside from the assumptions of the richards approximation method thus compared with other methods the physical basis of this new method is clearer moreover no additional variables are introduced during its implementation nevertheless there are two limitations to the new method first due to the method s assumption of the homogeneous richards equation it is only valid for estimating the values of hydraulic function parameters for samples of homogeneous soil more exploration is required to develop a version of this method that can estimate such values for samples of non homogeneous soils second the method does not consider gravitational effects despite the fact that most practical problems involve vertical seepage however the infiltration process in the absence of gravitational effects has important theoretical significance because it can reveal the limiting small time behavior of the transient seepage process even if gravity cannot be ignored the solution of this process can also yield valuable information for estimating soil water diffusivity 4 conclusions this study determined soil water diffusivity parameters by developing a new method based on the principle of stationary action for solving the richards equation using the varying boundary position of the wetting front the principal theoretical implications of this study are that its insights into the relationships between the cumulative infiltration the position of the wetting front and the soil water diffusivity parameters with neglect of gravitational effects the physical basis of the new method is clear and based on relatively few assumptions moreover unlike most traditional methods it avoids use of the boltzmann transformation as a result the new method can be used to explicitly express the relationship between the solution parameters and observable measurements for most integrable monotonic diffusion functions rendering it suitable for practical application the generalizability of the method is subject to certain limitations for instance as it ignores the effects of gravity and the heterogeneity of soil texture there are uncertainties associated with its determination of the advance of the wetting front and decreased accuracy in its estimates of soil hydraulic diffusivity properties accordingly the method requires some extensions nevertheless all of the measurements required for this method are uncomplicated to perform and the related experimental apparatus is simple and inexpensive credit authorship contribution statement jiwei li conceptualization methodology writing review editing funding acquisition hui jin data curation writing original draft chunling wang visualization investigation funding acquisition huabin wang validation funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the natural science foundation of zhejiang province under grants no ly 19e080008 and the national natural science foundation of china under grant no 41931286 and 52009087 we would like to thank the editor associate editor and all anonymous reviewers for their insightful and constructive comments which allowed the quality of this paper to be improved 
