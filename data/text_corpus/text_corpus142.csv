index,text
710,dissolution trapping is one of the most important mechanisms for geological carbon storage gcs recent laboratory and field experiments have shown non equilibrium dissolution of supercritical co2 scco2 and coupled scco2 dissolution and water flow i e scco2 dissolution at local pores pore throats creating new water flow paths which in turn enhance dissolution by increased advection and interfacial area however the impacts of pore scale characteristics on these coupled processes have not been investigated in this study imbibition and dissolution experiments were conducted under 40 c and 9 mpa using a homogeneous isotropic hexagonal micromodel two homogeneous elliptical micromodels with low or high anisotropy and a heterogeneous sandstone analog micromodel the four micromodels initially saturated with deionized di water were drained by injecting scco2 to establish a stable scco2 saturation di water was then injected at different rates with logca the capillary number ranging from 6 56 to 4 34 results show that bypass of scco2 by displacing water is the dominant mechanism contributing to the residual co2 trapping triggered by heterogeneity in pore characteristics or pore scale scco2 water distribution bypass can be enhanced by pore heterogeneity or reduced by increasing transverse permeability resulting in relatively low 2 of co2 solubility or high 9 13 of co2 solubility dissolved co2 concentration in displacing water the overall dissolution of residual scco2 increases with decreasing ca and approaches to their solubility at low ca value with sufficient residence time this main trend is similar to a capillary desaturation curve that represents the relationship between the residual saturation and ca spatially dissolution initiates along the boundary of bypassed scco2 cluster s in a non equilibrium manner and the coupling of water flow and dissolution occurs which fragments the bypassed scco2 clusters and enhance scco2 dissolution keywords geological carbon storage micromodel pore characteristics imbibition co2 dissolution mass transfer 1 introduction accurate prediction of the long term storage of co2 in subsurface formations depends largely on our understanding of involved processes such as 1 two phase fluid displacement and residual co2 saturation and 2 dissolution of injected supercritical co2 scco2 and mass transfer of dissolved co2 dsco2 in formation brine ipcc 2005 the field tests of scco2 dissolution at the co2crc otway site haese et al 2013 paterson et al 2013 have shown unexpectedly early breakthrough and low maximum dsco2 concentrations 30 of co2 solubility in the produced water that were credited to formation heterogeneity indicating the non equilibrium scco2 dissolution and mass transfer at the field scale at the core scale berg et al 2013 conducted imbibition and scco2 dissolution experiments in a homogeneous high permeability 380 md berea sandstone core at 10 mpa and 45 c by injecting dsco2 undersaturated brine at 0 25 ml min into the core after scco2 drainage they observed strong dissolution of residual scco2 into displacing brine with relatively high dsco2 concentration 60 of co2 solubility in contrast chang et al 2013 2014 observed that the complete post imbibition depletion of residual scco2 via dissolution was a prolonged process when injecting deionized di water free of dsco2 at 1 0 ml min into two heterogeneous and low permeability 1 md sandstone cores at 8 mpa and 40 c the average dsco2 concentration was measured as 5 of co2 solubility one order of magnitude lower than that in berg et al 2013 at the pore scale chang et al 2016 investigated scco2 dissolution and mass transfer during imbibition in a heterogeneous sandstone analog micromodel fabricated from section micrographs of a low permeability mt simon sandstone core zuo et al 2013 their time lapse images of scco2 water distributions provide direct observations of the non equilibrium co2 dissolution and mass transfer caused by bypass of residual scco2 by displacing water after imbibition and slow mass transfer of dsco2 to displacing water the inferred dsco2 concentrations in this centimeter scale micromodel ranged from 0 38 to 2 72 of co2 solubility the disparate observations in dsco2 concentrations across these scales indicate that the effects of formation heterogeneity and pore scale characteristics on scco2 dissolution and mass transfer need to be investigated laboratory experiments have also shown coupled scco2 dissolution and water flow i e scco2 dissolution at local pores pore throats creating new water flow paths which in turn enhance dissolution by increased advection and interfacial area at the core scale akbarabadi and piri 2013 observed an increase in brine relative permeability caused by gradual reduction in the blockage by trapped scco2 bubbles via dissolution at the pore scale buchgraber et al 2012 showed the disconnecting and shrinking of co2 bubbles due to dissolution indicating scco2 snap off and residual trapping the disconnection and shrinkage of the co2 phase in return enhances co2 dissolution and mass transfer by increasing co2 water interfacial area and creating new water flow paths chang et al 2016 nambi and powers 2000 and zhang et al 2002 reported similar coupled processes for the dissolution of non aqueous phase liquid napl in water in heterogeneous sand boxes and columns packed with angular silica sands alternately chomsurin and werth 2003 showed constant napl dissolution rate with decreasing napl saturation during their imbibition experiments in 2d homogeneous and heterogeneous micromodels addressing the apparently contradictory observations requires a systematic study on the impacts of pore characteristics on trapping mechanism and dissolution of residual co2 when gravitational forces are negligible the nature of two phase displacement at the pore scale has been characterized by the dimensionless capillary number ca that represents the relative effect of viscous forces versus capillary force and by the viscosity ratio m between liquid phases the ca is often defined as follows 1 c a μ u σ c o s θ where µ is the viscosity u the average darcy velocity of the injected fluid σ the interfacial tension and θ the contact angle between the injected and resident fluid lenormand et al 1988 the phase entrapment at a given ca and m can be described by the capillary desaturation curve cdc which represents the relationship between the residual non wetting saturation and ca sahimi 1993 castro et al 2015 the pore scale cdc has been investigated in a micromodel with a statistically generated pore size distribution castro et al 2015 their results suggest the dependence of cdc shape on the amount and size distribution of the residual phase it has also been reported that the traditional ca in eq 1 should be revised using the length scales corresponding to the size of non wetting phase clusters and the revised ca is referred to as cluster based ca hilfer and oren 1996 armstrong et al 2014 the influence of pore characteristics on pore scale cdc and cluster based ca for residual trapping and the later dissolution of residual co2 needs further investigations in this study we 1 present the fundamental trapping mechanism and the processes of the non equilibrium co2 dissolution coupled with water flow 2 investigate the impacts of pore characteristics on co2 trapping the pore scale cdc and the coupled processes and 3 propose a diagram to quantify the network dependent coupled processes a series of imbibition and scco2 dissolution experiments was systematically conducted in four micromodels with post drainage scco2 saturations by injecting dsco2 free brine at different rates time lapse high resolution images of scco2 and water were obtained to provide direct observations of the coupled processes at the pore scale and to allow for comparisons among the different micromodels and with previous studies at the pore and core scales the four micromodels represent typical pore characteristics of porous media with contrasts between homogeneity and heterogeneity between isotropy and weak and strong anisotropy and between different pore shapes we first present the details on the micromodels and experimental procedures in section 2 we show in section 3 the fundamental processes of co2 dissolution coupled with water flow in a homogeneous isotropic micromodel at two low injection rates logca 6 53 and 6 13 and then the effects of displacement rate on co2 dissolution in section 4 we discuss the impacts of pore characteristics on the coupled processes by comparing the experimental observations in all the four micromodels in section 5 we present the pore scale cdc and cluster based ca in different micromodels in section 6 we propose a diagram to describe the network dependent coupled processes and the overall trend between dsco2 concentration and ca or water residence time we conclude our observations and include implications on field gcs in section 7 2 materials and methods 2 1 micromodels fig 1 shows the pore characteristics of the four micromodels used in this study with pore space shown in white and silicon posts representing mineral grains in black micromodels were composed of etched silicon wafers fabricated using micro fabrication methods involving standard photolithography coupled plasma deep reactive ion etching icp drie thermal oxidation and anodic bonding chomsurin and werth 2003 willingham et al 2008 micromodel 1 consists of hexagonal posts and a homogeneous isotropic pore network with circular pore bodies 60 µm in diameter each connected with six pore throats 5 µm in width micromodels 2 and 3 are homogeneous anisotropic micromodels share the same elliptical silicon posts and have different post arrangements and thus different longitudinal kl and transverse kt permeability the ratio of kt kl is calculated as 0 63 for micromodel 2 and 6 86 for micromodel 3 using the relation k 1 2 a p 2 where a and p represent the area and perimeter of a rectangular cross section respectively white 1979 the design pore depth of the three micromodels is 37 µm the pore network of micromodel 4 is extracted from a section micrograph of a mt simon sandstone core collected from the injection well of the illinois basin decatur project zuo et al 2013 senel et al 2014 the porous medium portion consists of nine identical sub images in a 3 3 array see the red lines in fig 1 and features in three lateral high permeability channels see figure s1 in the supplementary information a local thickness plugin in imagej software hildebrand and rüesgsegger 1996 rasband 1997 2018 was used to quantify the pore size distribution shown in figure s1 the average pore body diameter and pore throat width is 33 and 14 µm respectively figure s1 presents an example of the micromodel design including the pore network 4 and the boundary conditions zuo et al 2013 the triangle sections on each side of the pore allow for an uniform water displacement before entering the pore network see figure s3 reducing water film flow before invading the pore network the inlet triangle volume was included when calculating the water injection pore volume pv additional details on the pore size distribution can be obtained from chang et al 2016 table 1 lists the properties of the four micromodels used in this study 2 2 experiments and fluorescence imaging an experimental setup with four high pressure syringe pumps teledyne isco inc lincoln ne was used for all imbibition dissolution experiments the experimental setup is described in detail in the supplementary figure figure s2 each micromodel was assembled against a sapphire viewing window in a high pressure cell allowing imaging the micromodel was initially saturated with deionized di water and then drained by injecting coumarin dyed scco2 biswas et al 1999 at a constant rate until stable scco2 distribution and saturation were established the displaced water during drainage was collected in a pressure pump maintaining back pressure at a constant fluid pressure of 9 00 mpa after scco2 distribution and saturation remained stable with time the scco2 distribution was imaged to calculate the baseline scco2 saturation the same drainage procedure was repeated before each imbibition dissolution experiment to obtain similar initial scco2 saturation sg i and distribution imbibition dissolution experiments were conducted by injecting di water at a constant volumetric rate until scco2 in the pore network was completely depleted displaced scco2 was collected in the back pressure pump constantly maintained at 9 00 mpa different water injection rates were used for each micromodel see table 2 to allow for comparisons between imbibition dissolution experiments and micromodels we calculated the capillary number ca for each test from eq 1 the reported contact angle of water courmarin dyed scco2 in micromodels fabricated using similar silicon wafers is approximately 15 wang et al 2012 σ is inferred from chiquet et al 2007 for scco2 and water during each imbibition dissolution experiment the stained scco2 in the micromodel was observed through a blue gfp filter set λex 379 401 nm λem 435 485 nm time lapse images were obtained using a nikon eclipse te2000 e epifluorescent inverted microscope melville ny equipped with a monochrome ccd camera mu1003 amscope through a 4x objective with a spatial resolution of 1 62 µm pixel during the experiment images were taken at 2 40 min intervals depending on the water injection rates and durations the fluorescent signal intensity of dyed scco2 is significantly higher than that for silicon posts and pore spaces filled with water with signal to noise ratio 10 a threshold value was unambiguously determined for each image to distinguish the scco2 phase from others following methods outlined by zhang et al 2011 and chang et al 2016 segmentation and analysis of these images were conducted using imagej software rasband 1997 2018 the image segmentation method was validated by comparing 1 the measured porosity from fluorescent images to that computed from the micromodel design and 2 the measured size of silicon posts to the design value both of the comparisons showed good agreement with errors 5 for micromodel 3 images taken at a resolution of 1 62 µm pixel failed to capture the very tight pore throat with 3 µm width see fig 1 leading to an error in image segmentation and underestimation of the pore volume by 2 5 co2 distributions were assumed to be uniform along the micromodel depth for the calculation of co2 saturations this assumption has been widely used for 2d micromodel experiments zhang et al 2011 wang et al 2013 chang et al 2017 hu et al 2017 3 co2 imbibition and dissolution processes a series of imbibition dissolution experiments was conducted in the homogeneous and isotropic micromodel 1 under different displacement rates varying from 10 to 200 µl h logca 6 53 to 5 23 during each experiment time lapse images of scco2 distribution were obtained to calculate a scco2 saturation and depletion rate qd 3 1 imbibition and residual co2 saturation fig 2 a shows selected time lapse images of scco2 distribution green obtained during the imbibition dissolution experiment with logca 6 53 water dark invades the pore network in several narrow with 1 2 pore bodies wide and long flow paths and flows through the pore network within 2 min initially the residual water clusters near the inlet help induce channelized water flow see the white arrows at 0 and 5 6 pv in fig 2a the channelized water flow results in a high residual scco2 saturation sg r of 0 82 see fig 2a at 6 4 pv injection and table 3 with the majority of injected water flowing through water flow channels and bypassing the rest of the pore network similar channelized water flow is observed in the imbibition dissolution experiment with logca 6 13 see fig 2b five narrow water flow paths at 1 2 pore width labeled as c1 c2 c3 c4 and c5 have been created by 2 4 pv 22 min after the start of water injection the residual co2 saturation at the end of imbibition when no additional co2 was displaced from the pore network is 0 79 also see table 3 in this homogeneous micromodel the bypass of scco2 by displacing water can be attributed to the initially heterogeneous fluid distribution near the inlet similar bypass trapping of residual co2 has been observed in a homogeneous micromodel hu et al 2017 and a glass beads column chaudhary et al 2013 at ca 10 7 the main trapping mechanism was shown by the propagation of invading fluid fingers that lead to clusters of defending fluid being bypassed hu et al 2017 3 2 coupled co2 dissolution and water flow after imbibition scco2 dissolution and mass transfer are dominant mechanisms for scco2 depletion with time in the case with logca 6 53 a low tortuosity flow path connected to the outlet gradually develops as the main water flow path and its width continuously increases with scco2 dissolution until the complete depletion of residual scco2 see fig 2a fig 3 a and b show the temporal co2 saturation averaged over the pore network and effluent dsco2 concentration at the micromodel outlet as a function of water injection time or pore volume pv during the experiment while fig 3c shows the dependence of scco2 depletion rate g pv on scco2 saturation the rate of scco2 depletion is defined as the depleted scco2 mass g per pv and calculated from two consecutive images the dsco2 concentration is calculated as follows on the basis of mass balance assuming that dissolution and water advection are solely responsible for the scco2 depletion after the imbibition is complete 2 c ρ p s t 2 s t 1 m q t 2 t 1 here c is the dissolved co2 concentration mol l ρ is co2 density under experimental conditions g ml p is pore volume of the porous network ml s t2 and s t1 indicates co2 saturation at two sequential images t represents water injection time min q is the water injection rate l min and m 44 g mol refers to the co2 molar mass note that scco2 saturation dsco2 concentration and scco2 depletion rate are average values over the entire pore network domain if not otherwise specified the assumption that dissolution and water advection are solely responsible for the scco2 depletion after the imbibition is made carefully by substantial evidence showing no displacement of co2 occur after the completion of imbibition i e the co2 bubbles clusters at the outlet triangle void shrink due to dissolution and no additional co2 displaced out from the pore network was seen see figure s3 the evaporation of water in scco2 was negligible when calculating the co2 depletion under the experimental conditions 40 c 9 mpa the solubility of water in scco2 is 3 5 10 3 mole fraction while the solubility of scco2 dissolved in water is 22 10 3 in mole fraction spycher and pruess 2005 meanwhile the dissolution and mass transfer of scco2 in water are enhanced by water advection while evaporation of water in scco2 is diffusion dominated in the stagnant co2 evaporation of water in scco2 thus has a limited effect on the scco2 depletion rate after imbibition as shown in fig 3a it takes 2010 min to complete the depletion of scco2 by imbibition 150 min or 6 pv and dissolution 1860 min or 80 pv the rate of scco2 depletion by dissolution with initial scco2 saturation of 0 82 varies from 1 67 10 6 to 4 72 10 5 g pv and corresponds to an effluent dsco2 concentration of 0 82 22 4 of co2 solubility cs 1 225 mol l under the experimental conditions spycher and pruess 2005 in contrast under equilibrium dissolution assumption 6 7 pv of injected water is needed to completely dissolve the residual co2 in the pore network corresponding to 97 min at the 10 µl h 0 069 pv min water injection rate the coupled scco2 dissolution and water flow can be first understood by the non monotonic temporal change in scco2 depletion rate i e scco2 depletion rate increases first from 0 2 10 5 g pv to 4 7 10 5 g pv first with decreasing scco2 saturation in the pore network from 0 80 until a certain value 0 45 in fig 3c after which the rate decreases this trend is also seen in fig 3b for dsco2 concentration to improve understanding of the coupled processes we depict in fig 4 the fraction and location of scco2 mass dissolved within different time intervals in the micromodel at logca 6 53 with different colors corresponding to different injection times and pvs along the boundary layers marked by white dotted lines of the two bypassed scco2 clusters separated by the single water flow path water flow develops in local pores pore clusters and breaks large connected scco2 clusters by dissolution see the white arrows cooler colors in warmer color regions the local water flow paths developed by scco2 dissolution greatly increase the average dsco2 concentration in the entire pore network from 0 82 to 22 4 of co2 solubility the increased scco2 dissolution rate by coupled dissolution and water flow is similar to that observed experimentally by zhang et al 2002 and chang et al 2016 and verified numerically by zhao and ioannidis 2003 at later times this coupling of scco2 dissolution and water flow is weakened due to the reduced residual co2 mass available for dissolution the overall dsco2 concentration vs water injection volume and co2 depletion rate vs co2 saturation thus shows a maximum value the coupling between scco2 dissolution and water flow can be further understood by the multiple water flow paths and their competition in the case with logca 6 13 as shown in fig 2b flow paths c2 c3 and c4 increases in their width simultaneously during the first 214 min after that all injected water migrates through flow path c2 and its width increases with time until the complete depletion of residual scco2 fig 5 a c shows magnified local regions with 30 pores wide along each flow path to show the competition between flow paths c2 through c4 and in fig 5d shows the temporal saturation change during the first 244 min 17 pv for c2 upstream scco2 dissolves into the displacing water along the flow path and scco2 saturation decreases almost linearly with time from 0 81 to 0 74 indicating a relatively constant scco2 dissolution rate along c3 however scco2 saturation decreases nonlinearly with time from 0 72 to 0 68 with a decreasing co2 dissolution rate the stable scco2 bubbles within the narrow flow path marked by the red arrow in fig 5b may indicate high local dsco2 concentration close to solubility in c4 as scco2 dissolves in the upstream water a large scco2 cluster is displaced and blocked the narrow flow path downstream this local displacement terminates the water flow and reduces co2 depletion rate after 214 min c3 and c4 are suppressed and c2 dominates further scco2 depletion in the entire pore network see fig 2b for c1 and c5 the water flow paths are not connected to the micromodel outlet after imbibition resulting in a constant co2 saturation as shown in fig 5d fig 3d and e show the temporal network averaged co2 saturation and effluent dsco2 concentration as functions of water injection time or volume for the case with logca 6 13 while fig 3f shows the dependence of scco2 depletion rate on scco2 saturation the scco2 depletion rate increases from 4 0 10 6 to 1 9 10 5 g pv and the corresponding dsco2 concentration varies from 1 88 to 8 98 of co2 solubility fig 6 depicts the fraction and location of scco2 mass dissolved at different injection times and volumes indicating that the coupled scco2 dissolution and water flow occur in the boundary layers of bypassed scco2 clusters as shown in the figure the main water flow path c2 is less tortuous than that in fig 4 and the coupled water flow and dissolution is less pronounced with reduced transverse water flow into the bypassed scco2 clusters an additional imbibition experiment without dissolution was conducted by injecting dsco2 saturated water at logca 6 13 fig 7 shows the time lapse images and tortuous water flow paths the residual scco2 saturation after imbibition without dissolution is 0 72 the tortuous flow paths are compared to the five straight ones in fig 2b this indicates that dissolution can lead to scco2 displacement in more focused less tortuous narrower flow paths with reduced sweep efficiency the depletion of scco2 by dissolution at local pores may enhance water flow development and reduce resistance from scco2 within the flow path similar observations have been presented by chang et al 2016 3 3 effects of water velocity on imbibition and dissolution the velocity effects on imbibition and dissolution were investigated by increasing water injection rates in the imbibition dissolution experiments conducted in micromodel 1 fig 8 shows the time lapse images of scco2 water distribution in the cases with logca 5 83 5 53 and 5 23 injected water displaces scco2 in randomly distributed forward and lateral flow paths i e in the form of a dendritic front leaving small scco2 clusters entrapped sweep efficiency is greatly increased with increasing displacement rates resulting in larger number and width of the invading water flow paths resulting in residual scco2 saturation at the end of imbibition at 0 57 0 58 and 0 47 for logca 5 83 5 53 and 5 23 respectively see table 3 the imbibition characteristics appear to transit from channelized water flow observed in the two low flow rate cases with logca 6 53 and 6 13 to dendritic displacement in the higher rate cases the transition of water flow regimes from channeling flow to dendritic displacement shown in figs 2 and 8 may also be attributed to the high pore throat aspect ratio 12 of micromodel 1 and increased viscous force with injection rates this transition observed experimentally in this study is similar to that obtained by pore scale modeling with different flow rates and pore throat aspect ratios conducted by hughes and blunt 2000 they found channelized water flow in the case with a small water injection rate logca 6 0 and a high pore throat aspect ratio 3 95 and dendritic displacement in the cases with higher injection rates logca 6 0 and both high and low pore throat aspect ratio 3 95 and 2 1 the rate dependent imbibition characteristics considerably impact the subsequent scco2 dissolution and mass transfer fig 9 shows the depletion of the residual scco2 by dissolution at different time and water injection volumes for the three high rate experiments after imbibition small isolated scco2 clusters within the water flow paths dissolve first followed by the larger bypassed clusters the coupled dissolution and local water flow marked by the white arrows in fig 9 occur and enhance scco2 dissolution in the pore network fig 10 shows the comparison of the time dependent scco2 saturation dsco2 concentration and scco2 depletion rate among the five experiments with logca from 6 53 to 5 23 conducted in micromodel 1 the scco2 depletion time after imbibition is 1860 1272 557 235 and 122 min respectively see table 3 indicating the effect of flow rate on the scco2 residual saturation and the enhanced dissolution with flow rate in contrast it would take 97 40 14 7 and 3 min for equilibrium dissolution to completely deplete residual scco2 in the corresponding experiment the prolonged depletion time indicates non equilibrium dsco2 dissolution in the homogeneous pore network caused by 1 non uniform scco2 water distribution after imbibition and 2 non uniform water flow paths during dissolution the depletion time mainly depends on the dissolution rate of large scco2 clusters surrounded by water carrying flow paths even though enhanced dissolution can be caused by additional local or global water flow paths fig 10b displays that the peak dsco2 concentration caused by coupled dissolution and water flow decreases with increasing imbibition rates larger ca these rate dependent coupled processes can be attributed to the residence time of injected water in the pore network longer residence time with lower imbibition rates allows for longer contact between scco2 and mobile water that is available for dissolution and mass transfer in addition because of the water wet silica surface water flow may occur as thin film along the surface of the silica posts zhao et al 2016 zacharoudiou et al 2017 hu et al 2018 the swelling of water films was investigated as a slow diffusion process driven by capillary pressure at localities nguyen et al 2006 i e with the increase in water injection rate the time for swelling of wetting films and development of local water flow is shortened the coupling between dissolution and local water flow is thus limited reducing the dsco2 concentration in the pore network this indicates that water flow at a high velocity is less effective in dissolving residual scco2 than that at a slower velocity and equilibrium scco2 dissolution may only occur in regional groundwater flow with a very small close to zero velocity to be further discussed in section 5 4 effects of pore characteristics imbibition and dissolution experiments were conducted in micromodels 2 3 and 4 to improve understanding of the impacts of pore characteristics i e anisotropy and heterogeneity on co2 dissolution and its coupling with water flow 4 1 anisotropy with higher longitudinal permeability kt kl 0 63 in micromodel 2 with higher longitudinal permeability kt kl 0 63 two imbibition and dissolution experiments were conducted by injecting water at 10 and 50 µl h logca 6 56 and 5 86 due to the higher longitudinal permeability both drainage and imbibition efficiencies are reduced compared to micromodel 1 after drainage scco2 saturations are 0 50 for subsequent imbibition experiments fig 11 a and b show selected temporal images of scco2 water distribution during the two experiments water invades the pore network from left boundary in narrow flow channels marked by white dotted lines with reduced displacement efficiency leading to residual scco2 saturation of 0 43 and 0 44 after imbibition fig 11c e show the temporal co2 saturation dsco2 concentration and scco2 depletion rate the residual co2 was completely depleted after water injections at 1300 and 275 min corresponding to 55 and 60 pv see figure s4a respectively with logca 6 56 and 5 86 the co2 depletion rate increases with decreasing scco2 saturation fig 11e and the dsco2 concentration increases with water injection volumes fig 11d indicating the coupling of co2 dissolution with water flow the coupling occurs when water flow paths merge with stagnant water clusters see the white arrows in fig 11a and several flow paths merge into a large one see the white arrows in fig 11b 4 2 anisotropy with higher transverse permeability kt kl 6 86 two imbibition dissolution experiments were conducted in micromodel 3 with a higher transverse permeability kt kl 6 86 by injecting water at 10 and 50 µl h logca 6 27 and 5 58 under these conditions both drainage and imbibition efficiency is high compared to micromodels 1 and 2 scco2 saturation is stable at 0 90 after drainage and injected water invades widely distributed over the entire pore network see fig 12 a and b the displaced co2 saturation is 0 38 and 0 49 respectively resulting in residual co2 saturation at 0 52 and 0 44 after imbibition see table 3 the temporal change in co2 saturation is shown in fig 12c it takes 320 min 19 pv and 90 min 27 pv to completely deplete the scco2 by imbibition and dissolution at logca 6 27 and 5 58 respectively see figure s4b for the change of co2 saturation vs injected water pore volumes the depletion of residual scco2 by dissolution starts after 40 min 5 pv and 20 min 13 pv and the dsco2 concentration monotonically decreases with increased water injection volumes see fig 12d a monotonic decrease is also observed for the temporal change in co2 depletion rate fig 12e the fast depletion and high dsco2 concentration by dissolution in these two experiments can be attributed to the strong water film flow driven by high capillary pressure in the very tight pores and pore throats in micromodel 3 the distributed contact between scco2 and mobile water is pervasive through the entire pore network promoting scco2 dissolution everywhere no dominant water flow paths are observed 4 3 sandstone analog heterogeneity a series of imbibition and dissolution experiments were conducted in heterogeneous sandstone analog micromodel 4 and reported in chang et al 2016 time lapse images of scco2 water distribution show water preferential water flow along the high permeability channels and bypass the majority of pore network domain where co2 was trapped and residual water after drainage was stagnant see fig 13 the results of dynamic dsco2 concentration vs water injection show that scco2 dissolution at the pore network scale is controlled by 1 the number of water flow paths developed along the high permeability channels and 2 the velocity of water flow or dissolution time at a low injection rate logca 5 34 one water flow path develops with strong coupling between dissolution and water flow with increasing in water injection rate logca 4 34 2 3 water flow paths develop along the high permeability channels while the coupling between dissolution and water flow is diminished and dsco2 concentration decreases with water injection volumes more details on the water flow and scco2 dissolution can be seen in figures s5 and s6 in the supporting material and chang et al 2016 in summary the coupling of dissolution with water flow in this heterogeneous micromodel depends largely on injection rate and capillary number 5 pore scale capillary desaturation curve and cluster based capillary number fig 14 shows the residual scco2 saturation and effluent dsco2 concentration as a function of ca for the 13 imbibition and dissolution experiments in the four micromodels the evolution of pore scale residual co2 saturation follows a typical cdc for micromodels 1 and 4 and the residual co2 saturations remain high at low ca and decrease sharply at a critical ca marked by the arrows in fig 14a the residual co2 saturation in micromodel 1 shows a reduction from 0 82 to 0 47 larger than that from 0 54 to 0 37 in micromodel 4 meanwhile the residual co2 saturation decreases considerably at logca 5 83 in micromodel 1 while a great reduction occurs at logca 5 34 in micromodel 4 this indicates a higher viscous force is required for mobilizing the trapped co2 in the heterogeneous micromodel 4 the pore heterogeneity tends to limit water flow in high permeability channels and reduce viscous force to the bypassed co2 while the cdc for micromodels 2 and 3 are not complete residual co2 saturations in the two anisotropic micromodels are lower than in micromodels 1 and 4 at similar ca caused by a lower drainage efficiency in micromodel 2 and a higher imbibition efficiency in micromodel 3 see tables 2 and 3 as shown in fig 14b the dsco2 concentration generally decreases with increasing ca consistent with the cdc in fig 13a under the same ca the dsco2 concentration increases with increasing water displacement efficiency from the lowest 2 of co2 solubility in micromodel 4 to highest 9 13 of co2 solubility in micromodel 3 the dsco2 concentrations in micromodels 1 and 2 range from 2 to 5 of co2 solubility the cdc shown in fig 14a represents the pore network scale sweep efficiency as channelized water flow and bypass dominate the displacement the bypassed pore network domain may be composed of both trapped co2 ganglia and stagnant water see fig 13 which does not transfer viscous force or contribute to the mobilization of co2 here we calculate the cluster based capillary number c a following hilfer and oren 1996 3 c a l c l μ u k p b where lcl is the average cluster length with saturation weighting for each cluster 4 l c l s c l c l s c lcl represents the cluster size of the bypassed pore network domain instead of individual co2 ganglia from hilfer and oren 1996 k is the absolute brine permeability and pb is the capillary pressure at breakthrough estimated from the pore size and depth of the micromodel 5 p b σ c o s θ r 1 r 2 r 1 r 2 in eq 5 σ 28 mn m2 chiquet et al 2007 and for micromodel 1 r 1 60 µm r 2 37 µm for micromodel 2 r 1 106 µm r 2 37 µm for micromodel 3 r 1 41 6 µm r 2 37 µm for micromodel 3 r 1 33 µm r 2 35 µm the lcl values for each imbibition dissolution experiment are listed in table 3 fig 14c displays cdc with c a the desaturation of co2 occurs at c a 0 52 and 1 69 in micromodels 1 and 2 respectively if individual co2 ganglia are used for calculating c a the plot for micromodel 4 shifts left by 2 orders of magnitude c a may be modified further with measurements of relative permeability following armstrong et al 2014 we show here the uncertainty of determining the cluster size and the important role of water flow regime while the cluster based capillary number provides new insights into the non wetting phase mobilization when considering the system characteristics both pore space and resident fluid a broader application requires a better calculation of the size of the non wetting phase clusters especially when direct visualization and imaging are unavailable 6 the relation between dsco2 concentration and logca we ve shown in sections 3 and 4 that the bypass of scco2 by displacing water is the dominant mechanism contributing to residual co2 trapping without buoyancy bypass can be caused by the heterogeneity of pore characteristics e g micromodel 4 and pore scale fluid distribution after drainage e g micromodels 1 2 and 3 after imbibition dissolution of residual co2 is dependent on the displacement rate and pore characteristics in fig 15 a we show the correlation of dsco2 concentration vs peclet number pe for the imbibition dissolution experiments conducted in the four micromodels the overall dsco2 concentrations decrease with increasing pe which can be attributed to 1 the decrease in residual co2 saturation after imbibition for dissolution 2 the decrease in residence time and 3 the reduced coupling between co2 dissolution and water flow we also note the effects of pore characteristics on co2 dissolution and mass transfer for instance under the same range of pe 0 3 17 dsco2 concentration is lowest in the heterogeneous micromodel because of the preferential water flow along the high permeability channels see figure s5 6 for details the value is highest in the strong anisotropic micromodel 3 with higher transverse permeability kt kl 6 86 and 2 5 of solubility in homogeneous micromodel 1 and weakly anisotropic micromodel 2 the change of dsco2 concentration vs reynold number re shows a similar trend see fig 15b and tables 2 and 3 to improve understanding of the scco2 dissolution process for these experiments in particular and other non wetting phase fluids in general we propose a diagram between the relative concentration of dissolved constituents and flow velocity in terms of logca the diagram fig 16 includes 1 the average dsco2 concentration solid symbol and the range between maximum and minimum time dependent concentrations bar in each dissolution experiment in this study 2 the average and range of dsco2 concentration obtained in the core flooding tests conducted in two low permeability sandstone cores chang et al 2014 3 the average concentration obtained in a high permeability berea sandstone core berg et al 2013 and 4 dissolved napl concentrations obtained in dissolution experiments conducted in homogeneous and heterogeneous micromodels with logca 6 80 and 6 0 chomsurin and werth 2003 the flow velocity capillary number and reynolds number in berg et al 2013 are 0 37 m day 9 3 10 8 and 1 06 while the values in chang et al 2014 are 0 73 m day 1 8 10 7 and 0 64 the relative concentration in percentage to the solubility of scco2 or napl under the experiment conditions is used in the diagram the overall trend shown in fig 16 is that the dissolved non wetting phase fluid concentration increases with a decrease in logca i e the increase in water residence time and approaches to their solubility with sufficient residence time in addition to the main trend the relative dissolved phase concentration is also affected by the pore heterogeneity and anisotropy and the coupled dissolution and water flow that depend on limited or pervasive water flow paths in the regime of non equilibrium dissolution this effect can be understood by the wide range of relative concentration for a given logca or water residence time the average relative concentration varies from the lowest 2 in micromodel 4 with strong heterogeneity to the highest 9 to 13 in micromodel 3 with strong anisotropy in micromodels 1 and 2 with isotropic homogeneity and weak anisotropy the concentration ranges from 2 to 5 the lower relative concentration in the heterogeneous micromodel implies that for the same groundwater velocity it may take longer residence time or water flow path length in a heterogeneous formation for scco2 water to reach equilibrium dissolution than that in a homogeneous one through the dsco2 concentration vs co2 saturation observed in the four micromodels figs 11 12 and 13 we are able to classify 1 zone i where relative concentration monotonically decreases with decreasing residual saturation marked by the red bars and no coupling of co2 dissolution and water flow was observed and 2 zone ii where relative concentration non monotonically changes with decreasing residual co2 saturation marked by the black bars and dissolution is coupled with water flow zones i and ii are divided at a relative concentration of 5 the dashed line and logca of 5 20 the dashed line for 2 concentration separates the dsco2 concentration in the heterogeneous micromodel from the other micromodels and cores the proposed diagram helps describe the conditions that the coupled dissolution and water flow may occur at both pore scale with varying pore characteristics and core scale with varying porosities and permeabilities 7 conclusions and implications we ve systematically investigated the non equilibrium co2 dissolution and its coupling with global and local water flow using four micromodels that represent porous media with varying anisotropy heterogeneity and pore throat aspect ratio time lapse images of scco2 water distributions were obtained during each imbibition and dissolution experiment to quantify the dynamic dissolution process in the four centimeter scale micromodels and at imposed water velocities resulting in logca 6 56 to 4 34 we show that bypass of scco2 by displacing water is the dominant mechanism contributing to residual co2 trapping without buoyancy bypass can be triggered by heterogeneity in pore characteristics e g micromodel 4 and pore scale scco2 water distribution e g micromodels 1 and 2 higher transverse permeability e g micromodel 3 may reduce the bypass and increase pore network sweep efficiency after imbibition dissolution dominates the depletion of residual co2 we show the dissolved co2 concentration increases with increasing water displacement efficiency under same rates from the lowest 2 of co2 solubility in micromodel 4 to highest 9 13 of co2 solubility in micromodel 3 the low dsco2 concentration in the heterogeneous micromodel implies that under the same groundwater velocity it may take longer residence time or water flow path length in a heterogeneous formation for scco2 water to reach equilibrium dissolution than that in a homogeneous one the diagram between relative dissolved concentration and logca was developed by using the average and range of relative concentrations in each of the 13 experiments and in published core and micromodel experiments the diagram shows that the concentration of dissolved non wetting phase fluids e g dsco2 increases with the decreasing capillary number and approaches solubility at low ca value with sufficient residence time this main trend is similar to a cdc in a bypass dominated displacement spatially dissolution of residual co2 initiates along the boundary of the bypassed co2 cluster s in a non equilibrium manner and the dsco2 concentration in water decreases with increasing ca and pe the main trend is secondarily affected by the coupled dissolution and water flow at localities that fragment the bypassed scco2 clusters and enhance scco2 dissolution at the pore scale for a reservoir scale scco2 plume after cessation of injection residual co2 trapping may be dominated by capillary snap off as ambient groundwater flow rate is relatively slow ca 10 7 the long residence time favors local dissolution and coupled with water flow to approach near equilibrium dissolution on the other hand due to the heterogeneous nature of reservoir formations drainage and imbibition may focus flow in high permeability channels and fast dissolution of residual co2 into flowing water can be expected for a scco2 plume in those low permeability regions dissolution is expected to be a lengthy process because of limited interfacial area between mobile water and immobile scco2 coupling of water flow and dissolution at localities may occur after the completion of main imbibition in the high permeability channels and shorten the dissolution process to some extent in summary the reservoir scale dissolution will be collectively affected by slow ambient groundwater flow and strongly heterogeneity controlled interfacial areas between groundwater flow and the scco2 plume acknowledgments this material was based upon the work supported by the u s department of energy office of science office of basic energy sciences energy frontier research centers program under contract no de ac02 05ch11231 the first author was also supported by the national natural science foundation of china grant nos 51704297 51674251 and the china postdoctoral science foundation 2017t100115 the micromodel experiments were conducted at the william r wiley environmental molecular sciences laboratory emsl a scientific user facility of the u s department of energy s office of biological and environmental research operated by the pacific northwest national laboratory pnnl supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 004 appendix supplementary materials image application 1 
710,dissolution trapping is one of the most important mechanisms for geological carbon storage gcs recent laboratory and field experiments have shown non equilibrium dissolution of supercritical co2 scco2 and coupled scco2 dissolution and water flow i e scco2 dissolution at local pores pore throats creating new water flow paths which in turn enhance dissolution by increased advection and interfacial area however the impacts of pore scale characteristics on these coupled processes have not been investigated in this study imbibition and dissolution experiments were conducted under 40 c and 9 mpa using a homogeneous isotropic hexagonal micromodel two homogeneous elliptical micromodels with low or high anisotropy and a heterogeneous sandstone analog micromodel the four micromodels initially saturated with deionized di water were drained by injecting scco2 to establish a stable scco2 saturation di water was then injected at different rates with logca the capillary number ranging from 6 56 to 4 34 results show that bypass of scco2 by displacing water is the dominant mechanism contributing to the residual co2 trapping triggered by heterogeneity in pore characteristics or pore scale scco2 water distribution bypass can be enhanced by pore heterogeneity or reduced by increasing transverse permeability resulting in relatively low 2 of co2 solubility or high 9 13 of co2 solubility dissolved co2 concentration in displacing water the overall dissolution of residual scco2 increases with decreasing ca and approaches to their solubility at low ca value with sufficient residence time this main trend is similar to a capillary desaturation curve that represents the relationship between the residual saturation and ca spatially dissolution initiates along the boundary of bypassed scco2 cluster s in a non equilibrium manner and the coupling of water flow and dissolution occurs which fragments the bypassed scco2 clusters and enhance scco2 dissolution keywords geological carbon storage micromodel pore characteristics imbibition co2 dissolution mass transfer 1 introduction accurate prediction of the long term storage of co2 in subsurface formations depends largely on our understanding of involved processes such as 1 two phase fluid displacement and residual co2 saturation and 2 dissolution of injected supercritical co2 scco2 and mass transfer of dissolved co2 dsco2 in formation brine ipcc 2005 the field tests of scco2 dissolution at the co2crc otway site haese et al 2013 paterson et al 2013 have shown unexpectedly early breakthrough and low maximum dsco2 concentrations 30 of co2 solubility in the produced water that were credited to formation heterogeneity indicating the non equilibrium scco2 dissolution and mass transfer at the field scale at the core scale berg et al 2013 conducted imbibition and scco2 dissolution experiments in a homogeneous high permeability 380 md berea sandstone core at 10 mpa and 45 c by injecting dsco2 undersaturated brine at 0 25 ml min into the core after scco2 drainage they observed strong dissolution of residual scco2 into displacing brine with relatively high dsco2 concentration 60 of co2 solubility in contrast chang et al 2013 2014 observed that the complete post imbibition depletion of residual scco2 via dissolution was a prolonged process when injecting deionized di water free of dsco2 at 1 0 ml min into two heterogeneous and low permeability 1 md sandstone cores at 8 mpa and 40 c the average dsco2 concentration was measured as 5 of co2 solubility one order of magnitude lower than that in berg et al 2013 at the pore scale chang et al 2016 investigated scco2 dissolution and mass transfer during imbibition in a heterogeneous sandstone analog micromodel fabricated from section micrographs of a low permeability mt simon sandstone core zuo et al 2013 their time lapse images of scco2 water distributions provide direct observations of the non equilibrium co2 dissolution and mass transfer caused by bypass of residual scco2 by displacing water after imbibition and slow mass transfer of dsco2 to displacing water the inferred dsco2 concentrations in this centimeter scale micromodel ranged from 0 38 to 2 72 of co2 solubility the disparate observations in dsco2 concentrations across these scales indicate that the effects of formation heterogeneity and pore scale characteristics on scco2 dissolution and mass transfer need to be investigated laboratory experiments have also shown coupled scco2 dissolution and water flow i e scco2 dissolution at local pores pore throats creating new water flow paths which in turn enhance dissolution by increased advection and interfacial area at the core scale akbarabadi and piri 2013 observed an increase in brine relative permeability caused by gradual reduction in the blockage by trapped scco2 bubbles via dissolution at the pore scale buchgraber et al 2012 showed the disconnecting and shrinking of co2 bubbles due to dissolution indicating scco2 snap off and residual trapping the disconnection and shrinkage of the co2 phase in return enhances co2 dissolution and mass transfer by increasing co2 water interfacial area and creating new water flow paths chang et al 2016 nambi and powers 2000 and zhang et al 2002 reported similar coupled processes for the dissolution of non aqueous phase liquid napl in water in heterogeneous sand boxes and columns packed with angular silica sands alternately chomsurin and werth 2003 showed constant napl dissolution rate with decreasing napl saturation during their imbibition experiments in 2d homogeneous and heterogeneous micromodels addressing the apparently contradictory observations requires a systematic study on the impacts of pore characteristics on trapping mechanism and dissolution of residual co2 when gravitational forces are negligible the nature of two phase displacement at the pore scale has been characterized by the dimensionless capillary number ca that represents the relative effect of viscous forces versus capillary force and by the viscosity ratio m between liquid phases the ca is often defined as follows 1 c a μ u σ c o s θ where µ is the viscosity u the average darcy velocity of the injected fluid σ the interfacial tension and θ the contact angle between the injected and resident fluid lenormand et al 1988 the phase entrapment at a given ca and m can be described by the capillary desaturation curve cdc which represents the relationship between the residual non wetting saturation and ca sahimi 1993 castro et al 2015 the pore scale cdc has been investigated in a micromodel with a statistically generated pore size distribution castro et al 2015 their results suggest the dependence of cdc shape on the amount and size distribution of the residual phase it has also been reported that the traditional ca in eq 1 should be revised using the length scales corresponding to the size of non wetting phase clusters and the revised ca is referred to as cluster based ca hilfer and oren 1996 armstrong et al 2014 the influence of pore characteristics on pore scale cdc and cluster based ca for residual trapping and the later dissolution of residual co2 needs further investigations in this study we 1 present the fundamental trapping mechanism and the processes of the non equilibrium co2 dissolution coupled with water flow 2 investigate the impacts of pore characteristics on co2 trapping the pore scale cdc and the coupled processes and 3 propose a diagram to quantify the network dependent coupled processes a series of imbibition and scco2 dissolution experiments was systematically conducted in four micromodels with post drainage scco2 saturations by injecting dsco2 free brine at different rates time lapse high resolution images of scco2 and water were obtained to provide direct observations of the coupled processes at the pore scale and to allow for comparisons among the different micromodels and with previous studies at the pore and core scales the four micromodels represent typical pore characteristics of porous media with contrasts between homogeneity and heterogeneity between isotropy and weak and strong anisotropy and between different pore shapes we first present the details on the micromodels and experimental procedures in section 2 we show in section 3 the fundamental processes of co2 dissolution coupled with water flow in a homogeneous isotropic micromodel at two low injection rates logca 6 53 and 6 13 and then the effects of displacement rate on co2 dissolution in section 4 we discuss the impacts of pore characteristics on the coupled processes by comparing the experimental observations in all the four micromodels in section 5 we present the pore scale cdc and cluster based ca in different micromodels in section 6 we propose a diagram to describe the network dependent coupled processes and the overall trend between dsco2 concentration and ca or water residence time we conclude our observations and include implications on field gcs in section 7 2 materials and methods 2 1 micromodels fig 1 shows the pore characteristics of the four micromodels used in this study with pore space shown in white and silicon posts representing mineral grains in black micromodels were composed of etched silicon wafers fabricated using micro fabrication methods involving standard photolithography coupled plasma deep reactive ion etching icp drie thermal oxidation and anodic bonding chomsurin and werth 2003 willingham et al 2008 micromodel 1 consists of hexagonal posts and a homogeneous isotropic pore network with circular pore bodies 60 µm in diameter each connected with six pore throats 5 µm in width micromodels 2 and 3 are homogeneous anisotropic micromodels share the same elliptical silicon posts and have different post arrangements and thus different longitudinal kl and transverse kt permeability the ratio of kt kl is calculated as 0 63 for micromodel 2 and 6 86 for micromodel 3 using the relation k 1 2 a p 2 where a and p represent the area and perimeter of a rectangular cross section respectively white 1979 the design pore depth of the three micromodels is 37 µm the pore network of micromodel 4 is extracted from a section micrograph of a mt simon sandstone core collected from the injection well of the illinois basin decatur project zuo et al 2013 senel et al 2014 the porous medium portion consists of nine identical sub images in a 3 3 array see the red lines in fig 1 and features in three lateral high permeability channels see figure s1 in the supplementary information a local thickness plugin in imagej software hildebrand and rüesgsegger 1996 rasband 1997 2018 was used to quantify the pore size distribution shown in figure s1 the average pore body diameter and pore throat width is 33 and 14 µm respectively figure s1 presents an example of the micromodel design including the pore network 4 and the boundary conditions zuo et al 2013 the triangle sections on each side of the pore allow for an uniform water displacement before entering the pore network see figure s3 reducing water film flow before invading the pore network the inlet triangle volume was included when calculating the water injection pore volume pv additional details on the pore size distribution can be obtained from chang et al 2016 table 1 lists the properties of the four micromodels used in this study 2 2 experiments and fluorescence imaging an experimental setup with four high pressure syringe pumps teledyne isco inc lincoln ne was used for all imbibition dissolution experiments the experimental setup is described in detail in the supplementary figure figure s2 each micromodel was assembled against a sapphire viewing window in a high pressure cell allowing imaging the micromodel was initially saturated with deionized di water and then drained by injecting coumarin dyed scco2 biswas et al 1999 at a constant rate until stable scco2 distribution and saturation were established the displaced water during drainage was collected in a pressure pump maintaining back pressure at a constant fluid pressure of 9 00 mpa after scco2 distribution and saturation remained stable with time the scco2 distribution was imaged to calculate the baseline scco2 saturation the same drainage procedure was repeated before each imbibition dissolution experiment to obtain similar initial scco2 saturation sg i and distribution imbibition dissolution experiments were conducted by injecting di water at a constant volumetric rate until scco2 in the pore network was completely depleted displaced scco2 was collected in the back pressure pump constantly maintained at 9 00 mpa different water injection rates were used for each micromodel see table 2 to allow for comparisons between imbibition dissolution experiments and micromodels we calculated the capillary number ca for each test from eq 1 the reported contact angle of water courmarin dyed scco2 in micromodels fabricated using similar silicon wafers is approximately 15 wang et al 2012 σ is inferred from chiquet et al 2007 for scco2 and water during each imbibition dissolution experiment the stained scco2 in the micromodel was observed through a blue gfp filter set λex 379 401 nm λem 435 485 nm time lapse images were obtained using a nikon eclipse te2000 e epifluorescent inverted microscope melville ny equipped with a monochrome ccd camera mu1003 amscope through a 4x objective with a spatial resolution of 1 62 µm pixel during the experiment images were taken at 2 40 min intervals depending on the water injection rates and durations the fluorescent signal intensity of dyed scco2 is significantly higher than that for silicon posts and pore spaces filled with water with signal to noise ratio 10 a threshold value was unambiguously determined for each image to distinguish the scco2 phase from others following methods outlined by zhang et al 2011 and chang et al 2016 segmentation and analysis of these images were conducted using imagej software rasband 1997 2018 the image segmentation method was validated by comparing 1 the measured porosity from fluorescent images to that computed from the micromodel design and 2 the measured size of silicon posts to the design value both of the comparisons showed good agreement with errors 5 for micromodel 3 images taken at a resolution of 1 62 µm pixel failed to capture the very tight pore throat with 3 µm width see fig 1 leading to an error in image segmentation and underestimation of the pore volume by 2 5 co2 distributions were assumed to be uniform along the micromodel depth for the calculation of co2 saturations this assumption has been widely used for 2d micromodel experiments zhang et al 2011 wang et al 2013 chang et al 2017 hu et al 2017 3 co2 imbibition and dissolution processes a series of imbibition dissolution experiments was conducted in the homogeneous and isotropic micromodel 1 under different displacement rates varying from 10 to 200 µl h logca 6 53 to 5 23 during each experiment time lapse images of scco2 distribution were obtained to calculate a scco2 saturation and depletion rate qd 3 1 imbibition and residual co2 saturation fig 2 a shows selected time lapse images of scco2 distribution green obtained during the imbibition dissolution experiment with logca 6 53 water dark invades the pore network in several narrow with 1 2 pore bodies wide and long flow paths and flows through the pore network within 2 min initially the residual water clusters near the inlet help induce channelized water flow see the white arrows at 0 and 5 6 pv in fig 2a the channelized water flow results in a high residual scco2 saturation sg r of 0 82 see fig 2a at 6 4 pv injection and table 3 with the majority of injected water flowing through water flow channels and bypassing the rest of the pore network similar channelized water flow is observed in the imbibition dissolution experiment with logca 6 13 see fig 2b five narrow water flow paths at 1 2 pore width labeled as c1 c2 c3 c4 and c5 have been created by 2 4 pv 22 min after the start of water injection the residual co2 saturation at the end of imbibition when no additional co2 was displaced from the pore network is 0 79 also see table 3 in this homogeneous micromodel the bypass of scco2 by displacing water can be attributed to the initially heterogeneous fluid distribution near the inlet similar bypass trapping of residual co2 has been observed in a homogeneous micromodel hu et al 2017 and a glass beads column chaudhary et al 2013 at ca 10 7 the main trapping mechanism was shown by the propagation of invading fluid fingers that lead to clusters of defending fluid being bypassed hu et al 2017 3 2 coupled co2 dissolution and water flow after imbibition scco2 dissolution and mass transfer are dominant mechanisms for scco2 depletion with time in the case with logca 6 53 a low tortuosity flow path connected to the outlet gradually develops as the main water flow path and its width continuously increases with scco2 dissolution until the complete depletion of residual scco2 see fig 2a fig 3 a and b show the temporal co2 saturation averaged over the pore network and effluent dsco2 concentration at the micromodel outlet as a function of water injection time or pore volume pv during the experiment while fig 3c shows the dependence of scco2 depletion rate g pv on scco2 saturation the rate of scco2 depletion is defined as the depleted scco2 mass g per pv and calculated from two consecutive images the dsco2 concentration is calculated as follows on the basis of mass balance assuming that dissolution and water advection are solely responsible for the scco2 depletion after the imbibition is complete 2 c ρ p s t 2 s t 1 m q t 2 t 1 here c is the dissolved co2 concentration mol l ρ is co2 density under experimental conditions g ml p is pore volume of the porous network ml s t2 and s t1 indicates co2 saturation at two sequential images t represents water injection time min q is the water injection rate l min and m 44 g mol refers to the co2 molar mass note that scco2 saturation dsco2 concentration and scco2 depletion rate are average values over the entire pore network domain if not otherwise specified the assumption that dissolution and water advection are solely responsible for the scco2 depletion after the imbibition is made carefully by substantial evidence showing no displacement of co2 occur after the completion of imbibition i e the co2 bubbles clusters at the outlet triangle void shrink due to dissolution and no additional co2 displaced out from the pore network was seen see figure s3 the evaporation of water in scco2 was negligible when calculating the co2 depletion under the experimental conditions 40 c 9 mpa the solubility of water in scco2 is 3 5 10 3 mole fraction while the solubility of scco2 dissolved in water is 22 10 3 in mole fraction spycher and pruess 2005 meanwhile the dissolution and mass transfer of scco2 in water are enhanced by water advection while evaporation of water in scco2 is diffusion dominated in the stagnant co2 evaporation of water in scco2 thus has a limited effect on the scco2 depletion rate after imbibition as shown in fig 3a it takes 2010 min to complete the depletion of scco2 by imbibition 150 min or 6 pv and dissolution 1860 min or 80 pv the rate of scco2 depletion by dissolution with initial scco2 saturation of 0 82 varies from 1 67 10 6 to 4 72 10 5 g pv and corresponds to an effluent dsco2 concentration of 0 82 22 4 of co2 solubility cs 1 225 mol l under the experimental conditions spycher and pruess 2005 in contrast under equilibrium dissolution assumption 6 7 pv of injected water is needed to completely dissolve the residual co2 in the pore network corresponding to 97 min at the 10 µl h 0 069 pv min water injection rate the coupled scco2 dissolution and water flow can be first understood by the non monotonic temporal change in scco2 depletion rate i e scco2 depletion rate increases first from 0 2 10 5 g pv to 4 7 10 5 g pv first with decreasing scco2 saturation in the pore network from 0 80 until a certain value 0 45 in fig 3c after which the rate decreases this trend is also seen in fig 3b for dsco2 concentration to improve understanding of the coupled processes we depict in fig 4 the fraction and location of scco2 mass dissolved within different time intervals in the micromodel at logca 6 53 with different colors corresponding to different injection times and pvs along the boundary layers marked by white dotted lines of the two bypassed scco2 clusters separated by the single water flow path water flow develops in local pores pore clusters and breaks large connected scco2 clusters by dissolution see the white arrows cooler colors in warmer color regions the local water flow paths developed by scco2 dissolution greatly increase the average dsco2 concentration in the entire pore network from 0 82 to 22 4 of co2 solubility the increased scco2 dissolution rate by coupled dissolution and water flow is similar to that observed experimentally by zhang et al 2002 and chang et al 2016 and verified numerically by zhao and ioannidis 2003 at later times this coupling of scco2 dissolution and water flow is weakened due to the reduced residual co2 mass available for dissolution the overall dsco2 concentration vs water injection volume and co2 depletion rate vs co2 saturation thus shows a maximum value the coupling between scco2 dissolution and water flow can be further understood by the multiple water flow paths and their competition in the case with logca 6 13 as shown in fig 2b flow paths c2 c3 and c4 increases in their width simultaneously during the first 214 min after that all injected water migrates through flow path c2 and its width increases with time until the complete depletion of residual scco2 fig 5 a c shows magnified local regions with 30 pores wide along each flow path to show the competition between flow paths c2 through c4 and in fig 5d shows the temporal saturation change during the first 244 min 17 pv for c2 upstream scco2 dissolves into the displacing water along the flow path and scco2 saturation decreases almost linearly with time from 0 81 to 0 74 indicating a relatively constant scco2 dissolution rate along c3 however scco2 saturation decreases nonlinearly with time from 0 72 to 0 68 with a decreasing co2 dissolution rate the stable scco2 bubbles within the narrow flow path marked by the red arrow in fig 5b may indicate high local dsco2 concentration close to solubility in c4 as scco2 dissolves in the upstream water a large scco2 cluster is displaced and blocked the narrow flow path downstream this local displacement terminates the water flow and reduces co2 depletion rate after 214 min c3 and c4 are suppressed and c2 dominates further scco2 depletion in the entire pore network see fig 2b for c1 and c5 the water flow paths are not connected to the micromodel outlet after imbibition resulting in a constant co2 saturation as shown in fig 5d fig 3d and e show the temporal network averaged co2 saturation and effluent dsco2 concentration as functions of water injection time or volume for the case with logca 6 13 while fig 3f shows the dependence of scco2 depletion rate on scco2 saturation the scco2 depletion rate increases from 4 0 10 6 to 1 9 10 5 g pv and the corresponding dsco2 concentration varies from 1 88 to 8 98 of co2 solubility fig 6 depicts the fraction and location of scco2 mass dissolved at different injection times and volumes indicating that the coupled scco2 dissolution and water flow occur in the boundary layers of bypassed scco2 clusters as shown in the figure the main water flow path c2 is less tortuous than that in fig 4 and the coupled water flow and dissolution is less pronounced with reduced transverse water flow into the bypassed scco2 clusters an additional imbibition experiment without dissolution was conducted by injecting dsco2 saturated water at logca 6 13 fig 7 shows the time lapse images and tortuous water flow paths the residual scco2 saturation after imbibition without dissolution is 0 72 the tortuous flow paths are compared to the five straight ones in fig 2b this indicates that dissolution can lead to scco2 displacement in more focused less tortuous narrower flow paths with reduced sweep efficiency the depletion of scco2 by dissolution at local pores may enhance water flow development and reduce resistance from scco2 within the flow path similar observations have been presented by chang et al 2016 3 3 effects of water velocity on imbibition and dissolution the velocity effects on imbibition and dissolution were investigated by increasing water injection rates in the imbibition dissolution experiments conducted in micromodel 1 fig 8 shows the time lapse images of scco2 water distribution in the cases with logca 5 83 5 53 and 5 23 injected water displaces scco2 in randomly distributed forward and lateral flow paths i e in the form of a dendritic front leaving small scco2 clusters entrapped sweep efficiency is greatly increased with increasing displacement rates resulting in larger number and width of the invading water flow paths resulting in residual scco2 saturation at the end of imbibition at 0 57 0 58 and 0 47 for logca 5 83 5 53 and 5 23 respectively see table 3 the imbibition characteristics appear to transit from channelized water flow observed in the two low flow rate cases with logca 6 53 and 6 13 to dendritic displacement in the higher rate cases the transition of water flow regimes from channeling flow to dendritic displacement shown in figs 2 and 8 may also be attributed to the high pore throat aspect ratio 12 of micromodel 1 and increased viscous force with injection rates this transition observed experimentally in this study is similar to that obtained by pore scale modeling with different flow rates and pore throat aspect ratios conducted by hughes and blunt 2000 they found channelized water flow in the case with a small water injection rate logca 6 0 and a high pore throat aspect ratio 3 95 and dendritic displacement in the cases with higher injection rates logca 6 0 and both high and low pore throat aspect ratio 3 95 and 2 1 the rate dependent imbibition characteristics considerably impact the subsequent scco2 dissolution and mass transfer fig 9 shows the depletion of the residual scco2 by dissolution at different time and water injection volumes for the three high rate experiments after imbibition small isolated scco2 clusters within the water flow paths dissolve first followed by the larger bypassed clusters the coupled dissolution and local water flow marked by the white arrows in fig 9 occur and enhance scco2 dissolution in the pore network fig 10 shows the comparison of the time dependent scco2 saturation dsco2 concentration and scco2 depletion rate among the five experiments with logca from 6 53 to 5 23 conducted in micromodel 1 the scco2 depletion time after imbibition is 1860 1272 557 235 and 122 min respectively see table 3 indicating the effect of flow rate on the scco2 residual saturation and the enhanced dissolution with flow rate in contrast it would take 97 40 14 7 and 3 min for equilibrium dissolution to completely deplete residual scco2 in the corresponding experiment the prolonged depletion time indicates non equilibrium dsco2 dissolution in the homogeneous pore network caused by 1 non uniform scco2 water distribution after imbibition and 2 non uniform water flow paths during dissolution the depletion time mainly depends on the dissolution rate of large scco2 clusters surrounded by water carrying flow paths even though enhanced dissolution can be caused by additional local or global water flow paths fig 10b displays that the peak dsco2 concentration caused by coupled dissolution and water flow decreases with increasing imbibition rates larger ca these rate dependent coupled processes can be attributed to the residence time of injected water in the pore network longer residence time with lower imbibition rates allows for longer contact between scco2 and mobile water that is available for dissolution and mass transfer in addition because of the water wet silica surface water flow may occur as thin film along the surface of the silica posts zhao et al 2016 zacharoudiou et al 2017 hu et al 2018 the swelling of water films was investigated as a slow diffusion process driven by capillary pressure at localities nguyen et al 2006 i e with the increase in water injection rate the time for swelling of wetting films and development of local water flow is shortened the coupling between dissolution and local water flow is thus limited reducing the dsco2 concentration in the pore network this indicates that water flow at a high velocity is less effective in dissolving residual scco2 than that at a slower velocity and equilibrium scco2 dissolution may only occur in regional groundwater flow with a very small close to zero velocity to be further discussed in section 5 4 effects of pore characteristics imbibition and dissolution experiments were conducted in micromodels 2 3 and 4 to improve understanding of the impacts of pore characteristics i e anisotropy and heterogeneity on co2 dissolution and its coupling with water flow 4 1 anisotropy with higher longitudinal permeability kt kl 0 63 in micromodel 2 with higher longitudinal permeability kt kl 0 63 two imbibition and dissolution experiments were conducted by injecting water at 10 and 50 µl h logca 6 56 and 5 86 due to the higher longitudinal permeability both drainage and imbibition efficiencies are reduced compared to micromodel 1 after drainage scco2 saturations are 0 50 for subsequent imbibition experiments fig 11 a and b show selected temporal images of scco2 water distribution during the two experiments water invades the pore network from left boundary in narrow flow channels marked by white dotted lines with reduced displacement efficiency leading to residual scco2 saturation of 0 43 and 0 44 after imbibition fig 11c e show the temporal co2 saturation dsco2 concentration and scco2 depletion rate the residual co2 was completely depleted after water injections at 1300 and 275 min corresponding to 55 and 60 pv see figure s4a respectively with logca 6 56 and 5 86 the co2 depletion rate increases with decreasing scco2 saturation fig 11e and the dsco2 concentration increases with water injection volumes fig 11d indicating the coupling of co2 dissolution with water flow the coupling occurs when water flow paths merge with stagnant water clusters see the white arrows in fig 11a and several flow paths merge into a large one see the white arrows in fig 11b 4 2 anisotropy with higher transverse permeability kt kl 6 86 two imbibition dissolution experiments were conducted in micromodel 3 with a higher transverse permeability kt kl 6 86 by injecting water at 10 and 50 µl h logca 6 27 and 5 58 under these conditions both drainage and imbibition efficiency is high compared to micromodels 1 and 2 scco2 saturation is stable at 0 90 after drainage and injected water invades widely distributed over the entire pore network see fig 12 a and b the displaced co2 saturation is 0 38 and 0 49 respectively resulting in residual co2 saturation at 0 52 and 0 44 after imbibition see table 3 the temporal change in co2 saturation is shown in fig 12c it takes 320 min 19 pv and 90 min 27 pv to completely deplete the scco2 by imbibition and dissolution at logca 6 27 and 5 58 respectively see figure s4b for the change of co2 saturation vs injected water pore volumes the depletion of residual scco2 by dissolution starts after 40 min 5 pv and 20 min 13 pv and the dsco2 concentration monotonically decreases with increased water injection volumes see fig 12d a monotonic decrease is also observed for the temporal change in co2 depletion rate fig 12e the fast depletion and high dsco2 concentration by dissolution in these two experiments can be attributed to the strong water film flow driven by high capillary pressure in the very tight pores and pore throats in micromodel 3 the distributed contact between scco2 and mobile water is pervasive through the entire pore network promoting scco2 dissolution everywhere no dominant water flow paths are observed 4 3 sandstone analog heterogeneity a series of imbibition and dissolution experiments were conducted in heterogeneous sandstone analog micromodel 4 and reported in chang et al 2016 time lapse images of scco2 water distribution show water preferential water flow along the high permeability channels and bypass the majority of pore network domain where co2 was trapped and residual water after drainage was stagnant see fig 13 the results of dynamic dsco2 concentration vs water injection show that scco2 dissolution at the pore network scale is controlled by 1 the number of water flow paths developed along the high permeability channels and 2 the velocity of water flow or dissolution time at a low injection rate logca 5 34 one water flow path develops with strong coupling between dissolution and water flow with increasing in water injection rate logca 4 34 2 3 water flow paths develop along the high permeability channels while the coupling between dissolution and water flow is diminished and dsco2 concentration decreases with water injection volumes more details on the water flow and scco2 dissolution can be seen in figures s5 and s6 in the supporting material and chang et al 2016 in summary the coupling of dissolution with water flow in this heterogeneous micromodel depends largely on injection rate and capillary number 5 pore scale capillary desaturation curve and cluster based capillary number fig 14 shows the residual scco2 saturation and effluent dsco2 concentration as a function of ca for the 13 imbibition and dissolution experiments in the four micromodels the evolution of pore scale residual co2 saturation follows a typical cdc for micromodels 1 and 4 and the residual co2 saturations remain high at low ca and decrease sharply at a critical ca marked by the arrows in fig 14a the residual co2 saturation in micromodel 1 shows a reduction from 0 82 to 0 47 larger than that from 0 54 to 0 37 in micromodel 4 meanwhile the residual co2 saturation decreases considerably at logca 5 83 in micromodel 1 while a great reduction occurs at logca 5 34 in micromodel 4 this indicates a higher viscous force is required for mobilizing the trapped co2 in the heterogeneous micromodel 4 the pore heterogeneity tends to limit water flow in high permeability channels and reduce viscous force to the bypassed co2 while the cdc for micromodels 2 and 3 are not complete residual co2 saturations in the two anisotropic micromodels are lower than in micromodels 1 and 4 at similar ca caused by a lower drainage efficiency in micromodel 2 and a higher imbibition efficiency in micromodel 3 see tables 2 and 3 as shown in fig 14b the dsco2 concentration generally decreases with increasing ca consistent with the cdc in fig 13a under the same ca the dsco2 concentration increases with increasing water displacement efficiency from the lowest 2 of co2 solubility in micromodel 4 to highest 9 13 of co2 solubility in micromodel 3 the dsco2 concentrations in micromodels 1 and 2 range from 2 to 5 of co2 solubility the cdc shown in fig 14a represents the pore network scale sweep efficiency as channelized water flow and bypass dominate the displacement the bypassed pore network domain may be composed of both trapped co2 ganglia and stagnant water see fig 13 which does not transfer viscous force or contribute to the mobilization of co2 here we calculate the cluster based capillary number c a following hilfer and oren 1996 3 c a l c l μ u k p b where lcl is the average cluster length with saturation weighting for each cluster 4 l c l s c l c l s c lcl represents the cluster size of the bypassed pore network domain instead of individual co2 ganglia from hilfer and oren 1996 k is the absolute brine permeability and pb is the capillary pressure at breakthrough estimated from the pore size and depth of the micromodel 5 p b σ c o s θ r 1 r 2 r 1 r 2 in eq 5 σ 28 mn m2 chiquet et al 2007 and for micromodel 1 r 1 60 µm r 2 37 µm for micromodel 2 r 1 106 µm r 2 37 µm for micromodel 3 r 1 41 6 µm r 2 37 µm for micromodel 3 r 1 33 µm r 2 35 µm the lcl values for each imbibition dissolution experiment are listed in table 3 fig 14c displays cdc with c a the desaturation of co2 occurs at c a 0 52 and 1 69 in micromodels 1 and 2 respectively if individual co2 ganglia are used for calculating c a the plot for micromodel 4 shifts left by 2 orders of magnitude c a may be modified further with measurements of relative permeability following armstrong et al 2014 we show here the uncertainty of determining the cluster size and the important role of water flow regime while the cluster based capillary number provides new insights into the non wetting phase mobilization when considering the system characteristics both pore space and resident fluid a broader application requires a better calculation of the size of the non wetting phase clusters especially when direct visualization and imaging are unavailable 6 the relation between dsco2 concentration and logca we ve shown in sections 3 and 4 that the bypass of scco2 by displacing water is the dominant mechanism contributing to residual co2 trapping without buoyancy bypass can be caused by the heterogeneity of pore characteristics e g micromodel 4 and pore scale fluid distribution after drainage e g micromodels 1 2 and 3 after imbibition dissolution of residual co2 is dependent on the displacement rate and pore characteristics in fig 15 a we show the correlation of dsco2 concentration vs peclet number pe for the imbibition dissolution experiments conducted in the four micromodels the overall dsco2 concentrations decrease with increasing pe which can be attributed to 1 the decrease in residual co2 saturation after imbibition for dissolution 2 the decrease in residence time and 3 the reduced coupling between co2 dissolution and water flow we also note the effects of pore characteristics on co2 dissolution and mass transfer for instance under the same range of pe 0 3 17 dsco2 concentration is lowest in the heterogeneous micromodel because of the preferential water flow along the high permeability channels see figure s5 6 for details the value is highest in the strong anisotropic micromodel 3 with higher transverse permeability kt kl 6 86 and 2 5 of solubility in homogeneous micromodel 1 and weakly anisotropic micromodel 2 the change of dsco2 concentration vs reynold number re shows a similar trend see fig 15b and tables 2 and 3 to improve understanding of the scco2 dissolution process for these experiments in particular and other non wetting phase fluids in general we propose a diagram between the relative concentration of dissolved constituents and flow velocity in terms of logca the diagram fig 16 includes 1 the average dsco2 concentration solid symbol and the range between maximum and minimum time dependent concentrations bar in each dissolution experiment in this study 2 the average and range of dsco2 concentration obtained in the core flooding tests conducted in two low permeability sandstone cores chang et al 2014 3 the average concentration obtained in a high permeability berea sandstone core berg et al 2013 and 4 dissolved napl concentrations obtained in dissolution experiments conducted in homogeneous and heterogeneous micromodels with logca 6 80 and 6 0 chomsurin and werth 2003 the flow velocity capillary number and reynolds number in berg et al 2013 are 0 37 m day 9 3 10 8 and 1 06 while the values in chang et al 2014 are 0 73 m day 1 8 10 7 and 0 64 the relative concentration in percentage to the solubility of scco2 or napl under the experiment conditions is used in the diagram the overall trend shown in fig 16 is that the dissolved non wetting phase fluid concentration increases with a decrease in logca i e the increase in water residence time and approaches to their solubility with sufficient residence time in addition to the main trend the relative dissolved phase concentration is also affected by the pore heterogeneity and anisotropy and the coupled dissolution and water flow that depend on limited or pervasive water flow paths in the regime of non equilibrium dissolution this effect can be understood by the wide range of relative concentration for a given logca or water residence time the average relative concentration varies from the lowest 2 in micromodel 4 with strong heterogeneity to the highest 9 to 13 in micromodel 3 with strong anisotropy in micromodels 1 and 2 with isotropic homogeneity and weak anisotropy the concentration ranges from 2 to 5 the lower relative concentration in the heterogeneous micromodel implies that for the same groundwater velocity it may take longer residence time or water flow path length in a heterogeneous formation for scco2 water to reach equilibrium dissolution than that in a homogeneous one through the dsco2 concentration vs co2 saturation observed in the four micromodels figs 11 12 and 13 we are able to classify 1 zone i where relative concentration monotonically decreases with decreasing residual saturation marked by the red bars and no coupling of co2 dissolution and water flow was observed and 2 zone ii where relative concentration non monotonically changes with decreasing residual co2 saturation marked by the black bars and dissolution is coupled with water flow zones i and ii are divided at a relative concentration of 5 the dashed line and logca of 5 20 the dashed line for 2 concentration separates the dsco2 concentration in the heterogeneous micromodel from the other micromodels and cores the proposed diagram helps describe the conditions that the coupled dissolution and water flow may occur at both pore scale with varying pore characteristics and core scale with varying porosities and permeabilities 7 conclusions and implications we ve systematically investigated the non equilibrium co2 dissolution and its coupling with global and local water flow using four micromodels that represent porous media with varying anisotropy heterogeneity and pore throat aspect ratio time lapse images of scco2 water distributions were obtained during each imbibition and dissolution experiment to quantify the dynamic dissolution process in the four centimeter scale micromodels and at imposed water velocities resulting in logca 6 56 to 4 34 we show that bypass of scco2 by displacing water is the dominant mechanism contributing to residual co2 trapping without buoyancy bypass can be triggered by heterogeneity in pore characteristics e g micromodel 4 and pore scale scco2 water distribution e g micromodels 1 and 2 higher transverse permeability e g micromodel 3 may reduce the bypass and increase pore network sweep efficiency after imbibition dissolution dominates the depletion of residual co2 we show the dissolved co2 concentration increases with increasing water displacement efficiency under same rates from the lowest 2 of co2 solubility in micromodel 4 to highest 9 13 of co2 solubility in micromodel 3 the low dsco2 concentration in the heterogeneous micromodel implies that under the same groundwater velocity it may take longer residence time or water flow path length in a heterogeneous formation for scco2 water to reach equilibrium dissolution than that in a homogeneous one the diagram between relative dissolved concentration and logca was developed by using the average and range of relative concentrations in each of the 13 experiments and in published core and micromodel experiments the diagram shows that the concentration of dissolved non wetting phase fluids e g dsco2 increases with the decreasing capillary number and approaches solubility at low ca value with sufficient residence time this main trend is similar to a cdc in a bypass dominated displacement spatially dissolution of residual co2 initiates along the boundary of the bypassed co2 cluster s in a non equilibrium manner and the dsco2 concentration in water decreases with increasing ca and pe the main trend is secondarily affected by the coupled dissolution and water flow at localities that fragment the bypassed scco2 clusters and enhance scco2 dissolution at the pore scale for a reservoir scale scco2 plume after cessation of injection residual co2 trapping may be dominated by capillary snap off as ambient groundwater flow rate is relatively slow ca 10 7 the long residence time favors local dissolution and coupled with water flow to approach near equilibrium dissolution on the other hand due to the heterogeneous nature of reservoir formations drainage and imbibition may focus flow in high permeability channels and fast dissolution of residual co2 into flowing water can be expected for a scco2 plume in those low permeability regions dissolution is expected to be a lengthy process because of limited interfacial area between mobile water and immobile scco2 coupling of water flow and dissolution at localities may occur after the completion of main imbibition in the high permeability channels and shorten the dissolution process to some extent in summary the reservoir scale dissolution will be collectively affected by slow ambient groundwater flow and strongly heterogeneity controlled interfacial areas between groundwater flow and the scco2 plume acknowledgments this material was based upon the work supported by the u s department of energy office of science office of basic energy sciences energy frontier research centers program under contract no de ac02 05ch11231 the first author was also supported by the national natural science foundation of china grant nos 51704297 51674251 and the china postdoctoral science foundation 2017t100115 the micromodel experiments were conducted at the william r wiley environmental molecular sciences laboratory emsl a scientific user facility of the u s department of energy s office of biological and environmental research operated by the pacific northwest national laboratory pnnl supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 004 appendix supplementary materials image application 1 
711,advancement of x ray micro computed tomography micro ct imaging technologies demands more efficient numerical methods that are capable of handling huge 3d images of porous material we present a workflow for extraction of a pore network model using domain decomposition this method enables us to analyze huge micro ct images with minimal computational requirements we study the impact of domain decomposition on pore network statistics and directional permeability of several porous media also an approximation of the memory usage is presented based on the size of the images and the domain decomposition ratio the watershed segmentation algorithm is used to extract the pore network of each subdomain then by using the labeled matrix of the porous space the connections between subdomains are detected this leads to the creation of a global pore network model that is consisting of the local pore networks of each subdomain finally the absolute permeability of 6 large images is calculated to demonstrate the capability of the proposed method the largest sample we use for pore network extraction is a fontainebleau image with 20003 voxels it is worth noting that these simulations are performed using a personal computer and that we would envisage that much larger volumes could be analyzed by using supercomputing facilities keywords pore network extraction domain decomposition absolute permeability watershed segmentation 1 introduction domain decomposition has a long history of applications for accelerating numerical analyses by splitting a large computational domain into several subdomains in which the initial problem can be solved with a limited amount of computational resources gropp and keyes 1989 guo et al 2003 wang et al 2005 nikishkov 2007 ladevèze et al 2007 vabishchevich 2012 this technique is computationally effective and enables utilization of parallel computing vabishchevich 2012 as an application domain decomposition has been widely used in modeling transport in porous media lemmer and hilfer 2015 skogestad et al 2013 stavroulakis and papadrakakis 2009 porous media can be locally heterogeneous to predict an effective property of such medium it is required to simulate a large enough region of the geometry which is commonly called a representative elementary volume costanza robinson et al 2011 al raoush and papadopoulos 2010 generally simulating large geometries requires a huge amount of computational memory in particular when running 3d models in which requirements grow with a cubic rate behr and tezduyar 1994 x ray micro computed tomography micro ct triggered a revolution in porous media studies in the 1980s by providing detailed 3d images that reveal the internal structure of such materials elliott and dover 1982 nowadays after decades of advancement micro ct is a crucial technique in the analyses of porous media that offers high resolution images that push the limit of our computational resources liu and mostaghimi 2017 jing et al 2017 currently the largest size of image that can be obtained using existing micro ct devices is in the order of 1010 voxels aghaei and piri 2015 andrew et al 2014 thus in order to process large 3d images with many voxels domain decomposition is a common approach that can be utilized to reduce the computational cost two common approaches for modeling transport phenomena in porous media are direct simulation and pore network modeling pnm blunt et al 2013 blunt 2001 mostaghimi 2012 raeini et al 2014 dong 2008 rabbani et al 2014 direct simulation on complicated geometries is computationally expensive but considerably precise bijeljic et al 2013 piller et al 2009 in particular the computational cost can significantly increase when simulating multiphase flow and or other complex transport phenomena in porous media using direct methods such as lattice boltzmann or smoothed particle hydrodynamics morris 2000 liu and liu 2010 conversely geometrical simplifications applied to pnm can significantly reduce computational requirements in comparison to other direct numerical simulations gostick et al 2016 however as modeling domains become larger we also approach computational limitations for pnm the most computationally expensive part of pore network modeling is pore network extraction bultreys et al 2016 wildenschild and sheppard 2013 xiong et al 2016 if one could solve the network extraction bottleneck pore network modeling would be capable of simulating huge network domains with current computational capacities overall pnm is likely to remain as the most practical approach for simulating complex transport processes in large porous geometries there are numerous methods for pore network extraction including maximal ball dong 2008 dong et al 2008 skeletonizing or medial axis al raoush and willson 2005 bakke and øren 1997 and watershed segmentation xiong et al 2016 arns et al 2007 jones et al 2009 sheppard et al 2005 rabbani et al 2016 in this research we have used the watershed segmentation algorithm for pore network extraction since it is fast and reliable if used with appropriate noise reduction techniques to avoid over segmentation rabbani et al 2017 application of this method for the segmentation of porous media images originates in the works of baldwin et al 1996 sheppard et al 2005 sheppard et al 2004 and thompson et al 2005 the watershed segmentation method has been experimentally validated by agaesse et al 2016 for modeling gas diffusion in water for a proton exchange fuel cell successfully predicted the distribution of water saturation in the fuel cell membrane in 2017 gostick gostick 2017 published a comprehensive paper discussing the potentials of this method by redeveloping and testing it over several types of porous materials and proposing some modifications to improve segmentation results such as using a gaussian blur filter instead of median filtering to reduce noises overall one limitation of the domain decomposition method is the approximation of the boundary condition in each subdomain chan and mathew 1994 mandel 1993 fortunately pore network extraction is a local problem and the extracted network is not affected by the geometrical features of the adjacent subdomains except in regions where a pore body is split by the subdomains herein we investigate how the assignment of subdomains influences the extraction of pore networks and thus resulting network simulation results to the best of our knowledge there is no previous application of domain decomposition for pore network extraction published in the literature in this paper several 3d images are analyzed to evaluate the effects of the proposed extraction method on pore network statistics and absolute permeability 2 material and method 2 1 samples description we use 12 images to investigate the effects of decomposition on pore network statistics and absolute permeability the samples are imaged at imperial college london dong 2008 dong and blunt 2009 the sizes and resolutions are listed in table 1 in addition to these 12 samples we use three additional samples to conduct a sensitivity analysis on decomposition ratio and evaluate its effect on cpu time memory usage and permeability error as an example berea2 is a 4803 voxel image that is cropped from berea3 with 10243 voxels similarly bentheimer2 and doddington2 are respectively cropped from bentheimer3 and doddington3 to the size of 4803 voxels the reason we make these geometries with size of 4803 voxels is the fact that 480 is dividable by 2 3 4 5 and 6 therefore the size of each subdomain will be an integer number when studying the effects of the decomposition ratio in addition to berea3 we use four other large size images to run pore network extraction via domain decomposition only these samples are doddington2 estaillades and bentheimer2 respectively with 10243 10243 and 10003 voxels also s10 is a sandstone sample that is scanned specifically for this study lastly a large size fontainebleau sample with 20483 voxels that is imaged at the institute for computational physics at stuttgart university hilfer and zauner 2011 is used for pore network extraction this sample is cropped to 20003 to makes it dividable by 5 which is our selected decomposition ratio it is not necessary to have equally sized domains however it is preferred in this study to avoid unnecessary complexity 2 2 pore network extraction the method used for pore network extraction is known as the watershed segmentation algorithm in this method the narrowest section of a porous pathway is detected as a throat details on network extraction using this method can be found in rabbani et al 2014 wildenschild and sheppard 2013 al raoush and willson 2005 rabbani et al 2016 pore network parameters extracted using the watershed methods have been shown to be comparable to other developed network extraction methods rabbani et al 2014 to check the reliability of the network extraction method we compare the absolute permeabilities obtained from pore network modeling with those from direct simulation results the city block distance transform of images is used as an input for the watershed algorithm also noise reduction of 3d distance maps is conducted by 3d gaussian filtering using a 3 voxel range of influence in each dimension the output of the watershed segmentation is volume data with the same size as the original image with all voxels that lie within throat regions denoted with a given value we can convert this 3d matrix into a mask to disconnect the segmented pore geometry into pores separated by a surface this is performed by multiplying the generated mask and original segmented volume image then the separated pore bodies are assigned a unique number in the next step a connectivity analysis is utilized to detect and label the interfaces between pore bodies which are known as pore throats consequently a connectivity matrix can be created to identify the pair of pores that are connected to a given throat additionally in order to calculate the absolute permeability of the pore network the cross section area and wetted perimeter of each throat must be measured to determine its hydraulic radius which is related to its hydraulic conductance lastly by using a finite difference method we can solve for steady state single phase flow through the pore network and then apply darcy s law to solve for absolute permeability 2 3 domain decomposition we divided the 3d volumetric images of porous rocks into equal sized subdomains to minimize the maximum amount of occupied memory and processing power needed to analyze the sample the decomposition is purely geometrical and does not change the way we are solving the systems of equations to simulate flow initially every subdomain should be analyzed and its local pore network is extracted then all local pore networks merge together and create a global pore network that covers all parts of the original sample in order to provide a better understanding of the domain decomposition process we illustrate it for a 2d system fig 1 presents the pore network extraction of a 2d section of sample s7 with and without domain decomposition fig 1 a and b respectively show the labeled pore space and extracted networks with no decomposition for a decomposition ratio of 2 we split the image into four equal sized images subdomains then the watershed segmentation and pore space labeling are performed independently on each subdomain fig 1 c along with the extraction of the pore network now it is required to find the connections between the pores in adjacent subdomains for this we investigate the edges of the labeled subdomains to match the pore spaces that are connected to each other in the original image a connection is established between the corresponding pore bodies each of which are from an adjacent subdomain fig 1 d although we call these connections pore throats they are not necessarily the narrowest part of the pathway between the two adjacent pores to set an appropriate radius size for the throats connecting different domains we assume several possibilities that are discussed in section 2 4 a similar procedure is implemented in 3d the decomposition ratio can be any integer number and it should be selected based on the heterogeneity of the sample and processing power available small ratios are not helpful in decreasing the required computer memory and high ratios cause uncertainties in the network extraction results this is because for each decomposition the pore network will slightly change and thus over decomposition can influence the results as will be discussed in section 3 3 in fig 2 we provide the entire workflow for network extraction using the geometric domain decomposition approach initially the binarized image should be divided into an appropriate number of subdomains and then the main loop of network extraction starts to analyze all subdomains when all subdomains are analyzed the connections between subdomains should be detected based on the labeled interfaces between corresponding pore bodies a global pore network is then formed by coupling the local pore networks 2 4 inter domain connections although the conductivity of the connecting throats between subdomains seems to be critical in calculating the global permeability of the network there is limited physical mathematical evidence for setting a reasonable value for them this is mainly because they do not follow the classical definition of a pore throat which is defined as the narrowest pathway between two adjacent pores the inter domain throats can be wider than their connected pores since where the domain is split is set by the decomposition ratio we will consider five possible alternatives for hydraulic conductivity of the inter domain throats table 2 these options are tested to find a suitable option in which there is the least effect on the resulting network permeability according to the hagen poiseullie law the permeability of a capillary tube is equal to r2 8 where r is the tube radius therefore based on the options provided in table 2 the conductivity of the inter domain throat radius is calculated and the effects are investigated on the resulting network permeability 3 results and discussion 3 1 conductivity of inter domain connections in this section we will test how the different inter domain connection definitions influence the global pore network permeability the aim is to identify the definition that provides the best permeability result based on permeability results determined from extracted networks using no decomposition the option with the least influence on permeability will be focused on and investigated further in the proceeding sections in table 3 we calculated the absolute permeability of the berea1 sample using a domain decomposition ratio of 2 and inter domain connectivity options 1 through 5 as provided in table 2 according to our results the first option used for defining the inter domain throats has the least effect on the calculated permeability in reference to the permeability calculated with no decomposition the average relative error for this option for the 3 different flow directions is 5 58 option one is defined as using the throat cross section to calculated the area and wetted perimeter which is the same approach used for calculate the conductivity of the classic throats in a pore network therefore there is agreement between the methods used to calculate pressure drop in the classic and inter domain throats 3 2 decomposition effects the images selected for investigating the effects of decomposition are either 300 or 400 voxels in each direction we extract network from these samples without domain decomposition using a computer with 8 gb of memory then the results obtained with and without domain decomposition are compared to check the effects of decomposition on pore network statistics and simulated absolute permeability fig 3 illustrates a comparison between two extracted pore networks with and without domain decomposition as seen in the marked circles there are extra pores and throats generated at the domain boundaries however absolute permeability simulation results demonstrate that these differences change the expected permeability by 1 5 14 depending on the porous material tested table 4 comprehensively presents the pore network average parameters and absolute directional permeabilities for the 12 samples before and after decomposition also the relative errors between no decomposition and decomposition are reported in table 4 it can be seen that the average relative error for permeability prediction is around 7 5 among the pore network parameters throat length is the most deviated value with a relative error around 7 5 we have found that the error of throat length is directly correlated with the average pore size in voxels with 75 determination coefficient fig 5 a one reason can be the fact that for pores with numerous voxels it is more probable that the pores are split by the subdomain boundaries thus we need to reestablish a connection between separated sections of that pore using a hypothetical throat and this can cause an error in the average length of the network throats roughly when an average pore radius is larger than 10 voxels the error in average throat length exceeds 13 fig 5 a however a similar correlation cannot be identified between the relative error of permeability and the average pore size as plotted in fig 5 b average pore size throat size and pore connectivity have relative errors around 4 or less fig 4 in addition mean permeabilities with domain decomposition versus mean permeabilities without domain decomposition are plotted in fig 6 it can be seen that all of the resulting points are around a line with unit slope and the determination coefficient of 0 996 furthermore the permeabilities from direct simulation are plotted versus pore network permeabilities in fig 7 the source of these direct simulation permeabilities is dong and blunt 2009 and the used simulation method is 3d lbgk lattice boltzmann as described in manwart et al 2002 if one considers the lattice boltzmann permeability as a reference it can be concluded that both permeabilities with and without domain decomposition are comparable to the lattice boltzmann permeability since the corresponding determination coefficients are 0 971 and 0 985 respectively 3 3 decomposition ratio sensitivity analysis in this section we study the effect of decomposition ratio on the amount memory usage and measurement of absolute permeability for studying memory usage we have analyzed the berea2 sample with 4803 voxels for different decomposition ratios from 1 to 6 the peak memory and cpu time are plotted in fig 8 as demonstrated peak memory is diminished by 3 orders of magnitude when decomposition ratio changes from 1 to 6 cpu time for implementation with a decomposition ratio equal to 6 is 40 less than the case with no decomposition however there is a limit to what the cpu time can be reduced since several saving loading cycles of the subdomain matrix in out of the permanent memory requires time as well when we are solving a section of the larger domain without directly considering the neighbor sections actually we are skipping some of the calculations related to the boundary regions which will not be skipped if solving the problem as a whole this could be a reason for relative cpu time reduction when the decomposition ratio increases to determine the amount of computer memory that is required for direct pore network extraction of large size images we have made an approximation by fitting a cubic polynomial curve on the available results for berea2 fig 9 illustrates the demanded memory for images with different sizes and with different decomposition ratios it can be seen that for an image with 20003 voxels approximately 1 tb of memory is required with no decomposition while with a decomposition ratio of 5 only 12 gb of memory is required which allows for pore network extraction on a standard desktop computer it should be noted that the amount of required computer memory is depended on many other parameters such the choice of programming language efficiency of memory de allocation and advanced programming techniques to save the memory the reported peak memory usage in fig 9 mainly addresses author s computational setup and it could variate down to one order of magnitude if changing the programming techniques and environment the berea2 bentheimer1 and doddington1 data are processed to evaluate the effect of different decomposition ratios on the predicted values of absolute permeability we extracted pore networks and simulated single phase flow for decomposition ratios of 2 to 12 and calculated the relative error of permeability in respect to the results without decomposition this task is done to investigate to what extent error increases with increasing decomposition ratio the results are provided in fig 10 based on this figure the amount of error in permeability calculations varies by increasing the decomposition ratio but at least it can be stated that the error does not have an increasing trend for the tested samples within the range of the used decomposition ratios 6 however considering the noticeable error increment when using higher decomposition ratios it can be inferred that there would be an onset ratio that at which if exceeded the method is not applicable anymore obviously the onset would be different for each sample and thus would need to be evaluated on a case by case basis this inference makes sense considering the fact that in each decomposition we would lose a small amount of information that exist at the boundaries and over decomposition will increase this loss of information significantly 3 4 effect of distance transform in this study we have used city block distance transform for the network extraction process fig 2 considering the fact that there are different types of other distance transforms including euclidean quasi euclidean and chessboard we perform a sensitivity analysis to evaluate the effects of different transforms on the hydraulic properties of extracted pore network in addition some of the transforms such as city block and chessboard are not invariant to the rotation of the image while classic euclidean is invariant in this regards we have selected berea1 sample to run a similar process of pore network extraction and permeability calculation but with different distance transforms additionally this task is done with and without domain decomposition table 5 presents the effect of different distance transforms on the directional absolute permeability of berea1 sample at the bottom row of the table coefficient of variation cv is an appropriate measure to check if the type of distance transform affects the hydraulic permeability of the networks cv is equal to the standard deviation divided by the average value and it can be counted as a normalized measure of data deviations abdi 2010 accordingly while in all different options the amount of cv is less than 1 we conclude that the effect of the different distance transforms on the pore network properties is insignificant 3 5 analysis of large size images we use domain decomposition to extract the pore network of 6 large images then extracted networks are used to simulate single phase flow and determine the absolute permeability for berea3 doddington2 estaillades and bentheimer2 the decomposition ratio is set to 4 for s10 sample a decomposition ratio of 3 is used also the decomposition ratio for fontainebleau 20003 voxels is 5 selecting an optimum value for decomposition ratio depends on the specifications of the computer which is running the pore network extraction here we aim to avoid subdomain sizes larger than 480 to avoid enormous usage of memory figs 11 15 illustrate cross sections of the tested porous media geometeries with the resulting pressure distribution under steady state flow in the z direction except for the estaillades sample the other samples have a nearly uniform pressure drop along the flow direction however the pore space of estaillades is poorly connected which leads to a non uniform pressure distribution the fontainebleau sample is also analyzed and a cross sectional image and the distributions of the extracted pore network parameters are provided in fig 16 lastly we calculated the parameters of the weibull distribution for the different pore network parameters in table 6 weibull is a statistical function that fits well with non negative values with an asymmetric distribution bhattacharya and bhattacharjee 2010 schmeiser and devroye 1988 this function has been previously used by researchers to describe the distribution of pore network parameters dong 2008 valvatne et al 2005 finally the calculated directional absolute permeabilities based on the extracted networks are presented in table 7 s10 is the most permeable sample which is expected considering its large and well connected pores estaillades has the lowest permeability because of isolated pore spaces and tight pore necks as can be seen in fig 13 the sample was previously analyzed for absolute permeability by using lattice boltzmann by mattila et al 2016 they analyzed the 20483 voxel sample and calculated an absolute permeability of 1 19 d while the absolute permeability obtained in this study is 0 88 d fig 12 fig 14 4 conclusions and future works 4 1 summarized conclusions geometric domain decomposition was tested for the pore network extraction of huge micro ct images we tested rock images with at most 20003 voxels and showed the computational improvement in extraction of pore networks applying the geometric domain decomposition approach reduced the computational memory significantly and made it possible to run pore network extraction of relatively large size images on a personal computer the effects of decomposition are examined on pore network statistics and absolute permeability prediction the decomposition approach changed the absolute permeability of the 12 investigated samples by 7 5 it was also found that domain decomposition for pore network extraction was capable of reducing the amount of peak memory by 2 3 orders of magnitude thus this technique can be critical for analyzing huge porous media images with numerous voxels and thus extend our computational limits for digital rock analyses 4 2 future works on overlapped domains in this study we have not used the concept of overlapped domains a discussion this concept is provided to shed light on future related works as discussed in the paper when using non overlapped domain decomposition for pore network extraction we are facing information loss due to the lack of proper image analysis at domain boundaries generally overlapped domain decomposition can ameliorate this issue at the boundaries and thus provide better results however in this particular pore network extraction problem by using this concept we would face with some complexities uncertainties that should be properly answered for flawless implementation of overlapped domain decomposition as an example of the uncertainties consider a large pore in the overlapped region that is processed and extracted in two adjacent domains in each of the domains a different size and center location will be calculated and assigned to the same pore this difference is more severe when the pore size is larger than the width of the overlapping region here we note some of the uncertainties when using overlapped domain decomposition a how to find and merge the detected overlapped pores is unclear since they are not actually ideal circles and apparent overlapping of approximated circles does not mean that the corresponded pores should be necessarily merged b finding the appropriate overlapping width is a challenge since it should be larger than the largest pore to avoid the previously mentioned ambiguity c how to find the largest pore before extracting the pore network is also difficult and would likely create a loop with the previous item b however if in future studies researchers can provide appropriate answers to the discussed uncertainties it would be possible to use overlapped domains and go forward to use domain decomposition for network extraction without any information loss at the domain boundaries in our work we show that this complexity may not be necessary when predicting rock permeability when a sufficiently small decomposition ratio 6 is used 4 3 future works on parallel computation the next step after breaking down a large problem into small pieces could be utilization of the parallel computation to reduce the cpu time of the network extraction process the domain decomposition approach presented in this paper is able to decompose a voluminous tomography image of porous media into a series of computationally independent subsections considering the independency and cheap calculations of each subsection grama et al 1993 both cpu and gpu parallel computational techniques are recommended be investigated in the future studies to be coupled with domain decomposition and leads to a fast and even less computationally intensive method for pore network extraction 4 4 future works on complex transports in pore network in this work we have calculated the absolute permeability of the extracted pore networks to investigate if domain decomposition has a noticeable effect on the network properties however considering the fact that pnm is well known for efficiently modeling two phase flow in the future works we need to show that decomposition would not remove the capability of pnm for two phase flow modeling in addition more complex transport phenomena such as dispersion and other mass momentum transfer problems are encouraged to be investigated in the extracted networks using domain decomposition the authors initial insight is that considering the fact that domain decomposition does not fundamentally change the pore network properties such as connectivity and throat sizes more complex transport simulations would be applicable on the networks which are extracted by domain decomposition as an example arns et al 2004 have computationally investigated the effect of network topology on relative permeability and concluded that in the case of maintaining the main features of a pore network including pore size throat size pore location and coordination number the effect of topological disorder on the computed relative permeability would be minor additionally this observation had been previously reported by jerauld et al 1984 
711,advancement of x ray micro computed tomography micro ct imaging technologies demands more efficient numerical methods that are capable of handling huge 3d images of porous material we present a workflow for extraction of a pore network model using domain decomposition this method enables us to analyze huge micro ct images with minimal computational requirements we study the impact of domain decomposition on pore network statistics and directional permeability of several porous media also an approximation of the memory usage is presented based on the size of the images and the domain decomposition ratio the watershed segmentation algorithm is used to extract the pore network of each subdomain then by using the labeled matrix of the porous space the connections between subdomains are detected this leads to the creation of a global pore network model that is consisting of the local pore networks of each subdomain finally the absolute permeability of 6 large images is calculated to demonstrate the capability of the proposed method the largest sample we use for pore network extraction is a fontainebleau image with 20003 voxels it is worth noting that these simulations are performed using a personal computer and that we would envisage that much larger volumes could be analyzed by using supercomputing facilities keywords pore network extraction domain decomposition absolute permeability watershed segmentation 1 introduction domain decomposition has a long history of applications for accelerating numerical analyses by splitting a large computational domain into several subdomains in which the initial problem can be solved with a limited amount of computational resources gropp and keyes 1989 guo et al 2003 wang et al 2005 nikishkov 2007 ladevèze et al 2007 vabishchevich 2012 this technique is computationally effective and enables utilization of parallel computing vabishchevich 2012 as an application domain decomposition has been widely used in modeling transport in porous media lemmer and hilfer 2015 skogestad et al 2013 stavroulakis and papadrakakis 2009 porous media can be locally heterogeneous to predict an effective property of such medium it is required to simulate a large enough region of the geometry which is commonly called a representative elementary volume costanza robinson et al 2011 al raoush and papadopoulos 2010 generally simulating large geometries requires a huge amount of computational memory in particular when running 3d models in which requirements grow with a cubic rate behr and tezduyar 1994 x ray micro computed tomography micro ct triggered a revolution in porous media studies in the 1980s by providing detailed 3d images that reveal the internal structure of such materials elliott and dover 1982 nowadays after decades of advancement micro ct is a crucial technique in the analyses of porous media that offers high resolution images that push the limit of our computational resources liu and mostaghimi 2017 jing et al 2017 currently the largest size of image that can be obtained using existing micro ct devices is in the order of 1010 voxels aghaei and piri 2015 andrew et al 2014 thus in order to process large 3d images with many voxels domain decomposition is a common approach that can be utilized to reduce the computational cost two common approaches for modeling transport phenomena in porous media are direct simulation and pore network modeling pnm blunt et al 2013 blunt 2001 mostaghimi 2012 raeini et al 2014 dong 2008 rabbani et al 2014 direct simulation on complicated geometries is computationally expensive but considerably precise bijeljic et al 2013 piller et al 2009 in particular the computational cost can significantly increase when simulating multiphase flow and or other complex transport phenomena in porous media using direct methods such as lattice boltzmann or smoothed particle hydrodynamics morris 2000 liu and liu 2010 conversely geometrical simplifications applied to pnm can significantly reduce computational requirements in comparison to other direct numerical simulations gostick et al 2016 however as modeling domains become larger we also approach computational limitations for pnm the most computationally expensive part of pore network modeling is pore network extraction bultreys et al 2016 wildenschild and sheppard 2013 xiong et al 2016 if one could solve the network extraction bottleneck pore network modeling would be capable of simulating huge network domains with current computational capacities overall pnm is likely to remain as the most practical approach for simulating complex transport processes in large porous geometries there are numerous methods for pore network extraction including maximal ball dong 2008 dong et al 2008 skeletonizing or medial axis al raoush and willson 2005 bakke and øren 1997 and watershed segmentation xiong et al 2016 arns et al 2007 jones et al 2009 sheppard et al 2005 rabbani et al 2016 in this research we have used the watershed segmentation algorithm for pore network extraction since it is fast and reliable if used with appropriate noise reduction techniques to avoid over segmentation rabbani et al 2017 application of this method for the segmentation of porous media images originates in the works of baldwin et al 1996 sheppard et al 2005 sheppard et al 2004 and thompson et al 2005 the watershed segmentation method has been experimentally validated by agaesse et al 2016 for modeling gas diffusion in water for a proton exchange fuel cell successfully predicted the distribution of water saturation in the fuel cell membrane in 2017 gostick gostick 2017 published a comprehensive paper discussing the potentials of this method by redeveloping and testing it over several types of porous materials and proposing some modifications to improve segmentation results such as using a gaussian blur filter instead of median filtering to reduce noises overall one limitation of the domain decomposition method is the approximation of the boundary condition in each subdomain chan and mathew 1994 mandel 1993 fortunately pore network extraction is a local problem and the extracted network is not affected by the geometrical features of the adjacent subdomains except in regions where a pore body is split by the subdomains herein we investigate how the assignment of subdomains influences the extraction of pore networks and thus resulting network simulation results to the best of our knowledge there is no previous application of domain decomposition for pore network extraction published in the literature in this paper several 3d images are analyzed to evaluate the effects of the proposed extraction method on pore network statistics and absolute permeability 2 material and method 2 1 samples description we use 12 images to investigate the effects of decomposition on pore network statistics and absolute permeability the samples are imaged at imperial college london dong 2008 dong and blunt 2009 the sizes and resolutions are listed in table 1 in addition to these 12 samples we use three additional samples to conduct a sensitivity analysis on decomposition ratio and evaluate its effect on cpu time memory usage and permeability error as an example berea2 is a 4803 voxel image that is cropped from berea3 with 10243 voxels similarly bentheimer2 and doddington2 are respectively cropped from bentheimer3 and doddington3 to the size of 4803 voxels the reason we make these geometries with size of 4803 voxels is the fact that 480 is dividable by 2 3 4 5 and 6 therefore the size of each subdomain will be an integer number when studying the effects of the decomposition ratio in addition to berea3 we use four other large size images to run pore network extraction via domain decomposition only these samples are doddington2 estaillades and bentheimer2 respectively with 10243 10243 and 10003 voxels also s10 is a sandstone sample that is scanned specifically for this study lastly a large size fontainebleau sample with 20483 voxels that is imaged at the institute for computational physics at stuttgart university hilfer and zauner 2011 is used for pore network extraction this sample is cropped to 20003 to makes it dividable by 5 which is our selected decomposition ratio it is not necessary to have equally sized domains however it is preferred in this study to avoid unnecessary complexity 2 2 pore network extraction the method used for pore network extraction is known as the watershed segmentation algorithm in this method the narrowest section of a porous pathway is detected as a throat details on network extraction using this method can be found in rabbani et al 2014 wildenschild and sheppard 2013 al raoush and willson 2005 rabbani et al 2016 pore network parameters extracted using the watershed methods have been shown to be comparable to other developed network extraction methods rabbani et al 2014 to check the reliability of the network extraction method we compare the absolute permeabilities obtained from pore network modeling with those from direct simulation results the city block distance transform of images is used as an input for the watershed algorithm also noise reduction of 3d distance maps is conducted by 3d gaussian filtering using a 3 voxel range of influence in each dimension the output of the watershed segmentation is volume data with the same size as the original image with all voxels that lie within throat regions denoted with a given value we can convert this 3d matrix into a mask to disconnect the segmented pore geometry into pores separated by a surface this is performed by multiplying the generated mask and original segmented volume image then the separated pore bodies are assigned a unique number in the next step a connectivity analysis is utilized to detect and label the interfaces between pore bodies which are known as pore throats consequently a connectivity matrix can be created to identify the pair of pores that are connected to a given throat additionally in order to calculate the absolute permeability of the pore network the cross section area and wetted perimeter of each throat must be measured to determine its hydraulic radius which is related to its hydraulic conductance lastly by using a finite difference method we can solve for steady state single phase flow through the pore network and then apply darcy s law to solve for absolute permeability 2 3 domain decomposition we divided the 3d volumetric images of porous rocks into equal sized subdomains to minimize the maximum amount of occupied memory and processing power needed to analyze the sample the decomposition is purely geometrical and does not change the way we are solving the systems of equations to simulate flow initially every subdomain should be analyzed and its local pore network is extracted then all local pore networks merge together and create a global pore network that covers all parts of the original sample in order to provide a better understanding of the domain decomposition process we illustrate it for a 2d system fig 1 presents the pore network extraction of a 2d section of sample s7 with and without domain decomposition fig 1 a and b respectively show the labeled pore space and extracted networks with no decomposition for a decomposition ratio of 2 we split the image into four equal sized images subdomains then the watershed segmentation and pore space labeling are performed independently on each subdomain fig 1 c along with the extraction of the pore network now it is required to find the connections between the pores in adjacent subdomains for this we investigate the edges of the labeled subdomains to match the pore spaces that are connected to each other in the original image a connection is established between the corresponding pore bodies each of which are from an adjacent subdomain fig 1 d although we call these connections pore throats they are not necessarily the narrowest part of the pathway between the two adjacent pores to set an appropriate radius size for the throats connecting different domains we assume several possibilities that are discussed in section 2 4 a similar procedure is implemented in 3d the decomposition ratio can be any integer number and it should be selected based on the heterogeneity of the sample and processing power available small ratios are not helpful in decreasing the required computer memory and high ratios cause uncertainties in the network extraction results this is because for each decomposition the pore network will slightly change and thus over decomposition can influence the results as will be discussed in section 3 3 in fig 2 we provide the entire workflow for network extraction using the geometric domain decomposition approach initially the binarized image should be divided into an appropriate number of subdomains and then the main loop of network extraction starts to analyze all subdomains when all subdomains are analyzed the connections between subdomains should be detected based on the labeled interfaces between corresponding pore bodies a global pore network is then formed by coupling the local pore networks 2 4 inter domain connections although the conductivity of the connecting throats between subdomains seems to be critical in calculating the global permeability of the network there is limited physical mathematical evidence for setting a reasonable value for them this is mainly because they do not follow the classical definition of a pore throat which is defined as the narrowest pathway between two adjacent pores the inter domain throats can be wider than their connected pores since where the domain is split is set by the decomposition ratio we will consider five possible alternatives for hydraulic conductivity of the inter domain throats table 2 these options are tested to find a suitable option in which there is the least effect on the resulting network permeability according to the hagen poiseullie law the permeability of a capillary tube is equal to r2 8 where r is the tube radius therefore based on the options provided in table 2 the conductivity of the inter domain throat radius is calculated and the effects are investigated on the resulting network permeability 3 results and discussion 3 1 conductivity of inter domain connections in this section we will test how the different inter domain connection definitions influence the global pore network permeability the aim is to identify the definition that provides the best permeability result based on permeability results determined from extracted networks using no decomposition the option with the least influence on permeability will be focused on and investigated further in the proceeding sections in table 3 we calculated the absolute permeability of the berea1 sample using a domain decomposition ratio of 2 and inter domain connectivity options 1 through 5 as provided in table 2 according to our results the first option used for defining the inter domain throats has the least effect on the calculated permeability in reference to the permeability calculated with no decomposition the average relative error for this option for the 3 different flow directions is 5 58 option one is defined as using the throat cross section to calculated the area and wetted perimeter which is the same approach used for calculate the conductivity of the classic throats in a pore network therefore there is agreement between the methods used to calculate pressure drop in the classic and inter domain throats 3 2 decomposition effects the images selected for investigating the effects of decomposition are either 300 or 400 voxels in each direction we extract network from these samples without domain decomposition using a computer with 8 gb of memory then the results obtained with and without domain decomposition are compared to check the effects of decomposition on pore network statistics and simulated absolute permeability fig 3 illustrates a comparison between two extracted pore networks with and without domain decomposition as seen in the marked circles there are extra pores and throats generated at the domain boundaries however absolute permeability simulation results demonstrate that these differences change the expected permeability by 1 5 14 depending on the porous material tested table 4 comprehensively presents the pore network average parameters and absolute directional permeabilities for the 12 samples before and after decomposition also the relative errors between no decomposition and decomposition are reported in table 4 it can be seen that the average relative error for permeability prediction is around 7 5 among the pore network parameters throat length is the most deviated value with a relative error around 7 5 we have found that the error of throat length is directly correlated with the average pore size in voxels with 75 determination coefficient fig 5 a one reason can be the fact that for pores with numerous voxels it is more probable that the pores are split by the subdomain boundaries thus we need to reestablish a connection between separated sections of that pore using a hypothetical throat and this can cause an error in the average length of the network throats roughly when an average pore radius is larger than 10 voxels the error in average throat length exceeds 13 fig 5 a however a similar correlation cannot be identified between the relative error of permeability and the average pore size as plotted in fig 5 b average pore size throat size and pore connectivity have relative errors around 4 or less fig 4 in addition mean permeabilities with domain decomposition versus mean permeabilities without domain decomposition are plotted in fig 6 it can be seen that all of the resulting points are around a line with unit slope and the determination coefficient of 0 996 furthermore the permeabilities from direct simulation are plotted versus pore network permeabilities in fig 7 the source of these direct simulation permeabilities is dong and blunt 2009 and the used simulation method is 3d lbgk lattice boltzmann as described in manwart et al 2002 if one considers the lattice boltzmann permeability as a reference it can be concluded that both permeabilities with and without domain decomposition are comparable to the lattice boltzmann permeability since the corresponding determination coefficients are 0 971 and 0 985 respectively 3 3 decomposition ratio sensitivity analysis in this section we study the effect of decomposition ratio on the amount memory usage and measurement of absolute permeability for studying memory usage we have analyzed the berea2 sample with 4803 voxels for different decomposition ratios from 1 to 6 the peak memory and cpu time are plotted in fig 8 as demonstrated peak memory is diminished by 3 orders of magnitude when decomposition ratio changes from 1 to 6 cpu time for implementation with a decomposition ratio equal to 6 is 40 less than the case with no decomposition however there is a limit to what the cpu time can be reduced since several saving loading cycles of the subdomain matrix in out of the permanent memory requires time as well when we are solving a section of the larger domain without directly considering the neighbor sections actually we are skipping some of the calculations related to the boundary regions which will not be skipped if solving the problem as a whole this could be a reason for relative cpu time reduction when the decomposition ratio increases to determine the amount of computer memory that is required for direct pore network extraction of large size images we have made an approximation by fitting a cubic polynomial curve on the available results for berea2 fig 9 illustrates the demanded memory for images with different sizes and with different decomposition ratios it can be seen that for an image with 20003 voxels approximately 1 tb of memory is required with no decomposition while with a decomposition ratio of 5 only 12 gb of memory is required which allows for pore network extraction on a standard desktop computer it should be noted that the amount of required computer memory is depended on many other parameters such the choice of programming language efficiency of memory de allocation and advanced programming techniques to save the memory the reported peak memory usage in fig 9 mainly addresses author s computational setup and it could variate down to one order of magnitude if changing the programming techniques and environment the berea2 bentheimer1 and doddington1 data are processed to evaluate the effect of different decomposition ratios on the predicted values of absolute permeability we extracted pore networks and simulated single phase flow for decomposition ratios of 2 to 12 and calculated the relative error of permeability in respect to the results without decomposition this task is done to investigate to what extent error increases with increasing decomposition ratio the results are provided in fig 10 based on this figure the amount of error in permeability calculations varies by increasing the decomposition ratio but at least it can be stated that the error does not have an increasing trend for the tested samples within the range of the used decomposition ratios 6 however considering the noticeable error increment when using higher decomposition ratios it can be inferred that there would be an onset ratio that at which if exceeded the method is not applicable anymore obviously the onset would be different for each sample and thus would need to be evaluated on a case by case basis this inference makes sense considering the fact that in each decomposition we would lose a small amount of information that exist at the boundaries and over decomposition will increase this loss of information significantly 3 4 effect of distance transform in this study we have used city block distance transform for the network extraction process fig 2 considering the fact that there are different types of other distance transforms including euclidean quasi euclidean and chessboard we perform a sensitivity analysis to evaluate the effects of different transforms on the hydraulic properties of extracted pore network in addition some of the transforms such as city block and chessboard are not invariant to the rotation of the image while classic euclidean is invariant in this regards we have selected berea1 sample to run a similar process of pore network extraction and permeability calculation but with different distance transforms additionally this task is done with and without domain decomposition table 5 presents the effect of different distance transforms on the directional absolute permeability of berea1 sample at the bottom row of the table coefficient of variation cv is an appropriate measure to check if the type of distance transform affects the hydraulic permeability of the networks cv is equal to the standard deviation divided by the average value and it can be counted as a normalized measure of data deviations abdi 2010 accordingly while in all different options the amount of cv is less than 1 we conclude that the effect of the different distance transforms on the pore network properties is insignificant 3 5 analysis of large size images we use domain decomposition to extract the pore network of 6 large images then extracted networks are used to simulate single phase flow and determine the absolute permeability for berea3 doddington2 estaillades and bentheimer2 the decomposition ratio is set to 4 for s10 sample a decomposition ratio of 3 is used also the decomposition ratio for fontainebleau 20003 voxels is 5 selecting an optimum value for decomposition ratio depends on the specifications of the computer which is running the pore network extraction here we aim to avoid subdomain sizes larger than 480 to avoid enormous usage of memory figs 11 15 illustrate cross sections of the tested porous media geometeries with the resulting pressure distribution under steady state flow in the z direction except for the estaillades sample the other samples have a nearly uniform pressure drop along the flow direction however the pore space of estaillades is poorly connected which leads to a non uniform pressure distribution the fontainebleau sample is also analyzed and a cross sectional image and the distributions of the extracted pore network parameters are provided in fig 16 lastly we calculated the parameters of the weibull distribution for the different pore network parameters in table 6 weibull is a statistical function that fits well with non negative values with an asymmetric distribution bhattacharya and bhattacharjee 2010 schmeiser and devroye 1988 this function has been previously used by researchers to describe the distribution of pore network parameters dong 2008 valvatne et al 2005 finally the calculated directional absolute permeabilities based on the extracted networks are presented in table 7 s10 is the most permeable sample which is expected considering its large and well connected pores estaillades has the lowest permeability because of isolated pore spaces and tight pore necks as can be seen in fig 13 the sample was previously analyzed for absolute permeability by using lattice boltzmann by mattila et al 2016 they analyzed the 20483 voxel sample and calculated an absolute permeability of 1 19 d while the absolute permeability obtained in this study is 0 88 d fig 12 fig 14 4 conclusions and future works 4 1 summarized conclusions geometric domain decomposition was tested for the pore network extraction of huge micro ct images we tested rock images with at most 20003 voxels and showed the computational improvement in extraction of pore networks applying the geometric domain decomposition approach reduced the computational memory significantly and made it possible to run pore network extraction of relatively large size images on a personal computer the effects of decomposition are examined on pore network statistics and absolute permeability prediction the decomposition approach changed the absolute permeability of the 12 investigated samples by 7 5 it was also found that domain decomposition for pore network extraction was capable of reducing the amount of peak memory by 2 3 orders of magnitude thus this technique can be critical for analyzing huge porous media images with numerous voxels and thus extend our computational limits for digital rock analyses 4 2 future works on overlapped domains in this study we have not used the concept of overlapped domains a discussion this concept is provided to shed light on future related works as discussed in the paper when using non overlapped domain decomposition for pore network extraction we are facing information loss due to the lack of proper image analysis at domain boundaries generally overlapped domain decomposition can ameliorate this issue at the boundaries and thus provide better results however in this particular pore network extraction problem by using this concept we would face with some complexities uncertainties that should be properly answered for flawless implementation of overlapped domain decomposition as an example of the uncertainties consider a large pore in the overlapped region that is processed and extracted in two adjacent domains in each of the domains a different size and center location will be calculated and assigned to the same pore this difference is more severe when the pore size is larger than the width of the overlapping region here we note some of the uncertainties when using overlapped domain decomposition a how to find and merge the detected overlapped pores is unclear since they are not actually ideal circles and apparent overlapping of approximated circles does not mean that the corresponded pores should be necessarily merged b finding the appropriate overlapping width is a challenge since it should be larger than the largest pore to avoid the previously mentioned ambiguity c how to find the largest pore before extracting the pore network is also difficult and would likely create a loop with the previous item b however if in future studies researchers can provide appropriate answers to the discussed uncertainties it would be possible to use overlapped domains and go forward to use domain decomposition for network extraction without any information loss at the domain boundaries in our work we show that this complexity may not be necessary when predicting rock permeability when a sufficiently small decomposition ratio 6 is used 4 3 future works on parallel computation the next step after breaking down a large problem into small pieces could be utilization of the parallel computation to reduce the cpu time of the network extraction process the domain decomposition approach presented in this paper is able to decompose a voluminous tomography image of porous media into a series of computationally independent subsections considering the independency and cheap calculations of each subsection grama et al 1993 both cpu and gpu parallel computational techniques are recommended be investigated in the future studies to be coupled with domain decomposition and leads to a fast and even less computationally intensive method for pore network extraction 4 4 future works on complex transports in pore network in this work we have calculated the absolute permeability of the extracted pore networks to investigate if domain decomposition has a noticeable effect on the network properties however considering the fact that pnm is well known for efficiently modeling two phase flow in the future works we need to show that decomposition would not remove the capability of pnm for two phase flow modeling in addition more complex transport phenomena such as dispersion and other mass momentum transfer problems are encouraged to be investigated in the extracted networks using domain decomposition the authors initial insight is that considering the fact that domain decomposition does not fundamentally change the pore network properties such as connectivity and throat sizes more complex transport simulations would be applicable on the networks which are extracted by domain decomposition as an example arns et al 2004 have computationally investigated the effect of network topology on relative permeability and concluded that in the case of maintaining the main features of a pore network including pore size throat size pore location and coordination number the effect of topological disorder on the computed relative permeability would be minor additionally this observation had been previously reported by jerauld et al 1984 
712,using exact and explicit analytical solutions and modflow simulations we show that downstream of an unconformity transition from an aquifuge layer to a homogeneous aquitard groundwater seeps at varying angles with respect to the layering as a generalization of the anderson 2003 two layered composite a steady 2 d darcian flow in a three layered aquifer is studied this flow is generated by different inlet piezometric heads in thick upper and lower strata and a cross flow through an aquitard sandwiched between them analytically a line vortex combined with a dipole at infinity describes commingling between the strata with refraction continuity of head and normal flux component along the upper and lower boundaries of the aquitard the fourier method by riesenkampf 1940 gives explicit expressions for the specific discharge vector fields in the three media modflow models finite lengths composites of rectangular and octagonal shapes the dupuit forchheimer approximation is illustrated to oversimplify the flow topology keywords refracted specific discharge vector fields in an aquitard and two adjacent half planes flow net isotachs line vortex superposed with dipole at infinity in a three layered composite leaky layer versus leaky boundary 2 d flows versus dupuit forchheimer approximation analytical solutions versus modflow 1 introduction topology of groundwater flows in layered aquifers studied both numerically and analytically is necessary for prospecting water resources at a catchment scale in arid areas where recharge takes place in the mountains with a submarine discharge fig 1 a represents a typical vertical cross section of a two strata alluvium in the batinah coastal plane oman understanding the lateral and vertical variations of hydrogeochemistry water quality of groundwater pumped by wells screened at different depths evaluation of fluxes and piezometric heads in the vicinity of small scale disconformities or breaches in standard stratifications among others in this paper we consider a steady darcian flow in a three layered formation fig 1a and b which in a sense generalizes one studied by anderson 2003 each layer is assumed to be homogeneous and isotropic real hydrostratigraphic formations are often fractured and anisotropic see e g meyer et al 2016 runkel et al 2018 strata 1 and 2 are of thicknesses d1 d2 and are characterized by a dyad of hydraulic conductivities k 1 k 2 the layer sandwiched between them is of a thickness 2b and has the following hydraulic properties this layer is impermeable aquifuge upstream of the cross section eboec and transforms into a permeable layer of conductivity ka downstream this type of longitudinal variation of hydraulic properties of a geological layer especially in alluvial formations is depicted by maliva and missimer 2012 figs 3 13 3 20 3 23 with a numerical analysis of refraction of streamlines on non trivial heterogeneities in wu et al 2018 mathematically ka in fig 1 is arbitrary but for hydrogeological interpretations of this strip as an aquitard or leaky layer anderson 2000 we will focus on the case ka k 1 k 2 the caprock and bedrock in fig 1a and b are impermeable if no transition from the aquifuge to the aquitard as in fig 1a and b then flow in both strata would be trivially 1 d without any commingling due to mild permeability of the aquitard groundwater crosses it from a stratum with a higher piezometric head without any loss of generality we assume that this is stratum 1 into the second stratum of a lower head this advective commingling see also batlle aguilar et al 2016 obnosov et al 2015 verruijt and swidzinski 1993 causes mixing changes of hydrogeochemistry pore pressure anomalies and seepage erosion of the leaky layer a standard concept in ground water hydrology assumes flow in thick highly permeable strata to be quasi horizontal longitudinal while in sandwiched aquitards a cross flow to be perpendicular to the aquitard see e g pinder and celia 2006 pk 62 77 strack 2017 with this topological conceptualization of a steady cross flow in the aquitards and under the dupuit forchheimer df approximation the modified helmholtz equations for piezometric heads in each stratum of a multi layered formation are analytically solved the objective of our paper is to examine the flow topology with double refraction of the flow on the two boundaries of a leaky layer we analytically and numerically prove that essentially 2 d flows in the two thick strata of fig 1 can be topologically complex with commingling caused by refraction along the upper and lower strata aquitard interfaces correspondingly cross flow through the aquitard morphs from a vertical one close to point o in fig 1a b to tilted and almost horizontal far downstream of o we also compare flow in our three component composite with anderson s 2003 two component composite and with what anderson 2000 conceptualized as a 2 d flow in one stratum with a leaky boundary for which in our notations b 0 ka 0but b ka remains finite we also illustrate that the df model may predict the flow topology quite different from what 2 d solutions give for analytical description of 2 d fields of specific discharge and flow nets in our three layered aquifer one can use the method of mirror images of singularities with respect to two refraction lines in fig 1b and summation of infinite series as anderson 2000 did for line sinks we follow a different technique by engaging an amended riesenkampf 1940 hereafter abbreviated as r 40 solution for a seemingly different problem of seepage under a concrete dam in a two layered porous foundation fig 1b r 40 reconstructed an impermeable dam contour as a streamline of a line vortex see also kacimov and obnosov 2001 the r 40 method of assembling line vortices to model 2 d flows under dams has been utilized by polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 77 in geotechnical engineering for various types of stratified dam foundations not only a two layered one of r 40 shown in fig 1b see also kozlov 1941 in hydrogeological applications the method of combining various types of line singularities dipoles sinks sources vortices has been championed by strack 2017 in application to regional groundwater flows in heterogeneous aquifers and for studies of local flows near various types of disconformities in standard hydrostratigraphic zonation in our numerical analysis we used a standard modflow simcore 2012 2 flow in a tri layered formation we simplify the situation depicted in fig 1a by considering horizontal layers in fig 1b octagon f1f2eu3eu4ed2ed1eu1eu2 the origin of cartesian coordinates x y and of a complex physical coordinate z x i y is at point o located at the middle line of the aquitard in fig 1b in the full scale numerical model below the vertical segment f1of2 is a no flow boundary which separates the aquifuge from the aquitard we introduce complex potentials in the three strata of fig 1b ω j φ j i ψ j j 1 2 ω a φ a i ψ a where φ j kjhj φ a kaha is the velocity potential hj x y ha x y are three piezometric heads and ψ j ψ a are the stream functions in the upper lower strata and aquitard from the darcy law the specific discharge vector is v j k j h j φ j v a k a h a φ a for divergence free flows in fig 1b the characteristic functions obey the laplace equations 2ψ j 0 2ψ a 0 2φ j 0 2φ a 0 we assume that the datum for the head is at point f1 where h1 0 along eu1eu2 and eu3eu4 the heads are h1 h1u h2 h2u where the dyad h1u h2u is determined from the location of the recharge zones in fig 1a anderson 2000 2003 specified the far upstream field by the hydraulic gradients upstream of the y axis flow in both strata is 1 d therefore as an approximation we can assume that along f1eb the head in the first stratum is h1 0 and along f2ec in the second stratum h2 hg where hg is a positive constant determined by a 1 d upstream flow in this stratum the case of the inlet head in the second stratum higher than in the first is mathematically identical for example a low permeable plug fig 1a may cause a relative depression at f2ec as compared with f1eb other causes of variation of the piezometric head across two layered aquifers are discussed in abdalla et al 2018 our interest is what is going downstream of the y axis in fig 1b a line vortex of intensity γ is placed at point o at the middle line of the aquitard in fig 1b this point is selected as the origin of a cartesian system of coordinates x y and complex physical coordinate z x i y the flow rate q through the whole formation is q v 0 d1 2v 0 k a k 1 b v 0 k 2 k 1 d 2 2 1 riesenkampf s line vortex 1 1 a scanned image of the riesenkampf 1940 paper is attached for the convenience of potential referees it can be also uploaded as a supplementary electronic material if the ms is accepted the problem for a composite octagon in fig 1b is intractable for analytical treatment as 2 d flow and will be modeled by modflow in section 2 3 here we consider a simpler flow domain a 3 layered formation shown in fig 1c an aquitard of a thickness 2b is sandwiched between two strata of conductivity k1 and large thickness i e in notations of fig 1b d 1 d 2 all layers in fig 1c are unbounded in the x direction in other words the flow domain is a whole plane i e an unbounded three component composite r 40 considered a line vortex placed at point o and assumed that at infinity the pore water in all three components of the composite is static i e a solitary vortex is the only water agitating entity this vortex models seepage in a two layered foundation under a concrete dam fig 1c with a head drop of hg between the upper pool of the dam and tailwater obviously in the dam problem of r 40 flow at y 0 only has a physical sense the functions of a complex variable v j z d ω j d z v a z d ω a d z are holomorphic except the vortex point at four points at infinity e u2 e d2 ec au ad e u1 e d1 eb the far field conditions are v j a z 0 the singularity at point o is v a z γ 2 π i z as z 0 along the interface z i b the conditions h 2 h a and ψ2 ψ a hold similarly along z i b the refraction conditions are h 1 h a and ψ1 ψ a equivalent conjugation conditions are formulated in terms of the continuity of the normal and a jump of the tangential components of the specific discharge vectors pk 77 strack 2017 r 40 solution reads 1 v 1 r z γ 2 π 1 i z 0 k 1 k a c o s h b α e x p α z k a cosh b α k 1 s i n h b α d α v a r z γ 2 π i 1 z 0 k 1 k a s i n α z e x p b α k a cosh b α k 1 s i n h b α d α v 2 r z γ 2 π 1 i z 0 k 1 k a c o s h b α e x p α z k a cosh b α k 1 s i n h b α d α where α is a dummy variable unfortunately pk 62 77 did not report this solution in full in the appendix we provide a full derivation of eq 1 we introduce dimensionless quantities k k a k 1 αe α b xe ye hje hae h 1e h 2e x y hj ha h 1 h 2 b vae vje va vj k 1 ω ae ω je ω a ω j k 1 b qe γ e q γ k 1 b in the analytical solutions below the subscript e for dimensionless values is dropped for the sake of brevity fortunately integrals in eq 1 can be evaluated that yields 2 v 1 r z γ 2 π 1 i z 1 k 0 c o s h α e x p α z k cosh α s i n h α d α γ 2 π 1 i z 1 2 1 k 1 k 1 iz 2 beta 1 2 1 k i z 2 0 k 1 beta 1 2 1 k 1 i z 2 0 k 1 v a r z γ 2 π i 1 z 1 k 0 s i n α z e x p α k cosh α s i n h α d α γ 2 π i 1 z 1 k 1 k 2 i z 2 f 1 1 1 i z 2 2 i z 2 1 2 1 k 2 i z 2 f 1 1 1 i z 2 2 i z 2 1 2 1 k 4 z 2 v 2 r z γ 2 π 1 i z 1 k 0 c o s h α e x p α z k cosh α s i n h α d α γ 2 π z 1 i 1 k 1 k i z 2 f 1 1 1 i z 2 2 i z 2 1 k 1 k 2 i z 2 f 1 1 i z 2 1 i z 2 1 k 1 k 2 i z where 2f1 and beta are the hypergeometric and beta functions see wolfram 1991 for description and realization of these functions in mathematica r 40 and pk 62 77 did not provide examples of calculations of the velocity fields and flow nets in either two or more layered porous foundations of dams why because the integrals in eq 1 involve oscillating integrands and systematic computations were prohibitively difficult 70 years back on the days when computer algebra did not exist now days eq 2 with integrals expressed via special functions make the computations and kinematic analysis easy in particular we used nintegrate of wolfram s mathematica to get the three complex potentials for plotting the flow nets in the case of small thickness 2b of the aquitard and small ka the aquitard can be replaced by a leaky boundary anderson 2000 stated the leaky boundary represents exactly the effects of a membrane where the membrane has a finite resistance but no thickness correspondingly in the r 40 problem the membrane has a finite resistance and finite thickness let us illustrate that the solution of r 40 with refraction conditions along y b is reduced to flow in a homogeneous half plane with the robin boundary condition along y 0 which anderson 2000 used namely in the anderson 2000 limit points su sd f1 in fig 1 merge into point o and along the two rays oad and oau we have in dimensional quantities 3 h 1 x 0 n c h 1 x 0 h u d 0 where n is the normal to oad and oau hu and hd are the water levels in the upper pool and tail water of the dam fig 1c respectively c ka 2 kb is usually called resistivity of the leaky line a mathematically identical boundary condition is called the newton one for heat conduction in a solid body a boundary of which is subject to convective cooling see e g lebedev et al 1966 van der veer 1978 used the verigin holomorphic function see pk 77 and solved the problem for a line vortex with the boundary condition 3 actually this solution has been earlier obtained in the theory of heat conduction lebedev et al 1966 problem 304 in terms of the hydraulic head in the quarter plane x 0 y 0 lebedev s solution to the heat conduction problem reads in the earlier introduced dimensionless quantities 4 h 1 x y h g 2 1 2 k π 0 exp α y s i n α x α α k d α where similarly to van der veer 1978 we assumed that along the vertical line x 0 the head h1 0 y 0 then due to symmetry of the flow along the tail water ray oad h1 x 0 hg 2 hg hu hd see fig 1c both lebedev et al 1966 and r 40 used the fourier transforms to obtain their analytical solutions see our appendix in fig 2 curve 1 indicates the head distribution h1 x 1 for hg 1 5 γ 3 and k 0 5 calculated from r 40 i e for a finite thickness of the leaky layer curve 2 corresponds to h1 x 0 along a leaky boundary computed by eq 4 even for this relatively large k the two heads are close to each other curve 3 corresponds to h1 x 1 in r 40 for hg 1 5 and k 0 1 for this k solution 4 virtually coincides with r 40 as was the case for a line sink in anderson 2000 2 2 analytical solution for line vortex superposed with dipole in eq 2 the real component of var is zero along the ox axis in fig 1c correspondingly the piezometric head is constant along oau and along oad the head of course jumps from one ray to another this allowed r 40 to interpret this mathematical solution as flow under a concrete dam fig 1c eq 2 have another property the imaginary parts var vjr vanish along the oy axis in other words the rays oeb and oec are also constant head rays therefore using the linearity of the laplace equation which governs the heads and stream functions in the three subdomains of fig 1c we can use the principle of superposition so we add another vector field to one described by eq 2 obviously the added field has to obey the same governing equation and boundary conditions because our initial problem is an aquifuge aquitard flow in fig 1a and b we like anderson 2003 add dipoles at infinity unidirectional flows in the three layers of fig 1c these unidirectional flows retain the refraction boundary conditions along the lines z iband have zero imaginary components of velocities and constant heads along the ordinate axis the superposition gives 5 v 1 z v o v 1 r z v a z v o k v a r z v 2 z v o v 2 r z the far field conditions in the vector field 5 are v 1 z v 0 va z v 0 k v 2 z v 0at z for comparisons see anderson 2003 for his far field conditions in his zone 2 we note two things the specific discharge in the two strata far upstream and downstream of point o v0 is arbitrary but in the aquitard it is determined by the refraction boundary conditions in numerical simulations the conductivities of the strata in fig 1b can be different as well as the incident velocities upstream of point o the complex potentials are obtained by integration of eq 5 as following 6 ω 1 z v 0 z i γ 2 π i l o g z log i γ k 1 4 π i z 1 k 1 k 1 iz 2 beta 1 2 1 k iu 2 0 k 1 beta 1 2 1 k 1 iu 2 0 k 1 d u ω a z k v 0 z i γ 2 π i l o g z log i γ 2 π i k 1 k 1 i z 2 i u 2 f 1 1 1 iu 2 2 iu 2 1 2 1 k 2 i u 2 f 1 1 1 iu 2 2 iu 2 1 2 1 k 4 u 2 d u ω 2 z v 0 z x f i γ 2 π i l o g z log x f i φ a x f i k γ 2 π k 1 k 1 x f i z i z 2 f 1 1 1 i z 2 2 i z 2 1 k 1 k 2 i z 2 f 1 1 i z 2 1 i z 2 1 k 1 k 2 i z d u in this integration in the first two equations of 6 we used the condition that at the fiducial point f1 fig 1c zoomed in fig 3 a the complex potentials in stratum 1 and in the aquitard are ω a ω1 0 point f1 belongs to both layers the third equation in 6 needs more elaboration indeed in the r 40 case d1 d2 k2 k1 in notations of fig 1b and v0 0 pure vortex flow consequently the r 40 streamlines in fig 1c are symmetric with respect to both coordinate axes with superposition of unidirectional fields i e in flows described by eqs 5 and 6 there is no such symmetry therefore the streamline ψ a ψ1 ψ2 0 which starts at the fiducial point f1 z ib does not pass through the point z ib instead it intersects the upper interface of the aquitard at a point fr i e at z xf i fig 3a consequently we first find xf from the equation ψ a xf 1 0 for this purpose we use the findroot routine of mathematica we note that the expression ψ a x y is an imaginary part of the second eq 6 then we use the real part of the second eq 6 i e φ a x y and find the potential at point fr fig 3a as φ a xf 1 eventually we use the conjugation conditions of the potentials in the aquitard and upper layer across the interface i e φ2 xfr 1 φ a xfr 1 k the streamline ψ2 0 refracted at point fr continues in the upper stratum fig 1d here we have two scenarios depending on the dyad γ v1 the vortex intensity γ should be high enough to complete the loop if so the fiducial streamline eventually bends to the left and intersects the oy axis at point f2 fig 3a the ordinate of this point yf2 is found by the findroot routine of mathematica from the equation ψ2 0 y 0 we will illustrate later the flow net for a physically meaningless case of a relatively small γ r 40 selected an arbitrary streamline sufsd fig 1c as an impermeable dam contour and discarded the flow domain above the ox axis for the flow field 5 we make a similar trick a streamline f1sf2 is considered as a bonnet tip of the aquifuge a geologically real boundary between the aquifuge and aquitard a dashed line in fig 1c and 3a is of course not so smooth and regular as a vortex generated f1sf2 see for instance the pictures in maliva and missimer 2012 however the geometry of this line has only a local effect not influencing the regional flow the ordinate of point f2 yf2 is greater than 1 in other words the discarded aquifuge on the left x 0 has a slightly higher thickness 2ba than the aquitard on the right x 0 the last step is similar to r 40 we discard the left half of the flow domain in fig 1c and pass to the scheme shown as the domain x 0 in fig 1b now the physical meaning of the vortex strength is determined from the following physical conditions the piezometric head along f2ec is hg φ2 0 y y f2 y for sufficiently large γ there is a stagnation point fs fig 1b the streamline passing through this point is a separatrix which demarcates a segment f2fs through which groundwater exfiltrates from the upper stratum through a segment fsec water infiltrates into this stratum we have v2 x y expressed by eqs 2 and 5 and hence we use the findroot routine of mathematica and evaluate the ordinate ys as a solution of the equation v2 0 y 0 then we put the found ys into eq 6 and find the quantity of backflow as qb ψ 0 ys it is noteworthy that the two branches of the separatrix intersect the constant head boundary f2ec at point fs at angles π 4 as is zoomed in fig 3b this is a common feature of a separatrix see e g kacimov and youngs 2005 at a point where the complex potential is not a holomorphic function i e at this point the streamline is not orthogonal to the constant head line the peculiarity of flow topology at critical points mathematical singularities i e zero or infinite darcian velocities is important in numerical simulations of contaminant transport even for purely advective transport models fdm cells involving singularities call for a special treatment for example zheng and bennett 2002 section 6 2 3 introduced the concept of a weak well an fdm cell with this well requires a special analytical refining which zheng and bennett carry out by considering a rigorous solution see their eq 6 54 in the vicinity of the singularity in the zheng and bennett algorithm advection of tracked particles close to the weak well is controlled by the analytically derived velocity filed similarly in our case of the stagnation point fs in fig 1b a boundary fdm cell shown in fig 3b needs an analytical characterization for proper tracking of marked particles three particles in fig 3b are located at three zones separated by the swerving streamline similarly to fig 6 21 in zheng and bennett 2002 if we look at a large scale picture of fig 1b the advective fate of these three particles is remarkably different the vector field 2 and 5 provides explicit and rigorous formulae for the zheng and bennett 2002 algorithms of kinematics of groundwater flow near our week flow point fs if dispersion is counted in transport models chapter 7 of zheng and bennett 2002 then the vector field 2 and 3 gives an explicit meshless evaluation of the peclet numbers and dispersivities at any point and in any zone of the flow domain that is another advantage of analytical solutions strack 2017 kacimov et al 2018 for example in the cell containing the stagnation point fig 3b an ade modeled transport is dominated by diffusion and in cells not shown close to points f1 fr f2 in fig 3a transport depends on the dyad γ v0 and therefore is controlled by either advection or both advection and dispersion now we illustrate our analytical results by wolfram s mathematica 2 2 our computer programs in mathematica and modflow are open codes we can share them with interested referees and readers in all computations below we used the contourplot and streamplot built in functions in fig 4 a f we fixed the triad γ k v0 3 0 1 0 2 then from the second eq 6 the dimensionless head at the inlet segment oec is h2 hg 15 we recall that a vortex makes a head drop from 0 on the right bank of the cut oeb to 2hg on the left bank of this cut with half of this drop at the ray oec for the selected triad xf 0 29 yf2 1 033 φ2 xf 1 14 65 ys 17 42 qb 3 47 fig 4a shows the streamlines on a large scale plotted from the vector field 5 fig 4b uses eq 6 and plots the streamlines and constant piezometric head lines close to the bonnet the near field in fig 1a solid lines are the streamlines ψ1 2 a 0 l 1 0 5 l 1 2 7 curves 1 6 hereafter correspondingly dashed lines are constant head lines h 1 2 a 1 2 4 6 8 12 13 14 14 5 curves 7 15 a streamline ψ a 1 not labeled is almost semi circular it has no physical meaning because located inside the confining loop of the streamline ψ a 0i e inside the aquifuge as fig 4b shows in the near field flow is indeed perpendicular to the aquitard fig 4c shows the contours of constant magnitudes of hydraulic gradients v1 2 and va k computed from eq 5 curves 1 7 correspond to the gradients of 0 5 0 75 1 1 1 5 6 and 7 we recall pk 62 77 that in darcian flows zones of a porous medium where this gradient exceeds 1 are considered to be prone of seepage erosion e g suffusion colmatage and lessivage see pk 77 fig 4c demonstrates that in the vicinity of the bonnet the erosional stability criterion of unit gradient is violated in all three layers of the composite very high gradients emerge in the aquitard the read curve in fig 4c is the bonnet ψ 0 i e what is on the left of this contour should be ignored in fig 4d we plotted the streamlines and constant head lines near the stagnation point fs and separatrix solid lines are streamlines ψ2 2 6 3 0 3 4 3 6 3 8 4 5 6 7 curves 1 9 we note that the streamlines ψ2 3 0and 3 4 have two disconnected branches dashed lines show the contours h 2 14 14 4 14 8 15 15 2 15 6 16 17 18 curves 10 18 fig 4e presents the streamlines and constant head lines in the middle field fig 1a solid lines are the streamlines ψ1 2 a 8 6 l 1 0 2 l 1 2 5 curves 1 5 dashed lines are constant head lines h 1 2 a 13 5 l 1 0 5 l 1 2 7 curves 6 12 fig 4f illustrates the flow net in the far field of fig 1a solid lines are the streamlines ψ1 2 a 18 65 l 1 0 05 l 1 2 4 curves 1 4 dashed lines are constant head lines h 1 2 a 67 5 l 1 0 5 l 1 2 5 curves 5 9 clearly even in the middle field flow is significantly titled with respect to the aquitard eventually in fig 4g we changed the triad to γ k v0 0 3 0 1 0 2 and plotted the flow net in the near field solid lines are the streamlines ψ1 2 a 0 2 l 1 0 1 l 1 2 5 curves 1 5 dashed lines are constant head lines h 1 2 a 0 5 l 1 0 5 l 1 2 3 4 curves 5 9 the fiducial streamline ψ1 2 a 0 curve 3 does not make a full loop to oec fig 3a consequently this value of γ 0 3 is too small i e the mathematical solution has no physical sense 2 3 modflow simulations now we simulate the problem numerically using modflow 2005 simcore 2012 the model runs for steady state and the conductivities also indicated in fig 1a correspond to that used for the analytical solution but the sizes of the flow domain are finite in both x and y directions we start with a rectangular three component composite which in notations of fig 1b has ld 100 m d1 20 m d2 30 m 2b 2 m k1 k2 10 m day ka 1 m day the domain is gridded with 52 layers and 100 columns forming a total number of 5200 active cells fig 5 with the cell sizes of δy δx 1 m the generalized conjugate gradient with a preconditioning method involving a modified incomplete cholesky solver has been selected with a convergence criterion of 0 001 the effective porosity is set for 0 15 and both the left hand side and right hand side boundaries are assigned as constant head boundaries with h2 hg 15 m for the left hand side boundary of layer 2 and h1 0 m for the layer 1 the outlet head in all three layers is h2e 33 5 m see fig 1b these boundary conditions correspond to the analytical solution for the case illustrated in fig 4 obviously the velocity vectors in all three layers of fig 5 are strictly horizontal at x 100 m in section 2 2 we had no constant vertical segment at the right of fig 1c but rather the far field velocity conditions in the three layers numerical solutions will illustrate how far from point o a vertical constant head segment a surrogate far filed should be placed for comparisons with the analytical solution the hydraulic head contours and the trajectories of marked particles across the modeled flow domain are presented in f a and b respectively we note that the dashed black line in fig 6 b is a separatrix see also fig 1b and 3b fig 6 clearly illustrates that cross flow in the aquitard is vertical only close to the tip of the aquifuge downstream the pathlines in the aquitard are oblique and close to the outlet are almost horizontal this corroborates the analytical solution for a semi infinite r 40 domain in fig 6c we compare the distributions of the total head along the line x 4 5 m obtained analytically curve 1 and numerically curve 2 the vortex strength is selected in the following manner the drop of head from the ray of1eb zero head boundary to of2ec where the modflow dimensional head is 15 m should be provided by the vortex of dimensional intensity 30 m2 day that in dimensionless quantities corresponds to γ 30 1 10 3 0 overall there is a good match between analytical and modflow models in the position of the separatrix m11m23 fig 1c piezometric heads and qb a more general case of an octagon as the flow domain corresponds to one studied by anderson 2003 in fig 7 a we consider an aquifuge extending into the aquifer for 15 m this corresponds to lu1 lu2 15 m in fig 1b the flow domain presented by fig 7a is gridded as in fig 5 the piezometric head contours computed by modflow and trajectories of marked particles released in the vicinity of the left hand side boundary are presented in fig 7b and c respectively the inlet head along eu1eu2 in notations of fig 1b is h1u 0 fig 7c illustrates a flow topology where groundwater particles moving from the lower layer cross vertically the aquitard and move leftward around the protruding tip of the aquifuge into the upper stratum schematically the locus of the stagnation point fs and of the separatrix for this case is depicted in fig 3c if the head along eu3eu4 in fig 3c is reduced then the stagnation point drifts to this vertical line and with a further drop of h2u even to the caprock the latter scenario is illustrated by simulations presented in fig 8 a b where the inlet head along eu3eu4 is h2u 25 m i e decreased 10 m as compared with the scenario plotted in fig 7 clearly with the aquifuge protrusion in fig 7 8 the vortex based analytical solution is not applicable 2 4 dupuit forchheimer approximation in this section we follow and compare the 2 d analytical and numerical solutions with the df approximation anderson 2003 and strack 2017 we consider a rectangular flow domain we recall that in terms of the df model the dimensionless depth y averaged hydraulic heads h 1 x h 2 x in the two aquifers obey the system of linear coupled odes 7 d 2 h 1 d x 2 k h 1 h 2 0 x l d d 2 h 2 d x 2 k h 2 h 1 0 x l d which for the 2 d flow domains of section 2 2 and rectangular domain in fig 7a of section 2 3 should be solved with the following boundary conditions fig 1b 8 h 1 0 0 h 1 l d h e h 2 0 h g h 1 l d h e in the df approximation the aquitard is postulated as a vertically conducting layer bvp 7 and 8 has a simple analytical solution in exponential functions we will drop it here for the sake of brevity in fig 9 curves 1 and 2 present h1 x and h2 x for the same parameters as in fig 7 i e we selected dimensionless quantities ld 100 he 33 hg 15 k 0 1 in the upper layer h2 has a maximum h 2m 9 6 attained at xm 5 7 in the df model this maximum means that the corresponding line x xm is a vertical separatrix watershed in other words groundwater moves both to the left and right with respect to this line i e the model predicts seepage out of the flow domain through the whole line f2ec fig 1b however both the analytical and numerical 2 d models for this set of parameters evidence that this is not the case viz the 2 d separatrix is a curve which demarcates only a corner zone near point f2 figs 1b and 6a of backflow i e the constant head line f2ec seeps in both directions this illustrates quantitative and qualitative differences in the outputs of the scaffolding hierarchy of groundwater flow models bean et al 2017 3 concluding remarks the analytical solutions and modflow simulations of 2 d refracting flows in three layered aquifers give consistent flow nets the flow topology in this porous composite is rather complex and can not be deduced from the df approximation even relatively thin aquitards can not be always conceptualized as simple vertically conducting commuters of groundwater between sandwiching aquifers the r 40 technique of solving boundary value problems for analytic functions in piece wise homogeneous domains can be extended to the case of vertical leaky layers impeding the incident flows the topology of advected contaminants across aquitards requires a scrutiny of refracted cross flows see e g verruijt and swidzinski 1993 the fine textured skeleton of the aquitards can be subject to high hydraulic gradients and ensued seepage induced erosion that can transform an allegedly low permeable stratum into a permeable conduit which transmits appreciable quantities of low quality groundwater from one aquifer to another similarly to abandoned wells avci 1994 acknowledgments this work was supported by the squ project ig agr swae 14 02 critical comments by two anonymous referees and a kind help from i lebedeva saratov university russia is appreciated supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 007 appendix b supplementary materials image application 1 appendix re derivation of r 40 solution for a three layer composite plane agitated by line vortex for an arbitrary dyad d 1 d 2 of strata thicknesses in fig 1b and v0 0 solution to the refraction problem in a three component composite plane which is agitated by a line vortex placed at an arbitrary position z z0 is sought in the form of fourier s integrals a1 v a z γ 2 π i 1 z z 0 1 2 π i 0 a a α exp i α z b a α exp i α z d α v j z 0 a j α exp i α z b j α exp i α z d α a a a a r i a a i b a b a r i b a i a j a j r i a j i b j b j r i b j i where a a r α a a i α b a r α b a i α a j r α a j i α b j r α b j i α j 1 2 is the dodecad of real functions to be found the no flow conditions along the caprock and bedrock are a2 im v 1 x i b d 1 0 im v 2 x i b a d 2 0 for the r 40 case in fig 1c we have z0 0 d 1 d 2 k1 k 2 and the general integral a1 is simplified as following first at z i y and y the far field limit is vj 0 therefore in eq a1 the velocities in the two strata half planes y 1 y 1 are a3 v 1 z 0 b 1 r α exp i α z d α v 2 z 0 a 2 r α exp i α z d α i e we have a hexad a a r α a a i α b a r α b a i α a 2 r α b 1 r α of functions to be found next for a vortex placed just on the midline of the aquitard z 0 the real part of velocity vanishes along the ox axis i e va x 0 0 therefore aai bai aar bar this reduces the hexad to a tetrad next we use the four refraction conditions along the two lines z x i for this purpose we bring the first term of the first equation in eq a1 under the sign of integration using the following integrals a4 i z 0 exp i α z d α for z 0 z 0 correspondingly at the lower interface in fig 1c im va x i im v1 x i then for the coefficients at the cos x terms we recall that in the fourier method the inegrands are expanded into harmonics we immediately get aar 0 from the coefficients collected at the sin x terms of the expansion we obtain a5 b 1 r γ 2 π a a i π e x p α c o s h α at the same interface the second refraction condition is re va x i k re v1 x i this for the grouped coefficients at the cos x terms gives a6 k b 1 r γ 2 π a a i π e x p α s i n h α consequently the system of linear eqs a5 and a6 is solved with respect to the dyad aai b1r identically we use the refraction conditions along the upper interface in fig 1c im va x i im v1 x i k re va x i im v1 x i from which we evaluate a2r α eventually we put the found triad aai α a2r α b 1r α into eq a1 and use eq a4 to come back from an integral form to an explicitly expressed vortex term in both strata this leads to eq 1 in the main body of the text 
712,using exact and explicit analytical solutions and modflow simulations we show that downstream of an unconformity transition from an aquifuge layer to a homogeneous aquitard groundwater seeps at varying angles with respect to the layering as a generalization of the anderson 2003 two layered composite a steady 2 d darcian flow in a three layered aquifer is studied this flow is generated by different inlet piezometric heads in thick upper and lower strata and a cross flow through an aquitard sandwiched between them analytically a line vortex combined with a dipole at infinity describes commingling between the strata with refraction continuity of head and normal flux component along the upper and lower boundaries of the aquitard the fourier method by riesenkampf 1940 gives explicit expressions for the specific discharge vector fields in the three media modflow models finite lengths composites of rectangular and octagonal shapes the dupuit forchheimer approximation is illustrated to oversimplify the flow topology keywords refracted specific discharge vector fields in an aquitard and two adjacent half planes flow net isotachs line vortex superposed with dipole at infinity in a three layered composite leaky layer versus leaky boundary 2 d flows versus dupuit forchheimer approximation analytical solutions versus modflow 1 introduction topology of groundwater flows in layered aquifers studied both numerically and analytically is necessary for prospecting water resources at a catchment scale in arid areas where recharge takes place in the mountains with a submarine discharge fig 1 a represents a typical vertical cross section of a two strata alluvium in the batinah coastal plane oman understanding the lateral and vertical variations of hydrogeochemistry water quality of groundwater pumped by wells screened at different depths evaluation of fluxes and piezometric heads in the vicinity of small scale disconformities or breaches in standard stratifications among others in this paper we consider a steady darcian flow in a three layered formation fig 1a and b which in a sense generalizes one studied by anderson 2003 each layer is assumed to be homogeneous and isotropic real hydrostratigraphic formations are often fractured and anisotropic see e g meyer et al 2016 runkel et al 2018 strata 1 and 2 are of thicknesses d1 d2 and are characterized by a dyad of hydraulic conductivities k 1 k 2 the layer sandwiched between them is of a thickness 2b and has the following hydraulic properties this layer is impermeable aquifuge upstream of the cross section eboec and transforms into a permeable layer of conductivity ka downstream this type of longitudinal variation of hydraulic properties of a geological layer especially in alluvial formations is depicted by maliva and missimer 2012 figs 3 13 3 20 3 23 with a numerical analysis of refraction of streamlines on non trivial heterogeneities in wu et al 2018 mathematically ka in fig 1 is arbitrary but for hydrogeological interpretations of this strip as an aquitard or leaky layer anderson 2000 we will focus on the case ka k 1 k 2 the caprock and bedrock in fig 1a and b are impermeable if no transition from the aquifuge to the aquitard as in fig 1a and b then flow in both strata would be trivially 1 d without any commingling due to mild permeability of the aquitard groundwater crosses it from a stratum with a higher piezometric head without any loss of generality we assume that this is stratum 1 into the second stratum of a lower head this advective commingling see also batlle aguilar et al 2016 obnosov et al 2015 verruijt and swidzinski 1993 causes mixing changes of hydrogeochemistry pore pressure anomalies and seepage erosion of the leaky layer a standard concept in ground water hydrology assumes flow in thick highly permeable strata to be quasi horizontal longitudinal while in sandwiched aquitards a cross flow to be perpendicular to the aquitard see e g pinder and celia 2006 pk 62 77 strack 2017 with this topological conceptualization of a steady cross flow in the aquitards and under the dupuit forchheimer df approximation the modified helmholtz equations for piezometric heads in each stratum of a multi layered formation are analytically solved the objective of our paper is to examine the flow topology with double refraction of the flow on the two boundaries of a leaky layer we analytically and numerically prove that essentially 2 d flows in the two thick strata of fig 1 can be topologically complex with commingling caused by refraction along the upper and lower strata aquitard interfaces correspondingly cross flow through the aquitard morphs from a vertical one close to point o in fig 1a b to tilted and almost horizontal far downstream of o we also compare flow in our three component composite with anderson s 2003 two component composite and with what anderson 2000 conceptualized as a 2 d flow in one stratum with a leaky boundary for which in our notations b 0 ka 0but b ka remains finite we also illustrate that the df model may predict the flow topology quite different from what 2 d solutions give for analytical description of 2 d fields of specific discharge and flow nets in our three layered aquifer one can use the method of mirror images of singularities with respect to two refraction lines in fig 1b and summation of infinite series as anderson 2000 did for line sinks we follow a different technique by engaging an amended riesenkampf 1940 hereafter abbreviated as r 40 solution for a seemingly different problem of seepage under a concrete dam in a two layered porous foundation fig 1b r 40 reconstructed an impermeable dam contour as a streamline of a line vortex see also kacimov and obnosov 2001 the r 40 method of assembling line vortices to model 2 d flows under dams has been utilized by polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 77 in geotechnical engineering for various types of stratified dam foundations not only a two layered one of r 40 shown in fig 1b see also kozlov 1941 in hydrogeological applications the method of combining various types of line singularities dipoles sinks sources vortices has been championed by strack 2017 in application to regional groundwater flows in heterogeneous aquifers and for studies of local flows near various types of disconformities in standard hydrostratigraphic zonation in our numerical analysis we used a standard modflow simcore 2012 2 flow in a tri layered formation we simplify the situation depicted in fig 1a by considering horizontal layers in fig 1b octagon f1f2eu3eu4ed2ed1eu1eu2 the origin of cartesian coordinates x y and of a complex physical coordinate z x i y is at point o located at the middle line of the aquitard in fig 1b in the full scale numerical model below the vertical segment f1of2 is a no flow boundary which separates the aquifuge from the aquitard we introduce complex potentials in the three strata of fig 1b ω j φ j i ψ j j 1 2 ω a φ a i ψ a where φ j kjhj φ a kaha is the velocity potential hj x y ha x y are three piezometric heads and ψ j ψ a are the stream functions in the upper lower strata and aquitard from the darcy law the specific discharge vector is v j k j h j φ j v a k a h a φ a for divergence free flows in fig 1b the characteristic functions obey the laplace equations 2ψ j 0 2ψ a 0 2φ j 0 2φ a 0 we assume that the datum for the head is at point f1 where h1 0 along eu1eu2 and eu3eu4 the heads are h1 h1u h2 h2u where the dyad h1u h2u is determined from the location of the recharge zones in fig 1a anderson 2000 2003 specified the far upstream field by the hydraulic gradients upstream of the y axis flow in both strata is 1 d therefore as an approximation we can assume that along f1eb the head in the first stratum is h1 0 and along f2ec in the second stratum h2 hg where hg is a positive constant determined by a 1 d upstream flow in this stratum the case of the inlet head in the second stratum higher than in the first is mathematically identical for example a low permeable plug fig 1a may cause a relative depression at f2ec as compared with f1eb other causes of variation of the piezometric head across two layered aquifers are discussed in abdalla et al 2018 our interest is what is going downstream of the y axis in fig 1b a line vortex of intensity γ is placed at point o at the middle line of the aquitard in fig 1b this point is selected as the origin of a cartesian system of coordinates x y and complex physical coordinate z x i y the flow rate q through the whole formation is q v 0 d1 2v 0 k a k 1 b v 0 k 2 k 1 d 2 2 1 riesenkampf s line vortex 1 1 a scanned image of the riesenkampf 1940 paper is attached for the convenience of potential referees it can be also uploaded as a supplementary electronic material if the ms is accepted the problem for a composite octagon in fig 1b is intractable for analytical treatment as 2 d flow and will be modeled by modflow in section 2 3 here we consider a simpler flow domain a 3 layered formation shown in fig 1c an aquitard of a thickness 2b is sandwiched between two strata of conductivity k1 and large thickness i e in notations of fig 1b d 1 d 2 all layers in fig 1c are unbounded in the x direction in other words the flow domain is a whole plane i e an unbounded three component composite r 40 considered a line vortex placed at point o and assumed that at infinity the pore water in all three components of the composite is static i e a solitary vortex is the only water agitating entity this vortex models seepage in a two layered foundation under a concrete dam fig 1c with a head drop of hg between the upper pool of the dam and tailwater obviously in the dam problem of r 40 flow at y 0 only has a physical sense the functions of a complex variable v j z d ω j d z v a z d ω a d z are holomorphic except the vortex point at four points at infinity e u2 e d2 ec au ad e u1 e d1 eb the far field conditions are v j a z 0 the singularity at point o is v a z γ 2 π i z as z 0 along the interface z i b the conditions h 2 h a and ψ2 ψ a hold similarly along z i b the refraction conditions are h 1 h a and ψ1 ψ a equivalent conjugation conditions are formulated in terms of the continuity of the normal and a jump of the tangential components of the specific discharge vectors pk 77 strack 2017 r 40 solution reads 1 v 1 r z γ 2 π 1 i z 0 k 1 k a c o s h b α e x p α z k a cosh b α k 1 s i n h b α d α v a r z γ 2 π i 1 z 0 k 1 k a s i n α z e x p b α k a cosh b α k 1 s i n h b α d α v 2 r z γ 2 π 1 i z 0 k 1 k a c o s h b α e x p α z k a cosh b α k 1 s i n h b α d α where α is a dummy variable unfortunately pk 62 77 did not report this solution in full in the appendix we provide a full derivation of eq 1 we introduce dimensionless quantities k k a k 1 αe α b xe ye hje hae h 1e h 2e x y hj ha h 1 h 2 b vae vje va vj k 1 ω ae ω je ω a ω j k 1 b qe γ e q γ k 1 b in the analytical solutions below the subscript e for dimensionless values is dropped for the sake of brevity fortunately integrals in eq 1 can be evaluated that yields 2 v 1 r z γ 2 π 1 i z 1 k 0 c o s h α e x p α z k cosh α s i n h α d α γ 2 π 1 i z 1 2 1 k 1 k 1 iz 2 beta 1 2 1 k i z 2 0 k 1 beta 1 2 1 k 1 i z 2 0 k 1 v a r z γ 2 π i 1 z 1 k 0 s i n α z e x p α k cosh α s i n h α d α γ 2 π i 1 z 1 k 1 k 2 i z 2 f 1 1 1 i z 2 2 i z 2 1 2 1 k 2 i z 2 f 1 1 1 i z 2 2 i z 2 1 2 1 k 4 z 2 v 2 r z γ 2 π 1 i z 1 k 0 c o s h α e x p α z k cosh α s i n h α d α γ 2 π z 1 i 1 k 1 k i z 2 f 1 1 1 i z 2 2 i z 2 1 k 1 k 2 i z 2 f 1 1 i z 2 1 i z 2 1 k 1 k 2 i z where 2f1 and beta are the hypergeometric and beta functions see wolfram 1991 for description and realization of these functions in mathematica r 40 and pk 62 77 did not provide examples of calculations of the velocity fields and flow nets in either two or more layered porous foundations of dams why because the integrals in eq 1 involve oscillating integrands and systematic computations were prohibitively difficult 70 years back on the days when computer algebra did not exist now days eq 2 with integrals expressed via special functions make the computations and kinematic analysis easy in particular we used nintegrate of wolfram s mathematica to get the three complex potentials for plotting the flow nets in the case of small thickness 2b of the aquitard and small ka the aquitard can be replaced by a leaky boundary anderson 2000 stated the leaky boundary represents exactly the effects of a membrane where the membrane has a finite resistance but no thickness correspondingly in the r 40 problem the membrane has a finite resistance and finite thickness let us illustrate that the solution of r 40 with refraction conditions along y b is reduced to flow in a homogeneous half plane with the robin boundary condition along y 0 which anderson 2000 used namely in the anderson 2000 limit points su sd f1 in fig 1 merge into point o and along the two rays oad and oau we have in dimensional quantities 3 h 1 x 0 n c h 1 x 0 h u d 0 where n is the normal to oad and oau hu and hd are the water levels in the upper pool and tail water of the dam fig 1c respectively c ka 2 kb is usually called resistivity of the leaky line a mathematically identical boundary condition is called the newton one for heat conduction in a solid body a boundary of which is subject to convective cooling see e g lebedev et al 1966 van der veer 1978 used the verigin holomorphic function see pk 77 and solved the problem for a line vortex with the boundary condition 3 actually this solution has been earlier obtained in the theory of heat conduction lebedev et al 1966 problem 304 in terms of the hydraulic head in the quarter plane x 0 y 0 lebedev s solution to the heat conduction problem reads in the earlier introduced dimensionless quantities 4 h 1 x y h g 2 1 2 k π 0 exp α y s i n α x α α k d α where similarly to van der veer 1978 we assumed that along the vertical line x 0 the head h1 0 y 0 then due to symmetry of the flow along the tail water ray oad h1 x 0 hg 2 hg hu hd see fig 1c both lebedev et al 1966 and r 40 used the fourier transforms to obtain their analytical solutions see our appendix in fig 2 curve 1 indicates the head distribution h1 x 1 for hg 1 5 γ 3 and k 0 5 calculated from r 40 i e for a finite thickness of the leaky layer curve 2 corresponds to h1 x 0 along a leaky boundary computed by eq 4 even for this relatively large k the two heads are close to each other curve 3 corresponds to h1 x 1 in r 40 for hg 1 5 and k 0 1 for this k solution 4 virtually coincides with r 40 as was the case for a line sink in anderson 2000 2 2 analytical solution for line vortex superposed with dipole in eq 2 the real component of var is zero along the ox axis in fig 1c correspondingly the piezometric head is constant along oau and along oad the head of course jumps from one ray to another this allowed r 40 to interpret this mathematical solution as flow under a concrete dam fig 1c eq 2 have another property the imaginary parts var vjr vanish along the oy axis in other words the rays oeb and oec are also constant head rays therefore using the linearity of the laplace equation which governs the heads and stream functions in the three subdomains of fig 1c we can use the principle of superposition so we add another vector field to one described by eq 2 obviously the added field has to obey the same governing equation and boundary conditions because our initial problem is an aquifuge aquitard flow in fig 1a and b we like anderson 2003 add dipoles at infinity unidirectional flows in the three layers of fig 1c these unidirectional flows retain the refraction boundary conditions along the lines z iband have zero imaginary components of velocities and constant heads along the ordinate axis the superposition gives 5 v 1 z v o v 1 r z v a z v o k v a r z v 2 z v o v 2 r z the far field conditions in the vector field 5 are v 1 z v 0 va z v 0 k v 2 z v 0at z for comparisons see anderson 2003 for his far field conditions in his zone 2 we note two things the specific discharge in the two strata far upstream and downstream of point o v0 is arbitrary but in the aquitard it is determined by the refraction boundary conditions in numerical simulations the conductivities of the strata in fig 1b can be different as well as the incident velocities upstream of point o the complex potentials are obtained by integration of eq 5 as following 6 ω 1 z v 0 z i γ 2 π i l o g z log i γ k 1 4 π i z 1 k 1 k 1 iz 2 beta 1 2 1 k iu 2 0 k 1 beta 1 2 1 k 1 iu 2 0 k 1 d u ω a z k v 0 z i γ 2 π i l o g z log i γ 2 π i k 1 k 1 i z 2 i u 2 f 1 1 1 iu 2 2 iu 2 1 2 1 k 2 i u 2 f 1 1 1 iu 2 2 iu 2 1 2 1 k 4 u 2 d u ω 2 z v 0 z x f i γ 2 π i l o g z log x f i φ a x f i k γ 2 π k 1 k 1 x f i z i z 2 f 1 1 1 i z 2 2 i z 2 1 k 1 k 2 i z 2 f 1 1 i z 2 1 i z 2 1 k 1 k 2 i z d u in this integration in the first two equations of 6 we used the condition that at the fiducial point f1 fig 1c zoomed in fig 3 a the complex potentials in stratum 1 and in the aquitard are ω a ω1 0 point f1 belongs to both layers the third equation in 6 needs more elaboration indeed in the r 40 case d1 d2 k2 k1 in notations of fig 1b and v0 0 pure vortex flow consequently the r 40 streamlines in fig 1c are symmetric with respect to both coordinate axes with superposition of unidirectional fields i e in flows described by eqs 5 and 6 there is no such symmetry therefore the streamline ψ a ψ1 ψ2 0 which starts at the fiducial point f1 z ib does not pass through the point z ib instead it intersects the upper interface of the aquitard at a point fr i e at z xf i fig 3a consequently we first find xf from the equation ψ a xf 1 0 for this purpose we use the findroot routine of mathematica we note that the expression ψ a x y is an imaginary part of the second eq 6 then we use the real part of the second eq 6 i e φ a x y and find the potential at point fr fig 3a as φ a xf 1 eventually we use the conjugation conditions of the potentials in the aquitard and upper layer across the interface i e φ2 xfr 1 φ a xfr 1 k the streamline ψ2 0 refracted at point fr continues in the upper stratum fig 1d here we have two scenarios depending on the dyad γ v1 the vortex intensity γ should be high enough to complete the loop if so the fiducial streamline eventually bends to the left and intersects the oy axis at point f2 fig 3a the ordinate of this point yf2 is found by the findroot routine of mathematica from the equation ψ2 0 y 0 we will illustrate later the flow net for a physically meaningless case of a relatively small γ r 40 selected an arbitrary streamline sufsd fig 1c as an impermeable dam contour and discarded the flow domain above the ox axis for the flow field 5 we make a similar trick a streamline f1sf2 is considered as a bonnet tip of the aquifuge a geologically real boundary between the aquifuge and aquitard a dashed line in fig 1c and 3a is of course not so smooth and regular as a vortex generated f1sf2 see for instance the pictures in maliva and missimer 2012 however the geometry of this line has only a local effect not influencing the regional flow the ordinate of point f2 yf2 is greater than 1 in other words the discarded aquifuge on the left x 0 has a slightly higher thickness 2ba than the aquitard on the right x 0 the last step is similar to r 40 we discard the left half of the flow domain in fig 1c and pass to the scheme shown as the domain x 0 in fig 1b now the physical meaning of the vortex strength is determined from the following physical conditions the piezometric head along f2ec is hg φ2 0 y y f2 y for sufficiently large γ there is a stagnation point fs fig 1b the streamline passing through this point is a separatrix which demarcates a segment f2fs through which groundwater exfiltrates from the upper stratum through a segment fsec water infiltrates into this stratum we have v2 x y expressed by eqs 2 and 5 and hence we use the findroot routine of mathematica and evaluate the ordinate ys as a solution of the equation v2 0 y 0 then we put the found ys into eq 6 and find the quantity of backflow as qb ψ 0 ys it is noteworthy that the two branches of the separatrix intersect the constant head boundary f2ec at point fs at angles π 4 as is zoomed in fig 3b this is a common feature of a separatrix see e g kacimov and youngs 2005 at a point where the complex potential is not a holomorphic function i e at this point the streamline is not orthogonal to the constant head line the peculiarity of flow topology at critical points mathematical singularities i e zero or infinite darcian velocities is important in numerical simulations of contaminant transport even for purely advective transport models fdm cells involving singularities call for a special treatment for example zheng and bennett 2002 section 6 2 3 introduced the concept of a weak well an fdm cell with this well requires a special analytical refining which zheng and bennett carry out by considering a rigorous solution see their eq 6 54 in the vicinity of the singularity in the zheng and bennett algorithm advection of tracked particles close to the weak well is controlled by the analytically derived velocity filed similarly in our case of the stagnation point fs in fig 1b a boundary fdm cell shown in fig 3b needs an analytical characterization for proper tracking of marked particles three particles in fig 3b are located at three zones separated by the swerving streamline similarly to fig 6 21 in zheng and bennett 2002 if we look at a large scale picture of fig 1b the advective fate of these three particles is remarkably different the vector field 2 and 5 provides explicit and rigorous formulae for the zheng and bennett 2002 algorithms of kinematics of groundwater flow near our week flow point fs if dispersion is counted in transport models chapter 7 of zheng and bennett 2002 then the vector field 2 and 3 gives an explicit meshless evaluation of the peclet numbers and dispersivities at any point and in any zone of the flow domain that is another advantage of analytical solutions strack 2017 kacimov et al 2018 for example in the cell containing the stagnation point fig 3b an ade modeled transport is dominated by diffusion and in cells not shown close to points f1 fr f2 in fig 3a transport depends on the dyad γ v0 and therefore is controlled by either advection or both advection and dispersion now we illustrate our analytical results by wolfram s mathematica 2 2 our computer programs in mathematica and modflow are open codes we can share them with interested referees and readers in all computations below we used the contourplot and streamplot built in functions in fig 4 a f we fixed the triad γ k v0 3 0 1 0 2 then from the second eq 6 the dimensionless head at the inlet segment oec is h2 hg 15 we recall that a vortex makes a head drop from 0 on the right bank of the cut oeb to 2hg on the left bank of this cut with half of this drop at the ray oec for the selected triad xf 0 29 yf2 1 033 φ2 xf 1 14 65 ys 17 42 qb 3 47 fig 4a shows the streamlines on a large scale plotted from the vector field 5 fig 4b uses eq 6 and plots the streamlines and constant piezometric head lines close to the bonnet the near field in fig 1a solid lines are the streamlines ψ1 2 a 0 l 1 0 5 l 1 2 7 curves 1 6 hereafter correspondingly dashed lines are constant head lines h 1 2 a 1 2 4 6 8 12 13 14 14 5 curves 7 15 a streamline ψ a 1 not labeled is almost semi circular it has no physical meaning because located inside the confining loop of the streamline ψ a 0i e inside the aquifuge as fig 4b shows in the near field flow is indeed perpendicular to the aquitard fig 4c shows the contours of constant magnitudes of hydraulic gradients v1 2 and va k computed from eq 5 curves 1 7 correspond to the gradients of 0 5 0 75 1 1 1 5 6 and 7 we recall pk 62 77 that in darcian flows zones of a porous medium where this gradient exceeds 1 are considered to be prone of seepage erosion e g suffusion colmatage and lessivage see pk 77 fig 4c demonstrates that in the vicinity of the bonnet the erosional stability criterion of unit gradient is violated in all three layers of the composite very high gradients emerge in the aquitard the read curve in fig 4c is the bonnet ψ 0 i e what is on the left of this contour should be ignored in fig 4d we plotted the streamlines and constant head lines near the stagnation point fs and separatrix solid lines are streamlines ψ2 2 6 3 0 3 4 3 6 3 8 4 5 6 7 curves 1 9 we note that the streamlines ψ2 3 0and 3 4 have two disconnected branches dashed lines show the contours h 2 14 14 4 14 8 15 15 2 15 6 16 17 18 curves 10 18 fig 4e presents the streamlines and constant head lines in the middle field fig 1a solid lines are the streamlines ψ1 2 a 8 6 l 1 0 2 l 1 2 5 curves 1 5 dashed lines are constant head lines h 1 2 a 13 5 l 1 0 5 l 1 2 7 curves 6 12 fig 4f illustrates the flow net in the far field of fig 1a solid lines are the streamlines ψ1 2 a 18 65 l 1 0 05 l 1 2 4 curves 1 4 dashed lines are constant head lines h 1 2 a 67 5 l 1 0 5 l 1 2 5 curves 5 9 clearly even in the middle field flow is significantly titled with respect to the aquitard eventually in fig 4g we changed the triad to γ k v0 0 3 0 1 0 2 and plotted the flow net in the near field solid lines are the streamlines ψ1 2 a 0 2 l 1 0 1 l 1 2 5 curves 1 5 dashed lines are constant head lines h 1 2 a 0 5 l 1 0 5 l 1 2 3 4 curves 5 9 the fiducial streamline ψ1 2 a 0 curve 3 does not make a full loop to oec fig 3a consequently this value of γ 0 3 is too small i e the mathematical solution has no physical sense 2 3 modflow simulations now we simulate the problem numerically using modflow 2005 simcore 2012 the model runs for steady state and the conductivities also indicated in fig 1a correspond to that used for the analytical solution but the sizes of the flow domain are finite in both x and y directions we start with a rectangular three component composite which in notations of fig 1b has ld 100 m d1 20 m d2 30 m 2b 2 m k1 k2 10 m day ka 1 m day the domain is gridded with 52 layers and 100 columns forming a total number of 5200 active cells fig 5 with the cell sizes of δy δx 1 m the generalized conjugate gradient with a preconditioning method involving a modified incomplete cholesky solver has been selected with a convergence criterion of 0 001 the effective porosity is set for 0 15 and both the left hand side and right hand side boundaries are assigned as constant head boundaries with h2 hg 15 m for the left hand side boundary of layer 2 and h1 0 m for the layer 1 the outlet head in all three layers is h2e 33 5 m see fig 1b these boundary conditions correspond to the analytical solution for the case illustrated in fig 4 obviously the velocity vectors in all three layers of fig 5 are strictly horizontal at x 100 m in section 2 2 we had no constant vertical segment at the right of fig 1c but rather the far field velocity conditions in the three layers numerical solutions will illustrate how far from point o a vertical constant head segment a surrogate far filed should be placed for comparisons with the analytical solution the hydraulic head contours and the trajectories of marked particles across the modeled flow domain are presented in f a and b respectively we note that the dashed black line in fig 6 b is a separatrix see also fig 1b and 3b fig 6 clearly illustrates that cross flow in the aquitard is vertical only close to the tip of the aquifuge downstream the pathlines in the aquitard are oblique and close to the outlet are almost horizontal this corroborates the analytical solution for a semi infinite r 40 domain in fig 6c we compare the distributions of the total head along the line x 4 5 m obtained analytically curve 1 and numerically curve 2 the vortex strength is selected in the following manner the drop of head from the ray of1eb zero head boundary to of2ec where the modflow dimensional head is 15 m should be provided by the vortex of dimensional intensity 30 m2 day that in dimensionless quantities corresponds to γ 30 1 10 3 0 overall there is a good match between analytical and modflow models in the position of the separatrix m11m23 fig 1c piezometric heads and qb a more general case of an octagon as the flow domain corresponds to one studied by anderson 2003 in fig 7 a we consider an aquifuge extending into the aquifer for 15 m this corresponds to lu1 lu2 15 m in fig 1b the flow domain presented by fig 7a is gridded as in fig 5 the piezometric head contours computed by modflow and trajectories of marked particles released in the vicinity of the left hand side boundary are presented in fig 7b and c respectively the inlet head along eu1eu2 in notations of fig 1b is h1u 0 fig 7c illustrates a flow topology where groundwater particles moving from the lower layer cross vertically the aquitard and move leftward around the protruding tip of the aquifuge into the upper stratum schematically the locus of the stagnation point fs and of the separatrix for this case is depicted in fig 3c if the head along eu3eu4 in fig 3c is reduced then the stagnation point drifts to this vertical line and with a further drop of h2u even to the caprock the latter scenario is illustrated by simulations presented in fig 8 a b where the inlet head along eu3eu4 is h2u 25 m i e decreased 10 m as compared with the scenario plotted in fig 7 clearly with the aquifuge protrusion in fig 7 8 the vortex based analytical solution is not applicable 2 4 dupuit forchheimer approximation in this section we follow and compare the 2 d analytical and numerical solutions with the df approximation anderson 2003 and strack 2017 we consider a rectangular flow domain we recall that in terms of the df model the dimensionless depth y averaged hydraulic heads h 1 x h 2 x in the two aquifers obey the system of linear coupled odes 7 d 2 h 1 d x 2 k h 1 h 2 0 x l d d 2 h 2 d x 2 k h 2 h 1 0 x l d which for the 2 d flow domains of section 2 2 and rectangular domain in fig 7a of section 2 3 should be solved with the following boundary conditions fig 1b 8 h 1 0 0 h 1 l d h e h 2 0 h g h 1 l d h e in the df approximation the aquitard is postulated as a vertically conducting layer bvp 7 and 8 has a simple analytical solution in exponential functions we will drop it here for the sake of brevity in fig 9 curves 1 and 2 present h1 x and h2 x for the same parameters as in fig 7 i e we selected dimensionless quantities ld 100 he 33 hg 15 k 0 1 in the upper layer h2 has a maximum h 2m 9 6 attained at xm 5 7 in the df model this maximum means that the corresponding line x xm is a vertical separatrix watershed in other words groundwater moves both to the left and right with respect to this line i e the model predicts seepage out of the flow domain through the whole line f2ec fig 1b however both the analytical and numerical 2 d models for this set of parameters evidence that this is not the case viz the 2 d separatrix is a curve which demarcates only a corner zone near point f2 figs 1b and 6a of backflow i e the constant head line f2ec seeps in both directions this illustrates quantitative and qualitative differences in the outputs of the scaffolding hierarchy of groundwater flow models bean et al 2017 3 concluding remarks the analytical solutions and modflow simulations of 2 d refracting flows in three layered aquifers give consistent flow nets the flow topology in this porous composite is rather complex and can not be deduced from the df approximation even relatively thin aquitards can not be always conceptualized as simple vertically conducting commuters of groundwater between sandwiching aquifers the r 40 technique of solving boundary value problems for analytic functions in piece wise homogeneous domains can be extended to the case of vertical leaky layers impeding the incident flows the topology of advected contaminants across aquitards requires a scrutiny of refracted cross flows see e g verruijt and swidzinski 1993 the fine textured skeleton of the aquitards can be subject to high hydraulic gradients and ensued seepage induced erosion that can transform an allegedly low permeable stratum into a permeable conduit which transmits appreciable quantities of low quality groundwater from one aquifer to another similarly to abandoned wells avci 1994 acknowledgments this work was supported by the squ project ig agr swae 14 02 critical comments by two anonymous referees and a kind help from i lebedeva saratov university russia is appreciated supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 007 appendix b supplementary materials image application 1 appendix re derivation of r 40 solution for a three layer composite plane agitated by line vortex for an arbitrary dyad d 1 d 2 of strata thicknesses in fig 1b and v0 0 solution to the refraction problem in a three component composite plane which is agitated by a line vortex placed at an arbitrary position z z0 is sought in the form of fourier s integrals a1 v a z γ 2 π i 1 z z 0 1 2 π i 0 a a α exp i α z b a α exp i α z d α v j z 0 a j α exp i α z b j α exp i α z d α a a a a r i a a i b a b a r i b a i a j a j r i a j i b j b j r i b j i where a a r α a a i α b a r α b a i α a j r α a j i α b j r α b j i α j 1 2 is the dodecad of real functions to be found the no flow conditions along the caprock and bedrock are a2 im v 1 x i b d 1 0 im v 2 x i b a d 2 0 for the r 40 case in fig 1c we have z0 0 d 1 d 2 k1 k 2 and the general integral a1 is simplified as following first at z i y and y the far field limit is vj 0 therefore in eq a1 the velocities in the two strata half planes y 1 y 1 are a3 v 1 z 0 b 1 r α exp i α z d α v 2 z 0 a 2 r α exp i α z d α i e we have a hexad a a r α a a i α b a r α b a i α a 2 r α b 1 r α of functions to be found next for a vortex placed just on the midline of the aquitard z 0 the real part of velocity vanishes along the ox axis i e va x 0 0 therefore aai bai aar bar this reduces the hexad to a tetrad next we use the four refraction conditions along the two lines z x i for this purpose we bring the first term of the first equation in eq a1 under the sign of integration using the following integrals a4 i z 0 exp i α z d α for z 0 z 0 correspondingly at the lower interface in fig 1c im va x i im v1 x i then for the coefficients at the cos x terms we recall that in the fourier method the inegrands are expanded into harmonics we immediately get aar 0 from the coefficients collected at the sin x terms of the expansion we obtain a5 b 1 r γ 2 π a a i π e x p α c o s h α at the same interface the second refraction condition is re va x i k re v1 x i this for the grouped coefficients at the cos x terms gives a6 k b 1 r γ 2 π a a i π e x p α s i n h α consequently the system of linear eqs a5 and a6 is solved with respect to the dyad aai b1r identically we use the refraction conditions along the upper interface in fig 1c im va x i im v1 x i k re va x i im v1 x i from which we evaluate a2r α eventually we put the found triad aai α a2r α b 1r α into eq a1 and use eq a4 to come back from an integral form to an explicitly expressed vortex term in both strata this leads to eq 1 in the main body of the text 
713,the study carried out a numerical investigation of the open channel flow through a circular array of cylinders piercing the water surface unlike a lot of the previous research this study took into account the influence of the bed friction and free water surface a zonal detached eddy simulation zdes model was developed to simulate the turbulent free surface flow the non hydrostatic model was discretized using the finite volume method fvm within the patch each individual cylinder was directly modelled by specifying the no slip boundary condition at the solid surface the zdes model was verified to be able to capture the small scale turbulent coherent structures the instantaneous and average flow fields were analysed in detail with the aid of streamline visualization and vortex identifying technique q criterion the investigation shed light on the complex interaction between the free surface flow and the cylinder array arranged into a circular patch the complexity arises from the interplay among the separated flows from individual cylinders interference between adjacent cylinders and the bulk porous media effect of the patch the study highlighted the dependence of the flow characteristics on the key properties of the patch especially the solid volume fraction svf the work demonstrated the encouraging capability of the established numerical technique for the investigation of vegetated flows keywords vegetated flow zonal detached eddy simulation turbulent coherent structure cylinder patch non hydrostatic pressure notation the following symbols are used in this paper x spatial position in x direction y spatial position in y direction z spatial position in z direction σ the transformed coordinate in vertical direction φ solid volume fraction d total water depth h still water depth ζ water elevation d the distance to solid walls ds the constituent cylinder diameter dg the patch diameter d 0 the gap between two neighbour cylinders tvd total variation diminishing st strouhal number υ t eddy viscosity coefficient υ the auxiliary variable u friction velocity δ the nondimensional distance to the solid wall q the second invariant of the velocity gradient tensor ω i j the anti symmetric components of v sij the symmetric components of v cdes constant parameter cdi cdg drag force coefficient of individual cylinder and the array cdi cdg time averaged drag force coefficient of individual cylinder and the array cli clg lift force coefficient of individual cylinder and the array cli clg time averaged lift force coefficient of individual cylinder and the array 1 introduction aquatic vegetation plays a key role in providing a wide range of ecosystem services it provides various habitats for aquatic animals to efficiently promote bio diversity kemp et al 2000 by means of trapping solute mass and releasing oxygen vegetation helps improve water quality gacia and duarte 2001 cotton et al 2006 widdows et al 2008 in natural rivers aquatic vegetation affects flood routing by increasing flow resistance furthermore vegetation can significantly alter the turbulence characteristics of open channel flows which influence sediment erosion and deposition patterns and ultimately channel morphology bouma et al 2007 rominger et al 2010 the hydrodynamics of vegetated flow has generated considerable research interest zong and nepf 2011 nepf 2012 circular cylinders are often used to model rigid vegetation piercing the water surface because they offer a well defined representation of the stems the complicated turbulent flow induced by numerous cylinders with various bulk densities poses a great challenge to computational methods most experimental studies have mainly focused on characterizing the wake structure of the flows around porous obstructions zong and nepf 2011 these studies present quite a few limitations for example from a technical point of view it is extremely challenging to measure the drag on individual elements of the array and the flow field within the array the dense cylinders in the patch make it difficult to obtain a clear laser sheet for the particle image velocimetry piv measurement the local flow field immediately behind a cylinder is confined in a space that is often too small and tortuous for conventional probes to traverse through compared to physical experiments numerical simulations can reveal the flow pattern over the entire computational domain and across a wide range of frequencies in recent decades a lot of numerical modes have been proposed to investigate the flow through cylinders the porous model has become popular in numerical simulations of flow through vegetation gotoh et al 2004 li and yan 2007 cui and neary 2008 li and zeng 2009 li and zhang 2010 gao et al 2011 ma et al 2013 maza et al 2013 the porous model takes into account the effect of solid cylinders by means of extra drag force terms in the momentum equations the drag force to the flow is distributed over the computational cells occupied by the array of solid cylinders such an approach is incapable of capturing the coherent flow structures between the individual cylinders in the patch rather than using the simplified distributed drag force approach some models have relied on the wake to wake and wake to cylinder interactions within the cylinder arrays nezu and sanjou 2008 okamoto and nezu 2010 stoesser et al 2009 nicolle and eames 2011 chang and constantinescu 2015 kazemi et al 2017 wang et al 2018 compared to the rans model the les model is more advanced for predicting turbulent coherent structures which is accompanied by a significant increase in the computational cost the tremendous computational cost hinders the wide application of the les to vegetated flows that involve a wide range of spatial and temporal scales balancing the computational cost and efficiency the hybrid rans les model is arguably an ideal strategy for the simulation of a wide range of complex flows with high reynolds numbers li and yu 2010 proposed a hybrid rans les model to simulate the flow around vegetation patches where the bulk obstruction was modelled by introducing a drag force term into the momentum equations although the high resolution model was successful in modelling the bulk effect of the cylinder group and the wake flow such a model was unable to simulate the detailed turbulent coherent structures within the patch the current study aims to analyze the characteristics of the mean and instantaneous flow fields and the distribution of the drag and lift forces acting on the cylinders a zonal detached eddy simulation zdes is used to investigate the flow through and around a cylindrical array where the individual cylinders are explicitly modelled as solid objects the model stress depletion msd is one of the critical problems faced by the rans les hybrid model and is pronounced in the des when the model switches from the rans to les in the sub boundary layer spalart et al 2006 proposed a new version of des i e ddes which delays the switch over from rans to les although the msd issue is partially overcome the les content is not sufficient in the boundary layer because of the overuse of the rans mode shur et al 2008 introduced a refined model known as iddes for simulations with an ambiguous grid scale which can overcome the msd problem by modifying the turbulent length scale the initial condition and inflow condition because the msd issue comes from the insufficient velocity fluctuation when the model switches from the rans to les generation of fluctuations by the numerical method is a feasible way to stimulate the les content near the interface keating and piomelli 2006 presented a dynamic stochastic forcing method which significantly speeds up the transition and results in more accurate predictions of the velocity fluctuation compared to the numerical generation of fluctuation deck 2005 and deck et al 2011 proposed a zdes approach to avoid the msd in a different way this approach was more efficient and was implemented by modifying the parameters in the spalart allmaras sa turbulence model instead of calculating stochastic velocities breuer et al 2003 obtained an excellent agreement with the reference les solution when using zdes for simulations of massive separation flows around a flat plate to the best of the authors knowledge few studies have been reported on the application of the zdes to the free surface flow through arrays of cylinders which represent vegetation patches in environmental flows the in house code used in this study adopts a non hydrostatic model for simulating free surface flows and is highly efficient zhang et al 2014 the analysis focuses on the turbulent coherent structures within and around the array of cylinders the present work shows the suitability of the zdes model for modelling vegetated flow and highlights the sensitivity of the flow to the key properties of the vegetation patch the study is structured as follows in section 2 the numerical formulation and the case studies are described the numerical implementations are described in section 3 the simulation results are analysed and interpreted in section 4 the general conclusions are presented in section 5 2 numerical formulation 2 1 mathematical model the full hydrodynamic model is extended from the well known shallow water equations based on the hydrostatic assumption by means of the introduction of the non hydrostatic terms into the momentum equations casulli 1999 jankowski 1999 casulli and zanolli 2002 kocyigit et al 2002 fringer et al 2006 ma et al 2012 zhang et al 2014 the extended model greatly widens the applicability when the hydrostatic assumption being invalid to fit the free surface and the uneven bottom a σ coordinate transformation is adopted the transformation between the σ and z coordinates isσ z ζ h ζ where z 0is at the still water level swl in the computational domain σ 0refers to the free surface and σ 1refers to the bottom the governing equations are as follows 1 ζ t q x x q y y q σ σ 0 2 q x t q x u x q x v y q x ω σ g d ζ x d ρ 0 p n x x υ t q x x y υ t q x y 1 d σ υ t d q x σ 3 q y t q y u x q y v y q y ω σ g d ζ y d ρ 0 p n y x υ t q y x y υ t q y y 1 d σ υ t d q y σ 4 q z t q z u x q z v y q z ω σ 1 ρ 0 p n σ x υ t q z x y υ t q z y 1 d σ υ t d q z σ where q x d u q y d v q z d w q σ d ω u v w are the respective velocities in the x y and z directions ω is the vertical velocity in the σ coordinate framework d h ζ is the total water depth h is the still water depth ζ is the free surface elevation pn is the non hydrostatic pressure g is the gravitational acceleration υ is the molecular viscous coefficient and υ t is the eddy viscosity coefficient the velocity along the σ coordinate is calculated as 5 q σ q z d q x d σ d x ζ x q y d σ d y ζ y σ d t ζ t the eddy viscosity υ t is determined using the one equation spalart allmaras sa turbulence model in which the advection and diffusion equation for the auxiliary variable υ is given by 6 d υ t d υ u x d υ v y d υ ω σ d c b 1 s υ d c w 1 f w υ d 2 1 σ x υ t υ d υ x y υ t υ d υ y d σ υ t υ d υ d σ c b 2 σ d υ x 2 d υ y 2 d υ d σ 2 the eddy viscosity υ t is calculated from υ according to 7 υ t υ f v 1 where f v 1 χ 3 χ 3 c v 1 3 χ υ υ and υ is the molecular viscosity the function fw is calculated as f w g 1 c w 3 6 g 6 c w 3 6 1 6 withg r c w2 r 6 r r υ s κ 2 d 2 s s υ κ 2 d 2 f v 2 and f v 2 1 χ 1 χ f v 1 here s is the magnitude of the strain rate tensor calculated as s 2 ω i j ω i j with ω i j 1 2 u i x j u j x i the constants in the above equations arec b1 0 1355 σ 2 3 c b2 0 622 κ 0 41 c w 1 c b 1 κ 2 1 c b 2 σ c w2 0 3 c w3 2 0 and c v1 7 1 in the above eq 6 the length scale d in the destruction term is determined by the smaller value between the rans and les length scales 8 d min d c d e s δ where δ max 4 a π δ z a is the area of the horizontal grid cell for unstructured mesh 4 a π is the characteristic length in the horizontal discretisation δz is the vertical grid size the constant cdes 0 65 and d is the distance to the nearest solid wall in the present zdes model the above grid scale δ is calculated for use in formula 8 in the rans zone but it is calculated as the cube root of the cell volume δ a δ z 1 3 when switching to the les mode furthermore the values of fv1 fv2 and fw are specified as follows 9 f v 1 1 f v 2 0 f w 1 2 2 numerical scheme a predictor corrector scheme was used in the solution algorithm the flow driven by the hydrostatic pressure was first calculated in the predictor step and the flow driven by the non hydrostatic pressure was then updated in the corrector step the model can be easily switched to nonlinear shallow water equations when the corrector step is skipped the governing equations were discretised based on the finite volume method fvm the grid system consists of unstructured meshes in the horizontal plane and multi layers in the vertical direction a 2nd order total variation diminishing tvd scheme called the osher scheme was adopted to discretise the convective terms and a central difference scheme was used to discretise the diffusion terms in the corrector step the poisson type equation for the non hydrostatic pressure was numerically solved by a pre conditioned bi conjugate gradients stabilised method bi cgstab the in house codes hydroflow were paralleled using the openmp library zhang et al 2014 3 model implementation 3 1 geometry and mesh specification the array geometry used in experiments zong and nepf 2011 was chosen in this study the cylinder array consists of circular cylinders with the same diameter ds the diameter dg of the patch was considerably larger than the diameter of a constituent cylinder the solid volume fraction svf was varied via the variation of the number of cylinders in the array correspondingly the number of cylinders was calculated as nc φ dg ds 2 in which φis the svf value the cylinders were arranged in a staggered pattern with a uniform distribution in the patch the distance d0 between the two neighbouring cylinders was kept by placing the cylinders at the vertex of an equilateral triangle network and was varied according to the specified svf the parameters for each case study are listed in table 1 the domain geometry and local meshes are schematically shown in fig 1 the array is symmetrical about the central line of the channel the channel has a width of w 7dg which is equal to250ds while l 10dg and 40dg were chosen as the lengths upstream and downstream of the array respectively fixed flow rate was specified at the inlet and fixed water elevation was specified at the outlet at the bed and at the solid cylinders walls a no slip boundary condition was used the grid resolution needs to be designed in an elaborate manner for des the basic rans zone covers the near wall boundary layer and beyond a critical distance is the les zone a good choice of the critical transition height should be in the range of tens of nondimensional wall units z 1 where the most vigorous turbulent activity occurs pope 2000 in the case of zdes used in the present work which is based on the sa model the grid scale normalised by the wall unit was strictly limited to meet the condition δ o 1 at the first grids of the solid wall and was subsequently stretched at a ratio of 1 15 in regions away from the solid wall for open channel flows hinterberger 2004 proposed a valuable specification of grid size for the les where the grid size was properly designed in the range of 1 20 1 10 h with h as the still water depth within the array the mesh elements around the cylindrical surface have a characteristic length scale equal to 0 1ds in the region outside the array the mesh resolution varied from 0 1 h in the near wake field to 3 h in far wake field 3 2 diagnostics 3 2 1 flow diagnostics to analyse the flow characteristics the vorticity ω u was used to examine the rotational feature of the flows it is expected that small scale vortical structures are well predicted by the zdes model a positive isovalue of the criterion q denotes turbulent structures which are defined as the vortex tubes in the regions with the positive second invariant of the velocity gradient tensor 10 q 1 2 ω i j ω i j s i j s i j 1 2 u i x j u j x i 0 where sij and ω ij are the symmetric and anti symmetric components of v these measures have been adopted in many turbulent flow studies jeong and hussain 2006 3 2 2 force diagnostics the cylinders within the array are indexed with i where 1 i nc the total force on the cylinder i is calculated through the integration of the force over the water depth 11 f i h ζ 0 2 π p i i τ i n r i d θ d z where pi is the total pressure on the cylinder surface i is the identity matrix τ i is the friction stress on the solid surface ri is the radius of the cylinder i and n is the unit normal vector of the cylinder s surface the drag and lift coefficients are defined in terms of the undisturbed free stream velocity u 0 x and the projected area of a cylinder dsd 12 c d i t f i x 1 2 ρ d s d u 0 2 c l i t f i y 1 2 ρ d s d u 0 2 the time averaged drag coefficient for an individual cylinder over a period t from the initial time t0 is defined by 13 c d i 1 t t 0 t t 0 c d i d t the time averaged root mean square rms value of the lift coefficient of an individual cylinder is defined by 14 c l i r m s 1 t t 0 t t 0 c l i 2 d t the drag and lift coefficients of the cylinder array are defined as 15 c d g t i 1 n c f i x 1 2 ρ d g u 0 2 c l i t i 1 n c f i y 1 2 ρ d g u 0 2 the time averaged drag coefficient and the rms of the lift coefficient of the array are expressed as 16 c d g 1 t t 0 t t 0 c d g d t c l g r m s 1 t t 0 t t 0 c l g 2 d t for all the studied cases the model was first run to achieve a fully developed turbulent flow and then the information was continually recorded for a duration of 50dg u 0 or 1800ds u 0 the simulation was saved at a sampling frequency of 50 hz to capture the unsteady separated flow around individual cylinders assuming a strouhal number of 0 2 the characteristic periods of the vortex shedding induced by the cylinder s patch and by an individual cylinder are approximately equal to 5dg u 0 and 5ds u 0 respectively the data records were sufficient for identifying the characteristic frequency of the dynamic forces 4 results and discussion 4 1 model validation the numerical model was first validated against the experimental measurements conducted by zong and nepf 2011 in which the classical wake flow pattern downstream of the cylinder patch was quantitatively identified the experiment with a middle svf φ 0 1 was used to verify the numerical method and the simulation strategy the calculated mean velocities at the mid depth were extracted and compared with the measurements see fig 2 the simulation outcomes coincided well the measurements behind the patch the velocities decreased in the near wake field and recovered in the far wake field one prominent advantage of the numerical simulation is its powerful ability to provide abundant flow contents especially within the cylindrical array where the measurements are difficult to be conducted for numerical modelling it is important to design the mesh resolution depending on the characteristic flow scales the mesh resolution is required to be fine enough for modelling the boundary flow near the solid wall fig 3 shows the estimation of the mean non dimensional distance to the cylindrical surface i e δ n δ n u υ where u is the mean frictional velocity and δ n is the distance to the solid wall the above δ n value was calculated for the cylinder located in the most upstream position as the level of turbulent flow was more intensive than the downstream cylinders in the array fig 3 reveals that the first near wall grid points were located with δ n 3 which meets the requirement for the no slip boundary condition in addition to the mesh resolution in the boundary layer the interface region between the les and rans zones is critical for the zdes model the location of the zone interface around the most upstream cylinder varied in the range of δ n 10 30 4 2 mean flow analysis the wake flow field is classically divided into the near field l1 and the far field l2 the longitudinal profiles of u u 0 along the centreline at different svf are shown in fig 4 when the svf increased the length of the near wake field was shortened and the longitudinal velocity in the far field recovered much faster the minimum velocity u in the near field approached nearly zero at svf 0 104 which was analogous to the flow around a solid cylinder the high svf blocked the flow passing through the cylinders and induced strong flow separation from the shoulders of the patch to form a near wake zone in which the flow speed was smaller for both svf the maximum spanwise velocity appeared at the array sides but there were opposite velocities across the interface between the near and far wake fields for higher svf see fig 4 the rms values of the fluctuated spanwise velocities along the centre line are shown in fig 4 at low svfs vrms reached its maximum value within the array and decreased gradually downstream however the vrms reached a peak close to the interface between the near and far wake fields at higher svf at decreasing svf the streamwise velocities recovered slowly and resulted in a longer transitional length the near wake field recovered quickly at high svf this induced increased fluctuations of the spanwise velocity in addition to the velocity profiles in local domain the overview of the flow field provided a clear visualisation of the wake field structure figs 5 and 6 present the mean out of plane vorticity for both svf values within the cylindrical array see fig 5 two shear layers with positive and negative vorticities were generated adjacent to a single cylinder the intensity of the vorticity weakened at further downstream cylinders such a trend was much more visible at high svf at low svf because the shelter effect of the cylinders was too weak to exert a significant impact on the flow separation induced by a constituent cylinder the two shear layers remained nearly symmetrical throughout the array however the asymmetrical flow structures were distinct at high svf within the array especially close to the two array sides the steady shear layers downstream of the array outlined clearly the wake field see fig 6 the near wake field was identified to be where the two layers interacted downstream of the near wake field large scale shedding vortices commonly existed nicolle and eames 2011 at svf 0 034 the bleed flow was stronger and stable in forming a longer wake zone with increasing svf the closing distance of the near wake field decreased while the intense vortex shedding was generated quickly in the far wake field nicolle and eames 2011 the open channel flow can be simulated accurately using two dimensional shallow water equations when the bed slope is mild with no obstructions however the flow passing through the cylinders reveal distinct three dimensional characteristics fig 7 reveals the mean streamlines at different water depths at σ 0 05 i e 5 water depth to the surface the mean streamlines enclosed to form a clear near wake field for both svfs although with different lengths and widths at σ 0 5 i e 50 water depth to the surface there was no clear enclosure of the streamlines for the case of low svf for high svf the wake pattern was similar to that at σ 0 05 but with a greater length and smaller width at σ 0 95 i e 95 water depth to the surface the wake patterns were distinguished as two zones one was the separation flow from the two array sides that forms the near wake field and the other was the horseshoe type vortex induced flows outside the near wake field the horseshoe type vortex was generated in front of the array and was similar to those vortices in flows around a solid cylinder see fig 8 the flow structures differed distinctly for different svf values the near wake field was broader and shorter at higher svf values for both svf values the free surface and bottom bed suppressed the turbulent flows although the effects were distinct only in a limited water depth the flow through the cylindrical array was highly non uniform over the water depth which required a three dimensional numerical model rather than the two dimensional nsw the complicated vortices were generated by flows around and within the array of cylinders and developed downstream to form different wake flow patterns fig 9 reveals the mean streamwise vorticity in different cross sections perpendicular to the x axis because the mean flow structures are approximately symmetric only vortices in the left field are labelled in fig 9 and highlighted in details in general terms the vortices were approximately identical for both svf but were stronger at high svf the vortices consisted of the necklace type vortex nv labelled as v1 the shedding vortex sv labelled as v2 and the horseshoe type vortex hv labelled as v3 vortex v1 was generated by the distortion of the free surface underneath the free surface the vortex v2 were generated originally at the array sides and developed downstream approaching the bottom the vortex v2 was suppressed while vortex v3 was originally generated in front of the array and advected downstream from outside the array of cylinders in the near wake field i e at approximatelyx d 10 the vortex v1 staggered downstream and deviated from the symmetry line vortex v2 broke down into small patches downstream of the array vortex v3 was enlarged and the cores were shifted outwards beyond the near wake field all the vortices were gradually dissipated downstream for both svf the contours of the vortex present a distinct three dimensional vortex evolution around the array of cylinders 4 3 instantaneous flow analysis the mean flow gives an indication of the averaging process when complex vortices are presented however some important vortices cannot be captured by the averaging process while some flow structures do not really exist in the instantaneous flow fig 10 reveals an instantaneous snapshot of the free surface for different svf valuses at low svf a series of water whirlpools were formed separately from the two sides of the array and then advected downstream beyond a critical distance the water whirlpools were fully merged and dissipated resulting in statistical homogenous water level fluctuations at high svf no clear water whirlpools were generated downstream until a critical distance where the near wake field was defined beyond the near wake field a pair of bigger and alternating water whirlpools were generated and advected downstream thus resulting in a stable coherent structure i e large scale vortex shedding the complicated free surface patterns including the water whirlpool upwelling downdraft and ripples represented the turbulent coherent structures beneath the free surface fig 11 reveals an instantaneous snapshot of the vortical structures using the isovalue of criterion q i e the second invariant of the velocity gradient tensor which is flooded by the vorticity magnitude at low svf the vortices shed from individual cylinders were merged and dissipated quickly within the array in the near wake field the vorticity appeared to be organised into coherent lumps of positive and negative vorticities as seen in fig 11 a the local horseshoe type vortex was created in front of the array but was dissipated rapidly downstream within the cylindrical array classic shedding vortex was generated by each constituent cylinder see fig 11 b herein the typical reynolds number was 680 which was sufficiently low so that the discrete vortices were only evident in a narrow wake area at high svf the shedding vortex created by the constituent cylinders was suppressed and the vorticity signature did not survive as the flow passed through the array see fig 11 d the bleed flow decreased gradually through the array which annihilated the classic shedding vortex outside the cylindrical array the vorticity field was characterised by two intense and stable vortex sheets beyond the near wake field the sheets were unstable and von kármán vortex streets were formed see fig 11 c compared to the case of low svf a more intensive horseshoe type vortex system was created the dependence of the turbulent coherent structures on svf is analogous to the two dimensional flow that passes through the cylinders in accordance to the study conducted by nicolle and eames 2011 although the present study reveals distinct three dimensional flow structures besides the q map the instantaneous vorticity distribution was used to identify the turbulent flow around and within the array of cylinders figs 12 and 13 reveal the spatial evolution of the coherent structures using the instantaneous vorticity contours fig 12 shows an instantaneous snapshot of the streamwise vorticity downstream of the array where the vortical structures are similar to those shown in fig 9 the vortices also consisted of v1 v2 and v3 in a similar way to those in the mean flow field however in this case more abundant small scaled eddy structures appeared especially in the near wake field beyond a critical distance i e outside the near wake field a relative stable vortex street was formed with an enlarged scale compared to the results shown in fig 9 beyond the near wake field i e at approximately x d 10 the intensity of the instantaneous vortices was not distinctly reduced basically the time averaging results are similar to those obtained by rans model which is not able to capture small scale turbulence structures the time averaging process wiped away some important hydrodynamic contents in order to identify the turbulent coherent structures the present zdes model exhibits superior performance to rans type models the vertical variations of the instantaneous out of plane vorticities are shown in fig 13 at different water depths for low svf no intensive coherent structures were generated downstream of the array and the two vortex sheets were advected individually over a long distance as can be seen in fig 13 a and c at high svf beyond a shorter distance downstream the sheets were unstable and a von kármán vortex street was created as shown in fig 13 b and d when the svf increased the bleed flow through the array decreased and the stable distance of the two side vortex sheets became shorter compared to that shown in fig 6 the instantaneous vorticity map revealed more clearly the spatial turbulent flow structures figs 13 e and f reveal the instantaneous vorticities near the bottom bed where the solid bottom constrained the turbulent flows in a narrower and shorter wake field for both svf the turbulent flows induced by the hv were distinct with higher degree of complication at higher svf within the array of cylinders the vortices are affected mainly by the svf fig 14 reveals the out of plane vorticity at different water depths for two svf values for both svf the intensity of the vorticity decreased towards the bottom bed where the friction stress attenuated the turbulent energy at low svf the individual cylinders were sufficiently far apart such that the flow interactions were weak the vortex shedding from individual cylinders developed more fully through the array at high svf the vortices created by the individual cylinders were suppressed and stable shear flows were created the vortex shedding did not develop fully and were dissipated quickly through the array the vortex shedding direction deviated gradually from the x axis at different angular orientations as a function of the increasing svf the results coincided qualitatively with the numerical investigation of the two dimensional flow through cylinders conducted by nicolle and eames 2011 4 4 dynamic forces on cylinders because of the shelter effect from adjacent cylinders the dynamic forces on individual cylinders vary according to the fixed positions within the patch thus symbols cdi and cli were used to represent the drag and lift coefficients on an individual cylinder labelled as number i fig 15 shows the distribution of cdi at different svf where a clear visualisation of the drag force distribution is shown using colourful legends at low svf fig 15 a the turbulent flow energy was attenuated slowly over a long distance into the array which resulted in large drag coefficients the maximum cdi value appeared to be associated with the cylinders adjacent to the leading edge instead of the front cylinders which contributed to the bleed flow acceleration generated by the upstream cylinders however the bleed flows were weaker at large svf and the maximum drag forces did not appear on the cylinders behind the most upstream cylinders see fig 15 b fig 16 reveals clearly the distribution of the lift coefficient cli within the array of cylinders the lift coefficients at high svf were generally smaller than those at low svf which verified the fact that the vortex shedding was largely suppressed by the dense solid obstructions to investigate quantitatively the dynamic forces on one individual cylinder at different svf the temporal variations of the drag and lift coefficients were recorded for each cylinder the calculated mean forces revealed a distinct spatial distribution which was not uniform not only in the stream wise direction but also in the span wise direction the spatial characteristics of the forces are mainly affected by the patch geometry for each individual cylinder within the patch the hydrodynamic forces are dominated by the local vortex shedding separated flow from adjacent cylinders and the porous cylinder bulk effect although the intensity of each component of the total force was different the dynamic characteristics was similar the forces on the cylinder near the patch centre which is nearly symmetrical of the patch geometry was used to analyse the effect of svf on the hydrodynamic forces see fig 17 both the drag and lift coefficients were larger at low svf compared to the corresponding values at high svf which were consistent with the above analyses the approximate mean value of cdi of 0 7 was smaller than the corresponding value of an individual cylinder at the same reynolds number o 103 in the present analysis the undisturbed incident flow was used to normalise the dynamic forces on each cylinder i this selected characteristic velocity was generally larger than the actual flow velocity that passed the individual cylinders within the array because of the sheltering effect the coefficient cdi was generally larger at low svf than at high svf however the bulk drag coefficient cdg increased with svf fig 18 shows the temporal bulk drag coefficients for both svf where cdg was approximately equal to 1 2 at high svf and 1 0 at low svf nicolle et al 2011 suggested a detailed map of cdg for two dimensional flows through cylinders the present results were consistent with those results at approximately the same svf fig 18 shows that the lift coefficient clg increases when the svf decreases the comparisons of clg for low and high svf highlighted again the fact that the vortex shedding was suppressed when the solid volume fraction increased beyond a threshold value the spectral analysis is powerful since it decomposes the complicated signals into different characteristic constituents fig 19 reveals the frequency spectrum of the lift coefficients for the same individual cylinder as that noted in fig 17 and fig 18 the main peaks of the strouhal number stds were generally smaller than those of an individual cylinder with an approximate amplitude of 0 2 for both svf this was because the undisturbed upstream velocity was taken as the characteristic velocity rather than the local flow velocity the frequencies of both cli and clg were shifted towards zero at high svf compared to low svf the decreasing frequency indicated again that the vortex shedding was suppressed by dense obstructions in addition to the frequency distribution the decreasing peak amplitudes at high svf also verified the less intensive vortex shedding a low frequency i e stds 0 01 appeared clearly in the spectrum of clg at high svf see fig 19 as mentioned above a stable von kármán like vortex shedding was created distinctly beyond a critical distance at high svf which corresponded to the low frequent lift forces on the cylinders 5 conclusion the present work focussed on the accurate simulation of flows through a patch of emergent cylinders using detached eddy simulations it demonstrates the encouraging capability of the zdes approach for modelling vegetated flows the cylinders were directly simulated as solid bodies the numerical simulations provided insightful information about the turbulent flows around and inside the cylinder patch the analyses highlight the characteristics of the three dimensional vortical structures large scale wake field patterns and dynamic forces on cylinders the effects of the solid volume fraction on the turbulent flows are revealed by examining the mean and instantaneous turbulent flows the instantaneous vortex movement is the dominant mechanism driving mass transportation and drag force fluctuation the spatial evolution of vortices revealed distinct patterns over the water depth and downstream of the cylinder patch the coherent structures significantly depend on the patch geometry and the solid volume fraction the solid volume fraction greatly affects the flow field patterns within the cylinder patch which corresponds to the different ways in which the local vortices are strengthened or attenuated the spatial distribution of the hydrodynamic forces on individual cylinders is closely related to the characteristics of the turbulent flow through the cylinder array acknowledgements this work was jointly sponsored by the national nature science foundation no 11572196 and no 51479111 and the national basic research programme of china 973 programme no 2014cb046200 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 008 appendix supplementary materials image application 1 
713,the study carried out a numerical investigation of the open channel flow through a circular array of cylinders piercing the water surface unlike a lot of the previous research this study took into account the influence of the bed friction and free water surface a zonal detached eddy simulation zdes model was developed to simulate the turbulent free surface flow the non hydrostatic model was discretized using the finite volume method fvm within the patch each individual cylinder was directly modelled by specifying the no slip boundary condition at the solid surface the zdes model was verified to be able to capture the small scale turbulent coherent structures the instantaneous and average flow fields were analysed in detail with the aid of streamline visualization and vortex identifying technique q criterion the investigation shed light on the complex interaction between the free surface flow and the cylinder array arranged into a circular patch the complexity arises from the interplay among the separated flows from individual cylinders interference between adjacent cylinders and the bulk porous media effect of the patch the study highlighted the dependence of the flow characteristics on the key properties of the patch especially the solid volume fraction svf the work demonstrated the encouraging capability of the established numerical technique for the investigation of vegetated flows keywords vegetated flow zonal detached eddy simulation turbulent coherent structure cylinder patch non hydrostatic pressure notation the following symbols are used in this paper x spatial position in x direction y spatial position in y direction z spatial position in z direction σ the transformed coordinate in vertical direction φ solid volume fraction d total water depth h still water depth ζ water elevation d the distance to solid walls ds the constituent cylinder diameter dg the patch diameter d 0 the gap between two neighbour cylinders tvd total variation diminishing st strouhal number υ t eddy viscosity coefficient υ the auxiliary variable u friction velocity δ the nondimensional distance to the solid wall q the second invariant of the velocity gradient tensor ω i j the anti symmetric components of v sij the symmetric components of v cdes constant parameter cdi cdg drag force coefficient of individual cylinder and the array cdi cdg time averaged drag force coefficient of individual cylinder and the array cli clg lift force coefficient of individual cylinder and the array cli clg time averaged lift force coefficient of individual cylinder and the array 1 introduction aquatic vegetation plays a key role in providing a wide range of ecosystem services it provides various habitats for aquatic animals to efficiently promote bio diversity kemp et al 2000 by means of trapping solute mass and releasing oxygen vegetation helps improve water quality gacia and duarte 2001 cotton et al 2006 widdows et al 2008 in natural rivers aquatic vegetation affects flood routing by increasing flow resistance furthermore vegetation can significantly alter the turbulence characteristics of open channel flows which influence sediment erosion and deposition patterns and ultimately channel morphology bouma et al 2007 rominger et al 2010 the hydrodynamics of vegetated flow has generated considerable research interest zong and nepf 2011 nepf 2012 circular cylinders are often used to model rigid vegetation piercing the water surface because they offer a well defined representation of the stems the complicated turbulent flow induced by numerous cylinders with various bulk densities poses a great challenge to computational methods most experimental studies have mainly focused on characterizing the wake structure of the flows around porous obstructions zong and nepf 2011 these studies present quite a few limitations for example from a technical point of view it is extremely challenging to measure the drag on individual elements of the array and the flow field within the array the dense cylinders in the patch make it difficult to obtain a clear laser sheet for the particle image velocimetry piv measurement the local flow field immediately behind a cylinder is confined in a space that is often too small and tortuous for conventional probes to traverse through compared to physical experiments numerical simulations can reveal the flow pattern over the entire computational domain and across a wide range of frequencies in recent decades a lot of numerical modes have been proposed to investigate the flow through cylinders the porous model has become popular in numerical simulations of flow through vegetation gotoh et al 2004 li and yan 2007 cui and neary 2008 li and zeng 2009 li and zhang 2010 gao et al 2011 ma et al 2013 maza et al 2013 the porous model takes into account the effect of solid cylinders by means of extra drag force terms in the momentum equations the drag force to the flow is distributed over the computational cells occupied by the array of solid cylinders such an approach is incapable of capturing the coherent flow structures between the individual cylinders in the patch rather than using the simplified distributed drag force approach some models have relied on the wake to wake and wake to cylinder interactions within the cylinder arrays nezu and sanjou 2008 okamoto and nezu 2010 stoesser et al 2009 nicolle and eames 2011 chang and constantinescu 2015 kazemi et al 2017 wang et al 2018 compared to the rans model the les model is more advanced for predicting turbulent coherent structures which is accompanied by a significant increase in the computational cost the tremendous computational cost hinders the wide application of the les to vegetated flows that involve a wide range of spatial and temporal scales balancing the computational cost and efficiency the hybrid rans les model is arguably an ideal strategy for the simulation of a wide range of complex flows with high reynolds numbers li and yu 2010 proposed a hybrid rans les model to simulate the flow around vegetation patches where the bulk obstruction was modelled by introducing a drag force term into the momentum equations although the high resolution model was successful in modelling the bulk effect of the cylinder group and the wake flow such a model was unable to simulate the detailed turbulent coherent structures within the patch the current study aims to analyze the characteristics of the mean and instantaneous flow fields and the distribution of the drag and lift forces acting on the cylinders a zonal detached eddy simulation zdes is used to investigate the flow through and around a cylindrical array where the individual cylinders are explicitly modelled as solid objects the model stress depletion msd is one of the critical problems faced by the rans les hybrid model and is pronounced in the des when the model switches from the rans to les in the sub boundary layer spalart et al 2006 proposed a new version of des i e ddes which delays the switch over from rans to les although the msd issue is partially overcome the les content is not sufficient in the boundary layer because of the overuse of the rans mode shur et al 2008 introduced a refined model known as iddes for simulations with an ambiguous grid scale which can overcome the msd problem by modifying the turbulent length scale the initial condition and inflow condition because the msd issue comes from the insufficient velocity fluctuation when the model switches from the rans to les generation of fluctuations by the numerical method is a feasible way to stimulate the les content near the interface keating and piomelli 2006 presented a dynamic stochastic forcing method which significantly speeds up the transition and results in more accurate predictions of the velocity fluctuation compared to the numerical generation of fluctuation deck 2005 and deck et al 2011 proposed a zdes approach to avoid the msd in a different way this approach was more efficient and was implemented by modifying the parameters in the spalart allmaras sa turbulence model instead of calculating stochastic velocities breuer et al 2003 obtained an excellent agreement with the reference les solution when using zdes for simulations of massive separation flows around a flat plate to the best of the authors knowledge few studies have been reported on the application of the zdes to the free surface flow through arrays of cylinders which represent vegetation patches in environmental flows the in house code used in this study adopts a non hydrostatic model for simulating free surface flows and is highly efficient zhang et al 2014 the analysis focuses on the turbulent coherent structures within and around the array of cylinders the present work shows the suitability of the zdes model for modelling vegetated flow and highlights the sensitivity of the flow to the key properties of the vegetation patch the study is structured as follows in section 2 the numerical formulation and the case studies are described the numerical implementations are described in section 3 the simulation results are analysed and interpreted in section 4 the general conclusions are presented in section 5 2 numerical formulation 2 1 mathematical model the full hydrodynamic model is extended from the well known shallow water equations based on the hydrostatic assumption by means of the introduction of the non hydrostatic terms into the momentum equations casulli 1999 jankowski 1999 casulli and zanolli 2002 kocyigit et al 2002 fringer et al 2006 ma et al 2012 zhang et al 2014 the extended model greatly widens the applicability when the hydrostatic assumption being invalid to fit the free surface and the uneven bottom a σ coordinate transformation is adopted the transformation between the σ and z coordinates isσ z ζ h ζ where z 0is at the still water level swl in the computational domain σ 0refers to the free surface and σ 1refers to the bottom the governing equations are as follows 1 ζ t q x x q y y q σ σ 0 2 q x t q x u x q x v y q x ω σ g d ζ x d ρ 0 p n x x υ t q x x y υ t q x y 1 d σ υ t d q x σ 3 q y t q y u x q y v y q y ω σ g d ζ y d ρ 0 p n y x υ t q y x y υ t q y y 1 d σ υ t d q y σ 4 q z t q z u x q z v y q z ω σ 1 ρ 0 p n σ x υ t q z x y υ t q z y 1 d σ υ t d q z σ where q x d u q y d v q z d w q σ d ω u v w are the respective velocities in the x y and z directions ω is the vertical velocity in the σ coordinate framework d h ζ is the total water depth h is the still water depth ζ is the free surface elevation pn is the non hydrostatic pressure g is the gravitational acceleration υ is the molecular viscous coefficient and υ t is the eddy viscosity coefficient the velocity along the σ coordinate is calculated as 5 q σ q z d q x d σ d x ζ x q y d σ d y ζ y σ d t ζ t the eddy viscosity υ t is determined using the one equation spalart allmaras sa turbulence model in which the advection and diffusion equation for the auxiliary variable υ is given by 6 d υ t d υ u x d υ v y d υ ω σ d c b 1 s υ d c w 1 f w υ d 2 1 σ x υ t υ d υ x y υ t υ d υ y d σ υ t υ d υ d σ c b 2 σ d υ x 2 d υ y 2 d υ d σ 2 the eddy viscosity υ t is calculated from υ according to 7 υ t υ f v 1 where f v 1 χ 3 χ 3 c v 1 3 χ υ υ and υ is the molecular viscosity the function fw is calculated as f w g 1 c w 3 6 g 6 c w 3 6 1 6 withg r c w2 r 6 r r υ s κ 2 d 2 s s υ κ 2 d 2 f v 2 and f v 2 1 χ 1 χ f v 1 here s is the magnitude of the strain rate tensor calculated as s 2 ω i j ω i j with ω i j 1 2 u i x j u j x i the constants in the above equations arec b1 0 1355 σ 2 3 c b2 0 622 κ 0 41 c w 1 c b 1 κ 2 1 c b 2 σ c w2 0 3 c w3 2 0 and c v1 7 1 in the above eq 6 the length scale d in the destruction term is determined by the smaller value between the rans and les length scales 8 d min d c d e s δ where δ max 4 a π δ z a is the area of the horizontal grid cell for unstructured mesh 4 a π is the characteristic length in the horizontal discretisation δz is the vertical grid size the constant cdes 0 65 and d is the distance to the nearest solid wall in the present zdes model the above grid scale δ is calculated for use in formula 8 in the rans zone but it is calculated as the cube root of the cell volume δ a δ z 1 3 when switching to the les mode furthermore the values of fv1 fv2 and fw are specified as follows 9 f v 1 1 f v 2 0 f w 1 2 2 numerical scheme a predictor corrector scheme was used in the solution algorithm the flow driven by the hydrostatic pressure was first calculated in the predictor step and the flow driven by the non hydrostatic pressure was then updated in the corrector step the model can be easily switched to nonlinear shallow water equations when the corrector step is skipped the governing equations were discretised based on the finite volume method fvm the grid system consists of unstructured meshes in the horizontal plane and multi layers in the vertical direction a 2nd order total variation diminishing tvd scheme called the osher scheme was adopted to discretise the convective terms and a central difference scheme was used to discretise the diffusion terms in the corrector step the poisson type equation for the non hydrostatic pressure was numerically solved by a pre conditioned bi conjugate gradients stabilised method bi cgstab the in house codes hydroflow were paralleled using the openmp library zhang et al 2014 3 model implementation 3 1 geometry and mesh specification the array geometry used in experiments zong and nepf 2011 was chosen in this study the cylinder array consists of circular cylinders with the same diameter ds the diameter dg of the patch was considerably larger than the diameter of a constituent cylinder the solid volume fraction svf was varied via the variation of the number of cylinders in the array correspondingly the number of cylinders was calculated as nc φ dg ds 2 in which φis the svf value the cylinders were arranged in a staggered pattern with a uniform distribution in the patch the distance d0 between the two neighbouring cylinders was kept by placing the cylinders at the vertex of an equilateral triangle network and was varied according to the specified svf the parameters for each case study are listed in table 1 the domain geometry and local meshes are schematically shown in fig 1 the array is symmetrical about the central line of the channel the channel has a width of w 7dg which is equal to250ds while l 10dg and 40dg were chosen as the lengths upstream and downstream of the array respectively fixed flow rate was specified at the inlet and fixed water elevation was specified at the outlet at the bed and at the solid cylinders walls a no slip boundary condition was used the grid resolution needs to be designed in an elaborate manner for des the basic rans zone covers the near wall boundary layer and beyond a critical distance is the les zone a good choice of the critical transition height should be in the range of tens of nondimensional wall units z 1 where the most vigorous turbulent activity occurs pope 2000 in the case of zdes used in the present work which is based on the sa model the grid scale normalised by the wall unit was strictly limited to meet the condition δ o 1 at the first grids of the solid wall and was subsequently stretched at a ratio of 1 15 in regions away from the solid wall for open channel flows hinterberger 2004 proposed a valuable specification of grid size for the les where the grid size was properly designed in the range of 1 20 1 10 h with h as the still water depth within the array the mesh elements around the cylindrical surface have a characteristic length scale equal to 0 1ds in the region outside the array the mesh resolution varied from 0 1 h in the near wake field to 3 h in far wake field 3 2 diagnostics 3 2 1 flow diagnostics to analyse the flow characteristics the vorticity ω u was used to examine the rotational feature of the flows it is expected that small scale vortical structures are well predicted by the zdes model a positive isovalue of the criterion q denotes turbulent structures which are defined as the vortex tubes in the regions with the positive second invariant of the velocity gradient tensor 10 q 1 2 ω i j ω i j s i j s i j 1 2 u i x j u j x i 0 where sij and ω ij are the symmetric and anti symmetric components of v these measures have been adopted in many turbulent flow studies jeong and hussain 2006 3 2 2 force diagnostics the cylinders within the array are indexed with i where 1 i nc the total force on the cylinder i is calculated through the integration of the force over the water depth 11 f i h ζ 0 2 π p i i τ i n r i d θ d z where pi is the total pressure on the cylinder surface i is the identity matrix τ i is the friction stress on the solid surface ri is the radius of the cylinder i and n is the unit normal vector of the cylinder s surface the drag and lift coefficients are defined in terms of the undisturbed free stream velocity u 0 x and the projected area of a cylinder dsd 12 c d i t f i x 1 2 ρ d s d u 0 2 c l i t f i y 1 2 ρ d s d u 0 2 the time averaged drag coefficient for an individual cylinder over a period t from the initial time t0 is defined by 13 c d i 1 t t 0 t t 0 c d i d t the time averaged root mean square rms value of the lift coefficient of an individual cylinder is defined by 14 c l i r m s 1 t t 0 t t 0 c l i 2 d t the drag and lift coefficients of the cylinder array are defined as 15 c d g t i 1 n c f i x 1 2 ρ d g u 0 2 c l i t i 1 n c f i y 1 2 ρ d g u 0 2 the time averaged drag coefficient and the rms of the lift coefficient of the array are expressed as 16 c d g 1 t t 0 t t 0 c d g d t c l g r m s 1 t t 0 t t 0 c l g 2 d t for all the studied cases the model was first run to achieve a fully developed turbulent flow and then the information was continually recorded for a duration of 50dg u 0 or 1800ds u 0 the simulation was saved at a sampling frequency of 50 hz to capture the unsteady separated flow around individual cylinders assuming a strouhal number of 0 2 the characteristic periods of the vortex shedding induced by the cylinder s patch and by an individual cylinder are approximately equal to 5dg u 0 and 5ds u 0 respectively the data records were sufficient for identifying the characteristic frequency of the dynamic forces 4 results and discussion 4 1 model validation the numerical model was first validated against the experimental measurements conducted by zong and nepf 2011 in which the classical wake flow pattern downstream of the cylinder patch was quantitatively identified the experiment with a middle svf φ 0 1 was used to verify the numerical method and the simulation strategy the calculated mean velocities at the mid depth were extracted and compared with the measurements see fig 2 the simulation outcomes coincided well the measurements behind the patch the velocities decreased in the near wake field and recovered in the far wake field one prominent advantage of the numerical simulation is its powerful ability to provide abundant flow contents especially within the cylindrical array where the measurements are difficult to be conducted for numerical modelling it is important to design the mesh resolution depending on the characteristic flow scales the mesh resolution is required to be fine enough for modelling the boundary flow near the solid wall fig 3 shows the estimation of the mean non dimensional distance to the cylindrical surface i e δ n δ n u υ where u is the mean frictional velocity and δ n is the distance to the solid wall the above δ n value was calculated for the cylinder located in the most upstream position as the level of turbulent flow was more intensive than the downstream cylinders in the array fig 3 reveals that the first near wall grid points were located with δ n 3 which meets the requirement for the no slip boundary condition in addition to the mesh resolution in the boundary layer the interface region between the les and rans zones is critical for the zdes model the location of the zone interface around the most upstream cylinder varied in the range of δ n 10 30 4 2 mean flow analysis the wake flow field is classically divided into the near field l1 and the far field l2 the longitudinal profiles of u u 0 along the centreline at different svf are shown in fig 4 when the svf increased the length of the near wake field was shortened and the longitudinal velocity in the far field recovered much faster the minimum velocity u in the near field approached nearly zero at svf 0 104 which was analogous to the flow around a solid cylinder the high svf blocked the flow passing through the cylinders and induced strong flow separation from the shoulders of the patch to form a near wake zone in which the flow speed was smaller for both svf the maximum spanwise velocity appeared at the array sides but there were opposite velocities across the interface between the near and far wake fields for higher svf see fig 4 the rms values of the fluctuated spanwise velocities along the centre line are shown in fig 4 at low svfs vrms reached its maximum value within the array and decreased gradually downstream however the vrms reached a peak close to the interface between the near and far wake fields at higher svf at decreasing svf the streamwise velocities recovered slowly and resulted in a longer transitional length the near wake field recovered quickly at high svf this induced increased fluctuations of the spanwise velocity in addition to the velocity profiles in local domain the overview of the flow field provided a clear visualisation of the wake field structure figs 5 and 6 present the mean out of plane vorticity for both svf values within the cylindrical array see fig 5 two shear layers with positive and negative vorticities were generated adjacent to a single cylinder the intensity of the vorticity weakened at further downstream cylinders such a trend was much more visible at high svf at low svf because the shelter effect of the cylinders was too weak to exert a significant impact on the flow separation induced by a constituent cylinder the two shear layers remained nearly symmetrical throughout the array however the asymmetrical flow structures were distinct at high svf within the array especially close to the two array sides the steady shear layers downstream of the array outlined clearly the wake field see fig 6 the near wake field was identified to be where the two layers interacted downstream of the near wake field large scale shedding vortices commonly existed nicolle and eames 2011 at svf 0 034 the bleed flow was stronger and stable in forming a longer wake zone with increasing svf the closing distance of the near wake field decreased while the intense vortex shedding was generated quickly in the far wake field nicolle and eames 2011 the open channel flow can be simulated accurately using two dimensional shallow water equations when the bed slope is mild with no obstructions however the flow passing through the cylinders reveal distinct three dimensional characteristics fig 7 reveals the mean streamlines at different water depths at σ 0 05 i e 5 water depth to the surface the mean streamlines enclosed to form a clear near wake field for both svfs although with different lengths and widths at σ 0 5 i e 50 water depth to the surface there was no clear enclosure of the streamlines for the case of low svf for high svf the wake pattern was similar to that at σ 0 05 but with a greater length and smaller width at σ 0 95 i e 95 water depth to the surface the wake patterns were distinguished as two zones one was the separation flow from the two array sides that forms the near wake field and the other was the horseshoe type vortex induced flows outside the near wake field the horseshoe type vortex was generated in front of the array and was similar to those vortices in flows around a solid cylinder see fig 8 the flow structures differed distinctly for different svf values the near wake field was broader and shorter at higher svf values for both svf values the free surface and bottom bed suppressed the turbulent flows although the effects were distinct only in a limited water depth the flow through the cylindrical array was highly non uniform over the water depth which required a three dimensional numerical model rather than the two dimensional nsw the complicated vortices were generated by flows around and within the array of cylinders and developed downstream to form different wake flow patterns fig 9 reveals the mean streamwise vorticity in different cross sections perpendicular to the x axis because the mean flow structures are approximately symmetric only vortices in the left field are labelled in fig 9 and highlighted in details in general terms the vortices were approximately identical for both svf but were stronger at high svf the vortices consisted of the necklace type vortex nv labelled as v1 the shedding vortex sv labelled as v2 and the horseshoe type vortex hv labelled as v3 vortex v1 was generated by the distortion of the free surface underneath the free surface the vortex v2 were generated originally at the array sides and developed downstream approaching the bottom the vortex v2 was suppressed while vortex v3 was originally generated in front of the array and advected downstream from outside the array of cylinders in the near wake field i e at approximatelyx d 10 the vortex v1 staggered downstream and deviated from the symmetry line vortex v2 broke down into small patches downstream of the array vortex v3 was enlarged and the cores were shifted outwards beyond the near wake field all the vortices were gradually dissipated downstream for both svf the contours of the vortex present a distinct three dimensional vortex evolution around the array of cylinders 4 3 instantaneous flow analysis the mean flow gives an indication of the averaging process when complex vortices are presented however some important vortices cannot be captured by the averaging process while some flow structures do not really exist in the instantaneous flow fig 10 reveals an instantaneous snapshot of the free surface for different svf valuses at low svf a series of water whirlpools were formed separately from the two sides of the array and then advected downstream beyond a critical distance the water whirlpools were fully merged and dissipated resulting in statistical homogenous water level fluctuations at high svf no clear water whirlpools were generated downstream until a critical distance where the near wake field was defined beyond the near wake field a pair of bigger and alternating water whirlpools were generated and advected downstream thus resulting in a stable coherent structure i e large scale vortex shedding the complicated free surface patterns including the water whirlpool upwelling downdraft and ripples represented the turbulent coherent structures beneath the free surface fig 11 reveals an instantaneous snapshot of the vortical structures using the isovalue of criterion q i e the second invariant of the velocity gradient tensor which is flooded by the vorticity magnitude at low svf the vortices shed from individual cylinders were merged and dissipated quickly within the array in the near wake field the vorticity appeared to be organised into coherent lumps of positive and negative vorticities as seen in fig 11 a the local horseshoe type vortex was created in front of the array but was dissipated rapidly downstream within the cylindrical array classic shedding vortex was generated by each constituent cylinder see fig 11 b herein the typical reynolds number was 680 which was sufficiently low so that the discrete vortices were only evident in a narrow wake area at high svf the shedding vortex created by the constituent cylinders was suppressed and the vorticity signature did not survive as the flow passed through the array see fig 11 d the bleed flow decreased gradually through the array which annihilated the classic shedding vortex outside the cylindrical array the vorticity field was characterised by two intense and stable vortex sheets beyond the near wake field the sheets were unstable and von kármán vortex streets were formed see fig 11 c compared to the case of low svf a more intensive horseshoe type vortex system was created the dependence of the turbulent coherent structures on svf is analogous to the two dimensional flow that passes through the cylinders in accordance to the study conducted by nicolle and eames 2011 although the present study reveals distinct three dimensional flow structures besides the q map the instantaneous vorticity distribution was used to identify the turbulent flow around and within the array of cylinders figs 12 and 13 reveal the spatial evolution of the coherent structures using the instantaneous vorticity contours fig 12 shows an instantaneous snapshot of the streamwise vorticity downstream of the array where the vortical structures are similar to those shown in fig 9 the vortices also consisted of v1 v2 and v3 in a similar way to those in the mean flow field however in this case more abundant small scaled eddy structures appeared especially in the near wake field beyond a critical distance i e outside the near wake field a relative stable vortex street was formed with an enlarged scale compared to the results shown in fig 9 beyond the near wake field i e at approximately x d 10 the intensity of the instantaneous vortices was not distinctly reduced basically the time averaging results are similar to those obtained by rans model which is not able to capture small scale turbulence structures the time averaging process wiped away some important hydrodynamic contents in order to identify the turbulent coherent structures the present zdes model exhibits superior performance to rans type models the vertical variations of the instantaneous out of plane vorticities are shown in fig 13 at different water depths for low svf no intensive coherent structures were generated downstream of the array and the two vortex sheets were advected individually over a long distance as can be seen in fig 13 a and c at high svf beyond a shorter distance downstream the sheets were unstable and a von kármán vortex street was created as shown in fig 13 b and d when the svf increased the bleed flow through the array decreased and the stable distance of the two side vortex sheets became shorter compared to that shown in fig 6 the instantaneous vorticity map revealed more clearly the spatial turbulent flow structures figs 13 e and f reveal the instantaneous vorticities near the bottom bed where the solid bottom constrained the turbulent flows in a narrower and shorter wake field for both svf the turbulent flows induced by the hv were distinct with higher degree of complication at higher svf within the array of cylinders the vortices are affected mainly by the svf fig 14 reveals the out of plane vorticity at different water depths for two svf values for both svf the intensity of the vorticity decreased towards the bottom bed where the friction stress attenuated the turbulent energy at low svf the individual cylinders were sufficiently far apart such that the flow interactions were weak the vortex shedding from individual cylinders developed more fully through the array at high svf the vortices created by the individual cylinders were suppressed and stable shear flows were created the vortex shedding did not develop fully and were dissipated quickly through the array the vortex shedding direction deviated gradually from the x axis at different angular orientations as a function of the increasing svf the results coincided qualitatively with the numerical investigation of the two dimensional flow through cylinders conducted by nicolle and eames 2011 4 4 dynamic forces on cylinders because of the shelter effect from adjacent cylinders the dynamic forces on individual cylinders vary according to the fixed positions within the patch thus symbols cdi and cli were used to represent the drag and lift coefficients on an individual cylinder labelled as number i fig 15 shows the distribution of cdi at different svf where a clear visualisation of the drag force distribution is shown using colourful legends at low svf fig 15 a the turbulent flow energy was attenuated slowly over a long distance into the array which resulted in large drag coefficients the maximum cdi value appeared to be associated with the cylinders adjacent to the leading edge instead of the front cylinders which contributed to the bleed flow acceleration generated by the upstream cylinders however the bleed flows were weaker at large svf and the maximum drag forces did not appear on the cylinders behind the most upstream cylinders see fig 15 b fig 16 reveals clearly the distribution of the lift coefficient cli within the array of cylinders the lift coefficients at high svf were generally smaller than those at low svf which verified the fact that the vortex shedding was largely suppressed by the dense solid obstructions to investigate quantitatively the dynamic forces on one individual cylinder at different svf the temporal variations of the drag and lift coefficients were recorded for each cylinder the calculated mean forces revealed a distinct spatial distribution which was not uniform not only in the stream wise direction but also in the span wise direction the spatial characteristics of the forces are mainly affected by the patch geometry for each individual cylinder within the patch the hydrodynamic forces are dominated by the local vortex shedding separated flow from adjacent cylinders and the porous cylinder bulk effect although the intensity of each component of the total force was different the dynamic characteristics was similar the forces on the cylinder near the patch centre which is nearly symmetrical of the patch geometry was used to analyse the effect of svf on the hydrodynamic forces see fig 17 both the drag and lift coefficients were larger at low svf compared to the corresponding values at high svf which were consistent with the above analyses the approximate mean value of cdi of 0 7 was smaller than the corresponding value of an individual cylinder at the same reynolds number o 103 in the present analysis the undisturbed incident flow was used to normalise the dynamic forces on each cylinder i this selected characteristic velocity was generally larger than the actual flow velocity that passed the individual cylinders within the array because of the sheltering effect the coefficient cdi was generally larger at low svf than at high svf however the bulk drag coefficient cdg increased with svf fig 18 shows the temporal bulk drag coefficients for both svf where cdg was approximately equal to 1 2 at high svf and 1 0 at low svf nicolle et al 2011 suggested a detailed map of cdg for two dimensional flows through cylinders the present results were consistent with those results at approximately the same svf fig 18 shows that the lift coefficient clg increases when the svf decreases the comparisons of clg for low and high svf highlighted again the fact that the vortex shedding was suppressed when the solid volume fraction increased beyond a threshold value the spectral analysis is powerful since it decomposes the complicated signals into different characteristic constituents fig 19 reveals the frequency spectrum of the lift coefficients for the same individual cylinder as that noted in fig 17 and fig 18 the main peaks of the strouhal number stds were generally smaller than those of an individual cylinder with an approximate amplitude of 0 2 for both svf this was because the undisturbed upstream velocity was taken as the characteristic velocity rather than the local flow velocity the frequencies of both cli and clg were shifted towards zero at high svf compared to low svf the decreasing frequency indicated again that the vortex shedding was suppressed by dense obstructions in addition to the frequency distribution the decreasing peak amplitudes at high svf also verified the less intensive vortex shedding a low frequency i e stds 0 01 appeared clearly in the spectrum of clg at high svf see fig 19 as mentioned above a stable von kármán like vortex shedding was created distinctly beyond a critical distance at high svf which corresponded to the low frequent lift forces on the cylinders 5 conclusion the present work focussed on the accurate simulation of flows through a patch of emergent cylinders using detached eddy simulations it demonstrates the encouraging capability of the zdes approach for modelling vegetated flows the cylinders were directly simulated as solid bodies the numerical simulations provided insightful information about the turbulent flows around and inside the cylinder patch the analyses highlight the characteristics of the three dimensional vortical structures large scale wake field patterns and dynamic forces on cylinders the effects of the solid volume fraction on the turbulent flows are revealed by examining the mean and instantaneous turbulent flows the instantaneous vortex movement is the dominant mechanism driving mass transportation and drag force fluctuation the spatial evolution of vortices revealed distinct patterns over the water depth and downstream of the cylinder patch the coherent structures significantly depend on the patch geometry and the solid volume fraction the solid volume fraction greatly affects the flow field patterns within the cylinder patch which corresponds to the different ways in which the local vortices are strengthened or attenuated the spatial distribution of the hydrodynamic forces on individual cylinders is closely related to the characteristics of the turbulent flow through the cylinder array acknowledgements this work was jointly sponsored by the national nature science foundation no 11572196 and no 51479111 and the national basic research programme of china 973 programme no 2014cb046200 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 008 appendix supplementary materials image application 1 
714,geostatistical inverse modeling problems can potentially be very high dimensional and computationally expensive using the random mixing approach the dimensionality can be reduced and any optimization algorithm can be applied to solve the inverse problem in this lower dimensional space in order to reduce computational costs the standard optimization is replaced by a sequence of one dimensional optimizations in this one dimensional space a simplified calculation of the objective function using whittaker shannon interpolation is carried out this procedure requires a significantly reduced number of forward model runs and it also guarantees monotonic convergence of the objective function a synthetic and a real world example will be used to demonstrate the procedure and to evaluate the quality of the whittaker shannon interpolation in comparison to the actual objective functions keywords geostatistical simulation random mixing inverse modeling whittaker shannon interpolation groundwater 1 introduction groundwater flow modeling is an important aquifer management tool the forward problem is usually well specified for a given input variety of parameters such as hydraulic conductivity sources and sinks storativity etc we can calculate the model results model state observations in practice however most input parameters are known at a few selected locations only which makes it impossible to fully characterize the model therefore inverse modeling is a valuable tool to improve model characterization by identifying input parameters from model state observations if some of the model parameters exhibit spatial heterogeneity geostatistical inversion methods which are able to treat the parameters as regionalized variables are one possibility to approach the inverse problem a great number of different methods ranging from manual model calibration to sophisticated numerical procedures have been developed during the last decades a comprehensive review of several inverse modeling methods is given in zhou et al 2014 and a comparison of different methods can be found in hendricks franssen et al 2009 a main hurdle for most inverse problems is computational demand many inverse modeling approaches are iterative i e the actual forward model has to be run multiple times depending on the complexity of the forward model this can result in enormous computational cost in the case of stochastic inverse modeling computational demand also grows with the number of required realizations some approaches to reduce computational demand are available in literature scheidt and caers 2008 for example proposed a kernel based technique which reduces the size of the ensemble by preselection of representative realizations xu et al 2013 use a parallelized ensemble kalman filter that uses parallelization in the forecast step as well as in the analysis step a coupled ensemble kalman filtering and upscaling approach is presented in li et al 2012 the authors perform upscaling prior to the forward simulation in order to reduce computational cost in pau et al 2013 surrogate models are used to reduce the number of unknowns that have to be computed lee and kitanidis 2014 use a matrix free version of the principal component geostatistical approach for large scale geostatistical inversions they reduce the number of forward model runs by avoiding the direct evaluation of the jacobian matrix in this paper an approach to reduce computational cost for inverse modeling is presented the method uses a modified version of random mixing bárdossy and hörning 2016a 2016b hörning 2016 which is a geostatistical simulation technique that represents an extension to the gradual deformation approach hu 2000 2002 hu et al 2001 it uses spatial copulas bárdossy 2006 bárdossy and li 2008 as spatial random functions and enables incorporation of a wide range of conditioning constraints amongst these constraints are also non linear constraints making it suitable for inverse problems random mixing is a monte carlo approach which uses linear combinations of independent spatial random fields to generate conditional fields which match predefined constraints in general this is done by changing the weights of the linear combinations the new algorithm presented in this paper reduces computational cost of the random mixing approach for inverse modeling by reducing the number of forward model runs this is achieved by reducing the dimensionality of the inverse problem splitting the objective function into single components and approximating these objective function components using whittaker shannon interpolation shannon 1948 whittaker 1915 the paper is divided in five sections after the general introduction the problem statement is presented the third section describes the methodology which represents an extension to the random mixing algorithm in the fourth section two examples are presented and the results of the novel algorithm are compared to results achieved using the original random mixing procedure the paper ends with discussions and conclusions 2 the problem the goal is to find a field z x with x d such that 1 the observations of z should be honoured 1 z x j z j ϵ j for j 1 j where ϵ j denotes a possible measurement error 2 the non linear relationships should also be honoured 2 h i z h i for i 1 i where hi s are non linear functions of the field z note that it is not a simple transformation of a single z value to an h value hi could for example correspond to the value of a solution of a partial differential equation using the field z as input or state variable 3 the spatial variability i e the spatial dependence in terms of the spatial covariance of the field z should match the observed spatial variability 4 the marginal distribution of z should not significantly differ from the marginal of the observations if i 0 then this is the usual geostatistical simulation problem under special circumstances j 0 is also possible in this case only non linear information related to z is observed 3 methodology in order to simplify the problem the marginal distribution of the original field z is transformed to normal we assume that the marginal distribution of z x is known either from literature values or fitted to the available data and it is denoted g z note that g z can be either parametric or non parametric thus by applying 3 φ 1 g z x w x at each point x where φ 1 denotes the inverse standard normal distribution results in a field w x with standard normal marginal distribution for the direct observations according to eq 1 this transformation means 4 w x j φ 1 g z x j φ 1 g z j w j we assume that the w field is normal this means that its spatial dependence is described by the normal copula with correlation matrix γc in general copulas are multivariate distributions defined on the unit hypercube with uniform univariate marginals they are used to describe the dependence between random variables independently of their marginal distributions the normal copula can be derived from a multivariate standard normal distribution see bárdossy and hörning 2016a for details and it enables modeling a gaussian spatial dependence structure with arbitrary marginal distribution note that its correlation matrix γc is assumed to be known it can be either assessed from the available observations bárdossy and li 2008 or taken from literature values the first task is to generate a field w 0 which fulfills the linear conditions given in eq 1 there are many different methods to perform this task here a method based on linear combinations of random fields according to the random mixing procedure presented in bárdossy and hörning 2016a b is selected we write w 0 as a sum of independent fields vl all standard normal with covariance matrix γ 5 w 0 l 1 l α l v l such fields vl can be simulated very efficiently using for example fast fourier transformation for regular grids as described in dietrich and newsam 1996 or the spectral representation method shinozuka and deodatis 1991 1996 note that due to the standard normal properties of the fields vl the covariance matrix γ and the correlation matrix γc are the same in order to fulfill the conditions given in eq 1 taking l j one first solves the problem 6 l 1 l α l v l x j w j for j 1 j singular value decomposition golub and kahan 1965 can be used for this purpose leading to a solution for which the l 2 norm of the weight vector α 1 α l is minimal 7 a α l 2 m i n if this minimum is a 1 the resulting field is denoted as w 8 w l 1 l α l v l where α l denote the weights that fulfill a 1 if a 1 the number of fields l is increased and eq 6 is solved again until a solution with a 1 is found note that the field w fulfills the conditions given in eq 1 but it is a low variance field thus the required spatial variability in terms of the covariance is not honored in order to repair the covariance we create additional fields 9 u t s 1 s β s t v s t with s j 1 using independent standard normal fields v s t again all with covariance matrix γ in order to avoid modifying the values at the observation locations the conditions 10 u t x j 0 are imposed this can be done the same way as creating w note that eq 10 implies that there is no measurement error ϵ j 0 the advantage of these fields is that they form a vector space i e they are closed for multiplication and addition thus using a simple multiplier one can find β s t s such that 11 β s t 2 1 a now for any t 12 w w u t defines a field that fulfills all direct constraints imposed on w and has the correct covariance matrix γ transforming w by z g 1 φ w where φ denotes the standard normal distribution and g 1 is the inverse marginal distribution defines a field which fulfills all direct constraints imposed on z if measurement errors in the direct observations are to be considered i e ϵ j 0 the fields ut need to be generated with s j this means that the equation system has less unknowns than observations solving this equation system using singular value decomposition can be seen as a least squares minimizing solution of eq 10 mandel 1982 differences in the measurement errors and the effect of different supports of the model and the measurements can be taken into account in this step by introducing an appropriate weighted error covariance matrix the second task is to generate the field w such that it also fulfills the non linear conditions given in eq 2 this is done by modifying the field ut the corresponding procedure is described in the following 1 the counter t is set to 1 2 a first candidate field 13 w t w u t is defined by taking a random ut generated as described above 3 the corresponding z field is created as z t g 1 φ w t 4 the non linear constraints hi zt are calculated using the forward model 5 the objective function o is calculated as 14 o i 1 i h i z t h i 2 6 if the objective function is less than a predefined threshold ε then the procedure is finished and zt is a simulated solution of the problem 7 otherwise an additional random field us with u s x j 0 is generated the same way as ut note that the fields us and ut are independent and that they exhibit the same spatial covariance 8 the new field us is combined with ut using a linear combination of the form 15 u θ m cos θ m u t sin θ m u s m 1 m with 16 θ m 2 π m 1 m m 1 m note that the weights of the linear combination cos θm sin θm are points equidistantly distributed on the unit circle further cos θm and sin θm ensure that the variance of the linear combination is unchanged as cos 2 θ m sin 2 θ m 1 this means that the resulting field u θm shares the same covariance as us and ut feller 1968 furthermore u θ m x j 0 thus z m g 1 φ w u θ m is a solution of the linearly constrained problem i e zm exhibits the correct spatial covariance and it honours the observations z m x j z j 9 for a given m all m fields z m g 1 φ w u θ m are constructed and the forward model is run on each of them from the solution of the forward runs the values of the non linear constraints hi zm are extracted and set to mi θm the goal is to derive the values of hi for all possible values of θ without having to run the forward model but through interpolation note the larger the number m the better the interpolation will be but the longer the running time as m defines the number of forward model runs 10 the values of the non linear constraints mi θm obtained in step 9 are interpolated for any θ 0 2π using whittaker 1915 and shannon 1948 interpolation or sinc interpolation 17 m i θ d m θ m i θ m where d m θ k 0 m 1 sin θ θ m k π θ θ m k π denote the interpolation weights note that the hydraulic heads are a continuous function of the hydraulic conductivities thus the heads are also a continuous function of the angle θ this continuity allows interpolating the hydraulic heads i e the non linear constraints as a function of θ the whittaker shannon interpolation profits from the fact that m i θ is periodic with period 2π 11 based on the interpolation in step 10 the approximate objective function o is calculated for any θ as 18 o θ i 1 i m i θ h i 2 note that this step is computationally very fast thus an approximation of each non linear condition and of the overall objective function can be calculated very quickly 12 the θ minimizing o θ is identified as θ 13 the actual objective function corresponding to 19 w t w cos θ u t sin θ u s is calculated using the forward model 14 if this objective function value is lower than the starting value corresponding to w t w u t then u t 1 cos θ u t sin θ u s else u t 1 u t the counter t is increased by 1 and the procedure continues at step 6 note that this procedure uses an interpolation for each non linear condition separately eq 17 the calculation of the overall objective function for the selected θm values and the subsequent interpolation of o θm represents an inferior possibility it is also worth mentioning that the computational cost of generating a large number of fields vl and ut and solving the equation systems is very low usually less than 1 of a forward model run further the described approach allows easy parallelization as the m forward model runs are independent the above procedure can also be modified to consider error covariances in the modeled data by taking o h i z h i t c h i z h i as part of the objective function the problem of model errors however is not explicitly handled in this paper the above algorithm generates a sequence of fields with monotonically decreasing objective function values thus the algorithm makes the impression to be greedy but in fact it is not in each step an independent random field us is generated and for the angle θ 1 2 π this field is considered as candidate in the algorithm as the sequence of independent random fields assures a convergence with probability 1 to the optimum rubinstein 1981 our approach will also converge with probability 1 the main difference to a pure monte carlo approach is that the above algorithm takes advantage of the fast calculation of many inbetween candidate fields 4 examples two examples are used to demonstrate the procedure the first example is based on the well studied synthetic test case for inverse groundwater modeling described in hendricks franssen et al 2009 which has also been used in bárdossy and hörning 2016a the second example is a real world inverse groundwater modeling problem in the lockyer valley in south east queensland australia sreekanth et al 2015 here random mixing was used to calibrate an alluvial aquifer system groundwater model to hydraulic head observations 4 1 synthetic test case as stated above the synthetic test case was originally presented in hendricks franssen et al 2009 where the authors compared seven methods for the inverse modeling of groundwater flow in the following a general description of the example is provided the accuracy of the proposed technique is evaluated and the computational cost is compared to the original random mixing approach presented in bárdossy and hörning 2016a where the inverse problem is solved in a higher dimensional space as opposed to a sequence of one dimensional optimizations 4 1 1 general description in the synthetical test cases hydraulic transmissivity is considered as an under sampled parameter the spatial distribution of the transmissivities is assumed to be the only unknown all other parameters are assumed to be known fig 1 shows the general flow set up the reference hydraulic transmissivity field and the reference hydraulic head field the domain length is 4900 m in the x direction and 5000 m in the y direction discretized into 49 50 grid cells the upper and lower boundaries share no flow conditions while the left and right boundaries have prescribed heads of 0 m and 5 m respectively the aquifer is unconfined with constant transmissivity a pumping well located at 1900 m 2350 m pumps steadily with a flow rate of 0 0578 m3 s and an uniform recharge rate of 362 912 mm y is predefined all over the domain the log transmissivity has a mean log 10 t of 2 932 and a log 10 t variance of 0 189 log 10 m2 s an exponential variogram without nugget effect and an effective range of 500 m is assumed both reference fields transmissivity and head are sampled at 25 locations resulting in two sets of conditioning data the forward model used to solve the flow equations is hydrogeosphere therrien and sudicky 1996 4 1 2 accuracy evaluation and computational cost in order to evaluate the accuracy of the proposed procedure the interpolated single hydraulic heads are compared to the precise single hydraulic heads for the first iteration of the algorithm m 7 is selected step 9 i e seven combinations of random fields according to eq 15 are used to simulate conditional transmissivity fields these simulated fields are subsequently applied as input for the forward flow model fig 2 shows the resulting head fields with their corresponding transmissivity fields as functions of θm for the first iteration of the algorithm based on these fields the values of m i θ m for i 1 25 are known at m 7 equidistant θm values these 25 sets of hydraulic head values are then refined using eq 17 such that there is an interpolated value for each degree between 0 and 2π for comparison reasons the forward model is evaluated for each degree in order to obtain the accurate hydraulic head values fig 3 shows the interpolated hydraulic head values and the precise hydraulic head values for each of the 25 observation locations for the first iteration of the inversion it can be seen that the interpolated values approximate the actual values very accurately minor deviations can only be observed at three locations fig 4 shows two realizations of conditional hydraulic log transmissivity fields with its corresponding hydraulic head fields further the figure contains the mean conditional hydraulic log transmissivity field as well as the mean conditional hydraulic head field these are the mean fields over 100 simulated conditional realizations compared to the results achieved using the approach presented in bárdossy and hörning 2016a the proposed approach requires between 50 90 less forward model runs to achieve comparable root mean squared error results of 0 9 m for the mean hydraulic head field and 0 31 log 10 m2 s for the mean hydraulic transmissivity field fig 5 shows the objective function values relative to the number of forward model runs for the traditional random mixing approach and the approach using whittaker shannon interpolation for two randomly selected realizations note that for each optimization both approaches use the same random fields in order to ensure comparability it can be seen that the approach using whittaker shannon interpolation shows a faster convergence than the traditional random mixing thus less forward model runs are required 4 2 real world test case lockyer valley in the following a brief introduction to the lockyer valley case study sreekanth et al 2015 is given followed by a description of the utilized groundwater model as in the synthetic test case an accuracy evaluation is carried out and computational cost is compared 4 2 1 case study this section reports the evaluation of the applicability of the proposed method in a regional scale groundwater modeling context the method was used to solve the inverse modeling problem of calibrating a groundwater model to hydraulic head observations a numerical groundwater flow model developed for the lockyer valley alluvial aquifer system in australia is used for this purpose the lockyer valley is a major sub catchment of catchment of the brisbane river and covers an areas of around 2900 km2 and forms approximately 20 of the brisbane river catchment the lockyer creek is an ephemeral drainage system and the stream and associated alluvium are the main source for irrigation water supply in the lockyer valley the lockyer valley is a major vegetable and grain producing area supported by groundwater irrigation from alluvial aquifers groundwater use is only regulated within localized areas within the valley and it has been estimated that there is considerable over extraction of water from the alluvial groundwater sources the alluvial deposits occur all along the drainage system and are commonly several kilometers wide and up to 35 m thick these deposits consist of well graded gravel sand silt and clay and are derived primarily from the weathering of basalt sandstone and shale owing to this there is large variability in the spatial hydraulic properties of the aquifer with a lnk variance of σ l n k 2 5 96 4 2 2 the groundwater model the groundwater model was built using modflow harbaugh 2005 harbaugh et al 2017 the main components of the water balance simulated by the model include diffuse recharge stream recharge and groundwater pumping the diffuse recharge was specified as an input boundary condition using estimated values from soil water balance data for various crop types present in the region the stream network is represented in the model using the modflow river package the dynamic exchange of surface water groundwater interactions is simulated by the model controlled by the time series of river stage that is input into the model as a boundary condition the groundwater model grid covers an area of 30 000 ha the numerical model grid was discretized into uniform cells of 250 m 250 m the model comprises of 4806 active grid cells all of equal size in a single layer hydraulic conductivity is considered as an under sampled parameter and the spatial distribution is informed by a handful of measurements from selected locations in the region the spatial distribution of hydraulic conductivity is assumed to be the only unknown all other spatial parameters that underpin the model including specific yield are assumed to be known an exponential variogram with an effective range of 2500 m and 30 nugget effect is assumed the objective of the inverse modeling is to estimate the spatial distribution of the hydraulic conductivity field subject to the non linear constraints imposed by observed water level measurements groundwater level observations from 355 locations over a 20 year period were used in the inverse modeling resulting in 64 960 non linear constraints fig 6 shows the location and estimated values of 43 hydraulic conductivity measurements from pumping tests these estimates were used as linear constraints according to eq 1 4 2 3 accuracy evaluation and computational cost as in the synthetic test case the accuracy of the proposed procedure is evaluated again the interpolated single hydraulic heads are compared to the accurate single hydraulic heads for the first iteration of the inversion m 7 is selected step 9 i e seven combinations of random fields according to eq 15 are used to simulate conditional hydraulic conductivity fields these simulated fields are subsequently applied as input for modflow based on these fields the values of m i θ m for i 1 64960 are known at m 7 equidistant θm values for demonstration purposes 25 out of these 64960 are randomly selected these 25 sets of hydraulic head values are again refined using eq 17 such that there is an interpolated value for each degree between 0 and 2π to obtain the precise hydraulic head values modflow is evaluated for each degree fig 7 shows the interpolated hydraulic head values and the precise hydraulic head values it can be seen that the interpolated hydraulic head values approximate the actual values reasonably but the quality of the interpolation however is not as good as in the synthetic test case a possible explanation for this could be the much higher complexity of the lockyer valley groundwater model compared to the synthetic model it is also worth mentioning that the quality of the interpolation can be improved by increasing m step 9 of the algorithm in sreekanth et al 2015 the authors used pilot points de marsily 1978 to solve the inverse problem to achieve a rmse of 4 54 m for the modeled hydraulic heads they required 8792 forward model runs note that they only obtained a single realization but not multiple realizations using the proposed technique 20 realizations are generated their rmse range between 4 3 m 4 58 m each realization was obtained after 1050 forward model runs this means that a single realization can be obtained in 12 of the computational time required by sreekanth et al 2015 fig 8 shows a comparison of simulated hydraulic heads to observed hydraulic heads for six randomly selected well locations note that increasing the overall number of optimizations would typically lead to better results this however was not envisaged in this example as several other factors contribute to the misfit that can also be observed in fig 8 these include for example structural errors in the modflow model and previously estimated input variables as described in sreekanth et al 2015 5 discussion and conclusions in this paper a technique to reduce computational cost in the random mixing approach for inverse modeling is presented it takes advantage of properties that are specific to random mixing which allow the standard optimization to be replaced by a sequence of one dimensional optimizations this means that only two spatial random fields will be mixed at a time in this one dimensional space the single components of the objective function can be approximated using a simple whittaker shannon interpolation on a unit circle this interpolation leads to a reduction in computational cost as only a few known data points outputs from the forward model are required the minimum of the interpolated overall objective function is determined and the corresponding random field is calculated where the coordinates of the minimum on the unit circle represent the weights then the algorithm continues with the next one dimensional optimization where the previously calculated field will be used in conjunction with another random field this guarantees a monotonic convergence of the objective function the presented examples show that the whittaker shannon interpolation is able to approximate the actual objective function very accurately even the complex lockyer valley case study shows a reasonably good match the overall results are very promising for the synthetic test case they show a reduction in computational cost up to 90 while achieving comparable results to the traditional approach for the lockyer valley example computational cost could be reduced by 88 compared to the pilot points method applied previously acknowledgements research for this paper was partly supported by the german research foundation deutsche forschungsgemeinschaft projektnummer 403207337 ba 1150 24 1 and partly by the energi simulation program the authors would also like to thank the university of queensland centre for coal seam gas and its industry members aplng arrow energy santos and shell qgc for providing research funding all data and all results can be requested via email s hoerning uq edu au supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 012 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
714,geostatistical inverse modeling problems can potentially be very high dimensional and computationally expensive using the random mixing approach the dimensionality can be reduced and any optimization algorithm can be applied to solve the inverse problem in this lower dimensional space in order to reduce computational costs the standard optimization is replaced by a sequence of one dimensional optimizations in this one dimensional space a simplified calculation of the objective function using whittaker shannon interpolation is carried out this procedure requires a significantly reduced number of forward model runs and it also guarantees monotonic convergence of the objective function a synthetic and a real world example will be used to demonstrate the procedure and to evaluate the quality of the whittaker shannon interpolation in comparison to the actual objective functions keywords geostatistical simulation random mixing inverse modeling whittaker shannon interpolation groundwater 1 introduction groundwater flow modeling is an important aquifer management tool the forward problem is usually well specified for a given input variety of parameters such as hydraulic conductivity sources and sinks storativity etc we can calculate the model results model state observations in practice however most input parameters are known at a few selected locations only which makes it impossible to fully characterize the model therefore inverse modeling is a valuable tool to improve model characterization by identifying input parameters from model state observations if some of the model parameters exhibit spatial heterogeneity geostatistical inversion methods which are able to treat the parameters as regionalized variables are one possibility to approach the inverse problem a great number of different methods ranging from manual model calibration to sophisticated numerical procedures have been developed during the last decades a comprehensive review of several inverse modeling methods is given in zhou et al 2014 and a comparison of different methods can be found in hendricks franssen et al 2009 a main hurdle for most inverse problems is computational demand many inverse modeling approaches are iterative i e the actual forward model has to be run multiple times depending on the complexity of the forward model this can result in enormous computational cost in the case of stochastic inverse modeling computational demand also grows with the number of required realizations some approaches to reduce computational demand are available in literature scheidt and caers 2008 for example proposed a kernel based technique which reduces the size of the ensemble by preselection of representative realizations xu et al 2013 use a parallelized ensemble kalman filter that uses parallelization in the forecast step as well as in the analysis step a coupled ensemble kalman filtering and upscaling approach is presented in li et al 2012 the authors perform upscaling prior to the forward simulation in order to reduce computational cost in pau et al 2013 surrogate models are used to reduce the number of unknowns that have to be computed lee and kitanidis 2014 use a matrix free version of the principal component geostatistical approach for large scale geostatistical inversions they reduce the number of forward model runs by avoiding the direct evaluation of the jacobian matrix in this paper an approach to reduce computational cost for inverse modeling is presented the method uses a modified version of random mixing bárdossy and hörning 2016a 2016b hörning 2016 which is a geostatistical simulation technique that represents an extension to the gradual deformation approach hu 2000 2002 hu et al 2001 it uses spatial copulas bárdossy 2006 bárdossy and li 2008 as spatial random functions and enables incorporation of a wide range of conditioning constraints amongst these constraints are also non linear constraints making it suitable for inverse problems random mixing is a monte carlo approach which uses linear combinations of independent spatial random fields to generate conditional fields which match predefined constraints in general this is done by changing the weights of the linear combinations the new algorithm presented in this paper reduces computational cost of the random mixing approach for inverse modeling by reducing the number of forward model runs this is achieved by reducing the dimensionality of the inverse problem splitting the objective function into single components and approximating these objective function components using whittaker shannon interpolation shannon 1948 whittaker 1915 the paper is divided in five sections after the general introduction the problem statement is presented the third section describes the methodology which represents an extension to the random mixing algorithm in the fourth section two examples are presented and the results of the novel algorithm are compared to results achieved using the original random mixing procedure the paper ends with discussions and conclusions 2 the problem the goal is to find a field z x with x d such that 1 the observations of z should be honoured 1 z x j z j ϵ j for j 1 j where ϵ j denotes a possible measurement error 2 the non linear relationships should also be honoured 2 h i z h i for i 1 i where hi s are non linear functions of the field z note that it is not a simple transformation of a single z value to an h value hi could for example correspond to the value of a solution of a partial differential equation using the field z as input or state variable 3 the spatial variability i e the spatial dependence in terms of the spatial covariance of the field z should match the observed spatial variability 4 the marginal distribution of z should not significantly differ from the marginal of the observations if i 0 then this is the usual geostatistical simulation problem under special circumstances j 0 is also possible in this case only non linear information related to z is observed 3 methodology in order to simplify the problem the marginal distribution of the original field z is transformed to normal we assume that the marginal distribution of z x is known either from literature values or fitted to the available data and it is denoted g z note that g z can be either parametric or non parametric thus by applying 3 φ 1 g z x w x at each point x where φ 1 denotes the inverse standard normal distribution results in a field w x with standard normal marginal distribution for the direct observations according to eq 1 this transformation means 4 w x j φ 1 g z x j φ 1 g z j w j we assume that the w field is normal this means that its spatial dependence is described by the normal copula with correlation matrix γc in general copulas are multivariate distributions defined on the unit hypercube with uniform univariate marginals they are used to describe the dependence between random variables independently of their marginal distributions the normal copula can be derived from a multivariate standard normal distribution see bárdossy and hörning 2016a for details and it enables modeling a gaussian spatial dependence structure with arbitrary marginal distribution note that its correlation matrix γc is assumed to be known it can be either assessed from the available observations bárdossy and li 2008 or taken from literature values the first task is to generate a field w 0 which fulfills the linear conditions given in eq 1 there are many different methods to perform this task here a method based on linear combinations of random fields according to the random mixing procedure presented in bárdossy and hörning 2016a b is selected we write w 0 as a sum of independent fields vl all standard normal with covariance matrix γ 5 w 0 l 1 l α l v l such fields vl can be simulated very efficiently using for example fast fourier transformation for regular grids as described in dietrich and newsam 1996 or the spectral representation method shinozuka and deodatis 1991 1996 note that due to the standard normal properties of the fields vl the covariance matrix γ and the correlation matrix γc are the same in order to fulfill the conditions given in eq 1 taking l j one first solves the problem 6 l 1 l α l v l x j w j for j 1 j singular value decomposition golub and kahan 1965 can be used for this purpose leading to a solution for which the l 2 norm of the weight vector α 1 α l is minimal 7 a α l 2 m i n if this minimum is a 1 the resulting field is denoted as w 8 w l 1 l α l v l where α l denote the weights that fulfill a 1 if a 1 the number of fields l is increased and eq 6 is solved again until a solution with a 1 is found note that the field w fulfills the conditions given in eq 1 but it is a low variance field thus the required spatial variability in terms of the covariance is not honored in order to repair the covariance we create additional fields 9 u t s 1 s β s t v s t with s j 1 using independent standard normal fields v s t again all with covariance matrix γ in order to avoid modifying the values at the observation locations the conditions 10 u t x j 0 are imposed this can be done the same way as creating w note that eq 10 implies that there is no measurement error ϵ j 0 the advantage of these fields is that they form a vector space i e they are closed for multiplication and addition thus using a simple multiplier one can find β s t s such that 11 β s t 2 1 a now for any t 12 w w u t defines a field that fulfills all direct constraints imposed on w and has the correct covariance matrix γ transforming w by z g 1 φ w where φ denotes the standard normal distribution and g 1 is the inverse marginal distribution defines a field which fulfills all direct constraints imposed on z if measurement errors in the direct observations are to be considered i e ϵ j 0 the fields ut need to be generated with s j this means that the equation system has less unknowns than observations solving this equation system using singular value decomposition can be seen as a least squares minimizing solution of eq 10 mandel 1982 differences in the measurement errors and the effect of different supports of the model and the measurements can be taken into account in this step by introducing an appropriate weighted error covariance matrix the second task is to generate the field w such that it also fulfills the non linear conditions given in eq 2 this is done by modifying the field ut the corresponding procedure is described in the following 1 the counter t is set to 1 2 a first candidate field 13 w t w u t is defined by taking a random ut generated as described above 3 the corresponding z field is created as z t g 1 φ w t 4 the non linear constraints hi zt are calculated using the forward model 5 the objective function o is calculated as 14 o i 1 i h i z t h i 2 6 if the objective function is less than a predefined threshold ε then the procedure is finished and zt is a simulated solution of the problem 7 otherwise an additional random field us with u s x j 0 is generated the same way as ut note that the fields us and ut are independent and that they exhibit the same spatial covariance 8 the new field us is combined with ut using a linear combination of the form 15 u θ m cos θ m u t sin θ m u s m 1 m with 16 θ m 2 π m 1 m m 1 m note that the weights of the linear combination cos θm sin θm are points equidistantly distributed on the unit circle further cos θm and sin θm ensure that the variance of the linear combination is unchanged as cos 2 θ m sin 2 θ m 1 this means that the resulting field u θm shares the same covariance as us and ut feller 1968 furthermore u θ m x j 0 thus z m g 1 φ w u θ m is a solution of the linearly constrained problem i e zm exhibits the correct spatial covariance and it honours the observations z m x j z j 9 for a given m all m fields z m g 1 φ w u θ m are constructed and the forward model is run on each of them from the solution of the forward runs the values of the non linear constraints hi zm are extracted and set to mi θm the goal is to derive the values of hi for all possible values of θ without having to run the forward model but through interpolation note the larger the number m the better the interpolation will be but the longer the running time as m defines the number of forward model runs 10 the values of the non linear constraints mi θm obtained in step 9 are interpolated for any θ 0 2π using whittaker 1915 and shannon 1948 interpolation or sinc interpolation 17 m i θ d m θ m i θ m where d m θ k 0 m 1 sin θ θ m k π θ θ m k π denote the interpolation weights note that the hydraulic heads are a continuous function of the hydraulic conductivities thus the heads are also a continuous function of the angle θ this continuity allows interpolating the hydraulic heads i e the non linear constraints as a function of θ the whittaker shannon interpolation profits from the fact that m i θ is periodic with period 2π 11 based on the interpolation in step 10 the approximate objective function o is calculated for any θ as 18 o θ i 1 i m i θ h i 2 note that this step is computationally very fast thus an approximation of each non linear condition and of the overall objective function can be calculated very quickly 12 the θ minimizing o θ is identified as θ 13 the actual objective function corresponding to 19 w t w cos θ u t sin θ u s is calculated using the forward model 14 if this objective function value is lower than the starting value corresponding to w t w u t then u t 1 cos θ u t sin θ u s else u t 1 u t the counter t is increased by 1 and the procedure continues at step 6 note that this procedure uses an interpolation for each non linear condition separately eq 17 the calculation of the overall objective function for the selected θm values and the subsequent interpolation of o θm represents an inferior possibility it is also worth mentioning that the computational cost of generating a large number of fields vl and ut and solving the equation systems is very low usually less than 1 of a forward model run further the described approach allows easy parallelization as the m forward model runs are independent the above procedure can also be modified to consider error covariances in the modeled data by taking o h i z h i t c h i z h i as part of the objective function the problem of model errors however is not explicitly handled in this paper the above algorithm generates a sequence of fields with monotonically decreasing objective function values thus the algorithm makes the impression to be greedy but in fact it is not in each step an independent random field us is generated and for the angle θ 1 2 π this field is considered as candidate in the algorithm as the sequence of independent random fields assures a convergence with probability 1 to the optimum rubinstein 1981 our approach will also converge with probability 1 the main difference to a pure monte carlo approach is that the above algorithm takes advantage of the fast calculation of many inbetween candidate fields 4 examples two examples are used to demonstrate the procedure the first example is based on the well studied synthetic test case for inverse groundwater modeling described in hendricks franssen et al 2009 which has also been used in bárdossy and hörning 2016a the second example is a real world inverse groundwater modeling problem in the lockyer valley in south east queensland australia sreekanth et al 2015 here random mixing was used to calibrate an alluvial aquifer system groundwater model to hydraulic head observations 4 1 synthetic test case as stated above the synthetic test case was originally presented in hendricks franssen et al 2009 where the authors compared seven methods for the inverse modeling of groundwater flow in the following a general description of the example is provided the accuracy of the proposed technique is evaluated and the computational cost is compared to the original random mixing approach presented in bárdossy and hörning 2016a where the inverse problem is solved in a higher dimensional space as opposed to a sequence of one dimensional optimizations 4 1 1 general description in the synthetical test cases hydraulic transmissivity is considered as an under sampled parameter the spatial distribution of the transmissivities is assumed to be the only unknown all other parameters are assumed to be known fig 1 shows the general flow set up the reference hydraulic transmissivity field and the reference hydraulic head field the domain length is 4900 m in the x direction and 5000 m in the y direction discretized into 49 50 grid cells the upper and lower boundaries share no flow conditions while the left and right boundaries have prescribed heads of 0 m and 5 m respectively the aquifer is unconfined with constant transmissivity a pumping well located at 1900 m 2350 m pumps steadily with a flow rate of 0 0578 m3 s and an uniform recharge rate of 362 912 mm y is predefined all over the domain the log transmissivity has a mean log 10 t of 2 932 and a log 10 t variance of 0 189 log 10 m2 s an exponential variogram without nugget effect and an effective range of 500 m is assumed both reference fields transmissivity and head are sampled at 25 locations resulting in two sets of conditioning data the forward model used to solve the flow equations is hydrogeosphere therrien and sudicky 1996 4 1 2 accuracy evaluation and computational cost in order to evaluate the accuracy of the proposed procedure the interpolated single hydraulic heads are compared to the precise single hydraulic heads for the first iteration of the algorithm m 7 is selected step 9 i e seven combinations of random fields according to eq 15 are used to simulate conditional transmissivity fields these simulated fields are subsequently applied as input for the forward flow model fig 2 shows the resulting head fields with their corresponding transmissivity fields as functions of θm for the first iteration of the algorithm based on these fields the values of m i θ m for i 1 25 are known at m 7 equidistant θm values these 25 sets of hydraulic head values are then refined using eq 17 such that there is an interpolated value for each degree between 0 and 2π for comparison reasons the forward model is evaluated for each degree in order to obtain the accurate hydraulic head values fig 3 shows the interpolated hydraulic head values and the precise hydraulic head values for each of the 25 observation locations for the first iteration of the inversion it can be seen that the interpolated values approximate the actual values very accurately minor deviations can only be observed at three locations fig 4 shows two realizations of conditional hydraulic log transmissivity fields with its corresponding hydraulic head fields further the figure contains the mean conditional hydraulic log transmissivity field as well as the mean conditional hydraulic head field these are the mean fields over 100 simulated conditional realizations compared to the results achieved using the approach presented in bárdossy and hörning 2016a the proposed approach requires between 50 90 less forward model runs to achieve comparable root mean squared error results of 0 9 m for the mean hydraulic head field and 0 31 log 10 m2 s for the mean hydraulic transmissivity field fig 5 shows the objective function values relative to the number of forward model runs for the traditional random mixing approach and the approach using whittaker shannon interpolation for two randomly selected realizations note that for each optimization both approaches use the same random fields in order to ensure comparability it can be seen that the approach using whittaker shannon interpolation shows a faster convergence than the traditional random mixing thus less forward model runs are required 4 2 real world test case lockyer valley in the following a brief introduction to the lockyer valley case study sreekanth et al 2015 is given followed by a description of the utilized groundwater model as in the synthetic test case an accuracy evaluation is carried out and computational cost is compared 4 2 1 case study this section reports the evaluation of the applicability of the proposed method in a regional scale groundwater modeling context the method was used to solve the inverse modeling problem of calibrating a groundwater model to hydraulic head observations a numerical groundwater flow model developed for the lockyer valley alluvial aquifer system in australia is used for this purpose the lockyer valley is a major sub catchment of catchment of the brisbane river and covers an areas of around 2900 km2 and forms approximately 20 of the brisbane river catchment the lockyer creek is an ephemeral drainage system and the stream and associated alluvium are the main source for irrigation water supply in the lockyer valley the lockyer valley is a major vegetable and grain producing area supported by groundwater irrigation from alluvial aquifers groundwater use is only regulated within localized areas within the valley and it has been estimated that there is considerable over extraction of water from the alluvial groundwater sources the alluvial deposits occur all along the drainage system and are commonly several kilometers wide and up to 35 m thick these deposits consist of well graded gravel sand silt and clay and are derived primarily from the weathering of basalt sandstone and shale owing to this there is large variability in the spatial hydraulic properties of the aquifer with a lnk variance of σ l n k 2 5 96 4 2 2 the groundwater model the groundwater model was built using modflow harbaugh 2005 harbaugh et al 2017 the main components of the water balance simulated by the model include diffuse recharge stream recharge and groundwater pumping the diffuse recharge was specified as an input boundary condition using estimated values from soil water balance data for various crop types present in the region the stream network is represented in the model using the modflow river package the dynamic exchange of surface water groundwater interactions is simulated by the model controlled by the time series of river stage that is input into the model as a boundary condition the groundwater model grid covers an area of 30 000 ha the numerical model grid was discretized into uniform cells of 250 m 250 m the model comprises of 4806 active grid cells all of equal size in a single layer hydraulic conductivity is considered as an under sampled parameter and the spatial distribution is informed by a handful of measurements from selected locations in the region the spatial distribution of hydraulic conductivity is assumed to be the only unknown all other spatial parameters that underpin the model including specific yield are assumed to be known an exponential variogram with an effective range of 2500 m and 30 nugget effect is assumed the objective of the inverse modeling is to estimate the spatial distribution of the hydraulic conductivity field subject to the non linear constraints imposed by observed water level measurements groundwater level observations from 355 locations over a 20 year period were used in the inverse modeling resulting in 64 960 non linear constraints fig 6 shows the location and estimated values of 43 hydraulic conductivity measurements from pumping tests these estimates were used as linear constraints according to eq 1 4 2 3 accuracy evaluation and computational cost as in the synthetic test case the accuracy of the proposed procedure is evaluated again the interpolated single hydraulic heads are compared to the accurate single hydraulic heads for the first iteration of the inversion m 7 is selected step 9 i e seven combinations of random fields according to eq 15 are used to simulate conditional hydraulic conductivity fields these simulated fields are subsequently applied as input for modflow based on these fields the values of m i θ m for i 1 64960 are known at m 7 equidistant θm values for demonstration purposes 25 out of these 64960 are randomly selected these 25 sets of hydraulic head values are again refined using eq 17 such that there is an interpolated value for each degree between 0 and 2π to obtain the precise hydraulic head values modflow is evaluated for each degree fig 7 shows the interpolated hydraulic head values and the precise hydraulic head values it can be seen that the interpolated hydraulic head values approximate the actual values reasonably but the quality of the interpolation however is not as good as in the synthetic test case a possible explanation for this could be the much higher complexity of the lockyer valley groundwater model compared to the synthetic model it is also worth mentioning that the quality of the interpolation can be improved by increasing m step 9 of the algorithm in sreekanth et al 2015 the authors used pilot points de marsily 1978 to solve the inverse problem to achieve a rmse of 4 54 m for the modeled hydraulic heads they required 8792 forward model runs note that they only obtained a single realization but not multiple realizations using the proposed technique 20 realizations are generated their rmse range between 4 3 m 4 58 m each realization was obtained after 1050 forward model runs this means that a single realization can be obtained in 12 of the computational time required by sreekanth et al 2015 fig 8 shows a comparison of simulated hydraulic heads to observed hydraulic heads for six randomly selected well locations note that increasing the overall number of optimizations would typically lead to better results this however was not envisaged in this example as several other factors contribute to the misfit that can also be observed in fig 8 these include for example structural errors in the modflow model and previously estimated input variables as described in sreekanth et al 2015 5 discussion and conclusions in this paper a technique to reduce computational cost in the random mixing approach for inverse modeling is presented it takes advantage of properties that are specific to random mixing which allow the standard optimization to be replaced by a sequence of one dimensional optimizations this means that only two spatial random fields will be mixed at a time in this one dimensional space the single components of the objective function can be approximated using a simple whittaker shannon interpolation on a unit circle this interpolation leads to a reduction in computational cost as only a few known data points outputs from the forward model are required the minimum of the interpolated overall objective function is determined and the corresponding random field is calculated where the coordinates of the minimum on the unit circle represent the weights then the algorithm continues with the next one dimensional optimization where the previously calculated field will be used in conjunction with another random field this guarantees a monotonic convergence of the objective function the presented examples show that the whittaker shannon interpolation is able to approximate the actual objective function very accurately even the complex lockyer valley case study shows a reasonably good match the overall results are very promising for the synthetic test case they show a reduction in computational cost up to 90 while achieving comparable results to the traditional approach for the lockyer valley example computational cost could be reduced by 88 compared to the pilot points method applied previously acknowledgements research for this paper was partly supported by the german research foundation deutsche forschungsgemeinschaft projektnummer 403207337 ba 1150 24 1 and partly by the energi simulation program the authors would also like to thank the university of queensland centre for coal seam gas and its industry members aplng arrow energy santos and shell qgc for providing research funding all data and all results can be requested via email s hoerning uq edu au supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 012 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
