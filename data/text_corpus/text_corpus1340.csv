index,text
6700,expert systems adopted in real time multi scale runoff prediction are useful decision making tools for hydrologists but the stochastic nature of any hydrological variable can pose significant challenges in attaining a reliable predictive model this paper advocates a data driven approach used to design two phase hybrid model i e cvee elm the model utilizes complete ensemble empirical mode decomposition with adaptive noise ceemdan coupled with the variational mode decomposition vmd algorithms for better frequency resolution of the input datasets and the extreme learning machine elm algorithm as the objective predictive model in the first stage of the presented model design notable frequencies in the predictor target data series are uncovered utilizing the ceemdan algorithm where the model s inputs are decomposed into their respective intrinsic mode functions imfs and the residual res series the second stage entails a vmd approach used to decompose the yet unresolved high frequencies i e imf1 into their variational modes further discerning and establishing the data attributes to be incorporated into the elm model to simulate the respective imfs res and vm data series aggregated as an integrative tool for multiscale runoff prediction in the model evaluative phase the hybrid cvee elm is cross validated with a single phase hybrid elm and an autoregressive integrated moving average arima model to benchmark its accuracy for predicting 1 3 and 6 month ahead runoff in yingluoxia watershed northwestern china two phase hybrid model exhibits superior accuracy at all lead times to accord with high degree of correlations between the observed and the forecasted runoff a relatively large nash sutcliffe and the legate mccabe index taylor diagrams depict the two phase hybrid cvee elm model generated forecasts located close to a reference i e a perfect model with a lower root mean square centered difference and a correspondingly large correlation for all forecast horizons although the model s accuracy for shorter lead times 1 month as expected are better than the 3 and 6 month horizon the study shows that the two phase hybrid cvee elm model where an integration of two frequency resolution algorithms are made is a preferred data driven tool that can be explored for real life decision system design particularly for hydrological forecasting problems that have significantly stochastic data features and thus will require reliable forecasts to be generated at multi step horizons keywords expert system runoff integrated model complete ensemble empirical mode decomposition adaptive noise ceemdan variational mode decomposition vmd extreme learning machine elm nomenclature cvee elm two stage hybrid model integrating the complete ensemble empirical mode decomposition with adaptive noise variational mode decomposition and extreme learning machines cvee elm two phase hybrid model integrating complete ensemble empirical mode decomposition with adaptive noise variational mode decomposition and extreme learning machines cee elm single phase hybrid model integrating complete ensemble empirical mode decomposition with adaptive noise and extreme learning machines ceemdan complete ensemble empirical mode decomposition with adaptive noise emd empirical mode decomposition vmd variational mode decomposition elm extreme learning machines arima autoregressive integrated moving average l legates and mccabe s index nse nash sutcliffe coefficient rsr ratio of rmse to standard deviation m3s 1 pbias percentage of bias error mae mean absolute error r correlation coefficient rmse root mean square error are absolute relative error gpi global performance indicator t stat t statistic u 95 expanded uncertainty p precipitation tl tuole meteorological predictor site 1 yng yeniugou meteorological predictor site 2 ql qilian meteorological predictor site 3 ylx yingluoxia hydrological target site ann artificial neural network svm support vector machine wt wavelet transform modwt maximum overlap discrete wavelet transform imf intrinsic mode function res residue vm variation mode n ensemble number e amplitude of added noise en standard deviation sd standard deviation σp variance of simulated runoff σo variance of observed runoff std standard deviation min minimum max maximum sk skewness 1 background expert systems used in the forecasting of surface runoff denoted hereafter as the run off can play an important role in real life applications particularly in hydrology and water resources management areas with a potential to be embraced in real life decision support systems for flood control and mitigation environment planning and ecosystem management he et al 2014 hong et al 2016 jothiprakash and magar 2012 modarres and ouarda 2013 runoff prediction that also includes streamflow has gained significant attention in recent decades especially in long term horizons deo and şahin 2016 gebremicael et al 2013 prasad et al 2017 wang et al 2015a yaseen et al 2019 however runoff is a consequence of highly complex non stationary and non linear processes that prevail over a range of spatial and temporal scales chang and tsai 2016 maheswaran and khosa 2012b therefore the goal of hydrologists to attain accurate and reliable predictive models as one of the many practical benefits that can successfully address the challenges faced in real life hydrological simulations to improve the forecasting accuracy of runoff time series runoff simulations that are based on physical processes have been generated by a number of modelling approaches physical models are a centrally valuable tool for characterizing the movement and storage of water in different watersheds or for different scenarios chen et al 2013 gebremariam et al 2014 romagnoli et al 2017 sommerlot et al 2016 there is no doubt that a physical model is a gold standard in the hydrology area but the accuracy of runoff forecasts generated by a physical model can rest on the model s physics catchment s initial condition configurations and the calibration of one or more conceptual i e regional scale sub models including the spatial and temporal resolution of a model s input and output he et al 2014 sun et al 2012 these challenges can limit the versatility of a physical model although they are immensely useful to address what if scenarios in hydrological prediction the interactions between runoff and the inter related hydrological variables e g rainfall evaporation and temperature can be highly non linear and complex but some of the underlying assumptions in physical models such as assumption of specific flow conditions linearity in relation to a particular response variable or a particular form of the equation representing a physical process and the input target variables can follow a different pattern if the variable has a significant non linear behavior moreover the nonlinearities arising from hydro physical interactions at largely disparate scales can also complicate the forecasting skill resulting in a physical model that could represent a more tedious approach for runoff predictions from a practical point of view physically based models are likely to make the modeling task expensive and time consuming alizadeh et al 2017 badrzadeh et al 2015 chang and tsai 2016 as an alternative data driven methods such as the artificial neural network ann support vector machine svm and the more recently developed extreme learning machines elm have attracted a great deal of attention due to their simplicity fast simulation and flexibility in modelling non linear processes compared to a physical model alizadeh et al 2017 behzad et al 2009 maheswaran and khosa 2012a misra et al 2009 nourani 2017 taormina and chau 2015 taormina et al 2016 young et al 2017 deo and şahin 2016 prasad et al 2017 yaseen et al 2019 in particular the elm model as a new and an improved version of the conventional neural networks has gained significant popularity in the field of hydrological modelling the advantage of the elm model in respect to the conventional models e g ann or svm include its lesser computational time universal approximation ability ability to attain a global solution and more accurate predictions in comparison with the counterpart models as such several recent studies have attempted to develop elm models for runoff prediction e g abdullah et al 2015 deo et al 2017b deo and şahin 2015 2016 taormina et al 2016 yaseen et al 2016 2019 although machine learning algorithms that utilize artificial intelligence techniques that also include the elm model appears to be a promising data driven tool for hydrological predictions significant challenges exist in this endeavour due to the limitations posed by the non stationary datasets applied in the model design stage deo et al 2017c nourani et al 2014 to effectively predict the runoff series the dynamical input features in all models must be analyzed carefully and then these features should be segregated with an appropriate data pre processing tool before being transformed in an expert system model to solve this issue the advent of multi resolution tools such as the wavelet transformation algorithm denoted as wt e g mallat 1989 1998 nourani et al 2014 2009 singular value decomposition singular spectrum analysis chau and wu 2010 chitsaz et al 2016 and the principal component analysis hu et al 2007 continues to inspire data driven researchers to pre process large volumes of model input datasets where the signal is first decomposed into its high and low frequency sub series to address the issues of non stationarity and periods or jump type perturbations before being used for pattern recognition and prediction of a target variable notably wt has been widely used e g anctil and tape 2004 deo et al 2016 2017c labat et al 2000 nourani et al 2009 wen et al 2016 in spite of their relevant applications recent studies are showing major weaknesses in wt techniques particularly their ability to be incorporated into a forecasting model that adopts a set of non causal filters mainly constructed with discrete wavelet transformation dwt algorithms dwt is likely to induce the decimation effect in a sub series coefficients and therefore generate half of the coefficients of detailed signal at a current level while the other half of the smooth version is recursively processed by high pass and low pass filters at a coarser resolution rathinasamy et al 2014 prasad et al 2017 while the alternative forms of causal filters constructed with a non decimated wavelet i e maximum overlap discrete wavelet transform modwt are able to retain the down sampled values at a decomposition level the choice of the best mother wavelet although is an advantage in terms of a wide range of choices available could be also a major concern as there is no explicit rule to select an optimal wavelet function other than through an iterative trial and error process as undertaken recently e g prasad et al 2017 having said that the variety of mother wavelets to be trailed in developing an accurate wt based model certainly provides feasible options of iteratively tuning the best model with different the selections as performed in some studies e g prasad et al 2017 to surmount some of these potential issues associated with conventional multi resolution analysis or data pre processing techniques alternative forms of algorithms based on the empirical mode decomposition emd huang et al 1998 ensemble emd eemd wu and huang 2009b and the complete ensemble emd with adaptive noise ceemdan torres et al 2011a have also been proposed although their application in hydrological forecasts are yet to be explored these techniques do not require the expert user to prescribe a frequency band basis or feature mapping such a pre defined wavelet with modwt thus making the process completely self adaptive and sufficient to address the issues faced by the other data driven methods emd is a self adaptive data driven tool that decomposes a complicated signal in a finite set of intrinsic mode functions imfs and a residual res term emd can therefore be considered as better than the wavelet counterparts but they may lack the physical understanding in terms of the frequency components within the data and a lack of proper mathematical background thus making it completely black box nonetheless the decompositions resulting in the imfs and residual series i e frequency information is based on local characteristic scales in the flow and so emd can help identify nonlinear and non stationary processes represented by the model dataset however emd can suffer from mode mixing that emerges from a signal s intermittency deering and kaiser 2005 huang et al 1999 2003 and this effect can be a significant issue for hydrological applications given that the model inputs are irregular and trend based in most hydrological watersheds and scenarios to overcome these issues the eemd technique ensemble emd with an ability to decompose a signal with the added white noise in imfs while treating the ensemble means of imfs in the repetitive process has been applied wu and huang 2009b while eemd utilizes gaussian noise to resolve mode mixing flandrin and goncalves 2004 it is likely to create new undesirable modes since the noise cannot be removed completely zhang et al 2017 the advanced version ceemdan integrating emd and eemd with a noise coefficient vector added at each decomposition stage is able to ensure that the reconstruction is complete and noise free and requires no trial and error torres et al 2011a fortunately ceemdan is able to decompose a complex signal in imfs and res with high reproducibility stability and regularity for segregation of frequency mode here the gaussian noise is added sequentially at each stage allowing expert users to control the additive noise to ensure that reconstruction is complete and noise free and attains a solution with less number of trials ren et al 2015 zhang et al 2017 recent studies in several areas such as hydrology water quality studies and electrictiy demand forecasting are showing the importance of emd based methods in attaining accurate predictive models prasad et al 2018 fijani et al 2019 al musaylh et al 2018b this study aims to apply the ceemdan algorithm for a better frequency resolution of the run off input data series prior to the actual modeling process the studies of premanode and toumazou 2013 and tao et al 2017 integrated emd algorithm with svm model for exchange rate and stream flow prediction while kisi et al 2014 integrated emd with ann for hydrological prediction and yaslan and bican 2017 integrated emd with svm for load forecasting purposes many researchers have utilized eemd based models to resolve other challenges e g mode mixing similar oscillations in different modes and oscillations of disparate amplitudes huang et al 1998 2003 by creating an ensemble of inputs with gaussian white noise wu and huang 2009b eemd models are more effective than emd based model ausati and amanollahi 2016 ming et al 2016 ouyang et al 2016 shao et al 2015 wang et al 2015a b in a study that compared emd svm eemd svm and ceemdan svm models for wind speed forecasting ceemdan svm outperformed emd and eemd hybrid models ren et al 2015 furthermore the study al musaylh et al 2018b used the ceemdan algorithm integrated with an svm model for electricity demand forecasting whereas prasad et al 2018 integrated the elm model with eemd algorithm for soil moisture forecasting however to the authors knowledge no previous research has utilized the ceemdan coupled with an elm model for the prediction of runoff at multi scale horizons in spite of the efficacy of hybrid models employing emd eemd and ceemdan as add in tools deficiencies still exist in the decomposition process where the resulting imfs and residual terms may still not be fully resolved in terms of the nonlinear and irregular data segments the un resolved frequencies i e imf1 therefore could be a cause of disturbance and if so it is likely to introduce challenges for feature extraction and goodness of fit of the resulting model guo et al 2012 napolitano et al 2011 in accordance with huang et al 2014 if a relatively nonlinear and non stationary behavior is persistent it could lead to irregular imfs being predicted and thus lead to poor predictive accuracy despite their advancement over wt or the other approaches single decomposition algorithms i e only by integration of emd eemd or ceemdan may not fully deal with non stationarities in data to address this issue researchers ignored imf1 huang et al 2014 zhang et al 2016 whereas the others proposed a two stage decomposition where variational mode decomposition vmd was used as an add in tool for secondary decompositions applied to the imf1 signal i e the signal containing highly perturbing frequencies fijani et al 2019 wang et al 2017a b this two phase hybrid model was superior although literature reveals no studies that have explored a two phase decomposition model for runoff forecasting at multi scale horizons other than recent applications of a single phase ceemdan model in areas such as soil moisture forecasting electrical demand prediction and environmental monitoring e g al musaylh et al 2018b fijani et al 2019 prasad et al 2018 where svm and elm were used no previous study has designed a two phase hybrid model where both the low and the high frequency imfs were split into different frequency components particularly for runoff prediction and especially at a multiple lead times i e 1 3 6 months for which such models do not exist in order to also explore existing methods and to design a new model potentially useful for short and long term decisions in hydrology and water management this study aims to design for the first time a two phase hybrid model with an optimally tuned the integration of ceemdan and vmd techniques with elm as the objective predictor model the proposed approach therefore represents a novel contribution is potentially useful for designing expert systems spanning several areas such as the management of drought water and eco hydrological applications the objectives of this study are as follows 1 construct a two phase hybrid model i e cvee elm integrating ceemdan vmd and elm algorithms in such a way that the model input is adequately resolved into its low and high frequencies constituents imfs and res to promulgate accurate runoff simulations 2 ascertain the performance of the two phase hybrid cvee elm against alternative approaches a single phase cee elm hybrid model i e without variational mode decomposition and a standalone elm and a stochastically based autoregressive integrated moving average arima model 3 test the robustness of the two phase hybrid cvee elm vs a single phase hybrid cee elm and a standalone elm and arima algorithms viz diagnostic evaluation of performance with visual plots and statistical score metrics of predicted and observed runoff for the independent test data to satisfy these this study undertakes a cross validation of the new data driven model developed for 1 3 and 6 month runoff prediction in yingluoxia watershed china where the precision of the two phase hybrid cvee elm model is evaluated against a single phase hybrid cee elm elm and arima models 2 theoretical overview only the ceemdan and vmd algorithm used in previous studies fijani et al 2019 are explained in detail here since these decomposition approaches are considered relatively new in the runoff forecasting area the theoretical background of the elm and arima models can be gleaned from elsewhere as these methods are well known approaches and have been presented in several previous studies for a detailed background of the elm model the study of huang and his co authors huang et al 2006a b 2015 can be consulted while for the arima models readers can refer to the original study of box and jenkins 1976 and others e g al musaylh et al 2018a jalalkamali et al 2015 deo and sahin 2017 in terms of the application of the elm model in hydrological predictions area readers can also consult our earlier research work deo and şahin 2016 and also the work of other researchers dongwen 2013 hadihardaja et al 2014 yadav et al 2017 2 1 complete ensemble empirical mode decomposition with adaptive noise consider a set of d dimensional n length x i matrix i e predictors based on two stage decomposed sub series obtained from the ceemdan and vmd process and the 1 dimensional y i i e runoff as the target variable the ceedan decomposition starts via the emd process huang et al 1998 to separate the n length model inputs χ t into a number of frequency representative modes imfs and resides res that satisfy the admissibility condition i e number of extrema and zero crossings be equal to differ at most by unity average of the upper and lower bounds of the imfs is trivial everywhere however in order to ensure that there is no leakage of data i e imfs and res from training set into the future period i e testing set these decompositions must be performed in separately partitioned series next the true imf is acquired by averaging the emd based corresponding imfs over an ensemble of trials with additive white noise with a smaller tail end distribution to the original model input χ n this ensemble emd process is congruent with a 3 step process huang et al 1998 step 1 construct χ p n χ n ω p n with ω p n that are different p ensembles p 1 2 p of white gaussian noise step 2 drawn from step 1 each of χ i n series is maximally decomposed by emd to acquire different modes im f k p n for each model input χ t where k 1 2 k represents the intrinsic modes derived from the primary signal step 3 all modes denoted as im f k p are averaged whilst assigning them as the k th mode of χ i n with 1 imf n 1 p p 1 p im f k i n the residue res 1 is defined as 2 res 1 n χ n i m f 1 n considering res 1 n we compute the first emd mode over a set of p ensembles and obtain im f 2 with a given noise by ensemble mean of different realizations where the next residue can be defined as 3 res 2 n res 1 n i m f 2 n the above procedure is iterated over all of the remaining modes until the stagnation criterion is satisfied to address issues with eemd where different number of modes can be produced due to redundant noise we adopt an improved version of eemd where the reconstructed time series collated modes and residues is identical to the original signal colominas et al 2014 torres et al 2011b a major difference with respect to eemd is that a controlled noise ε i over 0 1 is added at each stage of the decomposition with a unique residue computed for each imf leading to negligible error if e j is an operator that generates j th modes obtained by emd the ceemdan process is represented as follows torres et al 2011a step 1 decomposition of p realizations of χ n ε 1 ω p n by emd to acquire their first intrinsic mode viz 4 imf 1 n 1 p p 1 p im f 1 p n imf 1 n step 2 setting k 1 the first residue is calculated in accordance with eq 4 5 res 1 n χ n im f 1 n step 3 setting k 2 the second intrinsic mode can computed as 6 imf 2 n 1 p p 1 p e 1 r 1 n ε 1 e 1 ω p n step 4 for k 2 k compute the k th residue as 7 res k n res k 1 n imf k n step 5 decompose the realizations res k n ε 1 e 1 ω p n k 1 k until their first emd mode where the k 1 is 8 imf k 1 n 1 p p 1 p e 1 r k n ε k e k ω p n step 6 increment the k value and repeat steps 4 6 until the residue does not constitute at least two extrema subsequently the final residue is satisfied 9 res k n χ n k 1 k imf k where k is the limiting case maximum number of modes to comply with the reproducibility of the original input χ n the following is held true for the case of ceemdan approach 10 χ n k 1 k im f k res k n it is important to note that the term ε additive noise representing the signal to noise ratio can be controlled at each stage e g prasad et al 2018 which must also accord with the low amplitude values for the data series with high frequency signals wu and huang 2009b 2 2 variational mode decomposition vmd in the second phase of the model design variational mode decomposition vmd pioneered by the study of dragomiretskiy and zosso 2014 is applied where the training and testing data must be again decomposed separately to avoid data leakage issues also used in some recent studies in the water resources area fijani et al 2019 the vmd algorithm is a non recursive data pre processing tool that adaptively decomposes the high frequency imf1 into discrete band limited sub signals i e sub modes considering high frequency input f t imf1 and y v v th component of imf1 the vmd process satisfies the condition dragomiretskiy and zosso 2014 wang et al 2017a b 11 min y v w v v 1 v t t j π t y v t e j w v t 2 2 s t v 1 v y v f t where wk δ t and denote the center frequency of y v i e the dirac distribution and convolution operator respectively the constrained problem in equation 11 can be reverted to an unconstrained problem by considering the penalty term and the lagrangian operator λ to yield the augmented lagrangian term λ 12 λ y k w k λ α k 1 k t t j π t y k t e j w kt 2 2 f t k 1 k y k t 2 2 λ t f t k 1 k y k t where α the balancing parameter of data fidelity constraint and the augmented lagrangian term λ and its saddle point is determined in accordance with the alternative direction method of multipliers admm the solutions for y k and w k are obtained according to dragomiretskiy and zosso 2014 13 y k n 1 f w i y k y w λ w 2 1 2 α w w k 2 and w k n 1 0 w y k n 1 2 d w 0 y k n 1 2 d w where f w y i w λ w and λ k n 1 w are the fourier transforms of imf1 y i t λ t and y n 1 t respectively and n is the number of iterations for vmd process after the decomposition into imf1 into vm1 vm2 vmk sub series these are stacked together with imf2 imfk to better identify patterns and attributes in the two phase decomposed dataset to be incorporated into the cvee elm model 3 materials and method 3 1 study area and the hydrological data the present study region yingluoxia watershed located in upper reaches of heihe river is a mountainous watershed approximately 10 018 km2 the elevation of this site ranges from 1637 to 5062 m asl fig 1 and the mountainous runoff of the yingluoxia watershed is monitored at the yingluoxia ylx hydrological station 38 82 n 100 18 e 1637 m asl located at the mainstream outlet of heihe river flowing from the qilian mountains down to the hexi corridor most of the water resources in the middle oasis and lower desert ecosystem are recharged by runoff from the upper reach the climate is warm and wet in summer and cold and dry in winter with large spatial and temporal variability average precipitation tends to increase from west to east from 200 to 700 mm year 1 precipitation occurs in the wet season from june to september accounting for 70 of the annual precipitation altitudinal landscape zones exist in the watershed including a desert steppe zone from 1637 to 2800 m shrubbery forest grassland zone from 2800 to 3500 m sub alpine shrubbery meadow zone from 3500 to 4000 m alpine cold and desert meadow zone from 4000 to 4500 m and alpine permafrost snow ice zone from 4500 m to 5062 m yang et al 2017 water resource is a main controlling factor for economic development and ecological environment protection in this region however the region is limited in water resources the heihe river is the only runoff flow through the area with the increase in population there is increasing pressure on its water resources therefore this watershed is a useful candidate for the development of new hybrid predictive models for runoff forecasting in this research the time series of monthly runoff obtained from the ylx station fig 1 as the target site are used to construct and evaluate the hybrid models accordingly the monthly runoff and total rainfall in the upper reaches of heihe river are used as the model inputs to be used as the model inputs the measured rainfall data for three sites qilian ql yeniugou yng and tuole tl stations are obtained for a relatively long period starting from january 1960 to december 2013 from the china meteorological data sharing service system http cdc cma gov cn home do as the purpose of this research study is to forecast runoff for the 1 3 and 6 monthly time steps the daily rainfall are summed up to generate monthly equivalent values to develop the cvee elm cee elm and elm models all data are partitioned in two distinct subsets with the ratio 76 25 train and 23 74 test subsets the first set is denoted as the training set january 1960 to december 2000 and the other set as denoted as the testing set january 2001 to december 2013 in this study the partitioning of the entire data into a training and testing set is performed prior to the decomposition and modelling process to ensure that no leakage of training data into the testing period takes place this step is necessary to ensure the potential use of future data to test the model is avoided and any bias in the model results is overcome due to issues associated with future data employed in the testing phase where it is not available beforehand table 1 enumerates the hydrological statistics of the present study site where the 3 predictors and 1 target site data are shown according to the statistical properties no significant differences between the divisions of training and testing data are observed this means that the training set is expected to contain sufficient information about the hydrological system s behavior and thus is qualified as the training and cross validation dataset for the prescribed models 3 2 two phase hybrid forecast model development the schematics of the two phase hybrid cvee elm and its comparative counterpart models i e the single phase cee elm and standalone elm are illustrated in fig 2 in the first phase the ceemdan algorithm is utilized to decompose original rainfall i e predictor and runoff i e target series for both training and testing sets into distinct intrinsic mode functions imfs with the corresponding low high frequency and residual res components in the second phase we noted that imf1 is likely to contain the highest frequency oscillatory behavior in streamflow and rainfall data which could represent the yet fully unresolved physical structure of these data since the imf1 signal is likely to contain such high frequency for detailed information about the runoff and rainfall data series which inevitably can complicate the forecasting process to yield potentially unsatisfactory results huang et al 2014 wang et al 2016 a second stage decomposition process is implemented this stage creates a two phase hybrid cvee elm model in accordance with an earlier study that has also used similar techniques for water monitoring environments fijani et al 2019 to split the high frequencies present in imf1 series the vmd algorithm is applied to break the imf1 data into its respective variational modes i e vms elm is then applied to simulate the imfs and res sub series the forecasted imf1 is obtained by summing the results for all modes and res extracted from the vmd process and the target variable i e runoff is obtained by aggregating the results of all imfs and res including vmd aggregated imf1 to benchmark the two phase cvee elm model forecasts are also obtained without the vm process to construct a single phase hybrid cee elm model and a standalone model without decomposition i e a standalone elm to attain optimal forecast results of runoff at multiple time step horizons the imfs vms and res components are created from a set of carefully selected inputs where different combinations of the runoff and total monthly rainfall series were used as potential inputs to utilize the role of hydrologic memory in predicting the runoff series the statistically significant time lag is set as 6 which means that the model inputs have the current t and a prior five time step data series to predict the future runoff at the target site leading to a total of 24 potential model inputs in the two phase hybrid cvee elm model the ceemdan process is facilitated using the r package rlibeemd helske et al 2018 luukko et al 2016 it is noteworthy that crucial parameters of this algorithm i e ensemble size and the amplitude of white noise must be first defined to enable a complete cancellation of the white noise from the original signal in this paper we utilize the statistical rule used to control the white noise as follows wu and huang 2009a 14 e n ε n in eq 14 n the ensemble number ε the amplitude of added noise and en the standard deviation sd the difference between input and corresponding imfs the recommended amplitude of white noise approximately 20 of the sd wu and huang 2009a is applied to the cvee elm model following previous studies that suggest a sufficient number of ensembles ouyang et al 2016 ren et al 2015 wang et al 2013 our ensemble number is set as 200 it must be stated that the number of imfs depend on the length of input data used to construct the model in order to develop the prescribed cvee elm and cee elm models we firstly check the number of imfs res obtained by the ceemdan and the number of imfs obtained by the vmd algorithm for the training runoff and rainfall data series january 1960 to december 2000 a total of 8 components i e 7 imf res and 5 vms are evident for the ceemdan and vmd decompositions respectively in order to match these number of imfs res with the testing set as a core requirement of the modelling approach the same number of imfs res are obtained for the testing data series therefore the testing data comprised of the runoff and rainfall series january 2001 to december 2013 are decomposed in imf1 imf2 imf7 and res with each reflecting the natural oscillatory modes present in the meteorological and hydrological data here res is the lowest frequency representing the variation trends in runoff and rainfall following earlier studies wang et al 2017a the vmd algorithm in matlab s toolbox is next utilized to decompose the highest frequency component imf1 into 5 distinct components i e vm1 vm2 vm3 vm4 and vm5 respectively the elm model is employed to forecast each of the imfs and res datasets while forecasted imf1 is obtained using the elm with the vm1 vm2 vm3 vm4 and vm5 as the model inputs finally imfs and res are obtained through the elm method which utilized as the final inputs for the elm model for 1 3 and 6 months ahead runoff forecasting at the target site i e the ylx station prior to the design of the all models the inputs and target matrices were normalized between 1 1 to avoid the larger numerical attributes from dominating the importance of the features represented by smaller numeric attributes in this paper the elm model is built with a three layer neuronal arrangement consisting of the input hidden and output nodes the input layer contains each of the inputs for each of the three kinds of models and the output layer contains the predicted target i e runoff to facilitate the best feature extraction several neuronal activation functions e g sine hard limit radial basis triangular basis logarithmic sigmoid and tangent sigmoid are tested following earlier approaches deo et al 2017b deo and şahin 2016 the number of hidden neurons is varied from 1 to n 1 in increment of 1 where n is the number of training points in each of the predictor target matrix based on the objective performance criterion the training mean square error mse is monitored at each trial run where each neuronal architecture for different activation functions is evaluated the optimal neuronal architecture is selected based on 1000 different randomized elm hidden layers deo et al 2017a considering the lowest mse where the model is evaluated in the independent test set with best activation function for all models as a logarithmic sigmoid equation following earlier studies e g deo et al 2017b deo and şahin 2015 2016 deo et al 2015 yaseen et al 2016 the most accurate data driven model i e the two phase single phase and standalone model is screened table 2 shows the design parameters for the most optimal model based on cvee elm cee elm and elm algorithms 3 3 performance evaluation congruent with the american society for civil engineers asce guidelines used for assessing watershed based predictive models asce 1993 the accuracy of the newly designed two phase hybrid cvee elm vs the single phase hybrid cee elm and elm is assessed with statistical score metrics i e correlation coefficient r mean absolute error mae root mean squared error rmse nash sutcliffe efficiency coefficient nse the ratio of rmse to standard deviation of the observations rsr and the percent of the bias error pbias chai and draxler 2014 krause et al 2005 nash and sutcliffe 1970 the cross validation of the observed vs the forecasted runoff is also performed by the legates mccabe index l expanded uncertainty u 95 t statistic and global performance indicator gpi legates and mccabe 1999 stone 1993 in conjunction with diagnostic plots scatter diagram taylor plots and error histograms taylor 2001 using the following equations 15 r i 1 n q i o q o q i p q p i 1 n q i o q o 2 i 1 n q i p q p 2 16 mae 1 n i 1 n q i p q i o 17 rmse 1 n i 1 n q i p q i o 2 18 nse 1 i 1 n q i o q i o 2 i 1 n q i o q 0 2 19 rsr rmse stde v o i 1 n q i o q i p 2 i 1 n q i o q o 2 20 pbias i 1 n q i o q i p i 1 n q i o 100 21 l 1 i 1 n q i o q i p q i o q o i 0 l 1 22 rrmse 1 n i 1 n q i p q i o 2 1 n i 1 n q i o 100 where n the number of input samples q i o and q i p the observed and predicted runoff at time t q o and q p the average of the observed and predicted runoff for a perfect simulation of the runoff data at the target site an r value 1 mae rmse rsr 0 and nse 1 is desirable in accordance with literature normally a model is considered to be very good if the nse is 0 75 and rsr is less than 0 50 good performance if ns is 0 65 and rsr is less than 0 6 and satisfactory performance if nse is 0 5 and rsr is less than 0 70 moriasi et al 2007 as a widely used metric the value of r presents the degree to which the predicted and observed runoff are linearly related i e perfectly matched rmse and mae provide the prediction capability where a trivial value is attained by a perfect model rmse that must satisfy the triangular inequality deduces the global fitness and is more appropriate to represent model performance than mae when the error distribution is expected to be gaussian whereas mae provides a more balanced perspective of the goodness of fit based on estimation errors chai and draxler 2014 ns adopts a ranges of and 1 indicating the model relative to the mean observations while rsr varies from optimal value of 0 indicating zero rmse or residual variation and the percent bias pbias measures the average tendency of simulated values to be larger or smaller than the observed values the optimal value of pbias is 0 with low magnitude values indicating accurate predictions and positive values indicating overestimation bias whereas negative values indicate model underestimation bias for further evaluation of the prescribed data driven models three further metrics expanded uncertainty u 95 t statistic and global performance indicator gpi are also computed vi expanded uncertainty u 95 behar et al 2015 gueymard 2014 23 u 95 1 96 s d 2 r m s e 2 1 2 vii t statistic t stat stone 1993 24 t stat n 1 m b e 2 rms e 2 m b e 2 viii global performance indicator gpi stone 1993 25 gpi mbe rmse u 95 t stat 1 r 2 eqs 23 25 provide a complementary evaluation to assess the efficacy of the hybrid cvee elm model by means of a universal metric that combines the predictive power based on mean bias error mbe rmse and coefficient of determination r 2 between observed and predicted runoff in the test dataset 4 results and discussion the two phase hybrid cvee elm model is benchmarked against a single phase cee elm and a standalone elm model for simulating 1 3 and 6 month ahead runoff at yinluoxia station tables 3 6 show the prediction results for the cvee elm compared with the cee elm elm and the univariate arima model in the respective training and testing phases considering the 1 month ahead forecast horizon the performance of two phase hybrid model is seen too far exceed the performance of the single phase cee elm standalone elm and arima model importantly this is true for both the training and the testing datasets for the 1 month ahead forecasted runoff dataset the model in the testing period yielded an r value of approximately 0 981 cvee elm vs 0 970 cee elm 0 926 elm and 0 188 arima whereas the mae rmse is 6 679 9 209 m3s 1 cvee elm vs 8 676 12 253 m3s 1 cee elm 12 580 18 220 m3s 1 elm and 36 413 46 593 m3s 1 arima respectively this result also concurs with a relatively high nse value 0 961 for the cvee elm vs 0 931 for the cee elm 0 850 for the elm and 0 005 for the arima model this result also accedes with a lower value of the rsr 0 197 vs 0 262 0 380 and 9 607 for the respective models another measure of the tested model accuracy the percentage bias error pbias is found to be approximately 2 234 cvee elm vs 7 384 cee elm 5 300 elm and 14 708 arima considering these results the cvee elm model appears to provide accurate and reliable 1 monthly ahead runoff forecasts table 3 when considering the forecasting of runoff at longer lead time horizons it is evident from these results that although the accuracy of the 3 and the 6 monthly ahead runoff is considerably lower than the 1 month forecasts but the results are consistently better for the two phase cvee elm hybrid model relative to a single phase cee elm elm and the arima model similar deductions can also be made when correlation coefficient root mean square error and the mean absolute errors are analyzed a closer comparison of the performance metrics for different lead times shows that the longest lead time i e 6 months results are in fact quite good for the two phase hybrid cvee elm model in terms of a relatively high and acceptable nash sutcliffe coefficient nse 0 875 vs 0 850 0 769 and 0 008 in accordance with moriasi et al 2007 the newly designed two phase cvee elm hybrid model can be considered as a relatively good forecasting model since the nse is 0 75 and the rsr value is less than 0 50 despite a subtly lower performance the single phase cee elm hybrid model can also be attributed to be a good forecasting model since the nse value is 0 850 and the rsr value is 0 386 by contrast the standalone elm model is considerably lower than both hybrid models justified by the nse value of 0 769 and an rsr value of 0 479 in fact the percentage bias error for the standalone standalone elm model is considerably large i e pbias 10 700 against a pbias value of 0 609 cee elm and 3 955 cvee elm which concurs with rmse 22 508 m3s 1 compared to 18 120 m3s 1 and 16 537 m3s 1 respectively it is thus clear that the hybridization of the standalone standalone elm with a two phase decomposition technique i e integrating the ceemdan with the vmd approach contributes to a significant improvement in the forecasting skill compared to a standalone model moreover the two phase approach indicates the possibility of applying such a hybrid model for long term simulation of runoff up to a six month lead time with an acceptable level of accuracy tables 3 5 indeed the better performance of the two phase model in this paper is consistent with studies that were performed elsewhere that also revealed a better utility of the two phase against the single phase and standalone models in context of electricity price and air quality forecasting wang et al 2017a b for all lead times the arima model based on a stochastic framework is unable to predict runoff both in the training and the testing phases and this deduction concurs with results in several other studies where arima model has been applied e g al musaylh et al 2018a wang et al 2015b it is important to note that the present 3 and 6 months ahead simulations which yields better performance of the two phase cvee elm hybrid model with a notable decrease in r and nse and an increase in mae rmse rsr and pbias is compatiblewith the results of other researchers who have modelled hydrological systems at multiple lead timescales e g feng et al 2015 nayak et al 2006 in such studies the skills of their model also appeared to deteriorate with an elongation in the forecasting horizon which is perhaps attributable to a paucity in the overall data patterns at a longer time step wen et al 2016 despite this the shorter 1 month lead time is still considered important for real life applications e g irrigation water allocation hydropower generation and lake water management however it is acknowledged that a longer forecasting horizon such as the 3 6 or even 12 month lead time is desirable for long term hydrological applications e g seasonal farming crop and irrigation management to further explore these results we refer to literature for example the study of kisi 2009 demonstrated that for 1 month lead time lake level forecasting the neuro wavelet model had a smaller value of the rmse and mae by 87 34 and 86 31 for van and egirdir lakes respectively but for 6 month lead time horizon the reduction was only by 34 48 and 30 46 respectively in a study on wavelet analysis ann model for multi scale monthly groundwater level forecasting wen et al 2016 showed that their 2 and 3 month ahead forecasting results were worse than 1 month ahead results in a rather different application i e water demand forecasting at a range of shorter forecast horizons tiwari and adamowski 2013 predicted 1 3 and 5 day ahead water demand using a wavelet bootstrap ann to show that the correlation with observed data deteriorated with an increase in forecast time concluding that there was less feature information at longer lead time horizons in spite of the lower performance of 6 month forecasting models the statistical metrics of the two phase cvee elm hybrid model remained within the threshold of a very good model for runoff prediction moriasi et al 2007 despite the slightly deteriorated accuracy the nse values for 3 and 6 months ahead forecasts were 0 904 and 0 875 and the rsr values were 0 309 and 0 352 respectively indicating that the two phase cvee elm hybrid model achieved very good performances consequently we conclude that the two phase hybrid cvee elm model can attain acceptably accurate predictions for long term runoff simulations while the statistical metrics presented so far have assessed the skill of the two phase hybrid cvee elm model hydrograph and scatter plots are also helpful in evaluating the temporal correspondence of observed data and the model forecasted values fig 3 shows hydrographs and scatter plots of observed and predicted runoff at 1 3 and 6 month lead times by the cvee elm hybrid model in the testing phase to assist with in interpretation of these results a least square regression line y ax b has been included in each panel where the constants a and y intercept b are used to assess the model s overall accuracy obviously the two phase hybrid cvee elm method performs very well for runoff predictions for 1 month lead forecasting which is better than the 3 and 6 month lead time notably the performance for higher lead times deteriorates gradually fig 3 it is clearly evident that the runoff values estimated by the two phase hybrid cvee elm technique are close to the corresponding observed values and follow the same trend in all plots it is also obvious from the fitted equations that the hybrid cvee elm models attain a and b values that lie close to 1 and 0 with higher r2 0 85 for the 1 month compared with the 3 and 6 month ahead runoff forecasting figs 4 and 5 show the hydrographs and scatter plots of observed and the forecasted runoff generated by the cee elm hybrid and eml models in the testing period due to a poor accuracy the arima model has not been shown this reveals that both of these models register relatively good simulation accuracy for the 1 3 and 6 month ahead runoff forecasting compared to fig 3 where the cvee elm model is shown as seen from the fitted equations that the a b coefficients and r 2 the cvee model has a greater accuracy than the cee elm hybrid and the eml model in most tested data cases indicating a significantly better fit this also reaffirms that the cvee elm hybrid model has a better predictive skill than the cee elm and eml models considered in this study peak flow forecasting through a reliable runoff model is important to disseminate information on water resource management and timely flood warning tables 7 9 show the observed and the forecasted peak flows generated by the two phase cvee elm hybrid model applied for the 1 3 and 6 month ahead runoff forecasting relative to cee elm and the standalone elm model the absolute relative error are presented here is calculated based on observed and predicted peak flows we note that the are values range from approximately 1 84 to 18 44 0 25 to 31 38 and 2 72 to 38 45 in terms of the mean value of top 10 runoff data points the present results show that the cvee elm hybrid model generated an error of 7 73 11 59 and 18 74 respectively for the 1 3 and 6 month ahead forecasts moreover despite an inferior results relative to the two phase hybrid model the results also demonstrate a relatively small error encountered in the peak flows generated by the single phase cvee elm hybrid model at 1 3 and 6 monthly timescales compared to the standalone elm model in light of the foregoing discussion one can infer a better feasibility of the two phase cvee elm hybrid model for highest peak flows predicted at the 1 3 and 6 month ahead tests tables 7 9 considering the observed highest peak flow 187 00 m3s 1 the highest peak flows forecasted for 1 3 and 6 month ahead were 179 05 m3s 1 156 98 m3s 1 and 145 79 m3s 1 respectively similarly the highest values that were considerably underestimated were 7 95 m3s 1 30 02 m3s 1 and 41 21 m3s 1 for 1 3 and 6 month ahead simulations respectively fig 6 this can be considered an important limitation of the present research work and concurs with the other studies that have also applied artificial intelligence models for peak runoff flow forecasting e g he et al 2014 kasiviswanathan et al 2016 despite these limitations the two phase cvee elm hybrid model provides highly accurate forecasts relative to the single phase cee elm hybrid and the standalone standalone elm model tables 7 9 while evaluating the utility of a predictive model for its feasibility in runoff forecasting it is not only important to assess the average forecasted error but also the distribution of errors in the entire tested dataset therefore in order to test the robustness of the developed models the error distribution is shown in fig 7 that compares the two phase cvee elm hybrid against the single phase cee elm and the standalone elm model for assessing the degree of dispersion and skewness of the error a boxplot diagram is shown for 1 3 and 6 month ahead runoff forecasting it can be seen that although the single phase hybrid cee elm and the standalone elm model attained small error distributions the two phase hybrid cvee elm model generated smaller errors and the dimensionless residual was smaller than did the counterpart models this is true not only for the 1 month ahead runoff forecasts but also for the 3 and 6 month ahead forecasts therefore the results show that the two phase hybrid cvee elm model is a superior model to the single phase hybrid cee elm and the standalone elm model integrating multiple model characteristics via a universally compact diagnostic plot i e taylor diagram is important to enable inter model comparisons especially in a problem where multiple models are considered the taylor diagram taylor 2001 can enable a hydrologist to graphically summarize how closely simulation matches observed pattern in a test data quantified via correlation centred root mean square difference and amplitude of variation represented by standard deviations fig 8 shows a taylor diagram for the two phase hybrid cvee elm vs the single phase hybrid cee elm and standalone elm model for 1 3 and 6 month forecast horizons where the purpose is to evaluate multiple aspects of models to gauge their relative skills represented in two dimensional space taylor diagram visualizes three model statistics simultaneously i e the centred rmse difference correlation and standard deviation in terms of 26 δ σ f 2 σ r 2 2 σ f σ r r in eq 26 σf and σr are the variances of cvee elm cee elm and elm simulated runoff and the observed runoff respectively in the testing period and r is the correlation coefficient obtained from the cosine of the azimuthal angle determined in accordance with law of cosines taylor 2001 comparing the results of 1 month lead time the two phase hybrid cvee elm model far exceeds the performance of the 3 and 6 month lead times evidenced by its closer position to the observed reference point on the sd axis and smaller rms centred difference fig 8a vs b c for all lead times considered the elm model is positioned the furthest from the reference i e observation point followed by a relatively shorter distance for the two phase hybrid cvee elm model consistent with the trends of 3 and the 6 month lead times fig 8b c and in concurrence with earlier results i e tables 3 8 figs 3 7 taylor diagram justifies superior skills of the dual decomposition based model ceemdan vmd to the single decomposition ceemdan and the standalone elm model interestingly the single phase hybrid cee elm model was positioned closer to the reference standard deviation line than the two phase cvee elm model albeit with a smaller correlation coefficient between observed and forecasted runoff data for greater relevance of results enabling us to compare geographically diverse sites the relative error and the normalized metric legates mccabe index l that present an edge over the nash sutcliffe s coefficient and other metrics in tables 2 4 legates and mccabe 1999 was computed fig 9 presented as a condensed graphic for all lead times and models considered fig 9a reveals the smallest error encountered by the two phase cvee elm hybrid model compared with the single phase and the elm model in fact very significant improvement was attained in the 1 month forecasts with a relative rrmse of 16 10 cvee elm compared with 21 42 cee elm and 31 47 elm this amount less than 20 error accords to a good model attributable to cvee elm a fair model 20 rrmse 30 attributable to cee elm and a poor model rrmse 30 for the standalone elm by contrast for the 3 month lead time forecasts of runoff the hybrid cvee elm and cee elm model could be considered as fair with an error of 24 85 28 43 and the elm model could still be considered as poor 41 38 for the longest lead time 6 months results show that the two phase cvee elm model is fair but the other two models are relatively poor rrmse 30 ertekin and yaldiz 2000 mohammadi et al 2015 when l is assessed fig 9b the two phase hybrid cvee elm model retains its superiority with a value of 0 826 for 1 month 0 724 for 3 month and 0 669 for 6 month lead time forecasting this result utilizing the more robust performance index compared to the nash sutcliffe coefficient legates and davis 1997 legates and mccabe 1999 2013 corroborates with the deductions with respect to single phase cee elm hybrid and the standalone elm model that is the latter models yielded a relatively lower value of l i e 0 778 0 680 0 673 for cee elm and 0 683 0 577 0 582 for elm respectively it is also important to reiterate that that two phase hybrid model produced much accurate forecasts of runoff even for longer lead time horizons of 6 months where a value of l 0 699 was attained see fig 9b moving forward to use a complementary set of model evaluation metrics we show table 10 where the expanded uncertainty u 95 t statistic t stat and the global performance metrics gpi are enumerated note that u 95 facilitates a comparison of models by integrating the standard deviation and root mean square error benchmarked over a 95 confidence interval comparing observed and measured runoff whereas the t stat integrates the mean bias error where the sign of difference remains intact and root mean square error and the universal metric gpi provides an overall assessment in terms of the mean bias error rmse r2 u 95 and t stat considering that for an ideal model the gpi must be close to zero the results show for 1 month simulations the two phase cvee elm hybrid model far exceeds the performance of the counterpart models with gpi 19 5 vs 453 3 799 7 owing to large disparities with respect to a single phase and elm model it is inferred that the two phase hybrid model is a potential candidate for 1 and 3 month forecasting interestingly when the 6 month forecasts results are compared the single phase cee elm model stands out as more superior to the two phase and standalone elm model in concurrence with the taylor plot fig 8c a plausible reason for this is that the standard deviation of the forecasted result by single phase cee elm model was closer to the reference observed line in fig 8c this is perhaps due to the possibility that that the single phase hybrid cee elm model was somewhat more stable as it may have generated runoff data whose rms centered difference was low considering a higher l and a lower relative error fig 9 the two phase cvee elm model is still be a more ideal tool for 6 month runoff prediction overall based on the results we find that the two phase hybrid cvee elm model performs better than do single phase hybrid cee elm and elm models for multi step ahead runoff forecasting and therefore indicating the potential advantage of utilizing the dual phase decomposition technique fig 2 for accurate and reliable runoff prediction used in knowledge based systems 5 conclusions and recommendations for future research work knowledge based expert systems require well designed and cross validated data driven models to attain reliable forecasted data to be used in decision support systems such expert systems that must respond adequately to generate real time i e both short term and long term predictions are able to provide decision makers with the valuable information on future water resources planning and management in arid and semi arid environments in this study we constructed and evaluated a two phase hybrid cvee elm model coupled with a dual integration of the ceemdan and vmd decomposition techniques and the results were consistent with earlier studies applied in different modelling and data contexts al musaylh et al 2018b prasad et al 2018 fijani et al 2019 the resulting two phase model was applied to the yingluoxia watershed region in northwest china to forecast at 1 3 and 6 months ahead runoff predictions and it was also benchmarked with a single phase hybrid cee elm and elm model in the two phase hybrid cvee elm model the original inputs composed of antecedent rainfall and runoff were decomposed into significant imfs and residue signals to facilitate accurate feature analysis and forecasting critical improvements in runoff simulation were induced by the vmd approach decomposing the high frequency imf1 into significant variational modes with the elm was used to predict imfs and vm signals finally the elm was adopted to establish multi step runoff forecasting to evaluate the effectiveness of the two phase hybrid cvee elm model based on statistical and visually represented outputs in the test dataset the two phase cvee elm model was able to successfully forecast 1 3 and 6 month ahead runoff contrasting the performance of the single phase hybrid cee elm and the standalone elm model the two phase model exhibited greater precision and stability although model error was seen to increase with an elongation of the lead time i e 3 and 6 month ahead forecasts in accordance with this evidence we draw the conclusion that the two phase hybrid cvee elm model coupled with ceemdan and vmd decomposition methods integrated into an elm model allows for effective removal of non stationary characteristics associated with original series which makes it difficult for standalone elm model to map the underlying complexity in the antecedent rainfall and runoff data used as the model inputs the remarkable superiority of the two phase hybrid cvee elm was particularly envisioned by extensive analysis of forecasted and observed dataset evidenced by the improved performances the empirical and variational mode decomposition made the modelling realistic where the predictions were made achievable yielding a robust model by segregating low and high frequency components at different time intervals in antecedent data this offered better clarity to the elm model to enhance its ability to forecast runoff without getting deeper into underlying physical relationships or when there are limited input data for driving numerical models moreover the vmd technique had a significant ability to handle noisy and non stationary features in imf1 that was not fully resolved through ceemdan so the dual integration of both vmd with ceemdan led to greater preciseness of the two phase model by contrast the elm had limited ability to handle non stationary inputs resulting in inferior performance it is ascertained that the two phase hybrid cvee elm model can be relevant for complex hydrological data characterization i e better identification of the nonlinearity and irregularity in antecedent rainfall and runoff the two phase hybrid cvee elm model can be explored as a scientific tool employed by hydrologists and decision makers for forecasting long term runoff without the need for underlying the physical relationships and initial condition data required for various interacting elements therefore being especially advantageous for regions with limited measurement data for driving physical models in spite of the remarkable accuracy of the two phase model over comparative counterpart models for multi step runoff simulation the study has limitations that create opportunity for further research in an expert system designed as a real time short term simulation tool the technique should be validated for much shorter term horizons e g hourly or daily step ahead one possibility is also that such a hybrid model can be integrated with a physically based hydrological model to design a nowcasting runoff simulation system such as the csiro waterdyn model awap 2016 raupach et al 2009 where physically based real time output s generated through physical equations using meteorological and hydrological inputs e g radiation temperature and rainfall are analyzed with the ceemdan and vmd technique for run off generation moreover this study has used the ceemdan and vmd techniques for a two layer model but there also exist further opportunity for an independent study to develop and test an improved forecast model by utilizing the improved complete ensemble empirical mode decomposition i e iceemdan al musaylh et al 2018b with the vmd technique as an additional contribution to the present field of study as a future study an ensemble elm model where training and testing data points are re sampled with replacement to create several realizations of the model can provide greater insights into the fluctuations and error bounds of the model an integration of the two phase hybrid model with a feature selection tool employing large sets of satellite and observational modeled atmospheric products dee et al 2011 limaye et al 2014 modis 2016 nasa 2014 may be valuable for runoff modeling in data sparse regions future benchmarks with recent versions of multi resolution tools e g empirical wavelet transform kedadouche et al 2016 peng et al 2017 with improved differential evolution extreme learning machines de elm wang et al 2017b to address randomness non stationarity and irregularity characteristics in expert system based models are all valid research tasks to be undertaken in independent studies acknowledgements this research was funded by national key research and development program of china 2017yfc0404305 key research program of frontier sciences cas qyzdj ssw dqc031 cas light of west china program and the natural sciences foundation of gausu 18jr3ra393 dr rc deo offers sincere thanks to the chinese academy of science presidential international fellowship program 2016 and the university of southern queensland short adosp 2017 research program to enable international collaborations with chinese researchers the authors thank all three reviewers the associate editor and editor in chief for their constructive comments that have improved clarity of the manuscript 
6700,expert systems adopted in real time multi scale runoff prediction are useful decision making tools for hydrologists but the stochastic nature of any hydrological variable can pose significant challenges in attaining a reliable predictive model this paper advocates a data driven approach used to design two phase hybrid model i e cvee elm the model utilizes complete ensemble empirical mode decomposition with adaptive noise ceemdan coupled with the variational mode decomposition vmd algorithms for better frequency resolution of the input datasets and the extreme learning machine elm algorithm as the objective predictive model in the first stage of the presented model design notable frequencies in the predictor target data series are uncovered utilizing the ceemdan algorithm where the model s inputs are decomposed into their respective intrinsic mode functions imfs and the residual res series the second stage entails a vmd approach used to decompose the yet unresolved high frequencies i e imf1 into their variational modes further discerning and establishing the data attributes to be incorporated into the elm model to simulate the respective imfs res and vm data series aggregated as an integrative tool for multiscale runoff prediction in the model evaluative phase the hybrid cvee elm is cross validated with a single phase hybrid elm and an autoregressive integrated moving average arima model to benchmark its accuracy for predicting 1 3 and 6 month ahead runoff in yingluoxia watershed northwestern china two phase hybrid model exhibits superior accuracy at all lead times to accord with high degree of correlations between the observed and the forecasted runoff a relatively large nash sutcliffe and the legate mccabe index taylor diagrams depict the two phase hybrid cvee elm model generated forecasts located close to a reference i e a perfect model with a lower root mean square centered difference and a correspondingly large correlation for all forecast horizons although the model s accuracy for shorter lead times 1 month as expected are better than the 3 and 6 month horizon the study shows that the two phase hybrid cvee elm model where an integration of two frequency resolution algorithms are made is a preferred data driven tool that can be explored for real life decision system design particularly for hydrological forecasting problems that have significantly stochastic data features and thus will require reliable forecasts to be generated at multi step horizons keywords expert system runoff integrated model complete ensemble empirical mode decomposition adaptive noise ceemdan variational mode decomposition vmd extreme learning machine elm nomenclature cvee elm two stage hybrid model integrating the complete ensemble empirical mode decomposition with adaptive noise variational mode decomposition and extreme learning machines cvee elm two phase hybrid model integrating complete ensemble empirical mode decomposition with adaptive noise variational mode decomposition and extreme learning machines cee elm single phase hybrid model integrating complete ensemble empirical mode decomposition with adaptive noise and extreme learning machines ceemdan complete ensemble empirical mode decomposition with adaptive noise emd empirical mode decomposition vmd variational mode decomposition elm extreme learning machines arima autoregressive integrated moving average l legates and mccabe s index nse nash sutcliffe coefficient rsr ratio of rmse to standard deviation m3s 1 pbias percentage of bias error mae mean absolute error r correlation coefficient rmse root mean square error are absolute relative error gpi global performance indicator t stat t statistic u 95 expanded uncertainty p precipitation tl tuole meteorological predictor site 1 yng yeniugou meteorological predictor site 2 ql qilian meteorological predictor site 3 ylx yingluoxia hydrological target site ann artificial neural network svm support vector machine wt wavelet transform modwt maximum overlap discrete wavelet transform imf intrinsic mode function res residue vm variation mode n ensemble number e amplitude of added noise en standard deviation sd standard deviation σp variance of simulated runoff σo variance of observed runoff std standard deviation min minimum max maximum sk skewness 1 background expert systems used in the forecasting of surface runoff denoted hereafter as the run off can play an important role in real life applications particularly in hydrology and water resources management areas with a potential to be embraced in real life decision support systems for flood control and mitigation environment planning and ecosystem management he et al 2014 hong et al 2016 jothiprakash and magar 2012 modarres and ouarda 2013 runoff prediction that also includes streamflow has gained significant attention in recent decades especially in long term horizons deo and şahin 2016 gebremicael et al 2013 prasad et al 2017 wang et al 2015a yaseen et al 2019 however runoff is a consequence of highly complex non stationary and non linear processes that prevail over a range of spatial and temporal scales chang and tsai 2016 maheswaran and khosa 2012b therefore the goal of hydrologists to attain accurate and reliable predictive models as one of the many practical benefits that can successfully address the challenges faced in real life hydrological simulations to improve the forecasting accuracy of runoff time series runoff simulations that are based on physical processes have been generated by a number of modelling approaches physical models are a centrally valuable tool for characterizing the movement and storage of water in different watersheds or for different scenarios chen et al 2013 gebremariam et al 2014 romagnoli et al 2017 sommerlot et al 2016 there is no doubt that a physical model is a gold standard in the hydrology area but the accuracy of runoff forecasts generated by a physical model can rest on the model s physics catchment s initial condition configurations and the calibration of one or more conceptual i e regional scale sub models including the spatial and temporal resolution of a model s input and output he et al 2014 sun et al 2012 these challenges can limit the versatility of a physical model although they are immensely useful to address what if scenarios in hydrological prediction the interactions between runoff and the inter related hydrological variables e g rainfall evaporation and temperature can be highly non linear and complex but some of the underlying assumptions in physical models such as assumption of specific flow conditions linearity in relation to a particular response variable or a particular form of the equation representing a physical process and the input target variables can follow a different pattern if the variable has a significant non linear behavior moreover the nonlinearities arising from hydro physical interactions at largely disparate scales can also complicate the forecasting skill resulting in a physical model that could represent a more tedious approach for runoff predictions from a practical point of view physically based models are likely to make the modeling task expensive and time consuming alizadeh et al 2017 badrzadeh et al 2015 chang and tsai 2016 as an alternative data driven methods such as the artificial neural network ann support vector machine svm and the more recently developed extreme learning machines elm have attracted a great deal of attention due to their simplicity fast simulation and flexibility in modelling non linear processes compared to a physical model alizadeh et al 2017 behzad et al 2009 maheswaran and khosa 2012a misra et al 2009 nourani 2017 taormina and chau 2015 taormina et al 2016 young et al 2017 deo and şahin 2016 prasad et al 2017 yaseen et al 2019 in particular the elm model as a new and an improved version of the conventional neural networks has gained significant popularity in the field of hydrological modelling the advantage of the elm model in respect to the conventional models e g ann or svm include its lesser computational time universal approximation ability ability to attain a global solution and more accurate predictions in comparison with the counterpart models as such several recent studies have attempted to develop elm models for runoff prediction e g abdullah et al 2015 deo et al 2017b deo and şahin 2015 2016 taormina et al 2016 yaseen et al 2016 2019 although machine learning algorithms that utilize artificial intelligence techniques that also include the elm model appears to be a promising data driven tool for hydrological predictions significant challenges exist in this endeavour due to the limitations posed by the non stationary datasets applied in the model design stage deo et al 2017c nourani et al 2014 to effectively predict the runoff series the dynamical input features in all models must be analyzed carefully and then these features should be segregated with an appropriate data pre processing tool before being transformed in an expert system model to solve this issue the advent of multi resolution tools such as the wavelet transformation algorithm denoted as wt e g mallat 1989 1998 nourani et al 2014 2009 singular value decomposition singular spectrum analysis chau and wu 2010 chitsaz et al 2016 and the principal component analysis hu et al 2007 continues to inspire data driven researchers to pre process large volumes of model input datasets where the signal is first decomposed into its high and low frequency sub series to address the issues of non stationarity and periods or jump type perturbations before being used for pattern recognition and prediction of a target variable notably wt has been widely used e g anctil and tape 2004 deo et al 2016 2017c labat et al 2000 nourani et al 2009 wen et al 2016 in spite of their relevant applications recent studies are showing major weaknesses in wt techniques particularly their ability to be incorporated into a forecasting model that adopts a set of non causal filters mainly constructed with discrete wavelet transformation dwt algorithms dwt is likely to induce the decimation effect in a sub series coefficients and therefore generate half of the coefficients of detailed signal at a current level while the other half of the smooth version is recursively processed by high pass and low pass filters at a coarser resolution rathinasamy et al 2014 prasad et al 2017 while the alternative forms of causal filters constructed with a non decimated wavelet i e maximum overlap discrete wavelet transform modwt are able to retain the down sampled values at a decomposition level the choice of the best mother wavelet although is an advantage in terms of a wide range of choices available could be also a major concern as there is no explicit rule to select an optimal wavelet function other than through an iterative trial and error process as undertaken recently e g prasad et al 2017 having said that the variety of mother wavelets to be trailed in developing an accurate wt based model certainly provides feasible options of iteratively tuning the best model with different the selections as performed in some studies e g prasad et al 2017 to surmount some of these potential issues associated with conventional multi resolution analysis or data pre processing techniques alternative forms of algorithms based on the empirical mode decomposition emd huang et al 1998 ensemble emd eemd wu and huang 2009b and the complete ensemble emd with adaptive noise ceemdan torres et al 2011a have also been proposed although their application in hydrological forecasts are yet to be explored these techniques do not require the expert user to prescribe a frequency band basis or feature mapping such a pre defined wavelet with modwt thus making the process completely self adaptive and sufficient to address the issues faced by the other data driven methods emd is a self adaptive data driven tool that decomposes a complicated signal in a finite set of intrinsic mode functions imfs and a residual res term emd can therefore be considered as better than the wavelet counterparts but they may lack the physical understanding in terms of the frequency components within the data and a lack of proper mathematical background thus making it completely black box nonetheless the decompositions resulting in the imfs and residual series i e frequency information is based on local characteristic scales in the flow and so emd can help identify nonlinear and non stationary processes represented by the model dataset however emd can suffer from mode mixing that emerges from a signal s intermittency deering and kaiser 2005 huang et al 1999 2003 and this effect can be a significant issue for hydrological applications given that the model inputs are irregular and trend based in most hydrological watersheds and scenarios to overcome these issues the eemd technique ensemble emd with an ability to decompose a signal with the added white noise in imfs while treating the ensemble means of imfs in the repetitive process has been applied wu and huang 2009b while eemd utilizes gaussian noise to resolve mode mixing flandrin and goncalves 2004 it is likely to create new undesirable modes since the noise cannot be removed completely zhang et al 2017 the advanced version ceemdan integrating emd and eemd with a noise coefficient vector added at each decomposition stage is able to ensure that the reconstruction is complete and noise free and requires no trial and error torres et al 2011a fortunately ceemdan is able to decompose a complex signal in imfs and res with high reproducibility stability and regularity for segregation of frequency mode here the gaussian noise is added sequentially at each stage allowing expert users to control the additive noise to ensure that reconstruction is complete and noise free and attains a solution with less number of trials ren et al 2015 zhang et al 2017 recent studies in several areas such as hydrology water quality studies and electrictiy demand forecasting are showing the importance of emd based methods in attaining accurate predictive models prasad et al 2018 fijani et al 2019 al musaylh et al 2018b this study aims to apply the ceemdan algorithm for a better frequency resolution of the run off input data series prior to the actual modeling process the studies of premanode and toumazou 2013 and tao et al 2017 integrated emd algorithm with svm model for exchange rate and stream flow prediction while kisi et al 2014 integrated emd with ann for hydrological prediction and yaslan and bican 2017 integrated emd with svm for load forecasting purposes many researchers have utilized eemd based models to resolve other challenges e g mode mixing similar oscillations in different modes and oscillations of disparate amplitudes huang et al 1998 2003 by creating an ensemble of inputs with gaussian white noise wu and huang 2009b eemd models are more effective than emd based model ausati and amanollahi 2016 ming et al 2016 ouyang et al 2016 shao et al 2015 wang et al 2015a b in a study that compared emd svm eemd svm and ceemdan svm models for wind speed forecasting ceemdan svm outperformed emd and eemd hybrid models ren et al 2015 furthermore the study al musaylh et al 2018b used the ceemdan algorithm integrated with an svm model for electricity demand forecasting whereas prasad et al 2018 integrated the elm model with eemd algorithm for soil moisture forecasting however to the authors knowledge no previous research has utilized the ceemdan coupled with an elm model for the prediction of runoff at multi scale horizons in spite of the efficacy of hybrid models employing emd eemd and ceemdan as add in tools deficiencies still exist in the decomposition process where the resulting imfs and residual terms may still not be fully resolved in terms of the nonlinear and irregular data segments the un resolved frequencies i e imf1 therefore could be a cause of disturbance and if so it is likely to introduce challenges for feature extraction and goodness of fit of the resulting model guo et al 2012 napolitano et al 2011 in accordance with huang et al 2014 if a relatively nonlinear and non stationary behavior is persistent it could lead to irregular imfs being predicted and thus lead to poor predictive accuracy despite their advancement over wt or the other approaches single decomposition algorithms i e only by integration of emd eemd or ceemdan may not fully deal with non stationarities in data to address this issue researchers ignored imf1 huang et al 2014 zhang et al 2016 whereas the others proposed a two stage decomposition where variational mode decomposition vmd was used as an add in tool for secondary decompositions applied to the imf1 signal i e the signal containing highly perturbing frequencies fijani et al 2019 wang et al 2017a b this two phase hybrid model was superior although literature reveals no studies that have explored a two phase decomposition model for runoff forecasting at multi scale horizons other than recent applications of a single phase ceemdan model in areas such as soil moisture forecasting electrical demand prediction and environmental monitoring e g al musaylh et al 2018b fijani et al 2019 prasad et al 2018 where svm and elm were used no previous study has designed a two phase hybrid model where both the low and the high frequency imfs were split into different frequency components particularly for runoff prediction and especially at a multiple lead times i e 1 3 6 months for which such models do not exist in order to also explore existing methods and to design a new model potentially useful for short and long term decisions in hydrology and water management this study aims to design for the first time a two phase hybrid model with an optimally tuned the integration of ceemdan and vmd techniques with elm as the objective predictor model the proposed approach therefore represents a novel contribution is potentially useful for designing expert systems spanning several areas such as the management of drought water and eco hydrological applications the objectives of this study are as follows 1 construct a two phase hybrid model i e cvee elm integrating ceemdan vmd and elm algorithms in such a way that the model input is adequately resolved into its low and high frequencies constituents imfs and res to promulgate accurate runoff simulations 2 ascertain the performance of the two phase hybrid cvee elm against alternative approaches a single phase cee elm hybrid model i e without variational mode decomposition and a standalone elm and a stochastically based autoregressive integrated moving average arima model 3 test the robustness of the two phase hybrid cvee elm vs a single phase hybrid cee elm and a standalone elm and arima algorithms viz diagnostic evaluation of performance with visual plots and statistical score metrics of predicted and observed runoff for the independent test data to satisfy these this study undertakes a cross validation of the new data driven model developed for 1 3 and 6 month runoff prediction in yingluoxia watershed china where the precision of the two phase hybrid cvee elm model is evaluated against a single phase hybrid cee elm elm and arima models 2 theoretical overview only the ceemdan and vmd algorithm used in previous studies fijani et al 2019 are explained in detail here since these decomposition approaches are considered relatively new in the runoff forecasting area the theoretical background of the elm and arima models can be gleaned from elsewhere as these methods are well known approaches and have been presented in several previous studies for a detailed background of the elm model the study of huang and his co authors huang et al 2006a b 2015 can be consulted while for the arima models readers can refer to the original study of box and jenkins 1976 and others e g al musaylh et al 2018a jalalkamali et al 2015 deo and sahin 2017 in terms of the application of the elm model in hydrological predictions area readers can also consult our earlier research work deo and şahin 2016 and also the work of other researchers dongwen 2013 hadihardaja et al 2014 yadav et al 2017 2 1 complete ensemble empirical mode decomposition with adaptive noise consider a set of d dimensional n length x i matrix i e predictors based on two stage decomposed sub series obtained from the ceemdan and vmd process and the 1 dimensional y i i e runoff as the target variable the ceedan decomposition starts via the emd process huang et al 1998 to separate the n length model inputs χ t into a number of frequency representative modes imfs and resides res that satisfy the admissibility condition i e number of extrema and zero crossings be equal to differ at most by unity average of the upper and lower bounds of the imfs is trivial everywhere however in order to ensure that there is no leakage of data i e imfs and res from training set into the future period i e testing set these decompositions must be performed in separately partitioned series next the true imf is acquired by averaging the emd based corresponding imfs over an ensemble of trials with additive white noise with a smaller tail end distribution to the original model input χ n this ensemble emd process is congruent with a 3 step process huang et al 1998 step 1 construct χ p n χ n ω p n with ω p n that are different p ensembles p 1 2 p of white gaussian noise step 2 drawn from step 1 each of χ i n series is maximally decomposed by emd to acquire different modes im f k p n for each model input χ t where k 1 2 k represents the intrinsic modes derived from the primary signal step 3 all modes denoted as im f k p are averaged whilst assigning them as the k th mode of χ i n with 1 imf n 1 p p 1 p im f k i n the residue res 1 is defined as 2 res 1 n χ n i m f 1 n considering res 1 n we compute the first emd mode over a set of p ensembles and obtain im f 2 with a given noise by ensemble mean of different realizations where the next residue can be defined as 3 res 2 n res 1 n i m f 2 n the above procedure is iterated over all of the remaining modes until the stagnation criterion is satisfied to address issues with eemd where different number of modes can be produced due to redundant noise we adopt an improved version of eemd where the reconstructed time series collated modes and residues is identical to the original signal colominas et al 2014 torres et al 2011b a major difference with respect to eemd is that a controlled noise ε i over 0 1 is added at each stage of the decomposition with a unique residue computed for each imf leading to negligible error if e j is an operator that generates j th modes obtained by emd the ceemdan process is represented as follows torres et al 2011a step 1 decomposition of p realizations of χ n ε 1 ω p n by emd to acquire their first intrinsic mode viz 4 imf 1 n 1 p p 1 p im f 1 p n imf 1 n step 2 setting k 1 the first residue is calculated in accordance with eq 4 5 res 1 n χ n im f 1 n step 3 setting k 2 the second intrinsic mode can computed as 6 imf 2 n 1 p p 1 p e 1 r 1 n ε 1 e 1 ω p n step 4 for k 2 k compute the k th residue as 7 res k n res k 1 n imf k n step 5 decompose the realizations res k n ε 1 e 1 ω p n k 1 k until their first emd mode where the k 1 is 8 imf k 1 n 1 p p 1 p e 1 r k n ε k e k ω p n step 6 increment the k value and repeat steps 4 6 until the residue does not constitute at least two extrema subsequently the final residue is satisfied 9 res k n χ n k 1 k imf k where k is the limiting case maximum number of modes to comply with the reproducibility of the original input χ n the following is held true for the case of ceemdan approach 10 χ n k 1 k im f k res k n it is important to note that the term ε additive noise representing the signal to noise ratio can be controlled at each stage e g prasad et al 2018 which must also accord with the low amplitude values for the data series with high frequency signals wu and huang 2009b 2 2 variational mode decomposition vmd in the second phase of the model design variational mode decomposition vmd pioneered by the study of dragomiretskiy and zosso 2014 is applied where the training and testing data must be again decomposed separately to avoid data leakage issues also used in some recent studies in the water resources area fijani et al 2019 the vmd algorithm is a non recursive data pre processing tool that adaptively decomposes the high frequency imf1 into discrete band limited sub signals i e sub modes considering high frequency input f t imf1 and y v v th component of imf1 the vmd process satisfies the condition dragomiretskiy and zosso 2014 wang et al 2017a b 11 min y v w v v 1 v t t j π t y v t e j w v t 2 2 s t v 1 v y v f t where wk δ t and denote the center frequency of y v i e the dirac distribution and convolution operator respectively the constrained problem in equation 11 can be reverted to an unconstrained problem by considering the penalty term and the lagrangian operator λ to yield the augmented lagrangian term λ 12 λ y k w k λ α k 1 k t t j π t y k t e j w kt 2 2 f t k 1 k y k t 2 2 λ t f t k 1 k y k t where α the balancing parameter of data fidelity constraint and the augmented lagrangian term λ and its saddle point is determined in accordance with the alternative direction method of multipliers admm the solutions for y k and w k are obtained according to dragomiretskiy and zosso 2014 13 y k n 1 f w i y k y w λ w 2 1 2 α w w k 2 and w k n 1 0 w y k n 1 2 d w 0 y k n 1 2 d w where f w y i w λ w and λ k n 1 w are the fourier transforms of imf1 y i t λ t and y n 1 t respectively and n is the number of iterations for vmd process after the decomposition into imf1 into vm1 vm2 vmk sub series these are stacked together with imf2 imfk to better identify patterns and attributes in the two phase decomposed dataset to be incorporated into the cvee elm model 3 materials and method 3 1 study area and the hydrological data the present study region yingluoxia watershed located in upper reaches of heihe river is a mountainous watershed approximately 10 018 km2 the elevation of this site ranges from 1637 to 5062 m asl fig 1 and the mountainous runoff of the yingluoxia watershed is monitored at the yingluoxia ylx hydrological station 38 82 n 100 18 e 1637 m asl located at the mainstream outlet of heihe river flowing from the qilian mountains down to the hexi corridor most of the water resources in the middle oasis and lower desert ecosystem are recharged by runoff from the upper reach the climate is warm and wet in summer and cold and dry in winter with large spatial and temporal variability average precipitation tends to increase from west to east from 200 to 700 mm year 1 precipitation occurs in the wet season from june to september accounting for 70 of the annual precipitation altitudinal landscape zones exist in the watershed including a desert steppe zone from 1637 to 2800 m shrubbery forest grassland zone from 2800 to 3500 m sub alpine shrubbery meadow zone from 3500 to 4000 m alpine cold and desert meadow zone from 4000 to 4500 m and alpine permafrost snow ice zone from 4500 m to 5062 m yang et al 2017 water resource is a main controlling factor for economic development and ecological environment protection in this region however the region is limited in water resources the heihe river is the only runoff flow through the area with the increase in population there is increasing pressure on its water resources therefore this watershed is a useful candidate for the development of new hybrid predictive models for runoff forecasting in this research the time series of monthly runoff obtained from the ylx station fig 1 as the target site are used to construct and evaluate the hybrid models accordingly the monthly runoff and total rainfall in the upper reaches of heihe river are used as the model inputs to be used as the model inputs the measured rainfall data for three sites qilian ql yeniugou yng and tuole tl stations are obtained for a relatively long period starting from january 1960 to december 2013 from the china meteorological data sharing service system http cdc cma gov cn home do as the purpose of this research study is to forecast runoff for the 1 3 and 6 monthly time steps the daily rainfall are summed up to generate monthly equivalent values to develop the cvee elm cee elm and elm models all data are partitioned in two distinct subsets with the ratio 76 25 train and 23 74 test subsets the first set is denoted as the training set january 1960 to december 2000 and the other set as denoted as the testing set january 2001 to december 2013 in this study the partitioning of the entire data into a training and testing set is performed prior to the decomposition and modelling process to ensure that no leakage of training data into the testing period takes place this step is necessary to ensure the potential use of future data to test the model is avoided and any bias in the model results is overcome due to issues associated with future data employed in the testing phase where it is not available beforehand table 1 enumerates the hydrological statistics of the present study site where the 3 predictors and 1 target site data are shown according to the statistical properties no significant differences between the divisions of training and testing data are observed this means that the training set is expected to contain sufficient information about the hydrological system s behavior and thus is qualified as the training and cross validation dataset for the prescribed models 3 2 two phase hybrid forecast model development the schematics of the two phase hybrid cvee elm and its comparative counterpart models i e the single phase cee elm and standalone elm are illustrated in fig 2 in the first phase the ceemdan algorithm is utilized to decompose original rainfall i e predictor and runoff i e target series for both training and testing sets into distinct intrinsic mode functions imfs with the corresponding low high frequency and residual res components in the second phase we noted that imf1 is likely to contain the highest frequency oscillatory behavior in streamflow and rainfall data which could represent the yet fully unresolved physical structure of these data since the imf1 signal is likely to contain such high frequency for detailed information about the runoff and rainfall data series which inevitably can complicate the forecasting process to yield potentially unsatisfactory results huang et al 2014 wang et al 2016 a second stage decomposition process is implemented this stage creates a two phase hybrid cvee elm model in accordance with an earlier study that has also used similar techniques for water monitoring environments fijani et al 2019 to split the high frequencies present in imf1 series the vmd algorithm is applied to break the imf1 data into its respective variational modes i e vms elm is then applied to simulate the imfs and res sub series the forecasted imf1 is obtained by summing the results for all modes and res extracted from the vmd process and the target variable i e runoff is obtained by aggregating the results of all imfs and res including vmd aggregated imf1 to benchmark the two phase cvee elm model forecasts are also obtained without the vm process to construct a single phase hybrid cee elm model and a standalone model without decomposition i e a standalone elm to attain optimal forecast results of runoff at multiple time step horizons the imfs vms and res components are created from a set of carefully selected inputs where different combinations of the runoff and total monthly rainfall series were used as potential inputs to utilize the role of hydrologic memory in predicting the runoff series the statistically significant time lag is set as 6 which means that the model inputs have the current t and a prior five time step data series to predict the future runoff at the target site leading to a total of 24 potential model inputs in the two phase hybrid cvee elm model the ceemdan process is facilitated using the r package rlibeemd helske et al 2018 luukko et al 2016 it is noteworthy that crucial parameters of this algorithm i e ensemble size and the amplitude of white noise must be first defined to enable a complete cancellation of the white noise from the original signal in this paper we utilize the statistical rule used to control the white noise as follows wu and huang 2009a 14 e n ε n in eq 14 n the ensemble number ε the amplitude of added noise and en the standard deviation sd the difference between input and corresponding imfs the recommended amplitude of white noise approximately 20 of the sd wu and huang 2009a is applied to the cvee elm model following previous studies that suggest a sufficient number of ensembles ouyang et al 2016 ren et al 2015 wang et al 2013 our ensemble number is set as 200 it must be stated that the number of imfs depend on the length of input data used to construct the model in order to develop the prescribed cvee elm and cee elm models we firstly check the number of imfs res obtained by the ceemdan and the number of imfs obtained by the vmd algorithm for the training runoff and rainfall data series january 1960 to december 2000 a total of 8 components i e 7 imf res and 5 vms are evident for the ceemdan and vmd decompositions respectively in order to match these number of imfs res with the testing set as a core requirement of the modelling approach the same number of imfs res are obtained for the testing data series therefore the testing data comprised of the runoff and rainfall series january 2001 to december 2013 are decomposed in imf1 imf2 imf7 and res with each reflecting the natural oscillatory modes present in the meteorological and hydrological data here res is the lowest frequency representing the variation trends in runoff and rainfall following earlier studies wang et al 2017a the vmd algorithm in matlab s toolbox is next utilized to decompose the highest frequency component imf1 into 5 distinct components i e vm1 vm2 vm3 vm4 and vm5 respectively the elm model is employed to forecast each of the imfs and res datasets while forecasted imf1 is obtained using the elm with the vm1 vm2 vm3 vm4 and vm5 as the model inputs finally imfs and res are obtained through the elm method which utilized as the final inputs for the elm model for 1 3 and 6 months ahead runoff forecasting at the target site i e the ylx station prior to the design of the all models the inputs and target matrices were normalized between 1 1 to avoid the larger numerical attributes from dominating the importance of the features represented by smaller numeric attributes in this paper the elm model is built with a three layer neuronal arrangement consisting of the input hidden and output nodes the input layer contains each of the inputs for each of the three kinds of models and the output layer contains the predicted target i e runoff to facilitate the best feature extraction several neuronal activation functions e g sine hard limit radial basis triangular basis logarithmic sigmoid and tangent sigmoid are tested following earlier approaches deo et al 2017b deo and şahin 2016 the number of hidden neurons is varied from 1 to n 1 in increment of 1 where n is the number of training points in each of the predictor target matrix based on the objective performance criterion the training mean square error mse is monitored at each trial run where each neuronal architecture for different activation functions is evaluated the optimal neuronal architecture is selected based on 1000 different randomized elm hidden layers deo et al 2017a considering the lowest mse where the model is evaluated in the independent test set with best activation function for all models as a logarithmic sigmoid equation following earlier studies e g deo et al 2017b deo and şahin 2015 2016 deo et al 2015 yaseen et al 2016 the most accurate data driven model i e the two phase single phase and standalone model is screened table 2 shows the design parameters for the most optimal model based on cvee elm cee elm and elm algorithms 3 3 performance evaluation congruent with the american society for civil engineers asce guidelines used for assessing watershed based predictive models asce 1993 the accuracy of the newly designed two phase hybrid cvee elm vs the single phase hybrid cee elm and elm is assessed with statistical score metrics i e correlation coefficient r mean absolute error mae root mean squared error rmse nash sutcliffe efficiency coefficient nse the ratio of rmse to standard deviation of the observations rsr and the percent of the bias error pbias chai and draxler 2014 krause et al 2005 nash and sutcliffe 1970 the cross validation of the observed vs the forecasted runoff is also performed by the legates mccabe index l expanded uncertainty u 95 t statistic and global performance indicator gpi legates and mccabe 1999 stone 1993 in conjunction with diagnostic plots scatter diagram taylor plots and error histograms taylor 2001 using the following equations 15 r i 1 n q i o q o q i p q p i 1 n q i o q o 2 i 1 n q i p q p 2 16 mae 1 n i 1 n q i p q i o 17 rmse 1 n i 1 n q i p q i o 2 18 nse 1 i 1 n q i o q i o 2 i 1 n q i o q 0 2 19 rsr rmse stde v o i 1 n q i o q i p 2 i 1 n q i o q o 2 20 pbias i 1 n q i o q i p i 1 n q i o 100 21 l 1 i 1 n q i o q i p q i o q o i 0 l 1 22 rrmse 1 n i 1 n q i p q i o 2 1 n i 1 n q i o 100 where n the number of input samples q i o and q i p the observed and predicted runoff at time t q o and q p the average of the observed and predicted runoff for a perfect simulation of the runoff data at the target site an r value 1 mae rmse rsr 0 and nse 1 is desirable in accordance with literature normally a model is considered to be very good if the nse is 0 75 and rsr is less than 0 50 good performance if ns is 0 65 and rsr is less than 0 6 and satisfactory performance if nse is 0 5 and rsr is less than 0 70 moriasi et al 2007 as a widely used metric the value of r presents the degree to which the predicted and observed runoff are linearly related i e perfectly matched rmse and mae provide the prediction capability where a trivial value is attained by a perfect model rmse that must satisfy the triangular inequality deduces the global fitness and is more appropriate to represent model performance than mae when the error distribution is expected to be gaussian whereas mae provides a more balanced perspective of the goodness of fit based on estimation errors chai and draxler 2014 ns adopts a ranges of and 1 indicating the model relative to the mean observations while rsr varies from optimal value of 0 indicating zero rmse or residual variation and the percent bias pbias measures the average tendency of simulated values to be larger or smaller than the observed values the optimal value of pbias is 0 with low magnitude values indicating accurate predictions and positive values indicating overestimation bias whereas negative values indicate model underestimation bias for further evaluation of the prescribed data driven models three further metrics expanded uncertainty u 95 t statistic and global performance indicator gpi are also computed vi expanded uncertainty u 95 behar et al 2015 gueymard 2014 23 u 95 1 96 s d 2 r m s e 2 1 2 vii t statistic t stat stone 1993 24 t stat n 1 m b e 2 rms e 2 m b e 2 viii global performance indicator gpi stone 1993 25 gpi mbe rmse u 95 t stat 1 r 2 eqs 23 25 provide a complementary evaluation to assess the efficacy of the hybrid cvee elm model by means of a universal metric that combines the predictive power based on mean bias error mbe rmse and coefficient of determination r 2 between observed and predicted runoff in the test dataset 4 results and discussion the two phase hybrid cvee elm model is benchmarked against a single phase cee elm and a standalone elm model for simulating 1 3 and 6 month ahead runoff at yinluoxia station tables 3 6 show the prediction results for the cvee elm compared with the cee elm elm and the univariate arima model in the respective training and testing phases considering the 1 month ahead forecast horizon the performance of two phase hybrid model is seen too far exceed the performance of the single phase cee elm standalone elm and arima model importantly this is true for both the training and the testing datasets for the 1 month ahead forecasted runoff dataset the model in the testing period yielded an r value of approximately 0 981 cvee elm vs 0 970 cee elm 0 926 elm and 0 188 arima whereas the mae rmse is 6 679 9 209 m3s 1 cvee elm vs 8 676 12 253 m3s 1 cee elm 12 580 18 220 m3s 1 elm and 36 413 46 593 m3s 1 arima respectively this result also concurs with a relatively high nse value 0 961 for the cvee elm vs 0 931 for the cee elm 0 850 for the elm and 0 005 for the arima model this result also accedes with a lower value of the rsr 0 197 vs 0 262 0 380 and 9 607 for the respective models another measure of the tested model accuracy the percentage bias error pbias is found to be approximately 2 234 cvee elm vs 7 384 cee elm 5 300 elm and 14 708 arima considering these results the cvee elm model appears to provide accurate and reliable 1 monthly ahead runoff forecasts table 3 when considering the forecasting of runoff at longer lead time horizons it is evident from these results that although the accuracy of the 3 and the 6 monthly ahead runoff is considerably lower than the 1 month forecasts but the results are consistently better for the two phase cvee elm hybrid model relative to a single phase cee elm elm and the arima model similar deductions can also be made when correlation coefficient root mean square error and the mean absolute errors are analyzed a closer comparison of the performance metrics for different lead times shows that the longest lead time i e 6 months results are in fact quite good for the two phase hybrid cvee elm model in terms of a relatively high and acceptable nash sutcliffe coefficient nse 0 875 vs 0 850 0 769 and 0 008 in accordance with moriasi et al 2007 the newly designed two phase cvee elm hybrid model can be considered as a relatively good forecasting model since the nse is 0 75 and the rsr value is less than 0 50 despite a subtly lower performance the single phase cee elm hybrid model can also be attributed to be a good forecasting model since the nse value is 0 850 and the rsr value is 0 386 by contrast the standalone elm model is considerably lower than both hybrid models justified by the nse value of 0 769 and an rsr value of 0 479 in fact the percentage bias error for the standalone standalone elm model is considerably large i e pbias 10 700 against a pbias value of 0 609 cee elm and 3 955 cvee elm which concurs with rmse 22 508 m3s 1 compared to 18 120 m3s 1 and 16 537 m3s 1 respectively it is thus clear that the hybridization of the standalone standalone elm with a two phase decomposition technique i e integrating the ceemdan with the vmd approach contributes to a significant improvement in the forecasting skill compared to a standalone model moreover the two phase approach indicates the possibility of applying such a hybrid model for long term simulation of runoff up to a six month lead time with an acceptable level of accuracy tables 3 5 indeed the better performance of the two phase model in this paper is consistent with studies that were performed elsewhere that also revealed a better utility of the two phase against the single phase and standalone models in context of electricity price and air quality forecasting wang et al 2017a b for all lead times the arima model based on a stochastic framework is unable to predict runoff both in the training and the testing phases and this deduction concurs with results in several other studies where arima model has been applied e g al musaylh et al 2018a wang et al 2015b it is important to note that the present 3 and 6 months ahead simulations which yields better performance of the two phase cvee elm hybrid model with a notable decrease in r and nse and an increase in mae rmse rsr and pbias is compatiblewith the results of other researchers who have modelled hydrological systems at multiple lead timescales e g feng et al 2015 nayak et al 2006 in such studies the skills of their model also appeared to deteriorate with an elongation in the forecasting horizon which is perhaps attributable to a paucity in the overall data patterns at a longer time step wen et al 2016 despite this the shorter 1 month lead time is still considered important for real life applications e g irrigation water allocation hydropower generation and lake water management however it is acknowledged that a longer forecasting horizon such as the 3 6 or even 12 month lead time is desirable for long term hydrological applications e g seasonal farming crop and irrigation management to further explore these results we refer to literature for example the study of kisi 2009 demonstrated that for 1 month lead time lake level forecasting the neuro wavelet model had a smaller value of the rmse and mae by 87 34 and 86 31 for van and egirdir lakes respectively but for 6 month lead time horizon the reduction was only by 34 48 and 30 46 respectively in a study on wavelet analysis ann model for multi scale monthly groundwater level forecasting wen et al 2016 showed that their 2 and 3 month ahead forecasting results were worse than 1 month ahead results in a rather different application i e water demand forecasting at a range of shorter forecast horizons tiwari and adamowski 2013 predicted 1 3 and 5 day ahead water demand using a wavelet bootstrap ann to show that the correlation with observed data deteriorated with an increase in forecast time concluding that there was less feature information at longer lead time horizons in spite of the lower performance of 6 month forecasting models the statistical metrics of the two phase cvee elm hybrid model remained within the threshold of a very good model for runoff prediction moriasi et al 2007 despite the slightly deteriorated accuracy the nse values for 3 and 6 months ahead forecasts were 0 904 and 0 875 and the rsr values were 0 309 and 0 352 respectively indicating that the two phase cvee elm hybrid model achieved very good performances consequently we conclude that the two phase hybrid cvee elm model can attain acceptably accurate predictions for long term runoff simulations while the statistical metrics presented so far have assessed the skill of the two phase hybrid cvee elm model hydrograph and scatter plots are also helpful in evaluating the temporal correspondence of observed data and the model forecasted values fig 3 shows hydrographs and scatter plots of observed and predicted runoff at 1 3 and 6 month lead times by the cvee elm hybrid model in the testing phase to assist with in interpretation of these results a least square regression line y ax b has been included in each panel where the constants a and y intercept b are used to assess the model s overall accuracy obviously the two phase hybrid cvee elm method performs very well for runoff predictions for 1 month lead forecasting which is better than the 3 and 6 month lead time notably the performance for higher lead times deteriorates gradually fig 3 it is clearly evident that the runoff values estimated by the two phase hybrid cvee elm technique are close to the corresponding observed values and follow the same trend in all plots it is also obvious from the fitted equations that the hybrid cvee elm models attain a and b values that lie close to 1 and 0 with higher r2 0 85 for the 1 month compared with the 3 and 6 month ahead runoff forecasting figs 4 and 5 show the hydrographs and scatter plots of observed and the forecasted runoff generated by the cee elm hybrid and eml models in the testing period due to a poor accuracy the arima model has not been shown this reveals that both of these models register relatively good simulation accuracy for the 1 3 and 6 month ahead runoff forecasting compared to fig 3 where the cvee elm model is shown as seen from the fitted equations that the a b coefficients and r 2 the cvee model has a greater accuracy than the cee elm hybrid and the eml model in most tested data cases indicating a significantly better fit this also reaffirms that the cvee elm hybrid model has a better predictive skill than the cee elm and eml models considered in this study peak flow forecasting through a reliable runoff model is important to disseminate information on water resource management and timely flood warning tables 7 9 show the observed and the forecasted peak flows generated by the two phase cvee elm hybrid model applied for the 1 3 and 6 month ahead runoff forecasting relative to cee elm and the standalone elm model the absolute relative error are presented here is calculated based on observed and predicted peak flows we note that the are values range from approximately 1 84 to 18 44 0 25 to 31 38 and 2 72 to 38 45 in terms of the mean value of top 10 runoff data points the present results show that the cvee elm hybrid model generated an error of 7 73 11 59 and 18 74 respectively for the 1 3 and 6 month ahead forecasts moreover despite an inferior results relative to the two phase hybrid model the results also demonstrate a relatively small error encountered in the peak flows generated by the single phase cvee elm hybrid model at 1 3 and 6 monthly timescales compared to the standalone elm model in light of the foregoing discussion one can infer a better feasibility of the two phase cvee elm hybrid model for highest peak flows predicted at the 1 3 and 6 month ahead tests tables 7 9 considering the observed highest peak flow 187 00 m3s 1 the highest peak flows forecasted for 1 3 and 6 month ahead were 179 05 m3s 1 156 98 m3s 1 and 145 79 m3s 1 respectively similarly the highest values that were considerably underestimated were 7 95 m3s 1 30 02 m3s 1 and 41 21 m3s 1 for 1 3 and 6 month ahead simulations respectively fig 6 this can be considered an important limitation of the present research work and concurs with the other studies that have also applied artificial intelligence models for peak runoff flow forecasting e g he et al 2014 kasiviswanathan et al 2016 despite these limitations the two phase cvee elm hybrid model provides highly accurate forecasts relative to the single phase cee elm hybrid and the standalone standalone elm model tables 7 9 while evaluating the utility of a predictive model for its feasibility in runoff forecasting it is not only important to assess the average forecasted error but also the distribution of errors in the entire tested dataset therefore in order to test the robustness of the developed models the error distribution is shown in fig 7 that compares the two phase cvee elm hybrid against the single phase cee elm and the standalone elm model for assessing the degree of dispersion and skewness of the error a boxplot diagram is shown for 1 3 and 6 month ahead runoff forecasting it can be seen that although the single phase hybrid cee elm and the standalone elm model attained small error distributions the two phase hybrid cvee elm model generated smaller errors and the dimensionless residual was smaller than did the counterpart models this is true not only for the 1 month ahead runoff forecasts but also for the 3 and 6 month ahead forecasts therefore the results show that the two phase hybrid cvee elm model is a superior model to the single phase hybrid cee elm and the standalone elm model integrating multiple model characteristics via a universally compact diagnostic plot i e taylor diagram is important to enable inter model comparisons especially in a problem where multiple models are considered the taylor diagram taylor 2001 can enable a hydrologist to graphically summarize how closely simulation matches observed pattern in a test data quantified via correlation centred root mean square difference and amplitude of variation represented by standard deviations fig 8 shows a taylor diagram for the two phase hybrid cvee elm vs the single phase hybrid cee elm and standalone elm model for 1 3 and 6 month forecast horizons where the purpose is to evaluate multiple aspects of models to gauge their relative skills represented in two dimensional space taylor diagram visualizes three model statistics simultaneously i e the centred rmse difference correlation and standard deviation in terms of 26 δ σ f 2 σ r 2 2 σ f σ r r in eq 26 σf and σr are the variances of cvee elm cee elm and elm simulated runoff and the observed runoff respectively in the testing period and r is the correlation coefficient obtained from the cosine of the azimuthal angle determined in accordance with law of cosines taylor 2001 comparing the results of 1 month lead time the two phase hybrid cvee elm model far exceeds the performance of the 3 and 6 month lead times evidenced by its closer position to the observed reference point on the sd axis and smaller rms centred difference fig 8a vs b c for all lead times considered the elm model is positioned the furthest from the reference i e observation point followed by a relatively shorter distance for the two phase hybrid cvee elm model consistent with the trends of 3 and the 6 month lead times fig 8b c and in concurrence with earlier results i e tables 3 8 figs 3 7 taylor diagram justifies superior skills of the dual decomposition based model ceemdan vmd to the single decomposition ceemdan and the standalone elm model interestingly the single phase hybrid cee elm model was positioned closer to the reference standard deviation line than the two phase cvee elm model albeit with a smaller correlation coefficient between observed and forecasted runoff data for greater relevance of results enabling us to compare geographically diverse sites the relative error and the normalized metric legates mccabe index l that present an edge over the nash sutcliffe s coefficient and other metrics in tables 2 4 legates and mccabe 1999 was computed fig 9 presented as a condensed graphic for all lead times and models considered fig 9a reveals the smallest error encountered by the two phase cvee elm hybrid model compared with the single phase and the elm model in fact very significant improvement was attained in the 1 month forecasts with a relative rrmse of 16 10 cvee elm compared with 21 42 cee elm and 31 47 elm this amount less than 20 error accords to a good model attributable to cvee elm a fair model 20 rrmse 30 attributable to cee elm and a poor model rrmse 30 for the standalone elm by contrast for the 3 month lead time forecasts of runoff the hybrid cvee elm and cee elm model could be considered as fair with an error of 24 85 28 43 and the elm model could still be considered as poor 41 38 for the longest lead time 6 months results show that the two phase cvee elm model is fair but the other two models are relatively poor rrmse 30 ertekin and yaldiz 2000 mohammadi et al 2015 when l is assessed fig 9b the two phase hybrid cvee elm model retains its superiority with a value of 0 826 for 1 month 0 724 for 3 month and 0 669 for 6 month lead time forecasting this result utilizing the more robust performance index compared to the nash sutcliffe coefficient legates and davis 1997 legates and mccabe 1999 2013 corroborates with the deductions with respect to single phase cee elm hybrid and the standalone elm model that is the latter models yielded a relatively lower value of l i e 0 778 0 680 0 673 for cee elm and 0 683 0 577 0 582 for elm respectively it is also important to reiterate that that two phase hybrid model produced much accurate forecasts of runoff even for longer lead time horizons of 6 months where a value of l 0 699 was attained see fig 9b moving forward to use a complementary set of model evaluation metrics we show table 10 where the expanded uncertainty u 95 t statistic t stat and the global performance metrics gpi are enumerated note that u 95 facilitates a comparison of models by integrating the standard deviation and root mean square error benchmarked over a 95 confidence interval comparing observed and measured runoff whereas the t stat integrates the mean bias error where the sign of difference remains intact and root mean square error and the universal metric gpi provides an overall assessment in terms of the mean bias error rmse r2 u 95 and t stat considering that for an ideal model the gpi must be close to zero the results show for 1 month simulations the two phase cvee elm hybrid model far exceeds the performance of the counterpart models with gpi 19 5 vs 453 3 799 7 owing to large disparities with respect to a single phase and elm model it is inferred that the two phase hybrid model is a potential candidate for 1 and 3 month forecasting interestingly when the 6 month forecasts results are compared the single phase cee elm model stands out as more superior to the two phase and standalone elm model in concurrence with the taylor plot fig 8c a plausible reason for this is that the standard deviation of the forecasted result by single phase cee elm model was closer to the reference observed line in fig 8c this is perhaps due to the possibility that that the single phase hybrid cee elm model was somewhat more stable as it may have generated runoff data whose rms centered difference was low considering a higher l and a lower relative error fig 9 the two phase cvee elm model is still be a more ideal tool for 6 month runoff prediction overall based on the results we find that the two phase hybrid cvee elm model performs better than do single phase hybrid cee elm and elm models for multi step ahead runoff forecasting and therefore indicating the potential advantage of utilizing the dual phase decomposition technique fig 2 for accurate and reliable runoff prediction used in knowledge based systems 5 conclusions and recommendations for future research work knowledge based expert systems require well designed and cross validated data driven models to attain reliable forecasted data to be used in decision support systems such expert systems that must respond adequately to generate real time i e both short term and long term predictions are able to provide decision makers with the valuable information on future water resources planning and management in arid and semi arid environments in this study we constructed and evaluated a two phase hybrid cvee elm model coupled with a dual integration of the ceemdan and vmd decomposition techniques and the results were consistent with earlier studies applied in different modelling and data contexts al musaylh et al 2018b prasad et al 2018 fijani et al 2019 the resulting two phase model was applied to the yingluoxia watershed region in northwest china to forecast at 1 3 and 6 months ahead runoff predictions and it was also benchmarked with a single phase hybrid cee elm and elm model in the two phase hybrid cvee elm model the original inputs composed of antecedent rainfall and runoff were decomposed into significant imfs and residue signals to facilitate accurate feature analysis and forecasting critical improvements in runoff simulation were induced by the vmd approach decomposing the high frequency imf1 into significant variational modes with the elm was used to predict imfs and vm signals finally the elm was adopted to establish multi step runoff forecasting to evaluate the effectiveness of the two phase hybrid cvee elm model based on statistical and visually represented outputs in the test dataset the two phase cvee elm model was able to successfully forecast 1 3 and 6 month ahead runoff contrasting the performance of the single phase hybrid cee elm and the standalone elm model the two phase model exhibited greater precision and stability although model error was seen to increase with an elongation of the lead time i e 3 and 6 month ahead forecasts in accordance with this evidence we draw the conclusion that the two phase hybrid cvee elm model coupled with ceemdan and vmd decomposition methods integrated into an elm model allows for effective removal of non stationary characteristics associated with original series which makes it difficult for standalone elm model to map the underlying complexity in the antecedent rainfall and runoff data used as the model inputs the remarkable superiority of the two phase hybrid cvee elm was particularly envisioned by extensive analysis of forecasted and observed dataset evidenced by the improved performances the empirical and variational mode decomposition made the modelling realistic where the predictions were made achievable yielding a robust model by segregating low and high frequency components at different time intervals in antecedent data this offered better clarity to the elm model to enhance its ability to forecast runoff without getting deeper into underlying physical relationships or when there are limited input data for driving numerical models moreover the vmd technique had a significant ability to handle noisy and non stationary features in imf1 that was not fully resolved through ceemdan so the dual integration of both vmd with ceemdan led to greater preciseness of the two phase model by contrast the elm had limited ability to handle non stationary inputs resulting in inferior performance it is ascertained that the two phase hybrid cvee elm model can be relevant for complex hydrological data characterization i e better identification of the nonlinearity and irregularity in antecedent rainfall and runoff the two phase hybrid cvee elm model can be explored as a scientific tool employed by hydrologists and decision makers for forecasting long term runoff without the need for underlying the physical relationships and initial condition data required for various interacting elements therefore being especially advantageous for regions with limited measurement data for driving physical models in spite of the remarkable accuracy of the two phase model over comparative counterpart models for multi step runoff simulation the study has limitations that create opportunity for further research in an expert system designed as a real time short term simulation tool the technique should be validated for much shorter term horizons e g hourly or daily step ahead one possibility is also that such a hybrid model can be integrated with a physically based hydrological model to design a nowcasting runoff simulation system such as the csiro waterdyn model awap 2016 raupach et al 2009 where physically based real time output s generated through physical equations using meteorological and hydrological inputs e g radiation temperature and rainfall are analyzed with the ceemdan and vmd technique for run off generation moreover this study has used the ceemdan and vmd techniques for a two layer model but there also exist further opportunity for an independent study to develop and test an improved forecast model by utilizing the improved complete ensemble empirical mode decomposition i e iceemdan al musaylh et al 2018b with the vmd technique as an additional contribution to the present field of study as a future study an ensemble elm model where training and testing data points are re sampled with replacement to create several realizations of the model can provide greater insights into the fluctuations and error bounds of the model an integration of the two phase hybrid model with a feature selection tool employing large sets of satellite and observational modeled atmospheric products dee et al 2011 limaye et al 2014 modis 2016 nasa 2014 may be valuable for runoff modeling in data sparse regions future benchmarks with recent versions of multi resolution tools e g empirical wavelet transform kedadouche et al 2016 peng et al 2017 with improved differential evolution extreme learning machines de elm wang et al 2017b to address randomness non stationarity and irregularity characteristics in expert system based models are all valid research tasks to be undertaken in independent studies acknowledgements this research was funded by national key research and development program of china 2017yfc0404305 key research program of frontier sciences cas qyzdj ssw dqc031 cas light of west china program and the natural sciences foundation of gausu 18jr3ra393 dr rc deo offers sincere thanks to the chinese academy of science presidential international fellowship program 2016 and the university of southern queensland short adosp 2017 research program to enable international collaborations with chinese researchers the authors thank all three reviewers the associate editor and editor in chief for their constructive comments that have improved clarity of the manuscript 
6701,stable isotopes have been used to quantify lake and wetland pond water loss to evaporation by applying the modified craig and gordon 1965 model this model and its derivatives employ simplifying assumptions that ignore the additions of precipitation and infiltration outputs and assume evaporation is the only loss term over the prediction period here we develop a coupled water and isotope mass balance model to account for precipitation additions our model uses physical and isotopic observations to quantify pond evaporation and infiltration losses over the ice free period we tested and applied the model to four wetland ponds at the st denis national wildlife research area saskatchewan canada where we have long term datasets modeled infiltration rates from the ponds ranged between 0 99 and 9 2 mm d and open water evaporation rates ranged between 0 88 and 2 8 mm d both were consistent with independent estimates infiltration amounts were highest in the ephemeral ponds that dry out within days or weeks of the spring melt period in these ponds infiltration exceeded evaporation in permanent ponds that is ponds that do not dry out evaporation exceeded infiltration evaporation amounts were most substantial for permanent ponds that were not sheltered by topography or riparian vegetation overall our coupled water and isotope mass balance model combined with physical and isotope observations was able to quantify the spatially and temporally variable evaporation and infiltration fluxes within and between ponds 1 introduction wetlands provide essential ecosystem services including flood mitigation groundwater recharge sediment and pollutant trapping and fish and wildlife habitat wetland ponds defined as open water areas within wetlands serve as important sources of food and breeding grounds for migratory birds and other living organisms bortolotti et al 2013 in the great plains of north america there are millions of wetland ponds in the so called prairie pothole region hayashi et al 2016 hayashi and van der kamp 2000 steinman et al 2010 the eco hydrological functionalities of these wetlands in this semi arid climate depends on the seasonal water cycle dynamics jolly et al 2008 labaugh et al 1997 1996 labaugh et al 2016 van der kamp et al 2008 van der kamp and hayashi 2009 winter 2000 accurate estimation of water budget components and the accompanying physical and chemical changes in a wetland pond groundwater and riparian zone are essential for calibration and validation of hydrological and biogeochemical models wetlands form in topographic depressions and within the wetland there is often a pond there are five types of wetland ponds found in the north american great plains type 1 and 2 ponds often called temporary or ephemeral are formed in shallow depressions as free surface water after snowmelt or storm events in early spring and summer these may last only a few days or weeks but dry up in the summer type 3 ponds also known as seasonal ponds are characterized by shallow marsh vegetation which generally occurs in the deepest part of the pond these ponds dry up by midsummer type 4 ponds also known as semi permanent ponds maintain surface water throughout the growing season i e from may to september but lack persistence most of the year they are dominated by marsh vegetation at the central zone of the wetland as well as coarse emergent plants or submerged aquatic species including cattails bulrushes and pond weeds finally type 5 ponds also referred to as permanent ponds are ponds that always hold a large volume of open water for most years in the central zone of the pond they are generally devoid of vegetation but submerged plants may be present in the deepest zone while emergent plants such as cattails red swampfire and spiral ditch grass are often found along the edges stewart and kantrud 1971 the water balance of wetland ponds is controlled by meteorological forcing and subject to substantial seasonal and inter annual variability caused by spatially and temporally variable surface and subsurface processes hayashi et al 2016 jolly et al 2008 van der kamp and hayashi 2009 in seasonal drought prone climates like the prairies pond water balances and water residence times are controlled by climate variables and pond area volume and shape benson and paillet 1989 hayashi et al 2016 steinman et al 2010 ponds can be fed by direct precipitation snowmelt and rainfall runoff channelized inflows and groundwater discharge ponds lose water by evaporation infiltration and spillage the spillage occurs when storage exceeds a local threshold usually from either overland flow or channelized outflow spence and woo 2003 spence 2010 pond water infiltration may be transpired by the riparian zone plants lost as soil evaporation and serve as recharge water to the underlying groundwater system the direction of surface water groundwater interactions varies spatially as a function of landscape position and elevation relative to the groundwater heads and temporally as a function of seasonal and inter annual meteorological forcing brannen et al 2015 leibowitz et al 2016 leibowitz and vining 2003 the water balance is the dominant but not exclusive control on the water chemistry of a wetland pond hence seasonal and inter annual changes in pond water chemistry are often explained by dilution by precipitation rainfall over the pond or salt enrichment by evaporation goldhaber et al 2014 heagle et al 2007 labaugh et al 1997 pennock et al 2014 water balance controls on the chemistry of a wetland pond include solute inputs from land surface runoff into the pond plant transpiration and sometimes groundwater discharge and solute outputs to groundwater recharge and or spill dogramaci et al 2015 goldhaber et al 2016 leibowitz et al 2016 leibowitz and vining 2003 nachshon et al 2014 ponds that tend to lose water to the groundwater system i e groundwater recharge ponds have lower salinities than ponds that gain water from the groundwater system i e groundwater discharge ponds labaugh et al 1998 nachshon et al 2014 salama et al 1993 sloan 1972 the long term fluctuations in the chemistry of wetland ponds are caused by multi year wet dry variations associated with meteorological forcing in the region cressey et al 2016 goldhaber et al 2016 2014 labaugh et al 2016 nachshon et al 2014 showed that extreme wet conditions could cause groundwater discharge and surface runoff of salts from an upland area into freshwater ponds resulting in freshwater ponds becoming salinized inadequate knowledge of the climate history and chemistry of a particular pond therefore could lead to a misdiagnosis of the pond s hydrological function by short term observations of pond water chemistry in addition to these water balance controls geochemical and biochemical interactions within a wetland pond and underlying wetland soils may add or remove solutes from the wetland pond water heagle et al 2007 labaugh et al 2016 pennock et al 2014 the implications of these high degrees of spatial and temporal variability combined with complex biogeochemical processes that occur within wetland ponds make it difficult to use chemical ions solutes as useful tracers for estimating hydrological fluxes in such terrain on the other hand stable isotopes which are part of the water molecule are also controlled by the water balance however unlike solutes stable isotopes are unaffected by geochemical and biogeochemical processes in most non geothermal environments and therefore serve as powerful tracers for hydrological studies geyh et al 2000 studies involving the qualitative and quantitative analysis of stable isotopes of surface water bodies have been reported in the prairie pothole region of north america fritz et al 1987 gammons et al 2006 gibson et al 2005 pham et al 2009 steinman et al 2010 wassenaar et al 2011 these studies show that seasonal stable isotope variability within the surface water body is significant and contains useful information about the local hydrological processes but to date few studies gat and levy 1978 pham et al 2009 steinman et al 2010 have used stable isotopes to describe the variability in hydrological function the of different wetland ponds in the prairies and similar seasonally cold semi arid regions globally quantitative models gibson et al 1993 1996 2016 gibson et al 2016 gilath and gonfiantini 1983 1986 jones et al 2005 jones and imbers 2010 skrzypek et al 2015 steinman et al 2010 based on the isotope evaporation equation of craig and gordon 1965 and the large lake water budget equation e g gonfiantini 1986 have been used to describe surface water response to meteorological forcing and to estimate the evaporation to water input ratios in data scarce regions or interpret paleoclimate conditions these models consider the initial and final isotope composition climate data atmospheric water vapour isotope compositions and assume that no new additional water source is added during the study period gibson et al 1993 skrzypek et al 2015 the outputs are the fraction of water lost to evaporation or evaporation inflow ratios in the case of flowing streams or rivers thus in such model formulations the effect of isotope inputs from isotopically distinct water e g rainfall or surface inflow and the volume additions to the system at the time of computing these fractions or evaporation inflow ratios are negligible these assumptions have been justified on the basis that the lake and river volumes were too large to be affected by such additions skrzypek et al 2015 in the existing models leakage under the water body i e water lost by infiltration is negligible and surface area volume ratio remains constant even as the water levels decline with time overall these assumptions are problematic for areas where rainfall over small lakes and ponds are significant where ponds leak through infiltration and when water levels decline or increase these changes can significantly alter the isotope composition of the surface water body and could significantly impact the flux estimates produced from the existing models in some previous studies e g gibson 2002a b gibson et al 2016 gilath and gonfiantini 1983 gonfiantini 1986 the idea to include volume and isotopic changes basin area and shape and infiltration components into the model has been discussed later studies involving individual modelling experiments e g gibson et al 2016 gibson 2002a b jones et al 2005 steinman et al 2010 have incorporated some or all three factors into the model formulation these new formulations however were done on limited scales to suit local needs and therefore difficult to generalize and apply elsewhere for example to reduce the uncertainty in evaporation inflow ratios gibson 2002a b estimated and incorporated lake shape and size parameters into the water balance equations when considering the different lakes of northern canada jones et al 2005 addressed the effect of basin shape and surface area changes in the model to recalibrate isotope records from a lake in nar golu in turkey steinman et al 2010 considered the effect of infiltration under cone like lakes and also implemented the geometric changes associated with the surface area to volume changes in a paleoclimate study in the upper columbia river basin of the united states rozanski and chmura 2008 in a laboratory study showed that a key parameter controlling isotopic enrichment is leaking containers is the remaining fraction of water in the container thus these findings suggest collectively that neglecting the impact of infiltration pond shape size and the surface area to volume ratio of small water bodies in estimating evaporation fluxes from isotope water mass balance models will result in significant errors of the individual water balance components in this work we take the critical next step to develop a new physically based isotope water mass balance model that takes into consideration inputs from precipitation and losses to infiltration with accompanying bathymetry changes in a generalizable model our goal is to interpret the differences in stable isotope composition of various types of wetland ponds and hence to describe their differing hydrologic regimes we leverage two decades of hydrometric climate and isotope data collected from a variety of saskatchewan wetland ponds to understand and model the isotopic changes and estimate water mass balance components of the prairie wetlands we perform this work at the well studied st denis national wildlife area bortolotti et al 2013 hayashi et al 2016 nachshon et al 2014 pennock et al 2014 van der kamp and hayashi 2009 near saskatoon our objectives are to i explore the stable isotope composition records of wetland ponds to characterize their hydrologic function ii develop a new coupled physically based isotope and water mass balance model that takes into account rainfall additions which result in volume and isotope composition changes and different pond geometries for the ice free summer season and accounts for infiltration losses iii test the model sensitivity to changing pond geometries and climate parameters and iv compare the model results with independent estimates of evaporation infiltration and storage from existing methods and isotope water mass balance models where feasible 2 study site and field methods 2 1 the study site field data was collected between may and october starting in 1994 at the 385 ha st denis national wildlife area sdnwa 52 8 n 106 8 w in the canadian prairies fig 1a the area and location of wetlands at the sdnwa is shown in fig 1b with the wetlands studied identified in numbers the site is 40 km east of saskatoon saskatchewan canada the sdnwa was established in 1968 as a long term study site for the environmental and ecological monitoring of the prairie wetland complex hogan and conly 2002 there are close to one hundred ponds of varying size and hydrological seasonality at the sdnwa woo and rowsell 1993 van der kamp and hayashi 2009 the climate is semi arid with significant inter annual variability in precipitation and temperature during the summer april september and winter october march months the mean annual non adjusted for wind caused under reported winter snowfall precipitation at saskatoon is 360 mm with about 280 mm occurring as rainfall in april october nachshon et al 2014 parsons et al 2004 the monthly mean temperature varies between 14 7 c in the period december to february and 18 7 c in the period between july and august wittrock and beaulieu 2015 just like other prairie sites the annual lake evaporation exceeds the total annual precipitation parsons et al 2004 the arithmetic mean estimate for a twenty four year monthly integrated record of isotopes in precipitation for saskatoon is 17 0 and 131 0 for δ 18 o and δ 2 h respectively the amount weighted mean values of δ 18 o and δ 2 h for the period june 1990 november 2014 are 14 4 and 112 5 respectively the summary of the values of monthly amount precipitation temperature δ 18 o δ 2 h and the local saskatoon meteoric water line for the period 1990 2014 is given in fig 2 the monthly integrated isotopes in precipitation data is available in bam et al 2018 the study was conducted at pond 50 109 117 and 120 the wetlands were selected based on previous wetland pond classification of stewart and kantrud 1971 ephemeral pond 117 semi permanent pond 120 and permanent pond 109 and 50 ponds 109 117 and 120 can be described as recharge ponds since they have hydraulic head values that are elevated above the potentiometric surface of the underlying confined aquifer system bam 2018 pond 50 has a hydraulic head that is more or less at the same head stage with the underlying regional intertill aquifer and is therefore neither a recharge pond nor a discharge pond bam 2018 a hydro meteorological tower near pond 109 on the site collects half hourly measurements of air temperature relative humidity and precipitation at 2 m and 10 m heights for the 2014 season 2 2 hydrological measurements the water level in the pond was measured manually and in later years using logged pressure transducers at georeferenced poles installed within the wetlands conly et al 2004 the measured water levels were converted to depth of water in meters at the deepest location in the wetland the area a m2 and volume v m3 of surface water stored in the wetland was estimated using the equations described in hayashi and van der kamp 2000 and hayashi et al 2016 as a function of water depth k m 1 a s k 2 β 2 v s k 1 2 β 1 2 β where s m2 is a scale parameter equal to the pond surface area when the depth is 1 m and β is parameter the defines the shape of the idealized pond cross section where β 1 is an inverted cone β 2 is a parabola and larger values represent a bathtub shaped basin with a flat bottom and steep sides hayashi and van der kamp 2000 the constants s and β were determined using bathymetry survey data of ponds 50 109 117 and 120 see hayashi and van der kamp 2000 heagle et al 2013 and updated survey of 2009 van der kamp pers commun meteorological data for sdnwa was collected from the global water institute climate tower installed at the site 2 3 water sampling and isotope analysis wetland pond water samples were collected every two weeks and sometimes monthly during the ice free summer season april october of 2014 pond water samples were collected about 2 m from the bank at depths well below the pond water surface into the narrow mouth 50 ml polypropylene pp bottles and sealed wetland pond temperature at various locations suggests that the pond water was well mixed rainfall samples were collected from dry wet rain gauges that were filled with small amounts of paraffin oil to minimize evaporation of rainfall samples the rain gauges were emptied in between rain events the location of the rain gauges is indicated in fig 1b the amount and isotope compositions of precipitation from these gauges at the sdnwa were used for comparison with saskatoon records the amounts recorded during the period was used in 2014 model calculations all water samples were transported to the stable isotope laboratory at the national hydrology research centre saskatoon the samples were left for debris to settle before stable isotopes analysis the samples were then analyzed for 2h 1h and 18o 16o ratios using a los gatos research dlt 100 liquid water isotope analyzer system coupled with a ctc lc pal liquid autosampler los gatos inc california following the procedures in lis et al 2008 and iaea 2009 the isotope values are reported in the usual δ notation in vs vienna standard mean ocean water vsmow samples standards and control samples river water were analyzed repeatedly six times and the average value of the last four measurements was determined iaea 2009 the internal laboratory standards inv1 δ 2h 220 0 δ 18o 28 5 and rod3 δ2h 8 0 δ18o 1 2 were calibrated to the vsmow2 and slap2 reference waters and used to normalize the results to the vsmow slap scale the laboratory analytical precision is approximately 0 2 for δ 18o and 1 0 for δ 2h respectively lis et al 2008 the stable isotope ratios of water collected between 1990 and 2007 i e precipitation and pond samples were analyzed using isotope ratio mass spectrometers irms the protocols for the isotope ratio mass spectrometer analysis follow the standard methods begley and scrimgeour 1997 coleman et al 1982 eiler and kitchen 2001 epstein and mayeda 1953 karhu 1997 kelly et al 2001 socki 1999 the water samples for oxygen isotope analysis were prepared by conventional h2o co2 equilibration epstein and mayeda 1953 about 5 ml of each sample was equilibrated with co2 gas at 25 0 1 c for 24 h the co2 gas was cryogenically extracted and purified in a vacuum line for deuterium analysis cr at 850 c was used to produce hydrogen gas coleman et al 1982 both 18o 16o and 2h 1h ratios were determined relative to internal standards that were calibrated using vienna standard mean ocean water v smow the data were normalized and reported in the delta notation coplen 1988 the analytical reproducibility is 0 1 and 1 0 for δ 18o and δ 2h both offline dual inlet i e zinc reduction or uranium reduction and continuous flow irms methods i e cr reduction or c reduction have measurement accuracies of the order of 0 5 to 4 for δ 2h and the automated cf irms methods such as c reduction to co and co2 h2o equilibration were between 0 1 and 0 4 for δ 18o lis et al 2008 2 4 archived data wetland pond water depths water temperature and isotope data obtained from 1991 to 2016 and maintained by the national hydrology research centre saskatoon was used to complement our data pond area volume and shape factors obtained from the survey data of van der kamp 2009 personal communication and other relevant data found in published works hayashi et al 2016 hayashi and van der kamp 2000 heagle et al 2013 heagle 2008 were also employed in pond bathymetry evaluations the precipitation records relative humidity and atmospheric temperature measurements of saskatoon are available from saskatchewan research council climate records http climate weather gc ca climatedata dailydata e html stationid 47707 all the other data used in this study can be obtained from the federated research data repository at https doi org 10 20383 101 0115 3 wetland pond water and isotope mass balance model 3 1 model development the variables used in this model are given in table 1 the water balance equation for a wetland pond is given as 3 dv dt a p j o e where a m2 is the area of open water of the pond dv m3 d is the change in volume of water in pond over the time period dt d p m d is direct precipitation into the pond j m d is the lumped surface and subsurface inflow o m d is the lumped surface and subsurface outflow and e m d is the direct evaporation from the pond surface the change in isotope mass in the pond is expressed as 4 d v δ dt a j δ j p δ p o δ o e δ e where δ is the isotope composition δ 18 o or δ 2 h and subscripts relate to the water balance equation components defined above and δ with no subscript refers to pond water eqs 3 and 4 can be applied to any surface water body in general inflow terms i e surface run in and groundwater discharge j may carry isotopically distinct waters and hence modify the isotopic composition of the water body outflow terms i e spillage soil infiltration and plant transpiration o remove water without modifying the isotopic composition of the water body and e removes water and modifies the isotopic composition of the remaining water in the pond in small well mixed relatively shallow and seasonally dynamic ponds such as found in the north american prairies during the ice free summers some simplifying assumptions about these terms can be made we can assume that j 0 and that water input into the pond is due only to rainfall on the pond p we can also assume that all the water loss as outflows o is infiltration which subsequently goes to soil water groundwater recharge and transpiration the justifications for these assumptions are stated below the primary input of water to the ponds other than direct rainfall comes from snowmelt runoff into the pond for the period after the snow and ice melt that the analysis of this paper is restricted to the surface runoff processes that deliver water into the pond are ignored and we use initial conditions based on the water levels and isotopic compositions caused by the snowmelt runoff heavy rainfall events can also cause surface runoff to occur though these are historically fairly rare coles et al 2017 in our dataset there was one year i e 2014 when this did happen and in that case the model was initialized after the rainfall runoff event for ponds that receive a significant amount of water from groundwater input that is discharge ponds as noted in nachshon et al 2013 it would be necessary to estimate the amount of discharge water into the pond and the corresponding isotope composition of the groundwater if this model will be applied to simulate water balance fluxes that is a significant challenge worthy of further research but not addressed here in this study we considered recharge ponds and therefore we do not include groundwater inflow regarding pond outflows it is not necessary to assume that soil infiltration and plant transpiration termed here infiltration is the only outflow but we do so here because we know that the ponds selected did not spill during the period studied a significant amount of the infiltration that occurs below ponds go to support riparian zone transpiration nachshon et al 2013 with the remainder going to groundwater recharge and soil evaporation bam 2018 millar 1971 parsons et al 2004 however water lost to both riparian zone plant transpiration soil and groundwater recharge from the pond does not induce isotope fractionation in the pond water gibson and edwards 2002 jasechko et al 2013 rothfuss et al 2010 yepez et al 2003 and so that process has not been represented explicitly in this model thus the infiltration reported is responsible for lateral seepage to transpiring marginal vegetation soil evaporation and vertical seepage as groundwater recharge to constrain each flux from the infiltration component into transpiration soil evaporation and groundwater recharge a coupled solute isotope water mass balance method e g dincer et al 1979 or independent measurement of evapotranspiration at the site is required at this stage we did not attempt to distinguish how this flux infiltration is partitioned between groundwater recharge soil evaporation and plant transpiration fluxes even though it is a significant hydrological problem substituting j 0 and δ o δ reduces eqs 3 and 4 to eqs 5 and 6 respectively 5 dv dt a p o e 6 v d δ dt δ dv dt a p δ p o δ e δ e replacing dv d t in eq 6 with eq 5 yields 7 v d δ dt δ a p o e a p δ p o δ e δ e which reduces to 8 d δ dt a v p δ p δ e δ e δ while the terms a v p δ and δ p can be measured directly in the field or laboratory e and δ e cannot the isotopic composition of moisture evaporating from the surface a lake δ e is estimated by a linear resistance model of craig and gordon 1965 as defined gammons et al 2006 horita et al 2008 9 δ e 1 1 h δ 1000 δ α h δ a δ 1000 where and δ are the equilibrium and kinetic isotopic separation between liquid and vapour respectively α is the fractionation factor and h is the relative humidity the craig and gordon 1965 model was developed to describe the isotopic fractionation associated with evaporation the model assumes the atmosphere above a given liquid surface to be three discrete layers i a saturated sublayer with 100 relative humidity that attains isotopic equilibrium at the liquid air interface ii a laminar layer less than 100 relative humidity above the liquid air surface layer 1 where vertical transport of water molecule due to molecular diffusion across the humidity gradient results in isotopic fractionation and iii a turbulent atmosphere where turbulent transport dominates with no isotopic fractionation the equilibrium isotopic separation between liquid and vapour is calculated as gonfiantini 1986 10 1000 α 1 where α is the fractionation factor which is a function of temperature t k the equations of the liquid water vapour fractionation factor valid between 0 and 374 c were obtained from laboratory experiments and are given for δ 18 o and δ 2 h as follows horita and wesolowski 1994 11 ln α 18 o 10 3 7 685 6 7123 10 3 t 1 6664 10 6 t 2 0 35041 10 9 t 3 12 ln α 2 h 10 3 1158 8 t 3 10 9 1620 1 t 2 10 6 794 84 t 10 3 161 04 2 9992 10 9 t 3 the equivalent kinetic isotopic separation based on wind tunnel experiments is calculated from araguas araguas et al 2000 13 δ 1 h θ n c k where n 0 5 for a rough surface e g open water bodies and n 1 for soil water θ 1 h o 1 h is an advection term to account for the potential influence of humidity buildup h o is the adjusted humidity of the downwind atmosphere following admixture of evaporating moisture over the surface often set to θ 1 for small water bodies and c k is the kinetic fractionation constant which is 28 6 and 25 0 for oxygen 18 and deuterium respectively as a result we have here 14 δ 18 o 14 2 1 h 15 δ 2 h 12 5 1 h if the relative humidity h is measured near the pond lake it must be normalized to reflect the relative humidity over the pond surface under saturated conditions the saturated vapour pressure e s kpa can be estimated from allen et al 1998 16 e s 0 6108 e 17 27 t 273 t where t kelvin is the temperature measured near the pond the normalized relative humidity h is calculated from the ratio of e s in air e sa and e s in water e sw based on temperature measurements and multiplied by the relative humidity measured near the pond lake the ambient atmospheric water vapour isotope composition δ a can be measured directly estimated from precipitation values or calculated from local evaporation lines of surface water within the catchment clark and fritz 1997 gammons et al 2006 gibson and reid 2014 jacob and sonntag 1991 skrzypek et al 2015 the ambient atmospheric water vapour isotope compositions δ a used here were calculated using the local evaporation lines section 3 2 of each ponds in a given year now substituting eq 9 the equation for estimating the isotopic composition of the evaporating water into the isotope water mass balance equation eq 8 yields 17 d δ dt a v p δ p δ e 1 h δ 1000 δ α h δ a δ 1000 e δ factorizing and re arranging gives 18 d δ dt a v p δ p δ e b c δ where 19 b h δ a δ 1000 α 1 h δ 1000 and 20 c h δ 1000 1000 α 1 h δ 1000 integrating eq 18 with respect to the isotope composition of the pond water δ and time t gives 21 δ t δ i e a p a e c t v eb p δ p p e c 1 e a p a e c t v δ i refers to the initial isotopic composition of the pond estimating the water balance using the wetland pond water level we substituted eqs 1 and 2 into eq 5 resulting in 22 d dt s k 1 2 β 1 2 β 1 s k 2 β p o e integrating with respect to t and factorizing we have 23 k t k i p t o t e t 2 2 β 1 k i refers to the initial water level of the pond eqs 23 and 21 solve the water balance and isotope water mass balance respectively the water balance equation simulates the pond water level given some specified total water loss from the pond e and o combined thus given observations of pond levels inverse modelling can be used to identify the total loss i e e o but not the partitioning between these variables similarly the isotope water mass model takes some specified e to simulate the pond isotope composition given observations of the pond isotope composition inverse modelling can be used to identify e and hence o inverse modelling was achieved here by optimization minimizing the root mean squared error rmse of pond level stage 1 or pond isotopic composition stage 2 by changing e o stage 1 and e stage 2 optimization was performed in python 2 7 using the scipy function fmin which uses a nelder mead simplex algorithm https docs scipy org doc scipy reference generated scipy optimize fmin html this model can be used to i estimate e and o from a specific pond from past observations of pond climate variables or to ii project pond isotope compositions into the future given some prescribed partitioning of e and o along with projections of the hydrometeorological variables the model scripts are attached as supplementary material s1 in the appendix this script was written and run in python 2 7 2 python software foundation us 2011 and reads input data from microsoft excel files the code and all the data set can be found at https github com amireson prairiepondmodel 3 2 stable isotope composition of ambient atmospheric water vapour the isotope composition of ambient atmospheric water vapour δ a can be measured directly estimated from precipitation values or calculated from local evaporation lines of surface water within the catchment clark and fritz 1997 gammons et al 2006 gibson and reid 2014 jacob and sonntag 1991 skrzypek et al 2015 here δ a was computed using the pond evaporation lines lel table 2 obtained from the multiple measurements of the isotopic changes within each individual wetland pond bennett et al 2008 gibson et al 2008a b 2016 gibson and reid 2014 skrzypek et al 2015 because the isotopic compositions of pond water in the prairie environment is strongly influenced by seasonal climatic effects i e figs 3 and 4 resulting in highly seasonal evaporation rates the ambient atmospheric water vapour is calculated assuming the atmosphere is in equilibrium with precipitation during the evaporation season gibson 2002a b 2016 thus an effective precipitation vapour separation effective gibson et al 2016 is assumed where the evaporation line slope and the effective isotopic separation between amount weighted precipitation falling near the intersection of local evaporation line and meteoric water line and the evaporation flux weighted moisture is less than the equilibrium separation the δ a was estimated from local records of the spring summer rainfall stable isotope composition δ p as follows bennett et al 2008 gibson et al 2016 gibson and reid 2014 skrzypek et al 2015 24 δ a δ p x 1 x 1000 where δ p is the stable isotope composition of rain δ 2 h and δ 18 o and is the equilibrium isotopic separation between liquid and vapour which depends only on temperature as described in eqs 10 12 horita and wesolowski 1994 initially eq 24 was solved using x 1 0 and then the slope of lel was calculated from eq 25 25 slope lel h δ ha 2 δ 2 h p 1000 ε 1000 1 δ 2 h p 1000 h ε 1000 h h δ oa 18 δ o p 18 1000 ε 1000 1 δ o p 18 1000 h ε 1000 o where h is air relative humidity given as a fraction ε is the total fractionation factor and equals the sum of the equilibrium isotope fractionation factor as given above plus the kinetic isotope fractionation factor δ gibson and reid 2010 26 ε α δ the calculation was then repeated a number of times using x between 1 0 and 0 1 the final δ a values were selected from the x parameter that gave the lowest difference between the calculated slope of lel eq 25 and the observed slope of lel obtained from field measurements in this case x reached the boundary values between 0 6 and 1 0 the slope of lel and the final δ a values for the ponds table 2 were generally within the range of values reported from the global basis analysis of the international atomic energy agency s global network for isotopes in precipitation database gibson et al 2008a b 3 3 sensitivity analyses sensitivity tests were run to determine the effects of variations in the climatic variables i e relative humidity h atmospheric vapour composition δa precipitation p and temperature t and pond bathymetry parameters i e s and β on the modeled pond isotope composition δ t sensitivity simulations were conducted on a monthly time step for the 2014 model year for pond 109 a univariate sensitivity analysis was performed using baseline pond parameters and average values of the climatic parameters obtained from the site the effect of each parameter on the model was tested one at a time by increasing and decreasing the parameters to a high and low value the parameters were varied by some percentage margins based on the approximate range of values that can be measured in the region the model sensitivity to the variations in each parameter was tested between the period of 22nd may and 16th september 2014 for the sensitivity analyses e o the total water outflow was fixed at an arbitrary value that ensured a reasonable water balance and the ratio e e o i e evaporation to total water outflow was varied from 0 1 i e infiltration dominates to 0 9 i e evaporation dominates 3 4 model application to sdnwa the model was applied to estimate e and o for four ponds at the sdnwa one ephemeral pond 117 one semi permanent pond 120 and two permanent pond 50 and 109 the model driving data is given in table 2 since the model assumes there is no input to the pond other than from direct rainfall it was be initiated after snowmelt or any major rainfall runoff into the pond the initial conditions for the model are the water level and the isotopic composition of the pond water the start and end date for each simulation i e for each pond and each year was chosen based on the periods where there were minimal surface runoff into the pond during the summer the simulated years 1994 1997 1998 1999 and 2014 were the years for which pond water levels isotope and climate data were available table 2 summary of average climate parameters isotopic and basin bathymetry of ponds tested using the new water and isotope water mass balance model at st denis national wildlife area saskatchewan the δ represent average isotope compositions of precipitation and ambient atmospheric moisture s and β are the pond bathymetric parameters used in eqs 1 and 2 3 5 model comparison with existing craig gordon based models an existing model for estimating the evaporative loss of water from a surface water body using stable isotopes is available through the hydrocalculator software skrzypek et al 2015 the software is a compilation of the existing isotope water mass balance models that employed the craig and gordon 1965 model to compute the isotope composition of the vapour from the surface of an evaporating water body these isotope water mass balance models are available in two formulations i the steady state configuration hereafter the hcss model which aims to look at the long term response of a water body under steady conditions where the inflow equals the outflow and there is no change in storage and ii the non steady state configuration hereafter the hcns model the hcss model aims to look at the long term response of a water body under steady conditions where the inflow equals the outflow and there is no change in storage the hcns model aims to look at the short term response of a water body when there is a change in storage but the only loss term is due to evaporation the primary advantage of these models over our model is that much less observational data are required and it is therefore useful to get estimates of evaporation from large water bodies in data scarce areas however for small prairie ponds the assumptions are not appropriate the isotopic composition of the precipitation has an enormous impact on the pond isotope composition the pond storage changes are highly significant with ponds often wholly emptying and the water loses are due to infiltration as well as evaporation none the less we aimed to compare the average evaporation estimates from these two models hcss and hcns with our estimates to see how appropriate these simpler approaches are for small dynamic prairie ponds we note here average estimates from the hydrocalculator software because the output of evaporation ratios are based on the single isotope i e δ 18 o and δ 2 h 4 results 4 1 stable isotope characteristics of prairie wetlands fig 3 shows the temporal variation in stable isotope compositions and pond depth as monitored in prairie wetlands from 1993 to 2016 spring fall seasons the water level is at its maximum after snowmelt when the isotopic enrichment is minimum throughout the summer water levels drop via a combination of evapotranspiration and infiltration isotopic enrichment develops progressively in response to evaporation fig 4 shows continuous δ 18 o and δ 2 h enrichment in of the ponds between the years 2010 to 2016 fig 4 also shows gradual enrichment in the water isotope compositions of δ 18 o and δ 2 h with time and within the ponds from the spring may to the fall september the water stable isotope compositions found in the permanent ponds 50 and 109 are generally enriched even at the start of the season that is the onset of the spring season fig 5 shows a scatter plot of pond isotope values to examine the effect of evaporation on the wetland ponds for four wetland ponds 50 109 117 and 120 at the st denis national wildlife area the pond isotope values fall below the saskatoon local meteoric water line defining local evaporation lines slopes between 5 2 and 6 4 4 2 model sensitivity the results of the sensitivity tests are shown in fig 6 as contour plots of how the isotope compositions of the pond water change as we impose changes in the relative proportion of evaporation to total pond losses i e evaporation plus infiltration and with perturbation to the parameter values the baseline condition i e the center column in each of the subplots shows how the pond isotope composition is progressively enriched as the proportion of evaporation increases the parametric perturbations are shown in the left and right columns in the same subplots and the more sensitive a parameter is the more these contours deviate from the baseline contour the contours in fig 6 suggest that the model is highly sensitive to both relative humidity and atmospheric water vapour isotope composition both of these parameters will have a significant impact on surface water hydrological flux estimates and pond isotope compositions the effect of precipitation additions and temperature are similarly sensitive when the values of these parameters are estimated close to 50 of the original values the model is also moderately sensitive to changing pond basin profile β but relatively insensitive to pond scale parameter s these observations are similar to those reported in earlier studies gammons et al 2006 gat 1995 gibson et al 1993 gibson 2002a b gonfiantini 1986 steinman et al 2010 minimizing errors in measurement of the sensitive parameters and assumptions about how these parameters vary with time will reduce uncertainty and improve model outputs 4 3 model application to sdnwa the comparative results for model outputs and field observations are shown for the permanent ponds 50 and 109 the semi permanent pond 120 and ephemeral pond 117 respectively in fig 7 the root means squared error rmse values for simulated model outputs and field observed data ranged between 0 00 and 0 29 m for pond water levels and 0 02 and 0 10 for isotope composition values in all ponds table 3 shows the water balance and the estimated partitioned fluxes of open water evaporation and infiltration pond 109 a permanent recharge pond has infiltration rates between 2 3 and 4 8 mm d and evaporation rates of between 0 74 and 1 6 mm d the ratio of evaporation loss to total water loss e e o ranges from 13 to 40 mean of 30 which shows that infiltration is the dominant loss on average accounting for approximately two thirds of the total loss pond 50 also a permanent pond but not a recharge pond has infiltration rates of between 0 99 and 1 3 mm d and evaporation rates between 0 97 and 2 8 mm d evaporation losses account for 43 74 mean of 60 of all water losses from pond 50 and evaporation is therefore the dominant loss on average accounting for approximately two thirds of the total water loss infiltration rates under the ephemeral pond 117 and the semi permanent pond 120 were 9 2 and to 5 8 mm d respectively markedly higher than the permanent ponds in 2014 when isotope values and water levels in all ponds were measured evaporation rates in 2014 from ponds 117 and 120 were of a similar magnitude at 0 88 and 1 2 mm d respectively in the ponds 117 and 120 infiltration strongly dominate the water balance accounting for 91 and 83 of water loses respectively 4 4 model comparison with the existing craig gordon based models the hcss model assumes steady state conditions in the pond inflow equals total outflow no change in storage and the model outputs the fraction of evaporation over inflow e i the hcns model assumes transient conditions storage drops over time and the only loss is due to evaporation and the model outputs the fraction of evaporation to initial storage e k i we used the hydrocalculator software to output these fractions separately for δ 18 o and δ 2 h data data used are provided in supplementary material s2 and table 2 for both models the average fractions were then used to calculated average e values for each model table 4 shows the evaporation rates estimated by the hcss hcns and our model 5 discussion 5 1 stable isotope characteristics of prairie wetlands in the canadian prairies wetland ponds accumulate substantial amounts of snowfall and snowmelt runoff water during the winter and spring melt seasons they tend to lose this water to evaporation and infiltration during the summer period the result of course is the regular seasonal variations in water levels as shown fig 3 the stable isotope compositions of ponds also follow predictable seasonal patterns in spring the pond water is depleted due to additions of isotopically light snowmelt and through the summer months the waters are progressively enriched by evaporation fig 4 we found that δ 18 o and δ 2 h in the permanent ponds were generally more enriched and less variable compared with the isotope composition of the semi permanent and ephemeral ponds at the start of the spring season we attribute the more positive values of δ 18 o and δ 2 h in the permanent ponds to the presence of large volumes of evaporated water retained from the previous year s snowmelt δ 18 o and δ 2 h signatures are more negative than the residual evaporated pond water from previous years the mixing of the residual evaporated waters with the snowmelt water of the spring season results in the enriched δ 18 o and δ 2 h signals found in the large and permanent ponds at the start of the season spring this is different to the isotopic composition in the semi permanent and ephemeral ponds where little or no evaporated water is retained from the previous season consequently light snowmelt water serves as the initial water source for the ephemeral ponds and as a result these ponds generally show more negative δ 18 o and δ 2 h compositions these differences in the early spring isotope compositions observed in different pond types suggests that the seasonal δ 18 o and δ 2 h isotope compositions could be used to distinguish the hydrologic process behaviour in this region between may to late october fig 4 there was consistent progressive enrichment in δ 18o and δ 2h for all ponds due to evaporation in the pond this evaporation effect is reflected in the lower slopes in dual isotope space for the pond evaporation lines fig 5 the lower slopes of these evaporation lines compared to the local meteoric water line is as a result of kinetic fractionation induced by the evaporation process in an environment of relatively low humidity clark and fritz 1997 gammons et al 2006 we hypothesize that the differences in the slopes of the local evaporation lines of the ponds table 2 are as a result of several factors vegetation cover around the pond evaporation rate from the ponds the volume of water and isotope composition of water stored from previous years and whether or not the pond is losing or gain water to groundwater 5 2 model performance and sensitivity the rmse values for simulated model outputs and field observed data suggests that the performance of the model is reasonable for simulating both isotope compositions and water levels the errors are generally of a similar in magnitude to the lowest analytical precision for δ 18o and δ 2h measurements which is 0 2 and 1 0 respectively lis et al 2008 and the observational accuracy in determining maximum water depth from ponds which are mostly within 50 mm conly et al 2004 the comparison of water balance components between different types of wetland ponds shows that infiltration rates are highest in the ephemeral semi permanent pond 117 and 120 lower in the permanent recharge pond pond 109 and lowest in the largest permanent pond pond 50 the observation is consistent with our understanding of how these ponds function in the landscape stewart and kantrud 1971 hayashi et al 1998 van der kamp and hayashi 2009 heagle et al 2013 the relatively high evaporation rate from the larger pond pond 50 is attributed to the larger surface area and the relatively high exposure of the pond to wind and radiation compared with the more sheltered recharge pond 109 the model is most strongly affected by changes in relative humidity of the free vapour h fig 6a with 15 changes in h a considerable difference can be seen between the isotope compositions of the remaining pond water and the baseline isotope composition the influence of h on kinetic fractionation process that occurs during evaporation of water vapour from surface water bodies are noted in eqs 9 13 19 and 25 this influence is directly related to the changes in the pond evaporation lines and hence the ambient atmospheric water vapour composition and the final hydrologic balance of the pond decreasing the relative humidity by 15 results in more enrichment of the isotopic composition of the remaining pond water the atmospheric water vapour isotopic composition δ a also exerts a strong impact on the model although to a lesser degree than h changes in surface water isotope composition are driven by turbulent diffusion mass transfer mechanisms and humidity eqs 9 17 and 25 kinetic fractionation during non equilibrium evaporation of water as the result of the enhanced diffusion of the lighter isotope 1h2 16o relative to heavier isotopologues 1h2h16o and 1h2 18o from the boundary layer to the open air clark 2015 gat 2008 field observations and laboratory experiments craig et al 1963 gat 1995 kumar and nachiappan 1999 have shown that an isotopic build up will continue until the difference between the isotopic composition of the water body and that of its evaporate reaches isotopic equilibrium equilibrium isotopic conditions are unlikely in the field as wind continuously replaces the air above the pond this means that the ambient atmospheric isotope composition has a strong impact on the estimated hydrological fluxes future work should focus on more accurate ways of evaluating this variable precipitation p was moderately sensitive in controlling differences in the pond isotopic composition as a simple function of dilution or mixing as seen in eq 21 temperature t was also moderately sensitive t influences evaporation rates and fig 6 shows that this is due to the direct control of t on the liquid vapour equilibrium fractionation factor for evaporating water eqs 11 and 12 the impact of precipitation amount and temperature on the isotope composition of the remaining pond water is unsurprising and the effect of temperature on the isotope composition of lake water and precipitation in the mid and high latitude regions is well documented dansgard 1964 gat 1996 rozanski et al 1992 air temperature also influences evaporation however there are potential feedbacks that complicate such influence for example evaporation from an large lake or transpiration from the riparian vegetation around the pond may suppress air temperature and reduce pond evaporative losses alternatively a smaller pond at the same temperature may see increased evaporation with less vegetation cover mohammed and tarboton 2011 the pond scale parameter s determines the overall size of the pond surface area as a function of pond depth and is a relatively insensitive parameter conversely the pond profile parameter β which determines the form of the relationship between area and depth is highly sensitive the insensitivity of the pond scale parameter s which determines the overall size of the pond surface area as a function of pond depth is not surprising because the substitution of the expressions for a and v eqs 1 and 2 into eq 8 cancels s out conversely the highly sensitive nature of the pond profile parameter β suggests the shape of the ponds area depth and volume is essential for estimating flux losses it follows therefore that the simplifying assumption that the pond area remains fixed as the depth changes are unsuitable for relatively small ponds as considered in this study the isotope mass balance model is most sensitive to controls of relative humidity atmospheric water vapour isotope composition and pond shape roughly in that order these factors are followed by precipitation amount temperature and pond scale reducing the errors in measurement of the most sensitive parameters and applying the correct assumptions about how these parameters vary with time will improve this model 5 3 comparison with field observations the pond infiltration rates vary from 0 9 to 9 2 mm d between years and between ponds these infiltration rates are comparable to darcy flux calculations of 0 83 1 38 mm d by woo and rowsell 1993 and residual curve flux estimate by hayashi et al 1998 for sdnwa on the order of 9 4 mm d work by parsons et al 2004 in 1999 used tracer mass balance estimates to calculate infiltration and found flux rates in the range 1 7 4 5 mm d the variability in these infiltration estimates can be likely explained by 3 factors 1 pond type i e ephemeral temporal or semi permanent or permanent 2 antecedent moisture content of the substrate beneath the wetland pond before snowmelt and 3 the meteorological conditions during the melt period granger et al 1984 hayashi et al 2016 studies have shown that infiltration rates under ephemeral and temporal ponds are higher than permanent ponds hayashi et al 2016 johnson et al 2010 parsons et al 2004 waiser 2006 winter and rosenberry 1998 the pond infiltration rates and proportions of the total water loss estimated using our model compared well with estimates obtained in previous hydrological studies at pond 109 at the sdnwa parsons et al 2004 showed for pond 109 using an artificial bromide tracer that the daily infiltration rate was 1 7 mm day in may and 4 5 mm d between june and july these infiltration rates accounted for 47 and 67 of total pond water loss in may and june july respectively the average infiltration value of 3 9 mm d compares remarkably well with our independent model based estimate of 3 4 mm d for pond 109 the daily open water evaporation rates for pond 109 measured for the same period were 1 9 mm d in may and 2 2 mm d for june and july parsons et al 2004 our estimate of 1 33 mm d was somewhat lower than their average value hayashi et al 1998 reported open water evaporation rates of 3 mm d for a two week period in 1995 for pond 109 based on bowen ratio energy balance and evaporation pan measurements 5 4 our model in comparison to other models table 4 shows the modeled estimates of evaporation e from our model the hcns model and the hydrocalculator while these rates vary considerably it is perhaps not surprising given that the three models have different assumptions and are designed to answer different questions the hcns model does not partition e and o since o is assumed to be zero as a result hcns showed no differences in rates of evaporation inflow ratios between the different types of ponds and overestimated the evaporation fraction for all ponds table 4 hcns is therefore poorly suited for obtaining reliable surface water fluxes in small prairie ponds that lose water and receive precipitation during the modeled period the outputs from the hcss model on the other hand underestimated the evaporation amounts of water in all ponds when compared with estimates from the new model this hcss suggests that infiltration generally dominates water loss from these pond types which is not true for all cases here again there is no discernable difference between the evaporation amounts and rates associated with the permanent semi permanent and the ephemeral ponds hence we cannot obtain any meaningful insights into the way these ponds function when the hcss model is applied the results suggest that the craig and gordon 1965 based models compiled in the hydrocalculator software should not be applied to small ponds that lose water to infiltration frequently dry up and where isotopically distinct precipitation inflows have a marked impact on the pond isotope composition furthermore the results of the individual flux estimates from the various classes of wetland ponds also suggest that the existing models predicted higher evaporation component in the smaller mostly the ephemeral and semi permanent ponds but almost the same evaporation for the larger permanent pond pond 50 table 4 these scenarios are expected in the models because the models have been designed to simulate relative component ratios for large lakes and rivers where indeed precipitation additions and outflows balance inflows and have minimal effect these results imply that while the precipitation additions and pond size and shape play critical roles in the estimation of water balance components of small lakes and ponds that may not be the case for large lakes and rivers 5 5 model limitations the model developed in this paper is useful for modelling stable isotope evolution with time in surface water and the estimation of evaporation and infiltration fluxes this model is not capable of distinguishing how the infiltration flux is partitioned between transpiration from the riparian zone and aquatic plants and deeper groundwater recharge which is essential for groundwater resources management in this region in addition the model does not represent surface water or groundwater inflows that may occur such additions could be included but would require measurements of the amount of inflow and the isotopic composition of the inflowing water this is generally not a problem in the canadian prairies in the spring summer period after snowmelt has filled the ponds where surface and groundwater inputs to the ponds are typically small in most years but there will be times and places where the model cannot be applied the model does not take into account progressive changes in pond salinity and local atmospheric conditions e g relative humidity precipitation temperature solar radiation and wind speed which affect evaporation and evapotranspiration rates gonfiantini 1986 horita 2009 horita et al 2008 salinity effects can be worked into the model using the equations of gonfiantini 1986 and the unified craig gordon model gonfiantini et al 2018 one potential source of error in the model comes from the fact that the atmospheric water vapour composition was estimated based on the local evaporation line which does not fully account for the local meteorological conditions that might be present gat and levy 1978 steinman et al 2010 the direct monitoring and measurement of relative humidity and atmospheric water vapour isotope composition could minimize this potential error 6 conclusions small wetland ponds are subject to significant seasonal fluctuations in water levels and isotope composition due to their relatively short residence times our simple measurements of pond water isotope composition shows that such information can be used to estimate the hydrological fluxes into and out of the ponds and in particular to partition the water losses between evaporation and infiltration we were able to show with the model how the infiltration rates varied between different types of pond with higher infiltration rates in ephemeral ponds compared with permanent ponds future challenges for models like ours will be how to apportion infiltration from wetland ponds between plant transpiration vs groundwater recharge and how to represent the effects of surface water and groundwater inflows into the ponds where the amount and isotope composition of such waters are difficult to observe and quantify 7 declaration the authors declare that they have no conflicting interest author contributions e k p b designed the study and field work compiled each data set did the geographic information system work developed the equations run the model and did the water balance and model comparison calculations and wrote the original draft of paper a m i supervised and funded the research wrote the python script and did sensitivity analysis reviewed the paper and contributed to the text acknowledgments we thank the canadian wildlife service for site access the internation dean s scholarship program university of saskatchewan natural sciences and engineering research council and global institute for water security for funding support we thank bob clark randy schmidt and heather wilson for field assistance we also thank environment canada for the archived data and geoff kohler and for making unpublished isotope data available we thank garth van der kamp for useful comments along the way and three anonymous reviewers are thanked for their feedback that have helped improve the quality of this manuscript we especially thank jeff mcdonnell for significant editing assistance and help throughout the study this study is part of the first author s ph d thesis at the university of saskatchewan appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2018 12 032 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6701,stable isotopes have been used to quantify lake and wetland pond water loss to evaporation by applying the modified craig and gordon 1965 model this model and its derivatives employ simplifying assumptions that ignore the additions of precipitation and infiltration outputs and assume evaporation is the only loss term over the prediction period here we develop a coupled water and isotope mass balance model to account for precipitation additions our model uses physical and isotopic observations to quantify pond evaporation and infiltration losses over the ice free period we tested and applied the model to four wetland ponds at the st denis national wildlife research area saskatchewan canada where we have long term datasets modeled infiltration rates from the ponds ranged between 0 99 and 9 2 mm d and open water evaporation rates ranged between 0 88 and 2 8 mm d both were consistent with independent estimates infiltration amounts were highest in the ephemeral ponds that dry out within days or weeks of the spring melt period in these ponds infiltration exceeded evaporation in permanent ponds that is ponds that do not dry out evaporation exceeded infiltration evaporation amounts were most substantial for permanent ponds that were not sheltered by topography or riparian vegetation overall our coupled water and isotope mass balance model combined with physical and isotope observations was able to quantify the spatially and temporally variable evaporation and infiltration fluxes within and between ponds 1 introduction wetlands provide essential ecosystem services including flood mitigation groundwater recharge sediment and pollutant trapping and fish and wildlife habitat wetland ponds defined as open water areas within wetlands serve as important sources of food and breeding grounds for migratory birds and other living organisms bortolotti et al 2013 in the great plains of north america there are millions of wetland ponds in the so called prairie pothole region hayashi et al 2016 hayashi and van der kamp 2000 steinman et al 2010 the eco hydrological functionalities of these wetlands in this semi arid climate depends on the seasonal water cycle dynamics jolly et al 2008 labaugh et al 1997 1996 labaugh et al 2016 van der kamp et al 2008 van der kamp and hayashi 2009 winter 2000 accurate estimation of water budget components and the accompanying physical and chemical changes in a wetland pond groundwater and riparian zone are essential for calibration and validation of hydrological and biogeochemical models wetlands form in topographic depressions and within the wetland there is often a pond there are five types of wetland ponds found in the north american great plains type 1 and 2 ponds often called temporary or ephemeral are formed in shallow depressions as free surface water after snowmelt or storm events in early spring and summer these may last only a few days or weeks but dry up in the summer type 3 ponds also known as seasonal ponds are characterized by shallow marsh vegetation which generally occurs in the deepest part of the pond these ponds dry up by midsummer type 4 ponds also known as semi permanent ponds maintain surface water throughout the growing season i e from may to september but lack persistence most of the year they are dominated by marsh vegetation at the central zone of the wetland as well as coarse emergent plants or submerged aquatic species including cattails bulrushes and pond weeds finally type 5 ponds also referred to as permanent ponds are ponds that always hold a large volume of open water for most years in the central zone of the pond they are generally devoid of vegetation but submerged plants may be present in the deepest zone while emergent plants such as cattails red swampfire and spiral ditch grass are often found along the edges stewart and kantrud 1971 the water balance of wetland ponds is controlled by meteorological forcing and subject to substantial seasonal and inter annual variability caused by spatially and temporally variable surface and subsurface processes hayashi et al 2016 jolly et al 2008 van der kamp and hayashi 2009 in seasonal drought prone climates like the prairies pond water balances and water residence times are controlled by climate variables and pond area volume and shape benson and paillet 1989 hayashi et al 2016 steinman et al 2010 ponds can be fed by direct precipitation snowmelt and rainfall runoff channelized inflows and groundwater discharge ponds lose water by evaporation infiltration and spillage the spillage occurs when storage exceeds a local threshold usually from either overland flow or channelized outflow spence and woo 2003 spence 2010 pond water infiltration may be transpired by the riparian zone plants lost as soil evaporation and serve as recharge water to the underlying groundwater system the direction of surface water groundwater interactions varies spatially as a function of landscape position and elevation relative to the groundwater heads and temporally as a function of seasonal and inter annual meteorological forcing brannen et al 2015 leibowitz et al 2016 leibowitz and vining 2003 the water balance is the dominant but not exclusive control on the water chemistry of a wetland pond hence seasonal and inter annual changes in pond water chemistry are often explained by dilution by precipitation rainfall over the pond or salt enrichment by evaporation goldhaber et al 2014 heagle et al 2007 labaugh et al 1997 pennock et al 2014 water balance controls on the chemistry of a wetland pond include solute inputs from land surface runoff into the pond plant transpiration and sometimes groundwater discharge and solute outputs to groundwater recharge and or spill dogramaci et al 2015 goldhaber et al 2016 leibowitz et al 2016 leibowitz and vining 2003 nachshon et al 2014 ponds that tend to lose water to the groundwater system i e groundwater recharge ponds have lower salinities than ponds that gain water from the groundwater system i e groundwater discharge ponds labaugh et al 1998 nachshon et al 2014 salama et al 1993 sloan 1972 the long term fluctuations in the chemistry of wetland ponds are caused by multi year wet dry variations associated with meteorological forcing in the region cressey et al 2016 goldhaber et al 2016 2014 labaugh et al 2016 nachshon et al 2014 showed that extreme wet conditions could cause groundwater discharge and surface runoff of salts from an upland area into freshwater ponds resulting in freshwater ponds becoming salinized inadequate knowledge of the climate history and chemistry of a particular pond therefore could lead to a misdiagnosis of the pond s hydrological function by short term observations of pond water chemistry in addition to these water balance controls geochemical and biochemical interactions within a wetland pond and underlying wetland soils may add or remove solutes from the wetland pond water heagle et al 2007 labaugh et al 2016 pennock et al 2014 the implications of these high degrees of spatial and temporal variability combined with complex biogeochemical processes that occur within wetland ponds make it difficult to use chemical ions solutes as useful tracers for estimating hydrological fluxes in such terrain on the other hand stable isotopes which are part of the water molecule are also controlled by the water balance however unlike solutes stable isotopes are unaffected by geochemical and biogeochemical processes in most non geothermal environments and therefore serve as powerful tracers for hydrological studies geyh et al 2000 studies involving the qualitative and quantitative analysis of stable isotopes of surface water bodies have been reported in the prairie pothole region of north america fritz et al 1987 gammons et al 2006 gibson et al 2005 pham et al 2009 steinman et al 2010 wassenaar et al 2011 these studies show that seasonal stable isotope variability within the surface water body is significant and contains useful information about the local hydrological processes but to date few studies gat and levy 1978 pham et al 2009 steinman et al 2010 have used stable isotopes to describe the variability in hydrological function the of different wetland ponds in the prairies and similar seasonally cold semi arid regions globally quantitative models gibson et al 1993 1996 2016 gibson et al 2016 gilath and gonfiantini 1983 1986 jones et al 2005 jones and imbers 2010 skrzypek et al 2015 steinman et al 2010 based on the isotope evaporation equation of craig and gordon 1965 and the large lake water budget equation e g gonfiantini 1986 have been used to describe surface water response to meteorological forcing and to estimate the evaporation to water input ratios in data scarce regions or interpret paleoclimate conditions these models consider the initial and final isotope composition climate data atmospheric water vapour isotope compositions and assume that no new additional water source is added during the study period gibson et al 1993 skrzypek et al 2015 the outputs are the fraction of water lost to evaporation or evaporation inflow ratios in the case of flowing streams or rivers thus in such model formulations the effect of isotope inputs from isotopically distinct water e g rainfall or surface inflow and the volume additions to the system at the time of computing these fractions or evaporation inflow ratios are negligible these assumptions have been justified on the basis that the lake and river volumes were too large to be affected by such additions skrzypek et al 2015 in the existing models leakage under the water body i e water lost by infiltration is negligible and surface area volume ratio remains constant even as the water levels decline with time overall these assumptions are problematic for areas where rainfall over small lakes and ponds are significant where ponds leak through infiltration and when water levels decline or increase these changes can significantly alter the isotope composition of the surface water body and could significantly impact the flux estimates produced from the existing models in some previous studies e g gibson 2002a b gibson et al 2016 gilath and gonfiantini 1983 gonfiantini 1986 the idea to include volume and isotopic changes basin area and shape and infiltration components into the model has been discussed later studies involving individual modelling experiments e g gibson et al 2016 gibson 2002a b jones et al 2005 steinman et al 2010 have incorporated some or all three factors into the model formulation these new formulations however were done on limited scales to suit local needs and therefore difficult to generalize and apply elsewhere for example to reduce the uncertainty in evaporation inflow ratios gibson 2002a b estimated and incorporated lake shape and size parameters into the water balance equations when considering the different lakes of northern canada jones et al 2005 addressed the effect of basin shape and surface area changes in the model to recalibrate isotope records from a lake in nar golu in turkey steinman et al 2010 considered the effect of infiltration under cone like lakes and also implemented the geometric changes associated with the surface area to volume changes in a paleoclimate study in the upper columbia river basin of the united states rozanski and chmura 2008 in a laboratory study showed that a key parameter controlling isotopic enrichment is leaking containers is the remaining fraction of water in the container thus these findings suggest collectively that neglecting the impact of infiltration pond shape size and the surface area to volume ratio of small water bodies in estimating evaporation fluxes from isotope water mass balance models will result in significant errors of the individual water balance components in this work we take the critical next step to develop a new physically based isotope water mass balance model that takes into consideration inputs from precipitation and losses to infiltration with accompanying bathymetry changes in a generalizable model our goal is to interpret the differences in stable isotope composition of various types of wetland ponds and hence to describe their differing hydrologic regimes we leverage two decades of hydrometric climate and isotope data collected from a variety of saskatchewan wetland ponds to understand and model the isotopic changes and estimate water mass balance components of the prairie wetlands we perform this work at the well studied st denis national wildlife area bortolotti et al 2013 hayashi et al 2016 nachshon et al 2014 pennock et al 2014 van der kamp and hayashi 2009 near saskatoon our objectives are to i explore the stable isotope composition records of wetland ponds to characterize their hydrologic function ii develop a new coupled physically based isotope and water mass balance model that takes into account rainfall additions which result in volume and isotope composition changes and different pond geometries for the ice free summer season and accounts for infiltration losses iii test the model sensitivity to changing pond geometries and climate parameters and iv compare the model results with independent estimates of evaporation infiltration and storage from existing methods and isotope water mass balance models where feasible 2 study site and field methods 2 1 the study site field data was collected between may and october starting in 1994 at the 385 ha st denis national wildlife area sdnwa 52 8 n 106 8 w in the canadian prairies fig 1a the area and location of wetlands at the sdnwa is shown in fig 1b with the wetlands studied identified in numbers the site is 40 km east of saskatoon saskatchewan canada the sdnwa was established in 1968 as a long term study site for the environmental and ecological monitoring of the prairie wetland complex hogan and conly 2002 there are close to one hundred ponds of varying size and hydrological seasonality at the sdnwa woo and rowsell 1993 van der kamp and hayashi 2009 the climate is semi arid with significant inter annual variability in precipitation and temperature during the summer april september and winter october march months the mean annual non adjusted for wind caused under reported winter snowfall precipitation at saskatoon is 360 mm with about 280 mm occurring as rainfall in april october nachshon et al 2014 parsons et al 2004 the monthly mean temperature varies between 14 7 c in the period december to february and 18 7 c in the period between july and august wittrock and beaulieu 2015 just like other prairie sites the annual lake evaporation exceeds the total annual precipitation parsons et al 2004 the arithmetic mean estimate for a twenty four year monthly integrated record of isotopes in precipitation for saskatoon is 17 0 and 131 0 for δ 18 o and δ 2 h respectively the amount weighted mean values of δ 18 o and δ 2 h for the period june 1990 november 2014 are 14 4 and 112 5 respectively the summary of the values of monthly amount precipitation temperature δ 18 o δ 2 h and the local saskatoon meteoric water line for the period 1990 2014 is given in fig 2 the monthly integrated isotopes in precipitation data is available in bam et al 2018 the study was conducted at pond 50 109 117 and 120 the wetlands were selected based on previous wetland pond classification of stewart and kantrud 1971 ephemeral pond 117 semi permanent pond 120 and permanent pond 109 and 50 ponds 109 117 and 120 can be described as recharge ponds since they have hydraulic head values that are elevated above the potentiometric surface of the underlying confined aquifer system bam 2018 pond 50 has a hydraulic head that is more or less at the same head stage with the underlying regional intertill aquifer and is therefore neither a recharge pond nor a discharge pond bam 2018 a hydro meteorological tower near pond 109 on the site collects half hourly measurements of air temperature relative humidity and precipitation at 2 m and 10 m heights for the 2014 season 2 2 hydrological measurements the water level in the pond was measured manually and in later years using logged pressure transducers at georeferenced poles installed within the wetlands conly et al 2004 the measured water levels were converted to depth of water in meters at the deepest location in the wetland the area a m2 and volume v m3 of surface water stored in the wetland was estimated using the equations described in hayashi and van der kamp 2000 and hayashi et al 2016 as a function of water depth k m 1 a s k 2 β 2 v s k 1 2 β 1 2 β where s m2 is a scale parameter equal to the pond surface area when the depth is 1 m and β is parameter the defines the shape of the idealized pond cross section where β 1 is an inverted cone β 2 is a parabola and larger values represent a bathtub shaped basin with a flat bottom and steep sides hayashi and van der kamp 2000 the constants s and β were determined using bathymetry survey data of ponds 50 109 117 and 120 see hayashi and van der kamp 2000 heagle et al 2013 and updated survey of 2009 van der kamp pers commun meteorological data for sdnwa was collected from the global water institute climate tower installed at the site 2 3 water sampling and isotope analysis wetland pond water samples were collected every two weeks and sometimes monthly during the ice free summer season april october of 2014 pond water samples were collected about 2 m from the bank at depths well below the pond water surface into the narrow mouth 50 ml polypropylene pp bottles and sealed wetland pond temperature at various locations suggests that the pond water was well mixed rainfall samples were collected from dry wet rain gauges that were filled with small amounts of paraffin oil to minimize evaporation of rainfall samples the rain gauges were emptied in between rain events the location of the rain gauges is indicated in fig 1b the amount and isotope compositions of precipitation from these gauges at the sdnwa were used for comparison with saskatoon records the amounts recorded during the period was used in 2014 model calculations all water samples were transported to the stable isotope laboratory at the national hydrology research centre saskatoon the samples were left for debris to settle before stable isotopes analysis the samples were then analyzed for 2h 1h and 18o 16o ratios using a los gatos research dlt 100 liquid water isotope analyzer system coupled with a ctc lc pal liquid autosampler los gatos inc california following the procedures in lis et al 2008 and iaea 2009 the isotope values are reported in the usual δ notation in vs vienna standard mean ocean water vsmow samples standards and control samples river water were analyzed repeatedly six times and the average value of the last four measurements was determined iaea 2009 the internal laboratory standards inv1 δ 2h 220 0 δ 18o 28 5 and rod3 δ2h 8 0 δ18o 1 2 were calibrated to the vsmow2 and slap2 reference waters and used to normalize the results to the vsmow slap scale the laboratory analytical precision is approximately 0 2 for δ 18o and 1 0 for δ 2h respectively lis et al 2008 the stable isotope ratios of water collected between 1990 and 2007 i e precipitation and pond samples were analyzed using isotope ratio mass spectrometers irms the protocols for the isotope ratio mass spectrometer analysis follow the standard methods begley and scrimgeour 1997 coleman et al 1982 eiler and kitchen 2001 epstein and mayeda 1953 karhu 1997 kelly et al 2001 socki 1999 the water samples for oxygen isotope analysis were prepared by conventional h2o co2 equilibration epstein and mayeda 1953 about 5 ml of each sample was equilibrated with co2 gas at 25 0 1 c for 24 h the co2 gas was cryogenically extracted and purified in a vacuum line for deuterium analysis cr at 850 c was used to produce hydrogen gas coleman et al 1982 both 18o 16o and 2h 1h ratios were determined relative to internal standards that were calibrated using vienna standard mean ocean water v smow the data were normalized and reported in the delta notation coplen 1988 the analytical reproducibility is 0 1 and 1 0 for δ 18o and δ 2h both offline dual inlet i e zinc reduction or uranium reduction and continuous flow irms methods i e cr reduction or c reduction have measurement accuracies of the order of 0 5 to 4 for δ 2h and the automated cf irms methods such as c reduction to co and co2 h2o equilibration were between 0 1 and 0 4 for δ 18o lis et al 2008 2 4 archived data wetland pond water depths water temperature and isotope data obtained from 1991 to 2016 and maintained by the national hydrology research centre saskatoon was used to complement our data pond area volume and shape factors obtained from the survey data of van der kamp 2009 personal communication and other relevant data found in published works hayashi et al 2016 hayashi and van der kamp 2000 heagle et al 2013 heagle 2008 were also employed in pond bathymetry evaluations the precipitation records relative humidity and atmospheric temperature measurements of saskatoon are available from saskatchewan research council climate records http climate weather gc ca climatedata dailydata e html stationid 47707 all the other data used in this study can be obtained from the federated research data repository at https doi org 10 20383 101 0115 3 wetland pond water and isotope mass balance model 3 1 model development the variables used in this model are given in table 1 the water balance equation for a wetland pond is given as 3 dv dt a p j o e where a m2 is the area of open water of the pond dv m3 d is the change in volume of water in pond over the time period dt d p m d is direct precipitation into the pond j m d is the lumped surface and subsurface inflow o m d is the lumped surface and subsurface outflow and e m d is the direct evaporation from the pond surface the change in isotope mass in the pond is expressed as 4 d v δ dt a j δ j p δ p o δ o e δ e where δ is the isotope composition δ 18 o or δ 2 h and subscripts relate to the water balance equation components defined above and δ with no subscript refers to pond water eqs 3 and 4 can be applied to any surface water body in general inflow terms i e surface run in and groundwater discharge j may carry isotopically distinct waters and hence modify the isotopic composition of the water body outflow terms i e spillage soil infiltration and plant transpiration o remove water without modifying the isotopic composition of the water body and e removes water and modifies the isotopic composition of the remaining water in the pond in small well mixed relatively shallow and seasonally dynamic ponds such as found in the north american prairies during the ice free summers some simplifying assumptions about these terms can be made we can assume that j 0 and that water input into the pond is due only to rainfall on the pond p we can also assume that all the water loss as outflows o is infiltration which subsequently goes to soil water groundwater recharge and transpiration the justifications for these assumptions are stated below the primary input of water to the ponds other than direct rainfall comes from snowmelt runoff into the pond for the period after the snow and ice melt that the analysis of this paper is restricted to the surface runoff processes that deliver water into the pond are ignored and we use initial conditions based on the water levels and isotopic compositions caused by the snowmelt runoff heavy rainfall events can also cause surface runoff to occur though these are historically fairly rare coles et al 2017 in our dataset there was one year i e 2014 when this did happen and in that case the model was initialized after the rainfall runoff event for ponds that receive a significant amount of water from groundwater input that is discharge ponds as noted in nachshon et al 2013 it would be necessary to estimate the amount of discharge water into the pond and the corresponding isotope composition of the groundwater if this model will be applied to simulate water balance fluxes that is a significant challenge worthy of further research but not addressed here in this study we considered recharge ponds and therefore we do not include groundwater inflow regarding pond outflows it is not necessary to assume that soil infiltration and plant transpiration termed here infiltration is the only outflow but we do so here because we know that the ponds selected did not spill during the period studied a significant amount of the infiltration that occurs below ponds go to support riparian zone transpiration nachshon et al 2013 with the remainder going to groundwater recharge and soil evaporation bam 2018 millar 1971 parsons et al 2004 however water lost to both riparian zone plant transpiration soil and groundwater recharge from the pond does not induce isotope fractionation in the pond water gibson and edwards 2002 jasechko et al 2013 rothfuss et al 2010 yepez et al 2003 and so that process has not been represented explicitly in this model thus the infiltration reported is responsible for lateral seepage to transpiring marginal vegetation soil evaporation and vertical seepage as groundwater recharge to constrain each flux from the infiltration component into transpiration soil evaporation and groundwater recharge a coupled solute isotope water mass balance method e g dincer et al 1979 or independent measurement of evapotranspiration at the site is required at this stage we did not attempt to distinguish how this flux infiltration is partitioned between groundwater recharge soil evaporation and plant transpiration fluxes even though it is a significant hydrological problem substituting j 0 and δ o δ reduces eqs 3 and 4 to eqs 5 and 6 respectively 5 dv dt a p o e 6 v d δ dt δ dv dt a p δ p o δ e δ e replacing dv d t in eq 6 with eq 5 yields 7 v d δ dt δ a p o e a p δ p o δ e δ e which reduces to 8 d δ dt a v p δ p δ e δ e δ while the terms a v p δ and δ p can be measured directly in the field or laboratory e and δ e cannot the isotopic composition of moisture evaporating from the surface a lake δ e is estimated by a linear resistance model of craig and gordon 1965 as defined gammons et al 2006 horita et al 2008 9 δ e 1 1 h δ 1000 δ α h δ a δ 1000 where and δ are the equilibrium and kinetic isotopic separation between liquid and vapour respectively α is the fractionation factor and h is the relative humidity the craig and gordon 1965 model was developed to describe the isotopic fractionation associated with evaporation the model assumes the atmosphere above a given liquid surface to be three discrete layers i a saturated sublayer with 100 relative humidity that attains isotopic equilibrium at the liquid air interface ii a laminar layer less than 100 relative humidity above the liquid air surface layer 1 where vertical transport of water molecule due to molecular diffusion across the humidity gradient results in isotopic fractionation and iii a turbulent atmosphere where turbulent transport dominates with no isotopic fractionation the equilibrium isotopic separation between liquid and vapour is calculated as gonfiantini 1986 10 1000 α 1 where α is the fractionation factor which is a function of temperature t k the equations of the liquid water vapour fractionation factor valid between 0 and 374 c were obtained from laboratory experiments and are given for δ 18 o and δ 2 h as follows horita and wesolowski 1994 11 ln α 18 o 10 3 7 685 6 7123 10 3 t 1 6664 10 6 t 2 0 35041 10 9 t 3 12 ln α 2 h 10 3 1158 8 t 3 10 9 1620 1 t 2 10 6 794 84 t 10 3 161 04 2 9992 10 9 t 3 the equivalent kinetic isotopic separation based on wind tunnel experiments is calculated from araguas araguas et al 2000 13 δ 1 h θ n c k where n 0 5 for a rough surface e g open water bodies and n 1 for soil water θ 1 h o 1 h is an advection term to account for the potential influence of humidity buildup h o is the adjusted humidity of the downwind atmosphere following admixture of evaporating moisture over the surface often set to θ 1 for small water bodies and c k is the kinetic fractionation constant which is 28 6 and 25 0 for oxygen 18 and deuterium respectively as a result we have here 14 δ 18 o 14 2 1 h 15 δ 2 h 12 5 1 h if the relative humidity h is measured near the pond lake it must be normalized to reflect the relative humidity over the pond surface under saturated conditions the saturated vapour pressure e s kpa can be estimated from allen et al 1998 16 e s 0 6108 e 17 27 t 273 t where t kelvin is the temperature measured near the pond the normalized relative humidity h is calculated from the ratio of e s in air e sa and e s in water e sw based on temperature measurements and multiplied by the relative humidity measured near the pond lake the ambient atmospheric water vapour isotope composition δ a can be measured directly estimated from precipitation values or calculated from local evaporation lines of surface water within the catchment clark and fritz 1997 gammons et al 2006 gibson and reid 2014 jacob and sonntag 1991 skrzypek et al 2015 the ambient atmospheric water vapour isotope compositions δ a used here were calculated using the local evaporation lines section 3 2 of each ponds in a given year now substituting eq 9 the equation for estimating the isotopic composition of the evaporating water into the isotope water mass balance equation eq 8 yields 17 d δ dt a v p δ p δ e 1 h δ 1000 δ α h δ a δ 1000 e δ factorizing and re arranging gives 18 d δ dt a v p δ p δ e b c δ where 19 b h δ a δ 1000 α 1 h δ 1000 and 20 c h δ 1000 1000 α 1 h δ 1000 integrating eq 18 with respect to the isotope composition of the pond water δ and time t gives 21 δ t δ i e a p a e c t v eb p δ p p e c 1 e a p a e c t v δ i refers to the initial isotopic composition of the pond estimating the water balance using the wetland pond water level we substituted eqs 1 and 2 into eq 5 resulting in 22 d dt s k 1 2 β 1 2 β 1 s k 2 β p o e integrating with respect to t and factorizing we have 23 k t k i p t o t e t 2 2 β 1 k i refers to the initial water level of the pond eqs 23 and 21 solve the water balance and isotope water mass balance respectively the water balance equation simulates the pond water level given some specified total water loss from the pond e and o combined thus given observations of pond levels inverse modelling can be used to identify the total loss i e e o but not the partitioning between these variables similarly the isotope water mass model takes some specified e to simulate the pond isotope composition given observations of the pond isotope composition inverse modelling can be used to identify e and hence o inverse modelling was achieved here by optimization minimizing the root mean squared error rmse of pond level stage 1 or pond isotopic composition stage 2 by changing e o stage 1 and e stage 2 optimization was performed in python 2 7 using the scipy function fmin which uses a nelder mead simplex algorithm https docs scipy org doc scipy reference generated scipy optimize fmin html this model can be used to i estimate e and o from a specific pond from past observations of pond climate variables or to ii project pond isotope compositions into the future given some prescribed partitioning of e and o along with projections of the hydrometeorological variables the model scripts are attached as supplementary material s1 in the appendix this script was written and run in python 2 7 2 python software foundation us 2011 and reads input data from microsoft excel files the code and all the data set can be found at https github com amireson prairiepondmodel 3 2 stable isotope composition of ambient atmospheric water vapour the isotope composition of ambient atmospheric water vapour δ a can be measured directly estimated from precipitation values or calculated from local evaporation lines of surface water within the catchment clark and fritz 1997 gammons et al 2006 gibson and reid 2014 jacob and sonntag 1991 skrzypek et al 2015 here δ a was computed using the pond evaporation lines lel table 2 obtained from the multiple measurements of the isotopic changes within each individual wetland pond bennett et al 2008 gibson et al 2008a b 2016 gibson and reid 2014 skrzypek et al 2015 because the isotopic compositions of pond water in the prairie environment is strongly influenced by seasonal climatic effects i e figs 3 and 4 resulting in highly seasonal evaporation rates the ambient atmospheric water vapour is calculated assuming the atmosphere is in equilibrium with precipitation during the evaporation season gibson 2002a b 2016 thus an effective precipitation vapour separation effective gibson et al 2016 is assumed where the evaporation line slope and the effective isotopic separation between amount weighted precipitation falling near the intersection of local evaporation line and meteoric water line and the evaporation flux weighted moisture is less than the equilibrium separation the δ a was estimated from local records of the spring summer rainfall stable isotope composition δ p as follows bennett et al 2008 gibson et al 2016 gibson and reid 2014 skrzypek et al 2015 24 δ a δ p x 1 x 1000 where δ p is the stable isotope composition of rain δ 2 h and δ 18 o and is the equilibrium isotopic separation between liquid and vapour which depends only on temperature as described in eqs 10 12 horita and wesolowski 1994 initially eq 24 was solved using x 1 0 and then the slope of lel was calculated from eq 25 25 slope lel h δ ha 2 δ 2 h p 1000 ε 1000 1 δ 2 h p 1000 h ε 1000 h h δ oa 18 δ o p 18 1000 ε 1000 1 δ o p 18 1000 h ε 1000 o where h is air relative humidity given as a fraction ε is the total fractionation factor and equals the sum of the equilibrium isotope fractionation factor as given above plus the kinetic isotope fractionation factor δ gibson and reid 2010 26 ε α δ the calculation was then repeated a number of times using x between 1 0 and 0 1 the final δ a values were selected from the x parameter that gave the lowest difference between the calculated slope of lel eq 25 and the observed slope of lel obtained from field measurements in this case x reached the boundary values between 0 6 and 1 0 the slope of lel and the final δ a values for the ponds table 2 were generally within the range of values reported from the global basis analysis of the international atomic energy agency s global network for isotopes in precipitation database gibson et al 2008a b 3 3 sensitivity analyses sensitivity tests were run to determine the effects of variations in the climatic variables i e relative humidity h atmospheric vapour composition δa precipitation p and temperature t and pond bathymetry parameters i e s and β on the modeled pond isotope composition δ t sensitivity simulations were conducted on a monthly time step for the 2014 model year for pond 109 a univariate sensitivity analysis was performed using baseline pond parameters and average values of the climatic parameters obtained from the site the effect of each parameter on the model was tested one at a time by increasing and decreasing the parameters to a high and low value the parameters were varied by some percentage margins based on the approximate range of values that can be measured in the region the model sensitivity to the variations in each parameter was tested between the period of 22nd may and 16th september 2014 for the sensitivity analyses e o the total water outflow was fixed at an arbitrary value that ensured a reasonable water balance and the ratio e e o i e evaporation to total water outflow was varied from 0 1 i e infiltration dominates to 0 9 i e evaporation dominates 3 4 model application to sdnwa the model was applied to estimate e and o for four ponds at the sdnwa one ephemeral pond 117 one semi permanent pond 120 and two permanent pond 50 and 109 the model driving data is given in table 2 since the model assumes there is no input to the pond other than from direct rainfall it was be initiated after snowmelt or any major rainfall runoff into the pond the initial conditions for the model are the water level and the isotopic composition of the pond water the start and end date for each simulation i e for each pond and each year was chosen based on the periods where there were minimal surface runoff into the pond during the summer the simulated years 1994 1997 1998 1999 and 2014 were the years for which pond water levels isotope and climate data were available table 2 summary of average climate parameters isotopic and basin bathymetry of ponds tested using the new water and isotope water mass balance model at st denis national wildlife area saskatchewan the δ represent average isotope compositions of precipitation and ambient atmospheric moisture s and β are the pond bathymetric parameters used in eqs 1 and 2 3 5 model comparison with existing craig gordon based models an existing model for estimating the evaporative loss of water from a surface water body using stable isotopes is available through the hydrocalculator software skrzypek et al 2015 the software is a compilation of the existing isotope water mass balance models that employed the craig and gordon 1965 model to compute the isotope composition of the vapour from the surface of an evaporating water body these isotope water mass balance models are available in two formulations i the steady state configuration hereafter the hcss model which aims to look at the long term response of a water body under steady conditions where the inflow equals the outflow and there is no change in storage and ii the non steady state configuration hereafter the hcns model the hcss model aims to look at the long term response of a water body under steady conditions where the inflow equals the outflow and there is no change in storage the hcns model aims to look at the short term response of a water body when there is a change in storage but the only loss term is due to evaporation the primary advantage of these models over our model is that much less observational data are required and it is therefore useful to get estimates of evaporation from large water bodies in data scarce areas however for small prairie ponds the assumptions are not appropriate the isotopic composition of the precipitation has an enormous impact on the pond isotope composition the pond storage changes are highly significant with ponds often wholly emptying and the water loses are due to infiltration as well as evaporation none the less we aimed to compare the average evaporation estimates from these two models hcss and hcns with our estimates to see how appropriate these simpler approaches are for small dynamic prairie ponds we note here average estimates from the hydrocalculator software because the output of evaporation ratios are based on the single isotope i e δ 18 o and δ 2 h 4 results 4 1 stable isotope characteristics of prairie wetlands fig 3 shows the temporal variation in stable isotope compositions and pond depth as monitored in prairie wetlands from 1993 to 2016 spring fall seasons the water level is at its maximum after snowmelt when the isotopic enrichment is minimum throughout the summer water levels drop via a combination of evapotranspiration and infiltration isotopic enrichment develops progressively in response to evaporation fig 4 shows continuous δ 18 o and δ 2 h enrichment in of the ponds between the years 2010 to 2016 fig 4 also shows gradual enrichment in the water isotope compositions of δ 18 o and δ 2 h with time and within the ponds from the spring may to the fall september the water stable isotope compositions found in the permanent ponds 50 and 109 are generally enriched even at the start of the season that is the onset of the spring season fig 5 shows a scatter plot of pond isotope values to examine the effect of evaporation on the wetland ponds for four wetland ponds 50 109 117 and 120 at the st denis national wildlife area the pond isotope values fall below the saskatoon local meteoric water line defining local evaporation lines slopes between 5 2 and 6 4 4 2 model sensitivity the results of the sensitivity tests are shown in fig 6 as contour plots of how the isotope compositions of the pond water change as we impose changes in the relative proportion of evaporation to total pond losses i e evaporation plus infiltration and with perturbation to the parameter values the baseline condition i e the center column in each of the subplots shows how the pond isotope composition is progressively enriched as the proportion of evaporation increases the parametric perturbations are shown in the left and right columns in the same subplots and the more sensitive a parameter is the more these contours deviate from the baseline contour the contours in fig 6 suggest that the model is highly sensitive to both relative humidity and atmospheric water vapour isotope composition both of these parameters will have a significant impact on surface water hydrological flux estimates and pond isotope compositions the effect of precipitation additions and temperature are similarly sensitive when the values of these parameters are estimated close to 50 of the original values the model is also moderately sensitive to changing pond basin profile β but relatively insensitive to pond scale parameter s these observations are similar to those reported in earlier studies gammons et al 2006 gat 1995 gibson et al 1993 gibson 2002a b gonfiantini 1986 steinman et al 2010 minimizing errors in measurement of the sensitive parameters and assumptions about how these parameters vary with time will reduce uncertainty and improve model outputs 4 3 model application to sdnwa the comparative results for model outputs and field observations are shown for the permanent ponds 50 and 109 the semi permanent pond 120 and ephemeral pond 117 respectively in fig 7 the root means squared error rmse values for simulated model outputs and field observed data ranged between 0 00 and 0 29 m for pond water levels and 0 02 and 0 10 for isotope composition values in all ponds table 3 shows the water balance and the estimated partitioned fluxes of open water evaporation and infiltration pond 109 a permanent recharge pond has infiltration rates between 2 3 and 4 8 mm d and evaporation rates of between 0 74 and 1 6 mm d the ratio of evaporation loss to total water loss e e o ranges from 13 to 40 mean of 30 which shows that infiltration is the dominant loss on average accounting for approximately two thirds of the total loss pond 50 also a permanent pond but not a recharge pond has infiltration rates of between 0 99 and 1 3 mm d and evaporation rates between 0 97 and 2 8 mm d evaporation losses account for 43 74 mean of 60 of all water losses from pond 50 and evaporation is therefore the dominant loss on average accounting for approximately two thirds of the total water loss infiltration rates under the ephemeral pond 117 and the semi permanent pond 120 were 9 2 and to 5 8 mm d respectively markedly higher than the permanent ponds in 2014 when isotope values and water levels in all ponds were measured evaporation rates in 2014 from ponds 117 and 120 were of a similar magnitude at 0 88 and 1 2 mm d respectively in the ponds 117 and 120 infiltration strongly dominate the water balance accounting for 91 and 83 of water loses respectively 4 4 model comparison with the existing craig gordon based models the hcss model assumes steady state conditions in the pond inflow equals total outflow no change in storage and the model outputs the fraction of evaporation over inflow e i the hcns model assumes transient conditions storage drops over time and the only loss is due to evaporation and the model outputs the fraction of evaporation to initial storage e k i we used the hydrocalculator software to output these fractions separately for δ 18 o and δ 2 h data data used are provided in supplementary material s2 and table 2 for both models the average fractions were then used to calculated average e values for each model table 4 shows the evaporation rates estimated by the hcss hcns and our model 5 discussion 5 1 stable isotope characteristics of prairie wetlands in the canadian prairies wetland ponds accumulate substantial amounts of snowfall and snowmelt runoff water during the winter and spring melt seasons they tend to lose this water to evaporation and infiltration during the summer period the result of course is the regular seasonal variations in water levels as shown fig 3 the stable isotope compositions of ponds also follow predictable seasonal patterns in spring the pond water is depleted due to additions of isotopically light snowmelt and through the summer months the waters are progressively enriched by evaporation fig 4 we found that δ 18 o and δ 2 h in the permanent ponds were generally more enriched and less variable compared with the isotope composition of the semi permanent and ephemeral ponds at the start of the spring season we attribute the more positive values of δ 18 o and δ 2 h in the permanent ponds to the presence of large volumes of evaporated water retained from the previous year s snowmelt δ 18 o and δ 2 h signatures are more negative than the residual evaporated pond water from previous years the mixing of the residual evaporated waters with the snowmelt water of the spring season results in the enriched δ 18 o and δ 2 h signals found in the large and permanent ponds at the start of the season spring this is different to the isotopic composition in the semi permanent and ephemeral ponds where little or no evaporated water is retained from the previous season consequently light snowmelt water serves as the initial water source for the ephemeral ponds and as a result these ponds generally show more negative δ 18 o and δ 2 h compositions these differences in the early spring isotope compositions observed in different pond types suggests that the seasonal δ 18 o and δ 2 h isotope compositions could be used to distinguish the hydrologic process behaviour in this region between may to late october fig 4 there was consistent progressive enrichment in δ 18o and δ 2h for all ponds due to evaporation in the pond this evaporation effect is reflected in the lower slopes in dual isotope space for the pond evaporation lines fig 5 the lower slopes of these evaporation lines compared to the local meteoric water line is as a result of kinetic fractionation induced by the evaporation process in an environment of relatively low humidity clark and fritz 1997 gammons et al 2006 we hypothesize that the differences in the slopes of the local evaporation lines of the ponds table 2 are as a result of several factors vegetation cover around the pond evaporation rate from the ponds the volume of water and isotope composition of water stored from previous years and whether or not the pond is losing or gain water to groundwater 5 2 model performance and sensitivity the rmse values for simulated model outputs and field observed data suggests that the performance of the model is reasonable for simulating both isotope compositions and water levels the errors are generally of a similar in magnitude to the lowest analytical precision for δ 18o and δ 2h measurements which is 0 2 and 1 0 respectively lis et al 2008 and the observational accuracy in determining maximum water depth from ponds which are mostly within 50 mm conly et al 2004 the comparison of water balance components between different types of wetland ponds shows that infiltration rates are highest in the ephemeral semi permanent pond 117 and 120 lower in the permanent recharge pond pond 109 and lowest in the largest permanent pond pond 50 the observation is consistent with our understanding of how these ponds function in the landscape stewart and kantrud 1971 hayashi et al 1998 van der kamp and hayashi 2009 heagle et al 2013 the relatively high evaporation rate from the larger pond pond 50 is attributed to the larger surface area and the relatively high exposure of the pond to wind and radiation compared with the more sheltered recharge pond 109 the model is most strongly affected by changes in relative humidity of the free vapour h fig 6a with 15 changes in h a considerable difference can be seen between the isotope compositions of the remaining pond water and the baseline isotope composition the influence of h on kinetic fractionation process that occurs during evaporation of water vapour from surface water bodies are noted in eqs 9 13 19 and 25 this influence is directly related to the changes in the pond evaporation lines and hence the ambient atmospheric water vapour composition and the final hydrologic balance of the pond decreasing the relative humidity by 15 results in more enrichment of the isotopic composition of the remaining pond water the atmospheric water vapour isotopic composition δ a also exerts a strong impact on the model although to a lesser degree than h changes in surface water isotope composition are driven by turbulent diffusion mass transfer mechanisms and humidity eqs 9 17 and 25 kinetic fractionation during non equilibrium evaporation of water as the result of the enhanced diffusion of the lighter isotope 1h2 16o relative to heavier isotopologues 1h2h16o and 1h2 18o from the boundary layer to the open air clark 2015 gat 2008 field observations and laboratory experiments craig et al 1963 gat 1995 kumar and nachiappan 1999 have shown that an isotopic build up will continue until the difference between the isotopic composition of the water body and that of its evaporate reaches isotopic equilibrium equilibrium isotopic conditions are unlikely in the field as wind continuously replaces the air above the pond this means that the ambient atmospheric isotope composition has a strong impact on the estimated hydrological fluxes future work should focus on more accurate ways of evaluating this variable precipitation p was moderately sensitive in controlling differences in the pond isotopic composition as a simple function of dilution or mixing as seen in eq 21 temperature t was also moderately sensitive t influences evaporation rates and fig 6 shows that this is due to the direct control of t on the liquid vapour equilibrium fractionation factor for evaporating water eqs 11 and 12 the impact of precipitation amount and temperature on the isotope composition of the remaining pond water is unsurprising and the effect of temperature on the isotope composition of lake water and precipitation in the mid and high latitude regions is well documented dansgard 1964 gat 1996 rozanski et al 1992 air temperature also influences evaporation however there are potential feedbacks that complicate such influence for example evaporation from an large lake or transpiration from the riparian vegetation around the pond may suppress air temperature and reduce pond evaporative losses alternatively a smaller pond at the same temperature may see increased evaporation with less vegetation cover mohammed and tarboton 2011 the pond scale parameter s determines the overall size of the pond surface area as a function of pond depth and is a relatively insensitive parameter conversely the pond profile parameter β which determines the form of the relationship between area and depth is highly sensitive the insensitivity of the pond scale parameter s which determines the overall size of the pond surface area as a function of pond depth is not surprising because the substitution of the expressions for a and v eqs 1 and 2 into eq 8 cancels s out conversely the highly sensitive nature of the pond profile parameter β suggests the shape of the ponds area depth and volume is essential for estimating flux losses it follows therefore that the simplifying assumption that the pond area remains fixed as the depth changes are unsuitable for relatively small ponds as considered in this study the isotope mass balance model is most sensitive to controls of relative humidity atmospheric water vapour isotope composition and pond shape roughly in that order these factors are followed by precipitation amount temperature and pond scale reducing the errors in measurement of the most sensitive parameters and applying the correct assumptions about how these parameters vary with time will improve this model 5 3 comparison with field observations the pond infiltration rates vary from 0 9 to 9 2 mm d between years and between ponds these infiltration rates are comparable to darcy flux calculations of 0 83 1 38 mm d by woo and rowsell 1993 and residual curve flux estimate by hayashi et al 1998 for sdnwa on the order of 9 4 mm d work by parsons et al 2004 in 1999 used tracer mass balance estimates to calculate infiltration and found flux rates in the range 1 7 4 5 mm d the variability in these infiltration estimates can be likely explained by 3 factors 1 pond type i e ephemeral temporal or semi permanent or permanent 2 antecedent moisture content of the substrate beneath the wetland pond before snowmelt and 3 the meteorological conditions during the melt period granger et al 1984 hayashi et al 2016 studies have shown that infiltration rates under ephemeral and temporal ponds are higher than permanent ponds hayashi et al 2016 johnson et al 2010 parsons et al 2004 waiser 2006 winter and rosenberry 1998 the pond infiltration rates and proportions of the total water loss estimated using our model compared well with estimates obtained in previous hydrological studies at pond 109 at the sdnwa parsons et al 2004 showed for pond 109 using an artificial bromide tracer that the daily infiltration rate was 1 7 mm day in may and 4 5 mm d between june and july these infiltration rates accounted for 47 and 67 of total pond water loss in may and june july respectively the average infiltration value of 3 9 mm d compares remarkably well with our independent model based estimate of 3 4 mm d for pond 109 the daily open water evaporation rates for pond 109 measured for the same period were 1 9 mm d in may and 2 2 mm d for june and july parsons et al 2004 our estimate of 1 33 mm d was somewhat lower than their average value hayashi et al 1998 reported open water evaporation rates of 3 mm d for a two week period in 1995 for pond 109 based on bowen ratio energy balance and evaporation pan measurements 5 4 our model in comparison to other models table 4 shows the modeled estimates of evaporation e from our model the hcns model and the hydrocalculator while these rates vary considerably it is perhaps not surprising given that the three models have different assumptions and are designed to answer different questions the hcns model does not partition e and o since o is assumed to be zero as a result hcns showed no differences in rates of evaporation inflow ratios between the different types of ponds and overestimated the evaporation fraction for all ponds table 4 hcns is therefore poorly suited for obtaining reliable surface water fluxes in small prairie ponds that lose water and receive precipitation during the modeled period the outputs from the hcss model on the other hand underestimated the evaporation amounts of water in all ponds when compared with estimates from the new model this hcss suggests that infiltration generally dominates water loss from these pond types which is not true for all cases here again there is no discernable difference between the evaporation amounts and rates associated with the permanent semi permanent and the ephemeral ponds hence we cannot obtain any meaningful insights into the way these ponds function when the hcss model is applied the results suggest that the craig and gordon 1965 based models compiled in the hydrocalculator software should not be applied to small ponds that lose water to infiltration frequently dry up and where isotopically distinct precipitation inflows have a marked impact on the pond isotope composition furthermore the results of the individual flux estimates from the various classes of wetland ponds also suggest that the existing models predicted higher evaporation component in the smaller mostly the ephemeral and semi permanent ponds but almost the same evaporation for the larger permanent pond pond 50 table 4 these scenarios are expected in the models because the models have been designed to simulate relative component ratios for large lakes and rivers where indeed precipitation additions and outflows balance inflows and have minimal effect these results imply that while the precipitation additions and pond size and shape play critical roles in the estimation of water balance components of small lakes and ponds that may not be the case for large lakes and rivers 5 5 model limitations the model developed in this paper is useful for modelling stable isotope evolution with time in surface water and the estimation of evaporation and infiltration fluxes this model is not capable of distinguishing how the infiltration flux is partitioned between transpiration from the riparian zone and aquatic plants and deeper groundwater recharge which is essential for groundwater resources management in this region in addition the model does not represent surface water or groundwater inflows that may occur such additions could be included but would require measurements of the amount of inflow and the isotopic composition of the inflowing water this is generally not a problem in the canadian prairies in the spring summer period after snowmelt has filled the ponds where surface and groundwater inputs to the ponds are typically small in most years but there will be times and places where the model cannot be applied the model does not take into account progressive changes in pond salinity and local atmospheric conditions e g relative humidity precipitation temperature solar radiation and wind speed which affect evaporation and evapotranspiration rates gonfiantini 1986 horita 2009 horita et al 2008 salinity effects can be worked into the model using the equations of gonfiantini 1986 and the unified craig gordon model gonfiantini et al 2018 one potential source of error in the model comes from the fact that the atmospheric water vapour composition was estimated based on the local evaporation line which does not fully account for the local meteorological conditions that might be present gat and levy 1978 steinman et al 2010 the direct monitoring and measurement of relative humidity and atmospheric water vapour isotope composition could minimize this potential error 6 conclusions small wetland ponds are subject to significant seasonal fluctuations in water levels and isotope composition due to their relatively short residence times our simple measurements of pond water isotope composition shows that such information can be used to estimate the hydrological fluxes into and out of the ponds and in particular to partition the water losses between evaporation and infiltration we were able to show with the model how the infiltration rates varied between different types of pond with higher infiltration rates in ephemeral ponds compared with permanent ponds future challenges for models like ours will be how to apportion infiltration from wetland ponds between plant transpiration vs groundwater recharge and how to represent the effects of surface water and groundwater inflows into the ponds where the amount and isotope composition of such waters are difficult to observe and quantify 7 declaration the authors declare that they have no conflicting interest author contributions e k p b designed the study and field work compiled each data set did the geographic information system work developed the equations run the model and did the water balance and model comparison calculations and wrote the original draft of paper a m i supervised and funded the research wrote the python script and did sensitivity analysis reviewed the paper and contributed to the text acknowledgments we thank the canadian wildlife service for site access the internation dean s scholarship program university of saskatchewan natural sciences and engineering research council and global institute for water security for funding support we thank bob clark randy schmidt and heather wilson for field assistance we also thank environment canada for the archived data and geoff kohler and for making unpublished isotope data available we thank garth van der kamp for useful comments along the way and three anonymous reviewers are thanked for their feedback that have helped improve the quality of this manuscript we especially thank jeff mcdonnell for significant editing assistance and help throughout the study this study is part of the first author s ph d thesis at the university of saskatchewan appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2018 12 032 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6702,the luanhe river basin the mostly afforested river basin in north china has exhibited significant land use land cover change lucc under climate change that could jointly affect water availability of the basin in the future this study examines both impacts of lucc and climate change on runoff over the upper reaches of the luanhe river basin first the land use in 2020 is predicted based on the cellular automata markov ca markov second a hydrological model soil water assessment tools swat is set up for the baseline period 1961 1979 and driven primarily by outputs from five general circulation models gcms under four representative concentration pathways rcps i e rcp2 6 rcp4 5 rcp6 0 and rcp8 5 for the period 2020 2030 results show that the ensemble mean annual precipitation may increase under four rcps for the period 2020 2030 with the maximum 470 mm yr and minimum 444 mm yr for rcp8 5 and rcp6 0 respectively 1 7 higher than the observed mean annual precipitation 441 mm yr during 1961 1979 the relationship between the runoff simulations and the rcps under the 2020 land use scenario is nonlinear with the maximum 57 mm yr and minimum 50 mm yr mean annual runoff depths under the rcp4 5 and rcp6 0 scenarios respectively 58 and 39 higher than the mean annual observed runoff depth 36 mm yr for the baseline period the increase in forestland 56 and decrease in agriculture land 30 are remarkable for the period 1970 2020 driven primarily by afforestation implemented in the luanhe river basin lucc would lead to a slight decrease in mean annual runoff and the runoff only increases in summer but decreases in other three seasons the decrease in surface runoff and groundwater discharge jointly results in the overall decrease in runoff due to lucc in general the climate change impact will dominate runoff change for the study basin though marked afforestation has taken place and is likely to continue in the future keywords land use cover change climate change runoff change markov swat luanhe river basin 1 introduction with the development of society and economy various human activities have profoundly affected the hydrological cycle and water resources through different pathways li et al 2007 and an important indicator of such impacts is the land use and land cover change lucc deng et al 2015 lambin and meyfroidt 2011 lucc has significant impacts on hydrological processes as well as the economy and ecology of watersheds by regulating runoff generation and routing and evapotranspiration et defries and eshleman 2004 deng et al 2003 the luanhe river basin in north china features marked afforestation over its upper reaches since 1999 for the purposes of reducing sandstorm from inner mongolia to beijing and soil and water conservation three large tree farms i e yudaokou qiansongba and saibei were built during these years where the forest coverage rate reached almost 50 by 2016 and is expected to increase to 73 by 2021 li et al 2017 there are two reservoirs in the midstream of the luanhe river i e the panjiakou reservoir and the daheiting reservoir which are the most important surface water sources for tianjin municipality and tangshan city cao et al 2010 li and huang 2015 the water division project from the luanhe river to tianjin increases water supply and improves water quality and effectively reduces groundwater abstraction and land subsidence in tianjin since the 1950s the hydrological cycle in the luanhe river basin has been remarkably changed driven primarily by the combined effects of climate change and human activities liu et al 2013 due to less rainfall and the effect of soil and water conservation decreases in mean annual runoff have been shown to reach 30 during 1980 2002 compared with the period 1956 1979 which may result in water supply crisis li et al 2014 it is therefore imperative to predict changes in water availability by considering both lucc and climate change in the future so as to formulate adaptation strategies to achieve sustainable use and allocation of water resources precipitation and streamflow in the luanhe river basin have changed markedly after 1979 chen et al 2013 so we selected the period 1961 1979 as the baseline period when both climate change and human activities had little effect on the basin we predicted the land use map of 2020 using the land use transition matrix from 2000 to 2010 which is representative to show the lucc due to afforestation the corresponding future period 2020 2030 was selected to perform runoff simulation under the 2020 land use scenario and the simulations were compared to the results for the baseline period numerous studies have shown the impacts of lucc on streamflow wei et al 2007 classified 131 rainfall events into three regimes to analyze the runoff and soil loss in relation to different land use types runoff simulations under prescribed land use scenarios indicated that runoff increased when the grassland area increased and forestland decreased wang et al 2008 kathumo et al 2011 found a strong relationship between streamflow and land use land cover with a coefficient of determination r 2 of 0 84 in the river gucha catchment kenya dixon and earls 2012 used the soil and water assessment tool swat to examine the effects of urbanization on streamflow simulations also showed that land use change can result in changes in surface runoff and groundwater recharge baker and miller 2013 shi et al 2014 analyzed the responsive relationship between the surface runoff variation and the major landscapes suggesting that the conversion from forestland to farmland and grassland resulted in increases in mean annual surface runoff and total runoff these results show that runoff can be an effective indicator of lucc in watersheds bewket and sterk 2005 because of complicated driving factors and significant variations in lucc li et al 2010 it is challenging to predict lucc precisely given the changing economy land use policy and natural variables iacono et al 2012 li and huang 2015 previous studies used various approaches to depict lucc considering economic growth population social policies and mutual feedbacks among them a dynamic system was set up to model lucc using different driving forces e g land use management and population growth and the future lucc was simulated under different socio economic policies providing reference for decision making for sustainable development yu et al 2011 the markov chain model is a simple probabilistic land use change model based on the markov process in the process the current state depends only on its most adjacent previous period and the transition can be described by transition probability matrices iacono et al 2012 a cellular automata markov ca markov model was used to simulate forest cover changes of a national park to evaluate pre and post policy interventions indicating positive effects of national level policy adhikari and southworth 2012 changes in the relationships between precipitation and streamflow can also be indicative of lucc gupta et al 2015 runoff changes reflect the compound effects of lucc and climate change some previous studies used the coupled model intercomparison project phase 5 cmip5 data set to analyze the impacts of climate change under different scenarios eisner et al 2017 eum et al 2016 neupane et al 2015 teklesadik et al 2017 results of the coupled climate model hadgem2 ao reveal increases in precipitation over tropical regions but decreases over subtropical regions given the expansion of hadley cell over the 21st century in addition changes in soil moisture and sea ice under different representative concentration pathways rcps also show spatial variability baek et al 2013 extreme precipitation events were evaluated over the columbia river basin during 1970 1999 and 2041 2070 under the rcp8 5 scenario by simulating four cmip5 general circulation model gcms dars 2013 though the mean precipitation is projected to decrease the extreme precipitation events show significant increases in some regions in addition investigation into runoff extremes in the future has been done at a finer resolution than gcms over the pacific northwest using regional climate models projections najafi and moradkhani 2015 moreover some studies evaluated the impacts of climate change on streamflow to formulate water management strategies basheer et al 2015 ouyang et al 2015 previous studies have examined the accuracy of some outputs of gcms in china chen and frauenfeld 2014 chen et al 2014 sun et al 2016 and there is a consensus that the resolution of the raw output of gcms is too coarse to describe hydrological processes at regional scales dars 2013 ouyang et al 2015 wilby 2004 wilby et al 1999 ahmadalipour et al 2017 a number of studies have evaluated the impacts of climate change on runoff using multiple gcms and hydrological models eisner et al 2017 teklesadik et al 2017 however climate modeling factors can also influence the variance of streamflow experiments using varied factors e g gcm type project phase emission scenario downscaling method and bias correction indicated that the predicted streamflow is a function of modeling factors and it is unnecessary to consider all the factors as long as the ensemble design is well balanced aamery et al 2016 future impacts of lucc and climate change on runoff can be evaluated simultaneously in the brahmaputra river basin sensitivities of et streamflow total water yield groundwater recharge to co2 concentration temperature and precipitation changes were evaluated indicating that et and groundwater recharge are more sensitive to changes in co2 concentration and precipitation respectively pervez and henebry 2015 more studies focusing on lucc and climate change or their impacts on streamflow can be found in table 1 the overall objective of this study is to systematically investigate both impacts of lucc i e mainly afforestation and climate change i e mainly variations in precipitation on future runoff for the upper reaches of the luanhe river i e the upper panjiakou reservoir this objective of this study was achieved by performing these following four steps 1 runoff simulation for the baseline period 1961 1979 under the 1970 land use scenario using swat 2 prediction of the land use land cover in 2020 using ca markov 3 runoff simulation for the period 2020 2030 under different land use land cover scenarios 1970 and 2020 and four rcps i e rcp2 6 rcp4 5 rcp6 0 and rcp8 5 and 4 examination of both impacts of lucc and climate change scenarios on future runoff 2020 2030 results of this study should improve our understanding of variations in runoff for the study basin under a range of lucc and climate change scenarios and will provide reference for formulating adaptation strategies for better water resources management in the future this will also benefit water diversion projects of the luanhe river for its neighboring megacities in north china with important implications for other water diversion projects in china and globally under a changing environment 2 study area and data 2 1 study area the luanhe river basin is on the north of the north china plain in the haihe river basin ranging from 39 02 n 42 43 n and 115 34 e 119 50 e fig 1 the luanhe river rises at the northern foot of the bayanguertu mountain in zhangjiakou prefecture of hebei province flowing through 27 counties of hebei province inner mongolia and liaoning province and ending up in the bohai bay in laoting county liu 2012 almost 500 tributaries flow into the pinnate luanhe river water system along the way li 2005 the luanhe river spans 888 km controlling 44 750 km2 area bordered by the chaobai river and jiyun river to the southwest and adjacent to the bohai sea in the south shan et al 2013 shi 2013 the luanhe river basin can generally be divided into three geomorphological units i e plateau mountain and plain in terms of different geology geomorphology and formation types the plateau topography is mainly located in the northern part of the basin with elevations ranging between 1400 and 1600 m the mountainous regions are located on the south of the plateau and on the north of the plain with slopes ranging between 20 and 40 the plain is distributed in the south of the basin li 2005 the basin is characterized by decreasing temperatures from south to north ranging from 10 6 c to 1 4 c and the highest and lowest temperatures appear in july and january reaching 40 c and 26 c respectively liu 2012 interannual and intra annual variations in precipitation are marked the mean annual precipitation for the entire basin is 390 800 mm that mainly falls in july and august in addition the precipitation in wetter years can be 1 7 3 5 times of the driest year li 2005 the dividing line of the temperate zone and warm temperate zone passes through the basin as a result the basin is characterized by temperate grassland and warm temperate deciduous broad leaved forest vegetation from north to south li 2005 in this study we selected the upper reaches of the luanhe river to evaluate the impacts of lucc and climate change on streamflow the sandaohezi gauging station hereafter termed as the sdhz station was selected to evaluate the change in streamflow the drainage area of the sdhz station is 17 100 km2 including the most afforested region in the upper reaches of the luanhe river basin 2 2 data 2 2 1 meteorological data meteorological data used in this study were obtained from the meteorological data center of the china meteorological administration http data cma cn including annual daily average temperature annual daily average maximum and minimum temperatures annual daily average precipitation average daily relative humidity average daily wind speed daily sunshine duration and average daily vapor pressure from 1951 through 2014 the daily meteorological data during 1995 2014 were used to calculate the parameters of the weather generator to fill gaps of meteorological data in addition we used the china gauge based daily precipitation analysis cgdpa product from 1961 to 1979 to drive swat cgdpa is a daily precipitation product based on a national surface observational network with a high resolution 0 25 0 25 or 27 km 27 km over mainland china shen and xiong 2016 furthermore we selected data sets from five gcms gfdl esm2m hadgem2 es ipsl cm5a lr miroc esm chem and noresm1 m table 2 which were bias corrected and downscaled at a 0 5 0 5 spatial resolution to the watch forcing data wfd weedon et al 2011 in the fast track of the inter sectoral impact model inter comparison project isi mip liu et al 2013 the wfd combines the era 40 daily data i e the daily reanalysis data and the climate research unit ts2 1 data set cru with observed time series of monthly variations in the climate and the monthly mean precipitation is corrected with the global precipitation climatology centre full data set version 4 gpcc hempel et al 2013 the isi mip focuses on advancing our knowledge on climate change risks and the quantitative and cross sectoral synthesis of different impacts of climate change covering global water agriculture biodiversity and many other aspects https esg pik potsdam de projects isimip2a the bias corrected data sets could reflect changes in climate variability and atmosphere mean and could better investigate the effects of extreme hydrological events hempel et al 2013 leng et al 2015 the projected meteorological data sets i e daily precipitation maximum and minimum temperatures relative humidity wind speed solar radiation from 2020 to 2030 were derived from these five gcms based on the subbasins partitioned by swat the centroid of each grid cell of precipitation and subbasin was determined then the value of the nearest grid cell of precipitation was taken to represent the precipitation of the subbasin in addition if the subbasin was large enough to cover more than one grid cell the mean precipitation value of these grid cells were calculated and assigned to the subbasin finally the precipitation was allocated to each hru in the subbasin i e precipitation of all hrus in the subbasin is the same 2 2 2 land use and other data six land use and land cover maps spanning from 1970 to 2014 were obtained from the chinese academy of sciences the types of land use were further divided into six categories according to the land use classification system of the chinese academy of sciences i e agriculture land forestland grassland water construction land and unused land table 3 the main land use types of the luanhe river basin include agriculture land forestland and grassland accounting for more than 90 area of the entire basin marked lucc has been found across the basin featured by increased forestland but deceased agricultural and grassland for instance the forested area increased by 8700 km2 45 during 2000 2014 yet it remained generally stable and even slightly decreased since 2010 on the contrary agriculture land decreased considerably during 2000 2014 with the area decreased by 3900 km2 23 the area of grassland also decreased with its fraction decreasing from 26 in 2000 to 15 in 2014 the overall trend of land use change in the study area upper reaches is quite similar to the trend in the entire basin during 1970 2014 however the trend of land use change in the study area is not that significant until 2000 monthly streamflow data of the sdhz station for the period 1961 2011 were derived from year book of hydrologic data of the people s republic of china hydrological data of the haihe river basin the dem of the study region was obtained from 90 m 90 m srtm dem data set v1 provided by the cold and arid regions sciences data center at lanzhou china http westdc westgis ac cn soil data were derived from the soil database of china generated by the nanjing institute of soil the chinese academy of sciences 3 methodology 3 1 markov chain model and cellular automata markov the markov process is a random process that a system undergoes transitions from one state to another the properties of which include no aftereffect i e the current state of a system just depends on the last adjacent period and stability du et al 2015 if both the time series and events of the process are discrete we call the markov process as the markov chain iacono et al 2012 eq 1 describes the properties of the markov chain 1 p d t d t 1 where p is the transition probability matrix dt and dt 1 are the land use at time t and t 1 respectively each type of land use is projected by the probability pij of land use i transformed into land use j as follows 2 p ij a ij a i 3 j 1 k p ij 1 where ai is the total transformed area of class i over the transition period aij is the area of land use i transformed into land use j and k is the number of the land use types halmy et al 2015 muller and middleton 1994 previous studies have shown the applicability of the markov chain to predict land use status and change in the future du et al 2015 gao and xu 2010 guo 2006b he et al 2014 to build a markov chain model the initial state and the transition matrix need to be determined to describe the transition ca markov combines ca and the markov chain that can predict both quantitative and spatial change of land use and land cover the ca model is based on the previous state and simultaneously considers the state of the neighborhood cells to predict the transition adhikari and southworth 2012 despite the weakness in expressing the impacts of one cell on the entire state space ca markov integrates the advantages of ca and the markov chain to predict the land use and land cover transition more reasonably and accurately that have been widely used behera et al 2012 halmy et al 2015 sang et al 2011 subedi et al 2013 two constraints i e slope and water body were used to determine the suitable area of transformation from one land use type to others slope was considered as the constraint for agriculture land forestland water and construction land with the slope of suitable conversion area less than 15 65 1 and 25 respectively according to related policies and research behera et al 2012 water body was considered as the constraint for all land use types excluding water and unused land constraint maps for different land uses were expressed using the boolean map with suitable transformation areas coded with one and others coded with zero behera et al 2012 kallali et al 2007 multi criteria evaluation mce was adopted with the boolean intersection function to generate suitability maps for each land use type suitability maps for each land use are shown in appendix b before prediction the accuracy of ca markov should be validated first we predicted the land use map of 2014 with the land use maps of 2000 and 2010 as inputs and then evaluated the predicted land use map of 2014 with the corresponding reference land use map kappa indices were used to evaluate the predicted land use map of 2014 including kappa for no information k no kappa for location k location kappa for stratum level location k locationstrata and kappa for standard k standard with values above 80 indicating good performance of prediction gashaw et al 2017 singh et al 2015 after the evaluation the land use maps of 2000 and 2010 were imported into idrisi to create the transition matrix and predict the land use in 2020 using the transition matrix the 2010 land use map and the suitability map 3 2 soil water assessment tool swat is a public domain hydrologic model that can be applied from small watersheds to large river basins to simulate quantity and quality of surface and groundwater abbaspour et al 2007 dixon and earls 2012 teshager et al 2016 time steps of simulation using swat can be daily monthly and yearly http swat tamu edu the model has been widely used due to the solid physical mechanism that can be applied to complex large watersheds li 2008 yu et al 2008 input data of swat include dem soil land use and weather in addition look up tables of land use table 4 and soil should be written to connect with the database built in swat parameters of the weather generator were calculated by wgnmaker 4 1 http swat tamu edu here we chose chengde laoting duolun qinglong and weichang weather stations fig 1 and calculated the parameters to fill gaps in meteorological data inputs of wgnmaker 4 1 include daily precipitation daily highest and lowest temperature and daily maximum precipitation in half an hour for lack of the daily maximum precipitation in half an hour the data were estimated by using daily precipitation divided by 48 approximately daily solar radiation and dew temperatures as inputs were calculated by equations in appendix a land use scenarios in 1970 and 2020 were used in the swat simulation first under the land use scenario of 1970 and driven by the cgdpa precipitation monthly streamflow was calibrated for the period 1961 1975 with the initial two years set as the warm up period and validated for the period 1976 1979 in order to fully calibrate the model under the 1970 land use and ensure that the year 1970 was included during calibration we selected the longer period 1963 1975 for calibration and the period 1976 1979 for validation given that the streamflow was influenced significantly by human activities after the 1980s the model was calibrated manually and automatically using the sufi 2 algorithm by swat cup and 16 parameters were selected and identified table 5 the coefficient of determination r 2 and nash sutcliffe efficiency coefficient e ns were used to evaluate the model performance however the spring flood in april at the sdhz station could not be simulated well by swat because the spring flood is more related to river thawing recorded by year book of hydrologic data of the people s republic of china hydrological data of the haihe river basin whose mechanism is not depicted in this model therefore we proposed an empirical method to correct for the poor simulations of spring flood in april see section 4 3 second we used the outputs from five gcms under four rcps and the 2020 land use scenario to drive swat and simulate streamflow during 2020 2030 third we used the land use map of 1970 to replace the land use map of 2020 and simulated streamflow for the same period to quantify the impacts of lucc on runoff note that when the land use map was changed from 2020 to 1970 the initial parameters of swat related to land use i e cn2 were subsequently adjusted automatically e g the area weighted average of cn2 for a subbasin is 68 in 2020 and 78 in 1970 given the calibrated value of the relative change in cn2 e g 10 the initial value of cn2 can be adjusted automatically under a different land use scenario therefore cn2 values under different simulation scenarios are changed accordingly with land use maps 4 results 4 1 projected precipitation from general circulation models precipitation plays a critical role in runoff simulation and the variability in precipitation leads to a complicated hydrological regime houston 2006 moulin et al 2008 saifullah et al 2016 for ease of expression outputs from different gcms under rcps are hereafter referenced to as the combination of the abbreviated names of gcms and the representative numbers of rcps e g gfdl26 represents the output from gfdl esm2m under the rcp2 6 scenario the projected precipitation by the five gcms under four rcps for the study area the upper reaches of the luanhe river basin shows the mean annual precipitation of 458 mm 4 increase 458 mm 4 increase 444 mm 1 increase and 470 mm 7 increase under rcp2 6 rcp4 5 rcp6 0 and rcp8 5 respectively relative to the mean annual precipitation of 441 mm from cgdpa precipitation for the baseline period 1961 1979 the precipitation is mainly concentrated in july and august and some of the future precipitation e g had45 had85 and nor26 is much higher than the historical level reflected by cgdpa data for the period 1961 1979 implying large possibility of flooding in summer in the future specifically july shows the highest monthly precipitation in a year among all the gcms and rcp scenarios except miroc26 showing the highest precipitation in august fig 2 a the basin belongs to the warm temperate zone monsoon climate with four distinct seasons characterized by hot and rainy summer cold and dry winter and dry spring we looked into projected seasonal precipitation i e spring i e mam summer i e jja fall i e son and winter djf the mean precipitation from all gcms and rcps for the period 2020 2030 in the four seasons is 63 mm 9 increase 312 mm 4 increase 77 mm 10 increase and 6 mm 45 decrease respectively compared with the observed mean precipitation of 58 mm 301 mm 70 mm and 11 mm in the four seasons from cgdpa data 1961 1979 fig 2b the strongest increase and decrease in precipitation occur in fall under rcp8 5 and in winter under rcp6 0 showing relative differences of 20 and 52 respectively compared with the cgdpa precipitation 1961 1979 the decrease in precipitation only occurs in winter 45 43 52 and 45 for rcp2 6 rcp4 5 rcp6 0 and rcp8 5 respectively and the other seasons become wetter figs 2b and 3 variations in atmospheric general circulation in east asia and the okhotsk sea are related to the changing precipitation in spring and summer in the north china plain ma et al 2010 4 2 prediction of land use change 4 2 1 prediction of the land use scenario in 2020 based on the land use transition matrix from 2000 to 2010 and the land use map in 2010 as well as the suitability map the land use map of 2014 was simulated using ca markov then the kappa indices were used to validate the accuracy of ca markov by comparing the simulated land use map with the observed land use map in 2014 showing k no of 86 2 k location of 84 5 k locationstrata of 84 5 and k standard of 82 2 all higher than 80 this indicates good projections of land use in the future behera et al 2012 we used ca markov and the land use maps in 2000 and 2010 to predict the land use scenario in 2020 fig 4 before 2000 the land use in the luanhe river basin changed slowly with limited change areas of different land use types during 2000 2014 the land use changed dramatically particularly for forestland grassland and agriculture land with the proportion changed by 16 11 and 7 respectively from 2000 to 2010 the areas of grassland and agriculture land decreased at a rate of 610 km2 yr and 360 km2 yr respectively but the area of forestland increased at a rate of 870 km2 yr we further analyzed changes in the 8 day leaf area index lai 8 day clumping index ci and annual tree cover from modis data for the period 2001 2016 fig 5 the lai in most of the luanhe river basin increased from 2001 to 2016 indicating a denser vegetation the ci decreased indicating that leaves become more clumped both the increased lai and decreased ci are attributed to the increasing proportion of tree cover fig 5 c because the lai of trees is often larger than herbaceous vegetation and therefore shows lower ci values hebei province implemented the afforestation project since 1999 in zhangjiakou and chengde cities and this project will continue by 2021 the forest coverage rate at three tree farms i e the saibei tree farm at zhangjiakou qiansongba tree farm at fengning county in chengde and yudaokou tree farm at weichang county in chengde is expected to reach 73 nowadays the forest coverage rate of chengde has increased to 57 which is highest in north china and its surrounding mountainous areas fig 5 these tree farms function as the first barrier against sandstorms in north china and have largely defended beijing from the sandstorm during recent years furthermore forests enhance the capacity of rainfall retention by conserving water through canopy and vegetation soil and litter layer under it most of the conserved rainfall infiltrates and may contribute more lateral flow over the mountainous region see section 4 4 2 4 2 2 comparison of land use scenarios between 1970 and 2020 here we compared the land use scenario in 2020 predicted by ca markov and the land use scenario in 1970 both of which were used to simulate the future runoff and evaluate the impacts of lucc on runoff comparison shows that the areas of forestland and construction land increase but agriculture land grassland water bodies and unused land decrease table 6 across the entire luanhe river basin the proportion of grassland decreases from 27 in 1970 to 14 in 2020 with the area decreased by 7200 km2 in contrast the forestland increases by 10 700 km2 with the proportion increased from 35 to 55 relative changes in water construction land and unused land are marked but the proportions of them are small such that the changes may have less impact on runoff change trends in land use types in the study area the upper reaches are similar to those in the entire basin however the magnitude of change in grassland in the study area 13 is much smaller than that in the entire basin 50 furthermore we calculated the transition matrix for the period 1970 2020 table 7 in the study area to develop a better understanding of the connection between lucc and possible changes in the hydrological regime results show that the increasing area in forestland is mainly transformed from grassland 1700 km2 and agriculture land 700 km2 meanwhile some of the agriculture land and the unused land are transformed into grassland so that even though a large proportion of grassland is transformed into forest only a relatively small net decrease in grassland occurs i e a relative change of 13 furthermore the areas of water construction land and unused land change remarkably the increasing construction land would increase more impervious surfaces and more rainfall would therefore be converted into surface runoff both afforestation and urbanization promote the transformation among different land use types and influence runoff in the basin profoundly 4 3 model calibration and validation and correction for simulated spring flood the swat model was calibrated for the period 1961 1975 with the initial two years as the warm up period and validated for the period 1976 1979 prior to correction for simulated spring flood r 2 and e ns for the calibration period are 0 74 and 0 67 respectively and are 0 80 and 0 71 for the validation period respectively fig 6 note that the higher metrics of the validation than those of the calibration are in part related to the sample size with 156 and 48 during the calibration and validation periods respectively some studies also have shown similar results of higher metrics in a shorter validation period than those for a longer calibration period shawul et al 2013 thampi et al 2010 even though the values of metrics are acceptable for both calibration and validation periods the spring flood in april could not be simulated well we assume that the spring flood is associated with the total runoff in a year our analysis indicated that the ratio of observed spring flood to total runoff has a significant logarithmic correlation with the annual runoff during 1963 2000 fig 7 a to correct for the simulated future spring flood the relationship mentioned above needs to be translated into the relationship between the total runoff in a year excluding the runoff in april and the ratio of it to the total runoff in a year fig 7 b e g assuming that the spring flood in a year is 10 mm and the total runoff in a year is 50 mm the relationship was built between the ratio of 0 8 40 50 and 40 mm the mean annual ratio of spring flood to total runoff in a year from 1963 to 2000 was found to be 0 12 so it was set as the upper bound for correcting for the simulated spring flood if the ratio of the total runoff excluding spring flood was greater than one the ratio of spring flood was corrected by 4 r 1 0 06771 n x 0 661 x 150 0 12 x 150 where x represents the annual runoff excluding the spring flood mm and r represents the ratio of spring flood to total runoff in a year based on eq 4 the simulated spring flood was corrected during the period 1963 2011 and validated during the period 2001 2011 after the correction for simulated spring flood the values of r 2 and e ns for calibration of swat are 0 81 and 0 78 and for validation are 0 88 and 0 82 respectively moreover we simulated spring flood from 2001 to 2011 using the same parameters during model calibration and corrected for it results show that the correction for the simulated spring flood is effective indicating that the root mean square error for the period 2001 2011 decreases from 14 m3 s to 7 m3 s therefore the parameters of swat for the calibration period and the method of correcting for the simulated spring flood in april were jointly used to simulate streamflow from 2020 2030 using the precipitation outputs from five gcms under four rcps 4 4 predicting runoff for the period 2020 2030 under different land use and climate change scenarios 4 4 1 under the 2020 land use and different climate change scenarios based on the calibrated model runoff under the land use scenario in 2020 during 2020 2030 was simulated and compared to the simulated runoff under the land use scenario in 1970 see section 4 4 2 assuming that the responsive relationship between climate variables and runoff will remain the same kamga 2001 the projected runoff under the 2020 land use scenario varies with different rcps fig 8 the maximum 57 mm and minimum 50 mm mean annual runoff depths are under rcp4 5 and rcp6 0 respectively with rcp8 5 54 mm and rcp2 6 52 mm in between all these simulated runoff depths in the future are higher 39 58 than the observed mean annual runoff of 36 mm for the baseline period 1961 1979 furthermore the streamflow extremes become more intense showing the maximum mean monthly streamflow during 2020 2030 of more than 80 m3 s under four rcps occurring in july or august fig 9 b compared with the observed maximum mean monthly streamflow of 50 m3 s from 1961 to 1979 certain measures may therefore be taken to reduce possible flood disasters including enhancing the discharge capacity of river channels and better managing the operation of reservoirs to adapt to the increasing streamflow and realize the maximum benefits of reservoirs middelkoop et al 2001 moreover mean monthly runoff simulations during 2020 2030 for five cases gfdl26 had26 had60 nor26 and nor85 show the maximum in july but those for the other 15 cases occur in august consistent with the timing of the observed mean monthly streamflow during 1961 1979 fig 9 the mean summer runoff depth increases most significantly showing 32 mm under rcp4 5 100 higher than the observed mean seasonal runoff depth of 16 mm for the period 1961 1979 overall the mean seasonal runoff depth for the period 2020 2030 is higher than the observed runoff for the period 1961 1979 except in spring fig 9 c although precipitation only decreases in winter runoff decreases in spring suggesting that the change in runoff is not determined only by precipitation changes in et and vegetation may also influence the variation in the simulated runoff and the increased forestland can be an important factor the mean annual runoff coefficient in spring and winter is 0 1 and 0 5 during 2020 2030 respectively compared to 0 1 and 0 2 for the period 1961 1979 the increased future runoff coefficient in winter may be related to the increased future precipitation in summer and fall which may lead to soil moisture storage replenished greatly and more runoff generated in winter brown et al 2013 in addition the decreased runoff in spring in the future may also be related to the uncertainty in the correction for the simulated spring flood to some degree 4 4 2 under the 1970 land use and different climate change scenarios here we simulated runoff under the 1970 land use and compared it with that under the 2020 land use scenario fig 10 results show that the predicted runoff for the period 2020 2030 under the 2020 land use scenario is generally lower than that under the 1970 land use scenario indicating that the lucc from 1970 to 2020 is likely to reduce runoff the mean annual runoff depths from the five gcms for the period 2020 2030 under the 1970 land use scenario are 52 3 mm 57 1 mm 50 3 mm and 54 3 mm for the four rcps respectively slightly higher than those under the 2020 land use scenario 51 7 mm 57 0 mm 50 0 mm and 54 3 mm in general the land use change can result in increases or decreases in runoff in different years in the future the lucc i e more forestland but less agriculture land would lead to decreases in runoff in spring fall and winter but increases in summer resulting in slightly decreased mean annual runoff relative to the 1970 land use scenario this highlights that the future change in runoff over this basin is likely to be dominated by climate change though considerable lucc would be taking place the impacts of forest on runoff are mainly realized through affecting canopy interception infiltration and et processes previous studies have found that the land use land cover transition would lead to changes in et and infiltration and consequently changes in water to regional aquifers baker and miller 2013 baldyga et al 2008 some studies pointed out that decreases in forestland cause increases in runoff siriwardena et al 2006 or water yield zhang et al 2014 to further look into the reason for the change in runoff we set up a new swat project with the sdhz station as outlet for which the precipitation of the study area remained constant under the two land use scenarios as different land use scenarios would result in different partitioning of hrus e g 280 and 291 hrus for the 1970 and 2020 land use scenarios in our study area respectively and therefore different hydrological response mechanisms this analysis reduced the impact of neighboring subbasins and only focused on the change in hydrological response within the study area changes in multiple runoff components caused by lucc in our study area under 20 scenarios 5 gcms 4 rcps were analyzed absolute changes in mean annual et water percolation past bottom of soil profile perc surface runoff generated in the watershed surq groundwater contribution to stream gwq and lateral flow contribution to streamflow in watershed latq during 2020 2030 were calculated fig 11 it was found that for the entire study basin total runoff and perc decreased which is attributed to the afforestation and consistent with published studies on the impact of afforestation on runoff in north china liang et al 2015 furthermore runoff components including surq and gwq decrease but the latq increases due to the lucc moreover the decrease in et for some subbasins is mostly attributed to the marked reduction in water area we compared changes in the hydrological fluxes mentioned above between subbasins with changes in water area less than 50 sub1 sub1 accounting for 26 of the study area and subbasins with changes in water area larger than 50 sub2 the decreased water area mainly occurs in sub2 from 124 km2 in the 1970 land use scenario to only 40 km2 in the 2020 land use scenario but the water area keeps generally stable in sub1 results indicate that the mean annual et under 20 cases 5 gcms 4 rcps increases by 3 mm in sub1 fig 11 b but decreases by 2 mm in sub2 fig 11 c and trends in other hydrological fluxes are similar for both sub1 and sub2 given that the proportion of water area for sub2 is larger than sub1 the variation in et is dominated by sub2 and therefore shows a decrease in et across the entire study basin caused by lucc we further selected a subbasin without water bodies and compared the change in hydrological fluxes resulting from lucc i e more forestland but less grassland with agriculture land stable under the 20 cases results show that et and latq increase by up to 6 mm and 1 mm respectively but perc gwq and surq decrease by up to 6 mm 4 mm and 0 9 mm respectively therefore it can be speculated that the decrease in et cross the study basin is likely related to the decrease in water area the increase in forestland and decrease in both agricultural land and grassland can jointly result in decreases in perc surq and gwq but increases in et and latq in our study area description of the et process for water bodies in swat needs to be further improved by considering the water balance so as to reduce the overestimation of et for subbasins with water bodies which may counteract the effect of afforestation on et when water bodies decrease 5 discussion 5 1 impacts of increased forestland on runoff quantifying the impacts of changes in forestland on water availability is of great importance to understand hydrological processes for regions with marked afforestation or deforestation and thereby to the implementation and assessment of ecological restoration projects some studies reveal that the impacts of forests are associated with the area of basin and mainly exert on the baseflow shi and li 2001 during low flow season the decrease in forestland reduces et and interception and then results in increases in soil water content and groundwater recharge finally resulting in the increase in low flow zhang and wei 2012 in our study area the increased forestland results in more latq though surq gwq and streamflow all decrease lateral flow is dominant for hill slope topography and plateau is considered to be inactive in the rainfall runoff process hoang et al 2017 savenije 2010 furthermore mountain regions with hill slopes are mostly forested and plateaus with modest slopes are distributed with grassland and agricultural land savenije 2010 so the increased forestland mainly occurs in the mountainous region and the deeper root of forests can facilitate generation of interflow produced by infiltrated water becker and mcdonnell 1998 we analyzed the rainfall runoff mechanism of the upstream plateau i e subbasins nos 1 9 and the downstream mountainous region i e subbasins nos 10 19 first the mean annual values of six outputs gwq latq perc surq soil water content sw and water yield wyld i e the net amount of water that leaves the subbasin and contributes to streamflow under 20 cases 5 gcms 4 rcps were extracted from outputs of each subbasin then the proportion of the six outputs to the corresponding mean annual precipitation the proportion of gwq latq perc surq sw wyld hereinafter was calculated and averaged among 20 cases under the 1970 fig 12 a and 2020 fig 12 b land use scenarios respectively in general the proportions of perc and sw are higher in the plateau i e the left half part of fig 12 a and b and proportions of latq and wyld are higher in the mountainous region i e the right half part of fig 12 a and b this indicates that plateau is dominated by the vertical hydrological process i e evaporation and percolation and the mountainous area is active in the rainfall runoff process to generate more lateral flow and runoff in addition the proportions of six outputs except gwq in the plateau slightly increase under the 2020 land use scenario compared to those under the 1970 land use scenario but the proportions of the six outputs except latq decrease in the mountainous region this indicates that topography also plays a marked role in regulating hydrology processes and further reflects in the impacts of lucc on runoff components the lucc i e from the 1970 to 2020 land use scenario shows a consistent trend spatially except grassland that increases in the plateau but decreases in the mountainous region that has been transformed into forestland this may be the main reason for the increased perc and sw and decreased gwq on the plateau arising from lucc that is to say topography influences the change pattern of lucc to some degree agricultural land and grassland are often distributed on the plateau with modest slopes and the mountainous region with hill slopes is forested therefore the amplitude and trend in lucc vary with regions of different topography on the other hand different rainfall runoff mechanisms for the plateau and mountainous regions further amplify or counteract the impacts of lucc on runoff e g lateral flow is the dominant runoff component in the mountainous region though the lucc reduces water yield the lateral flow still increases also topography influences the spatial distribution of climate variables i e precipitation and temperature which needs to be well considered for regional climate projection savenije 2010 given the unique topography in our study area with the plateau and mountain regions distributed from the upper reaches to the gauging station lateral flow accounts for a large proportion of the simulated runoff and therefore determines the change in streamflow note that lucc increases runoff in summer 0 3 mm but reduces runoff in the other three seasons on the one hand precipitation is concentrated in summer here and mean monthly potential et is lower than precipitation in july under most scenarios the relatively small potential et indicates that more precipitation may be transformed into lateral flow instead of actual et in summer therefore the impact of lucc on increased latq is more significant which finally increases runoff in summer on the other hand the marked decrease in surq up to 11 in summer also indicates that more water may infiltrate in the soil due to increased forestland 5 2 impacts of model structure on this analysis the analysis of the impact of lucc on runoff reflects the model structure to some degree in swat the soil conservation service scs curve number cn for moisture conditions of each land use type is different overall the order of cn values for different land use types from high to low is agricultural land grassland and forestland the higher value indicates more runoff to be generated zeng et al 2017 the area weighted average of initial cn2 i e the curve number under average moisture over the study area is 57 and 55 under the 1970 and 2020 land use scenarios respectively the distribution of cn2 values for each hrus under the 1970 and 2020 land use scenarios is shown in fig 13 our study basin was divided into 19 subbasins further generating 280 hrus and 291 hrus under the 1970 and 2020 land use scenarios respectively subbasins nos 10 19 are mainly distributed in the mountainous region and the increased forestland mainly occurs across these subbasins therefore the cn2 value is generally higher in the right half part of fig 13 a nos 10 19 i e the 1970 land use scenario than that of fig 13 b i e the 2020 land use scenario furthermore more hrus were generated under the 2020 land use scenario compared to those under the 1970 land use scenario during the partition of hrus in swat the threshold level for land use was set to zero to ensure that the land use would not be influenced by the hrus partition meaning that no land use would be eliminated during the partition process therefore different numbers of hrus further reveal variations in land use distribution i e the changed area and location of different land use types table 7 shows that most of the agricultural land will be transformed into forestland 673 km2 and grassland 719 km2 from 1970 to 2020 with most of the forestland transformed from grassland 1657 km2 the increase in forestland is the main reason for the slightly decreased cn2 value based on the model mechanism water yield of forestland is less than other land use types which should result in less simulated streamflow under the 2020 land use scenario relative to that under the 1970 land use scenario however more factors such as et and infiltration can affect runoff generation making interpretation of the results complicated moreover the partitioning of subbasins and hrus in swat e g the threshold level settings for land use soil and slope in the swat project determine the distribution of hrus would be different under different land use scenarios or basin outlets affecting runoff generation nevertheless the mechanism of runoff generation is complicated because of the synthesized effects of various land use types complicated driving mechanisms various human activities as well as policy changes adhikari and southworth 2012 wang et al 2014 wei et al 2007 future studies will focus on more reasonable prediction of lucc and the mechanism of the impact of partitioning of subbasins and hrus on runoff and hydrological processes 5 3 limitations of this study this study is subjected to some limitations that need to be resolved in future work first the correction for spring flood is straightforward based on the logarithmic relationship between the total runoff in a year excluding the runoff in april and the ratio of it to the total runoff in a year it would be more solid to account for the physical mechanism of the formation of spring flood associated with river thawing several factors such as the date of the river freezing and thawing and the channel discharge in the day when the river is frozen can be taken into account to improve the simulation of spring flood second the prediction of the 2020 land use scenario is based on ca markov and mainly relies on the transition matrix from 2000 to 2010 land use maps however new land use management strategies may be implemented by the government during 2010 2020 that would change the 2020 land use and land cover scenario in addition the suitability maps for transition of different land use land cover types are simplified where only two constraints i e slope and water body are used to determine the suitable area of transformation from one land use type to others third outputs of five gcms under four rcps were used to drive the swat model but the uncertainties have not been well examined in addition climate projections can be further corrected based on the local climate to better simulate the future runoff fourth several simulated hydrological variables such as latq gwq and perc are difficult to examine due to the lack of observations therefore the results are more of reflecting the model structure of swat 6 conclusion the runoff of the luanhe river basin in north china has decreased after the 1980s due to both climate less precipitation and human soil and water conservation factors during recent years afforestation projects have been greatly promoted which has changed the land use land cover in the basin and consequently affected the water availability the increase in forestland but decrease in agricultural land and grassland influence the runoff generation based on the ca markov model the land use scenario for 2020 is predicted showing increases in forestland converted primarily from grassland and agricultural land relative to that in 1970 for the entire luanhe river basin mean annual precipitation from five gcms under four rcps of the study area in the future 2020 2030 increases 1 7 relative to the precipitation for the baseline period 1961 1979 and the seasonal precipitation will decrease only in winter swat as one of the most widely used hydrological models that consider the effects of land use cover on runoff is set up in the upper reaches of the luanhe river basin for the period 1961 1979 with the aim to simulate runoff for the period 2020 2030 under future climate change and two land use scenarios i e 1970 and 2020 respectively results suggest that runoff in the future tends to increase and the seasonal runoff only decreases in spring even though future precipitation decreases in winter the increased summer and fall precipitation may replenish soil moisture storage and increase runoff in winter the relationship between the runoff depth and the rcps is nonlinear i e the maximum 57 mm and minimum 50 mm streamflow appears under the rcp4 5 and rcp6 0 scenarios respectively 39 58 higher than the observed runoff depth of 36 mm during the baseline period the increased precipitation is the main driver for the increase in runoff furthermore lucc afforestation may lead to a slight decrease in mean annual runoff and the seasonal runoff would increase in summer but decrease in the other three seasons for the study area the climate change impact dominates changes in runoff over the study area changes in et perc surq gwq and latq under different land use scenarios indicate that the lucc may lead to increases in et and latq but decreases in surq perc and gwq for areas with limited changes in water bodies even though the surface runoff decreases the lateral flow in summer contributes more water to the stream and therefore dominates the change in runoff furthermore topography influences the impacts of lucc on runoff generation to some degree uncertainties in the future simulation exist because the lucc prediction is based on the historical land use change however it may be influenced by future land use polices and human impacts that are difficult to predict future work can focus on improving prediction of lucc and evaluating uncertainties in climate projections as well as better interpreting the impacts of lucc on runoff here we provide a solution to reveal changes in runoff by considering both lucc and climate change the results can be useful for water resource allocation and land use management in the luanhe river basin with important implications for afforestation and water diversion projects in china and globally under a changing environment acknowledgements this study was supported by the national key research and development program of china 2017yfc0405801 and the national natural science foundation of china grant no 51722903 51579128 and 51620105003 editors and reviewers comments are highly appreciated appendix a calculation of daily solar radiation and dew temperature the solar radiation over the atmosphere was calculated by eq 1 1 h 0 24 π i sc e 0 w t sr sin δ sin ϕ cos δ cos ϕ sin w t sr where h 0 is the radiation over the atmosphere mj m2 d i sc is the solar constant 4 921 mj m2 â h e 0 is the correction factor of the eccentricity of the earth orbit w is the rotation angular velocity of the earth 0 2681 rad h t sr is the length of daytime that the sun rises h δ is the solar declination rad and ϕ is the geographic latitude rad e 0 is calculated by eq 2 proposed by duffie et al 1980 2 e 0 r 0 r 2 1 0 033 cos 2 π d n 365 where r 0 is the average distance of the sun from the earth 1au r is the distance between the sun and the earth on any day au d n is the order number of the day in the year from 1 to 365 or 366 δ is calculated by equation 3 proposed by perrin de brichambaut 1975 3 δ sin 1 0 4 sin 2 π 365 d n 82 t sr is calculated by eq 4 4 t sr cos 1 tan δ tan ϕ w on cloudy days the solar radiation cannot reach the ground directly and therefore a part of the radiation would loss when entering the atmosphere the actual total solar radiation can be calculated by eq 5 pang et al 2007 5 h l 0 8 h 0 where hl is the total solar radiation on sunny day the daily solar radiation was calculated by empirical equation 6 6 h h l a b s s l where h is the daily observed total solar radiation mj m2 â d s is the sunshine duration and sl is the day length assuming that the solar elevation angle at sunrise and sunset is zero sl was calculated by eq 7 tong et al 2005 a and b is empirical coefficients referring to the previous study guo 2006a the value of them was ascertained that a 0 21 and b 0 86 7 s l ω t sr 180 π 2 15 the daily dew point temperature can be calculated by eq 8 8 dew 234 181 log e a 184 2 8 204 log e a where dew is the dew point temperature and e a is the actual vapor pressure mbar appendix b suitability maps for different land uses land covers 
6702,the luanhe river basin the mostly afforested river basin in north china has exhibited significant land use land cover change lucc under climate change that could jointly affect water availability of the basin in the future this study examines both impacts of lucc and climate change on runoff over the upper reaches of the luanhe river basin first the land use in 2020 is predicted based on the cellular automata markov ca markov second a hydrological model soil water assessment tools swat is set up for the baseline period 1961 1979 and driven primarily by outputs from five general circulation models gcms under four representative concentration pathways rcps i e rcp2 6 rcp4 5 rcp6 0 and rcp8 5 for the period 2020 2030 results show that the ensemble mean annual precipitation may increase under four rcps for the period 2020 2030 with the maximum 470 mm yr and minimum 444 mm yr for rcp8 5 and rcp6 0 respectively 1 7 higher than the observed mean annual precipitation 441 mm yr during 1961 1979 the relationship between the runoff simulations and the rcps under the 2020 land use scenario is nonlinear with the maximum 57 mm yr and minimum 50 mm yr mean annual runoff depths under the rcp4 5 and rcp6 0 scenarios respectively 58 and 39 higher than the mean annual observed runoff depth 36 mm yr for the baseline period the increase in forestland 56 and decrease in agriculture land 30 are remarkable for the period 1970 2020 driven primarily by afforestation implemented in the luanhe river basin lucc would lead to a slight decrease in mean annual runoff and the runoff only increases in summer but decreases in other three seasons the decrease in surface runoff and groundwater discharge jointly results in the overall decrease in runoff due to lucc in general the climate change impact will dominate runoff change for the study basin though marked afforestation has taken place and is likely to continue in the future keywords land use cover change climate change runoff change markov swat luanhe river basin 1 introduction with the development of society and economy various human activities have profoundly affected the hydrological cycle and water resources through different pathways li et al 2007 and an important indicator of such impacts is the land use and land cover change lucc deng et al 2015 lambin and meyfroidt 2011 lucc has significant impacts on hydrological processes as well as the economy and ecology of watersheds by regulating runoff generation and routing and evapotranspiration et defries and eshleman 2004 deng et al 2003 the luanhe river basin in north china features marked afforestation over its upper reaches since 1999 for the purposes of reducing sandstorm from inner mongolia to beijing and soil and water conservation three large tree farms i e yudaokou qiansongba and saibei were built during these years where the forest coverage rate reached almost 50 by 2016 and is expected to increase to 73 by 2021 li et al 2017 there are two reservoirs in the midstream of the luanhe river i e the panjiakou reservoir and the daheiting reservoir which are the most important surface water sources for tianjin municipality and tangshan city cao et al 2010 li and huang 2015 the water division project from the luanhe river to tianjin increases water supply and improves water quality and effectively reduces groundwater abstraction and land subsidence in tianjin since the 1950s the hydrological cycle in the luanhe river basin has been remarkably changed driven primarily by the combined effects of climate change and human activities liu et al 2013 due to less rainfall and the effect of soil and water conservation decreases in mean annual runoff have been shown to reach 30 during 1980 2002 compared with the period 1956 1979 which may result in water supply crisis li et al 2014 it is therefore imperative to predict changes in water availability by considering both lucc and climate change in the future so as to formulate adaptation strategies to achieve sustainable use and allocation of water resources precipitation and streamflow in the luanhe river basin have changed markedly after 1979 chen et al 2013 so we selected the period 1961 1979 as the baseline period when both climate change and human activities had little effect on the basin we predicted the land use map of 2020 using the land use transition matrix from 2000 to 2010 which is representative to show the lucc due to afforestation the corresponding future period 2020 2030 was selected to perform runoff simulation under the 2020 land use scenario and the simulations were compared to the results for the baseline period numerous studies have shown the impacts of lucc on streamflow wei et al 2007 classified 131 rainfall events into three regimes to analyze the runoff and soil loss in relation to different land use types runoff simulations under prescribed land use scenarios indicated that runoff increased when the grassland area increased and forestland decreased wang et al 2008 kathumo et al 2011 found a strong relationship between streamflow and land use land cover with a coefficient of determination r 2 of 0 84 in the river gucha catchment kenya dixon and earls 2012 used the soil and water assessment tool swat to examine the effects of urbanization on streamflow simulations also showed that land use change can result in changes in surface runoff and groundwater recharge baker and miller 2013 shi et al 2014 analyzed the responsive relationship between the surface runoff variation and the major landscapes suggesting that the conversion from forestland to farmland and grassland resulted in increases in mean annual surface runoff and total runoff these results show that runoff can be an effective indicator of lucc in watersheds bewket and sterk 2005 because of complicated driving factors and significant variations in lucc li et al 2010 it is challenging to predict lucc precisely given the changing economy land use policy and natural variables iacono et al 2012 li and huang 2015 previous studies used various approaches to depict lucc considering economic growth population social policies and mutual feedbacks among them a dynamic system was set up to model lucc using different driving forces e g land use management and population growth and the future lucc was simulated under different socio economic policies providing reference for decision making for sustainable development yu et al 2011 the markov chain model is a simple probabilistic land use change model based on the markov process in the process the current state depends only on its most adjacent previous period and the transition can be described by transition probability matrices iacono et al 2012 a cellular automata markov ca markov model was used to simulate forest cover changes of a national park to evaluate pre and post policy interventions indicating positive effects of national level policy adhikari and southworth 2012 changes in the relationships between precipitation and streamflow can also be indicative of lucc gupta et al 2015 runoff changes reflect the compound effects of lucc and climate change some previous studies used the coupled model intercomparison project phase 5 cmip5 data set to analyze the impacts of climate change under different scenarios eisner et al 2017 eum et al 2016 neupane et al 2015 teklesadik et al 2017 results of the coupled climate model hadgem2 ao reveal increases in precipitation over tropical regions but decreases over subtropical regions given the expansion of hadley cell over the 21st century in addition changes in soil moisture and sea ice under different representative concentration pathways rcps also show spatial variability baek et al 2013 extreme precipitation events were evaluated over the columbia river basin during 1970 1999 and 2041 2070 under the rcp8 5 scenario by simulating four cmip5 general circulation model gcms dars 2013 though the mean precipitation is projected to decrease the extreme precipitation events show significant increases in some regions in addition investigation into runoff extremes in the future has been done at a finer resolution than gcms over the pacific northwest using regional climate models projections najafi and moradkhani 2015 moreover some studies evaluated the impacts of climate change on streamflow to formulate water management strategies basheer et al 2015 ouyang et al 2015 previous studies have examined the accuracy of some outputs of gcms in china chen and frauenfeld 2014 chen et al 2014 sun et al 2016 and there is a consensus that the resolution of the raw output of gcms is too coarse to describe hydrological processes at regional scales dars 2013 ouyang et al 2015 wilby 2004 wilby et al 1999 ahmadalipour et al 2017 a number of studies have evaluated the impacts of climate change on runoff using multiple gcms and hydrological models eisner et al 2017 teklesadik et al 2017 however climate modeling factors can also influence the variance of streamflow experiments using varied factors e g gcm type project phase emission scenario downscaling method and bias correction indicated that the predicted streamflow is a function of modeling factors and it is unnecessary to consider all the factors as long as the ensemble design is well balanced aamery et al 2016 future impacts of lucc and climate change on runoff can be evaluated simultaneously in the brahmaputra river basin sensitivities of et streamflow total water yield groundwater recharge to co2 concentration temperature and precipitation changes were evaluated indicating that et and groundwater recharge are more sensitive to changes in co2 concentration and precipitation respectively pervez and henebry 2015 more studies focusing on lucc and climate change or their impacts on streamflow can be found in table 1 the overall objective of this study is to systematically investigate both impacts of lucc i e mainly afforestation and climate change i e mainly variations in precipitation on future runoff for the upper reaches of the luanhe river i e the upper panjiakou reservoir this objective of this study was achieved by performing these following four steps 1 runoff simulation for the baseline period 1961 1979 under the 1970 land use scenario using swat 2 prediction of the land use land cover in 2020 using ca markov 3 runoff simulation for the period 2020 2030 under different land use land cover scenarios 1970 and 2020 and four rcps i e rcp2 6 rcp4 5 rcp6 0 and rcp8 5 and 4 examination of both impacts of lucc and climate change scenarios on future runoff 2020 2030 results of this study should improve our understanding of variations in runoff for the study basin under a range of lucc and climate change scenarios and will provide reference for formulating adaptation strategies for better water resources management in the future this will also benefit water diversion projects of the luanhe river for its neighboring megacities in north china with important implications for other water diversion projects in china and globally under a changing environment 2 study area and data 2 1 study area the luanhe river basin is on the north of the north china plain in the haihe river basin ranging from 39 02 n 42 43 n and 115 34 e 119 50 e fig 1 the luanhe river rises at the northern foot of the bayanguertu mountain in zhangjiakou prefecture of hebei province flowing through 27 counties of hebei province inner mongolia and liaoning province and ending up in the bohai bay in laoting county liu 2012 almost 500 tributaries flow into the pinnate luanhe river water system along the way li 2005 the luanhe river spans 888 km controlling 44 750 km2 area bordered by the chaobai river and jiyun river to the southwest and adjacent to the bohai sea in the south shan et al 2013 shi 2013 the luanhe river basin can generally be divided into three geomorphological units i e plateau mountain and plain in terms of different geology geomorphology and formation types the plateau topography is mainly located in the northern part of the basin with elevations ranging between 1400 and 1600 m the mountainous regions are located on the south of the plateau and on the north of the plain with slopes ranging between 20 and 40 the plain is distributed in the south of the basin li 2005 the basin is characterized by decreasing temperatures from south to north ranging from 10 6 c to 1 4 c and the highest and lowest temperatures appear in july and january reaching 40 c and 26 c respectively liu 2012 interannual and intra annual variations in precipitation are marked the mean annual precipitation for the entire basin is 390 800 mm that mainly falls in july and august in addition the precipitation in wetter years can be 1 7 3 5 times of the driest year li 2005 the dividing line of the temperate zone and warm temperate zone passes through the basin as a result the basin is characterized by temperate grassland and warm temperate deciduous broad leaved forest vegetation from north to south li 2005 in this study we selected the upper reaches of the luanhe river to evaluate the impacts of lucc and climate change on streamflow the sandaohezi gauging station hereafter termed as the sdhz station was selected to evaluate the change in streamflow the drainage area of the sdhz station is 17 100 km2 including the most afforested region in the upper reaches of the luanhe river basin 2 2 data 2 2 1 meteorological data meteorological data used in this study were obtained from the meteorological data center of the china meteorological administration http data cma cn including annual daily average temperature annual daily average maximum and minimum temperatures annual daily average precipitation average daily relative humidity average daily wind speed daily sunshine duration and average daily vapor pressure from 1951 through 2014 the daily meteorological data during 1995 2014 were used to calculate the parameters of the weather generator to fill gaps of meteorological data in addition we used the china gauge based daily precipitation analysis cgdpa product from 1961 to 1979 to drive swat cgdpa is a daily precipitation product based on a national surface observational network with a high resolution 0 25 0 25 or 27 km 27 km over mainland china shen and xiong 2016 furthermore we selected data sets from five gcms gfdl esm2m hadgem2 es ipsl cm5a lr miroc esm chem and noresm1 m table 2 which were bias corrected and downscaled at a 0 5 0 5 spatial resolution to the watch forcing data wfd weedon et al 2011 in the fast track of the inter sectoral impact model inter comparison project isi mip liu et al 2013 the wfd combines the era 40 daily data i e the daily reanalysis data and the climate research unit ts2 1 data set cru with observed time series of monthly variations in the climate and the monthly mean precipitation is corrected with the global precipitation climatology centre full data set version 4 gpcc hempel et al 2013 the isi mip focuses on advancing our knowledge on climate change risks and the quantitative and cross sectoral synthesis of different impacts of climate change covering global water agriculture biodiversity and many other aspects https esg pik potsdam de projects isimip2a the bias corrected data sets could reflect changes in climate variability and atmosphere mean and could better investigate the effects of extreme hydrological events hempel et al 2013 leng et al 2015 the projected meteorological data sets i e daily precipitation maximum and minimum temperatures relative humidity wind speed solar radiation from 2020 to 2030 were derived from these five gcms based on the subbasins partitioned by swat the centroid of each grid cell of precipitation and subbasin was determined then the value of the nearest grid cell of precipitation was taken to represent the precipitation of the subbasin in addition if the subbasin was large enough to cover more than one grid cell the mean precipitation value of these grid cells were calculated and assigned to the subbasin finally the precipitation was allocated to each hru in the subbasin i e precipitation of all hrus in the subbasin is the same 2 2 2 land use and other data six land use and land cover maps spanning from 1970 to 2014 were obtained from the chinese academy of sciences the types of land use were further divided into six categories according to the land use classification system of the chinese academy of sciences i e agriculture land forestland grassland water construction land and unused land table 3 the main land use types of the luanhe river basin include agriculture land forestland and grassland accounting for more than 90 area of the entire basin marked lucc has been found across the basin featured by increased forestland but deceased agricultural and grassland for instance the forested area increased by 8700 km2 45 during 2000 2014 yet it remained generally stable and even slightly decreased since 2010 on the contrary agriculture land decreased considerably during 2000 2014 with the area decreased by 3900 km2 23 the area of grassland also decreased with its fraction decreasing from 26 in 2000 to 15 in 2014 the overall trend of land use change in the study area upper reaches is quite similar to the trend in the entire basin during 1970 2014 however the trend of land use change in the study area is not that significant until 2000 monthly streamflow data of the sdhz station for the period 1961 2011 were derived from year book of hydrologic data of the people s republic of china hydrological data of the haihe river basin the dem of the study region was obtained from 90 m 90 m srtm dem data set v1 provided by the cold and arid regions sciences data center at lanzhou china http westdc westgis ac cn soil data were derived from the soil database of china generated by the nanjing institute of soil the chinese academy of sciences 3 methodology 3 1 markov chain model and cellular automata markov the markov process is a random process that a system undergoes transitions from one state to another the properties of which include no aftereffect i e the current state of a system just depends on the last adjacent period and stability du et al 2015 if both the time series and events of the process are discrete we call the markov process as the markov chain iacono et al 2012 eq 1 describes the properties of the markov chain 1 p d t d t 1 where p is the transition probability matrix dt and dt 1 are the land use at time t and t 1 respectively each type of land use is projected by the probability pij of land use i transformed into land use j as follows 2 p ij a ij a i 3 j 1 k p ij 1 where ai is the total transformed area of class i over the transition period aij is the area of land use i transformed into land use j and k is the number of the land use types halmy et al 2015 muller and middleton 1994 previous studies have shown the applicability of the markov chain to predict land use status and change in the future du et al 2015 gao and xu 2010 guo 2006b he et al 2014 to build a markov chain model the initial state and the transition matrix need to be determined to describe the transition ca markov combines ca and the markov chain that can predict both quantitative and spatial change of land use and land cover the ca model is based on the previous state and simultaneously considers the state of the neighborhood cells to predict the transition adhikari and southworth 2012 despite the weakness in expressing the impacts of one cell on the entire state space ca markov integrates the advantages of ca and the markov chain to predict the land use and land cover transition more reasonably and accurately that have been widely used behera et al 2012 halmy et al 2015 sang et al 2011 subedi et al 2013 two constraints i e slope and water body were used to determine the suitable area of transformation from one land use type to others slope was considered as the constraint for agriculture land forestland water and construction land with the slope of suitable conversion area less than 15 65 1 and 25 respectively according to related policies and research behera et al 2012 water body was considered as the constraint for all land use types excluding water and unused land constraint maps for different land uses were expressed using the boolean map with suitable transformation areas coded with one and others coded with zero behera et al 2012 kallali et al 2007 multi criteria evaluation mce was adopted with the boolean intersection function to generate suitability maps for each land use type suitability maps for each land use are shown in appendix b before prediction the accuracy of ca markov should be validated first we predicted the land use map of 2014 with the land use maps of 2000 and 2010 as inputs and then evaluated the predicted land use map of 2014 with the corresponding reference land use map kappa indices were used to evaluate the predicted land use map of 2014 including kappa for no information k no kappa for location k location kappa for stratum level location k locationstrata and kappa for standard k standard with values above 80 indicating good performance of prediction gashaw et al 2017 singh et al 2015 after the evaluation the land use maps of 2000 and 2010 were imported into idrisi to create the transition matrix and predict the land use in 2020 using the transition matrix the 2010 land use map and the suitability map 3 2 soil water assessment tool swat is a public domain hydrologic model that can be applied from small watersheds to large river basins to simulate quantity and quality of surface and groundwater abbaspour et al 2007 dixon and earls 2012 teshager et al 2016 time steps of simulation using swat can be daily monthly and yearly http swat tamu edu the model has been widely used due to the solid physical mechanism that can be applied to complex large watersheds li 2008 yu et al 2008 input data of swat include dem soil land use and weather in addition look up tables of land use table 4 and soil should be written to connect with the database built in swat parameters of the weather generator were calculated by wgnmaker 4 1 http swat tamu edu here we chose chengde laoting duolun qinglong and weichang weather stations fig 1 and calculated the parameters to fill gaps in meteorological data inputs of wgnmaker 4 1 include daily precipitation daily highest and lowest temperature and daily maximum precipitation in half an hour for lack of the daily maximum precipitation in half an hour the data were estimated by using daily precipitation divided by 48 approximately daily solar radiation and dew temperatures as inputs were calculated by equations in appendix a land use scenarios in 1970 and 2020 were used in the swat simulation first under the land use scenario of 1970 and driven by the cgdpa precipitation monthly streamflow was calibrated for the period 1961 1975 with the initial two years set as the warm up period and validated for the period 1976 1979 in order to fully calibrate the model under the 1970 land use and ensure that the year 1970 was included during calibration we selected the longer period 1963 1975 for calibration and the period 1976 1979 for validation given that the streamflow was influenced significantly by human activities after the 1980s the model was calibrated manually and automatically using the sufi 2 algorithm by swat cup and 16 parameters were selected and identified table 5 the coefficient of determination r 2 and nash sutcliffe efficiency coefficient e ns were used to evaluate the model performance however the spring flood in april at the sdhz station could not be simulated well by swat because the spring flood is more related to river thawing recorded by year book of hydrologic data of the people s republic of china hydrological data of the haihe river basin whose mechanism is not depicted in this model therefore we proposed an empirical method to correct for the poor simulations of spring flood in april see section 4 3 second we used the outputs from five gcms under four rcps and the 2020 land use scenario to drive swat and simulate streamflow during 2020 2030 third we used the land use map of 1970 to replace the land use map of 2020 and simulated streamflow for the same period to quantify the impacts of lucc on runoff note that when the land use map was changed from 2020 to 1970 the initial parameters of swat related to land use i e cn2 were subsequently adjusted automatically e g the area weighted average of cn2 for a subbasin is 68 in 2020 and 78 in 1970 given the calibrated value of the relative change in cn2 e g 10 the initial value of cn2 can be adjusted automatically under a different land use scenario therefore cn2 values under different simulation scenarios are changed accordingly with land use maps 4 results 4 1 projected precipitation from general circulation models precipitation plays a critical role in runoff simulation and the variability in precipitation leads to a complicated hydrological regime houston 2006 moulin et al 2008 saifullah et al 2016 for ease of expression outputs from different gcms under rcps are hereafter referenced to as the combination of the abbreviated names of gcms and the representative numbers of rcps e g gfdl26 represents the output from gfdl esm2m under the rcp2 6 scenario the projected precipitation by the five gcms under four rcps for the study area the upper reaches of the luanhe river basin shows the mean annual precipitation of 458 mm 4 increase 458 mm 4 increase 444 mm 1 increase and 470 mm 7 increase under rcp2 6 rcp4 5 rcp6 0 and rcp8 5 respectively relative to the mean annual precipitation of 441 mm from cgdpa precipitation for the baseline period 1961 1979 the precipitation is mainly concentrated in july and august and some of the future precipitation e g had45 had85 and nor26 is much higher than the historical level reflected by cgdpa data for the period 1961 1979 implying large possibility of flooding in summer in the future specifically july shows the highest monthly precipitation in a year among all the gcms and rcp scenarios except miroc26 showing the highest precipitation in august fig 2 a the basin belongs to the warm temperate zone monsoon climate with four distinct seasons characterized by hot and rainy summer cold and dry winter and dry spring we looked into projected seasonal precipitation i e spring i e mam summer i e jja fall i e son and winter djf the mean precipitation from all gcms and rcps for the period 2020 2030 in the four seasons is 63 mm 9 increase 312 mm 4 increase 77 mm 10 increase and 6 mm 45 decrease respectively compared with the observed mean precipitation of 58 mm 301 mm 70 mm and 11 mm in the four seasons from cgdpa data 1961 1979 fig 2b the strongest increase and decrease in precipitation occur in fall under rcp8 5 and in winter under rcp6 0 showing relative differences of 20 and 52 respectively compared with the cgdpa precipitation 1961 1979 the decrease in precipitation only occurs in winter 45 43 52 and 45 for rcp2 6 rcp4 5 rcp6 0 and rcp8 5 respectively and the other seasons become wetter figs 2b and 3 variations in atmospheric general circulation in east asia and the okhotsk sea are related to the changing precipitation in spring and summer in the north china plain ma et al 2010 4 2 prediction of land use change 4 2 1 prediction of the land use scenario in 2020 based on the land use transition matrix from 2000 to 2010 and the land use map in 2010 as well as the suitability map the land use map of 2014 was simulated using ca markov then the kappa indices were used to validate the accuracy of ca markov by comparing the simulated land use map with the observed land use map in 2014 showing k no of 86 2 k location of 84 5 k locationstrata of 84 5 and k standard of 82 2 all higher than 80 this indicates good projections of land use in the future behera et al 2012 we used ca markov and the land use maps in 2000 and 2010 to predict the land use scenario in 2020 fig 4 before 2000 the land use in the luanhe river basin changed slowly with limited change areas of different land use types during 2000 2014 the land use changed dramatically particularly for forestland grassland and agriculture land with the proportion changed by 16 11 and 7 respectively from 2000 to 2010 the areas of grassland and agriculture land decreased at a rate of 610 km2 yr and 360 km2 yr respectively but the area of forestland increased at a rate of 870 km2 yr we further analyzed changes in the 8 day leaf area index lai 8 day clumping index ci and annual tree cover from modis data for the period 2001 2016 fig 5 the lai in most of the luanhe river basin increased from 2001 to 2016 indicating a denser vegetation the ci decreased indicating that leaves become more clumped both the increased lai and decreased ci are attributed to the increasing proportion of tree cover fig 5 c because the lai of trees is often larger than herbaceous vegetation and therefore shows lower ci values hebei province implemented the afforestation project since 1999 in zhangjiakou and chengde cities and this project will continue by 2021 the forest coverage rate at three tree farms i e the saibei tree farm at zhangjiakou qiansongba tree farm at fengning county in chengde and yudaokou tree farm at weichang county in chengde is expected to reach 73 nowadays the forest coverage rate of chengde has increased to 57 which is highest in north china and its surrounding mountainous areas fig 5 these tree farms function as the first barrier against sandstorms in north china and have largely defended beijing from the sandstorm during recent years furthermore forests enhance the capacity of rainfall retention by conserving water through canopy and vegetation soil and litter layer under it most of the conserved rainfall infiltrates and may contribute more lateral flow over the mountainous region see section 4 4 2 4 2 2 comparison of land use scenarios between 1970 and 2020 here we compared the land use scenario in 2020 predicted by ca markov and the land use scenario in 1970 both of which were used to simulate the future runoff and evaluate the impacts of lucc on runoff comparison shows that the areas of forestland and construction land increase but agriculture land grassland water bodies and unused land decrease table 6 across the entire luanhe river basin the proportion of grassland decreases from 27 in 1970 to 14 in 2020 with the area decreased by 7200 km2 in contrast the forestland increases by 10 700 km2 with the proportion increased from 35 to 55 relative changes in water construction land and unused land are marked but the proportions of them are small such that the changes may have less impact on runoff change trends in land use types in the study area the upper reaches are similar to those in the entire basin however the magnitude of change in grassland in the study area 13 is much smaller than that in the entire basin 50 furthermore we calculated the transition matrix for the period 1970 2020 table 7 in the study area to develop a better understanding of the connection between lucc and possible changes in the hydrological regime results show that the increasing area in forestland is mainly transformed from grassland 1700 km2 and agriculture land 700 km2 meanwhile some of the agriculture land and the unused land are transformed into grassland so that even though a large proportion of grassland is transformed into forest only a relatively small net decrease in grassland occurs i e a relative change of 13 furthermore the areas of water construction land and unused land change remarkably the increasing construction land would increase more impervious surfaces and more rainfall would therefore be converted into surface runoff both afforestation and urbanization promote the transformation among different land use types and influence runoff in the basin profoundly 4 3 model calibration and validation and correction for simulated spring flood the swat model was calibrated for the period 1961 1975 with the initial two years as the warm up period and validated for the period 1976 1979 prior to correction for simulated spring flood r 2 and e ns for the calibration period are 0 74 and 0 67 respectively and are 0 80 and 0 71 for the validation period respectively fig 6 note that the higher metrics of the validation than those of the calibration are in part related to the sample size with 156 and 48 during the calibration and validation periods respectively some studies also have shown similar results of higher metrics in a shorter validation period than those for a longer calibration period shawul et al 2013 thampi et al 2010 even though the values of metrics are acceptable for both calibration and validation periods the spring flood in april could not be simulated well we assume that the spring flood is associated with the total runoff in a year our analysis indicated that the ratio of observed spring flood to total runoff has a significant logarithmic correlation with the annual runoff during 1963 2000 fig 7 a to correct for the simulated future spring flood the relationship mentioned above needs to be translated into the relationship between the total runoff in a year excluding the runoff in april and the ratio of it to the total runoff in a year fig 7 b e g assuming that the spring flood in a year is 10 mm and the total runoff in a year is 50 mm the relationship was built between the ratio of 0 8 40 50 and 40 mm the mean annual ratio of spring flood to total runoff in a year from 1963 to 2000 was found to be 0 12 so it was set as the upper bound for correcting for the simulated spring flood if the ratio of the total runoff excluding spring flood was greater than one the ratio of spring flood was corrected by 4 r 1 0 06771 n x 0 661 x 150 0 12 x 150 where x represents the annual runoff excluding the spring flood mm and r represents the ratio of spring flood to total runoff in a year based on eq 4 the simulated spring flood was corrected during the period 1963 2011 and validated during the period 2001 2011 after the correction for simulated spring flood the values of r 2 and e ns for calibration of swat are 0 81 and 0 78 and for validation are 0 88 and 0 82 respectively moreover we simulated spring flood from 2001 to 2011 using the same parameters during model calibration and corrected for it results show that the correction for the simulated spring flood is effective indicating that the root mean square error for the period 2001 2011 decreases from 14 m3 s to 7 m3 s therefore the parameters of swat for the calibration period and the method of correcting for the simulated spring flood in april were jointly used to simulate streamflow from 2020 2030 using the precipitation outputs from five gcms under four rcps 4 4 predicting runoff for the period 2020 2030 under different land use and climate change scenarios 4 4 1 under the 2020 land use and different climate change scenarios based on the calibrated model runoff under the land use scenario in 2020 during 2020 2030 was simulated and compared to the simulated runoff under the land use scenario in 1970 see section 4 4 2 assuming that the responsive relationship between climate variables and runoff will remain the same kamga 2001 the projected runoff under the 2020 land use scenario varies with different rcps fig 8 the maximum 57 mm and minimum 50 mm mean annual runoff depths are under rcp4 5 and rcp6 0 respectively with rcp8 5 54 mm and rcp2 6 52 mm in between all these simulated runoff depths in the future are higher 39 58 than the observed mean annual runoff of 36 mm for the baseline period 1961 1979 furthermore the streamflow extremes become more intense showing the maximum mean monthly streamflow during 2020 2030 of more than 80 m3 s under four rcps occurring in july or august fig 9 b compared with the observed maximum mean monthly streamflow of 50 m3 s from 1961 to 1979 certain measures may therefore be taken to reduce possible flood disasters including enhancing the discharge capacity of river channels and better managing the operation of reservoirs to adapt to the increasing streamflow and realize the maximum benefits of reservoirs middelkoop et al 2001 moreover mean monthly runoff simulations during 2020 2030 for five cases gfdl26 had26 had60 nor26 and nor85 show the maximum in july but those for the other 15 cases occur in august consistent with the timing of the observed mean monthly streamflow during 1961 1979 fig 9 the mean summer runoff depth increases most significantly showing 32 mm under rcp4 5 100 higher than the observed mean seasonal runoff depth of 16 mm for the period 1961 1979 overall the mean seasonal runoff depth for the period 2020 2030 is higher than the observed runoff for the period 1961 1979 except in spring fig 9 c although precipitation only decreases in winter runoff decreases in spring suggesting that the change in runoff is not determined only by precipitation changes in et and vegetation may also influence the variation in the simulated runoff and the increased forestland can be an important factor the mean annual runoff coefficient in spring and winter is 0 1 and 0 5 during 2020 2030 respectively compared to 0 1 and 0 2 for the period 1961 1979 the increased future runoff coefficient in winter may be related to the increased future precipitation in summer and fall which may lead to soil moisture storage replenished greatly and more runoff generated in winter brown et al 2013 in addition the decreased runoff in spring in the future may also be related to the uncertainty in the correction for the simulated spring flood to some degree 4 4 2 under the 1970 land use and different climate change scenarios here we simulated runoff under the 1970 land use and compared it with that under the 2020 land use scenario fig 10 results show that the predicted runoff for the period 2020 2030 under the 2020 land use scenario is generally lower than that under the 1970 land use scenario indicating that the lucc from 1970 to 2020 is likely to reduce runoff the mean annual runoff depths from the five gcms for the period 2020 2030 under the 1970 land use scenario are 52 3 mm 57 1 mm 50 3 mm and 54 3 mm for the four rcps respectively slightly higher than those under the 2020 land use scenario 51 7 mm 57 0 mm 50 0 mm and 54 3 mm in general the land use change can result in increases or decreases in runoff in different years in the future the lucc i e more forestland but less agriculture land would lead to decreases in runoff in spring fall and winter but increases in summer resulting in slightly decreased mean annual runoff relative to the 1970 land use scenario this highlights that the future change in runoff over this basin is likely to be dominated by climate change though considerable lucc would be taking place the impacts of forest on runoff are mainly realized through affecting canopy interception infiltration and et processes previous studies have found that the land use land cover transition would lead to changes in et and infiltration and consequently changes in water to regional aquifers baker and miller 2013 baldyga et al 2008 some studies pointed out that decreases in forestland cause increases in runoff siriwardena et al 2006 or water yield zhang et al 2014 to further look into the reason for the change in runoff we set up a new swat project with the sdhz station as outlet for which the precipitation of the study area remained constant under the two land use scenarios as different land use scenarios would result in different partitioning of hrus e g 280 and 291 hrus for the 1970 and 2020 land use scenarios in our study area respectively and therefore different hydrological response mechanisms this analysis reduced the impact of neighboring subbasins and only focused on the change in hydrological response within the study area changes in multiple runoff components caused by lucc in our study area under 20 scenarios 5 gcms 4 rcps were analyzed absolute changes in mean annual et water percolation past bottom of soil profile perc surface runoff generated in the watershed surq groundwater contribution to stream gwq and lateral flow contribution to streamflow in watershed latq during 2020 2030 were calculated fig 11 it was found that for the entire study basin total runoff and perc decreased which is attributed to the afforestation and consistent with published studies on the impact of afforestation on runoff in north china liang et al 2015 furthermore runoff components including surq and gwq decrease but the latq increases due to the lucc moreover the decrease in et for some subbasins is mostly attributed to the marked reduction in water area we compared changes in the hydrological fluxes mentioned above between subbasins with changes in water area less than 50 sub1 sub1 accounting for 26 of the study area and subbasins with changes in water area larger than 50 sub2 the decreased water area mainly occurs in sub2 from 124 km2 in the 1970 land use scenario to only 40 km2 in the 2020 land use scenario but the water area keeps generally stable in sub1 results indicate that the mean annual et under 20 cases 5 gcms 4 rcps increases by 3 mm in sub1 fig 11 b but decreases by 2 mm in sub2 fig 11 c and trends in other hydrological fluxes are similar for both sub1 and sub2 given that the proportion of water area for sub2 is larger than sub1 the variation in et is dominated by sub2 and therefore shows a decrease in et across the entire study basin caused by lucc we further selected a subbasin without water bodies and compared the change in hydrological fluxes resulting from lucc i e more forestland but less grassland with agriculture land stable under the 20 cases results show that et and latq increase by up to 6 mm and 1 mm respectively but perc gwq and surq decrease by up to 6 mm 4 mm and 0 9 mm respectively therefore it can be speculated that the decrease in et cross the study basin is likely related to the decrease in water area the increase in forestland and decrease in both agricultural land and grassland can jointly result in decreases in perc surq and gwq but increases in et and latq in our study area description of the et process for water bodies in swat needs to be further improved by considering the water balance so as to reduce the overestimation of et for subbasins with water bodies which may counteract the effect of afforestation on et when water bodies decrease 5 discussion 5 1 impacts of increased forestland on runoff quantifying the impacts of changes in forestland on water availability is of great importance to understand hydrological processes for regions with marked afforestation or deforestation and thereby to the implementation and assessment of ecological restoration projects some studies reveal that the impacts of forests are associated with the area of basin and mainly exert on the baseflow shi and li 2001 during low flow season the decrease in forestland reduces et and interception and then results in increases in soil water content and groundwater recharge finally resulting in the increase in low flow zhang and wei 2012 in our study area the increased forestland results in more latq though surq gwq and streamflow all decrease lateral flow is dominant for hill slope topography and plateau is considered to be inactive in the rainfall runoff process hoang et al 2017 savenije 2010 furthermore mountain regions with hill slopes are mostly forested and plateaus with modest slopes are distributed with grassland and agricultural land savenije 2010 so the increased forestland mainly occurs in the mountainous region and the deeper root of forests can facilitate generation of interflow produced by infiltrated water becker and mcdonnell 1998 we analyzed the rainfall runoff mechanism of the upstream plateau i e subbasins nos 1 9 and the downstream mountainous region i e subbasins nos 10 19 first the mean annual values of six outputs gwq latq perc surq soil water content sw and water yield wyld i e the net amount of water that leaves the subbasin and contributes to streamflow under 20 cases 5 gcms 4 rcps were extracted from outputs of each subbasin then the proportion of the six outputs to the corresponding mean annual precipitation the proportion of gwq latq perc surq sw wyld hereinafter was calculated and averaged among 20 cases under the 1970 fig 12 a and 2020 fig 12 b land use scenarios respectively in general the proportions of perc and sw are higher in the plateau i e the left half part of fig 12 a and b and proportions of latq and wyld are higher in the mountainous region i e the right half part of fig 12 a and b this indicates that plateau is dominated by the vertical hydrological process i e evaporation and percolation and the mountainous area is active in the rainfall runoff process to generate more lateral flow and runoff in addition the proportions of six outputs except gwq in the plateau slightly increase under the 2020 land use scenario compared to those under the 1970 land use scenario but the proportions of the six outputs except latq decrease in the mountainous region this indicates that topography also plays a marked role in regulating hydrology processes and further reflects in the impacts of lucc on runoff components the lucc i e from the 1970 to 2020 land use scenario shows a consistent trend spatially except grassland that increases in the plateau but decreases in the mountainous region that has been transformed into forestland this may be the main reason for the increased perc and sw and decreased gwq on the plateau arising from lucc that is to say topography influences the change pattern of lucc to some degree agricultural land and grassland are often distributed on the plateau with modest slopes and the mountainous region with hill slopes is forested therefore the amplitude and trend in lucc vary with regions of different topography on the other hand different rainfall runoff mechanisms for the plateau and mountainous regions further amplify or counteract the impacts of lucc on runoff e g lateral flow is the dominant runoff component in the mountainous region though the lucc reduces water yield the lateral flow still increases also topography influences the spatial distribution of climate variables i e precipitation and temperature which needs to be well considered for regional climate projection savenije 2010 given the unique topography in our study area with the plateau and mountain regions distributed from the upper reaches to the gauging station lateral flow accounts for a large proportion of the simulated runoff and therefore determines the change in streamflow note that lucc increases runoff in summer 0 3 mm but reduces runoff in the other three seasons on the one hand precipitation is concentrated in summer here and mean monthly potential et is lower than precipitation in july under most scenarios the relatively small potential et indicates that more precipitation may be transformed into lateral flow instead of actual et in summer therefore the impact of lucc on increased latq is more significant which finally increases runoff in summer on the other hand the marked decrease in surq up to 11 in summer also indicates that more water may infiltrate in the soil due to increased forestland 5 2 impacts of model structure on this analysis the analysis of the impact of lucc on runoff reflects the model structure to some degree in swat the soil conservation service scs curve number cn for moisture conditions of each land use type is different overall the order of cn values for different land use types from high to low is agricultural land grassland and forestland the higher value indicates more runoff to be generated zeng et al 2017 the area weighted average of initial cn2 i e the curve number under average moisture over the study area is 57 and 55 under the 1970 and 2020 land use scenarios respectively the distribution of cn2 values for each hrus under the 1970 and 2020 land use scenarios is shown in fig 13 our study basin was divided into 19 subbasins further generating 280 hrus and 291 hrus under the 1970 and 2020 land use scenarios respectively subbasins nos 10 19 are mainly distributed in the mountainous region and the increased forestland mainly occurs across these subbasins therefore the cn2 value is generally higher in the right half part of fig 13 a nos 10 19 i e the 1970 land use scenario than that of fig 13 b i e the 2020 land use scenario furthermore more hrus were generated under the 2020 land use scenario compared to those under the 1970 land use scenario during the partition of hrus in swat the threshold level for land use was set to zero to ensure that the land use would not be influenced by the hrus partition meaning that no land use would be eliminated during the partition process therefore different numbers of hrus further reveal variations in land use distribution i e the changed area and location of different land use types table 7 shows that most of the agricultural land will be transformed into forestland 673 km2 and grassland 719 km2 from 1970 to 2020 with most of the forestland transformed from grassland 1657 km2 the increase in forestland is the main reason for the slightly decreased cn2 value based on the model mechanism water yield of forestland is less than other land use types which should result in less simulated streamflow under the 2020 land use scenario relative to that under the 1970 land use scenario however more factors such as et and infiltration can affect runoff generation making interpretation of the results complicated moreover the partitioning of subbasins and hrus in swat e g the threshold level settings for land use soil and slope in the swat project determine the distribution of hrus would be different under different land use scenarios or basin outlets affecting runoff generation nevertheless the mechanism of runoff generation is complicated because of the synthesized effects of various land use types complicated driving mechanisms various human activities as well as policy changes adhikari and southworth 2012 wang et al 2014 wei et al 2007 future studies will focus on more reasonable prediction of lucc and the mechanism of the impact of partitioning of subbasins and hrus on runoff and hydrological processes 5 3 limitations of this study this study is subjected to some limitations that need to be resolved in future work first the correction for spring flood is straightforward based on the logarithmic relationship between the total runoff in a year excluding the runoff in april and the ratio of it to the total runoff in a year it would be more solid to account for the physical mechanism of the formation of spring flood associated with river thawing several factors such as the date of the river freezing and thawing and the channel discharge in the day when the river is frozen can be taken into account to improve the simulation of spring flood second the prediction of the 2020 land use scenario is based on ca markov and mainly relies on the transition matrix from 2000 to 2010 land use maps however new land use management strategies may be implemented by the government during 2010 2020 that would change the 2020 land use and land cover scenario in addition the suitability maps for transition of different land use land cover types are simplified where only two constraints i e slope and water body are used to determine the suitable area of transformation from one land use type to others third outputs of five gcms under four rcps were used to drive the swat model but the uncertainties have not been well examined in addition climate projections can be further corrected based on the local climate to better simulate the future runoff fourth several simulated hydrological variables such as latq gwq and perc are difficult to examine due to the lack of observations therefore the results are more of reflecting the model structure of swat 6 conclusion the runoff of the luanhe river basin in north china has decreased after the 1980s due to both climate less precipitation and human soil and water conservation factors during recent years afforestation projects have been greatly promoted which has changed the land use land cover in the basin and consequently affected the water availability the increase in forestland but decrease in agricultural land and grassland influence the runoff generation based on the ca markov model the land use scenario for 2020 is predicted showing increases in forestland converted primarily from grassland and agricultural land relative to that in 1970 for the entire luanhe river basin mean annual precipitation from five gcms under four rcps of the study area in the future 2020 2030 increases 1 7 relative to the precipitation for the baseline period 1961 1979 and the seasonal precipitation will decrease only in winter swat as one of the most widely used hydrological models that consider the effects of land use cover on runoff is set up in the upper reaches of the luanhe river basin for the period 1961 1979 with the aim to simulate runoff for the period 2020 2030 under future climate change and two land use scenarios i e 1970 and 2020 respectively results suggest that runoff in the future tends to increase and the seasonal runoff only decreases in spring even though future precipitation decreases in winter the increased summer and fall precipitation may replenish soil moisture storage and increase runoff in winter the relationship between the runoff depth and the rcps is nonlinear i e the maximum 57 mm and minimum 50 mm streamflow appears under the rcp4 5 and rcp6 0 scenarios respectively 39 58 higher than the observed runoff depth of 36 mm during the baseline period the increased precipitation is the main driver for the increase in runoff furthermore lucc afforestation may lead to a slight decrease in mean annual runoff and the seasonal runoff would increase in summer but decrease in the other three seasons for the study area the climate change impact dominates changes in runoff over the study area changes in et perc surq gwq and latq under different land use scenarios indicate that the lucc may lead to increases in et and latq but decreases in surq perc and gwq for areas with limited changes in water bodies even though the surface runoff decreases the lateral flow in summer contributes more water to the stream and therefore dominates the change in runoff furthermore topography influences the impacts of lucc on runoff generation to some degree uncertainties in the future simulation exist because the lucc prediction is based on the historical land use change however it may be influenced by future land use polices and human impacts that are difficult to predict future work can focus on improving prediction of lucc and evaluating uncertainties in climate projections as well as better interpreting the impacts of lucc on runoff here we provide a solution to reveal changes in runoff by considering both lucc and climate change the results can be useful for water resource allocation and land use management in the luanhe river basin with important implications for afforestation and water diversion projects in china and globally under a changing environment acknowledgements this study was supported by the national key research and development program of china 2017yfc0405801 and the national natural science foundation of china grant no 51722903 51579128 and 51620105003 editors and reviewers comments are highly appreciated appendix a calculation of daily solar radiation and dew temperature the solar radiation over the atmosphere was calculated by eq 1 1 h 0 24 π i sc e 0 w t sr sin δ sin ϕ cos δ cos ϕ sin w t sr where h 0 is the radiation over the atmosphere mj m2 d i sc is the solar constant 4 921 mj m2 â h e 0 is the correction factor of the eccentricity of the earth orbit w is the rotation angular velocity of the earth 0 2681 rad h t sr is the length of daytime that the sun rises h δ is the solar declination rad and ϕ is the geographic latitude rad e 0 is calculated by eq 2 proposed by duffie et al 1980 2 e 0 r 0 r 2 1 0 033 cos 2 π d n 365 where r 0 is the average distance of the sun from the earth 1au r is the distance between the sun and the earth on any day au d n is the order number of the day in the year from 1 to 365 or 366 δ is calculated by equation 3 proposed by perrin de brichambaut 1975 3 δ sin 1 0 4 sin 2 π 365 d n 82 t sr is calculated by eq 4 4 t sr cos 1 tan δ tan ϕ w on cloudy days the solar radiation cannot reach the ground directly and therefore a part of the radiation would loss when entering the atmosphere the actual total solar radiation can be calculated by eq 5 pang et al 2007 5 h l 0 8 h 0 where hl is the total solar radiation on sunny day the daily solar radiation was calculated by empirical equation 6 6 h h l a b s s l where h is the daily observed total solar radiation mj m2 â d s is the sunshine duration and sl is the day length assuming that the solar elevation angle at sunrise and sunset is zero sl was calculated by eq 7 tong et al 2005 a and b is empirical coefficients referring to the previous study guo 2006a the value of them was ascertained that a 0 21 and b 0 86 7 s l ω t sr 180 π 2 15 the daily dew point temperature can be calculated by eq 8 8 dew 234 181 log e a 184 2 8 204 log e a where dew is the dew point temperature and e a is the actual vapor pressure mbar appendix b suitability maps for different land uses land covers 
6703,this work investigates regionalization techniques for large scale model applications in the frame of a pan european assessment of water resources covering approx 740 000 km2 in western europe using the swat platform four variants of the similarity based regionalization approach were compared the first two involved unsupervised clustering to define hydrological regions before performing hydrological model calibration whereas the last two involved supervised clustering after performing calibration similarity is defined using partial least squares regression plsr analysis that identifies watershed physiographic characteristics that are most relevant for the selected hydrological response indices the plsr results indicate that typically available watershed characteristics such as geomorphology land use climate and soil properties describe reasonably well the average hydrological conditions but poorly the extreme events regionalization variants considering unsupervised clustering and supervised clustering performed similarly well when using all available information however results indicate that supervised clustering uses data more efficiently and may be more suitable when data are scarce it is demonstrated that parsimonious use of available data can be achieved using both regionalization techniques finally model performance consistently becomes acceptable by calibrating watersheds covering only 10 of the model domain thus making the calibration task affordable in terms of time and computational resources required keywords clustering hydrological modelling large scale regionalization similarity swat 1 introduction hydrologic and water quality models have emerged as essential tools for successful implementation of regional to continental scale river basin planning initiatives such as the european water framework directive wfd ec 2000 hartnett et al 2007 the ambitious spatial scale of these models and multiple modellers and stakeholders involved exacerbate the challenges inherent to environmental modelling including reaching agreement on modelling objectives selection of suitable models assessment of data quality model parameter estimation model assessment reporting of model uncertainty and assumptions and review and auditing processes this calls for frameworks that support uniform implementation of model procedures and clarity on the modelling decisions taken this paper addresses this by developing model parameter estimation and assessment procedures suitable for pan european hydrological modelling focusing on ungauged watersheds where conventional model calibration approaches are not applicable while much of europe benefits from a large number of gauged watersheds combining data from the global runoff data centre grdc the european water archive ewa and national databases the principal parameter estimation problem in a pan european modelling exercise is that of ungauged watersheds although some models attempt to include physics based parameters such as channel slopes which may be directly estimated from measured properties of a watershed it is generally agreed that acceptable model accuracy can only be achieved by empirical estimation of at least some of the parameters which for ungauged catchments is approached via regionalization prediction in ungauged basins pub initiative wagener and montanari 2011 sivapalan 2003 winsemius et al 2009 blöschl et al 2013 hrachowitz et al 2013 a large number of hydrological model regionalization methods have been proposed in the literature all of these are based around the concept that information about hydrological response can be transferred between watersheds that may be assumed to be hydrologically similar usually based on knowledge of their relevant properties such as land cover the differences between approaches lie in the type of information that is transferred the transfer method and the watershed properties used to quantify similarity the most common approach is regression of model parameters that are calibrated at gauged donor watersheds against the corresponding watershed characteristics the regression model can then be used to estimate the hydrological model parameters at any ungauged watershed for which the same characteristics are known typically linear regressions are used for each model parameter independently heuvelmans et al 2006 gitau and chaubey 2010 other more sophisticated relationships including non linear weighted and sequential regressions have also been applied kay et al 2006 abdulla and lettenmaier 1997 li et al 2010 where a large number of inter related characteristics are potentially relevant their principal components have been used as inputs to regression livneh and lettenmaier 2013 with the increasing use of continental scale models remote sensed data leaf area index canopy height among others has increasingly been relied upon chaney et al 2016 although widely used the regression approach has major limitations including that model parameters may not be strongly related to measurable attributes and further parameter inter dependency is often too complex to encompass satisfactorily in the regression or overlooked a second group of approaches avoids regression by transferring the entire set of information about hydrological response between watersheds commonly this is implemented in the following way for each ungauged watershed a donor watershed is identified that is most similar in terms of watershed characteristics and the ungauged watershed then receives the complete parameter set calibrated for the donor watershed if it is considered that there is some uncertainty about the most similar donor watershed the approach may be extended to identifying clusters of similar watersheds bormann et al 1999 bormann 2010 ramachandra rao and srinivas 2006 and transferring ensembles of hydrological models within the cluster mcintyre et al 2005 reichl et al 2009 drogue and khediri 2016 the primary advantage of this approach is that the model parameter inter dependencies are maintained rather than being simplified to facilitate regression parajka et al 2005 a simplification of this transfer approach is where spatial proximity between watersheds is used as a proxy of similarity sometimes implemented within a kriging framework skøien et al 2006 patil and stieglitz 2012 a drawback of these methods is the question of whether or not similar watersheds tend to occur in close proximity to each other parajka et al 2005 wagener and wheater 2006 an alternative to either regression or similarity based approaches is spatial interpolation of calibrated parameters although spatial complexity is likely to affect applicability it has been found to be an efficient approach for large scale applications troy et al 2008 as can been seen from the examples cited in this review both the regression and transfer approaches have been applied to a range of hydrological model types ranging from simple conceptual type models to highly parameterised land surface models either the regression or transfer approaches may be combined with regional scale calibration two main methods have been used first the calibration of the parameters of the hydrological model can be combined with estimating the parameters of the regression fernandez et al 2000 parajka et al 2007 which sacrifices performance at gauged locations in order to optimise the precision of the regression model second all gauged watersheds that fall within a region e g viney et al 2015 or cluster of similar watersheds e g szolgay et al 2003 may be calibrated simultaneously to produce a parameter set that is applicable across all watersheds in the region or cluster inter comparisons of approaches have not identified one that consistently performs better parajka et al 2005 mcintyre et al 2005 kay et al 2006 ayzel et al 2017 oudin et al 2008 suggested that this may be due to differences in data types differences in the selected watershed characteristics and differences in model structures for pan european applications such as this in the context of the eu initiative blue print to safeguard europe s water resources ec 2012 the clustering of watersheds according to expected hydrological similarity and the transfer of model parameter sets within clusters may be preferred the large range of watershed types involved and the large number of parameters mean that the regression based methods are not considered promising instead priority research questions relate to watershed clustering strategies that support the transfer of parameter sets to ungauged watersheds and identifying information gaps that limit the success of the strategy when using the similarity approach the problem lies in how to identify hydrologically similar watersheds i e watersheds with similar response to precipitation input quantified through hydrological signatures that are relevant to the prediction context sawicz et al 2011 typically regionalization studies assume that watersheds that have apparently similar physical characteristics have similar hydrological behaviour for example reichl et al 2009 identified as similarity measures commonly used watershed attributes based on geomorphology vegetation cover climate and soil properties although with considerable uncertainty about which were the optimal characteristics oudin et al 2010 compared pools of hydrologically similar watersheds with pools of apparently physically similar watersheds concluding that a significant overlap occurred only for 60 of the watersheds furthermore recent studies suggest that similarity in watershed streamflow response is dynamic and highly dependent on flow conditions patil and stieglitz 2011 therefore the selection of physical characteristics upon which to base the similarity measure is a challenging part of the ungauged catchment problem following from this in the context of pan european hydrological modelling the aims of this paper are 1 develop an objective procedure for selecting watershed properties that are relevant for defining clusters of hydrologically similar watersheds 2 compare approaches to clustering watersheds and transferring hydrological model parameter sets within these clusters in terms of model performance from small watershed up to continental scales 3 identify the primary information gaps that increase variance within clusters and limit ungauged watershed performance 2 materials and methods 2 1 description of the study area the region modelled is located in western europe and covers an area of 736 780 km2 see fig 1 the most important river basins in terms of drainage area include the rhine 160 221 km2 the loire 116 981 km2 the rhone 96 619 km2 the seine 75 990 km2 the garonne 55 703 km2 the meuse 32 047 km2 the dordogne 23 902 km2 the scheldt 18 949 km2 the adour 16 861 km2 and the vilaine 10 490 km2 the modelled area covers france belgium and luxemburg an important part of switzerland half the netherlands one third of germany and parts of austria spain and italy 2 2 hydrological modelling platform in the context of the blue print there is a need for a common uniformly applied hydrological model to support a common understanding of errors assumptions and limits of applicability there is also a need for a model that allows links between land and water management and output variables in terms of a range of hydrological and water quality variables to be simulated swat arnold et al 1998 arnold and fohrer 2005 was selected as a modelling platform that can potentially meet these requirements swat is a basin scale semi distributed conceptual model that operates on a continuous time scale with a daily time step swat subdivides a basin into subwatersheds which are connected by a stream network subwatersheds can be further divided into hydrologic response units hrus which are unique combinations of land use soil type and slope hydrologic simulation is based on the water balance equation and is separated into two major components the land phase which simulates the amount of water sediment nutrient and pesticide loadings to the main channel of each subwatershed and the routing phase which simulates the movement of water sediments and nutrients through the watershed channel network to the outlet neitsch et al 2009 within the land phase swat simulates the processes of snow fall and melting and the build up of the subflows that compose the streamflow namely baseflow interflow and overland flow the plant growth simulation submodel within the swat land cover component is based on the epic plant growth model williams 1995 2 3 model input the model was set up using readily available datasets for the geographical data chaplot 2005 and bormann et al 2009 have shown that the swat model results may be significantly affected by the spatial resolution of these data the resolutions considered next are based on a trade off between the resolutions at which the data are readily available at the pan european level and the size of the subwatersheds considered as discussed further in this section a digital elevation map dem at 100 100 m resolution was obtained from the shuttle radar topography mission srtm a land use map at 1 1 km for the year 2000 was built from the combination of the common agricultural policy regionalized impact modelling system capri britz 2004 the center for sustainability and global environment sage monfreda et al 2008 the history database of the global environment hyde 3 klein goldewijk and van drecht 2006 and the global land cover glc2000 bartholomé and belward 2005 databases a soil map at 1 1 km was obtained from the harmonized world soil database hwsd fao iiasa isric iss cas jrc 2008 the soil parameters required in this study were adapted directly from the hwsd and calculated using pedotransfer functions for saturated hydraulic conductivity wösten et al 1998 and for the universal soil loss equation usle soil erodibility factor williams 1995 subwatershed and stream delineation corresponds to the hydroeurope geodatabase developed by bouraoui and aloe 2009 based on the catchment characterization modelling version 2 ccm2 database for continental europe vogt et al 2007 data regarding 33 reservoirs and lakes with an area larger than 20 km2 were obtained from the global lakes and wetland database glwd lehner and döll 2004 and the ccm2 database vogt et al 2007 climate data used in this study included daily precipitation temperature solar radiation wind speed and relative humidity obtained from the monitoring agricultural resources mars rijks et al 1998 meteorological database which is a gridded data set 25 25 km discharge data used for parameter calibration and validation were collected from a number of sources including the global runoff data centre grdc the flemish environmental agency eaufrance and the general directorate of waters of the ministry of environment of spain that after quality and consistency examination resulted in 698 stations with daily data for the period 1980 2009 or sub periods therein 2 4 model setup the model was implemented in swat2009 using the arcgis swat interface winchell et al 2010 it includes the river basins mentioned earlier as well as neighbouring coastal basins the total modelled area is 736 780 km2 and it was divided based on the ccm2 database into 4 216 subwatersheds with an average size of 175 km2 the subwatersheds were defined using dominant soil land use types and slope i e only one hru was determined within a subwatershed these subwatersheds were considered to be an appropriate modelling unit because this resolution is an adequate trade off between model detail and computational resources needed to model at continental scale elevation bands were used in steep subwatersheds to represent snow and precipitation gradients from hereafter we refer to subwatersheds as the smallest modelling unit irrigated areas were defined by overlaying the land use map and the fao global irrigation map siebert et al 2007 management practices that include auto irrigation and fertilization were defined as fractions of potential heat unit requirements of the crops heat units were calculated for each crop using local climate data fertilizer applications were obtained for the year 2000 from capri britz 2004 management practices were adjusted and validated by controlling the optimal growth of the crops and by comparing simulated crop yields with country statistics extracted from eurostat agricultural database official national statistics reported by member states to the european commission the model includes only reservoirs and lakes with areas larger than 20 km2 and other hydraulic influences have not been included 2 5 calibration a step wise calibration protocol was applied as described in pagliero et al 2014 step wise calibration was implemented by separating the watershed response output into the three main flow components baseflow interflow and overland flow snow melt was also calibrated by adjusting the timing of the hydrograph parameters were calibrated sequentially through the flow components initial parameter values derived through the arcswat interface were used as starting points for the optimization arcswat extracts for every hru and or subwatershed topographic parameters from the dem map assigns parameter values of soil type and land use by clipping soil type and land use input maps and matches subwatersheds and weather stations based on location di luzio et al 2004 olivera et al 2006 model parameters included those calibrated are presented in section a 1 in the appendices calibration was performed in 246 selected head subwatersheds the selection criteria were they are head subwatersheds i e there are no upstream subwatersheds and flow monitoring data is available for 1995 2004 this period was selected because it corresponds to the most complete consecutive period of flow data available see section 2 3 using head subwatersheds as well as avoiding the need to calibrate two or more subwatersheds together limited the influence that hydraulic structures and other regulation strategies and man made influences have on the river flows a combination of manual and automated sufi 2 abbaspour et al 2004 calibration was applied the efficiency criterion was br2 which is a combination of r2 and the gradient b of the regression between measured and predicted daily flow on which r2 is based by weighting r2 by b under or over predictions are quantified together with the correlations krause et al 2005 for a more comprehensive characterization of the performance the normalized root mean square error nrmse and the percent bias pbias which measures the average tendency of the simulated values to be larger positive pbias or smaller negative pbias than the observed ones were also calculated given the aim of the model to support water quality management for which both short and longer duration flows are important monthly flow performance was assessed as well 2 6 defining watershed similarity in this work regionalization is based on the similarity approach physiographic watershed characteristics were selected that can be derived for the entire study area and that are potentially relevant for explaining the hydrological response to capture a broad spectrum of flow conditions a variety of discharge characteristics were considered see table 1 partial least squares regression plsr wold 1960 geladi and kowlaski 1986 was used to identify the most important combinations of watershed characteristics plsr bears some relation to principal components analysis pca in that both techniques are useful for reducing high dimension multivariate systems that include co linear variables but plsr also exposes the relationships between defined sets of independent and dependent variables thus plsr is more useful for prediction godoy et al 2014 in the current context the independent variables x are the set of watershed characteristics and the dependent variables y are the set of flow characteristics table 1 the reduced dimensions to which x is transformed are the so called latent variables because these latent variables are linearly related to the watershed characteristics they can be calculated for all subwatersheds gauged and ungauged further because plsr selected the latent variables that best explain the linear relation between watershed and discharge characteristics they may be used to define hydrological similarity the plsr analysis was in this study performed using the r package pls mevic and wehrens 2007 from the 698 monitoring points available for this study 462 spatially distinct watersheds no upstream gauges were selected for the plsr analysis they include the 246 head subwatersheds selected for calibration plus 216 gauges that are classed as spatially distinct but do not meet the criteria for being in the calibration set table a3 further clarifies how the 698 flow gauges were classed and used fig 2 shows the 462 watersheds they represent a good coverage of the study area the variables in the plsr analysis have different scales therefore the data for each variable were normalized this is performed by setting the variance equal to one and the mean equal to zero plsr was performed by adding latent variables into the regression up to the maximum of 19 equal to the number of watershed characteristics each time a latent variable was added a leave one out cross validation prediction was performed this involved 462 regressions each time including 461 data sets with the 462nd used for validation and calculating the root mean squared error of prediction rmsep over all 462 validation results the number of latent variables taken forward to the regionalization step was judged based on the rate of improvement in rmsep 2 7 regionalization four alternatives for regionalization based on clustering were investigated fig 3 2 7 1 unsupervised clustering the first two alternatives unsup reg and unsup best are based on unsupervised clustering of all subwatersheds both gauged and ungauged into clusters assumed to be hydrologically homogeneous according to the latent variable space followed by calibration of gauged subwatersheds see section 2 5 to derive a single set of model parameters for each cluster in method unsup reg a regional calibration was performed this involved for a sampled parameter set calculating a single objective function that summarizes the performance of all calibration subwatersheds in the cluster after sampling is complete this results in a single best parameter set that is then transferred to all ungauged subwatersheds in that cluster in the method unsup best calibration subwatersheds are calibrated individually after which the calibration subwatershed with the best performance per cluster yields the single parameter set that is transferred to all ungauged subwatersheds in that cluster while this clustering method may be considered supervised clustering in the sense that the plsr and hence the clustering is informed by the hydrological indices we call it unsupervised clustering because the centroids and number of clusters are not prespecified hierarchical unsupervised cluster analysis was employed using ward s minimum variance linkage method ward 1963 together with the euclidean distance similarity ward s minimum variance criterion minimizes the total within cluster variance initially all clusters are singletons and at each step the two clusters with minimum cluster distance are merged validity indices were used to find the best partitioning to fit the underlying data i e to determine the number of clusters kovacs et al 2005 the corrected rand index which measures the level of agreement in cluster membership between clusters was selected and also the meilǎ s variation of information which measures the distance between two partitions of the same dataset meilǎ 2007 these were calculated using the fpc package in r hennings 2010 the partition selected was that with the lowest corrected rand index maximizing the distance between clusters and the highest meilǎ s variation index minimizing the distances within the cluster 2 7 2 supervised clustering the other two alternatives fig 3 sup 246don and sup 53don involve supervised clustering around a number of calibrated donor subwatersheds each donor subwatershed is predefined as a cluster centroid in the latent variables space the clustering is performed and all ungauged subwatersheds that fall into that cluster receive the parameter set of the donor subwatershed in method sup 246don all 246 calibrated subwatersheds were used as donors and cluster centroids while in method sup 53don only the 53 subwatersheds with the highest calibration performances were used the k nearest neighbour was used as classification rule using the euclidean distance function on the latent variables space to be consistent with the unsupervised clustering method this classification was performed using the nnr function of the r package supclust dettling and maechler 2012 in this work we refer to this approach as supervised because the number of clusters and their centroids are defined a priori this definition differs from the more common view of supervised clustering as a modification of standard clustering algorithms to identify class uniform clusters i e a supervised model selection of unsupervised clustering e g finley and joachims 2005 michel et al 2012 ismaili et al 2016 2 8 validation validation is done by comparing simulated and observed monthly discharge at the 452 monitoring points with available data that were not used for calibration table a3 clarifies how watersheds were classed into calibration and validation watersheds goodness of fit parameters were calculated using the r package hydrogof zambrano 2010 for all four alternatives the calibrated parameters were used for the 246 calibration subwatersheds rather than regionalized values this is relevant because some of the validation points are downstream of these subwatersheds in addition regionalization performances were compared with those obtained using the parameter values taken from the swat library neitsch et al 2009 which are called here the initial parameters performances were not compared with those obtainable using calibrated parameters because the validation watersheds generally consist of a large number of subwatersheds and the necessity of a simplified approach to their joint calibration would not necessarily lead to a good benchmark to test the regionalization techniques for large aggregations of watersheds and for continental scale applications the simulated and observed discharges were compared at points close to the outlets of major basins 3 results 3 1 defining similarity using partial least squares regression table 2 shows the cumulative percentages of the variance of the discharge characteristics explained by adding up to 19 latent variables it is seen that the watershed characteristics most commonly available topography land use soil and climate are not sufficient for fully explaining the hydrological response for example in our study 100 of the variability of the watershed characteristics see x value explained only 24 6 of the variability of the coefficient of variation of the annual minima and 26 4 of the ratio baseflow discharge in summer in general characteristics describing average conditions e g annual total flow baseflow and quickflow means are better explained than characteristics describing extreme events see e g daily discharges with probabilities of exceedance 50 70 and 90 fig 4 shows the corresponding rmsep values the starting rmsep value of 1 0 corresponds to the prediction error using zero latent variables i e the standard deviation of the scaled flow characteristics from there results the first four latent variables were considered to explain most of the information contained in the dataset table 3 shows that the first latent variable contains characteristics related to topography temperatures and percentage of cropland whereas meteorological characteristics are present in the second and third latent variable and soil properties in the fourth latent variable the latent variables were calculated for all 4216 subwatersheds gauged and ungauged and used as the basis for clustering 3 2 unsupervised clustering unsup reg and unsup best fig 5 shows the corrected rand and meilă s indices for different numbers of clusters from which five partitions were selected at this point the corrected rand index is minimised indicating dissimilarity between clusters and at the same time the meilă s index is maximised indicating a good linkage between cluster members the resulting hydrological clusters are presented in fig 6 most of these regions are spatially interconnected and moreover comparison with fig 1 shows that the resulting hydrological regions are consistent with topography and land use maps the spatially distinct head subwatersheds used for calibration are also shown in fig 6 the numbers of calibration watersheds are 118 55 41 13 and 19 for regions 1 2 3 4 and 5 respectively the calibrated subwatersheds with the best performance per hydrological region unsup best are indicated in red table 4 compares the performances of unsup reg and unsup best in the validation watersheds both regionalization methods perform better than when using the initial ini parameters for example br2 equals 0 54 when the initial parameters are used and 0 65 and 0 61 using unsup reg and unsup best unsup reg performs better than unsup best for the normalized root mean squared error nrmse but on average it underestimates the discharge the average of the 246 calibration performances the averages of the pooled calibration per cluster for unsup reg alternative and the best calibration performance per cluster for unsup best alternative are presented in table a2 in the appendices 3 3 supervised clustering sup 246don and sup 53don using sup 246don where all 246 calibrated subwatersheds were used as cluster centroids the size of clusters varied from 1 to 99 i e there were clusters consisting of solely the calibrated subwatershed therefore not resulting a suitable donor to any ungauged subwatershed for the sup 53don method from the 246 possible donor subwatersheds only those with a nrmse lower than 50 were used this resulted in 53 donor subwatersheds with cluster sizes from 1 to 335 table 4 shows that at the validation points sup 246don and sup 53don perform better than the initial ini parameters for example br2 is 0 64 for sup 246don and 0 63 for sup 53don against 0 54 using the initial parameters analysing all the performance indicators sup 246don performs better than sup 53don 3 4 comparing performance of the regionalization methods the regionalization methods with the best performance are sup 246don and unsup reg which both transferred information from all 246 subwatersheds in contrast with sup 53don and unsup best methods which used only a subset of the 246 subwatersheds based on calibration performances sup 246don has lowest standard deviation of br2 over all validation subwatersheds table 4 as well as the lowest minimum value of br2 also as well as having the lowest average nrmse it has by far the lowest standard deviation of nrmse there is some evidence therefore that sup 246don gives less variable performance than unsup reg the br2 performance of sup 53don 53 donor subwatersheds although lower than that of unsup reg only decreases by circa 2 from 0 65 to 0 63 for the validation watersheds while using only 22 of the available donor watersheds this result suggests that the supervised clustering method is more efficient in using information at least when the model performs well in the selected donor subwatersheds fig 7 shows the spatial variability of br2 across all 698 calibration and validation monitoring points for sup 246don and unsup reg and it can be seen that simulations improved throughout the study area predictions were affected by the presence of karst formations according to the geological map of europe they are present in approximately 25 of the modelled domain and are distributed throughout the area indicated in yellow in fig 7 subwatersheds containing more than 50 of karst areas were not considered for regional calibration or as donor subwatersheds but they were included in the validation we separated the performance of the validation watersheds that are more than 50 karstic table 4 it is seen that results using initial parameters are worse for the karstic watersheds the regionalization improved the simulations more so for the non karstic watersheds results for percent bias pbias suggest that on average in karstic watersheds simulated discharges are underestimated table 4 performances at basin scale were found to be less variable than at smaller watersheds and a little higher on average than over the full validation data set which may be presumed to be due to integration of random errors in the data and parameter estimates table 5 lists the monitoring points located near the outlet of the major continental scale basins and their performances using unsup reg and sup 246don results show that for the rhine the garonne the dordogne the vilaine and the rhone unsup reg performs better although for the rhone the initial parameter estimates are the best while sup 246don performs better for the loire and the adour and both alternatives perform similarly for the loire and the adour the continental scale catchments with exceptions of the highly karstic dordogne and rhone have better performances than the average found in the subwatersheds fig 8 shows the simulated versus observed monthly hydrographs for the loire the vilaine and the seine river basins for the loire river basin fig 8a the case sup 246don performs better and for the vilaine river basin fig 8b the simulated discharge for the unsup reg alternative has a better agreement with the observed one when we compare these results for the seine river basin fig 8c both alternatives perform similarly however for that basin the sup 246don alternative simulates slightly better the shape of the discharge signal whereas alternative unsup reg simulates better the peaks 4 discussion this paper investigates alternative regionalization techniques for continental scale hydrological modelling although the swat model was used the regionalization methods used are independent of the chosen hydrological model the regionalization techniques are based on the similarity approach which transfers the calibrated parameter sets of gauged watersheds to similar ungauged watersheds in our work similarity is defined by a combination of observable watershed physical characteristics that are linearly related to a selected set of hydrologic signature indices as defined by plsr this removes much of the subjectivity in selecting similarity metrics however the similarity metrics will depend on the selected hydrological signatures in this study as the final objective of the hydrological model is to simulate both water quantity and water quality the latter depending on multiple aspects of the flow regime the hydrological indices used cover a wide range of hydrological conditions the selection of the hydrological characteristics however is not fixed and used must be in agreement with the project objectives the identification of similarity metrics is also restricted by the linearity assumption in the plsr although this may be addressed by exploring suitable non linear transforms of the variables it was shown that the watershed characteristics most commonly available topography land use soil and climate are not sufficient for fully explaining the hydrological response especially flow variability and low flows similar findings were obtained by merz and blöschl 2004 2005 and merz et al 2006 these results are also in agreement with the results found in oudin et al 2010 and suggest that additional watershed characteristics may need to be incorporated this is likely to include hydrogeologic characteristics and or watershed flow regulation characteristics data that are not available over the broad scale of this study karst was isolated as a particular potential issue and results show evidence that performance was overall worse in more karstic watersheds table 4 when integrating to large catchment scale table 5 performance was poor in two catchments with high presence of karst although relatively good in the seine which has the highest presence of karst the relative success of the unsup reg alternative supports the view that suitable model parameters can be obtained if a number of gauged watersheds in a region in this case in a region defined by similarity are used simultaneously in a regional calibration although the value of regional calibration with its goal of modelling regional trends rather than local hydrology is still controversial parajka et al 2007 the present study shows that regional calibration is at least as successful as alternative regionalization approaches and is potentially useful in continental scale modelling where calibration options are severely constrained by data time and computational resources in the supervised clustering approach the number of clusters and their centroids are defined a priori but results showed that after the clustering process there were available donor subwatersheds that were discarded by the data i e resulted in clusters with only one member the calibrated subwatershed this indicates that in this approach ungauged subwatersheds cluster towards the most suitable donors and discard those that are not further the discarded subwatersheds are not forced to join any cluster and remain with their calibrated parameters this approach results in more variability in the regionalized calibrated parameters using the regionalization techniques investigated here we avoid the potential propagation of errors downstream that can be present in more standard calibration procedures in most nested calibration studies a basin is calibrated in steps starting with the headwater watersheds then moving downstream to monitoring points carrying along calibration errors and uncertainties this may lead to overcalibration to compensate for errors in the downstream watersheds e g due to hydraulic influences ignored by the model in addition the use of the similarity approach identifies watersheds with different hydrological behaviours and assigns different parameter sets accordingly a fact that is often overlooked in typical calibration procedures where the entire upstream drainage area is calibrated to match the discharge at the outlet whether the accuracy of flows in individual types of watershed is important or not depends on the application but even in a continental scale application the potential dependence of water quality on local features supports the need for parameter estimation at the smallest possible scale supported by the data results of the techniques defining hydrological regions a priori and a posteriori are similar e g results for unsup reg versus sup 246don in tables 4 and 5 reasons behind the relative success of one regionalization method for a particular basin are not clear analysis of results with both methods do not indicate any consistency or aggregation of errors with scale we believe that the selection of the regionalization technique is case specific and depends largely on the amount and quality of available data as well as the uncertainty that inevitably arises when selecting and calibrating a hydrological model beven 2006 significant uncertainty is likely to arise from the regionalization process uncertainty exists in the hydrologic signature and physiographic characteristic estimates there are assumptions and subjectivity involved in selecting signatures and in the plsr and the clustering and the impact of unavailable but theoretically relevant physiographic characteristics is unknown the relative success of the alternative regionalisation approaches is likely to be related to the relative importance of these sources of uncertainty and their relative importance compared to model equifinality and rainfall and flow observation uncertainty recommended extension of this work is to explicitly quantify the uncertainties and conduct a sensitivity analysis that provides greater insight into which of them is affecting choice of regionalization procedure 5 conclusions four regionalization techniques were investigated in the context of pan european hydrological modelling each technique aimed to regionalize the information in relatively small and non overlapping gauged subwatersheds to give flow predictions at multiple scales up to the largest continental scale rivers each technique used the similarity approach to regionalization the watershed characteristics defining similarity were selected based on their degree of relevance to selected hydrological signature indices identified using partial least squares regression similar watersheds were defined through advanced clustering the first two techniques define the hydrological regions a priori based only on the watershed characteristics termed unsupervised clustering while the second two techniques define the regions a posteriori after model calibration with the clusters centred on gauged sub watersheds termed supervised clustering although the swat model was considered appropriate due to the prior effort invested in its calibration and the breadth and depth of experience of swat that exists in europe all four regionalization methods can be applied to any hydrological model results showed that the supervised clustering performed better overall for either supervised or unsupervised clustering using all available gauged subwatersheds performed better than using only a sub sample as may be expected however the overall performance of the supervised clustering was good even when using the 53 gauged subwatersheds with the best performance in calibration this suggests that when available information is scarce supervised clustering can give acceptable results using the proposed regionalization techniques the available data for calibration were efficiently used even when including all gauged subwatersheds only 10 of the modelled area was calibrated and the performance at the larger scale validation points significantly improved across all the performance measures relative to using the initial swat model parameters although model performances were considered good overall it was shown that watershed characteristics most commonly available topography land use soil and climate are not always sufficient and additional information should ideally be included with priorities being karst and other hydrogeological properties and flow regulation data acknowledgments this work was funded by grant gh20 of the joint research centre european commission we thank alberto aloe institute for environment and sustainability joint research centre european commission for his expert support with spatial data management and processing the authors would like to thank as well the three anonymous reviewers for their critical and constructive comments on an earlier version of the manuscript that helped in making substantial improvements to the manuscript appendix a 1 calibration parameters and calibration results calibrated parameters related to flow simulation are presented in table a1 for the calibration parameters c calibration ranges were set considering authors experience and literature recommendations but for parameters related to properties that were interpolated from input data as cn2 sol awc and sol k they were varied as a percentage of their original values to maintain heterogeneity performance metrics for the average of the individual calibration of the calibration subwatersheds for the averages of the pooled calibration per cluster for unsup reg alternative and for the calibration subwatershed with the best performance per cluster for unsup best alternative are presented in the table a2 results of the average performance of the individual calibration of the calibration subwatersheds indicates that br2 increased from 0 46 with the initial conditions to 0 63 after calibration when calibrating calibration subwatersheds pooled per region unsup reg performance results as expected are lower increasing br2 indicator from 0 51 with initial conditions to 0 60 for cluster 1 from 0 44 to 0 51 for cluster 2 from 0 40 to 0 47 for cluster 3 from 0 44 to 0 46 for cluster 4 and from 0 41 to 0 43 for cluster 5 performance indicators of the selected calibration subwatershed per cluster for the unsup best alternative are above a br2 of 0 80 for all regions except for region 4 that is 0 68 table a2 a 2 use of gauged data table a3 synthetizes the use of monitoring points data 
6703,this work investigates regionalization techniques for large scale model applications in the frame of a pan european assessment of water resources covering approx 740 000 km2 in western europe using the swat platform four variants of the similarity based regionalization approach were compared the first two involved unsupervised clustering to define hydrological regions before performing hydrological model calibration whereas the last two involved supervised clustering after performing calibration similarity is defined using partial least squares regression plsr analysis that identifies watershed physiographic characteristics that are most relevant for the selected hydrological response indices the plsr results indicate that typically available watershed characteristics such as geomorphology land use climate and soil properties describe reasonably well the average hydrological conditions but poorly the extreme events regionalization variants considering unsupervised clustering and supervised clustering performed similarly well when using all available information however results indicate that supervised clustering uses data more efficiently and may be more suitable when data are scarce it is demonstrated that parsimonious use of available data can be achieved using both regionalization techniques finally model performance consistently becomes acceptable by calibrating watersheds covering only 10 of the model domain thus making the calibration task affordable in terms of time and computational resources required keywords clustering hydrological modelling large scale regionalization similarity swat 1 introduction hydrologic and water quality models have emerged as essential tools for successful implementation of regional to continental scale river basin planning initiatives such as the european water framework directive wfd ec 2000 hartnett et al 2007 the ambitious spatial scale of these models and multiple modellers and stakeholders involved exacerbate the challenges inherent to environmental modelling including reaching agreement on modelling objectives selection of suitable models assessment of data quality model parameter estimation model assessment reporting of model uncertainty and assumptions and review and auditing processes this calls for frameworks that support uniform implementation of model procedures and clarity on the modelling decisions taken this paper addresses this by developing model parameter estimation and assessment procedures suitable for pan european hydrological modelling focusing on ungauged watersheds where conventional model calibration approaches are not applicable while much of europe benefits from a large number of gauged watersheds combining data from the global runoff data centre grdc the european water archive ewa and national databases the principal parameter estimation problem in a pan european modelling exercise is that of ungauged watersheds although some models attempt to include physics based parameters such as channel slopes which may be directly estimated from measured properties of a watershed it is generally agreed that acceptable model accuracy can only be achieved by empirical estimation of at least some of the parameters which for ungauged catchments is approached via regionalization prediction in ungauged basins pub initiative wagener and montanari 2011 sivapalan 2003 winsemius et al 2009 blöschl et al 2013 hrachowitz et al 2013 a large number of hydrological model regionalization methods have been proposed in the literature all of these are based around the concept that information about hydrological response can be transferred between watersheds that may be assumed to be hydrologically similar usually based on knowledge of their relevant properties such as land cover the differences between approaches lie in the type of information that is transferred the transfer method and the watershed properties used to quantify similarity the most common approach is regression of model parameters that are calibrated at gauged donor watersheds against the corresponding watershed characteristics the regression model can then be used to estimate the hydrological model parameters at any ungauged watershed for which the same characteristics are known typically linear regressions are used for each model parameter independently heuvelmans et al 2006 gitau and chaubey 2010 other more sophisticated relationships including non linear weighted and sequential regressions have also been applied kay et al 2006 abdulla and lettenmaier 1997 li et al 2010 where a large number of inter related characteristics are potentially relevant their principal components have been used as inputs to regression livneh and lettenmaier 2013 with the increasing use of continental scale models remote sensed data leaf area index canopy height among others has increasingly been relied upon chaney et al 2016 although widely used the regression approach has major limitations including that model parameters may not be strongly related to measurable attributes and further parameter inter dependency is often too complex to encompass satisfactorily in the regression or overlooked a second group of approaches avoids regression by transferring the entire set of information about hydrological response between watersheds commonly this is implemented in the following way for each ungauged watershed a donor watershed is identified that is most similar in terms of watershed characteristics and the ungauged watershed then receives the complete parameter set calibrated for the donor watershed if it is considered that there is some uncertainty about the most similar donor watershed the approach may be extended to identifying clusters of similar watersheds bormann et al 1999 bormann 2010 ramachandra rao and srinivas 2006 and transferring ensembles of hydrological models within the cluster mcintyre et al 2005 reichl et al 2009 drogue and khediri 2016 the primary advantage of this approach is that the model parameter inter dependencies are maintained rather than being simplified to facilitate regression parajka et al 2005 a simplification of this transfer approach is where spatial proximity between watersheds is used as a proxy of similarity sometimes implemented within a kriging framework skøien et al 2006 patil and stieglitz 2012 a drawback of these methods is the question of whether or not similar watersheds tend to occur in close proximity to each other parajka et al 2005 wagener and wheater 2006 an alternative to either regression or similarity based approaches is spatial interpolation of calibrated parameters although spatial complexity is likely to affect applicability it has been found to be an efficient approach for large scale applications troy et al 2008 as can been seen from the examples cited in this review both the regression and transfer approaches have been applied to a range of hydrological model types ranging from simple conceptual type models to highly parameterised land surface models either the regression or transfer approaches may be combined with regional scale calibration two main methods have been used first the calibration of the parameters of the hydrological model can be combined with estimating the parameters of the regression fernandez et al 2000 parajka et al 2007 which sacrifices performance at gauged locations in order to optimise the precision of the regression model second all gauged watersheds that fall within a region e g viney et al 2015 or cluster of similar watersheds e g szolgay et al 2003 may be calibrated simultaneously to produce a parameter set that is applicable across all watersheds in the region or cluster inter comparisons of approaches have not identified one that consistently performs better parajka et al 2005 mcintyre et al 2005 kay et al 2006 ayzel et al 2017 oudin et al 2008 suggested that this may be due to differences in data types differences in the selected watershed characteristics and differences in model structures for pan european applications such as this in the context of the eu initiative blue print to safeguard europe s water resources ec 2012 the clustering of watersheds according to expected hydrological similarity and the transfer of model parameter sets within clusters may be preferred the large range of watershed types involved and the large number of parameters mean that the regression based methods are not considered promising instead priority research questions relate to watershed clustering strategies that support the transfer of parameter sets to ungauged watersheds and identifying information gaps that limit the success of the strategy when using the similarity approach the problem lies in how to identify hydrologically similar watersheds i e watersheds with similar response to precipitation input quantified through hydrological signatures that are relevant to the prediction context sawicz et al 2011 typically regionalization studies assume that watersheds that have apparently similar physical characteristics have similar hydrological behaviour for example reichl et al 2009 identified as similarity measures commonly used watershed attributes based on geomorphology vegetation cover climate and soil properties although with considerable uncertainty about which were the optimal characteristics oudin et al 2010 compared pools of hydrologically similar watersheds with pools of apparently physically similar watersheds concluding that a significant overlap occurred only for 60 of the watersheds furthermore recent studies suggest that similarity in watershed streamflow response is dynamic and highly dependent on flow conditions patil and stieglitz 2011 therefore the selection of physical characteristics upon which to base the similarity measure is a challenging part of the ungauged catchment problem following from this in the context of pan european hydrological modelling the aims of this paper are 1 develop an objective procedure for selecting watershed properties that are relevant for defining clusters of hydrologically similar watersheds 2 compare approaches to clustering watersheds and transferring hydrological model parameter sets within these clusters in terms of model performance from small watershed up to continental scales 3 identify the primary information gaps that increase variance within clusters and limit ungauged watershed performance 2 materials and methods 2 1 description of the study area the region modelled is located in western europe and covers an area of 736 780 km2 see fig 1 the most important river basins in terms of drainage area include the rhine 160 221 km2 the loire 116 981 km2 the rhone 96 619 km2 the seine 75 990 km2 the garonne 55 703 km2 the meuse 32 047 km2 the dordogne 23 902 km2 the scheldt 18 949 km2 the adour 16 861 km2 and the vilaine 10 490 km2 the modelled area covers france belgium and luxemburg an important part of switzerland half the netherlands one third of germany and parts of austria spain and italy 2 2 hydrological modelling platform in the context of the blue print there is a need for a common uniformly applied hydrological model to support a common understanding of errors assumptions and limits of applicability there is also a need for a model that allows links between land and water management and output variables in terms of a range of hydrological and water quality variables to be simulated swat arnold et al 1998 arnold and fohrer 2005 was selected as a modelling platform that can potentially meet these requirements swat is a basin scale semi distributed conceptual model that operates on a continuous time scale with a daily time step swat subdivides a basin into subwatersheds which are connected by a stream network subwatersheds can be further divided into hydrologic response units hrus which are unique combinations of land use soil type and slope hydrologic simulation is based on the water balance equation and is separated into two major components the land phase which simulates the amount of water sediment nutrient and pesticide loadings to the main channel of each subwatershed and the routing phase which simulates the movement of water sediments and nutrients through the watershed channel network to the outlet neitsch et al 2009 within the land phase swat simulates the processes of snow fall and melting and the build up of the subflows that compose the streamflow namely baseflow interflow and overland flow the plant growth simulation submodel within the swat land cover component is based on the epic plant growth model williams 1995 2 3 model input the model was set up using readily available datasets for the geographical data chaplot 2005 and bormann et al 2009 have shown that the swat model results may be significantly affected by the spatial resolution of these data the resolutions considered next are based on a trade off between the resolutions at which the data are readily available at the pan european level and the size of the subwatersheds considered as discussed further in this section a digital elevation map dem at 100 100 m resolution was obtained from the shuttle radar topography mission srtm a land use map at 1 1 km for the year 2000 was built from the combination of the common agricultural policy regionalized impact modelling system capri britz 2004 the center for sustainability and global environment sage monfreda et al 2008 the history database of the global environment hyde 3 klein goldewijk and van drecht 2006 and the global land cover glc2000 bartholomé and belward 2005 databases a soil map at 1 1 km was obtained from the harmonized world soil database hwsd fao iiasa isric iss cas jrc 2008 the soil parameters required in this study were adapted directly from the hwsd and calculated using pedotransfer functions for saturated hydraulic conductivity wösten et al 1998 and for the universal soil loss equation usle soil erodibility factor williams 1995 subwatershed and stream delineation corresponds to the hydroeurope geodatabase developed by bouraoui and aloe 2009 based on the catchment characterization modelling version 2 ccm2 database for continental europe vogt et al 2007 data regarding 33 reservoirs and lakes with an area larger than 20 km2 were obtained from the global lakes and wetland database glwd lehner and döll 2004 and the ccm2 database vogt et al 2007 climate data used in this study included daily precipitation temperature solar radiation wind speed and relative humidity obtained from the monitoring agricultural resources mars rijks et al 1998 meteorological database which is a gridded data set 25 25 km discharge data used for parameter calibration and validation were collected from a number of sources including the global runoff data centre grdc the flemish environmental agency eaufrance and the general directorate of waters of the ministry of environment of spain that after quality and consistency examination resulted in 698 stations with daily data for the period 1980 2009 or sub periods therein 2 4 model setup the model was implemented in swat2009 using the arcgis swat interface winchell et al 2010 it includes the river basins mentioned earlier as well as neighbouring coastal basins the total modelled area is 736 780 km2 and it was divided based on the ccm2 database into 4 216 subwatersheds with an average size of 175 km2 the subwatersheds were defined using dominant soil land use types and slope i e only one hru was determined within a subwatershed these subwatersheds were considered to be an appropriate modelling unit because this resolution is an adequate trade off between model detail and computational resources needed to model at continental scale elevation bands were used in steep subwatersheds to represent snow and precipitation gradients from hereafter we refer to subwatersheds as the smallest modelling unit irrigated areas were defined by overlaying the land use map and the fao global irrigation map siebert et al 2007 management practices that include auto irrigation and fertilization were defined as fractions of potential heat unit requirements of the crops heat units were calculated for each crop using local climate data fertilizer applications were obtained for the year 2000 from capri britz 2004 management practices were adjusted and validated by controlling the optimal growth of the crops and by comparing simulated crop yields with country statistics extracted from eurostat agricultural database official national statistics reported by member states to the european commission the model includes only reservoirs and lakes with areas larger than 20 km2 and other hydraulic influences have not been included 2 5 calibration a step wise calibration protocol was applied as described in pagliero et al 2014 step wise calibration was implemented by separating the watershed response output into the three main flow components baseflow interflow and overland flow snow melt was also calibrated by adjusting the timing of the hydrograph parameters were calibrated sequentially through the flow components initial parameter values derived through the arcswat interface were used as starting points for the optimization arcswat extracts for every hru and or subwatershed topographic parameters from the dem map assigns parameter values of soil type and land use by clipping soil type and land use input maps and matches subwatersheds and weather stations based on location di luzio et al 2004 olivera et al 2006 model parameters included those calibrated are presented in section a 1 in the appendices calibration was performed in 246 selected head subwatersheds the selection criteria were they are head subwatersheds i e there are no upstream subwatersheds and flow monitoring data is available for 1995 2004 this period was selected because it corresponds to the most complete consecutive period of flow data available see section 2 3 using head subwatersheds as well as avoiding the need to calibrate two or more subwatersheds together limited the influence that hydraulic structures and other regulation strategies and man made influences have on the river flows a combination of manual and automated sufi 2 abbaspour et al 2004 calibration was applied the efficiency criterion was br2 which is a combination of r2 and the gradient b of the regression between measured and predicted daily flow on which r2 is based by weighting r2 by b under or over predictions are quantified together with the correlations krause et al 2005 for a more comprehensive characterization of the performance the normalized root mean square error nrmse and the percent bias pbias which measures the average tendency of the simulated values to be larger positive pbias or smaller negative pbias than the observed ones were also calculated given the aim of the model to support water quality management for which both short and longer duration flows are important monthly flow performance was assessed as well 2 6 defining watershed similarity in this work regionalization is based on the similarity approach physiographic watershed characteristics were selected that can be derived for the entire study area and that are potentially relevant for explaining the hydrological response to capture a broad spectrum of flow conditions a variety of discharge characteristics were considered see table 1 partial least squares regression plsr wold 1960 geladi and kowlaski 1986 was used to identify the most important combinations of watershed characteristics plsr bears some relation to principal components analysis pca in that both techniques are useful for reducing high dimension multivariate systems that include co linear variables but plsr also exposes the relationships between defined sets of independent and dependent variables thus plsr is more useful for prediction godoy et al 2014 in the current context the independent variables x are the set of watershed characteristics and the dependent variables y are the set of flow characteristics table 1 the reduced dimensions to which x is transformed are the so called latent variables because these latent variables are linearly related to the watershed characteristics they can be calculated for all subwatersheds gauged and ungauged further because plsr selected the latent variables that best explain the linear relation between watershed and discharge characteristics they may be used to define hydrological similarity the plsr analysis was in this study performed using the r package pls mevic and wehrens 2007 from the 698 monitoring points available for this study 462 spatially distinct watersheds no upstream gauges were selected for the plsr analysis they include the 246 head subwatersheds selected for calibration plus 216 gauges that are classed as spatially distinct but do not meet the criteria for being in the calibration set table a3 further clarifies how the 698 flow gauges were classed and used fig 2 shows the 462 watersheds they represent a good coverage of the study area the variables in the plsr analysis have different scales therefore the data for each variable were normalized this is performed by setting the variance equal to one and the mean equal to zero plsr was performed by adding latent variables into the regression up to the maximum of 19 equal to the number of watershed characteristics each time a latent variable was added a leave one out cross validation prediction was performed this involved 462 regressions each time including 461 data sets with the 462nd used for validation and calculating the root mean squared error of prediction rmsep over all 462 validation results the number of latent variables taken forward to the regionalization step was judged based on the rate of improvement in rmsep 2 7 regionalization four alternatives for regionalization based on clustering were investigated fig 3 2 7 1 unsupervised clustering the first two alternatives unsup reg and unsup best are based on unsupervised clustering of all subwatersheds both gauged and ungauged into clusters assumed to be hydrologically homogeneous according to the latent variable space followed by calibration of gauged subwatersheds see section 2 5 to derive a single set of model parameters for each cluster in method unsup reg a regional calibration was performed this involved for a sampled parameter set calculating a single objective function that summarizes the performance of all calibration subwatersheds in the cluster after sampling is complete this results in a single best parameter set that is then transferred to all ungauged subwatersheds in that cluster in the method unsup best calibration subwatersheds are calibrated individually after which the calibration subwatershed with the best performance per cluster yields the single parameter set that is transferred to all ungauged subwatersheds in that cluster while this clustering method may be considered supervised clustering in the sense that the plsr and hence the clustering is informed by the hydrological indices we call it unsupervised clustering because the centroids and number of clusters are not prespecified hierarchical unsupervised cluster analysis was employed using ward s minimum variance linkage method ward 1963 together with the euclidean distance similarity ward s minimum variance criterion minimizes the total within cluster variance initially all clusters are singletons and at each step the two clusters with minimum cluster distance are merged validity indices were used to find the best partitioning to fit the underlying data i e to determine the number of clusters kovacs et al 2005 the corrected rand index which measures the level of agreement in cluster membership between clusters was selected and also the meilǎ s variation of information which measures the distance between two partitions of the same dataset meilǎ 2007 these were calculated using the fpc package in r hennings 2010 the partition selected was that with the lowest corrected rand index maximizing the distance between clusters and the highest meilǎ s variation index minimizing the distances within the cluster 2 7 2 supervised clustering the other two alternatives fig 3 sup 246don and sup 53don involve supervised clustering around a number of calibrated donor subwatersheds each donor subwatershed is predefined as a cluster centroid in the latent variables space the clustering is performed and all ungauged subwatersheds that fall into that cluster receive the parameter set of the donor subwatershed in method sup 246don all 246 calibrated subwatersheds were used as donors and cluster centroids while in method sup 53don only the 53 subwatersheds with the highest calibration performances were used the k nearest neighbour was used as classification rule using the euclidean distance function on the latent variables space to be consistent with the unsupervised clustering method this classification was performed using the nnr function of the r package supclust dettling and maechler 2012 in this work we refer to this approach as supervised because the number of clusters and their centroids are defined a priori this definition differs from the more common view of supervised clustering as a modification of standard clustering algorithms to identify class uniform clusters i e a supervised model selection of unsupervised clustering e g finley and joachims 2005 michel et al 2012 ismaili et al 2016 2 8 validation validation is done by comparing simulated and observed monthly discharge at the 452 monitoring points with available data that were not used for calibration table a3 clarifies how watersheds were classed into calibration and validation watersheds goodness of fit parameters were calculated using the r package hydrogof zambrano 2010 for all four alternatives the calibrated parameters were used for the 246 calibration subwatersheds rather than regionalized values this is relevant because some of the validation points are downstream of these subwatersheds in addition regionalization performances were compared with those obtained using the parameter values taken from the swat library neitsch et al 2009 which are called here the initial parameters performances were not compared with those obtainable using calibrated parameters because the validation watersheds generally consist of a large number of subwatersheds and the necessity of a simplified approach to their joint calibration would not necessarily lead to a good benchmark to test the regionalization techniques for large aggregations of watersheds and for continental scale applications the simulated and observed discharges were compared at points close to the outlets of major basins 3 results 3 1 defining similarity using partial least squares regression table 2 shows the cumulative percentages of the variance of the discharge characteristics explained by adding up to 19 latent variables it is seen that the watershed characteristics most commonly available topography land use soil and climate are not sufficient for fully explaining the hydrological response for example in our study 100 of the variability of the watershed characteristics see x value explained only 24 6 of the variability of the coefficient of variation of the annual minima and 26 4 of the ratio baseflow discharge in summer in general characteristics describing average conditions e g annual total flow baseflow and quickflow means are better explained than characteristics describing extreme events see e g daily discharges with probabilities of exceedance 50 70 and 90 fig 4 shows the corresponding rmsep values the starting rmsep value of 1 0 corresponds to the prediction error using zero latent variables i e the standard deviation of the scaled flow characteristics from there results the first four latent variables were considered to explain most of the information contained in the dataset table 3 shows that the first latent variable contains characteristics related to topography temperatures and percentage of cropland whereas meteorological characteristics are present in the second and third latent variable and soil properties in the fourth latent variable the latent variables were calculated for all 4216 subwatersheds gauged and ungauged and used as the basis for clustering 3 2 unsupervised clustering unsup reg and unsup best fig 5 shows the corrected rand and meilă s indices for different numbers of clusters from which five partitions were selected at this point the corrected rand index is minimised indicating dissimilarity between clusters and at the same time the meilă s index is maximised indicating a good linkage between cluster members the resulting hydrological clusters are presented in fig 6 most of these regions are spatially interconnected and moreover comparison with fig 1 shows that the resulting hydrological regions are consistent with topography and land use maps the spatially distinct head subwatersheds used for calibration are also shown in fig 6 the numbers of calibration watersheds are 118 55 41 13 and 19 for regions 1 2 3 4 and 5 respectively the calibrated subwatersheds with the best performance per hydrological region unsup best are indicated in red table 4 compares the performances of unsup reg and unsup best in the validation watersheds both regionalization methods perform better than when using the initial ini parameters for example br2 equals 0 54 when the initial parameters are used and 0 65 and 0 61 using unsup reg and unsup best unsup reg performs better than unsup best for the normalized root mean squared error nrmse but on average it underestimates the discharge the average of the 246 calibration performances the averages of the pooled calibration per cluster for unsup reg alternative and the best calibration performance per cluster for unsup best alternative are presented in table a2 in the appendices 3 3 supervised clustering sup 246don and sup 53don using sup 246don where all 246 calibrated subwatersheds were used as cluster centroids the size of clusters varied from 1 to 99 i e there were clusters consisting of solely the calibrated subwatershed therefore not resulting a suitable donor to any ungauged subwatershed for the sup 53don method from the 246 possible donor subwatersheds only those with a nrmse lower than 50 were used this resulted in 53 donor subwatersheds with cluster sizes from 1 to 335 table 4 shows that at the validation points sup 246don and sup 53don perform better than the initial ini parameters for example br2 is 0 64 for sup 246don and 0 63 for sup 53don against 0 54 using the initial parameters analysing all the performance indicators sup 246don performs better than sup 53don 3 4 comparing performance of the regionalization methods the regionalization methods with the best performance are sup 246don and unsup reg which both transferred information from all 246 subwatersheds in contrast with sup 53don and unsup best methods which used only a subset of the 246 subwatersheds based on calibration performances sup 246don has lowest standard deviation of br2 over all validation subwatersheds table 4 as well as the lowest minimum value of br2 also as well as having the lowest average nrmse it has by far the lowest standard deviation of nrmse there is some evidence therefore that sup 246don gives less variable performance than unsup reg the br2 performance of sup 53don 53 donor subwatersheds although lower than that of unsup reg only decreases by circa 2 from 0 65 to 0 63 for the validation watersheds while using only 22 of the available donor watersheds this result suggests that the supervised clustering method is more efficient in using information at least when the model performs well in the selected donor subwatersheds fig 7 shows the spatial variability of br2 across all 698 calibration and validation monitoring points for sup 246don and unsup reg and it can be seen that simulations improved throughout the study area predictions were affected by the presence of karst formations according to the geological map of europe they are present in approximately 25 of the modelled domain and are distributed throughout the area indicated in yellow in fig 7 subwatersheds containing more than 50 of karst areas were not considered for regional calibration or as donor subwatersheds but they were included in the validation we separated the performance of the validation watersheds that are more than 50 karstic table 4 it is seen that results using initial parameters are worse for the karstic watersheds the regionalization improved the simulations more so for the non karstic watersheds results for percent bias pbias suggest that on average in karstic watersheds simulated discharges are underestimated table 4 performances at basin scale were found to be less variable than at smaller watersheds and a little higher on average than over the full validation data set which may be presumed to be due to integration of random errors in the data and parameter estimates table 5 lists the monitoring points located near the outlet of the major continental scale basins and their performances using unsup reg and sup 246don results show that for the rhine the garonne the dordogne the vilaine and the rhone unsup reg performs better although for the rhone the initial parameter estimates are the best while sup 246don performs better for the loire and the adour and both alternatives perform similarly for the loire and the adour the continental scale catchments with exceptions of the highly karstic dordogne and rhone have better performances than the average found in the subwatersheds fig 8 shows the simulated versus observed monthly hydrographs for the loire the vilaine and the seine river basins for the loire river basin fig 8a the case sup 246don performs better and for the vilaine river basin fig 8b the simulated discharge for the unsup reg alternative has a better agreement with the observed one when we compare these results for the seine river basin fig 8c both alternatives perform similarly however for that basin the sup 246don alternative simulates slightly better the shape of the discharge signal whereas alternative unsup reg simulates better the peaks 4 discussion this paper investigates alternative regionalization techniques for continental scale hydrological modelling although the swat model was used the regionalization methods used are independent of the chosen hydrological model the regionalization techniques are based on the similarity approach which transfers the calibrated parameter sets of gauged watersheds to similar ungauged watersheds in our work similarity is defined by a combination of observable watershed physical characteristics that are linearly related to a selected set of hydrologic signature indices as defined by plsr this removes much of the subjectivity in selecting similarity metrics however the similarity metrics will depend on the selected hydrological signatures in this study as the final objective of the hydrological model is to simulate both water quantity and water quality the latter depending on multiple aspects of the flow regime the hydrological indices used cover a wide range of hydrological conditions the selection of the hydrological characteristics however is not fixed and used must be in agreement with the project objectives the identification of similarity metrics is also restricted by the linearity assumption in the plsr although this may be addressed by exploring suitable non linear transforms of the variables it was shown that the watershed characteristics most commonly available topography land use soil and climate are not sufficient for fully explaining the hydrological response especially flow variability and low flows similar findings were obtained by merz and blöschl 2004 2005 and merz et al 2006 these results are also in agreement with the results found in oudin et al 2010 and suggest that additional watershed characteristics may need to be incorporated this is likely to include hydrogeologic characteristics and or watershed flow regulation characteristics data that are not available over the broad scale of this study karst was isolated as a particular potential issue and results show evidence that performance was overall worse in more karstic watersheds table 4 when integrating to large catchment scale table 5 performance was poor in two catchments with high presence of karst although relatively good in the seine which has the highest presence of karst the relative success of the unsup reg alternative supports the view that suitable model parameters can be obtained if a number of gauged watersheds in a region in this case in a region defined by similarity are used simultaneously in a regional calibration although the value of regional calibration with its goal of modelling regional trends rather than local hydrology is still controversial parajka et al 2007 the present study shows that regional calibration is at least as successful as alternative regionalization approaches and is potentially useful in continental scale modelling where calibration options are severely constrained by data time and computational resources in the supervised clustering approach the number of clusters and their centroids are defined a priori but results showed that after the clustering process there were available donor subwatersheds that were discarded by the data i e resulted in clusters with only one member the calibrated subwatershed this indicates that in this approach ungauged subwatersheds cluster towards the most suitable donors and discard those that are not further the discarded subwatersheds are not forced to join any cluster and remain with their calibrated parameters this approach results in more variability in the regionalized calibrated parameters using the regionalization techniques investigated here we avoid the potential propagation of errors downstream that can be present in more standard calibration procedures in most nested calibration studies a basin is calibrated in steps starting with the headwater watersheds then moving downstream to monitoring points carrying along calibration errors and uncertainties this may lead to overcalibration to compensate for errors in the downstream watersheds e g due to hydraulic influences ignored by the model in addition the use of the similarity approach identifies watersheds with different hydrological behaviours and assigns different parameter sets accordingly a fact that is often overlooked in typical calibration procedures where the entire upstream drainage area is calibrated to match the discharge at the outlet whether the accuracy of flows in individual types of watershed is important or not depends on the application but even in a continental scale application the potential dependence of water quality on local features supports the need for parameter estimation at the smallest possible scale supported by the data results of the techniques defining hydrological regions a priori and a posteriori are similar e g results for unsup reg versus sup 246don in tables 4 and 5 reasons behind the relative success of one regionalization method for a particular basin are not clear analysis of results with both methods do not indicate any consistency or aggregation of errors with scale we believe that the selection of the regionalization technique is case specific and depends largely on the amount and quality of available data as well as the uncertainty that inevitably arises when selecting and calibrating a hydrological model beven 2006 significant uncertainty is likely to arise from the regionalization process uncertainty exists in the hydrologic signature and physiographic characteristic estimates there are assumptions and subjectivity involved in selecting signatures and in the plsr and the clustering and the impact of unavailable but theoretically relevant physiographic characteristics is unknown the relative success of the alternative regionalisation approaches is likely to be related to the relative importance of these sources of uncertainty and their relative importance compared to model equifinality and rainfall and flow observation uncertainty recommended extension of this work is to explicitly quantify the uncertainties and conduct a sensitivity analysis that provides greater insight into which of them is affecting choice of regionalization procedure 5 conclusions four regionalization techniques were investigated in the context of pan european hydrological modelling each technique aimed to regionalize the information in relatively small and non overlapping gauged subwatersheds to give flow predictions at multiple scales up to the largest continental scale rivers each technique used the similarity approach to regionalization the watershed characteristics defining similarity were selected based on their degree of relevance to selected hydrological signature indices identified using partial least squares regression similar watersheds were defined through advanced clustering the first two techniques define the hydrological regions a priori based only on the watershed characteristics termed unsupervised clustering while the second two techniques define the regions a posteriori after model calibration with the clusters centred on gauged sub watersheds termed supervised clustering although the swat model was considered appropriate due to the prior effort invested in its calibration and the breadth and depth of experience of swat that exists in europe all four regionalization methods can be applied to any hydrological model results showed that the supervised clustering performed better overall for either supervised or unsupervised clustering using all available gauged subwatersheds performed better than using only a sub sample as may be expected however the overall performance of the supervised clustering was good even when using the 53 gauged subwatersheds with the best performance in calibration this suggests that when available information is scarce supervised clustering can give acceptable results using the proposed regionalization techniques the available data for calibration were efficiently used even when including all gauged subwatersheds only 10 of the modelled area was calibrated and the performance at the larger scale validation points significantly improved across all the performance measures relative to using the initial swat model parameters although model performances were considered good overall it was shown that watershed characteristics most commonly available topography land use soil and climate are not always sufficient and additional information should ideally be included with priorities being karst and other hydrogeological properties and flow regulation data acknowledgments this work was funded by grant gh20 of the joint research centre european commission we thank alberto aloe institute for environment and sustainability joint research centre european commission for his expert support with spatial data management and processing the authors would like to thank as well the three anonymous reviewers for their critical and constructive comments on an earlier version of the manuscript that helped in making substantial improvements to the manuscript appendix a 1 calibration parameters and calibration results calibrated parameters related to flow simulation are presented in table a1 for the calibration parameters c calibration ranges were set considering authors experience and literature recommendations but for parameters related to properties that were interpolated from input data as cn2 sol awc and sol k they were varied as a percentage of their original values to maintain heterogeneity performance metrics for the average of the individual calibration of the calibration subwatersheds for the averages of the pooled calibration per cluster for unsup reg alternative and for the calibration subwatershed with the best performance per cluster for unsup best alternative are presented in the table a2 results of the average performance of the individual calibration of the calibration subwatersheds indicates that br2 increased from 0 46 with the initial conditions to 0 63 after calibration when calibrating calibration subwatersheds pooled per region unsup reg performance results as expected are lower increasing br2 indicator from 0 51 with initial conditions to 0 60 for cluster 1 from 0 44 to 0 51 for cluster 2 from 0 40 to 0 47 for cluster 3 from 0 44 to 0 46 for cluster 4 and from 0 41 to 0 43 for cluster 5 performance indicators of the selected calibration subwatershed per cluster for the unsup best alternative are above a br2 of 0 80 for all regions except for region 4 that is 0 68 table a2 a 2 use of gauged data table a3 synthetizes the use of monitoring points data 
6704,accurate forecasting of lake level time series llts is an important but challenging problem with major economic social and environmental implications however in recent years the level of uncertainty in the existing llts forecast methods has increased significantly due to climate change therefore the need to develop more accurate models the main research question for this study is whether it is necessary to use nonlinear methods in llts modeling or if linear methods can produce as accurate and reliable forecast tools we introduce a new linear based forecast method for llts using spectral analysis seasonal standardization and stochastic terms the application of the new llts forecast method is tested on two case study lakes including the van lake in turkey and the michigan huron lake in north america a two step preprocessing techniques based on standardization and differencing was used for the van lake and spectral analysis and differencing was employed for the michigan huron lake we then compared the accuracy and uncertainty of the proposed linear method with an artificial neural network ann and adaptive neuro fuzzy inference system anfis methods the uncertainty of the new linear llts forecast model was 0 00455 and 0 00264 for the van lake and the michigan huron lake respectively compared to 0 00625 and 0 00766 for the ann and the anfis respectively at the van lake and 0 00312 and 0 00319 for the ann and the anfis respectively at the michigan huron lake keywords spectral analysis stochastic sarima pre processing lake level time series linear modeling 1 introduction according to the world water assessment program wwap report unesco 2003 by the year 2022 the amount of available freshwater across the globe will be reduced by 30 40 a vital asset requiring superior administration for sustainable use the inland freshwater lakes is one of the most critical assets found in the world these lakes have a wide variety of beneficial uses and hence demands from recreation fisheries irrigation drinking water and hydroelectric energy production however to overcome the limitations of using the required complex input data sets and the limitations of the hydrological models these phenomena are often modeled using historical data sets using a time series analysis and modeling techniques the existing methods in the prediction of the lake level time series llts are divided into two general categories linear based methods i e stochastic models such as auto regressive integrated moving average arima seasonal arima sarima and so on and the nonlinear based techniques emphasizing artificial intelligence ai based methods the use of linear methods requires a series of conditions most notably the stationary nature of the series so for non stationary time series such as most of the llts it is necessary to employed methods for stationary the time series moreover the existing of the different deterministic term in llts which leads to the nonlinearity of the llts has led researchers to tend to use nonlinear methods there are many stochastic based studies in the field of hydrology valipour et al 2013 wang et al 2015a traore et al 2017 myronidis et al 2018 kazemian kale kale et al 2018 zeynoddin et al 2018 especially in lake level forecasting güldal and tongal 2010 employed fourier series to eliminate the periodic components of llts the main weakness of their study is the not removing of trend term which is a deterministic term moreover they did not survey the stationarization of time series using a quantitative test such as augmented dicky fuller test existing such deterministic components led researchers to tend to the use of nonlinear methods in llts modeling recently the use of ai based techniques as a power approach in solving complex nonlinear problems wang et al 2009 ebtehaj et al 2015 wang et al 2015b khozani et al 2017 gholami et al 2017 atieh et al 2017 shaghaghi et al 2017 shabanlou 2018 freeman et al 2018 remarkably increased and specially in lake level forecasting myronidis et al 2012 sanikhani et al 2015 shafaei and kisi 2016 shiri et al 2016 zaji et al 2018 sanikhani et al 2015 applied two different design of anfis anfis with subtractive clustering anfis sc and anfis with grid partitioning anfis gp and gene expression programming gep for lake level foresting up to three month ahead they found optimal anfis gp in predicting one and three months ahead and anfis sc in predicting two month ahead as the best models however the results of all model for predicting different month ahead show the high level of accuracy in lake level predicting using these models a new method in the field of time series prediction is a combination of stochastic method and ai based techniques moeeni et al 2017a by considering the different deterministic term of monthly inflow time series such as jump trend and period and removing these terms proposed a novel hybrid method based on a combination of sarima model and anfis the results approve the higher performance of the proposed method in comparison with individual ones sarima and anfis the presented hybrid methodology in moeeni et al 2017a is performed with a combination of sarima and gep and minor modification by moeeni et al 2017b the results indicate the proposed hybrid methodology based on a combination of the linear and nonlinear method could be a high performance method of prediction inflow time series recently a significant question was put forward in predicting soil temperature by bonakdari et al 2018 the authors in their paper claimed that the linear methodology could be a better approach to soil temperature modeling the results of those paper proved their claim the fundamental question raised is whether using the proposed methodology based on recognition and elimination of deterministic term of a time series and its linear modeling will lead to better results for other time series this question is answered in the current study in this study a novel hybrid linear based methodology based on the stochastic models which are encoded in matlab software is presented for the first time for llts modeling the proposed methodology is including of two step preprocessing which is employed for the first time which is employed spectral analysis and standardization seasonal and non seasonal techniques in combined with differencing seasonal and non seasonal as the second step of preprocessing afterward the remaining stochastic term of time series is employed as the input of stochastic based models i e arima sarima etc the independence of the residual of the proposed linear based methodology is examined by non parametric wald wolfowitz run and cumulative periodogram tests moreover the result of the linear based methodology is compared with two published papers in high quality journals çimen and kisi 2009 and kişi 2009 and two popular artificial intelligence based techniques ann and anfis using multi criteria statistical indices 2 methods this section includes two main sections proposed linear based methodology and theoretical overview of nonlinear based techniques in the first section the proposed methodology for llts is presented at the beginning sub section of section 1 a different test is presented for the study of the time series length and the existence of different terms of time series such as trend jump and period after identifying and removing any of these terms the stochastic modeling is presented finally the residuals independence related to all stochastic modeling is surveyed in the second section an overview of two important nonlinear based techniques ann and anfis are presented and the architecture of each model is given in the final sub section 2 1 proposed linear based methodology 2 1 1 time series components in hydrological studies it is essential to include all periods of drought and wet in time series to ensure the credibility of studies therefore hurst s empirical relationship is used to determine the presence of boundary values in the time series according to this relationship if the coefficient is greater than 0 5 the length of the series is sufficient for modeling hurst et al 1965 each time series has a special structure with its components of 4 different terms these terms include trend jump period and stochastic term apart from the stochastic term that is required for modeling the existence of other terms causes the time series non stationary stationary of time series is the basic condition for stochastic modeling which is examined using various tests such as augmented dicky fuller adf and autocorrelation function the adf test relationships are as follows 1 δ x t α β 1 t β 2 t 2 γ l t 1 φ 1 δ l t 1 φ p 1 δ l t p 1 ε t 2 τ γ σ γ h0 γ 0 h1 γ 0 this test is a single root test which examines the stationary by probing the absence of a single root for the series the l t is the value of data at time t τ is the statistic of the adf test γ is the estimated root coefficient σ γ is the standard error of estimated coefficient h0 is the assumption zero based on the existence of unit root and h1 is the alternative assumption on the absence of single root δ is the the first order differential operator α is the constant value β1 and β2 are the coefficient of the linear and the second degree respectively trend which can be considered zero φi is the ith auto correlation coefficient p is the maximum order for considered auto regression and τ is smaller than the critical value meaning the absence of a single root and stationary since the zero assumption is based on the nonlinear series the probability with the test statistic padf is less than the significant level of 5 means that the time series is stationary after reviewing the series using the above test in the case of non stationary it should identify the factors that have caused non stationary therefore mann kendal hirsch and slack 1984 mann whitney mann and whitney 1947 and fisher kashyap and rao 1976 tests were used to examine the existence of each term of the trend jump and period respectively in the series 2 1 2 stochastic modeling in stochastic modeling deterministic components of time series should be identified and adequately eliminated and only a stochastic term of the time series remains for modeling in this case the deterministic components are jumps trends and period the above components are identified by the proposed tests and then eliminated by non seasonal and seasonal standardization spectral analysis and differencing the non seasonal standardization relationship is presented as follows 3 std l t l s d where std is series converted with zero mean and standard deviation 1 l t is the time series data l the mean of data and s d is the standard deviation of the data in the case of seasonal fluctuations it can be applied as follows 4 s s t d l t i l i s d i where s std is converted data with zero mean and standard deviation 1 t i t of data in tth year and ith season l t i mean of ith season data and sd i standard deviations of ith season data seasonal standardization leads to the elimination of correlations in the mean and standard deviations in a time series and stationary time series marco et al 1993 in this method it is no longer necessary to accurately identify the periodic components spectral analysis sf is done that how much time series changes are affected by repetitive components so a spectrum is obtained over an interval of frequencies and the periodic components can be distinguished in a non stationary time series with the help of spectral analysis based on the fourier series expansion a time series can be decomposed into sinusoidal and cosine functions in this way the periodic component can be presented as a function of time and by reducing the component of the time series the periodic component is removed and the series is stationary 5 p t l t z 1 k α z cos 2 π f z t β z sin 2 π f z t ε t t 1 2 3 n where l t is the mean of the original time series ε t the residual of the fourier series extensions αz and βz are fourier coefficients fz is equal to zth harmonic of the base frequency k is the maximum of the harmonic amount that 2z and 2z 1 are for even and odd data respectively the fourier coefficients and fz are calculated as follows 6 α z 2 n t 1 n l t cos 2 π f z t z 1 2 k 7 β z 2 n t 1 n l t sin 2 π f z t z 1 2 k 8 f z z n the periodic term is obtained by reducing the high quantity from the original time series as follows 9 s f l t p t moreover the differential equation is as follows 10 l t l t l t m where lt is the amount of time series at time t and lt m is the amount of time series in mth delayed differentiation eliminates the trend and jumps in the mean and removes the periodicity of the mean after deletion of definite components using the sarima model coefficients it is possible to establish a linear correlation between the time series values for predicting future values the model s relationship is as follows 11 1 ϕ 1 b ϕ 1 b 2 ϕ p b p 1 φ 1 b s φ 2 b 2 s φ p b ps 1 b d 1 b s d l t 1 θ 1 b θ 2 b 2 θ q b q 1 θ 1 b θ 2 b 2 s θ q b qs ε t where l t is the amount of precipitation at time t s is equal to periodicity b is the differential operator such that b xt lt 1 and 1 b d is the dth non seasonal differential 1 bs d is dth seasonal differential in step s p and q are the orders of the seasonal autoregressive and moving average parameters respectively p and q are the orders of non seasonal autoregressive and moving average parameters respectively ε t is the random component φ and θ are the seasonal autoregressive and moving average parameters respectively and φ and θ are the non seasonal autoregressive and moving average parameters respectively 2 1 3 residuals independence the independence of the residuals of the model is the correct modeling condition therefore to check the independence of the residuals non parametric wald wolfowitz run test is used siegel and castellan 1988 this test is feasible for all hydrological events recorded in a series of times to perform this test first to each data lower and higher than the mean value is given the characteristics s and b respectively then the statistics are calculated as follows 12 u r r e r s d 13 e r n s n b 2 n s n b n 14 s d 2 n s n b n s n b n n 2 n 1 0 5 where ur is the test statistic er and r are expected and achieved sequences respectively sd is the standard deviation of the sequences n is the total number of data ns is the number of smaller data and nb is the number of data is larger than the mean if the probability corresponding to the test statistic pur is greater than the significant level of 5 the series of residues will be independent the flowchart of the proposed linear based methodology in this study which is considered all of the above mentioned statistical test and stationarization techniques is presented as follows fig 1 2 2 theoretical overview of nonlinear based techniques 2 2 1 multi layer perceptron neural network mlp one of the most widely used and popular neural networks is multilayer perceptron mlp networks which include three main layers input hidden and output layers in this study the activation functions of tansig and purelin are considered for hidden and output nodes respectively during the mlp network training with backpropagation bp the computation is first performed from the input to the network output then the calculated error values are propagated to the previous layers initially the output is estimated in a layer to layer manner and the output of each layer forms the input of the next layer the training steps with the help of this algorithm are 1 assign the weight matrix to each of the connections 2 select the input and output vector corresponding to it 3 calculate the output of the neuron in each layer and thus calculate the output of the neurons in the output layer 4 update the weights by the method of propagating the network error the difference between actual output and calculated output to the previous layers 5 evaluating the network performance trained using the mean square error mse 6 returning to step 3 or the end of training 2 2 2 adaptive neuro fuzzy inference systems anfis the anfis method jang 1993 is a combination of ann and a fuzzy inference system fis the first step to construct a fuzzy system was to determine the input parameters of the model and to select the type and number of membership functions additionally to minimize the modeling error value the number of significant iterations should be considered so increasing this value does not have a substantial effect on the modeling results the membership function shape is modified during the training process to obtain the optimal relationship between the input and output of the model until acceptable convergence is achieved for a first order sugeno fuzzy model with two inputs the if then rules are defined as 15 rule 1 i f x i s a 1 a n d y i s b 1 t h e n f 1 p 1 x q 1 y r 1 16 rule 2 i f x i s a 2 a n d y i s b 2 t h e n f 2 p 2 x q 2 y r 2 where ai and bi are linguistic labels such as less or low and p1 p2 q1 q2 is the parameter set which is determined through the training process the structure of anfis includes five different layers fuzzification product normalization de fuzzification and output respectively in the fuzzification layer the membership degree of each is determined the activation degree and firing strength related to each rule are calculated in the product and normalization layers respectively in the fourth layer the de fuzzification process is done finally in the last layer the summation of all input signals are determined in the output layer the more detail of the anfis network is referred to moradi et al 2018 for more details related to the anfis model structure 2 3 uncertainty analysis for the proposed methodology predictions in this sub section a quantitative evaluation of the uncertainties in the forecasting of the lake level is offered using the proposed linear based methodology for two lakes van and michigan huron versus two popular nonlinear based models ann and anfis the provided results of uncertainty analysis ua in this subsection is applied to the test dataset ebtehaj et al 2018 azimi et al 2018 to survey ua the individual forecasting error ife is defined as follows 17 if e i f i o i where f and o are the forecasted and the observed samples respectively the ife is employed for computing the mean of ife mife and standard deviation of ife sdife the mife and sdife are defined as follows 18 mife i 1 n if e i 19 sdife i 1 n if e i m i f e 2 n 1 where n is the number of samples a positive or negative value of mife shows the overestimate or underestimate the observed values a confidence band around the forecasted values is defined based on the mife and sdife using the wilson score method without continuity correction wsmwcc the 95 forecasting error interval fei is achieved approximately by considering the 1 96 sdife 2 4 model verification to evaluate the accuracy of the proposed linear methodology and the nonlinear methods ann and anfis various indices are employed the indices considered in this study include the coefficient of determination r2 two indices mean absolute percentage error mape and relative root mean square error rmsre and the root mean square error rmse index which is an absolute index the maximum value of r2 is equal to 1 the higher the magnitude of this index for a model is closer to this number indicating the high correlation of the predicted values using the model with observational values the minimum values of the mape rmsre and rmse indices are zero and the maximum is infinite the smaller value for these three indices confirms the better accuracy of the model 20 mape 100 n i 1 n l i l i l i 21 rmse 1 n i 1 n l i l i 2 22 rmsre 1 n i 1 n l i l i l i 2 23 r 2 i 1 n l i l t l i l i 1 n l i l t 2 l i l 2 2 where li the observed lake levels and l i the standardized and differenced modeled lake level it should be noted that the value of rmse has a dimension of the meter in addition to the indices the nash sutcliffe index is also used to evaluate the performance of the model for data that has a difference from the mean burnham and anderson 2002 nash and sutcliffe 1970 24 n s e 1 i 1 n l 0 i l f i 2 i 1 n l 0 i l 0 i 2 where l0 i and lf i are respectively the ith value of observed and forecasted lake levels the nash sutcliffe coefficient measures the forecasting power of models through the deviates from the mean value the statistical value varies from to 1 and the closer the coefficient is to 1 the more accurate model moreover the akaike s information criterion aicc is used to examine and compare the models by considering the accuracy and complexity of the model simultaneously the aicc allows comparing the statistical models by dealing with the compromise between the simplicity of the model and its goodness of fit the aicc index is defined as follows 25 aicc n ln σ ε 2 2 k n n k 1 where k is the number of parameters n number of months is the residuals standard deviation 3 case studies areas the data used in this study is the time series for the van lake in turkey and michigan huron lake in north america van lake is about 3713 km2 in turkey the deepest part of the lake is 457 m its longest dimension is 119 km and the altitude is 1650 m the water level reached its lowest level in the winter and rising over the spring feeding on melting snow surrounding mountains rainfall and small rivers the quality of water in this lake is not suitable for use in agriculture and drinking because of its high salinity this lake is the largest lake in turkey and it has an essential role in its economy due to its proximity to iran during the last decade the van lake level in eastern turkey has been on the rise submersing the flat shorelines damage to people s property problems for the irrigation and drainage systems and greatly concerning governmental officials and local administrators altunkaynak 2007 thus the van lake level forecasting is a necessary issue that attracts the researchers attention the michigan huron lake is one of north america s largest water supply sources in both the united states of america and in canada brinkmann 2000 the surface area of this lake is 117 300 km2 with a maximum depth of 281 m the volume of water is 8460 km3 the largest inflow into this lake is st mary s river from lake superior and its main outlet is via the st clair river to lake erie the population of the michigan huron basin is about 33 million people which commercial activities are comprising production of industrial products tourism and agriculture wilcox et al 2007 the position of the van lake and the michigan huron lake is presented in fig 2 the data related to michigan huron lake and van lake had been measured at harbor beach united states and tatvan turkey stations respectively van lake data was measured from 1944 to 2002 708 monthly levels michigan huron lake water level data is also available from 1918 to 2013 1152 monthly levels this data has been measured at hurbor beach station for time series modeling 80 of the beginning of the series as the data for the van 564 months and michigan huron 912 months are considered for train and 20 end for testing for van 144 months and michigan huron 240 months measured data are hydrologically based meaning from the beginning and the end months of october and september fig 3 shows the time series of the data studied in this figure it can be seen that time series have trend and jump and severe fluctuations however for the further review the autocorrelation function acf and partial autocorrelation function pacf diagrams are presented in fig 4 illustrating the trends and fluctuations for the time series the statistical indices of the two lakes are presented in table 1 in this table from left to right the number of data in both the test and train the mean of the data x the standard deviation sd the coefficient of variation cv the minimum xmin the first quartile q1 the median x50 the third quartile q3 the maximum xmax the skewness sk and the kurtosis ku of the both lakes data is seen the mathematical forms of the mentioned statistics are defined as follows 26 x 1 n i 1 n x i 27 s d 1 n i 1 n x i x 2 28 c v s d x 100 29 x 50 x n 1 2 if n o d d x n 2 x n 2 1 if n e v e n 30 q 1 and q 3 x y z x y 1 x y 31 s k n n 1 n 2 i 1 n x i x s d 3 32 k u n n 1 n 1 n 2 n 3 i 1 n x i x s d 4 3 n 1 2 n 2 n 3 where n is the number of samples xi is the ith sample y is the truncated integer value of w is equal to l n 1 4 where l is 1 and 3 for q1 and q3 respectively and z is the fraction component of w that was truncated away it should be not that when w is an integer y w z 0 and q1 or q3 x y it is seen that the values of the indices and the range of numbers for the two lakes are quite different distribution of data of both lakes with each other in test and train intervals are different and asymmetric the data kurtosis is negative in both lakes and is less than normal the amount of data deviation from the mean is low and this value is close to the test and train periods 4 results and discussion 4 1 the results of lake level time series modeling the data of two lakes were evaluated by the hurst test to verify the sufficient length of the data according to the results the coefficient obtained for the van lake is 1 07 and for the michigan huron lake is 0 85 both values are greater than 0 5 therefore the length of the statistical period is sufficient for modeling concerning fig 3 trends jumps and period in each case can be seen clearly this is confirmed in fig 4 with the drawing of series acf and pacf diagrams in this figure correlations of the same direction and periodicity represent the trend and period in the series but for further investigation the tests presented in the previous sections are applied to the series according to the results of the tests presented in table 2 the p value of the mann kendal seasonal mann kendal mann whitney tests for the van lake and the michigan huron lake time series are less than the significant level of 5 and confirm the trend and jump in the series but surprisingly fisher s test data for each lake time series is less than 3 which means that there are no alternatives in the series to the occurred contradiction the spectrum of the series was drawn in fig 5 in this figure it can be seen that both series have a period at the frequency equivalent to step 12 on the other hand there are apparent fluctuations in the graph of both time series the fisher test therefore has poorly tested the frequencies in series and both series have a period in step 12 the probability corresponding the adf test statistic to both series is higher 5 indicating that both series are non stationary therefore in the structure of both time series there are all definite components trends seasonal and non seasonal periodicity and jump consequently they should be eliminated by appropriate methods to remain stochastic term in the series for modeling for this purpose in the first step by a stationary using std s std and sf endeavored to remove definitive terms the test results are presented in table 2 showing that none of the methods have been able to eliminate definite terms and have decreased even in sf in the meantime the series from s std for the michigan huron lake according to the statistical probability of jump tests and trends is less than 5 the stationary of the series has increased and the probability of the test statistic has fallen below 5 i e 2 09 which is a contradiction however the results indicate that a pre processing step is not enough for the time series and requires more pre processing in the second stage of preprocessing from the series of single stage preprocessing non seasonal and seasonal differencing were made the results are presented in table 3 for van lake s time series none of the differencing methods on the time series of non seasonal standardization have been able to eliminate jump in the series except for the seasonal differentiation in the seasonal series of seasonal standardization the jump in the remaining van pre processed series has been well removed and the differencing methods on the spectral analysis series have the highest probability of statistics than standardizations the trend has been entirely eliminated by using all three differential methods and in this case the non seasonal differencing for all three series from std s std and sf has the best performance in eliminating the non seasonal trend and the seasonal and non seasonal differencing for the above series has had the best performance in eliminating the seasonal process fisher test which in the previous step showed the series without a period at this stage shows the series of non seasonal differencing seasonal differencing on std and s std respectively and the non seasonal and seasonal differencing simultaneously on the sf in a periodic manner however all three series produced for the van lake are well stationary concerning the adf test for the michigan huron lake similar to the van lake the three differencing methods have been applied to the series of non seasonal standardization in the removal of jump performed weakly the non seasonal differencing series from s std and the seasonal differential on the sf series has also failed to remove the jump but the method of non seasonal and seasonal differencing simultaneously for std and s std removed this term well the seasonal differencing method has not been able to eliminate the trend in the lake s pre processed series but the simultaneous differencing simultaneous non seasonal and seasonal has eliminated this term well the results of the fisher test also show that the simultaneous differencing induces a periodicity in all three series from std s std and sf but the test values for the other two methods of differencing are still less than 3 according to the results of the adf test the same as the van all three are stationary the acf diagrams of the above series are plotted in fig 6 in this figure it is seen that single stage preprocessing is not capable of securing the series and there are many correlations in the series by applying differentiation on the series except for the non seasonal differential in the std series and sf which caused severe seasonal correlations the correlations value for other series declined sharply and all have been stationary on the other hand the adf test is not able to identify the seasonal correlations generated in the non seasonal differential series on std and sf and they re non stationary according to the results of the tests in table 4 and the diagrams in fig 6 the series of simultaneous differencing methods are very suitable for modeling in this method it can be seen that not only have the acceptable results obtained in the tests but also according to the diagrams fewer parameters for modeling is needed for example in the seasonal differencing method at least 11 non seasonal parameters and 1 seasonal parameter for modeling are needed for both lakes while for simultaneous differencing this number has reached a maximum of 2 parameters for the van lake and maximum 4 parameters for the michigan huron lake considering the lower number of parameters for modeling that yields acceptable results leads to a simpler linear model that makes use of it more practical therefore modeling is done according to the minimum values for the linear model parameters eq 11 thus for modeling of lake time series the sarima model with seasonal and non seasonal differencing and seasonal and non seasonal parameters with a maximum order of 4 i e p q p and q 0 1 2 3 4 are used fig 6 the results of the superior model indices for each of the methods are presented in table 4 in this table it is seen that the modeling has a very good coefficient of determination the amount of errors is also very low in this modeling the combination of spectral analysis and then simultaneous differentiation has the highest correlation in the van lake and the michigan huron lake r2 0 9954 van r2 0 9889 michigan huron and the std method for van lake and s std method has the lowest value between all methods the nash sutcliffe index values also show that the modeling power of the series is high and the spectral analysis method with the sarima model 3 1 1 2 1 3 12 for van and the sarima model 1 1 0 0 1 1 12 had the best performance for the michigan huron lake nse 0 9952 van nse 0 9887 michigan huron lake akaike information criterion corrected aicc results indicate that the spectral analysis is appropriate for modeling the michigan huron lake so that the value of this criterion is the least among the other two methods while for the van the best model is the model 1 1 2 0 1 1 12 that in the first stage of its pre processing the std method has been used the number of parameters given in this model is lower than the other models and the values of the indices for this method are very close to the spectral analysis method since the values of the indices r2 0 9951 rmse m 0 0417 nse 0 9950 for this model is very close to the spectral analysis method and the values of other error indices mape 0 0019 rmsre 0 0025 is the same so the model is chosen as the superior model after identifying different models the independence of the residuals of each model should be evaluated generally the best model for van and michigan huron lakes is as 1 1 2 0 1 1 12 and 1 1 0 0 1 1 12 respectively which demonstrate the seasonal and non seasonal differencing is employed simultaneously in both lakes the aicc index which considers both the complexity and accuracy of each model for selecting the superior models for the van lake and for the michigan huron lake is 906 36 and 1580 11 respectively moreover the order of the non seasonal autoregressive ar parameter for the van lake is one while the order of the seasonal ar is zero which indicates the seasonal ar is not used by the superior model for the van lake the order of the non seasonal and seasonal moving average ma in the proposed linear model for the van lake is 2 and 1 respectively indeed the sum of the order of seasonal and non seasonal ar and ma parameters related to a superior model for the van lake is four ar 1 ma 2 seasonal ar 0 and seasonal ma 1 the order of the seasonal and non seasonal ar parameter as well as the seasonal ma for a superior model of the michigan huron lake is similar to the van lake moreover this model did not employ the non seasonal ma parameter for the michigan huron lake level prediction consequently the proposed linear method forecasted not only the fluctuations of the van lake and the michigan huron lake with a high level of accuracy but also the proposed model is straightforward with the lowest order of the seasonal and non seasonal ar and ma parameters to investigate the independence of the remaining series and to ensure the elimination of periodicity detected in the series the non parametric wald wolfowitz run test table 4 was applied to the residuals series and the cumulative periodogram drown fig 7 it is observed that the wald wolfowitz test values for all series of residues are more than 50 indicating the relative independence of the residuals and the validity of the modeling on the other hand according to fig 7 all independent series and periodicity have been eliminated well the time series graphs for the van lake and michigan huron lake along with the superior method for each lake is presented in fig 8 in this figure it can be seen that the modeling of the series results from the pre processing using the std and sf method for the van lake and the michigan huron lake using the sarima model provide very satisfactory results so that the predicted value has very good conformity with the observed values in fig 9 the box plot of the series is modeled using the sarima model for each of the 3 preprocessing methods in this figure it can be seen that the box areas for all three methods of stationary are very close to observational values and the statistical characteristics are well maintained and close to real values on the other hand the predicted peak samples in michigan huron lake by std and sf is much closer to the observed values related to s std 4 2 comparison of the proposed methodology with ann and anfis it is essential to adjust the modifiable parameters related to each model to achieve an accurate and optimal nonlinear based models ann anfis the optimal values of the ann and anfis for modeling the water level of the michigan huron lake and the van lake which are attained through a trial and error process have been presented in the following table table 5 table 6 compares the results of the best models presented using the proposed linear based methodology for van and michigan huron lakes with the results of nonlinear methods ann anfis the results of linear methods are divided into two categories results presented in previous studies kişi 2009 çimen and kisi 2009 and the results of modeling in this study the van lake level modeling presented by kişi 2009 and çimen and kisi 2009 has a lower accuracy than the modeling performed in this study çimen and kisi 2009 have been able to increase the accuracy of the van lake level modeling by increasing the number of hidden layer neurons and also considering a delay higher than kişi 2009 the relative error presented for the ann model 4 8 1 çimen and kisi 2009 is about one third the value of this index for ann 3 1 1 kişi 2009 on the other hand the coefficient of determination also increased by about 3 in this study the non linear modeling of these data has been modeled due to the lack of access to the exact amounts of modeling data in past studies to compute indices such as nse aicc rmsre the indices presented for van s lake data test period shows that the two models ann 3 1 1 and ann 4 1 1 which have a very simple structure have fairly similar accuracy and the increase in lag does not have a significant effect on modeling also for the data of this lake two models with ann models similar regarding number and type of parameters are modeled using anfis the anfis model fcm 2 3 indicates that the fuzzy c means clustering method has been used for fis generation in anfis the number of clusters considered is 2 and the number of inputs of the model is also 3 t 1 t 2 t 3 for anfis models with the constant of modeling conditions the increase in the number of modeling parameters from 3 to 4 has led to a relatively small accuracy increase although it also adds to the complexity of the model comparing the two models of anfis fcm 2 3 and anfis fcm 2 4 using the aicc index which also considers the complexity of the model in addition to considering the accuracy of the model shows that the aicc for anfis fcm 2 3 is less than the anfis fcm 2 4 aicc 738 72 the comparison of two nonlinear ann and anfis methods using the aicc index shows that the ann model 3 1 1 aicc 797 86 has the best performance among all the nonlinear models presented in this study in this study in addition to the statistics indices that only consider the model s accuracy r2 0 9951 rmse m 0 0417 mape 0 0019 rmsre 0 000025 nse 0 995 have better performance than nonlinear methods in terms of aicc 906 36 also have a significant advantage over nonlinear methods therefore the proposed linear based methodology is a superior modeling technique compared to the existing non linear methods by providing a simpler yet more accurate model than the nonlinear models the results of the proposed linear based methodology in the michigan huron lake and the van lake level each of which in three different structures and are compared with two existing non linear models in table 6 in both ann and anfis methods with the constant of all the parameters of the model increasing an input parameter leads to an increase in modeling accuracy it should be noted that the excessive increase in the number of inputs increases the complexity of the model for this reason the aicc index which takes into account the complexity and accuracy of the model simultaneously is presented in this study the lowest value of the aicc index is obtained in ann and anfis methods for a different structure the use of the 5 input parameters leads to the best answer in ann 5 1 1 aicc 1508 74 while using 4 parameters is along with the best performance in anfis fcm 2 4 aicc 1443 41 similar to the van lake the use of the ann is better than anfis so that the aicc index is less than the best anfis for the best ann model about 4 however other values of indices also generally outperform the ann as compared to anfis the comparison results of the proposed linear based methodology for michigan huron lake r2 0 9889 rmse m 0 0368 mape 0 0171 rmsre 0 00209 nse 0 9887 aicc 1580 11 with nonlinear models shows the superiority of the proposed methodology over the existing methods the taylor diagram taylor 2001 is an appropriate tool for evaluating various methods the values of the coefficient of determination in the form of the circular radius on its arc the standard deviation values of two concentric circles relative to the center of the circle and the values of rmse in two concentric circles relative to the reference point of the hollow circle on the horizontal axis are plotted the reference point indicates the position of the synoptic station based on the standard deviation of its time series because the rmse value and the coefficient of determination of the time series of the synoptic station will be zero and one compared to itself respectively so its position on the horizontal axis will be determined based on the standard deviation the evaluation method in this diagram is that the position of the data under investigation based on rmse its coefficient of determination with the synoptic station of each data and the standard deviation of the time series on the diagram which location is closer to the reference point on the graph estimates the lake level value with more accuracy for the van lake level time series comparing the results of the two models presented for each of the ann and anfis methods with the proposed linear based methodology it can be seen that the distance of the reference point from the proposed method to the non linear method relative to the observational data points is less likely to be due to better performance of this method than ann and anfis for the michigan huron lake level time series the points of the various models in the ann and anfis methods show no significant difference and sometimes these points are on each other which indicates the insignificance of the difference in models in fact increasing the number of inputs will not have a significant impact on the modeling results in this time series like the van lake the proposed linear based methodology to the ann and anfis methods is closer to the reference point for observational data fig 10 the ua results have been presented in table 7 this table represents the number of samples ns mean of individual forecasted error mife the standard deviation of individual forecasted error sdife the width of uncertainty band wub and 95 forecasted error interval fei it is clear that the proposed linear based methodology technique for two lakes has performed better than nonlinear methods with less computed uncertainty the positive value of mife for all linear and nonlinear models for both of lakes shown the overestimate performance of these models in lake level forecasting the mife for the proposed methodology is calculated as 0 03346 and 0 02922 compared to 0 04750 for ann 4 1 1 and 0 03381 for ann 5 1 1 for the van lake and the michigan huron lake respectively moreover the min value of wub was calculated for the proposed methodology at the van lake wub 0 00455 and michigan huron wub 0 00264 the smallest and the highest value of wub are ann 4 1 1 wub 0 00610 and anfis fcm 2 4 wub 0 00766 for the van lake and anfis fcm 2 5 wub 0 02504 and ann 3 1 1 wub 0 02707 respectively the proposed methodology had the lowest mife and the smallest wub of all the compared methods 5 conclusions we presented a novel linear based model for lake level time series llts forecasting and evaluated the performance of the methodology using two case studies of the van lake in turkey and the michigan huron lake in north america the llts were preprocessed using standardization seasonal standardization spectral analysis and seasonal and non seasonal differencing the new llts modeling technique presented in this study outperformed two popular nonlinear techniques the ann and the anfis with improved accuracy and lower uncertainty the main reason for the improved performance of the new model is due to the appropriate pre processing by identification of the deterministic terms and removing them before stochastic modeling the main finding of the study are as follows the fisher s test was poor in detecting the periodicity in the llts while using the spectral analysis of different series was a better method for identifying the seasonal periodicity we employed the standardization seasonal standardization and the spectral analysis to remove the deterministic terms from the llts however none of these methods were able to remove the deterministic terms adequately therefore the first round of preprocessing was not adequate and a second round was necessary to reach optimum results in the second round of preprocessing the seasonal and non seasonal differencing and simultaneous seasonal and non seasonal differencing were employed the use of concurrent seasonal and non seasonal differencing not only removed the deterministic terms and stationarized the series but also lowered the seasonal and non seasonal differencing to achieve the optimum model the new linear based method is appropriate for forecasting monthly lake water levels the best models for the van lake was obtained using standardization preprocessing as the first step and the final model was 1 1 2 0 1 1 12 r2 0 9951 rmse m 0 0417 mape 0 0019 rmsre 0 000025 nse 0 995 aicc 906 36 while for the michigan huron lake the best preprocessing was obtained using spectral analysis and the best model had performance metrics of r2 0 9889 rmse m 0 0368 mape 0 0171 rmsre 0 00209 nse 0 9887 aicc 1580 11 comparing the proposed linear based methodology for lake level modeling with the ann and the anfis methods using different relative and absolute statistical indices for the accuracy and complexity of model predictions shows that the proposed methodology in the current study outperformed the nonlinear based methods regarding complexity and efficiency this superior accuracy and lower uncertainty of the new model predictions compared to the ann and anfis models were detected for both the van lake and the michigan huron lake due to the high performance of the proposed linear based this approach is recommended for modeling llts at other lakes moreover this methodology is suggested for the other time series forecasting applications conflict of interest the authors declare that they have no conflict of interest appendix a hurst coefficient the hurst coefficient is defined as follows a1 h c l o g r s x l o g n 2 a2 s s min max s 1 s 2 s n a3 r s s s max s min in the above relationship sx is the standard deviation of the data and n is the total number of data s min max is the maximum and the minimum of the cumulative deviate series as s i 1 n l i l appendix b trend analysis to test the changes in the hydrological time series there are many statistical tests that one of the most popular and most widely used tests is the non parametric mann kendal test and the mann kendal seasonal test used to determine the significance of trends of the term xu et al 2003 the test relationships used to examine the existence of the trend are as follows a4 u mk mk 1 var mk 0 5 mk 0 0 mk 0 mk 1 var mk 0 5 mk 0 where umk is the standard of mann kendall statistic mk is the man kendall statistic and var mk is the variance of mk the mk and var mk are defined as a5 mk i 1 n 1 j i 1 n sgn l j l i a6 var mk 2 n 3 7 n 2 5 n j g o j o j 1 2 o j 5 18 where l is the lake levels g is the number of identical groups oj is the number of observations at the jth group sgn is the sign function and n is the number of samples also the seasonal mann kendall tests are expressed as follows a7 s k i 1 n k 1 j i 1 n k 1 sgn l ki l kj a8 smk k 1 ω s k sgn s k a9 var smk 2 i 1 ω 1 j i 1 ω σ ij k ω 2 n k 3 7 n k 2 5 n k 18 a10 u smk m k var mk 0 5 where ω is the number of the season in a year and σij is the covariance of statistic test in season i and j if the probabilities of these tests are higher than the significant level of 0 05 then time series has no trend appendix c jump analysis the non parametric mann whitney test is employed to check that the randomly selected values from one sample of time series are equal or different from the selected ones from the second sample of it and thus the jump in series is assessed mann and whitney 1947 the statistic of this test is computed as follow a11 m w u t 1 n 1 d o t m 1 m 1 m 2 1 2 m 1 m 2 m 1 m 2 1 0 5 12 in this regard the ot is series arranged according to the original series l t d ot the degree of function ot m1 and m2 are the number of sub series members of the main series that the sum of which is equal to the original series length if the probability corresponds to the test statistic in the normal probability distribution the confidence level is greater than α the assumption of the same distribution of series is acceptable and the main series is jump free appendix d period analysis the recognition of periodic term as an essential part of the time series is of particular importance which is done with different tests the fisher test is used as a method to identify significant periodicities over time the following equation is used to determine the existence of periodic components kashyap and rao 1976 a12 f n n 2 4 α k 2 β k 2 z 1 k x t α z cos ω z t β z sin ω z t where f n αz βz and ωz are the fisher statistic number of samples fourier coefficients and the angular frequency respectively the αz βz and ωz are defined as follows a13 α z 2 n t 1 n l t cos 2 π f z t z 1 2 k a14 β z 2 n t 1 n l t sin 2 π f z t z 1 2 k a15 f z z n a16 ω z 2 π z n z 1 2 k where fz is the zth based frequency harmony if the f distribution critical value at a significant level f 2 n 2 is lower than f then the ωz related periodicity will not be significant in other words a17 f f 2 n 2 appendix e supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 01 010 appendix e supplementary data the following are the supplementary data to this article supplementary data 1 
6704,accurate forecasting of lake level time series llts is an important but challenging problem with major economic social and environmental implications however in recent years the level of uncertainty in the existing llts forecast methods has increased significantly due to climate change therefore the need to develop more accurate models the main research question for this study is whether it is necessary to use nonlinear methods in llts modeling or if linear methods can produce as accurate and reliable forecast tools we introduce a new linear based forecast method for llts using spectral analysis seasonal standardization and stochastic terms the application of the new llts forecast method is tested on two case study lakes including the van lake in turkey and the michigan huron lake in north america a two step preprocessing techniques based on standardization and differencing was used for the van lake and spectral analysis and differencing was employed for the michigan huron lake we then compared the accuracy and uncertainty of the proposed linear method with an artificial neural network ann and adaptive neuro fuzzy inference system anfis methods the uncertainty of the new linear llts forecast model was 0 00455 and 0 00264 for the van lake and the michigan huron lake respectively compared to 0 00625 and 0 00766 for the ann and the anfis respectively at the van lake and 0 00312 and 0 00319 for the ann and the anfis respectively at the michigan huron lake keywords spectral analysis stochastic sarima pre processing lake level time series linear modeling 1 introduction according to the world water assessment program wwap report unesco 2003 by the year 2022 the amount of available freshwater across the globe will be reduced by 30 40 a vital asset requiring superior administration for sustainable use the inland freshwater lakes is one of the most critical assets found in the world these lakes have a wide variety of beneficial uses and hence demands from recreation fisheries irrigation drinking water and hydroelectric energy production however to overcome the limitations of using the required complex input data sets and the limitations of the hydrological models these phenomena are often modeled using historical data sets using a time series analysis and modeling techniques the existing methods in the prediction of the lake level time series llts are divided into two general categories linear based methods i e stochastic models such as auto regressive integrated moving average arima seasonal arima sarima and so on and the nonlinear based techniques emphasizing artificial intelligence ai based methods the use of linear methods requires a series of conditions most notably the stationary nature of the series so for non stationary time series such as most of the llts it is necessary to employed methods for stationary the time series moreover the existing of the different deterministic term in llts which leads to the nonlinearity of the llts has led researchers to tend to use nonlinear methods there are many stochastic based studies in the field of hydrology valipour et al 2013 wang et al 2015a traore et al 2017 myronidis et al 2018 kazemian kale kale et al 2018 zeynoddin et al 2018 especially in lake level forecasting güldal and tongal 2010 employed fourier series to eliminate the periodic components of llts the main weakness of their study is the not removing of trend term which is a deterministic term moreover they did not survey the stationarization of time series using a quantitative test such as augmented dicky fuller test existing such deterministic components led researchers to tend to the use of nonlinear methods in llts modeling recently the use of ai based techniques as a power approach in solving complex nonlinear problems wang et al 2009 ebtehaj et al 2015 wang et al 2015b khozani et al 2017 gholami et al 2017 atieh et al 2017 shaghaghi et al 2017 shabanlou 2018 freeman et al 2018 remarkably increased and specially in lake level forecasting myronidis et al 2012 sanikhani et al 2015 shafaei and kisi 2016 shiri et al 2016 zaji et al 2018 sanikhani et al 2015 applied two different design of anfis anfis with subtractive clustering anfis sc and anfis with grid partitioning anfis gp and gene expression programming gep for lake level foresting up to three month ahead they found optimal anfis gp in predicting one and three months ahead and anfis sc in predicting two month ahead as the best models however the results of all model for predicting different month ahead show the high level of accuracy in lake level predicting using these models a new method in the field of time series prediction is a combination of stochastic method and ai based techniques moeeni et al 2017a by considering the different deterministic term of monthly inflow time series such as jump trend and period and removing these terms proposed a novel hybrid method based on a combination of sarima model and anfis the results approve the higher performance of the proposed method in comparison with individual ones sarima and anfis the presented hybrid methodology in moeeni et al 2017a is performed with a combination of sarima and gep and minor modification by moeeni et al 2017b the results indicate the proposed hybrid methodology based on a combination of the linear and nonlinear method could be a high performance method of prediction inflow time series recently a significant question was put forward in predicting soil temperature by bonakdari et al 2018 the authors in their paper claimed that the linear methodology could be a better approach to soil temperature modeling the results of those paper proved their claim the fundamental question raised is whether using the proposed methodology based on recognition and elimination of deterministic term of a time series and its linear modeling will lead to better results for other time series this question is answered in the current study in this study a novel hybrid linear based methodology based on the stochastic models which are encoded in matlab software is presented for the first time for llts modeling the proposed methodology is including of two step preprocessing which is employed for the first time which is employed spectral analysis and standardization seasonal and non seasonal techniques in combined with differencing seasonal and non seasonal as the second step of preprocessing afterward the remaining stochastic term of time series is employed as the input of stochastic based models i e arima sarima etc the independence of the residual of the proposed linear based methodology is examined by non parametric wald wolfowitz run and cumulative periodogram tests moreover the result of the linear based methodology is compared with two published papers in high quality journals çimen and kisi 2009 and kişi 2009 and two popular artificial intelligence based techniques ann and anfis using multi criteria statistical indices 2 methods this section includes two main sections proposed linear based methodology and theoretical overview of nonlinear based techniques in the first section the proposed methodology for llts is presented at the beginning sub section of section 1 a different test is presented for the study of the time series length and the existence of different terms of time series such as trend jump and period after identifying and removing any of these terms the stochastic modeling is presented finally the residuals independence related to all stochastic modeling is surveyed in the second section an overview of two important nonlinear based techniques ann and anfis are presented and the architecture of each model is given in the final sub section 2 1 proposed linear based methodology 2 1 1 time series components in hydrological studies it is essential to include all periods of drought and wet in time series to ensure the credibility of studies therefore hurst s empirical relationship is used to determine the presence of boundary values in the time series according to this relationship if the coefficient is greater than 0 5 the length of the series is sufficient for modeling hurst et al 1965 each time series has a special structure with its components of 4 different terms these terms include trend jump period and stochastic term apart from the stochastic term that is required for modeling the existence of other terms causes the time series non stationary stationary of time series is the basic condition for stochastic modeling which is examined using various tests such as augmented dicky fuller adf and autocorrelation function the adf test relationships are as follows 1 δ x t α β 1 t β 2 t 2 γ l t 1 φ 1 δ l t 1 φ p 1 δ l t p 1 ε t 2 τ γ σ γ h0 γ 0 h1 γ 0 this test is a single root test which examines the stationary by probing the absence of a single root for the series the l t is the value of data at time t τ is the statistic of the adf test γ is the estimated root coefficient σ γ is the standard error of estimated coefficient h0 is the assumption zero based on the existence of unit root and h1 is the alternative assumption on the absence of single root δ is the the first order differential operator α is the constant value β1 and β2 are the coefficient of the linear and the second degree respectively trend which can be considered zero φi is the ith auto correlation coefficient p is the maximum order for considered auto regression and τ is smaller than the critical value meaning the absence of a single root and stationary since the zero assumption is based on the nonlinear series the probability with the test statistic padf is less than the significant level of 5 means that the time series is stationary after reviewing the series using the above test in the case of non stationary it should identify the factors that have caused non stationary therefore mann kendal hirsch and slack 1984 mann whitney mann and whitney 1947 and fisher kashyap and rao 1976 tests were used to examine the existence of each term of the trend jump and period respectively in the series 2 1 2 stochastic modeling in stochastic modeling deterministic components of time series should be identified and adequately eliminated and only a stochastic term of the time series remains for modeling in this case the deterministic components are jumps trends and period the above components are identified by the proposed tests and then eliminated by non seasonal and seasonal standardization spectral analysis and differencing the non seasonal standardization relationship is presented as follows 3 std l t l s d where std is series converted with zero mean and standard deviation 1 l t is the time series data l the mean of data and s d is the standard deviation of the data in the case of seasonal fluctuations it can be applied as follows 4 s s t d l t i l i s d i where s std is converted data with zero mean and standard deviation 1 t i t of data in tth year and ith season l t i mean of ith season data and sd i standard deviations of ith season data seasonal standardization leads to the elimination of correlations in the mean and standard deviations in a time series and stationary time series marco et al 1993 in this method it is no longer necessary to accurately identify the periodic components spectral analysis sf is done that how much time series changes are affected by repetitive components so a spectrum is obtained over an interval of frequencies and the periodic components can be distinguished in a non stationary time series with the help of spectral analysis based on the fourier series expansion a time series can be decomposed into sinusoidal and cosine functions in this way the periodic component can be presented as a function of time and by reducing the component of the time series the periodic component is removed and the series is stationary 5 p t l t z 1 k α z cos 2 π f z t β z sin 2 π f z t ε t t 1 2 3 n where l t is the mean of the original time series ε t the residual of the fourier series extensions αz and βz are fourier coefficients fz is equal to zth harmonic of the base frequency k is the maximum of the harmonic amount that 2z and 2z 1 are for even and odd data respectively the fourier coefficients and fz are calculated as follows 6 α z 2 n t 1 n l t cos 2 π f z t z 1 2 k 7 β z 2 n t 1 n l t sin 2 π f z t z 1 2 k 8 f z z n the periodic term is obtained by reducing the high quantity from the original time series as follows 9 s f l t p t moreover the differential equation is as follows 10 l t l t l t m where lt is the amount of time series at time t and lt m is the amount of time series in mth delayed differentiation eliminates the trend and jumps in the mean and removes the periodicity of the mean after deletion of definite components using the sarima model coefficients it is possible to establish a linear correlation between the time series values for predicting future values the model s relationship is as follows 11 1 ϕ 1 b ϕ 1 b 2 ϕ p b p 1 φ 1 b s φ 2 b 2 s φ p b ps 1 b d 1 b s d l t 1 θ 1 b θ 2 b 2 θ q b q 1 θ 1 b θ 2 b 2 s θ q b qs ε t where l t is the amount of precipitation at time t s is equal to periodicity b is the differential operator such that b xt lt 1 and 1 b d is the dth non seasonal differential 1 bs d is dth seasonal differential in step s p and q are the orders of the seasonal autoregressive and moving average parameters respectively p and q are the orders of non seasonal autoregressive and moving average parameters respectively ε t is the random component φ and θ are the seasonal autoregressive and moving average parameters respectively and φ and θ are the non seasonal autoregressive and moving average parameters respectively 2 1 3 residuals independence the independence of the residuals of the model is the correct modeling condition therefore to check the independence of the residuals non parametric wald wolfowitz run test is used siegel and castellan 1988 this test is feasible for all hydrological events recorded in a series of times to perform this test first to each data lower and higher than the mean value is given the characteristics s and b respectively then the statistics are calculated as follows 12 u r r e r s d 13 e r n s n b 2 n s n b n 14 s d 2 n s n b n s n b n n 2 n 1 0 5 where ur is the test statistic er and r are expected and achieved sequences respectively sd is the standard deviation of the sequences n is the total number of data ns is the number of smaller data and nb is the number of data is larger than the mean if the probability corresponding to the test statistic pur is greater than the significant level of 5 the series of residues will be independent the flowchart of the proposed linear based methodology in this study which is considered all of the above mentioned statistical test and stationarization techniques is presented as follows fig 1 2 2 theoretical overview of nonlinear based techniques 2 2 1 multi layer perceptron neural network mlp one of the most widely used and popular neural networks is multilayer perceptron mlp networks which include three main layers input hidden and output layers in this study the activation functions of tansig and purelin are considered for hidden and output nodes respectively during the mlp network training with backpropagation bp the computation is first performed from the input to the network output then the calculated error values are propagated to the previous layers initially the output is estimated in a layer to layer manner and the output of each layer forms the input of the next layer the training steps with the help of this algorithm are 1 assign the weight matrix to each of the connections 2 select the input and output vector corresponding to it 3 calculate the output of the neuron in each layer and thus calculate the output of the neurons in the output layer 4 update the weights by the method of propagating the network error the difference between actual output and calculated output to the previous layers 5 evaluating the network performance trained using the mean square error mse 6 returning to step 3 or the end of training 2 2 2 adaptive neuro fuzzy inference systems anfis the anfis method jang 1993 is a combination of ann and a fuzzy inference system fis the first step to construct a fuzzy system was to determine the input parameters of the model and to select the type and number of membership functions additionally to minimize the modeling error value the number of significant iterations should be considered so increasing this value does not have a substantial effect on the modeling results the membership function shape is modified during the training process to obtain the optimal relationship between the input and output of the model until acceptable convergence is achieved for a first order sugeno fuzzy model with two inputs the if then rules are defined as 15 rule 1 i f x i s a 1 a n d y i s b 1 t h e n f 1 p 1 x q 1 y r 1 16 rule 2 i f x i s a 2 a n d y i s b 2 t h e n f 2 p 2 x q 2 y r 2 where ai and bi are linguistic labels such as less or low and p1 p2 q1 q2 is the parameter set which is determined through the training process the structure of anfis includes five different layers fuzzification product normalization de fuzzification and output respectively in the fuzzification layer the membership degree of each is determined the activation degree and firing strength related to each rule are calculated in the product and normalization layers respectively in the fourth layer the de fuzzification process is done finally in the last layer the summation of all input signals are determined in the output layer the more detail of the anfis network is referred to moradi et al 2018 for more details related to the anfis model structure 2 3 uncertainty analysis for the proposed methodology predictions in this sub section a quantitative evaluation of the uncertainties in the forecasting of the lake level is offered using the proposed linear based methodology for two lakes van and michigan huron versus two popular nonlinear based models ann and anfis the provided results of uncertainty analysis ua in this subsection is applied to the test dataset ebtehaj et al 2018 azimi et al 2018 to survey ua the individual forecasting error ife is defined as follows 17 if e i f i o i where f and o are the forecasted and the observed samples respectively the ife is employed for computing the mean of ife mife and standard deviation of ife sdife the mife and sdife are defined as follows 18 mife i 1 n if e i 19 sdife i 1 n if e i m i f e 2 n 1 where n is the number of samples a positive or negative value of mife shows the overestimate or underestimate the observed values a confidence band around the forecasted values is defined based on the mife and sdife using the wilson score method without continuity correction wsmwcc the 95 forecasting error interval fei is achieved approximately by considering the 1 96 sdife 2 4 model verification to evaluate the accuracy of the proposed linear methodology and the nonlinear methods ann and anfis various indices are employed the indices considered in this study include the coefficient of determination r2 two indices mean absolute percentage error mape and relative root mean square error rmsre and the root mean square error rmse index which is an absolute index the maximum value of r2 is equal to 1 the higher the magnitude of this index for a model is closer to this number indicating the high correlation of the predicted values using the model with observational values the minimum values of the mape rmsre and rmse indices are zero and the maximum is infinite the smaller value for these three indices confirms the better accuracy of the model 20 mape 100 n i 1 n l i l i l i 21 rmse 1 n i 1 n l i l i 2 22 rmsre 1 n i 1 n l i l i l i 2 23 r 2 i 1 n l i l t l i l i 1 n l i l t 2 l i l 2 2 where li the observed lake levels and l i the standardized and differenced modeled lake level it should be noted that the value of rmse has a dimension of the meter in addition to the indices the nash sutcliffe index is also used to evaluate the performance of the model for data that has a difference from the mean burnham and anderson 2002 nash and sutcliffe 1970 24 n s e 1 i 1 n l 0 i l f i 2 i 1 n l 0 i l 0 i 2 where l0 i and lf i are respectively the ith value of observed and forecasted lake levels the nash sutcliffe coefficient measures the forecasting power of models through the deviates from the mean value the statistical value varies from to 1 and the closer the coefficient is to 1 the more accurate model moreover the akaike s information criterion aicc is used to examine and compare the models by considering the accuracy and complexity of the model simultaneously the aicc allows comparing the statistical models by dealing with the compromise between the simplicity of the model and its goodness of fit the aicc index is defined as follows 25 aicc n ln σ ε 2 2 k n n k 1 where k is the number of parameters n number of months is the residuals standard deviation 3 case studies areas the data used in this study is the time series for the van lake in turkey and michigan huron lake in north america van lake is about 3713 km2 in turkey the deepest part of the lake is 457 m its longest dimension is 119 km and the altitude is 1650 m the water level reached its lowest level in the winter and rising over the spring feeding on melting snow surrounding mountains rainfall and small rivers the quality of water in this lake is not suitable for use in agriculture and drinking because of its high salinity this lake is the largest lake in turkey and it has an essential role in its economy due to its proximity to iran during the last decade the van lake level in eastern turkey has been on the rise submersing the flat shorelines damage to people s property problems for the irrigation and drainage systems and greatly concerning governmental officials and local administrators altunkaynak 2007 thus the van lake level forecasting is a necessary issue that attracts the researchers attention the michigan huron lake is one of north america s largest water supply sources in both the united states of america and in canada brinkmann 2000 the surface area of this lake is 117 300 km2 with a maximum depth of 281 m the volume of water is 8460 km3 the largest inflow into this lake is st mary s river from lake superior and its main outlet is via the st clair river to lake erie the population of the michigan huron basin is about 33 million people which commercial activities are comprising production of industrial products tourism and agriculture wilcox et al 2007 the position of the van lake and the michigan huron lake is presented in fig 2 the data related to michigan huron lake and van lake had been measured at harbor beach united states and tatvan turkey stations respectively van lake data was measured from 1944 to 2002 708 monthly levels michigan huron lake water level data is also available from 1918 to 2013 1152 monthly levels this data has been measured at hurbor beach station for time series modeling 80 of the beginning of the series as the data for the van 564 months and michigan huron 912 months are considered for train and 20 end for testing for van 144 months and michigan huron 240 months measured data are hydrologically based meaning from the beginning and the end months of october and september fig 3 shows the time series of the data studied in this figure it can be seen that time series have trend and jump and severe fluctuations however for the further review the autocorrelation function acf and partial autocorrelation function pacf diagrams are presented in fig 4 illustrating the trends and fluctuations for the time series the statistical indices of the two lakes are presented in table 1 in this table from left to right the number of data in both the test and train the mean of the data x the standard deviation sd the coefficient of variation cv the minimum xmin the first quartile q1 the median x50 the third quartile q3 the maximum xmax the skewness sk and the kurtosis ku of the both lakes data is seen the mathematical forms of the mentioned statistics are defined as follows 26 x 1 n i 1 n x i 27 s d 1 n i 1 n x i x 2 28 c v s d x 100 29 x 50 x n 1 2 if n o d d x n 2 x n 2 1 if n e v e n 30 q 1 and q 3 x y z x y 1 x y 31 s k n n 1 n 2 i 1 n x i x s d 3 32 k u n n 1 n 1 n 2 n 3 i 1 n x i x s d 4 3 n 1 2 n 2 n 3 where n is the number of samples xi is the ith sample y is the truncated integer value of w is equal to l n 1 4 where l is 1 and 3 for q1 and q3 respectively and z is the fraction component of w that was truncated away it should be not that when w is an integer y w z 0 and q1 or q3 x y it is seen that the values of the indices and the range of numbers for the two lakes are quite different distribution of data of both lakes with each other in test and train intervals are different and asymmetric the data kurtosis is negative in both lakes and is less than normal the amount of data deviation from the mean is low and this value is close to the test and train periods 4 results and discussion 4 1 the results of lake level time series modeling the data of two lakes were evaluated by the hurst test to verify the sufficient length of the data according to the results the coefficient obtained for the van lake is 1 07 and for the michigan huron lake is 0 85 both values are greater than 0 5 therefore the length of the statistical period is sufficient for modeling concerning fig 3 trends jumps and period in each case can be seen clearly this is confirmed in fig 4 with the drawing of series acf and pacf diagrams in this figure correlations of the same direction and periodicity represent the trend and period in the series but for further investigation the tests presented in the previous sections are applied to the series according to the results of the tests presented in table 2 the p value of the mann kendal seasonal mann kendal mann whitney tests for the van lake and the michigan huron lake time series are less than the significant level of 5 and confirm the trend and jump in the series but surprisingly fisher s test data for each lake time series is less than 3 which means that there are no alternatives in the series to the occurred contradiction the spectrum of the series was drawn in fig 5 in this figure it can be seen that both series have a period at the frequency equivalent to step 12 on the other hand there are apparent fluctuations in the graph of both time series the fisher test therefore has poorly tested the frequencies in series and both series have a period in step 12 the probability corresponding the adf test statistic to both series is higher 5 indicating that both series are non stationary therefore in the structure of both time series there are all definite components trends seasonal and non seasonal periodicity and jump consequently they should be eliminated by appropriate methods to remain stochastic term in the series for modeling for this purpose in the first step by a stationary using std s std and sf endeavored to remove definitive terms the test results are presented in table 2 showing that none of the methods have been able to eliminate definite terms and have decreased even in sf in the meantime the series from s std for the michigan huron lake according to the statistical probability of jump tests and trends is less than 5 the stationary of the series has increased and the probability of the test statistic has fallen below 5 i e 2 09 which is a contradiction however the results indicate that a pre processing step is not enough for the time series and requires more pre processing in the second stage of preprocessing from the series of single stage preprocessing non seasonal and seasonal differencing were made the results are presented in table 3 for van lake s time series none of the differencing methods on the time series of non seasonal standardization have been able to eliminate jump in the series except for the seasonal differentiation in the seasonal series of seasonal standardization the jump in the remaining van pre processed series has been well removed and the differencing methods on the spectral analysis series have the highest probability of statistics than standardizations the trend has been entirely eliminated by using all three differential methods and in this case the non seasonal differencing for all three series from std s std and sf has the best performance in eliminating the non seasonal trend and the seasonal and non seasonal differencing for the above series has had the best performance in eliminating the seasonal process fisher test which in the previous step showed the series without a period at this stage shows the series of non seasonal differencing seasonal differencing on std and s std respectively and the non seasonal and seasonal differencing simultaneously on the sf in a periodic manner however all three series produced for the van lake are well stationary concerning the adf test for the michigan huron lake similar to the van lake the three differencing methods have been applied to the series of non seasonal standardization in the removal of jump performed weakly the non seasonal differencing series from s std and the seasonal differential on the sf series has also failed to remove the jump but the method of non seasonal and seasonal differencing simultaneously for std and s std removed this term well the seasonal differencing method has not been able to eliminate the trend in the lake s pre processed series but the simultaneous differencing simultaneous non seasonal and seasonal has eliminated this term well the results of the fisher test also show that the simultaneous differencing induces a periodicity in all three series from std s std and sf but the test values for the other two methods of differencing are still less than 3 according to the results of the adf test the same as the van all three are stationary the acf diagrams of the above series are plotted in fig 6 in this figure it is seen that single stage preprocessing is not capable of securing the series and there are many correlations in the series by applying differentiation on the series except for the non seasonal differential in the std series and sf which caused severe seasonal correlations the correlations value for other series declined sharply and all have been stationary on the other hand the adf test is not able to identify the seasonal correlations generated in the non seasonal differential series on std and sf and they re non stationary according to the results of the tests in table 4 and the diagrams in fig 6 the series of simultaneous differencing methods are very suitable for modeling in this method it can be seen that not only have the acceptable results obtained in the tests but also according to the diagrams fewer parameters for modeling is needed for example in the seasonal differencing method at least 11 non seasonal parameters and 1 seasonal parameter for modeling are needed for both lakes while for simultaneous differencing this number has reached a maximum of 2 parameters for the van lake and maximum 4 parameters for the michigan huron lake considering the lower number of parameters for modeling that yields acceptable results leads to a simpler linear model that makes use of it more practical therefore modeling is done according to the minimum values for the linear model parameters eq 11 thus for modeling of lake time series the sarima model with seasonal and non seasonal differencing and seasonal and non seasonal parameters with a maximum order of 4 i e p q p and q 0 1 2 3 4 are used fig 6 the results of the superior model indices for each of the methods are presented in table 4 in this table it is seen that the modeling has a very good coefficient of determination the amount of errors is also very low in this modeling the combination of spectral analysis and then simultaneous differentiation has the highest correlation in the van lake and the michigan huron lake r2 0 9954 van r2 0 9889 michigan huron and the std method for van lake and s std method has the lowest value between all methods the nash sutcliffe index values also show that the modeling power of the series is high and the spectral analysis method with the sarima model 3 1 1 2 1 3 12 for van and the sarima model 1 1 0 0 1 1 12 had the best performance for the michigan huron lake nse 0 9952 van nse 0 9887 michigan huron lake akaike information criterion corrected aicc results indicate that the spectral analysis is appropriate for modeling the michigan huron lake so that the value of this criterion is the least among the other two methods while for the van the best model is the model 1 1 2 0 1 1 12 that in the first stage of its pre processing the std method has been used the number of parameters given in this model is lower than the other models and the values of the indices for this method are very close to the spectral analysis method since the values of the indices r2 0 9951 rmse m 0 0417 nse 0 9950 for this model is very close to the spectral analysis method and the values of other error indices mape 0 0019 rmsre 0 0025 is the same so the model is chosen as the superior model after identifying different models the independence of the residuals of each model should be evaluated generally the best model for van and michigan huron lakes is as 1 1 2 0 1 1 12 and 1 1 0 0 1 1 12 respectively which demonstrate the seasonal and non seasonal differencing is employed simultaneously in both lakes the aicc index which considers both the complexity and accuracy of each model for selecting the superior models for the van lake and for the michigan huron lake is 906 36 and 1580 11 respectively moreover the order of the non seasonal autoregressive ar parameter for the van lake is one while the order of the seasonal ar is zero which indicates the seasonal ar is not used by the superior model for the van lake the order of the non seasonal and seasonal moving average ma in the proposed linear model for the van lake is 2 and 1 respectively indeed the sum of the order of seasonal and non seasonal ar and ma parameters related to a superior model for the van lake is four ar 1 ma 2 seasonal ar 0 and seasonal ma 1 the order of the seasonal and non seasonal ar parameter as well as the seasonal ma for a superior model of the michigan huron lake is similar to the van lake moreover this model did not employ the non seasonal ma parameter for the michigan huron lake level prediction consequently the proposed linear method forecasted not only the fluctuations of the van lake and the michigan huron lake with a high level of accuracy but also the proposed model is straightforward with the lowest order of the seasonal and non seasonal ar and ma parameters to investigate the independence of the remaining series and to ensure the elimination of periodicity detected in the series the non parametric wald wolfowitz run test table 4 was applied to the residuals series and the cumulative periodogram drown fig 7 it is observed that the wald wolfowitz test values for all series of residues are more than 50 indicating the relative independence of the residuals and the validity of the modeling on the other hand according to fig 7 all independent series and periodicity have been eliminated well the time series graphs for the van lake and michigan huron lake along with the superior method for each lake is presented in fig 8 in this figure it can be seen that the modeling of the series results from the pre processing using the std and sf method for the van lake and the michigan huron lake using the sarima model provide very satisfactory results so that the predicted value has very good conformity with the observed values in fig 9 the box plot of the series is modeled using the sarima model for each of the 3 preprocessing methods in this figure it can be seen that the box areas for all three methods of stationary are very close to observational values and the statistical characteristics are well maintained and close to real values on the other hand the predicted peak samples in michigan huron lake by std and sf is much closer to the observed values related to s std 4 2 comparison of the proposed methodology with ann and anfis it is essential to adjust the modifiable parameters related to each model to achieve an accurate and optimal nonlinear based models ann anfis the optimal values of the ann and anfis for modeling the water level of the michigan huron lake and the van lake which are attained through a trial and error process have been presented in the following table table 5 table 6 compares the results of the best models presented using the proposed linear based methodology for van and michigan huron lakes with the results of nonlinear methods ann anfis the results of linear methods are divided into two categories results presented in previous studies kişi 2009 çimen and kisi 2009 and the results of modeling in this study the van lake level modeling presented by kişi 2009 and çimen and kisi 2009 has a lower accuracy than the modeling performed in this study çimen and kisi 2009 have been able to increase the accuracy of the van lake level modeling by increasing the number of hidden layer neurons and also considering a delay higher than kişi 2009 the relative error presented for the ann model 4 8 1 çimen and kisi 2009 is about one third the value of this index for ann 3 1 1 kişi 2009 on the other hand the coefficient of determination also increased by about 3 in this study the non linear modeling of these data has been modeled due to the lack of access to the exact amounts of modeling data in past studies to compute indices such as nse aicc rmsre the indices presented for van s lake data test period shows that the two models ann 3 1 1 and ann 4 1 1 which have a very simple structure have fairly similar accuracy and the increase in lag does not have a significant effect on modeling also for the data of this lake two models with ann models similar regarding number and type of parameters are modeled using anfis the anfis model fcm 2 3 indicates that the fuzzy c means clustering method has been used for fis generation in anfis the number of clusters considered is 2 and the number of inputs of the model is also 3 t 1 t 2 t 3 for anfis models with the constant of modeling conditions the increase in the number of modeling parameters from 3 to 4 has led to a relatively small accuracy increase although it also adds to the complexity of the model comparing the two models of anfis fcm 2 3 and anfis fcm 2 4 using the aicc index which also considers the complexity of the model in addition to considering the accuracy of the model shows that the aicc for anfis fcm 2 3 is less than the anfis fcm 2 4 aicc 738 72 the comparison of two nonlinear ann and anfis methods using the aicc index shows that the ann model 3 1 1 aicc 797 86 has the best performance among all the nonlinear models presented in this study in this study in addition to the statistics indices that only consider the model s accuracy r2 0 9951 rmse m 0 0417 mape 0 0019 rmsre 0 000025 nse 0 995 have better performance than nonlinear methods in terms of aicc 906 36 also have a significant advantage over nonlinear methods therefore the proposed linear based methodology is a superior modeling technique compared to the existing non linear methods by providing a simpler yet more accurate model than the nonlinear models the results of the proposed linear based methodology in the michigan huron lake and the van lake level each of which in three different structures and are compared with two existing non linear models in table 6 in both ann and anfis methods with the constant of all the parameters of the model increasing an input parameter leads to an increase in modeling accuracy it should be noted that the excessive increase in the number of inputs increases the complexity of the model for this reason the aicc index which takes into account the complexity and accuracy of the model simultaneously is presented in this study the lowest value of the aicc index is obtained in ann and anfis methods for a different structure the use of the 5 input parameters leads to the best answer in ann 5 1 1 aicc 1508 74 while using 4 parameters is along with the best performance in anfis fcm 2 4 aicc 1443 41 similar to the van lake the use of the ann is better than anfis so that the aicc index is less than the best anfis for the best ann model about 4 however other values of indices also generally outperform the ann as compared to anfis the comparison results of the proposed linear based methodology for michigan huron lake r2 0 9889 rmse m 0 0368 mape 0 0171 rmsre 0 00209 nse 0 9887 aicc 1580 11 with nonlinear models shows the superiority of the proposed methodology over the existing methods the taylor diagram taylor 2001 is an appropriate tool for evaluating various methods the values of the coefficient of determination in the form of the circular radius on its arc the standard deviation values of two concentric circles relative to the center of the circle and the values of rmse in two concentric circles relative to the reference point of the hollow circle on the horizontal axis are plotted the reference point indicates the position of the synoptic station based on the standard deviation of its time series because the rmse value and the coefficient of determination of the time series of the synoptic station will be zero and one compared to itself respectively so its position on the horizontal axis will be determined based on the standard deviation the evaluation method in this diagram is that the position of the data under investigation based on rmse its coefficient of determination with the synoptic station of each data and the standard deviation of the time series on the diagram which location is closer to the reference point on the graph estimates the lake level value with more accuracy for the van lake level time series comparing the results of the two models presented for each of the ann and anfis methods with the proposed linear based methodology it can be seen that the distance of the reference point from the proposed method to the non linear method relative to the observational data points is less likely to be due to better performance of this method than ann and anfis for the michigan huron lake level time series the points of the various models in the ann and anfis methods show no significant difference and sometimes these points are on each other which indicates the insignificance of the difference in models in fact increasing the number of inputs will not have a significant impact on the modeling results in this time series like the van lake the proposed linear based methodology to the ann and anfis methods is closer to the reference point for observational data fig 10 the ua results have been presented in table 7 this table represents the number of samples ns mean of individual forecasted error mife the standard deviation of individual forecasted error sdife the width of uncertainty band wub and 95 forecasted error interval fei it is clear that the proposed linear based methodology technique for two lakes has performed better than nonlinear methods with less computed uncertainty the positive value of mife for all linear and nonlinear models for both of lakes shown the overestimate performance of these models in lake level forecasting the mife for the proposed methodology is calculated as 0 03346 and 0 02922 compared to 0 04750 for ann 4 1 1 and 0 03381 for ann 5 1 1 for the van lake and the michigan huron lake respectively moreover the min value of wub was calculated for the proposed methodology at the van lake wub 0 00455 and michigan huron wub 0 00264 the smallest and the highest value of wub are ann 4 1 1 wub 0 00610 and anfis fcm 2 4 wub 0 00766 for the van lake and anfis fcm 2 5 wub 0 02504 and ann 3 1 1 wub 0 02707 respectively the proposed methodology had the lowest mife and the smallest wub of all the compared methods 5 conclusions we presented a novel linear based model for lake level time series llts forecasting and evaluated the performance of the methodology using two case studies of the van lake in turkey and the michigan huron lake in north america the llts were preprocessed using standardization seasonal standardization spectral analysis and seasonal and non seasonal differencing the new llts modeling technique presented in this study outperformed two popular nonlinear techniques the ann and the anfis with improved accuracy and lower uncertainty the main reason for the improved performance of the new model is due to the appropriate pre processing by identification of the deterministic terms and removing them before stochastic modeling the main finding of the study are as follows the fisher s test was poor in detecting the periodicity in the llts while using the spectral analysis of different series was a better method for identifying the seasonal periodicity we employed the standardization seasonal standardization and the spectral analysis to remove the deterministic terms from the llts however none of these methods were able to remove the deterministic terms adequately therefore the first round of preprocessing was not adequate and a second round was necessary to reach optimum results in the second round of preprocessing the seasonal and non seasonal differencing and simultaneous seasonal and non seasonal differencing were employed the use of concurrent seasonal and non seasonal differencing not only removed the deterministic terms and stationarized the series but also lowered the seasonal and non seasonal differencing to achieve the optimum model the new linear based method is appropriate for forecasting monthly lake water levels the best models for the van lake was obtained using standardization preprocessing as the first step and the final model was 1 1 2 0 1 1 12 r2 0 9951 rmse m 0 0417 mape 0 0019 rmsre 0 000025 nse 0 995 aicc 906 36 while for the michigan huron lake the best preprocessing was obtained using spectral analysis and the best model had performance metrics of r2 0 9889 rmse m 0 0368 mape 0 0171 rmsre 0 00209 nse 0 9887 aicc 1580 11 comparing the proposed linear based methodology for lake level modeling with the ann and the anfis methods using different relative and absolute statistical indices for the accuracy and complexity of model predictions shows that the proposed methodology in the current study outperformed the nonlinear based methods regarding complexity and efficiency this superior accuracy and lower uncertainty of the new model predictions compared to the ann and anfis models were detected for both the van lake and the michigan huron lake due to the high performance of the proposed linear based this approach is recommended for modeling llts at other lakes moreover this methodology is suggested for the other time series forecasting applications conflict of interest the authors declare that they have no conflict of interest appendix a hurst coefficient the hurst coefficient is defined as follows a1 h c l o g r s x l o g n 2 a2 s s min max s 1 s 2 s n a3 r s s s max s min in the above relationship sx is the standard deviation of the data and n is the total number of data s min max is the maximum and the minimum of the cumulative deviate series as s i 1 n l i l appendix b trend analysis to test the changes in the hydrological time series there are many statistical tests that one of the most popular and most widely used tests is the non parametric mann kendal test and the mann kendal seasonal test used to determine the significance of trends of the term xu et al 2003 the test relationships used to examine the existence of the trend are as follows a4 u mk mk 1 var mk 0 5 mk 0 0 mk 0 mk 1 var mk 0 5 mk 0 where umk is the standard of mann kendall statistic mk is the man kendall statistic and var mk is the variance of mk the mk and var mk are defined as a5 mk i 1 n 1 j i 1 n sgn l j l i a6 var mk 2 n 3 7 n 2 5 n j g o j o j 1 2 o j 5 18 where l is the lake levels g is the number of identical groups oj is the number of observations at the jth group sgn is the sign function and n is the number of samples also the seasonal mann kendall tests are expressed as follows a7 s k i 1 n k 1 j i 1 n k 1 sgn l ki l kj a8 smk k 1 ω s k sgn s k a9 var smk 2 i 1 ω 1 j i 1 ω σ ij k ω 2 n k 3 7 n k 2 5 n k 18 a10 u smk m k var mk 0 5 where ω is the number of the season in a year and σij is the covariance of statistic test in season i and j if the probabilities of these tests are higher than the significant level of 0 05 then time series has no trend appendix c jump analysis the non parametric mann whitney test is employed to check that the randomly selected values from one sample of time series are equal or different from the selected ones from the second sample of it and thus the jump in series is assessed mann and whitney 1947 the statistic of this test is computed as follow a11 m w u t 1 n 1 d o t m 1 m 1 m 2 1 2 m 1 m 2 m 1 m 2 1 0 5 12 in this regard the ot is series arranged according to the original series l t d ot the degree of function ot m1 and m2 are the number of sub series members of the main series that the sum of which is equal to the original series length if the probability corresponds to the test statistic in the normal probability distribution the confidence level is greater than α the assumption of the same distribution of series is acceptable and the main series is jump free appendix d period analysis the recognition of periodic term as an essential part of the time series is of particular importance which is done with different tests the fisher test is used as a method to identify significant periodicities over time the following equation is used to determine the existence of periodic components kashyap and rao 1976 a12 f n n 2 4 α k 2 β k 2 z 1 k x t α z cos ω z t β z sin ω z t where f n αz βz and ωz are the fisher statistic number of samples fourier coefficients and the angular frequency respectively the αz βz and ωz are defined as follows a13 α z 2 n t 1 n l t cos 2 π f z t z 1 2 k a14 β z 2 n t 1 n l t sin 2 π f z t z 1 2 k a15 f z z n a16 ω z 2 π z n z 1 2 k where fz is the zth based frequency harmony if the f distribution critical value at a significant level f 2 n 2 is lower than f then the ωz related periodicity will not be significant in other words a17 f f 2 n 2 appendix e supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 01 010 appendix e supplementary data the following are the supplementary data to this article supplementary data 1 
