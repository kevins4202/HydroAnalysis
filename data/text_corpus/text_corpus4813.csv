index,text
24065,operational forecasting systems are important for disaster risk reduction in this work we implement a coupled storm surge and tidal model on an unstructured grid over europe towards the development of a pan european storm surge forecasting system eu ssf the skill to predict tidal surge and total water levels was evaluated based on measurements from 208 tidal gauge stations results show satisfactory performance for the two atmospheric forcing datasets tested a high resolution forecast and era interim reanalysis both provided by the european center for medium range weather forecast for tidal predictions the total rss is equal to 0 197 m lower than the values estimated by the global tidal model fes2004 and outperformed only by fes2012 rss 0 05 m which however is a product of data assimilation storm surge validation results show good predictive skill with 0 04 m rmse 0 21 m and rmse within 4 22 coupling with tides results in improved storm surge level predictions with rmse reducing by up to 0 033 m the areas benefiting most from the coupling are the north sea and the english channel resulting in up to 2 reduction of the rmse increasing the resolution of atmospheric forcing also improves the predictive skill leading to a reduction of rmse up to 0 06 m in terms of the extremes especially in shallow areas where wind is the main driver for surge production we propose a setup for operational pan european storm surge forecasting combining tidal levels from the fes2012 model and storm surge residuals from the eu ssf setup which couples meteorological and astronomic tides keywords storm surge operational forecasting coastal flooding marine storms natural hazards numerical modelling 1 introduction coastal flooding is a major natural hazard that can inflict large social economic and environmental impacts forzieri et al 2016 hinkel et al 2014 vousdoukas et al 2018a as exemplified by storm xynthia that hit the atlantic coast in 2010 bertin et al 2014 a main driver of coastal hazard is storm surge an anomalous rise of the sea level induced by low pressure and its associated wind when storm surges coincide with spring tide especially low lying areas are prone to coastal flooding several such events happened along the european coastline ciavola et al 2017 garnier et al 2017 the most notable example is the big storm in 1953 wolf and flather 2005 that struck the coasts of the uk netherlands belgium and germany producing surges over 3 m and leading to a major disaster with more than 2000 casualties in the netherlands it marked the launch of the dutch national water management plans and huge investments in coastal protection in 2010 the storm xynthia hit the atlantic french coast in the bay of biscay for this event the surge itself was not exceptional but due to the co occurrence with spring tide bertin et al 2014 it resulted in extensive coastal flooding 47 casualties and monetary damage of around 1 5 billion euros ddtm 17 2011 another example is the storm xavier that took place in december 2013 it also coincided with high astronomical tides and affected extensive areas in northern europe wadey et al 2015 causing environmental damage infrastructure disruptions flooding and or damage to buildings and private property the above events have occurred during the past and present century when increasing population and development in coastal zones has amplified coastal risk bouwer 2011 visser et al 2014 global warming and corresponding sea level rise is expected to result in a further intensification of coastal hazards vitousek et al 2017 vousdoukas et al 2018b highlighting the need for disaster risk management measures overall disaster risk reduction has been shown to reduce losses and mortality from extreme floods bouwer and jonkman 2018 kreibich et al 2017 short term forecasting can be complementary to adaptation actions aimed at medium and long term flood risk reduction for example early warning systems harley et al 2011 harley et al 2016 vousdoukas et al 2012b can assist emergency response operations by providing useful information about the timing and spatial distribution of hazardous conditions this is crucial to support decisions on resource deployment and evacuation during an event cheung et al 2003 in europe there are several regional operational storm surge forecasting systems that resolve tidal and atmospheric forcing sembiring et al 2015 zampato et al 2016 several of these systems contribute to the copernicus marine environment monitoring service cmems the latter combines information from different regional domains iberia biscay ireland regional seas black sea baltic sea european north west shelf seas and mediterranean sea into one unified platform http marine copernicus eu cmems offers also a global sea level forecast service lellouche et al 2018 lellouche et al 2013 but that only considers wind forcing and omits pressure effects on the contrary the dynamic atmospheric corrections dac are produced by cls using the mog2d model from legos and distributed by aviso with support from cnes https www aviso altimetry fr and takes into account only the inverse barometer effect omitting winds apart from these regional systems and a few exceptions muis et al 2016 there is a lack of systems that cover continental and beyond scales and resolve all major physical factors contributing to extreme sea levels such systems can complement regional ones by providing homogenous information over extensive spatial domains including areas not served by national regional systems against the foregoing the present contribution reports on the implementation and validation of a pan european storm surge forecasting system eu ssf aspiring to become a future candidate for inclusion in the european flood awareness system www efas eu the manuscript is structured as follows in section 2 the model set up calibration and validation are outlined in section 3 results from the validation are presented along with the outcomes of a sensitivity analysis on the resolution of the atmospheric forcing and the effects of tide storm surge interactions section 4 provides a discussion of the results and a foresight related to model improvement and optimization of the operational setup finally section 5 summarizes the main conclusions 2 methods 2 1 model setup the schism model http ccrm vims edu schismweb was used to simulate the tide surge generation and propagation schism semi implicit cross scale hydroscience integrated system model is based on the original selfe code zhang and baptista 2008 with many enhancements and upgrades including an extension to large scale eddying regime and a seamless cross scale capability from creek to ocean zhang et al 2016 the model solves the full navier stokes equation over unstructured grids in the present study schism was configured in its 2d barotropic mode which can be considered as a reasonably accurate approximation for the given application it further increases the model efficiency hence allowing simulations at continental scales with affordable computational and storage requirements the model configuration accounts for the combined effects of wind atmospheric pressure gradients and tides schism was forced by sea level pressure and 10 m wind speed atmospheric fields from era interim as well as by a ecmwf high resolution forecast see section 2 2 the surface stress in schism is computed using a bulk formula with the drag coefficient computed according to pond and pickard 2013 tidal forcing includes the astronomic potential over the whole domain and boundary conditions along the open boundaries see fig 1 a the main tidal constituents in the area are considered mm mf o1 k1 p1 q1 m2 s2 n2 and k2 and are available from the finite element solution 2012 fes2012 carrère et al 2012 the computational domain extends from 25wo to 42eo and from 25no to 76no fig 1a the computational grid is an unstructured mesh with triangular elements and varying resolution ranging from 78 km in the western boundary of the domain to a higher resolution 10 km along the european shallow coastal areas the simulations are based on bathymetric data from the european marine observation and data network emodnet originally provided in angular coordinates at a resolution of 1 8 minute 0 0021 http www emodnet eu bathymetry the model calibration and validation was based on model simulations spanning from 1 february 2010 to 1 march 2016 a period characterized by a high marine storm activity including extreme storm surge events that caused severe impacts along the european coastline bertin et al 2014 spencer et al 2015 vousdoukas et al 2012a the validation was performed considering the whole time series as well as the upper tail of the data distribution in order to evaluate the model s skill to reproduce extreme events to ensure model stability and optimize computational times the validation period was divided in 1 year simulations including an additional month as spin up time and then the resulting water level time series were merged the model output provides water level every 3 h at 11 366 locations distributed every 10 km along the european coastline numerical simulations were run in parallel on a high performance computing facility using 32 processors 2 6 ghz subdividing the computational domain into 32 subdomains 2 2 numerical experiments a set of model runs were conducted in order to assess the model s performance as well as its sensitivity to factors like the resolution of atmospheric forcing and non linear interactions between tidal and atmospheric forcing hereinafter the storm surge η ssl refers to the anomalous sea level rise driven by wind and pressure whereas the non tidal residual η re refers to the anomalous sea level rise including as components both the atmospheric effect and the tide surge interaction the set of performed numerical experiments is listed in table 1 the experiment e0 neglects meteorological factors in order to validate the model s skill to reproduce tidal elevations only the experiment e1 considers only the atmospheric forcing from era interim 6 h temporal resolution and 0 75 0 75 spatial resolution without tidal forcing to assess performance in terms of storm surge forecasting in a fictional non tidal setup the fully forced run e2 combines tidal and atmospheric forcing era interim once the non tidal residual was subtracted from e2 results it allowed the evaluation of the effect of the interaction between the storm surge and the tidal component by comparison with the e1 results as well as to evaluate the model s performance in reproducing the non tidal residual an additional group of runs was performed with the purpose of assessing the influence of the atmospheric forcing resolution in the model s performance to that end a second higher resolution dataset based on the global ecmwf forecast was used ecmwf hres https www ecmwf int en forecasts datasets set i the dataset is available after 2010 and has a spatial resolution of 0 1 0 14 since the forecast provides atmospheric forcing parameters for a 72 h time window on a daily basis the latest forecast available for each day is considered creating a dataset which covers the whole testing period two additional runs are forced by ecmwf hres one similar to e1 e3 only atmospheric forcing and one similar to e2 e4 tidal and atmospheric effects although the original temporal resolution of ecmwf hres is 1 h here the dataset is subsampled at 6 h intervals to match the era interim dataset keeping the same time signatures to eliminate temporal resolution bias is avoided when comparing the runs forced from the two datasets in addition to the tidal performance of eu ssf we assess the performance of available global tidal models such as the tpxo7 2 ocean tide model egbert and erofeeva 2002 finite element solution 2004 fes2004 lyard et al 2006 and finite element solution 2012 fes2012 carrère et al 2012 the tidal predictive skill of eu ssf is compared with the one of the above tidal models 2 3 model validation the model validation is based on a ground truth dataset from 208 tidal gauges available from the jrc sea level database http webcritech jrc ec europa eu sealevelsdb and emodnet web site http www emodnet physics eu map from which 192 are finally used after a quality control to remove spikes and other erroneous observations fig 1a the tidal gauge stations provide satisfactory spatial representation of the european seas fig 1a with the exception of the east mediterranean and black sea where only one station in each region provides usable measurements to filter out long term sea level variations the water level time series each station was de trended by removing the one year moving average hereafter a tidal harmonic analysis was performed using the t tide package pawlowicz et al 2002 separating the astronomical tide η tide and the non tidal residual η re components note that η re not only contains the meteorological contributions but also a non linear tidal surge interaction component haigh et al 2016 and the combination of both components results in the total water level twl 1 twl η tide η re the temporal resolution of the water level measurements normally varies from few minutes to 1 h while few stations recorded data during the entire validation period fig 1a 88 4 and 57 5 of the tidal stations respectively cover more than 20 and 50 of the validation period fig 1b additionally 55 1 of the 192 tidal gauges used for validation provide data for more than 10 years and only 13 6 of the tidal gauges cover less than 5 years fig 1c the model validation was performed along the european coastline considering each tide gauge location and its corresponding nearest model grid point the model s ability to reproduce the astronomic tide is evaluated in terms of the bias ε a relative bias δ a and bias for the tidal phase ε p for each tidal constituent 2 ɛ a i a o i a p i 3 δ a i a o i a p i a p i 4 ɛ p i p o i p p i in addition the model accuracy to reproduce the tide is evaluated by calculating the vectorial difference of the main diurnal and semidiurnal constituents the root mean square deviation of the amplitude d 5 d j i a j o i c o s p j o i a j p i c o s p j p i 2 a j o i s i n p j o i a j p i s i n p j p i 2 where a is the amplitude m p is the phase degrees subscript j refers to the tidal gauge station subscript i refers to the tidal constituent subscript o is the observed data from the tide gauge and subscript p is the model s predicted result the root mean square deviation of the amplitude rms for each constituent is defined as follows tsimplis 1995 6 r m s i 1 2 n j 1 n d j i 2 where n is the number of the tide gauges considered and d j i is the vectorial difference defined for each location and each tidal constituent to evaluate the total effect of the main tidal constituents the root sum of square rss arabelos et al 2011 ferrarin et al 2013 is computed as 7 r s s i 1 n r m s i 2 the ability of the model to reproduce the storm surge non tidal residual and total water level was based on the root mean square error rmse and the corresponding relative root mean squared error rmse 8 r m s e σ k n η o k η p k 2 n 9 r m s e σ k n η o k η p k 2 n max η o 100 where n is the number of measurements in the time series at a given location η o is the water level from measurements observed non tidal residual or twl and η p is the predicted water level storm surge or non tidal residual the effect in model performance of changing the model setup was evaluated in terms of rmse difference computed as 10 δ r m s e r m s e a d v r m s e b a s e where rmseadv is the advanced configuration i e including tidal process or ecmwf hres atmospheric forcing and rmsebase is the base configuration i e omitting tidal process or era interim atmospheric forcing the effect of the tidal surge interaction and atmospheric forcing accuracy resolution was evaluated in terms of biasadv for the whole time series computed as 11 b i a s a d v 1 n η a d v η b a s e where η adv correspond to the storm surge non tidal residual or total water level achieved using the advanced configuration and η base correspond to the base configuration in the case of the extremes values the effect will be evaluated in terms of the differences in percentile p99 δ p 99 p 99 η a d v p 99 η b a s e 3 results 3 1 tidal prediction validation the present section discusses validation results related to the principal tidal constituent semi diurnal m2 s2 and diurnal o1 and k1 obtained from the e0 numerical experiment as well as of the tpxo7 2 fes 2004 and fes 2012 tidal models the main semidiurnal tidal constituent m2 is reproduced satisfactorily in the model with relative bias δ a 15 for most of the tidal gauge stations fig 2 the highest δ a is found along the mediterranean and baltic sea circa 50 but the performance in these micro tidal areas is less important and bias remains below ε a 0 06 m this is also the case for 56 of the tidal gauge stations fig a 1b while the maximum bias in m2 prediction is found at the eastern edge of the english channel 0 2 ε a 0 4 m the m2 phase is also well reproduced with ε p 15 for 74 of the tidal stations fig a1c and the worst performance observed along the baltic sea and southern north sea fig 2c the spatial pattern of the s2 constituent validation results is similar to the m2 with ε a 0 015 m and ε a 0 09 m for 44 7 and more than 15 of the tidal stations considered respectively fig 2e the phase is also satisfactorily simulated fig 2f with ε p 15 for 76 9 of the tidal gauges fig a1f however a poorer performance is observed along the baltic coast and the north sea the diurnal constituent k1 fig 2g shows the worst performance however it contributes very little to the twl in macro and meso tidal areas amplitude bias ε a 0 01 m is found for almost 55 of the tidal gauges considered fig a1h and ε a 0 03 m for 85 of the tidal gauges similarly the validation for the k1 tidal phase shows 0 ε p 15 for 44 2 of the tidal gauge stations and 15 ε p 30 for 34 6 of the stations fig a1i the model s performance is better for the o1 diurnal tidal constituent with ε a 0 01 m for 77 of the tidal stations fig 2k and fig a1 k the o1 phase error varies between 0 ε p 15 for 50 5 of the tidal stations and from 15 to 30 for 30 3 of the tidal gauge stations fig a1l the absolute error in o1 phase is larger in the irish sea west mediterranean and baltic sea fig 2l to better interpret the eu ssf tidal prediction performance we have also performed a similar validation analysis for the tidal levels provided by the global tide models tpxo7 2 fes 2004 and fes2012 the total rss for eu ssf is equal to 0 198 m table 2 lower than the values estimated for fe2004 and tpxo7 2 which have respectively rss values of 0 42 and 0 39 m however the fes2012 model outperforms eu ssf with rss 0 148 m similarly rms values for the m2 and s2 components for eu ssf are respectively 0 181 m and 0 071 m markedly higher than the ones of fes2012 0 14 m and 0 046 m 3 2 non tidal residual water level validation the non tidal residual validation is performed after subtracting the astronomical tide signal estimated by harmonic analysis from the water levels generated from the e2 experiment the model shows a good predictive skill with 0 04 m rmse 0 21 m fig 3 a table 3 more than 91 of the tidal gauges show rmse values lower than 0 125 m fig 3b and only 2 of the stations result in rmse 0 15 m in general rmse values are below 0 1 m with the exception of the north sea 0 10 m rmse 0 14 m and the east coast of the baltic sea gulfs of bothnia finland and riga 0 1 m rmse 0 15 m in areas characterized by lower non tidal residual values the rmse shows the opposite trend to rmse e g see the highest values found in the mediterranean sea and s north atlantic rmse ranges from 4 to 22 fig 3c with 70 of the tidal gauges showing values of rmse 12 5 only 6 2 of the stations show rmse 17 5 fig 3d the model shows good performance in the reproduction of non tidal residual extremes and the upper tail 99th percentile rmse is below 0 25 for 79 of tidal gauge stations fig a2b the higher rmse values are observed along the north sea west coast of bay of biscay gulf of bothnia in the baltic sea as well as the north adriatic sea 0 3 m rmse 0 4 m fig a2a the rmse for the extreme events remains below 25 for most of the tidal gauge stations 64 fig a2d the largest rmse values 30 40 are located in the mediterranean and in the s north atlantic 3 3 benefits of coupling storm surge and tide the inclusion of tidal processes in the simulations case e2 see table 1 allows to resolve the non linear interactions between meteorological and astronomic tides this clearly leads to an improvement in predictive skill compared to when tidal forces are omitted e1 the rmse reduces up to 0 033 m 14 fig 4 a the improvement in performance is more pronounced along the north sea and the english channel resulting in up to 2 reduction of the rmse fig 4b considering only the changes in the extreme events 99th percentile the differences in rmse vary within 0 086 m δrmse 0 037 m fig a3a coupling with tides improves the forecasting skill of the extreme η re at the english channel 0 02 m δrmse 0 04 m bristol channel δrmse 0 086 m south irish sea celtic sea and the nnorth atlantic region 0 01 δrmse 0 03 m similarly rmse appears to reduce by up to 4 in these areas fig a3b the opposite effect is observed along the central and eastern north sea western coast of the jutland peninsula northern irish sea and north channel where the rmse increases around 0 01 0 02 m 1 2 3 4 sensitivity to atmospheric forcing accuracy resolution the validation considering the whole time series allowed us to find that the higher resolution atmospheric forcing case e3 see table 1 allows a reduction of the η ssl rmse by 0 02 m along the norwegian and adriatic sea as well as most of the west mediterranean in comparison to the era interim e1 run in addition a rmse reduction of 0 03 m is observed in the western coast of the jutland peninsula fig 5 a the rmse is reduced up to 2 in the same areas the opposite effect is observed in the baltic sea bay of kattegat bay of biscay n north atlantic and west southwest coast of the north sea in those areas using the high resolution forcing the rmse increases by 0 01 m 0 04 m the increase in rmse is around 2 rmse 4 fig 5b a similar analysis considering only the extreme storm surges upper tail distribution above 99th percentile showed in fig a4 shows that the higher resolution forcing ecmwf hres improves the predictive skill in enclosed basins fig a4a for example rmse reduces by 0 05 m in the gulf of venice adriatic sea gulf of bothnia baltic sea and black sea the rmse is reduced by 10 in the gulf of venice and gulf of bothnia and by 15 in the black sea a smaller 5 rmse reduction is observed for the mediterranean norwegian and baltic sea nevertheless the higher resolution forcing appears to produce an increase 4 in rmse along the n north atlantic and the english channel fig a4b 4 discussion 4 1 tidal predictive skill our eu ssf satisfactorily describes tidal dynamics along european coastlines but its performance may still be poorer than that of regional models for example in the central mediterranean sea ferrarin et al 2013 reported a rmse 0 01 m for the main tidal constituents m2 s2 k1 and o1 and a rss of 0 015 m these values are lower than the 0 009 m rmse 0 026 m and rss 0 04 m reported herein tsimplis et al 1995 reported for the whole mediterranean sea a 0 008 m rmse 0 014 m and a rss 0 023 m compared to the 0 008 m rmse 0 027 m and rss 0 036 estimated by our eu ssf for the western iberian peninsula quaresma et al 2013 reported a bias between 0 006 ε a 0 04 m for the amplitude of m2 and s2 and for the phase between 0 4 ε p 7 in comparison our eu ssf shows an amplitude and phase bias of respectively 0 003 ε a 0 18 m and 0 3 ε p 37 for s north atlantic in the bay of biscay bertin et al 2012 report an amplitude bias 0 01 ε a 0 04 m and a phase bias below 11 for m2 whereas our eu ssf m2 amplitude bias is between 0 07 ε a 0 35 m and the phase bias is between 1 4 ε p 13 idier et al 2017 report an amplitude relative bias for the north sea and n north atlantic for constituents m2 s2 n2 k2 and m4 below 5 in most of the tidal stations values which are lower than the presently reported mean relative amplitude bias 4 δ a 14 calculated for m2 and s2 however our eu ssf outperforms most global tidal models table 2 fig a5 with the exception of fes2012 the latter does not come as a surprise since fes2012 s skill is enhanced by data assimilation of long term altimetry data topex poseidon jason 1 jason 2 ers 1 ers 2 and envisat carrère et al 2012 as in previous studies the accuracy in tidal solution is reduced in shallow water areas with complex bathymetry and geometry zijl et al 2013 tidal dynamics are strongly affected by the bathymetry in those areas and corresponding transformation processes are not fully resolved for various reasons these include the limit in the amount of detail in the bathymetric data the resolution of the computational grid 10 km along the coast and the simplifications imposed by a 2d barotropic model these aspects are particularly important in areas with complex tidal dynamics such as the german bight and or exchange areas between two ocean basins characterized by different seawater properties e g the gibraltar strait or the baltic sea 4 2 non tidal residual and storm surge water level prediction validation results demonstrate that the eu ssf satisfactorily reproduces the non tidal residual water levels the storm surge calculated from e1 improves substantially the model presented by vousdoukas et al 2016a as i the use of an unstructured grid allows a higher grid resolution nearshore without increasing the computational cost it takes 0 95 cpu hours per month simulated running in parallel using 32 processors with 2 cpus of 2 6 ghz ii eu ssf uses a higher resolution bathymetry emodnet compared to the gebco used previously as a consequence the eu ssf results have a lower rmse in all the oceanographic basins compared to vousdoukas et al 2016a with the exception of the norwegian sea where rmse increases by 0 03 m fig 6 a the average rmse is reduced by 0 03 m ranging from 0 01 m in the bay of biscay to 0 1 m in the black sea similarly the mean rmse reduces by 5 ranging from 3 in the s north atlantic to 14 in the black sea with the exception of the norwegian sea where the rmse increases by 2 fig 6b direct comparison with validation results presented in previous studies is not straightforward due to inconsistencies in the validation periods and the ground truth sea level data even though most previous studies cover smaller domains which allows modelling at higher resolution the performance is found to be comparable for example the non tidal residual rmse along the dutch coast presently ranges from 0 12 to 0 14 m while sembiring et al 2015 report rmse values with annual variation within 0 1 m and 0 2 m o neil et al 2016 report average rmse around 0 1 m along the scottish and english coast similar to 0 09 m presented in the french atlantic and english channel coast muller et al 2014 report rmse values around 0 08 m while present values are 0 10 m for the non tidal residual at the bay of biscay during the xynthia storm bertin et al 2012 report rmse values ranging from 0 12 to 0 17 m compared to 0 11 rmse 0 35 m presently reported for the upper tail values 99th percentile however the model in bertin et al 2012 uses higher spatial and temporal resolution than era interim and is specifically calibrated for the area affected by the xynthia storm moreover the presently estimated rmse 0 1 m for the baltic sea is similar to the one reported for a finer resolution model 5 5 km resolution kowalewski and kowalewska kalkowska 2017 in southern europe and central west mediterranean cid et al 2014 report an average rmse of 0 08 m slightly higher than the rmse of 0 06 m in our eu ssf table 4 shows a comparison of the eu ssf non tidal residual from e2 predictive skill with respect to the global 1 12 resolution and north west shelf sea surface height analysis provided by cmems 1 15 latitudinal and 1 12 longitudinal resolution the global model does not account for tidal and barometric effects therefore the dac correction has been linearly added to the original dataset before the comparison with the non tidal residual extracted from the tidal gauge database employed to validate eu ssf in the case of the north west shelf nws which accounts for the tide the non tidal residual is extracted before the comparison with the ground truth dataset the eu ssf shows a regional average rmse of 0 08 m compared to the 0 11 m calculated for the cmems global table 4 significant improvement of the predictive skill is identified in all the regions with the exception of the norwegian sea additionally a wide range of rmse was reported for the cmems global as indicated by the larger standard deviation of the rmse the eu ssf only shows a slightly poorer performance in comparison with the higher resolution model cmems nws regional average rmse 0 08 m and 0 07 m respectively cmems nws performs substantially better than eu ssf along the north sea and the norwegian sea rmse reduction 50 this is not surprising since the finer resolution of the cmems nws allows to capture the tidal dynamics and surge propagation in the north sea and german bight part of the superior performance of cmems nws could be attributed to the data assimilation which is included in the system s workflow 4 3 importance of resolving tide surge interactions considering tidal forces is important for storm surge forecasting as they allow resolving i the interaction between astronomic and meteorological flows and ii the tidal water depth modulations which drive changes in bottom friction and on the overall depth dependent circulation patterns arns et al 2015 thus coupled tidal storm surge models usually have higher skill brown et al 2010 zijl et al 2013 especially along meso and macro tidal areas that are strongly affected by storm surge phenomena north sea and n north atlantic fig 4 for that reason on the coast of the jutland peninsula and in the southern coast of the north sea the non tidal residual is lower than the storm surge estimated without resolving tide surge interactions see negative biasadv fig 7 a b an inverse pattern is observed in the western english channel as indicated by the scarcely positive biasadv larger differences exist in the case of the extreme events upper tail event above the 99th percentile the non tidal residual is lower than the storm surge in the western coast of the jutland peninsula and along the southern coast of the north sea while the opposite effect is observed along the west coast of ireland the celtic and irish seas and the bristol channel fig a6a such findings are in agreement with previous studies horsburgh and wilson 2007 the spatial pattern of the observed storm surge amplification reduction is related to the shape of the tidal wave and the depth dependence of the surge production and propagation processes as the water level gradient is proportional to the wind stress divided by the water depth pugh 1987 then the storm surge is higher in shallow depths storm surges and tides can be interpreted as shallow water waves with propagation velocity g h 1 2 where h is the water depth and g is the gravitational acceleration based on the above the depth decrease results in a reduction of the storm surge propagation velocity and increase of the amplitude idier et al 2017 as a result asymmetries in the tidal distribution can enhance or reduce non tidal residuals depending on whether they result in higher or lower frequency of water levels below msl for example in the case of west terschelling north sea the tidal distribution is bimodal and negative skewed favouring positive tides fig 8 a while the distribution of the non tidal residual water level is bimodal with the two peaks correlated to low and high tidal levels respectively fig 8b the result is that while the mean non tidal residual is higher during negative tides the mean η re for the extremes above 99th is higher during positive tides in both cases statistical significance of the differences of the means is tested using two sample t tests for p value 0 05 therefore omitting tides results in overestimation of the non tidal residual uncoupled vs coupled run see also fig a6a the contrary is expected to happen storm surge under prediction in areas where tides follow an asymmetrical bimodal distribution with water levels below msl being more frequent like the station of hinkley point bristol channel fig 8a the result is a unimodal negatively skewed joint distribution of η re and tidal levels which shows that extremes occur mostly during negative tides fig 8c this fact has been confirmed by the two sample t test that reveals a statistically significant higher mean p value 0 05 for the extreme surges above 99th occurred during negative tides at hinkley point the underestimation of the non tidal residual when tides are omitted is shown is shown in the uncoupled vs coupled run comparison fig a6a we have also estimated the conditional probability of η re exceeding the 99th percentile during negative and positive tides and we see that in both sites it is higher during low tide than during high tide 1 02 vs 0 88 for west tershelling and 1 22 vs 0 74 for hinkley point the above confirms that extreme η re values are favored by negative tides large scale models have a tendency to under estimate extreme storm surges calafat et al 2014 the shortcoming above can paradoxically result in an improved model performance in areas where omitting tide surge interactions results in an over prediction of storm surges this is the case of the bristol channel when only extreme events are considered fig a3 on the other hand in areas like the western coast of the jutland peninsula and the southern coast of the north sea fig a6b the storm surges are higher than the non tidal residual resulting in further under estimation even though the setup is improved of course all the above are not model setup recommendations but insights on potential interactions between epistemic error factors which sometimes can cancel each other 4 4 importance of atmospheric forcing accuracy resolution if the whole time series is considered the atmospheric resolution results in minor changes in storm surge bias adv 0 005 m fig 7c although the relative importance becomes higher when the tidal effects are included the larger values of bias adv up to 0 02 m in jutland peninsula and the southern coast of the north sea observed in the case of twl fig 7d reveal the relevance of the atmospheric resolution for the computation of tide surge interaction conversely to what was expected using the high resolution atmospheric forcing leads to lower predictive skill in terms of storm surge levels along most of the european atlantic ocean coast fig 5 this can be attributed to the fact that the ecmwf hres forcing is a forecast product in comparison to the more accurate era interim dataset that is post processed through data assimilation in addition using the full temporal resolution of ecmw hr 1 h instead of 6 h used for consistency for comparison with era interim could improve the final performance of the forecast system still the achieved results have allowed the identification of critical areas in which atmospheric forcing resolution plays a key role in the accuracy of the storm surge prediction i e semi enclosed basins like the black baltic adriatic and mediterranean sea fig 5 the benefit of increasing the atmospheric forcing resolution for the predictive skill of the extreme storm surges is evident see rmse and rmse reduction in fig a4 this is due to the tendency of large domain models to underestimate upper tail events muis et al 2016 vousdoukas et al 2016a particularly the ones characterized by short duration and high energy calafat et al 2014 conte and lionello 2013 as a result of the above an increased atmospheric resolution allows to ameliorate the underestimation of storm surge and twl fig a6c and d the greater model sensitivity to the atmospheric forcing resolution in semi enclosed basins is related to the smaller spatial scales and shorter life cycles of low pressure systems which demand higher resolution and accuracy in the atmospheric forcing this is the case for the mediterranean where pressure lows are less intense and show smaller spatial and temporal scales trigo et al 1999 and particularly in the adriatic sea where storm surge events are of higher frequency and shorter duration cid et al 2016 in a similar fashion higher frequency short duration events have been also reported in the gulf of bothnia finland and riga in the baltic sea wolski et al 2014 in addition the aforementioned areas along with the azov sea are all characterized by shallow waters here wind is the main driver of surge production since the water level gradient is proportional to the wind stress divided by the water depth pugh 1987 consequently the accuracy of wind representation becomes more relevant 4 5 towards an operational pan european forecast the following paragraphs discuss potential extensions of the present work towards an operational pan european storm surge forecasting system the appropriate forcing for such application is the high resolution ecmwf forecast while given the scope the critical prediction variable is the combined twl as a result we assess the model predictive skill considering the following alternatives f1 using the output from the coupled setup f2 combining linearly the tidal forecast from fes2012 with the storm surge prediction from the uncoupled setup i e without tidal flows f3 combining linearly the tidal forecast from fes2012 with the non tidal residual prediction from the coupled setup option f3 results in the best performance rmse 0 21 m fig 9 c reducing the average rmse by 0 06 m compared to option f1 rmse 0 27 m fig 9a and by 0 03 m with respect to option f2 rmse 0 24 m fig 9b the improved performance is mainly observed in meso and macro tidal areas a similar spatial pattern although with larger rmse reduction 0 04 m from f1 to f2 and 0 07 m from f2 to f3 is observed for the extreme twls 99th percentile see fig a7 the overall performance of option f3 is considered acceptable for the considered domain although it is poorer in comparison to the validation results reported by regional models see for example the mean rmse 0 35 m found along the north atlantic north sea skagerrak and kattegat with respect to rmse 0 10 m reported by zijl 2013 however in most cases rmse for twl remains below 0 25 m and the twl prediction error is mainly related to poor skill in reproducing the tidal levels in meso and macro tidal areas fig 2 the above solution combines the benefits from i resolving the non linear interactions between meteorological and astronomic tides in the model in terms of non tidal residual forecasting and ii having the most accurate tidal forecast benefiting from the data assimilation applied in the fes2012 model 4 6 foresight the spatial extent of the model domain imposes some inevitable limitations in the applied setup most of these can be addressed with further developments in computational power and code capabilities potential model upgrades include increasing the resolution of the computational mesh the atmospheric forcing and the bathymetry along shallow near shore areas with complex topography e g bays ports and estuaries in these areas the more dynamic circulation processes and complex bathymetry are not fully resolved by the model the same applies to semi enclosed basins e g baltic adriatic and narrow straits with complex circulation e g gibraltar english channel north channel in the irish sea and kattegat in denmark fig 2 increasing the resolution would improve model performance in all aspects and in particular in terms of the representation of the tidal dynamics and the non linear interactions with storm surge the tidal predictive skill in the twl forecast could be improved after testing and incorporating output from the more recently developed fes2014 carrere et al 2016 a step even further would be to include waves which contribute to extreme sea levels and thus coastal hazard through wave setup vitousek et al 2017 vousdoukas et al 2016b and runup serafin and ruggiero 2014 vousdoukas 2014 in addition the inclusion of waves can enhance the model s skill in storm surge estimation ferrarin et al 2013 since i wave current interaction is important in certain locations roland et al 2012 ii waves increase the roughness of the sea surface which controls wind drag and energy transfer from the atmosphere to the ocean resulting in circulation and wind set up bertin et al 2015 finally the spatial and temporal coverage of the tidal gauge database is poorer along the east mediterranean and black sea acting as a bottleneck in model validation and calibration the use of a complementary dataset from altimetry satellite data could help to assess the model performance in those areas 5 conclusions this contribution presents the development and validation of an unstructured hydrodynamic storm surge and tidal model for europe eu ssf the tidal surge model accounts for atmospheric pressure wind and astronomical tide the model has been validated against sea level measurements from 192 tidal gauge stations in terms of the skill to predict tidal and meteorological water levels as well as their combination overall eu ssf shows satisfactory performance regarding tidal prediction the total rss is equal to 0 197 m lower than the values estimated for fe2004 and outperformed only by fes2012 which results in rss 0 05 m also eu ssf reproduces satisfactorily the principal tidal constituents m2 s2 o1 and k1 the main semidiurnal tidal constituent m2 is reproduced satisfactorily with average amplitude and phase bias found equal to 0 07 m and 14 respectively non tidal residual water level validation results show good model predictive skill with rmse 0 08 m and rmse 11 respectively including tidal effects results in an improvement in non tidal residual water level prediction reducing the rmse by up to 0 033 m the areas benefiting more from the coupling are the north sea and the english channel resulting in up to 2 reduction of the rmse the improvement is even more pronounced for the prediction of extreme non tidal residual water levels 99th percentile for which the differences in rmse ranges within 0 086 m δrmse 0 037 m increasing the resolution of atmospheric forcing also improves the predictive skill especially in terms of the extremes in shallow areas where wind is the main driver for surge production like the azov sea as well as the gulf of venice 0 06 m δrmse 0 04 m bothnia 0 06 m δrmse 0 01 m the area including the gulfs of finland and riga 0 01 m δrmse 0 m the pan european storm surge model presented in this work and the findings related to the sources of uncertainty can be useful for the design of large scale storm surge forecasting systems for the present application we find that the most accurate setup is the one combining tidal levels from the fes2012 model and the non tidal residual from the eu ssf setup which couples meteorological and astronomic tides such a system can be essential for disaster risk reduction supporting the coordination of real time emergency response against surge coastal flooding future work will include several developments which are expected to increase the eu ssf performance i coupling the current model with a wave generation propagation one ii increasing model resolution in specific areas in order to properly reproduce the tidal dynamics and iii including data assimilation in the forecasting system acknowledgments the research leading to these results has received funding from the euh2020 program under eu h2020 grant agreement no 700099 anywhere enhancing emergency management and response to extreme weather and climate events appendix 
24065,operational forecasting systems are important for disaster risk reduction in this work we implement a coupled storm surge and tidal model on an unstructured grid over europe towards the development of a pan european storm surge forecasting system eu ssf the skill to predict tidal surge and total water levels was evaluated based on measurements from 208 tidal gauge stations results show satisfactory performance for the two atmospheric forcing datasets tested a high resolution forecast and era interim reanalysis both provided by the european center for medium range weather forecast for tidal predictions the total rss is equal to 0 197 m lower than the values estimated by the global tidal model fes2004 and outperformed only by fes2012 rss 0 05 m which however is a product of data assimilation storm surge validation results show good predictive skill with 0 04 m rmse 0 21 m and rmse within 4 22 coupling with tides results in improved storm surge level predictions with rmse reducing by up to 0 033 m the areas benefiting most from the coupling are the north sea and the english channel resulting in up to 2 reduction of the rmse increasing the resolution of atmospheric forcing also improves the predictive skill leading to a reduction of rmse up to 0 06 m in terms of the extremes especially in shallow areas where wind is the main driver for surge production we propose a setup for operational pan european storm surge forecasting combining tidal levels from the fes2012 model and storm surge residuals from the eu ssf setup which couples meteorological and astronomic tides keywords storm surge operational forecasting coastal flooding marine storms natural hazards numerical modelling 1 introduction coastal flooding is a major natural hazard that can inflict large social economic and environmental impacts forzieri et al 2016 hinkel et al 2014 vousdoukas et al 2018a as exemplified by storm xynthia that hit the atlantic coast in 2010 bertin et al 2014 a main driver of coastal hazard is storm surge an anomalous rise of the sea level induced by low pressure and its associated wind when storm surges coincide with spring tide especially low lying areas are prone to coastal flooding several such events happened along the european coastline ciavola et al 2017 garnier et al 2017 the most notable example is the big storm in 1953 wolf and flather 2005 that struck the coasts of the uk netherlands belgium and germany producing surges over 3 m and leading to a major disaster with more than 2000 casualties in the netherlands it marked the launch of the dutch national water management plans and huge investments in coastal protection in 2010 the storm xynthia hit the atlantic french coast in the bay of biscay for this event the surge itself was not exceptional but due to the co occurrence with spring tide bertin et al 2014 it resulted in extensive coastal flooding 47 casualties and monetary damage of around 1 5 billion euros ddtm 17 2011 another example is the storm xavier that took place in december 2013 it also coincided with high astronomical tides and affected extensive areas in northern europe wadey et al 2015 causing environmental damage infrastructure disruptions flooding and or damage to buildings and private property the above events have occurred during the past and present century when increasing population and development in coastal zones has amplified coastal risk bouwer 2011 visser et al 2014 global warming and corresponding sea level rise is expected to result in a further intensification of coastal hazards vitousek et al 2017 vousdoukas et al 2018b highlighting the need for disaster risk management measures overall disaster risk reduction has been shown to reduce losses and mortality from extreme floods bouwer and jonkman 2018 kreibich et al 2017 short term forecasting can be complementary to adaptation actions aimed at medium and long term flood risk reduction for example early warning systems harley et al 2011 harley et al 2016 vousdoukas et al 2012b can assist emergency response operations by providing useful information about the timing and spatial distribution of hazardous conditions this is crucial to support decisions on resource deployment and evacuation during an event cheung et al 2003 in europe there are several regional operational storm surge forecasting systems that resolve tidal and atmospheric forcing sembiring et al 2015 zampato et al 2016 several of these systems contribute to the copernicus marine environment monitoring service cmems the latter combines information from different regional domains iberia biscay ireland regional seas black sea baltic sea european north west shelf seas and mediterranean sea into one unified platform http marine copernicus eu cmems offers also a global sea level forecast service lellouche et al 2018 lellouche et al 2013 but that only considers wind forcing and omits pressure effects on the contrary the dynamic atmospheric corrections dac are produced by cls using the mog2d model from legos and distributed by aviso with support from cnes https www aviso altimetry fr and takes into account only the inverse barometer effect omitting winds apart from these regional systems and a few exceptions muis et al 2016 there is a lack of systems that cover continental and beyond scales and resolve all major physical factors contributing to extreme sea levels such systems can complement regional ones by providing homogenous information over extensive spatial domains including areas not served by national regional systems against the foregoing the present contribution reports on the implementation and validation of a pan european storm surge forecasting system eu ssf aspiring to become a future candidate for inclusion in the european flood awareness system www efas eu the manuscript is structured as follows in section 2 the model set up calibration and validation are outlined in section 3 results from the validation are presented along with the outcomes of a sensitivity analysis on the resolution of the atmospheric forcing and the effects of tide storm surge interactions section 4 provides a discussion of the results and a foresight related to model improvement and optimization of the operational setup finally section 5 summarizes the main conclusions 2 methods 2 1 model setup the schism model http ccrm vims edu schismweb was used to simulate the tide surge generation and propagation schism semi implicit cross scale hydroscience integrated system model is based on the original selfe code zhang and baptista 2008 with many enhancements and upgrades including an extension to large scale eddying regime and a seamless cross scale capability from creek to ocean zhang et al 2016 the model solves the full navier stokes equation over unstructured grids in the present study schism was configured in its 2d barotropic mode which can be considered as a reasonably accurate approximation for the given application it further increases the model efficiency hence allowing simulations at continental scales with affordable computational and storage requirements the model configuration accounts for the combined effects of wind atmospheric pressure gradients and tides schism was forced by sea level pressure and 10 m wind speed atmospheric fields from era interim as well as by a ecmwf high resolution forecast see section 2 2 the surface stress in schism is computed using a bulk formula with the drag coefficient computed according to pond and pickard 2013 tidal forcing includes the astronomic potential over the whole domain and boundary conditions along the open boundaries see fig 1 a the main tidal constituents in the area are considered mm mf o1 k1 p1 q1 m2 s2 n2 and k2 and are available from the finite element solution 2012 fes2012 carrère et al 2012 the computational domain extends from 25wo to 42eo and from 25no to 76no fig 1a the computational grid is an unstructured mesh with triangular elements and varying resolution ranging from 78 km in the western boundary of the domain to a higher resolution 10 km along the european shallow coastal areas the simulations are based on bathymetric data from the european marine observation and data network emodnet originally provided in angular coordinates at a resolution of 1 8 minute 0 0021 http www emodnet eu bathymetry the model calibration and validation was based on model simulations spanning from 1 february 2010 to 1 march 2016 a period characterized by a high marine storm activity including extreme storm surge events that caused severe impacts along the european coastline bertin et al 2014 spencer et al 2015 vousdoukas et al 2012a the validation was performed considering the whole time series as well as the upper tail of the data distribution in order to evaluate the model s skill to reproduce extreme events to ensure model stability and optimize computational times the validation period was divided in 1 year simulations including an additional month as spin up time and then the resulting water level time series were merged the model output provides water level every 3 h at 11 366 locations distributed every 10 km along the european coastline numerical simulations were run in parallel on a high performance computing facility using 32 processors 2 6 ghz subdividing the computational domain into 32 subdomains 2 2 numerical experiments a set of model runs were conducted in order to assess the model s performance as well as its sensitivity to factors like the resolution of atmospheric forcing and non linear interactions between tidal and atmospheric forcing hereinafter the storm surge η ssl refers to the anomalous sea level rise driven by wind and pressure whereas the non tidal residual η re refers to the anomalous sea level rise including as components both the atmospheric effect and the tide surge interaction the set of performed numerical experiments is listed in table 1 the experiment e0 neglects meteorological factors in order to validate the model s skill to reproduce tidal elevations only the experiment e1 considers only the atmospheric forcing from era interim 6 h temporal resolution and 0 75 0 75 spatial resolution without tidal forcing to assess performance in terms of storm surge forecasting in a fictional non tidal setup the fully forced run e2 combines tidal and atmospheric forcing era interim once the non tidal residual was subtracted from e2 results it allowed the evaluation of the effect of the interaction between the storm surge and the tidal component by comparison with the e1 results as well as to evaluate the model s performance in reproducing the non tidal residual an additional group of runs was performed with the purpose of assessing the influence of the atmospheric forcing resolution in the model s performance to that end a second higher resolution dataset based on the global ecmwf forecast was used ecmwf hres https www ecmwf int en forecasts datasets set i the dataset is available after 2010 and has a spatial resolution of 0 1 0 14 since the forecast provides atmospheric forcing parameters for a 72 h time window on a daily basis the latest forecast available for each day is considered creating a dataset which covers the whole testing period two additional runs are forced by ecmwf hres one similar to e1 e3 only atmospheric forcing and one similar to e2 e4 tidal and atmospheric effects although the original temporal resolution of ecmwf hres is 1 h here the dataset is subsampled at 6 h intervals to match the era interim dataset keeping the same time signatures to eliminate temporal resolution bias is avoided when comparing the runs forced from the two datasets in addition to the tidal performance of eu ssf we assess the performance of available global tidal models such as the tpxo7 2 ocean tide model egbert and erofeeva 2002 finite element solution 2004 fes2004 lyard et al 2006 and finite element solution 2012 fes2012 carrère et al 2012 the tidal predictive skill of eu ssf is compared with the one of the above tidal models 2 3 model validation the model validation is based on a ground truth dataset from 208 tidal gauges available from the jrc sea level database http webcritech jrc ec europa eu sealevelsdb and emodnet web site http www emodnet physics eu map from which 192 are finally used after a quality control to remove spikes and other erroneous observations fig 1a the tidal gauge stations provide satisfactory spatial representation of the european seas fig 1a with the exception of the east mediterranean and black sea where only one station in each region provides usable measurements to filter out long term sea level variations the water level time series each station was de trended by removing the one year moving average hereafter a tidal harmonic analysis was performed using the t tide package pawlowicz et al 2002 separating the astronomical tide η tide and the non tidal residual η re components note that η re not only contains the meteorological contributions but also a non linear tidal surge interaction component haigh et al 2016 and the combination of both components results in the total water level twl 1 twl η tide η re the temporal resolution of the water level measurements normally varies from few minutes to 1 h while few stations recorded data during the entire validation period fig 1a 88 4 and 57 5 of the tidal stations respectively cover more than 20 and 50 of the validation period fig 1b additionally 55 1 of the 192 tidal gauges used for validation provide data for more than 10 years and only 13 6 of the tidal gauges cover less than 5 years fig 1c the model validation was performed along the european coastline considering each tide gauge location and its corresponding nearest model grid point the model s ability to reproduce the astronomic tide is evaluated in terms of the bias ε a relative bias δ a and bias for the tidal phase ε p for each tidal constituent 2 ɛ a i a o i a p i 3 δ a i a o i a p i a p i 4 ɛ p i p o i p p i in addition the model accuracy to reproduce the tide is evaluated by calculating the vectorial difference of the main diurnal and semidiurnal constituents the root mean square deviation of the amplitude d 5 d j i a j o i c o s p j o i a j p i c o s p j p i 2 a j o i s i n p j o i a j p i s i n p j p i 2 where a is the amplitude m p is the phase degrees subscript j refers to the tidal gauge station subscript i refers to the tidal constituent subscript o is the observed data from the tide gauge and subscript p is the model s predicted result the root mean square deviation of the amplitude rms for each constituent is defined as follows tsimplis 1995 6 r m s i 1 2 n j 1 n d j i 2 where n is the number of the tide gauges considered and d j i is the vectorial difference defined for each location and each tidal constituent to evaluate the total effect of the main tidal constituents the root sum of square rss arabelos et al 2011 ferrarin et al 2013 is computed as 7 r s s i 1 n r m s i 2 the ability of the model to reproduce the storm surge non tidal residual and total water level was based on the root mean square error rmse and the corresponding relative root mean squared error rmse 8 r m s e σ k n η o k η p k 2 n 9 r m s e σ k n η o k η p k 2 n max η o 100 where n is the number of measurements in the time series at a given location η o is the water level from measurements observed non tidal residual or twl and η p is the predicted water level storm surge or non tidal residual the effect in model performance of changing the model setup was evaluated in terms of rmse difference computed as 10 δ r m s e r m s e a d v r m s e b a s e where rmseadv is the advanced configuration i e including tidal process or ecmwf hres atmospheric forcing and rmsebase is the base configuration i e omitting tidal process or era interim atmospheric forcing the effect of the tidal surge interaction and atmospheric forcing accuracy resolution was evaluated in terms of biasadv for the whole time series computed as 11 b i a s a d v 1 n η a d v η b a s e where η adv correspond to the storm surge non tidal residual or total water level achieved using the advanced configuration and η base correspond to the base configuration in the case of the extremes values the effect will be evaluated in terms of the differences in percentile p99 δ p 99 p 99 η a d v p 99 η b a s e 3 results 3 1 tidal prediction validation the present section discusses validation results related to the principal tidal constituent semi diurnal m2 s2 and diurnal o1 and k1 obtained from the e0 numerical experiment as well as of the tpxo7 2 fes 2004 and fes 2012 tidal models the main semidiurnal tidal constituent m2 is reproduced satisfactorily in the model with relative bias δ a 15 for most of the tidal gauge stations fig 2 the highest δ a is found along the mediterranean and baltic sea circa 50 but the performance in these micro tidal areas is less important and bias remains below ε a 0 06 m this is also the case for 56 of the tidal gauge stations fig a 1b while the maximum bias in m2 prediction is found at the eastern edge of the english channel 0 2 ε a 0 4 m the m2 phase is also well reproduced with ε p 15 for 74 of the tidal stations fig a1c and the worst performance observed along the baltic sea and southern north sea fig 2c the spatial pattern of the s2 constituent validation results is similar to the m2 with ε a 0 015 m and ε a 0 09 m for 44 7 and more than 15 of the tidal stations considered respectively fig 2e the phase is also satisfactorily simulated fig 2f with ε p 15 for 76 9 of the tidal gauges fig a1f however a poorer performance is observed along the baltic coast and the north sea the diurnal constituent k1 fig 2g shows the worst performance however it contributes very little to the twl in macro and meso tidal areas amplitude bias ε a 0 01 m is found for almost 55 of the tidal gauges considered fig a1h and ε a 0 03 m for 85 of the tidal gauges similarly the validation for the k1 tidal phase shows 0 ε p 15 for 44 2 of the tidal gauge stations and 15 ε p 30 for 34 6 of the stations fig a1i the model s performance is better for the o1 diurnal tidal constituent with ε a 0 01 m for 77 of the tidal stations fig 2k and fig a1 k the o1 phase error varies between 0 ε p 15 for 50 5 of the tidal stations and from 15 to 30 for 30 3 of the tidal gauge stations fig a1l the absolute error in o1 phase is larger in the irish sea west mediterranean and baltic sea fig 2l to better interpret the eu ssf tidal prediction performance we have also performed a similar validation analysis for the tidal levels provided by the global tide models tpxo7 2 fes 2004 and fes2012 the total rss for eu ssf is equal to 0 198 m table 2 lower than the values estimated for fe2004 and tpxo7 2 which have respectively rss values of 0 42 and 0 39 m however the fes2012 model outperforms eu ssf with rss 0 148 m similarly rms values for the m2 and s2 components for eu ssf are respectively 0 181 m and 0 071 m markedly higher than the ones of fes2012 0 14 m and 0 046 m 3 2 non tidal residual water level validation the non tidal residual validation is performed after subtracting the astronomical tide signal estimated by harmonic analysis from the water levels generated from the e2 experiment the model shows a good predictive skill with 0 04 m rmse 0 21 m fig 3 a table 3 more than 91 of the tidal gauges show rmse values lower than 0 125 m fig 3b and only 2 of the stations result in rmse 0 15 m in general rmse values are below 0 1 m with the exception of the north sea 0 10 m rmse 0 14 m and the east coast of the baltic sea gulfs of bothnia finland and riga 0 1 m rmse 0 15 m in areas characterized by lower non tidal residual values the rmse shows the opposite trend to rmse e g see the highest values found in the mediterranean sea and s north atlantic rmse ranges from 4 to 22 fig 3c with 70 of the tidal gauges showing values of rmse 12 5 only 6 2 of the stations show rmse 17 5 fig 3d the model shows good performance in the reproduction of non tidal residual extremes and the upper tail 99th percentile rmse is below 0 25 for 79 of tidal gauge stations fig a2b the higher rmse values are observed along the north sea west coast of bay of biscay gulf of bothnia in the baltic sea as well as the north adriatic sea 0 3 m rmse 0 4 m fig a2a the rmse for the extreme events remains below 25 for most of the tidal gauge stations 64 fig a2d the largest rmse values 30 40 are located in the mediterranean and in the s north atlantic 3 3 benefits of coupling storm surge and tide the inclusion of tidal processes in the simulations case e2 see table 1 allows to resolve the non linear interactions between meteorological and astronomic tides this clearly leads to an improvement in predictive skill compared to when tidal forces are omitted e1 the rmse reduces up to 0 033 m 14 fig 4 a the improvement in performance is more pronounced along the north sea and the english channel resulting in up to 2 reduction of the rmse fig 4b considering only the changes in the extreme events 99th percentile the differences in rmse vary within 0 086 m δrmse 0 037 m fig a3a coupling with tides improves the forecasting skill of the extreme η re at the english channel 0 02 m δrmse 0 04 m bristol channel δrmse 0 086 m south irish sea celtic sea and the nnorth atlantic region 0 01 δrmse 0 03 m similarly rmse appears to reduce by up to 4 in these areas fig a3b the opposite effect is observed along the central and eastern north sea western coast of the jutland peninsula northern irish sea and north channel where the rmse increases around 0 01 0 02 m 1 2 3 4 sensitivity to atmospheric forcing accuracy resolution the validation considering the whole time series allowed us to find that the higher resolution atmospheric forcing case e3 see table 1 allows a reduction of the η ssl rmse by 0 02 m along the norwegian and adriatic sea as well as most of the west mediterranean in comparison to the era interim e1 run in addition a rmse reduction of 0 03 m is observed in the western coast of the jutland peninsula fig 5 a the rmse is reduced up to 2 in the same areas the opposite effect is observed in the baltic sea bay of kattegat bay of biscay n north atlantic and west southwest coast of the north sea in those areas using the high resolution forcing the rmse increases by 0 01 m 0 04 m the increase in rmse is around 2 rmse 4 fig 5b a similar analysis considering only the extreme storm surges upper tail distribution above 99th percentile showed in fig a4 shows that the higher resolution forcing ecmwf hres improves the predictive skill in enclosed basins fig a4a for example rmse reduces by 0 05 m in the gulf of venice adriatic sea gulf of bothnia baltic sea and black sea the rmse is reduced by 10 in the gulf of venice and gulf of bothnia and by 15 in the black sea a smaller 5 rmse reduction is observed for the mediterranean norwegian and baltic sea nevertheless the higher resolution forcing appears to produce an increase 4 in rmse along the n north atlantic and the english channel fig a4b 4 discussion 4 1 tidal predictive skill our eu ssf satisfactorily describes tidal dynamics along european coastlines but its performance may still be poorer than that of regional models for example in the central mediterranean sea ferrarin et al 2013 reported a rmse 0 01 m for the main tidal constituents m2 s2 k1 and o1 and a rss of 0 015 m these values are lower than the 0 009 m rmse 0 026 m and rss 0 04 m reported herein tsimplis et al 1995 reported for the whole mediterranean sea a 0 008 m rmse 0 014 m and a rss 0 023 m compared to the 0 008 m rmse 0 027 m and rss 0 036 estimated by our eu ssf for the western iberian peninsula quaresma et al 2013 reported a bias between 0 006 ε a 0 04 m for the amplitude of m2 and s2 and for the phase between 0 4 ε p 7 in comparison our eu ssf shows an amplitude and phase bias of respectively 0 003 ε a 0 18 m and 0 3 ε p 37 for s north atlantic in the bay of biscay bertin et al 2012 report an amplitude bias 0 01 ε a 0 04 m and a phase bias below 11 for m2 whereas our eu ssf m2 amplitude bias is between 0 07 ε a 0 35 m and the phase bias is between 1 4 ε p 13 idier et al 2017 report an amplitude relative bias for the north sea and n north atlantic for constituents m2 s2 n2 k2 and m4 below 5 in most of the tidal stations values which are lower than the presently reported mean relative amplitude bias 4 δ a 14 calculated for m2 and s2 however our eu ssf outperforms most global tidal models table 2 fig a5 with the exception of fes2012 the latter does not come as a surprise since fes2012 s skill is enhanced by data assimilation of long term altimetry data topex poseidon jason 1 jason 2 ers 1 ers 2 and envisat carrère et al 2012 as in previous studies the accuracy in tidal solution is reduced in shallow water areas with complex bathymetry and geometry zijl et al 2013 tidal dynamics are strongly affected by the bathymetry in those areas and corresponding transformation processes are not fully resolved for various reasons these include the limit in the amount of detail in the bathymetric data the resolution of the computational grid 10 km along the coast and the simplifications imposed by a 2d barotropic model these aspects are particularly important in areas with complex tidal dynamics such as the german bight and or exchange areas between two ocean basins characterized by different seawater properties e g the gibraltar strait or the baltic sea 4 2 non tidal residual and storm surge water level prediction validation results demonstrate that the eu ssf satisfactorily reproduces the non tidal residual water levels the storm surge calculated from e1 improves substantially the model presented by vousdoukas et al 2016a as i the use of an unstructured grid allows a higher grid resolution nearshore without increasing the computational cost it takes 0 95 cpu hours per month simulated running in parallel using 32 processors with 2 cpus of 2 6 ghz ii eu ssf uses a higher resolution bathymetry emodnet compared to the gebco used previously as a consequence the eu ssf results have a lower rmse in all the oceanographic basins compared to vousdoukas et al 2016a with the exception of the norwegian sea where rmse increases by 0 03 m fig 6 a the average rmse is reduced by 0 03 m ranging from 0 01 m in the bay of biscay to 0 1 m in the black sea similarly the mean rmse reduces by 5 ranging from 3 in the s north atlantic to 14 in the black sea with the exception of the norwegian sea where the rmse increases by 2 fig 6b direct comparison with validation results presented in previous studies is not straightforward due to inconsistencies in the validation periods and the ground truth sea level data even though most previous studies cover smaller domains which allows modelling at higher resolution the performance is found to be comparable for example the non tidal residual rmse along the dutch coast presently ranges from 0 12 to 0 14 m while sembiring et al 2015 report rmse values with annual variation within 0 1 m and 0 2 m o neil et al 2016 report average rmse around 0 1 m along the scottish and english coast similar to 0 09 m presented in the french atlantic and english channel coast muller et al 2014 report rmse values around 0 08 m while present values are 0 10 m for the non tidal residual at the bay of biscay during the xynthia storm bertin et al 2012 report rmse values ranging from 0 12 to 0 17 m compared to 0 11 rmse 0 35 m presently reported for the upper tail values 99th percentile however the model in bertin et al 2012 uses higher spatial and temporal resolution than era interim and is specifically calibrated for the area affected by the xynthia storm moreover the presently estimated rmse 0 1 m for the baltic sea is similar to the one reported for a finer resolution model 5 5 km resolution kowalewski and kowalewska kalkowska 2017 in southern europe and central west mediterranean cid et al 2014 report an average rmse of 0 08 m slightly higher than the rmse of 0 06 m in our eu ssf table 4 shows a comparison of the eu ssf non tidal residual from e2 predictive skill with respect to the global 1 12 resolution and north west shelf sea surface height analysis provided by cmems 1 15 latitudinal and 1 12 longitudinal resolution the global model does not account for tidal and barometric effects therefore the dac correction has been linearly added to the original dataset before the comparison with the non tidal residual extracted from the tidal gauge database employed to validate eu ssf in the case of the north west shelf nws which accounts for the tide the non tidal residual is extracted before the comparison with the ground truth dataset the eu ssf shows a regional average rmse of 0 08 m compared to the 0 11 m calculated for the cmems global table 4 significant improvement of the predictive skill is identified in all the regions with the exception of the norwegian sea additionally a wide range of rmse was reported for the cmems global as indicated by the larger standard deviation of the rmse the eu ssf only shows a slightly poorer performance in comparison with the higher resolution model cmems nws regional average rmse 0 08 m and 0 07 m respectively cmems nws performs substantially better than eu ssf along the north sea and the norwegian sea rmse reduction 50 this is not surprising since the finer resolution of the cmems nws allows to capture the tidal dynamics and surge propagation in the north sea and german bight part of the superior performance of cmems nws could be attributed to the data assimilation which is included in the system s workflow 4 3 importance of resolving tide surge interactions considering tidal forces is important for storm surge forecasting as they allow resolving i the interaction between astronomic and meteorological flows and ii the tidal water depth modulations which drive changes in bottom friction and on the overall depth dependent circulation patterns arns et al 2015 thus coupled tidal storm surge models usually have higher skill brown et al 2010 zijl et al 2013 especially along meso and macro tidal areas that are strongly affected by storm surge phenomena north sea and n north atlantic fig 4 for that reason on the coast of the jutland peninsula and in the southern coast of the north sea the non tidal residual is lower than the storm surge estimated without resolving tide surge interactions see negative biasadv fig 7 a b an inverse pattern is observed in the western english channel as indicated by the scarcely positive biasadv larger differences exist in the case of the extreme events upper tail event above the 99th percentile the non tidal residual is lower than the storm surge in the western coast of the jutland peninsula and along the southern coast of the north sea while the opposite effect is observed along the west coast of ireland the celtic and irish seas and the bristol channel fig a6a such findings are in agreement with previous studies horsburgh and wilson 2007 the spatial pattern of the observed storm surge amplification reduction is related to the shape of the tidal wave and the depth dependence of the surge production and propagation processes as the water level gradient is proportional to the wind stress divided by the water depth pugh 1987 then the storm surge is higher in shallow depths storm surges and tides can be interpreted as shallow water waves with propagation velocity g h 1 2 where h is the water depth and g is the gravitational acceleration based on the above the depth decrease results in a reduction of the storm surge propagation velocity and increase of the amplitude idier et al 2017 as a result asymmetries in the tidal distribution can enhance or reduce non tidal residuals depending on whether they result in higher or lower frequency of water levels below msl for example in the case of west terschelling north sea the tidal distribution is bimodal and negative skewed favouring positive tides fig 8 a while the distribution of the non tidal residual water level is bimodal with the two peaks correlated to low and high tidal levels respectively fig 8b the result is that while the mean non tidal residual is higher during negative tides the mean η re for the extremes above 99th is higher during positive tides in both cases statistical significance of the differences of the means is tested using two sample t tests for p value 0 05 therefore omitting tides results in overestimation of the non tidal residual uncoupled vs coupled run see also fig a6a the contrary is expected to happen storm surge under prediction in areas where tides follow an asymmetrical bimodal distribution with water levels below msl being more frequent like the station of hinkley point bristol channel fig 8a the result is a unimodal negatively skewed joint distribution of η re and tidal levels which shows that extremes occur mostly during negative tides fig 8c this fact has been confirmed by the two sample t test that reveals a statistically significant higher mean p value 0 05 for the extreme surges above 99th occurred during negative tides at hinkley point the underestimation of the non tidal residual when tides are omitted is shown is shown in the uncoupled vs coupled run comparison fig a6a we have also estimated the conditional probability of η re exceeding the 99th percentile during negative and positive tides and we see that in both sites it is higher during low tide than during high tide 1 02 vs 0 88 for west tershelling and 1 22 vs 0 74 for hinkley point the above confirms that extreme η re values are favored by negative tides large scale models have a tendency to under estimate extreme storm surges calafat et al 2014 the shortcoming above can paradoxically result in an improved model performance in areas where omitting tide surge interactions results in an over prediction of storm surges this is the case of the bristol channel when only extreme events are considered fig a3 on the other hand in areas like the western coast of the jutland peninsula and the southern coast of the north sea fig a6b the storm surges are higher than the non tidal residual resulting in further under estimation even though the setup is improved of course all the above are not model setup recommendations but insights on potential interactions between epistemic error factors which sometimes can cancel each other 4 4 importance of atmospheric forcing accuracy resolution if the whole time series is considered the atmospheric resolution results in minor changes in storm surge bias adv 0 005 m fig 7c although the relative importance becomes higher when the tidal effects are included the larger values of bias adv up to 0 02 m in jutland peninsula and the southern coast of the north sea observed in the case of twl fig 7d reveal the relevance of the atmospheric resolution for the computation of tide surge interaction conversely to what was expected using the high resolution atmospheric forcing leads to lower predictive skill in terms of storm surge levels along most of the european atlantic ocean coast fig 5 this can be attributed to the fact that the ecmwf hres forcing is a forecast product in comparison to the more accurate era interim dataset that is post processed through data assimilation in addition using the full temporal resolution of ecmw hr 1 h instead of 6 h used for consistency for comparison with era interim could improve the final performance of the forecast system still the achieved results have allowed the identification of critical areas in which atmospheric forcing resolution plays a key role in the accuracy of the storm surge prediction i e semi enclosed basins like the black baltic adriatic and mediterranean sea fig 5 the benefit of increasing the atmospheric forcing resolution for the predictive skill of the extreme storm surges is evident see rmse and rmse reduction in fig a4 this is due to the tendency of large domain models to underestimate upper tail events muis et al 2016 vousdoukas et al 2016a particularly the ones characterized by short duration and high energy calafat et al 2014 conte and lionello 2013 as a result of the above an increased atmospheric resolution allows to ameliorate the underestimation of storm surge and twl fig a6c and d the greater model sensitivity to the atmospheric forcing resolution in semi enclosed basins is related to the smaller spatial scales and shorter life cycles of low pressure systems which demand higher resolution and accuracy in the atmospheric forcing this is the case for the mediterranean where pressure lows are less intense and show smaller spatial and temporal scales trigo et al 1999 and particularly in the adriatic sea where storm surge events are of higher frequency and shorter duration cid et al 2016 in a similar fashion higher frequency short duration events have been also reported in the gulf of bothnia finland and riga in the baltic sea wolski et al 2014 in addition the aforementioned areas along with the azov sea are all characterized by shallow waters here wind is the main driver of surge production since the water level gradient is proportional to the wind stress divided by the water depth pugh 1987 consequently the accuracy of wind representation becomes more relevant 4 5 towards an operational pan european forecast the following paragraphs discuss potential extensions of the present work towards an operational pan european storm surge forecasting system the appropriate forcing for such application is the high resolution ecmwf forecast while given the scope the critical prediction variable is the combined twl as a result we assess the model predictive skill considering the following alternatives f1 using the output from the coupled setup f2 combining linearly the tidal forecast from fes2012 with the storm surge prediction from the uncoupled setup i e without tidal flows f3 combining linearly the tidal forecast from fes2012 with the non tidal residual prediction from the coupled setup option f3 results in the best performance rmse 0 21 m fig 9 c reducing the average rmse by 0 06 m compared to option f1 rmse 0 27 m fig 9a and by 0 03 m with respect to option f2 rmse 0 24 m fig 9b the improved performance is mainly observed in meso and macro tidal areas a similar spatial pattern although with larger rmse reduction 0 04 m from f1 to f2 and 0 07 m from f2 to f3 is observed for the extreme twls 99th percentile see fig a7 the overall performance of option f3 is considered acceptable for the considered domain although it is poorer in comparison to the validation results reported by regional models see for example the mean rmse 0 35 m found along the north atlantic north sea skagerrak and kattegat with respect to rmse 0 10 m reported by zijl 2013 however in most cases rmse for twl remains below 0 25 m and the twl prediction error is mainly related to poor skill in reproducing the tidal levels in meso and macro tidal areas fig 2 the above solution combines the benefits from i resolving the non linear interactions between meteorological and astronomic tides in the model in terms of non tidal residual forecasting and ii having the most accurate tidal forecast benefiting from the data assimilation applied in the fes2012 model 4 6 foresight the spatial extent of the model domain imposes some inevitable limitations in the applied setup most of these can be addressed with further developments in computational power and code capabilities potential model upgrades include increasing the resolution of the computational mesh the atmospheric forcing and the bathymetry along shallow near shore areas with complex topography e g bays ports and estuaries in these areas the more dynamic circulation processes and complex bathymetry are not fully resolved by the model the same applies to semi enclosed basins e g baltic adriatic and narrow straits with complex circulation e g gibraltar english channel north channel in the irish sea and kattegat in denmark fig 2 increasing the resolution would improve model performance in all aspects and in particular in terms of the representation of the tidal dynamics and the non linear interactions with storm surge the tidal predictive skill in the twl forecast could be improved after testing and incorporating output from the more recently developed fes2014 carrere et al 2016 a step even further would be to include waves which contribute to extreme sea levels and thus coastal hazard through wave setup vitousek et al 2017 vousdoukas et al 2016b and runup serafin and ruggiero 2014 vousdoukas 2014 in addition the inclusion of waves can enhance the model s skill in storm surge estimation ferrarin et al 2013 since i wave current interaction is important in certain locations roland et al 2012 ii waves increase the roughness of the sea surface which controls wind drag and energy transfer from the atmosphere to the ocean resulting in circulation and wind set up bertin et al 2015 finally the spatial and temporal coverage of the tidal gauge database is poorer along the east mediterranean and black sea acting as a bottleneck in model validation and calibration the use of a complementary dataset from altimetry satellite data could help to assess the model performance in those areas 5 conclusions this contribution presents the development and validation of an unstructured hydrodynamic storm surge and tidal model for europe eu ssf the tidal surge model accounts for atmospheric pressure wind and astronomical tide the model has been validated against sea level measurements from 192 tidal gauge stations in terms of the skill to predict tidal and meteorological water levels as well as their combination overall eu ssf shows satisfactory performance regarding tidal prediction the total rss is equal to 0 197 m lower than the values estimated for fe2004 and outperformed only by fes2012 which results in rss 0 05 m also eu ssf reproduces satisfactorily the principal tidal constituents m2 s2 o1 and k1 the main semidiurnal tidal constituent m2 is reproduced satisfactorily with average amplitude and phase bias found equal to 0 07 m and 14 respectively non tidal residual water level validation results show good model predictive skill with rmse 0 08 m and rmse 11 respectively including tidal effects results in an improvement in non tidal residual water level prediction reducing the rmse by up to 0 033 m the areas benefiting more from the coupling are the north sea and the english channel resulting in up to 2 reduction of the rmse the improvement is even more pronounced for the prediction of extreme non tidal residual water levels 99th percentile for which the differences in rmse ranges within 0 086 m δrmse 0 037 m increasing the resolution of atmospheric forcing also improves the predictive skill especially in terms of the extremes in shallow areas where wind is the main driver for surge production like the azov sea as well as the gulf of venice 0 06 m δrmse 0 04 m bothnia 0 06 m δrmse 0 01 m the area including the gulfs of finland and riga 0 01 m δrmse 0 m the pan european storm surge model presented in this work and the findings related to the sources of uncertainty can be useful for the design of large scale storm surge forecasting systems for the present application we find that the most accurate setup is the one combining tidal levels from the fes2012 model and the non tidal residual from the eu ssf setup which couples meteorological and astronomic tides such a system can be essential for disaster risk reduction supporting the coordination of real time emergency response against surge coastal flooding future work will include several developments which are expected to increase the eu ssf performance i coupling the current model with a wave generation propagation one ii increasing model resolution in specific areas in order to properly reproduce the tidal dynamics and iii including data assimilation in the forecasting system acknowledgments the research leading to these results has received funding from the euh2020 program under eu h2020 grant agreement no 700099 anywhere enhancing emergency management and response to extreme weather and climate events appendix 
24066,the parameterization of sub grid scale processes is one of the key challenges towards improved numerical simulations of the atmospheric and oceanic circulation numerical weather prediction models as well as climate models would benefit from more sophisticated turbulence closures that allow for less spurious dissipation at the grid scale and consequently higher and more realistic levels of eddy kinetic energy eke recent studies propose to use a hyperviscous closure in combination with an additional deterministic forcing term as a negative viscosity to represent backscatter of energy from unresolved scales the sub grid eke is introduced as an additional prognostic variable that is fed by dissipation at the grid scale and enables recycling of eke via the backscatter term at larger scales this parameterization was previously shown to work well in zonally re entrant channel configurations here a generalization in the form of a rossby number dependent scaling for the strength of the backscatter is introduced to represent the emergence of a forward energy cascade in unbalanced flows near the boundaries we apply the parameterization to a shallow water model of a double gyre basin and provide evidence for its general applicability in terms of mean state and variability a low resolution model is considerably improved towards a high resolution control run at low additional computational cost keywords backscatter energy budget negative viscosity eddy parameterization eddy permitting mesoscale double gyre shallow water model 1 introduction mesoscale eddies are a key turbulent feature of the global oceans chelton et al 2011 understanding their complex interplay with the large scale circulation marshall 1984 wunsch and ferrari 2004 is a major challenge in climate research inevitably important to assess and predict climate change randall et al 2007 flato et al 2013 vallis 2016 eddies are capable of transferring energy across scales and are therefore a crucial element in the ocean s energy cycle rhines 1979 molemaker et al 2005 ferrari and wunsch 2009 aiki et al 2016 finding a closure for eddies in ocean general circulation models is an active field of research eden 2016 von storch et al 2012 eden and greatbatch 2008 in addition to the energy cycle eddies are also important for tracer transport and dominate the mixing and stirring of physical chemical and biological water mass properties gent et al 1995 abernathey et al 2010 liu et al 2012 in the near future state of the art climate models will approach spatial resolutions at which the largest eddies can be resolved explicitly eyring et al 2016 despite the increasing performance of supercomputers the most advanced earth system models are not expected to fully resolve the mesoscale let alone the submesoscale mcwilliams 2016 within the next decades western boundary currents e g the gulf stream and kuroshio and their extension regions are an essential part in the wind driven horizontal gyre circulation imawaki et al 2013 maximenko et al 2013 these regions show an enhanced eddy activity on scales of several hundreds of kilometres down to the submesoscale ferrari and wunsch 2010 the need for more sophisticated turbulence closures realistically parameterizing the effect of meso and submesoscale eddies on the resolved flow is hence clear traditional approaches to eddy parameterization employ down gradient fluxes gent and mcwilliams 1990 ensuring numerical stability griffies 2004 although evidence exists that eddies also affect the mean circulation via up gradient momentum fluxes greatbatch et al 2010 wang et al 2017 some approaches introduce stochasticity to account for sub grid scale variability and parameterizations are formulated as a function of the resolved flow and random numbers aiming to increase the number of variables that determine the future evolution of the flow field palmer 2001 berloff 2005 jansen and held 2014 andrejczuk et al 2016 zanna et al 2017 physically motivated is the implementation of eddy viscosity as a diffusive turbulence closure to mimic the general tendency of the eddy field to mix and hence smooth gradients smagorinsky 1963 leith 1967 redi 1982 griffies and hallberg 2000 other approaches aim to parameterize the advective effects of eddies in baroclinic instability and mixed layer stratification gent and mcwilliams 1990 fox kemper and ferrari 2008 fox kemper et al 2011 brüggemann and eden 2014 but do not include considerations of the kinetic energy cycle generally speaking there are two main requirements that an eddy closure should satisfy in ocean circulation models i the physical parameterization of instabilities their stirring and mixing and subsequent dissipation and ii numerical stability through dissipation of enstrophy at the grid scale the viscosity in general circulation models is usually tuned to satisfy ii whereby viscosity coefficients are several orders of magnitude larger than would result from molecular considerations griffies and hallberg 2000 this leads to a significant dissipation of energy in most approaches we therefore believe successful parameterizations should aim to close the energy cycle by reducing the effective viscosity that otherwise leads to a spurious energy dissipation at the grid scale eden 2016 jansen and held 2014 arbic et al 2007 eddy parameterizations that allow for upscale and downscale fluxes of energy are under investigation e g berloff 2005 nadiga 2008 eden 2010 marshall et al 2012 porta mana and zanna 2014 mak et al 2016 zanna et al 2017 a recently proposed approach jansen and held 2014 jansen et al 2015b involves the combination of a hyperviscous closure in order to remove energy and enstrophy from the grid scale with a prognostic variable for the sub grid eddy kinetic energy eke the dissipated eke is conserved and progressively re injected into the resolved flow at larger scales via a deterministic term that is formulated as negative laplacian viscosity the effectively reduced dissipation allows for higher levels of eke thus hopefully improving the mean state and large scale variability the approach was shown to be successful in an idealised ocean model in a channel configuration jansen et al 2015b here we apply and extend the parameterization to a shallow water model driven by double gyre wind forcing with an idealised basin geometry and no slip boundary conditions and provide evidence for its general applicability this study is structured as follows section 2 briefly presents the shallow water model used throughout this study and its energetics the formulation of sub grid scale eke and the resulting energy budget based backscatter parameterization is introduced subsequently in section 3 1 we discuss the model bias of the low resolution control run without parameterization with respect to the high resolution truth as reference the impact of the energy budget based backscatter parameterization on the low resolution model is analysed in section 3 2 and discussed in section 4 finally we summarise the results in section 5 2 methods 2 1 the shallow water model the shallow water model gill 1982 vallis 2006 of the prognostic variables velocity u u v and sea surface elevation η that is used in this study is 1a u t u u f z u g η f b d ξ 1b η t u h 0 we use a similar barotropic gravity g 10 ms 1 density ρ 10 3 kgm 3 double gyre basin as in cooper and zanna 2015 to resemble a highly idealised north atlantic we use a square domain of size l 2 3840 km 3840 km with cartesian coordinates x y centred at 30 n and a constant undisturbed ocean depth of h 500 m the layer thickness is h η h with the beta plane approximation the coriolis parameter increases linearly from f 3 5 10 5 s 1 at the southern boundary of the domain to f 1 1 10 4 s 1 at the northern boundary z is a unit vector pointing in the upwards vertical direction boundary conditions are no slip as free slip conditions were found to lead to a highly unrealistic representation of the western boundary current steady and solely zonal double gyre wind forcing f f x 0 2 f x τ ρ h τ f 0 cos 2 π y l 1 π 2 sin 2 π y l 1 π with amplitude f 0 0 12 pa is used fig 1 d model simulations start from rest u 0 and the sea surface elevation is undisturbed η 0 in the initial conditions bottom friction b is represented as a quadratic drag b c d h u u with dimensionless drag coefficient c d 10 5 which reduces energy primarily on large scales by approximately 30 compared to simulations without bottom friction the drag is two orders of magnitude weaker than proposed by arbic and scott 2008 as the flow speed at the bottom of the ocean is much smaller than the barotropic flow speed simulated by the model in practice a weak drag allows to maintain vigorous turbulence lateral mixing of momentum d is represented as a biharmonic version of the diffusion operator formulated by shchepetkin and o brien 1996 3 d ν b h 1 h s h 1 h s s u v u x v y v x u y v x u y u x v y with a constant viscosity coefficient νb that depends on the grid spacing δx as ν b 540 m 2 s 1 δ x 3 30 km the resulting munk boundary layer gill 1982 is resolved with at least one grid cell for δx 30 km the symmetric stress tensor s is once evaluated with u v and once with h 1 h s u v for biharmonic diffusion we call the biharmonic stress tensor s s h 1 h s u v the term ξ represents backscatter from unresolved scales and will be defined later for the unparameterized control runs we set ξ 0 the advection of momentum is split into a vorticity part and a gradient of kinetic energy and we use the energy and enstrophy conserving scheme proposed by arakawa and lamb 1981 to discretise the former similar to the arguments of jansen et al 2015b we favour this scheme as a sophisticated energy and enstrophy budget is central to the study without backscatter the energy budget of the shallow water equations is 4 t 1 2 ρ h u 2 1 2 g ρ η 2 u τ ρ c d u 3 ρ ν b h u s where the first term on the left hand side represents kinetic energy ke and the second potential energy pe the brackets denote a horizontal domain wide integral these terms are further reynolds decomposed into mean and eddy contributions to kinetic and potential energy mke eke mpe epe respectively 5 mke 1 2 ρ h u 2 v 2 eke 1 2 ρ h u 2 v 2 mpe 1 2 g ρ η 2 epe 1 2 g ρ η 2 the sea surface elevation is decomposed into a time mean and anomalies as η η η velocities are time averaged with thickness weighting u h u h and similarly for v aiki et al 2016 the respective anomaly is u u u in eq 4 the term uτ represents power input due to wind forcing the second term on the right hand side denotes dissipation due to bottom friction and the third term on the right hand side represents ke dissipation due to the biharmonic viscosity although harmonic diffusion is always down gradient biharmonic diffusion operators are not sign definite and can also lead to power input griffies 2004 but are mostly an energy sink as will be discussed later 2 2 formulation of the energy budget based backscatter parameterization following the ideas of eden and greatbatch 2008 for a mesoscale eddy closure which are further developed in jansen and held 2014 and jansen et al 2015a we seek to find an energy equation for the unresolved scales applied to the shallow water equations similar to jansen et al 2015b we complement the shallow water equations with the following prognostic equation for the vertically integrated sub grid eke e 6 e t e diss e back ν e 2 e the energy dissipation from the resolved flow due to biharmonic diffusion is represented with e diss adding this term to the prognostic equation of sub grid eke is therefore a transfer of energy from the resolved to the unresolved flow the term e back represents the tendency associated with the backscatter hence the energy transfer from the sub grid eke budget back onto the resolved flow which is realised with negative laplacian viscosity from the perspective of the sub grid eke the first term on the right hand side acts as a forcing the second is a damping term the third is a diffusion term we set a constant diffusivity coefficient ν e 540 m 2 s 1 and e 0 serves as boundary condition as in jansen et al 2015b we neglect any advection of sub grid eke with the mean flow due to a lack of an adequate theory that represents the combined effect of advection and wave propagation omitting the constant density ρ the eke transfer to the unresolved flow associated with biharmonic dissipation follows from eq 4 7 e diss c diss ν b h u s this term is negative where the biharmonic diffusion removes energy from the resolved flow in contrast to jansen et al 2015b we introduce a spatially and temporally varying scaling for c diss which obeys 0 c diss 1 to allow only a fraction of the dissipated eke to enter the sub grid eke budget this is done for the following reasons i in the real ocean the direction of energy cascades upscale or downscale depends on the local geostrophic balance and baroclinicity scott and wang 2005 arbic et al 2007 capet et al 2008 ferrari and wunsch 2009 molemaker et al 2010 brüggemann and eden 2015 a varying c diss allows for an eke transfer to the sub grid eke budget that is conditioned on properties of the locally resolved flow ii having c diss 1 yields an energy sink for the resolved flow as the fraction 1 c diss is not subject to the recycling process of the backscatter parameterization this is desired for reasons of numerical stability choosing c diss 1 which corresponds to the original choice in jansen et al 2015b may lead to an effective dissipation that is too weak especially when other routes to dissipation are negligible the loss of energy via forward cascades arising in unbalanced flows is represented using 8 c diss 1 r o r diss 1 with the rossby number r o d f estimated locally via the deformation rate d u x v y 2 u y v x 2 eq 8 obeys the condition 0 c diss 1 for a positive non dimensional constant r diss which controls the backscatter strength and remains subject to tuning having a deformation rate based scaling of dissipation via c diss means that regions of strong shear especially boundary currents that are subject to no slip boundary conditions experience a stronger dissipation than elsewhere in agreement with zhai et al 2010 this avoids re injecting locally an excess amount of energy via the backscatter term where it may lead to spurious oscillations at the grid scale which could in turn cause numerical instabilities physically speaking we want to overcome the spurious energy dissipation at the grid scale for balanced flows ro 1 but retain the dissipative character for unbalanced flows with large rossby number rhines 1979 zhai et al 2010 molemaker et al 2010 nadiga 2014 this is motivated by the fact that geostrophic turbulence at small rossby numbers tends to undergo an upscale cascade of energy scott and wang 2005 whereas large rossby numbers are indicative of a downscale cascade where energy should indeed be dissipated brüggemann and eden 2015 molemaker et al 2010 ferrari and wunsch 2009 in that sense we interpret r diss as a cut off rossby number beyond which loss of balance can lead to a strong forward energy cascade fig 2 b the backscatter forcing term in the shallow water equations is formulated similar to the biharmonic viscosity but in the corresponding harmonic form with a negative viscosity coefficient to allow for an upscale transfer of energy 9 ξ h 1 ν back h s ν back c back δ x max 2 e h 0 using a shallow water model we consider the vertically integrated sub grid eke with units m3s 2 which alters the scaling for ν back slightly through dividing by h in contrast to the original formulation in jansen et al 2015b so that ν back retains its physical units as m2s 1 c back is an o 1 non dimensional constant which we set as originally proposed to be 0 4 and do not perform sensitivity experiments as the dependence on this parameter was previously shown to be weak eq 6 can predict negative values of e hence using the maximum guarantees no backscatter in this case similar to the derivation that led to eq 7 the backscatter term decreases the sub grid eke as 10 e back ν back h u s and transfers that energy back to the resolved flow via negative viscosity a list of all model runs used in this study is given in table 1 3 results 3 1 comparing low and high resolution control runs looking at snapshots of relative vorticity provides insight into the dynamics simulated at different resolution fig 3 a and c at high resolution eddies of different sizes are apparent in most of the western part of the domain as well as in the proximity of the southern and northern boundaries at low resolution larger eddies are simulated where the boundary current leaves the western boundary but they do not propagate as far into the domain also the proximity of the northern and the southern boundary are rather eddy free the circulation dynamics are mostly dominated by westward propagating rossby waves in the eastern part of the domain and eddy eddy interactions in the west greatbatch and nadiga 2000 marshall 1984 the double gyre circulation is not obvious from snapshots but the climatological mean velocities fig 1a and c provide evidence for its existence at low and high resolution a strong boundary current reaching speeds of about 1 ms 1 is simulated the southern northern gyre is referred to as sub tropical sub polar gyre the low resolution model shows weak additional gyres in the north east and south east corner which are more extensive and carry more transport at high resolution these counter rotating gyres share similarities with those described by greatbatch and nadiga 2000 as potential vorticity gradients are flattened towards the boundary but in a much weaker sense comparing the energy levels between the high and low resolution model we conclude that the low resolution model lacks kinetic energy in the spatial and climatological mean by a factor of 2 2 5 fig 4 this is mainly due to missing eke at low resolution the reservoir of eke in the central western part of the domain which is a factor of 2 larger at high resolution dominates the energy budget fig 5 the mke is only large in the western boundary current and less dependent on resolution this supports the notion that only the boundary current of the basin wide circulation is a persistent strong current whereas the instantaneous flow in other parts of the domain is dominated by eddies potential energy is one order of magnitude lower than kinetic energy but similar conclusions hold concerning resolution dependence fig 5 as kinetic and potential energy are directly related in quasi geostrophic flow vallis 2006 although the biharmonic viscosity is known to remove energy at the grid scale griffies and hallberg 2000 jansen and held 2014 jansen et al 2015b it affects all spatial scales as seen in the eke spectrum fig 6 most eke is concentrated on spatial scales near the rossby deformation radius with a power law decrease close to k 3 with k being the horizontal wavenumber at smaller scales pointing to a clearly developed turbulence cascade over a wide range of scales the eke is reduced at low resolution by approximately the same factor across length scales of 200 km 2000 km compared to high resolution in order to understand the differences in eddy energy that come with different resolution the sources and sinks to the energy budget are analysed wind forcing is found to be locally either an energy source or an energy sink which depends on the direction of the zonal flow compared to the direction of the wind forcing figs 7 a and g but less so on the resolution in a spatially integrated sense wind forcing is the only energy source to the shallow water system in the physical settings of this study and approximately independent of the resolution bottom friction removes energy primarily from the western boundary current and its extension where flow speeds are fastest figs 7b and h the pattern therefore resembles that of mke figs 5a and i the power due to the viscosity term reveals an energy sink in the eddy dominated central western part of the domain which is strong at low resolution but much weaker at high resolution figs 7c and i the viscosity in connection with no slip boundary conditions also removes a substantial part of the energy from the boundary due to a not sign definite biharmonic viscosity operator some of the energy that is removed directly at the boundary is partly re injected a few grid cells further inward at high resolution 64 of dissipation is through bottom friction and only 36 due to viscosity this ratio is clearly different at low resolution where viscosity is responsible for 76 of dissipation distributions of rossby numbers reveal that the low resolution model is not able to reproduce the turbulent nature of the simulated flow at high resolution as rossby numbers are in general lower by a factor of 2 fig 2a based on this and the other diagnostics shown figs 1 4 5 6 7 we conclude that a low resolution model differs statistically from its high resolution version that is taken as reference for lower resolution it is necessary to increase the viscosity coefficient in the model table 1 to prevent numerical instabilities this pushes the dissipative scales into the eddy scales leading to a depression of eddy activity nadiga and straub 2010 the unrealistically high viscosity therefore affects the physical regime of the flow measured here in terms of the rossby number decreased eddy kinetic and potential energy follow affecting the mean circulation and the variability of the flow 3 2 energy budget based backscatter the spurious viscous energy dissipation in the low resolution model can be counteracted using the backscatter approach in the original formulation by jansen et al 2015b all dissipated eke is transferred to the sub grid eke budget i e c diss 1 in eq 7 the case of c diss 1 is not going to be discussed here as significant spurious energy tendencies occur due to excessive numerical noise at the boundaries instead our strong backscatter simulation which closely resembles this limit uses a dissipation weakly dependent on the rossby number with r diss 64 see eq 8 having no slip boundary conditions a large amount of energy is dissipated via viscosity due to strong shear flows at the boundary figs 7c and i especially at low resolution consequently most sub grid eke is concentrated in the western boundary region in the climatological mean fig 8 c additionally the central western interior shows increased sub grid eke levels as following from a pronounced eke dissipation via viscosity in the highly turbulent region between the sub tropical and sub polar gyre fig 7c the explicit diffusion of sub grid eke in its prognostic equation has a negligible effect as the time scale for the grid scale diffusion is on the order of 20 days for ν e 540 m 2 s 1 whereas the backscatter time scale defined as the residence time of sub grid eke is on the order of hours to a day the negligible role of sub grid diffusion is also supported by an experiment with an increased sub grid eke diffusion ν e 5400 m 2 s 1 which reproduces virtually the same results solely negative values of sub grid eke are absent in the climatological mean fig 8 due to the increased diffusion but with a negligible impact on the resolved flow the source of energy to the resolved flow via the backscatter parameterization increases with the local level of sub grid eke eq 9 it follows therefore that the backscatter parameterization leads to a particularly strong forcing near the boundaries in the strong backscatter case the eke spectrum shows a strong energy increase at the grid scale indicative of numerical noise fig 6 snapshots especially of relative vorticity reveal that these numerical oscillations occur in the vicinity of boundary currents due to weak dissipation not shown furthermore in the strong backscatter case energy levels exceed those of the high resolution run on all scales fig 4 and 6 and the histogram of rossby numbers fig 2a reveals that high rossby number flow is too prevalent whereas low rossby number flow is too rare compared to the high resolution run hence it would be desirable to decrease the strength of the backscatter parameterization especially near the western boundary the only considered parameter to tune the flow regime dependent backscatter strength is the positive scalar r diss we find for r diss 1 the effect of the backscatter to be negligible such that the low resolution run with backscatter converges towards its unparameterized control run a moderate backscatter parameterization r diss 8 is tuned so as to match the kinetic energy level of the high resolution run fig 4 remarkably this also coincides with a corrected eke spectrum fig 6 the climatological mean of eke fig 5 in the moderate backscatter case is virtually identical to its reference at high resolution also epe is considerably improved and relative contributions of the different energy reservoirs to the total energy are in good agreement with those of the high resolution run fig 5 the energy cycle is corrected as bottom friction accounts for most dissipation fig 7e combining the energy sources and sinks of the biharmonic viscosity and the backscatter term reveals the net effect of the sub grid parameterization fig 7f which is in overall agreement with viscous dissipation at high resolution fig 7i notice that the patterns in figs 7f and i are not expected to be identical as the two represent energy exchange between the resolved and sub grid flow at different cut off scales importantly however the total sub grid energy dissipation rate which represents the magnitude of the forward energy cascade is similar in the two simulations increased eke levels coincide with a higher eddy activity especially in regions where eddies are absent without backscatter parameterization fig 3 this has a positive effect on the climatological mean circulation as the eddy driven circulations along the northern and southern boundaries are in much better agreement with those simulated at high resolution fig 1 furthermore a moderate strength backscatter parameterization yields rossby numbers distributions that closely resemble those simulated at high resolution fig 2a 4 discussion while the original jansen et al 2015b parameterization is shown to lead to an excess of eke at the grid scale in the vicinity of strong boundary currents with no slip boundary conditions the generalisation presented in this study overcomes this limitation by introducing a rossby number based dissipation scaling that yields an energy sink for geostrophically unbalanced flow molemaker et al 2010 ferrari and wunsch 2009 rhines 1979 we are thus able to eliminate the numerical distortions at the western boundary that would otherwise limit the practicality of the backscatter parameterization the eddy mean flow interaction in a low resolution model is shown to be enhanced enabling the model to simulate an improved climatological mean state that presumably results from increased levels of eke and epe due to a more sophisticated simulation of the energy cycle we want to emphasise that the tuning of the backscatter strength is solely motivated by matching reference kinetic energy levels remarkably main aspects of the mean circulation are improved without tuning towards an optimised mean state for the sake of simplicity computational power and given the importance of horizontal scales we have focussed here on the two dimensional shallow water equations which we find adequate to simulate eddy mean flow interactions as a predominant process in the spectrum of geostrophic turbulence in the global oceans an idealised ocean basin is considered which represents a sub tropical to sub polar ocean basin as a rectangular domain without realistic coast lines or bottom topography nevertheless we suggest that the simplified geometry does not influence the major results of this study because processes of large scale geostrophic turbulence occur similarly in all ocean basins with variable coastlines and bottom topography chelton et al 2011 von storch et al 2012 the shallow water model considered does however have several shortcomings that limit the comparability to the real ocean many of the processes that lead to a forward cascade of energy in the real ocean such as interactions with bottom topography and internal waves are missing in our model e g gertz and straub 2009 furthermore only the vertically integrated sub grid eke is considered it remains an open question how to parameterize vertical fluxes of sub grid eke in a more advanced three dimensional ocean general circulation model permitting baroclinic instability for simplicity we used a constant viscosity coefficient for the biharmonic lateral mixing of momentum more sophisticated approaches exist smagorinsky 1963 leith 1967 griffies and hallberg 2000 promoting the use of a flow and scale aware non linear viscosity coefficient in order to remove enstrophy from the grid scale and satisfy numerical stability however none of these approaches simultaneously dissipate enstrophy without also dissipating excessive amounts of energy on the grid scale the primary motivation for using the backscatter approach a smagorinsky like formulation of the biharmonic viscosity was successfully combined with the backscatter parameterization jansen et al 2015b as the constant viscosity coefficient used here provides comparable improvements we believe that the energy budget based backscatter parameterization is applicable to various forms of diffusion operators as long as viscosity is in a biharmonic form or of even higher order and backscatter is formulated with a harmonic operator 5 summary and conclusion an energy budget based backscatter parameterization for the unresolved scales in a shallow water model driven by double gyre wind forcing is presented the parameterization is an extension of the original approach by jansen et al 2015b using a biharmonic viscosity in combination with an additional deterministic forcing term formulated as negative laplacian viscosity to represent backscatter of energy from unresolved scales jansen and held 2014 the kinetic energy that is removed from the resolved flow enters the sub grid eke budget which is introduced as a prognostic variable based on local levels of sub grid eke the previously dissipated energy is re injected at larger spatial scales via the backscatter term corresponding to an artificial upscale transfer of energy and hence a closure for the energy cycle simultaneously enstrophy is dissipated at the grid scale ensuring numerical stability a newly formulated rossby number based dissipation scaling allows for a route to energy dissipation for geostrophically unbalanced flow as supported by theory and observations the backscatter parameterization presented in this study is shown to substantially improve the model effectively improving the simulation equivalent to about a factor of two to four increase in resolution at negligible additional computational cost while the implementation of an energy budget based backscatter parameterization in a global climate model may not be straightforward we provide evidence for its potential to substantially improve the models currently used for weather and climate prediction we therefore highly promote further research on energy budget based backscatter methods finally we want to emphasise the importance of closing the energy cycle in an ocean circulation model eden 2016 for successful climate simulations and a better prediction of climate change understanding the routes to dissipation in geophysical turbulence is a major challenge in theory and observations and is an essential basis for sophisticated parameterizations of unresolved scales the energy budget based backscatter approach provides the potential to implement realistic routes to dissipation in an ocean circulation model which provides a cornerstone for improved climate predictions conflict of interest the authors declare that they have no conflict of interest author contributions mk mfj and rjg designed the study mk wrote the numerical model conducted experiments performed the analysis and wrote the manuscript mc contributed to the development of the numerical model all authors contributed in discussion of the results and the manuscript acknowledgements funding from the german ministry for education and research bmbf through miklip2 subproject 01lp1517d atmos modini is greatly acknowledged rjg is also grateful to geomar for continuing support mfj received support from the national science foundation nsf through award oce 1536450 st received funding by the european commission horizon 2020 msca if 2016 waco 749699 supplementary material data relevant to this study is available in klöwer 2018a a more detailed description of the shallow water model used its discretisation as well as model analysis and plotting scripts can be found in klöwer 2018b 
24066,the parameterization of sub grid scale processes is one of the key challenges towards improved numerical simulations of the atmospheric and oceanic circulation numerical weather prediction models as well as climate models would benefit from more sophisticated turbulence closures that allow for less spurious dissipation at the grid scale and consequently higher and more realistic levels of eddy kinetic energy eke recent studies propose to use a hyperviscous closure in combination with an additional deterministic forcing term as a negative viscosity to represent backscatter of energy from unresolved scales the sub grid eke is introduced as an additional prognostic variable that is fed by dissipation at the grid scale and enables recycling of eke via the backscatter term at larger scales this parameterization was previously shown to work well in zonally re entrant channel configurations here a generalization in the form of a rossby number dependent scaling for the strength of the backscatter is introduced to represent the emergence of a forward energy cascade in unbalanced flows near the boundaries we apply the parameterization to a shallow water model of a double gyre basin and provide evidence for its general applicability in terms of mean state and variability a low resolution model is considerably improved towards a high resolution control run at low additional computational cost keywords backscatter energy budget negative viscosity eddy parameterization eddy permitting mesoscale double gyre shallow water model 1 introduction mesoscale eddies are a key turbulent feature of the global oceans chelton et al 2011 understanding their complex interplay with the large scale circulation marshall 1984 wunsch and ferrari 2004 is a major challenge in climate research inevitably important to assess and predict climate change randall et al 2007 flato et al 2013 vallis 2016 eddies are capable of transferring energy across scales and are therefore a crucial element in the ocean s energy cycle rhines 1979 molemaker et al 2005 ferrari and wunsch 2009 aiki et al 2016 finding a closure for eddies in ocean general circulation models is an active field of research eden 2016 von storch et al 2012 eden and greatbatch 2008 in addition to the energy cycle eddies are also important for tracer transport and dominate the mixing and stirring of physical chemical and biological water mass properties gent et al 1995 abernathey et al 2010 liu et al 2012 in the near future state of the art climate models will approach spatial resolutions at which the largest eddies can be resolved explicitly eyring et al 2016 despite the increasing performance of supercomputers the most advanced earth system models are not expected to fully resolve the mesoscale let alone the submesoscale mcwilliams 2016 within the next decades western boundary currents e g the gulf stream and kuroshio and their extension regions are an essential part in the wind driven horizontal gyre circulation imawaki et al 2013 maximenko et al 2013 these regions show an enhanced eddy activity on scales of several hundreds of kilometres down to the submesoscale ferrari and wunsch 2010 the need for more sophisticated turbulence closures realistically parameterizing the effect of meso and submesoscale eddies on the resolved flow is hence clear traditional approaches to eddy parameterization employ down gradient fluxes gent and mcwilliams 1990 ensuring numerical stability griffies 2004 although evidence exists that eddies also affect the mean circulation via up gradient momentum fluxes greatbatch et al 2010 wang et al 2017 some approaches introduce stochasticity to account for sub grid scale variability and parameterizations are formulated as a function of the resolved flow and random numbers aiming to increase the number of variables that determine the future evolution of the flow field palmer 2001 berloff 2005 jansen and held 2014 andrejczuk et al 2016 zanna et al 2017 physically motivated is the implementation of eddy viscosity as a diffusive turbulence closure to mimic the general tendency of the eddy field to mix and hence smooth gradients smagorinsky 1963 leith 1967 redi 1982 griffies and hallberg 2000 other approaches aim to parameterize the advective effects of eddies in baroclinic instability and mixed layer stratification gent and mcwilliams 1990 fox kemper and ferrari 2008 fox kemper et al 2011 brüggemann and eden 2014 but do not include considerations of the kinetic energy cycle generally speaking there are two main requirements that an eddy closure should satisfy in ocean circulation models i the physical parameterization of instabilities their stirring and mixing and subsequent dissipation and ii numerical stability through dissipation of enstrophy at the grid scale the viscosity in general circulation models is usually tuned to satisfy ii whereby viscosity coefficients are several orders of magnitude larger than would result from molecular considerations griffies and hallberg 2000 this leads to a significant dissipation of energy in most approaches we therefore believe successful parameterizations should aim to close the energy cycle by reducing the effective viscosity that otherwise leads to a spurious energy dissipation at the grid scale eden 2016 jansen and held 2014 arbic et al 2007 eddy parameterizations that allow for upscale and downscale fluxes of energy are under investigation e g berloff 2005 nadiga 2008 eden 2010 marshall et al 2012 porta mana and zanna 2014 mak et al 2016 zanna et al 2017 a recently proposed approach jansen and held 2014 jansen et al 2015b involves the combination of a hyperviscous closure in order to remove energy and enstrophy from the grid scale with a prognostic variable for the sub grid eddy kinetic energy eke the dissipated eke is conserved and progressively re injected into the resolved flow at larger scales via a deterministic term that is formulated as negative laplacian viscosity the effectively reduced dissipation allows for higher levels of eke thus hopefully improving the mean state and large scale variability the approach was shown to be successful in an idealised ocean model in a channel configuration jansen et al 2015b here we apply and extend the parameterization to a shallow water model driven by double gyre wind forcing with an idealised basin geometry and no slip boundary conditions and provide evidence for its general applicability this study is structured as follows section 2 briefly presents the shallow water model used throughout this study and its energetics the formulation of sub grid scale eke and the resulting energy budget based backscatter parameterization is introduced subsequently in section 3 1 we discuss the model bias of the low resolution control run without parameterization with respect to the high resolution truth as reference the impact of the energy budget based backscatter parameterization on the low resolution model is analysed in section 3 2 and discussed in section 4 finally we summarise the results in section 5 2 methods 2 1 the shallow water model the shallow water model gill 1982 vallis 2006 of the prognostic variables velocity u u v and sea surface elevation η that is used in this study is 1a u t u u f z u g η f b d ξ 1b η t u h 0 we use a similar barotropic gravity g 10 ms 1 density ρ 10 3 kgm 3 double gyre basin as in cooper and zanna 2015 to resemble a highly idealised north atlantic we use a square domain of size l 2 3840 km 3840 km with cartesian coordinates x y centred at 30 n and a constant undisturbed ocean depth of h 500 m the layer thickness is h η h with the beta plane approximation the coriolis parameter increases linearly from f 3 5 10 5 s 1 at the southern boundary of the domain to f 1 1 10 4 s 1 at the northern boundary z is a unit vector pointing in the upwards vertical direction boundary conditions are no slip as free slip conditions were found to lead to a highly unrealistic representation of the western boundary current steady and solely zonal double gyre wind forcing f f x 0 2 f x τ ρ h τ f 0 cos 2 π y l 1 π 2 sin 2 π y l 1 π with amplitude f 0 0 12 pa is used fig 1 d model simulations start from rest u 0 and the sea surface elevation is undisturbed η 0 in the initial conditions bottom friction b is represented as a quadratic drag b c d h u u with dimensionless drag coefficient c d 10 5 which reduces energy primarily on large scales by approximately 30 compared to simulations without bottom friction the drag is two orders of magnitude weaker than proposed by arbic and scott 2008 as the flow speed at the bottom of the ocean is much smaller than the barotropic flow speed simulated by the model in practice a weak drag allows to maintain vigorous turbulence lateral mixing of momentum d is represented as a biharmonic version of the diffusion operator formulated by shchepetkin and o brien 1996 3 d ν b h 1 h s h 1 h s s u v u x v y v x u y v x u y u x v y with a constant viscosity coefficient νb that depends on the grid spacing δx as ν b 540 m 2 s 1 δ x 3 30 km the resulting munk boundary layer gill 1982 is resolved with at least one grid cell for δx 30 km the symmetric stress tensor s is once evaluated with u v and once with h 1 h s u v for biharmonic diffusion we call the biharmonic stress tensor s s h 1 h s u v the term ξ represents backscatter from unresolved scales and will be defined later for the unparameterized control runs we set ξ 0 the advection of momentum is split into a vorticity part and a gradient of kinetic energy and we use the energy and enstrophy conserving scheme proposed by arakawa and lamb 1981 to discretise the former similar to the arguments of jansen et al 2015b we favour this scheme as a sophisticated energy and enstrophy budget is central to the study without backscatter the energy budget of the shallow water equations is 4 t 1 2 ρ h u 2 1 2 g ρ η 2 u τ ρ c d u 3 ρ ν b h u s where the first term on the left hand side represents kinetic energy ke and the second potential energy pe the brackets denote a horizontal domain wide integral these terms are further reynolds decomposed into mean and eddy contributions to kinetic and potential energy mke eke mpe epe respectively 5 mke 1 2 ρ h u 2 v 2 eke 1 2 ρ h u 2 v 2 mpe 1 2 g ρ η 2 epe 1 2 g ρ η 2 the sea surface elevation is decomposed into a time mean and anomalies as η η η velocities are time averaged with thickness weighting u h u h and similarly for v aiki et al 2016 the respective anomaly is u u u in eq 4 the term uτ represents power input due to wind forcing the second term on the right hand side denotes dissipation due to bottom friction and the third term on the right hand side represents ke dissipation due to the biharmonic viscosity although harmonic diffusion is always down gradient biharmonic diffusion operators are not sign definite and can also lead to power input griffies 2004 but are mostly an energy sink as will be discussed later 2 2 formulation of the energy budget based backscatter parameterization following the ideas of eden and greatbatch 2008 for a mesoscale eddy closure which are further developed in jansen and held 2014 and jansen et al 2015a we seek to find an energy equation for the unresolved scales applied to the shallow water equations similar to jansen et al 2015b we complement the shallow water equations with the following prognostic equation for the vertically integrated sub grid eke e 6 e t e diss e back ν e 2 e the energy dissipation from the resolved flow due to biharmonic diffusion is represented with e diss adding this term to the prognostic equation of sub grid eke is therefore a transfer of energy from the resolved to the unresolved flow the term e back represents the tendency associated with the backscatter hence the energy transfer from the sub grid eke budget back onto the resolved flow which is realised with negative laplacian viscosity from the perspective of the sub grid eke the first term on the right hand side acts as a forcing the second is a damping term the third is a diffusion term we set a constant diffusivity coefficient ν e 540 m 2 s 1 and e 0 serves as boundary condition as in jansen et al 2015b we neglect any advection of sub grid eke with the mean flow due to a lack of an adequate theory that represents the combined effect of advection and wave propagation omitting the constant density ρ the eke transfer to the unresolved flow associated with biharmonic dissipation follows from eq 4 7 e diss c diss ν b h u s this term is negative where the biharmonic diffusion removes energy from the resolved flow in contrast to jansen et al 2015b we introduce a spatially and temporally varying scaling for c diss which obeys 0 c diss 1 to allow only a fraction of the dissipated eke to enter the sub grid eke budget this is done for the following reasons i in the real ocean the direction of energy cascades upscale or downscale depends on the local geostrophic balance and baroclinicity scott and wang 2005 arbic et al 2007 capet et al 2008 ferrari and wunsch 2009 molemaker et al 2010 brüggemann and eden 2015 a varying c diss allows for an eke transfer to the sub grid eke budget that is conditioned on properties of the locally resolved flow ii having c diss 1 yields an energy sink for the resolved flow as the fraction 1 c diss is not subject to the recycling process of the backscatter parameterization this is desired for reasons of numerical stability choosing c diss 1 which corresponds to the original choice in jansen et al 2015b may lead to an effective dissipation that is too weak especially when other routes to dissipation are negligible the loss of energy via forward cascades arising in unbalanced flows is represented using 8 c diss 1 r o r diss 1 with the rossby number r o d f estimated locally via the deformation rate d u x v y 2 u y v x 2 eq 8 obeys the condition 0 c diss 1 for a positive non dimensional constant r diss which controls the backscatter strength and remains subject to tuning having a deformation rate based scaling of dissipation via c diss means that regions of strong shear especially boundary currents that are subject to no slip boundary conditions experience a stronger dissipation than elsewhere in agreement with zhai et al 2010 this avoids re injecting locally an excess amount of energy via the backscatter term where it may lead to spurious oscillations at the grid scale which could in turn cause numerical instabilities physically speaking we want to overcome the spurious energy dissipation at the grid scale for balanced flows ro 1 but retain the dissipative character for unbalanced flows with large rossby number rhines 1979 zhai et al 2010 molemaker et al 2010 nadiga 2014 this is motivated by the fact that geostrophic turbulence at small rossby numbers tends to undergo an upscale cascade of energy scott and wang 2005 whereas large rossby numbers are indicative of a downscale cascade where energy should indeed be dissipated brüggemann and eden 2015 molemaker et al 2010 ferrari and wunsch 2009 in that sense we interpret r diss as a cut off rossby number beyond which loss of balance can lead to a strong forward energy cascade fig 2 b the backscatter forcing term in the shallow water equations is formulated similar to the biharmonic viscosity but in the corresponding harmonic form with a negative viscosity coefficient to allow for an upscale transfer of energy 9 ξ h 1 ν back h s ν back c back δ x max 2 e h 0 using a shallow water model we consider the vertically integrated sub grid eke with units m3s 2 which alters the scaling for ν back slightly through dividing by h in contrast to the original formulation in jansen et al 2015b so that ν back retains its physical units as m2s 1 c back is an o 1 non dimensional constant which we set as originally proposed to be 0 4 and do not perform sensitivity experiments as the dependence on this parameter was previously shown to be weak eq 6 can predict negative values of e hence using the maximum guarantees no backscatter in this case similar to the derivation that led to eq 7 the backscatter term decreases the sub grid eke as 10 e back ν back h u s and transfers that energy back to the resolved flow via negative viscosity a list of all model runs used in this study is given in table 1 3 results 3 1 comparing low and high resolution control runs looking at snapshots of relative vorticity provides insight into the dynamics simulated at different resolution fig 3 a and c at high resolution eddies of different sizes are apparent in most of the western part of the domain as well as in the proximity of the southern and northern boundaries at low resolution larger eddies are simulated where the boundary current leaves the western boundary but they do not propagate as far into the domain also the proximity of the northern and the southern boundary are rather eddy free the circulation dynamics are mostly dominated by westward propagating rossby waves in the eastern part of the domain and eddy eddy interactions in the west greatbatch and nadiga 2000 marshall 1984 the double gyre circulation is not obvious from snapshots but the climatological mean velocities fig 1a and c provide evidence for its existence at low and high resolution a strong boundary current reaching speeds of about 1 ms 1 is simulated the southern northern gyre is referred to as sub tropical sub polar gyre the low resolution model shows weak additional gyres in the north east and south east corner which are more extensive and carry more transport at high resolution these counter rotating gyres share similarities with those described by greatbatch and nadiga 2000 as potential vorticity gradients are flattened towards the boundary but in a much weaker sense comparing the energy levels between the high and low resolution model we conclude that the low resolution model lacks kinetic energy in the spatial and climatological mean by a factor of 2 2 5 fig 4 this is mainly due to missing eke at low resolution the reservoir of eke in the central western part of the domain which is a factor of 2 larger at high resolution dominates the energy budget fig 5 the mke is only large in the western boundary current and less dependent on resolution this supports the notion that only the boundary current of the basin wide circulation is a persistent strong current whereas the instantaneous flow in other parts of the domain is dominated by eddies potential energy is one order of magnitude lower than kinetic energy but similar conclusions hold concerning resolution dependence fig 5 as kinetic and potential energy are directly related in quasi geostrophic flow vallis 2006 although the biharmonic viscosity is known to remove energy at the grid scale griffies and hallberg 2000 jansen and held 2014 jansen et al 2015b it affects all spatial scales as seen in the eke spectrum fig 6 most eke is concentrated on spatial scales near the rossby deformation radius with a power law decrease close to k 3 with k being the horizontal wavenumber at smaller scales pointing to a clearly developed turbulence cascade over a wide range of scales the eke is reduced at low resolution by approximately the same factor across length scales of 200 km 2000 km compared to high resolution in order to understand the differences in eddy energy that come with different resolution the sources and sinks to the energy budget are analysed wind forcing is found to be locally either an energy source or an energy sink which depends on the direction of the zonal flow compared to the direction of the wind forcing figs 7 a and g but less so on the resolution in a spatially integrated sense wind forcing is the only energy source to the shallow water system in the physical settings of this study and approximately independent of the resolution bottom friction removes energy primarily from the western boundary current and its extension where flow speeds are fastest figs 7b and h the pattern therefore resembles that of mke figs 5a and i the power due to the viscosity term reveals an energy sink in the eddy dominated central western part of the domain which is strong at low resolution but much weaker at high resolution figs 7c and i the viscosity in connection with no slip boundary conditions also removes a substantial part of the energy from the boundary due to a not sign definite biharmonic viscosity operator some of the energy that is removed directly at the boundary is partly re injected a few grid cells further inward at high resolution 64 of dissipation is through bottom friction and only 36 due to viscosity this ratio is clearly different at low resolution where viscosity is responsible for 76 of dissipation distributions of rossby numbers reveal that the low resolution model is not able to reproduce the turbulent nature of the simulated flow at high resolution as rossby numbers are in general lower by a factor of 2 fig 2a based on this and the other diagnostics shown figs 1 4 5 6 7 we conclude that a low resolution model differs statistically from its high resolution version that is taken as reference for lower resolution it is necessary to increase the viscosity coefficient in the model table 1 to prevent numerical instabilities this pushes the dissipative scales into the eddy scales leading to a depression of eddy activity nadiga and straub 2010 the unrealistically high viscosity therefore affects the physical regime of the flow measured here in terms of the rossby number decreased eddy kinetic and potential energy follow affecting the mean circulation and the variability of the flow 3 2 energy budget based backscatter the spurious viscous energy dissipation in the low resolution model can be counteracted using the backscatter approach in the original formulation by jansen et al 2015b all dissipated eke is transferred to the sub grid eke budget i e c diss 1 in eq 7 the case of c diss 1 is not going to be discussed here as significant spurious energy tendencies occur due to excessive numerical noise at the boundaries instead our strong backscatter simulation which closely resembles this limit uses a dissipation weakly dependent on the rossby number with r diss 64 see eq 8 having no slip boundary conditions a large amount of energy is dissipated via viscosity due to strong shear flows at the boundary figs 7c and i especially at low resolution consequently most sub grid eke is concentrated in the western boundary region in the climatological mean fig 8 c additionally the central western interior shows increased sub grid eke levels as following from a pronounced eke dissipation via viscosity in the highly turbulent region between the sub tropical and sub polar gyre fig 7c the explicit diffusion of sub grid eke in its prognostic equation has a negligible effect as the time scale for the grid scale diffusion is on the order of 20 days for ν e 540 m 2 s 1 whereas the backscatter time scale defined as the residence time of sub grid eke is on the order of hours to a day the negligible role of sub grid diffusion is also supported by an experiment with an increased sub grid eke diffusion ν e 5400 m 2 s 1 which reproduces virtually the same results solely negative values of sub grid eke are absent in the climatological mean fig 8 due to the increased diffusion but with a negligible impact on the resolved flow the source of energy to the resolved flow via the backscatter parameterization increases with the local level of sub grid eke eq 9 it follows therefore that the backscatter parameterization leads to a particularly strong forcing near the boundaries in the strong backscatter case the eke spectrum shows a strong energy increase at the grid scale indicative of numerical noise fig 6 snapshots especially of relative vorticity reveal that these numerical oscillations occur in the vicinity of boundary currents due to weak dissipation not shown furthermore in the strong backscatter case energy levels exceed those of the high resolution run on all scales fig 4 and 6 and the histogram of rossby numbers fig 2a reveals that high rossby number flow is too prevalent whereas low rossby number flow is too rare compared to the high resolution run hence it would be desirable to decrease the strength of the backscatter parameterization especially near the western boundary the only considered parameter to tune the flow regime dependent backscatter strength is the positive scalar r diss we find for r diss 1 the effect of the backscatter to be negligible such that the low resolution run with backscatter converges towards its unparameterized control run a moderate backscatter parameterization r diss 8 is tuned so as to match the kinetic energy level of the high resolution run fig 4 remarkably this also coincides with a corrected eke spectrum fig 6 the climatological mean of eke fig 5 in the moderate backscatter case is virtually identical to its reference at high resolution also epe is considerably improved and relative contributions of the different energy reservoirs to the total energy are in good agreement with those of the high resolution run fig 5 the energy cycle is corrected as bottom friction accounts for most dissipation fig 7e combining the energy sources and sinks of the biharmonic viscosity and the backscatter term reveals the net effect of the sub grid parameterization fig 7f which is in overall agreement with viscous dissipation at high resolution fig 7i notice that the patterns in figs 7f and i are not expected to be identical as the two represent energy exchange between the resolved and sub grid flow at different cut off scales importantly however the total sub grid energy dissipation rate which represents the magnitude of the forward energy cascade is similar in the two simulations increased eke levels coincide with a higher eddy activity especially in regions where eddies are absent without backscatter parameterization fig 3 this has a positive effect on the climatological mean circulation as the eddy driven circulations along the northern and southern boundaries are in much better agreement with those simulated at high resolution fig 1 furthermore a moderate strength backscatter parameterization yields rossby numbers distributions that closely resemble those simulated at high resolution fig 2a 4 discussion while the original jansen et al 2015b parameterization is shown to lead to an excess of eke at the grid scale in the vicinity of strong boundary currents with no slip boundary conditions the generalisation presented in this study overcomes this limitation by introducing a rossby number based dissipation scaling that yields an energy sink for geostrophically unbalanced flow molemaker et al 2010 ferrari and wunsch 2009 rhines 1979 we are thus able to eliminate the numerical distortions at the western boundary that would otherwise limit the practicality of the backscatter parameterization the eddy mean flow interaction in a low resolution model is shown to be enhanced enabling the model to simulate an improved climatological mean state that presumably results from increased levels of eke and epe due to a more sophisticated simulation of the energy cycle we want to emphasise that the tuning of the backscatter strength is solely motivated by matching reference kinetic energy levels remarkably main aspects of the mean circulation are improved without tuning towards an optimised mean state for the sake of simplicity computational power and given the importance of horizontal scales we have focussed here on the two dimensional shallow water equations which we find adequate to simulate eddy mean flow interactions as a predominant process in the spectrum of geostrophic turbulence in the global oceans an idealised ocean basin is considered which represents a sub tropical to sub polar ocean basin as a rectangular domain without realistic coast lines or bottom topography nevertheless we suggest that the simplified geometry does not influence the major results of this study because processes of large scale geostrophic turbulence occur similarly in all ocean basins with variable coastlines and bottom topography chelton et al 2011 von storch et al 2012 the shallow water model considered does however have several shortcomings that limit the comparability to the real ocean many of the processes that lead to a forward cascade of energy in the real ocean such as interactions with bottom topography and internal waves are missing in our model e g gertz and straub 2009 furthermore only the vertically integrated sub grid eke is considered it remains an open question how to parameterize vertical fluxes of sub grid eke in a more advanced three dimensional ocean general circulation model permitting baroclinic instability for simplicity we used a constant viscosity coefficient for the biharmonic lateral mixing of momentum more sophisticated approaches exist smagorinsky 1963 leith 1967 griffies and hallberg 2000 promoting the use of a flow and scale aware non linear viscosity coefficient in order to remove enstrophy from the grid scale and satisfy numerical stability however none of these approaches simultaneously dissipate enstrophy without also dissipating excessive amounts of energy on the grid scale the primary motivation for using the backscatter approach a smagorinsky like formulation of the biharmonic viscosity was successfully combined with the backscatter parameterization jansen et al 2015b as the constant viscosity coefficient used here provides comparable improvements we believe that the energy budget based backscatter parameterization is applicable to various forms of diffusion operators as long as viscosity is in a biharmonic form or of even higher order and backscatter is formulated with a harmonic operator 5 summary and conclusion an energy budget based backscatter parameterization for the unresolved scales in a shallow water model driven by double gyre wind forcing is presented the parameterization is an extension of the original approach by jansen et al 2015b using a biharmonic viscosity in combination with an additional deterministic forcing term formulated as negative laplacian viscosity to represent backscatter of energy from unresolved scales jansen and held 2014 the kinetic energy that is removed from the resolved flow enters the sub grid eke budget which is introduced as a prognostic variable based on local levels of sub grid eke the previously dissipated energy is re injected at larger spatial scales via the backscatter term corresponding to an artificial upscale transfer of energy and hence a closure for the energy cycle simultaneously enstrophy is dissipated at the grid scale ensuring numerical stability a newly formulated rossby number based dissipation scaling allows for a route to energy dissipation for geostrophically unbalanced flow as supported by theory and observations the backscatter parameterization presented in this study is shown to substantially improve the model effectively improving the simulation equivalent to about a factor of two to four increase in resolution at negligible additional computational cost while the implementation of an energy budget based backscatter parameterization in a global climate model may not be straightforward we provide evidence for its potential to substantially improve the models currently used for weather and climate prediction we therefore highly promote further research on energy budget based backscatter methods finally we want to emphasise the importance of closing the energy cycle in an ocean circulation model eden 2016 for successful climate simulations and a better prediction of climate change understanding the routes to dissipation in geophysical turbulence is a major challenge in theory and observations and is an essential basis for sophisticated parameterizations of unresolved scales the energy budget based backscatter approach provides the potential to implement realistic routes to dissipation in an ocean circulation model which provides a cornerstone for improved climate predictions conflict of interest the authors declare that they have no conflict of interest author contributions mk mfj and rjg designed the study mk wrote the numerical model conducted experiments performed the analysis and wrote the manuscript mc contributed to the development of the numerical model all authors contributed in discussion of the results and the manuscript acknowledgements funding from the german ministry for education and research bmbf through miklip2 subproject 01lp1517d atmos modini is greatly acknowledged rjg is also grateful to geomar for continuing support mfj received support from the national science foundation nsf through award oce 1536450 st received funding by the european commission horizon 2020 msca if 2016 waco 749699 supplementary material data relevant to this study is available in klöwer 2018a a more detailed description of the shallow water model used its discretisation as well as model analysis and plotting scripts can be found in klöwer 2018b 
24067,a three mode time split algorithm 1 2 hydrostatic assumption 1 3 boussinesq assumption 2 from compressible navier stokes equations to boussinesq assumption 2 1 compressible navier stokes equations 2 2 boussinesq approximation 2 3 density and pressure decomposition 3 the three mode non hydrostatic algorithm 3 1 decomposition of the momentum equations 3 2 treatment of the continuity equation conservation of mass 3 3 external and internal modes 3 4 three mode time splitting 3 5 stability of the three mode algorithm and pseudo acoustic regime 4 acoustic surface and internal waves in ocean configurations 4 1 acoustic waves 4 1 1 experiment a spherical waves 4 1 2 experiment b acoustic wave filtering and reflexion in ocean configurations 4 2 surface gravity waves 4 2 1 experiment c natural oscillations of 10 10 m tank 4 3 linear internal tides in ridge configuration experiment d 4 4 non linear internal waves solitons 4 4 1 experiment e solitary waves in tank configuration 4 4 2 experiment f georges bank solitary waves 5 discussion conclusion acknowledgments appendix a consequences of the boussinesq assumptions appendix b non boussinesq system of equations in σ coordinates momentum equations in σ coordinates appendix c space discretization of the divergence and gradient operator c 1 divergence operator c 2 non hydrostatic pressure gradient operator appendix d time varying bathymetry in non boussinesq mode splitting auclair 2011 49 70 f auclair 2014 1 9 f blumberg 1987 1 16 a threedimensionalcoastaloceanmodels adescriptionathreedimensionalcoastaloceancirculationmodel chen 2003 929 952 x chorin 1967 12 26 a casulli 1999 425 440 v deszoeke 2002 2194 2203 r dewar 2015 149 157 w dukowicz 1992 336 347 j durran 2012 1307 1325 d gattibono 2006 589 615 c gerkema 2007 t greatbatch 2001 1911 1923 r griffies 2004 496 s fundamentalsoceanclimatemodels griffies 2012 s hodges 2006 44 64 b horn 2001 181 207 d huang 2002 2131 2151 r janjic 2003 271 285 z lamb 1994 843 864 k lamb 2004 k lemarie 2015 124 148 f mahadevan 1996 1868 1880 a marsaleix 2008 61 89 p marshall 1997 5733 5753 j marshall 1999 1 64 j mellor 1995 20557 20565 g ogura 1962 173 179 y salmon 1998 378 r lecturesgeophysicalfluiddynamics shchepetkin 2011 41 70 a skamarock 1992 2109 2127 w skamarock 2008 3465 3485 w tailleux 2010 339 382 r vallis 2006 745 g atmosphericoceanicfluiddynamics young 2010 394 400 w auclairx2018x12 auclairx2018x12x29 auclairx2018x12xf auclairx2018x12x29xf 2020 10 05t00 00 00 000z 2020 10 05t00 00 00 000z http creativecommons org licenses by nc nd 4 0 2018 elsevier ltd all rights reserved item s1463 5003 18 30264 6 s1463500318302646 1 s2 0 s1463500318302646 10 1016 j ocemod 2018 07 011 272136 2023 04 27t08 09 05 272356z 2018 12 01 2018 12 31 1 s2 0 s1463500318302646 main pdf https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 main application pdf 070235fbcc75bf75bfe8b170bf5cb957 main pdf main pdf pdf true 4523908 main 18 1 s2 0 s1463500318302646 main 1 png https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 preview image png 1d3a24ebf19d4f00a34091fe5dd7cde5 main 1 png main 1 png png 54609 849 656 image web pdf 1 1 s2 0 s1463500318302646 gr1 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr1 thumbnail image gif bc050caa2e1049a0b820070dc80674ef gr1 sml gr1 gr1 sml sml 6579 163 103 image thumbnail 1 s2 0 s1463500318302646 gr2 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr2 thumbnail image gif 24891d90cd4ab8d5118562123a03d399 gr2 sml gr2 gr2 sml sml 15262 164 197 image thumbnail 1 s2 0 s1463500318302646 gr3 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr3 thumbnail image gif 4830fb4e4a978f63ce077e43c03d1300 gr3 sml gr3 gr3 sml sml 16122 134 219 image thumbnail 1 s2 0 s1463500318302646 gr4 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr4 thumbnail image gif 6e777c6d3d35238879bbecae01c9ec78 gr4 sml gr4 gr4 sml sml 10138 118 219 image thumbnail 1 s2 0 s1463500318302646 gr5 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr5 thumbnail image gif 0636bde2647dcb7a17f3cf20d68a70fc gr5 sml gr5 gr5 sml sml 19350 134 219 image thumbnail 1 s2 0 s1463500318302646 gr6 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr6 thumbnail image gif f3922e466ebb62d3da1c1ea7be4829c5 gr6 sml gr6 gr6 sml sml 11759 120 219 image thumbnail 1 s2 0 s1463500318302646 gr7 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr7 thumbnail image gif 26b938413772bcfaa8f4276ac1e7e65a gr7 sml gr7 gr7 sml sml 7436 91 219 image thumbnail 1 s2 0 s1463500318302646 gr8 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr8 thumbnail image gif f800a35800817fbc747e15ea164a1cc4 gr8 sml gr8 gr8 sml sml 8129 92 219 image thumbnail 1 s2 0 s1463500318302646 gr9 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr9 thumbnail image gif 3cb0eddac13e3cb1af84f810828daab7 gr9 sml gr9 gr9 sml sml 13449 163 182 image thumbnail 1 s2 0 s1463500318302646 gr1 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr1 downsampled image jpeg c0eae884f1da85690ea1eba1e6c7ee23 gr1 jpg gr1 gr1 jpg jpg 64815 893 563 image downsampled 1 s2 0 s1463500318302646 gr2 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr2 downsampled image jpeg 824b651c413c3c4d817c848e2d0ab305 gr2 jpg gr2 gr2 jpg jpg 99637 438 527 image downsampled 1 s2 0 s1463500318302646 gr3 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr3 downsampled image jpeg f61502aa756d883561fff925f12a57e4 gr3 jpg gr3 gr3 jpg jpg 63966 414 678 image downsampled 1 s2 0 s1463500318302646 gr4 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr4 downsampled image jpeg 719191c350bd9027711bf7eb24c045cc gr4 jpg gr4 gr4 jpg jpg 66741 364 678 image downsampled 1 s2 0 s1463500318302646 gr5 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr5 downsampled image jpeg 88359ffb4f3489bf93e7409f5f7b7542 gr5 jpg gr5 gr5 jpg jpg 45120 344 563 image downsampled 1 s2 0 s1463500318302646 gr6 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr6 downsampled image jpeg 179918ff6b2729ebd6fafda23f024bfc gr6 jpg gr6 gr6 jpg jpg 88107 390 713 image downsampled 1 s2 0 s1463500318302646 gr7 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr7 downsampled image jpeg 8697360fb463c1dfe50fc9d18c5655e5 gr7 jpg gr7 gr7 jpg jpg 37218 280 676 image downsampled 1 s2 0 s1463500318302646 gr8 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr8 downsampled image jpeg d7f252c1e5ea86d6817d21dc16947d56 gr8 jpg gr8 gr8 jpg jpg 43021 268 638 image downsampled 1 s2 0 s1463500318302646 gr9 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr9 downsampled image jpeg 46afe24bf834872c23b18738bf904a29 gr9 jpg gr9 gr9 jpg jpg 72515 607 676 image downsampled 1 s2 0 s1463500318302646 gr1 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr1 highres image jpeg 10f7dcd8606e608606f5108d3e9f3227 gr1 lrg jpg gr1 gr1 lrg jpg jpg 390532 3956 2494 image high res 1 s2 0 s1463500318302646 gr2 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr2 highres image jpeg 28c452394165ae18622b2da0e1a1afc0 gr2 lrg jpg gr2 gr2 lrg jpg jpg 671299 1940 2333 image high res 1 s2 0 s1463500318302646 gr3 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr3 highres image jpeg 040da5a7a258e025299c6eea15e84d00 gr3 lrg jpg gr3 gr3 lrg jpg jpg 440401 1832 3000 image high res 1 s2 0 s1463500318302646 gr4 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr4 highres image jpeg 49854b5a0fa01bead1bd5ebeb19435f0 gr4 lrg jpg gr4 gr4 lrg jpg jpg 333661 1611 3000 image high res 1 s2 0 s1463500318302646 gr5 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr5 highres image jpeg 5f9f36c6bbf4deb8a1634b2ad9885998 gr5 lrg jpg gr5 gr5 lrg jpg jpg 310488 1524 2494 image high res 1 s2 0 s1463500318302646 gr6 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr6 highres image jpeg be1dc49a7c06044cfc55b3da26abdd1d gr6 lrg jpg gr6 gr6 lrg jpg jpg 543797 1726 3159 image high res 1 s2 0 s1463500318302646 gr7 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr7 highres image jpeg ef08b2430e64eab31af6f65b084957b7 gr7 lrg jpg gr7 gr7 lrg jpg jpg 200447 1240 2994 image high res 1 s2 0 s1463500318302646 gr8 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr8 highres image jpeg 4cef838909ea2f8b67fce2e4afcd53e3 gr8 lrg jpg gr8 gr8 lrg jpg jpg 295716 1186 2827 image high res 1 s2 0 s1463500318302646 gr9 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr9 highres image jpeg 3d6b1f0c0d4fa5acc8498cfdf1ac033b gr9 lrg jpg gr9 gr9 lrg jpg jpg 469840 2687 2992 image high res 1 s2 0 s1463500318302646 si1 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 99c411a5338035f78f0a38d070b9718f si1 gif si1 si1 gif gif 1625 42 378 altimg 1 s2 0 s1463500318302646 si10 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 55ab5ba8bda796537fd29235d3cddf38 si10 gif si10 si10 gif gif 1656 44 369 altimg 1 s2 0 s1463500318302646 si100 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f8f81966abf7fe2851b442f8f9193576 si100 gif si100 si100 gif gif 1722 17 473 altimg 1 s2 0 s1463500318302646 si11 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 62fb0b6c9a625b34b053ab6c88ba81c9 si11 gif si11 si11 gif gif 275 18 37 altimg 1 s2 0 s1463500318302646 si12 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a97d8db4a792904138e11fe4192c43f3 si12 gif si12 si12 gif gif 653 27 165 altimg 1 s2 0 s1463500318302646 si13 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 09dde3fe24596fae034c39735e31e4cb si13 gif si13 si13 gif gif 1350 45 308 altimg 1 s2 0 s1463500318302646 si14 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 84d1bd327acc786102557e447c7ac755 si14 gif si14 si14 gif gif 293 19 64 altimg 1 s2 0 s1463500318302646 si15 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 51f4d4e2587be1f8144c4c0efbfa4c6c si15 gif si15 si15 gif gif 711 19 164 altimg 1 s2 0 s1463500318302646 si16 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 9d99c76b4ba319ff490ddc9db159cbbd si16 gif si16 si16 gif gif 2393 77 460 altimg 1 s2 0 s1463500318302646 si17 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6e3c8db69c08b742cc9c4221d3a93971 si17 gif si17 si17 gif gif 461 28 85 altimg 1 s2 0 s1463500318302646 si18 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4785e979bffba7ebc77dccfb159e2e37 si18 gif si18 si18 gif gif 902 34 166 altimg 1 s2 0 s1463500318302646 si19 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 72dbae57b6acccf7828c9c079ae6b0ac si19 gif si19 si19 gif gif 1923 74 381 altimg 1 s2 0 s1463500318302646 si2 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif d8c08331d7506725cb34ab3b1e8e8dbd si2 gif si2 si2 gif gif 708 38 121 altimg 1 s2 0 s1463500318302646 si20 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4adf74e9083fc4316b87f91fcd7b9e8e si20 gif si20 si20 gif gif 428 13 104 altimg 1 s2 0 s1463500318302646 si21 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b3b28dd28f8d41252a093e33ba6d1dd2 si21 gif si21 si21 gif gif 2906 45 675 altimg 1 s2 0 s1463500318302646 si22 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3bf8b9627d3990450a25952e497dddfa si22 gif si22 si22 gif gif 708 38 120 altimg 1 s2 0 s1463500318302646 si23 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fed85a579273a540b1740fe540bbc0d7 si23 gif si23 si23 gif gif 2473 44 523 altimg 1 s2 0 s1463500318302646 si24 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f57e8f1b638e4f5445a972957db4348e si24 gif si24 si24 gif gif 1962 77 367 altimg 1 s2 0 s1463500318302646 si25 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 11761b7e5f18a129ca07bd5c63ca9ac7 si25 gif si25 si25 gif gif 234 18 32 altimg 1 s2 0 s1463500318302646 si26 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3d73b7c74738692d178ae7381bde58f5 si26 gif si26 si26 gif gif 1874 74 374 altimg 1 s2 0 s1463500318302646 si27 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 0a1e9760f1ed197ac54aa8bec9652523 si27 gif si27 si27 gif gif 829 41 173 altimg 1 s2 0 s1463500318302646 si28 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 802900e5f070d9e506c4eb44ef5d84d7 si28 gif si28 si28 gif gif 556 24 142 altimg 1 s2 0 s1463500318302646 si29 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3c1f30594d0ca24e38d9ab412e04a52b si29 gif si29 si29 gif gif 1910 45 442 altimg 1 s2 0 s1463500318302646 si3 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 2fdc184514e2a45b06a64d139524c1f2 si3 gif si3 si3 gif gif 989 41 171 altimg 1 s2 0 s1463500318302646 si30 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6626f96366eb3dd4d76d00b03c235f16 si30 gif si30 si30 gif gif 2064 34 525 altimg 1 s2 0 s1463500318302646 si31 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 709768c9033b4d8ef057ddd093f05156 si31 gif si31 si31 gif gif 273 21 36 altimg 1 s2 0 s1463500318302646 si32 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4bf51e36abb60f0e061fbe716b1d9393 si32 gif si32 si32 gif gif 283 23 34 altimg 1 s2 0 s1463500318302646 si33 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 59b8b65c8fc2c76a93e188f0ab03bad0 si33 gif si33 si33 gif gif 1622 68 270 altimg 1 s2 0 s1463500318302646 si34 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4c0ab91f944ce4a9c2218f89690a4cfe si34 gif si34 si34 gif gif 606 21 129 altimg 1 s2 0 s1463500318302646 si35 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5b2fd6617bc98e557502a56ab63a3dbb si35 gif si35 si35 gif gif 362 17 81 altimg 1 s2 0 s1463500318302646 si36 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f31df361e83d324741e7ce8cd5efea2b si36 gif si36 si36 gif gif 3934 84 722 altimg 1 s2 0 s1463500318302646 si37 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 93ac04babd41598decbc3a14fbeeb4a4 si37 gif si37 si37 gif gif 3808 82 717 altimg 1 s2 0 s1463500318302646 si38 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif e81b51e07cbacd326bc2cfd4d43ea01a si38 gif si38 si38 gif gif 2430 47 504 altimg 1 s2 0 s1463500318302646 si39 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5592be57f0b8cd3faacb6e82ea295c9f si39 gif si39 si39 gif gif 545 23 108 altimg 1 s2 0 s1463500318302646 si4 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 125ac76328b870ab6910cb0792b4e5a9 si4 gif si4 si4 gif gif 511 17 112 altimg 1 s2 0 s1463500318302646 si40 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1991cdb34b77361ef02aecf0488d77ed si40 gif si40 si40 gif gif 324 18 35 altimg 1 s2 0 s1463500318302646 si41 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a18b2673b16b68e243a44984ab317fd9 si41 gif si41 si41 gif gif 2366 68 463 altimg 1 s2 0 s1463500318302646 si42 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b266c832edff87a26799886e52adbc2a si42 gif si42 si42 gif gif 2194 40 542 altimg 1 s2 0 s1463500318302646 si43 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 9915f16cfcdd394a88f542a61e1375db si43 gif si43 si43 gif gif 577 17 153 altimg 1 s2 0 s1463500318302646 si44 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 44c4ca7673e2786dbaa3085e81dcc26c si44 gif si44 si44 gif gif 4998 115 851 altimg 1 s2 0 s1463500318302646 si45 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a59ebdb31305617d911968a9e9ccc288 si45 gif si45 si45 gif gif 4545 115 764 altimg 1 s2 0 s1463500318302646 si46 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3dce9dff774c622b3d6299040502c7b3 si46 gif si46 si46 gif gif 1756 47 285 altimg 1 s2 0 s1463500318302646 si47 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b3f4c0961a36e1eeb6cd3dc8179a36ae si47 gif si47 si47 gif gif 3877 56 837 altimg 1 s2 0 s1463500318302646 si48 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6d47d347c7c73877c4ce974c10bd7bd1 si48 gif si48 si48 gif gif 778 19 177 altimg 1 s2 0 s1463500318302646 si49 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif cb9c6f202138fb233031690c0b7d6b8e si49 gif si49 si49 gif gif 293 23 40 altimg 1 s2 0 s1463500318302646 si5 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fddc3109e76fd5fbd89b00a1e960b422 si5 gif si5 si5 gif gif 418 17 98 altimg 1 s2 0 s1463500318302646 si50 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3ba78671d597be69d9a49d03b8218aed si50 gif si50 si50 gif gif 403 24 65 altimg 1 s2 0 s1463500318302646 si51 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 0d0a61e66c3807929ff6af8ffaa252c6 si51 gif si51 si51 gif gif 569 24 106 altimg 1 s2 0 s1463500318302646 si52 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif bf6d210247f908da5d3a8a4cd1770995 si52 gif si52 si52 gif gif 657 23 114 altimg 1 s2 0 s1463500318302646 si53 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 84fc979fdbe87492e774d54c8e652336 si53 gif si53 si53 gif gif 281 17 37 altimg 1 s2 0 s1463500318302646 si54 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 09529c4b5a0a38edf43a01c9525d7e6b si54 gif si54 si54 gif gif 1207 40 248 altimg 1 s2 0 s1463500318302646 si55 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 40a6770f7c85d3d12612b9fe5d48e678 si55 gif si55 si55 gif gif 881 40 179 altimg 1 s2 0 s1463500318302646 si56 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif d8924a0ef9d8b7c54ee1b1e563a2dd30 si56 gif si56 si56 gif gif 1421 59 242 altimg 1 s2 0 s1463500318302646 si57 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 2bccbf65799bf33d4fe57be0c63d76cb si57 gif si57 si57 gif gif 1327 59 227 altimg 1 s2 0 s1463500318302646 si58 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f5309ce2ff6e505fa407e4d340e6d327 si58 gif si58 si58 gif gif 1285 39 267 altimg 1 s2 0 s1463500318302646 si59 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif cc91f89abfdd10a65f6e8083de2484aa si59 gif si59 si59 gif gif 358 24 47 altimg 1 s2 0 s1463500318302646 si6 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 9e74d1d6f51be7fe61d10ec2d2ddb010 si6 gif si6 si6 gif gif 175 18 14 altimg 1 s2 0 s1463500318302646 si60 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b1faa83c7fe824b019773e01a1a23d76 si60 gif si60 si60 gif gif 345 24 45 altimg 1 s2 0 s1463500318302646 si61 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5318b9b49de65c547ae97de7aea1312b si61 gif si61 si61 gif gif 829 19 169 altimg 1 s2 0 s1463500318302646 si62 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f176b7b89564afda8e37d3b8658420b2 si62 gif si62 si62 gif gif 658 24 142 altimg 1 s2 0 s1463500318302646 si63 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 49fda017b723fc60ced9d2053d3665c1 si63 gif si63 si63 gif gif 977 36 197 altimg 1 s2 0 s1463500318302646 si64 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b5173add0b6c2b35dc0f97fb1e2e15ee si64 gif si64 si64 gif gif 403 18 76 altimg 1 s2 0 s1463500318302646 si65 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif cc0acb49e21f9d4f566ebe59cd9b3811 si65 gif si65 si65 gif gif 1512 44 332 altimg 1 s2 0 s1463500318302646 si66 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fb40ba51ff3d813f1f96360e90699cc7 si66 gif si66 si66 gif gif 756 41 129 altimg 1 s2 0 s1463500318302646 si67 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1c8c2a6289920ffc9d7209d86178e596 si67 gif si67 si67 gif gif 908 38 145 altimg 1 s2 0 s1463500318302646 si68 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 8fd40dcbcdbf25d576803514f9e6a710 si68 gif si68 si68 gif gif 471 23 82 altimg 1 s2 0 s1463500318302646 si69 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 149caeee9ccbe928bc823c3e2279d895 si69 gif si69 si69 gif gif 517 18 91 altimg 1 s2 0 s1463500318302646 si7 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6dcde31fa3c83d5932cb07bd22cbc170 si7 gif si7 si7 gif gif 584 22 137 altimg 1 s2 0 s1463500318302646 si70 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 645433b29fed9c05eecfba1634a878fc si70 gif si70 si70 gif gif 2432 46 476 altimg 1 s2 0 s1463500318302646 si71 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 98a0ec45fa8efcd1987ced53ca19d375 si71 gif si71 si71 gif gif 535 22 89 altimg 1 s2 0 s1463500318302646 si72 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a5f658338bc044bebc639f555fc852f3 si72 gif si72 si72 gif gif 458 17 86 altimg 1 s2 0 s1463500318302646 si73 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fff069fea8f90fd642d83cd85a3026e0 si73 gif si73 si73 gif gif 2012 23 611 altimg 1 s2 0 s1463500318302646 si74 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 11cb91141853aa6ee39e2d9c5961eace si74 gif si74 si74 gif gif 3302 47 725 altimg 1 s2 0 s1463500318302646 si75 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 05a357f707fe8e2218aa63e89aef45cc si75 gif si75 si75 gif gif 2177 76 319 altimg 1 s2 0 s1463500318302646 si76 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif c69dba615dc3e7448ea7b76d9b9477ec si76 gif si76 si76 gif gif 2861 47 595 altimg 1 s2 0 s1463500318302646 si77 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 595858c667ad0e72de51bc4f5c7ca470 si77 gif si77 si77 gif gif 1457 28 328 altimg 1 s2 0 s1463500318302646 si78 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1347e06b9992e09e245e4c8fdff50976 si78 gif si78 si78 gif gif 391 25 74 altimg 1 s2 0 s1463500318302646 si79 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 91d4454dae3739d4a4a15061cad10a73 si79 gif si79 si79 gif gif 3117 47 727 altimg 1 s2 0 s1463500318302646 si8 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 42b6ce490ce23a39fcdc6c3942546d7b si8 gif si8 si8 gif gif 1566 42 357 altimg 1 s2 0 s1463500318302646 si80 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 17066431dd6a96a41ce5c7ec948caa0f si80 gif si80 si80 gif gif 4684 102 522 altimg 1 s2 0 s1463500318302646 si81 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5b09561d073bbed0c10cc5227617c265 si81 gif si81 si81 gif gif 463 18 58 altimg 1 s2 0 s1463500318302646 si82 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 2fc03f31f385e92951840e0ff6217c4c si82 gif si82 si82 gif gif 407 16 96 altimg 1 s2 0 s1463500318302646 si83 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1409db250a06b91d27c7368a3275969a si83 gif si83 si83 gif gif 4186 56 900 altimg 1 s2 0 s1463500318302646 si84 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif afb42a2929bb3d0f6a841fabc3503532 si84 gif si84 si84 gif gif 3094 52 761 altimg 1 s2 0 s1463500318302646 si85 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1391c55f1731bd238ae3e97d25487244 si85 gif si85 si85 gif gif 546 24 116 altimg 1 s2 0 s1463500318302646 si86 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 8324a80151230144c20999302e69ce4f si86 gif si86 si86 gif gif 2069 27 561 altimg 1 s2 0 s1463500318302646 si87 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f451a4e9e73ed6ed872c55c73e2a9582 si87 gif si87 si87 gif gif 324 24 60 altimg 1 s2 0 s1463500318302646 si88 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 83b0ae7ca59d420c05693bb2df825435 si88 gif si88 si88 gif gif 1544 27 394 altimg 1 s2 0 s1463500318302646 si89 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3827a2f469131df370c2f1301c3c0ac7 si89 gif si89 si89 gif gif 1306 28 332 altimg 1 s2 0 s1463500318302646 si9 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 460750ae9f15d02bc736be7654c8c734 si9 gif si9 si9 gif gif 1452 42 392 altimg 1 s2 0 s1463500318302646 si90 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a0bb88390e67b74ce4e60152ed42a578 si90 gif si90 si90 gif gif 385 24 73 altimg 1 s2 0 s1463500318302646 si91 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 11f9c12d5a7857f19d53e6808d2bc24b si91 gif si91 si91 gif gif 3205 50 740 altimg 1 s2 0 s1463500318302646 si92 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif be4dfcab9df0d88ddca5e7dbab606ced si92 gif si92 si92 gif gif 1248 35 256 altimg 1 s2 0 s1463500318302646 si93 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fc17ec1ea01eeba5b8c85266913db2d9 si93 gif si93 si93 gif gif 885 29 178 altimg 1 s2 0 s1463500318302646 si94 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 91f9284aed8a3d43ede0b9170a393455 si94 gif si94 si94 gif gif 973 35 174 altimg 1 s2 0 s1463500318302646 si95 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 257cad1f0132d3cdac13172a63a80575 si95 gif si95 si95 gif gif 3583 83 476 altimg 1 s2 0 s1463500318302646 si96 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif ce213e31d0118bfc0fc062f35c5aadd5 si96 gif si96 si96 gif gif 690 22 193 altimg 1 s2 0 s1463500318302646 si97 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a63d5b35b77dff154405d79e2d2cceb6 si97 gif si97 si97 gif gif 703 27 153 altimg 1 s2 0 s1463500318302646 si98 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif d424c31b5fb9fadb90aea8c5be7b2232 si98 gif si98 si98 gif gif 676 22 170 altimg 1 s2 0 s1463500318302646 si99 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3f1c7972ad6b182f774879fb8b4820f6 si99 gif si99 si99 gif gif 608 28 142 altimg 1 s2 0 s1463500318302646 am pdf am am pdf pdf 4460993 aam pdf https s3 eu west 1 amazonaws com prod ucs content store eu west content egi 101qnh89fnt main application pdf f2bbc0e6947a02c4f17742fc9ee564f9 am pdf https s3 amazonaws com prod ucs content store us east content egi 101qnh89fnt main application pdf f2bbc0e6947a02c4f17742fc9ee564f9 am pdf ocemod 1327 s1463 5003 18 30264 6 10 1016 j ocemod 2018 07 011 elsevier ltd fig 1 schematic representation of nh a and nbq b time splitting algorithm light gray white and dark gray arrows are associated respectively with internal external and nh nbq modes horizontal arrows represent leapfrog evolution in time and remaining arrows indicate exchanges between the various modes and consequently the way they are updated for interpretation of the references to color in this figure legend the reader is referred to the web version of this article fig 1 fig 2 experiment a vertical section of density non boussinesq anomaly δρ in kg m 3 after 20 s of acoustic forcing at the centre of the 3d domain distances are given in meters fig 2 fig 3 experiment b vertical section of density anomalies a and b after 80 ms in kg m 3 and of vertical velocity c after 2 5 s in m s 1 a acoustic configuration with a vanishing second viscosity b acoustic configuration with a non vanishing second viscosity c ocean like configuration black arrows direction of propagation of acoustic waves solid lines and downward propagating reflected acoustic waves dashed lines blue arrows direction of propagation of surface gravity waves for interpretation of the references to color in this figure legend the reader is referred to the web version of this article fig 3 fig 4 experiment c amplitude a and phase b errors with respect to linear inviscid theory as functions of the wave phase velocity in ms 1 after 50 natural oscillation periods bar colors indicates the set of experiments obtained for different external mode coefficients set 1 α e 0 1 set 2 α e 0 1 and λ 1 m 2 s 1 set 3 α e 0 05 set 4 α e 0 01 errors are given in percent of the initial amplitude a and of the natural oscillation period b fig 4 fig 5 experiment d vertical section of square brunt väisälä pulsation anomaly rad2s 2 after 10 forcing periods simulated numerically with nbq algorithm this figure can be compared with auclair et al 2014 s fig 1 they plotted the same vertical section of square brunt väisälä pulsation anomaly a measured by synthetic schlieren and b simulated numerically with nh algorithm fig 5 fig 6 experiment d rms errors of horizontal a c and vertical b d velocity components during the first 5 forcing periods for small 1500 m s 1 phase velocity time steps a b and optimally adjusted time steps b d a c rms errors are plotted for nh configuration dashed line 10 ms 1 solid line 20 ms 1 solid line and signs 50 ms 1 solid line and diamonds and 100 ms 1 solid line and lower triangle phase velocity nbq configurations b d rms errors are plotted for nh configurations dashed line for set o1 of optimal parameters and dashed line and for set o2 of optimal parameters 10 ms 1 solid line 20 ms 1 solid line and signs 50 ms 1 solid line and diamonds and 100 ms 1 solid line and lower triangle phase velocity nbq configurations fig 6 fig 7 experiment e depth of the mid pycnocline isopycnal surface in meters as a function of time in second dashed line nh configuration solid line nbq configuration fig 7 fig 8 experiment f vertical sections of the total density anomaly in kg m 3 horizontal distances are given en km and depths in meters fig 8 fig 9 experiment f vertical sections of cross shore a and vertical b components of the velocity ms 1 horizontal distances are given en km and depths in meters fig 9 table 1 primary characteristics of experiment a table 1 size of the domain m li lj h max 512 512 512 number of points of model grid in x and y direction i max j max 512 512 horizontal model grid m δx δy 1 σ levels k max 512 equally spaced levels total simulation time s 20 internal mode time step ms δti 22 external mode time step ms δte 0 22 compressible mode time step ms δtq 0 11 acoustic courant number coq 0 165 phase velocity of pseudo acoustic waves ms 1 cs 1500 kinematic viscosity m2 s 1 ν 0 second viscosity m2 s 1 λ 0 asselin filter parameter 10 3 diffusivity m2 s 1 kd 0 amplitude kg m 3 s 1 e folding m and period of forcing ms a 0 l 0 t 0 1000 2 5 25 table 2 model parameters for experiment b in acoustic and ocean like configurations table 2 acoustic configuration ocean like configuration size of the tank m li h max 4 1 0 4 25 6 0 2 number of points of model grid in x and y direction i max j max 4096 1 256 1 horizontal model grid m δx δy 10 3 0 1 σ levels kmax 40 equally spaced levels 20 equally spaced levels mount height m h 0 0 1 0 1 mount horizontal scale m l 0 sine shaped mount 0 4 gaussian shaped mount 1 gaussian mount oscillations amplitude m period s a 0 t 0 10 4 10 2 10 2 10 total simulation time s 2 5 2 5 internal mode time step ms δti 6 2 10 2 4 3 external mode time step ms δte 3 1 10 2 0 43 nbq mode time step ms δtq 1 6 10 2 0 22 acoustic courant number coq horizontal vertical 0 16 0 16 0 02 0 22 phase velocity of pseudo acoustic waves ms 1 cs 10 10 kinematic viscosity m2 s 1 ν 0 0 second viscosity m2 s 1 λ 0 10 2 0 asselin filter parameter 10 3 10 3 diffusivity m2 s 1 kd 10 9 10 9 table 3 model parameters for experiment c table 3 size of the tank m li h max 10 10 number of grid points of model grid in x and y direction i max j max 100 1 horizontal model grid m δx δy 0 1 σ levels k max 100 equally spaced levels total simulation time s 180 internal mode time step ms δti set 1 2 642 set 3 482 set 4 96 external mode time step ms δte set 1 2 0 32 set 3 0 16 set 4 0 032 nbq mode time step ms δtq cfl requirements section 3 5 up to 0 16 ms surface gravity wave courant number coe set 1 2 0 032 set 3 0 016 set 4 0 0032 phase velocity of pseudo acoustic waves ms 1 cs 40 equation of state compressible kinematic viscosity m2 s 1 ν 10 7 second viscosity m2 s 1 λ 0 or 1 asselin filter parameter 10 2 table 4 model parameters for experiment d in tank configuration auclair et al 2014 and test configurations table 4 tank configuration test configurations size of the tank m li h max 4 0 394 1 0 2 number of points of model grid in x and y direction i max j max 4096 1 256 1 horizontal model grid m δx δy 10 3 4 10 3 σ levels k max 400 equally spaced levels 100 equally spaced levels gaussian mount height m h 0 0 1 0 05 gaussian mount horizontal scale m l 0 3 86 10 2 3 86 10 2 gaussian mount oscillations amplitude m period s a0 t0 10 3 10 05 10 3 10 brunt väisälä pulsation rad s 1 n 0 92461 1 total simulation time s 50 25 50 25 internal mode time step ms δti 1 57 3 46 external mode time step ms δte 1 57 10 2 8 67 10 4 nbq mode time step ms δtq 7 8410 3 4 34 10 4 internal wave courant number for mode 1 internal waves coiw 0 2 0 2 phase velocity of pseudo acoustic waves ms 1 cs 10 100 50 20 10 equation of state 16 linear linear kinematic viscosity m2 s 1 ν 10 6 10 6 second viscosity m2 s 1 λ 10 3 10 4 asselin filter parameter 10 3 10 5 diffusivity m2 s 1 kd 10 9 10 9 table 5 model parameters for experiment e table 5 size of the tank m li h max 6 0 29 number of points of model grid in x and y direction i max j max 60 1 horizontal model grid m δx δy 0 1 σ levels k max 74 equally spaced levels internal mode time step ms δti nbq 37 4 nh 37 4 total simulation time s 400 external mode time step ms δte nbq 0 934 nh 18 7 nbq mode time step ms δtq nbq 0 093 nh two layer density difference kg m 3 δρ 20 horn s parameter δ 0 45 horn s parameter γ 0 3 phase velocity of pseudo acoustic waves ms 1 cs 4 equation of state 16 linear kinematic viscosity m2 s 1 ν 10 6 second viscosity m2 s 1 λ 0 1 asselin filter parameter nbq 0 1 nh 0 3 diffusivity m2 s 1 kd 10 7 table 6 model parameters for georges bank experiment experiment f table 6 size of the domain m 67 500 45 260 number of points of model grid in x and y direction i max j max 4500 3 cyclic boundary conditions in y direction horizontal model grid m δx δy 15 σ levels k max 100 equally spaced levels total simulation time day 1 internal mode time step ms δti 458 1 external mode time step ms δte 4 58 nbq mode time step ms δtq 0 115 phase velocity of pseudo acoustic waves ms 1 cs 60 surface acoustic wave courant number coe coq 0 015 0 0027 vertical advection courant number cow 0 08 with local hot spots equation of state compressible and linear kinematic viscosity m2 s 1 ν 10 5 horizontally half of the diffusive part of the upstream advective scheme second viscosity m2 s 1 λ 102 asselin filter parameter 10 3 diffusivity m2 s 1 kd 10 6 open boundary layer flow relaxation scheme forcing m2 tidal period t 0 h 12 4 coriolis parameters 10 4 0 a non hydrostatic non boussinesq algorithm for free surface ocean modelling f auclair a l bordois a b y dossmann b a t duhaut a a paci a c ulses a c nguyen a a laboratoire d aérologie université de toulouse cnrs ups france laboratoire d aérologie université de toulouse cnrs ups france b cnrm game gmei spea cnrs météo france toulouse france cnrm game gmei spea cnrs météo france toulouse france corresponding author a three mode time split algorithm is proposed to simulate non hydrostatic ocean processes in a natural way fast pressure adjustments via acoustic waves are explicitly represented the full set of compressible navier stokes equations is integrated for a free surface ocean with three time steps respectively associated to the internal external and compressible non boussinesq modes the resulting three mode algorithm can be implemented either in a fully compressible configuration or in a pseudo compressible configuration by artificially lowering acoustic wave velocities to reduce computational costs the present description of the three mode algorithm focuses in the first place on the simulation of non hydrostatic processes in free surface ocean models several test simulations related to linear and non linear acoustic surface and internal gravity waves are studied in details with the proposed three mode algorithm 1 introduction fast pressure adjustments in fluids occur primarily through acoustic waves these adjustments are closely related to the bulk compressibility of fluid and the system of navier stokes equations includes physical processes at all ocean scales spreading from general circulation to high velocity sound waves not to mention surface gravity waves in the last decades three types of approaches have basically been proposed to deal with acoustic waves in weather forecast models to filter these high velocity waves ogura and phillips 1962 and many others ever since imposed the anelastic approximation as a consequence a global 3d poisson system has to be solved at every time step durran and blossey 2012 did not impose such approximation and proposed to simulate high velocity acoustic waves using an implicit explicit multistep method courant number restrictions are circumvented using an implicit scheme but a global helmholtz 3d equation must be solved avoiding solving large 3d systems of equations janjic 2003 proposed this time to simulate explicitly acoustic waves based on a time split approach propagation of sound waves is permitted with a small courant number limited time step and a large time step is used for atmospheric slower processes all those approaches have in common the necessity to simulate the consequences of the transient adjustments due to acoustic waves but they all care much less about the details of the propagation of the acoustic waves only the result of the faster transients is then of interest still with the objective to limit courant number restrictions chorin 1967 proposed to reduce acoustic wave velocity leading to an artificial compressibility several atmospheric numerical models see skamarock and klemp 2008 for a complete list can thus simulate faster pressure adjustments in a natural way these models are particularly well adapted to modern massively parallel computing they are based on local in space and time equations and do not require solving global systems in non hydrostatic ocean models pressure correction boussinesq algorithms have been preferred since marshall et al 1997 because acoustic waves are four to five times slower in the atmosphere than in the ocean one could at first conclude that their simulation imposes stronger courant number restrictions in the ocean and that it is consequently much more expensive than in the atmosphere the treatment of bulk compressibility and acoustic waves are of the same nature in the atmosphere and in the ocean but the spectral gap between faster incompressible dynamics and acoustic waves is larger in the ocean non hydrostatic effects are naturally associated to acoustic waves as a consequence acoustic wave dynamics can be viewed as a natural solver for hydrodynamic pressure in the same way as in atmospheric models the consequences of the transient compressible adjustments of pressure are of interest and we propose to retain bulk compressibility or at least artificial or pseudo compressibility to simulate non hydrostatic pressure adjustments in otherwise incompressible ocean configurations the main originality compared to atmospheric models lies in the implementation of a compressible non boussinesq mode in a free surface ocean model which is already based on a barotropic baroclinic time split approach this leads to a three mode time split algorithm 1 1 a three mode time split algorithm since blumberg and mellor 1987 most ocean models simulate long surface gravity waves with a barotropic baroclinic time splitting we propose to make one further step in this time split strategy by implementing a third compressible non boussinesq mode in the barotropic hereafter external mode this 2d mode remaining itself embedded in the slow baroclinic hereafter internal mode the resulting three mode algorithm is consequently based on three time steps the smaller being dedicated the fast 3d dynamics of acoustic or pseudo acoustic waves this leads to a limited number of modifications in existing numerical models i the boussinesq or anelastic approximations must be abandoned ii momentum rather than velocity becomes a prognostic variable iii the vertical velocity must be prognosticated at the internal mode time step through the corresponding momentum equation and iv the time splitting must be extended to include a third faster compressible mode to propagate acoustic waves in its present implementation the three mode algorithm is however less general than a full navier stokes model as only the linear advection free acoustic part of the dynamics is solved with a small time step and the sound speed remains constant requiring temperature and salinity to be computed only at the larger internal mode time step 1 2 hydrostatic assumption we can wonder why in the first place the hydrostatic assumption should be revoked in ocean models the reason is essentially to provide an accurate description of wave dynamics and to introduce non hydrostatic processes such as vertical motions in convective chimneys marshall and schott 1999 non hydrostatic dispersion in solitary waves lamb 2004 or the non traditional component of the coriolis force leading to more accurate representation of the vorticity balance gerkema et al 2007 following vallis 2006 chapter 2 7 it can be shown that to be in hydrostatic equilibrium a homogeneous ocean must have small aspect ratio ε h l 1 with h and l the vertical and horizontal length scales whereas a stratified ocean must satisfy fr 2ε2 1 with fr v nh n a typical brunt väisälä frequency and v an horizontal velocity scale several approaches have been proposed to circumvent the hydrostatic approximation for a boussinesq flow marshall et al 1997 casulli 1999 auclair et al 2011 pure pressure projection boussinesq algorithms chorin 1967 require to first step forward momentum equations before adjusting the non hydrostatic pressure a 3d poisson system must then be solved for pressure correction methods additionally require that an up to date non hydrostatic pressure force is taken into account when advancing momentum equations first step and only an increment of the non hydrostatic pressure is calculated by solving for the 3d poisson system dukowicz and dvinsky 1992 mahadevan et al 1996 marshall et al 1997 and many others an additional difficulty with non hydrostatic modelling in free surface ocean models is associated to the strong coupling of the non hydrostatic and surface induced components of the pressure field auclair et al 2011 to our knowledge none of these non hydrostatic algorithms is based on an explicit simulation of acoustic waves in the context of a free surface ocean 1 3 boussinesq assumption large to regional scale ocean models most often rely on both the boussinesq and hydrostatic assumptions leading to a description of the ocean in which buoyancy has a central role in more or less the same way as the anelastic approximation restricts the range of atmospheric processes the boussinesq assumption is justified by the small deviations of the ocean density from a reference value and it provides an efficient framework to study slow large scale processes which are characterized by small vertical to horizontal length scale ratios it basically decouples the dynamics and thermodynamics of the ocean filters out acoustic waves and leads to a mathematical degeneracy of the non hydrostatic system of equations the filtering of the acoustic waves transforms the initially hyperbolic system of equations into an elliptical system boussinesq flows conserve volume but not mass leading to discrepancies in the transient adjustment processes following for instance the surface heating of the ocean huang and jin 2002 another consequence of the boussinesq assumption concerns the way energy is transferred between the kinetic and potential compartments tailleux 2010 when combined the boussinesq and hydrostatic assumptions provide a simple valuable and accurate representation of slow and large scale ocean processes nevertheless the access to ever more efficient computing facilities associated to the desire to improve the simulated dynamics by for instance extending the space time spectrum toward high frequencies and small scales lead oceanographers to question and then circumvent these assumptions shchepetkin and mcwilliams 2011 section 5 greatbatch et al 2001 propose to reconsider the concept of velocity to conserve mass velocity should indeed not be considered as the result of a reynolds averaging but rather as the result of a favre averaging when the objective is mainly to recover the non boussinesq steric effect under the hydrostatic assumption without reintroducing the acoustic waves deszoeke and samelson 2002 have shown that pressure coordinates constitute a valuable choice a divergent formulation of the velocity field can instead be obtained by improving the accuracy with respect to the density anomalies dewar et al 2015 these aspects are not further investigated numerically hereafter the modelling of the steric effect with the present three mode non boussinesq algorithm should be investigated in a following study following time split approaches currently implemented in weather forecast models and adapting these approaches to the context of a free surface ocean we propose to abandon both the hydrostatic and boussinesq approximations first of all the acoustic waves are reintroduced in order to recover mathematical hyperbolicity from this standpoint the proposed algorithm can thus be viewed as a physical solver for non hydrostatic ocean flows in terms of parallel computing a consequence is that computations are local in space limiting the perspectives to a simple reduction of computational cost would be over simplistic since conservation of mass can also be advantageously recovered by integrating in time the full continuity equation the proposed algorithm additionally leads to the recovering of a physical i e non boussinesq treatment of the kinetic to internal and gravitational potential energy exchanges the three mode algorithm provides de facto another way to deal with the pressure dependence of the eos by re introducing a first order pressure dependence of the density second viscosity is also reintroduced in the momentum equations since velocity divergence does not vanish any more the corresponding damping process can be considered as an efficient natural filter for acoustic waves this second viscosity filter is equivalent to the selective numerical filter proposed by skamarock and klemp 1992 to damp divergent modes in their atmospheric model section 2 is dedicated to the density and pressure decomposition the non boussinesq mode splitting algorithm is then described in details in section 3 auclair et al 2011 s test configurations and the compressible configurations of acoustic waves are revisited in section 4 discussion and conclusions are finally given in section 5 2 from compressible navier stokes equations to boussinesq assumption 2 1 compressible navier stokes equations full compressible navier stokes system in cartesian z coordinates is given by 1a ρ d v d t p ρ g δ f c ρ ν δ v ρ λ v 1b ρ t ρ v 1c d θ s d t ϕ θ ϕ s 1d ρ ρ θ s p where v u v w is the velocity p the total pressure ρ the density θ the potential temperature s the salinity ν the constant kinematic viscosity and λ the constant bulk or second viscosity hereafter both viscosities are assumed homogeneous to simplify notations the second velocity participates to the damping of acoustic waves the lagrangian derivative of momentum varies according to eq 1a with the pressure force the weight the coriolis pseudo force and the viscous diffusion the second viscosity diffusion is an efficient filter in term of numerical cost whereas it is also the natural filter for acoustic waves on the right hand side rhs of the heat and salinity evolution equations 1c ϕ θ and ϕ s gather compressibility and diabatic processes 1 1 following for instance griffies 2004 chapter 5 right hand side of 1c can be decomposed in a diffusion flux and a source term the last equation is the general eos for seawater density is a function of potential temperature salinity and total pressure the coriolis pseudo force can be written in a compact form ω being the earth angular velocity 2 δ f c 2 ρ ω v at the surface of the ocean the boundary condition is given by the continuity of the pressure field and viscous stress tensor the presence of a free surface additionally imposes a non trivial kinematic condition at z ζ with ζ the free surface anomaly 3 w z ζ ζ t u z ζ ζ x v z ζ ζ y at the bottom z h with h the ocean depth the no permeability kinematic condition leads to 4 w z h u z h h x v z h h y the depth integral of the continuity eq 1b can be combined with the kinematic conditions 3 and 4 to obtain an evolution equation for the mass of a water column 5 h ζ ρ t h ζ ρ u x h ζ ρ v y where the overbar stands for vertical depth average over the water column 2 2 boussinesq approximation the formulation of the boussinesq assumption first requires that a thermodynamical equilibrium state be chosen as a reference the corresponding reference density ρ0 is homogeneous and stationary the boussinesq approximation then requires that bq i density anomalies ρ ρ0 are negligible with respect to the reference density bq ii the vertical scale h ρ over which this density field varies is much larger than the ocean vertical scales h ρ 1 1 ρ ρ z h 1 both requirements are satisfied with a reasonable accuracy less than a few percent by large scale fields whereas atmospheric dynamics is commonly studied using the less restrictive anelastic assumption bq i under the boussinesq assumption the compressible navier stokes system 1 5 simplifies to 6a d v d t 1 ρ 0 p ρ ρ 0 g 2 ω v ν δ v 6b v 0 6c d θ s d t ϕ θ ϕ s 6d ρ ρ b q θ s ρ 0 g z thermodynamically speaking the boussinesq equation of state 6d for seawater can only relate density temperature and salinity to an approximation of pressure the high frequency component of the total pressure field being filtered out leading to the so called seawater boussinesq approximation young 2010 the boussinesq assumption has several additional consequences recalled in appendix a 2 3 density and pressure decomposition first order pressure dependence can be retained in eos 1d 7 ρ ρ θ s p ρ 0 ρ b q θ s p ref ρ p θ s δ p o δ p 2 δ ρ where ρ p θ s 1 c s 2 with c s θ s p p ρ θ s the velocity of acoustic waves and p ref is a chosen reference pressure a decomposition of the pressure field follows 8 p p atm ρ 0 g ζ z z ζ ρ b q ρ 0 g d z p h δ p with p atm the atmospheric pressure at the surface of the ocean ph the hydrostatic component based on the boussinesq component of density and δpthe non hydrostatic increment of pressure the reference pressure p ref must then be chosen for the numerical configurations presented in the following the reference pressure is the hydrostatic pressure for a homogeneous constant reference density it is equal to the depth dependent reference pressure used in the boussinesq eos 6d i e 9 p ref ρ 0 g z for the same type of expansion dewar et al 2015 choose the static pressure caused by p atm and by a mean density profile as a reference pressure because the sound speed cs θ s p depends on the potential temperature salinity and pressure the compressible or non boussinesq pressure δp and density δρ anomalies are not linearly correlated in a general case we disregard this dependence in the experiments that follow for simplicity considering for simplicity that atmospheric pressure is also constant the non boussinesq system of equations can now be written in a conservative form 10a ρ v t ρ u v x ρ v v y ρ w v z h p h δ p δ ρ g δ f c ρ ν δ v ρ λ v 10b ρ t ρ v 10c ρ θ s t ρ u θ s x ρ v θ s y ρ w θ s z ρ ϕ θ ϕ s 10d ρ ρ θ s p ρ b q θ s ρ 0 g z ρ p θ s δ p δ ρ where h is the horizontal component of the gradient in cartesian coordinates the decomposition of density 10d is thus partially in line with the expansion proposed by dewar et al 2015 butph is here supposed to be in hydrostatic equilibrium with ρ bq whereas dewar et al more generally consider that the boussinesq field can be at least partly non hydrostatic the proposed algorithm also differs from theirs by retaining the full expression of the continuity equation and as a consequence the acoustic waves no additional terms need to be implemented in the present vertical momentum equations to provide an accurate kinetic to internal energy conversion the decomposition of the pressure field can finally be compared with the one used in a pressure correction algorithm 11 p p atm ρ 0 g ζ z z ζ ρ b q ρ 0 g d z p h q where q is the boussinesq non hydrostatic pressure correction obtained by solving a 3d poisson system in eq 8 δpis the non hydrostatic pressure increment linearly associated to the non hydrostatic density anomaly δρ through 10d 3 the three mode non hydrostatic algorithm the three mode splitting algorithm is now detailed and we implement it into a boussinesq hydrostatic free surface ocean models already based on a baroclinic barotropic time splitting in the first place this algorithm aims at simulating fast pressure adjustments leading to non hydrostatic dynamics 3 1 decomposition of the momentum equations momentum eq 10a include in their rhs both slow fast and very fast terms respectively computed in the internal external and compressible or non boussinesq nbq modes 12 ρ v t λ i λ e λ q the operators λ λ x λ y λ z can be written 13a 13a λ i ρ u v x ρ v v y ρ w v z h p h δ f c ρ ν δ v 13b λ q δ p δ ρ g ρ λ v c s 2 δ ρ δ ρ g ρ λ v by depth integrating the horizontal component of the slowest terms one obtains the component corresponding to the external mode λ e and to its internal mode residue λ i 13c λ e λ i x e λ i y e 0 and λ i λ i λ e relations 13c express a common external internal mode splitting based on the momentum decomposition ρ v ρ v ρ v under boussinesq assumption this decomposition is applied to velocity not to momentum relation 13b makes the additional assumption that non linear advective processes do not evolve at very fast time scales this leads to linear acoustics but is fully relevant if we focus on non hydrostatic processes the three mode algorithm can then be implemented in two different ways either with a realistic acoustic velocity the algorithm is then in a compressible configuration or with a lower unrealistic acoustic velocity we shall then talk about pseudo compressible configuration time steps for the nbq external and internal modes are respectively written δtq δte nq δtq and δti ne δte recalling that δtq δte δti the three mode algorithm is now discretized with a simple low order and well known leapfrog time stepping the advantages simplicity well known treatment of the conservation of energy marsaleix et al 2008 of this implementation together with its main drawbacks stability only when associated to an asselin like time filter optimal numerical properties under a reduced range of courant numbers and phase shift in the propagation of high frequency waves are known and well documented lemarié et al 2015 the present use of the leapfrog scheme is thus to be viewed as a reference implementation which undoubtedly needs to be followed by a detailed analysis of a comparative analysis of higher order space time schemes 3 2 treatment of the continuity equation conservation of mass the full non boussinesq continuity eq 1b is central to the three mode algorithm it enforces conservation of mass and through its various formulations it is used to prognosticate the surface elevation anomaly eq 5 to compute the cross σ vertical velocity appendices b and c and it is at the root of the flux formulation of advection eq b 4 it can also appear in the computation of the grid depth in σ coordinates and more generality in s coordinates the presentation of the algorithm is now restricted to x z plane without loss of generality and the velocity is v u w the grid is supposed to move vertically at the internal mode time step and to remain steady during the integration of the nbq mode details of σ grid implementation are given in appendix b the continuity equation can alternatively be reformulated in function of w after substitution of relation b3 if ni ne nq are the time step indices for the internal external and nbq modes the fast compressible nbq mode can be written 14a ρ u n q 1 ρ u n q 1 2 δ t q c s 2 δ ρ n q x z λ 2 ρ u n q x 2 λ 2 ρ w n q x z λ n b q x n q 2 δ t q λ e n e λ i x n i 14b ρ w n q 1 ρ w n q 1 2 δ t q c s 2 δ ρ n q z δ ρ n q g λ 2 ρ u n q z x λ 2 ρ w n q z 2 λ n b q z n q 2 δ t q λ i z n i 14c δ ρ n q 1 δ ρ n q 1 2 δ t q ρ b q t n i 2 δ t q ρ u n q x ρ w n q z the system has been reduced to 3 equations with 3 unknowns by substituting the non boussinesq pressure anomaly by the non boussinesq density anomaly 15 δ p n q c s 2 δ ρ n q several choices have been made to end up with nbq system 14 the most significant being the use of ρ and ρ v as prognostic variables the resulting system is linear in this couple of variables once again this choice is dictated by the necessity to end up with a discrete approximation of 14c that is both conservative and accurate this treatment is different from the approach proposed by gatti bono and colella 2006 to solve for the compressible euler equations gatti bono and colella indeed chose to decompose both the density and thus pressure and momentum fields the divergence operator of the second viscosity is additionally applied to the momentum and not to the velocity as in 13b to optimize computations the linear operators which are necessary to compute the pressure force the second viscosity operator and the divergence of momentum in 14 are directly derived from the gradient and divergence matrices defined by auclair et al 2011 and are given in appendix c in σ coordinates the originality of the approach proposed therein is to compute separately the matrices for the divergence and gradient operators the laplacian operator was then obtained by a matrix multiplication this procedure permits a consistent discretization of the divergence and gradient matrices in terms of energy conservation and facilitates the formulation of the bottom surface and lateral boundary conditions linear eq 14 a and b can thus be reformulated in matrix vector notations the fluxes related to the second viscosity are linear and do not require the computation of any new operators the system of equations of the nbq mode is linear and an integration of the nbq mode basically consists in three matrix vector multiplications two for the momentum eq 14a and one for the continuity eq 14b 3 3 external and internal modes external and internal modes are already discussed in auclair et al 2011 and only a short description is given hereafter for surface wave and more generally barotropic dynamics the depth integrated momentum and continuity equations can be formulated as 16a ρ u n e 1 ρ u n e 1 2 δ t e ρ 0 g ζ n e x λ e n e 2 δ t e λ q x e n e λ i x n i 16b ρ q n e 1 h ζ n e 1 ρ q n e 1 h ζ n e 1 2 δ t e h ζ n e ρ u n e x where e and hereafter i stand for time averages at respectively external and internal time steps in eq 16b the bottom topography and as a consequence the σ coordinate grid appendix b can additionally vary with the slow internal mode time step appendix d and auclair et al 2014 the total density ρ q is the summation of the reference density with the boussinesq low frequency and non boussinesq anomalies ρ q ρ 0 ρ b q δ ρ in this expression the boussinesq component is equal to its latest available value the low frequency internal mode system of equations is 17a ρ u n i 1 ρ u n i 1 2 δ t i ρ 0 g ζ n i x x z ζ n i ρ b q n i g d z u ρ u x i n i w ρ u z i n i δ f c x n i i ν δ ρ u i n i 1 λ i x n i 2 δ t i λ q x i n i 17b ρ w n i 1 ρ w n i 1 2 δ t i z z ζ n i ρ b q n i g d z u ρ w x i n i w ρ w z i n i δ f c z n i i ν δ ρ w i n i 1 λ i z n i 2 δ t i λ q z i n i 17c ρ w i z i n i ρ q t i n i ρ u i x i n i 17d ρ q i n i 1 θ n i 1 s n i 1 ρ q i n i 1 θ n i 1 s n i 1 2 δ t ρ u θ s x i n i 1 ρ w θ s z i n i 1 ρ n i ϕ θ n i ϕ s n i 17e ρ b q ρ b q θ s ρ 0 g z several differences need to be acknowledged between the present formulation of external and internal modes and their pressure correction formulation proposed by auclair et al 2011 as momentum rather than velocity becomes the prognostic variable both the external and internal modes need to be reformulated in terms of momentum the velocity field might be needed by the nbq algorithm to compute advective fluxes or in specific diffusion schemes and it can then be calculated knowing the density ρ q i in the external mode the iteration of the nbq mode at each external time step provides an alternative to solve the cross dependencies in traditional algorithms pointed out by shchepetkin and mcwilliams 2011 indeed the depth average density ρ q e is available when the external mode is integrated and more specifically when free surface anomaly is prognosticated through 16b whereas model σ grid related variables are updated at internal time step and are thus available in the nbq mode in the internal mode now the continuity eq 17c is only needed to calculate cross σ vertical velocity v σ the non hydrostatic component of the pressure force which appears in both the external and internal modes is given by the nbq component of pressure this component is indeed deduced from the corresponding component of density using the eos 15 in the nbq algorithm neither the free surface anomaly nor the momentum have to be corrected in external or internal modes in the present nbq algorithm whereas such correction is needed in pressure correction methods indeed the continuity equation recovers its status of prognostic equation and is not a constraint any more this is of considerable importance for the algorithm to be easily implemented with higher order mode complex but maybe more efficient time stepping compared to leap frog 3 4 three mode time splitting fig 1 a shows the pressure correction time stepping used by auclair et al 2011 the nbq time stepping is represented in fig 1 b the common boussinesq external internal mode slitting algorithm is extended to include a third nbq mode step 1 the external mode is integrated between ti and ti δti with time step δte step 1a the nbq mode is first integrated with time step δtq from te to te δte and ρ q λ q are time averaged over te δte te δte to calculate their external mode equivalent ρ q e λ q e at te step 1b the external mode is advanced from te to te δte both coupling terms ρ q λ q and ζ e ρ v e λ e are time averaged over ti δti ti δti to be used in the internal mode at this point the complete solution at ti is available step 2 an iteration of the internal mode is carried out between ti and ti δti after step 1 total density ρ q is available for both the external and internal modes respectively through ρ q e and ρ q i variables are time averaged when they are exchanged between the nbq mode and the external or internal modes only the final value of the nbq component of density in a leapfrog formulation is needed 18 ρ q i ρ q e 1 2 ρ q t q ρ q t q δ t q this is similar to the treatment of the free surface anomaly which is computed in the external mode and exchanged with the internal mode 19 ζ e i 1 2 ζ e t e ζ e t e δ t e the rhs of the momentum equations are leapfrog averaged when communicated from nbq mode to large time step modes 20 λ q i 1 4 n e n q t q t t δ t i δ t q t i δ t i λ q t q 21 λ q e 1 2 n q t q t e δ t e δ t q t e δ t e λ q t q the latest value is exchanged between external or internal modes and nbq mode indeed 22 λ e q n q λ e t e t q and λ i q n q λ i t i t q these filtering are clearly time stepping dependent and the above averages are exclusively associated with the leapfrog scheme 3 5 stability of the three mode algorithm and pseudo acoustic regime the stability of the nbq mode and an accurate representation of the induced non hydrostatic processes by the external and internal modes are more important than an accurate representation of compressible processes the number of iterations nq nq δte δtq depends on the numerical properties of the linear system 14a 14c this system describes the propagation and damping due to second viscosity of linear acoustic waves subject to slowly varying forcing λ e q n q and λ i q n q at the rhs of momentum eqs 14a and 14b the inviscid formulation is given and discussed in appendix a eq a5 a simple unidirectional evaluation of the courant number for acoustic waves is given by coq cs δtq δx this means that the time step δtq depends on the space time discretization and on the pseudo acoustic wave velocity the lower this velocity the larger the time step the explicit damping due to the second viscosity can also lead to stability restrictions associated to the dedicated courant number co λ λδtq δx 2 nbq time step δtq must be primarily chosen based on these simple stability criteria to minimize computational cost the acoustic wave velocity cs can be reduced and the new system of equations is not compressible any more but pseudo compressible stability is consequently enhanced since courant number coq is proportional to cs a lower bound exists for the acoustic velocity and can be estimated on simple physical grounds acoustic waves have indeed been introduced in the three mode algorithm in order to propagate pressure anomalies if the velocity scale of the dynamical processes of interest is much slower than the acoustic wave velocity these acoustic waves can propagate pressure anomalies with very few interactions interferences or coupling with other dynamical processes this must still be the case in the pseudo acoustic regime which means that the pseudo acoustic velocity must be reasonably larger than the velocity scale of the dynamical processes say 5 to 10 times larger and less than real acoustic velocity here reasonably means here that incompressible dynamics must not be modified by any kind of spurious interactions interferences or coupling the lower bound for the acoustic velocity is thus associated to the fastest simulated processes we can anticipate that the second viscosity reduces this coupling by limiting the amplitude of the acoustic waves section 4 in this case the interactions interferences and more generally the coupling between the fast nbq non boussinesq mode and the external and internal modes do not disappear but their amplitude is reduced and their time scale can be enhanced skamarock and klemp 1992 such interactions or coupling can in particular occur due to the presence of the free surface which can lead to specific acoustic modes in terms of pressure this means that surface induced and non hydrostatic pressure anomalies are correlated as a consequence the implementation of the fast nbq mode in the external mode can lead to interactions requiring the reduction of the external mode time stepδte let α e δte δt e cfl be the reduction coefficient where δt e cfl is the maximum external time step associated to the courant number for the propagation of the fast long surface waves c o e g h δ t e δ x a situation with no acoustic coupling leads to α e 1 when the surface wave and pseudo acoustic wave velocities are separated by less than one order of magnitude interactions can occur requiring a smaller coefficient α e the closer to each other the velocities the smaller the coefficient the likely interactions of the free surface with the acoustic waves do not change the courant number requirements for the pseudo compressible modes 4 acoustic surface and internal waves in ocean configurations the ability of the complete three mode non boussinesq algorithm to represent acoustic surface and internal waves whether linear or not is now evaluated based on dedicated test configurations experiments a and b section 4 1 focus on the propagation and damping of acoustic waves experiment c section 4 2 focuses on the damping and dispersion of short length scale surface waves experiments d and e sections 4 3 and 4 4 focus on the generation propagation dispersion and damping of both linear and non linear non hydrostatic internal waves georges bank configuration is in particular revisited and compared to the boussinesq pressure correction implementation proposed by auclair et al 2011 the idea being to evaluate the ability of the new algorithm to deal with complex topographies and complex dynamics in the remaining sections auclair et al 2011 s pressure correction boussinesq algorithm is called nh whereas the present non boussinesq algorithm is called nbq when these algorithms are compared hereafter the nh pressure correction poisson system is solved using hips 2 2 http hips gforge inria fr solver 4 1 acoustic waves the propagation damping and reflexion of acoustic waves are first investigated in two dedicated configurations 4 1 1 experiment a spherical waves a rather simple configuration of generation and propagation of acoustic waves is now presented in order to verify the primary characteristics of acoustic waves waves are generated by a high frequency source of sound located at the centre of a 512 512 512 m closed domain this source is represented as a forced harmonic oscillation of the nbq component of density δρ no stratification is imposed and the fields of salinity and temperature are chosen uniform currents and surface displacements are initialized to zero in experiment a the phase velocity of acoustic waves is constant and equal to 1500 ms 1 table 1 gathers the primary numerical parameters of the chosen configuration cfl criteria related to acoustic waves and to a smaller extend surface gravity waves basically set the time steps section 3 5 dynamics is restricted to acoustic waves their propagation and reflection on solid walls is simulated by the nbq mode and their interaction with the free surface is given by both the external and nbq modes consequently nbq and external mode times steps δtq 0 1 ms δte 2 are chosen close to each other whereas internal mode time step is two orders of magnitude larger the implementation in the acoustic configuration is thus investigated in a 3d configuration with the complete three mode algorithm fig 2 shows a vertical section of the high frequency density anomaly δρ the propagation of spherical acoustic waves can be observed the front of the wave is observed to move at 1500 m s and its length scale is given by λ0 cst 0 1500 x 2 5 x 10 2 37 5 m in agreement with the linear theory of acoustic waves in the absence of viscosity the amplitude of the resulting 3d spherical acoustic wave can be shown to decrease as the inverse of the distance to the source r as its amplitude fits the analytical spherical wave a 0 r e 2 π i t t 0 r λ 0 within 1 4 with a standard deviation of 3 7 10 2 in the tank domain fig 2 shows reflections of the acoustic waves at the solid wall of the tank and at the free surface as well 3d acoustic waves can thus propagate in a dynamically coherent way with expected characteristics when compared to the linear theory of acoustic waves the cfl criteria associated with their fast phase velocity does not limit the internal mode time step that can be chosen two orders of magnitude larger δti 200δtq 4 1 2 experiment b acoustic wave filtering and reflexion in ocean configurations in experiment b acoustic waves are generated by the oscillations of the bottom topography appendix d two configurations are studied fig 3 the first one with high frequency oscillations focuses on the generation and propagation of small scale acoustic waves with vanishing surface waves the second one with lower frequency oscillations is dedicated to the generation of surface gravity waves with non vanishing acoustic waves in an ocean like configuration acoustic and surface gravity waves are generated by an oscillating sine shaped submarine mount of horizontal length scale l 0 numerical and physical parameters are presented in table 2 besides the frequency of the oscillations these two configurations have different vertical to horizontal length scale aspect ratio this ratio is equal to 1 in the acoustic wave configuration whereas it is less than 1 10 in the ocean configuration when not specified the kinematic and second viscosities vanish in both configurations fig 3 a and b show a vertical section of the density anomaly δρ after 10 forcing periods 0 1 s with a vanishing second viscosity coefficient fig 3a acoustic waves propagate obliquely from the oscillating mount toward the free surface along black solid lines before reflecting downward at the surface along black dashed lines the incident wave interferes with the reflected waves forming patterns of interferences the black arrow above the surface shows the distance over which the acoustic wave is supposed to have propagated after 10 periods law cs 10t 1 the wave length scale λ1 cst 1 l 0 confirms that the wave is generated by the oscillating bathymetry fig 3 b presents a similar acoustic wave configuration but this time the second viscosity coefficient does not vanish acoustic waves are damped compared to the previous configuration and the reflected waves have much lower amplitudes consequently the patterns of interferences have small amplitudes and their extensions are spatially limited the diffusion length scale λ d has the same order of magnitude as the depth fig 3 c shows the same configuration but for typical ocean scale ratios i e for a small vertical to horizontal aspect ratio in this case the length scale of the acoustic waves generated by the oscillations of the bathymetry is large compared to the ocean depth λ2 cst 2 100 m h 2 0 2 m and the horizontal resolution δx 0 1 m is of the same order of magnitude as the depth h 0 2 m a particularity of the proposed configuration is that the slope of the bathymetry is quasi horizontal and the resulting acoustic waves propagate quasi vertically the resulting up and down quasi vertical motion generates simple patterns of interferences with two maximum of vertical velocity in each column of water these waves reflect alternatively at the surface and at the bottom of the ocean they remain nearly invisible on fig 3c solid and dashed arrow show the position of respectively ascending and descending waves 4 2 surface gravity waves 4 2 1 experiment c natural oscillations of 10 10 m tank the surface oscillation of 10 10 m tank are now investigated in some details with the complete three mode algorithm amplitude and phase errors of the surface oscillations are more specifically investigated when acoustic wave phase velocity is varied in both compressible and pseudo compressible configurations the ability of the present algorithm to propagate short surface gravity waves is consequently evaluated in details following chen 2003 the initial free surface anomaly is given by 23 ζ x t 10 3 cos π 10 x tiny initial amplitudes only 1 mm are chosen to avoid the formation of non linear bores during long integrations for this simple configuration linear inviscid theory gives a period of natural oscillations of t0 3 59 s the primary numerical parameters of the experiments are given in table 3 with internal external and compressible nbq mode time steps respectively equal to 0 482 s 0 16 ms and 0 08 ms amplitude error are both less than 1 of the analytical solution after 10 periods meaning that the numerical solution can hardly be distinguished from the analytical solution when plotted as a function of time not shown with their pressure correction algorithm and the same internal and external mode leapfrog time stepping auclair et al 2011 uses an internal time step equal to 3 21 ms for an equivalent grid which is about 3 orders of magnitude smaller than the present internal time step δti 0 48 s this is a consequence of the non hydrostatic character of the small length scale surface wave whose induced velocity is not constant over the water column this z dependence is simulated by the 3d nbq mode in the three mode algorithm whereas with the pressure correction method of auclair et al this imposes strong stability constraints to the internal mode a consequence is that the barotropic baroclinic time splitting remains attractive when implemented with the three mode algorithm experiment c can provide further insight into the consequences of a lowering the acoustic wave velocity on the damping and dispersion of surface gravity waves fig 4 compares the amplitude 4a and phase 4b of the oscillations after 50 periods with linear inviscid theory amplitude and phase errors are expressed in percent of respectively the amplitude and phase of the analytical solution four sets of bars show the amplitude and phase errors when the velocity of pseudo acoustic waves is varied in order to vary as few parameters as possible the nbq time step remains equal to half the external time step the external mode is replaced by the non dimensional external mode coefficient α e let s recall that α e δte δt e cfl a non vanishing second viscosity is chosen for set 2 only fig 4 clearly shows the existence of a minimum phase velocity for acoustic waves bellow this minimum velocity of about 40 ms 1 both the amplitude and phase errors drastically increase this minimum velocity appears to be equal to 4 5 times the maximum velocity of the long surface gravity wave velocity equal to 10 ms 1 this can be explained by the physics of surface waves the pressure disturbances need to be fast enough to propagate the surface induced pressure anomalies over the water column this is also confirmed by the fact that a reduction of the time step by about 2 orders of magnitude between set 1 and set 4 does not reduce the errors with acoustic velocities lower than 40 ms 1 for phase velocities larger than 40 ms 1 now amplitude and phase errors show a rather weak dependence on acoustic velocity but as expected they vary with α e the lower this ratio and the time steps the lower the errors when α e is smaller than 0 05 amplitude and phase errors do not exceed a few percent when results of sets 1 and 2 are compared we can additionally observe that non vanishing second viscosity damping greatly extents the domain of stability of the three mode algorithm this confirms that damping acoustic waves reduces the coupling with the free surface the individual stability of the nbq mode section 3 5 is not problematic here when not damped acoustic waves can feed strong surface acoustic modes that in turn impose strong courant number limitations on the external time step 4 3 linear internal tides in ridge configuration experiment d experiment d simulates the generation of linear internal gravity waves in a non hydrostatic configuration this experiment is adapted from auclair et al 2014 and it is similar to experiment b internal wave are generated in a closed tank by the oscillation of a ridge like bathymetry simulating real ocean tidal oscillations auclair et al compared the nh implementation to the measurements in the cnrm game tank reaching the conclusion that their time varying bathymetry algorithm was adapted to direct numerical simulations the primary dynamical and numerical parameters are given in table 4 tank configuration external and nbq mode time steps have the same order of magnitude δtq 7 84 10 3 ms δte 2 but the internal mode time steps is two orders of magnitude larger δti 1 57 ms like in the experiments a and c internal mode time step is given by mode 1 internal gravity wave phase velocity see table 4 for the time step and courant number both external and nbq mode time steps are given by high frequency oscillations of bottom topography fig 5 shows a vertical section of the brunt väisälä frequency anomaly δn 2 internal wave rays can be observed in this subcritical case making an angle θ 42 5 0 5 in agreement with the dispersion relation given by linear inviscid theory sin θ 2π t 0 n 0 where t0 and n0 are respectively the period of ridge oscillations and the brunt väisälä frequency of the initial stratification see table 4 tank configuration rays reflect at the surface and bottom of the water column and at lateral walls in this configuration dedicated to linear rays of internal waves the consequences of lowering the acoustic wave velocity are now investigated the rms errors for the u w velocity fields are presented in fig 6 the rms error is defined as the square root of the mean of the squares of the difference between a given implementation and the reference implementation the reference implementation is the nbq configuration with a 1500 ms 1 acoustic wave phase velocity compressible configuration high velocity acoustic waves impose a small nbq time step δtq 7 8410 3 ms two sets of experiments have been carried out for nh and nbq configurations one using time steps similar to those of the reference configuration the other with the largest possible time steps the principal parameters are presented in table 4 test configuration fig 6 a d show the rms errors for nh and nbq configurations relative to the reference with pseudo acoustic wave phase velocities of 10 20 50 and 100 ms 1 pseudo compressible configuration fig 6 a and b show the rms errors obtained when all the configurations are integrated with the same time steps as the reference simulation whereas rms errors shown in fig 6 c and d are obtained for configurations with optimal larger time steps oscillations at half the forcing period can be observed and a quasi stationary error level is reached after 3 4 periods with small time steps equal to those of the reference simulation equivalent rms errors smaller than 10 3 are obtained for nbq configurations with acoustic velocities larger than 50 ms 1 and for the nh configuration rms errors for both components of velocity increase when the pseudo acoustic wave phase velocity is decreased reaching rms errors of 2 5 for a phase velocity of 10 ms 1 two sets of optimal time steps are shown in fig 6 c and d for the nh configurations nh o2 is integrated with an external mode time step equal to half the time step of the first configuration nh o1 this latter configuration shows rather large rms errors for both components of the velocity whereas the former nh o2 presents levels of rms errors at least one order of magnitude smaller indicating a strong dependence to the time step for pseudo acoustic wave velocities smaller than or equal to 20 ms 1 rms errors reach the same order of magnitude as nh o1 and are approximately one order of magnitude larger than those obtained for pseudo acoustic wave phase velocities strictly larger than 20 ms 1 a conclusion from the present set of linear internal wave experiments is that provided pseudo acoustic wave velocity larger than 20 ms 1 are specified nbq configurations show low levels of rms errors with respect to the reference realistic 1500 ms 1 implementation 4 4 non linear internal waves solitons two experiments of non linear internal waves are now investigated both of them being presented in details in auclair et al 2011 note that the pseudo acoustic wave phase velocity 4 ms 1 is only 0 27 of the realistic 1500 ms 1 phase velocity the first experiment e is a two layer tank configuration selected among horn et al 2001 s experiments the second experiment f is a vertical section of internal tides in the region of georges bank similar to the experiment investigated by lamb 1994 4 4 1 experiment e solitary waves in tank configuration table 5 gathers the primary physical and numerical parameters used to implement nh and nbq configurations of 4 6 solitary waves corresponding to horn et al regime 2 their figure 15 d oscillations of the pycnocline are obtained by forcing a tilt at initial time step fig 7 shows the resulting evolution in time of the depth of a middle pycnocline isopycnal surface for nbq dashed line and nh solid line models in both implementations a train of 6 solitary waves appears after 180 s the number of solitary waves decreasing to 5 and then 4 solitons after a few reflections at the lateral solid walls and approximately 350 s of simulation both the number of solitons and the arrival time of the train agree with experimental results described by horn et al 2001 and with the numerical results reported by hodge et al 2006 their figure 3 12 corresponding to scenario 3 interestingly enough nh and nbq configurations do not present any clear discrepancies a time bias of plus or minus two seconds can be observed in the nbq implementation with respect to the nh implementation no clear tendency can be highlighted for the amplitude of the oscillations of the pycnocline to conclude this first simulation of non linear internal solitarity waves nh and nbq algorithms provide density fields in agreement with measurements in tank and with numerical models found in the literature 4 4 2 experiment f georges bank solitary waves a vertical section across georges bank gulf of maine is now investigated like experiments c and e the resulting configuration is similar to the configuration presented by auclair et al 2011 in order to facilitate comparisons between the nh and nbq algorithms the numerical configuration is similar to the configuration simulated numerically and analysed by lamb 1994 as well the numerical parameters are given in table 6 m2 internal tide surface wave is introduced through the eastern offshore boundary condition this wave can propagate across georges bank shelf break and it leaves the domain through the western shoreward open boundary note that slow internal mode time step was restricted by a few hot spots locally high values of vertical advection courant number the simulated vertical section allows the investigation of the large non linear internal waves generated in the pycnocline region by strong tidal currents these internal waves are observed propagating both shoreward and off shore they owe their non linear character not only to the strength of tidal currents in the region but also to the steep slopes of the shelf break and to the moderate strength of the pycnocline cyclic transverse cross shore open boundary conditions permit the occurrence of along shore currents associated with coriolis traditional pseudo force solitary waves impose cfl criteria and consequently the internal mode time step is similar to the time step used in the nh pressure correction configuration by auclair et al 2011 fig 8 shows a vertical section of the total density field after 1 625 tidal period t 0 and should be compared with auclair et al s fig 5 a and with lamb s fig 6 m the three figures compare generally well solitary waves are generated by tidally induced motions above the shelf break and are propagating both shoreward and off shore after 1 625 t 0 depressions a1 and b1 generated during the first simulated tidal period are located at respectively about 28 and 14 km from the shelf break the location of depression a1 is approximately similar in the three simulations although the locations of depressions b1 differ by a few kilometres in these same numerical modelling studies the shoreward most location is observed in lamb experiment before nbq and nh implementations fig 9 a and b present cross shore and vertical components of velocity after only one tidal period t 0 and should now be compared with lamb s fig 7 a and b and auclair et al s fig 5 a and b the comparisons of the velocity components show close agreements between the three modelling studies minima and maxima of velocities have similar locations and their vertical structures are in close agreements amplitude of velocity anomaly whether shoreward or cross shore are also similar as a conclusion these results show that in this demanding ocean configuration nbq and nh implementations provide close and realistic high frequency high resolution ocean circulation nbq algorithm presenting density and velocity fields with amplitude ranging between those obtained by lamb 1994 and auclair et al 2011 5 discussion conclusion time split approaches are currently used in weather forecast models skamarock and klemp 2008 to explicitly integrate sound waves with a smaller time step to our knowledge the explicit simulation of such waves in free surface ocean models based on a barotropic baroclinic time splitting is original under the boussinesq assumption the mathematical degeneracy of the non hydrostatic problem leads to the necessity to solve a large and more importantly global 3d poisson system at each internal mode time step no such system needs to be solved when acoustic waves are explicitly simulated with the three mode time splitting a consequence is that surface induced non hydrostatic processes such as short surface gravity waves can be represented with the external and compressible nbq modes exclusively imposing stability constraints on these two modes only the internal mode time step can consequently be considerably increased compared to the pressure correction method making the barotropic baroclinic time splitting in non hydrostatic models particularly attractive since the details of the propagation of the acoustic waves are not of primary interest to simulate non hydrostatic incompressible slow processes the present study confirms that the velocity of the acoustic waves can be reduced to limit courant number restrictions three wave configurations surface gravity internal gravity and acoustic waves have been studied in the former configuration oscillations of the free surface the physical coupling of the non hydrostatic and surface induced components of pressure appears as a key aspect of the three mode free surface algorithm errors on the amplitude and phase shift of the surface oscillations have been shown to remain acceptable in pseudo acoustic regimes as long as the acoustic wave velocity is larger than 5 times the velocity of long surface gravity waves linear internal wave rays have then been studied in a moving ridge tank configuration to evaluate rms errors of the velocity field with respect to the 1500 ms 1 acoustic wave configuration once again as long as pseudo acoustic wave velocity remains larger than both surface and internal wave velocities i e faster than the fastest dynamical processes in the numerical domain the amplitude of the rms errors remains low reaching a stationary level after a few forcing periods non linear configurations of internal waves and in particular solitary waves have been studied in a tank configuration and in a realistic ocean scale configuration in both cases the three mode algorithm compares well with similar analytical studies experiments a b and c with measurements in tanks experiments d and e with in situ observations experiment f or with other modelling studies published in the literature experiments c d e and f in the present study test cases show that the three mode algorithm is well adapted to parallel implementations although details are left to a future manuscript the three mode algorithm is also rooted in the navier stokes equations and as such can be used in the future as a standard to evaluate new non hydrostatic algorithms future studies should now assess the ability of the three mode splitting algorithm to simulate compressible dynamics acknowledgments we gratefully thank the computer team of the laboratoire d aérologie for nuwa our laboratory cluster together with calmip hyperion and cines jade for computer resources the present study has been supported by the anr projects piwo contract number anr 08 blan 0113 and comodo anr 11 monu 005 appendix a consequences of the boussinesq assumptions csq i boussinesq momentum is approximated by ρ v ρ 0 v first order approximation with respect to the density anomaly leading to an approximate conservation eq 6a csq ii neglecting the density anomalies with respect to a chosen reference state leads to an approximate form of the conservation of mass 6b once depth integrated and combined with the unchanged kinematic conditions 3 4 the conservation of mass transforms into the conservation of the volume of the water column a1 h ζ t h ζ v x x h ζ v y y another consequence of the approximation of the continuity eq 6b through the boussinesq assumption is the mathematical transformation of the resulting system of equations from a hyperbolic formulation to an elliptic formulation in terms of acoustic waves acoustic waves are supposed to propagate with an infinite velocity the filtering of these fast numerically demanding waves is justified by the boussinesq approximation in large scale and even in regional and coastal scale ocean modelling csq iii continuity equation further loses its status of prognostic equation for density a consequence being that boussinesq momentum equations must be solved under the vanishing divergence constraint 6b whereas density can be diagnosed using the eos in hydrostatic boussinesq models vertical velocity is also usually diagnosed using the continuity equation and in non hydrostatic boussinesq models this equation is a constraint for which pressure becomes the lagrange multiplier salmon 1998 p 313 315 csq iv the dependence of the density in the total pressure through the eos cannot be maintained under the boussinesq assumption leading to eos 6d the dependence in ρ0 gz provides a consistent boussinesq energy conservation law young 2010 and shchepetkin and mcwilliams 2011 further show that a stiffened formulation is to be preferred to a more accurate formulation using the free surface anomaly ρ0 g ζ z which can create a vertical shear in surface induced barotropic currents leading to cross dependencies when barotropic baroclinic mode splitting is implemented csq v boussinesq assumption provides a consistent framework to study ocean dynamics in association with its own bernoulli like formulation of energy conservation young 2010 a number of processes in terms of ocean circulation are excluded bulk compressibility processes such as acoustic waves as already stated above their elimination is precisely one of the reasons of the popularity of the assumption the steric effect is not excluded it only has to be adjusted using the constraint on total ocean mass griffies and greatbatch 2012 dynamical processes related for instance to surface heating which can be crudely simulated whereas details are incorrectly depicted mellor and ezer 1995 the linear propagation of small amplitude acoustic waves across a compressible isentropic inviscid non rotating homogeneous ρ ρ0 ocean initially at rest satisfies a simplified version of equations 1a d a2 ρ 0 δ v t δ p a3 δ ρ t ρ 0 δ v a4 δ p c s 2 δ ρ where gravity has been neglected and anomalies associated with the acoustic waves are written δ v δ p δ ρ this leads to the following hyperbolic propagation equation for acoustic waves a5 2 δ p t 2 c s 2 δ δ p 0 or equivalently 2 δ ρ t 2 c s 2 δ δ ρ 0 under the boussinesq equation a3 degenerates to a6 δ v 0 and pressure anomalies satisfy the elliptic equation a7 δ δ p 0 the computational cost of this large 3d linear system required by pressure projection and pressure correction methods must then be compared with the computational cost of high frequency acoustic waves global systems potentially require a larger portion of global communications whereas local systems require communications with neighbours and are thus adapted to massively parallel implementation consequently both the computational performances and the scalability of the resulting boussinesq ocean model depend essentially on the performances of the poisson solver implemented to calculate pressure increment non boussinesq dynamics is hyperbolic in terms of acoustic waves and it is consequently associated with severe cfl criteria for the computation of these high velocity waves appendix b non boussinesq system of equations in σ coordinates τhe present version of the three mode algorithm is implemented in σ coordinates the algorithm has no particular reason to be restricted to this particular vertical coordinates and can be formulated for any type of vertical coordinates a formulation of the equations of the three mode algorithm is given in the present appendix σ coordinates can be introduced by writing b1 z x y σ t σ h x y t ζ x y t h x y t σ h x y t h x y t where h is defined by h z σ at the surface z ζ σ 1whereas at the bottom z h σ vanishes model bathymetry h can further be made time dependent auclair et al 2014 momentum equations in σ coordinates in σ coordinates the non boussinesq system of equations can be expressed in flux form as follows b2a h ρ v t σ h z h p h h z δ p δ ρ h g a d v h ρ v h δ f c ν δ σ h ρ v λ h ρ v b2b h ρ t σ h ρ u x σ h ρ v y σ ρ v σ σ d i v σ h ρ v b2c h ρ θ s t σ h u ρ θ s x h v ρ θ s y ρ v σ θ s σ h ρ ϕ θ ϕ s h ρ b2d ρ ρ θ s p ρ b q θ s ρ 0 g z ρ p θ s δ p δ ρ where the divergence operator div σ is d i v σ h ρ v h ρ u x σ h ρ v y σ ρ v σ σ the vertical velocity across σ surfaces v σ h d σ d t is related to the vertical velocity w by b3 w x y σ t d z d t v σ d z d t σ v σ z t σ u z x σ v z y σ v σ σ d ζ d t σ 1 d h d t σ subscribe indicates that the derivative is computed along σ surfaces the newly defined vertical velocity v σvanishes both at the bottom and at the surface of the water column the conservative formulation of the advection in σ coordinates for momentum is b4 ρ d v d t z ρ v t z u ρ v x z v ρ v y z w ρ v z 1 h h ρ v t σ h ρ v u x σ h ρ v v y σ ρ v v σ σ relation b4 additionally defines the flux advective operator to optimize computations one needs another assumption in the present non boussinesq algorithm since in the momentum equations b2a the viscous diffusion operators are related to integrated momentum h ρ v not to velocity as they should a common difficulty of the formulation of non hydrostatic models in σ coordinates concerns the vertical velocity indeed both the cross σ v σ and true vertical w velocities need to be computed the latter with b2a whereas the former is a diagnostics based for instance on b3 appendix c space discretization of the divergence and gradient operator to ensure correct energy transfers the gradient operator implemented in the non hydrostatic pressure force and the divergence operator implemented in the continuity equation cannot be treated independently for readability both operators are now expressed as functions of coefficients α β these coefficients detailed in appendix c 3 are functions of the grid parameters and are given in the x z vertical layer c 1 divergence operator k 1 k max σ h ρ v i k h ρ u i 1 2 k h ρ u i 1 2 k δ x ρ w i k 1 2 ρ w i k 1 2 z x σ ρ u i k 1 2 z x σ ρ u i k 1 2 the space discretization of the last terms in brackets is inner layers k 1 k max z x σ ρ u i k 1 2 α i 1 2 k 1 ρ u i 1 2 k 1 β i 1 2 k ρ u i 1 2 k α i 1 2 k 1 ρ u i 1 2 k 1 β i 1 2 k ρ u i 1 2 k surface layer k k max 1 2 z x σ ρ u i k max 1 2 β i 1 2 k max 1 2 ρ u i 1 2 k max 1 2 β i 1 2 k max 1 2 ρ u i 1 2 k max 1 2 bottom layer k 1 2 z x σ ρ u i 1 2 α i 1 2 1 2 ρ u i 1 2 1 2 α i 1 2 1 2 ρ u i 1 2 1 2 c 2 non hydrostatic pressure gradient operator the gradient operator implemented in the non hydrostatic pressure force is a first order scheme similar to the one proposed by auclair et al 2011 it is written in the following for the non boussinesq pressure increment but is applied to the non boussinesq density increment in the nbq mode as the two variables are related by the linear eos b2d i horizontal component k 1 k max δ p x z i 1 2 k δ p i 1 k δ p i k δ x z i 1 k z i k δ x δ p z i 1 2 k the vertical pressure component at point i 1 2 k is given by inner layers k 1 k max δ p z i 1 2 k 1 4 δ p i 1 k 1 δ p i k 1 δ p i 1 k δ p i k δ z i k 1 2 δ p i 1 k δ p i k δ p i 1 k 1 δ p i k 1 δ z i k 1 2 surface layer k k max 1 2 δ p z i 1 2 k max 1 2 0 δ p i 1 k max δ p i k max δ z i 1 2 k max 1 2 i vertical component inner layers k 1 k max δ p z i k 1 2 δ p i k 1 δ p i k δ z i k 1 2 surface layer k k max 1 2 δ p z i k max 1 2 0 δ p i k max δ z i k max 1 2 c 3 α β grid parameters inner layers k 1 k max α i 1 2 k z i 1 k z i k 4 δ x δ z i 1 2 k δ z i 1 2 k 1 2 z i 1 k z i k 4 δ x δ σ i 1 2 k δ σ i 1 2 k 1 2 k 1 k max β i 1 2 k z i 1 k z i k 4 δ x δ z i 1 2 k δ z i 1 2 k 1 2 z i 1 k z i k 4 δ x δ σ i 1 2 k δ σ i 1 2 k 1 2 surface layer k k max 1 2 α i 1 2 k max 1 2 β i 1 2 1 2 0 and β i 1 2 k max 1 2 ζ i 1 ζ i 2 δ x bottom layer k 1 2 α i 1 2 1 β i 1 2 k max 0 and α i 1 2 1 2 h i 1 h i 2 δ x appendix d time varying bathymetry in non boussinesq mode splitting auclair et al 2014 show that bathymetry can be made time varying with only few adaptations in a free surface non hydrostatic model its implementation in the new non boussinesq mode splitting algorithm is straightforward model variable for surface anomaly is first replaced by the variations of the water column total depth i e surface plus bathymetry the surface pressure gradient and the vertical position of the model grid have then to be corrected from the motion of the bottom topography a specificity of auclair et al 2011 s nh algorithm is the possibility to specify boundary conditions independently for the divergence d and gradient m operators before constructing the laplacian operator δ dm a direct consequence is that new bottom boundary conditions can be specified in terms of the horizontal and vertical components of the velocity identical matrix operators are used in the nbq algorithm to compute the nbq mode equations consequently the nbq boundary conditions associated with a varying bathymetry remains similar to those implemented in auclair et al s nh algorithm d1 u z h u b a t h y m e t r y w z h w b a t h y m e t r y 
24067,a three mode time split algorithm 1 2 hydrostatic assumption 1 3 boussinesq assumption 2 from compressible navier stokes equations to boussinesq assumption 2 1 compressible navier stokes equations 2 2 boussinesq approximation 2 3 density and pressure decomposition 3 the three mode non hydrostatic algorithm 3 1 decomposition of the momentum equations 3 2 treatment of the continuity equation conservation of mass 3 3 external and internal modes 3 4 three mode time splitting 3 5 stability of the three mode algorithm and pseudo acoustic regime 4 acoustic surface and internal waves in ocean configurations 4 1 acoustic waves 4 1 1 experiment a spherical waves 4 1 2 experiment b acoustic wave filtering and reflexion in ocean configurations 4 2 surface gravity waves 4 2 1 experiment c natural oscillations of 10 10 m tank 4 3 linear internal tides in ridge configuration experiment d 4 4 non linear internal waves solitons 4 4 1 experiment e solitary waves in tank configuration 4 4 2 experiment f georges bank solitary waves 5 discussion conclusion acknowledgments appendix a consequences of the boussinesq assumptions appendix b non boussinesq system of equations in σ coordinates momentum equations in σ coordinates appendix c space discretization of the divergence and gradient operator c 1 divergence operator c 2 non hydrostatic pressure gradient operator appendix d time varying bathymetry in non boussinesq mode splitting auclair 2011 49 70 f auclair 2014 1 9 f blumberg 1987 1 16 a threedimensionalcoastaloceanmodels adescriptionathreedimensionalcoastaloceancirculationmodel chen 2003 929 952 x chorin 1967 12 26 a casulli 1999 425 440 v deszoeke 2002 2194 2203 r dewar 2015 149 157 w dukowicz 1992 336 347 j durran 2012 1307 1325 d gattibono 2006 589 615 c gerkema 2007 t greatbatch 2001 1911 1923 r griffies 2004 496 s fundamentalsoceanclimatemodels griffies 2012 s hodges 2006 44 64 b horn 2001 181 207 d huang 2002 2131 2151 r janjic 2003 271 285 z lamb 1994 843 864 k lamb 2004 k lemarie 2015 124 148 f mahadevan 1996 1868 1880 a marsaleix 2008 61 89 p marshall 1997 5733 5753 j marshall 1999 1 64 j mellor 1995 20557 20565 g ogura 1962 173 179 y salmon 1998 378 r lecturesgeophysicalfluiddynamics shchepetkin 2011 41 70 a skamarock 1992 2109 2127 w skamarock 2008 3465 3485 w tailleux 2010 339 382 r vallis 2006 745 g atmosphericoceanicfluiddynamics young 2010 394 400 w auclairx2018x12 auclairx2018x12x29 auclairx2018x12xf auclairx2018x12x29xf 2020 10 05t00 00 00 000z 2020 10 05t00 00 00 000z http creativecommons org licenses by nc nd 4 0 2018 elsevier ltd all rights reserved item s1463 5003 18 30264 6 s1463500318302646 1 s2 0 s1463500318302646 10 1016 j ocemod 2018 07 011 272136 2023 04 27t08 09 05 272356z 2018 12 01 2018 12 31 1 s2 0 s1463500318302646 main pdf https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 main application pdf 070235fbcc75bf75bfe8b170bf5cb957 main pdf main pdf pdf true 4523908 main 18 1 s2 0 s1463500318302646 main 1 png https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 preview image png 1d3a24ebf19d4f00a34091fe5dd7cde5 main 1 png main 1 png png 54609 849 656 image web pdf 1 1 s2 0 s1463500318302646 gr1 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr1 thumbnail image gif bc050caa2e1049a0b820070dc80674ef gr1 sml gr1 gr1 sml sml 6579 163 103 image thumbnail 1 s2 0 s1463500318302646 gr2 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr2 thumbnail image gif 24891d90cd4ab8d5118562123a03d399 gr2 sml gr2 gr2 sml sml 15262 164 197 image thumbnail 1 s2 0 s1463500318302646 gr3 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr3 thumbnail image gif 4830fb4e4a978f63ce077e43c03d1300 gr3 sml gr3 gr3 sml sml 16122 134 219 image thumbnail 1 s2 0 s1463500318302646 gr4 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr4 thumbnail image gif 6e777c6d3d35238879bbecae01c9ec78 gr4 sml gr4 gr4 sml sml 10138 118 219 image thumbnail 1 s2 0 s1463500318302646 gr5 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr5 thumbnail image gif 0636bde2647dcb7a17f3cf20d68a70fc gr5 sml gr5 gr5 sml sml 19350 134 219 image thumbnail 1 s2 0 s1463500318302646 gr6 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr6 thumbnail image gif f3922e466ebb62d3da1c1ea7be4829c5 gr6 sml gr6 gr6 sml sml 11759 120 219 image thumbnail 1 s2 0 s1463500318302646 gr7 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr7 thumbnail image gif 26b938413772bcfaa8f4276ac1e7e65a gr7 sml gr7 gr7 sml sml 7436 91 219 image thumbnail 1 s2 0 s1463500318302646 gr8 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr8 thumbnail image gif f800a35800817fbc747e15ea164a1cc4 gr8 sml gr8 gr8 sml sml 8129 92 219 image thumbnail 1 s2 0 s1463500318302646 gr9 sml https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr9 thumbnail image gif 3cb0eddac13e3cb1af84f810828daab7 gr9 sml gr9 gr9 sml sml 13449 163 182 image thumbnail 1 s2 0 s1463500318302646 gr1 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr1 downsampled image jpeg c0eae884f1da85690ea1eba1e6c7ee23 gr1 jpg gr1 gr1 jpg jpg 64815 893 563 image downsampled 1 s2 0 s1463500318302646 gr2 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr2 downsampled image jpeg 824b651c413c3c4d817c848e2d0ab305 gr2 jpg gr2 gr2 jpg jpg 99637 438 527 image downsampled 1 s2 0 s1463500318302646 gr3 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr3 downsampled image jpeg f61502aa756d883561fff925f12a57e4 gr3 jpg gr3 gr3 jpg jpg 63966 414 678 image downsampled 1 s2 0 s1463500318302646 gr4 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr4 downsampled image jpeg 719191c350bd9027711bf7eb24c045cc gr4 jpg gr4 gr4 jpg jpg 66741 364 678 image downsampled 1 s2 0 s1463500318302646 gr5 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr5 downsampled image jpeg 88359ffb4f3489bf93e7409f5f7b7542 gr5 jpg gr5 gr5 jpg jpg 45120 344 563 image downsampled 1 s2 0 s1463500318302646 gr6 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr6 downsampled image jpeg 179918ff6b2729ebd6fafda23f024bfc gr6 jpg gr6 gr6 jpg jpg 88107 390 713 image downsampled 1 s2 0 s1463500318302646 gr7 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr7 downsampled image jpeg 8697360fb463c1dfe50fc9d18c5655e5 gr7 jpg gr7 gr7 jpg jpg 37218 280 676 image downsampled 1 s2 0 s1463500318302646 gr8 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr8 downsampled image jpeg d7f252c1e5ea86d6817d21dc16947d56 gr8 jpg gr8 gr8 jpg jpg 43021 268 638 image downsampled 1 s2 0 s1463500318302646 gr9 jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr9 downsampled image jpeg 46afe24bf834872c23b18738bf904a29 gr9 jpg gr9 gr9 jpg jpg 72515 607 676 image downsampled 1 s2 0 s1463500318302646 gr1 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr1 highres image jpeg 10f7dcd8606e608606f5108d3e9f3227 gr1 lrg jpg gr1 gr1 lrg jpg jpg 390532 3956 2494 image high res 1 s2 0 s1463500318302646 gr2 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr2 highres image jpeg 28c452394165ae18622b2da0e1a1afc0 gr2 lrg jpg gr2 gr2 lrg jpg jpg 671299 1940 2333 image high res 1 s2 0 s1463500318302646 gr3 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr3 highres image jpeg 040da5a7a258e025299c6eea15e84d00 gr3 lrg jpg gr3 gr3 lrg jpg jpg 440401 1832 3000 image high res 1 s2 0 s1463500318302646 gr4 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr4 highres image jpeg 49854b5a0fa01bead1bd5ebeb19435f0 gr4 lrg jpg gr4 gr4 lrg jpg jpg 333661 1611 3000 image high res 1 s2 0 s1463500318302646 gr5 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr5 highres image jpeg 5f9f36c6bbf4deb8a1634b2ad9885998 gr5 lrg jpg gr5 gr5 lrg jpg jpg 310488 1524 2494 image high res 1 s2 0 s1463500318302646 gr6 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr6 highres image jpeg be1dc49a7c06044cfc55b3da26abdd1d gr6 lrg jpg gr6 gr6 lrg jpg jpg 543797 1726 3159 image high res 1 s2 0 s1463500318302646 gr7 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr7 highres image jpeg ef08b2430e64eab31af6f65b084957b7 gr7 lrg jpg gr7 gr7 lrg jpg jpg 200447 1240 2994 image high res 1 s2 0 s1463500318302646 gr8 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr8 highres image jpeg 4cef838909ea2f8b67fce2e4afcd53e3 gr8 lrg jpg gr8 gr8 lrg jpg jpg 295716 1186 2827 image high res 1 s2 0 s1463500318302646 gr9 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 gr9 highres image jpeg 3d6b1f0c0d4fa5acc8498cfdf1ac033b gr9 lrg jpg gr9 gr9 lrg jpg jpg 469840 2687 2992 image high res 1 s2 0 s1463500318302646 si1 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 99c411a5338035f78f0a38d070b9718f si1 gif si1 si1 gif gif 1625 42 378 altimg 1 s2 0 s1463500318302646 si10 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 55ab5ba8bda796537fd29235d3cddf38 si10 gif si10 si10 gif gif 1656 44 369 altimg 1 s2 0 s1463500318302646 si100 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f8f81966abf7fe2851b442f8f9193576 si100 gif si100 si100 gif gif 1722 17 473 altimg 1 s2 0 s1463500318302646 si11 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 62fb0b6c9a625b34b053ab6c88ba81c9 si11 gif si11 si11 gif gif 275 18 37 altimg 1 s2 0 s1463500318302646 si12 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a97d8db4a792904138e11fe4192c43f3 si12 gif si12 si12 gif gif 653 27 165 altimg 1 s2 0 s1463500318302646 si13 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 09dde3fe24596fae034c39735e31e4cb si13 gif si13 si13 gif gif 1350 45 308 altimg 1 s2 0 s1463500318302646 si14 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 84d1bd327acc786102557e447c7ac755 si14 gif si14 si14 gif gif 293 19 64 altimg 1 s2 0 s1463500318302646 si15 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 51f4d4e2587be1f8144c4c0efbfa4c6c si15 gif si15 si15 gif gif 711 19 164 altimg 1 s2 0 s1463500318302646 si16 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 9d99c76b4ba319ff490ddc9db159cbbd si16 gif si16 si16 gif gif 2393 77 460 altimg 1 s2 0 s1463500318302646 si17 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6e3c8db69c08b742cc9c4221d3a93971 si17 gif si17 si17 gif gif 461 28 85 altimg 1 s2 0 s1463500318302646 si18 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4785e979bffba7ebc77dccfb159e2e37 si18 gif si18 si18 gif gif 902 34 166 altimg 1 s2 0 s1463500318302646 si19 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 72dbae57b6acccf7828c9c079ae6b0ac si19 gif si19 si19 gif gif 1923 74 381 altimg 1 s2 0 s1463500318302646 si2 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif d8c08331d7506725cb34ab3b1e8e8dbd si2 gif si2 si2 gif gif 708 38 121 altimg 1 s2 0 s1463500318302646 si20 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4adf74e9083fc4316b87f91fcd7b9e8e si20 gif si20 si20 gif gif 428 13 104 altimg 1 s2 0 s1463500318302646 si21 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b3b28dd28f8d41252a093e33ba6d1dd2 si21 gif si21 si21 gif gif 2906 45 675 altimg 1 s2 0 s1463500318302646 si22 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3bf8b9627d3990450a25952e497dddfa si22 gif si22 si22 gif gif 708 38 120 altimg 1 s2 0 s1463500318302646 si23 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fed85a579273a540b1740fe540bbc0d7 si23 gif si23 si23 gif gif 2473 44 523 altimg 1 s2 0 s1463500318302646 si24 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f57e8f1b638e4f5445a972957db4348e si24 gif si24 si24 gif gif 1962 77 367 altimg 1 s2 0 s1463500318302646 si25 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 11761b7e5f18a129ca07bd5c63ca9ac7 si25 gif si25 si25 gif gif 234 18 32 altimg 1 s2 0 s1463500318302646 si26 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3d73b7c74738692d178ae7381bde58f5 si26 gif si26 si26 gif gif 1874 74 374 altimg 1 s2 0 s1463500318302646 si27 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 0a1e9760f1ed197ac54aa8bec9652523 si27 gif si27 si27 gif gif 829 41 173 altimg 1 s2 0 s1463500318302646 si28 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 802900e5f070d9e506c4eb44ef5d84d7 si28 gif si28 si28 gif gif 556 24 142 altimg 1 s2 0 s1463500318302646 si29 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3c1f30594d0ca24e38d9ab412e04a52b si29 gif si29 si29 gif gif 1910 45 442 altimg 1 s2 0 s1463500318302646 si3 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 2fdc184514e2a45b06a64d139524c1f2 si3 gif si3 si3 gif gif 989 41 171 altimg 1 s2 0 s1463500318302646 si30 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6626f96366eb3dd4d76d00b03c235f16 si30 gif si30 si30 gif gif 2064 34 525 altimg 1 s2 0 s1463500318302646 si31 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 709768c9033b4d8ef057ddd093f05156 si31 gif si31 si31 gif gif 273 21 36 altimg 1 s2 0 s1463500318302646 si32 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4bf51e36abb60f0e061fbe716b1d9393 si32 gif si32 si32 gif gif 283 23 34 altimg 1 s2 0 s1463500318302646 si33 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 59b8b65c8fc2c76a93e188f0ab03bad0 si33 gif si33 si33 gif gif 1622 68 270 altimg 1 s2 0 s1463500318302646 si34 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 4c0ab91f944ce4a9c2218f89690a4cfe si34 gif si34 si34 gif gif 606 21 129 altimg 1 s2 0 s1463500318302646 si35 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5b2fd6617bc98e557502a56ab63a3dbb si35 gif si35 si35 gif gif 362 17 81 altimg 1 s2 0 s1463500318302646 si36 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f31df361e83d324741e7ce8cd5efea2b si36 gif si36 si36 gif gif 3934 84 722 altimg 1 s2 0 s1463500318302646 si37 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 93ac04babd41598decbc3a14fbeeb4a4 si37 gif si37 si37 gif gif 3808 82 717 altimg 1 s2 0 s1463500318302646 si38 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif e81b51e07cbacd326bc2cfd4d43ea01a si38 gif si38 si38 gif gif 2430 47 504 altimg 1 s2 0 s1463500318302646 si39 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5592be57f0b8cd3faacb6e82ea295c9f si39 gif si39 si39 gif gif 545 23 108 altimg 1 s2 0 s1463500318302646 si4 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 125ac76328b870ab6910cb0792b4e5a9 si4 gif si4 si4 gif gif 511 17 112 altimg 1 s2 0 s1463500318302646 si40 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1991cdb34b77361ef02aecf0488d77ed si40 gif si40 si40 gif gif 324 18 35 altimg 1 s2 0 s1463500318302646 si41 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a18b2673b16b68e243a44984ab317fd9 si41 gif si41 si41 gif gif 2366 68 463 altimg 1 s2 0 s1463500318302646 si42 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b266c832edff87a26799886e52adbc2a si42 gif si42 si42 gif gif 2194 40 542 altimg 1 s2 0 s1463500318302646 si43 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 9915f16cfcdd394a88f542a61e1375db si43 gif si43 si43 gif gif 577 17 153 altimg 1 s2 0 s1463500318302646 si44 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 44c4ca7673e2786dbaa3085e81dcc26c si44 gif si44 si44 gif gif 4998 115 851 altimg 1 s2 0 s1463500318302646 si45 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a59ebdb31305617d911968a9e9ccc288 si45 gif si45 si45 gif gif 4545 115 764 altimg 1 s2 0 s1463500318302646 si46 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3dce9dff774c622b3d6299040502c7b3 si46 gif si46 si46 gif gif 1756 47 285 altimg 1 s2 0 s1463500318302646 si47 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b3f4c0961a36e1eeb6cd3dc8179a36ae si47 gif si47 si47 gif gif 3877 56 837 altimg 1 s2 0 s1463500318302646 si48 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6d47d347c7c73877c4ce974c10bd7bd1 si48 gif si48 si48 gif gif 778 19 177 altimg 1 s2 0 s1463500318302646 si49 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif cb9c6f202138fb233031690c0b7d6b8e si49 gif si49 si49 gif gif 293 23 40 altimg 1 s2 0 s1463500318302646 si5 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fddc3109e76fd5fbd89b00a1e960b422 si5 gif si5 si5 gif gif 418 17 98 altimg 1 s2 0 s1463500318302646 si50 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3ba78671d597be69d9a49d03b8218aed si50 gif si50 si50 gif gif 403 24 65 altimg 1 s2 0 s1463500318302646 si51 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 0d0a61e66c3807929ff6af8ffaa252c6 si51 gif si51 si51 gif gif 569 24 106 altimg 1 s2 0 s1463500318302646 si52 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif bf6d210247f908da5d3a8a4cd1770995 si52 gif si52 si52 gif gif 657 23 114 altimg 1 s2 0 s1463500318302646 si53 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 84fc979fdbe87492e774d54c8e652336 si53 gif si53 si53 gif gif 281 17 37 altimg 1 s2 0 s1463500318302646 si54 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 09529c4b5a0a38edf43a01c9525d7e6b si54 gif si54 si54 gif gif 1207 40 248 altimg 1 s2 0 s1463500318302646 si55 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 40a6770f7c85d3d12612b9fe5d48e678 si55 gif si55 si55 gif gif 881 40 179 altimg 1 s2 0 s1463500318302646 si56 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif d8924a0ef9d8b7c54ee1b1e563a2dd30 si56 gif si56 si56 gif gif 1421 59 242 altimg 1 s2 0 s1463500318302646 si57 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 2bccbf65799bf33d4fe57be0c63d76cb si57 gif si57 si57 gif gif 1327 59 227 altimg 1 s2 0 s1463500318302646 si58 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f5309ce2ff6e505fa407e4d340e6d327 si58 gif si58 si58 gif gif 1285 39 267 altimg 1 s2 0 s1463500318302646 si59 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif cc91f89abfdd10a65f6e8083de2484aa si59 gif si59 si59 gif gif 358 24 47 altimg 1 s2 0 s1463500318302646 si6 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 9e74d1d6f51be7fe61d10ec2d2ddb010 si6 gif si6 si6 gif gif 175 18 14 altimg 1 s2 0 s1463500318302646 si60 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b1faa83c7fe824b019773e01a1a23d76 si60 gif si60 si60 gif gif 345 24 45 altimg 1 s2 0 s1463500318302646 si61 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5318b9b49de65c547ae97de7aea1312b si61 gif si61 si61 gif gif 829 19 169 altimg 1 s2 0 s1463500318302646 si62 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f176b7b89564afda8e37d3b8658420b2 si62 gif si62 si62 gif gif 658 24 142 altimg 1 s2 0 s1463500318302646 si63 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 49fda017b723fc60ced9d2053d3665c1 si63 gif si63 si63 gif gif 977 36 197 altimg 1 s2 0 s1463500318302646 si64 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif b5173add0b6c2b35dc0f97fb1e2e15ee si64 gif si64 si64 gif gif 403 18 76 altimg 1 s2 0 s1463500318302646 si65 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif cc0acb49e21f9d4f566ebe59cd9b3811 si65 gif si65 si65 gif gif 1512 44 332 altimg 1 s2 0 s1463500318302646 si66 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fb40ba51ff3d813f1f96360e90699cc7 si66 gif si66 si66 gif gif 756 41 129 altimg 1 s2 0 s1463500318302646 si67 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1c8c2a6289920ffc9d7209d86178e596 si67 gif si67 si67 gif gif 908 38 145 altimg 1 s2 0 s1463500318302646 si68 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 8fd40dcbcdbf25d576803514f9e6a710 si68 gif si68 si68 gif gif 471 23 82 altimg 1 s2 0 s1463500318302646 si69 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 149caeee9ccbe928bc823c3e2279d895 si69 gif si69 si69 gif gif 517 18 91 altimg 1 s2 0 s1463500318302646 si7 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 6dcde31fa3c83d5932cb07bd22cbc170 si7 gif si7 si7 gif gif 584 22 137 altimg 1 s2 0 s1463500318302646 si70 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 645433b29fed9c05eecfba1634a878fc si70 gif si70 si70 gif gif 2432 46 476 altimg 1 s2 0 s1463500318302646 si71 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 98a0ec45fa8efcd1987ced53ca19d375 si71 gif si71 si71 gif gif 535 22 89 altimg 1 s2 0 s1463500318302646 si72 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a5f658338bc044bebc639f555fc852f3 si72 gif si72 si72 gif gif 458 17 86 altimg 1 s2 0 s1463500318302646 si73 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fff069fea8f90fd642d83cd85a3026e0 si73 gif si73 si73 gif gif 2012 23 611 altimg 1 s2 0 s1463500318302646 si74 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 11cb91141853aa6ee39e2d9c5961eace si74 gif si74 si74 gif gif 3302 47 725 altimg 1 s2 0 s1463500318302646 si75 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 05a357f707fe8e2218aa63e89aef45cc si75 gif si75 si75 gif gif 2177 76 319 altimg 1 s2 0 s1463500318302646 si76 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif c69dba615dc3e7448ea7b76d9b9477ec si76 gif si76 si76 gif gif 2861 47 595 altimg 1 s2 0 s1463500318302646 si77 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 595858c667ad0e72de51bc4f5c7ca470 si77 gif si77 si77 gif gif 1457 28 328 altimg 1 s2 0 s1463500318302646 si78 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1347e06b9992e09e245e4c8fdff50976 si78 gif si78 si78 gif gif 391 25 74 altimg 1 s2 0 s1463500318302646 si79 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 91d4454dae3739d4a4a15061cad10a73 si79 gif si79 si79 gif gif 3117 47 727 altimg 1 s2 0 s1463500318302646 si8 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 42b6ce490ce23a39fcdc6c3942546d7b si8 gif si8 si8 gif gif 1566 42 357 altimg 1 s2 0 s1463500318302646 si80 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 17066431dd6a96a41ce5c7ec948caa0f si80 gif si80 si80 gif gif 4684 102 522 altimg 1 s2 0 s1463500318302646 si81 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 5b09561d073bbed0c10cc5227617c265 si81 gif si81 si81 gif gif 463 18 58 altimg 1 s2 0 s1463500318302646 si82 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 2fc03f31f385e92951840e0ff6217c4c si82 gif si82 si82 gif gif 407 16 96 altimg 1 s2 0 s1463500318302646 si83 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1409db250a06b91d27c7368a3275969a si83 gif si83 si83 gif gif 4186 56 900 altimg 1 s2 0 s1463500318302646 si84 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif afb42a2929bb3d0f6a841fabc3503532 si84 gif si84 si84 gif gif 3094 52 761 altimg 1 s2 0 s1463500318302646 si85 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 1391c55f1731bd238ae3e97d25487244 si85 gif si85 si85 gif gif 546 24 116 altimg 1 s2 0 s1463500318302646 si86 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 8324a80151230144c20999302e69ce4f si86 gif si86 si86 gif gif 2069 27 561 altimg 1 s2 0 s1463500318302646 si87 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif f451a4e9e73ed6ed872c55c73e2a9582 si87 gif si87 si87 gif gif 324 24 60 altimg 1 s2 0 s1463500318302646 si88 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 83b0ae7ca59d420c05693bb2df825435 si88 gif si88 si88 gif gif 1544 27 394 altimg 1 s2 0 s1463500318302646 si89 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3827a2f469131df370c2f1301c3c0ac7 si89 gif si89 si89 gif gif 1306 28 332 altimg 1 s2 0 s1463500318302646 si9 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 460750ae9f15d02bc736be7654c8c734 si9 gif si9 si9 gif gif 1452 42 392 altimg 1 s2 0 s1463500318302646 si90 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a0bb88390e67b74ce4e60152ed42a578 si90 gif si90 si90 gif gif 385 24 73 altimg 1 s2 0 s1463500318302646 si91 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 11f9c12d5a7857f19d53e6808d2bc24b si91 gif si91 si91 gif gif 3205 50 740 altimg 1 s2 0 s1463500318302646 si92 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif be4dfcab9df0d88ddca5e7dbab606ced si92 gif si92 si92 gif gif 1248 35 256 altimg 1 s2 0 s1463500318302646 si93 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif fc17ec1ea01eeba5b8c85266913db2d9 si93 gif si93 si93 gif gif 885 29 178 altimg 1 s2 0 s1463500318302646 si94 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 91f9284aed8a3d43ede0b9170a393455 si94 gif si94 si94 gif gif 973 35 174 altimg 1 s2 0 s1463500318302646 si95 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 257cad1f0132d3cdac13172a63a80575 si95 gif si95 si95 gif gif 3583 83 476 altimg 1 s2 0 s1463500318302646 si96 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif ce213e31d0118bfc0fc062f35c5aadd5 si96 gif si96 si96 gif gif 690 22 193 altimg 1 s2 0 s1463500318302646 si97 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif a63d5b35b77dff154405d79e2d2cceb6 si97 gif si97 si97 gif gif 703 27 153 altimg 1 s2 0 s1463500318302646 si98 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif d424c31b5fb9fadb90aea8c5be7b2232 si98 gif si98 si98 gif gif 676 22 170 altimg 1 s2 0 s1463500318302646 si99 gif https s3 amazonaws com prod ucs content store us east content pii s1463500318302646 stripin image gif 3f1c7972ad6b182f774879fb8b4820f6 si99 gif si99 si99 gif gif 608 28 142 altimg 1 s2 0 s1463500318302646 am pdf am am pdf pdf 4460993 aam pdf https s3 eu west 1 amazonaws com prod ucs content store eu west content egi 101qnh89fnt main application pdf f2bbc0e6947a02c4f17742fc9ee564f9 am pdf https s3 amazonaws com prod ucs content store us east content egi 101qnh89fnt main application pdf f2bbc0e6947a02c4f17742fc9ee564f9 am pdf ocemod 1327 s1463 5003 18 30264 6 10 1016 j ocemod 2018 07 011 elsevier ltd fig 1 schematic representation of nh a and nbq b time splitting algorithm light gray white and dark gray arrows are associated respectively with internal external and nh nbq modes horizontal arrows represent leapfrog evolution in time and remaining arrows indicate exchanges between the various modes and consequently the way they are updated for interpretation of the references to color in this figure legend the reader is referred to the web version of this article fig 1 fig 2 experiment a vertical section of density non boussinesq anomaly δρ in kg m 3 after 20 s of acoustic forcing at the centre of the 3d domain distances are given in meters fig 2 fig 3 experiment b vertical section of density anomalies a and b after 80 ms in kg m 3 and of vertical velocity c after 2 5 s in m s 1 a acoustic configuration with a vanishing second viscosity b acoustic configuration with a non vanishing second viscosity c ocean like configuration black arrows direction of propagation of acoustic waves solid lines and downward propagating reflected acoustic waves dashed lines blue arrows direction of propagation of surface gravity waves for interpretation of the references to color in this figure legend the reader is referred to the web version of this article fig 3 fig 4 experiment c amplitude a and phase b errors with respect to linear inviscid theory as functions of the wave phase velocity in ms 1 after 50 natural oscillation periods bar colors indicates the set of experiments obtained for different external mode coefficients set 1 α e 0 1 set 2 α e 0 1 and λ 1 m 2 s 1 set 3 α e 0 05 set 4 α e 0 01 errors are given in percent of the initial amplitude a and of the natural oscillation period b fig 4 fig 5 experiment d vertical section of square brunt väisälä pulsation anomaly rad2s 2 after 10 forcing periods simulated numerically with nbq algorithm this figure can be compared with auclair et al 2014 s fig 1 they plotted the same vertical section of square brunt väisälä pulsation anomaly a measured by synthetic schlieren and b simulated numerically with nh algorithm fig 5 fig 6 experiment d rms errors of horizontal a c and vertical b d velocity components during the first 5 forcing periods for small 1500 m s 1 phase velocity time steps a b and optimally adjusted time steps b d a c rms errors are plotted for nh configuration dashed line 10 ms 1 solid line 20 ms 1 solid line and signs 50 ms 1 solid line and diamonds and 100 ms 1 solid line and lower triangle phase velocity nbq configurations b d rms errors are plotted for nh configurations dashed line for set o1 of optimal parameters and dashed line and for set o2 of optimal parameters 10 ms 1 solid line 20 ms 1 solid line and signs 50 ms 1 solid line and diamonds and 100 ms 1 solid line and lower triangle phase velocity nbq configurations fig 6 fig 7 experiment e depth of the mid pycnocline isopycnal surface in meters as a function of time in second dashed line nh configuration solid line nbq configuration fig 7 fig 8 experiment f vertical sections of the total density anomaly in kg m 3 horizontal distances are given en km and depths in meters fig 8 fig 9 experiment f vertical sections of cross shore a and vertical b components of the velocity ms 1 horizontal distances are given en km and depths in meters fig 9 table 1 primary characteristics of experiment a table 1 size of the domain m li lj h max 512 512 512 number of points of model grid in x and y direction i max j max 512 512 horizontal model grid m δx δy 1 σ levels k max 512 equally spaced levels total simulation time s 20 internal mode time step ms δti 22 external mode time step ms δte 0 22 compressible mode time step ms δtq 0 11 acoustic courant number coq 0 165 phase velocity of pseudo acoustic waves ms 1 cs 1500 kinematic viscosity m2 s 1 ν 0 second viscosity m2 s 1 λ 0 asselin filter parameter 10 3 diffusivity m2 s 1 kd 0 amplitude kg m 3 s 1 e folding m and period of forcing ms a 0 l 0 t 0 1000 2 5 25 table 2 model parameters for experiment b in acoustic and ocean like configurations table 2 acoustic configuration ocean like configuration size of the tank m li h max 4 1 0 4 25 6 0 2 number of points of model grid in x and y direction i max j max 4096 1 256 1 horizontal model grid m δx δy 10 3 0 1 σ levels kmax 40 equally spaced levels 20 equally spaced levels mount height m h 0 0 1 0 1 mount horizontal scale m l 0 sine shaped mount 0 4 gaussian shaped mount 1 gaussian mount oscillations amplitude m period s a 0 t 0 10 4 10 2 10 2 10 total simulation time s 2 5 2 5 internal mode time step ms δti 6 2 10 2 4 3 external mode time step ms δte 3 1 10 2 0 43 nbq mode time step ms δtq 1 6 10 2 0 22 acoustic courant number coq horizontal vertical 0 16 0 16 0 02 0 22 phase velocity of pseudo acoustic waves ms 1 cs 10 10 kinematic viscosity m2 s 1 ν 0 0 second viscosity m2 s 1 λ 0 10 2 0 asselin filter parameter 10 3 10 3 diffusivity m2 s 1 kd 10 9 10 9 table 3 model parameters for experiment c table 3 size of the tank m li h max 10 10 number of grid points of model grid in x and y direction i max j max 100 1 horizontal model grid m δx δy 0 1 σ levels k max 100 equally spaced levels total simulation time s 180 internal mode time step ms δti set 1 2 642 set 3 482 set 4 96 external mode time step ms δte set 1 2 0 32 set 3 0 16 set 4 0 032 nbq mode time step ms δtq cfl requirements section 3 5 up to 0 16 ms surface gravity wave courant number coe set 1 2 0 032 set 3 0 016 set 4 0 0032 phase velocity of pseudo acoustic waves ms 1 cs 40 equation of state compressible kinematic viscosity m2 s 1 ν 10 7 second viscosity m2 s 1 λ 0 or 1 asselin filter parameter 10 2 table 4 model parameters for experiment d in tank configuration auclair et al 2014 and test configurations table 4 tank configuration test configurations size of the tank m li h max 4 0 394 1 0 2 number of points of model grid in x and y direction i max j max 4096 1 256 1 horizontal model grid m δx δy 10 3 4 10 3 σ levels k max 400 equally spaced levels 100 equally spaced levels gaussian mount height m h 0 0 1 0 05 gaussian mount horizontal scale m l 0 3 86 10 2 3 86 10 2 gaussian mount oscillations amplitude m period s a0 t0 10 3 10 05 10 3 10 brunt väisälä pulsation rad s 1 n 0 92461 1 total simulation time s 50 25 50 25 internal mode time step ms δti 1 57 3 46 external mode time step ms δte 1 57 10 2 8 67 10 4 nbq mode time step ms δtq 7 8410 3 4 34 10 4 internal wave courant number for mode 1 internal waves coiw 0 2 0 2 phase velocity of pseudo acoustic waves ms 1 cs 10 100 50 20 10 equation of state 16 linear linear kinematic viscosity m2 s 1 ν 10 6 10 6 second viscosity m2 s 1 λ 10 3 10 4 asselin filter parameter 10 3 10 5 diffusivity m2 s 1 kd 10 9 10 9 table 5 model parameters for experiment e table 5 size of the tank m li h max 6 0 29 number of points of model grid in x and y direction i max j max 60 1 horizontal model grid m δx δy 0 1 σ levels k max 74 equally spaced levels internal mode time step ms δti nbq 37 4 nh 37 4 total simulation time s 400 external mode time step ms δte nbq 0 934 nh 18 7 nbq mode time step ms δtq nbq 0 093 nh two layer density difference kg m 3 δρ 20 horn s parameter δ 0 45 horn s parameter γ 0 3 phase velocity of pseudo acoustic waves ms 1 cs 4 equation of state 16 linear kinematic viscosity m2 s 1 ν 10 6 second viscosity m2 s 1 λ 0 1 asselin filter parameter nbq 0 1 nh 0 3 diffusivity m2 s 1 kd 10 7 table 6 model parameters for georges bank experiment experiment f table 6 size of the domain m 67 500 45 260 number of points of model grid in x and y direction i max j max 4500 3 cyclic boundary conditions in y direction horizontal model grid m δx δy 15 σ levels k max 100 equally spaced levels total simulation time day 1 internal mode time step ms δti 458 1 external mode time step ms δte 4 58 nbq mode time step ms δtq 0 115 phase velocity of pseudo acoustic waves ms 1 cs 60 surface acoustic wave courant number coe coq 0 015 0 0027 vertical advection courant number cow 0 08 with local hot spots equation of state compressible and linear kinematic viscosity m2 s 1 ν 10 5 horizontally half of the diffusive part of the upstream advective scheme second viscosity m2 s 1 λ 102 asselin filter parameter 10 3 diffusivity m2 s 1 kd 10 6 open boundary layer flow relaxation scheme forcing m2 tidal period t 0 h 12 4 coriolis parameters 10 4 0 a non hydrostatic non boussinesq algorithm for free surface ocean modelling f auclair a l bordois a b y dossmann b a t duhaut a a paci a c ulses a c nguyen a a laboratoire d aérologie université de toulouse cnrs ups france laboratoire d aérologie université de toulouse cnrs ups france b cnrm game gmei spea cnrs météo france toulouse france cnrm game gmei spea cnrs météo france toulouse france corresponding author a three mode time split algorithm is proposed to simulate non hydrostatic ocean processes in a natural way fast pressure adjustments via acoustic waves are explicitly represented the full set of compressible navier stokes equations is integrated for a free surface ocean with three time steps respectively associated to the internal external and compressible non boussinesq modes the resulting three mode algorithm can be implemented either in a fully compressible configuration or in a pseudo compressible configuration by artificially lowering acoustic wave velocities to reduce computational costs the present description of the three mode algorithm focuses in the first place on the simulation of non hydrostatic processes in free surface ocean models several test simulations related to linear and non linear acoustic surface and internal gravity waves are studied in details with the proposed three mode algorithm 1 introduction fast pressure adjustments in fluids occur primarily through acoustic waves these adjustments are closely related to the bulk compressibility of fluid and the system of navier stokes equations includes physical processes at all ocean scales spreading from general circulation to high velocity sound waves not to mention surface gravity waves in the last decades three types of approaches have basically been proposed to deal with acoustic waves in weather forecast models to filter these high velocity waves ogura and phillips 1962 and many others ever since imposed the anelastic approximation as a consequence a global 3d poisson system has to be solved at every time step durran and blossey 2012 did not impose such approximation and proposed to simulate high velocity acoustic waves using an implicit explicit multistep method courant number restrictions are circumvented using an implicit scheme but a global helmholtz 3d equation must be solved avoiding solving large 3d systems of equations janjic 2003 proposed this time to simulate explicitly acoustic waves based on a time split approach propagation of sound waves is permitted with a small courant number limited time step and a large time step is used for atmospheric slower processes all those approaches have in common the necessity to simulate the consequences of the transient adjustments due to acoustic waves but they all care much less about the details of the propagation of the acoustic waves only the result of the faster transients is then of interest still with the objective to limit courant number restrictions chorin 1967 proposed to reduce acoustic wave velocity leading to an artificial compressibility several atmospheric numerical models see skamarock and klemp 2008 for a complete list can thus simulate faster pressure adjustments in a natural way these models are particularly well adapted to modern massively parallel computing they are based on local in space and time equations and do not require solving global systems in non hydrostatic ocean models pressure correction boussinesq algorithms have been preferred since marshall et al 1997 because acoustic waves are four to five times slower in the atmosphere than in the ocean one could at first conclude that their simulation imposes stronger courant number restrictions in the ocean and that it is consequently much more expensive than in the atmosphere the treatment of bulk compressibility and acoustic waves are of the same nature in the atmosphere and in the ocean but the spectral gap between faster incompressible dynamics and acoustic waves is larger in the ocean non hydrostatic effects are naturally associated to acoustic waves as a consequence acoustic wave dynamics can be viewed as a natural solver for hydrodynamic pressure in the same way as in atmospheric models the consequences of the transient compressible adjustments of pressure are of interest and we propose to retain bulk compressibility or at least artificial or pseudo compressibility to simulate non hydrostatic pressure adjustments in otherwise incompressible ocean configurations the main originality compared to atmospheric models lies in the implementation of a compressible non boussinesq mode in a free surface ocean model which is already based on a barotropic baroclinic time split approach this leads to a three mode time split algorithm 1 1 a three mode time split algorithm since blumberg and mellor 1987 most ocean models simulate long surface gravity waves with a barotropic baroclinic time splitting we propose to make one further step in this time split strategy by implementing a third compressible non boussinesq mode in the barotropic hereafter external mode this 2d mode remaining itself embedded in the slow baroclinic hereafter internal mode the resulting three mode algorithm is consequently based on three time steps the smaller being dedicated the fast 3d dynamics of acoustic or pseudo acoustic waves this leads to a limited number of modifications in existing numerical models i the boussinesq or anelastic approximations must be abandoned ii momentum rather than velocity becomes a prognostic variable iii the vertical velocity must be prognosticated at the internal mode time step through the corresponding momentum equation and iv the time splitting must be extended to include a third faster compressible mode to propagate acoustic waves in its present implementation the three mode algorithm is however less general than a full navier stokes model as only the linear advection free acoustic part of the dynamics is solved with a small time step and the sound speed remains constant requiring temperature and salinity to be computed only at the larger internal mode time step 1 2 hydrostatic assumption we can wonder why in the first place the hydrostatic assumption should be revoked in ocean models the reason is essentially to provide an accurate description of wave dynamics and to introduce non hydrostatic processes such as vertical motions in convective chimneys marshall and schott 1999 non hydrostatic dispersion in solitary waves lamb 2004 or the non traditional component of the coriolis force leading to more accurate representation of the vorticity balance gerkema et al 2007 following vallis 2006 chapter 2 7 it can be shown that to be in hydrostatic equilibrium a homogeneous ocean must have small aspect ratio ε h l 1 with h and l the vertical and horizontal length scales whereas a stratified ocean must satisfy fr 2ε2 1 with fr v nh n a typical brunt väisälä frequency and v an horizontal velocity scale several approaches have been proposed to circumvent the hydrostatic approximation for a boussinesq flow marshall et al 1997 casulli 1999 auclair et al 2011 pure pressure projection boussinesq algorithms chorin 1967 require to first step forward momentum equations before adjusting the non hydrostatic pressure a 3d poisson system must then be solved for pressure correction methods additionally require that an up to date non hydrostatic pressure force is taken into account when advancing momentum equations first step and only an increment of the non hydrostatic pressure is calculated by solving for the 3d poisson system dukowicz and dvinsky 1992 mahadevan et al 1996 marshall et al 1997 and many others an additional difficulty with non hydrostatic modelling in free surface ocean models is associated to the strong coupling of the non hydrostatic and surface induced components of the pressure field auclair et al 2011 to our knowledge none of these non hydrostatic algorithms is based on an explicit simulation of acoustic waves in the context of a free surface ocean 1 3 boussinesq assumption large to regional scale ocean models most often rely on both the boussinesq and hydrostatic assumptions leading to a description of the ocean in which buoyancy has a central role in more or less the same way as the anelastic approximation restricts the range of atmospheric processes the boussinesq assumption is justified by the small deviations of the ocean density from a reference value and it provides an efficient framework to study slow large scale processes which are characterized by small vertical to horizontal length scale ratios it basically decouples the dynamics and thermodynamics of the ocean filters out acoustic waves and leads to a mathematical degeneracy of the non hydrostatic system of equations the filtering of the acoustic waves transforms the initially hyperbolic system of equations into an elliptical system boussinesq flows conserve volume but not mass leading to discrepancies in the transient adjustment processes following for instance the surface heating of the ocean huang and jin 2002 another consequence of the boussinesq assumption concerns the way energy is transferred between the kinetic and potential compartments tailleux 2010 when combined the boussinesq and hydrostatic assumptions provide a simple valuable and accurate representation of slow and large scale ocean processes nevertheless the access to ever more efficient computing facilities associated to the desire to improve the simulated dynamics by for instance extending the space time spectrum toward high frequencies and small scales lead oceanographers to question and then circumvent these assumptions shchepetkin and mcwilliams 2011 section 5 greatbatch et al 2001 propose to reconsider the concept of velocity to conserve mass velocity should indeed not be considered as the result of a reynolds averaging but rather as the result of a favre averaging when the objective is mainly to recover the non boussinesq steric effect under the hydrostatic assumption without reintroducing the acoustic waves deszoeke and samelson 2002 have shown that pressure coordinates constitute a valuable choice a divergent formulation of the velocity field can instead be obtained by improving the accuracy with respect to the density anomalies dewar et al 2015 these aspects are not further investigated numerically hereafter the modelling of the steric effect with the present three mode non boussinesq algorithm should be investigated in a following study following time split approaches currently implemented in weather forecast models and adapting these approaches to the context of a free surface ocean we propose to abandon both the hydrostatic and boussinesq approximations first of all the acoustic waves are reintroduced in order to recover mathematical hyperbolicity from this standpoint the proposed algorithm can thus be viewed as a physical solver for non hydrostatic ocean flows in terms of parallel computing a consequence is that computations are local in space limiting the perspectives to a simple reduction of computational cost would be over simplistic since conservation of mass can also be advantageously recovered by integrating in time the full continuity equation the proposed algorithm additionally leads to the recovering of a physical i e non boussinesq treatment of the kinetic to internal and gravitational potential energy exchanges the three mode algorithm provides de facto another way to deal with the pressure dependence of the eos by re introducing a first order pressure dependence of the density second viscosity is also reintroduced in the momentum equations since velocity divergence does not vanish any more the corresponding damping process can be considered as an efficient natural filter for acoustic waves this second viscosity filter is equivalent to the selective numerical filter proposed by skamarock and klemp 1992 to damp divergent modes in their atmospheric model section 2 is dedicated to the density and pressure decomposition the non boussinesq mode splitting algorithm is then described in details in section 3 auclair et al 2011 s test configurations and the compressible configurations of acoustic waves are revisited in section 4 discussion and conclusions are finally given in section 5 2 from compressible navier stokes equations to boussinesq assumption 2 1 compressible navier stokes equations full compressible navier stokes system in cartesian z coordinates is given by 1a ρ d v d t p ρ g δ f c ρ ν δ v ρ λ v 1b ρ t ρ v 1c d θ s d t ϕ θ ϕ s 1d ρ ρ θ s p where v u v w is the velocity p the total pressure ρ the density θ the potential temperature s the salinity ν the constant kinematic viscosity and λ the constant bulk or second viscosity hereafter both viscosities are assumed homogeneous to simplify notations the second velocity participates to the damping of acoustic waves the lagrangian derivative of momentum varies according to eq 1a with the pressure force the weight the coriolis pseudo force and the viscous diffusion the second viscosity diffusion is an efficient filter in term of numerical cost whereas it is also the natural filter for acoustic waves on the right hand side rhs of the heat and salinity evolution equations 1c ϕ θ and ϕ s gather compressibility and diabatic processes 1 1 following for instance griffies 2004 chapter 5 right hand side of 1c can be decomposed in a diffusion flux and a source term the last equation is the general eos for seawater density is a function of potential temperature salinity and total pressure the coriolis pseudo force can be written in a compact form ω being the earth angular velocity 2 δ f c 2 ρ ω v at the surface of the ocean the boundary condition is given by the continuity of the pressure field and viscous stress tensor the presence of a free surface additionally imposes a non trivial kinematic condition at z ζ with ζ the free surface anomaly 3 w z ζ ζ t u z ζ ζ x v z ζ ζ y at the bottom z h with h the ocean depth the no permeability kinematic condition leads to 4 w z h u z h h x v z h h y the depth integral of the continuity eq 1b can be combined with the kinematic conditions 3 and 4 to obtain an evolution equation for the mass of a water column 5 h ζ ρ t h ζ ρ u x h ζ ρ v y where the overbar stands for vertical depth average over the water column 2 2 boussinesq approximation the formulation of the boussinesq assumption first requires that a thermodynamical equilibrium state be chosen as a reference the corresponding reference density ρ0 is homogeneous and stationary the boussinesq approximation then requires that bq i density anomalies ρ ρ0 are negligible with respect to the reference density bq ii the vertical scale h ρ over which this density field varies is much larger than the ocean vertical scales h ρ 1 1 ρ ρ z h 1 both requirements are satisfied with a reasonable accuracy less than a few percent by large scale fields whereas atmospheric dynamics is commonly studied using the less restrictive anelastic assumption bq i under the boussinesq assumption the compressible navier stokes system 1 5 simplifies to 6a d v d t 1 ρ 0 p ρ ρ 0 g 2 ω v ν δ v 6b v 0 6c d θ s d t ϕ θ ϕ s 6d ρ ρ b q θ s ρ 0 g z thermodynamically speaking the boussinesq equation of state 6d for seawater can only relate density temperature and salinity to an approximation of pressure the high frequency component of the total pressure field being filtered out leading to the so called seawater boussinesq approximation young 2010 the boussinesq assumption has several additional consequences recalled in appendix a 2 3 density and pressure decomposition first order pressure dependence can be retained in eos 1d 7 ρ ρ θ s p ρ 0 ρ b q θ s p ref ρ p θ s δ p o δ p 2 δ ρ where ρ p θ s 1 c s 2 with c s θ s p p ρ θ s the velocity of acoustic waves and p ref is a chosen reference pressure a decomposition of the pressure field follows 8 p p atm ρ 0 g ζ z z ζ ρ b q ρ 0 g d z p h δ p with p atm the atmospheric pressure at the surface of the ocean ph the hydrostatic component based on the boussinesq component of density and δpthe non hydrostatic increment of pressure the reference pressure p ref must then be chosen for the numerical configurations presented in the following the reference pressure is the hydrostatic pressure for a homogeneous constant reference density it is equal to the depth dependent reference pressure used in the boussinesq eos 6d i e 9 p ref ρ 0 g z for the same type of expansion dewar et al 2015 choose the static pressure caused by p atm and by a mean density profile as a reference pressure because the sound speed cs θ s p depends on the potential temperature salinity and pressure the compressible or non boussinesq pressure δp and density δρ anomalies are not linearly correlated in a general case we disregard this dependence in the experiments that follow for simplicity considering for simplicity that atmospheric pressure is also constant the non boussinesq system of equations can now be written in a conservative form 10a ρ v t ρ u v x ρ v v y ρ w v z h p h δ p δ ρ g δ f c ρ ν δ v ρ λ v 10b ρ t ρ v 10c ρ θ s t ρ u θ s x ρ v θ s y ρ w θ s z ρ ϕ θ ϕ s 10d ρ ρ θ s p ρ b q θ s ρ 0 g z ρ p θ s δ p δ ρ where h is the horizontal component of the gradient in cartesian coordinates the decomposition of density 10d is thus partially in line with the expansion proposed by dewar et al 2015 butph is here supposed to be in hydrostatic equilibrium with ρ bq whereas dewar et al more generally consider that the boussinesq field can be at least partly non hydrostatic the proposed algorithm also differs from theirs by retaining the full expression of the continuity equation and as a consequence the acoustic waves no additional terms need to be implemented in the present vertical momentum equations to provide an accurate kinetic to internal energy conversion the decomposition of the pressure field can finally be compared with the one used in a pressure correction algorithm 11 p p atm ρ 0 g ζ z z ζ ρ b q ρ 0 g d z p h q where q is the boussinesq non hydrostatic pressure correction obtained by solving a 3d poisson system in eq 8 δpis the non hydrostatic pressure increment linearly associated to the non hydrostatic density anomaly δρ through 10d 3 the three mode non hydrostatic algorithm the three mode splitting algorithm is now detailed and we implement it into a boussinesq hydrostatic free surface ocean models already based on a baroclinic barotropic time splitting in the first place this algorithm aims at simulating fast pressure adjustments leading to non hydrostatic dynamics 3 1 decomposition of the momentum equations momentum eq 10a include in their rhs both slow fast and very fast terms respectively computed in the internal external and compressible or non boussinesq nbq modes 12 ρ v t λ i λ e λ q the operators λ λ x λ y λ z can be written 13a 13a λ i ρ u v x ρ v v y ρ w v z h p h δ f c ρ ν δ v 13b λ q δ p δ ρ g ρ λ v c s 2 δ ρ δ ρ g ρ λ v by depth integrating the horizontal component of the slowest terms one obtains the component corresponding to the external mode λ e and to its internal mode residue λ i 13c λ e λ i x e λ i y e 0 and λ i λ i λ e relations 13c express a common external internal mode splitting based on the momentum decomposition ρ v ρ v ρ v under boussinesq assumption this decomposition is applied to velocity not to momentum relation 13b makes the additional assumption that non linear advective processes do not evolve at very fast time scales this leads to linear acoustics but is fully relevant if we focus on non hydrostatic processes the three mode algorithm can then be implemented in two different ways either with a realistic acoustic velocity the algorithm is then in a compressible configuration or with a lower unrealistic acoustic velocity we shall then talk about pseudo compressible configuration time steps for the nbq external and internal modes are respectively written δtq δte nq δtq and δti ne δte recalling that δtq δte δti the three mode algorithm is now discretized with a simple low order and well known leapfrog time stepping the advantages simplicity well known treatment of the conservation of energy marsaleix et al 2008 of this implementation together with its main drawbacks stability only when associated to an asselin like time filter optimal numerical properties under a reduced range of courant numbers and phase shift in the propagation of high frequency waves are known and well documented lemarié et al 2015 the present use of the leapfrog scheme is thus to be viewed as a reference implementation which undoubtedly needs to be followed by a detailed analysis of a comparative analysis of higher order space time schemes 3 2 treatment of the continuity equation conservation of mass the full non boussinesq continuity eq 1b is central to the three mode algorithm it enforces conservation of mass and through its various formulations it is used to prognosticate the surface elevation anomaly eq 5 to compute the cross σ vertical velocity appendices b and c and it is at the root of the flux formulation of advection eq b 4 it can also appear in the computation of the grid depth in σ coordinates and more generality in s coordinates the presentation of the algorithm is now restricted to x z plane without loss of generality and the velocity is v u w the grid is supposed to move vertically at the internal mode time step and to remain steady during the integration of the nbq mode details of σ grid implementation are given in appendix b the continuity equation can alternatively be reformulated in function of w after substitution of relation b3 if ni ne nq are the time step indices for the internal external and nbq modes the fast compressible nbq mode can be written 14a ρ u n q 1 ρ u n q 1 2 δ t q c s 2 δ ρ n q x z λ 2 ρ u n q x 2 λ 2 ρ w n q x z λ n b q x n q 2 δ t q λ e n e λ i x n i 14b ρ w n q 1 ρ w n q 1 2 δ t q c s 2 δ ρ n q z δ ρ n q g λ 2 ρ u n q z x λ 2 ρ w n q z 2 λ n b q z n q 2 δ t q λ i z n i 14c δ ρ n q 1 δ ρ n q 1 2 δ t q ρ b q t n i 2 δ t q ρ u n q x ρ w n q z the system has been reduced to 3 equations with 3 unknowns by substituting the non boussinesq pressure anomaly by the non boussinesq density anomaly 15 δ p n q c s 2 δ ρ n q several choices have been made to end up with nbq system 14 the most significant being the use of ρ and ρ v as prognostic variables the resulting system is linear in this couple of variables once again this choice is dictated by the necessity to end up with a discrete approximation of 14c that is both conservative and accurate this treatment is different from the approach proposed by gatti bono and colella 2006 to solve for the compressible euler equations gatti bono and colella indeed chose to decompose both the density and thus pressure and momentum fields the divergence operator of the second viscosity is additionally applied to the momentum and not to the velocity as in 13b to optimize computations the linear operators which are necessary to compute the pressure force the second viscosity operator and the divergence of momentum in 14 are directly derived from the gradient and divergence matrices defined by auclair et al 2011 and are given in appendix c in σ coordinates the originality of the approach proposed therein is to compute separately the matrices for the divergence and gradient operators the laplacian operator was then obtained by a matrix multiplication this procedure permits a consistent discretization of the divergence and gradient matrices in terms of energy conservation and facilitates the formulation of the bottom surface and lateral boundary conditions linear eq 14 a and b can thus be reformulated in matrix vector notations the fluxes related to the second viscosity are linear and do not require the computation of any new operators the system of equations of the nbq mode is linear and an integration of the nbq mode basically consists in three matrix vector multiplications two for the momentum eq 14a and one for the continuity eq 14b 3 3 external and internal modes external and internal modes are already discussed in auclair et al 2011 and only a short description is given hereafter for surface wave and more generally barotropic dynamics the depth integrated momentum and continuity equations can be formulated as 16a ρ u n e 1 ρ u n e 1 2 δ t e ρ 0 g ζ n e x λ e n e 2 δ t e λ q x e n e λ i x n i 16b ρ q n e 1 h ζ n e 1 ρ q n e 1 h ζ n e 1 2 δ t e h ζ n e ρ u n e x where e and hereafter i stand for time averages at respectively external and internal time steps in eq 16b the bottom topography and as a consequence the σ coordinate grid appendix b can additionally vary with the slow internal mode time step appendix d and auclair et al 2014 the total density ρ q is the summation of the reference density with the boussinesq low frequency and non boussinesq anomalies ρ q ρ 0 ρ b q δ ρ in this expression the boussinesq component is equal to its latest available value the low frequency internal mode system of equations is 17a ρ u n i 1 ρ u n i 1 2 δ t i ρ 0 g ζ n i x x z ζ n i ρ b q n i g d z u ρ u x i n i w ρ u z i n i δ f c x n i i ν δ ρ u i n i 1 λ i x n i 2 δ t i λ q x i n i 17b ρ w n i 1 ρ w n i 1 2 δ t i z z ζ n i ρ b q n i g d z u ρ w x i n i w ρ w z i n i δ f c z n i i ν δ ρ w i n i 1 λ i z n i 2 δ t i λ q z i n i 17c ρ w i z i n i ρ q t i n i ρ u i x i n i 17d ρ q i n i 1 θ n i 1 s n i 1 ρ q i n i 1 θ n i 1 s n i 1 2 δ t ρ u θ s x i n i 1 ρ w θ s z i n i 1 ρ n i ϕ θ n i ϕ s n i 17e ρ b q ρ b q θ s ρ 0 g z several differences need to be acknowledged between the present formulation of external and internal modes and their pressure correction formulation proposed by auclair et al 2011 as momentum rather than velocity becomes the prognostic variable both the external and internal modes need to be reformulated in terms of momentum the velocity field might be needed by the nbq algorithm to compute advective fluxes or in specific diffusion schemes and it can then be calculated knowing the density ρ q i in the external mode the iteration of the nbq mode at each external time step provides an alternative to solve the cross dependencies in traditional algorithms pointed out by shchepetkin and mcwilliams 2011 indeed the depth average density ρ q e is available when the external mode is integrated and more specifically when free surface anomaly is prognosticated through 16b whereas model σ grid related variables are updated at internal time step and are thus available in the nbq mode in the internal mode now the continuity eq 17c is only needed to calculate cross σ vertical velocity v σ the non hydrostatic component of the pressure force which appears in both the external and internal modes is given by the nbq component of pressure this component is indeed deduced from the corresponding component of density using the eos 15 in the nbq algorithm neither the free surface anomaly nor the momentum have to be corrected in external or internal modes in the present nbq algorithm whereas such correction is needed in pressure correction methods indeed the continuity equation recovers its status of prognostic equation and is not a constraint any more this is of considerable importance for the algorithm to be easily implemented with higher order mode complex but maybe more efficient time stepping compared to leap frog 3 4 three mode time splitting fig 1 a shows the pressure correction time stepping used by auclair et al 2011 the nbq time stepping is represented in fig 1 b the common boussinesq external internal mode slitting algorithm is extended to include a third nbq mode step 1 the external mode is integrated between ti and ti δti with time step δte step 1a the nbq mode is first integrated with time step δtq from te to te δte and ρ q λ q are time averaged over te δte te δte to calculate their external mode equivalent ρ q e λ q e at te step 1b the external mode is advanced from te to te δte both coupling terms ρ q λ q and ζ e ρ v e λ e are time averaged over ti δti ti δti to be used in the internal mode at this point the complete solution at ti is available step 2 an iteration of the internal mode is carried out between ti and ti δti after step 1 total density ρ q is available for both the external and internal modes respectively through ρ q e and ρ q i variables are time averaged when they are exchanged between the nbq mode and the external or internal modes only the final value of the nbq component of density in a leapfrog formulation is needed 18 ρ q i ρ q e 1 2 ρ q t q ρ q t q δ t q this is similar to the treatment of the free surface anomaly which is computed in the external mode and exchanged with the internal mode 19 ζ e i 1 2 ζ e t e ζ e t e δ t e the rhs of the momentum equations are leapfrog averaged when communicated from nbq mode to large time step modes 20 λ q i 1 4 n e n q t q t t δ t i δ t q t i δ t i λ q t q 21 λ q e 1 2 n q t q t e δ t e δ t q t e δ t e λ q t q the latest value is exchanged between external or internal modes and nbq mode indeed 22 λ e q n q λ e t e t q and λ i q n q λ i t i t q these filtering are clearly time stepping dependent and the above averages are exclusively associated with the leapfrog scheme 3 5 stability of the three mode algorithm and pseudo acoustic regime the stability of the nbq mode and an accurate representation of the induced non hydrostatic processes by the external and internal modes are more important than an accurate representation of compressible processes the number of iterations nq nq δte δtq depends on the numerical properties of the linear system 14a 14c this system describes the propagation and damping due to second viscosity of linear acoustic waves subject to slowly varying forcing λ e q n q and λ i q n q at the rhs of momentum eqs 14a and 14b the inviscid formulation is given and discussed in appendix a eq a5 a simple unidirectional evaluation of the courant number for acoustic waves is given by coq cs δtq δx this means that the time step δtq depends on the space time discretization and on the pseudo acoustic wave velocity the lower this velocity the larger the time step the explicit damping due to the second viscosity can also lead to stability restrictions associated to the dedicated courant number co λ λδtq δx 2 nbq time step δtq must be primarily chosen based on these simple stability criteria to minimize computational cost the acoustic wave velocity cs can be reduced and the new system of equations is not compressible any more but pseudo compressible stability is consequently enhanced since courant number coq is proportional to cs a lower bound exists for the acoustic velocity and can be estimated on simple physical grounds acoustic waves have indeed been introduced in the three mode algorithm in order to propagate pressure anomalies if the velocity scale of the dynamical processes of interest is much slower than the acoustic wave velocity these acoustic waves can propagate pressure anomalies with very few interactions interferences or coupling with other dynamical processes this must still be the case in the pseudo acoustic regime which means that the pseudo acoustic velocity must be reasonably larger than the velocity scale of the dynamical processes say 5 to 10 times larger and less than real acoustic velocity here reasonably means here that incompressible dynamics must not be modified by any kind of spurious interactions interferences or coupling the lower bound for the acoustic velocity is thus associated to the fastest simulated processes we can anticipate that the second viscosity reduces this coupling by limiting the amplitude of the acoustic waves section 4 in this case the interactions interferences and more generally the coupling between the fast nbq non boussinesq mode and the external and internal modes do not disappear but their amplitude is reduced and their time scale can be enhanced skamarock and klemp 1992 such interactions or coupling can in particular occur due to the presence of the free surface which can lead to specific acoustic modes in terms of pressure this means that surface induced and non hydrostatic pressure anomalies are correlated as a consequence the implementation of the fast nbq mode in the external mode can lead to interactions requiring the reduction of the external mode time stepδte let α e δte δt e cfl be the reduction coefficient where δt e cfl is the maximum external time step associated to the courant number for the propagation of the fast long surface waves c o e g h δ t e δ x a situation with no acoustic coupling leads to α e 1 when the surface wave and pseudo acoustic wave velocities are separated by less than one order of magnitude interactions can occur requiring a smaller coefficient α e the closer to each other the velocities the smaller the coefficient the likely interactions of the free surface with the acoustic waves do not change the courant number requirements for the pseudo compressible modes 4 acoustic surface and internal waves in ocean configurations the ability of the complete three mode non boussinesq algorithm to represent acoustic surface and internal waves whether linear or not is now evaluated based on dedicated test configurations experiments a and b section 4 1 focus on the propagation and damping of acoustic waves experiment c section 4 2 focuses on the damping and dispersion of short length scale surface waves experiments d and e sections 4 3 and 4 4 focus on the generation propagation dispersion and damping of both linear and non linear non hydrostatic internal waves georges bank configuration is in particular revisited and compared to the boussinesq pressure correction implementation proposed by auclair et al 2011 the idea being to evaluate the ability of the new algorithm to deal with complex topographies and complex dynamics in the remaining sections auclair et al 2011 s pressure correction boussinesq algorithm is called nh whereas the present non boussinesq algorithm is called nbq when these algorithms are compared hereafter the nh pressure correction poisson system is solved using hips 2 2 http hips gforge inria fr solver 4 1 acoustic waves the propagation damping and reflexion of acoustic waves are first investigated in two dedicated configurations 4 1 1 experiment a spherical waves a rather simple configuration of generation and propagation of acoustic waves is now presented in order to verify the primary characteristics of acoustic waves waves are generated by a high frequency source of sound located at the centre of a 512 512 512 m closed domain this source is represented as a forced harmonic oscillation of the nbq component of density δρ no stratification is imposed and the fields of salinity and temperature are chosen uniform currents and surface displacements are initialized to zero in experiment a the phase velocity of acoustic waves is constant and equal to 1500 ms 1 table 1 gathers the primary numerical parameters of the chosen configuration cfl criteria related to acoustic waves and to a smaller extend surface gravity waves basically set the time steps section 3 5 dynamics is restricted to acoustic waves their propagation and reflection on solid walls is simulated by the nbq mode and their interaction with the free surface is given by both the external and nbq modes consequently nbq and external mode times steps δtq 0 1 ms δte 2 are chosen close to each other whereas internal mode time step is two orders of magnitude larger the implementation in the acoustic configuration is thus investigated in a 3d configuration with the complete three mode algorithm fig 2 shows a vertical section of the high frequency density anomaly δρ the propagation of spherical acoustic waves can be observed the front of the wave is observed to move at 1500 m s and its length scale is given by λ0 cst 0 1500 x 2 5 x 10 2 37 5 m in agreement with the linear theory of acoustic waves in the absence of viscosity the amplitude of the resulting 3d spherical acoustic wave can be shown to decrease as the inverse of the distance to the source r as its amplitude fits the analytical spherical wave a 0 r e 2 π i t t 0 r λ 0 within 1 4 with a standard deviation of 3 7 10 2 in the tank domain fig 2 shows reflections of the acoustic waves at the solid wall of the tank and at the free surface as well 3d acoustic waves can thus propagate in a dynamically coherent way with expected characteristics when compared to the linear theory of acoustic waves the cfl criteria associated with their fast phase velocity does not limit the internal mode time step that can be chosen two orders of magnitude larger δti 200δtq 4 1 2 experiment b acoustic wave filtering and reflexion in ocean configurations in experiment b acoustic waves are generated by the oscillations of the bottom topography appendix d two configurations are studied fig 3 the first one with high frequency oscillations focuses on the generation and propagation of small scale acoustic waves with vanishing surface waves the second one with lower frequency oscillations is dedicated to the generation of surface gravity waves with non vanishing acoustic waves in an ocean like configuration acoustic and surface gravity waves are generated by an oscillating sine shaped submarine mount of horizontal length scale l 0 numerical and physical parameters are presented in table 2 besides the frequency of the oscillations these two configurations have different vertical to horizontal length scale aspect ratio this ratio is equal to 1 in the acoustic wave configuration whereas it is less than 1 10 in the ocean configuration when not specified the kinematic and second viscosities vanish in both configurations fig 3 a and b show a vertical section of the density anomaly δρ after 10 forcing periods 0 1 s with a vanishing second viscosity coefficient fig 3a acoustic waves propagate obliquely from the oscillating mount toward the free surface along black solid lines before reflecting downward at the surface along black dashed lines the incident wave interferes with the reflected waves forming patterns of interferences the black arrow above the surface shows the distance over which the acoustic wave is supposed to have propagated after 10 periods law cs 10t 1 the wave length scale λ1 cst 1 l 0 confirms that the wave is generated by the oscillating bathymetry fig 3 b presents a similar acoustic wave configuration but this time the second viscosity coefficient does not vanish acoustic waves are damped compared to the previous configuration and the reflected waves have much lower amplitudes consequently the patterns of interferences have small amplitudes and their extensions are spatially limited the diffusion length scale λ d has the same order of magnitude as the depth fig 3 c shows the same configuration but for typical ocean scale ratios i e for a small vertical to horizontal aspect ratio in this case the length scale of the acoustic waves generated by the oscillations of the bathymetry is large compared to the ocean depth λ2 cst 2 100 m h 2 0 2 m and the horizontal resolution δx 0 1 m is of the same order of magnitude as the depth h 0 2 m a particularity of the proposed configuration is that the slope of the bathymetry is quasi horizontal and the resulting acoustic waves propagate quasi vertically the resulting up and down quasi vertical motion generates simple patterns of interferences with two maximum of vertical velocity in each column of water these waves reflect alternatively at the surface and at the bottom of the ocean they remain nearly invisible on fig 3c solid and dashed arrow show the position of respectively ascending and descending waves 4 2 surface gravity waves 4 2 1 experiment c natural oscillations of 10 10 m tank the surface oscillation of 10 10 m tank are now investigated in some details with the complete three mode algorithm amplitude and phase errors of the surface oscillations are more specifically investigated when acoustic wave phase velocity is varied in both compressible and pseudo compressible configurations the ability of the present algorithm to propagate short surface gravity waves is consequently evaluated in details following chen 2003 the initial free surface anomaly is given by 23 ζ x t 10 3 cos π 10 x tiny initial amplitudes only 1 mm are chosen to avoid the formation of non linear bores during long integrations for this simple configuration linear inviscid theory gives a period of natural oscillations of t0 3 59 s the primary numerical parameters of the experiments are given in table 3 with internal external and compressible nbq mode time steps respectively equal to 0 482 s 0 16 ms and 0 08 ms amplitude error are both less than 1 of the analytical solution after 10 periods meaning that the numerical solution can hardly be distinguished from the analytical solution when plotted as a function of time not shown with their pressure correction algorithm and the same internal and external mode leapfrog time stepping auclair et al 2011 uses an internal time step equal to 3 21 ms for an equivalent grid which is about 3 orders of magnitude smaller than the present internal time step δti 0 48 s this is a consequence of the non hydrostatic character of the small length scale surface wave whose induced velocity is not constant over the water column this z dependence is simulated by the 3d nbq mode in the three mode algorithm whereas with the pressure correction method of auclair et al this imposes strong stability constraints to the internal mode a consequence is that the barotropic baroclinic time splitting remains attractive when implemented with the three mode algorithm experiment c can provide further insight into the consequences of a lowering the acoustic wave velocity on the damping and dispersion of surface gravity waves fig 4 compares the amplitude 4a and phase 4b of the oscillations after 50 periods with linear inviscid theory amplitude and phase errors are expressed in percent of respectively the amplitude and phase of the analytical solution four sets of bars show the amplitude and phase errors when the velocity of pseudo acoustic waves is varied in order to vary as few parameters as possible the nbq time step remains equal to half the external time step the external mode is replaced by the non dimensional external mode coefficient α e let s recall that α e δte δt e cfl a non vanishing second viscosity is chosen for set 2 only fig 4 clearly shows the existence of a minimum phase velocity for acoustic waves bellow this minimum velocity of about 40 ms 1 both the amplitude and phase errors drastically increase this minimum velocity appears to be equal to 4 5 times the maximum velocity of the long surface gravity wave velocity equal to 10 ms 1 this can be explained by the physics of surface waves the pressure disturbances need to be fast enough to propagate the surface induced pressure anomalies over the water column this is also confirmed by the fact that a reduction of the time step by about 2 orders of magnitude between set 1 and set 4 does not reduce the errors with acoustic velocities lower than 40 ms 1 for phase velocities larger than 40 ms 1 now amplitude and phase errors show a rather weak dependence on acoustic velocity but as expected they vary with α e the lower this ratio and the time steps the lower the errors when α e is smaller than 0 05 amplitude and phase errors do not exceed a few percent when results of sets 1 and 2 are compared we can additionally observe that non vanishing second viscosity damping greatly extents the domain of stability of the three mode algorithm this confirms that damping acoustic waves reduces the coupling with the free surface the individual stability of the nbq mode section 3 5 is not problematic here when not damped acoustic waves can feed strong surface acoustic modes that in turn impose strong courant number limitations on the external time step 4 3 linear internal tides in ridge configuration experiment d experiment d simulates the generation of linear internal gravity waves in a non hydrostatic configuration this experiment is adapted from auclair et al 2014 and it is similar to experiment b internal wave are generated in a closed tank by the oscillation of a ridge like bathymetry simulating real ocean tidal oscillations auclair et al compared the nh implementation to the measurements in the cnrm game tank reaching the conclusion that their time varying bathymetry algorithm was adapted to direct numerical simulations the primary dynamical and numerical parameters are given in table 4 tank configuration external and nbq mode time steps have the same order of magnitude δtq 7 84 10 3 ms δte 2 but the internal mode time steps is two orders of magnitude larger δti 1 57 ms like in the experiments a and c internal mode time step is given by mode 1 internal gravity wave phase velocity see table 4 for the time step and courant number both external and nbq mode time steps are given by high frequency oscillations of bottom topography fig 5 shows a vertical section of the brunt väisälä frequency anomaly δn 2 internal wave rays can be observed in this subcritical case making an angle θ 42 5 0 5 in agreement with the dispersion relation given by linear inviscid theory sin θ 2π t 0 n 0 where t0 and n0 are respectively the period of ridge oscillations and the brunt väisälä frequency of the initial stratification see table 4 tank configuration rays reflect at the surface and bottom of the water column and at lateral walls in this configuration dedicated to linear rays of internal waves the consequences of lowering the acoustic wave velocity are now investigated the rms errors for the u w velocity fields are presented in fig 6 the rms error is defined as the square root of the mean of the squares of the difference between a given implementation and the reference implementation the reference implementation is the nbq configuration with a 1500 ms 1 acoustic wave phase velocity compressible configuration high velocity acoustic waves impose a small nbq time step δtq 7 8410 3 ms two sets of experiments have been carried out for nh and nbq configurations one using time steps similar to those of the reference configuration the other with the largest possible time steps the principal parameters are presented in table 4 test configuration fig 6 a d show the rms errors for nh and nbq configurations relative to the reference with pseudo acoustic wave phase velocities of 10 20 50 and 100 ms 1 pseudo compressible configuration fig 6 a and b show the rms errors obtained when all the configurations are integrated with the same time steps as the reference simulation whereas rms errors shown in fig 6 c and d are obtained for configurations with optimal larger time steps oscillations at half the forcing period can be observed and a quasi stationary error level is reached after 3 4 periods with small time steps equal to those of the reference simulation equivalent rms errors smaller than 10 3 are obtained for nbq configurations with acoustic velocities larger than 50 ms 1 and for the nh configuration rms errors for both components of velocity increase when the pseudo acoustic wave phase velocity is decreased reaching rms errors of 2 5 for a phase velocity of 10 ms 1 two sets of optimal time steps are shown in fig 6 c and d for the nh configurations nh o2 is integrated with an external mode time step equal to half the time step of the first configuration nh o1 this latter configuration shows rather large rms errors for both components of the velocity whereas the former nh o2 presents levels of rms errors at least one order of magnitude smaller indicating a strong dependence to the time step for pseudo acoustic wave velocities smaller than or equal to 20 ms 1 rms errors reach the same order of magnitude as nh o1 and are approximately one order of magnitude larger than those obtained for pseudo acoustic wave phase velocities strictly larger than 20 ms 1 a conclusion from the present set of linear internal wave experiments is that provided pseudo acoustic wave velocity larger than 20 ms 1 are specified nbq configurations show low levels of rms errors with respect to the reference realistic 1500 ms 1 implementation 4 4 non linear internal waves solitons two experiments of non linear internal waves are now investigated both of them being presented in details in auclair et al 2011 note that the pseudo acoustic wave phase velocity 4 ms 1 is only 0 27 of the realistic 1500 ms 1 phase velocity the first experiment e is a two layer tank configuration selected among horn et al 2001 s experiments the second experiment f is a vertical section of internal tides in the region of georges bank similar to the experiment investigated by lamb 1994 4 4 1 experiment e solitary waves in tank configuration table 5 gathers the primary physical and numerical parameters used to implement nh and nbq configurations of 4 6 solitary waves corresponding to horn et al regime 2 their figure 15 d oscillations of the pycnocline are obtained by forcing a tilt at initial time step fig 7 shows the resulting evolution in time of the depth of a middle pycnocline isopycnal surface for nbq dashed line and nh solid line models in both implementations a train of 6 solitary waves appears after 180 s the number of solitary waves decreasing to 5 and then 4 solitons after a few reflections at the lateral solid walls and approximately 350 s of simulation both the number of solitons and the arrival time of the train agree with experimental results described by horn et al 2001 and with the numerical results reported by hodge et al 2006 their figure 3 12 corresponding to scenario 3 interestingly enough nh and nbq configurations do not present any clear discrepancies a time bias of plus or minus two seconds can be observed in the nbq implementation with respect to the nh implementation no clear tendency can be highlighted for the amplitude of the oscillations of the pycnocline to conclude this first simulation of non linear internal solitarity waves nh and nbq algorithms provide density fields in agreement with measurements in tank and with numerical models found in the literature 4 4 2 experiment f georges bank solitary waves a vertical section across georges bank gulf of maine is now investigated like experiments c and e the resulting configuration is similar to the configuration presented by auclair et al 2011 in order to facilitate comparisons between the nh and nbq algorithms the numerical configuration is similar to the configuration simulated numerically and analysed by lamb 1994 as well the numerical parameters are given in table 6 m2 internal tide surface wave is introduced through the eastern offshore boundary condition this wave can propagate across georges bank shelf break and it leaves the domain through the western shoreward open boundary note that slow internal mode time step was restricted by a few hot spots locally high values of vertical advection courant number the simulated vertical section allows the investigation of the large non linear internal waves generated in the pycnocline region by strong tidal currents these internal waves are observed propagating both shoreward and off shore they owe their non linear character not only to the strength of tidal currents in the region but also to the steep slopes of the shelf break and to the moderate strength of the pycnocline cyclic transverse cross shore open boundary conditions permit the occurrence of along shore currents associated with coriolis traditional pseudo force solitary waves impose cfl criteria and consequently the internal mode time step is similar to the time step used in the nh pressure correction configuration by auclair et al 2011 fig 8 shows a vertical section of the total density field after 1 625 tidal period t 0 and should be compared with auclair et al s fig 5 a and with lamb s fig 6 m the three figures compare generally well solitary waves are generated by tidally induced motions above the shelf break and are propagating both shoreward and off shore after 1 625 t 0 depressions a1 and b1 generated during the first simulated tidal period are located at respectively about 28 and 14 km from the shelf break the location of depression a1 is approximately similar in the three simulations although the locations of depressions b1 differ by a few kilometres in these same numerical modelling studies the shoreward most location is observed in lamb experiment before nbq and nh implementations fig 9 a and b present cross shore and vertical components of velocity after only one tidal period t 0 and should now be compared with lamb s fig 7 a and b and auclair et al s fig 5 a and b the comparisons of the velocity components show close agreements between the three modelling studies minima and maxima of velocities have similar locations and their vertical structures are in close agreements amplitude of velocity anomaly whether shoreward or cross shore are also similar as a conclusion these results show that in this demanding ocean configuration nbq and nh implementations provide close and realistic high frequency high resolution ocean circulation nbq algorithm presenting density and velocity fields with amplitude ranging between those obtained by lamb 1994 and auclair et al 2011 5 discussion conclusion time split approaches are currently used in weather forecast models skamarock and klemp 2008 to explicitly integrate sound waves with a smaller time step to our knowledge the explicit simulation of such waves in free surface ocean models based on a barotropic baroclinic time splitting is original under the boussinesq assumption the mathematical degeneracy of the non hydrostatic problem leads to the necessity to solve a large and more importantly global 3d poisson system at each internal mode time step no such system needs to be solved when acoustic waves are explicitly simulated with the three mode time splitting a consequence is that surface induced non hydrostatic processes such as short surface gravity waves can be represented with the external and compressible nbq modes exclusively imposing stability constraints on these two modes only the internal mode time step can consequently be considerably increased compared to the pressure correction method making the barotropic baroclinic time splitting in non hydrostatic models particularly attractive since the details of the propagation of the acoustic waves are not of primary interest to simulate non hydrostatic incompressible slow processes the present study confirms that the velocity of the acoustic waves can be reduced to limit courant number restrictions three wave configurations surface gravity internal gravity and acoustic waves have been studied in the former configuration oscillations of the free surface the physical coupling of the non hydrostatic and surface induced components of pressure appears as a key aspect of the three mode free surface algorithm errors on the amplitude and phase shift of the surface oscillations have been shown to remain acceptable in pseudo acoustic regimes as long as the acoustic wave velocity is larger than 5 times the velocity of long surface gravity waves linear internal wave rays have then been studied in a moving ridge tank configuration to evaluate rms errors of the velocity field with respect to the 1500 ms 1 acoustic wave configuration once again as long as pseudo acoustic wave velocity remains larger than both surface and internal wave velocities i e faster than the fastest dynamical processes in the numerical domain the amplitude of the rms errors remains low reaching a stationary level after a few forcing periods non linear configurations of internal waves and in particular solitary waves have been studied in a tank configuration and in a realistic ocean scale configuration in both cases the three mode algorithm compares well with similar analytical studies experiments a b and c with measurements in tanks experiments d and e with in situ observations experiment f or with other modelling studies published in the literature experiments c d e and f in the present study test cases show that the three mode algorithm is well adapted to parallel implementations although details are left to a future manuscript the three mode algorithm is also rooted in the navier stokes equations and as such can be used in the future as a standard to evaluate new non hydrostatic algorithms future studies should now assess the ability of the three mode splitting algorithm to simulate compressible dynamics acknowledgments we gratefully thank the computer team of the laboratoire d aérologie for nuwa our laboratory cluster together with calmip hyperion and cines jade for computer resources the present study has been supported by the anr projects piwo contract number anr 08 blan 0113 and comodo anr 11 monu 005 appendix a consequences of the boussinesq assumptions csq i boussinesq momentum is approximated by ρ v ρ 0 v first order approximation with respect to the density anomaly leading to an approximate conservation eq 6a csq ii neglecting the density anomalies with respect to a chosen reference state leads to an approximate form of the conservation of mass 6b once depth integrated and combined with the unchanged kinematic conditions 3 4 the conservation of mass transforms into the conservation of the volume of the water column a1 h ζ t h ζ v x x h ζ v y y another consequence of the approximation of the continuity eq 6b through the boussinesq assumption is the mathematical transformation of the resulting system of equations from a hyperbolic formulation to an elliptic formulation in terms of acoustic waves acoustic waves are supposed to propagate with an infinite velocity the filtering of these fast numerically demanding waves is justified by the boussinesq approximation in large scale and even in regional and coastal scale ocean modelling csq iii continuity equation further loses its status of prognostic equation for density a consequence being that boussinesq momentum equations must be solved under the vanishing divergence constraint 6b whereas density can be diagnosed using the eos in hydrostatic boussinesq models vertical velocity is also usually diagnosed using the continuity equation and in non hydrostatic boussinesq models this equation is a constraint for which pressure becomes the lagrange multiplier salmon 1998 p 313 315 csq iv the dependence of the density in the total pressure through the eos cannot be maintained under the boussinesq assumption leading to eos 6d the dependence in ρ0 gz provides a consistent boussinesq energy conservation law young 2010 and shchepetkin and mcwilliams 2011 further show that a stiffened formulation is to be preferred to a more accurate formulation using the free surface anomaly ρ0 g ζ z which can create a vertical shear in surface induced barotropic currents leading to cross dependencies when barotropic baroclinic mode splitting is implemented csq v boussinesq assumption provides a consistent framework to study ocean dynamics in association with its own bernoulli like formulation of energy conservation young 2010 a number of processes in terms of ocean circulation are excluded bulk compressibility processes such as acoustic waves as already stated above their elimination is precisely one of the reasons of the popularity of the assumption the steric effect is not excluded it only has to be adjusted using the constraint on total ocean mass griffies and greatbatch 2012 dynamical processes related for instance to surface heating which can be crudely simulated whereas details are incorrectly depicted mellor and ezer 1995 the linear propagation of small amplitude acoustic waves across a compressible isentropic inviscid non rotating homogeneous ρ ρ0 ocean initially at rest satisfies a simplified version of equations 1a d a2 ρ 0 δ v t δ p a3 δ ρ t ρ 0 δ v a4 δ p c s 2 δ ρ where gravity has been neglected and anomalies associated with the acoustic waves are written δ v δ p δ ρ this leads to the following hyperbolic propagation equation for acoustic waves a5 2 δ p t 2 c s 2 δ δ p 0 or equivalently 2 δ ρ t 2 c s 2 δ δ ρ 0 under the boussinesq equation a3 degenerates to a6 δ v 0 and pressure anomalies satisfy the elliptic equation a7 δ δ p 0 the computational cost of this large 3d linear system required by pressure projection and pressure correction methods must then be compared with the computational cost of high frequency acoustic waves global systems potentially require a larger portion of global communications whereas local systems require communications with neighbours and are thus adapted to massively parallel implementation consequently both the computational performances and the scalability of the resulting boussinesq ocean model depend essentially on the performances of the poisson solver implemented to calculate pressure increment non boussinesq dynamics is hyperbolic in terms of acoustic waves and it is consequently associated with severe cfl criteria for the computation of these high velocity waves appendix b non boussinesq system of equations in σ coordinates τhe present version of the three mode algorithm is implemented in σ coordinates the algorithm has no particular reason to be restricted to this particular vertical coordinates and can be formulated for any type of vertical coordinates a formulation of the equations of the three mode algorithm is given in the present appendix σ coordinates can be introduced by writing b1 z x y σ t σ h x y t ζ x y t h x y t σ h x y t h x y t where h is defined by h z σ at the surface z ζ σ 1whereas at the bottom z h σ vanishes model bathymetry h can further be made time dependent auclair et al 2014 momentum equations in σ coordinates in σ coordinates the non boussinesq system of equations can be expressed in flux form as follows b2a h ρ v t σ h z h p h h z δ p δ ρ h g a d v h ρ v h δ f c ν δ σ h ρ v λ h ρ v b2b h ρ t σ h ρ u x σ h ρ v y σ ρ v σ σ d i v σ h ρ v b2c h ρ θ s t σ h u ρ θ s x h v ρ θ s y ρ v σ θ s σ h ρ ϕ θ ϕ s h ρ b2d ρ ρ θ s p ρ b q θ s ρ 0 g z ρ p θ s δ p δ ρ where the divergence operator div σ is d i v σ h ρ v h ρ u x σ h ρ v y σ ρ v σ σ the vertical velocity across σ surfaces v σ h d σ d t is related to the vertical velocity w by b3 w x y σ t d z d t v σ d z d t σ v σ z t σ u z x σ v z y σ v σ σ d ζ d t σ 1 d h d t σ subscribe indicates that the derivative is computed along σ surfaces the newly defined vertical velocity v σvanishes both at the bottom and at the surface of the water column the conservative formulation of the advection in σ coordinates for momentum is b4 ρ d v d t z ρ v t z u ρ v x z v ρ v y z w ρ v z 1 h h ρ v t σ h ρ v u x σ h ρ v v y σ ρ v v σ σ relation b4 additionally defines the flux advective operator to optimize computations one needs another assumption in the present non boussinesq algorithm since in the momentum equations b2a the viscous diffusion operators are related to integrated momentum h ρ v not to velocity as they should a common difficulty of the formulation of non hydrostatic models in σ coordinates concerns the vertical velocity indeed both the cross σ v σ and true vertical w velocities need to be computed the latter with b2a whereas the former is a diagnostics based for instance on b3 appendix c space discretization of the divergence and gradient operator to ensure correct energy transfers the gradient operator implemented in the non hydrostatic pressure force and the divergence operator implemented in the continuity equation cannot be treated independently for readability both operators are now expressed as functions of coefficients α β these coefficients detailed in appendix c 3 are functions of the grid parameters and are given in the x z vertical layer c 1 divergence operator k 1 k max σ h ρ v i k h ρ u i 1 2 k h ρ u i 1 2 k δ x ρ w i k 1 2 ρ w i k 1 2 z x σ ρ u i k 1 2 z x σ ρ u i k 1 2 the space discretization of the last terms in brackets is inner layers k 1 k max z x σ ρ u i k 1 2 α i 1 2 k 1 ρ u i 1 2 k 1 β i 1 2 k ρ u i 1 2 k α i 1 2 k 1 ρ u i 1 2 k 1 β i 1 2 k ρ u i 1 2 k surface layer k k max 1 2 z x σ ρ u i k max 1 2 β i 1 2 k max 1 2 ρ u i 1 2 k max 1 2 β i 1 2 k max 1 2 ρ u i 1 2 k max 1 2 bottom layer k 1 2 z x σ ρ u i 1 2 α i 1 2 1 2 ρ u i 1 2 1 2 α i 1 2 1 2 ρ u i 1 2 1 2 c 2 non hydrostatic pressure gradient operator the gradient operator implemented in the non hydrostatic pressure force is a first order scheme similar to the one proposed by auclair et al 2011 it is written in the following for the non boussinesq pressure increment but is applied to the non boussinesq density increment in the nbq mode as the two variables are related by the linear eos b2d i horizontal component k 1 k max δ p x z i 1 2 k δ p i 1 k δ p i k δ x z i 1 k z i k δ x δ p z i 1 2 k the vertical pressure component at point i 1 2 k is given by inner layers k 1 k max δ p z i 1 2 k 1 4 δ p i 1 k 1 δ p i k 1 δ p i 1 k δ p i k δ z i k 1 2 δ p i 1 k δ p i k δ p i 1 k 1 δ p i k 1 δ z i k 1 2 surface layer k k max 1 2 δ p z i 1 2 k max 1 2 0 δ p i 1 k max δ p i k max δ z i 1 2 k max 1 2 i vertical component inner layers k 1 k max δ p z i k 1 2 δ p i k 1 δ p i k δ z i k 1 2 surface layer k k max 1 2 δ p z i k max 1 2 0 δ p i k max δ z i k max 1 2 c 3 α β grid parameters inner layers k 1 k max α i 1 2 k z i 1 k z i k 4 δ x δ z i 1 2 k δ z i 1 2 k 1 2 z i 1 k z i k 4 δ x δ σ i 1 2 k δ σ i 1 2 k 1 2 k 1 k max β i 1 2 k z i 1 k z i k 4 δ x δ z i 1 2 k δ z i 1 2 k 1 2 z i 1 k z i k 4 δ x δ σ i 1 2 k δ σ i 1 2 k 1 2 surface layer k k max 1 2 α i 1 2 k max 1 2 β i 1 2 1 2 0 and β i 1 2 k max 1 2 ζ i 1 ζ i 2 δ x bottom layer k 1 2 α i 1 2 1 β i 1 2 k max 0 and α i 1 2 1 2 h i 1 h i 2 δ x appendix d time varying bathymetry in non boussinesq mode splitting auclair et al 2014 show that bathymetry can be made time varying with only few adaptations in a free surface non hydrostatic model its implementation in the new non boussinesq mode splitting algorithm is straightforward model variable for surface anomaly is first replaced by the variations of the water column total depth i e surface plus bathymetry the surface pressure gradient and the vertical position of the model grid have then to be corrected from the motion of the bottom topography a specificity of auclair et al 2011 s nh algorithm is the possibility to specify boundary conditions independently for the divergence d and gradient m operators before constructing the laplacian operator δ dm a direct consequence is that new bottom boundary conditions can be specified in terms of the horizontal and vertical components of the velocity identical matrix operators are used in the nbq algorithm to compute the nbq mode equations consequently the nbq boundary conditions associated with a varying bathymetry remains similar to those implemented in auclair et al s nh algorithm d1 u z h u b a t h y m e t r y w z h w b a t h y m e t r y 
24068,based on a validated underwater oil spill model and the hydrodynamic background provided by an unstructured grid finite volume coastal ocean model fvcom a series of numerical experiments are conducted to study the impact of error in ocean dynamical background currents on the 3d transport of underwater spilled oil in terms of three metrics including oil centroid position sweeping area and sweeping volume numerical result shows that a larger error in ocean dynamical background currents results in a larger model error expectation and uncertainty for all three metrics as model time increases the model error mainly increases and the error growth rate varies unevenly the sensitivity of the oil spill model to background current error can be interpreted as an integrated result of the temporal and spatial variations of the background current and the movement of oil droplets of different sizes keywords underwater oil spill ocean dynamical background error numerical simulation contingency planning environmental damage assessment 1 introduction with the extensive exploration of offshore oil and gas resources the risk of underwater oil spill is increasing there are frequent serious offshore oil spill accidents in the last several years such as the 2010 deepwater horizon oil spill in the gulf mexico boufadel et al 2014 and the 2011 penglai 19 3 oil field oil spill in the bohai sea of china xu et al 2013 the offshore oil pollution has become increasingly serious which may not only cause huge economic losses to fishery aquaculture and other industries but also cause extensive damage to the ocean environment and ecosystem different from the oil spilled from the sea surface the transport and diffusion behaviors of underwater spilled oil are difficult to observe effectively therefore numerical simulation of transport diffusion behaviors and the spatial distribution of the underwater spilled oil serves as a useful and in most cases the only reference for the damage assessment and emergency response the study of underwater oil spill model began in the 1970s early studies were mainly concerned with surface near surface or shallow water oil spills such as topham 1975 mcdougall 1978 fannelop and sjoen 1980 johansen 1984 elliott 1986 lee and cheung 1990 rye 1994 yapa and zheng 1997 yapa et al 1999 and lonin 1999 the subsequent efforts were mainly devoted to developing an enhanced comprehensive oil spill model to describe deepwater oil spills two of such well known models are deepblow johansen 2000 and adms cdog zheng and yapa 2002 both of which can simulate the complex behavior of spilled oil in the deep sea environment based on the previous studies chen et al 2015 developed a deepwater oil spill model and verified it through comparing model predictions with data observed from a field experiment the model is also applied to simulating a hypothetical oil spill taking place at the seabed of a deep water oil gas field in the south china sea as to the transport simulation of the spilled oil bandara et al 2011 developed a novel numerical model to simulate oil sediment interaction and transport in near shore waters janeiro et al 2014 implemented an operational model to plan and respond to oil spill accidents described the model in detail and discussed the effect of wave induced stokes drift on the transport of spilled oil weisberg et al 2017 reviewed the evolution of the surface oil as it approached the beach and considered the mechanisms of transport in their study both effects of ocean circulation and ocean waves on the oil transport were discussed besides some studies focused on the 2011 penglai 19 3 oil spill accident for example deng et al 2013 and xu et al 2015 simulated the time and area the spilled oil may reach the surrounding coast after a long enough time zhou et al 2016 and wei et al 2015 discussed the impact of the spilled oil on the environment and the damage assessment hitherto although there are many studies of oil spill simulation the oil spill model is not always sufficiently accurate and sometimes cannot provide reliable information due to various error sources such as the wind current oil source etc it is necessary to analyze and identify major sources of error for the model some studies focused on the quantification and analysis of the uncertainty in oil spill simulation wang et al 2016 gonçalves et al 2016 iskandarani et al 2016 hou et al 2017 and some studies have shown sensitivity tests for the parameters and input data elliott 2004 jorda et al 2007 abascal et al 2010 besides some studies focused on other factors such as the length of integration time step the integration method the model resolutions and the schemes of vertical diffusion elliott and jones 2000 james et al 2004 li et al 2013 once the oil particles are released into water their movements are mainly determined by ocean currents the accuracy of ocean currents has a great influence on the accuracy of oil spill simulation thus it is necessary to conduct study of the role of errors of the ocean dynamical background in the underwater spilled oil simulation based on the fvcom generated ocean dynamical background and oil spill model developed by chen et al 2015 the influence of error in ocean dynamical background on the transport of underwater spilled oil is studied in this paper through simulation of penglai 19 3 oil spill accident that occurred in the bohai sea on june 4 2011 the impact of ocean currents error on the centroid position the sweeping area as well as the sweeping volume is investigated quantitatively and how the currents error influences the model result is also discussed by analyzing the results the impact of ocean currents error on the transport of subsea spilled oil becomes clear and the importance of the accuracy of ocean currents in oil spill modeling can be better understood besides useful information could be provided for spilled oil monitoring contingency planning and environmental damage assessment 2 model description 2 1 ocean model to force the oil spill model the background hydrodynamic data such as the current velocity temperature salinity and potential density is needed in this paper it is provided by a 3d forecasting system based on an unstructured grid finite volume coastal ocean model fvcom the model consists of momentum continuity temperature salinity and density equations and is closed physically and mathematically by using the mellor and yamada level 2 5 turbulent closure submodel the irregular bottom slope is represented using a sigma coordinate transformation and the horizontal grids comprise unstructured triangular cells the model combines the advantages of the finite element method for geometric flexibility and finite difference method for simple discrete computational efficiency and can produces a better simulation of tidal elevations and residual currents especially around islands and tidal creeks chen et al 2003 in the sigma coordinate the governing equations of the model are given as 1 u d t u 2 d x u v d y u w σ f v d g d ζ x g d ρ 0 x d σ 0 ρ d σ σ ρ d x 1 d σ k m u σ d f x 2 v d t u v d x v 2 d y v w σ f u d g d ζ y g d ρ 0 y d σ 0 ρ d σ σ ρ d y 1 d σ k m v σ d f y 3 θ d t θ u d x θ v d y θ w σ 1 d σ k h θ σ d h d f θ 4 s d t s u d x s v d y s w σ 1 d σ k h s σ d f s 5 ρ ρ θ s where x y and z are the east north and vertical axes of the cartesian coordinate u v and w are the x y z velocity components ρ is the density p is the pressure θ is the potential temperature s is the salinity f is the coriolis parameter g is the gravitational acceleration fu fv f θ and fs are the horizontal momentum thermal and salt diffusion terms km represents the vertical eddy viscosity coefficient and kh represents the thermal vertical eddy diffusion coefficient km and kh are parameterized by using the mellor and yamada 1982 level 2 5 turbulent closure scheme the equations for q 2 and q 2 l can be described as follows 6 q 2 d t q 2 u d x q 2 v d y q 2 w σ 2 d p s p b ɛ 1 d σ k q q 2 σ d f q 7 q 2 l d t q 2 l u d x q 2 l v d y w d q 2 l w σ l e l d p s p b w e l ɛ 1 d σ k q q 2 l σ d f l where q 2 u v 2 is the turbulent kinetic energy l is the turbulent macroscale kq is the vertical eddy diffusion coefficient of the turbulent kinetic energy fq and fl are the horizontal diffusion of the turbulent kinetic energy and macroscale p s k m u z 2 v z 2 2 and p b g k h ρ z ρ 0 are the shear and buoyancy production terms of turbulent kinetic energy ɛ q 3 b l l is the turbulent kinetic energy dissipation rate w 1 e 2 l 2 κ l 2 is a wall proximity function where κ 0 4 l 1 ζ z 1 h z 1 h is the mean water depth and ζ is the free surface elevation the turbulent kinetic energy and macroscale equations are closed by defining 8 k m l q s m k h l q s h k q 0 2 l q the stability functions sm and sh are calculated as modified by galperin et al 1988 the horizontal diffusion terms are given as 9 d f x x 2 a m h u x y a m h u y v x 10 d f y x a m h u y v x y 2 a m h v y 11 d f θ f s f q 2 f q 2 l f y x a h h x y a h h y θ s q 2 q 2 l where am and ah represent the horizontal eddy and horizontal thermal diffusion coefficients respectively at the surface where σ 0 the boundary conditions are 12 u σ v σ d ρ 0 k m τ s x τ s y w 0 13 θ σ d ρ c p k h q n x y t s w x y 0 t 14 s σ s p e d k h q 2 l 0 15 q 2 b l 2 3 u τ s 2 at the bottom where σ 1 16 u σ v σ d ρ 0 k m τ b x τ b y w 0 17 θ σ s σ 0 q 2 l 0 18 q 2 b l 2 3 u τ b 2 where τ sx τ sy and τ b x τ b y c d u 2 v 2 u v are the x and y components of sea surface wind and bottom stresses and d h ζ the drag coefficient cd is calculated by matching a logarithmic bottom layer at the height zab above the bottom that is 19 c d max κ 2 ln z a b z 0 0 0025 here z 0 is the bottom roughness parameter cp is the specific heat of seawater qn x y t is the surface net heat flux including four components downward shortwave and longwave radiation and sensible and latent fluxes sw x y 0 t is the shortwave flux incident at sea surface p and e are the precipitation and evaporation rates respectively before running the model the horizontal computational domain is subdivided into unstructured triangular grids fig 2a and ζ s θ ρ q 2 q 2 l h d km kh am and ah are placed at nodes while u v are placed at centroids variables at each centroid are determined by a net flux through the three sides of that triangle and variables at each node are calculated based on a net flux through the sections linked to the centroids in the surrounding triangles with connection to that node 2 2 underwater oil spill model based on the knowledge learned from previous studies the whole underwater process of oil spill can be divided into three successive stages including the turbulent jet stage the buoyant plume stage and the advection diffusion stage among them the first two stages can be simulated by the plume dynamics model pdm while the last stage can be simulated by the advection diffusion model adm in the pdm a small amount of spilled oil and water is mixed and can be treated as an entirety and the interaction between oil and the ambient water should be considered in the adm the spilled oil is divided into a certain number of discrete particles each of which represents a set of oil droplets and is characterized by its volume droplet size diameter spatial coordinate and velocity etc these particles move passively under the force of shear current turbulence and buoyancy 2 2 1 plume dynamics model pdm in the pdm the lagrangian integral technique is utilized to simulate the turbulent jet stage and the buoyant plume stage of the spilled oil the oil spill duration is divided into a series of intervals with equal length of δt as shown in fig 1 and each time interval corresponds to a small amount of spilled oil thus the oil water plume can be represented by a series of non interfering control elements and it is assumed that each of the control elements is a cylinder section of a bent cone and its bottom plane is perpendicular to the plume trajectory the radius local velocity and density of the element are b m v m s and ρ kg m3 so the element thickness is h v δ t m and its mass is m ρπb 2 h kg the element is also characterized by a set of variables such as temperature salinity and oil concentration etc these variables represent the average values for an element and will change as the element moves in the 3d space the following governing equations are applied to the control elements 1 conservation of mass and momentum the control element may change in mass due to entrainment which can be described by the following equation 20 d m d t ρ a q e where ρ a is the density of ambient fluid kg m3 qe is the volume flux m3 s entrained through shear induced entrainment and forced entrainment the oil momentum will change due to the interaction between oil and its ambient fluid when the oil is spilled into ambient environment the momentum change rate of a control element can be described by the following equation according to the law of momentum conservation 21 d m v d t ρ a q e v a m δ ρ ρ g k where v a is the average velocity vector m s of the ambient fluid flowing over the front surface of plume δρ ρ a ρ is the density difference kg m3 between the ambient environment and the control element and k is the unit vector in the vertical direction the first term of the right hand side of eq 21 represents the momentum change due to entrainment and the second term represents the change due to buoyant force the influence of oil dissolution and drag force on the momentum change have been neglected because they are much smaller than the two given terms 2 conservation of heat salinity and oil mass the heat salinity and oil concentration will change in a control element due to the exchange of material and heat between the buoyant plume and its ambient environment this process can be described by the following conservation equation 22 d m i d t ρ a q e i a where i is a scalar parameter and denotes the heat cpt salinity s or oil concentration c cp is the specific heat for water cp 4216 3j kg k and for crude oil cp 2200j kg k jamaluddin et al 1991 3 state equation in the pdm the seawater potential density is calculated with the international equation of state of sea water 1980 eos80 fofonoff and millard 1983 which relates the seawater potential density to the temperature salinity and pressure the oil density variation due to temperature is calculated according to the national standard of petroleum measurement tables gb t 1885 1998 china s national standard 1998 4 entrainment formulation the plume mass increases as the ambient fluid is entrained into the buoyant plume through the exterior surface of the plume during migration of the buoyant plume through water column a proper estimation of entrainment rate of the ambient fluid qe in eq 20 is important in buoyant plume simulation according to frick 1984 and lee and cheung 1990 the entrainment contains two distinct processes identified as shear induced entrainment and forced entrainment the first one is due to shear between the buoyant plume and the ambient fluid and is present even when there is no ambient flow the second one is due to the advection of ambient flow into the buoyant plume accordingly the entrainment rate qe is calculated as follows 23 q e q s q f where qs represents the volume fluxes m3 s due to shear induced entrainment and qf represents the volume fluxes m3 s due to forced entrainment the two terms are calculated with the functional form as fischer et al 1979 and yapa and zheng 1997 respectively 2 2 2 advection diffusion model adm in the present adm the lagrangian particle tracking random walking method is utilized to simulate the oil transport in advection diffusion stage this method not only can avoid the numerical diffusion problem besetting the discretized advection diffusion equation but also can describe some physical diffusion process accurately such as the breakup and separation of oil slick some studies have shown that this method is significantly more efficient in the cases of higher dimension and relatively few particles and also where the contaminant resides in a patch occupies only a portion of the whole model area al rabeh et al 1989 yapa et al 1999 wang et al 2008 dasanayaka and yapa 2009 concretely the movement of an oil particle in the 3d environment is described by the following equation 24 d s d t v v v 10 w b k where s x y z is the displacement of an oil particle and x y and z are the cartesian coordinates v is the advection velocity due to the effect of ocean currents which is a significant factor in the oil transport and is obtained from the ocean model described in section 2 1 v is the diffusion velocity due to turbulent diffusion process and is calculated as the following formula 25 v 6 δ t r x k h r y k h r z k z where rx ry and rz are uniformly distributed random numbers ranging from 1 to 1 and are independent of each other v 10 represent the wind drift effect on oil movement and v 10 α u 10cos β v 10sin β u 10sin β v 10cos β where u 10 and v 10 are wind velocities at 10 m above sea surface α is drift factor and β is deviation angle in the present model αis taken as 0 03 β 40 8 u 10 2 v 10 2 4 when 0 u 10 2 v 10 2 25 m s and β 0 when u 10 2 v 10 2 25 m s wang et al 2008 wang and shen 2010 wb is the buoyancy velocity and can be calculated using either the stokes law or the reynolds law depending on the oil droplet size as described in yapa et al 1999 the oil droplet size is a significant factor in the adm in this paper its distribution is estimated according to delvigne and hulsen 1994 and wang et al 2008 since their simulation result corresponds to the experience of oil industry staffs from the offshore drilling platforms in the modeling area of this paper actually the pdm plays a role of providing a reasonable source for the adm guaranteeing a dynamical rationality for simulating the underwater part of oil spill process in the present model we follow yapa et al 1999 to use the neutral buoyancy level criterion to define the transition point between pdm and adm 2 2 3 oil spill weathering models when the oil is transported through the water column or on the sea surface the oil movement and property will be impacted by some weathering processes typically like the oil dissolution evaporation emulsification etc according to some previous related studies some typical weathering process is considered in the present oil spill model and formulated as follows 1 dissolution the mass loss rate due to oil dissolution into ambient environment can be written as 26 d m d i s s d t k d a c s c w where dmdiss is the mass loss due to dissolution kg kd is the dissolution mass transfer coefficient m s cs is the oil solubility in water kg m3 and cw is the initial concentration of oil in water kg m3 the present model assumes that cw cs and thus cw 0 details on computing kd and cs were given in riazi and edalat 1996 in the pdm a is the area of exposed plume surface m2 in the adm for underwater oil it is the area of the oil particles and in the adm for sea surface oil it is approximately equal to the area of oil slick 2 evaporation evaporation is the primary cause of rapid mass reduction of the surface oil the rate of evaporation can be written as follows stiver and mackay 1984 27 f v ln 1 b n t g t θ n e a n b n t 0 t t b n t g where fv is the evaporated fraction a 6 3 b 10 3 t is the temperature of spilled oil k t 0 is the initial boiling point of the oil k tg is the curve gradient of the oil boiling point and θ is the coefficient of evaporation which is defined as θ k a t v 0 k is the mass transfer coefficient m s t is the time s v 0 is the initial volume m3 of the oil particles 3 emulsification an empirical approach has been taken to estimate the rates of emulsification and the time evolution of the water content of the surface oil is computed according to rasmussen 1985 and wang et al 2005 28 y w 1 k b 1 e k a k b 1 w 2 t where yw is the water content of the emulsion ka is taken as 4 5 10 6 k b 1 y w f 1 25 y w f is the stable water content of the emulsion with the value of 0 8 and w is the wind speed m s 4 density change of oil the processes of evaporation and emulsion can influence the density of the remaining oil both effects are taken into account through the following formulation wang et al 2005 29 ρ 1 y w 0 6 ρ 0 0 34 f v ρ 0 y w ρ w where ρ is the density of the remaining oil ρ0 is the density of the initial oil ρ w is the water density 3 experiment description 3 1 implementation and validation of fvcom since the accident took place at the seabed of penglai 19 3 platform in the bohai sea we used the fvcom to cover the whole domain ranging from 117 5 e to 122 3 e and from 37 n to 41 n fig 2 a the horizontal resolution is 1 24 and in the vertical direction the water column is equally divided into 10 sigma layers bathymetry data were downloaded from general bathymetric chart of the oceans gebco with a horizontal resolution of 0 5 0 5 the wind data and other sea surface flux data such as the longwave radiation and latent heat flux etc are obtained from ncep climate forecast system version 2 cfsv2 with a horizontal resolution of 0 5 0 5 and temporal resolution of 6 h both temperature and salinity were set the same with chen et al 2003 which means that the initial temperature was specified as a vertical linear function with 25 c at the sea surface and 15 c at a depth of 75 m while the salinity was specified as a constant value of 30 psu the open boundary conditions for the water level were specified with 8 tidal constituents m2 s2 n2 k2 k1 o1 p1 and q1 which were derived from a tidal model with the adjoint method lv et al 2006 zhang et al 2008 in this paper we run the ocean model for two months from may 1st to june 30th and validate the model by comparing the observation with the simulation fig 2b and c show the comparisons between the observed and simulated elevation at two stations located in the bohai sea there was a good agreement between observation and simulation demonstrating that the ocean model can provide a reliable simulation of hydrodynamic environment the oil spill model is off line coupled to the hydrodynamic model from the simulation result of fvcom we extracted the hydrodynamic data and interpolated them to the positions of oil plumes pdm or oil particles adm at every time step to force the oil spill model the data period ranges from 12 00 on june 17th to 12 00 on june 19th 2011 with an interval of 1 h 3 2 oil spill model calibration in this section we use two satellite images xu et al 2013 at 02 14 57 on june 11 fig 3 a and at 02 05 02 on june 14 fig 3b respectively to conduct the calibration of our oil spill model xu et al 2013 pointed out that the oil slicks f and g in fig 3b are originated from oil slicks c and d in fig 3a thus we use the oil slicks c and d as the source of our adm model at 02 15 00 on june 11 and compare the simulate results at 02 05 00 on june 14 with the distribution of detected oil slicks f and g in fig 3b from fig 3c we can see that after nearly 72 hours the oil slicks c and d mainly transported to the east north direction the simulated transport direction and final position of the oil slick are consistent with the observation data demonstrating that our oil spill modelling system can provide a reliable simulation of spilled oil transport 3 3 sensitivity experiment in order to study the impact of ocean currents error on the transport of underwater spilled oil four numerical experiments were designed in this paper the experiment 1 is a control experiment in which the advection velocities v in eq 24 of the currents were extracted from the ocean model and are treated as the error free flow field with no prediction error or observation error of the ocean in the experiment 2 3 and 4 different relative random errors of 10 20 and 30 were added respectively to the ocean currents of experiment 1 and the currents are taken as the error flow field with different prediction error or observation error then the current fields in the four experiments are respectively treated as the dynamical background for the oil spill model and the difference between the results are analyzed quantitatively the oil spill took place at the seabed of penglai 19 3 platform in the bohai sea of china as shown in fig 2a the oil is assumed to be spilled upwards from the seabed into the sea the spill started at 12 00 p m on 17 june 2011 and the spill duration is 1 h the oil spill model employs 100 000 lagrangian particles to simulate the transport of the spilled oil and other discharge conditions are summarized in table 1 in the adm the horizontal and vertical diffusivities are 0 05 and 0 001 m2 s at the sea surface respectively both diffusivities are assumed to be constant in the top 10 m of the water and then decreased proportional to the distance between oil particles and the water surface yapa et al 1999 after a certain random error is added to the currents the currents are used to drive the oil spill model in the perturbed experiments experiment 2 3 and 4 and different oil spill simulation results can be obtained at different times therefore we perform each of the perturbed experiment 100 times denoted as scenarios furthermore random walking method itself can also cause an uncertainty and even though no error is added to the ocean background in the control experiment experiment 1 different results still can be obtained every time we perform the oil spill model thus we also perform the control experiment 100 times based on oil spill modeling results of the 100 scenarios in each experiment the error expectation and result uncertainty of different metrics such as the centroid position the sweeping area as well as the sweeping volume will be quantified at different time steps the computing method of error expectation and result uncertainty at a time are described as follows 30 error expectation j 1 n s j s 0 n result uncertainty j 1 n s j s 2 n where sj is the metric value of the four experiments s 0 is the mean metric value of the control experiment s is the mean value of sj and n equals 100 the error expectation refers to the mean error between the perturbed experiments and the control experiment of the results of 100 scenarios and can tell us to what extent the oil spill error can be expected while the result uncertainty is derived from the standard deviation of the results of 100 scenarios and can tell us how uncertain the oil spill simulation result can be due to the uncertainty of error in the ocean dynamical background it should be noted that for the error expectation we use the absolute mean value and not directly use the mean value of 100 scenarios in consideration of the uncertainty of the ocean dynamical background error in fact only one scenario can really occur among all 100 scenarios in actual case since the ocean dynamical background error is designed to be randomly distributed around zero the mean of all 100 scenarios is quite close to zero from which however we cannot arbitrarily draw a conclusion that the error in the ocean dynamical background has little effect on the oil spill simulation 4 results 4 1 centroid position fig 4 a shows the impact of ocean currents error on the centroid position of spilled oil at the sea surface in fig 4a it is obvious that the centroid position varies with time and the spread of the 100 green points centroid positions also increases with time the results illustrate that once the random error is added into the currents the centroid position of the spilled oil will shift and the spread of model result will also increase with time besides the red points are the mean positions of all 100 scenario results they are so close to and almost coinside with the black points at the same time step in fact the background errors in 100 scenarios are symmetric around the zero point resulting in symmetry of the oil spill simulation errors around the zero point this does not help us understand the effect of a certain ocean background error on the oil spill simulation which is what we are really concerned about this is also why we take form of absolute mean as the error expectation in eq 30 in order to quantitatively examine the impact of the currents error on the modeled trajectory of the spilled oil the centroid shift the distance between the centroid points of perturbed experiments and that of the control experiment at the same moment and the spread of centroid positions under different background error levels are calculated in this paper fig 4b and c show the impact of ocean currents error on the error expectation of centroid shift eecs of the surface oil and underwater oil respectively it should be noted that the eecs does not refer to the distance between the mean centroid position of the 100 scenarios the red points in fig 4a and the mean centroid position of the control experiment the black points in fig 4a instead it refers to the mean value of the 100 shift distances between the green points and the black point at the same moment in fig 4a and thus can tell us to what extent the centroid shift can be expected when a certain error is added to the ocean current background fig 4b and c illustrate that the value of eecs increase not only with the time but also with currents error level in experiments 2 3 and 4 where the currents error are 10 20 and 30 the maximum values of eecs within 48 hours are 0 20 km 0 46 km and 0 69 km respectively fig 4d and e show the impact of ocean currents error on the result uncertainty of centroid position rucp of the surface oil and underwater oil respectively in fig 4d and e it is obvious that the value of rucp increase both with the time and with the currents error during the 48 h of modeling the maximum values of rucp are 0 23 km 0 55 km and 0 80 km for the relative ocean currents error of 10 20 and 30 respectively by comparing all four figures of fig 4b e we can see that the range of the eecs and rucp are roughly the same for the surface oil and underwater oil indicating that the currents error can influence the centroid position and the spread of the centroid position to the same extent the above results illustrate that the ocean currents error can make the centroid position of the modeled oil shift from the actual position both at the sea surface and in the water column the larger the relative current error is the larger the average shift distance and uncertainty of centroid position are 4 2 sweeping area the sweeping area is defined as the total area of grids where the water has ever been contaminated since spill began fig 5 a shows the sketch of sweeping area of the spilled oil at the sea surface it is obviously that the sweeping area increase with the time and when the error is added to the background currents the sweeping area changes correspondingly in order to quantitatively examine the impact of the currents error on the modeled sweeping area of the spilled oil the error expectation of sweeping area eesa and the result uncertainty of sweeping area rusa under different background error levels are calculated in this paper fig 5b e show the simulation error in the sweeping area in terms of the mean value and spread for both the surface oil and underwater oil as can be seen a larger ocean currents error will result in a larger model error in the sweeping area meanwhile the values of eesa and rusa also increase with ocean currents error and time which is similar to the results of centroid position shown in fig 4 table 2 shows the maximum absolute value and relative value of eesa within 48 hours the relative value of eesa refers to the ratio of the eesa value in experiment 2 3 and 4 to the mean sweeping area value in experiment 1 at the same moment from table 2 we can see that under the influence of a certain current error the underwater absolute error is smaller than the surface one but the case of the relative error is opposite for the current errors of 10 20 and 30 4 3 sweeping volume the sweeping volume is defined as the total volume of grid cells where the water has ever been contaminated since spill began when the error is added to the background currents the sweeping volume also changes in order to quantitatively investigate the impact of the currents error on the total amount of contaminated water the metric of sweeping volume under different background error levels is calculated in this paper fig 6 b and c shows the temporal variation of the mean error in the sweeping volume and the spread fig 6b refers to the error expectation of sweeping volume eesv and fig 6c refers to the result uncertainty of sweeping volume rusv respectively in fig 6 it is obvious that both eesv and rusv also increase both with the background error and with the modeling time within 48 h when the ocean currents error are 10 20 and 30 the maximum absolute values of eesv are 14 80 10 3 km3 46 25 10 3 km3 and 100 58 10 3 km3 respectively the maximum relative values of eesv are 2 25 7 73 14 80 respectively and the maximum rusv values are 13 62 10 3 km3 27 83 10 3 km3 and 38 67 10 3 km3 respectively the results illustrate that the ocean currents error can also make the sweeping volume deviate from the actual value the larger the currents error is the greater uncertainty of the sweeping volume is by comparing fig 6b and c we can see that at a certain moment the eesv is about two times of the rusv for all background error levels this indicates that the influence of currents error on the simulation result of sweeping volume is greater in terms of its mean value than in terms of its uncertainty 5 disscussion it should be noted that when the currents error is 0 experiment 1 both the mean error and the spread are not zero this is due to the random walking method itself and also indicates that the uncertainty is inherent in the oil spill model itself or rather that the result may be different every time we run the oil spill simulation even if with the same ocean dynamical background nevertheless from the results shown in fig 4 6 we can see that this uncertainty is much smaller than the uncertainty caused by the error in the ocean background in all perturbed experiments thus the investigations about the results above still make sense as we have seen above since the random error is added into the ocean currents the model metrics considered in this paper including the centroid position sweeping area and sweeping volume will deviate from their reference values both the error of oil spill simulation and the model spread are larger when a larger error is added to the ocean currents background while they also grow with the model time furthermore the mean value of the model error in the metric of centroid position is comparable to the spread while the mean value of the model error in the other two metrics is much greater indicating that the error in the background of ocean currents impact the oil spill forecasting and environmental effect assessment in different ways in this section we will further investigate how the background error influences the model result in terms of the error distribution in different directions and in different depths impacts on oil droplets of different sizes and the relation between temporal variation of model error and that of the local current vectors 1 spread of centroid position in different directions fig 7 shows the temporal variation of the centroid position spread projected to both x and y coordinates it is clear that the spread is quite different in two directions and the spread in x direction is obviously larger than that in y direction when the relative error of ocean currents are 10 20 and 30 the maximum values of the spread in x direction are 0 22 km 0 50 km and 0 75 km respectively and in y direction 0 09 km 0 22 km and 0 28 km respectively this further indicates that the uncertainty of the centroid position caused by current error is anisotropic which can also be seen from fig 4a according to fang and yang 1985 and luo and liu 2015 bohai sea has the feature of semi diurnal flow the tide current is rotary in the center area of bohai sea and it has a dominant direction which means that the tide current is anisotropic so the background currents used in this paper combined effect of tides and winds might also be anisotropic which can also be seen in fig 12 a in fig 12 a it is clear that the magnitude of the velocity is different when the direction varies the magnitude is usually large when the direction is close to x axis 90 or 270 and small when the direction is close to y axis 0 or 180 in our way of imposing error to the background currents the absolute error is larger in x direction than in y direction so the error spread in x direction is obviously larger than in y direction thus we can say that the anisotropic uncertainty of the centroid position may be caused by the variation of the ocean currents direction during the transport and diffusion of the spilled oil 2 result in different layers in order to examine the result in different depth ranges the water column is vertically divided into three layers the first layer is from 0 m to 8 m the sea surface is excluded the second one is from 8 m to 16 m and the third one is from 16 m to 24 m the metrics of the oil in each layer are calculated separately fig 8 shows the impact of ocean currents error on the metric of centroid position and sweeping area in the three layers including both their mean value and spread the metric of sweeping volume performs similarly to the sweeping area and is not shown here in fig 8 we can see that the simulation error varies with both the time and currents error which is similar to the results shown in section 4 but here we can see clearly that the vertical distribution of simulation error is quite different among metrics for the metric of centroid position the value of eecs and rucp in the bottom layer is larger than those in other two layers while the mean value of eesa and rusa in the bottom layer is smaller indicating that the bottom layer contribute more to the oil trajectory prediction error which however has limited negative effect on the error in estimating the overall contamination area 3 behavior of oil droplets of different sizes in this part we mainly discuss the response of the oil particles of different diameters to a certain current error in terms of the different metrics since the result of underwater oil spill model is in fact the integration of the behaviors of a large amount of oil droplets the droplet diameters of 10 µm 50 µm 750 µm and 2500 µm are picked out as examples and the maximum relative current error is set as 20 fig 9 shows the time variation of the centroid position of oil particles of different typical diameters under the influence of ocean currents error from fig 9 we can see that for the surface oil the mean error and the spread of droplets of four diameters present a similar temporal variation but the values of two large diameters are slightly larger than those of two small ones indicating that the oil droplet of larger size may be more sensitive to the ocean currents error this may be due to that the larger droplets can reach the sea surface earlier and the model error is mainly contributed by the background errors from sea surface because the currents here are usually large so that the absolute value of imposed error is large on the other hand for the underwater oil the errors for two large droplets are very close to zero because they come to the sea surface very soon after released into ambient water indicating that the underwater model error is mainly contributed by small oil droplets besides it is interesting that in fig 9b and d the smaller droplet has a slightly larger error and spread indicating that the result of smaller droplets is more sensitive to the ocean currents error when we focus on the underwater transport of spilled oil fig 10 shows the time variation of the sweeping area of oil particles of different typical diameters under the influence of ocean currents error in fig 10 we can see that the mean errors in the surface sweeping area for two smaller droplets are larger indicating that smaller droplets are more sensitive to the current error meanwhile the spreads are comparable for all four diameters meaning that the influence of the current error on the uncertainty of surface sweeping area is mainly up to the currents error itself on the other hand it is quite interesting of the underwater result as shown in fig 10b the curves of two larger droplets are close to zero and the curve of the droplet of 50 µm is larger than that of the droplet of 10 µm in fact if the oil droplet is large its underwater time is usually short and then the influence of the currents error is limited but if the droplet is small it usually spend a long time in the deep water area where the currents here are always weaker and the absolute current error is small thus it is the droplet of medium size that is the most sensitive to the ocean currents error which is consistent with the result of the spread shown in fig 10d fig 11 shows the time variation of the sweeping volume of oil particles of different typical diameters under the influence of ocean currents error fig 11 shows that the impact of currents error on the sweeping volume of oil particles with different typical diameter is also different including both the mean error and the spread the mean error and the spread of two larger droplets are much smaller than those of two smaller droplets because the larger droplet are mainly distributed at the sea surface soon after released due to their larger buoyancy velocity in both terms of the mean error value and the spread of the metric again the 50 µm droplet has a higher curve than the other three which can also be explained as in fig 10b the discussion in this part indicates that the oil droplet of different diameter has a different response to the same current error level these droplets of different diameters play different roles at different water depth and their sensitivity to the current error mainly depend on the intensity of local currents and their underwater time 4 variation of the error grows rate with time in section 4 we have seen that the model errors in all metrics grow with time in an uneven rate here we will further examine the underlying reason for this uneven variation fig 12 a shows the magnitude and direction of the local advection velocity combined effect of currents and wind along the oil trajectory during the 48 hours of simulation and fig 12b shows the growth rate for the mean errors of three metrics from fig 12b we can see that the growth rates of three metrics are all positive and vary periodically with time which is similar to the variation of advection velocity shown in fig 12a besides the growth rates of eecs vary almost in a synchronous manner while the eesa and eesv has a phase lag by comparing the two images in fig 12 we can see that the growth rate of eecs usually reaches a local maximum when the local advection velocity magnitude reaches a local maximum indicating that the model error in the oil trajectory is sensitive to the intensity of the advection velocity this may be caused by our way of imposing error to the background currents in which the absolute error is larger for a stronger current and this way is also consistent with the practical case on the other hand from fig 12 we can also see that the growth rates of eesa and eesv usually achieve a local peak after a certain time when the magnitude of local advection velocity has a sharp decline indicating that the response of model error in both the sweeping area and volume to the ocean background error has a time lag which is different from the case of the centroid position the reason may be that both the sweeping area and volume can be treated as an integrated result of the oil trajectory and it is well known that the integral value of a periodic function reaches its maximum between the maximum and minimum of the periodic function 6 summary and conclusions based on an unstructured grid finite volume coastal ocean model fvcom and a validated underwater oil spill model the impact of error in ocean dynamical background on the transport of underwater spilled oil was studied through a series of numerical experiments in this paper the impact on the metrics of centroid position sweeping area and sweeping volume which were directly derived from the oil spill model result was investigated quantitatively and how the background error influences the model result was also further discussed numerical results show that errors in ocean currents of the background could not only make the predicted centroid position of the spilled oil shift from the actual position but also make the estimated values of sweeping area and sweeping volume deviate from their actual values for all three metrics both the mean error and the spread increase with the level of added background current error and grow with time further analysis shows that for the predicted oil centroid position the horizontal spread grows with time in all directions but varies in different directions at a certain moment which may be caused by the horizontal inhomogeneity of the current field on the other hand the oil spill model result is actually the integrated results of particles from different depth and particles of different oil droplets sizes the background currents are usually different at different depth while the oil droplets of different sizes usually appear at different water depth because they have different buoyancy velocities as a result oil droplets of different sizes play different roles in the model results from sea surface and from underwater generally the impact of ocean background error on the underwater metrics is mainly related to the result of small droplets because the smaller droplets can stay underwater for a longer time for the oil trajectory prediction the background error has a larger effect on larger oil droplets since the larger oil droplets can more quickly reach the sea surface where the currents are usually strong so is the current error but for the sweeping area and volume estimation the result of smaller droplets is usually more sensitive to the background error because both metrics are related to a 3d distribution of the oil particles and the larger droplets are mainly distributed at the sea surface for all three metrics the oil spill model error increases with time on the whole but the growth rate varies unevenly through comparison with the currents along the oil trajectory we find that the varying growth rate can be attributed to the varying current magnitude because stronger currents usually contain larger errors but the growth rate variations of the three metrics are not synchronous and there is a time lag of several hours between the centroid position and other two metrics our study indicates that in the study and practical application of underwater oil spill model more attention should be paid to the effect of error in dynamical background effective measures should be taken to reduce the error so as to improve the accuracy of oil spill models and to provide more reliable information for the oil spill monitoring moroni et al 2016 damage assessment and emergency response acknowledgments we would like to deeply thank the editors and anonymous reviewers for their constructive suggestions whereby this work has been improved greatly partial support for this research was provided by the national key research and development plan through grant 2016yfc1402304 the national natural science foundation of china through grants 41806111 and 41606006 the key research and development plan of shandong province through grant 2016zdjs09a02 and the ministry of education s 111 project through grant b07036 
24068,based on a validated underwater oil spill model and the hydrodynamic background provided by an unstructured grid finite volume coastal ocean model fvcom a series of numerical experiments are conducted to study the impact of error in ocean dynamical background currents on the 3d transport of underwater spilled oil in terms of three metrics including oil centroid position sweeping area and sweeping volume numerical result shows that a larger error in ocean dynamical background currents results in a larger model error expectation and uncertainty for all three metrics as model time increases the model error mainly increases and the error growth rate varies unevenly the sensitivity of the oil spill model to background current error can be interpreted as an integrated result of the temporal and spatial variations of the background current and the movement of oil droplets of different sizes keywords underwater oil spill ocean dynamical background error numerical simulation contingency planning environmental damage assessment 1 introduction with the extensive exploration of offshore oil and gas resources the risk of underwater oil spill is increasing there are frequent serious offshore oil spill accidents in the last several years such as the 2010 deepwater horizon oil spill in the gulf mexico boufadel et al 2014 and the 2011 penglai 19 3 oil field oil spill in the bohai sea of china xu et al 2013 the offshore oil pollution has become increasingly serious which may not only cause huge economic losses to fishery aquaculture and other industries but also cause extensive damage to the ocean environment and ecosystem different from the oil spilled from the sea surface the transport and diffusion behaviors of underwater spilled oil are difficult to observe effectively therefore numerical simulation of transport diffusion behaviors and the spatial distribution of the underwater spilled oil serves as a useful and in most cases the only reference for the damage assessment and emergency response the study of underwater oil spill model began in the 1970s early studies were mainly concerned with surface near surface or shallow water oil spills such as topham 1975 mcdougall 1978 fannelop and sjoen 1980 johansen 1984 elliott 1986 lee and cheung 1990 rye 1994 yapa and zheng 1997 yapa et al 1999 and lonin 1999 the subsequent efforts were mainly devoted to developing an enhanced comprehensive oil spill model to describe deepwater oil spills two of such well known models are deepblow johansen 2000 and adms cdog zheng and yapa 2002 both of which can simulate the complex behavior of spilled oil in the deep sea environment based on the previous studies chen et al 2015 developed a deepwater oil spill model and verified it through comparing model predictions with data observed from a field experiment the model is also applied to simulating a hypothetical oil spill taking place at the seabed of a deep water oil gas field in the south china sea as to the transport simulation of the spilled oil bandara et al 2011 developed a novel numerical model to simulate oil sediment interaction and transport in near shore waters janeiro et al 2014 implemented an operational model to plan and respond to oil spill accidents described the model in detail and discussed the effect of wave induced stokes drift on the transport of spilled oil weisberg et al 2017 reviewed the evolution of the surface oil as it approached the beach and considered the mechanisms of transport in their study both effects of ocean circulation and ocean waves on the oil transport were discussed besides some studies focused on the 2011 penglai 19 3 oil spill accident for example deng et al 2013 and xu et al 2015 simulated the time and area the spilled oil may reach the surrounding coast after a long enough time zhou et al 2016 and wei et al 2015 discussed the impact of the spilled oil on the environment and the damage assessment hitherto although there are many studies of oil spill simulation the oil spill model is not always sufficiently accurate and sometimes cannot provide reliable information due to various error sources such as the wind current oil source etc it is necessary to analyze and identify major sources of error for the model some studies focused on the quantification and analysis of the uncertainty in oil spill simulation wang et al 2016 gonçalves et al 2016 iskandarani et al 2016 hou et al 2017 and some studies have shown sensitivity tests for the parameters and input data elliott 2004 jorda et al 2007 abascal et al 2010 besides some studies focused on other factors such as the length of integration time step the integration method the model resolutions and the schemes of vertical diffusion elliott and jones 2000 james et al 2004 li et al 2013 once the oil particles are released into water their movements are mainly determined by ocean currents the accuracy of ocean currents has a great influence on the accuracy of oil spill simulation thus it is necessary to conduct study of the role of errors of the ocean dynamical background in the underwater spilled oil simulation based on the fvcom generated ocean dynamical background and oil spill model developed by chen et al 2015 the influence of error in ocean dynamical background on the transport of underwater spilled oil is studied in this paper through simulation of penglai 19 3 oil spill accident that occurred in the bohai sea on june 4 2011 the impact of ocean currents error on the centroid position the sweeping area as well as the sweeping volume is investigated quantitatively and how the currents error influences the model result is also discussed by analyzing the results the impact of ocean currents error on the transport of subsea spilled oil becomes clear and the importance of the accuracy of ocean currents in oil spill modeling can be better understood besides useful information could be provided for spilled oil monitoring contingency planning and environmental damage assessment 2 model description 2 1 ocean model to force the oil spill model the background hydrodynamic data such as the current velocity temperature salinity and potential density is needed in this paper it is provided by a 3d forecasting system based on an unstructured grid finite volume coastal ocean model fvcom the model consists of momentum continuity temperature salinity and density equations and is closed physically and mathematically by using the mellor and yamada level 2 5 turbulent closure submodel the irregular bottom slope is represented using a sigma coordinate transformation and the horizontal grids comprise unstructured triangular cells the model combines the advantages of the finite element method for geometric flexibility and finite difference method for simple discrete computational efficiency and can produces a better simulation of tidal elevations and residual currents especially around islands and tidal creeks chen et al 2003 in the sigma coordinate the governing equations of the model are given as 1 u d t u 2 d x u v d y u w σ f v d g d ζ x g d ρ 0 x d σ 0 ρ d σ σ ρ d x 1 d σ k m u σ d f x 2 v d t u v d x v 2 d y v w σ f u d g d ζ y g d ρ 0 y d σ 0 ρ d σ σ ρ d y 1 d σ k m v σ d f y 3 θ d t θ u d x θ v d y θ w σ 1 d σ k h θ σ d h d f θ 4 s d t s u d x s v d y s w σ 1 d σ k h s σ d f s 5 ρ ρ θ s where x y and z are the east north and vertical axes of the cartesian coordinate u v and w are the x y z velocity components ρ is the density p is the pressure θ is the potential temperature s is the salinity f is the coriolis parameter g is the gravitational acceleration fu fv f θ and fs are the horizontal momentum thermal and salt diffusion terms km represents the vertical eddy viscosity coefficient and kh represents the thermal vertical eddy diffusion coefficient km and kh are parameterized by using the mellor and yamada 1982 level 2 5 turbulent closure scheme the equations for q 2 and q 2 l can be described as follows 6 q 2 d t q 2 u d x q 2 v d y q 2 w σ 2 d p s p b ɛ 1 d σ k q q 2 σ d f q 7 q 2 l d t q 2 l u d x q 2 l v d y w d q 2 l w σ l e l d p s p b w e l ɛ 1 d σ k q q 2 l σ d f l where q 2 u v 2 is the turbulent kinetic energy l is the turbulent macroscale kq is the vertical eddy diffusion coefficient of the turbulent kinetic energy fq and fl are the horizontal diffusion of the turbulent kinetic energy and macroscale p s k m u z 2 v z 2 2 and p b g k h ρ z ρ 0 are the shear and buoyancy production terms of turbulent kinetic energy ɛ q 3 b l l is the turbulent kinetic energy dissipation rate w 1 e 2 l 2 κ l 2 is a wall proximity function where κ 0 4 l 1 ζ z 1 h z 1 h is the mean water depth and ζ is the free surface elevation the turbulent kinetic energy and macroscale equations are closed by defining 8 k m l q s m k h l q s h k q 0 2 l q the stability functions sm and sh are calculated as modified by galperin et al 1988 the horizontal diffusion terms are given as 9 d f x x 2 a m h u x y a m h u y v x 10 d f y x a m h u y v x y 2 a m h v y 11 d f θ f s f q 2 f q 2 l f y x a h h x y a h h y θ s q 2 q 2 l where am and ah represent the horizontal eddy and horizontal thermal diffusion coefficients respectively at the surface where σ 0 the boundary conditions are 12 u σ v σ d ρ 0 k m τ s x τ s y w 0 13 θ σ d ρ c p k h q n x y t s w x y 0 t 14 s σ s p e d k h q 2 l 0 15 q 2 b l 2 3 u τ s 2 at the bottom where σ 1 16 u σ v σ d ρ 0 k m τ b x τ b y w 0 17 θ σ s σ 0 q 2 l 0 18 q 2 b l 2 3 u τ b 2 where τ sx τ sy and τ b x τ b y c d u 2 v 2 u v are the x and y components of sea surface wind and bottom stresses and d h ζ the drag coefficient cd is calculated by matching a logarithmic bottom layer at the height zab above the bottom that is 19 c d max κ 2 ln z a b z 0 0 0025 here z 0 is the bottom roughness parameter cp is the specific heat of seawater qn x y t is the surface net heat flux including four components downward shortwave and longwave radiation and sensible and latent fluxes sw x y 0 t is the shortwave flux incident at sea surface p and e are the precipitation and evaporation rates respectively before running the model the horizontal computational domain is subdivided into unstructured triangular grids fig 2a and ζ s θ ρ q 2 q 2 l h d km kh am and ah are placed at nodes while u v are placed at centroids variables at each centroid are determined by a net flux through the three sides of that triangle and variables at each node are calculated based on a net flux through the sections linked to the centroids in the surrounding triangles with connection to that node 2 2 underwater oil spill model based on the knowledge learned from previous studies the whole underwater process of oil spill can be divided into three successive stages including the turbulent jet stage the buoyant plume stage and the advection diffusion stage among them the first two stages can be simulated by the plume dynamics model pdm while the last stage can be simulated by the advection diffusion model adm in the pdm a small amount of spilled oil and water is mixed and can be treated as an entirety and the interaction between oil and the ambient water should be considered in the adm the spilled oil is divided into a certain number of discrete particles each of which represents a set of oil droplets and is characterized by its volume droplet size diameter spatial coordinate and velocity etc these particles move passively under the force of shear current turbulence and buoyancy 2 2 1 plume dynamics model pdm in the pdm the lagrangian integral technique is utilized to simulate the turbulent jet stage and the buoyant plume stage of the spilled oil the oil spill duration is divided into a series of intervals with equal length of δt as shown in fig 1 and each time interval corresponds to a small amount of spilled oil thus the oil water plume can be represented by a series of non interfering control elements and it is assumed that each of the control elements is a cylinder section of a bent cone and its bottom plane is perpendicular to the plume trajectory the radius local velocity and density of the element are b m v m s and ρ kg m3 so the element thickness is h v δ t m and its mass is m ρπb 2 h kg the element is also characterized by a set of variables such as temperature salinity and oil concentration etc these variables represent the average values for an element and will change as the element moves in the 3d space the following governing equations are applied to the control elements 1 conservation of mass and momentum the control element may change in mass due to entrainment which can be described by the following equation 20 d m d t ρ a q e where ρ a is the density of ambient fluid kg m3 qe is the volume flux m3 s entrained through shear induced entrainment and forced entrainment the oil momentum will change due to the interaction between oil and its ambient fluid when the oil is spilled into ambient environment the momentum change rate of a control element can be described by the following equation according to the law of momentum conservation 21 d m v d t ρ a q e v a m δ ρ ρ g k where v a is the average velocity vector m s of the ambient fluid flowing over the front surface of plume δρ ρ a ρ is the density difference kg m3 between the ambient environment and the control element and k is the unit vector in the vertical direction the first term of the right hand side of eq 21 represents the momentum change due to entrainment and the second term represents the change due to buoyant force the influence of oil dissolution and drag force on the momentum change have been neglected because they are much smaller than the two given terms 2 conservation of heat salinity and oil mass the heat salinity and oil concentration will change in a control element due to the exchange of material and heat between the buoyant plume and its ambient environment this process can be described by the following conservation equation 22 d m i d t ρ a q e i a where i is a scalar parameter and denotes the heat cpt salinity s or oil concentration c cp is the specific heat for water cp 4216 3j kg k and for crude oil cp 2200j kg k jamaluddin et al 1991 3 state equation in the pdm the seawater potential density is calculated with the international equation of state of sea water 1980 eos80 fofonoff and millard 1983 which relates the seawater potential density to the temperature salinity and pressure the oil density variation due to temperature is calculated according to the national standard of petroleum measurement tables gb t 1885 1998 china s national standard 1998 4 entrainment formulation the plume mass increases as the ambient fluid is entrained into the buoyant plume through the exterior surface of the plume during migration of the buoyant plume through water column a proper estimation of entrainment rate of the ambient fluid qe in eq 20 is important in buoyant plume simulation according to frick 1984 and lee and cheung 1990 the entrainment contains two distinct processes identified as shear induced entrainment and forced entrainment the first one is due to shear between the buoyant plume and the ambient fluid and is present even when there is no ambient flow the second one is due to the advection of ambient flow into the buoyant plume accordingly the entrainment rate qe is calculated as follows 23 q e q s q f where qs represents the volume fluxes m3 s due to shear induced entrainment and qf represents the volume fluxes m3 s due to forced entrainment the two terms are calculated with the functional form as fischer et al 1979 and yapa and zheng 1997 respectively 2 2 2 advection diffusion model adm in the present adm the lagrangian particle tracking random walking method is utilized to simulate the oil transport in advection diffusion stage this method not only can avoid the numerical diffusion problem besetting the discretized advection diffusion equation but also can describe some physical diffusion process accurately such as the breakup and separation of oil slick some studies have shown that this method is significantly more efficient in the cases of higher dimension and relatively few particles and also where the contaminant resides in a patch occupies only a portion of the whole model area al rabeh et al 1989 yapa et al 1999 wang et al 2008 dasanayaka and yapa 2009 concretely the movement of an oil particle in the 3d environment is described by the following equation 24 d s d t v v v 10 w b k where s x y z is the displacement of an oil particle and x y and z are the cartesian coordinates v is the advection velocity due to the effect of ocean currents which is a significant factor in the oil transport and is obtained from the ocean model described in section 2 1 v is the diffusion velocity due to turbulent diffusion process and is calculated as the following formula 25 v 6 δ t r x k h r y k h r z k z where rx ry and rz are uniformly distributed random numbers ranging from 1 to 1 and are independent of each other v 10 represent the wind drift effect on oil movement and v 10 α u 10cos β v 10sin β u 10sin β v 10cos β where u 10 and v 10 are wind velocities at 10 m above sea surface α is drift factor and β is deviation angle in the present model αis taken as 0 03 β 40 8 u 10 2 v 10 2 4 when 0 u 10 2 v 10 2 25 m s and β 0 when u 10 2 v 10 2 25 m s wang et al 2008 wang and shen 2010 wb is the buoyancy velocity and can be calculated using either the stokes law or the reynolds law depending on the oil droplet size as described in yapa et al 1999 the oil droplet size is a significant factor in the adm in this paper its distribution is estimated according to delvigne and hulsen 1994 and wang et al 2008 since their simulation result corresponds to the experience of oil industry staffs from the offshore drilling platforms in the modeling area of this paper actually the pdm plays a role of providing a reasonable source for the adm guaranteeing a dynamical rationality for simulating the underwater part of oil spill process in the present model we follow yapa et al 1999 to use the neutral buoyancy level criterion to define the transition point between pdm and adm 2 2 3 oil spill weathering models when the oil is transported through the water column or on the sea surface the oil movement and property will be impacted by some weathering processes typically like the oil dissolution evaporation emulsification etc according to some previous related studies some typical weathering process is considered in the present oil spill model and formulated as follows 1 dissolution the mass loss rate due to oil dissolution into ambient environment can be written as 26 d m d i s s d t k d a c s c w where dmdiss is the mass loss due to dissolution kg kd is the dissolution mass transfer coefficient m s cs is the oil solubility in water kg m3 and cw is the initial concentration of oil in water kg m3 the present model assumes that cw cs and thus cw 0 details on computing kd and cs were given in riazi and edalat 1996 in the pdm a is the area of exposed plume surface m2 in the adm for underwater oil it is the area of the oil particles and in the adm for sea surface oil it is approximately equal to the area of oil slick 2 evaporation evaporation is the primary cause of rapid mass reduction of the surface oil the rate of evaporation can be written as follows stiver and mackay 1984 27 f v ln 1 b n t g t θ n e a n b n t 0 t t b n t g where fv is the evaporated fraction a 6 3 b 10 3 t is the temperature of spilled oil k t 0 is the initial boiling point of the oil k tg is the curve gradient of the oil boiling point and θ is the coefficient of evaporation which is defined as θ k a t v 0 k is the mass transfer coefficient m s t is the time s v 0 is the initial volume m3 of the oil particles 3 emulsification an empirical approach has been taken to estimate the rates of emulsification and the time evolution of the water content of the surface oil is computed according to rasmussen 1985 and wang et al 2005 28 y w 1 k b 1 e k a k b 1 w 2 t where yw is the water content of the emulsion ka is taken as 4 5 10 6 k b 1 y w f 1 25 y w f is the stable water content of the emulsion with the value of 0 8 and w is the wind speed m s 4 density change of oil the processes of evaporation and emulsion can influence the density of the remaining oil both effects are taken into account through the following formulation wang et al 2005 29 ρ 1 y w 0 6 ρ 0 0 34 f v ρ 0 y w ρ w where ρ is the density of the remaining oil ρ0 is the density of the initial oil ρ w is the water density 3 experiment description 3 1 implementation and validation of fvcom since the accident took place at the seabed of penglai 19 3 platform in the bohai sea we used the fvcom to cover the whole domain ranging from 117 5 e to 122 3 e and from 37 n to 41 n fig 2 a the horizontal resolution is 1 24 and in the vertical direction the water column is equally divided into 10 sigma layers bathymetry data were downloaded from general bathymetric chart of the oceans gebco with a horizontal resolution of 0 5 0 5 the wind data and other sea surface flux data such as the longwave radiation and latent heat flux etc are obtained from ncep climate forecast system version 2 cfsv2 with a horizontal resolution of 0 5 0 5 and temporal resolution of 6 h both temperature and salinity were set the same with chen et al 2003 which means that the initial temperature was specified as a vertical linear function with 25 c at the sea surface and 15 c at a depth of 75 m while the salinity was specified as a constant value of 30 psu the open boundary conditions for the water level were specified with 8 tidal constituents m2 s2 n2 k2 k1 o1 p1 and q1 which were derived from a tidal model with the adjoint method lv et al 2006 zhang et al 2008 in this paper we run the ocean model for two months from may 1st to june 30th and validate the model by comparing the observation with the simulation fig 2b and c show the comparisons between the observed and simulated elevation at two stations located in the bohai sea there was a good agreement between observation and simulation demonstrating that the ocean model can provide a reliable simulation of hydrodynamic environment the oil spill model is off line coupled to the hydrodynamic model from the simulation result of fvcom we extracted the hydrodynamic data and interpolated them to the positions of oil plumes pdm or oil particles adm at every time step to force the oil spill model the data period ranges from 12 00 on june 17th to 12 00 on june 19th 2011 with an interval of 1 h 3 2 oil spill model calibration in this section we use two satellite images xu et al 2013 at 02 14 57 on june 11 fig 3 a and at 02 05 02 on june 14 fig 3b respectively to conduct the calibration of our oil spill model xu et al 2013 pointed out that the oil slicks f and g in fig 3b are originated from oil slicks c and d in fig 3a thus we use the oil slicks c and d as the source of our adm model at 02 15 00 on june 11 and compare the simulate results at 02 05 00 on june 14 with the distribution of detected oil slicks f and g in fig 3b from fig 3c we can see that after nearly 72 hours the oil slicks c and d mainly transported to the east north direction the simulated transport direction and final position of the oil slick are consistent with the observation data demonstrating that our oil spill modelling system can provide a reliable simulation of spilled oil transport 3 3 sensitivity experiment in order to study the impact of ocean currents error on the transport of underwater spilled oil four numerical experiments were designed in this paper the experiment 1 is a control experiment in which the advection velocities v in eq 24 of the currents were extracted from the ocean model and are treated as the error free flow field with no prediction error or observation error of the ocean in the experiment 2 3 and 4 different relative random errors of 10 20 and 30 were added respectively to the ocean currents of experiment 1 and the currents are taken as the error flow field with different prediction error or observation error then the current fields in the four experiments are respectively treated as the dynamical background for the oil spill model and the difference between the results are analyzed quantitatively the oil spill took place at the seabed of penglai 19 3 platform in the bohai sea of china as shown in fig 2a the oil is assumed to be spilled upwards from the seabed into the sea the spill started at 12 00 p m on 17 june 2011 and the spill duration is 1 h the oil spill model employs 100 000 lagrangian particles to simulate the transport of the spilled oil and other discharge conditions are summarized in table 1 in the adm the horizontal and vertical diffusivities are 0 05 and 0 001 m2 s at the sea surface respectively both diffusivities are assumed to be constant in the top 10 m of the water and then decreased proportional to the distance between oil particles and the water surface yapa et al 1999 after a certain random error is added to the currents the currents are used to drive the oil spill model in the perturbed experiments experiment 2 3 and 4 and different oil spill simulation results can be obtained at different times therefore we perform each of the perturbed experiment 100 times denoted as scenarios furthermore random walking method itself can also cause an uncertainty and even though no error is added to the ocean background in the control experiment experiment 1 different results still can be obtained every time we perform the oil spill model thus we also perform the control experiment 100 times based on oil spill modeling results of the 100 scenarios in each experiment the error expectation and result uncertainty of different metrics such as the centroid position the sweeping area as well as the sweeping volume will be quantified at different time steps the computing method of error expectation and result uncertainty at a time are described as follows 30 error expectation j 1 n s j s 0 n result uncertainty j 1 n s j s 2 n where sj is the metric value of the four experiments s 0 is the mean metric value of the control experiment s is the mean value of sj and n equals 100 the error expectation refers to the mean error between the perturbed experiments and the control experiment of the results of 100 scenarios and can tell us to what extent the oil spill error can be expected while the result uncertainty is derived from the standard deviation of the results of 100 scenarios and can tell us how uncertain the oil spill simulation result can be due to the uncertainty of error in the ocean dynamical background it should be noted that for the error expectation we use the absolute mean value and not directly use the mean value of 100 scenarios in consideration of the uncertainty of the ocean dynamical background error in fact only one scenario can really occur among all 100 scenarios in actual case since the ocean dynamical background error is designed to be randomly distributed around zero the mean of all 100 scenarios is quite close to zero from which however we cannot arbitrarily draw a conclusion that the error in the ocean dynamical background has little effect on the oil spill simulation 4 results 4 1 centroid position fig 4 a shows the impact of ocean currents error on the centroid position of spilled oil at the sea surface in fig 4a it is obvious that the centroid position varies with time and the spread of the 100 green points centroid positions also increases with time the results illustrate that once the random error is added into the currents the centroid position of the spilled oil will shift and the spread of model result will also increase with time besides the red points are the mean positions of all 100 scenario results they are so close to and almost coinside with the black points at the same time step in fact the background errors in 100 scenarios are symmetric around the zero point resulting in symmetry of the oil spill simulation errors around the zero point this does not help us understand the effect of a certain ocean background error on the oil spill simulation which is what we are really concerned about this is also why we take form of absolute mean as the error expectation in eq 30 in order to quantitatively examine the impact of the currents error on the modeled trajectory of the spilled oil the centroid shift the distance between the centroid points of perturbed experiments and that of the control experiment at the same moment and the spread of centroid positions under different background error levels are calculated in this paper fig 4b and c show the impact of ocean currents error on the error expectation of centroid shift eecs of the surface oil and underwater oil respectively it should be noted that the eecs does not refer to the distance between the mean centroid position of the 100 scenarios the red points in fig 4a and the mean centroid position of the control experiment the black points in fig 4a instead it refers to the mean value of the 100 shift distances between the green points and the black point at the same moment in fig 4a and thus can tell us to what extent the centroid shift can be expected when a certain error is added to the ocean current background fig 4b and c illustrate that the value of eecs increase not only with the time but also with currents error level in experiments 2 3 and 4 where the currents error are 10 20 and 30 the maximum values of eecs within 48 hours are 0 20 km 0 46 km and 0 69 km respectively fig 4d and e show the impact of ocean currents error on the result uncertainty of centroid position rucp of the surface oil and underwater oil respectively in fig 4d and e it is obvious that the value of rucp increase both with the time and with the currents error during the 48 h of modeling the maximum values of rucp are 0 23 km 0 55 km and 0 80 km for the relative ocean currents error of 10 20 and 30 respectively by comparing all four figures of fig 4b e we can see that the range of the eecs and rucp are roughly the same for the surface oil and underwater oil indicating that the currents error can influence the centroid position and the spread of the centroid position to the same extent the above results illustrate that the ocean currents error can make the centroid position of the modeled oil shift from the actual position both at the sea surface and in the water column the larger the relative current error is the larger the average shift distance and uncertainty of centroid position are 4 2 sweeping area the sweeping area is defined as the total area of grids where the water has ever been contaminated since spill began fig 5 a shows the sketch of sweeping area of the spilled oil at the sea surface it is obviously that the sweeping area increase with the time and when the error is added to the background currents the sweeping area changes correspondingly in order to quantitatively examine the impact of the currents error on the modeled sweeping area of the spilled oil the error expectation of sweeping area eesa and the result uncertainty of sweeping area rusa under different background error levels are calculated in this paper fig 5b e show the simulation error in the sweeping area in terms of the mean value and spread for both the surface oil and underwater oil as can be seen a larger ocean currents error will result in a larger model error in the sweeping area meanwhile the values of eesa and rusa also increase with ocean currents error and time which is similar to the results of centroid position shown in fig 4 table 2 shows the maximum absolute value and relative value of eesa within 48 hours the relative value of eesa refers to the ratio of the eesa value in experiment 2 3 and 4 to the mean sweeping area value in experiment 1 at the same moment from table 2 we can see that under the influence of a certain current error the underwater absolute error is smaller than the surface one but the case of the relative error is opposite for the current errors of 10 20 and 30 4 3 sweeping volume the sweeping volume is defined as the total volume of grid cells where the water has ever been contaminated since spill began when the error is added to the background currents the sweeping volume also changes in order to quantitatively investigate the impact of the currents error on the total amount of contaminated water the metric of sweeping volume under different background error levels is calculated in this paper fig 6 b and c shows the temporal variation of the mean error in the sweeping volume and the spread fig 6b refers to the error expectation of sweeping volume eesv and fig 6c refers to the result uncertainty of sweeping volume rusv respectively in fig 6 it is obvious that both eesv and rusv also increase both with the background error and with the modeling time within 48 h when the ocean currents error are 10 20 and 30 the maximum absolute values of eesv are 14 80 10 3 km3 46 25 10 3 km3 and 100 58 10 3 km3 respectively the maximum relative values of eesv are 2 25 7 73 14 80 respectively and the maximum rusv values are 13 62 10 3 km3 27 83 10 3 km3 and 38 67 10 3 km3 respectively the results illustrate that the ocean currents error can also make the sweeping volume deviate from the actual value the larger the currents error is the greater uncertainty of the sweeping volume is by comparing fig 6b and c we can see that at a certain moment the eesv is about two times of the rusv for all background error levels this indicates that the influence of currents error on the simulation result of sweeping volume is greater in terms of its mean value than in terms of its uncertainty 5 disscussion it should be noted that when the currents error is 0 experiment 1 both the mean error and the spread are not zero this is due to the random walking method itself and also indicates that the uncertainty is inherent in the oil spill model itself or rather that the result may be different every time we run the oil spill simulation even if with the same ocean dynamical background nevertheless from the results shown in fig 4 6 we can see that this uncertainty is much smaller than the uncertainty caused by the error in the ocean background in all perturbed experiments thus the investigations about the results above still make sense as we have seen above since the random error is added into the ocean currents the model metrics considered in this paper including the centroid position sweeping area and sweeping volume will deviate from their reference values both the error of oil spill simulation and the model spread are larger when a larger error is added to the ocean currents background while they also grow with the model time furthermore the mean value of the model error in the metric of centroid position is comparable to the spread while the mean value of the model error in the other two metrics is much greater indicating that the error in the background of ocean currents impact the oil spill forecasting and environmental effect assessment in different ways in this section we will further investigate how the background error influences the model result in terms of the error distribution in different directions and in different depths impacts on oil droplets of different sizes and the relation between temporal variation of model error and that of the local current vectors 1 spread of centroid position in different directions fig 7 shows the temporal variation of the centroid position spread projected to both x and y coordinates it is clear that the spread is quite different in two directions and the spread in x direction is obviously larger than that in y direction when the relative error of ocean currents are 10 20 and 30 the maximum values of the spread in x direction are 0 22 km 0 50 km and 0 75 km respectively and in y direction 0 09 km 0 22 km and 0 28 km respectively this further indicates that the uncertainty of the centroid position caused by current error is anisotropic which can also be seen from fig 4a according to fang and yang 1985 and luo and liu 2015 bohai sea has the feature of semi diurnal flow the tide current is rotary in the center area of bohai sea and it has a dominant direction which means that the tide current is anisotropic so the background currents used in this paper combined effect of tides and winds might also be anisotropic which can also be seen in fig 12 a in fig 12 a it is clear that the magnitude of the velocity is different when the direction varies the magnitude is usually large when the direction is close to x axis 90 or 270 and small when the direction is close to y axis 0 or 180 in our way of imposing error to the background currents the absolute error is larger in x direction than in y direction so the error spread in x direction is obviously larger than in y direction thus we can say that the anisotropic uncertainty of the centroid position may be caused by the variation of the ocean currents direction during the transport and diffusion of the spilled oil 2 result in different layers in order to examine the result in different depth ranges the water column is vertically divided into three layers the first layer is from 0 m to 8 m the sea surface is excluded the second one is from 8 m to 16 m and the third one is from 16 m to 24 m the metrics of the oil in each layer are calculated separately fig 8 shows the impact of ocean currents error on the metric of centroid position and sweeping area in the three layers including both their mean value and spread the metric of sweeping volume performs similarly to the sweeping area and is not shown here in fig 8 we can see that the simulation error varies with both the time and currents error which is similar to the results shown in section 4 but here we can see clearly that the vertical distribution of simulation error is quite different among metrics for the metric of centroid position the value of eecs and rucp in the bottom layer is larger than those in other two layers while the mean value of eesa and rusa in the bottom layer is smaller indicating that the bottom layer contribute more to the oil trajectory prediction error which however has limited negative effect on the error in estimating the overall contamination area 3 behavior of oil droplets of different sizes in this part we mainly discuss the response of the oil particles of different diameters to a certain current error in terms of the different metrics since the result of underwater oil spill model is in fact the integration of the behaviors of a large amount of oil droplets the droplet diameters of 10 µm 50 µm 750 µm and 2500 µm are picked out as examples and the maximum relative current error is set as 20 fig 9 shows the time variation of the centroid position of oil particles of different typical diameters under the influence of ocean currents error from fig 9 we can see that for the surface oil the mean error and the spread of droplets of four diameters present a similar temporal variation but the values of two large diameters are slightly larger than those of two small ones indicating that the oil droplet of larger size may be more sensitive to the ocean currents error this may be due to that the larger droplets can reach the sea surface earlier and the model error is mainly contributed by the background errors from sea surface because the currents here are usually large so that the absolute value of imposed error is large on the other hand for the underwater oil the errors for two large droplets are very close to zero because they come to the sea surface very soon after released into ambient water indicating that the underwater model error is mainly contributed by small oil droplets besides it is interesting that in fig 9b and d the smaller droplet has a slightly larger error and spread indicating that the result of smaller droplets is more sensitive to the ocean currents error when we focus on the underwater transport of spilled oil fig 10 shows the time variation of the sweeping area of oil particles of different typical diameters under the influence of ocean currents error in fig 10 we can see that the mean errors in the surface sweeping area for two smaller droplets are larger indicating that smaller droplets are more sensitive to the current error meanwhile the spreads are comparable for all four diameters meaning that the influence of the current error on the uncertainty of surface sweeping area is mainly up to the currents error itself on the other hand it is quite interesting of the underwater result as shown in fig 10b the curves of two larger droplets are close to zero and the curve of the droplet of 50 µm is larger than that of the droplet of 10 µm in fact if the oil droplet is large its underwater time is usually short and then the influence of the currents error is limited but if the droplet is small it usually spend a long time in the deep water area where the currents here are always weaker and the absolute current error is small thus it is the droplet of medium size that is the most sensitive to the ocean currents error which is consistent with the result of the spread shown in fig 10d fig 11 shows the time variation of the sweeping volume of oil particles of different typical diameters under the influence of ocean currents error fig 11 shows that the impact of currents error on the sweeping volume of oil particles with different typical diameter is also different including both the mean error and the spread the mean error and the spread of two larger droplets are much smaller than those of two smaller droplets because the larger droplet are mainly distributed at the sea surface soon after released due to their larger buoyancy velocity in both terms of the mean error value and the spread of the metric again the 50 µm droplet has a higher curve than the other three which can also be explained as in fig 10b the discussion in this part indicates that the oil droplet of different diameter has a different response to the same current error level these droplets of different diameters play different roles at different water depth and their sensitivity to the current error mainly depend on the intensity of local currents and their underwater time 4 variation of the error grows rate with time in section 4 we have seen that the model errors in all metrics grow with time in an uneven rate here we will further examine the underlying reason for this uneven variation fig 12 a shows the magnitude and direction of the local advection velocity combined effect of currents and wind along the oil trajectory during the 48 hours of simulation and fig 12b shows the growth rate for the mean errors of three metrics from fig 12b we can see that the growth rates of three metrics are all positive and vary periodically with time which is similar to the variation of advection velocity shown in fig 12a besides the growth rates of eecs vary almost in a synchronous manner while the eesa and eesv has a phase lag by comparing the two images in fig 12 we can see that the growth rate of eecs usually reaches a local maximum when the local advection velocity magnitude reaches a local maximum indicating that the model error in the oil trajectory is sensitive to the intensity of the advection velocity this may be caused by our way of imposing error to the background currents in which the absolute error is larger for a stronger current and this way is also consistent with the practical case on the other hand from fig 12 we can also see that the growth rates of eesa and eesv usually achieve a local peak after a certain time when the magnitude of local advection velocity has a sharp decline indicating that the response of model error in both the sweeping area and volume to the ocean background error has a time lag which is different from the case of the centroid position the reason may be that both the sweeping area and volume can be treated as an integrated result of the oil trajectory and it is well known that the integral value of a periodic function reaches its maximum between the maximum and minimum of the periodic function 6 summary and conclusions based on an unstructured grid finite volume coastal ocean model fvcom and a validated underwater oil spill model the impact of error in ocean dynamical background on the transport of underwater spilled oil was studied through a series of numerical experiments in this paper the impact on the metrics of centroid position sweeping area and sweeping volume which were directly derived from the oil spill model result was investigated quantitatively and how the background error influences the model result was also further discussed numerical results show that errors in ocean currents of the background could not only make the predicted centroid position of the spilled oil shift from the actual position but also make the estimated values of sweeping area and sweeping volume deviate from their actual values for all three metrics both the mean error and the spread increase with the level of added background current error and grow with time further analysis shows that for the predicted oil centroid position the horizontal spread grows with time in all directions but varies in different directions at a certain moment which may be caused by the horizontal inhomogeneity of the current field on the other hand the oil spill model result is actually the integrated results of particles from different depth and particles of different oil droplets sizes the background currents are usually different at different depth while the oil droplets of different sizes usually appear at different water depth because they have different buoyancy velocities as a result oil droplets of different sizes play different roles in the model results from sea surface and from underwater generally the impact of ocean background error on the underwater metrics is mainly related to the result of small droplets because the smaller droplets can stay underwater for a longer time for the oil trajectory prediction the background error has a larger effect on larger oil droplets since the larger oil droplets can more quickly reach the sea surface where the currents are usually strong so is the current error but for the sweeping area and volume estimation the result of smaller droplets is usually more sensitive to the background error because both metrics are related to a 3d distribution of the oil particles and the larger droplets are mainly distributed at the sea surface for all three metrics the oil spill model error increases with time on the whole but the growth rate varies unevenly through comparison with the currents along the oil trajectory we find that the varying growth rate can be attributed to the varying current magnitude because stronger currents usually contain larger errors but the growth rate variations of the three metrics are not synchronous and there is a time lag of several hours between the centroid position and other two metrics our study indicates that in the study and practical application of underwater oil spill model more attention should be paid to the effect of error in dynamical background effective measures should be taken to reduce the error so as to improve the accuracy of oil spill models and to provide more reliable information for the oil spill monitoring moroni et al 2016 damage assessment and emergency response acknowledgments we would like to deeply thank the editors and anonymous reviewers for their constructive suggestions whereby this work has been improved greatly partial support for this research was provided by the national key research and development plan through grant 2016yfc1402304 the national natural science foundation of china through grants 41806111 and 41606006 the key research and development plan of shandong province through grant 2016zdjs09a02 and the ministry of education s 111 project through grant b07036 
24069,the high spatial and temporal variability of biogeochemical features induced by local dynamics and terrestrial and atmospheric inputs in shelf seas are challenging issues for the implementation of data assimilation in these areas the objective of this study is to integrate satellite ocean colour observations with a coupled physical biogeochemical model in order to improve the spatiotemporal descriptions of chlorophyll and other biogeochemical variables in the mediterranean shelf seas we adopted a specifically developed three dimensional variational data assimilation scheme for the assimilation of satellite chlorophyll data the non homogeneous vertical component the non uniform and direction dependent horizontal component of the background error covariance are the key features of the upgraded three dimensional variational data assimilation scheme for shelf seas the application of the new assimilation scheme significantly improves chlorophyll estimates in shelf seas particularly in the representation of their spatial and temporal variability based on these results we provide an estimate of the annual primary production of the mediterranean basin keywords coastal water data assimilation phytoplankton chlorophyll primary production mediterranean sea 1 introduction the physical and biogeochemical dynamics in shelf seas are characterised by large spatial and temporal variability due to their interactions with coastal and bottom morphology and with boundary forcing in particular fronts and mixing associated with freshwater runoff internal waves tides and upwelling processes deeply affect the physical dynamics of shelf seas at spatial scales ranging from 10 m to more than 100 km denman and powell 1984 mann and lazier 2005 understanding the biogeochemical dynamics in shelf seas is crucial for defining the environmental status of coasts and for supporting blue growth initiatives she et al 2016 furthermore an improved shelf seas description results in a more consistent picture of basin scale biogeochemical dynamics observations both in situ and remote and models can provide descriptions of shelf marine biogeochemistry at different spatial and temporal scales large datasets of in situ observations have been used to analyse the interaction between shelf seas biogeochemical dynamics and physical processes at different scales and locations e g in the european sea arin et al 2013 cossarini et al 2012 guadayol et al 2009 mozetiĉ et al 1998 romero et al 2014 solidoro et al 2009 varela et al 2010 and long term variability and trends giani et al 2012 harding et al 2016 kuosa et al 2017 lynch et al 2014 mozetič et al 2010 qiao et al 2017 rydberg et al 2006 yunev et al 2007 zingone et al 2010 satellite observations are regularly collected and can provide synoptic information at a relatively high spatial resolution and chlorophyll concentrations can be derived from satellite ocean colour observations using algorithms based on colour spectra analysis muralikrishna 1984 santoleri et al 2008 volpe et al 2007 satellite ocean colour has been widely used to evaluate and monitor the water quality and ecological status of shelf seas gohin et al 2008 harvey et al 2015 novoa et al 2012 inter annual trends colella et al 2016 loisel et al 2017 mélin et al 2011 terauchi et al 2014 and the spatial and temporal variability of blooms and trophic regimes beltrán abaunza et al 2017 blondeau patissier et al 2014 carvalho et al 2011 d ortenzio and ribera d alcalà 2009 gaetan et al 2016 marchese et al 2014 mayot et al 2016 rinaldi et al 2014 finally numerical models can seamlessly cover three dimensional spatial and temporal domains at different scales and can be used to investigate specific processes such as phytoplankton bloom and production dynamics and the effects of physical forcing on them campbell et al 2013 crise et al 1999 ennet et al 2000 fraysse et al 2013 friedrichs and hofmann 2001 holt et al 2012 reboreda et al 2014 st laurent et al 2017 tsiaras et al 2014 as well as eutrophication nobre et al 2005 picart et al 2015 hypoxia da et al 2018 meier et al 2017 testa et al 2014 and assessment of carbon fluxes arruda et al 2015 cossarini et al 2015 hofmann et al 2011 melaku canu et al 2015 none of these observations or models are without limitations in situ data are point observations sparse in space and time with intrinsic representativeness error dowd et al 2014 and they are thus unable to provide a basin wide perspective cloud cover limits the continuity of satellite data which anyway do not provide information under the sea surface both in situ and satellite observations are affected by measurement error and satellite estimates of chlorophyll also suffer from the uncertainty associated with the algorithm formulation volpe et al 2012 on the other hand models are affected by the approximations of their formulation cossarini et al 2009 the uncertainty associated with their parameters cossarini and solidoro 2008 solidoro et al 2003 and their boundary and initial conditions pastres et al 1999 by numerical errors due to their discrete spatial and temporal resolution and the associated unresolved dynamical scales edwards et al 2015 the integration of models and observations using data assimilation schemes da has been demonstrated to be a powerful tool in coupling different sources of information to obtain a better description of biogeochemical status and evolution a number of recent applications have shown that data assimilation of satellite observations can be successfully applied in biogeochemistry to provide insight into different processes descriptions of the chlorophyll seasonal cycle as well as investigations of vertical chlorophyll dynamics carbon fluxes and hypoxia have been provided by models that integrate a da scheme for satellite observations ciavatta et al 2014 ciavatta et al 2016 fontana et al 2009 2010 2013 ford and barciela 2017 ford et al 2012 hu et al 2012 kalaroni et al 2016 shulman et al 2013 song et al 2016a teruzzi et al 2014 tsiaras et al 2014 some of the works above mentioned are focused on or include also shelf areas ciavatta et al 2014 2016 fontana et al 2009 fontana et al 2010 2013 hu et al 2012 shulman et al 2013 song et al 2016a in the present work we provide an example of how remote sensing observations on shelf areas can be efficiently integrated in a basin scale model which includes shelf and open sea areas to improve the description of the biogeochemistry in shelf seas in the context of three dimensional variational 3dvar data assimilation the application of da in coastal waters implies the development of a specific approach because coastal marine biogeochemistry is strongly affected by local dynamics and inputs indeed it is not straightforward that an open sea assimilation scheme provides reliable results in coastal waters fontana et al 2013 in ciavatta et al 2014 a lower decorrelation radius is applied at depth lower than 40 m however simple it is a practical approach to account for the specific features of coastal waters here the existing 3dvar data assimilation scheme teruzzi et al 2014 coupled with the ogstm bfm model ogs tracer model biogeochemical flux model lazzari et al 2012 2016 has been specifically upgraded to assimilate remote observations in shelf seas independent in situ data have been used to provide a comprehensive estimate of the uncertainty of the model simulations produced using the new da scheme furthermore we provide an estimate of the integrated primary production at the basin scale including shelf seas which updates the one given in lazzari et al 2012 the paper is organised as follows section 2 presents the details of the 3dvar methods and the upgrades dedicated to shelf seas assimilation the ogstm bfm model and the observation datasets are also presented in section 2 the results and validation of the assimilation run of the mediterranean sea along with primary production estimations are reported in section 3 finally section 4 and 5 provide the discussion and conclusions respectively 2 material and methods 2 1 the cmems mediterranean biogeochemical model system the 3dvarbio ogstm bfm coupled biogeochemical model system consists of three major components a transport model ogstm lazzari et al 2012 lazzari et al 2010 a biogeochemical model bfm cossarini et al 2015 lazzari et al 2012 2016 vichi et al 2007 and references therein and a 3dvar data assimilation scheme 3dvar bio teruzzi et al 2014 this model system is currently implemented with assimilation of open sea satellite chlorophyll within the mediterranean component of the european copernicus marine environment monitoring services cmems and operationally provides analysis forecast and reanalysis products for the biogeochemistry of the mediterranean sea in the present application we adopt the transport ogstm model a modified version of the opa 8 1 transport model foujols et al 2000 which resolves the advection vertical diffusion and sinking terms of the tracers i e biogeochemical variables the mesh grid is based on a 1 16 longitudinal scale factor and a 1 16 cos φ latitudinal scale factor the vertical mesh grid accounts for 72 non uniform vertical z levels in which there are 25 in the first 200 m depth 31 between depths of 200 and 2000 m and 16 below a depth of 2000 m the minimum resolved depth is at the first level and is equal to 3 m the temporal scheme of ogstm is an explicit forward time scheme for the advection and horizontal diffusion terms whereas an implicit time step is adopted for the vertical diffusion term the physical dynamics i e temperature salinity velocity and diffusivity fields in addition to surface data for solar shortwave irradiance and wind stress that are coupled off line with biogeochemical processes are precomputed using nemo3 4 coupled with oceanvar assimilation dobricic and pinardi 2008 and are available through the cmems catalogue simoncelli et al 2014 the physical forcing fields have daily frequency and they are linearly interpolated at the computational time step of the ogstm bfm model 30 min the features of the biogeochemical reactor bfm biogeochemical flux model have been chosen to target the energy and material fluxes through both classical food chain and microbial food web pathways thingstad and rassoulzadegan 1995 and to take into account the co occurring effects of multi nutrient i e carbon nitrogen phosphate silicate interactions both of these factors are very important in the mediterranean sea wherein microbial activity fuels the trophodynamics of a large part of the system throughout much of the year and both phosphorus and nitrogen can in principle play limiting roles béthoux et al 1998 krom et al 1991 the bfm model includes nine plankton functional types pfts heterotrophic pfts consist of carnivorous and omnivorous mesozooplankton bacteria heterotrophic nanoflagellates and microzooplankton the autotrophic pfts are diatoms flagellates picophytoplankton and dinoflagellates internal contents of carbon nitrogen phosphorous chlorophyll and silicon only for the diatoms pft are dynamically simulated summing up on 17 state variables needed to represents the four phytoplankton functional types the model is fully described in lazzari et al 2012 2016 where it was corroborated for chlorophyll primary production and nutrients in the mediterranean sea in a 1998 2004 simulation the bfm model is also coupled to a carbonate system model cossarini et al 2015 in order to simulate the dynamics of alkalinity ph dissolved inorganic carbon and co2 fluxes at the air sea interface in the cmems workflow which is applied for both analysis forecast and reanalysis simulations the data assimilation of surface satellite chlorophyll concentration data is performed every seven days using a 3dvar scheme 3dvar bio teruzzi et al 2014 which updates the four phytoplankton functional groups that are included in the bfm 3dvar methods represent a feasible and efficient framework for assimilation in oceanographic applications because they allow to properly design the key aspects of assimilation problems such as the background and observation error covariance matrix thus mantaining computational costs affordable dowd et al 2014 edwards et al 2015 the 3dvar bio assimilation scheme teruzzi et al 2014 computes the analysis status x a from the minimization of a cost function j in which the forecast and observations are weighted by their respective error covariance matrices in the present formulation the assimilation updates all the 17 phytoplankton variables the cost function can be written as a function of the increment δ x which is defined as the difference between the analysis x a and the forecast produced by the model x f δ x x a x f at a generic assimilation step the cost function is defined as follows 1 j δ x 1 2 δ x t b 1 δ x 1 2 d h δ x t r 1 d h δ x where b and r are the covariance matrices for the background and observational errors respectively h is the jacobian of the observation operator h x which sums the surface chlorophyll contributes from the four phytoplankton functional types and d is the difference between observations y and model results d y h x and is referred as the innovation vector after undergoing opportune transformations the cost function can be written as a function of a vector v with δx v b v h v v v 2 j δ x 1 2 v t v 1 2 d hv b v h v v v t r 1 d hv b v h v v v in eq 2 the forecast or background covariance matrix b is approximated as b v v t where v is a mapping operator that following the approach of dobricic and pinardi 2008 is decomposed into a sequence of operators that account for different components of the error covariance in particular v v b v h v v which are the biogeochemical horizontal and vertical operators respectively the solution of the minimization is the vector v whose dimension is defined by the definition of the vertical operator v v i e a set of empirical orthogonal functions the increments are then applied to the 3d fields of the 17 biogeochemical variables which describe the phytoplankton functional types through the application of v h i e a gaussian recursive filter and v b i e a biogeochemical covariance operator the operator v b is a biomass covariance operator which preserves the ratios among phytoplankton functional types and their internal quotas with additional criteria to maintain the optimal phytoplankton growth rate based on the optimal nutrient to carbon internal quota teruzzi et al 2014 finally the v b operator includes also a post processing procedure which replaces the negative chlorophyll values with a small positive value 10 4 mg chl m3 and change accordingly the components of each pft in order to avoid any negative values in the pft components the effect of this correction is negligible since the negative values are low i e order of 10 2 or closer to zero in small number nearly 5 5 of the cases and located mainly below the photic zone where chlorophyll concentrations are low and the intensity of phytoplankton dynamics is reduced 2 2 chlorophyll estimates from satellite data in recent years new algorithms have been developed to provide shelf seas ocean colour products le traon et al 2015 the surface chlorophyll concentration used in the assimilation scheme is a product of the cmems ocean colour thematic assembly centre oc tac service obtained using remote sensing reflectance rrs spectra rrs data are produced for cmems by the plymouth marine laboratory pml using the esa cci processor estimates of chlorophyll for the mediterranean sea are provided by the global ocean satellite group gos of the institute of atmospheric sciences and climate isac within the italian national research council cnr using two different algorithms medoc4 volpe et al 2007 for case 1 water and ad4 d alimonte and zibordi 2003 for case 2 water colella et al 2016 water is classified as case 1 or case 2 water using the method proposed by d alimonte et al 2003 based on the comparison of the satellite spectrum with the average spectral signature of the water type obtained from in situ measurements full basin estimates of chlorophyll concentration based on the approach proposed by d alimonte et al 2003 are operationally provided by cmems along with their validation oceancolour med chl l3 nrt observations 009 040 http marine copernicus eu services portfolio access to products option com csw view details product id oceancolour med chl l3 nrt observations 009 040 for the present application daily chlorophyll concentrations at a spatial resolution of 1 km have been interpolated at 1 16 and temporally aggregated using a seven day average to increase the spatial coverage of the assimilated field without losing excessive details about the temporal evolution of the surface chlorophyll field the error covariance matrix for the observations r in eq 1 has been assumed to be diagonal excluding error covariance between observations and monthly varying variances have been adopted for each grid point the error variance has been estimated as the variance of the multiannual 1999 2015 time series of chlorophyll concentration produced by gos isac group using the algorithm above described in our pragmatic approach higher observation errors are attributed to areas with higher variabilities as discussed in teruzzi et al 2014 this approach differs from the usual one that sets the observation error of ocean colour data as proportional to the observed chlorophyll concentration fontana et al 2013 hu et al 2012 song et al 2016a tsiaras et al 2017 however other approaches include for instance the use of an observation error derived from the standard deviation associated to the ocean colour products ciavatta et al 2016 or from an observation based ensemble shulman et al 2018 2 3 independent in situ dataset for validation the in situ dataset consists of measurements of chlorophyll nitrate and phosphate along the italian coast table 1 and fig 1 at a maximum shore distance of 3 km provided by the italian national institute for environmental protection and research ispra sintai dataset http www sintai isprambiente it data were collected almost regularly at monthly or higher frequencies by different regional environmental agencies in 2013 these data were then quality processed by ispra 2 4 upgrade of the 3dvar bio assimilation scheme the upgraded elements of the new version of the 3dvar bio scheme which is used for the assimilation of shelf seas observations are the horizontal v h and vertical v v operators which have been modified to account for the specific dynamics of error propagation in the shelf seas 2 4 1 upgrade of the vertical operator vv the vertical operator v v provides the error covariance in the vertical direction it comprises a set of profiles of chlorophyll error covariances that are obtained using an eof empirical orthogonal function decomposition of a dataset of vertical chlorophyll profiles to account for differences in the vertical biogeochemical dynamics of shelf and open sea areas a dedicated v v operator has been designed for the shelf seas the depth of 200 m is chosen as the threshold between shelf and the open sea fig 1 according to previous applications in mediterranean sea gazeau et al 2004 lazzari et al 2012 teruzzi et al 2014 as described in teruzzi et al 2014 in the open sea i e at depths greater than 200 m the v v operator consists of a set of vertical eof profiles defined for each month and for each subbasin of fig 1 the same temporal and spatial approach was applied to the shelf seas however a much finer spatial resolution was chosen in order to account for the specificity of local features along the mediterranean coast in particular a k means analysis based on the time evolution of the chlorophyll field provided by the 1999 2015 cmems reanalysis teruzzi et al 2016 identified two k regions for each shelf area of the 10 subbasins fig 1 details on the k means approach are provided in appendix a the k region subdivision reveals that within a given subbasin shelf area the two k regions can distinguish the areas k reg2 affected by important river run off i e the ebro and rhone rivers for the north western mediterranean sea nwm the nile and turkish rivers for the levantine sea lev and the po and other minor south eastern adriatic rivers for the adriatic sea adr or similar local inputs i e the dardanelles for the aegean sea aeg from the areas k reg1 that are far from the river mouths the evolution of the total variance of the error fig 2 shows higher values in late winter or spring in the k regions that are affected by rivers k reg2 in the nwm lev and adr which is consistent with the hypothesis that important differences in chlorophyll dynamics are triggered by land forcing along the coast of the subbasins in the ionian sea ion which is characterised by the absence of relevant riverine inputs the two k regions are patchily distributed and are distinguished only by their summer variance which is higher in the gulf of gabes and along the african coast the eof decomposition was applied to the weekly chlorophyll anomaly profiles within each k region and month in order to obtain sets of profiles of the vertical error covariance that are specific to different parts of the mediterranean shelf seas thus the result of the eof decomposition is a set of eigenvectors chlorophyll vertical profiles and associated eigenvalues for each k region in shelf seas and each subbasin in open sea each set of eigenvectors and associated eigenvalues represent the vertical error covariance for each subbasin or k region of the mediterranean sea finally according to desroziers et al 2005 a tuning procedure based on the surface observation error covariance and the difference between observation and model before the assimilation d is used to compute the eigenvalues of the eof profiles at a local scale i e at each grid point the mean quadratic innovation e dd t is defined as being equal to the sum of the observation error variance r and the background error variance at the surface thus tuning the eigenvalues αi of the eofs at each grid point as follows 3 e d d t r h α i e i α i e i t h t where the second term in the right hand side of the equation is the background error variance at the surface as described by the eof and e i are the eigenvectors of the eofs in the evaluation of αi it has been imposed that the background error variance is at least equal to half of the observation error variance in order to guarantee the effective assimilation of satellite observations as a result the v v operator of the mediterranean sea consists of a set of eof profiles for each grid point that share a common shape within each subbasin in open sea and within each k region in shelf seas 2 4 2 new horizontal operator vh the operator v h which describes the horizontal error covariance is based on a recursive gaussian smoother whose effect is regulated by the correlation radius length scale l dobricic and pinardi 2008 in the open sea l is set to 10 km teruzzi et al 2014 which is within the order of magnitude of the mediterranean sea mesoscale lionello 2012 in shelf seas where the morphology and local physical features can produce sharp gradients of biogeochemical fields l differs in its longitudinal lx and latitudinal ly directions in particular constant in time values of lx and ly were computed for all shelf seas grid points proportionally to the inverse of the surface salinity gradient components along the longitude and the latitude x s x y and y s x y respectively as follows 4 l x x y x s x s x y l 5 l y x y y s y s x y l where i s is the mean salinity gradient component along x and y over the mediterranean sea surface salinity can be considered to be a signature of local dynamics in shelf seas and it can be assumed that more local processes i e those with a smaller correlation radius correspond to higher salinity gradients the surface salinity field used to estimate the length of the correlation radius is based on the 1990 2015 mean value of the cmems mediterranean sea physics reanalysis simoncelli et al 2014 the correlation lengths calculated using the salinity gradient fig 3 are nearly one third the size of the open sea correlation length in the northern and southeastern adriatic sea the northeastern aegean sea aeg the gulf of gabes and other more patchy areas along the mediterranean coast in these regions the reduced correlation length reflects the reduced horizontal propagation of the increments provided by the data assimilation other areas e g the italian shores of the tyrrhenian sea the western side of the adriatic sea in the longitude direction the gulf of libya the israeli coast and the southern aegean sea in the latitude direction show correlation radii that are larger than the average open sea value thus reflecting the fact that in areas with smooth salinity gradients the spread of the assimilation updates is higher 2 5 setup of the simulations in the present paper the following three simulations are compared fullda openda and noda the first two runs differs in terms of v v v h and observation operators the observation operator in openda is defined in order to assimilate the open sea observations only i e where water depth is higher than 200 m whereas in fullda it has been designed in order to assimilate all the observations both in shelf and open sea moreover fullda uses the upgraded v v and v h operators a reference run without assimilation noda completes the simulation list the simulations cover the period from january to december 2013 because the availability of the ispra in situ observation dataset in 2013 allows us to quantitatively evaluate the impact of the assimilation of shelf seas data the simulations share the same setup which is based on the official cmems mediterranean analysis forecast system bolzon et al 2017 in particular physical forcing is provided by cmems products simoncelli et al 2014 while climatological biogeochemical boundary conditions are set for gibraltar strait the dardanelles rivers and atmosphere forcing nutrient concentrations in the atlantic buffer zone are relaxed to the seasonally varying profiles derived from climatological medar medatlas data measured outside gibraltar climatologies of nutrient loads from rivers and other coastal nutrient sources were based on the reconstruction of the spatial and temporal variability in water discharge estimated using the method described by ludwig et al 2009 atmospheric deposition rates of inorganic nitrogen and phosphorus are defined according to the synthesis proposed by ribera d alcalà et al 2003 initial conditions are given after the spin up of a 14 year long run of biogeochemical reanalysis cmems reanalysis teruzzi et al 2016 regarding the assimilation the two assimilation setups i e openda and fullda compare the present one bolzon et al 2018 and the previous cmems mediterranean analysis forecast system versions bolzon et al 2017 3 results 3 1 comparison between fullda and openda the main effect of fullda is a general increase in the surface chlorophyll concentrations of shelf seas which is consistent with the high chlorophyll concentrations observed by satellite fig 4 and table 2 the fullda increase in mean chlorophyll values is more evident in the subbasins with a wide continental shelf such as the adriatic sea adn and ads and the gulf of gabes in the ionian sea ion the mean chlorophyll concentration in fullda is higher than in openda by nearly 50 in the mediterranean shelf seas which is consistent with the assimilation of shelf seas satellite chlorophyll applied in fullda and not in openda in the adriatic and ionian shelf seas the relative difference between fullda and openda is nearly equal to 100 and 60 respectively in these areas the effects of shelf seas assimilation include both a significant increase in the surface chlorophyll concentration and a modification of its pattern in the adriatic sea the highest concentrations of fullda are located in the northern adriatic sea and along the italian coast thus providing an east west gradient of chlorophyll that substantially differs from the results obtained by openda but is consistent with satellite observations and the well known chlorophyll features of the subbasin mélin et al 2011 zavatarelli et al 2000 in the gulf of gabes the increments applied in fullda yield maximum chlorophyll concentrations in the eastern part of the area which is consistent with satellite observations fig 4 but is opposite to the results of openda also the chlorophyll concentrations in lev and aeg near the nile mouth and the dardanelles are significantly impacted in fullda fig 4 in shelf seas the mean chlorophyll concentration is increased by fullda by nearly 70 and 30 in lev and aeg respectively the increase of the mean shelf sea chlorophyll in lev is relevant despite the relative small extension of its shelf sea and is due to the large positive increments applied by da in the nile mouth region fig 4 indeed the climatological inputs used for the nile river do not account for the positive trend of chlorophyll concentration in the area this trend has been documented by colella et al 2016 and is related to the increase of the egypt industrial capacity the differences between openda and noda highlights that the open sea assimilation affects also the chlorophyll concentration in the shelf seas table 2 the open sea assimilation increments are propagated to the shelf seas due to the effect of v h operator and of the transport processes during model integration as a result the openda shows increments in the shelf seas that have the same sign of those applied in open sea close to the shelf the sign of the increments is mainly positive but an exception is shown for lev where open sea increments are mainly negative not shown and thus also in the shelf seas even if with some exceptions generally the higher the extent of the shelf area is compared to the sub basin area the lower the openda impacts on shelf sea the differences between fullda and noda are at least doubled compared to those of openda in most of the subbasins fullda produces a significant increase in the spatial variability of simulated chlorophyll in shelf seas 74 increase in the whole mediterranean sea table 3 the mean spatial standard deviation in shelf seas of fullda is significantly higher than that of the openda simulation in all the subbasins especially in adn ads ion and lev table 3 which indicates that the assimilation of satellite data increased the simulated variability on a local scale and on areas interested by patchy processes examples of chlorophyll time series in four near shore grid points are shown in fig 5 in all of the points which are representative of the chlorophyll dynamics in the four shelf areas the effects of the assimilation of shelf seas satellite chlorophyll of fullda are clearly detectable indeed the fullda time series are closer to the satellite observations in terms of weekly signal and monthly variability black solid line in fig 5 in particular fullda exhibits relevant effects at the beginning and at the end of the year when the fullda concentrations are significantly higher than the openda concentrations except for the lionp time series during spring and summer three locations i e adrp lionp and nilep in several weeks from may to september show a low persistence of the assimilation updates after the assimilation the chlorophyll concentrations of fullda daily model output in grey line in fig 5 tend to decrease towards the values simulated by the model without the shelf seas assimilation openda and fullda simulation presents an artificial temporal variability at daily time scale in these cases nearly 80 of the increments introduced by the assimilation is lost five days after the assimilation fig 5 also shows that the increments applied by fullda during summer are small in gabes p and nilep in june thus indicating that in these cases the time evolution of chlorophyll is already well represented by the openda model setup using monthly climatological terrestrial inputs e g nutrient load as boundary conditions probably underestimates the effects of actual runoff events on triggering shelf seas blooms in fullda the assimilation of case 2 satellite chlorophyll observations can overcome the inadequacy of climatological local forcing conditions by acting directly on the state variables fig 6 shows examples of the spring and autumn bloom events in the adriatic sea that are related to important terrestrial inputs from the po river which are efficiently corrected by fullda the low salinity patterns fig 6 left column highlight the presence of important river runoff and consequent nutrient discharge in the area the use of the climatological boundary conditions applied in the openda results cannot be used to reproduce the effects of short lasting and impulsive events on phytoplankton dynamics fig 6 central column whilst fullda correctly simulates the presence of high chlorophyll concentration values that match the low salinity patterns fig 6 right column the computed time series of the spatial correlation between the salinity and chlorophyll patterns of openda and fullda in the northern adriatic areas do not show a significant increase with fullda not shown this is likely because small surface chlorophyll blooms may be triggered by very local hydrodynamic features whose temporal and spatial details are not fully captured by the physical forcing model however fullda significantly improves the representation of wide blooms related to low salinity events the spatial distribution of the da increments of fullda in shelf seas is related to the application of the non uniform and non isotropic horizontal operator v h to evaluate its effect we compared the differences in the assimilation results obtained using a uniform and isotropic correlation length l 10 km univh case and those obtained using the new v h nonunivh case the difference d a between the satellite observations y and the surface chlorophyll yielded by the assimilation x a was evaluated for these two cases the root mean square rms values of d a in the mediterranean shelf seas table 4 show that the application of the new v h operator produces an assimilated field that is closer to the observations than that obtained in the univh case the highest reductions of the d a rms values are observed in the eastern subbasin adn ads aeg ion and lev not shown which yield percentage differences ranging from 15 in ads to 49 in adn the use of two different correlation radii for longitude lx and latitude ly can affect the distribution of the assimilation increments in the horizontal plane it is expected that the assimilation updates are more local and less smooth along one direction x or y where the relative correlation radius lx or ly is smaller than the reference value l the fact that a lower correlation radius in shelf seas is essential to produce local small scale features is demonstrated by the chlorophyll gradient computed where lx or ly are smaller than l in the univh nonunivh and satellite surface chlorophyll cases table 4 in the nonunivh case the chlorophyll gradient components are closer to the satellite values thus indicating that the use of a smaller correlation radius for longitude or latitude reduces the smoothing of the solution in accordance with the high horizontal variability of satellite observations 3 2 validation using the in situ dataset the improvement that is introduced by using da to simulate chlorophyll in open sea areas has been shown by teruzzi et al 2014 here we compare the results of the fullda and openda simulations with independent in situ observations of chlorophyll and nutrient concentrations collected at the surface in the shelf areas of the adn ads ion tyr and nwm subbasins fig 1 table 5 shows the mean bias model results minus observations and the root mean square difference rmsd values for the subbasins using available data from two 6 month periods i e january to june or semester win spr and july to december or semester sum aut the chlorophyll bias between observations and openda is always negative which means that the model results systematically underestimate the in situ observations fullda which generally increases chlorophyll concentrations figs 4 and 5 significantly reduces the bias in all subbasins the largest improvements occur in adn and ads in both semesters and in tyr in win spr the rmsd is significantly improved in adn and tyr in win spr in the sum aut period the rmsd decreases by 10 in adn remains almost unchanged in tyr and ion and slightly increases in ads the high positive increments towards satellite data in ads during sum aut induced by the shelf seas assimilation change the sign of the bias and reduce its absolute value the comparison of the available observations of non assimilated variables shows that fullda has negligible influence on the bias and rmsd values of phosphate while it affects those of nitrate table 5 the range of measured nitrate concentrations is very high i e on the order of 10 mmol n m3 in adn 1 mmol n m3 in ads and slightly less than 1 mmol n m3 in ion and nwm accordingly the mean bias and rmsd values also vary widely between subbasins and are highest in adn for both fullda and openda the sign of nitrate bias is both positive and negative in the openda simulation while it is negative in all of the subbasins and seasons in fullda ads ion and nwm show decreases in their absolute values of bias and concomitant decreases in their rmsd values only adn shows that in shelf seas an assimilation induced decrease of nitrate triggers a worsening of the skill indexes in both seasons since the assimilation scheme does not update nitrate the decrease of nitrate concentration occurs during the model integration after the assimilation steps according to the formulation of v b teruzzi et al 2014 when positive increments of chlorophyll are applied by da the phytoplankton internal content of carbon is updated proportionally while the internal content of nitrate is increased of the amount necessary to keep the internal phytoplankton n c ratio equal to the optimal value set in bfm as equal to the redfield ratio thus if the n content before the assimilation is high enough to have an n c ratio greater than optimal even after the carbon increment the phytoplankton internal content of nitrogen is not modified by the assimilation this feature has been implemented to prevent the generation of too much mass of the non limiting nutrient which accumulate in phytoplankton according to the luxury uptake formulation of bfm vichi et al 2015 in the case of adn the phytoplankton n c ratio before the assimilation is higher than the optimal value and the assimilation scheme applies positive increments for chlorophyll after the assimilation the phytoplankton biomass is increased and the n c ratio is between the optimal and the maximum ratio allowed by the luxury uptake of the non limiting nutrient of the bfm parameterization twice the redfield ratio the combination of 1 high availability of nitrate in adn 2 increased phytoplankton biomass and 3 lower than maximum phytoplankton n c ratio causes an additional phytoplankton uptake of nitrate that results in a reduction of nitrate concentration in sea water it is worth to highlight that in our application the reduction of nitrate concentration in the adriatic does not produce nitrate limitation conditions since the n c ratio is always between the optimal and maximum value on the other hand phytoplankton growth is still phosphate limited as confirmed by an internal phytoplankton p c ratio lower than the optimal value in bfm equal to the redfield ratio and the n p ratio in sea water higher than 16 moln molp redfield lazzari et al 2016 3 3 primary production fullda showed to improve the simulation of chlorophyll thus based on the results of the fullda simulation we provide estimates of the vertically integrated mean annual primary production in the mediterranean sea shelf and open seas fig 7 although these results are based on a one year simulation they represent an upgrade of the basin wide estimates discussed in lazzari et al 2012 these results are consistent with previous estimates from satellite observations bosc et al 2004 siokou frangou et al 2010 uitz et al 2012 which showed that the western mediterranean is more productive than the eastern mediterranean the mean primary production values in the eastern adn ads aeg ion and lev and western alb sww swe nwm and tyr subbasins are 117 gc m2 y and 188 gc m2 y respectively these values are higher than those provided by lazzari et al 2012 but in the range of other estimates of primary production in mediterranean sea at basin or sub basin scale bosc et al 2004 bricaud et al 2002 kessouri et al 2018 siokou frangou et al 2010 uitz et al 2012 with a mean primary production of 142 gc m2 y for the whole mediterranean sea for fullda which is 6 higher than in openda local patches of high production are depicted in fig 7 which highlights the heterogeneous presence of high productivity areas close to the coasts i e the western part of the italian adriatic coast dardanelles and nile mouth regions that are not shown in lazzari et al 2012 in the eastern mediterranean the presence of shelf areas with high productivity indicates that the mean integrated primary production is higher in shelf seas than it is in the open sea for instance in the adriatic sea the mean values of primary production are 143 gc m2 y and 133 gc m2 y in shelf and open sea respectively in contrast in the western mediterranean the mean primary production is higher in the open sea with a mean value of 191 gc m2 y compared with that of 168 gc m2 y in shelf seas thus highlighting that in the western mediterranean shelf seas phenomena are not so relevant to primary production as in the adriatic sea which is a semi enclosed basin strongly affected by coastal processes similar results have been obtained in a study focused on the fertilization sources in the mediterranean sea macias et al 2017 the results obtained using fullda indicate that the model reproduces the relevant spatial variability of primary production and highlight the prominent role that shelf seas play in primary production in some specific areas of the mediterranean sea which is an aspect difficult to capture using only in situ measurements 4 discussion in the present study we showed how case 2 water remote chlorophyll observations can be efficiently integrated in a complex biogeochemical model using a 3dvar data assimilation scheme to better describe the phytoplankton dynamics and their spatial patterns in the mediterranean shelf seas the modelled results have been validated against independent in situ observations of chlorophyll and nutrients along the italian coast validation for open sea areas is provided in teruzzi et al 2014 the results of comparisons with independent in situ observations are encouraging indeed the fullda simulation substantially improves the statistics of the assimilated variable chlorophyll in all of the subbasins while slightly improving or at least not deteriorating the skill statistics of nutrients except for nitrate in the northern adriatic the statistics evaluated for chlorophyll and nutrients are comparable to those provided in fraysse et al 2013 in an area of the north western mediterranean as the root mean square difference rmsd between in situ observations and model values is the same order of magnitude as the mean in situ measurements in a recent application of biogeochemical assimilation in the mediterranean sea tsiaras et al 2017 the rmsd values obtained from the comparison with a climatology based on in situ data are similar to those obtained in the present study for phosphate while the rmsd values of nitrate are significantly lower in the present study the results of the validation are even more interesting when considering that most of the in situ data have been collected at very shallow locations i e in the first model grid point from the coastline and they thus describe very local and near shore dynamics that are not properly simulated by the model itself the decrease of nitrate concentration in the northern adriatic which deteriorates the skill statistics in this area is due to a combination of the v b operator which produces higher phytoplankton biomasses with a reduced internal n c ratio in this particular case and the luxury uptake mechanism for a non limiting nutrient of the bfm model lazzari et al 2016 this condition increases the phytoplankton uptake of nitrate and consequently its concentration decreases an improvement of the representation of non assimilated variables is not straightforward in biogeochemical da for state estimation as shown in previous publications as an example ford et al 2012 indicate as a good result of their assimilation the non degradation of non assimilated variables other works clearly indicate and comment on degradation of some non assimilated variables especially nutrients ciavatta et al 2014 fontana et al 2013 ford et al 2012 shulman et al 2013 simon et al 2015 tsiaras et al 2017 our results highlight the complexity of the biogeochemical response to data assimilation and the need to investigate the specific response of non assimilated variables in biogeochemical models further improvements on nutrients could be obtained by the implementation of a multivariate v b operator accounting for the covariance between chlorophyll and nutrients in complex biogeochemical models such as ogstm bfm the definition of a thorough covariance between chlorophyll and nutrients is not a trivial task indeed the relationship between phytoplankton chlorophyll and external nutrients is not linear nor constant in time and space and regulated by different processes chlorophyll synthesis phytoplankton growth phase and nutrient uptake the definition of a covariance v b operator could be realised using two different approaches an error covariance matrix built on long term model simulations e g shulman et al 2013 or on the spreading of an ensemble e g ciavatta et al 2014 tsiaras et al 2017 a dynamical inverse model similarly to the compensation model proposed by hemmings et al 2008 the persistence of the da updates in the shelf seas is of the order of five days fig 5 the relative low persistence is mainly due to the phytoplankton photoadaptation mechanism and to the decoupled phytoplankton growth and nutrient uptake in the bfm phytoplankton formulation the growth and the nutrient uptake are two decoupled phases the nutrients uptake is related to the external nutrient availability and to the distance from a phytoplankton optimal nutrient internal quota while the growth lysis is related besides other factors to the phytoplankton nutrient internal quota details in lazzari et al 2012 all these peculiar aspects of the bfm formulation point out the need for a more elaborated v b operator involving either a different response of the chlorophyll synthesis to the actual light conditions or the update of the external nutrient concentrations which contribute to regulate the growth rate and chlorophyll synthesis through the uptake mechanism mass conservation is not a constraint that is generally respected by the formulation of the covariance between the biogeochemical variables in state estimation assimilation schemes few examples of biogeochemical da for state estimation with mass conservation have been presented in literature e g the method of hemmings et al 2008 and its applications in ford et al 2012 on the contrary several recent applications in realistic framework of biogeochemical da for state estimation do not include a mass conservation constraint ciavatta et al 2014 2016 fontana et al 2010 2013 hu et al 2012 jones et al 2016 shulman et al 2013 simon et al 2015 song et al 2016a tsiaras et al 2017 in some of these works the mass conservation issue is explicitly discussed in ciavatta et al 2014 the absence of a mass conservation constraint in sequential assimilation is ascribed to the uncertainty of mass balance inherently present in biogeochemical models hu et al 2012 evaluate the impact of da on the total mass of nitrogen while song et al 2016a compare the increments introduced at each assimilation cycle with other system fluxes a mass conservation constraint is not included in our data assimilation and we evaluated the additional terms to the system budget due to da for nitrogen since nitrate is the variable mostly affected by the assimilation the sum of these terms in fullda simulation equals to less than 1 of the mediterranean annual primary production in nitrogen unit and to 17 of the annual input of nitrogen from atmosphere and rivers given an uncertainty of more than 100 in atmospheric input d ortenzio and ribera d alcala et al 2009 and the many possible sources of uncertainty in river estimates ludwig et al 2010 the lack of mass conservation appears not relevant the full basin assimilation of satellite chlorophyll observations allows for several improvements in the simulation of phytoplankton in the mediterranean shelf seas these improvements cannot be otherwise obtained by a biogeochemical model whose formulation and setup are optimised for the representation of open sea dynamics cossarini et al 2015 lazzari et al 2012 in particular because of the use of climatological boundary conditions especially at rivers the relatively low resolution of the model i e fertilization effects due to minor terrestrial inputs are not considered in the basin wide simulation and the lack of interaction between the water column and the bottom the bfm model does not include a benthic component shelf seas are characterised by chlorophyll concentration patterns with high spatial and temporal variability induced by several coastal processes e g riverine inputs local vertical mixing events due to the interactions between currents and morphology mann and lazier 2005 data assimilation might be particularly relevant to address these additional sources of uncertainties in particular coastal water da should be able to propagate the updates in agreement with the dynamic properties of the current field in other words the entity and major directions of propagation of the da updates should adapt to the current field changes that can be also due to changes in riverine inputs our methodology provide a steps toward this direction consistent with this framework the present shelf seas data assimilation scheme reproduces a more reliable description of the higher chlorophyll values close to the river mouths also increasing the spatial variability of chlorophyll concentration in shelf seas a reliable description of the phenomena related to riverine inputs is usually intrinsically limited in basin wide biogeochemical models that use riverine nutrient discharge based on climatological references such as the implementation of the bfm in the mediterranean sea and its present configuration adopted in cmems considering the difficulties associated with designing and maintaining a monitoring plan for river nutrient discharge or creating reliable and validated datasets of river discharge at high spatial and temporal resolution ludwig et al 2009 or even those associated with coupling a biogeochemical model to a hydrological one to estimate nutrient loads the assimilation of satellite observations may provide an alternative and efficient method of integrating riverine effects into a model simulation thus the implementation of da of shelf seas data in a multiannual simulation e g reanalysis can compensate for the use of climatological riverine nutrient discharge taking in account inter annual variability of chlorophyll concentration defining the background covariance operators in shelf seas should account for the specificity of shelf seas processes in both the vertical and horizontal dimensions in shelf seas vertical chlorophyll dynamics are not directly dominated by the seasonal cycle of surface winter bloom and summer stratification that are typical of the open sea furthermore we showed that in shelf seas the horizontal variability increases by nearly 30 in terms of increase of the chlorophyll horizontal gradient table 4 thus indicating that morphological features can introduce strong anisotropy and affect relevant local dynamics accordingly the background error covariance has been modified to update both the vertical and horizontal operators the horizontal error covariance has been designed using two non uniform radii lx and ly for longitude and latitude respectively in shelf seas the chlorophyll field produced using the assimilation scheme with the new horizontal operator better reproduces the values and spatial distribution of satellite chlorophyll in shelf seas non uniform and anisotropic correlation length scales have previously been proposed for 3dvar assimilation in a global ocean circulation model and the benefits of this approach have been highlighted especially in eddy dominated areas and tropical areas where the longitudinal and latitudinal correlation length scales are significantly different storto et al 2014 in an operational framework a method for the evaluation of non uniform correlation radii based on the surface salinity gradient can be implemented using the salinity fields operationally obtained using a general circulation model forecasting system thus adapting the horizontal error covariance operator to the driving hydrodynamic field however this method will also result in a not negligible increase in the computational costs associated with the operational implementation of the assimilation scheme the new vertical operator is based on a finer subdivision of the shelf seas obtained using a k means analysis this subdivision distinguishes shelf areas affected by river runoff from areas located far from the influence of terrestrial forcing grid point dependent vertical correlation could also be used to identify local vertical dynamics in the present case we chose to use a subbasin subdivision approach to limit the computational costs of the vertical eof evaluation and we applied two smoothing factors to avoid sharp variations in the vertical operators between the subbasins first the tuning of the eof eigenvalue based on the relationship between the observation error and innovation at the grid point level guarantees that the eofs are not strictly uniform in each subbasin second the application of v h after the v v operator provides an additional smoothing effect as was shown by dobricic and pinardi 2008 the covariance of observation errors is crucial when dealing with shelf seas assimilation in order to guarantee the effective integration of satellite observations it has been highlighted that the definition of observation uncertainties provided by the error covariance matrix is relevant to the assimilation of satellite chlorophyll dowd et al 2014 in the present work we assumed that the observation error is proportional to the field variance a similar approach has been adopted in shulman et al 2013 where the representation error was estimated as proportional to the variance of the observations given the high variability of surface chlorophyll concentration in coastal water this approach would imply higher error in coastal waters where relevant temporal variability occurs as a pragmatic approach we imposed a maximum ratio between the observation and background error to guarantee an effective assimilation of satellite observations this approach has been adopted considering that the evaluation of the observation errors is not uniquely defined dowd et al 2014 noted that the algorithm used for the evaluation of chlorophyll concentration should be approached as a model with its own accuracy errors which should be considered in data assimilation schemes an example of the estimation of related background and observation error covariance matrices for satellite chlorophyll is presented in ford and barciela 2017 alternatively some applications have demonstrated the feasibility of directly assimilating optical data from ocean colour ciavatta et al 2014 jones et al 2016 shulman et al 2013 thus avoiding the evaluation of the chlorophyll algorithm related error but on the other hand requiring the parameterization of the optical properties of water in the marine ecosystem model several results of a biogeochemical model can benefit from a better description of phytoplankton chlorophyll for example based on the updated and validated representation of the shelf and open sea mediterranean sea chlorophyll we provide an estimate of the phytoplankton primary production these results update the former estimate presented in lazzari et al 2012 and show that primary production in the western mediterranean is mainly located in the open sea whilst in the eastern mediterranean the areas with the highest primary production are mostly located in shelf seas this difference indicates that primary production is mainly related to nutrient flow due to open sea vertical convection in the western mediterranean lavigne et al 2013 lazzari et al 2012 2016 taylor and ferrari 2011 and riverine inputs i e coastal processes in the eastern mediterranean as a final consideration we highlight that dealing with both shelf and open sea data means significantly increasing the range of the variability of observations i e chlorophyll concentration values can range over more than two orders of magnitude thus the observed distribution might be quite far from the gaussian distribution in this case previous studies have proposed the use of the log transformation ford and barciela 2017 song et al 2016b as well as anamorphic transformations doron et al 2013 or particle filtering mattern et al 2013 in the present study we used the natural values of chlorophyll concentration because using log normal values might result in a non optimal solution of the cost function as discussed in teruzzi et al 2014 moreover the non log transformed space is more representative of the vertical dynamics of the vertical operator of background error decomposition and it thus preserves the typical shapes of the modelled chlorophyll profiles observed in the mediterranean sea 5 conclusions we developed and applied a three dimensional variational scheme for the assimilation of satellite chlorophyll observations in coastal waters in order to assimilate both open sea and shelf sea data the data assimilation scheme for coastal waters features a non homogenous vertical component and a non uniform and direction dependent horizontal component of the background error covariance the results show that the data assimilation updates are propagated consistently to the salinity gradient field i e a dynamic property that tracks currents and river inputs providing an improved simulation of the spatial variability and seasonal cycle of chlorophyll concentration in mediterranean coastal waters the use of shelf seas satellite observations of chlorophyll demonstrates the potentiality to improve the quality of the cmems operational biogeochemical products in the mediterranean sea although further research is still needed to improve the forecast also for non assimilated variables acknowledgements we acknowledge v bandelj from ogs and a bruschi from ispra for the support in the processing of the in situ data used for the validation and the reviewers for their valuable comments that helped us to improve the quality of this work we acknowledge the cineca award under the iscra initiative medcoast for the availability of high performance computing resources and support this study has been conducted using e u copernicus marine service information appendix a definition of shelf seas k regions through a k means analysis the v v operator in the shelf mediterranean seas has been constructed introducing a finer spatial subdivision compared to the one proposed for the open sea in teruzzi et al 2014 a k means analysis has been applied to subdivide each of the 10 regions identified in lazzari et al 2012 in the shelf seas the k means analysis aims to partition a set of data x into a predefined number k of clusters such that each data belongs to the cluster with the nearest mean macqueen 1967 operatively the k means analysis provides a set of objects u 1 u k into which each element of the data set x is classified minimizing the sum of the distance of the elements of the data set from the centroid of the cluster a1 m i n i 1 k x u i x c i where x u i are the elements of the data set that are classified into each cluster u i while c i are the centroids of the clusters u i defined as the mean of the elements x u i in our application the elements of the dataset are the mean monthly chlorophyll profiles for all the shelf seas points of a given mediterranean subbasin thus the dimension of an element of x and of the centroids are equal to 12 number of months times the number of chlorophyll profile levels the mean chlorophyll profiles are computed as climatological average from the 1999 2015 cmems reanalysis teruzzi et al 2016 the euclidean distance has been applied for the evaluation of the norm in eq a1 an iterative refinement algorithm available in the scipy python package has been used for the minimization of eq a1 the analysis has been repeated twice using a random initialisation at the first step and the results of the first step as initialisation for the second one for each subbasin the analysis has been repeated using a number of clusters k ranging from two to five considering the high spatial patchiness of the clusters obtained with higher values of k the number of clusters k has been pragmatically chosen equal to two for all the subbasins 
24069,the high spatial and temporal variability of biogeochemical features induced by local dynamics and terrestrial and atmospheric inputs in shelf seas are challenging issues for the implementation of data assimilation in these areas the objective of this study is to integrate satellite ocean colour observations with a coupled physical biogeochemical model in order to improve the spatiotemporal descriptions of chlorophyll and other biogeochemical variables in the mediterranean shelf seas we adopted a specifically developed three dimensional variational data assimilation scheme for the assimilation of satellite chlorophyll data the non homogeneous vertical component the non uniform and direction dependent horizontal component of the background error covariance are the key features of the upgraded three dimensional variational data assimilation scheme for shelf seas the application of the new assimilation scheme significantly improves chlorophyll estimates in shelf seas particularly in the representation of their spatial and temporal variability based on these results we provide an estimate of the annual primary production of the mediterranean basin keywords coastal water data assimilation phytoplankton chlorophyll primary production mediterranean sea 1 introduction the physical and biogeochemical dynamics in shelf seas are characterised by large spatial and temporal variability due to their interactions with coastal and bottom morphology and with boundary forcing in particular fronts and mixing associated with freshwater runoff internal waves tides and upwelling processes deeply affect the physical dynamics of shelf seas at spatial scales ranging from 10 m to more than 100 km denman and powell 1984 mann and lazier 2005 understanding the biogeochemical dynamics in shelf seas is crucial for defining the environmental status of coasts and for supporting blue growth initiatives she et al 2016 furthermore an improved shelf seas description results in a more consistent picture of basin scale biogeochemical dynamics observations both in situ and remote and models can provide descriptions of shelf marine biogeochemistry at different spatial and temporal scales large datasets of in situ observations have been used to analyse the interaction between shelf seas biogeochemical dynamics and physical processes at different scales and locations e g in the european sea arin et al 2013 cossarini et al 2012 guadayol et al 2009 mozetiĉ et al 1998 romero et al 2014 solidoro et al 2009 varela et al 2010 and long term variability and trends giani et al 2012 harding et al 2016 kuosa et al 2017 lynch et al 2014 mozetič et al 2010 qiao et al 2017 rydberg et al 2006 yunev et al 2007 zingone et al 2010 satellite observations are regularly collected and can provide synoptic information at a relatively high spatial resolution and chlorophyll concentrations can be derived from satellite ocean colour observations using algorithms based on colour spectra analysis muralikrishna 1984 santoleri et al 2008 volpe et al 2007 satellite ocean colour has been widely used to evaluate and monitor the water quality and ecological status of shelf seas gohin et al 2008 harvey et al 2015 novoa et al 2012 inter annual trends colella et al 2016 loisel et al 2017 mélin et al 2011 terauchi et al 2014 and the spatial and temporal variability of blooms and trophic regimes beltrán abaunza et al 2017 blondeau patissier et al 2014 carvalho et al 2011 d ortenzio and ribera d alcalà 2009 gaetan et al 2016 marchese et al 2014 mayot et al 2016 rinaldi et al 2014 finally numerical models can seamlessly cover three dimensional spatial and temporal domains at different scales and can be used to investigate specific processes such as phytoplankton bloom and production dynamics and the effects of physical forcing on them campbell et al 2013 crise et al 1999 ennet et al 2000 fraysse et al 2013 friedrichs and hofmann 2001 holt et al 2012 reboreda et al 2014 st laurent et al 2017 tsiaras et al 2014 as well as eutrophication nobre et al 2005 picart et al 2015 hypoxia da et al 2018 meier et al 2017 testa et al 2014 and assessment of carbon fluxes arruda et al 2015 cossarini et al 2015 hofmann et al 2011 melaku canu et al 2015 none of these observations or models are without limitations in situ data are point observations sparse in space and time with intrinsic representativeness error dowd et al 2014 and they are thus unable to provide a basin wide perspective cloud cover limits the continuity of satellite data which anyway do not provide information under the sea surface both in situ and satellite observations are affected by measurement error and satellite estimates of chlorophyll also suffer from the uncertainty associated with the algorithm formulation volpe et al 2012 on the other hand models are affected by the approximations of their formulation cossarini et al 2009 the uncertainty associated with their parameters cossarini and solidoro 2008 solidoro et al 2003 and their boundary and initial conditions pastres et al 1999 by numerical errors due to their discrete spatial and temporal resolution and the associated unresolved dynamical scales edwards et al 2015 the integration of models and observations using data assimilation schemes da has been demonstrated to be a powerful tool in coupling different sources of information to obtain a better description of biogeochemical status and evolution a number of recent applications have shown that data assimilation of satellite observations can be successfully applied in biogeochemistry to provide insight into different processes descriptions of the chlorophyll seasonal cycle as well as investigations of vertical chlorophyll dynamics carbon fluxes and hypoxia have been provided by models that integrate a da scheme for satellite observations ciavatta et al 2014 ciavatta et al 2016 fontana et al 2009 2010 2013 ford and barciela 2017 ford et al 2012 hu et al 2012 kalaroni et al 2016 shulman et al 2013 song et al 2016a teruzzi et al 2014 tsiaras et al 2014 some of the works above mentioned are focused on or include also shelf areas ciavatta et al 2014 2016 fontana et al 2009 fontana et al 2010 2013 hu et al 2012 shulman et al 2013 song et al 2016a in the present work we provide an example of how remote sensing observations on shelf areas can be efficiently integrated in a basin scale model which includes shelf and open sea areas to improve the description of the biogeochemistry in shelf seas in the context of three dimensional variational 3dvar data assimilation the application of da in coastal waters implies the development of a specific approach because coastal marine biogeochemistry is strongly affected by local dynamics and inputs indeed it is not straightforward that an open sea assimilation scheme provides reliable results in coastal waters fontana et al 2013 in ciavatta et al 2014 a lower decorrelation radius is applied at depth lower than 40 m however simple it is a practical approach to account for the specific features of coastal waters here the existing 3dvar data assimilation scheme teruzzi et al 2014 coupled with the ogstm bfm model ogs tracer model biogeochemical flux model lazzari et al 2012 2016 has been specifically upgraded to assimilate remote observations in shelf seas independent in situ data have been used to provide a comprehensive estimate of the uncertainty of the model simulations produced using the new da scheme furthermore we provide an estimate of the integrated primary production at the basin scale including shelf seas which updates the one given in lazzari et al 2012 the paper is organised as follows section 2 presents the details of the 3dvar methods and the upgrades dedicated to shelf seas assimilation the ogstm bfm model and the observation datasets are also presented in section 2 the results and validation of the assimilation run of the mediterranean sea along with primary production estimations are reported in section 3 finally section 4 and 5 provide the discussion and conclusions respectively 2 material and methods 2 1 the cmems mediterranean biogeochemical model system the 3dvarbio ogstm bfm coupled biogeochemical model system consists of three major components a transport model ogstm lazzari et al 2012 lazzari et al 2010 a biogeochemical model bfm cossarini et al 2015 lazzari et al 2012 2016 vichi et al 2007 and references therein and a 3dvar data assimilation scheme 3dvar bio teruzzi et al 2014 this model system is currently implemented with assimilation of open sea satellite chlorophyll within the mediterranean component of the european copernicus marine environment monitoring services cmems and operationally provides analysis forecast and reanalysis products for the biogeochemistry of the mediterranean sea in the present application we adopt the transport ogstm model a modified version of the opa 8 1 transport model foujols et al 2000 which resolves the advection vertical diffusion and sinking terms of the tracers i e biogeochemical variables the mesh grid is based on a 1 16 longitudinal scale factor and a 1 16 cos φ latitudinal scale factor the vertical mesh grid accounts for 72 non uniform vertical z levels in which there are 25 in the first 200 m depth 31 between depths of 200 and 2000 m and 16 below a depth of 2000 m the minimum resolved depth is at the first level and is equal to 3 m the temporal scheme of ogstm is an explicit forward time scheme for the advection and horizontal diffusion terms whereas an implicit time step is adopted for the vertical diffusion term the physical dynamics i e temperature salinity velocity and diffusivity fields in addition to surface data for solar shortwave irradiance and wind stress that are coupled off line with biogeochemical processes are precomputed using nemo3 4 coupled with oceanvar assimilation dobricic and pinardi 2008 and are available through the cmems catalogue simoncelli et al 2014 the physical forcing fields have daily frequency and they are linearly interpolated at the computational time step of the ogstm bfm model 30 min the features of the biogeochemical reactor bfm biogeochemical flux model have been chosen to target the energy and material fluxes through both classical food chain and microbial food web pathways thingstad and rassoulzadegan 1995 and to take into account the co occurring effects of multi nutrient i e carbon nitrogen phosphate silicate interactions both of these factors are very important in the mediterranean sea wherein microbial activity fuels the trophodynamics of a large part of the system throughout much of the year and both phosphorus and nitrogen can in principle play limiting roles béthoux et al 1998 krom et al 1991 the bfm model includes nine plankton functional types pfts heterotrophic pfts consist of carnivorous and omnivorous mesozooplankton bacteria heterotrophic nanoflagellates and microzooplankton the autotrophic pfts are diatoms flagellates picophytoplankton and dinoflagellates internal contents of carbon nitrogen phosphorous chlorophyll and silicon only for the diatoms pft are dynamically simulated summing up on 17 state variables needed to represents the four phytoplankton functional types the model is fully described in lazzari et al 2012 2016 where it was corroborated for chlorophyll primary production and nutrients in the mediterranean sea in a 1998 2004 simulation the bfm model is also coupled to a carbonate system model cossarini et al 2015 in order to simulate the dynamics of alkalinity ph dissolved inorganic carbon and co2 fluxes at the air sea interface in the cmems workflow which is applied for both analysis forecast and reanalysis simulations the data assimilation of surface satellite chlorophyll concentration data is performed every seven days using a 3dvar scheme 3dvar bio teruzzi et al 2014 which updates the four phytoplankton functional groups that are included in the bfm 3dvar methods represent a feasible and efficient framework for assimilation in oceanographic applications because they allow to properly design the key aspects of assimilation problems such as the background and observation error covariance matrix thus mantaining computational costs affordable dowd et al 2014 edwards et al 2015 the 3dvar bio assimilation scheme teruzzi et al 2014 computes the analysis status x a from the minimization of a cost function j in which the forecast and observations are weighted by their respective error covariance matrices in the present formulation the assimilation updates all the 17 phytoplankton variables the cost function can be written as a function of the increment δ x which is defined as the difference between the analysis x a and the forecast produced by the model x f δ x x a x f at a generic assimilation step the cost function is defined as follows 1 j δ x 1 2 δ x t b 1 δ x 1 2 d h δ x t r 1 d h δ x where b and r are the covariance matrices for the background and observational errors respectively h is the jacobian of the observation operator h x which sums the surface chlorophyll contributes from the four phytoplankton functional types and d is the difference between observations y and model results d y h x and is referred as the innovation vector after undergoing opportune transformations the cost function can be written as a function of a vector v with δx v b v h v v v 2 j δ x 1 2 v t v 1 2 d hv b v h v v v t r 1 d hv b v h v v v in eq 2 the forecast or background covariance matrix b is approximated as b v v t where v is a mapping operator that following the approach of dobricic and pinardi 2008 is decomposed into a sequence of operators that account for different components of the error covariance in particular v v b v h v v which are the biogeochemical horizontal and vertical operators respectively the solution of the minimization is the vector v whose dimension is defined by the definition of the vertical operator v v i e a set of empirical orthogonal functions the increments are then applied to the 3d fields of the 17 biogeochemical variables which describe the phytoplankton functional types through the application of v h i e a gaussian recursive filter and v b i e a biogeochemical covariance operator the operator v b is a biomass covariance operator which preserves the ratios among phytoplankton functional types and their internal quotas with additional criteria to maintain the optimal phytoplankton growth rate based on the optimal nutrient to carbon internal quota teruzzi et al 2014 finally the v b operator includes also a post processing procedure which replaces the negative chlorophyll values with a small positive value 10 4 mg chl m3 and change accordingly the components of each pft in order to avoid any negative values in the pft components the effect of this correction is negligible since the negative values are low i e order of 10 2 or closer to zero in small number nearly 5 5 of the cases and located mainly below the photic zone where chlorophyll concentrations are low and the intensity of phytoplankton dynamics is reduced 2 2 chlorophyll estimates from satellite data in recent years new algorithms have been developed to provide shelf seas ocean colour products le traon et al 2015 the surface chlorophyll concentration used in the assimilation scheme is a product of the cmems ocean colour thematic assembly centre oc tac service obtained using remote sensing reflectance rrs spectra rrs data are produced for cmems by the plymouth marine laboratory pml using the esa cci processor estimates of chlorophyll for the mediterranean sea are provided by the global ocean satellite group gos of the institute of atmospheric sciences and climate isac within the italian national research council cnr using two different algorithms medoc4 volpe et al 2007 for case 1 water and ad4 d alimonte and zibordi 2003 for case 2 water colella et al 2016 water is classified as case 1 or case 2 water using the method proposed by d alimonte et al 2003 based on the comparison of the satellite spectrum with the average spectral signature of the water type obtained from in situ measurements full basin estimates of chlorophyll concentration based on the approach proposed by d alimonte et al 2003 are operationally provided by cmems along with their validation oceancolour med chl l3 nrt observations 009 040 http marine copernicus eu services portfolio access to products option com csw view details product id oceancolour med chl l3 nrt observations 009 040 for the present application daily chlorophyll concentrations at a spatial resolution of 1 km have been interpolated at 1 16 and temporally aggregated using a seven day average to increase the spatial coverage of the assimilated field without losing excessive details about the temporal evolution of the surface chlorophyll field the error covariance matrix for the observations r in eq 1 has been assumed to be diagonal excluding error covariance between observations and monthly varying variances have been adopted for each grid point the error variance has been estimated as the variance of the multiannual 1999 2015 time series of chlorophyll concentration produced by gos isac group using the algorithm above described in our pragmatic approach higher observation errors are attributed to areas with higher variabilities as discussed in teruzzi et al 2014 this approach differs from the usual one that sets the observation error of ocean colour data as proportional to the observed chlorophyll concentration fontana et al 2013 hu et al 2012 song et al 2016a tsiaras et al 2017 however other approaches include for instance the use of an observation error derived from the standard deviation associated to the ocean colour products ciavatta et al 2016 or from an observation based ensemble shulman et al 2018 2 3 independent in situ dataset for validation the in situ dataset consists of measurements of chlorophyll nitrate and phosphate along the italian coast table 1 and fig 1 at a maximum shore distance of 3 km provided by the italian national institute for environmental protection and research ispra sintai dataset http www sintai isprambiente it data were collected almost regularly at monthly or higher frequencies by different regional environmental agencies in 2013 these data were then quality processed by ispra 2 4 upgrade of the 3dvar bio assimilation scheme the upgraded elements of the new version of the 3dvar bio scheme which is used for the assimilation of shelf seas observations are the horizontal v h and vertical v v operators which have been modified to account for the specific dynamics of error propagation in the shelf seas 2 4 1 upgrade of the vertical operator vv the vertical operator v v provides the error covariance in the vertical direction it comprises a set of profiles of chlorophyll error covariances that are obtained using an eof empirical orthogonal function decomposition of a dataset of vertical chlorophyll profiles to account for differences in the vertical biogeochemical dynamics of shelf and open sea areas a dedicated v v operator has been designed for the shelf seas the depth of 200 m is chosen as the threshold between shelf and the open sea fig 1 according to previous applications in mediterranean sea gazeau et al 2004 lazzari et al 2012 teruzzi et al 2014 as described in teruzzi et al 2014 in the open sea i e at depths greater than 200 m the v v operator consists of a set of vertical eof profiles defined for each month and for each subbasin of fig 1 the same temporal and spatial approach was applied to the shelf seas however a much finer spatial resolution was chosen in order to account for the specificity of local features along the mediterranean coast in particular a k means analysis based on the time evolution of the chlorophyll field provided by the 1999 2015 cmems reanalysis teruzzi et al 2016 identified two k regions for each shelf area of the 10 subbasins fig 1 details on the k means approach are provided in appendix a the k region subdivision reveals that within a given subbasin shelf area the two k regions can distinguish the areas k reg2 affected by important river run off i e the ebro and rhone rivers for the north western mediterranean sea nwm the nile and turkish rivers for the levantine sea lev and the po and other minor south eastern adriatic rivers for the adriatic sea adr or similar local inputs i e the dardanelles for the aegean sea aeg from the areas k reg1 that are far from the river mouths the evolution of the total variance of the error fig 2 shows higher values in late winter or spring in the k regions that are affected by rivers k reg2 in the nwm lev and adr which is consistent with the hypothesis that important differences in chlorophyll dynamics are triggered by land forcing along the coast of the subbasins in the ionian sea ion which is characterised by the absence of relevant riverine inputs the two k regions are patchily distributed and are distinguished only by their summer variance which is higher in the gulf of gabes and along the african coast the eof decomposition was applied to the weekly chlorophyll anomaly profiles within each k region and month in order to obtain sets of profiles of the vertical error covariance that are specific to different parts of the mediterranean shelf seas thus the result of the eof decomposition is a set of eigenvectors chlorophyll vertical profiles and associated eigenvalues for each k region in shelf seas and each subbasin in open sea each set of eigenvectors and associated eigenvalues represent the vertical error covariance for each subbasin or k region of the mediterranean sea finally according to desroziers et al 2005 a tuning procedure based on the surface observation error covariance and the difference between observation and model before the assimilation d is used to compute the eigenvalues of the eof profiles at a local scale i e at each grid point the mean quadratic innovation e dd t is defined as being equal to the sum of the observation error variance r and the background error variance at the surface thus tuning the eigenvalues αi of the eofs at each grid point as follows 3 e d d t r h α i e i α i e i t h t where the second term in the right hand side of the equation is the background error variance at the surface as described by the eof and e i are the eigenvectors of the eofs in the evaluation of αi it has been imposed that the background error variance is at least equal to half of the observation error variance in order to guarantee the effective assimilation of satellite observations as a result the v v operator of the mediterranean sea consists of a set of eof profiles for each grid point that share a common shape within each subbasin in open sea and within each k region in shelf seas 2 4 2 new horizontal operator vh the operator v h which describes the horizontal error covariance is based on a recursive gaussian smoother whose effect is regulated by the correlation radius length scale l dobricic and pinardi 2008 in the open sea l is set to 10 km teruzzi et al 2014 which is within the order of magnitude of the mediterranean sea mesoscale lionello 2012 in shelf seas where the morphology and local physical features can produce sharp gradients of biogeochemical fields l differs in its longitudinal lx and latitudinal ly directions in particular constant in time values of lx and ly were computed for all shelf seas grid points proportionally to the inverse of the surface salinity gradient components along the longitude and the latitude x s x y and y s x y respectively as follows 4 l x x y x s x s x y l 5 l y x y y s y s x y l where i s is the mean salinity gradient component along x and y over the mediterranean sea surface salinity can be considered to be a signature of local dynamics in shelf seas and it can be assumed that more local processes i e those with a smaller correlation radius correspond to higher salinity gradients the surface salinity field used to estimate the length of the correlation radius is based on the 1990 2015 mean value of the cmems mediterranean sea physics reanalysis simoncelli et al 2014 the correlation lengths calculated using the salinity gradient fig 3 are nearly one third the size of the open sea correlation length in the northern and southeastern adriatic sea the northeastern aegean sea aeg the gulf of gabes and other more patchy areas along the mediterranean coast in these regions the reduced correlation length reflects the reduced horizontal propagation of the increments provided by the data assimilation other areas e g the italian shores of the tyrrhenian sea the western side of the adriatic sea in the longitude direction the gulf of libya the israeli coast and the southern aegean sea in the latitude direction show correlation radii that are larger than the average open sea value thus reflecting the fact that in areas with smooth salinity gradients the spread of the assimilation updates is higher 2 5 setup of the simulations in the present paper the following three simulations are compared fullda openda and noda the first two runs differs in terms of v v v h and observation operators the observation operator in openda is defined in order to assimilate the open sea observations only i e where water depth is higher than 200 m whereas in fullda it has been designed in order to assimilate all the observations both in shelf and open sea moreover fullda uses the upgraded v v and v h operators a reference run without assimilation noda completes the simulation list the simulations cover the period from january to december 2013 because the availability of the ispra in situ observation dataset in 2013 allows us to quantitatively evaluate the impact of the assimilation of shelf seas data the simulations share the same setup which is based on the official cmems mediterranean analysis forecast system bolzon et al 2017 in particular physical forcing is provided by cmems products simoncelli et al 2014 while climatological biogeochemical boundary conditions are set for gibraltar strait the dardanelles rivers and atmosphere forcing nutrient concentrations in the atlantic buffer zone are relaxed to the seasonally varying profiles derived from climatological medar medatlas data measured outside gibraltar climatologies of nutrient loads from rivers and other coastal nutrient sources were based on the reconstruction of the spatial and temporal variability in water discharge estimated using the method described by ludwig et al 2009 atmospheric deposition rates of inorganic nitrogen and phosphorus are defined according to the synthesis proposed by ribera d alcalà et al 2003 initial conditions are given after the spin up of a 14 year long run of biogeochemical reanalysis cmems reanalysis teruzzi et al 2016 regarding the assimilation the two assimilation setups i e openda and fullda compare the present one bolzon et al 2018 and the previous cmems mediterranean analysis forecast system versions bolzon et al 2017 3 results 3 1 comparison between fullda and openda the main effect of fullda is a general increase in the surface chlorophyll concentrations of shelf seas which is consistent with the high chlorophyll concentrations observed by satellite fig 4 and table 2 the fullda increase in mean chlorophyll values is more evident in the subbasins with a wide continental shelf such as the adriatic sea adn and ads and the gulf of gabes in the ionian sea ion the mean chlorophyll concentration in fullda is higher than in openda by nearly 50 in the mediterranean shelf seas which is consistent with the assimilation of shelf seas satellite chlorophyll applied in fullda and not in openda in the adriatic and ionian shelf seas the relative difference between fullda and openda is nearly equal to 100 and 60 respectively in these areas the effects of shelf seas assimilation include both a significant increase in the surface chlorophyll concentration and a modification of its pattern in the adriatic sea the highest concentrations of fullda are located in the northern adriatic sea and along the italian coast thus providing an east west gradient of chlorophyll that substantially differs from the results obtained by openda but is consistent with satellite observations and the well known chlorophyll features of the subbasin mélin et al 2011 zavatarelli et al 2000 in the gulf of gabes the increments applied in fullda yield maximum chlorophyll concentrations in the eastern part of the area which is consistent with satellite observations fig 4 but is opposite to the results of openda also the chlorophyll concentrations in lev and aeg near the nile mouth and the dardanelles are significantly impacted in fullda fig 4 in shelf seas the mean chlorophyll concentration is increased by fullda by nearly 70 and 30 in lev and aeg respectively the increase of the mean shelf sea chlorophyll in lev is relevant despite the relative small extension of its shelf sea and is due to the large positive increments applied by da in the nile mouth region fig 4 indeed the climatological inputs used for the nile river do not account for the positive trend of chlorophyll concentration in the area this trend has been documented by colella et al 2016 and is related to the increase of the egypt industrial capacity the differences between openda and noda highlights that the open sea assimilation affects also the chlorophyll concentration in the shelf seas table 2 the open sea assimilation increments are propagated to the shelf seas due to the effect of v h operator and of the transport processes during model integration as a result the openda shows increments in the shelf seas that have the same sign of those applied in open sea close to the shelf the sign of the increments is mainly positive but an exception is shown for lev where open sea increments are mainly negative not shown and thus also in the shelf seas even if with some exceptions generally the higher the extent of the shelf area is compared to the sub basin area the lower the openda impacts on shelf sea the differences between fullda and noda are at least doubled compared to those of openda in most of the subbasins fullda produces a significant increase in the spatial variability of simulated chlorophyll in shelf seas 74 increase in the whole mediterranean sea table 3 the mean spatial standard deviation in shelf seas of fullda is significantly higher than that of the openda simulation in all the subbasins especially in adn ads ion and lev table 3 which indicates that the assimilation of satellite data increased the simulated variability on a local scale and on areas interested by patchy processes examples of chlorophyll time series in four near shore grid points are shown in fig 5 in all of the points which are representative of the chlorophyll dynamics in the four shelf areas the effects of the assimilation of shelf seas satellite chlorophyll of fullda are clearly detectable indeed the fullda time series are closer to the satellite observations in terms of weekly signal and monthly variability black solid line in fig 5 in particular fullda exhibits relevant effects at the beginning and at the end of the year when the fullda concentrations are significantly higher than the openda concentrations except for the lionp time series during spring and summer three locations i e adrp lionp and nilep in several weeks from may to september show a low persistence of the assimilation updates after the assimilation the chlorophyll concentrations of fullda daily model output in grey line in fig 5 tend to decrease towards the values simulated by the model without the shelf seas assimilation openda and fullda simulation presents an artificial temporal variability at daily time scale in these cases nearly 80 of the increments introduced by the assimilation is lost five days after the assimilation fig 5 also shows that the increments applied by fullda during summer are small in gabes p and nilep in june thus indicating that in these cases the time evolution of chlorophyll is already well represented by the openda model setup using monthly climatological terrestrial inputs e g nutrient load as boundary conditions probably underestimates the effects of actual runoff events on triggering shelf seas blooms in fullda the assimilation of case 2 satellite chlorophyll observations can overcome the inadequacy of climatological local forcing conditions by acting directly on the state variables fig 6 shows examples of the spring and autumn bloom events in the adriatic sea that are related to important terrestrial inputs from the po river which are efficiently corrected by fullda the low salinity patterns fig 6 left column highlight the presence of important river runoff and consequent nutrient discharge in the area the use of the climatological boundary conditions applied in the openda results cannot be used to reproduce the effects of short lasting and impulsive events on phytoplankton dynamics fig 6 central column whilst fullda correctly simulates the presence of high chlorophyll concentration values that match the low salinity patterns fig 6 right column the computed time series of the spatial correlation between the salinity and chlorophyll patterns of openda and fullda in the northern adriatic areas do not show a significant increase with fullda not shown this is likely because small surface chlorophyll blooms may be triggered by very local hydrodynamic features whose temporal and spatial details are not fully captured by the physical forcing model however fullda significantly improves the representation of wide blooms related to low salinity events the spatial distribution of the da increments of fullda in shelf seas is related to the application of the non uniform and non isotropic horizontal operator v h to evaluate its effect we compared the differences in the assimilation results obtained using a uniform and isotropic correlation length l 10 km univh case and those obtained using the new v h nonunivh case the difference d a between the satellite observations y and the surface chlorophyll yielded by the assimilation x a was evaluated for these two cases the root mean square rms values of d a in the mediterranean shelf seas table 4 show that the application of the new v h operator produces an assimilated field that is closer to the observations than that obtained in the univh case the highest reductions of the d a rms values are observed in the eastern subbasin adn ads aeg ion and lev not shown which yield percentage differences ranging from 15 in ads to 49 in adn the use of two different correlation radii for longitude lx and latitude ly can affect the distribution of the assimilation increments in the horizontal plane it is expected that the assimilation updates are more local and less smooth along one direction x or y where the relative correlation radius lx or ly is smaller than the reference value l the fact that a lower correlation radius in shelf seas is essential to produce local small scale features is demonstrated by the chlorophyll gradient computed where lx or ly are smaller than l in the univh nonunivh and satellite surface chlorophyll cases table 4 in the nonunivh case the chlorophyll gradient components are closer to the satellite values thus indicating that the use of a smaller correlation radius for longitude or latitude reduces the smoothing of the solution in accordance with the high horizontal variability of satellite observations 3 2 validation using the in situ dataset the improvement that is introduced by using da to simulate chlorophyll in open sea areas has been shown by teruzzi et al 2014 here we compare the results of the fullda and openda simulations with independent in situ observations of chlorophyll and nutrient concentrations collected at the surface in the shelf areas of the adn ads ion tyr and nwm subbasins fig 1 table 5 shows the mean bias model results minus observations and the root mean square difference rmsd values for the subbasins using available data from two 6 month periods i e january to june or semester win spr and july to december or semester sum aut the chlorophyll bias between observations and openda is always negative which means that the model results systematically underestimate the in situ observations fullda which generally increases chlorophyll concentrations figs 4 and 5 significantly reduces the bias in all subbasins the largest improvements occur in adn and ads in both semesters and in tyr in win spr the rmsd is significantly improved in adn and tyr in win spr in the sum aut period the rmsd decreases by 10 in adn remains almost unchanged in tyr and ion and slightly increases in ads the high positive increments towards satellite data in ads during sum aut induced by the shelf seas assimilation change the sign of the bias and reduce its absolute value the comparison of the available observations of non assimilated variables shows that fullda has negligible influence on the bias and rmsd values of phosphate while it affects those of nitrate table 5 the range of measured nitrate concentrations is very high i e on the order of 10 mmol n m3 in adn 1 mmol n m3 in ads and slightly less than 1 mmol n m3 in ion and nwm accordingly the mean bias and rmsd values also vary widely between subbasins and are highest in adn for both fullda and openda the sign of nitrate bias is both positive and negative in the openda simulation while it is negative in all of the subbasins and seasons in fullda ads ion and nwm show decreases in their absolute values of bias and concomitant decreases in their rmsd values only adn shows that in shelf seas an assimilation induced decrease of nitrate triggers a worsening of the skill indexes in both seasons since the assimilation scheme does not update nitrate the decrease of nitrate concentration occurs during the model integration after the assimilation steps according to the formulation of v b teruzzi et al 2014 when positive increments of chlorophyll are applied by da the phytoplankton internal content of carbon is updated proportionally while the internal content of nitrate is increased of the amount necessary to keep the internal phytoplankton n c ratio equal to the optimal value set in bfm as equal to the redfield ratio thus if the n content before the assimilation is high enough to have an n c ratio greater than optimal even after the carbon increment the phytoplankton internal content of nitrogen is not modified by the assimilation this feature has been implemented to prevent the generation of too much mass of the non limiting nutrient which accumulate in phytoplankton according to the luxury uptake formulation of bfm vichi et al 2015 in the case of adn the phytoplankton n c ratio before the assimilation is higher than the optimal value and the assimilation scheme applies positive increments for chlorophyll after the assimilation the phytoplankton biomass is increased and the n c ratio is between the optimal and the maximum ratio allowed by the luxury uptake of the non limiting nutrient of the bfm parameterization twice the redfield ratio the combination of 1 high availability of nitrate in adn 2 increased phytoplankton biomass and 3 lower than maximum phytoplankton n c ratio causes an additional phytoplankton uptake of nitrate that results in a reduction of nitrate concentration in sea water it is worth to highlight that in our application the reduction of nitrate concentration in the adriatic does not produce nitrate limitation conditions since the n c ratio is always between the optimal and maximum value on the other hand phytoplankton growth is still phosphate limited as confirmed by an internal phytoplankton p c ratio lower than the optimal value in bfm equal to the redfield ratio and the n p ratio in sea water higher than 16 moln molp redfield lazzari et al 2016 3 3 primary production fullda showed to improve the simulation of chlorophyll thus based on the results of the fullda simulation we provide estimates of the vertically integrated mean annual primary production in the mediterranean sea shelf and open seas fig 7 although these results are based on a one year simulation they represent an upgrade of the basin wide estimates discussed in lazzari et al 2012 these results are consistent with previous estimates from satellite observations bosc et al 2004 siokou frangou et al 2010 uitz et al 2012 which showed that the western mediterranean is more productive than the eastern mediterranean the mean primary production values in the eastern adn ads aeg ion and lev and western alb sww swe nwm and tyr subbasins are 117 gc m2 y and 188 gc m2 y respectively these values are higher than those provided by lazzari et al 2012 but in the range of other estimates of primary production in mediterranean sea at basin or sub basin scale bosc et al 2004 bricaud et al 2002 kessouri et al 2018 siokou frangou et al 2010 uitz et al 2012 with a mean primary production of 142 gc m2 y for the whole mediterranean sea for fullda which is 6 higher than in openda local patches of high production are depicted in fig 7 which highlights the heterogeneous presence of high productivity areas close to the coasts i e the western part of the italian adriatic coast dardanelles and nile mouth regions that are not shown in lazzari et al 2012 in the eastern mediterranean the presence of shelf areas with high productivity indicates that the mean integrated primary production is higher in shelf seas than it is in the open sea for instance in the adriatic sea the mean values of primary production are 143 gc m2 y and 133 gc m2 y in shelf and open sea respectively in contrast in the western mediterranean the mean primary production is higher in the open sea with a mean value of 191 gc m2 y compared with that of 168 gc m2 y in shelf seas thus highlighting that in the western mediterranean shelf seas phenomena are not so relevant to primary production as in the adriatic sea which is a semi enclosed basin strongly affected by coastal processes similar results have been obtained in a study focused on the fertilization sources in the mediterranean sea macias et al 2017 the results obtained using fullda indicate that the model reproduces the relevant spatial variability of primary production and highlight the prominent role that shelf seas play in primary production in some specific areas of the mediterranean sea which is an aspect difficult to capture using only in situ measurements 4 discussion in the present study we showed how case 2 water remote chlorophyll observations can be efficiently integrated in a complex biogeochemical model using a 3dvar data assimilation scheme to better describe the phytoplankton dynamics and their spatial patterns in the mediterranean shelf seas the modelled results have been validated against independent in situ observations of chlorophyll and nutrients along the italian coast validation for open sea areas is provided in teruzzi et al 2014 the results of comparisons with independent in situ observations are encouraging indeed the fullda simulation substantially improves the statistics of the assimilated variable chlorophyll in all of the subbasins while slightly improving or at least not deteriorating the skill statistics of nutrients except for nitrate in the northern adriatic the statistics evaluated for chlorophyll and nutrients are comparable to those provided in fraysse et al 2013 in an area of the north western mediterranean as the root mean square difference rmsd between in situ observations and model values is the same order of magnitude as the mean in situ measurements in a recent application of biogeochemical assimilation in the mediterranean sea tsiaras et al 2017 the rmsd values obtained from the comparison with a climatology based on in situ data are similar to those obtained in the present study for phosphate while the rmsd values of nitrate are significantly lower in the present study the results of the validation are even more interesting when considering that most of the in situ data have been collected at very shallow locations i e in the first model grid point from the coastline and they thus describe very local and near shore dynamics that are not properly simulated by the model itself the decrease of nitrate concentration in the northern adriatic which deteriorates the skill statistics in this area is due to a combination of the v b operator which produces higher phytoplankton biomasses with a reduced internal n c ratio in this particular case and the luxury uptake mechanism for a non limiting nutrient of the bfm model lazzari et al 2016 this condition increases the phytoplankton uptake of nitrate and consequently its concentration decreases an improvement of the representation of non assimilated variables is not straightforward in biogeochemical da for state estimation as shown in previous publications as an example ford et al 2012 indicate as a good result of their assimilation the non degradation of non assimilated variables other works clearly indicate and comment on degradation of some non assimilated variables especially nutrients ciavatta et al 2014 fontana et al 2013 ford et al 2012 shulman et al 2013 simon et al 2015 tsiaras et al 2017 our results highlight the complexity of the biogeochemical response to data assimilation and the need to investigate the specific response of non assimilated variables in biogeochemical models further improvements on nutrients could be obtained by the implementation of a multivariate v b operator accounting for the covariance between chlorophyll and nutrients in complex biogeochemical models such as ogstm bfm the definition of a thorough covariance between chlorophyll and nutrients is not a trivial task indeed the relationship between phytoplankton chlorophyll and external nutrients is not linear nor constant in time and space and regulated by different processes chlorophyll synthesis phytoplankton growth phase and nutrient uptake the definition of a covariance v b operator could be realised using two different approaches an error covariance matrix built on long term model simulations e g shulman et al 2013 or on the spreading of an ensemble e g ciavatta et al 2014 tsiaras et al 2017 a dynamical inverse model similarly to the compensation model proposed by hemmings et al 2008 the persistence of the da updates in the shelf seas is of the order of five days fig 5 the relative low persistence is mainly due to the phytoplankton photoadaptation mechanism and to the decoupled phytoplankton growth and nutrient uptake in the bfm phytoplankton formulation the growth and the nutrient uptake are two decoupled phases the nutrients uptake is related to the external nutrient availability and to the distance from a phytoplankton optimal nutrient internal quota while the growth lysis is related besides other factors to the phytoplankton nutrient internal quota details in lazzari et al 2012 all these peculiar aspects of the bfm formulation point out the need for a more elaborated v b operator involving either a different response of the chlorophyll synthesis to the actual light conditions or the update of the external nutrient concentrations which contribute to regulate the growth rate and chlorophyll synthesis through the uptake mechanism mass conservation is not a constraint that is generally respected by the formulation of the covariance between the biogeochemical variables in state estimation assimilation schemes few examples of biogeochemical da for state estimation with mass conservation have been presented in literature e g the method of hemmings et al 2008 and its applications in ford et al 2012 on the contrary several recent applications in realistic framework of biogeochemical da for state estimation do not include a mass conservation constraint ciavatta et al 2014 2016 fontana et al 2010 2013 hu et al 2012 jones et al 2016 shulman et al 2013 simon et al 2015 song et al 2016a tsiaras et al 2017 in some of these works the mass conservation issue is explicitly discussed in ciavatta et al 2014 the absence of a mass conservation constraint in sequential assimilation is ascribed to the uncertainty of mass balance inherently present in biogeochemical models hu et al 2012 evaluate the impact of da on the total mass of nitrogen while song et al 2016a compare the increments introduced at each assimilation cycle with other system fluxes a mass conservation constraint is not included in our data assimilation and we evaluated the additional terms to the system budget due to da for nitrogen since nitrate is the variable mostly affected by the assimilation the sum of these terms in fullda simulation equals to less than 1 of the mediterranean annual primary production in nitrogen unit and to 17 of the annual input of nitrogen from atmosphere and rivers given an uncertainty of more than 100 in atmospheric input d ortenzio and ribera d alcala et al 2009 and the many possible sources of uncertainty in river estimates ludwig et al 2010 the lack of mass conservation appears not relevant the full basin assimilation of satellite chlorophyll observations allows for several improvements in the simulation of phytoplankton in the mediterranean shelf seas these improvements cannot be otherwise obtained by a biogeochemical model whose formulation and setup are optimised for the representation of open sea dynamics cossarini et al 2015 lazzari et al 2012 in particular because of the use of climatological boundary conditions especially at rivers the relatively low resolution of the model i e fertilization effects due to minor terrestrial inputs are not considered in the basin wide simulation and the lack of interaction between the water column and the bottom the bfm model does not include a benthic component shelf seas are characterised by chlorophyll concentration patterns with high spatial and temporal variability induced by several coastal processes e g riverine inputs local vertical mixing events due to the interactions between currents and morphology mann and lazier 2005 data assimilation might be particularly relevant to address these additional sources of uncertainties in particular coastal water da should be able to propagate the updates in agreement with the dynamic properties of the current field in other words the entity and major directions of propagation of the da updates should adapt to the current field changes that can be also due to changes in riverine inputs our methodology provide a steps toward this direction consistent with this framework the present shelf seas data assimilation scheme reproduces a more reliable description of the higher chlorophyll values close to the river mouths also increasing the spatial variability of chlorophyll concentration in shelf seas a reliable description of the phenomena related to riverine inputs is usually intrinsically limited in basin wide biogeochemical models that use riverine nutrient discharge based on climatological references such as the implementation of the bfm in the mediterranean sea and its present configuration adopted in cmems considering the difficulties associated with designing and maintaining a monitoring plan for river nutrient discharge or creating reliable and validated datasets of river discharge at high spatial and temporal resolution ludwig et al 2009 or even those associated with coupling a biogeochemical model to a hydrological one to estimate nutrient loads the assimilation of satellite observations may provide an alternative and efficient method of integrating riverine effects into a model simulation thus the implementation of da of shelf seas data in a multiannual simulation e g reanalysis can compensate for the use of climatological riverine nutrient discharge taking in account inter annual variability of chlorophyll concentration defining the background covariance operators in shelf seas should account for the specificity of shelf seas processes in both the vertical and horizontal dimensions in shelf seas vertical chlorophyll dynamics are not directly dominated by the seasonal cycle of surface winter bloom and summer stratification that are typical of the open sea furthermore we showed that in shelf seas the horizontal variability increases by nearly 30 in terms of increase of the chlorophyll horizontal gradient table 4 thus indicating that morphological features can introduce strong anisotropy and affect relevant local dynamics accordingly the background error covariance has been modified to update both the vertical and horizontal operators the horizontal error covariance has been designed using two non uniform radii lx and ly for longitude and latitude respectively in shelf seas the chlorophyll field produced using the assimilation scheme with the new horizontal operator better reproduces the values and spatial distribution of satellite chlorophyll in shelf seas non uniform and anisotropic correlation length scales have previously been proposed for 3dvar assimilation in a global ocean circulation model and the benefits of this approach have been highlighted especially in eddy dominated areas and tropical areas where the longitudinal and latitudinal correlation length scales are significantly different storto et al 2014 in an operational framework a method for the evaluation of non uniform correlation radii based on the surface salinity gradient can be implemented using the salinity fields operationally obtained using a general circulation model forecasting system thus adapting the horizontal error covariance operator to the driving hydrodynamic field however this method will also result in a not negligible increase in the computational costs associated with the operational implementation of the assimilation scheme the new vertical operator is based on a finer subdivision of the shelf seas obtained using a k means analysis this subdivision distinguishes shelf areas affected by river runoff from areas located far from the influence of terrestrial forcing grid point dependent vertical correlation could also be used to identify local vertical dynamics in the present case we chose to use a subbasin subdivision approach to limit the computational costs of the vertical eof evaluation and we applied two smoothing factors to avoid sharp variations in the vertical operators between the subbasins first the tuning of the eof eigenvalue based on the relationship between the observation error and innovation at the grid point level guarantees that the eofs are not strictly uniform in each subbasin second the application of v h after the v v operator provides an additional smoothing effect as was shown by dobricic and pinardi 2008 the covariance of observation errors is crucial when dealing with shelf seas assimilation in order to guarantee the effective integration of satellite observations it has been highlighted that the definition of observation uncertainties provided by the error covariance matrix is relevant to the assimilation of satellite chlorophyll dowd et al 2014 in the present work we assumed that the observation error is proportional to the field variance a similar approach has been adopted in shulman et al 2013 where the representation error was estimated as proportional to the variance of the observations given the high variability of surface chlorophyll concentration in coastal water this approach would imply higher error in coastal waters where relevant temporal variability occurs as a pragmatic approach we imposed a maximum ratio between the observation and background error to guarantee an effective assimilation of satellite observations this approach has been adopted considering that the evaluation of the observation errors is not uniquely defined dowd et al 2014 noted that the algorithm used for the evaluation of chlorophyll concentration should be approached as a model with its own accuracy errors which should be considered in data assimilation schemes an example of the estimation of related background and observation error covariance matrices for satellite chlorophyll is presented in ford and barciela 2017 alternatively some applications have demonstrated the feasibility of directly assimilating optical data from ocean colour ciavatta et al 2014 jones et al 2016 shulman et al 2013 thus avoiding the evaluation of the chlorophyll algorithm related error but on the other hand requiring the parameterization of the optical properties of water in the marine ecosystem model several results of a biogeochemical model can benefit from a better description of phytoplankton chlorophyll for example based on the updated and validated representation of the shelf and open sea mediterranean sea chlorophyll we provide an estimate of the phytoplankton primary production these results update the former estimate presented in lazzari et al 2012 and show that primary production in the western mediterranean is mainly located in the open sea whilst in the eastern mediterranean the areas with the highest primary production are mostly located in shelf seas this difference indicates that primary production is mainly related to nutrient flow due to open sea vertical convection in the western mediterranean lavigne et al 2013 lazzari et al 2012 2016 taylor and ferrari 2011 and riverine inputs i e coastal processes in the eastern mediterranean as a final consideration we highlight that dealing with both shelf and open sea data means significantly increasing the range of the variability of observations i e chlorophyll concentration values can range over more than two orders of magnitude thus the observed distribution might be quite far from the gaussian distribution in this case previous studies have proposed the use of the log transformation ford and barciela 2017 song et al 2016b as well as anamorphic transformations doron et al 2013 or particle filtering mattern et al 2013 in the present study we used the natural values of chlorophyll concentration because using log normal values might result in a non optimal solution of the cost function as discussed in teruzzi et al 2014 moreover the non log transformed space is more representative of the vertical dynamics of the vertical operator of background error decomposition and it thus preserves the typical shapes of the modelled chlorophyll profiles observed in the mediterranean sea 5 conclusions we developed and applied a three dimensional variational scheme for the assimilation of satellite chlorophyll observations in coastal waters in order to assimilate both open sea and shelf sea data the data assimilation scheme for coastal waters features a non homogenous vertical component and a non uniform and direction dependent horizontal component of the background error covariance the results show that the data assimilation updates are propagated consistently to the salinity gradient field i e a dynamic property that tracks currents and river inputs providing an improved simulation of the spatial variability and seasonal cycle of chlorophyll concentration in mediterranean coastal waters the use of shelf seas satellite observations of chlorophyll demonstrates the potentiality to improve the quality of the cmems operational biogeochemical products in the mediterranean sea although further research is still needed to improve the forecast also for non assimilated variables acknowledgements we acknowledge v bandelj from ogs and a bruschi from ispra for the support in the processing of the in situ data used for the validation and the reviewers for their valuable comments that helped us to improve the quality of this work we acknowledge the cineca award under the iscra initiative medcoast for the availability of high performance computing resources and support this study has been conducted using e u copernicus marine service information appendix a definition of shelf seas k regions through a k means analysis the v v operator in the shelf mediterranean seas has been constructed introducing a finer spatial subdivision compared to the one proposed for the open sea in teruzzi et al 2014 a k means analysis has been applied to subdivide each of the 10 regions identified in lazzari et al 2012 in the shelf seas the k means analysis aims to partition a set of data x into a predefined number k of clusters such that each data belongs to the cluster with the nearest mean macqueen 1967 operatively the k means analysis provides a set of objects u 1 u k into which each element of the data set x is classified minimizing the sum of the distance of the elements of the data set from the centroid of the cluster a1 m i n i 1 k x u i x c i where x u i are the elements of the data set that are classified into each cluster u i while c i are the centroids of the clusters u i defined as the mean of the elements x u i in our application the elements of the dataset are the mean monthly chlorophyll profiles for all the shelf seas points of a given mediterranean subbasin thus the dimension of an element of x and of the centroids are equal to 12 number of months times the number of chlorophyll profile levels the mean chlorophyll profiles are computed as climatological average from the 1999 2015 cmems reanalysis teruzzi et al 2016 the euclidean distance has been applied for the evaluation of the norm in eq a1 an iterative refinement algorithm available in the scipy python package has been used for the minimization of eq a1 the analysis has been repeated twice using a random initialisation at the first step and the results of the first step as initialisation for the second one for each subbasin the analysis has been repeated using a number of clusters k ranging from two to five considering the high spatial patchiness of the clusters obtained with higher values of k the number of clusters k has been pragmatically chosen equal to two for all the subbasins 
