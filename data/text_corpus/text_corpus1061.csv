index,text
5305,terracing is one of the most important soil and water conservation measures on the chinese loess plateau our understanding of the effects of terraces on soil and water conservation and its mechanism is limited by observation data on runoff and soil erosion as well as the influences from local environmental characteristics in this study we applied a physically based distributed hydrological model integrated hydrology model inhm to an experimental terrace in wangmaogou watershed in the center of the loess plateau which attributed most of the sediment in the yellow river the soil water content were measured at daily scale for one month while the simulations were conducted at second time step our results suggested that terrace construction can substantially reduce runoff by changing the flow direction especially during heavy rainfall events this reduction in runoff would be greatly attenuated when ridges are damaged due to lack of maintenance under the rainfall intensity of 120 mm h compared with hillslope a well maintained terrace could reduce runoff by 100 while the terrace without ridges could only reduce 28 runoff besides ridges not only prevented water from flowing out of platforms but also helped maintain the risers from terrace failure by decreasing about 20 of the saturation rate at the risers our results also emphasized the importance of evapotranspiration which could make up to 15 of the total water loss even during the rainfall events given the effects of terraces on water conservation it is essential for the land use management of the loess plateau to take into account of the terracing approach as well as a good maintenance of ridges keywords terracing ridge saturation rate runoff reduction evapotranspiration 1 introduction the loess plateau of china is known for its severe soil and water loss problems li et al 2009 zuo et al 2016 ye et al 2019 the erosion rate of the loess plateau ranges from 50 to 200 t ha 1 yr 1 zhang et al 2014 with 44 3 contribution to the annual runoff the loess plateau accounts for 4 56 106 t sediment yield every year that is 88 2 of the total sediment yield of the yellow river gao et al 2011 zhao et al 2018 terracing is one of the most important measures implemented to reduce water loss and soil erosion on the loess plateau lv et al 2009 the conversion of hillslopes to terraces can substantially increase the arable land area and contribute to the soil and water conservation goals on the loess plateau arnáez et al 2015 it is necessary to explore the detailed impacts of terracing on hydrological responses field experiments showed that bench terraces and afforestation in shaanxi province on the loess plateau can reduce runoff by 20 and sediment yield by 60 compared to fallow land shi 1996 observations from another hilly loess region demonstrated that level terraces could hold all of the rainfall in the soil without any runoff generation jiao et al 1999 even in southwest china a humid region with high vegetation coverage a reverse slope terrace installed on a natural rainfall experiment plot helped reduce runoff and sediment yield by 65 3 and 80 7 respectively wang et al 2011 there were 37 100 km2 of level terraces by the end of 2012 on the loess plateau ma et al 2015 however field survey indicated that many terraces built during the 1960 s and 1970 s are experiencing ridge damage and terraces collapse due to the lack of maintenance and or land abandonment some of them have even degraded to natural hillslopes after long term rainfall erosion ma et al 2015 although field measurements across the loess plateau suggested that terraces could store 100 200 mm rainfall before runoff generation during rainfall events this effect might be significantly attenuated with ridge damages jiao and wang 1999 despite of the importance of terrace maintenance chen et al 2017 there is little quantitative analysis on the impact of terrace damage on hydrological processes on the loess plateau due to the limitation in observation data arnáez et al 2015 furthermore given the considerable amount of rainfall withheld by terraces water partitioning at terraces would be different from natural hillslopes without generation of runoff more of the precipitation would evaporate or infiltrate into soil it has been long acknowledged that terraces could effectively increase water infiltration at local scale hammad et al 2006 stanchi et al 2012 perlotto and d agostino 2016 moreno de las heras et al 2019 leading to an elevated soil water content swc mesfin et al 2019 observations from terraces in southwestern china showed that besides infiltration terracing could also increase water evapotranspiration wang and wang 2006 considering the extremely dry climate of loess plateau it is necessary to quantify the evapotranspiration loss and its percentage in the overall water partitioning numerical simulation is an effective approach to fill in the gap in field data su 2012 a variety of models have been developed for runoff generation and soil erosion simulations van dijk and bruijnzeel 2004 van dijk et al 2005 heppner et al 2006 shao et al 2013 gregoretti et al 2019 tao et al 2018 empirical models are useful in scientific explorations with little requirement of internal mechanisms especially at large scales ran et al 2008 however since these models are based on regressions derived from empirical observations it is not guaranteed that they can capture the variability across the range of climate and landscape characteristics sivapalan et al 2011 nor could they provide explicit understandings of the detailed processes on the other hand physically based models are more capable to represent various hydrological processes under different cimate and topographic characteristics freeze and harlan 1969 vanderkwaak 1999 su 2012 ran et al 2008 lópez vicente et al 2013 however applications of physically based models on the impact of terraces on the loess plateau are limited due to the difficulty in calibration arnáez et al 2015 most of the hydrological models are calibrated with discharge jones et al 2008 shao et al 2013 xu et al 2013 sun et al 2016 pan et al 2017 yet the discharge is hard to be observed at terraces on the loess plateau due to their effectiveness in water conservation jiao and wang 1999 an alternative way is to calibrate the simulation results with soil water content at different locations and depths doppler et al 2014 many of them were conducted at the vertical profile 2 dimensions lv et al 2009 dong et al 2019 feng et al 2019 as simulations considering both the vertical profile and spatial heterogeneity 3 dimensions has a much higher requirement for model structure and computing resources jodry et al 2019 in this study we analyzed the spatial distribution of measured soil water content in a terrace located on the loess plateau a physically based distributed integrated hydrology model inhm was applied to the terrace to simulate the temporal variability of the spatial distribution of soil water content under different rainfall scenarios inhm was originally developed by vanderkwaak 1999 for the simulation of flow and sediment transport vanderkwaak and loague 2001 loague et al 2005 heppner et al 2006 the model has been applied to small watersheds near our study region to expand our understandings of the runoff and sediment generation processes on the loess plateau ran et al 2019 tang et al 2019 there are similar topographic features terraced crop field in these small watersheds which were represented at similar resolution one meter as in this study that is the model has been applied and validated on a terrace area the goals of this study are to 1 find out the impacts of terrace on soil water distribution and the underlying mechanisms that cause these effects 2 how these effects would be influenced by terrace maintenance condition e g standard terrace with ridges damaged terrace without ridges natural hillslope and 3 how these would impact the overall water partitioning at the terraces 2 study area and data 2 1 study area the study terrace is located at wangmaogou wmg watershed 110 20 26 110 22 46 e 37 34 13 37 36 03 n north of shaanxi province china fig 1 a the watershed is at the center of loess plateau with severe soil erosion issue tang et al 2019 the dominant soil type in wmg is loess a very erodible soil type with particle size less than 0 25 mm fang et al 2008 xu et al 2016 the average topographic gradient is larger than 20 one third of the watershed has gradient greater than 45 hou et al 2007 the climate is semi arid with mean annual precipitation of 513 mm most of which greater than60 falls between july and september xu et al 2017 and appeared in the form of heavy storm li 2014 wu et al 2016 the mean annual potential evaporation is 1519 mm yr while the mean annual actual evaporation is between 300 and 400 mm yr sun 2018 some jujube trees have been planted in the terrace their mean spacing is 3 88 m xu et al 2017 the study terrace has six platforms and six risers marked as p1 p6 for platforms and r1 r6 for risers in fig 1c it is 32 8 m wide and 33 3 m long in projection and the overall elevation difference is 9 7 m for each platform its width and height are different from each other the bottom platform p6 is the widest with the average width of 6 1 m followed by p3 4 9 m p4 4 35 m p2 4 m p5 3 8 m and p1 3 6 m the height of each platform varies between 1 65 m and 1 95 m the slopes of risers increase from top to bottom ranging from 42 r1 to 84 14 r6 the ridges at the edges were 0 15 m higher than the platform 2 2 data description the digital elevation model dem of the terrace was generated by surface water modeling system software sms 10 0 based on coordinates and elevation measured at the field observation points by the south nts 312b electronic total station and laser distance measurer leica disto s910 70 observation points were set on the edges of the terrace with 10 points at each platform the resolution of the 3d finite element meshes of dem generated by sms was one meter the rainfall data and other meteorological variables i e temperature radiation etc used to calculate potential evaporation were measured by hobo weather station one kilometer away from the terrace in wmg every five minutes from 1st august to 31st august 2015 hobo weather station is a multi channel meteorological monitoring device which is capable of monitoring wind speed wind direction temperature humidity atmospheric pressure rainfall amount solar radiation and other meteorological parameters after plugging in corresponding sensor the soil porosity was measured at three depths 0 20 cm 20 40 cm 40 60 cm by zhang et al 2019 we also collected measurements of saturated hydraulic conductivity ks and parameters used in soil moisture characteristic curve α n θr from four nearby terraces in same watershed by tang et al 2019 as reference for our calibration table 1 presented these measurements more detailed description can be found in zhang et al 2019 and tang et al 2019 since the dominant mechanism of runoff generation on the loess plateau is infiltration excess the hydrological processes are more correlated with surface soil soil water content swc were collected at nine depths from 0 2 m to 1 8 m below the surface where the variability is more significant swc was measured by time domain reflectometry tdr trime pico iph ettlingen germany with 20 polycarbonate tubes installed at six platforms fig 1b the tubes were two meters long with diameter of 44 mm the measurements at the bottom of the tube fluctuated much more than the reality only the ones from the top eight depths were used these eight depths are marked as d1 to d8 from top to bottom thus we had 160 20 8 sampling points in total swc was measured late in the morning same time from 10th august to 31st august 2015 at daily scale 3 methodology 3 1 model structure the physically based distributed hydrological model inhm was applied in this study for hydrological simulation at 3 dimensions it was originally developed by vanderkwaak 1999 to simulate water and solute transport at the two dimensional land surface as well as the three dimensional dual continua subsurface it has been applied in nearby watershed of similar characteristics and proved its suitability on the loess plateau ran et al 2019 tang et al 2019 the two dimensional diffusion wave equation and manning s equation are employed to compute surface flow movement while richards equation and darcy s law are used for subsurface simulation the 3d subsurface flow in variably saturated porous medium is simulated by 1 f a q q b q e f v s w t where q m s is darcy flux q b s 1 is a specified rate source sink q e s 1 is the rate of water exchange between the porous medium and surface continua is soil porosity s w is water saturation f a and f v are area fraction and volume fraction associated with each continuum respectively and t s is time the water flow on the land surface is described by 2 φ s mobile q s a s q b a s q e s w s h s φ s store t where φ s mobile m is mobile surface water depth φ s store is stored surface water depth q s m s is surface water velocity a s m is surface coupling length scale s w s is surface saturation and h s m is the average height of surface microtopography actual evapotranspiration et mm d is given by 3 e t et 0 k c s a t where k c is the coefficient for local vegetation in this paper its value is 40 according to the crop coefficients recommended by fao for jujube trees allan et al 1998 sat is soil water saturation the potential evaporation e t 0 mm d in eq 3 is calculated as 4 e t 0 0 408 δ r n g γ 900 t a 273 u 2 e s e a δ γ 1 0 34 u 2 where r n mj m is net radiation at the surface g mj m is the heat flux into subsurface t a c is mean temperature e s kpa and e a kpa are saturation vapor pressure and actual vapor pressure respectively δ kpa c is the slope of saturated vapor pressure curve γ is the psychrometric constant and u 2 m s is the wind speed at two meters height huang and chen 2014 more details of inhm can be found in vanderkwaak 1999 and vanderkwaak and loague 2001 3 2 mesh configuration the configuration of the numerical mesh used in this study was shown in fig 1d since the horton overland flow is the dominant mechanism of runoff generation on the loess plateau the hydrological processes are mainly correlated with the top soil layers previous observations near our study region indicated that characteristics i e saturated hydraulic conductivity of soil below two meters have limited impact on hydrological processes and the soil water content varies little below two meters which was consistent with our measurements jia et al 2017 xu et al 2017 fu et al 2018 ran et al 2019 to capture the potential variability as much as possible we conducted our simulation on the depth of 5 8 m soil with major concentration on the top two meter soil the soil volume was divided into 9 layers at the top 1 8 m corresponding to the sampling depths and 10 layers for the bottom 4 m soil the density of these polycarbonate tubes at each platform is around 30 60 m2 tube within the density range in other studies wang et al 2014 fu et al 2018 zhang et al 2018 zhu et al 2018 li et al 2019 since there was little variance among the polycarbonate tubes at each platform in general to minimize the uncertainties in the measurements the observed data at each depth from each platform were averaged among the polycarbonate tubes for example there are three polycarbonate tubes in p1 the measurements from the three tubes were averaged to get one value at each depth despite of the heterogeneity in the reality each platform was assumed homogeneous horizontally the simulated results were also averaged at each depth 3 3 model set up although there are eight depths in our simulation the bottom five depth from d3 to d8 are grouped with same value assuming the vertical variability in soil below 0 4 m is negligible for our study zone 3 in table 1 since the goal of this study is to investigate how storm events mainly happened from july to september affect the hydrologic response in terraces august was chosen for our observation the first ten days 1st august to 10th august were used as warm up period to generate the soil water content state similar with that on 10th august this was then used as the initial condition for the following simulations the soil water content measured at the 160 nodes from 11st august to 18th august was used for calibration while the validation period was from 19th august to 31st august that is 1280 data points for calibration and 2080 data points for validation which should be sufficient for the purpose of our study lv et al 2009 zhang et al 2018 feng et al 2019 3 4 scenarios except under extreme storm conditions terraces on the loess plateau can effectively trap rainfall and generate little runoff jiao and wang 1999 since most of the precipitation on the loess plateau comes during a few big rainfall events which are also the period with high risk of terrace damage li 2014 wu et al 2016 it is essential to understand the hydrological responses at event scale to fully understand the impacts under different rainfall events we applied eight rainfall scenarios with rainfall intensities ranging from 15 mm h to 120 mm h 15 30 45 60 75 90 105 120 mm h lasting for one hour the return periods of these modelled rainfall events are 0 5 3 5 10 21 38 61 91 and 129 years zhang and wang 1982 note that the 90 mm h rainfall intensity is the most commonly implemented scenario in numerical simulation and rainfall experiments on the loess plateau shi et al 2012 fang et al 2015 the 120 mm h rainfall intensity was chosen as upper limit based on the measurements between 1959 and 1969 as well as the observations reported from the literature han et al 2011 yellow river conservancy commission of the ministry of water resources 2012 ran et al 2018 lin et al 2019 liu et al 2019 given the impact of terrace maintenance condition on runoff generation we applied the eight rainfall scenarios to three topographic forms standard terrace with ridges noted as ty damaged terrace without ridges noted as tn and natural hillslope of the same size noted as s the dem of tn was derived by changing the elevation of nodes representing the risers to make them the same as the platforms in sms 10 0 the dem of s was derived by deleting the nodes in the middle of the top and bottom edges of ty all of the three topography conditions had same projected area as well as the same boundaries and mean gradient 3 5 data analysis three indices were used to analyze the simulated results runoff coefficient rc storage coefficient sc and evapotranspiration coefficient ec they were calculated as 5 r c q t p t 1000 a 100 6 s c δ v p t 1000 a 100 7 e c e t p t 100 where q t m3 is the total amount of runoff at the outlet which is the bottom edge of the study terrace a m2 is the projected area p t mm is rainfall amount e t mm is evapotranspiration amount when runoff stops and δ v m3 is the change in soil water storage one way analysis of variance anova was applied to test the statistical significance of the differences among the soil water contents of six platforms the statistical analysis was conducted by spss statistics 22 0 4 observation and calibration 4 1 measured soil water content fig 2 presented the measured swc at each depth within the six platforms from 10th august to 31st august 2015 as fig 2 showed swc in d1 0 2 m below surface fluctuated most with time followed by d2 the fluctuations at these two depths could be attributed to the strong effect of rainfall and evapotranspiration since they were near the surface of the soil during our observation swc of the top depth d1 was smaller than other depths for all the platforms suggesting strong influence of evapotranspiration the highest swc usually occurred at d3 0 6 m below surface the depth where the soil moisture could be recharged due to the propagation of wetting front while the water loss was small due to limited evapotranspiration impact as a result more soil water accumulated at this depth although there were differences among the six platforms due to factors like vegetation and human activities they were not statistically significant according to the one way anova analysis p value 0 5 4 2 calibration and validation the calibrated soil properties were shown in table 1 the comparison between the observed swc and simulated swc for calibration and validation was shown in fig 3 the model simulations were consistent with the observations during most of the time there was overestimation at the top depth during validation period when the swc was low this overestimation may be attributed to the great disturbance and or human impact at the surface since the overestimated nodes only account for 3 19 624 and our analyses were more focused on the water re distribution during rainfall events when swc was relatively high this overestimation was acceptable for this study fig 4 presented the calibration and validation results at two days as examples of the model performance at a rainy day august 17th and a clear day august 19th as we can see the simulated swc fit the observed data well for most of the cases for the platforms where the swc had large variation in the deep soil i e d5 in p5 the simulated results were not able to capture these fluctuations fig 4 e and k these fluctuations that were not seen in other platforms were likely caused by the heterogeneity in soil properties i e the spatial distribution of macropores which was beyond the scope of our study since our goal was to understand the impact of terrace on the water partitioning in general this discrepancy in swc was acceptable for this study both the observation and model simulation suggested that the top two depths were the ones with most fluctuations in response to rainfall and evapotranspiration therefore our analyses of swc variation would focus on the top two depths in the following sections 5 results 5 1 simulated saturation distribution in terrace to better present the rainfall impacts the scenario with largest rainfall intensity 120 mm h was chosen for our analysis as fig 5 shows all the platforms reached saturation soon after the rainfall began and remained saturated for half hour after the rainfall stopped fig 5a after that the saturation rate started to decrease at the bottom five platforms except the top platform p1 where the saturation lasted over half hour longer than the other platforms this distinctive phenomenon of p1 different from the observations at the ethiopian terraces that soil water content is usually higher at the bottom than that at the top mesfin et al 2019 was because of the saturation rate at the risers fig 5d the top riser r1 the one above p1 was the only riser reached saturation during the rainfall events resulting in leakage from r1 to p1 to maintain the saturation at p1 for an extra half hour with the increase of soil depth the response of soil water content to the rainfall events was further delayed fig 5b c it took longer for the saturation rate to rise at d1 0 2 m below surface once the swc reached saturation the recession started soon after the end of rainfall before the recession at surface fig 5b at d2 the hydrological response was further delayed fig 5c the increase in swc was much less and the swc never reached saturation for soil depth beneath d2 there was nearly no swc change corresponding to the rainfall event that was rainfall in our simulation can hardly affect soil below 0 4 m at event scale unlike the similar saturation level at platforms the risers were more diverse the saturation level decreased from top to bottom the main reason for this phenomenon can be attributed to the declining gradient of the risers from 42 of r1 to 84 of r6 the pearson correlation coefficient between the gradient and the corresponding swc was 0 96 suggesting a negative correlation between the swc and gradient as infiltration decreased with the increase in gradient philip 1991 essig et al 2009 it was more difficult for a steeper slope to be saturated resulting in the declining saturating level form r1 to r6 note that r1 was the only riser that reached saturation besides the much gentler gradient this was likely because of the condition of the platform on top of r1 without ridge at the top of the terrace surface flow from the terrace top could flow down to r1 freely saturating the soil of r1 the impacts of ridges would be discussed in more details in section 6 1 5 2 sensitivity analysis of rainfall intensity our results suggested that when the rainfall intensity was equal to or less than 60 mm h the soil would not be saturated at all and the differences of swc between different platforms were limited and no runoff can be observed at the outlet for brevity we presented the results from the events with intensity larger than 60 mm h to show the horizontal and vertical variability in swc in this section fig 6 showed the saturation rate at the surface of platforms and risers after the rainfall events almost all the platforms were saturated at surface in the three rainfall scenarios the differences were mainly observed at the risers as we can see for each scenario the saturated rate decreased from top to the bottom riser this is consistent with our findings in fig 5d because of the increasing gradient of risers from top to bottom rainfall infiltration decreased leading to the less saturated rate of the risers with the increase in rainfall intensity the saturated area at the risers expanded from the top riser to the bottom one the change in saturation rate at surface and subsurface layers were shown in fig 7 since the swc changed little below 0 4 m fig 5 for the brevity of manuscript only the top two layers 0 0 4 m were presented since the five platforms had similar changes in saturation level fig 5 only the middle platform and riser p4 and r4 were presented here although p1 and r1 were different from the other platforms and risers they were impacted from the absence of ridge on top of terrace the impact of ridges would be discussed in detail in section 6 1 as fig 7 showed with the increase in rainfall intensity the saturation rate rose faster during the rainfall events and declined more slowly after the rainfall stopped the influence of rainfall on the saturation rate decreased vertically this vertical reduction gradient also decreased with intensity when the rainfall intensity was 60 mm h the saturation rate at d2 did not change much after the rainfall that is under the rainfall intensity of 60 mm h the depth of wetting front was less than 0 4 m only the top 0 2 m soil would get saturated from rainfall although the saturation level of r4 increased with rainfall intensity none of them were saturated during the rainfall event fig 7d which meant that no leakage was generated at the risers 5 3 sensitivity analysis of topographic forms due to the lack of effective maintenance many terraces on the loess plateau had been damaged some had even degraded to natural hillslopes ma et al 2015 to explore the influence of degradation degree on water partitioning we applied the most intensive rainfall event 120 mm h to three different topographic organizations standard terrace with ridges ty damaged terrace without ridges tn and terrace that has been degraded to natural hillslope s as seen from fig 8 under the same rainfall it was easier to reach surface saturation in degraded terraces tn and s than the standard terrace ty however the standard terrace could maintain saturation for much longer time at all the platforms than the degraded terraces fig 9 a moreover unlike our expectation the variability in saturation level in damaged terrace without ridges tn was closer to hillslope s than standard terrace ty fig 9 we further investigated the spatial distribution of swc near the ridges at the middle risers r4 as we can see in fig 10 the risers at the standard terrace ty could not reach saturation after rainfall event fig 10a while the surface of the risers at the damaged terrace were saturated after the rainfall fig 10b this difference of the saturation level between ty and tn could be attributed to the change in flow direction caused by ridges fig 11 fig 11a and b presented the decomposed flow vector on the horizontal plane x y axes note that this was not actual flow vector the actual flow vector along the slope of risers including two vectors the horizontal one and the vertical one observation of horizontal flow vector was not necessarily equal to water flow out of the surface of ridges it indicated leakage from risers and or surface flow along the risers as we can see from fig 11a at the standard terrace besides the water flow towards ridges arrows pointing to the left there were water flowing reversely arrows pointing to the right this suggested that the surface flow generated on the platforms were held behind the ridges and were prevented from flowing down to the lower platforms on the contrary at the damaged terrace tn only horizontal flow vectors towards the platform edges were observed at all the platforms and risers fig 11b this suggested that without the ridges surface flow on the platforms could flow down to the lower platforms freely without holdback this difference in water movement at the risers could also be seen in the vertical plane y z axes of the terrace fig 11c d all the soil water flowed downwards inside the riser at standard terrace fig 11c while some of the water flow out of the risers as leakage at damaged terrace fig 11d the flow path sketch also proved this the flow path of soil water in the risers at ty points downwards fig 11e suggesting that all the soil water at the risers flow downwards to the deeper soil while at tn the flow path of the water near the surface points to the surface indicating leakage at risers fig 11f 6 discussion 6 1 impact of ridges on hydrologic connectivity fig 9a presented the much longer saturation period existed in ty which was also found by posthumus and stroosnijder 2010 in the field experiments in peruvian andes our investigations on the flow path within the study terrace figs 10 11 suggested that ridges played a crucial role in this long lasting saturation at ty because of the ridges at ty surface flow generated on each platform could not flow down to the lower platform and the risers could hardly be saturated without the infiltration from these overflows on the other hand surface flow generated on each platform could flow down to the lower one along the risers at tn without any blockage infiltrated the risers making them easier to reach saturation there this effect of ridges on water conservation was consistent with previous discussions of standard terraces with ridges jiao et al 1999 chen et al 2017 by holding the surface flow at the platforms ridges substantially reduced hydrological connectivity across the terrace causing a smaller upslope contributing area and the runoff more effectively lópez vicente et al 2013 this was consistent with calsamiglia s et al 2018 findings that the estimated flow connectivity at damaged terraces without ridges were usually larger than at the standard terraces furthermore without the infiltration of the overflow from platforms it was difficult for risers to get saturated or generate leakage the unsaturated risers could help reduce the risk of landslides on risers and terrace failure jiao and wang 1999 calsamiglia et al 2018 therefore the ridges played an essential role in both runoff reduction and terrace maintenance more attentions should be paid to maintain the ridges for the effectiveness of water conservation 6 2 redistribution of water by terrace at event scale by changing the flow path of surface flow terraces could influence the partitioning of rainfall chen et al 2016 as we can see from fig 12 when the rainfall intensity was smaller than 60 mm h no runoff was generated at three topographic forms fig 12a over 20 of the total rainfall were evaporated while the rest of the rainfall infiltrated to the soil during the events as rainfall intensity increased runoff started to be observed at natural hillslope s and then the damaged terrace tn however the standard terrace ty kept withholding all the rainfall even after the most extreme rainfall event 120 mm h there was still no runoff generation in ty while the runoff coefficient was 30 in s and 20 in tn this was consistent with the observations from the experimental field on the loess plateau jiao et al 1999 jiao and wang 1999 although the damaged terrace tn was not as effective in water conservation as the standard terrace ty it was still more efficient than natural hillslope s xu et al 2011 chen et al 2016 for example when the rainfall intensity was 90 mm h the reduction in runoff was 10 more by tn than by natural hillslope this reduction in runoff by damaged terrace comparing with the natural hillslope did not increase with rainfall intensity while there was still no runoff generation in standard terrace the runoff in damaged terrace and natural hillslope increased synchronously despite the differences in rc there was no significant difference in evapotranspiration coefficient ec among the three topographic scenarios fig 12b ec declined with increase in rainfall intensity for all three topographic scenarios although the terraces could help trap more rainfall than natural hillslope there was little impact on evapotranspiration at event scale most of the trapped rainfall infiltrated to the soil and elevated the soil water content fig 12c this is consistent with the observations by mesfin et al 2019 in their bench terraces in ethiopia note that our analysis was conducted at event scale the ec at annual scale would be much higher as more soil moisture would be evaporated during the dry period zhang et al 2016a b wang et al 2018 therefore the simulation of evapotranspiration on the loess plateau was essential and should be taken into account even during rainfall events pan et al 2016 7 conclusion in this study we applied a physically based distributed hydrological model inhm to a terrace in wangmaogou watershed on the loess plateau and validated it with the measured soil water content our observations indicated that most of the soil water was stored in the top 0 6 m soil the simulated results suggested that besides the well known water conservation effects of platforms chen et al 2016 ridges also played an important role in water conservation as the platforms slow down the flow velocity ridges prevent surface runoff from flowing down to the lower platforms jiao and wang 1999 boubakari and morgan 1999 without the surface flow over the risers it is more difficult for risers to be saturated as a result the runoff erosion is substantially reduced without the surface overflow along the platforms and the less saturated ridges protect them from collapse together they help maintain the terraces this advantage of ridges became more significant with the increase in rainfall intensity as the rainfall intensity increased from 30 mm h to 120 mm h ty keeps withholding all of the rainfall while the runoff coefficient in tn increased from 0 to 21 29 in natural hillslope moreover evapotranspiration also plays an important role in water partitioning at terraces even during rainfall event it can take up to 15 of the total rainfall which could make up a significant amount of rainfall at annual scale according to national ecological environment construction plan of china 21 516 km2 of new terraces will be built in the yellow river basin from 2012 to 2020 yellow river conservancy commission of the ministry of water resources 2013 meanwhile 25 of the existing terraces are facing severe damages due to the lack of maintenance i e ridge collapse ma et al 2015 given the essential role of ridges in terrace water conservation it is important to protect the terraces and reinforce the damaged ones our results could provide useful guidance for the development and maintenance of terraces on the loess plateau of china future analyses of terrace s impact on soil erosion and sediment transport should be considered to better construct the sediment budget and land use management on the loess plateau long term measurements of swc and annual scale simulation at larger watershed scale would also be useful to help further explore the redistribution of water and sediment by terraces and provide valuable support for water and soil management on the loess plateau credit authorship contribution statement qihua ran conceptualization software supervision funding acquisition xiuxiu chen formal analysis investigation validation yanyan hong visualization sheng ye data curation writing review editing project administration jihui gao methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was financially supported by the national key research and development program of china 2016yfc0402400 04 04 2018yfc0407401 04 and the national natural science foundation of china 51509218 51679209 
5305,terracing is one of the most important soil and water conservation measures on the chinese loess plateau our understanding of the effects of terraces on soil and water conservation and its mechanism is limited by observation data on runoff and soil erosion as well as the influences from local environmental characteristics in this study we applied a physically based distributed hydrological model integrated hydrology model inhm to an experimental terrace in wangmaogou watershed in the center of the loess plateau which attributed most of the sediment in the yellow river the soil water content were measured at daily scale for one month while the simulations were conducted at second time step our results suggested that terrace construction can substantially reduce runoff by changing the flow direction especially during heavy rainfall events this reduction in runoff would be greatly attenuated when ridges are damaged due to lack of maintenance under the rainfall intensity of 120 mm h compared with hillslope a well maintained terrace could reduce runoff by 100 while the terrace without ridges could only reduce 28 runoff besides ridges not only prevented water from flowing out of platforms but also helped maintain the risers from terrace failure by decreasing about 20 of the saturation rate at the risers our results also emphasized the importance of evapotranspiration which could make up to 15 of the total water loss even during the rainfall events given the effects of terraces on water conservation it is essential for the land use management of the loess plateau to take into account of the terracing approach as well as a good maintenance of ridges keywords terracing ridge saturation rate runoff reduction evapotranspiration 1 introduction the loess plateau of china is known for its severe soil and water loss problems li et al 2009 zuo et al 2016 ye et al 2019 the erosion rate of the loess plateau ranges from 50 to 200 t ha 1 yr 1 zhang et al 2014 with 44 3 contribution to the annual runoff the loess plateau accounts for 4 56 106 t sediment yield every year that is 88 2 of the total sediment yield of the yellow river gao et al 2011 zhao et al 2018 terracing is one of the most important measures implemented to reduce water loss and soil erosion on the loess plateau lv et al 2009 the conversion of hillslopes to terraces can substantially increase the arable land area and contribute to the soil and water conservation goals on the loess plateau arnáez et al 2015 it is necessary to explore the detailed impacts of terracing on hydrological responses field experiments showed that bench terraces and afforestation in shaanxi province on the loess plateau can reduce runoff by 20 and sediment yield by 60 compared to fallow land shi 1996 observations from another hilly loess region demonstrated that level terraces could hold all of the rainfall in the soil without any runoff generation jiao et al 1999 even in southwest china a humid region with high vegetation coverage a reverse slope terrace installed on a natural rainfall experiment plot helped reduce runoff and sediment yield by 65 3 and 80 7 respectively wang et al 2011 there were 37 100 km2 of level terraces by the end of 2012 on the loess plateau ma et al 2015 however field survey indicated that many terraces built during the 1960 s and 1970 s are experiencing ridge damage and terraces collapse due to the lack of maintenance and or land abandonment some of them have even degraded to natural hillslopes after long term rainfall erosion ma et al 2015 although field measurements across the loess plateau suggested that terraces could store 100 200 mm rainfall before runoff generation during rainfall events this effect might be significantly attenuated with ridge damages jiao and wang 1999 despite of the importance of terrace maintenance chen et al 2017 there is little quantitative analysis on the impact of terrace damage on hydrological processes on the loess plateau due to the limitation in observation data arnáez et al 2015 furthermore given the considerable amount of rainfall withheld by terraces water partitioning at terraces would be different from natural hillslopes without generation of runoff more of the precipitation would evaporate or infiltrate into soil it has been long acknowledged that terraces could effectively increase water infiltration at local scale hammad et al 2006 stanchi et al 2012 perlotto and d agostino 2016 moreno de las heras et al 2019 leading to an elevated soil water content swc mesfin et al 2019 observations from terraces in southwestern china showed that besides infiltration terracing could also increase water evapotranspiration wang and wang 2006 considering the extremely dry climate of loess plateau it is necessary to quantify the evapotranspiration loss and its percentage in the overall water partitioning numerical simulation is an effective approach to fill in the gap in field data su 2012 a variety of models have been developed for runoff generation and soil erosion simulations van dijk and bruijnzeel 2004 van dijk et al 2005 heppner et al 2006 shao et al 2013 gregoretti et al 2019 tao et al 2018 empirical models are useful in scientific explorations with little requirement of internal mechanisms especially at large scales ran et al 2008 however since these models are based on regressions derived from empirical observations it is not guaranteed that they can capture the variability across the range of climate and landscape characteristics sivapalan et al 2011 nor could they provide explicit understandings of the detailed processes on the other hand physically based models are more capable to represent various hydrological processes under different cimate and topographic characteristics freeze and harlan 1969 vanderkwaak 1999 su 2012 ran et al 2008 lópez vicente et al 2013 however applications of physically based models on the impact of terraces on the loess plateau are limited due to the difficulty in calibration arnáez et al 2015 most of the hydrological models are calibrated with discharge jones et al 2008 shao et al 2013 xu et al 2013 sun et al 2016 pan et al 2017 yet the discharge is hard to be observed at terraces on the loess plateau due to their effectiveness in water conservation jiao and wang 1999 an alternative way is to calibrate the simulation results with soil water content at different locations and depths doppler et al 2014 many of them were conducted at the vertical profile 2 dimensions lv et al 2009 dong et al 2019 feng et al 2019 as simulations considering both the vertical profile and spatial heterogeneity 3 dimensions has a much higher requirement for model structure and computing resources jodry et al 2019 in this study we analyzed the spatial distribution of measured soil water content in a terrace located on the loess plateau a physically based distributed integrated hydrology model inhm was applied to the terrace to simulate the temporal variability of the spatial distribution of soil water content under different rainfall scenarios inhm was originally developed by vanderkwaak 1999 for the simulation of flow and sediment transport vanderkwaak and loague 2001 loague et al 2005 heppner et al 2006 the model has been applied to small watersheds near our study region to expand our understandings of the runoff and sediment generation processes on the loess plateau ran et al 2019 tang et al 2019 there are similar topographic features terraced crop field in these small watersheds which were represented at similar resolution one meter as in this study that is the model has been applied and validated on a terrace area the goals of this study are to 1 find out the impacts of terrace on soil water distribution and the underlying mechanisms that cause these effects 2 how these effects would be influenced by terrace maintenance condition e g standard terrace with ridges damaged terrace without ridges natural hillslope and 3 how these would impact the overall water partitioning at the terraces 2 study area and data 2 1 study area the study terrace is located at wangmaogou wmg watershed 110 20 26 110 22 46 e 37 34 13 37 36 03 n north of shaanxi province china fig 1 a the watershed is at the center of loess plateau with severe soil erosion issue tang et al 2019 the dominant soil type in wmg is loess a very erodible soil type with particle size less than 0 25 mm fang et al 2008 xu et al 2016 the average topographic gradient is larger than 20 one third of the watershed has gradient greater than 45 hou et al 2007 the climate is semi arid with mean annual precipitation of 513 mm most of which greater than60 falls between july and september xu et al 2017 and appeared in the form of heavy storm li 2014 wu et al 2016 the mean annual potential evaporation is 1519 mm yr while the mean annual actual evaporation is between 300 and 400 mm yr sun 2018 some jujube trees have been planted in the terrace their mean spacing is 3 88 m xu et al 2017 the study terrace has six platforms and six risers marked as p1 p6 for platforms and r1 r6 for risers in fig 1c it is 32 8 m wide and 33 3 m long in projection and the overall elevation difference is 9 7 m for each platform its width and height are different from each other the bottom platform p6 is the widest with the average width of 6 1 m followed by p3 4 9 m p4 4 35 m p2 4 m p5 3 8 m and p1 3 6 m the height of each platform varies between 1 65 m and 1 95 m the slopes of risers increase from top to bottom ranging from 42 r1 to 84 14 r6 the ridges at the edges were 0 15 m higher than the platform 2 2 data description the digital elevation model dem of the terrace was generated by surface water modeling system software sms 10 0 based on coordinates and elevation measured at the field observation points by the south nts 312b electronic total station and laser distance measurer leica disto s910 70 observation points were set on the edges of the terrace with 10 points at each platform the resolution of the 3d finite element meshes of dem generated by sms was one meter the rainfall data and other meteorological variables i e temperature radiation etc used to calculate potential evaporation were measured by hobo weather station one kilometer away from the terrace in wmg every five minutes from 1st august to 31st august 2015 hobo weather station is a multi channel meteorological monitoring device which is capable of monitoring wind speed wind direction temperature humidity atmospheric pressure rainfall amount solar radiation and other meteorological parameters after plugging in corresponding sensor the soil porosity was measured at three depths 0 20 cm 20 40 cm 40 60 cm by zhang et al 2019 we also collected measurements of saturated hydraulic conductivity ks and parameters used in soil moisture characteristic curve α n θr from four nearby terraces in same watershed by tang et al 2019 as reference for our calibration table 1 presented these measurements more detailed description can be found in zhang et al 2019 and tang et al 2019 since the dominant mechanism of runoff generation on the loess plateau is infiltration excess the hydrological processes are more correlated with surface soil soil water content swc were collected at nine depths from 0 2 m to 1 8 m below the surface where the variability is more significant swc was measured by time domain reflectometry tdr trime pico iph ettlingen germany with 20 polycarbonate tubes installed at six platforms fig 1b the tubes were two meters long with diameter of 44 mm the measurements at the bottom of the tube fluctuated much more than the reality only the ones from the top eight depths were used these eight depths are marked as d1 to d8 from top to bottom thus we had 160 20 8 sampling points in total swc was measured late in the morning same time from 10th august to 31st august 2015 at daily scale 3 methodology 3 1 model structure the physically based distributed hydrological model inhm was applied in this study for hydrological simulation at 3 dimensions it was originally developed by vanderkwaak 1999 to simulate water and solute transport at the two dimensional land surface as well as the three dimensional dual continua subsurface it has been applied in nearby watershed of similar characteristics and proved its suitability on the loess plateau ran et al 2019 tang et al 2019 the two dimensional diffusion wave equation and manning s equation are employed to compute surface flow movement while richards equation and darcy s law are used for subsurface simulation the 3d subsurface flow in variably saturated porous medium is simulated by 1 f a q q b q e f v s w t where q m s is darcy flux q b s 1 is a specified rate source sink q e s 1 is the rate of water exchange between the porous medium and surface continua is soil porosity s w is water saturation f a and f v are area fraction and volume fraction associated with each continuum respectively and t s is time the water flow on the land surface is described by 2 φ s mobile q s a s q b a s q e s w s h s φ s store t where φ s mobile m is mobile surface water depth φ s store is stored surface water depth q s m s is surface water velocity a s m is surface coupling length scale s w s is surface saturation and h s m is the average height of surface microtopography actual evapotranspiration et mm d is given by 3 e t et 0 k c s a t where k c is the coefficient for local vegetation in this paper its value is 40 according to the crop coefficients recommended by fao for jujube trees allan et al 1998 sat is soil water saturation the potential evaporation e t 0 mm d in eq 3 is calculated as 4 e t 0 0 408 δ r n g γ 900 t a 273 u 2 e s e a δ γ 1 0 34 u 2 where r n mj m is net radiation at the surface g mj m is the heat flux into subsurface t a c is mean temperature e s kpa and e a kpa are saturation vapor pressure and actual vapor pressure respectively δ kpa c is the slope of saturated vapor pressure curve γ is the psychrometric constant and u 2 m s is the wind speed at two meters height huang and chen 2014 more details of inhm can be found in vanderkwaak 1999 and vanderkwaak and loague 2001 3 2 mesh configuration the configuration of the numerical mesh used in this study was shown in fig 1d since the horton overland flow is the dominant mechanism of runoff generation on the loess plateau the hydrological processes are mainly correlated with the top soil layers previous observations near our study region indicated that characteristics i e saturated hydraulic conductivity of soil below two meters have limited impact on hydrological processes and the soil water content varies little below two meters which was consistent with our measurements jia et al 2017 xu et al 2017 fu et al 2018 ran et al 2019 to capture the potential variability as much as possible we conducted our simulation on the depth of 5 8 m soil with major concentration on the top two meter soil the soil volume was divided into 9 layers at the top 1 8 m corresponding to the sampling depths and 10 layers for the bottom 4 m soil the density of these polycarbonate tubes at each platform is around 30 60 m2 tube within the density range in other studies wang et al 2014 fu et al 2018 zhang et al 2018 zhu et al 2018 li et al 2019 since there was little variance among the polycarbonate tubes at each platform in general to minimize the uncertainties in the measurements the observed data at each depth from each platform were averaged among the polycarbonate tubes for example there are three polycarbonate tubes in p1 the measurements from the three tubes were averaged to get one value at each depth despite of the heterogeneity in the reality each platform was assumed homogeneous horizontally the simulated results were also averaged at each depth 3 3 model set up although there are eight depths in our simulation the bottom five depth from d3 to d8 are grouped with same value assuming the vertical variability in soil below 0 4 m is negligible for our study zone 3 in table 1 since the goal of this study is to investigate how storm events mainly happened from july to september affect the hydrologic response in terraces august was chosen for our observation the first ten days 1st august to 10th august were used as warm up period to generate the soil water content state similar with that on 10th august this was then used as the initial condition for the following simulations the soil water content measured at the 160 nodes from 11st august to 18th august was used for calibration while the validation period was from 19th august to 31st august that is 1280 data points for calibration and 2080 data points for validation which should be sufficient for the purpose of our study lv et al 2009 zhang et al 2018 feng et al 2019 3 4 scenarios except under extreme storm conditions terraces on the loess plateau can effectively trap rainfall and generate little runoff jiao and wang 1999 since most of the precipitation on the loess plateau comes during a few big rainfall events which are also the period with high risk of terrace damage li 2014 wu et al 2016 it is essential to understand the hydrological responses at event scale to fully understand the impacts under different rainfall events we applied eight rainfall scenarios with rainfall intensities ranging from 15 mm h to 120 mm h 15 30 45 60 75 90 105 120 mm h lasting for one hour the return periods of these modelled rainfall events are 0 5 3 5 10 21 38 61 91 and 129 years zhang and wang 1982 note that the 90 mm h rainfall intensity is the most commonly implemented scenario in numerical simulation and rainfall experiments on the loess plateau shi et al 2012 fang et al 2015 the 120 mm h rainfall intensity was chosen as upper limit based on the measurements between 1959 and 1969 as well as the observations reported from the literature han et al 2011 yellow river conservancy commission of the ministry of water resources 2012 ran et al 2018 lin et al 2019 liu et al 2019 given the impact of terrace maintenance condition on runoff generation we applied the eight rainfall scenarios to three topographic forms standard terrace with ridges noted as ty damaged terrace without ridges noted as tn and natural hillslope of the same size noted as s the dem of tn was derived by changing the elevation of nodes representing the risers to make them the same as the platforms in sms 10 0 the dem of s was derived by deleting the nodes in the middle of the top and bottom edges of ty all of the three topography conditions had same projected area as well as the same boundaries and mean gradient 3 5 data analysis three indices were used to analyze the simulated results runoff coefficient rc storage coefficient sc and evapotranspiration coefficient ec they were calculated as 5 r c q t p t 1000 a 100 6 s c δ v p t 1000 a 100 7 e c e t p t 100 where q t m3 is the total amount of runoff at the outlet which is the bottom edge of the study terrace a m2 is the projected area p t mm is rainfall amount e t mm is evapotranspiration amount when runoff stops and δ v m3 is the change in soil water storage one way analysis of variance anova was applied to test the statistical significance of the differences among the soil water contents of six platforms the statistical analysis was conducted by spss statistics 22 0 4 observation and calibration 4 1 measured soil water content fig 2 presented the measured swc at each depth within the six platforms from 10th august to 31st august 2015 as fig 2 showed swc in d1 0 2 m below surface fluctuated most with time followed by d2 the fluctuations at these two depths could be attributed to the strong effect of rainfall and evapotranspiration since they were near the surface of the soil during our observation swc of the top depth d1 was smaller than other depths for all the platforms suggesting strong influence of evapotranspiration the highest swc usually occurred at d3 0 6 m below surface the depth where the soil moisture could be recharged due to the propagation of wetting front while the water loss was small due to limited evapotranspiration impact as a result more soil water accumulated at this depth although there were differences among the six platforms due to factors like vegetation and human activities they were not statistically significant according to the one way anova analysis p value 0 5 4 2 calibration and validation the calibrated soil properties were shown in table 1 the comparison between the observed swc and simulated swc for calibration and validation was shown in fig 3 the model simulations were consistent with the observations during most of the time there was overestimation at the top depth during validation period when the swc was low this overestimation may be attributed to the great disturbance and or human impact at the surface since the overestimated nodes only account for 3 19 624 and our analyses were more focused on the water re distribution during rainfall events when swc was relatively high this overestimation was acceptable for this study fig 4 presented the calibration and validation results at two days as examples of the model performance at a rainy day august 17th and a clear day august 19th as we can see the simulated swc fit the observed data well for most of the cases for the platforms where the swc had large variation in the deep soil i e d5 in p5 the simulated results were not able to capture these fluctuations fig 4 e and k these fluctuations that were not seen in other platforms were likely caused by the heterogeneity in soil properties i e the spatial distribution of macropores which was beyond the scope of our study since our goal was to understand the impact of terrace on the water partitioning in general this discrepancy in swc was acceptable for this study both the observation and model simulation suggested that the top two depths were the ones with most fluctuations in response to rainfall and evapotranspiration therefore our analyses of swc variation would focus on the top two depths in the following sections 5 results 5 1 simulated saturation distribution in terrace to better present the rainfall impacts the scenario with largest rainfall intensity 120 mm h was chosen for our analysis as fig 5 shows all the platforms reached saturation soon after the rainfall began and remained saturated for half hour after the rainfall stopped fig 5a after that the saturation rate started to decrease at the bottom five platforms except the top platform p1 where the saturation lasted over half hour longer than the other platforms this distinctive phenomenon of p1 different from the observations at the ethiopian terraces that soil water content is usually higher at the bottom than that at the top mesfin et al 2019 was because of the saturation rate at the risers fig 5d the top riser r1 the one above p1 was the only riser reached saturation during the rainfall events resulting in leakage from r1 to p1 to maintain the saturation at p1 for an extra half hour with the increase of soil depth the response of soil water content to the rainfall events was further delayed fig 5b c it took longer for the saturation rate to rise at d1 0 2 m below surface once the swc reached saturation the recession started soon after the end of rainfall before the recession at surface fig 5b at d2 the hydrological response was further delayed fig 5c the increase in swc was much less and the swc never reached saturation for soil depth beneath d2 there was nearly no swc change corresponding to the rainfall event that was rainfall in our simulation can hardly affect soil below 0 4 m at event scale unlike the similar saturation level at platforms the risers were more diverse the saturation level decreased from top to bottom the main reason for this phenomenon can be attributed to the declining gradient of the risers from 42 of r1 to 84 of r6 the pearson correlation coefficient between the gradient and the corresponding swc was 0 96 suggesting a negative correlation between the swc and gradient as infiltration decreased with the increase in gradient philip 1991 essig et al 2009 it was more difficult for a steeper slope to be saturated resulting in the declining saturating level form r1 to r6 note that r1 was the only riser that reached saturation besides the much gentler gradient this was likely because of the condition of the platform on top of r1 without ridge at the top of the terrace surface flow from the terrace top could flow down to r1 freely saturating the soil of r1 the impacts of ridges would be discussed in more details in section 6 1 5 2 sensitivity analysis of rainfall intensity our results suggested that when the rainfall intensity was equal to or less than 60 mm h the soil would not be saturated at all and the differences of swc between different platforms were limited and no runoff can be observed at the outlet for brevity we presented the results from the events with intensity larger than 60 mm h to show the horizontal and vertical variability in swc in this section fig 6 showed the saturation rate at the surface of platforms and risers after the rainfall events almost all the platforms were saturated at surface in the three rainfall scenarios the differences were mainly observed at the risers as we can see for each scenario the saturated rate decreased from top to the bottom riser this is consistent with our findings in fig 5d because of the increasing gradient of risers from top to bottom rainfall infiltration decreased leading to the less saturated rate of the risers with the increase in rainfall intensity the saturated area at the risers expanded from the top riser to the bottom one the change in saturation rate at surface and subsurface layers were shown in fig 7 since the swc changed little below 0 4 m fig 5 for the brevity of manuscript only the top two layers 0 0 4 m were presented since the five platforms had similar changes in saturation level fig 5 only the middle platform and riser p4 and r4 were presented here although p1 and r1 were different from the other platforms and risers they were impacted from the absence of ridge on top of terrace the impact of ridges would be discussed in detail in section 6 1 as fig 7 showed with the increase in rainfall intensity the saturation rate rose faster during the rainfall events and declined more slowly after the rainfall stopped the influence of rainfall on the saturation rate decreased vertically this vertical reduction gradient also decreased with intensity when the rainfall intensity was 60 mm h the saturation rate at d2 did not change much after the rainfall that is under the rainfall intensity of 60 mm h the depth of wetting front was less than 0 4 m only the top 0 2 m soil would get saturated from rainfall although the saturation level of r4 increased with rainfall intensity none of them were saturated during the rainfall event fig 7d which meant that no leakage was generated at the risers 5 3 sensitivity analysis of topographic forms due to the lack of effective maintenance many terraces on the loess plateau had been damaged some had even degraded to natural hillslopes ma et al 2015 to explore the influence of degradation degree on water partitioning we applied the most intensive rainfall event 120 mm h to three different topographic organizations standard terrace with ridges ty damaged terrace without ridges tn and terrace that has been degraded to natural hillslope s as seen from fig 8 under the same rainfall it was easier to reach surface saturation in degraded terraces tn and s than the standard terrace ty however the standard terrace could maintain saturation for much longer time at all the platforms than the degraded terraces fig 9 a moreover unlike our expectation the variability in saturation level in damaged terrace without ridges tn was closer to hillslope s than standard terrace ty fig 9 we further investigated the spatial distribution of swc near the ridges at the middle risers r4 as we can see in fig 10 the risers at the standard terrace ty could not reach saturation after rainfall event fig 10a while the surface of the risers at the damaged terrace were saturated after the rainfall fig 10b this difference of the saturation level between ty and tn could be attributed to the change in flow direction caused by ridges fig 11 fig 11a and b presented the decomposed flow vector on the horizontal plane x y axes note that this was not actual flow vector the actual flow vector along the slope of risers including two vectors the horizontal one and the vertical one observation of horizontal flow vector was not necessarily equal to water flow out of the surface of ridges it indicated leakage from risers and or surface flow along the risers as we can see from fig 11a at the standard terrace besides the water flow towards ridges arrows pointing to the left there were water flowing reversely arrows pointing to the right this suggested that the surface flow generated on the platforms were held behind the ridges and were prevented from flowing down to the lower platforms on the contrary at the damaged terrace tn only horizontal flow vectors towards the platform edges were observed at all the platforms and risers fig 11b this suggested that without the ridges surface flow on the platforms could flow down to the lower platforms freely without holdback this difference in water movement at the risers could also be seen in the vertical plane y z axes of the terrace fig 11c d all the soil water flowed downwards inside the riser at standard terrace fig 11c while some of the water flow out of the risers as leakage at damaged terrace fig 11d the flow path sketch also proved this the flow path of soil water in the risers at ty points downwards fig 11e suggesting that all the soil water at the risers flow downwards to the deeper soil while at tn the flow path of the water near the surface points to the surface indicating leakage at risers fig 11f 6 discussion 6 1 impact of ridges on hydrologic connectivity fig 9a presented the much longer saturation period existed in ty which was also found by posthumus and stroosnijder 2010 in the field experiments in peruvian andes our investigations on the flow path within the study terrace figs 10 11 suggested that ridges played a crucial role in this long lasting saturation at ty because of the ridges at ty surface flow generated on each platform could not flow down to the lower platform and the risers could hardly be saturated without the infiltration from these overflows on the other hand surface flow generated on each platform could flow down to the lower one along the risers at tn without any blockage infiltrated the risers making them easier to reach saturation there this effect of ridges on water conservation was consistent with previous discussions of standard terraces with ridges jiao et al 1999 chen et al 2017 by holding the surface flow at the platforms ridges substantially reduced hydrological connectivity across the terrace causing a smaller upslope contributing area and the runoff more effectively lópez vicente et al 2013 this was consistent with calsamiglia s et al 2018 findings that the estimated flow connectivity at damaged terraces without ridges were usually larger than at the standard terraces furthermore without the infiltration of the overflow from platforms it was difficult for risers to get saturated or generate leakage the unsaturated risers could help reduce the risk of landslides on risers and terrace failure jiao and wang 1999 calsamiglia et al 2018 therefore the ridges played an essential role in both runoff reduction and terrace maintenance more attentions should be paid to maintain the ridges for the effectiveness of water conservation 6 2 redistribution of water by terrace at event scale by changing the flow path of surface flow terraces could influence the partitioning of rainfall chen et al 2016 as we can see from fig 12 when the rainfall intensity was smaller than 60 mm h no runoff was generated at three topographic forms fig 12a over 20 of the total rainfall were evaporated while the rest of the rainfall infiltrated to the soil during the events as rainfall intensity increased runoff started to be observed at natural hillslope s and then the damaged terrace tn however the standard terrace ty kept withholding all the rainfall even after the most extreme rainfall event 120 mm h there was still no runoff generation in ty while the runoff coefficient was 30 in s and 20 in tn this was consistent with the observations from the experimental field on the loess plateau jiao et al 1999 jiao and wang 1999 although the damaged terrace tn was not as effective in water conservation as the standard terrace ty it was still more efficient than natural hillslope s xu et al 2011 chen et al 2016 for example when the rainfall intensity was 90 mm h the reduction in runoff was 10 more by tn than by natural hillslope this reduction in runoff by damaged terrace comparing with the natural hillslope did not increase with rainfall intensity while there was still no runoff generation in standard terrace the runoff in damaged terrace and natural hillslope increased synchronously despite the differences in rc there was no significant difference in evapotranspiration coefficient ec among the three topographic scenarios fig 12b ec declined with increase in rainfall intensity for all three topographic scenarios although the terraces could help trap more rainfall than natural hillslope there was little impact on evapotranspiration at event scale most of the trapped rainfall infiltrated to the soil and elevated the soil water content fig 12c this is consistent with the observations by mesfin et al 2019 in their bench terraces in ethiopia note that our analysis was conducted at event scale the ec at annual scale would be much higher as more soil moisture would be evaporated during the dry period zhang et al 2016a b wang et al 2018 therefore the simulation of evapotranspiration on the loess plateau was essential and should be taken into account even during rainfall events pan et al 2016 7 conclusion in this study we applied a physically based distributed hydrological model inhm to a terrace in wangmaogou watershed on the loess plateau and validated it with the measured soil water content our observations indicated that most of the soil water was stored in the top 0 6 m soil the simulated results suggested that besides the well known water conservation effects of platforms chen et al 2016 ridges also played an important role in water conservation as the platforms slow down the flow velocity ridges prevent surface runoff from flowing down to the lower platforms jiao and wang 1999 boubakari and morgan 1999 without the surface flow over the risers it is more difficult for risers to be saturated as a result the runoff erosion is substantially reduced without the surface overflow along the platforms and the less saturated ridges protect them from collapse together they help maintain the terraces this advantage of ridges became more significant with the increase in rainfall intensity as the rainfall intensity increased from 30 mm h to 120 mm h ty keeps withholding all of the rainfall while the runoff coefficient in tn increased from 0 to 21 29 in natural hillslope moreover evapotranspiration also plays an important role in water partitioning at terraces even during rainfall event it can take up to 15 of the total rainfall which could make up a significant amount of rainfall at annual scale according to national ecological environment construction plan of china 21 516 km2 of new terraces will be built in the yellow river basin from 2012 to 2020 yellow river conservancy commission of the ministry of water resources 2013 meanwhile 25 of the existing terraces are facing severe damages due to the lack of maintenance i e ridge collapse ma et al 2015 given the essential role of ridges in terrace water conservation it is important to protect the terraces and reinforce the damaged ones our results could provide useful guidance for the development and maintenance of terraces on the loess plateau of china future analyses of terrace s impact on soil erosion and sediment transport should be considered to better construct the sediment budget and land use management on the loess plateau long term measurements of swc and annual scale simulation at larger watershed scale would also be useful to help further explore the redistribution of water and sediment by terraces and provide valuable support for water and soil management on the loess plateau credit authorship contribution statement qihua ran conceptualization software supervision funding acquisition xiuxiu chen formal analysis investigation validation yanyan hong visualization sheng ye data curation writing review editing project administration jihui gao methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was financially supported by the national key research and development program of china 2016yfc0402400 04 04 2018yfc0407401 04 and the national natural science foundation of china 51509218 51679209 
5306,to monitor the complex interdependency between soil moisture and productivity of douglas fir forests in the pacific northwest a dense low cost network of soil moisture sensors was installed in association with 33 forest vegetation plots in a single 2260 ha watershed in western oregon four sensors were installed in each plot to record volumetric soil water content and soil temperature 5 and 50 cm below the surface of mineral soil at 2 hr intervals from 2012 through 2018 significant data gaps restricted the full utilization of the resulting dataset summarized as daily averages a self organizing map neural network was applied to find clusters of plots with similar functional dependencies of soil temperature and soil moisture values the results guided the subsequent assignment of the most suitable time series as input for plot specific distributed time delay neural networks that were trained to simulate the time series of volumetric water content in the two soil depths at 33 locations in addition to contemporaneous inputs used in conventional neural networks the application of distributed time delay neural networks allows the incorporation of prior sections of the input time series data the results show the high performance of the combined machine learning approaches that capitalize on the spatial data richness of the dense monitoring network the correlation coefficient for the test data subsets averages 0 95 and the mean error equals 0 04 cm3 cm3 the correlation between time series at various plots was retained for the modeled data a cross comparison of the data revealed that 81 of the 5 cm soil moisture data and 95 of the 50 cm soil moisture data show less than 10 difference between the coefficients of determination prior to and after the gap filling procedure the long term gap filled soil moisture extremes correspond well with a high resolution palmer drought severity index calculated for the area keywords machine learning drought index forest hydrology volumetric soil water content distributed time delay neural networks soil moisture monitoring 1 introduction soil water availability is a major determinant of the productivity of douglas fir forests in western oregon particularly during the latter part of the growing season emmingham and waring 1977 waring et al 2008 when drawdown of soil water is further exacerbated by high vapor pressure deficits waring and franklin 1979 landsberg and sands 2011 in addition future climate change scenarios predict its increasing influence as soil water in this region is expected to be more limiting during hotter and drier summers drought and heat induced plant stress reduced productivity and elevated mortality has hit western north american ecosystems in recent years leading to great concern about the future extent and composition of these forests e g reilly and spies 2016 the spatial coverage and intensity of these stress events are likely to worsen in the future due to more frequent and more intense droughts enhanced summer droughts are expected in almost all areas of western north america as snow packs decline and melt earlier this change is expected to hasten the start of the growing season and as plants use up available soil water they will become water stressed earlier in the season most likely decreasing plant productivity in the long term e g restaino et al 2016 littke et al 2018 douglas fir forests in oregon are predicted to suffer from these progressive temperature and soil moisture limitations due to climate change beedlow et al 2013 furthermore the severity of wildfires is highly correlated to soil water availability which makes the accurate assessment in densely forested areas particularly important e g bourgeau chavez et al 2007 parks et al 2016 in an effort to understand the relationships between seasonal soil water availability stand growth and response to silvicultural treatment such as fertilization the center for intensive planted forest silviculture cips and the stand management cooperative smc installed soil moisture and soil temperature sensors at 5 cm and 50 cm depths into mineral soil on a number of different fertilization trials littke et al 2014 similar moisture and temperature monitoring sites were installed in association with soil pits intensively characterized by the natural resources conservation service nrcs within the panther creek blm lidar study area in western oregon the objective was similarly to gain an understanding of the relationships between available water holding capacity of the soil awhc diurnal and seasonal trends in evapotranspiration concurrent local weather conditions and local forest productivity rodman 2016 soil moisture data were collected at a total of 33 sites in the panther creek study area using low cost instruments from early 2012 through fall 2018 providing a spatially dense representation of the soil moisture conditions however as often happens with low cost equipment under field conditions data gaps resulted from sensor and data logger failures in addition to animal damage and vandalism as a result most of the time series contain continuous periods of missing data ranging from 4 days to over 3 years thus the objective of the modeling efforts presented in this study was to develop and apply a tailored combination of machine learning approaches to reliably fill in data gaps and improve the continuity and utility of the soil moisture data collected due to its importance for estimating evapotranspiration rates and for modeling the carbon cycle several past efforts have been undertaken to reliably model relationships among variables and fill data gaps in soil moisture datasets approaches have been pursued using satellite observations wang et al 2012 models based on soil properties saxton and rawls 2006 and various statistical models including evolutionary polynomial regression and conventional neural networks kornelsen and coulibaly 2014 these studies show that particular methods work well under a specific but narrow set of conditions but that no universally superior approach to fill data gaps has been found underscoring the need for tailored solutions that take optimal advantage of the available data records to reduce uncertainties in gap filled time series to fully capitalize on the spatially rich data available from this dense measurement network our system is based on a combination of distributed time delay neural networks dtdnns waibel et al 1989 and a self organizing map neural network som kohonen 1990 kohonen 1998 without the requirement of knowing the connecting functions neural networks are able to learn any nonlinear relations between soil water content measured at various sites at different depths and account for a heterogeneous subsurface water distribution caused by complex micro and macro topography within the mountainous study area as an improvement over classical regression neural networks dtdnn networks can utilize time series of input variables that were observed prior to the actual target value increasing the amount of information provided to model the observed data and predict missing values at specific times locations and soil depths respectively the two primary objectives of this study are to train test and apply a combination of dtdnn and som neural networks to fill gaps in the panther creek vwc volumetric water content time series and to verify the results by comparison to the palmer drought severity index computed independently for the geographic cell containing the panther creek study area in order to fill the data gaps in 61 vwc time series at 2 different depths we modeled the series consecutively using completed series as input for further network models a som network was applied to support an appropriate choice of input variables after several time series had been gap filled and were available as input for the subsequent gap filling of additional time series 2 data and methods 2 1 panther creek site and measurement network the 2 260 ha panther creek site is located within the eastern foothills of the densely forested coast range of western oregon about of 46 km east of the pacific coastline and 8 km west of the neighboring willamette valley while the vegetation at the study site in the coast range is dominated by douglas fir forest the neighboring valley is characterized by more heterogeneous land use including agricultural areas urban areas and smaller fragments of forest containing a variety of species annual average precipitation at the study site is 2238 mm based on the 30 year average prism data daly et al 2008 this value agrees well with precipitation values measured at the site for the years 2012 to 2017 averaging 1963 412 mm soil moisture was monitored at 5 cm and 50 cm depth below the surface of mineral soil with decagon ec 5 decagon devices wa usa soil moisture sensors connected to a decagon em 50 analog data logger within each of 33 circular 0 08 ha vegetation plots 16 m radius or 1 5 ac with 52 5 ft radius the plots were located adjacent to a very thoroughly described nrcs natural resource conservation service soil pit soil temperature was also monitored at a depth 5 and 50 cm below the surface of mineral soil using decagon rt 1 decagon devices wa usa soil temperature sensors connected to the same em 50 data logger soil volumetric water content was measured and recorded at 2 hour intervals from may 2012 through all subsequent growing seasons and intervening dormant seasons up to september 2018 the layout of the network of plots provides a spatially dense data record of soil moisture accounting for the heterogeneous soil composition and complex terrain between and at the 33 experimental plots the plots are distributed over an area of roughly 18 km2 in the panther creek watershed fig 1 with individual plot elevations ranging from 240 m to 670 m above sea level within 10 m of plot 5 a fully instrumented weather station that uses more sophisticated soil moisture temperature sensors campbell scientific hydraprobes at seven different depths corresponding to local soil horizons provided hourly supplementary measurements that contained much fewer data gaps in addition to soil moisture and soil temperature the fully instrumented weather station hereafter referred to as mega station also provided air temperature and relative humidity hmp45 vaisala helsinki finland photosynthetically active radiation li 190sl li cor biosciences lincoln ne usa precipitation te525 campbell scientific logan ut usa and wind velocity met one instruments grants pass or usa the soil moisture data and the meteorological data from the mega station were in part used as additional input to model the soil water content at the stations to improve the data gap filling the data recorded at 2 hour intervals at the 33 plots as well as the hourly data recorded at the mega station were aggregated to daily values because a daily resolution is sufficient for further utilization of the soil and meteorological data this dataset is part of a multi disciplinary research effort within the panther creek watershed financed by the usdi bureau of land management and included not only multi year collection of watershed level lidar and meteorological data but also tree and other vegetation measurements and assessment of soils and hydro geography flewelling and mcfadden 2011 the soil moisture and meteorological dataset is available to all researchers and is currently being used to refine estimates of net primary production of douglas fir stands and validate mechanistic models for simulating tree growth responses to soil water availability light interception and ambient air temperature e g rogers 2013 daily averages also remove the effects of diurnal fluctuations and noise due to random errors during the learning procedure of the neural networks thus increasing the generalization capability of the final models during application to new data not used during the machine learning process the multi year campaign resulted in 2318 days of data with partially significant gaps irregularly distributed over the times series of 33 sites and 2 monitored soil depths fig 2 despite the temporal discontinuity of the data series the spatial density of measurement plots makes neural networks particularly suitable for the task of gap filling the time series functional relations between the soil data from neighboring stations can be assumed due to similarities in environmental conditions that govern soil moisture content such as precipitation meteorological conditions composition of the soil matrix and topography moreover the duration of the measurements over 76 months provides a dataset with a wide range in meteorological conditions including dry and hot years as well as wet and cooler years this comprehensive learning dataset ensures that the models are more generally applicable and sufficiently large to correctly simulate long periods using an adequate timespan of input values for models estimating the respective range of target variables a simple cross comparison of all plots of the panther creek study area shows the strength of relationships among the measured time series linear regressions indicate that the coefficients of determination r 2 for all 1089 combinations of plots and monitoring depths range from rather low to very high vwc 5cm r2 min 0 0117 r2 max 0 9862 vwc 50cm r2 min 0 4483 r2 max 0 9692 respective independent variables therefore cannot be assumed suitable as input for a corresponding dependent variable in a simple linear regression weak r 2 between pairs of vwc variables at neighboring sites indicate that sample size was too small too many missing values of response and or predictor variable their relationship is nonlinear or the variables are just fundamentally unrelated fig 3 although all sites were equipped with individual measurement instruments and data loggers data gaps sometimes but rarely do occur simultaneously at a pair of sites therefore only in limited cases was a specific independent variable available to fill the all data gaps of the dependent variable with a simple regression model any regression model based on a very small sample size makes the simple linear or nonlinear regression approach unsuitable for gap filling despite some high correlations between remaining pairs of vwc observations for some pairs of plots within a depth i e cells within panel a or b in fig 3 the problem compounds if multiple variables are used due to the even greater number of cases for which all input variables i e independent variables in the case of multiple regression models would consistently be available for all data gaps within the time series of the dependent variable here the neural network approach provides a superior opportunity as alternative variables can be used as input even though the relationship to the target variable might be weak or non linear e g patterson 1996 as shown in fig 2 several plots exhibit vwc data availabilities of 100 for at least one depth those complete time series were available as initial input for the incomplete time series to be filled first the incomplete series were consecutively modeled by a specifically trained neural network and then gap filled starting with the vwc series with the least number of data gaps 2 2 artificial neural network models artificial neural networks are an exclusively data driven machine learning technique with the capability to learn the functional dependencies between driving variables and variables of interest in a supervised or unsupervised manner no prior knowledge initial model parameterization or assumptions about functional relationships or value limits are required e g haykin 1999 bishop 2006 haykin 2009 artificial neural networks have been successfully used to fill gaps in meteorological data schmidt et al 2008 schmidt et al 2011 dengel et al 2013 and to model the exchange of carbon water and energy between the soil vegetation and atmosphere e g papale and valentini 2003 schmidt et al 2018 to train a neural network model the available data are typically divided into three subsets and then used in three corresponding steps during the learning process by comparing the modeled output with available measured values of the first data subset training data the model parameters are iteratively adjusted until an acceptable agreement between modeled and observed data training error e is reached this can mathematically be achieved by following the steepest gradient of the error function e g haykin 1999 the average deviations of the ann estimates and the corresponding measured reference values constitute the learning error usually quantified by the following mean squared error mse 1 e 1 n i 1 n m i t i 2 with mi being the estimated value of observation i with i 1 2 n and ti the corresponding measured value of observation i in this regard the network learning process is similar to least squares regression where a statistical loss function here the sum of squared differences between the observations input data and predictions from a function developed to represent the dependent variable target data is minimized however neural networks iteratively adapt multiple parameters of the mathematical mapping functions to available input and target data i e the learning process this ability allows the networks to estimate any function regardless of the type and form of the underlying function and independently learn to simulate the functional relationship between the input and target variable e g bishop 2006 haykin 2009 as a result linear methods and regression approaches are usually outperformed by neural networks e g riad et al 2004 choubin et al 2014 kornelsen and coulibaly 2014 gordon casey et al 2019 in the second step a different subset of the comprehensive dataset than was used in the first learning step is presented to the network and the functions learned in the first step are applied to the new data to calculate the target values if the deviations between the ann estimates and measured target values from the subset i e validation error is high the functions are regarded as over adjusted to the learning dataset and the function parameters are re adjusted to find an optimum between the training and the validation error this procedure ensures that the network model is sufficiently generalized to be able to process new data reliably by inherently capturing the functional relations between the available input variables and the target values without over adjusting to the specific training data subset a third subset test data from the comprehensive dataset that was not included in the previous processes is then presented as new data to the network and the final output of the trained network can be compared to the test data and the loss function estimated again the resulting test error is the value that actually describes the performance of the network when new data are simulated 2 2 1 distributed time delay neural networks dtdnns as first introduced by waibel et al 1989 are a class of neural networks specifically suitable for time series modeling unlike regular feed forward regression networks time delay networks not only apply an input vector to estimate a temporally corresponding output value but use additional information from previous time steps in the form of time series sequences of input vectors wang et al 2005 liu et al 2006 peddinti et al 2015 by using this temporally enhanced input the models implement the mathematical approximation of accumulation and delayed processes on the output e g waibel et al 1989 liu et al 2008 rahman et al 2015 which can significantly improve the performance of the models e g schmidt et al 2018 an additional delayed input line connected to the weights of the network nodes allow time delay networks to have a dynamic response to time series input data fig 4 for the gap filling of the vwc series we trained and applied networks that include time series segments of δt 2 days prior to the actual target value at time t to increase the correlation between the measured and modeled values this recurrent connection allows those networks to detect time varying patterns and predict the current value based on previous states of the interdependent time series of several input variables the forwarding of the shifted values of the time series to the weight vectors within the output layers of the networks is shown in fig 4 each of the trained network models uses a distinct number and composition of input vectors x depending on the availability and suitability of input data for a given plot and measurement depth in order to use the available measurement data most efficiently we applied bayesian regularization learning for the network optimization algorithm to reduce the number of required learning data records by eliminating the need for a validation dataset during the learning processes 2 2 2 bayesian regularization training bayesian regularization is specifically successful if the data are noisy as is the case for the soil moisture datasets using the levenberg marquardt lm minimization algorithm the bayesian regularization procedure minimizes a linear combination of squared errors using a gradient approach to find the network parameters resulting in a network with good generalization capabilities foresee and hagan 1997 for bayesian regularization no validation data subset is used only the training data and the test data subsets are required eliminating the need for a third data subsample limits the amount of data needed for the network model learning process which is an advantage over the cross validation approach if a complete dataset of input and target values are limited due to data gaps for instance by adding a penalty algorithm to the network optimization bayesian regularization also circumvents potential over adjustment to the training data for that purpose the error function is enhanced to search for the minimal error using minimal weights to incorporate the number and sum of weights as an optimization goal a term is added to the error function to quantify the following mean sum of squares of the network weights e w eq 2 here wj is the j th element of the weight vector w of length n and α and β are performance function weight parameters between 0 and 1 2 e w 1 n j 1 n w j 2 where wj is the j th element of the weight vector w of length n this leads to a weighted error function or cost function f as given in eq 3 3 f α e w β e with α β 1 with α and β referring to performance function weight parameters that exhibit values between 0 and 1 the sum of the network weights is constrained by reducing the number of effective weights to an optimized number that allows the network to fit the inputs to the training targets while also limiting network complexity this makes the network s response to the presented inputs smoother and the network less prone to over fitting thereby improving its performance when confronted with new data during later application of the network the cost function weight parameter β in eq 3 sets the emphasis of the training algorithm towards reducing the network error term e whereas increasing the weight parameter α emphasizes reducing the sum of the weights integrated over all network neurons the minimization of the network errors i e minimization of the cost function eq 3 was achieved using the lm optimization algorithm as implemented in matlab r2019b combining the gradient descent method and the gauss newton minimization algorithm the lm method was used as the iterative numerical standard approach to solve non linear minimization problems further details can be found in marquardt 1963 or butenko and pardalos 2014 the adaption of the network weights during the lm iteration and the search for the optimal number of active weights were regularized using a bayesian approach by optimizing the cost function weight parameters α and β following mackay 1992 the posterior of the probability density function was maximized applying bayes rule 4 p d α β m p d w β m p w α m p w d α β m here d is the available dataset with inputs and targets m is the network model and w is the vector of neural network weights after substitution and some transformations foresee and hagan 1997 the values for the weight parameters at the minimum of the cost function were estimated 5 α mp μ 2 e w w mp and 6 β mp n μ 2 e w mp 7 with μ n 2 α mp t r h mp 1 here tr is the trace of the inverse hessian matrix h at the minimum point mp of the cost function and µ is the minimized effective number of parameters in the optimized network that are effectively used to minimize f further details about the bayesian regularization method can be found in burden and winkler 2009 as the first data series to train a model the vwc series with the least amount of data gaps was chosen as it provides the largest training dataset once the first data series was gap filled the same data series was added to the set of complete data series used as input for the next network model the procedure continues such that data series with increasingly large or numerous gaps and a decreasing amount of training data can be gap filled with an increasingly large pool of complete data series that are used as input for the new network model following this approach the smaller number of target data available for training a specific network is compensated for by providing more and more mathematically related gap filled variables as input to model the entire 2318 days of measurements however as more gap filled vwc time series become available for input series the number of inputs can reach a point beyond which the performance of the network for a specific target series declines instead of adding useful information the correlation between measured and modeled test data starts to decrease this undesirable consequence is caused by the increasing dimensionality of the cost function to be minimized eq 3 which makes finding the global error minimum more difficult e g bengio and bengio 2000 bishop 2006 hence while the best combination of input variables must be found to provide as much useful information as possible incorporating redundant or inadequate input variables in the optimization process must simultaneously be avoided recent studies have demonstrated successful solutions to this problem with deep learning neural networks by effectively sorting out and neglecting obstructive input as part of the learning algorithm poggio et al 2017 scardapane et al 2017 hutzenthaler et al 2020 however training a deep neural network is time consuming computationally expensive and requires a very large number of training data cases that are not always available as was the case for the panther creek vwc measurements therefore a machine learning classification of the input variables using som networks was instead combined with a consecutive k means clustering clustering the site data ensured that in the following step time series chosen as inputs for a distinct target time series were only selected if they exhibited similarities in all 4 soil parameters i e soil temperature and soil moisture at two depths 5 and 50 cm 2 2 3 self organizing map for cluster based input selection som neural networks with gaussian distance functions e g kohonen 1998 kohonen 2001 were deployed to cluster the datasets containing soil temperature and soil moisture at all 33 sites over the 6 year measurement period som networks can be used as an advanced cluster analysis tool because they can recognize similarities of presented input vectors e g kohonen 1990 patterson 1996 haykin 2009 soms have been successfully applied in various scientific disciplines to recognize patterns in large or high dimensional datasets e g wang et al 2001 ghasemi et al 2009 murty et al 2009 schmidt et al 2016 chen and huang 2020 a som adapts its spatial structure during an unsupervised learning procedure and learns to recognize the distribution of a given input dataset as well as its topology in the high dimensional input space kohonen 2001 du 2009 in the panther creek application euclidian distances between 4 dimensional input values soil temperatures at a depth of 5 and 50 cm and vwc at the same two depths are mapped to a two dimensional 2d plane results can be quantified and visualized through a 2d neighbor distance map on which the distances inversely represent the similarities of all components of the original data records presented to the som network every neuron in the map grid layer is connected to a weight vector that can be adjusted to the input data during each iterative learning step all input vectors are transferred in a random order to all neurons in the map grid for each input vector x presented to the network the competitive learning procedure determines the neuron with a weight vector w that is nearest to the current input vector based on this principle the winning neuron can be determined by finding the minimum of the euclidian distance d between the input and all weights in the n 4 dimensional input space eq 8 with 8 d min min x w j min n x n w jn 1 2 after that only the weight vector of this winning neuron and the weights of its neighbors in a pre defined range are updated and shifted closer towards the respective input vector as a consequence the activation of the adapted neurons will be higher if a similar input is presented to the som during the remaining learning epochs the input vectors are partitioned into k clusters and the cluster centers are set to represent the best center i e the best centroid in the multi dimensional space for the respective cluster the algorithm iteratively determines the minimum of the sum of squares clustering function j given as 9 j k i s k w ik 1 n k i s k w i 2 the second term in eq 9 gives the mean of the data subset sk with nk elements building the cluster k bishop 2006 at the end of this clustering procedure each weight vector w is assigned to the cluster center that is nearest a radial basis distance function in our case a gaussian function with center c and a defined width of its basis can be used as representative of the cluster in contrast to a k means clustering e g mcqueen 1965 likas et al 2003 both the winning neuron and its neighbors are updated in a defined range during the som learning procedure this neural interconnectivity gives the som a better ability to recognize similarities among datasets that show a large variety and range compared to the k means clustering algorithm clare and cohen 2001 the strength of the final neighbor connections between the neurons in the map layer are defined by distances between their weight vectors in the input space or feature space kohonen 1990 tavan et al 1990 the update of the weight vectors w j after epoch l is given by 10 w j l 1 w j l η l ϕ l x l w j l where η is the learning rate with which the weight vector values are iteratively adjusted the learning rate η and the value of the neighborhood range function ɸ l decrease with increasing l mulier and cherkassky 1994 following the exponential expression in eq 11 11 η l η start η end η start l l max the initial and ending learning rates are set to achieve a coarse sorting of the input data at the beginning of the learning process and a fine tuning of the center positions during the final epochs the cluster centers found through the som are then further aggregated into the final clusters by a subsequent k means algorithm due to the neural interconnectivity between neighboring nodes the som provides a better recognition of similarities in datasets with smooth boundaries in variable space e g vesanto and alhoniemi 2000 clare and cohen 2001 schmidt et al 2011 moreover because the pre clusters assorted by the som are local averages of the data the clustering of pre clusters found by an som is less sensitive to random variations than the clustering of the original data vesanto and alhoniemi 2000 while most cluster validity indices maximize the inter cluster distances and minimize distances between the points within a cluster the calinski harabasz validity index calinski and harabasz 1974 has been shown to be one of the most robust indices for finding the optimal number of clusters maulik and bandyopadhyay 2002 furthermore the calinski harabasz validity index performs well when clusters overlap saitta et al 2008 which was the case for our data accordingly calinski harabasz validity indices were calculated to determine the optimal number of final clusters for soil temperature and vwc the machine learning supported data gap filling procedure is schematically summarized in fig 5 to illustrate the multiple steps included 3 results and discussion 3 1 modeling of missing meteorological data in addition to vwc data records meteorological data from the mega station were used as input yet the hmp 45 relative humidity rh sensor was affected by technical issues during the latter period of measurements june 2015 to september 2018 which led to data gaps and outliers thus prior to using the mega station data as additional input for the vwc network models we gap filled the rh values of the mega station by training a neural network using meteorological data from two weather stations in the region operated by the national weather service gap filling step 1 in fig 5 in particular we used air temperature and relative humidity from weather stations in hillsboro 45 541 north 122 950 west and mcminnville 45 195 north 123 136 west to train a neural network and reproduce rh as measured by the mega station in the vicinity of plot 5 furthermore the air temperature values at the mega station were utilized resulting in a total of 5 input variables available for the training the applied network had 10 neurons in the hidden layer and no backward time interval for the input vector was used panel a of fig 6 shows the regression and the coefficient of determination for the test dataset providing a high confidence for the gap filled rh results the course of the rh values modeled by the network follows the measured values closely for the first half of the period with measured data for comparison and model training available the gap filled simulated values show a clear seasonal pattern and consistently remain in the physically reasonable range with a cutoff at just below 100 relative humidity and a lower boundary range of roughly 20 relative humidity as observed at the site in previous years and typical for the region fig 6b 3 2 som clustering of potential input variables in order to enhance the data pool 2 hourly records october 2011 through february 2016 of soil temperature and corresponding soil water content at two depths were used for the plot clustering procedure to cluster the 4 dimensional data records consisting of soil temperature and vwc at 5 cm and 50 cm depth respectively a som was applied with 49 nodes which work as preliminary clusters arranged in a 7 7 hexagonal neuron grid fig 7 for the som network used in this study the learning rate at the beginning was set to ƞ start 0 9 and the minimum learning rate to ƞ end 0 05 while the number of reiterations of the input vector presentations to the network was set to l max 2000 eq 11 after the som algorithm reduced the dimensions from the higher dimensional input space to the 2 dimensions of the map plane the distances between the som neurons i e pre clusters were visualized on a map with darker colors indicating large distances i e large differences between the cluster values whereas brighter colors indicate similarity it is noticeable that the dataset was separated in several groups continuous yellow orange areas indicating similarities for all 4 variables whereas several nodes and groups of nodes are separated by large distances clearly separating the combinations of temperature and vwc grouped within the yellow data agglomeration zones fig 7 after the som data agglomerations were formed a k means clustering of the network neurons centers were conducted to obtain the final clusters of the soil data vectors the k mean algorithm using 2000 iterations and 500 replicate runs each were run using varying initial cluster centroid positions a maximum value for the calinski harabasz validity index was found for a number of 2 final clusters as a result each of the 33 plots was assigned to the cluster to which the majority of its soil temperature and soil moisture data vectors were allocated fig 8 during the following training of the dtdnn networks the input data for a specific plot were chosen from plots that belonged to the same cluster to provide the most efficient information for the network preselected by the clustering procedure based on machine learning the spatial distribution of plots and their corresponding cluster assignments in fig 8 show no simple pattern that could be explained by similarities of topographic features at the plot locations this indicates a more complex distribution of soil temperature and soil moisture conditions upon which the clustering was based in addition to the complex topography at the site the distribution of soil moisture and temperature at the two monitored depths was also influenced by other parameters such as the composition and structure of the soil matrix and the intensity of evapotranspiration which in turn could be affected by stand structure this underscores the usefulness of applying the clustering procedure prior to choosing input variables as is the case with this dataset geographic plot proximity may often be less useful than other factors in relating target and input variables som neural networks are solely data driven and capable of recognizing multivariate data stream similarities using an unsupervised learning algorithm kohonen 2001 hence matching sample points through recognition of similar patterns in their associated data series avoids unnecessarily noisier modeling of multivariate and complex functional interdependencies with the entire dataset or datasets that include unaccommodating data 3 3 modelled time series of volumetric water content after preparing and assigning the required input data a specific dtdnn model was trained with bayesian regularization for each vwc time series affected by data gaps by iteratively increasing the number of input delay time steps the model with the lowest mse for the test data was chosen to reproduce and eventually fill the gaps in the respective time series once filled a vwc time series regardless of measurement depth was added to the potential input data pool if the resulting performance of the network increased the length over which a network model can fill data gaps reliably depends on the conditions represented in the available training data if the training data provide sufficient cases that account for the seasonal changes in the dependencies of the input and target values the model can learn those varying dependencies accordingly hence target values can be modeled over long periods of time with low errors despite varying meteorological conditions in years with long data gaps using a measurement network as in this study the richness and length of available correlated training data allow for sufficient model performances even if data gaps are several years long nevertheless the vwc time series at 50 cm depth at plot p102 was so heavily affected by instrument malfunction and outliers that not enough reliable data were left to train a dtdnn model demonstrating the limitations of our solely data driven machine learning approach the results for the gap filling procedure and information about the applied network topologies and input used for each of the modeled time series are summarized in table 1 the correlation coefficients r test refer to the test dataset used to show the actual network performance when confronted with new data an average correlation coefficient of r test 0 95 min r test 0 81 max r test 0 99 for all available measured and all corresponding network modeled test data subsets was achieved using the individually trained neural networks the rmse mse½ for the test dataset equals 0 04 cm3 cm3 and indicates very small overall deviation of modeled from measured values the addition of preceding time steps of input data increased the performance of the models in 69 of the cases table 1 δt 0 the high correlation coefficients in combination with the low mse values indicate a reasonably low uncertainty for the resulting gap filled vwc time series when used in further analyses in addition to the correlation coefficient referring to the test data the coefficient r all gives the correlation between all available data records and the corresponding network modeled results the high values show that the functional relation between the input variables and the target variable is simulated closely by the respective network models even though the model results exhibit high correlations and low mse when compared to the measured reference data we also analyzed how well the modeled time series simulate the behavior of the measured values for this purpose we performed a cross comparison of the coefficients of determination for the measured and the modeled time series if the modeled time series resemble the behavior of the measured time series over time the coefficients of determination for the regression of any pair of time series should remain stable hence we compared the r 2 values for each data pair as compared in section 2 1 fig 3 before and after all gaps were filled with modeled data fig 9 the combination of dtdnn and som artificial neural networks delivered results that reproduced the mathematical relation between the measured time series with small deviations the cross comparison shows that 70 of the vwc time series pairs analyzed show less than 10 difference for the coefficients of determination for the 5 cm time series fig 9a for vwc at 50 cm soil depth 89 of the combinations show less than 10 deviation between the coefficients of determination of the original series and post gap filling series fig 9b after removing the time series with low measurement data coverage at plots 209 and 312 the percentages of time series with less than 10 difference increase to 81 5 cm and 95 50 cm respectively the noticeably altered relations between the vwc values at 5 cm depth at plot p312 fig 9a and most vwc time series at other sites are due to the fact that only 4 9 measured data were available over the study period fig 2 therefore relationship between measured data at this plot with all other measured data in fig 3 are based on data of only a few periods at p312 in contrast the majority of the statistics shown in fig 9 are based on the functional relations of a much larger sample covering various meteorological conditions over the 76 month study period that are not found in the measured data therefore we cannot place as much confidence on the r 2 values derived from the few measured data and the corresponding long term soil moisture estimates at this plot and depth the same conclusion similarly applies to the vwc data at the 50 cm depth in plot p209 fig 9b where only 22 2 of the time series were available as measured values fig 2 in order to assess the overall soil moisture conditions for both depths monitored at the panther creek plots we calculated the monthly averages over all 33 plots for the entire period with completed vwc time series available from may 2012 through september 2018 after gap filling this allows examining the saturated and dry conditions at these mesic sites over the years the dry summer conditions of 2015 and 2018 in the region determined through the corresponding palmer drought severity index pdsi for the study area in july fig 11b is reflected in the lowest average values for vwc at 5 cm and 50 cm in those same years at the panther creek plots fig 10 moreover the higher average soil moisture values during the winter period of the year 2017 for both soil depths fig 10 are also in agreement with the respective pdsi values for january at the panther creek site fig 11 a those soil moisture conditions averaged over all plots provide a quantitative assessment of the general conditions that govern the range of values found at the individual plot locations and hence agree well with general indicators such as the pdsi with a 4 km x4 km spatial resolution taking advantage of the high density of plots in the area we spatially interpolated seasonal patterns of soil moisture extrema in particular we calculated the summer july august and september minima and winter december january and february maxima of vwc at all sites for both soil depths using monthly averages a natural neighbor interpolation method for discrete spatial data points sibson 1981 was applied to spatially interpolate the monthly values for the area covered by the plots fig 12 shows the vwc extremes for the study area based on summer and winter averages over the 76 months of data a general west east gradient is visible interrupted by higher values during summer in the central area between plots p106 p309 and p311 especially for vwc at a 50 cm depth fig 12b the three plots are all members of the same cluster 1 fig 8 this specific area also exhibited higher soil moisture maxima during winter at the 50 cm soil layer fig 12d this feature corresponds to an elevational extension of the valley that forms relative orographic basins corresponding to the headwaters of silver creek fig 8 in addition the higher winter maximum around plot p313 fig 12c overlaps with the outer boundary of the mountain range where the surface slopes towards the bed of panther creek this orographic feature is associated with increased surface water runoff during the rainy winter season the maximum area is also visible for the 50 cm soil depth during the winter months although on an elevated level fig 12d while these seasonal extrema are at least in part associated with orographic conditions other spatial values are not as obviously linked to the macro topography of the surrounding landscape the summer minimum near plot p302 at a 5 cm depth includes a larger area than the more localized minimum vwc for the 50 cm depth fig 12a and b this localization is also apparent for the winter maximum at plot p302 at a 50 cm depth classified as 0 25 0 32 cm3 cm3 which is rather low relative to the surrounding areas fig 12d located within an orographic basin near the panther creek bed increased soil moisture values in winter and summer might be expected all else being equal however other potential factors such as soil depth texture and structure subsurface flow patterns and rate of summer evapotranspiration attributable to local vegetation structure would also change the local pattern of soil moisture further analyses that consider differences in stand age stand density total leaf area and spatial distribution of leaf area and their influence on evapotranspiration rates are needed to fully understand the spatiotemporal soil moisture patterns at this research site containing uniquely dense spatial soil monitoring the results of this study provide the completed multi year time series of vwc data to support respective studies of spatiotemporal patterns in forest productivity 4 summary and conclusion soil parameters including volumetric water content were measured at the panther creek site located on the eastern slopes of the oregon coast range the resulting dataset comprised virtually continuous measurement of soil moisture and soil temperature at 5 cm and 50 cm depth at 33 plots over more than 6 years compiled into daily averages the majority of the vwc time series were affected by often substantial data gaps we therefore applied dtdnn neural networks which are particularly well suited for time series simulation to plots that were first grouped by their relative similarity in combined soil moisture and temperature series at the 2 monitored depths similarities of plot specific datasets were assessed through a machine learning approach combining a som neural network and a succeeding k means clustering procedure the models were applied to fill gaps in the vwc series among the 33 plots within the 2 260 ha study site our results show the high performance of the network models that can capitalize on the data richness i e long time series at high spatial density besides being able to learn and simulate any functional relation between the input and the target variable the machine learning approach has the advantage of being completely data driven hence no functional assumptions are required when relations between multiple sites and soil depths are not known instead of searching for correlations in the data prior to finding a model the data are used to develop and optimize models through the network training procedure including data records prior to the date of a missing observation helped to improve the results for 69 of the models an average correlation coefficient of 0 95 and a rmse of 0 04 cm3 cm3 were achieved for measured and modeled time series subsets that had not been used in the learning process moreover the functional relation between measured time series at various plots was retained by the modeled data by removing extreme cases that had too few measurements to determine a r 2 that is representative for 6 years of data 81 of the 5 cm vwc data and 95 of the 50 cm vwc data show less than 10 difference between the r 2 values prior to and after the gap filling spatially interpolated extreme values during summer and winter both show parallels with the topographic conditions that influence rain water runoff and aggregation at the site furthermore results averaged over the plots clearly correspond to the palmer drought severity index for the region reflecting the soil moisture effects of dry summers and wet winters accordingly however because the method is exclusively data driven a sufficient amount of data is needed for each model to acquire stable mathematical representations that generalize the functional relation between the inputs and the target variable and hence acceptable model performance as was the case for at least one time series in our system this learning data requirement demonstrates the limit of the dtdnn approach as opposed to a process model with pre defined functions nevertheless high model performances and low errors show the suitability of the applied machine learning approach for time series of soil moisture particularly for a spatially dense measurement network that provides an applicable array of interrelated data this robust method can therefore be applied to similar situations where data gaps impede a full utilization of data collected at several locations that share similar driving environmental conditions credit authorship contribution statement andres schmidt conceptualization formal analysis software writing original draft validation methodology doug mainwaring resources investigation writing review editing data curation doug maguire funding acquisition investigation project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the bureau of land management u s department of the interior for financing this study through assistance agreements l11ac20051 l14as00038 l14ac00134 and l16ac00348 
5306,to monitor the complex interdependency between soil moisture and productivity of douglas fir forests in the pacific northwest a dense low cost network of soil moisture sensors was installed in association with 33 forest vegetation plots in a single 2260 ha watershed in western oregon four sensors were installed in each plot to record volumetric soil water content and soil temperature 5 and 50 cm below the surface of mineral soil at 2 hr intervals from 2012 through 2018 significant data gaps restricted the full utilization of the resulting dataset summarized as daily averages a self organizing map neural network was applied to find clusters of plots with similar functional dependencies of soil temperature and soil moisture values the results guided the subsequent assignment of the most suitable time series as input for plot specific distributed time delay neural networks that were trained to simulate the time series of volumetric water content in the two soil depths at 33 locations in addition to contemporaneous inputs used in conventional neural networks the application of distributed time delay neural networks allows the incorporation of prior sections of the input time series data the results show the high performance of the combined machine learning approaches that capitalize on the spatial data richness of the dense monitoring network the correlation coefficient for the test data subsets averages 0 95 and the mean error equals 0 04 cm3 cm3 the correlation between time series at various plots was retained for the modeled data a cross comparison of the data revealed that 81 of the 5 cm soil moisture data and 95 of the 50 cm soil moisture data show less than 10 difference between the coefficients of determination prior to and after the gap filling procedure the long term gap filled soil moisture extremes correspond well with a high resolution palmer drought severity index calculated for the area keywords machine learning drought index forest hydrology volumetric soil water content distributed time delay neural networks soil moisture monitoring 1 introduction soil water availability is a major determinant of the productivity of douglas fir forests in western oregon particularly during the latter part of the growing season emmingham and waring 1977 waring et al 2008 when drawdown of soil water is further exacerbated by high vapor pressure deficits waring and franklin 1979 landsberg and sands 2011 in addition future climate change scenarios predict its increasing influence as soil water in this region is expected to be more limiting during hotter and drier summers drought and heat induced plant stress reduced productivity and elevated mortality has hit western north american ecosystems in recent years leading to great concern about the future extent and composition of these forests e g reilly and spies 2016 the spatial coverage and intensity of these stress events are likely to worsen in the future due to more frequent and more intense droughts enhanced summer droughts are expected in almost all areas of western north america as snow packs decline and melt earlier this change is expected to hasten the start of the growing season and as plants use up available soil water they will become water stressed earlier in the season most likely decreasing plant productivity in the long term e g restaino et al 2016 littke et al 2018 douglas fir forests in oregon are predicted to suffer from these progressive temperature and soil moisture limitations due to climate change beedlow et al 2013 furthermore the severity of wildfires is highly correlated to soil water availability which makes the accurate assessment in densely forested areas particularly important e g bourgeau chavez et al 2007 parks et al 2016 in an effort to understand the relationships between seasonal soil water availability stand growth and response to silvicultural treatment such as fertilization the center for intensive planted forest silviculture cips and the stand management cooperative smc installed soil moisture and soil temperature sensors at 5 cm and 50 cm depths into mineral soil on a number of different fertilization trials littke et al 2014 similar moisture and temperature monitoring sites were installed in association with soil pits intensively characterized by the natural resources conservation service nrcs within the panther creek blm lidar study area in western oregon the objective was similarly to gain an understanding of the relationships between available water holding capacity of the soil awhc diurnal and seasonal trends in evapotranspiration concurrent local weather conditions and local forest productivity rodman 2016 soil moisture data were collected at a total of 33 sites in the panther creek study area using low cost instruments from early 2012 through fall 2018 providing a spatially dense representation of the soil moisture conditions however as often happens with low cost equipment under field conditions data gaps resulted from sensor and data logger failures in addition to animal damage and vandalism as a result most of the time series contain continuous periods of missing data ranging from 4 days to over 3 years thus the objective of the modeling efforts presented in this study was to develop and apply a tailored combination of machine learning approaches to reliably fill in data gaps and improve the continuity and utility of the soil moisture data collected due to its importance for estimating evapotranspiration rates and for modeling the carbon cycle several past efforts have been undertaken to reliably model relationships among variables and fill data gaps in soil moisture datasets approaches have been pursued using satellite observations wang et al 2012 models based on soil properties saxton and rawls 2006 and various statistical models including evolutionary polynomial regression and conventional neural networks kornelsen and coulibaly 2014 these studies show that particular methods work well under a specific but narrow set of conditions but that no universally superior approach to fill data gaps has been found underscoring the need for tailored solutions that take optimal advantage of the available data records to reduce uncertainties in gap filled time series to fully capitalize on the spatially rich data available from this dense measurement network our system is based on a combination of distributed time delay neural networks dtdnns waibel et al 1989 and a self organizing map neural network som kohonen 1990 kohonen 1998 without the requirement of knowing the connecting functions neural networks are able to learn any nonlinear relations between soil water content measured at various sites at different depths and account for a heterogeneous subsurface water distribution caused by complex micro and macro topography within the mountainous study area as an improvement over classical regression neural networks dtdnn networks can utilize time series of input variables that were observed prior to the actual target value increasing the amount of information provided to model the observed data and predict missing values at specific times locations and soil depths respectively the two primary objectives of this study are to train test and apply a combination of dtdnn and som neural networks to fill gaps in the panther creek vwc volumetric water content time series and to verify the results by comparison to the palmer drought severity index computed independently for the geographic cell containing the panther creek study area in order to fill the data gaps in 61 vwc time series at 2 different depths we modeled the series consecutively using completed series as input for further network models a som network was applied to support an appropriate choice of input variables after several time series had been gap filled and were available as input for the subsequent gap filling of additional time series 2 data and methods 2 1 panther creek site and measurement network the 2 260 ha panther creek site is located within the eastern foothills of the densely forested coast range of western oregon about of 46 km east of the pacific coastline and 8 km west of the neighboring willamette valley while the vegetation at the study site in the coast range is dominated by douglas fir forest the neighboring valley is characterized by more heterogeneous land use including agricultural areas urban areas and smaller fragments of forest containing a variety of species annual average precipitation at the study site is 2238 mm based on the 30 year average prism data daly et al 2008 this value agrees well with precipitation values measured at the site for the years 2012 to 2017 averaging 1963 412 mm soil moisture was monitored at 5 cm and 50 cm depth below the surface of mineral soil with decagon ec 5 decagon devices wa usa soil moisture sensors connected to a decagon em 50 analog data logger within each of 33 circular 0 08 ha vegetation plots 16 m radius or 1 5 ac with 52 5 ft radius the plots were located adjacent to a very thoroughly described nrcs natural resource conservation service soil pit soil temperature was also monitored at a depth 5 and 50 cm below the surface of mineral soil using decagon rt 1 decagon devices wa usa soil temperature sensors connected to the same em 50 data logger soil volumetric water content was measured and recorded at 2 hour intervals from may 2012 through all subsequent growing seasons and intervening dormant seasons up to september 2018 the layout of the network of plots provides a spatially dense data record of soil moisture accounting for the heterogeneous soil composition and complex terrain between and at the 33 experimental plots the plots are distributed over an area of roughly 18 km2 in the panther creek watershed fig 1 with individual plot elevations ranging from 240 m to 670 m above sea level within 10 m of plot 5 a fully instrumented weather station that uses more sophisticated soil moisture temperature sensors campbell scientific hydraprobes at seven different depths corresponding to local soil horizons provided hourly supplementary measurements that contained much fewer data gaps in addition to soil moisture and soil temperature the fully instrumented weather station hereafter referred to as mega station also provided air temperature and relative humidity hmp45 vaisala helsinki finland photosynthetically active radiation li 190sl li cor biosciences lincoln ne usa precipitation te525 campbell scientific logan ut usa and wind velocity met one instruments grants pass or usa the soil moisture data and the meteorological data from the mega station were in part used as additional input to model the soil water content at the stations to improve the data gap filling the data recorded at 2 hour intervals at the 33 plots as well as the hourly data recorded at the mega station were aggregated to daily values because a daily resolution is sufficient for further utilization of the soil and meteorological data this dataset is part of a multi disciplinary research effort within the panther creek watershed financed by the usdi bureau of land management and included not only multi year collection of watershed level lidar and meteorological data but also tree and other vegetation measurements and assessment of soils and hydro geography flewelling and mcfadden 2011 the soil moisture and meteorological dataset is available to all researchers and is currently being used to refine estimates of net primary production of douglas fir stands and validate mechanistic models for simulating tree growth responses to soil water availability light interception and ambient air temperature e g rogers 2013 daily averages also remove the effects of diurnal fluctuations and noise due to random errors during the learning procedure of the neural networks thus increasing the generalization capability of the final models during application to new data not used during the machine learning process the multi year campaign resulted in 2318 days of data with partially significant gaps irregularly distributed over the times series of 33 sites and 2 monitored soil depths fig 2 despite the temporal discontinuity of the data series the spatial density of measurement plots makes neural networks particularly suitable for the task of gap filling the time series functional relations between the soil data from neighboring stations can be assumed due to similarities in environmental conditions that govern soil moisture content such as precipitation meteorological conditions composition of the soil matrix and topography moreover the duration of the measurements over 76 months provides a dataset with a wide range in meteorological conditions including dry and hot years as well as wet and cooler years this comprehensive learning dataset ensures that the models are more generally applicable and sufficiently large to correctly simulate long periods using an adequate timespan of input values for models estimating the respective range of target variables a simple cross comparison of all plots of the panther creek study area shows the strength of relationships among the measured time series linear regressions indicate that the coefficients of determination r 2 for all 1089 combinations of plots and monitoring depths range from rather low to very high vwc 5cm r2 min 0 0117 r2 max 0 9862 vwc 50cm r2 min 0 4483 r2 max 0 9692 respective independent variables therefore cannot be assumed suitable as input for a corresponding dependent variable in a simple linear regression weak r 2 between pairs of vwc variables at neighboring sites indicate that sample size was too small too many missing values of response and or predictor variable their relationship is nonlinear or the variables are just fundamentally unrelated fig 3 although all sites were equipped with individual measurement instruments and data loggers data gaps sometimes but rarely do occur simultaneously at a pair of sites therefore only in limited cases was a specific independent variable available to fill the all data gaps of the dependent variable with a simple regression model any regression model based on a very small sample size makes the simple linear or nonlinear regression approach unsuitable for gap filling despite some high correlations between remaining pairs of vwc observations for some pairs of plots within a depth i e cells within panel a or b in fig 3 the problem compounds if multiple variables are used due to the even greater number of cases for which all input variables i e independent variables in the case of multiple regression models would consistently be available for all data gaps within the time series of the dependent variable here the neural network approach provides a superior opportunity as alternative variables can be used as input even though the relationship to the target variable might be weak or non linear e g patterson 1996 as shown in fig 2 several plots exhibit vwc data availabilities of 100 for at least one depth those complete time series were available as initial input for the incomplete time series to be filled first the incomplete series were consecutively modeled by a specifically trained neural network and then gap filled starting with the vwc series with the least number of data gaps 2 2 artificial neural network models artificial neural networks are an exclusively data driven machine learning technique with the capability to learn the functional dependencies between driving variables and variables of interest in a supervised or unsupervised manner no prior knowledge initial model parameterization or assumptions about functional relationships or value limits are required e g haykin 1999 bishop 2006 haykin 2009 artificial neural networks have been successfully used to fill gaps in meteorological data schmidt et al 2008 schmidt et al 2011 dengel et al 2013 and to model the exchange of carbon water and energy between the soil vegetation and atmosphere e g papale and valentini 2003 schmidt et al 2018 to train a neural network model the available data are typically divided into three subsets and then used in three corresponding steps during the learning process by comparing the modeled output with available measured values of the first data subset training data the model parameters are iteratively adjusted until an acceptable agreement between modeled and observed data training error e is reached this can mathematically be achieved by following the steepest gradient of the error function e g haykin 1999 the average deviations of the ann estimates and the corresponding measured reference values constitute the learning error usually quantified by the following mean squared error mse 1 e 1 n i 1 n m i t i 2 with mi being the estimated value of observation i with i 1 2 n and ti the corresponding measured value of observation i in this regard the network learning process is similar to least squares regression where a statistical loss function here the sum of squared differences between the observations input data and predictions from a function developed to represent the dependent variable target data is minimized however neural networks iteratively adapt multiple parameters of the mathematical mapping functions to available input and target data i e the learning process this ability allows the networks to estimate any function regardless of the type and form of the underlying function and independently learn to simulate the functional relationship between the input and target variable e g bishop 2006 haykin 2009 as a result linear methods and regression approaches are usually outperformed by neural networks e g riad et al 2004 choubin et al 2014 kornelsen and coulibaly 2014 gordon casey et al 2019 in the second step a different subset of the comprehensive dataset than was used in the first learning step is presented to the network and the functions learned in the first step are applied to the new data to calculate the target values if the deviations between the ann estimates and measured target values from the subset i e validation error is high the functions are regarded as over adjusted to the learning dataset and the function parameters are re adjusted to find an optimum between the training and the validation error this procedure ensures that the network model is sufficiently generalized to be able to process new data reliably by inherently capturing the functional relations between the available input variables and the target values without over adjusting to the specific training data subset a third subset test data from the comprehensive dataset that was not included in the previous processes is then presented as new data to the network and the final output of the trained network can be compared to the test data and the loss function estimated again the resulting test error is the value that actually describes the performance of the network when new data are simulated 2 2 1 distributed time delay neural networks dtdnns as first introduced by waibel et al 1989 are a class of neural networks specifically suitable for time series modeling unlike regular feed forward regression networks time delay networks not only apply an input vector to estimate a temporally corresponding output value but use additional information from previous time steps in the form of time series sequences of input vectors wang et al 2005 liu et al 2006 peddinti et al 2015 by using this temporally enhanced input the models implement the mathematical approximation of accumulation and delayed processes on the output e g waibel et al 1989 liu et al 2008 rahman et al 2015 which can significantly improve the performance of the models e g schmidt et al 2018 an additional delayed input line connected to the weights of the network nodes allow time delay networks to have a dynamic response to time series input data fig 4 for the gap filling of the vwc series we trained and applied networks that include time series segments of δt 2 days prior to the actual target value at time t to increase the correlation between the measured and modeled values this recurrent connection allows those networks to detect time varying patterns and predict the current value based on previous states of the interdependent time series of several input variables the forwarding of the shifted values of the time series to the weight vectors within the output layers of the networks is shown in fig 4 each of the trained network models uses a distinct number and composition of input vectors x depending on the availability and suitability of input data for a given plot and measurement depth in order to use the available measurement data most efficiently we applied bayesian regularization learning for the network optimization algorithm to reduce the number of required learning data records by eliminating the need for a validation dataset during the learning processes 2 2 2 bayesian regularization training bayesian regularization is specifically successful if the data are noisy as is the case for the soil moisture datasets using the levenberg marquardt lm minimization algorithm the bayesian regularization procedure minimizes a linear combination of squared errors using a gradient approach to find the network parameters resulting in a network with good generalization capabilities foresee and hagan 1997 for bayesian regularization no validation data subset is used only the training data and the test data subsets are required eliminating the need for a third data subsample limits the amount of data needed for the network model learning process which is an advantage over the cross validation approach if a complete dataset of input and target values are limited due to data gaps for instance by adding a penalty algorithm to the network optimization bayesian regularization also circumvents potential over adjustment to the training data for that purpose the error function is enhanced to search for the minimal error using minimal weights to incorporate the number and sum of weights as an optimization goal a term is added to the error function to quantify the following mean sum of squares of the network weights e w eq 2 here wj is the j th element of the weight vector w of length n and α and β are performance function weight parameters between 0 and 1 2 e w 1 n j 1 n w j 2 where wj is the j th element of the weight vector w of length n this leads to a weighted error function or cost function f as given in eq 3 3 f α e w β e with α β 1 with α and β referring to performance function weight parameters that exhibit values between 0 and 1 the sum of the network weights is constrained by reducing the number of effective weights to an optimized number that allows the network to fit the inputs to the training targets while also limiting network complexity this makes the network s response to the presented inputs smoother and the network less prone to over fitting thereby improving its performance when confronted with new data during later application of the network the cost function weight parameter β in eq 3 sets the emphasis of the training algorithm towards reducing the network error term e whereas increasing the weight parameter α emphasizes reducing the sum of the weights integrated over all network neurons the minimization of the network errors i e minimization of the cost function eq 3 was achieved using the lm optimization algorithm as implemented in matlab r2019b combining the gradient descent method and the gauss newton minimization algorithm the lm method was used as the iterative numerical standard approach to solve non linear minimization problems further details can be found in marquardt 1963 or butenko and pardalos 2014 the adaption of the network weights during the lm iteration and the search for the optimal number of active weights were regularized using a bayesian approach by optimizing the cost function weight parameters α and β following mackay 1992 the posterior of the probability density function was maximized applying bayes rule 4 p d α β m p d w β m p w α m p w d α β m here d is the available dataset with inputs and targets m is the network model and w is the vector of neural network weights after substitution and some transformations foresee and hagan 1997 the values for the weight parameters at the minimum of the cost function were estimated 5 α mp μ 2 e w w mp and 6 β mp n μ 2 e w mp 7 with μ n 2 α mp t r h mp 1 here tr is the trace of the inverse hessian matrix h at the minimum point mp of the cost function and µ is the minimized effective number of parameters in the optimized network that are effectively used to minimize f further details about the bayesian regularization method can be found in burden and winkler 2009 as the first data series to train a model the vwc series with the least amount of data gaps was chosen as it provides the largest training dataset once the first data series was gap filled the same data series was added to the set of complete data series used as input for the next network model the procedure continues such that data series with increasingly large or numerous gaps and a decreasing amount of training data can be gap filled with an increasingly large pool of complete data series that are used as input for the new network model following this approach the smaller number of target data available for training a specific network is compensated for by providing more and more mathematically related gap filled variables as input to model the entire 2318 days of measurements however as more gap filled vwc time series become available for input series the number of inputs can reach a point beyond which the performance of the network for a specific target series declines instead of adding useful information the correlation between measured and modeled test data starts to decrease this undesirable consequence is caused by the increasing dimensionality of the cost function to be minimized eq 3 which makes finding the global error minimum more difficult e g bengio and bengio 2000 bishop 2006 hence while the best combination of input variables must be found to provide as much useful information as possible incorporating redundant or inadequate input variables in the optimization process must simultaneously be avoided recent studies have demonstrated successful solutions to this problem with deep learning neural networks by effectively sorting out and neglecting obstructive input as part of the learning algorithm poggio et al 2017 scardapane et al 2017 hutzenthaler et al 2020 however training a deep neural network is time consuming computationally expensive and requires a very large number of training data cases that are not always available as was the case for the panther creek vwc measurements therefore a machine learning classification of the input variables using som networks was instead combined with a consecutive k means clustering clustering the site data ensured that in the following step time series chosen as inputs for a distinct target time series were only selected if they exhibited similarities in all 4 soil parameters i e soil temperature and soil moisture at two depths 5 and 50 cm 2 2 3 self organizing map for cluster based input selection som neural networks with gaussian distance functions e g kohonen 1998 kohonen 2001 were deployed to cluster the datasets containing soil temperature and soil moisture at all 33 sites over the 6 year measurement period som networks can be used as an advanced cluster analysis tool because they can recognize similarities of presented input vectors e g kohonen 1990 patterson 1996 haykin 2009 soms have been successfully applied in various scientific disciplines to recognize patterns in large or high dimensional datasets e g wang et al 2001 ghasemi et al 2009 murty et al 2009 schmidt et al 2016 chen and huang 2020 a som adapts its spatial structure during an unsupervised learning procedure and learns to recognize the distribution of a given input dataset as well as its topology in the high dimensional input space kohonen 2001 du 2009 in the panther creek application euclidian distances between 4 dimensional input values soil temperatures at a depth of 5 and 50 cm and vwc at the same two depths are mapped to a two dimensional 2d plane results can be quantified and visualized through a 2d neighbor distance map on which the distances inversely represent the similarities of all components of the original data records presented to the som network every neuron in the map grid layer is connected to a weight vector that can be adjusted to the input data during each iterative learning step all input vectors are transferred in a random order to all neurons in the map grid for each input vector x presented to the network the competitive learning procedure determines the neuron with a weight vector w that is nearest to the current input vector based on this principle the winning neuron can be determined by finding the minimum of the euclidian distance d between the input and all weights in the n 4 dimensional input space eq 8 with 8 d min min x w j min n x n w jn 1 2 after that only the weight vector of this winning neuron and the weights of its neighbors in a pre defined range are updated and shifted closer towards the respective input vector as a consequence the activation of the adapted neurons will be higher if a similar input is presented to the som during the remaining learning epochs the input vectors are partitioned into k clusters and the cluster centers are set to represent the best center i e the best centroid in the multi dimensional space for the respective cluster the algorithm iteratively determines the minimum of the sum of squares clustering function j given as 9 j k i s k w ik 1 n k i s k w i 2 the second term in eq 9 gives the mean of the data subset sk with nk elements building the cluster k bishop 2006 at the end of this clustering procedure each weight vector w is assigned to the cluster center that is nearest a radial basis distance function in our case a gaussian function with center c and a defined width of its basis can be used as representative of the cluster in contrast to a k means clustering e g mcqueen 1965 likas et al 2003 both the winning neuron and its neighbors are updated in a defined range during the som learning procedure this neural interconnectivity gives the som a better ability to recognize similarities among datasets that show a large variety and range compared to the k means clustering algorithm clare and cohen 2001 the strength of the final neighbor connections between the neurons in the map layer are defined by distances between their weight vectors in the input space or feature space kohonen 1990 tavan et al 1990 the update of the weight vectors w j after epoch l is given by 10 w j l 1 w j l η l ϕ l x l w j l where η is the learning rate with which the weight vector values are iteratively adjusted the learning rate η and the value of the neighborhood range function ɸ l decrease with increasing l mulier and cherkassky 1994 following the exponential expression in eq 11 11 η l η start η end η start l l max the initial and ending learning rates are set to achieve a coarse sorting of the input data at the beginning of the learning process and a fine tuning of the center positions during the final epochs the cluster centers found through the som are then further aggregated into the final clusters by a subsequent k means algorithm due to the neural interconnectivity between neighboring nodes the som provides a better recognition of similarities in datasets with smooth boundaries in variable space e g vesanto and alhoniemi 2000 clare and cohen 2001 schmidt et al 2011 moreover because the pre clusters assorted by the som are local averages of the data the clustering of pre clusters found by an som is less sensitive to random variations than the clustering of the original data vesanto and alhoniemi 2000 while most cluster validity indices maximize the inter cluster distances and minimize distances between the points within a cluster the calinski harabasz validity index calinski and harabasz 1974 has been shown to be one of the most robust indices for finding the optimal number of clusters maulik and bandyopadhyay 2002 furthermore the calinski harabasz validity index performs well when clusters overlap saitta et al 2008 which was the case for our data accordingly calinski harabasz validity indices were calculated to determine the optimal number of final clusters for soil temperature and vwc the machine learning supported data gap filling procedure is schematically summarized in fig 5 to illustrate the multiple steps included 3 results and discussion 3 1 modeling of missing meteorological data in addition to vwc data records meteorological data from the mega station were used as input yet the hmp 45 relative humidity rh sensor was affected by technical issues during the latter period of measurements june 2015 to september 2018 which led to data gaps and outliers thus prior to using the mega station data as additional input for the vwc network models we gap filled the rh values of the mega station by training a neural network using meteorological data from two weather stations in the region operated by the national weather service gap filling step 1 in fig 5 in particular we used air temperature and relative humidity from weather stations in hillsboro 45 541 north 122 950 west and mcminnville 45 195 north 123 136 west to train a neural network and reproduce rh as measured by the mega station in the vicinity of plot 5 furthermore the air temperature values at the mega station were utilized resulting in a total of 5 input variables available for the training the applied network had 10 neurons in the hidden layer and no backward time interval for the input vector was used panel a of fig 6 shows the regression and the coefficient of determination for the test dataset providing a high confidence for the gap filled rh results the course of the rh values modeled by the network follows the measured values closely for the first half of the period with measured data for comparison and model training available the gap filled simulated values show a clear seasonal pattern and consistently remain in the physically reasonable range with a cutoff at just below 100 relative humidity and a lower boundary range of roughly 20 relative humidity as observed at the site in previous years and typical for the region fig 6b 3 2 som clustering of potential input variables in order to enhance the data pool 2 hourly records october 2011 through february 2016 of soil temperature and corresponding soil water content at two depths were used for the plot clustering procedure to cluster the 4 dimensional data records consisting of soil temperature and vwc at 5 cm and 50 cm depth respectively a som was applied with 49 nodes which work as preliminary clusters arranged in a 7 7 hexagonal neuron grid fig 7 for the som network used in this study the learning rate at the beginning was set to ƞ start 0 9 and the minimum learning rate to ƞ end 0 05 while the number of reiterations of the input vector presentations to the network was set to l max 2000 eq 11 after the som algorithm reduced the dimensions from the higher dimensional input space to the 2 dimensions of the map plane the distances between the som neurons i e pre clusters were visualized on a map with darker colors indicating large distances i e large differences between the cluster values whereas brighter colors indicate similarity it is noticeable that the dataset was separated in several groups continuous yellow orange areas indicating similarities for all 4 variables whereas several nodes and groups of nodes are separated by large distances clearly separating the combinations of temperature and vwc grouped within the yellow data agglomeration zones fig 7 after the som data agglomerations were formed a k means clustering of the network neurons centers were conducted to obtain the final clusters of the soil data vectors the k mean algorithm using 2000 iterations and 500 replicate runs each were run using varying initial cluster centroid positions a maximum value for the calinski harabasz validity index was found for a number of 2 final clusters as a result each of the 33 plots was assigned to the cluster to which the majority of its soil temperature and soil moisture data vectors were allocated fig 8 during the following training of the dtdnn networks the input data for a specific plot were chosen from plots that belonged to the same cluster to provide the most efficient information for the network preselected by the clustering procedure based on machine learning the spatial distribution of plots and their corresponding cluster assignments in fig 8 show no simple pattern that could be explained by similarities of topographic features at the plot locations this indicates a more complex distribution of soil temperature and soil moisture conditions upon which the clustering was based in addition to the complex topography at the site the distribution of soil moisture and temperature at the two monitored depths was also influenced by other parameters such as the composition and structure of the soil matrix and the intensity of evapotranspiration which in turn could be affected by stand structure this underscores the usefulness of applying the clustering procedure prior to choosing input variables as is the case with this dataset geographic plot proximity may often be less useful than other factors in relating target and input variables som neural networks are solely data driven and capable of recognizing multivariate data stream similarities using an unsupervised learning algorithm kohonen 2001 hence matching sample points through recognition of similar patterns in their associated data series avoids unnecessarily noisier modeling of multivariate and complex functional interdependencies with the entire dataset or datasets that include unaccommodating data 3 3 modelled time series of volumetric water content after preparing and assigning the required input data a specific dtdnn model was trained with bayesian regularization for each vwc time series affected by data gaps by iteratively increasing the number of input delay time steps the model with the lowest mse for the test data was chosen to reproduce and eventually fill the gaps in the respective time series once filled a vwc time series regardless of measurement depth was added to the potential input data pool if the resulting performance of the network increased the length over which a network model can fill data gaps reliably depends on the conditions represented in the available training data if the training data provide sufficient cases that account for the seasonal changes in the dependencies of the input and target values the model can learn those varying dependencies accordingly hence target values can be modeled over long periods of time with low errors despite varying meteorological conditions in years with long data gaps using a measurement network as in this study the richness and length of available correlated training data allow for sufficient model performances even if data gaps are several years long nevertheless the vwc time series at 50 cm depth at plot p102 was so heavily affected by instrument malfunction and outliers that not enough reliable data were left to train a dtdnn model demonstrating the limitations of our solely data driven machine learning approach the results for the gap filling procedure and information about the applied network topologies and input used for each of the modeled time series are summarized in table 1 the correlation coefficients r test refer to the test dataset used to show the actual network performance when confronted with new data an average correlation coefficient of r test 0 95 min r test 0 81 max r test 0 99 for all available measured and all corresponding network modeled test data subsets was achieved using the individually trained neural networks the rmse mse½ for the test dataset equals 0 04 cm3 cm3 and indicates very small overall deviation of modeled from measured values the addition of preceding time steps of input data increased the performance of the models in 69 of the cases table 1 δt 0 the high correlation coefficients in combination with the low mse values indicate a reasonably low uncertainty for the resulting gap filled vwc time series when used in further analyses in addition to the correlation coefficient referring to the test data the coefficient r all gives the correlation between all available data records and the corresponding network modeled results the high values show that the functional relation between the input variables and the target variable is simulated closely by the respective network models even though the model results exhibit high correlations and low mse when compared to the measured reference data we also analyzed how well the modeled time series simulate the behavior of the measured values for this purpose we performed a cross comparison of the coefficients of determination for the measured and the modeled time series if the modeled time series resemble the behavior of the measured time series over time the coefficients of determination for the regression of any pair of time series should remain stable hence we compared the r 2 values for each data pair as compared in section 2 1 fig 3 before and after all gaps were filled with modeled data fig 9 the combination of dtdnn and som artificial neural networks delivered results that reproduced the mathematical relation between the measured time series with small deviations the cross comparison shows that 70 of the vwc time series pairs analyzed show less than 10 difference for the coefficients of determination for the 5 cm time series fig 9a for vwc at 50 cm soil depth 89 of the combinations show less than 10 deviation between the coefficients of determination of the original series and post gap filling series fig 9b after removing the time series with low measurement data coverage at plots 209 and 312 the percentages of time series with less than 10 difference increase to 81 5 cm and 95 50 cm respectively the noticeably altered relations between the vwc values at 5 cm depth at plot p312 fig 9a and most vwc time series at other sites are due to the fact that only 4 9 measured data were available over the study period fig 2 therefore relationship between measured data at this plot with all other measured data in fig 3 are based on data of only a few periods at p312 in contrast the majority of the statistics shown in fig 9 are based on the functional relations of a much larger sample covering various meteorological conditions over the 76 month study period that are not found in the measured data therefore we cannot place as much confidence on the r 2 values derived from the few measured data and the corresponding long term soil moisture estimates at this plot and depth the same conclusion similarly applies to the vwc data at the 50 cm depth in plot p209 fig 9b where only 22 2 of the time series were available as measured values fig 2 in order to assess the overall soil moisture conditions for both depths monitored at the panther creek plots we calculated the monthly averages over all 33 plots for the entire period with completed vwc time series available from may 2012 through september 2018 after gap filling this allows examining the saturated and dry conditions at these mesic sites over the years the dry summer conditions of 2015 and 2018 in the region determined through the corresponding palmer drought severity index pdsi for the study area in july fig 11b is reflected in the lowest average values for vwc at 5 cm and 50 cm in those same years at the panther creek plots fig 10 moreover the higher average soil moisture values during the winter period of the year 2017 for both soil depths fig 10 are also in agreement with the respective pdsi values for january at the panther creek site fig 11 a those soil moisture conditions averaged over all plots provide a quantitative assessment of the general conditions that govern the range of values found at the individual plot locations and hence agree well with general indicators such as the pdsi with a 4 km x4 km spatial resolution taking advantage of the high density of plots in the area we spatially interpolated seasonal patterns of soil moisture extrema in particular we calculated the summer july august and september minima and winter december january and february maxima of vwc at all sites for both soil depths using monthly averages a natural neighbor interpolation method for discrete spatial data points sibson 1981 was applied to spatially interpolate the monthly values for the area covered by the plots fig 12 shows the vwc extremes for the study area based on summer and winter averages over the 76 months of data a general west east gradient is visible interrupted by higher values during summer in the central area between plots p106 p309 and p311 especially for vwc at a 50 cm depth fig 12b the three plots are all members of the same cluster 1 fig 8 this specific area also exhibited higher soil moisture maxima during winter at the 50 cm soil layer fig 12d this feature corresponds to an elevational extension of the valley that forms relative orographic basins corresponding to the headwaters of silver creek fig 8 in addition the higher winter maximum around plot p313 fig 12c overlaps with the outer boundary of the mountain range where the surface slopes towards the bed of panther creek this orographic feature is associated with increased surface water runoff during the rainy winter season the maximum area is also visible for the 50 cm soil depth during the winter months although on an elevated level fig 12d while these seasonal extrema are at least in part associated with orographic conditions other spatial values are not as obviously linked to the macro topography of the surrounding landscape the summer minimum near plot p302 at a 5 cm depth includes a larger area than the more localized minimum vwc for the 50 cm depth fig 12a and b this localization is also apparent for the winter maximum at plot p302 at a 50 cm depth classified as 0 25 0 32 cm3 cm3 which is rather low relative to the surrounding areas fig 12d located within an orographic basin near the panther creek bed increased soil moisture values in winter and summer might be expected all else being equal however other potential factors such as soil depth texture and structure subsurface flow patterns and rate of summer evapotranspiration attributable to local vegetation structure would also change the local pattern of soil moisture further analyses that consider differences in stand age stand density total leaf area and spatial distribution of leaf area and their influence on evapotranspiration rates are needed to fully understand the spatiotemporal soil moisture patterns at this research site containing uniquely dense spatial soil monitoring the results of this study provide the completed multi year time series of vwc data to support respective studies of spatiotemporal patterns in forest productivity 4 summary and conclusion soil parameters including volumetric water content were measured at the panther creek site located on the eastern slopes of the oregon coast range the resulting dataset comprised virtually continuous measurement of soil moisture and soil temperature at 5 cm and 50 cm depth at 33 plots over more than 6 years compiled into daily averages the majority of the vwc time series were affected by often substantial data gaps we therefore applied dtdnn neural networks which are particularly well suited for time series simulation to plots that were first grouped by their relative similarity in combined soil moisture and temperature series at the 2 monitored depths similarities of plot specific datasets were assessed through a machine learning approach combining a som neural network and a succeeding k means clustering procedure the models were applied to fill gaps in the vwc series among the 33 plots within the 2 260 ha study site our results show the high performance of the network models that can capitalize on the data richness i e long time series at high spatial density besides being able to learn and simulate any functional relation between the input and the target variable the machine learning approach has the advantage of being completely data driven hence no functional assumptions are required when relations between multiple sites and soil depths are not known instead of searching for correlations in the data prior to finding a model the data are used to develop and optimize models through the network training procedure including data records prior to the date of a missing observation helped to improve the results for 69 of the models an average correlation coefficient of 0 95 and a rmse of 0 04 cm3 cm3 were achieved for measured and modeled time series subsets that had not been used in the learning process moreover the functional relation between measured time series at various plots was retained by the modeled data by removing extreme cases that had too few measurements to determine a r 2 that is representative for 6 years of data 81 of the 5 cm vwc data and 95 of the 50 cm vwc data show less than 10 difference between the r 2 values prior to and after the gap filling spatially interpolated extreme values during summer and winter both show parallels with the topographic conditions that influence rain water runoff and aggregation at the site furthermore results averaged over the plots clearly correspond to the palmer drought severity index for the region reflecting the soil moisture effects of dry summers and wet winters accordingly however because the method is exclusively data driven a sufficient amount of data is needed for each model to acquire stable mathematical representations that generalize the functional relation between the inputs and the target variable and hence acceptable model performance as was the case for at least one time series in our system this learning data requirement demonstrates the limit of the dtdnn approach as opposed to a process model with pre defined functions nevertheless high model performances and low errors show the suitability of the applied machine learning approach for time series of soil moisture particularly for a spatially dense measurement network that provides an applicable array of interrelated data this robust method can therefore be applied to similar situations where data gaps impede a full utilization of data collected at several locations that share similar driving environmental conditions credit authorship contribution statement andres schmidt conceptualization formal analysis software writing original draft validation methodology doug mainwaring resources investigation writing review editing data curation doug maguire funding acquisition investigation project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the bureau of land management u s department of the interior for financing this study through assistance agreements l11ac20051 l14as00038 l14ac00134 and l16ac00348 
5307,the variable infiltration capacity vic model is a widely used distributed hydrological model however vic is computationally expensive in hydrologic prediction or forecast which needs tens of thousands of runs of the model to alleviate the burden of computation and reduce the losses of model fidelity a new surrogate model sm coupling the self organizing map and k means clustering algorithm skc with long short term memory network lstm is proposed skc is utilized to divide the subwatershed and select the representative cells in each subwatershed lstm is used to simulate the streamflow with the runoff of the representative cells the new model is successfully applied in the upper brahmaputra river ubr basin southeast china the results show that the sm simulated streamflow has little difference from the vic simulated streamflow in terms of the nash sutcliffe coefficient efficiency the main metric of sm performance 0 9677 at yangcun station and 0 9696 at nuxia station for the representative cells sm retains partial spatial information of the runoff in the study area the computational savings achieved through the use of sm are over 97 with only slight losses of accuracy in the application to the ubr basin keywords surrogate model variable infiltration capacity model long short term memory self organizing map 1 introduction the variable infiltration capacity vic hydrological model liang et al 1994 is one of the distributed models applied to the areas above a critical scale taken to be about 10 km2 typically maurer et al 2002 the distributed hydrological model shows its strong advantages of studying the spatial variability of hydrological response to climate and land use changes chen et al 2018a and making full use of spatial nonuniformity of precipitation and land surface condition on hydrologic processes numerous studies have applied vic successfully in different domains such as runoff forecasts mo and lettenmaier 2014 schumann et al 2013 climate change impacts on hydrology lu et al 2018 wang et al 2018 water resources assessment sridhar et al 2019 reservoir operation wang et al 2019 and groundwater assessment niu et al 2019 etc however in the operation of the distributed model in particular when applied to hydrological prediction or forecast it takes much or equivalent time in parallel computation to solve partial derivative equations with numerical computation methods one grid cell by one liu et al 2017 especially in cases with high resolutions and consideration of energy balance where the frozen soil lake and snowmelt modules are utilized liu et al 2019 in the hydrological forecast one of the most common applications of vic the rolling process chen et al 2016 is usually adopted which means that the streamflow is forecasted beginning with rolled over initial time extending into the future with a given forecast period therefore the hydrological model will be operated hundreds of times to generate hundreds of forecast streamflow members slater and villarini 2018 tuteja et al 2019 this procedure is computationally expensive so it is very necessary to accelerate the model operation and alleviate the burden of computation to improve model computing efficiency better computational power is always at one s disposal slater and villarini 2018 tuteja et al 2019 which is usually along with the parallel computing technology lin et al 2019 perkins et al 2019 apart from simply buying a faster computer or using a supercomputer surrogate model sm maier et al 2014 razavi et al 2012 is an effective method there are two main ways to construct sms the first one is by building the response surface kleijnen 2009 ignoring the internal mechanism of the physical models which is often used to optimize model parameters behzadian et al 2009 gong et al 2016 kourakos and mantoglou 2009 yan and minsker 2011 yazdi et al 2019 the other way is by reducing the fidelity of the simulation to make the model cheaper to run by means of using coarser spatial or temporal grid size smith 2013 reducing model order siade et al 2010 ushijima 2018 zhang et al 2020 and utilizing lumped or empirical model xing et al 2019 zhang et al 2016 the studies mentioned above are almost planned for groundwater and parameter optimization seldom surrogate models have been used for hydrological models such as vic in the field of runoff simulation as vic is a gridded hydrological model it can be effective to accelerate the model operation by reducing the number of grid cells to be calculated apart from enlarging grid sizes one practicable way is to classify these grid cells according to their geographical conditions and runoff features and then to pick out one cell from each classification as the representative cell the self organization map or the self organizing neural network som kohonen 1982 1997 an unsupervised learning network is considered to be a well performed classification and clustering algorithm and widely used in hydrological regionalization chen et al 2018b haselbeck et al 2019 ley et al 2011 razavi and coulibaly 2017 rivas tabares et al 2019 wallner et al 2013 xu et al 2016 which can cluster complex data sets without specifying the number of clusters nourani et al 2013 in practical applications of the vic model some additional routing models such as lohmann s model lohmann et al 1996 1998 the rvic routing model hamman et al 2017 the routing application for parallel computation of discharge rapid david et al 2011 etc are usually used to converge runoff in all grid cells upstream into an output point however these routing models hardly operate when the runoff in some grid cells is absent artificial neural networks ann can solve this problem to a large extent although there are seldom studies on the synthetic method of som and ann in the domain of sm this combination has been applied successfully in rainfall runoff forecasting nourani et al 2013 and groundwater level forecasting nourani et al 2015 the deep learning models are developed based on artificial neural networks ann which has a similar structure with traditional ann but utilizes a more advanced training method called layer wise training to overcome the shortage of gradient diffusion in ann goodfellow et al 2016 the long short term memory lstm hochreiter and schmidhuber 1997 as one of the deep learning models is dedicated to dealing with the time series fang et al 2017 le et al 2019 seo et al 2015 zhang et al 2018 in this study we focus on developing a new surrogate model for vic there are three goals to be achieved 1 to reduce the computation efforts in the operation of vic with the deep learning methods 2 to improve the accuracy of the surrogate model and reduce the losses of fidelity from the vic model 3 to still keep partial spatial information from the vic model 2 method 2 1 hydrological model the variable infiltration capacity vic macroscale hydrological model was originally developed by liang et al 1996 1994 at the university of washington the vic model is a grid based distributed hydrological model in macro scale where runoffs in grid cells are calculated independently and do not have to communicate laterally in this study the vic model of version 4 2 d is operated at a 6 hourly time step in both water and energy balance models with a spatial resolution of 0 25 0 25 the snow andreadis et al 2009 bowling et al 2004 and frozen soil cherkauer and lettenmaier 1999 cherkauer et al 2003 algorithms are active which can represent the effects of seasonal changes in the weather of a cold land on surface water and energy fluxes however in the current vic model glacier simulation is absent in our work a new glacier module is added due to limited observations glacier melting is simulated by a temperature index model in this glacier module we assume that the glacier melts from the snow pack and leaves this part of water out of the water equivalent chen et al 2017 su et al 2016 zhang et al 2013 the glacier melting water within cell i gi is calculated as follows 1 g i f i d f t i i f t i t melt 0 i f t i t melt where fi is the glacier area fraction in cell i df is the degree day factor for glacier mm 1 day 1 ti and tmelt are the daily mean air temperature and the minimum temperature when the glacier melts respectively the model itself does not include any routing process therefore the routing model from lohmann et al 1996 1998 is employed in our work which is a source to sink model to solve linearized saint venant equations 2 2 surrogate model 2 2 1 self organizing map and k means clustering algorithm the self organizing map som is an unsupervised artificial neural network originally proposed by kohonen 1982 and kohonen et al 1996 which can explore the unlabeled high dimension input data and group the similar data into a low dimensional output layer in our study two dimension topology with hexagonal lattice is utilized as the output layer which consists of k neurons the input data set x consists of n m dimension vectors and each input vector is connected to each neuron of the output layer the number of map nodes k is chosen by the heuristic formula k 5 n clark 2018 and fixed during the whole learning process wallner et al 2013 the steps of the som training are as follows step 1 set the prototype vectors m m 1 m 2 m 3 mk randomly or linearly where mi is a n dimension vector step 2 select the input vector xj to calculate the distances to each prototype vector mi the neuron which has the smallest euclidian distance with the input vector xj is called the best matching unit bmu step 3 update bmu and its neighboring neurons with eq 2 2 m i m i α h ci x j m i where α is the learning rate factor hci is the neighborhood kernel and the gaussian function is used in our study the detailed descriptions of the neighborhood kernel can be found in clark 2018 step 4 repeat step 2 and 3 until all the input vectors are considered and the iterations reach a specific number in our study the batch training is utilized which sends all input vectors to the map for weight adjustment at once to ensure the adequate model performance of som the number of iterations is set as 1000 som itself is a clustering method which has been applied widely in hydrological regionalization studies agarwal et al 2016 chen et al 2018b gao et al 2018 and watershed classification ley et al 2011 razavi and coulibaly 2017 however it is not easy to distinguish the clusters of som visually for there are no distinct cluster boundaries in the results as a result the k means algorithm vesanto et al 2000 is utilized to group the similar units of the som further the input data set for the k means algorithm is bmus from som and the number of clusters k is given as a priori value the davies bouldin index dbi davies and bouldin 1979 is the criteria to evaluate spatial clustering performance with eq 3 in our study k ranges from 2 to k pacella et al 2016 where k is the number of bmus the k means algorithm is run multiple times to select the value of clusters k when dbi reaches the minimum value 3 dbi k 1 k k 1 k max k l δ s k δ s l δ s k s l where δsk and δsl are the within cluster distances and δ sk sl is the between cluster distance in our study dbi is used as the criteria to evaluate spatial clustering performance fig 1 indicates the procedure of the two phase clustering algorithm based on the som and the k means cluster skc 2 2 2 long short term memory the long short term memory lstm network is a special kind of recurrent neural network rnn solving the vanishing gradient problem caused by the backpropagation with the specially designed units called gates and memory cells shen 2018 the gates decide the information to forget and that to remember in the lstm network and avoid error signal to decay over long time steps tian et al 2018 the work of kratzert et al 2018 indicates that lstm is more suitable to predict the streamflow for lstm can memorize such a long period of sequences to consider the impact of groundwater snow or even glacier storages while the traditional rnn works ineffectively when the length of sequences is over 10 bengio et al 1994 lstm was first developed by hochreiter and schmidhuber 1997 and becomes one of the most widely used tools in the sequential data modelling domain with the development of the deep learning technology zhang et al 2017 as one of rnns lstm also processes sequential data in a recursive form the lstm recurrent networks have lstm cells where the cell state and the hidden state are memorized and updated through three gates i e input gate forget gate and output gate fig 2 shows the schematic diagram of lstm the cell state c t and the hidden state h t at time step t are shown as follows 4 c t g t i t c t 1 f t h t σ c c t o t where i t f t g t and o t represent the input gate the forget gate the cell candidate and the output gate respectively which are described in eq 5 σc is the state activation function denotes the element wise multiplication of vectors 5 input gate i t σ g w i x t r i h t 1 b i forget gate f t σ g w f x t r f h t 1 b f cell candidate g t σ c w g x t r g h t 1 b g output gate o t σ g w o x t r o h t 1 b o where σg is the gate activation function wi wf wg and wo are weights for the input ri rf rg and ro are weights for the recurrent output bi bf bg and bo are biases in our work σg and σc are set as the sigmoid function and the hyperbolic tangent function tanh respectively 2 2 3 surrogate model based on skc and lstm the surrogate model for vic is based on skc and lstm where skc is used to redistrict the drainage area according to the hydrological characteristics and the natural geographical conditions and lstm is utilized to simulate the streamflow with the data from the representative cell of each subwatershed divided with skc the surrogate model for vic is shown in fig 3 and described as follows step 1 data preparation the vic model is operated first and the runoff evaporation baseflow etc in each grid cell are simulated during the training period specified in our work we mainly focus on runoff simulation the simulated streamflow of outlet hydrological stations in the watershed is calculated with the routing model step 2 hydrological regionalization in this step the representative cells are chosen a representative cell is defined as a cell which yields a value representative of all the cells with the similar runoff features a the watershed is divided into n gird cells in each of which a series of runoff is simulated by vic the correlation coefficients cc are used to measure the similarity of the runoff features between the two cells cc is described as 6 p ij cov r i r j var r i v a r r j 0 i j n where ri and rj are the runoff series in the ith and jth cells cov and var are the covariance function and the variance function when i is equal to j pij is equal to 1 b the property vector pi pi 1 pi 2 pin is used to describe the runoff feature of the ith cell which shows the runoff similarity between the ith cell and any of the cells c the n property vectors are used as the input samples for clustering with the skc the cell with the nearest euclidean distance to the cluster center is selected as the representative cell in the corresponding cluster area step 3 surrogate modelling there are n representative cells acquired in step 2 the runoff series of these cells are used as the input samples of the lstm and the streamflow series of the outlet stations in the basin are the output targets of the lstm in this work the lstm is trained with the adam optimization algorithm kingma and ba 2014 with the maximum training epochs of 250 the trained lstm is used to predict the streamflow of the outlet stations instead of the vic during the prediction testing period first the runoff series of representative cells during the prediction period are calculated with the vic second the lstm is operated with these runoff series as the input data 2 3 model performance metrics to evaluate model performance several widely used evaluation metrics are utilized in our study which are the nash sutcliffe efficiency nse nash and sutcliffe 1970 relative bias bias kling gupta efficiency kge gupta et al 2009 and the root mean square error rmse the formulas of nse bias and rmse are defined as follows 7 nse 1 i 1 n q o i q s i 2 i 1 n q o i q o 2 bias i 1 n q s i q o i i 1 n q o i rmse 1 n i 1 n q o i q s i 2 where n is the length of the daily runoff series qo i and qs i are the observed and simulated daily flows of the ith day respectively q o is the mean value of the observed daily streamflow the kge consists of three parametric components i e the correlation coefficient of the observed and simulated streamflow the variance bias and the total volume bias the formula is shown as following 8 kge 1 r 1 2 μ s μ o 1 2 σ s σ o 1 2 where r is the correlation coefficient of two compared streamflow series μs and σs are the mean values and the standard deviation of the simulated streamflow μo and σo are the mean values and the standard deviation of the observed streamflow 3 case description 3 1 study area the surrogate model proposed is applied in the upper brahmaputra river ubr basin to investigate its role and efficiency the ubr is the longest plateau river in china originating from the jiemayangzong glacier at an elevation of 5590 m above sea level located on the tibetan plateau fig 4 the drainage area above the nuxia hydrological station is approximately 2 105 km2 with a mean altitude over 4000 m the precipitation with an average annual value of about 560 mm in the ubr basin changes only slightly interannually which is concentrated during the period from june to september the perennial snow and glacier are distributed in the upper lower reach and the southern regions where the himalayas mountain is located liu et al 2019 average annual temperature in the basin is about 6 27 with the highest temperatures in a year occurring in june and july and the lowest in january which means that a large amount of the glacier and snow melt water is always accompanied with a large amount of precipitation in the ubr basin the precipitation controlled by the indian summer monsoon the snow melt water and the glacier melt water make the major contribution to the streamflow chen et al 2017 you et al 2007 3 2 data the precipitation data used in our work is the china gauge based daily precipitation analysis cgdpa shen and xiong 2016 which is gridded daily precipitation with the resolution of 0 25 0 25 based on the observed daily precipitation in about 2400 gauge stations over mainland china and the optimal interpolation method xie et al 2007 the gauged meteorological data including daily maximum and minimum air temperature wind speed relative humidity and atmospheric pressure were collected from 25 national meteorological observatory stations located in and around the ubr basin as shown in fig 4 red stars these gauged meteorological data were interpolated into 0 25 0 25 with the inverse distance weighted method idw coupled with elevation based lapse rates setting as 0 6 mm km for precipitation and 6 5 km for temperature cuo et al 2014 the daily streamflow series of the two outlet stations i e yangcun station yc and nuxia station nx were utilized for calibrating and validating the vic model and training and testing the surrogate model the calibration and validation period for vic are 2000 2007 and 2008 2010 respectively to prove the predictive ability and robustness of the proposed surrogate model an extra period from 2011 to 2015 is used as the testing period while the training period for sm is 2000 2010 the digital elevation model data with 90 m resolution was from national aeronautics and space administration shuttle radar topographic mission harmonized world soil database hwsd version 1 1 fischer et al 2008 in a resolution of 1 km was adopted as the soil data set in the vic model the landcover data set used in our work was westdc landcover data set version 2 0 ran et al 2010 in a resolution of 1 km in the year of 2000 3 3 lstm inputs the runoffs of the representative cells at the current time step and their lagging information are used to simulate the streamflow of yc and nx stations considering the influence of the glacier and snow the lag window is up to 15 days as a result the inputs for simulating current daily streamflow of a gauge station consist of three parts i e the previous runoff of the representative cells the current runoff of the representative cells and the previous streamflow of the gauge station as shown in table 1 several different sets of model input and output structures are used to obtain the appropriate structure of the model model 5 in table 1 is a control group to build the surrogate model with the precipitation in the representative cells instead of the runoffs 4 results 4 1 results of the vic model the daily streamflow at yc and nx was simulated by vic with the parameters optimized by ε nsga ii kollat and reed 2006 liu et al 2017 table 2 presents the evaluation indicators of streamflow at yc and nx it shows that there is a good efficiency at yc with nse of 0 8886 kge of 0 8832 bias of 0 0255 and rmse of 424 17 for calibration and 0 9121 0 9102 0 0415 and 356 64 for validation similar results at nx are also shown in table 2 it can be seen that the streamflow simulated with the vic model performs very well which can be used for the surrogate model 4 2 selection of representative cells fig 5 shows the cc of runoffs simulated with the vic model in pairwise cells a point whose position is denoted as i j represents cc between the runoff series in cell i with that in cell j where the different colors linked to different values of cc a line of points denoted as row i shows the phase property of cell i which means that the runoff feature in cell i is similar to some cells and different from other cells as shown in fig 5 each color bar represents the phase property of a cell in most cases adjacent color bars are similar which also indicates that these cells are close to each other and have similar hydrological conditions however color bars of some grid cells for instance cells around cell 50 cells around cell 85 and cells around cell 125 are distinguished from other grid cells it may be related to the distribution of glacier and perennial snow a som with 11 by 8 nodes was applied in this case the u matrix in fig 6 was obtained after the application of som to the ubr basin the color of the u matrix represents the distance between neighboring neurons from the u matrix the neurons on the upper right corner have small distances to each other and so do those on the lower left corner therefore there are two clearly different clusters on the upper right corner and the lower left corner besides it is critical that the neighboring neurons on the upper left corner which have large distances to each other separate the clusters as the boundaries however there is no clear and visual separation between the clusters in the u matrix from som as a result the k means algorithm is utilized to cluster the results of som further there are 88 bmus generated from som and the number of clusters in the k means algorithm ranges from 2 to 10 fig 7 a shows the values of dbi in changing cluster numbers when the number of clusters is equal to 6 the value of dbi gets to the minimum as shown in fig 7 b the different colors are used to mark the different clusters of the bmus obtained by som to verify the clustering results cc of runoffs between any two cells within clusters were calculated as shown in fig 8 cc in cluster 3 cluster 4 cluster 5 and cluster 6 are larger than those in cluster 1 and cluster 2 there are 97 58 cells in cluster 3 62 44 cells in cluster 4 99 82 cells in cluster 5 and 58 23 cells in cluster 6 with cc larger than 0 7 and 98 59 and 99 06 cells in cluster 5 and cluster 6 respectively with cc larger than 0 5 this illustrates that the runoffs of the cells within clusters except cluster 1 and cluster 2 have strong correlations the runoff correlations between two cells within cluster 1 and cluster 2 are weak which means that the cells in cluster 1 and cluster 2 can be regrouped further however as the cells in cluster 1 and cluster 2 only occupy 9 94 of the 322 cells in the ubr basin and the runoff contribution of the cells in cluster 1 and cluster 2 in the basin is only 3 83 these cells make a relatively small contribution to the streamflow of the outlet station therefore in our study the more detailed regionalization in cluster 1 and cluster 2 was not made fig 9 a shows the results of the hydrological regionalization where six blocks are divided according to the runoff feature of each cell mentioned above in fig 9 the representative cells for the six clusters are marked as black stars the representative cells for cluster 3 and cluster 6 are located in the downstream of yc according to the definition of representative cells whose runoff feature can represent the runoff features of all cells in the same cluster the representative cells for cluster 3 and cluster 6 are still utilized without adjustment when calculating the streamflow at yc 4 3 evaluation of surrogate model the performance metrics during the training period show little difference with values of nse and kge larger than 0 999 bias less than 0 01 and rmse less than 50 in model 1 4 this means that the streamflows from model 1 4 and the vic model are almost the same during the training period and it is difficult to determine a better performed model according to the performance metrics during the training period as a result the results shown later are all in the testing period the performance for the surrogate models with different lag windows is compared in fig 10 the goodness of fit between the sm simulated streamflow and the vic simulated streamflow in the testing period is used to evaluate the surrogate model performance it can be observed that the performances of the surrogate model with the four lag windows are very good as shown in fig 10 model 1 and model 2 show a better performance on streamflow simulation at yc and nx than model 3 and model 4 seen from fig 10 model 2 gets a slightly better performance at nx while model 1 has a better performance at yc since nx is the outlet hydrological station of the ubr basin in our study with which we are more concerned and the performance of model 1 and model 2 is similar at yc model 2 is employed and the lag window is set as 7 days in order to study the impacts of different input data on the surrogate model model 5 with a 7 day lag window is compared with model 2 model 5 is a simple precipitation runoff model and model 2 is the surrogate model for vic we have designed in our study high flow is defined as the vic simulated top 10 flow and corresponding sm simulated flow normal flow is defined as the vic simulated flow between q90 and q50 the discharge value exceeded 90 and 50 of the time respectively and corresponding sm simulated flow the flow not in the high flow and the normal flow is classified into the low flow table 3 shows the performance of model 2 and model 5 at nx the left panel in fig 11 shows the scatter plots of the streamflow simulated by model 2 and model 5 on the vertical y axis against the vic simulated streamflow on the horizontal x axis and the empirical cumulative distribution function ecdf curves of streamflow simulated by model 2 model 5 and vic are given in the right panel in the four types of flow comparison model 2 performs better than model 5 seen from fig 11 a and b the points of model 2 and model 5 are distributed along the y x line and the ecdf curves of the three models are almost coincided where the curve of model 2 is closer to the vic s than model 5 s fig 11 d shows that the performance of model 5 is worse than that of model 2 where model 5 underestimates the streamflow with ecdf larger than 0 8 and ecdf less than 0 2 and overestimates the streamflow with ecdf between 0 2 and 0 8 meanwhile the ecdf curve of model 2 almost overlaps that of vic when ecdf is larger than 0 3 but model 2 underestimates the streamflow in the high flow when ecdf is less than 0 3 both model 2 and model 3 perform well in the normal flow and the streamflow with ecdf above 0 9 in the normal flow are both overestimated with two models in the low flow simulation model 5 shows a terrible performance as shown in fig 11 g the points of model 2 are distributed along the y x line while a large number of outliers appears in model 5 fig 11 h illustrates that model 5 overestimates the streamflow in the low flow simulation the results in table 3 and fig 11 indicate that the model with the vic simulated runoff in representative cells as the input data can surrogate the vic model better the sm simulated daily streamflow and the vic simulated daily streamflow compared with the observed streamflow in the ubr basin during the testing period are displayed in fig 12 the green lines the red dashes and the black dashes in fig 12 are the sm simulated streamflow the vic simulated streamflow and the observed streamflow respectively as shown in fig 12 the sm simulated streamflow well coincides with the vic s at both stations the performance metrics nse kge bias and rmse between the simulated streamflow sm and vic and the observed streamflow were calculated the values of nse kge bias and rmse of sm at yc are 0 8412 0 8867 0 0795 and 396 33 respectively while the values of vic are 0 8774 0 9098 0 0503 and 348 26 this illustrates that sm performs well on the streamflow simulation at yc but the performance of vic is still slightly better than the sm s similar results can be seen at nx as well another key point of the surrogate model is efficiency in our study sm and vic were operated with one processor of an intel i5 8500 cpu on ubuntu 16 04 3 platform the efficiency of sm and vic was evaluated in different lengths of simulated time ranged from 1 month to 5 years to reduce the interference caused by the computer environment the time consumed in table 4 is the average time of 10 repeated calculations seen from table 4 it is obvious that the time consumed by both sm and vic grows with extended simulated time for vic the time consumed increases remarkably with the simulated time from 1 month to 5 years however it is interesting to see that the growth multiple of the time consumed by vic is less than that of the simulated time where there are 60 times from 1 month to 5 years but the time consumed increases only about 36 times for sm the main contribution to the time consumed is generating the runoff of the representative cells with vic which takes about 2 time in our study when directly using the vic model to simulate the streamflow the time to simulate the streamflow also increases with the increasing length of the simulated time with the simulated time from 1 month to 5 years the time consumed by sm increases about 31 fold the computational saving index razavi et al 2012 is used to measure the efficiency gains of sm compared with vic as shown in table 4 the computational saving with sm is over 97 in all six cases with different lengths of the simulated time 5 discussion 5 1 characteristics of subwatershed fig 9 a shows the six clusters of the ubr basin and the distribution of glacier the runoff in each cell is influenced not only by the meteorological condition but also the underlying surface condition such as land uses soil type distribution snow and glacier distribution as shown in fig 9 b grasslands are the vegetation types with the largest proportion in most cells therefore the distribution of the vegetable types with the largest proportion in each cell makes little influence to the runoff feature change moreover no obvious relationships are found between the soils map shown in fig 9 d and the results of hydrological regionalization from the distribution of glacier shown in fig 9 a and daily average snow depth from 2000 to 2010 shown in fig 9 e cluster 3 and cluster 6 are in the glacier region while cluster 4 and cluster 5 are in the non glacier region where over 90 of cells are addressed the boundary between cluster 4 and cluster 5 and the boundary between cluster 3 and cluster 6 have not been so obvious but still weak relationship with the distribution of the vegetable types with the second largest proportion in each cell is found as shown in fig 9 c comprehensively cluster 1 and cluster 2 are located in the transition zones between the glacier region and the non glacier region cluster 3 lies in the glacier region but with a relatively shallow average daily snow depth while cluster 6 has a deep average daily snow depth located in the glacier region the differences between cluster 4 and cluster 5 are related to land uses seen from fig 9 b and fig 9 c grasslands are the main vegetation types occupying the most region of cluster 4 and cluster 5 while croplands are also widely distributed in cluster 5 5 2 comparison of different surrogate models to show the performance of different black models lstm deep belief network dbn hinton et al 2006 ann and linear regression model lrm nourani et al 2018 were compared here a three layer backpropagation neural network bpnn with 10 nodes in the hidden layer was used with the trial and error method the greedy layer wise training algorithm bengio et al 2007 was used to train dbn in our study dbn with three hidden layers was adopted and bpnn was also used as a regression layer connecting the hidden layer with the output layer for dbn the inputs and outputs of dbn bpnn and lrm are the same as lstm model 2 where the training and testing periods are also 2000 2010 and 2011 2015 respectively table 5 shows the performance of lstm dbn bpnn and lrm at nx as shown in table 5 lstm and dbn have a better performance than bpnn and lrm similar performance is seen for lstm and dbn lstm shows a slightly better performance in the normal flow simulation than dbn bpnn shows good performance to simulate the high flow and low flow which is very close to that of lstm and dbn in the normal flow simulation bpnn performs even worse than lrm in contrast to bpnn lrm shows a very poor performance to simulate the low flow and high flow compared with the low flow and high flow simulation lrm has a better performance in the normal flow simulation where kge and bias of lrm are slightly different from those of lstm in practice the high flow flood and low flow are important for flood or drought management therefore lrm is not so suitable to be used as the surrogate model compared with lstm in this study bpnn not only works relatively poorly in normal flow simulation but also has a higher bias in low flow simulation than that of lrm up to 0 0897 which means that bpnn overestimates the streamflow in the low flow simulation although lstm and dbn show better accuracy than bpnn and lrm in the entire flow high flow normal flow and low flow simulations they still have a disadvantage the structures of deep learning algorithms are much more complex than that of bpnn and lrm leading to a relatively longer time to train and apply a deep learning algorithm even though this time consumed by the deep learning algorithm is far less than that of vic 5 3 spatial information in the surrogate model the hydrological regionalization is usually based on the physical properties of the watershed pagliero et al 2019 wallner et al 2013 in our study the aim of the hydrological regionalization is to find out the cells with similar runoff features several metrics such as cc nse kge bias etc are applicable to describe the similarity of runoff features between two cells in our surrogate model some modified functions such as the linear formula and lstm can be used to estimate the runoff of any cell with the runoff of the representative cells so the series correlation is more concerned rather than mean values of these runoff series cc is a measure of the linear correlation between two series and will not change when scaling up or down any of the two series therefore cc is more suitable for the measure of the runoff feature similarity between two cells meanwhile it is necessary to normalize the runoff series in all cells first if nse kge and bias are used to measure the runoff feature similarity in our surrogate model the spatial information retained is mainly from the representative cells here a linear formula y ax b where x and y are the runoff of the representative cell and the estimated cell respectively the coefficients a and b are estimated with the least square method during the training period is utilized to estimate the runoff in non representative cells with the runoff in the corresponding representative cells to investigate the amount of spatial information of the runoff that sm has retained the runoff of each cell in the ubr basin during the testing period was calculated with the linear formula and compared with the runoff of the corresponding cell obtained from the vic model fig 13 shows the spatial maps of cc nse kge and bias between the sm retained runoff and the vic simulated runoff during the testing period seen from fig 13 a ccs of 90 cells are larger than 0 7 and the ccs less than 0 5 are mainly gathered in cluster 1 and cluster 2 which is consistent with the results described in section 4 2 in fig 13 b 70 of cells have nse larger than 0 5 and the cells with a smaller nse are mainly distributed in the western part of the basin the similar results of kge and bias are shown in fig 13 c and d fig 13 b d illustrates that the cells close to the representative cells retain more information of the runoff and the cells away from the representative cells especially for the cells on the edge of the clusters lose more information overall considerable partial information of the runoff can be retained by our surrogate model in our study the sm retained runoff is merely modified with the simple linear formula roughly the application of lstm or rnn may improve the accuracy of the modified sm retained runoff 5 4 comparison of model 2 and model 5 fig 11 illustrates that the surrogate model with precipitation as input data model 5 has a good performance in normal flow simulation but a non ideal performance in low and high flow simulation as shown in fig 11 and table 3 model 5 overfits the normal flow to obtain a better objective value in the entire flow simulation in the ubr basin the glacier melt water and snow melt water are significant in the basin especially during the late spring and early summer liu et al 2014 2019 the melt water occupies about 40 of the contributions to the annual total streamflow in the river cuo et al 2014 in model 2 whose input data is the runoff of the representative cells simulated by vic the runoff into the surrogate model includes precipitation generated runoff snow melt runoff and glacier melt runoff so the output of the model also includes precipitation generated flow snow melt flow and glacier melt flow however model 5 is a simple rainfall runoff model which uses only precipitation data to simulate the output streamflow the output of model 5 is simply divided into the surface flow and the baseflow in order to obtain a better objective value such as nse rmse cc etc in the entire flow the baseflow is lifted in calibrating model 5 to make up the absence of snow melt water and glacier melt water however the snow and glacier melting usually occur during late spring and early summer wang et al 2017 so that a large surface flow is usually accompanied by a large baseflow the irrationally lifted baseflow increases not only the streamflow during the snow and glacier melting days but also that in autumn and winter which makes the performance of model 5 poor in the low and high flow simulation kratzert et al 2018 pointed out that model 5 showed a better performance in simulating the streamflow during the time of snow melt with the lag window lengthened where the lag window was long enough to include the accumulated snow from the precipitation in winter however perennial snow and glacier in the ubr basin are still the reason for less well performance of the simple rainfall runoff model 5 5 limitations and prospects precipitation generated runoff snow melt runoff and glacier melt runoff were mainly considered in the vic model however in our study we just discussed the impact of the snow and glacier melt water on the runoff simulation briefly with a comparison between model 2 and model 5 detailed runoff component analysis has not been studied here but is worth studying in our future work which will not only concern sm but also the vic model itself the runoffs in the grid cells are the only input data to partition subwatersheds in our work the geographical conditions such as elevation land use soil type etc and other outputs of vic such as evaporation soil moisture relative humidity etc are not considered in the process of hydrological regionalization with the extra information it may improve the reliability of the hydrological regionalization and increase the spatial information retained in sm but also further complicate the partition in our study sm can obtain streamflow with slight accuracy losses and save more than 97 computation time compared with the vic model this can alleviate the burden of computation in the hydrological forecast where the rolling process is widely used and it takes usually hundreds of runs of the model meanwhile sm also retains partial spatial information which makes it possible to simulate the streamflow in different future climate scenarios quickly and estimate the runoff contribution from each grid cell with sm instead of vic 6 conclusion to improve the efficiency of the vic model and alleviate the burden of computation a surrogate model composed by skc and lstm was developed skc was utilized to select the representative cells of the study area and lstm was used to simulate the streamflow of the outlet station with the runoff of the representative cells the new surrogate model was applied in the ubr basin to investigate its performance nse bias kge and rmse were chosen as the evaluation metrics for sm the major findings of the present study are the following 1 the combination of the self organizing map and k means clustering algorithm can pick out representative cells efficiently through which the number of grid cells to be calculated in vic was significantly reduced as a result sm saved over 97 time to obtain a similar simulated streamflow in the ubr basin compared with vic 2 lstm was proved to perform well with only a very small error between the sm simulated streamflow and the observation in the hydrological stations yc and nx 3 the developed sm model can retain partial spatial information of vic the runoff features and other information in the representative cells could represent the runoff features and surface conditions of the subwatersheds classified by skc in general the new surrogate model based on skc and lstm can improve the efficiency of vic greatly and can be applied in the domain of hydrological forecast flood simulation and climate change impact analysis etc credit authorship contribution statement haiting gu conceptualization methodology software writing original draft yue ping xu supervision writing review editing di ma investigation writing review editing jingkai xie visualization data curation li liu data curation software validation zhixu bai writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank national natural science foundation of china 91547106 and national key research and development plan inter governmental cooperation in international scientific and technological innovation 2016yfe0122100 for the financial support we thank the environment and ecological science data center for west china westdc for providing the soil data and the landcover data http westdc westgis ac cn we are also grateful to china meteorological administration for providing meteorological and hydrological data used in this study can be downloaded from the website http data cma cn we are very grateful to the editor and three reviewers for their insightful and constructive comments 
5307,the variable infiltration capacity vic model is a widely used distributed hydrological model however vic is computationally expensive in hydrologic prediction or forecast which needs tens of thousands of runs of the model to alleviate the burden of computation and reduce the losses of model fidelity a new surrogate model sm coupling the self organizing map and k means clustering algorithm skc with long short term memory network lstm is proposed skc is utilized to divide the subwatershed and select the representative cells in each subwatershed lstm is used to simulate the streamflow with the runoff of the representative cells the new model is successfully applied in the upper brahmaputra river ubr basin southeast china the results show that the sm simulated streamflow has little difference from the vic simulated streamflow in terms of the nash sutcliffe coefficient efficiency the main metric of sm performance 0 9677 at yangcun station and 0 9696 at nuxia station for the representative cells sm retains partial spatial information of the runoff in the study area the computational savings achieved through the use of sm are over 97 with only slight losses of accuracy in the application to the ubr basin keywords surrogate model variable infiltration capacity model long short term memory self organizing map 1 introduction the variable infiltration capacity vic hydrological model liang et al 1994 is one of the distributed models applied to the areas above a critical scale taken to be about 10 km2 typically maurer et al 2002 the distributed hydrological model shows its strong advantages of studying the spatial variability of hydrological response to climate and land use changes chen et al 2018a and making full use of spatial nonuniformity of precipitation and land surface condition on hydrologic processes numerous studies have applied vic successfully in different domains such as runoff forecasts mo and lettenmaier 2014 schumann et al 2013 climate change impacts on hydrology lu et al 2018 wang et al 2018 water resources assessment sridhar et al 2019 reservoir operation wang et al 2019 and groundwater assessment niu et al 2019 etc however in the operation of the distributed model in particular when applied to hydrological prediction or forecast it takes much or equivalent time in parallel computation to solve partial derivative equations with numerical computation methods one grid cell by one liu et al 2017 especially in cases with high resolutions and consideration of energy balance where the frozen soil lake and snowmelt modules are utilized liu et al 2019 in the hydrological forecast one of the most common applications of vic the rolling process chen et al 2016 is usually adopted which means that the streamflow is forecasted beginning with rolled over initial time extending into the future with a given forecast period therefore the hydrological model will be operated hundreds of times to generate hundreds of forecast streamflow members slater and villarini 2018 tuteja et al 2019 this procedure is computationally expensive so it is very necessary to accelerate the model operation and alleviate the burden of computation to improve model computing efficiency better computational power is always at one s disposal slater and villarini 2018 tuteja et al 2019 which is usually along with the parallel computing technology lin et al 2019 perkins et al 2019 apart from simply buying a faster computer or using a supercomputer surrogate model sm maier et al 2014 razavi et al 2012 is an effective method there are two main ways to construct sms the first one is by building the response surface kleijnen 2009 ignoring the internal mechanism of the physical models which is often used to optimize model parameters behzadian et al 2009 gong et al 2016 kourakos and mantoglou 2009 yan and minsker 2011 yazdi et al 2019 the other way is by reducing the fidelity of the simulation to make the model cheaper to run by means of using coarser spatial or temporal grid size smith 2013 reducing model order siade et al 2010 ushijima 2018 zhang et al 2020 and utilizing lumped or empirical model xing et al 2019 zhang et al 2016 the studies mentioned above are almost planned for groundwater and parameter optimization seldom surrogate models have been used for hydrological models such as vic in the field of runoff simulation as vic is a gridded hydrological model it can be effective to accelerate the model operation by reducing the number of grid cells to be calculated apart from enlarging grid sizes one practicable way is to classify these grid cells according to their geographical conditions and runoff features and then to pick out one cell from each classification as the representative cell the self organization map or the self organizing neural network som kohonen 1982 1997 an unsupervised learning network is considered to be a well performed classification and clustering algorithm and widely used in hydrological regionalization chen et al 2018b haselbeck et al 2019 ley et al 2011 razavi and coulibaly 2017 rivas tabares et al 2019 wallner et al 2013 xu et al 2016 which can cluster complex data sets without specifying the number of clusters nourani et al 2013 in practical applications of the vic model some additional routing models such as lohmann s model lohmann et al 1996 1998 the rvic routing model hamman et al 2017 the routing application for parallel computation of discharge rapid david et al 2011 etc are usually used to converge runoff in all grid cells upstream into an output point however these routing models hardly operate when the runoff in some grid cells is absent artificial neural networks ann can solve this problem to a large extent although there are seldom studies on the synthetic method of som and ann in the domain of sm this combination has been applied successfully in rainfall runoff forecasting nourani et al 2013 and groundwater level forecasting nourani et al 2015 the deep learning models are developed based on artificial neural networks ann which has a similar structure with traditional ann but utilizes a more advanced training method called layer wise training to overcome the shortage of gradient diffusion in ann goodfellow et al 2016 the long short term memory lstm hochreiter and schmidhuber 1997 as one of the deep learning models is dedicated to dealing with the time series fang et al 2017 le et al 2019 seo et al 2015 zhang et al 2018 in this study we focus on developing a new surrogate model for vic there are three goals to be achieved 1 to reduce the computation efforts in the operation of vic with the deep learning methods 2 to improve the accuracy of the surrogate model and reduce the losses of fidelity from the vic model 3 to still keep partial spatial information from the vic model 2 method 2 1 hydrological model the variable infiltration capacity vic macroscale hydrological model was originally developed by liang et al 1996 1994 at the university of washington the vic model is a grid based distributed hydrological model in macro scale where runoffs in grid cells are calculated independently and do not have to communicate laterally in this study the vic model of version 4 2 d is operated at a 6 hourly time step in both water and energy balance models with a spatial resolution of 0 25 0 25 the snow andreadis et al 2009 bowling et al 2004 and frozen soil cherkauer and lettenmaier 1999 cherkauer et al 2003 algorithms are active which can represent the effects of seasonal changes in the weather of a cold land on surface water and energy fluxes however in the current vic model glacier simulation is absent in our work a new glacier module is added due to limited observations glacier melting is simulated by a temperature index model in this glacier module we assume that the glacier melts from the snow pack and leaves this part of water out of the water equivalent chen et al 2017 su et al 2016 zhang et al 2013 the glacier melting water within cell i gi is calculated as follows 1 g i f i d f t i i f t i t melt 0 i f t i t melt where fi is the glacier area fraction in cell i df is the degree day factor for glacier mm 1 day 1 ti and tmelt are the daily mean air temperature and the minimum temperature when the glacier melts respectively the model itself does not include any routing process therefore the routing model from lohmann et al 1996 1998 is employed in our work which is a source to sink model to solve linearized saint venant equations 2 2 surrogate model 2 2 1 self organizing map and k means clustering algorithm the self organizing map som is an unsupervised artificial neural network originally proposed by kohonen 1982 and kohonen et al 1996 which can explore the unlabeled high dimension input data and group the similar data into a low dimensional output layer in our study two dimension topology with hexagonal lattice is utilized as the output layer which consists of k neurons the input data set x consists of n m dimension vectors and each input vector is connected to each neuron of the output layer the number of map nodes k is chosen by the heuristic formula k 5 n clark 2018 and fixed during the whole learning process wallner et al 2013 the steps of the som training are as follows step 1 set the prototype vectors m m 1 m 2 m 3 mk randomly or linearly where mi is a n dimension vector step 2 select the input vector xj to calculate the distances to each prototype vector mi the neuron which has the smallest euclidian distance with the input vector xj is called the best matching unit bmu step 3 update bmu and its neighboring neurons with eq 2 2 m i m i α h ci x j m i where α is the learning rate factor hci is the neighborhood kernel and the gaussian function is used in our study the detailed descriptions of the neighborhood kernel can be found in clark 2018 step 4 repeat step 2 and 3 until all the input vectors are considered and the iterations reach a specific number in our study the batch training is utilized which sends all input vectors to the map for weight adjustment at once to ensure the adequate model performance of som the number of iterations is set as 1000 som itself is a clustering method which has been applied widely in hydrological regionalization studies agarwal et al 2016 chen et al 2018b gao et al 2018 and watershed classification ley et al 2011 razavi and coulibaly 2017 however it is not easy to distinguish the clusters of som visually for there are no distinct cluster boundaries in the results as a result the k means algorithm vesanto et al 2000 is utilized to group the similar units of the som further the input data set for the k means algorithm is bmus from som and the number of clusters k is given as a priori value the davies bouldin index dbi davies and bouldin 1979 is the criteria to evaluate spatial clustering performance with eq 3 in our study k ranges from 2 to k pacella et al 2016 where k is the number of bmus the k means algorithm is run multiple times to select the value of clusters k when dbi reaches the minimum value 3 dbi k 1 k k 1 k max k l δ s k δ s l δ s k s l where δsk and δsl are the within cluster distances and δ sk sl is the between cluster distance in our study dbi is used as the criteria to evaluate spatial clustering performance fig 1 indicates the procedure of the two phase clustering algorithm based on the som and the k means cluster skc 2 2 2 long short term memory the long short term memory lstm network is a special kind of recurrent neural network rnn solving the vanishing gradient problem caused by the backpropagation with the specially designed units called gates and memory cells shen 2018 the gates decide the information to forget and that to remember in the lstm network and avoid error signal to decay over long time steps tian et al 2018 the work of kratzert et al 2018 indicates that lstm is more suitable to predict the streamflow for lstm can memorize such a long period of sequences to consider the impact of groundwater snow or even glacier storages while the traditional rnn works ineffectively when the length of sequences is over 10 bengio et al 1994 lstm was first developed by hochreiter and schmidhuber 1997 and becomes one of the most widely used tools in the sequential data modelling domain with the development of the deep learning technology zhang et al 2017 as one of rnns lstm also processes sequential data in a recursive form the lstm recurrent networks have lstm cells where the cell state and the hidden state are memorized and updated through three gates i e input gate forget gate and output gate fig 2 shows the schematic diagram of lstm the cell state c t and the hidden state h t at time step t are shown as follows 4 c t g t i t c t 1 f t h t σ c c t o t where i t f t g t and o t represent the input gate the forget gate the cell candidate and the output gate respectively which are described in eq 5 σc is the state activation function denotes the element wise multiplication of vectors 5 input gate i t σ g w i x t r i h t 1 b i forget gate f t σ g w f x t r f h t 1 b f cell candidate g t σ c w g x t r g h t 1 b g output gate o t σ g w o x t r o h t 1 b o where σg is the gate activation function wi wf wg and wo are weights for the input ri rf rg and ro are weights for the recurrent output bi bf bg and bo are biases in our work σg and σc are set as the sigmoid function and the hyperbolic tangent function tanh respectively 2 2 3 surrogate model based on skc and lstm the surrogate model for vic is based on skc and lstm where skc is used to redistrict the drainage area according to the hydrological characteristics and the natural geographical conditions and lstm is utilized to simulate the streamflow with the data from the representative cell of each subwatershed divided with skc the surrogate model for vic is shown in fig 3 and described as follows step 1 data preparation the vic model is operated first and the runoff evaporation baseflow etc in each grid cell are simulated during the training period specified in our work we mainly focus on runoff simulation the simulated streamflow of outlet hydrological stations in the watershed is calculated with the routing model step 2 hydrological regionalization in this step the representative cells are chosen a representative cell is defined as a cell which yields a value representative of all the cells with the similar runoff features a the watershed is divided into n gird cells in each of which a series of runoff is simulated by vic the correlation coefficients cc are used to measure the similarity of the runoff features between the two cells cc is described as 6 p ij cov r i r j var r i v a r r j 0 i j n where ri and rj are the runoff series in the ith and jth cells cov and var are the covariance function and the variance function when i is equal to j pij is equal to 1 b the property vector pi pi 1 pi 2 pin is used to describe the runoff feature of the ith cell which shows the runoff similarity between the ith cell and any of the cells c the n property vectors are used as the input samples for clustering with the skc the cell with the nearest euclidean distance to the cluster center is selected as the representative cell in the corresponding cluster area step 3 surrogate modelling there are n representative cells acquired in step 2 the runoff series of these cells are used as the input samples of the lstm and the streamflow series of the outlet stations in the basin are the output targets of the lstm in this work the lstm is trained with the adam optimization algorithm kingma and ba 2014 with the maximum training epochs of 250 the trained lstm is used to predict the streamflow of the outlet stations instead of the vic during the prediction testing period first the runoff series of representative cells during the prediction period are calculated with the vic second the lstm is operated with these runoff series as the input data 2 3 model performance metrics to evaluate model performance several widely used evaluation metrics are utilized in our study which are the nash sutcliffe efficiency nse nash and sutcliffe 1970 relative bias bias kling gupta efficiency kge gupta et al 2009 and the root mean square error rmse the formulas of nse bias and rmse are defined as follows 7 nse 1 i 1 n q o i q s i 2 i 1 n q o i q o 2 bias i 1 n q s i q o i i 1 n q o i rmse 1 n i 1 n q o i q s i 2 where n is the length of the daily runoff series qo i and qs i are the observed and simulated daily flows of the ith day respectively q o is the mean value of the observed daily streamflow the kge consists of three parametric components i e the correlation coefficient of the observed and simulated streamflow the variance bias and the total volume bias the formula is shown as following 8 kge 1 r 1 2 μ s μ o 1 2 σ s σ o 1 2 where r is the correlation coefficient of two compared streamflow series μs and σs are the mean values and the standard deviation of the simulated streamflow μo and σo are the mean values and the standard deviation of the observed streamflow 3 case description 3 1 study area the surrogate model proposed is applied in the upper brahmaputra river ubr basin to investigate its role and efficiency the ubr is the longest plateau river in china originating from the jiemayangzong glacier at an elevation of 5590 m above sea level located on the tibetan plateau fig 4 the drainage area above the nuxia hydrological station is approximately 2 105 km2 with a mean altitude over 4000 m the precipitation with an average annual value of about 560 mm in the ubr basin changes only slightly interannually which is concentrated during the period from june to september the perennial snow and glacier are distributed in the upper lower reach and the southern regions where the himalayas mountain is located liu et al 2019 average annual temperature in the basin is about 6 27 with the highest temperatures in a year occurring in june and july and the lowest in january which means that a large amount of the glacier and snow melt water is always accompanied with a large amount of precipitation in the ubr basin the precipitation controlled by the indian summer monsoon the snow melt water and the glacier melt water make the major contribution to the streamflow chen et al 2017 you et al 2007 3 2 data the precipitation data used in our work is the china gauge based daily precipitation analysis cgdpa shen and xiong 2016 which is gridded daily precipitation with the resolution of 0 25 0 25 based on the observed daily precipitation in about 2400 gauge stations over mainland china and the optimal interpolation method xie et al 2007 the gauged meteorological data including daily maximum and minimum air temperature wind speed relative humidity and atmospheric pressure were collected from 25 national meteorological observatory stations located in and around the ubr basin as shown in fig 4 red stars these gauged meteorological data were interpolated into 0 25 0 25 with the inverse distance weighted method idw coupled with elevation based lapse rates setting as 0 6 mm km for precipitation and 6 5 km for temperature cuo et al 2014 the daily streamflow series of the two outlet stations i e yangcun station yc and nuxia station nx were utilized for calibrating and validating the vic model and training and testing the surrogate model the calibration and validation period for vic are 2000 2007 and 2008 2010 respectively to prove the predictive ability and robustness of the proposed surrogate model an extra period from 2011 to 2015 is used as the testing period while the training period for sm is 2000 2010 the digital elevation model data with 90 m resolution was from national aeronautics and space administration shuttle radar topographic mission harmonized world soil database hwsd version 1 1 fischer et al 2008 in a resolution of 1 km was adopted as the soil data set in the vic model the landcover data set used in our work was westdc landcover data set version 2 0 ran et al 2010 in a resolution of 1 km in the year of 2000 3 3 lstm inputs the runoffs of the representative cells at the current time step and their lagging information are used to simulate the streamflow of yc and nx stations considering the influence of the glacier and snow the lag window is up to 15 days as a result the inputs for simulating current daily streamflow of a gauge station consist of three parts i e the previous runoff of the representative cells the current runoff of the representative cells and the previous streamflow of the gauge station as shown in table 1 several different sets of model input and output structures are used to obtain the appropriate structure of the model model 5 in table 1 is a control group to build the surrogate model with the precipitation in the representative cells instead of the runoffs 4 results 4 1 results of the vic model the daily streamflow at yc and nx was simulated by vic with the parameters optimized by ε nsga ii kollat and reed 2006 liu et al 2017 table 2 presents the evaluation indicators of streamflow at yc and nx it shows that there is a good efficiency at yc with nse of 0 8886 kge of 0 8832 bias of 0 0255 and rmse of 424 17 for calibration and 0 9121 0 9102 0 0415 and 356 64 for validation similar results at nx are also shown in table 2 it can be seen that the streamflow simulated with the vic model performs very well which can be used for the surrogate model 4 2 selection of representative cells fig 5 shows the cc of runoffs simulated with the vic model in pairwise cells a point whose position is denoted as i j represents cc between the runoff series in cell i with that in cell j where the different colors linked to different values of cc a line of points denoted as row i shows the phase property of cell i which means that the runoff feature in cell i is similar to some cells and different from other cells as shown in fig 5 each color bar represents the phase property of a cell in most cases adjacent color bars are similar which also indicates that these cells are close to each other and have similar hydrological conditions however color bars of some grid cells for instance cells around cell 50 cells around cell 85 and cells around cell 125 are distinguished from other grid cells it may be related to the distribution of glacier and perennial snow a som with 11 by 8 nodes was applied in this case the u matrix in fig 6 was obtained after the application of som to the ubr basin the color of the u matrix represents the distance between neighboring neurons from the u matrix the neurons on the upper right corner have small distances to each other and so do those on the lower left corner therefore there are two clearly different clusters on the upper right corner and the lower left corner besides it is critical that the neighboring neurons on the upper left corner which have large distances to each other separate the clusters as the boundaries however there is no clear and visual separation between the clusters in the u matrix from som as a result the k means algorithm is utilized to cluster the results of som further there are 88 bmus generated from som and the number of clusters in the k means algorithm ranges from 2 to 10 fig 7 a shows the values of dbi in changing cluster numbers when the number of clusters is equal to 6 the value of dbi gets to the minimum as shown in fig 7 b the different colors are used to mark the different clusters of the bmus obtained by som to verify the clustering results cc of runoffs between any two cells within clusters were calculated as shown in fig 8 cc in cluster 3 cluster 4 cluster 5 and cluster 6 are larger than those in cluster 1 and cluster 2 there are 97 58 cells in cluster 3 62 44 cells in cluster 4 99 82 cells in cluster 5 and 58 23 cells in cluster 6 with cc larger than 0 7 and 98 59 and 99 06 cells in cluster 5 and cluster 6 respectively with cc larger than 0 5 this illustrates that the runoffs of the cells within clusters except cluster 1 and cluster 2 have strong correlations the runoff correlations between two cells within cluster 1 and cluster 2 are weak which means that the cells in cluster 1 and cluster 2 can be regrouped further however as the cells in cluster 1 and cluster 2 only occupy 9 94 of the 322 cells in the ubr basin and the runoff contribution of the cells in cluster 1 and cluster 2 in the basin is only 3 83 these cells make a relatively small contribution to the streamflow of the outlet station therefore in our study the more detailed regionalization in cluster 1 and cluster 2 was not made fig 9 a shows the results of the hydrological regionalization where six blocks are divided according to the runoff feature of each cell mentioned above in fig 9 the representative cells for the six clusters are marked as black stars the representative cells for cluster 3 and cluster 6 are located in the downstream of yc according to the definition of representative cells whose runoff feature can represent the runoff features of all cells in the same cluster the representative cells for cluster 3 and cluster 6 are still utilized without adjustment when calculating the streamflow at yc 4 3 evaluation of surrogate model the performance metrics during the training period show little difference with values of nse and kge larger than 0 999 bias less than 0 01 and rmse less than 50 in model 1 4 this means that the streamflows from model 1 4 and the vic model are almost the same during the training period and it is difficult to determine a better performed model according to the performance metrics during the training period as a result the results shown later are all in the testing period the performance for the surrogate models with different lag windows is compared in fig 10 the goodness of fit between the sm simulated streamflow and the vic simulated streamflow in the testing period is used to evaluate the surrogate model performance it can be observed that the performances of the surrogate model with the four lag windows are very good as shown in fig 10 model 1 and model 2 show a better performance on streamflow simulation at yc and nx than model 3 and model 4 seen from fig 10 model 2 gets a slightly better performance at nx while model 1 has a better performance at yc since nx is the outlet hydrological station of the ubr basin in our study with which we are more concerned and the performance of model 1 and model 2 is similar at yc model 2 is employed and the lag window is set as 7 days in order to study the impacts of different input data on the surrogate model model 5 with a 7 day lag window is compared with model 2 model 5 is a simple precipitation runoff model and model 2 is the surrogate model for vic we have designed in our study high flow is defined as the vic simulated top 10 flow and corresponding sm simulated flow normal flow is defined as the vic simulated flow between q90 and q50 the discharge value exceeded 90 and 50 of the time respectively and corresponding sm simulated flow the flow not in the high flow and the normal flow is classified into the low flow table 3 shows the performance of model 2 and model 5 at nx the left panel in fig 11 shows the scatter plots of the streamflow simulated by model 2 and model 5 on the vertical y axis against the vic simulated streamflow on the horizontal x axis and the empirical cumulative distribution function ecdf curves of streamflow simulated by model 2 model 5 and vic are given in the right panel in the four types of flow comparison model 2 performs better than model 5 seen from fig 11 a and b the points of model 2 and model 5 are distributed along the y x line and the ecdf curves of the three models are almost coincided where the curve of model 2 is closer to the vic s than model 5 s fig 11 d shows that the performance of model 5 is worse than that of model 2 where model 5 underestimates the streamflow with ecdf larger than 0 8 and ecdf less than 0 2 and overestimates the streamflow with ecdf between 0 2 and 0 8 meanwhile the ecdf curve of model 2 almost overlaps that of vic when ecdf is larger than 0 3 but model 2 underestimates the streamflow in the high flow when ecdf is less than 0 3 both model 2 and model 3 perform well in the normal flow and the streamflow with ecdf above 0 9 in the normal flow are both overestimated with two models in the low flow simulation model 5 shows a terrible performance as shown in fig 11 g the points of model 2 are distributed along the y x line while a large number of outliers appears in model 5 fig 11 h illustrates that model 5 overestimates the streamflow in the low flow simulation the results in table 3 and fig 11 indicate that the model with the vic simulated runoff in representative cells as the input data can surrogate the vic model better the sm simulated daily streamflow and the vic simulated daily streamflow compared with the observed streamflow in the ubr basin during the testing period are displayed in fig 12 the green lines the red dashes and the black dashes in fig 12 are the sm simulated streamflow the vic simulated streamflow and the observed streamflow respectively as shown in fig 12 the sm simulated streamflow well coincides with the vic s at both stations the performance metrics nse kge bias and rmse between the simulated streamflow sm and vic and the observed streamflow were calculated the values of nse kge bias and rmse of sm at yc are 0 8412 0 8867 0 0795 and 396 33 respectively while the values of vic are 0 8774 0 9098 0 0503 and 348 26 this illustrates that sm performs well on the streamflow simulation at yc but the performance of vic is still slightly better than the sm s similar results can be seen at nx as well another key point of the surrogate model is efficiency in our study sm and vic were operated with one processor of an intel i5 8500 cpu on ubuntu 16 04 3 platform the efficiency of sm and vic was evaluated in different lengths of simulated time ranged from 1 month to 5 years to reduce the interference caused by the computer environment the time consumed in table 4 is the average time of 10 repeated calculations seen from table 4 it is obvious that the time consumed by both sm and vic grows with extended simulated time for vic the time consumed increases remarkably with the simulated time from 1 month to 5 years however it is interesting to see that the growth multiple of the time consumed by vic is less than that of the simulated time where there are 60 times from 1 month to 5 years but the time consumed increases only about 36 times for sm the main contribution to the time consumed is generating the runoff of the representative cells with vic which takes about 2 time in our study when directly using the vic model to simulate the streamflow the time to simulate the streamflow also increases with the increasing length of the simulated time with the simulated time from 1 month to 5 years the time consumed by sm increases about 31 fold the computational saving index razavi et al 2012 is used to measure the efficiency gains of sm compared with vic as shown in table 4 the computational saving with sm is over 97 in all six cases with different lengths of the simulated time 5 discussion 5 1 characteristics of subwatershed fig 9 a shows the six clusters of the ubr basin and the distribution of glacier the runoff in each cell is influenced not only by the meteorological condition but also the underlying surface condition such as land uses soil type distribution snow and glacier distribution as shown in fig 9 b grasslands are the vegetation types with the largest proportion in most cells therefore the distribution of the vegetable types with the largest proportion in each cell makes little influence to the runoff feature change moreover no obvious relationships are found between the soils map shown in fig 9 d and the results of hydrological regionalization from the distribution of glacier shown in fig 9 a and daily average snow depth from 2000 to 2010 shown in fig 9 e cluster 3 and cluster 6 are in the glacier region while cluster 4 and cluster 5 are in the non glacier region where over 90 of cells are addressed the boundary between cluster 4 and cluster 5 and the boundary between cluster 3 and cluster 6 have not been so obvious but still weak relationship with the distribution of the vegetable types with the second largest proportion in each cell is found as shown in fig 9 c comprehensively cluster 1 and cluster 2 are located in the transition zones between the glacier region and the non glacier region cluster 3 lies in the glacier region but with a relatively shallow average daily snow depth while cluster 6 has a deep average daily snow depth located in the glacier region the differences between cluster 4 and cluster 5 are related to land uses seen from fig 9 b and fig 9 c grasslands are the main vegetation types occupying the most region of cluster 4 and cluster 5 while croplands are also widely distributed in cluster 5 5 2 comparison of different surrogate models to show the performance of different black models lstm deep belief network dbn hinton et al 2006 ann and linear regression model lrm nourani et al 2018 were compared here a three layer backpropagation neural network bpnn with 10 nodes in the hidden layer was used with the trial and error method the greedy layer wise training algorithm bengio et al 2007 was used to train dbn in our study dbn with three hidden layers was adopted and bpnn was also used as a regression layer connecting the hidden layer with the output layer for dbn the inputs and outputs of dbn bpnn and lrm are the same as lstm model 2 where the training and testing periods are also 2000 2010 and 2011 2015 respectively table 5 shows the performance of lstm dbn bpnn and lrm at nx as shown in table 5 lstm and dbn have a better performance than bpnn and lrm similar performance is seen for lstm and dbn lstm shows a slightly better performance in the normal flow simulation than dbn bpnn shows good performance to simulate the high flow and low flow which is very close to that of lstm and dbn in the normal flow simulation bpnn performs even worse than lrm in contrast to bpnn lrm shows a very poor performance to simulate the low flow and high flow compared with the low flow and high flow simulation lrm has a better performance in the normal flow simulation where kge and bias of lrm are slightly different from those of lstm in practice the high flow flood and low flow are important for flood or drought management therefore lrm is not so suitable to be used as the surrogate model compared with lstm in this study bpnn not only works relatively poorly in normal flow simulation but also has a higher bias in low flow simulation than that of lrm up to 0 0897 which means that bpnn overestimates the streamflow in the low flow simulation although lstm and dbn show better accuracy than bpnn and lrm in the entire flow high flow normal flow and low flow simulations they still have a disadvantage the structures of deep learning algorithms are much more complex than that of bpnn and lrm leading to a relatively longer time to train and apply a deep learning algorithm even though this time consumed by the deep learning algorithm is far less than that of vic 5 3 spatial information in the surrogate model the hydrological regionalization is usually based on the physical properties of the watershed pagliero et al 2019 wallner et al 2013 in our study the aim of the hydrological regionalization is to find out the cells with similar runoff features several metrics such as cc nse kge bias etc are applicable to describe the similarity of runoff features between two cells in our surrogate model some modified functions such as the linear formula and lstm can be used to estimate the runoff of any cell with the runoff of the representative cells so the series correlation is more concerned rather than mean values of these runoff series cc is a measure of the linear correlation between two series and will not change when scaling up or down any of the two series therefore cc is more suitable for the measure of the runoff feature similarity between two cells meanwhile it is necessary to normalize the runoff series in all cells first if nse kge and bias are used to measure the runoff feature similarity in our surrogate model the spatial information retained is mainly from the representative cells here a linear formula y ax b where x and y are the runoff of the representative cell and the estimated cell respectively the coefficients a and b are estimated with the least square method during the training period is utilized to estimate the runoff in non representative cells with the runoff in the corresponding representative cells to investigate the amount of spatial information of the runoff that sm has retained the runoff of each cell in the ubr basin during the testing period was calculated with the linear formula and compared with the runoff of the corresponding cell obtained from the vic model fig 13 shows the spatial maps of cc nse kge and bias between the sm retained runoff and the vic simulated runoff during the testing period seen from fig 13 a ccs of 90 cells are larger than 0 7 and the ccs less than 0 5 are mainly gathered in cluster 1 and cluster 2 which is consistent with the results described in section 4 2 in fig 13 b 70 of cells have nse larger than 0 5 and the cells with a smaller nse are mainly distributed in the western part of the basin the similar results of kge and bias are shown in fig 13 c and d fig 13 b d illustrates that the cells close to the representative cells retain more information of the runoff and the cells away from the representative cells especially for the cells on the edge of the clusters lose more information overall considerable partial information of the runoff can be retained by our surrogate model in our study the sm retained runoff is merely modified with the simple linear formula roughly the application of lstm or rnn may improve the accuracy of the modified sm retained runoff 5 4 comparison of model 2 and model 5 fig 11 illustrates that the surrogate model with precipitation as input data model 5 has a good performance in normal flow simulation but a non ideal performance in low and high flow simulation as shown in fig 11 and table 3 model 5 overfits the normal flow to obtain a better objective value in the entire flow simulation in the ubr basin the glacier melt water and snow melt water are significant in the basin especially during the late spring and early summer liu et al 2014 2019 the melt water occupies about 40 of the contributions to the annual total streamflow in the river cuo et al 2014 in model 2 whose input data is the runoff of the representative cells simulated by vic the runoff into the surrogate model includes precipitation generated runoff snow melt runoff and glacier melt runoff so the output of the model also includes precipitation generated flow snow melt flow and glacier melt flow however model 5 is a simple rainfall runoff model which uses only precipitation data to simulate the output streamflow the output of model 5 is simply divided into the surface flow and the baseflow in order to obtain a better objective value such as nse rmse cc etc in the entire flow the baseflow is lifted in calibrating model 5 to make up the absence of snow melt water and glacier melt water however the snow and glacier melting usually occur during late spring and early summer wang et al 2017 so that a large surface flow is usually accompanied by a large baseflow the irrationally lifted baseflow increases not only the streamflow during the snow and glacier melting days but also that in autumn and winter which makes the performance of model 5 poor in the low and high flow simulation kratzert et al 2018 pointed out that model 5 showed a better performance in simulating the streamflow during the time of snow melt with the lag window lengthened where the lag window was long enough to include the accumulated snow from the precipitation in winter however perennial snow and glacier in the ubr basin are still the reason for less well performance of the simple rainfall runoff model 5 5 limitations and prospects precipitation generated runoff snow melt runoff and glacier melt runoff were mainly considered in the vic model however in our study we just discussed the impact of the snow and glacier melt water on the runoff simulation briefly with a comparison between model 2 and model 5 detailed runoff component analysis has not been studied here but is worth studying in our future work which will not only concern sm but also the vic model itself the runoffs in the grid cells are the only input data to partition subwatersheds in our work the geographical conditions such as elevation land use soil type etc and other outputs of vic such as evaporation soil moisture relative humidity etc are not considered in the process of hydrological regionalization with the extra information it may improve the reliability of the hydrological regionalization and increase the spatial information retained in sm but also further complicate the partition in our study sm can obtain streamflow with slight accuracy losses and save more than 97 computation time compared with the vic model this can alleviate the burden of computation in the hydrological forecast where the rolling process is widely used and it takes usually hundreds of runs of the model meanwhile sm also retains partial spatial information which makes it possible to simulate the streamflow in different future climate scenarios quickly and estimate the runoff contribution from each grid cell with sm instead of vic 6 conclusion to improve the efficiency of the vic model and alleviate the burden of computation a surrogate model composed by skc and lstm was developed skc was utilized to select the representative cells of the study area and lstm was used to simulate the streamflow of the outlet station with the runoff of the representative cells the new surrogate model was applied in the ubr basin to investigate its performance nse bias kge and rmse were chosen as the evaluation metrics for sm the major findings of the present study are the following 1 the combination of the self organizing map and k means clustering algorithm can pick out representative cells efficiently through which the number of grid cells to be calculated in vic was significantly reduced as a result sm saved over 97 time to obtain a similar simulated streamflow in the ubr basin compared with vic 2 lstm was proved to perform well with only a very small error between the sm simulated streamflow and the observation in the hydrological stations yc and nx 3 the developed sm model can retain partial spatial information of vic the runoff features and other information in the representative cells could represent the runoff features and surface conditions of the subwatersheds classified by skc in general the new surrogate model based on skc and lstm can improve the efficiency of vic greatly and can be applied in the domain of hydrological forecast flood simulation and climate change impact analysis etc credit authorship contribution statement haiting gu conceptualization methodology software writing original draft yue ping xu supervision writing review editing di ma investigation writing review editing jingkai xie visualization data curation li liu data curation software validation zhixu bai writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank national natural science foundation of china 91547106 and national key research and development plan inter governmental cooperation in international scientific and technological innovation 2016yfe0122100 for the financial support we thank the environment and ecological science data center for west china westdc for providing the soil data and the landcover data http westdc westgis ac cn we are also grateful to china meteorological administration for providing meteorological and hydrological data used in this study can be downloaded from the website http data cma cn we are very grateful to the editor and three reviewers for their insightful and constructive comments 
5308,drought impact is closely related to water deficit phases within the hydrological cycle and to drought propagation the complex evolutions from meteorological drought to hydrological drought and to soil moisture drought besides the qualitative description the quantitative analysis of drought propagation is still limited so far therefore in this study the propagation from meteorological to hydrological and to soil moisture droughts have been quantitatively analyzed in particular run theory has been utilized for quantifying key drought features including its duration and magnitude the two available land assimilation datasets from 1981 2018 were selected for comparison purpose in northern china plain our results showed that although drought events identified by two datasets were not the same both datasets revealed that meteorological drought occurred more frequently than hydrological and soil moisture droughts and both demonstrated meteorological drought hydrological drought and soil moisture drought were not synchronous in particular more than 91 89 of meteorological droughts led to hydrological droughts and more than 87 10 of hydrological droughts caused soil moisture droughts furthermore linear models showed the best for drought duration and magnitude we found when meteorological drought was prolonged or shortened by one month more than 91 89 probability it would lead to the extension or shortening of hydrological drought by 0 992 months with 1 687 unit in magnitude and if the duration of hydrological drought changed by one month more than 80 56 probability of the soil moisture drought duration would change by 1 006 months with 0 992 unit in magnitude the results of duration and magnitude fitted well across the whole study area building on the above drought evolution information practical drought mitigation measures and early warning system could be established keywords drought propagation drought characterization multi source data response relationship 1 introduction drought is a widespread global natural disaster zou et al 2005 wilhite et al 2007 charusombat and niyogi 2011 due to its high frequency long duration and wide range of influences it not only causes serious economic losses but also threatens people s lives wilhite 2000 aghakouchak et al 2015 hao et al 2016 therefore a key question is how a drought occurs i e drought propagation since 1980s the concept of drought propagation has basic and qualitative understandings dracup et al 1980 for example meteorological drought is regarded as the initial drought occurring when rainfall decreases to a certain level yuan et al 2017 which will usually reduce the ground runoff and trigger hydrological drought with the continuous occurrence of hydrological drought it will further develop into an agricultural drought represented by low soil moisture and crop yield reduction subsequently heim 2002 mishra and singh 2010 ma et al 2019b jamshidi et al 2019a in the above the drought propagation represents the spatial temporal transition of water deficiency from the drought beginning to the end within the atmosphere hydrology soil vegetation system due to the close relationship between these sub types of droughts hao and singh 2015 the propagation of meteorological hydrological and agricultural droughts is especially valuable for improving the accuracy of drought analysis and prediction however with the intensification of climate change and human activities it is more difficult to accurately identify the spatial and temporal evolution of drought ma et al 2019a many researchers have pointed out that the spatial and temporal features of drought propagation is critical to deepen our understanding of drought events and build a time sensitive drought prediction and early warning model barker et al 2016 van loon et al 2016 bachmair et al 2018 zhang et al 2018 most previous drought studies focused on drought concepts monitoring and predictions zhang et al 2017a wu et al 2018a dash et al 2019 samantaray et al 2019 zhang et al 2019 due to its complex mechanism the study of drought propagation just began around 2001 at the first the basic features and time of drought propagation had been investigated stahl 2001 peters 2003 van loon et al 2012 for example van loon et al 2012 studied drought characteristics drought propagation features and hydrological drought typology they found that the simulated drought characteristics could clearly reflect the propagation of drought lorenzo lacruz et al 2013 correlated a standardized precipitation index spi from 1 month to 48 months with a standardized streamflow index to assess the response time of hydrological drought to spi by correlation method in recent years studies globally have found various impact factors of drought propagation including temperature peña gallardo et al 2018 climate type pan et al 2017 gevaert et al 2018 catchment characteristics van loon and laaha 2015 and land cover and reservoirs wu et al 2018b for example wu et al 2018c detected the relationship between extreme climate index and drought by variance decomposition method and explored the potential factors affecting drought propagation time ma et al 2019a conducted three hydrological simulation experiments to distinguish the contribution of climate change and human activities to hydrological drought by controlling variables building on these studies propagation speed has been proposed and analyzed wu et al 2018a considering the above studies most of them only focused on meteorological drought to hydrological drought with the lack of propagation from hydrological to agricultural drought however the full drought evolution knowledge can only be revealed by studying the complete drought propagation within the atmosphere hydrology soil vegetation system meanwhile the widely used correlation method mostly focuses on duration of drought and ignores magnitude lópez moreno et al 2013 lorenzo lacruz et al 2013 kazemzadeh and malekian 2016 wu et al 2016 huang et al 2017 which make it difficult to fully investigate the relationship between meteorological hydrological and soil moisture drought wu et al 2017 we will investigate the whole drought propagation from meteorological to agricultural droughts both from propagation duration and magnitude characteristics in this study moreover the spatial information of drought propagation will also be analyzed to achieve that run theory is adopted to quantify the drought duration and magnitude characteristics and regression analysis method is adopted to quantify the relationship in duration and magnitude of drought two globally validated datasets i e merra 2 and gldas have been selected and compared for the study area this study is expected to firstly provide vital and useful information for the local drought early warning and mitigation 2 study area and datasets 2 1 study area the study area i e northern china plain ncp covers the cities of beijing and tianjin and five provinces of jiangsu anhui henan hebei and shandong as shown in fig 1 it is one of the most important grain production bases and produces more than 68 of winter wheat in china most of the winter wheat producing areas located in the temperate semi arid monsoon climate and annual rainfall varies between 400 850 mm wu et al 2006 the annual distribution of precipitation is uneven mainly concentrated in july to september the annual mean temperature ranged between 8 and 15 c the lowest temperature in january is 1 8 1 0 c and the highest temperature in july is 26 32 c overall ncp is featured by the obvious changes in four seasons large temperature differences and uneven spatial and temporal distribution of precipitation hence this area is identified as a drought prone area bi et al 2019 jiang et al 2019 in this area groundwater is the main source of water supply and the proportion of groundwater exploitation to total water consumption is 67 79 groundwater is also the main irrigation water source for agricultural irrigation accounting for 62 9 of the total agricultural irrigation water consumption the extensive use of groundwater for irrigation has resulted in continuous decline in groundwater levels over the past four decades compromising both hydrological balance and sustainable agricultural production hu et al 2010 moreover areas without irrigation conditions are often seriously threatened by drought so the conflict between supply and demand of crop water has become a major restricting factor in ncp 2 2 datasets as the full propagation process of drought is closely related to the variations and interaction between precipitation runoff and soil moisture all these variables data should be used meanwhile to improve the credibility of the propagation results datasets with long term records e g from 1981 to 2018 should be guaranteed these requirements demand high quality data input and also limit the options of available datasets we have also acknowledged that different datasets with different uncertainties would get different results so we selected two widely used datasets that meet the requirements i e the gldas clm dataset at 1 1 per month rodell 2007 and merra 2 dataset at 0 5 0 625 gmao 2015 as shown in table 1 both of them are analyzed here for comparison purpose but we are also interested to find their consistence many studies have verified the reliability of merra 2 and gldas li et al 2015 spennemann et al 2015 bai et al 2016 feng and wang 2019 hua et al 2019 yang and villarini 2019 datasets on drought parameters around the world the community has found merra 2 showed good performance on those variables reichle et al 2017a reichle et al 2017b and gldas also provided reliable information for drought studies long et al 2015 spennemann et al 2015 agutu et al 2017 it is also noted that another important reason for choosing these two datasets is that they are the few available datasets in this study area i e ncp in the following analysis we will check the differences and also the consistencies of drought propagation information obtained by them respectively 3 methodology 3 1 method design for building the response relationship model considering the close relationship between meteorological hydrological and soil moisture droughts the response relationship model is established for calculating the characteristics of the drought propagation by using the method of regression analysis and run theory model construction is established using the following three steps as shown in fig 2 two experiments have been conducted since we have two different datasets here each experiment is consisted of three parts first drought severity is evaluated based on standardized and quantitative indices then drought characteristics by different data sources are identified including duration and magnitude then the drought events are obtained according to the area threshold lastly linear and nonlinear models will be built to verify the accuracy of models and analyze the accuracy of the model in every grid of ncp 3 2 calculation of drought index in this study spi sri and ssi indices i e s indices have been adopted to quantify meteorological hydrological and soil moisture droughts respectively mckee et al 1993 shukla and wood 2008 hao and aghakouchak 2013 these drought indices have been useful and widely used xiang et al 2017 zhang et al 2017b considering the influence of seasonal factors the spi 3 sri 3 and ssi 3 were calculated by using a gamma model which was the most suitable for these variables the range and grading threshold of each index are shown in table 2 3 3 run theory analysis run theory yevjevich 1967 is a widely used method in drought research chang et al 2016 which is used to extract drought characteristics including the duration and magnitude as show in fig 3 x is assumed to intercept a given time varying series of discrete x t a positive run occurs when one or more consecutive periods and greater than x and a negative run occurs when x t is continuously less than x in the study of drought the length of negative run is called drought duration d which is the length from the beginning to the end of drought the total negative run is called drought magnitude m also known as the severity of drought that is the cumulative sum of all values less than the truncated level in the drought duration it is worth noting that the drought development process is usually slow and long lasting during a period of drought for some reasons such as temporary precipitation several sub drought like d 0 d 2 in fig 3 may occur these adjacent sub drought constitutes an interrelated non independent drought event but they are essentially a drought event defining the drought duration at this time is the sum of the initial sub drought to the end sub drought and the corresponding magnitude is the sum of the sub drought magnitude according to the classification of drought level x 0 is set as the truncation level of s index when s 0 the corresponding month is likely to be identified as the drought event the four drought events in fig 3 including d 0 d 1 d 0 and d 2 if s 0 8 and it only contains one month this month is defined as an independent drought event such as d 0 with a magnitude m 0 if a drought event includes multiple consecutive negative s values it is also defined as a drought such as d 1 and its magnitude m 1 if a drought process contains multiple branches such as d 0 d 2 and the time span d 1 between d 0 and d 2 is less than 1 month in which s 1 these months are still treated as a single drought event d 2 d 0 d 1 d 2 the corresponding magnitude was then defined as m 2 m 0 m 1 based on the run theory the duration and magnitude of meteorological hydrological and soil moisture droughts in ncp can be reliably obtained by analyzing the values of each grid of merra 2 and gldas datasets in order to eliminate a small number of outliers and exclude a few local droughts the drought event is defined and recorded when drought occurred more than 42 of the area in this study as discussed in section 4 3 this value is the average of results of influence degree and both datasets showed this threshold when determining a drought the drought duration is the recorded length from the beginning to the end of drought event and the drought magnitude is the average drought magnitude of the areas recorded by drought event 3 4 construction of the propagation relationship model first drought characteristics of different data sources are selected according to the data sources this study is divided into two groups of experiments in experiment 1 the merra 2 dataset is used to calculate those drought indices in experiment 2 those indices are calculated by the gldas dataset the spi 3 sri 3 and ssi 3 from 1981 to 2018 are calculated for the study area and then the duration and magnitude of meteorological hydrological and soil moisture droughts are extracted using run theory then five linear and nonlinear models of drought characteristics are built those relational models include linear model multivariate non linear model power function exponential function and logarithmic function the cross validation method is used to construct and validate these relationship models the main idea of cross validation is to divide the sample into two parts most of which are used for model construction called training set and the remaining small part of data is used for model verification called test set wu et al 2017 finally the model with the smallest error between simulated and measured can be selected as the prediction model according to different sample combinations the goodness of fit of the model is related to the ratio of the training sample to the test sample and the optimal ratio value is set bigger than 2 shao 1997 according to this rule the ratio values between 2 and 3 were set in this study the above relationship models are validated to obtain the best model for drought propagation modeling to evaluate the prediction effect of the model r 2 adjusted r 2 average of absolute error avg ae and nash sutcliffe coefficient n sc are used for evaluation the formulas of r 2 avg ae and n sc are defined in table 3 the best fitting model is selected to simulate the whole region and the fitting results are evaluated by evaluation indices 4 results and discussion 4 1 identification of drought propagation duration and magnitude the characteristics of meteorological hydrological soil moisture drought are shown in fig 4 in order to validate the results the actual drought condition from the national bureau of statistics of china has also been visualized and compared in fig 4 j it was found that the meteorological drought identified by gldas data has occurred 42 times with an average duration of 5 43 months the merra 2 data identified 41 meteorological droughts with an average duration of 6 56 months with regard to hydrological drought the hydrological drought identified by gldas data has occurred 37 times with an average duration of 7 76 months and the merra 2 data identified 32 hydrological droughts with an average duration of 8 44 months for soil moisture drought the drought event is 39 times with an average duration of 6 33 months in gldas data and 23 soil moisture droughts with an average duration of 11 69 months in merra 2 data apparently hydrological and soil moisture drought occur more continuously in other words meteorological drought lasts shorter than hydrological and soil moisture drought but it occurs more frequently in ncp the meteorological and hydrological drought based on merra 2 is shown in fig 4 b it is found that the time of severe meteorological and hydrological drought are both concentrated around 1982 01 1996 06 also it can be seen from fig 4 e that the most serious period of soil moisture drought based on merra 2 is 1982 01 1996 06 while the meteorological drought based on gldas is concentrated in 1995 11 1997 12 fig 4 h shows the time series of hydrological and soil moisture droughts based on gldas the period when the hydrological drought occurred more severely is 1994 02 2000 07 and the most serious soil moisture drought occurred in 1996 01 1997 10 from the actual drought records showed in fig 4 j it was found that the drought was more serious during 1982 to 2004 in 1990 the study area was least affected by the drought then after 2005 the drought in ncp was reduced significantly comparing fig 4 b e h with fig 4 f it can be found that no datasets can perfectly reflect the actual situation for example merra 2 can capture the drought in 1990 is slightly weak but it did not reflect the real situation in 1995 this is also the reason we chose two different datasets for the analysis to reduce the uncertainty in one dataset after comparison it is found that the magnitude of gldas was much smaller compared with merra 2 in 1982 1995 the time of drought were similar to the actual situation for example the gldas dataset showed that the drought in 1985 1987 and 1990 were less severe from 2000 to 2018 the two data sources were consistent hence it was found that gldas dataset underestimated the drought during 1982 to 1994 based on the comparison of the two datasets in fig 4 the time of drought described by two datasets is almost synchronous and it also similar to the actual drought events while the magnitude of drought described by merra 2 is closer to actual situation therefore we conclude that merra 2 can better reflect the actual situation than gldas based on these findings it can be found that the drought events are slightly different in the two datasets even from 2000 to 2019 we found the number of drought events related to the threshold of the area which determined whether the drought recorded or not here we compared different thresholds between these two datasets as shown in fig 5 it can be found that although drought events identified by different thresholds are different the occurrence features of drought under each threshold are roughly the same namely meteorological drought occurs more frequently than hydrological and soil moisture drought especially in merra 2 datasets also it can be found that the threshold of 50 has the largest number of drought events in both two datasets therefore although there is slight difference in the two datasets the occurrence features and the influence degree i e the slope in fitting function of duration and magnitude in the result are the same besides 87 50 of the variance in influence degree between those droughts is close to zero this indicated that the difference of influence degree under different thresholds is small the detailed information is exhibited in section 4 3 actually this is the general practice to consider and compare the different uncertainties of datasets jamshidi et al 2019b for example zhou et al 2012 compared the remotely sensed and meteorological data derived drought indices in ncp they found the combined use of different indices at the same time or indices which integrate various sources of information may obtain more consistent results with the actual situation in other words using just one data source is not enough to capture the variation and uncertainties in drought identification mallya et al 2016 this is also the reason that we designed the different experiments in this study to consider all available datasets in this study area we believe this approach is critical for conducting a reliable drought propagation analyses 4 2 the relationship model of drought propagation in order to build the relationship model among meteorological hydrological and soil moisture droughts and to analyze the differences between different data sources two experiments have been conducted below in particular the relationship models of the meteorological hydrological drought process spi sri and the hydrological soil moisture drought process sri ssi in the two groups of experiments are established on the basis of drought duration and magnitude respectively the events of the two droughts propagations in experiment 2 are shown in table s1 the other experiment has the similar results and will be analyzed below it was found there was no absolute synchronization between meteorological hydrological and soil moisture drought as shown in table s1 in other words meteorological droughts not always caused hydrological droughts for example meteorological drought occurred in 1985 04 but hydrological drought did not occur at that time considering the influence of climate and basin characteristics it has the possibility that there is a lag between those sub droughts and some studies have been analyzed other driven factors affecting the occurrence of agricultural and hydrological drought besides meteorological drought li et al 2018 xu et al 2019 hence it is understandable that there would be a lag between the hydrological and meteorological drought events given the hydrological climate and basin characteristics in order to quantify this connection fig 6 shows the proportion of different drought propagation patterns it can be found that only a few meteorological hydrological and soil moisture drought occur alone and most meteorological hydrological m h droughts and hydrological soil moisture h s droughts are related these sub droughts are overlapped in occurrence for example in gldas datasets there was only one meteorological drought which did not occur at the same time with hydrological drought while there are three hydrological drought happened without prior meteorological droughts considering human activities and agricultural activities hydrological drought would be influenced apurv et al 2017 ma et al 2019a however from the probability of this results this phenomenon is a low probability event in the study area besides there is the case that some sub meteorological drought is related to one hydrological drought according to the run theory analysis they are treated as one meteorological drought and 31 meteorological droughts were linked with hydrological droughts in gldas datasets here we propose a index of synchronization rate to quantify this characteristic it recorded occurrence of two sub type droughts which are related in time it can be found that the synchronization rate is more than 91 89 between meteorological and hydrological droughts and it is more than 87 10 between hydrological and soil moisture drought these results were over 80 00 and demonstrated that characteristics in meteorological hydrological and soil moisture drought have a strong relationship in ncp the high synchronization rate also indicated that in the study area the propagation time between meteorological hydrological and soil moisture drought is typically within a month based on the above analyses we established the relational model based on the m h and h s with high synchronization rate the data in table s1 is divided into three groups of sample distribution to build the model according to cross validation the truncation level is 20 specifically the first 20 groups are training data and the remaining are test data in model 1 the middle 20 groups are training data in model 2 the last 20 groups are training data in model 3 while in other experiment the numbers of samples are 30 in m h and 20 in h s the corresponding truncation level is 20 and 15 respectively which comply with optimal ratio these results are shown in tables s2 and s3 in tables s2 and s3 it is found that the larger values of r 2 are linear and quadratic function model for the duration and magnitude with 62 50 of r 2 are higher than 0 8 specifically for duration the two experiment both show good fitting effect and the r 2 of 83 33 in merra 2 and 91 67 in gldas are over 0 8 however the results of magnitude show little differences experiment 1 show good fitting effect both on m h and h s based on merra 2 data and 66 67 of the r 2 in linear and quadratic models are greater than 0 8 while linear and quadratic models with r 2 greater than 0 8 in experiment 2 only occupies 8 33 of the total r 2 in both models this indicated that the fitting effect of the gldas dataset on the magnitude equation is worse than the merra 2 dataset these results proved again that although the accuracy of each experiment is not exact the same both datasets show a strong correlation between the duration of different drought stages 4 3 validation of the propagation relationship model the remaining statistical data of drought characteristics of the constructed model are respectively substituted into the above fitting equations to obtain the simulated values of drought characteristics under different conditions they are also compared with the actual drought characteristic values to evaluate the goodness of fit of each model the results of the evaluation indicators are obtained as shown in tables s4 and s5 it can be found that both for duration and magnitude the linear model fits better than other functions although the quadratic function has a higher r 2 value the result of cross validation is not as good as that of linear function 62 50 of the results in avg ae and n sc of linear model are better than those in quadratic model therefore the linear model is chosen as the fitting function according to the evaluation results the linear equation is well fitted both in duration and magnitude 87 50 of avg ae are lower than 0 04 and 50 00 of n sc are higher than 0 70 combining r 2 and evaluation indicators in table s2 to s5 the best fitting models of drought duration and magnitude in m h and h s are shown in table 4 in terms of duration it can be found that the degree of hydrological drought affected by meteorological drought is 1 016 and 1 006 respectively in the two experiments also the degree of soil moisture drought affected by hydrological drought is 0 992 and 0 784 respectively it can be found that the degree both in m h and h s are about one month in duration what s more for magnitude the degree of hydrological drought affected by meteorological drought is 1 687 and 0 928 in merra 2 and gldas respectively the degree of soil moisture drought affected by hydrological drought is 1 406 and 0 922 respectively as discussed in section 4 1 the threshold of the area determined the number of drought events hence we also compared the degree in different thresholds at linear function which fits best according to the above discussion as shown in the fig 7 it can be found that the difference in degree between different thresholds is not obvious and the difference between the two datasets is small the average duration degree in m h of merra2 and gldas is 1 06 and 0 99 in h s is 1 00 and 0 90 respectively and the average magnitude degree in m h of merra 2 and gldas is 1 55 and 0 88 in h s is 1 04 and 1 00 these findings showed the differences in the two datasets while it can be concluded that the degree of duration in m h and h s are both close to one month in merra 2 and gldas datasets this finding also indicated the influence degree in magnitude of h s was close to 1 and of m h was close to 1 22 those explored the common part of the two datasets meanwhile the degree under the area threshold of 42 showed on table 4 is the closest to the average degree both in each dataset this is the reason why we chose this threshold in this study area moreover it can be found the curve of m h is floating in gldas dataset from this analysis it can be concluded that the selection of area threshold i e 42 is not the decisive factor for the influence degree overall although there is a little difference between gldas and merra 2 datasets the tendency of the two datasets is similar according to the above analysis the fitting function is selected which is the closest to the average value and bolded in table 4 therefore with synchronization rate it can be concluded that when the duration of meteorological drought is prolonged or shortened by a month more than 91 89 probability will lead to the extension or shortening of hydrological drought about 0 992 months with the magnitude to change 1 687 unit and when the duration of hydrological drought changes in a unit more than 87 10 probability of the soil moisture drought duration will change about 1 006 months with the magnitude to change 0 992 unit 4 4 adaptability analysis in northern china plain in order to analyze the adaptability of those fitting functions in every grid of ncp those selected functions are used to simulate the different drought propagations and the evaluation results are shown in fig 8 it can be found that all the fitting functions fit well in ncp both on duration and magnitude of merra 2 and gldas datasets as the avg ae is close to 0 and the n sc is close to 1 the good fitting results indicated the fitting function adapted well in ncp therefore the fitting function f x 0 992x 0 326 in duration and f x 1 687x 0 335 in magnitude of spi sri and f x 1 006x 1 750 in duration and f x 0 992x 1 059 in magnitude of sri ssi can well describe the characteristics of the drought propagation process in ncp these are the mathematical expressions of drought propagation in this area the fitting results of other four models have also been computed for comparison take the duration of h s in gldas as an example which is showed in figure s1 after analysis we found that although the other four models may fit better in some areas the improvement in accuracy is not particularly significant therefore the selected model is enough for this area based on the above results it is found the best fitting area of merra 2 and gldas is not the same as shown in fig 8 a h in spi sri process the merra 2 fits well in the middle and lower part of ncp the best fitting area is 30 n 34 n in duration and 34 n 38 n in magnitude while the gldas fits well in the west side of ncp the best fitting area is 110 e 118 e and 32 n 35 n in duration and 110 n 114 n in magnitude however the situation is opposite in sri ssi process as shown in fig 8 i p the merra 2 fits well in the west side of ncp with the best fitting area as 110 e 114 e both in duration and magnitude the gldas fits well in the middle and lower part the best fitting area is 34 n 40 n in duration and 34 n 38 n in magnitude given the above results the two datasets demonstrate two slightly different spatial characterizes of drought propagation by comparing the similarities and differences between the two datasets we should also highlight that combining different datasets to solve one question and focusing on their consistency may obtain the results closer to the truth 5 conclusion the full propagation information from meteorological to agricultural drought is still an unsolved problem in drought community to address this problem this study analyzed the full drought propagation in the north china plain by using and comparing two global datasets the relationship of drought characteristics is established by using run theory and multiple mathematical models overall we found there was a clear propagation relationship in drought duration and magnitude in this area the two datasets show consistency the main conclusions are summarized below meteorological drought occurred more frequently than hydrological and soil moisture drought in both datasets in the process of identifying drought events it was also found that meteorological droughts hydrological droughts and soil moisture droughts were not absolutely synchronous there were a few meteorological droughts which did not evolve into hydrological droughts however the analysis based on these two datasets showed that the synchronization rate was more than 91 89 between meteorological and hydrological droughts and it was more than 87 10 between hydrological and soil moisture droughts therefore it can be concluded that there was a significant relationship between them in both datasets linear models show both the best fitting results in drought duration and magnitude features obtained by merra 2 and gldas datasets compared with multivariate non linear model power function exponential function and logarithmic function based on the above fitting results we can quantify the propagation features from meteorological to agricultural drought we found when meteorological drought was prolonged or shortened by one month more than 91 89 probability it would lead to the extension or shortening of hydrological drought by 0 992 months with 1 687 unit in magnitude and if the duration of hydrological drought changed by one month more than 80 56 probability of the soil moisture drought duration would change by 1 006 months with 0 992 unit in magnitude moreover the selected fitting function also adapted well across the whole area of ncp we also realized that combining different datasets to solve one question and focusing on their consistency could obtain the results closer to the truth credit authorship contribution statement nengcheng chen methodology writing original draft writing review editing funding acquisition ronghui li methodology writing original draft writing review editing visualization xiang zhang conceptualization investigation writing review editing project administration funding acquisition chao yang conceptualization methodology writing review editing xiaoping wang writing review editing visualization linglin zeng writing review editing shengjun tang writing review editing wei wang supervision deren li supervision dev niyogi writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by grants from the national natural science foundation of china program 41801339 41890822 creative research groups of natural science foundation of hubei province of china 2016cfa003 and open research fund of state key laboratory of information engineering in surveying mapping and remote sensing wuhan university 17e04 the authors would like to thank the following data providers matthew rodell and hiroko kato beaudoing nasa gsfc hsl for providing gldas data and the gmao operations group for monitoring the production of merra 2 we also thank the ges disc for providing online access to merra 2 and gldas products appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125026 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5308,drought impact is closely related to water deficit phases within the hydrological cycle and to drought propagation the complex evolutions from meteorological drought to hydrological drought and to soil moisture drought besides the qualitative description the quantitative analysis of drought propagation is still limited so far therefore in this study the propagation from meteorological to hydrological and to soil moisture droughts have been quantitatively analyzed in particular run theory has been utilized for quantifying key drought features including its duration and magnitude the two available land assimilation datasets from 1981 2018 were selected for comparison purpose in northern china plain our results showed that although drought events identified by two datasets were not the same both datasets revealed that meteorological drought occurred more frequently than hydrological and soil moisture droughts and both demonstrated meteorological drought hydrological drought and soil moisture drought were not synchronous in particular more than 91 89 of meteorological droughts led to hydrological droughts and more than 87 10 of hydrological droughts caused soil moisture droughts furthermore linear models showed the best for drought duration and magnitude we found when meteorological drought was prolonged or shortened by one month more than 91 89 probability it would lead to the extension or shortening of hydrological drought by 0 992 months with 1 687 unit in magnitude and if the duration of hydrological drought changed by one month more than 80 56 probability of the soil moisture drought duration would change by 1 006 months with 0 992 unit in magnitude the results of duration and magnitude fitted well across the whole study area building on the above drought evolution information practical drought mitigation measures and early warning system could be established keywords drought propagation drought characterization multi source data response relationship 1 introduction drought is a widespread global natural disaster zou et al 2005 wilhite et al 2007 charusombat and niyogi 2011 due to its high frequency long duration and wide range of influences it not only causes serious economic losses but also threatens people s lives wilhite 2000 aghakouchak et al 2015 hao et al 2016 therefore a key question is how a drought occurs i e drought propagation since 1980s the concept of drought propagation has basic and qualitative understandings dracup et al 1980 for example meteorological drought is regarded as the initial drought occurring when rainfall decreases to a certain level yuan et al 2017 which will usually reduce the ground runoff and trigger hydrological drought with the continuous occurrence of hydrological drought it will further develop into an agricultural drought represented by low soil moisture and crop yield reduction subsequently heim 2002 mishra and singh 2010 ma et al 2019b jamshidi et al 2019a in the above the drought propagation represents the spatial temporal transition of water deficiency from the drought beginning to the end within the atmosphere hydrology soil vegetation system due to the close relationship between these sub types of droughts hao and singh 2015 the propagation of meteorological hydrological and agricultural droughts is especially valuable for improving the accuracy of drought analysis and prediction however with the intensification of climate change and human activities it is more difficult to accurately identify the spatial and temporal evolution of drought ma et al 2019a many researchers have pointed out that the spatial and temporal features of drought propagation is critical to deepen our understanding of drought events and build a time sensitive drought prediction and early warning model barker et al 2016 van loon et al 2016 bachmair et al 2018 zhang et al 2018 most previous drought studies focused on drought concepts monitoring and predictions zhang et al 2017a wu et al 2018a dash et al 2019 samantaray et al 2019 zhang et al 2019 due to its complex mechanism the study of drought propagation just began around 2001 at the first the basic features and time of drought propagation had been investigated stahl 2001 peters 2003 van loon et al 2012 for example van loon et al 2012 studied drought characteristics drought propagation features and hydrological drought typology they found that the simulated drought characteristics could clearly reflect the propagation of drought lorenzo lacruz et al 2013 correlated a standardized precipitation index spi from 1 month to 48 months with a standardized streamflow index to assess the response time of hydrological drought to spi by correlation method in recent years studies globally have found various impact factors of drought propagation including temperature peña gallardo et al 2018 climate type pan et al 2017 gevaert et al 2018 catchment characteristics van loon and laaha 2015 and land cover and reservoirs wu et al 2018b for example wu et al 2018c detected the relationship between extreme climate index and drought by variance decomposition method and explored the potential factors affecting drought propagation time ma et al 2019a conducted three hydrological simulation experiments to distinguish the contribution of climate change and human activities to hydrological drought by controlling variables building on these studies propagation speed has been proposed and analyzed wu et al 2018a considering the above studies most of them only focused on meteorological drought to hydrological drought with the lack of propagation from hydrological to agricultural drought however the full drought evolution knowledge can only be revealed by studying the complete drought propagation within the atmosphere hydrology soil vegetation system meanwhile the widely used correlation method mostly focuses on duration of drought and ignores magnitude lópez moreno et al 2013 lorenzo lacruz et al 2013 kazemzadeh and malekian 2016 wu et al 2016 huang et al 2017 which make it difficult to fully investigate the relationship between meteorological hydrological and soil moisture drought wu et al 2017 we will investigate the whole drought propagation from meteorological to agricultural droughts both from propagation duration and magnitude characteristics in this study moreover the spatial information of drought propagation will also be analyzed to achieve that run theory is adopted to quantify the drought duration and magnitude characteristics and regression analysis method is adopted to quantify the relationship in duration and magnitude of drought two globally validated datasets i e merra 2 and gldas have been selected and compared for the study area this study is expected to firstly provide vital and useful information for the local drought early warning and mitigation 2 study area and datasets 2 1 study area the study area i e northern china plain ncp covers the cities of beijing and tianjin and five provinces of jiangsu anhui henan hebei and shandong as shown in fig 1 it is one of the most important grain production bases and produces more than 68 of winter wheat in china most of the winter wheat producing areas located in the temperate semi arid monsoon climate and annual rainfall varies between 400 850 mm wu et al 2006 the annual distribution of precipitation is uneven mainly concentrated in july to september the annual mean temperature ranged between 8 and 15 c the lowest temperature in january is 1 8 1 0 c and the highest temperature in july is 26 32 c overall ncp is featured by the obvious changes in four seasons large temperature differences and uneven spatial and temporal distribution of precipitation hence this area is identified as a drought prone area bi et al 2019 jiang et al 2019 in this area groundwater is the main source of water supply and the proportion of groundwater exploitation to total water consumption is 67 79 groundwater is also the main irrigation water source for agricultural irrigation accounting for 62 9 of the total agricultural irrigation water consumption the extensive use of groundwater for irrigation has resulted in continuous decline in groundwater levels over the past four decades compromising both hydrological balance and sustainable agricultural production hu et al 2010 moreover areas without irrigation conditions are often seriously threatened by drought so the conflict between supply and demand of crop water has become a major restricting factor in ncp 2 2 datasets as the full propagation process of drought is closely related to the variations and interaction between precipitation runoff and soil moisture all these variables data should be used meanwhile to improve the credibility of the propagation results datasets with long term records e g from 1981 to 2018 should be guaranteed these requirements demand high quality data input and also limit the options of available datasets we have also acknowledged that different datasets with different uncertainties would get different results so we selected two widely used datasets that meet the requirements i e the gldas clm dataset at 1 1 per month rodell 2007 and merra 2 dataset at 0 5 0 625 gmao 2015 as shown in table 1 both of them are analyzed here for comparison purpose but we are also interested to find their consistence many studies have verified the reliability of merra 2 and gldas li et al 2015 spennemann et al 2015 bai et al 2016 feng and wang 2019 hua et al 2019 yang and villarini 2019 datasets on drought parameters around the world the community has found merra 2 showed good performance on those variables reichle et al 2017a reichle et al 2017b and gldas also provided reliable information for drought studies long et al 2015 spennemann et al 2015 agutu et al 2017 it is also noted that another important reason for choosing these two datasets is that they are the few available datasets in this study area i e ncp in the following analysis we will check the differences and also the consistencies of drought propagation information obtained by them respectively 3 methodology 3 1 method design for building the response relationship model considering the close relationship between meteorological hydrological and soil moisture droughts the response relationship model is established for calculating the characteristics of the drought propagation by using the method of regression analysis and run theory model construction is established using the following three steps as shown in fig 2 two experiments have been conducted since we have two different datasets here each experiment is consisted of three parts first drought severity is evaluated based on standardized and quantitative indices then drought characteristics by different data sources are identified including duration and magnitude then the drought events are obtained according to the area threshold lastly linear and nonlinear models will be built to verify the accuracy of models and analyze the accuracy of the model in every grid of ncp 3 2 calculation of drought index in this study spi sri and ssi indices i e s indices have been adopted to quantify meteorological hydrological and soil moisture droughts respectively mckee et al 1993 shukla and wood 2008 hao and aghakouchak 2013 these drought indices have been useful and widely used xiang et al 2017 zhang et al 2017b considering the influence of seasonal factors the spi 3 sri 3 and ssi 3 were calculated by using a gamma model which was the most suitable for these variables the range and grading threshold of each index are shown in table 2 3 3 run theory analysis run theory yevjevich 1967 is a widely used method in drought research chang et al 2016 which is used to extract drought characteristics including the duration and magnitude as show in fig 3 x is assumed to intercept a given time varying series of discrete x t a positive run occurs when one or more consecutive periods and greater than x and a negative run occurs when x t is continuously less than x in the study of drought the length of negative run is called drought duration d which is the length from the beginning to the end of drought the total negative run is called drought magnitude m also known as the severity of drought that is the cumulative sum of all values less than the truncated level in the drought duration it is worth noting that the drought development process is usually slow and long lasting during a period of drought for some reasons such as temporary precipitation several sub drought like d 0 d 2 in fig 3 may occur these adjacent sub drought constitutes an interrelated non independent drought event but they are essentially a drought event defining the drought duration at this time is the sum of the initial sub drought to the end sub drought and the corresponding magnitude is the sum of the sub drought magnitude according to the classification of drought level x 0 is set as the truncation level of s index when s 0 the corresponding month is likely to be identified as the drought event the four drought events in fig 3 including d 0 d 1 d 0 and d 2 if s 0 8 and it only contains one month this month is defined as an independent drought event such as d 0 with a magnitude m 0 if a drought event includes multiple consecutive negative s values it is also defined as a drought such as d 1 and its magnitude m 1 if a drought process contains multiple branches such as d 0 d 2 and the time span d 1 between d 0 and d 2 is less than 1 month in which s 1 these months are still treated as a single drought event d 2 d 0 d 1 d 2 the corresponding magnitude was then defined as m 2 m 0 m 1 based on the run theory the duration and magnitude of meteorological hydrological and soil moisture droughts in ncp can be reliably obtained by analyzing the values of each grid of merra 2 and gldas datasets in order to eliminate a small number of outliers and exclude a few local droughts the drought event is defined and recorded when drought occurred more than 42 of the area in this study as discussed in section 4 3 this value is the average of results of influence degree and both datasets showed this threshold when determining a drought the drought duration is the recorded length from the beginning to the end of drought event and the drought magnitude is the average drought magnitude of the areas recorded by drought event 3 4 construction of the propagation relationship model first drought characteristics of different data sources are selected according to the data sources this study is divided into two groups of experiments in experiment 1 the merra 2 dataset is used to calculate those drought indices in experiment 2 those indices are calculated by the gldas dataset the spi 3 sri 3 and ssi 3 from 1981 to 2018 are calculated for the study area and then the duration and magnitude of meteorological hydrological and soil moisture droughts are extracted using run theory then five linear and nonlinear models of drought characteristics are built those relational models include linear model multivariate non linear model power function exponential function and logarithmic function the cross validation method is used to construct and validate these relationship models the main idea of cross validation is to divide the sample into two parts most of which are used for model construction called training set and the remaining small part of data is used for model verification called test set wu et al 2017 finally the model with the smallest error between simulated and measured can be selected as the prediction model according to different sample combinations the goodness of fit of the model is related to the ratio of the training sample to the test sample and the optimal ratio value is set bigger than 2 shao 1997 according to this rule the ratio values between 2 and 3 were set in this study the above relationship models are validated to obtain the best model for drought propagation modeling to evaluate the prediction effect of the model r 2 adjusted r 2 average of absolute error avg ae and nash sutcliffe coefficient n sc are used for evaluation the formulas of r 2 avg ae and n sc are defined in table 3 the best fitting model is selected to simulate the whole region and the fitting results are evaluated by evaluation indices 4 results and discussion 4 1 identification of drought propagation duration and magnitude the characteristics of meteorological hydrological soil moisture drought are shown in fig 4 in order to validate the results the actual drought condition from the national bureau of statistics of china has also been visualized and compared in fig 4 j it was found that the meteorological drought identified by gldas data has occurred 42 times with an average duration of 5 43 months the merra 2 data identified 41 meteorological droughts with an average duration of 6 56 months with regard to hydrological drought the hydrological drought identified by gldas data has occurred 37 times with an average duration of 7 76 months and the merra 2 data identified 32 hydrological droughts with an average duration of 8 44 months for soil moisture drought the drought event is 39 times with an average duration of 6 33 months in gldas data and 23 soil moisture droughts with an average duration of 11 69 months in merra 2 data apparently hydrological and soil moisture drought occur more continuously in other words meteorological drought lasts shorter than hydrological and soil moisture drought but it occurs more frequently in ncp the meteorological and hydrological drought based on merra 2 is shown in fig 4 b it is found that the time of severe meteorological and hydrological drought are both concentrated around 1982 01 1996 06 also it can be seen from fig 4 e that the most serious period of soil moisture drought based on merra 2 is 1982 01 1996 06 while the meteorological drought based on gldas is concentrated in 1995 11 1997 12 fig 4 h shows the time series of hydrological and soil moisture droughts based on gldas the period when the hydrological drought occurred more severely is 1994 02 2000 07 and the most serious soil moisture drought occurred in 1996 01 1997 10 from the actual drought records showed in fig 4 j it was found that the drought was more serious during 1982 to 2004 in 1990 the study area was least affected by the drought then after 2005 the drought in ncp was reduced significantly comparing fig 4 b e h with fig 4 f it can be found that no datasets can perfectly reflect the actual situation for example merra 2 can capture the drought in 1990 is slightly weak but it did not reflect the real situation in 1995 this is also the reason we chose two different datasets for the analysis to reduce the uncertainty in one dataset after comparison it is found that the magnitude of gldas was much smaller compared with merra 2 in 1982 1995 the time of drought were similar to the actual situation for example the gldas dataset showed that the drought in 1985 1987 and 1990 were less severe from 2000 to 2018 the two data sources were consistent hence it was found that gldas dataset underestimated the drought during 1982 to 1994 based on the comparison of the two datasets in fig 4 the time of drought described by two datasets is almost synchronous and it also similar to the actual drought events while the magnitude of drought described by merra 2 is closer to actual situation therefore we conclude that merra 2 can better reflect the actual situation than gldas based on these findings it can be found that the drought events are slightly different in the two datasets even from 2000 to 2019 we found the number of drought events related to the threshold of the area which determined whether the drought recorded or not here we compared different thresholds between these two datasets as shown in fig 5 it can be found that although drought events identified by different thresholds are different the occurrence features of drought under each threshold are roughly the same namely meteorological drought occurs more frequently than hydrological and soil moisture drought especially in merra 2 datasets also it can be found that the threshold of 50 has the largest number of drought events in both two datasets therefore although there is slight difference in the two datasets the occurrence features and the influence degree i e the slope in fitting function of duration and magnitude in the result are the same besides 87 50 of the variance in influence degree between those droughts is close to zero this indicated that the difference of influence degree under different thresholds is small the detailed information is exhibited in section 4 3 actually this is the general practice to consider and compare the different uncertainties of datasets jamshidi et al 2019b for example zhou et al 2012 compared the remotely sensed and meteorological data derived drought indices in ncp they found the combined use of different indices at the same time or indices which integrate various sources of information may obtain more consistent results with the actual situation in other words using just one data source is not enough to capture the variation and uncertainties in drought identification mallya et al 2016 this is also the reason that we designed the different experiments in this study to consider all available datasets in this study area we believe this approach is critical for conducting a reliable drought propagation analyses 4 2 the relationship model of drought propagation in order to build the relationship model among meteorological hydrological and soil moisture droughts and to analyze the differences between different data sources two experiments have been conducted below in particular the relationship models of the meteorological hydrological drought process spi sri and the hydrological soil moisture drought process sri ssi in the two groups of experiments are established on the basis of drought duration and magnitude respectively the events of the two droughts propagations in experiment 2 are shown in table s1 the other experiment has the similar results and will be analyzed below it was found there was no absolute synchronization between meteorological hydrological and soil moisture drought as shown in table s1 in other words meteorological droughts not always caused hydrological droughts for example meteorological drought occurred in 1985 04 but hydrological drought did not occur at that time considering the influence of climate and basin characteristics it has the possibility that there is a lag between those sub droughts and some studies have been analyzed other driven factors affecting the occurrence of agricultural and hydrological drought besides meteorological drought li et al 2018 xu et al 2019 hence it is understandable that there would be a lag between the hydrological and meteorological drought events given the hydrological climate and basin characteristics in order to quantify this connection fig 6 shows the proportion of different drought propagation patterns it can be found that only a few meteorological hydrological and soil moisture drought occur alone and most meteorological hydrological m h droughts and hydrological soil moisture h s droughts are related these sub droughts are overlapped in occurrence for example in gldas datasets there was only one meteorological drought which did not occur at the same time with hydrological drought while there are three hydrological drought happened without prior meteorological droughts considering human activities and agricultural activities hydrological drought would be influenced apurv et al 2017 ma et al 2019a however from the probability of this results this phenomenon is a low probability event in the study area besides there is the case that some sub meteorological drought is related to one hydrological drought according to the run theory analysis they are treated as one meteorological drought and 31 meteorological droughts were linked with hydrological droughts in gldas datasets here we propose a index of synchronization rate to quantify this characteristic it recorded occurrence of two sub type droughts which are related in time it can be found that the synchronization rate is more than 91 89 between meteorological and hydrological droughts and it is more than 87 10 between hydrological and soil moisture drought these results were over 80 00 and demonstrated that characteristics in meteorological hydrological and soil moisture drought have a strong relationship in ncp the high synchronization rate also indicated that in the study area the propagation time between meteorological hydrological and soil moisture drought is typically within a month based on the above analyses we established the relational model based on the m h and h s with high synchronization rate the data in table s1 is divided into three groups of sample distribution to build the model according to cross validation the truncation level is 20 specifically the first 20 groups are training data and the remaining are test data in model 1 the middle 20 groups are training data in model 2 the last 20 groups are training data in model 3 while in other experiment the numbers of samples are 30 in m h and 20 in h s the corresponding truncation level is 20 and 15 respectively which comply with optimal ratio these results are shown in tables s2 and s3 in tables s2 and s3 it is found that the larger values of r 2 are linear and quadratic function model for the duration and magnitude with 62 50 of r 2 are higher than 0 8 specifically for duration the two experiment both show good fitting effect and the r 2 of 83 33 in merra 2 and 91 67 in gldas are over 0 8 however the results of magnitude show little differences experiment 1 show good fitting effect both on m h and h s based on merra 2 data and 66 67 of the r 2 in linear and quadratic models are greater than 0 8 while linear and quadratic models with r 2 greater than 0 8 in experiment 2 only occupies 8 33 of the total r 2 in both models this indicated that the fitting effect of the gldas dataset on the magnitude equation is worse than the merra 2 dataset these results proved again that although the accuracy of each experiment is not exact the same both datasets show a strong correlation between the duration of different drought stages 4 3 validation of the propagation relationship model the remaining statistical data of drought characteristics of the constructed model are respectively substituted into the above fitting equations to obtain the simulated values of drought characteristics under different conditions they are also compared with the actual drought characteristic values to evaluate the goodness of fit of each model the results of the evaluation indicators are obtained as shown in tables s4 and s5 it can be found that both for duration and magnitude the linear model fits better than other functions although the quadratic function has a higher r 2 value the result of cross validation is not as good as that of linear function 62 50 of the results in avg ae and n sc of linear model are better than those in quadratic model therefore the linear model is chosen as the fitting function according to the evaluation results the linear equation is well fitted both in duration and magnitude 87 50 of avg ae are lower than 0 04 and 50 00 of n sc are higher than 0 70 combining r 2 and evaluation indicators in table s2 to s5 the best fitting models of drought duration and magnitude in m h and h s are shown in table 4 in terms of duration it can be found that the degree of hydrological drought affected by meteorological drought is 1 016 and 1 006 respectively in the two experiments also the degree of soil moisture drought affected by hydrological drought is 0 992 and 0 784 respectively it can be found that the degree both in m h and h s are about one month in duration what s more for magnitude the degree of hydrological drought affected by meteorological drought is 1 687 and 0 928 in merra 2 and gldas respectively the degree of soil moisture drought affected by hydrological drought is 1 406 and 0 922 respectively as discussed in section 4 1 the threshold of the area determined the number of drought events hence we also compared the degree in different thresholds at linear function which fits best according to the above discussion as shown in the fig 7 it can be found that the difference in degree between different thresholds is not obvious and the difference between the two datasets is small the average duration degree in m h of merra2 and gldas is 1 06 and 0 99 in h s is 1 00 and 0 90 respectively and the average magnitude degree in m h of merra 2 and gldas is 1 55 and 0 88 in h s is 1 04 and 1 00 these findings showed the differences in the two datasets while it can be concluded that the degree of duration in m h and h s are both close to one month in merra 2 and gldas datasets this finding also indicated the influence degree in magnitude of h s was close to 1 and of m h was close to 1 22 those explored the common part of the two datasets meanwhile the degree under the area threshold of 42 showed on table 4 is the closest to the average degree both in each dataset this is the reason why we chose this threshold in this study area moreover it can be found the curve of m h is floating in gldas dataset from this analysis it can be concluded that the selection of area threshold i e 42 is not the decisive factor for the influence degree overall although there is a little difference between gldas and merra 2 datasets the tendency of the two datasets is similar according to the above analysis the fitting function is selected which is the closest to the average value and bolded in table 4 therefore with synchronization rate it can be concluded that when the duration of meteorological drought is prolonged or shortened by a month more than 91 89 probability will lead to the extension or shortening of hydrological drought about 0 992 months with the magnitude to change 1 687 unit and when the duration of hydrological drought changes in a unit more than 87 10 probability of the soil moisture drought duration will change about 1 006 months with the magnitude to change 0 992 unit 4 4 adaptability analysis in northern china plain in order to analyze the adaptability of those fitting functions in every grid of ncp those selected functions are used to simulate the different drought propagations and the evaluation results are shown in fig 8 it can be found that all the fitting functions fit well in ncp both on duration and magnitude of merra 2 and gldas datasets as the avg ae is close to 0 and the n sc is close to 1 the good fitting results indicated the fitting function adapted well in ncp therefore the fitting function f x 0 992x 0 326 in duration and f x 1 687x 0 335 in magnitude of spi sri and f x 1 006x 1 750 in duration and f x 0 992x 1 059 in magnitude of sri ssi can well describe the characteristics of the drought propagation process in ncp these are the mathematical expressions of drought propagation in this area the fitting results of other four models have also been computed for comparison take the duration of h s in gldas as an example which is showed in figure s1 after analysis we found that although the other four models may fit better in some areas the improvement in accuracy is not particularly significant therefore the selected model is enough for this area based on the above results it is found the best fitting area of merra 2 and gldas is not the same as shown in fig 8 a h in spi sri process the merra 2 fits well in the middle and lower part of ncp the best fitting area is 30 n 34 n in duration and 34 n 38 n in magnitude while the gldas fits well in the west side of ncp the best fitting area is 110 e 118 e and 32 n 35 n in duration and 110 n 114 n in magnitude however the situation is opposite in sri ssi process as shown in fig 8 i p the merra 2 fits well in the west side of ncp with the best fitting area as 110 e 114 e both in duration and magnitude the gldas fits well in the middle and lower part the best fitting area is 34 n 40 n in duration and 34 n 38 n in magnitude given the above results the two datasets demonstrate two slightly different spatial characterizes of drought propagation by comparing the similarities and differences between the two datasets we should also highlight that combining different datasets to solve one question and focusing on their consistency may obtain the results closer to the truth 5 conclusion the full propagation information from meteorological to agricultural drought is still an unsolved problem in drought community to address this problem this study analyzed the full drought propagation in the north china plain by using and comparing two global datasets the relationship of drought characteristics is established by using run theory and multiple mathematical models overall we found there was a clear propagation relationship in drought duration and magnitude in this area the two datasets show consistency the main conclusions are summarized below meteorological drought occurred more frequently than hydrological and soil moisture drought in both datasets in the process of identifying drought events it was also found that meteorological droughts hydrological droughts and soil moisture droughts were not absolutely synchronous there were a few meteorological droughts which did not evolve into hydrological droughts however the analysis based on these two datasets showed that the synchronization rate was more than 91 89 between meteorological and hydrological droughts and it was more than 87 10 between hydrological and soil moisture droughts therefore it can be concluded that there was a significant relationship between them in both datasets linear models show both the best fitting results in drought duration and magnitude features obtained by merra 2 and gldas datasets compared with multivariate non linear model power function exponential function and logarithmic function based on the above fitting results we can quantify the propagation features from meteorological to agricultural drought we found when meteorological drought was prolonged or shortened by one month more than 91 89 probability it would lead to the extension or shortening of hydrological drought by 0 992 months with 1 687 unit in magnitude and if the duration of hydrological drought changed by one month more than 80 56 probability of the soil moisture drought duration would change by 1 006 months with 0 992 unit in magnitude moreover the selected fitting function also adapted well across the whole area of ncp we also realized that combining different datasets to solve one question and focusing on their consistency could obtain the results closer to the truth credit authorship contribution statement nengcheng chen methodology writing original draft writing review editing funding acquisition ronghui li methodology writing original draft writing review editing visualization xiang zhang conceptualization investigation writing review editing project administration funding acquisition chao yang conceptualization methodology writing review editing xiaoping wang writing review editing visualization linglin zeng writing review editing shengjun tang writing review editing wei wang supervision deren li supervision dev niyogi writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by grants from the national natural science foundation of china program 41801339 41890822 creative research groups of natural science foundation of hubei province of china 2016cfa003 and open research fund of state key laboratory of information engineering in surveying mapping and remote sensing wuhan university 17e04 the authors would like to thank the following data providers matthew rodell and hiroko kato beaudoing nasa gsfc hsl for providing gldas data and the gmao operations group for monitoring the production of merra 2 we also thank the ges disc for providing online access to merra 2 and gldas products appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125026 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5309,floods are generally considered to be the most common natural disaster worldwide climate change and human activity are two key driving factors of flood formation and it is difficult to determine how to quantitatively detect their relative impacts on flood susceptibility as an important non engineering measure of preventing floods and reducing losses flood susceptibility assessment is a synthetic task that involves many factors in this study the flood susceptibility in guangdong province china was assessed based on a cloud model the relative impacts of climate change and human activity on flood susceptibility were also quantitatively investigated from the spatial perspective the results prove that the cloud model is a feasible reasonable and effective method for flood susceptibility assessment approximately 40 of the studied areas have changed their flood susceptibility level since 1985 due to the comprehensive impacts of climate change and human activity of which about 56 3 converted from a low to high level and 43 7 from a high to low level about 35 7 of the areas changed their susceptibility level due to climate change of which 55 8 converted from a low to high level and 44 2 from a high to low level in contrast only 9 8 of the areas changed the susceptibility level due to human activity of which 57 2 converted from a low to high level and 42 8 from a high to low level generally from the spatial perspective climate change has a larger impact on flood susceptibility than human activity this study aims to provide a novel idea to quantitatively detect the relative impacts of climate change and human activity on flood susceptibility from spatial perspective the findings of this study are also expected to enhance the understanding on distribution rule of flood susceptibility in guangdong province and are conducive to taking targeted measures to reduce the flood risk keywords flood susceptibility cloud model spatial perspective membership degree guangdong province 1 introduction floods cause significant casualties and socio economic losses and are one of the most devastating but common natural catastrophic disasters adikari and yoshitani 2009 jongman et al 2012 stijn et al 2013 papaioannou et al 2015 luo et al 2018 it has been reported that global flood losses increased from an average of 7 billion usd in the 1980 s to approximately 24 billion usd per year in the 2000 s kundzewicz et al 2014 and this number is projected to increase to 52 billion usd by 2050 hallegatte et al 2013 it has also been estimated that the global urban population will reach 5 billion by the year 2030 and a single flood could affect the lives of millions of people gaines 2016 therefore the occurrence of floods poses a major threat to human society both in the present and future although flooding cannot be completely prevented corresponding protective measures can be taken to minimize the resulting loss apel et al 2009 among the available measures flood susceptibility assessment is considered to be effective for flood defense and management flood hazard prevention and reduction post disaster relief and flood insurance businesses wang et al 2015 lai et al 2016 however assessment is a very complicated topic because it involves many elements including climatic and anthropogenic factors wu et al 2017 muis et al 2015 luo et al 2019 khosravi et al 2019 for example many large floods are attributed to the increased frequency and intensity of short duration rainfall yilmaz et al 2014 wu et al 2018a driven by global climate change bronstert 2010 jie et al 2011 kundzewicz et al 2014 generally when the intensity of rainfall is much higher than the soil infiltration flood events may easily occur wang et al 2017a kanani sadat et al 2019 zeng et al 2019 this is an obvious threat especially for highly urbanized areas in addition floods are also largely affected by anthropogenic activities including farming urban expansion land use and land cover change lucc and hydraulic engineering construction kalnay and cai 2003 mccarthy et al 2010 zhang et al 2015 liu et al 2018a liu et al 2018b chen et al 2020 which have induced significant hydrological changes salvadore et al 2015 dams et al 2015 pumo et al 2017 arnone et al 2018 most notably the increases of rainfall intensity and impervious surfaces expedite runoff response huang et al 2010 causing higher flow velocities greater river flow hawley and bledsoe 2011 and greater frequencies of peak flow discharge prosdocimi et al 2015 therefore both climate change and human activity play key roles in flood formation however determining whether climate change or human activity will have greater impacts and how to quantify their relative contributions remain difficult problems liu et al 2010 reported that climate variability and human activity each accounted for about 50 of the runoff change in the low flow period in the dongjiang river basin however zhou et al 2018 concluded that the average contributions of human activity and climate change to runoff change in the same basin were 42 and 58 respectively zhan et al 2014 pointed out that the contributions of climate change and human activity to runoff decrease in wei river basin were 22 29 and 71 78 respectively han et al 2019 investigated the dammed lancang river in southwest china and found that climatic change and human activity respectively contributed 57 and 43 to the streamflow changes for the transition time period of 1987 2007 while they respectively contributed 5 and 95 for the post impact period of 2008 2014 xin et al 2019 found that both climate change and direct human activity in huifa river basin induce a decrease in streamflow at the annual scale with 68 of the change contributed by direct human activity lyu et al 2019 discovered that climate change and normal climate variability in chabagou river basin are responsible for about 80 of the decrease in runoff mainly due to reduced precipitation while human activities was responsible for 20 of reductions in runoff generally speaking these previous studies quantified the relative impacts of climate change and human activity on the change of stream flow via statistical methods climate elasticity methods and numerical models which better explain the flood formation mechanism and are convenient for further susceptibility analysis however most of the studies focused on providing a simple rate of relative contribution of the two factors based on time series while the susceptibility distribution and characteristics of all the spatial units have been seldom explored although a simple rate of relative contribution aids in the understanding of the overall effects of climate change and human activity it no longer sufficiently addresses the increasing requirements for the accuracy and depth of flood analysis more detailed regularities of the distribution of floods can be acquired if we quantify the relative impacts of climate change and human activity from the spatial perspective the term flood susceptibility is understood in the context of flood risk management as the probability that a flood will occur meyer et al 2010 dyck and willems 2013 koks et al 2015 hénonin et al 2015 based on the nonlinear relationships between multiple variables and the hazard level flood susceptibility assessment can be regarded as the quantitative evaluation of the degree of a rainstorm s adverse impact kubal et al 2009 ipcc 2012 and usually consists of two parts a disaster inducing factor that is the root cause of a flood and a hazard inducing environment in which floods are more likely to occur fernández and lutz 2010 apel et al 2016 methods of flood susceptibility analysis can be classified into three main categories hydrological and hydrodynamic models multi criteria decision analysis mcda and machine learning models zhao et al 2019 the hydrological and hydrodynamic models such as swmm info works mike series and lisflood fp can obtain appropriate simulation results in line with the actual situation but they also require large amounts of detailed data gai et al 2019 guan et al 2015 li et al 2019 peng et al 2015 wu et al 2018b xu and zhao 2016 which may be a significant difficulty for most studies further due to the limitations of computation time and the need for high resolution data they are more suitable for relatively small areas rather than large areas neal et al 2010 zhang and pan 2014 as components of gis based models fernández and lutz 2010 mcdas including the analytic hierarchy process set pair analysis and fuzzy comprehensive evaluation present the advantages of simple calculation and easy understanding li et al 2012 zou et al 2013 kazakis et al 2015 lai et al 2015 ahmad and verma 2018 cai et al 2019 however these models are limited by a lack of consideration of the indicators randomness and uncertainty chowdary et al 2013 the machine learning methods including support vector machines decision trees artificial neural networks the random forest algorithm and ant colony optimization have also been widely applied to flood susceptibility assessment feng and lu 2010 deng and zhou 2013 tehrany et al 2013 tehrany et al 2015 wang et al 2015 lai et al 2016 khosravi et al 2018 sadler et al 2018 jahangir et al 2019 these methods can be used to easily determine the susceptibility level of a sample point via the correlation between the indicators and historical flood events which avoids the subjective determination of weights however the calculation principle of these methods is complicated and the workload is heavy for large scale areas and some methods are easily susceptible to over learning and the local minimum dilemma during the learning process moreover the size mode location of samples susceptibility level and data types also affect the assessment accuracy in summary the existing methods for flood susceptibility assessment present obvious advantages and disadvantages and therefore new methods should be explored to improve or even solve the disadvantages to avoid the weakness of sample selection and consider the uncertainty and randomness of indicators a cloud model is used in this study to assess flood susceptibility compared with the boundary division of susceptibility grades in other fuzzy evaluation approaches the cloud model is able to extract the values that can best reflect the susceptibility level and then establishes the fuzzy function that accords with the normal distribution due to these advantages cloud models have been applied to many fields including prediction algorithm improvement and knowledge representation among others li et al 1998 although cloud models have also been successfully applied to water quality assessment wang et al 2016 yang et al 2018 and project performance assessment liu et al 2018a liu et al 2018b lu et al 2019 to the best of the authors knowledge they have seldom been applied to flood susceptibility assessment therefore the objectives of this study are to 1 construct a flood susceptibility assessment model based on the cloud model 2 detect the flood susceptibility levels and spatial conversion feature in guangdong province and 3 quantitatively assess the relative impacts of climate change and human activity on flood susceptibility from the spatial perspective this study is expected to provide a unique method for the exploration of the contributions of climate change and human activity to flood hazards and to provide a reference method for flood susceptibility assessment 2 study area and data 2 1 study area guangdong province which is located in southern china and has an area of 179 700 km2 see fig 1 was selected as the study area affected by the east asian monsoon guangdong province has abundant yearly precipitation between 1300 and 2500 mm yuan et al 2018 which is concentrated in april to september however the spatial distribution of precipitation is uneven due to the influence of topography three rainy centers exist in the province enping yangjiang haifeng and longmen qingyuan guangdong province is the richest province in china with a gdp of more than 1 5 trillion usd in 2019 and the famous pearl river delta prd also locates in this province francesch huidobro et al 2017 wang et al 2017b the level of urbanization in the province is high but the construction standards of flood control and drainage facilities are still on the low side in some areas floods are frequent in the province and many heavy floods have taken countless of thousands of lives and caused substantial economic losses since 1900 lai et al 2016 worse still the two cities of guangzhou and shenzhen in the province are ranked as the first and fifth highest risks for future flood losses among 136 major coastal cities hallegatte et al 2013 therefore a systematic assessment of flood susceptibility in the province is vital 2 2 indicator system and data sources flood susceptibility can be considered as consisting of a disaster inducing factor and a hazard inducing environment according to the actual situation in guangdong province and existing literature reviews jiang et al 2009 lai et al 2015 wang et al 2015 tang et al 2019 the maximum 1 day precipitation m1dp and the average days of rainstorm avdr were selected to represent the disaster inducing factor the elevation slope soil type distance to the river and runoff coefficient were selected to measure the hazard inducing environment see fig 2 the disaster inducing factor was measured by the following 1 the m1dp unit mm reflects the intensity of rainfall and was calculated by kriging interpolation technology by using 86 rainfall observation stations in guangdong province fig 2 in this study climate change was mainly measured by the rainfall intensity and duration therefore the 1985 and 2015 rainfall data including m1dp and avdr with a 30 year interval were determined as the two time baselines for contrastive analysis the rainfall series of 1961 2017 was divided into two parts the years 1985 and 2015 represent the periods of 1961 1990 and 1986 2017 respectively 2 the avdr unit days indicator represents the frequency of rainstorms with 50 mm precipitation the hazard inducing environment was measured by the following 1 the digital elevation model dem unit m was used to reflect the elevation water is prone to gather in low lying places as it flows downward 2 the slope sl unit reflects the degree of steepness of the surface unit the greater the slope the faster the velocity of water the greater the difficulty of flood accumulation and vice versa 3 the distance to the river dr unit m was used as another indicator for the hazard inducing environment the closer the distance to the river the easier the area can be submerged which indicates higher danger 4 the runoff coefficient rc indirectly reflects the impact of human activity on land use types and surface impermeability in guangdong province many green lands such as farmland grassland forests lakes and rivers have been replaced by urban lands to promote economic development li et al 2020 as a result the impervious area has increased resulting in the shortening of hydrological processes and increase of the runoff coefficient the rc was determined by referring to the study by wang et al 2015 based on the land use types the larger the value the worse the infiltration ability and the smaller the storage capacity of water the land use types in 1985 and 2015 were used 5 the soil type st describes the relative proportions of different grain sizes of mineral particles in soil different soil types were given corresponding codes according to wang et al 2015 a larger code value indicated stronger penetration it is important to note that the m1dp and avdr which are closely related to floods were used to reflect climate change in this study the rc based on land use types was applied to reflect human activity the other indicators namely dem sl dr and st were regarded as being unchanged during 1961 2017 3 methodology 3 1 weight determination flood susceptibility is based on several indicators and requires multi criteria analysis the analytic hierarchy process ahp is a decision making approach that provides a systematic method for assessing and integrating the effects of various variables on the basis of which qualitative and quantitative analysis can be carried out saaty 1994 this method structures a problem as a hierarchy that includes a goal criteria and sub criteria the weighting coefficients of which are revealed by pair wise comparison from a table matrix ahp has been tested for the handling of complicated regional problems of various standards and indicators and was used in the present study to determine the weight of each indicator experts in this field were invited to score the relative importance of each proposed indicator via pair wise comparison that forms a table matrix after the normalization the calculated weighting coefficients can be acceptable only if the consistency ration cr is smaller than 0 1 more details about this method can be found in pertinent existing literature stefanidis and stathis 2013a stefanidis and stathis 2013b bathrellos et al 2017 wolnowska and konicki 2019 3 2 cloud model the concept of the cloud model was proposed in view of the shortcomings of probability theory and fuzzy mathematics in dealing with uncertainty li et al 1998 the fuzziness and randomness as well as the relationship between them are also explained the cloud model is a concrete implementation method of the cloud and is based on the operation reasoning and control of the cloud via a cloud generator it can realize the transformation between qualitative and quantitative concepts li et al 2005 according to a study by li et al 1998 the detailed descriptions of the cloud model are as follows 3 2 1 cloud definition u is the set u u is the universe of discourse with an exact value and t is a linguistic term related to u the membership degree of u in u to the linguistic term t ct u is a random variable with a probability distribution in the universe of discourse the value of ct u is within the interval of 0 1 a membership cloud is a mapping from the universe of discourse u to the unit interval 0 1 and each u ct u is called a cloud drop that is c t u u 0 1 u u u c t u fig 3 is an example that illustrates the role of a membership cloud for a linguistic term t in a universe of discourse x note that the x and y axis represent the indicator values and membership of flood susceptibility level respectively the membership degrees at each u are all random numbers that exhibit deviation but obey a certain probability distribution from this it is known that the cloud model has effectively integrated the fuzziness and randomness of a linguistic term in a unified way it also provides a means by which to study qualitative knowledge via a quantitative method membership clouds with a bell shape which are called normal membership clouds are the most fundamental and useful for representing linguistic concepts the normal membership function can also be used to represent the mathematical expected curve mec of the cloud the digital parameters of a normal membership could characterize the quantitative meaning of a linguistic concept ex expected value is the central value at the universe of discourse and can best represent the qualitative concept it is very easy to determine ex in practical application en entropy represents the fuzziness of linguistic terms and shows how many elements in the universe of discourse could be accepted as the linguistic concept the larger the value of en the greater the bandwidth he deviation is a measure of the randomness of the membership function and can reflect the cohesiveness of uncertainty of all drops in the universe of discourse the larger the value of he the greater the thickness of cloud drops 3 2 2 grading standard and determination of parameters in this study the flood susceptibility associated with the indicators was divided into five classes by natural breaks jenks see table 1 namely the lowest lower medium higher and highest levels the jenks classification executed by reducing the variance within classes and maximizing the variance between classes is a data classification method designed to determine the best arrangement of values into different classes it has proven to have good adaptability and high accuracy in the unit division of geographical environments chen et al 2013 after obtaining the classification of each indicator the zonal statistics tool in arcgis was used to determine the expected value ex of each classification the quantitative values that contribute to the qualitative concept in domain x fall mainly within the interval ex 3en ex 3en and the contribution of quantitative values beyond ex 3en ex 3en can be ignored therefore en was calculated by ex in an adjacent interval and he was determined based on experience table 2 the quantitative boundaries of the levels for all indicators and the parameters were then calculated table 3 3 2 3 normal cloud generator a wide variety of linguistic terms puts obstacles in the way of unifying the representation of qualitative knowledge in fuzzy controllers however a complicated or composite linguistic term may be considered as a kind of soft computation based on the primary or atomic terms which cover quantitative characteristics in common knowledge with fuzziness and randomness therefore it is worthwhile to first set up a linguistic model for those linguistic concepts mapping between quantitative and qualitative representation becomes much easier based on the normal cloud generator which is divided into a forward cloud generator and backward cloud generator given three digital characteristics ex en and he to represent a linguistic term the generator can produce as many drops of the cloud as is intended this kind of generator is called a forward cloud generator and is denoted as cg all the drops obey the properties described previously cloud drops may be generated in certain conditions given a numerical value u u0 and three digital characteristics ex en and he the generator can produce a series of drops which have the same value u0 in the universe of discourse u and different gaussian distributed membership degrees ct u0 this kind of generator is called an x condition generator and is denoted as xcg given a membership degree ct u1 and three digital characteristics ex en and he the generator can produce a series of drops which have the same membership ct u1 and different gaussian distributed numerical values in the universe of discourse this kind of generator is called a y condition generator and is denoted as ycg given a limited set of drops dropi ui ct ui as samples of a membership cloud the three digital characteristics ex en and he could be produced to represent the corresponding linguistic concepts this kind of cloud generator is called a backward cloud generator and is denoted as cg 1 the three cloud generators are shown in fig 4 the greater the number of drops the more accurate the generated ex en and he values in this study xcg was selected to calculate the membership degree of flood susceptibility the input included the three parameters ex en and he and the number of cloud drops was n the output included n cloud drops and their certainty degrees the detailed steps are as follows 1 generate a normally distributed random number e n i with expectation en and variance he 2 2 generate a normally distributed random number xi with expectation ex and variance e n i 3 calculate y i e x e x 2 2 e n i 2 where xi represents a cloud drop in the universe and yi is the certainty degree that x i belongs to the concept 4 repeat steps 1 to 3 until n cloud drops are generated the forward clouds of different indicators at various flood susceptibility levels were then obtained fig 5 3 3 comprehensive assessment and final susceptibility level an assessment matrix r given as matrix 1 was constructed according to the cloud model the element r ij in r represents a raster layer of membership degree after the determination of the indicator weight and the assessment matrix r the comprehensive membership degree was calculated by eq 2 1 r r 11 r 12 r 15 r 21 r 22 r 25 r i 1 r i 2 r i 5 i 1 2 n 2 b w r w 1 w 2 w i r 11 r 12 r 15 r 21 r 22 r 25 r i 1 r i 2 r i 5 b 1 b 2 b 5 where w is the indicator weight vector and b 1 b 2 b 3 b 4 and b 5 are the comprehensive membership degrees that can represent the raster layers of comprehensive membership to avoid possible distortion with the maximum membership principle and to improve the precision of assessment the rank feature values were chosen as the final susceptibility level first normalization processing was used to acquire the normalized synthetic relative membership degree u ik between the sample x i and level k 3 u ik u ik k 1 k u ik k 1 2 5 the rank feature value h i for the sample x i was then calculated as 4 h i k 1 k u ik â k ultimately the final susceptibility level h i for the sample x i is the maximum of the h ik set as given by eq 5 5 h i max h i 1 h i 2 h i 3 h i 4 h i 5 3 4 assessment procedure the framework of flood susceptibility assessment based on the cloud model and ahp is illustrated in fig 6 first seven indicators were determined with a grid format processed by arcgis and the proper ranking criteria were set according to jenks see table 1 then the ex en and he values were determined based on the interval classification see table 2 with these three numerical characteristics see table 3 as well as indicator layers the membership of each level of each indicator was calculated by xcg see fig 5 next expert groups were organized to grade the selected indicators and the scores were averaged the weight of each indicator was then obtained by ahp then combined with the weight the indicators corresponding to the susceptibility level were weighted to sum five grid layers of membership were then obtained for the five levels finally to avoid the distortion of the membership degree the rank feature values calculated by eq 3 and 4 were used to obtain the final susceptibility level among the seven indicators four dem sl dr and st were regarded as constant while m1dp and avdr were used to represent climate change and rc was used to represent human activity the latter three indicators were found to change over time in this study as mentioned previously the year 1985 denotes the period of 1961 1990 and the year 2015 denotes the period of 1986 2017 the years 1985 and 2015 were the two time baselines the former of which represents the past while the latter represents current situation according to fig 6 four scenarios were constructed as follows scenario a rainfall data m1dp and avdr for 2015 rc for 2015 and other constant indicators were used to assess the flood susceptibility the susceptibility of this scenario is comprehensively determined by both climate change and human activity therefore this scenario can reveal the current susceptibility level and reflect the current actual situation scenario b rainfall data for 1985 rc for 2015 and other constant indicators were used this scenario assumes that the climate was unchanged while the human activity had changed since 1985 and can reveal the impact of human activity on flood susceptibility scenario c rainfall data for 2015 rc for 1985 and other constant indicators were used this scenario assumes that human activity was unchanged while the climate had changed since 1985 and can reveal the impact of climate change on flood susceptibility scenario d the rainfall data for 1985 rc for 1985 and other constant indicators were used this scenario assumes that flood susceptibility is impacted neither by climate change nor human activity i e this scenario represents the past situation without the impacts of the two factors after 1985 the four scenarios were given the same indicator weights when constructing the cloud model the relative impacts of climate change and human activity on flood susceptibility can thus be quantitatively assessed from the spatial perspective by comparing the four scenarios 4 results 4 1 wt analysis ten experts in the field were invited to score the relative importance of each proposed indicator the weights obtained by the experts that met the consistency test cr 0 1 were averaged as the final result as shown in table 4 it is evident that m1dp avdr and rc were considered relatively important the experts explained that the reason why m1dp and avdr account for a large proportion is that the disaster inducing factor plays a decisive role in the formation of disasters even if a region is located on a higher terrain is far away from rivers and has a strong infiltration capacity of soil there is still a high probability of flood susceptibility due to storms with high intensities rc ranked the third most important because of its impact on runoff yield and concentration compared with the land use types with greater infiltration intensities such as forests and grassland the time of runoff yield and concentration in urban land with a higher impermeability rate and more dense buildings are much shorter and floods are more prone to occur the other indicators were found to account for relatively small weights 4 2 flood susceptibility distribution and verification 4 2 1 flood susceptibility distribution of scenario a the spatial distribution of the flood susceptibility of scenario a is presented in fig 7 according to fig 7a the highly susceptible areas including the higher and highest levels are mainly distributed in the coastal cities the prd southern qingyuan and yingde and account for approximately 37 7 of the total area the reasons for the high susceptibility in these areas are diversified and include heavy rainfall low lying terrain close proximity to rivers and the increase of the impervious area due to urbanization generally highly susceptible areas feature a low elevation low slope flatter terrain and close proximity to rivers further urban land characterized by a large amount of impervious areas was found to have higher susceptibility especially in the prd fig 7b on the contrary the low susceptible areas including the lower and lowest levels were found to be mainly distributed in the areas far from coastal cities accounting for about 40 8 of the total area these areas are generally located in the mountainous areas with high terrain and steep slope overall the flood susceptibility in the southern coast was found to be far greater than that in the northern area 4 2 2 verification and comparison with other methods to verify the reliability of the results of scenario a the relevant validation data on floods were compared with the susceptibility map a map of the threatened areas of flood waterlogging disasters from atlas of guangdong province 2003 which was drawn according to the historical flood statistics of guangdong province demonstrates that the high risk areas are mainly in the prd zhanjiang shantou and urban areas of each city and basically coincide with the highly susceptible areas found in the present study huang et al 2017 reported the locations of urban flood hotspots across the prd in 2014 and these locations were replotted and overlaid on the susceptibility map in fig 7b it is evident that the urban flood hotspots in the prd are almost all located in the highly susceptible areas lai et al 2015 reported that the high hazard areas in the dongjiang river basin are mainly in longgang huiyang huidong boluo longmen and dongguan and these findings are roughly consistent with those of the present study hallegatte et al 2013 implied that the flood susceptibility in zhanjiang is high which is also consistent with the distribution found in the present study to further evaluate the effects of the cloud model two commonly used methods namely the fuzzy comprehensive evaluation fce model and weighted linear combination wlc method were applied for comparison with the susceptibility map the same indicators and weights used in the cloud model were applied to fce and wlc as shown in fig 8 the flood susceptibility distributions based on fce and wlc are generally similar to that of the cloud model the correlation coefficients of the susceptibility map between the cloud model and fce as well as between the cloud model and wlc both reached 0 89 suggesting that the susceptibility distributions calculated by the three methods were basically similar compared with that determined by the cloud model the flood susceptibility as determined by the fce and wlc methods had a common feature the susceptibility levels in some areas were underestimated for example some areas located inland such as shaoguan yingde and chaoshan are flood prone areas that were successfully detected by the cloud model but fce and wlc failed to detect them fig 8a additionally the flood susceptibility distribution in the prd as calculated by wlc was relatively conservative as compared to that calculated by the cloud model and fce although it covered most of the flooding hotspots overall the flood susceptibility map of scenario a better matches the historical flooding data and relevant literature suggesting the feasibility and rationality of the application of the cloud model 4 3 relative impacts of climate change and human activity on flood susceptibility 4 3 1 basis reference of scenario d and the conversion map according to the constructed scenarios scenario a considers the current situation while scenario d reflects the past situation scenario d was therefore set as the basis of reference and the susceptibility conversion was based on this scenario the flood susceptibility change between scenarios a and d can be considered to be caused by both climate change and human activity the flood susceptibility map of scenario d was acquired fig 9 a by the same steps taken to acquire that of scenario a the conversion map of flood susceptibility levels between scenarios a and d was also created fig 9b according to table 5 approximately 105 139 km2 60 maintained the original levels but approximately 70 189 km2 40 changed of which 39 534 km2 56 3 converted from a low to high level and 30 655 km2 43 7 converted from a high to low level generally since 1985 there have been more units with increased susceptibility than those with decreased susceptibility 4 3 2 relative impact of human activity similarly the flood susceptibility map of scenario b fig 10 a and the conversion map between scenarios b and d fig 10b were obtained it is evident that overall the spatial distribution of scenario b is similar to that of scenario d according to table 5 and fig 10b approximately 159 056 km2 90 2 remain unchanged while 17 312 km2 9 8 changed of which 9 908 km2 converted from a low to high level and 7 404 km2 converted from a high to low level fig 10a indicates that the distribution of flood susceptibility due to human activity is not uniform and presents different features more specifically benefiting from the reform and opening up in china in the 1980 s shenzhen s economy has developed rapidly and became highly urbanized in this city approximately 542 4 km2 29 8 converted from a low to high level of which 66 5 converted from the higher to the highest level and only 52 1 km2 2 9 converted from a high to low level on the contrary the flood susceptibility level in dongyuan declined distinctly due to the two rounds of eco policy since 1999 that returned farmland to forests and grassland approximately 957 km2 23 8 converted from a high to low level and only 5 1 converted from a low to high level the land use types in both two cities have greatly changed and such human activities did bring great impacts on the flood susceptibility one has negative impact while the other has positive one surprisingly the increase of flood susceptibility in the prd is relatively little although the urban areas have expanded largely during these years the reason may be that the prd has been a highly susceptible area since long time ago due to its low elevations flat areas and close proximity to rivers which indicates that the geographical location has a strong influence on the flood susceptibility 4 3 3 relative impact of climate change the flood susceptibility map of scenario c fig 11 a and the conversion map between scenario c and d fig 11b were obtained the spatial distribution of scenario c is generally similar to that of scenario a and its distribution is therefore not reiterated here according to table 5 approximately 112 789 km2 64 3 maintained the same levels but 62 548 km2 35 7 changed of which 34 926 km2 converted from a low to high level while 27 623 km2 changed from a high to low level the areas 35 7 for which susceptibility was impacted by climate change scenario c were found to be much larger than those 9 8 impacted by human activity scenario b but both scenarios accounted for smaller proportions than the comprehensive effects of scenario a 40 fig 11a indicates that the distribution of flood susceptibility due to climate change also features large spatial difference however the areas with high susceptibility generally increased especially for highly urbanized cities more specifically about 388 2 km2 28 8 of highly susceptible areas in the center of guangzhou were detected as compared with scenario d with 17 81 km2 1 3 converted from a high to low level analogously the proportion with increased susceptibility in shenzhen was 27 5 approximately 17 8 converted from a high to low level of which about 26 4 mainly converted from the highest to the higher level it can be seen that the flood susceptibility of the highly urbanized areas was also affected by the climate change in addition flood susceptibility was also found to increase in some mountainous cities lianzhou liannan yangshan and shaoguan and coastal cities yangjiang and haifeng for zhanjiang the susceptibility in some areas was found to be slightly reduced from the highest to the higher level therefore still reflecting high susceptibility these changes reflect that the increased rainfalls in some mountainous and coastal areas still greatly contributed to high susceptible level so the related measures should be taken to improve their defense capability 4 3 4 results summary many interesting results were obtained by the analysis of the four scenarios first the spatial distribution of flood susceptibility in scenario b was found to be similar to that of scenario d with a correlation coefficient of 0 958 while scenario c was found to be generally similar to scenario a with a correlation coefficient of 0 955 secondly the area proportion for which the susceptibility level changed between scenarios c and d was found to be 35 7 of which about 55 8 converted from a low to high level and 44 2 converted from a high to low level in contrast the area proportion for which the susceptibility level changed between scenarios b and d was found to be only 9 8 of which about 57 2 converted from a low to high level and 42 8 converted from a high to low level finally in terms of the comprehensive change due to climate change and human activity between scenarios a and d approximately 40 of the areas had changed susceptibility levels of which about 56 3 converted from a low to high level and 43 7 converted from a high to low level these results suggest that from the spatial perspective climate change has had a greater impact on flood susceptibility than has human activity since 1985 zhou et al 2018 concluded that from the temporal perspective climate change 58 has a more important effect on runoff change than does human activity 42 in the dongjiang river basin located in guangdong province this indirectly verifies the reasonability of this discovery additionally the areas with increased susceptibility were found to be more than those with decreased susceptibility i e more areas are currently prone to flooding than were in the past this is also consistent with most previous studies on flood risk and implies that flooding remains a serious problem in guangdong province 5 discussion 5 1 implication and cause analysis as mentioned previously most previous studies could provide simple rates of the relative contributions of climate change and human activity for an entire basin based on time series while such methods are difficult to be used to understand the interior distribution of susceptibility and determine the exact locations for flood defense in contrast the present study spatially revealed the individual and comprehensive contributions of climate change and human activity to flood susceptibility via the constructed scenarios the susceptibility level and susceptibility conversion at each unit were also displayed with exact location information which would help to positively respond to flood disasters and take targeted measures besides climate change was found in this study to have a larger impact than human activity on the spatial scale the reason may be explained as follows first the weights of m1dp and avdr were large while those of rc and the other indicators were relatively small the mean values of m1dp and avdr in 2015 were 7 35 days and 132 83 mm and that in 1985 were 7 21 days and 131 48 mm which generally reveals that the rainfall intensity and days in 2015 were greater than those in 1985 more serious rainfall and a larger indicator weight resulted in more areas with high susceptibility secondly although the urban land areas increased greatly after 1985 due to the reform and opening up policy the areas with high susceptibility did not increase obviously especially in the prd because most of these newly urban areas had already been detected in 1985 as being highly susceptible due to their low elevations flat areas and close proximity to rivers in this case the increase of highly susceptible areas was limited although 50 of the changed areas were found to have an increased susceptibility level the areas that changed from a high to low level of susceptibility still account for a quite high percentage approximately 40 as shown in fig 9b most of these areas are mainly located in suburban and mountainous areas these areas may have benefitted from the two rounds of eco policy since 1999 that returned farmland to forests and grassland the increased areas of forests and grassland greatly improved the rainwater storage content and infiltration capability thus reducing the potential risk of floods 5 2 advantage and deficiency in this study we analyzed flood susceptibility in terms of disaster inducing factors and hazard inducing environment measured by 7 indicators and then constructed a flood susceptibility assessment model based on the cloud model the model can convert the uncertainty and randomness of indicators to certainty and determinacy by calculating the membership degree of a fuzzy function and choosing the value that best reflects the corresponding susceptibility level as a parameter for final calculation the cloud figures can also reflect the relationship between the grading standard and membership which aids in the understanding of the degree of credibility of the final assessment verification via comparison with historical flood data and relevant literature supported the creditability and reasonability of the proposed model the cloud model was also shown to produce better results than the fce and wlc methods additionally unlike machine learning models the cloud model is a non sampling model that does not require the use of flooding samples thus the assessment system could be constructed without using historical flooding samples which is ideal for regions with few or no flooded materials therefore the cloud model is strongly recommended for the assessment of flood susceptibility however some deficiencies remained in this study for example the term human activity in this study only considered the change of land use type whereas the total content of human activity is very rich thus the accuracy of the model may be further improved if more activities e g hydraulic structure construction water resources scheduling flood mitigation and control are considered similarly only the key indicator of rainfall was used to represent climate change and other climate factors including air temperature evapotranspiration wind speed and sunshine conditions were ignored additionally the subjective weight based on ahp was used as is well known ahp is strongly affected by expert knowledge and is subjected to many biases resulting in high subjectivity the model findings may be improved if the objective weight or even a combined weight that couples the subjective and objective weights is used 6 conclusions flood susceptibility assessment an important non engineering measure of preventing floods and reducing losses is a synthetic assessment and analysis method that involves numerous factors the cloud model is an effective method for solving the uncertainty between qualitative and quantitative concepts as it can consider fuzziness randomness and the relationship between them taking the guangdong province as a case study an indicator system was established by the use of seven indicators and an assessment model was constructed based on the cloud model ahp was also developed to evaluate indicator weights four scenarios were constructed and the relative impacts of climate change and human activity on flood susceptibility were explored from the spatial perspective the main conclusions of this study can be summarized as follows the m1dp avdr and rc are considered to be the most important indicators of flood susceptibility with relative weights of 0 345 0 218 and 0 154 while the remaining indicators were found to account for relatively small amounts the verification via historical flood data and relevant literature and comparisons with the results of the fce and wlc methods proved that the cloud model is a feasible reasonable and effective method that can be recommended for the assessment of flood susceptibility it was found that approximately 40 of areas experienced a changed flood susceptibility level since 1985 due to the comprehensive impacts of climate change and human activity of which about 56 3 converted from a low to high level and 43 7 converted from a high to low level for the hypothetical scenarios 35 7 of the areas experienced a changed susceptibility level due to climate change of which 55 8 converted from a low to high level and 44 2 converted from a high to low level in contrast only 9 8 of the areas had a changed susceptibility level due to human activity of which 57 2 converted from a low to high level and 42 8 converted from a high to low level from the spatial perspective climate change was generally found to have a larger impact on flood susceptibility than human activity credit authorship contribution statement shanshan li methodology software validation formal analysis writing original draft zhaoli wang project administration funding acquisition resources chengguang lai conceptualization resources writing review editing supervision funding acquisition guangsi lin project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is financially supported by the national key r d program of china 2018yfc1508200 the national natural science foundation of china 51879107 51709117 and the fundamental research funds for the central universities 2019jq06 our cordial gratitude also should be owed to the editor prof geoff syme and the two anonymous reviewers for their professional and pertinent suggestions and comments which are greatly helpful for further improvements of the quality of this manuscript 
5309,floods are generally considered to be the most common natural disaster worldwide climate change and human activity are two key driving factors of flood formation and it is difficult to determine how to quantitatively detect their relative impacts on flood susceptibility as an important non engineering measure of preventing floods and reducing losses flood susceptibility assessment is a synthetic task that involves many factors in this study the flood susceptibility in guangdong province china was assessed based on a cloud model the relative impacts of climate change and human activity on flood susceptibility were also quantitatively investigated from the spatial perspective the results prove that the cloud model is a feasible reasonable and effective method for flood susceptibility assessment approximately 40 of the studied areas have changed their flood susceptibility level since 1985 due to the comprehensive impacts of climate change and human activity of which about 56 3 converted from a low to high level and 43 7 from a high to low level about 35 7 of the areas changed their susceptibility level due to climate change of which 55 8 converted from a low to high level and 44 2 from a high to low level in contrast only 9 8 of the areas changed the susceptibility level due to human activity of which 57 2 converted from a low to high level and 42 8 from a high to low level generally from the spatial perspective climate change has a larger impact on flood susceptibility than human activity this study aims to provide a novel idea to quantitatively detect the relative impacts of climate change and human activity on flood susceptibility from spatial perspective the findings of this study are also expected to enhance the understanding on distribution rule of flood susceptibility in guangdong province and are conducive to taking targeted measures to reduce the flood risk keywords flood susceptibility cloud model spatial perspective membership degree guangdong province 1 introduction floods cause significant casualties and socio economic losses and are one of the most devastating but common natural catastrophic disasters adikari and yoshitani 2009 jongman et al 2012 stijn et al 2013 papaioannou et al 2015 luo et al 2018 it has been reported that global flood losses increased from an average of 7 billion usd in the 1980 s to approximately 24 billion usd per year in the 2000 s kundzewicz et al 2014 and this number is projected to increase to 52 billion usd by 2050 hallegatte et al 2013 it has also been estimated that the global urban population will reach 5 billion by the year 2030 and a single flood could affect the lives of millions of people gaines 2016 therefore the occurrence of floods poses a major threat to human society both in the present and future although flooding cannot be completely prevented corresponding protective measures can be taken to minimize the resulting loss apel et al 2009 among the available measures flood susceptibility assessment is considered to be effective for flood defense and management flood hazard prevention and reduction post disaster relief and flood insurance businesses wang et al 2015 lai et al 2016 however assessment is a very complicated topic because it involves many elements including climatic and anthropogenic factors wu et al 2017 muis et al 2015 luo et al 2019 khosravi et al 2019 for example many large floods are attributed to the increased frequency and intensity of short duration rainfall yilmaz et al 2014 wu et al 2018a driven by global climate change bronstert 2010 jie et al 2011 kundzewicz et al 2014 generally when the intensity of rainfall is much higher than the soil infiltration flood events may easily occur wang et al 2017a kanani sadat et al 2019 zeng et al 2019 this is an obvious threat especially for highly urbanized areas in addition floods are also largely affected by anthropogenic activities including farming urban expansion land use and land cover change lucc and hydraulic engineering construction kalnay and cai 2003 mccarthy et al 2010 zhang et al 2015 liu et al 2018a liu et al 2018b chen et al 2020 which have induced significant hydrological changes salvadore et al 2015 dams et al 2015 pumo et al 2017 arnone et al 2018 most notably the increases of rainfall intensity and impervious surfaces expedite runoff response huang et al 2010 causing higher flow velocities greater river flow hawley and bledsoe 2011 and greater frequencies of peak flow discharge prosdocimi et al 2015 therefore both climate change and human activity play key roles in flood formation however determining whether climate change or human activity will have greater impacts and how to quantify their relative contributions remain difficult problems liu et al 2010 reported that climate variability and human activity each accounted for about 50 of the runoff change in the low flow period in the dongjiang river basin however zhou et al 2018 concluded that the average contributions of human activity and climate change to runoff change in the same basin were 42 and 58 respectively zhan et al 2014 pointed out that the contributions of climate change and human activity to runoff decrease in wei river basin were 22 29 and 71 78 respectively han et al 2019 investigated the dammed lancang river in southwest china and found that climatic change and human activity respectively contributed 57 and 43 to the streamflow changes for the transition time period of 1987 2007 while they respectively contributed 5 and 95 for the post impact period of 2008 2014 xin et al 2019 found that both climate change and direct human activity in huifa river basin induce a decrease in streamflow at the annual scale with 68 of the change contributed by direct human activity lyu et al 2019 discovered that climate change and normal climate variability in chabagou river basin are responsible for about 80 of the decrease in runoff mainly due to reduced precipitation while human activities was responsible for 20 of reductions in runoff generally speaking these previous studies quantified the relative impacts of climate change and human activity on the change of stream flow via statistical methods climate elasticity methods and numerical models which better explain the flood formation mechanism and are convenient for further susceptibility analysis however most of the studies focused on providing a simple rate of relative contribution of the two factors based on time series while the susceptibility distribution and characteristics of all the spatial units have been seldom explored although a simple rate of relative contribution aids in the understanding of the overall effects of climate change and human activity it no longer sufficiently addresses the increasing requirements for the accuracy and depth of flood analysis more detailed regularities of the distribution of floods can be acquired if we quantify the relative impacts of climate change and human activity from the spatial perspective the term flood susceptibility is understood in the context of flood risk management as the probability that a flood will occur meyer et al 2010 dyck and willems 2013 koks et al 2015 hénonin et al 2015 based on the nonlinear relationships between multiple variables and the hazard level flood susceptibility assessment can be regarded as the quantitative evaluation of the degree of a rainstorm s adverse impact kubal et al 2009 ipcc 2012 and usually consists of two parts a disaster inducing factor that is the root cause of a flood and a hazard inducing environment in which floods are more likely to occur fernández and lutz 2010 apel et al 2016 methods of flood susceptibility analysis can be classified into three main categories hydrological and hydrodynamic models multi criteria decision analysis mcda and machine learning models zhao et al 2019 the hydrological and hydrodynamic models such as swmm info works mike series and lisflood fp can obtain appropriate simulation results in line with the actual situation but they also require large amounts of detailed data gai et al 2019 guan et al 2015 li et al 2019 peng et al 2015 wu et al 2018b xu and zhao 2016 which may be a significant difficulty for most studies further due to the limitations of computation time and the need for high resolution data they are more suitable for relatively small areas rather than large areas neal et al 2010 zhang and pan 2014 as components of gis based models fernández and lutz 2010 mcdas including the analytic hierarchy process set pair analysis and fuzzy comprehensive evaluation present the advantages of simple calculation and easy understanding li et al 2012 zou et al 2013 kazakis et al 2015 lai et al 2015 ahmad and verma 2018 cai et al 2019 however these models are limited by a lack of consideration of the indicators randomness and uncertainty chowdary et al 2013 the machine learning methods including support vector machines decision trees artificial neural networks the random forest algorithm and ant colony optimization have also been widely applied to flood susceptibility assessment feng and lu 2010 deng and zhou 2013 tehrany et al 2013 tehrany et al 2015 wang et al 2015 lai et al 2016 khosravi et al 2018 sadler et al 2018 jahangir et al 2019 these methods can be used to easily determine the susceptibility level of a sample point via the correlation between the indicators and historical flood events which avoids the subjective determination of weights however the calculation principle of these methods is complicated and the workload is heavy for large scale areas and some methods are easily susceptible to over learning and the local minimum dilemma during the learning process moreover the size mode location of samples susceptibility level and data types also affect the assessment accuracy in summary the existing methods for flood susceptibility assessment present obvious advantages and disadvantages and therefore new methods should be explored to improve or even solve the disadvantages to avoid the weakness of sample selection and consider the uncertainty and randomness of indicators a cloud model is used in this study to assess flood susceptibility compared with the boundary division of susceptibility grades in other fuzzy evaluation approaches the cloud model is able to extract the values that can best reflect the susceptibility level and then establishes the fuzzy function that accords with the normal distribution due to these advantages cloud models have been applied to many fields including prediction algorithm improvement and knowledge representation among others li et al 1998 although cloud models have also been successfully applied to water quality assessment wang et al 2016 yang et al 2018 and project performance assessment liu et al 2018a liu et al 2018b lu et al 2019 to the best of the authors knowledge they have seldom been applied to flood susceptibility assessment therefore the objectives of this study are to 1 construct a flood susceptibility assessment model based on the cloud model 2 detect the flood susceptibility levels and spatial conversion feature in guangdong province and 3 quantitatively assess the relative impacts of climate change and human activity on flood susceptibility from the spatial perspective this study is expected to provide a unique method for the exploration of the contributions of climate change and human activity to flood hazards and to provide a reference method for flood susceptibility assessment 2 study area and data 2 1 study area guangdong province which is located in southern china and has an area of 179 700 km2 see fig 1 was selected as the study area affected by the east asian monsoon guangdong province has abundant yearly precipitation between 1300 and 2500 mm yuan et al 2018 which is concentrated in april to september however the spatial distribution of precipitation is uneven due to the influence of topography three rainy centers exist in the province enping yangjiang haifeng and longmen qingyuan guangdong province is the richest province in china with a gdp of more than 1 5 trillion usd in 2019 and the famous pearl river delta prd also locates in this province francesch huidobro et al 2017 wang et al 2017b the level of urbanization in the province is high but the construction standards of flood control and drainage facilities are still on the low side in some areas floods are frequent in the province and many heavy floods have taken countless of thousands of lives and caused substantial economic losses since 1900 lai et al 2016 worse still the two cities of guangzhou and shenzhen in the province are ranked as the first and fifth highest risks for future flood losses among 136 major coastal cities hallegatte et al 2013 therefore a systematic assessment of flood susceptibility in the province is vital 2 2 indicator system and data sources flood susceptibility can be considered as consisting of a disaster inducing factor and a hazard inducing environment according to the actual situation in guangdong province and existing literature reviews jiang et al 2009 lai et al 2015 wang et al 2015 tang et al 2019 the maximum 1 day precipitation m1dp and the average days of rainstorm avdr were selected to represent the disaster inducing factor the elevation slope soil type distance to the river and runoff coefficient were selected to measure the hazard inducing environment see fig 2 the disaster inducing factor was measured by the following 1 the m1dp unit mm reflects the intensity of rainfall and was calculated by kriging interpolation technology by using 86 rainfall observation stations in guangdong province fig 2 in this study climate change was mainly measured by the rainfall intensity and duration therefore the 1985 and 2015 rainfall data including m1dp and avdr with a 30 year interval were determined as the two time baselines for contrastive analysis the rainfall series of 1961 2017 was divided into two parts the years 1985 and 2015 represent the periods of 1961 1990 and 1986 2017 respectively 2 the avdr unit days indicator represents the frequency of rainstorms with 50 mm precipitation the hazard inducing environment was measured by the following 1 the digital elevation model dem unit m was used to reflect the elevation water is prone to gather in low lying places as it flows downward 2 the slope sl unit reflects the degree of steepness of the surface unit the greater the slope the faster the velocity of water the greater the difficulty of flood accumulation and vice versa 3 the distance to the river dr unit m was used as another indicator for the hazard inducing environment the closer the distance to the river the easier the area can be submerged which indicates higher danger 4 the runoff coefficient rc indirectly reflects the impact of human activity on land use types and surface impermeability in guangdong province many green lands such as farmland grassland forests lakes and rivers have been replaced by urban lands to promote economic development li et al 2020 as a result the impervious area has increased resulting in the shortening of hydrological processes and increase of the runoff coefficient the rc was determined by referring to the study by wang et al 2015 based on the land use types the larger the value the worse the infiltration ability and the smaller the storage capacity of water the land use types in 1985 and 2015 were used 5 the soil type st describes the relative proportions of different grain sizes of mineral particles in soil different soil types were given corresponding codes according to wang et al 2015 a larger code value indicated stronger penetration it is important to note that the m1dp and avdr which are closely related to floods were used to reflect climate change in this study the rc based on land use types was applied to reflect human activity the other indicators namely dem sl dr and st were regarded as being unchanged during 1961 2017 3 methodology 3 1 weight determination flood susceptibility is based on several indicators and requires multi criteria analysis the analytic hierarchy process ahp is a decision making approach that provides a systematic method for assessing and integrating the effects of various variables on the basis of which qualitative and quantitative analysis can be carried out saaty 1994 this method structures a problem as a hierarchy that includes a goal criteria and sub criteria the weighting coefficients of which are revealed by pair wise comparison from a table matrix ahp has been tested for the handling of complicated regional problems of various standards and indicators and was used in the present study to determine the weight of each indicator experts in this field were invited to score the relative importance of each proposed indicator via pair wise comparison that forms a table matrix after the normalization the calculated weighting coefficients can be acceptable only if the consistency ration cr is smaller than 0 1 more details about this method can be found in pertinent existing literature stefanidis and stathis 2013a stefanidis and stathis 2013b bathrellos et al 2017 wolnowska and konicki 2019 3 2 cloud model the concept of the cloud model was proposed in view of the shortcomings of probability theory and fuzzy mathematics in dealing with uncertainty li et al 1998 the fuzziness and randomness as well as the relationship between them are also explained the cloud model is a concrete implementation method of the cloud and is based on the operation reasoning and control of the cloud via a cloud generator it can realize the transformation between qualitative and quantitative concepts li et al 2005 according to a study by li et al 1998 the detailed descriptions of the cloud model are as follows 3 2 1 cloud definition u is the set u u is the universe of discourse with an exact value and t is a linguistic term related to u the membership degree of u in u to the linguistic term t ct u is a random variable with a probability distribution in the universe of discourse the value of ct u is within the interval of 0 1 a membership cloud is a mapping from the universe of discourse u to the unit interval 0 1 and each u ct u is called a cloud drop that is c t u u 0 1 u u u c t u fig 3 is an example that illustrates the role of a membership cloud for a linguistic term t in a universe of discourse x note that the x and y axis represent the indicator values and membership of flood susceptibility level respectively the membership degrees at each u are all random numbers that exhibit deviation but obey a certain probability distribution from this it is known that the cloud model has effectively integrated the fuzziness and randomness of a linguistic term in a unified way it also provides a means by which to study qualitative knowledge via a quantitative method membership clouds with a bell shape which are called normal membership clouds are the most fundamental and useful for representing linguistic concepts the normal membership function can also be used to represent the mathematical expected curve mec of the cloud the digital parameters of a normal membership could characterize the quantitative meaning of a linguistic concept ex expected value is the central value at the universe of discourse and can best represent the qualitative concept it is very easy to determine ex in practical application en entropy represents the fuzziness of linguistic terms and shows how many elements in the universe of discourse could be accepted as the linguistic concept the larger the value of en the greater the bandwidth he deviation is a measure of the randomness of the membership function and can reflect the cohesiveness of uncertainty of all drops in the universe of discourse the larger the value of he the greater the thickness of cloud drops 3 2 2 grading standard and determination of parameters in this study the flood susceptibility associated with the indicators was divided into five classes by natural breaks jenks see table 1 namely the lowest lower medium higher and highest levels the jenks classification executed by reducing the variance within classes and maximizing the variance between classes is a data classification method designed to determine the best arrangement of values into different classes it has proven to have good adaptability and high accuracy in the unit division of geographical environments chen et al 2013 after obtaining the classification of each indicator the zonal statistics tool in arcgis was used to determine the expected value ex of each classification the quantitative values that contribute to the qualitative concept in domain x fall mainly within the interval ex 3en ex 3en and the contribution of quantitative values beyond ex 3en ex 3en can be ignored therefore en was calculated by ex in an adjacent interval and he was determined based on experience table 2 the quantitative boundaries of the levels for all indicators and the parameters were then calculated table 3 3 2 3 normal cloud generator a wide variety of linguistic terms puts obstacles in the way of unifying the representation of qualitative knowledge in fuzzy controllers however a complicated or composite linguistic term may be considered as a kind of soft computation based on the primary or atomic terms which cover quantitative characteristics in common knowledge with fuzziness and randomness therefore it is worthwhile to first set up a linguistic model for those linguistic concepts mapping between quantitative and qualitative representation becomes much easier based on the normal cloud generator which is divided into a forward cloud generator and backward cloud generator given three digital characteristics ex en and he to represent a linguistic term the generator can produce as many drops of the cloud as is intended this kind of generator is called a forward cloud generator and is denoted as cg all the drops obey the properties described previously cloud drops may be generated in certain conditions given a numerical value u u0 and three digital characteristics ex en and he the generator can produce a series of drops which have the same value u0 in the universe of discourse u and different gaussian distributed membership degrees ct u0 this kind of generator is called an x condition generator and is denoted as xcg given a membership degree ct u1 and three digital characteristics ex en and he the generator can produce a series of drops which have the same membership ct u1 and different gaussian distributed numerical values in the universe of discourse this kind of generator is called a y condition generator and is denoted as ycg given a limited set of drops dropi ui ct ui as samples of a membership cloud the three digital characteristics ex en and he could be produced to represent the corresponding linguistic concepts this kind of cloud generator is called a backward cloud generator and is denoted as cg 1 the three cloud generators are shown in fig 4 the greater the number of drops the more accurate the generated ex en and he values in this study xcg was selected to calculate the membership degree of flood susceptibility the input included the three parameters ex en and he and the number of cloud drops was n the output included n cloud drops and their certainty degrees the detailed steps are as follows 1 generate a normally distributed random number e n i with expectation en and variance he 2 2 generate a normally distributed random number xi with expectation ex and variance e n i 3 calculate y i e x e x 2 2 e n i 2 where xi represents a cloud drop in the universe and yi is the certainty degree that x i belongs to the concept 4 repeat steps 1 to 3 until n cloud drops are generated the forward clouds of different indicators at various flood susceptibility levels were then obtained fig 5 3 3 comprehensive assessment and final susceptibility level an assessment matrix r given as matrix 1 was constructed according to the cloud model the element r ij in r represents a raster layer of membership degree after the determination of the indicator weight and the assessment matrix r the comprehensive membership degree was calculated by eq 2 1 r r 11 r 12 r 15 r 21 r 22 r 25 r i 1 r i 2 r i 5 i 1 2 n 2 b w r w 1 w 2 w i r 11 r 12 r 15 r 21 r 22 r 25 r i 1 r i 2 r i 5 b 1 b 2 b 5 where w is the indicator weight vector and b 1 b 2 b 3 b 4 and b 5 are the comprehensive membership degrees that can represent the raster layers of comprehensive membership to avoid possible distortion with the maximum membership principle and to improve the precision of assessment the rank feature values were chosen as the final susceptibility level first normalization processing was used to acquire the normalized synthetic relative membership degree u ik between the sample x i and level k 3 u ik u ik k 1 k u ik k 1 2 5 the rank feature value h i for the sample x i was then calculated as 4 h i k 1 k u ik â k ultimately the final susceptibility level h i for the sample x i is the maximum of the h ik set as given by eq 5 5 h i max h i 1 h i 2 h i 3 h i 4 h i 5 3 4 assessment procedure the framework of flood susceptibility assessment based on the cloud model and ahp is illustrated in fig 6 first seven indicators were determined with a grid format processed by arcgis and the proper ranking criteria were set according to jenks see table 1 then the ex en and he values were determined based on the interval classification see table 2 with these three numerical characteristics see table 3 as well as indicator layers the membership of each level of each indicator was calculated by xcg see fig 5 next expert groups were organized to grade the selected indicators and the scores were averaged the weight of each indicator was then obtained by ahp then combined with the weight the indicators corresponding to the susceptibility level were weighted to sum five grid layers of membership were then obtained for the five levels finally to avoid the distortion of the membership degree the rank feature values calculated by eq 3 and 4 were used to obtain the final susceptibility level among the seven indicators four dem sl dr and st were regarded as constant while m1dp and avdr were used to represent climate change and rc was used to represent human activity the latter three indicators were found to change over time in this study as mentioned previously the year 1985 denotes the period of 1961 1990 and the year 2015 denotes the period of 1986 2017 the years 1985 and 2015 were the two time baselines the former of which represents the past while the latter represents current situation according to fig 6 four scenarios were constructed as follows scenario a rainfall data m1dp and avdr for 2015 rc for 2015 and other constant indicators were used to assess the flood susceptibility the susceptibility of this scenario is comprehensively determined by both climate change and human activity therefore this scenario can reveal the current susceptibility level and reflect the current actual situation scenario b rainfall data for 1985 rc for 2015 and other constant indicators were used this scenario assumes that the climate was unchanged while the human activity had changed since 1985 and can reveal the impact of human activity on flood susceptibility scenario c rainfall data for 2015 rc for 1985 and other constant indicators were used this scenario assumes that human activity was unchanged while the climate had changed since 1985 and can reveal the impact of climate change on flood susceptibility scenario d the rainfall data for 1985 rc for 1985 and other constant indicators were used this scenario assumes that flood susceptibility is impacted neither by climate change nor human activity i e this scenario represents the past situation without the impacts of the two factors after 1985 the four scenarios were given the same indicator weights when constructing the cloud model the relative impacts of climate change and human activity on flood susceptibility can thus be quantitatively assessed from the spatial perspective by comparing the four scenarios 4 results 4 1 wt analysis ten experts in the field were invited to score the relative importance of each proposed indicator the weights obtained by the experts that met the consistency test cr 0 1 were averaged as the final result as shown in table 4 it is evident that m1dp avdr and rc were considered relatively important the experts explained that the reason why m1dp and avdr account for a large proportion is that the disaster inducing factor plays a decisive role in the formation of disasters even if a region is located on a higher terrain is far away from rivers and has a strong infiltration capacity of soil there is still a high probability of flood susceptibility due to storms with high intensities rc ranked the third most important because of its impact on runoff yield and concentration compared with the land use types with greater infiltration intensities such as forests and grassland the time of runoff yield and concentration in urban land with a higher impermeability rate and more dense buildings are much shorter and floods are more prone to occur the other indicators were found to account for relatively small weights 4 2 flood susceptibility distribution and verification 4 2 1 flood susceptibility distribution of scenario a the spatial distribution of the flood susceptibility of scenario a is presented in fig 7 according to fig 7a the highly susceptible areas including the higher and highest levels are mainly distributed in the coastal cities the prd southern qingyuan and yingde and account for approximately 37 7 of the total area the reasons for the high susceptibility in these areas are diversified and include heavy rainfall low lying terrain close proximity to rivers and the increase of the impervious area due to urbanization generally highly susceptible areas feature a low elevation low slope flatter terrain and close proximity to rivers further urban land characterized by a large amount of impervious areas was found to have higher susceptibility especially in the prd fig 7b on the contrary the low susceptible areas including the lower and lowest levels were found to be mainly distributed in the areas far from coastal cities accounting for about 40 8 of the total area these areas are generally located in the mountainous areas with high terrain and steep slope overall the flood susceptibility in the southern coast was found to be far greater than that in the northern area 4 2 2 verification and comparison with other methods to verify the reliability of the results of scenario a the relevant validation data on floods were compared with the susceptibility map a map of the threatened areas of flood waterlogging disasters from atlas of guangdong province 2003 which was drawn according to the historical flood statistics of guangdong province demonstrates that the high risk areas are mainly in the prd zhanjiang shantou and urban areas of each city and basically coincide with the highly susceptible areas found in the present study huang et al 2017 reported the locations of urban flood hotspots across the prd in 2014 and these locations were replotted and overlaid on the susceptibility map in fig 7b it is evident that the urban flood hotspots in the prd are almost all located in the highly susceptible areas lai et al 2015 reported that the high hazard areas in the dongjiang river basin are mainly in longgang huiyang huidong boluo longmen and dongguan and these findings are roughly consistent with those of the present study hallegatte et al 2013 implied that the flood susceptibility in zhanjiang is high which is also consistent with the distribution found in the present study to further evaluate the effects of the cloud model two commonly used methods namely the fuzzy comprehensive evaluation fce model and weighted linear combination wlc method were applied for comparison with the susceptibility map the same indicators and weights used in the cloud model were applied to fce and wlc as shown in fig 8 the flood susceptibility distributions based on fce and wlc are generally similar to that of the cloud model the correlation coefficients of the susceptibility map between the cloud model and fce as well as between the cloud model and wlc both reached 0 89 suggesting that the susceptibility distributions calculated by the three methods were basically similar compared with that determined by the cloud model the flood susceptibility as determined by the fce and wlc methods had a common feature the susceptibility levels in some areas were underestimated for example some areas located inland such as shaoguan yingde and chaoshan are flood prone areas that were successfully detected by the cloud model but fce and wlc failed to detect them fig 8a additionally the flood susceptibility distribution in the prd as calculated by wlc was relatively conservative as compared to that calculated by the cloud model and fce although it covered most of the flooding hotspots overall the flood susceptibility map of scenario a better matches the historical flooding data and relevant literature suggesting the feasibility and rationality of the application of the cloud model 4 3 relative impacts of climate change and human activity on flood susceptibility 4 3 1 basis reference of scenario d and the conversion map according to the constructed scenarios scenario a considers the current situation while scenario d reflects the past situation scenario d was therefore set as the basis of reference and the susceptibility conversion was based on this scenario the flood susceptibility change between scenarios a and d can be considered to be caused by both climate change and human activity the flood susceptibility map of scenario d was acquired fig 9 a by the same steps taken to acquire that of scenario a the conversion map of flood susceptibility levels between scenarios a and d was also created fig 9b according to table 5 approximately 105 139 km2 60 maintained the original levels but approximately 70 189 km2 40 changed of which 39 534 km2 56 3 converted from a low to high level and 30 655 km2 43 7 converted from a high to low level generally since 1985 there have been more units with increased susceptibility than those with decreased susceptibility 4 3 2 relative impact of human activity similarly the flood susceptibility map of scenario b fig 10 a and the conversion map between scenarios b and d fig 10b were obtained it is evident that overall the spatial distribution of scenario b is similar to that of scenario d according to table 5 and fig 10b approximately 159 056 km2 90 2 remain unchanged while 17 312 km2 9 8 changed of which 9 908 km2 converted from a low to high level and 7 404 km2 converted from a high to low level fig 10a indicates that the distribution of flood susceptibility due to human activity is not uniform and presents different features more specifically benefiting from the reform and opening up in china in the 1980 s shenzhen s economy has developed rapidly and became highly urbanized in this city approximately 542 4 km2 29 8 converted from a low to high level of which 66 5 converted from the higher to the highest level and only 52 1 km2 2 9 converted from a high to low level on the contrary the flood susceptibility level in dongyuan declined distinctly due to the two rounds of eco policy since 1999 that returned farmland to forests and grassland approximately 957 km2 23 8 converted from a high to low level and only 5 1 converted from a low to high level the land use types in both two cities have greatly changed and such human activities did bring great impacts on the flood susceptibility one has negative impact while the other has positive one surprisingly the increase of flood susceptibility in the prd is relatively little although the urban areas have expanded largely during these years the reason may be that the prd has been a highly susceptible area since long time ago due to its low elevations flat areas and close proximity to rivers which indicates that the geographical location has a strong influence on the flood susceptibility 4 3 3 relative impact of climate change the flood susceptibility map of scenario c fig 11 a and the conversion map between scenario c and d fig 11b were obtained the spatial distribution of scenario c is generally similar to that of scenario a and its distribution is therefore not reiterated here according to table 5 approximately 112 789 km2 64 3 maintained the same levels but 62 548 km2 35 7 changed of which 34 926 km2 converted from a low to high level while 27 623 km2 changed from a high to low level the areas 35 7 for which susceptibility was impacted by climate change scenario c were found to be much larger than those 9 8 impacted by human activity scenario b but both scenarios accounted for smaller proportions than the comprehensive effects of scenario a 40 fig 11a indicates that the distribution of flood susceptibility due to climate change also features large spatial difference however the areas with high susceptibility generally increased especially for highly urbanized cities more specifically about 388 2 km2 28 8 of highly susceptible areas in the center of guangzhou were detected as compared with scenario d with 17 81 km2 1 3 converted from a high to low level analogously the proportion with increased susceptibility in shenzhen was 27 5 approximately 17 8 converted from a high to low level of which about 26 4 mainly converted from the highest to the higher level it can be seen that the flood susceptibility of the highly urbanized areas was also affected by the climate change in addition flood susceptibility was also found to increase in some mountainous cities lianzhou liannan yangshan and shaoguan and coastal cities yangjiang and haifeng for zhanjiang the susceptibility in some areas was found to be slightly reduced from the highest to the higher level therefore still reflecting high susceptibility these changes reflect that the increased rainfalls in some mountainous and coastal areas still greatly contributed to high susceptible level so the related measures should be taken to improve their defense capability 4 3 4 results summary many interesting results were obtained by the analysis of the four scenarios first the spatial distribution of flood susceptibility in scenario b was found to be similar to that of scenario d with a correlation coefficient of 0 958 while scenario c was found to be generally similar to scenario a with a correlation coefficient of 0 955 secondly the area proportion for which the susceptibility level changed between scenarios c and d was found to be 35 7 of which about 55 8 converted from a low to high level and 44 2 converted from a high to low level in contrast the area proportion for which the susceptibility level changed between scenarios b and d was found to be only 9 8 of which about 57 2 converted from a low to high level and 42 8 converted from a high to low level finally in terms of the comprehensive change due to climate change and human activity between scenarios a and d approximately 40 of the areas had changed susceptibility levels of which about 56 3 converted from a low to high level and 43 7 converted from a high to low level these results suggest that from the spatial perspective climate change has had a greater impact on flood susceptibility than has human activity since 1985 zhou et al 2018 concluded that from the temporal perspective climate change 58 has a more important effect on runoff change than does human activity 42 in the dongjiang river basin located in guangdong province this indirectly verifies the reasonability of this discovery additionally the areas with increased susceptibility were found to be more than those with decreased susceptibility i e more areas are currently prone to flooding than were in the past this is also consistent with most previous studies on flood risk and implies that flooding remains a serious problem in guangdong province 5 discussion 5 1 implication and cause analysis as mentioned previously most previous studies could provide simple rates of the relative contributions of climate change and human activity for an entire basin based on time series while such methods are difficult to be used to understand the interior distribution of susceptibility and determine the exact locations for flood defense in contrast the present study spatially revealed the individual and comprehensive contributions of climate change and human activity to flood susceptibility via the constructed scenarios the susceptibility level and susceptibility conversion at each unit were also displayed with exact location information which would help to positively respond to flood disasters and take targeted measures besides climate change was found in this study to have a larger impact than human activity on the spatial scale the reason may be explained as follows first the weights of m1dp and avdr were large while those of rc and the other indicators were relatively small the mean values of m1dp and avdr in 2015 were 7 35 days and 132 83 mm and that in 1985 were 7 21 days and 131 48 mm which generally reveals that the rainfall intensity and days in 2015 were greater than those in 1985 more serious rainfall and a larger indicator weight resulted in more areas with high susceptibility secondly although the urban land areas increased greatly after 1985 due to the reform and opening up policy the areas with high susceptibility did not increase obviously especially in the prd because most of these newly urban areas had already been detected in 1985 as being highly susceptible due to their low elevations flat areas and close proximity to rivers in this case the increase of highly susceptible areas was limited although 50 of the changed areas were found to have an increased susceptibility level the areas that changed from a high to low level of susceptibility still account for a quite high percentage approximately 40 as shown in fig 9b most of these areas are mainly located in suburban and mountainous areas these areas may have benefitted from the two rounds of eco policy since 1999 that returned farmland to forests and grassland the increased areas of forests and grassland greatly improved the rainwater storage content and infiltration capability thus reducing the potential risk of floods 5 2 advantage and deficiency in this study we analyzed flood susceptibility in terms of disaster inducing factors and hazard inducing environment measured by 7 indicators and then constructed a flood susceptibility assessment model based on the cloud model the model can convert the uncertainty and randomness of indicators to certainty and determinacy by calculating the membership degree of a fuzzy function and choosing the value that best reflects the corresponding susceptibility level as a parameter for final calculation the cloud figures can also reflect the relationship between the grading standard and membership which aids in the understanding of the degree of credibility of the final assessment verification via comparison with historical flood data and relevant literature supported the creditability and reasonability of the proposed model the cloud model was also shown to produce better results than the fce and wlc methods additionally unlike machine learning models the cloud model is a non sampling model that does not require the use of flooding samples thus the assessment system could be constructed without using historical flooding samples which is ideal for regions with few or no flooded materials therefore the cloud model is strongly recommended for the assessment of flood susceptibility however some deficiencies remained in this study for example the term human activity in this study only considered the change of land use type whereas the total content of human activity is very rich thus the accuracy of the model may be further improved if more activities e g hydraulic structure construction water resources scheduling flood mitigation and control are considered similarly only the key indicator of rainfall was used to represent climate change and other climate factors including air temperature evapotranspiration wind speed and sunshine conditions were ignored additionally the subjective weight based on ahp was used as is well known ahp is strongly affected by expert knowledge and is subjected to many biases resulting in high subjectivity the model findings may be improved if the objective weight or even a combined weight that couples the subjective and objective weights is used 6 conclusions flood susceptibility assessment an important non engineering measure of preventing floods and reducing losses is a synthetic assessment and analysis method that involves numerous factors the cloud model is an effective method for solving the uncertainty between qualitative and quantitative concepts as it can consider fuzziness randomness and the relationship between them taking the guangdong province as a case study an indicator system was established by the use of seven indicators and an assessment model was constructed based on the cloud model ahp was also developed to evaluate indicator weights four scenarios were constructed and the relative impacts of climate change and human activity on flood susceptibility were explored from the spatial perspective the main conclusions of this study can be summarized as follows the m1dp avdr and rc are considered to be the most important indicators of flood susceptibility with relative weights of 0 345 0 218 and 0 154 while the remaining indicators were found to account for relatively small amounts the verification via historical flood data and relevant literature and comparisons with the results of the fce and wlc methods proved that the cloud model is a feasible reasonable and effective method that can be recommended for the assessment of flood susceptibility it was found that approximately 40 of areas experienced a changed flood susceptibility level since 1985 due to the comprehensive impacts of climate change and human activity of which about 56 3 converted from a low to high level and 43 7 converted from a high to low level for the hypothetical scenarios 35 7 of the areas experienced a changed susceptibility level due to climate change of which 55 8 converted from a low to high level and 44 2 converted from a high to low level in contrast only 9 8 of the areas had a changed susceptibility level due to human activity of which 57 2 converted from a low to high level and 42 8 converted from a high to low level from the spatial perspective climate change was generally found to have a larger impact on flood susceptibility than human activity credit authorship contribution statement shanshan li methodology software validation formal analysis writing original draft zhaoli wang project administration funding acquisition resources chengguang lai conceptualization resources writing review editing supervision funding acquisition guangsi lin project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is financially supported by the national key r d program of china 2018yfc1508200 the national natural science foundation of china 51879107 51709117 and the fundamental research funds for the central universities 2019jq06 our cordial gratitude also should be owed to the editor prof geoff syme and the two anonymous reviewers for their professional and pertinent suggestions and comments which are greatly helpful for further improvements of the quality of this manuscript 
