index,text
23860,the mapping and modeling subcommittee of the us national tsunami hazard mitigation program convened a workshop in january 2017 to evaluate the present state of numerical models for the simulation of tsunamis generated by submarine or subaerial landslides a range of benchmark tests were provided to participants with three tests emphasized i a laboratory submarine solid slide in a 2d horizontal tank ii a laboratory submarine granular slide in a 1d flume and iii a field case based on submarine slides which occurred in port valdez ak during the 1964 alaska earthquake nine landslide tsunami models configured with 21 different combinations of physical options were benchmarked including 1 hydrostatic models with no frequency dispersion which include the nonlinear shallow equation models traditionally used for modeling coseismic tsunamis 2 boussinesq or one layer weakly dispersive models 3 multi layer or non hydrostatic i e dispersive models and 4 full navier stokes models model data comparison indicates that the inclusion of frequency dispersion in model formulations is critical to obtaining physically reasonable results for the test cases considered because the importance of dispersive effects is unknown a priori for any given simulated event the central recommendation from this work is that a model with at minimum a leading order representation of frequency dispersion effects be used whenever possible for landslide tsunami simulations keywords tsunamis landslide tsunamis tsunami benchmarks landslide tsunami models 1 introduction in the past two decades the united states us national tsunami hazard mitigation program nthmp https nws weather gov nthmp has supported tsunami inundation mapping work involving model simulations from all relevant extreme tsunami sources along all the coastal regions of the us and its territories while coseismic tsunamis generated by large earthquakes still represent the largest and most significant source of tsunami coastal hazard for most areas in the us particularly those bordering the pacific ocean basin e g wilson and torum 1972 ichinose et al 2007 atlantic and gulf of mexico tsunami hazard assessment group 2008 tsunamis generated by subaerial or submarine mass failures referred to collectively here as smfs signifying submarine or subaerial mass failures represent another significant source of hazard for various segments of the us coastline this has been shown in particular for the gulf of mexico chaytor et al 2016 horrillo et al 2013 alaska e g coulter and migliaccio 1966 fine et al 1998 fritz et al 2001 2009 weiss et al 2009 nicolsky et al 2013 kirby et al 2016 hawaii e g day et al 2005 puerto rico lópez venegas et al 2008 2015 the west coast california oregon and washington states e g greene et al 2005 greene and ward 2003 and a large part of the us east coast usec where many paleo landslide scars and deposits have been identified on the continental shelf and margin with the 160 km 3 currituck slide complex off the coast of north carolina being the most prominent one e g atlantic and gulf of mexico tsunami hazard assessment group 2008 geist et al 2009 ten brink et al 2014 grilli et al 2015 for the usec the most devastating tsunami in recent history was caused in 1929 by an smf involving a 560 km 3 slump and subsequent debris flow triggered in the grand banks by a m7 2 earthquake e g fine et al 2005 løvholt et al 2019 schulten et al 2019 besides the risk posed by near field smfs e g geist et al 2009 grilli et al 2015 2017 schambach et al 2019 the usec faces potential hazard from tsunamis caused by far field landslides such as volcanic flank collapses in the canary islands e g ward and day 2001 løvholt et al 2008 abadie et al 2012 tehranirad et al 2015 there is also evidence that mega tsunamis were triggered in the distant past in the cape verde islands ramalho et al 2015 that may have affected the usec volcanic flank collapse which may affect all young or active volcanic islands is also a large source of potential hazard for hawaii e g mcmurtry et al 2004 day et al 2005 tsunamis triggered by smfs have occurred all over the world often with devastating consequences in the seismically active mediterranean basin the 1908 messina tsunami caused by a m7 5 earthquake was in part coseismic but recent work shows that the earthquake triggered a 2 km 3 smf on the flanks of mount etna that caused the largest runups up to 12 m and destruction in sicily schambach et al 2020 the combined 80 000 fatalities from the earthquake and tsunami make messina 1908 the worst natural hazard disaster in modern history in the region more recently the 1998 papua new guinea tsunami which was mainly generated by a deep 6 8 km 3 slump triggered by a m7 2 earthquake inundated the sissano spit to depths of over 10 m causing 2000 fatalities e g tappin et al 2008 heidarzadeh and satake 2015 the 2018 lateral collapse of the anak krakatau volcano following a long eruptive period despite being of moderate volume 0 22 0 27 km 3 generated 40 m tsunami waves in the near field that upon reaching the coast of java caused up to 12 m runup and over 450 fatalities e g grilli et al 2021 and references therein the m7 5 2018 palu earthquake triggered numerous small coastal smfs 0 4 7 10 3 km 3 that generated large waves which combined with the coseismic tsunami caused extensive destruction along palu bay combined together the earthquake and tsunami were responsible for 4300 fatalities e g 60 finally during the 2011 tohoku tsunami while the tsunami triggered by the m9 earthquake caused the major destruction an additional source is needed to explain the 40 m runup that struck the sanriku coast and some have proposed that a landslide tsunami was generated by a large and deep smf triggered by the earthquake near the japan trench tappin et al 2014 subaerial landslide tsunamis including volcano flank collapses represents the most slide events these includes also the most fatal landslide tsunami event to date the 1792 mount unzen tsunami sassa et al 2016 there have been about ten significant high run up subaerial landslides events that has taken place within the last decade such as for instance the 2007 aysen fjord landslides sepúlveda and serey 2009 2014 lake askja gylfadóttir et al 2017 the 2015 taan fjord tsunami higman et al 2018 and the 2017 karrat fjord tsunami paris et al 2019 svennevig et al 2020 further examples can be found in harbitz et al 2014 as evidenced by past historical events smf tsunamis whether triggered by an earthquake or not can be very devastating and if they are sourced in the near field such as on a continental shelf break their travel time to shore may be short hence if they reach shore undetected or with little warning their effects can be made even worse by the lack of time for evacuation various works have shown that independent of the triggering mechanism grilli et al 2009 the size of landslide tsunami waves is primarily a function of smf volume initial acceleration controlled mainly by bottom slope and submergence depth e g heinrich 1992 harbitz et al 1993 grilli and watts 1999 grilli et al 2002 grilli and watts 2005 watts et al 2005 yavari ramshe and ataie ashtiani 2016 snelling et al 2020 to an extent landslide tsunami waves are also a function of the smf rheology kim et al 2019 løvholt et al 2020 under certain circumstances such as when sequential slope failure rates are slow the material properties have a key control on the tsunamigenic strength løvholt et al 2017 field studies have shown that smfs can range from fairly rigid slumps or rotational failures e g tappin et al 2008 løvholt et al 2019 schambach et al 2019 2020 to debris flows behaving similarly to dense fluids e g grilli et al 2019 with a great variety of rheologies in between e g abadie et al 2010 mohammed and fritz 2012 grilli et al 2017 si et al 2018a b kim et al 2019 snelling et al 2020 additionally the wavelength l of landslide tsunamis scales with about twice the landslide horizontal dimension in its direction of motion watts et al 2005 and hence can be much shorter than the typically very long wavelength waves occurring in coseismic tsunamis with correspondingly shorter wave periods for area to volume landslide scaling relationships see urgeles and camerlenghi 2013 for this reason landslide tsunamis are often more significantly affected by frequency dispersion effects than are coseismic tsunami waves e g grilli and watts 1999 grilli et al 2002 watts et al 2003 grilli and watts 2005 watts et al 2005 ma et al 2012 glimsdal et al 2013 løvholt et al 2015 schambach et al 2019 in the early development and benchmarking of landslide tsunami models most investigators concentrated on modeling solid block landslides e g heinrich 1992 harbitz et al 1993 grilli and watts 1999 2005 grilli et al 2002 lynett and liu 2002 watts et al 2003 2005 liu et al 2005 using their own or other laboratory experiments for benchmarking e g enet and grilli 2007 ataie ashtiani and najafi jilani 2008 in parallel studies of tsunami generation by deformable slides were carried out either using depth integrated two layer model equations e g jiang and leblond 1992 1993 1994 fine et al 1998 or by solving 2d or 3d navier stokes equations e g assier rzadkiewicz et al 1997 these two approaches have led to a newer generation of models used more recently for simulating tsunami generation by deforming slides represented by a dense fluid or a granular material some of which will be detailed or applied and benchmarked later in this paper e g ataie ashtiani and shobeyri 2008 weiss et al 2009 abadie et al 2010 horrillo et al 2013 kirby et al 2016 george and iverson 2011 2014 ma et al 2013 2015 macías et al 2015 gonzález vida et al 2019 løvholt et al 2017 2019 kim et al 2019 zengaffinen et al 2020 zhang et al 2021a b macías et al 2021b for a comprehensive review of landslide tsunami modeling work through 2016 see yavari ramshe and ataie ashtiani 2016 as a result of the significant hazard posed by landslide tsunamis for many coastal areas of the us and its territories and to support the use of numerical models for simulating coastal tsunami hazard and inundation caused by landslide tsunamis the mapping and modeling subcommittee mms of nthmp convened a workshop in january 2017 at texas a m university galveston texas with the goals of evaluating the state of numerical models for the simulation of tsunamis generated by smf s and of drawing recommendations for best practice in model selection and modeling of these events earlier similar numerical model benchmarking workshops had been organized by nthmp mms in 2011 regarding tsunami runup and inundation horrillo et al 2014 and in 2015 regarding the prediction of tsunami induced coastal currents lynett et al 2017 nthmp modelers from different areas of the us as well as international experts were invited to attend seven benchmark tests were proposed based on earlier published work whose data and information were provided to participants ahead of the workshop three tests were emphasized that will be detailed in this paper benchmark 2 a laboratory submarine solid slide in a 2d horizontal tank enet and grilli 2007 benchmark 4 a laboratory submarine granular slide in a 1d flume grilli et al 2017 and benchmark 7 a field case based on submarine slides which occurred in port valdez alaska during the 1964 alaska earthquake nicolsky et al 2013 during the workshop nine landslide tsunami models with 21 different configurations were submitted for benchmarking and their results presented and discussed by the participants who are all co authors of this paper models were grouped into four categories based on their treatment of hydrodynamics and further into four categories based on their treatment of slide rheology as described below in section 3 the workshop is documented online at http www udel edu kirby landslide where the reader may find the final technical report along with write ups of guest presentations model descriptions descriptions of the seven benchmark tests the provided test data formatted model results for submitted models and programs used to conduct the quantitative tests described here in section 4 links to the workshop documentation may also be found at https nws weather gov nthmp 2017mmslandslide index html in this paper we present and discuss results of the three main benchmark tests and lessons learned for modeling best practice for landslide tsunamis the paper is organized as follows in section 2 we detail the three benchmark tests considered section 3 summarizes the models that were used in the benchmarking section 4 describes the methodology used to compare model results to benchmark data and to each other results of the model inter comparisons as well as comparison with benchmark data are given in section 5 section 6 provides conclusions and a discussion of resulting best practice guidance 2 benchmark tests participants in the workshop were provided with descriptions and observational results for seven slide configurations including three laboratory tests with solid slides grilli and watts 2005 enet and grilli 2007 liu et al 2005 three laboratory tests using granular slides grilli et al 2017 viroulet et al 2014 mohammed and fritz 2012 and a field case based on slides in port valdez ak during the 1964 alaska earthquake nicolsky et al 2013 full descriptions of the benchmarks and associated data sets are available at http www udel edu kirby landslide problems participants were asked to provide as a minimum results for benchmarks 2 4 and 7 which are described concisely below 2 1 benchmark 2 three dimensional rigid submarine slide 2 1 1 experimental set up and parameters this benchmark problem is based on the 3d laboratory experiments of enet and grilli 2007 documentation and data sets provided to workshop participants are available at http www udel edu kirby landslide problems benchmark 2 html the experiments were performed in the university of rhode island uri wave tank of width 3 6 m and length 30 m with a still water depth of 1 5 m over the flat bottom portion the model slide slid down a plane slope built in the tank with an angle θ 1 5 a definition sketch is provided in fig 1 as well as pictures of the experimental set up and an example of surface wave generation the submarine slide model was built as a streamlined gaussian shaped aluminum body with elliptical footprint with down slope length b 0 395 m cross slope width w 0 680 m and maximum thickness t 0 082 m fig 1b the slide shape is defined by 1 ζ ξ χ t 1 ε max 0 sech k b ξ sech k w χ ε where k b 2 b cosh 1 1 ε k w 2 w cosh 1 1 ε and where ξ χ are the local down slope and span wise coordinates with origin at the slide center the slide volume is given by 2 v b b w t i 2 c 2 i 1 i 2 ε 1 ε with i 1 i 2 0 c f g d μ f μ sech μ tan 1 sinh g g μ cosh 1 sech μ ε c cosh 1 1 ε the volume of the fabricated slide was measured to be v b 7 72 1 0 3 m 3 which using the above equations and slide geometry data yields ε 0 717 for which the coefficient of v b in eq 2 is 0 3508 the slide was released at time t 0 from a series of 7 initial submergence depths d fig 1 table 1 during its motion the slide was guided by a rail located on the slope tank axis using low friction wheels and slid a short distance 4 mm above the plane slope for each submergence depth d the slide initial abscissa x i and the abscissa of the slide point of maximum thickness x g are defined and related by 3 x g x i t sin θ d tan θ t sin θ with t t 0 004 m the measured slide mass was m b ρ b v b 16 00 kg and its bulk density based on measured volume was ρ b 2 073 kg m 3 measured data during each experiment included slide kinematics obtained from a composite of the slide acceleration measured using a micro accelerometer embedded within the slide as well as the time of passage of the slide through three electromechanical gates see enet and grilli 2007 for details surface elevation at up to four capacitance wave gauges g 1 to g 4 fig 2 wave runup r i e maximum vertical elevation on the slope at the tank axis y 0 wave gauge g 1 was located at x x 0 y 0 for each test the coordinates of gauges g 2 g 4 remained fixed for all tests and are given in table 2 the measured slide kinematics were found to have a good match with the theoretical law of motion for solid slides grilli and watts 1999 2005 given by 4 s s 0 ln cosh t t 0 with 5 t 0 u t a 0 s 0 u t 2 a 0 being the characteristic time and distance of motion respectively defined as a function of the terminal slide velocity u t and the slide initial acceleration a 0 which are given in turn by 6 u t g d b sin θ d 1 tan ψ tan θ γ 1 c d 2 f 2 ε f ε 7 a 0 g sin θ 1 tan ψ tan θ γ 1 γ c m where g is gravitational acceleration γ ρ b ρ w is the slide specific gravity c m is the slide added mass coefficient c d the slide drag coefficient and c n tan ψ the slide basal coulomb friction based on eq 4 for ε 0 717 we find c 0 8616 and f 0 8952 in each experiment the hydrodynamic coefficients c m and c d were calculated as least square fits by applying eqs 4 5 and 6 to the measured slide kinematics expressed as a composite of center of mass acceleration and time of passage at the known position of the 3 electromechanical gates see enet and grilli 2007 for details results are given in table 1 experiments were performed for 7 initial submergence depths d listed in table 1 together with values of related slide parameters and measured tsunami waves characteristics table 1 lists for each case the measured characteristic tsunami amplitude η 0 defined as the maximum depression at gauge g1 and maximum runup on the tank axis r these small runup values were measured using a digital camera directly viewing the waterline motion over a graduated scale 2 1 2 data provided and benchmark problem seven data files were provided to participants which contain for each of the 7 initial submergence depths d 61 80 100 120 140 149 189 mm the time series of surface elevation measured at up to 4 gages identified as g 1 g 2 g 3 and g 4 in mm in each file results are provided for each of two experimental replicates or runs marked as r1 or r2 done for the same initial slide parameters and for their average marked as ave in some of the tests data was missing for one of the runs and or for one of the gages in the latter case this is identified in the name tag given each file for instance d61g1234 txt or xls indicates that these are results for depth d 61 mm and gages g 1 g 2 g 3 and g 4 finally data files are all provided as tab delimited text files with one line of title to skip and excel spreadsheets fig 3 shows plots of observed surface displacements in blue at each gauge for the initial submergence depths of d 61 and 120 mm results from the non hydrostatic model nhwave ma et al 2012 benchmarked below configured with a specified bottom motion are shown as red lines for comparison to help modelers specify the slide motion for each experimental case data files kinematics txt or kinematics xls are provided which contain the average kinematics t s t recalculated for each average experiment using eqs 4 5 and the values of s 0 and t 0 listed in table 1 calculated using eq 6 and the other data in the table the benchmark problem consisted of using the above information on slide shape density submergence and kinematics table 1 together with reproducing the experimental set up to simulate surface elevations measured at the 4 wave gages average of 2 replicates of experiments as e g shown in fig 3 and present similar comparisons of model with experimental results participants were requested to provide as a minimum results for the two cases illustrated in fig 3 2 2 benchmark 4 two dimensional submarine granular slide 2 2 1 experimental set up and parameters this benchmark problem is based on 2d laboratory experiments of tsunami generation by a submarine slide made of glass beads performed in 2015 by kimmoun and dupont in the école centrale de marseille irphe precision tank grilli et al 2017 give the main features of the experiments and http www udel edu kirby landslide problems benchmark 4 html gives the complete description of the benchmark provided to the workshop participants these experiments were performed for a series of triangular submarine cavities filled with glass beads which upon release by lowering a sluice gate moved down a planar slope figs 4 and 5 provide pictures and sketches of experimental setup and execution fifty eight experiments numbered 13 to 72 in file tests landslide info xlsx available on the website were performed each with one replicate for the same parameters the tank had a width of w 0 25 m and useful length l 6 27 m and was filled with fresh water density ρ w 1000 kg m 3 to depth h 0 320 to 0 370 m fig 4 the glass beads had a density ρ b 2500 kg m 3 diameter d b 4 or 10 mm and a total dry weight w b 1 5 to 2 5 kg upon release by lifting a sluice gate beads were moving down a slope θ 3 5 causing wave generation on the surface fig 5 in 20 of the experiments a layer of glass beads was glued to the slope the starting time of experiments t 0 is defined when the gate has just withdrawn into its cavity fig 4 during experiments the deforming slide shape was recorded through the transparent side of the tank with a high speed video camera 1000 frames per second see file benchmark4 test17 video mp4 and time series of surface elevations were measured at 4 wave gages wg1 wg4 fig 4 fig 5 shows snapshots extracted from the video of test 17 which has parameters h 0 330 m d b 4 mm w b 2 kg and no beads glued on the slope up to t 0 60 sec the snapshots show that due to slide motion onshore moving waves are generated that cause runup on the slope with at the same time offshore moving waves that eventually reflect on the far end of the tank and propagate back towards the generation area this behavior is also clearly observed in time series measured at wave gages wg1 wg4 fig 6 a detailed analysis of experimental results shows that experiments were highly repeatable with almost unnoticeable differences between surface elevations for 2 replicates grilli et al 2017 simulated experiments for test 17 corresponding to the case illustrated in fig 5 with both the heavy newtonian fluid nhwave model of kirby et al 2016 and the granular slide nhwave model of ma et al 2015 fig 6 shows the comparison of free surface elevations simulated with the dense fluid model in which an average slide density ρ s 1951 kg m 3 was used together with a viscosity μ s 0 01 kg m s and a manning friction coefficient n 0 005 specifying friction between the slide and underlying slope the agreement observed in fig 6 between simulations and experiments is quite good note this parameterization of the average slide density and friction parameters is not unique and only provided here as an example modelers of this benchmark were free to select the parameters they felt were most appropriate to use for their model the fluid averaged density was obtained from a weighed average within the triangular cavity of the glass beads and interstitial water density assuming a random packing this also led to estimating the initial submergence depth for this case not measured to d 0 0422 m the selected value of viscosity was based on earlier work by mendoza and santamaria holek 2009 estimating viscosity for newtonian granular flows finally once the viscosity selected the manning n coefficient value was calibrated for the deforming slide to reach the slide bottom in simulations at the same time as in experiments 2 2 2 data provided and benchmark problem the benchmark here consists in using the above information to simulate as a minimum the glass bead experiment of test 17 and compare the computed surface elevations to those measured at the 4 wave gauges wg1 wg4 as in fig 6 the measured surface elevations for this test are provided in files benchmark4 test17 txt or benchmark4 test17 csv and the corresponding high speed video is given in file benchmark4 test17 video mp4 the data is given in format t s η 1 cm η 2 cm η 3 cm η 4 cm the entire set of experimental results for the 58 experiments is provided on the workshop website with parameters for each test given in file benchmark4 tests landslide info xlsx and the surface elevations measured for each test given in file benchmark4 gages zip together with a matlab code to extract and plot the data for each test case this code also calculates the various dimensions of the slide itself plus necessary parameters for computations 2 3 benchmark 7 slide at port valdez ak during 1964 alaska earthquake this benchmark problem is based on the historical event which occurred at port valdez ak during the alaska earthquake of march 27 1964 coulter and migliaccio 1966 plafker et al 1969 wilson and torum 1972 sketches showing the general area aerial photos before and after the event the inferred motion of a vessel which broke free of its moorings and observed runup and debris lines are provided for the region of old valdez in appendix b figs b 1 b 3 the event has recently been studied by nicolsky et al 2013 and parsons et al 2014 the first document provides an overview of the historical background and geology for the site and is the principal source for the problem described below the description of the benchmark provided to participants may be found at http www udel edu kirby landslide problems benchmark 7 html 2 3 1 landslide at the head of valdez bay the largest destruction in valdez bay during the m w 9 2 alaska earthquake happened in the dock and harbor area where a massive submarine landslide generated a tsunami inundating the waterfront up to two blocks inland and causing up to 52 m runup in port valdez the pre and post earthquake bathymetry profiles near the site are shown in coulter and migliaccio 1966 to the south of valdez depth changes exceeding 90 m occurred which exceeds the depth change off valdez itself thus the major part of the slide took place off the lowe river delta it is estimated that approximately 75 1 0 6 m 3 of unconsolidated deposits were transferred from the waterfront into the bay coulter and migliaccio 1966 the sequence of tsunami waves following the landslide was reconstructed from eyewitness reports and observations hence there are inherent uncertainties in the resulting estimates of wave time arrivals and wave heights the following account of the earthquake is taken from wilson and torum 1972 unless otherwise noted on the evening on march 27 1964 the 10 815 ton m v chena was unloading freight at the valdez dock position a in fig b 2 the ship initially went astern position b with the water withdrawal that accompanied the initial subsidence of the docks and then the chena heeled to port and rose by 6 9 m on an incoming wave and bottomed at the previous location of the docks position c she then came upright took another roll to the port and was carried to the small boat harbor positions d e the chena was momentarily aground with her stern in the wreckage of pilings consequently the chena took a violent roll to the starboard before the boat harbor began to fill with water pouring from the shore a flux of water from the south filled the boat harbor and carried boats and buildings dislodged by the first wave towards the valdez hotel it also lifted the chena and enabled her to float free positions e f the water began to drain from the boat harbor and the ship came under the influence of a strong southerly current which carried her close alongshore as in a jet stream position f as the chena was moving south water was seen cascading over the slide scarp the extent of inundation by waves which lifted the chena is hard to constrain based on objective measurements some eyewitnesses drove up alaska avenue fig b 3 to the corner of mckinley street in an attempt to reach higher ground but a large volume of water flowing down the avenue made it impossible to proceed further they turned right and went to the vicinity of the standard oil company plant and then turned up broadway avenue and proceeded on foot in 0 45 m deep water another eyewitness reported that a wave washed onto mckinley street on the northeast side of town within 5 min after the first shock and reached two blocks inland it is thus reasonable to assume that at least two waves flooded the valdez waterfront and destroyed what was left within two blocks of shore the runup reached beyond mckinley street or about 300 m from the pre earthquake shoreline at several points the second wave crossed the waterfront 10 15 min after the first wave carrying a large amount of the debris it has been described as a violent surging wave only slightly smaller than the first water from the second wave reached a depth of 0 46 m in the valdez hotel on mckinley street wilson and torum 1972 the location of the hotel is shown in fig b 3 by the red triangle it is believed that the second wave which flooded the waterfront originated at the other side of the port valdez near the shoup bay moraine 2 3 2 landslide at shoup bay moraine there were no eyewitnesses to waves that struck the shore at other locations along port valdez however the inundation line was evident from scattered debris and marks on fresh snow fig 7 shows the observed runup around port valdez the highest location obliterated by waves was near the large abandoned cliff mine according to plafker et al 1969 the waves deposited driftwood at points 52 m 170 ft above sea level and splashed silt and sand up to an elevation of 67 m 220 ft directly across from the cliff mine in anderson bay at the south shore of port valdez the waves ran up to 24 m 78 ft above the water level and destroyed a small fishing camp all structures of the camp were swept away leaving only the driven piling foundations its sole inhabitant harry henderson was missing and presumably drowned in the violent local waves that struck anderson bay the abandoned dayville cannery at jackson point 8 km 5 mi east of anderson bay was also extensively damaged by waves that reached as high as 9 5 m 31 ft elsewhere along the shore violent waves broke spruce trees with a diameter of 0 6 m 2 ft at elevations as high as 31 m 101 ft and deposited barnacle covered boulders estimated to weigh 760 kg 1700 lb at points 27 m 88 ft above the shoreline the waves that moved westward from port valdez overtopped and destroyed the valdez narrows navigation light shown in fig 7 by the red triangle situated on top of a reinforced concrete pedestal 11 m 36 ft above the lower low water level 2 3 3 data provided and benchmark problem the post earthquake bathymetry together with the slide thicknesses shown in fig 8 were provided as a single file benchmark 7 data zip this archive also contains shape files delineating the extent of the observed inundation at the head of port valdez and locations of the debris from the first wave the matlab script readdata m reads all available data and plots contours of the slide thicknesses fig 8a b as well as the extent of inundation near the head of port valdez fig 8c the benchmark problem here consisted of simulating the extent of inundation for two slide events at the head of valdez bay and at the shoup bay moraine based on before and after bathymetry data eye witness observations of the event and observed runup distribution for the slide at the head of port valdez hpv64 it was recommended to 1 reproduce two waves that struck the valdez waterfront 2 simulate the extent of inundation reaching at least to mckinley street for the slide at the shoup bay moraine sbm64 it was recommended to 1 simulate the extent of inundation around port valdez and reproduce the 20 m runup at anderson bay 2 simulate the 10 m wave inundating the navigation light shown in fig 7 by the red triangle in valdez narrows 3 simulate the 0 5 m wave in the valdez hotel shown in fig 8 by the red triangle located in the head of port valdez 3 models used in the benchmarking exercise a total of 9 models were benchmarked as part of the 2017 workshop individual documentation for each of the models used is provided at http www1 udel edu kirby landslide models html several of the models could be configured in a variety of ways leading to a total of 21 model configurations listed in table 3 for the purposes of comparison the models were grouped into four hydrodynamic configurations including 1 hydrostatic models with no frequency dispersion with results indicated by circles in figs 11 14 2 boussinesq or one layer weakly dispersive models indicated by 5 pointed stars 3 multi layer or nonhydrostatic models indicated by 6 pointed stars 4 fully 3d navier stokes solvers with surface reconstruction indicated by asterisks additionally modeled slide rheology was grouped into four categories including 1 solid slides usually an imposed bottom deformation in time indicated by red symbols 2 viscous slides indicated by green symbols 3 granular slides indicated by blue symbols 4 3d continuously varying phase or multiphase indicated by black symbols a brief introduction to each hydrodynamic configuration and treatment of slide rheology is provided in the following two sections a more complete introduction to each model references to model descriptions in the primary literature and a description of the range of configurations for each model in the present tests may be found in the individual model write ups posted on the workshop website at http www1 udel edu kirby landslide reporting html 3 1 treatment of hydrodynamics in models 3 1 1 non dispersive models models in the non dispersive category generally solve the nonlinear shallow water equations nlswe in this class of model the pressure field is assumed to be hydrostatic with respect to the local water surface which for constant water density ρ gives 8 p ρ g η z where η is the water surface displacement away from rest and η z represents the distance below the surface as a result of this simplification horizontal pressure gradients are depth uniform and hence horizontal velocities are uniform over depth if the effects of turbulence and bottom drag are neglected models of this type are historically known to be good simulators of runup and inundation but they can accumulate significant errors when used to propagate waves over long distances or over depths which are not small compared to horizontal wavelengths as a result of the lack of dispersive effects kirby et al 2013 schambach et al 2019 nevertheless they have been applied to landslide tsunami modeling e g harbitz et al 1993 fine et al 1998 2005 salmanidou et al 2017 in the linear limit waves in this category have the frequency independent phase speed c 0 g h where h is still water depth as part of the workshop the models 2lcmflow yavari ramshe and ataie ashtiani 2017 alaska gi l citepnicolsky etal pag11 nhwave ma et al 2012 2013 2015 in hydrostatic mode hysea for benchmark 7 macías et al 2015 fbslide and lynett nlsw lynett and liu 2002 belonged to this category see table 3 3 1 2 weakly dispersive boussinesq type models waves on the surface of finite depth water have a phase speed c given by 9 c c 0 tanh k h k h 1 2 where k 2 π l is the wavenumber and l is the corresponding wavelength for most cases of tsunami generation propagation and inundation the dimensionless number k h or essentially the ratio of water depth to wavelength is relatively small the limit of k h 0 recovers the non dispersive model the class of weakly dispersive models including boussinesq serre and greene naghdi models retains additional information about c for finite but small values of k h e g wei et al 1995 lynett and liu 2002 watts et al 2003 lynett 2006 løvholt et al 2008 roeber et al 2010 shi et al 2012 kim et al 2017 this information is usually related to an asymptotic form of the taylor series for the added factor in eq 9 for example 10 tanh k h k h 1 1 3 k h 2 o k h 4 the corresponding corrections to the horizontal water velocity are usually obtained in the form of a power series in z and various models may retain higher order information in powers of k h or may use series manipulation to obtain rational polynomial forms of eq 10 which are more accurate or better behaved for large k h models in the following category of dispersive models may be reduced to this form if lowest order treatments of the model s vertical structure are employed such as restricting the model to a single vertical layer see brocchini 2013 and kirby 2016 for recent reviews of this class of model as part of the workshop the models globous løvholt et al 2008 boussclaw kim et al 2017 and ls3d ataie ashtiani and najafi jilani 2007 belonged to this category see table 3 3 1 3 dispersive models models in this category are essentially solutions of the full hydrodynamic problem under a restrictive set of simplifying assumptions in particular the water surface is assumed to be a single valued function of horizontal position and time this assumption eliminates the potential for directly describing phenomena such as wave crest overturning during breaking however as a result models in this class do not require the elaborate reconstruction of arbitrary surface geometries employed in more complete navier stokes solvers the models also typically employ a reduction of the vertical structure of the problem to a finite number of coupled layers using either low order approximations of the dynamics in each layer stelling and zijlema 2003 bai and cheung 2013 or by using differencing stencils applied to the relatively low resolution vertical structure ma et al 2012 these models are reduced to the level of accuracy of boussinesq models by reducing the number of vertical layers to one yamazaki et al 2011 or they may approach a full solution of the surface wave problem by allowing the number of vertical layers to be as large as needed models for perfect fluid hydrodynamics for surface waves with lengths of k h values appropriate to tsunamis are often adequately described using no more than three vertical layers models which solve the fully nonlinear potential flow problem e g grilli and watts 1999 grilli et al 2002 2010 or reproduce the exact linear dispersion relation for narrow banded waves in slowly varying domains such as the mild slope equations berkhoff 1972 smith and sprinks 1975 are included in this category as part of the workshop the models nhwave and hysea configured as a multi layer non hydrostatic models and lynett mse bellotti et al 2008 belong to this category see table 3 3 1 4 models based on navier stokes solvers models in this final category typically solve the full set of navier stokes equations together with boundary conditions applied at an arbitrary unknown surface e g heinrich 1992 assier rzadkiewicz et al 1997 popinet 2003 liu et al 2005 ataie ashtiani and shobeyri 2008 weiss et al 2009 abadie et al 2010 2012 horrillo et al 2013 accurate reproduction of surface geometry requires a great deal of spatial and temporal resolution in the calculation and hence models of this type typically are expensive to run in terms of time and computer resources as part of the workshop the models tsunami3d horrillo et al 2013 thetis newt and thetis mui clous and abadie 2019 belonged to this category see table 3 3 2 treatment of slide rheology and motion in models 3 2 1 solid slides solid slide motion and geometry are typically specified as a bottom boundary condition either determined a priori or by applying laws of motion developed for translational and rotational solid slide motions e g grilli and watts 1999 grilli et al 2002 lynett and liu 2002 grilli and watts 2005 watts et al 2003 2005 day et al 2005 among the models featured in the workshop globous bousclaw ls3d fbslide and lynett belonged to this class of models with nhwave and hysea having this configuration as an option see table 3 using this approach deforming slides with a specified geometry and deformation can also be specified as a bottom boundary condition lynett and liu 2002 grilli and watts 2005 as is usual for solid slide simulations there is typically no attempt to couple the slide and water motions dynamically with the latter only affecting the slide motion through simple coefficients e g drag and added mass coefficients salmanidou et al 2017 an exception to this lack of coupling is for instance the work of abadie et al 2010 who used the multi material navier stokes model thetis to simulate both deforming and rigid slides with the latter represented by a fluid of very high viscosity with this model they accurately simulated the solid block experiments of liu et al 2005 for both subaerial and submarine cases without specifying the block law of motion which was implicitly found in the model through an internal balance of forces 3 2 2 deforming slides simulated as dense viscous or viscoplastic fluids many early models e g heinrich 1992 harbitz et al 1993 assier rzadkiewicz et al 1997 fine et al 1998 and some recent models e g løvholt et al 2017 grilli et al 2019 have simulated tsunami generation by deformable slides by modeling the bottom layer as a dense viscous fluid newtonian or non newtonian e g see the recent review by yavari ramshe and ataie ashtiani 2016 water motion was either modeled in a single depth integrated upper layer two layer models e g heinrich 1992 harbitz et al 1993 assier rzadkiewicz et al 1997 fine et al 1998 or in multiple layers e g kirby et al 2016 grilli et al 2017 and references therein this motion was coupled to the motion of the bottom layer slide through dynamic and kinematic equations at the slide water interface depending on model type water motion was based on solving various sets of equations with different featured physics from hydrostatic to non hydrostatic dispersive for example the two layer models of kirby et al 2016 in which the upper water layer is modeled with the non hydrostatic σ coordinate 3d model nhwave ma etal om12 or full navier stokes see e g 2d or 3d navier stokes equations to simulate subaerial or submarine slides modeled as dense newtonian or non newtonian fluids by løvholt et al 2017 ataie ashtiani and shobeyri 2008 weiss et al 2009 abadie et al 2010 2012 horrillo et al 2013 among the models featured in the workshop nhwave and alaska g il belonged to this class of models thetis and tsunam3d also modeled slides as a dense viscous fluid layer but within a multi material navier stokes framework see table 3 3 2 3 slides simulated as saturated granular debris flows a number of recent laboratory experiments have examined tsunamis generated by subaerial landslides made of gravel fritz et al 2004 ataie ashtiani and najafi jilani 2008 heller and hager 2010 mohammed and fritz 2012 or glass beads viroulet et al 2014 for deforming underwater landslides and related tsunami generation 2d experiments were performed by assier rzadkiewicz et al 1997 who used sand ataie ashtiani and nik khah 2008 who used granular material and grilli et al 2017 who used glass beads to simulate such experiments models have been developed on the same principle as the dense fluid bottom layer but for a bottom layer representing a granular medium or saturated debris flow e g george and iverson 2011 2014 ma et al 2015 grilli et al 2017 another approach to simulate tsunami generation by granular slide or sediment motion has been to simulate flows induced by a varying sediment concentration e g ma et al 2013 among the models featured in the workshop nhwave hysea and 2lcmflow belonged to this class of model for a more comprehensive review of recent modeling work in these areas see yavari ramshe and ataie ashtiani 2016 3 2 4 slides simulated as multiphase components in fully 3d settings in this implementation models solving the navier stokes equations in reynolds averaged form together with complete or single valued representations of water surface geometry are typically solved for multiple fluids mediums one of which is a deforming slide and the other water and air an example is the multi material model thetis by abadie et al 2010 which was used to simulate deforming slides in a laboratory set up or in the field abadie et al 2012 other examples of this approach are described by ma et al 2013 horrillo et al 2013 and lópez venegas et al 2015 to this end more sophisticated landslide dynamics models are presently being incorporated into full 3d models for landslide tsunamis through multi phase coupled porous granular rheology si et al 2018a b rauter 2021 among the models featured in the workshop thetis tsunami3d and one variant of nhwave belonged to this class of model 4 analysis approach this section details the different metrics used in the model data comparison for each benchmark with model data and model model intercomparisons described in the following section 4 1 rms error metrics for time series comparison rms error metrics compare the structure of observation and simulation at each gauge location integrated over time in order to apply these metrics it is necessary to interpolate data and model results onto similar discrete time axes this operation is performed here by interpolating simulation results onto the time axis for observations the comparison is carried out for each case over a time range corresponding to the existence of useful observational data since rms error estimates for oscillatory signals are also highly sensitive to phase mismatches the results obtained here are based on shifting simulation results in time in order to obtain a specific synchronization at one of the gauges in most practical situations tsunami hazard is not affected by small phase differences hence simulating an accurate time series in the model is deemed a success even if there is a small phase shift the first error metric represents the square root of the mean square error between observation and simulation results normalized by the difference between the largest maximum and minimum value of η this metric is denoted by ε g and is given by 11 ε j g i n η m i j η o i j 2 max i η o i j min i η o i j j 1 n g where n g is the number of gauges in each experiment and n is the number of points in the time series a second alternate rms error metric denoted ε k is given by 12 ε j k i n η m i j η o i j 2 i n η o i j 2 j 1 n g where the normalization is with respect to the root mean square of the observations standard deviation if the mean is zero again for each gauge results in section 5 are shown for the first measure eq 11 results based on eq 12 are numerically different but were found to be qualitatively similar in pattern hence they are omitted 4 2 statistics of surface displacements additional metrics were developed to quantify model reproduction of surface elevation maxima surface elevation minima maximum surface wave height and wave packet variance which are important for quantifying various aspects of tsunami hazard maximum surface displacement for a single gauge normalized by observed values 13 ε j 1 max i η m i j max i η o i j j 1 n g minimum surface displacement for a single gauge normalized by observed values 14 ε j 2 min i η m i j min i η o i j j 1 n g total surface excursion for each gauge normalized by the maximum observed surface excursion 15 ε j 3 max i η m i j min i η m i j max i η o i j min i η o i j j 1 n g total variance for each gauge normalized by observed variance for each gauge 16 ε j 4 i 1 n η m i j 2 i 1 n η o i j 2 j 1 n g 4 3 wavelet analysis of transient wave packets tsunami events typically consist of finite length packets of waves with rapidly varying frequency and amplitude an analysis of the distribution of amplitude and frequency in space and time can be revealing of the underlying fluid mechanics governing the propagation of the waves in particular we can examine the effects of frequency dispersion or non hydrostatic behavior on the advancing wave this analysis needs to be carried out using a framework that is appropriate for describing non stationary behavior of the analyzed signal and it is performed here using the continuous wavelet transform cwt see addison 2018 for a recent overview the description of the cwt is well established but may be unfamiliar to some readers and so a description of the basics is provided as appendix a to illustrate the application of the cwt to a tsunami signal we show in fig 9 the modulus of the transform t t f as a function of frequency and time for benchmark 2 d 61 mm data table 1 solid red curves show the locus of times at which the maximum of t occurs at each frequency f the panel for gauge 3 fig 9c shows two additional curves for benchmark 2 gauge 3 g3 in fig 2 is located downslope in the direction of landslide travel a wave with frequency f traveling in this direction from location x 1 to x 3 would traverse this distance in a time interval 17 t 3 t 1 x 1 x 3 d x c h x f where depth h varies in x and where the local speed of propagation c h f depends on h and in the case of dispersive motion frequency f two relevant speeds based on linear wave theory are the phase speed c and the group velocity c g given in terms of wavenumber k 2 π l where l is wavelength by 18 c 2 g k tanh k h c g c 2 1 2 k h sinh 2 k h with g 9 806 m s 2 being gravitational acceleration in the long wave limit k h 0 both c and c g are asymptotic to g h and dependence on frequency is lost in this limit all wave components in a multi component wave train would travel at the same speed this is the non dispersive limit characteristic of either linear or nonlinear shallow water equations in fig 9a the nearly vertical red line represents the location of the initial packet during the drawdown process a reference frequency ω 0 5 see eq a 8 in appendix was used for gauge 3 the red dashed line represents replacing c in eq 17 by group velocity c g while the dotted red line represents replacing c by phase speed c intrinsically we would expect the propagation of the energy content at each frequency to be governed by the group velocity so that the solid red line and dashed red line would coincide several factors keep this from being apparent in this case first the slide is present in the domain during the propagation process and thus phase speed or group velocity are affected by a time varying bottom geometry and are not straightforward to interpret more important however is a processing artifact which reduces the apparent arrival time when the wavelet width is adjusted to improve time localization relaxation of this constraint in favor of improving frequency localization leads to better estimates of arrival time since the estimate at each frequency is less contaminated by neighboring frequencies in the strongly dispersive cases considered this effect is illustrated in fig 10 for time series measured at gauge 3 wg3 in benchmark 4 figs 3 to 6 results for the wavelet transform are shown in the figure for a scaled reference frequency ω 0 5 or 15 the improvement in agreement with linear theory and propagation at the group velocity is apparent since this result is expected and should be intrinsic to all the cases considered here we show all results in section 5 in terms of wavelets with higher temporal resolution we utilize arrival times at each gauge and frequency in model data comparisons in order to assess the accuracy of models to represent propagation at each component frequency 5 model data comparisons in this section we evaluate the performance of all submitted model results for benchmarks 2 and 4 using the methods described in section 4 we then provide a more qualitative analysis of results for benchmark 7 where model results are subject both to the choice of model and the modeler s subjective treatment of information related to the provided input data 5 1 data sources see http www1 udel edu kirby landslide reporting html for data needed to reconstruct the results shown here in particular 1 http www1 udel edu kirby landslide report formatted results zip provides data in a common format files in the unzipped folder are matlab mat files each containing a single data array with dimension n by 5 for benchmarks 2 and 4 the array columns contain time s and surface displacements at gauges 1 4 mm for benchmark 7 the files are in a similar format with columns 2 5 displaying elevations at the navigation light old valdez hotel point 37 and point 38 all in meters m each file name follows the following convention bmx my note mat where x denotes the benchmark number 2 4 or 7 and y denotes the model number as indicated in table 3 possible notes are d061 or d120 for the two depths of submergence in benchmark 2 or case1 for benchmark 4 which indicates the data set test17 and was the only case used here for each case in benchmarks 2 and 4 model number x 0 indicates the observed data reformatted into the same common format time series of observed data do not exist for benchmark 7 finally the folder contains submitted results for several of the models for benchmarks 3 and 5 these results are provided for inspection but are not analyzed or otherwise represented in the final technical report for the workshop or in this paper 2 http www1 udel edu kirby landslide report errors zip provides a table of results for the individual model rms errors with models listed as indicated in table 3 in the file error data mat eq 11 and for the surface elevation errors in the file error heights mat eq 13 16 3 http www1 udel edu kirby landslide report programs zip contains the matlab scripts used to carry out data analysis and model data comparisons these scripts were written by the first author jk except for portions of the script for benchmark 7 provided by the fifth author dn and are in the public domain the readme file in the zipped folder provides a complete table of contents for the scripts used we note that the presentation of results by model number in figs 11 14 does not correspond to the numbering of models in table 3 where the models are not grouped in terms of hydrodynamic or rheological choices data are grouped according to the choice of hydrodynamic formulation in figs 11 14 in order to accentuate the consistency of results within each of the four groups the correspondence to individual models as listed in table 3 is preserved in the filenames for the mat files as indicated above 5 2 rms error metric we first consider the distribution of rms errors for each gauge as given by the error metric ε g defined in eq 11 in order to emphasize consistency between model types we provide results here without regard to the performance of individual models the reader may reconstruct these correspondences if desired by looking up individual error estimates in the files error data mat and stuff mat where the errors are listed with model numbers corresponding to entries in table 3 the metric ε g describes a normalized rms error based on comparison of the modeled and observed time series at each measurement location results of this test are shown in fig 11 where ε g for each model is presented without reference to gauge location and for both benchmarks 2 and 4 the results show a clear tendency towards decreasing error for models with more accurate dispersion properties non dispersive hydrostatic models show a tendency towards a much higher rms error with values up to 2 to 3 times higher than the next most accurate category the weakly dispersive models represented by boussinesq type models models in the last three categories weakly dispersive dispersive and navier stokes are generally consistent with each other with rms error measures of around 0 1 the most accurate simulations were for model 13 which represented a non hydrostatic model run for benchmark 4 with viscous slide rheology in general the dispersive models slightly outperformed the weakly dispersive models which could be expected they also outperform the navier stokes solvers which could be due to limitations in the handling of slide rheology properties in a fluid continuum overall however this figure does not provide a dramatic sorting of the 3 types of models which incorporate some degree of frequency dispersion in the treatment of the surface wave as they all perform reasonably well fig 12 shows the rms error ε g for all gauges in benchmarks 2 and 4 sorted by hydrodynamic model type the most dramatic result here is again the distinction between hydrostatic models and the remaining three categories with the hydrostatic models showing systematically higher error at all gauge locations fig 12 also shows a distinction between boussinesq models panel b and the remaining categories of dispersive models with boussinesq models showing an increasing error with distance away from the source region whereas non hydrostatic and navier stokes models give a fairly constant level of error across all four gauge locations due to the accurate representation of dispersion finally fig 13 separates the rms error ε g for benchmarks 2 with a solid slide and 4 with a granular slide models performed comparably on each benchmark with the hydrostatic models showing the greatest error in either case 5 3 surface displacement error metrics fig 14 shows the surface displacement error metrics defined in eqs 13 16 computed based on all benchmarked model results table 3 for the 4 gauges in benchmarks 2 and 4 fig 14a shows the normalized maximum surface elevations ε j 1 eq 13 and normalized minimum surface elevations ε j 2 eq 14 for j 1 4 hydrostatic models all show large negative minimum value of the error metrics associated with the large surface drawdown occurring over the moving slide in hydrostatic simulations see e g fig 17c for model 14 for a dramatic example of this effect for benchmark 7 almost all cases with a large overprediction of maximum elevation are associated with benchmark 2 gauge 1 where positive surface displacements in the experiment are generally quite small aside from these anomalies the models with some representation of frequency dispersion perform adequately and in a fairly uniform manner with each category outperforming the hydrostatic models fig 14b shows ε j 3 eq 15 which indicates how well total surface excursion is simulated over the entire generated wave packet and ε j 4 eq 16 which indicates how well the packet total variance is predicted strong biases in total excursion and variance for the hydrostatic models result from their tendency to predict an overly deep wave trough occurring above the moving slide mass the remaining model types behave consistently although there is some indication that the navier stokes models are predicting wave packets that are both overly energetic and having too large total surface excursions compared to the non hydrostatic models which outperform both of the other two dispersive model categories on these metrics 5 4 wavelet analysis of model results a brief overview of the results of the wavelet analysis of model results detailed in section 4 2 is provided here with the bulk of results shown in appendices d e and f of kirby et al 2018 the results here contrast the non hydrostatic and hydrostatic versions of nhwave for benchmark 4 with a granular slide layer these appear as models 3 and 16 table 3 respectively in figs 11 and 14a b fig 15 for the non hydrostatic case shows that with a model that reproduces dispersion properties accurately the arrival time of energy at distant gauges on a frequency by frequency basis is correctly predicted fig 15a shows time series of measured and simulated surface elevations at the four gauges wg1 wg4 fig 4 model results are in overall good agreement with the experimental data in figs 15b e the modulus t of the wavelet transform is plotted as a function of frequency f and time t at each gauge for both the experimental data and model results again the agreement is overall quite good in each plot the thick blue or red lines are drawn through the maxima of the transforms for model and data respectively and indicate arrival time for the center of the energy packet at each component frequency or scale in the transform space the red dashed lines indicate a hypothetical arrival time based on initialization at the time indicated in panel a and then being displaced forward in time according to the prediction of linear theory with later arrival times indicating lower phase speeds with increasing frequency the deviation of both measured and modeled wave motions could be taken to indicate the tendency for higher frequency components to behave more like bound harmonic of lower frequency components rather than as free waves indicating the importance of nonlinearity in the problem however as discussed in connection with fig 10 the deviation from linear theory prediction is more likely due to the effect of leakage of information across the frequency axis causing the more energetic lower frequency components to dominate the apparent results at higher frequencies overall the best indicator of proper model performance is a continuing overlap of the blue and red line segments indicating the arrival of the wave packet maximum in contrast fig 16 for the non dispersive case with model 16 shows that energy at all frequencies is moving approximately at the same speed as the lower frequency components which is consistent with the frequency independent phase speed of c g h for all frequencies in this limit the model results here are strongly contaminated by reflection effects leading to the double peak in the transform the lack of any frequency dependence in phase speed is clear however 5 5 benchmark 7 qualitative analysis benchmark 7 differs from benchmarks 2 and 4 in that there is less basis for a quantitative comparison to observations in addition results are subject to choices made by each modeler in setting up the simulation and thus it is possible that different results could be obtained by different modelers using the same model code results were submitted for five models table 3 nhwave model 2 tsunami3d model 8 ls3d model 12 alaska gi l model 14 and landslide hysea model 17 details setup of each model considered may be found in the individual model write ups at http www1 udel edu kirby landslide reporting html we proceed here by showing and discussing the available results for 1 water surface elevation time series at the navigation light valdez hotel p37 and p38 fig 17 models 2 8 12 partial 14 17 table 3 2 maximum surface elevation occurring over the port valdez domain fig 18 models 2 8 14 17 and 3 inundation lines in old valdez fig 19 models 2 8 12 14 17 4 runups at points identified in plafker et al 1969 table 4 models 2 12 where the numbers in parentheses indicate models for which the data in question is available time series of surface elevation in fig 17a d are shown at the navigation light hotel valdez and points 37 and 38 for the results of both slides being superposed if they were provided separately time zero was taken to be the first indication of drawdown above point 37 which is located over the hpv64 slide in front of old valdez fig 8 in the event that results for the two slides were superposed it was assumed that the start times for each separate slide simulation were the same the results show interesting patterns of both agreement and difference at point 37 fig 17c where the initial motion is simply the drawdown associated with the hpv64 slide failure models 2 and 8 which utilize the same viscous slide model show nearly the same results up until about 10 min into the simulation which coincides with the arrival of the sbm64 fig 8 first wave front in contrast the granular slide used in model 17 shows a drawdown at this location which is more organized around the time following initial motion reminiscent of the isolated drawdown at gauge 1 seen in benchmark 2 tests the drawdown predicted by model 8 tsunami3d is more featureless in time and does not show nearly as much higher frequency structure time series for point 38 at the valdez shoreline fig 17d and the valdez hotel fig 7b show the progression of the first wave resulting from the hpv64 slide with the wave arriving at point 38 slightly sooner in model 14 hydrostatic than in models 2 non hydrostatic and 17 hydrostatic arrival times for the first wave at hotel valdez are very consistent and are slightly higher for model 14 than for models 2 and 17 the first arrival at the navigation light results from the sbm64 slide in the western portion of the domain in this case models 14 viscous slide and 17 granular slide give very consistent results for wave height at the navigation light while model 2 has a very different pattern of arriving waves a plot of maximum occurring surface elevation over the entire domain in fig 18 shows a distinct difference between the results for models 2 and 8 which direct the majority of the sbm64 towards the interior of port valdez and models 14 and 17 which show a much more equal bifurcation of wave direction and an improved simulation of the arrival at the navigation light a comparison of predicted maximum runups at observational points listed by plafker et al 1969 with observed results are shown in table 4 and also show the overprediction by model 2 at sites within port valdez the tendency for model 2 to direct the majority of the simulated wave energy to the interior of port valdez led to an over prediction of the extent of tsunami inundation in the area of old valdez shown previously in fig 17 b for hotel valdez and d for point 38 closer to the old valdez waterfront the overly large second wave leads to an overprediction of the extent of inundation around old valdez in comparison to observations and other model results which are more consistent fig 19 the reason for these anomalies has not been further examined 6 discussion and conclusions a landslide tsunami model benchmarking workshop was organized in 2017 on behalf of the us national tsunami hazard mitigation nthmp program see https nws weather gov nthmp 2017mmslandslide index html with the goals to evaluate the state of numerical models for the prediction of tsunamis generated by subaerial or submarine landslides or more generally submarine mass failures smfs and draw recommendations for best practice in model selection and modeling of these events nine landslide tsunami models with 20 different model configurations tested table 3 were submitted for benchmarking which were regrouped into 4 classes representing 1 hydrostatic models with no frequency dispersion 2 boussinesq or one layer weakly dispersive models essentially a two dimensional 2d horizontal framework 3 multi layer or non hydrostatic i e dispersive models three dimensional 3d framework but with a limited discretization in the vertical direction and 4 full 3d navier stokes models seven benchmarks were proposed to the participants 6 based on published laboratory experiments and one being the historical case study of 1964 port valdez alaska but modelers were only requested to simulate benchmarks 2 4 and 7 with 2 and 4 being laboratory experiments for a solid and granular slide respectively and 7 being the port valdez case study results and a comparison of model performance on these 3 benchmarks were presented in this paper results presented here show that overall models that included non hydrostatic i e dispersive effects whether solving the full navier stokes euler or long wave boussinesq type equations classes 2 4 performed much better on a variety of error metrics than non dispersive hydrostatic models class 1 the latter include standard tsunami models based on the nonlinear shallow water equations widely applied to coseismic tsunamis hydrostatic models fail by a large margin to reproduce benchmark data in most cases particularly when significant dispersive effects are present on this basis whenever possible it is recommended using a dispersive model for landslide tsunami modeling if dispersion effects matter for tsunami processes occurring in a particular application the physics included in the model will accurately simulate these effects in contrast if dispersion does not matter in the application likewise no strong dispersive effects will occur in results of a dispersive model which will nevertheless be accurate since non dispersive problems can also be solved in dispersive models more detailed recommendations and guidance have been prepared for nthmp modelers and can be found in nthmp guidelines established on the basis of the workshop see https nws weather gov nthmp mapping subcommittee html several workshop participants have provided separate documentation of model performance for a partial or complete set of the workshop benchmarks in journal publications or technical reports zhang et al 2017 provide results or the full set of seven benchmarks using various configurations of nhwave while macías et al 2021a and macías et al 2021b have provided documentation for benchmarks 1 6 credit authorship contribution statement james t kirby conception and design of study analysis and or interpretation of data writing original draft stephan t grilli conception and design of study analysis and or interpretation of data writing original draft juan horrillo conception and design of study acquisition of data writing review editing philip l f liu conception and design of study writing review editing dmitry nicolsky conception and design of study acquisition of data writing original draft stephane abadie acquisition of data writing review editing behzad ataie ashtiani acquisition of data writing review editing manuel j castro acquisition of data writing review editing lucie clous acquisition of data writing review editing cipriano escalante acquisition of data writing review editing isaac fine acquisition of data writing review editing josé manuel gonzález vida acquisition of data writing review editing finn løvholt acquisition of data writing review editing patrick lynett acquisition of data writing review editing gangfeng ma acquisition of data writing review editing jorge macías acquisition of data writing review editing sergio ortega acquisition of data writing review editing fengyan shi acquisition of data writing review editing saeedeh yavari ramshe acquisition of data writing review editing cheng zhang acquisition of data writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the benchmark workshop and development of documentation and nthmp modeling guidelines was supported by noaa usa grants na15 nws4670029 na16 nws4670034 and na17 nws4670010 to the university of delaware and na18 nws4670073 to nesec usa kirby grilli ma shi and zhang were supported by national science foundation usa grants cmmi 1537568 1537232 and 1537100 to the universities of rhode island and delaware and to old dominion university plf liu would like to acknowledge the support through a grant to national university of singapore from the national research foundation nrf2018nrf nsfc003es 002 and the yushan scholar program award from the ministry of education in taiwan pat lynett acknowledges support from the california geological survey and the national science foundation usa cmmi 1661052 macías escalante castro gonzález vida and ortega acknowledge the support of the spanish government feder project megaflow grant rti2018 096064 b c21 abadie and clous acknowledge the support of the anr france project ravex grant anr 16 ce03 0002 all model results presented in this study may be obtained from http www1 udel edu kirby landslide reporting html approval of the version of the manuscript to be published the names of all authors must be listed j t kirby s t grilli j horillo p l f liu d nicolsky s abadie b ataie ashtiani m j castro l clous c escalante i fine j m gonzalez vida f lovholt p lynett g ma j macias s ortega f shi s yavari ramshe c zhang appendix a the continuous wavelet transform cwt to illustrate the ideas behind the cwt consider sampling some function f t using a window w t τ where the lag τ centers the observing window on the time axis the resulting sample is a function both of time and the location of the sample window a 1 g t τ f t w t τ this operation provides localization in time for the sample this function may then be fourier transformed to obtain a 2 g ˆ ω τ 1 2 π g t τ e i ω t d t 1 2 π f t w t τ e i ω t d t the resulting transform g ˆ then provides information about the signal that is localized in frequency as well as time consider the typical case of sampling the signal with a unit amplitude window of length t or a 3 w t τ 0 t τ t 2 1 t τ t 2 this leads to the result a 4 g ˆ t ω τ 1 2 π τ t 2 τ t 2 f t e i ω t d t the usual windowed fourier transform for relatively small t s this process may be thought of as a means of localizing transform information in time but the general result has some undesirable properties first frequency resolution δ ω is controlled by the sample length t and the only means for improving frequency resolution is to increase t and thus lose temporal localization the converse is true and the result is that the product t δ ω is a constant with t and δ ω individually constant over the entire transform space ω τ the constancy of the product is a consequence of a result analogous to the heisenberg uncertainty principle limiting the combined uncertainty of knowledge of a particle s position and speed in quantum mechanics this result cannot be circumvented in a given sampling procedure however steps can be taken to adaptively change frequency or temporal resolution in a manner that sacrifices frequency resolution at high frequencies where the signal varies rapidly in order to obtain better time localization or to sacrifice time localization in slowly varying portions of the signal in order to improve frequency discrimination the cwt is a popular tool for carrying this out the cwt is usually defined as a function of lag τ and a scale a where a may be roughly thought of as being the inverse of a frequency we define the transform here as a 5 t τ a 1 a w t τ a d t where w t τ a is referred to as the analyzing wavelet and varies in duration as a function of the scale a being analyzed a relation between scale and frequency may be established by examining the fourier transform pair f ˆ ω f f t 1 2 π f t e i ω t d t a 6 f t f 1 f ˆ ω f ˆ ω e i ω t the transform of f t a then works out directly to a 7 f f t a a f ˆ ω a so that compressing time by a factor a amounts to multiplying frequency by that factor here we use a common choice for the analyzing wavelet given by the morlet wavelet a 8 w t a e i t a t a 2 2 e i ω 0 t ω 0 t 2 2 where ω 0 1 a is a chosen reference frequency which essentially determines the number of oscillations occurring within the wavelet s gaussian envelope the fourier transform of w t a is then given to a very good approximation by a 9 w ˆ ω a e ω a ω 0 2 the transform is usually computed conveniently in fourier space rather than calculating the convolution integral in the time domain an overview of the basic computational approach may be found in torrence and campo 1998 appendix b informational plots for benchmark 7 background see figs b 1 b 3 
23860,the mapping and modeling subcommittee of the us national tsunami hazard mitigation program convened a workshop in january 2017 to evaluate the present state of numerical models for the simulation of tsunamis generated by submarine or subaerial landslides a range of benchmark tests were provided to participants with three tests emphasized i a laboratory submarine solid slide in a 2d horizontal tank ii a laboratory submarine granular slide in a 1d flume and iii a field case based on submarine slides which occurred in port valdez ak during the 1964 alaska earthquake nine landslide tsunami models configured with 21 different combinations of physical options were benchmarked including 1 hydrostatic models with no frequency dispersion which include the nonlinear shallow equation models traditionally used for modeling coseismic tsunamis 2 boussinesq or one layer weakly dispersive models 3 multi layer or non hydrostatic i e dispersive models and 4 full navier stokes models model data comparison indicates that the inclusion of frequency dispersion in model formulations is critical to obtaining physically reasonable results for the test cases considered because the importance of dispersive effects is unknown a priori for any given simulated event the central recommendation from this work is that a model with at minimum a leading order representation of frequency dispersion effects be used whenever possible for landslide tsunami simulations keywords tsunamis landslide tsunamis tsunami benchmarks landslide tsunami models 1 introduction in the past two decades the united states us national tsunami hazard mitigation program nthmp https nws weather gov nthmp has supported tsunami inundation mapping work involving model simulations from all relevant extreme tsunami sources along all the coastal regions of the us and its territories while coseismic tsunamis generated by large earthquakes still represent the largest and most significant source of tsunami coastal hazard for most areas in the us particularly those bordering the pacific ocean basin e g wilson and torum 1972 ichinose et al 2007 atlantic and gulf of mexico tsunami hazard assessment group 2008 tsunamis generated by subaerial or submarine mass failures referred to collectively here as smfs signifying submarine or subaerial mass failures represent another significant source of hazard for various segments of the us coastline this has been shown in particular for the gulf of mexico chaytor et al 2016 horrillo et al 2013 alaska e g coulter and migliaccio 1966 fine et al 1998 fritz et al 2001 2009 weiss et al 2009 nicolsky et al 2013 kirby et al 2016 hawaii e g day et al 2005 puerto rico lópez venegas et al 2008 2015 the west coast california oregon and washington states e g greene et al 2005 greene and ward 2003 and a large part of the us east coast usec where many paleo landslide scars and deposits have been identified on the continental shelf and margin with the 160 km 3 currituck slide complex off the coast of north carolina being the most prominent one e g atlantic and gulf of mexico tsunami hazard assessment group 2008 geist et al 2009 ten brink et al 2014 grilli et al 2015 for the usec the most devastating tsunami in recent history was caused in 1929 by an smf involving a 560 km 3 slump and subsequent debris flow triggered in the grand banks by a m7 2 earthquake e g fine et al 2005 løvholt et al 2019 schulten et al 2019 besides the risk posed by near field smfs e g geist et al 2009 grilli et al 2015 2017 schambach et al 2019 the usec faces potential hazard from tsunamis caused by far field landslides such as volcanic flank collapses in the canary islands e g ward and day 2001 løvholt et al 2008 abadie et al 2012 tehranirad et al 2015 there is also evidence that mega tsunamis were triggered in the distant past in the cape verde islands ramalho et al 2015 that may have affected the usec volcanic flank collapse which may affect all young or active volcanic islands is also a large source of potential hazard for hawaii e g mcmurtry et al 2004 day et al 2005 tsunamis triggered by smfs have occurred all over the world often with devastating consequences in the seismically active mediterranean basin the 1908 messina tsunami caused by a m7 5 earthquake was in part coseismic but recent work shows that the earthquake triggered a 2 km 3 smf on the flanks of mount etna that caused the largest runups up to 12 m and destruction in sicily schambach et al 2020 the combined 80 000 fatalities from the earthquake and tsunami make messina 1908 the worst natural hazard disaster in modern history in the region more recently the 1998 papua new guinea tsunami which was mainly generated by a deep 6 8 km 3 slump triggered by a m7 2 earthquake inundated the sissano spit to depths of over 10 m causing 2000 fatalities e g tappin et al 2008 heidarzadeh and satake 2015 the 2018 lateral collapse of the anak krakatau volcano following a long eruptive period despite being of moderate volume 0 22 0 27 km 3 generated 40 m tsunami waves in the near field that upon reaching the coast of java caused up to 12 m runup and over 450 fatalities e g grilli et al 2021 and references therein the m7 5 2018 palu earthquake triggered numerous small coastal smfs 0 4 7 10 3 km 3 that generated large waves which combined with the coseismic tsunami caused extensive destruction along palu bay combined together the earthquake and tsunami were responsible for 4300 fatalities e g 60 finally during the 2011 tohoku tsunami while the tsunami triggered by the m9 earthquake caused the major destruction an additional source is needed to explain the 40 m runup that struck the sanriku coast and some have proposed that a landslide tsunami was generated by a large and deep smf triggered by the earthquake near the japan trench tappin et al 2014 subaerial landslide tsunamis including volcano flank collapses represents the most slide events these includes also the most fatal landslide tsunami event to date the 1792 mount unzen tsunami sassa et al 2016 there have been about ten significant high run up subaerial landslides events that has taken place within the last decade such as for instance the 2007 aysen fjord landslides sepúlveda and serey 2009 2014 lake askja gylfadóttir et al 2017 the 2015 taan fjord tsunami higman et al 2018 and the 2017 karrat fjord tsunami paris et al 2019 svennevig et al 2020 further examples can be found in harbitz et al 2014 as evidenced by past historical events smf tsunamis whether triggered by an earthquake or not can be very devastating and if they are sourced in the near field such as on a continental shelf break their travel time to shore may be short hence if they reach shore undetected or with little warning their effects can be made even worse by the lack of time for evacuation various works have shown that independent of the triggering mechanism grilli et al 2009 the size of landslide tsunami waves is primarily a function of smf volume initial acceleration controlled mainly by bottom slope and submergence depth e g heinrich 1992 harbitz et al 1993 grilli and watts 1999 grilli et al 2002 grilli and watts 2005 watts et al 2005 yavari ramshe and ataie ashtiani 2016 snelling et al 2020 to an extent landslide tsunami waves are also a function of the smf rheology kim et al 2019 løvholt et al 2020 under certain circumstances such as when sequential slope failure rates are slow the material properties have a key control on the tsunamigenic strength løvholt et al 2017 field studies have shown that smfs can range from fairly rigid slumps or rotational failures e g tappin et al 2008 løvholt et al 2019 schambach et al 2019 2020 to debris flows behaving similarly to dense fluids e g grilli et al 2019 with a great variety of rheologies in between e g abadie et al 2010 mohammed and fritz 2012 grilli et al 2017 si et al 2018a b kim et al 2019 snelling et al 2020 additionally the wavelength l of landslide tsunamis scales with about twice the landslide horizontal dimension in its direction of motion watts et al 2005 and hence can be much shorter than the typically very long wavelength waves occurring in coseismic tsunamis with correspondingly shorter wave periods for area to volume landslide scaling relationships see urgeles and camerlenghi 2013 for this reason landslide tsunamis are often more significantly affected by frequency dispersion effects than are coseismic tsunami waves e g grilli and watts 1999 grilli et al 2002 watts et al 2003 grilli and watts 2005 watts et al 2005 ma et al 2012 glimsdal et al 2013 løvholt et al 2015 schambach et al 2019 in the early development and benchmarking of landslide tsunami models most investigators concentrated on modeling solid block landslides e g heinrich 1992 harbitz et al 1993 grilli and watts 1999 2005 grilli et al 2002 lynett and liu 2002 watts et al 2003 2005 liu et al 2005 using their own or other laboratory experiments for benchmarking e g enet and grilli 2007 ataie ashtiani and najafi jilani 2008 in parallel studies of tsunami generation by deformable slides were carried out either using depth integrated two layer model equations e g jiang and leblond 1992 1993 1994 fine et al 1998 or by solving 2d or 3d navier stokes equations e g assier rzadkiewicz et al 1997 these two approaches have led to a newer generation of models used more recently for simulating tsunami generation by deforming slides represented by a dense fluid or a granular material some of which will be detailed or applied and benchmarked later in this paper e g ataie ashtiani and shobeyri 2008 weiss et al 2009 abadie et al 2010 horrillo et al 2013 kirby et al 2016 george and iverson 2011 2014 ma et al 2013 2015 macías et al 2015 gonzález vida et al 2019 løvholt et al 2017 2019 kim et al 2019 zengaffinen et al 2020 zhang et al 2021a b macías et al 2021b for a comprehensive review of landslide tsunami modeling work through 2016 see yavari ramshe and ataie ashtiani 2016 as a result of the significant hazard posed by landslide tsunamis for many coastal areas of the us and its territories and to support the use of numerical models for simulating coastal tsunami hazard and inundation caused by landslide tsunamis the mapping and modeling subcommittee mms of nthmp convened a workshop in january 2017 at texas a m university galveston texas with the goals of evaluating the state of numerical models for the simulation of tsunamis generated by smf s and of drawing recommendations for best practice in model selection and modeling of these events earlier similar numerical model benchmarking workshops had been organized by nthmp mms in 2011 regarding tsunami runup and inundation horrillo et al 2014 and in 2015 regarding the prediction of tsunami induced coastal currents lynett et al 2017 nthmp modelers from different areas of the us as well as international experts were invited to attend seven benchmark tests were proposed based on earlier published work whose data and information were provided to participants ahead of the workshop three tests were emphasized that will be detailed in this paper benchmark 2 a laboratory submarine solid slide in a 2d horizontal tank enet and grilli 2007 benchmark 4 a laboratory submarine granular slide in a 1d flume grilli et al 2017 and benchmark 7 a field case based on submarine slides which occurred in port valdez alaska during the 1964 alaska earthquake nicolsky et al 2013 during the workshop nine landslide tsunami models with 21 different configurations were submitted for benchmarking and their results presented and discussed by the participants who are all co authors of this paper models were grouped into four categories based on their treatment of hydrodynamics and further into four categories based on their treatment of slide rheology as described below in section 3 the workshop is documented online at http www udel edu kirby landslide where the reader may find the final technical report along with write ups of guest presentations model descriptions descriptions of the seven benchmark tests the provided test data formatted model results for submitted models and programs used to conduct the quantitative tests described here in section 4 links to the workshop documentation may also be found at https nws weather gov nthmp 2017mmslandslide index html in this paper we present and discuss results of the three main benchmark tests and lessons learned for modeling best practice for landslide tsunamis the paper is organized as follows in section 2 we detail the three benchmark tests considered section 3 summarizes the models that were used in the benchmarking section 4 describes the methodology used to compare model results to benchmark data and to each other results of the model inter comparisons as well as comparison with benchmark data are given in section 5 section 6 provides conclusions and a discussion of resulting best practice guidance 2 benchmark tests participants in the workshop were provided with descriptions and observational results for seven slide configurations including three laboratory tests with solid slides grilli and watts 2005 enet and grilli 2007 liu et al 2005 three laboratory tests using granular slides grilli et al 2017 viroulet et al 2014 mohammed and fritz 2012 and a field case based on slides in port valdez ak during the 1964 alaska earthquake nicolsky et al 2013 full descriptions of the benchmarks and associated data sets are available at http www udel edu kirby landslide problems participants were asked to provide as a minimum results for benchmarks 2 4 and 7 which are described concisely below 2 1 benchmark 2 three dimensional rigid submarine slide 2 1 1 experimental set up and parameters this benchmark problem is based on the 3d laboratory experiments of enet and grilli 2007 documentation and data sets provided to workshop participants are available at http www udel edu kirby landslide problems benchmark 2 html the experiments were performed in the university of rhode island uri wave tank of width 3 6 m and length 30 m with a still water depth of 1 5 m over the flat bottom portion the model slide slid down a plane slope built in the tank with an angle θ 1 5 a definition sketch is provided in fig 1 as well as pictures of the experimental set up and an example of surface wave generation the submarine slide model was built as a streamlined gaussian shaped aluminum body with elliptical footprint with down slope length b 0 395 m cross slope width w 0 680 m and maximum thickness t 0 082 m fig 1b the slide shape is defined by 1 ζ ξ χ t 1 ε max 0 sech k b ξ sech k w χ ε where k b 2 b cosh 1 1 ε k w 2 w cosh 1 1 ε and where ξ χ are the local down slope and span wise coordinates with origin at the slide center the slide volume is given by 2 v b b w t i 2 c 2 i 1 i 2 ε 1 ε with i 1 i 2 0 c f g d μ f μ sech μ tan 1 sinh g g μ cosh 1 sech μ ε c cosh 1 1 ε the volume of the fabricated slide was measured to be v b 7 72 1 0 3 m 3 which using the above equations and slide geometry data yields ε 0 717 for which the coefficient of v b in eq 2 is 0 3508 the slide was released at time t 0 from a series of 7 initial submergence depths d fig 1 table 1 during its motion the slide was guided by a rail located on the slope tank axis using low friction wheels and slid a short distance 4 mm above the plane slope for each submergence depth d the slide initial abscissa x i and the abscissa of the slide point of maximum thickness x g are defined and related by 3 x g x i t sin θ d tan θ t sin θ with t t 0 004 m the measured slide mass was m b ρ b v b 16 00 kg and its bulk density based on measured volume was ρ b 2 073 kg m 3 measured data during each experiment included slide kinematics obtained from a composite of the slide acceleration measured using a micro accelerometer embedded within the slide as well as the time of passage of the slide through three electromechanical gates see enet and grilli 2007 for details surface elevation at up to four capacitance wave gauges g 1 to g 4 fig 2 wave runup r i e maximum vertical elevation on the slope at the tank axis y 0 wave gauge g 1 was located at x x 0 y 0 for each test the coordinates of gauges g 2 g 4 remained fixed for all tests and are given in table 2 the measured slide kinematics were found to have a good match with the theoretical law of motion for solid slides grilli and watts 1999 2005 given by 4 s s 0 ln cosh t t 0 with 5 t 0 u t a 0 s 0 u t 2 a 0 being the characteristic time and distance of motion respectively defined as a function of the terminal slide velocity u t and the slide initial acceleration a 0 which are given in turn by 6 u t g d b sin θ d 1 tan ψ tan θ γ 1 c d 2 f 2 ε f ε 7 a 0 g sin θ 1 tan ψ tan θ γ 1 γ c m where g is gravitational acceleration γ ρ b ρ w is the slide specific gravity c m is the slide added mass coefficient c d the slide drag coefficient and c n tan ψ the slide basal coulomb friction based on eq 4 for ε 0 717 we find c 0 8616 and f 0 8952 in each experiment the hydrodynamic coefficients c m and c d were calculated as least square fits by applying eqs 4 5 and 6 to the measured slide kinematics expressed as a composite of center of mass acceleration and time of passage at the known position of the 3 electromechanical gates see enet and grilli 2007 for details results are given in table 1 experiments were performed for 7 initial submergence depths d listed in table 1 together with values of related slide parameters and measured tsunami waves characteristics table 1 lists for each case the measured characteristic tsunami amplitude η 0 defined as the maximum depression at gauge g1 and maximum runup on the tank axis r these small runup values were measured using a digital camera directly viewing the waterline motion over a graduated scale 2 1 2 data provided and benchmark problem seven data files were provided to participants which contain for each of the 7 initial submergence depths d 61 80 100 120 140 149 189 mm the time series of surface elevation measured at up to 4 gages identified as g 1 g 2 g 3 and g 4 in mm in each file results are provided for each of two experimental replicates or runs marked as r1 or r2 done for the same initial slide parameters and for their average marked as ave in some of the tests data was missing for one of the runs and or for one of the gages in the latter case this is identified in the name tag given each file for instance d61g1234 txt or xls indicates that these are results for depth d 61 mm and gages g 1 g 2 g 3 and g 4 finally data files are all provided as tab delimited text files with one line of title to skip and excel spreadsheets fig 3 shows plots of observed surface displacements in blue at each gauge for the initial submergence depths of d 61 and 120 mm results from the non hydrostatic model nhwave ma et al 2012 benchmarked below configured with a specified bottom motion are shown as red lines for comparison to help modelers specify the slide motion for each experimental case data files kinematics txt or kinematics xls are provided which contain the average kinematics t s t recalculated for each average experiment using eqs 4 5 and the values of s 0 and t 0 listed in table 1 calculated using eq 6 and the other data in the table the benchmark problem consisted of using the above information on slide shape density submergence and kinematics table 1 together with reproducing the experimental set up to simulate surface elevations measured at the 4 wave gages average of 2 replicates of experiments as e g shown in fig 3 and present similar comparisons of model with experimental results participants were requested to provide as a minimum results for the two cases illustrated in fig 3 2 2 benchmark 4 two dimensional submarine granular slide 2 2 1 experimental set up and parameters this benchmark problem is based on 2d laboratory experiments of tsunami generation by a submarine slide made of glass beads performed in 2015 by kimmoun and dupont in the école centrale de marseille irphe precision tank grilli et al 2017 give the main features of the experiments and http www udel edu kirby landslide problems benchmark 4 html gives the complete description of the benchmark provided to the workshop participants these experiments were performed for a series of triangular submarine cavities filled with glass beads which upon release by lowering a sluice gate moved down a planar slope figs 4 and 5 provide pictures and sketches of experimental setup and execution fifty eight experiments numbered 13 to 72 in file tests landslide info xlsx available on the website were performed each with one replicate for the same parameters the tank had a width of w 0 25 m and useful length l 6 27 m and was filled with fresh water density ρ w 1000 kg m 3 to depth h 0 320 to 0 370 m fig 4 the glass beads had a density ρ b 2500 kg m 3 diameter d b 4 or 10 mm and a total dry weight w b 1 5 to 2 5 kg upon release by lifting a sluice gate beads were moving down a slope θ 3 5 causing wave generation on the surface fig 5 in 20 of the experiments a layer of glass beads was glued to the slope the starting time of experiments t 0 is defined when the gate has just withdrawn into its cavity fig 4 during experiments the deforming slide shape was recorded through the transparent side of the tank with a high speed video camera 1000 frames per second see file benchmark4 test17 video mp4 and time series of surface elevations were measured at 4 wave gages wg1 wg4 fig 4 fig 5 shows snapshots extracted from the video of test 17 which has parameters h 0 330 m d b 4 mm w b 2 kg and no beads glued on the slope up to t 0 60 sec the snapshots show that due to slide motion onshore moving waves are generated that cause runup on the slope with at the same time offshore moving waves that eventually reflect on the far end of the tank and propagate back towards the generation area this behavior is also clearly observed in time series measured at wave gages wg1 wg4 fig 6 a detailed analysis of experimental results shows that experiments were highly repeatable with almost unnoticeable differences between surface elevations for 2 replicates grilli et al 2017 simulated experiments for test 17 corresponding to the case illustrated in fig 5 with both the heavy newtonian fluid nhwave model of kirby et al 2016 and the granular slide nhwave model of ma et al 2015 fig 6 shows the comparison of free surface elevations simulated with the dense fluid model in which an average slide density ρ s 1951 kg m 3 was used together with a viscosity μ s 0 01 kg m s and a manning friction coefficient n 0 005 specifying friction between the slide and underlying slope the agreement observed in fig 6 between simulations and experiments is quite good note this parameterization of the average slide density and friction parameters is not unique and only provided here as an example modelers of this benchmark were free to select the parameters they felt were most appropriate to use for their model the fluid averaged density was obtained from a weighed average within the triangular cavity of the glass beads and interstitial water density assuming a random packing this also led to estimating the initial submergence depth for this case not measured to d 0 0422 m the selected value of viscosity was based on earlier work by mendoza and santamaria holek 2009 estimating viscosity for newtonian granular flows finally once the viscosity selected the manning n coefficient value was calibrated for the deforming slide to reach the slide bottom in simulations at the same time as in experiments 2 2 2 data provided and benchmark problem the benchmark here consists in using the above information to simulate as a minimum the glass bead experiment of test 17 and compare the computed surface elevations to those measured at the 4 wave gauges wg1 wg4 as in fig 6 the measured surface elevations for this test are provided in files benchmark4 test17 txt or benchmark4 test17 csv and the corresponding high speed video is given in file benchmark4 test17 video mp4 the data is given in format t s η 1 cm η 2 cm η 3 cm η 4 cm the entire set of experimental results for the 58 experiments is provided on the workshop website with parameters for each test given in file benchmark4 tests landslide info xlsx and the surface elevations measured for each test given in file benchmark4 gages zip together with a matlab code to extract and plot the data for each test case this code also calculates the various dimensions of the slide itself plus necessary parameters for computations 2 3 benchmark 7 slide at port valdez ak during 1964 alaska earthquake this benchmark problem is based on the historical event which occurred at port valdez ak during the alaska earthquake of march 27 1964 coulter and migliaccio 1966 plafker et al 1969 wilson and torum 1972 sketches showing the general area aerial photos before and after the event the inferred motion of a vessel which broke free of its moorings and observed runup and debris lines are provided for the region of old valdez in appendix b figs b 1 b 3 the event has recently been studied by nicolsky et al 2013 and parsons et al 2014 the first document provides an overview of the historical background and geology for the site and is the principal source for the problem described below the description of the benchmark provided to participants may be found at http www udel edu kirby landslide problems benchmark 7 html 2 3 1 landslide at the head of valdez bay the largest destruction in valdez bay during the m w 9 2 alaska earthquake happened in the dock and harbor area where a massive submarine landslide generated a tsunami inundating the waterfront up to two blocks inland and causing up to 52 m runup in port valdez the pre and post earthquake bathymetry profiles near the site are shown in coulter and migliaccio 1966 to the south of valdez depth changes exceeding 90 m occurred which exceeds the depth change off valdez itself thus the major part of the slide took place off the lowe river delta it is estimated that approximately 75 1 0 6 m 3 of unconsolidated deposits were transferred from the waterfront into the bay coulter and migliaccio 1966 the sequence of tsunami waves following the landslide was reconstructed from eyewitness reports and observations hence there are inherent uncertainties in the resulting estimates of wave time arrivals and wave heights the following account of the earthquake is taken from wilson and torum 1972 unless otherwise noted on the evening on march 27 1964 the 10 815 ton m v chena was unloading freight at the valdez dock position a in fig b 2 the ship initially went astern position b with the water withdrawal that accompanied the initial subsidence of the docks and then the chena heeled to port and rose by 6 9 m on an incoming wave and bottomed at the previous location of the docks position c she then came upright took another roll to the port and was carried to the small boat harbor positions d e the chena was momentarily aground with her stern in the wreckage of pilings consequently the chena took a violent roll to the starboard before the boat harbor began to fill with water pouring from the shore a flux of water from the south filled the boat harbor and carried boats and buildings dislodged by the first wave towards the valdez hotel it also lifted the chena and enabled her to float free positions e f the water began to drain from the boat harbor and the ship came under the influence of a strong southerly current which carried her close alongshore as in a jet stream position f as the chena was moving south water was seen cascading over the slide scarp the extent of inundation by waves which lifted the chena is hard to constrain based on objective measurements some eyewitnesses drove up alaska avenue fig b 3 to the corner of mckinley street in an attempt to reach higher ground but a large volume of water flowing down the avenue made it impossible to proceed further they turned right and went to the vicinity of the standard oil company plant and then turned up broadway avenue and proceeded on foot in 0 45 m deep water another eyewitness reported that a wave washed onto mckinley street on the northeast side of town within 5 min after the first shock and reached two blocks inland it is thus reasonable to assume that at least two waves flooded the valdez waterfront and destroyed what was left within two blocks of shore the runup reached beyond mckinley street or about 300 m from the pre earthquake shoreline at several points the second wave crossed the waterfront 10 15 min after the first wave carrying a large amount of the debris it has been described as a violent surging wave only slightly smaller than the first water from the second wave reached a depth of 0 46 m in the valdez hotel on mckinley street wilson and torum 1972 the location of the hotel is shown in fig b 3 by the red triangle it is believed that the second wave which flooded the waterfront originated at the other side of the port valdez near the shoup bay moraine 2 3 2 landslide at shoup bay moraine there were no eyewitnesses to waves that struck the shore at other locations along port valdez however the inundation line was evident from scattered debris and marks on fresh snow fig 7 shows the observed runup around port valdez the highest location obliterated by waves was near the large abandoned cliff mine according to plafker et al 1969 the waves deposited driftwood at points 52 m 170 ft above sea level and splashed silt and sand up to an elevation of 67 m 220 ft directly across from the cliff mine in anderson bay at the south shore of port valdez the waves ran up to 24 m 78 ft above the water level and destroyed a small fishing camp all structures of the camp were swept away leaving only the driven piling foundations its sole inhabitant harry henderson was missing and presumably drowned in the violent local waves that struck anderson bay the abandoned dayville cannery at jackson point 8 km 5 mi east of anderson bay was also extensively damaged by waves that reached as high as 9 5 m 31 ft elsewhere along the shore violent waves broke spruce trees with a diameter of 0 6 m 2 ft at elevations as high as 31 m 101 ft and deposited barnacle covered boulders estimated to weigh 760 kg 1700 lb at points 27 m 88 ft above the shoreline the waves that moved westward from port valdez overtopped and destroyed the valdez narrows navigation light shown in fig 7 by the red triangle situated on top of a reinforced concrete pedestal 11 m 36 ft above the lower low water level 2 3 3 data provided and benchmark problem the post earthquake bathymetry together with the slide thicknesses shown in fig 8 were provided as a single file benchmark 7 data zip this archive also contains shape files delineating the extent of the observed inundation at the head of port valdez and locations of the debris from the first wave the matlab script readdata m reads all available data and plots contours of the slide thicknesses fig 8a b as well as the extent of inundation near the head of port valdez fig 8c the benchmark problem here consisted of simulating the extent of inundation for two slide events at the head of valdez bay and at the shoup bay moraine based on before and after bathymetry data eye witness observations of the event and observed runup distribution for the slide at the head of port valdez hpv64 it was recommended to 1 reproduce two waves that struck the valdez waterfront 2 simulate the extent of inundation reaching at least to mckinley street for the slide at the shoup bay moraine sbm64 it was recommended to 1 simulate the extent of inundation around port valdez and reproduce the 20 m runup at anderson bay 2 simulate the 10 m wave inundating the navigation light shown in fig 7 by the red triangle in valdez narrows 3 simulate the 0 5 m wave in the valdez hotel shown in fig 8 by the red triangle located in the head of port valdez 3 models used in the benchmarking exercise a total of 9 models were benchmarked as part of the 2017 workshop individual documentation for each of the models used is provided at http www1 udel edu kirby landslide models html several of the models could be configured in a variety of ways leading to a total of 21 model configurations listed in table 3 for the purposes of comparison the models were grouped into four hydrodynamic configurations including 1 hydrostatic models with no frequency dispersion with results indicated by circles in figs 11 14 2 boussinesq or one layer weakly dispersive models indicated by 5 pointed stars 3 multi layer or nonhydrostatic models indicated by 6 pointed stars 4 fully 3d navier stokes solvers with surface reconstruction indicated by asterisks additionally modeled slide rheology was grouped into four categories including 1 solid slides usually an imposed bottom deformation in time indicated by red symbols 2 viscous slides indicated by green symbols 3 granular slides indicated by blue symbols 4 3d continuously varying phase or multiphase indicated by black symbols a brief introduction to each hydrodynamic configuration and treatment of slide rheology is provided in the following two sections a more complete introduction to each model references to model descriptions in the primary literature and a description of the range of configurations for each model in the present tests may be found in the individual model write ups posted on the workshop website at http www1 udel edu kirby landslide reporting html 3 1 treatment of hydrodynamics in models 3 1 1 non dispersive models models in the non dispersive category generally solve the nonlinear shallow water equations nlswe in this class of model the pressure field is assumed to be hydrostatic with respect to the local water surface which for constant water density ρ gives 8 p ρ g η z where η is the water surface displacement away from rest and η z represents the distance below the surface as a result of this simplification horizontal pressure gradients are depth uniform and hence horizontal velocities are uniform over depth if the effects of turbulence and bottom drag are neglected models of this type are historically known to be good simulators of runup and inundation but they can accumulate significant errors when used to propagate waves over long distances or over depths which are not small compared to horizontal wavelengths as a result of the lack of dispersive effects kirby et al 2013 schambach et al 2019 nevertheless they have been applied to landslide tsunami modeling e g harbitz et al 1993 fine et al 1998 2005 salmanidou et al 2017 in the linear limit waves in this category have the frequency independent phase speed c 0 g h where h is still water depth as part of the workshop the models 2lcmflow yavari ramshe and ataie ashtiani 2017 alaska gi l citepnicolsky etal pag11 nhwave ma et al 2012 2013 2015 in hydrostatic mode hysea for benchmark 7 macías et al 2015 fbslide and lynett nlsw lynett and liu 2002 belonged to this category see table 3 3 1 2 weakly dispersive boussinesq type models waves on the surface of finite depth water have a phase speed c given by 9 c c 0 tanh k h k h 1 2 where k 2 π l is the wavenumber and l is the corresponding wavelength for most cases of tsunami generation propagation and inundation the dimensionless number k h or essentially the ratio of water depth to wavelength is relatively small the limit of k h 0 recovers the non dispersive model the class of weakly dispersive models including boussinesq serre and greene naghdi models retains additional information about c for finite but small values of k h e g wei et al 1995 lynett and liu 2002 watts et al 2003 lynett 2006 løvholt et al 2008 roeber et al 2010 shi et al 2012 kim et al 2017 this information is usually related to an asymptotic form of the taylor series for the added factor in eq 9 for example 10 tanh k h k h 1 1 3 k h 2 o k h 4 the corresponding corrections to the horizontal water velocity are usually obtained in the form of a power series in z and various models may retain higher order information in powers of k h or may use series manipulation to obtain rational polynomial forms of eq 10 which are more accurate or better behaved for large k h models in the following category of dispersive models may be reduced to this form if lowest order treatments of the model s vertical structure are employed such as restricting the model to a single vertical layer see brocchini 2013 and kirby 2016 for recent reviews of this class of model as part of the workshop the models globous løvholt et al 2008 boussclaw kim et al 2017 and ls3d ataie ashtiani and najafi jilani 2007 belonged to this category see table 3 3 1 3 dispersive models models in this category are essentially solutions of the full hydrodynamic problem under a restrictive set of simplifying assumptions in particular the water surface is assumed to be a single valued function of horizontal position and time this assumption eliminates the potential for directly describing phenomena such as wave crest overturning during breaking however as a result models in this class do not require the elaborate reconstruction of arbitrary surface geometries employed in more complete navier stokes solvers the models also typically employ a reduction of the vertical structure of the problem to a finite number of coupled layers using either low order approximations of the dynamics in each layer stelling and zijlema 2003 bai and cheung 2013 or by using differencing stencils applied to the relatively low resolution vertical structure ma et al 2012 these models are reduced to the level of accuracy of boussinesq models by reducing the number of vertical layers to one yamazaki et al 2011 or they may approach a full solution of the surface wave problem by allowing the number of vertical layers to be as large as needed models for perfect fluid hydrodynamics for surface waves with lengths of k h values appropriate to tsunamis are often adequately described using no more than three vertical layers models which solve the fully nonlinear potential flow problem e g grilli and watts 1999 grilli et al 2002 2010 or reproduce the exact linear dispersion relation for narrow banded waves in slowly varying domains such as the mild slope equations berkhoff 1972 smith and sprinks 1975 are included in this category as part of the workshop the models nhwave and hysea configured as a multi layer non hydrostatic models and lynett mse bellotti et al 2008 belong to this category see table 3 3 1 4 models based on navier stokes solvers models in this final category typically solve the full set of navier stokes equations together with boundary conditions applied at an arbitrary unknown surface e g heinrich 1992 assier rzadkiewicz et al 1997 popinet 2003 liu et al 2005 ataie ashtiani and shobeyri 2008 weiss et al 2009 abadie et al 2010 2012 horrillo et al 2013 accurate reproduction of surface geometry requires a great deal of spatial and temporal resolution in the calculation and hence models of this type typically are expensive to run in terms of time and computer resources as part of the workshop the models tsunami3d horrillo et al 2013 thetis newt and thetis mui clous and abadie 2019 belonged to this category see table 3 3 2 treatment of slide rheology and motion in models 3 2 1 solid slides solid slide motion and geometry are typically specified as a bottom boundary condition either determined a priori or by applying laws of motion developed for translational and rotational solid slide motions e g grilli and watts 1999 grilli et al 2002 lynett and liu 2002 grilli and watts 2005 watts et al 2003 2005 day et al 2005 among the models featured in the workshop globous bousclaw ls3d fbslide and lynett belonged to this class of models with nhwave and hysea having this configuration as an option see table 3 using this approach deforming slides with a specified geometry and deformation can also be specified as a bottom boundary condition lynett and liu 2002 grilli and watts 2005 as is usual for solid slide simulations there is typically no attempt to couple the slide and water motions dynamically with the latter only affecting the slide motion through simple coefficients e g drag and added mass coefficients salmanidou et al 2017 an exception to this lack of coupling is for instance the work of abadie et al 2010 who used the multi material navier stokes model thetis to simulate both deforming and rigid slides with the latter represented by a fluid of very high viscosity with this model they accurately simulated the solid block experiments of liu et al 2005 for both subaerial and submarine cases without specifying the block law of motion which was implicitly found in the model through an internal balance of forces 3 2 2 deforming slides simulated as dense viscous or viscoplastic fluids many early models e g heinrich 1992 harbitz et al 1993 assier rzadkiewicz et al 1997 fine et al 1998 and some recent models e g løvholt et al 2017 grilli et al 2019 have simulated tsunami generation by deformable slides by modeling the bottom layer as a dense viscous fluid newtonian or non newtonian e g see the recent review by yavari ramshe and ataie ashtiani 2016 water motion was either modeled in a single depth integrated upper layer two layer models e g heinrich 1992 harbitz et al 1993 assier rzadkiewicz et al 1997 fine et al 1998 or in multiple layers e g kirby et al 2016 grilli et al 2017 and references therein this motion was coupled to the motion of the bottom layer slide through dynamic and kinematic equations at the slide water interface depending on model type water motion was based on solving various sets of equations with different featured physics from hydrostatic to non hydrostatic dispersive for example the two layer models of kirby et al 2016 in which the upper water layer is modeled with the non hydrostatic σ coordinate 3d model nhwave ma etal om12 or full navier stokes see e g 2d or 3d navier stokes equations to simulate subaerial or submarine slides modeled as dense newtonian or non newtonian fluids by løvholt et al 2017 ataie ashtiani and shobeyri 2008 weiss et al 2009 abadie et al 2010 2012 horrillo et al 2013 among the models featured in the workshop nhwave and alaska g il belonged to this class of models thetis and tsunam3d also modeled slides as a dense viscous fluid layer but within a multi material navier stokes framework see table 3 3 2 3 slides simulated as saturated granular debris flows a number of recent laboratory experiments have examined tsunamis generated by subaerial landslides made of gravel fritz et al 2004 ataie ashtiani and najafi jilani 2008 heller and hager 2010 mohammed and fritz 2012 or glass beads viroulet et al 2014 for deforming underwater landslides and related tsunami generation 2d experiments were performed by assier rzadkiewicz et al 1997 who used sand ataie ashtiani and nik khah 2008 who used granular material and grilli et al 2017 who used glass beads to simulate such experiments models have been developed on the same principle as the dense fluid bottom layer but for a bottom layer representing a granular medium or saturated debris flow e g george and iverson 2011 2014 ma et al 2015 grilli et al 2017 another approach to simulate tsunami generation by granular slide or sediment motion has been to simulate flows induced by a varying sediment concentration e g ma et al 2013 among the models featured in the workshop nhwave hysea and 2lcmflow belonged to this class of model for a more comprehensive review of recent modeling work in these areas see yavari ramshe and ataie ashtiani 2016 3 2 4 slides simulated as multiphase components in fully 3d settings in this implementation models solving the navier stokes equations in reynolds averaged form together with complete or single valued representations of water surface geometry are typically solved for multiple fluids mediums one of which is a deforming slide and the other water and air an example is the multi material model thetis by abadie et al 2010 which was used to simulate deforming slides in a laboratory set up or in the field abadie et al 2012 other examples of this approach are described by ma et al 2013 horrillo et al 2013 and lópez venegas et al 2015 to this end more sophisticated landslide dynamics models are presently being incorporated into full 3d models for landslide tsunamis through multi phase coupled porous granular rheology si et al 2018a b rauter 2021 among the models featured in the workshop thetis tsunami3d and one variant of nhwave belonged to this class of model 4 analysis approach this section details the different metrics used in the model data comparison for each benchmark with model data and model model intercomparisons described in the following section 4 1 rms error metrics for time series comparison rms error metrics compare the structure of observation and simulation at each gauge location integrated over time in order to apply these metrics it is necessary to interpolate data and model results onto similar discrete time axes this operation is performed here by interpolating simulation results onto the time axis for observations the comparison is carried out for each case over a time range corresponding to the existence of useful observational data since rms error estimates for oscillatory signals are also highly sensitive to phase mismatches the results obtained here are based on shifting simulation results in time in order to obtain a specific synchronization at one of the gauges in most practical situations tsunami hazard is not affected by small phase differences hence simulating an accurate time series in the model is deemed a success even if there is a small phase shift the first error metric represents the square root of the mean square error between observation and simulation results normalized by the difference between the largest maximum and minimum value of η this metric is denoted by ε g and is given by 11 ε j g i n η m i j η o i j 2 max i η o i j min i η o i j j 1 n g where n g is the number of gauges in each experiment and n is the number of points in the time series a second alternate rms error metric denoted ε k is given by 12 ε j k i n η m i j η o i j 2 i n η o i j 2 j 1 n g where the normalization is with respect to the root mean square of the observations standard deviation if the mean is zero again for each gauge results in section 5 are shown for the first measure eq 11 results based on eq 12 are numerically different but were found to be qualitatively similar in pattern hence they are omitted 4 2 statistics of surface displacements additional metrics were developed to quantify model reproduction of surface elevation maxima surface elevation minima maximum surface wave height and wave packet variance which are important for quantifying various aspects of tsunami hazard maximum surface displacement for a single gauge normalized by observed values 13 ε j 1 max i η m i j max i η o i j j 1 n g minimum surface displacement for a single gauge normalized by observed values 14 ε j 2 min i η m i j min i η o i j j 1 n g total surface excursion for each gauge normalized by the maximum observed surface excursion 15 ε j 3 max i η m i j min i η m i j max i η o i j min i η o i j j 1 n g total variance for each gauge normalized by observed variance for each gauge 16 ε j 4 i 1 n η m i j 2 i 1 n η o i j 2 j 1 n g 4 3 wavelet analysis of transient wave packets tsunami events typically consist of finite length packets of waves with rapidly varying frequency and amplitude an analysis of the distribution of amplitude and frequency in space and time can be revealing of the underlying fluid mechanics governing the propagation of the waves in particular we can examine the effects of frequency dispersion or non hydrostatic behavior on the advancing wave this analysis needs to be carried out using a framework that is appropriate for describing non stationary behavior of the analyzed signal and it is performed here using the continuous wavelet transform cwt see addison 2018 for a recent overview the description of the cwt is well established but may be unfamiliar to some readers and so a description of the basics is provided as appendix a to illustrate the application of the cwt to a tsunami signal we show in fig 9 the modulus of the transform t t f as a function of frequency and time for benchmark 2 d 61 mm data table 1 solid red curves show the locus of times at which the maximum of t occurs at each frequency f the panel for gauge 3 fig 9c shows two additional curves for benchmark 2 gauge 3 g3 in fig 2 is located downslope in the direction of landslide travel a wave with frequency f traveling in this direction from location x 1 to x 3 would traverse this distance in a time interval 17 t 3 t 1 x 1 x 3 d x c h x f where depth h varies in x and where the local speed of propagation c h f depends on h and in the case of dispersive motion frequency f two relevant speeds based on linear wave theory are the phase speed c and the group velocity c g given in terms of wavenumber k 2 π l where l is wavelength by 18 c 2 g k tanh k h c g c 2 1 2 k h sinh 2 k h with g 9 806 m s 2 being gravitational acceleration in the long wave limit k h 0 both c and c g are asymptotic to g h and dependence on frequency is lost in this limit all wave components in a multi component wave train would travel at the same speed this is the non dispersive limit characteristic of either linear or nonlinear shallow water equations in fig 9a the nearly vertical red line represents the location of the initial packet during the drawdown process a reference frequency ω 0 5 see eq a 8 in appendix was used for gauge 3 the red dashed line represents replacing c in eq 17 by group velocity c g while the dotted red line represents replacing c by phase speed c intrinsically we would expect the propagation of the energy content at each frequency to be governed by the group velocity so that the solid red line and dashed red line would coincide several factors keep this from being apparent in this case first the slide is present in the domain during the propagation process and thus phase speed or group velocity are affected by a time varying bottom geometry and are not straightforward to interpret more important however is a processing artifact which reduces the apparent arrival time when the wavelet width is adjusted to improve time localization relaxation of this constraint in favor of improving frequency localization leads to better estimates of arrival time since the estimate at each frequency is less contaminated by neighboring frequencies in the strongly dispersive cases considered this effect is illustrated in fig 10 for time series measured at gauge 3 wg3 in benchmark 4 figs 3 to 6 results for the wavelet transform are shown in the figure for a scaled reference frequency ω 0 5 or 15 the improvement in agreement with linear theory and propagation at the group velocity is apparent since this result is expected and should be intrinsic to all the cases considered here we show all results in section 5 in terms of wavelets with higher temporal resolution we utilize arrival times at each gauge and frequency in model data comparisons in order to assess the accuracy of models to represent propagation at each component frequency 5 model data comparisons in this section we evaluate the performance of all submitted model results for benchmarks 2 and 4 using the methods described in section 4 we then provide a more qualitative analysis of results for benchmark 7 where model results are subject both to the choice of model and the modeler s subjective treatment of information related to the provided input data 5 1 data sources see http www1 udel edu kirby landslide reporting html for data needed to reconstruct the results shown here in particular 1 http www1 udel edu kirby landslide report formatted results zip provides data in a common format files in the unzipped folder are matlab mat files each containing a single data array with dimension n by 5 for benchmarks 2 and 4 the array columns contain time s and surface displacements at gauges 1 4 mm for benchmark 7 the files are in a similar format with columns 2 5 displaying elevations at the navigation light old valdez hotel point 37 and point 38 all in meters m each file name follows the following convention bmx my note mat where x denotes the benchmark number 2 4 or 7 and y denotes the model number as indicated in table 3 possible notes are d061 or d120 for the two depths of submergence in benchmark 2 or case1 for benchmark 4 which indicates the data set test17 and was the only case used here for each case in benchmarks 2 and 4 model number x 0 indicates the observed data reformatted into the same common format time series of observed data do not exist for benchmark 7 finally the folder contains submitted results for several of the models for benchmarks 3 and 5 these results are provided for inspection but are not analyzed or otherwise represented in the final technical report for the workshop or in this paper 2 http www1 udel edu kirby landslide report errors zip provides a table of results for the individual model rms errors with models listed as indicated in table 3 in the file error data mat eq 11 and for the surface elevation errors in the file error heights mat eq 13 16 3 http www1 udel edu kirby landslide report programs zip contains the matlab scripts used to carry out data analysis and model data comparisons these scripts were written by the first author jk except for portions of the script for benchmark 7 provided by the fifth author dn and are in the public domain the readme file in the zipped folder provides a complete table of contents for the scripts used we note that the presentation of results by model number in figs 11 14 does not correspond to the numbering of models in table 3 where the models are not grouped in terms of hydrodynamic or rheological choices data are grouped according to the choice of hydrodynamic formulation in figs 11 14 in order to accentuate the consistency of results within each of the four groups the correspondence to individual models as listed in table 3 is preserved in the filenames for the mat files as indicated above 5 2 rms error metric we first consider the distribution of rms errors for each gauge as given by the error metric ε g defined in eq 11 in order to emphasize consistency between model types we provide results here without regard to the performance of individual models the reader may reconstruct these correspondences if desired by looking up individual error estimates in the files error data mat and stuff mat where the errors are listed with model numbers corresponding to entries in table 3 the metric ε g describes a normalized rms error based on comparison of the modeled and observed time series at each measurement location results of this test are shown in fig 11 where ε g for each model is presented without reference to gauge location and for both benchmarks 2 and 4 the results show a clear tendency towards decreasing error for models with more accurate dispersion properties non dispersive hydrostatic models show a tendency towards a much higher rms error with values up to 2 to 3 times higher than the next most accurate category the weakly dispersive models represented by boussinesq type models models in the last three categories weakly dispersive dispersive and navier stokes are generally consistent with each other with rms error measures of around 0 1 the most accurate simulations were for model 13 which represented a non hydrostatic model run for benchmark 4 with viscous slide rheology in general the dispersive models slightly outperformed the weakly dispersive models which could be expected they also outperform the navier stokes solvers which could be due to limitations in the handling of slide rheology properties in a fluid continuum overall however this figure does not provide a dramatic sorting of the 3 types of models which incorporate some degree of frequency dispersion in the treatment of the surface wave as they all perform reasonably well fig 12 shows the rms error ε g for all gauges in benchmarks 2 and 4 sorted by hydrodynamic model type the most dramatic result here is again the distinction between hydrostatic models and the remaining three categories with the hydrostatic models showing systematically higher error at all gauge locations fig 12 also shows a distinction between boussinesq models panel b and the remaining categories of dispersive models with boussinesq models showing an increasing error with distance away from the source region whereas non hydrostatic and navier stokes models give a fairly constant level of error across all four gauge locations due to the accurate representation of dispersion finally fig 13 separates the rms error ε g for benchmarks 2 with a solid slide and 4 with a granular slide models performed comparably on each benchmark with the hydrostatic models showing the greatest error in either case 5 3 surface displacement error metrics fig 14 shows the surface displacement error metrics defined in eqs 13 16 computed based on all benchmarked model results table 3 for the 4 gauges in benchmarks 2 and 4 fig 14a shows the normalized maximum surface elevations ε j 1 eq 13 and normalized minimum surface elevations ε j 2 eq 14 for j 1 4 hydrostatic models all show large negative minimum value of the error metrics associated with the large surface drawdown occurring over the moving slide in hydrostatic simulations see e g fig 17c for model 14 for a dramatic example of this effect for benchmark 7 almost all cases with a large overprediction of maximum elevation are associated with benchmark 2 gauge 1 where positive surface displacements in the experiment are generally quite small aside from these anomalies the models with some representation of frequency dispersion perform adequately and in a fairly uniform manner with each category outperforming the hydrostatic models fig 14b shows ε j 3 eq 15 which indicates how well total surface excursion is simulated over the entire generated wave packet and ε j 4 eq 16 which indicates how well the packet total variance is predicted strong biases in total excursion and variance for the hydrostatic models result from their tendency to predict an overly deep wave trough occurring above the moving slide mass the remaining model types behave consistently although there is some indication that the navier stokes models are predicting wave packets that are both overly energetic and having too large total surface excursions compared to the non hydrostatic models which outperform both of the other two dispersive model categories on these metrics 5 4 wavelet analysis of model results a brief overview of the results of the wavelet analysis of model results detailed in section 4 2 is provided here with the bulk of results shown in appendices d e and f of kirby et al 2018 the results here contrast the non hydrostatic and hydrostatic versions of nhwave for benchmark 4 with a granular slide layer these appear as models 3 and 16 table 3 respectively in figs 11 and 14a b fig 15 for the non hydrostatic case shows that with a model that reproduces dispersion properties accurately the arrival time of energy at distant gauges on a frequency by frequency basis is correctly predicted fig 15a shows time series of measured and simulated surface elevations at the four gauges wg1 wg4 fig 4 model results are in overall good agreement with the experimental data in figs 15b e the modulus t of the wavelet transform is plotted as a function of frequency f and time t at each gauge for both the experimental data and model results again the agreement is overall quite good in each plot the thick blue or red lines are drawn through the maxima of the transforms for model and data respectively and indicate arrival time for the center of the energy packet at each component frequency or scale in the transform space the red dashed lines indicate a hypothetical arrival time based on initialization at the time indicated in panel a and then being displaced forward in time according to the prediction of linear theory with later arrival times indicating lower phase speeds with increasing frequency the deviation of both measured and modeled wave motions could be taken to indicate the tendency for higher frequency components to behave more like bound harmonic of lower frequency components rather than as free waves indicating the importance of nonlinearity in the problem however as discussed in connection with fig 10 the deviation from linear theory prediction is more likely due to the effect of leakage of information across the frequency axis causing the more energetic lower frequency components to dominate the apparent results at higher frequencies overall the best indicator of proper model performance is a continuing overlap of the blue and red line segments indicating the arrival of the wave packet maximum in contrast fig 16 for the non dispersive case with model 16 shows that energy at all frequencies is moving approximately at the same speed as the lower frequency components which is consistent with the frequency independent phase speed of c g h for all frequencies in this limit the model results here are strongly contaminated by reflection effects leading to the double peak in the transform the lack of any frequency dependence in phase speed is clear however 5 5 benchmark 7 qualitative analysis benchmark 7 differs from benchmarks 2 and 4 in that there is less basis for a quantitative comparison to observations in addition results are subject to choices made by each modeler in setting up the simulation and thus it is possible that different results could be obtained by different modelers using the same model code results were submitted for five models table 3 nhwave model 2 tsunami3d model 8 ls3d model 12 alaska gi l model 14 and landslide hysea model 17 details setup of each model considered may be found in the individual model write ups at http www1 udel edu kirby landslide reporting html we proceed here by showing and discussing the available results for 1 water surface elevation time series at the navigation light valdez hotel p37 and p38 fig 17 models 2 8 12 partial 14 17 table 3 2 maximum surface elevation occurring over the port valdez domain fig 18 models 2 8 14 17 and 3 inundation lines in old valdez fig 19 models 2 8 12 14 17 4 runups at points identified in plafker et al 1969 table 4 models 2 12 where the numbers in parentheses indicate models for which the data in question is available time series of surface elevation in fig 17a d are shown at the navigation light hotel valdez and points 37 and 38 for the results of both slides being superposed if they were provided separately time zero was taken to be the first indication of drawdown above point 37 which is located over the hpv64 slide in front of old valdez fig 8 in the event that results for the two slides were superposed it was assumed that the start times for each separate slide simulation were the same the results show interesting patterns of both agreement and difference at point 37 fig 17c where the initial motion is simply the drawdown associated with the hpv64 slide failure models 2 and 8 which utilize the same viscous slide model show nearly the same results up until about 10 min into the simulation which coincides with the arrival of the sbm64 fig 8 first wave front in contrast the granular slide used in model 17 shows a drawdown at this location which is more organized around the time following initial motion reminiscent of the isolated drawdown at gauge 1 seen in benchmark 2 tests the drawdown predicted by model 8 tsunami3d is more featureless in time and does not show nearly as much higher frequency structure time series for point 38 at the valdez shoreline fig 17d and the valdez hotel fig 7b show the progression of the first wave resulting from the hpv64 slide with the wave arriving at point 38 slightly sooner in model 14 hydrostatic than in models 2 non hydrostatic and 17 hydrostatic arrival times for the first wave at hotel valdez are very consistent and are slightly higher for model 14 than for models 2 and 17 the first arrival at the navigation light results from the sbm64 slide in the western portion of the domain in this case models 14 viscous slide and 17 granular slide give very consistent results for wave height at the navigation light while model 2 has a very different pattern of arriving waves a plot of maximum occurring surface elevation over the entire domain in fig 18 shows a distinct difference between the results for models 2 and 8 which direct the majority of the sbm64 towards the interior of port valdez and models 14 and 17 which show a much more equal bifurcation of wave direction and an improved simulation of the arrival at the navigation light a comparison of predicted maximum runups at observational points listed by plafker et al 1969 with observed results are shown in table 4 and also show the overprediction by model 2 at sites within port valdez the tendency for model 2 to direct the majority of the simulated wave energy to the interior of port valdez led to an over prediction of the extent of tsunami inundation in the area of old valdez shown previously in fig 17 b for hotel valdez and d for point 38 closer to the old valdez waterfront the overly large second wave leads to an overprediction of the extent of inundation around old valdez in comparison to observations and other model results which are more consistent fig 19 the reason for these anomalies has not been further examined 6 discussion and conclusions a landslide tsunami model benchmarking workshop was organized in 2017 on behalf of the us national tsunami hazard mitigation nthmp program see https nws weather gov nthmp 2017mmslandslide index html with the goals to evaluate the state of numerical models for the prediction of tsunamis generated by subaerial or submarine landslides or more generally submarine mass failures smfs and draw recommendations for best practice in model selection and modeling of these events nine landslide tsunami models with 20 different model configurations tested table 3 were submitted for benchmarking which were regrouped into 4 classes representing 1 hydrostatic models with no frequency dispersion 2 boussinesq or one layer weakly dispersive models essentially a two dimensional 2d horizontal framework 3 multi layer or non hydrostatic i e dispersive models three dimensional 3d framework but with a limited discretization in the vertical direction and 4 full 3d navier stokes models seven benchmarks were proposed to the participants 6 based on published laboratory experiments and one being the historical case study of 1964 port valdez alaska but modelers were only requested to simulate benchmarks 2 4 and 7 with 2 and 4 being laboratory experiments for a solid and granular slide respectively and 7 being the port valdez case study results and a comparison of model performance on these 3 benchmarks were presented in this paper results presented here show that overall models that included non hydrostatic i e dispersive effects whether solving the full navier stokes euler or long wave boussinesq type equations classes 2 4 performed much better on a variety of error metrics than non dispersive hydrostatic models class 1 the latter include standard tsunami models based on the nonlinear shallow water equations widely applied to coseismic tsunamis hydrostatic models fail by a large margin to reproduce benchmark data in most cases particularly when significant dispersive effects are present on this basis whenever possible it is recommended using a dispersive model for landslide tsunami modeling if dispersion effects matter for tsunami processes occurring in a particular application the physics included in the model will accurately simulate these effects in contrast if dispersion does not matter in the application likewise no strong dispersive effects will occur in results of a dispersive model which will nevertheless be accurate since non dispersive problems can also be solved in dispersive models more detailed recommendations and guidance have been prepared for nthmp modelers and can be found in nthmp guidelines established on the basis of the workshop see https nws weather gov nthmp mapping subcommittee html several workshop participants have provided separate documentation of model performance for a partial or complete set of the workshop benchmarks in journal publications or technical reports zhang et al 2017 provide results or the full set of seven benchmarks using various configurations of nhwave while macías et al 2021a and macías et al 2021b have provided documentation for benchmarks 1 6 credit authorship contribution statement james t kirby conception and design of study analysis and or interpretation of data writing original draft stephan t grilli conception and design of study analysis and or interpretation of data writing original draft juan horrillo conception and design of study acquisition of data writing review editing philip l f liu conception and design of study writing review editing dmitry nicolsky conception and design of study acquisition of data writing original draft stephane abadie acquisition of data writing review editing behzad ataie ashtiani acquisition of data writing review editing manuel j castro acquisition of data writing review editing lucie clous acquisition of data writing review editing cipriano escalante acquisition of data writing review editing isaac fine acquisition of data writing review editing josé manuel gonzález vida acquisition of data writing review editing finn løvholt acquisition of data writing review editing patrick lynett acquisition of data writing review editing gangfeng ma acquisition of data writing review editing jorge macías acquisition of data writing review editing sergio ortega acquisition of data writing review editing fengyan shi acquisition of data writing review editing saeedeh yavari ramshe acquisition of data writing review editing cheng zhang acquisition of data writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the benchmark workshop and development of documentation and nthmp modeling guidelines was supported by noaa usa grants na15 nws4670029 na16 nws4670034 and na17 nws4670010 to the university of delaware and na18 nws4670073 to nesec usa kirby grilli ma shi and zhang were supported by national science foundation usa grants cmmi 1537568 1537232 and 1537100 to the universities of rhode island and delaware and to old dominion university plf liu would like to acknowledge the support through a grant to national university of singapore from the national research foundation nrf2018nrf nsfc003es 002 and the yushan scholar program award from the ministry of education in taiwan pat lynett acknowledges support from the california geological survey and the national science foundation usa cmmi 1661052 macías escalante castro gonzález vida and ortega acknowledge the support of the spanish government feder project megaflow grant rti2018 096064 b c21 abadie and clous acknowledge the support of the anr france project ravex grant anr 16 ce03 0002 all model results presented in this study may be obtained from http www1 udel edu kirby landslide reporting html approval of the version of the manuscript to be published the names of all authors must be listed j t kirby s t grilli j horillo p l f liu d nicolsky s abadie b ataie ashtiani m j castro l clous c escalante i fine j m gonzalez vida f lovholt p lynett g ma j macias s ortega f shi s yavari ramshe c zhang appendix a the continuous wavelet transform cwt to illustrate the ideas behind the cwt consider sampling some function f t using a window w t τ where the lag τ centers the observing window on the time axis the resulting sample is a function both of time and the location of the sample window a 1 g t τ f t w t τ this operation provides localization in time for the sample this function may then be fourier transformed to obtain a 2 g ˆ ω τ 1 2 π g t τ e i ω t d t 1 2 π f t w t τ e i ω t d t the resulting transform g ˆ then provides information about the signal that is localized in frequency as well as time consider the typical case of sampling the signal with a unit amplitude window of length t or a 3 w t τ 0 t τ t 2 1 t τ t 2 this leads to the result a 4 g ˆ t ω τ 1 2 π τ t 2 τ t 2 f t e i ω t d t the usual windowed fourier transform for relatively small t s this process may be thought of as a means of localizing transform information in time but the general result has some undesirable properties first frequency resolution δ ω is controlled by the sample length t and the only means for improving frequency resolution is to increase t and thus lose temporal localization the converse is true and the result is that the product t δ ω is a constant with t and δ ω individually constant over the entire transform space ω τ the constancy of the product is a consequence of a result analogous to the heisenberg uncertainty principle limiting the combined uncertainty of knowledge of a particle s position and speed in quantum mechanics this result cannot be circumvented in a given sampling procedure however steps can be taken to adaptively change frequency or temporal resolution in a manner that sacrifices frequency resolution at high frequencies where the signal varies rapidly in order to obtain better time localization or to sacrifice time localization in slowly varying portions of the signal in order to improve frequency discrimination the cwt is a popular tool for carrying this out the cwt is usually defined as a function of lag τ and a scale a where a may be roughly thought of as being the inverse of a frequency we define the transform here as a 5 t τ a 1 a w t τ a d t where w t τ a is referred to as the analyzing wavelet and varies in duration as a function of the scale a being analyzed a relation between scale and frequency may be established by examining the fourier transform pair f ˆ ω f f t 1 2 π f t e i ω t d t a 6 f t f 1 f ˆ ω f ˆ ω e i ω t the transform of f t a then works out directly to a 7 f f t a a f ˆ ω a so that compressing time by a factor a amounts to multiplying frequency by that factor here we use a common choice for the analyzing wavelet given by the morlet wavelet a 8 w t a e i t a t a 2 2 e i ω 0 t ω 0 t 2 2 where ω 0 1 a is a chosen reference frequency which essentially determines the number of oscillations occurring within the wavelet s gaussian envelope the fourier transform of w t a is then given to a very good approximation by a 9 w ˆ ω a e ω a ω 0 2 the transform is usually computed conveniently in fourier space rather than calculating the convolution integral in the time domain an overview of the basic computational approach may be found in torrence and campo 1998 appendix b informational plots for benchmark 7 background see figs b 1 b 3 
23861,the rising intensity and recurrence of wave storm events can seriously impact navigation and coastal and offshore structures in the western mediterranean sea therefore the present study is focused on wave storm events in the western mediterranean sea over the last four decades the spatial decadal variations of wave storm events are shown considering variations in the parameters that characterise wave storms such as significant wave height swh wave storm duration and wave storm direction additionally the decadal variation in wave storm intensities is evaluated through the storm power index spi and the total storm wave energy tswe the study is based on a wave hindcast developed using a calibrated swan model the wave storm events are obtained based on the swh time series for 24 325 locations distributed over an unstructured grid covering the entire western mediterranean sea the decadal variation in the number of wave storm events maximum and mean wave storm duration spi and tswe were observed in large parts of the west mediterranean sea during the last four decades however variations in mean swh during these storms are low and do not show a real implication in the decadal changes in the wave storm intensity spi and tswe locations of significant increasing changes in spi and tswe show a dependence on changes in the wave storm duration they may be related to variations in wave storm direction in some areas increases in wave storm duration are mainly responsible for increases in wave storm intensities over the last decade keywords wave storms decadal variations wind waves wave storm durations swan western mediterranean sea availability of data and material the datasets generated during and or analysed during the current study are available from the corresponding author on reasonable request 1 introduction the mediterranean sea has had several studies focused on the impact of global warming and global changes at a regional scale e g satta et al 2017 lionello and scarascia 2018 cramer et al 2018 gonzález alemán et al 2019 mentzafou et al 2019 antronico et al 2020 for that matter it was recently considered a climate change hotspot tuel and eltahir 2020 during the last decade the rate of climate change for several climate parameters became more critical in the mediterranean sea than on a global scale cramer et al 2018 lionello and scarascia 2020 changes such as an increase in sea surface temperatures pastor et al 2018 pisano et al 2020 sakalli 2017 skliris et al 2012 in sea level rise dangendorf et al 2019 taibi and haddad 2019 vousdoukas et al 2017 in occurrence and intensity of storm surges cid et al 2016 and wave storms amarouche et al 2020b jiménez et al 2012 komar and allan 2008 were observed recently several exceptional wave storm events were reported in the mediterranean sea such as storm adrian in 2018 cavaleri et al 2019 csekits and troisi 2018 and storm gloria in 2020 amores et al 2020 de alfonso et al 2021 wave storms often result in considerable changes in coastal areas and are usually associated with severe infrastructure damage marzeddu et al 2020 economic losses and even with the loss of human lives according to sánchez arcilla et al 2011 wave storminess and mean sea level are considered to be the most robust climate indicators for the state of coastal areas knowledge of current and future wave storm patterns is therefore critical for offshore and coastal management and marine activities it is crucial for sustainable economic development and to counteract the risks related to climate change the spatial assessment of the wave and storm regimes allows the location of coastal areas that are experiencing significant changes in wave and storm intensity at present several studies have evaluated the spatial and temporal trends in swh in the mediterranean sea and at a global scale yuchun and leo 2020 de leo et al 2020 young et al 2011 young and ribal 2019 timmermans et al 2020 the impact of waves on coastal zones or offshore infrastructures does not depend only on the stress effect of wave heights or wave energy content but also on its persistence beyond a specific wave height threshold which constitutes the main factor in the characterisation of the intensity of a wave storm dolan and davis 1992 the recent studies on annual trends in wave storm intensity amarouche and akpınar 2021 and swh de leo et al 2020 timmermans et al 2020 yuchun and leo 2020 have shown that some parts of the mediterranean sea have experienced a significant increase in swh spi and tswe however we observed that the areas characterised by an increase in wave storm intensity are more important than those characterised by the rise in maximum swh as shown by de leo et al 2020 potentially the variations in wave storm duration and direction can play an important role in the wave storm intensity trends in some areas of the mediterranean sea the swh is not the only parameter that can define the intensity of a coastal storm and its impacts on the coastal and offshore environments as presented by dolan and davis 1992 wave storm duration and incoming directions are also relevant few studies assessing the long term variation in wave storm events in the western mediterranean sea have been carried out these studies have been carried out only locally and are only based on variations in the dolan and davis 1992 wave storm intensity index mendoza and jiménez 2005 guisado pintado et al 2014 amarouche et al 2020b and in the tswe index amarouche and akpınar 2021 molina et al 2019 furthermore to the extent of our knowledge variations in the parameters that characterise the wave storm events are often not assessed separately the goal of this study is to determine the decadal variation of wave storm events in the western mediterranean sea considering the recent past changes in the recurrence and intensity of wave storm events while analysing the decadal changes in swh during wave storms wave storms duration and wave storms direction with respect to variations in total wave storm energy tswe amarouche and akpınar 2021 arena et al 2015 molina et al 2019 and the variation in storm power index spi adapted by dolan and davis 1992 both averages and maximum values are considered on a decadal scale and student s t test is used to assess the statistical significance of the observed change in decadal storm events according to vera et al 2010 the study of decadal scale climate variation is needed for decision making processes in socio economic sectors several factors that contribute to global and regional changes in climate can be linked at a decadal scale studies of decadal climate variations can incorporate internal natural factors including ocean land atmosphere interactions smith et al 2019 as well as anthropogenic factors murphy et al 2010 smith et al 2019 and volcanic activities national academies of sciences 2016 smith et al 2019 that have an impact on greenhouse gas emissions and aerosols furthermore studies of decadal climate variation are often recommended for the connections to different climate patterns cassou et al 2018 mariotti et al 2015 at both global and regional scales e g the atlantic multidecadal oscillation dijkstra et al 2006 and the pacific decadal oscillation mantua and hare 2002 newman et al 2016 from another perspective decadal climate variations are more predictable smith et al 2019 on the other hand focusing on decadal changes allows a larger range larger sample size of storm events to be considered to perform a parametric statistical test wave storms are usually defined as a sea state during which the swh exceeds a specific threshold value and persists over a considerable period different methods and models have been adopted for wave storm characterisation dolan and davis 1992 fedele and arena 2010 rangel buitrago and anfuso 2011 jiménez et al 2012 mendoza et al 2013 martín hidalgo et al 2014 anfuso et al 2016 ojeda et al 2017 molina et al 2019 lira loarca et al 2020 for the wave storm time clustering besio et al 2017 and wave storm intensity clustering dolan and davis 1992 all methods are based principally on the analysis of the swh time series for applied studies related to coastal engineering estimation of extreme wave return periods arena and pavone 2009 2006 and design of marine structures laface et al 2019 it is suggested to use methods such as the equivalent triangular storm ets boccotti 2000 2014 and the trapezoidal storm ts model based on the dnv gl storm profile samayam et al 2017 these methods associate a trapezoidal or triangular shape with each local wave storm event and the geometric parameters related to the different shapes are different in each model for example the ts model was used to determine the storm intensity for returned periods laface et al 2016 in the present study equivalent shape of storm events was not geometrically considered however variations in storm events duration and mean swh and swh peak that define the storm shape were analysed separately the characterisation of wave storms in the present study is conducted according to ojeda et al 2017 which defined wave storm events by a sea state where waves exceed a critical wave height threshold during a minimum period of 12 h this threshold is determined according to the long term climate of each location of interest with a minimum period between two successive storms of 48 h the wave hindcast data used in the present study has been produced using the swan wave model set with an unstructured regional grid the swan model was calibrated based on the tunable parameter of whitecapping dissipation c d s using wave measurements from 18 buoys to ensure an optimal accuracy in the estimations of extreme swh the wave model domain covers the whole mediterranean sea fig 1 the hindcasted waves are validated against long term observations from 5 buoys the outcome of the present study consists mainly in the characterisation of all storm events occurring in the western mediterranean sea during the last four decades and an assessment of the decadal changes in wave storm intensity linked to changes in swh during storms wave storm durations and wave storm directions 2 materials and methodology 2 1 wave hindcast the wave hindcast data was produced using a calibrated swan model booij et al 1999 ris et al 1999 as reported in several previous studies rogers et al 2003 moeini and etemad shahidi 2007 kamranzad et al 2013 akpinar and ponce de león 2016 atan et al 2017 kutupoğlu et al 2018 the swan model tends to underestimate wave heights the calibration of the swan model based on the white capping tunable parameter c ds results in a correction of this underestimation and an improvement of the accuracy of the output whatever the package used for wind source terms and whitecapping terms wu et al 2021 the whitecapping dissipation parameter is considered the least known parameterisation in wind wave models pallares et al 2014 the aim of the model calibration was mainly to improve the estimation of the swh exceeding the wave storm threshold in other words to improve the estimation of storm events that are the subject of this study the calibration method consisted of a stepwise decrease in the tunable coefficient c ds and in the evaluation of the error statistics of the overall estimated swh and of the swh exceeding the swh threshold swh swh threshold with respect to the wave measurements of the year 2014 recorded in the 18 buoys fig 1 and table 1 the swan model was run using an unstructured grid covering the entire mediterranean sea fig 1 the unstructured grid was created using the open access oceanmesh2d 1 0 matlab based software roberts et al 2019 https github com chlnddev oceanmesh2d last accessed in 20 02 2021 oceanmesh2d includes several mesh functions roberts et al 2019 such as the topographic length scale functions androulidakis et al 2015 greenberg et al 2007 lambrechts et al 2008 and the euclidean distance from the shoreline functions persson and strang 2004 the minimum resolution in the nearshore was limited to 3 5 km increasing progressively to a maximum distance of 25 kilometres offshore the grid contains 79 407 nodes and 151 295 elements detailed information about the oceanmesh2d can be found in roberts et al 2019 the spatial resolution of 3 5 km can be seen as one of the highest among the recent wave model hindcast simulations in the mediterranean sea the wam model was implemented by cavaleri and sclavo 2006 with a spatial resolution of 25 km the wavewatch iii model was evaluated by mentaschi et al 2015 using a regular grid of 10 km resolution the tomawac model by tiberi wadier et al 2016 with a minimum resolution of 800 m along the french coast over 3 km along the spanish and italian coasts and over 25 km in the rest of the domain the wamc4 model was implemented by ponce de león and guedes soares 2008 with a resolution of 25 km the mike21 model was implemented by donatini et al 2015 using the highest spatial resolution of 3 km in the nearshore area the wind forcing and whitecapping terms package of komen et al 1984 have been used the wave energy density spectrum was discretised in 35 frequencies logarithmically spaced between 0 033 hz and 1 0 hz and 36 directional bins with constant increment the shape of the spectra both in frequency and direction is defined by jonswap hasselmann et al 1973 with a gamma peak enhancement parameter of 3 3 the swan model was forced with winds from the era5 reanalysis of the european centre for medium range weather forecasts ecmwf the era5 reanalysis has a temporal resolution of 1 h and a spatial resolution of 0 25 0 25 starting from 1979 hersbach et al 2020 this reanalysis data is provided by the copernicus climate change service c3s climate date store https cds climate copernicus eu last accessed in 15 06 2021 the era5 winds are currently among the most used reanalysis in wind and wave climate studies mazzaro et al 2021 they are also recommended as reference to develop and validate historical wind climate data used in future climate projection studies akinsanola et al 2021 recently several studies have shown the accuracy of era5 winds for wind wave modelling simulations at a global scale baordo et al 2020 sharmar and markina 2020 as well as in different enclosed basins such as the persian gulf beyramzadeh et al 2021 the red sea beyramzadeh et al 2019 the black sea çalışır et al 2021 era 5 was recently used by the cmems copernicus marine environment monitoring service for the development of the new wind wave reanalysis for the mediterranean sea for the 1993 2019 period zacharioudaki et al 2020 beyramzadeh et al 2019 and wu et al 2021 showed a considerable improvement of the swan model using era5 winds after a calibration based on c ds tuneable parameter the wave hindcast database was produced using the calibrated swan model based on the same unstructured grid defined as a computational and output grid the simulation time step was set to 30 min and the output temporal resolution to 1 h covering the 1980 2019 period for evaluating the wave hindcast a long term comparison against wave buoy observations in five different locations fig 1 and table 1 has been performed for periods ranging from 13 to 18 years thus the wave storm events characterised based on wave buoy measurements were compared with those characterised on the wave hindcast table 1 shows a general description of each wave buoy used for the calibration and hindcast validation the periods of wave observations covered by each buoy are outlined in fig 2 the wave measurements insitu glo wave rep observations 013 045 are obtained from the copernicus database they are produced mainly by puertos de estado and made freely available by the copernicus project through the website https marine copernicus eu last accessed in 16 11 2020 the errors statistics equations used for the calibration and validation are presented in the appendix 2 2 wave storms characterisation a wave storm is commonly defined as a marine event in which the swh exceeds a pre defined threshold swh threshold over a considerable time period dolan and davis 1992 mendoza et al 2013 anfuso et al 2016 ojeda et al 2017 the minimum duration of a wave storm considered in the present study is 12 h following previous similar studies e g anfuso et al 2016 ojeda et al 2017 molina et al 2019 in view of spatial wave climate variations the swh threshold is determined according to the long term wave climate of each station following birkemeier et al 1999 mendoza et al 2013 ojeda et al 2017 walker and basco 2011 which states the need to define the swh threshold based on the local wave regime the swh threshold is computed as a long term average of swh in the study station plus twice the standard deviation of swh 1 swh threshold x 2 σ to ensure an effective separation between wave storm events two storms are considered independent if the swh between two storms remains below the swh threshold for a period of 48 h ojeda et al 2017 this separation period allows a distinction of macro meteorological phenomena gusella 1991 for the estimation of the intensity of the wave storm events the tswe and spi indices are computed and evaluated on a decadal scale in order to assess the decadal variation in wave storm intensity with respect to the variation in storm duration variation in swh during storms and also variation in storm direction the tswe is determined by arena et al 2015 as 2 t s w e t 0 t n p w t d t where p w is wave energy flux wave power approximated by 3 p w ρ g 2 64 π s w h 2 t e in which ρ is the seawater density and t e is energy period defined in terms of the n th order spectral moment m n by 4 t e m 1 m 0 5 m n 0 s f f n d f where s f is the wave spectral density variance and f is the frequency on the other hand the spi is computed using the original definition proposed by dolan and davis 1992 based on the wave storm events duration t d and mean swh during a wave storm event as 6 s p i s w h 2 t d the wave storm direction θ ws in radians was defined as the average direction of waves occurring during each wave storm event the average directions were computed using the following standard equations outlined in jammalamadaka and sengupta 2001 7 θ w s arctan 2 s c where 8 s i 1 m sin θ i and 9 c i 1 m cos θ i with m the total number of observations during a wave storm event and θ i are the mean wave directions in radians observed during the wave storm events i 1 m and computed as follows 10 θ i arctan 0 2 π f m i n f m a x e sin θ d f d θ 0 2 π f m i n f m a x e cos θ d f d θ where f is the spectral wave absolute frequency and e is the variance density spectrum in order to assess the decadal variations in wave storm regimes all wave storm events were characterised according to the method described above at each grid point in the west mediterranean sea decadal maximum and mean spi tswe swh and duration of wave storm events were further calculated for the decadal variation of the wave storm directions the respective recurrences were determined for each decade and mapped for eight directional bins wave storm events were characterised based on the swh time series at 24 325 locations covering the entire western mediterranean these locations correspond to the computation grid points fig 1 located in the western mediterranean basin 2 3 student t test for a robust estimation of inter decadal changes in wave storm characteristics student s t test was used this test determines whether the observed change between two decadal storm events data sets is statistically significant student t test is one of the most used statistical parametric tests decremer et al 2014 and is widely considered in wind wave climate changes studies carrasco et al 2014 morim et al 2019 semedo et al 2011 the null hypothesis states that there is no significant change between averages of two observed samples and the alternative hypothesis states that there is a significant change between two observed samples for a confidence level of 1 p value considering that the p values associated with the t test theoretical value indicate the probability that t t test and a no change probability the null hypothesis is rejected for p value 0 05 where t value is computed as follows 11 t x 2 x 1 s 1 2 n 1 s 2 2 n 2 x 1 and x 2 are means s1 and s2 are the standard deviations and n1 and n2 are sample sizes of the two compared samples respectively 3 results in this section the accuracy of the calibrated swan model and the wave hindcast data set from which wave storm events are filtered out were first presented after that decadal variations in the recurrence of wave storm events wave storm directions wave storm durations and swh during wave storm events are shown thus based on the spi and tswe indices the intensity of wave storm events is presented and discussed on a decadal scale the obtained results are presented spatially and for a more accurate assessment of the observed decadal changes the numerical results in 12 locations fig 3 were also considered to discuss the results 3 1 swan calibration results the calibration results presented in this section allowed a selection of an optimal c ds value to improve the performance of the swan model and to correct its underestimation of swh as the present study focuses on wave storm events the selection of the c ds value is based on the accuracy of the swan model in the estimation of the swh exceeding the wave storm threshold the statistical error measures used to evaluate the wave hindcasts accuracy are the correlation coefficient r the root mean square error rmse the bias and the hh index proposed by hanna and heinold 1985 and strongly recommended by mentaschi et al 2013 for wave models assessments as shown in table 2 and fig 4 the change in the c ds value corrected the biases at all 18 wave buoy locations and considerably reduced the hh index and the rmses the calibrated model performance improved compared to the model results obtained using the default c ds value c ds 2 36e 5 it has been observed that the average error obtained at all buoy measurements is good and in line with the previous implemented model in the mediterranean sea amarouche et al 2019 mentaschi et al 2015 the correlation coefficient average of all used buoys is 0 92 with a minimum hh index average of 0 23 a minimum rmse average of 0 24 m and a bias of 0 02 m using a c ds 0 8e 5 table 2 however for the swh exceeding the threshold using a c ds coefficient of 0 8e 5 we obtain a negative bias average of 0 19 m and the minimum positive average bias of 0 03 is obtained using a c ds 0 5e 5 fig 4 with an optimum hh index average of 0 16 an rmse average of 0 42 m table 2 rmse bias and hh index plots fig 4 show the results obtained in all buoys for all swh and swh exceeding the threshold the variation in hh index and rmse using c ds 0 8e 5 or c ds 0 5e 5 is low however the bias increases by decreasing the c ds values leading to overestimating the whole measurements and correcting the extreme swh a minimum bias is observed for swh exceeding the wave storm threshold using a c ds 0 5e 5 at most buoy locations see fig 4 although the c ds value is low a negative bias of 0 38 m is observed for swh swh threshold at the la revellata buoy b18 fig 4 this buoy is located on the north coast of corsica exposed to the north and northwest wind and waves according to davison et al 2019 era5 wind speed is highly underestimated in the ligurian sea off la revellata buoy b18 the highest underestimation of swh in b18 can be explained by an underestimation in era5 wind speed this buoy location is characterised by complex bathymetry and a complex orography where land fall of weather systems is hard to model sempreviva et al 2010 in view of the purpose of this study the wave hindcast database was developed using a c ds 0 5e 5 to ensure an accurate estimation of wave storm events the model performance remains good for the whole data with an hh index average equal to 0 25 an average rmse of 0 31 m and a mean bias 0 12 m 3 2 wave hindcast accuracy assessment it was considered essential to evaluate the accuracy of the wave hindcast data used to characterise wave storm events over an extended period exceeding ten years the results of the present study focus on ten year variations in wave storms the long term validation of the hindcast data is performed against wave buoy measurements table 1 for a minimum period of approximately 13 years fig 2 the statistical error measures used to evaluate the wave hindcasts accuracy are the same used during the calibration the obtained results presented in table 3 show good accuracy of the wave hindcast considering all simulated swh with an average correlation coefficient of 0 89 a mean hh index of 0 28 a mean rmse of 0 38 m and a mean bias of 0 17 m regarding the error statistics obtained for the swh exceeding the wave storms threshold a lower average correlation coefficient of 0 68 has been observed which can be explained by the considerable difference in the number of data realisations from the hindcast compared to the total measurements table 3 the observations of swh exceeding the threshold do not exceed 5 of the entire observations in all case and only refer to the extreme s events thus a good accuracy of swh exceeding the threshold is noticed with an average hh index of 0 16 an average bias of 0 16 m and an rmse average of 0 5 m the bias values are positive at all buoys and the highest biases of 0 17 m and 0 18 m are observed in b2 and b3 successively as noticed during the calibration the minimum bias obtained for swh exceeding the threshold fig 4 was also positive in all validation buoys b2 b5 b11 and the highest biases of 0 13 m and 0 10 m are observed as well in b2 and b3 fig 4 it is worth noticing that higher errors statistics are observed at the valencia b5 and tarragona buoys b4 these two buoys are located in the balearic basin where the highest errors statistics of era5 wind speed are present davison et al 2019 nerveless by referring to figs 5 and 6 and table 4 in which we compare the wave storm events from the wave hindcast and the wave storm events characterised on buoys measurements we observe a good accuracy in the estimated wave storms at all buoy locations a maximum bias of 0 28 m is observed in b2 almeria for the mean swh of all storm events fig 5 and a maximum bias of 0 22 m is observed in b11 burger for the maximum swh of all storm events fig 6 regarding the number of events table 4 a maximum difference of 14 events is shown in buoy b1 corresponding to a maximum difference of 8 the sensitivity of the present study which aims to discuss the variation of wave storms often responsible for damages in coastal areas and maritime transport requires careful consideration of wave hindcasts accuracy the errors statistic presented in this section allows a better appreciation of the findings reported in the present study 3 3 decadal recurrence of wave storm events based on the identified wave storm events during the 40 year period mapped for each decade fig 7 a decadal variation is shown in several locations and no continuous increase or decrease in storm events number can be observed from the maps and the local results table 5 the highest wave storm events are mainly observed in the north part of the western mediterranean basin which can be linked to extra tropical cyclone activity which is more critical in this area nissen et al 2010 sempreviva et al 2010 the highest number of wave storm events occurred during the second decade 1990 1999 in the european part and the lowest number during the third decade 2000 2010 during the last decade 2011 2019 an increase in wave storm events can be observed in the algerian basin s6 and s10 and the southern part of the tyrrhenian basin s12 thus the estimated wave storm numbers during the last decade remained closer to those observed during the first and second analysed decades in large parts of the basin in the balearic basin s5 in the western part of the alboran basin s1 and in the spanish coasts of east orientation a decrease in the estimated wave storm events has been observed during the last decade the decrease that these areas experienced can be related to the decrease in the eastern wave storm events almost generated by the levant wind as presented in the results of the following section 3 4 decadal variations in wave storm directions the wave storm direction is evaluated by considering the mean wave direction during the respective wave storm events the recurrence of each occurred direction is computed in all the analysed grid points wave storm events were classified in eight direction bins and the frequencies of occurrence corresponding to each bin are mapped separately for each decade figs 8 and 9 the illustrated maps show the dominant and more prevalent wave storm directions in the west mediterranean sea and the respective decadal changes in each area the variation in dominated direction is very low between the fourth decades however we can notice this variation in several locations from an overall view the result allows the classification of the west mediterranean sea in ten areas based on storm wave directions the eastern part of the balearic basin dominated by winds from the east sector which can be linked to the levante winds the south western part of the algerian basin dominated by wave storms from the western sector which can be connected to the ponente and vendavel winds the north western part of the algerian basin dominated by wave storms from the south western sector the south eastern zone of the algerian basin dominated by wave storms from the northern north western and western sectors associated with the tramontane mistral and ponente winds the western balearic basin dominated by wave storms of the north eastern sector which levante winds can generate the western zone of sardinia dominated by wave storms from the north western sectors that the mistral or the tramontane winds can induce the west and north zone of corsica dominated by western and south western wave storms respectively possibly linked to the libeccio wind that dominates this region the north eastern tyrrhenian basin dominated by wave storms from the south west and southern sectors which can be generated by libeccio winds and possibly by sirocco winds the south part of the tyrrhenian basin is dominated by wave storms from the western and north west sectors and near the southwest coast of france the dominant wave storms are mainly from the southern and south western sectors which can be linked to the marin winds during the last two decades and in the locations s1 s3and s4 we observe a gradual increase of storm events from west sectors and a gradual decrease of storm events from east sectors figs 8 10 in the se part of the balearic basin off the valencian coast s5 the dominated storm events are from the ne sector and a low change in wave storm directions can be observed in this area in the centre part of the algerian basin s6 we observe a gradual increase of storm events from the west sectors during the last four decades with a decrease in storm events from the n ne e w sectors mainly during the last two decades however in the eastern part of the algerian basin s10 we noticed a cyclical decadal variation with an increase in western wave storms during the second and the last decades and a decrease in the nw wave storms recurrences in the same periods in the centre part of the west mediterranean sea s8 between the algerian and provencal basins a gradual change in wave storm direction is observed during the last four decades with a decrease in the dominated storm events from n sectors and an increase in storm events from sw w and nw sectors thus in the provencal basin a low change in the dominant wave storm directions can be observed at location s7 a dominance of n wave storms is clearly noticed and during the last decade further increase in the n wave storms recurrences is seen fig 10 off the west coast of france the results presented at s9 location show an increasing trend of the dominated wave storm events from west sectors and a decrease in wave storms from east sectors unlike a large area of the western mediterranean basin the northern part of the tyrrhenian basin is affected by wave storms coming from all directions in this area the main decadal variation in the wave storm directions recurrence is noticed for the most predominant directions south a cyclical decadal variation with a decrease in the second and the last decade of wave storms from south sectors followed by an increase of sw wave storms in the second decade and a notable increase of se wave storm in the last decade in the southern part of the tyrrhenian basin the most dominated wave storms are from the west sectors and an increasing trend in wave storms from west sectors has been observed during the last three decades according to the results the most critical observation is that a large area of the west mediterranean has been experiencing a gradual increasing change during the last three decades in wave storm recurrences from the west sectors at s1 s3 s6 s8 s10 and s12 3 5 decadal variation in wave storm duration the duration of wave storm events is an essential parameter in defining storm intensity as the duration increases so does the coastal risk dolan and davis 1992 according to mendoza and jiménez 2005 wave storm duration was considered the key quantitative parameter for predicting the eroded volume amounts during wave storms in catalonia here the duration of each wave storm event that occurred during the last 40 years was determined thus the average and maximum wave storm durations were calculated on a decadal scale and mapped in figs 11 and 12 the results depict the decadal spatial variations of mean and maximum wave storm durations in the west mediterranean sea for a more precise assessment of the quantitative decadal variations the discussion is supported by the local numerical results extracted from the 12 reference locations fig 3 and presented in table 5 in the maps corresponding to the first three analysed decades fig 11 the area experiencing a significant change compared to the results of the last decade 2010 2019 are indicated through a student s t test for a confidence level of 95 and highlighted for both positive red and negative blue significant changes fig 11 thus the probabilities p value of no change in the inter decade averages are presented in table 6 for the twelve reference locations fig 3 the same presentations of the statistical t test results are applied for the other storm characteristics shown in the following sections according to the results in fig 11 a notable spatial variation on the decadal scale can be observed the main changes in decadal wave storm duration are observed during the last decade where an increase in the mean duration of wave storms is observed in the algerian basin in the balearic basin in the eastern coast of the alboran basin in the west part of the provencal basin and in the eastern coast of corsica these observed changes are significant during the last decade in a considerable part of these locations compared to the first and second decades however compared to the 3rd decade 2000 2009 changes are less significant this may explain that the observed changes in these zones have already started to appear over the last two decades by referring to the results presented in table 5 concerning 12 offshore locations of references fig 3 we notice that the highest values of mean wave storm duration are observed during the last decade in 9 locations s2 s8 s10 and s11 table 5 an increasing change can be observed during the last three decades in the algerian basin s4 s6 s8 and s10 in the east alboran basin s3 and in the balearic basin s5 where a gradual increase in western wave storm recurrence was observed s3 s4 s6 s8 and s10 however the changes are only significant in s3 and s5 between the first and last decades and stations s3 and s4 between the 2nd and the last decade table 6 by referring to the mapped results fig 11 it can be observed that most areas that are experiencing a significant increasing change are located near to the coasts as well as locations s3 s4 and s5 fig 3 where significant change was observed table 6 during the last two decades we can observe a significant decrease in wave storm duration average in the east coast of france in the coasts of corsica and in the south part of the tyrrhenian basin the highest value of storm wave duration in the east coast of france s9 and the southern part of the tyrrhenian basin s12 occurred during the first decade 1980 1989 concerning the decadal variations of the maximum wave storm duration the results fig 12 and table 5 are in agreement with that of the average wave storm durations in the algerian the balearic the alboran and the west part of the provencal basins the maximum storm durations were observed during the last decade s4 s6 s8 and s10 in the ligurian basin in the east coasts of the tyrrhenian basin and the sw coasts of palma island the maximum durations are observed during the first decade 1980 1989 the highest durations of wave storm events are mainly observed during the first 1980 1989 and the last decade 2010 2019 3 6 decadal variation in swh during wave storm events the mean and the maximum swh during wave storm events were determined and evaluated on a decadal scale the maps presented in figs 13 and 14 show the spatial distribution of the mean and maximum swh during wave storm events and the corresponding decadal variations during the last four decades according to these maps it can be seen that the spatial distribution of the mean swh during wave storm events is very similar to the spatial distribution of total long term mean swh mapped by amarouche et al 2020a this may be explained by the significant contribution of wave storms to the swh total average by comparing the maximum and mean swh during wave storm events we can notice the difference in the spatial and temporal distributions of these two parameters thus concerning their respective decadal variations we observe that the mean swh has experienced a very low variation during the last four decades however it is statistically significant in different locations the maximum significant change between the lowest mean swh and the highest mean swh between all decades in the 12 locations table 5 is 0 12 m observed in the location s7 in the west part of the provencal basin a significant decrease was observed as well in station s3 between the first and second decades regarding the maps in fig 13 we noticed that the decadal change in swh is different compared to decadal changes in wave storm duration with respect to the last decadal period we observe significant decreases in swh compared to the first and second decades in some balearic coasts fig 13 in the eastern coasts of france in the western coasts of sardinia in the southern provencal basin in several portions of the algerian coast and the north tunisian coasts on the other hand significant positive changes are observed in the southern coasts of the alboran basin in the western coasts of france in the eastern provencal basin off begur coast and some italian coasts only the western coast of algeria oran experienced a significant positive change in both swh fig 13 and wave storm duration fig 11 on the other hand the decadal and spatial variation of the maximum swh during wave storm events is more critical and considerably different than the decadal variations in the mean swh the variations in the maximum swh are not correlated with variations in the mean swh except in the alboran and tyrrhenian basins the highest values of maximum swh are observed in the first decade 1980 1989 in almost all the west mediterranean sea fig 14 in the eastern coast of algeria the maximum swh is estimated between 1999 and 2009 3 7 the intensity of wave storm events the intensity of the wave storms is illustrated by the spi and tswe indices the decadal variations in these two parameters mean and maximum values are mapped in figs 15 to 18 these maps show a similarity in the spatial distribution of two parameters knowing that the wave period is the only parameter that differs between them this result allows us to estimate that the wave period is unlikely to significantly influence the spatial and decadal variations of the wave storm intensity the maps in figs 15 and 17 showing decadal variations of the mean tswe and mean spi respectively allow us to observe a decadal variation in the european and eastern african coasts the lowest wave storm intensity average is observed from 1990 to 1999 since then an increase has been observed in the provencal basin the balearic coasts the algerian coasts and the alboran basin concerning the last decadal period the increase in the twse and spi averages compared to the first and second decades are relevant in the spanish balearic coast in the east part of the alboran basin in the eastern coast of corsica and some italian coast figs 15 and 17 the local results presented in table 5 show the changes in the spi and tswe averages during the last decade the maximum value of spi and twse averages is observed during the last decade in nine locations s2 s8 s10 and s11 as well as the maximum wave storm duration averages however considering a confidence level of 90 table 6 significant changes in spi and twse are only observed in s2 s3 s11 positive change and in s12 negative change the areas expecting a significant change in the last decade are located near the coast and are less important in the balearic basin compared to the area experiencing a significant change in storm wave duration figs 15 and 17 comparing these results figs 15 and 17 to those of swh fig 13 some locations in the spanish coast experiencing a significant decreasing change in swh during the last decade fig 13 have experienced an increasing change in both storm wave duration fig 11 and storm intensity spi and twse the decadal variations in spi and tswe are more likely dependent on variations in durations of wave storm events except in the southern coast of the alboran basin where significant increasing change was observed both for swh and duration averages of the wave storm events regarding the decadal variations in the maximum values figs 16 and 18 a similarity is also observed in the spatial distribution of the maximum spi the maximum storm intensity has been recorded during the last decade in the algerian balearic the provençal and eastern alboran basins however in the tyrrhenian basin the highest storm intensity is recorded during the first two decades these results are strongly correlated with the results of the maximum wave storm duration fig 12 and it is also noted that the storms corresponding to the most extended duration are not particularly the storms in which the maximum swh was recorded referring to the results of the maximum swh during the storms fig 14 4 discussion according to lionello et al 2006 the mediterranean region s morphological geographical historical and societal characteristics reveal a scientific interest in studying its climate in the last decade several studies have shown a considerable change in wave climate and storm intensity in several regions casas prat and sierra 2010 gulev 2004 keim et al 2004 komar and allan 2008 reguero et al 2019 ruggiero et al 2010 vieira et al 2020 including the mediterranean sea amarouche et al 2021 meucci et al 2020 young and ribal 2019 yuchun and leo 2020 shimura et al 2015 found that the change in wave climate has considerable sensitivity to the change in sea surface temperature hence to the global warming effect thus the climate in the mediterranean region is primarily influenced by global patterns lionello and scarascia 2020 as mentioned earlier most studies on wave climate variations are based on the swh trend the results obtained in the present study are focused on the interdecadal changes of the wave storm characteristics in the western mediterranean interests in assessing changes in wave storms include the fact that wave storms are considered a robust climate indicator of the state of coastal areas sánchez arcilla et al 2011 wave storm events are often responsible for coastal erosion and coastal inundation events bosom and jiménez 2011 recently wave storms have caused enormous damage in the mediterranean sea on the algerian spanish french and italian coasts amarouche et al 2020b amores et al 2020 biolchi et al 2019 cavaleri et al 2019 in january 2015 an extreme wave storm was responsible for significant erosion resulting in the loss of more than 15 000 m2 of a beach area and the destruction of two coastal buildings in the eastern part of the capital algiers amarouche et al 2020b in october 2018 the storm adrian was responsible for more than two billion euros of damages biolchi et al 2019 across the mediterranean sea in january 2020 storm gloria was responsible for the damage in several coastal infrastructures and intense coastal erosion corresponding to immediate economic losses of several millions of euros amores et al 2020 coastal storm events can considerably affect the economy and the policy of the countries besides the coastal risk resulting from these wave storms the merchant navy and harbour activities can also be affected by wave storms knowledge of the weather conditions in which ships operate is a crucial element to be considered in order to increase safety and avoid risks related to wave storms vettor and guedes soares 2016 the assessment of wave storm regimes and monitoring of wave storm variations can constitute necessary decisional support for developing offshore and coastal zone policies and ensuring sustainable development and facing the global warming issue the damages recorded during storm events depend on swh wave storm directions in respect to the shoreline wave storm duration and storm surge the results obtained in this study provide an insight into understanding the wave and storm regime in the western mediterranean basin the results show a significant decadal change in wave storm characteristics in several locations in the west mediterranean sea during the last decade compared to the first 1980 1989 and second 1990 1999 ones a significant increase in wave storm intensities and wave storm durations are observed in the alboran basin in the eastern coast of the balearic basin in the eastern coast of corsica and several parts of the italian coast thus a significant decrease is observed at the coast of monaco and on the north shore of corsica in these last two locations a considerable increase in swh during wave storms is estimated during the last decade fig 13 comparing the results of the last decade 2010 2019 to those of the 3rd decade 2000 2009 we also noticed a significant increasing change in the eastern part of the albertan basin the southern coast of the alboran basin is the unique area where significant increasing changes in both swh and wave storm duration are estimated figs 11 and 13 on the other hand an increase in the recurrence of wave storm events from western sectors is noticed figs 8 10 in the alboran basin s1 s2 and the west part of the algerian basin s3 s4 and s6 a possible link between the recurrence increases in wave storm events from western sectors and the increases in the average wave storm duration and intensity can be highlighted see table 5 and fig 10 regarding the decadal change in spi and tswe averages and their spatial distribution figs 15 to 17 we notice that the wave storm intensities are more dependent on the change in storm durations figs 11 and 12 and the increasing annual trend in storm intensity reported in amarouche and akpınar 2021 can be more linked to an annual trend in wave storm durations the result of the maximum wave storm duration fig 12 maximum swh during wave storms fig 14 spi fig 16 and twse fig 18 also show a dependence of both spatial and decadal variations in maximum storm intensities on maximum storm durations the changes in the wave storm directions and wave storm durations can be at the origin of the increases in the wave storm damage observed in the west mediterranean sea reported in amarouche et al 2020b amores et al 2020 cavaleri et al 2019 jiménez et al 2012 the locations experiencing a relevant change in wave storm intensity such as the eastern part of the alboran basin oran coast and the western coast of the balearic basin valencia coast require particular consideration to manage the risks regarding the increase in wave storm intensity the recent wave storm gloria occurred in january 2020 was responsible for considerable damages in the spanish coasts amores et al 2020 where a significant decadal change was estimated in the present study fig 15 noting that the year 2020 was not considered in the analysis the development of a wave storm database and the results presented in this study may allow the classification of wave storm events in terms of direction swh and duration thus an assessment of wave storm links to different global and regional climate patterns may contribute to a deeper understanding of wave storm regimes in the western mediterranean sea and the origins of the decadal wave climate changes according to lionello and galati 2008 several mid latitude climate patterns are linked to the swh in the mediterranean sea mainly the east atlantic west russia pattern ea wr the scandinavia pattern sca the east atlantic pattern ea and even the nao pattern the nao was also linked to the cyclones causing wind storms in the mediterranean sea nissen et al 2010 it was found that both the nao and ea wr patterns are positively related to an increase in the recurrence of strong winds in the western mediterranean sea during their positive phase nissen et al 2010 a focused study on identifying teleconnection patterns tlc associated with wave storms events in the western mediterranean sea may provide an insight into the effect of global and inter regional climate change on the observed increase in wave storm intensities in the western mediterranean sea 5 conclusion this study presented an assessment of the wave storm regime in the west mediterranean sea over the last four decades wave storm events that occurred between 1980 and 2019 were characterised based on swh wave storm duration and wave storm direction the spi and tswe were computed for each storm event wave storm events were defined as a sea state during which swh exceeds a swh threshold calculated according to the local wave climate of each location the decadal variation in wave storm events numbers and decadal variation in wave storm characteristics and intensity were analysed the results obtained here allow us to conclude that wave storm events experienced a substantial change at the decadal scale in terms of their recurrence and characteristics in the west mediterranean sea at the spatial scale the observed decadal variations are different in each sub basin during the last decades several parts of the west mediterranean basin have experienced significant changes in wave storm intensity linked to an increase in wave storm durations these relevant increases are mainly observed in the eastern part of the alboran basin on the eastern coast of corsica and in the balearic basin a non significant increase is also observed in the east part of the algerian and the provencal basins over the last decade changes in storm intensity are more dependent on the changes in storm duration than on the changes in swh and can also be related to variations in the wave storm directions therefore it is recommended to consider wave storm duration and direction for coastal and offshore risk assessment and wave climate trend analysis consideration of wave storm characteristics can be recommended for future climate projection studies to estimate the likely future changes in wave storm intensities based on different climate change scenarios observed changes in wave storm patterns can constitute a substantial risk in several coastal areas in the west mediterranean sea the changes in wave storm regime reported during the present study may provide potential support for evaluating the likely impact related to global warming at a regional scale this decision support can be considered in the development of coastal management policies to ensure sustainable development in the coastal area and prevent the damages related to the increases in the wave storm recurrence and intensity credit authorship contribution statement khalid amarouche writing original draft methodology conceptualization software validation formal analysis writing review editing data curation adem akpınar conceptualization methodology writing review editing investigation resources alvaro semedo supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements weacknowledge the european centre for medium range weather forecasts ecmwf for providing wind data through the official website of the copernicus climate change service c3s climate date store we acknowledge as well copernicus marine environment monitoring service cmems for providing wave observations and we acknowledge the general bathymetric chart of the oceans gebco for providing the bathymetry data funding the authors did not receive support from any organisation for the submitted work appendix a 1 definitions of statistical error parameters wave hindcast data accuracy was evaluated using standard error statistics the root means square error rmse bias correlation coefficient r and a normalised root mean square error hh index introduced by hanna and heinold 1985 and used and recommended for wave model assessment by mentaschi et al 2013 these parameters are computed as follows a 1 r m s e 1 n i 1 n p i o i 2 1 2 a 2 b i a s p o a 3 r i 1 n p i p o i o i 1 n p i p 2 i 1 n o i o 2 1 2 a 4 h h i 1 n p i o i 2 i 1 n p i x o i where o i is the observed value o is the mean value of the observed data p i is the predicted value p is the mean value of the predicted data and n is the total number of data 
23861,the rising intensity and recurrence of wave storm events can seriously impact navigation and coastal and offshore structures in the western mediterranean sea therefore the present study is focused on wave storm events in the western mediterranean sea over the last four decades the spatial decadal variations of wave storm events are shown considering variations in the parameters that characterise wave storms such as significant wave height swh wave storm duration and wave storm direction additionally the decadal variation in wave storm intensities is evaluated through the storm power index spi and the total storm wave energy tswe the study is based on a wave hindcast developed using a calibrated swan model the wave storm events are obtained based on the swh time series for 24 325 locations distributed over an unstructured grid covering the entire western mediterranean sea the decadal variation in the number of wave storm events maximum and mean wave storm duration spi and tswe were observed in large parts of the west mediterranean sea during the last four decades however variations in mean swh during these storms are low and do not show a real implication in the decadal changes in the wave storm intensity spi and tswe locations of significant increasing changes in spi and tswe show a dependence on changes in the wave storm duration they may be related to variations in wave storm direction in some areas increases in wave storm duration are mainly responsible for increases in wave storm intensities over the last decade keywords wave storms decadal variations wind waves wave storm durations swan western mediterranean sea availability of data and material the datasets generated during and or analysed during the current study are available from the corresponding author on reasonable request 1 introduction the mediterranean sea has had several studies focused on the impact of global warming and global changes at a regional scale e g satta et al 2017 lionello and scarascia 2018 cramer et al 2018 gonzález alemán et al 2019 mentzafou et al 2019 antronico et al 2020 for that matter it was recently considered a climate change hotspot tuel and eltahir 2020 during the last decade the rate of climate change for several climate parameters became more critical in the mediterranean sea than on a global scale cramer et al 2018 lionello and scarascia 2020 changes such as an increase in sea surface temperatures pastor et al 2018 pisano et al 2020 sakalli 2017 skliris et al 2012 in sea level rise dangendorf et al 2019 taibi and haddad 2019 vousdoukas et al 2017 in occurrence and intensity of storm surges cid et al 2016 and wave storms amarouche et al 2020b jiménez et al 2012 komar and allan 2008 were observed recently several exceptional wave storm events were reported in the mediterranean sea such as storm adrian in 2018 cavaleri et al 2019 csekits and troisi 2018 and storm gloria in 2020 amores et al 2020 de alfonso et al 2021 wave storms often result in considerable changes in coastal areas and are usually associated with severe infrastructure damage marzeddu et al 2020 economic losses and even with the loss of human lives according to sánchez arcilla et al 2011 wave storminess and mean sea level are considered to be the most robust climate indicators for the state of coastal areas knowledge of current and future wave storm patterns is therefore critical for offshore and coastal management and marine activities it is crucial for sustainable economic development and to counteract the risks related to climate change the spatial assessment of the wave and storm regimes allows the location of coastal areas that are experiencing significant changes in wave and storm intensity at present several studies have evaluated the spatial and temporal trends in swh in the mediterranean sea and at a global scale yuchun and leo 2020 de leo et al 2020 young et al 2011 young and ribal 2019 timmermans et al 2020 the impact of waves on coastal zones or offshore infrastructures does not depend only on the stress effect of wave heights or wave energy content but also on its persistence beyond a specific wave height threshold which constitutes the main factor in the characterisation of the intensity of a wave storm dolan and davis 1992 the recent studies on annual trends in wave storm intensity amarouche and akpınar 2021 and swh de leo et al 2020 timmermans et al 2020 yuchun and leo 2020 have shown that some parts of the mediterranean sea have experienced a significant increase in swh spi and tswe however we observed that the areas characterised by an increase in wave storm intensity are more important than those characterised by the rise in maximum swh as shown by de leo et al 2020 potentially the variations in wave storm duration and direction can play an important role in the wave storm intensity trends in some areas of the mediterranean sea the swh is not the only parameter that can define the intensity of a coastal storm and its impacts on the coastal and offshore environments as presented by dolan and davis 1992 wave storm duration and incoming directions are also relevant few studies assessing the long term variation in wave storm events in the western mediterranean sea have been carried out these studies have been carried out only locally and are only based on variations in the dolan and davis 1992 wave storm intensity index mendoza and jiménez 2005 guisado pintado et al 2014 amarouche et al 2020b and in the tswe index amarouche and akpınar 2021 molina et al 2019 furthermore to the extent of our knowledge variations in the parameters that characterise the wave storm events are often not assessed separately the goal of this study is to determine the decadal variation of wave storm events in the western mediterranean sea considering the recent past changes in the recurrence and intensity of wave storm events while analysing the decadal changes in swh during wave storms wave storms duration and wave storms direction with respect to variations in total wave storm energy tswe amarouche and akpınar 2021 arena et al 2015 molina et al 2019 and the variation in storm power index spi adapted by dolan and davis 1992 both averages and maximum values are considered on a decadal scale and student s t test is used to assess the statistical significance of the observed change in decadal storm events according to vera et al 2010 the study of decadal scale climate variation is needed for decision making processes in socio economic sectors several factors that contribute to global and regional changes in climate can be linked at a decadal scale studies of decadal climate variations can incorporate internal natural factors including ocean land atmosphere interactions smith et al 2019 as well as anthropogenic factors murphy et al 2010 smith et al 2019 and volcanic activities national academies of sciences 2016 smith et al 2019 that have an impact on greenhouse gas emissions and aerosols furthermore studies of decadal climate variation are often recommended for the connections to different climate patterns cassou et al 2018 mariotti et al 2015 at both global and regional scales e g the atlantic multidecadal oscillation dijkstra et al 2006 and the pacific decadal oscillation mantua and hare 2002 newman et al 2016 from another perspective decadal climate variations are more predictable smith et al 2019 on the other hand focusing on decadal changes allows a larger range larger sample size of storm events to be considered to perform a parametric statistical test wave storms are usually defined as a sea state during which the swh exceeds a specific threshold value and persists over a considerable period different methods and models have been adopted for wave storm characterisation dolan and davis 1992 fedele and arena 2010 rangel buitrago and anfuso 2011 jiménez et al 2012 mendoza et al 2013 martín hidalgo et al 2014 anfuso et al 2016 ojeda et al 2017 molina et al 2019 lira loarca et al 2020 for the wave storm time clustering besio et al 2017 and wave storm intensity clustering dolan and davis 1992 all methods are based principally on the analysis of the swh time series for applied studies related to coastal engineering estimation of extreme wave return periods arena and pavone 2009 2006 and design of marine structures laface et al 2019 it is suggested to use methods such as the equivalent triangular storm ets boccotti 2000 2014 and the trapezoidal storm ts model based on the dnv gl storm profile samayam et al 2017 these methods associate a trapezoidal or triangular shape with each local wave storm event and the geometric parameters related to the different shapes are different in each model for example the ts model was used to determine the storm intensity for returned periods laface et al 2016 in the present study equivalent shape of storm events was not geometrically considered however variations in storm events duration and mean swh and swh peak that define the storm shape were analysed separately the characterisation of wave storms in the present study is conducted according to ojeda et al 2017 which defined wave storm events by a sea state where waves exceed a critical wave height threshold during a minimum period of 12 h this threshold is determined according to the long term climate of each location of interest with a minimum period between two successive storms of 48 h the wave hindcast data used in the present study has been produced using the swan wave model set with an unstructured regional grid the swan model was calibrated based on the tunable parameter of whitecapping dissipation c d s using wave measurements from 18 buoys to ensure an optimal accuracy in the estimations of extreme swh the wave model domain covers the whole mediterranean sea fig 1 the hindcasted waves are validated against long term observations from 5 buoys the outcome of the present study consists mainly in the characterisation of all storm events occurring in the western mediterranean sea during the last four decades and an assessment of the decadal changes in wave storm intensity linked to changes in swh during storms wave storm durations and wave storm directions 2 materials and methodology 2 1 wave hindcast the wave hindcast data was produced using a calibrated swan model booij et al 1999 ris et al 1999 as reported in several previous studies rogers et al 2003 moeini and etemad shahidi 2007 kamranzad et al 2013 akpinar and ponce de león 2016 atan et al 2017 kutupoğlu et al 2018 the swan model tends to underestimate wave heights the calibration of the swan model based on the white capping tunable parameter c ds results in a correction of this underestimation and an improvement of the accuracy of the output whatever the package used for wind source terms and whitecapping terms wu et al 2021 the whitecapping dissipation parameter is considered the least known parameterisation in wind wave models pallares et al 2014 the aim of the model calibration was mainly to improve the estimation of the swh exceeding the wave storm threshold in other words to improve the estimation of storm events that are the subject of this study the calibration method consisted of a stepwise decrease in the tunable coefficient c ds and in the evaluation of the error statistics of the overall estimated swh and of the swh exceeding the swh threshold swh swh threshold with respect to the wave measurements of the year 2014 recorded in the 18 buoys fig 1 and table 1 the swan model was run using an unstructured grid covering the entire mediterranean sea fig 1 the unstructured grid was created using the open access oceanmesh2d 1 0 matlab based software roberts et al 2019 https github com chlnddev oceanmesh2d last accessed in 20 02 2021 oceanmesh2d includes several mesh functions roberts et al 2019 such as the topographic length scale functions androulidakis et al 2015 greenberg et al 2007 lambrechts et al 2008 and the euclidean distance from the shoreline functions persson and strang 2004 the minimum resolution in the nearshore was limited to 3 5 km increasing progressively to a maximum distance of 25 kilometres offshore the grid contains 79 407 nodes and 151 295 elements detailed information about the oceanmesh2d can be found in roberts et al 2019 the spatial resolution of 3 5 km can be seen as one of the highest among the recent wave model hindcast simulations in the mediterranean sea the wam model was implemented by cavaleri and sclavo 2006 with a spatial resolution of 25 km the wavewatch iii model was evaluated by mentaschi et al 2015 using a regular grid of 10 km resolution the tomawac model by tiberi wadier et al 2016 with a minimum resolution of 800 m along the french coast over 3 km along the spanish and italian coasts and over 25 km in the rest of the domain the wamc4 model was implemented by ponce de león and guedes soares 2008 with a resolution of 25 km the mike21 model was implemented by donatini et al 2015 using the highest spatial resolution of 3 km in the nearshore area the wind forcing and whitecapping terms package of komen et al 1984 have been used the wave energy density spectrum was discretised in 35 frequencies logarithmically spaced between 0 033 hz and 1 0 hz and 36 directional bins with constant increment the shape of the spectra both in frequency and direction is defined by jonswap hasselmann et al 1973 with a gamma peak enhancement parameter of 3 3 the swan model was forced with winds from the era5 reanalysis of the european centre for medium range weather forecasts ecmwf the era5 reanalysis has a temporal resolution of 1 h and a spatial resolution of 0 25 0 25 starting from 1979 hersbach et al 2020 this reanalysis data is provided by the copernicus climate change service c3s climate date store https cds climate copernicus eu last accessed in 15 06 2021 the era5 winds are currently among the most used reanalysis in wind and wave climate studies mazzaro et al 2021 they are also recommended as reference to develop and validate historical wind climate data used in future climate projection studies akinsanola et al 2021 recently several studies have shown the accuracy of era5 winds for wind wave modelling simulations at a global scale baordo et al 2020 sharmar and markina 2020 as well as in different enclosed basins such as the persian gulf beyramzadeh et al 2021 the red sea beyramzadeh et al 2019 the black sea çalışır et al 2021 era 5 was recently used by the cmems copernicus marine environment monitoring service for the development of the new wind wave reanalysis for the mediterranean sea for the 1993 2019 period zacharioudaki et al 2020 beyramzadeh et al 2019 and wu et al 2021 showed a considerable improvement of the swan model using era5 winds after a calibration based on c ds tuneable parameter the wave hindcast database was produced using the calibrated swan model based on the same unstructured grid defined as a computational and output grid the simulation time step was set to 30 min and the output temporal resolution to 1 h covering the 1980 2019 period for evaluating the wave hindcast a long term comparison against wave buoy observations in five different locations fig 1 and table 1 has been performed for periods ranging from 13 to 18 years thus the wave storm events characterised based on wave buoy measurements were compared with those characterised on the wave hindcast table 1 shows a general description of each wave buoy used for the calibration and hindcast validation the periods of wave observations covered by each buoy are outlined in fig 2 the wave measurements insitu glo wave rep observations 013 045 are obtained from the copernicus database they are produced mainly by puertos de estado and made freely available by the copernicus project through the website https marine copernicus eu last accessed in 16 11 2020 the errors statistics equations used for the calibration and validation are presented in the appendix 2 2 wave storms characterisation a wave storm is commonly defined as a marine event in which the swh exceeds a pre defined threshold swh threshold over a considerable time period dolan and davis 1992 mendoza et al 2013 anfuso et al 2016 ojeda et al 2017 the minimum duration of a wave storm considered in the present study is 12 h following previous similar studies e g anfuso et al 2016 ojeda et al 2017 molina et al 2019 in view of spatial wave climate variations the swh threshold is determined according to the long term wave climate of each station following birkemeier et al 1999 mendoza et al 2013 ojeda et al 2017 walker and basco 2011 which states the need to define the swh threshold based on the local wave regime the swh threshold is computed as a long term average of swh in the study station plus twice the standard deviation of swh 1 swh threshold x 2 σ to ensure an effective separation between wave storm events two storms are considered independent if the swh between two storms remains below the swh threshold for a period of 48 h ojeda et al 2017 this separation period allows a distinction of macro meteorological phenomena gusella 1991 for the estimation of the intensity of the wave storm events the tswe and spi indices are computed and evaluated on a decadal scale in order to assess the decadal variation in wave storm intensity with respect to the variation in storm duration variation in swh during storms and also variation in storm direction the tswe is determined by arena et al 2015 as 2 t s w e t 0 t n p w t d t where p w is wave energy flux wave power approximated by 3 p w ρ g 2 64 π s w h 2 t e in which ρ is the seawater density and t e is energy period defined in terms of the n th order spectral moment m n by 4 t e m 1 m 0 5 m n 0 s f f n d f where s f is the wave spectral density variance and f is the frequency on the other hand the spi is computed using the original definition proposed by dolan and davis 1992 based on the wave storm events duration t d and mean swh during a wave storm event as 6 s p i s w h 2 t d the wave storm direction θ ws in radians was defined as the average direction of waves occurring during each wave storm event the average directions were computed using the following standard equations outlined in jammalamadaka and sengupta 2001 7 θ w s arctan 2 s c where 8 s i 1 m sin θ i and 9 c i 1 m cos θ i with m the total number of observations during a wave storm event and θ i are the mean wave directions in radians observed during the wave storm events i 1 m and computed as follows 10 θ i arctan 0 2 π f m i n f m a x e sin θ d f d θ 0 2 π f m i n f m a x e cos θ d f d θ where f is the spectral wave absolute frequency and e is the variance density spectrum in order to assess the decadal variations in wave storm regimes all wave storm events were characterised according to the method described above at each grid point in the west mediterranean sea decadal maximum and mean spi tswe swh and duration of wave storm events were further calculated for the decadal variation of the wave storm directions the respective recurrences were determined for each decade and mapped for eight directional bins wave storm events were characterised based on the swh time series at 24 325 locations covering the entire western mediterranean these locations correspond to the computation grid points fig 1 located in the western mediterranean basin 2 3 student t test for a robust estimation of inter decadal changes in wave storm characteristics student s t test was used this test determines whether the observed change between two decadal storm events data sets is statistically significant student t test is one of the most used statistical parametric tests decremer et al 2014 and is widely considered in wind wave climate changes studies carrasco et al 2014 morim et al 2019 semedo et al 2011 the null hypothesis states that there is no significant change between averages of two observed samples and the alternative hypothesis states that there is a significant change between two observed samples for a confidence level of 1 p value considering that the p values associated with the t test theoretical value indicate the probability that t t test and a no change probability the null hypothesis is rejected for p value 0 05 where t value is computed as follows 11 t x 2 x 1 s 1 2 n 1 s 2 2 n 2 x 1 and x 2 are means s1 and s2 are the standard deviations and n1 and n2 are sample sizes of the two compared samples respectively 3 results in this section the accuracy of the calibrated swan model and the wave hindcast data set from which wave storm events are filtered out were first presented after that decadal variations in the recurrence of wave storm events wave storm directions wave storm durations and swh during wave storm events are shown thus based on the spi and tswe indices the intensity of wave storm events is presented and discussed on a decadal scale the obtained results are presented spatially and for a more accurate assessment of the observed decadal changes the numerical results in 12 locations fig 3 were also considered to discuss the results 3 1 swan calibration results the calibration results presented in this section allowed a selection of an optimal c ds value to improve the performance of the swan model and to correct its underestimation of swh as the present study focuses on wave storm events the selection of the c ds value is based on the accuracy of the swan model in the estimation of the swh exceeding the wave storm threshold the statistical error measures used to evaluate the wave hindcasts accuracy are the correlation coefficient r the root mean square error rmse the bias and the hh index proposed by hanna and heinold 1985 and strongly recommended by mentaschi et al 2013 for wave models assessments as shown in table 2 and fig 4 the change in the c ds value corrected the biases at all 18 wave buoy locations and considerably reduced the hh index and the rmses the calibrated model performance improved compared to the model results obtained using the default c ds value c ds 2 36e 5 it has been observed that the average error obtained at all buoy measurements is good and in line with the previous implemented model in the mediterranean sea amarouche et al 2019 mentaschi et al 2015 the correlation coefficient average of all used buoys is 0 92 with a minimum hh index average of 0 23 a minimum rmse average of 0 24 m and a bias of 0 02 m using a c ds 0 8e 5 table 2 however for the swh exceeding the threshold using a c ds coefficient of 0 8e 5 we obtain a negative bias average of 0 19 m and the minimum positive average bias of 0 03 is obtained using a c ds 0 5e 5 fig 4 with an optimum hh index average of 0 16 an rmse average of 0 42 m table 2 rmse bias and hh index plots fig 4 show the results obtained in all buoys for all swh and swh exceeding the threshold the variation in hh index and rmse using c ds 0 8e 5 or c ds 0 5e 5 is low however the bias increases by decreasing the c ds values leading to overestimating the whole measurements and correcting the extreme swh a minimum bias is observed for swh exceeding the wave storm threshold using a c ds 0 5e 5 at most buoy locations see fig 4 although the c ds value is low a negative bias of 0 38 m is observed for swh swh threshold at the la revellata buoy b18 fig 4 this buoy is located on the north coast of corsica exposed to the north and northwest wind and waves according to davison et al 2019 era5 wind speed is highly underestimated in the ligurian sea off la revellata buoy b18 the highest underestimation of swh in b18 can be explained by an underestimation in era5 wind speed this buoy location is characterised by complex bathymetry and a complex orography where land fall of weather systems is hard to model sempreviva et al 2010 in view of the purpose of this study the wave hindcast database was developed using a c ds 0 5e 5 to ensure an accurate estimation of wave storm events the model performance remains good for the whole data with an hh index average equal to 0 25 an average rmse of 0 31 m and a mean bias 0 12 m 3 2 wave hindcast accuracy assessment it was considered essential to evaluate the accuracy of the wave hindcast data used to characterise wave storm events over an extended period exceeding ten years the results of the present study focus on ten year variations in wave storms the long term validation of the hindcast data is performed against wave buoy measurements table 1 for a minimum period of approximately 13 years fig 2 the statistical error measures used to evaluate the wave hindcasts accuracy are the same used during the calibration the obtained results presented in table 3 show good accuracy of the wave hindcast considering all simulated swh with an average correlation coefficient of 0 89 a mean hh index of 0 28 a mean rmse of 0 38 m and a mean bias of 0 17 m regarding the error statistics obtained for the swh exceeding the wave storms threshold a lower average correlation coefficient of 0 68 has been observed which can be explained by the considerable difference in the number of data realisations from the hindcast compared to the total measurements table 3 the observations of swh exceeding the threshold do not exceed 5 of the entire observations in all case and only refer to the extreme s events thus a good accuracy of swh exceeding the threshold is noticed with an average hh index of 0 16 an average bias of 0 16 m and an rmse average of 0 5 m the bias values are positive at all buoys and the highest biases of 0 17 m and 0 18 m are observed in b2 and b3 successively as noticed during the calibration the minimum bias obtained for swh exceeding the threshold fig 4 was also positive in all validation buoys b2 b5 b11 and the highest biases of 0 13 m and 0 10 m are observed as well in b2 and b3 fig 4 it is worth noticing that higher errors statistics are observed at the valencia b5 and tarragona buoys b4 these two buoys are located in the balearic basin where the highest errors statistics of era5 wind speed are present davison et al 2019 nerveless by referring to figs 5 and 6 and table 4 in which we compare the wave storm events from the wave hindcast and the wave storm events characterised on buoys measurements we observe a good accuracy in the estimated wave storms at all buoy locations a maximum bias of 0 28 m is observed in b2 almeria for the mean swh of all storm events fig 5 and a maximum bias of 0 22 m is observed in b11 burger for the maximum swh of all storm events fig 6 regarding the number of events table 4 a maximum difference of 14 events is shown in buoy b1 corresponding to a maximum difference of 8 the sensitivity of the present study which aims to discuss the variation of wave storms often responsible for damages in coastal areas and maritime transport requires careful consideration of wave hindcasts accuracy the errors statistic presented in this section allows a better appreciation of the findings reported in the present study 3 3 decadal recurrence of wave storm events based on the identified wave storm events during the 40 year period mapped for each decade fig 7 a decadal variation is shown in several locations and no continuous increase or decrease in storm events number can be observed from the maps and the local results table 5 the highest wave storm events are mainly observed in the north part of the western mediterranean basin which can be linked to extra tropical cyclone activity which is more critical in this area nissen et al 2010 sempreviva et al 2010 the highest number of wave storm events occurred during the second decade 1990 1999 in the european part and the lowest number during the third decade 2000 2010 during the last decade 2011 2019 an increase in wave storm events can be observed in the algerian basin s6 and s10 and the southern part of the tyrrhenian basin s12 thus the estimated wave storm numbers during the last decade remained closer to those observed during the first and second analysed decades in large parts of the basin in the balearic basin s5 in the western part of the alboran basin s1 and in the spanish coasts of east orientation a decrease in the estimated wave storm events has been observed during the last decade the decrease that these areas experienced can be related to the decrease in the eastern wave storm events almost generated by the levant wind as presented in the results of the following section 3 4 decadal variations in wave storm directions the wave storm direction is evaluated by considering the mean wave direction during the respective wave storm events the recurrence of each occurred direction is computed in all the analysed grid points wave storm events were classified in eight direction bins and the frequencies of occurrence corresponding to each bin are mapped separately for each decade figs 8 and 9 the illustrated maps show the dominant and more prevalent wave storm directions in the west mediterranean sea and the respective decadal changes in each area the variation in dominated direction is very low between the fourth decades however we can notice this variation in several locations from an overall view the result allows the classification of the west mediterranean sea in ten areas based on storm wave directions the eastern part of the balearic basin dominated by winds from the east sector which can be linked to the levante winds the south western part of the algerian basin dominated by wave storms from the western sector which can be connected to the ponente and vendavel winds the north western part of the algerian basin dominated by wave storms from the south western sector the south eastern zone of the algerian basin dominated by wave storms from the northern north western and western sectors associated with the tramontane mistral and ponente winds the western balearic basin dominated by wave storms of the north eastern sector which levante winds can generate the western zone of sardinia dominated by wave storms from the north western sectors that the mistral or the tramontane winds can induce the west and north zone of corsica dominated by western and south western wave storms respectively possibly linked to the libeccio wind that dominates this region the north eastern tyrrhenian basin dominated by wave storms from the south west and southern sectors which can be generated by libeccio winds and possibly by sirocco winds the south part of the tyrrhenian basin is dominated by wave storms from the western and north west sectors and near the southwest coast of france the dominant wave storms are mainly from the southern and south western sectors which can be linked to the marin winds during the last two decades and in the locations s1 s3and s4 we observe a gradual increase of storm events from west sectors and a gradual decrease of storm events from east sectors figs 8 10 in the se part of the balearic basin off the valencian coast s5 the dominated storm events are from the ne sector and a low change in wave storm directions can be observed in this area in the centre part of the algerian basin s6 we observe a gradual increase of storm events from the west sectors during the last four decades with a decrease in storm events from the n ne e w sectors mainly during the last two decades however in the eastern part of the algerian basin s10 we noticed a cyclical decadal variation with an increase in western wave storms during the second and the last decades and a decrease in the nw wave storms recurrences in the same periods in the centre part of the west mediterranean sea s8 between the algerian and provencal basins a gradual change in wave storm direction is observed during the last four decades with a decrease in the dominated storm events from n sectors and an increase in storm events from sw w and nw sectors thus in the provencal basin a low change in the dominant wave storm directions can be observed at location s7 a dominance of n wave storms is clearly noticed and during the last decade further increase in the n wave storms recurrences is seen fig 10 off the west coast of france the results presented at s9 location show an increasing trend of the dominated wave storm events from west sectors and a decrease in wave storms from east sectors unlike a large area of the western mediterranean basin the northern part of the tyrrhenian basin is affected by wave storms coming from all directions in this area the main decadal variation in the wave storm directions recurrence is noticed for the most predominant directions south a cyclical decadal variation with a decrease in the second and the last decade of wave storms from south sectors followed by an increase of sw wave storms in the second decade and a notable increase of se wave storm in the last decade in the southern part of the tyrrhenian basin the most dominated wave storms are from the west sectors and an increasing trend in wave storms from west sectors has been observed during the last three decades according to the results the most critical observation is that a large area of the west mediterranean has been experiencing a gradual increasing change during the last three decades in wave storm recurrences from the west sectors at s1 s3 s6 s8 s10 and s12 3 5 decadal variation in wave storm duration the duration of wave storm events is an essential parameter in defining storm intensity as the duration increases so does the coastal risk dolan and davis 1992 according to mendoza and jiménez 2005 wave storm duration was considered the key quantitative parameter for predicting the eroded volume amounts during wave storms in catalonia here the duration of each wave storm event that occurred during the last 40 years was determined thus the average and maximum wave storm durations were calculated on a decadal scale and mapped in figs 11 and 12 the results depict the decadal spatial variations of mean and maximum wave storm durations in the west mediterranean sea for a more precise assessment of the quantitative decadal variations the discussion is supported by the local numerical results extracted from the 12 reference locations fig 3 and presented in table 5 in the maps corresponding to the first three analysed decades fig 11 the area experiencing a significant change compared to the results of the last decade 2010 2019 are indicated through a student s t test for a confidence level of 95 and highlighted for both positive red and negative blue significant changes fig 11 thus the probabilities p value of no change in the inter decade averages are presented in table 6 for the twelve reference locations fig 3 the same presentations of the statistical t test results are applied for the other storm characteristics shown in the following sections according to the results in fig 11 a notable spatial variation on the decadal scale can be observed the main changes in decadal wave storm duration are observed during the last decade where an increase in the mean duration of wave storms is observed in the algerian basin in the balearic basin in the eastern coast of the alboran basin in the west part of the provencal basin and in the eastern coast of corsica these observed changes are significant during the last decade in a considerable part of these locations compared to the first and second decades however compared to the 3rd decade 2000 2009 changes are less significant this may explain that the observed changes in these zones have already started to appear over the last two decades by referring to the results presented in table 5 concerning 12 offshore locations of references fig 3 we notice that the highest values of mean wave storm duration are observed during the last decade in 9 locations s2 s8 s10 and s11 table 5 an increasing change can be observed during the last three decades in the algerian basin s4 s6 s8 and s10 in the east alboran basin s3 and in the balearic basin s5 where a gradual increase in western wave storm recurrence was observed s3 s4 s6 s8 and s10 however the changes are only significant in s3 and s5 between the first and last decades and stations s3 and s4 between the 2nd and the last decade table 6 by referring to the mapped results fig 11 it can be observed that most areas that are experiencing a significant increasing change are located near to the coasts as well as locations s3 s4 and s5 fig 3 where significant change was observed table 6 during the last two decades we can observe a significant decrease in wave storm duration average in the east coast of france in the coasts of corsica and in the south part of the tyrrhenian basin the highest value of storm wave duration in the east coast of france s9 and the southern part of the tyrrhenian basin s12 occurred during the first decade 1980 1989 concerning the decadal variations of the maximum wave storm duration the results fig 12 and table 5 are in agreement with that of the average wave storm durations in the algerian the balearic the alboran and the west part of the provencal basins the maximum storm durations were observed during the last decade s4 s6 s8 and s10 in the ligurian basin in the east coasts of the tyrrhenian basin and the sw coasts of palma island the maximum durations are observed during the first decade 1980 1989 the highest durations of wave storm events are mainly observed during the first 1980 1989 and the last decade 2010 2019 3 6 decadal variation in swh during wave storm events the mean and the maximum swh during wave storm events were determined and evaluated on a decadal scale the maps presented in figs 13 and 14 show the spatial distribution of the mean and maximum swh during wave storm events and the corresponding decadal variations during the last four decades according to these maps it can be seen that the spatial distribution of the mean swh during wave storm events is very similar to the spatial distribution of total long term mean swh mapped by amarouche et al 2020a this may be explained by the significant contribution of wave storms to the swh total average by comparing the maximum and mean swh during wave storm events we can notice the difference in the spatial and temporal distributions of these two parameters thus concerning their respective decadal variations we observe that the mean swh has experienced a very low variation during the last four decades however it is statistically significant in different locations the maximum significant change between the lowest mean swh and the highest mean swh between all decades in the 12 locations table 5 is 0 12 m observed in the location s7 in the west part of the provencal basin a significant decrease was observed as well in station s3 between the first and second decades regarding the maps in fig 13 we noticed that the decadal change in swh is different compared to decadal changes in wave storm duration with respect to the last decadal period we observe significant decreases in swh compared to the first and second decades in some balearic coasts fig 13 in the eastern coasts of france in the western coasts of sardinia in the southern provencal basin in several portions of the algerian coast and the north tunisian coasts on the other hand significant positive changes are observed in the southern coasts of the alboran basin in the western coasts of france in the eastern provencal basin off begur coast and some italian coasts only the western coast of algeria oran experienced a significant positive change in both swh fig 13 and wave storm duration fig 11 on the other hand the decadal and spatial variation of the maximum swh during wave storm events is more critical and considerably different than the decadal variations in the mean swh the variations in the maximum swh are not correlated with variations in the mean swh except in the alboran and tyrrhenian basins the highest values of maximum swh are observed in the first decade 1980 1989 in almost all the west mediterranean sea fig 14 in the eastern coast of algeria the maximum swh is estimated between 1999 and 2009 3 7 the intensity of wave storm events the intensity of the wave storms is illustrated by the spi and tswe indices the decadal variations in these two parameters mean and maximum values are mapped in figs 15 to 18 these maps show a similarity in the spatial distribution of two parameters knowing that the wave period is the only parameter that differs between them this result allows us to estimate that the wave period is unlikely to significantly influence the spatial and decadal variations of the wave storm intensity the maps in figs 15 and 17 showing decadal variations of the mean tswe and mean spi respectively allow us to observe a decadal variation in the european and eastern african coasts the lowest wave storm intensity average is observed from 1990 to 1999 since then an increase has been observed in the provencal basin the balearic coasts the algerian coasts and the alboran basin concerning the last decadal period the increase in the twse and spi averages compared to the first and second decades are relevant in the spanish balearic coast in the east part of the alboran basin in the eastern coast of corsica and some italian coast figs 15 and 17 the local results presented in table 5 show the changes in the spi and tswe averages during the last decade the maximum value of spi and twse averages is observed during the last decade in nine locations s2 s8 s10 and s11 as well as the maximum wave storm duration averages however considering a confidence level of 90 table 6 significant changes in spi and twse are only observed in s2 s3 s11 positive change and in s12 negative change the areas expecting a significant change in the last decade are located near the coast and are less important in the balearic basin compared to the area experiencing a significant change in storm wave duration figs 15 and 17 comparing these results figs 15 and 17 to those of swh fig 13 some locations in the spanish coast experiencing a significant decreasing change in swh during the last decade fig 13 have experienced an increasing change in both storm wave duration fig 11 and storm intensity spi and twse the decadal variations in spi and tswe are more likely dependent on variations in durations of wave storm events except in the southern coast of the alboran basin where significant increasing change was observed both for swh and duration averages of the wave storm events regarding the decadal variations in the maximum values figs 16 and 18 a similarity is also observed in the spatial distribution of the maximum spi the maximum storm intensity has been recorded during the last decade in the algerian balearic the provençal and eastern alboran basins however in the tyrrhenian basin the highest storm intensity is recorded during the first two decades these results are strongly correlated with the results of the maximum wave storm duration fig 12 and it is also noted that the storms corresponding to the most extended duration are not particularly the storms in which the maximum swh was recorded referring to the results of the maximum swh during the storms fig 14 4 discussion according to lionello et al 2006 the mediterranean region s morphological geographical historical and societal characteristics reveal a scientific interest in studying its climate in the last decade several studies have shown a considerable change in wave climate and storm intensity in several regions casas prat and sierra 2010 gulev 2004 keim et al 2004 komar and allan 2008 reguero et al 2019 ruggiero et al 2010 vieira et al 2020 including the mediterranean sea amarouche et al 2021 meucci et al 2020 young and ribal 2019 yuchun and leo 2020 shimura et al 2015 found that the change in wave climate has considerable sensitivity to the change in sea surface temperature hence to the global warming effect thus the climate in the mediterranean region is primarily influenced by global patterns lionello and scarascia 2020 as mentioned earlier most studies on wave climate variations are based on the swh trend the results obtained in the present study are focused on the interdecadal changes of the wave storm characteristics in the western mediterranean interests in assessing changes in wave storms include the fact that wave storms are considered a robust climate indicator of the state of coastal areas sánchez arcilla et al 2011 wave storm events are often responsible for coastal erosion and coastal inundation events bosom and jiménez 2011 recently wave storms have caused enormous damage in the mediterranean sea on the algerian spanish french and italian coasts amarouche et al 2020b amores et al 2020 biolchi et al 2019 cavaleri et al 2019 in january 2015 an extreme wave storm was responsible for significant erosion resulting in the loss of more than 15 000 m2 of a beach area and the destruction of two coastal buildings in the eastern part of the capital algiers amarouche et al 2020b in october 2018 the storm adrian was responsible for more than two billion euros of damages biolchi et al 2019 across the mediterranean sea in january 2020 storm gloria was responsible for the damage in several coastal infrastructures and intense coastal erosion corresponding to immediate economic losses of several millions of euros amores et al 2020 coastal storm events can considerably affect the economy and the policy of the countries besides the coastal risk resulting from these wave storms the merchant navy and harbour activities can also be affected by wave storms knowledge of the weather conditions in which ships operate is a crucial element to be considered in order to increase safety and avoid risks related to wave storms vettor and guedes soares 2016 the assessment of wave storm regimes and monitoring of wave storm variations can constitute necessary decisional support for developing offshore and coastal zone policies and ensuring sustainable development and facing the global warming issue the damages recorded during storm events depend on swh wave storm directions in respect to the shoreline wave storm duration and storm surge the results obtained in this study provide an insight into understanding the wave and storm regime in the western mediterranean basin the results show a significant decadal change in wave storm characteristics in several locations in the west mediterranean sea during the last decade compared to the first 1980 1989 and second 1990 1999 ones a significant increase in wave storm intensities and wave storm durations are observed in the alboran basin in the eastern coast of the balearic basin in the eastern coast of corsica and several parts of the italian coast thus a significant decrease is observed at the coast of monaco and on the north shore of corsica in these last two locations a considerable increase in swh during wave storms is estimated during the last decade fig 13 comparing the results of the last decade 2010 2019 to those of the 3rd decade 2000 2009 we also noticed a significant increasing change in the eastern part of the albertan basin the southern coast of the alboran basin is the unique area where significant increasing changes in both swh and wave storm duration are estimated figs 11 and 13 on the other hand an increase in the recurrence of wave storm events from western sectors is noticed figs 8 10 in the alboran basin s1 s2 and the west part of the algerian basin s3 s4 and s6 a possible link between the recurrence increases in wave storm events from western sectors and the increases in the average wave storm duration and intensity can be highlighted see table 5 and fig 10 regarding the decadal change in spi and tswe averages and their spatial distribution figs 15 to 17 we notice that the wave storm intensities are more dependent on the change in storm durations figs 11 and 12 and the increasing annual trend in storm intensity reported in amarouche and akpınar 2021 can be more linked to an annual trend in wave storm durations the result of the maximum wave storm duration fig 12 maximum swh during wave storms fig 14 spi fig 16 and twse fig 18 also show a dependence of both spatial and decadal variations in maximum storm intensities on maximum storm durations the changes in the wave storm directions and wave storm durations can be at the origin of the increases in the wave storm damage observed in the west mediterranean sea reported in amarouche et al 2020b amores et al 2020 cavaleri et al 2019 jiménez et al 2012 the locations experiencing a relevant change in wave storm intensity such as the eastern part of the alboran basin oran coast and the western coast of the balearic basin valencia coast require particular consideration to manage the risks regarding the increase in wave storm intensity the recent wave storm gloria occurred in january 2020 was responsible for considerable damages in the spanish coasts amores et al 2020 where a significant decadal change was estimated in the present study fig 15 noting that the year 2020 was not considered in the analysis the development of a wave storm database and the results presented in this study may allow the classification of wave storm events in terms of direction swh and duration thus an assessment of wave storm links to different global and regional climate patterns may contribute to a deeper understanding of wave storm regimes in the western mediterranean sea and the origins of the decadal wave climate changes according to lionello and galati 2008 several mid latitude climate patterns are linked to the swh in the mediterranean sea mainly the east atlantic west russia pattern ea wr the scandinavia pattern sca the east atlantic pattern ea and even the nao pattern the nao was also linked to the cyclones causing wind storms in the mediterranean sea nissen et al 2010 it was found that both the nao and ea wr patterns are positively related to an increase in the recurrence of strong winds in the western mediterranean sea during their positive phase nissen et al 2010 a focused study on identifying teleconnection patterns tlc associated with wave storms events in the western mediterranean sea may provide an insight into the effect of global and inter regional climate change on the observed increase in wave storm intensities in the western mediterranean sea 5 conclusion this study presented an assessment of the wave storm regime in the west mediterranean sea over the last four decades wave storm events that occurred between 1980 and 2019 were characterised based on swh wave storm duration and wave storm direction the spi and tswe were computed for each storm event wave storm events were defined as a sea state during which swh exceeds a swh threshold calculated according to the local wave climate of each location the decadal variation in wave storm events numbers and decadal variation in wave storm characteristics and intensity were analysed the results obtained here allow us to conclude that wave storm events experienced a substantial change at the decadal scale in terms of their recurrence and characteristics in the west mediterranean sea at the spatial scale the observed decadal variations are different in each sub basin during the last decades several parts of the west mediterranean basin have experienced significant changes in wave storm intensity linked to an increase in wave storm durations these relevant increases are mainly observed in the eastern part of the alboran basin on the eastern coast of corsica and in the balearic basin a non significant increase is also observed in the east part of the algerian and the provencal basins over the last decade changes in storm intensity are more dependent on the changes in storm duration than on the changes in swh and can also be related to variations in the wave storm directions therefore it is recommended to consider wave storm duration and direction for coastal and offshore risk assessment and wave climate trend analysis consideration of wave storm characteristics can be recommended for future climate projection studies to estimate the likely future changes in wave storm intensities based on different climate change scenarios observed changes in wave storm patterns can constitute a substantial risk in several coastal areas in the west mediterranean sea the changes in wave storm regime reported during the present study may provide potential support for evaluating the likely impact related to global warming at a regional scale this decision support can be considered in the development of coastal management policies to ensure sustainable development in the coastal area and prevent the damages related to the increases in the wave storm recurrence and intensity credit authorship contribution statement khalid amarouche writing original draft methodology conceptualization software validation formal analysis writing review editing data curation adem akpınar conceptualization methodology writing review editing investigation resources alvaro semedo supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements weacknowledge the european centre for medium range weather forecasts ecmwf for providing wind data through the official website of the copernicus climate change service c3s climate date store we acknowledge as well copernicus marine environment monitoring service cmems for providing wave observations and we acknowledge the general bathymetric chart of the oceans gebco for providing the bathymetry data funding the authors did not receive support from any organisation for the submitted work appendix a 1 definitions of statistical error parameters wave hindcast data accuracy was evaluated using standard error statistics the root means square error rmse bias correlation coefficient r and a normalised root mean square error hh index introduced by hanna and heinold 1985 and used and recommended for wave model assessment by mentaschi et al 2013 these parameters are computed as follows a 1 r m s e 1 n i 1 n p i o i 2 1 2 a 2 b i a s p o a 3 r i 1 n p i p o i o i 1 n p i p 2 i 1 n o i o 2 1 2 a 4 h h i 1 n p i o i 2 i 1 n p i x o i where o i is the observed value o is the mean value of the observed data p i is the predicted value p is the mean value of the predicted data and n is the total number of data 
23862,we introduce the effects of self attraction and loading sal to the momentum equations of a barotropic global ocean tide model as well as a baroclinic general circulation model we show for the m 2 tidal dynamics that an explicit treatment of sal is favourable compared to a scalar approximation or even disregarding the effects all together for the general circulation the influence on the ocean bottom pressure is shown to be about 1 hpa for short time periods along the coasts and about 0 5 hpa for longer periods in resonant basins in the southern ocean in contrast to previous studies we additionally examine the effects of surface pressure anomalies over the continents in the computation of sal which is shown to have an influence of about 0 5 hpa along the coasts with those results we demonstrate that the explicit treatment of sal is important for satellite applications keywords self attraction ocean loading barotropic tides tidal equations oceanic general circulation primitive equations 1 introduction the earth is not a rigid body but is deforming in response to both internal and external forces on various time scales deformations are accompanied with a redistribution of masses within the solid earth that modify the earth s external gravity field water mass distributions that deviate from the geoid cause a redistribution of mass within the solid earth accompanied by a horizontal movement of water masses due to changes in the earth s gravity field together with the self gravitation of water masses these effects are commonly referred to as the self attraction and loading sal feedback to ocean dynamics sal were first identified to be important for the evolution of sea level over the last glacial cycle farrell 1972 accumulation of ice on the continents reduced the amount of water in the oceans and led to a global mean sea level more than 100 m lower than present day local relative sea level as measured with respect to the deforming solid earth however was found to deviate from the global mean and can be only explained by solving the so called sea level equation farrell and clark 1976 more recently continental surface mass estimates as obtained with the satellite missions grace tapley et al 2019 and grace fo landerer et al 2020 monitor the spatially variable barystatic sea level even with monthly temporal sampling tamisiea et al 2010 in all those applications it is implicitly and appropriately assumed that the ocean mass distribution adapts quasi instantaneously to the changes in the gravity field for mass distributions at diurnal time scales however this assumption is not valid global ocean tides are known to be affected by sal due to the delayed response to the rapidly varying forcing for a long time already henderschott 1972 farell 1973 whereas many simplifications have been tested in the past for the proper inclusion of sal effects into global numerical models e g accad and pekeris 1978 it is now widely accepted that the full effect of sal from solving the global convolution integral is required to meet the accuracy requirements of present day satellite missions ray 1998 while the influence on the high frequency non tidal dynamics is also undisputed stepanov and hughes 2004 it has received far less attention previous studies vinogradova et al 2010 riva et al 2010 have focussed on longer time scales whereas the impact on the high frequency ocean dynamics which is especially relevant for satellite gravimetry schindelegger et al 2021 will be the focus of this study in the present paper we will briefly highlight the theory for calculating the sal potential section 2 next we describe the numerical implementation of the sal feedback into a global ocean tide model based on the shallow water equations section 3 as well as into a global general ocean circulation model based on the primitive equations section 4 where we also discuss the influence of including surface pressure anomalies over land in the sal contribution as well as the influence of the mean ocean bottom pressure obp field results will be presented for both simulations of ocean tidal dynamics as well as for the non tidal ocean circulation the article closes with a summary and a discussion on the relevance of sal feedbacks for satellite applications section 5 for completeness we note that gregory et al 2019 recently suggested to summarize the feedback of self attraction and loading on ocean dynamics under the more generic name gravity rotation and deformation grd we note that rotational feedbacks are not considered in this study and are certainly also not relevant for inclusion into numerical ocean models due to the rather slow variations in both the position of the pole and the rotational rate of the earth in order to avoid confusion by introducing a name that prominently includes rotation which is never considered in our article we decided to use the term sal 2 self attraction and loading we start with the theoretical formulation for sal which forms the basis of the implementations into both ocean models the formulation is based on deriving an additional potential term which describes the additional gravitational potential due to an anomalous water mass on a spherical shell as well as the effect of the elastic deformation of the solid earth the potential at a point p is here given by kuhlmann et al 2011 1 v p n 0 m n 1 k n h n α n p b n m p α n 3 ρ e 2 n 1 this description relies on the decomposition of ocean bottom pressure anomalies into spherical harmonics p b n m the pressure values over the continents can either be set to zero or as in the case for non tidal simulations also include atmospheric surface pressure anomalies section 4 2 the inclusion of the elastic deformation of the sea floor as well as the subsequent change in the gravitational potential of the earth are described by the love numbers h n k n munk and macdonald 1960 for which we use data given by wang et al 2012 based on the prem model of the solid earth ρ e is defined as the average density of the earth as the full implementation of sal requires significant computational overhead due to the decomposition into spherical harmonics in each time step different approximations have been suggested in the past most notably accad and pekeris 1978 proposed neglecting the degree dependence in eq 1 and using only a single term of the series this implies the assumption that the sal effects are dominated by a specific spatial scale the spherical harmonic expansion of the p b n field is then superfluous and eq 1 simplifies to 2 v p β α 0 p b the approximation is named β approximation and is also implemented and tested in the following 3 barotropic tidal modelling the barotropic ocean tide model time tidal model forced by ephemerides used in this study was initially developed in hamburg germany zahel 1977 1978 since then time has been constantly developed seiler 1991 thomas and sündermann 1999 weis et al 2008 and was upgraded most recently by adding dissipation mechanisms refining numerical grids and updating the bathymetric map sulzbach et al 2021 in the following we give a short introduction to the theory of tides and the employed validation metrices and introduce the model specifications finally we present simulation results with respect to the influence of sal for a selection of partial tides and show that while the importance of considering the full sal forcing is smaller for long period tides it cannot be neglected to achieve high accuracy results 3 1 tidal excitation and validation metrics astronomical tides are excited by the periodically varying gravitational attraction of celestial bodies primarily the sun and moon the resulting lunisolar tide raising potential v t i d t ϕ λ that is also influenced by the solid earth response to tidal forces body tides henderschott 1972 can be decomposed in time into a set of so called partial tide potentials v i t ϕ λ that oscillate at discrete frequencies ω i and exhibit spatial patterns that follow the real valued spherical harmonics y n m as given by hartmann and wenzel 1994 1995 the individual partial tide frequencies hereby relate to characteristics of the dynamics of celestial bodies and can be described in terms of the 6 digit doodson numbers doodson 1921 the time dependent horizontal gradients of v i induce harmonic barotropic forces that excite ocean tide dynamics oscillating at the given frequency the obtained partial tide response patterns hereby depend on the respective tidal frequency ω i the degree n and order m of the respective exciting spherical harmonic potential and less strongly on the excitation amplitude v i 0 to validate the numerical results obtained with a tidal model we will focus on the induced oscillations of the free ocean surface 3 ζ i t ϕ λ ζ c o s ω i cos ω i t ζ s i n ω i sin ω i t nonlin that contain minor constant and higher frequency components as the result of weakly non linear processes that are ignored in the following thus a partial tide can be entirely specified by the complex elevation function ζ i ζ c o s ω i i ζ s i n ω i tidal elevations simulated in this study will be compared to the data constrained tidal model fes14 lyard et al 2006 updated by evaluating the respective mean deviation in terms of the root mean square averaged over one tidal period 4 rms ζ 1 i ζ 2 i 1 2 ζ 1 i x ζ 2 i x 2 this value can further be averaged over a defined oceanic domain d o by evaluating 5 rms ζ 1 i ζ 2 i a o 1 j k d o a j k r m s ζ 1 i ζ 2 i j k 2 where a j k are surface elements that add up to the surface of the considered domain a o j k d o a j k we distinguish between deep shallow limit h 1000 m and polar non polar limit ϕ 6 6 areas to build four distinct oceanic domains this choice allows to focus on areas that can be optimally captured by altimetry constrained models non polar ocean or purely hydrodynamic models deep ocean further we compare the results to the ground truth of tide gauge stations tg by averaging over a set of n t g 151 stations compiled by ray 2013 where we evaluate eq 5 by averaging the rms obtained at the individual gauges a j k a n 1 a 0 n t g the derived metrics can be used to quantify the model performance we will predominantly relate to the here defined deep non polar metric that comprises over 80 of the ocean surface 3 2 shallow water equations tidal dynamics are calculated by integrating the non linear shallow water equations e g pekeris 1974 schwiderski 1980 6 t v f v v v g ζ v i v d 7 t ζ h ζ v employing a temporal finite difference scheme backhaus 1985 spanned on a global ϕ λ grid at 1 12 resolution the barotropic ocean state is described by ζ i v i ζ i where ζ i is the free surface elevations and v i is the barotropic flow velocity additional parameters are the coriolis vector f 2 ω sin ϕ the bathymetric function h λ ϕ and the mean surface gravity g 9 80665 m s 2 the tidal excitation in the here employed partial tide mode is induced by astronomical forces proportional to v i as well as by sal forcing v the full sal effect is included by decomposing the surface mass density into spherical harmonics up to a certain maximum degree and order l m a x evaluating eq 1 the in terms of spherical harmonic functions computed sal potential is then subsequently transformed back into the spatial domain before application in the model the computational burden is thus shifted to transforming information between spectral and spatial domain since this is efficiently handled by the shtns package schaeffer 2013 the computation time increases only moderately by 15 for each time step alternatively it is possible to employ the β parametrization discussed above time possesses three dissipation mechanisms summarized by 8 d r h v v a h r ˆ v κ h ℂ v this includes the quadratic bottom friction term with friction coefficient r 0 003 linear wavedrag dissipation introduced by the nycander tensor ℂ nycander 2005 and a tuning coefficient κ as well as a linearly parameterized horizontal eddy viscosity scheme proportional to coefficient a h where r ˆ is a partial differential operator acting on v that is defined in sulzbach et al 2021 while sea ice is not considered in the model we note that cavities under the antarctic ice shelf are included in the spatial domain of the simulations 3 3 simulation results we employ model settings that were found to result in very accurate results for multiple partial tides a h 2 1 0 4 m 2 s κ 1 25 rtopo2 bathymetry arg chi grid sulzbach et al 2021 several experiments are performed individually for three different partial tides from the semi diurnal m 2 diurnal k 1 and long period tidal band m f the k 1 and m 2 experiments are initialized for 30 days when tidal elevations have equilibrated well below a precision of 1 mm compare e g schindelegger et al 2018 as in this situation the sea surface dynamics can be precisely described by eq 3 only the last simulated period is used to extract the respective partial tide the first overtide and a residual constant component as a consequence of tidal rectification the m f run is spun up for 2 complete periods where the constituents were derived by the following third period the time step is set to 1 240 m 2 1 480 k 1 1 6720 m f of the respective tidal period yielding numerical values of close to 180 s in each case a first simulation includes the full sal effect by evaluating equation 1 up to d o 1024 which is a sufficient degree to resolve the sal effect to a sub mm level in the open ocean schindelegger et al 2018 additional experiments employ the β parametrization at various values β where β 0 corresponds to entirely ignoring dynamical feedback by sal table 1 summarizes the validation results for several domains for the three experiments and fig 1 shows deviations in between individual solutions for m 2 m 2 tide considering the full sal effect for the main lunar m 2 tide leads to a non polar open ocean rms of 3 39 cm sulzbach et al 2021 the consideration of the β 0 1 parametrization leads to a strong increase of this value 60 and a complete neglection is even more fatal to accuracy 576 rms values for shallow and or polar regions show similar tendencies but the accuracy drop in shallow water areas is smaller due to time s generally worse performance in shelf seas k 1 tide repeating the same experimental setup leads to an increase in rms of 42 379 when setting β 0 1 0 further experiments were conducted for β 0 07 0 13 yielding worsened open ocean rms values in comparison to β 0 1 while this proves the default setting β 0 1 as robust concerning open ocean dynamics of diurnal tides the shallow non polar rms increase was lowest when setting β 0 07 18 while β 0 13 77 even worsened the results compared to neglecting the effect completely 57 values for non polar areas this can be explained by considering the typical scales of oscillation systems in shelf areas in comparison to the open ocean since this scale is much smaller tidal loads on contra phasic points influence each other by partially annihilating the effect of the load this results in locally diminished values of the β parametrization m f tide having a half monthly period the m f oscillation system is less dynamic and much closer to an equilibrium tide description nevertheless the non polar open ocean rms increases by 117 233 when parametrizing sal as β 0 1 0 this increase is similar for global ocean dynamics but much more moderate than the impact obtained for semi diurnal and diurnal tides the results indicate that a full representation of the sal effect is necessary to obtain the highest accuracy results for all considered tidal species that exhibit periods in the range from 12 h and 14 d hereby the impact decreased for lower oscillation frequencies this points to the decreasing dynamic feedback of sal back into tidal dynamics that ultimately leads to consideration of the self consistent equilibrium tide where dynamic feedback is fully suppressed further the larger scales of the amphidromic systems for k 1 and m f that by far extend the near field effects of loading greens function improve the accuracy of the β approximation in the open ocean 4 primitive equations the dynamic feedback of sal has been newly introduced also into the max planck institute for meteorology ocean model mpiom jungclaus et al 2013 which is a direct descendant of the hamburg ocean primitive equation model hope drijfhout et al 1996 wolff et al 1997 mpiom is a free surface general circulation model that solves the primitive equations under the hydrostatic and boussinesq approximations marsland et al 2003 the model is discretized horizontally on an arakawa c grid and vertically on a z grid the atmospheric forcing includes wind stress heat and freshwater fluxes and optionally also atmospheric surface pressure lunisolar gravitational tidal forcing thomas et al 2001 can be additionally employed the ocean model includes both a dedicated sea ice model marsland et al 2003 as well as cavities underneath the antarctic shelf ice the full implementation of sal according to eq 1 is kept as close as possible to the implementation in time at every time step ocean bottom pressure anomalies oba are calculated with respect to a pre computed mean obp field the oba field is then remapped from mpioms internal tri polar grid to a 720 360 gaussian grid in preparation for the transformation to spherical harmonics shs for the sh transformation we utilize the shtns library by schaeffer 2013 and expand to d o 179 the calculation of the sal potential follows eq 1 before the back transformations into the spatial domain and to the internal mpiom grid are performed the gradient of the thus obtained additional potential is then applied in parallel although independently to mpioms tidal potential for the implementation of the scalar approximation the above described process is simplified significantly instead of the spatial and spectral transformations the oba field is used to compute the approximated potential according to eq 2 with a scalar factor of β 0 1 for this paper we utilize mpioms medium resolution tp10l40 configuration which uses a 1 0 tri polar grid horizontally with 40 vertical layers the model time step is set to 20 min the ocean model is spun up for 1000 years from 3d temperature and salinity climatologies levitus et al 2005 with cyclic atmospheric forcing with daily sampling röske 2005 following the spin up transient simulations are performed with hourly atmospheric forcing based on the ecmwf era5 re analysis hersbach et al 2020 including atmospheric pressure forcing hourly snapshot obp fields are generated as output regularly all experiments discussed below are two years long whereas only the last year will be analysed in the following 4 1 experiments with tidal forcing mpiom provides the option to simulate lunisolar gravitational tides for the benefit of studying non linear interactions among the general circulation and tidal dynamics thomas et al 2001 we use an experiment with mpiom under both atmospheric and gravitational forcing but isolate the signature of the m 2 by means of least squares adjustment from the hourly sampled bottom pressure fields for simplicity simulated sea surface height variations from time are converted in bottom pressure anomalies we here compare three model runs using either the full sal implementation according to eq 1 the scalar approximation according to eq 2 or no sal potential fig 2 shows the amplitudes of the complex differences for the m 2 constituent between the fullsal and nosal simulations left and between the fullsal and β sal simulations right performed with mpiom top a b and time bottom c d at a resolution of 1 2 for both mpiom and time the fullsal implementation produces complex differences of more than 50 hpa in regions with a large m 2 amplitude however while the results are qualitatively in good agreement the sal influence in mpiom is in these areas about 30 larger which might be related to the rather long time step in mpiom that is not well suited to represent rapid semi diurnal fluctuations comparing the influence of the scalar approximation compared to the full sal implementation fig 2 b and d shows that both mpiom and time produce a difference in amplitude of up to 15 hpa the largest differences are here confined to coastal areas such as the coral and celebes sea the sea of okhotsk and the south eastern pacific ocean in the open ocean the difference in complex amplitude between the two model runs reaches about 5 hpa as the choice of β in the scalar approximation signifies a predominance of a specific spatial scale a larger difference in coastal areas is to be expected according to ray 1998 and stepanov and hughes 2004 β 0 1 while being the best choice for a constant factor represents the influence of sal in shallower regions only poorly similar to the validation performed for the results obtained with time we here also validate the results for several domains for the m 2 results obtained from mpiom in table 2 the results for mpiom are computed analogously to the results from time considering the full sal effect for the main lunar m 2 tide leads to a reduction of the non polar open ocean rms from 25 87 to 10 88 cm which represents a reduction of about 58 for the shallow water areas the reduction in rms is reduced in a similar way to the results from time which is also connected to the generally worse performance in shelf areas we note however that the results obtained here are meant to demonstrate the implementation of sal in mpiom and are not to be compared to the results from time in terms of absolute values naturally mpiom is not able to compete with time when it comes to the simulation of tides which is of course also reflected in the rms values instead emphasis should be placed on the improvement obtained from the sal feedback within each model which suggests that similar improvements should also be visible in mpiom for non tidal dynamics 4 2 impact of sal on non tidal dynamics we also perform experiments with mpiom to investigate the effects of sal on the circulation we will focus on ocean bottom pressure first since this is the quantity most directly affected by sal the experiments differ in the treatment of sal and include either the full sal potential as given by eq 1 here labelled sal obp where the values over the continents are set to zero the full sal potential including contributions from surface pressure anomalies over land sal spobp the simplified sal potential as given by the scalar approximation of eq 2 β obp with β 0 1 or no sal contribution whatsoever nosal please note that gravitational tides are not simulated in those experiments and that the ocean response to atmospheric tides dobslaw and thomas 2005 has been removed from the time series of each experiment empirically the results are analysed by separating the oba time series into four frequency bands of 0 3 days 3 7 days 7 14 days and 14 60 days using 4th order butterworth filters longer frequencies will not contribute to potential aliasing effects for monthly gravity solutions in satellite gravimetry in fig 3 we show the variability of obp split into the aforementioned frequency bands with the sal spobp model run as a reference at the highest frequencies 0 3 days the variability predominantly consists of basin modes that are locally enhanced in various semi enclosed coastal regions spatial scales gradually reduce with longer periods and signals become more spatially variable signals in obp at the longest periods considered here are particularly pronounced in various resonant regions in the southern ocean e g indoaustralian basin bellingshausen basin where barotropic ocean dynamics are excited by the strong and rapidly varying westerly surface winds to isolate the effect of different sal aspects on obp variability we calculate standard deviation differences between model runs for each frequency band fig 4 shows the standard deviation differences of the sal spobp and nosal model runs for the high frequency band fig 4 a signals of up to 1 hpa are observed which is the strongest relative impact of sal for all frequency bands considered when compared to the background variability depicted in fig 3 these signals are mainly located in shelf coastal regions and coincide with regions of large obp variability for the intermediate frequency bands of 3 7 days and 7 14 days fig 4 b c the observed signals are reduced substantially and are well below 0 5 hpa a somewhat stronger sal influence is again observed for longer frequencies fig 4 d even though the background variability is stronger here as well while significant signals of up to 1 hpa are observed in certain shelf areas such as the gulf of thailand signals of up to and locally even exceeding 1 hpa are now found in large areas of the southern ocean mainly the kerguelen plateau and the bellingshausen sea as well as east of the drake passage these regions again correspond to areas in the region of the acc that are typically associated with large obp variability we also study the influence of the inclusion of surface pressure anomalies in the sal potential by comparing the results from the sal spobp and sal obp model runs in fig 5 as the two sal potential terms do not differ over the open ocean differences are to be expected mainly in coastal regions indeed fig 5 a shows almost no signal for the high frequency band suggesting that large scale surface pressure variability over the continents that attracts ocean water masses is not changing rapidly enough to have a notable impact on ocean dynamics the influence of the surface pressure anomalies increases for longer frequencies and is largest for the low frequency band fig 5 d here the difference reaches up to 0 5 hpa very close to the coast while for the open ocean the signal does not exceed 0 1 hpa we therefore conclude that continental surface pressure forcing has a rather minor impact on ocean dynamics but can nevertheless be rather easily incorporated into an ogcm fig 6 compares the sal obp and the β obp model runs and therefore the difference between the full sal potential and the scalar approximation for the high frequency band the differences are very localized in shelf areas and locally reach values over 1 hpa for the intermediate frequency bands the signals are significantly reduced the most prominent differences are observed for the low frequency band here values of up to and locally exceeding 2 hpa are reached in parts of the acc region these differences are not particularly localized to specific areas but cover most of the acc region we rate those differences as substantial and conclude that it would be advisable to drop the scalar approximation also for the simulation of sal feedback on the ocean circulation much in the same way as for the ocean tidal dynamics we also compare the influence of the scalar approximation to not including any sal contribution whatsoever in fig 7 for the high frequency band differences in coastal areas of more than 1 hpa are found in coastal areas while for the open ocean values reach up to 0 5 hpa for this frequency band results are thus comparable to the results shown for the full sal contribution in fig 4 a also for the intermediate frequencies figs 7 c d results are similar to the full sal contribution the largest signals are also here found for the low frequency band in the region of the acc where locally values exceed 2 hpa omitting sal completely would therefore compromise the simulation of the high frequency wind driven ocean circulation so that the incorporation of β sal is generally encouraged since it does not impose an additional numerical cost for precise simulations focusing on the transient wind driven dynamics as e g important for non tidal ocean de aliasing see dobslaw et al 2016 the full sal feedback should always be implemented 4 3 impact of the mean field all implementations of the sal effects discussed so far are based on pressure anomalies with respect to a long term mean the choice of the reference field in the computation of the anomalies can thus have an influence on the sal potential as errors in the computation or choice of the mean field can result in erroneous horizontal pressure gradients and associated accelerations to study the influence of the reference field we performed additional model runs with a poorly chosen obp reference field poorly chosen refers here to an obp mean field that is based on only a single month that is outside of the simulation period fig 8 a shows the standard deviation differences of obp between the normal sal obp model run and a sal obp model run with a poorly chosen mean obp reference field the results show that the influence of the mean field is mostly limited to the regions of high variability in the southern ocean on larger spatial scales the influence reaches about 20 pa while locally effects of over 50 pa are found the effect on other regions such as the coasts is negligible from the analysis in different frequency bands it is clear that the coastal influence if mostly found in the high frequency band 3 days we thus advise to always use a representative long term mean field but conclude that minor errors in the mean field will not induce erroneous feedbacks to the ocean dynamics additionally we study the influence of the reference obp field including the surface pressure over the continents similar to before the poorly chosen reference field consists of a mean field over one month that is not included in the simulation period only including the contribution of the surface pressure over land fig 8 b shows the comparison to the sal spobp model run the results when including the surface pressure anomalies are very similar to fig 8 a both in spatial distribution as well as magnitude indicating that a poorly chosen surface pressure reference field has a much smaller impact compared to the obp reference field 4 4 impact on overturning circulation as the implementation of the effects of sal are based on oba it is expected that the impact of sal on ocean dynamics vanishes for sufficiently long time periods in this section we want to show that the influence does indeed vanish and that there is no influence on the long term general circulation we do this within mpiom by comparing two long term simulations which are both performed for a period of 30 years one of which implements the full feedback from sal while the other has no sal enabled in fig 9 we show the influence of sal on the atlantic meridional overturning circulation amoc stream function on the left and the sea surface height on the right a d shows the 30 year mean in the amoc stream function sea surface height without any sal influence the difference of the long term mean between full sal and no sal feedback is shown in b and e respectively in c and f we show the difference in the linear trend for the two simulations comparing the difference between sal and nosal model runs to the long term mean fig 9 shows that the influence of sal is on the order of 1 although for most of the grid point even well below that the largest differences naturally occur in regions where the mean values themselves are largest looking at the long term linear trends the values are on the order of 0 001 per year in general the influence of sal does as expected vanish for periods which are sufficiently long as a consequence we note that while we recommend the implementation of sal for applications where the goal is an accurate representation of the high frequency variability in the ocean the recommendation does not extend to applications where low frequency effects are the main interest 5 summary and conclusions the feedback of self attraction and loading sal on ocean dynamics is a process that induces additional barotropic pressure gradient forces acting on the sea water it has therefore consequences for both tidal dynamics and also the non tidal barotropic circulation the impact of sal is strongest on the sub daily time scales and vanishes at longer periods where a quasi instantaneous adaptation of the sea water to the time variable external gravity field of the earth can be safely assumed sal is therefore important for the numerical simulations of the rapid and barotropic ocean mass variability only the sal feedback has been implemented for this study into two very different numerical codes employing the shallow water equations the time global ocean tide model and the primitive equations the mpiom general ocean circulation model numerical experiments with the barotropic tidal model time indicate that the implementation of the full non local effect of sal is crucial to enable high accuracy results for partial tides of semi diurnal diurnal and also long period character the tidal solutions further show that the importance of a full sal implementation is much higher for partial tides with shorter periods as their character is much more dynamic nonetheless the experiments confirm that a carefully tuned β approximation can capture a substantial fraction of the sal effect on tides and should be always favoured over completely neglecting the impacts of sal the results for m 2 based on the mpiom ogcm are qualitatively similar even though the sal influence is somewhat overestimated by up to 30 in various shelf regions with those comparisons we demonstrate that a sal implementation into an ogcm such as mpiom is both feasible in terms of numerical costs and also useable for routine simulations additional model experiments with mpiom were carried out to quantify the consequences of different options for the sal implementation on the simulated ocean bottom pressure sal has an influence on the variability of up to 1 hpa in coastal areas for short periods below 3 d while on longer periods an influence of up to 0 5 hpa is mainly confined to individual resonant basins in the southern ocean in line with previous results from vinogradova et al 2015 kuhlmann et al 2011 in extension to those previous studies we also include the effects of surface pressure anomalies on land in the computation of the sal potential which are shown to have an influence of up to 0 5 hpa along the coasts previous studies by schindelegger et al 2018 2021 compared obp estimates from daily grace gravity field time series with various ocean models aod1b rl06 dobslaw et al 2017 which is based on a very comparable mpiom configurations but does not include the effects of sal was shown to not sufficiently capture the obp variability in the grace solutions in regions of the southern ocean similarly bonin and save 2020 studied how well aod1b explains altimetric variances compared to grace solutions and identified similar regions for improvement in the southern ocean the results obtained in our present study indicate that including sal in the model simulations shows the largest influence on the obp variability in these regions and is thus expected to have a positive impact on the quality of the aod1b product and should be considered in a future release experiments with mpiom with the full sal feedback are currently being performed over several decades that can be readily tested as a new background model for satellite gravimetry credit authorship contribution statement linus shihora software investigation visualization writing original draft roman sulzbach software investigation writing original draft henryk dobslaw conceptualization methodology writing review editing maik thomas supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has been supported by the german research foundation grant no d0 1331 4 1 as part of the research group nerograv for 2736 numerical simulations were performed at deutsches klimarechenzentrum dkrz germany using resources granted by its scientific steering committee wla under project id 499 
23862,we introduce the effects of self attraction and loading sal to the momentum equations of a barotropic global ocean tide model as well as a baroclinic general circulation model we show for the m 2 tidal dynamics that an explicit treatment of sal is favourable compared to a scalar approximation or even disregarding the effects all together for the general circulation the influence on the ocean bottom pressure is shown to be about 1 hpa for short time periods along the coasts and about 0 5 hpa for longer periods in resonant basins in the southern ocean in contrast to previous studies we additionally examine the effects of surface pressure anomalies over the continents in the computation of sal which is shown to have an influence of about 0 5 hpa along the coasts with those results we demonstrate that the explicit treatment of sal is important for satellite applications keywords self attraction ocean loading barotropic tides tidal equations oceanic general circulation primitive equations 1 introduction the earth is not a rigid body but is deforming in response to both internal and external forces on various time scales deformations are accompanied with a redistribution of masses within the solid earth that modify the earth s external gravity field water mass distributions that deviate from the geoid cause a redistribution of mass within the solid earth accompanied by a horizontal movement of water masses due to changes in the earth s gravity field together with the self gravitation of water masses these effects are commonly referred to as the self attraction and loading sal feedback to ocean dynamics sal were first identified to be important for the evolution of sea level over the last glacial cycle farrell 1972 accumulation of ice on the continents reduced the amount of water in the oceans and led to a global mean sea level more than 100 m lower than present day local relative sea level as measured with respect to the deforming solid earth however was found to deviate from the global mean and can be only explained by solving the so called sea level equation farrell and clark 1976 more recently continental surface mass estimates as obtained with the satellite missions grace tapley et al 2019 and grace fo landerer et al 2020 monitor the spatially variable barystatic sea level even with monthly temporal sampling tamisiea et al 2010 in all those applications it is implicitly and appropriately assumed that the ocean mass distribution adapts quasi instantaneously to the changes in the gravity field for mass distributions at diurnal time scales however this assumption is not valid global ocean tides are known to be affected by sal due to the delayed response to the rapidly varying forcing for a long time already henderschott 1972 farell 1973 whereas many simplifications have been tested in the past for the proper inclusion of sal effects into global numerical models e g accad and pekeris 1978 it is now widely accepted that the full effect of sal from solving the global convolution integral is required to meet the accuracy requirements of present day satellite missions ray 1998 while the influence on the high frequency non tidal dynamics is also undisputed stepanov and hughes 2004 it has received far less attention previous studies vinogradova et al 2010 riva et al 2010 have focussed on longer time scales whereas the impact on the high frequency ocean dynamics which is especially relevant for satellite gravimetry schindelegger et al 2021 will be the focus of this study in the present paper we will briefly highlight the theory for calculating the sal potential section 2 next we describe the numerical implementation of the sal feedback into a global ocean tide model based on the shallow water equations section 3 as well as into a global general ocean circulation model based on the primitive equations section 4 where we also discuss the influence of including surface pressure anomalies over land in the sal contribution as well as the influence of the mean ocean bottom pressure obp field results will be presented for both simulations of ocean tidal dynamics as well as for the non tidal ocean circulation the article closes with a summary and a discussion on the relevance of sal feedbacks for satellite applications section 5 for completeness we note that gregory et al 2019 recently suggested to summarize the feedback of self attraction and loading on ocean dynamics under the more generic name gravity rotation and deformation grd we note that rotational feedbacks are not considered in this study and are certainly also not relevant for inclusion into numerical ocean models due to the rather slow variations in both the position of the pole and the rotational rate of the earth in order to avoid confusion by introducing a name that prominently includes rotation which is never considered in our article we decided to use the term sal 2 self attraction and loading we start with the theoretical formulation for sal which forms the basis of the implementations into both ocean models the formulation is based on deriving an additional potential term which describes the additional gravitational potential due to an anomalous water mass on a spherical shell as well as the effect of the elastic deformation of the solid earth the potential at a point p is here given by kuhlmann et al 2011 1 v p n 0 m n 1 k n h n α n p b n m p α n 3 ρ e 2 n 1 this description relies on the decomposition of ocean bottom pressure anomalies into spherical harmonics p b n m the pressure values over the continents can either be set to zero or as in the case for non tidal simulations also include atmospheric surface pressure anomalies section 4 2 the inclusion of the elastic deformation of the sea floor as well as the subsequent change in the gravitational potential of the earth are described by the love numbers h n k n munk and macdonald 1960 for which we use data given by wang et al 2012 based on the prem model of the solid earth ρ e is defined as the average density of the earth as the full implementation of sal requires significant computational overhead due to the decomposition into spherical harmonics in each time step different approximations have been suggested in the past most notably accad and pekeris 1978 proposed neglecting the degree dependence in eq 1 and using only a single term of the series this implies the assumption that the sal effects are dominated by a specific spatial scale the spherical harmonic expansion of the p b n field is then superfluous and eq 1 simplifies to 2 v p β α 0 p b the approximation is named β approximation and is also implemented and tested in the following 3 barotropic tidal modelling the barotropic ocean tide model time tidal model forced by ephemerides used in this study was initially developed in hamburg germany zahel 1977 1978 since then time has been constantly developed seiler 1991 thomas and sündermann 1999 weis et al 2008 and was upgraded most recently by adding dissipation mechanisms refining numerical grids and updating the bathymetric map sulzbach et al 2021 in the following we give a short introduction to the theory of tides and the employed validation metrices and introduce the model specifications finally we present simulation results with respect to the influence of sal for a selection of partial tides and show that while the importance of considering the full sal forcing is smaller for long period tides it cannot be neglected to achieve high accuracy results 3 1 tidal excitation and validation metrics astronomical tides are excited by the periodically varying gravitational attraction of celestial bodies primarily the sun and moon the resulting lunisolar tide raising potential v t i d t ϕ λ that is also influenced by the solid earth response to tidal forces body tides henderschott 1972 can be decomposed in time into a set of so called partial tide potentials v i t ϕ λ that oscillate at discrete frequencies ω i and exhibit spatial patterns that follow the real valued spherical harmonics y n m as given by hartmann and wenzel 1994 1995 the individual partial tide frequencies hereby relate to characteristics of the dynamics of celestial bodies and can be described in terms of the 6 digit doodson numbers doodson 1921 the time dependent horizontal gradients of v i induce harmonic barotropic forces that excite ocean tide dynamics oscillating at the given frequency the obtained partial tide response patterns hereby depend on the respective tidal frequency ω i the degree n and order m of the respective exciting spherical harmonic potential and less strongly on the excitation amplitude v i 0 to validate the numerical results obtained with a tidal model we will focus on the induced oscillations of the free ocean surface 3 ζ i t ϕ λ ζ c o s ω i cos ω i t ζ s i n ω i sin ω i t nonlin that contain minor constant and higher frequency components as the result of weakly non linear processes that are ignored in the following thus a partial tide can be entirely specified by the complex elevation function ζ i ζ c o s ω i i ζ s i n ω i tidal elevations simulated in this study will be compared to the data constrained tidal model fes14 lyard et al 2006 updated by evaluating the respective mean deviation in terms of the root mean square averaged over one tidal period 4 rms ζ 1 i ζ 2 i 1 2 ζ 1 i x ζ 2 i x 2 this value can further be averaged over a defined oceanic domain d o by evaluating 5 rms ζ 1 i ζ 2 i a o 1 j k d o a j k r m s ζ 1 i ζ 2 i j k 2 where a j k are surface elements that add up to the surface of the considered domain a o j k d o a j k we distinguish between deep shallow limit h 1000 m and polar non polar limit ϕ 6 6 areas to build four distinct oceanic domains this choice allows to focus on areas that can be optimally captured by altimetry constrained models non polar ocean or purely hydrodynamic models deep ocean further we compare the results to the ground truth of tide gauge stations tg by averaging over a set of n t g 151 stations compiled by ray 2013 where we evaluate eq 5 by averaging the rms obtained at the individual gauges a j k a n 1 a 0 n t g the derived metrics can be used to quantify the model performance we will predominantly relate to the here defined deep non polar metric that comprises over 80 of the ocean surface 3 2 shallow water equations tidal dynamics are calculated by integrating the non linear shallow water equations e g pekeris 1974 schwiderski 1980 6 t v f v v v g ζ v i v d 7 t ζ h ζ v employing a temporal finite difference scheme backhaus 1985 spanned on a global ϕ λ grid at 1 12 resolution the barotropic ocean state is described by ζ i v i ζ i where ζ i is the free surface elevations and v i is the barotropic flow velocity additional parameters are the coriolis vector f 2 ω sin ϕ the bathymetric function h λ ϕ and the mean surface gravity g 9 80665 m s 2 the tidal excitation in the here employed partial tide mode is induced by astronomical forces proportional to v i as well as by sal forcing v the full sal effect is included by decomposing the surface mass density into spherical harmonics up to a certain maximum degree and order l m a x evaluating eq 1 the in terms of spherical harmonic functions computed sal potential is then subsequently transformed back into the spatial domain before application in the model the computational burden is thus shifted to transforming information between spectral and spatial domain since this is efficiently handled by the shtns package schaeffer 2013 the computation time increases only moderately by 15 for each time step alternatively it is possible to employ the β parametrization discussed above time possesses three dissipation mechanisms summarized by 8 d r h v v a h r ˆ v κ h ℂ v this includes the quadratic bottom friction term with friction coefficient r 0 003 linear wavedrag dissipation introduced by the nycander tensor ℂ nycander 2005 and a tuning coefficient κ as well as a linearly parameterized horizontal eddy viscosity scheme proportional to coefficient a h where r ˆ is a partial differential operator acting on v that is defined in sulzbach et al 2021 while sea ice is not considered in the model we note that cavities under the antarctic ice shelf are included in the spatial domain of the simulations 3 3 simulation results we employ model settings that were found to result in very accurate results for multiple partial tides a h 2 1 0 4 m 2 s κ 1 25 rtopo2 bathymetry arg chi grid sulzbach et al 2021 several experiments are performed individually for three different partial tides from the semi diurnal m 2 diurnal k 1 and long period tidal band m f the k 1 and m 2 experiments are initialized for 30 days when tidal elevations have equilibrated well below a precision of 1 mm compare e g schindelegger et al 2018 as in this situation the sea surface dynamics can be precisely described by eq 3 only the last simulated period is used to extract the respective partial tide the first overtide and a residual constant component as a consequence of tidal rectification the m f run is spun up for 2 complete periods where the constituents were derived by the following third period the time step is set to 1 240 m 2 1 480 k 1 1 6720 m f of the respective tidal period yielding numerical values of close to 180 s in each case a first simulation includes the full sal effect by evaluating equation 1 up to d o 1024 which is a sufficient degree to resolve the sal effect to a sub mm level in the open ocean schindelegger et al 2018 additional experiments employ the β parametrization at various values β where β 0 corresponds to entirely ignoring dynamical feedback by sal table 1 summarizes the validation results for several domains for the three experiments and fig 1 shows deviations in between individual solutions for m 2 m 2 tide considering the full sal effect for the main lunar m 2 tide leads to a non polar open ocean rms of 3 39 cm sulzbach et al 2021 the consideration of the β 0 1 parametrization leads to a strong increase of this value 60 and a complete neglection is even more fatal to accuracy 576 rms values for shallow and or polar regions show similar tendencies but the accuracy drop in shallow water areas is smaller due to time s generally worse performance in shelf seas k 1 tide repeating the same experimental setup leads to an increase in rms of 42 379 when setting β 0 1 0 further experiments were conducted for β 0 07 0 13 yielding worsened open ocean rms values in comparison to β 0 1 while this proves the default setting β 0 1 as robust concerning open ocean dynamics of diurnal tides the shallow non polar rms increase was lowest when setting β 0 07 18 while β 0 13 77 even worsened the results compared to neglecting the effect completely 57 values for non polar areas this can be explained by considering the typical scales of oscillation systems in shelf areas in comparison to the open ocean since this scale is much smaller tidal loads on contra phasic points influence each other by partially annihilating the effect of the load this results in locally diminished values of the β parametrization m f tide having a half monthly period the m f oscillation system is less dynamic and much closer to an equilibrium tide description nevertheless the non polar open ocean rms increases by 117 233 when parametrizing sal as β 0 1 0 this increase is similar for global ocean dynamics but much more moderate than the impact obtained for semi diurnal and diurnal tides the results indicate that a full representation of the sal effect is necessary to obtain the highest accuracy results for all considered tidal species that exhibit periods in the range from 12 h and 14 d hereby the impact decreased for lower oscillation frequencies this points to the decreasing dynamic feedback of sal back into tidal dynamics that ultimately leads to consideration of the self consistent equilibrium tide where dynamic feedback is fully suppressed further the larger scales of the amphidromic systems for k 1 and m f that by far extend the near field effects of loading greens function improve the accuracy of the β approximation in the open ocean 4 primitive equations the dynamic feedback of sal has been newly introduced also into the max planck institute for meteorology ocean model mpiom jungclaus et al 2013 which is a direct descendant of the hamburg ocean primitive equation model hope drijfhout et al 1996 wolff et al 1997 mpiom is a free surface general circulation model that solves the primitive equations under the hydrostatic and boussinesq approximations marsland et al 2003 the model is discretized horizontally on an arakawa c grid and vertically on a z grid the atmospheric forcing includes wind stress heat and freshwater fluxes and optionally also atmospheric surface pressure lunisolar gravitational tidal forcing thomas et al 2001 can be additionally employed the ocean model includes both a dedicated sea ice model marsland et al 2003 as well as cavities underneath the antarctic shelf ice the full implementation of sal according to eq 1 is kept as close as possible to the implementation in time at every time step ocean bottom pressure anomalies oba are calculated with respect to a pre computed mean obp field the oba field is then remapped from mpioms internal tri polar grid to a 720 360 gaussian grid in preparation for the transformation to spherical harmonics shs for the sh transformation we utilize the shtns library by schaeffer 2013 and expand to d o 179 the calculation of the sal potential follows eq 1 before the back transformations into the spatial domain and to the internal mpiom grid are performed the gradient of the thus obtained additional potential is then applied in parallel although independently to mpioms tidal potential for the implementation of the scalar approximation the above described process is simplified significantly instead of the spatial and spectral transformations the oba field is used to compute the approximated potential according to eq 2 with a scalar factor of β 0 1 for this paper we utilize mpioms medium resolution tp10l40 configuration which uses a 1 0 tri polar grid horizontally with 40 vertical layers the model time step is set to 20 min the ocean model is spun up for 1000 years from 3d temperature and salinity climatologies levitus et al 2005 with cyclic atmospheric forcing with daily sampling röske 2005 following the spin up transient simulations are performed with hourly atmospheric forcing based on the ecmwf era5 re analysis hersbach et al 2020 including atmospheric pressure forcing hourly snapshot obp fields are generated as output regularly all experiments discussed below are two years long whereas only the last year will be analysed in the following 4 1 experiments with tidal forcing mpiom provides the option to simulate lunisolar gravitational tides for the benefit of studying non linear interactions among the general circulation and tidal dynamics thomas et al 2001 we use an experiment with mpiom under both atmospheric and gravitational forcing but isolate the signature of the m 2 by means of least squares adjustment from the hourly sampled bottom pressure fields for simplicity simulated sea surface height variations from time are converted in bottom pressure anomalies we here compare three model runs using either the full sal implementation according to eq 1 the scalar approximation according to eq 2 or no sal potential fig 2 shows the amplitudes of the complex differences for the m 2 constituent between the fullsal and nosal simulations left and between the fullsal and β sal simulations right performed with mpiom top a b and time bottom c d at a resolution of 1 2 for both mpiom and time the fullsal implementation produces complex differences of more than 50 hpa in regions with a large m 2 amplitude however while the results are qualitatively in good agreement the sal influence in mpiom is in these areas about 30 larger which might be related to the rather long time step in mpiom that is not well suited to represent rapid semi diurnal fluctuations comparing the influence of the scalar approximation compared to the full sal implementation fig 2 b and d shows that both mpiom and time produce a difference in amplitude of up to 15 hpa the largest differences are here confined to coastal areas such as the coral and celebes sea the sea of okhotsk and the south eastern pacific ocean in the open ocean the difference in complex amplitude between the two model runs reaches about 5 hpa as the choice of β in the scalar approximation signifies a predominance of a specific spatial scale a larger difference in coastal areas is to be expected according to ray 1998 and stepanov and hughes 2004 β 0 1 while being the best choice for a constant factor represents the influence of sal in shallower regions only poorly similar to the validation performed for the results obtained with time we here also validate the results for several domains for the m 2 results obtained from mpiom in table 2 the results for mpiom are computed analogously to the results from time considering the full sal effect for the main lunar m 2 tide leads to a reduction of the non polar open ocean rms from 25 87 to 10 88 cm which represents a reduction of about 58 for the shallow water areas the reduction in rms is reduced in a similar way to the results from time which is also connected to the generally worse performance in shelf areas we note however that the results obtained here are meant to demonstrate the implementation of sal in mpiom and are not to be compared to the results from time in terms of absolute values naturally mpiom is not able to compete with time when it comes to the simulation of tides which is of course also reflected in the rms values instead emphasis should be placed on the improvement obtained from the sal feedback within each model which suggests that similar improvements should also be visible in mpiom for non tidal dynamics 4 2 impact of sal on non tidal dynamics we also perform experiments with mpiom to investigate the effects of sal on the circulation we will focus on ocean bottom pressure first since this is the quantity most directly affected by sal the experiments differ in the treatment of sal and include either the full sal potential as given by eq 1 here labelled sal obp where the values over the continents are set to zero the full sal potential including contributions from surface pressure anomalies over land sal spobp the simplified sal potential as given by the scalar approximation of eq 2 β obp with β 0 1 or no sal contribution whatsoever nosal please note that gravitational tides are not simulated in those experiments and that the ocean response to atmospheric tides dobslaw and thomas 2005 has been removed from the time series of each experiment empirically the results are analysed by separating the oba time series into four frequency bands of 0 3 days 3 7 days 7 14 days and 14 60 days using 4th order butterworth filters longer frequencies will not contribute to potential aliasing effects for monthly gravity solutions in satellite gravimetry in fig 3 we show the variability of obp split into the aforementioned frequency bands with the sal spobp model run as a reference at the highest frequencies 0 3 days the variability predominantly consists of basin modes that are locally enhanced in various semi enclosed coastal regions spatial scales gradually reduce with longer periods and signals become more spatially variable signals in obp at the longest periods considered here are particularly pronounced in various resonant regions in the southern ocean e g indoaustralian basin bellingshausen basin where barotropic ocean dynamics are excited by the strong and rapidly varying westerly surface winds to isolate the effect of different sal aspects on obp variability we calculate standard deviation differences between model runs for each frequency band fig 4 shows the standard deviation differences of the sal spobp and nosal model runs for the high frequency band fig 4 a signals of up to 1 hpa are observed which is the strongest relative impact of sal for all frequency bands considered when compared to the background variability depicted in fig 3 these signals are mainly located in shelf coastal regions and coincide with regions of large obp variability for the intermediate frequency bands of 3 7 days and 7 14 days fig 4 b c the observed signals are reduced substantially and are well below 0 5 hpa a somewhat stronger sal influence is again observed for longer frequencies fig 4 d even though the background variability is stronger here as well while significant signals of up to 1 hpa are observed in certain shelf areas such as the gulf of thailand signals of up to and locally even exceeding 1 hpa are now found in large areas of the southern ocean mainly the kerguelen plateau and the bellingshausen sea as well as east of the drake passage these regions again correspond to areas in the region of the acc that are typically associated with large obp variability we also study the influence of the inclusion of surface pressure anomalies in the sal potential by comparing the results from the sal spobp and sal obp model runs in fig 5 as the two sal potential terms do not differ over the open ocean differences are to be expected mainly in coastal regions indeed fig 5 a shows almost no signal for the high frequency band suggesting that large scale surface pressure variability over the continents that attracts ocean water masses is not changing rapidly enough to have a notable impact on ocean dynamics the influence of the surface pressure anomalies increases for longer frequencies and is largest for the low frequency band fig 5 d here the difference reaches up to 0 5 hpa very close to the coast while for the open ocean the signal does not exceed 0 1 hpa we therefore conclude that continental surface pressure forcing has a rather minor impact on ocean dynamics but can nevertheless be rather easily incorporated into an ogcm fig 6 compares the sal obp and the β obp model runs and therefore the difference between the full sal potential and the scalar approximation for the high frequency band the differences are very localized in shelf areas and locally reach values over 1 hpa for the intermediate frequency bands the signals are significantly reduced the most prominent differences are observed for the low frequency band here values of up to and locally exceeding 2 hpa are reached in parts of the acc region these differences are not particularly localized to specific areas but cover most of the acc region we rate those differences as substantial and conclude that it would be advisable to drop the scalar approximation also for the simulation of sal feedback on the ocean circulation much in the same way as for the ocean tidal dynamics we also compare the influence of the scalar approximation to not including any sal contribution whatsoever in fig 7 for the high frequency band differences in coastal areas of more than 1 hpa are found in coastal areas while for the open ocean values reach up to 0 5 hpa for this frequency band results are thus comparable to the results shown for the full sal contribution in fig 4 a also for the intermediate frequencies figs 7 c d results are similar to the full sal contribution the largest signals are also here found for the low frequency band in the region of the acc where locally values exceed 2 hpa omitting sal completely would therefore compromise the simulation of the high frequency wind driven ocean circulation so that the incorporation of β sal is generally encouraged since it does not impose an additional numerical cost for precise simulations focusing on the transient wind driven dynamics as e g important for non tidal ocean de aliasing see dobslaw et al 2016 the full sal feedback should always be implemented 4 3 impact of the mean field all implementations of the sal effects discussed so far are based on pressure anomalies with respect to a long term mean the choice of the reference field in the computation of the anomalies can thus have an influence on the sal potential as errors in the computation or choice of the mean field can result in erroneous horizontal pressure gradients and associated accelerations to study the influence of the reference field we performed additional model runs with a poorly chosen obp reference field poorly chosen refers here to an obp mean field that is based on only a single month that is outside of the simulation period fig 8 a shows the standard deviation differences of obp between the normal sal obp model run and a sal obp model run with a poorly chosen mean obp reference field the results show that the influence of the mean field is mostly limited to the regions of high variability in the southern ocean on larger spatial scales the influence reaches about 20 pa while locally effects of over 50 pa are found the effect on other regions such as the coasts is negligible from the analysis in different frequency bands it is clear that the coastal influence if mostly found in the high frequency band 3 days we thus advise to always use a representative long term mean field but conclude that minor errors in the mean field will not induce erroneous feedbacks to the ocean dynamics additionally we study the influence of the reference obp field including the surface pressure over the continents similar to before the poorly chosen reference field consists of a mean field over one month that is not included in the simulation period only including the contribution of the surface pressure over land fig 8 b shows the comparison to the sal spobp model run the results when including the surface pressure anomalies are very similar to fig 8 a both in spatial distribution as well as magnitude indicating that a poorly chosen surface pressure reference field has a much smaller impact compared to the obp reference field 4 4 impact on overturning circulation as the implementation of the effects of sal are based on oba it is expected that the impact of sal on ocean dynamics vanishes for sufficiently long time periods in this section we want to show that the influence does indeed vanish and that there is no influence on the long term general circulation we do this within mpiom by comparing two long term simulations which are both performed for a period of 30 years one of which implements the full feedback from sal while the other has no sal enabled in fig 9 we show the influence of sal on the atlantic meridional overturning circulation amoc stream function on the left and the sea surface height on the right a d shows the 30 year mean in the amoc stream function sea surface height without any sal influence the difference of the long term mean between full sal and no sal feedback is shown in b and e respectively in c and f we show the difference in the linear trend for the two simulations comparing the difference between sal and nosal model runs to the long term mean fig 9 shows that the influence of sal is on the order of 1 although for most of the grid point even well below that the largest differences naturally occur in regions where the mean values themselves are largest looking at the long term linear trends the values are on the order of 0 001 per year in general the influence of sal does as expected vanish for periods which are sufficiently long as a consequence we note that while we recommend the implementation of sal for applications where the goal is an accurate representation of the high frequency variability in the ocean the recommendation does not extend to applications where low frequency effects are the main interest 5 summary and conclusions the feedback of self attraction and loading sal on ocean dynamics is a process that induces additional barotropic pressure gradient forces acting on the sea water it has therefore consequences for both tidal dynamics and also the non tidal barotropic circulation the impact of sal is strongest on the sub daily time scales and vanishes at longer periods where a quasi instantaneous adaptation of the sea water to the time variable external gravity field of the earth can be safely assumed sal is therefore important for the numerical simulations of the rapid and barotropic ocean mass variability only the sal feedback has been implemented for this study into two very different numerical codes employing the shallow water equations the time global ocean tide model and the primitive equations the mpiom general ocean circulation model numerical experiments with the barotropic tidal model time indicate that the implementation of the full non local effect of sal is crucial to enable high accuracy results for partial tides of semi diurnal diurnal and also long period character the tidal solutions further show that the importance of a full sal implementation is much higher for partial tides with shorter periods as their character is much more dynamic nonetheless the experiments confirm that a carefully tuned β approximation can capture a substantial fraction of the sal effect on tides and should be always favoured over completely neglecting the impacts of sal the results for m 2 based on the mpiom ogcm are qualitatively similar even though the sal influence is somewhat overestimated by up to 30 in various shelf regions with those comparisons we demonstrate that a sal implementation into an ogcm such as mpiom is both feasible in terms of numerical costs and also useable for routine simulations additional model experiments with mpiom were carried out to quantify the consequences of different options for the sal implementation on the simulated ocean bottom pressure sal has an influence on the variability of up to 1 hpa in coastal areas for short periods below 3 d while on longer periods an influence of up to 0 5 hpa is mainly confined to individual resonant basins in the southern ocean in line with previous results from vinogradova et al 2015 kuhlmann et al 2011 in extension to those previous studies we also include the effects of surface pressure anomalies on land in the computation of the sal potential which are shown to have an influence of up to 0 5 hpa along the coasts previous studies by schindelegger et al 2018 2021 compared obp estimates from daily grace gravity field time series with various ocean models aod1b rl06 dobslaw et al 2017 which is based on a very comparable mpiom configurations but does not include the effects of sal was shown to not sufficiently capture the obp variability in the grace solutions in regions of the southern ocean similarly bonin and save 2020 studied how well aod1b explains altimetric variances compared to grace solutions and identified similar regions for improvement in the southern ocean the results obtained in our present study indicate that including sal in the model simulations shows the largest influence on the obp variability in these regions and is thus expected to have a positive impact on the quality of the aod1b product and should be considered in a future release experiments with mpiom with the full sal feedback are currently being performed over several decades that can be readily tested as a new background model for satellite gravimetry credit authorship contribution statement linus shihora software investigation visualization writing original draft roman sulzbach software investigation writing original draft henryk dobslaw conceptualization methodology writing review editing maik thomas supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has been supported by the german research foundation grant no d0 1331 4 1 as part of the research group nerograv for 2736 numerical simulations were performed at deutsches klimarechenzentrum dkrz germany using resources granted by its scientific steering committee wla under project id 499 
23863,in this work we consider an efficient discretization of the shallow water equations in spherical geometry for oceanographic applications instead of the classical 2d covariant or 3d cartesian approaches we focus on the mixed 3d 2d form of bernard et al 2009 which evolves the 2d momentum tangential to the sphere by projecting the 3d cartesian right hand side on the sphere surface differently from the last reference we consider the exact representation of the sphere instead of the finite element one mixed with a covariant basis projection of the momentum this leads to several simplifications of the discontinuous galerkin scheme the local mass matrix goes back to the standard block diagonal form the riemann problem does not require any tensor or vector rotations to align the bases on the two sides of an edge second we consider well balancing corrections related to relevant equilibrium states for tsunami and storm surge simulations these corrections allow to compensate for the inherent non exactness of the quadrature induced by the non polynomial nature of both the geometrical mapping and of the covariant basis in other words these corrections are the order of the cubature error we show that their addition makes the scheme exactly well balanced and is equivalent to recasting the integral of the hydrostatic pressure term in strong form the proposed method is validated on academic benchmarks involving both smooth and discontinuous solutions and applied to realistic tsunami and a historical storm surge simulation keywords shallow water equations spherical geometry discontinuous galerkin well balanced schemes tsunami storm surge 1 introduction coastal flooding is mainly caused by meteorological and telluric phenomena which may occur at the scale of the oceanic basin the numerical simulation of such events requires to solve the governing equations in a spherical geometry in this work we consider the shallow water equations swes which provide satisfactory results for long wave phenomena such as tide storm surge and tsunami the literature devoted to discrete formulation of the swes on the sphere is quite large two methods have emerged in the past to deal with the earth curvature a common approach among contemporary ocean models consists in a two dimensional parametrization of the sphere through a proper curvilinear coordinate system then the primitive or shallow water equations are written directly on the curved manifold meaning that all the differential operators are transformed in curvilinear coordinates a metric source term arises from the space variation of the curvilinear vectors basis the underlying equations in curvilinear coordinates are typically discretized on regular grids with finite differences finite volume schemes regional models use the traditional latitude longitude parametrization unfortunately for global ocean models the latitude longitude coordinate system has a singular point in the arctic ocean at the north pole where the meridians converge on water the jacobian of the coordinate transformation is not defined and moreover the singularity imposes a severe restriction on the maximum time step allowed for stability nowadays the pole problem is considered merely as an economical one 43 in particular meteorologists have used a variety of fixes to circumvent the singularity and all of such fixes employ multiple curvilinear coordinates defined on different patches covering the whole sphere kageyama and sato 2004 ronchi et al 1996 then a specific treatment of the flux term at the edges dividing the patches where the tangent basis changes is deployed a rotation of momentum vector nair et al 2004 or an orthonormalization of the riemann problem ullrich et al 2010 rossmanith 2006 assure a common reference system at the edge and local conservation to bypass the pole problem ocean modelers have used instead ad hoc curvilinear coordinates conceived to place the singularity point on lands see for example the tripolar grid of madec and imbard 1996 finally for finite volume methods some authors 38 claimed that extra care should be taken in the resolution of the riemann problem in curvilinear coordinates a second approach consists instead in resolving the governing pdes in a three dimensional cartesian framework and then adding a constraint to force the currents to remain tangent to the sphere 11 19 with this approach it is more common to represent the sphere approximately through a local finite element map for each element thanks to the local map no special treatment is required in polar regions to preserve accuracy and to conserve global mass a third approach seems to combine the advantages of both methods 6 momentum time derivative is written with respect to 2d components while the right hand side is first expressed in 3d and then projected back onto the sphere surface by a simple scalar product with respect to the tangent basis the advantage is that the number of unknown is kept to a minimum water depth and two momentum components and at the same time the right hand side maintains a cartesian form thus it is independent from the parametrization of the sphere and moreover there is no need to transform the differential operators for example in tsunami applications this could be laborious for depth averaged non hydrostatic models with dispersive terms that involve mixed high order derivatives if requested riemann solvers are formulated easily in 3d cartesian framework and then projected on the sphere surface along with the right hand side in the last reference the geometrical error related to the approximation of the curvature of the sphere is controlled by using higher order super parametric finite element approximations of the spherical geometry here we present some improvements of the mixed 3d 2d formulation of bernard et al 2009 applied to spherical geometry first we use an exact representation of the spherical elements which allows to avoid the pole problem altogether a similar idea is used in the recent work by baldauf 2020 in our case we then introduce a 2d covariant representation of the momentum vector this combination completely cancels the geometrical error related to the sphere curvature in practice we can use any local reference mapping we want to represent the 3d spatial coordinates including the classical latitude longitude transformation due to the orthogonality of covariant vector basis the momentum equations remain decoupled as in the planar case which simplifies the structure of the update moreover the riemann solvers also simplify thanks to continuity of the geometrical quantities as well as of the covariant basis at the elements edges more precisely no rotations of the velocities momentum components nor averaging of the normals are required the discontinuous galerkin dg method is becoming increasingly popular in geophysical fluid dynamics proving also in this field its potential in terms of high order accuracy conservation properties and ease of massively parallel implementation it has been applied to the spherical swes in different forms at the opposite ends of the spectrum we mention the purely two dimensional form on the cubed sphere 33 and the fully 3d cartesian form on a finite element quadrilateral grids 19 here we discretize the spherical swes in the proposed 3d 2d covariant form then we look to the well balanced property or the discrete preservation of some steady states which are of particular interest for tsunami and storm surge computations these states include the lake at rest which results from the steady balance between hydrostatic pressure and the force played by the bottom and the inverse barometer in which the atmospheric pressure effect is also added to the balance in general well balanced methods are more robust and allow to work with coarser mesh a well balanced dg method typically relies on the fact that the so called strong form with a second integration by parts of the volume flux term embeds more easily then the weak form the well balanced property at a discrete level based on the fact that the strong form is more suited to retain well balancing some authors 14 and 45 while being stuck to the weak dg form with one integration by parts of the flux term compute exactly the integrals in order to maintain a discrete equivalence to the strong form other authors see e g vater et al 2019 write directly the scheme in the strong form this has close similarities with fully residual based methods see e g abgrall and ricchiuto 2017 ricchiuto 2015 and allows to obtain well balancing independently on the quadrature formula used such flexibility is used to retain general well balanced states on the sphere 7 here we start from the weak dg form and we show that when applied to the mixed 3d 2d formulation of the swes it is unable to preserve equilibria due to inexactness of the quadrature formula with non polynomial functions as the ones contained in the components of the tangent vectors we add a well balancing correction related to relevant equilibrium states for tsunami and storm surge simulations these corrections involve the quadrature error there are thus small by definition and compensate for the lack of summation by parts property making the scheme exactly well balanced we show that this idea is equivalent to recasting the integral of the hydrostatic pressure term in the strong form the paper is organized as follows in section 2 we introduce the notation for the spherical geometry in section 3 we introduce the swes in the 3d 2d covariant formulation in section 4 we discuss their well balanced dg approximation in section 5 we detail computational aspects such as shock capturing and time stepping in section 6 we evaluate the proposed methods on standard global benchmarks for the shallow water equations on the sphere and on regional realistic tsunami storm surge computations 2 tangent maps for the sphere we consider a sphere s 2 with radius r described by generic curvilinear coordinates x 1 x 2 and tangent basis t 1 t 2 the coordinate vector x then writes 1 x x i e i x 1 e 1 x 2 e 2 x 3 e 3 2 x α t α x 1 t 1 x 2 t 2 note that in the above definitions and in the following ones repeated indices imply summation in particular latin indices are used for the components of vectors in cartesian coordinates from 1 to 3 while greek indices are used for vectors in local curvilinear coordinates from 1 to 2 the transformation from the curvilinear space to the physical space is defined here as x t x it has a jacobian or transformation tensor 3 j t x x with components j t i α and an inverse jacobian 4 j t 1 x x with components j t 1 α i the tangent vectors can be obtained by differentiation as the columns of the jacobian it is useful to normalize the basis 5 t α x x α t α t α t α in general t α t β δ α β finally we define the metric tensor constructed from the jacobian matrix as 6 g j t t j t and g det g having denoted by t the matrix transpose if the inverse jacobian cannot be computed directly from the definition 4 it can be replaced by the pseudo inverse 7 j t 1 g 1 j t t depending on the transformation different representations of the spherical geometry can be obtained 2 1 finite element map t can be a local finite element transformation giraldo et al 2002 bonev et al 2018 that maps a reference element to a spherical element denoted by 8 e k k k x j d o f s φ j x x j where x 1 x 2 are the reference coordinates and x j are the physical coordinates of the degrees of freedom the jacobian and the tangent vectors follow from the application of the definitions 3 and 5 while the inverse jacobian 4 has to be intended as the pseudo inverse a high order accurate geometry is usually attained by increasing the polynomial degree of the basis functions φ j 2 2 spherical map in this work we will use the exact spherical transformation defined here as 9 g π π π 2 π 2 s 2 x g x where x 1 r cos x 2 cos x 1 10 x 2 r cos x 2 sin x 1 x 3 r sin x 2 with x 1 the longitude and x 2 the latitude explicit expressions for the jacobian inverse jacobian and tangent vectors follow from 3 5 for example the jacobian reads 11 j g r cos x 2 sin x 1 r sin x 2 cos x 1 r cos x 2 cos x 1 r sin x 2 sin x 1 0 r cos x 2 the tangent vectors are also called covariant vectors and they are denoted as g α x x α please note that the normalized covariant basis is orthonormal g α g β δ α β as already mentioned the spherical transformation is singular at the poles an alternative and equivalent exact map that avoids the pole singularity but does not keep orthogonality of the tangent basis is the following local transformation that maps a reference element to a spherical element 12 a k k k x r f x f x where f j 1 3 φ j x x j is the p1 finite element transformation from the reference element to the 3d element the above transformation has a smooth jacobian 3 everywhere 13 x k x α r f j 1 3 φ j x α x j k r j 1 3 φ j x x j k f 2 f x α from which we can compute the normalized tangent vectors with 5 3 shallow water equations in spherical geometry we consider the swes in spherical geometry with uneven bathymetry and in presence of earth rotation we express them in a generic vector form 14 h t h u 0 15 h u t t s with h the fluid depth h u the discharge momentum vector and having denoted the momentum flux tensor by t the source s includes the effects of bathymetry bottom friction coriolis force and meteorological forcing 16 s g h b c f h u 2 ω k h u g h ρ 0 p a t m f w in the formula above b x denotes the bathymetry topography c f the friction coefficient given by the manning formula ω the earth rotation rate and k the earth rotation axis p a t m is the atmospheric pressure ρ 0 is the water density and f w represents the wind forcing turbulent eddy viscosity term has been neglected the expressions of nabla of the momentum vector h u and of the tensor t depend on the coordinate system in which they are expressed the most common representations used for the shallow water equations are either the 3d cartesian coordinates or the curvilinear coordinates defined in section 2 the momentum vector h u can be expressed in both systems see 1 and 2 as 17 h u h u i e i h u 1 e 1 h u 2 e 2 h u 3 e 3 18 h u α t α h u α 1 t 1 h u α 2 t 2 we remark that for curvilinear coordinates momentum components are not defined in a unitary basis it may be convenient expressing momentum in a unitary basis 19 h u h u α t α t α t α 20 h u α t α the relationship between the velocity components written in the two basis is 21 u i j t i α u α u i j t i α u α where j t i α j t i α t α repeated index summation does not apply here is the jacobian 3 normalized by columns similarly the second order flux tensor t can be expressed in both coordinate systems as 22 t t i j e i e j 23 t α β t α t β with cartesian components t i j h u i u j p δ i j and curvilinear components t α β h u α u β g p δ α β the hydrostatic pressure is defined as p g h 2 2 and g is the determinant of the metric tensor 6 3 1 equilibrium states for coastal flows an important role is played by the so called lake at rest state which denoting the free surface level η h b is the particular steady solution characterized by the two invariants 5 24 h u 0 z η c o n s t z 0 in presence of atmospheric pressure forcing a relevant state is the inverted barometer balance that is an exact solution of the swes in case of full adjustment of sea level to changes in barometric pressure 18 25 h u 0 z η p a t m g ρ 0 c o n s t z 1 full adjustment is never reached since the pressure field is unsteady p a t m x t thus one may question if this is really a relevant equilibrium but it is interesting to be able to handle this possibility numerically in mercer et al 2002 it has been shown that at least in deep water the free surface response is almost isostatic and characterized by small perturbations around the inverted barometer balance in light of these findings and for completeness we have investigated the more general balance 25 a numerical method approximating 14 15 is said to be well balanced if 24 or 25 are also exact solutions of the discrete equations in other words well balanced schemes provide a discrete analog of the balance between hydrostatic pressure and the forces exerted by the bottom and by atmospheric pressure 26 p i g h b p a t m g ρ 0 3 2 fully diagonal mixed 3d 2d covariant formulation following bernard et al 2009 we proceed as follows to obtain the fully discrete equations 1 we project the momentum eq 15 on the tangent plane t h u t α t t α s t α 2 the scalar product contained in the time derivative is performed with momentum expressed in curvilinear coordinates while the scalar product involving the rest of the equation is performed in 3d cartesian coordinates 27 t h u β t β j t α j t j k x k t α j s j t α j e g α 1 t h u 1 t 1 t 1 h u 2 t 2 t 1 t 11 x 1 t 12 x 2 t 13 x 3 t 1 1 t 21 x 1 t 22 x 2 t 23 x 3 t 1 2 t 31 x 1 t 32 x 2 t 33 x 3 t 1 3 s j t 1 j one advantage of this formulation with respect to full 3d equations is that the number of unknowns is kept minimum h h u 1 h u 2 another attractive feature is that the flux function stays in 3d form and does not depend on a particular transformation this means that line integrals are defined intrinsically and mass is easily conserved circumventing implementation issue related to the use of composite meshes in the 2d approach the drawback of this formulation compared to the fully two dimensional one is that for each momentum equation 9 components of the fluxes have to be evaluated instead of three and that in general the curvilinear momentum components are coupled however differently from bernard et al 2009 we propose to use the exact spherical representation thus we have to project momentum on the exact tangent basis we can choose either the covariant framework 10 or the local transformation 12 here we have used locally in each element the covariant framework guaranteeing the decoupling of the momentum components and for which simple analytical expressions exist for the tangent vectors g α x x α we project onto the normalized tangent basis 5 to get 28 t h u g α t g α s g α or by components e g α 1 t h u 1 g 1 g 1 1 h u 2 g 2 g 1 0 t 11 x 1 t 12 x 2 t 13 x 3 g 1 1 t 21 x 1 t 22 x 2 t 23 x 3 g 1 2 t 31 x 1 t 32 x 2 t 33 x 3 g 1 3 s j g 1 j so in practice we work with 29 t h u α t j k x k g α j s j g α j this choice allows to take advantage of the orthogonality of the covariant basis and work with a fully diagonal system which is the main advantage of the formulation proposed here please note also that this algorithm evolves physical components of momentum h u α in m 2 s eastward for α 1 and northward for α 2 4 well balanced discontinuous finite element discretization we consider a discretization of s 2 composed by non overlapping triangular elements k to each element k we can associate an element defined in the parametric space which we denote by k for a given mesh we label by the roman h the characteristic mesh size measured in physical space following a high order dg procedure we project the vector of conserved variables and the bathymetry into the finite dimensional space 30 v h p φ φ x l k p x k where l k p are lagrange polynomials of degree p defined on each parametric element k we obtain the weak formulation multiplying the mass eq 14 and the momentum eq 28 by a smooth test function φ i that belongs to the same space 30 and integrating it on a spherical triangle k 31 t k h h φ i d x k h u h φ i n d s k h u h φ i d x 0 32 t k h u h g α φ i d x k t h g α φ i n d s k t h g α φ i d x k s h g α φ i d x where t h denotes the numerical flux evaluated at the elements boundaries and the symbol is the scalar product between second order tensors a b a i j b j i as noted in bernard et al 2009 if we regroup g α φ i v i α then 32 corresponds to consider a vectorial test function for each momentum equation several aspects need to be clarified first of all the mapping required to define the quadrature formulas which will involve non algebraic transformations secondly the well balancedness w r t the equilibria presented earlier is not trivial in this formulation as exact quadrature is impossible precisely due to the non algebraic nature of the mappings adopted these aspects are covered in the next sections 4 1 reference element mapping and quadrature all the integrals are computed on the standard reference triangle k for the transformation which map a reference triangle to a spherical triangle we use 12 which allows to bypass the pole singularity in the evaluation of the integral and the differential operators consider for example the volume integral in the momentum equation which we decompose into 33 k t h g α φ i d x k t h k j x k g α j φ i d x k t h k j φ i g α j x k d x k t h k j g α j φ i x k d x both the resulting integrals are mapped using 12 so the differential is rescaled based on the mapping jacobian 34 d x j a d x with j a g and g det j a t j a see 6 the derivatives of the test functions are evaluated classically via the gradient in the mapped element as 35 x k x β x k x β j a 1 β k x β with the inverse jacobian j a 1 g 1 j a t see 7 all the remaining quantities are evaluated analytically via the mapping 12 including the gradients of the covariant basis vectors which can be easily obtained analytically starting from 11 line integrals are evaluated similarly via a mapping to a reference 1d element as already remarked for the time derivative we can write 36 t k h u h g α φ i d x j d o f s k φ i φ j d x h u j α t which shows that a fully block diagonal structure is retained as a final remark we note that differently from two dimensional formulations the right hand side appears in cartesian form and it is well posed on the whole sphere however the tangent basis in 32 is not well defined at the poles for the latitude longitude parametrization that we have chosen for this reason only to evaluate the tangent basis and its derivatives a polar cap defined by a limiting latitude z lim is deployed elements are flagged according to the baricenter position if z g k z lim we use a rotated spherical transformation replacing 10 with x 1 r cos x 2 cos x 1 37 x 2 r sin x 2 x 3 r cos x 2 sin x 1 the jacobian 3 inverse jacobian 4 and basis vectors 5 are modified accordingly note that this is only affecting the local representation of the 3d basis which remains perfectly continuous across element edges we found that the dg framework is well suited to handle such discontinuity at the elements edges with no modification necessary to the algorithm in particular each element updates the momentum components h u α in its own reference system thus zonal meridional components in standard elements and rotated components in polar cap elements in a dg method communication between elements is needed only for evaluating numerical fluxes since they are computed in a 3d framework and independent from the local coordinate system no specific treatment is necessary at the edges separating the polar cap in practice we have set z lim 0 9 r we will show that this value has no impact on the numerical results 4 2 integration by parts correction we are interested in the well balanced nature of the scheme we will first consider the lake at rest case the effect of the atmospheric pressure is added introducing an apparent topography 8 b b b p a t m g ρ 0 imposing the lake at rest the momentum components of the dg method reduce to 38 k p h i g α φ i n d s k p h i g α φ i d x k g h h b g α φ i d x one drawback of the mixed formulation emerges well balancing is lost because of the projection on the tangent basis an operation that involves the evaluation of non algebraic functions in all of the three integrals of 38 indeed even with constant bathymetry and constant pressure in general we cannot remove the geometrical integration error 39 ε p 0 k p 0 k i g α φ i d x k i g α φ i n d s this is an issue already encountered on curved finite element polynomial meshes 27 and is even more critical for the non polynomial approximation used here we remark that this was also highlighted in bonev et al 2018 in the context of the study of the well balancing of a fully 3d dg shallow water approximation on the sphere as observed in the last reference a more suitable form to guarantee the well balanced character of the method is the strong form we obtain a somewhat similar result here but we proceed in a different manner and finally only the pressure term is converted into the strong form our idea is to balance the scheme with a small correction which is within the quadrature error and thus much smaller than the truncation error of the scheme to achieve this we re inject into the scheme 32 the integration by parts error associated to the pressure terms given by 40 ε p k k p h i g α φ i d x k p h i g α φ i n d s k p h i g α φ i d x note that this term is identically zero for exact quadrature and reduces to 39 if the pressure is constant note also that the only ansatz made is that p h is the pressure associated to the finite element polynomial projection and in our specific case p h it is assumed to be a polynomial of degree 2 p thus infinitely differentiable we can characterize the correction term with the following property proposition ibp correction bounds let 40 be evaluated by means of quadrature formulas which are exact for polynomials of degree k k for the volume integrals and k k for the boundary integral the correction can be bounded as 41 ε p k c k h min k k 1 k k 1 the proof of the above property is reported in the appendix in practice we have computed all integrals with formulas exact for k k k k 3 p a numerical verification of the proposition for these choices is also reported in the appendix when 40 is added to the discrete momentum equation the variational form becomes 42 t k h h φ i d x k h u h φ i n d s k h u h φ i d x 0 43 t k h u h g α φ i d x k t h g α φ i n d s k t h g α φ i d x k s h g α φ i d x ε p k 4 3 numerical fluxes mass conservation and well balanced with discontinuous data for the mixed 3d 2d formulation all geometrical quantities are uniquely and objectively defined in 3d so we can use practically any riemann solver in 3d cartesian coordinates the line integral in the momentum eq 32 reads 44 k t h g α φ i n d s k t h n h g α φ i d s where h r 3 is a specified numerical flux h u l u r and u l and u r are the left internal and the right external states u h h u i in practice we use the lax friedrich flux we remark that the problem of using a common framework between the left and right state in the original 6 is no longer necessary since the normals are continuous at the edges only a change of basis is needed at this point to compute 3d velocities because they are only available from momentum update in 2d this is done with the right relationship in 21 and the definition of the sphere jacobian 3 the important consequence of this is that the method proposed conserves mass exactly without any special treatment of the normals on element boundaries to recover also the well balanced property in presence of discontinuous data besides the addition of the hydrostatic correction in 43 as in xing and zhang 2013 we evaluate the numerical flux at a reconstructed state u 3 and add a high order correction term the resulting well balanced mass momentum numerical flux distinguished by ˆ reads 45 h h u l u r 46 h ˆ h u l u r p h l p h l n for the definition of the reconstructed state u h h u i please refer to audusse et al 2004 a strategy for recovering a well balanced scheme in presence of discontinuous data for the bathymetry on non conforming elements is also discussed in bonev et al 2018 in real applications discontinuous data b p a t m arise for example when the correspondent fields are computed at the degrees of freedom from a local minimization problem for the bathymetry this can be beneficial to avoid gibbs phenomena when data is nearly discontinuous on one cell and the polynomial order is p 1 for the atmospheric pressure field we assume that it is continuously interpolated at the degrees of freedom in this case the well balanced correction related to the inverted barometer first line is mass correction second line is momentum correction 47 1 2 1 g ρ 0 α l f g h r h l 2 n p a t m l p a t m r is identically zero being p a t m l p a t m r proposition well balanced the mixed 3d 2d covariant dg method 42 43 with numerical fluxes 46 is well balanced in the sense that it preserves to machine accuracy initial data verifying 24 or 25 proof the main assumption is that either h h b h η 0 const or h h b h p a t m g ρ 0 h η 0 const within each cell for the lake at rest state the flux reduces to t h p h i then the discrete momentum eq 43 reduces to 48 k h ˆ p h i n g α φ i d s k p h i g α φ i d x k g h h b g α φ i d x where we have canceled the first term of the correction 40 with the third term in 43 since they are equal and with opposite sign similarly to xing and zhang 2013 the proof is based on the fact that in the lake at rest case the lax friedrich flux evaluated at the reconstructed state is h u l u r p h h l and one can check that the well balanced numerical flux thus simplifies as h ˆ u l u r p h h l i n since the left state is the internal state we can further write p h h l i n p h i n then the integrand of the first term in 48 cancels out at each quadrature point and the whole penalization term vanishes moreover for any order h h b h v h p on can show that 49 p h i g h h b h g j φ j h j 2 2 g h h b h g h h η h with h h b h η 0 const also the volume terms in 48 cancel exactly recovering the well balanced property the same arguments hold for the inverted barometer case but replacing b with b b p a t m g ρ 0 5 computational details 5 1 shock capturing the applications considered in this work may involve the formation of discontinuous solutions during the computation for tsunami simulations wave breaking occurring in shallow areas can cause the linear dg method to develop unphysical oscillations that eventually grow in time we cope with the possibility of non smooth solutions with an entropy viscosity approach guermond et al 2011 pasquetti 2017 which consists in adding a diffusion like term to the right hand side of 14 15 here we discuss the details related to the implementation of the diffusive term in a spherical geometry we consider only momentum equation since mass equation is a particular case given a diffusive flux tensor g μ h u the dg discretization in the mixed formulation of section 3 2 writes 50 i μ k g h g α φ i d x k g h n φ i g α d s k g h g α φ i d x to stabilize the shocks only the volume integral is retained and moreover we neglect the variation of the tangent basis so that integral 50 simplifies to 51 i μ k g h k j g α j φ i x k d x note that g k j g α j g α k is a diffusive flux tensor projected on the tangent plane as for the advective flux since we evolve momentum in the tangent basis we do not have access directly to g k j in cartesian basis however the diffusive tensor components are easily recovered from relationships 21 and 35 52 g k j μ h u j x k μ x k j g j β h u β μ h u β g β j x k μ j g j β h u β x k near the discontinuities the viscosity coefficient μ should be of order h k in order to kill oscillations while in smooth regions it is expected to be below the approximation order to this end we follow the principles originally proposed e g in guermond et al 2011 and pasquetti 2017 and define this coefficient starting from the total energy residual we refer to the last references for the formulation and to filippini et al 2018 and references therein for its parametrization 5 2 time stepping high order temporal accuracy is achieved as it is standard with a ssprk method 20 the time step is computed according to 53 δ t c f l min k ρ k 2 max f α l f f with ρ k the elemental inscribed circle radius and α l f f the lax friedrich parameter at face f for linear stability reason one should use c f l 1 2 p 1 being p the polynomial order of the approximation but for practical use in this work we always set c f l 0 5 for stability reasons when included the manning friction term is treated via a semi implicit splitting as e g in hou et al 2013 and delis et al 2008 6 results in all computations presented hereafter we have set unless otherwise stated r 6371 22 1 0 3 m g 9 80616 m 2 s 1 ω 7 295 1 0 5 s 1 and ρ 0 1025 kg m 3 simulations have been carried out with linear p 1 quadratic p 2 and cubic polynomials p 3 6 1 global atmospheric tests in this paragraph we test the dg scheme on some classical benchmarks taken from the test suite of williamson et al w92 17 44 global steady state nonlinear zonal geostrophic flow w92 case 2 is an exact steady geostrophic equilibrium allowing to measure the order of accuracy in presence of earth rotation the velocity and height fields are initially given by h φ λ h 0 1 g ω r u 0 u 0 2 2 cos λ cos φ sin α sin λ cos α 2 54 u 1 φ λ u 0 cos λ cos α cos φ sin λ sin α u 2 φ λ u 0 sin φ sin α with g h 0 2 94 1 0 4 m 2 s 2 and u 0 2 π r 12 days and α 0 grid convergence studies gave been conducted on 5 icosahedral grids from level 1 h k 3571 km to level 5 h k 223 km relative errors are evaluated following 44 55 e p e l p h e x l p with e h h e x and h e x the exact solution the errors obtained at day 5 are reported on table 1 convergence curves are compared in fig 1 against the results of the original 6 to make the comparison effective only for this experiment we have tried to stick to their same scheme dg in the weak form 32 with lax friedrich flux we have remarked that the use of the well balanced momentum form 43 has almost no impact on the errors the theoretical order of convergence has been obtained with smaller errors with respect to the reference we explain this improvement by the cancellation of the geometrical error in the sphere representation as it is customary we report in fig 2 the error maps after 5 days of simulation on the fourth grid h k 446 km zonal flow over an isolated mountain w92 case 5 is a perturbation of the previous test the initial velocity and height fields are equal to 54 with α 0 h 0 5960 m and u 0 20 m s an isolated mountain is added 56 b b 0 1 r r with b 0 2000 m r π 9 r 2 min r 2 φ φ 0 2 λ λ 0 2 and with the center of the cone in φ 0 λ 0 3 2 π π 6 simulations are performed on the fourth icosahedral grid h k 446 km fig 3 provides height contour lines for p 1 p 2 and p 3 computations after 15 days of physical time for this case one typically checks the conservation of total mass and energy 57 e h 1 2 u 2 g h 2 g b mass error should be only related to round off errors regarding the energy the proposed scheme have no provable energy conservation properties which makes the definition of the actual discrete evaluation of the energy somewhat arbitrary in practice here the energy is computed directly from nodal quantities and then integrated using the high order finite element approximation after 15 days mass is conserved within a relative error of 1 e 13 relative energy conservation error is reported on the right column in fig 3 it is comparable to or better than those typically reported in literature in the same figure we compare with a second order residual distribution scheme proposed by the authors 2 with a third order fv scheme on a cubed sphere 41 and with the high resolution results by the german weather service dwd http icon enes org swm stswm node5 html unstable jet the last global test taken from galewsky et al 2004 consists of a geostrophically balanced mid latitude jet to which a small perturbation is added to initiate the instability we use this test to confirm that the polar treatment has no impact on the numerical solution and on its derivatives we look to the vorticity field for p 1 p 2 and p 3 solutions but with two different z lim the one used in other experiments z lim 0 9 r and z lim 0 75 r for which the polar cap interface falls exactly into the jet mesh convergence has been carried on two successive icosahedral grids level 5 and 6 respectively 223 km and 111 km see figs 4 5 at both mesh level p 1 solution is insufficient to support the vortex evolutions increasing the order p 2 p 3 computations at mesh level 5 provide the correct dynamics but the vorticity contours are a little bit jagged at level 6 much of the jaggedness disappears 6 2 small amplitude barotropic waves with this test we look to the impact of the well balancing correction for classical oceanic applications such as tidal and surge waves we have taken a basin spanning from 0 to 25 e and from 35 n to 55 n the bathymetry is a smooth gaussian hump mimicking a continental shelf and an isolated mountain b max b 0 exp r 0 2 r b 1 1 r 1 r with b 0 2000 m r 0 π 12 r 0 2 8 5 φ φ 0 2 λ λ 0 2 φ 0 λ 0 0 π 4 and b 1 4000 m r 1 5 π 180 r 1 2 φ φ 1 2 λ λ 1 2 φ 1 λ 1 10 π 180 48 π 180 the mesh is an unstructured triangulation with topology shown in the top of fig 6 and constant mesh size h k 100 km for a lake at rest state with initial level η 0 5000 m the well balanced spherical formulation 43 exhibits a maximum perturbation of the velocity norm in the range 1 e 12 to 1 e 13 depending on the polynomial order after this well balancing test a small amplitude tidal signal η 0 a sin 2 π t t is imposed at the north boundary a 0 01 m t 12 42 h the eastern boundary is a wall to let a southward propagating barotropic kelvin wave develop we compare 43 against the non well balanced scheme based on the weak formulation 32 in the left block of fig 6 two snapshots of upwelling downwelling at the lateral wall show that the p1 solution of the non well balanced scheme is affected by small wiggles the perturbation tend to disappear as expected with mesh resolution see right block and with polynomial order not shown a second test has been carried by forcing a surge wave with a small amplitude atmospheric depression p a t m φ λ t p 0 δ p exp r φ λ t σ 2 with r the distance from the center of the storm which is translating southward at constant speed u the parameters are set to p 0 101 kpa δ p 0 3 kpa σ 350 km and u 100 g in fig 7 we show the impact of the well balanced correction again at the coarse resolution left block the small amplitude gravity waves that propagate faster then the storm are much wiggled in the non well balanced case increasing mesh resolution see right block and polynomial order not shown makes again such wiggles negligible 6 3 circular hump centered at the equator this is a test proposed in rossmanith 2006 the initial condition is a circular depth disturbance at the equator 58 h φ λ 2 if arccos cos φ cos λ 0 2 0 2 otherwise u φ λ 0 this initial condition is symmetric about the point φ λ 0 0 and should remain symmetric in absence of rotation shock capturing is necessary to well represent the discontinuity we run computations on two half sphere meshes generated with gmsh a coarse one with 2436 points a fine one with 9187 points in fig 8 we compare the solution contours obtained with p1 p2 on the coarse mesh against a p1 solution on the fine mesh we observe mesh order convergence for this non smooth case at t 0 9 the p2 solution on the coarse mesh is of the same order of accuracy of the p1 solution on the fine mesh we repeat the same test adding rotation effects we set the dimensionless rotation rate to ω 5 in fig 9 we report depth contour lines at t 1 2 as in the previous case we observe the higher resolution obtained with p2 scheme both in smooth and discontinuous regions 6 4 realistic external gravity waves simulations finally to show the potential of this method we perform two realistic simulations in the caribbean sea the computational domain the bathymetry and the mesh were specified by the consortium of the project interreg carib coast https www interreg caraibes fr carib coast the domain in fig 10 spans from 50 w to 84 7 w and from 8 4 n to 22 1 n the bathymetry at the degrees of freedom is computed from gebco www gebco net and from shom for the french west indies https data shom fr donnees land boundaries are treated as reflective walls to avoid wetting drying of cells near the coastline we have filtered the bathymetry at land masses contained in the computational domain with b f i l t min b 1 m the filter assures that all the cells are always wet avoiding positivity preserving issues and well balancing of partly dry cells all aspects not addressed in the present study the mesh has variable mesh size ranging from h k m a x in deep ocean to h k m i n at the coast in correspondence of martinique guadaloupe and saint martin islands which represent some interest sites of the carib coast project a fine and a coarse mesh have been generated respectively with h k m i n 300 m h k m a x 10 km and h k m i n 600 m h k m a x 20 km the manning friction term is set to n 0 025 for this case 6 4 1 tsunami in carribean sea the initial tsunami waveform is associated with a random rupture of the lesser antilles subduction zone we use the fault configuration proposed by feuillet et al characterized by a magnitude m w 8 4 for the fault parameters see feuillet et al 2002 randomness is associated to the heterogeneity of the fault slip which is computed by a karuhnen loeve expansion 28 then the initial waveform is the solution of the okada linear model we have equipped the domain with several gauges placed in the near and far field in the near field we distinguish coastal gauges in bays or harbours point a pitre fort de france and nearshore gauges on the continental shelf martinique ne martinique w at far field we have placed the gauges in the carribean sea kingston and close to east boundary atlantic in order to look both to tsunami propagation after the wave has passed the antillean arch and free propagation in deep ocean in fig 12 we report the sea surface height recorded at the gauge stations for p1 p2 simulations on the coarse mesh and we compare them with the p1 simulation on the fine mesh the coarse p2 solution has roughly the same accuracy of the fine p1 solution in the near field and it is superior for far field propagation for the near field gauges the p1 solution captures sufficiently well the incoming trapped and reflected wave train even if the leading wave peak is slightly underestimated with respect to p2 40 cm at point a pitre for far field gauges p1 solution is very diffusive probably due to the simple lax friedrich flux employed in this study similar results emerge from the snapshot of the sea surface height at t 5400 s 11 in fig 12 beyond mesh and order convergence we have validated the simulation against the structured high order fv code funwave tvd 40 on a regular grid with δ x 800 m which has roughly the same degrees of freedom of the p2 coarse simulation the comparison is valid for the first two hours after funwave tvd solution is polluted by wave reflection from the boundary see the gauge atlantic ocean close the western boundary 6 4 2 irma hurricane we perform the simulation of the atmospheric surge produced by the passage of hurricane irma in the caribbean sea from 30th august 2017 to 14th september 2017 as known such phenomena link up great depressions and strong winds leading to sea level rise and flooding risk at the coast in order to account for atmospheric forcing the source term of the shallow water equations has to be modified with the wind force f w in eq 16 defined by 59 f w c d ρ a i r ρ 0 u 10 u 10 where ρ a i r is the air density u 10 is the wind velocity field ten meters above the ground and c d is the wind stress coefficient as proposed by charnock 1955 with charnock parameter set to 0 022 32 to construct the hurricane pressure and wind fields we used information issued from the noaa ibtracks 26 database and we applied the holland parametric model 22 computed hurricane winds are then converted to surface winds and averaged over 10 min after that cyclonic wind and pressure fields are finally merged with data from cfsr model 39 in order to represent large scale atmospheric conditions in the whole computational domain our simulations run from 5th september 2017 to 8th september 2017 simulating the hurricane strike on the caribbean french islands virgin islands and puerto rico fig 13 shows the hurricane surge propagation simulated by the p1 coarse mesh indistinguishable results at this scale are obtained using the p2 coarse mesh thus they are not reported here several noaa nos and shom tide gauges are available in the area allowing to validate our simulations against real observations measured sea level is the result of several components the tide a seasonal adjustment due to baroclinicity 35 the setup due to breaking waves and finally the atmospheric surge due to wind and pressure the first three components cannot be reproduced by our model therefore before comparison we processed raw signals such as to remove the tide and we applied a mean sea level offset to account for baroclinicity 24 in this way we were able to produce the pictures of fig 14 comparing simulations and observations at four gauges located close to the hurricane track we can appreciate a global agreement between computed water levels by both p1 and p2 simulations and historical data the use of p2 approximations in this case leads to very few improvements in the results only noticeable on the pick representation at the location closest to the hurricane track saint martin and lameshur discrepancies in the results may be due to different factors such as the parametric reconstruction of hurricane pressure and wind fields other source of discrepancies may be due to the wave setup contribution to observed water level and or the coarse representation of the insular shelf 1 km in the computational mesh of the carib coast project further investigations could improve the results but this is beyond the purposes of this work 7 conclusion in this work we have discussed an efficient and accurate formulation of the spherical shallow water equations in the form originally proposed in bernard et al 2009 which implies a mixed 3d 2d treatment the time derivative is expressed in 2d form while the right hand side is formulated in 3d cartesian form we have shown that using for the 2d part covariant vector basis the implementation simplifies and the accuracy increases in this work we have opted for a discontinuous galerkin discretization but the mixed 3d 2d covariant form is in principle also more amenable to a continuous finite elements discretization w r t to the original 6 in particular local mass matrix goes back to the standard block diagonal form line integrals or riemann problem do not imply tensor vector rotation thanks to the continuity of the normals at the edges we have also discussed a well balanced form of the resulting dg scheme resorting the hydrostatic pressure term to the strong form finally with a realistic tsunami and a historical storm surge simulation we have validated the method for two different oceanographic applications ongoing work is devoted to extension of the discretization of the 3d 2d covariant shallow water equations to stabilized continuous finite element supg or continuous interior penalty see e g abgrall and ricchiuto 2017 and michel et al 2021 and references therein and to perform a one to one comparison with the current implementation credit authorship contribution statement luca arpaia conceptualization methodology software validation writing mario ricchiuto conceptualization methodology formal analysis writing andrea gilberto filippini visualization validation rodrigo pedreros funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments work partially funded by the carib coast interreg project https www interreg caraibes fr caribcoast some of the computations presented in this paper were carried out using the brgm experimental testbed all the developments presented have been implemented in the platform aerosol uhaina co developed by epoc imag imb and inria in particular we are very grateful to vincent perrier for the time dedicated to us on the aerosol library and for his availability all along the implementation of the present work appendix bounds on the integration by parts correction to prove the bounds 41 we start by characterizing the mapping 12 used for the quadrature with a classical property see e g ciarlet and raviart 1972 engvall and evans 2020 for curved finite element examples property 1 bounds on the mapping derivatives the mapping 12 and its derivatives verify the following estimates 60 j a o h 61 x m j a o h m 1 62 j a o h 2 63 x j a o h 3 proof to prove the estimates we start by noting that denoting by x g j 1 3 x j 3 f l x j 1 3 φ j x x j l x g l j 1 3 φ j x x j l x g l x g l h j 1 3 δ j l φ j x with δ j l x j l x g l h the rescaled components of the distance of the nodal positions from the average which is of o 1 for shape regular meshes and with φ j the linear finite element basis the above expression can be written as a linear multivariate polynomial in terms of the components of h x with o 1 coefficients we write succinctly 64 f l p l 1 h x and similarly x l x p l 1 h x f where now with p k h x we denote a multivariate polynomial of degree k in the components of h x with o 1 coefficients to obtain the first two estimates we prove that any k th order differential of the mapping w r t any component or combination of the components of x verifies 65 k x l x h k p l k 1 h x f 2 k 1 to prove by induction we check the initial condition x l x f p l 1 h x p l 1 h x f f 2 we can use now to write f h f m 1 3 j 1 3 f m x δ j m φ j x where note that the derivatives of the linear basis functions are of o 1 in particular they assume the values 1 0 or 1 on the standard unit triangle containing the origin of the parametric space we can write x l x f 2 p l 1 h x h p l 1 h x m 1 3 j 1 3 f m x δ j m φ j x f 3 all it remains is to note that the derivative of p l 1 h x can be written as a 0 l h for some o 1 constant a 0 l so that x l x h f 2 a 0 l p l 1 h x l 1 3 j 1 3 f l x δ j l φ j x f 3 in which the numerator is indeed a quadratic polynomial of the components of f which combined with 64 leads to x l x h p l 2 h x f 3 we need now to prove that if true for k 1 the statement is also true for k so we assume that k 1 x l x h k 1 p l k h x f 2 k 1 and compute its differential k x l x h k 1 p l k h x f 2 k 1 p l k h x 2 k 1 f 2 k 2 f f 4 k 2 h k 1 p l k h x f 2 p l k h x 2 k 1 f f f 4 k 2 2 k 3 h k 1 p l k h x f 2 h p l k h x 2 k 1 l 1 3 j 1 3 f l x δ j l φ j f 2 k 1 as before we remark that p l k h x h p l k 1 h x which allows to write k x l x h k p l k 1 h x f 2 h p l k h x k 1 l 1 3 j 1 3 f l x δ j l φ j f 2 k 1 which indeed by virtue of 64 can be written as 65 and concludes the induction to conclude this preliminary proof we note that given an upper bound to the mesh size h h we can easily find a uniformly bounded constant c h such that f is bounded in between r and r c h h and 1 f is bounded as well using this remark and the boundedness and the coefficients of p l k the first of the properties sought is obtained for k 1 the second for k m 1 the k 1 property allows readily to prove 62 by using the definition j a g g det j a t j a since the determinant of a 2 2 matrix is a quadratic form of the matrix entries this means that g o h 4 by virtue of 60 and g o h 2 which implies 62 by the definition of j a lastly the properties 60 61 62 can be used to show that x j a o h 3 hence 63 to complete the proof of the estimate we now rewrite each of the integrals in the parametric space and perform a truncated taylor series expansion with the appropriate degree in the parametric coordinates to obtain an estimate of the quadrature error we will show the procedure for one of the integrals of 40 and provide comments concerning possible differences when evaluating others so let us consider the evaluation of 66 i 1 k p h i φ i g α d x as we said in the main body of the paper g α is available in a uniformly bounded analytical form for example in latitude longitude coordinates note that with the usual assumption of smoothness removing from the variational form its analog evaluated on an exact regular solution would lead to estimating the last integral via expressions of the type k p h e x p e x i φ i g α d x which provide at best an estimate of an o h p 3 which is related to the approximation error and it is independent on the quadrature however the theoretical and numerical evidence indicates a stricter bound as we will show shortly first we write the integral in the parametric space i 1 k p h x x i φ i x g α x x j a x d x the above integral can be written regrouping the terms as i 1 k f ˆ x j i a x d x having separated for convenience the terms that are defined directly in the reference space j i a x φ i x j a x from the terms defined in the physical space f ˆ x f x x we remark now that we can write within each parametric element j i a as a 0th order truncated taylor series j i a j i a x x j i a x x x x where following the lagrange representation of the taylor series remainder for a given x the point x x lies along the segment x x we can easily estimate the remainder from x j i a x x x φ i x x x j a x x x x x φ i j a x x x x with x φ i constant and of o 1 in the p 1 case as already remarked from 63 x j a x o h 3 and j a x o h 2 it follows that the second term of the above expression is not of higher order so the rest of the truncated series is of o h 3 we now also develop f ˆ in a taylor series truncated at the degree k k which is the assumed polynomial exactness of the volume quadrature formula combining with the previous development we obtain using standard multi index notation and again a lagrange representation of the taylor series remainder i 1 k α 0 k k 1 α d x α f ˆ x x α j i a x d x k α 0 k k 1 1 α d x α f ˆ x x α x j i a x x d x k α k k 1 1 α d x α f ˆ x x α j i a x d x k α k k 1 α d x α f ˆ x x α x j i a x x d x where we recall that in multi index notation d x α α x 1 α 1 x 2 α 2 for brevity we have omitted the explicit dependence of the remainder terms on the x x point which in principle is different for the two development considered since it has no relevance in the following by classical arguments we claim now that the first two integrals involving degree k k polynomials represent the value obtained with the approximate formula used in our method so that the remaining terms provide an estimate of the quadrature error e i 1 k α k k 1 1 α d x α f ˆ x x α j i a x d x k α k k 1 α d x α f ˆ x x α x j i a x x d x since the volume of the reference element k is of an o 1 we need to estimate the derivatives of f ˆ and combine with the available estimates j i a x o h 2 and x j i a x x o h 2 to estimate the derivatives of f ˆ we now use the fact that α f d α f and 60 61 and obtain x f x x j a x f c 1 h d x 1 f x 2 f x x x j a x f j a 2 x 2 f c 2 h 2 max m 2 d x m f x 3 f x x x 2 j a x f x j a j a x 2 f 2 j a x j a x 2 f j a 3 x 3 f c 2 h 3 max m 3 d x m f etc the k th derivative can be shown by induction omitted for brevity to be bounded by d x k f ˆ c k h k max m k d x m f so that the quadrature error for the term under consideration can be estimated to 67 e i 1 c i 1 max k k k d x k f h k k 2 c i 1 max k k k 1 d x k f h k k 3 c i 1 max k k k d x k f h k k 2 we can proceed in a similar manner for the other integrals in 40 to obtain i 2 k p h i x φ i g α d x e i 2 c i 2 max k k k d x k f h k k 1 i 3 k x p h φ i g α d x e i 3 c i 3 max k k k d x k f h k k 1 note that for these terms the presence of the derivative in the physical space x let the estimate one order of magnitude larger in h with respect to 67 similarly for the line integral i 4 k p h i g α φ i n d s e i 4 c i 4 max k k k d x k f h k k 1 by summing up the different integrals we have obtained for the well balanced correction 40 the following bound ε p k i 1 e i 1 i 2 e i 2 i 3 e i 3 i 4 e i 4 e i 1 e i 2 e i 3 e i 4 c h min k k 1 k k 1 having used the fact that for exact quadrature the sum of all the integrals i j vanishes this proves the result of the proposition note that the constant on the left actually depends on the integrand so in particular on the pressure field and its derivatives so it is bounded provided these are we perform a numerical verification with the values used for all the numerical simulations of the paper namely k k k k 3 p we consider a smooth pressure field p φ λ 2 sin 2 π φ cos 2 π λ defined on a spherical triangle which is successively refined halving the mesh size in fig 15 we check the order of accuracy for ε p k computed as ε p k max k ε p k for p 1 p 2 we recover numerically the estimate of proposition 41 while for p 3 we measure one order less w r t such theoretical estimate 
23863,in this work we consider an efficient discretization of the shallow water equations in spherical geometry for oceanographic applications instead of the classical 2d covariant or 3d cartesian approaches we focus on the mixed 3d 2d form of bernard et al 2009 which evolves the 2d momentum tangential to the sphere by projecting the 3d cartesian right hand side on the sphere surface differently from the last reference we consider the exact representation of the sphere instead of the finite element one mixed with a covariant basis projection of the momentum this leads to several simplifications of the discontinuous galerkin scheme the local mass matrix goes back to the standard block diagonal form the riemann problem does not require any tensor or vector rotations to align the bases on the two sides of an edge second we consider well balancing corrections related to relevant equilibrium states for tsunami and storm surge simulations these corrections allow to compensate for the inherent non exactness of the quadrature induced by the non polynomial nature of both the geometrical mapping and of the covariant basis in other words these corrections are the order of the cubature error we show that their addition makes the scheme exactly well balanced and is equivalent to recasting the integral of the hydrostatic pressure term in strong form the proposed method is validated on academic benchmarks involving both smooth and discontinuous solutions and applied to realistic tsunami and a historical storm surge simulation keywords shallow water equations spherical geometry discontinuous galerkin well balanced schemes tsunami storm surge 1 introduction coastal flooding is mainly caused by meteorological and telluric phenomena which may occur at the scale of the oceanic basin the numerical simulation of such events requires to solve the governing equations in a spherical geometry in this work we consider the shallow water equations swes which provide satisfactory results for long wave phenomena such as tide storm surge and tsunami the literature devoted to discrete formulation of the swes on the sphere is quite large two methods have emerged in the past to deal with the earth curvature a common approach among contemporary ocean models consists in a two dimensional parametrization of the sphere through a proper curvilinear coordinate system then the primitive or shallow water equations are written directly on the curved manifold meaning that all the differential operators are transformed in curvilinear coordinates a metric source term arises from the space variation of the curvilinear vectors basis the underlying equations in curvilinear coordinates are typically discretized on regular grids with finite differences finite volume schemes regional models use the traditional latitude longitude parametrization unfortunately for global ocean models the latitude longitude coordinate system has a singular point in the arctic ocean at the north pole where the meridians converge on water the jacobian of the coordinate transformation is not defined and moreover the singularity imposes a severe restriction on the maximum time step allowed for stability nowadays the pole problem is considered merely as an economical one 43 in particular meteorologists have used a variety of fixes to circumvent the singularity and all of such fixes employ multiple curvilinear coordinates defined on different patches covering the whole sphere kageyama and sato 2004 ronchi et al 1996 then a specific treatment of the flux term at the edges dividing the patches where the tangent basis changes is deployed a rotation of momentum vector nair et al 2004 or an orthonormalization of the riemann problem ullrich et al 2010 rossmanith 2006 assure a common reference system at the edge and local conservation to bypass the pole problem ocean modelers have used instead ad hoc curvilinear coordinates conceived to place the singularity point on lands see for example the tripolar grid of madec and imbard 1996 finally for finite volume methods some authors 38 claimed that extra care should be taken in the resolution of the riemann problem in curvilinear coordinates a second approach consists instead in resolving the governing pdes in a three dimensional cartesian framework and then adding a constraint to force the currents to remain tangent to the sphere 11 19 with this approach it is more common to represent the sphere approximately through a local finite element map for each element thanks to the local map no special treatment is required in polar regions to preserve accuracy and to conserve global mass a third approach seems to combine the advantages of both methods 6 momentum time derivative is written with respect to 2d components while the right hand side is first expressed in 3d and then projected back onto the sphere surface by a simple scalar product with respect to the tangent basis the advantage is that the number of unknown is kept to a minimum water depth and two momentum components and at the same time the right hand side maintains a cartesian form thus it is independent from the parametrization of the sphere and moreover there is no need to transform the differential operators for example in tsunami applications this could be laborious for depth averaged non hydrostatic models with dispersive terms that involve mixed high order derivatives if requested riemann solvers are formulated easily in 3d cartesian framework and then projected on the sphere surface along with the right hand side in the last reference the geometrical error related to the approximation of the curvature of the sphere is controlled by using higher order super parametric finite element approximations of the spherical geometry here we present some improvements of the mixed 3d 2d formulation of bernard et al 2009 applied to spherical geometry first we use an exact representation of the spherical elements which allows to avoid the pole problem altogether a similar idea is used in the recent work by baldauf 2020 in our case we then introduce a 2d covariant representation of the momentum vector this combination completely cancels the geometrical error related to the sphere curvature in practice we can use any local reference mapping we want to represent the 3d spatial coordinates including the classical latitude longitude transformation due to the orthogonality of covariant vector basis the momentum equations remain decoupled as in the planar case which simplifies the structure of the update moreover the riemann solvers also simplify thanks to continuity of the geometrical quantities as well as of the covariant basis at the elements edges more precisely no rotations of the velocities momentum components nor averaging of the normals are required the discontinuous galerkin dg method is becoming increasingly popular in geophysical fluid dynamics proving also in this field its potential in terms of high order accuracy conservation properties and ease of massively parallel implementation it has been applied to the spherical swes in different forms at the opposite ends of the spectrum we mention the purely two dimensional form on the cubed sphere 33 and the fully 3d cartesian form on a finite element quadrilateral grids 19 here we discretize the spherical swes in the proposed 3d 2d covariant form then we look to the well balanced property or the discrete preservation of some steady states which are of particular interest for tsunami and storm surge computations these states include the lake at rest which results from the steady balance between hydrostatic pressure and the force played by the bottom and the inverse barometer in which the atmospheric pressure effect is also added to the balance in general well balanced methods are more robust and allow to work with coarser mesh a well balanced dg method typically relies on the fact that the so called strong form with a second integration by parts of the volume flux term embeds more easily then the weak form the well balanced property at a discrete level based on the fact that the strong form is more suited to retain well balancing some authors 14 and 45 while being stuck to the weak dg form with one integration by parts of the flux term compute exactly the integrals in order to maintain a discrete equivalence to the strong form other authors see e g vater et al 2019 write directly the scheme in the strong form this has close similarities with fully residual based methods see e g abgrall and ricchiuto 2017 ricchiuto 2015 and allows to obtain well balancing independently on the quadrature formula used such flexibility is used to retain general well balanced states on the sphere 7 here we start from the weak dg form and we show that when applied to the mixed 3d 2d formulation of the swes it is unable to preserve equilibria due to inexactness of the quadrature formula with non polynomial functions as the ones contained in the components of the tangent vectors we add a well balancing correction related to relevant equilibrium states for tsunami and storm surge simulations these corrections involve the quadrature error there are thus small by definition and compensate for the lack of summation by parts property making the scheme exactly well balanced we show that this idea is equivalent to recasting the integral of the hydrostatic pressure term in the strong form the paper is organized as follows in section 2 we introduce the notation for the spherical geometry in section 3 we introduce the swes in the 3d 2d covariant formulation in section 4 we discuss their well balanced dg approximation in section 5 we detail computational aspects such as shock capturing and time stepping in section 6 we evaluate the proposed methods on standard global benchmarks for the shallow water equations on the sphere and on regional realistic tsunami storm surge computations 2 tangent maps for the sphere we consider a sphere s 2 with radius r described by generic curvilinear coordinates x 1 x 2 and tangent basis t 1 t 2 the coordinate vector x then writes 1 x x i e i x 1 e 1 x 2 e 2 x 3 e 3 2 x α t α x 1 t 1 x 2 t 2 note that in the above definitions and in the following ones repeated indices imply summation in particular latin indices are used for the components of vectors in cartesian coordinates from 1 to 3 while greek indices are used for vectors in local curvilinear coordinates from 1 to 2 the transformation from the curvilinear space to the physical space is defined here as x t x it has a jacobian or transformation tensor 3 j t x x with components j t i α and an inverse jacobian 4 j t 1 x x with components j t 1 α i the tangent vectors can be obtained by differentiation as the columns of the jacobian it is useful to normalize the basis 5 t α x x α t α t α t α in general t α t β δ α β finally we define the metric tensor constructed from the jacobian matrix as 6 g j t t j t and g det g having denoted by t the matrix transpose if the inverse jacobian cannot be computed directly from the definition 4 it can be replaced by the pseudo inverse 7 j t 1 g 1 j t t depending on the transformation different representations of the spherical geometry can be obtained 2 1 finite element map t can be a local finite element transformation giraldo et al 2002 bonev et al 2018 that maps a reference element to a spherical element denoted by 8 e k k k x j d o f s φ j x x j where x 1 x 2 are the reference coordinates and x j are the physical coordinates of the degrees of freedom the jacobian and the tangent vectors follow from the application of the definitions 3 and 5 while the inverse jacobian 4 has to be intended as the pseudo inverse a high order accurate geometry is usually attained by increasing the polynomial degree of the basis functions φ j 2 2 spherical map in this work we will use the exact spherical transformation defined here as 9 g π π π 2 π 2 s 2 x g x where x 1 r cos x 2 cos x 1 10 x 2 r cos x 2 sin x 1 x 3 r sin x 2 with x 1 the longitude and x 2 the latitude explicit expressions for the jacobian inverse jacobian and tangent vectors follow from 3 5 for example the jacobian reads 11 j g r cos x 2 sin x 1 r sin x 2 cos x 1 r cos x 2 cos x 1 r sin x 2 sin x 1 0 r cos x 2 the tangent vectors are also called covariant vectors and they are denoted as g α x x α please note that the normalized covariant basis is orthonormal g α g β δ α β as already mentioned the spherical transformation is singular at the poles an alternative and equivalent exact map that avoids the pole singularity but does not keep orthogonality of the tangent basis is the following local transformation that maps a reference element to a spherical element 12 a k k k x r f x f x where f j 1 3 φ j x x j is the p1 finite element transformation from the reference element to the 3d element the above transformation has a smooth jacobian 3 everywhere 13 x k x α r f j 1 3 φ j x α x j k r j 1 3 φ j x x j k f 2 f x α from which we can compute the normalized tangent vectors with 5 3 shallow water equations in spherical geometry we consider the swes in spherical geometry with uneven bathymetry and in presence of earth rotation we express them in a generic vector form 14 h t h u 0 15 h u t t s with h the fluid depth h u the discharge momentum vector and having denoted the momentum flux tensor by t the source s includes the effects of bathymetry bottom friction coriolis force and meteorological forcing 16 s g h b c f h u 2 ω k h u g h ρ 0 p a t m f w in the formula above b x denotes the bathymetry topography c f the friction coefficient given by the manning formula ω the earth rotation rate and k the earth rotation axis p a t m is the atmospheric pressure ρ 0 is the water density and f w represents the wind forcing turbulent eddy viscosity term has been neglected the expressions of nabla of the momentum vector h u and of the tensor t depend on the coordinate system in which they are expressed the most common representations used for the shallow water equations are either the 3d cartesian coordinates or the curvilinear coordinates defined in section 2 the momentum vector h u can be expressed in both systems see 1 and 2 as 17 h u h u i e i h u 1 e 1 h u 2 e 2 h u 3 e 3 18 h u α t α h u α 1 t 1 h u α 2 t 2 we remark that for curvilinear coordinates momentum components are not defined in a unitary basis it may be convenient expressing momentum in a unitary basis 19 h u h u α t α t α t α 20 h u α t α the relationship between the velocity components written in the two basis is 21 u i j t i α u α u i j t i α u α where j t i α j t i α t α repeated index summation does not apply here is the jacobian 3 normalized by columns similarly the second order flux tensor t can be expressed in both coordinate systems as 22 t t i j e i e j 23 t α β t α t β with cartesian components t i j h u i u j p δ i j and curvilinear components t α β h u α u β g p δ α β the hydrostatic pressure is defined as p g h 2 2 and g is the determinant of the metric tensor 6 3 1 equilibrium states for coastal flows an important role is played by the so called lake at rest state which denoting the free surface level η h b is the particular steady solution characterized by the two invariants 5 24 h u 0 z η c o n s t z 0 in presence of atmospheric pressure forcing a relevant state is the inverted barometer balance that is an exact solution of the swes in case of full adjustment of sea level to changes in barometric pressure 18 25 h u 0 z η p a t m g ρ 0 c o n s t z 1 full adjustment is never reached since the pressure field is unsteady p a t m x t thus one may question if this is really a relevant equilibrium but it is interesting to be able to handle this possibility numerically in mercer et al 2002 it has been shown that at least in deep water the free surface response is almost isostatic and characterized by small perturbations around the inverted barometer balance in light of these findings and for completeness we have investigated the more general balance 25 a numerical method approximating 14 15 is said to be well balanced if 24 or 25 are also exact solutions of the discrete equations in other words well balanced schemes provide a discrete analog of the balance between hydrostatic pressure and the forces exerted by the bottom and by atmospheric pressure 26 p i g h b p a t m g ρ 0 3 2 fully diagonal mixed 3d 2d covariant formulation following bernard et al 2009 we proceed as follows to obtain the fully discrete equations 1 we project the momentum eq 15 on the tangent plane t h u t α t t α s t α 2 the scalar product contained in the time derivative is performed with momentum expressed in curvilinear coordinates while the scalar product involving the rest of the equation is performed in 3d cartesian coordinates 27 t h u β t β j t α j t j k x k t α j s j t α j e g α 1 t h u 1 t 1 t 1 h u 2 t 2 t 1 t 11 x 1 t 12 x 2 t 13 x 3 t 1 1 t 21 x 1 t 22 x 2 t 23 x 3 t 1 2 t 31 x 1 t 32 x 2 t 33 x 3 t 1 3 s j t 1 j one advantage of this formulation with respect to full 3d equations is that the number of unknowns is kept minimum h h u 1 h u 2 another attractive feature is that the flux function stays in 3d form and does not depend on a particular transformation this means that line integrals are defined intrinsically and mass is easily conserved circumventing implementation issue related to the use of composite meshes in the 2d approach the drawback of this formulation compared to the fully two dimensional one is that for each momentum equation 9 components of the fluxes have to be evaluated instead of three and that in general the curvilinear momentum components are coupled however differently from bernard et al 2009 we propose to use the exact spherical representation thus we have to project momentum on the exact tangent basis we can choose either the covariant framework 10 or the local transformation 12 here we have used locally in each element the covariant framework guaranteeing the decoupling of the momentum components and for which simple analytical expressions exist for the tangent vectors g α x x α we project onto the normalized tangent basis 5 to get 28 t h u g α t g α s g α or by components e g α 1 t h u 1 g 1 g 1 1 h u 2 g 2 g 1 0 t 11 x 1 t 12 x 2 t 13 x 3 g 1 1 t 21 x 1 t 22 x 2 t 23 x 3 g 1 2 t 31 x 1 t 32 x 2 t 33 x 3 g 1 3 s j g 1 j so in practice we work with 29 t h u α t j k x k g α j s j g α j this choice allows to take advantage of the orthogonality of the covariant basis and work with a fully diagonal system which is the main advantage of the formulation proposed here please note also that this algorithm evolves physical components of momentum h u α in m 2 s eastward for α 1 and northward for α 2 4 well balanced discontinuous finite element discretization we consider a discretization of s 2 composed by non overlapping triangular elements k to each element k we can associate an element defined in the parametric space which we denote by k for a given mesh we label by the roman h the characteristic mesh size measured in physical space following a high order dg procedure we project the vector of conserved variables and the bathymetry into the finite dimensional space 30 v h p φ φ x l k p x k where l k p are lagrange polynomials of degree p defined on each parametric element k we obtain the weak formulation multiplying the mass eq 14 and the momentum eq 28 by a smooth test function φ i that belongs to the same space 30 and integrating it on a spherical triangle k 31 t k h h φ i d x k h u h φ i n d s k h u h φ i d x 0 32 t k h u h g α φ i d x k t h g α φ i n d s k t h g α φ i d x k s h g α φ i d x where t h denotes the numerical flux evaluated at the elements boundaries and the symbol is the scalar product between second order tensors a b a i j b j i as noted in bernard et al 2009 if we regroup g α φ i v i α then 32 corresponds to consider a vectorial test function for each momentum equation several aspects need to be clarified first of all the mapping required to define the quadrature formulas which will involve non algebraic transformations secondly the well balancedness w r t the equilibria presented earlier is not trivial in this formulation as exact quadrature is impossible precisely due to the non algebraic nature of the mappings adopted these aspects are covered in the next sections 4 1 reference element mapping and quadrature all the integrals are computed on the standard reference triangle k for the transformation which map a reference triangle to a spherical triangle we use 12 which allows to bypass the pole singularity in the evaluation of the integral and the differential operators consider for example the volume integral in the momentum equation which we decompose into 33 k t h g α φ i d x k t h k j x k g α j φ i d x k t h k j φ i g α j x k d x k t h k j g α j φ i x k d x both the resulting integrals are mapped using 12 so the differential is rescaled based on the mapping jacobian 34 d x j a d x with j a g and g det j a t j a see 6 the derivatives of the test functions are evaluated classically via the gradient in the mapped element as 35 x k x β x k x β j a 1 β k x β with the inverse jacobian j a 1 g 1 j a t see 7 all the remaining quantities are evaluated analytically via the mapping 12 including the gradients of the covariant basis vectors which can be easily obtained analytically starting from 11 line integrals are evaluated similarly via a mapping to a reference 1d element as already remarked for the time derivative we can write 36 t k h u h g α φ i d x j d o f s k φ i φ j d x h u j α t which shows that a fully block diagonal structure is retained as a final remark we note that differently from two dimensional formulations the right hand side appears in cartesian form and it is well posed on the whole sphere however the tangent basis in 32 is not well defined at the poles for the latitude longitude parametrization that we have chosen for this reason only to evaluate the tangent basis and its derivatives a polar cap defined by a limiting latitude z lim is deployed elements are flagged according to the baricenter position if z g k z lim we use a rotated spherical transformation replacing 10 with x 1 r cos x 2 cos x 1 37 x 2 r sin x 2 x 3 r cos x 2 sin x 1 the jacobian 3 inverse jacobian 4 and basis vectors 5 are modified accordingly note that this is only affecting the local representation of the 3d basis which remains perfectly continuous across element edges we found that the dg framework is well suited to handle such discontinuity at the elements edges with no modification necessary to the algorithm in particular each element updates the momentum components h u α in its own reference system thus zonal meridional components in standard elements and rotated components in polar cap elements in a dg method communication between elements is needed only for evaluating numerical fluxes since they are computed in a 3d framework and independent from the local coordinate system no specific treatment is necessary at the edges separating the polar cap in practice we have set z lim 0 9 r we will show that this value has no impact on the numerical results 4 2 integration by parts correction we are interested in the well balanced nature of the scheme we will first consider the lake at rest case the effect of the atmospheric pressure is added introducing an apparent topography 8 b b b p a t m g ρ 0 imposing the lake at rest the momentum components of the dg method reduce to 38 k p h i g α φ i n d s k p h i g α φ i d x k g h h b g α φ i d x one drawback of the mixed formulation emerges well balancing is lost because of the projection on the tangent basis an operation that involves the evaluation of non algebraic functions in all of the three integrals of 38 indeed even with constant bathymetry and constant pressure in general we cannot remove the geometrical integration error 39 ε p 0 k p 0 k i g α φ i d x k i g α φ i n d s this is an issue already encountered on curved finite element polynomial meshes 27 and is even more critical for the non polynomial approximation used here we remark that this was also highlighted in bonev et al 2018 in the context of the study of the well balancing of a fully 3d dg shallow water approximation on the sphere as observed in the last reference a more suitable form to guarantee the well balanced character of the method is the strong form we obtain a somewhat similar result here but we proceed in a different manner and finally only the pressure term is converted into the strong form our idea is to balance the scheme with a small correction which is within the quadrature error and thus much smaller than the truncation error of the scheme to achieve this we re inject into the scheme 32 the integration by parts error associated to the pressure terms given by 40 ε p k k p h i g α φ i d x k p h i g α φ i n d s k p h i g α φ i d x note that this term is identically zero for exact quadrature and reduces to 39 if the pressure is constant note also that the only ansatz made is that p h is the pressure associated to the finite element polynomial projection and in our specific case p h it is assumed to be a polynomial of degree 2 p thus infinitely differentiable we can characterize the correction term with the following property proposition ibp correction bounds let 40 be evaluated by means of quadrature formulas which are exact for polynomials of degree k k for the volume integrals and k k for the boundary integral the correction can be bounded as 41 ε p k c k h min k k 1 k k 1 the proof of the above property is reported in the appendix in practice we have computed all integrals with formulas exact for k k k k 3 p a numerical verification of the proposition for these choices is also reported in the appendix when 40 is added to the discrete momentum equation the variational form becomes 42 t k h h φ i d x k h u h φ i n d s k h u h φ i d x 0 43 t k h u h g α φ i d x k t h g α φ i n d s k t h g α φ i d x k s h g α φ i d x ε p k 4 3 numerical fluxes mass conservation and well balanced with discontinuous data for the mixed 3d 2d formulation all geometrical quantities are uniquely and objectively defined in 3d so we can use practically any riemann solver in 3d cartesian coordinates the line integral in the momentum eq 32 reads 44 k t h g α φ i n d s k t h n h g α φ i d s where h r 3 is a specified numerical flux h u l u r and u l and u r are the left internal and the right external states u h h u i in practice we use the lax friedrich flux we remark that the problem of using a common framework between the left and right state in the original 6 is no longer necessary since the normals are continuous at the edges only a change of basis is needed at this point to compute 3d velocities because they are only available from momentum update in 2d this is done with the right relationship in 21 and the definition of the sphere jacobian 3 the important consequence of this is that the method proposed conserves mass exactly without any special treatment of the normals on element boundaries to recover also the well balanced property in presence of discontinuous data besides the addition of the hydrostatic correction in 43 as in xing and zhang 2013 we evaluate the numerical flux at a reconstructed state u 3 and add a high order correction term the resulting well balanced mass momentum numerical flux distinguished by ˆ reads 45 h h u l u r 46 h ˆ h u l u r p h l p h l n for the definition of the reconstructed state u h h u i please refer to audusse et al 2004 a strategy for recovering a well balanced scheme in presence of discontinuous data for the bathymetry on non conforming elements is also discussed in bonev et al 2018 in real applications discontinuous data b p a t m arise for example when the correspondent fields are computed at the degrees of freedom from a local minimization problem for the bathymetry this can be beneficial to avoid gibbs phenomena when data is nearly discontinuous on one cell and the polynomial order is p 1 for the atmospheric pressure field we assume that it is continuously interpolated at the degrees of freedom in this case the well balanced correction related to the inverted barometer first line is mass correction second line is momentum correction 47 1 2 1 g ρ 0 α l f g h r h l 2 n p a t m l p a t m r is identically zero being p a t m l p a t m r proposition well balanced the mixed 3d 2d covariant dg method 42 43 with numerical fluxes 46 is well balanced in the sense that it preserves to machine accuracy initial data verifying 24 or 25 proof the main assumption is that either h h b h η 0 const or h h b h p a t m g ρ 0 h η 0 const within each cell for the lake at rest state the flux reduces to t h p h i then the discrete momentum eq 43 reduces to 48 k h ˆ p h i n g α φ i d s k p h i g α φ i d x k g h h b g α φ i d x where we have canceled the first term of the correction 40 with the third term in 43 since they are equal and with opposite sign similarly to xing and zhang 2013 the proof is based on the fact that in the lake at rest case the lax friedrich flux evaluated at the reconstructed state is h u l u r p h h l and one can check that the well balanced numerical flux thus simplifies as h ˆ u l u r p h h l i n since the left state is the internal state we can further write p h h l i n p h i n then the integrand of the first term in 48 cancels out at each quadrature point and the whole penalization term vanishes moreover for any order h h b h v h p on can show that 49 p h i g h h b h g j φ j h j 2 2 g h h b h g h h η h with h h b h η 0 const also the volume terms in 48 cancel exactly recovering the well balanced property the same arguments hold for the inverted barometer case but replacing b with b b p a t m g ρ 0 5 computational details 5 1 shock capturing the applications considered in this work may involve the formation of discontinuous solutions during the computation for tsunami simulations wave breaking occurring in shallow areas can cause the linear dg method to develop unphysical oscillations that eventually grow in time we cope with the possibility of non smooth solutions with an entropy viscosity approach guermond et al 2011 pasquetti 2017 which consists in adding a diffusion like term to the right hand side of 14 15 here we discuss the details related to the implementation of the diffusive term in a spherical geometry we consider only momentum equation since mass equation is a particular case given a diffusive flux tensor g μ h u the dg discretization in the mixed formulation of section 3 2 writes 50 i μ k g h g α φ i d x k g h n φ i g α d s k g h g α φ i d x to stabilize the shocks only the volume integral is retained and moreover we neglect the variation of the tangent basis so that integral 50 simplifies to 51 i μ k g h k j g α j φ i x k d x note that g k j g α j g α k is a diffusive flux tensor projected on the tangent plane as for the advective flux since we evolve momentum in the tangent basis we do not have access directly to g k j in cartesian basis however the diffusive tensor components are easily recovered from relationships 21 and 35 52 g k j μ h u j x k μ x k j g j β h u β μ h u β g β j x k μ j g j β h u β x k near the discontinuities the viscosity coefficient μ should be of order h k in order to kill oscillations while in smooth regions it is expected to be below the approximation order to this end we follow the principles originally proposed e g in guermond et al 2011 and pasquetti 2017 and define this coefficient starting from the total energy residual we refer to the last references for the formulation and to filippini et al 2018 and references therein for its parametrization 5 2 time stepping high order temporal accuracy is achieved as it is standard with a ssprk method 20 the time step is computed according to 53 δ t c f l min k ρ k 2 max f α l f f with ρ k the elemental inscribed circle radius and α l f f the lax friedrich parameter at face f for linear stability reason one should use c f l 1 2 p 1 being p the polynomial order of the approximation but for practical use in this work we always set c f l 0 5 for stability reasons when included the manning friction term is treated via a semi implicit splitting as e g in hou et al 2013 and delis et al 2008 6 results in all computations presented hereafter we have set unless otherwise stated r 6371 22 1 0 3 m g 9 80616 m 2 s 1 ω 7 295 1 0 5 s 1 and ρ 0 1025 kg m 3 simulations have been carried out with linear p 1 quadratic p 2 and cubic polynomials p 3 6 1 global atmospheric tests in this paragraph we test the dg scheme on some classical benchmarks taken from the test suite of williamson et al w92 17 44 global steady state nonlinear zonal geostrophic flow w92 case 2 is an exact steady geostrophic equilibrium allowing to measure the order of accuracy in presence of earth rotation the velocity and height fields are initially given by h φ λ h 0 1 g ω r u 0 u 0 2 2 cos λ cos φ sin α sin λ cos α 2 54 u 1 φ λ u 0 cos λ cos α cos φ sin λ sin α u 2 φ λ u 0 sin φ sin α with g h 0 2 94 1 0 4 m 2 s 2 and u 0 2 π r 12 days and α 0 grid convergence studies gave been conducted on 5 icosahedral grids from level 1 h k 3571 km to level 5 h k 223 km relative errors are evaluated following 44 55 e p e l p h e x l p with e h h e x and h e x the exact solution the errors obtained at day 5 are reported on table 1 convergence curves are compared in fig 1 against the results of the original 6 to make the comparison effective only for this experiment we have tried to stick to their same scheme dg in the weak form 32 with lax friedrich flux we have remarked that the use of the well balanced momentum form 43 has almost no impact on the errors the theoretical order of convergence has been obtained with smaller errors with respect to the reference we explain this improvement by the cancellation of the geometrical error in the sphere representation as it is customary we report in fig 2 the error maps after 5 days of simulation on the fourth grid h k 446 km zonal flow over an isolated mountain w92 case 5 is a perturbation of the previous test the initial velocity and height fields are equal to 54 with α 0 h 0 5960 m and u 0 20 m s an isolated mountain is added 56 b b 0 1 r r with b 0 2000 m r π 9 r 2 min r 2 φ φ 0 2 λ λ 0 2 and with the center of the cone in φ 0 λ 0 3 2 π π 6 simulations are performed on the fourth icosahedral grid h k 446 km fig 3 provides height contour lines for p 1 p 2 and p 3 computations after 15 days of physical time for this case one typically checks the conservation of total mass and energy 57 e h 1 2 u 2 g h 2 g b mass error should be only related to round off errors regarding the energy the proposed scheme have no provable energy conservation properties which makes the definition of the actual discrete evaluation of the energy somewhat arbitrary in practice here the energy is computed directly from nodal quantities and then integrated using the high order finite element approximation after 15 days mass is conserved within a relative error of 1 e 13 relative energy conservation error is reported on the right column in fig 3 it is comparable to or better than those typically reported in literature in the same figure we compare with a second order residual distribution scheme proposed by the authors 2 with a third order fv scheme on a cubed sphere 41 and with the high resolution results by the german weather service dwd http icon enes org swm stswm node5 html unstable jet the last global test taken from galewsky et al 2004 consists of a geostrophically balanced mid latitude jet to which a small perturbation is added to initiate the instability we use this test to confirm that the polar treatment has no impact on the numerical solution and on its derivatives we look to the vorticity field for p 1 p 2 and p 3 solutions but with two different z lim the one used in other experiments z lim 0 9 r and z lim 0 75 r for which the polar cap interface falls exactly into the jet mesh convergence has been carried on two successive icosahedral grids level 5 and 6 respectively 223 km and 111 km see figs 4 5 at both mesh level p 1 solution is insufficient to support the vortex evolutions increasing the order p 2 p 3 computations at mesh level 5 provide the correct dynamics but the vorticity contours are a little bit jagged at level 6 much of the jaggedness disappears 6 2 small amplitude barotropic waves with this test we look to the impact of the well balancing correction for classical oceanic applications such as tidal and surge waves we have taken a basin spanning from 0 to 25 e and from 35 n to 55 n the bathymetry is a smooth gaussian hump mimicking a continental shelf and an isolated mountain b max b 0 exp r 0 2 r b 1 1 r 1 r with b 0 2000 m r 0 π 12 r 0 2 8 5 φ φ 0 2 λ λ 0 2 φ 0 λ 0 0 π 4 and b 1 4000 m r 1 5 π 180 r 1 2 φ φ 1 2 λ λ 1 2 φ 1 λ 1 10 π 180 48 π 180 the mesh is an unstructured triangulation with topology shown in the top of fig 6 and constant mesh size h k 100 km for a lake at rest state with initial level η 0 5000 m the well balanced spherical formulation 43 exhibits a maximum perturbation of the velocity norm in the range 1 e 12 to 1 e 13 depending on the polynomial order after this well balancing test a small amplitude tidal signal η 0 a sin 2 π t t is imposed at the north boundary a 0 01 m t 12 42 h the eastern boundary is a wall to let a southward propagating barotropic kelvin wave develop we compare 43 against the non well balanced scheme based on the weak formulation 32 in the left block of fig 6 two snapshots of upwelling downwelling at the lateral wall show that the p1 solution of the non well balanced scheme is affected by small wiggles the perturbation tend to disappear as expected with mesh resolution see right block and with polynomial order not shown a second test has been carried by forcing a surge wave with a small amplitude atmospheric depression p a t m φ λ t p 0 δ p exp r φ λ t σ 2 with r the distance from the center of the storm which is translating southward at constant speed u the parameters are set to p 0 101 kpa δ p 0 3 kpa σ 350 km and u 100 g in fig 7 we show the impact of the well balanced correction again at the coarse resolution left block the small amplitude gravity waves that propagate faster then the storm are much wiggled in the non well balanced case increasing mesh resolution see right block and polynomial order not shown makes again such wiggles negligible 6 3 circular hump centered at the equator this is a test proposed in rossmanith 2006 the initial condition is a circular depth disturbance at the equator 58 h φ λ 2 if arccos cos φ cos λ 0 2 0 2 otherwise u φ λ 0 this initial condition is symmetric about the point φ λ 0 0 and should remain symmetric in absence of rotation shock capturing is necessary to well represent the discontinuity we run computations on two half sphere meshes generated with gmsh a coarse one with 2436 points a fine one with 9187 points in fig 8 we compare the solution contours obtained with p1 p2 on the coarse mesh against a p1 solution on the fine mesh we observe mesh order convergence for this non smooth case at t 0 9 the p2 solution on the coarse mesh is of the same order of accuracy of the p1 solution on the fine mesh we repeat the same test adding rotation effects we set the dimensionless rotation rate to ω 5 in fig 9 we report depth contour lines at t 1 2 as in the previous case we observe the higher resolution obtained with p2 scheme both in smooth and discontinuous regions 6 4 realistic external gravity waves simulations finally to show the potential of this method we perform two realistic simulations in the caribbean sea the computational domain the bathymetry and the mesh were specified by the consortium of the project interreg carib coast https www interreg caraibes fr carib coast the domain in fig 10 spans from 50 w to 84 7 w and from 8 4 n to 22 1 n the bathymetry at the degrees of freedom is computed from gebco www gebco net and from shom for the french west indies https data shom fr donnees land boundaries are treated as reflective walls to avoid wetting drying of cells near the coastline we have filtered the bathymetry at land masses contained in the computational domain with b f i l t min b 1 m the filter assures that all the cells are always wet avoiding positivity preserving issues and well balancing of partly dry cells all aspects not addressed in the present study the mesh has variable mesh size ranging from h k m a x in deep ocean to h k m i n at the coast in correspondence of martinique guadaloupe and saint martin islands which represent some interest sites of the carib coast project a fine and a coarse mesh have been generated respectively with h k m i n 300 m h k m a x 10 km and h k m i n 600 m h k m a x 20 km the manning friction term is set to n 0 025 for this case 6 4 1 tsunami in carribean sea the initial tsunami waveform is associated with a random rupture of the lesser antilles subduction zone we use the fault configuration proposed by feuillet et al characterized by a magnitude m w 8 4 for the fault parameters see feuillet et al 2002 randomness is associated to the heterogeneity of the fault slip which is computed by a karuhnen loeve expansion 28 then the initial waveform is the solution of the okada linear model we have equipped the domain with several gauges placed in the near and far field in the near field we distinguish coastal gauges in bays or harbours point a pitre fort de france and nearshore gauges on the continental shelf martinique ne martinique w at far field we have placed the gauges in the carribean sea kingston and close to east boundary atlantic in order to look both to tsunami propagation after the wave has passed the antillean arch and free propagation in deep ocean in fig 12 we report the sea surface height recorded at the gauge stations for p1 p2 simulations on the coarse mesh and we compare them with the p1 simulation on the fine mesh the coarse p2 solution has roughly the same accuracy of the fine p1 solution in the near field and it is superior for far field propagation for the near field gauges the p1 solution captures sufficiently well the incoming trapped and reflected wave train even if the leading wave peak is slightly underestimated with respect to p2 40 cm at point a pitre for far field gauges p1 solution is very diffusive probably due to the simple lax friedrich flux employed in this study similar results emerge from the snapshot of the sea surface height at t 5400 s 11 in fig 12 beyond mesh and order convergence we have validated the simulation against the structured high order fv code funwave tvd 40 on a regular grid with δ x 800 m which has roughly the same degrees of freedom of the p2 coarse simulation the comparison is valid for the first two hours after funwave tvd solution is polluted by wave reflection from the boundary see the gauge atlantic ocean close the western boundary 6 4 2 irma hurricane we perform the simulation of the atmospheric surge produced by the passage of hurricane irma in the caribbean sea from 30th august 2017 to 14th september 2017 as known such phenomena link up great depressions and strong winds leading to sea level rise and flooding risk at the coast in order to account for atmospheric forcing the source term of the shallow water equations has to be modified with the wind force f w in eq 16 defined by 59 f w c d ρ a i r ρ 0 u 10 u 10 where ρ a i r is the air density u 10 is the wind velocity field ten meters above the ground and c d is the wind stress coefficient as proposed by charnock 1955 with charnock parameter set to 0 022 32 to construct the hurricane pressure and wind fields we used information issued from the noaa ibtracks 26 database and we applied the holland parametric model 22 computed hurricane winds are then converted to surface winds and averaged over 10 min after that cyclonic wind and pressure fields are finally merged with data from cfsr model 39 in order to represent large scale atmospheric conditions in the whole computational domain our simulations run from 5th september 2017 to 8th september 2017 simulating the hurricane strike on the caribbean french islands virgin islands and puerto rico fig 13 shows the hurricane surge propagation simulated by the p1 coarse mesh indistinguishable results at this scale are obtained using the p2 coarse mesh thus they are not reported here several noaa nos and shom tide gauges are available in the area allowing to validate our simulations against real observations measured sea level is the result of several components the tide a seasonal adjustment due to baroclinicity 35 the setup due to breaking waves and finally the atmospheric surge due to wind and pressure the first three components cannot be reproduced by our model therefore before comparison we processed raw signals such as to remove the tide and we applied a mean sea level offset to account for baroclinicity 24 in this way we were able to produce the pictures of fig 14 comparing simulations and observations at four gauges located close to the hurricane track we can appreciate a global agreement between computed water levels by both p1 and p2 simulations and historical data the use of p2 approximations in this case leads to very few improvements in the results only noticeable on the pick representation at the location closest to the hurricane track saint martin and lameshur discrepancies in the results may be due to different factors such as the parametric reconstruction of hurricane pressure and wind fields other source of discrepancies may be due to the wave setup contribution to observed water level and or the coarse representation of the insular shelf 1 km in the computational mesh of the carib coast project further investigations could improve the results but this is beyond the purposes of this work 7 conclusion in this work we have discussed an efficient and accurate formulation of the spherical shallow water equations in the form originally proposed in bernard et al 2009 which implies a mixed 3d 2d treatment the time derivative is expressed in 2d form while the right hand side is formulated in 3d cartesian form we have shown that using for the 2d part covariant vector basis the implementation simplifies and the accuracy increases in this work we have opted for a discontinuous galerkin discretization but the mixed 3d 2d covariant form is in principle also more amenable to a continuous finite elements discretization w r t to the original 6 in particular local mass matrix goes back to the standard block diagonal form line integrals or riemann problem do not imply tensor vector rotation thanks to the continuity of the normals at the edges we have also discussed a well balanced form of the resulting dg scheme resorting the hydrostatic pressure term to the strong form finally with a realistic tsunami and a historical storm surge simulation we have validated the method for two different oceanographic applications ongoing work is devoted to extension of the discretization of the 3d 2d covariant shallow water equations to stabilized continuous finite element supg or continuous interior penalty see e g abgrall and ricchiuto 2017 and michel et al 2021 and references therein and to perform a one to one comparison with the current implementation credit authorship contribution statement luca arpaia conceptualization methodology software validation writing mario ricchiuto conceptualization methodology formal analysis writing andrea gilberto filippini visualization validation rodrigo pedreros funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments work partially funded by the carib coast interreg project https www interreg caraibes fr caribcoast some of the computations presented in this paper were carried out using the brgm experimental testbed all the developments presented have been implemented in the platform aerosol uhaina co developed by epoc imag imb and inria in particular we are very grateful to vincent perrier for the time dedicated to us on the aerosol library and for his availability all along the implementation of the present work appendix bounds on the integration by parts correction to prove the bounds 41 we start by characterizing the mapping 12 used for the quadrature with a classical property see e g ciarlet and raviart 1972 engvall and evans 2020 for curved finite element examples property 1 bounds on the mapping derivatives the mapping 12 and its derivatives verify the following estimates 60 j a o h 61 x m j a o h m 1 62 j a o h 2 63 x j a o h 3 proof to prove the estimates we start by noting that denoting by x g j 1 3 x j 3 f l x j 1 3 φ j x x j l x g l j 1 3 φ j x x j l x g l x g l h j 1 3 δ j l φ j x with δ j l x j l x g l h the rescaled components of the distance of the nodal positions from the average which is of o 1 for shape regular meshes and with φ j the linear finite element basis the above expression can be written as a linear multivariate polynomial in terms of the components of h x with o 1 coefficients we write succinctly 64 f l p l 1 h x and similarly x l x p l 1 h x f where now with p k h x we denote a multivariate polynomial of degree k in the components of h x with o 1 coefficients to obtain the first two estimates we prove that any k th order differential of the mapping w r t any component or combination of the components of x verifies 65 k x l x h k p l k 1 h x f 2 k 1 to prove by induction we check the initial condition x l x f p l 1 h x p l 1 h x f f 2 we can use now to write f h f m 1 3 j 1 3 f m x δ j m φ j x where note that the derivatives of the linear basis functions are of o 1 in particular they assume the values 1 0 or 1 on the standard unit triangle containing the origin of the parametric space we can write x l x f 2 p l 1 h x h p l 1 h x m 1 3 j 1 3 f m x δ j m φ j x f 3 all it remains is to note that the derivative of p l 1 h x can be written as a 0 l h for some o 1 constant a 0 l so that x l x h f 2 a 0 l p l 1 h x l 1 3 j 1 3 f l x δ j l φ j x f 3 in which the numerator is indeed a quadratic polynomial of the components of f which combined with 64 leads to x l x h p l 2 h x f 3 we need now to prove that if true for k 1 the statement is also true for k so we assume that k 1 x l x h k 1 p l k h x f 2 k 1 and compute its differential k x l x h k 1 p l k h x f 2 k 1 p l k h x 2 k 1 f 2 k 2 f f 4 k 2 h k 1 p l k h x f 2 p l k h x 2 k 1 f f f 4 k 2 2 k 3 h k 1 p l k h x f 2 h p l k h x 2 k 1 l 1 3 j 1 3 f l x δ j l φ j f 2 k 1 as before we remark that p l k h x h p l k 1 h x which allows to write k x l x h k p l k 1 h x f 2 h p l k h x k 1 l 1 3 j 1 3 f l x δ j l φ j f 2 k 1 which indeed by virtue of 64 can be written as 65 and concludes the induction to conclude this preliminary proof we note that given an upper bound to the mesh size h h we can easily find a uniformly bounded constant c h such that f is bounded in between r and r c h h and 1 f is bounded as well using this remark and the boundedness and the coefficients of p l k the first of the properties sought is obtained for k 1 the second for k m 1 the k 1 property allows readily to prove 62 by using the definition j a g g det j a t j a since the determinant of a 2 2 matrix is a quadratic form of the matrix entries this means that g o h 4 by virtue of 60 and g o h 2 which implies 62 by the definition of j a lastly the properties 60 61 62 can be used to show that x j a o h 3 hence 63 to complete the proof of the estimate we now rewrite each of the integrals in the parametric space and perform a truncated taylor series expansion with the appropriate degree in the parametric coordinates to obtain an estimate of the quadrature error we will show the procedure for one of the integrals of 40 and provide comments concerning possible differences when evaluating others so let us consider the evaluation of 66 i 1 k p h i φ i g α d x as we said in the main body of the paper g α is available in a uniformly bounded analytical form for example in latitude longitude coordinates note that with the usual assumption of smoothness removing from the variational form its analog evaluated on an exact regular solution would lead to estimating the last integral via expressions of the type k p h e x p e x i φ i g α d x which provide at best an estimate of an o h p 3 which is related to the approximation error and it is independent on the quadrature however the theoretical and numerical evidence indicates a stricter bound as we will show shortly first we write the integral in the parametric space i 1 k p h x x i φ i x g α x x j a x d x the above integral can be written regrouping the terms as i 1 k f ˆ x j i a x d x having separated for convenience the terms that are defined directly in the reference space j i a x φ i x j a x from the terms defined in the physical space f ˆ x f x x we remark now that we can write within each parametric element j i a as a 0th order truncated taylor series j i a j i a x x j i a x x x x where following the lagrange representation of the taylor series remainder for a given x the point x x lies along the segment x x we can easily estimate the remainder from x j i a x x x φ i x x x j a x x x x x φ i j a x x x x with x φ i constant and of o 1 in the p 1 case as already remarked from 63 x j a x o h 3 and j a x o h 2 it follows that the second term of the above expression is not of higher order so the rest of the truncated series is of o h 3 we now also develop f ˆ in a taylor series truncated at the degree k k which is the assumed polynomial exactness of the volume quadrature formula combining with the previous development we obtain using standard multi index notation and again a lagrange representation of the taylor series remainder i 1 k α 0 k k 1 α d x α f ˆ x x α j i a x d x k α 0 k k 1 1 α d x α f ˆ x x α x j i a x x d x k α k k 1 1 α d x α f ˆ x x α j i a x d x k α k k 1 α d x α f ˆ x x α x j i a x x d x where we recall that in multi index notation d x α α x 1 α 1 x 2 α 2 for brevity we have omitted the explicit dependence of the remainder terms on the x x point which in principle is different for the two development considered since it has no relevance in the following by classical arguments we claim now that the first two integrals involving degree k k polynomials represent the value obtained with the approximate formula used in our method so that the remaining terms provide an estimate of the quadrature error e i 1 k α k k 1 1 α d x α f ˆ x x α j i a x d x k α k k 1 α d x α f ˆ x x α x j i a x x d x since the volume of the reference element k is of an o 1 we need to estimate the derivatives of f ˆ and combine with the available estimates j i a x o h 2 and x j i a x x o h 2 to estimate the derivatives of f ˆ we now use the fact that α f d α f and 60 61 and obtain x f x x j a x f c 1 h d x 1 f x 2 f x x x j a x f j a 2 x 2 f c 2 h 2 max m 2 d x m f x 3 f x x x 2 j a x f x j a j a x 2 f 2 j a x j a x 2 f j a 3 x 3 f c 2 h 3 max m 3 d x m f etc the k th derivative can be shown by induction omitted for brevity to be bounded by d x k f ˆ c k h k max m k d x m f so that the quadrature error for the term under consideration can be estimated to 67 e i 1 c i 1 max k k k d x k f h k k 2 c i 1 max k k k 1 d x k f h k k 3 c i 1 max k k k d x k f h k k 2 we can proceed in a similar manner for the other integrals in 40 to obtain i 2 k p h i x φ i g α d x e i 2 c i 2 max k k k d x k f h k k 1 i 3 k x p h φ i g α d x e i 3 c i 3 max k k k d x k f h k k 1 note that for these terms the presence of the derivative in the physical space x let the estimate one order of magnitude larger in h with respect to 67 similarly for the line integral i 4 k p h i g α φ i n d s e i 4 c i 4 max k k k d x k f h k k 1 by summing up the different integrals we have obtained for the well balanced correction 40 the following bound ε p k i 1 e i 1 i 2 e i 2 i 3 e i 3 i 4 e i 4 e i 1 e i 2 e i 3 e i 4 c h min k k 1 k k 1 having used the fact that for exact quadrature the sum of all the integrals i j vanishes this proves the result of the proposition note that the constant on the left actually depends on the integrand so in particular on the pressure field and its derivatives so it is bounded provided these are we perform a numerical verification with the values used for all the numerical simulations of the paper namely k k k k 3 p we consider a smooth pressure field p φ λ 2 sin 2 π φ cos 2 π λ defined on a spherical triangle which is successively refined halving the mesh size in fig 15 we check the order of accuracy for ε p k computed as ε p k max k ε p k for p 1 p 2 we recover numerically the estimate of proposition 41 while for p 3 we measure one order less w r t such theoretical estimate 
23864,the degradation of coastal ecosystems in recent years combined with more intense storms and greater sea levels associated with climate change are likely to increase vulnerability to coastal flooding along reef lined coasts therefore there is a need to accurately predict extreme water levels to identify areas with high vulnerability and implement mitigation measures runup parameterisations allow a rapid assessment of coastal vulnerability at a regional to global scale however these formulations are primarily developed for beaches hydrodynamic forcing and reef geometry are key parameters for the estimation of coastal flooding in reef environments the present study aims to develop runup parameterisations for an idealised 2dv reef lined coast profile using a widely validated nonlinear non hydrostatic numerical model swash the numerical model is employed to simulate different combinations of wave conditions water levels and reef geometries a machine learning ml approach in the form of genetic programming is used to identify the most suitable predictors for wave runup based on the numerical results analysis of runup results suggests that runup parameterisations can be improved for reef environments by incorporating the crest elevation lagoon width reef flat depth and forereef slope a dimensional and non dimensional parameterisation that include reef geometry are presented further research efforts should be devoted to incorporate the effects of bed roughness and three dimensional processes in this framework that were not taken into account in the present work keywords runup reef parameterisation machine learning swash model 1 introduction wave transformation along reef environments is more complex than on beaches due to the presence of lagoons reef or ridge crests abrupt slopes large flats and large roughness values as offshore sea swell propagates on reef lined coasts waves break and the majority of the wave energy at these frequencies dissipates and hence waves reform into a mixture of short and long period waves that propagate across the reef towards the shore resulting in a bimodal spectrum on the reef flat lowe et al 2005 van dongeren et al 2013 this spectrum is typically a result of the breakpoint forced momentum flux pomeroy et al 2012 and non linear wave wave interactions nwogu and demirbilek 2010 over certain reefs these longer period infragravity waves 25 s t p 250 s dominate pequignet et al 2009 cheriton et al 2016 recent studies have highlighted the importance of reef morphological controls on infragravity waves cheriton et al 2021 in some cases resonance has been reported over the reef flat where infragravity wave energy can be distributed around the natural frequency of the reef nwogu and demirbilek 2010 torres freyermuth et al 2012 amplifying wave runup at the coast and further complicating its prediction demirbilek et al 2007 pequignet et al 2009 coral reefs offer natural coastal protection to many regions where they are present dissipating up to 97 of incident wave energy ferrario et al 2014 however recent studies have reported that coral reefs are degrading eakin 1996 sheppard et al 2005 alvarez filip et al 2009 caused by a combination of different factors including coastal development marine pollution ocean acidification and temperature increase and overfishing among others this affects wave runup since it modifies the spatial gradient of wave dissipation influencing incident swash and wave induced setup franklin et al 2018 runup is defined as the wave induced height of discrete water level maxima stockdon et al 2006 dependent on both the time averaged wave setup and swash coastal flooding often occurs when runup exceeds the height of the dune crest during extreme events e g storms sallenger 2000 park and cox 2016 the hunt scaling parameter β h 0 l 0 hunt 1959a b where β is the characteristic slope angle and h 0 and l 0 are the deep water wave height and wavelength respectively is typically used to characterise wave runup for beaches a range of definitions have been used for β including the foreshore slope around the still water shoreline the slope at breakpoint and the mean slope of the active part of the surf zone mayer and kriebel 1994 park and cox 2016 runup parameterisations on beaches and coastal structures have been developed for wind waves e g hunt 1959a b holman 1986 van der meer 1988 stockdon et al 2006 park and cox 2016 and tsunami waves e g kobayashi and karjadi 1994 madsen and schaeffer 2010 da silva et al 2020 presented a comprehensive review of runup parameterisations table a 1 shows a summary of the runup models typically used in these environments see table a 2 for nomenclature where the most widely used parameterisation is that of stockdon et al 2006 there is still much discussion on the influence of beach slope on the infragravity swash component of run up holman and sallenger 1985 raubenheimer et al 2001 hanslow and nielsen 1993 passarella et al 2018 with some authors finding swash to be independent from the beach slope ruessink et al 1998 senechal et al 2011 while others have found that including the slope improves predictability cohn and ruggiero 2016 moreover scatter in the runup predictors with respect to data has been ascribed to aleatoric beuzen et al 2019 torres freyermuth et al 2019 rutten et al 2021 and statistical fiedler et al 2018 uncertainty in the case of coral reef lined coasts there are fewer studies that have focused on wave runup demirbilek et al 2007 buckley et al 2015 cheriton et al 2016 pearson et al 2017 lashley et al 2018 rueda et al 2019 in a recent study on flood prediction stockdon s parameterisation was assumed to be applicable to predict runup in reef environments e g beck et al 2018 however since runup on reef lined coasts depends not only on the fore slope angle of the beach but also on the morphology of the reef parameterisations traditionally used for beaches do not appear to be readily applicable franklin et al 2018 lashley et al 2018 da silva et al 2020 to improve the coastal modelling of physical processes the parameterisation of small scale processes needs to be improved fringer et al 2019 the most recent study regarding wave runup in reef environments which takes into account certain aspects of reef geometry is that by pearson et al 2017 these authors used a numerical model and probabilistic bayesian network to estimate wave induced flooding on reef lined coasts identifying water depth over the reef flat incident wave conditions and the width of the reef flat as the most important parameters to accurately predict flooding hazards in these environments beach slope and bed friction were found to be less important pearson et al 2017 similarly a study performed by rueda et al 2019 involves the development of a metamodel to predict wave runup under a range of morphologic and forcing characteristics the study employs an idealised reef profile and seven primary parameters offshore water level significant wave height reef flat width beach slope wave steepness and seabed roughness their results provide an open source code that serves as a tool for estimating runup estimations along reef lined coasts with a mean error of 30 cm rueda et al 2019 more recently scott et al 2020 presented a study using representative cluster profiles to represent the shoreline hydrodynamics of coral reef lined coasts and predicted runup with a mean error of 9 7 13 1 this study included parameters used by pearson et al 2017 excluding roughness and concludes that the representative cluster profiles rcps would enhance predictive accuracy for the reef profiles most dissimilar to that used in beware pearson et al 2017 these are significant advances in the prediction of wave runup for fringing reefs however none of these studies present a readily applicable alternative runup formula that takes into account the morphologic and hydrodynamic parameters identified making their application slightly less straightforward in recent years interest in the use of machine learning for coastal and hydraulics applications has grown e g goldstein et al 2013 tinoco et al 2015 passarella et al 2018 goldstein et al 2019 beuzen et al 2019 da silva et al 2020 among others machine learning is a subdiscipline of computer science concerned with the construction of computer programs that automatically improve with experience mitchell 1997 the main aim of this approach is to develop predictors that can be generalised passarella et al 2018 passarella et al 2018 employed this approach for swash parameterisation on beaches finding an improvement in total swash prediction by developing a dimensional runup parameterisation this study aims to use the numerical model simulating waves till shore swash zijlema et al 2011 and machine learning to develop and evaluate new formulae to predict runup associated with wave transformation over idealised reef lined bathymetries comparing traditional formulations with the results obtained using genetic programming the outline of the paper is as follows section 2 describes the numerical model model setup and simulated cases the machine learning method is described in section 3 followed by the results in section 4 finally the discussion focused on the comparison of the new formulations with those developed for beaches and concluding remarks are presented sections 5 and 6 2 numerical model 2 1 model description in this study a phase resolving nonlinear non hydrostatic free surface model the swash model http swash sourceforge net last access 20 january 2017 developed at delft university of technology zijlema et al 2011 is used this model is suitable for simulating wave transformation due to nonlinear wave wave interactions in the surf and swash regions since it solves the nonlinear shallow water equations and includes the non hydrostatic pressure terms zijlema et al 2011 the swash model has been applied to investigate wave transformation and runup on beaches e g smit et al 2014 brinkkemper et al 2013 de bakker et al 2014 ruju et al 2014 guimarães et al 2015 medellín et al 2016 fiedler et al 2018 ruju et al 2019 fiedler et al 2020 among many others and fringing reef environments e g zijlema 2012 torres freyermuth et al 2012 buckley et al 2014 franklin et al 2018 interested readers are referred to the work of zijlema et al 2011 where the governing equations numerical scheme and model validation are presented the numerical model has been validated in previous studies for the study of wave runup however model data comparison of wave transformation wave setup and wave runup on a physical model demirbilek et al 2007 is presented in appendix b 2 2 model implementation the experimental layout described in demirbilek et al 2007 which reproduces a simplified reef is employed here at prototype scale the laboratory scale used is froude 1 64 and hence in the present study all length scales are multiplied by 64 and all time scales by 8 the original set up was subsequently modified to include variations in the geometry of the profile to include a simplified reef crest as well as changes in forereef slope β r reef crest height c r and reef flat or lagoon width l w fig 1 a total of 2 366 cases considering different wave conditions and reef geometries were employed table 1 in addition 520 scenarios were used as a testing subset unknown to the gp algorithm to validate the parameterisations and a further combination of scenarios based on shimozono et al 2015 were used to check the applicability of the parameterisation under extreme conditions the numerical model was forced using a jonswap spectrum at the offshore boundary derived from the h s and t p and the sea level z corresponding to the cases employed in the laboratory study by demirbilek et al 2007 scaled up to prototype scale the time step was 0 01 s and simulations were sampled for 1800 s after 900 s of spin up time this extended spin up time was selected to achieve quasi stationary conditions in scenarios where the reef crest was exposed smaller z values in accordance with previous studies a wave breaking parameter α of 0 6 was used for all simulations smit et al 2014 in order to simulate a simplified reef environment a value of 0 014 was used for the bottom friction coefficient manning this is based on friction coefficients c f reported in previous studies on a fringing reef yao et al 2014 2016 peláez et al 2017 this value is likely to be lower than field values and the use of a constant value may lead to roughness being overestimated or underestimated for the beach or reef respectively roughness has been found to play an important role in wave transformation franklin et al 2013 buckley et al 2016 however in a recent study for a reef environment pearson et al 2017 it was found to be less important for flooding than hydrodynamic forcing and reef geometry parameters therefore effects of a complex geometry on wave transformation were the main interest here and hence the role of reef roughness was not addressed in this work 2 3 data analysis for each sea state propagated in the swash model the height of the bottom profile at the wet dry interface was used to extract the water elevation η t relative to mean sea level fig 2a to obtain a continuous time series this location was tracked as the first grid point where water depth was less than 0 03 m this value was chosen since it is the most commonly used in field studies measuring runup guza and thornton 1982 holman and guza 1984 extreme runup r 2 corresponding to the 2 exceedance value holman 1986 was calculated for each run see fig 2b furthermore the maximum wave setup at the shoreline which is the super elevation of the mean water level due to waves longuet higgins and stewart 1964 was computed as the mean of the wave runup time series η in order to estimate the relative contributions to wave runup e g stockdon et al 2007 incident s in and infragravity s ig swash were also obtained from the model results the runup time series were filtered so that s in fp 0 5 s fp 2 and s ig fp 0 1 s fp 0 5 where fp is the peak wave frequency at the forcing boundary the significant incident and infragravity swash heights were then calculated as four times the standard deviation of each filtered time series 3 machine learning 3 1 genetic programming for runup parameterisation machine learning ml is a sub discipline of computer science and a sector of artificial intelligence that applies algorithms systematically in order to synthesise relationships between information and data awad and khanna 2015 based on the notion that systems are able to identify patterns learn from data and make decisions thus ml automates the construction of analytical models to find relationships between variables involved in processes of interest passarella et al 2018 various ml techniques have been applied to coastal studies for example decision trees bonakdar and etemad shahidi 2011 abolfathi et al 2016 artificial neural networks pape et al 2007 bayesian networks plant and holland 2011a b pearson et al 2017 and genetic programming passarella et al 2018 here the focus is on using genetic programming gp to develop a runup predictor that takes into account the geometry of these environments genetic programming consists as described by passarella et al 2018 of four main steps 1 the generation of an initial population of solutions equations 2 the comparison of these solutions to training data to determine fit 3 the retention of only the solutions with the smallest error and 4 the creation of new solutions through evolutionary rules crossover by reproduction and mutation which are added to the retained solutions these steps 2 4 are then repeated until terminated by the user the final solutions range in complexity in terms of the number of operators coefficients and variables and error presented along a pareto front where increasing complexity results in decreasing error passarella et al 2018 the balance between the acceptable error and complexity of a solution depends on the user s criteria for example the computational time for more complex solutions is greater and while these present smaller errors this increased complexity can result in a loss of physical meaning following previous studies here the formulae selected from the final solutions were chosen based on minimising error whilst maintaining physical meaning due to the complexity of the parameterisations the model was run at prototype scale to permit its application to natural conditions the software eureqa developed by schmidt and lipson 2009 2013 was used for all genetic programming in this study predictors of extreme runup r 2 were identified by searching for the equation that best satisfied r 2 f h 0 l 0 β r h r c r l w based on the mathematical operations present in traditional formulations for runup the following were included in the gp addition subtraction division multiplication square root power and exponential a training subset of data is used to develop predictors which are subsequently evaluated using a validation subset eureqa presents various error metrics to assess the results we considered both non dimensional and dimensional runup predictors 3 2 training validation and testing in this study the combinations of different water depths wave conditions and geometric features result in 2800 numerical simulations with their corresponding runup records the training method chosen to develop runup predictors was the data splitting option included in eureqa with random shuffling of rows prior to training to select a representative subset of training data from the complete data set the training subset consisted of 30 of the data while the remaining 70 were used for validation which has been found to be suitable in previous studies e g passarella et al 2018 furthermore prior to developing new predictors stockdon s equation was set as the target expression in eureqa leaving gp to select the most suitable coefficients for application in a simplified reef type bathymetry this experiment involving the optimisation of stockdon s parameterisation uses the program as a genetic algorithm holland 1992 where the base function is set as eq 1 allowing 4 parameters to be optimised using the stochastic and gradient descent rules embedded in eureqa the beach slope used in stockdon s parameterisation is replaced with a forereef slope value the equation to be satisfied in eureqa was therefore 1 r 2 f 0 c 1 f 1 c 2 β f h 0 l 0 0 5 h 0 l 0 f 3 c 3 β f 2 f 4 c 4 0 5 2 where f 0 f 1 f 2 f 3 and f 4 are the relative functions β f the forereef or equivalent slope h 0 incident wave height l 0 incident wavelength and c1 c2 c3 and c4 the coefficients to be determined forereef slope was chosen here rather than an average of all the slopes e g raubenheimer et al 2001 since this is where waves initially break fig 3 shows the comparison of the model versus the parameterisation data when the target expression was based on stockdon s parameterisation i e eq 1 the error metrics presented in the gp for each new predictor include the maximum error mean squared error mean absolute error as well as the goodness of fit r2 and correlation coefficient 4 results 4 1 effect of reef geometry on runup the effects of different geometry features on wave runup were tested using the numerical model swash model results show that r 2 increased with decreasing lagoon width increasing forereef slope and in the presence of a ridge or simplified box shaped crest fig 4a and b the increase in water depth also results in an increase in runup and causes the effect of lagoon width to become less relevant the aforementioned pattern is similar for both the gentler and steeper slopes however in the former the increase in r 2 with depth is much more evident in addition the presence of the crest results in smaller differences in r 2 when the slope is gentler with similar values for the reef flat with a lagoon width of 170 9 m and the rectangular crest with a lagoon width of 239 4 m fig 4b blue triangles vs red circles except for h r 0 0 m and h r 0 64 m in some cases r 2 is actually greater for the reef flat l w 170 9 m than for the rectangular crest l w 239 4 m fig 4b h r 1 024 h r 1 408 m and h r 1 984 in terms of magnitude the forereef slope has a similar influence on r 2 to the presence or absence of the rectangular crest structure e g maximum differences of 0 89 vs 0 87 m l w 307 2 m width h r 0 64 m for both slopes at greater water depths h r 1 984 2 624 and 3 264 m smaller wave conditions result in greater runup for the reef flat than in the presence of the crest this difference increases in magnitude as depth increases last three panels of fig 4a and b fig 4 shows high r 2 variability for h 0 l 0 1 2 20 as a function of the bathymetric features hence current runup parameterisations have limitations when they are applied to these scenarios since they do not take these features into account 4 2 relative contributions to runup in order to identify the relative contributions of wave setup and low and high frequency swash components to wave runup e g stockdon et al 2006 a percentage comparison was obtained fig 5 the results for one of the water depths are presented here for the cases with and without reef crest model results show that for the reef crest scenario the relative contribution of wave setup to runup is greater than the swash contributions under all wave conditions fig 5a the differences in the contributions for different lagoon widths were negligible with the exception of the largest wave conditions where the infragravity swash contribution was greatest for the smallest lagoon and lowest for the largest lagoon for all scenarios the contribution of incident swash was small due to significant wave dissipation during wave breaking when comparing the relative contributions for the 307 2 m lagoon width with and without the reef crest there are notable differences fig 5b for instance the percentage contribution of infragravity swash to runup is larger for the reef flat than the reef crest particularly under small wave conditions around 35 40 for the flat compared to around 20 30 for the crest though this difference reduces for larger wave conditions in contrast the contribution of wave setup is consistently greater for the wave crest scenario between 50 and 60 for the crest compared to between approximately 20 40 for the flat one notable difference for the reef flat scenarios is that for low energy wave conditions h 0 l 0 1 2 25 the greatest contribution to runup is provided by infragravity swash however for h 0 l 0 1 2 25 this changes and wave setup dominates in all scenarios the contribution of incident swash is small particularly for the reef crest under small wave conditions 4 3 machine learning parameterisations more than 1 4115 e 7 formulae were evaluated in the scenario including all variables the solutions follow a pareto front where the error of each formula decreases with increasing size and complexity when compared to the validation subset of data passarella et al 2018 the selection of the most suitable solutions is subjective since often highly complex solutions while presenting the smallest error values may lose their physical interpretation passarella et al 2018 furthermore there is a risk of over fitting when using more complex solutions which means they lose their generalisation power passarella et al 2018 and become very specific to the training and validation data used to generate the solution therefore it is important to test the new formulae on data that have not been used in their development different runup formulations were derived using the numerical model results and the ml technique both non dimensional and dimensional formulae were tested for the former the relevant parameters presented in fig 1 were combined to form non dimensional parameters a b c d following merrifield et al 2014 the lagoon width and depth were included in one parameter and the crest height was non dimensionalised with the water depth over the reef as a r 2 h 0 b l w t p 9 82 h r 0 5 c c r h r d tan β r h 0 l 0 ˆ 0 5 eureqa was then left to find relationships following the form a f0 b f1 c f2 d to ensure non dimensional coefficients based on the need to balance error reduction with the physical interpretability of the results for each scenario of parameters the most suitable formulae were chosen both dimensional and non dimensional eqs 2 and 3 2 r 2 0 108 h 0 l 0 l w h 0 c r β r 0 000186 h 0 h r l w 3 a 0 53 0 099 d 0 013 c 0 23 0 016 b for example a formula might result in smaller errors but lead to negative r 2 values when they are not present in the model results and would therefore not be appropriate despite the greater error reduction furthermore the formulae identified by eureqa that produce the smallest error tend to be the most complex and have the greatest number of coefficients the more complex formulae also have a greater tendency to over fit the data and become less applicable to different scenarios the formulae were also inspected using typical values to check their applicability the last term in eq 1 contributes to a lesser degree than the other terms however it still accounts for a third of the magnitude of the next smallest term the removal of this term while apparently of lesser importance resulted in a substantial increase in error fig 6 shows a comparison of the results of the optimised stockdon parameterisation the formulation with dimensions eq 2 and non dimensionalised eq 3 the highest correlation coefficients were found for the parameterisations that take into account all parameters fig 6 and table 2 the overall error for the new parameterisations obtained when the target expression is set as stockdon s formula eureqa calibrated is much smaller than when the original parameterisation stockdon et al 2006 is used however the errors and dispersion of runup predictions are still larger than when all the variables are included fig 6 table 2 when comparing the parameterisations present in fig 6b and c eqs 2 and 3 rmse was smallest and the correlation coefficient was greatest for fig 6c eq 2 although the bias was smaller for the non dimensional equation it is worth mentioning that in order to make a fair comparison the results in fig 6b have been multiplied by wave height when comparing the results of the parameterisations developed using different combinations of the relevant parameters the greatest errors were presented by those that only take into account h 0 l 0 and β r fig 7 this analysis was not performed on the non dimensional formula since its terms include combinations of parameters that cannot easily be separated without losing the non dimensionality of the equation the eureqa calibrated stockdon parameterisation obtained using eureqa substituting beach slope for forereef slope and allowing eureqa to identify the most suitable coefficients resulted in a substantial improvement in its ability to predict the model runup values table 2 fig 6 however the errors remain higher than for the parameterisations including additional parameters r2 of 0 65 compared to 0 93 when all parameters are included table 2 the geometry parameters were tested individually by adding them one at a time to the initial parameters of h 0 l 0 and β r the results showed that including h r in the parameterisation contributed most to reducing the error values table 2 for example when the target expression was not specified as eq 1 i e eureqa identified the formulae the highest r2 value for the parameterisations obtained using only h 0 l 0 and β r was 0 67 compared to 0 83 when including h 0 l 0 β r and h r when all parameters were included the r2 value was 0 93 showing more accurate results when all parameters were accounted for these errors are for the comparison between the training and validation data given by eureqa when calculated between the model runup results and the predicted values obtained using the parameterisations the errors were further reduced with an rmse of 0 25 and correlation coefficient of 0 95 when all parameters were included fig 7 fig 7 also shows how h r resulted in the smallest errors for the individual parameters rmse 0 37 correlation coefficient of 0 89 4 4 parameterisation validation in order to validate the parameterisations eqs 2 and 3 including all variables with and without dimensions were tested on data that had not been used in their development a set of scenarios with an additional depth and a wider lagoon for all wave conditions and h r values initially used furthermore to test the applicability of the parameterisations beyond the conditions tested here a set of scenarios including flat and crest geometry different h r values and a constant l w 307 2 m for typhoon scale wave conditions h 0 14 16 18 and 20 m t p 16 5 s from shimozono et al 2015 were also evaluated here the results for h 0 14 and 16 m have been included to demonstrate the ability of the two parameterisations to predict runup in very extreme scenarios fig 8 shows how eqs 1 and 2 numbered 1 and 4 in the figure present the highest correlation coefficients when used to estimate runup for scenarios unknown to the model not used in training or validating the data the eureqa calibrated stockdon equation while presenting substantial scatter actually performed well in the analysis showing a substantial reduction in the error metrics fig 8b compared to the stockdon et al 2006 formula that is typically used numbered as 3 in fig 8 furthermore the latter shows a very high bias in comparison with the other formulae fig 8b when comparing the results with those of the non dimensional parameterisation black asterisks in fig 8 the results are quite similar although this paramterisation presents a large negative bias compared to the parameterisations where the dimensions were not removed fig 8b it is worth mentioning that in order to make a fair comparison the target variable of this equation r 2 h 0 was multiplied by h 0 to obtain r 2 based on the error metrics in fig 8 b eq 1 is the best parameterisation for the scenarios included here this changes however when considering the typhoon scale scenarios tested circular markers in fig 8a under these conditions eq 1 underestimates r 2 and presents considerable scatter whereas the nondimensional equation black circles is a closer estimate the underestimate of eq 1 under typhoon scale scenarios may be due to the presence of dimensions in the parameterisation making it less applicable to conditions which are extremely different from those used to generate it which may be due to a small degree of overfitting or irreducible variability in compressing the physics of runup into just a few parameters it is possible that this could be improved further by calibrating the coefficients as was the case for the eureqa calibrated stockdon equation the new parameterisations eqs 2 and 3 including all the variables resulted in the smallest errors and are therefore the best predictors for runup results show that for reef morphology studied here stockdon et al 2006 tends to overpredict runup however when comparing the eureqa calibrated stockdon equation first equation in table 2 and that presented by stockdon et al 2006 the error is reduced substantially fig 8 this suggests that using the reef slope rather than the beach face slope and calibrating the coefficients is required to improve its predictive capability for reef lined coasts the replacement of the beach face slope with the fore reef slope appears to improve the results since this is where waves initially break in the case of reef line coasts hence it is where most incident swash is dissipated and setup is greatest furthermore previous studies have found that infragravity wave energy can be trapped when the reef slope is steeper leading to resonant amplification and increased runup along reef lined coasts e g becker et al 2016 pearson et al 2017 pequignet et al 2009 buckley et al 2018 the reduction in predictive error for eq 3 compared to the eureqa calibrated stockdon equation shows that for reef lined coasts h r l w and c r are additional parameters that need to be accounted for when comparing the parameterisations to the numerical results for the new subset of data fig 7 the eureqa calibrated stockdon parameterisation tends to overestimate runup although less than the traditional stockdon et al 2006 parameterisation and presents greater scatter in the predictions than the new eureqa derived formulae increasing l w decreases wave runup hence it is likely that by including this parameter the overestimation that results from using the stockdon parameterisations is reduced as is the scatter in the predictions in a study by da silva et al 2020 using swash the authors found the absence of information on the submerged beach morphology could results in substantial variability in runup estimates these authors found the distance between the shore and the sandbar crest to be of particular importance a parameter not dissimilar to l w in the current study the overall reduction in scatter and error in runup prediction by including the geometry parameters in the new parameterisations figs 6 and 7 table 2 demonstrates their improved suitability to reef fringed coasts a limitation to all the parameterisations presented here is the absence of a term for roughness although previous studies have found this parameter to be less important than those included here for a reef lined coast e g pearson et al 2017 a study by buckley et al 2018 found large bottom roughness to reduce low frequency motions and reduce runup by 30 hence further testing is warranted 5 discussion the primary mechanisms that control the water level at the coast are tides storm surge and wave runup buckley et al 2016 the results presented here show that wave runup was significantly higher in the presence of a reef crest which is due primarily to an increase in wave setup over the flat consistent with the findings of yao et al 2017 furthermore they also found that increasing crest width resulted in greater wave setup and identified crest submergence as the primary parameter controlling the magnitude of wave setup on the reef flat it is worth mentioning that this was for a 1d scenario and 2dh effects may also play a role reducing setup when circulation and alongshore effects are accounted for as is also the case for the present study reefs are often interspersed with channels and spur and groove systems which would reduce the 1d effect seen in wave setup and can induce significant wave energy dissipation acevedo ramirez et al 2021 in terms of the effect of the forereef slope on r 2 c r and l w had less influence when the slope was milder fig 4 forereef slope has previously been found to be more influential than the friction coefficient or beach slope pearson et al 2017 in terms of the relative components of runup the presence of the reef crest had a substantial influence on η and s ig with substantially larger η contributions for the crest particularly under smaller wave conditions although likely exaggerated due to the 1d nature of the model and larger s ig for the flat smaller contributions of s in were found for all scenarios these results support previous findings that infragravity swash dominates in reef environments e g nwogu and demirbilek 2010 pomeroy et al 2012 torres freyermuth et al 2012 zijlema 2012 franklin et al 2018 buckley et al 2018 nwogu and demirbilek 2010 also found infragravity wave energy to increase shoreward over the reef flat and with increasing water level as found here results not shown in the case of the reef flat for constant water depth runup increases with increasing offshore wave height and becomes increasingly driven by wave setup fig 5b s in is small since wave breaking at the reef edge dissipates most of the incident wave energy in the surf zone pomeroy et al 2012 and since higher harmonics are subject to greater attenuation the infragravity spectral band becomes dominant over the reef flat shimozono et al 2015 furthermore there is a possibility of resonant amplification of low frequency motions across the reef flat if significant energy is present at the natural frequency of the reef flat shimozono et al 2015 depending on the flat length and water level pequignet et al 2009 since water level can affect resonant frequencies it has been suggested that increased sea levels associated with climate change ipcc 2007 may increase resonant frequencies pequignet et al 2009 this becomes particularly important since inundation events have been observed for low lying areas where low frequency motions dominate the water level at the shore e g merrifield et al 2014 in terms of the parameterisations obtained with eureqa the water level over the reef h r had the greatest influence on improving predictability reduced error showing the importance of water depth and reef crest submergence on wave runup this is supported by the findings of rueda et al 2019 who included water levels as a variable in their reef metamodel and found it to be associated with larger runup values furthermore the sensitivity analysis for eq 3 appendix c table c 2 shows that this variable had a greater effect on runup than l 0 and β r the latter of which actually had the least influence on runup compared to the other parameters this has important implications since one of the most widely used parameterisation at present stockdon et al 2006 is based on h 0 l 0 and beach slope results show that the gp predictors proposed in the current study for wave runup perform better in environments with complex bathymetries e g coral reefs than existing formulae the simplest solutions not shown show a linear dependence on h 0 followed by l 0 and slope in this case reef face slope demonstrating the importance of these variables in predicting runup as has previously been demonstrated e g stockdon et al 2006 bonakdar and etemad shahidi 2011 park and cox 2016 passarella et al 2018 holman and guza 1984 holman 1986 however in slightly more complex solutions h r becomes important remaining present in the more complex solutions suggesting that including this variable in the runup formulations reduces prediction error these findings are supported by the variable sensitivity reports produced by eureqa which show the relative impact of each variable within the model on the target variable in this case runup in all solutions h 0 had the greatest impact often followed by l 0 the impact of the remaining variables was of a similar order of magnitude with all variables having a 100 positive likelihood of increasing the target variable with the exception of l w which presented a 100 negative likelihood increases in this variable decrease the target variable 100 of the time the latter effect is similar to that identified by yao et al 2017 with a wider crest appendix c tables c 1 and c 2 show the sensitivity results for the two most accurate parameterisations developed in the current study eqs 2 and 3 these presented an error that was similar to the mean error presented by rueda et al 2019 of 30 cm 6 conclusions this study uses a non linear wave transformation model and machine learning to investigate wave runup associated with wave transformation on reef lined coasts different wave conditions were simulated over an idealised reef geometry at prototype scale findings show runup to be dominated by the contributions of wave setup and infragravity swash depending on the wave energy the forereef slope reef crest reef flat width and water depth were varied to elucidate their role in runup modelling results were employed by ml to derive different parameterisations the selected ml based parameterisations include the reef geometry dependence and improve on the runup parameterisation typically used for beaches following wave height water level over the reef was the most important parameter to predict runup in these environments followed by reef flat width this increase in water level could be taken as a proxy for sea level rise due to climate change demonstrating the increase in potential for flooding at greater water levels the effect of reef flat width is likely to be greater for increased roughness values not included here under the 2d idealised conditions used here the presence of an impermeable reef crest enhanced wave runup for large wave conditions and shallower depths which contradicts the belief that the reef crest provides coastal protection however this is likely due in part to the 2dv settings used in the present study despite these findings at greater depths and under smaller wave conditions runup was smaller demonstrating the role of the crest in protecting the coast by excluding reef roughness it is possible that runup estimations are larger than for natural reefs since roughness would act to dissipate wave energy and reduce runup particularly for wider reef lagoons where it would enhance dissipation over the reef flat when comparing the non dimensional and dimensional parameterisation developed with eureqa the former is most suited to the data and scenarios presented here however the non dimensional parameterisation seems to be more effective at predicting very extreme wave conditions nevertheless the disadvantage with the latter is that it cannot include 0 wave height conditions or h r values of 0 whereas the dimensional parameterisation can future efforts should be devoted to extend this approach by incorporating the effects of bed roughness and three dimensional processes in order to be able to extrapolate the results to natural reef environments credit authorship contribution statement gemma l franklin methodology writing original draft writing reviewing and editing visualization investigation formal analysis alec torres freyermuth conceptualization writing reviewing and editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements many thanks to gonzalo martín ruiz for technical support and to delft university of technology for making the development of the swash model possible thanks also to the anonymous reviewers whose comments and suggestions helped to greatly improve the manuscript funding this work was supported by funding received by the first author through a postdoctoral scholarship awarded by the programa de becas posdoctorales mexico and papiit mexico in102221 from dgapa unam mexico the national council of science and technology conacyt mexico through the national coastal resilience laboratory lanresc cb 2016 01 project 284430 and the institute of engineering unam mexico the authors acknowledge support provided by cátedras conacyt mexico project 1146 appendix a runup parameterisations appendix b numerical model validation for the model validation the laboratory data by demirbilek et al 2007 were employed the beach profile of an idealised fringing reef fig b 1c was implemented with a uniform mesh with a cell resolution of 0 01 m the time step was 0 01 s and simulations were run for 450 s the numerical model was forced with the free surface elevation time series measured at the offshore sensor the numerical results using test 29 h s 0 071 m t p 1 5 s z 0 516 m from demirbilek et al 2007 show swash to be capable of predicting wave height fig b 1a setup fig b 1b and runup fig b 1d with reasonable accuracy consistent with previous studies using a similar solver lashley et al 2018 appendix c sensitivity results for the two selected runup parameterisations sensitivity the relative influence each variable has on the chosen target variable within a resulting model positive how likely it is that an increase in a given variable will result in an increase in the target variable positive magnitude how large the positive influence of the variable on the target variable is negative how likely it is that an increase in a given variable will result in a decrease in the target variable negative magnitude how large the negative influence of the variable on the target variable see eureqa for further details on definition of terms 
23864,the degradation of coastal ecosystems in recent years combined with more intense storms and greater sea levels associated with climate change are likely to increase vulnerability to coastal flooding along reef lined coasts therefore there is a need to accurately predict extreme water levels to identify areas with high vulnerability and implement mitigation measures runup parameterisations allow a rapid assessment of coastal vulnerability at a regional to global scale however these formulations are primarily developed for beaches hydrodynamic forcing and reef geometry are key parameters for the estimation of coastal flooding in reef environments the present study aims to develop runup parameterisations for an idealised 2dv reef lined coast profile using a widely validated nonlinear non hydrostatic numerical model swash the numerical model is employed to simulate different combinations of wave conditions water levels and reef geometries a machine learning ml approach in the form of genetic programming is used to identify the most suitable predictors for wave runup based on the numerical results analysis of runup results suggests that runup parameterisations can be improved for reef environments by incorporating the crest elevation lagoon width reef flat depth and forereef slope a dimensional and non dimensional parameterisation that include reef geometry are presented further research efforts should be devoted to incorporate the effects of bed roughness and three dimensional processes in this framework that were not taken into account in the present work keywords runup reef parameterisation machine learning swash model 1 introduction wave transformation along reef environments is more complex than on beaches due to the presence of lagoons reef or ridge crests abrupt slopes large flats and large roughness values as offshore sea swell propagates on reef lined coasts waves break and the majority of the wave energy at these frequencies dissipates and hence waves reform into a mixture of short and long period waves that propagate across the reef towards the shore resulting in a bimodal spectrum on the reef flat lowe et al 2005 van dongeren et al 2013 this spectrum is typically a result of the breakpoint forced momentum flux pomeroy et al 2012 and non linear wave wave interactions nwogu and demirbilek 2010 over certain reefs these longer period infragravity waves 25 s t p 250 s dominate pequignet et al 2009 cheriton et al 2016 recent studies have highlighted the importance of reef morphological controls on infragravity waves cheriton et al 2021 in some cases resonance has been reported over the reef flat where infragravity wave energy can be distributed around the natural frequency of the reef nwogu and demirbilek 2010 torres freyermuth et al 2012 amplifying wave runup at the coast and further complicating its prediction demirbilek et al 2007 pequignet et al 2009 coral reefs offer natural coastal protection to many regions where they are present dissipating up to 97 of incident wave energy ferrario et al 2014 however recent studies have reported that coral reefs are degrading eakin 1996 sheppard et al 2005 alvarez filip et al 2009 caused by a combination of different factors including coastal development marine pollution ocean acidification and temperature increase and overfishing among others this affects wave runup since it modifies the spatial gradient of wave dissipation influencing incident swash and wave induced setup franklin et al 2018 runup is defined as the wave induced height of discrete water level maxima stockdon et al 2006 dependent on both the time averaged wave setup and swash coastal flooding often occurs when runup exceeds the height of the dune crest during extreme events e g storms sallenger 2000 park and cox 2016 the hunt scaling parameter β h 0 l 0 hunt 1959a b where β is the characteristic slope angle and h 0 and l 0 are the deep water wave height and wavelength respectively is typically used to characterise wave runup for beaches a range of definitions have been used for β including the foreshore slope around the still water shoreline the slope at breakpoint and the mean slope of the active part of the surf zone mayer and kriebel 1994 park and cox 2016 runup parameterisations on beaches and coastal structures have been developed for wind waves e g hunt 1959a b holman 1986 van der meer 1988 stockdon et al 2006 park and cox 2016 and tsunami waves e g kobayashi and karjadi 1994 madsen and schaeffer 2010 da silva et al 2020 presented a comprehensive review of runup parameterisations table a 1 shows a summary of the runup models typically used in these environments see table a 2 for nomenclature where the most widely used parameterisation is that of stockdon et al 2006 there is still much discussion on the influence of beach slope on the infragravity swash component of run up holman and sallenger 1985 raubenheimer et al 2001 hanslow and nielsen 1993 passarella et al 2018 with some authors finding swash to be independent from the beach slope ruessink et al 1998 senechal et al 2011 while others have found that including the slope improves predictability cohn and ruggiero 2016 moreover scatter in the runup predictors with respect to data has been ascribed to aleatoric beuzen et al 2019 torres freyermuth et al 2019 rutten et al 2021 and statistical fiedler et al 2018 uncertainty in the case of coral reef lined coasts there are fewer studies that have focused on wave runup demirbilek et al 2007 buckley et al 2015 cheriton et al 2016 pearson et al 2017 lashley et al 2018 rueda et al 2019 in a recent study on flood prediction stockdon s parameterisation was assumed to be applicable to predict runup in reef environments e g beck et al 2018 however since runup on reef lined coasts depends not only on the fore slope angle of the beach but also on the morphology of the reef parameterisations traditionally used for beaches do not appear to be readily applicable franklin et al 2018 lashley et al 2018 da silva et al 2020 to improve the coastal modelling of physical processes the parameterisation of small scale processes needs to be improved fringer et al 2019 the most recent study regarding wave runup in reef environments which takes into account certain aspects of reef geometry is that by pearson et al 2017 these authors used a numerical model and probabilistic bayesian network to estimate wave induced flooding on reef lined coasts identifying water depth over the reef flat incident wave conditions and the width of the reef flat as the most important parameters to accurately predict flooding hazards in these environments beach slope and bed friction were found to be less important pearson et al 2017 similarly a study performed by rueda et al 2019 involves the development of a metamodel to predict wave runup under a range of morphologic and forcing characteristics the study employs an idealised reef profile and seven primary parameters offshore water level significant wave height reef flat width beach slope wave steepness and seabed roughness their results provide an open source code that serves as a tool for estimating runup estimations along reef lined coasts with a mean error of 30 cm rueda et al 2019 more recently scott et al 2020 presented a study using representative cluster profiles to represent the shoreline hydrodynamics of coral reef lined coasts and predicted runup with a mean error of 9 7 13 1 this study included parameters used by pearson et al 2017 excluding roughness and concludes that the representative cluster profiles rcps would enhance predictive accuracy for the reef profiles most dissimilar to that used in beware pearson et al 2017 these are significant advances in the prediction of wave runup for fringing reefs however none of these studies present a readily applicable alternative runup formula that takes into account the morphologic and hydrodynamic parameters identified making their application slightly less straightforward in recent years interest in the use of machine learning for coastal and hydraulics applications has grown e g goldstein et al 2013 tinoco et al 2015 passarella et al 2018 goldstein et al 2019 beuzen et al 2019 da silva et al 2020 among others machine learning is a subdiscipline of computer science concerned with the construction of computer programs that automatically improve with experience mitchell 1997 the main aim of this approach is to develop predictors that can be generalised passarella et al 2018 passarella et al 2018 employed this approach for swash parameterisation on beaches finding an improvement in total swash prediction by developing a dimensional runup parameterisation this study aims to use the numerical model simulating waves till shore swash zijlema et al 2011 and machine learning to develop and evaluate new formulae to predict runup associated with wave transformation over idealised reef lined bathymetries comparing traditional formulations with the results obtained using genetic programming the outline of the paper is as follows section 2 describes the numerical model model setup and simulated cases the machine learning method is described in section 3 followed by the results in section 4 finally the discussion focused on the comparison of the new formulations with those developed for beaches and concluding remarks are presented sections 5 and 6 2 numerical model 2 1 model description in this study a phase resolving nonlinear non hydrostatic free surface model the swash model http swash sourceforge net last access 20 january 2017 developed at delft university of technology zijlema et al 2011 is used this model is suitable for simulating wave transformation due to nonlinear wave wave interactions in the surf and swash regions since it solves the nonlinear shallow water equations and includes the non hydrostatic pressure terms zijlema et al 2011 the swash model has been applied to investigate wave transformation and runup on beaches e g smit et al 2014 brinkkemper et al 2013 de bakker et al 2014 ruju et al 2014 guimarães et al 2015 medellín et al 2016 fiedler et al 2018 ruju et al 2019 fiedler et al 2020 among many others and fringing reef environments e g zijlema 2012 torres freyermuth et al 2012 buckley et al 2014 franklin et al 2018 interested readers are referred to the work of zijlema et al 2011 where the governing equations numerical scheme and model validation are presented the numerical model has been validated in previous studies for the study of wave runup however model data comparison of wave transformation wave setup and wave runup on a physical model demirbilek et al 2007 is presented in appendix b 2 2 model implementation the experimental layout described in demirbilek et al 2007 which reproduces a simplified reef is employed here at prototype scale the laboratory scale used is froude 1 64 and hence in the present study all length scales are multiplied by 64 and all time scales by 8 the original set up was subsequently modified to include variations in the geometry of the profile to include a simplified reef crest as well as changes in forereef slope β r reef crest height c r and reef flat or lagoon width l w fig 1 a total of 2 366 cases considering different wave conditions and reef geometries were employed table 1 in addition 520 scenarios were used as a testing subset unknown to the gp algorithm to validate the parameterisations and a further combination of scenarios based on shimozono et al 2015 were used to check the applicability of the parameterisation under extreme conditions the numerical model was forced using a jonswap spectrum at the offshore boundary derived from the h s and t p and the sea level z corresponding to the cases employed in the laboratory study by demirbilek et al 2007 scaled up to prototype scale the time step was 0 01 s and simulations were sampled for 1800 s after 900 s of spin up time this extended spin up time was selected to achieve quasi stationary conditions in scenarios where the reef crest was exposed smaller z values in accordance with previous studies a wave breaking parameter α of 0 6 was used for all simulations smit et al 2014 in order to simulate a simplified reef environment a value of 0 014 was used for the bottom friction coefficient manning this is based on friction coefficients c f reported in previous studies on a fringing reef yao et al 2014 2016 peláez et al 2017 this value is likely to be lower than field values and the use of a constant value may lead to roughness being overestimated or underestimated for the beach or reef respectively roughness has been found to play an important role in wave transformation franklin et al 2013 buckley et al 2016 however in a recent study for a reef environment pearson et al 2017 it was found to be less important for flooding than hydrodynamic forcing and reef geometry parameters therefore effects of a complex geometry on wave transformation were the main interest here and hence the role of reef roughness was not addressed in this work 2 3 data analysis for each sea state propagated in the swash model the height of the bottom profile at the wet dry interface was used to extract the water elevation η t relative to mean sea level fig 2a to obtain a continuous time series this location was tracked as the first grid point where water depth was less than 0 03 m this value was chosen since it is the most commonly used in field studies measuring runup guza and thornton 1982 holman and guza 1984 extreme runup r 2 corresponding to the 2 exceedance value holman 1986 was calculated for each run see fig 2b furthermore the maximum wave setup at the shoreline which is the super elevation of the mean water level due to waves longuet higgins and stewart 1964 was computed as the mean of the wave runup time series η in order to estimate the relative contributions to wave runup e g stockdon et al 2007 incident s in and infragravity s ig swash were also obtained from the model results the runup time series were filtered so that s in fp 0 5 s fp 2 and s ig fp 0 1 s fp 0 5 where fp is the peak wave frequency at the forcing boundary the significant incident and infragravity swash heights were then calculated as four times the standard deviation of each filtered time series 3 machine learning 3 1 genetic programming for runup parameterisation machine learning ml is a sub discipline of computer science and a sector of artificial intelligence that applies algorithms systematically in order to synthesise relationships between information and data awad and khanna 2015 based on the notion that systems are able to identify patterns learn from data and make decisions thus ml automates the construction of analytical models to find relationships between variables involved in processes of interest passarella et al 2018 various ml techniques have been applied to coastal studies for example decision trees bonakdar and etemad shahidi 2011 abolfathi et al 2016 artificial neural networks pape et al 2007 bayesian networks plant and holland 2011a b pearson et al 2017 and genetic programming passarella et al 2018 here the focus is on using genetic programming gp to develop a runup predictor that takes into account the geometry of these environments genetic programming consists as described by passarella et al 2018 of four main steps 1 the generation of an initial population of solutions equations 2 the comparison of these solutions to training data to determine fit 3 the retention of only the solutions with the smallest error and 4 the creation of new solutions through evolutionary rules crossover by reproduction and mutation which are added to the retained solutions these steps 2 4 are then repeated until terminated by the user the final solutions range in complexity in terms of the number of operators coefficients and variables and error presented along a pareto front where increasing complexity results in decreasing error passarella et al 2018 the balance between the acceptable error and complexity of a solution depends on the user s criteria for example the computational time for more complex solutions is greater and while these present smaller errors this increased complexity can result in a loss of physical meaning following previous studies here the formulae selected from the final solutions were chosen based on minimising error whilst maintaining physical meaning due to the complexity of the parameterisations the model was run at prototype scale to permit its application to natural conditions the software eureqa developed by schmidt and lipson 2009 2013 was used for all genetic programming in this study predictors of extreme runup r 2 were identified by searching for the equation that best satisfied r 2 f h 0 l 0 β r h r c r l w based on the mathematical operations present in traditional formulations for runup the following were included in the gp addition subtraction division multiplication square root power and exponential a training subset of data is used to develop predictors which are subsequently evaluated using a validation subset eureqa presents various error metrics to assess the results we considered both non dimensional and dimensional runup predictors 3 2 training validation and testing in this study the combinations of different water depths wave conditions and geometric features result in 2800 numerical simulations with their corresponding runup records the training method chosen to develop runup predictors was the data splitting option included in eureqa with random shuffling of rows prior to training to select a representative subset of training data from the complete data set the training subset consisted of 30 of the data while the remaining 70 were used for validation which has been found to be suitable in previous studies e g passarella et al 2018 furthermore prior to developing new predictors stockdon s equation was set as the target expression in eureqa leaving gp to select the most suitable coefficients for application in a simplified reef type bathymetry this experiment involving the optimisation of stockdon s parameterisation uses the program as a genetic algorithm holland 1992 where the base function is set as eq 1 allowing 4 parameters to be optimised using the stochastic and gradient descent rules embedded in eureqa the beach slope used in stockdon s parameterisation is replaced with a forereef slope value the equation to be satisfied in eureqa was therefore 1 r 2 f 0 c 1 f 1 c 2 β f h 0 l 0 0 5 h 0 l 0 f 3 c 3 β f 2 f 4 c 4 0 5 2 where f 0 f 1 f 2 f 3 and f 4 are the relative functions β f the forereef or equivalent slope h 0 incident wave height l 0 incident wavelength and c1 c2 c3 and c4 the coefficients to be determined forereef slope was chosen here rather than an average of all the slopes e g raubenheimer et al 2001 since this is where waves initially break fig 3 shows the comparison of the model versus the parameterisation data when the target expression was based on stockdon s parameterisation i e eq 1 the error metrics presented in the gp for each new predictor include the maximum error mean squared error mean absolute error as well as the goodness of fit r2 and correlation coefficient 4 results 4 1 effect of reef geometry on runup the effects of different geometry features on wave runup were tested using the numerical model swash model results show that r 2 increased with decreasing lagoon width increasing forereef slope and in the presence of a ridge or simplified box shaped crest fig 4a and b the increase in water depth also results in an increase in runup and causes the effect of lagoon width to become less relevant the aforementioned pattern is similar for both the gentler and steeper slopes however in the former the increase in r 2 with depth is much more evident in addition the presence of the crest results in smaller differences in r 2 when the slope is gentler with similar values for the reef flat with a lagoon width of 170 9 m and the rectangular crest with a lagoon width of 239 4 m fig 4b blue triangles vs red circles except for h r 0 0 m and h r 0 64 m in some cases r 2 is actually greater for the reef flat l w 170 9 m than for the rectangular crest l w 239 4 m fig 4b h r 1 024 h r 1 408 m and h r 1 984 in terms of magnitude the forereef slope has a similar influence on r 2 to the presence or absence of the rectangular crest structure e g maximum differences of 0 89 vs 0 87 m l w 307 2 m width h r 0 64 m for both slopes at greater water depths h r 1 984 2 624 and 3 264 m smaller wave conditions result in greater runup for the reef flat than in the presence of the crest this difference increases in magnitude as depth increases last three panels of fig 4a and b fig 4 shows high r 2 variability for h 0 l 0 1 2 20 as a function of the bathymetric features hence current runup parameterisations have limitations when they are applied to these scenarios since they do not take these features into account 4 2 relative contributions to runup in order to identify the relative contributions of wave setup and low and high frequency swash components to wave runup e g stockdon et al 2006 a percentage comparison was obtained fig 5 the results for one of the water depths are presented here for the cases with and without reef crest model results show that for the reef crest scenario the relative contribution of wave setup to runup is greater than the swash contributions under all wave conditions fig 5a the differences in the contributions for different lagoon widths were negligible with the exception of the largest wave conditions where the infragravity swash contribution was greatest for the smallest lagoon and lowest for the largest lagoon for all scenarios the contribution of incident swash was small due to significant wave dissipation during wave breaking when comparing the relative contributions for the 307 2 m lagoon width with and without the reef crest there are notable differences fig 5b for instance the percentage contribution of infragravity swash to runup is larger for the reef flat than the reef crest particularly under small wave conditions around 35 40 for the flat compared to around 20 30 for the crest though this difference reduces for larger wave conditions in contrast the contribution of wave setup is consistently greater for the wave crest scenario between 50 and 60 for the crest compared to between approximately 20 40 for the flat one notable difference for the reef flat scenarios is that for low energy wave conditions h 0 l 0 1 2 25 the greatest contribution to runup is provided by infragravity swash however for h 0 l 0 1 2 25 this changes and wave setup dominates in all scenarios the contribution of incident swash is small particularly for the reef crest under small wave conditions 4 3 machine learning parameterisations more than 1 4115 e 7 formulae were evaluated in the scenario including all variables the solutions follow a pareto front where the error of each formula decreases with increasing size and complexity when compared to the validation subset of data passarella et al 2018 the selection of the most suitable solutions is subjective since often highly complex solutions while presenting the smallest error values may lose their physical interpretation passarella et al 2018 furthermore there is a risk of over fitting when using more complex solutions which means they lose their generalisation power passarella et al 2018 and become very specific to the training and validation data used to generate the solution therefore it is important to test the new formulae on data that have not been used in their development different runup formulations were derived using the numerical model results and the ml technique both non dimensional and dimensional formulae were tested for the former the relevant parameters presented in fig 1 were combined to form non dimensional parameters a b c d following merrifield et al 2014 the lagoon width and depth were included in one parameter and the crest height was non dimensionalised with the water depth over the reef as a r 2 h 0 b l w t p 9 82 h r 0 5 c c r h r d tan β r h 0 l 0 ˆ 0 5 eureqa was then left to find relationships following the form a f0 b f1 c f2 d to ensure non dimensional coefficients based on the need to balance error reduction with the physical interpretability of the results for each scenario of parameters the most suitable formulae were chosen both dimensional and non dimensional eqs 2 and 3 2 r 2 0 108 h 0 l 0 l w h 0 c r β r 0 000186 h 0 h r l w 3 a 0 53 0 099 d 0 013 c 0 23 0 016 b for example a formula might result in smaller errors but lead to negative r 2 values when they are not present in the model results and would therefore not be appropriate despite the greater error reduction furthermore the formulae identified by eureqa that produce the smallest error tend to be the most complex and have the greatest number of coefficients the more complex formulae also have a greater tendency to over fit the data and become less applicable to different scenarios the formulae were also inspected using typical values to check their applicability the last term in eq 1 contributes to a lesser degree than the other terms however it still accounts for a third of the magnitude of the next smallest term the removal of this term while apparently of lesser importance resulted in a substantial increase in error fig 6 shows a comparison of the results of the optimised stockdon parameterisation the formulation with dimensions eq 2 and non dimensionalised eq 3 the highest correlation coefficients were found for the parameterisations that take into account all parameters fig 6 and table 2 the overall error for the new parameterisations obtained when the target expression is set as stockdon s formula eureqa calibrated is much smaller than when the original parameterisation stockdon et al 2006 is used however the errors and dispersion of runup predictions are still larger than when all the variables are included fig 6 table 2 when comparing the parameterisations present in fig 6b and c eqs 2 and 3 rmse was smallest and the correlation coefficient was greatest for fig 6c eq 2 although the bias was smaller for the non dimensional equation it is worth mentioning that in order to make a fair comparison the results in fig 6b have been multiplied by wave height when comparing the results of the parameterisations developed using different combinations of the relevant parameters the greatest errors were presented by those that only take into account h 0 l 0 and β r fig 7 this analysis was not performed on the non dimensional formula since its terms include combinations of parameters that cannot easily be separated without losing the non dimensionality of the equation the eureqa calibrated stockdon parameterisation obtained using eureqa substituting beach slope for forereef slope and allowing eureqa to identify the most suitable coefficients resulted in a substantial improvement in its ability to predict the model runup values table 2 fig 6 however the errors remain higher than for the parameterisations including additional parameters r2 of 0 65 compared to 0 93 when all parameters are included table 2 the geometry parameters were tested individually by adding them one at a time to the initial parameters of h 0 l 0 and β r the results showed that including h r in the parameterisation contributed most to reducing the error values table 2 for example when the target expression was not specified as eq 1 i e eureqa identified the formulae the highest r2 value for the parameterisations obtained using only h 0 l 0 and β r was 0 67 compared to 0 83 when including h 0 l 0 β r and h r when all parameters were included the r2 value was 0 93 showing more accurate results when all parameters were accounted for these errors are for the comparison between the training and validation data given by eureqa when calculated between the model runup results and the predicted values obtained using the parameterisations the errors were further reduced with an rmse of 0 25 and correlation coefficient of 0 95 when all parameters were included fig 7 fig 7 also shows how h r resulted in the smallest errors for the individual parameters rmse 0 37 correlation coefficient of 0 89 4 4 parameterisation validation in order to validate the parameterisations eqs 2 and 3 including all variables with and without dimensions were tested on data that had not been used in their development a set of scenarios with an additional depth and a wider lagoon for all wave conditions and h r values initially used furthermore to test the applicability of the parameterisations beyond the conditions tested here a set of scenarios including flat and crest geometry different h r values and a constant l w 307 2 m for typhoon scale wave conditions h 0 14 16 18 and 20 m t p 16 5 s from shimozono et al 2015 were also evaluated here the results for h 0 14 and 16 m have been included to demonstrate the ability of the two parameterisations to predict runup in very extreme scenarios fig 8 shows how eqs 1 and 2 numbered 1 and 4 in the figure present the highest correlation coefficients when used to estimate runup for scenarios unknown to the model not used in training or validating the data the eureqa calibrated stockdon equation while presenting substantial scatter actually performed well in the analysis showing a substantial reduction in the error metrics fig 8b compared to the stockdon et al 2006 formula that is typically used numbered as 3 in fig 8 furthermore the latter shows a very high bias in comparison with the other formulae fig 8b when comparing the results with those of the non dimensional parameterisation black asterisks in fig 8 the results are quite similar although this paramterisation presents a large negative bias compared to the parameterisations where the dimensions were not removed fig 8b it is worth mentioning that in order to make a fair comparison the target variable of this equation r 2 h 0 was multiplied by h 0 to obtain r 2 based on the error metrics in fig 8 b eq 1 is the best parameterisation for the scenarios included here this changes however when considering the typhoon scale scenarios tested circular markers in fig 8a under these conditions eq 1 underestimates r 2 and presents considerable scatter whereas the nondimensional equation black circles is a closer estimate the underestimate of eq 1 under typhoon scale scenarios may be due to the presence of dimensions in the parameterisation making it less applicable to conditions which are extremely different from those used to generate it which may be due to a small degree of overfitting or irreducible variability in compressing the physics of runup into just a few parameters it is possible that this could be improved further by calibrating the coefficients as was the case for the eureqa calibrated stockdon equation the new parameterisations eqs 2 and 3 including all the variables resulted in the smallest errors and are therefore the best predictors for runup results show that for reef morphology studied here stockdon et al 2006 tends to overpredict runup however when comparing the eureqa calibrated stockdon equation first equation in table 2 and that presented by stockdon et al 2006 the error is reduced substantially fig 8 this suggests that using the reef slope rather than the beach face slope and calibrating the coefficients is required to improve its predictive capability for reef lined coasts the replacement of the beach face slope with the fore reef slope appears to improve the results since this is where waves initially break in the case of reef line coasts hence it is where most incident swash is dissipated and setup is greatest furthermore previous studies have found that infragravity wave energy can be trapped when the reef slope is steeper leading to resonant amplification and increased runup along reef lined coasts e g becker et al 2016 pearson et al 2017 pequignet et al 2009 buckley et al 2018 the reduction in predictive error for eq 3 compared to the eureqa calibrated stockdon equation shows that for reef lined coasts h r l w and c r are additional parameters that need to be accounted for when comparing the parameterisations to the numerical results for the new subset of data fig 7 the eureqa calibrated stockdon parameterisation tends to overestimate runup although less than the traditional stockdon et al 2006 parameterisation and presents greater scatter in the predictions than the new eureqa derived formulae increasing l w decreases wave runup hence it is likely that by including this parameter the overestimation that results from using the stockdon parameterisations is reduced as is the scatter in the predictions in a study by da silva et al 2020 using swash the authors found the absence of information on the submerged beach morphology could results in substantial variability in runup estimates these authors found the distance between the shore and the sandbar crest to be of particular importance a parameter not dissimilar to l w in the current study the overall reduction in scatter and error in runup prediction by including the geometry parameters in the new parameterisations figs 6 and 7 table 2 demonstrates their improved suitability to reef fringed coasts a limitation to all the parameterisations presented here is the absence of a term for roughness although previous studies have found this parameter to be less important than those included here for a reef lined coast e g pearson et al 2017 a study by buckley et al 2018 found large bottom roughness to reduce low frequency motions and reduce runup by 30 hence further testing is warranted 5 discussion the primary mechanisms that control the water level at the coast are tides storm surge and wave runup buckley et al 2016 the results presented here show that wave runup was significantly higher in the presence of a reef crest which is due primarily to an increase in wave setup over the flat consistent with the findings of yao et al 2017 furthermore they also found that increasing crest width resulted in greater wave setup and identified crest submergence as the primary parameter controlling the magnitude of wave setup on the reef flat it is worth mentioning that this was for a 1d scenario and 2dh effects may also play a role reducing setup when circulation and alongshore effects are accounted for as is also the case for the present study reefs are often interspersed with channels and spur and groove systems which would reduce the 1d effect seen in wave setup and can induce significant wave energy dissipation acevedo ramirez et al 2021 in terms of the effect of the forereef slope on r 2 c r and l w had less influence when the slope was milder fig 4 forereef slope has previously been found to be more influential than the friction coefficient or beach slope pearson et al 2017 in terms of the relative components of runup the presence of the reef crest had a substantial influence on η and s ig with substantially larger η contributions for the crest particularly under smaller wave conditions although likely exaggerated due to the 1d nature of the model and larger s ig for the flat smaller contributions of s in were found for all scenarios these results support previous findings that infragravity swash dominates in reef environments e g nwogu and demirbilek 2010 pomeroy et al 2012 torres freyermuth et al 2012 zijlema 2012 franklin et al 2018 buckley et al 2018 nwogu and demirbilek 2010 also found infragravity wave energy to increase shoreward over the reef flat and with increasing water level as found here results not shown in the case of the reef flat for constant water depth runup increases with increasing offshore wave height and becomes increasingly driven by wave setup fig 5b s in is small since wave breaking at the reef edge dissipates most of the incident wave energy in the surf zone pomeroy et al 2012 and since higher harmonics are subject to greater attenuation the infragravity spectral band becomes dominant over the reef flat shimozono et al 2015 furthermore there is a possibility of resonant amplification of low frequency motions across the reef flat if significant energy is present at the natural frequency of the reef flat shimozono et al 2015 depending on the flat length and water level pequignet et al 2009 since water level can affect resonant frequencies it has been suggested that increased sea levels associated with climate change ipcc 2007 may increase resonant frequencies pequignet et al 2009 this becomes particularly important since inundation events have been observed for low lying areas where low frequency motions dominate the water level at the shore e g merrifield et al 2014 in terms of the parameterisations obtained with eureqa the water level over the reef h r had the greatest influence on improving predictability reduced error showing the importance of water depth and reef crest submergence on wave runup this is supported by the findings of rueda et al 2019 who included water levels as a variable in their reef metamodel and found it to be associated with larger runup values furthermore the sensitivity analysis for eq 3 appendix c table c 2 shows that this variable had a greater effect on runup than l 0 and β r the latter of which actually had the least influence on runup compared to the other parameters this has important implications since one of the most widely used parameterisation at present stockdon et al 2006 is based on h 0 l 0 and beach slope results show that the gp predictors proposed in the current study for wave runup perform better in environments with complex bathymetries e g coral reefs than existing formulae the simplest solutions not shown show a linear dependence on h 0 followed by l 0 and slope in this case reef face slope demonstrating the importance of these variables in predicting runup as has previously been demonstrated e g stockdon et al 2006 bonakdar and etemad shahidi 2011 park and cox 2016 passarella et al 2018 holman and guza 1984 holman 1986 however in slightly more complex solutions h r becomes important remaining present in the more complex solutions suggesting that including this variable in the runup formulations reduces prediction error these findings are supported by the variable sensitivity reports produced by eureqa which show the relative impact of each variable within the model on the target variable in this case runup in all solutions h 0 had the greatest impact often followed by l 0 the impact of the remaining variables was of a similar order of magnitude with all variables having a 100 positive likelihood of increasing the target variable with the exception of l w which presented a 100 negative likelihood increases in this variable decrease the target variable 100 of the time the latter effect is similar to that identified by yao et al 2017 with a wider crest appendix c tables c 1 and c 2 show the sensitivity results for the two most accurate parameterisations developed in the current study eqs 2 and 3 these presented an error that was similar to the mean error presented by rueda et al 2019 of 30 cm 6 conclusions this study uses a non linear wave transformation model and machine learning to investigate wave runup associated with wave transformation on reef lined coasts different wave conditions were simulated over an idealised reef geometry at prototype scale findings show runup to be dominated by the contributions of wave setup and infragravity swash depending on the wave energy the forereef slope reef crest reef flat width and water depth were varied to elucidate their role in runup modelling results were employed by ml to derive different parameterisations the selected ml based parameterisations include the reef geometry dependence and improve on the runup parameterisation typically used for beaches following wave height water level over the reef was the most important parameter to predict runup in these environments followed by reef flat width this increase in water level could be taken as a proxy for sea level rise due to climate change demonstrating the increase in potential for flooding at greater water levels the effect of reef flat width is likely to be greater for increased roughness values not included here under the 2d idealised conditions used here the presence of an impermeable reef crest enhanced wave runup for large wave conditions and shallower depths which contradicts the belief that the reef crest provides coastal protection however this is likely due in part to the 2dv settings used in the present study despite these findings at greater depths and under smaller wave conditions runup was smaller demonstrating the role of the crest in protecting the coast by excluding reef roughness it is possible that runup estimations are larger than for natural reefs since roughness would act to dissipate wave energy and reduce runup particularly for wider reef lagoons where it would enhance dissipation over the reef flat when comparing the non dimensional and dimensional parameterisation developed with eureqa the former is most suited to the data and scenarios presented here however the non dimensional parameterisation seems to be more effective at predicting very extreme wave conditions nevertheless the disadvantage with the latter is that it cannot include 0 wave height conditions or h r values of 0 whereas the dimensional parameterisation can future efforts should be devoted to extend this approach by incorporating the effects of bed roughness and three dimensional processes in order to be able to extrapolate the results to natural reef environments credit authorship contribution statement gemma l franklin methodology writing original draft writing reviewing and editing visualization investigation formal analysis alec torres freyermuth conceptualization writing reviewing and editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements many thanks to gonzalo martín ruiz for technical support and to delft university of technology for making the development of the swash model possible thanks also to the anonymous reviewers whose comments and suggestions helped to greatly improve the manuscript funding this work was supported by funding received by the first author through a postdoctoral scholarship awarded by the programa de becas posdoctorales mexico and papiit mexico in102221 from dgapa unam mexico the national council of science and technology conacyt mexico through the national coastal resilience laboratory lanresc cb 2016 01 project 284430 and the institute of engineering unam mexico the authors acknowledge support provided by cátedras conacyt mexico project 1146 appendix a runup parameterisations appendix b numerical model validation for the model validation the laboratory data by demirbilek et al 2007 were employed the beach profile of an idealised fringing reef fig b 1c was implemented with a uniform mesh with a cell resolution of 0 01 m the time step was 0 01 s and simulations were run for 450 s the numerical model was forced with the free surface elevation time series measured at the offshore sensor the numerical results using test 29 h s 0 071 m t p 1 5 s z 0 516 m from demirbilek et al 2007 show swash to be capable of predicting wave height fig b 1a setup fig b 1b and runup fig b 1d with reasonable accuracy consistent with previous studies using a similar solver lashley et al 2018 appendix c sensitivity results for the two selected runup parameterisations sensitivity the relative influence each variable has on the chosen target variable within a resulting model positive how likely it is that an increase in a given variable will result in an increase in the target variable positive magnitude how large the positive influence of the variable on the target variable is negative how likely it is that an increase in a given variable will result in a decrease in the target variable negative magnitude how large the negative influence of the variable on the target variable see eureqa for further details on definition of terms 
