index,text
20330,a numerical study based on improved delayed detached eddy simulation is conducted to investigate the flow of a pre swirl pumpjet propulsor pjp the pjp consists of a stator a rotor and a duct in order to separate the roles played by the rotor stator and duct in determining the flow of pjp three models are established the r model rotor only the r d model rotor within a duct and the pjp model rotor and stator within a duct results show that the effect of the duct on the unsteady force acting on the rotor blades is weak while the pre swirl stator on it is strong due to the rotor stator interference in addition the vortex structure of the three models are compared the tip duct mutual inductance instability mode that the duct induced vortex begins to affect adjacent tip vortices is reported for the pjp model a unique short wave instability mode of the tip vortex caused by the existences of pre swirl stator is discussed more importantly for the r d and pjp model the transition from stability to instability of the tip vortex depends on both the spiral to spiral distance and the strength of duct induced vortex keywords pumpjet propulsor improved delayed detached eddy simulations the pre swirl stator the tip vortex instability mode 1 introduction in recent years more and more attention has been paid to research on the vortex dynamics of marine propellers such as the single propeller the ducted propeller and the pumpjet propulsor pjp among them the ducted propeller is more and more widely used in vessels and underwater vehicles due to its capacity of generated high thrust under heavy loads in addition the pjp consists of a stator a rotor and a duct nouri et al 2013 is a new type of propeller which is widely used for torpedoes and submarines due to its superior hydrodynamic cavitation and noise performance qin et al 0000 plenty of work have been done on the wake dynamics of single propellers both theoretical joukowsky 1918 levy and forsdyke 1928 widnall 1972 gupta and loewy 1974 okulov 2004 pozrikidis and higdon 1987 tophøj and aref 2013 hattori and fukumoto 2009 hattori and hijiya 2010 meunier and leweke 2001 le dizes 2000 sipp et al 1999 vermeer et al 2003 and experimental felli et al 2006 2008a 2011 di felice et al 2009 felli et al 2008b based on the theoretical research the wake vortex of a single propeller consists of the tip vortices a hub vortex and a sheet of vortices shedding from the trailing edge of rotor blades the trailing vortices felli et al 2011 felli and co workers got several important conclusions of the triggering mechanism of the rotor wake instability in experiments on an e779 a model propeller in the italian navy cavitation tunnel it was found that the instability transition of the tip vortices depends on the inter spiral distance of tip spiral filaments the spatial evolution of the tip vortices occurs through a multi step grouping mechanism which is caused by the mutual inductance instability mode between adjacent spiral filaments felli et al 2011 as for the research of the wake dynamics of the ducted propeller few works have been done in this region oweis and ceccio 2005 measured the flow field of a ducted marine propeller by particle image velocimetry piv technique based on the results a primary tip leakage vortex is observed in addition a secondary co rotating trailing edge vortex and some co rotating or counter rotating vorticity are found in the blade wake the merge process of the primary vortex with weaker secondary and wake vortices are discussed lababidy et al 2005 carried out an experiment of a ducted marine propulsor under high load conditions at the italian ship model basin insean and the wake flow at the different downstream location was measured by piv it is found that the blade wake will almost disappear within one diameter downstream the maximum vorticity region is found at the blade tip and hub of propeller with an obvious trailing vorticity region shedding from the trailing edge in addition the wake vorticity of the ducted propeller decreases with increasing advance coefficient cozijn and co workers carried out a lot of experiments of ducted propellers operating under open water cozijn et al 2010 behind a barge cozijn and hallmann 2012 and behind a drillship cozijn and hallmann 2013 the measurement results show that the wake flow of ducted propeller is deformed by the plate and the barge there is a low pressure region at the side of the barge causing the wake flow to diverge up as it flows from under the barge into the open water in addition the interaction of thruster and the drillship is studied by detailed piv measurements those researches are mainly focused on the velocity field but less on the discussion of vortex structure in the wake field of ducted propeller felli et al 2008b carried out an experiment of a flat plate which was located right behind a four bladed ducted propeller in a large cavitation channel of insean italian institute for naval architecture studies and testing measurements of flow fields were carried out using high speed cameras and piv the structure of tip vortices undergoes a deformation from a cylindrical envelope surface to a typical shape of the type b jet this work did not study the specific vortices structure of ducted propeller but focused on the jet wall interaction with different impingement distances along with the experimental studies the application of computational fluid dynamics cfd for the wake dynamics analysis of the ducted propeller has also been considered gong et al 2018 compared the structure and the evolution of the wake vortices of a ducted propeller with a non ducted propeller delayed detached eddy simulation ddes simulations were carried out the duct had a significant effect on the morphology of the non ducted propeller the deformation of the tip vortex happened and was caused by the blade duct interaction and the multi inductance between adjacent tip vortices together the merging of the shear layer vortices shedding from the duct trailing edge and the tip vortices generated new secondary coherent structures in the near field region zhang and jaiman 2019 investigated the wake dynamics of a four bladed ducted propeller at a reynolds number of 1 765 1 0 5 using ddes and the sliding mesh model the phenomenon of leapfrogging the secondary vortex and the short wave instability of tip vortices were illustrated it was found that the length of the tip vortex moves further downstream with increasing advance coefficient while the sustainable region of the trailing edge vortices nearly remains unchanged the complex interaction between the two vortices was discussed as for the research of the wake dynamics of pjp most works focus on the study of hydrodynamic performance suryanarayana et al carried out the experimental of a pjp equipped at an axisymmetric body in a wind tunnel in addition suryanarayana et al did more experiments for the axisymmetric body fitted with pjp in the cavitation tunnel at naval science and technological laboratory nstl the propulsor characteristics the self propulsor point of the model the rotor and stator torques and tunnel blockage effects were discussed suryanarayana et al 0000a b c in addition to experimental researches numerical studies were carried out to predict the hydrodynamic performance of pjp by cfd lu et al 0000b a qin et al 0000 shirazi et al 2019 wang et al 2019 lu et al 0000b carried out the numerical simulation of a pumpjet propulsor with 11 rotor blades and 9 stator blades the reynolds averaged navier stokes rans equation combined with the shear stress transport sst k ω turbulence model was adopted the hydrodynamic coefficient and efficiency of pjp were discussed qin et al 0000 investigated the hydrodynamic performance of pjp with different tip clearances by cfd results show that the open water efficiency of pjp decreases with increasing tip clearance which is caused by the gradually enhanced tip vortices however relatively few studies focus on the wake dynamics of pjp qin et al 2019 compared the vortex structures of a pjp with a normal duct and a sawtooth duct the sawtooth duct was proposed and applied for the first time to pjp to reduce the noise of pjp it was shown that the vortex of pjp consists of the impact separation vortices a hub vortex and the duct induced vortices in addition different hybrid rans les approaches ddes iddes improved delayed detached eddy simulation model sdes shielded detached eddy simulation and sbes stress blended eddy simulation are used to investigate the wake flow of a pre swirl stator pjp li et al 2020 the shear layer of the duct was induced by the tip vortices the second vortices were formed and were merged with the adjacent tip vortices it was shown that the iddes sdes and sbes show better resolving ability in vortices compared with the ddes the open water performance of pjp with different duct parameters was carried out by huang et al 2021 by cfd the effect of duct parameter on the flow of pjp was discussed while few discussion was focused on the vortex structure due to that the sst k ω model was used and it was hard to capture the evolution of the tip vortices in the wake region of pjp using this turbulence model in general in spite of a number of studies of wake dynamics of the ducted propeller and pjp have been done the triggering mechanism of the tip vortex instability the reconstruction of the complex vortex structure for the pjp are still not yet explained thoroughly in the literature here a numerical study is carried out to investigate the wake dynamics of a pre swirl pumpjet propulsor three models the rotor the rotor duct and the pjp model are established to separate the roles played by the rotor the stator and the duct in the vortex evolution of a pjp the hydrodynamic performance the vortex structure and the vortex dynamics of those three models are discussed in the present paper the aim of this paper is to make a deeper understanding of the difference in the vortex structure between three classical propellers the single propeller the ducted propeller and the pjp the layout of this paper is as follows in section 2 the numerical methodology is given in section 3 the numerical set up such as the geometry and the boundary conditions are described section 4 gives the flow results and discussion from four main aspects the open water coefficient and unsteady blade excitation force section 4 1 the effect of the duct on the vortex structure of the rotor section 4 2 the effect of the pre swirl stator on the vortex structure of the rotor section 4 3 and vortex dynamics section 4 4 finally the conclusions are discussed in section 5 2 numerical methodology here for the pumpjet propulsor the numerical simulation of the incompressible viscous flow field is performed the navier stokes equations can be written in non dimensional form in the inertial frame of reference in terms of absolute velocity components as follows 1 u i x i 0 2 u i t x j u j u i p x i τ i j x j 0 i 1 2 3 where u i are the components of the fluid absolute velocity p is the fluid pressure t is the time τ i j ν t u i x j u j x i is the stress tensor and ν t 1 r e ν t with ν t being the turbulent viscosity in all the simulations shown in the paper the improved delayed detached eddy simulation iddes model gritskevich et al 2012 was employed in order to resolve in detail the vortex structures of the pumpjet propulsor for the sake of completeness the equations of iddes model are summarized the iddes model is based on a modification of the sink term in the k equation of the shear stress transport sst model ρ k t ρ u k μ μ t σ k 3 k p k ρ β k ω f iddes ρ ω t ρ u ω μ μ t σ k 3 ω 1 f 1 2 ρ k ω σ ω 2 ω α 3 ω k p k β 3 ρ ω 2 3 f iddes l rans l iddes where the turbulence length scale is the parameter that defines this rans model is the turbulence length scale l rans k β ω more details can be found in gritskevich et al 2012 the reason of choosing this turbulences model has been discussed in a research before li et al 2020 3 numerical setup 3 1 geometry fig 1 a b c give three models studied in this paper and fig 1 d is the photo of the experimental model in this paper a pre swirl pumpjet propulsor is designed for a large underwater robot a 1 20 scale model scale of numerical model full scale model 1 20 is used for numerical work as shown in fig 1 c a hydrodynamic experiment on this pjp model was carried out in the water tunnel of the science and technology on water jet propulsion laboratory marine design and research institute of china see fig 1 d the details of the experimental data can be found in li et al 2020 this pjp is composed of a duct whose maximum diameter is d d 0 22 m the rotor six bladed rotor n r 6 and the stator eight bladed stator n s 8 table 1 gives the geometrical details of the rotor and stator blades among them the pitch ratio the maximum thickness ratio and the chord length ratio use the corresponding value at r 0 7 r r is the maximum radius of blade in addition more details of this model can be found in qin et al 2021a in order to study the effect of the duct and the pre swirl stator on the vortex structure of the rotor two models are generated based on the pjp model the r model fig 1 a and the r d model fig 1 b the r model which only consists of six rotor blades can be considered as a normal single propeller the r d model is composed of the same rotor and the duct by comparing the r d model with the r model the influence of duct on the vortex evolution of a normal single propeller can be studied similarly by comparing the flow of pjp model with the r d model the influence of the pre swirl stator on the flow of the ducted propeller can be investigated for those three models the coordinate systems are all the same see fig 1 a coordinate system whose origin is located at the center of the rotor is established the incoming flow direction is set as the positive direction of z axis the perpendicular upward direction is the positive direction of x axis and the y axis can be determined by the right hand rule the maximum diameter of the rotor blades is d r 0 1664 m which will be used as the characteristic diameter of the three models to calculate hydrodynamic coefficients 3 2 computational domains and meshes as shown in fig 2 the sizes and partition methods of the computational domains for the three models are basically the same in order to minimize the effects of numerical errors arising during mesh generation specifically the computational domain is a cylinder of diameter 10 d d and length 20 d d the whole computational domain is divided into several subdomains the rotor domain the near field domain the far field domain and the stator domain for the pjp model the size of the near field domain remains the same with a cylinder of diameter 1 5 d and length 5 d that is chosen according to the results of previous research qin et al 2021b here for the r d model and the pjp model the reynolds number is defined as re ρ c 1 0 r π n d r 2 v 2 μ where c 1 0 r is the chord length of the rotor blade at 1 0r and n is the rotational speed r s 20 r s in this simulation the re of the three models has a maximum value with about 8 5 1 0 5 structured grids are generated the details of which are shown in figs 3 and 4 the topological structures of the three grids are basically the same the surface mesh of the three models can be seen from fig 3 a fig 3 b gives the meshes in the middle section y z plane for the three models it can be clearly observed that the wake region of propeller is refined to capture the evolution of wake vortices of the propeller more mesh details of the three models can be seen in zoomed in view in fig 3 b fig 3 c and d show the mesh in the middle section of the stator domain and the rotor domain respectively it should be mentioned that the grid of the rotor and stator domain is obtained by rotating and copying the structural grid of single blade passage in addition as shown in fig 3 e the 1 mm gap between the rotor tip and duct of the r d and pjp model is divided into about 31 layers to accurately capture the generation of the tip vortex for these three grids the mean y value of the propeller surfaces is about 5 and the growth rate is 1 1 the determination of y value had already been studied in prior research qin et al 2021b the grid information for the three models can be found in table 2 the total mesh number of the r model is 9 35 1 0 6 while the total mesh number is 8 37 1 0 6 for the r d model and 12 53 1 0 6 for the pjp model respectively here iddes simulations for those three models are carried out the boundary condition setting is shown in fig 2 the rotor domain is set as a rotating domain with 1200 revolutions per minute rpm rotation speed the inlet surface is set as the velocity inlet and the incoming flow speed varies according to different j the outlet surface is set with an constant pressure of 0 pa the nodes of the rotor domain move rigidly for this case is a simple rotation motion and rotor domain is connected with the other cell zones through non conformal interfaces the turbulence intensity in the simulation is 5 furthermore the simplec algorithm is used the pressure is discretized by the second order scheme and the turbulence kinetic energy and specific dissipation rate are using the second order upwind scheme in addition the bounded second order implicit time discretization scheme is used in the iddes simulation the time step size is determined by using the courant friedrichs lewy cfl number the flow of pjp is solved by ansys fluent version 16 ansys inc 3 3 validation to validate the cfd simulation results the numerical results of the pjp are compared with the experimental data in the experiment the water tunnel has a speed range of 0 15 m s and the test conditions for this pjp were values of the advance coefficient j in the range 0 2 1 2 with a fixed rotational speed of 1200 rev min in the simulation ρ is the fluid density n is the rotational speed of rotor n 20 r s here d r is the mean diameter of the rotor blades d r 0 1664 m v is the far field incoming flow velocity t r and t d are the thrust generated by the rotor and the stator duct respectively t d 0 for the r model q r and q d is the torque of the rotor and the stator duct respectively to discuss the hydrodynamic performances of propellers some non dimensional physical quantities are defined the thrust coefficient and the torque coefficient of the rotor is k t r t r ρ n 2 d r 4 and k q r q r ρ n 2 d r 5 respectively t r and q r is the thrust and the torque of the rotor respectively similarly the thrust coefficient and the torque coefficient of the stator and duct is k t d t d ρ n 2 d r 4 and k q d q d ρ n 2 d r 5 respectively the total thrust coefficient is defined as k t k t r k t d and the torque coefficient of pjp used to calculate efficiency is defined as k q k q r following the definition of qin et al 0000 lu et al 0000b a the openwater efficiency of the pjp is defined as η j 2 π k t k q the numerical simulation results of the pjp model are compared with the experimental results in fig 5 for each case 45 rotation cycles are calculated and the average value of the last 30 cycles is taken as the final hydrodynamic performance prediction as can be seen from fig 5 the results are in good agreement with the experimental values the maximum relative errors δ k t and δ k q are only 4 48 and 1 80 respectively for j 0 2 δ k t is k t n u m k t e x p k t e x p considering the machining error of the actual experimental model these numerical errors are acceptable in a word the hydrodynamic performance coefficient predicted by the iddes simulation is accurate compared with the experiment data next the grid independence test are carried out and three different grids are generated a coarse grid a medium grid and a fine grid details of those grids have been given in fig 4 for the three grids the height of the first boundary layer mesh is kept unchanged only with a refinement of nodes the number of nodes distributed around the airfoil of the rotor for the coarse grid is 81 and those of the medium and fine grids are 121 and 181 respectively hence the total number of coarse grid and the medium grid is 8 38 1 0 6 and 12 53 1 0 6 respectively while that of the fine grid is 24 59 1 0 6 more detail of the number of each sub domain can be found in table 2 based on the theory of celik et al 2008 the grid convergence index gci of the hydrodynamic coefficients for the pjp model is calculated here the n1 n2 n3 are the total number of mesh for the fine medium and coarse grid respectively similarly ϕ k denotes the solution on the k th grid here the k t r and k q r are selected to study the uncertainty the calculation process of gci is as follows 4 p 1 in r 21 in ɛ 32 ɛ 21 q p 5 q p in r 21 p s r 32 p s 6 s 1 sgn ɛ 32 ɛ 21 7 ɛ 32 ϕ 3 ϕ 2 ɛ 21 ϕ 2 ϕ 1 for the three dimensional calculation 8 r 21 n 1 n 2 1 3 r 32 n 2 n 3 1 3 the approximate relative error is 9 e a 21 ϕ 1 ϕ 2 ϕ 1 in the fine grid convergence index 10 gci fine 21 1 25 e a 21 r 21 p 1 similarly the gci in the medium grid solution gci medium 32 can be calculated more details can be found in celik et al 2008 the iddes simulations of the three grids at j 0 4 and 1 0 are carried out and the results are shown in table 3 the numerical uncertainties in the medium grid solution gci medium 32 for k t r and k q r have maximum values of about 0 96 in addition three different time steps δ t 2 t t and 0 5 t are chosen where t is the time taken for the rotor blades to rotate 1 and is t 1 39 e 4 s for the working condition with a rotational speed n 1200 rev min to carry out the time step independence verification based on the results table 4 both k t r and k q r increase gradually and approach the experimental values as the time step decreases thus both grid and time step independence are satisfactorily verified more details of verification process can be found in one of our research before qin et al 2021b 4 flow results and discussion 4 1 open water coefficient and unsteady blade excitation force the iddes simulations for the r model the r d model and the pjp model are carried out fig 6 a shows a comparison of the open water efficiency of the three models the r model which is equivalent to an ordinary single propeller reaches its maximum point of about 60 24 for j 0 8 however the maximum efficiency of the r d model shows a significant decrease from 60 24 of the r model to 52 27 for j 0 7 the duct changes the velocity of the incoming flow of the rotor but inevitably brings additional resistance especially in the case of high j finally for the pjp model the presence of the pre swirl stator clearly improves the open water efficiency under most working conditions j 0 6 1 4 compared with the r d model the maximum efficiency of the pjp model is about 58 22 for j 1 0 which is close to that of the r model 60 24 in addition after exceeding the optimal efficiency point the efficiency decreases sharply for the r and r d models while the efficiency of the pjp model is effectively improved at high j with a small decline in slope thus the pjp model has better hydrodynamic performance compared with a normal single propeller and a ducted propeller as shown in fig 6 b for all three models the total thrust coefficient k t decreases linearly with increasing j for the r model k q r also decreases nearly linearly with increasing j whereas for the r d and pjp models it decreases with an increasing slope fig 6 c shows the behavior of k t k t r and k t d for the r d and the pjp model k t d 0 for the r model as can be seen the behavior of k t is similar for both models for the pjp model compared with the r d model the significant increase k t is obviously due to the increase in k t r about 0 2 for all calculated cases of j with only a slight decrease in k t d about 0 05 for all calculated cases of j hence the presence of a stator improves the working condition of the rotor very well with very small additional resistance which is also why the efficiency of the pjp is higher than that of the r d model for most values of j fig 7 a b and c show the time histories of the unsteady load force normalized as k t r of each rotor blade at j 1 0 the optimal operating point of the pjp model for the r model the r d model and the pjp model respectively for clarity only the unsteady force of rotor blade 1 the number of blade is numbered clockwise is shown in the left of fig 7 furthermore the unsteady load forces of six rotor blades at t 1 5 1 51s were compared in the right of fig 7 the unsteady force of rotor blade for the r model shows similar change trend with that of the r d model while that of the pjp has an obvious difference compared with the r model and the r d model standard sinusoidal periodic variation characteristics are observed for the unsteady force of each rotor blade for the pjp model furthermore fft fast fourier transform results of the unsteady load force of rotor blade 1 for those three models at j 0 6 and 1 0 are compared in fig 8 for the r model and the r d model at both working conditions the amplitude frequency spectrums show an overall broadband characteristic with several obscure peaks at 60 hz 80 hz 160 hz and 240 hz which corresponds to 3 f n 4 f n 8 f n and 12 f n respectively f n n 60 is the shaft rotation frequency and n is 1200 rpm for both j it shows that the characteristic frequency of the unsteady load force acting on each rotor blade for the r and r d model is the harmonics of shaft frequency in addition we can see that the frequency characteristics of the k t r of blade 1 for the r d model have nearly no change compared with that of the r model which shows that the duct almost has no effect on the unsteady force of the rotor however for the pjp model the frequency spectrum of k t r shows obviously peaks at 160 hz 320 hz 480 hz 640 hz and et al which corresponds to n f s f s f n n s 20 8 160 hz is the stator blade passing frequency therefore the characteristic frequency of the unsteady load force acting on each rotor blade for the pjp is the stator blade passing frequency and its harmonics the reason can be found in fig 9 at which contours of the axial velocity component at the same z slices of those three models are compared three slices are created which are located at the inlet surface a the surface before the rotor b and the outlet surface c respectively at slice a for the r model and the r d model the incoming flow is similar to the far field flow with a basically circumferential uniform incoming flow while eight periodic low velocity regions before the stator blades are found for pjp at slice b as shown the axial velocity of flow for the r and r d model keep the uniform distribution unchanged only with an increasing of the axial velocity due to the suction effect of the rotor in addition the incoming velocity of pjp shows periodic distributions with eight channels caused by the rectification of eight front stator blades so it is easy to understand the occurrence of the frequency of n f s with each rotor blade passing through these eight channels in turn at slice c as shown the outflow of the r and r d model shows as uniform six flow acceleration channels caused by the rotation of rotor while for the pjp the outflow shows as a basically uniform flow because the pre rotation component brought by the front stator is canceled by the rotation of the rotor for the pjp the rotation velocity component of outflow is very small which means the pjp can recover the rotational energy in the wake very well this is one significant advantage of pjp for the hydrodynamic performance compared with the single propeller or ducted propeller we call the violent interaction between the rotor and stator as the rotor stator interference force for the pjp the rotor stator interference force will have a significant effect on the unsteady load force acting on each rotor blade in addition it can be inferred that the hydrodynamic noise of pjp will be larger than that of the r and the r d model due to the violent rotor stator interference force this phenomenon is contrary to our general cognition that the pumpjet propulsor is more quiet than the single propeller of course we do not consider the sound shielding effect of the duct here the difference of underwater radiated noise among the single propeller the ducted propeller and the pjp is worth further study 4 2 effect of the duct on the vortex structure of the rotor fig 10 compares the instantaneous flow field in the y z plane of the r d model and the r model for j 0 8 the optimal operating point of the r model fig 10 a shows the z component of vorticity in the y z plane the positions of the tip vortices has been marked by red circles it can be seen that the tip vortices of the r d model are denser than that of the r model taking the 13th tip vortex core center v13 as an example the v13 of the r d model is located at z d 1 6 while z d 1 9 for the r model fig 10 b gives the contours of the pressure coefficient in the y z plane for both models it can be seen that the tip vortices observed as the low pressure zones gradually shrink inward in the radial direction and then approach a fixed radius and remain nearly unchanged at about r 0 4 d r the axial velocity in the y z plane of the two models is visualized in fig 10 c and it is clearly observed that the outflow of the r d model is obviously higher than the r model this fluid acceleration of the wake flow of the r d model is caused by the duct fig 11 show the instantaneous q surfaces of the r model and the r d model for the case j 0 8 fig 12 gives a comparison of the vortex system of the r model and the r d model as shown the vortex system of the r model is composed of the hub vortex the tip voices the trailing tip vortex and the trailing root vortices however for the r d model besides the similar vortices a unique duct induced vortex see fig 11 b is clearly observed for the r model the tip vortices shed from every rotor blade tip presenting themselves as a series of spiral filaments as shown in fig 11 a for j 0 8 these filaments maintain their spiral shape for a long distance downstream of the propeller until they gradually break down and disappear in the far field for the r d model both the duct induced vortex and tip vortices are in the shape of spiral filaments see fig 11 b in the near field region behind the propeller the duct induced vortex and the tip vortex are evenly distributed and appear alternately however with the downstream development of the fluid they begin to contact each other merge into some large vortices and finally breakdown in the far field region according to the research of widnall 1972 the mutual inductance instability mode of the tip vortex is the phenomenon that adjacent helical filaments begin affect each other here we call the interaction between the duct induced vortex and the tip vortex as tip duct mutual inductance instability model the difference of this model with the normal mutual inductance mode is that the instability of the tip filaments is no longer triggered by adjacent tip filaments but by the duct induced vortex this instability mode tends to connect the adjacent tip vortices to form a cylinder surface however the normal mutual inductance instability mode of the tip vortex tends to cause the adjacent tip vortex filaments to roll up around each other leading to the classic leapfrogging phenomenon felli et al 2011 besides the tip vortices the hub vortex of the r d model is also different from the r model see fig 12 for both models the hub vortex falls off from the tail of the hub and then takes the twisted form at near field behind the hub after that the twist disappears gradually and the hub vortex keeps stable until breakdown in the far field compared with the r model the twist of the hub vortex of the r d model disappears faster as for the reason it has been discussed in the qin et al 2021a that the twist of the hub vortex for the pjp is related to the existence of trailing root vortices here for the r d model the sustaining region of trailing root vortices is obviously smaller than that of the r model which means that the disturbing twist force of the tailing root vortices acting on the hub vortex is decreasing rapidly leading to the disappear of twist of the hub vortex for the r d model in order to quantitatively analyze the difference of tip vortices between the r model and the r d model the locations of the tip vortices cores the location of core is determined by the maximum q value point in the tip vortex cross section in the y z plane at j 0 8 are compared in fig 13 a in the comparison an instantaneous time at which the rotor blade of both models have the same phase angle is selected felli et al 2011 has proposed that the spiral to spiral distance of tip vortices is an important parameter for the tip vortex instability here the helical pitch of tip filaments p is defined as the axial distance between two adjacent helical filaments the helical pitch ratio of both models are compared in fig 13 b further more the definition of stable region of tip vortex needs to be discussed according to felli et al 2011 the instability inception point of tip vortices is defined as the first position at which the gradient of the tip vortex envelope equals 50 of the maximum slope the tip vortex envelope is got from the average of over 1000 snapshots of tip vortices using two high speed cameras here the average tip vortex envelope is like a straight line so it is hard to follow the same definition of felli et al as shown in fig 13 b it is found that after the wake contraction region about z d 0 0 8 p d values of two models are approaching to a stable value which is called as the steady pitch ratio here the instability inception point of tip vortex is defined as the first point except the wake contraction region at which the p d value began to move away from the stable value the instability inception point of the r model and the r d model is 1 9 and 1 5 respectively based on the location of the instability inception point of tip vortices the wake region of propeller is divided into the stable region and unstable region one thing should be mentioned here is that there will be a wake contraction region in the near field behind the propeller this region is also classified as a stable area in addition for the r d model the region z d 0 0 5 is defined as the duct region for the r model with the development of flow the radius of tip vortex decreases gradually from r d 0 5 to about r d 0 42 at z d 1 0 and then remains almost unchanged at about r d 0 42 z d 1 0 1 9 and then in the unstable region z d 1 9 2 6 the radius of the tip vortex fluctuates slightly due to the gradually breakdown of tip vortices for the r d model in the duct region z d 0 0 5 the radius of tip vortex has an abnormal increase at about z d 0 4 this is due to that the inner wall of the duct restricts the development of tip vortices more clear details of the effect of duct on the tip vortices can be seen in fig 14 and then in the stable region z d 0 5 1 5 the radius decreases gradually in the unstable region the radius of the tip vortex has a big fluctuation caused by the tip duct mutual inductance instability mode as shown in fig 13 b the steady pitch ratio of the r d model p d 0 165 is slightly bigger than that of the r model p d 0 15 as discussed by felli et al 2011 the more bigger p d is the less likely instability of tip vortices happens however for the r d model the unstable region moves further upstream compared with the r model this is caused by the unique tip duct mutual inductance instability mode generally speaking the existence of the duct exacerbates the instability of tip vortex of single rotor and a unique tip duct mutual inductance instability is found for the ducted propeller next the specific structure of the duct induced vortex and how it interferes with the tip vortex are discussed in fact the vortex induced by duct can be divided into two types vortex shedding from the outer surface of duct called as duct induced vortex 1 and shedding vortex on the inner surface of duct called as duct induced vortex 2 fig 14 gives the details of the duct induced vortex structure of the r d model for j 0 8 on the outer surface of the duct from about z d 0 0 4 obvious flow separation as shown in fig 14 b and vortex shedding see fig 14 d can be seen the vortices shedding from the outer surface of duct presents themselves as a series of circular rings from z d 0 4 the duct induced vortex 1 falling off from the trailing edge of duct shows a same shape with the tip vortices a series of spiral filaments until the tip duct mutual inductance instability happens see fig 11 b in addition some vortices are generated in the inner surface of duct called as duct induced vortex 2 those vortices attach to the inner surface of the duct see fig 15 b at the trailing edge of duct due to the low pressure region behind the duct see fig 14 c the duct induced vortex 2 begins shedding from the duct surface and some spiral filaments is generated fig 15 b shows the spatial development process of duct induced vortex 2 it can be seen that after falling off from the trailing edge duct induced vortex 2 is quickly attracted by tip vortex and a unique phenomenon merge of tip vortex and duct induced vortex is observed it can be inferred that the merge process will inevitably lead to the instability of tip vortex here for the case j 0 8 the tip vortex still keeps a stable spiral shape after merging with duct induced vortex 2 we speculate that it is because the strength of duct induced vortex 2 is relatively weak and the induced instability of tip vortex can be ignored at j 0 8 in general duct induced vortex 1 and duct induced vortex 2 together form the duct induced vortex it has direct effect on the instability of tip vortex of course the formation of these two vortices is also closely related to the shape of the duct reasonable adjustment of the shape of the duct especially the shape of trailing edge can affect the structure of the vortex shedding from the duct and further affect the stability of the tip vortex for example if the duct structure is properly designed to generate more duct induced vortices the tip vortices can become unstable and breakdown rapidly this can provide some new ideas for marine engineers there is a significant phenomenon for propeller the roll up process of the trailing edge vortices according to the research of kumar and mahesh 2017 the roll up process is the phenomenon that the upper part of the trailing vortex gradually bends with the flow developing downstream here the contours of the vorticity magnitude at different z positions for the r and the r d models are shown in fig 16 based on fig 16 a representation of the roll up process of both models are given in fig 17 in the roll up process the upper part of the trailing edge vortex has progressively increasing angular displacement and a radial rise quantitatively we define the angular displacements between a tip vortex and its corresponding trailing vortex as φ the different φ values at different z positions have been given in fig 16 and are listed in table 5 as shown for both models the φ becomes larger and larger with increasing z corresponding to the gradually roll up process of the trailing edge vortices in addition compared with the r model the φ of the r d model is obviously bigger at z d 0 15 for the r d model the φ is about 6 0 which means that the trailing vortex has a 6 0 phase lag of the corresponding tip vortex and touched the next tip vortex see fig 16 c as shown in fig 17 for the r model with the development of fluid downstream the top of the trailing edge vortex bends z d 0 1 0 2 and then the upper part of the trailing edge vortex approaches the next tip vortex z d 0 2 0 4 the interaction force between the upper part of the trailing edge vortex and the next tip vortex gradually increases this mutual interaction is not good for the stability of tip vortex however for the r d model the bending process of the top of the trailing edge vortex happens more faster after the upper part of the trailing edge vortex approaching and contacting with the next tip vortex φ 6 0 at z d 0 15 the upper part keeps bending and approaches the second tip vortex φ 10 0 z d 0 4 compared with the r model the complete development of the roll up process for the r d model happens more quickly as for the reason the spatial evolution of the tip vortex of the r d model is compared with the r model as shown in fig 18 the pressure coefficient contours of the r d model and the r model are compared in fig 18 a more clearly the contours of c p on the pressure side and suction side of the rotor for the r d model and the r model are given in fig 18 c and d respectively a high pressure region is observed at the upper part near the trailing edge of the pressure side of the rotor for the r d model see fig 18 c in addition the low pressure region caused by the tip vortex for the r d model is located at the center of the rotor tip while it is close to the trailing edge of the rotor for the r model the different distribution of these pressure regions is related to the different evolution of the tip vortices fig 18 b gives the instantaneous surfaces of vorticity magnitude of the two models as shown for the r d model due to the existence of the duct on the one hand a circular vortex is formed on the inner wall of the duct on the other hand the tip vortex falls off from the middle of the rotor tip and then quickly leaves the rotor blade and approaches the tip of the next rotor blade resulting in the appearance of high pressure region in the next rotor blade the unfolded drawing of the rotor blades at span 0 99 colored by the tke turbulence kinetic energy is shown in fig 18 e and the spatial evolution of the tip vortex is remarked by a dashed line the difference of the spatial evolution of the tip vortex for the two models can be clearly observed specifically the velocity of the inner wall of the duct is 0 while it of the rotor blade tip is pretty high the sum of the rotational speed and the incoming flow speed leading to a high speed difference between those two walls due to the viscous effect of the inner wall of the duct the tip vortex contacting with the inner wall of the duct cannot keep up the rotating speed of the rotor blade leading to the tip vortex getting farther and farther from the rotor blade as a result the distance between the tip vortex and the previous trailing edge vortex gradually decreases which means that the mutual interaction between them becomes stronger for the r d model compared with the r model in addition this stronger mutual interaction between them inevitably causes the deformation of the upper part of the trailing vortex which makes the trailing tip vortex contact the previous tip vortex more quickly and accelerates the complete development of the roll up process furthermore this difference of the spatial evolution of the tip vortex explains the reason that why the p d of the r d model at the duct region is significantly smaller than the r model see fig 13 although the decrease of p d caused by the duct has not affect on the stable of tip vortices the instability of the tip vortex for the r d model is more likely related to the tip duct mutual inductance instability it has a significant effect on the roll up process of the trailing edge vortex in general the existence of duct for the r d model 1 restricts the development of tip vortex and then decreases the pitch ratio p d of the tip vortex in the duct region 2 reduces the stability of tip vortex the existence of duct induced vortices leads to the happening of the tip duct mutual inductance instability and triggers tip vortex instability finally the vortices structure of the r d model and the r model for different values of j are discussed fig 19 shows the instantaneous q surface of the r d model and the r model for different values of j in fig 19 a the q 1000 s 2 is used and q 100 s 2 is used for the r d model due to the relative small vortex strength of the duct induced vortex see fig 19 b fig 19 c and d show the instantaneous q surfaces of half model to have an intuitive contrast of those two models the same value q 5000 s 2 is used according to the research of widnall 1972 there are mainly three instability modes of a tip vortex short wave instability long wave instability and mutual inductance instability here for the ducted propeller a new tip duct mutual inductance instability mode appears as discussed before in addition the evolution of the tip vortices exhibits different instability modes for different values of j the definition of the instability inception point of tip vortices has been discussed before the positions of instability inception point for different values of j have been marked with dashed lines see fig 19 a and b according to the instability inception point of tip vortex the wake of the r d model is divided into two parts stable region and unstable region for both model at low j cases j 0 2 and 0 4 the instability mode of tip vortices are mainly dominated by the mutual inductance instability mode according to widnall 1972 the mutual inductance instability mode is the mode that adjacent helical tip filaments begin to interact strongly as shown both stable regions of tip vortex of the r model and the r d model at the case j 0 2 are very short adjacent tip filaments contact each other in the unstable region at j 0 2 for the r model adjacent tip filaments show a more complex mutual inductance process every two tip filaments merges to a bigger tip vortex at first and then gradually splits into two vortices again at unstable region however for the r d model the intensity of this mutual inductance instability mode is weaker after the stable region every two tip vortices gradually merges to a bigger tip vortex and then those big tip vortices interfere with each other and gradually breakdown in the far field similarly in the case j 0 4 the contact between adjacent tip vortices can also be clearly observed at medium and high j cases j 0 6 to 1 0 for the r d model the mutual inductance instability mode of tip vortices gradually disappear replacing by the tip duct mutual inductance instability mode as for the reason this tip duct mutual inductance instability mode is closely related to the duct induced vortex as shown in fig 19 b the strength of the duct induced vortex is relatively weak due to the small incoming flow velocity at j 0 2 and 0 4 with the increase of j the strength of the duct induced vortex increases gradually hence the appearance and the strength of the duct induced vortex show clearly dependence on the j more specifically on the incoming velocity u the greater the strength of the duct induced vortex is the stronger the interaction between the duct induced vortex and tip vortices is and then the more likely the tip duct mutual inductance instability mode happens for the r model with the increasing of j the instability inception point moves further downstream with the gradually disappear of the mutual inductance instability mode of tip vortices in general the instability inception point of tip vortices for both models is dependent at the working condition j to quantitatively study the relationship between the j and the tip vortex instability the helical pitch ratio of tip filaments p d is shown in fig 20 a the instability inception point for different values of j for the r model and the r d model is compared in fig 20 b one thing should be mentioned here is that the optimal operating point for the r model j 0 8 and the r d model j 1 0 is different see fig 4 a for the r model the p d at z d 0 6 increases monotonically with increasing j before the optimal operating point and then slightly decreases with the increase of j when j is bigger than the optimal operating point similarly the instability inception point increase firstly and then gradually decrease when j 0 8 hence the transition to instability of the tip vortex shows a clear dependence on the spiral to spiral distance or called as the pitch ratio of tip filaments p d more specifically the larger the value of p d the weaker is the interaction between adjacent tip filaments the less likely is the mutual inductance instability mode to occur and the longer is the stable length of tip vortices this conclusion is consistent with the research of felli et al 2011 and okulov 2004 however for the r d model the change trend is obviously different the p d of the r d model increases linearly with increasing j while the instability inception point of tip vortex has an obvious decrease when j 1 0 this change trend seems contradict the above conclusion here this difference is caused by the unique tip duct mutual inductance instability mode for the r d model as discussed before the strength of duct induced vortex gradually increase and the tip duct mutual inductance instability mode happens in high j cases in general the transition to instability of the tip vortex for the r d model shows a dependence on both the spiral to spiral distance and the strength of duct induced vortex 4 3 effect of the pre swirl stator on the vortex structure of the rotor in this part the flow field and the vortex structure of the pjp model are compared with the r d model to study the effect of the pre swirl stator on the structure and evolution of tip vortices fig 21 compares the instantaneous q surfaces of the pjp model with the r d model for the case j 0 8 as shown in fig 21 a the vortex system of the pjp is similar to that of the r d model which consists of the tip vortices a hub vortex the duct induced vortex rotor trailing vortices in addition a sheet of vortex sheds from the stator trailing edge called the stator trailing vortices can be found in the stator region as shown in fig 21 b the tip vortices of the pjp the upper part is no longer the spiral filaments after shedding from the trailing edge of the duct but shows as a smooth sinuous wave type mode small sinusoidal displacements of every filaments can be observed and this mode is called as the short wave instability mode of the tip vortex according to saffman 1970 for the r d model the tip filaments maintain their spiral shape for a long distance downstream of the propeller while there is no absolute stable region of tip vortices for the pjp model in addition the short wave instability mode is not just happening after shedding from the trailing edge of duct but appears when it sheds from the tip of rotor see fig 25 b so it is reasonable to guess that this short wave instability mode of the tip vortex is not caused by the duct induced vortex but by the stator as for the reason it can be found in fig 8 it has been discussed before that the existence of eight front stator blades has a rectification effect on the incoming flow of rotor changing it from a uniform distribution to a periodic distribution with eight channels the total incoming velocity of a rotor blade is v t o t a l v a 2 π n d r 2 for the pjp when the rotor rotating the axial velocity of the incoming flow v a is not a fixed value but a periodic value leading to the periodic fluctuation of v t o t a l hence the angle of attack for rotor blades will also fluctuates periodically and eventually causing the periodic unstable shedding of tip vortices this is the reason that why the sinusoidal wave short wave instability mode of tip vortex happens for the pjp model the instantaneous flow field in the y z plane of the pjp model is compared with that of the r d model for j 0 8 in fig 22 as shown in fig 22 a for the r d model the tip vortices gradually shrink inward in the radial direction at z d 0 5 1 while for pjp model the low pressure region representing the tip vortex has an irregular increase or decrease in the radial direction after shedding from the duct which corresponds to the short wave instability of the tip vortex at z d 0 5 1 here the radius of the tip vortices core in the y z plane of the two models are compared in fig 23 a in the duct region it is shown that the radius of the tip vortices of both modes are the same which leading to a similar helical pitch ratio of the tip vortices in the duct region fig 23 b in addition following the definition of stable region for the r d model the region bigger than z d 0 5 is defined as the unstable region due to there is no stable region for the pjp model then the unstable region is divided into two part the short wave region and the mutual inductance instability region according the corresponding instability mode of the tip vortices it is shown that the helical pitch ratio of the tip vortices for the pjp model at about z d 1 0 has a obvious increase caused by the tip duct mutual inductance instability this sharp increase is similar with the r d model while it happens further upstream compared with the r d model see fig 23 b this difference can also be observed clearly from fig 22 c and d in addition the axial velocity of the two models are compared in fig 22 b results show that compared with the r d model the jet acceleration effect of the pjp model is more obvious the axial velocity of pjp wake is much larger than that of r d model this is also the reason that why the thrust coefficient of the rotor of pjp is bigger than the r d model see fig 4 the spatial evolution of the roll up process of the rotor trailing vortex in the radial direction is shown in fig 24 as shown the angular displacement between a tip vortex and its corresponding trailing vortex φ at different z positions for the pjp model is basically the same as the r d model following the definition before both models has a 6 0 angular displacements at z d 0 15 which means the complete development of the roll up process of both models happens simultaneously hence the pre swirl stator blades has nearly no effect on the roll up process of the rotor trailing vortex fig 25 shows the instantaneous q surface of the pjp model for different values of j it can be seen that the length of short wave region gradually increases with increasing j as shown the evolution of the tip vortices exhibits different instability modes for different values of j the transition from the mutual inductance instability between tip vortices to the tip duct mutual inductance instability mode for the pjp model is similar with that of the r d model this transition is caused by the duct induce vortex the specific process has been discussed in the previous section compared with the r d model at low j cases j 0 2 and 0 4 the unstable interference forces between adjacent tip filaments caused by the short wave instability make the mutual inductance instability mode happens faster at medium and high j cases j 0 6 to 1 2 the mutual inductance instability mode of tip vortices for the pjp model also happens faster due to the premature breakdown of the duct induced vortex in a word compared with the r d model the stability of tip vortex of the pjp model is reduced in general the evolution of the tip vortices of the pjp is similar with the r d model except the disappear of stable region of tip vortices caused by the short wave instability 4 4 vortex dynamics to study the dynamical behavior of the tip vortices for the three models 8 probes are created to study the change of turbulence kinetic energy tke probes p1 p8 at r d 0 45 as shown in fig 26 the time histories of tke at p1 p8 for different model at j 0 8 is shown in fig 27 the dynamical behavior of the tip vortices for the three models are compared for the r model and the r d model the tke at p1 p3 is a standard sinusoidal periodic signal which means that the tip vortices maintains stable in this region and then from p4 the tke signal begins to lose its purely periodic characteristic and exhibits nonperiodicity and randomicity for the r model the nonperiodicity is relatively small while for the r d model there are violent fluctuations of tke value this is caused by the tip duct multi inductance instability has been discussed before for the pjp model at p1 p3 small nonperiodicity fluctuation of tke signal happens it is caused by the short wave instability of the tip vortices this is consistent with the evolution of tip vortex discussed earlier the change trend of tke at p4 p6 is similar with that of the r d model due to the same tip duct mutual inductance instability at p6 p8 for all the three models the tke approaches a fixed value with small fluctuation which means the gradually breakdown of tip vortices at far field region it should be noted that the period of signal from p1 p8 also changes obviously this is related to the energy transfer process from blade harmonics to shaft harmonics will be discussed below in addition the average value and the amplitude of fluctuation of tke at p1 p8 of the r d model are all bigger than that of the r model hence though the stable region of tip vortex of the r d model is basically the same as the r model it looks like that the turbulence intensity at tip vortex region is enhanced by the duct based on the evolution of tip vortex discussed before we speculate that it is caused by the duct induced vortex similarly the average value and the amplitude of fluctuation of tke of the pjp model is also bigger than the r d model hence the existence of pre swirl stator blades increases the turbulent fluctuation compared with the r d model the time histories of tke at p1 p8 for different model at j 0 2 is shown in fig 28 at p1 the time history of tke shows a standard sinusoidal signal for the r d model however the time history of the r model is no longer a periodic signal this is also consist with the evolution of the tip vortices of the r model see fig 19 j 0 2 for the r d model the duct restricts the instability of the tip vortices at j 0 2 for the pjp model at p1 due to the short wave instability caused by the pre swirl stator blade the tke of the pjp model has a small fluctuation compared with the r d model furthermore the frequency analysis of tke is carried out as shown in figs 29 and 30 at the case j 0 8 for the r model and the r d model the power spectral density psd of the tke at probes p1 p3 has obvious peaks at f bpf the rotor blade passing frequency and its harmonics and then at p4 p6 the components of f bpf has an obvious decrease and is replaced with several peaks at 2 f n see fig 29 a and 3 f n see fig 29 b this is called as energy transfer process from blade harmonics to shaft harmonics et al felli et al 2011 in the far field region p7 p8 all the peaks gradually disappear which corresponded to the breakdown process of the tip vortices for the pjp model the psd of the tke shows a significant difference at p1 p3 besides the peaks at f bpf obvious peaks at 1 f s 2 f s 3 f s and so on f s is the stator blade passing frequency and is 160 hz here appear those peaks are consists with the peak of 160 hz and 320 hz as shown in fig 8 which is caused by the rotor stator interference which has been discussed before this unique stator blade passing frequency f s has been discussed in the qin et al 2021b at j 0 2 for the r and pjp model peaks at n f b p f of tke at p1 p3 are not so obvious while for the r d model the peaks at n f b p f of tke can still be observed see fig 30 b for the r and pjp model at j 0 2 the tip vortex is dominated by the mutual inductance instability mode however the tip vortices maintain its spiral shape for a longer distance for the r d model hence the change of vortex dynamics is closely related to the spatial evolution of tip vortices in addition for all the three models similar energy transfer process from blade harmonics to shaft harmonics can be observed for all j cases as shown in figs 29 and 30 the amplitude of the psd at n f bpf decreases gradually with increasing z d replaced by shaft harmonics at p4 p6 obvious peaks at 2 f n 3 f n 4 f n can be observed in general the vortex dynamics of the three model is different and the characteristic frequency of tke of the tip vortex region for the three models depend on j and is closely related to the spatial evolution of tip vortices 5 conclusions in this paper iddes simulations have been carried out to study the wake dynamics of a pre swirl pumpjet propulsor pjp to separate the roles played by the rotor the stator and the duct in determining the flow of a pjp three models have been established the r model rotor only the r d model rotor within a duct and the pjp model rotor and stator within a duct the three models are compared from three aspects the open water performance the instantaneous wake vortex structure and the vortex dynamics the numerical results reveal the following 1 in terms of hydrodynamic performance the open water efficiency of pjp is better than the r model and r d model especially in the high j cases in addition due to the existence of pre swirl stator pjp shows strong rotor stator interference force which may bring undesirable fluid excited vibration and noise 2 for the r d model the structure of the duct induced vortex is reported the duct induced vortex consists of two parts the vortices that sheds from the outer surface of duct and the vortices sheds from the inner surface of duct the former one leads to the occurrence of tip duct mutual inductance instability mode which is the phenomenon that the duct induced vortex begins to affect adjacent tip vortices for the second part of the duct induced vortex a novel evolution process is found which is called merge of tip vortex and duct induced vortex in the present work more specifically after falling from the trailing edge of the duct the vortices generated from the inner surface of the duct will be quickly attracted and merged by the adjacent tip vortices 3 for the r d and pjp model the transition from stability to instability of the tip vortex shows a dependence on both the spiral to spiral distance and the strength of duct induced vortex 4 for the pjp model with the existence of pre swirl stator blades the angle of attack of the rotor airfoil will experience a small periodic fluctuation leading to the small sinusoidal wave of tip spiral filaments which is called as the short wave instability mode of tip vortices credit authorship contribution statement denghui qin numerical simulation results discussion manuscript writing revise manuscript qiaogao huang propose idea supervision revise manuscript guang pan project funding sources supervision yao shi assist to complete the numerical simulation peng han assist to complete the result analysis xinguo dong the experiment of model and validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china under project no 51979226 and no 51879220 fundamental research funds for the central universities china under project no 3102019hhzy030019 and national key research development plan of china under project no 2016yfc0301300 
20330,a numerical study based on improved delayed detached eddy simulation is conducted to investigate the flow of a pre swirl pumpjet propulsor pjp the pjp consists of a stator a rotor and a duct in order to separate the roles played by the rotor stator and duct in determining the flow of pjp three models are established the r model rotor only the r d model rotor within a duct and the pjp model rotor and stator within a duct results show that the effect of the duct on the unsteady force acting on the rotor blades is weak while the pre swirl stator on it is strong due to the rotor stator interference in addition the vortex structure of the three models are compared the tip duct mutual inductance instability mode that the duct induced vortex begins to affect adjacent tip vortices is reported for the pjp model a unique short wave instability mode of the tip vortex caused by the existences of pre swirl stator is discussed more importantly for the r d and pjp model the transition from stability to instability of the tip vortex depends on both the spiral to spiral distance and the strength of duct induced vortex keywords pumpjet propulsor improved delayed detached eddy simulations the pre swirl stator the tip vortex instability mode 1 introduction in recent years more and more attention has been paid to research on the vortex dynamics of marine propellers such as the single propeller the ducted propeller and the pumpjet propulsor pjp among them the ducted propeller is more and more widely used in vessels and underwater vehicles due to its capacity of generated high thrust under heavy loads in addition the pjp consists of a stator a rotor and a duct nouri et al 2013 is a new type of propeller which is widely used for torpedoes and submarines due to its superior hydrodynamic cavitation and noise performance qin et al 0000 plenty of work have been done on the wake dynamics of single propellers both theoretical joukowsky 1918 levy and forsdyke 1928 widnall 1972 gupta and loewy 1974 okulov 2004 pozrikidis and higdon 1987 tophøj and aref 2013 hattori and fukumoto 2009 hattori and hijiya 2010 meunier and leweke 2001 le dizes 2000 sipp et al 1999 vermeer et al 2003 and experimental felli et al 2006 2008a 2011 di felice et al 2009 felli et al 2008b based on the theoretical research the wake vortex of a single propeller consists of the tip vortices a hub vortex and a sheet of vortices shedding from the trailing edge of rotor blades the trailing vortices felli et al 2011 felli and co workers got several important conclusions of the triggering mechanism of the rotor wake instability in experiments on an e779 a model propeller in the italian navy cavitation tunnel it was found that the instability transition of the tip vortices depends on the inter spiral distance of tip spiral filaments the spatial evolution of the tip vortices occurs through a multi step grouping mechanism which is caused by the mutual inductance instability mode between adjacent spiral filaments felli et al 2011 as for the research of the wake dynamics of the ducted propeller few works have been done in this region oweis and ceccio 2005 measured the flow field of a ducted marine propeller by particle image velocimetry piv technique based on the results a primary tip leakage vortex is observed in addition a secondary co rotating trailing edge vortex and some co rotating or counter rotating vorticity are found in the blade wake the merge process of the primary vortex with weaker secondary and wake vortices are discussed lababidy et al 2005 carried out an experiment of a ducted marine propulsor under high load conditions at the italian ship model basin insean and the wake flow at the different downstream location was measured by piv it is found that the blade wake will almost disappear within one diameter downstream the maximum vorticity region is found at the blade tip and hub of propeller with an obvious trailing vorticity region shedding from the trailing edge in addition the wake vorticity of the ducted propeller decreases with increasing advance coefficient cozijn and co workers carried out a lot of experiments of ducted propellers operating under open water cozijn et al 2010 behind a barge cozijn and hallmann 2012 and behind a drillship cozijn and hallmann 2013 the measurement results show that the wake flow of ducted propeller is deformed by the plate and the barge there is a low pressure region at the side of the barge causing the wake flow to diverge up as it flows from under the barge into the open water in addition the interaction of thruster and the drillship is studied by detailed piv measurements those researches are mainly focused on the velocity field but less on the discussion of vortex structure in the wake field of ducted propeller felli et al 2008b carried out an experiment of a flat plate which was located right behind a four bladed ducted propeller in a large cavitation channel of insean italian institute for naval architecture studies and testing measurements of flow fields were carried out using high speed cameras and piv the structure of tip vortices undergoes a deformation from a cylindrical envelope surface to a typical shape of the type b jet this work did not study the specific vortices structure of ducted propeller but focused on the jet wall interaction with different impingement distances along with the experimental studies the application of computational fluid dynamics cfd for the wake dynamics analysis of the ducted propeller has also been considered gong et al 2018 compared the structure and the evolution of the wake vortices of a ducted propeller with a non ducted propeller delayed detached eddy simulation ddes simulations were carried out the duct had a significant effect on the morphology of the non ducted propeller the deformation of the tip vortex happened and was caused by the blade duct interaction and the multi inductance between adjacent tip vortices together the merging of the shear layer vortices shedding from the duct trailing edge and the tip vortices generated new secondary coherent structures in the near field region zhang and jaiman 2019 investigated the wake dynamics of a four bladed ducted propeller at a reynolds number of 1 765 1 0 5 using ddes and the sliding mesh model the phenomenon of leapfrogging the secondary vortex and the short wave instability of tip vortices were illustrated it was found that the length of the tip vortex moves further downstream with increasing advance coefficient while the sustainable region of the trailing edge vortices nearly remains unchanged the complex interaction between the two vortices was discussed as for the research of the wake dynamics of pjp most works focus on the study of hydrodynamic performance suryanarayana et al carried out the experimental of a pjp equipped at an axisymmetric body in a wind tunnel in addition suryanarayana et al did more experiments for the axisymmetric body fitted with pjp in the cavitation tunnel at naval science and technological laboratory nstl the propulsor characteristics the self propulsor point of the model the rotor and stator torques and tunnel blockage effects were discussed suryanarayana et al 0000a b c in addition to experimental researches numerical studies were carried out to predict the hydrodynamic performance of pjp by cfd lu et al 0000b a qin et al 0000 shirazi et al 2019 wang et al 2019 lu et al 0000b carried out the numerical simulation of a pumpjet propulsor with 11 rotor blades and 9 stator blades the reynolds averaged navier stokes rans equation combined with the shear stress transport sst k ω turbulence model was adopted the hydrodynamic coefficient and efficiency of pjp were discussed qin et al 0000 investigated the hydrodynamic performance of pjp with different tip clearances by cfd results show that the open water efficiency of pjp decreases with increasing tip clearance which is caused by the gradually enhanced tip vortices however relatively few studies focus on the wake dynamics of pjp qin et al 2019 compared the vortex structures of a pjp with a normal duct and a sawtooth duct the sawtooth duct was proposed and applied for the first time to pjp to reduce the noise of pjp it was shown that the vortex of pjp consists of the impact separation vortices a hub vortex and the duct induced vortices in addition different hybrid rans les approaches ddes iddes improved delayed detached eddy simulation model sdes shielded detached eddy simulation and sbes stress blended eddy simulation are used to investigate the wake flow of a pre swirl stator pjp li et al 2020 the shear layer of the duct was induced by the tip vortices the second vortices were formed and were merged with the adjacent tip vortices it was shown that the iddes sdes and sbes show better resolving ability in vortices compared with the ddes the open water performance of pjp with different duct parameters was carried out by huang et al 2021 by cfd the effect of duct parameter on the flow of pjp was discussed while few discussion was focused on the vortex structure due to that the sst k ω model was used and it was hard to capture the evolution of the tip vortices in the wake region of pjp using this turbulence model in general in spite of a number of studies of wake dynamics of the ducted propeller and pjp have been done the triggering mechanism of the tip vortex instability the reconstruction of the complex vortex structure for the pjp are still not yet explained thoroughly in the literature here a numerical study is carried out to investigate the wake dynamics of a pre swirl pumpjet propulsor three models the rotor the rotor duct and the pjp model are established to separate the roles played by the rotor the stator and the duct in the vortex evolution of a pjp the hydrodynamic performance the vortex structure and the vortex dynamics of those three models are discussed in the present paper the aim of this paper is to make a deeper understanding of the difference in the vortex structure between three classical propellers the single propeller the ducted propeller and the pjp the layout of this paper is as follows in section 2 the numerical methodology is given in section 3 the numerical set up such as the geometry and the boundary conditions are described section 4 gives the flow results and discussion from four main aspects the open water coefficient and unsteady blade excitation force section 4 1 the effect of the duct on the vortex structure of the rotor section 4 2 the effect of the pre swirl stator on the vortex structure of the rotor section 4 3 and vortex dynamics section 4 4 finally the conclusions are discussed in section 5 2 numerical methodology here for the pumpjet propulsor the numerical simulation of the incompressible viscous flow field is performed the navier stokes equations can be written in non dimensional form in the inertial frame of reference in terms of absolute velocity components as follows 1 u i x i 0 2 u i t x j u j u i p x i τ i j x j 0 i 1 2 3 where u i are the components of the fluid absolute velocity p is the fluid pressure t is the time τ i j ν t u i x j u j x i is the stress tensor and ν t 1 r e ν t with ν t being the turbulent viscosity in all the simulations shown in the paper the improved delayed detached eddy simulation iddes model gritskevich et al 2012 was employed in order to resolve in detail the vortex structures of the pumpjet propulsor for the sake of completeness the equations of iddes model are summarized the iddes model is based on a modification of the sink term in the k equation of the shear stress transport sst model ρ k t ρ u k μ μ t σ k 3 k p k ρ β k ω f iddes ρ ω t ρ u ω μ μ t σ k 3 ω 1 f 1 2 ρ k ω σ ω 2 ω α 3 ω k p k β 3 ρ ω 2 3 f iddes l rans l iddes where the turbulence length scale is the parameter that defines this rans model is the turbulence length scale l rans k β ω more details can be found in gritskevich et al 2012 the reason of choosing this turbulences model has been discussed in a research before li et al 2020 3 numerical setup 3 1 geometry fig 1 a b c give three models studied in this paper and fig 1 d is the photo of the experimental model in this paper a pre swirl pumpjet propulsor is designed for a large underwater robot a 1 20 scale model scale of numerical model full scale model 1 20 is used for numerical work as shown in fig 1 c a hydrodynamic experiment on this pjp model was carried out in the water tunnel of the science and technology on water jet propulsion laboratory marine design and research institute of china see fig 1 d the details of the experimental data can be found in li et al 2020 this pjp is composed of a duct whose maximum diameter is d d 0 22 m the rotor six bladed rotor n r 6 and the stator eight bladed stator n s 8 table 1 gives the geometrical details of the rotor and stator blades among them the pitch ratio the maximum thickness ratio and the chord length ratio use the corresponding value at r 0 7 r r is the maximum radius of blade in addition more details of this model can be found in qin et al 2021a in order to study the effect of the duct and the pre swirl stator on the vortex structure of the rotor two models are generated based on the pjp model the r model fig 1 a and the r d model fig 1 b the r model which only consists of six rotor blades can be considered as a normal single propeller the r d model is composed of the same rotor and the duct by comparing the r d model with the r model the influence of duct on the vortex evolution of a normal single propeller can be studied similarly by comparing the flow of pjp model with the r d model the influence of the pre swirl stator on the flow of the ducted propeller can be investigated for those three models the coordinate systems are all the same see fig 1 a coordinate system whose origin is located at the center of the rotor is established the incoming flow direction is set as the positive direction of z axis the perpendicular upward direction is the positive direction of x axis and the y axis can be determined by the right hand rule the maximum diameter of the rotor blades is d r 0 1664 m which will be used as the characteristic diameter of the three models to calculate hydrodynamic coefficients 3 2 computational domains and meshes as shown in fig 2 the sizes and partition methods of the computational domains for the three models are basically the same in order to minimize the effects of numerical errors arising during mesh generation specifically the computational domain is a cylinder of diameter 10 d d and length 20 d d the whole computational domain is divided into several subdomains the rotor domain the near field domain the far field domain and the stator domain for the pjp model the size of the near field domain remains the same with a cylinder of diameter 1 5 d and length 5 d that is chosen according to the results of previous research qin et al 2021b here for the r d model and the pjp model the reynolds number is defined as re ρ c 1 0 r π n d r 2 v 2 μ where c 1 0 r is the chord length of the rotor blade at 1 0r and n is the rotational speed r s 20 r s in this simulation the re of the three models has a maximum value with about 8 5 1 0 5 structured grids are generated the details of which are shown in figs 3 and 4 the topological structures of the three grids are basically the same the surface mesh of the three models can be seen from fig 3 a fig 3 b gives the meshes in the middle section y z plane for the three models it can be clearly observed that the wake region of propeller is refined to capture the evolution of wake vortices of the propeller more mesh details of the three models can be seen in zoomed in view in fig 3 b fig 3 c and d show the mesh in the middle section of the stator domain and the rotor domain respectively it should be mentioned that the grid of the rotor and stator domain is obtained by rotating and copying the structural grid of single blade passage in addition as shown in fig 3 e the 1 mm gap between the rotor tip and duct of the r d and pjp model is divided into about 31 layers to accurately capture the generation of the tip vortex for these three grids the mean y value of the propeller surfaces is about 5 and the growth rate is 1 1 the determination of y value had already been studied in prior research qin et al 2021b the grid information for the three models can be found in table 2 the total mesh number of the r model is 9 35 1 0 6 while the total mesh number is 8 37 1 0 6 for the r d model and 12 53 1 0 6 for the pjp model respectively here iddes simulations for those three models are carried out the boundary condition setting is shown in fig 2 the rotor domain is set as a rotating domain with 1200 revolutions per minute rpm rotation speed the inlet surface is set as the velocity inlet and the incoming flow speed varies according to different j the outlet surface is set with an constant pressure of 0 pa the nodes of the rotor domain move rigidly for this case is a simple rotation motion and rotor domain is connected with the other cell zones through non conformal interfaces the turbulence intensity in the simulation is 5 furthermore the simplec algorithm is used the pressure is discretized by the second order scheme and the turbulence kinetic energy and specific dissipation rate are using the second order upwind scheme in addition the bounded second order implicit time discretization scheme is used in the iddes simulation the time step size is determined by using the courant friedrichs lewy cfl number the flow of pjp is solved by ansys fluent version 16 ansys inc 3 3 validation to validate the cfd simulation results the numerical results of the pjp are compared with the experimental data in the experiment the water tunnel has a speed range of 0 15 m s and the test conditions for this pjp were values of the advance coefficient j in the range 0 2 1 2 with a fixed rotational speed of 1200 rev min in the simulation ρ is the fluid density n is the rotational speed of rotor n 20 r s here d r is the mean diameter of the rotor blades d r 0 1664 m v is the far field incoming flow velocity t r and t d are the thrust generated by the rotor and the stator duct respectively t d 0 for the r model q r and q d is the torque of the rotor and the stator duct respectively to discuss the hydrodynamic performances of propellers some non dimensional physical quantities are defined the thrust coefficient and the torque coefficient of the rotor is k t r t r ρ n 2 d r 4 and k q r q r ρ n 2 d r 5 respectively t r and q r is the thrust and the torque of the rotor respectively similarly the thrust coefficient and the torque coefficient of the stator and duct is k t d t d ρ n 2 d r 4 and k q d q d ρ n 2 d r 5 respectively the total thrust coefficient is defined as k t k t r k t d and the torque coefficient of pjp used to calculate efficiency is defined as k q k q r following the definition of qin et al 0000 lu et al 0000b a the openwater efficiency of the pjp is defined as η j 2 π k t k q the numerical simulation results of the pjp model are compared with the experimental results in fig 5 for each case 45 rotation cycles are calculated and the average value of the last 30 cycles is taken as the final hydrodynamic performance prediction as can be seen from fig 5 the results are in good agreement with the experimental values the maximum relative errors δ k t and δ k q are only 4 48 and 1 80 respectively for j 0 2 δ k t is k t n u m k t e x p k t e x p considering the machining error of the actual experimental model these numerical errors are acceptable in a word the hydrodynamic performance coefficient predicted by the iddes simulation is accurate compared with the experiment data next the grid independence test are carried out and three different grids are generated a coarse grid a medium grid and a fine grid details of those grids have been given in fig 4 for the three grids the height of the first boundary layer mesh is kept unchanged only with a refinement of nodes the number of nodes distributed around the airfoil of the rotor for the coarse grid is 81 and those of the medium and fine grids are 121 and 181 respectively hence the total number of coarse grid and the medium grid is 8 38 1 0 6 and 12 53 1 0 6 respectively while that of the fine grid is 24 59 1 0 6 more detail of the number of each sub domain can be found in table 2 based on the theory of celik et al 2008 the grid convergence index gci of the hydrodynamic coefficients for the pjp model is calculated here the n1 n2 n3 are the total number of mesh for the fine medium and coarse grid respectively similarly ϕ k denotes the solution on the k th grid here the k t r and k q r are selected to study the uncertainty the calculation process of gci is as follows 4 p 1 in r 21 in ɛ 32 ɛ 21 q p 5 q p in r 21 p s r 32 p s 6 s 1 sgn ɛ 32 ɛ 21 7 ɛ 32 ϕ 3 ϕ 2 ɛ 21 ϕ 2 ϕ 1 for the three dimensional calculation 8 r 21 n 1 n 2 1 3 r 32 n 2 n 3 1 3 the approximate relative error is 9 e a 21 ϕ 1 ϕ 2 ϕ 1 in the fine grid convergence index 10 gci fine 21 1 25 e a 21 r 21 p 1 similarly the gci in the medium grid solution gci medium 32 can be calculated more details can be found in celik et al 2008 the iddes simulations of the three grids at j 0 4 and 1 0 are carried out and the results are shown in table 3 the numerical uncertainties in the medium grid solution gci medium 32 for k t r and k q r have maximum values of about 0 96 in addition three different time steps δ t 2 t t and 0 5 t are chosen where t is the time taken for the rotor blades to rotate 1 and is t 1 39 e 4 s for the working condition with a rotational speed n 1200 rev min to carry out the time step independence verification based on the results table 4 both k t r and k q r increase gradually and approach the experimental values as the time step decreases thus both grid and time step independence are satisfactorily verified more details of verification process can be found in one of our research before qin et al 2021b 4 flow results and discussion 4 1 open water coefficient and unsteady blade excitation force the iddes simulations for the r model the r d model and the pjp model are carried out fig 6 a shows a comparison of the open water efficiency of the three models the r model which is equivalent to an ordinary single propeller reaches its maximum point of about 60 24 for j 0 8 however the maximum efficiency of the r d model shows a significant decrease from 60 24 of the r model to 52 27 for j 0 7 the duct changes the velocity of the incoming flow of the rotor but inevitably brings additional resistance especially in the case of high j finally for the pjp model the presence of the pre swirl stator clearly improves the open water efficiency under most working conditions j 0 6 1 4 compared with the r d model the maximum efficiency of the pjp model is about 58 22 for j 1 0 which is close to that of the r model 60 24 in addition after exceeding the optimal efficiency point the efficiency decreases sharply for the r and r d models while the efficiency of the pjp model is effectively improved at high j with a small decline in slope thus the pjp model has better hydrodynamic performance compared with a normal single propeller and a ducted propeller as shown in fig 6 b for all three models the total thrust coefficient k t decreases linearly with increasing j for the r model k q r also decreases nearly linearly with increasing j whereas for the r d and pjp models it decreases with an increasing slope fig 6 c shows the behavior of k t k t r and k t d for the r d and the pjp model k t d 0 for the r model as can be seen the behavior of k t is similar for both models for the pjp model compared with the r d model the significant increase k t is obviously due to the increase in k t r about 0 2 for all calculated cases of j with only a slight decrease in k t d about 0 05 for all calculated cases of j hence the presence of a stator improves the working condition of the rotor very well with very small additional resistance which is also why the efficiency of the pjp is higher than that of the r d model for most values of j fig 7 a b and c show the time histories of the unsteady load force normalized as k t r of each rotor blade at j 1 0 the optimal operating point of the pjp model for the r model the r d model and the pjp model respectively for clarity only the unsteady force of rotor blade 1 the number of blade is numbered clockwise is shown in the left of fig 7 furthermore the unsteady load forces of six rotor blades at t 1 5 1 51s were compared in the right of fig 7 the unsteady force of rotor blade for the r model shows similar change trend with that of the r d model while that of the pjp has an obvious difference compared with the r model and the r d model standard sinusoidal periodic variation characteristics are observed for the unsteady force of each rotor blade for the pjp model furthermore fft fast fourier transform results of the unsteady load force of rotor blade 1 for those three models at j 0 6 and 1 0 are compared in fig 8 for the r model and the r d model at both working conditions the amplitude frequency spectrums show an overall broadband characteristic with several obscure peaks at 60 hz 80 hz 160 hz and 240 hz which corresponds to 3 f n 4 f n 8 f n and 12 f n respectively f n n 60 is the shaft rotation frequency and n is 1200 rpm for both j it shows that the characteristic frequency of the unsteady load force acting on each rotor blade for the r and r d model is the harmonics of shaft frequency in addition we can see that the frequency characteristics of the k t r of blade 1 for the r d model have nearly no change compared with that of the r model which shows that the duct almost has no effect on the unsteady force of the rotor however for the pjp model the frequency spectrum of k t r shows obviously peaks at 160 hz 320 hz 480 hz 640 hz and et al which corresponds to n f s f s f n n s 20 8 160 hz is the stator blade passing frequency therefore the characteristic frequency of the unsteady load force acting on each rotor blade for the pjp is the stator blade passing frequency and its harmonics the reason can be found in fig 9 at which contours of the axial velocity component at the same z slices of those three models are compared three slices are created which are located at the inlet surface a the surface before the rotor b and the outlet surface c respectively at slice a for the r model and the r d model the incoming flow is similar to the far field flow with a basically circumferential uniform incoming flow while eight periodic low velocity regions before the stator blades are found for pjp at slice b as shown the axial velocity of flow for the r and r d model keep the uniform distribution unchanged only with an increasing of the axial velocity due to the suction effect of the rotor in addition the incoming velocity of pjp shows periodic distributions with eight channels caused by the rectification of eight front stator blades so it is easy to understand the occurrence of the frequency of n f s with each rotor blade passing through these eight channels in turn at slice c as shown the outflow of the r and r d model shows as uniform six flow acceleration channels caused by the rotation of rotor while for the pjp the outflow shows as a basically uniform flow because the pre rotation component brought by the front stator is canceled by the rotation of the rotor for the pjp the rotation velocity component of outflow is very small which means the pjp can recover the rotational energy in the wake very well this is one significant advantage of pjp for the hydrodynamic performance compared with the single propeller or ducted propeller we call the violent interaction between the rotor and stator as the rotor stator interference force for the pjp the rotor stator interference force will have a significant effect on the unsteady load force acting on each rotor blade in addition it can be inferred that the hydrodynamic noise of pjp will be larger than that of the r and the r d model due to the violent rotor stator interference force this phenomenon is contrary to our general cognition that the pumpjet propulsor is more quiet than the single propeller of course we do not consider the sound shielding effect of the duct here the difference of underwater radiated noise among the single propeller the ducted propeller and the pjp is worth further study 4 2 effect of the duct on the vortex structure of the rotor fig 10 compares the instantaneous flow field in the y z plane of the r d model and the r model for j 0 8 the optimal operating point of the r model fig 10 a shows the z component of vorticity in the y z plane the positions of the tip vortices has been marked by red circles it can be seen that the tip vortices of the r d model are denser than that of the r model taking the 13th tip vortex core center v13 as an example the v13 of the r d model is located at z d 1 6 while z d 1 9 for the r model fig 10 b gives the contours of the pressure coefficient in the y z plane for both models it can be seen that the tip vortices observed as the low pressure zones gradually shrink inward in the radial direction and then approach a fixed radius and remain nearly unchanged at about r 0 4 d r the axial velocity in the y z plane of the two models is visualized in fig 10 c and it is clearly observed that the outflow of the r d model is obviously higher than the r model this fluid acceleration of the wake flow of the r d model is caused by the duct fig 11 show the instantaneous q surfaces of the r model and the r d model for the case j 0 8 fig 12 gives a comparison of the vortex system of the r model and the r d model as shown the vortex system of the r model is composed of the hub vortex the tip voices the trailing tip vortex and the trailing root vortices however for the r d model besides the similar vortices a unique duct induced vortex see fig 11 b is clearly observed for the r model the tip vortices shed from every rotor blade tip presenting themselves as a series of spiral filaments as shown in fig 11 a for j 0 8 these filaments maintain their spiral shape for a long distance downstream of the propeller until they gradually break down and disappear in the far field for the r d model both the duct induced vortex and tip vortices are in the shape of spiral filaments see fig 11 b in the near field region behind the propeller the duct induced vortex and the tip vortex are evenly distributed and appear alternately however with the downstream development of the fluid they begin to contact each other merge into some large vortices and finally breakdown in the far field region according to the research of widnall 1972 the mutual inductance instability mode of the tip vortex is the phenomenon that adjacent helical filaments begin affect each other here we call the interaction between the duct induced vortex and the tip vortex as tip duct mutual inductance instability model the difference of this model with the normal mutual inductance mode is that the instability of the tip filaments is no longer triggered by adjacent tip filaments but by the duct induced vortex this instability mode tends to connect the adjacent tip vortices to form a cylinder surface however the normal mutual inductance instability mode of the tip vortex tends to cause the adjacent tip vortex filaments to roll up around each other leading to the classic leapfrogging phenomenon felli et al 2011 besides the tip vortices the hub vortex of the r d model is also different from the r model see fig 12 for both models the hub vortex falls off from the tail of the hub and then takes the twisted form at near field behind the hub after that the twist disappears gradually and the hub vortex keeps stable until breakdown in the far field compared with the r model the twist of the hub vortex of the r d model disappears faster as for the reason it has been discussed in the qin et al 2021a that the twist of the hub vortex for the pjp is related to the existence of trailing root vortices here for the r d model the sustaining region of trailing root vortices is obviously smaller than that of the r model which means that the disturbing twist force of the tailing root vortices acting on the hub vortex is decreasing rapidly leading to the disappear of twist of the hub vortex for the r d model in order to quantitatively analyze the difference of tip vortices between the r model and the r d model the locations of the tip vortices cores the location of core is determined by the maximum q value point in the tip vortex cross section in the y z plane at j 0 8 are compared in fig 13 a in the comparison an instantaneous time at which the rotor blade of both models have the same phase angle is selected felli et al 2011 has proposed that the spiral to spiral distance of tip vortices is an important parameter for the tip vortex instability here the helical pitch of tip filaments p is defined as the axial distance between two adjacent helical filaments the helical pitch ratio of both models are compared in fig 13 b further more the definition of stable region of tip vortex needs to be discussed according to felli et al 2011 the instability inception point of tip vortices is defined as the first position at which the gradient of the tip vortex envelope equals 50 of the maximum slope the tip vortex envelope is got from the average of over 1000 snapshots of tip vortices using two high speed cameras here the average tip vortex envelope is like a straight line so it is hard to follow the same definition of felli et al as shown in fig 13 b it is found that after the wake contraction region about z d 0 0 8 p d values of two models are approaching to a stable value which is called as the steady pitch ratio here the instability inception point of tip vortex is defined as the first point except the wake contraction region at which the p d value began to move away from the stable value the instability inception point of the r model and the r d model is 1 9 and 1 5 respectively based on the location of the instability inception point of tip vortices the wake region of propeller is divided into the stable region and unstable region one thing should be mentioned here is that there will be a wake contraction region in the near field behind the propeller this region is also classified as a stable area in addition for the r d model the region z d 0 0 5 is defined as the duct region for the r model with the development of flow the radius of tip vortex decreases gradually from r d 0 5 to about r d 0 42 at z d 1 0 and then remains almost unchanged at about r d 0 42 z d 1 0 1 9 and then in the unstable region z d 1 9 2 6 the radius of the tip vortex fluctuates slightly due to the gradually breakdown of tip vortices for the r d model in the duct region z d 0 0 5 the radius of tip vortex has an abnormal increase at about z d 0 4 this is due to that the inner wall of the duct restricts the development of tip vortices more clear details of the effect of duct on the tip vortices can be seen in fig 14 and then in the stable region z d 0 5 1 5 the radius decreases gradually in the unstable region the radius of the tip vortex has a big fluctuation caused by the tip duct mutual inductance instability mode as shown in fig 13 b the steady pitch ratio of the r d model p d 0 165 is slightly bigger than that of the r model p d 0 15 as discussed by felli et al 2011 the more bigger p d is the less likely instability of tip vortices happens however for the r d model the unstable region moves further upstream compared with the r model this is caused by the unique tip duct mutual inductance instability mode generally speaking the existence of the duct exacerbates the instability of tip vortex of single rotor and a unique tip duct mutual inductance instability is found for the ducted propeller next the specific structure of the duct induced vortex and how it interferes with the tip vortex are discussed in fact the vortex induced by duct can be divided into two types vortex shedding from the outer surface of duct called as duct induced vortex 1 and shedding vortex on the inner surface of duct called as duct induced vortex 2 fig 14 gives the details of the duct induced vortex structure of the r d model for j 0 8 on the outer surface of the duct from about z d 0 0 4 obvious flow separation as shown in fig 14 b and vortex shedding see fig 14 d can be seen the vortices shedding from the outer surface of duct presents themselves as a series of circular rings from z d 0 4 the duct induced vortex 1 falling off from the trailing edge of duct shows a same shape with the tip vortices a series of spiral filaments until the tip duct mutual inductance instability happens see fig 11 b in addition some vortices are generated in the inner surface of duct called as duct induced vortex 2 those vortices attach to the inner surface of the duct see fig 15 b at the trailing edge of duct due to the low pressure region behind the duct see fig 14 c the duct induced vortex 2 begins shedding from the duct surface and some spiral filaments is generated fig 15 b shows the spatial development process of duct induced vortex 2 it can be seen that after falling off from the trailing edge duct induced vortex 2 is quickly attracted by tip vortex and a unique phenomenon merge of tip vortex and duct induced vortex is observed it can be inferred that the merge process will inevitably lead to the instability of tip vortex here for the case j 0 8 the tip vortex still keeps a stable spiral shape after merging with duct induced vortex 2 we speculate that it is because the strength of duct induced vortex 2 is relatively weak and the induced instability of tip vortex can be ignored at j 0 8 in general duct induced vortex 1 and duct induced vortex 2 together form the duct induced vortex it has direct effect on the instability of tip vortex of course the formation of these two vortices is also closely related to the shape of the duct reasonable adjustment of the shape of the duct especially the shape of trailing edge can affect the structure of the vortex shedding from the duct and further affect the stability of the tip vortex for example if the duct structure is properly designed to generate more duct induced vortices the tip vortices can become unstable and breakdown rapidly this can provide some new ideas for marine engineers there is a significant phenomenon for propeller the roll up process of the trailing edge vortices according to the research of kumar and mahesh 2017 the roll up process is the phenomenon that the upper part of the trailing vortex gradually bends with the flow developing downstream here the contours of the vorticity magnitude at different z positions for the r and the r d models are shown in fig 16 based on fig 16 a representation of the roll up process of both models are given in fig 17 in the roll up process the upper part of the trailing edge vortex has progressively increasing angular displacement and a radial rise quantitatively we define the angular displacements between a tip vortex and its corresponding trailing vortex as φ the different φ values at different z positions have been given in fig 16 and are listed in table 5 as shown for both models the φ becomes larger and larger with increasing z corresponding to the gradually roll up process of the trailing edge vortices in addition compared with the r model the φ of the r d model is obviously bigger at z d 0 15 for the r d model the φ is about 6 0 which means that the trailing vortex has a 6 0 phase lag of the corresponding tip vortex and touched the next tip vortex see fig 16 c as shown in fig 17 for the r model with the development of fluid downstream the top of the trailing edge vortex bends z d 0 1 0 2 and then the upper part of the trailing edge vortex approaches the next tip vortex z d 0 2 0 4 the interaction force between the upper part of the trailing edge vortex and the next tip vortex gradually increases this mutual interaction is not good for the stability of tip vortex however for the r d model the bending process of the top of the trailing edge vortex happens more faster after the upper part of the trailing edge vortex approaching and contacting with the next tip vortex φ 6 0 at z d 0 15 the upper part keeps bending and approaches the second tip vortex φ 10 0 z d 0 4 compared with the r model the complete development of the roll up process for the r d model happens more quickly as for the reason the spatial evolution of the tip vortex of the r d model is compared with the r model as shown in fig 18 the pressure coefficient contours of the r d model and the r model are compared in fig 18 a more clearly the contours of c p on the pressure side and suction side of the rotor for the r d model and the r model are given in fig 18 c and d respectively a high pressure region is observed at the upper part near the trailing edge of the pressure side of the rotor for the r d model see fig 18 c in addition the low pressure region caused by the tip vortex for the r d model is located at the center of the rotor tip while it is close to the trailing edge of the rotor for the r model the different distribution of these pressure regions is related to the different evolution of the tip vortices fig 18 b gives the instantaneous surfaces of vorticity magnitude of the two models as shown for the r d model due to the existence of the duct on the one hand a circular vortex is formed on the inner wall of the duct on the other hand the tip vortex falls off from the middle of the rotor tip and then quickly leaves the rotor blade and approaches the tip of the next rotor blade resulting in the appearance of high pressure region in the next rotor blade the unfolded drawing of the rotor blades at span 0 99 colored by the tke turbulence kinetic energy is shown in fig 18 e and the spatial evolution of the tip vortex is remarked by a dashed line the difference of the spatial evolution of the tip vortex for the two models can be clearly observed specifically the velocity of the inner wall of the duct is 0 while it of the rotor blade tip is pretty high the sum of the rotational speed and the incoming flow speed leading to a high speed difference between those two walls due to the viscous effect of the inner wall of the duct the tip vortex contacting with the inner wall of the duct cannot keep up the rotating speed of the rotor blade leading to the tip vortex getting farther and farther from the rotor blade as a result the distance between the tip vortex and the previous trailing edge vortex gradually decreases which means that the mutual interaction between them becomes stronger for the r d model compared with the r model in addition this stronger mutual interaction between them inevitably causes the deformation of the upper part of the trailing vortex which makes the trailing tip vortex contact the previous tip vortex more quickly and accelerates the complete development of the roll up process furthermore this difference of the spatial evolution of the tip vortex explains the reason that why the p d of the r d model at the duct region is significantly smaller than the r model see fig 13 although the decrease of p d caused by the duct has not affect on the stable of tip vortices the instability of the tip vortex for the r d model is more likely related to the tip duct mutual inductance instability it has a significant effect on the roll up process of the trailing edge vortex in general the existence of duct for the r d model 1 restricts the development of tip vortex and then decreases the pitch ratio p d of the tip vortex in the duct region 2 reduces the stability of tip vortex the existence of duct induced vortices leads to the happening of the tip duct mutual inductance instability and triggers tip vortex instability finally the vortices structure of the r d model and the r model for different values of j are discussed fig 19 shows the instantaneous q surface of the r d model and the r model for different values of j in fig 19 a the q 1000 s 2 is used and q 100 s 2 is used for the r d model due to the relative small vortex strength of the duct induced vortex see fig 19 b fig 19 c and d show the instantaneous q surfaces of half model to have an intuitive contrast of those two models the same value q 5000 s 2 is used according to the research of widnall 1972 there are mainly three instability modes of a tip vortex short wave instability long wave instability and mutual inductance instability here for the ducted propeller a new tip duct mutual inductance instability mode appears as discussed before in addition the evolution of the tip vortices exhibits different instability modes for different values of j the definition of the instability inception point of tip vortices has been discussed before the positions of instability inception point for different values of j have been marked with dashed lines see fig 19 a and b according to the instability inception point of tip vortex the wake of the r d model is divided into two parts stable region and unstable region for both model at low j cases j 0 2 and 0 4 the instability mode of tip vortices are mainly dominated by the mutual inductance instability mode according to widnall 1972 the mutual inductance instability mode is the mode that adjacent helical tip filaments begin to interact strongly as shown both stable regions of tip vortex of the r model and the r d model at the case j 0 2 are very short adjacent tip filaments contact each other in the unstable region at j 0 2 for the r model adjacent tip filaments show a more complex mutual inductance process every two tip filaments merges to a bigger tip vortex at first and then gradually splits into two vortices again at unstable region however for the r d model the intensity of this mutual inductance instability mode is weaker after the stable region every two tip vortices gradually merges to a bigger tip vortex and then those big tip vortices interfere with each other and gradually breakdown in the far field similarly in the case j 0 4 the contact between adjacent tip vortices can also be clearly observed at medium and high j cases j 0 6 to 1 0 for the r d model the mutual inductance instability mode of tip vortices gradually disappear replacing by the tip duct mutual inductance instability mode as for the reason this tip duct mutual inductance instability mode is closely related to the duct induced vortex as shown in fig 19 b the strength of the duct induced vortex is relatively weak due to the small incoming flow velocity at j 0 2 and 0 4 with the increase of j the strength of the duct induced vortex increases gradually hence the appearance and the strength of the duct induced vortex show clearly dependence on the j more specifically on the incoming velocity u the greater the strength of the duct induced vortex is the stronger the interaction between the duct induced vortex and tip vortices is and then the more likely the tip duct mutual inductance instability mode happens for the r model with the increasing of j the instability inception point moves further downstream with the gradually disappear of the mutual inductance instability mode of tip vortices in general the instability inception point of tip vortices for both models is dependent at the working condition j to quantitatively study the relationship between the j and the tip vortex instability the helical pitch ratio of tip filaments p d is shown in fig 20 a the instability inception point for different values of j for the r model and the r d model is compared in fig 20 b one thing should be mentioned here is that the optimal operating point for the r model j 0 8 and the r d model j 1 0 is different see fig 4 a for the r model the p d at z d 0 6 increases monotonically with increasing j before the optimal operating point and then slightly decreases with the increase of j when j is bigger than the optimal operating point similarly the instability inception point increase firstly and then gradually decrease when j 0 8 hence the transition to instability of the tip vortex shows a clear dependence on the spiral to spiral distance or called as the pitch ratio of tip filaments p d more specifically the larger the value of p d the weaker is the interaction between adjacent tip filaments the less likely is the mutual inductance instability mode to occur and the longer is the stable length of tip vortices this conclusion is consistent with the research of felli et al 2011 and okulov 2004 however for the r d model the change trend is obviously different the p d of the r d model increases linearly with increasing j while the instability inception point of tip vortex has an obvious decrease when j 1 0 this change trend seems contradict the above conclusion here this difference is caused by the unique tip duct mutual inductance instability mode for the r d model as discussed before the strength of duct induced vortex gradually increase and the tip duct mutual inductance instability mode happens in high j cases in general the transition to instability of the tip vortex for the r d model shows a dependence on both the spiral to spiral distance and the strength of duct induced vortex 4 3 effect of the pre swirl stator on the vortex structure of the rotor in this part the flow field and the vortex structure of the pjp model are compared with the r d model to study the effect of the pre swirl stator on the structure and evolution of tip vortices fig 21 compares the instantaneous q surfaces of the pjp model with the r d model for the case j 0 8 as shown in fig 21 a the vortex system of the pjp is similar to that of the r d model which consists of the tip vortices a hub vortex the duct induced vortex rotor trailing vortices in addition a sheet of vortex sheds from the stator trailing edge called the stator trailing vortices can be found in the stator region as shown in fig 21 b the tip vortices of the pjp the upper part is no longer the spiral filaments after shedding from the trailing edge of the duct but shows as a smooth sinuous wave type mode small sinusoidal displacements of every filaments can be observed and this mode is called as the short wave instability mode of the tip vortex according to saffman 1970 for the r d model the tip filaments maintain their spiral shape for a long distance downstream of the propeller while there is no absolute stable region of tip vortices for the pjp model in addition the short wave instability mode is not just happening after shedding from the trailing edge of duct but appears when it sheds from the tip of rotor see fig 25 b so it is reasonable to guess that this short wave instability mode of the tip vortex is not caused by the duct induced vortex but by the stator as for the reason it can be found in fig 8 it has been discussed before that the existence of eight front stator blades has a rectification effect on the incoming flow of rotor changing it from a uniform distribution to a periodic distribution with eight channels the total incoming velocity of a rotor blade is v t o t a l v a 2 π n d r 2 for the pjp when the rotor rotating the axial velocity of the incoming flow v a is not a fixed value but a periodic value leading to the periodic fluctuation of v t o t a l hence the angle of attack for rotor blades will also fluctuates periodically and eventually causing the periodic unstable shedding of tip vortices this is the reason that why the sinusoidal wave short wave instability mode of tip vortex happens for the pjp model the instantaneous flow field in the y z plane of the pjp model is compared with that of the r d model for j 0 8 in fig 22 as shown in fig 22 a for the r d model the tip vortices gradually shrink inward in the radial direction at z d 0 5 1 while for pjp model the low pressure region representing the tip vortex has an irregular increase or decrease in the radial direction after shedding from the duct which corresponds to the short wave instability of the tip vortex at z d 0 5 1 here the radius of the tip vortices core in the y z plane of the two models are compared in fig 23 a in the duct region it is shown that the radius of the tip vortices of both modes are the same which leading to a similar helical pitch ratio of the tip vortices in the duct region fig 23 b in addition following the definition of stable region for the r d model the region bigger than z d 0 5 is defined as the unstable region due to there is no stable region for the pjp model then the unstable region is divided into two part the short wave region and the mutual inductance instability region according the corresponding instability mode of the tip vortices it is shown that the helical pitch ratio of the tip vortices for the pjp model at about z d 1 0 has a obvious increase caused by the tip duct mutual inductance instability this sharp increase is similar with the r d model while it happens further upstream compared with the r d model see fig 23 b this difference can also be observed clearly from fig 22 c and d in addition the axial velocity of the two models are compared in fig 22 b results show that compared with the r d model the jet acceleration effect of the pjp model is more obvious the axial velocity of pjp wake is much larger than that of r d model this is also the reason that why the thrust coefficient of the rotor of pjp is bigger than the r d model see fig 4 the spatial evolution of the roll up process of the rotor trailing vortex in the radial direction is shown in fig 24 as shown the angular displacement between a tip vortex and its corresponding trailing vortex φ at different z positions for the pjp model is basically the same as the r d model following the definition before both models has a 6 0 angular displacements at z d 0 15 which means the complete development of the roll up process of both models happens simultaneously hence the pre swirl stator blades has nearly no effect on the roll up process of the rotor trailing vortex fig 25 shows the instantaneous q surface of the pjp model for different values of j it can be seen that the length of short wave region gradually increases with increasing j as shown the evolution of the tip vortices exhibits different instability modes for different values of j the transition from the mutual inductance instability between tip vortices to the tip duct mutual inductance instability mode for the pjp model is similar with that of the r d model this transition is caused by the duct induce vortex the specific process has been discussed in the previous section compared with the r d model at low j cases j 0 2 and 0 4 the unstable interference forces between adjacent tip filaments caused by the short wave instability make the mutual inductance instability mode happens faster at medium and high j cases j 0 6 to 1 2 the mutual inductance instability mode of tip vortices for the pjp model also happens faster due to the premature breakdown of the duct induced vortex in a word compared with the r d model the stability of tip vortex of the pjp model is reduced in general the evolution of the tip vortices of the pjp is similar with the r d model except the disappear of stable region of tip vortices caused by the short wave instability 4 4 vortex dynamics to study the dynamical behavior of the tip vortices for the three models 8 probes are created to study the change of turbulence kinetic energy tke probes p1 p8 at r d 0 45 as shown in fig 26 the time histories of tke at p1 p8 for different model at j 0 8 is shown in fig 27 the dynamical behavior of the tip vortices for the three models are compared for the r model and the r d model the tke at p1 p3 is a standard sinusoidal periodic signal which means that the tip vortices maintains stable in this region and then from p4 the tke signal begins to lose its purely periodic characteristic and exhibits nonperiodicity and randomicity for the r model the nonperiodicity is relatively small while for the r d model there are violent fluctuations of tke value this is caused by the tip duct multi inductance instability has been discussed before for the pjp model at p1 p3 small nonperiodicity fluctuation of tke signal happens it is caused by the short wave instability of the tip vortices this is consistent with the evolution of tip vortex discussed earlier the change trend of tke at p4 p6 is similar with that of the r d model due to the same tip duct mutual inductance instability at p6 p8 for all the three models the tke approaches a fixed value with small fluctuation which means the gradually breakdown of tip vortices at far field region it should be noted that the period of signal from p1 p8 also changes obviously this is related to the energy transfer process from blade harmonics to shaft harmonics will be discussed below in addition the average value and the amplitude of fluctuation of tke at p1 p8 of the r d model are all bigger than that of the r model hence though the stable region of tip vortex of the r d model is basically the same as the r model it looks like that the turbulence intensity at tip vortex region is enhanced by the duct based on the evolution of tip vortex discussed before we speculate that it is caused by the duct induced vortex similarly the average value and the amplitude of fluctuation of tke of the pjp model is also bigger than the r d model hence the existence of pre swirl stator blades increases the turbulent fluctuation compared with the r d model the time histories of tke at p1 p8 for different model at j 0 2 is shown in fig 28 at p1 the time history of tke shows a standard sinusoidal signal for the r d model however the time history of the r model is no longer a periodic signal this is also consist with the evolution of the tip vortices of the r model see fig 19 j 0 2 for the r d model the duct restricts the instability of the tip vortices at j 0 2 for the pjp model at p1 due to the short wave instability caused by the pre swirl stator blade the tke of the pjp model has a small fluctuation compared with the r d model furthermore the frequency analysis of tke is carried out as shown in figs 29 and 30 at the case j 0 8 for the r model and the r d model the power spectral density psd of the tke at probes p1 p3 has obvious peaks at f bpf the rotor blade passing frequency and its harmonics and then at p4 p6 the components of f bpf has an obvious decrease and is replaced with several peaks at 2 f n see fig 29 a and 3 f n see fig 29 b this is called as energy transfer process from blade harmonics to shaft harmonics et al felli et al 2011 in the far field region p7 p8 all the peaks gradually disappear which corresponded to the breakdown process of the tip vortices for the pjp model the psd of the tke shows a significant difference at p1 p3 besides the peaks at f bpf obvious peaks at 1 f s 2 f s 3 f s and so on f s is the stator blade passing frequency and is 160 hz here appear those peaks are consists with the peak of 160 hz and 320 hz as shown in fig 8 which is caused by the rotor stator interference which has been discussed before this unique stator blade passing frequency f s has been discussed in the qin et al 2021b at j 0 2 for the r and pjp model peaks at n f b p f of tke at p1 p3 are not so obvious while for the r d model the peaks at n f b p f of tke can still be observed see fig 30 b for the r and pjp model at j 0 2 the tip vortex is dominated by the mutual inductance instability mode however the tip vortices maintain its spiral shape for a longer distance for the r d model hence the change of vortex dynamics is closely related to the spatial evolution of tip vortices in addition for all the three models similar energy transfer process from blade harmonics to shaft harmonics can be observed for all j cases as shown in figs 29 and 30 the amplitude of the psd at n f bpf decreases gradually with increasing z d replaced by shaft harmonics at p4 p6 obvious peaks at 2 f n 3 f n 4 f n can be observed in general the vortex dynamics of the three model is different and the characteristic frequency of tke of the tip vortex region for the three models depend on j and is closely related to the spatial evolution of tip vortices 5 conclusions in this paper iddes simulations have been carried out to study the wake dynamics of a pre swirl pumpjet propulsor pjp to separate the roles played by the rotor the stator and the duct in determining the flow of a pjp three models have been established the r model rotor only the r d model rotor within a duct and the pjp model rotor and stator within a duct the three models are compared from three aspects the open water performance the instantaneous wake vortex structure and the vortex dynamics the numerical results reveal the following 1 in terms of hydrodynamic performance the open water efficiency of pjp is better than the r model and r d model especially in the high j cases in addition due to the existence of pre swirl stator pjp shows strong rotor stator interference force which may bring undesirable fluid excited vibration and noise 2 for the r d model the structure of the duct induced vortex is reported the duct induced vortex consists of two parts the vortices that sheds from the outer surface of duct and the vortices sheds from the inner surface of duct the former one leads to the occurrence of tip duct mutual inductance instability mode which is the phenomenon that the duct induced vortex begins to affect adjacent tip vortices for the second part of the duct induced vortex a novel evolution process is found which is called merge of tip vortex and duct induced vortex in the present work more specifically after falling from the trailing edge of the duct the vortices generated from the inner surface of the duct will be quickly attracted and merged by the adjacent tip vortices 3 for the r d and pjp model the transition from stability to instability of the tip vortex shows a dependence on both the spiral to spiral distance and the strength of duct induced vortex 4 for the pjp model with the existence of pre swirl stator blades the angle of attack of the rotor airfoil will experience a small periodic fluctuation leading to the small sinusoidal wave of tip spiral filaments which is called as the short wave instability mode of tip vortices credit authorship contribution statement denghui qin numerical simulation results discussion manuscript writing revise manuscript qiaogao huang propose idea supervision revise manuscript guang pan project funding sources supervision yao shi assist to complete the numerical simulation peng han assist to complete the result analysis xinguo dong the experiment of model and validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china under project no 51979226 and no 51879220 fundamental research funds for the central universities china under project no 3102019hhzy030019 and national key research development plan of china under project no 2016yfc0301300 
20331,the effects of ambient pressure on the self excited cavitating waterjet secj s frequency characteristics were experimentally studied under different operating conditions and nozzle resonant chamber geometries the frequency characteristics were obtained by analyzing the waterjet s dynamic pressure fluctuation and noise experimental results indicate that the fundamental self excited frequency and its harmonics increase as ambient pressure rises from 0 to 5 5 mpa corresponding 0 500 m water depth under constant pressure drop δ p 25 mpa which results in a higher order resonance mode of the jet the dimensionless parameters including the strouhal number s d and cavitation number σ were introduced to uncover ambient pressure s influence mechanism dimensional analysis results indicate that the ambient pressure alters the self excited frequency and modulates the frequency characteristics by changing the strouhal number the relationship between s d n and σ can be fitted as a power function s d n n a σ b n is harmonic order a and b are constant coefficient based on this law and the mechanism of secj the ambient pressure s effects on the frequency characteristics can be predicted which may be used to guide the optimization of secj system under a high ambient environment keywords self excited waterjet frequency characteristic ambient pressure strouhal number nomenclature δ p pressure drop across the nozzle ρ liquid density σ cavitation number c wave velocity in the liquid c v velocity coefficient d diameter of nozzle outlet d 1 diameter of first chamber d 2 diameter of second chamber d s diameter of incoming flow chamber diameter f self excited frequency f n acoustic natural frequency f s sampling frequency k n mode parameter of acoustic natural frequency l length of each single pipe l 1 length of first chamber diameter l 2 length of second chamber diameter n harmonic order of strouhal number n resonance mode p pressure oscillation p 1 upstream pressure p 2 ambient pressure p v vapor pressure of the liquid s standoff distance s d strouhal number s d n harmonics of strouhal number v jet velocity 1 introduction as a non conventional construction method waterjet technology is widely used in ocean engineering such as ship hull cleaning hachicha et al 2019 song and cui 2020 deep ocean mining liu et al 2018 hein et al 2020 and subsea trenching dong et al 2020 whereas waterjet s working efficiency drops significantly under high ambient pressure due to the increase of operating depth for example in the polymetallic nodule mining project the operating depth is up to 4 6 5 kilometers fig 1 which brings significant challenges for the waterjet s application the pulsed waterjet and cavitating waterjet may be utilized to solve the problem above the pulsed waterjet is usually excited by external excitation which can greatly improve the jet s erosion ability under high ambient pressure utilizing its intense pressure oscillation hloch et al 2019 and water hammer effect as for the cavitating waterjet the collapse of cavitation bubbles can produce significant cavitation erosion under greater ambient pressure choi et al 2012 combining the above waterjets superiorities li et al 2017 namely the strong pressure oscillation and cavitation erosion the self excited cavitating waterjet secj owns a broad application prospect in ocean engineering the complex environment especially the tremendous ocean pressure can significantly impact the secj s pressure oscillation and working efficiency through frequency characteristics namely the oscillating frequencies produced by secj under ambient pressure above all its frequency characteristics will indicate and determine whether the secj could oscillate intensely or not moreover the jet s cavitation inception ability under ambient pressure also relies on its oscillation frequency characteristics in a word the secj s frequency characteristics play a dominant role in improving the waterjet s work efficiency under ambient pressure by affecting the pressure oscillation and cavitation erosion performance therefore numerous researches focused on the frequency properties of secj under a submerged environment chahine et al 1984 performed empirical acoustic analysis and built an approximation method to estimate the resonant chamber s acoustic natural frequency characteristics johnson jr et al 1982 found that the nozzle lip geometries can affect the jet s frequency by changing the waterjet s strouhal number liu et al 2018 revealed that the bubble cluster could also produce significant effects on the frequency prediction and proposed a modified model to predict the frequency based on their analysis most recently cai et al 2020b studied the frequency characteristics of the secj experimentally and found that the nozzle lip geometries can change the waterjet s frequency characteristics by altering the strouhal number those studies mainly focused on the effect of nozzle geometries cai et al 2020c chahine et al 1984 pan et al 2020 and flow parameters liu et al 2018 on the frequency characteristics and provided a theoretical and experimental basis for optimizing the secj in ocean engineering previous investigations indicated that the ambient pressure could significantly affect the waterjet s frequency characteristics nishimura et al 2012 ylönen et al 2019 cai et al 2020b our former publication pan et al 2018 also found that the waterjet s oscillation frequency increased with ambient pressure however how the ambient pressure affects the waterjet s oscillation frequencies and resonance modes under various nozzle geometries and greater ambient pressure is unclear by far which will limit the secj s application under ambient pressure uncovering the effects of ambient pressure on secj s frequency characteristics and forecasting them in various working conditions are the key to popularize the jet s application under deep sea to achieve this goal in the present study we will perform an experimental investigation of secj produced by various nozzle resonant chamber geometries under a relatively wide ambient pressure range its frequency characteristics will be distinguished by analyzing the waterjet s dynamic pressure fluctuation and the effects of the ambient pressure on the frequency characteristic will be uncovered this article s structure is as follows the experimental setup and parameter details are described in section 2 in section 3 the results and discussion about the effects of ambient pressure are given the main conclusions are summarized in section 4 2 experimental setup 2 1 mechanics of self excited cavitating waterjet the secj capitalizes on the jet s natural tendency to organize into large coherent structures and produce intense pressure fluctuations without external excitation chahine 1985 the biggest challenge under this circumstance is achieving an peak resonance the resonance will occur if one harmonic of the jet s self excited frequencies approaches the resonant chamber s for example organ pipe or helmholtz chamber acoustic natural frequency chahine et al 1985 in this study the organ pipe was applied as the acoustic resonant chamber due to its low flow resistance and simple structure as shown in fig 2 the self excited frequency f mainly caused by the jet s vortex cavity shedding can be calculated by 1 f s d v d where s d is the strouhal number d and v are the jet s diameter and velocity respectively according to the pipe s acoustic characteristics chahine et al 1984 the single pipe s acoustic natural frequency f n can be computed by cai et al 2020b 2 f n k n c l where c is the acoustic velocity in water and l is the length of each pipe for d s d 1 the mode parameter k n is given by experimental methods as 3 k n n 2 d d 1 m 2 n 1 4 d d 1 m n is the resonance mode number of the chamber m stands for the mach number of waterjet as pointed out above the frequency characteristic of secj is mainly determined by the chamber s acoustic natural frequency and the jet s self excited frequency under the ambient environment the self excited frequency mainly contributed by the vortex cavity shedding may be susceptible to the ambient pressure therefore an experimental study will be carried out to uncover the effects of ambient pressure on the frequency characteristics in the following section 2 2 schematic of the experimental setup this experiment was performed in a test rig with a high pressure chamber schematic is shown in fig 3 to simulate the secj operating under ambient pressure the high pressure chamber s pressure withstand range is 0 10 mpa gauge pressure corresponding to the water depth around 0 1000 m the ambient pressure can be maintained and adjusted by the pressure regulator continuously and precisely a plunger pump supplied the high pressure water with an adjustable working pressure of 0 65 mpa under the volume flow of 0 60 l min for simplicity more details of the experimental setup please refer to cai et al 2020b c the upstream pressure sensor with a high frequency response from pcb was applied to measure the upstream pressure p 1 more importantly to characterize the waterjet s pressure oscillation unless otherwise stated the waterjet refers to the self excited cavitating waterjet here and after the same pressure sensor was installed downstream to obtain the ambient pressure p 2 the sensor s specifications were listed in table 1 the noise emitted from the waterjet also can be used to uncover the jet s frequency characteristics chahine et al 1985 cai et al 2020b the hydrophone located between the nozzle outlet and the erosion specimen was applied to acquire the waterjet noise the hydrophone s usable frequency is 1 khz to 200 khz to capture the noise s broadband characteristic as shown in table 2 the horizontal distance between the hydrophone and the jet s centerline is about 100 mm those signals produced by the above three transducers were acquired by the data logger model lms scadas mobile scm05 with a sampling frequency of f s 204 8 khz furthermore the signal also can be processed in real time and displayed to implement the jet s oscillation status monitoring 2 3 geometries of the self excited nozzle in the present study two organ pipe types single and double step were adopted to investigate the jet frequency s potential diverse characteristics as ambient pressure changes as shown in fig 4 the double step organ pipe consists of two parts with length l 1 and l 2 which results in more complex frequency components 2 4 operation parameters important operation parameters include the nozzle pressure drop δ p p 2 and cavitation number σ the cavitation number σ as a critical non dimensional parameter will be used later here is defined as 4 σ p 2 p v δ p 5 δ p p 1 p 2 where p v is the vapor pressure of the test water all pressures are absolute here according to bernoulli equation the jet s exit mean velocity v can be computed as follows kim et al 2014 6 v c v 2 p 1 p 2 ρ where c v 0 97 is the velocity coefficient ferrari 2017 the optimum standoff distance of waterjet is a function of cavitation number soyama and lichtarowicz 1998 in present experiments the standoff distance s as shown in fig 2 was adjusted from 3 d to 6 d to achieve intensive oscillation as p 2 varies under constant δ p cases of nozzle geometries with different steps and chamber lengths under a board δ p and p 2 were performed to uncover various scenarios frequency characteristics under ambient pressure the nozzle s acoustic natural frequency f n can be calculated by eq 2 eq 3 and transfer matrix method kan 2014 pan et al 2020 the details of the representative operation parameters were given in table 3 during the test process the δ p was kept constant in each case and the p 1 and p 2 increased linearly with time 3 results and discussion this section summarizes and describes the pressure oscillation and frequency characteristics of the waterjets affected by the ambient pressure furthermore the relationship between p 2 and f was uncovered through dimensional analysis finally the waterjet s frequency characteristics could be predicted and controlled under various p 2 3 1 frequency domain source identification under ambient pressure firstly case a with the highest δ p was analyzed to illustrate the waterjet characteristics as p 2 increased under constant δ p as shown in fig 5 the waveform of pressure oscillation showed that the amplitude did not change monotonously as p 2 increased but had multiple peaks in a widely p 2 range fig 5a anyhow the peak of the pressure fluctuation root mean square rms declined sharply due to the suppression of high p 2 on oscillation fig 5b for example the pressure fluctuation s peak at p 2 5 2 mpa was only 35 of that at p 2 1 5 mpa which stressed the inhibiting effect of p 2 again closer inspection of the effects of p 2 on the frequency characteristic under constant δ p can be obtained with the short time fourier transform of pressure signal shown in fig 6 the hamming windowing was adopted to window the signal with a length of 102 4k samples 80 overlap was specified between contiguous sections the p 2 decreased almost linearly with time during the experiment as mentioned in section 2 3 therefore the horizontal axis was pressure instead of time series to illustrate the former s effect the spectrogram showed that there were three frequency band with higher amplitude at about f n 1 6 5 khz f n 2 20 khz and f n 3 33 khz fig 6a interestingly the values of these three frequencies approximately were constant as p 2 changing even though the amplitudes might change at specific points as shown in table 3 this resonant chamber s f n is 6 5 19 5 and 32 5 khz correspond to its first second and third mode so those three frequency bands were regarded as the f n under various mode numbers preliminary the spectrogram also revealed a series of characteristic frequencies that increased with p 2 regardless of the mode number of the f n meanwhile these frequencies were in integer multiples it is also worth noting that the frequency lock phenomenon occurred when one harmonic of the characteristic frequencies approached the f n it further suggested that the resonance was achieved at this condition additional insights on the frequency characteristics were obtained with spectrum at p 2 4 3 and 2 mpa corresponding work depth 400 m 300 m and 200 m shown in fig 6b fig 6c fig 6d those figures with distinct frequency components also illustrated the first second and third resonance modes therefore the jet s f can be confirmed by combining the experimental results and the waterjet s mechanism the exact f and f n of various resonance modes under various p 2 were given in table 4 as illustrated in fig 6 the effects of p 2 on frequency characteristics mainly acts on the f under constant δ p according to eq 1 the variation of f is related to the s d with constant v and d as a dimensionless parameter in the fundamental fluid mechanics s d is widely used to analyze the vortex induced vibration choi 2001 or flow induced oscillation yoon et al 2020 problem essentially the waterjet also takes advantage of this phenomenon to achieve an intense resonance to uncover the relation between the frequency evolution and ambient pressure case a s s d changes as p 2 was obtained firstly fig 7 suggested that the s d increases monotonically with the rise of p 2 under constant δ p velocity the higher orders of the s d were the integer times of the fundamental one all calculated by the various harmonic of f the resonance mode n changed from 1 to 2 3 as p 2 increases while the corresponding s d were different when resonance occurs at various resonance mode numbers the exact value of resonance mode number and the corresponding s d of case a was given in table 5 under various p 2 an interesting finding implied that the p 2 range was wider for lower order resonance for example the p 2 range of the first order was about 1 4 times of the third order resonance similarly founding also was pointed by chahine et al 1985 that the resonance will peak when the first mode frequency of the chamber approach the jet s fundamental f thus the first order resonance should be the preferred resonance mode the p 2 affects the waterjet s frequency characteristics mainly through changing the f based on the waterjet s mechanics the self excitation mainly sources from the vortex cavitation shedding therefore it can be speculated that the effects of p 2 on the frequency characteristics are contributed to the variation of vortex or cavity shedding frequency as σ changes similarly previous cavitation cloud studies have found that the cavitation cloud shedding frequencies increase with σ dular and bachert 2009 gavaises et al 2015 a possible explanation is that the cavity length decreases and moves downstream faster at higher σ which results in higher shedding frequency šarc et al 2017 gavaises et al 2015 3 2 effects on frequency characteristics of various operation parameters under constant pressure drop as pointed out in section 3 1 the p 2 mainly affects the jet s frequency characteristics by altering the f this section will downsize and focus mainly on the variation of f and s d as p 2 changes cases with various nozzle geometries and δ p will be analyzed to uncover the effects of p 2 on the frequency characteristics under various working conditions the noise signal of various cases was analyzed by short time fourier transform to uncover f s variation as shown in fig 6 the spectrogram of pressure oscillation signal had complex frequency component and accompanied by the frequency lock phenomenon making the spectrogram difficult to distinguish the noise signal acquired outside the nozzle near the shear layer can also provide significant information of the jet s frequency characteristics chahine et al 1985 cai et al 2020b therefore the noise signal was used to inspect the waterjet s frequency characteristics here and after only case a b and c d s results were given in this section for brevity fig 8a showed that the variation tendency of f illustrated by noise had consistent information with that provided by pressure signal fig 6a also the f increased monotonously as p 2 increased here the fundamental of the f was defined as f 1 and the spectrogram contained the first five order frequencies up to 60 khz it is worth noting that the half harmonic can also be recognized in the noise signal s spectrogram even the amplitude was relatively low first of all case b s result was given in fig 8b to uncover the influence of ambient pressure on waterjet emitted by nozzles with various chamber steps compared with fig 8a the trend looked the same in case b with a double step chamber in contrast there appeared more frequency locker in the band shapes of f 1 and its harmonics compared to the single step nozzle cases due to the multiple f n of the double step chamber it might be easier to achieve the resonance state and lead to the frequency locker phenomenon additionally the characteristics of f under different δ p were shown in fig 8c and fig 8d under the lower δ p f s energy distribution was mainly focused on the first three harmonics fig 8d moreover the results also showed that energy almost disappears when the p 2 exceeds 3 6 mpa under lower δ p those results illustrated that the δ p should be increased to enhance the oscillation amplitude under higher p 2 s d as a function of p 2 of those cases were shown in fig 9 overall the s d of those cases all increased with the ambient pressure however the variation curves were not consistent for different δ p case a case b and case d as illustrated in section 3 1 the f and corresponding s d were related to σ dular and bachert 2009 gavaises et al 2015 under the same p 2 each case s σ were different due to the effects of δ p which results in inconsistent s d under different cases the consistency of case b and c with the same δ p can verify the above hypothesis again therefore to uncover the relationship between the p 2 and the frequency characteristics the influence of δ p will be decoupled to perform some dimensional analysis in the next subsection 3 3 dimensional analysis of ambient pressure s effects under constant pressure drop in this section the dimensional analysis will be conducted to analyze the correlation between p 2 and frequency characteristics and decouple the influence of δ p and chamber geometries furthermore the effects of p 2 on frequency characteristics will be predicted under a constant δ p as illustrated in section 3 1 and 3 2 the p 2 s effects on frequency characteristics mainly act on the f pan et al 2018 pointed out that the s d calculated by the f was a function of σ as the p 2 change based on their study the dimensional analysis results of case a to e were given in fig 10 to inspect the relationship between the s d and σ as the higher order of harmonics are the integer times of the fundamental one for brevity only the s d obtained by the f 1 was given an exciting phenomenon was that the s d s tendency of all cases was highly consistent as the σ changes whether the nozzle chamber geometries and flow condition were the same or not refer to the research of pan et al 2018 the relation of s d and σ can be fitted as a power function in the present study the least square method was used for fitting the experimental data in fig 10 can be fitted as the following equation 7 s d 1 a σ b where the fitting coefficients a 0 21 b 0 46 the correlation coefficient is larger than 0 99 the coefficients a and b are mainly related to the nozzle outlet geometries including expansion angle and length cai et al 2020a which was not discussed in this study according to case a s experimental result and fig 7 the high order strouhal numbers are inter times of the fundamental one as a result the high order strouhal number s d n can be obtained based on eq 7 as 8 s d n n s d 1 to validate eqs 7 and 8 its prediction results and the experimental results of case a were compared in fig 11 it can be observed that the model prediction results including the various harmonics s d 1 s d 2 s d 3 agreed well with the experimental data furthermore fig 11 showed that the correlation between s d and σ was almost independent of δ p and f n however it is also noteworthy that the resonance mode number for instance n 1 2 3 was determined by the f n of the nozzle chamber under specific flow parameters according to the self excited nozzle s mechanism as a result the resonance mode can be adjusted for specific flow parameters under various p 2 the function between the s d and σ can be applied to predict the waterjet s frequency characteristics under various p 2 moreover the secj system could be designed and optimized to achieve resonance oscillation under various p 2 for example if the case a s operating depth increase to 800 m where p 2 8 mpa σ 0 32 and s d 1 0 124 as shown in fig 12 then the resonant chamber geometry and its f n could be adjusted to achieve resonance the parameter details were given in table 6 3 4 ambient pressure s effects on frequency characteristics under variable pressure drop in the above section under constant δ p the effects of p 2 on the frequency characteristics were studied systematically however the δ p may be variable as p 2 changes in some field applications such as deep well drilling meanwhile the δ p also can change the resonance mode and further influence the oscillation state this section will investigate the effects of p 2 under variable δ p combining eq 7 and 8 various harmonics of s d was obtained in the σ 0 02 0 4 as shown in fig 13 considering two extreme conditions the δ p was relative higher or lower caused by p 2 firstly in case 1 the δ p was relatively lower due to the high p 2 as shown in fig 13a the resonance mode and its corresponding s d was higher under the specific nozzle geometry details were shown in table 7 therefore the intersection point of s d 3 with the first resonance mode around σ 0 18 was the only location that the resonance may occur and the higher order resonance second and third mode will be more difficult to achieve secondly consider another scenario in which the p 2 was relatively low resulting in a higher δ p case 2 in this condition the first resonance mode position was lower than the s d 1 if this happens the first order resonance generally the peak resonant mode may not achieve under this condition as shown in fig 13b under constant p 1 the changing of p 2 will alter δ p and then induce the resonance mode s variation according to the waterjet s mechanism and eq 7 this problem can be solved or improved by matching suitable chamber geometry or adjusting the step of the chamber 4 conclusions in this paper the self excited cavitating waterjet secj s frequency characteristics were obtained under ambient pressure p 2 0 5 5 mpa corresponding to 0 500 m water depths it was found that the self excited frequency f increases monotonously and the resonance mode number step to higher order as ambient pressure p 2 increases under constant pressure drop δ p the f varied as p 2 due to changing of strouhal number s d the dimensionless parameters s d and cavitation number σ were introduced to uncover the relationship between p 2 and f the results show that the s d s evolution of various cases is consistent as σ rises the relationship between s d n and σ can be fitted as a power function the law of s d n and σ could be used to guide the waterjet system s design under various p 2 furthermore under constant p 1 the changing of p 2 will alter δ p and then induce the resonance mode s variation one particular value of the present work is that it could guide the f and f n s matching to achieve peak resonance under specific p 2 and δ p credit authorship contribution statement tengfei cai conceptualization formal analysis investigation writing original draft yan pan investigation writing review editing fei ma conceptualization methodology supervision funding acquisition validation project administration writing review editing lulu gao writing review editing boshen liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china no 51774019 university of science and technology beijing no bk19ce001 the national natural science foundation of china no 52004018 
20331,the effects of ambient pressure on the self excited cavitating waterjet secj s frequency characteristics were experimentally studied under different operating conditions and nozzle resonant chamber geometries the frequency characteristics were obtained by analyzing the waterjet s dynamic pressure fluctuation and noise experimental results indicate that the fundamental self excited frequency and its harmonics increase as ambient pressure rises from 0 to 5 5 mpa corresponding 0 500 m water depth under constant pressure drop δ p 25 mpa which results in a higher order resonance mode of the jet the dimensionless parameters including the strouhal number s d and cavitation number σ were introduced to uncover ambient pressure s influence mechanism dimensional analysis results indicate that the ambient pressure alters the self excited frequency and modulates the frequency characteristics by changing the strouhal number the relationship between s d n and σ can be fitted as a power function s d n n a σ b n is harmonic order a and b are constant coefficient based on this law and the mechanism of secj the ambient pressure s effects on the frequency characteristics can be predicted which may be used to guide the optimization of secj system under a high ambient environment keywords self excited waterjet frequency characteristic ambient pressure strouhal number nomenclature δ p pressure drop across the nozzle ρ liquid density σ cavitation number c wave velocity in the liquid c v velocity coefficient d diameter of nozzle outlet d 1 diameter of first chamber d 2 diameter of second chamber d s diameter of incoming flow chamber diameter f self excited frequency f n acoustic natural frequency f s sampling frequency k n mode parameter of acoustic natural frequency l length of each single pipe l 1 length of first chamber diameter l 2 length of second chamber diameter n harmonic order of strouhal number n resonance mode p pressure oscillation p 1 upstream pressure p 2 ambient pressure p v vapor pressure of the liquid s standoff distance s d strouhal number s d n harmonics of strouhal number v jet velocity 1 introduction as a non conventional construction method waterjet technology is widely used in ocean engineering such as ship hull cleaning hachicha et al 2019 song and cui 2020 deep ocean mining liu et al 2018 hein et al 2020 and subsea trenching dong et al 2020 whereas waterjet s working efficiency drops significantly under high ambient pressure due to the increase of operating depth for example in the polymetallic nodule mining project the operating depth is up to 4 6 5 kilometers fig 1 which brings significant challenges for the waterjet s application the pulsed waterjet and cavitating waterjet may be utilized to solve the problem above the pulsed waterjet is usually excited by external excitation which can greatly improve the jet s erosion ability under high ambient pressure utilizing its intense pressure oscillation hloch et al 2019 and water hammer effect as for the cavitating waterjet the collapse of cavitation bubbles can produce significant cavitation erosion under greater ambient pressure choi et al 2012 combining the above waterjets superiorities li et al 2017 namely the strong pressure oscillation and cavitation erosion the self excited cavitating waterjet secj owns a broad application prospect in ocean engineering the complex environment especially the tremendous ocean pressure can significantly impact the secj s pressure oscillation and working efficiency through frequency characteristics namely the oscillating frequencies produced by secj under ambient pressure above all its frequency characteristics will indicate and determine whether the secj could oscillate intensely or not moreover the jet s cavitation inception ability under ambient pressure also relies on its oscillation frequency characteristics in a word the secj s frequency characteristics play a dominant role in improving the waterjet s work efficiency under ambient pressure by affecting the pressure oscillation and cavitation erosion performance therefore numerous researches focused on the frequency properties of secj under a submerged environment chahine et al 1984 performed empirical acoustic analysis and built an approximation method to estimate the resonant chamber s acoustic natural frequency characteristics johnson jr et al 1982 found that the nozzle lip geometries can affect the jet s frequency by changing the waterjet s strouhal number liu et al 2018 revealed that the bubble cluster could also produce significant effects on the frequency prediction and proposed a modified model to predict the frequency based on their analysis most recently cai et al 2020b studied the frequency characteristics of the secj experimentally and found that the nozzle lip geometries can change the waterjet s frequency characteristics by altering the strouhal number those studies mainly focused on the effect of nozzle geometries cai et al 2020c chahine et al 1984 pan et al 2020 and flow parameters liu et al 2018 on the frequency characteristics and provided a theoretical and experimental basis for optimizing the secj in ocean engineering previous investigations indicated that the ambient pressure could significantly affect the waterjet s frequency characteristics nishimura et al 2012 ylönen et al 2019 cai et al 2020b our former publication pan et al 2018 also found that the waterjet s oscillation frequency increased with ambient pressure however how the ambient pressure affects the waterjet s oscillation frequencies and resonance modes under various nozzle geometries and greater ambient pressure is unclear by far which will limit the secj s application under ambient pressure uncovering the effects of ambient pressure on secj s frequency characteristics and forecasting them in various working conditions are the key to popularize the jet s application under deep sea to achieve this goal in the present study we will perform an experimental investigation of secj produced by various nozzle resonant chamber geometries under a relatively wide ambient pressure range its frequency characteristics will be distinguished by analyzing the waterjet s dynamic pressure fluctuation and the effects of the ambient pressure on the frequency characteristic will be uncovered this article s structure is as follows the experimental setup and parameter details are described in section 2 in section 3 the results and discussion about the effects of ambient pressure are given the main conclusions are summarized in section 4 2 experimental setup 2 1 mechanics of self excited cavitating waterjet the secj capitalizes on the jet s natural tendency to organize into large coherent structures and produce intense pressure fluctuations without external excitation chahine 1985 the biggest challenge under this circumstance is achieving an peak resonance the resonance will occur if one harmonic of the jet s self excited frequencies approaches the resonant chamber s for example organ pipe or helmholtz chamber acoustic natural frequency chahine et al 1985 in this study the organ pipe was applied as the acoustic resonant chamber due to its low flow resistance and simple structure as shown in fig 2 the self excited frequency f mainly caused by the jet s vortex cavity shedding can be calculated by 1 f s d v d where s d is the strouhal number d and v are the jet s diameter and velocity respectively according to the pipe s acoustic characteristics chahine et al 1984 the single pipe s acoustic natural frequency f n can be computed by cai et al 2020b 2 f n k n c l where c is the acoustic velocity in water and l is the length of each pipe for d s d 1 the mode parameter k n is given by experimental methods as 3 k n n 2 d d 1 m 2 n 1 4 d d 1 m n is the resonance mode number of the chamber m stands for the mach number of waterjet as pointed out above the frequency characteristic of secj is mainly determined by the chamber s acoustic natural frequency and the jet s self excited frequency under the ambient environment the self excited frequency mainly contributed by the vortex cavity shedding may be susceptible to the ambient pressure therefore an experimental study will be carried out to uncover the effects of ambient pressure on the frequency characteristics in the following section 2 2 schematic of the experimental setup this experiment was performed in a test rig with a high pressure chamber schematic is shown in fig 3 to simulate the secj operating under ambient pressure the high pressure chamber s pressure withstand range is 0 10 mpa gauge pressure corresponding to the water depth around 0 1000 m the ambient pressure can be maintained and adjusted by the pressure regulator continuously and precisely a plunger pump supplied the high pressure water with an adjustable working pressure of 0 65 mpa under the volume flow of 0 60 l min for simplicity more details of the experimental setup please refer to cai et al 2020b c the upstream pressure sensor with a high frequency response from pcb was applied to measure the upstream pressure p 1 more importantly to characterize the waterjet s pressure oscillation unless otherwise stated the waterjet refers to the self excited cavitating waterjet here and after the same pressure sensor was installed downstream to obtain the ambient pressure p 2 the sensor s specifications were listed in table 1 the noise emitted from the waterjet also can be used to uncover the jet s frequency characteristics chahine et al 1985 cai et al 2020b the hydrophone located between the nozzle outlet and the erosion specimen was applied to acquire the waterjet noise the hydrophone s usable frequency is 1 khz to 200 khz to capture the noise s broadband characteristic as shown in table 2 the horizontal distance between the hydrophone and the jet s centerline is about 100 mm those signals produced by the above three transducers were acquired by the data logger model lms scadas mobile scm05 with a sampling frequency of f s 204 8 khz furthermore the signal also can be processed in real time and displayed to implement the jet s oscillation status monitoring 2 3 geometries of the self excited nozzle in the present study two organ pipe types single and double step were adopted to investigate the jet frequency s potential diverse characteristics as ambient pressure changes as shown in fig 4 the double step organ pipe consists of two parts with length l 1 and l 2 which results in more complex frequency components 2 4 operation parameters important operation parameters include the nozzle pressure drop δ p p 2 and cavitation number σ the cavitation number σ as a critical non dimensional parameter will be used later here is defined as 4 σ p 2 p v δ p 5 δ p p 1 p 2 where p v is the vapor pressure of the test water all pressures are absolute here according to bernoulli equation the jet s exit mean velocity v can be computed as follows kim et al 2014 6 v c v 2 p 1 p 2 ρ where c v 0 97 is the velocity coefficient ferrari 2017 the optimum standoff distance of waterjet is a function of cavitation number soyama and lichtarowicz 1998 in present experiments the standoff distance s as shown in fig 2 was adjusted from 3 d to 6 d to achieve intensive oscillation as p 2 varies under constant δ p cases of nozzle geometries with different steps and chamber lengths under a board δ p and p 2 were performed to uncover various scenarios frequency characteristics under ambient pressure the nozzle s acoustic natural frequency f n can be calculated by eq 2 eq 3 and transfer matrix method kan 2014 pan et al 2020 the details of the representative operation parameters were given in table 3 during the test process the δ p was kept constant in each case and the p 1 and p 2 increased linearly with time 3 results and discussion this section summarizes and describes the pressure oscillation and frequency characteristics of the waterjets affected by the ambient pressure furthermore the relationship between p 2 and f was uncovered through dimensional analysis finally the waterjet s frequency characteristics could be predicted and controlled under various p 2 3 1 frequency domain source identification under ambient pressure firstly case a with the highest δ p was analyzed to illustrate the waterjet characteristics as p 2 increased under constant δ p as shown in fig 5 the waveform of pressure oscillation showed that the amplitude did not change monotonously as p 2 increased but had multiple peaks in a widely p 2 range fig 5a anyhow the peak of the pressure fluctuation root mean square rms declined sharply due to the suppression of high p 2 on oscillation fig 5b for example the pressure fluctuation s peak at p 2 5 2 mpa was only 35 of that at p 2 1 5 mpa which stressed the inhibiting effect of p 2 again closer inspection of the effects of p 2 on the frequency characteristic under constant δ p can be obtained with the short time fourier transform of pressure signal shown in fig 6 the hamming windowing was adopted to window the signal with a length of 102 4k samples 80 overlap was specified between contiguous sections the p 2 decreased almost linearly with time during the experiment as mentioned in section 2 3 therefore the horizontal axis was pressure instead of time series to illustrate the former s effect the spectrogram showed that there were three frequency band with higher amplitude at about f n 1 6 5 khz f n 2 20 khz and f n 3 33 khz fig 6a interestingly the values of these three frequencies approximately were constant as p 2 changing even though the amplitudes might change at specific points as shown in table 3 this resonant chamber s f n is 6 5 19 5 and 32 5 khz correspond to its first second and third mode so those three frequency bands were regarded as the f n under various mode numbers preliminary the spectrogram also revealed a series of characteristic frequencies that increased with p 2 regardless of the mode number of the f n meanwhile these frequencies were in integer multiples it is also worth noting that the frequency lock phenomenon occurred when one harmonic of the characteristic frequencies approached the f n it further suggested that the resonance was achieved at this condition additional insights on the frequency characteristics were obtained with spectrum at p 2 4 3 and 2 mpa corresponding work depth 400 m 300 m and 200 m shown in fig 6b fig 6c fig 6d those figures with distinct frequency components also illustrated the first second and third resonance modes therefore the jet s f can be confirmed by combining the experimental results and the waterjet s mechanism the exact f and f n of various resonance modes under various p 2 were given in table 4 as illustrated in fig 6 the effects of p 2 on frequency characteristics mainly acts on the f under constant δ p according to eq 1 the variation of f is related to the s d with constant v and d as a dimensionless parameter in the fundamental fluid mechanics s d is widely used to analyze the vortex induced vibration choi 2001 or flow induced oscillation yoon et al 2020 problem essentially the waterjet also takes advantage of this phenomenon to achieve an intense resonance to uncover the relation between the frequency evolution and ambient pressure case a s s d changes as p 2 was obtained firstly fig 7 suggested that the s d increases monotonically with the rise of p 2 under constant δ p velocity the higher orders of the s d were the integer times of the fundamental one all calculated by the various harmonic of f the resonance mode n changed from 1 to 2 3 as p 2 increases while the corresponding s d were different when resonance occurs at various resonance mode numbers the exact value of resonance mode number and the corresponding s d of case a was given in table 5 under various p 2 an interesting finding implied that the p 2 range was wider for lower order resonance for example the p 2 range of the first order was about 1 4 times of the third order resonance similarly founding also was pointed by chahine et al 1985 that the resonance will peak when the first mode frequency of the chamber approach the jet s fundamental f thus the first order resonance should be the preferred resonance mode the p 2 affects the waterjet s frequency characteristics mainly through changing the f based on the waterjet s mechanics the self excitation mainly sources from the vortex cavitation shedding therefore it can be speculated that the effects of p 2 on the frequency characteristics are contributed to the variation of vortex or cavity shedding frequency as σ changes similarly previous cavitation cloud studies have found that the cavitation cloud shedding frequencies increase with σ dular and bachert 2009 gavaises et al 2015 a possible explanation is that the cavity length decreases and moves downstream faster at higher σ which results in higher shedding frequency šarc et al 2017 gavaises et al 2015 3 2 effects on frequency characteristics of various operation parameters under constant pressure drop as pointed out in section 3 1 the p 2 mainly affects the jet s frequency characteristics by altering the f this section will downsize and focus mainly on the variation of f and s d as p 2 changes cases with various nozzle geometries and δ p will be analyzed to uncover the effects of p 2 on the frequency characteristics under various working conditions the noise signal of various cases was analyzed by short time fourier transform to uncover f s variation as shown in fig 6 the spectrogram of pressure oscillation signal had complex frequency component and accompanied by the frequency lock phenomenon making the spectrogram difficult to distinguish the noise signal acquired outside the nozzle near the shear layer can also provide significant information of the jet s frequency characteristics chahine et al 1985 cai et al 2020b therefore the noise signal was used to inspect the waterjet s frequency characteristics here and after only case a b and c d s results were given in this section for brevity fig 8a showed that the variation tendency of f illustrated by noise had consistent information with that provided by pressure signal fig 6a also the f increased monotonously as p 2 increased here the fundamental of the f was defined as f 1 and the spectrogram contained the first five order frequencies up to 60 khz it is worth noting that the half harmonic can also be recognized in the noise signal s spectrogram even the amplitude was relatively low first of all case b s result was given in fig 8b to uncover the influence of ambient pressure on waterjet emitted by nozzles with various chamber steps compared with fig 8a the trend looked the same in case b with a double step chamber in contrast there appeared more frequency locker in the band shapes of f 1 and its harmonics compared to the single step nozzle cases due to the multiple f n of the double step chamber it might be easier to achieve the resonance state and lead to the frequency locker phenomenon additionally the characteristics of f under different δ p were shown in fig 8c and fig 8d under the lower δ p f s energy distribution was mainly focused on the first three harmonics fig 8d moreover the results also showed that energy almost disappears when the p 2 exceeds 3 6 mpa under lower δ p those results illustrated that the δ p should be increased to enhance the oscillation amplitude under higher p 2 s d as a function of p 2 of those cases were shown in fig 9 overall the s d of those cases all increased with the ambient pressure however the variation curves were not consistent for different δ p case a case b and case d as illustrated in section 3 1 the f and corresponding s d were related to σ dular and bachert 2009 gavaises et al 2015 under the same p 2 each case s σ were different due to the effects of δ p which results in inconsistent s d under different cases the consistency of case b and c with the same δ p can verify the above hypothesis again therefore to uncover the relationship between the p 2 and the frequency characteristics the influence of δ p will be decoupled to perform some dimensional analysis in the next subsection 3 3 dimensional analysis of ambient pressure s effects under constant pressure drop in this section the dimensional analysis will be conducted to analyze the correlation between p 2 and frequency characteristics and decouple the influence of δ p and chamber geometries furthermore the effects of p 2 on frequency characteristics will be predicted under a constant δ p as illustrated in section 3 1 and 3 2 the p 2 s effects on frequency characteristics mainly act on the f pan et al 2018 pointed out that the s d calculated by the f was a function of σ as the p 2 change based on their study the dimensional analysis results of case a to e were given in fig 10 to inspect the relationship between the s d and σ as the higher order of harmonics are the integer times of the fundamental one for brevity only the s d obtained by the f 1 was given an exciting phenomenon was that the s d s tendency of all cases was highly consistent as the σ changes whether the nozzle chamber geometries and flow condition were the same or not refer to the research of pan et al 2018 the relation of s d and σ can be fitted as a power function in the present study the least square method was used for fitting the experimental data in fig 10 can be fitted as the following equation 7 s d 1 a σ b where the fitting coefficients a 0 21 b 0 46 the correlation coefficient is larger than 0 99 the coefficients a and b are mainly related to the nozzle outlet geometries including expansion angle and length cai et al 2020a which was not discussed in this study according to case a s experimental result and fig 7 the high order strouhal numbers are inter times of the fundamental one as a result the high order strouhal number s d n can be obtained based on eq 7 as 8 s d n n s d 1 to validate eqs 7 and 8 its prediction results and the experimental results of case a were compared in fig 11 it can be observed that the model prediction results including the various harmonics s d 1 s d 2 s d 3 agreed well with the experimental data furthermore fig 11 showed that the correlation between s d and σ was almost independent of δ p and f n however it is also noteworthy that the resonance mode number for instance n 1 2 3 was determined by the f n of the nozzle chamber under specific flow parameters according to the self excited nozzle s mechanism as a result the resonance mode can be adjusted for specific flow parameters under various p 2 the function between the s d and σ can be applied to predict the waterjet s frequency characteristics under various p 2 moreover the secj system could be designed and optimized to achieve resonance oscillation under various p 2 for example if the case a s operating depth increase to 800 m where p 2 8 mpa σ 0 32 and s d 1 0 124 as shown in fig 12 then the resonant chamber geometry and its f n could be adjusted to achieve resonance the parameter details were given in table 6 3 4 ambient pressure s effects on frequency characteristics under variable pressure drop in the above section under constant δ p the effects of p 2 on the frequency characteristics were studied systematically however the δ p may be variable as p 2 changes in some field applications such as deep well drilling meanwhile the δ p also can change the resonance mode and further influence the oscillation state this section will investigate the effects of p 2 under variable δ p combining eq 7 and 8 various harmonics of s d was obtained in the σ 0 02 0 4 as shown in fig 13 considering two extreme conditions the δ p was relative higher or lower caused by p 2 firstly in case 1 the δ p was relatively lower due to the high p 2 as shown in fig 13a the resonance mode and its corresponding s d was higher under the specific nozzle geometry details were shown in table 7 therefore the intersection point of s d 3 with the first resonance mode around σ 0 18 was the only location that the resonance may occur and the higher order resonance second and third mode will be more difficult to achieve secondly consider another scenario in which the p 2 was relatively low resulting in a higher δ p case 2 in this condition the first resonance mode position was lower than the s d 1 if this happens the first order resonance generally the peak resonant mode may not achieve under this condition as shown in fig 13b under constant p 1 the changing of p 2 will alter δ p and then induce the resonance mode s variation according to the waterjet s mechanism and eq 7 this problem can be solved or improved by matching suitable chamber geometry or adjusting the step of the chamber 4 conclusions in this paper the self excited cavitating waterjet secj s frequency characteristics were obtained under ambient pressure p 2 0 5 5 mpa corresponding to 0 500 m water depths it was found that the self excited frequency f increases monotonously and the resonance mode number step to higher order as ambient pressure p 2 increases under constant pressure drop δ p the f varied as p 2 due to changing of strouhal number s d the dimensionless parameters s d and cavitation number σ were introduced to uncover the relationship between p 2 and f the results show that the s d s evolution of various cases is consistent as σ rises the relationship between s d n and σ can be fitted as a power function the law of s d n and σ could be used to guide the waterjet system s design under various p 2 furthermore under constant p 1 the changing of p 2 will alter δ p and then induce the resonance mode s variation one particular value of the present work is that it could guide the f and f n s matching to achieve peak resonance under specific p 2 and δ p credit authorship contribution statement tengfei cai conceptualization formal analysis investigation writing original draft yan pan investigation writing review editing fei ma conceptualization methodology supervision funding acquisition validation project administration writing review editing lulu gao writing review editing boshen liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china no 51774019 university of science and technology beijing no bk19ce001 the national natural science foundation of china no 52004018 
20332,supercavitating vehicle can realize high speed underwater sailing however the nonlinear force and time delay characteristics caused by the tail flapping the cavity wall become the main challenge of the vehicle controller design aiming at time delay characteristics the nonlinear of planing force cavity radius perturbation and parameter uncertainty the paper establishes a time delay linear parameter varying lpv model and designs a robust predictive controller with anti interference performance in the process of predictive controller design the variable quadratic function is used to achieve the robustness of the vehicle and reduce the conservatism of the controller design meanwhile the memory state feedback is used to solve the problems of cavitation radius perturbation control constraints vehicle parameter uncertainty and external disturbance the simulation results show that the controller has strong robustness against the disturbance of external parameters and can guarantee the stability of the system keywords supercavitating vehicle robust predictive control time delay characteristics h control parameter uncertainty 1 introduction supercavitation is a natural phenomenon supercavitation will arise on the surface of the vehicle when the speed of underwater vehicle reaches a certain range the reduction of the contact area with water will reduce the friction resistance of the vehicle by 90 ceccio and steven 2010 storm torpedo of russia and barracuda torpedo of germany all adopt the supercavitation technology the speed of storm torpedo can reach 120 m s and supercavitating projectile can even reach 1500 m s jenkins and evans 2004 presently supercavitating technology has been highly valued by many countries researchers in various countries have carried out a lot of experimental research on supercavitating vehicles ishchenko et al 2020c developed a mathematical model of a shot from a smoothbore ballistic installation for a gun start of a group of supercavitating strikers and to verify the mathematical model experimental investigations into high velocity launching of a group of bodies on a hydroballistic testing facility have been conducted in ishchenko et al 2020b a they also considered the motion characteristics of one and two supercavitating impactors entering the water simultaneously at a speed exceeding the speed of sound in the medium and developed a calculation program to simulate the possible deviation of the impactor movement in the water in order to verify the performance of the theoretically designed control method in actual fluid conditions sanabria et al 2015 designed a dynamic test bed and built a freely rotating small scale ultra high speed vehicle model in the high speed water tunnel located at the st anthony falls laboratory safl university of minnesota minneapolis mn usa based on this test platform they completed the following work proposed a cost effective and low complexity supercavitating vehicle model and controller test method and used this method to evaluate the effect of fluid disturbance on the cavitator and fins in mansour et al 2020 researchers have done some research on the supercavitating flow of different shapes of cavitators rojas et al 2019 have developed a new method to quantify the time to obtain a supercavitating flow at the nozzle outlet numerical simulations have been conducted to study the delay between the onset of the jet pulse and the onset of supercavitation at the orifice of the micro nozzle in chen et al 2019 the author analyzed the data under ventilation and non ventilation conditions in detail studying the effect of the ventilation on the vehicle research shows that ventilation can maintain the stability of the supercavitating vehicle to study the trajectory characteristics of the vehicle at preset rudder angle cheng et al 2017 carried out many experiments of supercavitating vehicle at the entry angle of 20 the results of the vehicle navigating at the preset rudder angles of 0 and 20 were studied giving the water entry trajectory characteristics in jeong et al 2018 the author used a special device to generate natural and artificial supercavities investigating hydrodynamic forces at different cavitation number which provided a basis for interpreting the cavity stability and hydrodynamic characteristics the model of the supercavitating vehicle is the premise of controller design it is very difficult to model a supercavitating vehicle because of the non linear planing force and memory effect in vanek et al 2006 considering the memory effect the author established a time delay model of the planing of the supercavitating vehicle which provides a basis for future research on the time delay characteristics of the supercavitating vehicle in chuang et al 2017 the author presented a spatial kinetics model of the supercavitating vehicle which includes the coupled motion of pitch yaw and rolling in jiang et al 2012 the author studied the cavitation source term with and without the compressibility of water establishing the complete nature and ventilated cavitation source term model in kim and kim 2015a the author constructed a 6 dof equation of motion and created an integrated dynamic model of a supercavitating vehicle planing force can only pass an empirical equation because the planing force of the supercavitating vehicle is unmeasurable therefore the planing force has strong nonlinearity and time delay characteristics due to the complex shape of the cavity wall and the memory effect which is the biggest problem in the control of the supercavitating vehicle at present in view of the time delay characteristics duan and sun 2011 actuator saturation parameter uncertainty lv et al 2010 kim and kim 2015b and nonlinearity zhang et al 2017 of supercavitation vehicles scholars have designed different controllers to solve the control problems of the supercavitating vehicle a supercavitating vehicle passes through the transition phase from fully wetted to supercavitating operation in order to generate supercavitation where unsteady hydrodynamic forces and moments are created by partial cavity in kim and kim 2015b the author designed a neural network based adaptive control method to deal with unsteady hydrodynamic forces and complex moments during transition phase affected by external ocean currents and waves the supercavitating vehicle is easy to become unstable because of the planing force in phuc et al 2020a the nonlinear robust control synthesis was proposes which can solve the problem of the parameter variations planing force as well as external disturbances considering the problem of the actuator saturation qiang and zhang 2018 proposed a new output feedback control law that locally stabilizes the closed loop system to enlarge the domain of attraction subject to actuator saturation the ventilated cavity can maintain the supercavitating condition to keep the system stable zou et al 2018 in kim and kim 2018 the author proposed a controller to prevent planing force in advance by controlling the cavity size currently most controller do not consider time delay which can easily cause the control performance of the system to decrease or even make the system out of control in hassouneh et al 2009 the author found that the feedback control law of a stable system without time delay was invalid which proved that controllers that did not consider time delay were not suitable for time delay supercavitating systems the controller of the supercavitating vehicle involving time delay has always been the focus of research on supercavitating vehicle in zhao et al 2019 planing mode controllers were presented simulation results on uncertainty system with time delay proved the effectiveness of the control method in duan and sun 2011 feedforward regulator and feedback regulator were designed respectively on the basis of a nonlinear time delay dynamic model compared with other controllers the controller designed in this paper get optimal control law online which can improve the dynamic performance of the system meanwhile the controller can also solve the problems of time delay cavitation perturbation controller constraints and anti interference performance of the supercavitating vehicle in this paper considering the memory effect of the supercavitating vehicle the time delay lpv model of the supercavitating vehicle is established based on this model an h robust predictive controller based on time delay characteristics is designed the main innovations of the algorithm are as follows i the planing force model is decomposed into a time delay part and a non time delay part to solve the time delay problem the nonlinear force is converted into time varying parameters to solve the nonlinear problem ii the control algorithm is improved the variable quadratic function is adopted to reduce the conservativeness of the system considering the time delay characteristics of supercavitating vehicles the use of memory state feedback can simultaneously solve the time delay and nonlinear problems of supercavitating vehicles iii the combination of robust control and predictive control can effectively solve the problems of cavitation radius perturbation vehicle parameter uncertainty and external disturbance which makes the controller have strong robustness 2 supercavitating vehicle models on its longitudinal plane the forces are composed only of the gravity of the vehicle f g the force of the cavitator f c a v the force of the fins f f i n and the planing force of the tail f p l a n e due to the existence of supercavitation phuc et al 2020b assuming that the speed of the vehicle is constant and the vehicle is completely covered by cavitation the following models can be established according to the pitch plane dynamics of the supercavitating vehicle 1 m o d w d t d q d t a o w q b o δ f δ c f g f p l a n e ˆ 1 l d z d t w v θ d θ d t q w represents the longitudinal velocity q denotes the pitch angle velocity θ denotes the pitch angle z represents the depth of the vehicle v denotes the forward velocity of the vehicle δ f is the fins deflection angle δ c represents the cavitation deflection angle l represents the length of the vehicle where m o 7 9 17 36 l 17 l 36 11 16 r 2 133 405 l 2 a o c v n m n m 7 9 c n m n l m 17 36 c b o c v 2 n m l 1 m l n m 0 f g 7 9 17 l 36 g f p l a n e ˆ f p l a n e π ρ m r 2 l v 2 m l 1 h p 1 2 h p 1 r h p r 2 α p f p l a n e π ρ r 2 v 2 1 h p 1 2 h p 1 r h p r 2 α p where h p is immersion depth α p denotes immersion angle m represents the density ratio of the vehicle and the fluid r is the vehicle radius g denotes the acceleration of gravity r c the cavitation radius ρ is the density of water and n represents the effectiveness coefficient of the fins rudder c and r are defined as 2 c 0 5 c x 0 1 σ r n r 2 3 r r c r r σ is the cavitation number r n denotes the cavitator radius c x 0 is the lift coefficient the magnitude of the nonlinear planing force is closely related to the shape of the cavity section and the shape of a certain section of the cavity is related to the motion state of the vehicle at the previous moment we assume that the vertical depth of the head of the vehicle is z t and the depth of the center line of the tail of the vehicle is z t θ l the centerline of the cavity at the head coincides with z 0 because the vehicle is moving at speed v the centerline of the cavity at the tail of the vehicle is the position of the centerline of the head before l v seconds denoted as z t τ where τ l v this characteristic is the memory effect of the cavity and τ is the time delay parameter as a result the cavity distortion caused by the disturbance of the cavitator propagates to the tail with a certain time delay which affects the dynamic behavior of the vehicle by changing the fluid forces and moments on the control surface in hassouneh et al 2013 it was verified the controller considering the time delay is more important for the actual system the immersion depth and immersion angle of the supercavitating vehicle are 4 h p z t θ t l z t τ r r c r b o t t o m c o n t a c t 0 i n s i d e c a v i t y r r c z t θ t l z t τ r t o p c o n t a c t 5 α p θ t θ t τ w t τ r c v b o t t o m c o n t a c t 0 i n s i d e c a v i t y θ t θ t τ w t τ r c v t o p c o n t a c t 6 b o t t o m c o n t a c t r c r z t θ t l z t τ i n s i d e c a v i t y o t h e r w i s e t o p c o n t a c t r r c z t θ t l z t τ r c denotes the contraction rate of the cavity at the planing location where k 1 l r n 1 92 σ 3 1 1 k 2 1 1 4 5 σ 1 σ k 1 40 17 1 2 r c 20 19 0 82 1 σ σ 1 2 v 1 4 5 σ 1 σ k 1 23 17 k 2 1 92 σ 3 r c r n 0 82 1 σ σ 1 2 k 2 meanwhile define some parameters as follows 7 γ 1 1 h p 1 2 h p 1 r h p r 2 8 γ 2 r c v b o t t o m c o n t a c t 0 i n s i d e c a v i t y r c v t o p c o n t a c t 9 γ 3 z t θ t l z t τ 10 π 1 v 2 m l γ 1 π 2 γ 2 γ 3 π 3 π 1 π 2 according to the phuc et al 2020a the planing force of the supercavitating vehicle can be decomposed as follows 11 f p l a n e ˆ v 2 m l 1 h p 1 2 h p 1 r r h p 2 α p π 1 θ t θ t τ w t τ v γ 2 π 1 θ t θ t τ w t τ v π 3 z t θ t l z t τ decompose it into vector form as 12 f p l a n e ˆ π 3 0 π 1 π 3 l 0 t z t w t θ t q t π 3 π 1 v π 1 0 t z t τ w t τ θ t τ q t τ we can know that 13 f p l a n e ˆ 1 l π 3 z t π 1 π 3 l θ t π 3 l z t π 1 π 3 l l θ t π 3 z t τ π 1 v w t τ π 1 θ t τ π 3 l z t τ π 1 v l w t τ π 1 l θ t τ π 3 π 1 π 3 l π 3 l π 1 π 3 l l z t θ t π 3 π 1 v π 1 π 3 l π 1 v l π 1 l z t τ w t τ θ t τ model 1 can be given in the following form 14 m 0 d w d t d q d t a 0 w q b 0 δ f δ c f g c 0 z θ d 0 z τ w τ θ τ d z d t w v θ d θ d t q where z τ w τ θ τ are the state variables before τ s 15 c 0 π 3 π 1 π 3 l π 3 l π 1 l π 3 l 2 16 d 0 π 3 π 1 v π 1 π 3 l π 1 l v π 1 l according to 14 the time delay lpv model of the supercavitating vehicle 17 x t a π 1 π 3 x t a d π 1 π 3 x t τ b π 1 π 3 u 0 t g d ξ t y t c x t where x t τ z t τ w t τ θ t τ q t τ which represents the state variable with delay of τ x t z t w t θ t q t t is the state variable and u 0 δ f δ c t is control variable b c g d are constant matrices a π 1 π 3 and a d π 1 π 3 denote time varying matrices with π 1 and π 3 parameters ξ k r n ξ k f is uncertain but bounded external interference signal according to the standard parameters given in dzielski and kurdila 2003 as shown in table 1 the coefficients in eq 17 can be calculated as 18 a π 1 π 3 0 1 75 0 4 41 π 1 15 30 4 41 π 1 1 8 π 3 79 94 0 0 0 1 5 52 π 1 13 27 5 52 π 1 1 8 π 3 0 a d π 1 π 3 0 0 0 0 4 41 π 3 4 41 π 1 0 0589 π 1 0 0 0 0 0 5 52 π 3 5 52 π 1 0 0696 π 1 0 g 0 9 81 0 0 d 0 0 0 5 0 0 0 0 0 5 c 1 0 0 0 define the following transformation 19 u 0 u u 1 u 1 b 1 π 1 π 3 g then substitute equation 19 into eq 17 the supercavitating vehicle model can be expressed as 20 x t a π 1 π 3 x t a d π 1 π 3 x t τ b π 1 π 3 u t d ξ t y t c x t if we assume that π 1 and π 3 are independent the supercavitating vehicle model in eqs 20 becomes a time delay lpv system that has affine dependence on the scheduling parameters π 1 and π 3 3 h robust predictive control assuming that the density ratio of the vehicle and the fluid m has 1 5 up down perturbation due to the density of the external environment and fuel consumption then 1 m also has 1 5 up down perturbation the perturbation matrix corresponding to the vehicle is 21 δ a m i 1 c v δ 1 m n l δ 1 m n δ 1 m n δ 1 m n l 22 δ b m i 1 c v 2 δ 1 m n l δ 1 m 1 l δ 1 m n 0 where δ a and δ b are the uncertain parameter matrix of the system the continuous time delay lpv system 20 of supercavitating can be described as the following discrete form feng et al 2019 23 x k 1 a k δ a x k a d k x k d b δ b u k d ξ k y k c x k a k a d k ω ω c o a 1 a d 1 a 2 a d 2 a i a d i c o represents the convex hull sign and the d term represents time delay in discrete form no matter how the time varying parameters a k and a d k change they will eventually fall on the convex polyhedron with a 1 a d 1 a 2 a d 2 a i a d i as the vertices the vertices forms convex polyhedron area ω time varying parameters a k and a d k can be expressed as 24 a k a d k b i 1 4 η i a i a d i b i 1 4 η i 1 η i 0 where η i is a set of non negative real numbers the method is called linear parameter varying uncertain system described by polytope according to 7 and 10 we can know 25 lim h p π 1 v 2 m therefore parameter π 1 is greater than zero and is bounded the relationship between π 1 and h p is as shown in fig 1 when the perturbation of cavitation radius is 20 since the immersion depth of the vehicle is bounded during actual navigation π 1 cannot reach the maximum value therefore assuming that the maximum depth of immersion depth is 0 1 m the value range of π 1 is π 1 0 497 84 according to 8 10 we know that the value of parameter π 2 can intuitively reflect the change of perturbation r c when the vehicle is in contact with the cavity wall since the signs of the parameters γ 2 and γ 3 are consistent they must be greater than zero therefore the value range of π 2 can be expressed by the following equation 26 0 π 2 r c v r c r fig 2 shows the relation curve between π 2 and γ 3 it can be seen from 26 and fig 2 that the value of π 2 will also change when the cavity radius is perturbed the calculated value of the cavity radius is different from the actual value due to external disturbances ocean currents and other factors therefore the value of π 3 π 1 π 2 and π 3 0 729 38 when the perturbation of cavitation radius is 20 h performance given the upper bound γ 2 the transfer t y ξ function between external disturbance ξ k and system output y k satisfies 27 t y ξ sup σ max t y ξ λ 2 which is equivalent to 28 k 0 y t k y k λ 2 2 ξ t k ξ k 0 3 1 controller design according to kim and kim 2015b this section designs the h predictive controller of the supercavitating time delay lpv model in the infinite horizon it can be expressed as the following mini max optimal solution problem 29 min u k i k i 0 max a k i a d k i ω i 0 j k i 0 x k i k q u k i k r s t x k i 1 a k i δ a x k i k a d k i d x k i d k b δ b u k i k d ξ k i k i 0 y k i k c x k i k k i 0 u k i k 2 u max k i 0 x k k x k this equation indicates that the worst case infinite horizon performance index of the parameter changing within ω is the best when performing rolling optimization q and r are identity matrices u max represents the maximum input parameter for the following quadratic function 30 v x k i k x t k i k p k i x k i k j 1 d x t k i j k p d x k i j k where p k i p d 0 for any x and u let the quadratic function satisfy 31 v x k i 1 v x k i k x t k i k q x k i k u t k i k r u k i k the equation is accumulated from zero to infinity to get 32 v x k k j k from this we can get the upper bound of the maximum problem 33 max a k i a d k i ω i 0 j k v x k k therefore it is only necessary to find a constant λ k that is as small as possible to satisfy v x k k λ k we order p k i λ k q 1 k i p d λ k k d 1 then the requirement can be transformed into the form of the following inequality 34 λ k x t k i k q k i x k i k j 1 d x t k i j k k d x k i j k λ k according to 23 and 24 we can know 36 q k i i 1 4 η i k i q i i 1 4 η i k i 1 η i k i 0 k d i 1 4 η i k i k d i i 1 4 η i k i 1 η i k i 0 using schur complement lemma it can be converted into the following lmi form 37 1 x t k k x t k 1 k x t k d k q i 0 0 k d i 0 k d i 0 we adopt the following memory state feedback weiwei et al 2019 to replace the infinite variation of the system because there are infinite number of control variables in the infinite horizon 38 u k i k k 1 x k i k k 2 x k i d k through the above processing the problems of minimal maximum optimization and infinite control amount are solved the quadratic function is transformed as follows to meet the h performance of the system 39 v x k i 1 v x k i k x t k i k q x k i k u t k i k r u k i k x k i x k i d ξ k i t s 1 x k i x k i d ξ k i λ 2 2 ξ t k i ξ k i y t k y k x t k i d p d x k i d x t k i p d x k i x t k i d p d x k i d where s 1 ψ 1 ψ 2 ψ 3 ψ 4 ψ 5 ψ 6 ψ 7 ψ 8 d t d λ 2 2 i ψ 1 λ k a k δ a b δ b k 1 q 1 k i 1 q 1 k i q k 1 t r k 1 c t c ψ 2 λ k a k δ a b δ b k 1 t q 1 k i 1 a d k b δ b k 2 k d 1 k 1 t r k 2 ψ 3 λ k a k δ a b δ b k 1 t q 1 k i 1 d ψ 4 λ k a d k b δ b k 2 t q 1 k i 1 a k δ a b δ b k 1 k 2 t r k 1 ψ 5 λ k a d k b δ b k 2 q 1 k i 1 k d 1 k 2 t r k 2 ψ 6 λ k a d k b δ b k 2 t q 1 k i 1 d ψ 7 λ k d t q 1 k i 1 a k δ a b δ b k 1 ψ 8 λ k d t q 1 k i 1 a d k b δ b k 2 theorem 1 for the system 23 if s 1 0 p d p k i are met the system meets h performance proof of theorem 1 let both sides of the 39 accumulate from zero to infinity 40 v x k k i 0 x k i k q u k i k r i 0 x k i x k i d ξ k i t s 1 x k i x k i d ξ k i i 0 λ 2 2 ξ t k i ξ k i y t k y k i 1 d x t k i d p d x k i d i 0 x t k i d p d x k i d due to s 1 0 p d p k i we have 41 x k k p k i 0 x k i d k p d i 0 x k i k q u k i k r i 0 x k i x k i d ξ k i t s 1 x k i x k i d ξ k i i 0 λ 2 2 ξ t k i ξ k i y t k y k the left side of the equation is positive if we want to ensure that the equation is true then 42 i 0 λ 2 2 ξ t k i ξ k i y t k y k 0 must be true then the system must meet the h performance of the system for the two system uncertainty parameter matrices δ a and δ b the uncertainty of the system parameters can be expressed as 43 δ a δ b h f k e a e b where e a e b and h are known matrices with appropriate dimensions f k is a time varying matrix and satisfies 44 f t k f k i therefore s 1 0 can be converted into the following form 45 ψ 1 k 1 t r k 2 0 a k b k 1 t ψ 2 k 2 t r k 2 0 a d k b k 2 t 0 0 λ 2 2 d t ψ 3 a d k b k 2 d λ 1 k q k i 1 0 0 0 δ a k δ b k 1 t 0 0 0 δ b k 2 t 0 0 0 0 δ a k δ b k 1 δ b k 2 0 0 0 ψ 1 λ k q 1 k i q k 1 t r k 1 c t c ψ 2 k 1 t r k 2 ψ 3 a k b k 1 lemma 1 let m and e be matrices of known suitable dimensions w is a symmetric matrix f k satisfies 46 f t k f k i if there is a parameter β 0 and the inequality w β m m t β 1 e t e 0 is guaranteed then w m f e e t f t m t 0 holds according lemma 1 we can get 47 ψ 1 k 1 t r k 2 0 a k b k 1 t ψ 2 k 2 t r k 2 k d 1 0 a d k b k 2 t 0 0 λ 2 2 d t ψ 3 a d k b k 2 d λ 1 k q k i 1 β 0 0 0 h 0 0 0 h β 1 e a e b k 1 e b k 2 0 0 e a e b k 1 t e b k 2 t 0 0 0 ψ 1 λ k q 1 k i q k 1 t r k 1 c t c ψ 2 k 1 t r k 2 ψ 3 a k b k 1 make k 1 y 1 e 1 1 k 2 y 2 e 2 1 according to schur complement lemma s 1 0 is equivalent to 48 ψ 1 0 0 a i e 1 b y 1 t e a e 1 e b y 1 t 0 0 a d i e 2 b y 2 t e b y 2 t λ 3 λ d t 0 q i β h h t 0 β y 1 t r 1 2 e 1 t q 1 2 0 c e 1 t y 2 t r 1 2 0 e 2 t 0 0 0 0 0 0 0 0 0 0 0 0 0 λ i 0 0 0 λ i 0 0 k d i 0 λ i 0 ψ 1 e 1 e 1 t q i where λ 3 λ λ 2 2 p d p k i is equivalent to k d i q i the matrix inequality q k d is the unknown symmetric matrix at time k considering the constraints of the control quantity the following conversion can be made according to the state feedback matrix 49 u k i k 2 2 k 1 x k i k k 2 x k i d k 2 2 x k i k x k i d k t q 1 k i t y 1 t y 1 q 1 q 1 k i t y 1 t y 2 k d 1 k d 1 t y 2 t y 1 q 1 k d 1 t y 2 t y 2 k d 1 x k i k x k i d k u max 2 it can be obtained that the constraint conditions are established only if the following condition is met 50 1 u max 2 y 1 t y 1 y 1 t y 2 y 2 t y 1 y 2 t y 2 e 1 t q 1 k i e 1 0 0 e 2 t k d 1 e 2 it can be converted into the following lmi form according to schur complement lemma 51 u max 2 y 1 y 2 y 2 t e 1 e 1 t q i 0 y 1 t 0 e 2 e 2 t k d i 0 after the above processing the minimal maximum problem can be converted into an on line optimization problem 52 min λ 3 q y 1 y 2 k d λ s t 26 29 30 31 through on line optimization the q k d y 1 y 2 matrices that satisfies four constraint conditions of eqs 37 48 49 51 is solved so that λ is as small as possible from the solved matrices q k d y 1 y 2 the feedback matrix and the time delay feedback matrix can be calculated according to the control laws the h performance index can be obtained 4 simulation analysis in this paper we simulate and analyze the h robust predictive controller designed in this paper to verify the stability robustness and anti disturbance performance of the controller the system control constraint is 50 50 the time delay for the simulation is τ l v 0 024 s q and r are identity matrices the initial state of the vehicle is z 0 w 0 θ 0 q 0 t 0 0 0 0 t and the reference signal of the system is set to z r w r θ r q r t 1 0 0 0 t the error signal of the system is set to x e r x the sampling time of the system is set to t 0 008 s the external disturbance is set to ξ k 4 cos 8 π t 0 0 4 cos 8 π t when m is perturbed the discrete form of the perturbation matrix corresponding to δ a and δ b satisfies δ a 2 0 0171 and δ b 2 0 1562 therefore we can get e a i 4 4 0 4 6 t e b 0 2 8 i 2 2 t h 0 0171 i 4 4 0 1562 0 2 2 i 2 2 by substituting the known parameter matrices into the linear matrix inequalities 52 the matrices y 1 y 2 q k d at each sampling time can be obtained according to k 1 y 1 e 1 1 and k 2 y 2 e 2 1 the optimal state feedback control law can be obtained as shown in fig 3 the dotted line is the reference signal the solid line is the model predictive controller mpc designed in the paper and the dashed line is the model predictive controller with invariable quadratic function impc the supercavitating vehicle reaches a stable state in about 0 5 s and has no overshoot the supercavitating vehicle under the control of mpc produces less planing force and the deflection angle of the fins and cavitation of the system is smaller so the controller designed in this paper has better stability performance the depth curve of the mpc controller under external disturbances is more stable there is no obvious oscillation after stability the h performance index of mpc is smaller than impc therefore mpc can better suppress external interference fig 4 shows the step response curve when the cavity radius of the supercavitating vehicle is perturbed the dashed line is the reference signal the solid line is the response curve when the cavity radius is not perturbed the dot dash line is the response curve when the cavity radius is perturbed down by 20 and the dotted line is the response curve when the cavity radius is perturbed up by 20 it can be seen from fig 4 that the system can quickly reach a stable state when the cavitation radius is perturbed and the system has no overshoot therefore the system has strong robustness in the case of cavitation perturbation because the cavitation radius decreases when the cavitation radius is perturbed downward the tail of the vehicle is more likely to collide with the cavitation wall so the vehicle will produce greater planing force when the cavitation radius is perturbed downward in order to verify the robustness of the robust predictive controller when the system parameters are perturbed the system when m is taken as the maximum and minimum is simulated the solid line is the system response curve without perturbation the dot dash line is the system response curve with downward perturbation of 1 5 and the dotted line is the system response curve with upward perturbation of 1 5 it can be seen from fig 5 that the system can quickly reach the stable state when perturbed the system has no overshoot the system settling time is large when perturbed the state variable of the vehicle has small oscillation under external disturbance meanwhile the three curves have no obvious difference which proves that the vehicle still has strong robustness under the condition of system parameter perturbation 5 conclusion in the paper the time delay lpv model of supercavitating vehicle is established by decomposing the planing force considering that the radius of cavity is easily affected by external interference the supercavitating vehicle model described by polytope is established which can effectively solve the problem of cavity radius perturbation and improve the robust performance of the system based on the model an h robust predictive controller is designed based on time delay characteristics the algorithm uses memory feedback to solve the problem of time delay and uses h control algorithm to solve the problem of external interference meanwhile considering controller constraints we improve the controller algorithm to limit the range of control variable the simulation results show that the controller has strong robustness and anti interference ability and can effectively limit the range of control variable credit authorship contribution statement yuntao han conceptualization methodology software zhen xu software validation writing original draft hao guo validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national natural science foundation of china under grant 51209049 and heilongjiang provincial natural science foundation of china under grant e2017015 
20332,supercavitating vehicle can realize high speed underwater sailing however the nonlinear force and time delay characteristics caused by the tail flapping the cavity wall become the main challenge of the vehicle controller design aiming at time delay characteristics the nonlinear of planing force cavity radius perturbation and parameter uncertainty the paper establishes a time delay linear parameter varying lpv model and designs a robust predictive controller with anti interference performance in the process of predictive controller design the variable quadratic function is used to achieve the robustness of the vehicle and reduce the conservatism of the controller design meanwhile the memory state feedback is used to solve the problems of cavitation radius perturbation control constraints vehicle parameter uncertainty and external disturbance the simulation results show that the controller has strong robustness against the disturbance of external parameters and can guarantee the stability of the system keywords supercavitating vehicle robust predictive control time delay characteristics h control parameter uncertainty 1 introduction supercavitation is a natural phenomenon supercavitation will arise on the surface of the vehicle when the speed of underwater vehicle reaches a certain range the reduction of the contact area with water will reduce the friction resistance of the vehicle by 90 ceccio and steven 2010 storm torpedo of russia and barracuda torpedo of germany all adopt the supercavitation technology the speed of storm torpedo can reach 120 m s and supercavitating projectile can even reach 1500 m s jenkins and evans 2004 presently supercavitating technology has been highly valued by many countries researchers in various countries have carried out a lot of experimental research on supercavitating vehicles ishchenko et al 2020c developed a mathematical model of a shot from a smoothbore ballistic installation for a gun start of a group of supercavitating strikers and to verify the mathematical model experimental investigations into high velocity launching of a group of bodies on a hydroballistic testing facility have been conducted in ishchenko et al 2020b a they also considered the motion characteristics of one and two supercavitating impactors entering the water simultaneously at a speed exceeding the speed of sound in the medium and developed a calculation program to simulate the possible deviation of the impactor movement in the water in order to verify the performance of the theoretically designed control method in actual fluid conditions sanabria et al 2015 designed a dynamic test bed and built a freely rotating small scale ultra high speed vehicle model in the high speed water tunnel located at the st anthony falls laboratory safl university of minnesota minneapolis mn usa based on this test platform they completed the following work proposed a cost effective and low complexity supercavitating vehicle model and controller test method and used this method to evaluate the effect of fluid disturbance on the cavitator and fins in mansour et al 2020 researchers have done some research on the supercavitating flow of different shapes of cavitators rojas et al 2019 have developed a new method to quantify the time to obtain a supercavitating flow at the nozzle outlet numerical simulations have been conducted to study the delay between the onset of the jet pulse and the onset of supercavitation at the orifice of the micro nozzle in chen et al 2019 the author analyzed the data under ventilation and non ventilation conditions in detail studying the effect of the ventilation on the vehicle research shows that ventilation can maintain the stability of the supercavitating vehicle to study the trajectory characteristics of the vehicle at preset rudder angle cheng et al 2017 carried out many experiments of supercavitating vehicle at the entry angle of 20 the results of the vehicle navigating at the preset rudder angles of 0 and 20 were studied giving the water entry trajectory characteristics in jeong et al 2018 the author used a special device to generate natural and artificial supercavities investigating hydrodynamic forces at different cavitation number which provided a basis for interpreting the cavity stability and hydrodynamic characteristics the model of the supercavitating vehicle is the premise of controller design it is very difficult to model a supercavitating vehicle because of the non linear planing force and memory effect in vanek et al 2006 considering the memory effect the author established a time delay model of the planing of the supercavitating vehicle which provides a basis for future research on the time delay characteristics of the supercavitating vehicle in chuang et al 2017 the author presented a spatial kinetics model of the supercavitating vehicle which includes the coupled motion of pitch yaw and rolling in jiang et al 2012 the author studied the cavitation source term with and without the compressibility of water establishing the complete nature and ventilated cavitation source term model in kim and kim 2015a the author constructed a 6 dof equation of motion and created an integrated dynamic model of a supercavitating vehicle planing force can only pass an empirical equation because the planing force of the supercavitating vehicle is unmeasurable therefore the planing force has strong nonlinearity and time delay characteristics due to the complex shape of the cavity wall and the memory effect which is the biggest problem in the control of the supercavitating vehicle at present in view of the time delay characteristics duan and sun 2011 actuator saturation parameter uncertainty lv et al 2010 kim and kim 2015b and nonlinearity zhang et al 2017 of supercavitation vehicles scholars have designed different controllers to solve the control problems of the supercavitating vehicle a supercavitating vehicle passes through the transition phase from fully wetted to supercavitating operation in order to generate supercavitation where unsteady hydrodynamic forces and moments are created by partial cavity in kim and kim 2015b the author designed a neural network based adaptive control method to deal with unsteady hydrodynamic forces and complex moments during transition phase affected by external ocean currents and waves the supercavitating vehicle is easy to become unstable because of the planing force in phuc et al 2020a the nonlinear robust control synthesis was proposes which can solve the problem of the parameter variations planing force as well as external disturbances considering the problem of the actuator saturation qiang and zhang 2018 proposed a new output feedback control law that locally stabilizes the closed loop system to enlarge the domain of attraction subject to actuator saturation the ventilated cavity can maintain the supercavitating condition to keep the system stable zou et al 2018 in kim and kim 2018 the author proposed a controller to prevent planing force in advance by controlling the cavity size currently most controller do not consider time delay which can easily cause the control performance of the system to decrease or even make the system out of control in hassouneh et al 2009 the author found that the feedback control law of a stable system without time delay was invalid which proved that controllers that did not consider time delay were not suitable for time delay supercavitating systems the controller of the supercavitating vehicle involving time delay has always been the focus of research on supercavitating vehicle in zhao et al 2019 planing mode controllers were presented simulation results on uncertainty system with time delay proved the effectiveness of the control method in duan and sun 2011 feedforward regulator and feedback regulator were designed respectively on the basis of a nonlinear time delay dynamic model compared with other controllers the controller designed in this paper get optimal control law online which can improve the dynamic performance of the system meanwhile the controller can also solve the problems of time delay cavitation perturbation controller constraints and anti interference performance of the supercavitating vehicle in this paper considering the memory effect of the supercavitating vehicle the time delay lpv model of the supercavitating vehicle is established based on this model an h robust predictive controller based on time delay characteristics is designed the main innovations of the algorithm are as follows i the planing force model is decomposed into a time delay part and a non time delay part to solve the time delay problem the nonlinear force is converted into time varying parameters to solve the nonlinear problem ii the control algorithm is improved the variable quadratic function is adopted to reduce the conservativeness of the system considering the time delay characteristics of supercavitating vehicles the use of memory state feedback can simultaneously solve the time delay and nonlinear problems of supercavitating vehicles iii the combination of robust control and predictive control can effectively solve the problems of cavitation radius perturbation vehicle parameter uncertainty and external disturbance which makes the controller have strong robustness 2 supercavitating vehicle models on its longitudinal plane the forces are composed only of the gravity of the vehicle f g the force of the cavitator f c a v the force of the fins f f i n and the planing force of the tail f p l a n e due to the existence of supercavitation phuc et al 2020b assuming that the speed of the vehicle is constant and the vehicle is completely covered by cavitation the following models can be established according to the pitch plane dynamics of the supercavitating vehicle 1 m o d w d t d q d t a o w q b o δ f δ c f g f p l a n e ˆ 1 l d z d t w v θ d θ d t q w represents the longitudinal velocity q denotes the pitch angle velocity θ denotes the pitch angle z represents the depth of the vehicle v denotes the forward velocity of the vehicle δ f is the fins deflection angle δ c represents the cavitation deflection angle l represents the length of the vehicle where m o 7 9 17 36 l 17 l 36 11 16 r 2 133 405 l 2 a o c v n m n m 7 9 c n m n l m 17 36 c b o c v 2 n m l 1 m l n m 0 f g 7 9 17 l 36 g f p l a n e ˆ f p l a n e π ρ m r 2 l v 2 m l 1 h p 1 2 h p 1 r h p r 2 α p f p l a n e π ρ r 2 v 2 1 h p 1 2 h p 1 r h p r 2 α p where h p is immersion depth α p denotes immersion angle m represents the density ratio of the vehicle and the fluid r is the vehicle radius g denotes the acceleration of gravity r c the cavitation radius ρ is the density of water and n represents the effectiveness coefficient of the fins rudder c and r are defined as 2 c 0 5 c x 0 1 σ r n r 2 3 r r c r r σ is the cavitation number r n denotes the cavitator radius c x 0 is the lift coefficient the magnitude of the nonlinear planing force is closely related to the shape of the cavity section and the shape of a certain section of the cavity is related to the motion state of the vehicle at the previous moment we assume that the vertical depth of the head of the vehicle is z t and the depth of the center line of the tail of the vehicle is z t θ l the centerline of the cavity at the head coincides with z 0 because the vehicle is moving at speed v the centerline of the cavity at the tail of the vehicle is the position of the centerline of the head before l v seconds denoted as z t τ where τ l v this characteristic is the memory effect of the cavity and τ is the time delay parameter as a result the cavity distortion caused by the disturbance of the cavitator propagates to the tail with a certain time delay which affects the dynamic behavior of the vehicle by changing the fluid forces and moments on the control surface in hassouneh et al 2013 it was verified the controller considering the time delay is more important for the actual system the immersion depth and immersion angle of the supercavitating vehicle are 4 h p z t θ t l z t τ r r c r b o t t o m c o n t a c t 0 i n s i d e c a v i t y r r c z t θ t l z t τ r t o p c o n t a c t 5 α p θ t θ t τ w t τ r c v b o t t o m c o n t a c t 0 i n s i d e c a v i t y θ t θ t τ w t τ r c v t o p c o n t a c t 6 b o t t o m c o n t a c t r c r z t θ t l z t τ i n s i d e c a v i t y o t h e r w i s e t o p c o n t a c t r r c z t θ t l z t τ r c denotes the contraction rate of the cavity at the planing location where k 1 l r n 1 92 σ 3 1 1 k 2 1 1 4 5 σ 1 σ k 1 40 17 1 2 r c 20 19 0 82 1 σ σ 1 2 v 1 4 5 σ 1 σ k 1 23 17 k 2 1 92 σ 3 r c r n 0 82 1 σ σ 1 2 k 2 meanwhile define some parameters as follows 7 γ 1 1 h p 1 2 h p 1 r h p r 2 8 γ 2 r c v b o t t o m c o n t a c t 0 i n s i d e c a v i t y r c v t o p c o n t a c t 9 γ 3 z t θ t l z t τ 10 π 1 v 2 m l γ 1 π 2 γ 2 γ 3 π 3 π 1 π 2 according to the phuc et al 2020a the planing force of the supercavitating vehicle can be decomposed as follows 11 f p l a n e ˆ v 2 m l 1 h p 1 2 h p 1 r r h p 2 α p π 1 θ t θ t τ w t τ v γ 2 π 1 θ t θ t τ w t τ v π 3 z t θ t l z t τ decompose it into vector form as 12 f p l a n e ˆ π 3 0 π 1 π 3 l 0 t z t w t θ t q t π 3 π 1 v π 1 0 t z t τ w t τ θ t τ q t τ we can know that 13 f p l a n e ˆ 1 l π 3 z t π 1 π 3 l θ t π 3 l z t π 1 π 3 l l θ t π 3 z t τ π 1 v w t τ π 1 θ t τ π 3 l z t τ π 1 v l w t τ π 1 l θ t τ π 3 π 1 π 3 l π 3 l π 1 π 3 l l z t θ t π 3 π 1 v π 1 π 3 l π 1 v l π 1 l z t τ w t τ θ t τ model 1 can be given in the following form 14 m 0 d w d t d q d t a 0 w q b 0 δ f δ c f g c 0 z θ d 0 z τ w τ θ τ d z d t w v θ d θ d t q where z τ w τ θ τ are the state variables before τ s 15 c 0 π 3 π 1 π 3 l π 3 l π 1 l π 3 l 2 16 d 0 π 3 π 1 v π 1 π 3 l π 1 l v π 1 l according to 14 the time delay lpv model of the supercavitating vehicle 17 x t a π 1 π 3 x t a d π 1 π 3 x t τ b π 1 π 3 u 0 t g d ξ t y t c x t where x t τ z t τ w t τ θ t τ q t τ which represents the state variable with delay of τ x t z t w t θ t q t t is the state variable and u 0 δ f δ c t is control variable b c g d are constant matrices a π 1 π 3 and a d π 1 π 3 denote time varying matrices with π 1 and π 3 parameters ξ k r n ξ k f is uncertain but bounded external interference signal according to the standard parameters given in dzielski and kurdila 2003 as shown in table 1 the coefficients in eq 17 can be calculated as 18 a π 1 π 3 0 1 75 0 4 41 π 1 15 30 4 41 π 1 1 8 π 3 79 94 0 0 0 1 5 52 π 1 13 27 5 52 π 1 1 8 π 3 0 a d π 1 π 3 0 0 0 0 4 41 π 3 4 41 π 1 0 0589 π 1 0 0 0 0 0 5 52 π 3 5 52 π 1 0 0696 π 1 0 g 0 9 81 0 0 d 0 0 0 5 0 0 0 0 0 5 c 1 0 0 0 define the following transformation 19 u 0 u u 1 u 1 b 1 π 1 π 3 g then substitute equation 19 into eq 17 the supercavitating vehicle model can be expressed as 20 x t a π 1 π 3 x t a d π 1 π 3 x t τ b π 1 π 3 u t d ξ t y t c x t if we assume that π 1 and π 3 are independent the supercavitating vehicle model in eqs 20 becomes a time delay lpv system that has affine dependence on the scheduling parameters π 1 and π 3 3 h robust predictive control assuming that the density ratio of the vehicle and the fluid m has 1 5 up down perturbation due to the density of the external environment and fuel consumption then 1 m also has 1 5 up down perturbation the perturbation matrix corresponding to the vehicle is 21 δ a m i 1 c v δ 1 m n l δ 1 m n δ 1 m n δ 1 m n l 22 δ b m i 1 c v 2 δ 1 m n l δ 1 m 1 l δ 1 m n 0 where δ a and δ b are the uncertain parameter matrix of the system the continuous time delay lpv system 20 of supercavitating can be described as the following discrete form feng et al 2019 23 x k 1 a k δ a x k a d k x k d b δ b u k d ξ k y k c x k a k a d k ω ω c o a 1 a d 1 a 2 a d 2 a i a d i c o represents the convex hull sign and the d term represents time delay in discrete form no matter how the time varying parameters a k and a d k change they will eventually fall on the convex polyhedron with a 1 a d 1 a 2 a d 2 a i a d i as the vertices the vertices forms convex polyhedron area ω time varying parameters a k and a d k can be expressed as 24 a k a d k b i 1 4 η i a i a d i b i 1 4 η i 1 η i 0 where η i is a set of non negative real numbers the method is called linear parameter varying uncertain system described by polytope according to 7 and 10 we can know 25 lim h p π 1 v 2 m therefore parameter π 1 is greater than zero and is bounded the relationship between π 1 and h p is as shown in fig 1 when the perturbation of cavitation radius is 20 since the immersion depth of the vehicle is bounded during actual navigation π 1 cannot reach the maximum value therefore assuming that the maximum depth of immersion depth is 0 1 m the value range of π 1 is π 1 0 497 84 according to 8 10 we know that the value of parameter π 2 can intuitively reflect the change of perturbation r c when the vehicle is in contact with the cavity wall since the signs of the parameters γ 2 and γ 3 are consistent they must be greater than zero therefore the value range of π 2 can be expressed by the following equation 26 0 π 2 r c v r c r fig 2 shows the relation curve between π 2 and γ 3 it can be seen from 26 and fig 2 that the value of π 2 will also change when the cavity radius is perturbed the calculated value of the cavity radius is different from the actual value due to external disturbances ocean currents and other factors therefore the value of π 3 π 1 π 2 and π 3 0 729 38 when the perturbation of cavitation radius is 20 h performance given the upper bound γ 2 the transfer t y ξ function between external disturbance ξ k and system output y k satisfies 27 t y ξ sup σ max t y ξ λ 2 which is equivalent to 28 k 0 y t k y k λ 2 2 ξ t k ξ k 0 3 1 controller design according to kim and kim 2015b this section designs the h predictive controller of the supercavitating time delay lpv model in the infinite horizon it can be expressed as the following mini max optimal solution problem 29 min u k i k i 0 max a k i a d k i ω i 0 j k i 0 x k i k q u k i k r s t x k i 1 a k i δ a x k i k a d k i d x k i d k b δ b u k i k d ξ k i k i 0 y k i k c x k i k k i 0 u k i k 2 u max k i 0 x k k x k this equation indicates that the worst case infinite horizon performance index of the parameter changing within ω is the best when performing rolling optimization q and r are identity matrices u max represents the maximum input parameter for the following quadratic function 30 v x k i k x t k i k p k i x k i k j 1 d x t k i j k p d x k i j k where p k i p d 0 for any x and u let the quadratic function satisfy 31 v x k i 1 v x k i k x t k i k q x k i k u t k i k r u k i k the equation is accumulated from zero to infinity to get 32 v x k k j k from this we can get the upper bound of the maximum problem 33 max a k i a d k i ω i 0 j k v x k k therefore it is only necessary to find a constant λ k that is as small as possible to satisfy v x k k λ k we order p k i λ k q 1 k i p d λ k k d 1 then the requirement can be transformed into the form of the following inequality 34 λ k x t k i k q k i x k i k j 1 d x t k i j k k d x k i j k λ k according to 23 and 24 we can know 36 q k i i 1 4 η i k i q i i 1 4 η i k i 1 η i k i 0 k d i 1 4 η i k i k d i i 1 4 η i k i 1 η i k i 0 using schur complement lemma it can be converted into the following lmi form 37 1 x t k k x t k 1 k x t k d k q i 0 0 k d i 0 k d i 0 we adopt the following memory state feedback weiwei et al 2019 to replace the infinite variation of the system because there are infinite number of control variables in the infinite horizon 38 u k i k k 1 x k i k k 2 x k i d k through the above processing the problems of minimal maximum optimization and infinite control amount are solved the quadratic function is transformed as follows to meet the h performance of the system 39 v x k i 1 v x k i k x t k i k q x k i k u t k i k r u k i k x k i x k i d ξ k i t s 1 x k i x k i d ξ k i λ 2 2 ξ t k i ξ k i y t k y k x t k i d p d x k i d x t k i p d x k i x t k i d p d x k i d where s 1 ψ 1 ψ 2 ψ 3 ψ 4 ψ 5 ψ 6 ψ 7 ψ 8 d t d λ 2 2 i ψ 1 λ k a k δ a b δ b k 1 q 1 k i 1 q 1 k i q k 1 t r k 1 c t c ψ 2 λ k a k δ a b δ b k 1 t q 1 k i 1 a d k b δ b k 2 k d 1 k 1 t r k 2 ψ 3 λ k a k δ a b δ b k 1 t q 1 k i 1 d ψ 4 λ k a d k b δ b k 2 t q 1 k i 1 a k δ a b δ b k 1 k 2 t r k 1 ψ 5 λ k a d k b δ b k 2 q 1 k i 1 k d 1 k 2 t r k 2 ψ 6 λ k a d k b δ b k 2 t q 1 k i 1 d ψ 7 λ k d t q 1 k i 1 a k δ a b δ b k 1 ψ 8 λ k d t q 1 k i 1 a d k b δ b k 2 theorem 1 for the system 23 if s 1 0 p d p k i are met the system meets h performance proof of theorem 1 let both sides of the 39 accumulate from zero to infinity 40 v x k k i 0 x k i k q u k i k r i 0 x k i x k i d ξ k i t s 1 x k i x k i d ξ k i i 0 λ 2 2 ξ t k i ξ k i y t k y k i 1 d x t k i d p d x k i d i 0 x t k i d p d x k i d due to s 1 0 p d p k i we have 41 x k k p k i 0 x k i d k p d i 0 x k i k q u k i k r i 0 x k i x k i d ξ k i t s 1 x k i x k i d ξ k i i 0 λ 2 2 ξ t k i ξ k i y t k y k the left side of the equation is positive if we want to ensure that the equation is true then 42 i 0 λ 2 2 ξ t k i ξ k i y t k y k 0 must be true then the system must meet the h performance of the system for the two system uncertainty parameter matrices δ a and δ b the uncertainty of the system parameters can be expressed as 43 δ a δ b h f k e a e b where e a e b and h are known matrices with appropriate dimensions f k is a time varying matrix and satisfies 44 f t k f k i therefore s 1 0 can be converted into the following form 45 ψ 1 k 1 t r k 2 0 a k b k 1 t ψ 2 k 2 t r k 2 0 a d k b k 2 t 0 0 λ 2 2 d t ψ 3 a d k b k 2 d λ 1 k q k i 1 0 0 0 δ a k δ b k 1 t 0 0 0 δ b k 2 t 0 0 0 0 δ a k δ b k 1 δ b k 2 0 0 0 ψ 1 λ k q 1 k i q k 1 t r k 1 c t c ψ 2 k 1 t r k 2 ψ 3 a k b k 1 lemma 1 let m and e be matrices of known suitable dimensions w is a symmetric matrix f k satisfies 46 f t k f k i if there is a parameter β 0 and the inequality w β m m t β 1 e t e 0 is guaranteed then w m f e e t f t m t 0 holds according lemma 1 we can get 47 ψ 1 k 1 t r k 2 0 a k b k 1 t ψ 2 k 2 t r k 2 k d 1 0 a d k b k 2 t 0 0 λ 2 2 d t ψ 3 a d k b k 2 d λ 1 k q k i 1 β 0 0 0 h 0 0 0 h β 1 e a e b k 1 e b k 2 0 0 e a e b k 1 t e b k 2 t 0 0 0 ψ 1 λ k q 1 k i q k 1 t r k 1 c t c ψ 2 k 1 t r k 2 ψ 3 a k b k 1 make k 1 y 1 e 1 1 k 2 y 2 e 2 1 according to schur complement lemma s 1 0 is equivalent to 48 ψ 1 0 0 a i e 1 b y 1 t e a e 1 e b y 1 t 0 0 a d i e 2 b y 2 t e b y 2 t λ 3 λ d t 0 q i β h h t 0 β y 1 t r 1 2 e 1 t q 1 2 0 c e 1 t y 2 t r 1 2 0 e 2 t 0 0 0 0 0 0 0 0 0 0 0 0 0 λ i 0 0 0 λ i 0 0 k d i 0 λ i 0 ψ 1 e 1 e 1 t q i where λ 3 λ λ 2 2 p d p k i is equivalent to k d i q i the matrix inequality q k d is the unknown symmetric matrix at time k considering the constraints of the control quantity the following conversion can be made according to the state feedback matrix 49 u k i k 2 2 k 1 x k i k k 2 x k i d k 2 2 x k i k x k i d k t q 1 k i t y 1 t y 1 q 1 q 1 k i t y 1 t y 2 k d 1 k d 1 t y 2 t y 1 q 1 k d 1 t y 2 t y 2 k d 1 x k i k x k i d k u max 2 it can be obtained that the constraint conditions are established only if the following condition is met 50 1 u max 2 y 1 t y 1 y 1 t y 2 y 2 t y 1 y 2 t y 2 e 1 t q 1 k i e 1 0 0 e 2 t k d 1 e 2 it can be converted into the following lmi form according to schur complement lemma 51 u max 2 y 1 y 2 y 2 t e 1 e 1 t q i 0 y 1 t 0 e 2 e 2 t k d i 0 after the above processing the minimal maximum problem can be converted into an on line optimization problem 52 min λ 3 q y 1 y 2 k d λ s t 26 29 30 31 through on line optimization the q k d y 1 y 2 matrices that satisfies four constraint conditions of eqs 37 48 49 51 is solved so that λ is as small as possible from the solved matrices q k d y 1 y 2 the feedback matrix and the time delay feedback matrix can be calculated according to the control laws the h performance index can be obtained 4 simulation analysis in this paper we simulate and analyze the h robust predictive controller designed in this paper to verify the stability robustness and anti disturbance performance of the controller the system control constraint is 50 50 the time delay for the simulation is τ l v 0 024 s q and r are identity matrices the initial state of the vehicle is z 0 w 0 θ 0 q 0 t 0 0 0 0 t and the reference signal of the system is set to z r w r θ r q r t 1 0 0 0 t the error signal of the system is set to x e r x the sampling time of the system is set to t 0 008 s the external disturbance is set to ξ k 4 cos 8 π t 0 0 4 cos 8 π t when m is perturbed the discrete form of the perturbation matrix corresponding to δ a and δ b satisfies δ a 2 0 0171 and δ b 2 0 1562 therefore we can get e a i 4 4 0 4 6 t e b 0 2 8 i 2 2 t h 0 0171 i 4 4 0 1562 0 2 2 i 2 2 by substituting the known parameter matrices into the linear matrix inequalities 52 the matrices y 1 y 2 q k d at each sampling time can be obtained according to k 1 y 1 e 1 1 and k 2 y 2 e 2 1 the optimal state feedback control law can be obtained as shown in fig 3 the dotted line is the reference signal the solid line is the model predictive controller mpc designed in the paper and the dashed line is the model predictive controller with invariable quadratic function impc the supercavitating vehicle reaches a stable state in about 0 5 s and has no overshoot the supercavitating vehicle under the control of mpc produces less planing force and the deflection angle of the fins and cavitation of the system is smaller so the controller designed in this paper has better stability performance the depth curve of the mpc controller under external disturbances is more stable there is no obvious oscillation after stability the h performance index of mpc is smaller than impc therefore mpc can better suppress external interference fig 4 shows the step response curve when the cavity radius of the supercavitating vehicle is perturbed the dashed line is the reference signal the solid line is the response curve when the cavity radius is not perturbed the dot dash line is the response curve when the cavity radius is perturbed down by 20 and the dotted line is the response curve when the cavity radius is perturbed up by 20 it can be seen from fig 4 that the system can quickly reach a stable state when the cavitation radius is perturbed and the system has no overshoot therefore the system has strong robustness in the case of cavitation perturbation because the cavitation radius decreases when the cavitation radius is perturbed downward the tail of the vehicle is more likely to collide with the cavitation wall so the vehicle will produce greater planing force when the cavitation radius is perturbed downward in order to verify the robustness of the robust predictive controller when the system parameters are perturbed the system when m is taken as the maximum and minimum is simulated the solid line is the system response curve without perturbation the dot dash line is the system response curve with downward perturbation of 1 5 and the dotted line is the system response curve with upward perturbation of 1 5 it can be seen from fig 5 that the system can quickly reach the stable state when perturbed the system has no overshoot the system settling time is large when perturbed the state variable of the vehicle has small oscillation under external disturbance meanwhile the three curves have no obvious difference which proves that the vehicle still has strong robustness under the condition of system parameter perturbation 5 conclusion in the paper the time delay lpv model of supercavitating vehicle is established by decomposing the planing force considering that the radius of cavity is easily affected by external interference the supercavitating vehicle model described by polytope is established which can effectively solve the problem of cavity radius perturbation and improve the robust performance of the system based on the model an h robust predictive controller is designed based on time delay characteristics the algorithm uses memory feedback to solve the problem of time delay and uses h control algorithm to solve the problem of external interference meanwhile considering controller constraints we improve the controller algorithm to limit the range of control variable the simulation results show that the controller has strong robustness and anti interference ability and can effectively limit the range of control variable credit authorship contribution statement yuntao han conceptualization methodology software zhen xu software validation writing original draft hao guo validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national natural science foundation of china under grant 51209049 and heilongjiang provincial natural science foundation of china under grant e2017015 
20333,this paper investigates the uncertainty of the structure and material parameters on the natural frequency of the varying diameter functionally graded material fgm pipe conveying fluid firstly concentrating on the spatially dependent uncertainty of geometry varying in axial direction as well as the material varying in radial direction the random field is employed to describe the uncertainty parameters then a generalized eigenvalue equation of the varying diameter fgm pipe is derived by the dynamic stiffness method while introducing the random field and variables into the deterministic governing equation due to the input uncertainty the natural frequencies of the varying diameter fgm pipe change to random variables in this respect the stochastic characteristics of natural frequencies can be approximated by the monte carlo simulation however the enormous computational cost is unbearable the efficient artificial neural network surrogate model is introduced and incorporated for the natural frequency uncertainty quantification consequently a stochastic natural frequency analysis approach based on the neural network is proposed for the varying diameter fgm pipe conveying fluid some examples are investigated to illustrate the effectiveness of the proposed method and the influence of input uncertainty on the probabilistic characterization of the natural frequencies keywords stochastic natural frequency analysis varying diameter pipe conveying fluid dynamic stiffness method random field artificial neural network 1 introduction in mechanical structure systems the pipes conveying fluid are applied far and wide as the core of material and energy transportation pipes are employed in aerospace nuclear engineering petrochemical industry power engineering and marine engineering driven by engineering requirements research on the pipes conveying fluid has been implemented thoroughly in the past several decades professor paїdoussis conducted an in depth and detailed analysis on the dynamic behaviors of various single pipes conveying fluid in his book paidoussis 2016 which laid the foundation for the pipe dynamics research lots of papers gu et al 2016 bahaadini et al 2018 liu et al 2019 have reported the dynamic behaviors of pipe conveying fluid inspired by paїdoussis due to the geometric complexity determined by varying functional requirements researches further implemented numerous investigations on varying diameter pipe liu et al 2014 varying stiffness pipe dai et al 2013 curved pipe hu and zhu 2018 multiple span pipe liu et al 2018 l type combined pipe xu et al 2017 t type combined pipe wang and dai 2011 and various complex combined pipes tijsseling 1996 zhao et al 2019 as well known the property of inflow also has significant effect on the dynamic behaviors of pipe conveying fluid in most of traditional researches researchers mainly considered the uniform flow assumption whereas it has some limitations on the flow velocity the uniform flow assumption is inappropriate for high flow velocity meanwhile the boundary drag effect and fluid viscosity in real world are also ignored therefore guo et al 2010 and hellum et al 2010 studied the governing equation based on the non uniform flow assumption zhang et al 2016 constructed the governing equation of varying diameter pipe based on the euler bernoulli model and non uniform flow model and then they solved the natural frequencies and critical flow velocity by the forbenius method wu et al 2019 introduced the non uniform flow model into the curved pipe conveying fluid to investigate the stability furthermore lots of works on pipe conveying fluid have been completed in recent years lu et al 2020 liang et al 2021 zheng et al 2021 zhou et al 2021 askarian et al 2020 studied the stability of pipes conveying fluid supported by a fractional kelvin voigt viscoelastic foundation giacobbi et al 2020 studied the dynamics of pipes with clamped ends as well as the cantilevered pipes conveying fluid whose density varies along the axial direction jiang et al 2020 investigated the stability and 3 dimensional dynamics of the pipe simultaneously subjected to internal and external axial flows tan and ding 2020 investigated the parametric resonance of pipes conveying pulsating high speed fluids based on the timoshenko model mao et al 2021 proposed an approximate approach for investigating the dynamics of pipes conveying fluid with strong boundaries czerwinski and łuczko 2021 studied the nonlinear dynamics of planar curved pipes conveying pulsating flow the dynamic problems of pipes conveying fluid attracts continuous attention of researchers with the rapid development of functionally grade material fgm arsha et al 2015 l w zhang et al 2016 kim and lee 2017 the split new fgm pipes draw the attention of researchers sburlati and kashtalyan 2016 derived the analytical solutions for displacements and stresses in the sandwich pipes with two thin functionally graded interlayers deng et al 2017 studied the stability of the multi span viscoelastic fgm pipe by a hybrid method tang and yang 2018 utilized the homotopy analysis method to investigate the post bulking behavior and nonlinear vibration of a fgm pipe conveying fluid dai et al 2019 investigated the influence of the material parameters on the thermo elastic vibration of axially fgm pipe conveying fluid liang et al 2020 implemented the dynamical analysis of the fgm spinning multi span pipe conveying fluid tong et al 2020 investigated the stability of cantilever fgm nanotube by the galerkin method considering the thermo magnetic coupling effect reddy et al 2019 analyzed the buckling behaviors and post buckled equilibrium state of the fgm pipe conveying hot fluid and investigated the origin of chaotic oscillations more and more novel fgm materials are applied to the pipes for various function realizations the above numerous studies are under the deterministic frame which is fundamental and necessary however the spatial variability results the geometric complexity of pipes conveying fluid which further affects the dynamic performance of pipes significantly the laboratory observations and in field data have illustrated that the uncertainty is always related to the spatial variability zhang et al 2017 additionally the uncertainty of material and geometric structure is inevitably generated in the process of manufacturing and post processing therefore with the existence of source uncertainty the natural frequencies and other dynamic characteristics become to be uncertain responses rather than deterministic ones it is necessary to implement stochastic natural frequency analysis of complex pipes conveying fluid the varying diameter pipe conveying fluid such as the representative tapered pipe is a typical case of pipes with geometric complexity and the fgm is typical one of material complexity so this paper employs the varying diameter fgm pipe possessing both geometric and material complexity with spatial variability to analyze the influence of input uncertainty on the natural frequency response researchers have implemented some stochastic dynamic studies of different structures considering input uncertainty in the past decade hu and qiu 2010 investigated the dynamic responses of an infinitely long beam considering the non probabilistic convex models and interval analysis respectively kishor et al 2011 utilized the polynomial chaos expansion method to study the uncertain vibrational frequencies of an incompressible liquid in a rectangular tank sasikumar et al 2013 developed a stochastic finite element analysis method for the failure assessment of layered composite beams with spatially varying non gaussian inhomogeneities and estimated the failure probability by monte carlo simulations mcs cicirello and langley 2014 proposed the hybrid finite element analysis method for the parametric uncertainty propagating analysis of complex vibro acoustic systems and provided the solving strategy for computationally intensive problem gan et al 2014 presented a new random uncertainty modeling procedure for the vibration analysis of a straight pipe conveying fluid subjected to several randomly uncertain loads jiang et al 2016 proposed an interval process model for the non random vibration analysis of structures wu et al 2018 proposed a unified interval chebyshev based random perturbation method for the hybrid random interval natural frequency analysis of structures feng et al 2019 investigated the stochastic elastoplastic analysis of structures via finite element method and extended support vector regression approach analyzing the probabilistic profile of structural output xu et al 2020 proposed a novel hybrid cubature formula to estimate the moment based uncertainty propagation yang et al 2019 employed the polynomial chaos expansion to approximate the stochastic dynamic characteristics of cracked uncertain hollow shaft gao et al 2020 studied the probabilistic stability characteristics of functionally graded graphene platelets reinforced beams vaishali et al 2020 investigated the stochastic dynamic behaviors of functionally graded shells based on machine learning method wang et al 2020 studied the stochastic stability and structural reliability of functionally graded frame structures with machine learning method guo et al 2021b proposed an efficient stochastic natural frequency analysis method for axially varying functionally graded material pipe conveying fluid in this paper the varying diameter fgm pipe is employed as the deterministic mechanical structure to model the uncertainty related to the spatial variability of the varying diameter and fgm characteristics the karhunen loève expansion k l expansion ghanem and spanos 1991 betz et al 2014 melink and korelc 2014 zhang et al 2019 is employed to generate the gaussian and non gaussian random fields to describe the input spatially dependent uncertainty duo to the introduction of random fields the natural frequency becomes to be random variables the generalized eigenvalue equation derived by the dynamic stiffness method dsm cannot be solved directly to obtain the uncertainty quantification model of stochastic natural frequency the mcs can be implemented for the estimation of statistic characteristics of natural frequencies however the computational cost of mcs is unbearable for complex problems as the evaluations of the generalized eigenvalue equation are generally over 10 4 times inspired by the surrogate models applied widely in machine learning the artificial neural network ann is introduced into the stochastic natural frequency analysis of the varying diameter fgm pipe conveying fluid anns samarasinghe 2006 are widely used in machine learning and deep learning ann can precisely mimic the mapping of inputs and outputs and further predict the output of unknown samples whose strong ability on nonlinear fitting provides the possibility of approximating implicit functions accurately using anns to estimate the statistical characteristics of uncertain outputs has been attempted in structural reliability analysis which shows a very high efficiency sadovský and guedes soares 2011 employed the ann model to estimate the collapse strength of the plates as a geometrical imperfection function papadopoulos et al 2012 proposed a neural network based subset simulation method to improve the computational efficiency and robustness of reliability analysis chan and low 2012 used the response surface and neural network methods to investigate the reliability based parametric studies of laterally loaded piles li et al 2018 proposed a dual neural network method to overcome the difficulty of multiple integrations as well as the computational burden chantola et al 2019 studied the reliability of transformer by supplementary variable technique and neural network approach inspired by the broad applications of ann in probabilistic analysis it is introduced into the stochastic natural frequency analysis of the varying diameter fgm pipe conveying fluid this paper is arranged as follows section 2 reviews the theoretical formulation of random field generated by k l expansion radially varying fgm and the governing equation of varying diameter pipe the stochastic natural frequency analysis is implemented by introducing the random field into the governing equation and the generalized eigenfunction equation is derived by the dsm in section 3 in section 4 the neural network is illustrated and introduced into the stochastic natural frequency of the varying diameter fgm pipe conveying fluid for estimating the mean standard deviation probability density function pdf and cumulative distribution function cdf of the natural frequencies in section 5 some examples are investigated to demonstrate the performance of the proposed method section 6 concludes the paper 2 theoretical formulation 2 1 functionally graded material considering a fgm pipe the mechanical properties e g the young s modulus and mass density of the fgm continuously change along the radial direction the power law is adopted to depict the variation of material property and the effective material property is expressed as deng et al 2017 1 ρ v i ρ i v o ρ o 2 e v i e i v o e o where ρ e and v denote the mass density young s modulus and volume fraction of the component material of fgm the subscripts i and o indicate the corresponding inner and outer materials of fgm respectively the poisson s ratio is assumed as a constant the volume fractions following power law are expressed as 3 v i r o r r o r i n r o r t n χ n 4 v o 1 v i where r i and r o denote the inner and outer radiuses of the fgm pipe r is the radius of the pipe reference point t is the thickness and n is the volume fraction index furthermore define the material property ratios as ρ r a t i o ρ i ρ o and e r a t i o e i e o respectively the material properties are rewritten as 5 ρ ρ o 1 ρ r a t i o 1 χ n 6 e e o 1 e r a t i o 1 χ n 2 2 governing equation of varying diameter pipe the schematic diagram of the varying diameter fgm pipe conveying fluid is drawn in fig 1 which is a shrinking pipe the length of the pipe is l and the thickness h remains unchanged d 0 and d 0 denote the inner and outer diameters at the thicker end i e the entrance end d l and d l denote the inner and outer diameters at the thinner end i e the exit end the inner diameter d i of the pipe change linearly along the axial direction and it can be expressed as 7 d i x 1 γ x l d 0 where γ represents the reduction factor which is numerically equal to the tangent of taper angle because the inner and outer diameters of varying diameter pipe vary along with the axial direction it is more appreciate to employ the non uniform flow model therefore the inflow in this paper is the incompressible laminar flow whose velocity follows parabolic distribution according to the conservation of fluid mass the flow quality is a constant if the maximum flow velocity at the entrance end is v c 0 the maximum velocity at any section of the pipe is 8 v c x 1 1 γ x l 2 v c 0 assuming that the axis of the pipe is not extensible the vibrational control equation based on the euler bernoulli model can by expressed by the hamiton principle of open systems as follows zhang 2016 9 e i x w m p m f w 1 2 2 m f v w m f v w m f v w 1 3 m f w v 2 m f w v 2 2 m f v v w 0 where m f denotes the mass of fluid in the pipe per unit length m p denotes the mass of the pipe per unit length w denotes the lateral displacement w and w denote the derivatives of w to axial displacement x and time t respectively 2 3 random field considering the spatial variability of varying diameter pipe and fgm the input uncertainty is spatially dependent which indicates that the input uncertainty should be described by the random field the k l expansion is employed to implement the random field discretization define a complete probability space d f p from the sample space d assume that ψ z r represents a random variable so z r is the set of all random variables in d f p h x θ is employed as the random field for describing the spatially dependent uncertainty of material and geography properties for a fixed x 0 h x 0 θ is a random variable while for a given θ 0 h x θ 0 is a realization of the random field considering the positive nature of the material and geography properties of the pipe both gaussian and lognormal distribution types of random fields are adopted to model the uncertainty of random inputs the spatial variation of uncertain material and geography properties is simulated by the exponential covariance function c o v x 1 x 2 the expression of c o v x 1 x 2 for random field is as follows betz et al 2014 10 c o v x 1 x 2 σ h 2 e x 1 x 2 l for 1 d fields where σ h illustrates the standard deviation of the random field and l denote the correlation length the k l expansion for the discretization of random fields is constructed with the decomposition of a bounded symmetric and positive definite covariance function as 11 c o v x 1 x 2 i 1 κ i φ i x 1 φ i x 2 where the eigen pairs κ i φ i x in eq 11 are the solutions of the second kind of fredholm integral equation i e 12 i 1 ω c o v x 1 x 2 φ i x 2 d x 2 κ i φ i x 1 where κ i denotes the eigenvalue and φ i x 1 denotes the eigenfunction the eigenfunctions are orthogonal with each other i e ω φ i x φ j x d x δ i j where δ i j is the kronecker symbol based on the above descriptions each parameter in the set of random variables is expressed as 13 ψ i θ 1 κ i d h x θ μ x φ i x d d for the gaussian random field the total set of ψ i θ i 1 2 is the collection of independent normal random variables truncating the random field with q terms the k l expansion of h x θ is expressed as 14 h x θ h ˆ q x θ μ x i 1 q σ x κ i ψ i θ φ i x where μ x and σ x illustrate the mean value and standard deviation of the gaussian random field respectively for the lognormal random field it is remodeled as the exponential product of the gaussian random field 15 h x θ h ˆ q x θ exp μ x i 1 q σ x κ i ψ i θ φ i x where μ x log μ log 2 x σ log μ log 2 x σ x log σ log μ log 2 x 1 μ log x and σ log x indicate the mean value and standard deviation of the corresponding lognormal random field respectively in this paper the random field contains the first five orders of the k l expansion and the correlation length is set as l 1 based on the research in betz et al 2014 the above settings can ensure a feasible computation time 3 stochastic natural frequency analysis with dsm eq 9 is a high order differential equation which is hard to solve the dynamic stiffness method dsm is utilized to approximate the solutions according to the above introductions the uncertainties of material and geography properties i e elastic modulus e θ mass density ρ θ reduction factor γ θ of inner diameter and volume fraction index n θ are described with random field where θ θ 1 θ 2 θ p denotes the random field consisting of all random variables expanded by k l expansion the thickness h θ and flow velocity v c 0 θ at the entrance end are also regarded as random variables following normal or lognormal distribution after introducing the random field and random variables the dynamic responses such as lateral displacement and natural frequencies are converted into random variables as the inner and outer diameters are related to x the fluid mass m f θ x pipe mass m p θ x and moment of inertia i θ x of section x are expressed as 16 m f θ x ρ f a f θ x ρ f π 1 γ θ x l 2 d 0 2 4 1 α 1 θ x l α 2 θ x 2 l 2 ρ f a f 0 m p θ x ρ p a p x ρ p θ π 1 γ θ x l 2 d 0 2 d 0 2 4 1 α 1 θ x l α 2 θ x 2 l 2 ρ p θ a p 0 i θ x π d x 4 θ d x 4 θ 64 1 β 1 θ x l β 2 θ x 2 l 2 β 3 θ x 3 l 3 β 4 θ x 4 l 4 i 0 where a f 0 a p 0 and i 0 represent the geography constants at the entrance end of tapered pipe α and β are expressed as 17 α 1 θ 2 γ θ α 2 θ γ 2 θ β 1 θ 4 γ θ β 2 θ 6 γ 2 θ β 3 θ 4 γ 3 θ β 4 θ γ 4 θ for simplicity introduce the dimensionless variables as follows 18 ξ x l η θ w θ l v θ m f i θ e θ i i θ v c θ l ω θ m f 0 m p 0 e θ i 0 l 2 ω θ τ θ e θ i 0 m f 0 m p 0 t l 2 m m f 0 m f 0 m p 0 assume the solution of eq 9 as η ξ τ θ η ξ θ e i ω θ τ θ the control equation is transformed as 19 1 β 1 θ ξ β 2 θ ξ 2 β 3 θ ξ 3 β 4 θ ξ 4 d 4 η d ξ 4 2 β 1 θ 2 β 2 θ ξ 3 β 3 θ ξ 2 4 β 4 θ ξ 3 d 3 η d x 3 2 β 2 θ 6 β 3 θ ξ 12 β 4 θ ξ 2 1 3 1 α 1 θ ξ α 2 θ ξ 2 v 2 θ d 2 η d x 2 i m θ v θ ω θ 1 α 1 θ ξ α 2 θ ξ 2 1 3 α 1 θ 2 α 2 θ ξ v 2 θ d η d ξ 1 2 α 1 θ 2 α 2 θ ξ i m θ v θ ω θ 1 α 1 θ ξ α 2 θ ξ 2 ω 2 θ η θ 0 the trail function in series is η ξ θ n m 0 a n m θ ξ n m k a 0 0 and the derivatives of it are expressed as 20 d η d ξ n m 0 n m k ξ n m k 1 d 2 η d ξ 2 n m 0 n m k n m k 1 ξ n m k 2 d 3 η d ξ 3 n m 0 n m k n m k 1 n m k 2 ξ n m k 3 d 4 η d ξ 4 n m 0 n m k n m k 1 n m k 2 n m k 3 ξ n m k 4 when nm 0 substituting eq 20 into eq 19 can obtain 21 a 0 k k 1 k 2 k 3 0 it means k j 0 1 2 3 j 1 2 3 4 substitute the trail function into vibration control equation and let the powers of ξ be 0 then the a n m k θ can be expressed as 22 a 0 k θ 1 a 1 k θ β 1 θ k 1 k 1 a 0 k a 2 k θ β 1 θ k k 2 a 1 k θ β 2 θ k k 1 ζ 1 θ k 2 k 1 a 0 k θ a 3 k θ β 1 θ k 1 k 3 a 2 k θ β 2 θ k k 1 ζ 1 θ k 3 k 2 a 1 k θ β 3 θ k 1 k k 1 α 1 θ ζ 1 θ k ζ 2 θ k 3 k 2 k 1 a 0 k θ a 4 k θ β 1 θ k 2 k 4 a 3 k θ β 2 θ k 2 k 1 ζ 1 θ k 4 k 3 a 2 k θ β 3 θ k 2 k 1 k α 1 θ ζ 1 θ k ζ 2 θ k 4 k 3 k 2 a 1 k θ β 4 θ k 2 k 1 k k 1 α 2 θ ζ 1 θ k k 1 ζ 4 θ k ζ 3 θ k 4 k 3 k 2 k 1 a 0 k θ a n m 5 k θ β 1 θ k n m 3 k n m 5 a n 4 β 2 θ k n m 3 k n m 2 ζ 1 θ k n m 5 k n m 4 a n m 3 β 3 θ k n m 3 k n m 2 k n m 1 α 1 θ ζ 1 θ k n m 1 ζ 2 θ k n m 5 k n m 4 k n m 3 a n m 2 β 4 θ k n m 3 k n m 2 k n m 1 k n m α 2 θ ζ 1 θ k n m 1 k n m ζ 4 θ k n m 1 ζ 3 θ k n m 5 k n m 4 k n m 3 k n m 2 a n m 1 ζ 5 θ k n m ζ 6 θ k n m 5 k n m 4 k n m 3 k n m 2 a n m n m 0 1 where 23 ζ 1 θ 1 3 v 2 θ ζ 2 θ i m θ v θ ω θ 1 3 v 2 θ ζ 3 θ 1 2 α 1 θ i m θ v θ ω θ ω 2 θ ζ 4 θ α 1 θ i m θ v θ ω θ 2 3 α 2 θ v 2 θ ζ 5 θ α 2 θ i m θ v θ ω θ ζ 6 θ α 2 θ i m θ v θ ω θ α 1 θ ω 2 θ as k has four solutions the trial function can be rewritten as 24 η ξ θ a 1 f 1 ξ θ a 2 f 2 ξ θ a 3 f 3 ξ θ a 4 f 4 ξ θ where a j j 1 2 3 4 are constants representing the coordinates of the solution in the space of generalized coordinate system f j ξ θ and f j ξ θ n m 0 a n k j θ ξ n m k j substitute the trial function 24 into control equation and let the powers of ξ be 0 omitting the high order infinitesimals of γ θ the a n k θ can be obtained the dimensionless bending moment and shear force can be expressed as 25 m ξ θ m l e i i 1 β 1 θ ξ β 2 θ ξ 2 β 3 θ ξ 3 β 4 θ ξ 4 d 2 η d ξ 2 q ξ θ q l 2 e i i 1 β 1 θ ξ β 2 θ ξ 2 β 3 θ ξ 3 β 4 θ ξ 4 d 3 η d ξ 3 β 1 θ 2 β 2 θ ξ 3 β 3 θ ξ 2 4 β 4 θ ξ 3 d 2 η d ξ 2 the bending moment and shear force at both pipe ends are expressed as 26 f q 0 θ m 0 θ q 1 θ m 1 θ t the relation between the nodal force and generalized coordinates is f θ b θ a where 27 b θ f 1 0 θ 2 β 1 θ f 1 0 θ f 2 0 θ 2 β 1 θ f 2 0 θ f 1 0 θ f 2 0 θ β θ f 1 1 θ ς θ f 1 1 θ β θ f 2 1 θ ς θ f 2 1 θ f 1 1 θ f 2 1 θ f 3 0 θ 2 β 1 θ f 3 0 θ f 4 0 θ 2 β 1 θ f 4 0 θ f 3 0 θ f 4 0 θ β θ f 3 1 θ ς θ f 3 1 θ β θ f 4 1 θ ς θ f 4 1 θ f 3 1 θ f 4 1 θ where β θ 1 β 1 θ β 2 θ β 3 θ β 4 θ ς θ β 1 θ 2 β 2 θ 3 β 3 θ 4 β 4 θ and d d ξ the relation between the dimensionless displacement and generalized coordinates is 28 η ξ θ a 1 f 1 ξ θ a 2 f 2 ξ θ a 3 f 3 ξ θ a 4 f 4 ξ θ ϕ ξ θ a 1 f 1 ξ θ a 2 f 2 ξ θ a 3 f 3 ξ θ a 4 f 4 ξ θ it is rewritten in the matrix form as δ e θ p θ a where 29 δ e θ η 1 θ η 1 θ η 2 θ η 2 θ t a a 1 a 2 a 3 a 4 t p θ a 0 k 1 θ 0 0 0 a 1 k 1 θ a 0 k 2 θ 0 0 f 1 1 θ f 2 1 θ f 3 1 θ f 4 1 θ f 1 1 θ f 2 1 θ f 3 1 θ f 4 1 θ the relation between nodal force and nodal displacement of the pipe can be obtained as 30 f θ b θ p 1 θ δ e θ s θ δ e θ where s θ b θ p 1 θ is the stochastic stiffness matrix of the pipe system the boundary condition of the varying diameter pipe conveying fluid is pinned pinned i e 31 ξ 0 η 1 θ 0 η 1 θ 0 m 1 0 θ 0 q 1 0 θ 0 ξ 1 η 2 θ 0 η 2 θ 0 m 2 1 θ 0 q 2 1 θ 0 substituting the boundary condition into eq 30 can obtain 32 q 1 θ 0 q 2 θ 0 s 11 θ s 12 θ s 13 θ s 14 θ s 21 θ s 22 θ s 23 θ s 24 θ s 31 θ s 32 θ s 33 θ s 34 θ s 41 θ s 42 θ s 43 θ s 44 θ 0 η 1 θ 0 η 2 θ considering the free vibration of the pipe without external forces only the stochastic characteristic equation is 33 s 22 θ s 24 θ s 42 θ s 44 θ η 1 θ η 2 θ 0 the stochastic natural frequency can be calculated by solving the following equation 34 h ω θ s 22 θ s 24 θ s 42 θ s 44 θ 0 the generalized eigenvalue equation 34 is obtained which is the basis of the stochastic natural frequency analysis of the varying diameter fgm pipe conveying fluid as the natural frequencies has become random variables the uncertainty quantification of natural frequencies can be obtained by calling equation 34 iteratively whose computational cost is normally unbearable due to the tens of thousands realizations consequently an efficient ann surrogate model is introduced to estimate the statistic characteristics of stochastic natural frequencies 4 artificial neural network surrogate model ann is a perfect surrogate model for dealing with data classification and complex implicit nonlinear mapping problems the ann is an adaptive nonlinear system consisting of a series of interconnected neurons the neurons are connected with transfer functions and weighted matrix and form a certain network or topology lots of neurons are arranged in several layers the first layer is the input layer which illustrates the input data the final layer is the output layer which provides system responses the layers between the input layer and output layer are the hidden layers which construct the mapping between the input data and responses the schematic diagram of the typical ann model is drawn in fig 2 the relation between input x and output y can be expressed as 35 y f i 1 t w i x i b p f w τ x b p where f represents the transfer function x x 1 x 2 x t τ is the input vector w w 1 w 2 w t τ denotes the corresponding weight vector to x and b p is the threshold determining the shift of transfer function to ensure that the errors between the ann predicted values and the desired function values are minimal a set of configuration values must be adjusted and selected i e let the ann learn and train in this work the back propagation bp neural network is adopted the transfer function in the hidden layers is logsig function and the activation in the output layer is a purelin function delta learning rule is adopted which belongs to supervised learning strategy it utilizes the negative gradient of error to adjust connection weights to monotonically decrease the network output error the error of the predicted output and the actual output is expressed as 36 e w 1 w 2 w l 1 2 y y τ y y where y denotes the actual output for the k th layer the gradient of error function to the weight matrix is 37 e w k y k 1 y l y j y l z l w l τ j y l 1 z l 1 w k 2 τ j y k 1 z k 1 w k 1 τ j y k z k k l l 1 1 where y 0 x when k 1 l is the number of the layers and z k denotes the received values of the k th layer j is the jacobi matrix expressed as 38 j y k z k y k z k d i a g d y 1 k d z 1 k d y 2 k d z 2 k d y n k k d z n k k k 1 2 l where n k is the number of neurons in the k th layer the weights are updated when a sample is learned for the i 1 th sample the weight matrix w k i 1 is revised with w k i as follows 39 w k i 1 w k i δ w k i k 1 2 l based on the delta learning rule the adjustment of weight matrix is 40 δ w k i ψ i e i w k i τ i δ w k i 1 where ψ i denotes the learning efficiency of the i th step the second item represents a potential energy inertia which is improved for avoiding the local optimum the inertia coefficient is determined with the comparison of two changes of weight matrix additional details about ann configurations can refer the references samarasinghe 2006 sadovský and guedes soares 2011 chan and low 2012 papadopoulos et al 2012 li et al 2018 chantola et al 2019 in this field about the data set it is divided into two subsets the training subset is utilized to adjust the network architecture and internal parameters while the test subset is utilized to verify the generalization ability of the data set the data determines the prediction quality of the network so the training data covers all realizations of the input variables which are generated by k l expansion or sampling randomly the bp ann is employed to construct the mapping relationship between the random inputs and the stochastic responses of the varying diameter pipe conveying fluid benefitting from the powerful ability on dealing with complex implicit mapping problems the bp ann can greatly reduce the number of simulations while ensuring the computational accuracy by combining the random fields stochastic eigenvalue equation and ann model a stochastic natural frequency analysis approach is proposed the computational process is conducted as shown in fig 3 5 example investigation 5 1 validation of the method this subsection verifies the dsm for the solution of the natural frequency and the stochastic natural frequency analysis method combining the random field dispersed by the k l expansion the generalized eigenvalue equation and the ann model as the varying diameter fgm pipe conveying fluid was not ever reported in literature a homogenous pipe i e n 0 and γ 0 is employed to illustrate the proposed method considering a pinned pinned pipe conveying fluid the geometrical parameters are length 2 0 m outer diameter 0 1 m and thickness 0 002 m the elastic modulus and density of the pipe are 68 6 g p a and 2800 k g m 3 respectively the fluid density is 1000 k g m 3 the laminar flow velocity has three conditions v c 0 0 m s v c 0 20 m s and v c 0 40 m s the first four order natural frequencies are listed in table 1 compared with the reference results in zhai et al 2012 it can be seen that the natural frequencies obtained by the proposed method match well with the reference results in literature the low relative error demonstrates the accuracy of the proposed method which provides the basis for the stochastic natural frequency analysis of the pipe to validate and illustrate the proposed stochastic natural frequency analysis method the material properties i e elastic modulus and mass density are modeled as gaussian material random field by k l expansion the mean values of material properties do not change whereas the coefficient of variation is 0 1 meanwhile the uncertainty of the flow velocity is also considered and follows the gaussian distribution the corresponding dimensionless flow velocity conditions are also adjusted as v 0 0 9556 v 0 1 4334 and v 0 1 9112 and the corresponding coefficient of variation is 0 01 in general 11 random variables are contained in the stochastic analysis including two random fields and a random variable the statistical results of first four order natural frequencies estimated by ann models corresponding to different sample sizes are reported in table 2 compared with the results of direct mcs the results show that the ann models perform sufficiently accurate results with the converged sample size of 768 hence the ann model with 768 design points is utilized hereafter for conducting the statistical analysis of the natural frequency fig 4 shows the pdfs of the first four order natural frequencies obtained by the ann models and fig 5 displays the cdfs of the natural frequencies the results show that the mean values of the first four natural frequencies decrease with the increase of v 0 while the change of standard deviations is opposite more specific comparisons can be found in table 3 which reports the statistics of the first four order stochastic natural frequencies with different v 0 for the third and fourth natural frequencies the descent rate of mean values is quite slower which presents that the axis of the probability density function moves slowly and the crossover range of pdfs is getting bigger and bigger in fig 5 d it can be seen that the areas between the cdfs are almost symmetric about the mean value which means that the uncertainty of the v 0 has more significant effect on the stochastic dynamic response than the change of v 0 by comparing with the statistical results obtained by the direct mcs with 10 5 samples the accuracy and efficiency of the ann based uncertainty quantification method are sufficiently demonstrated the effects of the stochastic properties on the uncertainty propagation to the dynamic response of varying diameter fgm pipe conveying fluid are investigated in following cases after validating the proposed ann model based stochastic natural frequencies analysis method 5 2 effect of the reduction factor the fgm varies smoothly in the direction of radial in deterministic analysis the random variation of material properties at each depth is considered to simulate uncertainty propagation of the source uncertainty in material the material properties of the fgm are as follows 41 t i 6 a l 4 v inner layer e i 115 g p a ρ i 4515 k g m 3 s i c outer layer e o 440 g p a ρ o 3210 k g m 3 the varying law of fgm follows the formulations in subsection 2 1 the deterministic parameters of the pipe are outer diameter 0 080 m and length 15 m the probabilistic information of random fields and random variables are listed in table 4 in general four lognormal random fields and two lognormal random variables are considered which contains 22 random variables in total while the random field is dispersed into the first five orders of the k l expansion what must be emphasized is that when the probabilistic information such as the means and covs of one pipe parameter is changed other parameters follow the distribution forms provided in table 4 in this subsection the impact of uncertain reduction factor γ on the stochastic natural frequencies of varying diameter fgm pipe is investigated three cases of varying γ are considered as γ 1 0 1 γ 2 0 2 and γ 3 0 3 due to the variation of the parameters of the pipe the sample size of the ann model needs to be further investigated for a balance of both accuracy and efficiency the results of γ 1 0 1 are shown in table 5 which illustrate that the ann models can implement sufficiently exact natural frequencies with the converged sample size of 512 compared with the results obtained by mcs with 10 5 samples in deterministic dynamic analysis all pipe parameters are taken as the mean values the deterministic natural frequencies and critical dimensionless flow velocities are reported in table 6 it can be found that with the increasing of γ the natural frequencies decrease and the critical dimensionless flow velocity decreases simultaneously the effect of reduction factor γ is further implemented by the ann models with the sample size of 512 the pdfs and cdfs of the first four natural frequencies with varying reduction factors are displayed in fig 6 and fig 7 respectively it can be noticed that the means of first four order natural frequencies decrease with the increasing of γ which matches the varying trend of deterministic natural frequencies with increasing γ furthermore the standard deviations of first four natural frequencies are found to fall with the increase of γ the variation rule of the mean values of the stochastic natural frequencies with varying reduction factors is mainly dependent on the stability analysis of the varying diameter fgm pipe conveying fluid the variation of the standard deviation pdf or cdf of natural frequencies illustrates the effect of the source uncertainty on the stochastic natural frequencies which is the focus of this work as the cov of the uncertain reduction factor is unchanged the increase of γ means that the input uncertainty is increasing the corresponding dynamic responses i e the natural frequencies would have larger uncertainties and wider stochastic bounds yet not in results it illustrates that the reduction factor γ as a significant geography parameter of varying diameter fgm pipe has main effect on the variation of the stochastic natural frequencies while the effect of its uncertainty on stochastic natural frequencies is mitigated 5 3 effect of the pipe thickness according to the setting of pipe parameters in previous subsection 5 2 the effect of the dimensionless thickness τ is investigated three conditions for dimensionless pipe thickness are considered as follows τ 0 0028 τ 0 0042 and τ 0 0056 the deterministic dynamic results with different τ are reported in table 7 it can be noticed that the natural frequencies decrease with the growing up of dimensionless pipe thickness and the critical dimensionless flow velocity increases simultaneously the pdfs and cdfs of the natural frequencies with different pipe thicknesses τ are displayed in fig 8 and fig 9 respectively the results illustrate the effect of the variation in pipe thickness on the first four order natural frequencies wherein it can be found that the mean values of the first four natural frequencies rise with the increase of τ and the variation rule is same for corresponding standard deviations the increase of the standard deviation of natural frequencies with different thicknesses is mainly influenced by the increase of input source uncertainty and the increase of the mean natural frequencies is influenced by the variation of the geometry which can also be validated by the deterministic dynamic results 5 4 effect of the flow velocity the dimensionless flow velocity is considered as three conditions to investigate the effect of the flow velocity which are as follows v 0 i 0 6806 v 0 i 1 3612 and v 0 i 2 0418 the deterministic natural frequencies under three cases are reported in table 8 it is obvious that the deterministic natural frequencies decrease with the increasing of the dimensionless flow velocity the pdfs and cdfs of natural frequencies for different dimensionless flow velocities are plotted in fig 10 and fig 11 respectively the figures depict that the mean values of the natural frequencies decrease with the increase of v 0 which is opposite to the varying rule of the corresponding standard deviations the varying trend of mean results is consistent with that of the deterministic results with the rise of the source uncertainty of v 0 the uncertainty of the natural frequency responses also increases it should be noted that as the increase of flow velocity makes less decrease of high order natural frequency and the increase of input source uncertainty makes large increase of the stochastic bounds of natural frequency response the stochastic bounds of second third and fourth natural frequencies overlap with each other obviously with the increase of v 0 to further investigate the effect of the critical flow velocity and stability on the stochastic natural frequencies the change of the standard deviation of the stochastic fundamental natural frequency is drawn in fig 12 the flow velocity as the standard deviation equals to 0 is the critical flow velocity v c r around the critical flow velocities the standard deviations raise up to the maxima which indicates the pipe transforms from the stable state to the unstable one which should be paid attention to when the increasing flow velocity approaches the critical flow velocity 5 5 effect of the volume fraction index the volume fraction index n of the fgm affects the natural frequency of the fgm pipe conveying fluid obviously this subsection considers three conditions of n as follows n i 1 n i i 10 and n i i i 100 the deterministic dynamic results with different volume fraction indices are reported in table 9 it can be found that the deterministic natural frequencies grow up with the increasing of the volume n at the same time the critical dimensionless flow velocity also increases the pdfs and cdfs of natural frequencies with different volume fraction indices are presented in fig 13 and fig 14 respectively with the increase of volume fraction index both of the mean values and standard deviations of natural frequencies increase the means of stochastic natural frequencies with different volume fraction indices vary as the rule of deterministic dynamic analysis the standard deviations of natural frequencies rise due to the increase of input source uncertainty 5 6 effect of the degree of stochasticity in this subsection the effect of the degree of stochasticity is investigated the components of fgm are assumed to be unchanging and the coefficient of variation cov of fgm material properties i e the young s modulus e and mass density ρ varies as follows c o v i 0 05 c o v i i 0 1 c o v i i i 0 15 by comparing the statistical characteristics of stochastic natural frequencies the effects of varying covs of material properties on statistical moments of the natural frequencies are illustrated the pdfs and cdfs of first four natural frequencies with different degrees of stochasticity are shown in fig 15 and fig 16 respectively from the results the mean values do not change with the cov of the fgm material properties increasing whereas the degree of stochasticity for the natural frequencies increases the means of natural frequencies meet with the deterministic results in table 9 it fully demonstrates that the change of cov has no effect on the means of stochastic natural frequencies for a clearer presentation the standard deviations of natural frequencies with the increasing covs of material properties are shown in fig 17 the increase of cov represents the increase of input source uncertainty which results lager variances of the natural frequencies it further illustrates that except the increasing of standard deviation for the natural frequencies with the increase of cov the standard deviation also rises with the increase of orders of natural frequencies 5 7 sensitivity analysis to identify the importance of the various source uncertainties on the natural frequency of varying diameter fgm pipe conveying fluid it is necessary to implement sensitivity analysis guo et al 2019 2021a to identify the random fields or variables with the largest effect on stochastic dynamic response the moment independent global sensitivity analysis method cheng et al 2020 is employed to estimate the importance degree of the random fields and variables the global sensitivities of the source uncertainties are displayed in fig 18 it depicts that the importance ranking of the source uncertainties is n ρ i ρ o γ e i e o which illustrates that the uncertainty of the volume fraction index n has the largest impact on the stochastic natural frequency followed by the mass density ratio ρ i ρ o reduction factor γ and elastic modulus ratio e i e o the sensitivity analysis provides significant reference on the uncertainty control of the material properties and geometric characteristics 6 conclusion this paper proposes an artificial neural network ann based stochastic natural frequency analysis approach to investigate the uncertainty propagation of the source uncertainties in the varying diameter functionally graded material fgm pipe conveying fluid considering the spatial variation of the material properties of fgm and geography parameters the random field is employed to describe the inevitable uncertainties and the karhunen loève k l expansion is utilized to discrete the random field into random variables the source uncertainties are substituted into the deterministic governing equation of the varying diameter fgm pipe conveying fluid and the dynamic stiffness method dsm is employed to solve and obtain the stochastic eigen value equation the ann model widely applied in machine learning is introduced to mimic the stochastic eigen value equation to reduce the computational cost the proposed stochastic natural frequency analysis method for the varying diameter fgm pipe can implement uncertainty quantification of the stochastic natural frequency efficiently and accurately the efficiency and accuracy of the proposed method are firstly demonstrated with a validation example by comparing the deterministic results with the results in references as well as the stochastic natural frequency analysis results with those obtained by monte carlo simulation mcs compared with the mcs method the ann based method has significant higher computational efficiency without a wastage of accuracy this paper further explores the effect of reduction factor pipe thickness the maximum flow velocity at entrance end and volume fraction index of the fgm whose results fully illustrate that the inevitable source uncertainties in varying diameter pipe conveying fluid cause significant changes of dynamic responses from the deterministic values the stochastic natural frequency analysis considering the source uncertainty is essential and viable for the adequate safety the probabilistic description of the stochastic natural frequency is subjected to the visible variability from the deterministic value furthermore the sensitivity analysis identifies the importance degrees of the various source uncertainties on the stochastic natural frequency of the varying diameter fgm pipe the proposed stochastic dynamic analysis method combining the random fields dynamic analysis method and ann model can also be applied to the other uncertain complex structure systems credit authorship contribution statement qing guo methodology writing original draft writing review editing funding acquisition visualization yongshou liu methodology supervision writing original draft bingqian chen investigation validation writing original draft yidu zhang writing original draft data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationship that could have appeared to influence the work reported in this paper acknowledgement this work is sponsored by innovation foundation for doctor dissertation of northwestern polytechnical university no cx202030 the authors are grateful for the financial support 
20333,this paper investigates the uncertainty of the structure and material parameters on the natural frequency of the varying diameter functionally graded material fgm pipe conveying fluid firstly concentrating on the spatially dependent uncertainty of geometry varying in axial direction as well as the material varying in radial direction the random field is employed to describe the uncertainty parameters then a generalized eigenvalue equation of the varying diameter fgm pipe is derived by the dynamic stiffness method while introducing the random field and variables into the deterministic governing equation due to the input uncertainty the natural frequencies of the varying diameter fgm pipe change to random variables in this respect the stochastic characteristics of natural frequencies can be approximated by the monte carlo simulation however the enormous computational cost is unbearable the efficient artificial neural network surrogate model is introduced and incorporated for the natural frequency uncertainty quantification consequently a stochastic natural frequency analysis approach based on the neural network is proposed for the varying diameter fgm pipe conveying fluid some examples are investigated to illustrate the effectiveness of the proposed method and the influence of input uncertainty on the probabilistic characterization of the natural frequencies keywords stochastic natural frequency analysis varying diameter pipe conveying fluid dynamic stiffness method random field artificial neural network 1 introduction in mechanical structure systems the pipes conveying fluid are applied far and wide as the core of material and energy transportation pipes are employed in aerospace nuclear engineering petrochemical industry power engineering and marine engineering driven by engineering requirements research on the pipes conveying fluid has been implemented thoroughly in the past several decades professor paїdoussis conducted an in depth and detailed analysis on the dynamic behaviors of various single pipes conveying fluid in his book paidoussis 2016 which laid the foundation for the pipe dynamics research lots of papers gu et al 2016 bahaadini et al 2018 liu et al 2019 have reported the dynamic behaviors of pipe conveying fluid inspired by paїdoussis due to the geometric complexity determined by varying functional requirements researches further implemented numerous investigations on varying diameter pipe liu et al 2014 varying stiffness pipe dai et al 2013 curved pipe hu and zhu 2018 multiple span pipe liu et al 2018 l type combined pipe xu et al 2017 t type combined pipe wang and dai 2011 and various complex combined pipes tijsseling 1996 zhao et al 2019 as well known the property of inflow also has significant effect on the dynamic behaviors of pipe conveying fluid in most of traditional researches researchers mainly considered the uniform flow assumption whereas it has some limitations on the flow velocity the uniform flow assumption is inappropriate for high flow velocity meanwhile the boundary drag effect and fluid viscosity in real world are also ignored therefore guo et al 2010 and hellum et al 2010 studied the governing equation based on the non uniform flow assumption zhang et al 2016 constructed the governing equation of varying diameter pipe based on the euler bernoulli model and non uniform flow model and then they solved the natural frequencies and critical flow velocity by the forbenius method wu et al 2019 introduced the non uniform flow model into the curved pipe conveying fluid to investigate the stability furthermore lots of works on pipe conveying fluid have been completed in recent years lu et al 2020 liang et al 2021 zheng et al 2021 zhou et al 2021 askarian et al 2020 studied the stability of pipes conveying fluid supported by a fractional kelvin voigt viscoelastic foundation giacobbi et al 2020 studied the dynamics of pipes with clamped ends as well as the cantilevered pipes conveying fluid whose density varies along the axial direction jiang et al 2020 investigated the stability and 3 dimensional dynamics of the pipe simultaneously subjected to internal and external axial flows tan and ding 2020 investigated the parametric resonance of pipes conveying pulsating high speed fluids based on the timoshenko model mao et al 2021 proposed an approximate approach for investigating the dynamics of pipes conveying fluid with strong boundaries czerwinski and łuczko 2021 studied the nonlinear dynamics of planar curved pipes conveying pulsating flow the dynamic problems of pipes conveying fluid attracts continuous attention of researchers with the rapid development of functionally grade material fgm arsha et al 2015 l w zhang et al 2016 kim and lee 2017 the split new fgm pipes draw the attention of researchers sburlati and kashtalyan 2016 derived the analytical solutions for displacements and stresses in the sandwich pipes with two thin functionally graded interlayers deng et al 2017 studied the stability of the multi span viscoelastic fgm pipe by a hybrid method tang and yang 2018 utilized the homotopy analysis method to investigate the post bulking behavior and nonlinear vibration of a fgm pipe conveying fluid dai et al 2019 investigated the influence of the material parameters on the thermo elastic vibration of axially fgm pipe conveying fluid liang et al 2020 implemented the dynamical analysis of the fgm spinning multi span pipe conveying fluid tong et al 2020 investigated the stability of cantilever fgm nanotube by the galerkin method considering the thermo magnetic coupling effect reddy et al 2019 analyzed the buckling behaviors and post buckled equilibrium state of the fgm pipe conveying hot fluid and investigated the origin of chaotic oscillations more and more novel fgm materials are applied to the pipes for various function realizations the above numerous studies are under the deterministic frame which is fundamental and necessary however the spatial variability results the geometric complexity of pipes conveying fluid which further affects the dynamic performance of pipes significantly the laboratory observations and in field data have illustrated that the uncertainty is always related to the spatial variability zhang et al 2017 additionally the uncertainty of material and geometric structure is inevitably generated in the process of manufacturing and post processing therefore with the existence of source uncertainty the natural frequencies and other dynamic characteristics become to be uncertain responses rather than deterministic ones it is necessary to implement stochastic natural frequency analysis of complex pipes conveying fluid the varying diameter pipe conveying fluid such as the representative tapered pipe is a typical case of pipes with geometric complexity and the fgm is typical one of material complexity so this paper employs the varying diameter fgm pipe possessing both geometric and material complexity with spatial variability to analyze the influence of input uncertainty on the natural frequency response researchers have implemented some stochastic dynamic studies of different structures considering input uncertainty in the past decade hu and qiu 2010 investigated the dynamic responses of an infinitely long beam considering the non probabilistic convex models and interval analysis respectively kishor et al 2011 utilized the polynomial chaos expansion method to study the uncertain vibrational frequencies of an incompressible liquid in a rectangular tank sasikumar et al 2013 developed a stochastic finite element analysis method for the failure assessment of layered composite beams with spatially varying non gaussian inhomogeneities and estimated the failure probability by monte carlo simulations mcs cicirello and langley 2014 proposed the hybrid finite element analysis method for the parametric uncertainty propagating analysis of complex vibro acoustic systems and provided the solving strategy for computationally intensive problem gan et al 2014 presented a new random uncertainty modeling procedure for the vibration analysis of a straight pipe conveying fluid subjected to several randomly uncertain loads jiang et al 2016 proposed an interval process model for the non random vibration analysis of structures wu et al 2018 proposed a unified interval chebyshev based random perturbation method for the hybrid random interval natural frequency analysis of structures feng et al 2019 investigated the stochastic elastoplastic analysis of structures via finite element method and extended support vector regression approach analyzing the probabilistic profile of structural output xu et al 2020 proposed a novel hybrid cubature formula to estimate the moment based uncertainty propagation yang et al 2019 employed the polynomial chaos expansion to approximate the stochastic dynamic characteristics of cracked uncertain hollow shaft gao et al 2020 studied the probabilistic stability characteristics of functionally graded graphene platelets reinforced beams vaishali et al 2020 investigated the stochastic dynamic behaviors of functionally graded shells based on machine learning method wang et al 2020 studied the stochastic stability and structural reliability of functionally graded frame structures with machine learning method guo et al 2021b proposed an efficient stochastic natural frequency analysis method for axially varying functionally graded material pipe conveying fluid in this paper the varying diameter fgm pipe is employed as the deterministic mechanical structure to model the uncertainty related to the spatial variability of the varying diameter and fgm characteristics the karhunen loève expansion k l expansion ghanem and spanos 1991 betz et al 2014 melink and korelc 2014 zhang et al 2019 is employed to generate the gaussian and non gaussian random fields to describe the input spatially dependent uncertainty duo to the introduction of random fields the natural frequency becomes to be random variables the generalized eigenvalue equation derived by the dynamic stiffness method dsm cannot be solved directly to obtain the uncertainty quantification model of stochastic natural frequency the mcs can be implemented for the estimation of statistic characteristics of natural frequencies however the computational cost of mcs is unbearable for complex problems as the evaluations of the generalized eigenvalue equation are generally over 10 4 times inspired by the surrogate models applied widely in machine learning the artificial neural network ann is introduced into the stochastic natural frequency analysis of the varying diameter fgm pipe conveying fluid anns samarasinghe 2006 are widely used in machine learning and deep learning ann can precisely mimic the mapping of inputs and outputs and further predict the output of unknown samples whose strong ability on nonlinear fitting provides the possibility of approximating implicit functions accurately using anns to estimate the statistical characteristics of uncertain outputs has been attempted in structural reliability analysis which shows a very high efficiency sadovský and guedes soares 2011 employed the ann model to estimate the collapse strength of the plates as a geometrical imperfection function papadopoulos et al 2012 proposed a neural network based subset simulation method to improve the computational efficiency and robustness of reliability analysis chan and low 2012 used the response surface and neural network methods to investigate the reliability based parametric studies of laterally loaded piles li et al 2018 proposed a dual neural network method to overcome the difficulty of multiple integrations as well as the computational burden chantola et al 2019 studied the reliability of transformer by supplementary variable technique and neural network approach inspired by the broad applications of ann in probabilistic analysis it is introduced into the stochastic natural frequency analysis of the varying diameter fgm pipe conveying fluid this paper is arranged as follows section 2 reviews the theoretical formulation of random field generated by k l expansion radially varying fgm and the governing equation of varying diameter pipe the stochastic natural frequency analysis is implemented by introducing the random field into the governing equation and the generalized eigenfunction equation is derived by the dsm in section 3 in section 4 the neural network is illustrated and introduced into the stochastic natural frequency of the varying diameter fgm pipe conveying fluid for estimating the mean standard deviation probability density function pdf and cumulative distribution function cdf of the natural frequencies in section 5 some examples are investigated to demonstrate the performance of the proposed method section 6 concludes the paper 2 theoretical formulation 2 1 functionally graded material considering a fgm pipe the mechanical properties e g the young s modulus and mass density of the fgm continuously change along the radial direction the power law is adopted to depict the variation of material property and the effective material property is expressed as deng et al 2017 1 ρ v i ρ i v o ρ o 2 e v i e i v o e o where ρ e and v denote the mass density young s modulus and volume fraction of the component material of fgm the subscripts i and o indicate the corresponding inner and outer materials of fgm respectively the poisson s ratio is assumed as a constant the volume fractions following power law are expressed as 3 v i r o r r o r i n r o r t n χ n 4 v o 1 v i where r i and r o denote the inner and outer radiuses of the fgm pipe r is the radius of the pipe reference point t is the thickness and n is the volume fraction index furthermore define the material property ratios as ρ r a t i o ρ i ρ o and e r a t i o e i e o respectively the material properties are rewritten as 5 ρ ρ o 1 ρ r a t i o 1 χ n 6 e e o 1 e r a t i o 1 χ n 2 2 governing equation of varying diameter pipe the schematic diagram of the varying diameter fgm pipe conveying fluid is drawn in fig 1 which is a shrinking pipe the length of the pipe is l and the thickness h remains unchanged d 0 and d 0 denote the inner and outer diameters at the thicker end i e the entrance end d l and d l denote the inner and outer diameters at the thinner end i e the exit end the inner diameter d i of the pipe change linearly along the axial direction and it can be expressed as 7 d i x 1 γ x l d 0 where γ represents the reduction factor which is numerically equal to the tangent of taper angle because the inner and outer diameters of varying diameter pipe vary along with the axial direction it is more appreciate to employ the non uniform flow model therefore the inflow in this paper is the incompressible laminar flow whose velocity follows parabolic distribution according to the conservation of fluid mass the flow quality is a constant if the maximum flow velocity at the entrance end is v c 0 the maximum velocity at any section of the pipe is 8 v c x 1 1 γ x l 2 v c 0 assuming that the axis of the pipe is not extensible the vibrational control equation based on the euler bernoulli model can by expressed by the hamiton principle of open systems as follows zhang 2016 9 e i x w m p m f w 1 2 2 m f v w m f v w m f v w 1 3 m f w v 2 m f w v 2 2 m f v v w 0 where m f denotes the mass of fluid in the pipe per unit length m p denotes the mass of the pipe per unit length w denotes the lateral displacement w and w denote the derivatives of w to axial displacement x and time t respectively 2 3 random field considering the spatial variability of varying diameter pipe and fgm the input uncertainty is spatially dependent which indicates that the input uncertainty should be described by the random field the k l expansion is employed to implement the random field discretization define a complete probability space d f p from the sample space d assume that ψ z r represents a random variable so z r is the set of all random variables in d f p h x θ is employed as the random field for describing the spatially dependent uncertainty of material and geography properties for a fixed x 0 h x 0 θ is a random variable while for a given θ 0 h x θ 0 is a realization of the random field considering the positive nature of the material and geography properties of the pipe both gaussian and lognormal distribution types of random fields are adopted to model the uncertainty of random inputs the spatial variation of uncertain material and geography properties is simulated by the exponential covariance function c o v x 1 x 2 the expression of c o v x 1 x 2 for random field is as follows betz et al 2014 10 c o v x 1 x 2 σ h 2 e x 1 x 2 l for 1 d fields where σ h illustrates the standard deviation of the random field and l denote the correlation length the k l expansion for the discretization of random fields is constructed with the decomposition of a bounded symmetric and positive definite covariance function as 11 c o v x 1 x 2 i 1 κ i φ i x 1 φ i x 2 where the eigen pairs κ i φ i x in eq 11 are the solutions of the second kind of fredholm integral equation i e 12 i 1 ω c o v x 1 x 2 φ i x 2 d x 2 κ i φ i x 1 where κ i denotes the eigenvalue and φ i x 1 denotes the eigenfunction the eigenfunctions are orthogonal with each other i e ω φ i x φ j x d x δ i j where δ i j is the kronecker symbol based on the above descriptions each parameter in the set of random variables is expressed as 13 ψ i θ 1 κ i d h x θ μ x φ i x d d for the gaussian random field the total set of ψ i θ i 1 2 is the collection of independent normal random variables truncating the random field with q terms the k l expansion of h x θ is expressed as 14 h x θ h ˆ q x θ μ x i 1 q σ x κ i ψ i θ φ i x where μ x and σ x illustrate the mean value and standard deviation of the gaussian random field respectively for the lognormal random field it is remodeled as the exponential product of the gaussian random field 15 h x θ h ˆ q x θ exp μ x i 1 q σ x κ i ψ i θ φ i x where μ x log μ log 2 x σ log μ log 2 x σ x log σ log μ log 2 x 1 μ log x and σ log x indicate the mean value and standard deviation of the corresponding lognormal random field respectively in this paper the random field contains the first five orders of the k l expansion and the correlation length is set as l 1 based on the research in betz et al 2014 the above settings can ensure a feasible computation time 3 stochastic natural frequency analysis with dsm eq 9 is a high order differential equation which is hard to solve the dynamic stiffness method dsm is utilized to approximate the solutions according to the above introductions the uncertainties of material and geography properties i e elastic modulus e θ mass density ρ θ reduction factor γ θ of inner diameter and volume fraction index n θ are described with random field where θ θ 1 θ 2 θ p denotes the random field consisting of all random variables expanded by k l expansion the thickness h θ and flow velocity v c 0 θ at the entrance end are also regarded as random variables following normal or lognormal distribution after introducing the random field and random variables the dynamic responses such as lateral displacement and natural frequencies are converted into random variables as the inner and outer diameters are related to x the fluid mass m f θ x pipe mass m p θ x and moment of inertia i θ x of section x are expressed as 16 m f θ x ρ f a f θ x ρ f π 1 γ θ x l 2 d 0 2 4 1 α 1 θ x l α 2 θ x 2 l 2 ρ f a f 0 m p θ x ρ p a p x ρ p θ π 1 γ θ x l 2 d 0 2 d 0 2 4 1 α 1 θ x l α 2 θ x 2 l 2 ρ p θ a p 0 i θ x π d x 4 θ d x 4 θ 64 1 β 1 θ x l β 2 θ x 2 l 2 β 3 θ x 3 l 3 β 4 θ x 4 l 4 i 0 where a f 0 a p 0 and i 0 represent the geography constants at the entrance end of tapered pipe α and β are expressed as 17 α 1 θ 2 γ θ α 2 θ γ 2 θ β 1 θ 4 γ θ β 2 θ 6 γ 2 θ β 3 θ 4 γ 3 θ β 4 θ γ 4 θ for simplicity introduce the dimensionless variables as follows 18 ξ x l η θ w θ l v θ m f i θ e θ i i θ v c θ l ω θ m f 0 m p 0 e θ i 0 l 2 ω θ τ θ e θ i 0 m f 0 m p 0 t l 2 m m f 0 m f 0 m p 0 assume the solution of eq 9 as η ξ τ θ η ξ θ e i ω θ τ θ the control equation is transformed as 19 1 β 1 θ ξ β 2 θ ξ 2 β 3 θ ξ 3 β 4 θ ξ 4 d 4 η d ξ 4 2 β 1 θ 2 β 2 θ ξ 3 β 3 θ ξ 2 4 β 4 θ ξ 3 d 3 η d x 3 2 β 2 θ 6 β 3 θ ξ 12 β 4 θ ξ 2 1 3 1 α 1 θ ξ α 2 θ ξ 2 v 2 θ d 2 η d x 2 i m θ v θ ω θ 1 α 1 θ ξ α 2 θ ξ 2 1 3 α 1 θ 2 α 2 θ ξ v 2 θ d η d ξ 1 2 α 1 θ 2 α 2 θ ξ i m θ v θ ω θ 1 α 1 θ ξ α 2 θ ξ 2 ω 2 θ η θ 0 the trail function in series is η ξ θ n m 0 a n m θ ξ n m k a 0 0 and the derivatives of it are expressed as 20 d η d ξ n m 0 n m k ξ n m k 1 d 2 η d ξ 2 n m 0 n m k n m k 1 ξ n m k 2 d 3 η d ξ 3 n m 0 n m k n m k 1 n m k 2 ξ n m k 3 d 4 η d ξ 4 n m 0 n m k n m k 1 n m k 2 n m k 3 ξ n m k 4 when nm 0 substituting eq 20 into eq 19 can obtain 21 a 0 k k 1 k 2 k 3 0 it means k j 0 1 2 3 j 1 2 3 4 substitute the trail function into vibration control equation and let the powers of ξ be 0 then the a n m k θ can be expressed as 22 a 0 k θ 1 a 1 k θ β 1 θ k 1 k 1 a 0 k a 2 k θ β 1 θ k k 2 a 1 k θ β 2 θ k k 1 ζ 1 θ k 2 k 1 a 0 k θ a 3 k θ β 1 θ k 1 k 3 a 2 k θ β 2 θ k k 1 ζ 1 θ k 3 k 2 a 1 k θ β 3 θ k 1 k k 1 α 1 θ ζ 1 θ k ζ 2 θ k 3 k 2 k 1 a 0 k θ a 4 k θ β 1 θ k 2 k 4 a 3 k θ β 2 θ k 2 k 1 ζ 1 θ k 4 k 3 a 2 k θ β 3 θ k 2 k 1 k α 1 θ ζ 1 θ k ζ 2 θ k 4 k 3 k 2 a 1 k θ β 4 θ k 2 k 1 k k 1 α 2 θ ζ 1 θ k k 1 ζ 4 θ k ζ 3 θ k 4 k 3 k 2 k 1 a 0 k θ a n m 5 k θ β 1 θ k n m 3 k n m 5 a n 4 β 2 θ k n m 3 k n m 2 ζ 1 θ k n m 5 k n m 4 a n m 3 β 3 θ k n m 3 k n m 2 k n m 1 α 1 θ ζ 1 θ k n m 1 ζ 2 θ k n m 5 k n m 4 k n m 3 a n m 2 β 4 θ k n m 3 k n m 2 k n m 1 k n m α 2 θ ζ 1 θ k n m 1 k n m ζ 4 θ k n m 1 ζ 3 θ k n m 5 k n m 4 k n m 3 k n m 2 a n m 1 ζ 5 θ k n m ζ 6 θ k n m 5 k n m 4 k n m 3 k n m 2 a n m n m 0 1 where 23 ζ 1 θ 1 3 v 2 θ ζ 2 θ i m θ v θ ω θ 1 3 v 2 θ ζ 3 θ 1 2 α 1 θ i m θ v θ ω θ ω 2 θ ζ 4 θ α 1 θ i m θ v θ ω θ 2 3 α 2 θ v 2 θ ζ 5 θ α 2 θ i m θ v θ ω θ ζ 6 θ α 2 θ i m θ v θ ω θ α 1 θ ω 2 θ as k has four solutions the trial function can be rewritten as 24 η ξ θ a 1 f 1 ξ θ a 2 f 2 ξ θ a 3 f 3 ξ θ a 4 f 4 ξ θ where a j j 1 2 3 4 are constants representing the coordinates of the solution in the space of generalized coordinate system f j ξ θ and f j ξ θ n m 0 a n k j θ ξ n m k j substitute the trial function 24 into control equation and let the powers of ξ be 0 omitting the high order infinitesimals of γ θ the a n k θ can be obtained the dimensionless bending moment and shear force can be expressed as 25 m ξ θ m l e i i 1 β 1 θ ξ β 2 θ ξ 2 β 3 θ ξ 3 β 4 θ ξ 4 d 2 η d ξ 2 q ξ θ q l 2 e i i 1 β 1 θ ξ β 2 θ ξ 2 β 3 θ ξ 3 β 4 θ ξ 4 d 3 η d ξ 3 β 1 θ 2 β 2 θ ξ 3 β 3 θ ξ 2 4 β 4 θ ξ 3 d 2 η d ξ 2 the bending moment and shear force at both pipe ends are expressed as 26 f q 0 θ m 0 θ q 1 θ m 1 θ t the relation between the nodal force and generalized coordinates is f θ b θ a where 27 b θ f 1 0 θ 2 β 1 θ f 1 0 θ f 2 0 θ 2 β 1 θ f 2 0 θ f 1 0 θ f 2 0 θ β θ f 1 1 θ ς θ f 1 1 θ β θ f 2 1 θ ς θ f 2 1 θ f 1 1 θ f 2 1 θ f 3 0 θ 2 β 1 θ f 3 0 θ f 4 0 θ 2 β 1 θ f 4 0 θ f 3 0 θ f 4 0 θ β θ f 3 1 θ ς θ f 3 1 θ β θ f 4 1 θ ς θ f 4 1 θ f 3 1 θ f 4 1 θ where β θ 1 β 1 θ β 2 θ β 3 θ β 4 θ ς θ β 1 θ 2 β 2 θ 3 β 3 θ 4 β 4 θ and d d ξ the relation between the dimensionless displacement and generalized coordinates is 28 η ξ θ a 1 f 1 ξ θ a 2 f 2 ξ θ a 3 f 3 ξ θ a 4 f 4 ξ θ ϕ ξ θ a 1 f 1 ξ θ a 2 f 2 ξ θ a 3 f 3 ξ θ a 4 f 4 ξ θ it is rewritten in the matrix form as δ e θ p θ a where 29 δ e θ η 1 θ η 1 θ η 2 θ η 2 θ t a a 1 a 2 a 3 a 4 t p θ a 0 k 1 θ 0 0 0 a 1 k 1 θ a 0 k 2 θ 0 0 f 1 1 θ f 2 1 θ f 3 1 θ f 4 1 θ f 1 1 θ f 2 1 θ f 3 1 θ f 4 1 θ the relation between nodal force and nodal displacement of the pipe can be obtained as 30 f θ b θ p 1 θ δ e θ s θ δ e θ where s θ b θ p 1 θ is the stochastic stiffness matrix of the pipe system the boundary condition of the varying diameter pipe conveying fluid is pinned pinned i e 31 ξ 0 η 1 θ 0 η 1 θ 0 m 1 0 θ 0 q 1 0 θ 0 ξ 1 η 2 θ 0 η 2 θ 0 m 2 1 θ 0 q 2 1 θ 0 substituting the boundary condition into eq 30 can obtain 32 q 1 θ 0 q 2 θ 0 s 11 θ s 12 θ s 13 θ s 14 θ s 21 θ s 22 θ s 23 θ s 24 θ s 31 θ s 32 θ s 33 θ s 34 θ s 41 θ s 42 θ s 43 θ s 44 θ 0 η 1 θ 0 η 2 θ considering the free vibration of the pipe without external forces only the stochastic characteristic equation is 33 s 22 θ s 24 θ s 42 θ s 44 θ η 1 θ η 2 θ 0 the stochastic natural frequency can be calculated by solving the following equation 34 h ω θ s 22 θ s 24 θ s 42 θ s 44 θ 0 the generalized eigenvalue equation 34 is obtained which is the basis of the stochastic natural frequency analysis of the varying diameter fgm pipe conveying fluid as the natural frequencies has become random variables the uncertainty quantification of natural frequencies can be obtained by calling equation 34 iteratively whose computational cost is normally unbearable due to the tens of thousands realizations consequently an efficient ann surrogate model is introduced to estimate the statistic characteristics of stochastic natural frequencies 4 artificial neural network surrogate model ann is a perfect surrogate model for dealing with data classification and complex implicit nonlinear mapping problems the ann is an adaptive nonlinear system consisting of a series of interconnected neurons the neurons are connected with transfer functions and weighted matrix and form a certain network or topology lots of neurons are arranged in several layers the first layer is the input layer which illustrates the input data the final layer is the output layer which provides system responses the layers between the input layer and output layer are the hidden layers which construct the mapping between the input data and responses the schematic diagram of the typical ann model is drawn in fig 2 the relation between input x and output y can be expressed as 35 y f i 1 t w i x i b p f w τ x b p where f represents the transfer function x x 1 x 2 x t τ is the input vector w w 1 w 2 w t τ denotes the corresponding weight vector to x and b p is the threshold determining the shift of transfer function to ensure that the errors between the ann predicted values and the desired function values are minimal a set of configuration values must be adjusted and selected i e let the ann learn and train in this work the back propagation bp neural network is adopted the transfer function in the hidden layers is logsig function and the activation in the output layer is a purelin function delta learning rule is adopted which belongs to supervised learning strategy it utilizes the negative gradient of error to adjust connection weights to monotonically decrease the network output error the error of the predicted output and the actual output is expressed as 36 e w 1 w 2 w l 1 2 y y τ y y where y denotes the actual output for the k th layer the gradient of error function to the weight matrix is 37 e w k y k 1 y l y j y l z l w l τ j y l 1 z l 1 w k 2 τ j y k 1 z k 1 w k 1 τ j y k z k k l l 1 1 where y 0 x when k 1 l is the number of the layers and z k denotes the received values of the k th layer j is the jacobi matrix expressed as 38 j y k z k y k z k d i a g d y 1 k d z 1 k d y 2 k d z 2 k d y n k k d z n k k k 1 2 l where n k is the number of neurons in the k th layer the weights are updated when a sample is learned for the i 1 th sample the weight matrix w k i 1 is revised with w k i as follows 39 w k i 1 w k i δ w k i k 1 2 l based on the delta learning rule the adjustment of weight matrix is 40 δ w k i ψ i e i w k i τ i δ w k i 1 where ψ i denotes the learning efficiency of the i th step the second item represents a potential energy inertia which is improved for avoiding the local optimum the inertia coefficient is determined with the comparison of two changes of weight matrix additional details about ann configurations can refer the references samarasinghe 2006 sadovský and guedes soares 2011 chan and low 2012 papadopoulos et al 2012 li et al 2018 chantola et al 2019 in this field about the data set it is divided into two subsets the training subset is utilized to adjust the network architecture and internal parameters while the test subset is utilized to verify the generalization ability of the data set the data determines the prediction quality of the network so the training data covers all realizations of the input variables which are generated by k l expansion or sampling randomly the bp ann is employed to construct the mapping relationship between the random inputs and the stochastic responses of the varying diameter pipe conveying fluid benefitting from the powerful ability on dealing with complex implicit mapping problems the bp ann can greatly reduce the number of simulations while ensuring the computational accuracy by combining the random fields stochastic eigenvalue equation and ann model a stochastic natural frequency analysis approach is proposed the computational process is conducted as shown in fig 3 5 example investigation 5 1 validation of the method this subsection verifies the dsm for the solution of the natural frequency and the stochastic natural frequency analysis method combining the random field dispersed by the k l expansion the generalized eigenvalue equation and the ann model as the varying diameter fgm pipe conveying fluid was not ever reported in literature a homogenous pipe i e n 0 and γ 0 is employed to illustrate the proposed method considering a pinned pinned pipe conveying fluid the geometrical parameters are length 2 0 m outer diameter 0 1 m and thickness 0 002 m the elastic modulus and density of the pipe are 68 6 g p a and 2800 k g m 3 respectively the fluid density is 1000 k g m 3 the laminar flow velocity has three conditions v c 0 0 m s v c 0 20 m s and v c 0 40 m s the first four order natural frequencies are listed in table 1 compared with the reference results in zhai et al 2012 it can be seen that the natural frequencies obtained by the proposed method match well with the reference results in literature the low relative error demonstrates the accuracy of the proposed method which provides the basis for the stochastic natural frequency analysis of the pipe to validate and illustrate the proposed stochastic natural frequency analysis method the material properties i e elastic modulus and mass density are modeled as gaussian material random field by k l expansion the mean values of material properties do not change whereas the coefficient of variation is 0 1 meanwhile the uncertainty of the flow velocity is also considered and follows the gaussian distribution the corresponding dimensionless flow velocity conditions are also adjusted as v 0 0 9556 v 0 1 4334 and v 0 1 9112 and the corresponding coefficient of variation is 0 01 in general 11 random variables are contained in the stochastic analysis including two random fields and a random variable the statistical results of first four order natural frequencies estimated by ann models corresponding to different sample sizes are reported in table 2 compared with the results of direct mcs the results show that the ann models perform sufficiently accurate results with the converged sample size of 768 hence the ann model with 768 design points is utilized hereafter for conducting the statistical analysis of the natural frequency fig 4 shows the pdfs of the first four order natural frequencies obtained by the ann models and fig 5 displays the cdfs of the natural frequencies the results show that the mean values of the first four natural frequencies decrease with the increase of v 0 while the change of standard deviations is opposite more specific comparisons can be found in table 3 which reports the statistics of the first four order stochastic natural frequencies with different v 0 for the third and fourth natural frequencies the descent rate of mean values is quite slower which presents that the axis of the probability density function moves slowly and the crossover range of pdfs is getting bigger and bigger in fig 5 d it can be seen that the areas between the cdfs are almost symmetric about the mean value which means that the uncertainty of the v 0 has more significant effect on the stochastic dynamic response than the change of v 0 by comparing with the statistical results obtained by the direct mcs with 10 5 samples the accuracy and efficiency of the ann based uncertainty quantification method are sufficiently demonstrated the effects of the stochastic properties on the uncertainty propagation to the dynamic response of varying diameter fgm pipe conveying fluid are investigated in following cases after validating the proposed ann model based stochastic natural frequencies analysis method 5 2 effect of the reduction factor the fgm varies smoothly in the direction of radial in deterministic analysis the random variation of material properties at each depth is considered to simulate uncertainty propagation of the source uncertainty in material the material properties of the fgm are as follows 41 t i 6 a l 4 v inner layer e i 115 g p a ρ i 4515 k g m 3 s i c outer layer e o 440 g p a ρ o 3210 k g m 3 the varying law of fgm follows the formulations in subsection 2 1 the deterministic parameters of the pipe are outer diameter 0 080 m and length 15 m the probabilistic information of random fields and random variables are listed in table 4 in general four lognormal random fields and two lognormal random variables are considered which contains 22 random variables in total while the random field is dispersed into the first five orders of the k l expansion what must be emphasized is that when the probabilistic information such as the means and covs of one pipe parameter is changed other parameters follow the distribution forms provided in table 4 in this subsection the impact of uncertain reduction factor γ on the stochastic natural frequencies of varying diameter fgm pipe is investigated three cases of varying γ are considered as γ 1 0 1 γ 2 0 2 and γ 3 0 3 due to the variation of the parameters of the pipe the sample size of the ann model needs to be further investigated for a balance of both accuracy and efficiency the results of γ 1 0 1 are shown in table 5 which illustrate that the ann models can implement sufficiently exact natural frequencies with the converged sample size of 512 compared with the results obtained by mcs with 10 5 samples in deterministic dynamic analysis all pipe parameters are taken as the mean values the deterministic natural frequencies and critical dimensionless flow velocities are reported in table 6 it can be found that with the increasing of γ the natural frequencies decrease and the critical dimensionless flow velocity decreases simultaneously the effect of reduction factor γ is further implemented by the ann models with the sample size of 512 the pdfs and cdfs of the first four natural frequencies with varying reduction factors are displayed in fig 6 and fig 7 respectively it can be noticed that the means of first four order natural frequencies decrease with the increasing of γ which matches the varying trend of deterministic natural frequencies with increasing γ furthermore the standard deviations of first four natural frequencies are found to fall with the increase of γ the variation rule of the mean values of the stochastic natural frequencies with varying reduction factors is mainly dependent on the stability analysis of the varying diameter fgm pipe conveying fluid the variation of the standard deviation pdf or cdf of natural frequencies illustrates the effect of the source uncertainty on the stochastic natural frequencies which is the focus of this work as the cov of the uncertain reduction factor is unchanged the increase of γ means that the input uncertainty is increasing the corresponding dynamic responses i e the natural frequencies would have larger uncertainties and wider stochastic bounds yet not in results it illustrates that the reduction factor γ as a significant geography parameter of varying diameter fgm pipe has main effect on the variation of the stochastic natural frequencies while the effect of its uncertainty on stochastic natural frequencies is mitigated 5 3 effect of the pipe thickness according to the setting of pipe parameters in previous subsection 5 2 the effect of the dimensionless thickness τ is investigated three conditions for dimensionless pipe thickness are considered as follows τ 0 0028 τ 0 0042 and τ 0 0056 the deterministic dynamic results with different τ are reported in table 7 it can be noticed that the natural frequencies decrease with the growing up of dimensionless pipe thickness and the critical dimensionless flow velocity increases simultaneously the pdfs and cdfs of the natural frequencies with different pipe thicknesses τ are displayed in fig 8 and fig 9 respectively the results illustrate the effect of the variation in pipe thickness on the first four order natural frequencies wherein it can be found that the mean values of the first four natural frequencies rise with the increase of τ and the variation rule is same for corresponding standard deviations the increase of the standard deviation of natural frequencies with different thicknesses is mainly influenced by the increase of input source uncertainty and the increase of the mean natural frequencies is influenced by the variation of the geometry which can also be validated by the deterministic dynamic results 5 4 effect of the flow velocity the dimensionless flow velocity is considered as three conditions to investigate the effect of the flow velocity which are as follows v 0 i 0 6806 v 0 i 1 3612 and v 0 i 2 0418 the deterministic natural frequencies under three cases are reported in table 8 it is obvious that the deterministic natural frequencies decrease with the increasing of the dimensionless flow velocity the pdfs and cdfs of natural frequencies for different dimensionless flow velocities are plotted in fig 10 and fig 11 respectively the figures depict that the mean values of the natural frequencies decrease with the increase of v 0 which is opposite to the varying rule of the corresponding standard deviations the varying trend of mean results is consistent with that of the deterministic results with the rise of the source uncertainty of v 0 the uncertainty of the natural frequency responses also increases it should be noted that as the increase of flow velocity makes less decrease of high order natural frequency and the increase of input source uncertainty makes large increase of the stochastic bounds of natural frequency response the stochastic bounds of second third and fourth natural frequencies overlap with each other obviously with the increase of v 0 to further investigate the effect of the critical flow velocity and stability on the stochastic natural frequencies the change of the standard deviation of the stochastic fundamental natural frequency is drawn in fig 12 the flow velocity as the standard deviation equals to 0 is the critical flow velocity v c r around the critical flow velocities the standard deviations raise up to the maxima which indicates the pipe transforms from the stable state to the unstable one which should be paid attention to when the increasing flow velocity approaches the critical flow velocity 5 5 effect of the volume fraction index the volume fraction index n of the fgm affects the natural frequency of the fgm pipe conveying fluid obviously this subsection considers three conditions of n as follows n i 1 n i i 10 and n i i i 100 the deterministic dynamic results with different volume fraction indices are reported in table 9 it can be found that the deterministic natural frequencies grow up with the increasing of the volume n at the same time the critical dimensionless flow velocity also increases the pdfs and cdfs of natural frequencies with different volume fraction indices are presented in fig 13 and fig 14 respectively with the increase of volume fraction index both of the mean values and standard deviations of natural frequencies increase the means of stochastic natural frequencies with different volume fraction indices vary as the rule of deterministic dynamic analysis the standard deviations of natural frequencies rise due to the increase of input source uncertainty 5 6 effect of the degree of stochasticity in this subsection the effect of the degree of stochasticity is investigated the components of fgm are assumed to be unchanging and the coefficient of variation cov of fgm material properties i e the young s modulus e and mass density ρ varies as follows c o v i 0 05 c o v i i 0 1 c o v i i i 0 15 by comparing the statistical characteristics of stochastic natural frequencies the effects of varying covs of material properties on statistical moments of the natural frequencies are illustrated the pdfs and cdfs of first four natural frequencies with different degrees of stochasticity are shown in fig 15 and fig 16 respectively from the results the mean values do not change with the cov of the fgm material properties increasing whereas the degree of stochasticity for the natural frequencies increases the means of natural frequencies meet with the deterministic results in table 9 it fully demonstrates that the change of cov has no effect on the means of stochastic natural frequencies for a clearer presentation the standard deviations of natural frequencies with the increasing covs of material properties are shown in fig 17 the increase of cov represents the increase of input source uncertainty which results lager variances of the natural frequencies it further illustrates that except the increasing of standard deviation for the natural frequencies with the increase of cov the standard deviation also rises with the increase of orders of natural frequencies 5 7 sensitivity analysis to identify the importance of the various source uncertainties on the natural frequency of varying diameter fgm pipe conveying fluid it is necessary to implement sensitivity analysis guo et al 2019 2021a to identify the random fields or variables with the largest effect on stochastic dynamic response the moment independent global sensitivity analysis method cheng et al 2020 is employed to estimate the importance degree of the random fields and variables the global sensitivities of the source uncertainties are displayed in fig 18 it depicts that the importance ranking of the source uncertainties is n ρ i ρ o γ e i e o which illustrates that the uncertainty of the volume fraction index n has the largest impact on the stochastic natural frequency followed by the mass density ratio ρ i ρ o reduction factor γ and elastic modulus ratio e i e o the sensitivity analysis provides significant reference on the uncertainty control of the material properties and geometric characteristics 6 conclusion this paper proposes an artificial neural network ann based stochastic natural frequency analysis approach to investigate the uncertainty propagation of the source uncertainties in the varying diameter functionally graded material fgm pipe conveying fluid considering the spatial variation of the material properties of fgm and geography parameters the random field is employed to describe the inevitable uncertainties and the karhunen loève k l expansion is utilized to discrete the random field into random variables the source uncertainties are substituted into the deterministic governing equation of the varying diameter fgm pipe conveying fluid and the dynamic stiffness method dsm is employed to solve and obtain the stochastic eigen value equation the ann model widely applied in machine learning is introduced to mimic the stochastic eigen value equation to reduce the computational cost the proposed stochastic natural frequency analysis method for the varying diameter fgm pipe can implement uncertainty quantification of the stochastic natural frequency efficiently and accurately the efficiency and accuracy of the proposed method are firstly demonstrated with a validation example by comparing the deterministic results with the results in references as well as the stochastic natural frequency analysis results with those obtained by monte carlo simulation mcs compared with the mcs method the ann based method has significant higher computational efficiency without a wastage of accuracy this paper further explores the effect of reduction factor pipe thickness the maximum flow velocity at entrance end and volume fraction index of the fgm whose results fully illustrate that the inevitable source uncertainties in varying diameter pipe conveying fluid cause significant changes of dynamic responses from the deterministic values the stochastic natural frequency analysis considering the source uncertainty is essential and viable for the adequate safety the probabilistic description of the stochastic natural frequency is subjected to the visible variability from the deterministic value furthermore the sensitivity analysis identifies the importance degrees of the various source uncertainties on the stochastic natural frequency of the varying diameter fgm pipe the proposed stochastic dynamic analysis method combining the random fields dynamic analysis method and ann model can also be applied to the other uncertain complex structure systems credit authorship contribution statement qing guo methodology writing original draft writing review editing funding acquisition visualization yongshou liu methodology supervision writing original draft bingqian chen investigation validation writing original draft yidu zhang writing original draft data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationship that could have appeared to influence the work reported in this paper acknowledgement this work is sponsored by innovation foundation for doctor dissertation of northwestern polytechnical university no cx202030 the authors are grateful for the financial support 
20334,the performance of coastal breakwaters in reducing wave height and energy is an important problem this paper presents an experimental and numerical investigation of solitary wave interaction with two submerged rectangular obstacles white light and particle image velocimetry piv techniques were utilized to study the free surface profile of a solitary wave and flow field in an experimental procedure the piv test results revealed that two clockwise vortices are generated between and after the two obstacles and the white light test results showed that three phenomena of wave breaking crest crest exchange and air water mixing occur in the solitary wave passage over the two obstacles a transient two dimensional numerical model was used to study solitary wave interaction with two rectangular obstacles the numerical model was validated with experimental results in terms of free surface profile velocity fields and velocity profiles using this model the effects of obstacles height and distance were investigated the numerical results showed that when increasing the height of the obstacles the drag force applied on the obstacles the strength of vortices the energy loss and the height reduction of the solitary wave increased the presence of the second obstacle and wave breaking occurrence constrain the movement of vortices and cause a negative drag coefficient on the obstacles in some cases the energy loss the height reduction of the solitary wave and the strength of the vortex generated between the obstacles increased as the distance of the obstacles increased up to s l 1 5 in contrast the strength of the vortex generated after the second obstacle was decreased by increasing the distance of two obstacles keywords solitary wave wave breaking drag coefficient vortex strength piv cfd 1 introduction nowadays the use of submerged obstacles as breakwaters is a well known solution to reduce the destructive effects of sea waves colliding with coastal areas structures and to prevent coastal erosion in coastal areas sea waves are in the form of solitary waves so many researchers study the interaction of a solitary wave with different breakwaters and the flow pattern before and after them finding the appropriate shape and size for breakwaters requires investigation of the flow pattern around them the force applied to them and their ability to reduce the wave s energy and height research about waves is divided into wave classification and production wave breaking and their interaction with obstacles due to their importance in coastal areas wave breaking and their interaction with obstacles are widely used and studied by analytical solutions numerical simulations experimental investigations or a combination of these three the analytical studies of solitary wave transformation over a shelf were some of the first studies on this subject conducted by several research groups tappert and zabusky 1971 johnson 1972 miles 1979 goring and raichlen 1992 in experimental and numerical studies of waves a wave maker generated the desired waves anbarsooz et al 2013 numerically simulated linear and nonlinear waves in intermediate and deep water using piston and flap type wave makers wu et al 2014 presented a numerical meshless model for generating a solitary wave as a potential flow after wave production researchers investigated waves breaking in shallow and deep waters by experimental and numerical studies because of their application in the study of tsunamis near coasts grilli et al 1994 investigated the shoaling of a solitary wave using a potential model and laboratory experiments silva et al 2000 investigated a solitary wave s interaction with a permeable slope breakwater as a coastal area using a linear solution synolakis and bernard 2006 reviewed the development of tsunami modeling tools throughout history hsiao and lin 2010 investigated tsunami like solitary waves on a sloping beach experimentally and numerically in the numerical procedure a two dimensional volume of fluid vof model was used yao et al 2018 investigated a tsunami like solitary wave interaction with fringing reefs the effects of solitary wave height and shape of reefs were studied by experimental and numerical procedures due to the importance of oil structures in the seas experimental and numerical studies of the passage of a solitary wave over submerged cylinders have been some of the first studies of solitary wave interaction with submerged obstacles cooker et al 1990 presented a two dimensional irrotational numerical solution for the interaction of a solitary wave with a submerged semicircular cylinder also they conducted a series of experiments in a channel with a piston type wave maker to validate the numerical results chian and ertekin 1992 investigated the interaction of a solitary wave and submerged horizontal cylinder using a boundary element method and examined the force applied on the cylinder xiao et al 2013 studied the interaction of a solitary wave with a horizontal cylinder numerically and investigated the forces applied on the cylinder the model was based on the k ε turbulence model and the volume of fluid method zarruk et al 2015 investigated the generation and evolution of vortices due to a solitary wave propagating over cylindrical structures experimentally and numerically in the experimental procedure dye injection was used for flow visualization and a three dimensional vof les model was used in the numerical model predicting wave reflection transmission and dissipation rtd coefficients is one of the objectives of studies conducted on solitary wave interaction with obstacles silva et al 2000 seabra santos et al 1987 chang et al 2005 lin 2004 investigated the interaction of a solitary wave with a submerged rectangular obstacle with different lengths and heights numerically and calculated wave rtd coefficients in all cases wang et al 2018 investigated a solitary wave s rtd coefficients due to interaction with a submerged vertical thin plate by developing a two dimensional multi phase viscous model flow visualization around obstacles due to solitary wave passage is also an important issue and is studied in various experimental and numerical studies ting and kim 1994 conducted laboratory experiments to investigate the interaction between time periodic water waves and a submerged rectangular obstacle tang and chang 1998 investigated the flow separation and vortex formation during the passage of a solitary wave over a submerged rectangular obstacle using experimental and numerical methods the flow visualization was performed by adding red dye to the water and in the numerical method a stream function vorticity model was used huang and dong 2001 numerically investigated the interaction between a solitary wave and a rectangular obstacle the numerical model solved the unsteady two dimensional navier stokes equations and a piston type wave maker produced a solitary wave in the computational domain lin et al 2005 conducted an experimental study of the interaction of a solitary wave and a submerged vertical plate using the particle image velocimetry piv technique for visualizing the flow field and vortex shedding one year later lin et al 2006 studied the generated vortices and free surface profile due to the passage of a solitary wave over a submerged rectangular obstacle experimentally using the piv technique and the laser induced fluorescence lif technique lin and huang 2010 studied the vortex generation and evolution due to solitary wave passage over a submerged rectangular obstacle using a two dimensional lagrangian type numerical method chang et al 2012 presented a two dimensional stream function vorticity model and studied the vortex generation and the flow field due to solitary wave passage over a cavity the experimental and numerical interaction of a solitary wave and a submerged vertical obstacle was studied by wu et al 2012 the piv technique was used for flow visualization and a two dimensional vof typed model based on reynolds averaged navier stokes equations was used for numerical simulations hayatdavoodi et al 2017 presented a numerical study of solitary and cnoidal wave interaction with a submerged horizontal plate zaghian et al 2017 performed an experimental study of the interaction between a solitary wave and a submerged thin plate at different angles the piv technique was used for flow visualization and the solitary wave height reduction due to passing the plate was measured in different cases christou et al 2021 studied the interaction of a solitary wave and a thin horizontal plate in different angles numerically the numerical simulations were carried out in hydro3d the effects of the plate angle and width were investigated recently the interaction of solitary waves and two rectangular obstacles was studied by researchers wu and hsiao 2017 numerically studied the interaction of a solitary wave and two thin plates at different distances and compared the wave rtd coefficients for different cases zhou et al 2014 carried out a numerical investigation of a solitary wave propagation over two rectangular obstacles with a length to height ratio of 5 at different distances they solved the two dimensional unsteady reynolds averaged navier stokes urans equations and used the vof method to describe the free surface kinematics and obtained wave rtd coefficients forces on obstacles and wave profiles for different cases studies on submerged breakwaters are not limited to rectangular obstacles shen and chan 2008 presented a combined immersed boundary and vof method to study the interaction of a solitary wave and trapezoidal and rectangular obstacle markus et al 2015 studied the passage of a solitary wave over a trapezoidal obstacle at different angles ji et al 2017 proposed a constrained interpolation profile cip model to investigate a regular wave and a solitary wave interaction with submerged obstacles they considered two types of obstacles rectangular and trapezoid and simulated wave transformations around breakwaters ji et al 2019 investigated the interaction of a solitary wave and a semi cylindrical obstacle they obtained the free surface profile and vortices generated in the flow in addition to single fluid systems two layered fluid systems were used to investigate the interaction between an internal solitary wave isw and submerged obstacles in these systems fluorescence particles were injected into fluids for better visualization ermanyuk and gavrilov 2005 investigated the interaction of an isw and a submerged circular cylinder experimentally chen 2007 studied the internal solitary wave passage over a semicircular and triangular obstacle experimentally and examined the mixing that occurred in the flow cheng and hsu 2013 conducted a series of laboratory experiments on the interaction between an isw and a trapezoidal obstacle with different front slopes hsieh et al 2015 performed numerical simulations to investigate the flow field due to an internal solitary wave propagating over a submerged triangular obstacle for comparing the different cases the wave potential and kinetic energy were obtained cheng et al 2020 developed a three dimensional numerical model based on the finite volume method to study the interaction of isw and vertical cylinder the effects of cylinder diameter and initial wave height were investigated on vortex shedding and forces applied on the cylinder in this study a solitary wave propagating over two submerged rectangular obstacles was investigated experimentally and numerically in the experimental procedure the free surface profile and solitary wave height were obtained in the white light technique the piv technique has been used to study the vortices and velocity field near the obstacles in the numerical procedure the effect of the obstacles distance and height was investigated using the finite volume cfd code ansys fluent 16 cases with four different heights and four different distances were considered for investigating the wave break performance under different formations for validating the numerical simulation two different models were used to simulate experimental conditions the flow was simulated by laminar and rng k ε turbulence models and the results were compared with experimental data after achieving the correct numerical model the solitary wave height reduction energy loss drag coefficient applied to obstacles and vortex generation were investigated in different cases in previous studies that used two rectangular obstacles the obstacles length to height ratio was considered as more than 5 while in this study this ratio was considered as between 0 615 and 0 8 in addition in this study the ratio of obstacle height to water depth was considered as more than 0 71 in most previous papers this ratio was around 0 5 2 research method 2 1 experimental setup the experiments were performed in an open water channel in the department of mechanics at the isfahan university of technology this channel is 7 m long 0 6 m deep and 0 3 m wide and its walls are made of transparent plexiglas in this channel a piston type wave maker produces a solitary wave that has a height h of 7 cm in water with a depth h of 14 cm in this study two obstacles with a height d of 12 cm and length l of 8 cm were located on the channel floor at a distance s of 8 cm from each other fig 1 shows the channel s dimensions and the location of the wave maker and the obstacles and table 1 contains the conditions used in the experiment as shown in fig 1 at the end of the channel there is a vertical wall that will fully reflect the incident wave therefore the measurements are made until the solitary wave reaches the end of the channel 2 2 piv technique the velocity field around the obstacles was measured by the piv technique as follows first spherical glass particles with diameters of 10 and 20 μm and a density of 1 05 g cm3 are injected into the water then according to fig 1 a continuous green light laser dpss with a wavelength of 532 nm a beam diameter of 5 mm and power of 2 w illuminated the areas between and after the obstacles with the help of a cylindrical lens that converts the laser beam into a plate which is about 3 mm thick and 10 cm wide as a result the particles glow and their motion is visible a high speed cmos camera made by pco with a resolution of 1280 1024 and a shutter speed of 500 fps is used to take photos of the flow field the photos were analyzed by matlab image processing code thus velocity vectors and other flow properties were obtained note that each experiment was continued until the solitary wave reached the end of the channel according to wu and hsiao 2018 the uncertainty in the piv technique could be estimated from the experimental setup as follows the high speed camera has a dynamic range of 8 bit thus based on raffel et al 2018 the measurement uncertainty is less than 0 1 pixel in this work the resolution of piv photos and the time interval were 0 0135 cm pixel and 2 ms respectively therefore the uncertainty of piv measurements is less than 0 676 cm s which is about 0 47 percent of the velocity of the solitary wave crest 2 3 white light technique the white light technique measures the free surface profile and solitary wave height in this test light is projected from one side of the channel and the high speed camera is placed on the other side of the channel to capture the water surface fig 2 shows a diagram of a laboratory setup for the white light test in these tests the high speed camera was used to take photos of the flow field with a shutter speed of 200 fps taking photos of the free surface of the wave was performed along the entire length of the channel therefore the test was performed several times and each time a section of the channel is photographed an example of the resulting photos is shown in fig 3 a note that before performing the test when the camera was placed in front of the test section a checkerboard shown in fig 3b is placed in the shooting area and a photo is taken of it by the high speed camera with the help of the checkerboard photo the pixel coordinates can be scaled to spatial coordinates in image processing by specifying the resolution of the photos with the help of image processing code in matlab software the photos are converted into the image shown in fig 3c as a result the free surface of the wave could be measured by image processing with high accuracy the uncertainty in the white light technique could be estimated from the experimental setup as follows since the same camera is used in both the white light and piv techniques the measurement uncertainty is less than 0 1 pixel in this technique the resolution of photos was 0 04 cm per pixel therefore the uncertainty of the white light measurements is less than 0 004 cm 2 4 solitary wave verification eq 1 specifies a solitary wave s free surface lin and huang 2010 1 η x t h sech 2 3 h 4 h 3 x c t where ƞ denotes the free surface of the solitary wave above the still water h denotes the depth of still water h is the solitary wave s height and c is the velocity of a solitary wave crest which is obtained from eq 2 2 c g h h for verification of the solitary wave generated by the wave maker the free surface profile and crest velocity were compared with theoretical equations the value of the solitary wave crest velocity according to the eq 2 is equal to 1 369 m s and its value obtained from the white light tests is equal to 1 440 m s which is 5 lower than the theoretical result therefore the experimental result in this issue agrees well with the theory fig 4 shows a good agreement between the free surface profile of the solitary wave generated in experiments compared to the theoretical free surface presented in eq 1 in the following figures t is dimensionless time and is obtained from eq 3 it should be noted that t 0 is considered the time when the wave maker starts to move 3 t t g h 3 numerical method numerical simulations were carried out in ansys fluent which is a cfd software based on the finite volume approach fig 5 shows the two dimensional computational domain used for the numerical solutions which is a channel with a length of 7 m and a height of 0 4 m according to the experimental conditions also a piston type wave maker was used to make a solitary wave similar to the experimental setup there is a wall at the end of the channel that completely reflected the wave according to fig 6 a non uniform grid was used to enhance the computational efficiency around the wave maker a triangular grid with an element size of 3 mm has been used and in the area behind the wave maker due to the less importance of this area the grid has coarser size from δx δy 0 005 m at bottom of the channel to δx 0 005 m and δy 0 01 m at the top of the channel the grid is finer near the obstacles with the size of δx δy 0 0001 m also at the free surface area grid has the size of δx δy 0 0005 m the grid in the upper part of the channel where the air flows in has a larger size equal to δx 0 01 m and δy 0 005 m after examining different grids with different sizes a final grid with 508 000 cells was selected for numerical simulations for generating the solitary wave in numerical simulations the wave maker motion is modeled using the dynamic mesh since the moving object is located in the middle of the computational domain smoothing and remeshing methods were used as a result the grid changes in proportion to the wave maker motion over time and the grid quality does not decrease it should be noted that for using the remeshing method a triangular grid must be used in that area the wave maker motion profile was obtained from white light tests and applied to the numerical simulations using a user defined function udf a multiphase vof model was used to capture the free surface and the pressure implicit with splitting of operators piso algorithm was used for the pressure velocity coupling the second order upwind discretization scheme was used for the momentum equations turbulence kinetic energy and dissipation rate for discretizing pressure the pressure staggering option presto scheme was used the time step was 0 001 s which is small enough to keep the courant number below 1 the first order implicit discretization scheme was used for time a no slip condition was used for obstacle and channel walls and a pressure outlet boundary condition was used for the upper surface of the channel in previous studies potential flow grilli et al 1994 wu et al 2014 laminar flow huang and dong 2001 ji et al 2017 2019 2017 shen and chan 2008 wang et al 2018 and turbulent flow cheng et al 2020 christou et al 2021 hsieh et al 2015 wu et al 2012 wu and hsiao 2017 zhou et al 2014 were used for numerical solution in this study laminar and rng k ε turbulence models were used to simulate the fluid flow the results were compared with the experiments to obtain the correct model in the numerical procedure the experimented case was simulated and after validation of the numerical method the obstacle s distance and height were changed according to table 2 the location of the first obstacle was considered fixed 4 governing equations the governing equations for laminar flow were continuity eq 4 momentum equations eq 5 and vof equation eq 6 4 ρ t x i ρ u i 0 5 t ρ u i x j ρ u i u j p x i ρ g i x j μ u i x j 6 t α q ρ q x j α q ρ q u i 0 where p is the pressure gi 0 g is the acceleration of gravity ρ is the fluid density ui and uj are the velocity components u v xi and xj indicate the coordinate directions x y q is the index of the number of phases and α is the volume fraction of each phase the governing equations for turbulent flow are given below 7 ρ t x i ρ u i 0 8 t ρ u i x j ρ u i u j p x i ρ g i x j μ u i x j ρ u i u j 9 t ρ k u j x j ρ k x j α k μ e f f k x j g k g b ρ ε 10 t ρ ε u j x j ρ ε x j α ε μ e f f ε x j c 1 ε ε k g k c 1 ε g b c 2 ε ρ ε 2 k r ε here k is the turbulence kinetic energy ε is the turbulence dissipation rate gk represents the generation of turbulent kinetic energy gb is the generation of turbulent kinetic energy due to buoyancy αk αε c1ε 1 42 and c2ε 1 68 are empirical constants μeff is the effective viscosity u i and u j denote the mean velocity components u v p is mean pressure and ρ u i u j is reynolds stress in which u i and u j denote the velocity fluctuations components u v which represents the effects of the turbulent flow on the mean flow field 5 results and discussion 5 1 comparisons between experimental and numerical results to validate and demonstrate the capacity of the present numerical model the interaction of a solitary wave with two obstacles with experiment conditions was simulated in ansys fluent with laminar and rng k ε turbulence models the results of the free surface profile solitary wave height reduction velocity field and velocity profiles were compared with the experiment results fig 7 shows the solitary wave profile in the numerical simulation with laminar and turbulent models next to the solitary wave generated in the experiment the measurement has been made at the first section x h 20 shown in fig 5 it was observed that the solitary wave s free surface profile in laminar flow was better matched with the solitary wave profile in the experiment table 3 compares the height reduction of the solitary wave in the experimental and numerical models the solitary wave height at two sections x h 20 and x h 40 shown in fig 5 was obtained in the white light experiments and numerical simulations by calculating the difference the solitary wave height reduction was obtained it was observed that the laminar model again had a closer result to the experiment as a comparison of the overall shape of the solitary wave before and after interacting the obstacles the time histories of surface elevations at these sections are shown in fig 8 for further investigation the solitary wave free surface profile velocity fields and velocity profiles between and after two obstacles at different time instants in the experiments and numerical simulations are compared in figs 9 13 fig 9 shows the free surface profile of a solitary wave passing over the obstacles and the velocity field between them at different time instants by examining the free surface profiles it can be seen that as the solitary wave approaches the first obstacle the still water that exists between the two obstacles flows in such a way that water enters the gap from the top of the first obstacle and leaves the gap from the side of the second obstacle as a result the water height on the first obstacle gradually decreases the initial crest disappears and a new crest is created on top of the second obstacle this phenomenon is called crest crest exchange which was observed in the research of cooker et al 1990 both laminar and rng k ε turbulence models have the ability to predict this phenomenon the laminar model predicted the solitary wave s free surface profile very accurately and similar to experimental results while the rng k ε turbulence model cannot precisely predict the form of the free surface profile due to its damping and predicts the wave height to be less than the experimental results from velocity field photos it was observed that a clockwise vortex was created between the two obstacles when the wave reached the first obstacle the vortex was trapped in the area between the two obstacles and due to the high height of the obstacles it could not move towards the water surface the vortex was generated behind the first obstacle and moved along with the direction of the solitary wave towards the second obstacle and then returned to the first obstacle fig 10 shows the horizontal and vertical non dimensional velocity profiles at three sections at intervals of 2 cm in the area between the obstacles at different time instants in the experiment and numerical simulations it was observed that the velocity profiles in the simulation with the laminar flow model fit well with the experimental results the simulation with the rng k ε turbulence model obtained velocities that were less than the experimental results in some sections when increasing the velocity gradient the difference between the simulation with the rng k ε turbulence model results and the experimental results increased fig 11 shows the free surface profile of the solitary wave after passing the obstacles and the flow field after the second obstacle it can be seen that after the solitary wave passes over the second obstacle the water surface at the transmitted wave crest becomes steep and breaks this is the second phenomenon that occurs in the solitary wave and is called wave breaking the wave breaking causes the intact form of the solitary wave crest to disappear and the crest to become unstable it should be noted that due to energy dissipation the crest s form becomes smoother until it reaches a smooth shape at the end of the channel the laminar model captures the wave breaking and the wave crest s unstable form accurately but the rng k ε turbulence model does not capture the wave breaking and predicts the solitary wave surface to be smooth by examining the velocity fields it was observed that as the solitary wave passes over the second obstacle a clockwise vortex is generated behind the second obstacle this vortex develops and moves away from the obstacle but remains near the second obstacle the falling jet of the breaking wave hits the water surface behind the second obstacle and prevents the vortex from moving far away from the obstacle the generation and evolution of this vortex depend on the severity of wave breaking and the falling jet of the breaking wave behind the second obstacle the vortices generated in the experiment and numerical simulation with the laminar model were similar however the lack of accurate modeling of wave breaking in simulation with the rng k ε turbulence model causes the generated vortex to appear higher than its position in the experimental results fig 12 shows the horizontal and vertical velocity profiles at four sections at intervals of 2 cm in the area after the second obstacle at different time instants in the experiment and numerical simulations it can be seen that the difference in velocity profile results between the experimental results and simulation with the rng k ε turbulence model was greater than the difference between the experimental results and simulation with the laminar model in this area due to strong velocity gradients in the effect of wave breaking the flow prediction is more difficult than in the area between the two obstacles another phenomenon that occurs in the passage of a solitary wave through the obstacles is air water mixing as the falling jet of the breaking wave hits the water surface behind the second obstacle brings some air into the water this phenomenon of air penetrating into the water is called air water mixing which was observed in the research of hsiao and lin 2010 fig 13 shows the air water mixing that occurs in experimental and numerical results it can be seen that the laminar flow model well predicted this phenomenon but the rng k ε turbulence model was not able to model this phenomenon as mentioned earlier fig 13 also clearly shows the ability of the laminar model to capture the instability of the solitary wave free surface while the rng k ε turbulence model predicts a smooth wave surface it should be noted that the piv technique cannot record this phenomenon because the aerated region disrupts laser light capturing the free surface profile of the solitary wave propagating over the submerged obstacles is hard due to nonlinear and complex phenomena that occur in the flow like crest crest exchange air water mixing and wave breaking the simulation with the laminar model can predict all these phenomena similarly to the experimental results and as a result other parameters like velocity fields and profiles obtained from this model are more in line with the experimental results in general it can be concluded that in this study the laminar flow model provides closer results to experimental results and good performance in the prediction of interaction of a solitary wave and the submerged obstacles therefore the laminar flow model was used to simulate other numerical cases for investigating the effect of changing obstacles height and distance in the following sections the results of simulating different cases are given 5 2 breakwater performance the solitary wave height and energy are two important factors in the study of waves approaching the shore therefore the loss of height and energy of a solitary wave due to crossing obstacles indicates the breakwater s performance a solitary wave s total energy is the sum of its potential and kinetic energy calculated from eqs 11 13 hsieh et al 2015 11 e k 0 h h x 1 x 2 1 2 ρ u 2 v 2 d x d y 12 e p 0 h h x 1 x 2 ρ g y d x d y 13 e t e k e p here et ek and ep are the total kinetic and potential energy ρ is the water density and u and v are the velocity in the horizontal and vertical directions x1 and x2 are the sections at the beginning and end of a solitary wave at one wavelength to compare different cases performance the solitary wave s total energy and height were obtained at two sections before and after the obstacles x h 20 and x h 40 and the reduction of energy and height were calculated fig 14 shows the solitary wave s total energy loss and height reduction it should be noted that the total energy loss and the solitary wave height reduction were expressed in dimensionless forms according to eqs 14 and 15 14 δ e t δ e t e i 15 δ h δ h h where δh is the solitary wave height reduction h is the water depth δet is the total energy loss and ei is the total energy of the solitary wave before reaching the obstacles from fig 14 it can be seen that the behaviors of the two graphs are similar to each other by increasing the obstacles height due to the increased channel obstruction the moving solitary wave hits the obstacle at a higher altitude and loses more energy therefore increasing the height of the obstacles increases the height reduction and total energy loss of the solitary wave it was also found that increasing the obstacles distance does not always increase the reduction of the height and total energy when the distance between obstacles was 1 5 times the length of the obstacle s l 1 5 the reductions of the height and total energy of the solitary wave reached maximum values and this distance can be selected as the optimal distance between obstacles the rate of wave height reduction and energy dissipation depends on parameters such as the intensity of the wave breaking and surface instabilities the force applied to the obstacles and the strength of the vortices the combined effect of these parameters causes the optimal case and to understand this result these factors must be investigated separately the intensity of wave breaking and surface instabilities are not measurable but the drag force applied to the obstacles and the strength of the vortices are discussed below 5 3 drag coefficient investigating coastal breakwaters strength is one of the important parameters in their design against wave impact in designing breakwaters attention should be paid to the force applied to them to appropriately select their shape dimensions and material since the frictional drag force applied to the obstacles against the pressure drag force is a very small part of the force about one thousandth the pressure drag force was obtained from numerical simulations and was expressed in a dimensionless form according to eq 16 16 c d f d 0 5 ρ g 1 q 2 h 2 where fd is the drag force ρ is the density of water h is the depth of water and q is the channel obstruction which is the ratio of the obstacle height to the depth of water according to eq 17 17 q d h fig 15 shows the drag coefficient applied on the first obstacle in different cases according to this figure as a solitary wave approaches the first obstacle the drag coefficient increases it reaches its maximum value when the solitary wave reaches the top of this obstacle after the wave crosses this obstacle the upstream flow velocity decreases and therefore the drag coefficient decreases meanwhile a clockwise vortex is created between the two obstacles and causes the flow in that area to move back towards the first obstacle as a result a force is applied to the obstacle in the opposite direction of solitary wave motion and the drag coefficient is reduced to negative values to better understand the trend of the drag coefficient plots of the horizontal non dimensional velocity as a function of time at two sections at a distance of 1 cm before and after the first obstacle x h 25 71 and x h 26 43 are shown in fig 16 according to fig 16a and b as a solitary wave approaches the obstacles the horizontal velocity at two sections increases and thus the drag force applied to the obstacle increases sharply then according to fig 16c and d the horizontal velocity gradually decreases at both sections even at some moments at the section of x h 26 43 it becomes negative and causes the force in the opposite direction of the wave motion this leads to the negative drag force applied to the obstacle next due to this vortex s movement towards the second obstacle the negative drag coefficient increases and becomes a positive drag coefficient finally by decreasing the fluid velocity on both sides of the obstacle the drag coefficient also approaches to zero changing the obstacle s distance has a greater effect on the negative part of the drag coefficient fig 17 shows the vortex between the obstacles at t 15 at difference s l it can be seen that as the distance between the two obstacles increases a larger vortex is created in this area as a result the force applied to the obstacle in the opposite direction of the wave motion is greater therefore the negative drag coefficient reaches higher values for further investigation the maximum drag coefficient applied to the first obstacle is shown in fig 18 it was observed that in all cases with increasing the obstacles height the maximum drag coefficient has also increased this was because of the flow obstruction increment increasing the obstacles distance also increases the maximum drag coefficient applied on the first obstacle increasing the distance between the two obstacles causes the phenomenon of crest transmission to be delayed as a result a larger force is applied to the obstacle fig 19 shows the drag coefficient applied to the second obstacle over time in different cases it can be seen that the drag coefficient applied on the second obstacle behaves similarly to that on the first obstacle when the wave approaches the obstacle the drag coefficient increases and when the wave passes over it due to the momentum reduction the drag coefficient decreases to zero as mentioned in the previous sections the solitary wave breaks after passing the second obstacle it creates a water jet which falls from wave crest and hit the water surface sharply behind the second obstacle and creates a clockwise vortex in this area this vortex also causes water to move towards the second obstacle due to its rotation this action reduces the drag coefficient rapidly and in some cases it also causes a negative drag coefficient increasing the distance between the two obstacles causes the falling jet to hit the water surface at a shorter distance from the second obstacle therefore the vortex is directed more strongly toward the obstacle as a result the force applied to the obstacle is stronger in the opposite direction of the solitary wave motion causing the drag coefficient to reach a negative value however when the obstacle s distance is short s l 0 5 the wave breaking occurs farther from the obstacle and the vortex moves more freely therefore less water returns to the obstacle and the drag coefficient remains positive fig 20 shows the maximum drag coefficient applied to the second obstacle in different cases it was observed that the drag coefficient increase as the height of the two obstacles increases however one of the differences between the behavior of the drag coefficient applied on the second obstacle and the first one is that in this case changing the obstacles distance has a significant effect on the force and drag coefficient applied to the second obstacle when the solitary wave reaches the first obstacle the still water that exists between the two obstacles flows water enters the gap from the top of the first obstacle and leaves the gap from the side of the second obstacle this process applies force on the second obstacle the greater the obstacles distance the more severe this phenomenon is and the higher the drag coefficient applied to the second obstacle is also because the water reaches the second obstacle with more intensity than the first one the drag coefficient applied to the second obstacle will be higher than for the first one and as a result more considerations are needed to build the second obstacle 5 4 vortex strength during the solitary wave s passage over the obstacles two clockwise vortices are created between the two obstacles and after the second obstacle which causes a loss of solitary wave energy by examining these vortices vorticity we can better understand the results obtained in terms of the solitary wave s height reduction and energy loss according to eq 18 vorticity is defined as the curl of the velocity field and according to this definition the clockwise vortex has negative vorticity 18 ω v x u y figs 21 and 22 show the vorticity of clockwise vortices between the obstacles and after the second obstacle over time respectively as expected it was observed that the clockwise vortex between obstacles occurs earlier than the clockwise vortex after obstacles this vortex was generated at t 17 in all cases and quickly reached its maximum power at t 19 when the solitary wave crest reached above the vortex after that the vorticity of the vortex gradually decreased due to the small area between the obstacles the rate of vorticity reduction for cases with s l 0 5 and s l 1 was much more than in cases with s l 1 5 and s l 2 and the vortex strength in these cases subsides rapidly by examining the effect of the obstacles distance it was observed that at s l 1 5 the vorticity of the clockwise vortex between the obstacles was higher than in the other cases the solitary wave breaking and the falling jet of water cause an intense velocity gradient after the obstacles as a result the vortex generated after the obstacles has more strength than the first vortex this vortex for cases with s l 0 5 and s l 1 was generated at t 18 while in cases with s l 1 5 and s l 2 it was generated at t 19 because with increasing distance between the obstacles the solitary wave reaches the second obstacle later like the first vortex when a solitary wave crest reaches above this vortex t 20 its vorticity reaches its maximum value and after that it gradually decreases however unlike the vortex between obstacles the vorticity reduction rate is almost the same in different cases the strength of this vortex depends on the intensity of the falling jet of the breaking wave the shorter the distance between the obstacles the less water can flow in this area and as a result the intensity of the falling jet after the second obstacle increases therefore the strength of the vortex decreases with increasing s l increasing the height of the obstacles increases the area between the obstacles and after the second obstacle which causes more water to flow and fall into these areas as a result the rotation speed of the vortices and velocity gradients increases therefore as the height of the obstacles increases both vortices maximum vorticity increases 6 conclusion in this study the interaction of a solitary wave with two rectangular obstacles at different heights and distances was investigated experimentally and numerically in the experimental procedure we use white light and piv techniques to investigate the water s free surface and the flow field near the obstacles due to solitary wave interaction with the rectangular obstacles with d h 0 86 and s l 1 in the numerical procedure which was validated by the experimental results the effects of changing the distance and height of obstacles were investigated the main conclusions of the simulations are the following 1 by examining the experiments and numerical simulations it was observed that due to the passage of a solitary wave over obstacles three phenomena of wave breaking crest crest exchange and air water mixing occur the crest crest exchange begins on the first obstacle and the other two phenomena occur after the second obstacle 2 the numerical simulations were solved with a laminar and turbulent flow model it was observed that the results obtained by the laminar model in different parts were in good agreement with the experimental results including the solitary wave s free surface profile wave breaking velocity field around obstacles solitary wave height and crest velocity therefore a correct model for simulation was achieved 3 as the obstacles height increases the solitary wave s height reduction and energy loss increase in all cases but increasing the obstacles distance does not lead to such a result the obstacles distance has an optimal value of s l 1 5 at which the amount of reductions in height and total energy of a solitary wave reaches maximum values and a further increase of this distance weakens the breakwater performance 4 the drag coefficient on the two obstacles reaches its maximum value when the solitary wave reaches the tops of the obstacles the drag coefficient applied to the second obstacle was larger than the drag coefficient applied to the first obstacle due to the more severe water impact 5 the presence of the second obstacle causes a negative drag coefficient on the first obstacle also the wave breaking has the same effect on the drag coefficient on the second obstacle 6 the presence of the second affects the size and movement of the vortex between the obstacles in the cases with s l 1 5 the strength of this vortex was the maximum also by increasing the obstacles distance the strength of the vortex after the second obstacle increases 7 increasing the height of the obstacles increases their drag coefficient and the strength of the vortices 8 increasing the distance between obstacles reduces the strength of the vortex after the second obstacle and increases the drag coefficient on the two obstacles declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national research foundation of korea nrf grant which is funded by the korean government msit no 2020r1a5a8018822 no 2021r1a2c2012469 appendix grid independence study is conducted to discover the optimum grid size for the numerical simulations in both laminar and turbulence models for numerical simulations with laminar and turbulence models three and four different grids have been used respectively the results obtained from them have been compared with each other to determine the optimum grid it should be note that the simulations were performed at s l 1 and d h 0 86 which was the main case in the study also by adjusting the bias ratio the y value was held constant in different grids table a 1 shows the number of cells for each grid used for simulations table a 1 number of cells in different grids table a 1 number of cells turbulence flow laminar flow grid 1 186000 186000 grid 2 350000 350000 grid 3 508000 508000 grid 4 821000 figs a1 and a2 show the time histories of the surface elevations at x h 20 and x h 35 obtained in different grids in laminar and turbulent flow respectively fig a 1 time histories of surface elevations obtained from turbulent flow at different grids fig a 1 for more investigation figs a4 and a5 illustrate the horizontal and vertical non dimensional velocity profiles at the two sections shown in fig a3 in laminar and turbulent flow respectively fig a 2 time histories of surface elevations obtained from laminar flow at different grids fig a 2 fig a 3 diagram of two sections used for calculating velocity profiles fig a 3 fig a 4 horizontal and vertical velocity profiles at two sections at t 14 5 obtained from turbulent flow at different grids fig a 4 fig a 5 horizontal and vertical velocity profiles at two sections at t 14 5 obtained from laminar flow at different grids fig a 5 according to figs a1 and a4 there is no significant change in the results in the third and fourth grid in the simulations with the rng k ε turbulence model therefore for the numerical simulation with turbulent flow the grid size of 508000 cells has been used to perform the simulations also in the simulations with the laminar model there is no noticeable difference in the results between the second and third grid thus the second grid with 350 000 cells has been used 
20334,the performance of coastal breakwaters in reducing wave height and energy is an important problem this paper presents an experimental and numerical investigation of solitary wave interaction with two submerged rectangular obstacles white light and particle image velocimetry piv techniques were utilized to study the free surface profile of a solitary wave and flow field in an experimental procedure the piv test results revealed that two clockwise vortices are generated between and after the two obstacles and the white light test results showed that three phenomena of wave breaking crest crest exchange and air water mixing occur in the solitary wave passage over the two obstacles a transient two dimensional numerical model was used to study solitary wave interaction with two rectangular obstacles the numerical model was validated with experimental results in terms of free surface profile velocity fields and velocity profiles using this model the effects of obstacles height and distance were investigated the numerical results showed that when increasing the height of the obstacles the drag force applied on the obstacles the strength of vortices the energy loss and the height reduction of the solitary wave increased the presence of the second obstacle and wave breaking occurrence constrain the movement of vortices and cause a negative drag coefficient on the obstacles in some cases the energy loss the height reduction of the solitary wave and the strength of the vortex generated between the obstacles increased as the distance of the obstacles increased up to s l 1 5 in contrast the strength of the vortex generated after the second obstacle was decreased by increasing the distance of two obstacles keywords solitary wave wave breaking drag coefficient vortex strength piv cfd 1 introduction nowadays the use of submerged obstacles as breakwaters is a well known solution to reduce the destructive effects of sea waves colliding with coastal areas structures and to prevent coastal erosion in coastal areas sea waves are in the form of solitary waves so many researchers study the interaction of a solitary wave with different breakwaters and the flow pattern before and after them finding the appropriate shape and size for breakwaters requires investigation of the flow pattern around them the force applied to them and their ability to reduce the wave s energy and height research about waves is divided into wave classification and production wave breaking and their interaction with obstacles due to their importance in coastal areas wave breaking and their interaction with obstacles are widely used and studied by analytical solutions numerical simulations experimental investigations or a combination of these three the analytical studies of solitary wave transformation over a shelf were some of the first studies on this subject conducted by several research groups tappert and zabusky 1971 johnson 1972 miles 1979 goring and raichlen 1992 in experimental and numerical studies of waves a wave maker generated the desired waves anbarsooz et al 2013 numerically simulated linear and nonlinear waves in intermediate and deep water using piston and flap type wave makers wu et al 2014 presented a numerical meshless model for generating a solitary wave as a potential flow after wave production researchers investigated waves breaking in shallow and deep waters by experimental and numerical studies because of their application in the study of tsunamis near coasts grilli et al 1994 investigated the shoaling of a solitary wave using a potential model and laboratory experiments silva et al 2000 investigated a solitary wave s interaction with a permeable slope breakwater as a coastal area using a linear solution synolakis and bernard 2006 reviewed the development of tsunami modeling tools throughout history hsiao and lin 2010 investigated tsunami like solitary waves on a sloping beach experimentally and numerically in the numerical procedure a two dimensional volume of fluid vof model was used yao et al 2018 investigated a tsunami like solitary wave interaction with fringing reefs the effects of solitary wave height and shape of reefs were studied by experimental and numerical procedures due to the importance of oil structures in the seas experimental and numerical studies of the passage of a solitary wave over submerged cylinders have been some of the first studies of solitary wave interaction with submerged obstacles cooker et al 1990 presented a two dimensional irrotational numerical solution for the interaction of a solitary wave with a submerged semicircular cylinder also they conducted a series of experiments in a channel with a piston type wave maker to validate the numerical results chian and ertekin 1992 investigated the interaction of a solitary wave and submerged horizontal cylinder using a boundary element method and examined the force applied on the cylinder xiao et al 2013 studied the interaction of a solitary wave with a horizontal cylinder numerically and investigated the forces applied on the cylinder the model was based on the k ε turbulence model and the volume of fluid method zarruk et al 2015 investigated the generation and evolution of vortices due to a solitary wave propagating over cylindrical structures experimentally and numerically in the experimental procedure dye injection was used for flow visualization and a three dimensional vof les model was used in the numerical model predicting wave reflection transmission and dissipation rtd coefficients is one of the objectives of studies conducted on solitary wave interaction with obstacles silva et al 2000 seabra santos et al 1987 chang et al 2005 lin 2004 investigated the interaction of a solitary wave with a submerged rectangular obstacle with different lengths and heights numerically and calculated wave rtd coefficients in all cases wang et al 2018 investigated a solitary wave s rtd coefficients due to interaction with a submerged vertical thin plate by developing a two dimensional multi phase viscous model flow visualization around obstacles due to solitary wave passage is also an important issue and is studied in various experimental and numerical studies ting and kim 1994 conducted laboratory experiments to investigate the interaction between time periodic water waves and a submerged rectangular obstacle tang and chang 1998 investigated the flow separation and vortex formation during the passage of a solitary wave over a submerged rectangular obstacle using experimental and numerical methods the flow visualization was performed by adding red dye to the water and in the numerical method a stream function vorticity model was used huang and dong 2001 numerically investigated the interaction between a solitary wave and a rectangular obstacle the numerical model solved the unsteady two dimensional navier stokes equations and a piston type wave maker produced a solitary wave in the computational domain lin et al 2005 conducted an experimental study of the interaction of a solitary wave and a submerged vertical plate using the particle image velocimetry piv technique for visualizing the flow field and vortex shedding one year later lin et al 2006 studied the generated vortices and free surface profile due to the passage of a solitary wave over a submerged rectangular obstacle experimentally using the piv technique and the laser induced fluorescence lif technique lin and huang 2010 studied the vortex generation and evolution due to solitary wave passage over a submerged rectangular obstacle using a two dimensional lagrangian type numerical method chang et al 2012 presented a two dimensional stream function vorticity model and studied the vortex generation and the flow field due to solitary wave passage over a cavity the experimental and numerical interaction of a solitary wave and a submerged vertical obstacle was studied by wu et al 2012 the piv technique was used for flow visualization and a two dimensional vof typed model based on reynolds averaged navier stokes equations was used for numerical simulations hayatdavoodi et al 2017 presented a numerical study of solitary and cnoidal wave interaction with a submerged horizontal plate zaghian et al 2017 performed an experimental study of the interaction between a solitary wave and a submerged thin plate at different angles the piv technique was used for flow visualization and the solitary wave height reduction due to passing the plate was measured in different cases christou et al 2021 studied the interaction of a solitary wave and a thin horizontal plate in different angles numerically the numerical simulations were carried out in hydro3d the effects of the plate angle and width were investigated recently the interaction of solitary waves and two rectangular obstacles was studied by researchers wu and hsiao 2017 numerically studied the interaction of a solitary wave and two thin plates at different distances and compared the wave rtd coefficients for different cases zhou et al 2014 carried out a numerical investigation of a solitary wave propagation over two rectangular obstacles with a length to height ratio of 5 at different distances they solved the two dimensional unsteady reynolds averaged navier stokes urans equations and used the vof method to describe the free surface kinematics and obtained wave rtd coefficients forces on obstacles and wave profiles for different cases studies on submerged breakwaters are not limited to rectangular obstacles shen and chan 2008 presented a combined immersed boundary and vof method to study the interaction of a solitary wave and trapezoidal and rectangular obstacle markus et al 2015 studied the passage of a solitary wave over a trapezoidal obstacle at different angles ji et al 2017 proposed a constrained interpolation profile cip model to investigate a regular wave and a solitary wave interaction with submerged obstacles they considered two types of obstacles rectangular and trapezoid and simulated wave transformations around breakwaters ji et al 2019 investigated the interaction of a solitary wave and a semi cylindrical obstacle they obtained the free surface profile and vortices generated in the flow in addition to single fluid systems two layered fluid systems were used to investigate the interaction between an internal solitary wave isw and submerged obstacles in these systems fluorescence particles were injected into fluids for better visualization ermanyuk and gavrilov 2005 investigated the interaction of an isw and a submerged circular cylinder experimentally chen 2007 studied the internal solitary wave passage over a semicircular and triangular obstacle experimentally and examined the mixing that occurred in the flow cheng and hsu 2013 conducted a series of laboratory experiments on the interaction between an isw and a trapezoidal obstacle with different front slopes hsieh et al 2015 performed numerical simulations to investigate the flow field due to an internal solitary wave propagating over a submerged triangular obstacle for comparing the different cases the wave potential and kinetic energy were obtained cheng et al 2020 developed a three dimensional numerical model based on the finite volume method to study the interaction of isw and vertical cylinder the effects of cylinder diameter and initial wave height were investigated on vortex shedding and forces applied on the cylinder in this study a solitary wave propagating over two submerged rectangular obstacles was investigated experimentally and numerically in the experimental procedure the free surface profile and solitary wave height were obtained in the white light technique the piv technique has been used to study the vortices and velocity field near the obstacles in the numerical procedure the effect of the obstacles distance and height was investigated using the finite volume cfd code ansys fluent 16 cases with four different heights and four different distances were considered for investigating the wave break performance under different formations for validating the numerical simulation two different models were used to simulate experimental conditions the flow was simulated by laminar and rng k ε turbulence models and the results were compared with experimental data after achieving the correct numerical model the solitary wave height reduction energy loss drag coefficient applied to obstacles and vortex generation were investigated in different cases in previous studies that used two rectangular obstacles the obstacles length to height ratio was considered as more than 5 while in this study this ratio was considered as between 0 615 and 0 8 in addition in this study the ratio of obstacle height to water depth was considered as more than 0 71 in most previous papers this ratio was around 0 5 2 research method 2 1 experimental setup the experiments were performed in an open water channel in the department of mechanics at the isfahan university of technology this channel is 7 m long 0 6 m deep and 0 3 m wide and its walls are made of transparent plexiglas in this channel a piston type wave maker produces a solitary wave that has a height h of 7 cm in water with a depth h of 14 cm in this study two obstacles with a height d of 12 cm and length l of 8 cm were located on the channel floor at a distance s of 8 cm from each other fig 1 shows the channel s dimensions and the location of the wave maker and the obstacles and table 1 contains the conditions used in the experiment as shown in fig 1 at the end of the channel there is a vertical wall that will fully reflect the incident wave therefore the measurements are made until the solitary wave reaches the end of the channel 2 2 piv technique the velocity field around the obstacles was measured by the piv technique as follows first spherical glass particles with diameters of 10 and 20 μm and a density of 1 05 g cm3 are injected into the water then according to fig 1 a continuous green light laser dpss with a wavelength of 532 nm a beam diameter of 5 mm and power of 2 w illuminated the areas between and after the obstacles with the help of a cylindrical lens that converts the laser beam into a plate which is about 3 mm thick and 10 cm wide as a result the particles glow and their motion is visible a high speed cmos camera made by pco with a resolution of 1280 1024 and a shutter speed of 500 fps is used to take photos of the flow field the photos were analyzed by matlab image processing code thus velocity vectors and other flow properties were obtained note that each experiment was continued until the solitary wave reached the end of the channel according to wu and hsiao 2018 the uncertainty in the piv technique could be estimated from the experimental setup as follows the high speed camera has a dynamic range of 8 bit thus based on raffel et al 2018 the measurement uncertainty is less than 0 1 pixel in this work the resolution of piv photos and the time interval were 0 0135 cm pixel and 2 ms respectively therefore the uncertainty of piv measurements is less than 0 676 cm s which is about 0 47 percent of the velocity of the solitary wave crest 2 3 white light technique the white light technique measures the free surface profile and solitary wave height in this test light is projected from one side of the channel and the high speed camera is placed on the other side of the channel to capture the water surface fig 2 shows a diagram of a laboratory setup for the white light test in these tests the high speed camera was used to take photos of the flow field with a shutter speed of 200 fps taking photos of the free surface of the wave was performed along the entire length of the channel therefore the test was performed several times and each time a section of the channel is photographed an example of the resulting photos is shown in fig 3 a note that before performing the test when the camera was placed in front of the test section a checkerboard shown in fig 3b is placed in the shooting area and a photo is taken of it by the high speed camera with the help of the checkerboard photo the pixel coordinates can be scaled to spatial coordinates in image processing by specifying the resolution of the photos with the help of image processing code in matlab software the photos are converted into the image shown in fig 3c as a result the free surface of the wave could be measured by image processing with high accuracy the uncertainty in the white light technique could be estimated from the experimental setup as follows since the same camera is used in both the white light and piv techniques the measurement uncertainty is less than 0 1 pixel in this technique the resolution of photos was 0 04 cm per pixel therefore the uncertainty of the white light measurements is less than 0 004 cm 2 4 solitary wave verification eq 1 specifies a solitary wave s free surface lin and huang 2010 1 η x t h sech 2 3 h 4 h 3 x c t where ƞ denotes the free surface of the solitary wave above the still water h denotes the depth of still water h is the solitary wave s height and c is the velocity of a solitary wave crest which is obtained from eq 2 2 c g h h for verification of the solitary wave generated by the wave maker the free surface profile and crest velocity were compared with theoretical equations the value of the solitary wave crest velocity according to the eq 2 is equal to 1 369 m s and its value obtained from the white light tests is equal to 1 440 m s which is 5 lower than the theoretical result therefore the experimental result in this issue agrees well with the theory fig 4 shows a good agreement between the free surface profile of the solitary wave generated in experiments compared to the theoretical free surface presented in eq 1 in the following figures t is dimensionless time and is obtained from eq 3 it should be noted that t 0 is considered the time when the wave maker starts to move 3 t t g h 3 numerical method numerical simulations were carried out in ansys fluent which is a cfd software based on the finite volume approach fig 5 shows the two dimensional computational domain used for the numerical solutions which is a channel with a length of 7 m and a height of 0 4 m according to the experimental conditions also a piston type wave maker was used to make a solitary wave similar to the experimental setup there is a wall at the end of the channel that completely reflected the wave according to fig 6 a non uniform grid was used to enhance the computational efficiency around the wave maker a triangular grid with an element size of 3 mm has been used and in the area behind the wave maker due to the less importance of this area the grid has coarser size from δx δy 0 005 m at bottom of the channel to δx 0 005 m and δy 0 01 m at the top of the channel the grid is finer near the obstacles with the size of δx δy 0 0001 m also at the free surface area grid has the size of δx δy 0 0005 m the grid in the upper part of the channel where the air flows in has a larger size equal to δx 0 01 m and δy 0 005 m after examining different grids with different sizes a final grid with 508 000 cells was selected for numerical simulations for generating the solitary wave in numerical simulations the wave maker motion is modeled using the dynamic mesh since the moving object is located in the middle of the computational domain smoothing and remeshing methods were used as a result the grid changes in proportion to the wave maker motion over time and the grid quality does not decrease it should be noted that for using the remeshing method a triangular grid must be used in that area the wave maker motion profile was obtained from white light tests and applied to the numerical simulations using a user defined function udf a multiphase vof model was used to capture the free surface and the pressure implicit with splitting of operators piso algorithm was used for the pressure velocity coupling the second order upwind discretization scheme was used for the momentum equations turbulence kinetic energy and dissipation rate for discretizing pressure the pressure staggering option presto scheme was used the time step was 0 001 s which is small enough to keep the courant number below 1 the first order implicit discretization scheme was used for time a no slip condition was used for obstacle and channel walls and a pressure outlet boundary condition was used for the upper surface of the channel in previous studies potential flow grilli et al 1994 wu et al 2014 laminar flow huang and dong 2001 ji et al 2017 2019 2017 shen and chan 2008 wang et al 2018 and turbulent flow cheng et al 2020 christou et al 2021 hsieh et al 2015 wu et al 2012 wu and hsiao 2017 zhou et al 2014 were used for numerical solution in this study laminar and rng k ε turbulence models were used to simulate the fluid flow the results were compared with the experiments to obtain the correct model in the numerical procedure the experimented case was simulated and after validation of the numerical method the obstacle s distance and height were changed according to table 2 the location of the first obstacle was considered fixed 4 governing equations the governing equations for laminar flow were continuity eq 4 momentum equations eq 5 and vof equation eq 6 4 ρ t x i ρ u i 0 5 t ρ u i x j ρ u i u j p x i ρ g i x j μ u i x j 6 t α q ρ q x j α q ρ q u i 0 where p is the pressure gi 0 g is the acceleration of gravity ρ is the fluid density ui and uj are the velocity components u v xi and xj indicate the coordinate directions x y q is the index of the number of phases and α is the volume fraction of each phase the governing equations for turbulent flow are given below 7 ρ t x i ρ u i 0 8 t ρ u i x j ρ u i u j p x i ρ g i x j μ u i x j ρ u i u j 9 t ρ k u j x j ρ k x j α k μ e f f k x j g k g b ρ ε 10 t ρ ε u j x j ρ ε x j α ε μ e f f ε x j c 1 ε ε k g k c 1 ε g b c 2 ε ρ ε 2 k r ε here k is the turbulence kinetic energy ε is the turbulence dissipation rate gk represents the generation of turbulent kinetic energy gb is the generation of turbulent kinetic energy due to buoyancy αk αε c1ε 1 42 and c2ε 1 68 are empirical constants μeff is the effective viscosity u i and u j denote the mean velocity components u v p is mean pressure and ρ u i u j is reynolds stress in which u i and u j denote the velocity fluctuations components u v which represents the effects of the turbulent flow on the mean flow field 5 results and discussion 5 1 comparisons between experimental and numerical results to validate and demonstrate the capacity of the present numerical model the interaction of a solitary wave with two obstacles with experiment conditions was simulated in ansys fluent with laminar and rng k ε turbulence models the results of the free surface profile solitary wave height reduction velocity field and velocity profiles were compared with the experiment results fig 7 shows the solitary wave profile in the numerical simulation with laminar and turbulent models next to the solitary wave generated in the experiment the measurement has been made at the first section x h 20 shown in fig 5 it was observed that the solitary wave s free surface profile in laminar flow was better matched with the solitary wave profile in the experiment table 3 compares the height reduction of the solitary wave in the experimental and numerical models the solitary wave height at two sections x h 20 and x h 40 shown in fig 5 was obtained in the white light experiments and numerical simulations by calculating the difference the solitary wave height reduction was obtained it was observed that the laminar model again had a closer result to the experiment as a comparison of the overall shape of the solitary wave before and after interacting the obstacles the time histories of surface elevations at these sections are shown in fig 8 for further investigation the solitary wave free surface profile velocity fields and velocity profiles between and after two obstacles at different time instants in the experiments and numerical simulations are compared in figs 9 13 fig 9 shows the free surface profile of a solitary wave passing over the obstacles and the velocity field between them at different time instants by examining the free surface profiles it can be seen that as the solitary wave approaches the first obstacle the still water that exists between the two obstacles flows in such a way that water enters the gap from the top of the first obstacle and leaves the gap from the side of the second obstacle as a result the water height on the first obstacle gradually decreases the initial crest disappears and a new crest is created on top of the second obstacle this phenomenon is called crest crest exchange which was observed in the research of cooker et al 1990 both laminar and rng k ε turbulence models have the ability to predict this phenomenon the laminar model predicted the solitary wave s free surface profile very accurately and similar to experimental results while the rng k ε turbulence model cannot precisely predict the form of the free surface profile due to its damping and predicts the wave height to be less than the experimental results from velocity field photos it was observed that a clockwise vortex was created between the two obstacles when the wave reached the first obstacle the vortex was trapped in the area between the two obstacles and due to the high height of the obstacles it could not move towards the water surface the vortex was generated behind the first obstacle and moved along with the direction of the solitary wave towards the second obstacle and then returned to the first obstacle fig 10 shows the horizontal and vertical non dimensional velocity profiles at three sections at intervals of 2 cm in the area between the obstacles at different time instants in the experiment and numerical simulations it was observed that the velocity profiles in the simulation with the laminar flow model fit well with the experimental results the simulation with the rng k ε turbulence model obtained velocities that were less than the experimental results in some sections when increasing the velocity gradient the difference between the simulation with the rng k ε turbulence model results and the experimental results increased fig 11 shows the free surface profile of the solitary wave after passing the obstacles and the flow field after the second obstacle it can be seen that after the solitary wave passes over the second obstacle the water surface at the transmitted wave crest becomes steep and breaks this is the second phenomenon that occurs in the solitary wave and is called wave breaking the wave breaking causes the intact form of the solitary wave crest to disappear and the crest to become unstable it should be noted that due to energy dissipation the crest s form becomes smoother until it reaches a smooth shape at the end of the channel the laminar model captures the wave breaking and the wave crest s unstable form accurately but the rng k ε turbulence model does not capture the wave breaking and predicts the solitary wave surface to be smooth by examining the velocity fields it was observed that as the solitary wave passes over the second obstacle a clockwise vortex is generated behind the second obstacle this vortex develops and moves away from the obstacle but remains near the second obstacle the falling jet of the breaking wave hits the water surface behind the second obstacle and prevents the vortex from moving far away from the obstacle the generation and evolution of this vortex depend on the severity of wave breaking and the falling jet of the breaking wave behind the second obstacle the vortices generated in the experiment and numerical simulation with the laminar model were similar however the lack of accurate modeling of wave breaking in simulation with the rng k ε turbulence model causes the generated vortex to appear higher than its position in the experimental results fig 12 shows the horizontal and vertical velocity profiles at four sections at intervals of 2 cm in the area after the second obstacle at different time instants in the experiment and numerical simulations it can be seen that the difference in velocity profile results between the experimental results and simulation with the rng k ε turbulence model was greater than the difference between the experimental results and simulation with the laminar model in this area due to strong velocity gradients in the effect of wave breaking the flow prediction is more difficult than in the area between the two obstacles another phenomenon that occurs in the passage of a solitary wave through the obstacles is air water mixing as the falling jet of the breaking wave hits the water surface behind the second obstacle brings some air into the water this phenomenon of air penetrating into the water is called air water mixing which was observed in the research of hsiao and lin 2010 fig 13 shows the air water mixing that occurs in experimental and numerical results it can be seen that the laminar flow model well predicted this phenomenon but the rng k ε turbulence model was not able to model this phenomenon as mentioned earlier fig 13 also clearly shows the ability of the laminar model to capture the instability of the solitary wave free surface while the rng k ε turbulence model predicts a smooth wave surface it should be noted that the piv technique cannot record this phenomenon because the aerated region disrupts laser light capturing the free surface profile of the solitary wave propagating over the submerged obstacles is hard due to nonlinear and complex phenomena that occur in the flow like crest crest exchange air water mixing and wave breaking the simulation with the laminar model can predict all these phenomena similarly to the experimental results and as a result other parameters like velocity fields and profiles obtained from this model are more in line with the experimental results in general it can be concluded that in this study the laminar flow model provides closer results to experimental results and good performance in the prediction of interaction of a solitary wave and the submerged obstacles therefore the laminar flow model was used to simulate other numerical cases for investigating the effect of changing obstacles height and distance in the following sections the results of simulating different cases are given 5 2 breakwater performance the solitary wave height and energy are two important factors in the study of waves approaching the shore therefore the loss of height and energy of a solitary wave due to crossing obstacles indicates the breakwater s performance a solitary wave s total energy is the sum of its potential and kinetic energy calculated from eqs 11 13 hsieh et al 2015 11 e k 0 h h x 1 x 2 1 2 ρ u 2 v 2 d x d y 12 e p 0 h h x 1 x 2 ρ g y d x d y 13 e t e k e p here et ek and ep are the total kinetic and potential energy ρ is the water density and u and v are the velocity in the horizontal and vertical directions x1 and x2 are the sections at the beginning and end of a solitary wave at one wavelength to compare different cases performance the solitary wave s total energy and height were obtained at two sections before and after the obstacles x h 20 and x h 40 and the reduction of energy and height were calculated fig 14 shows the solitary wave s total energy loss and height reduction it should be noted that the total energy loss and the solitary wave height reduction were expressed in dimensionless forms according to eqs 14 and 15 14 δ e t δ e t e i 15 δ h δ h h where δh is the solitary wave height reduction h is the water depth δet is the total energy loss and ei is the total energy of the solitary wave before reaching the obstacles from fig 14 it can be seen that the behaviors of the two graphs are similar to each other by increasing the obstacles height due to the increased channel obstruction the moving solitary wave hits the obstacle at a higher altitude and loses more energy therefore increasing the height of the obstacles increases the height reduction and total energy loss of the solitary wave it was also found that increasing the obstacles distance does not always increase the reduction of the height and total energy when the distance between obstacles was 1 5 times the length of the obstacle s l 1 5 the reductions of the height and total energy of the solitary wave reached maximum values and this distance can be selected as the optimal distance between obstacles the rate of wave height reduction and energy dissipation depends on parameters such as the intensity of the wave breaking and surface instabilities the force applied to the obstacles and the strength of the vortices the combined effect of these parameters causes the optimal case and to understand this result these factors must be investigated separately the intensity of wave breaking and surface instabilities are not measurable but the drag force applied to the obstacles and the strength of the vortices are discussed below 5 3 drag coefficient investigating coastal breakwaters strength is one of the important parameters in their design against wave impact in designing breakwaters attention should be paid to the force applied to them to appropriately select their shape dimensions and material since the frictional drag force applied to the obstacles against the pressure drag force is a very small part of the force about one thousandth the pressure drag force was obtained from numerical simulations and was expressed in a dimensionless form according to eq 16 16 c d f d 0 5 ρ g 1 q 2 h 2 where fd is the drag force ρ is the density of water h is the depth of water and q is the channel obstruction which is the ratio of the obstacle height to the depth of water according to eq 17 17 q d h fig 15 shows the drag coefficient applied on the first obstacle in different cases according to this figure as a solitary wave approaches the first obstacle the drag coefficient increases it reaches its maximum value when the solitary wave reaches the top of this obstacle after the wave crosses this obstacle the upstream flow velocity decreases and therefore the drag coefficient decreases meanwhile a clockwise vortex is created between the two obstacles and causes the flow in that area to move back towards the first obstacle as a result a force is applied to the obstacle in the opposite direction of solitary wave motion and the drag coefficient is reduced to negative values to better understand the trend of the drag coefficient plots of the horizontal non dimensional velocity as a function of time at two sections at a distance of 1 cm before and after the first obstacle x h 25 71 and x h 26 43 are shown in fig 16 according to fig 16a and b as a solitary wave approaches the obstacles the horizontal velocity at two sections increases and thus the drag force applied to the obstacle increases sharply then according to fig 16c and d the horizontal velocity gradually decreases at both sections even at some moments at the section of x h 26 43 it becomes negative and causes the force in the opposite direction of the wave motion this leads to the negative drag force applied to the obstacle next due to this vortex s movement towards the second obstacle the negative drag coefficient increases and becomes a positive drag coefficient finally by decreasing the fluid velocity on both sides of the obstacle the drag coefficient also approaches to zero changing the obstacle s distance has a greater effect on the negative part of the drag coefficient fig 17 shows the vortex between the obstacles at t 15 at difference s l it can be seen that as the distance between the two obstacles increases a larger vortex is created in this area as a result the force applied to the obstacle in the opposite direction of the wave motion is greater therefore the negative drag coefficient reaches higher values for further investigation the maximum drag coefficient applied to the first obstacle is shown in fig 18 it was observed that in all cases with increasing the obstacles height the maximum drag coefficient has also increased this was because of the flow obstruction increment increasing the obstacles distance also increases the maximum drag coefficient applied on the first obstacle increasing the distance between the two obstacles causes the phenomenon of crest transmission to be delayed as a result a larger force is applied to the obstacle fig 19 shows the drag coefficient applied to the second obstacle over time in different cases it can be seen that the drag coefficient applied on the second obstacle behaves similarly to that on the first obstacle when the wave approaches the obstacle the drag coefficient increases and when the wave passes over it due to the momentum reduction the drag coefficient decreases to zero as mentioned in the previous sections the solitary wave breaks after passing the second obstacle it creates a water jet which falls from wave crest and hit the water surface sharply behind the second obstacle and creates a clockwise vortex in this area this vortex also causes water to move towards the second obstacle due to its rotation this action reduces the drag coefficient rapidly and in some cases it also causes a negative drag coefficient increasing the distance between the two obstacles causes the falling jet to hit the water surface at a shorter distance from the second obstacle therefore the vortex is directed more strongly toward the obstacle as a result the force applied to the obstacle is stronger in the opposite direction of the solitary wave motion causing the drag coefficient to reach a negative value however when the obstacle s distance is short s l 0 5 the wave breaking occurs farther from the obstacle and the vortex moves more freely therefore less water returns to the obstacle and the drag coefficient remains positive fig 20 shows the maximum drag coefficient applied to the second obstacle in different cases it was observed that the drag coefficient increase as the height of the two obstacles increases however one of the differences between the behavior of the drag coefficient applied on the second obstacle and the first one is that in this case changing the obstacles distance has a significant effect on the force and drag coefficient applied to the second obstacle when the solitary wave reaches the first obstacle the still water that exists between the two obstacles flows water enters the gap from the top of the first obstacle and leaves the gap from the side of the second obstacle this process applies force on the second obstacle the greater the obstacles distance the more severe this phenomenon is and the higher the drag coefficient applied to the second obstacle is also because the water reaches the second obstacle with more intensity than the first one the drag coefficient applied to the second obstacle will be higher than for the first one and as a result more considerations are needed to build the second obstacle 5 4 vortex strength during the solitary wave s passage over the obstacles two clockwise vortices are created between the two obstacles and after the second obstacle which causes a loss of solitary wave energy by examining these vortices vorticity we can better understand the results obtained in terms of the solitary wave s height reduction and energy loss according to eq 18 vorticity is defined as the curl of the velocity field and according to this definition the clockwise vortex has negative vorticity 18 ω v x u y figs 21 and 22 show the vorticity of clockwise vortices between the obstacles and after the second obstacle over time respectively as expected it was observed that the clockwise vortex between obstacles occurs earlier than the clockwise vortex after obstacles this vortex was generated at t 17 in all cases and quickly reached its maximum power at t 19 when the solitary wave crest reached above the vortex after that the vorticity of the vortex gradually decreased due to the small area between the obstacles the rate of vorticity reduction for cases with s l 0 5 and s l 1 was much more than in cases with s l 1 5 and s l 2 and the vortex strength in these cases subsides rapidly by examining the effect of the obstacles distance it was observed that at s l 1 5 the vorticity of the clockwise vortex between the obstacles was higher than in the other cases the solitary wave breaking and the falling jet of water cause an intense velocity gradient after the obstacles as a result the vortex generated after the obstacles has more strength than the first vortex this vortex for cases with s l 0 5 and s l 1 was generated at t 18 while in cases with s l 1 5 and s l 2 it was generated at t 19 because with increasing distance between the obstacles the solitary wave reaches the second obstacle later like the first vortex when a solitary wave crest reaches above this vortex t 20 its vorticity reaches its maximum value and after that it gradually decreases however unlike the vortex between obstacles the vorticity reduction rate is almost the same in different cases the strength of this vortex depends on the intensity of the falling jet of the breaking wave the shorter the distance between the obstacles the less water can flow in this area and as a result the intensity of the falling jet after the second obstacle increases therefore the strength of the vortex decreases with increasing s l increasing the height of the obstacles increases the area between the obstacles and after the second obstacle which causes more water to flow and fall into these areas as a result the rotation speed of the vortices and velocity gradients increases therefore as the height of the obstacles increases both vortices maximum vorticity increases 6 conclusion in this study the interaction of a solitary wave with two rectangular obstacles at different heights and distances was investigated experimentally and numerically in the experimental procedure we use white light and piv techniques to investigate the water s free surface and the flow field near the obstacles due to solitary wave interaction with the rectangular obstacles with d h 0 86 and s l 1 in the numerical procedure which was validated by the experimental results the effects of changing the distance and height of obstacles were investigated the main conclusions of the simulations are the following 1 by examining the experiments and numerical simulations it was observed that due to the passage of a solitary wave over obstacles three phenomena of wave breaking crest crest exchange and air water mixing occur the crest crest exchange begins on the first obstacle and the other two phenomena occur after the second obstacle 2 the numerical simulations were solved with a laminar and turbulent flow model it was observed that the results obtained by the laminar model in different parts were in good agreement with the experimental results including the solitary wave s free surface profile wave breaking velocity field around obstacles solitary wave height and crest velocity therefore a correct model for simulation was achieved 3 as the obstacles height increases the solitary wave s height reduction and energy loss increase in all cases but increasing the obstacles distance does not lead to such a result the obstacles distance has an optimal value of s l 1 5 at which the amount of reductions in height and total energy of a solitary wave reaches maximum values and a further increase of this distance weakens the breakwater performance 4 the drag coefficient on the two obstacles reaches its maximum value when the solitary wave reaches the tops of the obstacles the drag coefficient applied to the second obstacle was larger than the drag coefficient applied to the first obstacle due to the more severe water impact 5 the presence of the second obstacle causes a negative drag coefficient on the first obstacle also the wave breaking has the same effect on the drag coefficient on the second obstacle 6 the presence of the second affects the size and movement of the vortex between the obstacles in the cases with s l 1 5 the strength of this vortex was the maximum also by increasing the obstacles distance the strength of the vortex after the second obstacle increases 7 increasing the height of the obstacles increases their drag coefficient and the strength of the vortices 8 increasing the distance between obstacles reduces the strength of the vortex after the second obstacle and increases the drag coefficient on the two obstacles declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national research foundation of korea nrf grant which is funded by the korean government msit no 2020r1a5a8018822 no 2021r1a2c2012469 appendix grid independence study is conducted to discover the optimum grid size for the numerical simulations in both laminar and turbulence models for numerical simulations with laminar and turbulence models three and four different grids have been used respectively the results obtained from them have been compared with each other to determine the optimum grid it should be note that the simulations were performed at s l 1 and d h 0 86 which was the main case in the study also by adjusting the bias ratio the y value was held constant in different grids table a 1 shows the number of cells for each grid used for simulations table a 1 number of cells in different grids table a 1 number of cells turbulence flow laminar flow grid 1 186000 186000 grid 2 350000 350000 grid 3 508000 508000 grid 4 821000 figs a1 and a2 show the time histories of the surface elevations at x h 20 and x h 35 obtained in different grids in laminar and turbulent flow respectively fig a 1 time histories of surface elevations obtained from turbulent flow at different grids fig a 1 for more investigation figs a4 and a5 illustrate the horizontal and vertical non dimensional velocity profiles at the two sections shown in fig a3 in laminar and turbulent flow respectively fig a 2 time histories of surface elevations obtained from laminar flow at different grids fig a 2 fig a 3 diagram of two sections used for calculating velocity profiles fig a 3 fig a 4 horizontal and vertical velocity profiles at two sections at t 14 5 obtained from turbulent flow at different grids fig a 4 fig a 5 horizontal and vertical velocity profiles at two sections at t 14 5 obtained from laminar flow at different grids fig a 5 according to figs a1 and a4 there is no significant change in the results in the third and fourth grid in the simulations with the rng k ε turbulence model therefore for the numerical simulation with turbulent flow the grid size of 508000 cells has been used to perform the simulations also in the simulations with the laminar model there is no noticeable difference in the results between the second and third grid thus the second grid with 350 000 cells has been used 
