index,text
22810,hydrodynamic motion of rigid body in narrow space is a common phenomenon in nature and ocean engineering application in this paper a new simulation model based on fluent is proposed to solve this kind of fluid structure interaction problem in which added mass effect is strong in this new model hydrodynamic force is decomposed and a new six degree of freedom rigid body motion equation is formed with added mass force being added to both sides of the motion equation used by 6dof solver in fluent first of all numerical results of free floating rigid body in open domain by 6dof solver and experimental data of free falling sphere in still water are presented for the validation of this new simulation model then the scope of this model is studied it is found that 6dof solver in fluent cannot solve the hydrodynamic motion of rigid body if added mass effect is strong while this new model is apt for this kind of problem and has good convergent characteristics finally hydrodynamic behavior of rigid body in a changing domain is simulated by the new model acceleration and spatial displacement curves are obtained and details of flow at some key moments are presented and analyzed keywords fluid structure interaction added mass effect hydrodynamic motion six degrees of freedom cfd 1 introduction motion of rigid structures in fluid is commonly encountered in engineering applications such as emergency surfacing of submarine autonomous and remotely operated underwater vehicles and launched projectile the dynamic behavior of those rigid structures inside water is a complex fluid structure interaction fsi problem because dynamic pressures act simultaneously on fluid and rigid structures gertler and hagen 1967 were the pioneer researchers in this field they proposed standard motion equations to simulate six degree of freedom movements and trajectories of submarines from then on various mathematical models have been developed sayyaadi and ura 1999 discussed neural network identifier for six degree of freedom rigid body and this proposed idea was applied to calculate the surge sway heave and yaw of an autonomous underwater vehicle auv named twin burger 2 fang 2008 presented a series of analyses to investigate the behavior of remotely operated vehicle rov in uniform currents the planar motion mechanism test technique was adopted to obtain corresponding hydrodynamic coefficients of rov michalski 2009 developed a method based on dynamic equations to study planar motion of an auv in its vertical and horizontal directions these dynamic models stem either from taylor expansions abkowitz 1964 or a combination of all the hydrodynamic force components ogawa and kasai 1978 the key task is to determine the expression of hydrodynamic force theoretical calculation pourzanjani et al 1987 kim et al 2002 and captive model test feldman 1987 1995 tu et al 2019 were usually adopted to obtain the hydrodynamic force however those ways of obtaining hydrodynamic force used quasi steady analysis method and they could not track real time fluid structure interactions and neglect the evolution of the fluid field with the development of computer science numerical simulation has been widely applied in the simulation of fluid loads on structures it covers many shortages of experimental and theoretical analyses besides with the application of dynamic grid technology unsteady numerical simulation is making a great progress loosely or weakly and strongly coupled schemes are developed to solve fluid structure interaction problems loosely coupled schemes are now widely used because of their efficiency mnasri et al 2010 investigated the two dimensional entry and exit of horizontal cylinders in calm water the volume of fluid method vof was used to describe the free surface and the dynamic mesh technique dmt was adopted to follow the motions of cylinders hargreaves et al 2014 used a coupled computational fluid dynamic rigid body dynamics cfd rbd model to study the fixed axis autorotation of a square flat plate cfd rbd model was also applied to investigate the aerodynamic behavior of some complex projectiles sahu and fresconi 2013 silton et al 2015 kamath et al 2017 used the open source computational dynamics model reef3d to study the vertical velocity of a wedge during the process of free fall a six degree of freedom algorithm was implemented to model the moving wedge and the level set function was adopted to describe the free surface deformations numerical results were in a good agreement with experimental data chung et al 2018 combined a hybrid finite volume finite element computational fluid dynamics cfd solver with a nonlinear finite element computational structural dynamics csd solver to simulate the flapping motion of a fin and joint system all those investigations mentioned above involve the dynamic behavior of object in infinite domain however the motion of rigid bodies in narrow spaces or finite domain is also commonly seen in engineering applications such as sub launched projectile inside the tube the independent escapes capsule inside the submarine when 6dof solver in fluent sas ip 2010 and the similar model mentioned above are applied to simulate the hydrodynamic behavior of rigid body in narrow space it is found that computational results are instable and non convergent issue occurs in order to find out the causes related literature were searched in this field causin et al 2005 brummelen 2009 idelsohn et al 2009 ryzhakov et al 2013 2017 dunbar 2015 and naseri et al 2018 pointed out that numerical instability typically occurs in the internal flow of an incompressible fluid whose density is close to the structure s density and the so called added mass effect is the main reason these researches provide the theoretical foundation of this study in this paper a new simulation model based on fluent version 13 0 1 combined with the dynamic mesh method is proposed to simulate the hydrodynamic motion of the free floating rigid body in narrow spaces in this new model hydrodynamic force is decomposed and a new six degree of freedom rigid body motion equation is derived accounting for the strong added mass effect the remainder of this paper is organized as follows section 2 presents the physical models and numerical methods used in the new simulation method as well as the process of the new simulation model in section 3 the new simulation model is validated by two cases in which its simulation results fit well with the numerical results by 6dof solver in fluent and experimental data respectively section 4 indicates the scope of the new proposed simulation model through a series of comparative studies with the standard 6dof fluent solver in section 5 the new simulation model is applied to investigate the hydrodynamic behavior of rigid body in a changing domain finally conclusions are presented in section 6 2 numerical model loosely or weakly and strongly coupled schemes are usually applied to solve the dynamical system consisting of fluid flow interacting with moving rigid structures the present paper uses loosely or weakly coupled scheme in which fluid field and motion equations are solved separately at single time step with a transfer of relevant variables at the fluid structure interface 2 1 governing equations of the fluid the homogeneous and incompressible flow field around the moving structures is obtained by solving the reynolds averaged navier stokes equation the 3d navier stokes equations are 1 u i x i 0 2 ρ u i t ρ u i u j x i ρ g i p x i x j μ u i x j u j x i x j ρ u i u j where subscripts i j 1 2 3 represent the three dimensional flows corresponding to x y and z axes the superscripts denote ensemble average of the physical variables u i and x i are ith component of the velocity and spatial coordinates respectively ρ is density of fluid ρ 998 2 k g m 3 p is pressure μ is dynamic viscous coefficient g i is body force ρ u i u j is the reynolds stress in this paper the standard k epsilon turbulence model is used for equation closure the transport equations for k and ε are 3 ρ k t ρ k u j x i x j μ μ t σ k k x j ρ g k ρ ε 4 ρ ε t ρ ε u j x i x j μ μ t σ ε k x j ε k c ε 1 ρ g k c ε 2 ρ ε 5 μ t c μ ρ k 2 ε 6 g k μ t ρ u i x j u j x i u i x j where k is turbulence kinetic energy ε is dissipation rate of turbulence kinetic energy μ t is eddy viscosity g k is turbulent energy production the empirical coefficient in eqs 3 5 are given as follows c μ 0 09 c ε 1 1 44 c ε 2 1 92 σ k 1 0 σ ε 1 3 2 2 governing equations of the solid the hydrodynamic motion of rigid body underwater is a fluid structure interaction problem which is shown in fig 1 as well as force on rigid body the motion equations of six degrees of freedom in object fixed coordinate o xyz can be expressed as 7a m v x ω y v z ω z v y f x 7b m v y ω z v x ω x v z f y 7c m v z ω x v y ω y v x f z 8a i x ω x i z i y ω y ω z m x 8b i y ω y i x i z ω z ω x m y 8c i z ω z i y i x ω x ω y m z where subscripts x y and z represent the axes of the object fixed coordinate m is mass i is inertia moment v and ω are the spatial and angular accelerations respectively v and ω are the spatial and angular velocities respectively f and m are the resultant force and moment on the object respectively eqs 7 and 8 are the first order partial differential equations the left items of those motion equations consist of mass inertia moment and motion parameters in which the mass and inertia moment are the physical properties of the structure motion parameters are unknown variables the right items of motion equations are forces on rigid body buoyancy f b and gravity g keep constant during the motion underwater hydrodynamic force f h and m is decided by the pressure distribution of flow due to the movement of rigid body and affects motion characteristics of rigid body in the meantime so the key point of simulating this fluid structure interaction problem of hydrodynamic motion of rigid body is to obtain comparatively accurate hydrodynamic force and motion parameters of rigid body the 6dof solver in fluent sas ip 2010 and most researchers cao et al 2012 huang et al 2014 sandoval et al 2015 use eqs 7 and 8 directly without considering the strong added mass effect fig 2 compares the flow chart of 6dof solver in fluent and that of the new proposed simulation model fig 3 uses a single degree of freedom equation of the free floating and free falling motion of rigid body in z direction to illustrate the iterative process of 6dof solver loosely coupled scheme for the free floating and free falling motion in z direction the equations were reduced to a single degree of freedom 9 m v z f z g f b f h δ f f h where the force acting on underwater structures consists of gravity g buoyancy f b and hydrodynamic force f h at t 0s rigid body begins to move in calm water under its residual buoyancy δ f g f b hydrodynamic force is equal to zero and is substituted into eq 9 to obtain motion parameter of rigid body acceleration in z direction then rigid body undergoes uniformly accelerated motion in z direction from t 0 s to t δ t at the end of first time step t δ t rigid body obtains a velocity and hydrodynamic force f h has a value it is commonly known that hydrodynamic force f h of unsteady motion can be separated into drag force f r and dynamic reaction force f a sarpkaya and garrison 1963 bird 1984 drag force obtained is real time value at t δ t while dynamic reaction force is 10 f a δ t m a δ t v z t 0 s where m a is called hydrodynamic added mass in z axis and dynamic reaction force is also called added mass force f h δ t is substituted into eq 9 to obtain v z t δ t and then it can be derived that hydrodynamic force at t t δ t obtained through fluent consists of real time drag force and non real time added mass force it is well known that residual buoyancy drives the underwater structure to move rigid body conducts variable acceleration motion due to the function of hydrodynamic force in which v z t t v z t t δ t 0 two equations are compared as below 11 m v z t t δ t δ f f h t δ t δ f f r t δ t m a t δ t v z t t δ t 12 m v z l t t δ t δ f f h t δ t δ f f r t δ t m a t δ t v z t t eq 11 is the real time motion equation of rigid body while eq 12 is the motion equation solved by the loosely coupled scheme in order to distinguish two different accelerations the real time acceleration is represented by v z in eq 11 while the acceleration solved by loosely coupled scheme is represented by v z l when rigid body moves in narrow space the added mass m a is much bigger than the mass of rigid body m and then a situation may occur as below 13 m a t δ t v z t t m a t δ t v z t t δ t m v z t t δ t eq 11 and eq 13 is substituted into the right side of eq 12 14 m v z l t t δ t δ f f r t δ t m a t δ t v z t t δ t m v z t t δ t 0 it can be seen from right side of eq 14 that hydrodynamic force is larger than residual buoyancy consequently the simulation cannot describe the correct physical motion phenomenon and the simulation may break down due to the divergence problem of numerical calculation in order to overcome this problem the hydrodynamic force solved by fluent should be decomposed eq 12 solved by the loosely coupled scheme is modified as follows 15 m v z l t t δ t m a t δ t v z t t δ f f r t δ t m a t δ t v z t t m a t δ t v z t t it can avoid the situation when hydrodynamic force is larger than residual buoyancy in eq 14 in consideration of little change of acceleration at two consecutive time steps during hydrodynamic motion it can be assumed that v z t t v z l t t δ t v z t t δ t then eq 15 turns into 16 m m a t δ t v z t t δ t δ f f h t δ t m a t δ t v z t t the new proposed simulation model uses eq 16 to describe the motion of underwater structures in z axis instead of eq 12 as for the governing equations of the translational motion along x and y axes and rotational motion around x y and z axes they are the mathematical expressions similar to eq 9 consequently the derivation process above could be adopted to establish the new six degree of freedom governing equations of the solid 3 validation cases two different cases are applied to validate the proposed simulation model in the one case both 6dof solver in fluent and the new proposed simulation model are used to simulate the free floating motion of a cylindrical structure in open domain in another case the free falling motion of a sphere in calm water is simulated by the proposed simulation model and the results are compared with experimental data 3 1 free floating motion the model is a cylinder with two hemi ellipsoidal end caps as shown in fig 4 a its geometry parameters are listed in table 1 a cylindrical computational domain is adopted with its size shown in fig 4b as well as the boundary conditions the no slip wall boundary condition is prescribed for the fluid on the boundary parts such as the surfaces of the model and the top bottom and lateral surface of the cylindrical computational domain hybrid grids are applied to discrete the computational domain unstructured tetrahedron mesh is used in dynamic mesh zone while structured hexahedron mesh is formed in the outer zone interface is applied in the overlapping surface of those two zones for data transmission the grid system is shown in fig 4c in order to capture the boundary layer development the y criterion is used with values between 30 and 300 sas ip 2010 pan and kinnas 2011 the first mesh height around the model is 4 mm 6dof solver in fluent and the new proposed simulation model are adopted to simulate the free floating motion of this cylindrical structure these two simulation models solve different motion equations as shown in eq 12 and eq 16 respectively added mass of the object is required in eq 16 so in the new proposed simulation model one more step is needed to obtain added mass of the cylindrical structure the computational domain and the shape of object keep unchanged during its free floating motion so added mass can be treated as constant value udf is adopted to customize the moving boundary condition of the cylindrical structure the uniform acceleration in z direction is selected as 1 m s2 time step δt 0 001s is chosen cell courant number is less than 1 which represents that the stability and convergence of simulation is satisfactory fig 5 shows the time variation of hydrodynamic force the calculated added mass of the cylindrical structure is m a t f a t v z 54 33 k g then this added mass value is adopted to simulate the free floating motion of object by the new proposed simulation model fig 6 compares the displacement of the finite cylinder calculated by 6dof solver and new proposed simulation model it can be seen that the results fit well with each other 3 2 free falling motion numerical model is also validated by comparing the computational acceleration of the free falling sphere with experimental data from fackrell 2011 the diameter of the sphere in the experiment is d 0 0254 m its mass is equals to 0 01912 kg the density of fluid is 998 200 kg m3 in the numerical calculation the computational domain is x y z 0 30 m 0 30 m 0 38 m the sphere is suspended at 4 5 diameters below the top of the domain computational domain is discretized with hybrid grids 3d unstructured mesh is applied around the sphere in the dynamic zone while structural grid is formed outside the dynamic zone the first mesh height around the sphere is 1 mm which satisfies the y criterion the description of the computational domain and grid system around the sphere is shown in fig 7 fig 7a also presents the boundary conditions the no slip wall boundary condition is applied for the surface of sphere the bottom and four lateral walls sphere is positioned at an enough depth so the effects of free surface can be neglected it is also reasonable to set the top of the domain as the no slip wall boundary condition the overlapping surface of dynamic mesh zone and the outer zone is set as interface boundary condition for data transmission the analytical derived added mass of a sphere based on potential flow formulation is equivalent to the half mass of the displaced fluid sarpkaya and isaacson 1981 this added mass is adopted in udf to solve eq 16 fig 8 shows the acceleration in z axis with respect to the non dimensional displacement z d where d is the diameter of the sphere the acceleration decreases during free fall the acceleration from experimental data between z d 0 2 to z d 0 6 decreases at a near linear trend and then drops nonlinearly the same trend can be seen from the results of the numerical calculation it can also be seen that the numerical results match well with the experimental data especially after z d 0 6 4 scope of the new proposed simulation model the validation case of free floating motion in section 3 1 indicates that this new proposed simulation model is apt for the motion problems that 6dof solver can solve in this section a series of cases are investigated in order to indicate the scope of this new proposed simulation model especially some cases that 6dof solver can not simulate 4 1 rigid body in different computational domains internal flow problem of an incompressible fluid is common in nature and ocean engineering application such as capsule in the digestive tract sub launched projectile independent escape capsule inside disabled submarine rather than the flow in the open field the hydrodynamic behavior of object in three different finite domains is studied here two dimensional calculation is carried out in order to save the needed computing resources as well as time the profile of object refers to section b b in fig 4a density of object remains 930 950 kg m3 computational domain is shown in fig 9 a three domains with different breadths are adopted which are b 5 000 mm b 1 000 mm and b 600 mm respectively the boundary of computational domain is set as no slip wall boundary condition fig 9b shows the grid system around one end cap of object hybrid mesh is applied in computational domain with b 5 000 mm and interface is set in the overlapping surfaces between unstructured triangular and structured quadrilateral mesh unstructured mesh is applied to discrete computational domains with b equal to 600 mm and 1 000 mm the first mesh height around object is 4 mm added mass of object in three different computational domains is calculated by define the uniform acceleration in y direction as 1 m s2 time step δt 0 001s is chosen in the simulation fig 10 gives the time variation of hydrodynamic force the calculated added mass of object in different computational domains is listed in table 2 added mass of object soars with the decrease of breadth fig 11 shows velocity contour in three different domains at t 0 01s when the velocity of object is 0 01 m s it can be seen from fig 11a that fluid flows through object in domain with b 5 000 mm and gradually spreads around the enlarged image around top cap of the object shows that only fluids very close to the surface of object is dragged however fig 11b and c shows that side walls of computational domain block the spread of flow toward its left and right direction which makes that the object should push more adjacent fluid to move along the maximum velocity of fluid around object inside the domain with b 600 mm even reaches 0 055 m s which is nearly 5 5 times the speed of object this is the reason for the increase of added mass of object in narrow spaces then the hydrodynamic behavior of object in these three different domains is studied by 6dof solver in fluent and the new proposed simulation model added mass obtained is substituted into eq 16 in the new proposed simulation model figs 12 14 reflect motion characteristic curves of object inside the domains with three different breadths b 5 000 mm b 1 000 mm and b 600 mm respectively they are double x axis and double y axis curves in which red curves match axis in red color and black curves match axis in black color red curves are the results by 6dof solver while black curves show the results by the new proposed simulation model fig 12a shows that in the computational domain with b 5 000 mm acceleration decrease gradually with time and some numerical oscillations occur after t 1s fig 12b reflects that the spatial displacement of object increases nonlinearly and it takes less than 4 seconds for object moving the distance of 2 5 m that is the length of object it can be seen that motion curves obtained by the new simulation model fit well with that by 6dof solver in a comparatively open domain fig 13 shows that the motion curves of object in a domain with b 1 000 mm in which the added mass of object is slightly larger than the mass of object the acceleration in fig 13a obtained by 6dof solver changes between positive and negative numbers and eventually diverges in less than 70 iterative computations this means that hydrodynamic force drives object to move in one iteration and hinders the motion of object in next iteration fig 13b also shows that the spatial displacement by 6dof solver oscillates between positive and negative values all these results can not reflect correctly the hydrodynamic behavior of the free floating object however the acceleration of object obtained by the new simulation model decreases gradually from about 0 32 m s2 at t 0s to 0 08 m s2 at t 5s and object moves 2 5 m in about 4 8 seconds the acceleration in the domain with b 1 000 mm is smaller than that of object in the domain with b 5 000 mm and it takes more time about 1 s for object to move about 2 5 m this physical phenomenon is correct and easily understandable fig 14 displays the results of object inside the domain with its breadth keeping decreasing into 600 mm it can be seen from table 2 that the added mass of object in this situation is over 5 times as big as the mass of object the acceleration curve calculated by 6dof solver in fig 14a reaches 60 000 m s2 within 7 iterations which indicates that the results diverge rapidly the spatial displacement curves by 6dof solver in fig 14b also shows that object moves upward and downward alternatively which is contrary to the physical facts however the new simulation model can obtain the corresponding motion curves of object in domain with b 600 mm the acceleration decreases from 0 1 m s2 at t 0s to nearly 0 m s2 at t 7s and from then on the acceleration fluctuates around 0 m s2 it means force on object is balanced object moves in a constant velocity eventually which can also be seen from fig 14b that the spatial displace curve obtained by the new simulation model increases linearly after t 7s it takes 10 seconds for object to move about 2 5 m it is clear that the breadth of the computational domain affects the simulation of hydrodynamic behavior of object if the breadth of domain is 5 000 mm both 6dof solver and the new model can accurately calculate the motion of the object inside this domain when the breadth decreases to 1 000 mm or less the results of 6dof solver diverges while the new simulation model can cope with these cases in which the added mass effect is severe the blockage effect of side walls hinders the spread of fluid and then added mass of object increases obviously the increasing added mass affects the hydrodynamic behavior of object it leads to the decrease of acceleration and meanwhile prolongs the time to move the same distance 4 2 rigid body with different density the logic of the research in section 4 1 and the researches to be commenced in this section is shown in fig 15 it is hard to draw a conclusion directly from the study in section 4 1 that added mass effect leads the divergent computation of 6dof solver in order to confound the sceptic that it is the size of computational domain directly affecting the application of 6dof solver rather than the added mass effect the influence factor size of domain is eliminated by studying objects with different densities inside the same domain in this section another two densities ρ o 317 792 kg m3 and ρ o 280 000 kg m3 are chosen for the research the domain is also shown in fig 9a and the breadth is set as b 5 000 mm the boundary conditions and grid system are the same as described in section 4 it is no doubt that the added masses of these two objects are the same due to the same shape of object same domain and fluid table 3 compares related parameters of these two cases figs 16 and 17 show the motion characteristic curves of these two objects calculated by 6dof solver and the new simulation model respectively for the object ρ o 317 792 kg m3 it can be seen from fig 16a that the acceleration obtained by 6dof solver oscillates severely between positive and negative value from t 0s to t 0 15s and then converges while the results by the new simulation converges at the first beginning which can better describe the hydrodynamic behavior of the free floating object the spatial displacement by 6dof solver and the new model fits well with each other fig 17a and b represent acceleration and spatial displacement of object with ρ o 280 000 kg m3 the same phenomenon occurs as fig 13 in which the results by 6dof solver deviate from the physical commonsense knowledge the simulation results diverge in about 90 iterations however the acceleration obtained by the new simulation model decreases from about 12 m s2 at t 0s to 3 m s2 around t 0 8s it takes 0 8 seconds to move 2 5 m from the studies in section 4 1 and 4 2 a conclusion can be drawn that when added mass surplus the mass of object the traditional 6dof solver fails the new proposed simulation model can calculate the motion of object when its added mass effect is strong 5 hydrodynamic behavior in the changing domain the sub launched projectile from launch canister and the ejection of independent escape capsule from the disable submarine are typical hydrodynamic behaviors from one narrow space into an open field which would show totally different kinetic characteristic from the motion in a narrow space fig 18 gives a description of this problem the object has the same profile as section b b in fig 4a the computational domain has two different breadths b1 600 and b2 5 000 mm which represents narrow space and open field respectively the free floating motion of object in this computational domain is studied and the motion characteristic curves are compared with the motion of object in computational domain with b 600 mm from section 4 1 density of object remains 930 950 kg m3 the boundary conditions are shown in fig 18a fig 18b displays the hybrid grid system around two end caps of object the first mesh height is 4 mm which satisfies the requirement of y criterion interface is set in the overlapping surfaces between unstructured and structured mesh firstly the motion of object in the changing domain leads to various shapes of the flow field which is illustrated in fig 19 object is at four different positions y0 0 mm y0 200 mm y0 2 400 mm and y0 2 600 mm different from the situation that object moves in computational domain b 600 mm the added mass of object in the changing computational domain b1 600 mm and b2 5 000 mm alters with flow field variation udf is adopted to define the moving boundary condition of the cylindrical structure ay 1 m s2 dynamic mesh method is applied to update the mesh time step δt 0 001s is chosen for the calculation it can be seen from the velocity contour in fig 19 that fluid around the top cap of object spreads around without the blockage effect of side walls fluid that flows along with object reduces when the object gradually departs the narrow space at four different positions y0 0 mm y0 200 mm y0 2 400 mm and y0 2 600 mm fig 20 gives corresponding hydrodynamic force curves of object at those four different positions the hydrodynamic force decreases with the increase of y0 table 4 lists added mass of object at different positions and the corresponding numerical results are shown in fig 21 with the symbols of red delta before the calculation of hydrodynamic behavior by the new simulation model added mass of object at all the various positions is needed but numerical simulation at all those positions is a heavy work in this paper fitting method is used in forming the added mass curve of object the linear fitting is adopted through observing the distribution of the numerical results and the fitting formula is 17 m a y 0 6 123 100 776 800 y 0 0 y 0 0 2 6 443 407 2 378 335 y 0 0 2 y 0 2 4 3 644 586 1 212 160 y 0 2 4 y 0 2 686 388 660 2 686 y 0 then this formula is adopted to simulate the hydrodynamic motion of object fig 22 compares the motion characteristics of object in the changing domain b1 600 mm and b2 5 000 mm with those in the domain b 600 mm the accelerations of those two cases are the same at the first beginning of motion then they both fall from about 0 1 m s2 at t 0s to 0 m s2 at t 7s but the descending rate of object in the domain b 600 mm is slightly lower than that of object in the changing domain after t 7s object in the domain b 600 mm moves in a constant speed with acceleration staying at 0 m s2 while the acceleration of object in the changing domain increases slowly to about 0 01 m s2 at t 9s then a sudden drop is seen in the acceleration from 0 01 m s2 at t 9s to 0 166 m s2 at t 9 6s which followed by a sharp increase to 0 4 m s2 at t 10s from then on the acceleration decreases again it can be seen from fig 22b that the spatial displacement of object in the domain b 600 mm is larger than that of object in the changing domain from t 0s to t 9 2s and from then on the displacement of object in the changing domain increases at a bigger rate at t 10 5s its displacement reaches 2 8 m while the displacement of object in the domain b 600 mm is 2 5 m the various motion characteristics of object are the results of force on the object the flow field around object at three different typical moments t 2s t 9 5s and t 10 5s is introduced for the illustration figs 23 25 show the velocity contours and velocity vectors around object in two different domains at t 2s t 9 5s and t 10 5s respectively at t 2s the top cap of object departs from the narrow domain b1 600 mm and goes into the open domain b2 5 000 mm as shown in fig 23a the velocity contour and vector around object are almost the same as those in fig 23b except that the fluid around top cap of object spreads around without the confine of side walls it is generally recognized that this phenomenon will leads to the decrease of hydrodynamic force compared to the fluid around the top cap of object in the domain b 600 mm as shown in fig 23b but looking carefully at the detail of velocity vector around the top cap there is some flow swarming into the narrow domain from the open domain and the velocity reaches 1 07 m s which is bigger than the maximum velocity in fig 23b this is the main reason that leads to the increase of hydrodynamic force on object in the changing domain so the acceleration of object in the changing domain is lower than that of object at t 2s which is in consistency with the results in fig 22a at t 9 5s the major part of object leaves the narrow domain b1 600 mm the flow around the major part of object spreads around in the open domain without swarming into the narrow domain as shown in the top cap of object from fig 24a there is no doubt that the added mass force of object is much smaller than that of object in the domain with b 600 mm but the flow around the end cap of object saw the presence of obvious eddy this phenomenon of severe separation flow would lead to the soar of unsteady resistance compared to the flow around end cap of object in the domain b 600 mm as depicted in fig 24b at t 10 5s fig 25a shows that object departs from the narrow domain the maximum velocity of flow decreases to 0 928 m s which means that the pressure on object reduces the fluid around object spreads around in the open domain which also leads to the decrease of added mass force although the wake in the narrow domain b1 600 mm is rather complex with obvious eddy it is far from object the impact on object is limited so the hydrodynamic force on object is small and the acceleration reaches 0 4 m s2 as shown in fig 22a this value is in the range of 0 2 m s2 and 0 5 m s2 as show in fig 12a the results in fig 12a is the simulation of object in the domain with b 5 000 mm so it indicates that the acceleration of object in the changing domain at t 10 5s is reasonable the velocity contour and velocity vector of object in fig 25b are similar as those of object in fig 24b which means the fluid around object is stable this phenomenon is consistence with the acceleration curve shown in fig 22a the acceleration of object in domain with b 600 mm reduces to 0 m s2 after t 7s 6 conclusion the sub launched projectile from launch canister and the ejection of independent escape capsule from the disable submarine are examples of hydrodynamic motion in narrow spaces which is commonly encountered in ocean engineering industry in the present paper a new simulation model is proposed to solve this kind of fluid structure interaction problem in which added mass effect is strong the new simulation model is validated by two case studies one case is free floating of a three dimensional finite cylinder with two hemi ellipsoidal end caps in open domain which is simulated by 6odf solver and the new model the spatial displacement curves obtained fit well with each other the other case is the free falling of sphere with diameter equals to 0 0254 m in still water the results by the new model agree well with the experimental data then the free floating motion of rigid body in the domain with three different breadths b 5 000 mm b 1 000 mm and b 600 mm and rigid body with different densities ρ o 317 792 kg m3 and ρ o 280 000 kg m3 are studied by 6dof solver in fluent and the new simulation model it is found that the new simulation model is especially apt for this kind of hydrodynamic motion problem in which added mass of rigid body is larger than its mass while the simulation results of this kind of problem by 6dof solver are divergent and seriously not consist with the physical facts finally the new simulation model is applied to calculate the hydrodynamic motion of rigid body in the changing domain b1 600 mm and b2 5 000 mm acceleration and spatial displacement curves of rigid body are obtained its motion characteristics in the changing domain are introduced through comparative analyses with the results of the same rigid body in the narrow domain b 600 mm it is found that acceleration of object in the changing domain is lower than that of object in the narrow domain at the first beginning of motion and a sudden drop and sharp increase of acceleration are seen when object departs from the narrow domain b1 600 mm into the open domain b2 5 000 mm the reason is discussed by analyzing details of flow in those two cases acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 
22810,hydrodynamic motion of rigid body in narrow space is a common phenomenon in nature and ocean engineering application in this paper a new simulation model based on fluent is proposed to solve this kind of fluid structure interaction problem in which added mass effect is strong in this new model hydrodynamic force is decomposed and a new six degree of freedom rigid body motion equation is formed with added mass force being added to both sides of the motion equation used by 6dof solver in fluent first of all numerical results of free floating rigid body in open domain by 6dof solver and experimental data of free falling sphere in still water are presented for the validation of this new simulation model then the scope of this model is studied it is found that 6dof solver in fluent cannot solve the hydrodynamic motion of rigid body if added mass effect is strong while this new model is apt for this kind of problem and has good convergent characteristics finally hydrodynamic behavior of rigid body in a changing domain is simulated by the new model acceleration and spatial displacement curves are obtained and details of flow at some key moments are presented and analyzed keywords fluid structure interaction added mass effect hydrodynamic motion six degrees of freedom cfd 1 introduction motion of rigid structures in fluid is commonly encountered in engineering applications such as emergency surfacing of submarine autonomous and remotely operated underwater vehicles and launched projectile the dynamic behavior of those rigid structures inside water is a complex fluid structure interaction fsi problem because dynamic pressures act simultaneously on fluid and rigid structures gertler and hagen 1967 were the pioneer researchers in this field they proposed standard motion equations to simulate six degree of freedom movements and trajectories of submarines from then on various mathematical models have been developed sayyaadi and ura 1999 discussed neural network identifier for six degree of freedom rigid body and this proposed idea was applied to calculate the surge sway heave and yaw of an autonomous underwater vehicle auv named twin burger 2 fang 2008 presented a series of analyses to investigate the behavior of remotely operated vehicle rov in uniform currents the planar motion mechanism test technique was adopted to obtain corresponding hydrodynamic coefficients of rov michalski 2009 developed a method based on dynamic equations to study planar motion of an auv in its vertical and horizontal directions these dynamic models stem either from taylor expansions abkowitz 1964 or a combination of all the hydrodynamic force components ogawa and kasai 1978 the key task is to determine the expression of hydrodynamic force theoretical calculation pourzanjani et al 1987 kim et al 2002 and captive model test feldman 1987 1995 tu et al 2019 were usually adopted to obtain the hydrodynamic force however those ways of obtaining hydrodynamic force used quasi steady analysis method and they could not track real time fluid structure interactions and neglect the evolution of the fluid field with the development of computer science numerical simulation has been widely applied in the simulation of fluid loads on structures it covers many shortages of experimental and theoretical analyses besides with the application of dynamic grid technology unsteady numerical simulation is making a great progress loosely or weakly and strongly coupled schemes are developed to solve fluid structure interaction problems loosely coupled schemes are now widely used because of their efficiency mnasri et al 2010 investigated the two dimensional entry and exit of horizontal cylinders in calm water the volume of fluid method vof was used to describe the free surface and the dynamic mesh technique dmt was adopted to follow the motions of cylinders hargreaves et al 2014 used a coupled computational fluid dynamic rigid body dynamics cfd rbd model to study the fixed axis autorotation of a square flat plate cfd rbd model was also applied to investigate the aerodynamic behavior of some complex projectiles sahu and fresconi 2013 silton et al 2015 kamath et al 2017 used the open source computational dynamics model reef3d to study the vertical velocity of a wedge during the process of free fall a six degree of freedom algorithm was implemented to model the moving wedge and the level set function was adopted to describe the free surface deformations numerical results were in a good agreement with experimental data chung et al 2018 combined a hybrid finite volume finite element computational fluid dynamics cfd solver with a nonlinear finite element computational structural dynamics csd solver to simulate the flapping motion of a fin and joint system all those investigations mentioned above involve the dynamic behavior of object in infinite domain however the motion of rigid bodies in narrow spaces or finite domain is also commonly seen in engineering applications such as sub launched projectile inside the tube the independent escapes capsule inside the submarine when 6dof solver in fluent sas ip 2010 and the similar model mentioned above are applied to simulate the hydrodynamic behavior of rigid body in narrow space it is found that computational results are instable and non convergent issue occurs in order to find out the causes related literature were searched in this field causin et al 2005 brummelen 2009 idelsohn et al 2009 ryzhakov et al 2013 2017 dunbar 2015 and naseri et al 2018 pointed out that numerical instability typically occurs in the internal flow of an incompressible fluid whose density is close to the structure s density and the so called added mass effect is the main reason these researches provide the theoretical foundation of this study in this paper a new simulation model based on fluent version 13 0 1 combined with the dynamic mesh method is proposed to simulate the hydrodynamic motion of the free floating rigid body in narrow spaces in this new model hydrodynamic force is decomposed and a new six degree of freedom rigid body motion equation is derived accounting for the strong added mass effect the remainder of this paper is organized as follows section 2 presents the physical models and numerical methods used in the new simulation method as well as the process of the new simulation model in section 3 the new simulation model is validated by two cases in which its simulation results fit well with the numerical results by 6dof solver in fluent and experimental data respectively section 4 indicates the scope of the new proposed simulation model through a series of comparative studies with the standard 6dof fluent solver in section 5 the new simulation model is applied to investigate the hydrodynamic behavior of rigid body in a changing domain finally conclusions are presented in section 6 2 numerical model loosely or weakly and strongly coupled schemes are usually applied to solve the dynamical system consisting of fluid flow interacting with moving rigid structures the present paper uses loosely or weakly coupled scheme in which fluid field and motion equations are solved separately at single time step with a transfer of relevant variables at the fluid structure interface 2 1 governing equations of the fluid the homogeneous and incompressible flow field around the moving structures is obtained by solving the reynolds averaged navier stokes equation the 3d navier stokes equations are 1 u i x i 0 2 ρ u i t ρ u i u j x i ρ g i p x i x j μ u i x j u j x i x j ρ u i u j where subscripts i j 1 2 3 represent the three dimensional flows corresponding to x y and z axes the superscripts denote ensemble average of the physical variables u i and x i are ith component of the velocity and spatial coordinates respectively ρ is density of fluid ρ 998 2 k g m 3 p is pressure μ is dynamic viscous coefficient g i is body force ρ u i u j is the reynolds stress in this paper the standard k epsilon turbulence model is used for equation closure the transport equations for k and ε are 3 ρ k t ρ k u j x i x j μ μ t σ k k x j ρ g k ρ ε 4 ρ ε t ρ ε u j x i x j μ μ t σ ε k x j ε k c ε 1 ρ g k c ε 2 ρ ε 5 μ t c μ ρ k 2 ε 6 g k μ t ρ u i x j u j x i u i x j where k is turbulence kinetic energy ε is dissipation rate of turbulence kinetic energy μ t is eddy viscosity g k is turbulent energy production the empirical coefficient in eqs 3 5 are given as follows c μ 0 09 c ε 1 1 44 c ε 2 1 92 σ k 1 0 σ ε 1 3 2 2 governing equations of the solid the hydrodynamic motion of rigid body underwater is a fluid structure interaction problem which is shown in fig 1 as well as force on rigid body the motion equations of six degrees of freedom in object fixed coordinate o xyz can be expressed as 7a m v x ω y v z ω z v y f x 7b m v y ω z v x ω x v z f y 7c m v z ω x v y ω y v x f z 8a i x ω x i z i y ω y ω z m x 8b i y ω y i x i z ω z ω x m y 8c i z ω z i y i x ω x ω y m z where subscripts x y and z represent the axes of the object fixed coordinate m is mass i is inertia moment v and ω are the spatial and angular accelerations respectively v and ω are the spatial and angular velocities respectively f and m are the resultant force and moment on the object respectively eqs 7 and 8 are the first order partial differential equations the left items of those motion equations consist of mass inertia moment and motion parameters in which the mass and inertia moment are the physical properties of the structure motion parameters are unknown variables the right items of motion equations are forces on rigid body buoyancy f b and gravity g keep constant during the motion underwater hydrodynamic force f h and m is decided by the pressure distribution of flow due to the movement of rigid body and affects motion characteristics of rigid body in the meantime so the key point of simulating this fluid structure interaction problem of hydrodynamic motion of rigid body is to obtain comparatively accurate hydrodynamic force and motion parameters of rigid body the 6dof solver in fluent sas ip 2010 and most researchers cao et al 2012 huang et al 2014 sandoval et al 2015 use eqs 7 and 8 directly without considering the strong added mass effect fig 2 compares the flow chart of 6dof solver in fluent and that of the new proposed simulation model fig 3 uses a single degree of freedom equation of the free floating and free falling motion of rigid body in z direction to illustrate the iterative process of 6dof solver loosely coupled scheme for the free floating and free falling motion in z direction the equations were reduced to a single degree of freedom 9 m v z f z g f b f h δ f f h where the force acting on underwater structures consists of gravity g buoyancy f b and hydrodynamic force f h at t 0s rigid body begins to move in calm water under its residual buoyancy δ f g f b hydrodynamic force is equal to zero and is substituted into eq 9 to obtain motion parameter of rigid body acceleration in z direction then rigid body undergoes uniformly accelerated motion in z direction from t 0 s to t δ t at the end of first time step t δ t rigid body obtains a velocity and hydrodynamic force f h has a value it is commonly known that hydrodynamic force f h of unsteady motion can be separated into drag force f r and dynamic reaction force f a sarpkaya and garrison 1963 bird 1984 drag force obtained is real time value at t δ t while dynamic reaction force is 10 f a δ t m a δ t v z t 0 s where m a is called hydrodynamic added mass in z axis and dynamic reaction force is also called added mass force f h δ t is substituted into eq 9 to obtain v z t δ t and then it can be derived that hydrodynamic force at t t δ t obtained through fluent consists of real time drag force and non real time added mass force it is well known that residual buoyancy drives the underwater structure to move rigid body conducts variable acceleration motion due to the function of hydrodynamic force in which v z t t v z t t δ t 0 two equations are compared as below 11 m v z t t δ t δ f f h t δ t δ f f r t δ t m a t δ t v z t t δ t 12 m v z l t t δ t δ f f h t δ t δ f f r t δ t m a t δ t v z t t eq 11 is the real time motion equation of rigid body while eq 12 is the motion equation solved by the loosely coupled scheme in order to distinguish two different accelerations the real time acceleration is represented by v z in eq 11 while the acceleration solved by loosely coupled scheme is represented by v z l when rigid body moves in narrow space the added mass m a is much bigger than the mass of rigid body m and then a situation may occur as below 13 m a t δ t v z t t m a t δ t v z t t δ t m v z t t δ t eq 11 and eq 13 is substituted into the right side of eq 12 14 m v z l t t δ t δ f f r t δ t m a t δ t v z t t δ t m v z t t δ t 0 it can be seen from right side of eq 14 that hydrodynamic force is larger than residual buoyancy consequently the simulation cannot describe the correct physical motion phenomenon and the simulation may break down due to the divergence problem of numerical calculation in order to overcome this problem the hydrodynamic force solved by fluent should be decomposed eq 12 solved by the loosely coupled scheme is modified as follows 15 m v z l t t δ t m a t δ t v z t t δ f f r t δ t m a t δ t v z t t m a t δ t v z t t it can avoid the situation when hydrodynamic force is larger than residual buoyancy in eq 14 in consideration of little change of acceleration at two consecutive time steps during hydrodynamic motion it can be assumed that v z t t v z l t t δ t v z t t δ t then eq 15 turns into 16 m m a t δ t v z t t δ t δ f f h t δ t m a t δ t v z t t the new proposed simulation model uses eq 16 to describe the motion of underwater structures in z axis instead of eq 12 as for the governing equations of the translational motion along x and y axes and rotational motion around x y and z axes they are the mathematical expressions similar to eq 9 consequently the derivation process above could be adopted to establish the new six degree of freedom governing equations of the solid 3 validation cases two different cases are applied to validate the proposed simulation model in the one case both 6dof solver in fluent and the new proposed simulation model are used to simulate the free floating motion of a cylindrical structure in open domain in another case the free falling motion of a sphere in calm water is simulated by the proposed simulation model and the results are compared with experimental data 3 1 free floating motion the model is a cylinder with two hemi ellipsoidal end caps as shown in fig 4 a its geometry parameters are listed in table 1 a cylindrical computational domain is adopted with its size shown in fig 4b as well as the boundary conditions the no slip wall boundary condition is prescribed for the fluid on the boundary parts such as the surfaces of the model and the top bottom and lateral surface of the cylindrical computational domain hybrid grids are applied to discrete the computational domain unstructured tetrahedron mesh is used in dynamic mesh zone while structured hexahedron mesh is formed in the outer zone interface is applied in the overlapping surface of those two zones for data transmission the grid system is shown in fig 4c in order to capture the boundary layer development the y criterion is used with values between 30 and 300 sas ip 2010 pan and kinnas 2011 the first mesh height around the model is 4 mm 6dof solver in fluent and the new proposed simulation model are adopted to simulate the free floating motion of this cylindrical structure these two simulation models solve different motion equations as shown in eq 12 and eq 16 respectively added mass of the object is required in eq 16 so in the new proposed simulation model one more step is needed to obtain added mass of the cylindrical structure the computational domain and the shape of object keep unchanged during its free floating motion so added mass can be treated as constant value udf is adopted to customize the moving boundary condition of the cylindrical structure the uniform acceleration in z direction is selected as 1 m s2 time step δt 0 001s is chosen cell courant number is less than 1 which represents that the stability and convergence of simulation is satisfactory fig 5 shows the time variation of hydrodynamic force the calculated added mass of the cylindrical structure is m a t f a t v z 54 33 k g then this added mass value is adopted to simulate the free floating motion of object by the new proposed simulation model fig 6 compares the displacement of the finite cylinder calculated by 6dof solver and new proposed simulation model it can be seen that the results fit well with each other 3 2 free falling motion numerical model is also validated by comparing the computational acceleration of the free falling sphere with experimental data from fackrell 2011 the diameter of the sphere in the experiment is d 0 0254 m its mass is equals to 0 01912 kg the density of fluid is 998 200 kg m3 in the numerical calculation the computational domain is x y z 0 30 m 0 30 m 0 38 m the sphere is suspended at 4 5 diameters below the top of the domain computational domain is discretized with hybrid grids 3d unstructured mesh is applied around the sphere in the dynamic zone while structural grid is formed outside the dynamic zone the first mesh height around the sphere is 1 mm which satisfies the y criterion the description of the computational domain and grid system around the sphere is shown in fig 7 fig 7a also presents the boundary conditions the no slip wall boundary condition is applied for the surface of sphere the bottom and four lateral walls sphere is positioned at an enough depth so the effects of free surface can be neglected it is also reasonable to set the top of the domain as the no slip wall boundary condition the overlapping surface of dynamic mesh zone and the outer zone is set as interface boundary condition for data transmission the analytical derived added mass of a sphere based on potential flow formulation is equivalent to the half mass of the displaced fluid sarpkaya and isaacson 1981 this added mass is adopted in udf to solve eq 16 fig 8 shows the acceleration in z axis with respect to the non dimensional displacement z d where d is the diameter of the sphere the acceleration decreases during free fall the acceleration from experimental data between z d 0 2 to z d 0 6 decreases at a near linear trend and then drops nonlinearly the same trend can be seen from the results of the numerical calculation it can also be seen that the numerical results match well with the experimental data especially after z d 0 6 4 scope of the new proposed simulation model the validation case of free floating motion in section 3 1 indicates that this new proposed simulation model is apt for the motion problems that 6dof solver can solve in this section a series of cases are investigated in order to indicate the scope of this new proposed simulation model especially some cases that 6dof solver can not simulate 4 1 rigid body in different computational domains internal flow problem of an incompressible fluid is common in nature and ocean engineering application such as capsule in the digestive tract sub launched projectile independent escape capsule inside disabled submarine rather than the flow in the open field the hydrodynamic behavior of object in three different finite domains is studied here two dimensional calculation is carried out in order to save the needed computing resources as well as time the profile of object refers to section b b in fig 4a density of object remains 930 950 kg m3 computational domain is shown in fig 9 a three domains with different breadths are adopted which are b 5 000 mm b 1 000 mm and b 600 mm respectively the boundary of computational domain is set as no slip wall boundary condition fig 9b shows the grid system around one end cap of object hybrid mesh is applied in computational domain with b 5 000 mm and interface is set in the overlapping surfaces between unstructured triangular and structured quadrilateral mesh unstructured mesh is applied to discrete computational domains with b equal to 600 mm and 1 000 mm the first mesh height around object is 4 mm added mass of object in three different computational domains is calculated by define the uniform acceleration in y direction as 1 m s2 time step δt 0 001s is chosen in the simulation fig 10 gives the time variation of hydrodynamic force the calculated added mass of object in different computational domains is listed in table 2 added mass of object soars with the decrease of breadth fig 11 shows velocity contour in three different domains at t 0 01s when the velocity of object is 0 01 m s it can be seen from fig 11a that fluid flows through object in domain with b 5 000 mm and gradually spreads around the enlarged image around top cap of the object shows that only fluids very close to the surface of object is dragged however fig 11b and c shows that side walls of computational domain block the spread of flow toward its left and right direction which makes that the object should push more adjacent fluid to move along the maximum velocity of fluid around object inside the domain with b 600 mm even reaches 0 055 m s which is nearly 5 5 times the speed of object this is the reason for the increase of added mass of object in narrow spaces then the hydrodynamic behavior of object in these three different domains is studied by 6dof solver in fluent and the new proposed simulation model added mass obtained is substituted into eq 16 in the new proposed simulation model figs 12 14 reflect motion characteristic curves of object inside the domains with three different breadths b 5 000 mm b 1 000 mm and b 600 mm respectively they are double x axis and double y axis curves in which red curves match axis in red color and black curves match axis in black color red curves are the results by 6dof solver while black curves show the results by the new proposed simulation model fig 12a shows that in the computational domain with b 5 000 mm acceleration decrease gradually with time and some numerical oscillations occur after t 1s fig 12b reflects that the spatial displacement of object increases nonlinearly and it takes less than 4 seconds for object moving the distance of 2 5 m that is the length of object it can be seen that motion curves obtained by the new simulation model fit well with that by 6dof solver in a comparatively open domain fig 13 shows that the motion curves of object in a domain with b 1 000 mm in which the added mass of object is slightly larger than the mass of object the acceleration in fig 13a obtained by 6dof solver changes between positive and negative numbers and eventually diverges in less than 70 iterative computations this means that hydrodynamic force drives object to move in one iteration and hinders the motion of object in next iteration fig 13b also shows that the spatial displacement by 6dof solver oscillates between positive and negative values all these results can not reflect correctly the hydrodynamic behavior of the free floating object however the acceleration of object obtained by the new simulation model decreases gradually from about 0 32 m s2 at t 0s to 0 08 m s2 at t 5s and object moves 2 5 m in about 4 8 seconds the acceleration in the domain with b 1 000 mm is smaller than that of object in the domain with b 5 000 mm and it takes more time about 1 s for object to move about 2 5 m this physical phenomenon is correct and easily understandable fig 14 displays the results of object inside the domain with its breadth keeping decreasing into 600 mm it can be seen from table 2 that the added mass of object in this situation is over 5 times as big as the mass of object the acceleration curve calculated by 6dof solver in fig 14a reaches 60 000 m s2 within 7 iterations which indicates that the results diverge rapidly the spatial displacement curves by 6dof solver in fig 14b also shows that object moves upward and downward alternatively which is contrary to the physical facts however the new simulation model can obtain the corresponding motion curves of object in domain with b 600 mm the acceleration decreases from 0 1 m s2 at t 0s to nearly 0 m s2 at t 7s and from then on the acceleration fluctuates around 0 m s2 it means force on object is balanced object moves in a constant velocity eventually which can also be seen from fig 14b that the spatial displace curve obtained by the new simulation model increases linearly after t 7s it takes 10 seconds for object to move about 2 5 m it is clear that the breadth of the computational domain affects the simulation of hydrodynamic behavior of object if the breadth of domain is 5 000 mm both 6dof solver and the new model can accurately calculate the motion of the object inside this domain when the breadth decreases to 1 000 mm or less the results of 6dof solver diverges while the new simulation model can cope with these cases in which the added mass effect is severe the blockage effect of side walls hinders the spread of fluid and then added mass of object increases obviously the increasing added mass affects the hydrodynamic behavior of object it leads to the decrease of acceleration and meanwhile prolongs the time to move the same distance 4 2 rigid body with different density the logic of the research in section 4 1 and the researches to be commenced in this section is shown in fig 15 it is hard to draw a conclusion directly from the study in section 4 1 that added mass effect leads the divergent computation of 6dof solver in order to confound the sceptic that it is the size of computational domain directly affecting the application of 6dof solver rather than the added mass effect the influence factor size of domain is eliminated by studying objects with different densities inside the same domain in this section another two densities ρ o 317 792 kg m3 and ρ o 280 000 kg m3 are chosen for the research the domain is also shown in fig 9a and the breadth is set as b 5 000 mm the boundary conditions and grid system are the same as described in section 4 it is no doubt that the added masses of these two objects are the same due to the same shape of object same domain and fluid table 3 compares related parameters of these two cases figs 16 and 17 show the motion characteristic curves of these two objects calculated by 6dof solver and the new simulation model respectively for the object ρ o 317 792 kg m3 it can be seen from fig 16a that the acceleration obtained by 6dof solver oscillates severely between positive and negative value from t 0s to t 0 15s and then converges while the results by the new simulation converges at the first beginning which can better describe the hydrodynamic behavior of the free floating object the spatial displacement by 6dof solver and the new model fits well with each other fig 17a and b represent acceleration and spatial displacement of object with ρ o 280 000 kg m3 the same phenomenon occurs as fig 13 in which the results by 6dof solver deviate from the physical commonsense knowledge the simulation results diverge in about 90 iterations however the acceleration obtained by the new simulation model decreases from about 12 m s2 at t 0s to 3 m s2 around t 0 8s it takes 0 8 seconds to move 2 5 m from the studies in section 4 1 and 4 2 a conclusion can be drawn that when added mass surplus the mass of object the traditional 6dof solver fails the new proposed simulation model can calculate the motion of object when its added mass effect is strong 5 hydrodynamic behavior in the changing domain the sub launched projectile from launch canister and the ejection of independent escape capsule from the disable submarine are typical hydrodynamic behaviors from one narrow space into an open field which would show totally different kinetic characteristic from the motion in a narrow space fig 18 gives a description of this problem the object has the same profile as section b b in fig 4a the computational domain has two different breadths b1 600 and b2 5 000 mm which represents narrow space and open field respectively the free floating motion of object in this computational domain is studied and the motion characteristic curves are compared with the motion of object in computational domain with b 600 mm from section 4 1 density of object remains 930 950 kg m3 the boundary conditions are shown in fig 18a fig 18b displays the hybrid grid system around two end caps of object the first mesh height is 4 mm which satisfies the requirement of y criterion interface is set in the overlapping surfaces between unstructured and structured mesh firstly the motion of object in the changing domain leads to various shapes of the flow field which is illustrated in fig 19 object is at four different positions y0 0 mm y0 200 mm y0 2 400 mm and y0 2 600 mm different from the situation that object moves in computational domain b 600 mm the added mass of object in the changing computational domain b1 600 mm and b2 5 000 mm alters with flow field variation udf is adopted to define the moving boundary condition of the cylindrical structure ay 1 m s2 dynamic mesh method is applied to update the mesh time step δt 0 001s is chosen for the calculation it can be seen from the velocity contour in fig 19 that fluid around the top cap of object spreads around without the blockage effect of side walls fluid that flows along with object reduces when the object gradually departs the narrow space at four different positions y0 0 mm y0 200 mm y0 2 400 mm and y0 2 600 mm fig 20 gives corresponding hydrodynamic force curves of object at those four different positions the hydrodynamic force decreases with the increase of y0 table 4 lists added mass of object at different positions and the corresponding numerical results are shown in fig 21 with the symbols of red delta before the calculation of hydrodynamic behavior by the new simulation model added mass of object at all the various positions is needed but numerical simulation at all those positions is a heavy work in this paper fitting method is used in forming the added mass curve of object the linear fitting is adopted through observing the distribution of the numerical results and the fitting formula is 17 m a y 0 6 123 100 776 800 y 0 0 y 0 0 2 6 443 407 2 378 335 y 0 0 2 y 0 2 4 3 644 586 1 212 160 y 0 2 4 y 0 2 686 388 660 2 686 y 0 then this formula is adopted to simulate the hydrodynamic motion of object fig 22 compares the motion characteristics of object in the changing domain b1 600 mm and b2 5 000 mm with those in the domain b 600 mm the accelerations of those two cases are the same at the first beginning of motion then they both fall from about 0 1 m s2 at t 0s to 0 m s2 at t 7s but the descending rate of object in the domain b 600 mm is slightly lower than that of object in the changing domain after t 7s object in the domain b 600 mm moves in a constant speed with acceleration staying at 0 m s2 while the acceleration of object in the changing domain increases slowly to about 0 01 m s2 at t 9s then a sudden drop is seen in the acceleration from 0 01 m s2 at t 9s to 0 166 m s2 at t 9 6s which followed by a sharp increase to 0 4 m s2 at t 10s from then on the acceleration decreases again it can be seen from fig 22b that the spatial displacement of object in the domain b 600 mm is larger than that of object in the changing domain from t 0s to t 9 2s and from then on the displacement of object in the changing domain increases at a bigger rate at t 10 5s its displacement reaches 2 8 m while the displacement of object in the domain b 600 mm is 2 5 m the various motion characteristics of object are the results of force on the object the flow field around object at three different typical moments t 2s t 9 5s and t 10 5s is introduced for the illustration figs 23 25 show the velocity contours and velocity vectors around object in two different domains at t 2s t 9 5s and t 10 5s respectively at t 2s the top cap of object departs from the narrow domain b1 600 mm and goes into the open domain b2 5 000 mm as shown in fig 23a the velocity contour and vector around object are almost the same as those in fig 23b except that the fluid around top cap of object spreads around without the confine of side walls it is generally recognized that this phenomenon will leads to the decrease of hydrodynamic force compared to the fluid around the top cap of object in the domain b 600 mm as shown in fig 23b but looking carefully at the detail of velocity vector around the top cap there is some flow swarming into the narrow domain from the open domain and the velocity reaches 1 07 m s which is bigger than the maximum velocity in fig 23b this is the main reason that leads to the increase of hydrodynamic force on object in the changing domain so the acceleration of object in the changing domain is lower than that of object at t 2s which is in consistency with the results in fig 22a at t 9 5s the major part of object leaves the narrow domain b1 600 mm the flow around the major part of object spreads around in the open domain without swarming into the narrow domain as shown in the top cap of object from fig 24a there is no doubt that the added mass force of object is much smaller than that of object in the domain with b 600 mm but the flow around the end cap of object saw the presence of obvious eddy this phenomenon of severe separation flow would lead to the soar of unsteady resistance compared to the flow around end cap of object in the domain b 600 mm as depicted in fig 24b at t 10 5s fig 25a shows that object departs from the narrow domain the maximum velocity of flow decreases to 0 928 m s which means that the pressure on object reduces the fluid around object spreads around in the open domain which also leads to the decrease of added mass force although the wake in the narrow domain b1 600 mm is rather complex with obvious eddy it is far from object the impact on object is limited so the hydrodynamic force on object is small and the acceleration reaches 0 4 m s2 as shown in fig 22a this value is in the range of 0 2 m s2 and 0 5 m s2 as show in fig 12a the results in fig 12a is the simulation of object in the domain with b 5 000 mm so it indicates that the acceleration of object in the changing domain at t 10 5s is reasonable the velocity contour and velocity vector of object in fig 25b are similar as those of object in fig 24b which means the fluid around object is stable this phenomenon is consistence with the acceleration curve shown in fig 22a the acceleration of object in domain with b 600 mm reduces to 0 m s2 after t 7s 6 conclusion the sub launched projectile from launch canister and the ejection of independent escape capsule from the disable submarine are examples of hydrodynamic motion in narrow spaces which is commonly encountered in ocean engineering industry in the present paper a new simulation model is proposed to solve this kind of fluid structure interaction problem in which added mass effect is strong the new simulation model is validated by two case studies one case is free floating of a three dimensional finite cylinder with two hemi ellipsoidal end caps in open domain which is simulated by 6odf solver and the new model the spatial displacement curves obtained fit well with each other the other case is the free falling of sphere with diameter equals to 0 0254 m in still water the results by the new model agree well with the experimental data then the free floating motion of rigid body in the domain with three different breadths b 5 000 mm b 1 000 mm and b 600 mm and rigid body with different densities ρ o 317 792 kg m3 and ρ o 280 000 kg m3 are studied by 6dof solver in fluent and the new simulation model it is found that the new simulation model is especially apt for this kind of hydrodynamic motion problem in which added mass of rigid body is larger than its mass while the simulation results of this kind of problem by 6dof solver are divergent and seriously not consist with the physical facts finally the new simulation model is applied to calculate the hydrodynamic motion of rigid body in the changing domain b1 600 mm and b2 5 000 mm acceleration and spatial displacement curves of rigid body are obtained its motion characteristics in the changing domain are introduced through comparative analyses with the results of the same rigid body in the narrow domain b 600 mm it is found that acceleration of object in the changing domain is lower than that of object in the narrow domain at the first beginning of motion and a sudden drop and sharp increase of acceleration are seen when object departs from the narrow domain b1 600 mm into the open domain b2 5 000 mm the reason is discussed by analyzing details of flow in those two cases acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 
22811,to avoid collision accidents and achieve independent recovery in the cluttered marine environment this work proposes an intelligent path planning system for a waterjet propelled unmanned surface vehicle usv unlike the existing works on usv navigation systems our study focuses on the real time smoothness and seaworthiness properties of the path in practical clutter environments a hybrid a algorithm with motion primitive constraints is proposed to generate an initial reference path according to different types of dynamic obstacles the international regulations for preventing collisions at sea colregs rules are used and a local threat map based on the apollonius circle is constructed to avoid these obstacles together with the motion characteristics of the waterjet propelled usv the reeds shepp curve is used to calculate the autonomous recovery path the performance of the proposed intelligent navigation system is verified in a practical marine environment the experimental results show that our hybrid a algorithm outperforms the conventional a algorithm and it is easy for the waterjet propelled usv to follow the final continuous curvature path it was demonstrated that our method can effectively avoid various static and dynamic obstacles in real time and thus help achieve autonomous recovery keywords unmanned surface vehicle waterjet propulsion path planning apollonius circle automatic recovery reeds shepp curve 1 introduction unmanned surface vehicles usvs have been widely used to meet the requirements of marine exploration and military defence the waterjet propelled usv is a type of usv that is propelled by two waterjets during navigation due to its low cost high manoeuvrability and rapid response capability the waterjet propelled usv has attracted broad interest in the naval civil and scientific fields ellenrieder 2013 to cope with dynamic scenarios that may occur owing to the deployment of different payloads modifications to mission requirements and environmental variations a robust navigation guidance and control ngc system motwani et al 2013 is required for the waterjet propelled usv a substantial amount of research has been reported on approaches for improving the reliability and accuracy of the ngc system tam and bucknall 2013 mousazadeh et al 2018 however the methods for the integration of artificial intelligence with the ngc system have not been explored for the current state of the art usvs it will be beneficial to improve the level of intelligence to achieve autonomous avoidance of various types of obstacles moreover when the waterjet propelled usv completes its mission autonomous recovery is primary importance to ensure the safe return of the usv to the recovery platform both in the process of autonomous obstacle avoidance and in the independent recovery stage the use of an intelligent path planning method is indispensable additionally because the waterjet propelled usv is highly manoeuvrable and can travel both forward and backward it requires a sufficiently effective path planning system for its safe operation at high speeds these considerations motivate the demand for the development of dedicated path planning methods for the waterjet propelled usv particularly in the autonomous recovery stage 1 1 literature review in general the path planning methods can be divided into global and local approaches that are also called static offline and dynamic online path planning methods respectively global path planning methods are used mainly to avoid previously known obstacles such as islands reefs and forbidden areas that are often fixed in the electronic charts classical global methods include the dijkstra algorithm singh et al 2017a a algorithm casalino et al 2009 potential field method virtual force field method romero ramirez and plumet 2012 xie et al 2014 singh et al 2017b fast marching method liu and bucknall 2015 predictive rapidly exploring random trees method zhuang et al 2015 voronoi diagram method wu et al 2013 genetic algorithm ant colony algorithm wu et al 2012 and particle swarm optimization pso algorithm zhou et al 2017 local path planning methods are mainly used to avoid real time obstacles during navigation including moving ships giant floating objects without fixed motion trajectories and others objects that can be automatically identified by radar sensors sonar devices and cameras tang et al 2015 local path planning methods include the dynamic window approach fox et al 1997 d algorithm vanden berg et al 2006 modified virtual force field method lee et al 2004 and the velocity obstacle method kim and oh 2016 in addition many local path planning algorithms were improved based on the global path planning algorithms for instance candeloro presented a dynamic path planning method for 3 dof marine surface vessels based on the voronoi diagram roadmap candeloro et al 2017 ma et al ma et al 2018 formulated the path planning problem as a multiobjective nonlinear optimization problem with generous constraints and proposed the dynamic augmented multiobjective pso algorithm to obtain the solution a global path optimization method using genetic algorithm was proposed in kim et al 2017 considering environmental loads obstacle avoidance and the minimization of the travel time liu et al liu and bucknall 2016 adopted the angle guidance fast marching square method to accommodate the motion constraints of the usv ensuring safety by delineating the ship domain area and the collision avoidance area when entering dangerous areas perera et al 2015 proposed an intelligent guidance based collision avoidance system and obtained experimental results for a scaled ship model woerner et al 2018 generalized the traditional velocity obstacle into a multithreshold approach that more realistically represents and evaluates human ship driving practices naeem et al 2012 applied the a algorithm to calculate a trajectory combined with international regulations for preventing collisions at sea colregs collision avoidance but only based upon the distance cost then singh et al 2018 explored an a approach for the springer usv in a practical scenario with obstacles and ocean currents that is effective for the global path planning of usvs also using the springer usv as the prototype model song et al 2019 developed a smoothed a path planning algorithm to reduce unnecessary jags eliminate redundant waypoints and offer a smoother route practical marine environments are cluttered with various static and dynamic obstacles and that can strongly impact the path planning of a waterjet propelled usv static obstacles include coastlines reefs islands breakwaters fish culture zones and other anthropogenic infrastructures dynamic obstacles include moving ships the giant floating objects without fixed motion trajectories and others objects that can be automatically identified by radar sonar and cameras unfortunately we found that not all of the types of dynamic obstacles have been considered in previous studies most studies with usv path planning assume that dynamic obstacles are equate with moving ships and ignore some of the more dangerous obstacles based on different maps that were adopted in these studies the path planning environment models can be divided into two categories grid based maps and graph based maps the grid based algorithm makes a trade off between the calculation time and the rasterized resolution of the grid map i e the higher the rasterized resolution is the longer the computational time required song et al 2019 the graph based algorithm is often used to generate a piecewise linear path the path can easily make sharp turns within a short distance presenting difficulties for piloting control some methods that improve the path smoothness and avoid sharp turns may sacrifice the requirement for low computational memory at each iteration preventing its real time performance from meeting the requirements of dynamic planning meanwhile a review of the literature of usv path planning methods shows that very few of the studies consider path planning in the autonomous recovery stage therefore an intelligent collision avoidance and recovery path planning approach in practical cluttered environments is an important subject of research for the waterjet propelled usvs 1 2 major contributions to the best of our knowledge the use of simpler constraints in path planning leads to greater limitations in the functions that can be achieved during marine navigation the intelligent path planning system examined in this paper focuses on the following constraints the temporal constraints of the real time path planning the thrust limit and motion constraints of the waterjet propelled usv the uncertainty in the movement direction of some dynamic obstacles and the smoothness of the final recovery path this paper extends the work of reference shi et al 2019 through the following contributions a unlike the conventional methods carried out on a binary grid map an intelligent path planning method based on a graphical map is proposed that is capable of node optimization and is curvature continuous b during the process of dynamic path planning in addition to moving ships other types of dynamic obstacles without a fixed movement direction are considered such as ghost ships unknown large floating objects for these obstacles a local threat model based on the apollonius circle was developed to construct the local threat map around the obstacles c since the waterjet propelled usv can move forward and backward at a constant velocity with a bound on its minimum turning radius the reeds shepp curve was used to optimize the final recovery path and save time and energy overall the purpose of this paper is to intelligently and automatically determine an optimal path for the waterjet propelled usv in cluttered environments the intelligent collision avoidance and recovery path planning system is implemented in a modular manner the rest of this paper is organized as follows section 2 explains the problem formulation for the intelligent path planning system of the waterjet propelled usv the details of the initial path generation module the path optimization module and the autonomous recovery module are described in sections 3 4 and 5 respectively the simulation and experimental results for intelligent collision avoidance and recovery path planning are presented in section 6 section 7 presents the conclusions and describes future work 2 problem formulation 2 1 overview of waterjet propelled usv waterjet propulsion is a common propulsion method for usvs two waterjet nozzles are attached behind the usv hull the basic principle of the waterjet propelled usv is to rely on the reaction force generated by the two waterjet nozzles to obtain forward thrust carlton and carlton 2019 this method is particularly suitable for high speed vessels its difference from the conventional usv is that the thrust direction of the waterjet propelled usv is unfixed klinger et al 2017 due to the structural stability of the waterjet propelled usv hull the motion of the usv is simplified from the current six degrees of freedom to three degrees of freedom specifically the roll pitch and heave motions are ignored while retaining the surge sway and yaw motions these retained motions can be simplified into motions in the inertial plane fig 1 shows a simplified model of the waterjet propelled usv where w d and l e represent the width and length of the hull respectively the waterjet propelled usv uses the left waterjet and right waterjet to provide thrust force f l and f r respectively when moving either forward or backward or when performing turns the kinematics model of usv in the xoy planar motion is represented as follows 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r where x y r 2 are the inertial position coordinates and the ground speed u u 2 v 2 u and v are the velocities in the surge and sway respectively ψ 0 2 π and r are the orientation angle and yaw rate measured counterclockwise from the x axis the dynamics of usv in 3 dof are described by 2 m ν c ν ν d ν ν τ where ν u v r t is a velocity vector composed of surge sway and yaw m c ν and d ν are mass matrix coriolis and damping matrix respectively τ τ u 0 τ r t is a vector forces and moments generated by the two waterjets and τ u and τ r are represented as 3 τ u f r f l τ r f r f l b 2 the specific conditions and parameters used in this paper are shown in table 1 2 2 framework of the intelligent path planning system in this work an intelligent path planning system is proposed for the waterjet propelled usv s navigation in cluttered environments the system contains three modules the initial path generation module dynamic path optimization module and autonomous recovery module the specific details consist of the following main phases as shown in fig 2 the start and end ports are determined based on the needs of the mission and the global area of the voyage is delimited at the same time an environment map of the voyage area containing static obstacles is loaded then an initial static path is generated using the obstacles modeling method shi et al 2019 and hybrid a algorithm for static obstacles with the guidance of the initial static path some sub task waypoints can be obtained when navigation is performed with the sub task waypoint as the target waypoint the distribution of the obstacles in the local area can be detected based on the real time position provided by onboard sensors next it is determined whether dynamic obstacles are present nearby if there is no dynamic obstacle the usv continues navigating to the target waypoint if an obstacle is present it is evaluated whether the movement direction of the obstacle is predictable if its direction can be predicted colregs rules are adopted to avoid the obstacle otherwise the apollonius circle will be used to designate the threat area of the obstacle that will be evaded then the target waypoint is regenerated and the usv continues to moves forward when the waterjet propelled usv enters the recovery preparation area the reeds shepp curve is calculated according to the current state of the usv obtained by the hull sensors and the target state of the usv required by the recovery platform a collision free shortest curve is selected as the recovery path output from these curves 3 initial path generation module 3 1 environment map the initial path generation module is used to find an optimal or nearly optimal collision free path in a known static obstacle environment and this path provides guidance for the subsequent research the environment map and hybrid a algorithm are the two main components of the initial path planning module the establishment of the environment map is the critical foundation that is directly related to the accuracy of the path optimization algorithm according to the relevant standards performance standard for imo 1995 of the international maritime organization imo common navigation chart information includes electronic charts paper charts and satellite images this paper uses satellite images to build the environment map and adopts the maklink theory to map the proposed obstacle model as a searchable graph also called the maklink graph wang and wang 2014 the maklink graph g v e is an undirected graph by spatial decomposition the environment information the obstacles with complex edge information can be treated as planar polygons and a series of nodes v v 1 v 2 v 3 without obstacles can be obtained the lines e connect all of geometrically alongside nodes without passing through any obstacles in the subsequent process that uses the hybrid a algorithm to find the optimal path the waterjet propelled usv only needs to cross these lines to move away from the obstacles in other words all the waypoints of the optimal path are above these lines 3 2 hybrid a algorithm in the static environment map g v e the conventional a algorithm in the heuristic search algorithm is relatively common the actual performance constraints of the waterjet propelled usv and the shortcoming of discreteness of the conventional a algorithm which causes its planned path not to be directly tracked must be considered therefore the hybrid a algorithm is used as the initial global path search technique in the hybrid a algorithm a cost function f n is used to evaluate the cost of moving from the current position n to the adjacent position n and is given by the following 4 f n g n h n in the above formula g n represents the exact cost of the path from the starting position to n the heuristic estimated cost from n to the target position is denoted as h n which is expressed in euclidean distance similar to the conventional a algorithm the hybrid a algorithm also utilizes two sets that keep track of the states during the search the o p e n s e t contains the already expended neighbouring nodes during the search process and the c l o s e s e t contains all nodes that have been conclusively processed to overcome the shortcomings of the conventional a algorithm a set of precomputed motion primitives μ θ δ r d is used to determine the reachable states the cell of the valid motion primitives μ contains the current node s heading angle θ the change in heading angle δ the radius of rotation r and the waterjet propelled usv s forward backward mode d d 0 1 it is a binary value that represents the usv s movement direction where 0 means backward and 1 means forward the pseudocode of the hybrid a algorithm is shown in algorithm 1 algorithm 1 hybrid a algorithm for the initial path generation in the process of searching for navigable waypoints the hybrid a algorithm is different from the 4 or 8 connected node expansion method adopted by the conventional a algorithm the hybrid a algorithm adopts a node extension method with motion primitive construction it is possible that the theoretically optimal node is not actually reachable which indirectly leads to a result in which the path obtained by the hybrid a algorithm is not guaranteed to be globally optimal fortunately the hybrid a algorithm can obtain a sub optimal path that can be further adjusted and optimized during the subsequent dynamic path optimization process 4 path optimization module 4 1 dynamic threat according to the initial path after reaching a waypoint the waterjet propelled usv continues to sail to the next waypoint when a dynamic threat is encountered during the voyage the navigation path must be adjusted locally dynamic threats mainly refer to traffic vessels giant floating objects ghost ships and so on based on the speed of the moving threats different methods are used to avoid them suppose that v o b s and v u s v represent the maximum speed of the dynamic threats and waterjet propelled usv respectively let λ v o b s v u s v then 1 λ 1 the speed of the dynamic threat is higher than that of the usv 2 λ 1 the speed of the dynamic threat is equal to that of the usv 3 λ 1 the speed of the dynamic threat is slower than that of the usv for the cases of λ 1 and λ 1 these types of dynamic threats usually refer to vessels moving at high speed that are equipped with advanced radar systems ais and conning workstations as long as these vessels can follow the relevant rules they can achieve successful collision avoidance for λ 1 there is significant uncertainty in the motion of specific threats such as giant floating objects and ghost ships they may not move at high speed but they cannot obey the rules of navigation and can even randomly change their direction of motion therefore these dynamic threats are also dangerous and the related research in dynamic path optimization is necessary 4 2 colregs rules when the usv is sailing at sea it maintains a sufficient safety distance from other ships according to its manoeuvrability sea conditions and sea visibility to avoid the risk of collision imo stipulates that vessels should strictly abide by the colregs rules as permitted by their safety status rules 13 14 and 15 in colregs define 3 situations overtaking head on and crossing the different manoeuvring requirements corresponding to different encounter situations are shown in fig 3 for overtaking the velocity of the traffic vessel is slower and the waterjet propelled usv seeks to surpass this velocity the usv must ensure that there is sufficient safe clearance so that it keeps out of the way of the traffic vessel being overtaken although rule 13 of colregs does not specify which side of the traffic vessel is to be overtaken the common practice at sea is that the overtaking vessel usv should pass on the right side of the traffic vessel fig 3 b shows a usv and a traffic vessel are moving straight towards each other head on both vessels must alter their course towards starboard so that they pass the other vessel to its port side as shown in fig 3 c the traffic vessel is crossing from the right side of the usv the usv has the traffic vessel on its starboard side therefore the usv must yield to the traffic vessel and the traffic vessel does not need to alter its path otherwise the traffic vessel crosses from the left of the usv as shown in fig 3 d the traffic vessel is the yielding vessel and the usv can stay on its course 4 3 local threat map based on apollonius circle for dynamic threats that do not move rapidly but can randomly change their direction of motion and do not actively obey colregs the apollonius circle is used to construct the local threat map around them as shown in fig 4 p and b indicate the positions of usv and a dynamic threat respectively and m is any point in the xoy plane if λ 1 the trajectory of m can form an apollonius circle each point on the circle can be understood as a set of points that can be reached simultaneously if the current speeds of the two sides are unchanged the positions of the usv and the threat obstacle are x p y p and x b y b respectively using the knowledge of planar geometry the centre of the apollonius circle is calculated as o x p λ 2 x b 1 λ 2 y p λ 2 y b 1 λ 2 and the radius is as follows 5 r λ x p x b 2 y p y b 2 1 λ 2 it can be seen from equation 5 that the radius of the corresponding local threat area decreases with decreasing λ according to the characteristics of the apollonius circle the collision between the usv and an obstacle occurs on the boundary of the circle or inside the circle therefore the area covered by the apollonius circle is defined as the local threat map of the dynamic obstacle and it should be evaded for the dynamic path planning of the usv the specific process of dynamically adjusting waypoints is shown in fig 5 when the usv sails according to the planned path p i 1 p i p i 1 if it detects that obstacle b enters its warning area at waypoint p i then it will establish a local threat map based on the apollonius circle and find the tangent point p i of the circle p i is the intermediate buffer waypoint and the adjusted path waypoints are p i 1 p i p i p i 1 the construction of a local threat map through the apollonius circle is equivalent to turning uncertain dynamic obstacles into static obstacles which greatly reduces the computational complexity of the path planning 4 4 dynamic path optimization algorithm usv continuously detects potential threats in the surrounding environment during the navigation process once a suddenly dynamic threat is detected the path optimization module is immediately entered into the solution to solve for the collision avoidance strategy at the same time the priority of the usv is to ensure the safety of the hull and it is particularly critical to solve the collision avoidance path quickly as the usv approaches the target the surrounding dynamic environment information is continuously updated and the optimal local path is not unique at different times different from the offline planning of the initial path generation module the dynamic path optimization module involves real time planning a simpler and more reliable dynamic path optimization strategy decreases the solution time and more time is left for the usv to actually manoeuvre which is beneficial for its security protection the basic steps of the dynamic path optimization algorithm are given below step 1 the usv sails along the initial static path waypoints and determines whether the current point is the task endpoint if so the dynamic path optimization process ends if not the surrounding environment information is detected continuously it is assumed that a dynamic obstacle is detected at time t by the ship borne radar and its motion state is predicted and analysed step 2 evaluate the speed of the dynamic obstacle movement if the current dynamic obstacle speed is not lower than that of the usv or if the trajectory is normal this means that the obstacle can abide by the navigation rules and the algorithm then proceeds to step 3 if the dynamic obstacle moves slowly and the direction of motion changes randomly it means that the obstacle s motion state is uncontrollable and the algorithm then proceeds to step 4 step 3 determine the type of the encounter situation between the usv and the dynamic obstacles according to table 2 then return to step 1 after completing the corresponding manipulation step 4 construct a local threat map around the dynamic obstacle based on the apollonius circle and evaluate whether the continued navigation will pass through the threat area if so find the circular tangent point the one with the smaller current heading angle as the intermediate buffer waypoint after passing the waypoint go back to step 1 if not return to step 1 directly 5 autonomous recovery module 5 1 recovery path after the waterjet propelled usv completes its mission the autonomous recovery module can help it to safely return to port or a specific recovery platform the recovered waterjet propelled usv can replenish its energy redistribute its tasks etc to effectively improve its endurance and increase the diversity of its tasks when the usv enters the recovery preparation area the recovery module is automatically started and the recovery path is calculated according to its current state and target state the specific recovery process of the waterjet propelled usv is shown in fig 6 the shortest recovery path between the current state and target state cannot always be a straight line due to the disturbance of the environment and the constraint of the initial heading angle as shown in fig 7 a if only the kinetics and obstacle constraints of the usv are considered the classical dubins curve dubins 1957 can meet the requirements the dubins curve uses arcs and line segments and connects them to generate a curve that meets both the current and target state constraints and the heading attitude constraints however the dubins curve only considers the situation in which usv is moving forward in fact the waterjet propelled usv can move both forward and backward fig 7 b shows the trajectory considering the backward case it can also be seen that the path obtained by the reeds shepp curve reeds 1990 is shorter than that obtained by the dubins curve furthermore if a collision free path between any current and target states exists there must exist a collision free reeds shepp curve but the dubins curve does not necessarily exist barraquand and latombe 1993 therefore the present work uses the reeds shepp curve as the recovery path planning method of the waterjet propelled usv 5 2 reeds shepp curves according to the motion model 3 any planned waypoint p i is given by a triple x i y i ψ i where x i y i denote the coordinates of the waypoint and ψ i represents the heading angle of the usv assume that the waterjet propelled usv moves with a planar environment r 2 the trajectory γ is a mapping to the configuration space r 2 s 1 and its specific description is given by the following 6 γ t u 1 t x 1 γ t u 2 t x 2 γ t where u 1 u 2 1 1 are two controls representing the speed and course of the waterjet propelled usv x 1 x 2 are real analytic vector fields with the coordinate representations 7 x 1 x y ψ c o s ψ s i n ψ 0 and 8 x 2 x y ψ 0 0 1 during the description 6 given any two adjacent waypoints p i x i y i ψ i p i 1 x i 1 y i 1 ψ i 1 the trajectory γ is feasible if γ 0 p i γ t p i 1 and it can be tracked by the waterjet propelled usv it was shown in reference sussmann 1993 that there are no more than 46 different patterns that describe the shortest curves this means that these patterns can occur for the shortest path and they are called the reeds shepp curves these reeds shepp curves can be categorized into 9 classes and all of the classes and patterns are listed in table 3 where c stands for a circular arc and s stands for a line segment the symbol is used to indicate that the waterjet is shifted from forward to reverse or reverse to forward assume that l r and s denote left turns right turns and motion on a straight line respectively where the signs correspond to forward motion and the signs correspond to backward motion 5 3 recovery path based on reeds shepp curves it can be seen from the previous study that many reeds shepp curves between two waypoints may exist the shortest curve is selected as the optimal recovery path the optimal recovery path must be a collision free path that satisfies the waterjet propelled usv kinetic performance constraints this path may consist of several straight and circular segments unlike trajectory tracking path planning only ensure that the usv can move on the relevant path without requiring the time to reach the target waypoint therefore this paper uses the reeds shepp curves to plan the recovery path the change in the usv direction is followed by the changing direction of the target path the recovery path planning algorithm based on the reeds shepp curves is a simple and effective method for guiding the usv back to the recovery platform by calculating the control instruction of each point according to the reeds shepp curves and then executing the control commands by the underlying controller the usv will be guided to the recovery platform step by step we take the r s l r path as an example to introduce the recovery path planning algorithm as observed from fig 8 there are four states on the path s t a t e 1 represents right turns and forward tracking s t a t e 2 represents moving straight forward s t a t e 3 represents left turns and forward and s t a t e 4 represents right turns and backward when the usv state is s t a t e 1 it will sail along the right turns and forward circular segment to point w 1 under the action of the initial vector field n o x o y o ψ o then the usv state is changed to s t a t e 2 and the current speed and course are used to sail to point w 2 next upon switching the usv state to s t a t e 3 it sails along left turns and forward circular segment to point w 3 then the usv state is switched to s t a t e 4 and the usv sails along right turns and reverse circular segment of the end vector n d x d y d ψ d 6 simulation results the sea near meizhou bay located in the centre of china s southeast coast is chosen as the simulation environment additionally the port of xiao cu start port and the port of meizhou bay end port are chosen as shown in fig 9 we abstract the static obstacles in the meizhou bay area and the obtained static obstacle model is shown in fig 10 the static obstacles are marked as black and the navigable sea areas are marked as white compared with the conventional grid method the navigable sea areas are divided into several equally sized grids this paper first uses the maklink theory to construct the searchable graph g v e that divides the navigable sea area into several planar convex polygons then the link lines e are dispersed into points according to a certain distance and these discrete points constitute a set of nodes for finding an optimal path it can be seen from table 4 that when the discrete units are 20 m the number of nodes that must be traversed in our method is significantly reduced the calculation time of the algorithm is shortened and the obtained optimal path is shorter and more efficient after obtaining the initial global path the coordinate information of the navigation node is stored in the navigation system which is convenient for real time adjustments in the dynamic path optimization in the absence of dynamic threats during the voyage the trajectory of the waterjet propelled usv is shown by the dashed line in fig 11 to test the function of the dynamic path optimization module assume that the usv starts from the start point when t 0 min various types of obstacles were sequentially encountered at t 11 5 19 0 28 3 39 6 56 2 and 68 3 min and obstacles parameters as shown in table 5 in fig 12 the local threat map of the dynamic obstacles are indicated by black dashed lines the original path are shown by the black dotted lines and the adjusted navigation trajectory are represented by the red solid lines finally we simulate the autonomous recovery path planning module of the waterjet propelled usv as shown in fig 13 when the usv arrives at the distance of approximately 300 m from the target point the autonomous recovery path planning module is started the recovery trace obtained by the simulation is shown by the red line where the solid red line indicates forward motion and the red dotted line indicates backward motion the simulation result shows that the final state of the waterjet propelled usv meets the recovery requirements and thus the usv can be safely docked 7 conclusions an intelligent navigation system was proposed in this paper and simulation experiments proved that our approach could avoid multiple obstacles and plan a safe recovery path this approach is specifically designed for the practical application of waterjet propelled usvs with high manoeuvrability in cluttered marine environments the entire intelligent navigation system adopts a hierarchical operation structure consisting of three modules namely the initial path generation module the path optimization module and the autonomous recovery module unlike in the existing studies of usv navigation using heuristic and evolutionary optimization methods we propose a hybrid a algorithm with motion primitive constraints to obtain the node optimization and continuous curvature path based on the advantages of the conventional a algorithm a local threat map based on the apollonius circle is designed for some complex scenarios of dynamic obstacles incompatible with the colregs rules taking full account of the motion performance of the waterjet propelled usv the reeds shepps curve is used instead of the classic dubins curve for the recovery path planning the main contribution of this paper is the determination that the proposed intelligent navigation system can be successfully integrated with the waterjet propelled usv helping to improve the real time accuracy smoothness and seaworthiness of the path in cluttered environments the intelligent navigation method proposed in this paper can also be extended to other types of high manoeuvrability ships in the future we will focus on the trajectory tracking control problem of high speed ships under the influence of wind waves and ocean currents acknowledgements this work has been supported by the natural science foundation of hubei province and the fundamental research funds for the central universities nos 2018ivb084 2017 yb 030 and 175111001 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 076 
22811,to avoid collision accidents and achieve independent recovery in the cluttered marine environment this work proposes an intelligent path planning system for a waterjet propelled unmanned surface vehicle usv unlike the existing works on usv navigation systems our study focuses on the real time smoothness and seaworthiness properties of the path in practical clutter environments a hybrid a algorithm with motion primitive constraints is proposed to generate an initial reference path according to different types of dynamic obstacles the international regulations for preventing collisions at sea colregs rules are used and a local threat map based on the apollonius circle is constructed to avoid these obstacles together with the motion characteristics of the waterjet propelled usv the reeds shepp curve is used to calculate the autonomous recovery path the performance of the proposed intelligent navigation system is verified in a practical marine environment the experimental results show that our hybrid a algorithm outperforms the conventional a algorithm and it is easy for the waterjet propelled usv to follow the final continuous curvature path it was demonstrated that our method can effectively avoid various static and dynamic obstacles in real time and thus help achieve autonomous recovery keywords unmanned surface vehicle waterjet propulsion path planning apollonius circle automatic recovery reeds shepp curve 1 introduction unmanned surface vehicles usvs have been widely used to meet the requirements of marine exploration and military defence the waterjet propelled usv is a type of usv that is propelled by two waterjets during navigation due to its low cost high manoeuvrability and rapid response capability the waterjet propelled usv has attracted broad interest in the naval civil and scientific fields ellenrieder 2013 to cope with dynamic scenarios that may occur owing to the deployment of different payloads modifications to mission requirements and environmental variations a robust navigation guidance and control ngc system motwani et al 2013 is required for the waterjet propelled usv a substantial amount of research has been reported on approaches for improving the reliability and accuracy of the ngc system tam and bucknall 2013 mousazadeh et al 2018 however the methods for the integration of artificial intelligence with the ngc system have not been explored for the current state of the art usvs it will be beneficial to improve the level of intelligence to achieve autonomous avoidance of various types of obstacles moreover when the waterjet propelled usv completes its mission autonomous recovery is primary importance to ensure the safe return of the usv to the recovery platform both in the process of autonomous obstacle avoidance and in the independent recovery stage the use of an intelligent path planning method is indispensable additionally because the waterjet propelled usv is highly manoeuvrable and can travel both forward and backward it requires a sufficiently effective path planning system for its safe operation at high speeds these considerations motivate the demand for the development of dedicated path planning methods for the waterjet propelled usv particularly in the autonomous recovery stage 1 1 literature review in general the path planning methods can be divided into global and local approaches that are also called static offline and dynamic online path planning methods respectively global path planning methods are used mainly to avoid previously known obstacles such as islands reefs and forbidden areas that are often fixed in the electronic charts classical global methods include the dijkstra algorithm singh et al 2017a a algorithm casalino et al 2009 potential field method virtual force field method romero ramirez and plumet 2012 xie et al 2014 singh et al 2017b fast marching method liu and bucknall 2015 predictive rapidly exploring random trees method zhuang et al 2015 voronoi diagram method wu et al 2013 genetic algorithm ant colony algorithm wu et al 2012 and particle swarm optimization pso algorithm zhou et al 2017 local path planning methods are mainly used to avoid real time obstacles during navigation including moving ships giant floating objects without fixed motion trajectories and others objects that can be automatically identified by radar sensors sonar devices and cameras tang et al 2015 local path planning methods include the dynamic window approach fox et al 1997 d algorithm vanden berg et al 2006 modified virtual force field method lee et al 2004 and the velocity obstacle method kim and oh 2016 in addition many local path planning algorithms were improved based on the global path planning algorithms for instance candeloro presented a dynamic path planning method for 3 dof marine surface vessels based on the voronoi diagram roadmap candeloro et al 2017 ma et al ma et al 2018 formulated the path planning problem as a multiobjective nonlinear optimization problem with generous constraints and proposed the dynamic augmented multiobjective pso algorithm to obtain the solution a global path optimization method using genetic algorithm was proposed in kim et al 2017 considering environmental loads obstacle avoidance and the minimization of the travel time liu et al liu and bucknall 2016 adopted the angle guidance fast marching square method to accommodate the motion constraints of the usv ensuring safety by delineating the ship domain area and the collision avoidance area when entering dangerous areas perera et al 2015 proposed an intelligent guidance based collision avoidance system and obtained experimental results for a scaled ship model woerner et al 2018 generalized the traditional velocity obstacle into a multithreshold approach that more realistically represents and evaluates human ship driving practices naeem et al 2012 applied the a algorithm to calculate a trajectory combined with international regulations for preventing collisions at sea colregs collision avoidance but only based upon the distance cost then singh et al 2018 explored an a approach for the springer usv in a practical scenario with obstacles and ocean currents that is effective for the global path planning of usvs also using the springer usv as the prototype model song et al 2019 developed a smoothed a path planning algorithm to reduce unnecessary jags eliminate redundant waypoints and offer a smoother route practical marine environments are cluttered with various static and dynamic obstacles and that can strongly impact the path planning of a waterjet propelled usv static obstacles include coastlines reefs islands breakwaters fish culture zones and other anthropogenic infrastructures dynamic obstacles include moving ships the giant floating objects without fixed motion trajectories and others objects that can be automatically identified by radar sonar and cameras unfortunately we found that not all of the types of dynamic obstacles have been considered in previous studies most studies with usv path planning assume that dynamic obstacles are equate with moving ships and ignore some of the more dangerous obstacles based on different maps that were adopted in these studies the path planning environment models can be divided into two categories grid based maps and graph based maps the grid based algorithm makes a trade off between the calculation time and the rasterized resolution of the grid map i e the higher the rasterized resolution is the longer the computational time required song et al 2019 the graph based algorithm is often used to generate a piecewise linear path the path can easily make sharp turns within a short distance presenting difficulties for piloting control some methods that improve the path smoothness and avoid sharp turns may sacrifice the requirement for low computational memory at each iteration preventing its real time performance from meeting the requirements of dynamic planning meanwhile a review of the literature of usv path planning methods shows that very few of the studies consider path planning in the autonomous recovery stage therefore an intelligent collision avoidance and recovery path planning approach in practical cluttered environments is an important subject of research for the waterjet propelled usvs 1 2 major contributions to the best of our knowledge the use of simpler constraints in path planning leads to greater limitations in the functions that can be achieved during marine navigation the intelligent path planning system examined in this paper focuses on the following constraints the temporal constraints of the real time path planning the thrust limit and motion constraints of the waterjet propelled usv the uncertainty in the movement direction of some dynamic obstacles and the smoothness of the final recovery path this paper extends the work of reference shi et al 2019 through the following contributions a unlike the conventional methods carried out on a binary grid map an intelligent path planning method based on a graphical map is proposed that is capable of node optimization and is curvature continuous b during the process of dynamic path planning in addition to moving ships other types of dynamic obstacles without a fixed movement direction are considered such as ghost ships unknown large floating objects for these obstacles a local threat model based on the apollonius circle was developed to construct the local threat map around the obstacles c since the waterjet propelled usv can move forward and backward at a constant velocity with a bound on its minimum turning radius the reeds shepp curve was used to optimize the final recovery path and save time and energy overall the purpose of this paper is to intelligently and automatically determine an optimal path for the waterjet propelled usv in cluttered environments the intelligent collision avoidance and recovery path planning system is implemented in a modular manner the rest of this paper is organized as follows section 2 explains the problem formulation for the intelligent path planning system of the waterjet propelled usv the details of the initial path generation module the path optimization module and the autonomous recovery module are described in sections 3 4 and 5 respectively the simulation and experimental results for intelligent collision avoidance and recovery path planning are presented in section 6 section 7 presents the conclusions and describes future work 2 problem formulation 2 1 overview of waterjet propelled usv waterjet propulsion is a common propulsion method for usvs two waterjet nozzles are attached behind the usv hull the basic principle of the waterjet propelled usv is to rely on the reaction force generated by the two waterjet nozzles to obtain forward thrust carlton and carlton 2019 this method is particularly suitable for high speed vessels its difference from the conventional usv is that the thrust direction of the waterjet propelled usv is unfixed klinger et al 2017 due to the structural stability of the waterjet propelled usv hull the motion of the usv is simplified from the current six degrees of freedom to three degrees of freedom specifically the roll pitch and heave motions are ignored while retaining the surge sway and yaw motions these retained motions can be simplified into motions in the inertial plane fig 1 shows a simplified model of the waterjet propelled usv where w d and l e represent the width and length of the hull respectively the waterjet propelled usv uses the left waterjet and right waterjet to provide thrust force f l and f r respectively when moving either forward or backward or when performing turns the kinematics model of usv in the xoy planar motion is represented as follows 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r where x y r 2 are the inertial position coordinates and the ground speed u u 2 v 2 u and v are the velocities in the surge and sway respectively ψ 0 2 π and r are the orientation angle and yaw rate measured counterclockwise from the x axis the dynamics of usv in 3 dof are described by 2 m ν c ν ν d ν ν τ where ν u v r t is a velocity vector composed of surge sway and yaw m c ν and d ν are mass matrix coriolis and damping matrix respectively τ τ u 0 τ r t is a vector forces and moments generated by the two waterjets and τ u and τ r are represented as 3 τ u f r f l τ r f r f l b 2 the specific conditions and parameters used in this paper are shown in table 1 2 2 framework of the intelligent path planning system in this work an intelligent path planning system is proposed for the waterjet propelled usv s navigation in cluttered environments the system contains three modules the initial path generation module dynamic path optimization module and autonomous recovery module the specific details consist of the following main phases as shown in fig 2 the start and end ports are determined based on the needs of the mission and the global area of the voyage is delimited at the same time an environment map of the voyage area containing static obstacles is loaded then an initial static path is generated using the obstacles modeling method shi et al 2019 and hybrid a algorithm for static obstacles with the guidance of the initial static path some sub task waypoints can be obtained when navigation is performed with the sub task waypoint as the target waypoint the distribution of the obstacles in the local area can be detected based on the real time position provided by onboard sensors next it is determined whether dynamic obstacles are present nearby if there is no dynamic obstacle the usv continues navigating to the target waypoint if an obstacle is present it is evaluated whether the movement direction of the obstacle is predictable if its direction can be predicted colregs rules are adopted to avoid the obstacle otherwise the apollonius circle will be used to designate the threat area of the obstacle that will be evaded then the target waypoint is regenerated and the usv continues to moves forward when the waterjet propelled usv enters the recovery preparation area the reeds shepp curve is calculated according to the current state of the usv obtained by the hull sensors and the target state of the usv required by the recovery platform a collision free shortest curve is selected as the recovery path output from these curves 3 initial path generation module 3 1 environment map the initial path generation module is used to find an optimal or nearly optimal collision free path in a known static obstacle environment and this path provides guidance for the subsequent research the environment map and hybrid a algorithm are the two main components of the initial path planning module the establishment of the environment map is the critical foundation that is directly related to the accuracy of the path optimization algorithm according to the relevant standards performance standard for imo 1995 of the international maritime organization imo common navigation chart information includes electronic charts paper charts and satellite images this paper uses satellite images to build the environment map and adopts the maklink theory to map the proposed obstacle model as a searchable graph also called the maklink graph wang and wang 2014 the maklink graph g v e is an undirected graph by spatial decomposition the environment information the obstacles with complex edge information can be treated as planar polygons and a series of nodes v v 1 v 2 v 3 without obstacles can be obtained the lines e connect all of geometrically alongside nodes without passing through any obstacles in the subsequent process that uses the hybrid a algorithm to find the optimal path the waterjet propelled usv only needs to cross these lines to move away from the obstacles in other words all the waypoints of the optimal path are above these lines 3 2 hybrid a algorithm in the static environment map g v e the conventional a algorithm in the heuristic search algorithm is relatively common the actual performance constraints of the waterjet propelled usv and the shortcoming of discreteness of the conventional a algorithm which causes its planned path not to be directly tracked must be considered therefore the hybrid a algorithm is used as the initial global path search technique in the hybrid a algorithm a cost function f n is used to evaluate the cost of moving from the current position n to the adjacent position n and is given by the following 4 f n g n h n in the above formula g n represents the exact cost of the path from the starting position to n the heuristic estimated cost from n to the target position is denoted as h n which is expressed in euclidean distance similar to the conventional a algorithm the hybrid a algorithm also utilizes two sets that keep track of the states during the search the o p e n s e t contains the already expended neighbouring nodes during the search process and the c l o s e s e t contains all nodes that have been conclusively processed to overcome the shortcomings of the conventional a algorithm a set of precomputed motion primitives μ θ δ r d is used to determine the reachable states the cell of the valid motion primitives μ contains the current node s heading angle θ the change in heading angle δ the radius of rotation r and the waterjet propelled usv s forward backward mode d d 0 1 it is a binary value that represents the usv s movement direction where 0 means backward and 1 means forward the pseudocode of the hybrid a algorithm is shown in algorithm 1 algorithm 1 hybrid a algorithm for the initial path generation in the process of searching for navigable waypoints the hybrid a algorithm is different from the 4 or 8 connected node expansion method adopted by the conventional a algorithm the hybrid a algorithm adopts a node extension method with motion primitive construction it is possible that the theoretically optimal node is not actually reachable which indirectly leads to a result in which the path obtained by the hybrid a algorithm is not guaranteed to be globally optimal fortunately the hybrid a algorithm can obtain a sub optimal path that can be further adjusted and optimized during the subsequent dynamic path optimization process 4 path optimization module 4 1 dynamic threat according to the initial path after reaching a waypoint the waterjet propelled usv continues to sail to the next waypoint when a dynamic threat is encountered during the voyage the navigation path must be adjusted locally dynamic threats mainly refer to traffic vessels giant floating objects ghost ships and so on based on the speed of the moving threats different methods are used to avoid them suppose that v o b s and v u s v represent the maximum speed of the dynamic threats and waterjet propelled usv respectively let λ v o b s v u s v then 1 λ 1 the speed of the dynamic threat is higher than that of the usv 2 λ 1 the speed of the dynamic threat is equal to that of the usv 3 λ 1 the speed of the dynamic threat is slower than that of the usv for the cases of λ 1 and λ 1 these types of dynamic threats usually refer to vessels moving at high speed that are equipped with advanced radar systems ais and conning workstations as long as these vessels can follow the relevant rules they can achieve successful collision avoidance for λ 1 there is significant uncertainty in the motion of specific threats such as giant floating objects and ghost ships they may not move at high speed but they cannot obey the rules of navigation and can even randomly change their direction of motion therefore these dynamic threats are also dangerous and the related research in dynamic path optimization is necessary 4 2 colregs rules when the usv is sailing at sea it maintains a sufficient safety distance from other ships according to its manoeuvrability sea conditions and sea visibility to avoid the risk of collision imo stipulates that vessels should strictly abide by the colregs rules as permitted by their safety status rules 13 14 and 15 in colregs define 3 situations overtaking head on and crossing the different manoeuvring requirements corresponding to different encounter situations are shown in fig 3 for overtaking the velocity of the traffic vessel is slower and the waterjet propelled usv seeks to surpass this velocity the usv must ensure that there is sufficient safe clearance so that it keeps out of the way of the traffic vessel being overtaken although rule 13 of colregs does not specify which side of the traffic vessel is to be overtaken the common practice at sea is that the overtaking vessel usv should pass on the right side of the traffic vessel fig 3 b shows a usv and a traffic vessel are moving straight towards each other head on both vessels must alter their course towards starboard so that they pass the other vessel to its port side as shown in fig 3 c the traffic vessel is crossing from the right side of the usv the usv has the traffic vessel on its starboard side therefore the usv must yield to the traffic vessel and the traffic vessel does not need to alter its path otherwise the traffic vessel crosses from the left of the usv as shown in fig 3 d the traffic vessel is the yielding vessel and the usv can stay on its course 4 3 local threat map based on apollonius circle for dynamic threats that do not move rapidly but can randomly change their direction of motion and do not actively obey colregs the apollonius circle is used to construct the local threat map around them as shown in fig 4 p and b indicate the positions of usv and a dynamic threat respectively and m is any point in the xoy plane if λ 1 the trajectory of m can form an apollonius circle each point on the circle can be understood as a set of points that can be reached simultaneously if the current speeds of the two sides are unchanged the positions of the usv and the threat obstacle are x p y p and x b y b respectively using the knowledge of planar geometry the centre of the apollonius circle is calculated as o x p λ 2 x b 1 λ 2 y p λ 2 y b 1 λ 2 and the radius is as follows 5 r λ x p x b 2 y p y b 2 1 λ 2 it can be seen from equation 5 that the radius of the corresponding local threat area decreases with decreasing λ according to the characteristics of the apollonius circle the collision between the usv and an obstacle occurs on the boundary of the circle or inside the circle therefore the area covered by the apollonius circle is defined as the local threat map of the dynamic obstacle and it should be evaded for the dynamic path planning of the usv the specific process of dynamically adjusting waypoints is shown in fig 5 when the usv sails according to the planned path p i 1 p i p i 1 if it detects that obstacle b enters its warning area at waypoint p i then it will establish a local threat map based on the apollonius circle and find the tangent point p i of the circle p i is the intermediate buffer waypoint and the adjusted path waypoints are p i 1 p i p i p i 1 the construction of a local threat map through the apollonius circle is equivalent to turning uncertain dynamic obstacles into static obstacles which greatly reduces the computational complexity of the path planning 4 4 dynamic path optimization algorithm usv continuously detects potential threats in the surrounding environment during the navigation process once a suddenly dynamic threat is detected the path optimization module is immediately entered into the solution to solve for the collision avoidance strategy at the same time the priority of the usv is to ensure the safety of the hull and it is particularly critical to solve the collision avoidance path quickly as the usv approaches the target the surrounding dynamic environment information is continuously updated and the optimal local path is not unique at different times different from the offline planning of the initial path generation module the dynamic path optimization module involves real time planning a simpler and more reliable dynamic path optimization strategy decreases the solution time and more time is left for the usv to actually manoeuvre which is beneficial for its security protection the basic steps of the dynamic path optimization algorithm are given below step 1 the usv sails along the initial static path waypoints and determines whether the current point is the task endpoint if so the dynamic path optimization process ends if not the surrounding environment information is detected continuously it is assumed that a dynamic obstacle is detected at time t by the ship borne radar and its motion state is predicted and analysed step 2 evaluate the speed of the dynamic obstacle movement if the current dynamic obstacle speed is not lower than that of the usv or if the trajectory is normal this means that the obstacle can abide by the navigation rules and the algorithm then proceeds to step 3 if the dynamic obstacle moves slowly and the direction of motion changes randomly it means that the obstacle s motion state is uncontrollable and the algorithm then proceeds to step 4 step 3 determine the type of the encounter situation between the usv and the dynamic obstacles according to table 2 then return to step 1 after completing the corresponding manipulation step 4 construct a local threat map around the dynamic obstacle based on the apollonius circle and evaluate whether the continued navigation will pass through the threat area if so find the circular tangent point the one with the smaller current heading angle as the intermediate buffer waypoint after passing the waypoint go back to step 1 if not return to step 1 directly 5 autonomous recovery module 5 1 recovery path after the waterjet propelled usv completes its mission the autonomous recovery module can help it to safely return to port or a specific recovery platform the recovered waterjet propelled usv can replenish its energy redistribute its tasks etc to effectively improve its endurance and increase the diversity of its tasks when the usv enters the recovery preparation area the recovery module is automatically started and the recovery path is calculated according to its current state and target state the specific recovery process of the waterjet propelled usv is shown in fig 6 the shortest recovery path between the current state and target state cannot always be a straight line due to the disturbance of the environment and the constraint of the initial heading angle as shown in fig 7 a if only the kinetics and obstacle constraints of the usv are considered the classical dubins curve dubins 1957 can meet the requirements the dubins curve uses arcs and line segments and connects them to generate a curve that meets both the current and target state constraints and the heading attitude constraints however the dubins curve only considers the situation in which usv is moving forward in fact the waterjet propelled usv can move both forward and backward fig 7 b shows the trajectory considering the backward case it can also be seen that the path obtained by the reeds shepp curve reeds 1990 is shorter than that obtained by the dubins curve furthermore if a collision free path between any current and target states exists there must exist a collision free reeds shepp curve but the dubins curve does not necessarily exist barraquand and latombe 1993 therefore the present work uses the reeds shepp curve as the recovery path planning method of the waterjet propelled usv 5 2 reeds shepp curves according to the motion model 3 any planned waypoint p i is given by a triple x i y i ψ i where x i y i denote the coordinates of the waypoint and ψ i represents the heading angle of the usv assume that the waterjet propelled usv moves with a planar environment r 2 the trajectory γ is a mapping to the configuration space r 2 s 1 and its specific description is given by the following 6 γ t u 1 t x 1 γ t u 2 t x 2 γ t where u 1 u 2 1 1 are two controls representing the speed and course of the waterjet propelled usv x 1 x 2 are real analytic vector fields with the coordinate representations 7 x 1 x y ψ c o s ψ s i n ψ 0 and 8 x 2 x y ψ 0 0 1 during the description 6 given any two adjacent waypoints p i x i y i ψ i p i 1 x i 1 y i 1 ψ i 1 the trajectory γ is feasible if γ 0 p i γ t p i 1 and it can be tracked by the waterjet propelled usv it was shown in reference sussmann 1993 that there are no more than 46 different patterns that describe the shortest curves this means that these patterns can occur for the shortest path and they are called the reeds shepp curves these reeds shepp curves can be categorized into 9 classes and all of the classes and patterns are listed in table 3 where c stands for a circular arc and s stands for a line segment the symbol is used to indicate that the waterjet is shifted from forward to reverse or reverse to forward assume that l r and s denote left turns right turns and motion on a straight line respectively where the signs correspond to forward motion and the signs correspond to backward motion 5 3 recovery path based on reeds shepp curves it can be seen from the previous study that many reeds shepp curves between two waypoints may exist the shortest curve is selected as the optimal recovery path the optimal recovery path must be a collision free path that satisfies the waterjet propelled usv kinetic performance constraints this path may consist of several straight and circular segments unlike trajectory tracking path planning only ensure that the usv can move on the relevant path without requiring the time to reach the target waypoint therefore this paper uses the reeds shepp curves to plan the recovery path the change in the usv direction is followed by the changing direction of the target path the recovery path planning algorithm based on the reeds shepp curves is a simple and effective method for guiding the usv back to the recovery platform by calculating the control instruction of each point according to the reeds shepp curves and then executing the control commands by the underlying controller the usv will be guided to the recovery platform step by step we take the r s l r path as an example to introduce the recovery path planning algorithm as observed from fig 8 there are four states on the path s t a t e 1 represents right turns and forward tracking s t a t e 2 represents moving straight forward s t a t e 3 represents left turns and forward and s t a t e 4 represents right turns and backward when the usv state is s t a t e 1 it will sail along the right turns and forward circular segment to point w 1 under the action of the initial vector field n o x o y o ψ o then the usv state is changed to s t a t e 2 and the current speed and course are used to sail to point w 2 next upon switching the usv state to s t a t e 3 it sails along left turns and forward circular segment to point w 3 then the usv state is switched to s t a t e 4 and the usv sails along right turns and reverse circular segment of the end vector n d x d y d ψ d 6 simulation results the sea near meizhou bay located in the centre of china s southeast coast is chosen as the simulation environment additionally the port of xiao cu start port and the port of meizhou bay end port are chosen as shown in fig 9 we abstract the static obstacles in the meizhou bay area and the obtained static obstacle model is shown in fig 10 the static obstacles are marked as black and the navigable sea areas are marked as white compared with the conventional grid method the navigable sea areas are divided into several equally sized grids this paper first uses the maklink theory to construct the searchable graph g v e that divides the navigable sea area into several planar convex polygons then the link lines e are dispersed into points according to a certain distance and these discrete points constitute a set of nodes for finding an optimal path it can be seen from table 4 that when the discrete units are 20 m the number of nodes that must be traversed in our method is significantly reduced the calculation time of the algorithm is shortened and the obtained optimal path is shorter and more efficient after obtaining the initial global path the coordinate information of the navigation node is stored in the navigation system which is convenient for real time adjustments in the dynamic path optimization in the absence of dynamic threats during the voyage the trajectory of the waterjet propelled usv is shown by the dashed line in fig 11 to test the function of the dynamic path optimization module assume that the usv starts from the start point when t 0 min various types of obstacles were sequentially encountered at t 11 5 19 0 28 3 39 6 56 2 and 68 3 min and obstacles parameters as shown in table 5 in fig 12 the local threat map of the dynamic obstacles are indicated by black dashed lines the original path are shown by the black dotted lines and the adjusted navigation trajectory are represented by the red solid lines finally we simulate the autonomous recovery path planning module of the waterjet propelled usv as shown in fig 13 when the usv arrives at the distance of approximately 300 m from the target point the autonomous recovery path planning module is started the recovery trace obtained by the simulation is shown by the red line where the solid red line indicates forward motion and the red dotted line indicates backward motion the simulation result shows that the final state of the waterjet propelled usv meets the recovery requirements and thus the usv can be safely docked 7 conclusions an intelligent navigation system was proposed in this paper and simulation experiments proved that our approach could avoid multiple obstacles and plan a safe recovery path this approach is specifically designed for the practical application of waterjet propelled usvs with high manoeuvrability in cluttered marine environments the entire intelligent navigation system adopts a hierarchical operation structure consisting of three modules namely the initial path generation module the path optimization module and the autonomous recovery module unlike in the existing studies of usv navigation using heuristic and evolutionary optimization methods we propose a hybrid a algorithm with motion primitive constraints to obtain the node optimization and continuous curvature path based on the advantages of the conventional a algorithm a local threat map based on the apollonius circle is designed for some complex scenarios of dynamic obstacles incompatible with the colregs rules taking full account of the motion performance of the waterjet propelled usv the reeds shepps curve is used instead of the classic dubins curve for the recovery path planning the main contribution of this paper is the determination that the proposed intelligent navigation system can be successfully integrated with the waterjet propelled usv helping to improve the real time accuracy smoothness and seaworthiness of the path in cluttered environments the intelligent navigation method proposed in this paper can also be extended to other types of high manoeuvrability ships in the future we will focus on the trajectory tracking control problem of high speed ships under the influence of wind waves and ocean currents acknowledgements this work has been supported by the natural science foundation of hubei province and the fundamental research funds for the central universities nos 2018ivb084 2017 yb 030 and 175111001 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 076 
22812,the uncertainty of ship trajectory prediction is addressed in particular a probabilistic trajectory prediction model is proposed that describes the uncertainty in future positions along the ship trajectories by continuous probability distributions the ship motion prediction is decomposed into lateral and longitudinal directions and position probabilities are calculated along these two directions a data driven non parametric bayesian model based on a gaussian process is proposed to describe the lateral motion uncertainty while the longitudinal uncertainty results from the uncertainty on the ship acceleration along the route the parameters of the probabilistic models are derived off line based on historic trajectory information provided by automatic identification system ais data the model is then applied to predict the trajectory uncertainty in real time by iteratively updating the prior probability models based on new observed ais data moreover a sequential cholesky decomposition algorithm is applied in this study to reduce the computational effort required by the gaussian process modelling three months of ais data are used to train and test the proposed probabilistic trajectory prediction model the results obtained show that the proposed method has high prediction accuracy and meets the demands of real time applications keywords ais data gaussian process trajectory prediction uncertainty modelling 1 introduction maritime transportation has been the world s foremost means of transportation for domestic and international trade is responsible for approximately 90 of the international trade and more than 50 000 ships sail in the ocean each day maritime safety and more recently security issues have been highlighted in the last decades due to the challenges imposed by the increasing demand for more ships with larger capacities and higher travelling speeds teixeira and guedes soares 2018 the need to ensure the safety and security of the maritime traffic has motivated the development of tools to support maritime traffic control and management tasks the introduction of the automatic identification system ais has provided a wealth of data for maritime traffic monitoring analysis and modelling as ais can transmit data frequently i e every 3 10s including dynamic ship information such as position speed over ground course over ground as well as static and voyage related data the ais data have been increasingly adopted to characterise the maritime traffic and related risks in this context mou et al 2010 have performed a statistical analysis for collision involved ships in a traffic separation scheme tss off rotterdam port using ais data qu and meng 2012 have proposed three indices including speed dispersion the degree of acceleration and deceleration and a number of fuzzy ship domain overlaps to assess ship collision risk in the singapore strait based on the analysis of ais data silveira et al 2013 have proposed a method to determine the number of collision candidates based on available ais data and using the concept of collision diameter defined by pedersen 1995 mazaheri et al 2014 have studied the frequency of ship groundings in the gulf of finland based on the ais data from ais data of ships entering and leaving the port of lisbon rong et al 2015a have analysed the main characteristics of traffic at the tagus river estuary which were then used as input for traffic simulation later rong et al 2015b have integrated the concept of ship domain in the traffic simulation model to evaluate near ship collision scenarios in the tagus river estuary along the same line rong et al 2016 have identified and characterized statistically the near ship collision scenarios off the coast of portugal using directly observed ais data of the ship trajectories off the continental coast of portugal in the context of maritime surveillance ship trajectory prediction is essential as it provides the possibility to integrate and enrich services to support decision making including target tracking collision avoidance and detection of abnormal traffic behaviour ship trajectory prediction refers to models that can capture the ship motion characteristics and estimate their future positions a variety of methods have been developed for that purpose including extended kalman filter ekf neural network and support vector machine svm among others perera et al 2012 have applied the extended kalman filter ekf to estimate vessel states and to predict navigational trajectories this method showed good performance in estimating vessel speed and acceleration from noised data neural network is one of the most popular tools due to its powerful ability of fitting complex functions xu et al 2012 have proposed a method based on back propagation bp neural networks for ship trajectory prediction given the bp neural network s good learning ability this method can be used for uncertain or unknown conditions the combination of a least square support vector machine ls svm and particle swarm optimization pso was suggested by zhou and shi 2010 for ship motion prediction lengths of about 15s however these methods are limited to short term predictions and therefore they might be more useful for simulation systems rather than to real world applications the development of ship trajectory prediction models starts by grouping the ship trajectories provided by ais data into clusters according to their similarity this provides an overview of the general traffic patterns which are then used to infer the behaviour of ships following specific traffic routes and to project them into the future recently there has been an increased interest in ship traffic motion pattern analysis rhodes and bomberger 2007 have described a system that learns the normal behaviour of vessels detects anomalies and predicts the motion using an artificial neural network trained with ais data aarsæther and moan 2009 applied computer vision techniques to automatically group ship trajectories according to their similarity then manoeuvre sequences and corresponding trajectories statistics of each traffic pattern were derived de vries et al 2012 applied a piecewise linear segmentation method and dynamic time warping dtw to compress and align ship trajectories and then proposed a kernel based method to cluster and classify trajectories mazzarella et al 2015 proposed a bayesian method for predicting vessel motion patterns based on the knowledge of maritime traffic networks derived from ais data the prediction algorithm has been optimized using real motion pattern data and the quality of the predictions obviously increased pallotta et al 2013 proposed an unsupervised and incremental learning approach to the extraction of maritime motion patterns in this work the distribution and characterization of maritime traffic were used for estimating the set of compatible routes and the probability of ship location within each route rong et al 2018 proposed a data mining method on ais data in order to automatically identify maritime traffic junctions and applied a multinomial logistic regression model for predicting the ship s destination based on a set of static and dynamic characteristics of the ships at the junction zhang et al 2018 proposed a data driven approach including ship trajectory compression and clustering techniques to deduce the general behaviour and spatial pattern of trajectories following the same route and given a starting location the optimal route to the destination was inferred by applying ant colony algorithm although process noises have been considered in these methods the prediction relies on a deterministic model that returns the same output when initialized with the same set of inputs however there are uncertainties in real scenarios introduced by the pilot s decisions which are influenced by various physical mental and environmental factors therefore the predicted and actual trajectories are typically different due to the influence of a variety of uncertainty sources in the context of traffic monitoring and surveillance the uncertainty on the prediction of future positions of ships is relevant for the detection of abnormal behaviour of ships and for assessing collision risk in advance in the context of uncertainty modelling gaussian process models have been adopted in different applications rasmussen et al 2006 the approach allows the formulation of a complete bayesian probabilistic framework for regression that provides both mean prediction and associated measures of uncertainty in the maritime domain gaussian process models have been applied for ship behaviour anomaly detection will et al 2011 and kowalska and peel 2012 have applied a gaussian process to construct a normality model of ship behaviour that provides a measure of normality for the ship s velocity given its current latitude and longitude positions smith et al 2013 introduced a novel detection technique using a combination of a gaussian process extreme value theory and divergence measurement to identify abnormal behaviour in both streaming and batch data non parametric gaussian process regression models are appropriate for long term prediction of trajectories due to their ability to learn from data and to model future changes in control inputs or take into consideration particular characteristics of the route such as static obstacles or turning sections that influence the ships behaviour the hyperparameters of the gaussian process encode the characteristics of a ship traffic route and can be regarded as prior knowledge in order to predict the position of ships with a given confidence an alternative approach is to adopt continuous bayes filters such as kalman filters or its variations thrun et al 2006 for vessel state estimation and navigational trajectory prediction e g perera et al 2012 the kalman filter is frequently used to estimate current object states and to propagate them in the future since it uses a dynamic model corresponding to a specific mode of operation e g collision avoidance manoeuvre and typically future changes in control inputs or other external factors are not accounted for the approach is mainly suitable for short term motion prediction in this paper a probabilistic ship trajectory prediction method is proposed the prediction uncertainty is described by the ship position probability density function pdf at discrete time instants and decomposed into lateral and longitudinal directions to achieve the decomposition of ship motion a route fitted coordinate system is established consisting of the centreline of a specific traffic route and lateral direction algorithms transform geographic coordinates to their equivalents in the route fitted space and vice versa the centreline of the traffic route is estimated by applying the dynamic time warping dtw method to align historical ship trajectories obtained from ais data a sequential gaussian process is suggested in this study to model the ship motion with uncertainty in the lateral direction and to update its predictions with in coming ais data the uncertainty on the ship position along the route is estimated from acceleration distributions of the ships obtained also from historical ais data the proposed approach is then applied to the southbound traffic from the traffic separation scheme off cape roca in portugal 2 ship trajectory prediction method this section describes the proposed probabilistic trajectory prediction method section 2 1 presents the model structure and its main elements while in sections 2 2 2 3 and 2 4 the route model and the probabilistic distributions of the trajectories are discussed 2 1 model framework the traffic participants discussed in this paper refer to those ships navigating in shipping routes since information about ship pilots decisions is usually unavailable in real time it is not easy to predict their trajectories firstly due to the limitation of ship manoeuvrability and the effect of environmental conditions the expected ship trajectory can be different from the actual one secondly pilots decisions can be affected by various physical and mental factors e g age stress fatigue among others these introduce uncertainties in the trajectories of the ships along a specific route to simplify the prediction the proposed model decomposes the ship motion into lateral and longitudinal directions which represent the motions perpendicular to and along the route centreline respectively the position pdf in lateral and longitudinal directions are independent of each other in terms of lateral direction it is considered that the trajectories of the ships are parallel to the route centreline moreover it should be mentioned that the ships do not change to other shipping routes this means that ships keep navigating in the same route and route changing behaviour is not taken into consideration the general approach proposed to predict the uncertainty in the ship trajectory is presented in fig 1 in order to better describe the ship motion a route fitted coordinate system is proposed in this study this coordinate system takes the route centreline as the reference and transforms geographic latitude and longitude l a t l n g coordinates to their equivalents in the route fitted space to acquire the centreline of the route ship trajectories are aligned and averaged based on dynamic time warping algorithm in terms of longitudinal motion along a specific route the ship position is determined as the integral of its acceleration thus the longitudinal profile of acceleration is applied to quantify and compute the ship future trajectory in this study the acceleration pdf is determined based on statistical analysis of historical ais data a gaussian process regression model is applied to estimate the pdf of the ship position in the lateral direction the hyperparameters of the gaussian process are obtained by historical ship trajectories data then the gaussian process regression model forecasts the pdf over the trajectories of the ships the two dimensional pdf is established by computing and combining the one dimensional position pdfs in these two directions as illustrated in fig 2 in fig 2 the uncertainty on the ship position is described by two one dimensional probability density functions h s t and g u t that represent the longitudinal and lateral probability density functions of the ship position along the ship route at discrete times t f s u t is the resulting joint probability density function where s and u are respectively the longitudinal and lateral positions of the ship in the route fitted coordinate system as the position probability density functions in longitudinal and lateral directions are independent of each other the ship position joint density function f s u t is calculated by multiplying the longitudinal position probability function h s t and the lateral position probability function g u t the two dimensional joint probability density function f s u t in fig 2 is represented in a discretised way by squares with different grey values a darker square means a higher discrete probability of f s u t the parameters of the probability density function that characterise the longitudinal motion are derived from acceleration pdf for different ship speeds obtained by computing acceleration histograms for different ship speed intervals from historical ais data the probability density function of the ship lateral position g u t is provided by a gaussian process model with hyperparameters obtained based on a training set of ship trajectories of a specific route 2 2 route modelling 2 2 1 route centreline the ship trajectories derived from ais data are of different length and are defined from a different number of points mainly due to speed variations of the ships along the route in this study the dtw algorithm is applied to deal with this variability in the trajectory time series the dtw is a well known algorithm in many domains it was first introduced in the 60s bellman and kalaba 1959 and has been extensively explored and applied to move objects alignment and matching vlachos et al 2005 basically the algorithm calculates an optimal match between two given sequences e g ship trajectories with certain restrictions for two time series x x 1 x 2 x n of length n and y y 1 y 2 y m of length m an n m warping path is a sequence p p 1 p l with p l n l m l 1 n 1 m for l 1 l satisfying the following three conditions 1 boundary condition p 1 1 1 and p l n m 2 monotonicity condition n 1 n 2 n l and m 1 m 2 m l 3 step size condition p l 1 p l 1 0 0 1 1 1 for l 1 l 1 an n m warping path p p 1 p l defines an alignment between two time series x x 1 x 2 x n and y y 1 y 2 y n by assigning the element x n l of x to the element y m l of y the boundary condition enforces that the first elements of x and y as well as the last elements of x and y are aligned to each other it should be mentioned that all elements in both time series are aligned which might require repeating elements from a time series but in the alignment an element in both time series cannot be simultaneously repeated according to condition 2 fig 3 shows an example of dtw alignment between two trajectories after each trajectory of the route is aligned the mean trajectory can be derived from the arithmetic mean of the aligned positions let s be the number of trajectories belonging to a motion pattern m p t r a j 1 t r a j 2 t r a j i t r a j s the centerline trajectory can be calculated by the dtw algorithm as 1 for each trajectory t r a j i of motion pattern m p 2 let t r a j i align to mean track mt p i d t w t r a j i m t 3 for each element p i j in p i 4 m t j p i j i t r a j i j i 1 5 end 6 return m t 2 2 2 route fitted coordinate system the spatial referencing of ship routes is complicated by their winding characteristics which dictates that euclidean distance in a cartesian reference frame is not an appropriate metric route fitted coordinate systems are thus useful in an application oriented task where ship motion patterns are described in terms of a stream wise axis along the ship route centreline and an axis perpendicular to that centreline a method for transforming geographic latitude l a t and longitude l n g coordinates to their equivalents in the s u route fitted space and vice versa is needed to relate the two frames of reference this study adopts a pair of transformation algorithms that are explicitly intended for ship trajectory prediction studies the forward transformation from the geographic coordinate system to the route fitted coordinate system involves 1 description of the centreline by using a set of geographic positions 2 calculation of centreline curvature using results from differential geometry and 3 an efficient local search algorithm to find the projection point from the object to the centreline the inverse transformation algorithm transforms the route fitted coordinates to the geographic coordinate system in a similar way the centreline of the ship route represented by a set of geographic positions is determined from a set of ship trajectories based on dtw algorithm the primary sources of transformation error are the discrete form of the route centreline and discrepancies between the points initial coordinates in one reference and the coordinates obtained via transformation an important issue common to all treatments of winding paths is the spatial referencing due to the complex and typically irregular convex route this non convex geometry dictates that the conventional euclidean distance is not an appropriate metric because a straight line drawn between two points will often cross the boundary of the route a logical solution to this problem is to adopt an orthogonal curvilinear coordinate system fitted to the ship route this coordinate system consists of a stream wise axis s defined by the ship route centreline and an axis orthogonal to that centreline to ensure a left handed coordinate system with s increasing downstream the u axis is positive toward the left boundary of the ship route and facing downstream for spatial analysis transforming observations from geographic coordinates l a t l n g to the orthogonal curvilinear s u coordinate system circumvents the geometric issues associated with the winding contour of the route and provides a consistent intuitive frame of reference for describing the spatial structure of ship route these procedures result in a more convenient transformed s u space within which covariance modelling spatial prediction and stochastic simulation can proceed efficiently by using the euclidean distance as long as the coordinate transformations are unique and reversible the results can then be back transformed to the original geographic coordinate system for visualization and interpretation let p l a t p l n g p be the object position on the geographic coordinate system and let ct c t 1 c t n represent the centerline of the ship route p is the point from object p projected on the centreline ct and located in two adjacent centerline points c l i c l i 1 then the object position p s p u p on the route fitted coordinate can be calculated by 1 s p j 1 i 1 c l j 1 c l j p c l i 2 u p p p the calculations are performed within a loop over the polygons and only the data points located within the current route are considered fig 4 the distances from a datum to each of the resampled centreline vertices on the current segment are computed the minimum of these distances defines the absolute value of the n coordinate points which will be positive for data points on the left side of the route 2 3 longitudinal motion model in this study the ship speed along the route can be regarded as a scalar parameter of the motion traditional prediction methods typically assume that ship speed is constant which provides a single possible trajectory in order to describe the uncertainty on the ship position in the longitudinal direction it is essential to consider the uncertainty on the acceleration of ships as the ship position is the integral of its accelerations the analysis of trajectory data shows that the ship longitudinal acceleration is dependent on the ship current speed moreover accelerations and decelerations happen along the route under conditions that ships are about to change navigation state e g heading changes therefore acceleration distributions along the route can be obtained from historical ais data and be applied to improve the probabilistic model of the acceleration and consequently the future longitudinal positions of the ships given the ship α longitudinal position s α and speed v α at time the t the acceleration distribution of ship α can be expressed by eq 3 assuming independence between ship speed v α and position s α acceleration probability distributions 3 p a c c a v α a s α p a v α p l o n a s α where p a v α is the acceleration discrete pdf depend on ship s current speed p l o n a s α is the acceleration discrete pdf depend on ship s longitudinal position after the acceleration a k takes effect for time δ t the longitudinal position s α n e x t δ t and speed v n e x t δ t of the ship in the next instant can be calculated by 4 s α n e x t δ t s α v α a k δ t 2 2 5 v α n e x t δ t v α a k δ t furthermore through computing equations 4 and 5 repeatedly the ship α longitudinal pdf at all discrete time instants h s α δ t h s α r δ t can be acquired fig 2 in this study acceleration histograms are obtained based on historical ais data and a series of empirical pdfs for different ship speeds are derived additionally acceleration pdfs are obtained along the route at 1000 m interval sections 2 4 lateral distribution model the gaussian process rasmussen and williams 2006 consists of a powerful way to perform bayesian inference about functions in this study a gaussian process is used to model the ship trajectory uncertainty in the lateral direction i e perpendicular to the route centreline the gaussian process provides a mechanism to continuously predict the ship lateral position and its uncertainty at any future time instant as ais data are received sequentially the gaussian process allows the ship lateral position to be predicted conditionally on newly observed data together with prior observations the lateral position pdf can be expressed as 6 g u δ t gp s d where s is the ship α longitudinal position and d s i u i i 1 n is the previous observations of ship trajectory 3 lateral uncertainty prediction model 3 1 gaussian process the gaussian process gp has been proved to be a powerful tool for regression problems formally a gp is a collection of correlated random variables each one following a gaussian distribution the random variables represent the value of a function f x at a location x therefore the gp defines a probabilistic distribution over functions a major advantage for using the gaussian process is that functions can be conveniently specified by a mean function m x and a covariance function k x x as 7 m x e f x 8 k x x e f x m x f x m x where e denotes the expectation operator and k x x is a covariance function that describes the information coupling between independent variable x and x the gaussian process can be written as rasmussen and williams 2006 9 f x g p m x k x x the gaussian process can be defined based on a sample of support points or observations d y n x n n 1 n where x n are the input features i e longitudinal positions of the ships in the route fitted coordinate system and y n f x are lateral positions of the ships this study adopts the most commonly used squared exponential covariance function expressed as 10 k x p x q σ f e x p x p x q 2 ℓ where σ f and l are called hyperparameters σ f denotes the amplitude that specifies the maximum allowable covariance ℓ is the length scale parameter which defines the rate of decay in correlation for points farther away from each other is euclidean distance between two vectors the covariance matrix k x x in gaussian process is a gram matrix defined as 11 k x x k x 1 x 1 k x 1 x 2 k x 2 x 1 k x 2 x 2 k x 1 x n k x 2 x n k x n x 1 k x n x 2 k x n x n σ n o i s e 2 i n where i n is the identity matrix of size n introducing the noise term in equation 11 the joint distribution of the observations and the predictions at the sample locations can be expressed as 12 y y n 0 k x x n n k x x n n k x x n n k x x n n where the suffix of the covariance matrix denotes the size of that matrix then the lateral distribution of the ship y at sample locations x follows a gaussian distribution with mean and covariance given by 13 y x x f n k x x k x x 1 f k x x k x x k x x 1 k x x according to equation 13 the prediction value y corresponding to sample locations x can be estimated by evaluating the mean and covariance matrix the computation complexity of equation 13 is dominated by the matrix inversion term k x x 1 as it grows as o n 3 in the number of samples by applying cholesky factor update the overall computational complexity can be reduced from o n 3 to o n 2 this makes it feasible to apply gaussian process in on line ship trajectory predictions 3 2 sequential gaussian process updates the advantage of the gp arises from its applicability in trajectory prediction with uncertainty and its good analytical properties which means that theoretical analyses can be readily performed however the main shortcoming of the gp modelling is its high computational cost that remains a drawback for big data and real time applications in online applications ais data are received sequentially and the total dataset can grow to an arbitrarily large size the complexity of computing the prediction of the gp is dominated by the need of inverting the covariance matrix k the inversion is expensive as its computational complexity grows as o n 3 in the number of samples i e the dimension of the matrix however with incoming data the covariance matrix k is changed only by the addition of some new rows and columns therefore sequential cholesky decomposition is applied in this study to reformulate the matrix k inversion ballard et al 2010 in linear algebra the cholesky decomposition is a decomposition of a hermitian positive definite matrix into the product of a lower triangular matrix and its conjugate transpose 14 k x x l x x l x x t based on this decomposition the mean and covariance of the trajectory are given as 15 f β x x t γ x 16 v a r f k x x β x x t β x x where γ and β are given as 17 γ x l x x y 18 β x x l x x k x x as mentioned before when new data are received the covariance matrix k is changed only by the addition of some new rows and columns 19 k x 1 n 1 x 1 n 1 k x 1 n x 1 n k x 1 n x n 1 k x n 1 x 1 n k x n 1 x n 1 consequently the cholesky decomposition can also be computed sequentially via 20 l n 1 l n 0 s u l n 1 t l n t s t 0 u t where 21 s l n k x 1 n x n 1 t 22 u c h o l e s k y k x n 1 x n 1 s s t using the sequential cholesky update the predictive probability distribution can also be expressed sequentially by computing the vector γ via the following equation 23 γ 1 n 1 γ 1 n u y n 1 s t a 1 n this sequential process avoids the computationally expensive matrix inversion it should be mentioned that when calculating the covariance function it may be necessary to add a small multiple of the identity matrix ε i to the covariance matrix for numerical reasons this is because the eigenvalues of the covariance matrix can decay very rapidly and without this stabilization the cholesky decomposition may fail 4 case study the maritime traffic off the continental coast of portugal consists of a complex network of shipping routes connecting northern europe and the mediterranean sea as shown in fig 5 a there are two traffic separation schemes tsss located off cape roca and off cape san vicente which regulate the southbound and northbound traffic off the coast of portugal and influence significantly the routes of ships entering and leaving the national ports it is unrealistic to manually trace such an enormous number of ships classify them according to their final destination and to identify the abnormal behaviour of ships along the routes therefore developing automatic and unsupervised tools to analyse and assess the behaviour of ships in specific routes is highly desirable in this paper the gaussian process is applied to predict the ship trajectories along the southbound traffic lane from the traffic separation scheme off cape roca this traffic pattern is extracted from three months of ais data between 1st october and 31st december 2015 shown in fig 5 b the traffic pattern generally shows a certain geographic clustering of ship trajectories as individual ships tend to follow similar routes to their final destination the traffic pattern is typically characterized by a median trajectory and the spread of traffic around it which can provide useful information about the traffic situation the ais dataset contains 1396 ship trajectories from the southbound traffic from the tss off cape roca these ship trajectories consist mainly of cargo ships and tankers which account for 67 8 and 27 2 respectively in this study a subset of 100 ship trajectories is used as a training data set then the ship trajectory prediction algorithm is applied to the complete dataset of ship trajectories 4 1 ship lateral position prediction based on the gaussian process given a new observation and conditional on past information on the ship trajectory the lateral position of the ship and its uncertainty are described respectively by the mean and variance distributions provided by the gaussian process model as shown in fig 6 a conditional on 4 observations the gaussian process can generate the 95 probability interval for the underlying ship trajectory in this figure red dots represent ship locations redline and dash lines are the predicted mean trajectory and the 95 probability bounds 1 96 standard deviations from the mean respectively and greyscale indicates the probability of ship location it can be seen that if the ship has not been observed for a larger period the predictive uncertainty grows and the prediction bounds are wide and open to the right until a new observation is included to the gaussian process prediction model once a new data point is observed the mean trajectory and the 95 prediction bounds provided by the gaussian process model are updated as shown in fig 6 b with this method the ship lateral position derived from past and new observations can be continuously predicted together with its uncertainty the gaussian process hyperparameters encode the characteristics of the ship behaviour thus the hyperparameters of the gp need to be calculated from a historical ais training data set firstly the noise variance σ n o i s e is selected based on prior knowledge about positioning accuracy of ais data in this study σ n o i s e 0 01 is adopted in terms of parameters of the covariance function the training task corresponds to tuning the parameters of the covariance function σ f l to historical ship trajectories which in this study is done in a maximizing marginal likelihood manner the logarithm marginal likelihood is computed by 24 log p y x θ 1 2 y t k 1 y 1 2 l o g k n 2 l o g 2 π where k is the determinant of matrix k θ σ f l a contour plot of the log marginal likelihood as a function of θ derived from a single cargo ship trajectory is shown in fig 7 as an example the optimum of θ occurs when log p y x θ is at its greatest value according to fig 7 the hyperparameters are σ f 1 3 l 2 56 using the training subset of 416 ship trajectories including 362 cargo ships and 54 tankers the hyperparameters σ f l for each ship trajectory were estimated fig 8 shows a scatter plot of training results for the length scale l parameter as a function of the ship length the solid circles and hollow triangles correspond to cargo ships and tankers length scale l parameters respectively the figure clearly shows that the points are distributed evenly and apparently no correlation exists in this particular route between the parameter of the gaussian process and the ship type and length in this study the length scale parameter of the gaussian process model is set to mean value which is 5 45 the maximum allowable covariance is σ f which in this study represents the maximum coverage in the lateral direction therefore σ f cannot be greater than the route width the route width of southbound traffic is around 5 8 km according to the training subset of 416 ship trajectories the average value of the σ f is 1 86 and is applied in this study 4 2 ship acceleration in the longitudinal direction the uncertainty on the ship longitudinal position is estimated by taking into account the ship acceleration along the traffic route and acceleration pdfs depend on ship current speed as described in section 2 3 it is assumed that the ship acceleration distributions along the traffic route and speed acceleration pdfs are independent and both of them are derived from ais data fig 9 shows the heat map of ship acceleration fig 9 a and deceleration fig 9 b along the southbound traffic route according to fig 9 b ship deceleration occurs inside the traffic separation scheme off cape roca the probable explanation could be that the tss off cape roca organises ships bound to and leaving from national ports in particular ships that approach to the ports of lisbon setubal and sines may decelerate on the contrary to the deceleration distribution along the southbound traffic route the acceleration happens after the tss off cape roca as shown in fig 9 a fig 10 shows the acceleration histograms under different speed values the horizontal axis represents possible acceleration values 10 9 9 10 k n o t h o u r while the vertical axis represents the corresponding probabilities obtained by statistical analysis of the ais data corresponding to the southbound traffic from the tss off cape roca it is shown that the probability of the acceleration a 0 is far higher than the probabilities of other accelerations the reason is that ships tend to maintain their current speed in the open sea area as a result ship acceleration usually does not change considerably in the speed range from 8 to 16 knots the acceleration a 0 accounts for more than 50 which indicates that ships are not likely to change speed in this range of velocities when the ship speed is lower than 8 knots the probabilities of a 10 or a 10 gradually increase as the speed decreases this means that the uncertainties on acceleration become stronger when ships navigate at a low speed longitudinal position predictions are conducted for 3 ships and the initial values of their motion parameters are shown in table 1 fig 11 a b and c 11 show the predicted positions of the 3 ships at t 10 min t 20 min and t 30 min the figures clearly show an increasing trend of the uncertainty of the predicted positions as the prediction time increases moreover it can be seen from fig 10 a that the longitudinal position uncertainty of ship 1 that has the lowest initial speed is larger than the others due to the large acceleration uncertainty of ships navigating at low speed 4 3 ship trajectory and uncertainty predictions the approach just described is now applied to real ship trajectory data the squared exponential kernel function equation 10 is chosen to model the underlying ship trajectory characteristics with hyperparameters derived from historical ais ship trajectory data fig 12 shows an example of a ship trajectory without abnormal points the trajectory is of a cargo ship that follows a smooth trajectory and does not make any sudden change in heading fig 12 b shows that the ship positions obtained from real ais data fall well inside the 95 probability prediction interval calculated by the gp model in fig 12 b pixels with different grey values are used to represent the two dimensional joint probability density function of the ship position where a darker grey colour corresponds to a higher probability that the ship is in the corresponding region the gaussian process model provides information on the position uncertainty which can accommodate the navigation uncertainty to some extent however if the observation is located outside the prediction boundary the corresponding ship position can be identified as an abnormal situation fig 13 a shows an abnormal ship trajectory observed from ais data as the ship made an anomalous double u turn fig 13 b c and 13 d show a sequential analysis of abnormal positions detected by the trajectory prediction method the ship initially moves southward in accordance with the motion pattern and the trajectory prediction is sequentially updated based on gaussian process model then the ship starts heading eastward and makes a double u turn the sequential observations are located outside the trajectory prediction bounds and consequently the positions are marked as red circles to highlight the abnormal behaviour of the ship as shown in fig 13 b and c when the ship position falls within the underlying trajectory prediction bounds the observation is assumed a normal position represented by a square marker and the trajectory prediction is updated with this observation as shown in fig 13 d in order to evaluate the prediction accuracy of the proposed model prediction errors in lateral and longitudinal directions are calculated at discrete time instants between 0 and 120 min the lateral longitudinal error is defined as the error between the expectation of the lateral longitudinal pd calculated by the trajectory prediction model and the actual position of the ship obtained from ais data fig 14 shows the model performance for the present case study it can be seen that initially the lateral prediction error increases fast with the prediction time dash line in fig 14 however the increasing rate reduces considerably for prediction times larger than 20 min this is because in this example the ship motion in the lateral direction is assumed to be parallel to centreline furthermore the length scale l in covariance function which depends on the traffic characteristics determines the quality of extrapolations from the past observations note that if the distance between two observations is more than a specific value the value of the covariance function decreases rapidly so as the prediction time increases the relationship between the predicted location and past observations tend to zero and the predicted trajectory tends to be parallel to the centreline of the route as shown in fig 12 b which eventually leads to a lateral prediction error always smaller than the route width on the other hand the solid line in fig 14 shows the longitudinal position prediction error as a function of the prediction time it can be seen that the longitudinal position prediction error increases rapidly only after 60 min this is because ship accelerations are not expected in short time intervals so the assumption of acceleration pdfs conditional to the ship speed is acceptable however the effect of acceleration uncertainty i e the difference between the acceleration pdf obtained from historical ais trajectory data and actual ship dynamic changes will accumulate for longer times which results in a significant increase of the longitudinal prediction error 5 conclusions the proposed ship trajectory prediction method provides a relatively straightforward approach to determine the ship future trajectory and its uncertainty in the present model the uncertainty on the predicted trajectory is described by longitudinal and transversal position pdfs at future discrete time instants the longitudinal position uncertainty is assessed taking into account acceleration histograms conditional to different ship speeds and acceleration distributions along the traffic route obtained from historical ais data of ships navigating in the route it is found that the acceleration evolvs along the route and ships tend to decelerate in the turn section of the traffic route according to the acceleration histograms the probability of acceleration a 0 is considerably higher than the probabilities of other accelerations which indicates that ships tend to maintain their current speed in the study area however when ships navigate at a low speed the probabilities of higher accelerations increase resulting in higher uncertainty on the longitudinal motion prediction a gaussian process model is proposed to describe the ship motion in the lateral direction of a route fitted coordinate system the gaussian process model provides the lateral probability distribution of the ship trajectory as a function of time given newly observed position data and conditional on its past trajectory it is found that the gaussian process hyperparameters calculated of each ship trajectory 362 cargo ships and 54 tankers trajectories have no significant relationship with the ship type or ship length in this particular route however in other routes more complex routes entering and leaving port areas the parameters can be influenced by the ship type and length therefore the analysis of this effect is suggested as a further study the results of the case study show that the lateral position prediction errors as a function of time are less than 900 m and that the assumption of ship acceleration probability distribution conditional to the ship velocity is adequate as the longitudinal position prediction error is low when the prediction time is less than 60 min finally it is shown how the trajectory prediction method can be applied for real time detection of abnormal ship behaviours which is important for maritime traffic monitoring and control tasks the approach consists of detecting whether the ship position obtained by ais data is outside trajectory prediction boundary corresponding to a particular probability level of the two dimensional joint probability distribution of the ship future position two real scenarios of normal and abnormal ship trajectories obtained from ais data were used to demonstrate the potential of the suggested approach for abnormal detection of traffic behaviour acknowledgements the first author has been funded from the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the paper contributes to the project integrated system for traffic monitoring and maritime risk assessment monirisk which has been co funded by the european regional development fund fundo europeu de desenvolvimento regional feder and by the portuguese foundation for science and technology fundação para a ciência e a tecnologia fct under contract no 028746 
22812,the uncertainty of ship trajectory prediction is addressed in particular a probabilistic trajectory prediction model is proposed that describes the uncertainty in future positions along the ship trajectories by continuous probability distributions the ship motion prediction is decomposed into lateral and longitudinal directions and position probabilities are calculated along these two directions a data driven non parametric bayesian model based on a gaussian process is proposed to describe the lateral motion uncertainty while the longitudinal uncertainty results from the uncertainty on the ship acceleration along the route the parameters of the probabilistic models are derived off line based on historic trajectory information provided by automatic identification system ais data the model is then applied to predict the trajectory uncertainty in real time by iteratively updating the prior probability models based on new observed ais data moreover a sequential cholesky decomposition algorithm is applied in this study to reduce the computational effort required by the gaussian process modelling three months of ais data are used to train and test the proposed probabilistic trajectory prediction model the results obtained show that the proposed method has high prediction accuracy and meets the demands of real time applications keywords ais data gaussian process trajectory prediction uncertainty modelling 1 introduction maritime transportation has been the world s foremost means of transportation for domestic and international trade is responsible for approximately 90 of the international trade and more than 50 000 ships sail in the ocean each day maritime safety and more recently security issues have been highlighted in the last decades due to the challenges imposed by the increasing demand for more ships with larger capacities and higher travelling speeds teixeira and guedes soares 2018 the need to ensure the safety and security of the maritime traffic has motivated the development of tools to support maritime traffic control and management tasks the introduction of the automatic identification system ais has provided a wealth of data for maritime traffic monitoring analysis and modelling as ais can transmit data frequently i e every 3 10s including dynamic ship information such as position speed over ground course over ground as well as static and voyage related data the ais data have been increasingly adopted to characterise the maritime traffic and related risks in this context mou et al 2010 have performed a statistical analysis for collision involved ships in a traffic separation scheme tss off rotterdam port using ais data qu and meng 2012 have proposed three indices including speed dispersion the degree of acceleration and deceleration and a number of fuzzy ship domain overlaps to assess ship collision risk in the singapore strait based on the analysis of ais data silveira et al 2013 have proposed a method to determine the number of collision candidates based on available ais data and using the concept of collision diameter defined by pedersen 1995 mazaheri et al 2014 have studied the frequency of ship groundings in the gulf of finland based on the ais data from ais data of ships entering and leaving the port of lisbon rong et al 2015a have analysed the main characteristics of traffic at the tagus river estuary which were then used as input for traffic simulation later rong et al 2015b have integrated the concept of ship domain in the traffic simulation model to evaluate near ship collision scenarios in the tagus river estuary along the same line rong et al 2016 have identified and characterized statistically the near ship collision scenarios off the coast of portugal using directly observed ais data of the ship trajectories off the continental coast of portugal in the context of maritime surveillance ship trajectory prediction is essential as it provides the possibility to integrate and enrich services to support decision making including target tracking collision avoidance and detection of abnormal traffic behaviour ship trajectory prediction refers to models that can capture the ship motion characteristics and estimate their future positions a variety of methods have been developed for that purpose including extended kalman filter ekf neural network and support vector machine svm among others perera et al 2012 have applied the extended kalman filter ekf to estimate vessel states and to predict navigational trajectories this method showed good performance in estimating vessel speed and acceleration from noised data neural network is one of the most popular tools due to its powerful ability of fitting complex functions xu et al 2012 have proposed a method based on back propagation bp neural networks for ship trajectory prediction given the bp neural network s good learning ability this method can be used for uncertain or unknown conditions the combination of a least square support vector machine ls svm and particle swarm optimization pso was suggested by zhou and shi 2010 for ship motion prediction lengths of about 15s however these methods are limited to short term predictions and therefore they might be more useful for simulation systems rather than to real world applications the development of ship trajectory prediction models starts by grouping the ship trajectories provided by ais data into clusters according to their similarity this provides an overview of the general traffic patterns which are then used to infer the behaviour of ships following specific traffic routes and to project them into the future recently there has been an increased interest in ship traffic motion pattern analysis rhodes and bomberger 2007 have described a system that learns the normal behaviour of vessels detects anomalies and predicts the motion using an artificial neural network trained with ais data aarsæther and moan 2009 applied computer vision techniques to automatically group ship trajectories according to their similarity then manoeuvre sequences and corresponding trajectories statistics of each traffic pattern were derived de vries et al 2012 applied a piecewise linear segmentation method and dynamic time warping dtw to compress and align ship trajectories and then proposed a kernel based method to cluster and classify trajectories mazzarella et al 2015 proposed a bayesian method for predicting vessel motion patterns based on the knowledge of maritime traffic networks derived from ais data the prediction algorithm has been optimized using real motion pattern data and the quality of the predictions obviously increased pallotta et al 2013 proposed an unsupervised and incremental learning approach to the extraction of maritime motion patterns in this work the distribution and characterization of maritime traffic were used for estimating the set of compatible routes and the probability of ship location within each route rong et al 2018 proposed a data mining method on ais data in order to automatically identify maritime traffic junctions and applied a multinomial logistic regression model for predicting the ship s destination based on a set of static and dynamic characteristics of the ships at the junction zhang et al 2018 proposed a data driven approach including ship trajectory compression and clustering techniques to deduce the general behaviour and spatial pattern of trajectories following the same route and given a starting location the optimal route to the destination was inferred by applying ant colony algorithm although process noises have been considered in these methods the prediction relies on a deterministic model that returns the same output when initialized with the same set of inputs however there are uncertainties in real scenarios introduced by the pilot s decisions which are influenced by various physical mental and environmental factors therefore the predicted and actual trajectories are typically different due to the influence of a variety of uncertainty sources in the context of traffic monitoring and surveillance the uncertainty on the prediction of future positions of ships is relevant for the detection of abnormal behaviour of ships and for assessing collision risk in advance in the context of uncertainty modelling gaussian process models have been adopted in different applications rasmussen et al 2006 the approach allows the formulation of a complete bayesian probabilistic framework for regression that provides both mean prediction and associated measures of uncertainty in the maritime domain gaussian process models have been applied for ship behaviour anomaly detection will et al 2011 and kowalska and peel 2012 have applied a gaussian process to construct a normality model of ship behaviour that provides a measure of normality for the ship s velocity given its current latitude and longitude positions smith et al 2013 introduced a novel detection technique using a combination of a gaussian process extreme value theory and divergence measurement to identify abnormal behaviour in both streaming and batch data non parametric gaussian process regression models are appropriate for long term prediction of trajectories due to their ability to learn from data and to model future changes in control inputs or take into consideration particular characteristics of the route such as static obstacles or turning sections that influence the ships behaviour the hyperparameters of the gaussian process encode the characteristics of a ship traffic route and can be regarded as prior knowledge in order to predict the position of ships with a given confidence an alternative approach is to adopt continuous bayes filters such as kalman filters or its variations thrun et al 2006 for vessel state estimation and navigational trajectory prediction e g perera et al 2012 the kalman filter is frequently used to estimate current object states and to propagate them in the future since it uses a dynamic model corresponding to a specific mode of operation e g collision avoidance manoeuvre and typically future changes in control inputs or other external factors are not accounted for the approach is mainly suitable for short term motion prediction in this paper a probabilistic ship trajectory prediction method is proposed the prediction uncertainty is described by the ship position probability density function pdf at discrete time instants and decomposed into lateral and longitudinal directions to achieve the decomposition of ship motion a route fitted coordinate system is established consisting of the centreline of a specific traffic route and lateral direction algorithms transform geographic coordinates to their equivalents in the route fitted space and vice versa the centreline of the traffic route is estimated by applying the dynamic time warping dtw method to align historical ship trajectories obtained from ais data a sequential gaussian process is suggested in this study to model the ship motion with uncertainty in the lateral direction and to update its predictions with in coming ais data the uncertainty on the ship position along the route is estimated from acceleration distributions of the ships obtained also from historical ais data the proposed approach is then applied to the southbound traffic from the traffic separation scheme off cape roca in portugal 2 ship trajectory prediction method this section describes the proposed probabilistic trajectory prediction method section 2 1 presents the model structure and its main elements while in sections 2 2 2 3 and 2 4 the route model and the probabilistic distributions of the trajectories are discussed 2 1 model framework the traffic participants discussed in this paper refer to those ships navigating in shipping routes since information about ship pilots decisions is usually unavailable in real time it is not easy to predict their trajectories firstly due to the limitation of ship manoeuvrability and the effect of environmental conditions the expected ship trajectory can be different from the actual one secondly pilots decisions can be affected by various physical and mental factors e g age stress fatigue among others these introduce uncertainties in the trajectories of the ships along a specific route to simplify the prediction the proposed model decomposes the ship motion into lateral and longitudinal directions which represent the motions perpendicular to and along the route centreline respectively the position pdf in lateral and longitudinal directions are independent of each other in terms of lateral direction it is considered that the trajectories of the ships are parallel to the route centreline moreover it should be mentioned that the ships do not change to other shipping routes this means that ships keep navigating in the same route and route changing behaviour is not taken into consideration the general approach proposed to predict the uncertainty in the ship trajectory is presented in fig 1 in order to better describe the ship motion a route fitted coordinate system is proposed in this study this coordinate system takes the route centreline as the reference and transforms geographic latitude and longitude l a t l n g coordinates to their equivalents in the route fitted space to acquire the centreline of the route ship trajectories are aligned and averaged based on dynamic time warping algorithm in terms of longitudinal motion along a specific route the ship position is determined as the integral of its acceleration thus the longitudinal profile of acceleration is applied to quantify and compute the ship future trajectory in this study the acceleration pdf is determined based on statistical analysis of historical ais data a gaussian process regression model is applied to estimate the pdf of the ship position in the lateral direction the hyperparameters of the gaussian process are obtained by historical ship trajectories data then the gaussian process regression model forecasts the pdf over the trajectories of the ships the two dimensional pdf is established by computing and combining the one dimensional position pdfs in these two directions as illustrated in fig 2 in fig 2 the uncertainty on the ship position is described by two one dimensional probability density functions h s t and g u t that represent the longitudinal and lateral probability density functions of the ship position along the ship route at discrete times t f s u t is the resulting joint probability density function where s and u are respectively the longitudinal and lateral positions of the ship in the route fitted coordinate system as the position probability density functions in longitudinal and lateral directions are independent of each other the ship position joint density function f s u t is calculated by multiplying the longitudinal position probability function h s t and the lateral position probability function g u t the two dimensional joint probability density function f s u t in fig 2 is represented in a discretised way by squares with different grey values a darker square means a higher discrete probability of f s u t the parameters of the probability density function that characterise the longitudinal motion are derived from acceleration pdf for different ship speeds obtained by computing acceleration histograms for different ship speed intervals from historical ais data the probability density function of the ship lateral position g u t is provided by a gaussian process model with hyperparameters obtained based on a training set of ship trajectories of a specific route 2 2 route modelling 2 2 1 route centreline the ship trajectories derived from ais data are of different length and are defined from a different number of points mainly due to speed variations of the ships along the route in this study the dtw algorithm is applied to deal with this variability in the trajectory time series the dtw is a well known algorithm in many domains it was first introduced in the 60s bellman and kalaba 1959 and has been extensively explored and applied to move objects alignment and matching vlachos et al 2005 basically the algorithm calculates an optimal match between two given sequences e g ship trajectories with certain restrictions for two time series x x 1 x 2 x n of length n and y y 1 y 2 y m of length m an n m warping path is a sequence p p 1 p l with p l n l m l 1 n 1 m for l 1 l satisfying the following three conditions 1 boundary condition p 1 1 1 and p l n m 2 monotonicity condition n 1 n 2 n l and m 1 m 2 m l 3 step size condition p l 1 p l 1 0 0 1 1 1 for l 1 l 1 an n m warping path p p 1 p l defines an alignment between two time series x x 1 x 2 x n and y y 1 y 2 y n by assigning the element x n l of x to the element y m l of y the boundary condition enforces that the first elements of x and y as well as the last elements of x and y are aligned to each other it should be mentioned that all elements in both time series are aligned which might require repeating elements from a time series but in the alignment an element in both time series cannot be simultaneously repeated according to condition 2 fig 3 shows an example of dtw alignment between two trajectories after each trajectory of the route is aligned the mean trajectory can be derived from the arithmetic mean of the aligned positions let s be the number of trajectories belonging to a motion pattern m p t r a j 1 t r a j 2 t r a j i t r a j s the centerline trajectory can be calculated by the dtw algorithm as 1 for each trajectory t r a j i of motion pattern m p 2 let t r a j i align to mean track mt p i d t w t r a j i m t 3 for each element p i j in p i 4 m t j p i j i t r a j i j i 1 5 end 6 return m t 2 2 2 route fitted coordinate system the spatial referencing of ship routes is complicated by their winding characteristics which dictates that euclidean distance in a cartesian reference frame is not an appropriate metric route fitted coordinate systems are thus useful in an application oriented task where ship motion patterns are described in terms of a stream wise axis along the ship route centreline and an axis perpendicular to that centreline a method for transforming geographic latitude l a t and longitude l n g coordinates to their equivalents in the s u route fitted space and vice versa is needed to relate the two frames of reference this study adopts a pair of transformation algorithms that are explicitly intended for ship trajectory prediction studies the forward transformation from the geographic coordinate system to the route fitted coordinate system involves 1 description of the centreline by using a set of geographic positions 2 calculation of centreline curvature using results from differential geometry and 3 an efficient local search algorithm to find the projection point from the object to the centreline the inverse transformation algorithm transforms the route fitted coordinates to the geographic coordinate system in a similar way the centreline of the ship route represented by a set of geographic positions is determined from a set of ship trajectories based on dtw algorithm the primary sources of transformation error are the discrete form of the route centreline and discrepancies between the points initial coordinates in one reference and the coordinates obtained via transformation an important issue common to all treatments of winding paths is the spatial referencing due to the complex and typically irregular convex route this non convex geometry dictates that the conventional euclidean distance is not an appropriate metric because a straight line drawn between two points will often cross the boundary of the route a logical solution to this problem is to adopt an orthogonal curvilinear coordinate system fitted to the ship route this coordinate system consists of a stream wise axis s defined by the ship route centreline and an axis orthogonal to that centreline to ensure a left handed coordinate system with s increasing downstream the u axis is positive toward the left boundary of the ship route and facing downstream for spatial analysis transforming observations from geographic coordinates l a t l n g to the orthogonal curvilinear s u coordinate system circumvents the geometric issues associated with the winding contour of the route and provides a consistent intuitive frame of reference for describing the spatial structure of ship route these procedures result in a more convenient transformed s u space within which covariance modelling spatial prediction and stochastic simulation can proceed efficiently by using the euclidean distance as long as the coordinate transformations are unique and reversible the results can then be back transformed to the original geographic coordinate system for visualization and interpretation let p l a t p l n g p be the object position on the geographic coordinate system and let ct c t 1 c t n represent the centerline of the ship route p is the point from object p projected on the centreline ct and located in two adjacent centerline points c l i c l i 1 then the object position p s p u p on the route fitted coordinate can be calculated by 1 s p j 1 i 1 c l j 1 c l j p c l i 2 u p p p the calculations are performed within a loop over the polygons and only the data points located within the current route are considered fig 4 the distances from a datum to each of the resampled centreline vertices on the current segment are computed the minimum of these distances defines the absolute value of the n coordinate points which will be positive for data points on the left side of the route 2 3 longitudinal motion model in this study the ship speed along the route can be regarded as a scalar parameter of the motion traditional prediction methods typically assume that ship speed is constant which provides a single possible trajectory in order to describe the uncertainty on the ship position in the longitudinal direction it is essential to consider the uncertainty on the acceleration of ships as the ship position is the integral of its accelerations the analysis of trajectory data shows that the ship longitudinal acceleration is dependent on the ship current speed moreover accelerations and decelerations happen along the route under conditions that ships are about to change navigation state e g heading changes therefore acceleration distributions along the route can be obtained from historical ais data and be applied to improve the probabilistic model of the acceleration and consequently the future longitudinal positions of the ships given the ship α longitudinal position s α and speed v α at time the t the acceleration distribution of ship α can be expressed by eq 3 assuming independence between ship speed v α and position s α acceleration probability distributions 3 p a c c a v α a s α p a v α p l o n a s α where p a v α is the acceleration discrete pdf depend on ship s current speed p l o n a s α is the acceleration discrete pdf depend on ship s longitudinal position after the acceleration a k takes effect for time δ t the longitudinal position s α n e x t δ t and speed v n e x t δ t of the ship in the next instant can be calculated by 4 s α n e x t δ t s α v α a k δ t 2 2 5 v α n e x t δ t v α a k δ t furthermore through computing equations 4 and 5 repeatedly the ship α longitudinal pdf at all discrete time instants h s α δ t h s α r δ t can be acquired fig 2 in this study acceleration histograms are obtained based on historical ais data and a series of empirical pdfs for different ship speeds are derived additionally acceleration pdfs are obtained along the route at 1000 m interval sections 2 4 lateral distribution model the gaussian process rasmussen and williams 2006 consists of a powerful way to perform bayesian inference about functions in this study a gaussian process is used to model the ship trajectory uncertainty in the lateral direction i e perpendicular to the route centreline the gaussian process provides a mechanism to continuously predict the ship lateral position and its uncertainty at any future time instant as ais data are received sequentially the gaussian process allows the ship lateral position to be predicted conditionally on newly observed data together with prior observations the lateral position pdf can be expressed as 6 g u δ t gp s d where s is the ship α longitudinal position and d s i u i i 1 n is the previous observations of ship trajectory 3 lateral uncertainty prediction model 3 1 gaussian process the gaussian process gp has been proved to be a powerful tool for regression problems formally a gp is a collection of correlated random variables each one following a gaussian distribution the random variables represent the value of a function f x at a location x therefore the gp defines a probabilistic distribution over functions a major advantage for using the gaussian process is that functions can be conveniently specified by a mean function m x and a covariance function k x x as 7 m x e f x 8 k x x e f x m x f x m x where e denotes the expectation operator and k x x is a covariance function that describes the information coupling between independent variable x and x the gaussian process can be written as rasmussen and williams 2006 9 f x g p m x k x x the gaussian process can be defined based on a sample of support points or observations d y n x n n 1 n where x n are the input features i e longitudinal positions of the ships in the route fitted coordinate system and y n f x are lateral positions of the ships this study adopts the most commonly used squared exponential covariance function expressed as 10 k x p x q σ f e x p x p x q 2 ℓ where σ f and l are called hyperparameters σ f denotes the amplitude that specifies the maximum allowable covariance ℓ is the length scale parameter which defines the rate of decay in correlation for points farther away from each other is euclidean distance between two vectors the covariance matrix k x x in gaussian process is a gram matrix defined as 11 k x x k x 1 x 1 k x 1 x 2 k x 2 x 1 k x 2 x 2 k x 1 x n k x 2 x n k x n x 1 k x n x 2 k x n x n σ n o i s e 2 i n where i n is the identity matrix of size n introducing the noise term in equation 11 the joint distribution of the observations and the predictions at the sample locations can be expressed as 12 y y n 0 k x x n n k x x n n k x x n n k x x n n where the suffix of the covariance matrix denotes the size of that matrix then the lateral distribution of the ship y at sample locations x follows a gaussian distribution with mean and covariance given by 13 y x x f n k x x k x x 1 f k x x k x x k x x 1 k x x according to equation 13 the prediction value y corresponding to sample locations x can be estimated by evaluating the mean and covariance matrix the computation complexity of equation 13 is dominated by the matrix inversion term k x x 1 as it grows as o n 3 in the number of samples by applying cholesky factor update the overall computational complexity can be reduced from o n 3 to o n 2 this makes it feasible to apply gaussian process in on line ship trajectory predictions 3 2 sequential gaussian process updates the advantage of the gp arises from its applicability in trajectory prediction with uncertainty and its good analytical properties which means that theoretical analyses can be readily performed however the main shortcoming of the gp modelling is its high computational cost that remains a drawback for big data and real time applications in online applications ais data are received sequentially and the total dataset can grow to an arbitrarily large size the complexity of computing the prediction of the gp is dominated by the need of inverting the covariance matrix k the inversion is expensive as its computational complexity grows as o n 3 in the number of samples i e the dimension of the matrix however with incoming data the covariance matrix k is changed only by the addition of some new rows and columns therefore sequential cholesky decomposition is applied in this study to reformulate the matrix k inversion ballard et al 2010 in linear algebra the cholesky decomposition is a decomposition of a hermitian positive definite matrix into the product of a lower triangular matrix and its conjugate transpose 14 k x x l x x l x x t based on this decomposition the mean and covariance of the trajectory are given as 15 f β x x t γ x 16 v a r f k x x β x x t β x x where γ and β are given as 17 γ x l x x y 18 β x x l x x k x x as mentioned before when new data are received the covariance matrix k is changed only by the addition of some new rows and columns 19 k x 1 n 1 x 1 n 1 k x 1 n x 1 n k x 1 n x n 1 k x n 1 x 1 n k x n 1 x n 1 consequently the cholesky decomposition can also be computed sequentially via 20 l n 1 l n 0 s u l n 1 t l n t s t 0 u t where 21 s l n k x 1 n x n 1 t 22 u c h o l e s k y k x n 1 x n 1 s s t using the sequential cholesky update the predictive probability distribution can also be expressed sequentially by computing the vector γ via the following equation 23 γ 1 n 1 γ 1 n u y n 1 s t a 1 n this sequential process avoids the computationally expensive matrix inversion it should be mentioned that when calculating the covariance function it may be necessary to add a small multiple of the identity matrix ε i to the covariance matrix for numerical reasons this is because the eigenvalues of the covariance matrix can decay very rapidly and without this stabilization the cholesky decomposition may fail 4 case study the maritime traffic off the continental coast of portugal consists of a complex network of shipping routes connecting northern europe and the mediterranean sea as shown in fig 5 a there are two traffic separation schemes tsss located off cape roca and off cape san vicente which regulate the southbound and northbound traffic off the coast of portugal and influence significantly the routes of ships entering and leaving the national ports it is unrealistic to manually trace such an enormous number of ships classify them according to their final destination and to identify the abnormal behaviour of ships along the routes therefore developing automatic and unsupervised tools to analyse and assess the behaviour of ships in specific routes is highly desirable in this paper the gaussian process is applied to predict the ship trajectories along the southbound traffic lane from the traffic separation scheme off cape roca this traffic pattern is extracted from three months of ais data between 1st october and 31st december 2015 shown in fig 5 b the traffic pattern generally shows a certain geographic clustering of ship trajectories as individual ships tend to follow similar routes to their final destination the traffic pattern is typically characterized by a median trajectory and the spread of traffic around it which can provide useful information about the traffic situation the ais dataset contains 1396 ship trajectories from the southbound traffic from the tss off cape roca these ship trajectories consist mainly of cargo ships and tankers which account for 67 8 and 27 2 respectively in this study a subset of 100 ship trajectories is used as a training data set then the ship trajectory prediction algorithm is applied to the complete dataset of ship trajectories 4 1 ship lateral position prediction based on the gaussian process given a new observation and conditional on past information on the ship trajectory the lateral position of the ship and its uncertainty are described respectively by the mean and variance distributions provided by the gaussian process model as shown in fig 6 a conditional on 4 observations the gaussian process can generate the 95 probability interval for the underlying ship trajectory in this figure red dots represent ship locations redline and dash lines are the predicted mean trajectory and the 95 probability bounds 1 96 standard deviations from the mean respectively and greyscale indicates the probability of ship location it can be seen that if the ship has not been observed for a larger period the predictive uncertainty grows and the prediction bounds are wide and open to the right until a new observation is included to the gaussian process prediction model once a new data point is observed the mean trajectory and the 95 prediction bounds provided by the gaussian process model are updated as shown in fig 6 b with this method the ship lateral position derived from past and new observations can be continuously predicted together with its uncertainty the gaussian process hyperparameters encode the characteristics of the ship behaviour thus the hyperparameters of the gp need to be calculated from a historical ais training data set firstly the noise variance σ n o i s e is selected based on prior knowledge about positioning accuracy of ais data in this study σ n o i s e 0 01 is adopted in terms of parameters of the covariance function the training task corresponds to tuning the parameters of the covariance function σ f l to historical ship trajectories which in this study is done in a maximizing marginal likelihood manner the logarithm marginal likelihood is computed by 24 log p y x θ 1 2 y t k 1 y 1 2 l o g k n 2 l o g 2 π where k is the determinant of matrix k θ σ f l a contour plot of the log marginal likelihood as a function of θ derived from a single cargo ship trajectory is shown in fig 7 as an example the optimum of θ occurs when log p y x θ is at its greatest value according to fig 7 the hyperparameters are σ f 1 3 l 2 56 using the training subset of 416 ship trajectories including 362 cargo ships and 54 tankers the hyperparameters σ f l for each ship trajectory were estimated fig 8 shows a scatter plot of training results for the length scale l parameter as a function of the ship length the solid circles and hollow triangles correspond to cargo ships and tankers length scale l parameters respectively the figure clearly shows that the points are distributed evenly and apparently no correlation exists in this particular route between the parameter of the gaussian process and the ship type and length in this study the length scale parameter of the gaussian process model is set to mean value which is 5 45 the maximum allowable covariance is σ f which in this study represents the maximum coverage in the lateral direction therefore σ f cannot be greater than the route width the route width of southbound traffic is around 5 8 km according to the training subset of 416 ship trajectories the average value of the σ f is 1 86 and is applied in this study 4 2 ship acceleration in the longitudinal direction the uncertainty on the ship longitudinal position is estimated by taking into account the ship acceleration along the traffic route and acceleration pdfs depend on ship current speed as described in section 2 3 it is assumed that the ship acceleration distributions along the traffic route and speed acceleration pdfs are independent and both of them are derived from ais data fig 9 shows the heat map of ship acceleration fig 9 a and deceleration fig 9 b along the southbound traffic route according to fig 9 b ship deceleration occurs inside the traffic separation scheme off cape roca the probable explanation could be that the tss off cape roca organises ships bound to and leaving from national ports in particular ships that approach to the ports of lisbon setubal and sines may decelerate on the contrary to the deceleration distribution along the southbound traffic route the acceleration happens after the tss off cape roca as shown in fig 9 a fig 10 shows the acceleration histograms under different speed values the horizontal axis represents possible acceleration values 10 9 9 10 k n o t h o u r while the vertical axis represents the corresponding probabilities obtained by statistical analysis of the ais data corresponding to the southbound traffic from the tss off cape roca it is shown that the probability of the acceleration a 0 is far higher than the probabilities of other accelerations the reason is that ships tend to maintain their current speed in the open sea area as a result ship acceleration usually does not change considerably in the speed range from 8 to 16 knots the acceleration a 0 accounts for more than 50 which indicates that ships are not likely to change speed in this range of velocities when the ship speed is lower than 8 knots the probabilities of a 10 or a 10 gradually increase as the speed decreases this means that the uncertainties on acceleration become stronger when ships navigate at a low speed longitudinal position predictions are conducted for 3 ships and the initial values of their motion parameters are shown in table 1 fig 11 a b and c 11 show the predicted positions of the 3 ships at t 10 min t 20 min and t 30 min the figures clearly show an increasing trend of the uncertainty of the predicted positions as the prediction time increases moreover it can be seen from fig 10 a that the longitudinal position uncertainty of ship 1 that has the lowest initial speed is larger than the others due to the large acceleration uncertainty of ships navigating at low speed 4 3 ship trajectory and uncertainty predictions the approach just described is now applied to real ship trajectory data the squared exponential kernel function equation 10 is chosen to model the underlying ship trajectory characteristics with hyperparameters derived from historical ais ship trajectory data fig 12 shows an example of a ship trajectory without abnormal points the trajectory is of a cargo ship that follows a smooth trajectory and does not make any sudden change in heading fig 12 b shows that the ship positions obtained from real ais data fall well inside the 95 probability prediction interval calculated by the gp model in fig 12 b pixels with different grey values are used to represent the two dimensional joint probability density function of the ship position where a darker grey colour corresponds to a higher probability that the ship is in the corresponding region the gaussian process model provides information on the position uncertainty which can accommodate the navigation uncertainty to some extent however if the observation is located outside the prediction boundary the corresponding ship position can be identified as an abnormal situation fig 13 a shows an abnormal ship trajectory observed from ais data as the ship made an anomalous double u turn fig 13 b c and 13 d show a sequential analysis of abnormal positions detected by the trajectory prediction method the ship initially moves southward in accordance with the motion pattern and the trajectory prediction is sequentially updated based on gaussian process model then the ship starts heading eastward and makes a double u turn the sequential observations are located outside the trajectory prediction bounds and consequently the positions are marked as red circles to highlight the abnormal behaviour of the ship as shown in fig 13 b and c when the ship position falls within the underlying trajectory prediction bounds the observation is assumed a normal position represented by a square marker and the trajectory prediction is updated with this observation as shown in fig 13 d in order to evaluate the prediction accuracy of the proposed model prediction errors in lateral and longitudinal directions are calculated at discrete time instants between 0 and 120 min the lateral longitudinal error is defined as the error between the expectation of the lateral longitudinal pd calculated by the trajectory prediction model and the actual position of the ship obtained from ais data fig 14 shows the model performance for the present case study it can be seen that initially the lateral prediction error increases fast with the prediction time dash line in fig 14 however the increasing rate reduces considerably for prediction times larger than 20 min this is because in this example the ship motion in the lateral direction is assumed to be parallel to centreline furthermore the length scale l in covariance function which depends on the traffic characteristics determines the quality of extrapolations from the past observations note that if the distance between two observations is more than a specific value the value of the covariance function decreases rapidly so as the prediction time increases the relationship between the predicted location and past observations tend to zero and the predicted trajectory tends to be parallel to the centreline of the route as shown in fig 12 b which eventually leads to a lateral prediction error always smaller than the route width on the other hand the solid line in fig 14 shows the longitudinal position prediction error as a function of the prediction time it can be seen that the longitudinal position prediction error increases rapidly only after 60 min this is because ship accelerations are not expected in short time intervals so the assumption of acceleration pdfs conditional to the ship speed is acceptable however the effect of acceleration uncertainty i e the difference between the acceleration pdf obtained from historical ais trajectory data and actual ship dynamic changes will accumulate for longer times which results in a significant increase of the longitudinal prediction error 5 conclusions the proposed ship trajectory prediction method provides a relatively straightforward approach to determine the ship future trajectory and its uncertainty in the present model the uncertainty on the predicted trajectory is described by longitudinal and transversal position pdfs at future discrete time instants the longitudinal position uncertainty is assessed taking into account acceleration histograms conditional to different ship speeds and acceleration distributions along the traffic route obtained from historical ais data of ships navigating in the route it is found that the acceleration evolvs along the route and ships tend to decelerate in the turn section of the traffic route according to the acceleration histograms the probability of acceleration a 0 is considerably higher than the probabilities of other accelerations which indicates that ships tend to maintain their current speed in the study area however when ships navigate at a low speed the probabilities of higher accelerations increase resulting in higher uncertainty on the longitudinal motion prediction a gaussian process model is proposed to describe the ship motion in the lateral direction of a route fitted coordinate system the gaussian process model provides the lateral probability distribution of the ship trajectory as a function of time given newly observed position data and conditional on its past trajectory it is found that the gaussian process hyperparameters calculated of each ship trajectory 362 cargo ships and 54 tankers trajectories have no significant relationship with the ship type or ship length in this particular route however in other routes more complex routes entering and leaving port areas the parameters can be influenced by the ship type and length therefore the analysis of this effect is suggested as a further study the results of the case study show that the lateral position prediction errors as a function of time are less than 900 m and that the assumption of ship acceleration probability distribution conditional to the ship velocity is adequate as the longitudinal position prediction error is low when the prediction time is less than 60 min finally it is shown how the trajectory prediction method can be applied for real time detection of abnormal ship behaviours which is important for maritime traffic monitoring and control tasks the approach consists of detecting whether the ship position obtained by ais data is outside trajectory prediction boundary corresponding to a particular probability level of the two dimensional joint probability distribution of the ship future position two real scenarios of normal and abnormal ship trajectories obtained from ais data were used to demonstrate the potential of the suggested approach for abnormal detection of traffic behaviour acknowledgements the first author has been funded from the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the paper contributes to the project integrated system for traffic monitoring and maritime risk assessment monirisk which has been co funded by the european regional development fund fundo europeu de desenvolvimento regional feder and by the portuguese foundation for science and technology fundação para a ciência e a tecnologia fct under contract no 028746 
22813,to improve the understanding of the damping behavior of fiber ropes a novel method for calculating the internal damping coefficient of these ropes based on the theory of structural dynamics tsd is proposed by comparing the damping values from the indicator diagram method idm utilizing experimental data of aramid polyester and hmpe ropes the proposed tsd method clearly shows the relation between the internal damping coefficient and dynamic stiffness of the fiber ropes the relative error of the internal damping coefficients calculated by these two methods is small which proves the accuracy of the tsd method in addition the experimental results of hmpe ropes show that the area of the hysteresis loop remains almost constant after the samples had experienced sufficient number of load cycles the test results also indicate that the damping coefficient increases with increasing mean load but decreases with increasing load amplitude and load periods hence the present study can help developers capture the internal damping behavior of fiber ropes leading to an efficient technology for mooring analysis and allowing efficient implementation of the viscoelastic concept of fiber mooring ropes to engineering applications keywords fiber rope internal damping hysteresis loop viscoelastic dynamic stiffness mooring 1 introduction mooring systems are vital to the station keeping of floating structures in industrial applications there are mainly two types of permanent mooring systems catenary and taut wire the main sections of catenary mooring systems are chains or wire ropes which provide the restoring force based on the weights of suspended segments the disadvantages of the catenary mooring systems include higher weight of mooring lines less payload of floating structures and larger mooring footprint coming from the long chains or wire ropes to avoid these drawbacks of catenary moorings fiber ropes are often utilized in taut wire mooring systems to provide the restoring force based on axial elongation of the fiber ropes beltran 2006 mohanraj et al 2011 weller et al 2014 lian et al 2018a b c the advantages of using fiber ropes in moorings include low cost light weight and ease of handling in addition the taut wire mooring system helps to save the space of mooring systems and avoid collision with other elements because the taut wire mooring system occupies a smaller footprint than catenary ones banfield and casey 1998 johanning et al 2007 abs 2011 api 2015 based on these advantages taut wire mooring systems have potential to be employed in wave energy converter wec arrays which require small footprint moorings johanning et al 2007 weller et al 2013 2014 2015a b hence fiber ropes have become one of the most suitable substitutes for wire ropes or chains in mooring systems however fiber ropes show complex nonlinear behaviors which is quite different from the behaviors of chains or wire ropes hence a number of detailed studies had been performed over the years to try to understand the damage tolerance property li et al 2002 ward et al 2006 beltran and williamson 2005 beltran and de vico 2015 beltran et al 2017 the viscoelastic mechanics davies et al 2003 flory et al 2004 johanning et al 2007 derombise et al 2011 weller et al 2013 huang et al 2015 lian et al 2015 2018 creep properties davies et al 2003 vlasblom and bosman 2006 leite and boesten 2011 lian et al 2018a b c fatigue behaviors banfield et al 2000 2005 banfield and ridge 2017 lian et al 2017a b dynamic stiffness del vecchio 1992 davies et al 2002 liu et al 2014 2015 loading history effect weller et al 2014 2015a b lian et al 2018a b c and damping behavior johanning et al 2007 weller et al 2013 2014 of the fiber ropes note that the damage distribution properties degradation and damage tolerance of fiber ropes had been systematically studied for example li et al 2002 performed small scale experiments on damaged sub ropes and elements beltran and williamson 2005 investigated the degradation of rope properties under an increasing monotonic load ward et al 2006 performed full scale tests on damaged fiber ropes and developed guidelines for the damage tolerance of polyester ropes beltran and de vico 2015 assessed the effect of damage distribution on the static rope behavior beltran et al 2017 analysed the effects of strain localization and damage distribution on the static behavior of polyester ropes hence this paper here focuses on the nonlinear behavior of fiber ropes under the intact condition understanding the effects of the nonlinear properties of the intact fiber ropes on mooring systems is vital to design economical and reliable fiber mooring systems for floating structures particularly the dynamic stiffness and damping of mooring lines are two key parameters that affect the response of floating structures weller et al 2014 xu et al 2018 the dynamic stiffness of the fiber mooring ropes affects the mooring stiffness and horizontal offset of floating structures davies et al 2002 lian et al 2017a b damping of the mooring system affects the surge and sway motions of the floating structures such as fpso and wec huse 1986 weller et al 2014 the main sources of damping of the mooring system include wave drift viscous dissipation wave radiation from the floating structure and mooring line damping the damping of a catenary mooring line arises from the line friction on the sea bed internal line damping and from the drag force on the line bauduin and naciri 2000 johanning et al 2007 damping of the mooring line can contribute up to 80 of total system damping molin 1994 hamilton and kitney 2004 therefore investigating the damping properties of the mooring lines is important and necessary numerous researches had been performed to investigate the mooring line damping and the effects of mooring damping on the motion response of floating structures a quasi static method and an indicator diagram method for calculating damping coefficients were proposed by analyzing the experimental results or mathematical modeling results for example to understand the effects of the damping of mooring lines on the response of a floating platform huse 1986 originally proposed the quasi static method for estimating the energy dissipation of mooring lines liu and bergdahl 1998 improved huse s method by improving the predictive accuracy on the transverse motion amplitude of line elements bauduin and naciri 2000 improved the predictive capability of the quasi static approach based on a more accurate description of the normal displacements and the drag forces on the mooring line to address the drawbacks of the quasi static method which was deemed not sufficiently accurate to capture the damping behavior of non linear response of mooring lines an indicator diagram method was proposed by webster 1995 the method utilizes the area of the hysteresis loop curve at the top of mooring line to describe the dissipated energy caused by the mooring line based on the tension and horizontal motions at the top end of mooring line since then the indicator diagram method has been widely used to obtain the energy dissipation and damping of the mooring line brown and mavrakos 1999 johanning et al 2007 weller et al 2014 2015a b xu and anderson 2015 yang et al 2016 xu et al 2018 fan et al 2017 improved the indicator diagram method to calculate the damping coefficient of the mooring line in the truncation design of mooring systems fan et al 2018 utilized the static and damping equivalence to design the equivalent truncated mooring systems in addition xu et al 2018 showed the relation between the damping of hybrid moorings and horizontal motion responses and they found that pretension of mooring lines significantly affects mooring damping as described above most research calculated the damping of mooring lines however few studies have focused on the internal damping of mooring line due to the viscoelastic property of fiber ropes under the specified axial harmonic forces except weller et al 2014 2015a b who performed the experiments on nylon ropes to calculate the damping coefficient based on the indicator diagram method their results showed that both the damping coefficient and the dynamic stiffness of fiber ropes depended on the mean load levels weller et al 2014 however the damping evolution of fiber ropes and the relation between the dynamic stiffness and damping coefficient of fiber ropes are not clearly known to date a method for capturing the damping coefficient and establishing the relation between the damping coefficient and dynamic stiffness is needed in the present study a schapery s viscoelastic and owen s viscoplastic model which describes the complex mechanics of fiber ropes well huang et al 2015 is first reviewed the prediction results obtained by the viscoelastic and viscoplastic theory huang et al 2015 are compared with the experimental hysteresis loops of aramid and polyester ropes then to improve the accuracy of method for describing the hysteresis loops a simple function to describe the hysteresis loops and a method for determining the damping coefficient of fiber ropes based on the theory of structural dynamics is proposed numerical simulation results of hysteresis loops and damping coefficients are compared with existing experimental data for both aramid and polyester ropes moreover to further validate the proposed method for accurately capturing hysteresis loops and the damping coefficient of fiber ropes systematic cyclic tests of hmpe ropes are performed effects of the cyclic load period mean tension and tension amplitude on the damping coefficient of fiber ropes are studied the present study not only improves the understanding of the damping behavior of fiber ropes but also helps to incorporate the viscoelastic concept in engineering applications of mooring systems 2 analytical description of hysteresis loops 2 1 viscoelastic and viscoplastic models in general fiber ropes including aramid polyester and hmpe ropes often show complex viscoelastic and or viscoplastic behaviors hence many numerical and experimental studies on the mechanical properties of synthetic fiber ropes have been performed for example flory et al 2004 2007 proposed a physical spring dashpot model to describe the elongation properties of fiber ropes under different load conditions but their studies were limited to qualitative analysis only chailleux and davies 2003 2005 utilized schapery s viscoelastic and perzyna s viscoplastic model to quantify the creep recovery response of aramid and polyester fiber samples but they did not extend to cyclic load conditions due to the nonlinear viscoelasticity and viscoplasticity of fiber ropes significant hysteresis arises under cyclic loads to quantify the hysteresis loop of synthetic fiber ropes under cyclic loads huang et al 2015 employed the schapery s viscoelastic and owen s viscoplastic theory shown here in eq 1 1 ε ε v e ε v p ε v e g 0 d 0 σ t g 1 0 t δ d ψ t ψ τ d g 2 σ d τ d τ ψ t 0 t d s a σ σ s δ d ψ n 1 n d n 1 e λ n ψ ε v p 0 t 1 h 1 e h η p t e τ d σ σ y 0 d τ d τ w h e n σ σ y 0 where ε is the total strain ε v e is the viscoelastic strain calculated by the schapery s viscoelastic model and the second term of the viscoelastic strain controls the damping behavior of fiber ropes ε v p is the viscoplastic strain which is calculated based on the owen s viscoplastic model σ t is the stress g 0 g 1 g 2 and a σ are the stress dependent nonlinear parameters d 0 is the instantaneous compliance ψ is the reduced time δ d ψ is the transient compliance n is the number of items d n is the nth coefficient in the prony series λ n is the nth reciprocal of retardation time σ y 0 is the initial yield stress h is the hardening parameter η p is the viscosity constant and t e is the effective time of the viscoplastic strain based on the model of eq 1 the total strain of fiber ropes can be calculated and the hysteresis loop can be described note that the viscoelastic model can describe the hysteresis loop reflecting the viscoelastic effect the viscoplastic model can be used to calculate the viscoplastic strain which occurs when the stress is higher than the initial yield stress the viscoelastic viscoplastic model developed by huang et al 2013 2015 in which the first two authors of this study participated appear to be sufficiently good models for hysteretic damping behavior of fiber ropes to assess the predictive capability of the viscoelastic viscoplastic model described in eq 1 we developed a numerical model implemented the equation numerically to simulate the stable hysteresis loops of two types of fiber ropes one is an double braided aramid rope under a cyclic load l m 18 40 abs l a 5 772 abs t 3 8776 s and the other is a three strand construction polyester rope under a cyclic load l m 24 87 a b s l a 1 769 a b s t 3 8752 s where l m l a t and a b s denote the mean load the load amplitude the cyclic load period and the average breaking strength respectively comparison between the numerical results from the viscoelastic viscoplastic model and experimental data of hysteresis loops for these two type fiber ropes is presented in fig 1 the results show that the viscoelastic viscoplastic model can capture the time dependent behavior of fiber ropes well in general even though the hysteresis loop calculated by the viscoelastic viscoplastic model have a small offset towards right compared to the loop calculated by the viscoelastic model the viscoplastic effect on hysteresis loops is negligible because the viscoplastic strain is very small compared to the viscoelastic one note that the viscoelastic strain is the main part of total strain the difference between numerical results from viscoelastic viscoelastic viscoplastic model and experimental data maybe due to the accuracy of model parameters which is a challenge to be determined in these complex models overall the prediction results obtained by utilizing schapery s viscoelastic and owen s viscoplastic theory huang et al 2013 2015 agree well with the experimental hysteresis loops of aramid and polyester ropes in terms of the slopes of the stable hysteresis loops considering that the numerical results is calculated based on estimated model parameters however there appears still room for improving the accuracy of numerical hysteresis loops calculated by the complex model in particular to capture the viscoelastic effect of fiber ropes and to avoid the complexity of the model and involved computations a simple and accurate method for describing the hysteresis behavior is proposed here 2 2 sine function method for describing stable hysteresis loops to simplify the computations and possibly improve the accuracy of the simulation results of the hysteresis loops obtained by the viscoelastic viscoplastic model of huang et al 2013 2015 we propose a simple trigonometric function method in this study this simple method is based on previous experimental observation that the stress strain hysteresis loops become nearly stable for a bedded in rope after a certain number of load cycles at 20 10 abs sinusoidal load for sufficiently low amplitude loads where there is no damage to the rope stable loops can be observed under sinusoidal cyclic loads banfield and casey 1998 casey et al 2000 huang et al 2015 here we propose to model the stable hysteresis loop curves a sine function with selected initial phases as follow 2 y y 0 y a sin ω t ϕ 0 where y is the experimental data of stress or strain y 0 is the mean value of stress or strain y a is the amplitude ω is the angular frequency of vibration t is the loading time and ϕ 0 is the initial phase the difference of initial phases between the strain time and stress time curves indicates the phase shift which is related to the value of transient compliance δ d ψ in eq 1 eq 2 shows the physical meaning that the rope is approximated by an axial harmonic motion the experimental data of aramid and polyester ropes presented in fig 1 is used to assess and validate the feasibility of the sine function for simulating the stable hysteresis loops of fiber ropes for the case of aramid ropes l m 18 40 a b s l a 5 772 a b s t 3 8776 s the experimental data including stress time strain time and hysteresis loop curves of 10 representative cycles cycle number from 775 to 785 are plotted in fig 2 it is observed that the experimental data in fig 2 are well approximated by the sine function in eq 2 the coefficients of the sine function for the experimental data of aramid rope are obtained using a least square method and listed in table 1 for the case of polyester ropes l m 24 87 a b s l a 1 769 a b s t 3 8752 s 10 representative cycles cycle number from 335 to 345 of the experimental data of polyester ropes at the stable state after the transient load cycle effects had dissipated are utilized following the same method the simulation results of the polyester rope are shown in fig 3 and the corresponding coefficients of the sine function are listed in table 2 for both the aramid and the polyester ropes the correlation coefficients between experimental values and simulation results for the stress time and strain time curves both equal to 0 99 hence there is a excellent agreement between the measured data and the simulation results obtained by the sine functions in addition the simulations of the sine functions agree well with experimental data of hysteresis loops as shown in figs 2 c and 3 c moreover by comparing these two figures with fig 1 it shows that the sine function method is more accurate than the schapery s viscoelastic and owen s viscoplastic theory in terms of the simulation results of hysteresis loops this means the sine function method as shown in eq 2 is capable of describing the stable hysteresis loops more accurately and in a much simpler manner results in tables 1 and 2 show that for any one of tested ropes the vibration periods of these two sine functions for simulating stress time and strain time curves are practically identical the difference in the initial phase between stress time and strain time curves occurs due to the viscoelastic effect of the hysteresis loops to capture the viscoelastic effect of fiber ropes two key parameters including the dynamic stiffness and internal damping coefficient are proposed by analyzing the curves of hysteresis loops the secant slope of the hysteresis loops is defined as the dynamic stiffness of fiber ropes as in del vecchio 1992 in addition the area of the hysteresis loop is used to calculate the internal damping coefficient as described by the indicator diagram method webster 1995 however the relation between the dynamic stiffness and internal damping coefficients has not yet been established hence it is necessary to develop a new method for determining the internal damping coefficient and connecting the dynamic stiffness of fiber ropes based on the theory of structural dynamics 3 method for calibrating the internal damping coefficient 3 1 theory of structural dynamics for determining the internal damping coefficient as observed from the results above the stable hysteresis loops can be obtained under the assumption that the state of rope is not damage during the initial service these loops can be modelled by the sine function here an idea that uses the theory of structural dynamics to determine the internal damping coefficient and establish the relation between internal damping and dynamic stiffness is proposed based on the assumption that the fiber rope is intact the effects of bending stresses torsion and the helical rope composition on different size ropes with the same structure type are negligible by observing the characteristics of the physical behavior we deem that a rope element of the testing sample under the specified axial load range can be modelled based on the theory of structural dynamics as a single degree of freedom sdof system to apply the present results of tested samples to the large size ropes a non dimensionalised method is used in particular the line tension f and the stiffness e a are normalised with respect to the minimum breaking strength m b s under these assumptions for the intact fiber rope of the same structure type the small scaled test results can be used to estimate the large scale fiber ropes under the same stress level here the stress of the rope element is σ f m b s the strain of the rope element is ε δ l l 0 and the total mass of an element of fiber ropes is m in addition the dynamic stiffness is defined as abs 2011 3 k r e a m b s t n p t n 1 t m b s ε n p ε n 1 t where k r denotes the dimensionless dynamic stiffness t n p and ε n p are the peak tension and the corresponding strain of the nth tension elongation hysteresis loop respectively t n 1 t and ε n 1 t are the trough tension and the corresponding strain of the n 1 th tension elongation hysteresis loop respectively where n 2 according to theory of structural dynamics chopra 2012 the differential equation governing the response of sdof systems to the harmonic stress σ σ m σ 0 sin ω t ϕ 1 is 4 m d 2 ε d t 2 η d ε d t k ε σ m σ 0 sin ω t ϕ 1 dividing eq 4 by m gives 5 d 2 ε d t 2 2 ξ ω n d ε d t k m ε σ m m σ 0 sin ω t ϕ 1 m where the natural circular frequency of vibration ω n and the damping ratio ξ are defined as 6 ω n k m ξ η 2 k m based on the assumption that the testing fiber rope is the single degree of freedom system the right part of eq 5 is considered as the superposition of simple functions of a step constant excitation and a harmonic vibration hence eq 5 can be written as 7 d 2 ε 1 d t 2 2 ξ ω n d ε 1 d t k m ε 1 σ m m 8 d 2 ε 2 d t 2 2 ξ ω n d ε 2 d t k m ε 2 σ 0 sin ω t ϕ 1 m eq 7 describe the problem of a sdof system subjected to a step function in acceleration with the condition that the mass starts at rest the general solution can be written as 9 ε 1 ε 1 c t ε 1 p t where ε 1 c t and ε 1 p t are the complementary and particular solution respectively the complementary one can be written as 10 ε 1 c t ⅇ ξ ω n t a cos ω n 2 1 ξ 2 t b sin ω n 2 1 ξ 2 t the particular solution which is the steady state solution can be written as 11 ε 1 p t σ m m ω n 2 σ m k substituting eq 10 and eq 11 into eq 9 leads to 12 ε 1 ⅇ ξ ω n t a cos ω n 2 1 ξ 2 t b sin ω n 2 1 ξ 2 t σ m k where a and b are constants which can be expressed in terms of the initial conditions 13 a ε 0 b ε 0 ξ ω n ε 0 ω n 1 ξ 2 in addition for eq 8 governing the response of sdof systems to harmonic force the particular solution is 14 ε 2 p t c sin ω t ϕ 1 d cos ω t ϕ 1 where 15 c σ 0 k 1 ω ω n 2 1 ω ω n 2 2 2 ξ ω ω n 2 16 d σ 0 k 2 ξ ω ω n 1 ω ω n 2 2 2 ξ ω ω n 2 the complementary solution of eq 8 is the free vibration response which can be written as 17 ε 2 c t ⅇ ξ ω n t a cos ω n 2 1 ξ 2 t b sin ω n 2 1 ξ 2 t where a and b are constants which can be expressed in terms of the initial conditions as shown in eq 13 the complete solution of eq 8 is 18 ε 2 ⅇ ξ ω n t a cos ω n 1 ξ 2 t b sin ω n 1 ξ 2 t c sin ω t ϕ 1 d cos ω t ϕ 1 for sufficiently long time t eq 18 approaches eq 14 in the limit hence the steady state deformation of the system due to harmonic force can be written as 19 ε 2 ε 0 sin ω t ϕ 1 δ ϕ ε s t 0 r d sin ω t ϕ 1 δ ϕ where ε 0 c 2 d 2 is the strain amplitude δ tan 1 d c is the phase lag ε s t 0 is the maximum value of the static deformation and r d is the deformation response factor which is defined as the ratio of the response amplitude ε 0 over the static deformation ε s t 0 substituting for c and d gives the following equations 20 ε s t 0 σ 0 k 21 r d ω ω n ξ ε 0 ε s t 0 1 1 ω ω n 2 2 2 ξ ω ω n 2 22 δ ϕ arctan 2 ξ ω ω n 1 ω ω n 2 hence based on eqs 5 8 12 18 22 the solution of eq 5 is obtained 23 ε 2 ⅇ ξ ω n t a cos ω n 1 ξ 2 t b sin ω n 1 ξ 2 t ε s t 0 r d sin ω t ϕ 1 δ ϕ σ m k in addition based on the exist test results of fiber ropes the stress strain hysteresis loops become nearly stable after a certain number of load cycles the strain response can be simulated by a sine function 24 ε ε m ε 0 sin ω t ϕ 2 where ε is the strain ε m is the mean strain ε 0 is the strain amplitude and ϕ 2 is the phase of strain moreover the stress response can be simulated by 25 σ σ m σ 0 sin ω t ϕ 1 where σ is the stress σ m is the mean stress σ 0 is the stress amplitude hence by comparing eq 23 with eq 24 the following equations can be obtained 26 ε m 2 ⅇ ξ ω n t a cos ω n 1 ξ 2 t b sin ω n 1 ξ 2 t σ m k 27 ε 0 σ 0 k r d ω ω n ξ σ 0 k 1 1 ω ω n 2 2 2 ξ ω ω n 2 28 ϕ 2 ϕ 1 δ ϕ arctan 2 ξ ω ω n 1 ω ω n 2 due to eq 26 shows that the mean strain changes with time therefore eqs 27 and 28 are utilized to obtain the internal damping coefficient the dynamic stiffness and the internal damping coefficients of fiber ropes can be determined using the experimental test result in following proposed procedure first to investigate the internal damping behavior of fiber ropes we define the parameter k as the dynamic stiffness k r according to the theory of structural dynamics hence k r can be analytically evaluated using the empirical formula of the dynamic stiffness which is a function of the mean load and load amplitude of fiber ropes this empirical formula of the dynamic stiffness is consistent with previous studies by del vecchio 1992 davies et al 2002 and lian et al 2017b thus the value of the parameter k can be obtained readily using eq 27 k is written as 29 k def k r e a m b s m ω 2 σ 0 ε 0 1 tan 2 δ ϕ next the total mass of the rope element is calculated as 30 m ea m b s σ 0 ε 0 1 t a n 2 δ ϕ ω 2 hence the natural circular frequency of vibration ω n k m is obtained then according to eq 28 the damping ratio can be obtained by 31 ξ tan δ ϕ 1 ω ω n 2 2 ω ω n finally using eq 6 and eq 31 the coefficient of the internal damping can be given as 32 η 2 k m ξ therefore based on eqs 29 32 the method for determining the internal damping coefficient is complete in addition the relation between the dynamic stiffness and the internal damping coefficient for fiber ropes is established here the physical relationship between the dynamic stiffness and the internal damping coefficient of fiber ropes exists in the hysteresis loop of fiber ropes which indicates the viscoelastic behavior the secant slope of the hysteresis loop determines the dynamic stiffness the area of the hysteresis loop is related to the value of the internal damping coefficient given that the sdof system consists of spring and dashpot models the tsd method has the capability to capture the behavior of the hysteresis loop 3 2 validation of the proposed method for determining the internal damping coefficient to validate the theory of structural dynamics for determining the internal damping coefficient proposed in this study the indicator diagram method idm webster 1995 johanning et al 2007 is introduced the idm is used to calculate the mooring line damping induced by the drag force under the excitation of the motions of floating structures webster 1995 the method needs both the top end horizontal or vertical displacement and line tension data to determine the area within a closed loop of the tension displacement curve this area is proportional to the energy dissipation from which the damping can be estimated johanning et al 2007 the damping coefficient can be obtained as follows 33 η e d π ω χ 2 e l o a d e u n l o a d π ω χ 2 where η is the damping coefficient and e d is the energy dissipated over each load unload cycle which equals the area of the hysteresis loop that can be calculated by utilizing the method of trapezoidal integration in the origin 8 0 software originlab 2007 here e l o a d is the energy when the tested rope is loading e u n l o a d is the energy when the tested rope is unloading ω is the angular frequency of vibration and χ is the amplitude of strain based on the indicator diagram method and the theory of structural dynamics tsd for determining the damping coefficient these for the aramid rope under two cyclic loads l m 18 40 a b s l a 5 772 a b s t 3 8776 s and l m 10 a b s l a 4 059 a b s t 1 8212 s and the internal damping coefficient of the polyester rope under two cyclic loads l m 24 87 a b s l a 1 769 a b s t 3 8752 s and l m 10 a b s l a 1 029 a b s t 3 8770 s are obtained and the results are shown in table 3 from the simulation results it can be observed that the damping coefficient of the double braided aramid rope is higher than that of three strand construction polyester as shown in table 3 the reason may be that the damping coefficient are affected by fiber material rope constructions and load conditions in addition to validate the present method the internal damping coefficent of the nylon 6 fiber rope under a cyclic load l m 20 277 a b s l a 2 2679 a b s t 25 s is obtained using 10 representative cycles experimental data of the nylon 6 ropes at stable state the data come from the cyclic tests of the rope sample 3 subjected to load set ls2 in the literature weller et al 2014 the stress time strain time and hysteresis loop curves of the 10 representative cycles cycle number from 15 to 25 are shown in fig 4 by using the sine function in eq 2 and the theory of structural dynamics tsd for determining the damping coefficient the corresponding damping coefficient values are obtained and listed in table 3 from table 3 it also can be observed that the average relative error of the damping coefficient between the idm and the tsd predictive methods is small thus together with the good comparisons with experimental and the complex viscoelastic viscoplastic model prediction the proposed simple method based on the theory of structural dynamics tsd for capturing the internal damping coefficient is accurate 4 further experimental validation 4 1 experimental system and test samples 4 1 1 experimental system to further validate the proposed method tsd for determining the internal damping coefficient long term cyclic tests of hmpe ropes are performed using a special experimental system the experimental system as shown in fig 5 a consists of four parts the loading elements fig 5 b and c the water cycling system fig 5 d the rope measurement system and the equipment foundation fig 5 d see also lian et al 2017a b 2018 the loading elements include the dynamic and static loading components fig 5 b and c respectively the dynamic loading component provides cyclic loads to the test rope the static loading component provides the pre tension or mean tension to the sample the water cycling system is fabricated using two water tanks and pumps to simulate the water environment of the fiber ropes the elongation measurement system is composed of a wire transducer two axletrees clamps and a mounting system the axletrees are installed above the outer water tank there are two sliding blocks which can move smoothly on the axletrees one serves as the base for the wire transducer and the other is used to hold the wire in place in addition to determine elongation of the rope in the test region two specially designed clamps are installed under the sliding blocks as shown in fig 5 d both clamps have an inward curving form to hold the gauge marks of the tested rope using bolts and nuts each tested rope is installed with a protecting sheath made of an aramid jacket between the two clamping pieces this ensures that potential failure of rope samples would not occur at the clamps the protecting sheath effectively eliminates the effect of stress concentration and avoids potential damage to rope samples caused by the clamps the gage length between the two gauge marks of the rope sample is 300 mm in the present study to measure tension values of test ropes a loading sensor is installed on the termination of the static loading device the precision of the load measurement is 5n and the wire transducer is 0 1 mm the loading cell and wire transducer are calibrated according to the standard calibration procedures provided by the manufacturer overall the present experimental set up has the capability to simulate working state of fiber ropes thus can be used to effectively study the internal damping behavior of fiber ropes under the specified axial harmonic loads however to investigate the mooring induced damping of tested ropes a new experimental set up would be required because the mooring induced damping of tested ropes is controlled by the transverse vibration webster 1995 fan et al 2017 4 1 2 test samples the hmpe fiber rope studied has a 12 strand construction comprising dyneema sk75 fibers as shown in fig 6 a the rope was supplied by jiuli ropes co ltd the hmpe fiber was produced by dsm dyneema the diameter and the linear density mass per unit length of the rope are 0 006 m and 24 g m respectively see fig 6 a the cross section of the rope is illustrated in fig 6 b the geometrical parameters of the rope are pitch distance p and helix angle β of the rope components sub rope are equal to 40 mm and 20 respectively and the sub rope radius is equal to 2 mm that allows the computation of the helix radius a which is the distance from the core axis to the longitudinal axis of a component the helix radius is 2 637 mm the pitch distance measures the length along the core axis for a component to go through a swept angle that varies from 0 to 2 π and the helix angle is defined as the angle between the centerline of the helical component with the centerline of the core see fig 6 b the average breaking strength abs and standard deviation of the tested ropes obtained from our tests are 27 8 kn and 2 0 kn respectively 4 2 experimental cases and procedures 4 2 1 experimental cases to further validate the present method 9 test cases of the hmpe ropes are designed as listed in table 4 experimental loading parameters of the hmpe ropes are listed in table 4 in which l m denotes the mean tension of cyclic loads l a denotes the load amplitude and a b s denotes the average breaking strength the values of l a and l m are selected at the high loading ranges due to the following two factors one the experimental set up can provide more stable and accurate tension at high loading value for hmpe ropes which shows higher modulus than that of other ones two the high loading range corresponds to high sea state conditions which are of most concern for engineering design cases 1 3 are designed to investigate the effect of the mean load on the internal damping coefficient of hmpe ropes under the condition of fixed load amplitude and cyclic load period cases 4 6 are designed to further investigate the effect of mean loads on the internal damping coefficient of hmpe ropes cases 7 9 are designed to investigate the effect of the cyclic load period on the internal damping coefficient of hmpe ropes furthermore cases 1 4 and 7 are designed to investigate the effect of load amplitude on the internal damping coefficient of hmpe ropes here all tests are carried out and the experimental data are captured by utilizing the present experimental set up each experimental case is performed at least twice to ensure repeatability and reliability of the measured data 4 2 2 experimental procedure the detailed experimental procedure is delineated as follows first to install the rope sample to the machine the eye splice method is adopted based on the fact that eye spliced termination can provide reliable test results for the present rope splices a permanent loop an eye in the end of a rope which denotes the tested rope termination is created by means of rope splicing the total length of the sample the length of the splice and the gauge length in the middle of the sample are 2 4 m 0 3 m and 0 3 m respectively this ensures that the gage part of the sample would not be affected by rope spliced terminations next the bedding in process is performed for all samples before cyclic tests this process reduces the constructional stretch and increases rope and termination efficiencies api 2015 the present bedding in process includes a constant load up to 50 minimum breaking strength mbs and a cyclic load whose mean load is 20 mbs and load amplitude is 10 mbs for 100 cycles note that the minimum breaking strength is the wet breaking strength guaranteed by the rope manufacturer for a specific rope in the present investigation the average breaking strength abs is approximately regarded as mbs value was not provided by the rope manufacturer after completing the bedding in process the sample is unloaded to 200n to take up the slack and to measure the gauge length finally the sample is loaded according to a test case in table 4 at the temperature 25 c each sample is initially loaded at a rate of 50n s until it arrives at a setting fixed mean load l m then the mechanical wheel begins to roll to provide cyclic loads the control system of the static element is then applied to prevent the mean load from drifting data acquisition rate of the measurement system is set at 9 points per second the measured data are auto saved in the computer 5 results and discussion 5 1 test results of hysteresis loops based on results from the experimental cases and procedure described above stress time strain time and hysteresis loop curves of hmpe ropes for each case are obtained for example the results of the hmpe samples under the load condition of case 5 l m 65 abs l a 11 5 abs which corresponds to a storm condition are shown in fig 7 the stress time curve of case 5 is shown in fig 7 a the figure indicates that the boundary line of the peak stress value is parallel with the boundary line of the trough stress until the sample fails the inset in the figure shows that a short section of the stress time curve is a sine function the results demonstrates that the current experimental set up provides the required cyclic tension the strain time curve of case 5 shown in fig 7 b illustrates that the strain envelopes contain three stages reflecting the creep like response under cyclic loads and the insect in fig 7 b indicates the strain curve of cyclic tests is a sine function which changes between the peak and trough strains in per cycle fig 7 b also shows that the strain time curve of hmpe ropes under cyclic loads is different from the one of hmpe ropes under constant loads see fig a1 which shows a typical characteristic response to constant loads see lian et al 2015 2018 the stress strain curve in fig 7 c shows the area of hysteresis loops for all cycles the data indicates that the area of the stress strain curves looks like the sum of all hysteresis loop curves to clearly illustrate the evolution of hysteresis loop of hmpe ropes the hysteresis loops at different cycles n 300 1555 4147 9331 14515 19699 24883 30067 35251 40435 45619 50802 61170 66354 71538 76722 are plotted in fig 7 d these cycles show that the area of hysteresis loop is stable after the test sample experienced 300 load cycles fig 7 d further indicates that the dynamic stiffness and the internal damping of fiber ropes become stable after the ropes had experienced sufficient number of load cycles which is consistent with the research results in the literature banfield and casey 1998 casey et al 2000 huang et al 2015 the results also indicate that the number of load cycles only affects the horizontal position of stable hysteresis loops for hmpe ropes 5 2 simulations of hysteresis loops of hmpe ropes to analyze the internal damping properties of the hmpe rope under cyclic loads 10 representative cycles experimental data of the hmpe ropes at stable state after the samples had experienced sufficient load cycles are used for example the stress time strain time and hysteresis loop curves of the 10 representative cycles cycle number from 79170 to 79180 for case 5 l m 65 abs l a 11 5 abs t 1 928 are shown in fig 8 by using the sine function in eq 2 the corresponding coefficient values for the experimental stress time and strain time curves are obtained and listed in table 5 the correlation coefficients between experimental values and simulation results for both the stress time and strain time curves were computed and are found to be 0 99 hence there is an excellent agreement between the measured data and the simulation results using the sine function based on the observed results the sine function in eq 2 is employed in all the nine testing cases listed in table 4 to capture the hysteresis loops comparisons between the simulation results of sine functions and experimental data of hysteresis loops for the nine cases are performed as shown in fig 9 through 11 both figs 9 and 10 show the effect of changes in mean load on the hysteresis loops of hmpe ropes specially these figures together with table 6 indicate that the vertical centroidal position maximum and minimum stresses of the stable hysteresis loops increases with increasing mean stress i e y 0 in eq 2 and the horizontal centroidal position maximum and minimum strains of stable hysteresis loops also increases with increasing mean strain which depends on the cycle number of the fiber rope experienced in fig 9 the stable hysteresis loops of cases 1 3 at different horizontal centroidal locations are caused by their different mean strains which are determined by their loading levels and loading cycle numbers based on observation of the evolution of hysteresis loops shown in fig 7 d the loading cycle number only affects the horizontal position of hysteresis loops but does not affect the area of the stable hysteresis loops for hmpe ropes under the same cyclic load condition considering the present study is focused on the area of the hysteresis loop for cyclic load condition and the areas of the stable hysteresis loops at different horizontal position are practically identical therefore any one of the stable hysteresis loops at a given cycles can be used to estimate the internal damping coefficient under the cyclic load condition from fig 9 it can be observed that the hysteresis loop of case 3 has an offset towards the right this is because the centroidal loop strain which is affected by the load cycle number is purposely selected to be different from that of cases 1 and 2 hence the centroids of the three ellipses do line up in a straight line however the area of the stable hysteresis loop of case 3 remains unaffected with respect to the centroidal positon similarly fig 10 shows that the horizontal central position i e the mean strain of the stable hysteresis loops of cases 4 6 are affected by their cycle numbers reinforcing the observation above although the horizontal central positions of the loops seems to be irregular due to their different selected mean strain the area of the stable hysteresis loop continues to reflect the hysteresis energy of each case the reason is that the area of the stable hysteresis loop is not change with the horizontal central position mean strain of the loop and any one of the stable hysteresis loops at arbitrarily selection cycle can be used to obtain the internal damping coefficient within the same load case in addition fig 11 shows the area of the hysteresis loops becomes narrower with increasing load period this observed physical phenomena is consistent with previous research by banfield and casey 1998 which showed that the hysteresis energy resulting from the test at a 3 s period is about 40 greater than the energy resulting from the test at 6 s cyclic period for the tested 120 tonne force polyester rope at 20 10 mns manufacturer nominal strength sinusoidal loads the reason that the area of hysteresis loops decreases with increasing loading period may be that the longer cyclic period the smaller the increase in temperature differential with the environment and hence the smaller the heat exchange which will dissipate less energy this causes the hysteresis energy namely the area of hysteresis loop to decrease however fig 11 illustrates that the loading period has little effect on the dynamic stiffness which is proportional to the secant slope of the loops in addition fig 12 shows that the area of stable hysteresis loops increases with increasing load amplitude the figure also shows that the stable hysteresis loop position of case 4 is much different from that of cases 1 and 7 the reason is that the mean strain of the loop of case 4 is different from that of other cases see table 6 changing the horizontal position of the loop do not affect the area of the hysteresis loops based on the observation that the amount of energy dissipated per cycle for any one of the stable hysteresis loops at different position under the same load case remains constant results obtained from the test data presented shown in fig 13 confirms this observation note that in fig 12 the area of hysteresis loop increase from case 1 to case 7 but the internal damping coefficient presented in table 7 decreases this phenomenon occurs due to the fact that the internal damping coefficient is determined by the area of the hysteresis loop e d the angular frequency of vibration ω and the amplitude of the strain χ according to eq 33 the relation between the internal damping coefficient and the area of hysteresis loops for case 1 4 and 7 is confirmed by the data presented in table 6 overall good agreement between numerical simulation results of sine functions and the experimental data in figs 9 12 demonstrates that the sine function can describe the stable hysteresis loop of fiber ropes 5 3 internal damping coefficients of hmpe ropes under different load conditions based on the results presented above the area of the stable hysteresis loops remains constant after the transient effect of load cycles become negligible hence the area of the stable hysteresis loops can be used to estimate the internal damping coefficient for any given cyclic load condition for different cases of the hmpe samples the dynamic stiffness and the internal damping coefficient of stable hysteresis loops are calculated and listed in table 6 the dynamic stiffness values are calculated using the definition in eq 3 these dynamic stiffness values can also be evaluated by the empirical equation presented in the reference lian et al 2017b which shows it is a function of the mean load and the load amplitude of fiber ropes in addition the internal damping coefficients calculated by the theory of structural dynamics tsd are compared with the results from the indicator diagram method idm observe that their relative error is quite small which further indicates that the present method tsd is capable of determining the internal damping coefficient of fiber ropes moreover the present model shows the relation between the dynamic stiffness and the internal damping coefficient which helps to estimate the internal damping coefficient in addition the results of cases 1 to 6 show that the internal damping coefficient increases with the increasing mean stress of fiber ropes the results of cases 7 to 9 indicate that the internal damping coefficient decreases with increasing load periods the results of cases 1 4 and 7 illustrate that the internal damping coefficient decreases with increasing load amplitude 6 concluding remarks in the present study numerical results of schapery s viscoelastic and owen s viscoplastic model are compared with the measured data of aramid and polyester ropes the results show that the viscoplastic effect on hysteresis loops is negligible but the viscoelastic effect is significant the viscoelastic viscoplastic model can simulate the time dependent behavior of fiber ropes well in terms of the slope of hysteresis loop but there appears still room for improving the accuracy of describing the hysteresis loops particularly to reduce the complexity of the model and associated involved computations a simple sine function to describe the hysteresis loops and a novel method for determining the internal damping coefficient of fiber ropes was proposed the simple model assumes that the fiber rope is intact the effects of bending stresses and torsion and the effect of the helical rope composition on different size ropes are negligible by applying the non dimensionalised method and the theory of structural dynamics tsd in addition the relation between the internal damping coefficient and dynamic stiffness of fiber ropes is established compared with the numerical results from viscoelastic and viscoplastic model the numerical simulation hysteresis loops from sine functions are found to fit more closely the experimental data of aramid and polyester ropes the good agreement between the results of internal damping coefficients from the proposed method of theory of structural dynamics tsd and the results of the indicator diagram method idm for the aramid and polyester cases shows the accuracy of the proposed method moreover to further validate the proposed method systematic experimental tests of hmpe ropes under different cyclic loads were performed the evolution of hysteresis loops obtained from the test results shows that the area of the steady state hysteresis loop remains almost constant under the condition that the tested rope is intact which are consistent with the observations of other researchers hence the internal damping coefficient calculated from any one of the stable hysteresis loops is reasonable by analyzing the experimental hysteresis loops of hmpe ropes the internal damping coefficients are calculated from the indicator diagram method idm and the theory of structural dynamics tsd respectively the relative error of internal damping coefficients between these two methods is small this further proves that the proposed method is feasible to determine the internal damping coefficient of fiber ropes in addition the experimental results of hmpe ropes show that the internal damping coefficient increases with increasing mean load and decreases with increasing load amplitude and load periods of fiber ropes the present investigation helps to improve the understanding of the internal damping behavior of fiber ropes therefore it may help to evaluate the internal damping coefficient of fiber mooring ropes and incorporate the viscoelastic effect of fiber ropes in engineering application in the future additional experimental research work will be performed to develop empirical formulae for calculating the internal damping coefficient for fiber ropes fig a1 a typical strain time curve in creep rupture tests fig a1 acknowledgements the authors greatly appreciate the financial support from the national natural science foundation of china grant nos 51609079 and 51539008 and the fundamental research funds for the central universities of china grant no 2017b11314 the senior author and s yim thank the international postdoctoral exchange fellowship program 2017 grant no 20170013 for his two year study at oregon state university 
22813,to improve the understanding of the damping behavior of fiber ropes a novel method for calculating the internal damping coefficient of these ropes based on the theory of structural dynamics tsd is proposed by comparing the damping values from the indicator diagram method idm utilizing experimental data of aramid polyester and hmpe ropes the proposed tsd method clearly shows the relation between the internal damping coefficient and dynamic stiffness of the fiber ropes the relative error of the internal damping coefficients calculated by these two methods is small which proves the accuracy of the tsd method in addition the experimental results of hmpe ropes show that the area of the hysteresis loop remains almost constant after the samples had experienced sufficient number of load cycles the test results also indicate that the damping coefficient increases with increasing mean load but decreases with increasing load amplitude and load periods hence the present study can help developers capture the internal damping behavior of fiber ropes leading to an efficient technology for mooring analysis and allowing efficient implementation of the viscoelastic concept of fiber mooring ropes to engineering applications keywords fiber rope internal damping hysteresis loop viscoelastic dynamic stiffness mooring 1 introduction mooring systems are vital to the station keeping of floating structures in industrial applications there are mainly two types of permanent mooring systems catenary and taut wire the main sections of catenary mooring systems are chains or wire ropes which provide the restoring force based on the weights of suspended segments the disadvantages of the catenary mooring systems include higher weight of mooring lines less payload of floating structures and larger mooring footprint coming from the long chains or wire ropes to avoid these drawbacks of catenary moorings fiber ropes are often utilized in taut wire mooring systems to provide the restoring force based on axial elongation of the fiber ropes beltran 2006 mohanraj et al 2011 weller et al 2014 lian et al 2018a b c the advantages of using fiber ropes in moorings include low cost light weight and ease of handling in addition the taut wire mooring system helps to save the space of mooring systems and avoid collision with other elements because the taut wire mooring system occupies a smaller footprint than catenary ones banfield and casey 1998 johanning et al 2007 abs 2011 api 2015 based on these advantages taut wire mooring systems have potential to be employed in wave energy converter wec arrays which require small footprint moorings johanning et al 2007 weller et al 2013 2014 2015a b hence fiber ropes have become one of the most suitable substitutes for wire ropes or chains in mooring systems however fiber ropes show complex nonlinear behaviors which is quite different from the behaviors of chains or wire ropes hence a number of detailed studies had been performed over the years to try to understand the damage tolerance property li et al 2002 ward et al 2006 beltran and williamson 2005 beltran and de vico 2015 beltran et al 2017 the viscoelastic mechanics davies et al 2003 flory et al 2004 johanning et al 2007 derombise et al 2011 weller et al 2013 huang et al 2015 lian et al 2015 2018 creep properties davies et al 2003 vlasblom and bosman 2006 leite and boesten 2011 lian et al 2018a b c fatigue behaviors banfield et al 2000 2005 banfield and ridge 2017 lian et al 2017a b dynamic stiffness del vecchio 1992 davies et al 2002 liu et al 2014 2015 loading history effect weller et al 2014 2015a b lian et al 2018a b c and damping behavior johanning et al 2007 weller et al 2013 2014 of the fiber ropes note that the damage distribution properties degradation and damage tolerance of fiber ropes had been systematically studied for example li et al 2002 performed small scale experiments on damaged sub ropes and elements beltran and williamson 2005 investigated the degradation of rope properties under an increasing monotonic load ward et al 2006 performed full scale tests on damaged fiber ropes and developed guidelines for the damage tolerance of polyester ropes beltran and de vico 2015 assessed the effect of damage distribution on the static rope behavior beltran et al 2017 analysed the effects of strain localization and damage distribution on the static behavior of polyester ropes hence this paper here focuses on the nonlinear behavior of fiber ropes under the intact condition understanding the effects of the nonlinear properties of the intact fiber ropes on mooring systems is vital to design economical and reliable fiber mooring systems for floating structures particularly the dynamic stiffness and damping of mooring lines are two key parameters that affect the response of floating structures weller et al 2014 xu et al 2018 the dynamic stiffness of the fiber mooring ropes affects the mooring stiffness and horizontal offset of floating structures davies et al 2002 lian et al 2017a b damping of the mooring system affects the surge and sway motions of the floating structures such as fpso and wec huse 1986 weller et al 2014 the main sources of damping of the mooring system include wave drift viscous dissipation wave radiation from the floating structure and mooring line damping the damping of a catenary mooring line arises from the line friction on the sea bed internal line damping and from the drag force on the line bauduin and naciri 2000 johanning et al 2007 damping of the mooring line can contribute up to 80 of total system damping molin 1994 hamilton and kitney 2004 therefore investigating the damping properties of the mooring lines is important and necessary numerous researches had been performed to investigate the mooring line damping and the effects of mooring damping on the motion response of floating structures a quasi static method and an indicator diagram method for calculating damping coefficients were proposed by analyzing the experimental results or mathematical modeling results for example to understand the effects of the damping of mooring lines on the response of a floating platform huse 1986 originally proposed the quasi static method for estimating the energy dissipation of mooring lines liu and bergdahl 1998 improved huse s method by improving the predictive accuracy on the transverse motion amplitude of line elements bauduin and naciri 2000 improved the predictive capability of the quasi static approach based on a more accurate description of the normal displacements and the drag forces on the mooring line to address the drawbacks of the quasi static method which was deemed not sufficiently accurate to capture the damping behavior of non linear response of mooring lines an indicator diagram method was proposed by webster 1995 the method utilizes the area of the hysteresis loop curve at the top of mooring line to describe the dissipated energy caused by the mooring line based on the tension and horizontal motions at the top end of mooring line since then the indicator diagram method has been widely used to obtain the energy dissipation and damping of the mooring line brown and mavrakos 1999 johanning et al 2007 weller et al 2014 2015a b xu and anderson 2015 yang et al 2016 xu et al 2018 fan et al 2017 improved the indicator diagram method to calculate the damping coefficient of the mooring line in the truncation design of mooring systems fan et al 2018 utilized the static and damping equivalence to design the equivalent truncated mooring systems in addition xu et al 2018 showed the relation between the damping of hybrid moorings and horizontal motion responses and they found that pretension of mooring lines significantly affects mooring damping as described above most research calculated the damping of mooring lines however few studies have focused on the internal damping of mooring line due to the viscoelastic property of fiber ropes under the specified axial harmonic forces except weller et al 2014 2015a b who performed the experiments on nylon ropes to calculate the damping coefficient based on the indicator diagram method their results showed that both the damping coefficient and the dynamic stiffness of fiber ropes depended on the mean load levels weller et al 2014 however the damping evolution of fiber ropes and the relation between the dynamic stiffness and damping coefficient of fiber ropes are not clearly known to date a method for capturing the damping coefficient and establishing the relation between the damping coefficient and dynamic stiffness is needed in the present study a schapery s viscoelastic and owen s viscoplastic model which describes the complex mechanics of fiber ropes well huang et al 2015 is first reviewed the prediction results obtained by the viscoelastic and viscoplastic theory huang et al 2015 are compared with the experimental hysteresis loops of aramid and polyester ropes then to improve the accuracy of method for describing the hysteresis loops a simple function to describe the hysteresis loops and a method for determining the damping coefficient of fiber ropes based on the theory of structural dynamics is proposed numerical simulation results of hysteresis loops and damping coefficients are compared with existing experimental data for both aramid and polyester ropes moreover to further validate the proposed method for accurately capturing hysteresis loops and the damping coefficient of fiber ropes systematic cyclic tests of hmpe ropes are performed effects of the cyclic load period mean tension and tension amplitude on the damping coefficient of fiber ropes are studied the present study not only improves the understanding of the damping behavior of fiber ropes but also helps to incorporate the viscoelastic concept in engineering applications of mooring systems 2 analytical description of hysteresis loops 2 1 viscoelastic and viscoplastic models in general fiber ropes including aramid polyester and hmpe ropes often show complex viscoelastic and or viscoplastic behaviors hence many numerical and experimental studies on the mechanical properties of synthetic fiber ropes have been performed for example flory et al 2004 2007 proposed a physical spring dashpot model to describe the elongation properties of fiber ropes under different load conditions but their studies were limited to qualitative analysis only chailleux and davies 2003 2005 utilized schapery s viscoelastic and perzyna s viscoplastic model to quantify the creep recovery response of aramid and polyester fiber samples but they did not extend to cyclic load conditions due to the nonlinear viscoelasticity and viscoplasticity of fiber ropes significant hysteresis arises under cyclic loads to quantify the hysteresis loop of synthetic fiber ropes under cyclic loads huang et al 2015 employed the schapery s viscoelastic and owen s viscoplastic theory shown here in eq 1 1 ε ε v e ε v p ε v e g 0 d 0 σ t g 1 0 t δ d ψ t ψ τ d g 2 σ d τ d τ ψ t 0 t d s a σ σ s δ d ψ n 1 n d n 1 e λ n ψ ε v p 0 t 1 h 1 e h η p t e τ d σ σ y 0 d τ d τ w h e n σ σ y 0 where ε is the total strain ε v e is the viscoelastic strain calculated by the schapery s viscoelastic model and the second term of the viscoelastic strain controls the damping behavior of fiber ropes ε v p is the viscoplastic strain which is calculated based on the owen s viscoplastic model σ t is the stress g 0 g 1 g 2 and a σ are the stress dependent nonlinear parameters d 0 is the instantaneous compliance ψ is the reduced time δ d ψ is the transient compliance n is the number of items d n is the nth coefficient in the prony series λ n is the nth reciprocal of retardation time σ y 0 is the initial yield stress h is the hardening parameter η p is the viscosity constant and t e is the effective time of the viscoplastic strain based on the model of eq 1 the total strain of fiber ropes can be calculated and the hysteresis loop can be described note that the viscoelastic model can describe the hysteresis loop reflecting the viscoelastic effect the viscoplastic model can be used to calculate the viscoplastic strain which occurs when the stress is higher than the initial yield stress the viscoelastic viscoplastic model developed by huang et al 2013 2015 in which the first two authors of this study participated appear to be sufficiently good models for hysteretic damping behavior of fiber ropes to assess the predictive capability of the viscoelastic viscoplastic model described in eq 1 we developed a numerical model implemented the equation numerically to simulate the stable hysteresis loops of two types of fiber ropes one is an double braided aramid rope under a cyclic load l m 18 40 abs l a 5 772 abs t 3 8776 s and the other is a three strand construction polyester rope under a cyclic load l m 24 87 a b s l a 1 769 a b s t 3 8752 s where l m l a t and a b s denote the mean load the load amplitude the cyclic load period and the average breaking strength respectively comparison between the numerical results from the viscoelastic viscoplastic model and experimental data of hysteresis loops for these two type fiber ropes is presented in fig 1 the results show that the viscoelastic viscoplastic model can capture the time dependent behavior of fiber ropes well in general even though the hysteresis loop calculated by the viscoelastic viscoplastic model have a small offset towards right compared to the loop calculated by the viscoelastic model the viscoplastic effect on hysteresis loops is negligible because the viscoplastic strain is very small compared to the viscoelastic one note that the viscoelastic strain is the main part of total strain the difference between numerical results from viscoelastic viscoelastic viscoplastic model and experimental data maybe due to the accuracy of model parameters which is a challenge to be determined in these complex models overall the prediction results obtained by utilizing schapery s viscoelastic and owen s viscoplastic theory huang et al 2013 2015 agree well with the experimental hysteresis loops of aramid and polyester ropes in terms of the slopes of the stable hysteresis loops considering that the numerical results is calculated based on estimated model parameters however there appears still room for improving the accuracy of numerical hysteresis loops calculated by the complex model in particular to capture the viscoelastic effect of fiber ropes and to avoid the complexity of the model and involved computations a simple and accurate method for describing the hysteresis behavior is proposed here 2 2 sine function method for describing stable hysteresis loops to simplify the computations and possibly improve the accuracy of the simulation results of the hysteresis loops obtained by the viscoelastic viscoplastic model of huang et al 2013 2015 we propose a simple trigonometric function method in this study this simple method is based on previous experimental observation that the stress strain hysteresis loops become nearly stable for a bedded in rope after a certain number of load cycles at 20 10 abs sinusoidal load for sufficiently low amplitude loads where there is no damage to the rope stable loops can be observed under sinusoidal cyclic loads banfield and casey 1998 casey et al 2000 huang et al 2015 here we propose to model the stable hysteresis loop curves a sine function with selected initial phases as follow 2 y y 0 y a sin ω t ϕ 0 where y is the experimental data of stress or strain y 0 is the mean value of stress or strain y a is the amplitude ω is the angular frequency of vibration t is the loading time and ϕ 0 is the initial phase the difference of initial phases between the strain time and stress time curves indicates the phase shift which is related to the value of transient compliance δ d ψ in eq 1 eq 2 shows the physical meaning that the rope is approximated by an axial harmonic motion the experimental data of aramid and polyester ropes presented in fig 1 is used to assess and validate the feasibility of the sine function for simulating the stable hysteresis loops of fiber ropes for the case of aramid ropes l m 18 40 a b s l a 5 772 a b s t 3 8776 s the experimental data including stress time strain time and hysteresis loop curves of 10 representative cycles cycle number from 775 to 785 are plotted in fig 2 it is observed that the experimental data in fig 2 are well approximated by the sine function in eq 2 the coefficients of the sine function for the experimental data of aramid rope are obtained using a least square method and listed in table 1 for the case of polyester ropes l m 24 87 a b s l a 1 769 a b s t 3 8752 s 10 representative cycles cycle number from 335 to 345 of the experimental data of polyester ropes at the stable state after the transient load cycle effects had dissipated are utilized following the same method the simulation results of the polyester rope are shown in fig 3 and the corresponding coefficients of the sine function are listed in table 2 for both the aramid and the polyester ropes the correlation coefficients between experimental values and simulation results for the stress time and strain time curves both equal to 0 99 hence there is a excellent agreement between the measured data and the simulation results obtained by the sine functions in addition the simulations of the sine functions agree well with experimental data of hysteresis loops as shown in figs 2 c and 3 c moreover by comparing these two figures with fig 1 it shows that the sine function method is more accurate than the schapery s viscoelastic and owen s viscoplastic theory in terms of the simulation results of hysteresis loops this means the sine function method as shown in eq 2 is capable of describing the stable hysteresis loops more accurately and in a much simpler manner results in tables 1 and 2 show that for any one of tested ropes the vibration periods of these two sine functions for simulating stress time and strain time curves are practically identical the difference in the initial phase between stress time and strain time curves occurs due to the viscoelastic effect of the hysteresis loops to capture the viscoelastic effect of fiber ropes two key parameters including the dynamic stiffness and internal damping coefficient are proposed by analyzing the curves of hysteresis loops the secant slope of the hysteresis loops is defined as the dynamic stiffness of fiber ropes as in del vecchio 1992 in addition the area of the hysteresis loop is used to calculate the internal damping coefficient as described by the indicator diagram method webster 1995 however the relation between the dynamic stiffness and internal damping coefficients has not yet been established hence it is necessary to develop a new method for determining the internal damping coefficient and connecting the dynamic stiffness of fiber ropes based on the theory of structural dynamics 3 method for calibrating the internal damping coefficient 3 1 theory of structural dynamics for determining the internal damping coefficient as observed from the results above the stable hysteresis loops can be obtained under the assumption that the state of rope is not damage during the initial service these loops can be modelled by the sine function here an idea that uses the theory of structural dynamics to determine the internal damping coefficient and establish the relation between internal damping and dynamic stiffness is proposed based on the assumption that the fiber rope is intact the effects of bending stresses torsion and the helical rope composition on different size ropes with the same structure type are negligible by observing the characteristics of the physical behavior we deem that a rope element of the testing sample under the specified axial load range can be modelled based on the theory of structural dynamics as a single degree of freedom sdof system to apply the present results of tested samples to the large size ropes a non dimensionalised method is used in particular the line tension f and the stiffness e a are normalised with respect to the minimum breaking strength m b s under these assumptions for the intact fiber rope of the same structure type the small scaled test results can be used to estimate the large scale fiber ropes under the same stress level here the stress of the rope element is σ f m b s the strain of the rope element is ε δ l l 0 and the total mass of an element of fiber ropes is m in addition the dynamic stiffness is defined as abs 2011 3 k r e a m b s t n p t n 1 t m b s ε n p ε n 1 t where k r denotes the dimensionless dynamic stiffness t n p and ε n p are the peak tension and the corresponding strain of the nth tension elongation hysteresis loop respectively t n 1 t and ε n 1 t are the trough tension and the corresponding strain of the n 1 th tension elongation hysteresis loop respectively where n 2 according to theory of structural dynamics chopra 2012 the differential equation governing the response of sdof systems to the harmonic stress σ σ m σ 0 sin ω t ϕ 1 is 4 m d 2 ε d t 2 η d ε d t k ε σ m σ 0 sin ω t ϕ 1 dividing eq 4 by m gives 5 d 2 ε d t 2 2 ξ ω n d ε d t k m ε σ m m σ 0 sin ω t ϕ 1 m where the natural circular frequency of vibration ω n and the damping ratio ξ are defined as 6 ω n k m ξ η 2 k m based on the assumption that the testing fiber rope is the single degree of freedom system the right part of eq 5 is considered as the superposition of simple functions of a step constant excitation and a harmonic vibration hence eq 5 can be written as 7 d 2 ε 1 d t 2 2 ξ ω n d ε 1 d t k m ε 1 σ m m 8 d 2 ε 2 d t 2 2 ξ ω n d ε 2 d t k m ε 2 σ 0 sin ω t ϕ 1 m eq 7 describe the problem of a sdof system subjected to a step function in acceleration with the condition that the mass starts at rest the general solution can be written as 9 ε 1 ε 1 c t ε 1 p t where ε 1 c t and ε 1 p t are the complementary and particular solution respectively the complementary one can be written as 10 ε 1 c t ⅇ ξ ω n t a cos ω n 2 1 ξ 2 t b sin ω n 2 1 ξ 2 t the particular solution which is the steady state solution can be written as 11 ε 1 p t σ m m ω n 2 σ m k substituting eq 10 and eq 11 into eq 9 leads to 12 ε 1 ⅇ ξ ω n t a cos ω n 2 1 ξ 2 t b sin ω n 2 1 ξ 2 t σ m k where a and b are constants which can be expressed in terms of the initial conditions 13 a ε 0 b ε 0 ξ ω n ε 0 ω n 1 ξ 2 in addition for eq 8 governing the response of sdof systems to harmonic force the particular solution is 14 ε 2 p t c sin ω t ϕ 1 d cos ω t ϕ 1 where 15 c σ 0 k 1 ω ω n 2 1 ω ω n 2 2 2 ξ ω ω n 2 16 d σ 0 k 2 ξ ω ω n 1 ω ω n 2 2 2 ξ ω ω n 2 the complementary solution of eq 8 is the free vibration response which can be written as 17 ε 2 c t ⅇ ξ ω n t a cos ω n 2 1 ξ 2 t b sin ω n 2 1 ξ 2 t where a and b are constants which can be expressed in terms of the initial conditions as shown in eq 13 the complete solution of eq 8 is 18 ε 2 ⅇ ξ ω n t a cos ω n 1 ξ 2 t b sin ω n 1 ξ 2 t c sin ω t ϕ 1 d cos ω t ϕ 1 for sufficiently long time t eq 18 approaches eq 14 in the limit hence the steady state deformation of the system due to harmonic force can be written as 19 ε 2 ε 0 sin ω t ϕ 1 δ ϕ ε s t 0 r d sin ω t ϕ 1 δ ϕ where ε 0 c 2 d 2 is the strain amplitude δ tan 1 d c is the phase lag ε s t 0 is the maximum value of the static deformation and r d is the deformation response factor which is defined as the ratio of the response amplitude ε 0 over the static deformation ε s t 0 substituting for c and d gives the following equations 20 ε s t 0 σ 0 k 21 r d ω ω n ξ ε 0 ε s t 0 1 1 ω ω n 2 2 2 ξ ω ω n 2 22 δ ϕ arctan 2 ξ ω ω n 1 ω ω n 2 hence based on eqs 5 8 12 18 22 the solution of eq 5 is obtained 23 ε 2 ⅇ ξ ω n t a cos ω n 1 ξ 2 t b sin ω n 1 ξ 2 t ε s t 0 r d sin ω t ϕ 1 δ ϕ σ m k in addition based on the exist test results of fiber ropes the stress strain hysteresis loops become nearly stable after a certain number of load cycles the strain response can be simulated by a sine function 24 ε ε m ε 0 sin ω t ϕ 2 where ε is the strain ε m is the mean strain ε 0 is the strain amplitude and ϕ 2 is the phase of strain moreover the stress response can be simulated by 25 σ σ m σ 0 sin ω t ϕ 1 where σ is the stress σ m is the mean stress σ 0 is the stress amplitude hence by comparing eq 23 with eq 24 the following equations can be obtained 26 ε m 2 ⅇ ξ ω n t a cos ω n 1 ξ 2 t b sin ω n 1 ξ 2 t σ m k 27 ε 0 σ 0 k r d ω ω n ξ σ 0 k 1 1 ω ω n 2 2 2 ξ ω ω n 2 28 ϕ 2 ϕ 1 δ ϕ arctan 2 ξ ω ω n 1 ω ω n 2 due to eq 26 shows that the mean strain changes with time therefore eqs 27 and 28 are utilized to obtain the internal damping coefficient the dynamic stiffness and the internal damping coefficients of fiber ropes can be determined using the experimental test result in following proposed procedure first to investigate the internal damping behavior of fiber ropes we define the parameter k as the dynamic stiffness k r according to the theory of structural dynamics hence k r can be analytically evaluated using the empirical formula of the dynamic stiffness which is a function of the mean load and load amplitude of fiber ropes this empirical formula of the dynamic stiffness is consistent with previous studies by del vecchio 1992 davies et al 2002 and lian et al 2017b thus the value of the parameter k can be obtained readily using eq 27 k is written as 29 k def k r e a m b s m ω 2 σ 0 ε 0 1 tan 2 δ ϕ next the total mass of the rope element is calculated as 30 m ea m b s σ 0 ε 0 1 t a n 2 δ ϕ ω 2 hence the natural circular frequency of vibration ω n k m is obtained then according to eq 28 the damping ratio can be obtained by 31 ξ tan δ ϕ 1 ω ω n 2 2 ω ω n finally using eq 6 and eq 31 the coefficient of the internal damping can be given as 32 η 2 k m ξ therefore based on eqs 29 32 the method for determining the internal damping coefficient is complete in addition the relation between the dynamic stiffness and the internal damping coefficient for fiber ropes is established here the physical relationship between the dynamic stiffness and the internal damping coefficient of fiber ropes exists in the hysteresis loop of fiber ropes which indicates the viscoelastic behavior the secant slope of the hysteresis loop determines the dynamic stiffness the area of the hysteresis loop is related to the value of the internal damping coefficient given that the sdof system consists of spring and dashpot models the tsd method has the capability to capture the behavior of the hysteresis loop 3 2 validation of the proposed method for determining the internal damping coefficient to validate the theory of structural dynamics for determining the internal damping coefficient proposed in this study the indicator diagram method idm webster 1995 johanning et al 2007 is introduced the idm is used to calculate the mooring line damping induced by the drag force under the excitation of the motions of floating structures webster 1995 the method needs both the top end horizontal or vertical displacement and line tension data to determine the area within a closed loop of the tension displacement curve this area is proportional to the energy dissipation from which the damping can be estimated johanning et al 2007 the damping coefficient can be obtained as follows 33 η e d π ω χ 2 e l o a d e u n l o a d π ω χ 2 where η is the damping coefficient and e d is the energy dissipated over each load unload cycle which equals the area of the hysteresis loop that can be calculated by utilizing the method of trapezoidal integration in the origin 8 0 software originlab 2007 here e l o a d is the energy when the tested rope is loading e u n l o a d is the energy when the tested rope is unloading ω is the angular frequency of vibration and χ is the amplitude of strain based on the indicator diagram method and the theory of structural dynamics tsd for determining the damping coefficient these for the aramid rope under two cyclic loads l m 18 40 a b s l a 5 772 a b s t 3 8776 s and l m 10 a b s l a 4 059 a b s t 1 8212 s and the internal damping coefficient of the polyester rope under two cyclic loads l m 24 87 a b s l a 1 769 a b s t 3 8752 s and l m 10 a b s l a 1 029 a b s t 3 8770 s are obtained and the results are shown in table 3 from the simulation results it can be observed that the damping coefficient of the double braided aramid rope is higher than that of three strand construction polyester as shown in table 3 the reason may be that the damping coefficient are affected by fiber material rope constructions and load conditions in addition to validate the present method the internal damping coefficent of the nylon 6 fiber rope under a cyclic load l m 20 277 a b s l a 2 2679 a b s t 25 s is obtained using 10 representative cycles experimental data of the nylon 6 ropes at stable state the data come from the cyclic tests of the rope sample 3 subjected to load set ls2 in the literature weller et al 2014 the stress time strain time and hysteresis loop curves of the 10 representative cycles cycle number from 15 to 25 are shown in fig 4 by using the sine function in eq 2 and the theory of structural dynamics tsd for determining the damping coefficient the corresponding damping coefficient values are obtained and listed in table 3 from table 3 it also can be observed that the average relative error of the damping coefficient between the idm and the tsd predictive methods is small thus together with the good comparisons with experimental and the complex viscoelastic viscoplastic model prediction the proposed simple method based on the theory of structural dynamics tsd for capturing the internal damping coefficient is accurate 4 further experimental validation 4 1 experimental system and test samples 4 1 1 experimental system to further validate the proposed method tsd for determining the internal damping coefficient long term cyclic tests of hmpe ropes are performed using a special experimental system the experimental system as shown in fig 5 a consists of four parts the loading elements fig 5 b and c the water cycling system fig 5 d the rope measurement system and the equipment foundation fig 5 d see also lian et al 2017a b 2018 the loading elements include the dynamic and static loading components fig 5 b and c respectively the dynamic loading component provides cyclic loads to the test rope the static loading component provides the pre tension or mean tension to the sample the water cycling system is fabricated using two water tanks and pumps to simulate the water environment of the fiber ropes the elongation measurement system is composed of a wire transducer two axletrees clamps and a mounting system the axletrees are installed above the outer water tank there are two sliding blocks which can move smoothly on the axletrees one serves as the base for the wire transducer and the other is used to hold the wire in place in addition to determine elongation of the rope in the test region two specially designed clamps are installed under the sliding blocks as shown in fig 5 d both clamps have an inward curving form to hold the gauge marks of the tested rope using bolts and nuts each tested rope is installed with a protecting sheath made of an aramid jacket between the two clamping pieces this ensures that potential failure of rope samples would not occur at the clamps the protecting sheath effectively eliminates the effect of stress concentration and avoids potential damage to rope samples caused by the clamps the gage length between the two gauge marks of the rope sample is 300 mm in the present study to measure tension values of test ropes a loading sensor is installed on the termination of the static loading device the precision of the load measurement is 5n and the wire transducer is 0 1 mm the loading cell and wire transducer are calibrated according to the standard calibration procedures provided by the manufacturer overall the present experimental set up has the capability to simulate working state of fiber ropes thus can be used to effectively study the internal damping behavior of fiber ropes under the specified axial harmonic loads however to investigate the mooring induced damping of tested ropes a new experimental set up would be required because the mooring induced damping of tested ropes is controlled by the transverse vibration webster 1995 fan et al 2017 4 1 2 test samples the hmpe fiber rope studied has a 12 strand construction comprising dyneema sk75 fibers as shown in fig 6 a the rope was supplied by jiuli ropes co ltd the hmpe fiber was produced by dsm dyneema the diameter and the linear density mass per unit length of the rope are 0 006 m and 24 g m respectively see fig 6 a the cross section of the rope is illustrated in fig 6 b the geometrical parameters of the rope are pitch distance p and helix angle β of the rope components sub rope are equal to 40 mm and 20 respectively and the sub rope radius is equal to 2 mm that allows the computation of the helix radius a which is the distance from the core axis to the longitudinal axis of a component the helix radius is 2 637 mm the pitch distance measures the length along the core axis for a component to go through a swept angle that varies from 0 to 2 π and the helix angle is defined as the angle between the centerline of the helical component with the centerline of the core see fig 6 b the average breaking strength abs and standard deviation of the tested ropes obtained from our tests are 27 8 kn and 2 0 kn respectively 4 2 experimental cases and procedures 4 2 1 experimental cases to further validate the present method 9 test cases of the hmpe ropes are designed as listed in table 4 experimental loading parameters of the hmpe ropes are listed in table 4 in which l m denotes the mean tension of cyclic loads l a denotes the load amplitude and a b s denotes the average breaking strength the values of l a and l m are selected at the high loading ranges due to the following two factors one the experimental set up can provide more stable and accurate tension at high loading value for hmpe ropes which shows higher modulus than that of other ones two the high loading range corresponds to high sea state conditions which are of most concern for engineering design cases 1 3 are designed to investigate the effect of the mean load on the internal damping coefficient of hmpe ropes under the condition of fixed load amplitude and cyclic load period cases 4 6 are designed to further investigate the effect of mean loads on the internal damping coefficient of hmpe ropes cases 7 9 are designed to investigate the effect of the cyclic load period on the internal damping coefficient of hmpe ropes furthermore cases 1 4 and 7 are designed to investigate the effect of load amplitude on the internal damping coefficient of hmpe ropes here all tests are carried out and the experimental data are captured by utilizing the present experimental set up each experimental case is performed at least twice to ensure repeatability and reliability of the measured data 4 2 2 experimental procedure the detailed experimental procedure is delineated as follows first to install the rope sample to the machine the eye splice method is adopted based on the fact that eye spliced termination can provide reliable test results for the present rope splices a permanent loop an eye in the end of a rope which denotes the tested rope termination is created by means of rope splicing the total length of the sample the length of the splice and the gauge length in the middle of the sample are 2 4 m 0 3 m and 0 3 m respectively this ensures that the gage part of the sample would not be affected by rope spliced terminations next the bedding in process is performed for all samples before cyclic tests this process reduces the constructional stretch and increases rope and termination efficiencies api 2015 the present bedding in process includes a constant load up to 50 minimum breaking strength mbs and a cyclic load whose mean load is 20 mbs and load amplitude is 10 mbs for 100 cycles note that the minimum breaking strength is the wet breaking strength guaranteed by the rope manufacturer for a specific rope in the present investigation the average breaking strength abs is approximately regarded as mbs value was not provided by the rope manufacturer after completing the bedding in process the sample is unloaded to 200n to take up the slack and to measure the gauge length finally the sample is loaded according to a test case in table 4 at the temperature 25 c each sample is initially loaded at a rate of 50n s until it arrives at a setting fixed mean load l m then the mechanical wheel begins to roll to provide cyclic loads the control system of the static element is then applied to prevent the mean load from drifting data acquisition rate of the measurement system is set at 9 points per second the measured data are auto saved in the computer 5 results and discussion 5 1 test results of hysteresis loops based on results from the experimental cases and procedure described above stress time strain time and hysteresis loop curves of hmpe ropes for each case are obtained for example the results of the hmpe samples under the load condition of case 5 l m 65 abs l a 11 5 abs which corresponds to a storm condition are shown in fig 7 the stress time curve of case 5 is shown in fig 7 a the figure indicates that the boundary line of the peak stress value is parallel with the boundary line of the trough stress until the sample fails the inset in the figure shows that a short section of the stress time curve is a sine function the results demonstrates that the current experimental set up provides the required cyclic tension the strain time curve of case 5 shown in fig 7 b illustrates that the strain envelopes contain three stages reflecting the creep like response under cyclic loads and the insect in fig 7 b indicates the strain curve of cyclic tests is a sine function which changes between the peak and trough strains in per cycle fig 7 b also shows that the strain time curve of hmpe ropes under cyclic loads is different from the one of hmpe ropes under constant loads see fig a1 which shows a typical characteristic response to constant loads see lian et al 2015 2018 the stress strain curve in fig 7 c shows the area of hysteresis loops for all cycles the data indicates that the area of the stress strain curves looks like the sum of all hysteresis loop curves to clearly illustrate the evolution of hysteresis loop of hmpe ropes the hysteresis loops at different cycles n 300 1555 4147 9331 14515 19699 24883 30067 35251 40435 45619 50802 61170 66354 71538 76722 are plotted in fig 7 d these cycles show that the area of hysteresis loop is stable after the test sample experienced 300 load cycles fig 7 d further indicates that the dynamic stiffness and the internal damping of fiber ropes become stable after the ropes had experienced sufficient number of load cycles which is consistent with the research results in the literature banfield and casey 1998 casey et al 2000 huang et al 2015 the results also indicate that the number of load cycles only affects the horizontal position of stable hysteresis loops for hmpe ropes 5 2 simulations of hysteresis loops of hmpe ropes to analyze the internal damping properties of the hmpe rope under cyclic loads 10 representative cycles experimental data of the hmpe ropes at stable state after the samples had experienced sufficient load cycles are used for example the stress time strain time and hysteresis loop curves of the 10 representative cycles cycle number from 79170 to 79180 for case 5 l m 65 abs l a 11 5 abs t 1 928 are shown in fig 8 by using the sine function in eq 2 the corresponding coefficient values for the experimental stress time and strain time curves are obtained and listed in table 5 the correlation coefficients between experimental values and simulation results for both the stress time and strain time curves were computed and are found to be 0 99 hence there is an excellent agreement between the measured data and the simulation results using the sine function based on the observed results the sine function in eq 2 is employed in all the nine testing cases listed in table 4 to capture the hysteresis loops comparisons between the simulation results of sine functions and experimental data of hysteresis loops for the nine cases are performed as shown in fig 9 through 11 both figs 9 and 10 show the effect of changes in mean load on the hysteresis loops of hmpe ropes specially these figures together with table 6 indicate that the vertical centroidal position maximum and minimum stresses of the stable hysteresis loops increases with increasing mean stress i e y 0 in eq 2 and the horizontal centroidal position maximum and minimum strains of stable hysteresis loops also increases with increasing mean strain which depends on the cycle number of the fiber rope experienced in fig 9 the stable hysteresis loops of cases 1 3 at different horizontal centroidal locations are caused by their different mean strains which are determined by their loading levels and loading cycle numbers based on observation of the evolution of hysteresis loops shown in fig 7 d the loading cycle number only affects the horizontal position of hysteresis loops but does not affect the area of the stable hysteresis loops for hmpe ropes under the same cyclic load condition considering the present study is focused on the area of the hysteresis loop for cyclic load condition and the areas of the stable hysteresis loops at different horizontal position are practically identical therefore any one of the stable hysteresis loops at a given cycles can be used to estimate the internal damping coefficient under the cyclic load condition from fig 9 it can be observed that the hysteresis loop of case 3 has an offset towards the right this is because the centroidal loop strain which is affected by the load cycle number is purposely selected to be different from that of cases 1 and 2 hence the centroids of the three ellipses do line up in a straight line however the area of the stable hysteresis loop of case 3 remains unaffected with respect to the centroidal positon similarly fig 10 shows that the horizontal central position i e the mean strain of the stable hysteresis loops of cases 4 6 are affected by their cycle numbers reinforcing the observation above although the horizontal central positions of the loops seems to be irregular due to their different selected mean strain the area of the stable hysteresis loop continues to reflect the hysteresis energy of each case the reason is that the area of the stable hysteresis loop is not change with the horizontal central position mean strain of the loop and any one of the stable hysteresis loops at arbitrarily selection cycle can be used to obtain the internal damping coefficient within the same load case in addition fig 11 shows the area of the hysteresis loops becomes narrower with increasing load period this observed physical phenomena is consistent with previous research by banfield and casey 1998 which showed that the hysteresis energy resulting from the test at a 3 s period is about 40 greater than the energy resulting from the test at 6 s cyclic period for the tested 120 tonne force polyester rope at 20 10 mns manufacturer nominal strength sinusoidal loads the reason that the area of hysteresis loops decreases with increasing loading period may be that the longer cyclic period the smaller the increase in temperature differential with the environment and hence the smaller the heat exchange which will dissipate less energy this causes the hysteresis energy namely the area of hysteresis loop to decrease however fig 11 illustrates that the loading period has little effect on the dynamic stiffness which is proportional to the secant slope of the loops in addition fig 12 shows that the area of stable hysteresis loops increases with increasing load amplitude the figure also shows that the stable hysteresis loop position of case 4 is much different from that of cases 1 and 7 the reason is that the mean strain of the loop of case 4 is different from that of other cases see table 6 changing the horizontal position of the loop do not affect the area of the hysteresis loops based on the observation that the amount of energy dissipated per cycle for any one of the stable hysteresis loops at different position under the same load case remains constant results obtained from the test data presented shown in fig 13 confirms this observation note that in fig 12 the area of hysteresis loop increase from case 1 to case 7 but the internal damping coefficient presented in table 7 decreases this phenomenon occurs due to the fact that the internal damping coefficient is determined by the area of the hysteresis loop e d the angular frequency of vibration ω and the amplitude of the strain χ according to eq 33 the relation between the internal damping coefficient and the area of hysteresis loops for case 1 4 and 7 is confirmed by the data presented in table 6 overall good agreement between numerical simulation results of sine functions and the experimental data in figs 9 12 demonstrates that the sine function can describe the stable hysteresis loop of fiber ropes 5 3 internal damping coefficients of hmpe ropes under different load conditions based on the results presented above the area of the stable hysteresis loops remains constant after the transient effect of load cycles become negligible hence the area of the stable hysteresis loops can be used to estimate the internal damping coefficient for any given cyclic load condition for different cases of the hmpe samples the dynamic stiffness and the internal damping coefficient of stable hysteresis loops are calculated and listed in table 6 the dynamic stiffness values are calculated using the definition in eq 3 these dynamic stiffness values can also be evaluated by the empirical equation presented in the reference lian et al 2017b which shows it is a function of the mean load and the load amplitude of fiber ropes in addition the internal damping coefficients calculated by the theory of structural dynamics tsd are compared with the results from the indicator diagram method idm observe that their relative error is quite small which further indicates that the present method tsd is capable of determining the internal damping coefficient of fiber ropes moreover the present model shows the relation between the dynamic stiffness and the internal damping coefficient which helps to estimate the internal damping coefficient in addition the results of cases 1 to 6 show that the internal damping coefficient increases with the increasing mean stress of fiber ropes the results of cases 7 to 9 indicate that the internal damping coefficient decreases with increasing load periods the results of cases 1 4 and 7 illustrate that the internal damping coefficient decreases with increasing load amplitude 6 concluding remarks in the present study numerical results of schapery s viscoelastic and owen s viscoplastic model are compared with the measured data of aramid and polyester ropes the results show that the viscoplastic effect on hysteresis loops is negligible but the viscoelastic effect is significant the viscoelastic viscoplastic model can simulate the time dependent behavior of fiber ropes well in terms of the slope of hysteresis loop but there appears still room for improving the accuracy of describing the hysteresis loops particularly to reduce the complexity of the model and associated involved computations a simple sine function to describe the hysteresis loops and a novel method for determining the internal damping coefficient of fiber ropes was proposed the simple model assumes that the fiber rope is intact the effects of bending stresses and torsion and the effect of the helical rope composition on different size ropes are negligible by applying the non dimensionalised method and the theory of structural dynamics tsd in addition the relation between the internal damping coefficient and dynamic stiffness of fiber ropes is established compared with the numerical results from viscoelastic and viscoplastic model the numerical simulation hysteresis loops from sine functions are found to fit more closely the experimental data of aramid and polyester ropes the good agreement between the results of internal damping coefficients from the proposed method of theory of structural dynamics tsd and the results of the indicator diagram method idm for the aramid and polyester cases shows the accuracy of the proposed method moreover to further validate the proposed method systematic experimental tests of hmpe ropes under different cyclic loads were performed the evolution of hysteresis loops obtained from the test results shows that the area of the steady state hysteresis loop remains almost constant under the condition that the tested rope is intact which are consistent with the observations of other researchers hence the internal damping coefficient calculated from any one of the stable hysteresis loops is reasonable by analyzing the experimental hysteresis loops of hmpe ropes the internal damping coefficients are calculated from the indicator diagram method idm and the theory of structural dynamics tsd respectively the relative error of internal damping coefficients between these two methods is small this further proves that the proposed method is feasible to determine the internal damping coefficient of fiber ropes in addition the experimental results of hmpe ropes show that the internal damping coefficient increases with increasing mean load and decreases with increasing load amplitude and load periods of fiber ropes the present investigation helps to improve the understanding of the internal damping behavior of fiber ropes therefore it may help to evaluate the internal damping coefficient of fiber mooring ropes and incorporate the viscoelastic effect of fiber ropes in engineering application in the future additional experimental research work will be performed to develop empirical formulae for calculating the internal damping coefficient for fiber ropes fig a1 a typical strain time curve in creep rupture tests fig a1 acknowledgements the authors greatly appreciate the financial support from the national natural science foundation of china grant nos 51609079 and 51539008 and the fundamental research funds for the central universities of china grant no 2017b11314 the senior author and s yim thank the international postdoctoral exchange fellowship program 2017 grant no 20170013 for his two year study at oregon state university 
22814,in the present study a post swirl pump jet system was designed for an axisymmetric underwater vehicle in order to evaluate the design procedure several experiments such as bollard pull self propulsion point spp and bare hull resistance tests were conducted in a towing tank on a full scale model further conditions were performed numerically at higher velocities to determine the characteristic chart and flow pattern analysis both open water and behind hull conditions were simulated the realizable k ε turbulence model and the mixing plane method mpm were utilized in a periodic domain for numerical simulations the obtained results showed that the variations of hydrodynamic coefficients especially the torque coefficient against advance coefficient were much smaller than conventional propellers moreover the net imbalance roll moment was quite small in all conditions suggestive of accurate stator design the stator also created additional thrust and hence increased the overall performance up to 82 percent in the behind hull condition keywords propulsion system periodic boundary condition cfd simulation pump jet towing tank 1 introduction pump jet is a marine propulsion system which creates the required thrust for the fitted body the main two features of this system against conventional propellers are first neutralizing the rotor roll moment via the stator and second higher performances since stator blades participate in thrust production the mechanical arrangement contains a ducted propeller with either a pre swirl or a post swirl stator a schematic of a post swirl pump jet with its connected shaft is depicted in fig 1 the use of pump jet was developed due to the advances made in high power marine engines and implemented in order to obtain higher velocities and performances these systems can reach higher speed compared to the common single or ducted propellers before the onset of cavitation furthermore they have higher power density and lower noise level unlike common marine propellers pump jets are efficient in shallow waters protecting the rotational element because of the installed duct this makes their operation safe around swimmers and aquatic life as it was indicated earlier the pump jet propulsor can be considered as a ducted propulsion system containing a far closed stator a decelerating duct is usually used for the pump jets proper design of the duct profile is very crucial an incorrect design can waste a considerable amount of the pump jet generated thrust the stator design also plays a serious role in the pump jet operation the main function of the stator blades is first to counteract the rotor roll moment and then creating thrust force for better performance these blades receive the rotor outlet swirling flows and if correctly designed they will leave axial flow with approximately free stream velocity magnitude behind therefore unlike the conventional propellers the swirling flow energy will not waste to the surroundings thus the performance will increase these systems can achieve high performances as 90 percent or higher provided that they are accurately designed furuya and chiang 1988 motallebi nejad et al 2017 investigation of pump jet hydrodynamic characteristics will aid us to both understand the operational features and evaluate the design procedure as well the hydrodynamic coefficients can be determined using the captive model test as well as system identification techniques in free running experiment saeidinezhad et al 2015 these coefficients can also be calculated using computational fluid dynamic cfd simulations many researchers have examined designing and flow pattern analysis in pump jet thrusters so far a brief overview of the main numerical and experimental studies is presented in the following paragraphs the early design procedure was introduced by henderson et al 1964 the problems of shroud design skewed vanes and unsteady force action were considered and discussed blade modeling and fluid flow simulation around marine propellers are very difficult due to the geometrical and physical complexity ivanell used the fan boundary condition instead of simulating the rotor blades for a pump jet the results showed good agreement only for the global parameters with complete blade simulations ivanell 2001 geerts studied the secondary flows around an axial flow pump using experimental and numerical techniques geerts 2006 as the experimental limitations the numerical cfd simulations were implemented for flow analysis das and coworkers designed a pump jet using the axial flow turbo machinery concepts das et al 2006 they relied on the experiments used in the turbo machinery design and applied them in marine propulsors the main aim of their research was to demonstrate the capability of cfd codes in complex 3d flow analysis most of the experimental research works have been performed on the scaled geometries or on the full scale model in wind tunnels these results should be then extrapolated for real configuration in seawater dropkin and coworkers presented a method to combine cfd results with subscale experimental data to improve full scale performance prediction dropkin et al 2011 xiao jun and coworkers investigated the idea of using two and four distributed pump jet over the body lü et al 2014 ahn and kwon determined the performance of a ring rotor with the rotor blades interconnected with a circumferential ring at the tip ahn and kwon 2015 owing to the duct existence in pump jets the onset of cavitation is delayed pan and coworkers numerically studied the unsteady flow cavitation of a pump jet pan et al 2015 the results showed that due to the tip vortex and tip clearance cavitation leads to a further loss in the efficiency of the cavitating flows the number of pump jet blades is much greater than common propellers hence they will have a great computational cost if they want to be completely simulated a periodic simulation can be very advantageous in this condition this method was utilized to determine the hydrodynamic characteristics of a ducted propeller and a pump jet in motallebi nejad et al 2017 the results were shown to have a perfect agreement with complete simulations huyer sinusoidally varied the pitch angle of the stator blade around the circumference to make lateral force his inventive idea enabled the vehicles to make side forces even at zero axial velocity huyer 2015 recently lu and coworkers numerically investigated the tip clearance effect on their designed pump jet characteristics in lu et al 2017 the formation and development of the tip clearance flows were investigated in addition to the tip leakage vortex analysis furthermore the influences of the tip clearance size on the pump jet performance and the cavitation characteristics were discussed in this research many experimental types of research were also carried out in pump jet propulsion systems suryanarayana and coworkers suryanarayana et al 2010a 2010b 2010c investigated the wake analysis and flow characteristics of their own designed pump jet in wind and cavitation tunnel the spp test and net torque measurement were considered in addition to the cavitation and attack angle effects this noteworthy method improved the results obtained from linear extrapolation of reynolds number the literature survey on the pump jet propulsor shows that there are generally a few investigations performed on this type of propulsion system numerical analysis generally used conventional propellers data for cfd validation which is not true due to the differences in flow pattern caused by the rotor stator interaction on the other hand most experimental investigations are influenced by reynolds number and scale effects hence the main aim of the present research is to examine the fluid flow and hydrodynamic characteristic chart of a designed pump jet to that end a full scale pump jet model was constructed and several experimental tests were planned in a towing tank the obtained global results such as thrust and torque coefficients were used for cfd validation afterward further numerical simulations were carried out in order to investigate the fluid flow pattern and determine the hydrodynamic characteristics chart 2 body model the pump jet was designed based on the axial flow compressor technique for a high speed underwater vehicle with a combined boundary element method bem and cfd approach an in house bem code was developed to that end and the results were compared with cfd data in a design loop the design procedure in pump jet propulsion system is usually considered secret and not available in the open literature however the design loop generally deals with altering the geometrical parameters such as blades number z pitch to diameter ratio p d rake and other parameters in order to provide the required thrust force and neutralize the roll moment the bem was utilized for a quick parametrical analysis this method is based on the potential flow approach and considers the viscous effects using semi empirical equations the rotor stator interactions were neglected during these primary simulations afterward detailed three dimensional reynolds averaged navier stokes rans and turbulence cfd investigations were performed on those with highest performances selected from the previous phase using mpm the rotor and stator inlet and outlet flow characters were obtained from these simulations in addition to the global thrust and torque values the geometrical parameters are modified until the required operational characters are achieved the blade tip clearance is a very important parameter which directly influences on the performance and the radial distribution of velocity component of the pump jet lu et al 2017 in the present work this quantity was considered about 0 85 of the rotor diameter a full scale model was then constructed after finalizing the design loop the full scale body and the propulsion system were manufactured from aluminum using cnc machine to obtain the required surface shape of the blade with 0 05 mm accuracy the main specification of the body and the propulsion unit were given in table 1 the model was equipped with a seven hp three phased electrical motor four handles were utilized to fix the duct into the tail section preventing vibrations these handles were also useful in installing the rudder or elevator fins for real configurations as depicted in fig 2 for the mk 48 torpedo and the saab auv real vessels usually use two rudders and two elevators to guide and control the vessel these control surfaces are usually installed on the duct or just after the duct the general arrangements of the model comprised mainly of the nose mid body electrical motor tail and the pump jet as was shown in fig 3 a an isometric view of the behind hull condition i e complete final body along with the installed pump jet was provided in fig 3 b 3 computational technique a brief overview of the numerical procedure and the employed equations in addition to the boundary conditions were described in the following sections 3 1 governing equations the rans equations were implemented besides the continuity equation for numerical simulations the flow was assumed to be incompressible three dimensional steady state and turbulent the governing equations can be stated as eqs 1 and 2 1 u i x i 0 i 1 2 3 2 ρ u i u j x j p x i x j μ u i x j ρ u i u j i j 1 2 3 where u i denotes the averaged velocity in i direction p presents the averaged pressure μ the molecular viscosity and ρ u i u j indicates the reynolds stress the r e a l i z a b l e k ε turbulence model is utilized to accomplish the closure of the momentum equation this model was described as eqs 3 and 4 and the turbulent viscosity is calculated via eq 5 the model differs from the standard k ε model in two ways this model contains a new formulation for the turbulent viscosity furthermore a new transport equation for the dissipation rate has been derived from an exact equation for the transport of the mean square vorticity formulation 2015 3 ρk t ρu j k x j x j μ μ t σ k k x j g k g b ρε y m s k 4 ρε t ρu j ε x j x j μ μ t σ ε ε x j ρ c 1 s ε ρ c 2 ε 2 k υ ε c 1 ε ε κ c 3 ε g b s ε where c 1 max 0 43 η η 5 η s k ε s 2 s i j s i j in the above equation g k g b are the generation of turbulent kinetic energy due to the mean velocity gradients and buoyancy respectively the y m represents the contribution of the fluctuating dilation in compressible turbulence to the overall dissipation rate this term can be neglected in incompressible simulation like other k ε models the eddy viscosity is calculated using eq 5 the difference between the realizable k ε model and the standard and rng k ε models is that c μ is not a constant value more details about the model can be found in the literature 5 μ t c μ ρ k 2 ε it should be noted that choosing a suitable turbulence model for a rotating flow is depending upon the swirl number this parameter is defined as the angular momentum to the axial momentum flux ratio as shown in eq 6 6 s r ω v d a r u v d a where r is the radial distance while ω and v are the angular velocity and velocity vector respectively r is the hydraulic radius and v d a denotes to the dot product of the surface normal vector and the velocity vector the r e a l i z a b l e k ε turbulence model is recommended for s 0 5 in ansys 2015 the swirl number for the present study was in the range of s 0 15 0 2 therefore the r e a l i z a b l e k ε model was chosen continuity momentum and turbulence equations were coupled and solved via the simple pressure based algorithm with the ansys fluent16 1 solver the standard wall functions which are based on the work presented in launder and spalding 1983 are implemented in order to model the near wall flow treatment these wall functions have been widely used in industrial flows the convergence criterion was considered as 10 5 the second order scheme was utilized for the pressure equation while the second order upwind scheme was implemented for other equations discretization the hydrodynamic characteristics of the propulsion systems are usually state using non dimensional coefficients the overall efficiency was defined based on the rotor stator and duct coefficients the advance coefficient j and related thrust and torque coefficients k t k q as well as the overall efficiency η and the residual thrust c r t are defined in eq 7 based on the rotor and stator thrust t r o t o r t s t a t o r and the duct drag d d u c t forces the reynolds number re is also defined based on the model length l furthermore the reynolds number r n 0 7 is presented based on the chord length c kinematic viscosity ν and rotational velocity ω at radial position r r 0 7 as demonstrated in streckwall et al 2013 7 j u n d r o t o r r e ρ u l μ r n 0 7 c 0 7 ω 2 r 0 7 2 u 2 υ k t r o t o r t r o t o r ρ n 2 d r o t o r 4 k q r o t o r q r o t o r ρ n 2 d r o t o r 5 k t s t a t o r t s t a t o r ρ n 2 d r o t o r 4 k q s t a t o r q s t a t o r ρ n 2 d r o t o r 5 t tot t rotor t stator d duct k t t tot ρn 2 d r o t o r 4 η j 2 π k t k q r o t o r c r t t tot d b o d y ρ n 2 d r o t o r 4 3 2 boundary condition in the present study a cylindrical domain was utilized to model the far field boundary for numerical simulations the thin handles shown in fig 3 were neglected during the pump jet numerical simulations therefore the periodic boundary condition can be implemented to reduce the computational costs this method was also used in motallebi nejad et al 2017 the domain was decomposed into two regions the rotor region is coupled with the rest of the computational domain using mpm and rotation is achieved in the rotor region using a moving reference frame mrf the mpm was employed instead of the common mrf technique in order to consider the rotor stator interaction it should be emphasized that the mrf model is only applicable in case a relatively uniform flow passes through the interfaces this assumption is not true for rotor stator simulation the mpm treats each zone as a steady state region and the flow field data are passed through boundaries from the adjacent zones these data are then spatially averaged or mixed at the mixing plane interface which eliminates any unsteadiness that would arise due to circumferential variations despite the simplifications of this method the obtained results provide logical approximations of the time averaged flow field ansys 2015 more details about the mpm can be found in the literature the pressure outlet and the pressure inlet boundary conditions were utilized at the mixing plane interfaces the inlet outlet and the far field boundary conditions as well as the applied coordinate system were shown in fig 4 a these boundaries were considered far enough to have no effects on the numerical results the upstream and downstream length and the domain diameter were selected 5 12 and 10 times of the auv diameter respectively the mixing plane interfaces were implemented at both rotor inlet and outlet faces as shown in fig 4 b since the rotor and stator blades number were different the angular domains do not match together results will not be affected using the periodic boundary condition as stated in motallebi nejad et al 2017 the open water condition was also considered in the present research in order to ensure that a uniform flow arrives at the pump jet entry the hull body was omitted and only the tail profile remained as a result the open water geometry was obtained as shown in fig 4 c all of the applied boundary conditions for the open water status are the same as those stated in fig 4 a except for the tail boundary 3 3 grid generation the ansys mesh utility was implemented for grid generation the produced grid notably influences the computational costs accuracy and the convergence rate the near wall grids directly affect the pressure gradients and the shear stress prediction as the blade profile complexity it was difficult to generate a fully structured grid for the entire domain therefore a hybrid grid was implemented and structured prism cells were provided for the near wall region especially for the boundary layer region and unstructured polyhedral cells were used for the remained regions as shown in fig 5 the generated grids have an acceptable to excellent quality as classified in ansys mesh documents ansys 2011 the maximum value for the skewness and aspect ratio parameters were 0 95 and 22 respectively it is crucial to ensure that the obtained results are independent of the grid number and types in the present research the grid convergence index gci technique was utilized to evaluate the discretization error and numerical uncertainties this method was introduced in roache 1997 this method quantifies the uncertainty and estimates the numerical error of a cfd simulation special consideration should be taken to account for turbulence modeling or artificial dissipation the gci approach presents a more conservative procedure in addition to obtaining a good error estimation the notation gci indicates that the calculated values are how far away from the exact values therefore small values of gci mean that the results are close to the exact values in order to implement this method three different meshes were required these three cases were described as s 1 s 2 and s 3 from the finest to the coarsest mesh with n 1 n 2 and n 3 number of elements a refinement factor shown as r was defined as r 21 n 1 n 2 1 3 it was recommended that r 3 should be applied to reduce the extrapolation errors hajivand and mousavizadegan 2015 according to the roache s method the convergence ratio was defined as eq 8 8 r ε 21 ε 32 where ε 21 ε 32 refers to the difference of 2 1 and 3 2 grid results respectively three different conditions were possible for the convergence ratio r 1 grid divergence r 0 oscillating convergence 0 r 1 monotonic grid convergence in case of the grid convergence richardson extrapolation was utilized to estimate the convergence rate the accuracy order of the algorithm is calculated in eq 9 where r is the grid refinement factor 9 p ln ε 32 ε 21 ln r finally the gci is obtained by applying eq 10 where f s is a safety factor for convergence study with a value of f s 1 25 as advised in roache 1997 the e i j symbol is the approximate relative error 10 g c i i j f s e i j r p 1 as was stated before the gci evaluates the results changes with more grid refinement the small value of gci indicates that more grid refinement will not improve the results in the present research four different grids were generated and the global thrust and torque coefficients were selected for grid convergence investigation as presented in table 2 for the behind hull condition the above mentioned gci parameters were tabularized in table 3 for the medium fine and very fine grids at j 2 7 the results showed small values for the g c i 1 2 in both thrust and torque coefficients consequently the fine grid was employed for other simulations the averaged values of the y parameter around the bare hull and the pump jet were about 26 and 34 respectively furthermore the internal flow field variation with grid refinement was investigated using the velocity profile distribution at 0 y 0 1 and x 2 45 m equal to 0 05 m behind the pump jet at wake region as depicted in fig 6 the results show that the coarse and medium results deviate while the fine and very fine cases are coincide with each other 4 experimental procedure the experimental procedures were described in the next sub sections introducing the applied towing tank and tests setup 4 1 towing tank specifications data acquisition system a high speed towing tank at a maximum speed of 7 m s for fully submerged bodies was utilized to accomplish the captive model tests the length width and the depth dimensions of the towing tank were 150 m 7 m and 3 5 m respectively a trimming tank was applied for model preparation and initial tests in addition two inclined flat plates beside the trimming tank were utilized as wave dampers the minimum length for data collection at the maximum speed was 75 m the towing tank was equipped with an 85 kw dc motor the velocity of the carriage was controlled within the accuracy of 0 01 m s a three component calibrated load cell was employed to measure the applied forces on the model the instantaneous forces were recorded at the frequency of 600 hz and used for data averaging the maximum measurable force by the load cell in x y and z direction was 250 n 1 a user interface labview program was developed to acquire and display the real time measurement data the rotor operations were fully recorded using a human machine interface hmi an electrical board provided the motor with on off keys and speed controls mechanism the hmi was also used to measure the accelerations during the test this electrical equipment was installed underneath the carriage rail and moved with the model as shown in fig 7 the data cables were driven via the vertical struts the rotor spin was regulated with a driver unit this rotational velocity was controlled and measured by an encoder installed on the motor 4 2 experimental setup the body was connected to the carriage with two naca type section hydrofoils as vertical struts the struts submerged to a depth of 0 95 m in the water having a length of 1 35 m this depth was about three times of the auv diameter and was sufficient to dissipate the free surface effect as presented in hoerner 1965 this assumption was also confirmed during the bollard pull test since no changes were observed in the water surface level in all conditions a laser beam was used to ensure that the body and the struts were in exact coincidence with the plumb line since the electric motor was employed to drive the propulsion unit the body had to be completely sealed therefore leakage tests were performed using air with pgauge 0 4 0 5 bar and the weicon lecksuch spray was used to visualize eventual bubbles the sealing test was also arranged in a tub for both static and dynamic parts respectively i e o rings and the rotating shaft the selected tub depth was similar to that of the towing tank vertical struts arrangement struts should be installed on the body in order to have minimal effect on the flow pattern and the results during the test the vertical struts arrangement altered depending on the tests in case of the bollard pull test vertical struts were positioned side by side as depicted in fig 8 providing vertical force measurements in heave direction so the roll moments could be evaluated from the vertical force component and the moment definition in other conditions in order to reduce the flow disturbance these struts were positioned in a tandem mode as depicted in fig 7 4 3 scope of the experiment the main purposes of the experiments were to investigate the spp bollard pull and the inclined body conditions only the net forces propulsion total thrust minus body drag force were measured along with the load cells so the bare hull resistance tests were also planned to evaluate pure thrust force and the thrust deduction factor the bollard pull condition was desirable as the maximum torque coefficient occurs in this condition in this test the net roll moment of the whole body and the pump jet were determined the test conditions were listed in the following test matrices for the above mentioned investigation each test was repeated at least three times under the same operating conditions and the mean values were reported it should be noted that the pump jet was designed for higher velocities 35 to 40 knot but test matrices were planned according to the towing tank maximum velocity and the electric motor power it should be noted that merely the global results i e total thrusts and moments were measured in the experiments and the flow pattern analysis were only investigated in the numerical simulations 4 3 1 bare hull resistance test as it was noticed above we had to measure the bare hull resistance in order to determine the net thrust forces in the spp test these tests were performed as listed in table 4 conditions a conical teflon part was installed instead of the pump jet to prevent additional flow separations at the tail region this part also acts as a sealant it should be emphasized that both the bare hull and the struts forces were measured in this test therefore the net propulsion forces could be obtained the conical part and the final bare hull configuration is depicted in fig 9 4 3 2 bollard pull condition test the bollard pull tests were executed under table 5 conditions to measure the produced thrusts beside the net roll moments 4 3 3 spp test the following tests as stated in table 6 were carried out to determine the spp only one test was performed in 4 34 m s the chord length based reynolds number is also reported for each test almost all tests are carried out at reynolds number higher than 10 5 furthermore the flow around the pump jet has high turbulent intensity due to the rotor rotation effects therefore the flow can be considered as a turbulent flow 5 results the results of the above experimental conditions were discussed in the following sections the numerical method was applied for both cfd validation and higher velocity simulations as well the hydrodynamic characteristics chart extraction and the flow pattern investigations were accomplished in the cfd simulations 5 1 estimation of the bare hull drag in order to find out the pump jet net thrust force the bare hull resistance was estimated at different axial velocities as mentioned in section 4 3 the pump jet was replaced by a conical part to prevent flow separations at the tail cut off section the body was towed at different velocities under condition indicated in table 4 yielding r e 2 7 13 5 10 6 which was defined in eq 7 fig 10 shows the numerical and experimental net resistance force coefficient made by the bare hull the cd versus reynolds number was calculated to evaluate resistance coefficient dependency on reynolds number as it can be seen the variation of the resistance coefficient against reynolds number is quite insignificant at r e 8 10 6 and higher the obtained resistance forces were then used to extract the net thrust forces of the pump jet the velocity contours at the propeller reference plane and from the front view were shown in fig 11 the velocity contours show that the wakefield is affected by the installed handles on the body and 4 low speed regions are observed at the wake plane 5 2 bollard pull test results during the bollard pull test both the roll moment and the pump jet thrust were measured at four different rotating speeds numerical simulations were carried out under the same experimental conditions i e j 0 the obtained numerical and experimental results were presented in fig 12 since the motor was high loaded during this test it was impossible to attain higher spins in addition the pump jet thrust led to a remarkable torque on the vertical struts junctions especially at high spins on the other hand the thrust and torque coefficients will not significantly change by increasing the rotational speed as they are all in a constant j it should be emphasized that the reported thrust and torque values are the summations of the entire pump jet components i e the rotor stator and the duct the net imbalance roll moment at the maximum speed was about 15 nm this value was less than 4 6 percent of the rotor moment according to the numerical outcomes it should be noted that the bollard pull condition is a particular status compared with the operational condition in this condition the rotor inlet flow angle is quite large about 21 in the present study and a relatively large separation region will be formed around the rotor blades the separation region is large at low velocities and it is changed at higher velocities the small values obtained for the net roll moment indicate that the stator blades had an excellent operation these blades had almost entirely neutralized the rotor roll moment in order to visualize the stator outlet flow three narrow ribbons as shown in fig 13 were attached to the stator trailing edge in different radial position these ribbons visualize the flow pattern at the near wake field and can be compared with those obtained from cfd simulation in fig 14 these two figures show that pump jet outlet streamlines unlike the common single marine propeller are almost straight and not swirling the latter is one of the most important advantages of pump jets against common propulsor since they make a large rotating region in the wakefield 5 3 spp test results as stated above one of the main purposes of this research was to determine the spp at different advance coefficients the spp at a specified velocity is the rotor spin in which the produced thrust is balanced with the resistance force from an operational point of view the vehicle could travel at a constant velocity that is with no acceleration only at these points as it was noted in section 4 3 each spp test was performed with three rotor spins and the net forces were measured these forces were presented in fig 15 these spins were selected so that the final residual thrusts had opposite signs therefore the spps were interpolated and the outcomes were tabulated in table 7 the uncertainty values at each test is also shown in fig 15 these values were obtained according to the load cells uncertainty during the experimental procedure these values were dimensionless drawing upon the definition of the residual thrust coefficient crt fig 16 shows the obtained numerical and experimental results at different axial velocities these graphs will coincide with each other at higher velocities as they become independent of axial or rotational velocity that is when they are dependent only upon j parameter in other words the results of the low speed condition are still dependent on the axial velocity and the curve trends are quite different with higher velocities as they show a minimum point circa j 1 the latter was also achieved in suryanarayana et al 2010c for they came to a similar trend in crt vs j variation at different rotating speeds the only condition tested at u 4 34 m s had a close result to the u 3 20 m s curve it can be concluded from fig 14 that the u 3 20 m s is the minimum axial velocity the results of which merely depend on j hence in order to validate the obtained cfd results the numerical simulations were executed at u 3 2 5 0 m s results were in a surprisingly good agreement with the experimental data and were approximately coincident with each other therefore the u 5 m s axial velocity was selected for other numerical cfd simulations 5 4 operational characteristic chart flow analysis as it was noticed before the pump jet was designed for higher velocities than the tested conditions the selected test matrices were settled down regarding the experimental limitation therefore further conditions were investigated numerically simulations were carried out in the range of 1 0 j 3 5 the pump jet was designed for j 2 3 the inlet velocity was set to u 5 m s as discussed in section 5 2 and different advance coefficients were obtained by varying the rotational speed the pump jet thrust and torque coefficients besides the overall efficiency were calculated using eq 7 the thrust coefficients of the pump jet components i e the rotor stator and the duct were plotted in fig 17 the obtained results showed that the rotor and stator thrust coefficients variation is quite small compared with the conventional propellers as the j parameter varies however the duct profile with negative thrust coefficients i e drag forces consumes a remarkable part of the produced thrust especially at high advance coefficients this shows that the duct profile design plays a serious role in the overall operation of the pump jet system the results of the open water condition are also depicted in fig 17 at four different advance coefficient equaling j 2 3 2 5 2 7 2 9 the obtained results for the rotor and the stator thrust coefficient show quite similar results as the behind hull condition however the duct coefficients show approximately 15 20 percent deviation with the fully simulated condition the numerical torque coefficients results were also depicted in fig 18 for the rotor stator and the whole body roll moments it is obvious that the rotor and stator moments have opposite signs for a better comparison only their magnitudes were plotted in the figure the torque coefficients are rather constant especially at high advance coefficients furthermore the torque coefficients of the open water status were shown in this figure the same trend is observed for both the open water and the behind hull conditions since the open water total thrust coefficients are smaller than the behind hull condition and the rotor roll moment coefficients are approximately the same the overall open water efficiencies are smaller the reason is only due to the increase in duct drag force the two above mentioned small changes in thrust and torque coefficients compared with common marine propellers against the j parameter as well as the higher efficiencies are the main unique features of pump jet systems as shown in fig 18 the pump jet efficiency in its operational feature is in the range of 0 30 η 0 82 the maximum value of which is about 10 15 percent higher than the usual single or ducted propeller systems the obtained results for the torque coefficients showed that the stator blades have hyper neutralized the rotor moment thus the net roll moment was in the stator moments direction as indicated earlier roll moment neutralization by stator blades smoothed out the outlet streamlines this leads to more hidden motion and decreases the hydrodynamic noises of the vehicle and hence it could be hardly identified the rotor and the stator pressure distribution was illustrated at j 2 7 in fig 19 a b it can be concluded that as the radial distance increases the rotor back surface pressure will not notably change except for near the blade tip unlike the rotor blades the stator backside surfaces will suffer smooth pressure increment in the radial direction this will create a high pressure gradient region near the rotor trailing edge these pressure contours show that the pressure and suction sides of the rotor and stator blades are positioned in opposite directions which produces a reverse roll moment as well as further thrust thus the stator design has a key role in the pump jet overall efficiency a similar trend was observed for other advance coefficients the pressure coefficient distribution was plotted over the radial sections and the velocity contours were illustrated in axial sections fig 20 shows the distribution of the pressure coefficient separately for the rotor and stator blades at various sections the letter c in the horizontal axis represents the chord length at each radial section the obtained results show that the pressure gradient of the face and back side of the rotor blades will generally increase by increasing the radial distance while the stator blades face and back side pressure gradients will not significantly change in radial direction especially near the tips furthermore the effect of the advance coefficient on the pressure coefficient distribution was investigated in fig 21 for j 2 1 2 5 2 9 3 2 at r r 0 75 results show a slight decrease in pressure gradients between the fore and back side of the rotor by increasing the j parameter this will lead to a small reduction in the rotor generated thrust in addition for a better understanding of the velocity distribution results were discussed at various axial sections in fig 22 longitudinal sections were located at x d 0 11 0 0 22 where x is the axial distance to the rotor stator mid surface the axial velocity contour was demonstrated at these sections radial velocity distribution is calculated on these surfaces as was discussed in section 2 for the mpm technique the profile of the rotor inlet velocity smoothly increases in the radial direction while the outlet profile strongly changes in this order the overall velocity magnitude was increased in this section due to the induced rotational velocity effect a low speed region is formed around the rotor trailing edge which is suggestive of the trailing vortex sheet the stator outlet profile is similar to the rotor outlet with a reduction in magnitude the zero velocity at the rotor and stator tips is owed to the existence of duct geometry the streamlines around the pump jet are also depicted at j 2 7 in fig 23 this figure shows that only a hub vortex is created in the wake region while the main flow pattern is relatively straightforward therefore unlike conventional propeller a serious part of the flow kinetic energy is not wasted and as a result the overall efficiency will increase 6 conclusions the steady state 3d turbulent and periodic cfd simulations were carried out besides several experimental towing tank tests around a designed pump jet the following results were accrued from the research project a proper stator profile will neutralize the rotor roll moment and creates further thrust force this will increase the overall efficiency the duct profile design is very serious too an inappropriate profile will consume a significant part of the rotor thrust the residual thrust curves versus j are still dependent on the velocity at low axial or rotational speeds the variations of the pump jet thrust and torque coefficients were small compared with the common propulsion systems these changes decrease as the j parameter increase the efficiency of the designed pump jet was in the range of 30 82 for j 1 0 3 2 at the behind hull condition numerical simulations showed that the main part of the duct outlet streamlines was aligned with the far field flow with a near free stream velocity magnitude a swirling hub vortex was formed in the wake region the open water outcomes showed that only the duct coefficients results vary compared to the behind hull condition the rotor and the stator thrust and torque coefficients are approximately similar to the behind hull condition the efficiency of the open water condition is about 10 15 percent higher than the behind hull condition nomenclature u axial velocity n rotor rotational speed r d rotor radius and diameter j advanced coefficient c rt residual thrust coefficient cd drag coefficient re reynolds number t thrust force dbody body drag force q roll moment kt coefficient kq torque coefficient r radial distance from the axis of revolution l axial distance from the rotor stator mid surface η pump jet efficiency 
22814,in the present study a post swirl pump jet system was designed for an axisymmetric underwater vehicle in order to evaluate the design procedure several experiments such as bollard pull self propulsion point spp and bare hull resistance tests were conducted in a towing tank on a full scale model further conditions were performed numerically at higher velocities to determine the characteristic chart and flow pattern analysis both open water and behind hull conditions were simulated the realizable k ε turbulence model and the mixing plane method mpm were utilized in a periodic domain for numerical simulations the obtained results showed that the variations of hydrodynamic coefficients especially the torque coefficient against advance coefficient were much smaller than conventional propellers moreover the net imbalance roll moment was quite small in all conditions suggestive of accurate stator design the stator also created additional thrust and hence increased the overall performance up to 82 percent in the behind hull condition keywords propulsion system periodic boundary condition cfd simulation pump jet towing tank 1 introduction pump jet is a marine propulsion system which creates the required thrust for the fitted body the main two features of this system against conventional propellers are first neutralizing the rotor roll moment via the stator and second higher performances since stator blades participate in thrust production the mechanical arrangement contains a ducted propeller with either a pre swirl or a post swirl stator a schematic of a post swirl pump jet with its connected shaft is depicted in fig 1 the use of pump jet was developed due to the advances made in high power marine engines and implemented in order to obtain higher velocities and performances these systems can reach higher speed compared to the common single or ducted propellers before the onset of cavitation furthermore they have higher power density and lower noise level unlike common marine propellers pump jets are efficient in shallow waters protecting the rotational element because of the installed duct this makes their operation safe around swimmers and aquatic life as it was indicated earlier the pump jet propulsor can be considered as a ducted propulsion system containing a far closed stator a decelerating duct is usually used for the pump jets proper design of the duct profile is very crucial an incorrect design can waste a considerable amount of the pump jet generated thrust the stator design also plays a serious role in the pump jet operation the main function of the stator blades is first to counteract the rotor roll moment and then creating thrust force for better performance these blades receive the rotor outlet swirling flows and if correctly designed they will leave axial flow with approximately free stream velocity magnitude behind therefore unlike the conventional propellers the swirling flow energy will not waste to the surroundings thus the performance will increase these systems can achieve high performances as 90 percent or higher provided that they are accurately designed furuya and chiang 1988 motallebi nejad et al 2017 investigation of pump jet hydrodynamic characteristics will aid us to both understand the operational features and evaluate the design procedure as well the hydrodynamic coefficients can be determined using the captive model test as well as system identification techniques in free running experiment saeidinezhad et al 2015 these coefficients can also be calculated using computational fluid dynamic cfd simulations many researchers have examined designing and flow pattern analysis in pump jet thrusters so far a brief overview of the main numerical and experimental studies is presented in the following paragraphs the early design procedure was introduced by henderson et al 1964 the problems of shroud design skewed vanes and unsteady force action were considered and discussed blade modeling and fluid flow simulation around marine propellers are very difficult due to the geometrical and physical complexity ivanell used the fan boundary condition instead of simulating the rotor blades for a pump jet the results showed good agreement only for the global parameters with complete blade simulations ivanell 2001 geerts studied the secondary flows around an axial flow pump using experimental and numerical techniques geerts 2006 as the experimental limitations the numerical cfd simulations were implemented for flow analysis das and coworkers designed a pump jet using the axial flow turbo machinery concepts das et al 2006 they relied on the experiments used in the turbo machinery design and applied them in marine propulsors the main aim of their research was to demonstrate the capability of cfd codes in complex 3d flow analysis most of the experimental research works have been performed on the scaled geometries or on the full scale model in wind tunnels these results should be then extrapolated for real configuration in seawater dropkin and coworkers presented a method to combine cfd results with subscale experimental data to improve full scale performance prediction dropkin et al 2011 xiao jun and coworkers investigated the idea of using two and four distributed pump jet over the body lü et al 2014 ahn and kwon determined the performance of a ring rotor with the rotor blades interconnected with a circumferential ring at the tip ahn and kwon 2015 owing to the duct existence in pump jets the onset of cavitation is delayed pan and coworkers numerically studied the unsteady flow cavitation of a pump jet pan et al 2015 the results showed that due to the tip vortex and tip clearance cavitation leads to a further loss in the efficiency of the cavitating flows the number of pump jet blades is much greater than common propellers hence they will have a great computational cost if they want to be completely simulated a periodic simulation can be very advantageous in this condition this method was utilized to determine the hydrodynamic characteristics of a ducted propeller and a pump jet in motallebi nejad et al 2017 the results were shown to have a perfect agreement with complete simulations huyer sinusoidally varied the pitch angle of the stator blade around the circumference to make lateral force his inventive idea enabled the vehicles to make side forces even at zero axial velocity huyer 2015 recently lu and coworkers numerically investigated the tip clearance effect on their designed pump jet characteristics in lu et al 2017 the formation and development of the tip clearance flows were investigated in addition to the tip leakage vortex analysis furthermore the influences of the tip clearance size on the pump jet performance and the cavitation characteristics were discussed in this research many experimental types of research were also carried out in pump jet propulsion systems suryanarayana and coworkers suryanarayana et al 2010a 2010b 2010c investigated the wake analysis and flow characteristics of their own designed pump jet in wind and cavitation tunnel the spp test and net torque measurement were considered in addition to the cavitation and attack angle effects this noteworthy method improved the results obtained from linear extrapolation of reynolds number the literature survey on the pump jet propulsor shows that there are generally a few investigations performed on this type of propulsion system numerical analysis generally used conventional propellers data for cfd validation which is not true due to the differences in flow pattern caused by the rotor stator interaction on the other hand most experimental investigations are influenced by reynolds number and scale effects hence the main aim of the present research is to examine the fluid flow and hydrodynamic characteristic chart of a designed pump jet to that end a full scale pump jet model was constructed and several experimental tests were planned in a towing tank the obtained global results such as thrust and torque coefficients were used for cfd validation afterward further numerical simulations were carried out in order to investigate the fluid flow pattern and determine the hydrodynamic characteristics chart 2 body model the pump jet was designed based on the axial flow compressor technique for a high speed underwater vehicle with a combined boundary element method bem and cfd approach an in house bem code was developed to that end and the results were compared with cfd data in a design loop the design procedure in pump jet propulsion system is usually considered secret and not available in the open literature however the design loop generally deals with altering the geometrical parameters such as blades number z pitch to diameter ratio p d rake and other parameters in order to provide the required thrust force and neutralize the roll moment the bem was utilized for a quick parametrical analysis this method is based on the potential flow approach and considers the viscous effects using semi empirical equations the rotor stator interactions were neglected during these primary simulations afterward detailed three dimensional reynolds averaged navier stokes rans and turbulence cfd investigations were performed on those with highest performances selected from the previous phase using mpm the rotor and stator inlet and outlet flow characters were obtained from these simulations in addition to the global thrust and torque values the geometrical parameters are modified until the required operational characters are achieved the blade tip clearance is a very important parameter which directly influences on the performance and the radial distribution of velocity component of the pump jet lu et al 2017 in the present work this quantity was considered about 0 85 of the rotor diameter a full scale model was then constructed after finalizing the design loop the full scale body and the propulsion system were manufactured from aluminum using cnc machine to obtain the required surface shape of the blade with 0 05 mm accuracy the main specification of the body and the propulsion unit were given in table 1 the model was equipped with a seven hp three phased electrical motor four handles were utilized to fix the duct into the tail section preventing vibrations these handles were also useful in installing the rudder or elevator fins for real configurations as depicted in fig 2 for the mk 48 torpedo and the saab auv real vessels usually use two rudders and two elevators to guide and control the vessel these control surfaces are usually installed on the duct or just after the duct the general arrangements of the model comprised mainly of the nose mid body electrical motor tail and the pump jet as was shown in fig 3 a an isometric view of the behind hull condition i e complete final body along with the installed pump jet was provided in fig 3 b 3 computational technique a brief overview of the numerical procedure and the employed equations in addition to the boundary conditions were described in the following sections 3 1 governing equations the rans equations were implemented besides the continuity equation for numerical simulations the flow was assumed to be incompressible three dimensional steady state and turbulent the governing equations can be stated as eqs 1 and 2 1 u i x i 0 i 1 2 3 2 ρ u i u j x j p x i x j μ u i x j ρ u i u j i j 1 2 3 where u i denotes the averaged velocity in i direction p presents the averaged pressure μ the molecular viscosity and ρ u i u j indicates the reynolds stress the r e a l i z a b l e k ε turbulence model is utilized to accomplish the closure of the momentum equation this model was described as eqs 3 and 4 and the turbulent viscosity is calculated via eq 5 the model differs from the standard k ε model in two ways this model contains a new formulation for the turbulent viscosity furthermore a new transport equation for the dissipation rate has been derived from an exact equation for the transport of the mean square vorticity formulation 2015 3 ρk t ρu j k x j x j μ μ t σ k k x j g k g b ρε y m s k 4 ρε t ρu j ε x j x j μ μ t σ ε ε x j ρ c 1 s ε ρ c 2 ε 2 k υ ε c 1 ε ε κ c 3 ε g b s ε where c 1 max 0 43 η η 5 η s k ε s 2 s i j s i j in the above equation g k g b are the generation of turbulent kinetic energy due to the mean velocity gradients and buoyancy respectively the y m represents the contribution of the fluctuating dilation in compressible turbulence to the overall dissipation rate this term can be neglected in incompressible simulation like other k ε models the eddy viscosity is calculated using eq 5 the difference between the realizable k ε model and the standard and rng k ε models is that c μ is not a constant value more details about the model can be found in the literature 5 μ t c μ ρ k 2 ε it should be noted that choosing a suitable turbulence model for a rotating flow is depending upon the swirl number this parameter is defined as the angular momentum to the axial momentum flux ratio as shown in eq 6 6 s r ω v d a r u v d a where r is the radial distance while ω and v are the angular velocity and velocity vector respectively r is the hydraulic radius and v d a denotes to the dot product of the surface normal vector and the velocity vector the r e a l i z a b l e k ε turbulence model is recommended for s 0 5 in ansys 2015 the swirl number for the present study was in the range of s 0 15 0 2 therefore the r e a l i z a b l e k ε model was chosen continuity momentum and turbulence equations were coupled and solved via the simple pressure based algorithm with the ansys fluent16 1 solver the standard wall functions which are based on the work presented in launder and spalding 1983 are implemented in order to model the near wall flow treatment these wall functions have been widely used in industrial flows the convergence criterion was considered as 10 5 the second order scheme was utilized for the pressure equation while the second order upwind scheme was implemented for other equations discretization the hydrodynamic characteristics of the propulsion systems are usually state using non dimensional coefficients the overall efficiency was defined based on the rotor stator and duct coefficients the advance coefficient j and related thrust and torque coefficients k t k q as well as the overall efficiency η and the residual thrust c r t are defined in eq 7 based on the rotor and stator thrust t r o t o r t s t a t o r and the duct drag d d u c t forces the reynolds number re is also defined based on the model length l furthermore the reynolds number r n 0 7 is presented based on the chord length c kinematic viscosity ν and rotational velocity ω at radial position r r 0 7 as demonstrated in streckwall et al 2013 7 j u n d r o t o r r e ρ u l μ r n 0 7 c 0 7 ω 2 r 0 7 2 u 2 υ k t r o t o r t r o t o r ρ n 2 d r o t o r 4 k q r o t o r q r o t o r ρ n 2 d r o t o r 5 k t s t a t o r t s t a t o r ρ n 2 d r o t o r 4 k q s t a t o r q s t a t o r ρ n 2 d r o t o r 5 t tot t rotor t stator d duct k t t tot ρn 2 d r o t o r 4 η j 2 π k t k q r o t o r c r t t tot d b o d y ρ n 2 d r o t o r 4 3 2 boundary condition in the present study a cylindrical domain was utilized to model the far field boundary for numerical simulations the thin handles shown in fig 3 were neglected during the pump jet numerical simulations therefore the periodic boundary condition can be implemented to reduce the computational costs this method was also used in motallebi nejad et al 2017 the domain was decomposed into two regions the rotor region is coupled with the rest of the computational domain using mpm and rotation is achieved in the rotor region using a moving reference frame mrf the mpm was employed instead of the common mrf technique in order to consider the rotor stator interaction it should be emphasized that the mrf model is only applicable in case a relatively uniform flow passes through the interfaces this assumption is not true for rotor stator simulation the mpm treats each zone as a steady state region and the flow field data are passed through boundaries from the adjacent zones these data are then spatially averaged or mixed at the mixing plane interface which eliminates any unsteadiness that would arise due to circumferential variations despite the simplifications of this method the obtained results provide logical approximations of the time averaged flow field ansys 2015 more details about the mpm can be found in the literature the pressure outlet and the pressure inlet boundary conditions were utilized at the mixing plane interfaces the inlet outlet and the far field boundary conditions as well as the applied coordinate system were shown in fig 4 a these boundaries were considered far enough to have no effects on the numerical results the upstream and downstream length and the domain diameter were selected 5 12 and 10 times of the auv diameter respectively the mixing plane interfaces were implemented at both rotor inlet and outlet faces as shown in fig 4 b since the rotor and stator blades number were different the angular domains do not match together results will not be affected using the periodic boundary condition as stated in motallebi nejad et al 2017 the open water condition was also considered in the present research in order to ensure that a uniform flow arrives at the pump jet entry the hull body was omitted and only the tail profile remained as a result the open water geometry was obtained as shown in fig 4 c all of the applied boundary conditions for the open water status are the same as those stated in fig 4 a except for the tail boundary 3 3 grid generation the ansys mesh utility was implemented for grid generation the produced grid notably influences the computational costs accuracy and the convergence rate the near wall grids directly affect the pressure gradients and the shear stress prediction as the blade profile complexity it was difficult to generate a fully structured grid for the entire domain therefore a hybrid grid was implemented and structured prism cells were provided for the near wall region especially for the boundary layer region and unstructured polyhedral cells were used for the remained regions as shown in fig 5 the generated grids have an acceptable to excellent quality as classified in ansys mesh documents ansys 2011 the maximum value for the skewness and aspect ratio parameters were 0 95 and 22 respectively it is crucial to ensure that the obtained results are independent of the grid number and types in the present research the grid convergence index gci technique was utilized to evaluate the discretization error and numerical uncertainties this method was introduced in roache 1997 this method quantifies the uncertainty and estimates the numerical error of a cfd simulation special consideration should be taken to account for turbulence modeling or artificial dissipation the gci approach presents a more conservative procedure in addition to obtaining a good error estimation the notation gci indicates that the calculated values are how far away from the exact values therefore small values of gci mean that the results are close to the exact values in order to implement this method three different meshes were required these three cases were described as s 1 s 2 and s 3 from the finest to the coarsest mesh with n 1 n 2 and n 3 number of elements a refinement factor shown as r was defined as r 21 n 1 n 2 1 3 it was recommended that r 3 should be applied to reduce the extrapolation errors hajivand and mousavizadegan 2015 according to the roache s method the convergence ratio was defined as eq 8 8 r ε 21 ε 32 where ε 21 ε 32 refers to the difference of 2 1 and 3 2 grid results respectively three different conditions were possible for the convergence ratio r 1 grid divergence r 0 oscillating convergence 0 r 1 monotonic grid convergence in case of the grid convergence richardson extrapolation was utilized to estimate the convergence rate the accuracy order of the algorithm is calculated in eq 9 where r is the grid refinement factor 9 p ln ε 32 ε 21 ln r finally the gci is obtained by applying eq 10 where f s is a safety factor for convergence study with a value of f s 1 25 as advised in roache 1997 the e i j symbol is the approximate relative error 10 g c i i j f s e i j r p 1 as was stated before the gci evaluates the results changes with more grid refinement the small value of gci indicates that more grid refinement will not improve the results in the present research four different grids were generated and the global thrust and torque coefficients were selected for grid convergence investigation as presented in table 2 for the behind hull condition the above mentioned gci parameters were tabularized in table 3 for the medium fine and very fine grids at j 2 7 the results showed small values for the g c i 1 2 in both thrust and torque coefficients consequently the fine grid was employed for other simulations the averaged values of the y parameter around the bare hull and the pump jet were about 26 and 34 respectively furthermore the internal flow field variation with grid refinement was investigated using the velocity profile distribution at 0 y 0 1 and x 2 45 m equal to 0 05 m behind the pump jet at wake region as depicted in fig 6 the results show that the coarse and medium results deviate while the fine and very fine cases are coincide with each other 4 experimental procedure the experimental procedures were described in the next sub sections introducing the applied towing tank and tests setup 4 1 towing tank specifications data acquisition system a high speed towing tank at a maximum speed of 7 m s for fully submerged bodies was utilized to accomplish the captive model tests the length width and the depth dimensions of the towing tank were 150 m 7 m and 3 5 m respectively a trimming tank was applied for model preparation and initial tests in addition two inclined flat plates beside the trimming tank were utilized as wave dampers the minimum length for data collection at the maximum speed was 75 m the towing tank was equipped with an 85 kw dc motor the velocity of the carriage was controlled within the accuracy of 0 01 m s a three component calibrated load cell was employed to measure the applied forces on the model the instantaneous forces were recorded at the frequency of 600 hz and used for data averaging the maximum measurable force by the load cell in x y and z direction was 250 n 1 a user interface labview program was developed to acquire and display the real time measurement data the rotor operations were fully recorded using a human machine interface hmi an electrical board provided the motor with on off keys and speed controls mechanism the hmi was also used to measure the accelerations during the test this electrical equipment was installed underneath the carriage rail and moved with the model as shown in fig 7 the data cables were driven via the vertical struts the rotor spin was regulated with a driver unit this rotational velocity was controlled and measured by an encoder installed on the motor 4 2 experimental setup the body was connected to the carriage with two naca type section hydrofoils as vertical struts the struts submerged to a depth of 0 95 m in the water having a length of 1 35 m this depth was about three times of the auv diameter and was sufficient to dissipate the free surface effect as presented in hoerner 1965 this assumption was also confirmed during the bollard pull test since no changes were observed in the water surface level in all conditions a laser beam was used to ensure that the body and the struts were in exact coincidence with the plumb line since the electric motor was employed to drive the propulsion unit the body had to be completely sealed therefore leakage tests were performed using air with pgauge 0 4 0 5 bar and the weicon lecksuch spray was used to visualize eventual bubbles the sealing test was also arranged in a tub for both static and dynamic parts respectively i e o rings and the rotating shaft the selected tub depth was similar to that of the towing tank vertical struts arrangement struts should be installed on the body in order to have minimal effect on the flow pattern and the results during the test the vertical struts arrangement altered depending on the tests in case of the bollard pull test vertical struts were positioned side by side as depicted in fig 8 providing vertical force measurements in heave direction so the roll moments could be evaluated from the vertical force component and the moment definition in other conditions in order to reduce the flow disturbance these struts were positioned in a tandem mode as depicted in fig 7 4 3 scope of the experiment the main purposes of the experiments were to investigate the spp bollard pull and the inclined body conditions only the net forces propulsion total thrust minus body drag force were measured along with the load cells so the bare hull resistance tests were also planned to evaluate pure thrust force and the thrust deduction factor the bollard pull condition was desirable as the maximum torque coefficient occurs in this condition in this test the net roll moment of the whole body and the pump jet were determined the test conditions were listed in the following test matrices for the above mentioned investigation each test was repeated at least three times under the same operating conditions and the mean values were reported it should be noted that the pump jet was designed for higher velocities 35 to 40 knot but test matrices were planned according to the towing tank maximum velocity and the electric motor power it should be noted that merely the global results i e total thrusts and moments were measured in the experiments and the flow pattern analysis were only investigated in the numerical simulations 4 3 1 bare hull resistance test as it was noticed above we had to measure the bare hull resistance in order to determine the net thrust forces in the spp test these tests were performed as listed in table 4 conditions a conical teflon part was installed instead of the pump jet to prevent additional flow separations at the tail region this part also acts as a sealant it should be emphasized that both the bare hull and the struts forces were measured in this test therefore the net propulsion forces could be obtained the conical part and the final bare hull configuration is depicted in fig 9 4 3 2 bollard pull condition test the bollard pull tests were executed under table 5 conditions to measure the produced thrusts beside the net roll moments 4 3 3 spp test the following tests as stated in table 6 were carried out to determine the spp only one test was performed in 4 34 m s the chord length based reynolds number is also reported for each test almost all tests are carried out at reynolds number higher than 10 5 furthermore the flow around the pump jet has high turbulent intensity due to the rotor rotation effects therefore the flow can be considered as a turbulent flow 5 results the results of the above experimental conditions were discussed in the following sections the numerical method was applied for both cfd validation and higher velocity simulations as well the hydrodynamic characteristics chart extraction and the flow pattern investigations were accomplished in the cfd simulations 5 1 estimation of the bare hull drag in order to find out the pump jet net thrust force the bare hull resistance was estimated at different axial velocities as mentioned in section 4 3 the pump jet was replaced by a conical part to prevent flow separations at the tail cut off section the body was towed at different velocities under condition indicated in table 4 yielding r e 2 7 13 5 10 6 which was defined in eq 7 fig 10 shows the numerical and experimental net resistance force coefficient made by the bare hull the cd versus reynolds number was calculated to evaluate resistance coefficient dependency on reynolds number as it can be seen the variation of the resistance coefficient against reynolds number is quite insignificant at r e 8 10 6 and higher the obtained resistance forces were then used to extract the net thrust forces of the pump jet the velocity contours at the propeller reference plane and from the front view were shown in fig 11 the velocity contours show that the wakefield is affected by the installed handles on the body and 4 low speed regions are observed at the wake plane 5 2 bollard pull test results during the bollard pull test both the roll moment and the pump jet thrust were measured at four different rotating speeds numerical simulations were carried out under the same experimental conditions i e j 0 the obtained numerical and experimental results were presented in fig 12 since the motor was high loaded during this test it was impossible to attain higher spins in addition the pump jet thrust led to a remarkable torque on the vertical struts junctions especially at high spins on the other hand the thrust and torque coefficients will not significantly change by increasing the rotational speed as they are all in a constant j it should be emphasized that the reported thrust and torque values are the summations of the entire pump jet components i e the rotor stator and the duct the net imbalance roll moment at the maximum speed was about 15 nm this value was less than 4 6 percent of the rotor moment according to the numerical outcomes it should be noted that the bollard pull condition is a particular status compared with the operational condition in this condition the rotor inlet flow angle is quite large about 21 in the present study and a relatively large separation region will be formed around the rotor blades the separation region is large at low velocities and it is changed at higher velocities the small values obtained for the net roll moment indicate that the stator blades had an excellent operation these blades had almost entirely neutralized the rotor roll moment in order to visualize the stator outlet flow three narrow ribbons as shown in fig 13 were attached to the stator trailing edge in different radial position these ribbons visualize the flow pattern at the near wake field and can be compared with those obtained from cfd simulation in fig 14 these two figures show that pump jet outlet streamlines unlike the common single marine propeller are almost straight and not swirling the latter is one of the most important advantages of pump jets against common propulsor since they make a large rotating region in the wakefield 5 3 spp test results as stated above one of the main purposes of this research was to determine the spp at different advance coefficients the spp at a specified velocity is the rotor spin in which the produced thrust is balanced with the resistance force from an operational point of view the vehicle could travel at a constant velocity that is with no acceleration only at these points as it was noted in section 4 3 each spp test was performed with three rotor spins and the net forces were measured these forces were presented in fig 15 these spins were selected so that the final residual thrusts had opposite signs therefore the spps were interpolated and the outcomes were tabulated in table 7 the uncertainty values at each test is also shown in fig 15 these values were obtained according to the load cells uncertainty during the experimental procedure these values were dimensionless drawing upon the definition of the residual thrust coefficient crt fig 16 shows the obtained numerical and experimental results at different axial velocities these graphs will coincide with each other at higher velocities as they become independent of axial or rotational velocity that is when they are dependent only upon j parameter in other words the results of the low speed condition are still dependent on the axial velocity and the curve trends are quite different with higher velocities as they show a minimum point circa j 1 the latter was also achieved in suryanarayana et al 2010c for they came to a similar trend in crt vs j variation at different rotating speeds the only condition tested at u 4 34 m s had a close result to the u 3 20 m s curve it can be concluded from fig 14 that the u 3 20 m s is the minimum axial velocity the results of which merely depend on j hence in order to validate the obtained cfd results the numerical simulations were executed at u 3 2 5 0 m s results were in a surprisingly good agreement with the experimental data and were approximately coincident with each other therefore the u 5 m s axial velocity was selected for other numerical cfd simulations 5 4 operational characteristic chart flow analysis as it was noticed before the pump jet was designed for higher velocities than the tested conditions the selected test matrices were settled down regarding the experimental limitation therefore further conditions were investigated numerically simulations were carried out in the range of 1 0 j 3 5 the pump jet was designed for j 2 3 the inlet velocity was set to u 5 m s as discussed in section 5 2 and different advance coefficients were obtained by varying the rotational speed the pump jet thrust and torque coefficients besides the overall efficiency were calculated using eq 7 the thrust coefficients of the pump jet components i e the rotor stator and the duct were plotted in fig 17 the obtained results showed that the rotor and stator thrust coefficients variation is quite small compared with the conventional propellers as the j parameter varies however the duct profile with negative thrust coefficients i e drag forces consumes a remarkable part of the produced thrust especially at high advance coefficients this shows that the duct profile design plays a serious role in the overall operation of the pump jet system the results of the open water condition are also depicted in fig 17 at four different advance coefficient equaling j 2 3 2 5 2 7 2 9 the obtained results for the rotor and the stator thrust coefficient show quite similar results as the behind hull condition however the duct coefficients show approximately 15 20 percent deviation with the fully simulated condition the numerical torque coefficients results were also depicted in fig 18 for the rotor stator and the whole body roll moments it is obvious that the rotor and stator moments have opposite signs for a better comparison only their magnitudes were plotted in the figure the torque coefficients are rather constant especially at high advance coefficients furthermore the torque coefficients of the open water status were shown in this figure the same trend is observed for both the open water and the behind hull conditions since the open water total thrust coefficients are smaller than the behind hull condition and the rotor roll moment coefficients are approximately the same the overall open water efficiencies are smaller the reason is only due to the increase in duct drag force the two above mentioned small changes in thrust and torque coefficients compared with common marine propellers against the j parameter as well as the higher efficiencies are the main unique features of pump jet systems as shown in fig 18 the pump jet efficiency in its operational feature is in the range of 0 30 η 0 82 the maximum value of which is about 10 15 percent higher than the usual single or ducted propeller systems the obtained results for the torque coefficients showed that the stator blades have hyper neutralized the rotor moment thus the net roll moment was in the stator moments direction as indicated earlier roll moment neutralization by stator blades smoothed out the outlet streamlines this leads to more hidden motion and decreases the hydrodynamic noises of the vehicle and hence it could be hardly identified the rotor and the stator pressure distribution was illustrated at j 2 7 in fig 19 a b it can be concluded that as the radial distance increases the rotor back surface pressure will not notably change except for near the blade tip unlike the rotor blades the stator backside surfaces will suffer smooth pressure increment in the radial direction this will create a high pressure gradient region near the rotor trailing edge these pressure contours show that the pressure and suction sides of the rotor and stator blades are positioned in opposite directions which produces a reverse roll moment as well as further thrust thus the stator design has a key role in the pump jet overall efficiency a similar trend was observed for other advance coefficients the pressure coefficient distribution was plotted over the radial sections and the velocity contours were illustrated in axial sections fig 20 shows the distribution of the pressure coefficient separately for the rotor and stator blades at various sections the letter c in the horizontal axis represents the chord length at each radial section the obtained results show that the pressure gradient of the face and back side of the rotor blades will generally increase by increasing the radial distance while the stator blades face and back side pressure gradients will not significantly change in radial direction especially near the tips furthermore the effect of the advance coefficient on the pressure coefficient distribution was investigated in fig 21 for j 2 1 2 5 2 9 3 2 at r r 0 75 results show a slight decrease in pressure gradients between the fore and back side of the rotor by increasing the j parameter this will lead to a small reduction in the rotor generated thrust in addition for a better understanding of the velocity distribution results were discussed at various axial sections in fig 22 longitudinal sections were located at x d 0 11 0 0 22 where x is the axial distance to the rotor stator mid surface the axial velocity contour was demonstrated at these sections radial velocity distribution is calculated on these surfaces as was discussed in section 2 for the mpm technique the profile of the rotor inlet velocity smoothly increases in the radial direction while the outlet profile strongly changes in this order the overall velocity magnitude was increased in this section due to the induced rotational velocity effect a low speed region is formed around the rotor trailing edge which is suggestive of the trailing vortex sheet the stator outlet profile is similar to the rotor outlet with a reduction in magnitude the zero velocity at the rotor and stator tips is owed to the existence of duct geometry the streamlines around the pump jet are also depicted at j 2 7 in fig 23 this figure shows that only a hub vortex is created in the wake region while the main flow pattern is relatively straightforward therefore unlike conventional propeller a serious part of the flow kinetic energy is not wasted and as a result the overall efficiency will increase 6 conclusions the steady state 3d turbulent and periodic cfd simulations were carried out besides several experimental towing tank tests around a designed pump jet the following results were accrued from the research project a proper stator profile will neutralize the rotor roll moment and creates further thrust force this will increase the overall efficiency the duct profile design is very serious too an inappropriate profile will consume a significant part of the rotor thrust the residual thrust curves versus j are still dependent on the velocity at low axial or rotational speeds the variations of the pump jet thrust and torque coefficients were small compared with the common propulsion systems these changes decrease as the j parameter increase the efficiency of the designed pump jet was in the range of 30 82 for j 1 0 3 2 at the behind hull condition numerical simulations showed that the main part of the duct outlet streamlines was aligned with the far field flow with a near free stream velocity magnitude a swirling hub vortex was formed in the wake region the open water outcomes showed that only the duct coefficients results vary compared to the behind hull condition the rotor and the stator thrust and torque coefficients are approximately similar to the behind hull condition the efficiency of the open water condition is about 10 15 percent higher than the behind hull condition nomenclature u axial velocity n rotor rotational speed r d rotor radius and diameter j advanced coefficient c rt residual thrust coefficient cd drag coefficient re reynolds number t thrust force dbody body drag force q roll moment kt coefficient kq torque coefficient r radial distance from the axis of revolution l axial distance from the rotor stator mid surface η pump jet efficiency 
