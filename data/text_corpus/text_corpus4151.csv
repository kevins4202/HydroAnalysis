index,text
20755,although being a common situation for fish and underwater vehicles limited research has been reported for a fish like body swimming in oblique incoming flows the present work employs the immersed boundary lattice boltzmann method to numerically study the dynamics of this problem a more comprehensive analysis method which utilizes the effective force parameters that consolidate the angle of attack aoa into the traditional force parameters is proposed for investigating the dynamics of cases with non zero aoa several distinct features in terms of the dynamic performance the periodic features and the flow field characteristics are presented for the dynamic performance undulation amplitude plays a more dominant role than the undulation form in thrust generation the periodic features revealed by the fourier spectra present increasing complexity with larger aoa besides three flow regimes are identified one of which observes hierarchical vortex structures with different orders in time and space the small scale vortex street generated by undulation is local in both time and space and it is embedded in the large scale vortex street generated by the body and the free stream keywords fish like swimming oblique flows fluid dynamics immersed boundary lattice boltzmann method 1 introduction attributes to its superior efficiency and maneuverability fishlike swimming is a promising propulsion technique for underwater vehicles a major requirement of underwater vehicles is to accomplish tasks such as monitoring underwater sites and mapping the seafloor and maneuvering along the designed trajectories in complex flows the complex flows can be uniform oblique flows or unsteady altered flows both can perturb swim liao 2007 and affect maneuverability compared with fish motion in still water or uniform flow that aligns with the swimming direction much less is known for fish motion in complex environments here we investigated fishlike swimming in uniform oblique flows numerically and proposed an effective analysis perspective for this class of phenomena swimming of fish has been explored from various aspects including its kinematics breder 1926 gray 1933 videler and hess 1984 wassersug and hoff 1985 videler 1993 lauder and tytell 2005 zhong et al 2018 swimming mechanisms gray 1936 triantafyllou et al 2000 lauder and madden 2006 xia et al 2016 the impact of fins li et al 2017 zhao and dou 2019 ghommem et al 2020 han et al 2020 dynamics of fish school weihs 1973 2004 peng et al 2018 fish 1999 dong 2007 gao and triantafyllou 2018 as well as its applications of biomimetic robots lauder and madden 2006 scaradozzi et al 2017 salazar et al 2018 du et al 2015 to name a few studies on the movements of fish can be dated back to the 17th century videler 1993 nowadays fish movements are recorded by high speed video cameras then digitalized and generalized by traveling waves from head to tail for bcf body and or caudal fin swimming modes as considered in this work and are finally expressed by sin cosine functions as fourier coefficients the precise kinematic studies of different species for both steady and unsteady swimming set the foundation for quantitative investigations of the swimming mechanisms the theoretical experimental and numerical works on swimming mechanisms are reviewed by trantafyllou et al triantafyllou et al 2000 and more recently by fish and lauder 2006 swimming mechanisms of both the individual fish and fish school have been analyzed thrust generation by the body tail and swimming energy efficiency are the main research topics for individual fish it has been shown that fish controls the flow by rhythmic oscillation from head to tail with increasing amplitude and the tail repositions the vortices to form a reverse karman vortex street in the wake in this way thrust can be generated for a steadily swimming fish with bcf mode fish can also achieve low drag when swimming at high speed by maintaining a fully attached turbulent boundary layer comparing to the body and the tail of a fish fish fins can be much more flexible its kinematics and hydrodynamics can also be more delicate standen and lauder 2005 ghommem et al 2020 performed numerical simulations of a flapping caudal fin with oscillation frequency over a range of strouhal numbers by immersed boundary method it shows that a flapping caudal fin can enhance thrust generation to achieve a better propulsion performance apart from the caudal fin the pectoral fins can also be major tools for thrust generation drucker and lauder 2000 fish can generate enough propulsion by pectoral fins alone at low swimming speed and enhance thrust generation by recruit additional fins at high speed in addition to the swimming mechanisms of individual fish interactions among organized formations of fishlike swimming also received much attention the hydrodynamics of fixed arrangement of fishlike swimming motions deng et al 2007 khalid et al 2018 park and sung 2018 and also the spontaneous collective locomotion of flapping plates are studied peng et al 2018 to reflect the coupling mechanisms for a group of self propelling structures to establish the important fundamental understanding of complex fish kinematics and hydrodynamics most pioneering studies simplify the flow environment as the still water or steady flows that align with the swim direction nonetheless complex flow environments are prevalent it can be steady oblique flow or unsteady altered flow both can perturb maneuverability in controlled experiments the direction of the flow can be well aligned with the moving direction nonetheless in practice the free stream direction can differ from the moving direction and makes a stable maneuvering challenging in such cases the free stream and the swimming direction form a non zero attack angle this can be a common situation faced by fish and underwater vehicles yet limited studies have been reported in this area in this work we numerically simulate the phenomena by the immersed boundary lattice boltzmann method ib lbm four types of kinematics k 1 to k 4 with fifteen values of aoa from 0 to 60 considered based on the simulation results dynamic analyses are performed it is found that with oblique incoming flows traditionally defined force parameters cannot correctly reflect the dynamics features neither the statistic transient forcing analysis nor fourier periodic feature analysis based on these traditional force parameters provides a satisfactory view for fish like swimming with non zero aoa to solve this problem we propose a more comprehensive perspective which is based on modified force parameters that consider the swimming direction to examine the dynamic features comparisons show that the proposed perspective well captures the intrinsic non homogenous features of the physical problem it is also more informative and can provide more instructive guidance for the design and control of the underwater vehicle operating in similar scenarios based on that the fish like swimming with aoa is comprehensively studied from three aspects the dynamic performance the periodic features and the flow field characteristics several interesting features are presented in these aspects the following context is organized as below section 2 introduces the numerical methods used in this work the problem setup and the numerical validations are described in section 3 section 4 studies fish like swimming with zero aoa and with different kinematics as base cases section 5 then investigates the cases with non zero aoas the problem encountered by using the traditional analysis perspective is discussed in section 5 1 1 the proposed new perspective of analysis is detailed in section 5 1 2 thereafter the dynamic performance and the periodic features of fish like swimming with aoa are investigated based on both the traditional and the proposed perspectives the flow field characteristics are also analyzed in section 5 the conclusions of this work are finally drawn in section 6 2 numerical method fish like swimming is a typical fluid structure interaction fsi problem immersed boundary method is an effective tool to simulate such type of problem it can be coupled with the traditional naiver stocks equations mittal and iaccarino 2005 the lattice boltzmann methods shao and liu 2018 and also the simplified lattice boltzmann method chen et al 2018a 2018b 2020 for a variety of stationary moving fsi phenomena in this work the immersed boundary lattice boltzmann method is applied to model the interactions between the fluid flow and the moving body the lattice boltzmann method is used for the simulation of the flow field and the immersed boundary method is implemented to simulate interactions between the moving boundary and the fluid flow fluid dynamics can be described at different levels such as macroscopic and mesoscopic levels the navier stokes n s equations describe the behavior of incompressible viscous flow from the macroscopic level 1a u 0 1b ρ u t u u p μ δ u f alternatively based on mesoscopic kinetic models the lattice boltzmann equation lbe describes weak compressible viscous flows through the chapman enskog expansion it recovers the n s equations with the second order accuracy with incompressible small mach number limit f α x e α δ t t δ t f α x t 1 τ f α x t f α e q x t f α δ t 2 f α e q x t ρ w α 1 e α u c s 2 e α u 2 2 c s 4 u 2 2 c s 2 f α 1 1 2 τ w α e α u c s 2 e α u c s 4 e α f in the above equations u ρ p and μ take their normal meanings as the velocity vector density pressure and dynamic viscosity and δ are the nabla and laplace operators besides x is the cartesian coordinate vector eulerian grid t and δ t indicates time and the time step respectively in the lbe f α and f α e q are the density distribution function and the equilibrium density distribution functions τ is a relaxation parameter and it is determined by υ τ 1 2 c s 2 δ t in which υ is the kinematic viscosity c s 2 1 3 for the d2q9 lattice model used here the value of e α and w α are listed in table 1 in the lbm the macroscopic properties are calculated by 3 ρ α f α p c s 2 ρ ρ u α e α f α 1 2 f δ t it is noted that an additional forcing term f is introduced to correctly consider the discrete lattice effects when introducing the force the form of lbe proposed by guo et al 2002 is used the force density is calculated by f 2 ρ δ u δ t δ u is the velocity correction term determined by the ibm u u δ u with u 1 ρ α e α f α being the predicted velocity in the immersed boundary method two sets of the grid are used they are the eulerian grid for the flow field and the lagrangian grid for the structures the velocity correction term δ u is defined on the eulerian grid and it is linked with the lagrangian grid by δ u x i j t l δ u b l x b l t d i j x i j x b l δ s l here the subscript b indicates boundary points x b l is the coordinate of the boundary points l is the index of boundary points and δ s l is the length of a boundary segment additionally d i j x i j x b l δ x i j x b l δ y i j y b l is a delta function here δ r is calculated by a smoothed piecewise function yang et al 2009 4 δ r 3 8 π 32 r 2 4 r 0 5 1 4 1 r 8 2 8 r 4 r 2 1 8 arcsin 2 r 1 0 5 r 1 5 17 16 π 64 3 r 4 r 2 8 r 2 16 14 16 r 4 r 2 1 16 arcsin 2 r 1 1 5 r 2 5 0 2 5 r the non dimensional distance between the eulerian and lagrangian grid points is defined as r x i x b l δ x i δ x i are the eulerian grid spacing in the boundary condition enforced ibm the velocity correction δ u b l is solved from the following equation system wu and shu 2009 5 u b l x b l t i j u x i j t d i j x i j x b l δ x δ y i j l δ u b x b l t d i j x i j x b l δ s l d i j x i j x b l δ x δ y the solution procedures can be summarized as follows 1 at time t t n obtain the density distribution functions f α by eq 2 calculate the macroscopic variables ρ p and u in eqs 2 and 3 2 solve eq 5 to obtain the velocity corrections δ u b on boundary points and map them to eulerian points 3 correct the fluid velocity by u u δ u and calculate the force density repeat these steps until convergence criteria are met the details of the numerical method can be found in the reference wu and shu 2009 in this way the no slip boundary conditions can be enforced through the immersed boundary method in the framework of the lattice boltzmann method 3 problem setup and numerical validations the fish like undulation is modeled by a traveling wave from head to tail of a naca0012 airfoil the undulation amplitude of the midline is given by 6 y m x b t a m x b cos 2 π x b λ 2 π f t in which λ is the wavelength it is set the same as the chord length of the airfoil l and f is the frequency a m x b is the amplitude and can be expressed by polynomial which takes the form of 7 a m x p c p x p different orders of the polynomial from the first order to the fourth order have been used in the literature dong 2007 deng et al 2007 shu et al 2007 in this work four types of undulation kinematics named k 1 to k 4 are considered to examine the influence of the variation form of the kinematics different envelopes are plotted in fig 1 among them k 1 and k 2 have the maximum undulation amplitude of a max 0 1 l k 3 and k 4 have a max 0 2 l table 2 kinematics k 1 and k 3 are modeled by a linear polynomial k 1 with a 0 5 0 a 0 5 0 1 k 3 with a 0 5 0 a 0 5 0 2 meanwhile k 2 and k 4 are the 3rd order polynomials k 2 with a 0 5 0 02 a 0 3 0 01 a 0 1 0 13 a 0 5 0 1 k 4 with a 0 5 0 056 a 0 3 0 02 a 0 1 0 036 a 0 5 0 2 body outlines of fish motion in an undulation period are helpful to provide a direct expression maertens et al 2017 they are presented in fig 2 to study the fluid dynamics of fish like swimming a naca0012 airfoil is centered 0 0 in a computational domain with x 14 l 26 l and y 15 l 15 l where l 1 is the length of the airfoil the aoa θ is defined relative to the free stream and it is illustrated in fig 3 a non uniform grid with the fine mesh in the region x 0 7 l 0 7 l and y 0 7 l 0 7 l around the airfoil is applied shu et al 2002 wu and shu 2010 as shown in fig 4 the non dimensional parameters for this problem include the strouhal number s t f a u where f is the undulatory frequency and a is the value of the double amplitude of motion the reynolds number re ρ u l μ where u is the free stream velocity the lift force coefficient c l f l 1 2 ρ u 2 l and the drag force coefficient c d f d 1 2 ρ u 2 l for the moving structure to validate the numerical methods for simulation of fish like swimming the convergence tests are performed with k 4 and the other parameters set the same as those in the literature shu et al 2007 four grids with the finest spacings as l 180 l 200 l 220 and l 240 are tested the mean drag coefficients obtained on grid spacing l 220 and l 240 have negligible differences the time variation of c d δ x 1 220 is also plotted together with those in the literature in fig 5 it can be seen that the present results agree well with those in the literature in the vorticity contours fig 6 shedding of the reverse karman vortex street which is viewed as the signature of thrust generation can also be observed 4 fish like swimming with zero angle of attack to investigate the influence of aoa the kinematics with zero aoa are studied firstly as base cases to focus on the parameters of interest the reynolds number is fixed at 100 in the following sections numerical tests show that the mesh size δ x 1 160 provides converged and accurate results the undulation frequency is chosen as 2 0 unless otherwise mentioned and the angle of attack is kept as zero in this section since the dynamics of a single fish with zero aoa are well interpreted in literature a brief description is provided below 4 1 effect of the undulation envelope a m x b the undulation envelope includes two factors the undulation amplitude and the variation form either the 1st or the 3rd order polynomial as considered in the present work fig 7 plots c d c l of different cases fig 7 a shows that the envelopes with larger undulation amplitude k 3 and k 4 provide larger thrust fig 7 b shows that between k 3 1st order polynomial and k 4 3rd order polynomial k 3 gives larger thrust and also causes less oscillation in the lift this can also be validated by the root mean square rms of c l in table 3 to examine the periodic features fig 8 plots the phase diagram for all cases there is only one crossing point which is a typical characteristic of fishlike swimming the flow fields are presented in fig 9 since k 1 and k 2 share similar patterns only k 2 is plotted the same applied for k 3 and k 4 with a smaller undulation amplitude k 2 0 1 l the vorticity field presents a parallel feature in the wake region in contrast with a larger undulation amplitude k 4 0 2 l a shedding vortex street can be observed in summary among the four types of kinematics the maximum undulation amplitude is most essential for thrust generation and the variation form is secondary in terms of the specific dynamic performance k 3 which has a large undulation amplitude 0 2 l and a linear undulation form provides a larger thrust and a relative smaller oscillation of c l 4 2 effect of the undulation frequency three undulation frequencies f 1 6 f 2 0 and f 2 4 with four kinematics are investigated they correspond to s t 0 32 0 4 and 0 48 for k 1 and k 2 s t 0 64 0 8 and 0 96 for k 3 and k 4 fig 10 shows that high undulation frequency enhances thrust generation the price for a larger thrust is an increase in lift force oscillation as shown in fig 10 b fig 11 presents the fourier spectra to examine the periodic features the dominant harmonics of c l f 0 is the same as the undulation frequency even harmonics 2 f 0 and 4 f 0 present in c d spectra and the odd harmonics f 0 and 3 f 0 present in c l spectra these observations agree well with those in the literature khalid et al 2018 the phase diagrams are shown in fig 12 and fig 13 they share the same features as those in fig 8 each curve has one crossing point for cases with large undulation amplitude k 3 and k 4 higher frequency not only enlarges the curve but also shifts the curve and the crossing point to the left fig 12 for cases with small a max fig 13 the influence of frequency is less pronounced to sum up high frequency enhances thrust generation and its effect is more pronounced for the kinematics with a large undulation amplitude based on this analysis f 2 4 which can produce more thrust is used in the following studies 5 fish like swimming with non zero angle of attack 5 1 dynamic performance the dynamic performance of fishlike swimming with different aoas and the kinematics from k 1 to k 4 all cases with identical undulatory frequency f 2 4 are investigated in this section to have a clear picture of the problem fig 14 presents the body outline of fish like swimming with different aoas fig 14 b defines two sets of coordinates one is the traditional global x y coordinates another is the local x θ y θ coordinates along the target moving direction the free stream flows from the left to right it is in parallel with the x axis usually the drag and lift coefficients c d and c l are defined based on the x y coordinates however analysis shows that this perspective cannot effectively reflect the dynamic features of an actively moving body with aoa to solve this we propose the x θ y θ coordinates for analysis on these coordinates another set of forcing coefficients c d θ and c l θ are defined the investigations from both c d c l and c d θ c l θ perspectives are performed 5 1 1 dynamic performance based on c d and c l analysis based on the traditional view of c d and c l is introduced in the first place to have an overview fig 15 plots the average value of the c d and c l versus aoa kinematics from k 1 to k 4 with fifteen values of aoa from 0 to 60 are considered 0 1 3 5 10 15 20 25 30 35 40 45 50 55 60 in this plot the drag and the lift coefficients are defined along with the x y coordinates the variation trend of c d and c l is similar to that of a stationary airfoil with aoa the drag coefficient increases monotonously with an increase θ the speed of change also increases while the lift coefficient increases when θ is relatively small and then drops when θ increases further in addition to the mean value the root mean square rms of c d and c l are also presented to evaluate the stability of the motion fig 16 it shows that c d r m s increases significantly with the increase of θ and c l r m s can reduce 50 when θ increases from 0 to 60 a major point of interest in fish like swimming is thrust generation from this aspect the results observed so far can be confusing both the average value and the rms of c d increases with an increase θ this means when the target moving direction differs from that of the free stream the performance is compromised greatly especially with a large aoa θ 35 with non zero aoa the thrust becomes drag fig 15 a together with large oscillation along the x axis fig 16 a on the other hand the average c l also increases significantly only c l r m s decreases it is thus difficult to derive an instructive conclusion based on this view at present to look further into the dynamic performance fig 17 presents the time history of c d and c l with θ 0 θ 45 θ 60 the transient history can be even more confusing especially for a large aoa in fig 17 a when θ 0 the time variations of c d and c l well reflect the forcing characteristics for fish like swimming that is the line of c d oscillates with a small amplitude below c d 0 and with a high frequency 2 f 0 f 0 is the frequency of the undulation the transient variation of c l oscillates with a larger amplitude and a lower frequency f 0 however when aoa increases as shown in fig 17 b and c the transient features of c d and c l become similar and it is difficult to distinguish them it is thus demonstrated that the traditional perspective cannot well reflect the characteristics of different forces in the fish like swimming problem at nonzero aoas and the origin of this issue is that the drag and the lift forces are two orthogonal forces and are generated by active motion with strong directional preference 5 1 2 dynamic performance based on c d θ and c l θ to overcome the problem discussed above an alternative perspective is proposed here summarize two main reasons for the necessity of a new perspective based on our analysis the first reason is that a good perspective and the corresponding indicators should be able to reflect the distinctive directional preference and the non homogenous features of active motions such as fish like swimming the previous discussions show that when θ 0 c d and c l along the x y coordinates are informative indicators they successfully present the evident features of the amplitude and the frequency of the two orthogonal forces however with an increase θ these indicators lose their capability and confuse the two distinctive orthogonal forces this is the main reason and the necessity that drives us to propose a new perspective for analysis the second reason is that considering the aim of the drag lift coefficients they are defined to reflect the performance of structures not for the flow field thus it is also more reasonable to analyze the forces along the motion direction instead of along with the flow direction in this case owing to these two reasons we propose to analyze dynamic performance along with the x θ y θ coordinates which align with the moving direction fig 14 b on the proposed coordinates another set of forcing coefficients are defined namely c l θ c l cos θ c d sin θ and c d θ c l sin θ c d cos θ this subsection provides the analysis based on this newly proposed perspective for fish like swimming with nonzero aoas fig 18 plots the time variation of c d θ c l θ with different aoas fig 18 a is plotted for verification this is the case with θ 0 0 and it is identical with fig 17 a as expected with non zero aoa the distinctive features of the drag lift are well captured it is in obvious contrast with fig 17 for θ 45 and θ 60 as in fig 18 b and c the time variation of c d θ c l θ effectively reflects the features of the two orthogonal forces the curve of c d θ oscillates below c d θ 0 with a small oscillation amplitude the high frequency component is also clearly illustrated the curve of c l θ oscillates with a large amplitude and lower frequency these results indicate that the proposed perspective can well reflect the intrinsic non homogenous features of the physical problem an overview of the dynamic performance is presented in fig 19 and fig 20 the features of different undulation kinematics are also more obvious from the proposed perspective it can be seen that the maximum undulation amplitude a max has the primary influence that is k 3 and k 4 with a max 0 2 l share the same trend k 1 and k 2 with a max 0 1 l share the same trend fig 19 the undulation form whether it is the 1st or 3rd order polynomial plays a secondary role considering the thrust generation fig 19 a kinematics with a max 0 2 l k 3 and k 4 outperforms that with a max 0 1 l k 1 and k 1 and the 1st order undulation k 3 outperforms the 3rd order undulation form k 4 if we also consider the stability of the motion the motion is relatively stable when 0 θ 35 fig 20 and it may be subject to a larger oscillation when θ increases further it can be seen that the proposed perspective is more informative for dynamic analysis it can also provide more instructive guidance for the design and control of the underwater vehicle 5 2 periodic features the periodic features are analyzed in terms of the fourier spectra and the phase diagram for both c d c l and c d θ c l θ based on the investigation of the periodic features and the flow field the fish like swimming with aoa can be classified into three regimes regime 1 tail vortex shedding regime 0 θ 10 in this regime the flow field features are similar to those with zero aoa regime 2 head vortex formation regime 10 θ 35 the formation of clockwise vortices at the head position can be observed in this regime moreover a distinctive feature of this regime is that f 0 becomes a dominant harmonics in the c d spectra the even harmonics are dominant in spectra of c d when θ 0 regime 3 head vortex shedding regime θ 35 a very special phenomenon which is the shedding of two vortex streets with different time and special scales simultaneously can be observed in this regime the periodic features of different flow regimes are illustrated below 5 2 1 the fourier spectra analysis the periodic features of cases with k 1 to k 4 kinematics share the same trend to avoid redundancy only the fourier spectra of k 3 the 1st order undulation form and the phase diagram of k 4 the 3rd order undulation form are presented fig 21 and fig 22 show the fourier spectra of c d and c l with θ 10 and θ 45 respectively the complexity of the spectra increases with θ and it shows distinctive features in different flow regimes in regime 1 fig 11 θ 0 0 tail vortex shedding regime the even harmonics 2 f 0 and 4 f 0 are dominant in the c d spectra the odd harmonics f 0 and 3 f 0 are dominant in the c l spectra f 0 is the undulation frequency however in regime 2 head vortex formation regime f 0 2 f 0 3 f 0 and 4 f 0 emerges in both c d and c l spectra fig 21 θ 10 0 when the aoa increases further into the range of regime 3 more interesting periodic features can be observed as shown in fig 22 besides the odd and even harmonics of f 0 a new base frequency f 1 appears the value of f 1 is an order of magnitude smaller than f 0 f 1 0 2 and f 0 2 4 when θ 45 additionally the combination of f 0 and f 1 also appears it worth noting that with large aoa it is also difficult to distinguish the spectra of c d and c l fig 22 this is the drawback of utilizing the x y coordinates for analysis as explained in section 5 the fourier spectra of c d θ and c l θ are demonstrated in fig 23 the same periodic features as in fig 22 can be observed the difference is that in fig 23 the interactions of different harmonics is much more obvious in c d θ spectra the spectra of c d θ and c l θ are also more distinguishable it is thus shown that the proposed perspective helps to enhance the presentation of the periodic features 5 2 2 phase diagram of the drag and lift force coefficients phase diagrams of c d and c l k 4 kinematics are presented in fig 24 different flow regimes present different phase diagram features in regime 2 the increasing complexity of the phase diagram can be observed which can be reflected as the asymmetric and more oscillating curve shape it is also observed that in regime 2 the phase diagram has only one crossing point fig 24 a as a comparison in regime 3 the curves are intertwined and the phase diagram becomes even more complex fig 24 b an interesting feature is that aoa not only changes the shape of each phase diagram but also leads to clockwise rotation the rotation angle is proportional to aoa the phase diagram of c d θ and c l θ of the same cases are plotted in fig 25 for comparison it is noted that the form of the phase diagram keeps the same but those of c d θ and c l θ do not rotate with aoa as observed in fig 24 5 3 flow field characteristics the vorticity contours of the fish like swimming in different flow regimes are presented in fig 26 because the features of the flow field are similar only those with k 3 kinematics are plotted in regime 2 circulation bubbles due to the interaction between the free steam and head of the body are formed which are termed as the head vortex fig 26 a and b the strength of the head vortex normally grows with the increase aoa as shown in fig 26 b further increasing aoa the flow regime falls into regime 3 fig 26 c and d the head vortex together with a large scale vortex at the tail develop into vortex street and shed to the downstream this is also the reason for the newly emerged low frequency f 1 observed previously note that the time and the spatial scales of the head vortices are quite different from those generated by the undulation considering the spatial scale the length of the vortex generated by the undulation is comparable with a max which is the order of 10 1 l and the length of the head vortex is comparable with the body length l considering the time scale the fourier spectra analysis shows that the shedding frequency of the tail vortex is 1 and that of the head vortex is 10 1 fig 26 d presents this interesting phenomenon showing the existence of the vortices with two different time and spatial scales in fact not only each vortex presents the difference but the vortex street also shows different orders in time and space the evolution of vortex streets is presented in fig 27 in fig 27 a a clockwise body length scale head vortex is about to detach it then sheds to the downstream at t 2 fig 27 b when the time advances from t 2 to t 4 a body length scale vortex is formed at the end of the tail vortex street t 3 it detaches at the time t 4 and then sheds to the downstream t 5 finally a clockwise head vortex is formed at t 6 to repeat the cycle the length scale of the large vortex streets can be 10 l and the time scale is also 10 t n d one shedding circle takes 7 7 t n d in this case this vortex street is similar to that generated by stationary objects in the flow field on the other hand the vortices generated by the undulation evolve at different scales as marked in fig 27 d the total length of the tail vortex street is body length scale more interestingly the lifespan of the tail vortex street is 1 f 1 f 1 is the shedding frequency of the large vortex the forming and fading of each small tail vortex street are nested in the one period of generation of a large vortex pair in a shedding circle of a large vortex pair 7 7 t n d t 1 to t 6 for example a small tail vortex street is generated fig 27 a b c and faded away fig 27 e f the small scale vortex street generated by undulation is local in both time and space 6 conclusions this work investigated fish like swimming subject to oblique incoming flows by immersed boundary lattice boltzmann method a more comprehensive perspective for dynamic analysis which consolidates the angle of attack aoa into the conventional forcing coefficients is proposed the necessity origins from two aspects the first motivation is to reflect the directional preference and the non homogenous features of active motions such as fish like swimming the second reason was that the drag lift coefficients shall be defined to reflect the performance of the moving object under investigation rather than of the flow field based on these recognitions we proposed the alternative x θ y θ coordinates for performance analysis comparisons showed that the proposed perspective can well capture the intrinsic non homogenous features of the physical problem it can also provide more instructive guidance for the design and control of the underwater vehicle based on this effective analysis perspective the fish like swimming with aoa was explored from three aspects the dynamic performance the periodic features and the flow field characteristics the dynamic analysis showed the undulation amplitude was most essential to generate thrust and the undulation form was a secondary contributor considering the thrust generation kinematics with a max 0 2 l k 3 and k 4 outperformed those with a max 0 1 l k 1 and k 2 and the 1st order undulation k 1 k 3 outperformed the 3rd order form k 2 k 4 among the four kinematics studied k 3 had the optimal performance for periodic features the fourier spectra and phase diagrams presented increasing complexity with an increasing aoa different base frequencies were observed for cases with large aoa the low base frequency originated from the shedding of the large scale head vortex additionally three flow regimes were identified based on the flow field patterns in regime 3 a hierarchical vortex shedding pattern with different orders in time and space is observed and in a shedding period of a large vortex pair a small tail vortex street is generated and faded away credit author statement j y shao conceptualization methodology and writing t q li consultation data availability the data that support the findings of this study are available within this article declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the support of the national natural science foundation of china grant nos 11902233 51720105011 and the fundamental research funds for the central universities grant nos 193102001 203202001 
20755,although being a common situation for fish and underwater vehicles limited research has been reported for a fish like body swimming in oblique incoming flows the present work employs the immersed boundary lattice boltzmann method to numerically study the dynamics of this problem a more comprehensive analysis method which utilizes the effective force parameters that consolidate the angle of attack aoa into the traditional force parameters is proposed for investigating the dynamics of cases with non zero aoa several distinct features in terms of the dynamic performance the periodic features and the flow field characteristics are presented for the dynamic performance undulation amplitude plays a more dominant role than the undulation form in thrust generation the periodic features revealed by the fourier spectra present increasing complexity with larger aoa besides three flow regimes are identified one of which observes hierarchical vortex structures with different orders in time and space the small scale vortex street generated by undulation is local in both time and space and it is embedded in the large scale vortex street generated by the body and the free stream keywords fish like swimming oblique flows fluid dynamics immersed boundary lattice boltzmann method 1 introduction attributes to its superior efficiency and maneuverability fishlike swimming is a promising propulsion technique for underwater vehicles a major requirement of underwater vehicles is to accomplish tasks such as monitoring underwater sites and mapping the seafloor and maneuvering along the designed trajectories in complex flows the complex flows can be uniform oblique flows or unsteady altered flows both can perturb swim liao 2007 and affect maneuverability compared with fish motion in still water or uniform flow that aligns with the swimming direction much less is known for fish motion in complex environments here we investigated fishlike swimming in uniform oblique flows numerically and proposed an effective analysis perspective for this class of phenomena swimming of fish has been explored from various aspects including its kinematics breder 1926 gray 1933 videler and hess 1984 wassersug and hoff 1985 videler 1993 lauder and tytell 2005 zhong et al 2018 swimming mechanisms gray 1936 triantafyllou et al 2000 lauder and madden 2006 xia et al 2016 the impact of fins li et al 2017 zhao and dou 2019 ghommem et al 2020 han et al 2020 dynamics of fish school weihs 1973 2004 peng et al 2018 fish 1999 dong 2007 gao and triantafyllou 2018 as well as its applications of biomimetic robots lauder and madden 2006 scaradozzi et al 2017 salazar et al 2018 du et al 2015 to name a few studies on the movements of fish can be dated back to the 17th century videler 1993 nowadays fish movements are recorded by high speed video cameras then digitalized and generalized by traveling waves from head to tail for bcf body and or caudal fin swimming modes as considered in this work and are finally expressed by sin cosine functions as fourier coefficients the precise kinematic studies of different species for both steady and unsteady swimming set the foundation for quantitative investigations of the swimming mechanisms the theoretical experimental and numerical works on swimming mechanisms are reviewed by trantafyllou et al triantafyllou et al 2000 and more recently by fish and lauder 2006 swimming mechanisms of both the individual fish and fish school have been analyzed thrust generation by the body tail and swimming energy efficiency are the main research topics for individual fish it has been shown that fish controls the flow by rhythmic oscillation from head to tail with increasing amplitude and the tail repositions the vortices to form a reverse karman vortex street in the wake in this way thrust can be generated for a steadily swimming fish with bcf mode fish can also achieve low drag when swimming at high speed by maintaining a fully attached turbulent boundary layer comparing to the body and the tail of a fish fish fins can be much more flexible its kinematics and hydrodynamics can also be more delicate standen and lauder 2005 ghommem et al 2020 performed numerical simulations of a flapping caudal fin with oscillation frequency over a range of strouhal numbers by immersed boundary method it shows that a flapping caudal fin can enhance thrust generation to achieve a better propulsion performance apart from the caudal fin the pectoral fins can also be major tools for thrust generation drucker and lauder 2000 fish can generate enough propulsion by pectoral fins alone at low swimming speed and enhance thrust generation by recruit additional fins at high speed in addition to the swimming mechanisms of individual fish interactions among organized formations of fishlike swimming also received much attention the hydrodynamics of fixed arrangement of fishlike swimming motions deng et al 2007 khalid et al 2018 park and sung 2018 and also the spontaneous collective locomotion of flapping plates are studied peng et al 2018 to reflect the coupling mechanisms for a group of self propelling structures to establish the important fundamental understanding of complex fish kinematics and hydrodynamics most pioneering studies simplify the flow environment as the still water or steady flows that align with the swim direction nonetheless complex flow environments are prevalent it can be steady oblique flow or unsteady altered flow both can perturb maneuverability in controlled experiments the direction of the flow can be well aligned with the moving direction nonetheless in practice the free stream direction can differ from the moving direction and makes a stable maneuvering challenging in such cases the free stream and the swimming direction form a non zero attack angle this can be a common situation faced by fish and underwater vehicles yet limited studies have been reported in this area in this work we numerically simulate the phenomena by the immersed boundary lattice boltzmann method ib lbm four types of kinematics k 1 to k 4 with fifteen values of aoa from 0 to 60 considered based on the simulation results dynamic analyses are performed it is found that with oblique incoming flows traditionally defined force parameters cannot correctly reflect the dynamics features neither the statistic transient forcing analysis nor fourier periodic feature analysis based on these traditional force parameters provides a satisfactory view for fish like swimming with non zero aoa to solve this problem we propose a more comprehensive perspective which is based on modified force parameters that consider the swimming direction to examine the dynamic features comparisons show that the proposed perspective well captures the intrinsic non homogenous features of the physical problem it is also more informative and can provide more instructive guidance for the design and control of the underwater vehicle operating in similar scenarios based on that the fish like swimming with aoa is comprehensively studied from three aspects the dynamic performance the periodic features and the flow field characteristics several interesting features are presented in these aspects the following context is organized as below section 2 introduces the numerical methods used in this work the problem setup and the numerical validations are described in section 3 section 4 studies fish like swimming with zero aoa and with different kinematics as base cases section 5 then investigates the cases with non zero aoas the problem encountered by using the traditional analysis perspective is discussed in section 5 1 1 the proposed new perspective of analysis is detailed in section 5 1 2 thereafter the dynamic performance and the periodic features of fish like swimming with aoa are investigated based on both the traditional and the proposed perspectives the flow field characteristics are also analyzed in section 5 the conclusions of this work are finally drawn in section 6 2 numerical method fish like swimming is a typical fluid structure interaction fsi problem immersed boundary method is an effective tool to simulate such type of problem it can be coupled with the traditional naiver stocks equations mittal and iaccarino 2005 the lattice boltzmann methods shao and liu 2018 and also the simplified lattice boltzmann method chen et al 2018a 2018b 2020 for a variety of stationary moving fsi phenomena in this work the immersed boundary lattice boltzmann method is applied to model the interactions between the fluid flow and the moving body the lattice boltzmann method is used for the simulation of the flow field and the immersed boundary method is implemented to simulate interactions between the moving boundary and the fluid flow fluid dynamics can be described at different levels such as macroscopic and mesoscopic levels the navier stokes n s equations describe the behavior of incompressible viscous flow from the macroscopic level 1a u 0 1b ρ u t u u p μ δ u f alternatively based on mesoscopic kinetic models the lattice boltzmann equation lbe describes weak compressible viscous flows through the chapman enskog expansion it recovers the n s equations with the second order accuracy with incompressible small mach number limit f α x e α δ t t δ t f α x t 1 τ f α x t f α e q x t f α δ t 2 f α e q x t ρ w α 1 e α u c s 2 e α u 2 2 c s 4 u 2 2 c s 2 f α 1 1 2 τ w α e α u c s 2 e α u c s 4 e α f in the above equations u ρ p and μ take their normal meanings as the velocity vector density pressure and dynamic viscosity and δ are the nabla and laplace operators besides x is the cartesian coordinate vector eulerian grid t and δ t indicates time and the time step respectively in the lbe f α and f α e q are the density distribution function and the equilibrium density distribution functions τ is a relaxation parameter and it is determined by υ τ 1 2 c s 2 δ t in which υ is the kinematic viscosity c s 2 1 3 for the d2q9 lattice model used here the value of e α and w α are listed in table 1 in the lbm the macroscopic properties are calculated by 3 ρ α f α p c s 2 ρ ρ u α e α f α 1 2 f δ t it is noted that an additional forcing term f is introduced to correctly consider the discrete lattice effects when introducing the force the form of lbe proposed by guo et al 2002 is used the force density is calculated by f 2 ρ δ u δ t δ u is the velocity correction term determined by the ibm u u δ u with u 1 ρ α e α f α being the predicted velocity in the immersed boundary method two sets of the grid are used they are the eulerian grid for the flow field and the lagrangian grid for the structures the velocity correction term δ u is defined on the eulerian grid and it is linked with the lagrangian grid by δ u x i j t l δ u b l x b l t d i j x i j x b l δ s l here the subscript b indicates boundary points x b l is the coordinate of the boundary points l is the index of boundary points and δ s l is the length of a boundary segment additionally d i j x i j x b l δ x i j x b l δ y i j y b l is a delta function here δ r is calculated by a smoothed piecewise function yang et al 2009 4 δ r 3 8 π 32 r 2 4 r 0 5 1 4 1 r 8 2 8 r 4 r 2 1 8 arcsin 2 r 1 0 5 r 1 5 17 16 π 64 3 r 4 r 2 8 r 2 16 14 16 r 4 r 2 1 16 arcsin 2 r 1 1 5 r 2 5 0 2 5 r the non dimensional distance between the eulerian and lagrangian grid points is defined as r x i x b l δ x i δ x i are the eulerian grid spacing in the boundary condition enforced ibm the velocity correction δ u b l is solved from the following equation system wu and shu 2009 5 u b l x b l t i j u x i j t d i j x i j x b l δ x δ y i j l δ u b x b l t d i j x i j x b l δ s l d i j x i j x b l δ x δ y the solution procedures can be summarized as follows 1 at time t t n obtain the density distribution functions f α by eq 2 calculate the macroscopic variables ρ p and u in eqs 2 and 3 2 solve eq 5 to obtain the velocity corrections δ u b on boundary points and map them to eulerian points 3 correct the fluid velocity by u u δ u and calculate the force density repeat these steps until convergence criteria are met the details of the numerical method can be found in the reference wu and shu 2009 in this way the no slip boundary conditions can be enforced through the immersed boundary method in the framework of the lattice boltzmann method 3 problem setup and numerical validations the fish like undulation is modeled by a traveling wave from head to tail of a naca0012 airfoil the undulation amplitude of the midline is given by 6 y m x b t a m x b cos 2 π x b λ 2 π f t in which λ is the wavelength it is set the same as the chord length of the airfoil l and f is the frequency a m x b is the amplitude and can be expressed by polynomial which takes the form of 7 a m x p c p x p different orders of the polynomial from the first order to the fourth order have been used in the literature dong 2007 deng et al 2007 shu et al 2007 in this work four types of undulation kinematics named k 1 to k 4 are considered to examine the influence of the variation form of the kinematics different envelopes are plotted in fig 1 among them k 1 and k 2 have the maximum undulation amplitude of a max 0 1 l k 3 and k 4 have a max 0 2 l table 2 kinematics k 1 and k 3 are modeled by a linear polynomial k 1 with a 0 5 0 a 0 5 0 1 k 3 with a 0 5 0 a 0 5 0 2 meanwhile k 2 and k 4 are the 3rd order polynomials k 2 with a 0 5 0 02 a 0 3 0 01 a 0 1 0 13 a 0 5 0 1 k 4 with a 0 5 0 056 a 0 3 0 02 a 0 1 0 036 a 0 5 0 2 body outlines of fish motion in an undulation period are helpful to provide a direct expression maertens et al 2017 they are presented in fig 2 to study the fluid dynamics of fish like swimming a naca0012 airfoil is centered 0 0 in a computational domain with x 14 l 26 l and y 15 l 15 l where l 1 is the length of the airfoil the aoa θ is defined relative to the free stream and it is illustrated in fig 3 a non uniform grid with the fine mesh in the region x 0 7 l 0 7 l and y 0 7 l 0 7 l around the airfoil is applied shu et al 2002 wu and shu 2010 as shown in fig 4 the non dimensional parameters for this problem include the strouhal number s t f a u where f is the undulatory frequency and a is the value of the double amplitude of motion the reynolds number re ρ u l μ where u is the free stream velocity the lift force coefficient c l f l 1 2 ρ u 2 l and the drag force coefficient c d f d 1 2 ρ u 2 l for the moving structure to validate the numerical methods for simulation of fish like swimming the convergence tests are performed with k 4 and the other parameters set the same as those in the literature shu et al 2007 four grids with the finest spacings as l 180 l 200 l 220 and l 240 are tested the mean drag coefficients obtained on grid spacing l 220 and l 240 have negligible differences the time variation of c d δ x 1 220 is also plotted together with those in the literature in fig 5 it can be seen that the present results agree well with those in the literature in the vorticity contours fig 6 shedding of the reverse karman vortex street which is viewed as the signature of thrust generation can also be observed 4 fish like swimming with zero angle of attack to investigate the influence of aoa the kinematics with zero aoa are studied firstly as base cases to focus on the parameters of interest the reynolds number is fixed at 100 in the following sections numerical tests show that the mesh size δ x 1 160 provides converged and accurate results the undulation frequency is chosen as 2 0 unless otherwise mentioned and the angle of attack is kept as zero in this section since the dynamics of a single fish with zero aoa are well interpreted in literature a brief description is provided below 4 1 effect of the undulation envelope a m x b the undulation envelope includes two factors the undulation amplitude and the variation form either the 1st or the 3rd order polynomial as considered in the present work fig 7 plots c d c l of different cases fig 7 a shows that the envelopes with larger undulation amplitude k 3 and k 4 provide larger thrust fig 7 b shows that between k 3 1st order polynomial and k 4 3rd order polynomial k 3 gives larger thrust and also causes less oscillation in the lift this can also be validated by the root mean square rms of c l in table 3 to examine the periodic features fig 8 plots the phase diagram for all cases there is only one crossing point which is a typical characteristic of fishlike swimming the flow fields are presented in fig 9 since k 1 and k 2 share similar patterns only k 2 is plotted the same applied for k 3 and k 4 with a smaller undulation amplitude k 2 0 1 l the vorticity field presents a parallel feature in the wake region in contrast with a larger undulation amplitude k 4 0 2 l a shedding vortex street can be observed in summary among the four types of kinematics the maximum undulation amplitude is most essential for thrust generation and the variation form is secondary in terms of the specific dynamic performance k 3 which has a large undulation amplitude 0 2 l and a linear undulation form provides a larger thrust and a relative smaller oscillation of c l 4 2 effect of the undulation frequency three undulation frequencies f 1 6 f 2 0 and f 2 4 with four kinematics are investigated they correspond to s t 0 32 0 4 and 0 48 for k 1 and k 2 s t 0 64 0 8 and 0 96 for k 3 and k 4 fig 10 shows that high undulation frequency enhances thrust generation the price for a larger thrust is an increase in lift force oscillation as shown in fig 10 b fig 11 presents the fourier spectra to examine the periodic features the dominant harmonics of c l f 0 is the same as the undulation frequency even harmonics 2 f 0 and 4 f 0 present in c d spectra and the odd harmonics f 0 and 3 f 0 present in c l spectra these observations agree well with those in the literature khalid et al 2018 the phase diagrams are shown in fig 12 and fig 13 they share the same features as those in fig 8 each curve has one crossing point for cases with large undulation amplitude k 3 and k 4 higher frequency not only enlarges the curve but also shifts the curve and the crossing point to the left fig 12 for cases with small a max fig 13 the influence of frequency is less pronounced to sum up high frequency enhances thrust generation and its effect is more pronounced for the kinematics with a large undulation amplitude based on this analysis f 2 4 which can produce more thrust is used in the following studies 5 fish like swimming with non zero angle of attack 5 1 dynamic performance the dynamic performance of fishlike swimming with different aoas and the kinematics from k 1 to k 4 all cases with identical undulatory frequency f 2 4 are investigated in this section to have a clear picture of the problem fig 14 presents the body outline of fish like swimming with different aoas fig 14 b defines two sets of coordinates one is the traditional global x y coordinates another is the local x θ y θ coordinates along the target moving direction the free stream flows from the left to right it is in parallel with the x axis usually the drag and lift coefficients c d and c l are defined based on the x y coordinates however analysis shows that this perspective cannot effectively reflect the dynamic features of an actively moving body with aoa to solve this we propose the x θ y θ coordinates for analysis on these coordinates another set of forcing coefficients c d θ and c l θ are defined the investigations from both c d c l and c d θ c l θ perspectives are performed 5 1 1 dynamic performance based on c d and c l analysis based on the traditional view of c d and c l is introduced in the first place to have an overview fig 15 plots the average value of the c d and c l versus aoa kinematics from k 1 to k 4 with fifteen values of aoa from 0 to 60 are considered 0 1 3 5 10 15 20 25 30 35 40 45 50 55 60 in this plot the drag and the lift coefficients are defined along with the x y coordinates the variation trend of c d and c l is similar to that of a stationary airfoil with aoa the drag coefficient increases monotonously with an increase θ the speed of change also increases while the lift coefficient increases when θ is relatively small and then drops when θ increases further in addition to the mean value the root mean square rms of c d and c l are also presented to evaluate the stability of the motion fig 16 it shows that c d r m s increases significantly with the increase of θ and c l r m s can reduce 50 when θ increases from 0 to 60 a major point of interest in fish like swimming is thrust generation from this aspect the results observed so far can be confusing both the average value and the rms of c d increases with an increase θ this means when the target moving direction differs from that of the free stream the performance is compromised greatly especially with a large aoa θ 35 with non zero aoa the thrust becomes drag fig 15 a together with large oscillation along the x axis fig 16 a on the other hand the average c l also increases significantly only c l r m s decreases it is thus difficult to derive an instructive conclusion based on this view at present to look further into the dynamic performance fig 17 presents the time history of c d and c l with θ 0 θ 45 θ 60 the transient history can be even more confusing especially for a large aoa in fig 17 a when θ 0 the time variations of c d and c l well reflect the forcing characteristics for fish like swimming that is the line of c d oscillates with a small amplitude below c d 0 and with a high frequency 2 f 0 f 0 is the frequency of the undulation the transient variation of c l oscillates with a larger amplitude and a lower frequency f 0 however when aoa increases as shown in fig 17 b and c the transient features of c d and c l become similar and it is difficult to distinguish them it is thus demonstrated that the traditional perspective cannot well reflect the characteristics of different forces in the fish like swimming problem at nonzero aoas and the origin of this issue is that the drag and the lift forces are two orthogonal forces and are generated by active motion with strong directional preference 5 1 2 dynamic performance based on c d θ and c l θ to overcome the problem discussed above an alternative perspective is proposed here summarize two main reasons for the necessity of a new perspective based on our analysis the first reason is that a good perspective and the corresponding indicators should be able to reflect the distinctive directional preference and the non homogenous features of active motions such as fish like swimming the previous discussions show that when θ 0 c d and c l along the x y coordinates are informative indicators they successfully present the evident features of the amplitude and the frequency of the two orthogonal forces however with an increase θ these indicators lose their capability and confuse the two distinctive orthogonal forces this is the main reason and the necessity that drives us to propose a new perspective for analysis the second reason is that considering the aim of the drag lift coefficients they are defined to reflect the performance of structures not for the flow field thus it is also more reasonable to analyze the forces along the motion direction instead of along with the flow direction in this case owing to these two reasons we propose to analyze dynamic performance along with the x θ y θ coordinates which align with the moving direction fig 14 b on the proposed coordinates another set of forcing coefficients are defined namely c l θ c l cos θ c d sin θ and c d θ c l sin θ c d cos θ this subsection provides the analysis based on this newly proposed perspective for fish like swimming with nonzero aoas fig 18 plots the time variation of c d θ c l θ with different aoas fig 18 a is plotted for verification this is the case with θ 0 0 and it is identical with fig 17 a as expected with non zero aoa the distinctive features of the drag lift are well captured it is in obvious contrast with fig 17 for θ 45 and θ 60 as in fig 18 b and c the time variation of c d θ c l θ effectively reflects the features of the two orthogonal forces the curve of c d θ oscillates below c d θ 0 with a small oscillation amplitude the high frequency component is also clearly illustrated the curve of c l θ oscillates with a large amplitude and lower frequency these results indicate that the proposed perspective can well reflect the intrinsic non homogenous features of the physical problem an overview of the dynamic performance is presented in fig 19 and fig 20 the features of different undulation kinematics are also more obvious from the proposed perspective it can be seen that the maximum undulation amplitude a max has the primary influence that is k 3 and k 4 with a max 0 2 l share the same trend k 1 and k 2 with a max 0 1 l share the same trend fig 19 the undulation form whether it is the 1st or 3rd order polynomial plays a secondary role considering the thrust generation fig 19 a kinematics with a max 0 2 l k 3 and k 4 outperforms that with a max 0 1 l k 1 and k 1 and the 1st order undulation k 3 outperforms the 3rd order undulation form k 4 if we also consider the stability of the motion the motion is relatively stable when 0 θ 35 fig 20 and it may be subject to a larger oscillation when θ increases further it can be seen that the proposed perspective is more informative for dynamic analysis it can also provide more instructive guidance for the design and control of the underwater vehicle 5 2 periodic features the periodic features are analyzed in terms of the fourier spectra and the phase diagram for both c d c l and c d θ c l θ based on the investigation of the periodic features and the flow field the fish like swimming with aoa can be classified into three regimes regime 1 tail vortex shedding regime 0 θ 10 in this regime the flow field features are similar to those with zero aoa regime 2 head vortex formation regime 10 θ 35 the formation of clockwise vortices at the head position can be observed in this regime moreover a distinctive feature of this regime is that f 0 becomes a dominant harmonics in the c d spectra the even harmonics are dominant in spectra of c d when θ 0 regime 3 head vortex shedding regime θ 35 a very special phenomenon which is the shedding of two vortex streets with different time and special scales simultaneously can be observed in this regime the periodic features of different flow regimes are illustrated below 5 2 1 the fourier spectra analysis the periodic features of cases with k 1 to k 4 kinematics share the same trend to avoid redundancy only the fourier spectra of k 3 the 1st order undulation form and the phase diagram of k 4 the 3rd order undulation form are presented fig 21 and fig 22 show the fourier spectra of c d and c l with θ 10 and θ 45 respectively the complexity of the spectra increases with θ and it shows distinctive features in different flow regimes in regime 1 fig 11 θ 0 0 tail vortex shedding regime the even harmonics 2 f 0 and 4 f 0 are dominant in the c d spectra the odd harmonics f 0 and 3 f 0 are dominant in the c l spectra f 0 is the undulation frequency however in regime 2 head vortex formation regime f 0 2 f 0 3 f 0 and 4 f 0 emerges in both c d and c l spectra fig 21 θ 10 0 when the aoa increases further into the range of regime 3 more interesting periodic features can be observed as shown in fig 22 besides the odd and even harmonics of f 0 a new base frequency f 1 appears the value of f 1 is an order of magnitude smaller than f 0 f 1 0 2 and f 0 2 4 when θ 45 additionally the combination of f 0 and f 1 also appears it worth noting that with large aoa it is also difficult to distinguish the spectra of c d and c l fig 22 this is the drawback of utilizing the x y coordinates for analysis as explained in section 5 the fourier spectra of c d θ and c l θ are demonstrated in fig 23 the same periodic features as in fig 22 can be observed the difference is that in fig 23 the interactions of different harmonics is much more obvious in c d θ spectra the spectra of c d θ and c l θ are also more distinguishable it is thus shown that the proposed perspective helps to enhance the presentation of the periodic features 5 2 2 phase diagram of the drag and lift force coefficients phase diagrams of c d and c l k 4 kinematics are presented in fig 24 different flow regimes present different phase diagram features in regime 2 the increasing complexity of the phase diagram can be observed which can be reflected as the asymmetric and more oscillating curve shape it is also observed that in regime 2 the phase diagram has only one crossing point fig 24 a as a comparison in regime 3 the curves are intertwined and the phase diagram becomes even more complex fig 24 b an interesting feature is that aoa not only changes the shape of each phase diagram but also leads to clockwise rotation the rotation angle is proportional to aoa the phase diagram of c d θ and c l θ of the same cases are plotted in fig 25 for comparison it is noted that the form of the phase diagram keeps the same but those of c d θ and c l θ do not rotate with aoa as observed in fig 24 5 3 flow field characteristics the vorticity contours of the fish like swimming in different flow regimes are presented in fig 26 because the features of the flow field are similar only those with k 3 kinematics are plotted in regime 2 circulation bubbles due to the interaction between the free steam and head of the body are formed which are termed as the head vortex fig 26 a and b the strength of the head vortex normally grows with the increase aoa as shown in fig 26 b further increasing aoa the flow regime falls into regime 3 fig 26 c and d the head vortex together with a large scale vortex at the tail develop into vortex street and shed to the downstream this is also the reason for the newly emerged low frequency f 1 observed previously note that the time and the spatial scales of the head vortices are quite different from those generated by the undulation considering the spatial scale the length of the vortex generated by the undulation is comparable with a max which is the order of 10 1 l and the length of the head vortex is comparable with the body length l considering the time scale the fourier spectra analysis shows that the shedding frequency of the tail vortex is 1 and that of the head vortex is 10 1 fig 26 d presents this interesting phenomenon showing the existence of the vortices with two different time and spatial scales in fact not only each vortex presents the difference but the vortex street also shows different orders in time and space the evolution of vortex streets is presented in fig 27 in fig 27 a a clockwise body length scale head vortex is about to detach it then sheds to the downstream at t 2 fig 27 b when the time advances from t 2 to t 4 a body length scale vortex is formed at the end of the tail vortex street t 3 it detaches at the time t 4 and then sheds to the downstream t 5 finally a clockwise head vortex is formed at t 6 to repeat the cycle the length scale of the large vortex streets can be 10 l and the time scale is also 10 t n d one shedding circle takes 7 7 t n d in this case this vortex street is similar to that generated by stationary objects in the flow field on the other hand the vortices generated by the undulation evolve at different scales as marked in fig 27 d the total length of the tail vortex street is body length scale more interestingly the lifespan of the tail vortex street is 1 f 1 f 1 is the shedding frequency of the large vortex the forming and fading of each small tail vortex street are nested in the one period of generation of a large vortex pair in a shedding circle of a large vortex pair 7 7 t n d t 1 to t 6 for example a small tail vortex street is generated fig 27 a b c and faded away fig 27 e f the small scale vortex street generated by undulation is local in both time and space 6 conclusions this work investigated fish like swimming subject to oblique incoming flows by immersed boundary lattice boltzmann method a more comprehensive perspective for dynamic analysis which consolidates the angle of attack aoa into the conventional forcing coefficients is proposed the necessity origins from two aspects the first motivation is to reflect the directional preference and the non homogenous features of active motions such as fish like swimming the second reason was that the drag lift coefficients shall be defined to reflect the performance of the moving object under investigation rather than of the flow field based on these recognitions we proposed the alternative x θ y θ coordinates for performance analysis comparisons showed that the proposed perspective can well capture the intrinsic non homogenous features of the physical problem it can also provide more instructive guidance for the design and control of the underwater vehicle based on this effective analysis perspective the fish like swimming with aoa was explored from three aspects the dynamic performance the periodic features and the flow field characteristics the dynamic analysis showed the undulation amplitude was most essential to generate thrust and the undulation form was a secondary contributor considering the thrust generation kinematics with a max 0 2 l k 3 and k 4 outperformed those with a max 0 1 l k 1 and k 2 and the 1st order undulation k 1 k 3 outperformed the 3rd order form k 2 k 4 among the four kinematics studied k 3 had the optimal performance for periodic features the fourier spectra and phase diagrams presented increasing complexity with an increasing aoa different base frequencies were observed for cases with large aoa the low base frequency originated from the shedding of the large scale head vortex additionally three flow regimes were identified based on the flow field patterns in regime 3 a hierarchical vortex shedding pattern with different orders in time and space is observed and in a shedding period of a large vortex pair a small tail vortex street is generated and faded away credit author statement j y shao conceptualization methodology and writing t q li consultation data availability the data that support the findings of this study are available within this article declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the support of the national natural science foundation of china grant nos 11902233 51720105011 and the fundamental research funds for the central universities grant nos 193102001 203202001 
20756,the studies on floating offshore wind turbines have been increasing over recent decades due to the growing investments of industries in marine renewable energy compared with horizontal axis wind turbines research on vertical axis wind turbines is relatively few though the latter may have advantages over the former in some aspects for example potentially lower cost of energy in this paper the characteristics of the motion responses of a barge type floating system with four moonpools and a vertical axis wind turbine are experimentally and numerically investigated the focus is on the gyroscopic effects of turbine rotations on the motion responses of the floating system under different wave conditions physical model tests are conducted in a wave tank where a 2 mw class turbine is modelled in the 1 100 scale it is found that the first order sway and roll motion amplitudes near the resonant frequencies are reduced by the turbine rotations whereas the first order heave motion of the floating system is hardly influenced the second order motion responses and mooring tether tensions may be significantly amplified with the increasing rotating speed of turbine the maximum ratio of the second order response amplitude of roll motion to the first order roll amplitude is up to 17 in the experiments of this study a radiation and diffraction code based on linear potential flow theory is used to predict the motion responses and mooring forces the comparisons with experimental data suggest that the viscous damping of water resonance in moonpools and the gyroscopic effects of turbine rotations should be taken into account in predictions keywords vertical axis wind turbine gyroscopic effect moonpools barge fowt 1 introduction to exploit ocean wind energy various concepts of fowts floating offshore wind turbines have been proposed over the past decades in terms of supporting platforms there are mainly four types wang et al 2010 i e spar buoy tlp tension leg platform semi submersible column stabilised and barge or pontoon types among these types of platforms the barge type is of advantages in the simplify in design construct and install particularly suitable for a water depth of 50 100 m due to their feature of low draft the barge type fowts are generally moored to sea floor by catenary lines and maintain stability based on their water plane areas with regard to wind turbines there are mainly two types hawts horizontal axis wind turbines and vawts vertical axis wind turbines so far most of studies have been focused on hawts and some sea tests with prototypes have been performed although hawts is efficient in utilizing wind energy the costs of on site maintenance for hawts are generally high since the nacelles are installed at top of the turbine which maybe over 100 m in height by contrast for vawts power generation devices are generally installed at the bottoms of the turbines which leads to lower installation and maintenance costs compared with hawts in addition vawts have an advantage over hawts since the former naturally have no requirement for wind direction for these reasons increasing attention has been paid to floating vawts over recent years e g collu et al 2012 wang et al 2014 borg et al 2014 paulsen et al 2015 cheng et al 2017 regarding a rotating wind turbine the inclination of its rotation axis will result in gyroscopic moment it has been reported blusseau and patel 2012 mostafa et al 2012 that the gyroscopic effect due to turbine rotations on the motions of floating wind turbines may be significant at some key frequencies murai and nishimura 2010 and murai et al 2013 calculated the motion responses of several types of fowts using a potential flow model where gyroscopic force was estimated and considered in the motion equations of fowts by physical model testing nihei et al 2011 2014 reported that the gyroscopic effect of turbine rotations may lead to increasing yaw motions and even cause a tlp type of fowt to capsize akimoto et al 2014 numerically investigated the gyroscopic effect on the dynamics of a spar type fowt in regular waves their results show that the gyroscopic effect enhances the stability of turbine axis antonutti et al 2018 studied the influence of wind induced inclination of a floating wind turbine on its motions souza and bachynski 2019 presented the wind induced nonlinear effects on the low frequency motions of a floating hawt recently palraj and rajamanickam 2020 designed a gyrostabilizer and examined its effects on reducing the motions of a barge type fowt in waves through numerical simulations de tavernier et al 2020 investigated the feasibility of aerodynamically damping the motions of a floating vawt to authors knowledge the studies on the gyroscopic effect of fowts are still insufficient so far particularly for vertical axis type of fowts the dynamic responses of barge type fowts have been investigated numerically and experimentally jonkman and buhl 2007 developed a comprehensive simulation tool and analyzed the loads of a 5 mw megawatt wind turbine model installed on a squared barge like platform iijima et al 2010 analyzed the hydroelastic performance of a barge type fowt hu et al 2018 proposed a method to mitigate the loads of a barge type fowt through passive structural control focusing on second order hydrodynamic effects zhang et al 2020 investigated the motion characteristics of three semisubmersible fowts via numerical simulations in addition to the extensive numerical investigations experimental studies of fowts have recently been reviewed by gueydon et al 2020 recently the concept of damping pool was proposed by ideol company choisnet et al 2014 to reduce the motions of a barge type fowt as shown in fig 1 from the point of view of engineering this concept is attractive since it can not only improve the hydrodynamic performance of fowt but also reduce its manufacturing cost a theoretical study on the water motion in a rectangular moonpool is referred to molin 2001 through cfd simulations beyer et al 2015 and borisade et al 2016 investigated the motion responses and mooring line tensions of a barge type floating wind turbine installed with a moonpool more recently kosasih et al 2019 experimentally studied the dynamic response behaviours of a pontoon type floater with a moonpool compared with one moonpool ikoma et al 2019 reported that the hydrodynamic performance of fowts can be improved by applying multiple moonpools in its barge like foundation by numerical calculations vijay et al 2016 showed that the sloshing modes inside moonpools will shift to high frequencies from one pool situation to four pool situation a similar concept of fowt platform embedded with multiple air cushions was proposed by hao et al 2020 as multiple moonpools are applied the interactions among the fluid oscillations in different moonpools may have influences on the resonance characteristics he et al 2006 lu et al 2011 ning et al 2015 in addition the motions of floating foundation will lead to increases of the natural frequencies of water columns in moonpools perić and swan 2015 xu et al 2020 lu et al 2020 and jiang et al 2020 studied the resonant wave motions in two narrow gaps formed by three floating bodies where coupled oscillations were observed due to the existence of two water columns generally speaking the application of multiple moonpools can improve the hydrodynamic performance of a barge type platform but also lead to more complex hydrodynamic phenomenon which need to be understood this paper presents a study of the characteristics of motion responses of a barge type floating vawt installed with four moonpools three dimensional physical model tests are conducted in a wave basin and numerical calculations based on linear potential flow theory are carried out the effects of gyroscopic moment of turbine rotations on the body motions and mooring forces are studied by varying the rotational speed and mass of the turbine rotors regular waves with different periods and amplitudes are used an in house program code is developed and used to estimate the motion responses and mooring forces of the floating system the remainder of the paper is organized as follows the laboratory model tests are described in section 2 the numerical model and associated validations are presented in section 3 the experimental results and numerical predictions are shown and discussed in section 4 finally conclusions are drawn in section 5 2 physical model tests 2 1 experimental setup physical model tests were performed in a wave tank at nihon university the tank is 24 0 m in length and 7 0 m in width equipped with a piston type wave generator the water depth was fixed at 1 0 m in the tests a sketch of the experimental setup is shown in fig 2 incident waves were generated and propagated to the positive y axis direction a barge type floating foundation installed with four rectangular moonpools and a vawt model was horizontally moored by four tethers the angle between the tether direction and the x axis was 60 a main difficulty in the present experiments is to design the mooring system for the floating system in this study the four vertical supporting structures installed with small pulleys see figs 2 and 3 are specially designed for horizontal mooring and measuring tether tensions the geometry and the positions of these supporting structures are determined through several trials the mooring tethers were connected to vertical springs via the pulleys the barge model was fabricated from vinyl chloride plate upper part and styrene foam lower part in this manner the floating foundation with light weight and small draft was modelled the main parameters of the foundation are shown in table 1 the length and width of the foundation are l b 0 9 m and b 0 4 m respectively each moonpool was 0 3 m long and 0 1 m wide the floater model was 0 16 m high and the draft was d 0 0617 m linear springs with a spring constant of 23 n m were used to provide static pre tensions and mooring restoring forces four ring gauges connected to springs were used to measure the tension forces of the mooring tethers the 6 dof dof degree of freedom motions of the floating foundation were obtained by the inertial sensor on the foundation though it was mainly in sway along the y axis direction heave and roll motions due to the beam sea condition and the symmetry fig 3 shows the paragraphs of the experimental setup a 2 mw class vawt was modelled by reducing the geometry of the prototype with a scale ratio of 1 100 in the experiments the vawt model with three straight blades was made of aluminum the main parameters of the turbine are shown in table 2 the turbine model was 0 94 m high and the rotational radius was 0 27 m each blade was 0 72 m long 0 025 m wide and 0 001 m thick the mass of the turbine model without blade was 484 g the mass of the blades was varied in different groups of tests which will be detailed in the next subsection it should be addressed that there was no wind produced in the experiments alternatively to generate the wind effects the turbine was driven by a small electrical motor to rotate with the designed speeds the motor ch18 was connected with a regulated dc power supply kikusui electronics pmc18 1a via electrical wires as shown in fig 4 the rotating velocity was controlled by setting the corresponding voltage in the power supply the calibration tests suggest that the present system is able to generate a steady rotating speed within 0 120 rpm in 30 minutes during model testing some challenges were experienced for example how to deal with the yaw moment acting on floating foundation induced by turbine rotations several mooring scenarios have been tested and the present setup was determined based on experience another challenge is how to eliminate the influence of friction in pulleys on mooring forces this issue will be mentioned in discussion of results 2 2 model test conditions regular waves were used in the tests the wave conditions blade mass and the rotational speed of the vawt are detailed in table 3 ten incident wave periods 0 6 1 6 s and two wave amplitudes 0 01 m and 0 02 m were considered to study the motion responses of the floating system and associated tension forces of the mooring tethers the wavelength l was varied from 0 56 m to 3 73 m larger than the width of the foundation b 0 40 m the maximum wave steepness h l h is wave height considered in the tests was approximately 0 07 with h h 0 02 0 04 suggesting that some of the incident waves were beyond the linear wave regime to monitor the parameters of incident waves a wave gauge was placed approximately 5 m in front of the floating foundation as shown in fig 2 a as for the wind turbine two blade mass and three rotation speeds were considered in one group of tests the rotation number per minute of the turbine was set to 0 40 or 80 rpm revolutions per minute and the mass of each blade was set to 44 g or 154 g as shown in table 3 for each test first the electric motor was started to drive the vawt to rotate as the rotation reaches a steady state then incident waves were generated the tests were terminated until the motion responses were observed to be fully developed on average it took roughly 10 min for each test from starting turbine rotations to restoring calm water approximately 10 wave periods of the measured time series were used to calculate the first and second order amplitudes of motion responses since the wave amplitude was small the influence of the reflections from wavemakers were expected to be fairly weak according to our previous experimental experience 2 3 data acquisition and processing in the experiments the acquisition rate of the measurement equipment was 100 hz the inertial sensor for measuring motion responses has a high accuracy with the relative error less than 1 the absolute error of the wave gauge was generally less than 1 mm according to calibration tests the experimental data of tether tension forces were collected and processed with a d conversion of 16 bit the rotational velocity of the wind turbine driven by the electric motor was confirmed to be reasonably consistent with the desired value the fft fast fourier transform analysis was performed based on the non filtered experimental data to obtain the first and second order motion amplitudes and mooring tether tensions the second order was defined by the sum frequency component according to the second order weakly non linear theory hereafter which corresponds to the responses with a doubling frequency to the incident wave frequency 3 numerical model 3 1 governing equation and boundary conditions a frequency domain linear potential flow model was developed to predict the motion responses of the floating system and associated mooring forces fig 5 shows a sketch of the numerical setup including the definitions of coordinate system fluid domain and boundaries a barge type floating foundation with four rectangular moonpools were subjected to regular waves in the y axis direction the xy plane was set at the still water level with the origin o at the center of the floating foundation and z axis pointing upwards based on the linear potential flow theory the governing equation in fluid domain ω is the laplace s equation which reads 1 2 φ x 2 2 φ y 2 2 φ z 2 0 where φ x y z t is the velocity potential for harmonic wave motions it can be written as φ x y z t re φ x y z e i ω t where re represents the real part of a complex number ω is the angular frequency of incident waves t is the time and i 1 obviously the time independent complex potential φ also satisfies the laplace s equation the linear boundary conditions for the water free surface s f sea bottom s b and far field are respectively 2a ω 2 g φ φ z 0 on s f 2b φ z 0 on s b 2c lim r r φ r i k φ 0 far field where k is the wave number g is the gravitational acceleration and r x 2 y 2 1 2 the total potential φ can be divided into the incident diffraction and radiation parts 3 φ φ i φ d i 1 6 ζ i φ r i where φ i is the potential of incident waves which has an analytic expression for linear water waves φ d is the diffraction potential and φ ri is the radiation potential excited by unit oscillation of the floating foundation in i th dof the linear boundary condition for the wet surfaces of the floating foundation s h is 4 φ d n φ i n and φ r n n on s h based on the governing equation eq 1 and the boundary conditions eqs 2 and 4 the diffraction potential φ d and the radiation potential φ ri can be obtained the excitation force on the floater due to incident waves reads 5 f e x j ρ ω 2 s h φ i φ d n j d s where ρ is the density of water n j denotes the unit vector in j th dof the coefficients of added mass and radiation damping are respectively 6a a i j 1 ω 2 re ρ s h φ r i n j d s 6b b i j 1 ω im ρ s h φ r i n j d s 3 2 treatment for tether tension the amplitude of 6 dof motion response is obtained by solving the equation of motion as follows 7 ω 2 m a i ω b v b k t c ζ f e x where m b v k t c a and b are respectively the matrices of body mass viscous damping mooring force coefficients hydrodynamic restoring force added mass and radiation damping here the mooring tethers were regarded as linear springs and the mooring restoring coefficients were calculated based on the exact formulation reported by masuda et al 1995 and maeda et al 2000 an illustration for the calculation of tether tension force is shown in fig 6 the anchor point of a tether is denoted by p a and the connection point of tether on the floating foundation is p b the restoring force f m m 1 2 3 or 4 due to a mooring tether can be calculated as follows 8a f m t n m 8b t k m ℓ ℓ 0 where t represents the tether tension which works as an axial force n m is the unit vector of the tether k m is the spring constant ℓ and ℓ 0 are the current length and the initial length of the tether respectively the method of perturbation is used to determine ℓ and n m within the framework of linear theory only the zero and first order terms are considered in this study which read 9a ℓ 0 x m 0 p a 0 9b ℓ 1 x m 1 n m 0 10a n m 0 p a p b 0 ℓ 0 10b n m 1 1 ℓ 0 x m 1 x m 1 n m 0 n m 0 in this study the tether tension t and the mooring force f m were calculated based on eq 8 10 this study only considers linear potential solutions for second order tether tensions detailed descriptions can be found in masuda et al 1995 and maeda et al 2000 3 3 green function method the boundary element method bem was adopted to solve the potential flow model the boundary integral formulations are 11 c p φ p s h φ q g p q n g p q φ q n d s where g p q is the green s function p x y z represents the source point and q x y z represents the field point c p is the solid angle coefficient and its value depends on the position of the source point in this study the green s function reported by wehausen and laitone 1960 was used which satisfies the linearized free surface boundary condition the seabed boundary condition and the radiation condition in the far field the green s function reads 12 g p q a 0 cosh k h z p cosh k h z q h 0 1 k r p q 1 π n 1 b n cos k n h z p cos k n h z q κ 0 k n r p q a 0 i 2 κ 2 k 2 h k 2 h κ 2 κ b n k n 2 κ 2 h k n 2 h κ 2 κ r p q x p x q 2 y p y q 2 where κ ω 2 g in eq 12 h 0 1 is the zero order hankel function of the first kind κ 0 is the zero order modified bessel function of the second kind and k n n 1 2 are the positive roots of the following equation 13 κ k n tan k n h an in house program code based on the panel method was adopted to solve the boundary integral formulations through the discretization of the boundary conditions the first order panels were used which assumes that the source strength over each panel is constant in this study a total of approximately 2600 quadrilateral panels were used to represent the wetted surfaces of the floater the mesh division used in the numerical calculations is shown in fig 7 3 4 numerical validations numerical validations were carried out for the present in house program code before conducting numerical analysis the calculated hydrodynamic coefficients a ii and b ii and wave exciting force fex ii by the present in house code were compared with the calculation results of wamit the results are shown in fig 8 where v b is the volume of the submerged part of foundation and s b is its area surrounded by waterlines in the xy plane generally reasonable agreements were obtained the peak and trough frequencies estimated by the present in house program code and wamit coincide well although slight differences can be found the comparison results in fig 8 suggest that the present in house program code is basically capable in hydrodynamic analysis of floating structures despite that its accuracy is not as high as wamit the non dimensional natural frequency of the piston mode water oscillations in moonpools is denoted by ωn water and marked by the pink dashed lines in the figure it should be pointed out that sloshing motions in moonpools are not included since they generally appear at high frequencies fig 8 shows that for sway and roll motions the sharp spikes appear at the natural frequency ωn water indicating the effects of moonpools on the hydrodynamic characteristics of floating foundation as for heave motion the peak or trough frequency is observed to be smaller than ωn water this result is attributable to the coupling effects between the heave motions of the floater and the piston mode water motions in the moonpools e g lu et al 2020 xu et al 2020 ravinthrakumar et al 2020 4 results and discussion 4 1 motion response attention was first put on the wave induced motion responses of the floating system the experimental time histories of the sway heave and roll motions are shown in fig 9 where the displacement of the floater is denoted by ξ the results correspond to the typical case with the mass of each blade m b 44 g incident wave amplitude a 0 01 m and frequency ω b g 1 2 1 20 and rotational speed of the turbine v r 40 rpm as the beam sea condition was considered in the experiments the surge pitch and yaw motions were found negligible and therefore are not presented it can be seen that before the instant of t 30 sec the sway and heave motions are approximately zero after t 30 sec the sway heave and roll motions are about to develop and it takes approximately 10 s for them to reach the steady state special attention was paid to fig 9 c where noticeable roll motions were found before incident waves reached the floating foundation the observed roll motions are attributable to the motor driven rotations of the wind turbine which was identified during the model testing nevertheless the amplitudes of the motions due to pure aerodynamic effects are generally small under the considered conditions of this study the amplitude spectra of the fully developed motions of the floating foundation are shown in fig 10 which correspond to the time histories between 50 60 s in fig 9 it shows clearly that first harmonic component dominates the motions and the second and higher harmonic components are relatively insignificant the second order sway amplitude is approximately 10 4 of the first order result as shown in fig 10 a for the heave and roll motions fig 10 b and c show that the second order amplitudes are much smaller compared with the first order results moreover the equilibrium positions were found to slightly drift from the initial position particularly for the sway and roll motions note that the drifting distance corresponds to half of the value at zero frequency the drifting phenomenon is ascribed to the effects of the nonlinearities associated with incident waves and mooring tethers generally speaking for the typical case considered in fig 10 the first order component is dominated and the higher order components are not significant however as the rotating speed of turbine or incident wave amplitude increases the second order effects could become significant this point will be demonstrated by the following results the measured amplitude frequency responses of the floating foundation are shown in figs 11 16 where the numerical predictions by the in house program code are also included for comparison the numerical results are linear potential solutions without considering the gyroscopic effects due to vawt rotations the variation of blade mass had little influence on the predicted motion responses hence the numerical solutions in figs 11 16 are observed to be almost identical the main purpose of including numerical predictions is to examine the feasibility of applying linear potential theory to the situations with turbine rotations considering the influence of floater motion and pulley friction on tether tensions the mooring stiffness used for the predictions were somewhat calibrated according to the measured resonant frequencies in addition a few viscous damping was used in the calculations when solving the motion equation of floater to reduce the extremely large peaks of response curves it should be addressed that the viscous damping of the water motions in moonpools was not taken into account throughout the computations the experimental results in figs 11 13 and 15 show that the turbine rotations have non negligible influences on the first order sway and roll motions near the peak frequencies i e the frequencies at which response peaks appear red and blue arrows were used in the figures to illustrate the decrease and increase of response amplitude due to the increasing rotational speed respectively in general the response amplitudes were reduced as the rotating velocity of the turbine increased the result is attributable to the gyroscopic effects of turbine rotations as expected the influence of turbine rotations on the first order heave motion was found to be rather weak regarding the second order motions as suggested by figs 12 14 and 16 the effects of turbine rotations on the sway heave and roll motions were significant in the proximity of the peak frequencies it was found that the second order response amplitudes might be not only reduced but also substantially amplified as the rotating speed of turbine grew taking roll motion for example under the condition of v r 80 rpm the ratio of second order motion amplitude to first order result i e ζ4 2 ζ4 1 is approximately 3 and 10 for the case with m b 44 g and a 0 01 m and that with m b 154 g and a 0 01 m respectively in particular for the case with m b 154 g and a 0 02 m ζ4 2 ζ4 1 increased to 17 suggesting that the second order effect became stronger with increasing blade mass and incident wave amplitude figs 11 13 and 15 show that the comparisons between the numerical and measured first order motion responses were in general agreement despite that some differences in the resonant frequencies and associated amplitudes can be observed regarding the sway and roll motions the observed discrepancies between predicted and measured peak frequencies may be caused by the inaccurate numerical inputs associated with moment of inertia for the response peak amplitudes the observed differences are attributable to that the viscous damping and the influence of the turbine rotations were almost neglected in the calculations regarding the heave motion as shown in figs 11 b 13 b and 15 b reasonable agreements were obtained the observed sharp spikes at ω b g 1 2 2 25 are believed to be over predictions in heave amplitudes since the viscous damping of the piston mode water motions in moonpools was not taken into account in the calculations lu et al 2010 tan et al 2019 it should be pointed out that the over predictions of the potential flow model could be reduced by taking viscous damping and gyroscopic effects into account newman 2004 blusseau and patel 2012 mostafa et al 2012 generally speaking the present comparison results confirm that it is necessary to taken into account the viscous damping of resonant water motions in moonpools and the gyroscopic effects of turbine rotations in the predictions 4 2 mooring force further attention was paid to the tension forces of mooring tethers and the total mooring forces the experimental setup of the four mooring tethers has been illustrated in fig 2 fig 17 shows the time histories of the mooring tether tensions t 1 t 4 three typical wave frequencies were considered including the lowest and highest frequencies considered in the model tests and the peak frequency of sway motion it can be seen that the tether tension force was larger at the peak frequency compared with those at the other frequencies as expected the general variation trends of the tether tensions t 1 and t 2 are similar which are roughly in anti phase with that of t 3 and t 4 in addition to first order component somewhat much higher harmonic components were observed in the tension forces the causes for the observed higher harmonics may be ascribed to the nonlinearities of the mooring system since the measured yaw motion of the floating foundation was almost negligible the angle between the tethers and the x axis was regarded as a constant namely 60 with the results in fig 17 the total mooring forces in x and y axis directions were estimated by 14 f x t 1 t 3 t 2 t 4 cos 60 15 f y t 1 t 2 t 3 t 4 sin 60 the normalization results of f x and f y are presented in fig 18 first it shows that the mooring force in the direction perpendicular to the wave direction was clearly smaller than that in the wave direction i e f x f y compared with the low and high frequencies f y was larger at the peak frequency in addition fig 18 b demonstrates that the first harmonic component dominated the other harmonic components under the resonant condition fig 19 shows the experimental results of first order mooring forces the experimental results in fig 19 suggest that the influence of turbine rotations on mooring force was not significant linear potential solutions are also included in fig 19 for comparison generally reasonable agreements were obtained except some differences between the measured and calculated peak frequencies regarding numerical predictions it was observed that small amplitude response peaks appear at the natural frequency of water oscillation in moonpools in general the comparison results confirm the feasibility of the predictions based on the linear potential theory fig 20 shows the measured second order sum frequency mooring forces the turbine rotations were found to have non negligible influences on the second order mooring forces although the experimental data are somewhat scattered it suggests that the second order mooring force near the key frequency ω b g 1 2 1 0 might be amplified by turbine rotations and therefore should be addressed 4 3 water motions in moonpools finally attention was paid towards the characteristics of water oscillations in moonpools the free surface motions at the centers of the front and rear moon pools defined by wave direction see fig 2 a were calculated using the in house program code and the results are shown in fig 21 where a mp denotes the amplitude of free surface response in moonpools it can be seen that the amplitude frequency response curves of the front and rear pools are somewhat different in fact our experimental observation confirmed that the water responses in the front and rear pools were noticeably different at some frequencies nevertheless the water motions in the moonpools were not measured due to the technical difficulties it can also be seen from fig 21 that for each curve there are two response peaks but none of them appear at the natural frequency of the water column i e ωn water the shift of the resonance frequency is attributable to the motions of the foundation e g lu et al 2020 xu et al 2020 ravinthrakumar et al 2020 generally the characteristics of the response curves in fig 21 are very similar to the results of lu et al 2010 where the fluid resonances in two narrow gaps were studied the two response peaks correspond to the oscillations of water columns in the front and rear moonpools it should be addressed that viscous damping was neglected in the predictions it is expected that the large response amplitudes will be reduced if the viscous damping of water oscillations in moonpools was taken into account fig 22 shows calculated response amplitudes of the water free surfaces in the front and rear moonpools since the water motions were mainly piston mode oscillations the results can be approximately regarded as the instant free surface shapes the two peak frequencies shown in fig 20 i e ω b g 1 2 1 90 and 1 72 and the natural frequency of the water column namely ω b g 1 2 1 84 are included in the figure it can be seen that the water free surfaces in moonpools are almost flat along the y axis whereas they are curved along the x axis perpendicular to the wave propagation direction this result is as expected since the length of moonpool in the x axis direction is three times as long as that in the y axis direction see fig 2 a in addition the difference in free surface shape between the front and rear moonpools is found to be small moreover it is found that the free surface curve in the xz plane is not fully symmetric along the z axis this is particularly obvious for the cases shown in fig 22 c and d where the response amplitudes near the center of floater are larger than that near the outer edges the present results are based on beam sea condition when head sea condition is considered the free surfaces may be more curved and influence the pitch motion of the floating system finally it should be pointed out that in the present predictions the effects of viscous damping on the responses were not taken into account 5 conclusions the motion characteristics of a barge type floating system installed with four rectangular moonpools and a vertical axis wind turbine have been studied through laboratory model tests in a wave tank the focus of this study was on the influence of turbine rotations on the motion responses of the floating system various beam regular waves were considered in the experiments it was found that the first order sway and roll motions of the floating system near the resonant frequencies were reduced by the turbine rotations due to the gyroscopic effects whereas the first order heave motion of the floating system was hardly influenced by the turbine rotations regarding the second order motion responses and mooring tether tensions the influence of the turbine rotations was noticeable in the proximity of the resonant frequencies in the model tests of this work the maximum ratio of the second order response amplitude of roll motion to the first order result was approximately 17 as the rotating speed of wind turbine or blade mass was increased it was found that the second order effects might be amplified an in house program code for radiation and diffraction problems has been developed based on the linear potential flow theory and was validated against the results of wamit numerical predictions of motion responses and mooring forces were produced based on the in house code and compared with the experimental data the comparison results suggest that the viscous damping of the fluid resonance in moonpools and the gyroscopic effects of turbine rotations should be taken into account in the predictions of motions responses and mooring forces in addition to investigate the experimentally observed higher order responses numerical models based on nonlinear wave theory should be adopted in future the characteristics of the water motions in moonpools have been investigated based on the present potential flow model the amplitude frequency responses of water columns and the water free surface shapes at resonant frequencies were presented the water motions and free surface shapes in the front and rear moonpools defined by wave direction were observed to be different at particular frequencies the shapes of the water free surfaces were generally curved in head sea direction and might be not symmetric suggesting that the influence of the water motions in moonpools on pitch motion should be addressed particularly for head sea conditions credit authorship contribution statement tomoki ikoma conceptualization methodology resources supervision writing review editing lei tan investigation validation software visualization formal analysis writing original draft satsuya moritsu data curation investigation software visualization yasuhiro aida investigation resources koichi masuda methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is mainly supported by the nihon university college of science and technology project for research the first and second authors would like to acknowledge the joint research project of institute of ocean energy saga university and state key laboratory of coastal and offshore engineering dalian university of technology no lp 2024 the valuable comments from dr xiao dong bai from tianjin university are highly appreciated 
20756,the studies on floating offshore wind turbines have been increasing over recent decades due to the growing investments of industries in marine renewable energy compared with horizontal axis wind turbines research on vertical axis wind turbines is relatively few though the latter may have advantages over the former in some aspects for example potentially lower cost of energy in this paper the characteristics of the motion responses of a barge type floating system with four moonpools and a vertical axis wind turbine are experimentally and numerically investigated the focus is on the gyroscopic effects of turbine rotations on the motion responses of the floating system under different wave conditions physical model tests are conducted in a wave tank where a 2 mw class turbine is modelled in the 1 100 scale it is found that the first order sway and roll motion amplitudes near the resonant frequencies are reduced by the turbine rotations whereas the first order heave motion of the floating system is hardly influenced the second order motion responses and mooring tether tensions may be significantly amplified with the increasing rotating speed of turbine the maximum ratio of the second order response amplitude of roll motion to the first order roll amplitude is up to 17 in the experiments of this study a radiation and diffraction code based on linear potential flow theory is used to predict the motion responses and mooring forces the comparisons with experimental data suggest that the viscous damping of water resonance in moonpools and the gyroscopic effects of turbine rotations should be taken into account in predictions keywords vertical axis wind turbine gyroscopic effect moonpools barge fowt 1 introduction to exploit ocean wind energy various concepts of fowts floating offshore wind turbines have been proposed over the past decades in terms of supporting platforms there are mainly four types wang et al 2010 i e spar buoy tlp tension leg platform semi submersible column stabilised and barge or pontoon types among these types of platforms the barge type is of advantages in the simplify in design construct and install particularly suitable for a water depth of 50 100 m due to their feature of low draft the barge type fowts are generally moored to sea floor by catenary lines and maintain stability based on their water plane areas with regard to wind turbines there are mainly two types hawts horizontal axis wind turbines and vawts vertical axis wind turbines so far most of studies have been focused on hawts and some sea tests with prototypes have been performed although hawts is efficient in utilizing wind energy the costs of on site maintenance for hawts are generally high since the nacelles are installed at top of the turbine which maybe over 100 m in height by contrast for vawts power generation devices are generally installed at the bottoms of the turbines which leads to lower installation and maintenance costs compared with hawts in addition vawts have an advantage over hawts since the former naturally have no requirement for wind direction for these reasons increasing attention has been paid to floating vawts over recent years e g collu et al 2012 wang et al 2014 borg et al 2014 paulsen et al 2015 cheng et al 2017 regarding a rotating wind turbine the inclination of its rotation axis will result in gyroscopic moment it has been reported blusseau and patel 2012 mostafa et al 2012 that the gyroscopic effect due to turbine rotations on the motions of floating wind turbines may be significant at some key frequencies murai and nishimura 2010 and murai et al 2013 calculated the motion responses of several types of fowts using a potential flow model where gyroscopic force was estimated and considered in the motion equations of fowts by physical model testing nihei et al 2011 2014 reported that the gyroscopic effect of turbine rotations may lead to increasing yaw motions and even cause a tlp type of fowt to capsize akimoto et al 2014 numerically investigated the gyroscopic effect on the dynamics of a spar type fowt in regular waves their results show that the gyroscopic effect enhances the stability of turbine axis antonutti et al 2018 studied the influence of wind induced inclination of a floating wind turbine on its motions souza and bachynski 2019 presented the wind induced nonlinear effects on the low frequency motions of a floating hawt recently palraj and rajamanickam 2020 designed a gyrostabilizer and examined its effects on reducing the motions of a barge type fowt in waves through numerical simulations de tavernier et al 2020 investigated the feasibility of aerodynamically damping the motions of a floating vawt to authors knowledge the studies on the gyroscopic effect of fowts are still insufficient so far particularly for vertical axis type of fowts the dynamic responses of barge type fowts have been investigated numerically and experimentally jonkman and buhl 2007 developed a comprehensive simulation tool and analyzed the loads of a 5 mw megawatt wind turbine model installed on a squared barge like platform iijima et al 2010 analyzed the hydroelastic performance of a barge type fowt hu et al 2018 proposed a method to mitigate the loads of a barge type fowt through passive structural control focusing on second order hydrodynamic effects zhang et al 2020 investigated the motion characteristics of three semisubmersible fowts via numerical simulations in addition to the extensive numerical investigations experimental studies of fowts have recently been reviewed by gueydon et al 2020 recently the concept of damping pool was proposed by ideol company choisnet et al 2014 to reduce the motions of a barge type fowt as shown in fig 1 from the point of view of engineering this concept is attractive since it can not only improve the hydrodynamic performance of fowt but also reduce its manufacturing cost a theoretical study on the water motion in a rectangular moonpool is referred to molin 2001 through cfd simulations beyer et al 2015 and borisade et al 2016 investigated the motion responses and mooring line tensions of a barge type floating wind turbine installed with a moonpool more recently kosasih et al 2019 experimentally studied the dynamic response behaviours of a pontoon type floater with a moonpool compared with one moonpool ikoma et al 2019 reported that the hydrodynamic performance of fowts can be improved by applying multiple moonpools in its barge like foundation by numerical calculations vijay et al 2016 showed that the sloshing modes inside moonpools will shift to high frequencies from one pool situation to four pool situation a similar concept of fowt platform embedded with multiple air cushions was proposed by hao et al 2020 as multiple moonpools are applied the interactions among the fluid oscillations in different moonpools may have influences on the resonance characteristics he et al 2006 lu et al 2011 ning et al 2015 in addition the motions of floating foundation will lead to increases of the natural frequencies of water columns in moonpools perić and swan 2015 xu et al 2020 lu et al 2020 and jiang et al 2020 studied the resonant wave motions in two narrow gaps formed by three floating bodies where coupled oscillations were observed due to the existence of two water columns generally speaking the application of multiple moonpools can improve the hydrodynamic performance of a barge type platform but also lead to more complex hydrodynamic phenomenon which need to be understood this paper presents a study of the characteristics of motion responses of a barge type floating vawt installed with four moonpools three dimensional physical model tests are conducted in a wave basin and numerical calculations based on linear potential flow theory are carried out the effects of gyroscopic moment of turbine rotations on the body motions and mooring forces are studied by varying the rotational speed and mass of the turbine rotors regular waves with different periods and amplitudes are used an in house program code is developed and used to estimate the motion responses and mooring forces of the floating system the remainder of the paper is organized as follows the laboratory model tests are described in section 2 the numerical model and associated validations are presented in section 3 the experimental results and numerical predictions are shown and discussed in section 4 finally conclusions are drawn in section 5 2 physical model tests 2 1 experimental setup physical model tests were performed in a wave tank at nihon university the tank is 24 0 m in length and 7 0 m in width equipped with a piston type wave generator the water depth was fixed at 1 0 m in the tests a sketch of the experimental setup is shown in fig 2 incident waves were generated and propagated to the positive y axis direction a barge type floating foundation installed with four rectangular moonpools and a vawt model was horizontally moored by four tethers the angle between the tether direction and the x axis was 60 a main difficulty in the present experiments is to design the mooring system for the floating system in this study the four vertical supporting structures installed with small pulleys see figs 2 and 3 are specially designed for horizontal mooring and measuring tether tensions the geometry and the positions of these supporting structures are determined through several trials the mooring tethers were connected to vertical springs via the pulleys the barge model was fabricated from vinyl chloride plate upper part and styrene foam lower part in this manner the floating foundation with light weight and small draft was modelled the main parameters of the foundation are shown in table 1 the length and width of the foundation are l b 0 9 m and b 0 4 m respectively each moonpool was 0 3 m long and 0 1 m wide the floater model was 0 16 m high and the draft was d 0 0617 m linear springs with a spring constant of 23 n m were used to provide static pre tensions and mooring restoring forces four ring gauges connected to springs were used to measure the tension forces of the mooring tethers the 6 dof dof degree of freedom motions of the floating foundation were obtained by the inertial sensor on the foundation though it was mainly in sway along the y axis direction heave and roll motions due to the beam sea condition and the symmetry fig 3 shows the paragraphs of the experimental setup a 2 mw class vawt was modelled by reducing the geometry of the prototype with a scale ratio of 1 100 in the experiments the vawt model with three straight blades was made of aluminum the main parameters of the turbine are shown in table 2 the turbine model was 0 94 m high and the rotational radius was 0 27 m each blade was 0 72 m long 0 025 m wide and 0 001 m thick the mass of the turbine model without blade was 484 g the mass of the blades was varied in different groups of tests which will be detailed in the next subsection it should be addressed that there was no wind produced in the experiments alternatively to generate the wind effects the turbine was driven by a small electrical motor to rotate with the designed speeds the motor ch18 was connected with a regulated dc power supply kikusui electronics pmc18 1a via electrical wires as shown in fig 4 the rotating velocity was controlled by setting the corresponding voltage in the power supply the calibration tests suggest that the present system is able to generate a steady rotating speed within 0 120 rpm in 30 minutes during model testing some challenges were experienced for example how to deal with the yaw moment acting on floating foundation induced by turbine rotations several mooring scenarios have been tested and the present setup was determined based on experience another challenge is how to eliminate the influence of friction in pulleys on mooring forces this issue will be mentioned in discussion of results 2 2 model test conditions regular waves were used in the tests the wave conditions blade mass and the rotational speed of the vawt are detailed in table 3 ten incident wave periods 0 6 1 6 s and two wave amplitudes 0 01 m and 0 02 m were considered to study the motion responses of the floating system and associated tension forces of the mooring tethers the wavelength l was varied from 0 56 m to 3 73 m larger than the width of the foundation b 0 40 m the maximum wave steepness h l h is wave height considered in the tests was approximately 0 07 with h h 0 02 0 04 suggesting that some of the incident waves were beyond the linear wave regime to monitor the parameters of incident waves a wave gauge was placed approximately 5 m in front of the floating foundation as shown in fig 2 a as for the wind turbine two blade mass and three rotation speeds were considered in one group of tests the rotation number per minute of the turbine was set to 0 40 or 80 rpm revolutions per minute and the mass of each blade was set to 44 g or 154 g as shown in table 3 for each test first the electric motor was started to drive the vawt to rotate as the rotation reaches a steady state then incident waves were generated the tests were terminated until the motion responses were observed to be fully developed on average it took roughly 10 min for each test from starting turbine rotations to restoring calm water approximately 10 wave periods of the measured time series were used to calculate the first and second order amplitudes of motion responses since the wave amplitude was small the influence of the reflections from wavemakers were expected to be fairly weak according to our previous experimental experience 2 3 data acquisition and processing in the experiments the acquisition rate of the measurement equipment was 100 hz the inertial sensor for measuring motion responses has a high accuracy with the relative error less than 1 the absolute error of the wave gauge was generally less than 1 mm according to calibration tests the experimental data of tether tension forces were collected and processed with a d conversion of 16 bit the rotational velocity of the wind turbine driven by the electric motor was confirmed to be reasonably consistent with the desired value the fft fast fourier transform analysis was performed based on the non filtered experimental data to obtain the first and second order motion amplitudes and mooring tether tensions the second order was defined by the sum frequency component according to the second order weakly non linear theory hereafter which corresponds to the responses with a doubling frequency to the incident wave frequency 3 numerical model 3 1 governing equation and boundary conditions a frequency domain linear potential flow model was developed to predict the motion responses of the floating system and associated mooring forces fig 5 shows a sketch of the numerical setup including the definitions of coordinate system fluid domain and boundaries a barge type floating foundation with four rectangular moonpools were subjected to regular waves in the y axis direction the xy plane was set at the still water level with the origin o at the center of the floating foundation and z axis pointing upwards based on the linear potential flow theory the governing equation in fluid domain ω is the laplace s equation which reads 1 2 φ x 2 2 φ y 2 2 φ z 2 0 where φ x y z t is the velocity potential for harmonic wave motions it can be written as φ x y z t re φ x y z e i ω t where re represents the real part of a complex number ω is the angular frequency of incident waves t is the time and i 1 obviously the time independent complex potential φ also satisfies the laplace s equation the linear boundary conditions for the water free surface s f sea bottom s b and far field are respectively 2a ω 2 g φ φ z 0 on s f 2b φ z 0 on s b 2c lim r r φ r i k φ 0 far field where k is the wave number g is the gravitational acceleration and r x 2 y 2 1 2 the total potential φ can be divided into the incident diffraction and radiation parts 3 φ φ i φ d i 1 6 ζ i φ r i where φ i is the potential of incident waves which has an analytic expression for linear water waves φ d is the diffraction potential and φ ri is the radiation potential excited by unit oscillation of the floating foundation in i th dof the linear boundary condition for the wet surfaces of the floating foundation s h is 4 φ d n φ i n and φ r n n on s h based on the governing equation eq 1 and the boundary conditions eqs 2 and 4 the diffraction potential φ d and the radiation potential φ ri can be obtained the excitation force on the floater due to incident waves reads 5 f e x j ρ ω 2 s h φ i φ d n j d s where ρ is the density of water n j denotes the unit vector in j th dof the coefficients of added mass and radiation damping are respectively 6a a i j 1 ω 2 re ρ s h φ r i n j d s 6b b i j 1 ω im ρ s h φ r i n j d s 3 2 treatment for tether tension the amplitude of 6 dof motion response is obtained by solving the equation of motion as follows 7 ω 2 m a i ω b v b k t c ζ f e x where m b v k t c a and b are respectively the matrices of body mass viscous damping mooring force coefficients hydrodynamic restoring force added mass and radiation damping here the mooring tethers were regarded as linear springs and the mooring restoring coefficients were calculated based on the exact formulation reported by masuda et al 1995 and maeda et al 2000 an illustration for the calculation of tether tension force is shown in fig 6 the anchor point of a tether is denoted by p a and the connection point of tether on the floating foundation is p b the restoring force f m m 1 2 3 or 4 due to a mooring tether can be calculated as follows 8a f m t n m 8b t k m ℓ ℓ 0 where t represents the tether tension which works as an axial force n m is the unit vector of the tether k m is the spring constant ℓ and ℓ 0 are the current length and the initial length of the tether respectively the method of perturbation is used to determine ℓ and n m within the framework of linear theory only the zero and first order terms are considered in this study which read 9a ℓ 0 x m 0 p a 0 9b ℓ 1 x m 1 n m 0 10a n m 0 p a p b 0 ℓ 0 10b n m 1 1 ℓ 0 x m 1 x m 1 n m 0 n m 0 in this study the tether tension t and the mooring force f m were calculated based on eq 8 10 this study only considers linear potential solutions for second order tether tensions detailed descriptions can be found in masuda et al 1995 and maeda et al 2000 3 3 green function method the boundary element method bem was adopted to solve the potential flow model the boundary integral formulations are 11 c p φ p s h φ q g p q n g p q φ q n d s where g p q is the green s function p x y z represents the source point and q x y z represents the field point c p is the solid angle coefficient and its value depends on the position of the source point in this study the green s function reported by wehausen and laitone 1960 was used which satisfies the linearized free surface boundary condition the seabed boundary condition and the radiation condition in the far field the green s function reads 12 g p q a 0 cosh k h z p cosh k h z q h 0 1 k r p q 1 π n 1 b n cos k n h z p cos k n h z q κ 0 k n r p q a 0 i 2 κ 2 k 2 h k 2 h κ 2 κ b n k n 2 κ 2 h k n 2 h κ 2 κ r p q x p x q 2 y p y q 2 where κ ω 2 g in eq 12 h 0 1 is the zero order hankel function of the first kind κ 0 is the zero order modified bessel function of the second kind and k n n 1 2 are the positive roots of the following equation 13 κ k n tan k n h an in house program code based on the panel method was adopted to solve the boundary integral formulations through the discretization of the boundary conditions the first order panels were used which assumes that the source strength over each panel is constant in this study a total of approximately 2600 quadrilateral panels were used to represent the wetted surfaces of the floater the mesh division used in the numerical calculations is shown in fig 7 3 4 numerical validations numerical validations were carried out for the present in house program code before conducting numerical analysis the calculated hydrodynamic coefficients a ii and b ii and wave exciting force fex ii by the present in house code were compared with the calculation results of wamit the results are shown in fig 8 where v b is the volume of the submerged part of foundation and s b is its area surrounded by waterlines in the xy plane generally reasonable agreements were obtained the peak and trough frequencies estimated by the present in house program code and wamit coincide well although slight differences can be found the comparison results in fig 8 suggest that the present in house program code is basically capable in hydrodynamic analysis of floating structures despite that its accuracy is not as high as wamit the non dimensional natural frequency of the piston mode water oscillations in moonpools is denoted by ωn water and marked by the pink dashed lines in the figure it should be pointed out that sloshing motions in moonpools are not included since they generally appear at high frequencies fig 8 shows that for sway and roll motions the sharp spikes appear at the natural frequency ωn water indicating the effects of moonpools on the hydrodynamic characteristics of floating foundation as for heave motion the peak or trough frequency is observed to be smaller than ωn water this result is attributable to the coupling effects between the heave motions of the floater and the piston mode water motions in the moonpools e g lu et al 2020 xu et al 2020 ravinthrakumar et al 2020 4 results and discussion 4 1 motion response attention was first put on the wave induced motion responses of the floating system the experimental time histories of the sway heave and roll motions are shown in fig 9 where the displacement of the floater is denoted by ξ the results correspond to the typical case with the mass of each blade m b 44 g incident wave amplitude a 0 01 m and frequency ω b g 1 2 1 20 and rotational speed of the turbine v r 40 rpm as the beam sea condition was considered in the experiments the surge pitch and yaw motions were found negligible and therefore are not presented it can be seen that before the instant of t 30 sec the sway and heave motions are approximately zero after t 30 sec the sway heave and roll motions are about to develop and it takes approximately 10 s for them to reach the steady state special attention was paid to fig 9 c where noticeable roll motions were found before incident waves reached the floating foundation the observed roll motions are attributable to the motor driven rotations of the wind turbine which was identified during the model testing nevertheless the amplitudes of the motions due to pure aerodynamic effects are generally small under the considered conditions of this study the amplitude spectra of the fully developed motions of the floating foundation are shown in fig 10 which correspond to the time histories between 50 60 s in fig 9 it shows clearly that first harmonic component dominates the motions and the second and higher harmonic components are relatively insignificant the second order sway amplitude is approximately 10 4 of the first order result as shown in fig 10 a for the heave and roll motions fig 10 b and c show that the second order amplitudes are much smaller compared with the first order results moreover the equilibrium positions were found to slightly drift from the initial position particularly for the sway and roll motions note that the drifting distance corresponds to half of the value at zero frequency the drifting phenomenon is ascribed to the effects of the nonlinearities associated with incident waves and mooring tethers generally speaking for the typical case considered in fig 10 the first order component is dominated and the higher order components are not significant however as the rotating speed of turbine or incident wave amplitude increases the second order effects could become significant this point will be demonstrated by the following results the measured amplitude frequency responses of the floating foundation are shown in figs 11 16 where the numerical predictions by the in house program code are also included for comparison the numerical results are linear potential solutions without considering the gyroscopic effects due to vawt rotations the variation of blade mass had little influence on the predicted motion responses hence the numerical solutions in figs 11 16 are observed to be almost identical the main purpose of including numerical predictions is to examine the feasibility of applying linear potential theory to the situations with turbine rotations considering the influence of floater motion and pulley friction on tether tensions the mooring stiffness used for the predictions were somewhat calibrated according to the measured resonant frequencies in addition a few viscous damping was used in the calculations when solving the motion equation of floater to reduce the extremely large peaks of response curves it should be addressed that the viscous damping of the water motions in moonpools was not taken into account throughout the computations the experimental results in figs 11 13 and 15 show that the turbine rotations have non negligible influences on the first order sway and roll motions near the peak frequencies i e the frequencies at which response peaks appear red and blue arrows were used in the figures to illustrate the decrease and increase of response amplitude due to the increasing rotational speed respectively in general the response amplitudes were reduced as the rotating velocity of the turbine increased the result is attributable to the gyroscopic effects of turbine rotations as expected the influence of turbine rotations on the first order heave motion was found to be rather weak regarding the second order motions as suggested by figs 12 14 and 16 the effects of turbine rotations on the sway heave and roll motions were significant in the proximity of the peak frequencies it was found that the second order response amplitudes might be not only reduced but also substantially amplified as the rotating speed of turbine grew taking roll motion for example under the condition of v r 80 rpm the ratio of second order motion amplitude to first order result i e ζ4 2 ζ4 1 is approximately 3 and 10 for the case with m b 44 g and a 0 01 m and that with m b 154 g and a 0 01 m respectively in particular for the case with m b 154 g and a 0 02 m ζ4 2 ζ4 1 increased to 17 suggesting that the second order effect became stronger with increasing blade mass and incident wave amplitude figs 11 13 and 15 show that the comparisons between the numerical and measured first order motion responses were in general agreement despite that some differences in the resonant frequencies and associated amplitudes can be observed regarding the sway and roll motions the observed discrepancies between predicted and measured peak frequencies may be caused by the inaccurate numerical inputs associated with moment of inertia for the response peak amplitudes the observed differences are attributable to that the viscous damping and the influence of the turbine rotations were almost neglected in the calculations regarding the heave motion as shown in figs 11 b 13 b and 15 b reasonable agreements were obtained the observed sharp spikes at ω b g 1 2 2 25 are believed to be over predictions in heave amplitudes since the viscous damping of the piston mode water motions in moonpools was not taken into account in the calculations lu et al 2010 tan et al 2019 it should be pointed out that the over predictions of the potential flow model could be reduced by taking viscous damping and gyroscopic effects into account newman 2004 blusseau and patel 2012 mostafa et al 2012 generally speaking the present comparison results confirm that it is necessary to taken into account the viscous damping of resonant water motions in moonpools and the gyroscopic effects of turbine rotations in the predictions 4 2 mooring force further attention was paid to the tension forces of mooring tethers and the total mooring forces the experimental setup of the four mooring tethers has been illustrated in fig 2 fig 17 shows the time histories of the mooring tether tensions t 1 t 4 three typical wave frequencies were considered including the lowest and highest frequencies considered in the model tests and the peak frequency of sway motion it can be seen that the tether tension force was larger at the peak frequency compared with those at the other frequencies as expected the general variation trends of the tether tensions t 1 and t 2 are similar which are roughly in anti phase with that of t 3 and t 4 in addition to first order component somewhat much higher harmonic components were observed in the tension forces the causes for the observed higher harmonics may be ascribed to the nonlinearities of the mooring system since the measured yaw motion of the floating foundation was almost negligible the angle between the tethers and the x axis was regarded as a constant namely 60 with the results in fig 17 the total mooring forces in x and y axis directions were estimated by 14 f x t 1 t 3 t 2 t 4 cos 60 15 f y t 1 t 2 t 3 t 4 sin 60 the normalization results of f x and f y are presented in fig 18 first it shows that the mooring force in the direction perpendicular to the wave direction was clearly smaller than that in the wave direction i e f x f y compared with the low and high frequencies f y was larger at the peak frequency in addition fig 18 b demonstrates that the first harmonic component dominated the other harmonic components under the resonant condition fig 19 shows the experimental results of first order mooring forces the experimental results in fig 19 suggest that the influence of turbine rotations on mooring force was not significant linear potential solutions are also included in fig 19 for comparison generally reasonable agreements were obtained except some differences between the measured and calculated peak frequencies regarding numerical predictions it was observed that small amplitude response peaks appear at the natural frequency of water oscillation in moonpools in general the comparison results confirm the feasibility of the predictions based on the linear potential theory fig 20 shows the measured second order sum frequency mooring forces the turbine rotations were found to have non negligible influences on the second order mooring forces although the experimental data are somewhat scattered it suggests that the second order mooring force near the key frequency ω b g 1 2 1 0 might be amplified by turbine rotations and therefore should be addressed 4 3 water motions in moonpools finally attention was paid towards the characteristics of water oscillations in moonpools the free surface motions at the centers of the front and rear moon pools defined by wave direction see fig 2 a were calculated using the in house program code and the results are shown in fig 21 where a mp denotes the amplitude of free surface response in moonpools it can be seen that the amplitude frequency response curves of the front and rear pools are somewhat different in fact our experimental observation confirmed that the water responses in the front and rear pools were noticeably different at some frequencies nevertheless the water motions in the moonpools were not measured due to the technical difficulties it can also be seen from fig 21 that for each curve there are two response peaks but none of them appear at the natural frequency of the water column i e ωn water the shift of the resonance frequency is attributable to the motions of the foundation e g lu et al 2020 xu et al 2020 ravinthrakumar et al 2020 generally the characteristics of the response curves in fig 21 are very similar to the results of lu et al 2010 where the fluid resonances in two narrow gaps were studied the two response peaks correspond to the oscillations of water columns in the front and rear moonpools it should be addressed that viscous damping was neglected in the predictions it is expected that the large response amplitudes will be reduced if the viscous damping of water oscillations in moonpools was taken into account fig 22 shows calculated response amplitudes of the water free surfaces in the front and rear moonpools since the water motions were mainly piston mode oscillations the results can be approximately regarded as the instant free surface shapes the two peak frequencies shown in fig 20 i e ω b g 1 2 1 90 and 1 72 and the natural frequency of the water column namely ω b g 1 2 1 84 are included in the figure it can be seen that the water free surfaces in moonpools are almost flat along the y axis whereas they are curved along the x axis perpendicular to the wave propagation direction this result is as expected since the length of moonpool in the x axis direction is three times as long as that in the y axis direction see fig 2 a in addition the difference in free surface shape between the front and rear moonpools is found to be small moreover it is found that the free surface curve in the xz plane is not fully symmetric along the z axis this is particularly obvious for the cases shown in fig 22 c and d where the response amplitudes near the center of floater are larger than that near the outer edges the present results are based on beam sea condition when head sea condition is considered the free surfaces may be more curved and influence the pitch motion of the floating system finally it should be pointed out that in the present predictions the effects of viscous damping on the responses were not taken into account 5 conclusions the motion characteristics of a barge type floating system installed with four rectangular moonpools and a vertical axis wind turbine have been studied through laboratory model tests in a wave tank the focus of this study was on the influence of turbine rotations on the motion responses of the floating system various beam regular waves were considered in the experiments it was found that the first order sway and roll motions of the floating system near the resonant frequencies were reduced by the turbine rotations due to the gyroscopic effects whereas the first order heave motion of the floating system was hardly influenced by the turbine rotations regarding the second order motion responses and mooring tether tensions the influence of the turbine rotations was noticeable in the proximity of the resonant frequencies in the model tests of this work the maximum ratio of the second order response amplitude of roll motion to the first order result was approximately 17 as the rotating speed of wind turbine or blade mass was increased it was found that the second order effects might be amplified an in house program code for radiation and diffraction problems has been developed based on the linear potential flow theory and was validated against the results of wamit numerical predictions of motion responses and mooring forces were produced based on the in house code and compared with the experimental data the comparison results suggest that the viscous damping of the fluid resonance in moonpools and the gyroscopic effects of turbine rotations should be taken into account in the predictions of motions responses and mooring forces in addition to investigate the experimentally observed higher order responses numerical models based on nonlinear wave theory should be adopted in future the characteristics of the water motions in moonpools have been investigated based on the present potential flow model the amplitude frequency responses of water columns and the water free surface shapes at resonant frequencies were presented the water motions and free surface shapes in the front and rear moonpools defined by wave direction were observed to be different at particular frequencies the shapes of the water free surfaces were generally curved in head sea direction and might be not symmetric suggesting that the influence of the water motions in moonpools on pitch motion should be addressed particularly for head sea conditions credit authorship contribution statement tomoki ikoma conceptualization methodology resources supervision writing review editing lei tan investigation validation software visualization formal analysis writing original draft satsuya moritsu data curation investigation software visualization yasuhiro aida investigation resources koichi masuda methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is mainly supported by the nihon university college of science and technology project for research the first and second authors would like to acknowledge the joint research project of institute of ocean energy saga university and state key laboratory of coastal and offshore engineering dalian university of technology no lp 2024 the valuable comments from dr xiao dong bai from tianjin university are highly appreciated 
20757,the golden horn estuary is a hotspot for marine pollution because of its close proximity to the strait of istanbul strait with dense maritime traffic and high pollution risk of oil spill transport and fate of water and contaminants in strait and estuary are analyzed by three dimensional numerical models eddies forming at the golden horn junction junction either on a single layer or distributed over the entire water column block the water exchange partly or entirely across the junction in case of an oil spill in adjacent waters the size and distribution of eddies at junction control the transport and fate of contaminants inside estuary using twenty test cases the exchange flows at junction are classified in four types based on sea level difference between north and south boundaries of strait and reynolds number of surface flow eddies may prevent the natural water exchange between strait and estuary but also block the contaminants penetrating to estuary under predominant conditions of mild and moderate southward net flow in strait surface waters enter estuary during very strong southward flow junction is blocked to black sea water and surface contaminants strait hydrodynamics control water exchange with estuary through eddy formation when horizontal eddies are formed at junction their size and distribution control the transport and fate of contaminants in branching inlets and estuaries by blocking the water exchange either entirely or partly in specific layers keywords contaminant transport fate of contamination eddy currents estuarine hydrodynamics oil spill strait of istanbul golden horn 1 introduction with over 300 thousand movements of local and transit vessels per year the strait of istanbul the strait is a congested waterway with a significant risk for collision and grounding accidents altan and otay 2018 özlem et al 2020 strong water currents combined with a dangerous navigation channel impose a great risk to human health and the environment in case of an oil spill in the strait the transport of contaminants and consequently the fate of adjacent water bodies especially the golden horn the estuary are of great concern for public health and safety scientifically it is a problem of complex hydrodynamics and random occurrence of accidents in the strait on average 8700 tankers annually transit the strait carrying a total of 138 million tons of oil and other hazardous materials altan and otay 2017 in case of a tanker accident statistically over 15 000 tons of contaminant is expected to spill to the strait the golden horn junction the junction near the southern boundary of the strait fig 1 is a hot spot for marine accidents because of complex currents and denser local traffic around the ports concentrated near the city center yazıcı and otay both tanker accidents and bunker spills from non tanker vessels constitute a high risk of marine pollution at the junction the present work has been inspired by the expert witness reports and the emergency response plans for oil spills in the area otay and yenigün 2003 otay et al 2014 otay and aslan 2017 the estuary is a narrow estuary with three sides surrounded by the historic center of istanbul and only one side open to the strait the historic coastline the dense population and the rapidly decaying fish habitat make the estuary a sensitive water body to contamination the complex hydrodynamics and the random traffic patterns in the area make the risk analysis quite difficult the present work may help to understand the transport mechanisms in the strait and the estuary and identify when and how the contaminants in the strait may or may not pose a threat to the estuary the results showed that the flow at the junction is quite complex compared to the main flow in the strait at the junction the flow is three dimensional the net flow in and out of the estuary is controlled by the horizontal and vertical eddies at the junction in case of an oil spill the net water exchange may be blocked depending on if eddies are formed at the junction consequently contaminants cannot penetrate to the estuary depending on the flow conditions and the accident location relative to the junction a simple parametric relation is developed based on easily measurable quantities including the junction reynolds number re and the sea level difference between the two ends of the strait δh these parameters control the turbulent eddy formation and the exchange flow at the junction and consequently the contamination of the estuary in case of an oil spill the findings can be used in oil spill emergency response plans for coastal facilities in istanbul knowing the critical conditions that may lead to the contamination of the estuary experts can implement protection plans on a regional scale extending outside of the estuary to protect the historic peninsula these plans may help to control and remediate the marine pollution risk of the estuary due to spill accidents in the strait and the adjacent seas including the black sea and the marmara sea the hydrodynamics of the strait and numerical model results are discussed in section 2 the exchange flow at the junction is investigated in section 3 including flow patterns in vertical layers the flow at the junction is examined for the eddy formation and its effect on the exchange flow between the strait and the estuary after examining a large range of flow conditions in the surface mid and bottom layers four different flow types are identified at the junction these types are categorized in terms of two hydrodynamic parameters the head difference in the strait and the junction reynolds number which control the eddy formation and consequently the exchange flow at the junction transport of contaminants into the estuary due to spills in adjacent waters is discussed in section 4 various accident scenarios are analyzed north and south of the junction to model the transport and fate of contaminants in the estuary depending on the flow type in section 5 2 hydrodynamics of the strait of istanbul the strait is a complex hydrodynamic system connecting the less saline waters of the black sea with a slightly higher sea level in the north to the more saline marmara sea in the south the black sea may rise up to a meter above the marmara sea level the vertical stratification caused by the salinity difference of the two seas has first been reported by marsilii 1681 whose book on the strait is known as the pioneering work of modern oceanography the layered flow structure has first been identified by modern scientific studies of özsoy et al 1986 to occur in three different forms that depend on the hydrodynamic conditions these are the two layer flow 2lf upper layer blockage ulb and lower layer blockage llb the 2lf is the predominant state where the upper layer flow is forced mainly by the higher sea level on one side of the strait most of the time on the black sea side relative to the other boundary and the lower layer flow is a density current caused by the density difference between the waters of the black sea and the marmara sea under extreme storm conditions where the surface current from one of the boundary seas is extremely dominant the opposing current either in the upper layer or the lower layer may get blocked as a result water flows in a single layer known as ulb or llb which are the two exceptions of the predominant flow structure in the strait the net volume flux between the upper and lower layers q net vertical profiles of temperature and salinity at the two open boundaries and the sea level difference between the two ends of the strait δh determine the critical states oğuz et al 1990 özsoy et al 1995 1996 and altıok et al 2014 a comprehensive review of the experimental and numerical works can be found in ünlüata and oğuz 1983 a variety of mathematical models of the strait were developed starting with simple two dimensional analytical solutions sümer and bakioğ to complex large scale three dimensional numerical model results using supercomputers sannino et al 2017 sözer and özsoy 2017 the present study uses a hybrid method developed by aslan 2016 to examine the variability of possible flow conditions at the junction the flow of water and contaminants are resolved with a three dimensional multi phase turbulent flow computer model efdc solved on a personal computer for model results to realistically represent the actual conditions at the junction a large set of field measurements are used as input boundary conditions to the numerical model aslan 2016 the same test cases served to verify the output quality of the numerical model in comparison to measured values within the strait after establishing a reliable model of the strait and the estuary alternating flow conditions are created to test the critical three dimensional flow and transport conditions at the junction that control the contamination mechanism of the estuary 2 1 numerical model the environmental fluid dynamics code efdc is used for the simulation of the three dimensional hydrodynamics and contaminant transport in the strait and the estuary the model numerically solves the unsteady three dimensional equations of state mass and momentum conservation salinity and temperature transport with a turbulence closure scheme hamrick 1996 the input boundary conditions and the output parameters at the north and south boundaries of the strait are shown in table 1 the water density ρ is calculated internally at each grid point within the model grid the coordinate system is orthogonal in the horizontal and sigma zed transformed craig et al 2014 in the vertical smagorinsky sub grid scale turbulence modeling is used to calculate the turbulence shear stress using eddy viscosity the method employs turbulent kinetic energy tke and turbulence length scale tls a total sea surface of 62 1 km2 is modeled horizontally with 3878 rectangular cells of sizes varying from 50 to 200 m in both horizontal directions the model domain is vertically divided into 20 layers resulting in a three dimensional mesh of 77560 grid points in total the model bathymetry is interpolated to the nearest depth value to cover all the cells and any sharp changes on the bottom the maximum depth of the interpolated model bathymetry is 108 m whereas the deepest point across the junction is 39 m the north boundary is chosen at the black sea opening of the strait where the velocity salinity and temperature profiles are given from measurements and the sea level is to be determined by the model the south boundary is selected as an open head boundary with zero elevation and fixed salinity and temperature profiles taken from measurements and past model results the bathymetry is digitized from hydrography maps of the strait published by the office of navigation hydrography and oceanography of turkish naval forces command onho 1992a b the digitized model bathymetry is enriched especially along the thalweg with additional high resolution hydrographic data provided by özsoy 2015 2 2 test cases the test cases are selected from published literature including 14 experimental and 6 numerical data sets covering a large range of barotropic and baroclinic conditions the adcp ctd and tide gage measurements are provided by özsoy et al 1995 and 1996 altıok et al 2014 tudes 2019 overseeing a time span of 25 years from 1991 to 2015 the predominant hydrodynamic state throughout the strait is known as a two layer stratified flow 2lf however measurements show that under special conditions one or the other of the two layers may be blocked resulting in llb or ulb condition the llb occurs during strong north wind and large δh when the barotropic gradients due to sea level difference in the upper layer overcome the baroclinic gradients due to salinity and temperature differences in the lower layer the opposite behavior ulb is caused by strong south wind and negative or very small δh to cover such rare conditions test cases are enriched with six numerical model results by maderich and konstantinov 2002 sannino et al 2016 and sözer and özsoy 2017 together with the measured and modeled input conditions the test cases provided a wide range of input conditions covering all possible flow conditions at the junction the hydrodynamic model is run using measurements at the north and south boundaries based on the configuration shown in table 1 the model is calibrated and verified using the number of arbitrary measurements adjacent to thalweg throughout the strait measured and modeled profiles of temperature salinity and velocity at the deepest point of the strait are shown in fig 2 during a typical 2lf case the model can predict the stratification in good agreement with measurements in upper mid and lower layers the model is also tested and calibrated for measured ulb and llb conditions further details of hydrodynamic test runs for the 20 test cases are described in aslan 2016 efdc results using the same input conditions have shown good agreement with the literature in terms of vertical and horizontal profiles of flow velocities salinity and temperature aslan 2016 the test cases are categorized according to net flow rate q n and sea level difference δh to later define flow types which happen to control hydrodynamics at the junction as well 3 exchange flows at the golden horn junction results of all 20 test cases are carefully examined to identify both the predominant and the particular flow patterns at the junction ten out of 20 test cases exhibit predominant conditions 2lf where the surface water of the strait flows southward fig 3 shows a typical current profile under predominant conditions in the strait the velocity vectors are shown along a transect following the thalweg solid black line in fig 3a at the surface layer of the junction the less saline black sea water red in the web version curved arrow in fig 3b enters the estuary within the top 5 m of the water column as the surface flow reaches halfway inside the estuary its velocity decreases until it turns down and flows backward as a return current at the mid layer of 10 15 m depth the return flow exits the estuary through the junction fig 3b also indicates a second inflow of water entering the estuary at the junction in a very thin layer as a bottom flow at between 25 and 30 m of depth blue curved arrow this bottom layer current of heavier and saltier marmara sea water follows a mirror image pattern as the surface current again at the mid layer after forming a second vertical circulation loop the marmara sea water leaves the estuary as a result the exchange at the junction occurs at two different depths depending on the origin of the water under predominant conditions 2lf the less salty black sea water exchanges at the surface half whereas the heavier marmara sea water exchanges at the lower half of the estuary further examination of the less predominant test cases revealed four types of flow patterns at the junction fig 4 shows the exchange flow patterns for four identified flow types and three depth layers at the junction some of the test cases exhibit a net in or outflow at the junction whereas in other cases eddies are formed that partially or entirely block the water exchange due to the complex geometry of three dimensional current vectors the exchange behavior of different flow types at the junction is best described by velocity vectors shown on horizontal planes at the surface mid and bottom layers fig 4 in the sub figures of fig 4 the depth of the selected layer is not uniform instead it varies spatially within the estuary due to the sigma coordinate system therefore a specific point at the junction marked with a blue dot is selected where the depth of the layer is given in the legend of each sub figure in some flow types depending on the hydrodynamic conditions that govern the strait a horizontal eddy is formed at the surface and or other layers these eddies may block the water exchange at a layer or entirely at the junction sometimes the entire water column becomes an eddy which causes a total blockage of the estuary water currents in the estuary have a layered vertical structure certain flow types at the junction exhibit opposite current directions at different depths fig 4 further analysis of the interior of the estuary shows three dimensional circulation patterns with directional variations both in the horizontal and vertical planes the exchange flow at the junction has different patterns depending on the flow type the horizontal eddies at the junction play a crucial role in the water exchange between the strait and the estuary the turbulence intensity in the strait is a key parameter to describe the eddy formation at the junction flow characteristics at the junction are obtained from model results the test cases are categorized into four types in terms of the exchange flow characteristics at the junction the resulting four flow types depend on the hydrodynamic conditions in the strait including the stratification ulb 2lf and llb turbulence intensity reynolds number re and sea level difference δh between the north and south boundaries of the strait table 2 the surface flow reynolds number re is the ratio of inertia to viscous forces and calculated as ρ v l μ at the centerline of the strait surface water immediately north of the junction where ρ is the density 1015 kg m3 v is the velocity l is the channel width 1600 m and μ is the dynamic viscosity 0 00123 n s m2 using the numerical values of δh and re it was possible to uniquely define the exchange flow pattern at the estuary as they were categorized in four types table 2 fig 5 shows the 20 test cases on a graph of sea level difference δh versus junction reynolds number re the test cases are grouped according to flow type which are separated with dashed lines at critical values of δh and re as quantified in table 2 with more test cases these limits may become more accurate however even with these 20 the categorization seems quite consistent among the two controlling variables the sea level difference δh can be used as a single parameter to determine the flow type and consequently the water exchange at the junction type i during strong south wind black sea level at the north boundary of the strait levels with and sometimes drops below the marmara sea level at the south boundary when the sea level difference north minus south between the two boundaries drops below 5 cm δh 5 cm the upper layer flow is blocked ulb on the marmara boundary surface waters are driven north re 0 as the surface current passes by the junction a western branch turns westward and enters the estuary fig 4 type i surface a small counter clockwise ccw eddy forms off sarayburnu south eastern corner of the estuary however it does not entirely block the water exchange at the junction this scenario occurs only under very strong south and south westerly winds and is therefore not very common the water exchange can occur in all layers including surface mid and bottom layers of the junction the water enters the estuary in the surface and bottom layers and leaves in the mid layer similar to type ii as shown in fig 3 the validity range of this flow type can be seen in fig 5 type ii when the black sea boundary is slightly above the marmara sea 5 cm δh 30 cm the strait adapts its predominant two layer flow stratification 2lf the surface current in the strait flows southward with 0 re 1 5 109 fig 4 similar to type i water enters the estuary at the surface and leaves at the mid layer its only difference from type i is that the surface water entering the estuary in type ii comes from the black sea type ii is the predominant flow that usually occurs during calm and mild wind conditions the more saline marmara sea water in the bottom layer also penetrates to the estuary despite a small ccw eddy partially blocking the entrance type iii during moderate north wind δh reaches 30 to 70 20 cm black sea level is above the marmara sea level and re ranges from 1 5 to 2 0 109 in this flow type the lighter black sea water driven by moderate southerly surface current enters the estuary at the surface and leaves it at the mid layer a small clockwise cw eddy forms off karaköy north eastern corner of the estuary however it does not entirely block the water exchange at the junction the moderate north wind which generates this flow type is quite common in the strait especially in summer and autumn the validity range of this flow type is shown in fig 5 type iv it is the only flow type where there is no water exchange at any depth at the junction during very strong north wind the black sea level increases more than 70 20 cm above the marmara sea this type is very similar to type iii except for its three dimensional flow pattern under such extreme conditions the entire water column at the junction transforms into a cw eddy which blocks the water exchange between the strait and the estuary fig 4 type iv the transition between type iii and iv 50 cm δh 85 cm could not exactly be identified due to the lack of test cases in this range of extreme flow conditions fig 5 4 transport of contaminants into the golden horn an oil spill in the strait may or may not pose a threat to the estuary depending on the spill location relative to the junction and the type of exchange flow at the junction the transport and fate of contaminants are analyzed with efdc s hydrodynamic and contaminant transport solvers the output water velocities and sea levels computed with the hydrodynamic model are used as input in the contaminant transport model two specific locations are selected for the oil spill scenario analysis one in the north n spill and the other in the south s spill of the junction in all test cases contaminants are released at the surface layer the contaminant solver of the efdc employs two alternative methods a eulerian solver of the advection diffusion equation computes the contaminant concentrations in three dimensional space and time alternatively the lagrangian particle tracking lpt method is used to compute the distribution of contaminant particles throughout the three dimensional model domain in each time step for all 20 hydrodynamic test runs different initial spill locations are tested with both eulerian and lagrangian methods which revealed similar results in terms of contaminant transport the spill characteristics such as the release rate 4500 t h in n spills 16000 t h in s spills release duration 4 h contaminant density 940 kg m3 and diffusion coefficient 1 m2 s are linked to published data of two real oil spill accidents the n spill scenario is based on the 2002 gotia oil spill otay and yenigün 2003 where 18000 tons of fuel oil is released into the strait at approximately 13 km north of the junction the s spill scenario assumes discharge of 64 000 tons of fuel oil due to a tanker accident just south of the junction inspired by the 1979 independenta oil spill doğan and burak 2007 a total of 2000 particles are used to represent the lpt of oil in all models processes including beaching evaporation and settling due to buoyancy effects are neglected due to the rapid evolution of the oil spill and the relatively short model time the contaminant transport model is run on top of the hydrodynamic model where the output current velocities are used to solve the advection diffusion equations to compute the 3d contaminant concentrations the biodegradation rate is set to a default value of 0 001 day 1 weathering effects and beaching are not considered in the model the initial spill locations are selected according to the contamination risk they impose for the estuary due to variable surface flow directions in the strait the spill location is selected at both north and south of the junction there are 20 hydrodynamic conditions each combined with two spill locations make up a total of 40 scenarios to be tested with combinations of different flow types and spill locations theoretically there would be infinite number of possible scenarios with different spill locations which should be tested with an infinite number of hydrodynamic conditions such a study is beyond the present scope and would require a stochastic modeling effort as done by papadonikolaki et al 2014 three out of the four flow types are found to be critical as exhibit contaminant penetration to the estuary under certain spill locations these are summarized in table 3 depending on their flow type and the spill location figs 6 8 show the particle distribution at the time of initial penetration and the particle tracks within the 24th hour of the spill for types i ii and iii respectively type iv is the only flow condition where the estuary is not getting contaminated fig 9 the fate of contaminants at the junction is controlled by the transport patterns as was shown in fig 4 model results show that the contamination penetrates to the estuary always through the surface layer in type i fig 6 contaminants enter the estuary when the spill is south of the junction s spill in types ii and iii the oil particles are transported towards the junction by southerly surface currents after being released north of the junction figs 7 and 8 their common characteristics are that the main surface flow is southerly and the surface layer at the junction is not blocked by eddies in type iv contaminants cannot enter the estuary independent of spill location as the entire water column is blocked by eddies fig 9 here the lines represent particle tracks at different depths shown in different colors the majority of red colors in the web version indicate that most of the particles remain at the surface whereas green to blue colors in the web version show deeper tracks where oil has sunken into deeper layers mainly inside the estuary model results have shown that under certain conditions the estuary and consequently the northern shores of the historic peninsula of istanbul are under contamination risk some of the scenarios that are proven to be critical are very common in terms of hydrodynamic conditions all it needs is an oil spill accident to occur on the wrong side of the junction such as a n spill during southerly currents or a s spill during northerly currents 5 conclusion the transport and fate of contaminants in the strait and the estuary following oil spill accidents are examined through three dimensional numerical models since the accident locations and the hydrodynamic conditions that can jointly lead to the contamination of the estuary are likely to happen the historic peninsula and its large population are found to be under high risk the present work concentrates on the hydrodynamic mechanisms that control both the water exchange at the junction and the transport and fate of contaminants in the estuary the exchange flow between the strait and the estuary can be classified based on two simple parameters the sea level difference between the north and south boundaries of the strait δh and the surface reynolds number re north of the junction both δh and re can be easily measured on a regular basis hence they can be used to estimate the exchange flows at the junction complex current patterns including horizontal and vertical eddies distributed over the water column are identified at the junction and inside the estuary using three dimensional numerical models eddies are observed to control the fate of contaminants as they are transported across the junction and into the estuary four flow types are identified based on δh for type i δh is smaller than 5 cm for type ii δh is between 5 and 30 cm for type iii δh is between 30 and 70 cm and for type iv δh is greater than 70 cm under predominant conditions type ii surface water in the strait flows southward towards the junction and penetrates into the estuary similarly in type iii moderate surface current from the strait enters the estuary and leaves it in the mid layer this normally beneficial natural circulation turns out to be a potential pollution risk for the golden horn except for the total blockage in type iv which occurs during northerly storms all other conditions pose contamination risk for the estuary in case of an oil spill the present findings show how the size and the distribution of eddies control the exchange flows at the junction when eddies are formed at a specific layer they prevent the water from entering or exiting the estuary in that layer in general the results may help to understand the role of turbulent eddies at junctions of water bodies as a control for the transport and fate of contaminants in branching inlets and estuaries declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20757,the golden horn estuary is a hotspot for marine pollution because of its close proximity to the strait of istanbul strait with dense maritime traffic and high pollution risk of oil spill transport and fate of water and contaminants in strait and estuary are analyzed by three dimensional numerical models eddies forming at the golden horn junction junction either on a single layer or distributed over the entire water column block the water exchange partly or entirely across the junction in case of an oil spill in adjacent waters the size and distribution of eddies at junction control the transport and fate of contaminants inside estuary using twenty test cases the exchange flows at junction are classified in four types based on sea level difference between north and south boundaries of strait and reynolds number of surface flow eddies may prevent the natural water exchange between strait and estuary but also block the contaminants penetrating to estuary under predominant conditions of mild and moderate southward net flow in strait surface waters enter estuary during very strong southward flow junction is blocked to black sea water and surface contaminants strait hydrodynamics control water exchange with estuary through eddy formation when horizontal eddies are formed at junction their size and distribution control the transport and fate of contaminants in branching inlets and estuaries by blocking the water exchange either entirely or partly in specific layers keywords contaminant transport fate of contamination eddy currents estuarine hydrodynamics oil spill strait of istanbul golden horn 1 introduction with over 300 thousand movements of local and transit vessels per year the strait of istanbul the strait is a congested waterway with a significant risk for collision and grounding accidents altan and otay 2018 özlem et al 2020 strong water currents combined with a dangerous navigation channel impose a great risk to human health and the environment in case of an oil spill in the strait the transport of contaminants and consequently the fate of adjacent water bodies especially the golden horn the estuary are of great concern for public health and safety scientifically it is a problem of complex hydrodynamics and random occurrence of accidents in the strait on average 8700 tankers annually transit the strait carrying a total of 138 million tons of oil and other hazardous materials altan and otay 2017 in case of a tanker accident statistically over 15 000 tons of contaminant is expected to spill to the strait the golden horn junction the junction near the southern boundary of the strait fig 1 is a hot spot for marine accidents because of complex currents and denser local traffic around the ports concentrated near the city center yazıcı and otay both tanker accidents and bunker spills from non tanker vessels constitute a high risk of marine pollution at the junction the present work has been inspired by the expert witness reports and the emergency response plans for oil spills in the area otay and yenigün 2003 otay et al 2014 otay and aslan 2017 the estuary is a narrow estuary with three sides surrounded by the historic center of istanbul and only one side open to the strait the historic coastline the dense population and the rapidly decaying fish habitat make the estuary a sensitive water body to contamination the complex hydrodynamics and the random traffic patterns in the area make the risk analysis quite difficult the present work may help to understand the transport mechanisms in the strait and the estuary and identify when and how the contaminants in the strait may or may not pose a threat to the estuary the results showed that the flow at the junction is quite complex compared to the main flow in the strait at the junction the flow is three dimensional the net flow in and out of the estuary is controlled by the horizontal and vertical eddies at the junction in case of an oil spill the net water exchange may be blocked depending on if eddies are formed at the junction consequently contaminants cannot penetrate to the estuary depending on the flow conditions and the accident location relative to the junction a simple parametric relation is developed based on easily measurable quantities including the junction reynolds number re and the sea level difference between the two ends of the strait δh these parameters control the turbulent eddy formation and the exchange flow at the junction and consequently the contamination of the estuary in case of an oil spill the findings can be used in oil spill emergency response plans for coastal facilities in istanbul knowing the critical conditions that may lead to the contamination of the estuary experts can implement protection plans on a regional scale extending outside of the estuary to protect the historic peninsula these plans may help to control and remediate the marine pollution risk of the estuary due to spill accidents in the strait and the adjacent seas including the black sea and the marmara sea the hydrodynamics of the strait and numerical model results are discussed in section 2 the exchange flow at the junction is investigated in section 3 including flow patterns in vertical layers the flow at the junction is examined for the eddy formation and its effect on the exchange flow between the strait and the estuary after examining a large range of flow conditions in the surface mid and bottom layers four different flow types are identified at the junction these types are categorized in terms of two hydrodynamic parameters the head difference in the strait and the junction reynolds number which control the eddy formation and consequently the exchange flow at the junction transport of contaminants into the estuary due to spills in adjacent waters is discussed in section 4 various accident scenarios are analyzed north and south of the junction to model the transport and fate of contaminants in the estuary depending on the flow type in section 5 2 hydrodynamics of the strait of istanbul the strait is a complex hydrodynamic system connecting the less saline waters of the black sea with a slightly higher sea level in the north to the more saline marmara sea in the south the black sea may rise up to a meter above the marmara sea level the vertical stratification caused by the salinity difference of the two seas has first been reported by marsilii 1681 whose book on the strait is known as the pioneering work of modern oceanography the layered flow structure has first been identified by modern scientific studies of özsoy et al 1986 to occur in three different forms that depend on the hydrodynamic conditions these are the two layer flow 2lf upper layer blockage ulb and lower layer blockage llb the 2lf is the predominant state where the upper layer flow is forced mainly by the higher sea level on one side of the strait most of the time on the black sea side relative to the other boundary and the lower layer flow is a density current caused by the density difference between the waters of the black sea and the marmara sea under extreme storm conditions where the surface current from one of the boundary seas is extremely dominant the opposing current either in the upper layer or the lower layer may get blocked as a result water flows in a single layer known as ulb or llb which are the two exceptions of the predominant flow structure in the strait the net volume flux between the upper and lower layers q net vertical profiles of temperature and salinity at the two open boundaries and the sea level difference between the two ends of the strait δh determine the critical states oğuz et al 1990 özsoy et al 1995 1996 and altıok et al 2014 a comprehensive review of the experimental and numerical works can be found in ünlüata and oğuz 1983 a variety of mathematical models of the strait were developed starting with simple two dimensional analytical solutions sümer and bakioğ to complex large scale three dimensional numerical model results using supercomputers sannino et al 2017 sözer and özsoy 2017 the present study uses a hybrid method developed by aslan 2016 to examine the variability of possible flow conditions at the junction the flow of water and contaminants are resolved with a three dimensional multi phase turbulent flow computer model efdc solved on a personal computer for model results to realistically represent the actual conditions at the junction a large set of field measurements are used as input boundary conditions to the numerical model aslan 2016 the same test cases served to verify the output quality of the numerical model in comparison to measured values within the strait after establishing a reliable model of the strait and the estuary alternating flow conditions are created to test the critical three dimensional flow and transport conditions at the junction that control the contamination mechanism of the estuary 2 1 numerical model the environmental fluid dynamics code efdc is used for the simulation of the three dimensional hydrodynamics and contaminant transport in the strait and the estuary the model numerically solves the unsteady three dimensional equations of state mass and momentum conservation salinity and temperature transport with a turbulence closure scheme hamrick 1996 the input boundary conditions and the output parameters at the north and south boundaries of the strait are shown in table 1 the water density ρ is calculated internally at each grid point within the model grid the coordinate system is orthogonal in the horizontal and sigma zed transformed craig et al 2014 in the vertical smagorinsky sub grid scale turbulence modeling is used to calculate the turbulence shear stress using eddy viscosity the method employs turbulent kinetic energy tke and turbulence length scale tls a total sea surface of 62 1 km2 is modeled horizontally with 3878 rectangular cells of sizes varying from 50 to 200 m in both horizontal directions the model domain is vertically divided into 20 layers resulting in a three dimensional mesh of 77560 grid points in total the model bathymetry is interpolated to the nearest depth value to cover all the cells and any sharp changes on the bottom the maximum depth of the interpolated model bathymetry is 108 m whereas the deepest point across the junction is 39 m the north boundary is chosen at the black sea opening of the strait where the velocity salinity and temperature profiles are given from measurements and the sea level is to be determined by the model the south boundary is selected as an open head boundary with zero elevation and fixed salinity and temperature profiles taken from measurements and past model results the bathymetry is digitized from hydrography maps of the strait published by the office of navigation hydrography and oceanography of turkish naval forces command onho 1992a b the digitized model bathymetry is enriched especially along the thalweg with additional high resolution hydrographic data provided by özsoy 2015 2 2 test cases the test cases are selected from published literature including 14 experimental and 6 numerical data sets covering a large range of barotropic and baroclinic conditions the adcp ctd and tide gage measurements are provided by özsoy et al 1995 and 1996 altıok et al 2014 tudes 2019 overseeing a time span of 25 years from 1991 to 2015 the predominant hydrodynamic state throughout the strait is known as a two layer stratified flow 2lf however measurements show that under special conditions one or the other of the two layers may be blocked resulting in llb or ulb condition the llb occurs during strong north wind and large δh when the barotropic gradients due to sea level difference in the upper layer overcome the baroclinic gradients due to salinity and temperature differences in the lower layer the opposite behavior ulb is caused by strong south wind and negative or very small δh to cover such rare conditions test cases are enriched with six numerical model results by maderich and konstantinov 2002 sannino et al 2016 and sözer and özsoy 2017 together with the measured and modeled input conditions the test cases provided a wide range of input conditions covering all possible flow conditions at the junction the hydrodynamic model is run using measurements at the north and south boundaries based on the configuration shown in table 1 the model is calibrated and verified using the number of arbitrary measurements adjacent to thalweg throughout the strait measured and modeled profiles of temperature salinity and velocity at the deepest point of the strait are shown in fig 2 during a typical 2lf case the model can predict the stratification in good agreement with measurements in upper mid and lower layers the model is also tested and calibrated for measured ulb and llb conditions further details of hydrodynamic test runs for the 20 test cases are described in aslan 2016 efdc results using the same input conditions have shown good agreement with the literature in terms of vertical and horizontal profiles of flow velocities salinity and temperature aslan 2016 the test cases are categorized according to net flow rate q n and sea level difference δh to later define flow types which happen to control hydrodynamics at the junction as well 3 exchange flows at the golden horn junction results of all 20 test cases are carefully examined to identify both the predominant and the particular flow patterns at the junction ten out of 20 test cases exhibit predominant conditions 2lf where the surface water of the strait flows southward fig 3 shows a typical current profile under predominant conditions in the strait the velocity vectors are shown along a transect following the thalweg solid black line in fig 3a at the surface layer of the junction the less saline black sea water red in the web version curved arrow in fig 3b enters the estuary within the top 5 m of the water column as the surface flow reaches halfway inside the estuary its velocity decreases until it turns down and flows backward as a return current at the mid layer of 10 15 m depth the return flow exits the estuary through the junction fig 3b also indicates a second inflow of water entering the estuary at the junction in a very thin layer as a bottom flow at between 25 and 30 m of depth blue curved arrow this bottom layer current of heavier and saltier marmara sea water follows a mirror image pattern as the surface current again at the mid layer after forming a second vertical circulation loop the marmara sea water leaves the estuary as a result the exchange at the junction occurs at two different depths depending on the origin of the water under predominant conditions 2lf the less salty black sea water exchanges at the surface half whereas the heavier marmara sea water exchanges at the lower half of the estuary further examination of the less predominant test cases revealed four types of flow patterns at the junction fig 4 shows the exchange flow patterns for four identified flow types and three depth layers at the junction some of the test cases exhibit a net in or outflow at the junction whereas in other cases eddies are formed that partially or entirely block the water exchange due to the complex geometry of three dimensional current vectors the exchange behavior of different flow types at the junction is best described by velocity vectors shown on horizontal planes at the surface mid and bottom layers fig 4 in the sub figures of fig 4 the depth of the selected layer is not uniform instead it varies spatially within the estuary due to the sigma coordinate system therefore a specific point at the junction marked with a blue dot is selected where the depth of the layer is given in the legend of each sub figure in some flow types depending on the hydrodynamic conditions that govern the strait a horizontal eddy is formed at the surface and or other layers these eddies may block the water exchange at a layer or entirely at the junction sometimes the entire water column becomes an eddy which causes a total blockage of the estuary water currents in the estuary have a layered vertical structure certain flow types at the junction exhibit opposite current directions at different depths fig 4 further analysis of the interior of the estuary shows three dimensional circulation patterns with directional variations both in the horizontal and vertical planes the exchange flow at the junction has different patterns depending on the flow type the horizontal eddies at the junction play a crucial role in the water exchange between the strait and the estuary the turbulence intensity in the strait is a key parameter to describe the eddy formation at the junction flow characteristics at the junction are obtained from model results the test cases are categorized into four types in terms of the exchange flow characteristics at the junction the resulting four flow types depend on the hydrodynamic conditions in the strait including the stratification ulb 2lf and llb turbulence intensity reynolds number re and sea level difference δh between the north and south boundaries of the strait table 2 the surface flow reynolds number re is the ratio of inertia to viscous forces and calculated as ρ v l μ at the centerline of the strait surface water immediately north of the junction where ρ is the density 1015 kg m3 v is the velocity l is the channel width 1600 m and μ is the dynamic viscosity 0 00123 n s m2 using the numerical values of δh and re it was possible to uniquely define the exchange flow pattern at the estuary as they were categorized in four types table 2 fig 5 shows the 20 test cases on a graph of sea level difference δh versus junction reynolds number re the test cases are grouped according to flow type which are separated with dashed lines at critical values of δh and re as quantified in table 2 with more test cases these limits may become more accurate however even with these 20 the categorization seems quite consistent among the two controlling variables the sea level difference δh can be used as a single parameter to determine the flow type and consequently the water exchange at the junction type i during strong south wind black sea level at the north boundary of the strait levels with and sometimes drops below the marmara sea level at the south boundary when the sea level difference north minus south between the two boundaries drops below 5 cm δh 5 cm the upper layer flow is blocked ulb on the marmara boundary surface waters are driven north re 0 as the surface current passes by the junction a western branch turns westward and enters the estuary fig 4 type i surface a small counter clockwise ccw eddy forms off sarayburnu south eastern corner of the estuary however it does not entirely block the water exchange at the junction this scenario occurs only under very strong south and south westerly winds and is therefore not very common the water exchange can occur in all layers including surface mid and bottom layers of the junction the water enters the estuary in the surface and bottom layers and leaves in the mid layer similar to type ii as shown in fig 3 the validity range of this flow type can be seen in fig 5 type ii when the black sea boundary is slightly above the marmara sea 5 cm δh 30 cm the strait adapts its predominant two layer flow stratification 2lf the surface current in the strait flows southward with 0 re 1 5 109 fig 4 similar to type i water enters the estuary at the surface and leaves at the mid layer its only difference from type i is that the surface water entering the estuary in type ii comes from the black sea type ii is the predominant flow that usually occurs during calm and mild wind conditions the more saline marmara sea water in the bottom layer also penetrates to the estuary despite a small ccw eddy partially blocking the entrance type iii during moderate north wind δh reaches 30 to 70 20 cm black sea level is above the marmara sea level and re ranges from 1 5 to 2 0 109 in this flow type the lighter black sea water driven by moderate southerly surface current enters the estuary at the surface and leaves it at the mid layer a small clockwise cw eddy forms off karaköy north eastern corner of the estuary however it does not entirely block the water exchange at the junction the moderate north wind which generates this flow type is quite common in the strait especially in summer and autumn the validity range of this flow type is shown in fig 5 type iv it is the only flow type where there is no water exchange at any depth at the junction during very strong north wind the black sea level increases more than 70 20 cm above the marmara sea this type is very similar to type iii except for its three dimensional flow pattern under such extreme conditions the entire water column at the junction transforms into a cw eddy which blocks the water exchange between the strait and the estuary fig 4 type iv the transition between type iii and iv 50 cm δh 85 cm could not exactly be identified due to the lack of test cases in this range of extreme flow conditions fig 5 4 transport of contaminants into the golden horn an oil spill in the strait may or may not pose a threat to the estuary depending on the spill location relative to the junction and the type of exchange flow at the junction the transport and fate of contaminants are analyzed with efdc s hydrodynamic and contaminant transport solvers the output water velocities and sea levels computed with the hydrodynamic model are used as input in the contaminant transport model two specific locations are selected for the oil spill scenario analysis one in the north n spill and the other in the south s spill of the junction in all test cases contaminants are released at the surface layer the contaminant solver of the efdc employs two alternative methods a eulerian solver of the advection diffusion equation computes the contaminant concentrations in three dimensional space and time alternatively the lagrangian particle tracking lpt method is used to compute the distribution of contaminant particles throughout the three dimensional model domain in each time step for all 20 hydrodynamic test runs different initial spill locations are tested with both eulerian and lagrangian methods which revealed similar results in terms of contaminant transport the spill characteristics such as the release rate 4500 t h in n spills 16000 t h in s spills release duration 4 h contaminant density 940 kg m3 and diffusion coefficient 1 m2 s are linked to published data of two real oil spill accidents the n spill scenario is based on the 2002 gotia oil spill otay and yenigün 2003 where 18000 tons of fuel oil is released into the strait at approximately 13 km north of the junction the s spill scenario assumes discharge of 64 000 tons of fuel oil due to a tanker accident just south of the junction inspired by the 1979 independenta oil spill doğan and burak 2007 a total of 2000 particles are used to represent the lpt of oil in all models processes including beaching evaporation and settling due to buoyancy effects are neglected due to the rapid evolution of the oil spill and the relatively short model time the contaminant transport model is run on top of the hydrodynamic model where the output current velocities are used to solve the advection diffusion equations to compute the 3d contaminant concentrations the biodegradation rate is set to a default value of 0 001 day 1 weathering effects and beaching are not considered in the model the initial spill locations are selected according to the contamination risk they impose for the estuary due to variable surface flow directions in the strait the spill location is selected at both north and south of the junction there are 20 hydrodynamic conditions each combined with two spill locations make up a total of 40 scenarios to be tested with combinations of different flow types and spill locations theoretically there would be infinite number of possible scenarios with different spill locations which should be tested with an infinite number of hydrodynamic conditions such a study is beyond the present scope and would require a stochastic modeling effort as done by papadonikolaki et al 2014 three out of the four flow types are found to be critical as exhibit contaminant penetration to the estuary under certain spill locations these are summarized in table 3 depending on their flow type and the spill location figs 6 8 show the particle distribution at the time of initial penetration and the particle tracks within the 24th hour of the spill for types i ii and iii respectively type iv is the only flow condition where the estuary is not getting contaminated fig 9 the fate of contaminants at the junction is controlled by the transport patterns as was shown in fig 4 model results show that the contamination penetrates to the estuary always through the surface layer in type i fig 6 contaminants enter the estuary when the spill is south of the junction s spill in types ii and iii the oil particles are transported towards the junction by southerly surface currents after being released north of the junction figs 7 and 8 their common characteristics are that the main surface flow is southerly and the surface layer at the junction is not blocked by eddies in type iv contaminants cannot enter the estuary independent of spill location as the entire water column is blocked by eddies fig 9 here the lines represent particle tracks at different depths shown in different colors the majority of red colors in the web version indicate that most of the particles remain at the surface whereas green to blue colors in the web version show deeper tracks where oil has sunken into deeper layers mainly inside the estuary model results have shown that under certain conditions the estuary and consequently the northern shores of the historic peninsula of istanbul are under contamination risk some of the scenarios that are proven to be critical are very common in terms of hydrodynamic conditions all it needs is an oil spill accident to occur on the wrong side of the junction such as a n spill during southerly currents or a s spill during northerly currents 5 conclusion the transport and fate of contaminants in the strait and the estuary following oil spill accidents are examined through three dimensional numerical models since the accident locations and the hydrodynamic conditions that can jointly lead to the contamination of the estuary are likely to happen the historic peninsula and its large population are found to be under high risk the present work concentrates on the hydrodynamic mechanisms that control both the water exchange at the junction and the transport and fate of contaminants in the estuary the exchange flow between the strait and the estuary can be classified based on two simple parameters the sea level difference between the north and south boundaries of the strait δh and the surface reynolds number re north of the junction both δh and re can be easily measured on a regular basis hence they can be used to estimate the exchange flows at the junction complex current patterns including horizontal and vertical eddies distributed over the water column are identified at the junction and inside the estuary using three dimensional numerical models eddies are observed to control the fate of contaminants as they are transported across the junction and into the estuary four flow types are identified based on δh for type i δh is smaller than 5 cm for type ii δh is between 5 and 30 cm for type iii δh is between 30 and 70 cm and for type iv δh is greater than 70 cm under predominant conditions type ii surface water in the strait flows southward towards the junction and penetrates into the estuary similarly in type iii moderate surface current from the strait enters the estuary and leaves it in the mid layer this normally beneficial natural circulation turns out to be a potential pollution risk for the golden horn except for the total blockage in type iv which occurs during northerly storms all other conditions pose contamination risk for the estuary in case of an oil spill the present findings show how the size and the distribution of eddies control the exchange flows at the junction when eddies are formed at a specific layer they prevent the water from entering or exiting the estuary in that layer in general the results may help to understand the role of turbulent eddies at junctions of water bodies as a control for the transport and fate of contaminants in branching inlets and estuaries declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20758,this paper describes the computation of parameters for a lagrangian mechanical system model of a submerged vessel moving near an otherwise calm free surface using a medium fidelity potential flow code the software uses the boundary element method to solve for the flow potential on the body and the free surface the model a system of integro differential equations involving functions of the velocity potential is the maneuvering component of a lagrangian nonlinear maneuvering and seakeeping model that was introduced in earlier work here this nonlinear maneuvering model is reformulated and the potential flow software is modified to support parameter computations parameters are computed for a prolate spheroid moving parallel to a calm free surface at a constant forward speed this motion induces a steady flow with respect to the body which results in a steady surge force heave force and pitch moment these longitudinal forces and moment are computed using the reformulated lagrangian nonlinear maneuvering model and the results are compared with basic panel code solutions for various depths and froude numbers and for various computational parameter values keywords underwater vehicle dynamics hydrodynamic parameters lagrangian mechanics free surface 1 introduction a nonlinear lagrangian mechanical system model for a submerged vehicle moving near an otherwise calm free surface was developed by battista et al battista et al 2020 and was extended to incorporate ambient wave effects battista 2018 traditional modeling of ocean vessels involves either maneuvering theory or seakeeping theory bailey et al 1998 combined the two approaches to consider maneuvering in a seaway under the assumption of small perturbations fossen 2005 later unified maneuvering and seakeeping models for the purpose of control design an advantage of battista s lagrangian mechanical system model is that it captures nonlinear hydrodynamic forces and moments predicted by potential flow theory that may be generated during aggressive maneuvers near the free surface although the modeling method only captures potential flow effects the underlying structure of the lagrangian mechanical system model allows one to apply energy based nonlinear control design and stability analysis methods that can provide a basis for improving performance and expanding the operating envelope in a real fluid example applications of these control methods to underwater vehicles include cross track control using potential shaping woolsey and techy 2009 passivity based speed and attitude tracking control valentinis et al 2015 and depth and heading regulation battista et al 2017 before one may develop an energy based nonlinear controller for a submerged vessel maneuvering in waves though the model parameters must be computed for the given body geometry this process begins with the assumption of a calm free surface parameters of a structured model for vessel motion are typically derived by performing parameter estimation using experimental data high fidelity computational fluid dynamics cfd data or both analytical solutions for hydrodynamic forces on simple geometries such as a spheroid chatjigeorgiou and miloh 2014 or ellipsoid miloh 1979 can be used to approximate model parameters for vessels with similar geometry but with limited fidelity experimental data is typically obtained through captive model experiments such as planar motion mechanism pmm tests gertler 1967 by performing pmm tests one may obtain parameters for widely used motion models such as the abkowitz model beck et al 1989 inconsistencies due to scaling effects suggest the use of additional data obtained experimentally from full scale ship maneuvering trials abkowitz 1980 alternatively pmm tests jung et al 2017 pan et al 2012 or free running tests yiew et al 2019 can be simulated using cfd to derive hydrodynamic coefficients for vessel motion models in some cases both experimental data and cfd data are used araki et al 2012 current trends in marine vessel model identification include extensions of traditional model based filtering regression approaches such as abkowitz 1980 fossen et al 1996 and more recent data driven approaches moreno salinas et al 2015 wang et al 2019 in addition the latest in cfd based parameter estimation employs high fidelity cfd simulations that include the propulsor and all appendages carrica et al 2019 although these data driven methods can produce very accurate models they can be costly and time consuming and usually have poor extrapolation capabilities the basic axiom of model based control design is that including knowledge about a system s physics can improve a controller s performance because model based control design methods presume specific model structures however the first challenge is to determine how much physics can actually be included the lagrangian mechanical system model considered here is a potential flow model as such it omits the important effects of viscous flow the model might be amended to account for these effects to some extent but it is the role of feedback control to mitigate the disturbance that results from unmodeled effects here we consider scenarios in which nonlinear effects captured imperfectly by the lagrangian mechanical system model are more valuable to the control design process than local effects captured by high fidelity linearized models the parameter computation method by use of a panel code developed here is ideally suited to the task of identifying the lagrangian mechanical system model it is less expensive than cfd simulations because panel methods assume potential flow and also because only the surfaces of the body and free surface are discretized with panels while high fidelity cfd discretizes the entire volumetric domain molland 2008 although panel methods produce results that omit important physics due to the potential flow assumption this same assumption is made for the maneuvering model whose parameters are being computed ensuring that parameter computations are not contaminated with unmodeled effects such as those due to viscosity this work presents methods for reformulating the nonlinear motion model and directly computing the model parameters the reformulation process circumvents the need for additional numerical discretization thus increasing accuracy and decreasing computational cost the parameters of the reformulated model expressed as integro differential functions of the velocity potential can then be obtained by direct computation in contrast to parameter estimation methods using experimental or cfd data each model parameter can be directly computed knowledge of a specific model component or of how that component was computed can provide helpful insight about that component s role in the physics to illustrate the parameter computation process and to make comparisons to direct computations for a specific body in a steady flow the paper is organized as follows section 2 provides some brief remarks on model based control and estimation as context for the paper s contribution section 3 summarizes the derivation of the lagrangian mechanics based nonlinear motion model for a submerged vessel maneuvering near a calm free surface battista 2018 section 4 proposes a reformulation that allows the efficient use of a potential flow code to compute model parameters section 5 introduces the medium fidelity potential flow code used in this work and describes code modifications that are needed to compute parameters in section 6 the proposed reformulation is verified by comparing the reformulated hydrodynamic force model with forces computed directly for a prolate spheroid moving steadily in surge beneath a calm free surface finally section 7 reviews the results of this study and describes future work and applications 2 remarks on model based control and estimation although the development of a model based control strategy is beyond the scope of this paper it is important to discuss the context for the hydrodynamic modeling effort and the simplifying assumption of potential flow control theory is generally concerned with systems described by the ordinary differential equations 1 x f x u t where x t is the state vector describing a vehicle s position and velocity for example and u t is a user defined input khalil 2002 one may also incorporate disturbance inputs d t into the vector field f additional equations can be included to account for measurements y t if the full state is not available for feedback control the feedback control design problem involves constructing a state feedback control law u x t or perhaps an output feedback control law u y t for which the state of the true system converges to some desired time history x d t no control design method exists that can address the general class of systems 1 but there are well developed methods for subclasses of these systems most notably linear systems rugh 1996 2 x a t x b t u typically a system model 2 is obtained from a nonlinear model 1 by linearizing about some known motion of interest such as a steady motion in this case the state and input vectors for system 1 are vectors of perturbation variables which must remain small for the model to remain valid provided that is true the time varying matrices a t and b t can be used to develop effective state feedback control laws dorato et al 1995 because typical seakeeping models assume constant speed and course the small perturbation restriction means that a maneuvering control law based on a linearized model for motion in waves is restricted to slow maneuvers instead given a nonlinear motion model 1 one might consider a variety of nonlinear control design methods such as feedback linearization khalil 2002 also known as dynamic inversion sliding mode control slotine and li 1991 or adaptive control krstic et al 1995 all control design methods impose some requirements on 1 but the fact that a submerged vessel is a mechanical system introduces some important and useful structure as an over simplified example consider a conventional time invariant lagrangian mechanical system i e one for which a generalized coordinate variable q i is associated to each of n degrees of freedom for simplicity we assume an input force u i can be chosen to affect each of these degrees of freedom independently given the energy like lagrangian function l q q the system motion is described by the euler lagrange equations d d t l q l q u m q q c q q q g q u where q and u are the vectors of configuration and input variables respectively m q is the generalized inertia matrix c q q is the associated coriolis and centripetal matrix and g q is the generalized force due to potential energy one approach to control design see for example woolsey et al 2004 and the references contained there is to choose state feedback u q q so that the closed loop system is still lagrangian but with respect to a new control modified lagrangian function l c q q the control modified energy and any associated conservation laws can be used to study stability and to develop strategies for dealing with unmodeled effects such as dissipative forces and moments examples for deeply submerged vessels are discussed in woolsey and techy 2009 valentinis et al 2015 though in the context of hamiltonian models rather than lagrangian models designing energy based control laws is beyond the scope of this paper we instead describe a method to compute parameter values for a control oriented motion model a necessary precursor to the development of model based nonlinear control and estimation strategies 3 lagrangian mechanical system model a first principles nonlinear motion model based on potential flow theory for a submerged vehicle maneuvering near a calm free surface has been developed using lagrangian mechanics modeling techniques battista et al 2020 battista 2018 the reference frames and notation used by battista et al are shown in fig 1 the earth fixed reference frame is located at a point o on the undisturbed free surface s 0 the z axis points down in the direction of gravity the origin o of the body fixed reference frame is fixed at some point in the body b for simplicity we place o at the geometric center and we assume the vessel is neutrally buoyant with uniformly distributed mass it is straight forward to relax these assumptions see battista 2018 for example but doing so unnecessarily complicates the discussion of hydrodynamic effects the generalized coordinates q x b t θ b t t describe the configuration of the body where the vector x b denotes the position of o in the earth fixed frame and θ b represents the roll pitch and yaw euler angles the 6 dimensional vector ν v t ω t t is composed of the translational velocity v and rotational velocity ω of the body fixed frame with respect to the earth fixed frame both expressed in the body fixed frame the velocity potential is decomposed into the following time and vehicle state dependent potential functions to represent the corresponding fluid motion by combining approaches by kirchhoff lamb 1932 and cummins 1962 3 φ q ν t φ k ν φ s q ν φ m q ν t ϕ k ϕ s q ν impulsive flow potential φ m q ν t memory flow potential kirchhoff s potential φ k and the free surface potential φ s compose the impulsive flow potential the sum of the vectors ϕ k and ϕ s represents the normalized potential for impulsive flow in cummins equations the state and time dependent memory flow potential accounts for memory effects the lagrangian for the complete fluid and rigid body system contains matrices that are integrals of functions of the velocity potential 4 l q ν t 1 2 ν t m b m b δ m b m s 0 ν ν t 0 t k b k s 0 ν τ d τ the subscripts b and s 0 denote surface integration over the body and undisturbed free surfaces respectively the matrix m b is the body inertia matrix m b is the deeply submerged added mass matrix δ m b accounts for the asymmetry in the fluid volume due to the free surface boundary m s 0 accounts for the instantaneous deformation of the bounding surface and the integral term accounts for memory effects among these terms the matrices with the b or s 0 subscripts are expressed with components of the total velocity potential for instance m b ρ b ϕ k b d s where b n t r n t t is composed of the unit normal vector n and the position vector r from the origin of the body fixed frame to the point at which the normal vector n is defined finally the boltzmann hamel equations 5 d d t l ν g ν l ν j q t l q j q t q are used to derive a set of nonlinear equations from the system lagrangian here g and j are transformation matrices see appendix a that appear due to the use of quasivelocities ν and q is the generalized force the resulting set of equations 6 represent the motion of a vehicle maneuvering near a calm free surface 6 f m b m i m m ν c b c i c m ν d i d m ν 0 t k m ν τ d τ the matrices with the subscript i and m contain the impulsive and memory flow related terms respectively the matrix m i for example is a combination of the mass matrices in 4 and their derivatives m i m b m b δ m b m s 0 i 1 6 e i ν t m s 0 ν i m s 0 ν i ν e i t 1 2 i 1 6 j 1 6 e i ν t 2 m s 0 ν i ν j ν e j t where e i is a unit vector with a 1 in the i th position a complete description of the lagrangian mechanics model can be found in battista et al 2020 battista 2018 4 reformulation of model in this section the model for a submerged vehicle maneuvering near a calm free surface shown in equation 6 is reformulated for parameter computation using data from a potential flow code the reformulation process avoids additional numerical discretization that would otherwise be necessary to approximate the derivatives that appear in the boltzmann hamel equation 5 in the reformulation process differentiation under the integral sign is applied in order to interchange the order of differentiation and integration subsequently the partial derivatives of the integrand with respect to ν and q are derived by a direct method and by an equivalent operation respectively the parameters of the resulting reformulated model can be computed using data from a modified potential flow code 4 1 differentiation under the integral sign this subsection explains how the differentials in the boltzmann hamel equations 5 namely ν q and d d t are interchanged with the volume integral over the fluid volume f the divergence theorem see appendix b is then applied to the volume integral to yield the surface integrals over b and s 0 that appear in the lagrangian l 4 1 1 derivatives with respect to ν since the limits of the volume integral over the fluid volume f do not depend on ν the order of ν with the integral over f can simply be interchanged therefore 7 ν f f d v f f ν d v for an arbitrary scalar function f 4 1 2 derivatives with respect to q the boltzmann hamel equations 5 are used to derive equations of motion that accommodate the set of quasivelocities ν that are expressed in the body fixed frame however the set of generalized coordinates q which also appears in the same equation is composed of the body position x b and euler angles θ b neither of which is expressed in the body fixed frame by defining a set of quasicoordinates schaub and junkins 2009 expressed in the body fixed frame denoted q x b t θ b t t and satisfying ν d d t q the relation between q and q can be used to re express differentiation with respect to q under the integral sign from the definition of the kinematic transformation matrix j battista 2018 q j θ b ν or for each component i 1 2 6 8 d q i d t j 1 6 j i j d q j d t the lagrangian can be expressed as l q ν t a function of quasicoordinates taking l q ν t l q ν t we find greenwood 2003 l q j i 1 6 l q i q i q j using equation 8 l q j i 1 6 j i j l q i or 9 l q j t l q the boltzmann hamel equation 5 can now be written as 10 d d t l ν g ν l ν l q j q t q the focus now is on how q can be interchanged with a surface integral over the body b where the limits of the integral depend on the configuration of the body q the translational component of q is examined first referring to fig 2 suppose the body b undergoes a small translational displacement δ x b for an element δ s of the surface of b the points x of δ s sweep out a volume δ v δ x b n δ s where n is a unit vector normal to δ s if we multiply the above volume by a function f and sum the products over the entire surface b we obtain δ i b f δ x b n δ s now if we consider displacement along only the x axis δ i b f δ x b cos n e x δ s here e x is a unit vector along the x axis and cos n e x is the cosine of the angle between vectors n and e x dividing both sides by δ x b and passing to the limit δ x b 0 yields i x b b f cos n e x d s we can perform the same derivation for displacement along the y and z axes to conclude i x b b f n d s this is the term that should be added when taking the derivative of the volume integration over the fluid domain while the body surface is undergoing translational displacement 11 x b f f x b t d v f f x b t x b d v b f x b t n d s the boundaries of the fluid volume f include the body surface b and the free surface which is approximated by the undisturbed free surface s 0 the limits of the integral over s 0 are independent of the configuration of the body q so there are no additional terms that involve the integral over s 0 a similar approach can be taken for the rotational component of q see appendix c and the resulting differentiation under the integral sign is 12 θ b f f θ b t d v f f θ b t θ b d v b f θ b t r n d s 4 1 3 derivatives with respect to t if the limits of the integral over the fluid domain surface s do not depend on t the order of the derivative and the integral can simply be interchanged as shown below 13 d d t s f d s s f t d s where f is an arbitrary scalar function on the other hand if the limits of the integral are t dependent leibniz theorem can be applied for the differentiation under the integral sign cengel and cimbala 2006 4 2 partial derivatives of the integrand 4 2 1 computation of φ ν the total velocity potential is decomposed into an impulsive flow component and a memory flow component in equation 3 and the same equation can be rewritten in an alternative form 14 φ ϕ i q ν 0 t ϕ m q τ t τ ν τ d τ where ϕ i ϕ k ϕ s is the normalized potential vector for impulsive flow in equation 14 we can see that the memory component is independent of ν t so the partial derivative of the integral term with respect to ν t is zero therefore 15 φ ν ϕ i 4 2 2 computation of φ q the relative displacement the set of quasicoordinates q is composed of the vectors x b and θ b a small increment in x b is a small translational displacement δ x b of the body b that can as shown in fig 3 be equivalently represented by a translational displacement δ x of the fluid domain while the body remains fixed the equivalent displacement of the fluid domain is indicated by the displacement of an arbitrary fluid particle p and of the undisturbed free surface s 0 4 2 2 1 relative displacement of a fluid particle considering a relative displacement of a fluid particle as shown in fig 3 we find that 16 φ x b x b lim δ x b 0 φ x b δ x b φ x b δ x b lim δ x 0 φ x δ x φ x δ x lim δ x 0 φ x φ x δ x δ x φ x x φ x an analogous identity can be derived for rotational displacement as shown in appendix d φ θ b r φ x 4 2 2 2 relative displacement of the undisturbed free surface applying the relative displacement of the undisturbed free surface s 0 affects the differentiation with respect to q under the integral sign described in section 4 1 in equations 11 and 12 the integral over b is replaced with an integral over s 0 since the undisturbed free surface s 0 is now relatively displaced while holding the body b fixed for translational displacement instead of the body b being displaced by δ x b with a fixed undisturbed free surface boundary s 0 an equivalent relative displacement of the undisturbed free surface s 0 in the opposite direction δ x can be applied while the body b is fixed substituting δ x b with δ x an element δ s of the undisturbed free surface s 0 sweeps out a region of space whose volume is δ v δ x n δ s going through the same process as in section 4 1 2 yields 17 x b f f x b t d v f f x b t x b d v s 0 f x t n d s a similar approach can be taken for the rotational component of q see appendix e the resulting equivalent expression is 18 θ b f f θ b t d v f f θ b t θ b d v s 0 f θ b t r n d s it is important to note that both the relative displacement of the fluid section 4 2 2a and the relative displacement of the undisturbed free surface section 4 2 2b must be applied simultaneously to the mathematical model the alternative formulations described in sections 4 1 and 4 2 simplify the numerical computation of parameter values as discussed in the context of a numerical example explored in section 6 4 3 resulting reformulated model the methods proposed in sections 4 1 and 4 2 can be applied to the motion model derived by battista 2018 to obtain a reformulated lagrangian mechanics based model for which the parameters can be more readily computed using a potential flow code the hydrodynamic force model is derived using the undecomposed total velocity potential φ q ν t for a body moving near a free surface the fluid lagrangian is 19 l f t f v f 20 f 1 2 ρ φ φ d v f ρ g z d v where t f and v f are the kinetic and potential energies of the fluid domain having assumed neutral buoyancy and uniform mass distribution and adopting a linearized free surface boundary condition the potential energy term can be neglected and the fluid lagrangian simply becomes 21 l f f 1 2 ρ φ φ d v the terms in the boltzmann hamel equation 10 can be derived as follows by applying the methods proposed in equations 7 17 and 18 along with the divergence theorem appendix b to the fluid lagrangian in equation 21 22 l f ν ρ b φ b d s ρ s 0 φ ϕ i n d s 23 l f q ρ s 0 φ φ n d s 1 2 ρ s 0 φ φ b d s where r equations 22 and 23 can be applied to equation 10 to derive the resulting hydrodynamic force model 24 f h ρ d d t b φ b d s ρ d d t s 0 φ ϕ i n d s ρ g b φ b d s ρ g s 0 φ ϕ i n d s ρ s 0 φ φ n d s 1 2 ρ s 0 φ φ b d s here f h is the vector of hydrodynamic forces and moments on the surface affected body note that the complete reformulated model for a submerged vehicle maneuvering near a calm free surface can be derived from the above hydrodynamic force model 24 to that end the total velocity potential must be decomposed into the components in equation 3 also the neutral buoyancy and homogeneous mass distribution assumptions may be relaxed by including the potential energy term in the fluid lagrangian in equation 20 5 time domain seakeeping code the time domain nonlinear seakeeping code aegir is used to compute the terms in the hydrodynamic force model 24 aegir is a medium fidelity potential flow code that uses a boundary element method to compute steady and unsteady wave patterns forces and motions of vehicles operating at or near a free surface navatek 2018 the typical output data of an unmodified seakeeping code includes the velocity potential fluid velocity pressure surface elevation and other related quantities for the given simulation conditions within the fluid volume fig 4 shows a visualization of surface elevation data output by aegir in order to compute the parameters in equation 24 the code must be modified to provide some terms that are not typically needed namely ϕ i n and φ n each element of the normalized potential vector ϕ i q for impulsive flow can be obtained by deriving the solution for impulsive motion about each coordinate axis for example if unit velocity in surge is prescribed on a body while imposing the condition for impulsive motion φ i 0 at the undisturbed free surface s 0 the resulting velocity potential for the impulsive flow will be equal to the first element of the normalized potential vector ϕ i for impulsive flow as for φ n the values needed to calculate the term can be readily obtained from the panel code spatial discretization in aegir employs a bi quadratic normal b spline representation and therefore the first and second derivatives of the function can be obtained directly without implementing any additional finite difference methods kring 1994 as a result once ϕ i and φ n are obtained the parameters in equation 24 can be computed by integrating a combination of these values over the body and free surfaces 6 comparison with direct numerical computations the hydrodynamic force model 24 is compared with simulation data obtained from the seakeeping code in section 5 first the validity of the methods proposed in sections 4 1 and 4 2 is confirmed by examining the computation of two terms in the hydrodynamic force model next the forces and moment on a slender axisymmetric body in longitudinal motion near a free surface in steady flow are computed using the model and the results are compared to simulation data 6 1 confirmation of proposed methods the two terms on the right hand side of 23 obtained by applying the methods proposed in sections 4 1 and 4 2 correspond to the last two terms in the hydrodynamic force model 24 if we assume that the body fixed frame is aligned with the earth fixed frame the translational components of these terms for impulsive motion are 25 l f x b ρ s 0 φ i φ i n d s 1 2 ρ s 0 φ i φ i n d s 1 2 ρ s 0 φ i φ i n d s since φ i the impulsive flow component of the total velocity potential is equal to zero at the undisturbed free surface s 0 cummins 1962 weinblum 1952 if we first consider the elements x b and y b of the body position vector x b equation 25 becomes 26 l f x b 1 2 ρ s 0 φ i φ i n x d s 0 and 27 l f y b 1 2 ρ s 0 φ i φ i n y d s 0 since n x n y 0 at the undisturbed free surface s 0 the validity of equations 26 and 27 can be confirmed by approximating the left hand side of equation 25 using the divergence theorem and the finite difference method as shown below 28 l f x b 1 2 ρ x b f φ i φ i d v 1 2 ρ x b b s 0 φ i φ i n d s 1 2 ρ x b b φ i φ i n d s 1 2 ρ δ b φ i φ i n d s δ x b now the value of l f x b evaluated at a certain body position x b can be computed using equation 25 and compared to the finite difference method calculation in equation 28 which uses output data at the same position x b as well as output data at position x b δ x b the left hand side of equations 26 and 27 can be approximated by applying the finite difference method in equation 28 29 l f x b 1 2 ρ δ b φ i φ i n d s δ x b 0 and 30 l f y b 1 2 ρ δ b φ i φ i n d s δ y b 0 since φ i does not depend on x b or y b for a submerged body in motion near an otherwise calm free surface therefore the calculations from the proposed method shown in equations 26 and 27 and the finite difference method shown in equations 29 and 30 are equal for elements x b and y b for the remaining element z b which denotes the depth of the body equations 25 and 28 can be rewritten a follows 31 l f z b 1 2 ρ s 0 φ i φ i n z d s 32 l f z b 1 2 ρ δ b φ i φ i n d s δ z b these equations are computed numerically for comparison by solving the impulsive flow for a 6 1 prolate spheroid in the conditions shown in table 1 using the modified seakeeping code in section 5 as shown in fig 5 the distances to the upstream downstream and exterior edges determine the portion of the free surface that contributes to the computations in order to simulate impulsive motion the boundary condition φ i 0 is imposed at the undisturbed free surface s 0 the term 31 is computed using flow solutions at depth to body length ratios of 0 15 and 0 30 values obtained using the finite difference method in equation 32 on the other hand are computed using flow solutions at depth to body length ratios of 0 15 and 0 30 and at the slightly larger ratios of 0 1505 and 0 3005 the resulting computations for equations 31 and 32 at depth to body length ratios of 0 15 and 0 30 are shown in table 2 overall computations of l f z b using the proposed method 31 agree well with the results from the finite difference method 32 more accurate results can be obtained by reducing the panel area a and the increment in depth δ z b these calculations illustrate the validity of the alternative formulation presented in sections 4 1 and 4 2 for computing partial derivatives of the fluid lagrangian with respect to translational configuration variables for a body undergoing impulsive motion the main advantage in employing this alternative formulation is to increase efficiency when computing the parameters of the lagrangian mechanical system model described in battista et al 2020 battista 2018 6 2 comparison with direct computations for model in steady flow when a body is in steady translational motion parallel to the free surface the flow around the body reaches a steady state and as a consequence constant forces and moments act on the body these forces and moments can be derived from equation 24 where φ is now constant the seakeeping code in section 5 simulates a body in steady translational motion parallel to the free surface by moving the body b and undisturbed free surface s 0 simultaneously relative to the earth fixed frame therefore the coordinates of a point on b and s 0 are constant in the body fixed frame as a result the order of the derivative and the integral in the first row of equation 24 can simply be interchanged by applying equation 13 in addition for steady surge motion the terms v and g simplify as follows v u 0 0 g 0 0 v ˆ 0 the following expression for surge force acting on the body due to steady translational motion parallel to the free surface can now be derived from the hydrodynamic force model 24 33 x ρ s 0 φ 2 φ x n d s 1 2 ρ s 0 φ φ n x d s the expression for heave force is 34 z ρ s 0 φ 2 φ n 2 d s 1 2 ρ s 0 φ φ n z d s finally the expression for pitch moment is 35 m ρ b φ u n z d s ρ s 0 φ r z 2 φ x n r x 2 φ n 2 d s 1 2 ρ s 0 φ φ r z n x r x n z d s although obtaining the steady surge and heave force expressions from equation 24 is straightforward deriving the pitch moment equation requires more caution details concerning the derivation of the steady pitch moment are given in appendix f hydrodynamic force equations 33 35 can be expressed in the parametric model form in equation 6 by simply substituting the total velocity potential φ with the decomposed form in equation 3 for example the first term in 33 can be rewritten in parametric form as 36 ρ s 0 φ 2 φ x n d s ρ s 0 ϕ k ϕ s ν φ m 2 ϕ k ϕ s ν φ m x n d s ρ s 0 φ m 2 ϕ k t x n d s ρ s 0 φ m 2 ϕ s t x n d s ① ν ρ s 0 φ m 2 φ m x n d s ② since ϕ k ϕ s ν φ i 0 at the undisturbed free surface s 0 cummins 1962 weinblum 1952 here ① is one of the terms that are summed up to form a row vector that corresponds to the first row of d m and ② is one of the terms that are summed up to form a component that corresponds to the first element of 0 t k m ν τ d τ in the parametric model in 6 parameters such as those in equation 36 are computed using the modified seakeeping code in section 5 by the method described there in order to compare results derived from the hydrodynamic force equations 33 35 for brevity these hydrodynamic forces are expressed in a simple form using the total velocity potential in this section the constant force and moment components on a 6 1 prolate spheroid in steady motion along its longitudinal axis parallel to the free surface are derived by computing equations 33 35 the effects of panel and free surface size on the force and moment computations are examined and in addition force and moment computations at various speeds and depths are compared to panel code output values varying the dimensions of the panels over the body surface and the undisturbed free surface affects accuracy of the flow solution however when computing forces using equations 33 35 which are mostly the evaluation of integrals over the free surface only changes in panel dimensions on the free surface have significant effect changes in panel dimensions on the body have relatively minimal impact the aspect ratio of the panels at the free surface is set to one as recommended in navatek 2018 accordingly the effect of free surface panel size on computed hydrodynamic forces is studied for the conditions shown in value 1 of table 3 general guidelines for determining fluid domain dimensions in ship resistance cfd simulations recommend that the upstream and downstream boundaries be at least 1 and 2 body lengths from the hull respectively and the exterior boundary at least 1 body length from the plane of symmetry international towing tank conference 2014 the distances to the upstream l u downstream l d and exterior l e edges shown in values 1 and 3 of table 3 are set larger than the recommended value see fig 5 reducing the distance to the downstream edge below 3 l b can have a detrimental effect on accuracy this matter is investigated later in this section by examining the effect of free surface size on hydrodynamic force computations for now free surface size is kept constant while panel size is varied fig 6 shows an example of the distribution of normal velocity over the undisturbed free surface s 0 for a prolate spheroid traveling at constant forward speed parallel to the free surface with fr 0 4 the normal velocity and its derivatives are key values used to compute the surge force heave force and pitch moment in equations 33 35 fig 7 compares computations of force and moment values from the hydrodynamic force model with values obtained directly from the seakeeping code described in section 5 the code computes the force and moment output values by integrating pressure over the body surface these values for the several panel sizes in value 1 of table 3 vary within 1 of the output value for the smallest panel area of 0 00125 therefore only the panel code force and moment output values for panel area 0 00125 are plotted in fig 7 fig 7 a shows that the surge force computations plotted as dashed lines agree well with the force values output by the code which is plotted as a solid line the surge force computations for the various panel areas overlap indicating that surge force is barely affected by change in the given panel sizes fig 7 c shows that like surge force the effect of panel size on pitch moment computations is not significant with the largest discrepancies for the largest panel area a l b 2 0 005 as for heave force the computed values approach the values output by the code as panel area is decreased the computed values for the smallest panel area a l b 2 0 00125 agree well with the code output values ultimately the required accuracy of the model will determine the panel size used in the simulations noting that decreasing the panel size increases accuracy at higher computational cost moving on to the effect of free surface size on force computations using equations 33 35 the conditions in value 2 of table 3 are applied for a uniform panel area of a l b 2 0 00125 while free surface size is varied in order to vary free surface size distance to the downstream edge l d of the free surface is adjusted and the distance to the exterior l e is varied accordingly in order for the free surface to enclose the kelvin wave pattern that is generated with a half angle of approximately 20 distance to the upstream edge l u is fixed since it has negligible effect on force computations in calm water as shown in fig 8 surge force heave force and pitch moment on the body are computed at several forward speeds for varying surface sizes and the computations are compared to force and moment values output by the seakeeping code in section 5 the discrepancy in output values for free surface sizes at l d 1 5 l b and 2 l b are approximately 10 or less of the output values when l d 4 l b this discrepancy is negligible when compared to the discrepancies in the computed values therefore for simplicity only the panel code force and moment output values with free surface dimensions l u 1 5 l b l d 4 l b and l e 1 6 l b are plotted in fig 8 as shown in fig 8 b the heave force computations plotted as dashed lines agree well with the force values output by the code plotted as a solid line the heave force computations for the various free surface sizes overlap indicating that heave force is hardly affected by change in the given free surface sizes however as can be seen in fig 8 a and c there is an evident discrepancy in surge force and pitch moment decreasing the free surface size from l d 4 l b to l d 2 l b results in a large disparity between computations and output values of surge force and pitch moment for the highest speed fr 0 5 further decreasing the free surface size to l d 1 5 l b results in a large disparity for the two highest speeds fr 0 45 and 0 5 these results indicate that as free surface size is decreased the highest speeds with the longest wave lengths are affected first on the other hand increasing free surface size includes more wave cycles in the wave computations leading to more accurate computations but at a higher computational cost value 3 of table 3 shows the final set of simulation conditions for surge force heave force and pitch moment computation simulations are performed with the smallest panel area and largest free surface size the conditions that yield the most accurate computations for a spheroid traveling at various depths and speeds as shown in fig 9 force computations agree very well with force values output by the panel code as expected the absolute value of the forces and moment decrease as the body moves away from the free surface for the given range and scale of the plots using the same panel area a l b 2 0 00125 will yield satisfactory results for the various given depths on the other hand smaller panel areas will be required for smaller scale calculations at lower speeds or greater depths note that depth does not affect the number of wave cycles included in a given free surface size so free surface area does not have to be adjusted according to depth 7 conclusions and future work in this paper a lagrangian mechanical system model for a submerged vehicle maneuvering near a calm free surface is reformulated in order to compute model parameters in the special case of steady translation first the derivation of the control oriented lagrangian mechanical system model by battista 2018 is briefly reviewed then model terms are reformulated to allow computation of parameters using data that are readily available from the potential flow code the parameters expressed as integro differential functions of the velocity potential are then computed for a prolate spheroid in steady surge motion using a potential flow code that has been modified to output the necessary functions of the flow potential hydrodynamic force computations for the reformulated lagrangian model obtained using the modified potential flow software are then compared with computations obtained directly from the panel code the effect of computational parameters such as panel area and domain size are first examined and then the effect of depth the results confirm the proposed approach for model parameter computation subtleties arise in reformulating the original lagrangian mechanical system model concerned with swapping the order of integration and differentiation for the integro differential parameters and computing partial derivatives of the lagrangian function a numerical investigation illustrates the validity of the proposed approach to model parameter computation involving partial derivatives with respect to translational configuration variables for a body undergoing impulsive motions results show that terms computed using the proposed method agree well with numerical calculations output by a panel code in addition steady forces on a body moving at a constant forward speed parallel to a calm free surface derived from the reformulated model are compared to direct numerical computations the effect of panel area and free surface size variation on surge force heave force and pitch moment calculations is examined and the conditions that yield the most accurate results are used to study the effect of depth variation on forces results agree well in the range of fr 0 3 0 5 and depths z b l b 0 15 0 3 the reformulated model proposed in this work can further be applied to computation of unsteady forces on a submerged vehicle in unsteady flow due to steady or unsteady motion of the body in addition the total velocity potential in the reformulated model can be decomposed into physically meaningful impulsive and memory flow components the memory flow component can be approximated with a finite dimensional realization and the resulting parameters can be computed using the methods proposed in this paper to yield a model which can be used in model based nonlinear control design for submerged vehicles operating near a free surface credit authorship contribution statement seyong jung methodology software formal analysis investigation writing original draft stefano brizzolara methodology supervision writing review editing craig a woolsey conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the sponsorship of the u s office of naval research under grant numbers n00014 14 1 0651 and n00014 16 1 2749 the authors also thank navatek ltd for providing access and technical support for the seakeeping code aegir finally the authors thank drs f valentinis t battista and e g paterson as well as the anonymous reviewers for their many comments that helped improve this article nomenclature a panel area a arbitrary vector ao aegir output b body geometry vector b vehicle body c b rigid body coriolis and centripetal matrix c i impulsive coriolis and centripetal matrix c m memory coriolis and centripetal matrix d i impulsive damping matrix d m memory damping matrix e i unit vector with a 1 in the i th position e x unit vector along the x axis f arbitrary scalar function f fluid domain fdm finite difference method f h hydrodynamic force vector fr froude number g gravitational acceleration g transformation matrix hfm hydrodynamic force model j kinematic transformation matrix k m memory kernel matrix l b spheroid body length l d distance to downstream edge l e distance to exterior edge l u distance to upstream edge l l complete system lagrangian l f fluid lagrangian m b rigid body inertia matrix m b deeply submerged added mass matrix δ m b surface perturbed added mass matrix m i impulsive added mass matrix m m memory added mass matrix m s 0 undisturbed free surface added mass matrix n unit normal vector o origin of earth fixed frame o origin of body fixed frame q set of generalized coordinates q set of quasicoordinates q set of generalized forces r position of a point on a surface r s position of a point on s 0 relative to earth fixed frame s fluid domain surface s 0 undisturbed free surface t time t f fluid kinetic energy u forward speed v velocity of a point on a surface v translational velocity of body v absolute velocity of fluid boundary v f fluid potential energy x b position of body x b translational component of quasicoordinates η arbitrary intensive property θ b orientation of body θ b rotational component of quasicoordinates ν set of quasivelocities ρ water density φ velocity potential φ i impulsive flow potential φ k kirchhoff s potential φ m memory flow potential φ s free surface potential ϕ i normalized potential vector for impulsive flow ϕ k normalized kirchhoff s potential vector ϕ s normalized free surface potential vector ω rotational velocity of body a transformation matrices the kinematic transformation matrix j can be used to express the following relation q j θ b ν where 37 j θ b r θ b 0 0 l θ b in 37 the proper rotation matrix r θ b maps free vectors from the body fixed frame to the earth fixed frame by a 3 2 1 sequence using euler angles θ b φ b θ b ψ b t and can be explicitly expressed as r cos θ b cos ψ b sin φ b sin θ b cos ψ b cos φ b sin ψ b cos φ b sin θ b cos ψ b sin φ b sin ψ b cos θ b sin ψ b cos φ b cos ψ b sin φ b sin θ b sin ψ b sin φ b cos ψ b cos φ b sin θ b sin ψ b sin θ b sin φ b cos θ b cos φ b cos θ b similarly the transformation l θ b which converts the body angular velocity vector to the euler angle rates is defined as l θ b 1 sin φ b tan θ b cos φ b tan θ b 0 cos φ b sin φ b 0 sin φ b sec θ b cos φ b sec θ b now the transformation matrix g is expressed as follows based on the derivation described in schaub and junkins 2009 g i j k 1 n l 1 n m 1 n j k i j l m ν m j k j t q l j l j t q k here j i j is the i j element of the transformation matrix j in 37 matrix g can also be expressed in the following matrix form g q ν j t d d t j t q j ν t j t for the chosen kinematic transformation matrix j in 37 g ν ω ˆ 0 v ˆ ω ˆ where the hat operator ˆ represents the cross product equivalent matrix of a vector b divergence theorem the divergence theorem also known as gauss s theorem relates the flux of a vector field across a surface to the integral of the divergence over its interior for a closed region v bounded by a closed surface s if the vector field a is defined and continuously differentiable throughout v then v a d v s a n d s where n is a unit vector normal to s c differentiation under the integral sign rotation the differentiation with respect θ b can be derived as follows in fig 10 suppose that the body b undergoes rotational displacement for a small rotational displacement δ θ b of an element δ s of the surface b the points x of δ s sweep out a volume 38 δ v δ θ b r n δ s δ θ b r n δ s where r is the set of coordinates of a point on the body b in the body fixed frame if we multiply the above volume by a function f and sum the products over the entire surface b δ i b f δ θ b r n δ s we can conclude the following i θ b b f r n d s the resulting differential under the integral sign for a body undergoing rotational displacement is θ b f f θ b t d v f f θ b t θ b d v b f θ b t r n d s d relative displacement of a fluid particle rotation the equivalence relation for the relative displacement of the fluid particle at x for a small rotational displacement δ θ b of the body b is derived here the displacement of a point on the body surface b due to a small rotational displacement of the body is 39 δ θ b r δ θ b r z δ ψ b r y b 1 δ ψ b r x δ φ b r z b 2 δ φ b r y δ θ b r x b 3 where θ b φ b θ b ψ b t also the displacement of a fluid particle expressed in the body fixed frame is 40 δ x δ x b 1 δ y b 2 δ z b 3 therefore the equivalence relation between the displacement of the body b and the relative displacement of a fluid particle while fixing the body b is 41 δ θ b r δ x by using equations 39 and 40 42 δ θ b r z δ ψ b r y b 1 δ ψ b r x δ φ b r z b 2 δ φ b r y δ θ b r x b 3 δ x b 1 δ y b 2 δ z b 3 by applying the chain rule to an element of φ θ b φ φ b x φ b φ x y φ b φ y z φ b φ z and by applying the equivalence relation in equation 16 φ φ b x φ b φ x y φ b φ y z φ b φ z using equation 42 φ φ b r y φ z r z φ y the remaining elements of φ θ b can be derived through the same process therefore φ θ b φ φ b b 1 φ θ b b 2 φ ψ b b 3 r y φ z r z φ y b 1 r z φ x r x φ z b 2 r x φ y r y φ x b 3 b 1 b 2 b 3 r x r y r z φ x φ y φ z r φ x r φ e relative displacement of the undisturbed free surface rotation for relative rotational displacement instead of the body being displaced by δ θ b with a fixed undisturbed free surface boundary an equivalent relative displacement δ θ b can be applied to the undisturbed free surface while the body is fixed replacing δ θ b r n with δ θ b r n an element δ s of the undisturbed free surface s 0 sweeps out a volume δ v δ θ b r n δ s going through the same process as in appendix c θ b f f θ b t d v f f θ b t θ b d v s 0 f θ b t r n d s f derivation of steady pitch moment in the hydrodynamic force model 24 the normal derivative of the normalized potential vector for impulsive flow can be expressed as ϕ i n φ ν n where φ ν φ v φ ω following the procedure in section 4 2 2 and appendix d the moment component can be expressed as φ ω r φ v now we consider the position r of a point on the undisturbed free surface s 0 relative to the body fixed frame for translational motion of the body at steady velocity u parallel to the free surface the undisturbed free surface s 0 has a steady velocity of u relative to the body if we define r s as the position of a point on the undisturbed free surface s 0 with respect to the earth fixed frame r s does not depend on time since the earth fixed frame is fixed to the free surface then for initially coinciding x and y axes of the body and earth fixed frames r r s u 0 0 t this expression for r can be used to derive the following t φ ν 0 r t φ v 0 u 0 0 φ v 0 0 u φ w u φ v where v u v w t therefore the pitch component of the second term in the hydrodynamic force model 24 can be rewritten as ρ s 0 t φ ϕ i 5 n d s ρ s 0 φ u φ w n d s ρ s 0 φ u ϕ i 3 n d s this term cancels out with the term ρ g s 0 φ ϕ i n d s in the third row of the hydrodynamic force model 24 and therefore the pitch moment acting on a body in steady translational motion parallel to the free surface becomes m ρ b φ u n z d s ρ s 0 φ r z 2 φ x n r x 2 φ n 2 d s 1 2 ρ s 0 φ φ r z n x r x n z d s appendix asupplementary data the following is the supplementary data to this article multimedia component 1 appendix asupplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 108988 
20758,this paper describes the computation of parameters for a lagrangian mechanical system model of a submerged vessel moving near an otherwise calm free surface using a medium fidelity potential flow code the software uses the boundary element method to solve for the flow potential on the body and the free surface the model a system of integro differential equations involving functions of the velocity potential is the maneuvering component of a lagrangian nonlinear maneuvering and seakeeping model that was introduced in earlier work here this nonlinear maneuvering model is reformulated and the potential flow software is modified to support parameter computations parameters are computed for a prolate spheroid moving parallel to a calm free surface at a constant forward speed this motion induces a steady flow with respect to the body which results in a steady surge force heave force and pitch moment these longitudinal forces and moment are computed using the reformulated lagrangian nonlinear maneuvering model and the results are compared with basic panel code solutions for various depths and froude numbers and for various computational parameter values keywords underwater vehicle dynamics hydrodynamic parameters lagrangian mechanics free surface 1 introduction a nonlinear lagrangian mechanical system model for a submerged vehicle moving near an otherwise calm free surface was developed by battista et al battista et al 2020 and was extended to incorporate ambient wave effects battista 2018 traditional modeling of ocean vessels involves either maneuvering theory or seakeeping theory bailey et al 1998 combined the two approaches to consider maneuvering in a seaway under the assumption of small perturbations fossen 2005 later unified maneuvering and seakeeping models for the purpose of control design an advantage of battista s lagrangian mechanical system model is that it captures nonlinear hydrodynamic forces and moments predicted by potential flow theory that may be generated during aggressive maneuvers near the free surface although the modeling method only captures potential flow effects the underlying structure of the lagrangian mechanical system model allows one to apply energy based nonlinear control design and stability analysis methods that can provide a basis for improving performance and expanding the operating envelope in a real fluid example applications of these control methods to underwater vehicles include cross track control using potential shaping woolsey and techy 2009 passivity based speed and attitude tracking control valentinis et al 2015 and depth and heading regulation battista et al 2017 before one may develop an energy based nonlinear controller for a submerged vessel maneuvering in waves though the model parameters must be computed for the given body geometry this process begins with the assumption of a calm free surface parameters of a structured model for vessel motion are typically derived by performing parameter estimation using experimental data high fidelity computational fluid dynamics cfd data or both analytical solutions for hydrodynamic forces on simple geometries such as a spheroid chatjigeorgiou and miloh 2014 or ellipsoid miloh 1979 can be used to approximate model parameters for vessels with similar geometry but with limited fidelity experimental data is typically obtained through captive model experiments such as planar motion mechanism pmm tests gertler 1967 by performing pmm tests one may obtain parameters for widely used motion models such as the abkowitz model beck et al 1989 inconsistencies due to scaling effects suggest the use of additional data obtained experimentally from full scale ship maneuvering trials abkowitz 1980 alternatively pmm tests jung et al 2017 pan et al 2012 or free running tests yiew et al 2019 can be simulated using cfd to derive hydrodynamic coefficients for vessel motion models in some cases both experimental data and cfd data are used araki et al 2012 current trends in marine vessel model identification include extensions of traditional model based filtering regression approaches such as abkowitz 1980 fossen et al 1996 and more recent data driven approaches moreno salinas et al 2015 wang et al 2019 in addition the latest in cfd based parameter estimation employs high fidelity cfd simulations that include the propulsor and all appendages carrica et al 2019 although these data driven methods can produce very accurate models they can be costly and time consuming and usually have poor extrapolation capabilities the basic axiom of model based control design is that including knowledge about a system s physics can improve a controller s performance because model based control design methods presume specific model structures however the first challenge is to determine how much physics can actually be included the lagrangian mechanical system model considered here is a potential flow model as such it omits the important effects of viscous flow the model might be amended to account for these effects to some extent but it is the role of feedback control to mitigate the disturbance that results from unmodeled effects here we consider scenarios in which nonlinear effects captured imperfectly by the lagrangian mechanical system model are more valuable to the control design process than local effects captured by high fidelity linearized models the parameter computation method by use of a panel code developed here is ideally suited to the task of identifying the lagrangian mechanical system model it is less expensive than cfd simulations because panel methods assume potential flow and also because only the surfaces of the body and free surface are discretized with panels while high fidelity cfd discretizes the entire volumetric domain molland 2008 although panel methods produce results that omit important physics due to the potential flow assumption this same assumption is made for the maneuvering model whose parameters are being computed ensuring that parameter computations are not contaminated with unmodeled effects such as those due to viscosity this work presents methods for reformulating the nonlinear motion model and directly computing the model parameters the reformulation process circumvents the need for additional numerical discretization thus increasing accuracy and decreasing computational cost the parameters of the reformulated model expressed as integro differential functions of the velocity potential can then be obtained by direct computation in contrast to parameter estimation methods using experimental or cfd data each model parameter can be directly computed knowledge of a specific model component or of how that component was computed can provide helpful insight about that component s role in the physics to illustrate the parameter computation process and to make comparisons to direct computations for a specific body in a steady flow the paper is organized as follows section 2 provides some brief remarks on model based control and estimation as context for the paper s contribution section 3 summarizes the derivation of the lagrangian mechanics based nonlinear motion model for a submerged vessel maneuvering near a calm free surface battista 2018 section 4 proposes a reformulation that allows the efficient use of a potential flow code to compute model parameters section 5 introduces the medium fidelity potential flow code used in this work and describes code modifications that are needed to compute parameters in section 6 the proposed reformulation is verified by comparing the reformulated hydrodynamic force model with forces computed directly for a prolate spheroid moving steadily in surge beneath a calm free surface finally section 7 reviews the results of this study and describes future work and applications 2 remarks on model based control and estimation although the development of a model based control strategy is beyond the scope of this paper it is important to discuss the context for the hydrodynamic modeling effort and the simplifying assumption of potential flow control theory is generally concerned with systems described by the ordinary differential equations 1 x f x u t where x t is the state vector describing a vehicle s position and velocity for example and u t is a user defined input khalil 2002 one may also incorporate disturbance inputs d t into the vector field f additional equations can be included to account for measurements y t if the full state is not available for feedback control the feedback control design problem involves constructing a state feedback control law u x t or perhaps an output feedback control law u y t for which the state of the true system converges to some desired time history x d t no control design method exists that can address the general class of systems 1 but there are well developed methods for subclasses of these systems most notably linear systems rugh 1996 2 x a t x b t u typically a system model 2 is obtained from a nonlinear model 1 by linearizing about some known motion of interest such as a steady motion in this case the state and input vectors for system 1 are vectors of perturbation variables which must remain small for the model to remain valid provided that is true the time varying matrices a t and b t can be used to develop effective state feedback control laws dorato et al 1995 because typical seakeeping models assume constant speed and course the small perturbation restriction means that a maneuvering control law based on a linearized model for motion in waves is restricted to slow maneuvers instead given a nonlinear motion model 1 one might consider a variety of nonlinear control design methods such as feedback linearization khalil 2002 also known as dynamic inversion sliding mode control slotine and li 1991 or adaptive control krstic et al 1995 all control design methods impose some requirements on 1 but the fact that a submerged vessel is a mechanical system introduces some important and useful structure as an over simplified example consider a conventional time invariant lagrangian mechanical system i e one for which a generalized coordinate variable q i is associated to each of n degrees of freedom for simplicity we assume an input force u i can be chosen to affect each of these degrees of freedom independently given the energy like lagrangian function l q q the system motion is described by the euler lagrange equations d d t l q l q u m q q c q q q g q u where q and u are the vectors of configuration and input variables respectively m q is the generalized inertia matrix c q q is the associated coriolis and centripetal matrix and g q is the generalized force due to potential energy one approach to control design see for example woolsey et al 2004 and the references contained there is to choose state feedback u q q so that the closed loop system is still lagrangian but with respect to a new control modified lagrangian function l c q q the control modified energy and any associated conservation laws can be used to study stability and to develop strategies for dealing with unmodeled effects such as dissipative forces and moments examples for deeply submerged vessels are discussed in woolsey and techy 2009 valentinis et al 2015 though in the context of hamiltonian models rather than lagrangian models designing energy based control laws is beyond the scope of this paper we instead describe a method to compute parameter values for a control oriented motion model a necessary precursor to the development of model based nonlinear control and estimation strategies 3 lagrangian mechanical system model a first principles nonlinear motion model based on potential flow theory for a submerged vehicle maneuvering near a calm free surface has been developed using lagrangian mechanics modeling techniques battista et al 2020 battista 2018 the reference frames and notation used by battista et al are shown in fig 1 the earth fixed reference frame is located at a point o on the undisturbed free surface s 0 the z axis points down in the direction of gravity the origin o of the body fixed reference frame is fixed at some point in the body b for simplicity we place o at the geometric center and we assume the vessel is neutrally buoyant with uniformly distributed mass it is straight forward to relax these assumptions see battista 2018 for example but doing so unnecessarily complicates the discussion of hydrodynamic effects the generalized coordinates q x b t θ b t t describe the configuration of the body where the vector x b denotes the position of o in the earth fixed frame and θ b represents the roll pitch and yaw euler angles the 6 dimensional vector ν v t ω t t is composed of the translational velocity v and rotational velocity ω of the body fixed frame with respect to the earth fixed frame both expressed in the body fixed frame the velocity potential is decomposed into the following time and vehicle state dependent potential functions to represent the corresponding fluid motion by combining approaches by kirchhoff lamb 1932 and cummins 1962 3 φ q ν t φ k ν φ s q ν φ m q ν t ϕ k ϕ s q ν impulsive flow potential φ m q ν t memory flow potential kirchhoff s potential φ k and the free surface potential φ s compose the impulsive flow potential the sum of the vectors ϕ k and ϕ s represents the normalized potential for impulsive flow in cummins equations the state and time dependent memory flow potential accounts for memory effects the lagrangian for the complete fluid and rigid body system contains matrices that are integrals of functions of the velocity potential 4 l q ν t 1 2 ν t m b m b δ m b m s 0 ν ν t 0 t k b k s 0 ν τ d τ the subscripts b and s 0 denote surface integration over the body and undisturbed free surfaces respectively the matrix m b is the body inertia matrix m b is the deeply submerged added mass matrix δ m b accounts for the asymmetry in the fluid volume due to the free surface boundary m s 0 accounts for the instantaneous deformation of the bounding surface and the integral term accounts for memory effects among these terms the matrices with the b or s 0 subscripts are expressed with components of the total velocity potential for instance m b ρ b ϕ k b d s where b n t r n t t is composed of the unit normal vector n and the position vector r from the origin of the body fixed frame to the point at which the normal vector n is defined finally the boltzmann hamel equations 5 d d t l ν g ν l ν j q t l q j q t q are used to derive a set of nonlinear equations from the system lagrangian here g and j are transformation matrices see appendix a that appear due to the use of quasivelocities ν and q is the generalized force the resulting set of equations 6 represent the motion of a vehicle maneuvering near a calm free surface 6 f m b m i m m ν c b c i c m ν d i d m ν 0 t k m ν τ d τ the matrices with the subscript i and m contain the impulsive and memory flow related terms respectively the matrix m i for example is a combination of the mass matrices in 4 and their derivatives m i m b m b δ m b m s 0 i 1 6 e i ν t m s 0 ν i m s 0 ν i ν e i t 1 2 i 1 6 j 1 6 e i ν t 2 m s 0 ν i ν j ν e j t where e i is a unit vector with a 1 in the i th position a complete description of the lagrangian mechanics model can be found in battista et al 2020 battista 2018 4 reformulation of model in this section the model for a submerged vehicle maneuvering near a calm free surface shown in equation 6 is reformulated for parameter computation using data from a potential flow code the reformulation process avoids additional numerical discretization that would otherwise be necessary to approximate the derivatives that appear in the boltzmann hamel equation 5 in the reformulation process differentiation under the integral sign is applied in order to interchange the order of differentiation and integration subsequently the partial derivatives of the integrand with respect to ν and q are derived by a direct method and by an equivalent operation respectively the parameters of the resulting reformulated model can be computed using data from a modified potential flow code 4 1 differentiation under the integral sign this subsection explains how the differentials in the boltzmann hamel equations 5 namely ν q and d d t are interchanged with the volume integral over the fluid volume f the divergence theorem see appendix b is then applied to the volume integral to yield the surface integrals over b and s 0 that appear in the lagrangian l 4 1 1 derivatives with respect to ν since the limits of the volume integral over the fluid volume f do not depend on ν the order of ν with the integral over f can simply be interchanged therefore 7 ν f f d v f f ν d v for an arbitrary scalar function f 4 1 2 derivatives with respect to q the boltzmann hamel equations 5 are used to derive equations of motion that accommodate the set of quasivelocities ν that are expressed in the body fixed frame however the set of generalized coordinates q which also appears in the same equation is composed of the body position x b and euler angles θ b neither of which is expressed in the body fixed frame by defining a set of quasicoordinates schaub and junkins 2009 expressed in the body fixed frame denoted q x b t θ b t t and satisfying ν d d t q the relation between q and q can be used to re express differentiation with respect to q under the integral sign from the definition of the kinematic transformation matrix j battista 2018 q j θ b ν or for each component i 1 2 6 8 d q i d t j 1 6 j i j d q j d t the lagrangian can be expressed as l q ν t a function of quasicoordinates taking l q ν t l q ν t we find greenwood 2003 l q j i 1 6 l q i q i q j using equation 8 l q j i 1 6 j i j l q i or 9 l q j t l q the boltzmann hamel equation 5 can now be written as 10 d d t l ν g ν l ν l q j q t q the focus now is on how q can be interchanged with a surface integral over the body b where the limits of the integral depend on the configuration of the body q the translational component of q is examined first referring to fig 2 suppose the body b undergoes a small translational displacement δ x b for an element δ s of the surface of b the points x of δ s sweep out a volume δ v δ x b n δ s where n is a unit vector normal to δ s if we multiply the above volume by a function f and sum the products over the entire surface b we obtain δ i b f δ x b n δ s now if we consider displacement along only the x axis δ i b f δ x b cos n e x δ s here e x is a unit vector along the x axis and cos n e x is the cosine of the angle between vectors n and e x dividing both sides by δ x b and passing to the limit δ x b 0 yields i x b b f cos n e x d s we can perform the same derivation for displacement along the y and z axes to conclude i x b b f n d s this is the term that should be added when taking the derivative of the volume integration over the fluid domain while the body surface is undergoing translational displacement 11 x b f f x b t d v f f x b t x b d v b f x b t n d s the boundaries of the fluid volume f include the body surface b and the free surface which is approximated by the undisturbed free surface s 0 the limits of the integral over s 0 are independent of the configuration of the body q so there are no additional terms that involve the integral over s 0 a similar approach can be taken for the rotational component of q see appendix c and the resulting differentiation under the integral sign is 12 θ b f f θ b t d v f f θ b t θ b d v b f θ b t r n d s 4 1 3 derivatives with respect to t if the limits of the integral over the fluid domain surface s do not depend on t the order of the derivative and the integral can simply be interchanged as shown below 13 d d t s f d s s f t d s where f is an arbitrary scalar function on the other hand if the limits of the integral are t dependent leibniz theorem can be applied for the differentiation under the integral sign cengel and cimbala 2006 4 2 partial derivatives of the integrand 4 2 1 computation of φ ν the total velocity potential is decomposed into an impulsive flow component and a memory flow component in equation 3 and the same equation can be rewritten in an alternative form 14 φ ϕ i q ν 0 t ϕ m q τ t τ ν τ d τ where ϕ i ϕ k ϕ s is the normalized potential vector for impulsive flow in equation 14 we can see that the memory component is independent of ν t so the partial derivative of the integral term with respect to ν t is zero therefore 15 φ ν ϕ i 4 2 2 computation of φ q the relative displacement the set of quasicoordinates q is composed of the vectors x b and θ b a small increment in x b is a small translational displacement δ x b of the body b that can as shown in fig 3 be equivalently represented by a translational displacement δ x of the fluid domain while the body remains fixed the equivalent displacement of the fluid domain is indicated by the displacement of an arbitrary fluid particle p and of the undisturbed free surface s 0 4 2 2 1 relative displacement of a fluid particle considering a relative displacement of a fluid particle as shown in fig 3 we find that 16 φ x b x b lim δ x b 0 φ x b δ x b φ x b δ x b lim δ x 0 φ x δ x φ x δ x lim δ x 0 φ x φ x δ x δ x φ x x φ x an analogous identity can be derived for rotational displacement as shown in appendix d φ θ b r φ x 4 2 2 2 relative displacement of the undisturbed free surface applying the relative displacement of the undisturbed free surface s 0 affects the differentiation with respect to q under the integral sign described in section 4 1 in equations 11 and 12 the integral over b is replaced with an integral over s 0 since the undisturbed free surface s 0 is now relatively displaced while holding the body b fixed for translational displacement instead of the body b being displaced by δ x b with a fixed undisturbed free surface boundary s 0 an equivalent relative displacement of the undisturbed free surface s 0 in the opposite direction δ x can be applied while the body b is fixed substituting δ x b with δ x an element δ s of the undisturbed free surface s 0 sweeps out a region of space whose volume is δ v δ x n δ s going through the same process as in section 4 1 2 yields 17 x b f f x b t d v f f x b t x b d v s 0 f x t n d s a similar approach can be taken for the rotational component of q see appendix e the resulting equivalent expression is 18 θ b f f θ b t d v f f θ b t θ b d v s 0 f θ b t r n d s it is important to note that both the relative displacement of the fluid section 4 2 2a and the relative displacement of the undisturbed free surface section 4 2 2b must be applied simultaneously to the mathematical model the alternative formulations described in sections 4 1 and 4 2 simplify the numerical computation of parameter values as discussed in the context of a numerical example explored in section 6 4 3 resulting reformulated model the methods proposed in sections 4 1 and 4 2 can be applied to the motion model derived by battista 2018 to obtain a reformulated lagrangian mechanics based model for which the parameters can be more readily computed using a potential flow code the hydrodynamic force model is derived using the undecomposed total velocity potential φ q ν t for a body moving near a free surface the fluid lagrangian is 19 l f t f v f 20 f 1 2 ρ φ φ d v f ρ g z d v where t f and v f are the kinetic and potential energies of the fluid domain having assumed neutral buoyancy and uniform mass distribution and adopting a linearized free surface boundary condition the potential energy term can be neglected and the fluid lagrangian simply becomes 21 l f f 1 2 ρ φ φ d v the terms in the boltzmann hamel equation 10 can be derived as follows by applying the methods proposed in equations 7 17 and 18 along with the divergence theorem appendix b to the fluid lagrangian in equation 21 22 l f ν ρ b φ b d s ρ s 0 φ ϕ i n d s 23 l f q ρ s 0 φ φ n d s 1 2 ρ s 0 φ φ b d s where r equations 22 and 23 can be applied to equation 10 to derive the resulting hydrodynamic force model 24 f h ρ d d t b φ b d s ρ d d t s 0 φ ϕ i n d s ρ g b φ b d s ρ g s 0 φ ϕ i n d s ρ s 0 φ φ n d s 1 2 ρ s 0 φ φ b d s here f h is the vector of hydrodynamic forces and moments on the surface affected body note that the complete reformulated model for a submerged vehicle maneuvering near a calm free surface can be derived from the above hydrodynamic force model 24 to that end the total velocity potential must be decomposed into the components in equation 3 also the neutral buoyancy and homogeneous mass distribution assumptions may be relaxed by including the potential energy term in the fluid lagrangian in equation 20 5 time domain seakeeping code the time domain nonlinear seakeeping code aegir is used to compute the terms in the hydrodynamic force model 24 aegir is a medium fidelity potential flow code that uses a boundary element method to compute steady and unsteady wave patterns forces and motions of vehicles operating at or near a free surface navatek 2018 the typical output data of an unmodified seakeeping code includes the velocity potential fluid velocity pressure surface elevation and other related quantities for the given simulation conditions within the fluid volume fig 4 shows a visualization of surface elevation data output by aegir in order to compute the parameters in equation 24 the code must be modified to provide some terms that are not typically needed namely ϕ i n and φ n each element of the normalized potential vector ϕ i q for impulsive flow can be obtained by deriving the solution for impulsive motion about each coordinate axis for example if unit velocity in surge is prescribed on a body while imposing the condition for impulsive motion φ i 0 at the undisturbed free surface s 0 the resulting velocity potential for the impulsive flow will be equal to the first element of the normalized potential vector ϕ i for impulsive flow as for φ n the values needed to calculate the term can be readily obtained from the panel code spatial discretization in aegir employs a bi quadratic normal b spline representation and therefore the first and second derivatives of the function can be obtained directly without implementing any additional finite difference methods kring 1994 as a result once ϕ i and φ n are obtained the parameters in equation 24 can be computed by integrating a combination of these values over the body and free surfaces 6 comparison with direct numerical computations the hydrodynamic force model 24 is compared with simulation data obtained from the seakeeping code in section 5 first the validity of the methods proposed in sections 4 1 and 4 2 is confirmed by examining the computation of two terms in the hydrodynamic force model next the forces and moment on a slender axisymmetric body in longitudinal motion near a free surface in steady flow are computed using the model and the results are compared to simulation data 6 1 confirmation of proposed methods the two terms on the right hand side of 23 obtained by applying the methods proposed in sections 4 1 and 4 2 correspond to the last two terms in the hydrodynamic force model 24 if we assume that the body fixed frame is aligned with the earth fixed frame the translational components of these terms for impulsive motion are 25 l f x b ρ s 0 φ i φ i n d s 1 2 ρ s 0 φ i φ i n d s 1 2 ρ s 0 φ i φ i n d s since φ i the impulsive flow component of the total velocity potential is equal to zero at the undisturbed free surface s 0 cummins 1962 weinblum 1952 if we first consider the elements x b and y b of the body position vector x b equation 25 becomes 26 l f x b 1 2 ρ s 0 φ i φ i n x d s 0 and 27 l f y b 1 2 ρ s 0 φ i φ i n y d s 0 since n x n y 0 at the undisturbed free surface s 0 the validity of equations 26 and 27 can be confirmed by approximating the left hand side of equation 25 using the divergence theorem and the finite difference method as shown below 28 l f x b 1 2 ρ x b f φ i φ i d v 1 2 ρ x b b s 0 φ i φ i n d s 1 2 ρ x b b φ i φ i n d s 1 2 ρ δ b φ i φ i n d s δ x b now the value of l f x b evaluated at a certain body position x b can be computed using equation 25 and compared to the finite difference method calculation in equation 28 which uses output data at the same position x b as well as output data at position x b δ x b the left hand side of equations 26 and 27 can be approximated by applying the finite difference method in equation 28 29 l f x b 1 2 ρ δ b φ i φ i n d s δ x b 0 and 30 l f y b 1 2 ρ δ b φ i φ i n d s δ y b 0 since φ i does not depend on x b or y b for a submerged body in motion near an otherwise calm free surface therefore the calculations from the proposed method shown in equations 26 and 27 and the finite difference method shown in equations 29 and 30 are equal for elements x b and y b for the remaining element z b which denotes the depth of the body equations 25 and 28 can be rewritten a follows 31 l f z b 1 2 ρ s 0 φ i φ i n z d s 32 l f z b 1 2 ρ δ b φ i φ i n d s δ z b these equations are computed numerically for comparison by solving the impulsive flow for a 6 1 prolate spheroid in the conditions shown in table 1 using the modified seakeeping code in section 5 as shown in fig 5 the distances to the upstream downstream and exterior edges determine the portion of the free surface that contributes to the computations in order to simulate impulsive motion the boundary condition φ i 0 is imposed at the undisturbed free surface s 0 the term 31 is computed using flow solutions at depth to body length ratios of 0 15 and 0 30 values obtained using the finite difference method in equation 32 on the other hand are computed using flow solutions at depth to body length ratios of 0 15 and 0 30 and at the slightly larger ratios of 0 1505 and 0 3005 the resulting computations for equations 31 and 32 at depth to body length ratios of 0 15 and 0 30 are shown in table 2 overall computations of l f z b using the proposed method 31 agree well with the results from the finite difference method 32 more accurate results can be obtained by reducing the panel area a and the increment in depth δ z b these calculations illustrate the validity of the alternative formulation presented in sections 4 1 and 4 2 for computing partial derivatives of the fluid lagrangian with respect to translational configuration variables for a body undergoing impulsive motion the main advantage in employing this alternative formulation is to increase efficiency when computing the parameters of the lagrangian mechanical system model described in battista et al 2020 battista 2018 6 2 comparison with direct computations for model in steady flow when a body is in steady translational motion parallel to the free surface the flow around the body reaches a steady state and as a consequence constant forces and moments act on the body these forces and moments can be derived from equation 24 where φ is now constant the seakeeping code in section 5 simulates a body in steady translational motion parallel to the free surface by moving the body b and undisturbed free surface s 0 simultaneously relative to the earth fixed frame therefore the coordinates of a point on b and s 0 are constant in the body fixed frame as a result the order of the derivative and the integral in the first row of equation 24 can simply be interchanged by applying equation 13 in addition for steady surge motion the terms v and g simplify as follows v u 0 0 g 0 0 v ˆ 0 the following expression for surge force acting on the body due to steady translational motion parallel to the free surface can now be derived from the hydrodynamic force model 24 33 x ρ s 0 φ 2 φ x n d s 1 2 ρ s 0 φ φ n x d s the expression for heave force is 34 z ρ s 0 φ 2 φ n 2 d s 1 2 ρ s 0 φ φ n z d s finally the expression for pitch moment is 35 m ρ b φ u n z d s ρ s 0 φ r z 2 φ x n r x 2 φ n 2 d s 1 2 ρ s 0 φ φ r z n x r x n z d s although obtaining the steady surge and heave force expressions from equation 24 is straightforward deriving the pitch moment equation requires more caution details concerning the derivation of the steady pitch moment are given in appendix f hydrodynamic force equations 33 35 can be expressed in the parametric model form in equation 6 by simply substituting the total velocity potential φ with the decomposed form in equation 3 for example the first term in 33 can be rewritten in parametric form as 36 ρ s 0 φ 2 φ x n d s ρ s 0 ϕ k ϕ s ν φ m 2 ϕ k ϕ s ν φ m x n d s ρ s 0 φ m 2 ϕ k t x n d s ρ s 0 φ m 2 ϕ s t x n d s ① ν ρ s 0 φ m 2 φ m x n d s ② since ϕ k ϕ s ν φ i 0 at the undisturbed free surface s 0 cummins 1962 weinblum 1952 here ① is one of the terms that are summed up to form a row vector that corresponds to the first row of d m and ② is one of the terms that are summed up to form a component that corresponds to the first element of 0 t k m ν τ d τ in the parametric model in 6 parameters such as those in equation 36 are computed using the modified seakeeping code in section 5 by the method described there in order to compare results derived from the hydrodynamic force equations 33 35 for brevity these hydrodynamic forces are expressed in a simple form using the total velocity potential in this section the constant force and moment components on a 6 1 prolate spheroid in steady motion along its longitudinal axis parallel to the free surface are derived by computing equations 33 35 the effects of panel and free surface size on the force and moment computations are examined and in addition force and moment computations at various speeds and depths are compared to panel code output values varying the dimensions of the panels over the body surface and the undisturbed free surface affects accuracy of the flow solution however when computing forces using equations 33 35 which are mostly the evaluation of integrals over the free surface only changes in panel dimensions on the free surface have significant effect changes in panel dimensions on the body have relatively minimal impact the aspect ratio of the panels at the free surface is set to one as recommended in navatek 2018 accordingly the effect of free surface panel size on computed hydrodynamic forces is studied for the conditions shown in value 1 of table 3 general guidelines for determining fluid domain dimensions in ship resistance cfd simulations recommend that the upstream and downstream boundaries be at least 1 and 2 body lengths from the hull respectively and the exterior boundary at least 1 body length from the plane of symmetry international towing tank conference 2014 the distances to the upstream l u downstream l d and exterior l e edges shown in values 1 and 3 of table 3 are set larger than the recommended value see fig 5 reducing the distance to the downstream edge below 3 l b can have a detrimental effect on accuracy this matter is investigated later in this section by examining the effect of free surface size on hydrodynamic force computations for now free surface size is kept constant while panel size is varied fig 6 shows an example of the distribution of normal velocity over the undisturbed free surface s 0 for a prolate spheroid traveling at constant forward speed parallel to the free surface with fr 0 4 the normal velocity and its derivatives are key values used to compute the surge force heave force and pitch moment in equations 33 35 fig 7 compares computations of force and moment values from the hydrodynamic force model with values obtained directly from the seakeeping code described in section 5 the code computes the force and moment output values by integrating pressure over the body surface these values for the several panel sizes in value 1 of table 3 vary within 1 of the output value for the smallest panel area of 0 00125 therefore only the panel code force and moment output values for panel area 0 00125 are plotted in fig 7 fig 7 a shows that the surge force computations plotted as dashed lines agree well with the force values output by the code which is plotted as a solid line the surge force computations for the various panel areas overlap indicating that surge force is barely affected by change in the given panel sizes fig 7 c shows that like surge force the effect of panel size on pitch moment computations is not significant with the largest discrepancies for the largest panel area a l b 2 0 005 as for heave force the computed values approach the values output by the code as panel area is decreased the computed values for the smallest panel area a l b 2 0 00125 agree well with the code output values ultimately the required accuracy of the model will determine the panel size used in the simulations noting that decreasing the panel size increases accuracy at higher computational cost moving on to the effect of free surface size on force computations using equations 33 35 the conditions in value 2 of table 3 are applied for a uniform panel area of a l b 2 0 00125 while free surface size is varied in order to vary free surface size distance to the downstream edge l d of the free surface is adjusted and the distance to the exterior l e is varied accordingly in order for the free surface to enclose the kelvin wave pattern that is generated with a half angle of approximately 20 distance to the upstream edge l u is fixed since it has negligible effect on force computations in calm water as shown in fig 8 surge force heave force and pitch moment on the body are computed at several forward speeds for varying surface sizes and the computations are compared to force and moment values output by the seakeeping code in section 5 the discrepancy in output values for free surface sizes at l d 1 5 l b and 2 l b are approximately 10 or less of the output values when l d 4 l b this discrepancy is negligible when compared to the discrepancies in the computed values therefore for simplicity only the panel code force and moment output values with free surface dimensions l u 1 5 l b l d 4 l b and l e 1 6 l b are plotted in fig 8 as shown in fig 8 b the heave force computations plotted as dashed lines agree well with the force values output by the code plotted as a solid line the heave force computations for the various free surface sizes overlap indicating that heave force is hardly affected by change in the given free surface sizes however as can be seen in fig 8 a and c there is an evident discrepancy in surge force and pitch moment decreasing the free surface size from l d 4 l b to l d 2 l b results in a large disparity between computations and output values of surge force and pitch moment for the highest speed fr 0 5 further decreasing the free surface size to l d 1 5 l b results in a large disparity for the two highest speeds fr 0 45 and 0 5 these results indicate that as free surface size is decreased the highest speeds with the longest wave lengths are affected first on the other hand increasing free surface size includes more wave cycles in the wave computations leading to more accurate computations but at a higher computational cost value 3 of table 3 shows the final set of simulation conditions for surge force heave force and pitch moment computation simulations are performed with the smallest panel area and largest free surface size the conditions that yield the most accurate computations for a spheroid traveling at various depths and speeds as shown in fig 9 force computations agree very well with force values output by the panel code as expected the absolute value of the forces and moment decrease as the body moves away from the free surface for the given range and scale of the plots using the same panel area a l b 2 0 00125 will yield satisfactory results for the various given depths on the other hand smaller panel areas will be required for smaller scale calculations at lower speeds or greater depths note that depth does not affect the number of wave cycles included in a given free surface size so free surface area does not have to be adjusted according to depth 7 conclusions and future work in this paper a lagrangian mechanical system model for a submerged vehicle maneuvering near a calm free surface is reformulated in order to compute model parameters in the special case of steady translation first the derivation of the control oriented lagrangian mechanical system model by battista 2018 is briefly reviewed then model terms are reformulated to allow computation of parameters using data that are readily available from the potential flow code the parameters expressed as integro differential functions of the velocity potential are then computed for a prolate spheroid in steady surge motion using a potential flow code that has been modified to output the necessary functions of the flow potential hydrodynamic force computations for the reformulated lagrangian model obtained using the modified potential flow software are then compared with computations obtained directly from the panel code the effect of computational parameters such as panel area and domain size are first examined and then the effect of depth the results confirm the proposed approach for model parameter computation subtleties arise in reformulating the original lagrangian mechanical system model concerned with swapping the order of integration and differentiation for the integro differential parameters and computing partial derivatives of the lagrangian function a numerical investigation illustrates the validity of the proposed approach to model parameter computation involving partial derivatives with respect to translational configuration variables for a body undergoing impulsive motions results show that terms computed using the proposed method agree well with numerical calculations output by a panel code in addition steady forces on a body moving at a constant forward speed parallel to a calm free surface derived from the reformulated model are compared to direct numerical computations the effect of panel area and free surface size variation on surge force heave force and pitch moment calculations is examined and the conditions that yield the most accurate results are used to study the effect of depth variation on forces results agree well in the range of fr 0 3 0 5 and depths z b l b 0 15 0 3 the reformulated model proposed in this work can further be applied to computation of unsteady forces on a submerged vehicle in unsteady flow due to steady or unsteady motion of the body in addition the total velocity potential in the reformulated model can be decomposed into physically meaningful impulsive and memory flow components the memory flow component can be approximated with a finite dimensional realization and the resulting parameters can be computed using the methods proposed in this paper to yield a model which can be used in model based nonlinear control design for submerged vehicles operating near a free surface credit authorship contribution statement seyong jung methodology software formal analysis investigation writing original draft stefano brizzolara methodology supervision writing review editing craig a woolsey conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the sponsorship of the u s office of naval research under grant numbers n00014 14 1 0651 and n00014 16 1 2749 the authors also thank navatek ltd for providing access and technical support for the seakeeping code aegir finally the authors thank drs f valentinis t battista and e g paterson as well as the anonymous reviewers for their many comments that helped improve this article nomenclature a panel area a arbitrary vector ao aegir output b body geometry vector b vehicle body c b rigid body coriolis and centripetal matrix c i impulsive coriolis and centripetal matrix c m memory coriolis and centripetal matrix d i impulsive damping matrix d m memory damping matrix e i unit vector with a 1 in the i th position e x unit vector along the x axis f arbitrary scalar function f fluid domain fdm finite difference method f h hydrodynamic force vector fr froude number g gravitational acceleration g transformation matrix hfm hydrodynamic force model j kinematic transformation matrix k m memory kernel matrix l b spheroid body length l d distance to downstream edge l e distance to exterior edge l u distance to upstream edge l l complete system lagrangian l f fluid lagrangian m b rigid body inertia matrix m b deeply submerged added mass matrix δ m b surface perturbed added mass matrix m i impulsive added mass matrix m m memory added mass matrix m s 0 undisturbed free surface added mass matrix n unit normal vector o origin of earth fixed frame o origin of body fixed frame q set of generalized coordinates q set of quasicoordinates q set of generalized forces r position of a point on a surface r s position of a point on s 0 relative to earth fixed frame s fluid domain surface s 0 undisturbed free surface t time t f fluid kinetic energy u forward speed v velocity of a point on a surface v translational velocity of body v absolute velocity of fluid boundary v f fluid potential energy x b position of body x b translational component of quasicoordinates η arbitrary intensive property θ b orientation of body θ b rotational component of quasicoordinates ν set of quasivelocities ρ water density φ velocity potential φ i impulsive flow potential φ k kirchhoff s potential φ m memory flow potential φ s free surface potential ϕ i normalized potential vector for impulsive flow ϕ k normalized kirchhoff s potential vector ϕ s normalized free surface potential vector ω rotational velocity of body a transformation matrices the kinematic transformation matrix j can be used to express the following relation q j θ b ν where 37 j θ b r θ b 0 0 l θ b in 37 the proper rotation matrix r θ b maps free vectors from the body fixed frame to the earth fixed frame by a 3 2 1 sequence using euler angles θ b φ b θ b ψ b t and can be explicitly expressed as r cos θ b cos ψ b sin φ b sin θ b cos ψ b cos φ b sin ψ b cos φ b sin θ b cos ψ b sin φ b sin ψ b cos θ b sin ψ b cos φ b cos ψ b sin φ b sin θ b sin ψ b sin φ b cos ψ b cos φ b sin θ b sin ψ b sin θ b sin φ b cos θ b cos φ b cos θ b similarly the transformation l θ b which converts the body angular velocity vector to the euler angle rates is defined as l θ b 1 sin φ b tan θ b cos φ b tan θ b 0 cos φ b sin φ b 0 sin φ b sec θ b cos φ b sec θ b now the transformation matrix g is expressed as follows based on the derivation described in schaub and junkins 2009 g i j k 1 n l 1 n m 1 n j k i j l m ν m j k j t q l j l j t q k here j i j is the i j element of the transformation matrix j in 37 matrix g can also be expressed in the following matrix form g q ν j t d d t j t q j ν t j t for the chosen kinematic transformation matrix j in 37 g ν ω ˆ 0 v ˆ ω ˆ where the hat operator ˆ represents the cross product equivalent matrix of a vector b divergence theorem the divergence theorem also known as gauss s theorem relates the flux of a vector field across a surface to the integral of the divergence over its interior for a closed region v bounded by a closed surface s if the vector field a is defined and continuously differentiable throughout v then v a d v s a n d s where n is a unit vector normal to s c differentiation under the integral sign rotation the differentiation with respect θ b can be derived as follows in fig 10 suppose that the body b undergoes rotational displacement for a small rotational displacement δ θ b of an element δ s of the surface b the points x of δ s sweep out a volume 38 δ v δ θ b r n δ s δ θ b r n δ s where r is the set of coordinates of a point on the body b in the body fixed frame if we multiply the above volume by a function f and sum the products over the entire surface b δ i b f δ θ b r n δ s we can conclude the following i θ b b f r n d s the resulting differential under the integral sign for a body undergoing rotational displacement is θ b f f θ b t d v f f θ b t θ b d v b f θ b t r n d s d relative displacement of a fluid particle rotation the equivalence relation for the relative displacement of the fluid particle at x for a small rotational displacement δ θ b of the body b is derived here the displacement of a point on the body surface b due to a small rotational displacement of the body is 39 δ θ b r δ θ b r z δ ψ b r y b 1 δ ψ b r x δ φ b r z b 2 δ φ b r y δ θ b r x b 3 where θ b φ b θ b ψ b t also the displacement of a fluid particle expressed in the body fixed frame is 40 δ x δ x b 1 δ y b 2 δ z b 3 therefore the equivalence relation between the displacement of the body b and the relative displacement of a fluid particle while fixing the body b is 41 δ θ b r δ x by using equations 39 and 40 42 δ θ b r z δ ψ b r y b 1 δ ψ b r x δ φ b r z b 2 δ φ b r y δ θ b r x b 3 δ x b 1 δ y b 2 δ z b 3 by applying the chain rule to an element of φ θ b φ φ b x φ b φ x y φ b φ y z φ b φ z and by applying the equivalence relation in equation 16 φ φ b x φ b φ x y φ b φ y z φ b φ z using equation 42 φ φ b r y φ z r z φ y the remaining elements of φ θ b can be derived through the same process therefore φ θ b φ φ b b 1 φ θ b b 2 φ ψ b b 3 r y φ z r z φ y b 1 r z φ x r x φ z b 2 r x φ y r y φ x b 3 b 1 b 2 b 3 r x r y r z φ x φ y φ z r φ x r φ e relative displacement of the undisturbed free surface rotation for relative rotational displacement instead of the body being displaced by δ θ b with a fixed undisturbed free surface boundary an equivalent relative displacement δ θ b can be applied to the undisturbed free surface while the body is fixed replacing δ θ b r n with δ θ b r n an element δ s of the undisturbed free surface s 0 sweeps out a volume δ v δ θ b r n δ s going through the same process as in appendix c θ b f f θ b t d v f f θ b t θ b d v s 0 f θ b t r n d s f derivation of steady pitch moment in the hydrodynamic force model 24 the normal derivative of the normalized potential vector for impulsive flow can be expressed as ϕ i n φ ν n where φ ν φ v φ ω following the procedure in section 4 2 2 and appendix d the moment component can be expressed as φ ω r φ v now we consider the position r of a point on the undisturbed free surface s 0 relative to the body fixed frame for translational motion of the body at steady velocity u parallel to the free surface the undisturbed free surface s 0 has a steady velocity of u relative to the body if we define r s as the position of a point on the undisturbed free surface s 0 with respect to the earth fixed frame r s does not depend on time since the earth fixed frame is fixed to the free surface then for initially coinciding x and y axes of the body and earth fixed frames r r s u 0 0 t this expression for r can be used to derive the following t φ ν 0 r t φ v 0 u 0 0 φ v 0 0 u φ w u φ v where v u v w t therefore the pitch component of the second term in the hydrodynamic force model 24 can be rewritten as ρ s 0 t φ ϕ i 5 n d s ρ s 0 φ u φ w n d s ρ s 0 φ u ϕ i 3 n d s this term cancels out with the term ρ g s 0 φ ϕ i n d s in the third row of the hydrodynamic force model 24 and therefore the pitch moment acting on a body in steady translational motion parallel to the free surface becomes m ρ b φ u n z d s ρ s 0 φ r z 2 φ x n r x 2 φ n 2 d s 1 2 ρ s 0 φ φ r z n x r x n z d s appendix asupplementary data the following is the supplementary data to this article multimedia component 1 appendix asupplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 108988 
20759,violent pulsating bubbles behave diversely in different circumstances it is a multi scale problem in both space and time in 3 d problems the numerical simulation is usually too expensive to implement in practice with a fixed grid in this paper a 3 d multi fluid model is established based on the eulerian finite element method and the adaptive mesh refinement technique to investigate the bubble evolution and its toroidal motion near a solid vertical wall the mixture formula for compressible multi fluid flow is adopted to ensure conservativeness by means of the block based adaptive mesh refinement the accuracy and the efficiency of the simulation are well balanced the present model is validated by comparing the results with an underwater explosion experiment and the existing numerical results the results agree well and a fast convergence is observed then several cases with different buoyancy parameters are simulated and the toroidal bubble motion and their pressure load on the solid wall are analyzed the bubble s motion exhibits complex physics such as the formation of the crescent shaped bubble the air cushion effect during the jet penetration and the nonlinear relationship between the jet impact pressure and the angle between the jet and the opposite bubble surface keywords bubble dynamics adaptive mesh refinement eulerian finite element method jet impact toroidal bubble 1 introduction the bubble dynamics has always been a significant aspect in the research of the fluid dynamics because of its various applications such as in underwater explosion cole 1948 klaseboer et al 2005 wang 1998 wang et al 2018 barras et al 2012 daramizadeh and ansari 2015 sea resources exploration li et al 2020 chelminski et al 2019 zhang et al 2019 biology dollet et al 2019 cavitation erosion and surface cleaning blake et al 1986 brennen 1995 chahine et al 2016 it is a typical multi scale transient and nonlinear problem with the large deformation of the multi fluid interface the complexity of the bubble motion will be further increased if a nearby structure is presented the boundary of the structure is usually assumed to be solid if it is rigid enough such as the copper propeller blade to a cavitation bubble or the concrete dam to an underwater explosion bubble as one of the pioneers in the field of bubble dynamics research rayleigh 1917 proposed the first practical equation describing the collapse of a spherical cavitation bubble in a free and perfect fluid field subsequently a lot of past work plesset and chapman 1971 prosperetti and lezzi 1986 contributed to improving the equation by including the other factors such as the compressibility of the surrounding fluid heat conduction viscosity and surface tension however researchers soon realized that the collapsing bubble did not maintain spherical due to the surface instability kornfeld and suvorov 1944 suggested that the non spherical motion of a collapsing bubble might produce a much higher pressure than a spherical one on a nearby solid boundary naude 1960 theoretically and experimentally validated this suggestion and found that the solid wall would contract the collapsing bubble to develop a high speed jet the bubble dynamics near a wall with different geometric shapes and material properties have renewed interest in the subject brujan et al 2018 and cui et al 2020 also implemented the experiments to study the interaction between a pulsating bubble and two solid joint walls their results show that the two walls compete to dominate the jet development and complex evolution features are observed chahine et al 2019 employed both experimental and numerical fluid structure interaction methods to investigate the cavitation bubble collapse near a solid wall with polymetric coating and found that the material property of the coating layer had a significant influence on the jet development and the impact pressure the boundary element method bem blake et al 1986 wang 1998 klaseboer et al 2006 2005 zhang and liu 2015 is one of the numerical methods that are first successfully used in the non spherical bubble dynamics simulation because it reduces the spatial dimensions by 1 this was a significant advantage over the other domain mesh methods in the late 20th century when the computational resources were minimal it is the boundary that needs to be discretized instead of the whole flow domain besides the far field condition is automatically satisfied such that the truncation error of the computational domain is avoided many researchers contributed to this field and made significant progress in the non spherical bubble dynamics simulation blake et al 1986 established an axisymmetrical model based on the bem to investigate a cavitation bubble collapsing nearby a solid wall wang et al 2005 extended the simulation to the toroidal bubble generated by the jet penetration by introducing a vortex ring inside the bubble this approach resolves the conflict between the potential theory used in the bem and the velocity circulation around the toroidal bubble when the solid wall s normal does not align with the gravity the problem is no longer axisymmetrical thus wang 1998 employed a 3 d numerical model based on the bem to investigate the jet development subject to the combined effects of an inclined wall and the buoyancy however the toroidal stage of the bubble is not included in this paper thus klaseboer et al 2005 combined the 3 d bem and the vortex ring model and simulated an underwater explosion bubble interacting with a vertical wall their results of the impact pressure were compared and agreed with the experimental results well furthermore zhang and liu 2015 improved the 3 d bubble dynamics model based on the bem to capture more deformation details of the toroidal bubble and it was adopted in liu et al 2016 where the influence of the free surface was included in the interaction between a bubble and the nearby solid wall it was found that the toroidal bubble might further break into two toroidal or a crescent shape bubble zhang et al 2015 liu et al 2016 because of the requirement of complex mesh manipulations for bubble split and merge introducing and removing vortex rings it is non trivial to implement in the 3 d bems the domain mesh methods for computational fluid dynamics have developed rapidly along with the growth of computational power however the interface treatments require special attention because the interface is usually not coincident with the cell boundaries in the cut cell method ye et al 2001 the interface cell cut by the moving interface and the irregular subcells are solved as normal cells however explicit tracking of the interface is required and special manipulations should be included to avoid small and narrow subcells with a proper implicit interface capture method e g the level set method fedkiw et al 1999 liu et al 2003 wang and shu 2010a the volume of fluid vof method so et al 2012 youngs 1982 hirt and nichols 1981 or the γ based method cheng et al 2020 the complex topology change of the collapsing bubble requires no special treatments and is no longer a difficulty besides suppose the euler equation describes the fluid flow and discretized in the numerical model in that case the fluid s compressibility is naturally considered while it is non trivial in the bems one significant challenge in these implicit interface capture methods is the conservativeness issue the level set method coupled with the ghost fluid method proposed by fedkiw et al 1999 solves two single medium problems with properly defined ghost cell states in which the conservativeness is not enforced a lot of efforts have been made to improve the conservativeness within the framework of the level set method and the ghost fluid method wang and shu 2010b liu et al 2021 by contrast the conservation in the mixture formula so et al 2012 murrone and guillard 2005 is trivial although a transition layer of several cells is required to represent the interface johnsen and colonius 2009 employed the quasi conservative interface capturing formula to investigate the non spherical bubble collapse beside a solid wall induced by a strong shock tian et al 2020b established an axisymmetric model based on the eulerian finite element method eulerian fem benson 1992a and investigated the jet development of an underwater explosion bubble and its impact on a solid horizontal wall another difficulty in the pulsating bubble simulation is that the computation is expensive if the compressibility of the surrounding fluid is considered a large number of time increments are required due to the courant friedrichs lewy cfl condition when it comes to a fully 3 d simulation the unknown degrees of freedom dof in the domain mesh methods dramatically increases to an impractical level especially in the multi scale bubble pulsating problem thus an adaptive mesh refinement amr technique is essential to reduce the dofs by coarsening the local mesh where the solution is not important and has little influence on the global solution the patch based amr first introduced by berger and colella 1989 proposed have been widely used in cfd codes such as the boxlib amroc and chombo in 3 d block based amr a set of non overlapping boxes is find to cover the region requiring refinement these boxes have meshed with higher resolution than the base mesh the results calculated with the coarser mesh is mapping to the finer one to provide it a ghost boundary while the results obtained in the finer mesh with this boundary is projected back to the coarse one another approach to the amr is the block based amr macneice et al 2000 olson and macneice 2005 in which each block is a box with the same data structure and they are refined based on the oct tree algorithm one or more layers of guardcells are attached to each block s outside boundary and their data is copied from the adjacent blocks for communication in the present paper the eulerian fem is adopted to resolve the motion of a pulsating bubble we use the block based amr implemented with the open source package paramesh macneice et al 2000 olson and macneice 2005 such that the efficiency and accuracy can be balanced in simulating the bubble pulsation and toroidal motion the rest of the present paper is organized as follows in section 2 the underlying theory and numerical techniques are presented relating to the eulerian fem and the amr implementation then the numerical model is validated by comparing it with an underwater explosion experiment in section 3 in section 4 several cases of a high pressure bubble moving beside a vertical wall are simulated and analyzed with the present model the results are also compared with the bem to verify the accuracy at last some conclusions are drawn in section 5 2 theoretical method and numerical models 2 1 problem description and basic equations in this work the bubble dynamics near a vertical wall is concerned initially place the bubble in the undisturbed water at a depth of h with a higher pressure of the internal gas than that of the ambient water a solid vertical wall is located with a distance of d from the center of the initial bubble this problem is abstracted from the underwater explosion bubble near a submerged structure or a vertical dam and has been studied both experimentally and numerically the detonation process is usually much shorter than the bubble motion thus it is reasonable to assume that the fluid flow is initially at rest the internal gas and the surrounding liquid forms a multi fluid riemann problem because of the pressure difference across the bubble interface then the bubble starts expanding with the contact discontinuity moving outwards if the solid wall is absent the bubble s motion can be roughly described by the rayleigh plesset equation and a multi cycle pulsation will occur in the pulsating bubble problems the multi fluid interface usually experiences great deformation for example the maximum radius of an underwater explosion bubble can be as large as dozens of times of the initial one such that the conservative error is amplified significantly thus the mixture formula for the multi fluid problem is adopted for its natural advantages in conservativeness assuming that all the fluid components share a single pressure within a cell the euler equations with the mixture formula so et al 2012 for the multi fluid system are 1 α i t α i u α i κ κ i u α i ρ i t α i ρ i u 0 ρ u t ρ u u ρ g p α i ρ i e i t α i ρ i e i u α i κ κ i p u 0 where α is the volume fraction bounded by 0 and 1 ρ is the density u u 1 u 2 u 3 is the material velocity e represents the unit material s internal energy κ ρ c 2 is the bulk module of fluid with c representing the sound speed and g is gravity the subscript i indicates a variable of the fluid i is the tensor product operator and the bar over a variable represents an average quantity of the mixture fluid the factor of α i κ κ i in the first and fourth equations is included to consider the compressibility difference of the fluid components in the mixture note that only α 1 is required to be solved and α 2 is then recovered with the fact that α 1 α 2 1 for the fluid mixed by fluid 1 and fluid 2 the average density and bulk module are determined by 2 ρ α 1 ρ 1 α 2 ρ 2 and 3 κ κ 1 κ 2 α 1 κ 2 α 2 κ 1 with the assumption that the two fluids share the same pressure besides the sound speed of the mixture can be recovered by the relationship of 4 κ ρ c 2 which can be used for any equation of state eos with an explicitly written sound speed for compressible fluids the eos of each fluid is required to close the euler equations in this paper the tammann eos ivings et al 1998 is chosen to model the surrounding water of the bubble in the following form 5 p ρ e γ 1 γ p w with the sound speed given by 6 c 2 p p w ρ γ where γ and p w are constants that taken as 7 15 and 330 9 mpa when p w is 0 eq 5 degrades to the ideal gas eos 7 p ρ e γ 1 which is used to model the internal gas of the bubble with γ 1 25 klaseboer et al 2005 zhang and liu 2015 2 2 eulerian fem with operator split the eulerian fem liu et al 2018 2019 tian et al 2020b is used to solve eq 1 to investigate the dynamics of a bubble beside a vertical solid wall firstly we rewrite eq 1 in the vector form 8 e t u e e u s where the vectors e and s are given by e α i α i ρ i ρ u α i ρ i e i s α i κ κ i u 0 ρ g p α i κ κ i p u then the operator split technique is employed to split eq 8 into 9 d e d t e u s and 10 e t d e d t u e eq 9 is based on the lagrangian perspective and the material moves along with the mesh thus we can apply the traditional explicit fem to eq 9 wu and gu 2012 then eq 10 is solved by remapping the conservative vector e between the deformed mesh and the original mesh the solution of these two equations corresponds to the lagrangian stage and eulerian stage respectively the operator split technique makes the combination method consider both stability and robustness especially suitable for the intense bubble movement with a large density ratio at the interface typically it has the second order of accuracy in space and the first order of accuracy in time we explain the basic equations and the detailed numerical techniques used in these two stages in the following subsections 2 2 1 lagrangian stage the mesh moves with the fluid material in the lagrangian stage in this paper the momentum equation in the lagrangian stage is solved only once for both of the two fluid components with the mixture fluid technique and the explicit fem benson 1992a wu and gu 2012 plugging the conserving equation of mass into the conserving equation of momentum in eq 9 we can obtain 11 ρ d u d t ρ g p let us discretize the computational domain into cells and denote φ p as the shape function for node p then we can express the solution by u φ q u q herein the superscript q represent node q s variable and the einstein summation convention is used multiply eq 11 by the shape function φ p and integrate it over the computational domain ω we can derive the semi discretized form of eq 11 as 12 ω φ p φ q ρ d v d u q d t ω p n ˆ φ p d s ω ρ g φ p p φ p d v where ω represents the boundary of the computing domain ω and n ˆ is its outward pointing unit vector we can rewrite eq 12 in the matrix form 13 m a f where m ω φ p φ q ρ d v is the mass matrix a d u q d t is the nodal acceleration matrix f is the matrix of nodal force corresponding to the right hand side of eq 12 the velocity and displacement of the nodes are subsequently updated with the new acceleration calculated then the other conservative quantities are updated with corresponding equations extracted from eq 9 14 d α i d t α i κ κ i 1 u 15 d ρ i d t ρ i κ κ i u and 16 d ρ i e i d t p ρ i e i κ κ i u the time increment in this paper is calculated with 17 δ t cfl min l e c u u 1 min where l e is the minimum size of the element and cfl is a fixed scale factor which is 0 5 in this paper and the superscript min is the minimization operator performed among all the elements in the computational domain the second part in the min operator is used to prevent the negative volume during one time increment 2 2 2 eulerian stage in the operator split procedure the fluid material and computational mesh are advanced together in the lagrangian stage for a whole time increment following which an eulerian stage is implemented in this stage the physical time is not advanced and only a conservative remapping procedure is performed by calculating the advection between adjacent cells with the following steps 1 reconstruct medium interface in multi fluid cells using the plic piecewise linear interface construction algorithm youngs 1982 benson 1992a by denoting the coordinate vector x x y z the linear interface can be expressed by a plane equation 18 n x b 0 to obtain the normal vector n a quadratic function f x k r is constructed by fitting the volume fraction α around the current cell with the least square method tian et al 2020a herein r x x 2 y 2 z 2 x y y z x z x y z 1 t is a complete set of the basis vector in the 3 d quadratic space k k 1 k 2 k 10 t is the coefficient vector obtained by solving the following linear system 19 k a 1 j 1 27 r x j α j where the summation runs over the current cell and its immediate neighbors i e the 3 3 3 mesh block around the current cell x j is the cell center coordinate and a r r if a uniform mesh is used in the simulation and a dimensionless local coordinate system is established with its origin locating at the current cell center the inverse of the matrix a can be calculated once and stored for the use thereafter to simplify the calculation then the normal vector can be approximated by n f f and the constant b in eq 18 can be obtained by an iterative method with the fact that the volume of the cell cut by the interface is α δ x 3 2 according to the nodal velocity and the constructed interface advect the fluid volume geometrically for each medium with proper rotating manipulation we may encounter with the five basic geometry configurations as shown in fig 1 this step is trivial and the readers can refer to benson 1992b 3 use muscl monotone upwind scheme of conservation law benson 1992a to advect the element s mass and internal energy 4 convect the node centered momentum using the his half index shift algorithm proposed by benson 1992b in this paper the muscl is used instead of the first order donor acceptor scheme to advect the 8 auxiliary cell centered variables constructed for the 8 nodes such that the second order accuracy is achieved 5 based on the new density and internal energy the cell pressure is calculated with the eos and the new time increment is calculated with the sound speed note that a pressure equilibrium is required to eliminate the pressure difference between the two fluid components within a cell in this paper the internal energy is exchanged between the two fluids with the following equations to achieve the pressure equilibrium 20 ρ e 1 ρ e 1 1 α 1 δ ρ e 21 ρ e 2 ρ e 2 1 α 2 δ ρ e where δ ρ e α 1 α 2 δ p α 2 p 1 ρ e 1 α 1 p 2 ρ e 2 herein the superscript represents the values before the pressure equilibrium δ p p 1 p 2 is the pressure difference and p ρ e can be calculated with eos easily 6 go to the next time increment and start a new lagrangian stage 2 3 adaptive mesh refinement for a fully 3 d simulation of an oscillating bubble the amr is essential to reduce the computational complexity to a reasonable scale the open source package paramesh olson 2006 macneice et al 2000 is adopted and modified in the present paper to archive the amr because of its flexibility paramesh is a block based amr package that manages the mesh refinement procedure and processor communications with the message passing interface each block has the same data structure allowing the users to connect the paramesh and an existing serial and non amr solver with minor modifications to simplify the demonstration fig 2 shows a 2 dimensional block in the paramesh the cells in the yellow color are the real ones to be solved with the eulerian finite element method while the blue cells on each edge of the block are the guardcells providing boundary conditions for the real ones paramesh communicates between adjacent blocks and the conservative quantities of the guardcells are interpolated from the overlapped cells of the neighboring blocks at the beginning of each time increment in this paper the block dimension is taken as 8 8 8 and 2 additional layers of guardcells are used as shown in fig 3 the real cells of 2 blocks are adjacent to each other and the guardcells of one block overlap with the real cells from the other one at the beginning of each time increment the state variables of the real cells are inherited from the previous increment but those of the guardcells are taken from the corresponding real cells of the adjacent block if the two blocks are in the same refinement level the guardcell filling procedure is straightforward as shown in fig 3 otherwise conservative restriction and prolonging procedures are required as shown above in the present numerical model the fluid velocity is a nodal vector however the velocity at nodes shared by different blocks could be inconsistent which will lead to pressure fluctuation near the intersection of fine and coarse blocks thus a few modifications are made as follows to fill the guardcell s nodal velocities in the paramesh 1 if a block s neighbor is in the same refinement level the velocities of the nodes on the shared face are overridden as the algebraic average of the velocities from both sides 2 if a block s neighbor is a finer block the nodal velocities on the shared face are overridden as the velocities from the neighbor block 3 if a block s neighbor is a coarse one the nodal velocities on the shared face remain unchanged with the modifications above the nodal velocities on the shared block faces are enforced to be consistent by choosing proper constant parameters for the refinement i e the maximum refinement level l max the minimum refinement level l min the pressure difference thresholds s u and s d all the blocks are labeled based on the following criterion 1 if α max α min in the current block is greater than a prescribed small constant s c it is labeled as an interface block and requires refinement herein α max and α min are the maximum and minimum values of the volume fractions among all the fluid components in the current cell and s c is taken as 1 0 9 2 if the maximum spatial difference of the pressure p is greater than s u then the current block is labeled as a critical block which requires refinement 3 if the maximum spatial difference of p in the current block is smaller than s d and it has no neighbor in a higher refinement level than itself it is labeled as a block that requires de refinement after the labeling process the refinement and de refinement are implemented iteratively such that the new refinement level is bounded by l max and l min and the refinement level difference between 2 adjacent blocks does not exceed 1 2 4 non dimensionalization and initial conditions it is necessary to write all the physical variables in the non dimensional form to obtain a consistent numerical accuracy in different simulations following the previously published papers zhang and liu 2015 klaseboer et al 2005 in bubble dynamics we chose the maximum radius of the bubble r m the fluid density ρ f and the undisturbed pressure at the same depth in the bubble center p p a t m ρ f g h as the variable scales for the non dimensionalization of length density and pressure and the scales of the other variables can be calculated correspondingly in table 1 these quantity scales are listed together with these characteristic quantities the initial conditions of the bubble can be given non dimensionally by the strength parameter ϵ p 0 p the distance parameter γ w d r m and the buoyancy parameter δ 2 ρ f g r m p herein d represents the distance from the solid wall to the explosive charge 2 5 computational domain setup a hexahedral domain of 0 5 r m 0 5 r m 5 r m 5 r m is chosen to discretize the flow domain around the bubble as shown in fig 4 the initial bubble center is at γ w r m 0 0 the six faces of the computational domain are denoted as faces a to f faces c and f are impenetrable and all the other faces are the truncation boundaries of the computational domain to minimize the spurious reflection of the truncation boundary the non reflecting boundary condition based on the spherical wave assumption liu et al 2018 is applied on face a b d and e the computational domain is sized by 5 r m 5 r m 10 r m and consists of two base blocks typically face f represents the solid wall and one half of the computational domain is simulated with the symmetry plane y 0 however if γ w is set to 0 face f turns to a symmetry plane and the problem imitates the one fourth fluid field of a bubble moving in the free field 3 model validation with underwater explosion experiment to verify the established numerical scheme we conducted an underwater explosion experiment in a water tank sized by 4 m 4 m 4 m a high speed camera is used to capture the images of the underwater explosion process due to the strong shock load of the underwater explosion it is a non trivial task to set up a hard enough boundary in an experiment when studying the interaction of an underwater explosion bubble and a nearby fixed solid wall thus we use two identical explosives detonating at the same depth to mimic the situation of one underwater explosion near a solid wall this can be justified with the mirror theory which has been used by wang 1998 and liu et al 2016 to investigate the bubble dynamics near a solid wall the two charges of 10 g hexogen explosives are placed horizontally with a distance of 0 68 m and a depth of 1 85 m the maximum radius of the bubble is 0 34 m which corresponds to a case of a bubble moves beside a solid vertical wall with a buoyancy parameter δ 0 0277 and a distance parameter γ w 1 0 the nearest boundary is about 1 36 m away from the bubble such that the boundary effect can be ignored in the simulation the initial conditions are taken as ϵ 572 and δ 0 0277 with the method proposed by klaseboer et al 2005 the lowest refinement level is set to 3 and the highest refinement level is set to 6 thus the finest cell size is 6 6 mm and there are 102 cells across the maximum perimeter of the bubble the comparison of the present results and the experiment are shown in fig 5 it can be seen that the numerical results agree with the experimental ones well in the sense of bubble evolution the two bubbles expand and collapse simultaneously which offsets the induced velocity at the x direction on the plane x 0 thus the bubble motion is identical to that besides a solid wall of x 0 during the collapsing phase the two bubbles are attracted by each other because of the bjerknes force a high pressure region emerges near each bubble which drives it to develop a liquid jet towards the other bubble as shown in fig 3 c and d when t 66 3 ms the two bubbles are penetrated by the liquid jets and form two toroidal bubbles 4 results and discussion 4 1 general features of a bubble collapsing beside a solid wall in this section the present numerical results are compared with the bem results presented by wang 1998 the case shown in fig 16 in wang 1998 is chosen of which the initial conditions are ϵ 100 δ 0 5 and γ w 1 0 it should be noted that a greater initial radius of the bubble is adopted in this paper than that used in the bem the reason is that the model includes the surrounding fluid s compressibility causing the energy dissipation through the outgoing pressure waves to archive the same maximum radius of 1 the initial radius must be greater it was obtained by backward integrating the rayleigh plesset equation from the maximum radius wang 2014 however because the rayleigh plesset equation does not consider the discontinuous shock at the beginning of the expansion it can only give a set of initial conditions that the bubble is initially expanding at a certain velocity which is not applicable in this paper thus we take several simulations with the 1 dimensional eulerian fem to obtain the proper initial radius iteratively and r 0 0 2 is used in the following simulations in this case buoyancy significantly affects the bubble evolution because of the great buoyancy parameter δ it corresponds to an underwater explosion bubble with r m 20 m at a depth of 40m if the gravity acceleration is approximated by 10 m s 2 although it is not quite practical for such a great bubble we chose this case because the buoyancy effect is comparable to that of the solid wall which leads to a complex evolution behavior of the bubble 4 2 comparison with bem results and convergence test as shown in wang 1998 the bubble develops a high speed jet under the combined effect of the solid wall and buoyancy during its collapsing phase in fig 6 the fluid fields on the x o z plane at t 0 976 1 873 and 2 207 are shown with the color contours represent the pressure field and the solid black curves indicate the bubble profiles the maximum refinement level l max is taken as 6 here with the parallelization accomplished with the mpi message passing interface the simulation takes 16 h on a desktop with an intel i7 9700 4 threads are used here cpu and 32 gb ram a region of high pressure forms beneath the bubble which drives it to develop an inward jet because of the existence of the solid wall the high pressure region deviates to the right side which deflects the jet towards the wall the profiles at the same time are extracted from wang 1998 and plotted as red crosses in fig 6 for comparison the results agree well with each other which validates the present model to demonstrate the convergence of the present model fig 7 compares the bubble profiles at t 2 207 on the x o z plane simulated with the maximum refinement level l max 6 5 and 4 respectively it shows that the result is poor with l max 4 where the finest cell size is about 0 078 and is relatively coarse compared with the initial radius r 0 0 2 with l max increased to 5 the results are improved significantly and the bubble profile is very close to that with l max 6 which indicates that the present model converges quickly with the increase of l max 4 3 crescent shaped bubble after jet penetration with the present model we further simulate the bubble motion after the jet penetration as shown in fig 8 we can see that after the bubble reaches its maximum radius at t 0 976 a wide jet develops from the bottom of the bubble due to the combined effects of the buoyancy and bjerknes force caused by the solid wall the bubble jet is obviously wider in the y direction than that in the x direction at t 2 386 the jet penetrates the bubble at its inclined top close to the solid wall and turns the bubble into toroidal shape it should be noted that the lower part of the inclined toroidal bubble is much thinner than the rest due to the bias of the jet with the bubble continue collapse a new toroidal bubble develops upward from the vortex eye due to the upward velocity of the water jet these two toroidal bubbles connect and the internal gas is transported from the old lower one to the new upper one their total volume reaches the minimum value at t 2 541 and starts rebounding then both bubbles break at the thinnest parts and turn crescent shaped which has seldom been investigated before it is non trivial to simulate the jet penetration break into two toroidal bubbles and further break into two crescent shaped bubbles with the bems requiring complex manipulations such as the surface remesh vortex ring placement and removal fig 9 shows the pressure histories at three locations on the solid wall at p 1 0 0 0 and p 3 0 0 1 25 the pressure curves are relatively smooth and no obvious jet impact pressure is observed by contrary a sharp increase can be seen on the pressure history curve at p 2 0 0 1 25 when the jet penetrates the bubble as shown in fig 9 d the reason is that the jet impact pressure mostly propagates in the jet s direction and the points p 1 and p 3 are not in the impact region usually the abrupt change of flow domain topology would lead to impact pressure in the surrounding flow however only a weak fluctuation can be seen from the pressure history of point p 3 the reason can be attributed to the circular velocity based on the vortex ring theory of a toroidal bubble wang et al 2005 the velocity circulation around every toroid section should be the same and keep constant as long as the topology of the flow domain remains unchanged theoretically it should be proportional to the inverse of the cross section perimeter if the size of the cross section varies along the toroid circle the circular velocity around the thinnest section can be as high as infinity before it breaks which leads to a great centrifugal force of the fluid slowing the impact process so that the toroidal bubble breaks smoothly 4 4 evolution of inclined toroidal bubble with different buoyancy parameters based on the previous section the buoyancy parameter δ is changed to 0 25 and 0 1 respectively which are more practical for the corresponding engineering cases the other initial conditions and the computational setup remain the same in fig 10 the pressure field around the bubbles which drive them to develop the liquid jets are shown by iso pressure surfaces and the bubble are shown with the green surfaces we can see that with the increase of the buoyancy parameter from 0 1 to 0 5 the pressure peak decrease significantly from 6 to 1 5 as a result the jet speed also decreases from 5 8 to 2 3 while the width is getting greater this phenomenon is attributed to the effective developing time of the jet with a higher buoyancy parameter the jet develops earlier during the collapse of the bubble which also leads to an earlier penetration time as a result the jet is not well developed and the speed is slower when it penetrates the bubble after the jet impact the bubbles are penetrated and turn into toroidal the evolution of the toroidal bubbles with δ 0 25 at t 2 308 2 370 2 442 and 2 595 are shown in fig 11 respectively it is found that the evolution process differs from the case with δ 0 5 shown in the section 4 3 significantly compared with the previous case the diameter of the jet cross section on the x o z plane is much smaller such that the cross section tends to be a circle rather than an ellipse shape with smaller buoyancy effects thus the part of the toroidal bubble close to the wall has the maximum cross section along the toroid it has been shown by klaseboer et al 2005 that the direction of the liquid jet tilted upwards initially will shift more and more perpendicular to the solid wall which was attributed to the growing attraction effect from the solid wall as the center of the bubble rushes to the wall from the theoretical view it can also be explained with the mirror theory we can simulate the effect of the solid wall on a toroidal bubble by using an imaginary mirror bubble on the other side as shown in fig 12 the velocity circulation caused by the imaginary bubble leads to a downward induced velocity around the real bubble the induced velocity decays along with the distance from the imaginary bubble thus the fluid flow around the real bubble tends to be rotated anticlockwise as a result the jet direction shifts to the solid wall and the cross section of the toroidal bubble close to the solid wall diminishes while the cross section away from the wall is enlarged during the shift of the jet direction this also explains why the toroidal bubble hardly breaks into a crescent shape from the part away from the wall fig 13 shows the pressure field on the solid wall generated by the toroidal bubble at the same times presented in fig 11 we can see that the pressure on the solid wall before the jet penetration only varies from 2 to 2 6 because the jet forms from the bubble surface away from the solid wall when the jet penetrates the bubble a high pressure region emerges around y z 0 0 8 where the jet is pointing because of the angle between the directions of the jet and the normal of the solid wall is quite large the impact pressure is only 8 at this time and reaches 26 at t 2 442 when the jet is fully developed then the jet pressure drops to 5 as the bubble rebounds when the buoyancy parameter δ decreases to 0 1 the evolution of the toroidal bubble after the jet penetration is shown in fig 14 it can be seen that the attraction of the solid wall dominates the motion of the bubble while the buoyancy is so small that the direction of the jet is almost perpendicular to the solid wall with a little inclination upwards similar to the axisymmetrical problems presented by tian et al 2020b and wang et al 2005 the necking effect and the bubble volume transportation from the old toroidal bubble to the new one are observed fig 15 shows the impact pressure on the solid wall caused by the collapsing bubble at the same times shown in fig 14 we can see that the impact pressure emerges even before the penetration at t 2 342 which means that the gas layer between the jet tip and the opposite bubble surface can transmit great pressure when they are close enough to each other this phenomenon is similar to the air cushion effect in the high speed water entry problem it violates the uniform pressure assumption of the internal gas used in the bems and gives more reliable results the jet impact pressure rises quickly after the penetration and then decays with the rebound of the toroidal bubble to quantitatively compare the bubble loads caused by the jets with different buoyancy parameters the pressure histories at the jet impact points on the solid wall are drawn together in fig 16 the bubble pulsating load decreases with the increase of the buoyancy parameter the reason is that with a greater buoyancy parameter the jet is better developed with a greater diameter and a higher speed at the same time thus more energy of the system transfers to the surrounding fluid s kinetic energy such that the residual energy to suppress the bubble and generate the pulsating load is less this can be justified by comparing the minimum volumes of the bubbles as shown in table 2 the minimum volume of the bubble with δ 0 5 is the greatest among the 3 cases and its pulsating pressure is the minimum in the case with δ 0 25 the pressure history is relatively smooth and no obvious sharp increase is observed which indicates that the jet penetrates the bubble moderately the velocity field at the moment of the jet penetration is shown in fig 17 it can be seen that the direction of the jet velocity is almost parallel to the opposite bubble surface at the first impact point thus the relative velocity at the normal direction is small such that the penetration is a mild process as for the case with the smallest buoyancy parameter δ 0 1 the pressure peak of the bubble load is almost twice of that with δ 0 25 although they have similar minimum volumes it is attributed to the jet impact pressure on the solid wall in this case the jet has a higher speed and its direction is almost perpendicular to the opposite bubble surface such that the impact pressure is maximized 5 conclusions based on the eulerian fem this paper establishes a 3 d model to investigate the bubble evolution near a solid wall numerically the block based amr technique is adopted to reduce the computational cost while maintaining the accuracy near the multi fluid interface an underwater explosion experiment is implemented to validate the numerical model the convergence is demonstrated by comparing the present results using different mesh sizes with those obtained with the bem through the simulation and the analysis of several cases with different buoyancy parameters the following conclusions are drawn 1 both the evolution of the single connect bubble before the jet penetration and the multi connect bubble are dominated by the joint effects of the buoyancy and the solid wall their balance determines the dynamic features of the bubble and its hydrodynamic pressure on the solid wall 2 the direction of the tilted jet will shift towards the solid wall gradually during the collapse of the toroidal bubble after the jet penetration which can be explained with the mirror theory and attributed to the velocity circulation caused by the imaginary toroidal bubble the toroidal bubble may further break into a crescent shape if the buoyancy is strong enough the cross section of the toroidal bubble is thinner at the part close to the solid wall due to the buoyancy such that the toroidal bubble breaks from here when the jet shifts downwards 3 the air cushion effect is observed between the jet tip and the opposite bubble surface before the jet impact and it causes the solid wall to experience the impact pressure in advance of the penetration 4 the penetration of the bubble by the jet may generate an impact pressure on the nearby wall depending on the jet speed and direction when the jet velocity is perpendicular to the opposite bubble surface the impact pressure is maximized credit authorship contribution statement zhao li tian writing original draft formal analysis a man zhang conceptualization methodology yun long liu funding acquisition writing review editing longbin tao writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china grant numbers 51879050 and 52088102 the china postdoctoral science foundation grant numbers 2016m600244 and 2018t110271 and the heilongjiang postdoctoral fund china grant numbers lbh z20131 lbh tz07 the authors would like to acknowledge doc nian nian liu for the help in implementing the experiment the paramesh used in this work was developed at the nasa goddard space flight center and drexel university under nasa s hpcc and esto ct projects and under grant nng04gp79g from the nasa aisr project 
20759,violent pulsating bubbles behave diversely in different circumstances it is a multi scale problem in both space and time in 3 d problems the numerical simulation is usually too expensive to implement in practice with a fixed grid in this paper a 3 d multi fluid model is established based on the eulerian finite element method and the adaptive mesh refinement technique to investigate the bubble evolution and its toroidal motion near a solid vertical wall the mixture formula for compressible multi fluid flow is adopted to ensure conservativeness by means of the block based adaptive mesh refinement the accuracy and the efficiency of the simulation are well balanced the present model is validated by comparing the results with an underwater explosion experiment and the existing numerical results the results agree well and a fast convergence is observed then several cases with different buoyancy parameters are simulated and the toroidal bubble motion and their pressure load on the solid wall are analyzed the bubble s motion exhibits complex physics such as the formation of the crescent shaped bubble the air cushion effect during the jet penetration and the nonlinear relationship between the jet impact pressure and the angle between the jet and the opposite bubble surface keywords bubble dynamics adaptive mesh refinement eulerian finite element method jet impact toroidal bubble 1 introduction the bubble dynamics has always been a significant aspect in the research of the fluid dynamics because of its various applications such as in underwater explosion cole 1948 klaseboer et al 2005 wang 1998 wang et al 2018 barras et al 2012 daramizadeh and ansari 2015 sea resources exploration li et al 2020 chelminski et al 2019 zhang et al 2019 biology dollet et al 2019 cavitation erosion and surface cleaning blake et al 1986 brennen 1995 chahine et al 2016 it is a typical multi scale transient and nonlinear problem with the large deformation of the multi fluid interface the complexity of the bubble motion will be further increased if a nearby structure is presented the boundary of the structure is usually assumed to be solid if it is rigid enough such as the copper propeller blade to a cavitation bubble or the concrete dam to an underwater explosion bubble as one of the pioneers in the field of bubble dynamics research rayleigh 1917 proposed the first practical equation describing the collapse of a spherical cavitation bubble in a free and perfect fluid field subsequently a lot of past work plesset and chapman 1971 prosperetti and lezzi 1986 contributed to improving the equation by including the other factors such as the compressibility of the surrounding fluid heat conduction viscosity and surface tension however researchers soon realized that the collapsing bubble did not maintain spherical due to the surface instability kornfeld and suvorov 1944 suggested that the non spherical motion of a collapsing bubble might produce a much higher pressure than a spherical one on a nearby solid boundary naude 1960 theoretically and experimentally validated this suggestion and found that the solid wall would contract the collapsing bubble to develop a high speed jet the bubble dynamics near a wall with different geometric shapes and material properties have renewed interest in the subject brujan et al 2018 and cui et al 2020 also implemented the experiments to study the interaction between a pulsating bubble and two solid joint walls their results show that the two walls compete to dominate the jet development and complex evolution features are observed chahine et al 2019 employed both experimental and numerical fluid structure interaction methods to investigate the cavitation bubble collapse near a solid wall with polymetric coating and found that the material property of the coating layer had a significant influence on the jet development and the impact pressure the boundary element method bem blake et al 1986 wang 1998 klaseboer et al 2006 2005 zhang and liu 2015 is one of the numerical methods that are first successfully used in the non spherical bubble dynamics simulation because it reduces the spatial dimensions by 1 this was a significant advantage over the other domain mesh methods in the late 20th century when the computational resources were minimal it is the boundary that needs to be discretized instead of the whole flow domain besides the far field condition is automatically satisfied such that the truncation error of the computational domain is avoided many researchers contributed to this field and made significant progress in the non spherical bubble dynamics simulation blake et al 1986 established an axisymmetrical model based on the bem to investigate a cavitation bubble collapsing nearby a solid wall wang et al 2005 extended the simulation to the toroidal bubble generated by the jet penetration by introducing a vortex ring inside the bubble this approach resolves the conflict between the potential theory used in the bem and the velocity circulation around the toroidal bubble when the solid wall s normal does not align with the gravity the problem is no longer axisymmetrical thus wang 1998 employed a 3 d numerical model based on the bem to investigate the jet development subject to the combined effects of an inclined wall and the buoyancy however the toroidal stage of the bubble is not included in this paper thus klaseboer et al 2005 combined the 3 d bem and the vortex ring model and simulated an underwater explosion bubble interacting with a vertical wall their results of the impact pressure were compared and agreed with the experimental results well furthermore zhang and liu 2015 improved the 3 d bubble dynamics model based on the bem to capture more deformation details of the toroidal bubble and it was adopted in liu et al 2016 where the influence of the free surface was included in the interaction between a bubble and the nearby solid wall it was found that the toroidal bubble might further break into two toroidal or a crescent shape bubble zhang et al 2015 liu et al 2016 because of the requirement of complex mesh manipulations for bubble split and merge introducing and removing vortex rings it is non trivial to implement in the 3 d bems the domain mesh methods for computational fluid dynamics have developed rapidly along with the growth of computational power however the interface treatments require special attention because the interface is usually not coincident with the cell boundaries in the cut cell method ye et al 2001 the interface cell cut by the moving interface and the irregular subcells are solved as normal cells however explicit tracking of the interface is required and special manipulations should be included to avoid small and narrow subcells with a proper implicit interface capture method e g the level set method fedkiw et al 1999 liu et al 2003 wang and shu 2010a the volume of fluid vof method so et al 2012 youngs 1982 hirt and nichols 1981 or the γ based method cheng et al 2020 the complex topology change of the collapsing bubble requires no special treatments and is no longer a difficulty besides suppose the euler equation describes the fluid flow and discretized in the numerical model in that case the fluid s compressibility is naturally considered while it is non trivial in the bems one significant challenge in these implicit interface capture methods is the conservativeness issue the level set method coupled with the ghost fluid method proposed by fedkiw et al 1999 solves two single medium problems with properly defined ghost cell states in which the conservativeness is not enforced a lot of efforts have been made to improve the conservativeness within the framework of the level set method and the ghost fluid method wang and shu 2010b liu et al 2021 by contrast the conservation in the mixture formula so et al 2012 murrone and guillard 2005 is trivial although a transition layer of several cells is required to represent the interface johnsen and colonius 2009 employed the quasi conservative interface capturing formula to investigate the non spherical bubble collapse beside a solid wall induced by a strong shock tian et al 2020b established an axisymmetric model based on the eulerian finite element method eulerian fem benson 1992a and investigated the jet development of an underwater explosion bubble and its impact on a solid horizontal wall another difficulty in the pulsating bubble simulation is that the computation is expensive if the compressibility of the surrounding fluid is considered a large number of time increments are required due to the courant friedrichs lewy cfl condition when it comes to a fully 3 d simulation the unknown degrees of freedom dof in the domain mesh methods dramatically increases to an impractical level especially in the multi scale bubble pulsating problem thus an adaptive mesh refinement amr technique is essential to reduce the dofs by coarsening the local mesh where the solution is not important and has little influence on the global solution the patch based amr first introduced by berger and colella 1989 proposed have been widely used in cfd codes such as the boxlib amroc and chombo in 3 d block based amr a set of non overlapping boxes is find to cover the region requiring refinement these boxes have meshed with higher resolution than the base mesh the results calculated with the coarser mesh is mapping to the finer one to provide it a ghost boundary while the results obtained in the finer mesh with this boundary is projected back to the coarse one another approach to the amr is the block based amr macneice et al 2000 olson and macneice 2005 in which each block is a box with the same data structure and they are refined based on the oct tree algorithm one or more layers of guardcells are attached to each block s outside boundary and their data is copied from the adjacent blocks for communication in the present paper the eulerian fem is adopted to resolve the motion of a pulsating bubble we use the block based amr implemented with the open source package paramesh macneice et al 2000 olson and macneice 2005 such that the efficiency and accuracy can be balanced in simulating the bubble pulsation and toroidal motion the rest of the present paper is organized as follows in section 2 the underlying theory and numerical techniques are presented relating to the eulerian fem and the amr implementation then the numerical model is validated by comparing it with an underwater explosion experiment in section 3 in section 4 several cases of a high pressure bubble moving beside a vertical wall are simulated and analyzed with the present model the results are also compared with the bem to verify the accuracy at last some conclusions are drawn in section 5 2 theoretical method and numerical models 2 1 problem description and basic equations in this work the bubble dynamics near a vertical wall is concerned initially place the bubble in the undisturbed water at a depth of h with a higher pressure of the internal gas than that of the ambient water a solid vertical wall is located with a distance of d from the center of the initial bubble this problem is abstracted from the underwater explosion bubble near a submerged structure or a vertical dam and has been studied both experimentally and numerically the detonation process is usually much shorter than the bubble motion thus it is reasonable to assume that the fluid flow is initially at rest the internal gas and the surrounding liquid forms a multi fluid riemann problem because of the pressure difference across the bubble interface then the bubble starts expanding with the contact discontinuity moving outwards if the solid wall is absent the bubble s motion can be roughly described by the rayleigh plesset equation and a multi cycle pulsation will occur in the pulsating bubble problems the multi fluid interface usually experiences great deformation for example the maximum radius of an underwater explosion bubble can be as large as dozens of times of the initial one such that the conservative error is amplified significantly thus the mixture formula for the multi fluid problem is adopted for its natural advantages in conservativeness assuming that all the fluid components share a single pressure within a cell the euler equations with the mixture formula so et al 2012 for the multi fluid system are 1 α i t α i u α i κ κ i u α i ρ i t α i ρ i u 0 ρ u t ρ u u ρ g p α i ρ i e i t α i ρ i e i u α i κ κ i p u 0 where α is the volume fraction bounded by 0 and 1 ρ is the density u u 1 u 2 u 3 is the material velocity e represents the unit material s internal energy κ ρ c 2 is the bulk module of fluid with c representing the sound speed and g is gravity the subscript i indicates a variable of the fluid i is the tensor product operator and the bar over a variable represents an average quantity of the mixture fluid the factor of α i κ κ i in the first and fourth equations is included to consider the compressibility difference of the fluid components in the mixture note that only α 1 is required to be solved and α 2 is then recovered with the fact that α 1 α 2 1 for the fluid mixed by fluid 1 and fluid 2 the average density and bulk module are determined by 2 ρ α 1 ρ 1 α 2 ρ 2 and 3 κ κ 1 κ 2 α 1 κ 2 α 2 κ 1 with the assumption that the two fluids share the same pressure besides the sound speed of the mixture can be recovered by the relationship of 4 κ ρ c 2 which can be used for any equation of state eos with an explicitly written sound speed for compressible fluids the eos of each fluid is required to close the euler equations in this paper the tammann eos ivings et al 1998 is chosen to model the surrounding water of the bubble in the following form 5 p ρ e γ 1 γ p w with the sound speed given by 6 c 2 p p w ρ γ where γ and p w are constants that taken as 7 15 and 330 9 mpa when p w is 0 eq 5 degrades to the ideal gas eos 7 p ρ e γ 1 which is used to model the internal gas of the bubble with γ 1 25 klaseboer et al 2005 zhang and liu 2015 2 2 eulerian fem with operator split the eulerian fem liu et al 2018 2019 tian et al 2020b is used to solve eq 1 to investigate the dynamics of a bubble beside a vertical solid wall firstly we rewrite eq 1 in the vector form 8 e t u e e u s where the vectors e and s are given by e α i α i ρ i ρ u α i ρ i e i s α i κ κ i u 0 ρ g p α i κ κ i p u then the operator split technique is employed to split eq 8 into 9 d e d t e u s and 10 e t d e d t u e eq 9 is based on the lagrangian perspective and the material moves along with the mesh thus we can apply the traditional explicit fem to eq 9 wu and gu 2012 then eq 10 is solved by remapping the conservative vector e between the deformed mesh and the original mesh the solution of these two equations corresponds to the lagrangian stage and eulerian stage respectively the operator split technique makes the combination method consider both stability and robustness especially suitable for the intense bubble movement with a large density ratio at the interface typically it has the second order of accuracy in space and the first order of accuracy in time we explain the basic equations and the detailed numerical techniques used in these two stages in the following subsections 2 2 1 lagrangian stage the mesh moves with the fluid material in the lagrangian stage in this paper the momentum equation in the lagrangian stage is solved only once for both of the two fluid components with the mixture fluid technique and the explicit fem benson 1992a wu and gu 2012 plugging the conserving equation of mass into the conserving equation of momentum in eq 9 we can obtain 11 ρ d u d t ρ g p let us discretize the computational domain into cells and denote φ p as the shape function for node p then we can express the solution by u φ q u q herein the superscript q represent node q s variable and the einstein summation convention is used multiply eq 11 by the shape function φ p and integrate it over the computational domain ω we can derive the semi discretized form of eq 11 as 12 ω φ p φ q ρ d v d u q d t ω p n ˆ φ p d s ω ρ g φ p p φ p d v where ω represents the boundary of the computing domain ω and n ˆ is its outward pointing unit vector we can rewrite eq 12 in the matrix form 13 m a f where m ω φ p φ q ρ d v is the mass matrix a d u q d t is the nodal acceleration matrix f is the matrix of nodal force corresponding to the right hand side of eq 12 the velocity and displacement of the nodes are subsequently updated with the new acceleration calculated then the other conservative quantities are updated with corresponding equations extracted from eq 9 14 d α i d t α i κ κ i 1 u 15 d ρ i d t ρ i κ κ i u and 16 d ρ i e i d t p ρ i e i κ κ i u the time increment in this paper is calculated with 17 δ t cfl min l e c u u 1 min where l e is the minimum size of the element and cfl is a fixed scale factor which is 0 5 in this paper and the superscript min is the minimization operator performed among all the elements in the computational domain the second part in the min operator is used to prevent the negative volume during one time increment 2 2 2 eulerian stage in the operator split procedure the fluid material and computational mesh are advanced together in the lagrangian stage for a whole time increment following which an eulerian stage is implemented in this stage the physical time is not advanced and only a conservative remapping procedure is performed by calculating the advection between adjacent cells with the following steps 1 reconstruct medium interface in multi fluid cells using the plic piecewise linear interface construction algorithm youngs 1982 benson 1992a by denoting the coordinate vector x x y z the linear interface can be expressed by a plane equation 18 n x b 0 to obtain the normal vector n a quadratic function f x k r is constructed by fitting the volume fraction α around the current cell with the least square method tian et al 2020a herein r x x 2 y 2 z 2 x y y z x z x y z 1 t is a complete set of the basis vector in the 3 d quadratic space k k 1 k 2 k 10 t is the coefficient vector obtained by solving the following linear system 19 k a 1 j 1 27 r x j α j where the summation runs over the current cell and its immediate neighbors i e the 3 3 3 mesh block around the current cell x j is the cell center coordinate and a r r if a uniform mesh is used in the simulation and a dimensionless local coordinate system is established with its origin locating at the current cell center the inverse of the matrix a can be calculated once and stored for the use thereafter to simplify the calculation then the normal vector can be approximated by n f f and the constant b in eq 18 can be obtained by an iterative method with the fact that the volume of the cell cut by the interface is α δ x 3 2 according to the nodal velocity and the constructed interface advect the fluid volume geometrically for each medium with proper rotating manipulation we may encounter with the five basic geometry configurations as shown in fig 1 this step is trivial and the readers can refer to benson 1992b 3 use muscl monotone upwind scheme of conservation law benson 1992a to advect the element s mass and internal energy 4 convect the node centered momentum using the his half index shift algorithm proposed by benson 1992b in this paper the muscl is used instead of the first order donor acceptor scheme to advect the 8 auxiliary cell centered variables constructed for the 8 nodes such that the second order accuracy is achieved 5 based on the new density and internal energy the cell pressure is calculated with the eos and the new time increment is calculated with the sound speed note that a pressure equilibrium is required to eliminate the pressure difference between the two fluid components within a cell in this paper the internal energy is exchanged between the two fluids with the following equations to achieve the pressure equilibrium 20 ρ e 1 ρ e 1 1 α 1 δ ρ e 21 ρ e 2 ρ e 2 1 α 2 δ ρ e where δ ρ e α 1 α 2 δ p α 2 p 1 ρ e 1 α 1 p 2 ρ e 2 herein the superscript represents the values before the pressure equilibrium δ p p 1 p 2 is the pressure difference and p ρ e can be calculated with eos easily 6 go to the next time increment and start a new lagrangian stage 2 3 adaptive mesh refinement for a fully 3 d simulation of an oscillating bubble the amr is essential to reduce the computational complexity to a reasonable scale the open source package paramesh olson 2006 macneice et al 2000 is adopted and modified in the present paper to archive the amr because of its flexibility paramesh is a block based amr package that manages the mesh refinement procedure and processor communications with the message passing interface each block has the same data structure allowing the users to connect the paramesh and an existing serial and non amr solver with minor modifications to simplify the demonstration fig 2 shows a 2 dimensional block in the paramesh the cells in the yellow color are the real ones to be solved with the eulerian finite element method while the blue cells on each edge of the block are the guardcells providing boundary conditions for the real ones paramesh communicates between adjacent blocks and the conservative quantities of the guardcells are interpolated from the overlapped cells of the neighboring blocks at the beginning of each time increment in this paper the block dimension is taken as 8 8 8 and 2 additional layers of guardcells are used as shown in fig 3 the real cells of 2 blocks are adjacent to each other and the guardcells of one block overlap with the real cells from the other one at the beginning of each time increment the state variables of the real cells are inherited from the previous increment but those of the guardcells are taken from the corresponding real cells of the adjacent block if the two blocks are in the same refinement level the guardcell filling procedure is straightforward as shown in fig 3 otherwise conservative restriction and prolonging procedures are required as shown above in the present numerical model the fluid velocity is a nodal vector however the velocity at nodes shared by different blocks could be inconsistent which will lead to pressure fluctuation near the intersection of fine and coarse blocks thus a few modifications are made as follows to fill the guardcell s nodal velocities in the paramesh 1 if a block s neighbor is in the same refinement level the velocities of the nodes on the shared face are overridden as the algebraic average of the velocities from both sides 2 if a block s neighbor is a finer block the nodal velocities on the shared face are overridden as the velocities from the neighbor block 3 if a block s neighbor is a coarse one the nodal velocities on the shared face remain unchanged with the modifications above the nodal velocities on the shared block faces are enforced to be consistent by choosing proper constant parameters for the refinement i e the maximum refinement level l max the minimum refinement level l min the pressure difference thresholds s u and s d all the blocks are labeled based on the following criterion 1 if α max α min in the current block is greater than a prescribed small constant s c it is labeled as an interface block and requires refinement herein α max and α min are the maximum and minimum values of the volume fractions among all the fluid components in the current cell and s c is taken as 1 0 9 2 if the maximum spatial difference of the pressure p is greater than s u then the current block is labeled as a critical block which requires refinement 3 if the maximum spatial difference of p in the current block is smaller than s d and it has no neighbor in a higher refinement level than itself it is labeled as a block that requires de refinement after the labeling process the refinement and de refinement are implemented iteratively such that the new refinement level is bounded by l max and l min and the refinement level difference between 2 adjacent blocks does not exceed 1 2 4 non dimensionalization and initial conditions it is necessary to write all the physical variables in the non dimensional form to obtain a consistent numerical accuracy in different simulations following the previously published papers zhang and liu 2015 klaseboer et al 2005 in bubble dynamics we chose the maximum radius of the bubble r m the fluid density ρ f and the undisturbed pressure at the same depth in the bubble center p p a t m ρ f g h as the variable scales for the non dimensionalization of length density and pressure and the scales of the other variables can be calculated correspondingly in table 1 these quantity scales are listed together with these characteristic quantities the initial conditions of the bubble can be given non dimensionally by the strength parameter ϵ p 0 p the distance parameter γ w d r m and the buoyancy parameter δ 2 ρ f g r m p herein d represents the distance from the solid wall to the explosive charge 2 5 computational domain setup a hexahedral domain of 0 5 r m 0 5 r m 5 r m 5 r m is chosen to discretize the flow domain around the bubble as shown in fig 4 the initial bubble center is at γ w r m 0 0 the six faces of the computational domain are denoted as faces a to f faces c and f are impenetrable and all the other faces are the truncation boundaries of the computational domain to minimize the spurious reflection of the truncation boundary the non reflecting boundary condition based on the spherical wave assumption liu et al 2018 is applied on face a b d and e the computational domain is sized by 5 r m 5 r m 10 r m and consists of two base blocks typically face f represents the solid wall and one half of the computational domain is simulated with the symmetry plane y 0 however if γ w is set to 0 face f turns to a symmetry plane and the problem imitates the one fourth fluid field of a bubble moving in the free field 3 model validation with underwater explosion experiment to verify the established numerical scheme we conducted an underwater explosion experiment in a water tank sized by 4 m 4 m 4 m a high speed camera is used to capture the images of the underwater explosion process due to the strong shock load of the underwater explosion it is a non trivial task to set up a hard enough boundary in an experiment when studying the interaction of an underwater explosion bubble and a nearby fixed solid wall thus we use two identical explosives detonating at the same depth to mimic the situation of one underwater explosion near a solid wall this can be justified with the mirror theory which has been used by wang 1998 and liu et al 2016 to investigate the bubble dynamics near a solid wall the two charges of 10 g hexogen explosives are placed horizontally with a distance of 0 68 m and a depth of 1 85 m the maximum radius of the bubble is 0 34 m which corresponds to a case of a bubble moves beside a solid vertical wall with a buoyancy parameter δ 0 0277 and a distance parameter γ w 1 0 the nearest boundary is about 1 36 m away from the bubble such that the boundary effect can be ignored in the simulation the initial conditions are taken as ϵ 572 and δ 0 0277 with the method proposed by klaseboer et al 2005 the lowest refinement level is set to 3 and the highest refinement level is set to 6 thus the finest cell size is 6 6 mm and there are 102 cells across the maximum perimeter of the bubble the comparison of the present results and the experiment are shown in fig 5 it can be seen that the numerical results agree with the experimental ones well in the sense of bubble evolution the two bubbles expand and collapse simultaneously which offsets the induced velocity at the x direction on the plane x 0 thus the bubble motion is identical to that besides a solid wall of x 0 during the collapsing phase the two bubbles are attracted by each other because of the bjerknes force a high pressure region emerges near each bubble which drives it to develop a liquid jet towards the other bubble as shown in fig 3 c and d when t 66 3 ms the two bubbles are penetrated by the liquid jets and form two toroidal bubbles 4 results and discussion 4 1 general features of a bubble collapsing beside a solid wall in this section the present numerical results are compared with the bem results presented by wang 1998 the case shown in fig 16 in wang 1998 is chosen of which the initial conditions are ϵ 100 δ 0 5 and γ w 1 0 it should be noted that a greater initial radius of the bubble is adopted in this paper than that used in the bem the reason is that the model includes the surrounding fluid s compressibility causing the energy dissipation through the outgoing pressure waves to archive the same maximum radius of 1 the initial radius must be greater it was obtained by backward integrating the rayleigh plesset equation from the maximum radius wang 2014 however because the rayleigh plesset equation does not consider the discontinuous shock at the beginning of the expansion it can only give a set of initial conditions that the bubble is initially expanding at a certain velocity which is not applicable in this paper thus we take several simulations with the 1 dimensional eulerian fem to obtain the proper initial radius iteratively and r 0 0 2 is used in the following simulations in this case buoyancy significantly affects the bubble evolution because of the great buoyancy parameter δ it corresponds to an underwater explosion bubble with r m 20 m at a depth of 40m if the gravity acceleration is approximated by 10 m s 2 although it is not quite practical for such a great bubble we chose this case because the buoyancy effect is comparable to that of the solid wall which leads to a complex evolution behavior of the bubble 4 2 comparison with bem results and convergence test as shown in wang 1998 the bubble develops a high speed jet under the combined effect of the solid wall and buoyancy during its collapsing phase in fig 6 the fluid fields on the x o z plane at t 0 976 1 873 and 2 207 are shown with the color contours represent the pressure field and the solid black curves indicate the bubble profiles the maximum refinement level l max is taken as 6 here with the parallelization accomplished with the mpi message passing interface the simulation takes 16 h on a desktop with an intel i7 9700 4 threads are used here cpu and 32 gb ram a region of high pressure forms beneath the bubble which drives it to develop an inward jet because of the existence of the solid wall the high pressure region deviates to the right side which deflects the jet towards the wall the profiles at the same time are extracted from wang 1998 and plotted as red crosses in fig 6 for comparison the results agree well with each other which validates the present model to demonstrate the convergence of the present model fig 7 compares the bubble profiles at t 2 207 on the x o z plane simulated with the maximum refinement level l max 6 5 and 4 respectively it shows that the result is poor with l max 4 where the finest cell size is about 0 078 and is relatively coarse compared with the initial radius r 0 0 2 with l max increased to 5 the results are improved significantly and the bubble profile is very close to that with l max 6 which indicates that the present model converges quickly with the increase of l max 4 3 crescent shaped bubble after jet penetration with the present model we further simulate the bubble motion after the jet penetration as shown in fig 8 we can see that after the bubble reaches its maximum radius at t 0 976 a wide jet develops from the bottom of the bubble due to the combined effects of the buoyancy and bjerknes force caused by the solid wall the bubble jet is obviously wider in the y direction than that in the x direction at t 2 386 the jet penetrates the bubble at its inclined top close to the solid wall and turns the bubble into toroidal shape it should be noted that the lower part of the inclined toroidal bubble is much thinner than the rest due to the bias of the jet with the bubble continue collapse a new toroidal bubble develops upward from the vortex eye due to the upward velocity of the water jet these two toroidal bubbles connect and the internal gas is transported from the old lower one to the new upper one their total volume reaches the minimum value at t 2 541 and starts rebounding then both bubbles break at the thinnest parts and turn crescent shaped which has seldom been investigated before it is non trivial to simulate the jet penetration break into two toroidal bubbles and further break into two crescent shaped bubbles with the bems requiring complex manipulations such as the surface remesh vortex ring placement and removal fig 9 shows the pressure histories at three locations on the solid wall at p 1 0 0 0 and p 3 0 0 1 25 the pressure curves are relatively smooth and no obvious jet impact pressure is observed by contrary a sharp increase can be seen on the pressure history curve at p 2 0 0 1 25 when the jet penetrates the bubble as shown in fig 9 d the reason is that the jet impact pressure mostly propagates in the jet s direction and the points p 1 and p 3 are not in the impact region usually the abrupt change of flow domain topology would lead to impact pressure in the surrounding flow however only a weak fluctuation can be seen from the pressure history of point p 3 the reason can be attributed to the circular velocity based on the vortex ring theory of a toroidal bubble wang et al 2005 the velocity circulation around every toroid section should be the same and keep constant as long as the topology of the flow domain remains unchanged theoretically it should be proportional to the inverse of the cross section perimeter if the size of the cross section varies along the toroid circle the circular velocity around the thinnest section can be as high as infinity before it breaks which leads to a great centrifugal force of the fluid slowing the impact process so that the toroidal bubble breaks smoothly 4 4 evolution of inclined toroidal bubble with different buoyancy parameters based on the previous section the buoyancy parameter δ is changed to 0 25 and 0 1 respectively which are more practical for the corresponding engineering cases the other initial conditions and the computational setup remain the same in fig 10 the pressure field around the bubbles which drive them to develop the liquid jets are shown by iso pressure surfaces and the bubble are shown with the green surfaces we can see that with the increase of the buoyancy parameter from 0 1 to 0 5 the pressure peak decrease significantly from 6 to 1 5 as a result the jet speed also decreases from 5 8 to 2 3 while the width is getting greater this phenomenon is attributed to the effective developing time of the jet with a higher buoyancy parameter the jet develops earlier during the collapse of the bubble which also leads to an earlier penetration time as a result the jet is not well developed and the speed is slower when it penetrates the bubble after the jet impact the bubbles are penetrated and turn into toroidal the evolution of the toroidal bubbles with δ 0 25 at t 2 308 2 370 2 442 and 2 595 are shown in fig 11 respectively it is found that the evolution process differs from the case with δ 0 5 shown in the section 4 3 significantly compared with the previous case the diameter of the jet cross section on the x o z plane is much smaller such that the cross section tends to be a circle rather than an ellipse shape with smaller buoyancy effects thus the part of the toroidal bubble close to the wall has the maximum cross section along the toroid it has been shown by klaseboer et al 2005 that the direction of the liquid jet tilted upwards initially will shift more and more perpendicular to the solid wall which was attributed to the growing attraction effect from the solid wall as the center of the bubble rushes to the wall from the theoretical view it can also be explained with the mirror theory we can simulate the effect of the solid wall on a toroidal bubble by using an imaginary mirror bubble on the other side as shown in fig 12 the velocity circulation caused by the imaginary bubble leads to a downward induced velocity around the real bubble the induced velocity decays along with the distance from the imaginary bubble thus the fluid flow around the real bubble tends to be rotated anticlockwise as a result the jet direction shifts to the solid wall and the cross section of the toroidal bubble close to the solid wall diminishes while the cross section away from the wall is enlarged during the shift of the jet direction this also explains why the toroidal bubble hardly breaks into a crescent shape from the part away from the wall fig 13 shows the pressure field on the solid wall generated by the toroidal bubble at the same times presented in fig 11 we can see that the pressure on the solid wall before the jet penetration only varies from 2 to 2 6 because the jet forms from the bubble surface away from the solid wall when the jet penetrates the bubble a high pressure region emerges around y z 0 0 8 where the jet is pointing because of the angle between the directions of the jet and the normal of the solid wall is quite large the impact pressure is only 8 at this time and reaches 26 at t 2 442 when the jet is fully developed then the jet pressure drops to 5 as the bubble rebounds when the buoyancy parameter δ decreases to 0 1 the evolution of the toroidal bubble after the jet penetration is shown in fig 14 it can be seen that the attraction of the solid wall dominates the motion of the bubble while the buoyancy is so small that the direction of the jet is almost perpendicular to the solid wall with a little inclination upwards similar to the axisymmetrical problems presented by tian et al 2020b and wang et al 2005 the necking effect and the bubble volume transportation from the old toroidal bubble to the new one are observed fig 15 shows the impact pressure on the solid wall caused by the collapsing bubble at the same times shown in fig 14 we can see that the impact pressure emerges even before the penetration at t 2 342 which means that the gas layer between the jet tip and the opposite bubble surface can transmit great pressure when they are close enough to each other this phenomenon is similar to the air cushion effect in the high speed water entry problem it violates the uniform pressure assumption of the internal gas used in the bems and gives more reliable results the jet impact pressure rises quickly after the penetration and then decays with the rebound of the toroidal bubble to quantitatively compare the bubble loads caused by the jets with different buoyancy parameters the pressure histories at the jet impact points on the solid wall are drawn together in fig 16 the bubble pulsating load decreases with the increase of the buoyancy parameter the reason is that with a greater buoyancy parameter the jet is better developed with a greater diameter and a higher speed at the same time thus more energy of the system transfers to the surrounding fluid s kinetic energy such that the residual energy to suppress the bubble and generate the pulsating load is less this can be justified by comparing the minimum volumes of the bubbles as shown in table 2 the minimum volume of the bubble with δ 0 5 is the greatest among the 3 cases and its pulsating pressure is the minimum in the case with δ 0 25 the pressure history is relatively smooth and no obvious sharp increase is observed which indicates that the jet penetrates the bubble moderately the velocity field at the moment of the jet penetration is shown in fig 17 it can be seen that the direction of the jet velocity is almost parallel to the opposite bubble surface at the first impact point thus the relative velocity at the normal direction is small such that the penetration is a mild process as for the case with the smallest buoyancy parameter δ 0 1 the pressure peak of the bubble load is almost twice of that with δ 0 25 although they have similar minimum volumes it is attributed to the jet impact pressure on the solid wall in this case the jet has a higher speed and its direction is almost perpendicular to the opposite bubble surface such that the impact pressure is maximized 5 conclusions based on the eulerian fem this paper establishes a 3 d model to investigate the bubble evolution near a solid wall numerically the block based amr technique is adopted to reduce the computational cost while maintaining the accuracy near the multi fluid interface an underwater explosion experiment is implemented to validate the numerical model the convergence is demonstrated by comparing the present results using different mesh sizes with those obtained with the bem through the simulation and the analysis of several cases with different buoyancy parameters the following conclusions are drawn 1 both the evolution of the single connect bubble before the jet penetration and the multi connect bubble are dominated by the joint effects of the buoyancy and the solid wall their balance determines the dynamic features of the bubble and its hydrodynamic pressure on the solid wall 2 the direction of the tilted jet will shift towards the solid wall gradually during the collapse of the toroidal bubble after the jet penetration which can be explained with the mirror theory and attributed to the velocity circulation caused by the imaginary toroidal bubble the toroidal bubble may further break into a crescent shape if the buoyancy is strong enough the cross section of the toroidal bubble is thinner at the part close to the solid wall due to the buoyancy such that the toroidal bubble breaks from here when the jet shifts downwards 3 the air cushion effect is observed between the jet tip and the opposite bubble surface before the jet impact and it causes the solid wall to experience the impact pressure in advance of the penetration 4 the penetration of the bubble by the jet may generate an impact pressure on the nearby wall depending on the jet speed and direction when the jet velocity is perpendicular to the opposite bubble surface the impact pressure is maximized credit authorship contribution statement zhao li tian writing original draft formal analysis a man zhang conceptualization methodology yun long liu funding acquisition writing review editing longbin tao writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china grant numbers 51879050 and 52088102 the china postdoctoral science foundation grant numbers 2016m600244 and 2018t110271 and the heilongjiang postdoctoral fund china grant numbers lbh z20131 lbh tz07 the authors would like to acknowledge doc nian nian liu for the help in implementing the experiment the paramesh used in this work was developed at the nasa goddard space flight center and drexel university under nasa s hpcc and esto ct projects and under grant nng04gp79g from the nasa aisr project 
