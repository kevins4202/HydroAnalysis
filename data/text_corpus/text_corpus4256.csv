index,text
21280,in order to obtain the wave forces on the substructure and superstructure of the sea crossing bridge this paper develops a systematic series of wave spectra covering a variety of spectral shapes observed in the bridge site area of pingtan strait bridge error identification of wave data and data reconstruction using the orthogonal matching pursuit of compressive sensing algorithm are conducted to obtain the stable and accurate water level data firstly the characteristic of the wave is then evaluated and the joint distribution of significant wave height and average wave period is investigated using copula models a family of wave spectra is proposed to represent a set of 7084 spectra measured at the 6 platform of the pingtan strait bridge site analytical results show that the proposed wave spectra family pingtan spectra can represent the realistic wave spectra and the pingtan spectra characteristic can also reflect the diversity and randomness of the realistic wave spectrum application of the wave spectra suggests using the proposed spectra to calculate the wave force on the structure of the pingtan strait bridge location keywords random wave sea crossing bridge wave spectrum joint distribution compressive sensing copula 1 introduction with the development of the economy and the increasing trade the sea crossing bridges across the two sides of the strait have great significance for economic development transportation and trade for example the hong kong zhuhai macao bridge yu et al 2013 which was recently built in china connects hong kong zhuhai and macao reducing the time spent crossing these three places and is of great significance in promoting the economic development of hong kong macao and the west bank of the pearl river delta the long span of such sea crossing bridges usually ranging from a few kilometers to tens of kilometers and the sea crossing bridges are often located in the nearshore area many kinds of research have shown that unlike land built bridges the wave force on bridges is also an important control load that cannot be ignored aashto 2008 douglass et al 2006 cuomo et al 2009 xu and cai 2014 2015 hayatdavoodi et al 2015 xu and cai 2017 huang et al 2018a 2018b and the wave force is one of the main causes of damage to sea crossing bridges yeh et al 2007 motley et al 2015 qu et al 2017 huang et al 2019a 2019b therefore it is of great significance to clarify the wave forces on the sea crossing bridge for the construction operation and maintenance of the sea crossing bridge the wave spectrum analysis method is one of the key methods for obtaining the wave forces on the substructure and superstructure of the sea crossing bridge in the ocean environments because of their ability to reflect the statistical variability of ocean waves wave spectra are commonly used in assessing responses of ocean structures prepared wave spectra in the required bridge site area are necessary for the design and construction of sea crossing bridges pierson and moskowitz pierson et al 1964 proposed a single parameter spectrum named p m spectrum which was derived from the measured data in the northeast atlantic ocean this spectrum is appropriate to describe the fully developed ocean waves of the outer sea s infinite wind region the widely used jonswap spectrum was developed from the p m spectrum by multiplying a peak enhancement factor based on a total of 2500 measured spectra hasselmann et al 1976 the jonswap spectrum for a developing sea typically has high and sharp peaks and was applied to wave prediction due to its feature of reflecting energy exchanges a six parameter wave spectrum was proposed to represent various spectral shapes by ochi and hubble 1976 according to the north atlantic ocean measured spectra this six parameter spectrum is superimposed by two three parameter parts to better describe the two peaks spectrum and various spectral shapes in different sea states however the seabed topography changes and the existence of islands make the nearshore sea state could not be described simply by those spectral forms the sea crossing bridge is located at the haitan strait which is surrounding by many small islands furthermore the dramatic changes in the topography of the seabed and wind field in these nearshore areas make it difficult to evaluate the wave forces on the bridge structure which also increases the risks of construction and protection this study aims to propose the appropriate wave spectrum model for the 6 platform of the bridge site area according to a set of measured wave spectra a suitable model of the wave spectrum can help calculate the wave force on the bridge structure accurately and further improve the accuracy and protection of the construction control in section 2 the description of the ocean environment in the bridge site area and the collection of wave data are introduced the discussion of the proposed algorithms in error judgment and reconstruction of the measured data and investigation of wave characteristics are presented in sec 3 characteristics and parameters of wave spectra in the 6 platform are determined in sec 4 the application of the developed wave spectra is conducted in sec 5 finally this study closes with a conclusion about the present work 2 bridge site and data collection 2 1 bridge site this study takes the under construction pingtan strait bridge as an example the bridge is located in the eastern part of fujian province of china with a long span of 1634 0 m and a maximum water depth of 43 0 m the bridge site is located at the north exit of the pingtan strait and the seabed topography is complex with many islands and reefs the nearest ocean observatory fujian marine forecasts station is located in the southeast of the bridge site area and the buoy monitoring points of the ocean forecasting platform are mostly arranged in the open area of the sea compared with the complex marine environment near the bridge site area there are no islands around the buoy monitoring point of the ocean forecasting station and the topography of the seabed is significantly different from that of the bridge site these differences have led to the difficulty of using ocean observation data for wave prediction and wave forces analysis at bridge sites ti et al 2018 the bridge site area has a typical oceanic monsoon climate with the ese normal wave direction and the sub normal wave direction being the sw and sw directions therefore the collection of wave data in the bridge site area and the application of the wave spectrum specific to the bridge site area are of great significance 2 2 wave data collection the wave data measured at the 6 platform 119 619 e 25 709 n near the bridge site are used to investigate the measured wave spectra as shown in fig 1 the sby2 1 ultrasonic wave gauge is installed at the 6 platform in the manner of a cantilever and used to measure the water level the mean water depth at the 6 platform is 18 0 m and the distance from the wave gauge to the mean water level is 13 0 m the measurements of the wave data refer to measure the distance from the wave gauge to the real time water surface the sby2 1 ultrasonic wave gauge performs an hourly 17 min measurement of the water level at a frequency of 2 0 hz a total of 17 040 water level data from dec 30 2014 to dec 28 2016 were collected to perform wave spectrum analysis to obtain stable and reliable water level data the wave gauge must be mounted fixed without any adjustments in the displacement and corner however the extreme wave and wind conditions caused by the complex topography of the seabed strong monsoons and extreme typhoons around the bridge site have a significant influence on wave data measurement the huge wind and wave forces on the platform may induce a displacement of the structure and cause further inaccuracies in the measuring data besides wave gauge failure and water splashing can also lead to errors in measurement therefore the error identification of initial data based on data analysis missing values and incorrect values filling are indispensable for accurately obtaining wave parameters and wave spectrum models brodtkorb et al 1999 liang 2018 also the extreme wave data with a significant wave height greater than 4 0 m are not discussed in the present study due to the high data missing rate of the wave data in addition the long term hydrological historical data of the bridge site shows that the significant wave height below 4 0 m represents most of the wave conditions during construction and operation periods 3 wave data processing 3 1 error identification of wave data fig 2 shows a total of 2049 water level data at 22 00 on oct 29 2016 the error data marked by red circles in fig 2 may be divided into two types missing values and incorrect values according to the wave data analysis the missing values are caused by the failure of the wave gauge to capture the water level information so the values are equal to zero therefore the missing values can be easily determined from the wave data moreover incorrect values are due to instrument sloshing wave breaking and other environmental factors liang 2018 gives a detailed discussion on the proportion of the zero value percentage range and the accumulative proportion of the measured wave elevation data in 2015 he found that the zero percentage of most of the measured data is within 5 and only a few of the zero percentage of the measured data will be 30 higher based on the characteristics of wave data in the bridge site area and the empirical criteria proposed in the wafo matlab toolbox wafo group 2000 liang 2018 presented a comprehensive error identification criterion for wave data on the 6 platform this error identification method takes into account the effects of wave characteristics instrument malfunction and external factors on the data collected so that the error value in wave data can be detected effectively and precisely the following three criteria are used in this study as part of the error identification method 1 the pauta criterion is used to detect outliers with a confidence probability of 99 7 2 based on wave characteristics and the data analysis of long term ocean wave monitoring brodtkorb et al 1999 obtained two empirical criteria for assessing inaccurate ocean wave data 1 x t 5 m s 2 x t g 2 where x t is the wave data and g is the gravity acceleration the 5 0 m s in eq 1 is determined by the limiting maximum raising speed of gaussian waves besides the acceleration of the stokes wave is also restricted to within g 2 3 if the wave data remains constant within 2 0 s then the data acquisition for this period is considered to have failed these constant or missing values may be due to the block of wave gauge and the missing value that is replaced by zero will significantly influence the accuracy of the estimated spectral density 3 2 wave data reconstruction the interruption of signal acquisition and the occurrence of inaccurate data during the acquisition of wave data by the wave gauge add incompleteness to all wave data if an analysis of the wave spectrum is directly studied using incomplete wave data the inaccuracy in generating the wave spectra will result incomplete data also leads to the loss of essential signal information therefore if the missing and erroneous data in the sampling can be reconstructed based on the actual state data the accuracy of the wave spectrum analysis result will be improved the available methods are the time series method regression analyzing method interpolation method and curve fitting approach for data reconstruction and recovery liang 2018 systematically classifies the types of missing data into 11 types reconstructing the missing data by nearest neighbor interpolation piecewise linear interpolation cubic spline interpolation cubic hermite polynomial interpolation sine function fitting etc finally he found the method of cubic spline interpolation is most efficient in reconstructing missing data however these methods estimate the missing data by the distribution or trend of the missing value through the neighboring data without considering the characteristics of the whole data some of those approaches also require a series of equations or high dimensional equations to be solved as the number of data increases the solution process gets increasingly difficult zhang et al 2014 in this study the orthogonal matching pursuit omp of the compressive sensing cs algorithm is utilized to reconstruct the wave data cs algorithm is a sampling theory first proposed by donoho 2006 and candes candes et al 2006 it states that as long as the signal is sparse or compressible the data can be accurately recovered by collecting data far below the nyquist sampling theorem standard signal based on this feature of cs when the sampled data covers the key information of the original signal the original signal can be reconstructed with high probability under the condition of sufficient accuracy in recent years cs has been used in various signal processing fields based on cs katz et al 2009 applied the cs theory to reconstruct the pseudothermal ghost imaging fortunati et al 2014 tested four algorithms based on the theory of cs to estimate the directions of arrival of multiple source signals from a single observation vector of an array of data tropp and gilbert 2007 compared the basis pursuit bp method and a greedy algorithm named omp in signal recovery results demonstrate that omp is more efficient and easier to implement for data recovery problems than bp compared with the mp matching pursuits algorithm the omp algorithm orthogonalizes all selected atoms at each step of the decomposition which makes the omp algorithm converge faster with the same precision requirements pati et al 1993 therefore the sparse approximation algorithm omp based on cs is implemented in this study to reconstruct water level data fig 3 illustrates the flow diagram of the omp reconstruction algorithm utilized in this study in the flow diagram r t represents the residual t is the iteration counter ʌ t represents the set of column numbers at t iterations λ t is the selected numbers of columns at t iterations a j is the column j of the sensing matrix and represents the inner product at t iterations a t represents the set of columns chosen based on ʌ t and θ is the sparse representation of the signal x after reconstruction the detailed discussion of the omp algorithm for reconstruction can be seen in pati et al 1993 and tropp and gilbert 2007 the measurement data without error data were selected for testing to verify the effectiveness and accuracy of the omp reconstruction algorithm in data reconstruction under the different rates of the error data a total of m 2000 data sets is selected and n data is randomly omitted from each set of data where n represents the error rates from 0 to 60 the reconstruction accuracy of the data is expressed by the ε mean relative error mre the calculation of mre is conducted for each set of data with the above error rates 3 ε 1 n i 1 n y i x i x i where y i is the ith term after data reconstruction and x i is the ith term of origin signal x fig 4 shows the accuracy of data reconstruction with different error data rates it can be seen from fig 4 the omp reconstruction algorithm can reconstruct the wave data perfectly when the data missing rate is below forty percent the average relative error will increase significantly after the data missing rate reaches fifty percent therefore the missing rate of the measured wave data that below forty percent is used in the subsequent wave spectrum analysis besides the moving average method is used to remove the influence of the tidal level on wave data 3 3 wave characteristic for the analysis of the wave characteristic with the upward zero crossing technique the statistical calculation is performed on the reconstructed wave data the characteristic wave defined by the average value of some large waves is used as the characteristic parameters of wave statistics fig 5 presents the variation of significant wave heights h s and average wave periods t in 2015 the significant wave height data in fig 5 is the maximum value of h s measured each day and the wave period adopts t corresponding to h s it can also be concluded that the significant wave heights are lower than 2 0 m during most of the month except for january july august and september fig 5 shows that the maximum value of h s during 2015 is 3 82 m which was measured at 16 00 on aug 08 2015 and the maximum value of h s is 9 80 s that occurred at 05 00 on jul 07 2015 the large significant wave heights measured in july august and september are caused by the typhoon and the large significant wave heights measured during the monsoon period january are caused by the high wind speeds it can be found in fig 5 that most of the severe wave conditions were observed and studied and the lack of monitoring in august was caused by the failure of the wave gauge in general large wave heights and wave periods may occur during the typhoon and monsoon periods and the wave conditions near the bridge site are basically in a quiet period from march to june which is suitable for the construction of offshore structures wave height and wave period are both very important to the study of wave spectrum and wave force in the marine environment once the correlation between wave height and wave period can be established the corresponding return period for the combinations of the wave height and wave period can be determined for the further study of offshore structures in the present study the copula model is used to simulate the correlation between the wave height and wave period based on the measured data in 2015 copulas can be used to provide multivariate dependence structure separately from the marginal distributions and the most frequently used elliptical copulas and archimedean copulas model are used here to find the optimal joint probability distribution of h s and t a copula is a multivariate distribution whose marginals are all uniform over 0 1 let f be a 2 dimensional distribution function with margins of the bivariate x y and sklar 1959 first showed that there exists a 2 dimensional copula c such that can transform any pair x y of continuous random variables to the uniform joint distribution function f x y over 0 1 by its probability integral transformation 4 f x y c f x f y α where f x y is the joint cumulative distribution f x and f y is the marginal distributions of variables x and y respectively α is the dependence parameter that is calculated through fitting copula based models with the maximum likelihood method next the marginal distributions for h s and t should be examined to achieve the copula model of h s and t for the measured data in 2015 the distribution of h s can be determined using the probability distribution function pdf and many commonly used probability distribution functions such as gamma burr weibull rayleigh normal et al are adopted to select the most appropriate one for h s fig 6 shows the histogram of h s and the comparison of several fitted probability density functions the akaike information criterion aic is utilized to evaluate the goodness of the fit for several probability distribution functions to achieve the best fitted probability density function for the histogram of h s 5 a i c 2 k 2 l θ where k represents the number of parameters used in the probability density function and l θ is the maximum log likelihood value of the probability density function besides the lowest aic value suggests a better fitted function fig 6 shows that the calculated mean value and variance of h s is equal to 0 86 m and 0 30 m2 respectively table 1 shows that the mean value and variance that are calculated based on these four probability distribution functions all give reasonable approximations combined with the aic value it shows that the marginal distribution of h s follows the gamma distribution the measured h s is concentrated between 0 25 m and 1 25 m and it is not too much for the case of h s greater than 3 0 m wen and yu 1985 suggested that the wave height distribution could be represented using the rayleigh distribution based on a large amount of deep sea field data fig 6 shows that the rayleigh distribution gives a fair accuracy in fitting the distribution of h s especially for h s larger than 1 0 m but the rayleigh distribution presents a lower estimation of the distribution of h s for h s smaller than 1 0 m it is found that the gamma distribution is the best choice for representing the distribution of h s when combining aic value average value and variance fig 7 shows that the calculated mean value and variance of t is equal to 4 09 s and 0 99 s2 respectively table 2 shows that the aic value mean value and variance of burr distribution gives the best approximation of marginal distributions for the average wave period t the other three distributions deviate from the average value of the average wave period towards the small period value the burr marginal distribution of the average wave period shows that the average wave period is concentrated between 3 25 and 5 0 s however the burr distribution still presents a slightly low estimate of the distribution of t for around 5 0 s after obtaining the marginal distribution for h s and t the most frequently used four copula models clayton frank gumbel and gaussian copula are utilized to correlate these two variables fig 8 shows the contour of probability density between four copula models and measured points for h s and t it should be mooted that the measured point used in fig 8 only included the wave data presented in fig 5 for a clear illustration as is demonstrated in fig 8 the distribution of significant wave height is concentrated when the wave period is small when h s increases the distribution of t is more dispersed as can be seen from the comparison of four copula models and measured points the clayton copula model is in good agreement with the measured points because the clayton copula agrees with the measured points suggesting the strong correlation between h s and t also the lowest aic value for clayton copula in table 3 supports this viewpoint 4 wave spectrum analysis 4 1 wave spectrum characteristic the wave spectrum is used to describe the energy distribution of the constituent waves of the ocean waves spectral analysis is the clarification of a wave s energy distribution relative to frequency direction or other variables the fast fourier transform fft is generally used to convert the wave data into a spectrum in this section the evolution of wave spectra during the monsoon period between jan 11 and jan 13 in 2015 will be discussed firstly shown in fig 9 in the marine environment the ocean waves usually consist of swell and wind generated waves the occurrence of pure wind generated waves or swell is very rare and most of them are in the form of mixed waves with the change of the wind field in the marine environment the ocean waves are often in different stages of development during the monsoon period the bimodal wave spectrum presents the wave energy is distributed in a wide frequency domain with the increase of the severity of the sea conditions shown in fig 9 for h s 0 78 m the wave spectrum for h s 0 78 m shows that the wave spectrum measured at 17 00 on jan 11 2015 is a mixed wave dominated by the swell which is caused by the superposition of the distant swell and the wind generated waves at the 6 platform as the severity of the sea conditions continued to increase the spectral peak value of the wave spectrum continues to increase and the modal frequency of the wave spectrum moves to the lower frequency domain for h s 1 94 2 74 and 3 8 m in fig 9 wave spectrum energy is also more concentrated and a single peak wave spectrum appears however it can be seen from the wave spectrum for h s 2 74 m in fig 9 that energy is still distributed in a wide range of frequency domain during the development of the wave spectrum thus the ocean waves cannot be accurately described by a single peak wave spectrum even with the h s equal to 2 74 m with the decrease of the severity of the sea conditions and the wind generated waves gradually dissipate the spectral peak value of the wave spectrum decrease and the modal frequency of the wave spectrum slowly moves to the higher frequency domain for h s 3 80 3 04 2 68 1 83 and 1 34 m in fig 9 also it shows that the wave spectrum gradually shows the characteristics of bimodal peaks with a gradual dissipation of the wind generated waves for h s 3 80 3 04 2 68 1 83 and 1 34 m in fig 9 it is found that the significant wave heights are mainly concentrated between 0 50 and 1 50 m in section 3 3 and the majority of the ocean waves in this range are in the form of mixed waves presenting with the bimodal wave spectra the wave spectrum converted from the wave data measured on the 6 platform will be compared to several widely used wave spectra proposed so far fig 10 shows a comparison between different existing wave spectra and measured spectrum the water depth for the 6 platform is 18 0 m and the measured wave data comes from 15 00 on dec 30 2014 following the wave data statistics h s is 0 39 m and t is 4 67 s several existing wave spectra are shown in fig 10 are briefly described below based on the newman spectrum neumann 1952 bretschneider 1959 used the joint distribution function of the dimensionless wave and dimensionless wavelength to derive the two parameter b spectrum the form of the b spectrum as shown below 6 s ω 1 25 4 h s 2 ω m 4 ω 5 exp 1 25 ω m ω 4 where ω m is the peak frequency of the spectrum the widely used p m spectrum was proposed by pierson and moskowitz 1964 based on the measured wave data of the north atlantic the formula derived further can be expressed as 7 s ω 0 78 ω 5 exp 5 4 ω m ω 4 where ω m 1 257 h s 1 2 is the peak frequency of the p m spectrum the modified jonswap spectrum used in this section was proposed by goda 1999 8 s ω α h s 2 ω m 4 ω 5 exp 5 4 ω m ω 4 γ exp ω ω m 2 2 σ 2 ω m 2 9 α 0 06238 1 094 0 01915 ln γ 0 230 0 0336 γ 0 185 1 9 γ 1 where α represents the parameter of the dimensionless fetch γ is named the peak enhancement parameter and its recommended value ranged between 1 and 20 and σ is the peak shape factor which is equal to 0 07 when σ smaller than or equal to the peak frequency and is equal to 0 09 when σ larger than the peak frequency the last one is the six parameter wave spectrum which was proposed by ochi and hubble 1976 according to the north atlantic ocean measured spectra the formulation of the most probable six parameter wave spectrum can be expressed as 10 s ω 0 25 i 4 λ i 1 4 ω m i λ i γ λ i ζ i 2 ω 4 λ i 1 exp 4 λ i 1 4 ω m i ω 4 where i 1 2 represents the lower and higher frequency terms respectively λ i is the control parameter of the shape of wave spectra ζ i represents the function of h s and г λ is the gamma function evaluated at λ a comparison of various existing wave spectra and the measured spectrum is shown in fig 10 and the measured spectrum illustrates the property of two peaks the wave spectrum obtained from a large amount of measured data reflects double peak characteristics the measured spectrum s lower and higher frequency terms relate to the wave that is generated by swell and wind in the bridge site area moreover the peak value of the measured spectrum is larger than b spectrum and p m spectrum in the next section the accurate representation of measured wave spectra is required to further calculate the structural response of bridge structures accurately under wave loading and optimize bridge design although the peak value of the jonswap spectrum is also similar to the measured spectrum the six parameter spectrum has two characteristics of high frequency and low frequency which is better for representing the measured spectrum what is important is that although the wave energy in the higher frequency part is lower than that in the lower frequency part some parts of the bridge structure are more sensitive to high frequency parts therefore dividing the wave spectrum into high frequency and low frequency components that is using a six parameter spectrum to represent the measured spectrum is a better choice besides many researchers have found that except for a few cases where the wave spectrum still presents a single peak most of them are bimodal or multiple peaks based on the analysis of measured wave spectrum hwang et al 2012 portilla et al 2009 violantecarvalho et al 2004 thus the study of the measured spectra that fitting by the six parameter wave spectrum plays an important role in calculating the wave forces and responses of structure in this area and the parameters in the six parameter spectrum can be expressed by the significant wave height which is more convenient for engineering applications 4 2 wave spectrum representation even if h s is the same in the same bridge site area the spectrum shape will be different because of the influence of the wave swell and the wind field therefore a precise expression of the spectrum is necessary to determine the structure s response under the action of the wave and the wave loading on coastal bridges in this section the six parameter spectrum method proposed by ochi and hubble 1976 is used to calculate the wave spectrum based on the reconstructed measured data the detailed procedures of spectral representations are summarized as follows 1 a set of a total of 7084 reconstructed measured data is divided into 7 groups according to h s the specific grouping of the reconstructed measured data according to their significant wave heights is shown in table 4 based on eq 10 and measured data the six parameters of each spectrum are determined by the nonlinear least squares method and information stored in the wave spectrum a nonlinear least square program developed in the python platform ensures minimal difference between the measured spectrum and the theoretical spectrum to avoid the possibility of an unrealistic representation of the spectral shape only the modal frequency of the higher frequency part ω m2 is restricted to more than 0 6 during the nonlinear least square fitting suppose a spectrum has triple peaks two of which are below 0 6 in the frequency range but only the bimodal spectrum can match the formula shape of the six parameter spectra in this case representing the two peaks in the frequency range below 0 6 by one peak may be more appropriate and considering the other peak in the higher frequency part therefore the lower frequency component with a relatively large peak value will be selected and the nonlinear least squares method will be combined to deal with this situation so that the fitting effect can reach the best moreover the restriction of the higher frequency part ω m2 will ensure a better fit of the curve in the higher frequency part associated with the wind generated waves besides ochi and hubble 1976 also used a frequency of 0 6 as the dividing line between high and low frequencies to illustrate the accuracy of fitting wave spectrum using the nonlinear least squares program and the validity of the six parameter spectrum reflecting the wave condition measured at the 6 platform several comparisons between the measured wave spectrum and fitted mathematical six parameter spectrum are shown in fig 11 fig 11 a shows the bimodal wave spectrum composed of ocean swells and wind generated waves fig 11 b also shows that the wave spectra with double peaks can be accurately represented with the six parameter spectrum due to their specialization of high frequency and low frequency components in addition fig 11 c j show these wave spectra represent the development of the ocean wave condition caused by wind and the wind generated waves grow and develop all these fitted wave spectra shown in fig 11 are in close agreement with the measured spectra and the peak errors of the first spectral peak are within 5 deviation the range of root mean square error rmse and the peak errors of the first spectral peak between the theoretical spectra and measured spectra for each wave height group are also given in table 4 it is showed that the rmse values for all groups are relatively small and the peak errors of the first spectral peak for all groups are within 10 deviation 2 the six parameter spectra of all the reconstructed data are obtained by the nonlinear least square method but the parameters of the six parameter spectra for each group are different therefore the statistical analysis of six parameters for each group are needed to obtain statistical characteristics of each parameter then statistical spectral parameters can be used to generate a family of spectra for a given h s to represent all reconstructed measured wave spectra the spectra family includes the probable spectra and the wave spectra with a guaranteed probability of 95 percent in each group the statistical analysis is conducted for each parameter including the function of significant wave height ζ 1 ζ 2 the control parameter of the shape of wave spectra λ 1 λ 2 and the modal frequency ω m1 ω m2 for the low and high frequency parts respectively first take the control parameter of the shape of wave spectra λ 1 for the low frequency part for group ⅲ as an example which indicated that the wave spectra with significant wave heights ranging from 1 0 m to 1 50 m are included in this sample the distribution of parameter λ 1 can be determined using the probability distribution function pdf and many probability distribution functions such as birnbaum saunders burr gamma inverse gaussian normal et al are adopted to choose the most appropriate one for each parameter fig 12 a shows the histogram of the control parameter λ 1 of the shape of wave spectra for group ⅲ and the comparison of several fitted probability density functions table 5 summarizes the calculated aic value as well as the corresponding mean value and variance of each probability density function for the control parameter λ 1 the aic values show that the inverse gaussian model is a suitable distribution of the control parameter λ 1 compared to the other four models the inverse gaussian model may better reflect the control parameter distribution λ 1 table 5 also shows that although the fitting effect of each probability density function is different the differences in the variance and average value between probability density function are relatively small as for the parameter of the function of ζ 1 for group ⅲ the histogram and the comparison of several fitted probability density functions are shown in fig 12 b table 6 also gives the calculated aic value and the corresponding mean value and variance of each probability density function for the function of ζ 1 it shows that the function of ζ 1 obeys the logistic distribution law and achieves similar mean values and variances fig 12 c f present the histogram and probability density function of some parameters in group ⅱ and the appropriate probability density functions of these parameters are also determined using the aic method it shows that most of the appropriate distributions of the parameters are not the normal distribution which is quite different from the six parameter wave spectra measured at the north atlantic ocean ochi and hubble 1976 the possible reason for this phenomenon is that the six parameter wave spectra measured at the north atlantic ocean were observed during the stage of growth and decay of a storm in a short time however the wave spectra measured at the 6 platform near the bridge site were collected from dec 30 2014 to dec 28 2016 to perform wave spectrum analysis and the long periods of observation results in the complexity and randomness of the parameters of the wave spectrum in the present study to develop the family of wave spectra the modal frequency ω m1 for group ⅱ h s from 0 50 m to 1 0 m is taken as an example to explain the whole calculation process first the mode value of the modal frequency ω m1 equal to 0 982 rad s can be determined from the probability function obtained from the statistical analysis above then two values of the modal frequency ω m1 0 638 rad s 1 473 rad s were determined by 95 percent of the probability density function therefore a total of three values for the modal frequency ω m1 including the mode value the upper and the lower values determined from a confidence band for a confidence coefficient of 0 95 can be obtained in each group next the other five parameters in the six parameter wave spectra can be found from the fitted six parameter wave spectra based on the value of the modal frequency ω m1 however due to a large amount of wave spectra data there may be many wave spectra with the same value of the modal frequency ω m1 using their respective averages in the region of 5 percent of the value of the ω m1 modal frequency will solve the above problem effectively while making the data more representative similarly the mode values the upper and the lower values of the modal frequency ω m1 for other groups are achieved using the same method all values of the modal frequency ω m1 obtained from all groups are plotted in fig 13 as a function of significant wave height ζ all the fitted exponential functions present the close agreements with the mode values the upper and the lower values of the modal frequency ω m1 for all groups the remaining five parameters are determined by the above method mentioned and these parameters for all groups associated with the mode values the upper and the lower values of the modal frequency ω m1 are plotted in fig 14 a to 14 e thus three spectra associated with the modal frequency ω m1 can be obtained and all parameters are expressed as a function of ζ it should be mentioned that the proposed wave spectra are applicable for wave conditions with ζ smaller than 4 0 m due to the wave spectra investigated in the present study the same procedure for deriving three spectra associated with the modal frequency ω m1 is conducted for the other five parameters and thus a total of eighteen wave spectra can be established for a given wave condition the family of wave spectra includes six mathematical spectra related to the mode value of the six parameters twelve mathematical spectra associated with the confidence band for a confidence coefficient of 0 95 of the six parameters the values of the six parameters for those eighteen wave spectra are shown in table 7 a total of eighteen wave spectra for a given wave condition can be established based on table 7 and eq 10 fig 15 show the family of wave spectra for ζ 0 50 m 2 0 m and 4 0 m respectively these figures show that the shape of the family of wave spectra varies significantly for a certain wave condition and the modal frequency of the wave spectra family is widely distributed from 0 40 to 1 0 in fig 15 b the family of wave spectra developed in the present study can represent the realistic wave spectra of the 6 platform of pingtan strait bridge and the characteristic of the family of wave spectra can also reflect the diversity and randomness of the realistic wave spectrum 5 application of pingtan spectra the random wave forces on the substructures piles and piers can be evaluated using the proposed family of six parameter wave spectra called pingtan spectra in this section to meet the design and construction requirements of the sea crossing bridges the random wave forces on the steel concrete composite pile with a diameter of 3 0 m used in the construction of the pingtan strait bridge were chosen as an example of application the ζ is set as 4 0 m the water depth is d 18 0 m and the wave period is 10 0 s based on the dispersion relation of the ocean wave the wave length l can be estimated equal to 117 0 m the spectral analysis and the morison equation are therefore used to calculate the wave forces on the piles because the pile diameter is smaller than 0 2 times the wave length the spectrum of wave force on the pile can be expressed as 11 s f ω k d 8 π ω sinh k d 0 d σ u z cosh k z dz 2 s ω k i ω 2 k 2 s ω and the k d and k i are defined based on the inertia and drag coefficient respectively as 12 k d 1 2 c d ρ d 13 k i c m ρ π d 4 2 where c d 1 2 and c m 2 0 represents the drag and inertia coefficients respectively k 2π l 0 0537 is the wave number s ω is the wave spectrum z is the distance from a point of the pile to the seabed ρ is the density of water and the mean square deviation of the velocity of water σ u is defined as follow 14 σ u 2 0 ω cosh k z sinh k d 2 s ω d ω fig 16 shows the spectra of wave forces on the pile with above wave conditions under the action of the p m spectrum b spectrum the most probable six parameter spectrum and pingtan spectra due to a large number of pingtan spectra including six probable spectra and twelve spectra associated with the confidence band for a confidence coefficient of 0 95 only the spectra of wave forces for six probable spectra are illustrated in fig 16 for simplicity and clarity fig 16 shows that the spectra of wave forces for six probable pingtan spectra are significantly different from those for the p m spectrum b spectrum jonswap spectrum and the most probable six parameter spectrum for different spectra the peak values of the spectra and their corresponding frequencies all demonstrated significant influence table 8 presents the significant wave forces cumulative probability equal to 13 5 estimated from each wave spectrum based on the assumption that the extreme value of wave force conforms to the rayleigh distribution among them the mode upper band and lower band values of the significant wave forces corresponding to the pingtan spectra eighteen wave spectra are given after statistical analysis table 8 shows that the wave force calculated using the pingtan spectrum is larger than those are calculated using other spectra thus it is suggested to use pingtan spectra to calculate the wave force on the structure at the 6 platform the significant wave forces can be expressed as 15 f s k σ s where k 2 0 is the coefficient corresponding to the value of the cumulative probability and the σ s is the mean square deviation of the total wave forces that can be calculated as follow 16 σ s 0 s f ω ⅆ ω the mode value of the significant wave forces calculated by the proposed pingtan spectra is recommended for engineering application besides it should be noted that the pingtan spectra are being proposed based on the wave data measured at the 6 platform and the dramatic changes in seabed topography near the bridge site also bring some differences for the wave spectra in different sites around the bridge in addition this pingtan strait bridge traverses several islands along the way adding significant influences on the wind field and the swell propagated from open seas therefore the applicability of pingtan spectra at other locations in this sea area still needs further study in the future however the proposed pingtan spectra can provide reliable input for the swan or mike21 numerical module and further investigate the wave conditions in sea areas close bridge sites akpinar et al 2016 ti et al 2018 conclusions because of its ability to reflect the statistical uncertainty of ocean waves the wave spectra are widely used in assessing wave forces on sea crossing bridges the cs algorithm is used to reconstruct the measured water level data and the statistical calculation on the reconstruction wave data is carried out to analyze the characteristic of the wave and the joint distribution of significant wave height and average wave period then a family of wave spectra is developed based on the statistical analysis of the total 7084 measured spectra finally the present study performs a comparison of the significant wave forces on the steel concrete composite pile of the sea crossing bridge based on the spectral analysis and the morison equation and shows the following 1 the omp algorithm can perfectly reconstruct the wave data when the data missing rate is below forty percent the average relative error will increase significantly after the data missing rate reaches fifty percent 2 the statistical calculation of the measured data shows that large wave heights and wave periods may occur during the typhoon and monsoon periods and the wave conditions near the bridge site are generally in a quiet period from march to june which is suitable for the construction of offshore structures the clayton copula gives the best approximation of joint distributions of the significant wave height and the average wave period 3 the measured wave spectrum reflects the characteristics of double peaks and the lower and higher frequency terms of the measured spectrum may be related to the swell and wind generated wave in the bridge site area the wave spectrum has two characteristics of high frequency and low frequency with six parameters is better for representing the measured spectrum 4 the proposed family of wave spectra pingtan spectra can represent the realistic wave spectra at the 6 platform of the pingtan strait bridge and reflect the diversity and randomness of the realistic wave spectrum 5 it should be noted that the pingtan spectra are proposed based on the wave data measured at the 6 platform and the dramatic changes in the topography of the seabed and wind field near the bridge site also bring some differences for the wave spectra at different sites around the bridge the applicability of pingtan spectra at other locations in this sea area and the correlation between wind speeds and wave spectra still needs further study in the future credit authorship contribution statement bo huang writing original draft investigation qingyang ren conceptualization methodology xiaolu cui investigation validation tong wan software formal analysis chengran zhang data curation bing zhu writing review editing project administration hao ding writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful for the support of this research by the national natural science foundation of china 52008065 41472262 51805057 51978600 the national natural science foundation of china china railway corporation high speed railway basic research joint fund project u1834207 the chongqing municipal education commission science and technology research project kjqn202000706 the china postdoctoral science foundation 2020m683229 the key project of national key research and development project 2016yfc0802206 3 the program for innovation team building at institutions of higher education in chongqing cxqt19021 the major applied basic research frontier projects in sichuan province 2017jy0003 and the high level technical personnel training project of transportation industry the authors express their gratitude to china railway major bridge engineering group company for assistance in the field measurements 
21280,in order to obtain the wave forces on the substructure and superstructure of the sea crossing bridge this paper develops a systematic series of wave spectra covering a variety of spectral shapes observed in the bridge site area of pingtan strait bridge error identification of wave data and data reconstruction using the orthogonal matching pursuit of compressive sensing algorithm are conducted to obtain the stable and accurate water level data firstly the characteristic of the wave is then evaluated and the joint distribution of significant wave height and average wave period is investigated using copula models a family of wave spectra is proposed to represent a set of 7084 spectra measured at the 6 platform of the pingtan strait bridge site analytical results show that the proposed wave spectra family pingtan spectra can represent the realistic wave spectra and the pingtan spectra characteristic can also reflect the diversity and randomness of the realistic wave spectrum application of the wave spectra suggests using the proposed spectra to calculate the wave force on the structure of the pingtan strait bridge location keywords random wave sea crossing bridge wave spectrum joint distribution compressive sensing copula 1 introduction with the development of the economy and the increasing trade the sea crossing bridges across the two sides of the strait have great significance for economic development transportation and trade for example the hong kong zhuhai macao bridge yu et al 2013 which was recently built in china connects hong kong zhuhai and macao reducing the time spent crossing these three places and is of great significance in promoting the economic development of hong kong macao and the west bank of the pearl river delta the long span of such sea crossing bridges usually ranging from a few kilometers to tens of kilometers and the sea crossing bridges are often located in the nearshore area many kinds of research have shown that unlike land built bridges the wave force on bridges is also an important control load that cannot be ignored aashto 2008 douglass et al 2006 cuomo et al 2009 xu and cai 2014 2015 hayatdavoodi et al 2015 xu and cai 2017 huang et al 2018a 2018b and the wave force is one of the main causes of damage to sea crossing bridges yeh et al 2007 motley et al 2015 qu et al 2017 huang et al 2019a 2019b therefore it is of great significance to clarify the wave forces on the sea crossing bridge for the construction operation and maintenance of the sea crossing bridge the wave spectrum analysis method is one of the key methods for obtaining the wave forces on the substructure and superstructure of the sea crossing bridge in the ocean environments because of their ability to reflect the statistical variability of ocean waves wave spectra are commonly used in assessing responses of ocean structures prepared wave spectra in the required bridge site area are necessary for the design and construction of sea crossing bridges pierson and moskowitz pierson et al 1964 proposed a single parameter spectrum named p m spectrum which was derived from the measured data in the northeast atlantic ocean this spectrum is appropriate to describe the fully developed ocean waves of the outer sea s infinite wind region the widely used jonswap spectrum was developed from the p m spectrum by multiplying a peak enhancement factor based on a total of 2500 measured spectra hasselmann et al 1976 the jonswap spectrum for a developing sea typically has high and sharp peaks and was applied to wave prediction due to its feature of reflecting energy exchanges a six parameter wave spectrum was proposed to represent various spectral shapes by ochi and hubble 1976 according to the north atlantic ocean measured spectra this six parameter spectrum is superimposed by two three parameter parts to better describe the two peaks spectrum and various spectral shapes in different sea states however the seabed topography changes and the existence of islands make the nearshore sea state could not be described simply by those spectral forms the sea crossing bridge is located at the haitan strait which is surrounding by many small islands furthermore the dramatic changes in the topography of the seabed and wind field in these nearshore areas make it difficult to evaluate the wave forces on the bridge structure which also increases the risks of construction and protection this study aims to propose the appropriate wave spectrum model for the 6 platform of the bridge site area according to a set of measured wave spectra a suitable model of the wave spectrum can help calculate the wave force on the bridge structure accurately and further improve the accuracy and protection of the construction control in section 2 the description of the ocean environment in the bridge site area and the collection of wave data are introduced the discussion of the proposed algorithms in error judgment and reconstruction of the measured data and investigation of wave characteristics are presented in sec 3 characteristics and parameters of wave spectra in the 6 platform are determined in sec 4 the application of the developed wave spectra is conducted in sec 5 finally this study closes with a conclusion about the present work 2 bridge site and data collection 2 1 bridge site this study takes the under construction pingtan strait bridge as an example the bridge is located in the eastern part of fujian province of china with a long span of 1634 0 m and a maximum water depth of 43 0 m the bridge site is located at the north exit of the pingtan strait and the seabed topography is complex with many islands and reefs the nearest ocean observatory fujian marine forecasts station is located in the southeast of the bridge site area and the buoy monitoring points of the ocean forecasting platform are mostly arranged in the open area of the sea compared with the complex marine environment near the bridge site area there are no islands around the buoy monitoring point of the ocean forecasting station and the topography of the seabed is significantly different from that of the bridge site these differences have led to the difficulty of using ocean observation data for wave prediction and wave forces analysis at bridge sites ti et al 2018 the bridge site area has a typical oceanic monsoon climate with the ese normal wave direction and the sub normal wave direction being the sw and sw directions therefore the collection of wave data in the bridge site area and the application of the wave spectrum specific to the bridge site area are of great significance 2 2 wave data collection the wave data measured at the 6 platform 119 619 e 25 709 n near the bridge site are used to investigate the measured wave spectra as shown in fig 1 the sby2 1 ultrasonic wave gauge is installed at the 6 platform in the manner of a cantilever and used to measure the water level the mean water depth at the 6 platform is 18 0 m and the distance from the wave gauge to the mean water level is 13 0 m the measurements of the wave data refer to measure the distance from the wave gauge to the real time water surface the sby2 1 ultrasonic wave gauge performs an hourly 17 min measurement of the water level at a frequency of 2 0 hz a total of 17 040 water level data from dec 30 2014 to dec 28 2016 were collected to perform wave spectrum analysis to obtain stable and reliable water level data the wave gauge must be mounted fixed without any adjustments in the displacement and corner however the extreme wave and wind conditions caused by the complex topography of the seabed strong monsoons and extreme typhoons around the bridge site have a significant influence on wave data measurement the huge wind and wave forces on the platform may induce a displacement of the structure and cause further inaccuracies in the measuring data besides wave gauge failure and water splashing can also lead to errors in measurement therefore the error identification of initial data based on data analysis missing values and incorrect values filling are indispensable for accurately obtaining wave parameters and wave spectrum models brodtkorb et al 1999 liang 2018 also the extreme wave data with a significant wave height greater than 4 0 m are not discussed in the present study due to the high data missing rate of the wave data in addition the long term hydrological historical data of the bridge site shows that the significant wave height below 4 0 m represents most of the wave conditions during construction and operation periods 3 wave data processing 3 1 error identification of wave data fig 2 shows a total of 2049 water level data at 22 00 on oct 29 2016 the error data marked by red circles in fig 2 may be divided into two types missing values and incorrect values according to the wave data analysis the missing values are caused by the failure of the wave gauge to capture the water level information so the values are equal to zero therefore the missing values can be easily determined from the wave data moreover incorrect values are due to instrument sloshing wave breaking and other environmental factors liang 2018 gives a detailed discussion on the proportion of the zero value percentage range and the accumulative proportion of the measured wave elevation data in 2015 he found that the zero percentage of most of the measured data is within 5 and only a few of the zero percentage of the measured data will be 30 higher based on the characteristics of wave data in the bridge site area and the empirical criteria proposed in the wafo matlab toolbox wafo group 2000 liang 2018 presented a comprehensive error identification criterion for wave data on the 6 platform this error identification method takes into account the effects of wave characteristics instrument malfunction and external factors on the data collected so that the error value in wave data can be detected effectively and precisely the following three criteria are used in this study as part of the error identification method 1 the pauta criterion is used to detect outliers with a confidence probability of 99 7 2 based on wave characteristics and the data analysis of long term ocean wave monitoring brodtkorb et al 1999 obtained two empirical criteria for assessing inaccurate ocean wave data 1 x t 5 m s 2 x t g 2 where x t is the wave data and g is the gravity acceleration the 5 0 m s in eq 1 is determined by the limiting maximum raising speed of gaussian waves besides the acceleration of the stokes wave is also restricted to within g 2 3 if the wave data remains constant within 2 0 s then the data acquisition for this period is considered to have failed these constant or missing values may be due to the block of wave gauge and the missing value that is replaced by zero will significantly influence the accuracy of the estimated spectral density 3 2 wave data reconstruction the interruption of signal acquisition and the occurrence of inaccurate data during the acquisition of wave data by the wave gauge add incompleteness to all wave data if an analysis of the wave spectrum is directly studied using incomplete wave data the inaccuracy in generating the wave spectra will result incomplete data also leads to the loss of essential signal information therefore if the missing and erroneous data in the sampling can be reconstructed based on the actual state data the accuracy of the wave spectrum analysis result will be improved the available methods are the time series method regression analyzing method interpolation method and curve fitting approach for data reconstruction and recovery liang 2018 systematically classifies the types of missing data into 11 types reconstructing the missing data by nearest neighbor interpolation piecewise linear interpolation cubic spline interpolation cubic hermite polynomial interpolation sine function fitting etc finally he found the method of cubic spline interpolation is most efficient in reconstructing missing data however these methods estimate the missing data by the distribution or trend of the missing value through the neighboring data without considering the characteristics of the whole data some of those approaches also require a series of equations or high dimensional equations to be solved as the number of data increases the solution process gets increasingly difficult zhang et al 2014 in this study the orthogonal matching pursuit omp of the compressive sensing cs algorithm is utilized to reconstruct the wave data cs algorithm is a sampling theory first proposed by donoho 2006 and candes candes et al 2006 it states that as long as the signal is sparse or compressible the data can be accurately recovered by collecting data far below the nyquist sampling theorem standard signal based on this feature of cs when the sampled data covers the key information of the original signal the original signal can be reconstructed with high probability under the condition of sufficient accuracy in recent years cs has been used in various signal processing fields based on cs katz et al 2009 applied the cs theory to reconstruct the pseudothermal ghost imaging fortunati et al 2014 tested four algorithms based on the theory of cs to estimate the directions of arrival of multiple source signals from a single observation vector of an array of data tropp and gilbert 2007 compared the basis pursuit bp method and a greedy algorithm named omp in signal recovery results demonstrate that omp is more efficient and easier to implement for data recovery problems than bp compared with the mp matching pursuits algorithm the omp algorithm orthogonalizes all selected atoms at each step of the decomposition which makes the omp algorithm converge faster with the same precision requirements pati et al 1993 therefore the sparse approximation algorithm omp based on cs is implemented in this study to reconstruct water level data fig 3 illustrates the flow diagram of the omp reconstruction algorithm utilized in this study in the flow diagram r t represents the residual t is the iteration counter ʌ t represents the set of column numbers at t iterations λ t is the selected numbers of columns at t iterations a j is the column j of the sensing matrix and represents the inner product at t iterations a t represents the set of columns chosen based on ʌ t and θ is the sparse representation of the signal x after reconstruction the detailed discussion of the omp algorithm for reconstruction can be seen in pati et al 1993 and tropp and gilbert 2007 the measurement data without error data were selected for testing to verify the effectiveness and accuracy of the omp reconstruction algorithm in data reconstruction under the different rates of the error data a total of m 2000 data sets is selected and n data is randomly omitted from each set of data where n represents the error rates from 0 to 60 the reconstruction accuracy of the data is expressed by the ε mean relative error mre the calculation of mre is conducted for each set of data with the above error rates 3 ε 1 n i 1 n y i x i x i where y i is the ith term after data reconstruction and x i is the ith term of origin signal x fig 4 shows the accuracy of data reconstruction with different error data rates it can be seen from fig 4 the omp reconstruction algorithm can reconstruct the wave data perfectly when the data missing rate is below forty percent the average relative error will increase significantly after the data missing rate reaches fifty percent therefore the missing rate of the measured wave data that below forty percent is used in the subsequent wave spectrum analysis besides the moving average method is used to remove the influence of the tidal level on wave data 3 3 wave characteristic for the analysis of the wave characteristic with the upward zero crossing technique the statistical calculation is performed on the reconstructed wave data the characteristic wave defined by the average value of some large waves is used as the characteristic parameters of wave statistics fig 5 presents the variation of significant wave heights h s and average wave periods t in 2015 the significant wave height data in fig 5 is the maximum value of h s measured each day and the wave period adopts t corresponding to h s it can also be concluded that the significant wave heights are lower than 2 0 m during most of the month except for january july august and september fig 5 shows that the maximum value of h s during 2015 is 3 82 m which was measured at 16 00 on aug 08 2015 and the maximum value of h s is 9 80 s that occurred at 05 00 on jul 07 2015 the large significant wave heights measured in july august and september are caused by the typhoon and the large significant wave heights measured during the monsoon period january are caused by the high wind speeds it can be found in fig 5 that most of the severe wave conditions were observed and studied and the lack of monitoring in august was caused by the failure of the wave gauge in general large wave heights and wave periods may occur during the typhoon and monsoon periods and the wave conditions near the bridge site are basically in a quiet period from march to june which is suitable for the construction of offshore structures wave height and wave period are both very important to the study of wave spectrum and wave force in the marine environment once the correlation between wave height and wave period can be established the corresponding return period for the combinations of the wave height and wave period can be determined for the further study of offshore structures in the present study the copula model is used to simulate the correlation between the wave height and wave period based on the measured data in 2015 copulas can be used to provide multivariate dependence structure separately from the marginal distributions and the most frequently used elliptical copulas and archimedean copulas model are used here to find the optimal joint probability distribution of h s and t a copula is a multivariate distribution whose marginals are all uniform over 0 1 let f be a 2 dimensional distribution function with margins of the bivariate x y and sklar 1959 first showed that there exists a 2 dimensional copula c such that can transform any pair x y of continuous random variables to the uniform joint distribution function f x y over 0 1 by its probability integral transformation 4 f x y c f x f y α where f x y is the joint cumulative distribution f x and f y is the marginal distributions of variables x and y respectively α is the dependence parameter that is calculated through fitting copula based models with the maximum likelihood method next the marginal distributions for h s and t should be examined to achieve the copula model of h s and t for the measured data in 2015 the distribution of h s can be determined using the probability distribution function pdf and many commonly used probability distribution functions such as gamma burr weibull rayleigh normal et al are adopted to select the most appropriate one for h s fig 6 shows the histogram of h s and the comparison of several fitted probability density functions the akaike information criterion aic is utilized to evaluate the goodness of the fit for several probability distribution functions to achieve the best fitted probability density function for the histogram of h s 5 a i c 2 k 2 l θ where k represents the number of parameters used in the probability density function and l θ is the maximum log likelihood value of the probability density function besides the lowest aic value suggests a better fitted function fig 6 shows that the calculated mean value and variance of h s is equal to 0 86 m and 0 30 m2 respectively table 1 shows that the mean value and variance that are calculated based on these four probability distribution functions all give reasonable approximations combined with the aic value it shows that the marginal distribution of h s follows the gamma distribution the measured h s is concentrated between 0 25 m and 1 25 m and it is not too much for the case of h s greater than 3 0 m wen and yu 1985 suggested that the wave height distribution could be represented using the rayleigh distribution based on a large amount of deep sea field data fig 6 shows that the rayleigh distribution gives a fair accuracy in fitting the distribution of h s especially for h s larger than 1 0 m but the rayleigh distribution presents a lower estimation of the distribution of h s for h s smaller than 1 0 m it is found that the gamma distribution is the best choice for representing the distribution of h s when combining aic value average value and variance fig 7 shows that the calculated mean value and variance of t is equal to 4 09 s and 0 99 s2 respectively table 2 shows that the aic value mean value and variance of burr distribution gives the best approximation of marginal distributions for the average wave period t the other three distributions deviate from the average value of the average wave period towards the small period value the burr marginal distribution of the average wave period shows that the average wave period is concentrated between 3 25 and 5 0 s however the burr distribution still presents a slightly low estimate of the distribution of t for around 5 0 s after obtaining the marginal distribution for h s and t the most frequently used four copula models clayton frank gumbel and gaussian copula are utilized to correlate these two variables fig 8 shows the contour of probability density between four copula models and measured points for h s and t it should be mooted that the measured point used in fig 8 only included the wave data presented in fig 5 for a clear illustration as is demonstrated in fig 8 the distribution of significant wave height is concentrated when the wave period is small when h s increases the distribution of t is more dispersed as can be seen from the comparison of four copula models and measured points the clayton copula model is in good agreement with the measured points because the clayton copula agrees with the measured points suggesting the strong correlation between h s and t also the lowest aic value for clayton copula in table 3 supports this viewpoint 4 wave spectrum analysis 4 1 wave spectrum characteristic the wave spectrum is used to describe the energy distribution of the constituent waves of the ocean waves spectral analysis is the clarification of a wave s energy distribution relative to frequency direction or other variables the fast fourier transform fft is generally used to convert the wave data into a spectrum in this section the evolution of wave spectra during the monsoon period between jan 11 and jan 13 in 2015 will be discussed firstly shown in fig 9 in the marine environment the ocean waves usually consist of swell and wind generated waves the occurrence of pure wind generated waves or swell is very rare and most of them are in the form of mixed waves with the change of the wind field in the marine environment the ocean waves are often in different stages of development during the monsoon period the bimodal wave spectrum presents the wave energy is distributed in a wide frequency domain with the increase of the severity of the sea conditions shown in fig 9 for h s 0 78 m the wave spectrum for h s 0 78 m shows that the wave spectrum measured at 17 00 on jan 11 2015 is a mixed wave dominated by the swell which is caused by the superposition of the distant swell and the wind generated waves at the 6 platform as the severity of the sea conditions continued to increase the spectral peak value of the wave spectrum continues to increase and the modal frequency of the wave spectrum moves to the lower frequency domain for h s 1 94 2 74 and 3 8 m in fig 9 wave spectrum energy is also more concentrated and a single peak wave spectrum appears however it can be seen from the wave spectrum for h s 2 74 m in fig 9 that energy is still distributed in a wide range of frequency domain during the development of the wave spectrum thus the ocean waves cannot be accurately described by a single peak wave spectrum even with the h s equal to 2 74 m with the decrease of the severity of the sea conditions and the wind generated waves gradually dissipate the spectral peak value of the wave spectrum decrease and the modal frequency of the wave spectrum slowly moves to the higher frequency domain for h s 3 80 3 04 2 68 1 83 and 1 34 m in fig 9 also it shows that the wave spectrum gradually shows the characteristics of bimodal peaks with a gradual dissipation of the wind generated waves for h s 3 80 3 04 2 68 1 83 and 1 34 m in fig 9 it is found that the significant wave heights are mainly concentrated between 0 50 and 1 50 m in section 3 3 and the majority of the ocean waves in this range are in the form of mixed waves presenting with the bimodal wave spectra the wave spectrum converted from the wave data measured on the 6 platform will be compared to several widely used wave spectra proposed so far fig 10 shows a comparison between different existing wave spectra and measured spectrum the water depth for the 6 platform is 18 0 m and the measured wave data comes from 15 00 on dec 30 2014 following the wave data statistics h s is 0 39 m and t is 4 67 s several existing wave spectra are shown in fig 10 are briefly described below based on the newman spectrum neumann 1952 bretschneider 1959 used the joint distribution function of the dimensionless wave and dimensionless wavelength to derive the two parameter b spectrum the form of the b spectrum as shown below 6 s ω 1 25 4 h s 2 ω m 4 ω 5 exp 1 25 ω m ω 4 where ω m is the peak frequency of the spectrum the widely used p m spectrum was proposed by pierson and moskowitz 1964 based on the measured wave data of the north atlantic the formula derived further can be expressed as 7 s ω 0 78 ω 5 exp 5 4 ω m ω 4 where ω m 1 257 h s 1 2 is the peak frequency of the p m spectrum the modified jonswap spectrum used in this section was proposed by goda 1999 8 s ω α h s 2 ω m 4 ω 5 exp 5 4 ω m ω 4 γ exp ω ω m 2 2 σ 2 ω m 2 9 α 0 06238 1 094 0 01915 ln γ 0 230 0 0336 γ 0 185 1 9 γ 1 where α represents the parameter of the dimensionless fetch γ is named the peak enhancement parameter and its recommended value ranged between 1 and 20 and σ is the peak shape factor which is equal to 0 07 when σ smaller than or equal to the peak frequency and is equal to 0 09 when σ larger than the peak frequency the last one is the six parameter wave spectrum which was proposed by ochi and hubble 1976 according to the north atlantic ocean measured spectra the formulation of the most probable six parameter wave spectrum can be expressed as 10 s ω 0 25 i 4 λ i 1 4 ω m i λ i γ λ i ζ i 2 ω 4 λ i 1 exp 4 λ i 1 4 ω m i ω 4 where i 1 2 represents the lower and higher frequency terms respectively λ i is the control parameter of the shape of wave spectra ζ i represents the function of h s and г λ is the gamma function evaluated at λ a comparison of various existing wave spectra and the measured spectrum is shown in fig 10 and the measured spectrum illustrates the property of two peaks the wave spectrum obtained from a large amount of measured data reflects double peak characteristics the measured spectrum s lower and higher frequency terms relate to the wave that is generated by swell and wind in the bridge site area moreover the peak value of the measured spectrum is larger than b spectrum and p m spectrum in the next section the accurate representation of measured wave spectra is required to further calculate the structural response of bridge structures accurately under wave loading and optimize bridge design although the peak value of the jonswap spectrum is also similar to the measured spectrum the six parameter spectrum has two characteristics of high frequency and low frequency which is better for representing the measured spectrum what is important is that although the wave energy in the higher frequency part is lower than that in the lower frequency part some parts of the bridge structure are more sensitive to high frequency parts therefore dividing the wave spectrum into high frequency and low frequency components that is using a six parameter spectrum to represent the measured spectrum is a better choice besides many researchers have found that except for a few cases where the wave spectrum still presents a single peak most of them are bimodal or multiple peaks based on the analysis of measured wave spectrum hwang et al 2012 portilla et al 2009 violantecarvalho et al 2004 thus the study of the measured spectra that fitting by the six parameter wave spectrum plays an important role in calculating the wave forces and responses of structure in this area and the parameters in the six parameter spectrum can be expressed by the significant wave height which is more convenient for engineering applications 4 2 wave spectrum representation even if h s is the same in the same bridge site area the spectrum shape will be different because of the influence of the wave swell and the wind field therefore a precise expression of the spectrum is necessary to determine the structure s response under the action of the wave and the wave loading on coastal bridges in this section the six parameter spectrum method proposed by ochi and hubble 1976 is used to calculate the wave spectrum based on the reconstructed measured data the detailed procedures of spectral representations are summarized as follows 1 a set of a total of 7084 reconstructed measured data is divided into 7 groups according to h s the specific grouping of the reconstructed measured data according to their significant wave heights is shown in table 4 based on eq 10 and measured data the six parameters of each spectrum are determined by the nonlinear least squares method and information stored in the wave spectrum a nonlinear least square program developed in the python platform ensures minimal difference between the measured spectrum and the theoretical spectrum to avoid the possibility of an unrealistic representation of the spectral shape only the modal frequency of the higher frequency part ω m2 is restricted to more than 0 6 during the nonlinear least square fitting suppose a spectrum has triple peaks two of which are below 0 6 in the frequency range but only the bimodal spectrum can match the formula shape of the six parameter spectra in this case representing the two peaks in the frequency range below 0 6 by one peak may be more appropriate and considering the other peak in the higher frequency part therefore the lower frequency component with a relatively large peak value will be selected and the nonlinear least squares method will be combined to deal with this situation so that the fitting effect can reach the best moreover the restriction of the higher frequency part ω m2 will ensure a better fit of the curve in the higher frequency part associated with the wind generated waves besides ochi and hubble 1976 also used a frequency of 0 6 as the dividing line between high and low frequencies to illustrate the accuracy of fitting wave spectrum using the nonlinear least squares program and the validity of the six parameter spectrum reflecting the wave condition measured at the 6 platform several comparisons between the measured wave spectrum and fitted mathematical six parameter spectrum are shown in fig 11 fig 11 a shows the bimodal wave spectrum composed of ocean swells and wind generated waves fig 11 b also shows that the wave spectra with double peaks can be accurately represented with the six parameter spectrum due to their specialization of high frequency and low frequency components in addition fig 11 c j show these wave spectra represent the development of the ocean wave condition caused by wind and the wind generated waves grow and develop all these fitted wave spectra shown in fig 11 are in close agreement with the measured spectra and the peak errors of the first spectral peak are within 5 deviation the range of root mean square error rmse and the peak errors of the first spectral peak between the theoretical spectra and measured spectra for each wave height group are also given in table 4 it is showed that the rmse values for all groups are relatively small and the peak errors of the first spectral peak for all groups are within 10 deviation 2 the six parameter spectra of all the reconstructed data are obtained by the nonlinear least square method but the parameters of the six parameter spectra for each group are different therefore the statistical analysis of six parameters for each group are needed to obtain statistical characteristics of each parameter then statistical spectral parameters can be used to generate a family of spectra for a given h s to represent all reconstructed measured wave spectra the spectra family includes the probable spectra and the wave spectra with a guaranteed probability of 95 percent in each group the statistical analysis is conducted for each parameter including the function of significant wave height ζ 1 ζ 2 the control parameter of the shape of wave spectra λ 1 λ 2 and the modal frequency ω m1 ω m2 for the low and high frequency parts respectively first take the control parameter of the shape of wave spectra λ 1 for the low frequency part for group ⅲ as an example which indicated that the wave spectra with significant wave heights ranging from 1 0 m to 1 50 m are included in this sample the distribution of parameter λ 1 can be determined using the probability distribution function pdf and many probability distribution functions such as birnbaum saunders burr gamma inverse gaussian normal et al are adopted to choose the most appropriate one for each parameter fig 12 a shows the histogram of the control parameter λ 1 of the shape of wave spectra for group ⅲ and the comparison of several fitted probability density functions table 5 summarizes the calculated aic value as well as the corresponding mean value and variance of each probability density function for the control parameter λ 1 the aic values show that the inverse gaussian model is a suitable distribution of the control parameter λ 1 compared to the other four models the inverse gaussian model may better reflect the control parameter distribution λ 1 table 5 also shows that although the fitting effect of each probability density function is different the differences in the variance and average value between probability density function are relatively small as for the parameter of the function of ζ 1 for group ⅲ the histogram and the comparison of several fitted probability density functions are shown in fig 12 b table 6 also gives the calculated aic value and the corresponding mean value and variance of each probability density function for the function of ζ 1 it shows that the function of ζ 1 obeys the logistic distribution law and achieves similar mean values and variances fig 12 c f present the histogram and probability density function of some parameters in group ⅱ and the appropriate probability density functions of these parameters are also determined using the aic method it shows that most of the appropriate distributions of the parameters are not the normal distribution which is quite different from the six parameter wave spectra measured at the north atlantic ocean ochi and hubble 1976 the possible reason for this phenomenon is that the six parameter wave spectra measured at the north atlantic ocean were observed during the stage of growth and decay of a storm in a short time however the wave spectra measured at the 6 platform near the bridge site were collected from dec 30 2014 to dec 28 2016 to perform wave spectrum analysis and the long periods of observation results in the complexity and randomness of the parameters of the wave spectrum in the present study to develop the family of wave spectra the modal frequency ω m1 for group ⅱ h s from 0 50 m to 1 0 m is taken as an example to explain the whole calculation process first the mode value of the modal frequency ω m1 equal to 0 982 rad s can be determined from the probability function obtained from the statistical analysis above then two values of the modal frequency ω m1 0 638 rad s 1 473 rad s were determined by 95 percent of the probability density function therefore a total of three values for the modal frequency ω m1 including the mode value the upper and the lower values determined from a confidence band for a confidence coefficient of 0 95 can be obtained in each group next the other five parameters in the six parameter wave spectra can be found from the fitted six parameter wave spectra based on the value of the modal frequency ω m1 however due to a large amount of wave spectra data there may be many wave spectra with the same value of the modal frequency ω m1 using their respective averages in the region of 5 percent of the value of the ω m1 modal frequency will solve the above problem effectively while making the data more representative similarly the mode values the upper and the lower values of the modal frequency ω m1 for other groups are achieved using the same method all values of the modal frequency ω m1 obtained from all groups are plotted in fig 13 as a function of significant wave height ζ all the fitted exponential functions present the close agreements with the mode values the upper and the lower values of the modal frequency ω m1 for all groups the remaining five parameters are determined by the above method mentioned and these parameters for all groups associated with the mode values the upper and the lower values of the modal frequency ω m1 are plotted in fig 14 a to 14 e thus three spectra associated with the modal frequency ω m1 can be obtained and all parameters are expressed as a function of ζ it should be mentioned that the proposed wave spectra are applicable for wave conditions with ζ smaller than 4 0 m due to the wave spectra investigated in the present study the same procedure for deriving three spectra associated with the modal frequency ω m1 is conducted for the other five parameters and thus a total of eighteen wave spectra can be established for a given wave condition the family of wave spectra includes six mathematical spectra related to the mode value of the six parameters twelve mathematical spectra associated with the confidence band for a confidence coefficient of 0 95 of the six parameters the values of the six parameters for those eighteen wave spectra are shown in table 7 a total of eighteen wave spectra for a given wave condition can be established based on table 7 and eq 10 fig 15 show the family of wave spectra for ζ 0 50 m 2 0 m and 4 0 m respectively these figures show that the shape of the family of wave spectra varies significantly for a certain wave condition and the modal frequency of the wave spectra family is widely distributed from 0 40 to 1 0 in fig 15 b the family of wave spectra developed in the present study can represent the realistic wave spectra of the 6 platform of pingtan strait bridge and the characteristic of the family of wave spectra can also reflect the diversity and randomness of the realistic wave spectrum 5 application of pingtan spectra the random wave forces on the substructures piles and piers can be evaluated using the proposed family of six parameter wave spectra called pingtan spectra in this section to meet the design and construction requirements of the sea crossing bridges the random wave forces on the steel concrete composite pile with a diameter of 3 0 m used in the construction of the pingtan strait bridge were chosen as an example of application the ζ is set as 4 0 m the water depth is d 18 0 m and the wave period is 10 0 s based on the dispersion relation of the ocean wave the wave length l can be estimated equal to 117 0 m the spectral analysis and the morison equation are therefore used to calculate the wave forces on the piles because the pile diameter is smaller than 0 2 times the wave length the spectrum of wave force on the pile can be expressed as 11 s f ω k d 8 π ω sinh k d 0 d σ u z cosh k z dz 2 s ω k i ω 2 k 2 s ω and the k d and k i are defined based on the inertia and drag coefficient respectively as 12 k d 1 2 c d ρ d 13 k i c m ρ π d 4 2 where c d 1 2 and c m 2 0 represents the drag and inertia coefficients respectively k 2π l 0 0537 is the wave number s ω is the wave spectrum z is the distance from a point of the pile to the seabed ρ is the density of water and the mean square deviation of the velocity of water σ u is defined as follow 14 σ u 2 0 ω cosh k z sinh k d 2 s ω d ω fig 16 shows the spectra of wave forces on the pile with above wave conditions under the action of the p m spectrum b spectrum the most probable six parameter spectrum and pingtan spectra due to a large number of pingtan spectra including six probable spectra and twelve spectra associated with the confidence band for a confidence coefficient of 0 95 only the spectra of wave forces for six probable spectra are illustrated in fig 16 for simplicity and clarity fig 16 shows that the spectra of wave forces for six probable pingtan spectra are significantly different from those for the p m spectrum b spectrum jonswap spectrum and the most probable six parameter spectrum for different spectra the peak values of the spectra and their corresponding frequencies all demonstrated significant influence table 8 presents the significant wave forces cumulative probability equal to 13 5 estimated from each wave spectrum based on the assumption that the extreme value of wave force conforms to the rayleigh distribution among them the mode upper band and lower band values of the significant wave forces corresponding to the pingtan spectra eighteen wave spectra are given after statistical analysis table 8 shows that the wave force calculated using the pingtan spectrum is larger than those are calculated using other spectra thus it is suggested to use pingtan spectra to calculate the wave force on the structure at the 6 platform the significant wave forces can be expressed as 15 f s k σ s where k 2 0 is the coefficient corresponding to the value of the cumulative probability and the σ s is the mean square deviation of the total wave forces that can be calculated as follow 16 σ s 0 s f ω ⅆ ω the mode value of the significant wave forces calculated by the proposed pingtan spectra is recommended for engineering application besides it should be noted that the pingtan spectra are being proposed based on the wave data measured at the 6 platform and the dramatic changes in seabed topography near the bridge site also bring some differences for the wave spectra in different sites around the bridge in addition this pingtan strait bridge traverses several islands along the way adding significant influences on the wind field and the swell propagated from open seas therefore the applicability of pingtan spectra at other locations in this sea area still needs further study in the future however the proposed pingtan spectra can provide reliable input for the swan or mike21 numerical module and further investigate the wave conditions in sea areas close bridge sites akpinar et al 2016 ti et al 2018 conclusions because of its ability to reflect the statistical uncertainty of ocean waves the wave spectra are widely used in assessing wave forces on sea crossing bridges the cs algorithm is used to reconstruct the measured water level data and the statistical calculation on the reconstruction wave data is carried out to analyze the characteristic of the wave and the joint distribution of significant wave height and average wave period then a family of wave spectra is developed based on the statistical analysis of the total 7084 measured spectra finally the present study performs a comparison of the significant wave forces on the steel concrete composite pile of the sea crossing bridge based on the spectral analysis and the morison equation and shows the following 1 the omp algorithm can perfectly reconstruct the wave data when the data missing rate is below forty percent the average relative error will increase significantly after the data missing rate reaches fifty percent 2 the statistical calculation of the measured data shows that large wave heights and wave periods may occur during the typhoon and monsoon periods and the wave conditions near the bridge site are generally in a quiet period from march to june which is suitable for the construction of offshore structures the clayton copula gives the best approximation of joint distributions of the significant wave height and the average wave period 3 the measured wave spectrum reflects the characteristics of double peaks and the lower and higher frequency terms of the measured spectrum may be related to the swell and wind generated wave in the bridge site area the wave spectrum has two characteristics of high frequency and low frequency with six parameters is better for representing the measured spectrum 4 the proposed family of wave spectra pingtan spectra can represent the realistic wave spectra at the 6 platform of the pingtan strait bridge and reflect the diversity and randomness of the realistic wave spectrum 5 it should be noted that the pingtan spectra are proposed based on the wave data measured at the 6 platform and the dramatic changes in the topography of the seabed and wind field near the bridge site also bring some differences for the wave spectra at different sites around the bridge the applicability of pingtan spectra at other locations in this sea area and the correlation between wind speeds and wave spectra still needs further study in the future credit authorship contribution statement bo huang writing original draft investigation qingyang ren conceptualization methodology xiaolu cui investigation validation tong wan software formal analysis chengran zhang data curation bing zhu writing review editing project administration hao ding writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful for the support of this research by the national natural science foundation of china 52008065 41472262 51805057 51978600 the national natural science foundation of china china railway corporation high speed railway basic research joint fund project u1834207 the chongqing municipal education commission science and technology research project kjqn202000706 the china postdoctoral science foundation 2020m683229 the key project of national key research and development project 2016yfc0802206 3 the program for innovation team building at institutions of higher education in chongqing cxqt19021 the major applied basic research frontier projects in sichuan province 2017jy0003 and the high level technical personnel training project of transportation industry the authors express their gratitude to china railway major bridge engineering group company for assistance in the field measurements 
21281,a long short term memory lstm neural network model is developed to provide a real time calculation tool for monitoring the mooring line responses under the operating condition by using the vessel motion as the only input a feature extraction method based on first order moment and second order center moment is proposed in the data pre processing to improve the characteristics of fluctuation information of input data the effective judging standard of the scope of prediction accuracy regarding the proposed neural network model is defined the impact of normalization method neural number and training sets length on the predicting accuracy are studied the feasibility of the established lstm neural network model is verified considering different data relevance between the training sets and validating sets the results indicate that the mooring line responses can be predicted with high precision based on the vessel motion as input by using the established lstm neural network model keywords mooring system lstm neural network optimal network structure feature extraction 1 introduction offshore oil production activities in deep and ultra deep water are mainly accomplished through floating production systems such as semi submersible platforms or ship type vessels containing fpso floating production storage and offloading the service ocean environment of a deep water floating platform is extremely complex and harsh once an accident occurs it will cause serious economic and environmental damage the mooring system is commonly used as the positioning device so it is of vital importance to monitor the tension response of the mooring line to prevent potential damage at present the installation of monitoring equipment on the mooring line in the field is expensive also due to the harsh marine environment the monitoring equipment such as the inclinometer and tensiometer may easy to be a failure which would result in the discontinuous monitoring data meanwhile the cost of long term maintenance and service are also very expensive the current gps global positioning system monitoring technology is relatively mature and the 6 degrees of freedom response of the vessel motions are easy to be obtained while the gps monitoring data is usually much more stable than the monitoring data of mooring line tension minnebo et al 2014 therefore using the monitored vessel motion as the input of forced excitation at the top of the mooring line the responses of mooring line can be calculated by the complicated finite element software which can accurately capture the nonlinear behavior of a moored vessel and its mooring system however the computational time consuming of conventional finite element software is too long which cannot predict the mooring line tension in real time and the simplified method based on the static analysis of mooring line cannot consider the effect of dynamic effect which can significantly underestimate the dynamic mooring line tension so the improvement of calculating speed which can also consider the dynamic effect becomes a worth study correa et al 2015 as one of the options artificial neural networks ann is used to solve the computational time consuming problem and the ann has been used in many applications related to marine and ocean engineering ok et al 2007 used the ann method to assess the ultimate strength of plates with pitting corrosion yasseri et al 2010 used the bp neural networks to predict the future sea conditions at a specific time based on the several known measured sea conditions through buoys quéau et al 2014 used the bp neural network to study the fatigue behavior of catenary riser in the case that only the static load is considered while the inertia or damping is ignored mak and düz 2019 used the machine learning approaches to estimate the relative wave direction based on the time histories of six degrees of freedom ship motions kim 2015a 2015b used the narx neural network to identify the nonlinear structural response of the catenary riser based on the secondary volterra series chaves et al 2015 2016 predicted the tension curvature and fatigue life of flexible pipeline based on the combinations of dynamic finite element analyses and ann de pina et al 2016 used the ann to give the preliminary design of the mooring system considering the parameters of metocean data water depth the requirement of vessel motion mooring line tension and the riser layout wu et al 2013 2017 hu et al 2011 and du et al 2014 used the rbf neural network to optimize the dynamic performance of tiaozhan fpso at the south china sea considering its mass moment of inertia and center of gravity position as the target variables yu and wang 2018 yu et al 2019 used the deep neural networks to optimize the body shape and geometric proportion of trimaran with the aim of best calm water transportation efficiency by using the vessel motion for predicting the mooring line responses there are also some research work that has been reported guarize et al 2007 used the previous vessel motion and the corresponding mooring line tension histories as the training data in which the correlation of previous histories is taken into account through adding the number of delays for vessel motions as the input layer and then use the optimized ann model to predict the mooring line tension the results show that using a short time history can accurately predict a much longer time of slender structural responses and also indicate that the ann model must be trained case by case and the responses of slender should be stable sidarta et al 2018a investigated the influences of the number of hidden layer and the number of neurons in the hidden layer on the learning efficiency of the ann model then the method to detect the mooring line failure damage is proposed sidarta et al 2018b 2019 kyoung et al 2019 in which the low frequency motion and yaw angle of the hull from the gps monitored data are set as the input and the damaged mooring line is detected through recognizing the changes of low frequency motion and yaw angle of the hull the results indicate that the effectiveness of ann model is closely relative with the training data and the trained data should be comprehensive enough to cover the expected predicted value christiansen et al 2013 2015 compared the influences of training sets length and the number of neurons in the hidden layer on the sensibility of ann model and the results indicate that the temporal order characteristics of vessel motion can be improved through increasing the length of previous time histories and the number of delays however the computational time also increases de pina et al 2013 used the narx neural network model to predict the mooring line tension while the vessel motions are set as input and the output data can be used as input data to re enter the training model which means the recurrent property is introduced and then compare the influence of different delay length on the predicting accuracy in general using the vessel motion as input applying the ann model can accurately predict the mooring line responses and this is a worthy addition to cover the shortage of traditional monitoring devices however the predicting results are strongly depend on the input training data much of the previous work follows entirely experience to ensure the data of training sets with the input selected in a completely random or monte carlo method such as the initial back propagation bp neural networks method needs to use the random input data to ensure the convergence wang et al 2017 however for the input data of the time series the random selection may lead to the data lose relevance for example under the operating sea state condition the motion responses of a floating structure are reciprocating which means that even if the position of floating structure is the same at different time while the mooring line tension may be different due to the interaction of floating structure and dynamic effects of mooring line in other words starting from the data itself the same original input value of vessel motion may correspond to different original output value of mooring line tension with the reason of that the certain time of data value where this original input value located has different characteristics of fluctuation information the aiming of this paper is to use the vessel motion as input to predict the mooring line responses and the time series of motion responses of vessel and mooring line have obvious data correlation characteristics therefore the continuous time series of vessel motion and corresponding mooring line tension are used as the input and output data in the training sets and how to contain the data relevance of training sets further mine the temporal order characteristics of vessel motion data choose the corresponding suitable ann structure and define the effective precision scope of the established neural network are investigated in this paper a lstm long short term memory neural network model is developed to predict the mooring line responses based on the training data which is from the numerical simulation of vessel motion and its corresponding mooring line responses and the lstm method could consider the recurrent and memory effect of time series data and avoid the problem of long term dependence of sequence data hochreiter and schmidhuber 1997 firstly a feature extraction method based on first order moment and second order center moment is proposed in the data pre processing which can further include the characteristics of fluctuation information contained in the time history data then the effective precision scope of the proposed neural network model is defined in addition the influence of normalization method neural number and training sets length on the calculation accuracy of the established model are studied finally the feasibility of predicting the mooring line through the developed lstm neural network model is verified by case studies 2 lstm neural network model 2 1 basic concepts of ann the ann is a network of adaptable and simple processing units connected to each other in a broad parallel the artificial neuron is the basic unit of an ann which mainly simulates the structure and properties of biological neurons receives a set of input signals and then produces output signals as shown in fig 1 an input x x 1 x 2 x n is given and the linear combination z is calculated through the sum of each input neuron x i multiplies the weight of synapse w i and then the output y is calculated through the activation function f z a neural network is the hierarchical arrangement of some simple interconnected neurons and it can be generally divided into the input layer hidden layer and output layer the hidden layer may consist of several layers of neurons or only just one layer of the neuron as shown in fig 2 the output of each hidden layer neuron y j is 1 y j f i 1 n w i j x i where w i j is the synaptic weight from neuron x i in the input layer to neuron j in the hidden layer also the output y o of total hidden layer neuron is 2 y o g j 1 j w j o y j g j 1 j w j o f i 1 n w i j x i where w j o is the synaptic weight from neuron j in the hidden layer to y o in the output layer g is the activation function of output layer after the neural network is established and initialized it needs the training to get the desired results the principle of the training process is to regulate the synaptic weights w i j using a set of desired output and input data the training process relies on the availability of the input output data x v o where v o is the actual output value corresponding to the given input x the training of neural network consists of the following steps firstly a set of input data x x 1 x 2 x n is delivered into the neural network through the connection of neurons until the output layer results in a response y o secondly the resulting response y o is compared to the desired actual output value v o so the generated total error is e y o v o thirdly the generated error is distributed to each unit in each layer in the process of back propagation and the error value of each unit e j are obtained finally adjust the synaptic weight w i j to minimize the generated total error to match the accuracy requirement therefore the generated total error e y o v o also can be calculated 3 e 1 2 j 1 n e j 2 then based on the generated total error e the modification of synaptic weight δ w i j is calculated from the learning rate parameter η and equations 1 3 4 δ w i j η e w i j η e e j e j y j y j x j x j w i j therefore the new synaptic weights w i j n e w can be obtained 5 w i j n e w w i j δ w i j finally this training process will be repeated until the generated total error is lower than the accuracy requirement a well trained neural network can provide the required output for data that is within the effective precision coverage of the training sets but not the same as the training 2 2 characteristics of lstm neural network in this study the lstm neural network which is a kind of ann including the time cycle structure in deep learning and can accurately model the time series data in the calculation of lstm neural network model the past iterations and samples are remembered which can affect the current decision the current and past of input data as well as the past lstm neural network computation state are all considered as the input to solve the current output therefore the time series needs to be discretized with equal time steps d t similar in equation 2 shown above so the output of the training model is 6 y o g v s t v f u x t c t 1 w s t 1 v f u x t c t 1 w f u x t 1 c t 2 w s t 2 v f u x t c t 1 w f u x t 1 c t 2 w f u x t 2 where g is the activation function of the output layer v is the weight matrix of the output layer s t is the calculation formula of the hidden layer which includes three types of input namely the current input layer x t the input of the hidden layer at the previous time step s t 1 and the status of the neuron at the previous time step c t 1 f is the activation function of hidden layer u is the synaptic weight matrix form the input layer to the hidden layer w is the synaptic weight matrix from the s t 1 to the hidden layer at this time step 2 3 input and output data in this study the lstm neural network model is developed to predict the response of the mooring line by the known motion responses of the vessel a fpso with turret mooring is chosen as the research object and the full coupled responses analysis of fpso and its mooring systems are conducted in the time domain the specific parameters are shown in the following section 3 1 therefore the data used in the lstm neural network model contains the input of six degrees of freedom motion responses of fpso which is defined as the original input value and the output of responses of mooring lines which is defined as the original output value after giving the complete input and output time histories of each operating sea states in the data of lstm neural network model the whole data is divided into the training and validating sets which are respectively used for training the lstm neural network model and validating the accuracy of the predicting results from the trained lstm neural network model the prediction accuracy is totally determined by the training effect of the model which mainly depends on the availability of the input output pairs x v o from the training sets in order to improve the training effect the input output pairs of the training sets should contain all possible cases and the data should be evenly distributed in the range of possible cases in addition the validating sets should be independent of the training sets that is the data of validating sets is located in the range distribution of the training sets but not exactly the same as that of the training sets the aim is to evaluate the ability of trained lstm neural network model to obtain the respected output when the input is not participating in the training process and to validate the prediction accuracy meanwhile in this paper the data selected from the training sets are successive and the length of data representing one operating sea state condition of fpso is selected which makes the size of training sets in a reasonable value in other words the selected training sets can fully represent the data characteristics of this operating sea state condition of fpso and it cannot inundate the individual special situations due to too much data 2 4 data pre processing 2 4 1 normalization typically the input and output have different units and proportions for example surge sway is measured in meters while roll pitch is in degrees thus the normalization of the original input value and the original output value is required before the calculation of neural networks after the normalization the normalized input and output value could be imported into the neural network for training and validating similarly the output value calculated by the neural network also needs to be inversely normalized there are two commonly used normalization methods the standard normalization and the min max scaling normalization as shown in equations 7 and 8 respectively the comparison of the effects of these two normalization methods on the accuracy of lstm neural network computation is shown in section 3 3 1 7 x i n o r m x i a b n o r m μ a b n o r m x σ a b n o r m x 8 x i n o r m x i a b n o r m x i a b n o r m min x i a b n o r m max x i a b n o r m min where x i a b n o r m is the original input value x i n o r m is the normalized original input value μ a b n o r m x is the mean value of original input value σ a b n o r m x is the variance of original input value x i a b n o r m max is the maximum of original input value x i a b n o r m min is the minimum of original input value 2 4 2 feature extraction of input data as described in section 2 3 the lstm neural network is used to consider the correlation of data in theory it can be done well if the input output data in the training sets are continuous however in order to further contain the data relevance of training sets and improve the accuracy of predicting result the first order and second order central moments which can describe the characteristics of fluctuation information of original input value are introduced during the input data the first order and second order central moments of the normalized original input value are also setting as the input together with the original input value aiming to improve the characteristics of fluctuation information of input data the comparison of feature extraction on the accuracy of ltsm s calculation results is shown in section 3 3 1 for each x i of input x x 1 x 2 x n the equations of calculating the first order moments and second order central moments are 9 e x i n o r m f 1 x i n 1 n o r m x i n 2 n o r m x i n o r m 1 n j 0 j n 1 x i j n o r m 10 e x i n o r m 2 f 2 x i n 1 n o r m x i n 2 n o r m x i n o r m 1 n j 0 j n 1 x i j n o r m e x i n o r m 2 where n is the data length of calculating the first order moments and second order central moments when the data features are extracted in this paper 18s duration of motion responses of fpso is taken as the input data length e x i n o r m and e x i n o r m 2 are the first order moments and second order central moments of x i combining x i n o r m with its data features as the input x x 1 x 2 x n of the neural network the total input is 11 x i x i n o r m e x i n o r m e x i n o r m 2 2 5 indicators of calculation accuracy after importing the data of validating sets to the trained neural networks and conducting the inverse normalization the calculation output value could be obtained and be compared with the original output value to assess the performance of neural network in this paper four kinds of indicators are used to evaluate the performance of the neural networks standard deviation error e s d absolute mean error e a b s extreme value error e max fitting degree r n e w 12 e s d s d a c t u s d p r e d s d a c t u 1 n i 1 n y i a c t u y a c t u 2 1 n i 1 n y i p r e d y p r e d 2 1 n i 1 n y i a c t u y a c t u 2 13 e a b s y a c t u y p r e d y a c t u 14 e max y a c t u max y p r e d max y a c t u max 15 r n e w 1 i 1 n y i a c t u y i p r e d 2 i 1 n y i a c t u 2 where y i a c t u and y i p r e d are the original output value and the calculation output value from the neural network respectively y a c t u and y p r e d are the absolute mean of original output value and the calculation output value from the neural network respectively y a c t u max and y p r e d max are the maximum value of original output value and calculation output value from the neural network respectively 2 6 application scope when dividing the training sets and the validating sets the training sets cannot always cover all the potential operating sea state conditions of fpso if the input is within the effective precision scope of the trained neural model the tension and dip of mooring lines can be accurately predicted however due to the complexity of input data the effective precision scope cannot be defined only using the maximum and minimum of motions of fpso in the training sets therefore similar to the feature extraction of input data in section 2 4 2 above the method of using the first order moment and second order central moment to define the precision scope is proposed after calculating the first order moment and second order central moment of training sets and validating sets the scatter diagram is plotted as shown in the following section 3 3 3 when the training sets can cover the whole data of validating sets the established lstm neural network model can accurately predict the tension and dip of mooring lines when the training sets cannot cover the whole data of validating sets it can be regarded that the established lstm neural network model maybe cannot accurately predict the tension and dip of mooring lines through conducting this process the application scope of the established lstm neural network model could be given this could be useful when adjusting the optimized parameters in establishing the lstm neural network model also it could be used to prejudge the suitable neuron networks model when the whole neuron networks are divided into several parts avoiding to spend too long time for training 3 implementation process 3 1 fpso and its mooring system the displacement of fpso is 150000 tons with the load draught is 16 5 m and the working water depth is 105 m the 3 3 mooring system is arranged and the three groups of mooring lines are evenly distributed at an angle of 120 with an angle of 5 between each mooring line as shown in fig 3 the single mooring line consists of ten segments from the top to bottom and the properties of each segment are listed in tables 1 and 2 in which the specific meanings of the abbreviated contents in the first column of tables are as follows 1 lcs lower chain segment 2 ce connecting element 3 lws lower wire rope segment 4 ucs1 upper chain segment lower end 5 ucs2 upper chain segment with clump weights 6 ucs3 upper chain segment upper end 7 uws upper wire rope segment 3 2 motion responses to ensure that the input and output data of lstm neural network model are sufficient the data are numerically simulated by aqwa and orcaflex software which performs the hydrodynamic coupling analysis of the vessel and mooring systems when performing the fpso motion responses analysis the panel model of the fpso model is shown in fig 4 and the total simulation time duration is 3 h the python program is used to call the orcfxapi interface to develop the orcaflex software and the batch calculation of combined wind wave and current wave states are realized 3 3 determination of optimal network structure in this section the influences of normalization methods input data feature extraction neuron number and length of training sets on the accuracy of lstm will be studied respectively when studying one factor the other factors are kept as constant the motion responses of fpso motions and the corresponding mooring line tensions under one sea state condition is chosen due to the total simulation time duration is 3 h the 0 8000s time histories are chosen as the training set in section 3 3 1 and section 3 3 2 and the 8000 9000s time histories are chosen as the validating set in section 3 3 3 the 0 1000s 0 4000s 0 8000s time histories are chosen as the training set respectively 3 3 1 normalization and feature extraction of input data in this section the optimal normalization method is firstly determined without considering the feature extraction of input data and then the influences of feature extraction are compared using the optimal normalization method without considering the feature extraction of input data the standard normalization and min max scaling normalization method shown in section 2 4 1 are used to process the data of established lstm neural network model respectively the validating sets are put into the trained lstm neural network model and the predicting results of representative top tension and dip of mooring line 2 are shown in fig 5 the results of the four indicators of calculation accuracy are listed in table 3 according to fig 5 and table 3 the predicting results using the standard normalization method are closer to the original output value of validating sets both in the peak and valley areas than using the min max scaling normalization method and the four kinds of indicators of calculation accuracy also indicate that the standard normalization method has higher predicting accuracy therefore the standard normalization method is employed in the following lstm neural network model in this paper then further considering the feature extraction of input data the predicting results of also using the standard normalization method are also shown in fig 5 and table 3 the results of lstm neural network model using the feature extraction of the input data method is further closer to the original output value of validating sets both in the peak and valley areas the standard deviation error absolute mean error and extreme value error all further decrease below 5 and the fitting degree increases exceed 0 95 therefore the feature extraction of the input data method has much higher predicting accuracy and it is employed in the following lstm neural network model in this paper 3 3 2 neuron number in the ltsm neural network the number of layers in the hidden layer and the number of nodes in each layer which is the total neuron number also need to be determined the larger of the total neuron number will lead to a more time consuming training process in the neural network and sometimes also result in unsatisfactory predicting accuracy thus it is necessary to find out the suitable total neuron number with little time consuming but high accuracy the comparison of neuron number is divided into two stages the same hidden layer with a different number of nodes in each layer the same number of nodes in each layer with the different hidden layer therefore after conducting the preliminary screening 1 hidden layer with 20 50 100 200 500 nodes in each layer and 100 nodes in each layer with 1 3 5 hidden layers are compared respectively as the same as section 3 3 1 the predicting results of representative top tension and dip of mooring line 2 under different neuron numbers are shown in fig 6 the results of the four indicators of calculation accuracy are listed in table 4 according to fig 6 and table 4 using the same of 1 hidden layer with the nodes in each layer increases the accuracy of predicting results increases firstly and then decreases using the same of 100 nodes in each layer with the hidden layer increases the accuracy of predicting results shows almost none change even becomes lower in general using 1 hidden layer with 200 nodes in each layer has the best predicting accuracy and this is employed in the following lstm neural network model in this paper 3 3 3 length of training sets as described above in section 2 6 the effective precision scope of the established lstm neural network model depends on the coverage range of training sets the scatter diagram of the first order moment and second order central moment of different training sets and the same validating sets are plotted in fig 7 according to fig 7 the feature extraction range of validating sets obviously exceed the training sets when the length of training sets is 0 1000s but the feature extraction range of validating sets totally fall within the training sets when the length of training sets is 0 8000s which indicates that the established lstm neural network model using the 0 8000s time histories of training sets can give the accurate predicting results the predicting results of representative top tension and dip of mooring line 2 under the different length of training sets are shown in fig 8 the results of the four indicators of calculation accuracy are listed in table 5 according to fig 8 and table 5 with the length of training sets increases the accuracy of predicting results also increases which is the same as the feature extraction coverage range between the training and validating sets in fig 7 and further verifies the definition of application scope described in section 2 6 therefore the length of training sets is set as 0 8000s in the following lstm neural network model in this paper 3 4 lstm neural network model set up in addition the determination of other parameters to optimize the lstm neural network structure such as the number of neural network training cycles activation function and the value of batch size are not described in detail in this paper the software version and computer environment set up for establishing the lstm neural network model are operating system win10 graphics card nvidia geforce ctx 1080 ti visual studio 2019 cuda 10 0 cudnn 10 0 anaconda environment manager 64 bit packages python 3 7 tensorflow 2 0 the core function is tensorflow keras layers lstm under the framework of tensorflow the set up of neuron of lstm are activation function tanh optimizer adam learning rate 0 001 loss function mse reuse variable ture return sequences in the lstm neurons of previous layers ture and in the last layer false dropout 0 2 and recurrent dropout 0 2 forget bias init one inner activation hard sigmoid state is tuple ture kernel regularizer keras regularizers l2 0 01 activity regularizer keras regularizers l1 0 001 dtype tf float32 initial state init state 4 case study after the determination of the optimal network structure the case studies are conducted to verify the established lstm neuron network model the verification process is divided into the following two stages which complies with the data relevance gradually decreases between the training sets and validating sets 1 same sea state condition verification the data of training sets and validating sets are all from the motion responses of fpso and its corresponding mooring system operating in the same one sea state condition the data of training sets is 0 8000s and the data of validating sets is 8000 9000s which means the validating sets do not participate in the training process of lstm neuron network model 2 different sea state conditions verification the data of training sets and validating sets are from the motion responses of fpso and its corresponding mooring system operating in the different sea state conditions but the sea state conditions of validating sets locate within the interval of sea state conditions of training sets in particular all of the feature extraction range of validating sets has been falling within the training sets which means the effective precision scope of the established lstm neuron network model has been ensured 4 1 same sea state condition verification the same sea state condition verification is used to verify the accuracy of the established lstm neural network model when the validating sets do not participate in the training process however they belong to the same one sea state condition and have strong data relevance the fpso and its corresponding mooring system operating sea state condition used in the training sets and validating sets are listed in table 6 and along the x direction is defined as 180 as shown in fig 3 the predicting results of representative top tension and dip of mooring line 2 are shown in figs 9 10 the results of the four indicators of calculation accuracy are listed in table 7 according to figs 9 10 and table 7 the overall standard deviation error absolute mean error and extreme value error of top tension and top dip are all below 5 and the fitting degree exceeds 0 95 which means that the established lstm neural network model has high accuracy when the data of validating sets has strong relevance with the data of training sets furthermore the statistical results are divided into low frequency lf and wave frequency wf to investigate the precision of training effects regarding frequencies as shown in table 7 it can be seen from the results that the predicting results in lf is better than the results of wf this is because the lf motion is very slow and the data changes smoothly so the data fluctuation is small while the wf motion is relatively intense and the data fluctuates greatly which makes the data fluctuation information is hard to fully contained in the training process 4 2 different sea state conditions verification the different sea state conditions verification is used to verify the inclusion and extrapolation accuracy of established lstm neural network model the data of training sets and validating sets have none direct relationship but they have some similar characteristics of fluctuation information due to the similar operating sea state conditions the validation is separated into four parts 1 the same current velocity with two different current directions are chosen as the training sets and another sea state with the same current velocity and different current direction is chosen as the validating sets 2 the same wave period t p with two different wave heights h s are chosen as the training sets and another sea state with the same t p and different hs is chosen as the validating sets 3 the same wave height h s with two different wave periods t p are chosen as the training sets and another sea state with the same h s and different t p is chosen as the validating sets 4 the combinations of two different h s and t p are chosen as the training sets and the different h s and t p are chosen as the validating sets the specific training conditions and predicting results are listed in section 4 2 1 4 2 4 4 2 1 different current directions the case study in which only the current direction changes is considered in this section the fpso and its corresponding mooring system under the operating sea state condition used in the training sets are listed in table 8 while that used in the validating sets are listed in table 9 the only difference is that the current direction in the sea state condition of validating sets locates within the interval of the current direction in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 11 12 the results of the four indicators of calculation accuracy are listed in table 10 according to figs 11 12 and table 10 although the condition of validation sets is different from the training sets the standard deviation error absolute mean error and extreme value error of top tension and top dip are also all below 5 and the fitting degree also exceeds 0 95 except the wave frequency result which means that the established lstm neural network model also has high accuracy when the data of validating sets has similar characteristics of fluctuation information with the data of training sets the reason for the relative larger error generating in the wf predicting results is the same as the explanation in section 4 1 4 2 2 different wave heights the case study in which only the wave height changes is considered in this section the fpso and its corresponding mooring system operating sea state condition used in the training sets are listed in table 11 while that used in the validating sets are listed in table 12 the only difference is that the wave height in the sea state condition of validating sets locates within the interval of wave heights in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 13 14 the results of four indicators of calculation accuracy are listed in table 13 according to figs 13 14 and table 13 the standard deviation error absolute mean error and extreme value error of top tension and top dip are also all below 5 and the fitting degree also exceeds 0 95 in the overall lf and wf predicting results which means that the established lstm neural network model has very high accuracy when only the wave heights are different between training sets and validating sets the reason is that the nonlinearity of wave heights have little influences on the responses of fpso and its mooring system 4 2 3 different wave periods the case study in which only the wave period changes is considered in this section the fpso and its corresponding mooring system operating sea state condition used in the training sets are listed in table 14 while that used in the validating sets are listed in table 15 the only difference is that the wave period in the sea state condition of validating sets locates within the interval of wave period in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 15 16 the results of the four indicators of calculation accuracy are listed in table 16 according to results in figs 15 16 and table 16 the standard deviation error absolute mean error and extreme value error are also all below 5 and the fitting degree also exceeds 0 95 except the wave frequency result which means that the accuracy of prediction results is also very high however the prediction results with different periods are not as good as those with different wave heights in 4 2 2 which indicates that the established lstm neural network is relatively sensitive to wave periods 4 2 4 different wave heights and wave periods the case study in which both the wave height and wave period change is considered in this section the fpso and its corresponding mooring system operating sea state condition used in the training sets are listed in table 17 while that used in the validating sets are listed in table 18 there are four operating sea state conditions in the training sets and the wave height and wave period in the sea state condition of validating sets locates within the interval of that in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 17 18 the results of the four indicators of calculation accuracy are listed in table 19 according to results in figs 17 18 and table 19 the prediction accuracy is the highest compared with the previous cases in section 4 2 1 4 2 3 the reason is that although the wave height and wave period in the validating sets are all different from those in the training sets the predicting accuracy becomes larger with the data in the training sets increases 5 conclusion in this paper a long short term memory neural network model is developed to predict the mooring line responses the established new tool provides quick calculation for monitoring the mooring line responses under the operating condition which is a worthy addition to cover the shortage of traditional monitoring devices some conclusions are obtained 1 when the data of validating sets have similar characteristics of fluctuation information with the training sets the mooring line responses can be predicted with high precision based on the vessel motion as input using the established lstm neural network model 2 in the data pre processing step using the feature extraction method to improve the characteristics of fluctuation information of input data which contains the original input together with its first order and second order central moments as the input data can significantly improve the predicting accuracy of lstm neural network model 3 in the determination of optimal lstm neural network structure there is a suitable neuron number rather than the more neurons would improve higher prediction accuracy the judging standard of prediction accuracy of the established lstm neural network model is that the scatter diagram of predicting input data which consists of the first order moment and second order center moment should totally fall within the scatter diagram of training sets declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national key r d program of china grant no 2016yfe0200100 national natural science foundation of china grant nos 51979030 51979050 51761135011 51520105014 and fundamental research funds for the central universities 
21281,a long short term memory lstm neural network model is developed to provide a real time calculation tool for monitoring the mooring line responses under the operating condition by using the vessel motion as the only input a feature extraction method based on first order moment and second order center moment is proposed in the data pre processing to improve the characteristics of fluctuation information of input data the effective judging standard of the scope of prediction accuracy regarding the proposed neural network model is defined the impact of normalization method neural number and training sets length on the predicting accuracy are studied the feasibility of the established lstm neural network model is verified considering different data relevance between the training sets and validating sets the results indicate that the mooring line responses can be predicted with high precision based on the vessel motion as input by using the established lstm neural network model keywords mooring system lstm neural network optimal network structure feature extraction 1 introduction offshore oil production activities in deep and ultra deep water are mainly accomplished through floating production systems such as semi submersible platforms or ship type vessels containing fpso floating production storage and offloading the service ocean environment of a deep water floating platform is extremely complex and harsh once an accident occurs it will cause serious economic and environmental damage the mooring system is commonly used as the positioning device so it is of vital importance to monitor the tension response of the mooring line to prevent potential damage at present the installation of monitoring equipment on the mooring line in the field is expensive also due to the harsh marine environment the monitoring equipment such as the inclinometer and tensiometer may easy to be a failure which would result in the discontinuous monitoring data meanwhile the cost of long term maintenance and service are also very expensive the current gps global positioning system monitoring technology is relatively mature and the 6 degrees of freedom response of the vessel motions are easy to be obtained while the gps monitoring data is usually much more stable than the monitoring data of mooring line tension minnebo et al 2014 therefore using the monitored vessel motion as the input of forced excitation at the top of the mooring line the responses of mooring line can be calculated by the complicated finite element software which can accurately capture the nonlinear behavior of a moored vessel and its mooring system however the computational time consuming of conventional finite element software is too long which cannot predict the mooring line tension in real time and the simplified method based on the static analysis of mooring line cannot consider the effect of dynamic effect which can significantly underestimate the dynamic mooring line tension so the improvement of calculating speed which can also consider the dynamic effect becomes a worth study correa et al 2015 as one of the options artificial neural networks ann is used to solve the computational time consuming problem and the ann has been used in many applications related to marine and ocean engineering ok et al 2007 used the ann method to assess the ultimate strength of plates with pitting corrosion yasseri et al 2010 used the bp neural networks to predict the future sea conditions at a specific time based on the several known measured sea conditions through buoys quéau et al 2014 used the bp neural network to study the fatigue behavior of catenary riser in the case that only the static load is considered while the inertia or damping is ignored mak and düz 2019 used the machine learning approaches to estimate the relative wave direction based on the time histories of six degrees of freedom ship motions kim 2015a 2015b used the narx neural network to identify the nonlinear structural response of the catenary riser based on the secondary volterra series chaves et al 2015 2016 predicted the tension curvature and fatigue life of flexible pipeline based on the combinations of dynamic finite element analyses and ann de pina et al 2016 used the ann to give the preliminary design of the mooring system considering the parameters of metocean data water depth the requirement of vessel motion mooring line tension and the riser layout wu et al 2013 2017 hu et al 2011 and du et al 2014 used the rbf neural network to optimize the dynamic performance of tiaozhan fpso at the south china sea considering its mass moment of inertia and center of gravity position as the target variables yu and wang 2018 yu et al 2019 used the deep neural networks to optimize the body shape and geometric proportion of trimaran with the aim of best calm water transportation efficiency by using the vessel motion for predicting the mooring line responses there are also some research work that has been reported guarize et al 2007 used the previous vessel motion and the corresponding mooring line tension histories as the training data in which the correlation of previous histories is taken into account through adding the number of delays for vessel motions as the input layer and then use the optimized ann model to predict the mooring line tension the results show that using a short time history can accurately predict a much longer time of slender structural responses and also indicate that the ann model must be trained case by case and the responses of slender should be stable sidarta et al 2018a investigated the influences of the number of hidden layer and the number of neurons in the hidden layer on the learning efficiency of the ann model then the method to detect the mooring line failure damage is proposed sidarta et al 2018b 2019 kyoung et al 2019 in which the low frequency motion and yaw angle of the hull from the gps monitored data are set as the input and the damaged mooring line is detected through recognizing the changes of low frequency motion and yaw angle of the hull the results indicate that the effectiveness of ann model is closely relative with the training data and the trained data should be comprehensive enough to cover the expected predicted value christiansen et al 2013 2015 compared the influences of training sets length and the number of neurons in the hidden layer on the sensibility of ann model and the results indicate that the temporal order characteristics of vessel motion can be improved through increasing the length of previous time histories and the number of delays however the computational time also increases de pina et al 2013 used the narx neural network model to predict the mooring line tension while the vessel motions are set as input and the output data can be used as input data to re enter the training model which means the recurrent property is introduced and then compare the influence of different delay length on the predicting accuracy in general using the vessel motion as input applying the ann model can accurately predict the mooring line responses and this is a worthy addition to cover the shortage of traditional monitoring devices however the predicting results are strongly depend on the input training data much of the previous work follows entirely experience to ensure the data of training sets with the input selected in a completely random or monte carlo method such as the initial back propagation bp neural networks method needs to use the random input data to ensure the convergence wang et al 2017 however for the input data of the time series the random selection may lead to the data lose relevance for example under the operating sea state condition the motion responses of a floating structure are reciprocating which means that even if the position of floating structure is the same at different time while the mooring line tension may be different due to the interaction of floating structure and dynamic effects of mooring line in other words starting from the data itself the same original input value of vessel motion may correspond to different original output value of mooring line tension with the reason of that the certain time of data value where this original input value located has different characteristics of fluctuation information the aiming of this paper is to use the vessel motion as input to predict the mooring line responses and the time series of motion responses of vessel and mooring line have obvious data correlation characteristics therefore the continuous time series of vessel motion and corresponding mooring line tension are used as the input and output data in the training sets and how to contain the data relevance of training sets further mine the temporal order characteristics of vessel motion data choose the corresponding suitable ann structure and define the effective precision scope of the established neural network are investigated in this paper a lstm long short term memory neural network model is developed to predict the mooring line responses based on the training data which is from the numerical simulation of vessel motion and its corresponding mooring line responses and the lstm method could consider the recurrent and memory effect of time series data and avoid the problem of long term dependence of sequence data hochreiter and schmidhuber 1997 firstly a feature extraction method based on first order moment and second order center moment is proposed in the data pre processing which can further include the characteristics of fluctuation information contained in the time history data then the effective precision scope of the proposed neural network model is defined in addition the influence of normalization method neural number and training sets length on the calculation accuracy of the established model are studied finally the feasibility of predicting the mooring line through the developed lstm neural network model is verified by case studies 2 lstm neural network model 2 1 basic concepts of ann the ann is a network of adaptable and simple processing units connected to each other in a broad parallel the artificial neuron is the basic unit of an ann which mainly simulates the structure and properties of biological neurons receives a set of input signals and then produces output signals as shown in fig 1 an input x x 1 x 2 x n is given and the linear combination z is calculated through the sum of each input neuron x i multiplies the weight of synapse w i and then the output y is calculated through the activation function f z a neural network is the hierarchical arrangement of some simple interconnected neurons and it can be generally divided into the input layer hidden layer and output layer the hidden layer may consist of several layers of neurons or only just one layer of the neuron as shown in fig 2 the output of each hidden layer neuron y j is 1 y j f i 1 n w i j x i where w i j is the synaptic weight from neuron x i in the input layer to neuron j in the hidden layer also the output y o of total hidden layer neuron is 2 y o g j 1 j w j o y j g j 1 j w j o f i 1 n w i j x i where w j o is the synaptic weight from neuron j in the hidden layer to y o in the output layer g is the activation function of output layer after the neural network is established and initialized it needs the training to get the desired results the principle of the training process is to regulate the synaptic weights w i j using a set of desired output and input data the training process relies on the availability of the input output data x v o where v o is the actual output value corresponding to the given input x the training of neural network consists of the following steps firstly a set of input data x x 1 x 2 x n is delivered into the neural network through the connection of neurons until the output layer results in a response y o secondly the resulting response y o is compared to the desired actual output value v o so the generated total error is e y o v o thirdly the generated error is distributed to each unit in each layer in the process of back propagation and the error value of each unit e j are obtained finally adjust the synaptic weight w i j to minimize the generated total error to match the accuracy requirement therefore the generated total error e y o v o also can be calculated 3 e 1 2 j 1 n e j 2 then based on the generated total error e the modification of synaptic weight δ w i j is calculated from the learning rate parameter η and equations 1 3 4 δ w i j η e w i j η e e j e j y j y j x j x j w i j therefore the new synaptic weights w i j n e w can be obtained 5 w i j n e w w i j δ w i j finally this training process will be repeated until the generated total error is lower than the accuracy requirement a well trained neural network can provide the required output for data that is within the effective precision coverage of the training sets but not the same as the training 2 2 characteristics of lstm neural network in this study the lstm neural network which is a kind of ann including the time cycle structure in deep learning and can accurately model the time series data in the calculation of lstm neural network model the past iterations and samples are remembered which can affect the current decision the current and past of input data as well as the past lstm neural network computation state are all considered as the input to solve the current output therefore the time series needs to be discretized with equal time steps d t similar in equation 2 shown above so the output of the training model is 6 y o g v s t v f u x t c t 1 w s t 1 v f u x t c t 1 w f u x t 1 c t 2 w s t 2 v f u x t c t 1 w f u x t 1 c t 2 w f u x t 2 where g is the activation function of the output layer v is the weight matrix of the output layer s t is the calculation formula of the hidden layer which includes three types of input namely the current input layer x t the input of the hidden layer at the previous time step s t 1 and the status of the neuron at the previous time step c t 1 f is the activation function of hidden layer u is the synaptic weight matrix form the input layer to the hidden layer w is the synaptic weight matrix from the s t 1 to the hidden layer at this time step 2 3 input and output data in this study the lstm neural network model is developed to predict the response of the mooring line by the known motion responses of the vessel a fpso with turret mooring is chosen as the research object and the full coupled responses analysis of fpso and its mooring systems are conducted in the time domain the specific parameters are shown in the following section 3 1 therefore the data used in the lstm neural network model contains the input of six degrees of freedom motion responses of fpso which is defined as the original input value and the output of responses of mooring lines which is defined as the original output value after giving the complete input and output time histories of each operating sea states in the data of lstm neural network model the whole data is divided into the training and validating sets which are respectively used for training the lstm neural network model and validating the accuracy of the predicting results from the trained lstm neural network model the prediction accuracy is totally determined by the training effect of the model which mainly depends on the availability of the input output pairs x v o from the training sets in order to improve the training effect the input output pairs of the training sets should contain all possible cases and the data should be evenly distributed in the range of possible cases in addition the validating sets should be independent of the training sets that is the data of validating sets is located in the range distribution of the training sets but not exactly the same as that of the training sets the aim is to evaluate the ability of trained lstm neural network model to obtain the respected output when the input is not participating in the training process and to validate the prediction accuracy meanwhile in this paper the data selected from the training sets are successive and the length of data representing one operating sea state condition of fpso is selected which makes the size of training sets in a reasonable value in other words the selected training sets can fully represent the data characteristics of this operating sea state condition of fpso and it cannot inundate the individual special situations due to too much data 2 4 data pre processing 2 4 1 normalization typically the input and output have different units and proportions for example surge sway is measured in meters while roll pitch is in degrees thus the normalization of the original input value and the original output value is required before the calculation of neural networks after the normalization the normalized input and output value could be imported into the neural network for training and validating similarly the output value calculated by the neural network also needs to be inversely normalized there are two commonly used normalization methods the standard normalization and the min max scaling normalization as shown in equations 7 and 8 respectively the comparison of the effects of these two normalization methods on the accuracy of lstm neural network computation is shown in section 3 3 1 7 x i n o r m x i a b n o r m μ a b n o r m x σ a b n o r m x 8 x i n o r m x i a b n o r m x i a b n o r m min x i a b n o r m max x i a b n o r m min where x i a b n o r m is the original input value x i n o r m is the normalized original input value μ a b n o r m x is the mean value of original input value σ a b n o r m x is the variance of original input value x i a b n o r m max is the maximum of original input value x i a b n o r m min is the minimum of original input value 2 4 2 feature extraction of input data as described in section 2 3 the lstm neural network is used to consider the correlation of data in theory it can be done well if the input output data in the training sets are continuous however in order to further contain the data relevance of training sets and improve the accuracy of predicting result the first order and second order central moments which can describe the characteristics of fluctuation information of original input value are introduced during the input data the first order and second order central moments of the normalized original input value are also setting as the input together with the original input value aiming to improve the characteristics of fluctuation information of input data the comparison of feature extraction on the accuracy of ltsm s calculation results is shown in section 3 3 1 for each x i of input x x 1 x 2 x n the equations of calculating the first order moments and second order central moments are 9 e x i n o r m f 1 x i n 1 n o r m x i n 2 n o r m x i n o r m 1 n j 0 j n 1 x i j n o r m 10 e x i n o r m 2 f 2 x i n 1 n o r m x i n 2 n o r m x i n o r m 1 n j 0 j n 1 x i j n o r m e x i n o r m 2 where n is the data length of calculating the first order moments and second order central moments when the data features are extracted in this paper 18s duration of motion responses of fpso is taken as the input data length e x i n o r m and e x i n o r m 2 are the first order moments and second order central moments of x i combining x i n o r m with its data features as the input x x 1 x 2 x n of the neural network the total input is 11 x i x i n o r m e x i n o r m e x i n o r m 2 2 5 indicators of calculation accuracy after importing the data of validating sets to the trained neural networks and conducting the inverse normalization the calculation output value could be obtained and be compared with the original output value to assess the performance of neural network in this paper four kinds of indicators are used to evaluate the performance of the neural networks standard deviation error e s d absolute mean error e a b s extreme value error e max fitting degree r n e w 12 e s d s d a c t u s d p r e d s d a c t u 1 n i 1 n y i a c t u y a c t u 2 1 n i 1 n y i p r e d y p r e d 2 1 n i 1 n y i a c t u y a c t u 2 13 e a b s y a c t u y p r e d y a c t u 14 e max y a c t u max y p r e d max y a c t u max 15 r n e w 1 i 1 n y i a c t u y i p r e d 2 i 1 n y i a c t u 2 where y i a c t u and y i p r e d are the original output value and the calculation output value from the neural network respectively y a c t u and y p r e d are the absolute mean of original output value and the calculation output value from the neural network respectively y a c t u max and y p r e d max are the maximum value of original output value and calculation output value from the neural network respectively 2 6 application scope when dividing the training sets and the validating sets the training sets cannot always cover all the potential operating sea state conditions of fpso if the input is within the effective precision scope of the trained neural model the tension and dip of mooring lines can be accurately predicted however due to the complexity of input data the effective precision scope cannot be defined only using the maximum and minimum of motions of fpso in the training sets therefore similar to the feature extraction of input data in section 2 4 2 above the method of using the first order moment and second order central moment to define the precision scope is proposed after calculating the first order moment and second order central moment of training sets and validating sets the scatter diagram is plotted as shown in the following section 3 3 3 when the training sets can cover the whole data of validating sets the established lstm neural network model can accurately predict the tension and dip of mooring lines when the training sets cannot cover the whole data of validating sets it can be regarded that the established lstm neural network model maybe cannot accurately predict the tension and dip of mooring lines through conducting this process the application scope of the established lstm neural network model could be given this could be useful when adjusting the optimized parameters in establishing the lstm neural network model also it could be used to prejudge the suitable neuron networks model when the whole neuron networks are divided into several parts avoiding to spend too long time for training 3 implementation process 3 1 fpso and its mooring system the displacement of fpso is 150000 tons with the load draught is 16 5 m and the working water depth is 105 m the 3 3 mooring system is arranged and the three groups of mooring lines are evenly distributed at an angle of 120 with an angle of 5 between each mooring line as shown in fig 3 the single mooring line consists of ten segments from the top to bottom and the properties of each segment are listed in tables 1 and 2 in which the specific meanings of the abbreviated contents in the first column of tables are as follows 1 lcs lower chain segment 2 ce connecting element 3 lws lower wire rope segment 4 ucs1 upper chain segment lower end 5 ucs2 upper chain segment with clump weights 6 ucs3 upper chain segment upper end 7 uws upper wire rope segment 3 2 motion responses to ensure that the input and output data of lstm neural network model are sufficient the data are numerically simulated by aqwa and orcaflex software which performs the hydrodynamic coupling analysis of the vessel and mooring systems when performing the fpso motion responses analysis the panel model of the fpso model is shown in fig 4 and the total simulation time duration is 3 h the python program is used to call the orcfxapi interface to develop the orcaflex software and the batch calculation of combined wind wave and current wave states are realized 3 3 determination of optimal network structure in this section the influences of normalization methods input data feature extraction neuron number and length of training sets on the accuracy of lstm will be studied respectively when studying one factor the other factors are kept as constant the motion responses of fpso motions and the corresponding mooring line tensions under one sea state condition is chosen due to the total simulation time duration is 3 h the 0 8000s time histories are chosen as the training set in section 3 3 1 and section 3 3 2 and the 8000 9000s time histories are chosen as the validating set in section 3 3 3 the 0 1000s 0 4000s 0 8000s time histories are chosen as the training set respectively 3 3 1 normalization and feature extraction of input data in this section the optimal normalization method is firstly determined without considering the feature extraction of input data and then the influences of feature extraction are compared using the optimal normalization method without considering the feature extraction of input data the standard normalization and min max scaling normalization method shown in section 2 4 1 are used to process the data of established lstm neural network model respectively the validating sets are put into the trained lstm neural network model and the predicting results of representative top tension and dip of mooring line 2 are shown in fig 5 the results of the four indicators of calculation accuracy are listed in table 3 according to fig 5 and table 3 the predicting results using the standard normalization method are closer to the original output value of validating sets both in the peak and valley areas than using the min max scaling normalization method and the four kinds of indicators of calculation accuracy also indicate that the standard normalization method has higher predicting accuracy therefore the standard normalization method is employed in the following lstm neural network model in this paper then further considering the feature extraction of input data the predicting results of also using the standard normalization method are also shown in fig 5 and table 3 the results of lstm neural network model using the feature extraction of the input data method is further closer to the original output value of validating sets both in the peak and valley areas the standard deviation error absolute mean error and extreme value error all further decrease below 5 and the fitting degree increases exceed 0 95 therefore the feature extraction of the input data method has much higher predicting accuracy and it is employed in the following lstm neural network model in this paper 3 3 2 neuron number in the ltsm neural network the number of layers in the hidden layer and the number of nodes in each layer which is the total neuron number also need to be determined the larger of the total neuron number will lead to a more time consuming training process in the neural network and sometimes also result in unsatisfactory predicting accuracy thus it is necessary to find out the suitable total neuron number with little time consuming but high accuracy the comparison of neuron number is divided into two stages the same hidden layer with a different number of nodes in each layer the same number of nodes in each layer with the different hidden layer therefore after conducting the preliminary screening 1 hidden layer with 20 50 100 200 500 nodes in each layer and 100 nodes in each layer with 1 3 5 hidden layers are compared respectively as the same as section 3 3 1 the predicting results of representative top tension and dip of mooring line 2 under different neuron numbers are shown in fig 6 the results of the four indicators of calculation accuracy are listed in table 4 according to fig 6 and table 4 using the same of 1 hidden layer with the nodes in each layer increases the accuracy of predicting results increases firstly and then decreases using the same of 100 nodes in each layer with the hidden layer increases the accuracy of predicting results shows almost none change even becomes lower in general using 1 hidden layer with 200 nodes in each layer has the best predicting accuracy and this is employed in the following lstm neural network model in this paper 3 3 3 length of training sets as described above in section 2 6 the effective precision scope of the established lstm neural network model depends on the coverage range of training sets the scatter diagram of the first order moment and second order central moment of different training sets and the same validating sets are plotted in fig 7 according to fig 7 the feature extraction range of validating sets obviously exceed the training sets when the length of training sets is 0 1000s but the feature extraction range of validating sets totally fall within the training sets when the length of training sets is 0 8000s which indicates that the established lstm neural network model using the 0 8000s time histories of training sets can give the accurate predicting results the predicting results of representative top tension and dip of mooring line 2 under the different length of training sets are shown in fig 8 the results of the four indicators of calculation accuracy are listed in table 5 according to fig 8 and table 5 with the length of training sets increases the accuracy of predicting results also increases which is the same as the feature extraction coverage range between the training and validating sets in fig 7 and further verifies the definition of application scope described in section 2 6 therefore the length of training sets is set as 0 8000s in the following lstm neural network model in this paper 3 4 lstm neural network model set up in addition the determination of other parameters to optimize the lstm neural network structure such as the number of neural network training cycles activation function and the value of batch size are not described in detail in this paper the software version and computer environment set up for establishing the lstm neural network model are operating system win10 graphics card nvidia geforce ctx 1080 ti visual studio 2019 cuda 10 0 cudnn 10 0 anaconda environment manager 64 bit packages python 3 7 tensorflow 2 0 the core function is tensorflow keras layers lstm under the framework of tensorflow the set up of neuron of lstm are activation function tanh optimizer adam learning rate 0 001 loss function mse reuse variable ture return sequences in the lstm neurons of previous layers ture and in the last layer false dropout 0 2 and recurrent dropout 0 2 forget bias init one inner activation hard sigmoid state is tuple ture kernel regularizer keras regularizers l2 0 01 activity regularizer keras regularizers l1 0 001 dtype tf float32 initial state init state 4 case study after the determination of the optimal network structure the case studies are conducted to verify the established lstm neuron network model the verification process is divided into the following two stages which complies with the data relevance gradually decreases between the training sets and validating sets 1 same sea state condition verification the data of training sets and validating sets are all from the motion responses of fpso and its corresponding mooring system operating in the same one sea state condition the data of training sets is 0 8000s and the data of validating sets is 8000 9000s which means the validating sets do not participate in the training process of lstm neuron network model 2 different sea state conditions verification the data of training sets and validating sets are from the motion responses of fpso and its corresponding mooring system operating in the different sea state conditions but the sea state conditions of validating sets locate within the interval of sea state conditions of training sets in particular all of the feature extraction range of validating sets has been falling within the training sets which means the effective precision scope of the established lstm neuron network model has been ensured 4 1 same sea state condition verification the same sea state condition verification is used to verify the accuracy of the established lstm neural network model when the validating sets do not participate in the training process however they belong to the same one sea state condition and have strong data relevance the fpso and its corresponding mooring system operating sea state condition used in the training sets and validating sets are listed in table 6 and along the x direction is defined as 180 as shown in fig 3 the predicting results of representative top tension and dip of mooring line 2 are shown in figs 9 10 the results of the four indicators of calculation accuracy are listed in table 7 according to figs 9 10 and table 7 the overall standard deviation error absolute mean error and extreme value error of top tension and top dip are all below 5 and the fitting degree exceeds 0 95 which means that the established lstm neural network model has high accuracy when the data of validating sets has strong relevance with the data of training sets furthermore the statistical results are divided into low frequency lf and wave frequency wf to investigate the precision of training effects regarding frequencies as shown in table 7 it can be seen from the results that the predicting results in lf is better than the results of wf this is because the lf motion is very slow and the data changes smoothly so the data fluctuation is small while the wf motion is relatively intense and the data fluctuates greatly which makes the data fluctuation information is hard to fully contained in the training process 4 2 different sea state conditions verification the different sea state conditions verification is used to verify the inclusion and extrapolation accuracy of established lstm neural network model the data of training sets and validating sets have none direct relationship but they have some similar characteristics of fluctuation information due to the similar operating sea state conditions the validation is separated into four parts 1 the same current velocity with two different current directions are chosen as the training sets and another sea state with the same current velocity and different current direction is chosen as the validating sets 2 the same wave period t p with two different wave heights h s are chosen as the training sets and another sea state with the same t p and different hs is chosen as the validating sets 3 the same wave height h s with two different wave periods t p are chosen as the training sets and another sea state with the same h s and different t p is chosen as the validating sets 4 the combinations of two different h s and t p are chosen as the training sets and the different h s and t p are chosen as the validating sets the specific training conditions and predicting results are listed in section 4 2 1 4 2 4 4 2 1 different current directions the case study in which only the current direction changes is considered in this section the fpso and its corresponding mooring system under the operating sea state condition used in the training sets are listed in table 8 while that used in the validating sets are listed in table 9 the only difference is that the current direction in the sea state condition of validating sets locates within the interval of the current direction in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 11 12 the results of the four indicators of calculation accuracy are listed in table 10 according to figs 11 12 and table 10 although the condition of validation sets is different from the training sets the standard deviation error absolute mean error and extreme value error of top tension and top dip are also all below 5 and the fitting degree also exceeds 0 95 except the wave frequency result which means that the established lstm neural network model also has high accuracy when the data of validating sets has similar characteristics of fluctuation information with the data of training sets the reason for the relative larger error generating in the wf predicting results is the same as the explanation in section 4 1 4 2 2 different wave heights the case study in which only the wave height changes is considered in this section the fpso and its corresponding mooring system operating sea state condition used in the training sets are listed in table 11 while that used in the validating sets are listed in table 12 the only difference is that the wave height in the sea state condition of validating sets locates within the interval of wave heights in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 13 14 the results of four indicators of calculation accuracy are listed in table 13 according to figs 13 14 and table 13 the standard deviation error absolute mean error and extreme value error of top tension and top dip are also all below 5 and the fitting degree also exceeds 0 95 in the overall lf and wf predicting results which means that the established lstm neural network model has very high accuracy when only the wave heights are different between training sets and validating sets the reason is that the nonlinearity of wave heights have little influences on the responses of fpso and its mooring system 4 2 3 different wave periods the case study in which only the wave period changes is considered in this section the fpso and its corresponding mooring system operating sea state condition used in the training sets are listed in table 14 while that used in the validating sets are listed in table 15 the only difference is that the wave period in the sea state condition of validating sets locates within the interval of wave period in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 15 16 the results of the four indicators of calculation accuracy are listed in table 16 according to results in figs 15 16 and table 16 the standard deviation error absolute mean error and extreme value error are also all below 5 and the fitting degree also exceeds 0 95 except the wave frequency result which means that the accuracy of prediction results is also very high however the prediction results with different periods are not as good as those with different wave heights in 4 2 2 which indicates that the established lstm neural network is relatively sensitive to wave periods 4 2 4 different wave heights and wave periods the case study in which both the wave height and wave period change is considered in this section the fpso and its corresponding mooring system operating sea state condition used in the training sets are listed in table 17 while that used in the validating sets are listed in table 18 there are four operating sea state conditions in the training sets and the wave height and wave period in the sea state condition of validating sets locates within the interval of that in the sea state condition of training sets the data of training sets and validating sets is both 0 8000s from their operating sea state condition respectively the predicting results of representative top tension and dip of mooring line 2 are shown in figs 17 18 the results of the four indicators of calculation accuracy are listed in table 19 according to results in figs 17 18 and table 19 the prediction accuracy is the highest compared with the previous cases in section 4 2 1 4 2 3 the reason is that although the wave height and wave period in the validating sets are all different from those in the training sets the predicting accuracy becomes larger with the data in the training sets increases 5 conclusion in this paper a long short term memory neural network model is developed to predict the mooring line responses the established new tool provides quick calculation for monitoring the mooring line responses under the operating condition which is a worthy addition to cover the shortage of traditional monitoring devices some conclusions are obtained 1 when the data of validating sets have similar characteristics of fluctuation information with the training sets the mooring line responses can be predicted with high precision based on the vessel motion as input using the established lstm neural network model 2 in the data pre processing step using the feature extraction method to improve the characteristics of fluctuation information of input data which contains the original input together with its first order and second order central moments as the input data can significantly improve the predicting accuracy of lstm neural network model 3 in the determination of optimal lstm neural network structure there is a suitable neuron number rather than the more neurons would improve higher prediction accuracy the judging standard of prediction accuracy of the established lstm neural network model is that the scatter diagram of predicting input data which consists of the first order moment and second order center moment should totally fall within the scatter diagram of training sets declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national key r d program of china grant no 2016yfe0200100 national natural science foundation of china grant nos 51979030 51979050 51761135011 51520105014 and fundamental research funds for the central universities 
21282,this study employs an incompressible homogeneous flow framework with a transport equation based cavitation model and density corrected shear stress transport sst k ω turbulence model to successfully reproduce the unsteady cavitating flow around a 3d clark y hydrofoil with an end wall cavity growth development and break off during the periodic shedding process are adequately reproduced and match experimental observations the predicted shedding frequency is very close to the experimental value of 43 48 hz the existence of an end wall brings about the generation and convection of wall side cavity moreover large horse type cavity structure is captured which agrees with experimental results cavities at the closure region easily detach from the main pocket part resulting in a secondary vortical structure differences between numerical and experimental lift are observed however similar to our previous findings the experimental lift coefficient appears to correlate with the inverse of the second derivative of the total cavity volume based on the analysis of vorticity transportation compressibility source occupies the highest contribution of vorticity transportation and is significantly higher than other two terms which serves the promotion effect at the trailing region of growing attached cavity while inhibits the development of vorticity within the leading area keywords unsteady cloud cavitation transient characteristics three dimensional hydrofoil 1introduction a key research topic in the field of hydraulic machinery is the partial cavitating flow containing multiscale bubbles which has attracted substantial attention due to its transient and aggressive nature brennen 2014 to explore the cavitating field water tunnels have been widely established and used to investigate a range of simplified geometry models such as nozzles stutz and reboud 1997a gopalan and katz 2000 croci et al 2019 and hydrofoils laberteaux and ceccio 2001 leroux et al 2005 franc and michel 2006 watanabe et al 2014 kravtsova et al 2014 kawanami et al 1997 arranged several high frequency sensors along the foil suction surface to obtain pressure information from the partial cavity shedding field and observed strong pressure fluctuations during downstream movement of the shedding cavities based on the proposed re entrant jet mechanism passive control methods of cavitation unsteadiness were then discussed in detail further the ultrasonic technique has been used to demonstrate that the adverse pressure gradient and the cavity thickness respective to the re entrant jet thickness are two key factors affecting re entrant jet instability callenaere et al 2001 the high pressure achieved during the collapse and impact of the emitted shock waves was first proposed as the mechanism of cavitation damage hickling and plesset 1964 fujikawa and akamatsu 1980 motivated by rayleigh s spherical bubble theory harrison 1952 first experimentally captured evidence of such high pressure pulses from a collapsing bubble with acoustic measurements and these shock waves were visualized by güth 1954 using the schlieren technique in 1954 according to vogel et al 1989 the maximum pressure inside a bubble reaches 6 gpa when the radius of the collapsing bubble decreases to 50 âμm nowadays due to our ability to produce single bubbles of known size by optimized focusing of a laser pulse much smaller collapsing radii have been found which suggests that the emitted pressure pulses could be even higher this indicates that pressure sensors could be easily destroyed during water tunnel measurements for example in the experimental tests of foeth et al 2008 and che et al 2019 traditional methods of velocity acquisition include probes stutz and reboud 1997a and laser doppler velocimetry ldv arndt et al 2000 chesnakas and jessup 2003 sou et al 2007 with the development and application of particle image velocimetry piv it is possible to further elucidate cavitating flow adrian 1986 westerweel 1997 zhang et al 1998 gopalan and katz 2000 used piv to measure the flow structure at the closure region and suggested that the collapse of vapor cavities in the closure region is the primary mechanism of vorticity production this methodology was further extended to determine the effect of the growth and collapse of cavitation on the dynamics of shear flows iyer and ceccio 2002 although considerable advances have been achieved foeth et al 2006 wosnik et al 2006 dreyer et al 2014 traditional piv suffers from the measurement limitations of the cavity inner field thus to make direct observations inside the bubbly flow high temporal and spatial resolution planar laser induced fluorescence plif was proposed dular et al 2007 employed this technique to successfully observe the instantaneous cavitation structure shape and relevant velocity field inside and outside the cavitation structure which also proved the hypothesis that the three dimensional characteristics of re entrant flow has an important influence on asymmetric cavitation cloud separation de lange and de bruin 1997 duttweiler and brennen 1998 the vapor fraction which a major quantity of interest in cavitating flows can be used to determine distinct shedding mechanisms its measurement can be traced back to 1997 when stutz and reboud 1997a and stutz and reboud 1997b used the double optical probe to measure the void fraction of the sheet cavity and cloud cavity within a venturi type test section the averaged void fraction of cloud cavity is relatively weak and does not exceed 21 while the maximum void fraction of sheet cavity varies regularly from 80 at the fore part of the cavity to 10 at the rear part later coutier delgosha et al 2007 investigated the local volume fraction of the vapor phase inside the cavity and in the wake of the two dimensional hydrofoil with an x ray absorption device aeschlimann et al 2011 provided an analysis of vapor distribution in a test bed facility consisting of a cavitating mixing layer where the development of vapor structures was observed inside kelvin helmholtz eddies further significant progress was made in 2013 when mäkiharju et al 2013 developed an x ray densitometry system that measures the time resolved two dimensional projection of the void fraction flow field of gas liquid flows thereby acquiring information from a plane instead of discrete probes furthermore ganesh et al 2016 reported on the base of the void fraction flow fields in a venturi section that condensation shock is the instability mechanism inducing cavity shedding this methodology was applied to pumps by duplaa et al 2013 who examined the cavitation phenomenon inside the impeller during fast start up operation and correlated the density variations to pressure time evolution detailed experimental analyses of the cavitating field have generated not only remarkable achievements but also increased complexity and costs in the past several decades greater computational resources and improved mathematical models have contributed to the wide application of computational fluid dynamics cfd to multiphase flow research in earlier work the prediction of sheet partial and super cavities was achieved through free streamline cavitating theory wu 1972 which still serves as a quick validation tool during experimental measurement ganesh et al 2016 however modeling of single phase to more complicated multiphase euler lagrangian cavitating flow has recently become possible cavitation modeling can approximately be divided into homogeneous and inhomogeneous methods among which the homogeneous equilibrium flow method is a very reliable and robust approach for all types of cavitating flow simulation watanabe et al 2016 zhang et al 2015 yin et al 2018 frikha et al 2008 jian et al 2018 to define the mixture density in a homogenous flow two different methods are proposed the state equation model sem dellanoy and kueny 1990 coutier delgosha et al 2003b and the transport equation model tem kunz et al 2000 singhal et al 2002 zwart et al 2004 in sems the gradients of density and pressure are always parallel thus they cannot reflect the baroclinic torque senocak and shyy 2002 which has a significant influence on the cavitating field gopalan and katz 2000 turbulence models also play a relevant role in the prediction of cavitating flows to solve the over prediction problem of eddy viscosity at the rear part of the cavity when employing the reynolds averaged navier stokes rans model reboud et al 1998 first proposed an empirical correction of mixture density which was validated to agree well with the turbulent information obtained from fast x ray imaging khlifa and coutier delgosha 2018 moreover johansen et al 2004 formulated a filter method to avoid some of the known limitations of rans approaches and application difficulties of large eddy simulation les with this modification wu et al 2005 successfully captured the periodical shedding cavity around a two dimensional hydrofoil a combination of the above two methods also produced reasonable results in the work of huang et al 2013 as a result of efforts to improve the prediction capability of cavitation numerical models have revealed many fluid phenomena related to partial cavitation huang et al 2013 and ji et al 2014 effectively explained vortex cavitation interactions using the vorticity transport equation vte for two dimensional and quasi three dimensional hydrofoils respectively it was found that cavitation accelerated vortex stretching and dilatation and increased the baroclinic torque by employing one dimensional momentum theory chen et al 2008 ji et al 2015 found that cavity volume acceleration is the main source of pressure fluctuations around the cavitating hydrofoil according to the concept of entrainment ability unsteadiness of the fluid upstream is governed by the re entrant jet behavior long et al 2017 moreover a recent numerical study of unsteady cavitating flow around naca66 showed that the shedding mechanism is not accurate due to the existence of both reverse flow and turbulence effects chen et al 2019 however the majority of previous work does not consider no slip end wall effects therefore this study conducts a numerical investigation of cavitating flow around a three dimensional 3d hydrofoil with a bounded wall in order to reveal the unsteadiness characteristics of cloud cavitation 2 mathematical model in the present modeling strategy there are only two mediums involved in the cavitating flow water and vapor whereas non condensable gases are neglected two different treatments are proposed to solve the governing equations of the two mediums inhomogeneous and homogeneous methods here the homogeneous flow concept is employed because of its robustness and successful applications in a variety of cases for example throttles altimira and fuchs 2015 pumps jian et al 2018 and injectors som et al 2010 in the framework of homogeneous topology water and vapor are considered as a one fluid mixture where slip between the two mediums is ignored and the mixture density ρ m depends on the vapor volume fraction α v and changes as follows 1 ρ m ρ l 1 α v ρ v α v here ρ l and ρ v are the densities of water and vapor water and vapor share the same velocity and pressure and the conversation equations of mass and momentum are 2 ρ m t ρ m u j x j 0 3 ρ m u i t ρ m u i u j x j ρ m f i p x i x j μ μ t u i x j u j x i 2 3 u k x k δ i j where u i is the velocity in the i direction p is the pressure and gravity is neglected because of its weak effect on the internal flow inside the water tunnel therefore the body force f i is equal to zero μ and μ t are the laminar viscosity and the turbulent viscosity respectively the shear stress transport sst k ω turbulence model menter 2009 widely tested two equation eddy viscosity turbulence model is applied here to close the above equations it is a hybridization of the k ω and k ε turbulence models which can automatically switch between the main flow and near wall areas and can very well predict flow separation at different pressure gradients buoyancy turbulence is ignored and governing equations of k and ω are as follows 4 ρ m k t ρ m u j k x j x j μ σ k μ t k x j p k β ρ m k ω 5 ρ m ω t ρ m u j ω x j α ν t p k β ρ m ω 2 x j μ σ ω μ t ω x j 2 1 f 1 ρ m σ ω 2 1 ω k x j ω x j 6 f 1 t a n h m i n m a x k β ω y 500 ν y 2 ω 4 ρ m σ ω 2 k c d k ω y 2 4 7 f 2 t a n h m a x 2 k β ω y 500 ν y 2 ω 2 8 c d k ω m a x 2 ρ m σ ω 2 1 ω k x j ω x j 10 10 p k is the production rate of turbulence calculated using the following equations 9 p k μ t u i x j u j x i u i x j 10 p k m i n p k 10 β ρ m k ω the coefficients in eq 4 and eq 5 are a linear combination of the corresponding coefficients of the k ω and k ε closure as follows 11 φ φ 1 f 1 φ 2 1 f 1 where β 0 09 α 1 5 9 β 1 3 40 σ k 1 0 85 σ ω 1 0 5 α 2 0 44 β 2 0 0828 σ k 2 1 σ ω 2 0 856 the following equation is used to determine the turbulent viscosity μ t 12 μ t ν m ρ m a 1 ρ m k m a x a 1 ω s f 2 where k is the turbulence kinetic energy ω is the turbulence frequency s is the invariant measure of the strain rate a 1 0 31 in accounting for larger changes in density as a result of cavitation coutier delgosha et al 2003a proposed a modifying method by correcting mixture density also named density corrected method dcm which effectively reduces the turbulent viscosity of the mixture the final modification of mixture density is presented as 13 f ρ m ρ v ρ m ρ v n ρ l ρ v n 1 the use of f ρ m observably decreases the turbulent viscosity of flow field where is occupied by higher volumes of vapor fraction regarding cavitation free flow the relation μ t obeys the original formula here n is equal to 10 yin et al 2018 corrected sst k ω model shows the improved predicting capability no matter in the tip leakage vortex cavitation zhang et al 2015 or unsteady cloud cavitation li et al 2009 the cavitation process is governed by the mass transfer equation for conservation of the vapor volume fraction given by 14 ρ v α v t ρ v α v u j x j m m m the coupled interphase mass transfer model in this study is simplified from the rayleigh plesset rp equation which provides the basis for the rate equation controlling vapor generation and condensation the growth of a gas bubble in the fluid is given by 15 r b d 2 r b d t 2 2 3 d r b d t 2 2 σ ρ l r b p v p ρ l where r b is the bubble radius p v is the vapor pressure and σ represents the surface tension coefficient it is assumed that there are no thermal barriers to bubble growth second order terms and surface tension are not considered therefore eq 15 reduces to 16 d r b d t 2 3 p v p ρ l the change rate of bubble mass is as follows 17 d m b d t ρ v d v b d t ρ v d d t 4 3 π r b 3 4 π r b 2 ρ v 2 3 p v p ρ l assuming that there are n b bubbles existing in the unit volume the vapor volume fraction α v is written as 18 α v v b n b 4 3 π r b 3 n b therefore the interphase mass transfer of vaporization m and condensation m per unit volume are given by 19 m f v a p 3 α n u c 1 α v ρ v r b 2 3 m a x p v p 0 ρ l 20 m f c o n d 3 α v ρ v r b 2 3 m a x p p v 0 ρ l where f vap and f cond are empirical coefficients for the vaporization and condensation processes with recommended values of 50 and 0 01 respectively zwart et al 2004 α n u c has a value of 5 10 4 and r b is the typical bubble radius with a value of 1 10 6 in summary our simulation pertains to an incompressible homogeneous flow framework composed of the zwart tem and the corrected sst k ω turbulence model 3 computational domain only half of the clark y hydrofoil is modeled with a symmetrical boundary as shown in fig 1 all the results are represented in the cartesian x y z coordinate system in the following discussions the origin is the intersection of the symmetry plane and the axis line halfway along the chord line of which streamwise is the x direction and spanwise is the z direction the chord length of the clark y l is equal to 100 mm according to the experimental setup watanabe et al 2014 the hydrofoil is located at the mid height of the channel with an angle of attack of 8 to stabilize the numerical calculation the inlet and outlet boundaries are placed at five times the chord length the height and width of the physical domain is 2l and 0 405l respectively in the actual situation a minor gap of 0 5 mm exists on one side between the foil and the end wall however this is ignored in this study the vertical walls of the tunnel are set as free slip surfaces whereas the end wall and foil surface are non slip the inlet velocity u is specified as 8 3 m s and low turbulence intensity is assumed static pressured is used for the outlet based on a cavitation number 21 σ p p v 1 2 ρ l u 1 45 where p denotes the upstream pressure with 2l far from the mid chord it should be noted that the upstream pressure is measured and used for the definition of σ in the experiment however the pressure difference between upstream and downstream can be ignored due to the small drag of the foil watanabe et al 2016 for the advection scheme terms a high resolution scheme is applied whereas a second order backward euler scheme is used for the transient term in order to reduce the imbalance when solving equations root mean squared rms residuals of pressure and three velocity components u v and w decreasing to below 1 10 6 is considered to obtain convergence previous research yin et al 2019 shows that even when y is 54 the mesh topology is still capable of generating reasonable results within the framework of automatic near wall treatment which indicates that the present y with a value of 20 is acceptable considering the balance between calculation cost and accuracy the time step is set as 5 10 5 s resulting in a maximum courant number of less than 10 25 and a root mean square rms courant number of less than 1 1 procedures of calculations are summarized as follows steady cavitation free case σ 1 45 cavitation model switched off 200 steps of iteration unsteady cavitation free case σ 1 45 cavitation model switched off 0 2 s of running time unsteady cavitation case σ 1 45 cavitation model switched on roughly 0 2 s of running time rms residuals of 1 10 5 get convergence within 10 loops unsteady cavitation case σ 1 45 cavitation model switched on roughly 0 7 s of running time rms residuals of 1 10 6 get convergence within 25 loops the influence of mesh density on unsteady cavity prediction was carefully analyzed with different node distributions as displayed in fig 2 around the hydrofoil numerical shedding frequency could be obtained by applying the fast fourier transform fft to the time history of total cavity volume time averaged lift coefficient c l f l 1 2 ρ l u 2 l s p a n was also counted after the shedding frequency was found as listed in table 1 medium mesh and simulation time of 0 7 s are acceptable based on the statistical analysis of two convergenced variables predicted frequency with medium mesh is 43 13 hz which is very close to the experimental value of f e x p 1 t 1 0 023 s 43 48 hz watanabe et al 2014 4 results and discussion 4 1 dynamical characteristics strong unsteadiness induced by cavity shedding can generate severe vibrations which is not tolerated within the safe operation limits of hydraulic machinery as shown in fig 3 the variations of flow rate between inlet and outlet boundaries q out q in correlates very well with the first derivative of the total cavity volume d v c d t indicating the completeness of present numerical technology decaix et al 2017 here strict control of the numerical residuals can eliminate the difference between q out q in and d v c d t to the ignorable level in contrast to the explanations of the transition from 2d to 3d ji et al 2015 therefore this comparison can be further extended to validate the reliability of the simulation topology among all cavitating cases water channel of test section is blocked by the hydrofoil and can be divided into two passages named passage up pu and passage down pd which are sliced with fixed interval 1 mm from leading x 49 mm edge to trailing x 49 mm edge shown in fig 4 area averaged pressure of these slices are extracted and plotted in fig 5 where pressure of both channels was found to fluctuate synchronously with acceleration of cavity volume previous work has partly revealed pressure fluctuations through experiments and shown some correlations between cavity motion and force coefficients arndt et al 2000 watanabe et al 2014 in this study one dimensional momentum theory chen et al 2008 was going to be utilized to figure out the influence level of cavity motions on two passages firstly starting from one dimensional unsteady bernoulli equation of incompressible fluid within a straight pipe following equation can be obtained 22 p i n p o u t d m d t i n o u t d s a m 2 i n o u t f p 8 ρ a 3 d s ι a d m d t f m u p ι 8 a 2 where p is perimeter of cross section p denotes pressure u denotes velocity t denotes time m denotes the mass flow rate ds denotes the elemental length ι denotes the characteristic length a represents the area of cross section the first term at the right hand side is caused by the acceleration of flow while the second term is a result of friction factor f which is going to be ignored here therefore the above equation can be simplified as follows 23 p i n p o u t ρ ι a d v c 2 d t 2 where p out is a constant at the outlet boundary accordingly acceleration of the total cavity volume matches the fluctuations of area averaged pressure at the inlet shown in fig 6 if the ensemble average of pressure and acceleration of cavity volume are subtracted respectively a proximate equation follows 24 p β d 2 v c d t 2 where β is the scale factor which could be obtained quantitatively by monitoring the total difference between p and d 2 v c d t 2 of every time step 25 e r r o r i 1 m β d 2 v c d t 2 t i p t i where m is number of transient data after carefully independent analysis four cycles data were sufficient for calculation where m is equal to 1840 here consdering the order of p i n in fig 6 d 2 v c d t 2 was firstly multiplied by 10 4 and then the optimal β was searched within the range between 0 and 20 with 0 1 precision until the minimum error value occurs as shown in fig 7 the scale factor behaves linearly increasing from leading to trailing in pd but displays the nonlinearity in pu where the maximum value occurring at roughly 87 x l 0 36 of chord length from leading edge lift calculation of the hydrofoil follows 26 f l a d f l a p sin θ τ w cos θ d a where θ is angle of attack a is the surface area of hydrofoil τ w is the wall shear force o 2 which is much smaller than pressure o 4 here sum of scale factors of pd is higher than pu resulting in the lift coefficient proportional to d 2 v c d t 2 shown in fig 8 however fig 9 shows that experimental lift coefficient seems to be proportional to d 2 v c d t 2 within all three selected periods where aligned timetable could be used to analyze the cavity shedding behaviors predictably some differences are observed between numerical lift coefficient and experimental data shown in fig 10 based on the premise of accurate experimental data one of the main reasons might be the shortcoming of homogeneous rans numerical technology implemented in the current work which under predicts turbulence intensity on the other side coherence between lift and cavity volume is possible to be dependent on the cavitation number σ and reynolds number re cavity length around the twist 11 yin et al 2019 and naca 0009 hydrofoil geng et al 2020 was short less than 50 of chord length numerical lift behaves negative coherence with cavity volume c l d 2 v c d t 2 cavity length was found to be slightly longer around clark y hydrofoil in this study roughly 75 of chord length where numerical lift behaves positive coherence with cavity volume c l d 2 v c d t 2 the case of naca 0066 hydrofoil ji et al 2015 gave totally different responses to the fully attached cavity on the suction surface therefore once the re was given this strong coherence might experience negative to positive characteristics by decreasing σ till weak coherence because lift will be locally distributed by highly turbulence flow when σ is very low in other words lift characteristics might be significantly governed by the local cavity evolution watanabe et al 2014 4 2 cavity shedding fig 11 shows snapshots marked in figs 9 and 10 of num01 from the top view of cavity evolution where vapor is visualized by the iso surface of α v 0 1 inherent chaotic nature of cavitating flow affects the experiment and simulation to an equal extent due to the highly transient nature of the flow and the lack of repeatability of the shedding process it is not expected to have identical flow structures for two arbitrarily chosen moments however for a qualitative assessment of flow structures the analysis presented is suitable the re entrant jet moving upstream disturbs the attached sheet cavity into a fragmented state corresponding to instant a then the sheet cavity is shed when the re entrant jet reaches close to the leading edge instant c to f represents transformation of the shed cavity and generation of the u type cavity a new sheet cavity grows at the same time with a characteristic concave shape of this new sheet cavity the existence of an end wall results in strong gradients of pressure and velocity along the spanwise direction which further affects movement of the shedding cavity finally the shedding cavity with a spindle shape largely hinders new sheet cavity development in the mid section at instant g small shedding cavities are observed at the wall side due to the wall bounded shear flow and re entrant jet during the period from instant g to h the u type cavity passes through the trailing edge and the re entrant jet moves upstream and is ready to repeat the shedding process the side view of the cavity shedding process is also plotted and compared with the experimental pictures in fig 12 due to the existence of a minor gap between the foil and end wall some tip leakage cavities are observed in the experimental test the cloud cavity does not detach from the foil surface until it passes through the trailing edge during the period between instant f and g the cloud cavity collapses rapidly this is observed both in numerical and experimental results the numerical simulation can reproduce the evolution of cavity shedding reasonably at the symmetrical and end wall sides cavity shedding during two cycles is analyzed by recording the temporal development of the vapor volume fraction and velocity in discrete points at a normal distance n 1 mm parallel to the foil suction side from the leading edge to the trailing edge with a constant distance of 1 mm figs 13 and 14 respectively it should be noted that probes are not sampled exactly at the end wall but with a 1 mm gap cavity growth is displayed as a solid red line whereas re entrant jet movement is marked with a dashed red line in both plots of vapor volume fraction in contrast to the wall side negative streamwise velocity is observed during development of the sheet cavity fig 13 in the symmetrical plane first the new sheet cavity grows with absolute positive axial velocity until 38 of the chord length fig 13 then with the increase of cavity thickness the inside cavities are forced by the main flow generating a moment of inertia in the clockwise direction thereby differing from the re entrant jet induced by an adverse pressure gradient when the re entrant jet moves close to the leading edge the attached cavities are pinched off and rotated downstream the shed cavity can even accelerate up to negative 12 m s and 8 m s at the mid section and wall side respectively see velocity plots in figs 13 and 14 moreover because of end wall effects the cavity is shattered when the re entrant jet moves upstream fig 14 4 3 vortices fig 15 displays the top view instantaneous vortical structures using ω identification criteria fixed equal to 0 52 as recommended by liu et al 2016 there are three typical u shape vortical structures i e the main vortex marked with a solid yellow line the secondary vortex marked with a dashed yellow line and the wall shedding vortex marked with a solid green line and shown in fig 15 g the inception development and collapse of cavity topology induce many vortical structures among which the re entrant jet is the main factor responsible for the corresponding mechanism with movement of the re entrant jet toward the leading edge fragmented vortical structures appear when the attached cavity is torn as shown in instant a and b inside the closure area there is a low vapor fraction mixture with strong fluctuations once the sheet cavity transforms into a cloud cavity local flow becomes more turbulent and small cavities fall off the rear at instant b fig 11 from instant b to c the shed sheet cavity develops into a pocket structure due to the effect of main flow moreover the main vortex grows gradually stronger vortex tubes in fig 11 and the previous unstable closure cavity is easily detached from the main pocket cavity which leads to generation of the secondary vortex see the short dashed yellow line another interesting phenomenon is the generation of wall shedding vortices see the solid green line which originate from the re entrant jet and wall bounded shear flow to explore the vortical field the hydrofoil is split along the spanwise direction with an interval distance of 0 5 mm fig 16 shows three selected integral paths of circulation including the leading black dashed line γ l trailing black solid line γ t and domain red solid line γ d paths circulation around the decomposed 2d foil profiles is calculated in a clockwise direction and compared within two periodical shedding processes fig 17 where z l 0 represents the end wall side and z l 0 405 represents the symmetrical side the line integral equation of circulation is 27 γ v d l u d x v d y w d z in the cavitation free field clockwise positive circulation results within the leading path area because of the positive attack angle periodical cavity shedding significantly modifies the local field above the hydrofoil generating oscillating circulation shown in the plot of γ l fig 17 a according to the kuttaâ joukowski theorem 28 f v ρ γ circulation contributes to the generation of a lift force therefore numerical lift and spanwise averaged γ l are plotted and compared with the experimental data as shown in fig 17 d the lift predicted by the kutta joukowski theorem within the framework of inviscid potential flow theory is quite accurate even for real viscous flow provided that the flow is steady and unseparated when deriving the kutta joukowski theorem the assumption of irrotational flow is used for the case when there are free vortices outside the foil as may be true for a large number of unsteady flows rotational cavitating flow more complicated theories should be used to derive the lift forces in fig 17 circulation γ l is not proportional to lift which demonstrates the non linear influence of partial cavitating flow on lift prediction correction of the predicted lift by considering cavitation is still an open issue when the flow passes through the trailing edge along the pressure side a counterclockwise vortex is generated the plot of γ t circulation fluctuates around zero indicating that counterclockwise and clockwise vortices dominate interchangeably in the wake region the sum of γ l and γ t is equal to γ d which is not a constant 0 according to stokes s theorem the relationship between circulation and vorticity is as follows 29 γ v d l v d s where the closed integration path is the boundary of a surface s to evaluate the development of vortices in the cavitating flow field the vorticity ω z at the symmetrical plane is plotted against the vapor volume fraction within one shedding cycle in fig 18 where clockwise is defined as the positive vorticity in the area above the hydrofoil the birth and motion of the local vorticity closely correlate with the evolution of the cavity starting from instant c there is a positive vorticity generating and growing inside the newly developing attached sheet cavity at instant f negative vorticity occurs in the gap between the sheet cavity and the foil wall due to the re entrant jet with motion of the re entrant jet the attached cavity is broken up into a dispersed shape negative vorticity is found at the interface between water and vapor inside the cavity before being pinched off the maximum attaching sheet cavity is observed at 75 along the chord length which is slightly longer than that at instants a and h approximately 71 in fig 18 after the sheet cavity transforms into the cloud cavity vorticity is generated not only inside the cloud cavity but also in the vicinity see the plot starting from instant c which indicates that the vorticity will be transported downstream corresponding transport phenomena are discussed with the vorticity equation in the following section a secondary vortex found in the ω field dashed yellow line in fig 15 is also detected here see the black arrow at instants c d and e negative vorticity is also observed when the peeled off cavity rotates and collapses downstream due to the velocity gradients among multiscale cavities the following vorticity equation is used to reveal the relationship between cavity development and vorticity production 30 ω t u ω ω u ω u 1 ρ 2 ρ p ν ν t 2 ω where ω u denotes the vortex stretching source ω u denotes flow compressibility source 1 ρ 2 ρ p denotes baroclinic torque source and ν ν t 2 ω denotes viscosity dissipation source decaix et al 2018 previous work shows that viscosity dissipation can be negligible if compared to other three terms ji et al 2015 huang et al 2013 and will not be discussed here compressible term and the baroclinic torque are equal to zero in the cases of non cavitating situation however occurrence of the cavitation generates non uniform mixture density field and the divergence of the velocity is expressed as follows 31 u ρ l ρ v ρ l ρ v m making these two terms not null any more to stabilize the calculation of mass transfer process vapor density was clipped with ρ l ρ v 1000 however real vapor density ρ v 0 023 kg m3 should be used here to revert the true compressibility term together with iso contours of the ω 0 52 green and α v 0 1 black the terms that compose the vorticity equation are analyzed at the slice of z l 0 2 shown in fig 19 mass transfer rate within the cavity was also figured for comparison compressibility source occupies the highest contribution of vorticity transportation and is significantly higher than other two terms basically compressibility source displays the opposite flow patterns compared to the mass transfer rate in which condensation process is the main source of vorticity generation brennen 2014 at the trailing region of growing attached cavity see the instants c and e compressibility source serves the promotion effect while inhibits the development of vorticity within the leading area inside the collapsing cloud cavity condensation and vaporization were found at the same time indicating the motion of cloud cavity involves complicated phase change phenomenon instead of pure condensation stretching source is also an important composition of vorticity transportation and dominates the region of no occurrence of cavitation such as trailing region and vicinity of cloud cavity even within the cavity region contributions of the stretching term are as same important as baroclinic term last but not least baroclinic term affects the vorticity generation within the cloud cavity and closure region of attached cavity similar findings with ji et al 2014 and huang et al 2013 5 conclusion this study numerically investigated an unsteady partial cavity around a 3d clark y hydrofoil with an end wall within an incompressible homogeneous flow framework using the zwart tem and sst turbulence models cavity growth development and break off of the periodical shedding process were reasonably reproduced and agreed with experimental observations the following conclusions were drawn the existence of an end wall leads to the generation and convection of side cavity moreover large horse type cavity structure is captured which agrees with experimental results cavities at the closure region easily detach from the main pocket part resulting in a secondary vortical structure predictably differences between numerical and experimental lift coefficients were observed however similar to our previous findings the experimental lift coefficient appeared to agree with the inverse of the second derivative of the total cavity volume based on the analysis of vorticity transportation compressibility source occupies the highest contribution of vorticity transportation and is significantly higher than other two terms at the trailing region of growing attached cavity compressibility source serves the promotion effect while inhibits the development of vorticity within the leading area funding this work is supported by the national natural science foundation of china grant no 51879121 national key research and development program grant no 2018yfb 0606103 and innovation project for postgraduates of jiangsu province grantno kycx18 2237 credit authorship contribution statement tingyun yin software visualization investigation writing original draft giorgio pavesi writing review editing investigation methodology conceptualization ji pei funding acquisition shouqi yuan supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement many thanks are given to prof satoshi watanabe department of mechanical engineering kyushu university for discussion the first author gratefully acknowledges the financial support provided china scholarship council no 201708320237 
21282,this study employs an incompressible homogeneous flow framework with a transport equation based cavitation model and density corrected shear stress transport sst k ω turbulence model to successfully reproduce the unsteady cavitating flow around a 3d clark y hydrofoil with an end wall cavity growth development and break off during the periodic shedding process are adequately reproduced and match experimental observations the predicted shedding frequency is very close to the experimental value of 43 48 hz the existence of an end wall brings about the generation and convection of wall side cavity moreover large horse type cavity structure is captured which agrees with experimental results cavities at the closure region easily detach from the main pocket part resulting in a secondary vortical structure differences between numerical and experimental lift are observed however similar to our previous findings the experimental lift coefficient appears to correlate with the inverse of the second derivative of the total cavity volume based on the analysis of vorticity transportation compressibility source occupies the highest contribution of vorticity transportation and is significantly higher than other two terms which serves the promotion effect at the trailing region of growing attached cavity while inhibits the development of vorticity within the leading area keywords unsteady cloud cavitation transient characteristics three dimensional hydrofoil 1introduction a key research topic in the field of hydraulic machinery is the partial cavitating flow containing multiscale bubbles which has attracted substantial attention due to its transient and aggressive nature brennen 2014 to explore the cavitating field water tunnels have been widely established and used to investigate a range of simplified geometry models such as nozzles stutz and reboud 1997a gopalan and katz 2000 croci et al 2019 and hydrofoils laberteaux and ceccio 2001 leroux et al 2005 franc and michel 2006 watanabe et al 2014 kravtsova et al 2014 kawanami et al 1997 arranged several high frequency sensors along the foil suction surface to obtain pressure information from the partial cavity shedding field and observed strong pressure fluctuations during downstream movement of the shedding cavities based on the proposed re entrant jet mechanism passive control methods of cavitation unsteadiness were then discussed in detail further the ultrasonic technique has been used to demonstrate that the adverse pressure gradient and the cavity thickness respective to the re entrant jet thickness are two key factors affecting re entrant jet instability callenaere et al 2001 the high pressure achieved during the collapse and impact of the emitted shock waves was first proposed as the mechanism of cavitation damage hickling and plesset 1964 fujikawa and akamatsu 1980 motivated by rayleigh s spherical bubble theory harrison 1952 first experimentally captured evidence of such high pressure pulses from a collapsing bubble with acoustic measurements and these shock waves were visualized by güth 1954 using the schlieren technique in 1954 according to vogel et al 1989 the maximum pressure inside a bubble reaches 6 gpa when the radius of the collapsing bubble decreases to 50 âμm nowadays due to our ability to produce single bubbles of known size by optimized focusing of a laser pulse much smaller collapsing radii have been found which suggests that the emitted pressure pulses could be even higher this indicates that pressure sensors could be easily destroyed during water tunnel measurements for example in the experimental tests of foeth et al 2008 and che et al 2019 traditional methods of velocity acquisition include probes stutz and reboud 1997a and laser doppler velocimetry ldv arndt et al 2000 chesnakas and jessup 2003 sou et al 2007 with the development and application of particle image velocimetry piv it is possible to further elucidate cavitating flow adrian 1986 westerweel 1997 zhang et al 1998 gopalan and katz 2000 used piv to measure the flow structure at the closure region and suggested that the collapse of vapor cavities in the closure region is the primary mechanism of vorticity production this methodology was further extended to determine the effect of the growth and collapse of cavitation on the dynamics of shear flows iyer and ceccio 2002 although considerable advances have been achieved foeth et al 2006 wosnik et al 2006 dreyer et al 2014 traditional piv suffers from the measurement limitations of the cavity inner field thus to make direct observations inside the bubbly flow high temporal and spatial resolution planar laser induced fluorescence plif was proposed dular et al 2007 employed this technique to successfully observe the instantaneous cavitation structure shape and relevant velocity field inside and outside the cavitation structure which also proved the hypothesis that the three dimensional characteristics of re entrant flow has an important influence on asymmetric cavitation cloud separation de lange and de bruin 1997 duttweiler and brennen 1998 the vapor fraction which a major quantity of interest in cavitating flows can be used to determine distinct shedding mechanisms its measurement can be traced back to 1997 when stutz and reboud 1997a and stutz and reboud 1997b used the double optical probe to measure the void fraction of the sheet cavity and cloud cavity within a venturi type test section the averaged void fraction of cloud cavity is relatively weak and does not exceed 21 while the maximum void fraction of sheet cavity varies regularly from 80 at the fore part of the cavity to 10 at the rear part later coutier delgosha et al 2007 investigated the local volume fraction of the vapor phase inside the cavity and in the wake of the two dimensional hydrofoil with an x ray absorption device aeschlimann et al 2011 provided an analysis of vapor distribution in a test bed facility consisting of a cavitating mixing layer where the development of vapor structures was observed inside kelvin helmholtz eddies further significant progress was made in 2013 when mäkiharju et al 2013 developed an x ray densitometry system that measures the time resolved two dimensional projection of the void fraction flow field of gas liquid flows thereby acquiring information from a plane instead of discrete probes furthermore ganesh et al 2016 reported on the base of the void fraction flow fields in a venturi section that condensation shock is the instability mechanism inducing cavity shedding this methodology was applied to pumps by duplaa et al 2013 who examined the cavitation phenomenon inside the impeller during fast start up operation and correlated the density variations to pressure time evolution detailed experimental analyses of the cavitating field have generated not only remarkable achievements but also increased complexity and costs in the past several decades greater computational resources and improved mathematical models have contributed to the wide application of computational fluid dynamics cfd to multiphase flow research in earlier work the prediction of sheet partial and super cavities was achieved through free streamline cavitating theory wu 1972 which still serves as a quick validation tool during experimental measurement ganesh et al 2016 however modeling of single phase to more complicated multiphase euler lagrangian cavitating flow has recently become possible cavitation modeling can approximately be divided into homogeneous and inhomogeneous methods among which the homogeneous equilibrium flow method is a very reliable and robust approach for all types of cavitating flow simulation watanabe et al 2016 zhang et al 2015 yin et al 2018 frikha et al 2008 jian et al 2018 to define the mixture density in a homogenous flow two different methods are proposed the state equation model sem dellanoy and kueny 1990 coutier delgosha et al 2003b and the transport equation model tem kunz et al 2000 singhal et al 2002 zwart et al 2004 in sems the gradients of density and pressure are always parallel thus they cannot reflect the baroclinic torque senocak and shyy 2002 which has a significant influence on the cavitating field gopalan and katz 2000 turbulence models also play a relevant role in the prediction of cavitating flows to solve the over prediction problem of eddy viscosity at the rear part of the cavity when employing the reynolds averaged navier stokes rans model reboud et al 1998 first proposed an empirical correction of mixture density which was validated to agree well with the turbulent information obtained from fast x ray imaging khlifa and coutier delgosha 2018 moreover johansen et al 2004 formulated a filter method to avoid some of the known limitations of rans approaches and application difficulties of large eddy simulation les with this modification wu et al 2005 successfully captured the periodical shedding cavity around a two dimensional hydrofoil a combination of the above two methods also produced reasonable results in the work of huang et al 2013 as a result of efforts to improve the prediction capability of cavitation numerical models have revealed many fluid phenomena related to partial cavitation huang et al 2013 and ji et al 2014 effectively explained vortex cavitation interactions using the vorticity transport equation vte for two dimensional and quasi three dimensional hydrofoils respectively it was found that cavitation accelerated vortex stretching and dilatation and increased the baroclinic torque by employing one dimensional momentum theory chen et al 2008 ji et al 2015 found that cavity volume acceleration is the main source of pressure fluctuations around the cavitating hydrofoil according to the concept of entrainment ability unsteadiness of the fluid upstream is governed by the re entrant jet behavior long et al 2017 moreover a recent numerical study of unsteady cavitating flow around naca66 showed that the shedding mechanism is not accurate due to the existence of both reverse flow and turbulence effects chen et al 2019 however the majority of previous work does not consider no slip end wall effects therefore this study conducts a numerical investigation of cavitating flow around a three dimensional 3d hydrofoil with a bounded wall in order to reveal the unsteadiness characteristics of cloud cavitation 2 mathematical model in the present modeling strategy there are only two mediums involved in the cavitating flow water and vapor whereas non condensable gases are neglected two different treatments are proposed to solve the governing equations of the two mediums inhomogeneous and homogeneous methods here the homogeneous flow concept is employed because of its robustness and successful applications in a variety of cases for example throttles altimira and fuchs 2015 pumps jian et al 2018 and injectors som et al 2010 in the framework of homogeneous topology water and vapor are considered as a one fluid mixture where slip between the two mediums is ignored and the mixture density ρ m depends on the vapor volume fraction α v and changes as follows 1 ρ m ρ l 1 α v ρ v α v here ρ l and ρ v are the densities of water and vapor water and vapor share the same velocity and pressure and the conversation equations of mass and momentum are 2 ρ m t ρ m u j x j 0 3 ρ m u i t ρ m u i u j x j ρ m f i p x i x j μ μ t u i x j u j x i 2 3 u k x k δ i j where u i is the velocity in the i direction p is the pressure and gravity is neglected because of its weak effect on the internal flow inside the water tunnel therefore the body force f i is equal to zero μ and μ t are the laminar viscosity and the turbulent viscosity respectively the shear stress transport sst k ω turbulence model menter 2009 widely tested two equation eddy viscosity turbulence model is applied here to close the above equations it is a hybridization of the k ω and k ε turbulence models which can automatically switch between the main flow and near wall areas and can very well predict flow separation at different pressure gradients buoyancy turbulence is ignored and governing equations of k and ω are as follows 4 ρ m k t ρ m u j k x j x j μ σ k μ t k x j p k β ρ m k ω 5 ρ m ω t ρ m u j ω x j α ν t p k β ρ m ω 2 x j μ σ ω μ t ω x j 2 1 f 1 ρ m σ ω 2 1 ω k x j ω x j 6 f 1 t a n h m i n m a x k β ω y 500 ν y 2 ω 4 ρ m σ ω 2 k c d k ω y 2 4 7 f 2 t a n h m a x 2 k β ω y 500 ν y 2 ω 2 8 c d k ω m a x 2 ρ m σ ω 2 1 ω k x j ω x j 10 10 p k is the production rate of turbulence calculated using the following equations 9 p k μ t u i x j u j x i u i x j 10 p k m i n p k 10 β ρ m k ω the coefficients in eq 4 and eq 5 are a linear combination of the corresponding coefficients of the k ω and k ε closure as follows 11 φ φ 1 f 1 φ 2 1 f 1 where β 0 09 α 1 5 9 β 1 3 40 σ k 1 0 85 σ ω 1 0 5 α 2 0 44 β 2 0 0828 σ k 2 1 σ ω 2 0 856 the following equation is used to determine the turbulent viscosity μ t 12 μ t ν m ρ m a 1 ρ m k m a x a 1 ω s f 2 where k is the turbulence kinetic energy ω is the turbulence frequency s is the invariant measure of the strain rate a 1 0 31 in accounting for larger changes in density as a result of cavitation coutier delgosha et al 2003a proposed a modifying method by correcting mixture density also named density corrected method dcm which effectively reduces the turbulent viscosity of the mixture the final modification of mixture density is presented as 13 f ρ m ρ v ρ m ρ v n ρ l ρ v n 1 the use of f ρ m observably decreases the turbulent viscosity of flow field where is occupied by higher volumes of vapor fraction regarding cavitation free flow the relation μ t obeys the original formula here n is equal to 10 yin et al 2018 corrected sst k ω model shows the improved predicting capability no matter in the tip leakage vortex cavitation zhang et al 2015 or unsteady cloud cavitation li et al 2009 the cavitation process is governed by the mass transfer equation for conservation of the vapor volume fraction given by 14 ρ v α v t ρ v α v u j x j m m m the coupled interphase mass transfer model in this study is simplified from the rayleigh plesset rp equation which provides the basis for the rate equation controlling vapor generation and condensation the growth of a gas bubble in the fluid is given by 15 r b d 2 r b d t 2 2 3 d r b d t 2 2 σ ρ l r b p v p ρ l where r b is the bubble radius p v is the vapor pressure and σ represents the surface tension coefficient it is assumed that there are no thermal barriers to bubble growth second order terms and surface tension are not considered therefore eq 15 reduces to 16 d r b d t 2 3 p v p ρ l the change rate of bubble mass is as follows 17 d m b d t ρ v d v b d t ρ v d d t 4 3 π r b 3 4 π r b 2 ρ v 2 3 p v p ρ l assuming that there are n b bubbles existing in the unit volume the vapor volume fraction α v is written as 18 α v v b n b 4 3 π r b 3 n b therefore the interphase mass transfer of vaporization m and condensation m per unit volume are given by 19 m f v a p 3 α n u c 1 α v ρ v r b 2 3 m a x p v p 0 ρ l 20 m f c o n d 3 α v ρ v r b 2 3 m a x p p v 0 ρ l where f vap and f cond are empirical coefficients for the vaporization and condensation processes with recommended values of 50 and 0 01 respectively zwart et al 2004 α n u c has a value of 5 10 4 and r b is the typical bubble radius with a value of 1 10 6 in summary our simulation pertains to an incompressible homogeneous flow framework composed of the zwart tem and the corrected sst k ω turbulence model 3 computational domain only half of the clark y hydrofoil is modeled with a symmetrical boundary as shown in fig 1 all the results are represented in the cartesian x y z coordinate system in the following discussions the origin is the intersection of the symmetry plane and the axis line halfway along the chord line of which streamwise is the x direction and spanwise is the z direction the chord length of the clark y l is equal to 100 mm according to the experimental setup watanabe et al 2014 the hydrofoil is located at the mid height of the channel with an angle of attack of 8 to stabilize the numerical calculation the inlet and outlet boundaries are placed at five times the chord length the height and width of the physical domain is 2l and 0 405l respectively in the actual situation a minor gap of 0 5 mm exists on one side between the foil and the end wall however this is ignored in this study the vertical walls of the tunnel are set as free slip surfaces whereas the end wall and foil surface are non slip the inlet velocity u is specified as 8 3 m s and low turbulence intensity is assumed static pressured is used for the outlet based on a cavitation number 21 σ p p v 1 2 ρ l u 1 45 where p denotes the upstream pressure with 2l far from the mid chord it should be noted that the upstream pressure is measured and used for the definition of σ in the experiment however the pressure difference between upstream and downstream can be ignored due to the small drag of the foil watanabe et al 2016 for the advection scheme terms a high resolution scheme is applied whereas a second order backward euler scheme is used for the transient term in order to reduce the imbalance when solving equations root mean squared rms residuals of pressure and three velocity components u v and w decreasing to below 1 10 6 is considered to obtain convergence previous research yin et al 2019 shows that even when y is 54 the mesh topology is still capable of generating reasonable results within the framework of automatic near wall treatment which indicates that the present y with a value of 20 is acceptable considering the balance between calculation cost and accuracy the time step is set as 5 10 5 s resulting in a maximum courant number of less than 10 25 and a root mean square rms courant number of less than 1 1 procedures of calculations are summarized as follows steady cavitation free case σ 1 45 cavitation model switched off 200 steps of iteration unsteady cavitation free case σ 1 45 cavitation model switched off 0 2 s of running time unsteady cavitation case σ 1 45 cavitation model switched on roughly 0 2 s of running time rms residuals of 1 10 5 get convergence within 10 loops unsteady cavitation case σ 1 45 cavitation model switched on roughly 0 7 s of running time rms residuals of 1 10 6 get convergence within 25 loops the influence of mesh density on unsteady cavity prediction was carefully analyzed with different node distributions as displayed in fig 2 around the hydrofoil numerical shedding frequency could be obtained by applying the fast fourier transform fft to the time history of total cavity volume time averaged lift coefficient c l f l 1 2 ρ l u 2 l s p a n was also counted after the shedding frequency was found as listed in table 1 medium mesh and simulation time of 0 7 s are acceptable based on the statistical analysis of two convergenced variables predicted frequency with medium mesh is 43 13 hz which is very close to the experimental value of f e x p 1 t 1 0 023 s 43 48 hz watanabe et al 2014 4 results and discussion 4 1 dynamical characteristics strong unsteadiness induced by cavity shedding can generate severe vibrations which is not tolerated within the safe operation limits of hydraulic machinery as shown in fig 3 the variations of flow rate between inlet and outlet boundaries q out q in correlates very well with the first derivative of the total cavity volume d v c d t indicating the completeness of present numerical technology decaix et al 2017 here strict control of the numerical residuals can eliminate the difference between q out q in and d v c d t to the ignorable level in contrast to the explanations of the transition from 2d to 3d ji et al 2015 therefore this comparison can be further extended to validate the reliability of the simulation topology among all cavitating cases water channel of test section is blocked by the hydrofoil and can be divided into two passages named passage up pu and passage down pd which are sliced with fixed interval 1 mm from leading x 49 mm edge to trailing x 49 mm edge shown in fig 4 area averaged pressure of these slices are extracted and plotted in fig 5 where pressure of both channels was found to fluctuate synchronously with acceleration of cavity volume previous work has partly revealed pressure fluctuations through experiments and shown some correlations between cavity motion and force coefficients arndt et al 2000 watanabe et al 2014 in this study one dimensional momentum theory chen et al 2008 was going to be utilized to figure out the influence level of cavity motions on two passages firstly starting from one dimensional unsteady bernoulli equation of incompressible fluid within a straight pipe following equation can be obtained 22 p i n p o u t d m d t i n o u t d s a m 2 i n o u t f p 8 ρ a 3 d s ι a d m d t f m u p ι 8 a 2 where p is perimeter of cross section p denotes pressure u denotes velocity t denotes time m denotes the mass flow rate ds denotes the elemental length ι denotes the characteristic length a represents the area of cross section the first term at the right hand side is caused by the acceleration of flow while the second term is a result of friction factor f which is going to be ignored here therefore the above equation can be simplified as follows 23 p i n p o u t ρ ι a d v c 2 d t 2 where p out is a constant at the outlet boundary accordingly acceleration of the total cavity volume matches the fluctuations of area averaged pressure at the inlet shown in fig 6 if the ensemble average of pressure and acceleration of cavity volume are subtracted respectively a proximate equation follows 24 p β d 2 v c d t 2 where β is the scale factor which could be obtained quantitatively by monitoring the total difference between p and d 2 v c d t 2 of every time step 25 e r r o r i 1 m β d 2 v c d t 2 t i p t i where m is number of transient data after carefully independent analysis four cycles data were sufficient for calculation where m is equal to 1840 here consdering the order of p i n in fig 6 d 2 v c d t 2 was firstly multiplied by 10 4 and then the optimal β was searched within the range between 0 and 20 with 0 1 precision until the minimum error value occurs as shown in fig 7 the scale factor behaves linearly increasing from leading to trailing in pd but displays the nonlinearity in pu where the maximum value occurring at roughly 87 x l 0 36 of chord length from leading edge lift calculation of the hydrofoil follows 26 f l a d f l a p sin θ τ w cos θ d a where θ is angle of attack a is the surface area of hydrofoil τ w is the wall shear force o 2 which is much smaller than pressure o 4 here sum of scale factors of pd is higher than pu resulting in the lift coefficient proportional to d 2 v c d t 2 shown in fig 8 however fig 9 shows that experimental lift coefficient seems to be proportional to d 2 v c d t 2 within all three selected periods where aligned timetable could be used to analyze the cavity shedding behaviors predictably some differences are observed between numerical lift coefficient and experimental data shown in fig 10 based on the premise of accurate experimental data one of the main reasons might be the shortcoming of homogeneous rans numerical technology implemented in the current work which under predicts turbulence intensity on the other side coherence between lift and cavity volume is possible to be dependent on the cavitation number σ and reynolds number re cavity length around the twist 11 yin et al 2019 and naca 0009 hydrofoil geng et al 2020 was short less than 50 of chord length numerical lift behaves negative coherence with cavity volume c l d 2 v c d t 2 cavity length was found to be slightly longer around clark y hydrofoil in this study roughly 75 of chord length where numerical lift behaves positive coherence with cavity volume c l d 2 v c d t 2 the case of naca 0066 hydrofoil ji et al 2015 gave totally different responses to the fully attached cavity on the suction surface therefore once the re was given this strong coherence might experience negative to positive characteristics by decreasing σ till weak coherence because lift will be locally distributed by highly turbulence flow when σ is very low in other words lift characteristics might be significantly governed by the local cavity evolution watanabe et al 2014 4 2 cavity shedding fig 11 shows snapshots marked in figs 9 and 10 of num01 from the top view of cavity evolution where vapor is visualized by the iso surface of α v 0 1 inherent chaotic nature of cavitating flow affects the experiment and simulation to an equal extent due to the highly transient nature of the flow and the lack of repeatability of the shedding process it is not expected to have identical flow structures for two arbitrarily chosen moments however for a qualitative assessment of flow structures the analysis presented is suitable the re entrant jet moving upstream disturbs the attached sheet cavity into a fragmented state corresponding to instant a then the sheet cavity is shed when the re entrant jet reaches close to the leading edge instant c to f represents transformation of the shed cavity and generation of the u type cavity a new sheet cavity grows at the same time with a characteristic concave shape of this new sheet cavity the existence of an end wall results in strong gradients of pressure and velocity along the spanwise direction which further affects movement of the shedding cavity finally the shedding cavity with a spindle shape largely hinders new sheet cavity development in the mid section at instant g small shedding cavities are observed at the wall side due to the wall bounded shear flow and re entrant jet during the period from instant g to h the u type cavity passes through the trailing edge and the re entrant jet moves upstream and is ready to repeat the shedding process the side view of the cavity shedding process is also plotted and compared with the experimental pictures in fig 12 due to the existence of a minor gap between the foil and end wall some tip leakage cavities are observed in the experimental test the cloud cavity does not detach from the foil surface until it passes through the trailing edge during the period between instant f and g the cloud cavity collapses rapidly this is observed both in numerical and experimental results the numerical simulation can reproduce the evolution of cavity shedding reasonably at the symmetrical and end wall sides cavity shedding during two cycles is analyzed by recording the temporal development of the vapor volume fraction and velocity in discrete points at a normal distance n 1 mm parallel to the foil suction side from the leading edge to the trailing edge with a constant distance of 1 mm figs 13 and 14 respectively it should be noted that probes are not sampled exactly at the end wall but with a 1 mm gap cavity growth is displayed as a solid red line whereas re entrant jet movement is marked with a dashed red line in both plots of vapor volume fraction in contrast to the wall side negative streamwise velocity is observed during development of the sheet cavity fig 13 in the symmetrical plane first the new sheet cavity grows with absolute positive axial velocity until 38 of the chord length fig 13 then with the increase of cavity thickness the inside cavities are forced by the main flow generating a moment of inertia in the clockwise direction thereby differing from the re entrant jet induced by an adverse pressure gradient when the re entrant jet moves close to the leading edge the attached cavities are pinched off and rotated downstream the shed cavity can even accelerate up to negative 12 m s and 8 m s at the mid section and wall side respectively see velocity plots in figs 13 and 14 moreover because of end wall effects the cavity is shattered when the re entrant jet moves upstream fig 14 4 3 vortices fig 15 displays the top view instantaneous vortical structures using ω identification criteria fixed equal to 0 52 as recommended by liu et al 2016 there are three typical u shape vortical structures i e the main vortex marked with a solid yellow line the secondary vortex marked with a dashed yellow line and the wall shedding vortex marked with a solid green line and shown in fig 15 g the inception development and collapse of cavity topology induce many vortical structures among which the re entrant jet is the main factor responsible for the corresponding mechanism with movement of the re entrant jet toward the leading edge fragmented vortical structures appear when the attached cavity is torn as shown in instant a and b inside the closure area there is a low vapor fraction mixture with strong fluctuations once the sheet cavity transforms into a cloud cavity local flow becomes more turbulent and small cavities fall off the rear at instant b fig 11 from instant b to c the shed sheet cavity develops into a pocket structure due to the effect of main flow moreover the main vortex grows gradually stronger vortex tubes in fig 11 and the previous unstable closure cavity is easily detached from the main pocket cavity which leads to generation of the secondary vortex see the short dashed yellow line another interesting phenomenon is the generation of wall shedding vortices see the solid green line which originate from the re entrant jet and wall bounded shear flow to explore the vortical field the hydrofoil is split along the spanwise direction with an interval distance of 0 5 mm fig 16 shows three selected integral paths of circulation including the leading black dashed line γ l trailing black solid line γ t and domain red solid line γ d paths circulation around the decomposed 2d foil profiles is calculated in a clockwise direction and compared within two periodical shedding processes fig 17 where z l 0 represents the end wall side and z l 0 405 represents the symmetrical side the line integral equation of circulation is 27 γ v d l u d x v d y w d z in the cavitation free field clockwise positive circulation results within the leading path area because of the positive attack angle periodical cavity shedding significantly modifies the local field above the hydrofoil generating oscillating circulation shown in the plot of γ l fig 17 a according to the kuttaâ joukowski theorem 28 f v ρ γ circulation contributes to the generation of a lift force therefore numerical lift and spanwise averaged γ l are plotted and compared with the experimental data as shown in fig 17 d the lift predicted by the kutta joukowski theorem within the framework of inviscid potential flow theory is quite accurate even for real viscous flow provided that the flow is steady and unseparated when deriving the kutta joukowski theorem the assumption of irrotational flow is used for the case when there are free vortices outside the foil as may be true for a large number of unsteady flows rotational cavitating flow more complicated theories should be used to derive the lift forces in fig 17 circulation γ l is not proportional to lift which demonstrates the non linear influence of partial cavitating flow on lift prediction correction of the predicted lift by considering cavitation is still an open issue when the flow passes through the trailing edge along the pressure side a counterclockwise vortex is generated the plot of γ t circulation fluctuates around zero indicating that counterclockwise and clockwise vortices dominate interchangeably in the wake region the sum of γ l and γ t is equal to γ d which is not a constant 0 according to stokes s theorem the relationship between circulation and vorticity is as follows 29 γ v d l v d s where the closed integration path is the boundary of a surface s to evaluate the development of vortices in the cavitating flow field the vorticity ω z at the symmetrical plane is plotted against the vapor volume fraction within one shedding cycle in fig 18 where clockwise is defined as the positive vorticity in the area above the hydrofoil the birth and motion of the local vorticity closely correlate with the evolution of the cavity starting from instant c there is a positive vorticity generating and growing inside the newly developing attached sheet cavity at instant f negative vorticity occurs in the gap between the sheet cavity and the foil wall due to the re entrant jet with motion of the re entrant jet the attached cavity is broken up into a dispersed shape negative vorticity is found at the interface between water and vapor inside the cavity before being pinched off the maximum attaching sheet cavity is observed at 75 along the chord length which is slightly longer than that at instants a and h approximately 71 in fig 18 after the sheet cavity transforms into the cloud cavity vorticity is generated not only inside the cloud cavity but also in the vicinity see the plot starting from instant c which indicates that the vorticity will be transported downstream corresponding transport phenomena are discussed with the vorticity equation in the following section a secondary vortex found in the ω field dashed yellow line in fig 15 is also detected here see the black arrow at instants c d and e negative vorticity is also observed when the peeled off cavity rotates and collapses downstream due to the velocity gradients among multiscale cavities the following vorticity equation is used to reveal the relationship between cavity development and vorticity production 30 ω t u ω ω u ω u 1 ρ 2 ρ p ν ν t 2 ω where ω u denotes the vortex stretching source ω u denotes flow compressibility source 1 ρ 2 ρ p denotes baroclinic torque source and ν ν t 2 ω denotes viscosity dissipation source decaix et al 2018 previous work shows that viscosity dissipation can be negligible if compared to other three terms ji et al 2015 huang et al 2013 and will not be discussed here compressible term and the baroclinic torque are equal to zero in the cases of non cavitating situation however occurrence of the cavitation generates non uniform mixture density field and the divergence of the velocity is expressed as follows 31 u ρ l ρ v ρ l ρ v m making these two terms not null any more to stabilize the calculation of mass transfer process vapor density was clipped with ρ l ρ v 1000 however real vapor density ρ v 0 023 kg m3 should be used here to revert the true compressibility term together with iso contours of the ω 0 52 green and α v 0 1 black the terms that compose the vorticity equation are analyzed at the slice of z l 0 2 shown in fig 19 mass transfer rate within the cavity was also figured for comparison compressibility source occupies the highest contribution of vorticity transportation and is significantly higher than other two terms basically compressibility source displays the opposite flow patterns compared to the mass transfer rate in which condensation process is the main source of vorticity generation brennen 2014 at the trailing region of growing attached cavity see the instants c and e compressibility source serves the promotion effect while inhibits the development of vorticity within the leading area inside the collapsing cloud cavity condensation and vaporization were found at the same time indicating the motion of cloud cavity involves complicated phase change phenomenon instead of pure condensation stretching source is also an important composition of vorticity transportation and dominates the region of no occurrence of cavitation such as trailing region and vicinity of cloud cavity even within the cavity region contributions of the stretching term are as same important as baroclinic term last but not least baroclinic term affects the vorticity generation within the cloud cavity and closure region of attached cavity similar findings with ji et al 2014 and huang et al 2013 5 conclusion this study numerically investigated an unsteady partial cavity around a 3d clark y hydrofoil with an end wall within an incompressible homogeneous flow framework using the zwart tem and sst turbulence models cavity growth development and break off of the periodical shedding process were reasonably reproduced and agreed with experimental observations the following conclusions were drawn the existence of an end wall leads to the generation and convection of side cavity moreover large horse type cavity structure is captured which agrees with experimental results cavities at the closure region easily detach from the main pocket part resulting in a secondary vortical structure predictably differences between numerical and experimental lift coefficients were observed however similar to our previous findings the experimental lift coefficient appeared to agree with the inverse of the second derivative of the total cavity volume based on the analysis of vorticity transportation compressibility source occupies the highest contribution of vorticity transportation and is significantly higher than other two terms at the trailing region of growing attached cavity compressibility source serves the promotion effect while inhibits the development of vorticity within the leading area funding this work is supported by the national natural science foundation of china grant no 51879121 national key research and development program grant no 2018yfb 0606103 and innovation project for postgraduates of jiangsu province grantno kycx18 2237 credit authorship contribution statement tingyun yin software visualization investigation writing original draft giorgio pavesi writing review editing investigation methodology conceptualization ji pei funding acquisition shouqi yuan supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement many thanks are given to prof satoshi watanabe department of mechanical engineering kyushu university for discussion the first author gratefully acknowledges the financial support provided china scholarship council no 201708320237 
21283,identification of the time varying linear and nonlinear impulse response functions lirf and qirf of moored or tethering floating structures is deemed a very challenging work because of nonlinearity and nonstationarity this paper proposes an identification method namely a time domain parametric volterra model based on cuckoo search optimized kalman smoother cs ks to identify the lirf and qirf of 1 100 scale model test of spar platform a conventional frequency domain volterra model is used as a benchmark given the numerical and model test data in terms of measured wave height and surge motion of the platform the proposed identification method can produce high time resolution of the time varying lirf and qirf the linear and nonlinear responses as well as natural frequency and damping ratio can be accurately extracted through numerical simulation supported by experimental results this paper also highlights the practical benefits of the proposed identification method to estimate the time varying kernel coefficients graphical abstract image 1 keywords spar platform impulse response functions volterra model cs ks 1 introduction impulse response function irf is known as a characterization of system dynamics in time domain in generating the irf there are two common approaches used namely numerical and empirical models the former requires first principle and involves rigorous mathematical formulations for complex systems such an approach is considered less practical so as to achieve the fast calculation consequently the physical modeling must be imposed with simplifications the latter requires system input output dataset and involves system identification methods this might be considered as an alternative instead of the first principle modeling the dynamic behaviour of the system using system identification in the form of irf has become a very active research several methods have been proposed such as jones 1986 ahn et al 2005 jones 1986 delivered a basic method for identification of irf of a damped sdof system herlufsen and gade 1992 discussed the errors in calculating the irf from the frf when dft fft analysis technique was used keqin 1993 then also confirmed the inaccuracy of the irf when the fourier transform of the frf was inversed tzes and le 1996 expanded the concept of irf for flexible structures and recommended the use of adaptive infinite irf they demonstrated the feasibility of obtaining the irf by manipulating the imaginary part of the frf in terms of energy concentration property therefore direct identification of irf in time domain had been performed by prazenica 2002 wavelet basis function to represent the volterra kernel coefficients for nonlinear time invariant nti systems was proposed the results were low order estimates of first and second order kernel coefficients using similar basis functions schukin et al 2004 performed optimization to generate the irf with application to an sdof system in addition sun and chen 2002 proposed a new infinite irf based on adaptive algorithm to be applied for an active noise control the coefficients were estimated using the filtered u type least mean square benefits of inherent zero pole structure in obtaining the infinite irf were demonstrated ahn et al 2005 studied the effect of finite record length to the spectrum of irf and the form of spectrum was significantly affected by the record length moreover application of the irf to the engineering field can be referred to kurka and cowley 1988 benedetti et al 2011 samples are as follows modal analysis based on irf had been performed by kurka and cowley 1988 hu et al 2011 li et al 2012 vibration testing based on the irf had been conducted by hosoya et al 2012 and kajiwara et al tiwari and chakravarthy 2006 fault diagnosis based on the irf had been performed by tiwari and chakravarthy junsheng et al 2007 junsheng et al kajiwara and hosoya 2011 cui et al 2016 and ou et al 2016 non causality of two impulse responses had been studied by falnes 1995 where the effect of incident wave elevation on an immersed body was highlighted identification of irf generated by contact force in the nanon s using two input filter technique had been performed by benedetti et al 2011 in the context of moored and tethered floating structures subjected to random waves in the open sea there are linear and nonlinear interactions between the waves and the structure spanos et al 2005 naess et al 2007 montasir and kurian 2011 the common parametric approach namely nonlinear auto regressive moving average model with exogenous input narmax model can be generally employed to identify such phenomena the concept has been mature and well documented however when the system has nonstationary behaviour instead of stationary then narmax model will not work well for such systems consequently the identification of irfs becomes a challenging task thus main contributions of this paper addressing current research challenges can be listed as follows 1 this paper proposes a time varying parametric volterra model to extend the concept of linear and nonlinear time invariant lti and nti models into linear and nonlinear time variant ltv and ntv models time varying regressor vectors are introduced to capture the nonlinearity and nonstationarity of the underlying systems simultaneously higher order spectra analysis based volterra model as a nonparametric approach is taken as a benchmark 2 this paper highlights the estimation method of time varying kernel coefficients using cuckoo search based kalman smoother cs ks method to achieve an accurate estimation 3 this paper demonstrates the practical benefits of proposed identification method to produce the time varying linear and nonlinear irfs in the high time resolution from 1 100 scale model test of spar platform extraction of linear and nonlinear dynamic responses from the platform is also carried out by means of the convoluted irfs 4 this paper also presents the extraction of modal parameters in terms of natural frequency and damping ratio the modal parameters can be calculated from the estimated irfs under logarithmic decrement method also from the extracted dynamic responses the modal parameters can be calculated under the tvar model this paper is proceeded as follows section 2 depicts the step by step of generating state space model from the time domain parametric volterra model converting and representing the kernel coefficients into adaptive filters and presenting the cs ks method as a proposed estimation method optimization process of ks parameters using cuckoo search algorithm is put on section 3 section 4 derives the calculation of irfs and modal analysis while section 5 depicts the experimental setup of model test furthermore section 6 presents and discusses the identification results in terms of estimated irfs and modal parameters lastly section 7 concludes this paper and provides recommendations 2 conversion of time domain volterra model into state space model 2 1 representation of first and second order volterra kernel coefficients in adaptive filters for a single input single output siso system in discrete time index of n t s δ t s where δ t s denotes the time step and n t s δ t s indicates the largest discrete time index under the observed time interval t 0 t s nonlinear relation of a system input u n to a system output y n can be written in a general volterra model and given by eq 1 he et al 2013 1 y q ˆ n k 1 k q 1 k c 0 q k 1 k q n i 1 q u n k i as can be seen eq 1 contains two important quantities c 0 q k 1 k q n and u n k i the former is called volterra kernel coefficient and the latter is called lagged system input by having the order of system input of q and maximum lag of k kernel coefficient can be expressed into k 1 k q 1 k c 0 q k 1 k q n where notation k 1 k q 1 k is k 1 1 k k q 1 k the lagged system input can be written in the form of i 1 q u n k i where i 1 q is ith order lag product operator and k i 1 k consequently index of n in the volterra kernel coefficients reflects that eq 1 is suitable for modeling the time variant tv system dynamics however when the system is time invariant tiv index of n can be omitted furthermore eq 1 calls three remarks remark 1 if the lag of system input is set to be q 1 then eq 1 is simplified into the first order response linear response as given by eq 2 2 y 1 ˆ n k 1 1 k c 0 1 k 1 n u n k 1 remark 2 if the lag of system input is set to be q 2 then eq 1 is simplified into second order response nonlinear response as given by eq 3 3 y ˆ 2 n k 1 k 2 1 k c 0 2 k 1 k 2 n u n k 1 u n k 2 remark 3 if the lag of system input is set to be q 3 then eq 1 can be expanded into higher order nonlinear dynamic response accordingly since most moored and tethered floating systems can be modeled up to second order spanos et al 2005 montasir and kurian 2011 then first and second order dynamic responses in eqs 2 3 can be summed as follows 4 y ˆ n k 1 1 k c 0 1 k 1 n u n k 1 k 1 k 2 1 k c 0 2 k 1 k 2 n u n k 1 u n k 2 equation 4 can be defined as the quadratic volterra model as in references he et al 2013 luigi and ahsan 2010 yi et al 2012 where c 0 1 and c 0 2 present the first and second order volterra kernel coefficients respectively for identification of ltv and nltv systems eq 4 is converted into matrix form as given by eq 5 image 2 leveraging the benefit of symmetrical property of nonlinear responses in the rhs of eq 5 only the upper triangular part is employed for identification thus eq 5 is significantly reduced into eq 6 as can be seen the first column in the rhs of the eq 6 presents regressor vectors and the second column is kernel coefficients linear part comprises u n u n 1 u n k 1 for the first system input with c 0 1 0 n c 0 1 1 n c 0 1 k 1 n as corresponding linear kernel coefficients nonlinear part comprises u 2 n u n u n 1 u n u n k 1 u 2 n k 1 for the second system input with c 0 2 0 0 n c 0 2 0 1 n c 0 2 0 k 1 n c 0 2 k 1 k 1 n as corresponding quadratic kernel coefficients image 3 therefore the total kernel coefficient to be estimated can be calculated using eq 7 by excluding the zero kernel coefficient in the model 7 l q k q k 1 considering eqs 6 7 the total linear kernel coefficient is to be k and the total quadratic kernel coefficient is equal to l k equation 6 could simply be written into eq 8 8 y ˆ n φ n t θ n the above equation relates the regressor vector φ n linearly with the system parameter θ n by asumming θ n has a stochastic process and then it can be estimated recursively using random walk model which has a normal distribution it is expanded as the following tarvainen et al 2004 khan and dutt 2007 9 θ n a θ n 1 w n accordingly eq 8 can also be expanded into eq 10 10 y ˆ n φ n t θ n 1 v n equations 9 and 10 are named as state and measurement equations respectively and known as a discrete state space model state equation contains terms as follows a denotes a state transition matrix which connects the state vector θ n at time index n 1 to n w n and v n represent state noise and measurement variances respectively both have a zero mean gaussian random distribution v n 0 r and w n 0 q and are independent of each other lastly the time domain volterra model can be represented into the state space model as given by fig 1 2 2 kalman smoother method in order to proceed eqs 9 and 10 kalman smoother method is proposed this method combines kalman filter and smoothing equations to achieve an accurate estimation details are in the next section 2 2 1 kalman filter method kalman filter yazidet al 2015 estimates the system output y ˆ n in eq 10 and adjusts it into actual system output y n through updating state vector θ n in eq 9 in the process of updating kalman filter works on two phases first phase is time update as a predictor and second phase is measurement update as a corrector in time update phase θ n values and state covariance matrix p n are projected in forward step from time index n 1 to n and expressed in eqs 11 and 12 tarvainen et al 2004 khan and dutt 2007 11 θ n n 1 a θ n 1 n 1 12 p n n 1 a p n 1 n 1 a t q considering p n in eq 12 a very instrumental parameter the so called kalman gain k n are presented and computed in eq 13 13 k n p n n 1 φ n t φ n p n n 1 φ n t r 1 by using k n in eq 13 values of θ n in eq 11 and p n in eq 12 are then corrected using following equations 14 θ n n θ n n 1 k n y n φ n t θ n n 1 15 p n n i k n φ n t p n n 1 updating values of eqs 14 and 15 is performed in measurement update phase in particular term y n φ n t θ n n 1 in eq 14 is called residual as seen from eqs 13 15 values of kalman gain k n state vector θ n n covariance matrix p n n are function of time due to regressor vector φ n in eq 6 is time dependent this suggests that the designed kalman filter requires more computational time than the traditional kalman filter 2 2 2 smoothing equations for kalman filter since estimation of state vector θ n n and state covariance matrix p n n in eqs 11 15 works on forward projection within time index n 1 n then it will result in variance and delayed response state estimates smoothing equations are introduced to decrease the state estimates variance while at the same time to reduce the delay in its mechanism it works on backward projection where the process is propagated from n n 1 to n 1 to do so smoothing matrix must be built the equation is adopted from tarvainen et al 2004 khan and dutt 2007 and expressed in eq 16 below 16 j n p n n a t p n 1 n 1 once the matrix is computed θ n n and p n n can be smoothed as follows 17 θ n n θ n n j n θ n 1 n θ n 1 n 18 p n n p n n j n θ n 1 n θ n 1 n j n t however it should be pointed out that smoothing equations are an option in common practice if off line estimation is chosen then it can be employed vice versa if estimation process is performed online then it is unable to be implemented due to kalman filter only provides estimates after the completion of measurement process 3 parameters optimization process in cs ks method in this section optimization process of cs ks method is formulated it is started by grouping the ks parameters into s θ 0 p 0 a q r and tuned heuristically in general block diagram and details of its mechanism are schematically illustrated in figs 2 3 respectively 3 1 initialization phase values of s θ 0 p 0 a q r are randomly initialized to produce cuckoos using eq 19 19 s i j s j min λ s j max s j min i 1 s c s j 1 l c s the above equation contains several variables such as term s i j presents jth cuckoo of ith nest s j min denotes lower bound and s j max is upper bound of jth cuckoo both values are weighted by a random number λ where the value is in the range 0 1 next s c s and l c s indicate the number of nests and ks parameters respectively cost functions of si j are then evaluated using eq 20 20 c f n 1 n y n y ˆ n 2 3 2 updating phase in this phase considering the cost function in eq 20 initial values in phase 1 are then updated using eq 21 lian et al 2017 21 s i t 1 s i t α c s δ c s l e v y λ 1 δ c s r 1 p c s i t s i t r 2 p c s g t s i t equation 21 shows that the next ks parameters depends on the current parameters and the transition probability via l e v y flight which speeds up the local search optimization term l e v y λ 1 λ 3 is a random walk function which has a l e v y distribution it becomes a very instrumental function in the cs algorithm where the task is to control the distance between the best nest of local p c s i t and the best nest of global p c s g t with respect to its current nest two uniform random numbers r 1 and l e v y λ are imposed index in the range 0 1 the l e v y λ is weighted by δ c s which is also chosen in the same range term α c s is a constant which is related to the step size and the value is 1 operator triangular conorm t conorm is introduced as the product entry wise multiplications for eq 21 once the ith cuckoo ks parameters is updated its cost function is reevaluated using eq 20 3 3 stopping phase updating process in phase 2 continuous until the optimum value is found in a number of iterations therefore eq 21 reflects that cs algorithm has a straight forward optimization mechanism due to it employs only one updating mechanism overall step by step of identification methodology based on figs 2 and 3 can be structured as the following 1 preparation of system input output time series u y for identification dataset it is very worthy to note that in order to eliminate the noise and the trend inherited in both measured time series pretreatment processes in terms of denoising and detrending can be carried out other pretreatment processes such as filling up the missing data in the time series because of measurement error and resampling the data frequency to enhance the visibility of frequency of interest can be also performed accordingly however it depends on the case at hand and such processes will not eliminate the wave and low frequencies embedded in the measured surge motion 2 definition of a the order of volterra model q and maximum lag k b the number of nests cuckoos and other respective parameters of cs algorithm 3 generation of regressor vectors based on eq 6 4 estimation of kernel coefficients θ using eqs 9 18 where terms of u y q k and s are fed into ks algorithm residual of estimation process is metered as a cost function 5 minimization of residual in step 4 by updating the parameters s in eq 19 using cs algorithm 6 iteration of step 4 and 5 until the predefined stopping criterion is fulfilled fig 3 depicts the process to obtain the coefficients c 0 1 and c 0 2 from those estimated coefficients irfs linear and nonlinear responses and other dynamic characteristics can be obtained accordingly 4 impulse response functions explicitly eq 4 recalls two remarks remark 1 if the linear kernel coefficients c 0 1 and quadratic kernel coefficients c 0 2 are convoluted with impulse function then the linear impulse response function lirf and quadratic impulse response function qirf can be obtained and presented as follows a lirf can be coded in matlab format and written in eq 22 below for n 1 n 22 h l n n c o n v c 0 1 k 1 n δ n end term δ n is an impulse function which is defined as follows 23 δ n 0 n 1 1 n 1 b qirf can be also coded in matlab format and written in eq 2 below for n 1 n 24 h n l n n n c o n v 2 c 0 2 k 1 k 2 n δ n δ t n end equations 22 24 show that the identified irfs are time variant so that the evolution of the gain with respect to time can be produced at this stage dynamic characteristics of respective structures in terms of modal parameters can be computed using logarithmic decrement method and dynamic response prediction with any arbitrary system inputs remark 2 if the extracted linear and quadratic dynamic responses y 1 ˆ and y 2 ˆ are employed then modal analysis can also be computed by modeling both responses through tvar model by replacing the system input u n k 1 in the rhs of eq 2 with lagged y 1 ˆ or y 2 ˆ respectively as derived below 25 y 1 ˆ n k 1 1 k c 1 0 k 1 n y 1 ˆ n k 1 similar with volterra kernel coefficients tvar coefficients c 1 0 1 n c 1 0 2 n c 1 0 k n can also be estimated with cs ks method and the transfer function of the equation in z transform can be expressed in eq 26 26 h z n 1 1 k 1 1 k c 1 0 k 1 n z k 1 denominator of eq 26 is known as a system characteristic equation by factoring the denominator of the equation the poles can be obtained and written in eq 27 27 h z n 1 z p 1 n z p 2 n z p k n number of poles in eq 27 is dependent upon the order of tvar model used when they are mapped in the complex plane position of the poles yields important dynamic characteristic in the form of modal property as derived by poulimenos and fassois 2006 modal property in terms of damping ratio ζ and frequency f is associated with amplitude and phase of the poles respectively they are given by eqs 28 and 29 below 28 f i n ln p i n f s 2 π 29 ζ i n cos arg ln p i n it should be noted that term p i presents the ith poles in discrete time index while term f s denotes the sampling frequency since the coefficients of tvar model are time variant then the modal frequency in eq 28 and the damping ratio in eq 29 are also time variant accordingly 5 experimental setup and identification methodology for rationalization of proposed identification method experiment had been setup and detailed in ng 2014 however it is briefly summarized here for a coincise information a classic spar platform was taken as a test model which has diameter of 0 3 m hull length of 0 899 m draft of 0 699 m and displayed in fig 4 a it was designed with length scale ratio of 1 100 and manufactured from steel plate scaling factor is chosen based on froude s law of similitude so as to fit the spar platform in the wave tank platform was moored by using steel wires with linear springs stiffness is 29 5 n m and arranged as pointed out in fig 4 b mooring lines tension in the fairlead was measured using load cells which were mounted between the spring and platform small pieces of foam were attached along the mooring lines to create buoyancy for the springs and load cells a restraining system in the form of pulley system was installed to avoid slacking of the steel wires and clamped in order such that they were pre tensioned during the test sea keeping tests were carried out in the wave tank of the offshore engineering laboratory located at universiti teknologi petronas with total length of 22 m width of 10 m and water depth of 1 5 m wave energy absorbing beach system embedded in the wave tank has the function to minimize the interference from wave reflection during the tests sea states of h s 4 m with a peak frequency f p of 0 061 hz in full scale rough sea was imposed to the platform in the direction of head seas the wave was a unidirectional long crested random wave which was generated from jonswap type spectrum and made through the board of wavemaker two kinds of measurement systems were commissioned for the wave height and platform motions for wave height measurement four wave gauges were used in which two sensors were mounted in front of the platform while the others were mounted at the rear of the platform for platform motions measurement optical tracking system was used identification methodology is completely illustrated in fig 5 where it can be observed that measured wave height and surge motion time series are employed as system input output dataset it is worthy to note that effects of wave reflection from the wall of wave tank were not accounted in identification process based on the dataset identification of irfs is performed according to figs 3 and 5 6 results and discussions 6 1 numerical data in this section numerical simulation is carried out to produce a numerical system input output data by using the data the efficacy of proposed method to identify the irfs the linear and nonlinear responses is demonstrated a simple and soft nonlinear oscillator model is chosen in order such that the nonlinearity in terms of a quadratic damping can be numerically produced the system is given by fig 6 where dynamical model of the system is derived in eq 30 below 30 m s y s t c s 1 y s t c s 2 y s t y s t k s y s t f e t physical parameters of the system are defined as the following oscillator mass m s of 68 kg linear and quadratic damping coefficients c s 1 c s 2 of 5 kg s and 5 kg m respectively and linear spring constant k s of 10 n m those values are selected in order such that it can produce 0 061 hz linear natural frequency and 9 6 linear damping ratio oscillator is excited with a system input f e t which has a normal distribution in the frequency range of 0 0 5 hz by using fourth order runge kutta method eq 30 is numerically solved its displacement velocity and acceleration y s y s and y s are obtained respectively simulation time period of 3000 s is set and time step used is 1 s in simulation initial condition of position and velocity y s 0 and y s 0 are valued to be zero so as to ensure that the zeroth order kernel c 0 0 is zero accordingly thus irfs are identified using the proposed method for this case volterra model order is determined by using final prediction error fpe method the results are maximum lag k of 128 and nonlinearity degree q of 2 by using the optimum model order kernel coefficients are estimated using eqs 9 18 and converted into irfs using eqs 22 24 the identified irfs are depicted in figs 7 8 there are seven impulses observed from fig 7 until it decays into zero this condition forces the volterra model with cs ks method to have long model order in order to capture the dynamics of oscillator fig 7 also indicates that the identified lirf from cs ks based volterra model fits well with the actual lirf where the fit value is 92 84 also the linear natural frequency and damping ratio are similar with the theoretical values under logarithmic decrement method parsimonious model order can be achieved by adopting some methods such as prazenica 2002 however it is beyond the scope of this paper as a benchmark higher order spectral analysis hosa based volterra model is used it is seen that the identified lirf from the benchmark is comparable with the actual in the fit value of 88 15 lower than the proposed method furthermore the quadratic impulse response function qirf is shown in fig 8 where the time history of impulses is successfully characterized again the identified qirf from volterra model is in good agreement with the actual qirf it is clear from numerical results in figs 7 8 that the proposed identification method is capable of producing the irfs with high accuracy moreover both linear and nonlinear dynamic responses are recovered by convoluting the respective identified irfs with the system input as displayed by fig 9 as can be observed from fig 9 the identified linear and nonlinear dynamic responses obtained from proposed identification method and the benchmark agree well with actual responses for proposed method the fit value is 99 33 for linear response and 97 76 for nonlinear response in the other side responses obtained from the benchmark are 98 28 for linear response and 89 67 for nonlinear response in addition fig 9 also gives a clear indication of the strength of linear response in the dynamics of oscillator likewise the nonlinear response is found to be predominantly weaker than the linear response this is to be expected since the oscillator model chosen has low nonlinearity with a quadratic damping therefore if both dynamic responses are summed then it fits well with the actual dynamic response it is worthy to note if the nonlinearity comes from quadratic stiffness than the identification procedure is similarly applied lastly numerical data clearly represents the practical benefits of the proposed identification method over the hosa based volterra model thus it is reliable to be applied to the real system in the next section 6 2 experimental data 6 2 1 system input output and free decay test data once the proposed method is verified through numerical data then it is applied to the experimental data for system input output dataset the measured wave height and surge motion time series are taken and given by fig 10 after they have been converted into full scale data as can be observed from fig 10 a it is apparent that the amplitudes of wave and its probability density function pdf have less symmetrical distribution the observation can be interpreted that the wave height has non gaussian property and is linear random waves statistical analysis reveals that the mean of wave height is 0 083 m 1 117 m2 variance 0 104 m3 skewness and 3 12 m4 kurtosis likewise distribution of the surge motion amplitudes and its pdf is clearly unsymmetrical due to the amplitudes are shifted upward as shown in fig 10 b it gives a clear indication that the surge motion also has non gaussian property and is verified as nonlinear random waves statistical analysis also reveals that the surge motion has 0 01 m mean 0 506 m2 variance 0 44 m3 skewness and 3 45 m4 kurtosis to verify their data properties statistically both measured time series are then analyzed using matlab statistics toolbox via augmented dickey fuller test kwiatkowski phillips schmidt shin test and phillips perron test the wave height is found to be a stationary and non white noise time series as validated by using ljung box q statistic in similar fashion the surge motion clearly appears to be a non white noise and non stationary time series which suggests that the proposed identification method is relevant as additional statistical tests normality test using jarque bera test lillie test and kolmogorov smirnov test also accentuate the non gaussianity of the system input output before identification of irfs is performed fourier transform based spectral analysis is employed to the dataset this is to ensure that the nonlinearity exists in model tests of the spar platform results in fig 11 a reveal that the spectrum contains one principal frequency peak which is identical with the frequency of incident random wave it is then compared with the target wave spectrum produced by a jonswap type spectrum with 3 3 peakness factor spanos et al 2005 for a validation spectrum of each method is found in a good agreement with minor difference in magnitudes likewise two principal frequency peaks are revealed in spectra of fig 11 b the first frequency peak is found to be 0 005 hz while the second one is found to be 0 061 hz the former is identified as a low frequency response lfr while the latter is again identical with the frequency of incident random wave and is identified as a wave frequency response wfr overall spectral analysis in fig 11 reveals that the existence of lfr in the surge motion spectra gives a clear indication of nonlinear behaviour of a floating structure there is a wave energy transfer exerted by surge motion of spar platform in terms of high to low frequencies these phenomena are consistent with prior researchers i e spanos et al 2005 montasir and kurian 2011 details are discussed in the next subsection however these findings also confirm the reason why the surge motion is chosen as a system output in the identification process instead of other motions of spar platform in addition to experimental results of spar platform free decay test was carried out an initial displacement was given to the spar platform in the still water and its motions were measured the time series is displayed in fig 12 considering the figure modal parameters of the platform can be calculated using logarithmic decrement method calculation shows that the spar has 0 005 hz modal frequency and 11 3 damping ratio in particular the identified modal frequency is considered as a resonant frequency during the experiment these results also validate the spectra in fig 11 b and are taken as a baseline for identification of irfs in the next subsection 6 2 2 impulse response function results considering the fpe method used for numerical data optimum volterra model order for experimental data is also computed in similar fashion by limiting the nonlinearity degree of q to be 2 system input lag k is varied in order such that fpe value is minimized variation of lag to the fpe value is given in fig 13 and seen that the model order as a function of k based on the figure lag k of 13 is seen to have the lowest fpe value and considered as the optimum model order for experimental data the irfs of spar platform are then identified and the results are elaborated in figs 14 15 fig 14 a 14 b display the identified lirfs in the form of gain time time representation as can be seen variations of gain over time can be clearly observed characteristics of gain of lirfs are found to be time variant where a number of impulses may be apparently detected furthermore five impulses are identified before it decays into zero thus it is concluded that time history of the lirfs with different gain magnitudes has been successfully characterized within sampling time the time varying lirf is a consequent of the nonstationarity in the measured surge motion time series which also validates the statistical results in previous section again for a benchmark hosa based volterra model is used and given in fig 14 b as can be seen the identified lirf is comparable with result of cs ks based volterra model however the proposed identification method produces high resolution estimates where the impulses can be well identified in gain time time space the advantages of parametric volterra model are due to time variant kernel coefficients which are solved by using cs ks method making them well suited to time time representation if maximum gain of each time varying lirf in fig 14 a 14 b is selected within sampling time then the lirfs can be displayed in fig 14 c the results of both methods are reasonably overlapped and seen that the lirf decays around 70 s considering fig 14 c modal parameters in terms of modal frequency and damping ratio of spar platform are computed using logarithmic decrement method modal frequency is found to be around 0 062 hz which envisages that the identified lirf as a system dynamics property is a function of incident random wave frequencies this is a typical dynamics characteristic found in the lirf which is inherited by floating systems damping ratio is found to be 13 4 showing that the damping ratio in the wfr region is higher than that of free decay test where the ratio is 1 18 for this particular case for identified qirf the original is in gain time time time scale unfortunately displaying such graphs creates difficulties for visibility and interpretation purposes thus representation in gain time time in terms of two dimensional scale is chosen for the sake of clarity since experiment time period is set to be 3600 s only qirf with maximum gain are chosen and given by fig 15 it is seen that the qirf decays around 800 s much slower than the lirf number of impulses in the qirf may be clearly detected from fig 15 a 15 b those figures consistently show that the qirf obtained from the proposed method produces higher time resolution than that of hosa based volterra model furthermore number of impulses is reflected in the fig 15 c where six impulses are found before it decays into zero by using logarithmic decrement method it is found that the platform has 0 005 hz modal frequency and 4 1 damping ratio the frequency seems consistent with free decay test in fig 12 and corresponds to the first frequency of spectra in fig 11 b the calculated damping ratio is lower than that of free decay test its ratio is 2 14 for this particular case in general this result indicates that the nonlinear behaviour of the floating spar platform can be well modeled through qirf if the identified lirf and qirf are convoluted with the wave height in fig 10 a then both linear and nonlinear dynamic responses are recovered and displayed in the left panel of fig 16 the frequency content of both responses is obtained from fourier transform and shown in the right panel it can be observed from fig 16 a that the total response in time domain obtained from proposed method fits well with the measured data with the fit value of 95 35 while the benchmark has only fit value of 84 32 in frequency domain fit values are 93 58 and 82 91 respectively the accuracy of the proposed method is further justified by the responses in frequency domain in the linear response wfr both methods seem competitive with respect to the measured spectra this is to be expected since linear behaviour is relatively easy to be captured and modeled the shape of spectrum almost overlaps each other however this is not true for nonlinear response lfr the proposed method can produce better shape spectrum then the benchmark in addition fig 16 accentuates the results in figs 14 15 suggesting that both dynamic responses of spar platform are to be able to be well extracted since the hosa based volterra model is still based on fourier transform there is always a tradeoff between time and frequency resolutions in particular for low frequency this is also worsened by the fact that the benchmark is sensitive to the gaussianity and non gaussianity of sea waves the inappropriate higher order cross spectral estimates may lead to local bias spectral leakage and erroneous volterra model the cs ks based volterra model appears to be more general and versatile for solving such problems it just requires the optimum model order by following identification procedure in section 2 4 those facts highlight the advantage of the proposed method over the benchmark in addition by using results from the proposed method estimation of modal analysis using tvar model through eqs 25 and 26 can be performed effectively with model order of 2 tvar coefficients of each response can be estimated using eq 27 the roots of each model coefficient are poles obtained from eqs 28 and 29 consequently modal frequency and damping ratio over time can be estimated and depicted in fig 17 for clarity by using results in figs 14 16 the identified values are summarized in table 1 it is seen that there is insignificant different between the frequencies in table 1 with the random wave parameter and free decay test result overall results suggest that the dynamics of the spar platform can be well captured and modeled by the identified irfs 7 conclusions and recommendations the concept of a time varying volterra model to produce the linear and nonlinear irfs from model test data has been presented cuckoo search based kalman smoother cs ks method and a time domain parametric volterra model are proposed numerical simulations supported with experimental results to the spar platform have clearly showed the benefits of the proposed identification method important conclusions and recommendations from the overall results can be drawn as follows by employing the proposed time varying regressor vectors for the time domain parametric volterra model time varying linear and nonlinear irfs can be well produced in the high time resolution from the model test data where nonlinearity and nonstationarity of the underlying system can be captured simultaneously the linear irfs are found to be a function of frequencies of incident random waves while the nonlinear irfs are found to be around the resonant frequency of spar platform the latter can be well modeled by the nonlinear irf under time domain quadratic volterra model extraction of the linear and nonlinear dynamic responses from the spar platform is effectively carried out by means of the convoluted irfs estimated irfs allow the extraction of modal parameters in terms of natural frequency and damping ratio to be much easier performed the modal parameters can be calculated from the estimated irfs under logarithmic decrement method also from the extracted dynamic responses the modal parameters can be calculated under the tvar model tradeoff between time and frequency resolutions can be eliminated for cs ks based volterra model in obtaining high quality identification results in particular for lfr it just requires the optimum model order also the proposed method can be generally used either for gaussian or non gaussian sea waves without leading to erroneous volterra models local bias and spectral leakage incorporation of the extracted modal parameters into the equations of motion of spar platform is recommended as a future work so that the dynamic responses of the platform can be predicted numerically it is envisaged that in the future proposed identification method can be implemented to other moored or tethered floating structures as well as other engineering systems credit authorship contribution statement edwar yazid conceptualization writing original draft methodology investigation writing review editing coding cheng yee ng experiment validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank indonesian institute of sciences and universiti teknologi petronas for providing research facility and financial support so that the research collaboration can be performed nomenclature a state transition matrix α c s constant o step size c 0 q volterra kernel coefficients c s damping coefficient c f cost function δ impulse function δ c s weight index δ t s time step f s sampling frequency f frequency f e excitation force h l lirf h n l qirf h transfer function j smoothing matrix k maximum lag k g kalman gain k s stiffness coefficient l v total kernel coefficient l c s number of nest m s mass n the largest discrete time index n discrete time index p state covariance matrix p c s best nest p poles φ regressor vector q the order of system input q state noise variance r c s 1 2 uniform random numbers r measurement noise variance s kalman smoother parameters t s time sampling θ state variable u actual system input y actual system response y ˆ predicted system response y ˆ 1 predicted linear response y ˆ 2 predicted nonlinear response y s displacement y s velocity y s acceleration ζ damping ratio 
21283,identification of the time varying linear and nonlinear impulse response functions lirf and qirf of moored or tethering floating structures is deemed a very challenging work because of nonlinearity and nonstationarity this paper proposes an identification method namely a time domain parametric volterra model based on cuckoo search optimized kalman smoother cs ks to identify the lirf and qirf of 1 100 scale model test of spar platform a conventional frequency domain volterra model is used as a benchmark given the numerical and model test data in terms of measured wave height and surge motion of the platform the proposed identification method can produce high time resolution of the time varying lirf and qirf the linear and nonlinear responses as well as natural frequency and damping ratio can be accurately extracted through numerical simulation supported by experimental results this paper also highlights the practical benefits of the proposed identification method to estimate the time varying kernel coefficients graphical abstract image 1 keywords spar platform impulse response functions volterra model cs ks 1 introduction impulse response function irf is known as a characterization of system dynamics in time domain in generating the irf there are two common approaches used namely numerical and empirical models the former requires first principle and involves rigorous mathematical formulations for complex systems such an approach is considered less practical so as to achieve the fast calculation consequently the physical modeling must be imposed with simplifications the latter requires system input output dataset and involves system identification methods this might be considered as an alternative instead of the first principle modeling the dynamic behaviour of the system using system identification in the form of irf has become a very active research several methods have been proposed such as jones 1986 ahn et al 2005 jones 1986 delivered a basic method for identification of irf of a damped sdof system herlufsen and gade 1992 discussed the errors in calculating the irf from the frf when dft fft analysis technique was used keqin 1993 then also confirmed the inaccuracy of the irf when the fourier transform of the frf was inversed tzes and le 1996 expanded the concept of irf for flexible structures and recommended the use of adaptive infinite irf they demonstrated the feasibility of obtaining the irf by manipulating the imaginary part of the frf in terms of energy concentration property therefore direct identification of irf in time domain had been performed by prazenica 2002 wavelet basis function to represent the volterra kernel coefficients for nonlinear time invariant nti systems was proposed the results were low order estimates of first and second order kernel coefficients using similar basis functions schukin et al 2004 performed optimization to generate the irf with application to an sdof system in addition sun and chen 2002 proposed a new infinite irf based on adaptive algorithm to be applied for an active noise control the coefficients were estimated using the filtered u type least mean square benefits of inherent zero pole structure in obtaining the infinite irf were demonstrated ahn et al 2005 studied the effect of finite record length to the spectrum of irf and the form of spectrum was significantly affected by the record length moreover application of the irf to the engineering field can be referred to kurka and cowley 1988 benedetti et al 2011 samples are as follows modal analysis based on irf had been performed by kurka and cowley 1988 hu et al 2011 li et al 2012 vibration testing based on the irf had been conducted by hosoya et al 2012 and kajiwara et al tiwari and chakravarthy 2006 fault diagnosis based on the irf had been performed by tiwari and chakravarthy junsheng et al 2007 junsheng et al kajiwara and hosoya 2011 cui et al 2016 and ou et al 2016 non causality of two impulse responses had been studied by falnes 1995 where the effect of incident wave elevation on an immersed body was highlighted identification of irf generated by contact force in the nanon s using two input filter technique had been performed by benedetti et al 2011 in the context of moored and tethered floating structures subjected to random waves in the open sea there are linear and nonlinear interactions between the waves and the structure spanos et al 2005 naess et al 2007 montasir and kurian 2011 the common parametric approach namely nonlinear auto regressive moving average model with exogenous input narmax model can be generally employed to identify such phenomena the concept has been mature and well documented however when the system has nonstationary behaviour instead of stationary then narmax model will not work well for such systems consequently the identification of irfs becomes a challenging task thus main contributions of this paper addressing current research challenges can be listed as follows 1 this paper proposes a time varying parametric volterra model to extend the concept of linear and nonlinear time invariant lti and nti models into linear and nonlinear time variant ltv and ntv models time varying regressor vectors are introduced to capture the nonlinearity and nonstationarity of the underlying systems simultaneously higher order spectra analysis based volterra model as a nonparametric approach is taken as a benchmark 2 this paper highlights the estimation method of time varying kernel coefficients using cuckoo search based kalman smoother cs ks method to achieve an accurate estimation 3 this paper demonstrates the practical benefits of proposed identification method to produce the time varying linear and nonlinear irfs in the high time resolution from 1 100 scale model test of spar platform extraction of linear and nonlinear dynamic responses from the platform is also carried out by means of the convoluted irfs 4 this paper also presents the extraction of modal parameters in terms of natural frequency and damping ratio the modal parameters can be calculated from the estimated irfs under logarithmic decrement method also from the extracted dynamic responses the modal parameters can be calculated under the tvar model this paper is proceeded as follows section 2 depicts the step by step of generating state space model from the time domain parametric volterra model converting and representing the kernel coefficients into adaptive filters and presenting the cs ks method as a proposed estimation method optimization process of ks parameters using cuckoo search algorithm is put on section 3 section 4 derives the calculation of irfs and modal analysis while section 5 depicts the experimental setup of model test furthermore section 6 presents and discusses the identification results in terms of estimated irfs and modal parameters lastly section 7 concludes this paper and provides recommendations 2 conversion of time domain volterra model into state space model 2 1 representation of first and second order volterra kernel coefficients in adaptive filters for a single input single output siso system in discrete time index of n t s δ t s where δ t s denotes the time step and n t s δ t s indicates the largest discrete time index under the observed time interval t 0 t s nonlinear relation of a system input u n to a system output y n can be written in a general volterra model and given by eq 1 he et al 2013 1 y q ˆ n k 1 k q 1 k c 0 q k 1 k q n i 1 q u n k i as can be seen eq 1 contains two important quantities c 0 q k 1 k q n and u n k i the former is called volterra kernel coefficient and the latter is called lagged system input by having the order of system input of q and maximum lag of k kernel coefficient can be expressed into k 1 k q 1 k c 0 q k 1 k q n where notation k 1 k q 1 k is k 1 1 k k q 1 k the lagged system input can be written in the form of i 1 q u n k i where i 1 q is ith order lag product operator and k i 1 k consequently index of n in the volterra kernel coefficients reflects that eq 1 is suitable for modeling the time variant tv system dynamics however when the system is time invariant tiv index of n can be omitted furthermore eq 1 calls three remarks remark 1 if the lag of system input is set to be q 1 then eq 1 is simplified into the first order response linear response as given by eq 2 2 y 1 ˆ n k 1 1 k c 0 1 k 1 n u n k 1 remark 2 if the lag of system input is set to be q 2 then eq 1 is simplified into second order response nonlinear response as given by eq 3 3 y ˆ 2 n k 1 k 2 1 k c 0 2 k 1 k 2 n u n k 1 u n k 2 remark 3 if the lag of system input is set to be q 3 then eq 1 can be expanded into higher order nonlinear dynamic response accordingly since most moored and tethered floating systems can be modeled up to second order spanos et al 2005 montasir and kurian 2011 then first and second order dynamic responses in eqs 2 3 can be summed as follows 4 y ˆ n k 1 1 k c 0 1 k 1 n u n k 1 k 1 k 2 1 k c 0 2 k 1 k 2 n u n k 1 u n k 2 equation 4 can be defined as the quadratic volterra model as in references he et al 2013 luigi and ahsan 2010 yi et al 2012 where c 0 1 and c 0 2 present the first and second order volterra kernel coefficients respectively for identification of ltv and nltv systems eq 4 is converted into matrix form as given by eq 5 image 2 leveraging the benefit of symmetrical property of nonlinear responses in the rhs of eq 5 only the upper triangular part is employed for identification thus eq 5 is significantly reduced into eq 6 as can be seen the first column in the rhs of the eq 6 presents regressor vectors and the second column is kernel coefficients linear part comprises u n u n 1 u n k 1 for the first system input with c 0 1 0 n c 0 1 1 n c 0 1 k 1 n as corresponding linear kernel coefficients nonlinear part comprises u 2 n u n u n 1 u n u n k 1 u 2 n k 1 for the second system input with c 0 2 0 0 n c 0 2 0 1 n c 0 2 0 k 1 n c 0 2 k 1 k 1 n as corresponding quadratic kernel coefficients image 3 therefore the total kernel coefficient to be estimated can be calculated using eq 7 by excluding the zero kernel coefficient in the model 7 l q k q k 1 considering eqs 6 7 the total linear kernel coefficient is to be k and the total quadratic kernel coefficient is equal to l k equation 6 could simply be written into eq 8 8 y ˆ n φ n t θ n the above equation relates the regressor vector φ n linearly with the system parameter θ n by asumming θ n has a stochastic process and then it can be estimated recursively using random walk model which has a normal distribution it is expanded as the following tarvainen et al 2004 khan and dutt 2007 9 θ n a θ n 1 w n accordingly eq 8 can also be expanded into eq 10 10 y ˆ n φ n t θ n 1 v n equations 9 and 10 are named as state and measurement equations respectively and known as a discrete state space model state equation contains terms as follows a denotes a state transition matrix which connects the state vector θ n at time index n 1 to n w n and v n represent state noise and measurement variances respectively both have a zero mean gaussian random distribution v n 0 r and w n 0 q and are independent of each other lastly the time domain volterra model can be represented into the state space model as given by fig 1 2 2 kalman smoother method in order to proceed eqs 9 and 10 kalman smoother method is proposed this method combines kalman filter and smoothing equations to achieve an accurate estimation details are in the next section 2 2 1 kalman filter method kalman filter yazidet al 2015 estimates the system output y ˆ n in eq 10 and adjusts it into actual system output y n through updating state vector θ n in eq 9 in the process of updating kalman filter works on two phases first phase is time update as a predictor and second phase is measurement update as a corrector in time update phase θ n values and state covariance matrix p n are projected in forward step from time index n 1 to n and expressed in eqs 11 and 12 tarvainen et al 2004 khan and dutt 2007 11 θ n n 1 a θ n 1 n 1 12 p n n 1 a p n 1 n 1 a t q considering p n in eq 12 a very instrumental parameter the so called kalman gain k n are presented and computed in eq 13 13 k n p n n 1 φ n t φ n p n n 1 φ n t r 1 by using k n in eq 13 values of θ n in eq 11 and p n in eq 12 are then corrected using following equations 14 θ n n θ n n 1 k n y n φ n t θ n n 1 15 p n n i k n φ n t p n n 1 updating values of eqs 14 and 15 is performed in measurement update phase in particular term y n φ n t θ n n 1 in eq 14 is called residual as seen from eqs 13 15 values of kalman gain k n state vector θ n n covariance matrix p n n are function of time due to regressor vector φ n in eq 6 is time dependent this suggests that the designed kalman filter requires more computational time than the traditional kalman filter 2 2 2 smoothing equations for kalman filter since estimation of state vector θ n n and state covariance matrix p n n in eqs 11 15 works on forward projection within time index n 1 n then it will result in variance and delayed response state estimates smoothing equations are introduced to decrease the state estimates variance while at the same time to reduce the delay in its mechanism it works on backward projection where the process is propagated from n n 1 to n 1 to do so smoothing matrix must be built the equation is adopted from tarvainen et al 2004 khan and dutt 2007 and expressed in eq 16 below 16 j n p n n a t p n 1 n 1 once the matrix is computed θ n n and p n n can be smoothed as follows 17 θ n n θ n n j n θ n 1 n θ n 1 n 18 p n n p n n j n θ n 1 n θ n 1 n j n t however it should be pointed out that smoothing equations are an option in common practice if off line estimation is chosen then it can be employed vice versa if estimation process is performed online then it is unable to be implemented due to kalman filter only provides estimates after the completion of measurement process 3 parameters optimization process in cs ks method in this section optimization process of cs ks method is formulated it is started by grouping the ks parameters into s θ 0 p 0 a q r and tuned heuristically in general block diagram and details of its mechanism are schematically illustrated in figs 2 3 respectively 3 1 initialization phase values of s θ 0 p 0 a q r are randomly initialized to produce cuckoos using eq 19 19 s i j s j min λ s j max s j min i 1 s c s j 1 l c s the above equation contains several variables such as term s i j presents jth cuckoo of ith nest s j min denotes lower bound and s j max is upper bound of jth cuckoo both values are weighted by a random number λ where the value is in the range 0 1 next s c s and l c s indicate the number of nests and ks parameters respectively cost functions of si j are then evaluated using eq 20 20 c f n 1 n y n y ˆ n 2 3 2 updating phase in this phase considering the cost function in eq 20 initial values in phase 1 are then updated using eq 21 lian et al 2017 21 s i t 1 s i t α c s δ c s l e v y λ 1 δ c s r 1 p c s i t s i t r 2 p c s g t s i t equation 21 shows that the next ks parameters depends on the current parameters and the transition probability via l e v y flight which speeds up the local search optimization term l e v y λ 1 λ 3 is a random walk function which has a l e v y distribution it becomes a very instrumental function in the cs algorithm where the task is to control the distance between the best nest of local p c s i t and the best nest of global p c s g t with respect to its current nest two uniform random numbers r 1 and l e v y λ are imposed index in the range 0 1 the l e v y λ is weighted by δ c s which is also chosen in the same range term α c s is a constant which is related to the step size and the value is 1 operator triangular conorm t conorm is introduced as the product entry wise multiplications for eq 21 once the ith cuckoo ks parameters is updated its cost function is reevaluated using eq 20 3 3 stopping phase updating process in phase 2 continuous until the optimum value is found in a number of iterations therefore eq 21 reflects that cs algorithm has a straight forward optimization mechanism due to it employs only one updating mechanism overall step by step of identification methodology based on figs 2 and 3 can be structured as the following 1 preparation of system input output time series u y for identification dataset it is very worthy to note that in order to eliminate the noise and the trend inherited in both measured time series pretreatment processes in terms of denoising and detrending can be carried out other pretreatment processes such as filling up the missing data in the time series because of measurement error and resampling the data frequency to enhance the visibility of frequency of interest can be also performed accordingly however it depends on the case at hand and such processes will not eliminate the wave and low frequencies embedded in the measured surge motion 2 definition of a the order of volterra model q and maximum lag k b the number of nests cuckoos and other respective parameters of cs algorithm 3 generation of regressor vectors based on eq 6 4 estimation of kernel coefficients θ using eqs 9 18 where terms of u y q k and s are fed into ks algorithm residual of estimation process is metered as a cost function 5 minimization of residual in step 4 by updating the parameters s in eq 19 using cs algorithm 6 iteration of step 4 and 5 until the predefined stopping criterion is fulfilled fig 3 depicts the process to obtain the coefficients c 0 1 and c 0 2 from those estimated coefficients irfs linear and nonlinear responses and other dynamic characteristics can be obtained accordingly 4 impulse response functions explicitly eq 4 recalls two remarks remark 1 if the linear kernel coefficients c 0 1 and quadratic kernel coefficients c 0 2 are convoluted with impulse function then the linear impulse response function lirf and quadratic impulse response function qirf can be obtained and presented as follows a lirf can be coded in matlab format and written in eq 22 below for n 1 n 22 h l n n c o n v c 0 1 k 1 n δ n end term δ n is an impulse function which is defined as follows 23 δ n 0 n 1 1 n 1 b qirf can be also coded in matlab format and written in eq 2 below for n 1 n 24 h n l n n n c o n v 2 c 0 2 k 1 k 2 n δ n δ t n end equations 22 24 show that the identified irfs are time variant so that the evolution of the gain with respect to time can be produced at this stage dynamic characteristics of respective structures in terms of modal parameters can be computed using logarithmic decrement method and dynamic response prediction with any arbitrary system inputs remark 2 if the extracted linear and quadratic dynamic responses y 1 ˆ and y 2 ˆ are employed then modal analysis can also be computed by modeling both responses through tvar model by replacing the system input u n k 1 in the rhs of eq 2 with lagged y 1 ˆ or y 2 ˆ respectively as derived below 25 y 1 ˆ n k 1 1 k c 1 0 k 1 n y 1 ˆ n k 1 similar with volterra kernel coefficients tvar coefficients c 1 0 1 n c 1 0 2 n c 1 0 k n can also be estimated with cs ks method and the transfer function of the equation in z transform can be expressed in eq 26 26 h z n 1 1 k 1 1 k c 1 0 k 1 n z k 1 denominator of eq 26 is known as a system characteristic equation by factoring the denominator of the equation the poles can be obtained and written in eq 27 27 h z n 1 z p 1 n z p 2 n z p k n number of poles in eq 27 is dependent upon the order of tvar model used when they are mapped in the complex plane position of the poles yields important dynamic characteristic in the form of modal property as derived by poulimenos and fassois 2006 modal property in terms of damping ratio ζ and frequency f is associated with amplitude and phase of the poles respectively they are given by eqs 28 and 29 below 28 f i n ln p i n f s 2 π 29 ζ i n cos arg ln p i n it should be noted that term p i presents the ith poles in discrete time index while term f s denotes the sampling frequency since the coefficients of tvar model are time variant then the modal frequency in eq 28 and the damping ratio in eq 29 are also time variant accordingly 5 experimental setup and identification methodology for rationalization of proposed identification method experiment had been setup and detailed in ng 2014 however it is briefly summarized here for a coincise information a classic spar platform was taken as a test model which has diameter of 0 3 m hull length of 0 899 m draft of 0 699 m and displayed in fig 4 a it was designed with length scale ratio of 1 100 and manufactured from steel plate scaling factor is chosen based on froude s law of similitude so as to fit the spar platform in the wave tank platform was moored by using steel wires with linear springs stiffness is 29 5 n m and arranged as pointed out in fig 4 b mooring lines tension in the fairlead was measured using load cells which were mounted between the spring and platform small pieces of foam were attached along the mooring lines to create buoyancy for the springs and load cells a restraining system in the form of pulley system was installed to avoid slacking of the steel wires and clamped in order such that they were pre tensioned during the test sea keeping tests were carried out in the wave tank of the offshore engineering laboratory located at universiti teknologi petronas with total length of 22 m width of 10 m and water depth of 1 5 m wave energy absorbing beach system embedded in the wave tank has the function to minimize the interference from wave reflection during the tests sea states of h s 4 m with a peak frequency f p of 0 061 hz in full scale rough sea was imposed to the platform in the direction of head seas the wave was a unidirectional long crested random wave which was generated from jonswap type spectrum and made through the board of wavemaker two kinds of measurement systems were commissioned for the wave height and platform motions for wave height measurement four wave gauges were used in which two sensors were mounted in front of the platform while the others were mounted at the rear of the platform for platform motions measurement optical tracking system was used identification methodology is completely illustrated in fig 5 where it can be observed that measured wave height and surge motion time series are employed as system input output dataset it is worthy to note that effects of wave reflection from the wall of wave tank were not accounted in identification process based on the dataset identification of irfs is performed according to figs 3 and 5 6 results and discussions 6 1 numerical data in this section numerical simulation is carried out to produce a numerical system input output data by using the data the efficacy of proposed method to identify the irfs the linear and nonlinear responses is demonstrated a simple and soft nonlinear oscillator model is chosen in order such that the nonlinearity in terms of a quadratic damping can be numerically produced the system is given by fig 6 where dynamical model of the system is derived in eq 30 below 30 m s y s t c s 1 y s t c s 2 y s t y s t k s y s t f e t physical parameters of the system are defined as the following oscillator mass m s of 68 kg linear and quadratic damping coefficients c s 1 c s 2 of 5 kg s and 5 kg m respectively and linear spring constant k s of 10 n m those values are selected in order such that it can produce 0 061 hz linear natural frequency and 9 6 linear damping ratio oscillator is excited with a system input f e t which has a normal distribution in the frequency range of 0 0 5 hz by using fourth order runge kutta method eq 30 is numerically solved its displacement velocity and acceleration y s y s and y s are obtained respectively simulation time period of 3000 s is set and time step used is 1 s in simulation initial condition of position and velocity y s 0 and y s 0 are valued to be zero so as to ensure that the zeroth order kernel c 0 0 is zero accordingly thus irfs are identified using the proposed method for this case volterra model order is determined by using final prediction error fpe method the results are maximum lag k of 128 and nonlinearity degree q of 2 by using the optimum model order kernel coefficients are estimated using eqs 9 18 and converted into irfs using eqs 22 24 the identified irfs are depicted in figs 7 8 there are seven impulses observed from fig 7 until it decays into zero this condition forces the volterra model with cs ks method to have long model order in order to capture the dynamics of oscillator fig 7 also indicates that the identified lirf from cs ks based volterra model fits well with the actual lirf where the fit value is 92 84 also the linear natural frequency and damping ratio are similar with the theoretical values under logarithmic decrement method parsimonious model order can be achieved by adopting some methods such as prazenica 2002 however it is beyond the scope of this paper as a benchmark higher order spectral analysis hosa based volterra model is used it is seen that the identified lirf from the benchmark is comparable with the actual in the fit value of 88 15 lower than the proposed method furthermore the quadratic impulse response function qirf is shown in fig 8 where the time history of impulses is successfully characterized again the identified qirf from volterra model is in good agreement with the actual qirf it is clear from numerical results in figs 7 8 that the proposed identification method is capable of producing the irfs with high accuracy moreover both linear and nonlinear dynamic responses are recovered by convoluting the respective identified irfs with the system input as displayed by fig 9 as can be observed from fig 9 the identified linear and nonlinear dynamic responses obtained from proposed identification method and the benchmark agree well with actual responses for proposed method the fit value is 99 33 for linear response and 97 76 for nonlinear response in the other side responses obtained from the benchmark are 98 28 for linear response and 89 67 for nonlinear response in addition fig 9 also gives a clear indication of the strength of linear response in the dynamics of oscillator likewise the nonlinear response is found to be predominantly weaker than the linear response this is to be expected since the oscillator model chosen has low nonlinearity with a quadratic damping therefore if both dynamic responses are summed then it fits well with the actual dynamic response it is worthy to note if the nonlinearity comes from quadratic stiffness than the identification procedure is similarly applied lastly numerical data clearly represents the practical benefits of the proposed identification method over the hosa based volterra model thus it is reliable to be applied to the real system in the next section 6 2 experimental data 6 2 1 system input output and free decay test data once the proposed method is verified through numerical data then it is applied to the experimental data for system input output dataset the measured wave height and surge motion time series are taken and given by fig 10 after they have been converted into full scale data as can be observed from fig 10 a it is apparent that the amplitudes of wave and its probability density function pdf have less symmetrical distribution the observation can be interpreted that the wave height has non gaussian property and is linear random waves statistical analysis reveals that the mean of wave height is 0 083 m 1 117 m2 variance 0 104 m3 skewness and 3 12 m4 kurtosis likewise distribution of the surge motion amplitudes and its pdf is clearly unsymmetrical due to the amplitudes are shifted upward as shown in fig 10 b it gives a clear indication that the surge motion also has non gaussian property and is verified as nonlinear random waves statistical analysis also reveals that the surge motion has 0 01 m mean 0 506 m2 variance 0 44 m3 skewness and 3 45 m4 kurtosis to verify their data properties statistically both measured time series are then analyzed using matlab statistics toolbox via augmented dickey fuller test kwiatkowski phillips schmidt shin test and phillips perron test the wave height is found to be a stationary and non white noise time series as validated by using ljung box q statistic in similar fashion the surge motion clearly appears to be a non white noise and non stationary time series which suggests that the proposed identification method is relevant as additional statistical tests normality test using jarque bera test lillie test and kolmogorov smirnov test also accentuate the non gaussianity of the system input output before identification of irfs is performed fourier transform based spectral analysis is employed to the dataset this is to ensure that the nonlinearity exists in model tests of the spar platform results in fig 11 a reveal that the spectrum contains one principal frequency peak which is identical with the frequency of incident random wave it is then compared with the target wave spectrum produced by a jonswap type spectrum with 3 3 peakness factor spanos et al 2005 for a validation spectrum of each method is found in a good agreement with minor difference in magnitudes likewise two principal frequency peaks are revealed in spectra of fig 11 b the first frequency peak is found to be 0 005 hz while the second one is found to be 0 061 hz the former is identified as a low frequency response lfr while the latter is again identical with the frequency of incident random wave and is identified as a wave frequency response wfr overall spectral analysis in fig 11 reveals that the existence of lfr in the surge motion spectra gives a clear indication of nonlinear behaviour of a floating structure there is a wave energy transfer exerted by surge motion of spar platform in terms of high to low frequencies these phenomena are consistent with prior researchers i e spanos et al 2005 montasir and kurian 2011 details are discussed in the next subsection however these findings also confirm the reason why the surge motion is chosen as a system output in the identification process instead of other motions of spar platform in addition to experimental results of spar platform free decay test was carried out an initial displacement was given to the spar platform in the still water and its motions were measured the time series is displayed in fig 12 considering the figure modal parameters of the platform can be calculated using logarithmic decrement method calculation shows that the spar has 0 005 hz modal frequency and 11 3 damping ratio in particular the identified modal frequency is considered as a resonant frequency during the experiment these results also validate the spectra in fig 11 b and are taken as a baseline for identification of irfs in the next subsection 6 2 2 impulse response function results considering the fpe method used for numerical data optimum volterra model order for experimental data is also computed in similar fashion by limiting the nonlinearity degree of q to be 2 system input lag k is varied in order such that fpe value is minimized variation of lag to the fpe value is given in fig 13 and seen that the model order as a function of k based on the figure lag k of 13 is seen to have the lowest fpe value and considered as the optimum model order for experimental data the irfs of spar platform are then identified and the results are elaborated in figs 14 15 fig 14 a 14 b display the identified lirfs in the form of gain time time representation as can be seen variations of gain over time can be clearly observed characteristics of gain of lirfs are found to be time variant where a number of impulses may be apparently detected furthermore five impulses are identified before it decays into zero thus it is concluded that time history of the lirfs with different gain magnitudes has been successfully characterized within sampling time the time varying lirf is a consequent of the nonstationarity in the measured surge motion time series which also validates the statistical results in previous section again for a benchmark hosa based volterra model is used and given in fig 14 b as can be seen the identified lirf is comparable with result of cs ks based volterra model however the proposed identification method produces high resolution estimates where the impulses can be well identified in gain time time space the advantages of parametric volterra model are due to time variant kernel coefficients which are solved by using cs ks method making them well suited to time time representation if maximum gain of each time varying lirf in fig 14 a 14 b is selected within sampling time then the lirfs can be displayed in fig 14 c the results of both methods are reasonably overlapped and seen that the lirf decays around 70 s considering fig 14 c modal parameters in terms of modal frequency and damping ratio of spar platform are computed using logarithmic decrement method modal frequency is found to be around 0 062 hz which envisages that the identified lirf as a system dynamics property is a function of incident random wave frequencies this is a typical dynamics characteristic found in the lirf which is inherited by floating systems damping ratio is found to be 13 4 showing that the damping ratio in the wfr region is higher than that of free decay test where the ratio is 1 18 for this particular case for identified qirf the original is in gain time time time scale unfortunately displaying such graphs creates difficulties for visibility and interpretation purposes thus representation in gain time time in terms of two dimensional scale is chosen for the sake of clarity since experiment time period is set to be 3600 s only qirf with maximum gain are chosen and given by fig 15 it is seen that the qirf decays around 800 s much slower than the lirf number of impulses in the qirf may be clearly detected from fig 15 a 15 b those figures consistently show that the qirf obtained from the proposed method produces higher time resolution than that of hosa based volterra model furthermore number of impulses is reflected in the fig 15 c where six impulses are found before it decays into zero by using logarithmic decrement method it is found that the platform has 0 005 hz modal frequency and 4 1 damping ratio the frequency seems consistent with free decay test in fig 12 and corresponds to the first frequency of spectra in fig 11 b the calculated damping ratio is lower than that of free decay test its ratio is 2 14 for this particular case in general this result indicates that the nonlinear behaviour of the floating spar platform can be well modeled through qirf if the identified lirf and qirf are convoluted with the wave height in fig 10 a then both linear and nonlinear dynamic responses are recovered and displayed in the left panel of fig 16 the frequency content of both responses is obtained from fourier transform and shown in the right panel it can be observed from fig 16 a that the total response in time domain obtained from proposed method fits well with the measured data with the fit value of 95 35 while the benchmark has only fit value of 84 32 in frequency domain fit values are 93 58 and 82 91 respectively the accuracy of the proposed method is further justified by the responses in frequency domain in the linear response wfr both methods seem competitive with respect to the measured spectra this is to be expected since linear behaviour is relatively easy to be captured and modeled the shape of spectrum almost overlaps each other however this is not true for nonlinear response lfr the proposed method can produce better shape spectrum then the benchmark in addition fig 16 accentuates the results in figs 14 15 suggesting that both dynamic responses of spar platform are to be able to be well extracted since the hosa based volterra model is still based on fourier transform there is always a tradeoff between time and frequency resolutions in particular for low frequency this is also worsened by the fact that the benchmark is sensitive to the gaussianity and non gaussianity of sea waves the inappropriate higher order cross spectral estimates may lead to local bias spectral leakage and erroneous volterra model the cs ks based volterra model appears to be more general and versatile for solving such problems it just requires the optimum model order by following identification procedure in section 2 4 those facts highlight the advantage of the proposed method over the benchmark in addition by using results from the proposed method estimation of modal analysis using tvar model through eqs 25 and 26 can be performed effectively with model order of 2 tvar coefficients of each response can be estimated using eq 27 the roots of each model coefficient are poles obtained from eqs 28 and 29 consequently modal frequency and damping ratio over time can be estimated and depicted in fig 17 for clarity by using results in figs 14 16 the identified values are summarized in table 1 it is seen that there is insignificant different between the frequencies in table 1 with the random wave parameter and free decay test result overall results suggest that the dynamics of the spar platform can be well captured and modeled by the identified irfs 7 conclusions and recommendations the concept of a time varying volterra model to produce the linear and nonlinear irfs from model test data has been presented cuckoo search based kalman smoother cs ks method and a time domain parametric volterra model are proposed numerical simulations supported with experimental results to the spar platform have clearly showed the benefits of the proposed identification method important conclusions and recommendations from the overall results can be drawn as follows by employing the proposed time varying regressor vectors for the time domain parametric volterra model time varying linear and nonlinear irfs can be well produced in the high time resolution from the model test data where nonlinearity and nonstationarity of the underlying system can be captured simultaneously the linear irfs are found to be a function of frequencies of incident random waves while the nonlinear irfs are found to be around the resonant frequency of spar platform the latter can be well modeled by the nonlinear irf under time domain quadratic volterra model extraction of the linear and nonlinear dynamic responses from the spar platform is effectively carried out by means of the convoluted irfs estimated irfs allow the extraction of modal parameters in terms of natural frequency and damping ratio to be much easier performed the modal parameters can be calculated from the estimated irfs under logarithmic decrement method also from the extracted dynamic responses the modal parameters can be calculated under the tvar model tradeoff between time and frequency resolutions can be eliminated for cs ks based volterra model in obtaining high quality identification results in particular for lfr it just requires the optimum model order also the proposed method can be generally used either for gaussian or non gaussian sea waves without leading to erroneous volterra models local bias and spectral leakage incorporation of the extracted modal parameters into the equations of motion of spar platform is recommended as a future work so that the dynamic responses of the platform can be predicted numerically it is envisaged that in the future proposed identification method can be implemented to other moored or tethered floating structures as well as other engineering systems credit authorship contribution statement edwar yazid conceptualization writing original draft methodology investigation writing review editing coding cheng yee ng experiment validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank indonesian institute of sciences and universiti teknologi petronas for providing research facility and financial support so that the research collaboration can be performed nomenclature a state transition matrix α c s constant o step size c 0 q volterra kernel coefficients c s damping coefficient c f cost function δ impulse function δ c s weight index δ t s time step f s sampling frequency f frequency f e excitation force h l lirf h n l qirf h transfer function j smoothing matrix k maximum lag k g kalman gain k s stiffness coefficient l v total kernel coefficient l c s number of nest m s mass n the largest discrete time index n discrete time index p state covariance matrix p c s best nest p poles φ regressor vector q the order of system input q state noise variance r c s 1 2 uniform random numbers r measurement noise variance s kalman smoother parameters t s time sampling θ state variable u actual system input y actual system response y ˆ predicted system response y ˆ 1 predicted linear response y ˆ 2 predicted nonlinear response y s displacement y s velocity y s acceleration ζ damping ratio 
21284,ocean renewable energy is a promising inexhaustible source of renewable energy with an estimated harnessing potential of approximately 337 gw worldwide which could re shape the power generation mix as with other sources of renewables however wave energy has an intermittent and irregular nature which is a major concern for power system stability consequently in order to integrate wave energy into power grids it must be forecasted this paper proposes using optimised deep learning neural networks to forecast the wave energy flux and other wave parameters in particular we use moth flame optimisation as the central decision making unit to configure the deep neural network structure and the proper input data selection besides the moth flame optimisation algorithm was modified to improve its search space mechanisms the forecasting skills are assessed using 13 datasets from locations across the pacific and atlantic coasts and the gulf of mexico the proposed optimised deep neural network performs well at all the sites especially over short term horizons where it outperforms statistical and physics based approaches keywords ocean wave energy short term forecasting deep neural networks data selection moth flame optimisation forecasting skills 1 introduction the focus of any green agenda is the consolidation of renewable power generation technologies as the primary source for electricity generation in this regard marine energy resources are a potentially large source of renewable energy and estimates suggest that by 2050 up to 337 gw of installed capacity worldwide of which 100 gw in europe alone could be available badcock broe et al 2014 besides waves exhibit energy densities many times greater than do the solar and wind resources mendes et al 2012 another great example of this potential is the australian coast with its ocean renewable energy ore resources far exceeding the current electricity demand hemer et al 2018 an essential stage to not only determine the economic viability of an ore project but also in the technical side i e when deciding upon the proper wec mechanical structure and operational principles is to correctly map and quantify the average wave energy available at specific locations this is commonly achieved by analysing the buoy data and employing deep water numerical models using bathymetry wind and radar data as inputs the set of measurable parameters typically includes significant wave height mean and peak wave periods and mean wave direction mendes et al 2012 uihlein and magagna 2016 the wec power output is characterised over discretised ranges of these met ocean parameters particularly the significant wave height and the energy period forming what is known as the performance matrix hiles et al 2016 moreover wave conditions are known to exhibit variability over monthly seasonal inter annual and decadal time scales cahill and lewis 2014 this variability is a consequence of various factors such as fluctuations of the yearly wind index climate indices seasonality of wind speed and solar irradiance for example there can be considerably more wind during winters than in summers which is contrary to the case of solar energy the technological breakthroughs on wave farming pose special operational concerns from the perspective of utilities as the ongoing power grid integration process will require compliance with a set of operational details another important issue is the question of predictability with regard to short term trading on electricity markets where generation imbalances are met with hefty penalties jeon and taylor 2016 in turn the authors in reikard et al 2015a studied the costs of integrating the wave energy over the pacific northwest zone into the power grid in conjunction with a wind and solar portfolio outlining the reduced need for wave balancing reserves in relation to traditional wind and solar farms this feature was also demonstrated when forecasting the ocean wave energy output in the coastal region of western canada reikard et al 2015b as previously observed in the case of wind and solar energy forecasts the researchers have been looking for suitable solutions to accurately forecast the oceanographic parameters with a special emphasis on wave power output and wave height in the same fashion as for other time series the literature on this subject ranges from physics based numerical models classical statistical methods soft computing methods to hybrid methods of these the physics based numerical models typically exhibit a better accuracy over larger horizons reikard et al 2015a and perform well for longer intervals the growth in the observations of sea state parameters and the unceasing developments in modelling the dynamics of ocean waves and atmospheric interactions has been the key to massive improvements in the ability of physics based models of different generations to estimate the sea state parameters janssen 2008 for instance numerical forecasting experiments were carried out based on the physical wave model ww3 and were applied to the north pacific and china sea datasets bell and kirtman 2018 zheng et al 2016 similarly another third generation model named wam is also among the most popular choices with regard to statistical and soft computing approaches hadadpour et al 2014 achieved good results using a nn with specific input selection models in turn reikard et al 2011 considered 13 datasets to benchmark the wave model from the european centre for medium range weather forecasts ecmwf against time varying regression and a multi layer perceptron the latter performed better for short term horizons whereas the physics based model performed better for lead times above 5 h with a narrower error range the same conclusions were drawn in reikard et al 2015a 2017 for a wide range of locations i e different locations sea state parameters furthermore the recurrent nns are also amongst the fittest options for time series prediction using this approach authors in desouky and abdelkhalik 2019 sadeghifar et al 2017 employed nonlinear autoregressive exogenous narx networks for wave prediction in the south caspian and two locations near the hawaiian coast respectively to enhance the performance of the predictions a common practice is to apply wavelet transformation or wavelet neural networks to expose different characteristics of the time series özger 2010 prahlada and deka 2015 furthermore recently trending approaches have continued to cover soft computing methods such as support vector machines extreme learning machines sequential learning nn genetic fuzzy systems and machine learning applications berbić et al 2017 cornejo bueno et al 2018 fernández et al 2015 james et al 2018 kumar et al 2017 2018 in akbarifard and radmanesh 2018 the symbiotic organisms search sos algorithm was used to fine tune the coefficients of statistical forecasting models in order to predict the wave height in the caspian sea moreover in duran rosal et al 2017 an artificial neural network classifier with hybrid basis functions is trained with a multi objective evolutionary algorithm moea in order to predict extreme significant wave height segment following the success of these approaches a new methodology based on a deep nn as a preferred forecasting engine is presented in this work this methodology s sensitive aspects with regard to architecture and input data selection are automatically fine tuned by an improved moth flame optimisation mfo algorithm this methodology is validated for a variety of periods and horizons using an extensive set of samples measured from 13 locations along the us and canadian coasts the remainder of this paper is organised in the following manner section ii provides a background review of major topics covered in this work namely the theory behind the sea state parameters a brief review of artificial nns and the improved version of the mfo algorithm section iii follows by presenting meaningful characteristics of the chosen 13 datasets locations a detailed description of the proposed methodology is presented in section iv section v presents and discusses the test results of the proposed methodology lastly section vi presents the key conclusions of this work 2 background 2 1 sea state parameters and wave power density as mentioned previously the abundant energy densities energy transport associated with ocean waves tied to the fact that oceans cover more than 70 of the earth s surface constitute a massive renewable energy source recurrently the term wave is misinterpreted which in its essence characterises how energy is transferred in this case through water as medium the ocean waves are a result of wind interaction with the water surface energy transfer khan et al 2017 this ultimately translates into an infinite superposition of wave components with different magnitudes frequencies phases and directions thus one can say that wave energy is created by the displacement of air masses as a consequence of the solar energy redistribution in the atmosphere since the early 60s important breakthroughs in ocean wave spectra nonlinear theory have been witnessed these have been very helpful to further develop approximate theoretical models for the real ocean wave behaviour the set of sea state parameters and its derived wave power expressions enable us to not only assess the wave energy potential in a specified location but also reconstruct its corresponding sea state spectrum the first parameter is the significant wave height h m 0 m 0 which represents the mean of the highest third of the waves in a random seaway and is often regarded as the most important parameter influencing the extreme loads on marine structure lucas et al 2019 the second parameter the wave energy period t e is determined by the ratio of two spectral moments i e t e t m 1 m 1 m 0 where m n represents the n th moment of spectral density the combination of these two parameters defines a specific sea state in other words the wave energy is dependent on the joint distribution of these parameters the same parameters are used to determine the wave energy flux per unit wave crest length the third important parameter is the weighted average period derived from the second moment of the spectral density t m t m 02 m 0 m 2 and this mean wave period is also known as the zero cross mean wave period it can be determined from the observations of the sea surface elevation beels et al 2007 bidlot 2016 pastor et al 2016 lastly the mean transport rate of the wave energy through a vertical plane of unit width parallel to a wave crest is called the wave energy flux or wave power j kwm 1 in deep water condition i e where the water depth is larger than half the wavelength it is computed as follows pastor et al 2016 1 j ρ g 2 64 π m 1 1000 ρ g 2 64 π h m 0 2 t e 1000 0 491 h m 0 2 t e where h m 0 is the significant wave height t e the wave energy period ρ the water density and g the acceleration due to gravity when the significant wave height is given in metres and the wave period in seconds the result is the wave power in kilowatts kw per meter of the wave front length when determining this wave power per unit of the water surface in an irregular sea state an important consideration is that t e is often unknown therefore it is estimated based on theoretical spectral shapes commonly known as jonswap using fixed conversion rates from other variables such as t m or t p peak wave period beels et al 2007 cahill and lewis 2014 pastor et al 2016 for example the relationship with the mean wave period given by t e 1 14 t m was suggested in contestabile et al 2015 pastor et al 2016 furthermore to properly visualize the ocean wave potential for a given location the annual wave energy density can be computed as a function of h m 0 and t e as follows 2 e a n n u a l k w h m j f r e l n o b s t where j and f r e l are respectively the wave energy flux and the relative joint frequency of occurrence for each combination of h m 0 and t e n o b s is the number of observations and t is time interval between the observations 2 2 artificial neural networks ann these types of machine learning models are centred on a connected layered architecture to mirror the behaviour of the biological neurons and are amongst the most popular soft computing techniques the inherent nonlinear and noise robustness traits make these models a very appropriate choice when dealing with problems such as pattern recognition data classification and time series forecasting desouky and abdelkhalik 2019 kamranzad et al 2011 a common ann topology is the multi layer feedforward neural network ffnn as represented in fig 1 where the nodes do not form a cycle moreover in the presence of multiple hidden layers these structures are labelled deep neural networks dnns in each network layer every neuron response is given by an activation function with a cost given by a biased weighted sum which works as a threshold subsequently for any two consecutive layers k 1 k this can be expressed mathematically as follows 3 y j f j i 1 n ω i j x i b j i 0 n j 0 m where n is the number of neurons in layer k 1 and m is the number of neurons in layer k n and m z y j is the output for neuron j x i is the input signal from neuron i b j is the respective neuron bias and lastly ω i j is the weight of the synaptic connection between neurons i and j the dnn learning task is accomplished in a process known as supervised learning and involves updating the weight vector to minimise the output error as for the training algorithm the scaled conjugate gradient backpropagation algorithm is a good choice as it provides a good trade off between speed and performance which is especially important for large networks in turn the dnn performance function used is the mean squared error m s e 1 n s 1 n y s y s ˆ where n is the number of training samples y s ˆ is the network output and y s is the desired output response 2 3 moth flame optimisation mfo published in 2015 moth flame optimizer is a nature inspired meta heuristic algorithm where the central idea is to mimic a moth s transverse orientation mechanism to navigate at night mirjalili 2015 furthermore the mfo is a population based algorithm that explores the hyper dimensional space and for this purpose two important position matrices are defined m moths which are the actual search agents and f flames which are the best ranked moths obtained so far both of these are of size p o p s i z e d i m where p o p s i z e is the number of moths and d i m the number of dimensions with an inspiration drawn from the transverse orientation the position of each moth is updated with respect to a flame i e m i s m i f j which means that a spiral function s is the position update mechanism responsible to fly the ith moth in the space around the jth flame a logarithmic spiral is the chosen function to perform this task using the following equation 4 s m i f j d i e b t cos 2 π t f j where d i f j m i indicates the distance of the ith moth for the jth flame b is a constant for defining the shape of the logarithmic spiral and t is a random number in the interval between a lower bound given by a linearly decreasing convergence constant r declining from 1 to 2 and an upper bound of 1 i e t r 1 this last parameter defines the proximity of the new moth position to the flame and ultimately the algorithm s convergence rate with r representing the closest position to the flame and 1 representing the farthest finally to properly balance the exploration and exploitation levels the number of flames is adaptively decreased over the course of iterations as given by eq 5 consequently this has implications over which jth flame is selected to update the ith moth meaning that only in the last iteration are the moths positions updated around the single best flame 5 f l a m e n o round p o p s i z e i t e r p o p s i z e 1 i t e r m a x additionally a few tweaks as described in eq 6 were added to the mfo to improve its diversification when probing the search space and subsequently mitigate premature convergence and stagnation with this intent right after the moth s position update eq 4 and its corresponding bound checking are performed for which we use a hyperbolic confinement as described in clerc 2006 firstly a variable p that translates a probability is stored when sweeping each of the moths when this probability p 0 03 0 05 the dimension d from the ith moth m i d is replaced by its neighbouring value from a randomly selected gth moth on the other hand for p 0 01 0 03 a new generated value is attributed to the ith moth with respect to the dth dimension lastly in a less frequently seen scenario for probabilities under 0 01 a completely new moth is attributed to the ith moth 6 m i d m g d 0 03 p 0 05 m i d r o u n d l b d u b d l b d rand 0 01 p 0 03 m i r o u n d l b u b l b rand p 0 01 finally the stop criterion can be defined as the maximum number of iterations max i t e r 3 wave data in the same fashion as in reikard et al 2011 buoy measurements and derived data consist of meteorological hourly datasets from 11 buoys from the us national data buoy centre ndbc and two south brooks and east dellwood from the canadian integrated science data management isdm these 13 locations enable a broader validation which implies that conclusions are not constrained to a particular geographic zone or a particular sea state condition these datasets include quality controlled i e containing interpolations measurements related to h m 0 t e t m t p windspeed and wind direction the wave energy flux j is indirectly computed as presented in eq 1 the buoy identifier location depth as well as the most important descriptive statistics i e mean median standard deviation and upper and lower limits as well as shape related statistics kurtosis and skewness are displayed in table 1 for the respective hourly time series of the three considered forecast quantities t e h m 0 j by analysing these statistics we can underline some interesting circumstances i the 13 locations provide a set of well rounded scenarios to apply the forecasting methodology ii all datasets reveal a leptokurtic distribution i e with a narrow and higher central peak this fact is especially true more abrupt peak for the wave energy flux owing to the fact that is proportional to the product of the other two iii the wave energy period is the most well behaved time series compared with the other two presenting a lower percentage standard deviation a positive moderately skewed distribution and with the lowest seasonal difference iv in contrast significant wave height and as consequence the wave energy flux proportional to the other two time series reveal greater percentage standard deviations with highly right skewed data in addition the seasonal difference is clearly evident v the standard deviation on the wave energy flux time series is higher than its mean value which implies a very widely distributed data set moreover to graphically complement the statistical analysis of the collected t e and h m 0 samples fig 2 is presented which provides a characterisation of the energy density based on the joint kernel probability density estimation computed based on eq 2 in terms of significant wave height h m 0 and energy period t e considering all samples in other works a different range of joint probability density estimations are employed to access a set of wave parameters distributions e g bivariate gamma distribution is fitted to model steepness and height of deep water waves antão and soares 2016 the variability across locations is clearly visible in fig 2 as previously mentioned in this case buoy data from location 46083 presents significantly higher energy densities than at location 44014 in a similar manner a wind rose comparison plot is presented in fig 3 showing the wave power flux distribution across the different angles it shows the clockwise wind direction in degrees from the true north n and its associated power again a wide variety of scenarios is contained in the 13 locations considered ranging from evenly spread distributions to more irregular bin patterns in this manner this work follows the footsteps of reikard et al 2011 and the proposed methodology will be validated using the same datasets 4 proposed methodology as we saw earlier the use of soft computing approaches is nowadays an appealing solution to a wide variety of domains particularly deep learning architectures provide a great framework to solve hard classification and prediction problems regarding this last set of problems deep learning architectures despite their black box nature are effective forecasting engines exhibiting impressive self learning capabilities when trained with a comprehensive representative dataset deep learning possesses an intrinsic ability to automatically cope with time series structures such as non linearity trends and seasonality feng et al 2020 pirhooshyaran and snyder 2020 hence in this work a dnn is used as a forecasting engine as shown in fig 1 and to uncover the most relevant information of the past raw data on which correlation analysis will be used however to make most of these networks capabilities one should notice the importance of its architecture in other words there is a set of hyperparameters including activation functions number of hidden layers number of neurons per layer training method batch size and chosen stop criterion to which the dnn s performance is highly sensitive among others qu et al 2019 shinozaki and watanabe 2015 son et al 2018 for instance the decision of adding more layers could improve the dnn s generalisation and learning efficiency compared with a large one hidden layer network however it comes with an increased computational effort as well as the risk of overfitting ghamizi et al 2019 in addition to these hyperparameters a befitting input data selection for the forecasting engine should not be underestimated given its potential to improve the performance bento et al 2019 son et al 2018 tran et al 2015 in this regard we can highlight the choice of input features endogenous variables time variables and other exogenous variables number of lags relevant past information number of training samples etc for example by incorporating too many input parameters the risks of suboptimal convergence increase son et al 2018 considering the difficulty of this selection task we want to assemble an input data set with a reasonably small size and at the same time not compromise on the information necessary for dnn to learn and generalise a set of patterns consequently we understand that relying on hand crafted procedures or past experiences to choose this broad set of parameters can be short sighted and compromise the forecasting accuracy with this in mind the mfo algorithm will be used almost as a central decision unit which by assessing the dnn forecasting performance objective function automatically fine tunes the dnn architecture and the crucial input data selection as represented in fig 4 to encapsulate the employed optimisation scheme aims to automate the modelling of the dnn and its input data through a set of hyperparameters to maximize the dnn s potential to produce accurate forecasts the same is achieved by exploring the benefit of different input selections to find which information is more relevant to be contained in the input dataset this will facilitate the dnn s objective to extract the characteristics and non linearities of the time series in addition the mfo ensures that the dnn s architecture maintains a good and important generalization capacity and does not overfit to the training data to serve this purpose a 14 dimensional search space will be swept by the moths wherein the first seven dimensions concern the dnn architecture i e by evaluating networks with a different number of hidden layers neurons and activation transfer functions in search of the improved generalisation capabilities in the particular case of hidden layers architectures from 1 hidden layer up to 3 hidden layers are evaluated allowing a good compromise between the depth and simplicity fig 5 top the remaining dimensions concern the input data selection in particular the inclusion of exogenous variables such as h m 0 t e j t m t p windspeed and wind direction as well as the number of lags past samples to include in the dnn s input data implications in terms of input layer size as illustrated in fig 5 bottom in addition the upper and lower bounds of a given dimension s are also represented and the individual range of each dimension will be further explained in addition the dnn training process will be carried out in a supervised manner with a calibrated 75 25 data division ratio for training and validation respectively scaled conjugate gradient backpropagation algorithm is responsible for the weights update providing a good trade off between the simulation time and performance which is especially important for large networks the dnn s performance function was the mean squared error m s e 1 n s 1 n y s y s ˆ where n is the number of training samples y s ˆ is the network output and y s is the desired output response therefore an optimisation of this continuous space will be performed using the modified mfo algorithm presented in section ii c with a p o p s i z e 50 nevertheless from an implementation point of view when interpreting after each mfo iteration the multi dimensional continuous space different solutions for each dimension there is a need to binarize some dimensions to isolate the most significant bit msb the value of this bit will have implications in the selection of a particular feature this bit is represented in fig 5 by the grey binary block 0 or 1 and precedes all dimensions where a particular feature hyperparameter is being fine tuned the first dimension dim1 fine tunes the number of neurons in a mandatory first hidden layer where the lower and upper bounds are respectively l b 1 1 and u b 1 63 in turn the second dimension dim2 decides one of the four transfer functions to associate with all neurons in its respective layer namely hyperbolic tangent sigmoid symmetric hard limit symmetric saturating linear and linear transfer functions consequently l b 2 0 and u b 2 3 and this search space is also considered for an eventual second and third hidden layer dim4 and dim6 as well as for the output layer dim7 the third and fifth dimensions dim3 and dim5 will determine not only the existence of a second and even a third hidden layer but also the respective number of neurons in each one the bounds of these dimensions are l b 3 1 and u b 3 63 and after each mfo iteration when solutions are updated its decimal value is converted to binary if the msb i e the sixth bit is equal to 1 i e a hidden layer is included the remaining five bits then determine the size of the extra hidden layer which can therefore amount to a total of 32 neurons the way in which these dimensions are assembled favour architectures with more than one hidden layer and evaluate the deep neural architectures up to 64 32 32 hidden nodes up to 65664 hidden weights changing gears to the input selection related dimensions as we have seen are responsible not only for the inclusion of exogenous variables as auxiliary dnn input data but also for the correspondent significant input lags for each one to this intent a pre processing stage takes place before the fine tuning performed by the mfo this stage reveals the lags past observations with the highest correlation with the predict and variable as such for each variable a linear correlation between the samples is measured to assemble a bank of lags within the confidence interval then from this bank of pre selected lags excluding irrelevant past samples the mfo will pick those which improve the forecasting performance in this sense the eighth dimension dim8 is concerned only with the lag s fine tuning for the endogenous variable the one predicted which depending on the case study will be one of the three variables namely h m 0 t e and j this implies that for example when forecasting the significant wave height h m 0 t e and j alongside t m t p windspeed and wind direction are considered exogenous variables as for the remaining dimensions dim9 to dim14 it assesses whether the inclusion given the msb value of the referred exogenous variables translates into an improved dnn learning process and thus increased prediction accuracy as for the respective lower and upper bounds from l b 8 and u b 8 to l b 14 and u b 14 respectively they are not constant fixed as they depend on the size of the lags bank as a result of correlation analysis which itself varies from variable to variable and from dataset to dataset different buoy data nonetheless we can mention that at the very least we will always be talking about lower and upper bounds of 0 and 31 respectively four bits are required to represent the individual selection of the past four observations which is a common approach dixit et al 2014 hadadpour et al 2014 reikard et al 2015b and a fifth bit msb to determine if the respective exogenous variable is included or not into the input data finally in addition to the input data selection performed by the mfo two inputs with a temporal character are also fed to the dnn containing respectively the hourly and season indices 5 results the proposed methodology is tested using the data presented in table 1 13 datasets in other words variables h m 0 t e and j are forecast for each location with short range lead times of 1 2 3 6 and 12 h moreover the wave energy flux j is not only forecasted directly i e the dnn output provides the j forecast but also indirectly by using the h m 0 and t e forecasts using eq 1 under a set of assumptions that fit a broad range of conditions for validation purpose four months of testing are considered one month per calendar season for northern hemisphere as shown in table 2 additionally before testing the dnn s forecasting performance over these periods unseen data the network is trained using the previous months data and is modelled according to the best settings obtained by the mfo finally to assess the forecasting performance the most common criteria error metrics are used namely the correlation coefficient r e 1 mean absolute log difference error m a l e e 2 and root mean squared error r m s e e 3 from eqs 7 9 7 r e 1 i 1 n s p i p o i o i 1 n s p i p 2 i 1 n s o i o 2 8 male e 2 100 i 1 n s log p i log o i n s 9 rmse e 3 i 1 n s p i o i n s the average aggregated forecasting results e 1 e 2 and e 3 for all the 13 sites are presented in table 3 as there are 13 sites four time series t e h m 0 j and j i n d i r e c t and five forecasting horizons the individual error metrics for each site are presented later in appendix in tables 1 13 besides for illustration purposes the real and predicted wave energy flux as well as the absolute error are represented graphically in fig 6 for all the considered forecasting horizons regarding buoy 46001 data spring forecasting dates from the four predicted time series firstly we can see a general trend wherein t e presents the lowest average errors in the range of 2 7 7 9 in terms of male i e e 2 for h m 0 e 2 is in the range of 5 3 16 5 and at the opposite end j presents the largest average error of 14 7 42 9 3 this outcome is expected as j h m 0 2 a n d t e moreover we can see the benefits of forecasting the wave energy flux indirectly j i n d i r e c t which means that more accurate results are yielded by predicting the wave energy from the separately predicted variables h m 0 and t e than from the direct forecast j which is not unexpected since there is a strong correlation between the three forecasted variables this inference is supported by observing figs 7 and 8 that show the distribution box and whisker plots of the correlation coefficient e 1 and the mean absolute log difference e 2 for all the test dates and buoys the benefit of indirectly forecast the wave energy flux versus a direct approach the bottom box and whisker plots in both figures is clear the indirect approach reveals a smaller interquartile range spread and the whiskers reach consistently better error values higher values in terms of e 1 and smaller values in terms of e 2 also the j time series greater standard deviation levels and significant shape deviations from a traditional normal distribution in comparison with h m 0 and t e as we have seen in table 1 can complicate the task of the deep neural network in detecting seasonal patterns this may ultimately explain the increased error when using the direct approach additionally we can also visualize in both figures how the error spreads as the forecasting horizon increases especially for horizons beyond 3 h these results are interesting especially in terms of the period and the significant height as they are better than the statistical models and are in the same range as the ones given by the combined models which heavily benefit from the physical model accuracy for the 6 and 12 h forecasting horizons for example the corresponding ranges with the latter models are 3 8 6 and 7 11 for t e and h m 0 respectively in reikard et al 2011 with regard to the energy flux j the direct forecasting results are in line with the statistical models i e 12 47 however they were improved by using the indirect prediction of j and only slightly inferior in comparison with the combined models which benefit from the contribution of physical models for the 6 and 12 h horizons furthermore the results show relevant forecasting performance improvements of above 21 for all the horizons except for the lead time of 12 h where the improvement was approximately 16 in terms of e 2 however in terms of e 1 and e 3 the improvements reached their maximum for the 12 h horizon with enhancements of approximately 5 and 3 respectively secondly the dnn s performance as a forecasting engine naturally decreases as the forecasting time horizon increases with errors in terms of both e 2 and e 3 increasing in comparison with the previous lead times in the order of 6 5 9 5 between 1 and 2 h 13 0 16 7 between 2 and 3 h 40 7 51 8 between 3 and 6 h and 50 5 63 4 between 6 and 12 for the four time series t e h m 0 j and j i n d i r e c t respectively inevitably in the case of extreme unforeseen events the dnn presents a slightly underestimated time series prediction thereby reinforcing the need for a broad set of training patterns and a set of exogenous variables to assemble a more robust forecasting engine thirdly it is possible to infer an obvious connection between the prediction accuracy and the season of the year to which the test month belongs for example with respect to significant wave height we can see that e 3 ranges from 0 09 to 0 24 m in the summer which is in contrast with a larger error of 0 18 0 57 m achieved in the winter thus there is a difference of approximately 49 in the rmse performance for all the horizons when comparing the summer and winter accuracies this effect is even more pronounced when we observe the wave power with the rmse values ranging from 1 59 to 4 77 kw in the summer and growing in the winter to 7 54 21 81 kw in other words there is a difference of roughly 78 in the rmse performance for all the horizons when comparing the summer and winter accuracies these results are explained in part by the increased volatility and existence of higher observations above average in the winter season i e there is a peak seasonal behaviour owing to the stronger winds observed in this period which translates to an average ratio of winter to summer means of 170 in the case of h m 0 and a staggering 326 in the case of j this implies that on an average the height and wave power flux observations in the winter are respectively 1 7 and 3 26 times higher than those in the summer likewise an average ratio of winter to summer standard deviations of 161 and 278 are registered for h m 0 and j this seasonal behaviour is illustrated for buoy station 46207 in fig 9 which confirms the increase in the interquartile range and outliers in the winter and fall seasons particularly regarding the wave power flux moreover the difference in the domain size of different time series helps to explain the difference in its respective forecasting accuracy 6 conclusions with a need to respond to the existential threat posed by climate change societies in general and electric power systems in particular are called upon to make a contribution to environmental protection commensurate with their responsibilities to this end a tremendous effort was put into the increase of the share of renewables in the conventional power generation portfolio in addition the maturation of technologies such as photovoltaic pv cells solar and wind brings in additional leverage to the search for alternatives therefore in a natural manner researchers have focused their attention on the abundant wave energy resources and on building appropriate wec s to harness this energy parallel to these developments the study of wave forecasting has been a research topic and is crucial for all marine activities to this end this study proposes a new soft computing approach in which a modified mfo algorithm working as an automated decision unit determines not only the sensible issues surrounding the dnn architecture but also the highly influential input and features selection this is because different inputs impact the forecasting accuracy in different ways which is especially true of the wind data as such the accuracy gains are sought not only in the forecasting engine calibration but also in the proper input lags selection the advantage of this automated process is that its tuning is based on an objective function that analyses the forecasting performance to validate the proposed methodology a comprehensive range of thirteen real datasets ndbc and isdm from 13 different sites have been used in four different months that coincide with different seasons of the year moreover the forecast focused not only on the wave energy flux but also the wave energy period and the significant wave heights the results have been obtained for five different lead times and they reveal a good forecasting performance that compares well with the existing model statistical and soft computing based approaches in addition the proposed process has yielded an improved accuracy for short term horizons and displayed a uniform character for different lead times in different datasets furthermore it has highlighted a set of seasonal characteristics with a clear contrasting behaviour for the winter and fall seasons as compared with the spring and summer seasons finally a considerable improvement has been observed when forecasting the wave power indirectly which validates the approach of using the auxiliary data to accurately predict the wave energy flux j credit authorship contribution statement p m r bento conceptualization methodology software validation investigation writing original draft writing review editing j a n pombo conceptualization methodology software validation investigation r p g mendes conceptualization methodology investigation m r a calado conceptualization methodology validation investigation writing review editing s j p s mariano conceptualization methodology software validation investigation supervision resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to express their gratitude to doctor jean raymond bidlot for the provided data and valuable insights on the subject that made this work possible this gratitude is extended to the industry statistician gordon reikard for the initial guidance and kind availability p m r bento gives his special thanks to the fundação para a ciência e a tecnologia fct portugal for the ph d grant sfrh bd 140371 2018 appendix this section introduces the forecasting accuracy for individual locations on each site and for each lead time which shows a more or less uniform forecasting performance that is independent of the chosen location and confirms the seasonal and hourly tendencies highlighted in section v for the different forecasted variables please see tables 1 13 table 1 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 41025 table 1 ndbc 41025 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 6 342 0 166 0 985 6 353 0 139 0 979 5 832 0 072 0 982 5 577 0 141 2 0 981 7 023 0 181 0 983 6 711 0 149 0 975 6 499 0 080 0 980 6 322 0 150 3 0 975 8 237 0 211 0 980 7 658 0 159 0 961 7 791 0 100 0 973 7 765 0 178 6 0 939 12 872 0 325 0 960 11 732 0 227 0 907 13 070 0 155 0 943 10 149 0 254 12 0 712 25 210 0 665 0 871 18 275 0 408 0 815 17 477 0 212 0 888 16 799 0 381 t e 1 0 972 3 078 0 273 0 979 3 446 0 313 0 974 3 268 0 262 0 973 3 327 0 321 2 0 968 3 363 0 291 0 977 3 600 0 324 0 973 3 566 0 274 0 970 3 460 0 334 3 0 964 3 635 0 315 0 972 4 135 0 361 0 966 4 024 0 305 0 966 3 695 0 361 6 0 903 5 634 0 501 0 946 5 765 0 499 0 940 5 875 0 416 0 950 4 785 0 443 12 0 762 9 097 0 755 0 865 9 089 0 779 0 862 8 568 0 597 0 886 7 230 0 653 j 1 0 981 16 880 4 300 0 972 17 061 3 071 0 968 15 337 0 638 0 969 15 036 3 569 2 0 972 24 360 5 183 0 970 18 636 3 205 0 968 15 520 0 652 0 962 20 588 4 101 3 0 949 26 239 7 034 0 968 20 036 3 319 0 950 31 601 0 802 0 957 19 970 4 326 6 0 900 39 833 9 568 0 947 34 034 4 256 0 888 29 842 1 201 0 925 27 796 5 621 12 0 721 54 971 15 244 0 854 49 102 6 802 0 743 39 878 1 710 0 889 34 237 6 833 j indirect 1 0 980 14 157 4 402 0 973 14 250 3 009 0 970 13 118 0 620 0 968 12 980 3 617 2 0 972 15 776 5 293 0 968 14 962 3 268 0 967 14 325 0 652 0 965 14 333 3 791 3 0 967 17 907 5 609 0 966 16 865 3 386 0 950 16 509 0 814 0 961 17 040 4 123 6 0 925 27 496 8 340 0 955 24 588 3 989 0 915 26 047 1 100 0 932 21 539 5 444 12 0 690 52 813 16 364 0 879 36 190 6 588 0 849 33 678 1 421 0 916 34 842 7 424 table 2 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 41048 table 2 ndbc 41048 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 5 056 0 158 0 988 4 992 0 139 0 984 4 245 0 076 0 988 4 763 0 170 2 0 980 5 603 0 179 0 986 5 299 0 152 0 982 4 326 0 081 0 987 5 155 0 178 3 0 971 6 238 0 215 0 984 5 904 0 167 0 981 4 750 0 083 0 983 5 460 0 201 6 0 937 9 251 0 315 0 972 7 798 0 215 0 958 6 728 0 124 0 970 8 407 0 266 12 0 795 15 926 0 550 0 877 14 714 0 447 0 876 11 339 0 211 0 893 15 794 0 495 t e male rmse s 1 0 987 2 033 0 202 0 986 2 306 0 236 0 972 1 934 0 161 0 984 2 138 0 207 2 0 984 2 199 0 222 0 984 2 522 0 248 0 971 1 952 0 163 0 982 2 268 0 221 3 0 975 2 534 0 278 0 980 2 818 0 281 0 963 2 242 0 185 0 973 2 756 0 271 6 0 934 4 366 0 449 0 955 4 136 0 418 0 915 3 162 0 278 0 940 3 926 0 407 12 0 790 7 185 0 762 0 866 7 106 0 709 0 804 5 043 0 410 0 837 6 738 0 643 j 1 0 977 13 392 5 309 0 980 12 097 5 103 0 976 9 814 1 123 0 981 13 328 6 604 2 0 972 14 729 5 939 0 977 14 525 5 737 0 967 10 781 1 301 0 978 14 302 7 077 3 0 947 17 344 8 087 0 975 20 371 5 782 0 968 11 275 1 307 0 974 15 809 7 655 6 0 916 30 403 10 059 0 915 26 550 10 634 0 918 15 881 2 024 0 962 21 257 9 190 12 0 710 45 540 17 846 0 892 35 470 12 608 0 763 25 771 3 439 0 843 37 686 18 456 j indirect 1 0 978 11 122 5 259 0 981 11 015 5 014 0 979 8 978 1 050 0 982 10 451 6 573 2 0 969 12 330 6 216 0 979 11 683 5 470 0 975 9 183 1 166 0 980 11 315 6 757 3 0 953 13 850 7 599 0 976 12 770 5 869 0 976 9 975 1 118 0 970 12 018 8 701 6 0 919 20 503 9 933 0 961 17 046 7 372 0 938 14 060 1 778 0 964 18 613 9 085 12 0 760 35 678 16 353 0 860 31 167 14 011 0 849 23 053 2 733 0 885 35 357 16 137 table 3 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 42001 table 3 ndbc 42001 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 5 400 0 101 0 988 4 986 0 068 0 993 5 348 0 062 0 991 5 399 0 138 2 0 981 5 894 0 109 0 985 5 666 0 078 0 993 5 681 0 065 0 989 5 952 0 150 3 0 970 7 920 0 136 0 978 7 168 0 093 0 990 7 041 0 077 0 983 7 149 0 190 6 0 913 12 196 0 230 0 938 12 556 0 155 0 980 10 030 0 121 0 961 11 056 0 285 12 0 793 21 196 0 343 0 810 19 081 0 266 0 945 17 547 0 211 0 893 14 550 0 464 t e 1 0 983 2 066 0 153 0 981 2 102 0 141 0 983 2 112 0 150 0 991 2 074 0 173 2 0 981 2 347 0 166 0 978 2 378 0 154 0 981 2 272 0 157 0 989 2 288 0 195 3 0 969 3 017 0 211 0 967 3 016 0 188 0 977 2 573 0 177 0 984 2 737 0 238 6 0 925 4 581 0 325 0 914 4 710 0 296 0 952 4 161 0 255 0 965 4 000 0 351 12 0 759 7 801 0 556 0 742 8 050 0 498 0 847 6 762 0 430 0 895 6 272 0 598 j 1 0 972 20 899 1 409 0 981 17 856 0 660 0 991 14 449 0 705 0 977 15 784 5 748 2 0 962 31 990 1 621 0 977 17 235 0 728 0 990 19 314 0 809 0 974 25 042 6 121 3 0 919 35 481 2 326 0 967 22 319 0 874 0 989 25 419 0 890 0 950 25 355 8 437 6 0 794 41 951 3 652 0 907 36 037 1 430 0 969 39 470 1 514 0 927 38 021 10 252 12 0 613 60 297 4 675 0 763 59 352 2 234 0 952 45 229 2 245 0 731 59 624 18 328 j indirect 1 0 968 11 926 1 474 0 982 10 958 0 642 0 992 11 377 0 669 0 980 11 995 5 349 2 0 966 13 101 1 533 0 977 12 499 0 727 0 992 12 113 0 705 0 978 13 087 5 684 3 0 956 17 285 1 740 0 975 15 212 0 749 0 989 14 777 0 850 0 969 15 977 6 786 6 0 875 26 928 2 876 0 932 26 283 1 231 0 983 21 374 1 518 0 937 24 496 9 477 12 0 727 47 555 4 136 0 789 40 861 2 100 0 952 37 518 2 773 0 811 32 560 15 866 table 4 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 42036 table 4 ndbc 42036 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 985 6 160 0 094 0 993 5 525 0 082 0 986 5 786 0 067 0 991 5 179 0 094 2 0 982 6 964 0 103 0 993 5 987 0 082 0 982 6 348 0 074 0 985 6 704 0 119 3 0 972 9 823 0 129 0 989 7 522 0 108 0 975 7 482 0 088 0 974 9 781 0 158 6 0 934 15 738 0 195 0 970 13 483 0 175 0 937 11 438 0 140 0 913 17 152 0 283 12 0 748 28 456 0 367 0 948 17 883 0 236 0 901 14 988 0 174 0 700 27 079 0 496 t e 1 0 964 2 705 0 202 0 972 2 276 0 154 0 985 2 592 0 181 0 988 2 051 0 128 2 0 959 3 179 0 213 0 964 2 664 0 176 0 984 2 640 0 187 0 982 2 635 0 157 3 0 934 3 945 0 272 0 959 2 886 0 187 0 979 3 112 0 211 0 959 3 978 0 234 6 0 842 6 074 0 411 0 917 4 194 0 272 0 953 4 883 0 339 0 883 6 571 0 390 12 0 580 9 831 0 621 0 841 5 905 0 365 0 856 7 817 0 539 0 574 11 707 0 708 j 1 0 975 31 831 0 990 0 990 12 851 1 223 0 982 13 739 0 579 0 987 14 401 1 438 2 0 970 29 477 1 078 0 989 21 323 1 520 0 970 16 887 0 760 0 972 26 062 2 104 3 0 957 37 995 1 283 0 977 25 703 2 019 0 948 23 399 1 101 0 962 27 075 2 438 6 0 901 48 569 1 921 0 976 33 565 2 211 0 848 29 216 1 842 0 873 43 936 4 423 12 0 643 73 045 3 408 0 939 40 478 2 922 0 672 39 815 3 297 0 752 64 066 5 923 j indirect 1 0 976 13 186 0 971 0 989 11 910 1 259 0 985 12 381 0 533 0 988 11 553 1 394 2 0 971 15 358 1 058 0 991 12 771 1 116 0 980 13 429 0 598 0 982 15 065 1 714 3 0 966 21 461 1 151 0 989 15 676 1 388 0 968 16 094 0 802 0 975 22 411 1 994 6 0 930 34 836 1 643 0 985 28 053 1 869 0 889 24 885 1 495 0 911 39 569 3 698 12 0 798 61 966 2 804 0 959 37 550 3 146 0 818 32 745 1 900 0 637 63 580 6 969 table 5 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 42056 table 5 ndbc 42056 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 974 3 978 0 064 0 992 4 005 0 061 0 989 4 120 0 045 0 990 4 873 0 107 2 0 969 4 297 0 069 0 991 4 340 0 064 0 987 4 592 0 050 0 989 5 259 0 112 3 0 959 4 951 0 080 0 990 4 996 0 068 0 983 4 807 0 056 0 987 5 720 0 122 6 0 912 7 333 0 115 0 981 7 348 0 095 0 968 7 015 0 077 0 979 8 342 0 154 12 0 739 11 548 0 189 0 957 12 082 0 147 0 923 11 404 0 120 0 941 14 452 0 257 t e 1 0 937 2 156 0 160 0 974 2 028 0 131 0 975 2 155 0 147 0 986 2 375 0 183 2 0 931 2 285 0 168 0 970 2 223 0 141 0 973 2 289 0 152 0 984 2 560 0 192 3 0 913 2 606 0 188 0 962 2 482 0 158 0 969 2 480 0 165 0 981 2 829 0 211 6 0 843 3 555 0 251 0 934 3 362 0 209 0 893 4 188 0 300 0 964 3 806 0 296 12 0 607 5 391 0 373 0 862 4 733 0 292 0 820 5 532 0 386 0 855 6 968 0 566 j 1 0 959 9 916 0 612 0 986 9 981 0 732 0 988 10 052 0 298 0 981 23 517 1 920 2 0 956 10 629 0 632 0 985 11 025 0 768 0 986 11 308 0 319 0 978 24 508 2 077 3 0 943 12 198 0 713 0 982 13 292 0 850 0 980 16 725 0 394 0 975 24 450 2 191 6 0 864 18 505 1 102 0 978 18 329 0 923 0 967 19 624 0 546 0 957 29 491 2 847 12 0 654 29 118 1 692 0 932 34 940 1 654 0 870 33 755 1 001 0 897 39 930 4 349 j indirect 1 0 962 9 022 0 586 0 987 8 895 0 709 0 989 8 927 0 285 0 980 10 999 1 942 2 0 958 9 673 0 614 0 986 9 565 0 739 0 988 9 843 0 304 0 979 11 734 2 029 3 0 947 11 073 0 693 0 985 10 982 0 771 0 983 10 374 0 359 0 977 12 740 2 097 6 0 897 16 244 0 954 0 976 15 622 0 971 0 973 15 166 0 445 0 968 18 562 2 485 12 0 742 24 691 1 451 0 949 26 043 1 375 0 933 23 954 0 749 0 901 32 579 4 307 table 6 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 44014 table 6 ndbc 44014 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 5 834 0 154 0 993 5 284 0 115 0 969 5 962 0 073 0 988 6 081 0 155 2 0 983 6 523 0 163 0 990 6 006 0 144 0 968 6 209 0 075 0 986 6 640 0 173 3 0 969 8 983 0 217 0 990 6 297 0 138 0 953 7 582 0 090 0 982 8 047 0 192 6 0 916 15 090 0 354 0 972 9 210 0 240 0 881 11 557 0 141 0 968 11 550 0 261 12 0 656 27 979 0 668 0 945 13 513 0 343 0 721 17 538 0 209 0 861 21 699 0 519 t e 1 0 980 2 874 0 260 0 988 2 785 0 251 0 969 3 085 0 236 0 978 2 911 0 251 2 0 975 3 177 0 288 0 986 2 942 0 267 0 968 3 263 0 243 0 977 3 193 0 262 3 0 968 3 646 0 326 0 979 3 658 0 332 0 952 3 981 0 296 0 967 3 796 0 312 6 0 933 5 236 0 478 0 954 5 157 0 487 0 882 6 246 0 452 0 934 5 312 0 435 12 0 776 9 287 0 826 0 917 6 889 0 647 0 796 7 920 0 581 0 845 8 178 0 656 j 1 0 977 26 611 4 323 0 988 11 718 4 270 0 955 13 556 0 555 0 983 18 839 3 968 2 0 971 19 375 4 950 0 988 16 595 4 445 0 950 17 002 0 589 0 982 23 897 4 103 3 0 955 23 049 6 104 0 982 17 479 5 359 0 937 18 190 0 658 0 974 32 021 4 940 6 0 842 42 772 11 064 0 938 24 327 9 585 0 826 23 204 1 055 0 944 38 707 7 180 12 0 554 65 477 17 515 0 882 43 899 13 200 0 681 36 804 1 386 0 775 70 288 14 017 j indirect 1 0 977 12 910 4 369 0 989 11 238 4 105 0 959 12 488 0 533 0 985 13 462 3 711 2 0 975 14 264 4 604 0 985 12 687 4 932 0 960 13 121 0 538 0 981 14 648 4 274 3 0 964 19 361 5 611 0 984 13 737 5 022 0 946 15 464 0 625 0 974 17 416 4 886 6 0 919 31 535 8 871 0 950 19 991 8 706 0 867 22 130 0 959 0 961 25 178 6 300 12 0 641 58 803 15 784 0 926 28 913 11 208 0 716 33 103 1 305 0 832 47 030 12 048 table 7 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46001 table 7 ndbc 46001 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 977 6 451 0 336 0 987 5 431 0 200 0 989 5 290 0 113 0 981 6 203 0 261 2 0 972 7 090 0 369 0 986 5 880 0 212 0 986 5 598 0 127 0 979 6 722 0 275 3 0 956 8 819 0 457 0 979 7 684 0 255 0 978 6 133 0 160 0 973 7 978 0 316 6 0 900 13 568 0 682 0 955 11 796 0 372 0 942 11 064 0 261 0 920 13 041 0 530 12 0 695 22 953 1 132 0 870 20 203 0 622 0 882 16 584 0 364 0 855 19 477 0 716 t e 1 0 946 3 659 0 484 0 973 3 218 0 319 0 934 4 382 0 420 0 967 3 165 0 320 2 0 931 4 224 0 545 0 969 3 463 0 338 0 931 4 518 0 429 0 963 3 443 0 339 3 0 916 4 757 0 605 0 962 3 943 0 378 0 927 4 748 0 447 0 952 3 994 0 390 6 0 735 7 182 1 013 0 929 5 352 0 511 0 898 6 027 0 536 0 905 5 421 0 543 12 0 579 9 751 1 220 0 775 8 823 0 876 0 679 9 565 0 867 0 629 9 312 0 982 j 1 0 959 17 904 22 885 0 977 21 248 8 328 0 979 15 041 2 790 0 965 21 444 13 034 2 0 951 22 519 25 310 0 971 39 422 9 434 0 968 16 742 3 442 0 953 21 510 14 865 3 0 935 25 450 28 621 0 962 28 701 10 654 0 971 17 440 3 329 0 955 29 457 14 901 6 0 874 44 863 39 447 0 919 38 587 15 484 0 870 30 231 6 867 0 919 33 293 20 273 12 0 677 58 494 59 806 0 775 56 974 25 049 0 661 45 451 10 626 0 726 53 533 34 966 j indirect 1 0 960 15 206 22 619 0 976 12 701 8 573 0 981 12 725 2 634 0 963 14 394 13 327 2 0 957 16 590 23 934 0 974 13 559 8 926 0 974 13 321 3 119 0 960 15 463 14 040 3 0 933 20 590 29 473 0 968 17 145 10 045 0 958 14 287 3 956 0 954 18 323 15 460 6 0 875 32 099 40 281 0 947 26 225 12 664 0 888 23 931 6 283 0 887 28 872 23 492 12 0 672 52 278 60 903 0 822 44 993 22 397 0 864 33 863 6 985 0 816 44 649 31 015 table 8 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46041 table 8 ndbc 46041 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 978 5 425 0 247 0 979 5 322 0 133 0 985 5 329 0 118 0 982 5 856 0 207 2 0 975 5 946 0 268 0 975 5 829 0 142 0 984 5 772 0 123 0 979 6 315 0 221 3 0 972 6 302 0 281 0 975 6 043 0 144 0 983 6 090 0 131 0 974 7 581 0 249 6 0 937 9 318 0 420 0 952 8 563 0 199 0 972 8 596 0 201 0 956 10 344 0 330 12 0 787 16 557 0 739 0 876 13 828 0 313 0 942 14 616 0 293 0 906 16 279 0 493 t e 1 0 972 2 675 0 402 0 979 2 478 0 273 0 967 2 878 0 292 0 984 2 918 0 352 2 0 965 2 921 0 446 0 977 2 608 0 285 0 964 3 002 0 303 0 981 3 153 0 379 3 0 959 3 383 0 490 0 976 2 787 0 302 0 950 3 391 0 361 0 978 3 350 0 420 6 0 918 5 335 0 722 0 957 3 817 0 405 0 900 4 810 0 509 0 958 4 757 0 579 12 0 659 9 739 1 307 0 876 6 256 0 672 0 766 7 412 0 750 0 862 8 941 1 010 j 1 0 965 13 816 14 477 0 971 13 054 3 228 0 977 12 536 2 628 0 973 19 553 8 529 2 0 959 15 177 15 514 0 967 14 381 3 431 0 971 13 844 2 972 0 967 18 181 9 458 3 0 952 19 468 16 987 0 967 15 032 3 433 0 976 15 283 2 948 0 958 22 415 10 579 6 0 907 23 878 23 663 0 941 25 429 4 585 0 960 24 020 4 011 0 929 31 288 13 843 12 0 637 43 011 42 647 0 901 31 506 6 165 0 862 42 320 7 536 0 845 39 108 19 743 j indirect 1 0 965 12 145 14 469 0 972 11 723 3 189 0 978 11 693 2 570 0 974 12 924 8 364 2 0 959 13 332 15 640 0 969 12 804 3 327 0 978 12 628 2 663 0 969 13 841 9 111 3 0 959 14 300 15 825 0 968 13 264 3 389 0 974 13 215 2 958 0 965 16 533 9 734 6 0 901 21 917 24 463 0 947 18 849 4 443 0 961 18 618 4 663 0 938 22 540 12 812 12 0 662 38 208 41 685 0 885 29 791 6 589 0 938 31 382 6 429 0 888 37 066 18 249 table 9 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46047 table 9 ndbc 46047 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 986 4 727 0 139 0 984 5 048 0 136 0 956 4 254 0 091 0 985 4 557 0 122 2 0 986 4 873 0 142 0 983 5 436 0 142 0 956 4 302 0 091 0 985 4 692 0 124 3 0 984 5 411 0 154 0 978 6 285 0 159 0 951 4 552 0 097 0 982 5 188 0 137 6 0 965 8 037 0 226 0 953 8 707 0 228 0 931 5 324 0 114 0 962 7 482 0 199 12 0 882 14 259 0 401 0 914 13 000 0 310 0 880 6 920 0 148 0 917 11 215 0 282 t e 1 0 979 2 575 0 343 0 977 3 113 0 370 0 973 2 683 0 288 0 987 2 529 0 335 2 0 977 2 768 0 358 0 974 3 310 0 394 0 972 2 758 0 295 0 986 2 732 0 355 3 0 973 3 057 0 391 0 968 3 646 0 435 0 968 2 879 0 311 0 985 2 743 0 364 6 0 936 4 453 0 597 0 943 4 958 0 582 0 960 3 265 0 351 0 973 4 032 0 502 12 0 797 8 167 1 023 0 863 7 214 0 892 0 899 5 150 0 555 0 922 7 169 0 819 j 1 0 975 11 200 4 810 0 969 12 378 3 125 0 942 9 466 1 530 0 973 11 098 3 612 2 0 975 11 957 4 852 0 964 13 345 3 395 0 941 9 482 1 542 0 972 11 627 3 712 3 0 968 15 405 5 469 0 962 13 942 3 476 0 929 10 969 1 687 0 968 12 230 3 992 6 0 952 17 936 6 732 0 937 22 849 4 445 0 925 10 999 1 738 0 951 18 678 4 925 12 0 824 33 177 12 767 0 881 28 056 6 007 0 848 16 278 2 482 0 886 26 828 7 368 j indirect 1 0 976 10 649 4 684 0 968 11 464 3 184 0 943 9 285 1 518 0 973 9 990 3 611 2 0 975 10 730 4 768 0 966 12 345 3 280 0 943 9 407 1 521 0 972 10 542 3 704 3 0 971 11 968 5 211 0 959 14 031 3 595 0 938 9 895 1 579 0 969 11 226 3 928 6 0 948 17 052 7 253 0 928 19 124 4 749 0 920 11 276 1 790 0 941 16 069 5 413 12 0 812 31 629 12 687 0 861 27 433 6 529 0 867 14 891 2 272 0 888 25 158 7 257 table 10 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46083 table 10 ndbc 46083 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 975 5 907 0 209 0 983 5 317 0 092 0 985 5 968 0 113 0 980 6 396 0 300 2 0 973 6 354 0 218 0 981 5 628 0 097 0 984 6 300 0 118 0 978 7 242 0 316 3 0 970 6 722 0 233 0 978 6 077 0 106 0 981 6 829 0 130 0 972 8 085 0 359 6 0 933 9 832 0 345 0 951 8 298 0 156 0 970 9 324 0 176 0 931 12 611 0 556 12 0 827 16 154 0 534 0 880 13 852 0 238 0 935 12 417 0 249 0 808 21 473 0 908 t e 1 0 963 3 602 0 443 0 965 4 294 0 395 0 956 4 534 0 461 0 972 3 617 0 407 2 0 958 3 891 0 475 0 962 4 413 0 408 0 956 4 713 0 462 0 971 3 881 0 417 3 0 953 4 190 0 504 0 957 4 763 0 439 0 953 5 027 0 479 0 959 4 823 0 496 6 0 897 6 317 0 744 0 931 6 025 0 551 0 924 6 813 0 615 0 887 8 203 0 812 12 0 555 11 891 1 380 0 840 9 593 0 833 0 843 9 552 0 850 0 649 13 560 1 326 j 1 0 963 15 412 8 264 0 971 13 305 1 423 0 972 17 225 2 537 0 968 23 664 17 849 2 0 961 18 527 8 445 0 969 13 431 1 466 0 969 17 720 2 667 0 964 32 066 18 806 3 0 941 22 019 10 425 0 966 18 267 1 553 0 964 21 100 2 840 0 948 29 626 22 924 6 0 897 28 386 13 545 0 943 20 312 2 000 0 951 22 323 3 658 0 893 49 541 31 954 12 0 787 44 239 18 974 0 878 25 890 2 861 0 930 36 358 4 331 0 765 73 742 46 219 j indirect 1 0 963 14 033 8 191 0 972 12 535 1 391 0 973 14 993 2 493 0 967 15 095 17 902 2 0 963 15 016 8 319 0 970 13 212 1 458 0 970 15 607 2 603 0 966 16 809 18 289 3 0 957 15 903 9 085 0 968 13 814 1 514 0 968 16 598 2 730 0 958 18 715 20 724 6 0 904 23 310 13 540 0 940 18 085 2 065 0 951 21 557 3 676 0 906 31 049 30 285 12 0 761 38 797 20 171 0 837 28 676 3 278 0 918 28 327 4 818 0 803 52 356 45 116 table 11 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46132 table 11 isdm 46132 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 980 5 094 0 181 0 979 4 518 0 084 0 987 4 784 0 115 0 982 5 404 0 216 2 0 977 5 561 0 192 0 974 4 954 0 092 0 983 5 780 0 134 0 977 6 680 0 247 3 0 972 6 345 0 216 0 965 5 815 0 107 0 982 6 617 0 138 0 968 7 772 0 292 6 0 931 9 364 0 332 0 912 8 928 0 167 0 941 11 413 0 246 0 903 12 792 0 498 12 0 824 14 656 0 516 0 766 14 517 0 265 0 870 18 721 0 372 0 787 20 428 0 726 t e 1 0 972 2 669 0 355 0 980 2 282 0 227 0 978 2 786 0 280 0 983 2 396 0 303 2 0 970 2 848 0 370 0 978 2 434 0 242 0 974 2 968 0 299 0 979 2 745 0 337 3 0 961 3 355 0 422 0 975 2 630 0 255 0 956 3 594 0 389 0 971 3 283 0 399 6 0 894 5 495 0 684 0 949 3 906 0 365 0 890 5 332 0 604 0 930 5 540 0 609 12 0 702 8 944 1 069 0 872 6 279 0 570 0 652 9 338 1 024 0 850 7 896 0 909 j 1 0 964 12 465 6 967 0 961 10 136 1 053 0 977 11 221 2 755 0 971 14 716 9 913 2 0 962 12 712 7 228 0 955 12 267 1 146 0 976 12 686 3 175 0 963 16 517 11 259 3 0 946 17 630 8 562 0 944 14 438 1 265 0 969 13 801 3 246 0 954 20 272 12 514 6 0 891 21 718 12 167 0 826 21 786 2 158 0 907 27 657 5 850 0 896 27 249 19 016 12 0 736 36 271 17 917 0 662 30 202 2 873 0 830 43 573 7 464 0 653 50 993 31 595 j indirect 1 0 964 11 593 7 029 0 965 9 542 1 002 0 976 10 309 2 852 0 972 12 019 9 844 2 0 963 12 543 7 106 0 958 10 550 1 104 0 972 12 478 3 229 0 967 14 633 10 702 3 0 955 14 133 7 985 0 949 11 945 1 205 0 978 13 808 2 832 0 953 16 828 12 703 6 0 888 20 679 12 152 0 877 18 138 1 837 0 923 22 480 5 182 0 892 27 017 19 375 12 0 773 31 888 16 776 0 698 28 874 2 735 0 861 37 216 7 417 0 792 44 135 27 994 table 12 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46207 table 12 isdm 46207 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 976 5 557 0 257 0 985 4 779 0 162 0 992 4 918 0 115 0 983 5 734 0 256 2 0 971 5 907 0 284 0 982 5 283 0 178 0 989 5 546 0 132 0 981 6 455 0 269 3 0 962 6 898 0 323 0 976 6 187 0 206 0 982 6 660 0 166 0 972 8 031 0 333 6 0 897 11 004 0 529 0 942 9 238 0 316 0 935 11 539 0 315 0 925 13 350 0 539 12 0 671 19 423 0 881 0 774 17 938 0 600 0 881 15 232 0 430 0 761 23 174 0 909 t e 1 0 970 2 780 0 374 0 984 2 272 0 255 0 974 2 662 0 277 0 986 2 137 0 261 2 0 962 3 164 0 419 0 982 2 472 0 271 0 973 2 807 0 285 0 983 2 475 0 290 3 0 949 3 780 0 492 0 979 2 693 0 293 0 962 3 317 0 336 0 975 3 044 0 349 6 0 890 5 714 0 749 0 951 4 338 0 454 0 926 4 503 0 466 0 937 5 074 0 574 12 0 403 11 054 1 423 0 880 6 827 0 694 0 815 6 804 0 719 0 808 8 202 0 941 j 1 0 966 14 193 15 517 0 974 13 912 5 377 0 987 13 477 3 034 0 971 14 667 13 029 2 0 955 16 644 17 997 0 967 17 854 6 055 0 984 13 737 3 347 0 966 17 944 14 563 3 0 945 18 470 19 742 0 962 19 715 6 491 0 967 20 018 4 726 0 960 22 002 15 394 6 0 851 28 211 31 989 0 880 33 577 11 283 0 893 29 832 8 432 0 897 38 237 25 079 12 0 474 49 851 54 372 0 684 44 570 17 335 0 664 50 943 14 126 0 651 60 925 41 858 j indirect 1 0 967 12 498 15 290 0 973 10 526 5 515 0 987 10 634 3 046 0 973 12 408 12 798 2 0 956 13 614 17 708 0 969 11 660 5 867 0 981 11 878 3 659 0 972 13 929 13 015 3 0 946 16 081 19 683 0 959 13 438 6 744 0 963 14 447 5 013 0 957 17 269 16 004 6 0 864 25 842 30 460 0 907 20 061 10 204 0 889 24 334 8 610 0 909 29 155 24 034 12 0 568 46 627 49 834 0 708 37 095 17 160 0 800 31 113 11 657 0 752 49 935 37 157 table 13 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 51001 table 13 ndbc 51001 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 985 4 111 0 164 0 963 4 914 0 120 0 973 3 972 0 095 0 981 4 693 0 150 2 0 984 4 358 0 173 0 959 5 242 0 125 0 971 4 156 0 099 0 979 4 751 0 154 3 0 983 4 609 0 181 0 955 5 418 0 132 0 969 4 258 0 103 0 977 5 124 0 162 6 0 968 6 287 0 244 0 936 6 579 0 156 0 957 5 102 0 119 0 967 6 187 0 194 12 0 930 9 023 0 357 0 869 9 396 0 219 0 914 7 093 0 166 0 933 9 985 0 297 t e 1 0 980 2 393 0 314 0 971 3 221 0 347 0 887 2 572 0 220 0 988 2 137 0 243 2 0 976 2 588 0 341 0 967 3 455 0 369 0 880 2 631 0 226 0 986 2 289 0 261 3 0 970 2 884 0 378 0 963 3 575 0 389 0 870 2 832 0 235 0 985 2 374 0 268 6 0 946 4 097 0 515 0 946 4 260 0 473 0 845 3 020 0 254 0 967 3 292 0 413 12 0 729 8 475 1 073 0 922 5 322 0 572 0 789 3 489 0 292 0 854 6 244 0 815 j 1 0 981 9 963 8 169 0 941 12 377 2 616 0 958 10 063 1 513 0 970 11 832 4 608 2 0 981 10 515 8 262 0 934 13 436 2 759 0 959 10 468 1 508 0 968 11 554 4 727 3 0 977 11 497 9 015 0 937 13 846 2 702 0 953 11 210 1 617 0 965 12 990 4 908 6 0 951 17 799 13 134 0 923 16 253 2 990 0 945 11 812 1 735 0 942 17 079 6 391 12 0 921 27 059 16 624 0 824 23 106 4 380 0 883 16 203 2 487 0 870 25 588 9 569 j indirect 1 0 982 9 347 7 993 0 943 11 681 2 573 0 961 9 405 1 464 0 972 10 523 4 421 2 0 981 9 883 8 173 0 938 12 540 2 685 0 957 9 822 1 537 0 968 10 741 4 734 3 0 978 10 528 8 965 0 933 12 908 2 783 0 954 10 069 1 596 0 967 11 492 4 857 6 0 968 14 444 10 740 0 922 15 164 3 029 0 945 11 482 1 758 0 953 13 233 5 769 12 0 917 23 725 17 252 0 845 21 487 4 187 0 894 14 949 2 372 0 905 23 129 8 820 
21284,ocean renewable energy is a promising inexhaustible source of renewable energy with an estimated harnessing potential of approximately 337 gw worldwide which could re shape the power generation mix as with other sources of renewables however wave energy has an intermittent and irregular nature which is a major concern for power system stability consequently in order to integrate wave energy into power grids it must be forecasted this paper proposes using optimised deep learning neural networks to forecast the wave energy flux and other wave parameters in particular we use moth flame optimisation as the central decision making unit to configure the deep neural network structure and the proper input data selection besides the moth flame optimisation algorithm was modified to improve its search space mechanisms the forecasting skills are assessed using 13 datasets from locations across the pacific and atlantic coasts and the gulf of mexico the proposed optimised deep neural network performs well at all the sites especially over short term horizons where it outperforms statistical and physics based approaches keywords ocean wave energy short term forecasting deep neural networks data selection moth flame optimisation forecasting skills 1 introduction the focus of any green agenda is the consolidation of renewable power generation technologies as the primary source for electricity generation in this regard marine energy resources are a potentially large source of renewable energy and estimates suggest that by 2050 up to 337 gw of installed capacity worldwide of which 100 gw in europe alone could be available badcock broe et al 2014 besides waves exhibit energy densities many times greater than do the solar and wind resources mendes et al 2012 another great example of this potential is the australian coast with its ocean renewable energy ore resources far exceeding the current electricity demand hemer et al 2018 an essential stage to not only determine the economic viability of an ore project but also in the technical side i e when deciding upon the proper wec mechanical structure and operational principles is to correctly map and quantify the average wave energy available at specific locations this is commonly achieved by analysing the buoy data and employing deep water numerical models using bathymetry wind and radar data as inputs the set of measurable parameters typically includes significant wave height mean and peak wave periods and mean wave direction mendes et al 2012 uihlein and magagna 2016 the wec power output is characterised over discretised ranges of these met ocean parameters particularly the significant wave height and the energy period forming what is known as the performance matrix hiles et al 2016 moreover wave conditions are known to exhibit variability over monthly seasonal inter annual and decadal time scales cahill and lewis 2014 this variability is a consequence of various factors such as fluctuations of the yearly wind index climate indices seasonality of wind speed and solar irradiance for example there can be considerably more wind during winters than in summers which is contrary to the case of solar energy the technological breakthroughs on wave farming pose special operational concerns from the perspective of utilities as the ongoing power grid integration process will require compliance with a set of operational details another important issue is the question of predictability with regard to short term trading on electricity markets where generation imbalances are met with hefty penalties jeon and taylor 2016 in turn the authors in reikard et al 2015a studied the costs of integrating the wave energy over the pacific northwest zone into the power grid in conjunction with a wind and solar portfolio outlining the reduced need for wave balancing reserves in relation to traditional wind and solar farms this feature was also demonstrated when forecasting the ocean wave energy output in the coastal region of western canada reikard et al 2015b as previously observed in the case of wind and solar energy forecasts the researchers have been looking for suitable solutions to accurately forecast the oceanographic parameters with a special emphasis on wave power output and wave height in the same fashion as for other time series the literature on this subject ranges from physics based numerical models classical statistical methods soft computing methods to hybrid methods of these the physics based numerical models typically exhibit a better accuracy over larger horizons reikard et al 2015a and perform well for longer intervals the growth in the observations of sea state parameters and the unceasing developments in modelling the dynamics of ocean waves and atmospheric interactions has been the key to massive improvements in the ability of physics based models of different generations to estimate the sea state parameters janssen 2008 for instance numerical forecasting experiments were carried out based on the physical wave model ww3 and were applied to the north pacific and china sea datasets bell and kirtman 2018 zheng et al 2016 similarly another third generation model named wam is also among the most popular choices with regard to statistical and soft computing approaches hadadpour et al 2014 achieved good results using a nn with specific input selection models in turn reikard et al 2011 considered 13 datasets to benchmark the wave model from the european centre for medium range weather forecasts ecmwf against time varying regression and a multi layer perceptron the latter performed better for short term horizons whereas the physics based model performed better for lead times above 5 h with a narrower error range the same conclusions were drawn in reikard et al 2015a 2017 for a wide range of locations i e different locations sea state parameters furthermore the recurrent nns are also amongst the fittest options for time series prediction using this approach authors in desouky and abdelkhalik 2019 sadeghifar et al 2017 employed nonlinear autoregressive exogenous narx networks for wave prediction in the south caspian and two locations near the hawaiian coast respectively to enhance the performance of the predictions a common practice is to apply wavelet transformation or wavelet neural networks to expose different characteristics of the time series özger 2010 prahlada and deka 2015 furthermore recently trending approaches have continued to cover soft computing methods such as support vector machines extreme learning machines sequential learning nn genetic fuzzy systems and machine learning applications berbić et al 2017 cornejo bueno et al 2018 fernández et al 2015 james et al 2018 kumar et al 2017 2018 in akbarifard and radmanesh 2018 the symbiotic organisms search sos algorithm was used to fine tune the coefficients of statistical forecasting models in order to predict the wave height in the caspian sea moreover in duran rosal et al 2017 an artificial neural network classifier with hybrid basis functions is trained with a multi objective evolutionary algorithm moea in order to predict extreme significant wave height segment following the success of these approaches a new methodology based on a deep nn as a preferred forecasting engine is presented in this work this methodology s sensitive aspects with regard to architecture and input data selection are automatically fine tuned by an improved moth flame optimisation mfo algorithm this methodology is validated for a variety of periods and horizons using an extensive set of samples measured from 13 locations along the us and canadian coasts the remainder of this paper is organised in the following manner section ii provides a background review of major topics covered in this work namely the theory behind the sea state parameters a brief review of artificial nns and the improved version of the mfo algorithm section iii follows by presenting meaningful characteristics of the chosen 13 datasets locations a detailed description of the proposed methodology is presented in section iv section v presents and discusses the test results of the proposed methodology lastly section vi presents the key conclusions of this work 2 background 2 1 sea state parameters and wave power density as mentioned previously the abundant energy densities energy transport associated with ocean waves tied to the fact that oceans cover more than 70 of the earth s surface constitute a massive renewable energy source recurrently the term wave is misinterpreted which in its essence characterises how energy is transferred in this case through water as medium the ocean waves are a result of wind interaction with the water surface energy transfer khan et al 2017 this ultimately translates into an infinite superposition of wave components with different magnitudes frequencies phases and directions thus one can say that wave energy is created by the displacement of air masses as a consequence of the solar energy redistribution in the atmosphere since the early 60s important breakthroughs in ocean wave spectra nonlinear theory have been witnessed these have been very helpful to further develop approximate theoretical models for the real ocean wave behaviour the set of sea state parameters and its derived wave power expressions enable us to not only assess the wave energy potential in a specified location but also reconstruct its corresponding sea state spectrum the first parameter is the significant wave height h m 0 m 0 which represents the mean of the highest third of the waves in a random seaway and is often regarded as the most important parameter influencing the extreme loads on marine structure lucas et al 2019 the second parameter the wave energy period t e is determined by the ratio of two spectral moments i e t e t m 1 m 1 m 0 where m n represents the n th moment of spectral density the combination of these two parameters defines a specific sea state in other words the wave energy is dependent on the joint distribution of these parameters the same parameters are used to determine the wave energy flux per unit wave crest length the third important parameter is the weighted average period derived from the second moment of the spectral density t m t m 02 m 0 m 2 and this mean wave period is also known as the zero cross mean wave period it can be determined from the observations of the sea surface elevation beels et al 2007 bidlot 2016 pastor et al 2016 lastly the mean transport rate of the wave energy through a vertical plane of unit width parallel to a wave crest is called the wave energy flux or wave power j kwm 1 in deep water condition i e where the water depth is larger than half the wavelength it is computed as follows pastor et al 2016 1 j ρ g 2 64 π m 1 1000 ρ g 2 64 π h m 0 2 t e 1000 0 491 h m 0 2 t e where h m 0 is the significant wave height t e the wave energy period ρ the water density and g the acceleration due to gravity when the significant wave height is given in metres and the wave period in seconds the result is the wave power in kilowatts kw per meter of the wave front length when determining this wave power per unit of the water surface in an irregular sea state an important consideration is that t e is often unknown therefore it is estimated based on theoretical spectral shapes commonly known as jonswap using fixed conversion rates from other variables such as t m or t p peak wave period beels et al 2007 cahill and lewis 2014 pastor et al 2016 for example the relationship with the mean wave period given by t e 1 14 t m was suggested in contestabile et al 2015 pastor et al 2016 furthermore to properly visualize the ocean wave potential for a given location the annual wave energy density can be computed as a function of h m 0 and t e as follows 2 e a n n u a l k w h m j f r e l n o b s t where j and f r e l are respectively the wave energy flux and the relative joint frequency of occurrence for each combination of h m 0 and t e n o b s is the number of observations and t is time interval between the observations 2 2 artificial neural networks ann these types of machine learning models are centred on a connected layered architecture to mirror the behaviour of the biological neurons and are amongst the most popular soft computing techniques the inherent nonlinear and noise robustness traits make these models a very appropriate choice when dealing with problems such as pattern recognition data classification and time series forecasting desouky and abdelkhalik 2019 kamranzad et al 2011 a common ann topology is the multi layer feedforward neural network ffnn as represented in fig 1 where the nodes do not form a cycle moreover in the presence of multiple hidden layers these structures are labelled deep neural networks dnns in each network layer every neuron response is given by an activation function with a cost given by a biased weighted sum which works as a threshold subsequently for any two consecutive layers k 1 k this can be expressed mathematically as follows 3 y j f j i 1 n ω i j x i b j i 0 n j 0 m where n is the number of neurons in layer k 1 and m is the number of neurons in layer k n and m z y j is the output for neuron j x i is the input signal from neuron i b j is the respective neuron bias and lastly ω i j is the weight of the synaptic connection between neurons i and j the dnn learning task is accomplished in a process known as supervised learning and involves updating the weight vector to minimise the output error as for the training algorithm the scaled conjugate gradient backpropagation algorithm is a good choice as it provides a good trade off between speed and performance which is especially important for large networks in turn the dnn performance function used is the mean squared error m s e 1 n s 1 n y s y s ˆ where n is the number of training samples y s ˆ is the network output and y s is the desired output response 2 3 moth flame optimisation mfo published in 2015 moth flame optimizer is a nature inspired meta heuristic algorithm where the central idea is to mimic a moth s transverse orientation mechanism to navigate at night mirjalili 2015 furthermore the mfo is a population based algorithm that explores the hyper dimensional space and for this purpose two important position matrices are defined m moths which are the actual search agents and f flames which are the best ranked moths obtained so far both of these are of size p o p s i z e d i m where p o p s i z e is the number of moths and d i m the number of dimensions with an inspiration drawn from the transverse orientation the position of each moth is updated with respect to a flame i e m i s m i f j which means that a spiral function s is the position update mechanism responsible to fly the ith moth in the space around the jth flame a logarithmic spiral is the chosen function to perform this task using the following equation 4 s m i f j d i e b t cos 2 π t f j where d i f j m i indicates the distance of the ith moth for the jth flame b is a constant for defining the shape of the logarithmic spiral and t is a random number in the interval between a lower bound given by a linearly decreasing convergence constant r declining from 1 to 2 and an upper bound of 1 i e t r 1 this last parameter defines the proximity of the new moth position to the flame and ultimately the algorithm s convergence rate with r representing the closest position to the flame and 1 representing the farthest finally to properly balance the exploration and exploitation levels the number of flames is adaptively decreased over the course of iterations as given by eq 5 consequently this has implications over which jth flame is selected to update the ith moth meaning that only in the last iteration are the moths positions updated around the single best flame 5 f l a m e n o round p o p s i z e i t e r p o p s i z e 1 i t e r m a x additionally a few tweaks as described in eq 6 were added to the mfo to improve its diversification when probing the search space and subsequently mitigate premature convergence and stagnation with this intent right after the moth s position update eq 4 and its corresponding bound checking are performed for which we use a hyperbolic confinement as described in clerc 2006 firstly a variable p that translates a probability is stored when sweeping each of the moths when this probability p 0 03 0 05 the dimension d from the ith moth m i d is replaced by its neighbouring value from a randomly selected gth moth on the other hand for p 0 01 0 03 a new generated value is attributed to the ith moth with respect to the dth dimension lastly in a less frequently seen scenario for probabilities under 0 01 a completely new moth is attributed to the ith moth 6 m i d m g d 0 03 p 0 05 m i d r o u n d l b d u b d l b d rand 0 01 p 0 03 m i r o u n d l b u b l b rand p 0 01 finally the stop criterion can be defined as the maximum number of iterations max i t e r 3 wave data in the same fashion as in reikard et al 2011 buoy measurements and derived data consist of meteorological hourly datasets from 11 buoys from the us national data buoy centre ndbc and two south brooks and east dellwood from the canadian integrated science data management isdm these 13 locations enable a broader validation which implies that conclusions are not constrained to a particular geographic zone or a particular sea state condition these datasets include quality controlled i e containing interpolations measurements related to h m 0 t e t m t p windspeed and wind direction the wave energy flux j is indirectly computed as presented in eq 1 the buoy identifier location depth as well as the most important descriptive statistics i e mean median standard deviation and upper and lower limits as well as shape related statistics kurtosis and skewness are displayed in table 1 for the respective hourly time series of the three considered forecast quantities t e h m 0 j by analysing these statistics we can underline some interesting circumstances i the 13 locations provide a set of well rounded scenarios to apply the forecasting methodology ii all datasets reveal a leptokurtic distribution i e with a narrow and higher central peak this fact is especially true more abrupt peak for the wave energy flux owing to the fact that is proportional to the product of the other two iii the wave energy period is the most well behaved time series compared with the other two presenting a lower percentage standard deviation a positive moderately skewed distribution and with the lowest seasonal difference iv in contrast significant wave height and as consequence the wave energy flux proportional to the other two time series reveal greater percentage standard deviations with highly right skewed data in addition the seasonal difference is clearly evident v the standard deviation on the wave energy flux time series is higher than its mean value which implies a very widely distributed data set moreover to graphically complement the statistical analysis of the collected t e and h m 0 samples fig 2 is presented which provides a characterisation of the energy density based on the joint kernel probability density estimation computed based on eq 2 in terms of significant wave height h m 0 and energy period t e considering all samples in other works a different range of joint probability density estimations are employed to access a set of wave parameters distributions e g bivariate gamma distribution is fitted to model steepness and height of deep water waves antão and soares 2016 the variability across locations is clearly visible in fig 2 as previously mentioned in this case buoy data from location 46083 presents significantly higher energy densities than at location 44014 in a similar manner a wind rose comparison plot is presented in fig 3 showing the wave power flux distribution across the different angles it shows the clockwise wind direction in degrees from the true north n and its associated power again a wide variety of scenarios is contained in the 13 locations considered ranging from evenly spread distributions to more irregular bin patterns in this manner this work follows the footsteps of reikard et al 2011 and the proposed methodology will be validated using the same datasets 4 proposed methodology as we saw earlier the use of soft computing approaches is nowadays an appealing solution to a wide variety of domains particularly deep learning architectures provide a great framework to solve hard classification and prediction problems regarding this last set of problems deep learning architectures despite their black box nature are effective forecasting engines exhibiting impressive self learning capabilities when trained with a comprehensive representative dataset deep learning possesses an intrinsic ability to automatically cope with time series structures such as non linearity trends and seasonality feng et al 2020 pirhooshyaran and snyder 2020 hence in this work a dnn is used as a forecasting engine as shown in fig 1 and to uncover the most relevant information of the past raw data on which correlation analysis will be used however to make most of these networks capabilities one should notice the importance of its architecture in other words there is a set of hyperparameters including activation functions number of hidden layers number of neurons per layer training method batch size and chosen stop criterion to which the dnn s performance is highly sensitive among others qu et al 2019 shinozaki and watanabe 2015 son et al 2018 for instance the decision of adding more layers could improve the dnn s generalisation and learning efficiency compared with a large one hidden layer network however it comes with an increased computational effort as well as the risk of overfitting ghamizi et al 2019 in addition to these hyperparameters a befitting input data selection for the forecasting engine should not be underestimated given its potential to improve the performance bento et al 2019 son et al 2018 tran et al 2015 in this regard we can highlight the choice of input features endogenous variables time variables and other exogenous variables number of lags relevant past information number of training samples etc for example by incorporating too many input parameters the risks of suboptimal convergence increase son et al 2018 considering the difficulty of this selection task we want to assemble an input data set with a reasonably small size and at the same time not compromise on the information necessary for dnn to learn and generalise a set of patterns consequently we understand that relying on hand crafted procedures or past experiences to choose this broad set of parameters can be short sighted and compromise the forecasting accuracy with this in mind the mfo algorithm will be used almost as a central decision unit which by assessing the dnn forecasting performance objective function automatically fine tunes the dnn architecture and the crucial input data selection as represented in fig 4 to encapsulate the employed optimisation scheme aims to automate the modelling of the dnn and its input data through a set of hyperparameters to maximize the dnn s potential to produce accurate forecasts the same is achieved by exploring the benefit of different input selections to find which information is more relevant to be contained in the input dataset this will facilitate the dnn s objective to extract the characteristics and non linearities of the time series in addition the mfo ensures that the dnn s architecture maintains a good and important generalization capacity and does not overfit to the training data to serve this purpose a 14 dimensional search space will be swept by the moths wherein the first seven dimensions concern the dnn architecture i e by evaluating networks with a different number of hidden layers neurons and activation transfer functions in search of the improved generalisation capabilities in the particular case of hidden layers architectures from 1 hidden layer up to 3 hidden layers are evaluated allowing a good compromise between the depth and simplicity fig 5 top the remaining dimensions concern the input data selection in particular the inclusion of exogenous variables such as h m 0 t e j t m t p windspeed and wind direction as well as the number of lags past samples to include in the dnn s input data implications in terms of input layer size as illustrated in fig 5 bottom in addition the upper and lower bounds of a given dimension s are also represented and the individual range of each dimension will be further explained in addition the dnn training process will be carried out in a supervised manner with a calibrated 75 25 data division ratio for training and validation respectively scaled conjugate gradient backpropagation algorithm is responsible for the weights update providing a good trade off between the simulation time and performance which is especially important for large networks the dnn s performance function was the mean squared error m s e 1 n s 1 n y s y s ˆ where n is the number of training samples y s ˆ is the network output and y s is the desired output response therefore an optimisation of this continuous space will be performed using the modified mfo algorithm presented in section ii c with a p o p s i z e 50 nevertheless from an implementation point of view when interpreting after each mfo iteration the multi dimensional continuous space different solutions for each dimension there is a need to binarize some dimensions to isolate the most significant bit msb the value of this bit will have implications in the selection of a particular feature this bit is represented in fig 5 by the grey binary block 0 or 1 and precedes all dimensions where a particular feature hyperparameter is being fine tuned the first dimension dim1 fine tunes the number of neurons in a mandatory first hidden layer where the lower and upper bounds are respectively l b 1 1 and u b 1 63 in turn the second dimension dim2 decides one of the four transfer functions to associate with all neurons in its respective layer namely hyperbolic tangent sigmoid symmetric hard limit symmetric saturating linear and linear transfer functions consequently l b 2 0 and u b 2 3 and this search space is also considered for an eventual second and third hidden layer dim4 and dim6 as well as for the output layer dim7 the third and fifth dimensions dim3 and dim5 will determine not only the existence of a second and even a third hidden layer but also the respective number of neurons in each one the bounds of these dimensions are l b 3 1 and u b 3 63 and after each mfo iteration when solutions are updated its decimal value is converted to binary if the msb i e the sixth bit is equal to 1 i e a hidden layer is included the remaining five bits then determine the size of the extra hidden layer which can therefore amount to a total of 32 neurons the way in which these dimensions are assembled favour architectures with more than one hidden layer and evaluate the deep neural architectures up to 64 32 32 hidden nodes up to 65664 hidden weights changing gears to the input selection related dimensions as we have seen are responsible not only for the inclusion of exogenous variables as auxiliary dnn input data but also for the correspondent significant input lags for each one to this intent a pre processing stage takes place before the fine tuning performed by the mfo this stage reveals the lags past observations with the highest correlation with the predict and variable as such for each variable a linear correlation between the samples is measured to assemble a bank of lags within the confidence interval then from this bank of pre selected lags excluding irrelevant past samples the mfo will pick those which improve the forecasting performance in this sense the eighth dimension dim8 is concerned only with the lag s fine tuning for the endogenous variable the one predicted which depending on the case study will be one of the three variables namely h m 0 t e and j this implies that for example when forecasting the significant wave height h m 0 t e and j alongside t m t p windspeed and wind direction are considered exogenous variables as for the remaining dimensions dim9 to dim14 it assesses whether the inclusion given the msb value of the referred exogenous variables translates into an improved dnn learning process and thus increased prediction accuracy as for the respective lower and upper bounds from l b 8 and u b 8 to l b 14 and u b 14 respectively they are not constant fixed as they depend on the size of the lags bank as a result of correlation analysis which itself varies from variable to variable and from dataset to dataset different buoy data nonetheless we can mention that at the very least we will always be talking about lower and upper bounds of 0 and 31 respectively four bits are required to represent the individual selection of the past four observations which is a common approach dixit et al 2014 hadadpour et al 2014 reikard et al 2015b and a fifth bit msb to determine if the respective exogenous variable is included or not into the input data finally in addition to the input data selection performed by the mfo two inputs with a temporal character are also fed to the dnn containing respectively the hourly and season indices 5 results the proposed methodology is tested using the data presented in table 1 13 datasets in other words variables h m 0 t e and j are forecast for each location with short range lead times of 1 2 3 6 and 12 h moreover the wave energy flux j is not only forecasted directly i e the dnn output provides the j forecast but also indirectly by using the h m 0 and t e forecasts using eq 1 under a set of assumptions that fit a broad range of conditions for validation purpose four months of testing are considered one month per calendar season for northern hemisphere as shown in table 2 additionally before testing the dnn s forecasting performance over these periods unseen data the network is trained using the previous months data and is modelled according to the best settings obtained by the mfo finally to assess the forecasting performance the most common criteria error metrics are used namely the correlation coefficient r e 1 mean absolute log difference error m a l e e 2 and root mean squared error r m s e e 3 from eqs 7 9 7 r e 1 i 1 n s p i p o i o i 1 n s p i p 2 i 1 n s o i o 2 8 male e 2 100 i 1 n s log p i log o i n s 9 rmse e 3 i 1 n s p i o i n s the average aggregated forecasting results e 1 e 2 and e 3 for all the 13 sites are presented in table 3 as there are 13 sites four time series t e h m 0 j and j i n d i r e c t and five forecasting horizons the individual error metrics for each site are presented later in appendix in tables 1 13 besides for illustration purposes the real and predicted wave energy flux as well as the absolute error are represented graphically in fig 6 for all the considered forecasting horizons regarding buoy 46001 data spring forecasting dates from the four predicted time series firstly we can see a general trend wherein t e presents the lowest average errors in the range of 2 7 7 9 in terms of male i e e 2 for h m 0 e 2 is in the range of 5 3 16 5 and at the opposite end j presents the largest average error of 14 7 42 9 3 this outcome is expected as j h m 0 2 a n d t e moreover we can see the benefits of forecasting the wave energy flux indirectly j i n d i r e c t which means that more accurate results are yielded by predicting the wave energy from the separately predicted variables h m 0 and t e than from the direct forecast j which is not unexpected since there is a strong correlation between the three forecasted variables this inference is supported by observing figs 7 and 8 that show the distribution box and whisker plots of the correlation coefficient e 1 and the mean absolute log difference e 2 for all the test dates and buoys the benefit of indirectly forecast the wave energy flux versus a direct approach the bottom box and whisker plots in both figures is clear the indirect approach reveals a smaller interquartile range spread and the whiskers reach consistently better error values higher values in terms of e 1 and smaller values in terms of e 2 also the j time series greater standard deviation levels and significant shape deviations from a traditional normal distribution in comparison with h m 0 and t e as we have seen in table 1 can complicate the task of the deep neural network in detecting seasonal patterns this may ultimately explain the increased error when using the direct approach additionally we can also visualize in both figures how the error spreads as the forecasting horizon increases especially for horizons beyond 3 h these results are interesting especially in terms of the period and the significant height as they are better than the statistical models and are in the same range as the ones given by the combined models which heavily benefit from the physical model accuracy for the 6 and 12 h forecasting horizons for example the corresponding ranges with the latter models are 3 8 6 and 7 11 for t e and h m 0 respectively in reikard et al 2011 with regard to the energy flux j the direct forecasting results are in line with the statistical models i e 12 47 however they were improved by using the indirect prediction of j and only slightly inferior in comparison with the combined models which benefit from the contribution of physical models for the 6 and 12 h horizons furthermore the results show relevant forecasting performance improvements of above 21 for all the horizons except for the lead time of 12 h where the improvement was approximately 16 in terms of e 2 however in terms of e 1 and e 3 the improvements reached their maximum for the 12 h horizon with enhancements of approximately 5 and 3 respectively secondly the dnn s performance as a forecasting engine naturally decreases as the forecasting time horizon increases with errors in terms of both e 2 and e 3 increasing in comparison with the previous lead times in the order of 6 5 9 5 between 1 and 2 h 13 0 16 7 between 2 and 3 h 40 7 51 8 between 3 and 6 h and 50 5 63 4 between 6 and 12 for the four time series t e h m 0 j and j i n d i r e c t respectively inevitably in the case of extreme unforeseen events the dnn presents a slightly underestimated time series prediction thereby reinforcing the need for a broad set of training patterns and a set of exogenous variables to assemble a more robust forecasting engine thirdly it is possible to infer an obvious connection between the prediction accuracy and the season of the year to which the test month belongs for example with respect to significant wave height we can see that e 3 ranges from 0 09 to 0 24 m in the summer which is in contrast with a larger error of 0 18 0 57 m achieved in the winter thus there is a difference of approximately 49 in the rmse performance for all the horizons when comparing the summer and winter accuracies this effect is even more pronounced when we observe the wave power with the rmse values ranging from 1 59 to 4 77 kw in the summer and growing in the winter to 7 54 21 81 kw in other words there is a difference of roughly 78 in the rmse performance for all the horizons when comparing the summer and winter accuracies these results are explained in part by the increased volatility and existence of higher observations above average in the winter season i e there is a peak seasonal behaviour owing to the stronger winds observed in this period which translates to an average ratio of winter to summer means of 170 in the case of h m 0 and a staggering 326 in the case of j this implies that on an average the height and wave power flux observations in the winter are respectively 1 7 and 3 26 times higher than those in the summer likewise an average ratio of winter to summer standard deviations of 161 and 278 are registered for h m 0 and j this seasonal behaviour is illustrated for buoy station 46207 in fig 9 which confirms the increase in the interquartile range and outliers in the winter and fall seasons particularly regarding the wave power flux moreover the difference in the domain size of different time series helps to explain the difference in its respective forecasting accuracy 6 conclusions with a need to respond to the existential threat posed by climate change societies in general and electric power systems in particular are called upon to make a contribution to environmental protection commensurate with their responsibilities to this end a tremendous effort was put into the increase of the share of renewables in the conventional power generation portfolio in addition the maturation of technologies such as photovoltaic pv cells solar and wind brings in additional leverage to the search for alternatives therefore in a natural manner researchers have focused their attention on the abundant wave energy resources and on building appropriate wec s to harness this energy parallel to these developments the study of wave forecasting has been a research topic and is crucial for all marine activities to this end this study proposes a new soft computing approach in which a modified mfo algorithm working as an automated decision unit determines not only the sensible issues surrounding the dnn architecture but also the highly influential input and features selection this is because different inputs impact the forecasting accuracy in different ways which is especially true of the wind data as such the accuracy gains are sought not only in the forecasting engine calibration but also in the proper input lags selection the advantage of this automated process is that its tuning is based on an objective function that analyses the forecasting performance to validate the proposed methodology a comprehensive range of thirteen real datasets ndbc and isdm from 13 different sites have been used in four different months that coincide with different seasons of the year moreover the forecast focused not only on the wave energy flux but also the wave energy period and the significant wave heights the results have been obtained for five different lead times and they reveal a good forecasting performance that compares well with the existing model statistical and soft computing based approaches in addition the proposed process has yielded an improved accuracy for short term horizons and displayed a uniform character for different lead times in different datasets furthermore it has highlighted a set of seasonal characteristics with a clear contrasting behaviour for the winter and fall seasons as compared with the spring and summer seasons finally a considerable improvement has been observed when forecasting the wave power indirectly which validates the approach of using the auxiliary data to accurately predict the wave energy flux j credit authorship contribution statement p m r bento conceptualization methodology software validation investigation writing original draft writing review editing j a n pombo conceptualization methodology software validation investigation r p g mendes conceptualization methodology investigation m r a calado conceptualization methodology validation investigation writing review editing s j p s mariano conceptualization methodology software validation investigation supervision resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to express their gratitude to doctor jean raymond bidlot for the provided data and valuable insights on the subject that made this work possible this gratitude is extended to the industry statistician gordon reikard for the initial guidance and kind availability p m r bento gives his special thanks to the fundação para a ciência e a tecnologia fct portugal for the ph d grant sfrh bd 140371 2018 appendix this section introduces the forecasting accuracy for individual locations on each site and for each lead time which shows a more or less uniform forecasting performance that is independent of the chosen location and confirms the seasonal and hourly tendencies highlighted in section v for the different forecasted variables please see tables 1 13 table 1 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 41025 table 1 ndbc 41025 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 6 342 0 166 0 985 6 353 0 139 0 979 5 832 0 072 0 982 5 577 0 141 2 0 981 7 023 0 181 0 983 6 711 0 149 0 975 6 499 0 080 0 980 6 322 0 150 3 0 975 8 237 0 211 0 980 7 658 0 159 0 961 7 791 0 100 0 973 7 765 0 178 6 0 939 12 872 0 325 0 960 11 732 0 227 0 907 13 070 0 155 0 943 10 149 0 254 12 0 712 25 210 0 665 0 871 18 275 0 408 0 815 17 477 0 212 0 888 16 799 0 381 t e 1 0 972 3 078 0 273 0 979 3 446 0 313 0 974 3 268 0 262 0 973 3 327 0 321 2 0 968 3 363 0 291 0 977 3 600 0 324 0 973 3 566 0 274 0 970 3 460 0 334 3 0 964 3 635 0 315 0 972 4 135 0 361 0 966 4 024 0 305 0 966 3 695 0 361 6 0 903 5 634 0 501 0 946 5 765 0 499 0 940 5 875 0 416 0 950 4 785 0 443 12 0 762 9 097 0 755 0 865 9 089 0 779 0 862 8 568 0 597 0 886 7 230 0 653 j 1 0 981 16 880 4 300 0 972 17 061 3 071 0 968 15 337 0 638 0 969 15 036 3 569 2 0 972 24 360 5 183 0 970 18 636 3 205 0 968 15 520 0 652 0 962 20 588 4 101 3 0 949 26 239 7 034 0 968 20 036 3 319 0 950 31 601 0 802 0 957 19 970 4 326 6 0 900 39 833 9 568 0 947 34 034 4 256 0 888 29 842 1 201 0 925 27 796 5 621 12 0 721 54 971 15 244 0 854 49 102 6 802 0 743 39 878 1 710 0 889 34 237 6 833 j indirect 1 0 980 14 157 4 402 0 973 14 250 3 009 0 970 13 118 0 620 0 968 12 980 3 617 2 0 972 15 776 5 293 0 968 14 962 3 268 0 967 14 325 0 652 0 965 14 333 3 791 3 0 967 17 907 5 609 0 966 16 865 3 386 0 950 16 509 0 814 0 961 17 040 4 123 6 0 925 27 496 8 340 0 955 24 588 3 989 0 915 26 047 1 100 0 932 21 539 5 444 12 0 690 52 813 16 364 0 879 36 190 6 588 0 849 33 678 1 421 0 916 34 842 7 424 table 2 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 41048 table 2 ndbc 41048 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 5 056 0 158 0 988 4 992 0 139 0 984 4 245 0 076 0 988 4 763 0 170 2 0 980 5 603 0 179 0 986 5 299 0 152 0 982 4 326 0 081 0 987 5 155 0 178 3 0 971 6 238 0 215 0 984 5 904 0 167 0 981 4 750 0 083 0 983 5 460 0 201 6 0 937 9 251 0 315 0 972 7 798 0 215 0 958 6 728 0 124 0 970 8 407 0 266 12 0 795 15 926 0 550 0 877 14 714 0 447 0 876 11 339 0 211 0 893 15 794 0 495 t e male rmse s 1 0 987 2 033 0 202 0 986 2 306 0 236 0 972 1 934 0 161 0 984 2 138 0 207 2 0 984 2 199 0 222 0 984 2 522 0 248 0 971 1 952 0 163 0 982 2 268 0 221 3 0 975 2 534 0 278 0 980 2 818 0 281 0 963 2 242 0 185 0 973 2 756 0 271 6 0 934 4 366 0 449 0 955 4 136 0 418 0 915 3 162 0 278 0 940 3 926 0 407 12 0 790 7 185 0 762 0 866 7 106 0 709 0 804 5 043 0 410 0 837 6 738 0 643 j 1 0 977 13 392 5 309 0 980 12 097 5 103 0 976 9 814 1 123 0 981 13 328 6 604 2 0 972 14 729 5 939 0 977 14 525 5 737 0 967 10 781 1 301 0 978 14 302 7 077 3 0 947 17 344 8 087 0 975 20 371 5 782 0 968 11 275 1 307 0 974 15 809 7 655 6 0 916 30 403 10 059 0 915 26 550 10 634 0 918 15 881 2 024 0 962 21 257 9 190 12 0 710 45 540 17 846 0 892 35 470 12 608 0 763 25 771 3 439 0 843 37 686 18 456 j indirect 1 0 978 11 122 5 259 0 981 11 015 5 014 0 979 8 978 1 050 0 982 10 451 6 573 2 0 969 12 330 6 216 0 979 11 683 5 470 0 975 9 183 1 166 0 980 11 315 6 757 3 0 953 13 850 7 599 0 976 12 770 5 869 0 976 9 975 1 118 0 970 12 018 8 701 6 0 919 20 503 9 933 0 961 17 046 7 372 0 938 14 060 1 778 0 964 18 613 9 085 12 0 760 35 678 16 353 0 860 31 167 14 011 0 849 23 053 2 733 0 885 35 357 16 137 table 3 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 42001 table 3 ndbc 42001 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 5 400 0 101 0 988 4 986 0 068 0 993 5 348 0 062 0 991 5 399 0 138 2 0 981 5 894 0 109 0 985 5 666 0 078 0 993 5 681 0 065 0 989 5 952 0 150 3 0 970 7 920 0 136 0 978 7 168 0 093 0 990 7 041 0 077 0 983 7 149 0 190 6 0 913 12 196 0 230 0 938 12 556 0 155 0 980 10 030 0 121 0 961 11 056 0 285 12 0 793 21 196 0 343 0 810 19 081 0 266 0 945 17 547 0 211 0 893 14 550 0 464 t e 1 0 983 2 066 0 153 0 981 2 102 0 141 0 983 2 112 0 150 0 991 2 074 0 173 2 0 981 2 347 0 166 0 978 2 378 0 154 0 981 2 272 0 157 0 989 2 288 0 195 3 0 969 3 017 0 211 0 967 3 016 0 188 0 977 2 573 0 177 0 984 2 737 0 238 6 0 925 4 581 0 325 0 914 4 710 0 296 0 952 4 161 0 255 0 965 4 000 0 351 12 0 759 7 801 0 556 0 742 8 050 0 498 0 847 6 762 0 430 0 895 6 272 0 598 j 1 0 972 20 899 1 409 0 981 17 856 0 660 0 991 14 449 0 705 0 977 15 784 5 748 2 0 962 31 990 1 621 0 977 17 235 0 728 0 990 19 314 0 809 0 974 25 042 6 121 3 0 919 35 481 2 326 0 967 22 319 0 874 0 989 25 419 0 890 0 950 25 355 8 437 6 0 794 41 951 3 652 0 907 36 037 1 430 0 969 39 470 1 514 0 927 38 021 10 252 12 0 613 60 297 4 675 0 763 59 352 2 234 0 952 45 229 2 245 0 731 59 624 18 328 j indirect 1 0 968 11 926 1 474 0 982 10 958 0 642 0 992 11 377 0 669 0 980 11 995 5 349 2 0 966 13 101 1 533 0 977 12 499 0 727 0 992 12 113 0 705 0 978 13 087 5 684 3 0 956 17 285 1 740 0 975 15 212 0 749 0 989 14 777 0 850 0 969 15 977 6 786 6 0 875 26 928 2 876 0 932 26 283 1 231 0 983 21 374 1 518 0 937 24 496 9 477 12 0 727 47 555 4 136 0 789 40 861 2 100 0 952 37 518 2 773 0 811 32 560 15 866 table 4 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 42036 table 4 ndbc 42036 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 985 6 160 0 094 0 993 5 525 0 082 0 986 5 786 0 067 0 991 5 179 0 094 2 0 982 6 964 0 103 0 993 5 987 0 082 0 982 6 348 0 074 0 985 6 704 0 119 3 0 972 9 823 0 129 0 989 7 522 0 108 0 975 7 482 0 088 0 974 9 781 0 158 6 0 934 15 738 0 195 0 970 13 483 0 175 0 937 11 438 0 140 0 913 17 152 0 283 12 0 748 28 456 0 367 0 948 17 883 0 236 0 901 14 988 0 174 0 700 27 079 0 496 t e 1 0 964 2 705 0 202 0 972 2 276 0 154 0 985 2 592 0 181 0 988 2 051 0 128 2 0 959 3 179 0 213 0 964 2 664 0 176 0 984 2 640 0 187 0 982 2 635 0 157 3 0 934 3 945 0 272 0 959 2 886 0 187 0 979 3 112 0 211 0 959 3 978 0 234 6 0 842 6 074 0 411 0 917 4 194 0 272 0 953 4 883 0 339 0 883 6 571 0 390 12 0 580 9 831 0 621 0 841 5 905 0 365 0 856 7 817 0 539 0 574 11 707 0 708 j 1 0 975 31 831 0 990 0 990 12 851 1 223 0 982 13 739 0 579 0 987 14 401 1 438 2 0 970 29 477 1 078 0 989 21 323 1 520 0 970 16 887 0 760 0 972 26 062 2 104 3 0 957 37 995 1 283 0 977 25 703 2 019 0 948 23 399 1 101 0 962 27 075 2 438 6 0 901 48 569 1 921 0 976 33 565 2 211 0 848 29 216 1 842 0 873 43 936 4 423 12 0 643 73 045 3 408 0 939 40 478 2 922 0 672 39 815 3 297 0 752 64 066 5 923 j indirect 1 0 976 13 186 0 971 0 989 11 910 1 259 0 985 12 381 0 533 0 988 11 553 1 394 2 0 971 15 358 1 058 0 991 12 771 1 116 0 980 13 429 0 598 0 982 15 065 1 714 3 0 966 21 461 1 151 0 989 15 676 1 388 0 968 16 094 0 802 0 975 22 411 1 994 6 0 930 34 836 1 643 0 985 28 053 1 869 0 889 24 885 1 495 0 911 39 569 3 698 12 0 798 61 966 2 804 0 959 37 550 3 146 0 818 32 745 1 900 0 637 63 580 6 969 table 5 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 42056 table 5 ndbc 42056 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 974 3 978 0 064 0 992 4 005 0 061 0 989 4 120 0 045 0 990 4 873 0 107 2 0 969 4 297 0 069 0 991 4 340 0 064 0 987 4 592 0 050 0 989 5 259 0 112 3 0 959 4 951 0 080 0 990 4 996 0 068 0 983 4 807 0 056 0 987 5 720 0 122 6 0 912 7 333 0 115 0 981 7 348 0 095 0 968 7 015 0 077 0 979 8 342 0 154 12 0 739 11 548 0 189 0 957 12 082 0 147 0 923 11 404 0 120 0 941 14 452 0 257 t e 1 0 937 2 156 0 160 0 974 2 028 0 131 0 975 2 155 0 147 0 986 2 375 0 183 2 0 931 2 285 0 168 0 970 2 223 0 141 0 973 2 289 0 152 0 984 2 560 0 192 3 0 913 2 606 0 188 0 962 2 482 0 158 0 969 2 480 0 165 0 981 2 829 0 211 6 0 843 3 555 0 251 0 934 3 362 0 209 0 893 4 188 0 300 0 964 3 806 0 296 12 0 607 5 391 0 373 0 862 4 733 0 292 0 820 5 532 0 386 0 855 6 968 0 566 j 1 0 959 9 916 0 612 0 986 9 981 0 732 0 988 10 052 0 298 0 981 23 517 1 920 2 0 956 10 629 0 632 0 985 11 025 0 768 0 986 11 308 0 319 0 978 24 508 2 077 3 0 943 12 198 0 713 0 982 13 292 0 850 0 980 16 725 0 394 0 975 24 450 2 191 6 0 864 18 505 1 102 0 978 18 329 0 923 0 967 19 624 0 546 0 957 29 491 2 847 12 0 654 29 118 1 692 0 932 34 940 1 654 0 870 33 755 1 001 0 897 39 930 4 349 j indirect 1 0 962 9 022 0 586 0 987 8 895 0 709 0 989 8 927 0 285 0 980 10 999 1 942 2 0 958 9 673 0 614 0 986 9 565 0 739 0 988 9 843 0 304 0 979 11 734 2 029 3 0 947 11 073 0 693 0 985 10 982 0 771 0 983 10 374 0 359 0 977 12 740 2 097 6 0 897 16 244 0 954 0 976 15 622 0 971 0 973 15 166 0 445 0 968 18 562 2 485 12 0 742 24 691 1 451 0 949 26 043 1 375 0 933 23 954 0 749 0 901 32 579 4 307 table 6 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 44014 table 6 ndbc 44014 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 984 5 834 0 154 0 993 5 284 0 115 0 969 5 962 0 073 0 988 6 081 0 155 2 0 983 6 523 0 163 0 990 6 006 0 144 0 968 6 209 0 075 0 986 6 640 0 173 3 0 969 8 983 0 217 0 990 6 297 0 138 0 953 7 582 0 090 0 982 8 047 0 192 6 0 916 15 090 0 354 0 972 9 210 0 240 0 881 11 557 0 141 0 968 11 550 0 261 12 0 656 27 979 0 668 0 945 13 513 0 343 0 721 17 538 0 209 0 861 21 699 0 519 t e 1 0 980 2 874 0 260 0 988 2 785 0 251 0 969 3 085 0 236 0 978 2 911 0 251 2 0 975 3 177 0 288 0 986 2 942 0 267 0 968 3 263 0 243 0 977 3 193 0 262 3 0 968 3 646 0 326 0 979 3 658 0 332 0 952 3 981 0 296 0 967 3 796 0 312 6 0 933 5 236 0 478 0 954 5 157 0 487 0 882 6 246 0 452 0 934 5 312 0 435 12 0 776 9 287 0 826 0 917 6 889 0 647 0 796 7 920 0 581 0 845 8 178 0 656 j 1 0 977 26 611 4 323 0 988 11 718 4 270 0 955 13 556 0 555 0 983 18 839 3 968 2 0 971 19 375 4 950 0 988 16 595 4 445 0 950 17 002 0 589 0 982 23 897 4 103 3 0 955 23 049 6 104 0 982 17 479 5 359 0 937 18 190 0 658 0 974 32 021 4 940 6 0 842 42 772 11 064 0 938 24 327 9 585 0 826 23 204 1 055 0 944 38 707 7 180 12 0 554 65 477 17 515 0 882 43 899 13 200 0 681 36 804 1 386 0 775 70 288 14 017 j indirect 1 0 977 12 910 4 369 0 989 11 238 4 105 0 959 12 488 0 533 0 985 13 462 3 711 2 0 975 14 264 4 604 0 985 12 687 4 932 0 960 13 121 0 538 0 981 14 648 4 274 3 0 964 19 361 5 611 0 984 13 737 5 022 0 946 15 464 0 625 0 974 17 416 4 886 6 0 919 31 535 8 871 0 950 19 991 8 706 0 867 22 130 0 959 0 961 25 178 6 300 12 0 641 58 803 15 784 0 926 28 913 11 208 0 716 33 103 1 305 0 832 47 030 12 048 table 7 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46001 table 7 ndbc 46001 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 977 6 451 0 336 0 987 5 431 0 200 0 989 5 290 0 113 0 981 6 203 0 261 2 0 972 7 090 0 369 0 986 5 880 0 212 0 986 5 598 0 127 0 979 6 722 0 275 3 0 956 8 819 0 457 0 979 7 684 0 255 0 978 6 133 0 160 0 973 7 978 0 316 6 0 900 13 568 0 682 0 955 11 796 0 372 0 942 11 064 0 261 0 920 13 041 0 530 12 0 695 22 953 1 132 0 870 20 203 0 622 0 882 16 584 0 364 0 855 19 477 0 716 t e 1 0 946 3 659 0 484 0 973 3 218 0 319 0 934 4 382 0 420 0 967 3 165 0 320 2 0 931 4 224 0 545 0 969 3 463 0 338 0 931 4 518 0 429 0 963 3 443 0 339 3 0 916 4 757 0 605 0 962 3 943 0 378 0 927 4 748 0 447 0 952 3 994 0 390 6 0 735 7 182 1 013 0 929 5 352 0 511 0 898 6 027 0 536 0 905 5 421 0 543 12 0 579 9 751 1 220 0 775 8 823 0 876 0 679 9 565 0 867 0 629 9 312 0 982 j 1 0 959 17 904 22 885 0 977 21 248 8 328 0 979 15 041 2 790 0 965 21 444 13 034 2 0 951 22 519 25 310 0 971 39 422 9 434 0 968 16 742 3 442 0 953 21 510 14 865 3 0 935 25 450 28 621 0 962 28 701 10 654 0 971 17 440 3 329 0 955 29 457 14 901 6 0 874 44 863 39 447 0 919 38 587 15 484 0 870 30 231 6 867 0 919 33 293 20 273 12 0 677 58 494 59 806 0 775 56 974 25 049 0 661 45 451 10 626 0 726 53 533 34 966 j indirect 1 0 960 15 206 22 619 0 976 12 701 8 573 0 981 12 725 2 634 0 963 14 394 13 327 2 0 957 16 590 23 934 0 974 13 559 8 926 0 974 13 321 3 119 0 960 15 463 14 040 3 0 933 20 590 29 473 0 968 17 145 10 045 0 958 14 287 3 956 0 954 18 323 15 460 6 0 875 32 099 40 281 0 947 26 225 12 664 0 888 23 931 6 283 0 887 28 872 23 492 12 0 672 52 278 60 903 0 822 44 993 22 397 0 864 33 863 6 985 0 816 44 649 31 015 table 8 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46041 table 8 ndbc 46041 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 978 5 425 0 247 0 979 5 322 0 133 0 985 5 329 0 118 0 982 5 856 0 207 2 0 975 5 946 0 268 0 975 5 829 0 142 0 984 5 772 0 123 0 979 6 315 0 221 3 0 972 6 302 0 281 0 975 6 043 0 144 0 983 6 090 0 131 0 974 7 581 0 249 6 0 937 9 318 0 420 0 952 8 563 0 199 0 972 8 596 0 201 0 956 10 344 0 330 12 0 787 16 557 0 739 0 876 13 828 0 313 0 942 14 616 0 293 0 906 16 279 0 493 t e 1 0 972 2 675 0 402 0 979 2 478 0 273 0 967 2 878 0 292 0 984 2 918 0 352 2 0 965 2 921 0 446 0 977 2 608 0 285 0 964 3 002 0 303 0 981 3 153 0 379 3 0 959 3 383 0 490 0 976 2 787 0 302 0 950 3 391 0 361 0 978 3 350 0 420 6 0 918 5 335 0 722 0 957 3 817 0 405 0 900 4 810 0 509 0 958 4 757 0 579 12 0 659 9 739 1 307 0 876 6 256 0 672 0 766 7 412 0 750 0 862 8 941 1 010 j 1 0 965 13 816 14 477 0 971 13 054 3 228 0 977 12 536 2 628 0 973 19 553 8 529 2 0 959 15 177 15 514 0 967 14 381 3 431 0 971 13 844 2 972 0 967 18 181 9 458 3 0 952 19 468 16 987 0 967 15 032 3 433 0 976 15 283 2 948 0 958 22 415 10 579 6 0 907 23 878 23 663 0 941 25 429 4 585 0 960 24 020 4 011 0 929 31 288 13 843 12 0 637 43 011 42 647 0 901 31 506 6 165 0 862 42 320 7 536 0 845 39 108 19 743 j indirect 1 0 965 12 145 14 469 0 972 11 723 3 189 0 978 11 693 2 570 0 974 12 924 8 364 2 0 959 13 332 15 640 0 969 12 804 3 327 0 978 12 628 2 663 0 969 13 841 9 111 3 0 959 14 300 15 825 0 968 13 264 3 389 0 974 13 215 2 958 0 965 16 533 9 734 6 0 901 21 917 24 463 0 947 18 849 4 443 0 961 18 618 4 663 0 938 22 540 12 812 12 0 662 38 208 41 685 0 885 29 791 6 589 0 938 31 382 6 429 0 888 37 066 18 249 table 9 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46047 table 9 ndbc 46047 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 986 4 727 0 139 0 984 5 048 0 136 0 956 4 254 0 091 0 985 4 557 0 122 2 0 986 4 873 0 142 0 983 5 436 0 142 0 956 4 302 0 091 0 985 4 692 0 124 3 0 984 5 411 0 154 0 978 6 285 0 159 0 951 4 552 0 097 0 982 5 188 0 137 6 0 965 8 037 0 226 0 953 8 707 0 228 0 931 5 324 0 114 0 962 7 482 0 199 12 0 882 14 259 0 401 0 914 13 000 0 310 0 880 6 920 0 148 0 917 11 215 0 282 t e 1 0 979 2 575 0 343 0 977 3 113 0 370 0 973 2 683 0 288 0 987 2 529 0 335 2 0 977 2 768 0 358 0 974 3 310 0 394 0 972 2 758 0 295 0 986 2 732 0 355 3 0 973 3 057 0 391 0 968 3 646 0 435 0 968 2 879 0 311 0 985 2 743 0 364 6 0 936 4 453 0 597 0 943 4 958 0 582 0 960 3 265 0 351 0 973 4 032 0 502 12 0 797 8 167 1 023 0 863 7 214 0 892 0 899 5 150 0 555 0 922 7 169 0 819 j 1 0 975 11 200 4 810 0 969 12 378 3 125 0 942 9 466 1 530 0 973 11 098 3 612 2 0 975 11 957 4 852 0 964 13 345 3 395 0 941 9 482 1 542 0 972 11 627 3 712 3 0 968 15 405 5 469 0 962 13 942 3 476 0 929 10 969 1 687 0 968 12 230 3 992 6 0 952 17 936 6 732 0 937 22 849 4 445 0 925 10 999 1 738 0 951 18 678 4 925 12 0 824 33 177 12 767 0 881 28 056 6 007 0 848 16 278 2 482 0 886 26 828 7 368 j indirect 1 0 976 10 649 4 684 0 968 11 464 3 184 0 943 9 285 1 518 0 973 9 990 3 611 2 0 975 10 730 4 768 0 966 12 345 3 280 0 943 9 407 1 521 0 972 10 542 3 704 3 0 971 11 968 5 211 0 959 14 031 3 595 0 938 9 895 1 579 0 969 11 226 3 928 6 0 948 17 052 7 253 0 928 19 124 4 749 0 920 11 276 1 790 0 941 16 069 5 413 12 0 812 31 629 12 687 0 861 27 433 6 529 0 867 14 891 2 272 0 888 25 158 7 257 table 10 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46083 table 10 ndbc 46083 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 975 5 907 0 209 0 983 5 317 0 092 0 985 5 968 0 113 0 980 6 396 0 300 2 0 973 6 354 0 218 0 981 5 628 0 097 0 984 6 300 0 118 0 978 7 242 0 316 3 0 970 6 722 0 233 0 978 6 077 0 106 0 981 6 829 0 130 0 972 8 085 0 359 6 0 933 9 832 0 345 0 951 8 298 0 156 0 970 9 324 0 176 0 931 12 611 0 556 12 0 827 16 154 0 534 0 880 13 852 0 238 0 935 12 417 0 249 0 808 21 473 0 908 t e 1 0 963 3 602 0 443 0 965 4 294 0 395 0 956 4 534 0 461 0 972 3 617 0 407 2 0 958 3 891 0 475 0 962 4 413 0 408 0 956 4 713 0 462 0 971 3 881 0 417 3 0 953 4 190 0 504 0 957 4 763 0 439 0 953 5 027 0 479 0 959 4 823 0 496 6 0 897 6 317 0 744 0 931 6 025 0 551 0 924 6 813 0 615 0 887 8 203 0 812 12 0 555 11 891 1 380 0 840 9 593 0 833 0 843 9 552 0 850 0 649 13 560 1 326 j 1 0 963 15 412 8 264 0 971 13 305 1 423 0 972 17 225 2 537 0 968 23 664 17 849 2 0 961 18 527 8 445 0 969 13 431 1 466 0 969 17 720 2 667 0 964 32 066 18 806 3 0 941 22 019 10 425 0 966 18 267 1 553 0 964 21 100 2 840 0 948 29 626 22 924 6 0 897 28 386 13 545 0 943 20 312 2 000 0 951 22 323 3 658 0 893 49 541 31 954 12 0 787 44 239 18 974 0 878 25 890 2 861 0 930 36 358 4 331 0 765 73 742 46 219 j indirect 1 0 963 14 033 8 191 0 972 12 535 1 391 0 973 14 993 2 493 0 967 15 095 17 902 2 0 963 15 016 8 319 0 970 13 212 1 458 0 970 15 607 2 603 0 966 16 809 18 289 3 0 957 15 903 9 085 0 968 13 814 1 514 0 968 16 598 2 730 0 958 18 715 20 724 6 0 904 23 310 13 540 0 940 18 085 2 065 0 951 21 557 3 676 0 906 31 049 30 285 12 0 761 38 797 20 171 0 837 28 676 3 278 0 918 28 327 4 818 0 803 52 356 45 116 table 11 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46132 table 11 isdm 46132 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 980 5 094 0 181 0 979 4 518 0 084 0 987 4 784 0 115 0 982 5 404 0 216 2 0 977 5 561 0 192 0 974 4 954 0 092 0 983 5 780 0 134 0 977 6 680 0 247 3 0 972 6 345 0 216 0 965 5 815 0 107 0 982 6 617 0 138 0 968 7 772 0 292 6 0 931 9 364 0 332 0 912 8 928 0 167 0 941 11 413 0 246 0 903 12 792 0 498 12 0 824 14 656 0 516 0 766 14 517 0 265 0 870 18 721 0 372 0 787 20 428 0 726 t e 1 0 972 2 669 0 355 0 980 2 282 0 227 0 978 2 786 0 280 0 983 2 396 0 303 2 0 970 2 848 0 370 0 978 2 434 0 242 0 974 2 968 0 299 0 979 2 745 0 337 3 0 961 3 355 0 422 0 975 2 630 0 255 0 956 3 594 0 389 0 971 3 283 0 399 6 0 894 5 495 0 684 0 949 3 906 0 365 0 890 5 332 0 604 0 930 5 540 0 609 12 0 702 8 944 1 069 0 872 6 279 0 570 0 652 9 338 1 024 0 850 7 896 0 909 j 1 0 964 12 465 6 967 0 961 10 136 1 053 0 977 11 221 2 755 0 971 14 716 9 913 2 0 962 12 712 7 228 0 955 12 267 1 146 0 976 12 686 3 175 0 963 16 517 11 259 3 0 946 17 630 8 562 0 944 14 438 1 265 0 969 13 801 3 246 0 954 20 272 12 514 6 0 891 21 718 12 167 0 826 21 786 2 158 0 907 27 657 5 850 0 896 27 249 19 016 12 0 736 36 271 17 917 0 662 30 202 2 873 0 830 43 573 7 464 0 653 50 993 31 595 j indirect 1 0 964 11 593 7 029 0 965 9 542 1 002 0 976 10 309 2 852 0 972 12 019 9 844 2 0 963 12 543 7 106 0 958 10 550 1 104 0 972 12 478 3 229 0 967 14 633 10 702 3 0 955 14 133 7 985 0 949 11 945 1 205 0 978 13 808 2 832 0 953 16 828 12 703 6 0 888 20 679 12 152 0 877 18 138 1 837 0 923 22 480 5 182 0 892 27 017 19 375 12 0 773 31 888 16 776 0 698 28 874 2 735 0 861 37 216 7 417 0 792 44 135 27 994 table 12 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 46207 table 12 isdm 46207 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 976 5 557 0 257 0 985 4 779 0 162 0 992 4 918 0 115 0 983 5 734 0 256 2 0 971 5 907 0 284 0 982 5 283 0 178 0 989 5 546 0 132 0 981 6 455 0 269 3 0 962 6 898 0 323 0 976 6 187 0 206 0 982 6 660 0 166 0 972 8 031 0 333 6 0 897 11 004 0 529 0 942 9 238 0 316 0 935 11 539 0 315 0 925 13 350 0 539 12 0 671 19 423 0 881 0 774 17 938 0 600 0 881 15 232 0 430 0 761 23 174 0 909 t e 1 0 970 2 780 0 374 0 984 2 272 0 255 0 974 2 662 0 277 0 986 2 137 0 261 2 0 962 3 164 0 419 0 982 2 472 0 271 0 973 2 807 0 285 0 983 2 475 0 290 3 0 949 3 780 0 492 0 979 2 693 0 293 0 962 3 317 0 336 0 975 3 044 0 349 6 0 890 5 714 0 749 0 951 4 338 0 454 0 926 4 503 0 466 0 937 5 074 0 574 12 0 403 11 054 1 423 0 880 6 827 0 694 0 815 6 804 0 719 0 808 8 202 0 941 j 1 0 966 14 193 15 517 0 974 13 912 5 377 0 987 13 477 3 034 0 971 14 667 13 029 2 0 955 16 644 17 997 0 967 17 854 6 055 0 984 13 737 3 347 0 966 17 944 14 563 3 0 945 18 470 19 742 0 962 19 715 6 491 0 967 20 018 4 726 0 960 22 002 15 394 6 0 851 28 211 31 989 0 880 33 577 11 283 0 893 29 832 8 432 0 897 38 237 25 079 12 0 474 49 851 54 372 0 684 44 570 17 335 0 664 50 943 14 126 0 651 60 925 41 858 j indirect 1 0 967 12 498 15 290 0 973 10 526 5 515 0 987 10 634 3 046 0 973 12 408 12 798 2 0 956 13 614 17 708 0 969 11 660 5 867 0 981 11 878 3 659 0 972 13 929 13 015 3 0 946 16 081 19 683 0 959 13 438 6 744 0 963 14 447 5 013 0 957 17 269 16 004 6 0 864 25 842 30 460 0 907 20 061 10 204 0 889 24 334 8 610 0 909 29 155 24 034 12 0 568 46 627 49 834 0 708 37 095 17 160 0 800 31 113 11 657 0 752 49 935 37 157 table 13 error metrics for the different forecasting horizons and forecasted variables t e h m 0 j j i n d i r e c t station 51001 table 13 ndbc 51001 h m 0 winter month spring month summer month fall month horizon error e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 e 1 e 2 e 3 1 0 985 4 111 0 164 0 963 4 914 0 120 0 973 3 972 0 095 0 981 4 693 0 150 2 0 984 4 358 0 173 0 959 5 242 0 125 0 971 4 156 0 099 0 979 4 751 0 154 3 0 983 4 609 0 181 0 955 5 418 0 132 0 969 4 258 0 103 0 977 5 124 0 162 6 0 968 6 287 0 244 0 936 6 579 0 156 0 957 5 102 0 119 0 967 6 187 0 194 12 0 930 9 023 0 357 0 869 9 396 0 219 0 914 7 093 0 166 0 933 9 985 0 297 t e 1 0 980 2 393 0 314 0 971 3 221 0 347 0 887 2 572 0 220 0 988 2 137 0 243 2 0 976 2 588 0 341 0 967 3 455 0 369 0 880 2 631 0 226 0 986 2 289 0 261 3 0 970 2 884 0 378 0 963 3 575 0 389 0 870 2 832 0 235 0 985 2 374 0 268 6 0 946 4 097 0 515 0 946 4 260 0 473 0 845 3 020 0 254 0 967 3 292 0 413 12 0 729 8 475 1 073 0 922 5 322 0 572 0 789 3 489 0 292 0 854 6 244 0 815 j 1 0 981 9 963 8 169 0 941 12 377 2 616 0 958 10 063 1 513 0 970 11 832 4 608 2 0 981 10 515 8 262 0 934 13 436 2 759 0 959 10 468 1 508 0 968 11 554 4 727 3 0 977 11 497 9 015 0 937 13 846 2 702 0 953 11 210 1 617 0 965 12 990 4 908 6 0 951 17 799 13 134 0 923 16 253 2 990 0 945 11 812 1 735 0 942 17 079 6 391 12 0 921 27 059 16 624 0 824 23 106 4 380 0 883 16 203 2 487 0 870 25 588 9 569 j indirect 1 0 982 9 347 7 993 0 943 11 681 2 573 0 961 9 405 1 464 0 972 10 523 4 421 2 0 981 9 883 8 173 0 938 12 540 2 685 0 957 9 822 1 537 0 968 10 741 4 734 3 0 978 10 528 8 965 0 933 12 908 2 783 0 954 10 069 1 596 0 967 11 492 4 857 6 0 968 14 444 10 740 0 922 15 164 3 029 0 945 11 482 1 758 0 953 13 233 5 769 12 0 917 23 725 17 252 0 845 21 487 4 187 0 894 14 949 2 372 0 905 23 129 8 820 
