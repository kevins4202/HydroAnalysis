index,text
23215,this paper aims to solve the problem that a single control method can t fit to each operating condition of heading control for autonomous underwater vehicle auv a multi mode strategy based on soft switching is proposed which can get better performance by smooth switching of control modes the control mode consists of two levels which is named as two level mode method on the first level the control mode is divided into six according to the operating state of auv on the second level based on the existing mode the control mode is divided into three depending on auv speed in addition the bb pid controller is designed for heading control as well as the sigmoid function is constructed to smoothly switching at different speed without saltation the simulation and experiment results demonstrate that bb pid controller achieves outstanding performance and the switching strategy is much more effective by comparing the rms rmse sse between switching based on sigmoid function and switching based on threshold keywords autonomous underwater vehicle auv multi mode control two level mode switching based on sigmoid function sbos 1 introduction the control of auv is mainly divided into two types horizontal heading control and vertical depth control especially the heading which controls the trajectory of auv is a key technique much more research in recent decades has focused on this issue the control strategies chiefly include pid controller jalving 1994 khodayari and balochian 2015 chen et al 2009 sliding mode controller wang et al 2012 rosendo et al 2016 cui et al 2016 h controller silvestre and pascoal 2007 mahapatra and subudhi 2017 and adaptive controller hassanein et al 2016 etc however heading control of auv is so difficult due to coupled nonlinearities parameter uncertainties resulting from poor knowledge of hydrodynamic coefficients and external disturbances such as ocean currents and waves the motion characteristics of auv are quite different under a great variety of disparate operating conditions hence there is no method can get excellent control efficiency under all of the operating condition and unfortunately some methods may perform better in this condition but much worse in another condition consequently it is necessary to study the control strategy for auv the multi mode control is a changing control strategy with the running state of the system in accordance with the actual operation of the system the most appropriate real time control algorithm can be selected with the intelligent multi mode control it can usually achieve a variety of comprehensive advantages of control strategy so that the control performance of complex systems can get the best performance this method has been explored and applied in military engineering automobile electric power and other industries and that works well the multi mode control based on neural network for laser guidance missile provides good control over the nonlinear time varying system with wide variation of parameters shen et al 2000 a multi mode control strategy based on fuzzy selector can get perfect control effect for the four wheel steering vehicle yang et al 2010 meanwhile it demonstrates that the multi mode control has better control effect than single one the converter of a direct drive permanent magnetic wind generation system in a micro grid adopts an adaptive multi mode power control algorithm he et al 2013 the maximum power point tracking algorithm is faster more robust and adaptive to changes of the environment than the conventional variable step hill climbing search algorithm for primary side regulation psr system four mode control strategy improves the efficiency under variety load conditions the average efficiency can be improved about 3 6 compared with conventional system and the standby power is less than 10 mw under different conditions liu et al 2017 a real time multi mode energy management strategy for a plug in fuel cell battery electric vehicle taking three typical processes starting up normal working shutting down into consideration the strategy reduces fuel consumption and prolongs working lifetime of the fuel cell battery system xu et al 2014 accordingly it is feasible to apply the multi mode control in auv however in the literature reviewed the multi mode control strategy hasn t previously been reported for heading control of auv the major contributions of this work are highlighted as follows a this two level mode method is proposed to divide the control mode on the first level the control mode is divided into six according to the operating state of auv on the second level based on the existing mode the control mode is divided into three depending on auv speed b the bb pid controller is designed by utilizing the complementary advantages of bang bang pid and output hold methods according to the characteristics of each mode in this paper the heading controller at middle speed is taken as an example which is much the same as the high and low speed c the soft switching strategy based on sigmoid function is proposed for heading control at different speed the steady state output of the two controllers is employed as the upper and lower bounds of the sigmoid function within a small range before and after the switching time the transition process of the controller is changed in accordance with the sigmoid function with the help of the saturated monotonic and smooth features of the sigmoid function the switching is also stable and smooth the remainder of this paper is organized as follows after a dynamic model of auv in the next section the division of control mode and the controller design are explained in section 3 section 4 describes the switching of control mode based on sigmoid function in section 5 a set of experimental comparisons are carried out in terms of accuracy and speed by simulations and experiments while the results are also being discussed finally section 6 summarizes the key conclusions of this work 2 vehicle model 2 1 establishing coordinate system the notation term and coordinate system are defined by sname society of naval architects and marine engineers 1950 the world fixed coordinate system e ξηζ has its origin e fixed to the earth the body fixed coordinate system o xyz with origin o is moving reference frame that is fixed to auv see fig 1 for auv the six different motion components are conveniently defined as surge u sway v heave w roll p pitch q and roll r v u v w p q r t is the linear angular velocity with respect to the body fixed reference frame and τ x y z k m n t is the total forces and moments acting on auv the euler angles are heading angle ψ pitch angle θ and roll angle φ the notations are summarized in table 1 2 2 dynamic model of auv in general the force on auv can be divided into two categories the one is the hydrodynamic force f v i s or the resistance force due to a vehicle moving in fluid the other is the external force f e l s e such as the rudder force propulsion force gravity and buoyancy etc the equation can be expressed as equation 1 prestero 2001 liu et al 2015 fossen 2011 1 e v f v i s f e l s e where e is defined as equation 2 considering xz plane of symmetry pot starboard symmetry 2 e m x u 0 0 0 m z g 0 0 m y v 0 m z g y p 0 y r 0 0 m z w 0 z q 0 0 m z g y p 0 i x k p 0 k r m z g 0 z q 0 i y m q 0 0 y r 0 k r 0 i z n r where m auv mass z g barycentric coordinate of auv i x i y i z moments of inertia about x y and z axes x u y v y r z w z q k p k r m q n v n r hydrodynamic coefficients v u v w p q r t velocity angular velocity of six degrees of freedom v u v w p q r t acceleration angular acceleration of six degrees of freedom f v i s x v i s y v i s z v i s k v i s m v i s n v i s t hydrodynamic forces and moments 3 x v i s m v r w q 1 2 ρ l 4 x q q q 2 x r r r 2 x r p r p 1 2 ρ l 3 x v r v r x w q w q 1 2 ρ l 2 x u u u 2 x v v v 2 x w w w 2 y v i s m w p v r 1 2 ρ l 4 y p q p q y q r q r 1 2 ρ l 3 y v q v q y w p w p y w r w r 1 2 ρ l 3 y r u r y p u p y v r v v v 2 w 2 1 2 r 1 2 ρ l 2 y 0 u 2 y v u v y v v v 2 w 2 1 2 y v w v w z v i s m u q v p 1 2 ρ l 4 z p p p 2 z r r r 2 z r p r p 1 2 ρ l 3 z v r v r z v p v p 1 2 ρ l 3 z q u q z w q w w v 2 w 2 1 2 q 1 2 ρ l 2 z 0 u 2 z w u w z w w w v 2 w 2 1 2 1 2 ρ l 2 z w u w z w w w v 2 w 2 1 2 1 2 ρ l 2 z v v v 2 k v i s m z g v r w p 1 2 ρ l 5 k q r q r k p q p q k p p p p 1 2 ρ l 4 k p u p k r u r 1 2 ρ l 4 k v q v q k w p w p k w r w r 1 2 ρ l 3 k 0 u 2 k v u v k v v v v 2 w 2 1 2 1 2 ρ l 3 k v w v w m v i s m z g v r w q 1 2 ρ l 5 m p p p 2 m r r r 2 m r p r p m q q q q 1 2 ρ l 4 m v r v r m v p v p 1 2 ρ l 4 m q u q m w q v 2 w 2 1 2 q 1 2 ρ l 3 m 0 u 2 m w u w m w w w v 2 w 2 1 2 1 2 ρ l 3 m w u w m w w w v 2 w 2 1 2 1 2 ρ l 3 m v v v 2 i z i x p r n v i s 1 2 ρ l 5 n p q p q n q r q r n r r r r 1 2 ρ l 4 n w r w r n w p w p n v q v q 1 2 ρ l 4 n p u p n r u r n v r v 2 w 2 1 2 r 1 2 ρ l 4 n 0 u 2 n v u v n v v v v 2 w 2 1 2 1 2 ρ l 3 n v w v w i x i y p q for an auv sailing in the sea it is influenced by the ambient environment in the area of 0 100 m below sea level the seawater is approximately homogeneous mixing layer hu et al 2000 liu et al 2001 daryabor et al 2016 the influence of temperature salinity and density of sea water on the heading of auv can be neglected while only the ocean current should be taken into account assuming that the ocean current is parallel to the horizontal plane of the world fixed coordinate system and the ocean current velocity is a constant in presence of ocean current the relative speed is depicted in equation 4 4 u r u u c cos θ cos α ψ v r v u c sin θ w r w u c sin θ cos α ψ where u c is the current velocity of irrotational fluid and α is the angle of current after the time derivative equation 4 can be written in component form as equation 5 5 u r u u c q sin θ cos α ψ u c r cos θ sin α ψ v r v u c sin α ψ w r w u c cos θ cos α ψ u c r sin θ sin α ψ then the parameters v v are changed as follows 6 v u u r v v r w w r p q r v u u r v v r w w r p q r 2 3 equation of motion in horizontal plane in order to analyze the manipulating motion the equation of motion can be divided into two noninteracting subsystems the horizontal subsystem the vertical subsystem the following assumptions will applied to the dynamic model the auv only moves at low speed and the center of gravity is in the origin of the body fixed coordinate system neglecting the elements corresponding to heave roll and pitch the horizontal equation of motion is generalized in equation 7 7 m u v r x m v u r y i z r n the x equation can be eliminated which is based on the assumption that cruise speed u is a constant and u is zero the fore and aft of auv are asymmetrical therefore the linearized maneuvering equation can be written in equation 8 8 m y v v y v v y r r m v y r r y δ δ i z n r r n r r n v v n v v n δ δ due to starboard port symmetry of auv y r and n v are zero given t y y δ n y n δ equation 8 simplifies to equation 9 9 m y v v y v v m v y r r t y i z n r r n r r n v v n y ignoring the element corresponding to roll finally yields 10 b 2 v b 1 v b 0 v i z n r t y n r t y m v y r n y where b 2 i z n r m y v b 1 y v i z n r n r m y v b 0 n v m v y r y v n r hence application of laplace transformation yields 11 g 1 s i z n r s n r b 2 s 2 b 1 s b 0 3 controller design 3 1 division of control mode the control mode represents a mapping relationship between input and output of the controller that is a kind of control law existing as the priori knowledge fewer reported studies have addressed the division of control mode for auv in the published literature in this paper the two level mode method is defined the first level is divided into six modes with respect to the operating state of auv on the basis of existing modes the second level is divided into three due to auv s speed appearing in fig 2 this paper focuses on the mode control of heading control at middle speed which is limited by trial conditions the control mode set is φ as shown in equation 12 12 φ φ 11 φ 12 φ 13 φ 21 φ 22 φ 23 φ 31 φ 32 φ 33 φ 41 φ 42 φ 43 φ 51 φ 52 φ 53 φ 61 φ 62 φ 63 where low speed u 1 m s middle speed 1 0 m s u 2 m s high speed u 2 0 m s φ 11 turning at low speed φ 12 turning at middle speed φ 13 turning at high speed φ 21 heading control at low speed φ 22 heading control at middle speed φ 23 heading control at high speed φ 31 trace following at low speed φ 32 trace following at middle speed φ 33 trace following in high speed φ 41 height control at low speed φ 42 height control at middle speed φ 43 height control at high speed φ 51 pitch control at low speed φ 52 pitch control at middle speed φ 53 pitch control at high speed φ 61 depth keeping at low speed φ 62 depth keeping at middle speed φ 63 depth keeping at high speed 3 2 design of controller each control mode has its own proper controller the heading controller is designed at middle speed which is much the same as the high and low speed the heading deviation and its changing rate are divided into three areas tu 1997 chen et al 1997 as shown in fig 3 area 1 φ 521 e h w 1 area 2 φ 522 e h w 2 e h v 1 area 3 φ 523 w 2 e h w 1 it is the advantages features of bang bang control algorithm maurer and osmolovskii 2004 are fast regulation strong anti interference ability and so on the pid algorithm can eliminate the steady state error it is convenient to implement these methods in engineering the specific design is as follows a when the heading deviation e h is very large in the area 1 the bang bang control algorithm is imposed b when the heading deviation e h and changing rate of heading deviation e h are very small the output hold control algorithm is adopted in the area 2 c when the heading deviation e h and changing rate of heading deviation e h are in the area 3 the pid control algorithm is used the control algorithm set is described as ψ 22 ψ 221 ψ 222 ψ 223 13 ψ 221 u n s g n u m a x ψ 222 u n u n 1 ψ 223 u n k p e h k i e h d t k d e h the symbols are expounded as following u n the nth output of the controller u m a x the maximum output of the controller e h the deviation of the heading e h the heading deviation change rate k p the proportional coefficient k d the differential coefficient k i the integral coefficient w 1 w 2 the threshold of e h v 1 the threshold of e h 4 switching of control modes there are two major types of switching for control mode the one is hard switching shen et al 2000 or threshold switching which is more common in industrial control as illustrated in fig 4 when the input is greater or less than the set point the switching action begins to take effect however it is easy to lead to the saltation of the control signal when one mode controller works and the other is in a non operating state the heading will instantly become larger or smaller due to threshold switching so it is difficult to satisfy the requirements of smooth sailing for auv the other is the soft switching boskovic and mehra 2000 weller and goodwin 1992 chen et al 2010 zhuang et al 2017 in order to prevent the control variables from saltationdue to threshold switching the method of soft switching based on fuzzy logic can be used to replace the threshold switching the structure diagram of soft switching is illustrated in fig 5 after an amount of prior knowledge is used to determine the input and the output fuzzy segmentation is performed the membership function reasoning method fuzzy rule and defuzzification method are determined to realize the fuzzy switching controller the output of control signal is changed slowly so as to achieve switching without disturbance however it is difficult to get a better operating experience for auv it is quite hard to set membership function and obtain the method of fuzzy inference defuzzification and fuzzy rule these parameters will directly affect the control effect therefore the complexity of parameter adjustment limits the application of fuzzy switching control in the motion of auv in order to solve the problem of saltation of threshold switching and fuzzy switching requiring a large amount of prior knowledge and parameter adjustment a viable approach of soft switching based on sigmoid function is proposed in this context the steady state output of the two controllers is employed as the upper and lower bounds of the sigmoid function within the small range before and after the switching time the transition process of the controller is changed in accordance with the sigmoid function the structure of soft switching based on sigmoid function is illustrated in fig 6 4 1 sigmoid function sigmoid function is a kind of important activation function in neural networks which is smoothness strict monotonicity and saturation its general expression is as shown in equation 14 14 f x a c k 1 e a x c d where a denotes the tilt parameter c is the offset the parameter a controls the slope of the sigmoid function c controls its offset along the x axis and d controls its offset along the y axis as seen in fig 7 napoles et al 2017 as shown in fig 7 a when a is greater than zero the sigmoid function becomes steeper and approximates to the threshold function owing to a increasing the sigmoid function approximates to the linear function owing to a decreasing when a is less than zero it is contrary to the above as shown in fig 7 b when x approximates to the positive infinity y is close to one when x approximates to the negative infinity y is close to zero the symmetry center is 0 0 5 when c is greater than zero the curve moves rightward while c is less than zero the curve moves leftward correspondingly symmetry center is changed as shown in fig 7 c the sigmoid function output will alter due to the numerator the numerators of the red green curve and blue curves are one two and three respectively as shown in fig 7 d the sigmoid function moves as a whole along with y axis green curve moves up one and blue curve moves up two therefore the corresponding range also changes due to these properties of sigmoid function the switching function can be designed to satisfy the requirements in this paper 4 2 design of switching function it is assumed that the output of control mode 1 is u 1 and the output of control mode 2 is u 2 a is obtained by running the program several times until a satisfactory performance is achieved and c is the switching time a sigmoid function candidate for this system is described in equation 15 and fig 8 for instance when auv accelerates from low speed to middle speed the controller has been switched from φ 21 to φ 22 considering the operating conditions of auv the parameters are chosen as a 2 c 500 k u 1 u 2 d u 1 before and after the switching time the controller 1 fades out and the controller 2 fades in the sigmoid function is to connect u 1 and u 2 whose value is used as the output of the controller during switching with the help of the saturated monotonic and smooth features of the sigmoid function the switching is also stable and smooth 15 f x a c u 1 u 2 1 e 2 x 500 u 1 the method only needs to adjust the tilt parameter a according to the switching process the switching time and steady state output of the two controllers are known compared with threshold switching there is no saltation and the whole switching is smooth and stable the results report in section 5 5 simulation and experiment 5 1 simulation 5 1 1 performance of single mode the control effects with respect to the same pid parameters for heading control at middle and high speed are given in fig 9 the pid parameters is adjusted at the speed of 1 5 m s when the speed increases to 2 5 m s the control effect with the same pid parameter has been weakened such as longer rise time and bigger overshoot the results are summarized in table 2 when the current is taken into account the conclusion is similar to the previous analysis it is obvious that any single control method can t suit to every operating condition each operating state of auv should has its own control strategy or parameters 5 1 2 controller performance the control performance of pid and bb pid is given in fig 10 the control parameters are adjusted to ensure that there is no overshoot for these two methods in terms of the adjusting time the bb pid adjusting time is less than pid without current as shown in fig 10 pink and black the bb pid hardly gets affected by current as shown in fig 10 black and red the adjusting time of bb pid in both the presence and absence of current is 35s and 31s respectively the steady state errors are both 0 5 the pid control effect is greatly influenced by current as shown in fig 10 pink and green the results are reported in table 3 the adjusting time of pid in both the presence and absence of current is 74s and 54s respectively the steady state errors are 1 7 and 2 3 respectively as shown in table 3 under the circumstance of current the adjusting time of bb pid is half of the pid and the steady state error is about one fifth in fig 10 the velocity of auv is 1 5 m s current velocity u c is 0 5 m s and angle of current α is 45 simulation results indicate that the satisfied performance such as overshootanti interference adjusting time and steady state error is achieved the bb pid control is superior to the conventional pid control 5 1 3 switching of control modes the change of rudder angle during switching based on two methods is depicted in fig 11 when auv accelerates from 1 5 m s to 2 5 m s the controller has been switched from control mode φ 22 to control mode φ 23 there is a saltation of the rudder and the overshoot is close to 18 6 as shown in fig 11 green sbos switching based on sigmoid function has no overshoot and the switching is smooth and stable simulation results suggest that the sbos gets better the heading control during switching based on two methods is depicted in fig 12 a partial magnification is depicted in fig 12 b the steady state errors of sbot switching based on threshold and sigmoid function are 0 5 and 0 08 respectively it can be seen from the magnified figure that sbot has obvious saltation whereas sbos has no saltation and low steady state error which can ensure heading smooth and steady simulation results suggest that sbos can effectively eliminate saltation and improve steady state error and it is reliable and effective 5 2 experiment the method proposed in this paper is validated on the sailfish auv a kind of torpedo underwater vehicle independently developed at underwater vehicle lab of the ocean university of china it is mainly to realize autonomous navigation and control in various underwater environments sailfish displacement is 73 kg it measures 210 cm in length 21 cm in diameter as shown in fig 13 5 2 1 performance of single mode it is given the heading control of three speeds with the same pid parameters in fig 14 the desired heading is 270 and 180 respectively the parameters are adjusted at low speed 0 5 m s when the speed gradually goes up the control effect of auv starts to deteriorate auv oscillates around the desired heading at speed of 1 5 m s the experimental results verify that a single control mode doesn t match the whole control system there is a need for a new operating mode to meet the requirement of control performance 5 2 2 controller performance the experiment effect of bb pid control in the lake is shown in fig 15 the overshoot is 0 76 the steady state error is 0 9 and the adjusting time is 30s the results are reported in table 4 the rudder is not frequently operated the actual control further shows that the control strategy allows better control of steady state error and overshoot this method is better because of its simple structure high reliability and easily implementation as a breeze in the lake the actual heading fluctuates slightly 5 2 3 switching the comparison of switching with two methods is sketched in fig 16 the red represents the heading of sbos while the blue represents the heading of sbot the trial has been carried out on april 24 2018 at tuandao bay qingdao in a sunny day an air temperature of about 15 c the speed of south wind is 8 10 knots and the waves is up to 0 6 1 0 m high the heading is set to 180 the low speed is 0 7 m s in control mode φ 21 while the middle speed is 1 5 m s in control mode φ 22 when the speed exceeds 1 0 m s the control mode has been switched from φ 21 to φ 22 in general the switching will be delayed since the speed needs several seconds to accelerate tables 5 7 tabulate the maximum minimum rms root mean square rmse root mean square and sse steady state error of heading with respect to these two methods at the beginning from 755s to 765s the amplitude of the heading oscillations keeps between 181 8910 and 178 6777 and the rms rmse and sse are 180 2819 0 9732 and 0 8387 respectively with regard to sbos the maximum and minimum of the heading are 180 6708 and 178 7361 and the rms rmse and sse are 179 8482 0 6855 and 0 5810 respectively with regard to sbot see table 5 there are slight changes in performance between these two methods with the same pid parameters whereas they both satisfy the requirement of control table 6 reports the switching results with these two methods from 765s to 788s there are obvious distinctions between the two methods the rmse of sbot is 2 9764 which is more than three times as big as sbos the sse of sbot is 2 6542 which is more than three times as big as sbos too the rms of sbos is 179 8482 which is closer to the desired heading than sbot the heading of sbos fluctuates around desired heading whose bias is about 2 whereas the heading of sbos fluctuates around 182 far from desired heading it is particularly evident in heading that the sbos performs more excellent than sbot after the switching from 789s to 797s the control is stable in sbos the amplitude of the heading oscillations keeps between 182 1386 and 178 0646 and the rms rmse and sse are 179 5730 1 2606 and 1 0994 respectively in sbot the amplitude of the heading oscillations keeps between 182 9361 and 180 0082 and the rms rmse and sse are 181 6194 1 8142 and 1 6194 respectively the results are summarized in table 7 due to the current and wave the performance is little different from table 5 6 conclusion in this paper a multi mode strategy based on soft switching for auv s heading is investigated first the two level mode method is proposed to divide the control modes the first level is divided upon the operating state of auv based on the existing modes the second level is divided into three according to auv s speed simulations and experiments have shown that the two level mode has good robustness accuracy and rationality second the bb pid controller is designed for the heading control which is beneficial to the realization of the project the bang bang algorithm has the advantages of fast regulation strong anti interference ability and so on the integration of the pid algorithm eliminates the steady state error by contrast with traditional pid the satisfactory performance such as overshoot anti interference rise time and steady state error has been achieved last the smooth switching between two modes is realized by introducing the sigmoid function compared with sbot the proposed method is expected to reduce disturbance simulation and experiment results have demonstrated that the method is correct and effective in the future the controller will be designed for the other modes soft switching on the first level will be carried out and cluttered environments will be taken into consideration acknowledgement this work is partially supported by the natural key research and development program of china 2016yfc0301400 and natural science foundation of china 51379198 
23215,this paper aims to solve the problem that a single control method can t fit to each operating condition of heading control for autonomous underwater vehicle auv a multi mode strategy based on soft switching is proposed which can get better performance by smooth switching of control modes the control mode consists of two levels which is named as two level mode method on the first level the control mode is divided into six according to the operating state of auv on the second level based on the existing mode the control mode is divided into three depending on auv speed in addition the bb pid controller is designed for heading control as well as the sigmoid function is constructed to smoothly switching at different speed without saltation the simulation and experiment results demonstrate that bb pid controller achieves outstanding performance and the switching strategy is much more effective by comparing the rms rmse sse between switching based on sigmoid function and switching based on threshold keywords autonomous underwater vehicle auv multi mode control two level mode switching based on sigmoid function sbos 1 introduction the control of auv is mainly divided into two types horizontal heading control and vertical depth control especially the heading which controls the trajectory of auv is a key technique much more research in recent decades has focused on this issue the control strategies chiefly include pid controller jalving 1994 khodayari and balochian 2015 chen et al 2009 sliding mode controller wang et al 2012 rosendo et al 2016 cui et al 2016 h controller silvestre and pascoal 2007 mahapatra and subudhi 2017 and adaptive controller hassanein et al 2016 etc however heading control of auv is so difficult due to coupled nonlinearities parameter uncertainties resulting from poor knowledge of hydrodynamic coefficients and external disturbances such as ocean currents and waves the motion characteristics of auv are quite different under a great variety of disparate operating conditions hence there is no method can get excellent control efficiency under all of the operating condition and unfortunately some methods may perform better in this condition but much worse in another condition consequently it is necessary to study the control strategy for auv the multi mode control is a changing control strategy with the running state of the system in accordance with the actual operation of the system the most appropriate real time control algorithm can be selected with the intelligent multi mode control it can usually achieve a variety of comprehensive advantages of control strategy so that the control performance of complex systems can get the best performance this method has been explored and applied in military engineering automobile electric power and other industries and that works well the multi mode control based on neural network for laser guidance missile provides good control over the nonlinear time varying system with wide variation of parameters shen et al 2000 a multi mode control strategy based on fuzzy selector can get perfect control effect for the four wheel steering vehicle yang et al 2010 meanwhile it demonstrates that the multi mode control has better control effect than single one the converter of a direct drive permanent magnetic wind generation system in a micro grid adopts an adaptive multi mode power control algorithm he et al 2013 the maximum power point tracking algorithm is faster more robust and adaptive to changes of the environment than the conventional variable step hill climbing search algorithm for primary side regulation psr system four mode control strategy improves the efficiency under variety load conditions the average efficiency can be improved about 3 6 compared with conventional system and the standby power is less than 10 mw under different conditions liu et al 2017 a real time multi mode energy management strategy for a plug in fuel cell battery electric vehicle taking three typical processes starting up normal working shutting down into consideration the strategy reduces fuel consumption and prolongs working lifetime of the fuel cell battery system xu et al 2014 accordingly it is feasible to apply the multi mode control in auv however in the literature reviewed the multi mode control strategy hasn t previously been reported for heading control of auv the major contributions of this work are highlighted as follows a this two level mode method is proposed to divide the control mode on the first level the control mode is divided into six according to the operating state of auv on the second level based on the existing mode the control mode is divided into three depending on auv speed b the bb pid controller is designed by utilizing the complementary advantages of bang bang pid and output hold methods according to the characteristics of each mode in this paper the heading controller at middle speed is taken as an example which is much the same as the high and low speed c the soft switching strategy based on sigmoid function is proposed for heading control at different speed the steady state output of the two controllers is employed as the upper and lower bounds of the sigmoid function within a small range before and after the switching time the transition process of the controller is changed in accordance with the sigmoid function with the help of the saturated monotonic and smooth features of the sigmoid function the switching is also stable and smooth the remainder of this paper is organized as follows after a dynamic model of auv in the next section the division of control mode and the controller design are explained in section 3 section 4 describes the switching of control mode based on sigmoid function in section 5 a set of experimental comparisons are carried out in terms of accuracy and speed by simulations and experiments while the results are also being discussed finally section 6 summarizes the key conclusions of this work 2 vehicle model 2 1 establishing coordinate system the notation term and coordinate system are defined by sname society of naval architects and marine engineers 1950 the world fixed coordinate system e ξηζ has its origin e fixed to the earth the body fixed coordinate system o xyz with origin o is moving reference frame that is fixed to auv see fig 1 for auv the six different motion components are conveniently defined as surge u sway v heave w roll p pitch q and roll r v u v w p q r t is the linear angular velocity with respect to the body fixed reference frame and τ x y z k m n t is the total forces and moments acting on auv the euler angles are heading angle ψ pitch angle θ and roll angle φ the notations are summarized in table 1 2 2 dynamic model of auv in general the force on auv can be divided into two categories the one is the hydrodynamic force f v i s or the resistance force due to a vehicle moving in fluid the other is the external force f e l s e such as the rudder force propulsion force gravity and buoyancy etc the equation can be expressed as equation 1 prestero 2001 liu et al 2015 fossen 2011 1 e v f v i s f e l s e where e is defined as equation 2 considering xz plane of symmetry pot starboard symmetry 2 e m x u 0 0 0 m z g 0 0 m y v 0 m z g y p 0 y r 0 0 m z w 0 z q 0 0 m z g y p 0 i x k p 0 k r m z g 0 z q 0 i y m q 0 0 y r 0 k r 0 i z n r where m auv mass z g barycentric coordinate of auv i x i y i z moments of inertia about x y and z axes x u y v y r z w z q k p k r m q n v n r hydrodynamic coefficients v u v w p q r t velocity angular velocity of six degrees of freedom v u v w p q r t acceleration angular acceleration of six degrees of freedom f v i s x v i s y v i s z v i s k v i s m v i s n v i s t hydrodynamic forces and moments 3 x v i s m v r w q 1 2 ρ l 4 x q q q 2 x r r r 2 x r p r p 1 2 ρ l 3 x v r v r x w q w q 1 2 ρ l 2 x u u u 2 x v v v 2 x w w w 2 y v i s m w p v r 1 2 ρ l 4 y p q p q y q r q r 1 2 ρ l 3 y v q v q y w p w p y w r w r 1 2 ρ l 3 y r u r y p u p y v r v v v 2 w 2 1 2 r 1 2 ρ l 2 y 0 u 2 y v u v y v v v 2 w 2 1 2 y v w v w z v i s m u q v p 1 2 ρ l 4 z p p p 2 z r r r 2 z r p r p 1 2 ρ l 3 z v r v r z v p v p 1 2 ρ l 3 z q u q z w q w w v 2 w 2 1 2 q 1 2 ρ l 2 z 0 u 2 z w u w z w w w v 2 w 2 1 2 1 2 ρ l 2 z w u w z w w w v 2 w 2 1 2 1 2 ρ l 2 z v v v 2 k v i s m z g v r w p 1 2 ρ l 5 k q r q r k p q p q k p p p p 1 2 ρ l 4 k p u p k r u r 1 2 ρ l 4 k v q v q k w p w p k w r w r 1 2 ρ l 3 k 0 u 2 k v u v k v v v v 2 w 2 1 2 1 2 ρ l 3 k v w v w m v i s m z g v r w q 1 2 ρ l 5 m p p p 2 m r r r 2 m r p r p m q q q q 1 2 ρ l 4 m v r v r m v p v p 1 2 ρ l 4 m q u q m w q v 2 w 2 1 2 q 1 2 ρ l 3 m 0 u 2 m w u w m w w w v 2 w 2 1 2 1 2 ρ l 3 m w u w m w w w v 2 w 2 1 2 1 2 ρ l 3 m v v v 2 i z i x p r n v i s 1 2 ρ l 5 n p q p q n q r q r n r r r r 1 2 ρ l 4 n w r w r n w p w p n v q v q 1 2 ρ l 4 n p u p n r u r n v r v 2 w 2 1 2 r 1 2 ρ l 4 n 0 u 2 n v u v n v v v v 2 w 2 1 2 1 2 ρ l 3 n v w v w i x i y p q for an auv sailing in the sea it is influenced by the ambient environment in the area of 0 100 m below sea level the seawater is approximately homogeneous mixing layer hu et al 2000 liu et al 2001 daryabor et al 2016 the influence of temperature salinity and density of sea water on the heading of auv can be neglected while only the ocean current should be taken into account assuming that the ocean current is parallel to the horizontal plane of the world fixed coordinate system and the ocean current velocity is a constant in presence of ocean current the relative speed is depicted in equation 4 4 u r u u c cos θ cos α ψ v r v u c sin θ w r w u c sin θ cos α ψ where u c is the current velocity of irrotational fluid and α is the angle of current after the time derivative equation 4 can be written in component form as equation 5 5 u r u u c q sin θ cos α ψ u c r cos θ sin α ψ v r v u c sin α ψ w r w u c cos θ cos α ψ u c r sin θ sin α ψ then the parameters v v are changed as follows 6 v u u r v v r w w r p q r v u u r v v r w w r p q r 2 3 equation of motion in horizontal plane in order to analyze the manipulating motion the equation of motion can be divided into two noninteracting subsystems the horizontal subsystem the vertical subsystem the following assumptions will applied to the dynamic model the auv only moves at low speed and the center of gravity is in the origin of the body fixed coordinate system neglecting the elements corresponding to heave roll and pitch the horizontal equation of motion is generalized in equation 7 7 m u v r x m v u r y i z r n the x equation can be eliminated which is based on the assumption that cruise speed u is a constant and u is zero the fore and aft of auv are asymmetrical therefore the linearized maneuvering equation can be written in equation 8 8 m y v v y v v y r r m v y r r y δ δ i z n r r n r r n v v n v v n δ δ due to starboard port symmetry of auv y r and n v are zero given t y y δ n y n δ equation 8 simplifies to equation 9 9 m y v v y v v m v y r r t y i z n r r n r r n v v n y ignoring the element corresponding to roll finally yields 10 b 2 v b 1 v b 0 v i z n r t y n r t y m v y r n y where b 2 i z n r m y v b 1 y v i z n r n r m y v b 0 n v m v y r y v n r hence application of laplace transformation yields 11 g 1 s i z n r s n r b 2 s 2 b 1 s b 0 3 controller design 3 1 division of control mode the control mode represents a mapping relationship between input and output of the controller that is a kind of control law existing as the priori knowledge fewer reported studies have addressed the division of control mode for auv in the published literature in this paper the two level mode method is defined the first level is divided into six modes with respect to the operating state of auv on the basis of existing modes the second level is divided into three due to auv s speed appearing in fig 2 this paper focuses on the mode control of heading control at middle speed which is limited by trial conditions the control mode set is φ as shown in equation 12 12 φ φ 11 φ 12 φ 13 φ 21 φ 22 φ 23 φ 31 φ 32 φ 33 φ 41 φ 42 φ 43 φ 51 φ 52 φ 53 φ 61 φ 62 φ 63 where low speed u 1 m s middle speed 1 0 m s u 2 m s high speed u 2 0 m s φ 11 turning at low speed φ 12 turning at middle speed φ 13 turning at high speed φ 21 heading control at low speed φ 22 heading control at middle speed φ 23 heading control at high speed φ 31 trace following at low speed φ 32 trace following at middle speed φ 33 trace following in high speed φ 41 height control at low speed φ 42 height control at middle speed φ 43 height control at high speed φ 51 pitch control at low speed φ 52 pitch control at middle speed φ 53 pitch control at high speed φ 61 depth keeping at low speed φ 62 depth keeping at middle speed φ 63 depth keeping at high speed 3 2 design of controller each control mode has its own proper controller the heading controller is designed at middle speed which is much the same as the high and low speed the heading deviation and its changing rate are divided into three areas tu 1997 chen et al 1997 as shown in fig 3 area 1 φ 521 e h w 1 area 2 φ 522 e h w 2 e h v 1 area 3 φ 523 w 2 e h w 1 it is the advantages features of bang bang control algorithm maurer and osmolovskii 2004 are fast regulation strong anti interference ability and so on the pid algorithm can eliminate the steady state error it is convenient to implement these methods in engineering the specific design is as follows a when the heading deviation e h is very large in the area 1 the bang bang control algorithm is imposed b when the heading deviation e h and changing rate of heading deviation e h are very small the output hold control algorithm is adopted in the area 2 c when the heading deviation e h and changing rate of heading deviation e h are in the area 3 the pid control algorithm is used the control algorithm set is described as ψ 22 ψ 221 ψ 222 ψ 223 13 ψ 221 u n s g n u m a x ψ 222 u n u n 1 ψ 223 u n k p e h k i e h d t k d e h the symbols are expounded as following u n the nth output of the controller u m a x the maximum output of the controller e h the deviation of the heading e h the heading deviation change rate k p the proportional coefficient k d the differential coefficient k i the integral coefficient w 1 w 2 the threshold of e h v 1 the threshold of e h 4 switching of control modes there are two major types of switching for control mode the one is hard switching shen et al 2000 or threshold switching which is more common in industrial control as illustrated in fig 4 when the input is greater or less than the set point the switching action begins to take effect however it is easy to lead to the saltation of the control signal when one mode controller works and the other is in a non operating state the heading will instantly become larger or smaller due to threshold switching so it is difficult to satisfy the requirements of smooth sailing for auv the other is the soft switching boskovic and mehra 2000 weller and goodwin 1992 chen et al 2010 zhuang et al 2017 in order to prevent the control variables from saltationdue to threshold switching the method of soft switching based on fuzzy logic can be used to replace the threshold switching the structure diagram of soft switching is illustrated in fig 5 after an amount of prior knowledge is used to determine the input and the output fuzzy segmentation is performed the membership function reasoning method fuzzy rule and defuzzification method are determined to realize the fuzzy switching controller the output of control signal is changed slowly so as to achieve switching without disturbance however it is difficult to get a better operating experience for auv it is quite hard to set membership function and obtain the method of fuzzy inference defuzzification and fuzzy rule these parameters will directly affect the control effect therefore the complexity of parameter adjustment limits the application of fuzzy switching control in the motion of auv in order to solve the problem of saltation of threshold switching and fuzzy switching requiring a large amount of prior knowledge and parameter adjustment a viable approach of soft switching based on sigmoid function is proposed in this context the steady state output of the two controllers is employed as the upper and lower bounds of the sigmoid function within the small range before and after the switching time the transition process of the controller is changed in accordance with the sigmoid function the structure of soft switching based on sigmoid function is illustrated in fig 6 4 1 sigmoid function sigmoid function is a kind of important activation function in neural networks which is smoothness strict monotonicity and saturation its general expression is as shown in equation 14 14 f x a c k 1 e a x c d where a denotes the tilt parameter c is the offset the parameter a controls the slope of the sigmoid function c controls its offset along the x axis and d controls its offset along the y axis as seen in fig 7 napoles et al 2017 as shown in fig 7 a when a is greater than zero the sigmoid function becomes steeper and approximates to the threshold function owing to a increasing the sigmoid function approximates to the linear function owing to a decreasing when a is less than zero it is contrary to the above as shown in fig 7 b when x approximates to the positive infinity y is close to one when x approximates to the negative infinity y is close to zero the symmetry center is 0 0 5 when c is greater than zero the curve moves rightward while c is less than zero the curve moves leftward correspondingly symmetry center is changed as shown in fig 7 c the sigmoid function output will alter due to the numerator the numerators of the red green curve and blue curves are one two and three respectively as shown in fig 7 d the sigmoid function moves as a whole along with y axis green curve moves up one and blue curve moves up two therefore the corresponding range also changes due to these properties of sigmoid function the switching function can be designed to satisfy the requirements in this paper 4 2 design of switching function it is assumed that the output of control mode 1 is u 1 and the output of control mode 2 is u 2 a is obtained by running the program several times until a satisfactory performance is achieved and c is the switching time a sigmoid function candidate for this system is described in equation 15 and fig 8 for instance when auv accelerates from low speed to middle speed the controller has been switched from φ 21 to φ 22 considering the operating conditions of auv the parameters are chosen as a 2 c 500 k u 1 u 2 d u 1 before and after the switching time the controller 1 fades out and the controller 2 fades in the sigmoid function is to connect u 1 and u 2 whose value is used as the output of the controller during switching with the help of the saturated monotonic and smooth features of the sigmoid function the switching is also stable and smooth 15 f x a c u 1 u 2 1 e 2 x 500 u 1 the method only needs to adjust the tilt parameter a according to the switching process the switching time and steady state output of the two controllers are known compared with threshold switching there is no saltation and the whole switching is smooth and stable the results report in section 5 5 simulation and experiment 5 1 simulation 5 1 1 performance of single mode the control effects with respect to the same pid parameters for heading control at middle and high speed are given in fig 9 the pid parameters is adjusted at the speed of 1 5 m s when the speed increases to 2 5 m s the control effect with the same pid parameter has been weakened such as longer rise time and bigger overshoot the results are summarized in table 2 when the current is taken into account the conclusion is similar to the previous analysis it is obvious that any single control method can t suit to every operating condition each operating state of auv should has its own control strategy or parameters 5 1 2 controller performance the control performance of pid and bb pid is given in fig 10 the control parameters are adjusted to ensure that there is no overshoot for these two methods in terms of the adjusting time the bb pid adjusting time is less than pid without current as shown in fig 10 pink and black the bb pid hardly gets affected by current as shown in fig 10 black and red the adjusting time of bb pid in both the presence and absence of current is 35s and 31s respectively the steady state errors are both 0 5 the pid control effect is greatly influenced by current as shown in fig 10 pink and green the results are reported in table 3 the adjusting time of pid in both the presence and absence of current is 74s and 54s respectively the steady state errors are 1 7 and 2 3 respectively as shown in table 3 under the circumstance of current the adjusting time of bb pid is half of the pid and the steady state error is about one fifth in fig 10 the velocity of auv is 1 5 m s current velocity u c is 0 5 m s and angle of current α is 45 simulation results indicate that the satisfied performance such as overshootanti interference adjusting time and steady state error is achieved the bb pid control is superior to the conventional pid control 5 1 3 switching of control modes the change of rudder angle during switching based on two methods is depicted in fig 11 when auv accelerates from 1 5 m s to 2 5 m s the controller has been switched from control mode φ 22 to control mode φ 23 there is a saltation of the rudder and the overshoot is close to 18 6 as shown in fig 11 green sbos switching based on sigmoid function has no overshoot and the switching is smooth and stable simulation results suggest that the sbos gets better the heading control during switching based on two methods is depicted in fig 12 a partial magnification is depicted in fig 12 b the steady state errors of sbot switching based on threshold and sigmoid function are 0 5 and 0 08 respectively it can be seen from the magnified figure that sbot has obvious saltation whereas sbos has no saltation and low steady state error which can ensure heading smooth and steady simulation results suggest that sbos can effectively eliminate saltation and improve steady state error and it is reliable and effective 5 2 experiment the method proposed in this paper is validated on the sailfish auv a kind of torpedo underwater vehicle independently developed at underwater vehicle lab of the ocean university of china it is mainly to realize autonomous navigation and control in various underwater environments sailfish displacement is 73 kg it measures 210 cm in length 21 cm in diameter as shown in fig 13 5 2 1 performance of single mode it is given the heading control of three speeds with the same pid parameters in fig 14 the desired heading is 270 and 180 respectively the parameters are adjusted at low speed 0 5 m s when the speed gradually goes up the control effect of auv starts to deteriorate auv oscillates around the desired heading at speed of 1 5 m s the experimental results verify that a single control mode doesn t match the whole control system there is a need for a new operating mode to meet the requirement of control performance 5 2 2 controller performance the experiment effect of bb pid control in the lake is shown in fig 15 the overshoot is 0 76 the steady state error is 0 9 and the adjusting time is 30s the results are reported in table 4 the rudder is not frequently operated the actual control further shows that the control strategy allows better control of steady state error and overshoot this method is better because of its simple structure high reliability and easily implementation as a breeze in the lake the actual heading fluctuates slightly 5 2 3 switching the comparison of switching with two methods is sketched in fig 16 the red represents the heading of sbos while the blue represents the heading of sbot the trial has been carried out on april 24 2018 at tuandao bay qingdao in a sunny day an air temperature of about 15 c the speed of south wind is 8 10 knots and the waves is up to 0 6 1 0 m high the heading is set to 180 the low speed is 0 7 m s in control mode φ 21 while the middle speed is 1 5 m s in control mode φ 22 when the speed exceeds 1 0 m s the control mode has been switched from φ 21 to φ 22 in general the switching will be delayed since the speed needs several seconds to accelerate tables 5 7 tabulate the maximum minimum rms root mean square rmse root mean square and sse steady state error of heading with respect to these two methods at the beginning from 755s to 765s the amplitude of the heading oscillations keeps between 181 8910 and 178 6777 and the rms rmse and sse are 180 2819 0 9732 and 0 8387 respectively with regard to sbos the maximum and minimum of the heading are 180 6708 and 178 7361 and the rms rmse and sse are 179 8482 0 6855 and 0 5810 respectively with regard to sbot see table 5 there are slight changes in performance between these two methods with the same pid parameters whereas they both satisfy the requirement of control table 6 reports the switching results with these two methods from 765s to 788s there are obvious distinctions between the two methods the rmse of sbot is 2 9764 which is more than three times as big as sbos the sse of sbot is 2 6542 which is more than three times as big as sbos too the rms of sbos is 179 8482 which is closer to the desired heading than sbot the heading of sbos fluctuates around desired heading whose bias is about 2 whereas the heading of sbos fluctuates around 182 far from desired heading it is particularly evident in heading that the sbos performs more excellent than sbot after the switching from 789s to 797s the control is stable in sbos the amplitude of the heading oscillations keeps between 182 1386 and 178 0646 and the rms rmse and sse are 179 5730 1 2606 and 1 0994 respectively in sbot the amplitude of the heading oscillations keeps between 182 9361 and 180 0082 and the rms rmse and sse are 181 6194 1 8142 and 1 6194 respectively the results are summarized in table 7 due to the current and wave the performance is little different from table 5 6 conclusion in this paper a multi mode strategy based on soft switching for auv s heading is investigated first the two level mode method is proposed to divide the control modes the first level is divided upon the operating state of auv based on the existing modes the second level is divided into three according to auv s speed simulations and experiments have shown that the two level mode has good robustness accuracy and rationality second the bb pid controller is designed for the heading control which is beneficial to the realization of the project the bang bang algorithm has the advantages of fast regulation strong anti interference ability and so on the integration of the pid algorithm eliminates the steady state error by contrast with traditional pid the satisfactory performance such as overshoot anti interference rise time and steady state error has been achieved last the smooth switching between two modes is realized by introducing the sigmoid function compared with sbot the proposed method is expected to reduce disturbance simulation and experiment results have demonstrated that the method is correct and effective in the future the controller will be designed for the other modes soft switching on the first level will be carried out and cluttered environments will be taken into consideration acknowledgement this work is partially supported by the natural key research and development program of china 2016yfc0301400 and natural science foundation of china 51379198 
23216,severe slugging in deepwater flowlines and risers systems is one of the flow assurance problems that interrupts the steadily flow of reservoir fluids most severely in offshore oilfields with undulated seabed terrain this flow regime threatens the structural integrity of subsea production systems due to its fatigue loading behaviour which prompts the need to investigate its impact on the riser stability a mathematical model which based on a modified euler bernoulli beam theory and plug flow is presented to analyse the dynamic response of a riser during severe slug buildup solution for the transverse deflections of the riser in space and time was sought through finite difference approximations with implicit space and explicit time discretization scheme implemented in matlab with an adaptive algorithm that computes the changing hydrostatic pressure in the riser due to the severe slug buildup the dynamic response of the riser was observed to be undergoing a damped vibration with decaying amplitude accuracy of the solution was verified with a coupled fluid structure interaction simulation in abaqus parametric studies on velocity variations and riser responses were conducted the mathematical solution presented in this paper has opened a new idea for riser pipe analysis with respect to severe slug flow keywords severe slugging finite difference method finite element modeling abaqus fluid structure interaction top tensioned riser 1 introduction severe slugging otherwise known as terrain induced slugging is a type of multiphase flow regime encountered in offshore oil and gas production systems this flow regime is transient in nature and is of practical importance to offshore oil and gas industry because of the menace it imposes on the production facilities due to its consequent fatigue loading behaviour and erratic liquid surges schmidt et al 1980 was the first to experimentally investigate the problem of severe slugging in their study they used fig 1 a d to describe the physical phenomenon of severe slug flow which involves slug formation buildup slug movement into the separator gas blowout bubble penetration and liquid fallback their result findings revealed that severe slug flow is characterised with incessant pressure fluctuations at the riser base which causes equipment instabilities and damages to topsides processing facilities during over flooding of the separator due to high volume liquid surges they concluded that severe slugs are longer than the riser length and further established criteria that cause severe slug flow in flowline riser pipe systems which are low flow rates of oil and gas typically of an aged oilfield with low daily production rate flowline declination encountered in an undulated seabed that creates a hilly terrain and pressure buildup in the riser due to liquid accumulation resulting from the blockade of the incoming gas by the liquid slug owing to the downward declination of the flowline other researchers in the likes of fabre et al 1990 baliño et al 2007 bert et al 1987 xing and yeung 2010 wang et al 2013 issa et al 2011 oliveira et al 2013 have all carried out different studies on severe slug flow and highlighted spectrum of other problems associated with this flow regime on production facilities such as high average back pressure at the wellhead production losses due to inoperability of separator at its designed capacity caused by stream surges high instantaneous flow rates instabilities in liquid control systems of the separators reservoir flow oscillations liquid carryover in the separator pressure control problems at the separator facility damage due to large pressure amplitude and instabilities unsteady loadings on the piping systems and processing equipment which could result to catastrophic failure due to metal fatigue risks of leaks due to equipment wear and tear however recommendations such as topsides choking of the riser to increase back pressure in order to dislodge the accumulated slug gas lift injections at the riser base to unload the slug smart valve controller have been proposed by schmidt et al 1985 yocum 1973 sarica and tengesdal 2000 jansen and shoham 1991 henriot et al 1999 and host of other researchers for the control and mitigation of the problems of severe slug flow inspite of all the proposed mitigation measures their applicability has been found to be theoretically achievable but practically not feasible owing to its expensive tradeoffs such as 50 loss in daily production rate of reservoir fluids high cost of daily gas injection facility however in the absence of no viable economic approach to mitigate the dangers of severe slug loadings on offshore production equipment the best option remains to continually optimize the design capability of these equipment in order to increase their service life and enhance its durability and reliability which can be achieved by capturing all the loadings these systems are exposed to and it is the main contribution of this paper which aimed at predicting the structural instability of a submerged top tensioned riser during a severe slug buildup literature review on dynamic behaviour of production risers subject to intense severe slug flows shows that the study is still an open research but more attention has been paid to slug related internal flows philip et al 2009 analysed the fatigue damage on flowline systems caused by slug loads whereas montoya hernandez et al 2014 conducted frequency analysis on marine riser with respect to multiphase internal flow behaviour ibrahim et al 2013 used a surrogate model to investigate the flexural loading in pipelines due to slug flow furthermore jia 2012 2013 investigated about slug flow induced vibration in a pipeline span and effect of slug length slug frequency flow rate and boundary conditions on slug flow induced vibration in a pipeline span darcy et al 2013 conducted experimental study to investigate dynamic force on an elbow caused by a traveling liquid slug while peter and jin 1995 carried out a three dimensional coupled analysis of vertical deep ocean pipe with respect to the effect of periodic internal flow on shear stress however chainarong et al 2008 carried out the effects of axial extensibility on the three dimensional behaviour of tensioned pipes and risers transporting fluid paul et al 2012 has proposed methodology for determining remnant fatigue life of flexible risers subjected to slugging and irregular waves while rabih et al 2008 investigated on the fatigue life prediction of extra long submarine gas pipelines due to slug flow armando and euro 2010 worked on the interaction between slug flow and vortex induced vibration viv in fatigue life of submarine pipelines arturo et al 2012 2013 studied on the dynamic response of flexible risers caused by internal slug and flexible riser response induced by combined slug flow and wave loads in which they used numerical simulations to establish their findings aravind et al 2011 in their study focused on flow induced forces on multi planar rigid jumper systems duncan chisholm 1985 studied the effect of two phase flow in heat exchangers and pipelines tu et al 2014 investigated the flow induced vibration on a circular cylinder in planar shear flow while gosselin and païdoussis 2014 analysed the dynamic stability of a hose to the sky however amabili et al 2008 studied the effect of geometric imperfections on nonlinear stability of cylindrical shells conveying fluid it can be seen that none of the above cited works has comprehensively dealt with the issue of severe slug flow and its impact on the dynamic behaviour of riser structures which singles it out as an open research that needs to be thoroughly investigated therefore this paper presents a mathematical model which based on a modified euler bernoulli beam equation and plug flow model to investigate the dynamic response of a submerged top tensioned riser induced by severe slug buildup the paper also advocates the efficiency of finite difference fd method for solving dynamic problems for which it has received lesser application by adopting this method fd in obtaining the solution i e the transverse vibration of the riser system to the equilibrium equations of motion of the riser model the methods mostly used for the solution of the dynamic behaviour of risers are largely based on finite element method fe as reported by mcnamara et al 1988 fylling et al 1998 and chai and varyani 2006 majority of structural analysis programs such as abaqus flexcom riflex orcaflex ansys etc are all based on finite element method however other method like the generalized integral transform technique gitt has been used by chen and jian 2015 jijun et al 2013 matt 2009 2013a 2013b to solve related dynamic equilibrium equation of the riser finite difference method fd on the other hand has not been regularly employed unlike the fe method but it can as well be efficiently used for solving the dynamic equilibrium problems for slender structures only few works by patel and seyed 1995 gorman et al 2000 chatjigeorgiou 2008 2010 and bar avi 2000 were reported to have used the fd method for solving mathematical formulations however fd methods have been applied mainly for the solutions of the static equilibrium problems dareing and neathering 1970 zare and data 1998 jain 1994 major difficulties associated with the use of fd method emanate mainly from the coupled discretization required for space and time which usually leads to complicated algebraic equation systems but on the other hand it comes with high convergence and accuracy the foregoing section of this paper will present the mathematical model used in describing the transverse deflections of the submerged riser during the liquid slug buildup subsequent sections will showcase the application of the finite difference technique for the solution to the dynamic equations of motion for the riser model while numerical simulation of the present case study discussion and then conclusions follow suit 2 mathematical formulation fig 2 depicts the schematic description of the present case study which involves a floating vessel connected to a top tensioned production riser and a flowline system that follows the irregularities undulations of the seabed the riser is slender long and fully submerged it is attached to the vessel through a clamp joint that fixes the translational and rotational motions of the riser top the riser base through a pipe bend connects to the downstream end of the flowline and is clamped down to the sea floor the upstream of the flowline connects to the subsea wellhead through which oil and gas from the subsurface reservoir flows into the pipe system in order to simplify the mathematical model for the riser dynamics study the following assumptions are made a the longitudinal motion of the barge and the riser is neglected b the transverse deflection w y t of the pipe is considered to be small compared to the length of the pipe and the vibrations of a low frequency so that euler bernoulli theory is applicable for description of the riser s dynamic bending kuiper et al 2008 2007 c the bending stiffness is constant along the riser pipe d for an ideal classical severe slug flow the riser is only filled with liquid phase during the slug buildup stage in the riser schmidt et al 1980 adegboyega et al 2016 e the internal friction between the fluid and the pipe wall is neglected because of low fluid velocity associated with severe slug flow phenomenon f the pipe wall behaves elastically and no internal damping is considered g the riser moves in the plane shown in fig 2 h the flow velocity along the riser is constant i loads from waves sea currents and vessel motions are disregarded except for the hydrostatic pressure due to the surrounding column of seawater j the base of the riser is clamped to the sea floor in order to adopt uniform clamped clamped boundary conditions k the riser is pretensioned to the floating vessel with these assumptions the equation that governs the horizontal motion of a differential element of the riser pipe fig 2 with plug flow model païdoussis 1998 monette and pettigrew 2004 can be written as 1 e i 4 w y 4 t e f f y 2 w y 2 ρ f a i u l s 2 2 w y 2 2 ρ f u l s a i 2 w y t a e p e y a i p i y t 2 w y 2 ρ r a r ρ f a i 2 w t 2 0 where the solution w y t is the transverse displacement of the riser y is the coordinate point along the riser in downward direction t is the time ei is the bending stiffness of the riser t e f f y is the effective axial tension of the riser a function of pretension and submerged weight of the riser ρ f and ρ r are the mass densities of the fluid and the riser respectively a i and a e are the internal and external cross sectional areas of the riser respectively a r a e a i is the cross sectional area of the pipe wall p i y t and p e y are the dynamic and static liquid pressures inside and outside of the riser respectively u l s is the superficial velocity of the liquid flow through the riser directed upward the first and the last term on the left hand side of eq 1 form the popular equation for the bending motion of a beam according to the euler bernoulli theory the second term t e f f y 2 w y 2 takes care of the effective axial tension in the riser due to its own submerged weight and initial tension pretension at the floating unit the effective tension is calculated from 2 t e f f y w a y f l where w a is the submerged weight of the riser per unit length f is a dimensionless pretension factor its value is given as 1 3 l is the length of the riser normally it is a common practice in the offshore industry to use a pretension factor that is 1 3 times the submerged weight of the riser kuiper et al 2008 the third term on the left hand side of eq 1 is the transverse loading per unit length exerted by the slug flow on the pipe due to the centripetal acceleration u l s 2 2 w y 2 the fourth term on the left hand of eq 1 is the radial loading per unit length exerted by the slug on the pipe due to coriolis acceleration 2 u l s 2 w y t the fifth term a e p e y a i p i y t 2 w y 2 is the pressure balance between the static and dynamic pressures acting on the pipe wall due to the surrounding seawater and the internal liquid slug flow p i y t represents the changing hydrostatic pressure buildup dyna static due to liquid rise from the base to the riser top during slug generation buildup stage and is evaluated from the following equations 3 y t f b l v s g α x x i u l s t 4 z α x x i 5 f b l v s g 7 71 5 8 v s g 1 v s g l y 50 where y t is the time variant function that predicts the level of liquid slug in the riser for every increase in flow time f b is the initial slug height in the riser from the previous cycle i e the liquid fallback as shown in fig 1a and it s a function of the riser length l and v s g is the superficial velocity of the gas phase entering the upstream of the flowline x i is the initial slug length in the pipeline from the previous cycle as shown in fig 1a x is the final slug length in the pipeline at the end of slug generation as shown in fig 1b u l s is the superficial liquid velocity entering the upstream of the pipeline i e the production flow rate of the well α is the void fraction in the flowline t the flow time and z is the change in the ingress of liquid slug in the flowline after the end of the slug generation stage 6 f o r z 0 7 y t f b u l s t 8 p i y t ρ l g y t eq 3 is part of the equations proposed by schmidt et al 1980 and was later simplified by taitel and barnea 1990 for the calculation of the liquid slug buildup in the riser pipe as described by the severe slug cycle in fig 1 f b in eq 5 is evaluated in ft but we had to convert it to meter and is a correlation meant for the calculation of liquid fallback at the end of the slug cycle as shown in fig 1d for further simplification of the model describing the dynamic liquid slug buildup in the riser eq 7 which is a function of the liquid fallback and the area under the flow velocity time plot can now be used to approximate the liquid slug buildup in the riser with this series of liquid fallback are now computed from a set of superficial flow rates of gas and liquid in a given multiphase flow condition thus eq 8 which represents p i y t in eq 1 models the slug induced loads in the riser pipe due to the time variant hydrostatic pressure coming from the liquid slug buildup during the slug generation stage of the severe slug cycle however p e y ρ w g y represents the hydrostatic pressure coming from the seawater that surrounds the entire length of the riser pipe since it is fully submerged ρ w is the mass density of the seawater the last term on the left hand side of eq 1 is the axial loading per unit length exerted on the pipe by the liquid slug flow due to the local acceleration 2 w t 2 2 1 boundary conditions for the riser model as described in section 2 the riser system under context is fitted with a uniform clamped clamped end supports for the top section connecting the riser to the floating barge and the riser base to the seafloor therefore since this type of support prevents translational and rotational movements of the riser ends thus the following equations are defined at the ends of the riser 9 w y t y 0 0 w y t y y 0 0 10 w y t y l 0 w y t y y l 0 where y is the coordinate point along the riser y 0 is the upper end of the riser and y l is the lower end of the riser 2 2 initial conditions in order to capture the initial perceivable low amplitude deflection of the riser due to its own body weight the following equations are used for the initial conditions to define the displacement and velocity functions of the riser system at time zero which reads 11 w y t a sin π y l t 0 12 w y t t t 0 0 where w o d 0 05 π gives a very small deflection of the riser i e the amplitude a signifying the initial instability of the riser structure due to its own weight 3 finite difference fd solution adoption of fd solution method to the present problem requires some approximations to the partial derivatives of the equations of motion so as to enable the transformation of the differential equation to an algebraic equation after substituting the relevant approximated derivatives the following centered finite difference approximations were used for the problem derivatives 13 4 w i y 4 w i 2 4 w i 1 6 w i 4 w i 1 w i 2 δ y 4 14 2 w i y 2 w i 1 2 w i w i 1 δ y 2 15 w i y w i 1 w i 1 2 δ y 16 2 w i t 2 w i t i 1 w i t i δ t 2 w i t i w i t i 1 δ t 2 17 w i t w i t i 1 w i t i δ t 18 2 w i y t t w i y w i 1 t i 1 w i 1 t i 1 2 δ y δ t w i 1 t i w i 1 t i 2 δ y δ t where i denotes nodal positions and time state for spatially discretized domain and transitive conditions 3 1 spatial and temporal discretization schemes the first step to implementing the fd method is to divide the solution domain riser length into a series of nodes as shown in fig 3 these nodal points can be generated from the following expression 19 δ y l n where n is the number of segments divisions of the riser length l the length of riser δ y the step size and n n 1 t h node at y l for a uniform step size which usually is necessary in numerical analysis of this form the distance for each node along the riser length can be evaluated through 20 y i y 1 i 1 δ y f o r i 2 3 n 1 21 y 1 0 r i s e r t o p y n l r i s e r b a s e 22 y 0 δ y t o p d u m m y n o d e y n 1 l δ y b a s e d u m m y n o d e where i is the nodal number of the various grid points after division of the riser length into set of grid points hence the finite difference approximations can now be written for the derivatives of the equation at each node which invariably transforms the differential equation into a set of simultaneous algebraic equations that can be solved by using either iterative technique or direct method of gaussian elimination with partial pivoting most importantly to achieve this set of simultaneous algebraic equations a coupled space and time discretization technique will be needed thus an impex discretization scheme was adopted by employing an implicit space and explicit time discretization fig 4 on the solution domain interior nodes which resulted to a set of n 2 unknowns that needs to be solved simultaneously to obtain the solution of the riser displacement at different nodes over a given time increment however another important point that needs to be highlighted is the creation of dummy nodes at the nearby ends of the riser with a respective distance of δ y to both ends as expressed in eq 22 and shown diagrammatically in fig 5 these imaginary nodes are used to approximate the derivatives at the boundary and also for the nodal points closer to the boundary since more points are involved in the derivative approximation due to higher order term fourth order pde therefore with reference to the procedures discussed in this section for the application of finite difference method fd in solving the present problem the transformed algebraic expression for eq 1 is given as 23 e i δ y 4 w i 2 t i 1 4 w i 1 t i 1 6 w i t i 1 4 w i 1 t i 1 w i 2 t i 1 t e f f y δ y 2 w i 1 t i 1 2 w i t i 1 w i 1 t i 1 m f u l s 2 δ y 2 w i 1 t i 1 2 w i t i 1 w i 1 t i 1 2 m f u l s 2 δ y δ t w i 1 t i 1 w i 1 t i 1 w i 1 t i w i 1 t i a e p e y a i p i y δ y 2 w i 1 t i 1 2 w i t i 1 w i 1 t i 1 m r m f δ t 2 w i t i 1 2 w i t i w i t i 1 0 thus the differential equation eq 1 has now been converted into an algebraic equation eq 23 collecting like terms in eq 23 gives 24 e i δ y 4 w i 2 t i 1 4 e i δ y 4 t e f f y δ y 2 m f u l s 2 δ y 2 2 m f u l s 2 δ y δ t a e p e y a i p i y δ y 2 w i 1 t i 1 6 e i δ y 4 2 t e f f y δ y 2 2 m f u l s 2 δ y 2 2 a e p e y a i p i y δ y 2 m r m f δ t 2 w i t i 1 4 e i δ y 4 t e f f y δ y 2 m f u l s 2 δ y 2 2 m f u l s 2 δ y δ t a e p e y a i p i y δ y 2 w i 1 t i 1 e i δ y 4 w i 2 t i 1 2 m f u l s 2 δ y δ t w i 1 t i m r m f δ t 2 w i t i 1 2 m r m f δ t 2 w i t i 2 m f u l s 2 δ y δ t w i 1 t i where m f ρ f a i mass per unit length of the fluid element m r ρ r a r mass per unit length of pipe element w is the displacement variable eq 24 can be written for each of the n 2 interior nodes of the riser pipe the solutions of the first and last nodes w 1 a n d w n respectively are already specified in the boundary conditions therefore the problem now reduces to solving n 2 simultaneous linear algebraic equations for n 2 unknowns while the terms in the right hand side of the equation are all known values it s important to highlight the nice features of eq 24 first since the nodes are numbered consecutively and since each equation consists of node i and its adjoining neighbours i 2 i 1 a n d i 1 i 2 the resulting set of linear algebraic equations will be a banded matrix of bandwidth 5 as such they can be solved with any efficient algorithm for solving linear equation systems further inspection of the coefficients on the left hand side of eq 24 indicates that the system of linear equations will also be diagonally dominant hence convergent solutions can also be generated with iterative techniques like the gauss seidel or jacobi method tables 1 and 2 provide values of parameters used in the riser model analysis by employing the calculation parameters as provided in these tables the coefficient matrix and the corresponding known values can be computed in the form 25 6 e i δ y 4 2 t e f f y δ y 2 2 m f u l s 2 δ y 2 2 a e p e y a i p i y δ y 2 m r m f δ t 2 0 6 e i δ y 4 2 t e f f y δ y 2 2 m f u l s 2 δ y 2 2 a e p e y a i p i y δ y 2 m r m f δ t 2 w 2 t i 1 w 30 t i 1 m r m f δ t 2 w 2 t i 1 2 m r m f δ t 2 w 2 t i 2 m f u l s 2 δ y δ t w 3 t i 2 m f u l s 2 δ y δ t w 29 t i m r m f δ t 2 w 30 t i 1 2 m r m f δ t 2 w 30 t i for the solution of the riser displacement response in view of this a matlab script was written to solve these equation systems however a special adaptive code that tracks the dyna hydrostatic pressure due to the changing liquid level in the riser was written and incorporated into the main solution algorithm which makes the entire algorithm efficient and sensitive in capturing the dynamic behaviour of the riser as the liquid slug rises up in the riser at every time increment 4 results and discussion 4 1 numerical analysis results this subsection will witness the analysis interpretation and discussions of the results obtained from the finite difference solution of eq 1 which describes the dynamic behaviour of a submerged top tensioned riser during a severe slug buildup 4 1 1 transverse displacement of the riser the function w y t is a displacement variable that represents the solution vector of eq 25 which describes the transverse vibration of the riser structure along its longitudinal axis this solution vector is the output results evaluated at the discretized nodes of the riser fig 3 with adaptive matlab algorithm however 29 interior nodes were used to monitor the transverse vibrations along the longitudinal axis of the riser pipe fig 6 plots the transverse deflections of the midpoint of the riser node 16 as a function of time for a superficial liquid flow velocity u l s of 0 095 m s while fig 7 plots the combined displacements of different nodes with respect to time as the liquid slug builds up gradually from the base to the riser top from these plots it can be seen that the riser pipe is undergoing a vibrational motion during the passage of liquid slugs but further look shows that this vibration is decaying over time with the decrement of its displacement amplitude this dynamic behaviour of the ttr riser has provided an insight on the oversight function of the surrounding seawater which influenced the damping of the system due to the hydrostatic pressures that acts on the outer walls of the riser the dominant amplitude is found to be 0 052531 m and it occurred at node 16 located 76 2 m midway of the riser s length its trailing amplitude is further damped to 0 041 m with a damped period of 8 2 s and damped natural frequency of 0 766 rad sec 4 1 2 spatial response of the longitudinal section of the riser fig 8 plots the spatial displacement of the riser length at a given time frame for the superficial liquid velocity of 0 09 m s this is also another solution value of eq 1 which tells us the mode shape of the dynamic behaviour of the entire riser structure during slugging conditions this certifies the solution function which describes the displacement response pattern of the riser in space and time i e w f y t the deflection of the riser at time t 0 s in the graph represents the initial conditions of the riser pipe as stipulated earlier in eqs 11 and 12 of subsection 2 2 it can be seen from the graph that the most deflected section for the various time periods occurred at the mid length of the riser 76 2 m however at time t 300 s the entire riser length has attained static equilibrium condition with zero deflection despite the continued flow time the two ends of the riser boundaries are seen to have zero deflections which also conformed to the boundary conditions stated earlier in eqs 9 and 10 of subsection 2 1 4 1 3 effect of liquid velocity on transverse displacement of the riser as highlighted in section 1 flow velocity is one of the important criteria that influence the occurrence of severe slugging in offshore production system therefore a parametric study involving different superficial liquid flow velocities as shown in table 2 was conducted to see how they impact on the vibration response of the riser structure fig 9 plots the vibration amplitude of the riser to different flow velocities it may be difficult to spot the difference in the dynamic impact caused by the respective flow velocities in fig 9 owing to the proximity of their flow condition but a look at fig 10 provides a better clarity on their influences to the dynamic response of the riser fig 10 extracts the maximum vibration amplitude of the riser pipe relative to each flow velocity of fig 9 in order to distinct their closeness from the plot it can be seen that increase in velocity of the liquid slug will result to an increase in amplitude response of the riser which invariably will cause more instability to the system however a transition point is observed in the graph where liquid velocity greater than 0 15 m s will cause a decline in the displacement amplitude of the riser structure this behaviour justifies the claims made by schmidt et al 1980 1985 taitel and barnea 1990 and host of other researchers which states that the severity of severe slugging in offshore production systems reduces with increased production flow rates to buttress further on the dynamic behaviour of the riser to changes in flow velocity the flow pattern map of schmidt et al 1980 as shown in fig 11 reveals the operational condition for flow regime transition from severe slugging to slug flow occurs at 2 ft s 0 61 m s for the superficial flow velocity of the gas phase whereas for the liquid phase a flow velocity range of 0 3 ft s 0 091 m s to 4 ft s 1 22 m s were the conditions for which the stage 1 type of severe slug flow exists furthermore fig 12 shows the flow pattern map developed from the experiment conducted by taitel and barnea 1990 in a 5 1 m riser for air water two phase flow system from the graph the critical stability region between the unstable severe slugging and stable slug flow occurs when the superficial liquid velocity is 0 3 m s on the other hand the superficial velocity of gas greater than 0 05 m s will cause the flow regime to attain towards the stability region 4 1 4 natural frequency extraction for the ttr riser pipe modal analysis of a given structure provides useful and preliminary information such as the natural frequencies and mode shapes of that system which is instrumental for studying the dynamic behaviour of the structure in view of that the natural frequency of the ttr riser was numerically computed using the lanczos eigensolver provided in the linear perturbation frequency step in abaqus for the 152 4 m riser length with its end boundaries completely fixed six eigenvalues were requested for extraction during the modal analysis of the structure and table 3 provides the first six modes and frequencies of the ttr riser while fig 13 a f shows the respective mode shapes for each of the frequencies extracted 4 2 numerical simulation results of the scaled riser pipe 4 2 1 transverse displacement of the riser in order to validate the numerical solution to the dynamic equations of motion of the riser structure obtained through fd method a coupled fluid structure interaction simulation carried out on a scaled riser pipe was performed for qualitative comparison the nodal points defined along the longitudinal axis of the riser as shown in fig 14 was used to monitor its dynamic responses fig 15 plots the transverse vibrations of different nodes of the riser similar vibrational behaviour can be seen of these nodes to those observed in the theoretical results it can be seen that the riser is undergoing a damped vibration with maximum amplitude of 0 00084 m though the damping of the amplitude is slightly unstable due to unavoidable numerical errors in the software computation but generally the behaviour of the dynamic response of the whole system has once again qualitatively supported the theoretical results obtained 4 2 2 spatial deflection of the riser structure the contour plot of fig 16 shows the extent at which different nodal points of the riser are being deflected during the liquid slug buildup from the contour it can be seen the mid section of the riser is the most deflected region with red coloured mark this conforms to the earlier modal analysis conducted and supports the observed behaviour in the theoretical results of section 3 2 2 4 2 3 flow pressure distribution the computational fluid dynamics results avail us the detailed information on the pressure and velocity field distributions across the cross sectional area of the riser during the fluid structure interaction analysis a cross and axial sections of the riser as shown in the contour plots of figs 17 and 18 reveal the answer of why the riser undergone a planar vibrations fig 15 unlike the harmonic kind encountered in the theoretical solution the pressure profiles in these contours shows the existence of dominant pressure at the peripheral segment of the riser section which invariably led to the planar deflections of the riser this agrees with the claim earlier inferred in section 4 71 which stipulated that the initial ingress of the liquid slug into the riser may have produced an impulse in the transverse plane for which the displacement of the riser occurred and such can be expected in that the numerical simulation was conducted in 3d space while the theoretical analysis was done in 2d plane as rightly depicted in figs 2 and 3 4 2 4 flow velocity field in another effort to explain the rationale behind the planar vibrations of the riser structure the spatial velocity distribution in the riser pipe is studied figs 19 21 show the cross section of the riser with its velocity distribution in the x y and z directions respectively it can be observed from these contour plots on which axis had the most dominant velocity and at which location of the cross section is most dominated the peripheral section can be seen to dominate the location for maximum flow velocity which has as well buttressed the same situation found for the pressure field fig 22 shows the transverse flow velocity field for the longitudinal section of the riser pipe this high flow velocity happening in this direction transversely has cleared the doubt on why the riser structure undergone the seen planar displacements with these clarifications it can be agreed that the dynamic behaviour seen in the numerical simulation has qualitatively agreed with that observed in the theoretical studies 5 concluding remarks severe slugging is a serious flow assurance problem that threatens the structural integrity of subsea production systems due to its fatigue loading behaviour and recommendations to mitigate this transient flow process remains elusive because of their expensive tradeoffs however the only feasible option to abate this inevitable problem is to continuously improve on the design capability of production risers to meet with the challenges of severe slug flows despite the significance of this problem no literature can be found to have analysed the issue of severe slugging and its impact on riser dynamics using a mathematical approach rather related studies have focused only on slug flows and their analyses were based mainly on numerical simulations therefore this paper presents a mathematical model which describes the interactions between an internal fluid flow and dynamic response of a riser structure and was used to study the impact of severe slug buildup on the dynamics of a submerged top tensioned riser a method of finite difference fd technique was used to obtain the solutions of these equations of motion in space and time and has demonstrated the efficacy of this method in solving dynamic problems in which it has been sparingly used unlike its traditional usage for static analysis however the results obtained from this method were qualitatively verified with those predicted in the numerical simulation of a coupled fluid structure interaction analysis in abaqus 6 14 in the light of the observations made from this study the following conclusions can be drawn the buildup of liquid slugs in riser pipe during the slug formation stage of severe slug flow has been discovered to cause structural instability by inducing vibrations in the riser system however it was further observed that the deflections of the riser structure were decaying over time and future work in this subject will look whether the damping of the system was as a result of the surrounding seawater as considered in the mathematical model or as a result of the structural damping of the riser structure itself the dominant amplitude was found to be 0 052531 m for 0 1 m s liquid velocity and it occurred at node 16 located midway of the riser length its trailing amplitude was further damped to 0 041 m with a damped period of 8 2 s and damped frequency of 0 766 rad sec velocity variation within the threshold of severe slug criteria was noticed to have relatively insignificant impact on the dynamic deformation of the riser structure the velocity values sampled in the parametric study were quite close to each other and of very low in magnitude since the physics of severe slug flows occur at low velocity which reflects a low production flow rates in offshore oilfields accurate prediction of the dynamic response of a submerged top tensioned riser during the liquid buildup stage of severe slug flow has demonstrated the effectiveness of fd method in solving dynamic problems in which it has received lesser attention though the approximated algebraic expression was quite complex but the computational time was faster which encourages its wider applications in other dynamic analysis this paper has presented comprehensive procedures on how to use the abaqus cfd and standard solvers to conduct a coupled fluid structure interaction analysis using the co execution module to this end the results presented in this paper will contribute in the improvement of design capability of riser structures against dynamic loads of severe slugging future work in this study will extend the dynamic behaviour of riser during gas blowout stage of severe slug cycle which usually occurs in an erratic and chaotic matter acknowledgement this work is supported by national key research and development plan grant grant no 2016yfc0303700 awarded to the institute for ocean engineering china university of petroleum beijing the authors also wish to express their appreciation to china national offshore oil corporation cnooc for their assistance and resources that helped in the actualization of this research work 
23216,severe slugging in deepwater flowlines and risers systems is one of the flow assurance problems that interrupts the steadily flow of reservoir fluids most severely in offshore oilfields with undulated seabed terrain this flow regime threatens the structural integrity of subsea production systems due to its fatigue loading behaviour which prompts the need to investigate its impact on the riser stability a mathematical model which based on a modified euler bernoulli beam theory and plug flow is presented to analyse the dynamic response of a riser during severe slug buildup solution for the transverse deflections of the riser in space and time was sought through finite difference approximations with implicit space and explicit time discretization scheme implemented in matlab with an adaptive algorithm that computes the changing hydrostatic pressure in the riser due to the severe slug buildup the dynamic response of the riser was observed to be undergoing a damped vibration with decaying amplitude accuracy of the solution was verified with a coupled fluid structure interaction simulation in abaqus parametric studies on velocity variations and riser responses were conducted the mathematical solution presented in this paper has opened a new idea for riser pipe analysis with respect to severe slug flow keywords severe slugging finite difference method finite element modeling abaqus fluid structure interaction top tensioned riser 1 introduction severe slugging otherwise known as terrain induced slugging is a type of multiphase flow regime encountered in offshore oil and gas production systems this flow regime is transient in nature and is of practical importance to offshore oil and gas industry because of the menace it imposes on the production facilities due to its consequent fatigue loading behaviour and erratic liquid surges schmidt et al 1980 was the first to experimentally investigate the problem of severe slugging in their study they used fig 1 a d to describe the physical phenomenon of severe slug flow which involves slug formation buildup slug movement into the separator gas blowout bubble penetration and liquid fallback their result findings revealed that severe slug flow is characterised with incessant pressure fluctuations at the riser base which causes equipment instabilities and damages to topsides processing facilities during over flooding of the separator due to high volume liquid surges they concluded that severe slugs are longer than the riser length and further established criteria that cause severe slug flow in flowline riser pipe systems which are low flow rates of oil and gas typically of an aged oilfield with low daily production rate flowline declination encountered in an undulated seabed that creates a hilly terrain and pressure buildup in the riser due to liquid accumulation resulting from the blockade of the incoming gas by the liquid slug owing to the downward declination of the flowline other researchers in the likes of fabre et al 1990 baliño et al 2007 bert et al 1987 xing and yeung 2010 wang et al 2013 issa et al 2011 oliveira et al 2013 have all carried out different studies on severe slug flow and highlighted spectrum of other problems associated with this flow regime on production facilities such as high average back pressure at the wellhead production losses due to inoperability of separator at its designed capacity caused by stream surges high instantaneous flow rates instabilities in liquid control systems of the separators reservoir flow oscillations liquid carryover in the separator pressure control problems at the separator facility damage due to large pressure amplitude and instabilities unsteady loadings on the piping systems and processing equipment which could result to catastrophic failure due to metal fatigue risks of leaks due to equipment wear and tear however recommendations such as topsides choking of the riser to increase back pressure in order to dislodge the accumulated slug gas lift injections at the riser base to unload the slug smart valve controller have been proposed by schmidt et al 1985 yocum 1973 sarica and tengesdal 2000 jansen and shoham 1991 henriot et al 1999 and host of other researchers for the control and mitigation of the problems of severe slug flow inspite of all the proposed mitigation measures their applicability has been found to be theoretically achievable but practically not feasible owing to its expensive tradeoffs such as 50 loss in daily production rate of reservoir fluids high cost of daily gas injection facility however in the absence of no viable economic approach to mitigate the dangers of severe slug loadings on offshore production equipment the best option remains to continually optimize the design capability of these equipment in order to increase their service life and enhance its durability and reliability which can be achieved by capturing all the loadings these systems are exposed to and it is the main contribution of this paper which aimed at predicting the structural instability of a submerged top tensioned riser during a severe slug buildup literature review on dynamic behaviour of production risers subject to intense severe slug flows shows that the study is still an open research but more attention has been paid to slug related internal flows philip et al 2009 analysed the fatigue damage on flowline systems caused by slug loads whereas montoya hernandez et al 2014 conducted frequency analysis on marine riser with respect to multiphase internal flow behaviour ibrahim et al 2013 used a surrogate model to investigate the flexural loading in pipelines due to slug flow furthermore jia 2012 2013 investigated about slug flow induced vibration in a pipeline span and effect of slug length slug frequency flow rate and boundary conditions on slug flow induced vibration in a pipeline span darcy et al 2013 conducted experimental study to investigate dynamic force on an elbow caused by a traveling liquid slug while peter and jin 1995 carried out a three dimensional coupled analysis of vertical deep ocean pipe with respect to the effect of periodic internal flow on shear stress however chainarong et al 2008 carried out the effects of axial extensibility on the three dimensional behaviour of tensioned pipes and risers transporting fluid paul et al 2012 has proposed methodology for determining remnant fatigue life of flexible risers subjected to slugging and irregular waves while rabih et al 2008 investigated on the fatigue life prediction of extra long submarine gas pipelines due to slug flow armando and euro 2010 worked on the interaction between slug flow and vortex induced vibration viv in fatigue life of submarine pipelines arturo et al 2012 2013 studied on the dynamic response of flexible risers caused by internal slug and flexible riser response induced by combined slug flow and wave loads in which they used numerical simulations to establish their findings aravind et al 2011 in their study focused on flow induced forces on multi planar rigid jumper systems duncan chisholm 1985 studied the effect of two phase flow in heat exchangers and pipelines tu et al 2014 investigated the flow induced vibration on a circular cylinder in planar shear flow while gosselin and païdoussis 2014 analysed the dynamic stability of a hose to the sky however amabili et al 2008 studied the effect of geometric imperfections on nonlinear stability of cylindrical shells conveying fluid it can be seen that none of the above cited works has comprehensively dealt with the issue of severe slug flow and its impact on the dynamic behaviour of riser structures which singles it out as an open research that needs to be thoroughly investigated therefore this paper presents a mathematical model which based on a modified euler bernoulli beam equation and plug flow model to investigate the dynamic response of a submerged top tensioned riser induced by severe slug buildup the paper also advocates the efficiency of finite difference fd method for solving dynamic problems for which it has received lesser application by adopting this method fd in obtaining the solution i e the transverse vibration of the riser system to the equilibrium equations of motion of the riser model the methods mostly used for the solution of the dynamic behaviour of risers are largely based on finite element method fe as reported by mcnamara et al 1988 fylling et al 1998 and chai and varyani 2006 majority of structural analysis programs such as abaqus flexcom riflex orcaflex ansys etc are all based on finite element method however other method like the generalized integral transform technique gitt has been used by chen and jian 2015 jijun et al 2013 matt 2009 2013a 2013b to solve related dynamic equilibrium equation of the riser finite difference method fd on the other hand has not been regularly employed unlike the fe method but it can as well be efficiently used for solving the dynamic equilibrium problems for slender structures only few works by patel and seyed 1995 gorman et al 2000 chatjigeorgiou 2008 2010 and bar avi 2000 were reported to have used the fd method for solving mathematical formulations however fd methods have been applied mainly for the solutions of the static equilibrium problems dareing and neathering 1970 zare and data 1998 jain 1994 major difficulties associated with the use of fd method emanate mainly from the coupled discretization required for space and time which usually leads to complicated algebraic equation systems but on the other hand it comes with high convergence and accuracy the foregoing section of this paper will present the mathematical model used in describing the transverse deflections of the submerged riser during the liquid slug buildup subsequent sections will showcase the application of the finite difference technique for the solution to the dynamic equations of motion for the riser model while numerical simulation of the present case study discussion and then conclusions follow suit 2 mathematical formulation fig 2 depicts the schematic description of the present case study which involves a floating vessel connected to a top tensioned production riser and a flowline system that follows the irregularities undulations of the seabed the riser is slender long and fully submerged it is attached to the vessel through a clamp joint that fixes the translational and rotational motions of the riser top the riser base through a pipe bend connects to the downstream end of the flowline and is clamped down to the sea floor the upstream of the flowline connects to the subsea wellhead through which oil and gas from the subsurface reservoir flows into the pipe system in order to simplify the mathematical model for the riser dynamics study the following assumptions are made a the longitudinal motion of the barge and the riser is neglected b the transverse deflection w y t of the pipe is considered to be small compared to the length of the pipe and the vibrations of a low frequency so that euler bernoulli theory is applicable for description of the riser s dynamic bending kuiper et al 2008 2007 c the bending stiffness is constant along the riser pipe d for an ideal classical severe slug flow the riser is only filled with liquid phase during the slug buildup stage in the riser schmidt et al 1980 adegboyega et al 2016 e the internal friction between the fluid and the pipe wall is neglected because of low fluid velocity associated with severe slug flow phenomenon f the pipe wall behaves elastically and no internal damping is considered g the riser moves in the plane shown in fig 2 h the flow velocity along the riser is constant i loads from waves sea currents and vessel motions are disregarded except for the hydrostatic pressure due to the surrounding column of seawater j the base of the riser is clamped to the sea floor in order to adopt uniform clamped clamped boundary conditions k the riser is pretensioned to the floating vessel with these assumptions the equation that governs the horizontal motion of a differential element of the riser pipe fig 2 with plug flow model païdoussis 1998 monette and pettigrew 2004 can be written as 1 e i 4 w y 4 t e f f y 2 w y 2 ρ f a i u l s 2 2 w y 2 2 ρ f u l s a i 2 w y t a e p e y a i p i y t 2 w y 2 ρ r a r ρ f a i 2 w t 2 0 where the solution w y t is the transverse displacement of the riser y is the coordinate point along the riser in downward direction t is the time ei is the bending stiffness of the riser t e f f y is the effective axial tension of the riser a function of pretension and submerged weight of the riser ρ f and ρ r are the mass densities of the fluid and the riser respectively a i and a e are the internal and external cross sectional areas of the riser respectively a r a e a i is the cross sectional area of the pipe wall p i y t and p e y are the dynamic and static liquid pressures inside and outside of the riser respectively u l s is the superficial velocity of the liquid flow through the riser directed upward the first and the last term on the left hand side of eq 1 form the popular equation for the bending motion of a beam according to the euler bernoulli theory the second term t e f f y 2 w y 2 takes care of the effective axial tension in the riser due to its own submerged weight and initial tension pretension at the floating unit the effective tension is calculated from 2 t e f f y w a y f l where w a is the submerged weight of the riser per unit length f is a dimensionless pretension factor its value is given as 1 3 l is the length of the riser normally it is a common practice in the offshore industry to use a pretension factor that is 1 3 times the submerged weight of the riser kuiper et al 2008 the third term on the left hand side of eq 1 is the transverse loading per unit length exerted by the slug flow on the pipe due to the centripetal acceleration u l s 2 2 w y 2 the fourth term on the left hand of eq 1 is the radial loading per unit length exerted by the slug on the pipe due to coriolis acceleration 2 u l s 2 w y t the fifth term a e p e y a i p i y t 2 w y 2 is the pressure balance between the static and dynamic pressures acting on the pipe wall due to the surrounding seawater and the internal liquid slug flow p i y t represents the changing hydrostatic pressure buildup dyna static due to liquid rise from the base to the riser top during slug generation buildup stage and is evaluated from the following equations 3 y t f b l v s g α x x i u l s t 4 z α x x i 5 f b l v s g 7 71 5 8 v s g 1 v s g l y 50 where y t is the time variant function that predicts the level of liquid slug in the riser for every increase in flow time f b is the initial slug height in the riser from the previous cycle i e the liquid fallback as shown in fig 1a and it s a function of the riser length l and v s g is the superficial velocity of the gas phase entering the upstream of the flowline x i is the initial slug length in the pipeline from the previous cycle as shown in fig 1a x is the final slug length in the pipeline at the end of slug generation as shown in fig 1b u l s is the superficial liquid velocity entering the upstream of the pipeline i e the production flow rate of the well α is the void fraction in the flowline t the flow time and z is the change in the ingress of liquid slug in the flowline after the end of the slug generation stage 6 f o r z 0 7 y t f b u l s t 8 p i y t ρ l g y t eq 3 is part of the equations proposed by schmidt et al 1980 and was later simplified by taitel and barnea 1990 for the calculation of the liquid slug buildup in the riser pipe as described by the severe slug cycle in fig 1 f b in eq 5 is evaluated in ft but we had to convert it to meter and is a correlation meant for the calculation of liquid fallback at the end of the slug cycle as shown in fig 1d for further simplification of the model describing the dynamic liquid slug buildup in the riser eq 7 which is a function of the liquid fallback and the area under the flow velocity time plot can now be used to approximate the liquid slug buildup in the riser with this series of liquid fallback are now computed from a set of superficial flow rates of gas and liquid in a given multiphase flow condition thus eq 8 which represents p i y t in eq 1 models the slug induced loads in the riser pipe due to the time variant hydrostatic pressure coming from the liquid slug buildup during the slug generation stage of the severe slug cycle however p e y ρ w g y represents the hydrostatic pressure coming from the seawater that surrounds the entire length of the riser pipe since it is fully submerged ρ w is the mass density of the seawater the last term on the left hand side of eq 1 is the axial loading per unit length exerted on the pipe by the liquid slug flow due to the local acceleration 2 w t 2 2 1 boundary conditions for the riser model as described in section 2 the riser system under context is fitted with a uniform clamped clamped end supports for the top section connecting the riser to the floating barge and the riser base to the seafloor therefore since this type of support prevents translational and rotational movements of the riser ends thus the following equations are defined at the ends of the riser 9 w y t y 0 0 w y t y y 0 0 10 w y t y l 0 w y t y y l 0 where y is the coordinate point along the riser y 0 is the upper end of the riser and y l is the lower end of the riser 2 2 initial conditions in order to capture the initial perceivable low amplitude deflection of the riser due to its own body weight the following equations are used for the initial conditions to define the displacement and velocity functions of the riser system at time zero which reads 11 w y t a sin π y l t 0 12 w y t t t 0 0 where w o d 0 05 π gives a very small deflection of the riser i e the amplitude a signifying the initial instability of the riser structure due to its own weight 3 finite difference fd solution adoption of fd solution method to the present problem requires some approximations to the partial derivatives of the equations of motion so as to enable the transformation of the differential equation to an algebraic equation after substituting the relevant approximated derivatives the following centered finite difference approximations were used for the problem derivatives 13 4 w i y 4 w i 2 4 w i 1 6 w i 4 w i 1 w i 2 δ y 4 14 2 w i y 2 w i 1 2 w i w i 1 δ y 2 15 w i y w i 1 w i 1 2 δ y 16 2 w i t 2 w i t i 1 w i t i δ t 2 w i t i w i t i 1 δ t 2 17 w i t w i t i 1 w i t i δ t 18 2 w i y t t w i y w i 1 t i 1 w i 1 t i 1 2 δ y δ t w i 1 t i w i 1 t i 2 δ y δ t where i denotes nodal positions and time state for spatially discretized domain and transitive conditions 3 1 spatial and temporal discretization schemes the first step to implementing the fd method is to divide the solution domain riser length into a series of nodes as shown in fig 3 these nodal points can be generated from the following expression 19 δ y l n where n is the number of segments divisions of the riser length l the length of riser δ y the step size and n n 1 t h node at y l for a uniform step size which usually is necessary in numerical analysis of this form the distance for each node along the riser length can be evaluated through 20 y i y 1 i 1 δ y f o r i 2 3 n 1 21 y 1 0 r i s e r t o p y n l r i s e r b a s e 22 y 0 δ y t o p d u m m y n o d e y n 1 l δ y b a s e d u m m y n o d e where i is the nodal number of the various grid points after division of the riser length into set of grid points hence the finite difference approximations can now be written for the derivatives of the equation at each node which invariably transforms the differential equation into a set of simultaneous algebraic equations that can be solved by using either iterative technique or direct method of gaussian elimination with partial pivoting most importantly to achieve this set of simultaneous algebraic equations a coupled space and time discretization technique will be needed thus an impex discretization scheme was adopted by employing an implicit space and explicit time discretization fig 4 on the solution domain interior nodes which resulted to a set of n 2 unknowns that needs to be solved simultaneously to obtain the solution of the riser displacement at different nodes over a given time increment however another important point that needs to be highlighted is the creation of dummy nodes at the nearby ends of the riser with a respective distance of δ y to both ends as expressed in eq 22 and shown diagrammatically in fig 5 these imaginary nodes are used to approximate the derivatives at the boundary and also for the nodal points closer to the boundary since more points are involved in the derivative approximation due to higher order term fourth order pde therefore with reference to the procedures discussed in this section for the application of finite difference method fd in solving the present problem the transformed algebraic expression for eq 1 is given as 23 e i δ y 4 w i 2 t i 1 4 w i 1 t i 1 6 w i t i 1 4 w i 1 t i 1 w i 2 t i 1 t e f f y δ y 2 w i 1 t i 1 2 w i t i 1 w i 1 t i 1 m f u l s 2 δ y 2 w i 1 t i 1 2 w i t i 1 w i 1 t i 1 2 m f u l s 2 δ y δ t w i 1 t i 1 w i 1 t i 1 w i 1 t i w i 1 t i a e p e y a i p i y δ y 2 w i 1 t i 1 2 w i t i 1 w i 1 t i 1 m r m f δ t 2 w i t i 1 2 w i t i w i t i 1 0 thus the differential equation eq 1 has now been converted into an algebraic equation eq 23 collecting like terms in eq 23 gives 24 e i δ y 4 w i 2 t i 1 4 e i δ y 4 t e f f y δ y 2 m f u l s 2 δ y 2 2 m f u l s 2 δ y δ t a e p e y a i p i y δ y 2 w i 1 t i 1 6 e i δ y 4 2 t e f f y δ y 2 2 m f u l s 2 δ y 2 2 a e p e y a i p i y δ y 2 m r m f δ t 2 w i t i 1 4 e i δ y 4 t e f f y δ y 2 m f u l s 2 δ y 2 2 m f u l s 2 δ y δ t a e p e y a i p i y δ y 2 w i 1 t i 1 e i δ y 4 w i 2 t i 1 2 m f u l s 2 δ y δ t w i 1 t i m r m f δ t 2 w i t i 1 2 m r m f δ t 2 w i t i 2 m f u l s 2 δ y δ t w i 1 t i where m f ρ f a i mass per unit length of the fluid element m r ρ r a r mass per unit length of pipe element w is the displacement variable eq 24 can be written for each of the n 2 interior nodes of the riser pipe the solutions of the first and last nodes w 1 a n d w n respectively are already specified in the boundary conditions therefore the problem now reduces to solving n 2 simultaneous linear algebraic equations for n 2 unknowns while the terms in the right hand side of the equation are all known values it s important to highlight the nice features of eq 24 first since the nodes are numbered consecutively and since each equation consists of node i and its adjoining neighbours i 2 i 1 a n d i 1 i 2 the resulting set of linear algebraic equations will be a banded matrix of bandwidth 5 as such they can be solved with any efficient algorithm for solving linear equation systems further inspection of the coefficients on the left hand side of eq 24 indicates that the system of linear equations will also be diagonally dominant hence convergent solutions can also be generated with iterative techniques like the gauss seidel or jacobi method tables 1 and 2 provide values of parameters used in the riser model analysis by employing the calculation parameters as provided in these tables the coefficient matrix and the corresponding known values can be computed in the form 25 6 e i δ y 4 2 t e f f y δ y 2 2 m f u l s 2 δ y 2 2 a e p e y a i p i y δ y 2 m r m f δ t 2 0 6 e i δ y 4 2 t e f f y δ y 2 2 m f u l s 2 δ y 2 2 a e p e y a i p i y δ y 2 m r m f δ t 2 w 2 t i 1 w 30 t i 1 m r m f δ t 2 w 2 t i 1 2 m r m f δ t 2 w 2 t i 2 m f u l s 2 δ y δ t w 3 t i 2 m f u l s 2 δ y δ t w 29 t i m r m f δ t 2 w 30 t i 1 2 m r m f δ t 2 w 30 t i for the solution of the riser displacement response in view of this a matlab script was written to solve these equation systems however a special adaptive code that tracks the dyna hydrostatic pressure due to the changing liquid level in the riser was written and incorporated into the main solution algorithm which makes the entire algorithm efficient and sensitive in capturing the dynamic behaviour of the riser as the liquid slug rises up in the riser at every time increment 4 results and discussion 4 1 numerical analysis results this subsection will witness the analysis interpretation and discussions of the results obtained from the finite difference solution of eq 1 which describes the dynamic behaviour of a submerged top tensioned riser during a severe slug buildup 4 1 1 transverse displacement of the riser the function w y t is a displacement variable that represents the solution vector of eq 25 which describes the transverse vibration of the riser structure along its longitudinal axis this solution vector is the output results evaluated at the discretized nodes of the riser fig 3 with adaptive matlab algorithm however 29 interior nodes were used to monitor the transverse vibrations along the longitudinal axis of the riser pipe fig 6 plots the transverse deflections of the midpoint of the riser node 16 as a function of time for a superficial liquid flow velocity u l s of 0 095 m s while fig 7 plots the combined displacements of different nodes with respect to time as the liquid slug builds up gradually from the base to the riser top from these plots it can be seen that the riser pipe is undergoing a vibrational motion during the passage of liquid slugs but further look shows that this vibration is decaying over time with the decrement of its displacement amplitude this dynamic behaviour of the ttr riser has provided an insight on the oversight function of the surrounding seawater which influenced the damping of the system due to the hydrostatic pressures that acts on the outer walls of the riser the dominant amplitude is found to be 0 052531 m and it occurred at node 16 located 76 2 m midway of the riser s length its trailing amplitude is further damped to 0 041 m with a damped period of 8 2 s and damped natural frequency of 0 766 rad sec 4 1 2 spatial response of the longitudinal section of the riser fig 8 plots the spatial displacement of the riser length at a given time frame for the superficial liquid velocity of 0 09 m s this is also another solution value of eq 1 which tells us the mode shape of the dynamic behaviour of the entire riser structure during slugging conditions this certifies the solution function which describes the displacement response pattern of the riser in space and time i e w f y t the deflection of the riser at time t 0 s in the graph represents the initial conditions of the riser pipe as stipulated earlier in eqs 11 and 12 of subsection 2 2 it can be seen from the graph that the most deflected section for the various time periods occurred at the mid length of the riser 76 2 m however at time t 300 s the entire riser length has attained static equilibrium condition with zero deflection despite the continued flow time the two ends of the riser boundaries are seen to have zero deflections which also conformed to the boundary conditions stated earlier in eqs 9 and 10 of subsection 2 1 4 1 3 effect of liquid velocity on transverse displacement of the riser as highlighted in section 1 flow velocity is one of the important criteria that influence the occurrence of severe slugging in offshore production system therefore a parametric study involving different superficial liquid flow velocities as shown in table 2 was conducted to see how they impact on the vibration response of the riser structure fig 9 plots the vibration amplitude of the riser to different flow velocities it may be difficult to spot the difference in the dynamic impact caused by the respective flow velocities in fig 9 owing to the proximity of their flow condition but a look at fig 10 provides a better clarity on their influences to the dynamic response of the riser fig 10 extracts the maximum vibration amplitude of the riser pipe relative to each flow velocity of fig 9 in order to distinct their closeness from the plot it can be seen that increase in velocity of the liquid slug will result to an increase in amplitude response of the riser which invariably will cause more instability to the system however a transition point is observed in the graph where liquid velocity greater than 0 15 m s will cause a decline in the displacement amplitude of the riser structure this behaviour justifies the claims made by schmidt et al 1980 1985 taitel and barnea 1990 and host of other researchers which states that the severity of severe slugging in offshore production systems reduces with increased production flow rates to buttress further on the dynamic behaviour of the riser to changes in flow velocity the flow pattern map of schmidt et al 1980 as shown in fig 11 reveals the operational condition for flow regime transition from severe slugging to slug flow occurs at 2 ft s 0 61 m s for the superficial flow velocity of the gas phase whereas for the liquid phase a flow velocity range of 0 3 ft s 0 091 m s to 4 ft s 1 22 m s were the conditions for which the stage 1 type of severe slug flow exists furthermore fig 12 shows the flow pattern map developed from the experiment conducted by taitel and barnea 1990 in a 5 1 m riser for air water two phase flow system from the graph the critical stability region between the unstable severe slugging and stable slug flow occurs when the superficial liquid velocity is 0 3 m s on the other hand the superficial velocity of gas greater than 0 05 m s will cause the flow regime to attain towards the stability region 4 1 4 natural frequency extraction for the ttr riser pipe modal analysis of a given structure provides useful and preliminary information such as the natural frequencies and mode shapes of that system which is instrumental for studying the dynamic behaviour of the structure in view of that the natural frequency of the ttr riser was numerically computed using the lanczos eigensolver provided in the linear perturbation frequency step in abaqus for the 152 4 m riser length with its end boundaries completely fixed six eigenvalues were requested for extraction during the modal analysis of the structure and table 3 provides the first six modes and frequencies of the ttr riser while fig 13 a f shows the respective mode shapes for each of the frequencies extracted 4 2 numerical simulation results of the scaled riser pipe 4 2 1 transverse displacement of the riser in order to validate the numerical solution to the dynamic equations of motion of the riser structure obtained through fd method a coupled fluid structure interaction simulation carried out on a scaled riser pipe was performed for qualitative comparison the nodal points defined along the longitudinal axis of the riser as shown in fig 14 was used to monitor its dynamic responses fig 15 plots the transverse vibrations of different nodes of the riser similar vibrational behaviour can be seen of these nodes to those observed in the theoretical results it can be seen that the riser is undergoing a damped vibration with maximum amplitude of 0 00084 m though the damping of the amplitude is slightly unstable due to unavoidable numerical errors in the software computation but generally the behaviour of the dynamic response of the whole system has once again qualitatively supported the theoretical results obtained 4 2 2 spatial deflection of the riser structure the contour plot of fig 16 shows the extent at which different nodal points of the riser are being deflected during the liquid slug buildup from the contour it can be seen the mid section of the riser is the most deflected region with red coloured mark this conforms to the earlier modal analysis conducted and supports the observed behaviour in the theoretical results of section 3 2 2 4 2 3 flow pressure distribution the computational fluid dynamics results avail us the detailed information on the pressure and velocity field distributions across the cross sectional area of the riser during the fluid structure interaction analysis a cross and axial sections of the riser as shown in the contour plots of figs 17 and 18 reveal the answer of why the riser undergone a planar vibrations fig 15 unlike the harmonic kind encountered in the theoretical solution the pressure profiles in these contours shows the existence of dominant pressure at the peripheral segment of the riser section which invariably led to the planar deflections of the riser this agrees with the claim earlier inferred in section 4 71 which stipulated that the initial ingress of the liquid slug into the riser may have produced an impulse in the transverse plane for which the displacement of the riser occurred and such can be expected in that the numerical simulation was conducted in 3d space while the theoretical analysis was done in 2d plane as rightly depicted in figs 2 and 3 4 2 4 flow velocity field in another effort to explain the rationale behind the planar vibrations of the riser structure the spatial velocity distribution in the riser pipe is studied figs 19 21 show the cross section of the riser with its velocity distribution in the x y and z directions respectively it can be observed from these contour plots on which axis had the most dominant velocity and at which location of the cross section is most dominated the peripheral section can be seen to dominate the location for maximum flow velocity which has as well buttressed the same situation found for the pressure field fig 22 shows the transverse flow velocity field for the longitudinal section of the riser pipe this high flow velocity happening in this direction transversely has cleared the doubt on why the riser structure undergone the seen planar displacements with these clarifications it can be agreed that the dynamic behaviour seen in the numerical simulation has qualitatively agreed with that observed in the theoretical studies 5 concluding remarks severe slugging is a serious flow assurance problem that threatens the structural integrity of subsea production systems due to its fatigue loading behaviour and recommendations to mitigate this transient flow process remains elusive because of their expensive tradeoffs however the only feasible option to abate this inevitable problem is to continuously improve on the design capability of production risers to meet with the challenges of severe slug flows despite the significance of this problem no literature can be found to have analysed the issue of severe slugging and its impact on riser dynamics using a mathematical approach rather related studies have focused only on slug flows and their analyses were based mainly on numerical simulations therefore this paper presents a mathematical model which describes the interactions between an internal fluid flow and dynamic response of a riser structure and was used to study the impact of severe slug buildup on the dynamics of a submerged top tensioned riser a method of finite difference fd technique was used to obtain the solutions of these equations of motion in space and time and has demonstrated the efficacy of this method in solving dynamic problems in which it has been sparingly used unlike its traditional usage for static analysis however the results obtained from this method were qualitatively verified with those predicted in the numerical simulation of a coupled fluid structure interaction analysis in abaqus 6 14 in the light of the observations made from this study the following conclusions can be drawn the buildup of liquid slugs in riser pipe during the slug formation stage of severe slug flow has been discovered to cause structural instability by inducing vibrations in the riser system however it was further observed that the deflections of the riser structure were decaying over time and future work in this subject will look whether the damping of the system was as a result of the surrounding seawater as considered in the mathematical model or as a result of the structural damping of the riser structure itself the dominant amplitude was found to be 0 052531 m for 0 1 m s liquid velocity and it occurred at node 16 located midway of the riser length its trailing amplitude was further damped to 0 041 m with a damped period of 8 2 s and damped frequency of 0 766 rad sec velocity variation within the threshold of severe slug criteria was noticed to have relatively insignificant impact on the dynamic deformation of the riser structure the velocity values sampled in the parametric study were quite close to each other and of very low in magnitude since the physics of severe slug flows occur at low velocity which reflects a low production flow rates in offshore oilfields accurate prediction of the dynamic response of a submerged top tensioned riser during the liquid buildup stage of severe slug flow has demonstrated the effectiveness of fd method in solving dynamic problems in which it has received lesser attention though the approximated algebraic expression was quite complex but the computational time was faster which encourages its wider applications in other dynamic analysis this paper has presented comprehensive procedures on how to use the abaqus cfd and standard solvers to conduct a coupled fluid structure interaction analysis using the co execution module to this end the results presented in this paper will contribute in the improvement of design capability of riser structures against dynamic loads of severe slugging future work in this study will extend the dynamic behaviour of riser during gas blowout stage of severe slug cycle which usually occurs in an erratic and chaotic matter acknowledgement this work is supported by national key research and development plan grant grant no 2016yfc0303700 awarded to the institute for ocean engineering china university of petroleum beijing the authors also wish to express their appreciation to china national offshore oil corporation cnooc for their assistance and resources that helped in the actualization of this research work 
23217,wake induced vibration wiv of a two degree of freedom 2 dof downstream square cylinder behind a stationary equal size upstream square cylinder is numerically investigated at low reynolds numbers by using characteristics based split cbs finite element algorithm due to the interference between the cylinders the flow pattern and dynamic characteristics of become more complex than an isolated cylinder case the spacing ratio of the two equal sized square cylinders in the tandem arrangement is fixed as l d 5 0 the reynolds numbers of this two cylinder system have five types varying between 40 and 200 with a unit step of re 40 the reduced mass of the square cylinder is mr 2 0 while its reduced velocity changes between u r 3 0 18 0 the numerical results show that the reduced velocity and reynolds number can affect the characteristics of the flow patterns oscillatory frequency maximum amplitudes and x y trajectories of the downstream square cylinder the predominant vortex shedding patterns are 2s 2s 2p p s 2t and steady mode additionally the figure 8 and figure dual 8 are observed in the x y vibrating trajectories of the downstream square cylinder finally the interactions between cylinders underlying the vibration characteristics of the square cylinder behind a stationary square cylinder with different reynolds numbers are revealed keywords wake induced vibrations two equal sized square cylinders dynamic response wake characteristics 1 introduction the problem of vortex induced vibration viv can be encountered in many engineering applications such as bridge structures offshore structures and marine structures one of the most fundamental issues of viv a circular cylinder under uniform flow has been extensively investigated in the past decades in viv of a circular cylinder some important phenomena such as the figure 8 motion orbit 2s 2p and p s flow patterns and the three branches in the transverse vibrating amplitude curves can be observed the details of this subject have been summarized in review literature by williamson and govardhan 2004 sarpkaya 2004 gabbai and benaroya 2005 and bearman 2011 pertaining to the viv of a square cylinder however less is reported compared to the literature for a circular cylinder singh et al 2009 performed numerical simulations on viv of a square cylinder with transverse oscillation and revealed the effects of the cylinder s non dimensional frequencies and the reynolds numbers he et al 2012 reported the flow around stationary as well as an oscillating cylinder with circular and square cross sections at different reynolds numbers and demonstrated the influences of reduced mass on lock in dynamic characteristics and fluid forces on a square cylinder subjected to x y oscillating zhao et al 2013 investigated the effect of flow with different angle of incidence on the dynamic response of a square cylinder and summarized that the range of lock in and cylinder response was minimum for the case of zero angle of incidence they also investigated the viv performances of a square cylinder which was gradually changed to a rectangular cylinder at low reynolds number the influences of aspect ratio and reduced mass on the galloping responses were also carefully examined in zhao et al 2015 more recently sen and mittal 2011 2015 numerically studied the effects of reduced mass and reduced natural frequency on the 2 dof viv of a rigid square cylinder they observed that the strong galloping could be achieved at the higher mass ratio meanwhile the vortex induced vibration of a square cylinder at different angles of incidence was carried out using experimental technology and revealed the transition between galloping and viv from the analysis of the dynamic responses nemes et al 2012 zhao et al 2014 in tandem cases there are more complex flow than the single square cylinder case because of the existence of two bodies and their reciprocal effect on the flow pattern sohankar and etminan 2009 investigated fluid flow and heat transfer from tandem square cylinders in laminar flow regime they fixed the gap distance to five widths of the cylinder between the tandem square cylinders their two dimensional results showed that the flow was steady for re 35 and unsteady periodic for re 40 the onset of vortex shedding occurred in the range of re 35 40 it was reported that the nusselt number attained the highest value on the front surface of the cylinder an intermediate value on the top and bottom surfaces and the lowest value on the downstream cylinder surface similarly two dimensional and three dimensional unsteady simulations were performed by sohankar 2012 to study the flow over two tandem square cylinders for reynolds numbers from 40 to 1000 and a gap spacing of l 4 0 bao et al 2012 performed a numerical study on the flow around inline cylinder array consisting of six square cylinders at a reynolds number of 100 at different spacing ratios and six different flow patterns were found numerical study of flow past two tandem square cylinders at different spacing ratios at re 100 was investigated using the cip zju model by zhao et al 2016 two flow patterns were distinguished in the study vortex shed from downstream cylinder and vortex shed from both cylinders meanwhile pertaining to the wake induced vibration wiv a number of studies on two elastically mounted circular square cylinders subjected to an uniform flow has been conducted through experimental and numerical approaches in the last several decades the effects of parameters such as two cylinder configuration spacing ratio l d reduced velocity u r and natural frequency ratio r f nx f ny on the dynamic response and the characteristics of the flow field were explored in both laminar and turbulent flows see borazjani and sotiropoulos 2009 bao et al 2011 carmo et al 2011 assi et al 2013 wang et al 2014 han et al 2014 nitun and tiwari 2014 jaiman et al 2016 tamimi et al 2017 different from the case of the single cylinder in which the vortices shedding from the cylinder itself induces the vibration the downstream cylinder s oscillations in wiv are strongly affected by the incoming vortices generated from the upstream one as well hence there is a significant difference between the dynamic response of the downstream cylinder and that of the single cylinder case including the case of two equal sized cylinders borazjani and sotiropoulos 2009 reported the flow characteristics and oscillating responses of two tandem wiv cylinders with both one and two degrees of freedom at a small spacing ratio the wiv characteristics of two equal sized circular cylinders in the tandem arrangement for both 2d and 3d cases were reported by carmo et al 2011 the wiv of a circular cylinder behind a stationary circular cylinder with equal sizes were investigated in bao et al 2011 with the dynamic response and the wake pattern distributions revealed and the fluid structure interaction dynamics carefully examined moreover wang et al 2014 studied the wiv of a downstream smaller circular cylinder with one and two degrees of freedom behind a fixed larger cylinder at low reynolds numbers re 50 200 the diameter ratio between two cylinders was 2 0 assi et al 2013 performed the experimental investigations on the wake induced vibration mechanism of the two cylinder system in the staggered arrangement within the high reynolds number region they pointed out that the mechanism of transition changed from an initial viv to a dominating wiv with the increasing of reynolds number recently the influence of the wake of a fixed circular cylinder on the response of a downstream square cylinder at different spacing ratios was experimentally investigated by tamimi et al 2017 furthermore some researchers have examined the wiv characteristics of the body behind the square cylinder han et al 2014 investigated the wake characteristics and dynamic responses of a 2 dof downstream circular cylinder behind a fixed square cylinder the wake behaviors of the flow past two tandem square cylinders with a transverse oscillation in phase were presented in nitun and tiwari 2014 additionally jaiman et al 2016 mainly developed a nonlinear interface force correction algorithm for fluid structure interaction problem which was then employed to numerically investigated the wiv of an oscillating square cylinder behind an fixed square cylinder they reported that the effects of the reduced velocity on the dynamic responses and flow characteristics are significant at m r 5 0 l d 4 0 and re 200 which could be regarded as an initial promotion for the current work despite these previous studies the basic dynamic characteristics of the square cylinder subjected to wiv in tandem arrangement are still lacking in the current study the wiv characteristics of a 2 dof square cylinder placed behind a stationary square cylinder in tandem arrangement are investigated the objective of this study is to explore the effects of parameters including reynolds number re and reduced velocity u r the characteristics of wiv dynamic responses at different re and the mechanism of wake induced vibration for the two cylinder system in the laminar flow region the framework of this study is presented as follows the details of the arbitrary lagrangian eulerian ale forms of the fluid governing equations and the solid movement equations are described in section 2 to validate the computational code a study of 2 dof viv of the single square cylinder is carried out and the simulated results are compared with the existing data in section 3 in section 4 the problem description of the wiv of a 2 dof square cylinder behind a stationary square cylinder is detailed the flow characteristics and dynamic behaviors of the downstream square cylinder as well as the wake induced vibration mechanism underlying the dynamic responses of the cylinder are elaborated in section 5 finally conclusions of the study are provided in section 6 2 governing equations and numerical scheme to account for the fluid dynamics in the viv and wiv systems the non dimensional navier stokes n s equation and the continuity equation for the incompressible viscous flow are employed and presented in eqs 1 and 2 both equations are described under the ale framework see donea et al 1982 as follows 1 u i t u j w j u i x j 1 re 2 u i x j x j p x i 0 2 u i x i 0 where u i represents the fluid velocity w i is the grid velocity tensor in the i th direction p is the pressure x i i 1 2 in the 2 d problem and 1 2 3 in the 3 d problem is the cartesian coordinates and t is the time furthermore the reynolds number is re u d v where d 1 0 is the characteristic length in the non dimensional fluid domain u the free stream velocity and v the fluid kinematic viscosity equations 1 and 2 are solved by the characteristic based split cbs finite element method zienkiewicz and codina 1995 with the required steps shown in equations 3 5 the cbs scheme is employed due to its simple formulations and easy implementation in the numerical code under the framework of the fractional step method an intermediate velocity u i is introduced three computational steps can be reconstructed from 1 and 2 within a time step δt in step 1 i e eq 3 from which the intermediate velocity u i is obtained half of the diffusion and the stabilized terms in the cbs method are implicitly treated while the other half are explicitly coped with in step 2 i e eq 4 the pressure p n 1 can be calculated by using the u i in step 3 i e eq 5 the velocities u i n 1 are further calculated details of the cbs algorithm can be found in our previous paper han et al 2014 3 u i u i n δ t 1 2 re 2 u i x j x j δ t 2 u k n w k n x k u j n w j n u i x j u j n w j n u i n x j 1 2 re 2 u i n x j x j 4 2 p n 1 x j x j 1 δ t u j x j 5 u i n 1 u i δ t p n 1 x i the movement governing equations of the oscillating cylinder with two degrees of freedom 2 dof is modeled as a mass spring damper system as 6 2 x t 2 4 π ξ u r x t 2 π u r 2 x c d 2 m r 7 2 y t 2 4 π ξ u r y t 2 π u r 2 y c l 2 m r where the x and y are the cylinder displacements in the x 1 and x 2 direction m r m m is the cylinder s non dimensional reduced mass where m is the square cylinder mass of a unit length and m is the displaced mass of fluid ξ is the structural damping ratio u r u f n d represents the reduced velocity where f n is the natural frequency of the cylinder c l 2f l ρu 2 d and c d 2f d ρu 2 d are the lift and drag coefficients as f l and f d are the x 1 and x 2 components of fluid force applied on the cylinder the cylinder motion within a time step will bring the updating of the grid movement the grid displacement w i is calculated using a laplace related algorithm shown as follows 8 1 γ w i j j 0 where γ is a parameter for controlling the mesh deformation details of the grid updating scheme were introduced in wang et al 2014 for solving the viv case which is one of the typical fluid structure interaction fsi problems the staggered algorithm is employed this scheme has been used for satisfactory solutions as shown in the publications by ahn and kallinderis 2006 placzek et al 2009 bao et al 2011 and han et al 2014 briefly the computational steps during one time interval δt t n 1 t n are summarized as follows a obtain the velocities and pressure in the fluid domain by the cbs algorithm b calculate the drag and lift coefficients c d n 1 and c l n 1 of the cylinder and compute the cylinder motions x n 1 and y n 1 by the newmark β type method han et al 2015 c determine the updated grid movements w i n 1 using the equation and d return to step a to restart a new iteration step until the viv behaviors become stable 3 code verification verification studies have been carried out in our previous work han et al 2014 by employing the cases of viv of a circular cylinder and wake induced vibration of a two cylinder system and comparing the numerical results with the data from existing references borazjani and sotiropoulos 2009 bao et al 2011 carmo et al 2011 we further validate the accuracy of the computational approach by solving the viv of an isolated cylinder with two degrees of freedom and wiv of an square cylinder with two degrees of freedom behind a stationary square one in uniform cross flow 3 1 viv of an isolated square cylinder this example has also been taken as a reference by zhao et al 2013 and jaiman et al 2016 the free oscillation of a square cylinder with 2 dof is carried out in the subsection the size of the flow domain and the geometry of the model and boundary conditions are given in fig 1 a the cylinder whose center is located at point 0 0 has a side length d 1 0 which is also equal to the characteristic length the entire computational domain is defined as ω 20d 50d 20d 20d on the surface of the cylinder defined as u x v y a uniform flow used at the inlet of the computational domain as a boundary condition is prescribed to be u x u 1 0 and u y 0 0 while the pressure is set to zero at the outlet symmetry conditions are used at the lateral boundaries as u x y 0 0 and u y 0 0 the system parameters are set as follows reduced mass m r 3 0 damping ratio ξ 0 0 reduced velocity 1 u r 20 reynolds number re 100 and δt 0 002 the schematic mesh grids near the cylinder is illustrated in fig 1 b to test the mesh independence a mesh refinement study is performed three groups of grid systems are adopted in the current examples in grid i there are 100 nodes on the surface of the cylinder while in grid ii and grid iii there are 200 and 400 nodes respectively some details of the three groups are provided in table 1 which also provided the results of some grid parameters note the percentages of changes compared to those of grid i are shown in brackets it is observed that the maximum deviation of results such as x max and y max is 5 31 when comparing grid ii with grid i whereas no significant change exists between grid ii and grid iii only 1 81 change in the value of x max therefore all the investigations presented hereafter are based on the mesh characteristics of grid ii the non dimensional transverse maximum amplitudes y max d of the numerical simulations are illustrated in fig 2 against the existing data as shown in fig 2 these results are in good agreement with each other hence validating that the numerical scheme and resolution used in this paper are adequately accurate and reliable for the solution of viv of the square cylinder in the laminar region 3 2 wiv of a 2 dof square cylinder behind a stationary square cylinder in order to test the suitability of the current algorithm for the complex flow problem a second case is selected from jaiman et al 2016 the wiv of a square cylinder with 2 dof behind a fixed square one is carried out in the subsection the representation of this problem is schematically illustrated in fig 3 a two square cylinders are positioned in the fluid domain with an inline configuration the fluid domain is configured as 30d 70d 30d 30d and the centers of the two cylinders are placed at 4 0d 0 and 0 0 so that the spacing ratio is fixed as l d 4 0 the upstream square cylinder is kept stationary while the downstream square cylinder is capable of freely oscillating with 2 dof characteristics by connecting with a spring damping system in the inline and transverse directions respectively the flow boundary conditions are the same as those in the previous a single cylinder study each cylinder surface is divided into 200 equal parts seen in fig 3 b which is based on the mesh characteristics of grid ii in subsection 3 1 the system parameters are set as follows reduced mass m r 5 0 damping ratio ξ 0 0 reduced velocity 3 u r 20 reynolds number re 200 and δt 0 002 a comparison between the present results and prior numerical work is shown in fig 4 the comparison is based on the two physical quantities the root mean square value of the transverse amplitude y rms and the frequency ratio f l 2 f n f l 2 is lift force frequency of the downstream square cylinder it can be found from fig 4 that the present results agree well with those of jaiman et al 2016 and further verifying that the numerical scheme and resolution used in this paper are adequately accuracy and reliable for the solution of wiv of both square cylinders in tandem arrangement 4 problem description the computational model is illustrated in fig 3 most of the boundary conditions are the same as those in the wiv of a 2 dof square cylinder behind a fixed square one benchmark case in the previous section the only difference of the computational model is that the centers of the two cylinders are placed at 5 0d 0 and 0 0 respectively at l d 5 0 the effect of the rear cylinder on the upstream one become weak and the evolution of wake flow behind upstream cylinder is more distinct the system parameters are set as follows the natural frequencies of the square cylinder in the two directions are set identical as f n1 f n2 f n the reduced mass of the square cylinder is as low as m r 2 0 the damping coefficient of the dynamic systems for the square cylinder is kept zero in order to achieve maximum amplitudes during oscillations during the computations the reduced velocity u r u f n d is changed from 3 to 18 to test the effects of reynolds number on the wiv system reynolds number re u d v is set as 40 80 120 160 and 200 respectively the range of reynolds number falls in the laminar flow regime and enables the 2d computation in this work the changes of u r and re are realized by varying the values of f n and v respectively the dimensionless time step is δt 0 002 when the wiv system is fully developed and becomes stable the computation process stops 5 wiv of two square cylinders in tandem arrangement 5 1 flow pattern based on the simulations fig 5 summarizes the wake patterns and demonstrates how they are affected by reynolds number re and reduced velocity u r six types of fully developed flow patterns 2s 2s 2p p s 2t and steady were observed at different re and u r where s means a single vortex p means a pair of vortices and t means a triplet of vortices at lower re 2s steady and 2s are the dominant modes as seen in fig 6 a c the vortex street is not formed in the gap between both cylinders and the wake region of the rear square cylinder at 3 u r 7 re 40 and 5 u r 6 re 80 called steady pattern as seen in fig 6 a with an increasing u r the occurrence of vortex shedding in the wake region of the downstream cylinder can be observed at re 40 it can be noted that at 8 u r 16 there is no vortex street in the gap between both cylinders and the vortex shedding occurs in the near wake region of the downstream cylinder as seen in fig 6 b which is similar with the pattern of the vortex shed from downstream cylinder reported in zhao et al 2016 with the further increasing of u r the vortex shedding occurs in the far wake region of the downstream cylinder known as the 2s pattern as seen in fig 6 c in addition its effect on the downstream cylinder is insignificant and the dynamic responses of the downstream cylinder in each direction are suppressed these findings are consistent with the results of wang et al 2014 and jaiman et al 2016 with the increasing of re the vortex street occurs in the gap region as seen in fig 6 d at re 80 and 120 the predominant vortex shedding pattern is the 2s mode in particular for the case of re 160 only 2s mode is observed in the case of u r 5 and the vortex shedding pattern becomes p s mode at u r 6 see fig 6 e with the further increase of re three types of patterns occur at re 200 which are 2s mode at 4 u r 6 2p mode at u r 3 7 u r 13 and 17 u r 18 see fig 5 f and 2t mode at 14 u r 16 see fig 6 g 5 2 frequency analysis fig 7 shows the relationship between frequency ratio and the reduced velocity at different reynolds numbers in the wiv system these frequencies are defined as follows f n the natural frequency of the circular cylinder f l 1 the main frequency of the lift coefficient of the stationary upstream square cylinder st x and st y the main oscillation frequency of the square cylinder in the inline and transverse direction respectively for lower reynolds numbers the frequency ratios gradually increase with the increase in reduced velocity except for the smaller reduced velocity as shown in fig 7 a and b it can be observed that the frequency ratios are around zero in the range of 3 u r 7 re 40 and 5 u r 6 re 80 respectively a possible explanation for this feature is that the flow around the wiv system resembles steady pattern as seen in fig 6 a the main oscillation frequency in the transverse direction st y is close to the frequency of vortex shedding of the upstream square cylinder which is the frequency of the lift coefficient f l 1 in the range of 8 u r 15 re 40 and 7 u r 16 re 80 as reynolds number increases up to 120 the st y is close to the f l 1 in each case the values of st x f n st y f n and f l 1 f n continuously increase along with the increasing values of u r for the case of re 160 and re 200 the trends of frequency ratios are similar to that for the re 120 case however there are a few exceptions at u r 6 re 160 the values of st x st y and f l 1 are equal to each other regardless at u r 6 and re 200 the st y is inconsistent with the f l 1 on the other hand the change of re has a great influence on the resonance region of the downstream square cylinder at re 40 the transverse vibration frequency is close to the natural frequency in the range of 9 u r 11 and the synchronization phenomenon does not occur in the inline direction yet for the case of re 80 the resonance range changes to 7 u r 9 in the transverse direction for larger re the synchronization phenomenon of the in line motion occurs at the smaller u r however for the transverse vibration the synchronization phenomenon occurs at 6 u r 8 re 120 and 160 and 5 u r 8 re 200 5 3 dynamic responses 5 3 1 amplitudes in this subsection the 2 dof wiv dynamic characteristics of the downstream square cylinder are presented the variations of the maximum amplitudes in both inline and transverse directions at different reynolds numbers are presented in fig 8 the gap flow plays a key role in the two cylinder dynamic system in the tandem arrangement the same behavior was also observed in the other studies in the literature borazjani and sotiropoulos 2009 bao et al 2011 tu et al 2015 as re increases the effect of wake of the upstream cylinder on the dynamic response of the downstream one becomes stronger and the mechanism of vivs of two tandem cylinders changes from flow interference to the wake interference the x max and y max are the maximum vibrating amplitudes in both inline and transverse directions within one stable vibrating cycle defined as x max x min 2 and y max y min 2 respectively it can be observed from fig 8 that the oscillation amplitude at the inline direction is very small at re 40 and the downstream cylinder is in the state of no lock in while lock in phenomenon only occurs in the transverse direction this dynamic response feature confirms the vibration frequency synchronization region at the inline direction as reported in the previous section for the transverse direction the vibration amplitude of the square cylinder is very small at lower reduced velocities 3 u r 7 a possible explanation for this feature is that the flow characteristics resemble steady state and there is no vortex street in the wake of both the upstream and downstream square cylinders as seen in fig 9 a and it leads the downstream cylinder to oscillate at very small amplitude this phenomenon was also observed in han et al 2014 with the increasing of u r the vortex shedding pattern changes from the steady to the 2s pattern there is no vortex street behind the upstream square cylinder as seen in fig 9 b resulting in the downstream cylinder oscillating with large amplitude the transverse amplitude reaches a peak at u r 9 then gradually decreases for the larger reduced velocities it can be observed that the main oscillation frequency in the transverse direction st y is not close to the natural frequency of square cylinder and the vortex shedding pattern changes from the 2s pattern to the 2s which gives rise to the reducing oscillating response at re 80 except for u r 3 and u r 7 the trends of vibration amplitude in both inline and transverse directions are the same as those of the re 40 case with the increasing of u r the formation of vortex street resembles 2s mode in the gap between both cylinders and the wake flow of the downstream cylinder as seen in fig 10 which leads the downstream cylinder to vibrate at lager amplitude additionally the effect of the downstream cylinder on the upstream one becomes stronger and the transverse oscillation amplitude is larger than that of re 40 case at larger u r for larger re the reynolds number has an insignificant influence on the dynamic response at the range of 3 u r 8 however at the higher u r the effect of re on the large oscillation region in the inline direction is obvious note that at u r 4 while the oscillation frequency is not close to the natural frequency the vibration amplitude reaches a relatively larger value this phenomenon is called soft lock in reported by mittal and kumar 1999 prasanth and mittal 2008 borazjani and sotiropoulos 2009 and tu et al 2014 in addition a dramatic change can be found at u r 5 the transverse amplitudes at re 120 and 160 are much smaller than that of re 200 this is caused by the change of the characteristics of the oscillation frequency and the flow in the wiv system and it leads to the change of flow force and oscillation amplitude the transverse oscillation frequency is close to the natural one with the increasing of re as seen in fig 7 c 7 e in addition the flow pattern transforms from 2s to 2s with the increasing of the re as seen in fig 11 one can be easily observed that the flow forces c d and c l in the case of u r 5 and re 120 are smaller than those of the case of u r 5 and re 200 especially the maximum value of c l at re 200 is around seven times of that for re 120 and the oscillation amplitude in the transverse direction changes from 0 028d to 0 42d on the other hand for the case of u r 5 and re 120 the characteristics of flow field leads the drag force on the surface of the downstream square cylinder to be negative seen in fig 11 a hence the motion trajectory of the cylinder is at the left of the initial position on the contrary at u r 5 and re 200 the value of c d is positive and its orbit is to the right of the initial position seen in fig 11 b with the increasing of u r the motion of the downstream square cylinder in the inline direction varies greatly it can also be seen that the large vibration amplitude region is u r 10 re 120 9 u r 13 re 160 and 13 u r 18 re 200 respectively it is worth noting that the peaks of the oscillation amplitude in both inline and transverse directions occur at u r 9 and re 160 under the action of coming upstream square cylinder wake the time of each cycle for the rear square one is longer and shows a modulation period seen in fig 12 a meanwhile there are some dramatic decreases in the time history curves of c d and c l resulting in the change of the dynamic response of the oscillation square cylinder a possible explanation for this feature is that the transition of the wake characteristics occurs near the downstream square cylinder seen in fig 12 b at time step i the wake structure near the downstream square cylinder shows irregular which leads the drag force to be minimum and the downstream square cylinder near the left maximum position however at time step ii the downstream square cylinder is near the right and bottom maximum position and the forming of distinct vortex street is formed behind the downstream cylinder additionally the phase portrait of c l relative to y d shows out phase state this finding is supported by jaiman et al 2016 and they claimed that the phase angle between life coefficient and transverse displacement is about 180 in galloping region and the wake characteristics is irregular 5 3 2 x y trajectories in general the trajectory of an elastically mounted square cylinder behind a stationary square cylinder mainly resembles the figure 8 shape and the motion trajectory of the downstream cylinder is symmetrical to the central line y 0 at smaller re while the motion shows figure dual 8 and irregular shape at larger re the lissajous figures of the trajectory for the downstream square cylinder at different reduced velocities when re 40 80 120 160 and 200 are presented in fig 13 17 respectively for the smaller re the x y trajectory is similar to those expected for an isolated square cylinder and the motion trajectories of the square cylinder resemble figure 8 motion as seen in fig 13 it can also be seen that the downstream square cylinder motions are quite small in the unlock in region however in the range of lock in the oscillation amplitude is large in the transverse direction it represents the result associated with the single resonance which means synchronization only in the transverse direction at re 80 and 120 the downstream square cylinder orbital trajectory is figure 8 motion except for the u r 14 case as seen in figs 14 and 15 the lissajous figure of the cylinder exhibits the vertical figure dual 8 at u r 14 and re 80 meanwhile for the case of re 120 the shape of cylinder motion becomes irregular and similar to the tandem figure dual 8 with the increase in re the characteristics of flow field becomes complex inducing the complex change of the dynamic responses of the downstream cylinder the cylinder orbital trajectories is predominantly figure 8 at the range of 3 u r 12 while the motion of the downstream cylinder acts as a modulation period and the shape of cylinder motion changes from the figure 8 to the irregular shape at the larger u r the same finding has been observed in our previous work han et al 2014 it is caused by the longer vibration cycle of the cylinder it is note worthy that the motion trajectory of the downstream cylinder show irregular figure 8 which is asymmetrical to the line of y 0 and the upper loop is bigger than the lower loop see figs 16 b and 17 a this phenomenon is consistent with the asymmetrical vortex shedding structure from the upper and lower sides of the downstream square cylinder presented in fig 6 e although the cause of this asymmetry is unknown at this stage 5 4 vortex dynamics of the wake induced vibration wiv the mechanism of wiv between the stationary square cylinder and the elastically mounted cylinder was investigated in terms of the instantaneous flow field in order to explain the effect of the reynolds number on the vortex flow structure behind the stationary upstream and downstream square cylinder where specific oscillatory modes were excited in the wake interference region the instantaneous vorticity contours and time histories in terms of the downstream cylinder flow forces and displacements in both in line and cross flow directions at two different reynolds numbers re 80 and re 200 at u r 14 are illustrated in figs 18 and 19 respectively it can be seen in fig 18 for the case of u r 14 and re 80 that there is an obvious vortex street in the separation and the vortex street shows a 2s pattern in the wake region of the downstream square cylinder yet the vortex structure in the gap between the cylinders is not fully developed when it hits the downstream body given rise to weakening the influence on the dynamic response of the downstream cylinder in stage i it is observed in the time history plot that the downstream cylinder is close to the initial position in the transverse direction the vortex sheds from the lower side of the upstream cylinder hits the front and lower part of the downstream cylinder meanwhile the strength of the clockwise rotating vortex gradually increases at the upper side of the downstream cylinder it causes the upward deceleration motion until the cylinder reaches the maximum transverse position in stage ii the clockwise rotating vortex starts to shed from the upper shear layer of the downstream cylinder and the counter clockwise rotating vortex develops at the lower side of it however the opposite is observed in stage iii and stage iv where the cylinder moves downwards and returns to the initial position after which the displacement of the cylinder reaches the maximum value in the downward direction furthermore the counter clockwise rotating vortex develops well and sheds from the lower shear layer of the downstream cylinder the clockwise rotating vortex sheds at the upper side of it and then a new vortex is generated for the large reynolds number re 200 the dynamic responses and flow characteristics of wiv are entirely different from those of re 80 case as shown in fig 19 the period of oscillation is longer and acts as a modulation period furthermore the effect of flow characteristics on the motion amplitude is significant the wake flow field near the downstream square cylinder is complicated for the smaller oscillation amplitude as shown in stage i and stage iv given rise to the change of the flow forces on the surface of the downstream square cylinder however for the larger oscillation the pattern of vortex shedding behind the square cylinder resembles 2t mode as shown in stage ii and stage iii it is worth noting that the vortex shed from the upstream cylinder impinges on the downstream cylinder and each shed vortex splits into two resulting in the forming of distinct vortex street behind the downstream cylinder additionally the phase portrait of c l relative to y d shows out phase state which is similar with that of the case of u r 9 and re 160 however the phase portrait of c d relative to x d becomes in phase with the change of re resulting in a larger amplitude inline oscillation and a dual resonance hence with the increasing of re the wake interference and the oscillation amplitude intensify 6 conclusions complexity arises when two square cylinders are placed in tandem due to the potential wake induced vibration wiv wake induced vibration of a 2 dof square cylinder placed behind a stationary square cylinder was investigated by using a characteristics based split cbs finite element method the spacing ratio l d of the two equal size cylinders was as high as 5 0 the reynolds number was varied from 40 to 200 to illustrate its impact on the flow patterns oscillation frequency characteristics and dynamic behaviors of the wiv system key findings and conclusions are summarized as follows i six types of vortex shedding pattern such as 2s 2s 2p p s 2t and steady were observed it is noteworthy that a steady pattern occurred at the smaller re re 40 and 80 and the vortex street was not obvious in the separation at 7 u r 17 re 40 u r 4 re 80 u r 5 re 120 and 160 and 5 u r 6 re 200 respectively hence a significant change of the body motion results from the impact on flow characteristics from the reynolds number and reduced velocity ii with the increasing of re the change of frequency characteristics occurs and the predominant mechanism of wiv of the square cylinder behind a stationary square one transforms to wake interference for smaller re the downstream square cylinder only exhibited the single resonance phenomenon in the transverse direction however for higher re the dual resonance phenomenon was found at the larger u r iii compared to the single square cylinder case the motion orbit of the downstream cylinder was found to be more complex the prominent x y trajectories of the downstream square cylinder were figure 8 figure dual 8 and irregular shapes in addition the effect of the reynolds number on the lissajous figures of the motion was significant iv the wake induced vibration mechanism underlying the dynamic responses of the downstream cylinder is revealed the 2t vortex shedding pattern is observed in this investigation at u r 14 and re 200 and its mechanism is analyzed acknowledgements the authors are grateful for the financial supports from the national natural science foundation of china nos 51679139 11602214 11772193 the major program of the national natural science foundation of china no 51490674 the program for professor of special appointment eastern scholar at shanghai institutions of higher learning shanghai national science foundation no 17zr1415100 and 18zr1418000 research program of shanghai leader talent no 20 program for intergovernmental international s t cooperation projects of shanghai municipality no 18290710600 project of thousand youth talents no be0100002 this work is also sponsored by shanghai pujiang program no 17pj1404300 new enrolment support of shanghai jiao tong university no wf220401005 china postdoctoral science foundation no 2017m622593 and hunan provincial natural science foundation of china no 2016jj3117 the authors would like to express their gratitude to the editors and reviewers for their valuable help on this work 
23217,wake induced vibration wiv of a two degree of freedom 2 dof downstream square cylinder behind a stationary equal size upstream square cylinder is numerically investigated at low reynolds numbers by using characteristics based split cbs finite element algorithm due to the interference between the cylinders the flow pattern and dynamic characteristics of become more complex than an isolated cylinder case the spacing ratio of the two equal sized square cylinders in the tandem arrangement is fixed as l d 5 0 the reynolds numbers of this two cylinder system have five types varying between 40 and 200 with a unit step of re 40 the reduced mass of the square cylinder is mr 2 0 while its reduced velocity changes between u r 3 0 18 0 the numerical results show that the reduced velocity and reynolds number can affect the characteristics of the flow patterns oscillatory frequency maximum amplitudes and x y trajectories of the downstream square cylinder the predominant vortex shedding patterns are 2s 2s 2p p s 2t and steady mode additionally the figure 8 and figure dual 8 are observed in the x y vibrating trajectories of the downstream square cylinder finally the interactions between cylinders underlying the vibration characteristics of the square cylinder behind a stationary square cylinder with different reynolds numbers are revealed keywords wake induced vibrations two equal sized square cylinders dynamic response wake characteristics 1 introduction the problem of vortex induced vibration viv can be encountered in many engineering applications such as bridge structures offshore structures and marine structures one of the most fundamental issues of viv a circular cylinder under uniform flow has been extensively investigated in the past decades in viv of a circular cylinder some important phenomena such as the figure 8 motion orbit 2s 2p and p s flow patterns and the three branches in the transverse vibrating amplitude curves can be observed the details of this subject have been summarized in review literature by williamson and govardhan 2004 sarpkaya 2004 gabbai and benaroya 2005 and bearman 2011 pertaining to the viv of a square cylinder however less is reported compared to the literature for a circular cylinder singh et al 2009 performed numerical simulations on viv of a square cylinder with transverse oscillation and revealed the effects of the cylinder s non dimensional frequencies and the reynolds numbers he et al 2012 reported the flow around stationary as well as an oscillating cylinder with circular and square cross sections at different reynolds numbers and demonstrated the influences of reduced mass on lock in dynamic characteristics and fluid forces on a square cylinder subjected to x y oscillating zhao et al 2013 investigated the effect of flow with different angle of incidence on the dynamic response of a square cylinder and summarized that the range of lock in and cylinder response was minimum for the case of zero angle of incidence they also investigated the viv performances of a square cylinder which was gradually changed to a rectangular cylinder at low reynolds number the influences of aspect ratio and reduced mass on the galloping responses were also carefully examined in zhao et al 2015 more recently sen and mittal 2011 2015 numerically studied the effects of reduced mass and reduced natural frequency on the 2 dof viv of a rigid square cylinder they observed that the strong galloping could be achieved at the higher mass ratio meanwhile the vortex induced vibration of a square cylinder at different angles of incidence was carried out using experimental technology and revealed the transition between galloping and viv from the analysis of the dynamic responses nemes et al 2012 zhao et al 2014 in tandem cases there are more complex flow than the single square cylinder case because of the existence of two bodies and their reciprocal effect on the flow pattern sohankar and etminan 2009 investigated fluid flow and heat transfer from tandem square cylinders in laminar flow regime they fixed the gap distance to five widths of the cylinder between the tandem square cylinders their two dimensional results showed that the flow was steady for re 35 and unsteady periodic for re 40 the onset of vortex shedding occurred in the range of re 35 40 it was reported that the nusselt number attained the highest value on the front surface of the cylinder an intermediate value on the top and bottom surfaces and the lowest value on the downstream cylinder surface similarly two dimensional and three dimensional unsteady simulations were performed by sohankar 2012 to study the flow over two tandem square cylinders for reynolds numbers from 40 to 1000 and a gap spacing of l 4 0 bao et al 2012 performed a numerical study on the flow around inline cylinder array consisting of six square cylinders at a reynolds number of 100 at different spacing ratios and six different flow patterns were found numerical study of flow past two tandem square cylinders at different spacing ratios at re 100 was investigated using the cip zju model by zhao et al 2016 two flow patterns were distinguished in the study vortex shed from downstream cylinder and vortex shed from both cylinders meanwhile pertaining to the wake induced vibration wiv a number of studies on two elastically mounted circular square cylinders subjected to an uniform flow has been conducted through experimental and numerical approaches in the last several decades the effects of parameters such as two cylinder configuration spacing ratio l d reduced velocity u r and natural frequency ratio r f nx f ny on the dynamic response and the characteristics of the flow field were explored in both laminar and turbulent flows see borazjani and sotiropoulos 2009 bao et al 2011 carmo et al 2011 assi et al 2013 wang et al 2014 han et al 2014 nitun and tiwari 2014 jaiman et al 2016 tamimi et al 2017 different from the case of the single cylinder in which the vortices shedding from the cylinder itself induces the vibration the downstream cylinder s oscillations in wiv are strongly affected by the incoming vortices generated from the upstream one as well hence there is a significant difference between the dynamic response of the downstream cylinder and that of the single cylinder case including the case of two equal sized cylinders borazjani and sotiropoulos 2009 reported the flow characteristics and oscillating responses of two tandem wiv cylinders with both one and two degrees of freedom at a small spacing ratio the wiv characteristics of two equal sized circular cylinders in the tandem arrangement for both 2d and 3d cases were reported by carmo et al 2011 the wiv of a circular cylinder behind a stationary circular cylinder with equal sizes were investigated in bao et al 2011 with the dynamic response and the wake pattern distributions revealed and the fluid structure interaction dynamics carefully examined moreover wang et al 2014 studied the wiv of a downstream smaller circular cylinder with one and two degrees of freedom behind a fixed larger cylinder at low reynolds numbers re 50 200 the diameter ratio between two cylinders was 2 0 assi et al 2013 performed the experimental investigations on the wake induced vibration mechanism of the two cylinder system in the staggered arrangement within the high reynolds number region they pointed out that the mechanism of transition changed from an initial viv to a dominating wiv with the increasing of reynolds number recently the influence of the wake of a fixed circular cylinder on the response of a downstream square cylinder at different spacing ratios was experimentally investigated by tamimi et al 2017 furthermore some researchers have examined the wiv characteristics of the body behind the square cylinder han et al 2014 investigated the wake characteristics and dynamic responses of a 2 dof downstream circular cylinder behind a fixed square cylinder the wake behaviors of the flow past two tandem square cylinders with a transverse oscillation in phase were presented in nitun and tiwari 2014 additionally jaiman et al 2016 mainly developed a nonlinear interface force correction algorithm for fluid structure interaction problem which was then employed to numerically investigated the wiv of an oscillating square cylinder behind an fixed square cylinder they reported that the effects of the reduced velocity on the dynamic responses and flow characteristics are significant at m r 5 0 l d 4 0 and re 200 which could be regarded as an initial promotion for the current work despite these previous studies the basic dynamic characteristics of the square cylinder subjected to wiv in tandem arrangement are still lacking in the current study the wiv characteristics of a 2 dof square cylinder placed behind a stationary square cylinder in tandem arrangement are investigated the objective of this study is to explore the effects of parameters including reynolds number re and reduced velocity u r the characteristics of wiv dynamic responses at different re and the mechanism of wake induced vibration for the two cylinder system in the laminar flow region the framework of this study is presented as follows the details of the arbitrary lagrangian eulerian ale forms of the fluid governing equations and the solid movement equations are described in section 2 to validate the computational code a study of 2 dof viv of the single square cylinder is carried out and the simulated results are compared with the existing data in section 3 in section 4 the problem description of the wiv of a 2 dof square cylinder behind a stationary square cylinder is detailed the flow characteristics and dynamic behaviors of the downstream square cylinder as well as the wake induced vibration mechanism underlying the dynamic responses of the cylinder are elaborated in section 5 finally conclusions of the study are provided in section 6 2 governing equations and numerical scheme to account for the fluid dynamics in the viv and wiv systems the non dimensional navier stokes n s equation and the continuity equation for the incompressible viscous flow are employed and presented in eqs 1 and 2 both equations are described under the ale framework see donea et al 1982 as follows 1 u i t u j w j u i x j 1 re 2 u i x j x j p x i 0 2 u i x i 0 where u i represents the fluid velocity w i is the grid velocity tensor in the i th direction p is the pressure x i i 1 2 in the 2 d problem and 1 2 3 in the 3 d problem is the cartesian coordinates and t is the time furthermore the reynolds number is re u d v where d 1 0 is the characteristic length in the non dimensional fluid domain u the free stream velocity and v the fluid kinematic viscosity equations 1 and 2 are solved by the characteristic based split cbs finite element method zienkiewicz and codina 1995 with the required steps shown in equations 3 5 the cbs scheme is employed due to its simple formulations and easy implementation in the numerical code under the framework of the fractional step method an intermediate velocity u i is introduced three computational steps can be reconstructed from 1 and 2 within a time step δt in step 1 i e eq 3 from which the intermediate velocity u i is obtained half of the diffusion and the stabilized terms in the cbs method are implicitly treated while the other half are explicitly coped with in step 2 i e eq 4 the pressure p n 1 can be calculated by using the u i in step 3 i e eq 5 the velocities u i n 1 are further calculated details of the cbs algorithm can be found in our previous paper han et al 2014 3 u i u i n δ t 1 2 re 2 u i x j x j δ t 2 u k n w k n x k u j n w j n u i x j u j n w j n u i n x j 1 2 re 2 u i n x j x j 4 2 p n 1 x j x j 1 δ t u j x j 5 u i n 1 u i δ t p n 1 x i the movement governing equations of the oscillating cylinder with two degrees of freedom 2 dof is modeled as a mass spring damper system as 6 2 x t 2 4 π ξ u r x t 2 π u r 2 x c d 2 m r 7 2 y t 2 4 π ξ u r y t 2 π u r 2 y c l 2 m r where the x and y are the cylinder displacements in the x 1 and x 2 direction m r m m is the cylinder s non dimensional reduced mass where m is the square cylinder mass of a unit length and m is the displaced mass of fluid ξ is the structural damping ratio u r u f n d represents the reduced velocity where f n is the natural frequency of the cylinder c l 2f l ρu 2 d and c d 2f d ρu 2 d are the lift and drag coefficients as f l and f d are the x 1 and x 2 components of fluid force applied on the cylinder the cylinder motion within a time step will bring the updating of the grid movement the grid displacement w i is calculated using a laplace related algorithm shown as follows 8 1 γ w i j j 0 where γ is a parameter for controlling the mesh deformation details of the grid updating scheme were introduced in wang et al 2014 for solving the viv case which is one of the typical fluid structure interaction fsi problems the staggered algorithm is employed this scheme has been used for satisfactory solutions as shown in the publications by ahn and kallinderis 2006 placzek et al 2009 bao et al 2011 and han et al 2014 briefly the computational steps during one time interval δt t n 1 t n are summarized as follows a obtain the velocities and pressure in the fluid domain by the cbs algorithm b calculate the drag and lift coefficients c d n 1 and c l n 1 of the cylinder and compute the cylinder motions x n 1 and y n 1 by the newmark β type method han et al 2015 c determine the updated grid movements w i n 1 using the equation and d return to step a to restart a new iteration step until the viv behaviors become stable 3 code verification verification studies have been carried out in our previous work han et al 2014 by employing the cases of viv of a circular cylinder and wake induced vibration of a two cylinder system and comparing the numerical results with the data from existing references borazjani and sotiropoulos 2009 bao et al 2011 carmo et al 2011 we further validate the accuracy of the computational approach by solving the viv of an isolated cylinder with two degrees of freedom and wiv of an square cylinder with two degrees of freedom behind a stationary square one in uniform cross flow 3 1 viv of an isolated square cylinder this example has also been taken as a reference by zhao et al 2013 and jaiman et al 2016 the free oscillation of a square cylinder with 2 dof is carried out in the subsection the size of the flow domain and the geometry of the model and boundary conditions are given in fig 1 a the cylinder whose center is located at point 0 0 has a side length d 1 0 which is also equal to the characteristic length the entire computational domain is defined as ω 20d 50d 20d 20d on the surface of the cylinder defined as u x v y a uniform flow used at the inlet of the computational domain as a boundary condition is prescribed to be u x u 1 0 and u y 0 0 while the pressure is set to zero at the outlet symmetry conditions are used at the lateral boundaries as u x y 0 0 and u y 0 0 the system parameters are set as follows reduced mass m r 3 0 damping ratio ξ 0 0 reduced velocity 1 u r 20 reynolds number re 100 and δt 0 002 the schematic mesh grids near the cylinder is illustrated in fig 1 b to test the mesh independence a mesh refinement study is performed three groups of grid systems are adopted in the current examples in grid i there are 100 nodes on the surface of the cylinder while in grid ii and grid iii there are 200 and 400 nodes respectively some details of the three groups are provided in table 1 which also provided the results of some grid parameters note the percentages of changes compared to those of grid i are shown in brackets it is observed that the maximum deviation of results such as x max and y max is 5 31 when comparing grid ii with grid i whereas no significant change exists between grid ii and grid iii only 1 81 change in the value of x max therefore all the investigations presented hereafter are based on the mesh characteristics of grid ii the non dimensional transverse maximum amplitudes y max d of the numerical simulations are illustrated in fig 2 against the existing data as shown in fig 2 these results are in good agreement with each other hence validating that the numerical scheme and resolution used in this paper are adequately accurate and reliable for the solution of viv of the square cylinder in the laminar region 3 2 wiv of a 2 dof square cylinder behind a stationary square cylinder in order to test the suitability of the current algorithm for the complex flow problem a second case is selected from jaiman et al 2016 the wiv of a square cylinder with 2 dof behind a fixed square one is carried out in the subsection the representation of this problem is schematically illustrated in fig 3 a two square cylinders are positioned in the fluid domain with an inline configuration the fluid domain is configured as 30d 70d 30d 30d and the centers of the two cylinders are placed at 4 0d 0 and 0 0 so that the spacing ratio is fixed as l d 4 0 the upstream square cylinder is kept stationary while the downstream square cylinder is capable of freely oscillating with 2 dof characteristics by connecting with a spring damping system in the inline and transverse directions respectively the flow boundary conditions are the same as those in the previous a single cylinder study each cylinder surface is divided into 200 equal parts seen in fig 3 b which is based on the mesh characteristics of grid ii in subsection 3 1 the system parameters are set as follows reduced mass m r 5 0 damping ratio ξ 0 0 reduced velocity 3 u r 20 reynolds number re 200 and δt 0 002 a comparison between the present results and prior numerical work is shown in fig 4 the comparison is based on the two physical quantities the root mean square value of the transverse amplitude y rms and the frequency ratio f l 2 f n f l 2 is lift force frequency of the downstream square cylinder it can be found from fig 4 that the present results agree well with those of jaiman et al 2016 and further verifying that the numerical scheme and resolution used in this paper are adequately accuracy and reliable for the solution of wiv of both square cylinders in tandem arrangement 4 problem description the computational model is illustrated in fig 3 most of the boundary conditions are the same as those in the wiv of a 2 dof square cylinder behind a fixed square one benchmark case in the previous section the only difference of the computational model is that the centers of the two cylinders are placed at 5 0d 0 and 0 0 respectively at l d 5 0 the effect of the rear cylinder on the upstream one become weak and the evolution of wake flow behind upstream cylinder is more distinct the system parameters are set as follows the natural frequencies of the square cylinder in the two directions are set identical as f n1 f n2 f n the reduced mass of the square cylinder is as low as m r 2 0 the damping coefficient of the dynamic systems for the square cylinder is kept zero in order to achieve maximum amplitudes during oscillations during the computations the reduced velocity u r u f n d is changed from 3 to 18 to test the effects of reynolds number on the wiv system reynolds number re u d v is set as 40 80 120 160 and 200 respectively the range of reynolds number falls in the laminar flow regime and enables the 2d computation in this work the changes of u r and re are realized by varying the values of f n and v respectively the dimensionless time step is δt 0 002 when the wiv system is fully developed and becomes stable the computation process stops 5 wiv of two square cylinders in tandem arrangement 5 1 flow pattern based on the simulations fig 5 summarizes the wake patterns and demonstrates how they are affected by reynolds number re and reduced velocity u r six types of fully developed flow patterns 2s 2s 2p p s 2t and steady were observed at different re and u r where s means a single vortex p means a pair of vortices and t means a triplet of vortices at lower re 2s steady and 2s are the dominant modes as seen in fig 6 a c the vortex street is not formed in the gap between both cylinders and the wake region of the rear square cylinder at 3 u r 7 re 40 and 5 u r 6 re 80 called steady pattern as seen in fig 6 a with an increasing u r the occurrence of vortex shedding in the wake region of the downstream cylinder can be observed at re 40 it can be noted that at 8 u r 16 there is no vortex street in the gap between both cylinders and the vortex shedding occurs in the near wake region of the downstream cylinder as seen in fig 6 b which is similar with the pattern of the vortex shed from downstream cylinder reported in zhao et al 2016 with the further increasing of u r the vortex shedding occurs in the far wake region of the downstream cylinder known as the 2s pattern as seen in fig 6 c in addition its effect on the downstream cylinder is insignificant and the dynamic responses of the downstream cylinder in each direction are suppressed these findings are consistent with the results of wang et al 2014 and jaiman et al 2016 with the increasing of re the vortex street occurs in the gap region as seen in fig 6 d at re 80 and 120 the predominant vortex shedding pattern is the 2s mode in particular for the case of re 160 only 2s mode is observed in the case of u r 5 and the vortex shedding pattern becomes p s mode at u r 6 see fig 6 e with the further increase of re three types of patterns occur at re 200 which are 2s mode at 4 u r 6 2p mode at u r 3 7 u r 13 and 17 u r 18 see fig 5 f and 2t mode at 14 u r 16 see fig 6 g 5 2 frequency analysis fig 7 shows the relationship between frequency ratio and the reduced velocity at different reynolds numbers in the wiv system these frequencies are defined as follows f n the natural frequency of the circular cylinder f l 1 the main frequency of the lift coefficient of the stationary upstream square cylinder st x and st y the main oscillation frequency of the square cylinder in the inline and transverse direction respectively for lower reynolds numbers the frequency ratios gradually increase with the increase in reduced velocity except for the smaller reduced velocity as shown in fig 7 a and b it can be observed that the frequency ratios are around zero in the range of 3 u r 7 re 40 and 5 u r 6 re 80 respectively a possible explanation for this feature is that the flow around the wiv system resembles steady pattern as seen in fig 6 a the main oscillation frequency in the transverse direction st y is close to the frequency of vortex shedding of the upstream square cylinder which is the frequency of the lift coefficient f l 1 in the range of 8 u r 15 re 40 and 7 u r 16 re 80 as reynolds number increases up to 120 the st y is close to the f l 1 in each case the values of st x f n st y f n and f l 1 f n continuously increase along with the increasing values of u r for the case of re 160 and re 200 the trends of frequency ratios are similar to that for the re 120 case however there are a few exceptions at u r 6 re 160 the values of st x st y and f l 1 are equal to each other regardless at u r 6 and re 200 the st y is inconsistent with the f l 1 on the other hand the change of re has a great influence on the resonance region of the downstream square cylinder at re 40 the transverse vibration frequency is close to the natural frequency in the range of 9 u r 11 and the synchronization phenomenon does not occur in the inline direction yet for the case of re 80 the resonance range changes to 7 u r 9 in the transverse direction for larger re the synchronization phenomenon of the in line motion occurs at the smaller u r however for the transverse vibration the synchronization phenomenon occurs at 6 u r 8 re 120 and 160 and 5 u r 8 re 200 5 3 dynamic responses 5 3 1 amplitudes in this subsection the 2 dof wiv dynamic characteristics of the downstream square cylinder are presented the variations of the maximum amplitudes in both inline and transverse directions at different reynolds numbers are presented in fig 8 the gap flow plays a key role in the two cylinder dynamic system in the tandem arrangement the same behavior was also observed in the other studies in the literature borazjani and sotiropoulos 2009 bao et al 2011 tu et al 2015 as re increases the effect of wake of the upstream cylinder on the dynamic response of the downstream one becomes stronger and the mechanism of vivs of two tandem cylinders changes from flow interference to the wake interference the x max and y max are the maximum vibrating amplitudes in both inline and transverse directions within one stable vibrating cycle defined as x max x min 2 and y max y min 2 respectively it can be observed from fig 8 that the oscillation amplitude at the inline direction is very small at re 40 and the downstream cylinder is in the state of no lock in while lock in phenomenon only occurs in the transverse direction this dynamic response feature confirms the vibration frequency synchronization region at the inline direction as reported in the previous section for the transverse direction the vibration amplitude of the square cylinder is very small at lower reduced velocities 3 u r 7 a possible explanation for this feature is that the flow characteristics resemble steady state and there is no vortex street in the wake of both the upstream and downstream square cylinders as seen in fig 9 a and it leads the downstream cylinder to oscillate at very small amplitude this phenomenon was also observed in han et al 2014 with the increasing of u r the vortex shedding pattern changes from the steady to the 2s pattern there is no vortex street behind the upstream square cylinder as seen in fig 9 b resulting in the downstream cylinder oscillating with large amplitude the transverse amplitude reaches a peak at u r 9 then gradually decreases for the larger reduced velocities it can be observed that the main oscillation frequency in the transverse direction st y is not close to the natural frequency of square cylinder and the vortex shedding pattern changes from the 2s pattern to the 2s which gives rise to the reducing oscillating response at re 80 except for u r 3 and u r 7 the trends of vibration amplitude in both inline and transverse directions are the same as those of the re 40 case with the increasing of u r the formation of vortex street resembles 2s mode in the gap between both cylinders and the wake flow of the downstream cylinder as seen in fig 10 which leads the downstream cylinder to vibrate at lager amplitude additionally the effect of the downstream cylinder on the upstream one becomes stronger and the transverse oscillation amplitude is larger than that of re 40 case at larger u r for larger re the reynolds number has an insignificant influence on the dynamic response at the range of 3 u r 8 however at the higher u r the effect of re on the large oscillation region in the inline direction is obvious note that at u r 4 while the oscillation frequency is not close to the natural frequency the vibration amplitude reaches a relatively larger value this phenomenon is called soft lock in reported by mittal and kumar 1999 prasanth and mittal 2008 borazjani and sotiropoulos 2009 and tu et al 2014 in addition a dramatic change can be found at u r 5 the transverse amplitudes at re 120 and 160 are much smaller than that of re 200 this is caused by the change of the characteristics of the oscillation frequency and the flow in the wiv system and it leads to the change of flow force and oscillation amplitude the transverse oscillation frequency is close to the natural one with the increasing of re as seen in fig 7 c 7 e in addition the flow pattern transforms from 2s to 2s with the increasing of the re as seen in fig 11 one can be easily observed that the flow forces c d and c l in the case of u r 5 and re 120 are smaller than those of the case of u r 5 and re 200 especially the maximum value of c l at re 200 is around seven times of that for re 120 and the oscillation amplitude in the transverse direction changes from 0 028d to 0 42d on the other hand for the case of u r 5 and re 120 the characteristics of flow field leads the drag force on the surface of the downstream square cylinder to be negative seen in fig 11 a hence the motion trajectory of the cylinder is at the left of the initial position on the contrary at u r 5 and re 200 the value of c d is positive and its orbit is to the right of the initial position seen in fig 11 b with the increasing of u r the motion of the downstream square cylinder in the inline direction varies greatly it can also be seen that the large vibration amplitude region is u r 10 re 120 9 u r 13 re 160 and 13 u r 18 re 200 respectively it is worth noting that the peaks of the oscillation amplitude in both inline and transverse directions occur at u r 9 and re 160 under the action of coming upstream square cylinder wake the time of each cycle for the rear square one is longer and shows a modulation period seen in fig 12 a meanwhile there are some dramatic decreases in the time history curves of c d and c l resulting in the change of the dynamic response of the oscillation square cylinder a possible explanation for this feature is that the transition of the wake characteristics occurs near the downstream square cylinder seen in fig 12 b at time step i the wake structure near the downstream square cylinder shows irregular which leads the drag force to be minimum and the downstream square cylinder near the left maximum position however at time step ii the downstream square cylinder is near the right and bottom maximum position and the forming of distinct vortex street is formed behind the downstream cylinder additionally the phase portrait of c l relative to y d shows out phase state this finding is supported by jaiman et al 2016 and they claimed that the phase angle between life coefficient and transverse displacement is about 180 in galloping region and the wake characteristics is irregular 5 3 2 x y trajectories in general the trajectory of an elastically mounted square cylinder behind a stationary square cylinder mainly resembles the figure 8 shape and the motion trajectory of the downstream cylinder is symmetrical to the central line y 0 at smaller re while the motion shows figure dual 8 and irregular shape at larger re the lissajous figures of the trajectory for the downstream square cylinder at different reduced velocities when re 40 80 120 160 and 200 are presented in fig 13 17 respectively for the smaller re the x y trajectory is similar to those expected for an isolated square cylinder and the motion trajectories of the square cylinder resemble figure 8 motion as seen in fig 13 it can also be seen that the downstream square cylinder motions are quite small in the unlock in region however in the range of lock in the oscillation amplitude is large in the transverse direction it represents the result associated with the single resonance which means synchronization only in the transverse direction at re 80 and 120 the downstream square cylinder orbital trajectory is figure 8 motion except for the u r 14 case as seen in figs 14 and 15 the lissajous figure of the cylinder exhibits the vertical figure dual 8 at u r 14 and re 80 meanwhile for the case of re 120 the shape of cylinder motion becomes irregular and similar to the tandem figure dual 8 with the increase in re the characteristics of flow field becomes complex inducing the complex change of the dynamic responses of the downstream cylinder the cylinder orbital trajectories is predominantly figure 8 at the range of 3 u r 12 while the motion of the downstream cylinder acts as a modulation period and the shape of cylinder motion changes from the figure 8 to the irregular shape at the larger u r the same finding has been observed in our previous work han et al 2014 it is caused by the longer vibration cycle of the cylinder it is note worthy that the motion trajectory of the downstream cylinder show irregular figure 8 which is asymmetrical to the line of y 0 and the upper loop is bigger than the lower loop see figs 16 b and 17 a this phenomenon is consistent with the asymmetrical vortex shedding structure from the upper and lower sides of the downstream square cylinder presented in fig 6 e although the cause of this asymmetry is unknown at this stage 5 4 vortex dynamics of the wake induced vibration wiv the mechanism of wiv between the stationary square cylinder and the elastically mounted cylinder was investigated in terms of the instantaneous flow field in order to explain the effect of the reynolds number on the vortex flow structure behind the stationary upstream and downstream square cylinder where specific oscillatory modes were excited in the wake interference region the instantaneous vorticity contours and time histories in terms of the downstream cylinder flow forces and displacements in both in line and cross flow directions at two different reynolds numbers re 80 and re 200 at u r 14 are illustrated in figs 18 and 19 respectively it can be seen in fig 18 for the case of u r 14 and re 80 that there is an obvious vortex street in the separation and the vortex street shows a 2s pattern in the wake region of the downstream square cylinder yet the vortex structure in the gap between the cylinders is not fully developed when it hits the downstream body given rise to weakening the influence on the dynamic response of the downstream cylinder in stage i it is observed in the time history plot that the downstream cylinder is close to the initial position in the transverse direction the vortex sheds from the lower side of the upstream cylinder hits the front and lower part of the downstream cylinder meanwhile the strength of the clockwise rotating vortex gradually increases at the upper side of the downstream cylinder it causes the upward deceleration motion until the cylinder reaches the maximum transverse position in stage ii the clockwise rotating vortex starts to shed from the upper shear layer of the downstream cylinder and the counter clockwise rotating vortex develops at the lower side of it however the opposite is observed in stage iii and stage iv where the cylinder moves downwards and returns to the initial position after which the displacement of the cylinder reaches the maximum value in the downward direction furthermore the counter clockwise rotating vortex develops well and sheds from the lower shear layer of the downstream cylinder the clockwise rotating vortex sheds at the upper side of it and then a new vortex is generated for the large reynolds number re 200 the dynamic responses and flow characteristics of wiv are entirely different from those of re 80 case as shown in fig 19 the period of oscillation is longer and acts as a modulation period furthermore the effect of flow characteristics on the motion amplitude is significant the wake flow field near the downstream square cylinder is complicated for the smaller oscillation amplitude as shown in stage i and stage iv given rise to the change of the flow forces on the surface of the downstream square cylinder however for the larger oscillation the pattern of vortex shedding behind the square cylinder resembles 2t mode as shown in stage ii and stage iii it is worth noting that the vortex shed from the upstream cylinder impinges on the downstream cylinder and each shed vortex splits into two resulting in the forming of distinct vortex street behind the downstream cylinder additionally the phase portrait of c l relative to y d shows out phase state which is similar with that of the case of u r 9 and re 160 however the phase portrait of c d relative to x d becomes in phase with the change of re resulting in a larger amplitude inline oscillation and a dual resonance hence with the increasing of re the wake interference and the oscillation amplitude intensify 6 conclusions complexity arises when two square cylinders are placed in tandem due to the potential wake induced vibration wiv wake induced vibration of a 2 dof square cylinder placed behind a stationary square cylinder was investigated by using a characteristics based split cbs finite element method the spacing ratio l d of the two equal size cylinders was as high as 5 0 the reynolds number was varied from 40 to 200 to illustrate its impact on the flow patterns oscillation frequency characteristics and dynamic behaviors of the wiv system key findings and conclusions are summarized as follows i six types of vortex shedding pattern such as 2s 2s 2p p s 2t and steady were observed it is noteworthy that a steady pattern occurred at the smaller re re 40 and 80 and the vortex street was not obvious in the separation at 7 u r 17 re 40 u r 4 re 80 u r 5 re 120 and 160 and 5 u r 6 re 200 respectively hence a significant change of the body motion results from the impact on flow characteristics from the reynolds number and reduced velocity ii with the increasing of re the change of frequency characteristics occurs and the predominant mechanism of wiv of the square cylinder behind a stationary square one transforms to wake interference for smaller re the downstream square cylinder only exhibited the single resonance phenomenon in the transverse direction however for higher re the dual resonance phenomenon was found at the larger u r iii compared to the single square cylinder case the motion orbit of the downstream cylinder was found to be more complex the prominent x y trajectories of the downstream square cylinder were figure 8 figure dual 8 and irregular shapes in addition the effect of the reynolds number on the lissajous figures of the motion was significant iv the wake induced vibration mechanism underlying the dynamic responses of the downstream cylinder is revealed the 2t vortex shedding pattern is observed in this investigation at u r 14 and re 200 and its mechanism is analyzed acknowledgements the authors are grateful for the financial supports from the national natural science foundation of china nos 51679139 11602214 11772193 the major program of the national natural science foundation of china no 51490674 the program for professor of special appointment eastern scholar at shanghai institutions of higher learning shanghai national science foundation no 17zr1415100 and 18zr1418000 research program of shanghai leader talent no 20 program for intergovernmental international s t cooperation projects of shanghai municipality no 18290710600 project of thousand youth talents no be0100002 this work is also sponsored by shanghai pujiang program no 17pj1404300 new enrolment support of shanghai jiao tong university no wf220401005 china postdoctoral science foundation no 2017m622593 and hunan provincial natural science foundation of china no 2016jj3117 the authors would like to express their gratitude to the editors and reviewers for their valuable help on this work 
23218,one of the challenges of the installation of subsea equipment is the precise positioning of the equipment in a desired location on the seabed this positioning procedure is still commonly performed manually by an operator this article presents a trajectory tracking control system design for the positioning of a subsea equipment this work will be done in two stages first a motion planning for dynamic positioning system of platform is presented for this an analytical solution of motion equation of the riser which is modeled as a damped cable is detailed this analytical solution when compared to numerical solutions has the advantage of generating more precise and smooth trajectories for the system input and output second we propose a tracking control system to ensure that the subsea equipment follows the desired trajectory in the presence of disturbances more precisely a linear state feedback control law is proposed using a reduced model which is obtained from a modal reduction with delay insertion this delay insertion provides a high precision low order model this fact highly increase the robustness of the control system to the measurement noise numerical simulations and experimental tests are presented to evaluated the proposed control strategy keywords subsea equipment installation motion planning modal reduction trajectory tracking damped cable analytical solution 1 introduction nowadays with the offshore exploration and production of oil and gas moving towards deeper waters 2000 m and more subsea installation has become a major topic in the offshore oil industry several subsea equipment are constructed onshore and transported offshore to the installation site such as the christmas tree the blow out preventer and the manifold one of the challenges of the installation of the subsea equipment in deep water is the precise positioning of the equipment in the desired location on the seabed according to bai and bai 2012 there are two methods that are widely used for positioning the guideline method and the guideline less one the guideline method uses guides cables typically four tensioned cables to position the subsea equipment in the desired location on the seabed the positioning using this method is very convenient but limited by the very use of the guides cables as highlighted in bai and bai 2012 for facilities in deep water this method can be quite costly both in time and value in turn the guideline less method positions the subsea equipment without any guides cables the subsea equipment has its position changed indirectly by modifying the position of the vessel or by a crane system however due to the dynamic behavior of the system and the required space limitations this method is relatively complex sometimes in the guideline less method it is also coupled with a propulsion system in the subsea equipment in order to adjust its position directly as can be seen in how et al 2007 2010 2011 however the range of this adjustment is limited to a certain area determined by the capacity of the thrusters furthermore for very heavy systems like subsea systems the required strength of the thrusters to move the system is too large preventing the operation due to operational cost the precise positioning of subsea equipment is even more difficult in deep water due to the large distance between the surface vessel and the equipment to be placed on the seabed environmental disturbances such as ocean currents waves and winds relatively small can cause large gaps between the actual position of the submarine equipment and its expected position in addition severe weather conditions can force the positioning operation to wait several days until it becomes possible this paper address the case of positioning of a subsea equipment in deep waters by the guideline less method and without adding the propulsion system to the equipment the positioning of the structure top riser cable etc is determined by a dynamic positioning dp system and a crane system whereas the subsea equipment is positioned indirectly by the motion transmission through the structure top st thus the desired position for the subsea equipment is obtained only with the correct displacement of the st currently this positioning procedure is still commonly performed manually that is an operator displaces the st considering the images of the subsea equipment produced by a remotely operated vehicle rov thus the operator can adjust the position of the st in order to position and install the subsea equipment in the desired location therefore this operation becomes totally dependent on the experience and skill of the operator another limitation is that this operation can only be performed in the presence of good weather and underwater visibility in this context the continuous development of researches and technologies to increase the efficiency and reliability of the subsea installation operation is necessary making it faster and safer and also expand the range of climatic conditions in which it can be performed i e ultrasonic sensors can be used to close the loop in the cases of low underwater visibility a typical subsea installation procedure is shown in fig 1 which basically consists of a platform a marine riser and a subsea equipment to be positioned the platform is equipped with a dp system which allows modifying its position by thrusters and propellers the upper end of the riser is connected to the platform and its lower end is connected to the subsea equipment a rov monitors the subsea position throughout the operation the system can be represented by a master slave architecture fig 2 the slave loop refers to the dp system and the platform and its dynamics is much faster compared to the dynamics of the master loop in turn the master loop refers to the riser the subsea equipment and the operator the dynamics of the master loop is influenced mainly by the spread of mechanical wave along the riser it is noteworthy that in this paper the analysis will be focused only on the master loop and will be considered that the dp system positions the platform at the desired position instantly the strategy consists of positioning the subsea equipment in the desired position on the seabed dynamically modifying the upper end of the riser which displacement is determined by the dp system of the platform this allows to determine the precise platform motion which is necessary to obtain the desired position of the subsea equipment displacement and stabilization of the subsea equipment the position of the subsea equipment is monitored by the images produced in real time by a rov thus the installation of the subsea equipment may be carried out without the direct interference of the operator even in the presence of external disturbances this automated process also tends to increase the reliability and efficiency of operation reducing the total time and the risk of damage to the subsea equipment from a control point of view this papers deals with the control of an infinite order system defined by a partial differential equation pde one can highlight the work of meurer and zeitz 2005 that used formal power series parametrization to represent a system of a tubular reactor bringing similar representation to the modal basis however a high order state observer is obtained from the model in turn schröck et al 2012 attempted the use of a spectral representation based on the natural frequencies of the system to represent piezo actuated flexible structures which also presents a representation of the dynamical system similar to a vibration modes representation this paper is organized as follows section 2 presents the governing equation of the system section 3 derives the analytical solution of the governing equation in the time domain section 4 presents the numerical simulation of the structure section 5 describes the reduced model obtained for the system section 6 presents the feedback control to track the trajectory section 7 discusses the experimental results and in the last section the conclusion and further works are presented 2 governing equation typically structures used in the installation of subsea equipment such as risers are slender and their transverse displacements are small compared to their length in the case of a riser with constant cross section and under traction the dynamic behavior of an infinitesimal element of the riser toward its horizontal displacement can be modeled by the euler bernoulli beam equation 1 under external forces from the fluid in which it is submerged 1 m s 2 ϒ t 2 z t e j 4 ϒ z 4 z t z t z ϒ z z t f h z t where ϒ is the position of the riser in the horizontal direction on the plane including the subsea equipment and its final destination ϒ is function of two parameters the time t and the height z from the seabed the other variables are m s the riser linear mass t z the function that describes the tension force along the structure s length e the young s modulus j the second moment of area and f h the external forces in the horizontal direction per unit length the external forces acting in the structure except on its top and bottom ends where external forces are present due to the boundary conditions can be approximated by the modified morison s equation eq 2 represents the hydrodynamic forces associated with the displacement of a submerged body and do not include side forces resulting from the oscillatory vortex shedding around the structure 2 f h z t m f 2 ϒ t 2 z t μ ϒ t z t ϒ t z t where m f is the additional fluid mass per unit length and μ is the drag per unit length the additional fluid mass is defined by m f ρ c m s where ρ is the fluid density c m is the added mass coefficient and s is the cross sectional area of the riser the drag is defined by μ 1 2 ρ c d d where c d is the drag coefficient and d is the outer diameter of the riser denoting m m s m f and considering the hydrodynamic forces 2 as the only external forces 1 becomes 3 2 ϒ t 2 z t e j m 4 ϒ z 4 z t z t z m ϒ z z t μ m ϒ t z t ϒ t z t due to the low reynolds number of the flow the dissipative drag term can be linearized by replacing μ m ϒ t z t by the constant 2 α which is calculated on the basis of μ m and the average of ϒ t z t along the structure thus 4 represents the system governing equation for the linearized damping 4 2 ϒ t 2 z t e j m 4 ϒ z 4 z t z t z m ϒ z z t 2 α ϒ t z t for the installation of subsea equipment in water depths of 2000 m and greater the weight of the structure and the weight of the subsea equipment have similar orders of magnitude and thus can neither be neglected the tension t z is formulated from the difference between the total weight and the buoyancy therefore t z m s ρ s g z t e where t e is the normal tension associated to the subsea equipment attached to the bottom end t e m e ρ v e g being m e the mass of subsea equipment v e its volume and g the acceleration due to gravity as risers for that water depth are very long structures the span depth ratio d l is on the order of 10 4 or lower thus as z t z ϒ z e j 4 ϒ z 4 the beam therm e j 4 ϒ z 4 which is associated to the bending resistance may be neglected fortaleza 2009 therefore considering this simplification the system equation becomes 5 2 ϒ t 2 z t z m s ρ g z m t e m ϒ z z t 2 α ϒ t z t to simplify the notation the constant term m s ρ s g m can be replaced by the effective gravity g and the constant term t e m can be replaced by v 2 where v is known to be the mechanical wave propagation speed on the riser so the 5 becomes 6 2 ϒ t 2 z t g ϒ z z t g z v 2 2 ϒ z 2 z t 2 α ϒ t z t 3 analytical solution in this section the analytical solution of 6 in the time domain is proposed following the idea proposed by petit and rouchon 2001 of solution in laplace domain and subsequent reversal to the time domain petit and rouchon 2001 solved the positioning of an undamped cable and subsequently fortaleza et al 2011 adapted for the case with damping however without a punctual mass in the structure bottom in the works of fortaleza et al 2012 and albuquerque 2012 the same strategy was used to solve the case of positioning a subsea equipment by a riser however the tension along the structure s length t z was assumed to be constant due only the heavy subsea equipment neglecting the cable s own weight proposition 3 1 the displacement of the riser in the time domain is given by ϒ z t 2 π g 1 1 u x 2 z k t η 1 1 k 2 d k 2 g 1 u x 2 z k t η 2 1 k 2 d k where η 1 c 1 t x 2 z k e α x 2 z k g 3 x 2 z k t x 2 z k η 2 c 2 t x 2 z k e α x 2 z k g 4 x 2 z k t x 2 z k proof the first step is to apply the t laplace transform on 6 and considering the system at rest at t 0 the pde can be rewritten as the following ordinary differential equation ode regarding spacial derivatives only 7 g z v 2 2 ϒ ˆ z 2 z s g ϒ ˆ z z s s 2 2 α s ϒ ˆ z s 0 where ϒ ˆ is the laplace transform of ϒ the solution of 7 with respect to z is 8 ϒ ˆ z s 2 g c ˆ 1 s i 0 2 s 2 2 α s v 2 g z g 2 2 g c ˆ 2 s k 0 2 s 2 2 α s v 2 g z g 2 where c ˆ 1 s and c ˆ 2 s are the functions to be determined by the system s boundary conditions i ν and k ν are the modified bessel functions of the first and second kind of order ν respectively abramowitz and stegun 1972 to determine c ˆ 1 s and c ˆ 2 s it is necessary two boundary conditions the two boundary conditions are the reference trajectory of the bottom end ϒ 0 t and its spacial derivative ϒ z 0 t that represents the riser slope at its bottom end in this article ϒ 0 t is set as a polynomial trajectory that smoothly migrates from an initial position to a final position in a specified stabilization time the second boundary condition is obtained from the dynamics of the subsea equipment eq 9 is obtained for the subsea equipment from the newton s second law of motion 9 m e 2 ϒ t 2 0 t f e t f h 0 t where f e is the riser s force on the subsea equipment and f h is the hydrodynamic forces also defined by 2 f e is proportional to the riser s slope and defined as f e t t e ϒ z 0 t also considering the linearized dissipative drag and rearranging 9 the second boundary condition is 10 ϒ z 0 t 1 t e m t e 2 ϒ t 2 0 t 2 α e ϒ t 0 t where m t e is the subsea equipment mass added to its additional fluid mass and α e is its linearized drag differentiating 8 in relation to the coordinate z and assuming z 0 the following system is obtained 11 ϒ ˆ 0 s 2 g c ˆ 1 s i 0 2 v g s 2 2 α s 2 g c ˆ 2 s k 0 2 v g s 2 2 α s ϒ ˆ z 0 s 2 g s 2 2 α s v c ˆ 1 s i 1 2 v g s 2 2 α s 2 g s 2 2 α s v c ˆ 2 s k 1 2 v g s 2 2 α s solving system 11 the functions c ˆ 1 s and c ˆ 2 s are determined 12 c ˆ 1 s g 2 k 1 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ 0 s g 2 v s 2 2 α s k 0 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ z 0 s 13 c ˆ 2 s g 2 i 1 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ 0 s g 2 v s 2 2 α s i 0 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ z 0 s where x 2 v g s 2 2 α s the wronskian between two modified bessel functions is w k ν x i ν x i ν x k ν 1 x i ν 1 x k ν x 1 x abramowitz and stegun 1972 therefore 12 and 13 can be rewritten 14 c ˆ 1 s v 2 g s 2 2 α s k 1 2 v g s 2 2 α s ϒ ˆ 0 s v 2 2 g s 2 2 α s k 0 2 v g s 2 2 α s ϒ ˆ z 0 s 15 c ˆ 2 s v 2 g s 2 2 α s i 1 2 v g s 2 2 α s ϒ ˆ 0 s v 2 2 g s 2 2 α s i 0 2 v g s 2 2 α s ϒ ˆ z 0 s another way to represent the modified bessel function is by its integral representation abramowitz and stegun 1972 thus 14 and 15 becomes 16 c ˆ 1 s v 2 2 2 g g k ˆ s 1 e 2 v g s 2 2 α s k k 2 1 d k v 2 2 g ϒ ˆ z 0 s 1 e 2 v g s 2 2 α s k k 2 1 d k 17 c ˆ 2 s v 2 2 2 π g g k ˆ s 1 1 e 2 v g s 2 2 α s k 1 k 2 d k v 2 2 π g ϒ ˆ z 0 s 1 1 e 2 v g s 2 2 α s k 1 k 2 d k where k ˆ s s 2 2 α s ϒ ˆ 0 s to return to the time domain the inverse laplace transformation should be applied as k ˆ s and ϒ ˆ z 0 s are only functions of s they can be placed in the integrand of 16 and 17 the identity presented by 18 can be used to inverse the laplace transform mikusinski 2014 18 e x s 2 2 α s e α x e x s f x t e x s where f x t x t 2 2 x t e α x t i α j 1 i α t 2 2 x t with j ν is the bessel function of the first kind of order ν abramowitz and stegun 1972 to simplify the notation we use x 1 k 2 v g k then applying 18 in 16 and 17 19 c ˆ 1 s v 2 2 2 g g 1 η 3 e x 1 k s k 2 1 d k v 2 2 g 1 η 4 e x 1 k s k 2 1 d k 20 c ˆ 2 s v 2 2 2 π g g 1 1 η 3 e x 1 k s 1 k 2 d k v 2 2 π g 1 1 η 4 e x 1 k s 1 k 2 d k where η 3 k ˆ s e α x 1 k g ˆ 1 x 1 k s η 4 ϒ ˆ z 0 s e α x 1 k g ˆ 2 x 1 k s with g ˆ 1 x 1 k s f ˆ x 1 k s k ˆ s and g ˆ 2 x 1 k s f ˆ x 1 k s ϒ ˆ z 0 s the inverse laplace transformation of the product of two functions can be calculated by the convolution formula mikusinski 2014 thus the functions g 1 x 1 k t and g 2 x 1 k t are obtained 21 g 1 x 1 k t 0 t f x 1 k τ k t τ d τ 22 g 2 x 1 k t 0 t f x 1 k τ ϒ z 0 t τ d τ where k t u 0 t 2 α ϒ t 0 t 2 ϒ t 2 0 t also obtained by the convolution of s 2 2 α s and ϒ ˆ 0 s the variable u 0 is the unit step function now applying the shifting theorem f t x u x t e x s f ˆ s both 19 and 20 can be rewritten in the time domain 23 c 1 t v 2 2 2 g g 1 u x 1 k t η 5 k 2 1 d k v 2 2 g 1 u x 1 k t η 6 k 2 1 d k 24 c 2 t v 2 2 2 π g g 1 1 u x 1 k t η 5 1 k 2 d k v 2 2 π g 1 1 u x 1 k t η 6 1 k 2 d k where η 5 k t x 1 k e α x 1 k g 1 x 1 k t x 1 k η 6 ϒ z 0 t x 1 k e α x 1 k g 2 x 1 k t x 1 k once both functions c 1 t and c 2 t are determined one can apply the inverse laplace transform on 8 to obtain the displacement of the riser in the time domain ϒ z t first representing the modified bessel functions by theirs integral representation eq 8 becomes 25 ϒ ˆ z s 2 π g c ˆ 1 s 1 1 e 2 v 2 g z g 2 s 2 2 α s k 1 k 2 d k 2 g c ˆ 2 s 1 e 2 v 2 g z g 2 s 2 2 α s k k 2 1 d k as c ˆ 1 s and c ˆ 2 s are only functions of s they can be placed in the integrand of 25 applying the identity presented in eq 18 and assuming x 2 z k 2 v 2 g z g 2 k eq 25 becomes 26 ϒ ˆ z s 2 π g 1 1 η 7 e x 2 z k s 1 k 2 d k 2 g 1 η 8 e x 2 z k s 1 k 2 d k where η 7 c ˆ 1 s e α x 2 z k g ˆ 3 x 2 z k s η 8 c ˆ 2 s e α x 2 z k g ˆ 4 x 2 z k s with g ˆ 3 x 2 z k s f ˆ x 2 z k s c ˆ 1 s and g ˆ 4 x 2 z k s f ˆ x 2 z k s c ˆ 2 s the functions g 3 x 2 z k t and g 4 x 2 z k t are also obtained by the convolution formula 27 g 3 x 2 z k t 0 t f x 2 z k τ c 1 t τ d τ 28 g 4 x 2 z k t 0 t f x 2 z k τ c 2 t τ d τ applying the shifting theorem eq 29 is obtained which represents the displacement of the riser in the time domain further details in simões 2016 29 ϒ z t 2 π g 1 1 u x 2 z k t η 1 1 k 2 d k 2 g 1 u x 2 z k t η 2 1 k 2 d k where η 1 c 1 t x 2 z k e α x 2 z k g 3 x 2 z k t x 2 z k η 2 c 2 t x 2 z k e α x 2 z k g 4 x 2 z k t x 2 z k the open loop solution is found integrating numerically eq 29 thus assuming z l being l the riser length the control trajectory ϒ o l t of the st is found in order to test the proposed analytical solution it is considered a case of subsea equipment positioning in deep waters by the platform drilling system the system parameters are given in table 1 the subsea equipment is assumed to be a steel sphere same material as the drilling riser the riser is assumed to be filled with sea water the system is considered to be stationary in the initial condition t 0 with the riser and the subsea equipment fully aligned to the vertical axis thus the first step in determining the control trajectory of the dp system is to specify a reference trajectory for the subsea equipment ϒ r 0 t it is adopted a polynomial trajectory that smoothly moves the subsea equipment 1 m away from its initial position fig 3 shows in red the reference trajectory of subsea equipment ϒ r 0 t and in black the control trajectory of the dp system ϒ o l t 4 numerical simulation of the structure in order to assess the analytical solution found a numerical simulation by finite difference method is proposed following the idea presented in fortaleza 2009 this method discretizes the continuous function ϒ z t and defines y t as a vector of the structure displacement for n equidistant points along the structure thus the governing pde 3 is approximated by a finite set of coupled odes 30 valid for all elements not affected by the boundary conditions 30 d 2 y n d t 2 e j m y n 2 4 y n 1 6 y n 4 y n 1 y n 2 l 4 n 1 g l v 2 y n 1 2 y n y n 1 l 2 g y n 1 y n 1 2 l 2 α d y n d t where n 3 n 2 is the element position l is the distance between two adjacent points l l n being the subsea equipment as the first element n 1 and the riser top end as the last element n n and considering u t as the platform position defined by the dp system the boundary conditions are at the subsea equipment the motion equation is given by 9 and 2 ϒ z 2 0 t 0 and at the top end ϒ l t u t and ϒ z l t 0 as the riser is attached to the platform by a fixed support thus the discrete system can be represented in a traditional state space form 31 x a x b u y c x where a is the state matrix 2 n 2 n b is the input matrix 2 n 1 and contains the acceleration of the structure associated to the riser top end displacement b 0 0 e j m l 4 3 e j m l 4 n 1 g l v 2 l 2 g 2 l t c is the output row matrix 1 2 n with only one non zero entry to obtain the subsea equipment displacement c 1 0 0 u is the control trajectory ϒ o l t y is the system output ϒ 0 t x is the state vector 2 n 1 x y 1 y n d y 1 d t d y n d t t and x is its time derivative the state matrix describes the system behavior 32 a 0 i a k 2 n 2 n where 0 is a null matrix n n i is an identity matrix n n k is a diagonal matrix n n containing the accelerations associated to the hydrodynamic damping and a is the stiffness matrix n n and contains the structure internal accelerations according to the discrete model presented 4 1 open loop results to verify the accuracy of the analytical solution proposed 29 with all its assumptions and simplifications the control trajectory ϒ o l t is used as the system input for numerical simulation of the discrete system 30 in all numerical simulations it was considered a system of order 200 since the system was discretized in n 100 elements as this step aims to validate the analytical solution no environmental disturbances was considered waves and currents also the parameters assumed in all simulations are presented in table 1 the numerical simulations were divided into two stages at first it was simulated the discrete model with linear dissipative drag 31 this step aimed to highlight the influence of neglecting the beam term e j 4 ϒ z 4 associated to the riser bending resistance fig 4 shows in blue the response of the numerical simulation which represents the trajectory of subsea equipment obtained by the numerical method ϒ n 0 t also featured are in red the reference trajectory of the subsea equipment ϒ r 0 t used as a boundary condition for the analytic solution and in black the control trajectory ϒ o l t obtained by the analytical method it is observed in fig 4 that the response of the numerical simulation ϒ n 0 t is very close to the reference trajectory of the subsea equipment as expected the assumption of modeling the riser disregarding its bending resistance is valid and does not significantly impact the system response the numerical method can also be used to simulate the system considering the non linear dissipative drag term of 3 the linear dissipative drag 2 α of the discrete system is replaced by the non linear damping μ m ϒ t z t see simões 2016 so in the second stage it was simulated the discrete model with the non linear dissipative drag this step aimed to highlight the influence of the drag term linearization fig 5 shows in blue the numerical simulation response ϒ n 0 t in red the reference subsea equipment trajectory ϒ r 0 t and in black the control trajectory ϒ o l t obtained by the analytical method it is noted from fig 5 that the trajectory of the subsea equipment obtained by numerical simulation with non linear drag is very close to the trajectory adopted as reference with only a small oscillation around the final position best shown in fig 6 by fig 6 it can be seen that the oscillation amplitude has the order of 6 10 3 m and therefore can not be considered as significant in the system response thus the simplification to linearize the dissipative drag term of the governing equation is considered valid 5 modal reduction in a real case of subsea installation there is the presence of unknown external disturbances such as ocean currents winds and waves thus to ensure the trajectory tracking task it is necessary to develop a control system thus this section has a primary and essential phase to the development of the control system which is to obtain a reduced model that will be used as the basis for the controller design the reduced model is obtained from the discrete model with linear drag 31 using a strategy of reducing the order based on the modal analysis theory a method widely used to reduce the order of one system and at the same time maintaining the original system behavior is the method of modal reduction this method is based on applying a coordinate transformation in the original system putting it in the modal base subsequently we analyze which system modes that influence their response modes that do not have significant contributions are eliminated reducing thereby the system order the transformation of coordinates that places the system in the modal base is called modal decomposition this transformation uses the eigenvectors of the states matrix of the original discrete system 31 the eigenvectors matrix v has pairs of columns containing complex conjugated eigenvalues υ j k υ j k with υ j k γ j k i ϕ j k 33 v υ 1 1 υ 1 1 υ 1 n υ 1 n υ 2 n 1 υ 2 n 1 υ 2 n n υ 2 n n 2 n 2 n following the idea presented in fortaleza 2009 to avoid working with complex numbers one can define a new eigenvectors matrix v in which the pairs of columns containing the complex conjugate eigenvalues are replaced by two new columns the first containing its real part and the second its imaginary part 34 v γ 1 1 ϕ 1 1 γ 1 n ϕ 1 n γ 2 n 1 ϕ 2 n 1 γ 2 n n ϕ 2 n n 2 n 2 n thus the following coordinate transformation place the system in modal base 35 x v 1 x where x is the state vector 2 n 1 in modal base using this transformation one can rewrite the equations of the discrete model with linear drag 31 on modal base 36 x a x b u y c x with a v 1 a v b v 1 b and c c v the state matrix a is a block diagonal matrix made up of the real and imaginary parts of the complex conjugates eigenvalues λ j λ j with λ j σ j i ω j of the state matrix a of the original model 37 a σ 1 ω 1 0 0 0 0 ω 1 σ 1 0 0 0 0 0 0 σ 2 ω 2 0 0 0 0 ω 2 σ 2 0 0 0 0 0 0 σ n ω n 0 0 0 0 ω n σ n 2 n 2 n in this particular case the low frequency modes have greater influence on system response the high frequency modes have no major impact on the system s behavior and can be eliminated once they are attenuated by the hydrodynamic forces and by the softness of the system input one way to determine which subsystems should be selected to best represent the original system is through the analysis of static gain associated with each eigenvalue the static gain is defined as the ratio between the variation of the output and the variation of the system input the eigenvalues with the largest static gains have greater influence on system response and can be selected to be part of the reduced model once defined the amount of modes to be maintained and determined the subsystems that will be part of the reduced model the other modes are eliminated to compensate the loss of the static gain by eliminating the remaining eigenvalues is added a direct transfer d r to the reduced model equations 38 d r c r a r 1 b r c a 1 b thus the following state space for the reduced model is obtained 39 x r a r x r b r u y c r x r d r u where a r b r and c r are the reduced matrices that contain only the terms of the matrices a b and c respectively referring to the selected modes and x r is the corresponding state vector according to fortaleza 2009 the appearance of this direct transfer d r gives the model a behavior that is not common for this type of structure because this high value implies a high frequency behavior for the model which is not observed in the real case in fortaleza 2009 a solution was proposed to improve the accuracy of the reduced model the solution was to introduce a delay ε in the model so that the value of direct transfer is small close to zero thereby the actual dynamic behavior of the model is better represented this delay should be chosen so that the system remains in its initial state during the time interval 0 t ε and for t ε both systems display the same output thus the reduced system with the delay can be represented by the following state space 40 x r a r x r b d u t ε y c r x r d d u t ε where b d and d d must satisfy see fortaleza 2009 41 b d a r e ε a r i a r 1 b r b r 42 d d c r e ε a r i a r 1 b r d r being i the identity matrix to determine the number of modes to be preserved in the reduced model we analyzed the response of the reduced models of different orders for a unit step input as shown in fig 7 fig 7 shows in blue the response of the original discrete model eq 31 which has order 200 in green the response of the reduced model of order 4 in red the response of the reduced model of order 6 and in black the response of the reduced model of order 8 it is noteworthy that the higher the order of the reduced system the closer is their behavior in relation to the original system however the higher the selected order the larger is the computational effort of working with more system equations in this work we opted for the reduced model of order 4 since it represents the original model with an acceptable accuracy and as it will be used for the controller design the higher the order of the reduced system more susceptible to measurement noise will be the controller it is observed in fig 7 the clear influence of direct transfer in the initial behavior of the reduced model giving a behavior that is not observed in the original model it is noticed that the lower the order of the reduced model the greater is the absolute value of the corresponding direct transfer for the reduced model of order 4 the value of the direct transfer d r is 0 1135 thus following the idea proposed by fortaleza 2009 a delay ε must be introduced in the reduced model to ensure that it remains in its initial state during the time interval 0 t ε and for t ε both present similar outputs it is noted in fig 7 that from the instant of time t 20 57 s the responses of the original model and the reduced model of order 4 are similar thus we assume the delay ε as this value fig 8 shows the comparison of the behavior of the original model and the reduced model of order 4 with the introduction of the delay one can note that the introduction of the delay significantly reduces the value of the direct transfer d d 9 6 10 4 greatly improving the dynamic behavior of the reduced model 6 trajectory tracking in the presence of external disturbances the control trajectory ϒ o l t obtained in motion planning no longer guarantees that the subsea equipment will follow its reference trajectory therefore it is necessary to design a closed loop control law to ensure the convergence of the trajectory tracking error to zero as presented in section 5 we obtained a reduced model of order 4 to represent the discrete model of order 200 with linear drag since the reduced model has a known delay one can use the smith predictor structure in the control design which can then be done only considering the equations of the reduced model without taking into account the delay between its input and output in addition by the linearity characteristic of the reduced system the superposition principle can be applied then defining the state error vector as x r σ x r x r the state error equations of 40 can be written as 43 x r σ a r x r σ b r u σ y σ c r x r σ d r u σ where y σ y y and u σ u u correspond the trajectory tracking error and the incremental control input respectively since y is the reference trajectory for the plant and u ϒ o l t is the nominal control both obtained by the analytical solution see section 3 moreover u represents the control signal to be applied in the plant the overall scheme of the control strategy is depicted in fig 9 where the plant p is assumed to be the discrete model of order 200 with the non linear drag c is the controller k f is the kalman filter which gives the estimation of the state error vector r m is the reduced model without the delay which is represented separately by e ε s forming the structure of the smith predictor and y p is the prediction of the plant output the following linear state feedback control law is then proposed for the system errorrm 45 44 u σ k u x r σ k u x r x r where k u k 0 k 1 k 2 k 3 represents the gain vector which its elements are chosen according to desired dynamics to the closed loop system finally the final expression for the tracking controller is given by the sum of the incremental feedback control law and the nominal control obtained during 45 u u k u x r x r 6 1 closed loop results numerical simulations were carried out for two different cases in order to verify the performance of the proposed control strategy for the trajectory tracking problem the system parameters adopted in all numerical simulations are the same considered in the analytical development which can be checked in table 1 considering also a simulation time of t s 1500 s we here choose a step time of δ t 0 1 s due to the fact that it corresponds to the minimum processing time of the data coming from the cameras in the experimental setup which will be described in next section the controller gains k 0 k 1 k 2 k 3 were designed through pole placement method to obtain a critically damped closed loop system the desired characteristic polynomial equation is thus assumed to be 46 p s s 3 4 where its roots were selected from experience for the kalman filter the process noise covariance matrix q and measurement noise covariance matrix r are assumed to be diagonal whose elements equal to 10 6 and 10 2 respectively it is noteworthy that when considering q r the kalman filter values the model since it considers that the measurements are less reliable in the first simulation we consider that the initial system condition has a deviation of 0 2 m in relation to the reference trajectory fig 10 provides the tracking system performance for this case it shows in blue the closed loop response of the subsea equipment using the proposed controller given in 48 black the open loop response which was generated by integrating numerically eq 29 with z l and red the reference trajectory ϒ r 0 t assuming as a comparison criterion the time necessary for the subsea equipment to be positioned in a stabilization range of 5 for more and less of the total displacement 0 95 m 1 05 m one can compare the controller performance it is noted in fig 10 that the open loop system remains in this range only from the instant t 1196 s and the closed loop system remains in this range from the instant t 205 s thus it is seen that using the tracking controller one obtains a reduction of 82 9 of the time required to stabilize the system in this range in the second simulation we consider the case of positioning the subsea equipment in the presence of a transient perturbation acting on the platform such as caused by a breaking wave during the procedure then it was assumed a transient input disturbance of 0 5 m during the time interval 100 s t 120 s fig 11 provides the tracking system performance for this case it shows in blue the closed loop response of the subsea equipment using the proposed controller given in 48 black the open loop response which was generated by integrating numerically eq 29 with z l and red the reference trajectory ϒ r 0 t similarly to the first case we adopted as a comparison criterion the time required for the subsea equipment to be positioned in a stabilization range of 10 for more and less of the total displacement 0 9 m 1 1 m it is noted in fig 11 that the open loop system remains in the stabilization range only from t 860 s and the closed loop system remains in this range from t 274 s thus using the controller one obtains a reduction of 68 1 of the time required to stabilize the system in this range lastly although the controller gains imply a closed loop response with a non oscillating behavior slight oscillations are observed this is mainly due to the approximation of the infinite order system by the reduced model which allowed us to design the control system in question nevertheless it has been shown that these oscillations remain lower in relation to the open loop response as can be seen in figs 10and 11 thus significantly improving the transient characteristics of the system 7 experimental approach in order to validate the proposed control strategy an experimental plant was developed in which a piece of string with a suspended styrofoam ball represents the structure and the subsea equipment the system was chosen light to keep accordance to the surrounding fluid as can be seen in table 2 fig 12 portrays the experiment setup it does not represent however the camera used as a visual sensor intended to get the riser s bottom position and send it to the plc in conjunction with the plc a program was coded in python language to implement the proposed controller and acquire the plant signals 7 1 experimental results in the first experiment the motion planning through the analytical solution considered the movement of riser s bottom from origin to 0 3 m in the presence of an unknown disturbance which was made by a fan fig 13 shows in blue the closed loop response of the subsea equipment in black the open loop response and in red the reference trajectory ϒ r 0 t the results show that the open loop response had a steady error nearing 5 while the closed loop response assured a steady error close to zero even in the presence of external disturbance the second experiment assumed a ramp trajectory with 2 5 s duration for both top and bottom references fig 14 shows in blue the closed loop response of the subsea equipment in black the open loop response and in red the reference trajectory ϒ r 0 t in this case one can notice that since the ramp is not a smooth trajectory the overshoot observed in both responses is higher than the overshoot in the reference similarly to the first experiment the open loop has a steady error near 10 while the closed loop as expected reduce this error even in the presence of external disturbance finally it is emphasized that in practical cases the controller is used to fine tune the equipment position in the vicinity of the place where it should be inserted more precisely small displacements of the order of 1 5 m are required which represents a movement approximately equivalent to 0 05 of the length of the riser on the other hand in the experiment the adjustment of the bottom end of the string was proportionally larger when compared to its length this was due to the limitations of the vision system in measuring much smaller displacements that would guarantee the same proportion used in the numerical simulations 8 conclusion the positioning of subsea equipment is a case of a distributed parameter control the proposed solution splits the problem into two sub problems the first one is the open loop control motion planning the second one is disturbances attenuation tracking the motion planning is solved through the proposed analytical solution for a damped cable this analytical solution allows fast precise displacements of the offshore equipments with minor oscillations that increases safety and efficiency of the offshore operation the tracking problem is mitigated using a reduced model it was obtained with the use of a finite difference system and a modal reduction with delay insertion due to an extremely compact model the observer used on the control system is highly robust to measurement noise this robustness is due to the limited number of numerical operations necessary to estimate the system reduced state space the combination of these two strategies shows good tracking performance as observed both numerical simulations and experimental results the proposed solution already considers practical issues like measurement noise external disturbances static or semi static errors and the top displacement as the single control input for real applications the presented control strategy should be applied to each horizontal axis separately due to the small angles assumption that separates the dynamics on each axis acknowledgment the authors would like to acknowledge the brazilian institutions cnpq capes anp 19073 6 finep mct and petrobras through prh pb 223 for supporting the present study 
23218,one of the challenges of the installation of subsea equipment is the precise positioning of the equipment in a desired location on the seabed this positioning procedure is still commonly performed manually by an operator this article presents a trajectory tracking control system design for the positioning of a subsea equipment this work will be done in two stages first a motion planning for dynamic positioning system of platform is presented for this an analytical solution of motion equation of the riser which is modeled as a damped cable is detailed this analytical solution when compared to numerical solutions has the advantage of generating more precise and smooth trajectories for the system input and output second we propose a tracking control system to ensure that the subsea equipment follows the desired trajectory in the presence of disturbances more precisely a linear state feedback control law is proposed using a reduced model which is obtained from a modal reduction with delay insertion this delay insertion provides a high precision low order model this fact highly increase the robustness of the control system to the measurement noise numerical simulations and experimental tests are presented to evaluated the proposed control strategy keywords subsea equipment installation motion planning modal reduction trajectory tracking damped cable analytical solution 1 introduction nowadays with the offshore exploration and production of oil and gas moving towards deeper waters 2000 m and more subsea installation has become a major topic in the offshore oil industry several subsea equipment are constructed onshore and transported offshore to the installation site such as the christmas tree the blow out preventer and the manifold one of the challenges of the installation of the subsea equipment in deep water is the precise positioning of the equipment in the desired location on the seabed according to bai and bai 2012 there are two methods that are widely used for positioning the guideline method and the guideline less one the guideline method uses guides cables typically four tensioned cables to position the subsea equipment in the desired location on the seabed the positioning using this method is very convenient but limited by the very use of the guides cables as highlighted in bai and bai 2012 for facilities in deep water this method can be quite costly both in time and value in turn the guideline less method positions the subsea equipment without any guides cables the subsea equipment has its position changed indirectly by modifying the position of the vessel or by a crane system however due to the dynamic behavior of the system and the required space limitations this method is relatively complex sometimes in the guideline less method it is also coupled with a propulsion system in the subsea equipment in order to adjust its position directly as can be seen in how et al 2007 2010 2011 however the range of this adjustment is limited to a certain area determined by the capacity of the thrusters furthermore for very heavy systems like subsea systems the required strength of the thrusters to move the system is too large preventing the operation due to operational cost the precise positioning of subsea equipment is even more difficult in deep water due to the large distance between the surface vessel and the equipment to be placed on the seabed environmental disturbances such as ocean currents waves and winds relatively small can cause large gaps between the actual position of the submarine equipment and its expected position in addition severe weather conditions can force the positioning operation to wait several days until it becomes possible this paper address the case of positioning of a subsea equipment in deep waters by the guideline less method and without adding the propulsion system to the equipment the positioning of the structure top riser cable etc is determined by a dynamic positioning dp system and a crane system whereas the subsea equipment is positioned indirectly by the motion transmission through the structure top st thus the desired position for the subsea equipment is obtained only with the correct displacement of the st currently this positioning procedure is still commonly performed manually that is an operator displaces the st considering the images of the subsea equipment produced by a remotely operated vehicle rov thus the operator can adjust the position of the st in order to position and install the subsea equipment in the desired location therefore this operation becomes totally dependent on the experience and skill of the operator another limitation is that this operation can only be performed in the presence of good weather and underwater visibility in this context the continuous development of researches and technologies to increase the efficiency and reliability of the subsea installation operation is necessary making it faster and safer and also expand the range of climatic conditions in which it can be performed i e ultrasonic sensors can be used to close the loop in the cases of low underwater visibility a typical subsea installation procedure is shown in fig 1 which basically consists of a platform a marine riser and a subsea equipment to be positioned the platform is equipped with a dp system which allows modifying its position by thrusters and propellers the upper end of the riser is connected to the platform and its lower end is connected to the subsea equipment a rov monitors the subsea position throughout the operation the system can be represented by a master slave architecture fig 2 the slave loop refers to the dp system and the platform and its dynamics is much faster compared to the dynamics of the master loop in turn the master loop refers to the riser the subsea equipment and the operator the dynamics of the master loop is influenced mainly by the spread of mechanical wave along the riser it is noteworthy that in this paper the analysis will be focused only on the master loop and will be considered that the dp system positions the platform at the desired position instantly the strategy consists of positioning the subsea equipment in the desired position on the seabed dynamically modifying the upper end of the riser which displacement is determined by the dp system of the platform this allows to determine the precise platform motion which is necessary to obtain the desired position of the subsea equipment displacement and stabilization of the subsea equipment the position of the subsea equipment is monitored by the images produced in real time by a rov thus the installation of the subsea equipment may be carried out without the direct interference of the operator even in the presence of external disturbances this automated process also tends to increase the reliability and efficiency of operation reducing the total time and the risk of damage to the subsea equipment from a control point of view this papers deals with the control of an infinite order system defined by a partial differential equation pde one can highlight the work of meurer and zeitz 2005 that used formal power series parametrization to represent a system of a tubular reactor bringing similar representation to the modal basis however a high order state observer is obtained from the model in turn schröck et al 2012 attempted the use of a spectral representation based on the natural frequencies of the system to represent piezo actuated flexible structures which also presents a representation of the dynamical system similar to a vibration modes representation this paper is organized as follows section 2 presents the governing equation of the system section 3 derives the analytical solution of the governing equation in the time domain section 4 presents the numerical simulation of the structure section 5 describes the reduced model obtained for the system section 6 presents the feedback control to track the trajectory section 7 discusses the experimental results and in the last section the conclusion and further works are presented 2 governing equation typically structures used in the installation of subsea equipment such as risers are slender and their transverse displacements are small compared to their length in the case of a riser with constant cross section and under traction the dynamic behavior of an infinitesimal element of the riser toward its horizontal displacement can be modeled by the euler bernoulli beam equation 1 under external forces from the fluid in which it is submerged 1 m s 2 ϒ t 2 z t e j 4 ϒ z 4 z t z t z ϒ z z t f h z t where ϒ is the position of the riser in the horizontal direction on the plane including the subsea equipment and its final destination ϒ is function of two parameters the time t and the height z from the seabed the other variables are m s the riser linear mass t z the function that describes the tension force along the structure s length e the young s modulus j the second moment of area and f h the external forces in the horizontal direction per unit length the external forces acting in the structure except on its top and bottom ends where external forces are present due to the boundary conditions can be approximated by the modified morison s equation eq 2 represents the hydrodynamic forces associated with the displacement of a submerged body and do not include side forces resulting from the oscillatory vortex shedding around the structure 2 f h z t m f 2 ϒ t 2 z t μ ϒ t z t ϒ t z t where m f is the additional fluid mass per unit length and μ is the drag per unit length the additional fluid mass is defined by m f ρ c m s where ρ is the fluid density c m is the added mass coefficient and s is the cross sectional area of the riser the drag is defined by μ 1 2 ρ c d d where c d is the drag coefficient and d is the outer diameter of the riser denoting m m s m f and considering the hydrodynamic forces 2 as the only external forces 1 becomes 3 2 ϒ t 2 z t e j m 4 ϒ z 4 z t z t z m ϒ z z t μ m ϒ t z t ϒ t z t due to the low reynolds number of the flow the dissipative drag term can be linearized by replacing μ m ϒ t z t by the constant 2 α which is calculated on the basis of μ m and the average of ϒ t z t along the structure thus 4 represents the system governing equation for the linearized damping 4 2 ϒ t 2 z t e j m 4 ϒ z 4 z t z t z m ϒ z z t 2 α ϒ t z t for the installation of subsea equipment in water depths of 2000 m and greater the weight of the structure and the weight of the subsea equipment have similar orders of magnitude and thus can neither be neglected the tension t z is formulated from the difference between the total weight and the buoyancy therefore t z m s ρ s g z t e where t e is the normal tension associated to the subsea equipment attached to the bottom end t e m e ρ v e g being m e the mass of subsea equipment v e its volume and g the acceleration due to gravity as risers for that water depth are very long structures the span depth ratio d l is on the order of 10 4 or lower thus as z t z ϒ z e j 4 ϒ z 4 the beam therm e j 4 ϒ z 4 which is associated to the bending resistance may be neglected fortaleza 2009 therefore considering this simplification the system equation becomes 5 2 ϒ t 2 z t z m s ρ g z m t e m ϒ z z t 2 α ϒ t z t to simplify the notation the constant term m s ρ s g m can be replaced by the effective gravity g and the constant term t e m can be replaced by v 2 where v is known to be the mechanical wave propagation speed on the riser so the 5 becomes 6 2 ϒ t 2 z t g ϒ z z t g z v 2 2 ϒ z 2 z t 2 α ϒ t z t 3 analytical solution in this section the analytical solution of 6 in the time domain is proposed following the idea proposed by petit and rouchon 2001 of solution in laplace domain and subsequent reversal to the time domain petit and rouchon 2001 solved the positioning of an undamped cable and subsequently fortaleza et al 2011 adapted for the case with damping however without a punctual mass in the structure bottom in the works of fortaleza et al 2012 and albuquerque 2012 the same strategy was used to solve the case of positioning a subsea equipment by a riser however the tension along the structure s length t z was assumed to be constant due only the heavy subsea equipment neglecting the cable s own weight proposition 3 1 the displacement of the riser in the time domain is given by ϒ z t 2 π g 1 1 u x 2 z k t η 1 1 k 2 d k 2 g 1 u x 2 z k t η 2 1 k 2 d k where η 1 c 1 t x 2 z k e α x 2 z k g 3 x 2 z k t x 2 z k η 2 c 2 t x 2 z k e α x 2 z k g 4 x 2 z k t x 2 z k proof the first step is to apply the t laplace transform on 6 and considering the system at rest at t 0 the pde can be rewritten as the following ordinary differential equation ode regarding spacial derivatives only 7 g z v 2 2 ϒ ˆ z 2 z s g ϒ ˆ z z s s 2 2 α s ϒ ˆ z s 0 where ϒ ˆ is the laplace transform of ϒ the solution of 7 with respect to z is 8 ϒ ˆ z s 2 g c ˆ 1 s i 0 2 s 2 2 α s v 2 g z g 2 2 g c ˆ 2 s k 0 2 s 2 2 α s v 2 g z g 2 where c ˆ 1 s and c ˆ 2 s are the functions to be determined by the system s boundary conditions i ν and k ν are the modified bessel functions of the first and second kind of order ν respectively abramowitz and stegun 1972 to determine c ˆ 1 s and c ˆ 2 s it is necessary two boundary conditions the two boundary conditions are the reference trajectory of the bottom end ϒ 0 t and its spacial derivative ϒ z 0 t that represents the riser slope at its bottom end in this article ϒ 0 t is set as a polynomial trajectory that smoothly migrates from an initial position to a final position in a specified stabilization time the second boundary condition is obtained from the dynamics of the subsea equipment eq 9 is obtained for the subsea equipment from the newton s second law of motion 9 m e 2 ϒ t 2 0 t f e t f h 0 t where f e is the riser s force on the subsea equipment and f h is the hydrodynamic forces also defined by 2 f e is proportional to the riser s slope and defined as f e t t e ϒ z 0 t also considering the linearized dissipative drag and rearranging 9 the second boundary condition is 10 ϒ z 0 t 1 t e m t e 2 ϒ t 2 0 t 2 α e ϒ t 0 t where m t e is the subsea equipment mass added to its additional fluid mass and α e is its linearized drag differentiating 8 in relation to the coordinate z and assuming z 0 the following system is obtained 11 ϒ ˆ 0 s 2 g c ˆ 1 s i 0 2 v g s 2 2 α s 2 g c ˆ 2 s k 0 2 v g s 2 2 α s ϒ ˆ z 0 s 2 g s 2 2 α s v c ˆ 1 s i 1 2 v g s 2 2 α s 2 g s 2 2 α s v c ˆ 2 s k 1 2 v g s 2 2 α s solving system 11 the functions c ˆ 1 s and c ˆ 2 s are determined 12 c ˆ 1 s g 2 k 1 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ 0 s g 2 v s 2 2 α s k 0 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ z 0 s 13 c ˆ 2 s g 2 i 1 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ 0 s g 2 v s 2 2 α s i 0 x i 0 x k 1 x i 1 x k 0 x ϒ ˆ z 0 s where x 2 v g s 2 2 α s the wronskian between two modified bessel functions is w k ν x i ν x i ν x k ν 1 x i ν 1 x k ν x 1 x abramowitz and stegun 1972 therefore 12 and 13 can be rewritten 14 c ˆ 1 s v 2 g s 2 2 α s k 1 2 v g s 2 2 α s ϒ ˆ 0 s v 2 2 g s 2 2 α s k 0 2 v g s 2 2 α s ϒ ˆ z 0 s 15 c ˆ 2 s v 2 g s 2 2 α s i 1 2 v g s 2 2 α s ϒ ˆ 0 s v 2 2 g s 2 2 α s i 0 2 v g s 2 2 α s ϒ ˆ z 0 s another way to represent the modified bessel function is by its integral representation abramowitz and stegun 1972 thus 14 and 15 becomes 16 c ˆ 1 s v 2 2 2 g g k ˆ s 1 e 2 v g s 2 2 α s k k 2 1 d k v 2 2 g ϒ ˆ z 0 s 1 e 2 v g s 2 2 α s k k 2 1 d k 17 c ˆ 2 s v 2 2 2 π g g k ˆ s 1 1 e 2 v g s 2 2 α s k 1 k 2 d k v 2 2 π g ϒ ˆ z 0 s 1 1 e 2 v g s 2 2 α s k 1 k 2 d k where k ˆ s s 2 2 α s ϒ ˆ 0 s to return to the time domain the inverse laplace transformation should be applied as k ˆ s and ϒ ˆ z 0 s are only functions of s they can be placed in the integrand of 16 and 17 the identity presented by 18 can be used to inverse the laplace transform mikusinski 2014 18 e x s 2 2 α s e α x e x s f x t e x s where f x t x t 2 2 x t e α x t i α j 1 i α t 2 2 x t with j ν is the bessel function of the first kind of order ν abramowitz and stegun 1972 to simplify the notation we use x 1 k 2 v g k then applying 18 in 16 and 17 19 c ˆ 1 s v 2 2 2 g g 1 η 3 e x 1 k s k 2 1 d k v 2 2 g 1 η 4 e x 1 k s k 2 1 d k 20 c ˆ 2 s v 2 2 2 π g g 1 1 η 3 e x 1 k s 1 k 2 d k v 2 2 π g 1 1 η 4 e x 1 k s 1 k 2 d k where η 3 k ˆ s e α x 1 k g ˆ 1 x 1 k s η 4 ϒ ˆ z 0 s e α x 1 k g ˆ 2 x 1 k s with g ˆ 1 x 1 k s f ˆ x 1 k s k ˆ s and g ˆ 2 x 1 k s f ˆ x 1 k s ϒ ˆ z 0 s the inverse laplace transformation of the product of two functions can be calculated by the convolution formula mikusinski 2014 thus the functions g 1 x 1 k t and g 2 x 1 k t are obtained 21 g 1 x 1 k t 0 t f x 1 k τ k t τ d τ 22 g 2 x 1 k t 0 t f x 1 k τ ϒ z 0 t τ d τ where k t u 0 t 2 α ϒ t 0 t 2 ϒ t 2 0 t also obtained by the convolution of s 2 2 α s and ϒ ˆ 0 s the variable u 0 is the unit step function now applying the shifting theorem f t x u x t e x s f ˆ s both 19 and 20 can be rewritten in the time domain 23 c 1 t v 2 2 2 g g 1 u x 1 k t η 5 k 2 1 d k v 2 2 g 1 u x 1 k t η 6 k 2 1 d k 24 c 2 t v 2 2 2 π g g 1 1 u x 1 k t η 5 1 k 2 d k v 2 2 π g 1 1 u x 1 k t η 6 1 k 2 d k where η 5 k t x 1 k e α x 1 k g 1 x 1 k t x 1 k η 6 ϒ z 0 t x 1 k e α x 1 k g 2 x 1 k t x 1 k once both functions c 1 t and c 2 t are determined one can apply the inverse laplace transform on 8 to obtain the displacement of the riser in the time domain ϒ z t first representing the modified bessel functions by theirs integral representation eq 8 becomes 25 ϒ ˆ z s 2 π g c ˆ 1 s 1 1 e 2 v 2 g z g 2 s 2 2 α s k 1 k 2 d k 2 g c ˆ 2 s 1 e 2 v 2 g z g 2 s 2 2 α s k k 2 1 d k as c ˆ 1 s and c ˆ 2 s are only functions of s they can be placed in the integrand of 25 applying the identity presented in eq 18 and assuming x 2 z k 2 v 2 g z g 2 k eq 25 becomes 26 ϒ ˆ z s 2 π g 1 1 η 7 e x 2 z k s 1 k 2 d k 2 g 1 η 8 e x 2 z k s 1 k 2 d k where η 7 c ˆ 1 s e α x 2 z k g ˆ 3 x 2 z k s η 8 c ˆ 2 s e α x 2 z k g ˆ 4 x 2 z k s with g ˆ 3 x 2 z k s f ˆ x 2 z k s c ˆ 1 s and g ˆ 4 x 2 z k s f ˆ x 2 z k s c ˆ 2 s the functions g 3 x 2 z k t and g 4 x 2 z k t are also obtained by the convolution formula 27 g 3 x 2 z k t 0 t f x 2 z k τ c 1 t τ d τ 28 g 4 x 2 z k t 0 t f x 2 z k τ c 2 t τ d τ applying the shifting theorem eq 29 is obtained which represents the displacement of the riser in the time domain further details in simões 2016 29 ϒ z t 2 π g 1 1 u x 2 z k t η 1 1 k 2 d k 2 g 1 u x 2 z k t η 2 1 k 2 d k where η 1 c 1 t x 2 z k e α x 2 z k g 3 x 2 z k t x 2 z k η 2 c 2 t x 2 z k e α x 2 z k g 4 x 2 z k t x 2 z k the open loop solution is found integrating numerically eq 29 thus assuming z l being l the riser length the control trajectory ϒ o l t of the st is found in order to test the proposed analytical solution it is considered a case of subsea equipment positioning in deep waters by the platform drilling system the system parameters are given in table 1 the subsea equipment is assumed to be a steel sphere same material as the drilling riser the riser is assumed to be filled with sea water the system is considered to be stationary in the initial condition t 0 with the riser and the subsea equipment fully aligned to the vertical axis thus the first step in determining the control trajectory of the dp system is to specify a reference trajectory for the subsea equipment ϒ r 0 t it is adopted a polynomial trajectory that smoothly moves the subsea equipment 1 m away from its initial position fig 3 shows in red the reference trajectory of subsea equipment ϒ r 0 t and in black the control trajectory of the dp system ϒ o l t 4 numerical simulation of the structure in order to assess the analytical solution found a numerical simulation by finite difference method is proposed following the idea presented in fortaleza 2009 this method discretizes the continuous function ϒ z t and defines y t as a vector of the structure displacement for n equidistant points along the structure thus the governing pde 3 is approximated by a finite set of coupled odes 30 valid for all elements not affected by the boundary conditions 30 d 2 y n d t 2 e j m y n 2 4 y n 1 6 y n 4 y n 1 y n 2 l 4 n 1 g l v 2 y n 1 2 y n y n 1 l 2 g y n 1 y n 1 2 l 2 α d y n d t where n 3 n 2 is the element position l is the distance between two adjacent points l l n being the subsea equipment as the first element n 1 and the riser top end as the last element n n and considering u t as the platform position defined by the dp system the boundary conditions are at the subsea equipment the motion equation is given by 9 and 2 ϒ z 2 0 t 0 and at the top end ϒ l t u t and ϒ z l t 0 as the riser is attached to the platform by a fixed support thus the discrete system can be represented in a traditional state space form 31 x a x b u y c x where a is the state matrix 2 n 2 n b is the input matrix 2 n 1 and contains the acceleration of the structure associated to the riser top end displacement b 0 0 e j m l 4 3 e j m l 4 n 1 g l v 2 l 2 g 2 l t c is the output row matrix 1 2 n with only one non zero entry to obtain the subsea equipment displacement c 1 0 0 u is the control trajectory ϒ o l t y is the system output ϒ 0 t x is the state vector 2 n 1 x y 1 y n d y 1 d t d y n d t t and x is its time derivative the state matrix describes the system behavior 32 a 0 i a k 2 n 2 n where 0 is a null matrix n n i is an identity matrix n n k is a diagonal matrix n n containing the accelerations associated to the hydrodynamic damping and a is the stiffness matrix n n and contains the structure internal accelerations according to the discrete model presented 4 1 open loop results to verify the accuracy of the analytical solution proposed 29 with all its assumptions and simplifications the control trajectory ϒ o l t is used as the system input for numerical simulation of the discrete system 30 in all numerical simulations it was considered a system of order 200 since the system was discretized in n 100 elements as this step aims to validate the analytical solution no environmental disturbances was considered waves and currents also the parameters assumed in all simulations are presented in table 1 the numerical simulations were divided into two stages at first it was simulated the discrete model with linear dissipative drag 31 this step aimed to highlight the influence of neglecting the beam term e j 4 ϒ z 4 associated to the riser bending resistance fig 4 shows in blue the response of the numerical simulation which represents the trajectory of subsea equipment obtained by the numerical method ϒ n 0 t also featured are in red the reference trajectory of the subsea equipment ϒ r 0 t used as a boundary condition for the analytic solution and in black the control trajectory ϒ o l t obtained by the analytical method it is observed in fig 4 that the response of the numerical simulation ϒ n 0 t is very close to the reference trajectory of the subsea equipment as expected the assumption of modeling the riser disregarding its bending resistance is valid and does not significantly impact the system response the numerical method can also be used to simulate the system considering the non linear dissipative drag term of 3 the linear dissipative drag 2 α of the discrete system is replaced by the non linear damping μ m ϒ t z t see simões 2016 so in the second stage it was simulated the discrete model with the non linear dissipative drag this step aimed to highlight the influence of the drag term linearization fig 5 shows in blue the numerical simulation response ϒ n 0 t in red the reference subsea equipment trajectory ϒ r 0 t and in black the control trajectory ϒ o l t obtained by the analytical method it is noted from fig 5 that the trajectory of the subsea equipment obtained by numerical simulation with non linear drag is very close to the trajectory adopted as reference with only a small oscillation around the final position best shown in fig 6 by fig 6 it can be seen that the oscillation amplitude has the order of 6 10 3 m and therefore can not be considered as significant in the system response thus the simplification to linearize the dissipative drag term of the governing equation is considered valid 5 modal reduction in a real case of subsea installation there is the presence of unknown external disturbances such as ocean currents winds and waves thus to ensure the trajectory tracking task it is necessary to develop a control system thus this section has a primary and essential phase to the development of the control system which is to obtain a reduced model that will be used as the basis for the controller design the reduced model is obtained from the discrete model with linear drag 31 using a strategy of reducing the order based on the modal analysis theory a method widely used to reduce the order of one system and at the same time maintaining the original system behavior is the method of modal reduction this method is based on applying a coordinate transformation in the original system putting it in the modal base subsequently we analyze which system modes that influence their response modes that do not have significant contributions are eliminated reducing thereby the system order the transformation of coordinates that places the system in the modal base is called modal decomposition this transformation uses the eigenvectors of the states matrix of the original discrete system 31 the eigenvectors matrix v has pairs of columns containing complex conjugated eigenvalues υ j k υ j k with υ j k γ j k i ϕ j k 33 v υ 1 1 υ 1 1 υ 1 n υ 1 n υ 2 n 1 υ 2 n 1 υ 2 n n υ 2 n n 2 n 2 n following the idea presented in fortaleza 2009 to avoid working with complex numbers one can define a new eigenvectors matrix v in which the pairs of columns containing the complex conjugate eigenvalues are replaced by two new columns the first containing its real part and the second its imaginary part 34 v γ 1 1 ϕ 1 1 γ 1 n ϕ 1 n γ 2 n 1 ϕ 2 n 1 γ 2 n n ϕ 2 n n 2 n 2 n thus the following coordinate transformation place the system in modal base 35 x v 1 x where x is the state vector 2 n 1 in modal base using this transformation one can rewrite the equations of the discrete model with linear drag 31 on modal base 36 x a x b u y c x with a v 1 a v b v 1 b and c c v the state matrix a is a block diagonal matrix made up of the real and imaginary parts of the complex conjugates eigenvalues λ j λ j with λ j σ j i ω j of the state matrix a of the original model 37 a σ 1 ω 1 0 0 0 0 ω 1 σ 1 0 0 0 0 0 0 σ 2 ω 2 0 0 0 0 ω 2 σ 2 0 0 0 0 0 0 σ n ω n 0 0 0 0 ω n σ n 2 n 2 n in this particular case the low frequency modes have greater influence on system response the high frequency modes have no major impact on the system s behavior and can be eliminated once they are attenuated by the hydrodynamic forces and by the softness of the system input one way to determine which subsystems should be selected to best represent the original system is through the analysis of static gain associated with each eigenvalue the static gain is defined as the ratio between the variation of the output and the variation of the system input the eigenvalues with the largest static gains have greater influence on system response and can be selected to be part of the reduced model once defined the amount of modes to be maintained and determined the subsystems that will be part of the reduced model the other modes are eliminated to compensate the loss of the static gain by eliminating the remaining eigenvalues is added a direct transfer d r to the reduced model equations 38 d r c r a r 1 b r c a 1 b thus the following state space for the reduced model is obtained 39 x r a r x r b r u y c r x r d r u where a r b r and c r are the reduced matrices that contain only the terms of the matrices a b and c respectively referring to the selected modes and x r is the corresponding state vector according to fortaleza 2009 the appearance of this direct transfer d r gives the model a behavior that is not common for this type of structure because this high value implies a high frequency behavior for the model which is not observed in the real case in fortaleza 2009 a solution was proposed to improve the accuracy of the reduced model the solution was to introduce a delay ε in the model so that the value of direct transfer is small close to zero thereby the actual dynamic behavior of the model is better represented this delay should be chosen so that the system remains in its initial state during the time interval 0 t ε and for t ε both systems display the same output thus the reduced system with the delay can be represented by the following state space 40 x r a r x r b d u t ε y c r x r d d u t ε where b d and d d must satisfy see fortaleza 2009 41 b d a r e ε a r i a r 1 b r b r 42 d d c r e ε a r i a r 1 b r d r being i the identity matrix to determine the number of modes to be preserved in the reduced model we analyzed the response of the reduced models of different orders for a unit step input as shown in fig 7 fig 7 shows in blue the response of the original discrete model eq 31 which has order 200 in green the response of the reduced model of order 4 in red the response of the reduced model of order 6 and in black the response of the reduced model of order 8 it is noteworthy that the higher the order of the reduced system the closer is their behavior in relation to the original system however the higher the selected order the larger is the computational effort of working with more system equations in this work we opted for the reduced model of order 4 since it represents the original model with an acceptable accuracy and as it will be used for the controller design the higher the order of the reduced system more susceptible to measurement noise will be the controller it is observed in fig 7 the clear influence of direct transfer in the initial behavior of the reduced model giving a behavior that is not observed in the original model it is noticed that the lower the order of the reduced model the greater is the absolute value of the corresponding direct transfer for the reduced model of order 4 the value of the direct transfer d r is 0 1135 thus following the idea proposed by fortaleza 2009 a delay ε must be introduced in the reduced model to ensure that it remains in its initial state during the time interval 0 t ε and for t ε both present similar outputs it is noted in fig 7 that from the instant of time t 20 57 s the responses of the original model and the reduced model of order 4 are similar thus we assume the delay ε as this value fig 8 shows the comparison of the behavior of the original model and the reduced model of order 4 with the introduction of the delay one can note that the introduction of the delay significantly reduces the value of the direct transfer d d 9 6 10 4 greatly improving the dynamic behavior of the reduced model 6 trajectory tracking in the presence of external disturbances the control trajectory ϒ o l t obtained in motion planning no longer guarantees that the subsea equipment will follow its reference trajectory therefore it is necessary to design a closed loop control law to ensure the convergence of the trajectory tracking error to zero as presented in section 5 we obtained a reduced model of order 4 to represent the discrete model of order 200 with linear drag since the reduced model has a known delay one can use the smith predictor structure in the control design which can then be done only considering the equations of the reduced model without taking into account the delay between its input and output in addition by the linearity characteristic of the reduced system the superposition principle can be applied then defining the state error vector as x r σ x r x r the state error equations of 40 can be written as 43 x r σ a r x r σ b r u σ y σ c r x r σ d r u σ where y σ y y and u σ u u correspond the trajectory tracking error and the incremental control input respectively since y is the reference trajectory for the plant and u ϒ o l t is the nominal control both obtained by the analytical solution see section 3 moreover u represents the control signal to be applied in the plant the overall scheme of the control strategy is depicted in fig 9 where the plant p is assumed to be the discrete model of order 200 with the non linear drag c is the controller k f is the kalman filter which gives the estimation of the state error vector r m is the reduced model without the delay which is represented separately by e ε s forming the structure of the smith predictor and y p is the prediction of the plant output the following linear state feedback control law is then proposed for the system errorrm 45 44 u σ k u x r σ k u x r x r where k u k 0 k 1 k 2 k 3 represents the gain vector which its elements are chosen according to desired dynamics to the closed loop system finally the final expression for the tracking controller is given by the sum of the incremental feedback control law and the nominal control obtained during 45 u u k u x r x r 6 1 closed loop results numerical simulations were carried out for two different cases in order to verify the performance of the proposed control strategy for the trajectory tracking problem the system parameters adopted in all numerical simulations are the same considered in the analytical development which can be checked in table 1 considering also a simulation time of t s 1500 s we here choose a step time of δ t 0 1 s due to the fact that it corresponds to the minimum processing time of the data coming from the cameras in the experimental setup which will be described in next section the controller gains k 0 k 1 k 2 k 3 were designed through pole placement method to obtain a critically damped closed loop system the desired characteristic polynomial equation is thus assumed to be 46 p s s 3 4 where its roots were selected from experience for the kalman filter the process noise covariance matrix q and measurement noise covariance matrix r are assumed to be diagonal whose elements equal to 10 6 and 10 2 respectively it is noteworthy that when considering q r the kalman filter values the model since it considers that the measurements are less reliable in the first simulation we consider that the initial system condition has a deviation of 0 2 m in relation to the reference trajectory fig 10 provides the tracking system performance for this case it shows in blue the closed loop response of the subsea equipment using the proposed controller given in 48 black the open loop response which was generated by integrating numerically eq 29 with z l and red the reference trajectory ϒ r 0 t assuming as a comparison criterion the time necessary for the subsea equipment to be positioned in a stabilization range of 5 for more and less of the total displacement 0 95 m 1 05 m one can compare the controller performance it is noted in fig 10 that the open loop system remains in this range only from the instant t 1196 s and the closed loop system remains in this range from the instant t 205 s thus it is seen that using the tracking controller one obtains a reduction of 82 9 of the time required to stabilize the system in this range in the second simulation we consider the case of positioning the subsea equipment in the presence of a transient perturbation acting on the platform such as caused by a breaking wave during the procedure then it was assumed a transient input disturbance of 0 5 m during the time interval 100 s t 120 s fig 11 provides the tracking system performance for this case it shows in blue the closed loop response of the subsea equipment using the proposed controller given in 48 black the open loop response which was generated by integrating numerically eq 29 with z l and red the reference trajectory ϒ r 0 t similarly to the first case we adopted as a comparison criterion the time required for the subsea equipment to be positioned in a stabilization range of 10 for more and less of the total displacement 0 9 m 1 1 m it is noted in fig 11 that the open loop system remains in the stabilization range only from t 860 s and the closed loop system remains in this range from t 274 s thus using the controller one obtains a reduction of 68 1 of the time required to stabilize the system in this range lastly although the controller gains imply a closed loop response with a non oscillating behavior slight oscillations are observed this is mainly due to the approximation of the infinite order system by the reduced model which allowed us to design the control system in question nevertheless it has been shown that these oscillations remain lower in relation to the open loop response as can be seen in figs 10and 11 thus significantly improving the transient characteristics of the system 7 experimental approach in order to validate the proposed control strategy an experimental plant was developed in which a piece of string with a suspended styrofoam ball represents the structure and the subsea equipment the system was chosen light to keep accordance to the surrounding fluid as can be seen in table 2 fig 12 portrays the experiment setup it does not represent however the camera used as a visual sensor intended to get the riser s bottom position and send it to the plc in conjunction with the plc a program was coded in python language to implement the proposed controller and acquire the plant signals 7 1 experimental results in the first experiment the motion planning through the analytical solution considered the movement of riser s bottom from origin to 0 3 m in the presence of an unknown disturbance which was made by a fan fig 13 shows in blue the closed loop response of the subsea equipment in black the open loop response and in red the reference trajectory ϒ r 0 t the results show that the open loop response had a steady error nearing 5 while the closed loop response assured a steady error close to zero even in the presence of external disturbance the second experiment assumed a ramp trajectory with 2 5 s duration for both top and bottom references fig 14 shows in blue the closed loop response of the subsea equipment in black the open loop response and in red the reference trajectory ϒ r 0 t in this case one can notice that since the ramp is not a smooth trajectory the overshoot observed in both responses is higher than the overshoot in the reference similarly to the first experiment the open loop has a steady error near 10 while the closed loop as expected reduce this error even in the presence of external disturbance finally it is emphasized that in practical cases the controller is used to fine tune the equipment position in the vicinity of the place where it should be inserted more precisely small displacements of the order of 1 5 m are required which represents a movement approximately equivalent to 0 05 of the length of the riser on the other hand in the experiment the adjustment of the bottom end of the string was proportionally larger when compared to its length this was due to the limitations of the vision system in measuring much smaller displacements that would guarantee the same proportion used in the numerical simulations 8 conclusion the positioning of subsea equipment is a case of a distributed parameter control the proposed solution splits the problem into two sub problems the first one is the open loop control motion planning the second one is disturbances attenuation tracking the motion planning is solved through the proposed analytical solution for a damped cable this analytical solution allows fast precise displacements of the offshore equipments with minor oscillations that increases safety and efficiency of the offshore operation the tracking problem is mitigated using a reduced model it was obtained with the use of a finite difference system and a modal reduction with delay insertion due to an extremely compact model the observer used on the control system is highly robust to measurement noise this robustness is due to the limited number of numerical operations necessary to estimate the system reduced state space the combination of these two strategies shows good tracking performance as observed both numerical simulations and experimental results the proposed solution already considers practical issues like measurement noise external disturbances static or semi static errors and the top displacement as the single control input for real applications the presented control strategy should be applied to each horizontal axis separately due to the small angles assumption that separates the dynamics on each axis acknowledgment the authors would like to acknowledge the brazilian institutions cnpq capes anp 19073 6 finep mct and petrobras through prh pb 223 for supporting the present study 
23219,for mitigating tsunamis that overtop an embankment flume tests were conducted to clarify the energy reduction of a tsunami due to a compound defense system by a combination of a sea embankment and lined vertical piles behind the embankment the relationship between the flow structure and energy reduction was investigated with changing pile height spacing and number of rows the flow structure was classified into 10 types and the patterns were classified into two the energy reduction increased with smaller spacing between lined piles and the reduction of energy and fluid force behind piles gradually decreased when the piles were submerged in some cases energy reduction became very low or energy was locally concentrated because standing waves were generated behind the piles two important parameters were proposed resp consisting of pile spacing pile diameter and number of lines of piles in the downstream direction and ps comprising overflowing water depth pile height and embankment height ps discriminates whether the piles are emergent or submerged and resp classifies the change in the flow structure pattern recommended design criteria to reduce tsunami energy and to prevent the formation of the standing waves downstream of piles were elucidated by these two parameters keywords energy reduction hydraulic jump overflow from embankment compound defense 1 introduction the 2011 great east japan tsunami extensively destroyed parts of sea walls tsunami gates large embankments tappin et al 2012 and coastal forests tanaka et al 2013 thus the tsunami caused catastrophic damage to people and buildings in the tohoku and kanto districts of japan udo et al 2012 suppasri et al 2013 and revealed the limits of using only a sea embankment as defense after the tsunami the ministry of land infrastructure transport and tourism japan mlit classified tsunamis as level 1 and level 2 the recurrence period of the magnitude for level 1 tsunamis is defined as around 100 years while that for level 2 tsunamis is within hundreds to a thousand years because a level 2 tsunami overtops an embankment a compound defense system is proposed for level 2 tsunamis to mitigate damage to the hinterland however the optimum compound defense system for mitigating a level 2 tsunami is still unknown recently the number of studies that propose compound defense systems i e embankment with coastal forest tanaka et al 2014 tokida and tanimoto 2014 igarashi and tanaka 2016 forest and moat usman et al 2014 moat behind embankment mineura et al 2013 tsujimoto et al 2014 dune and canal niimi et al 2013 rahman et al 2016 2017 barrier behind embankment matsuyama et al 2012 hybrid system with low embankment and forest temmerman et al 2013 and double embankments tanaka and igarashi 2016 has increased when a forest is introduced in the downstream part of an embankment the forest can reduce the tsunami energy by resistance if the resistance provided by a forest is large enough to change the flow from supercritical to subcritical it also can decrease the tsunami energy by causing a hydraulic jump however not many studies have been conducted for that objective in a double embankment system igarashi and tanaka 2016 the second embankment has the risk of being washed out by a tsunami if it is made of soil even in that case reduction of the energy of a tsunami can still be expected when piles are set inside the second embankment and appear after the second embankment was eroded and washed away to decrease the erosion of an embankment and behind it hidden piles or short but dense plants such as bushes also have the capacity to increase the resistance to erosion thus it is very important to investigate the effectiveness of a narrow width forest or piles behind an embankment for reducing the energy that overtops an embankment the effect and limitation of coastal forests had already discussed in shuto 1987 before the 2011 tsunami in addition there are many studies of numerical simulations to evaluate the effects of a coastal forest when tsunami and forest characteristics are changed hiraishi and harada 2003 harada and imamura 2006 nandasena et al 2012 hiraishi and harada 2003 also carried out experiments and showed that a greenbelt composed of tropical trees reduces the tsunami water level flow velocity and pressure tanaka et al 2014 compared the mitigation effect of an embankment and forest during the 2011 japanese tsunami and revealed the importance of the forest by their post tsunami survey and numerical study similar effects can be expected for piles if the spacing of piles or small bush type trees is close enough to affect the flow upstream of piles a hydraulic jump may be generated it is widely known that a hydraulic jump can dissipate tsunami energy ahmed et al 2014 moussa et al 2016 pasha and tanaka 2016 2017 it is also known that a ski jump type of flow can dissipate energy wu et al 2016 if a free nap flow of a ski jump type is generated around the piles or trees by resistance tsunami energy can be dissipated due to collision with the downstream bed of piles or trees although no hydraulic jump is generated the resistance of circular cylinders changes with changes in the spacing of the cylinders takemura and tanaka 2007 and their arrangement li and shen 1973 in addition the combination of sparse and dense cylinders affects the reflection of the tsunami iimura and tanaka 2012 irtem et al 2009 showed that the tsunami run up height for a slope with wooden cylinders placed in a staggered arrangement was decreased compared with that of cylinders in a rectilinear arrangement however few experimental studies of supercritical flow against circular cylinders have been reported in addition more knowledge about conditions for generation of a hydraulic jump around lined cylinders is needed therefore a flume study was conducted to clarify the relationship between the energy reduction and the flow structure when a tsunami passes through a compound defense system i e a combination of embankment and piles lined cylinders towards the land side 2 materials and methods 2 1 experimental apparatus and procedures fig 1 shows the experimental setup the compound system was proposed to reduce the energy of overflowing tsunami water by a hydraulic jump and or resistance of piles this study changed the pile height pile spacing and number of lined piles and investigated the relationship between the flow structure and energy reduction as a first step a steady flow condition was set in an open channel flume with the energy reduction ratio for various compound defense models on a physical scale of 1 100 and 1 50 as shown in fig 1 the flume length and width were 14 m and 0 5 m respectively for setting hydraulic conditions froude similarity was used for the model experiments on a physical scale of 1 100 a wooden embankment model 14 5 cm high was set on the flume bottom for the pile models wooden circular cylinders 0 4 cm in diameter were used and they were set in a single row at regular intervals along the embankment or they were placed in two rows in a staggered arrangement one and two rows of piles were selected as shown in fig 1a and b respectively the spacings between cylinders for one and two rows sp were set as 0 3 0 6 and 0 9 cm and 0 6 and 0 9 cm respectively these five cases were named m100r1sd m100r1si m100r1ss m100r2si and m100r2ss as the convention for case names m100 indicates that the model scale is equal to 1 100 r1 and r2 indicate that the number of rows is 1 and 2 respectively sd si and ss indicate that the pile spacings are dense intermediate and sparse respectively for each of these five cases three pile heights h p were selected 1 2 and 4 cm the distance from the embankment toe to the front line of the piles was constant at 33 cm in addition two cases m50r1si and m50r2si both of whose physical scale are 1 50 were tested to confirm the effects of physical scale on flow structures in cases m50r1si and m50r2si only the small pile height 2 cm was conducted due to the limitation of the pump flow rate to investigate the effect of pile diameter two pile diameters 0 4 0 8 cm were additionally tested in cases m50r1si and m50r2si under the number of rows of lined piles and non dimensional pile spacing sp d were kept constant moreover only the embankment case case m100r0 and m50r0 was tested for comparing the effectiveness of the compound system cases the experimental condition is summarized in table 1 2 2 parameters used in this study using the model and hydraulic parameters shown in fig 1 five non dimensional parameters were defined in this study non dimensional pile spacing sp was defined as sp sp d where sp and d are the spacing between the piles and the diameter of a pile respectively sp was set as 0 75 1 5 and 2 25 non dimensional pile height h p was defined as h p h p h e where h p and h e are the pile height and embankment height respectively h p were set as 0 07 0 14 and 0 28 for comparison of results non dimensional overflow water depth h c was defined as h c h c h e where h c is the critical depth on top of the embankment in cases in which the physical scale of the model was 1 100 or 1 50 the flow structure was investigated in relation to h c in the range of approximately 0 08 0 37 or 0 08 to 0 22 respectively 2 2 1 non dimensional arrangement of lined piles resp resistance of lined piles affects the flow structure behind piles therefore the non dimensional arrangement of lined piles resp was defined as 1 re s p d s p d α d s p d l where α is 0 or 1 when the number of rows is 1 or 2 respectively and l is the distance in between the row of lined piles as shown in fig 1 on the right hand side of eq 1 the first term means the ratio of a unit length in the direction along the embankment sp d and the diameter of a pile in the first row d the second term also means the ratio but it includes the effect of l when l approaches 0 while keeping α as 1 two row condition resp approaches to 2d sp d it correctly expresses the one row and double density condition in addition resp shows that the effect of lined piles of the second row becomes 0 when l becomes infinite 2 2 2 non dimensional parameter on whether piles are emergent or submerged ps the relationship among pile heights overflow water depths and embankment heights affects whether piles are emergent or submerged so a non dimensional pile and water surface parameter ps was defined as 2 p s h c h p β h c h e h p h e β where β is a constant that expresses the backwater rise due to piles the effect of h p is smaller than that of h c because the backwater rise around piles due to changing h p is smaller than the rise of water level around piles by changing h c therefore β in eq 2 should be less than 1 0 2 3 methods for evaluating reduction of tsunami energy the overflow water depth from the embankment h c and water depth behind the piles h 2 were measured in all cases in some cases fluctuations in the water surface were observed behind the piles with time and space and hence maximum and minimum h 2 were measured and their average value was calculated for estimating the tsunami mitigation effect of the piles this study defined the energy reduction rate δe as follows 3 δ e e 1 e 2 e 1 100 where e 1 and e 2 were the energies at which h c and h 2 were measured respectively and were calculated from bernoulli s theorem to confirm the location of h c on top of the embankment where the froude number equals 1 the flow discharge was measured by using a triangular notch 2 4 methods for evaluating fluid force behind lined piles for directly evaluating the effect of an embankment piles compound system on fluid force reduction behind the lined piles the drag force on a cylinder cylinder d with diameter of 4 mm was measured by a force gauge kss company ltd lb60 10n at the place where h 2 was measured for cases m100r0 m100r1si and m100r2ss when h p was 0 07 cylinder d was set downstream of piles where the flow structure itself was not changed and it measured only the drag force 3 results 3 1 classification of flow structure in the single embankment case energy reduction rates δe were estimated to be approximately 38 81 by flume tests because overflowing water from the embankment collided with the bed in the compound system the flow structure after overtopping the embankment was classified into ten types according to sp when sp was small 0 75 and h p was 0 07 0 14 and 0 28 the flow pattern can be classified into six types for h c 0 08 0 37 as shown in fig 2 a with the increase in non dimensional overflow water depth h c the type of flow structure changed from types a1 a2 a3 a4 a5 to a6 this change of flow structure was defined as pattern a in this study when h c was small 0 08 and h p was 0 07 and 0 14 the flow is in the supercritical condition between embankment and piles while it becomes subcritical behind the piles type a1 by further increasing h c 0 14 0 21 when h p was 0 07 and 0 14 the water retained around piles was washed away and type a3 was generated in this type the flow used the piles like a ski jump a free nap flow collided with the downstream bed of piles and a hydraulic jump occurred in succession when h c was further increased 0 23 0 25 and h p was 0 14 the hydraulic jump downstream of the piles was not generated type a4 with a further increase in h c 0 21 0 36 when h p was 0 07 and 0 14 the water depth just at the front side of the upstream piles h pf as shown in fig 1a became larger than the pile height which resulted in eddy formation instead of a free nap flow just behind the piles this is due to the large difference in flow velocity inside the piles and over the piles type a5 increasing h c further 0 21 0 36 when h p was 0 07 did not generate an eddy and the effect of resistance of piles became smaller type a6 when h p was 0 28 type a1 and type a3 were generated when h c were 0 08 and 0 35 respectively when h p was 0 28 and h c was 0 14 0 32 a hydraulic jump occurred in front of the piles type a2 when sp was large 1 5 2 25 four flow patterns were observed for h c 0 08 0 37 as shown in fig 2b with an increase in non dimensional over flow water depth h c the type of flow structure changed from type b1 to b2 to b3 to b4 this change of flow structure was defined as pattern b in this study when h c was small 0 08 a hydraulic jump occurred behind the piles but separately type b1 when further increasing h c the hydraulic jump was not generated behind the piles in this case when the flow passed through the piles in a supercritical flow splashes and oblique standing waves fig 3 a type b2 were generated just behind the piles therefore the water depth and water surface fluctuation became large fig 3a and b shows the images of flow structure behind the lined piles in case m100r1ss h p 0 14 h c 0 20 and case m100r2ss h p 0 14 h c 0 22 respectively by further increasing h c the standing wave was still generated and splashes became like a free nap flow type b3 type b3 is similar to type a4 but a standing wave was not observed in type a4 by further increasing h c the water at the piles h pf became deeper than the piles height and in this case just behind piles neither the free nap flow was generated nor the eddy formation was observed because the difference in flow velocity inside the piles and over the piles was small type b4 a standing wave was also generated in type b4 table 2 summarizes the change of flow structure in each case a figure of flow structure types which has h c on the vertical axis and h p on the cross axis was plotted with a different color for each flow structure as shown in fig 4a b 4c 5a and 5 b for cases m100r1sd m100r1si m100r1ss m100r2si and m100r2ss respectively flow structure types of cases m50r1si and m50r2si were also plotted in figs 4b and 5a respectively the type of flow structure was judged from the video footage of the experiment in the figure the boundary lines that classify the flow type are shown drawn figs 4 and 5 show that when h c was larger than 0 2 and h p was 0 07 or h c was larger than 0 3 and h p was 0 14 the water depth at the piles h pf was higher than the pile height even if sp was 0 75 1 5 or 2 25 and the physical scale of the model was 1 100 or 1 50 therefore the type of flow structure became type a5 a6 or b4 it shows that the relationship between pile height and water depth at the piles depends on the relationship between h c and h p not sp and the physical scale of the model figs 4a and 5a suggest that the pile height was important whether a hydraulic jump occurred in front of the lined piles or not when the piles were short h p 0 75 1 5 a free nap flow on the lined piles like a ski jump easily occurred although a hydraulic jump was not generated in front of the lined piles 3 2 relationship between flow structure and energy reduction rate δe the energy reduction rate δe defined in eq 3 is shown in fig 6a b 6c 7a and 7 b for cases m100r1sd m100r1si m100r1ss m100r2si and m100r2ss respectively in some cases the water level immediately behind the lined piles varied which resulted in a wide range of energy reduction rates although the non dimensional overflow water depth was constant therefore crossbars indicating the range of energy reduction rate were drawn on the figure for comparison the δe for a single embankment case case m100r0 is also included in figs 6 and 7 when h c was less than 0 15 the difference of δe between a single embankment case and a compound system was very small because even in the single embankment case tsunami energy could be reduced and δe was large 70 81 as shown in figs 6 and 7 figs 4a and 6a show that when h c was larger than 0 21 and h p was equal to 0 14 and 0 28 the flow types were type a2 a3 a4 or a5 and the energy reduction rate δe was up to 23 higher at maximum than that of case m100r0 however when h p was equal to 0 07 and the flow type became type a6 the δe gradually decreased and almost equaled that of case m100r0 the difference in δe between the compound system in type a6 black parallelogram and single embankment black cross was only 8 at the minimum fig 6a figs 4b and 6b show that when h c was larger than 0 16 and h p was equal to 0 14 and 0 28 the flow types were type b2 b3 or b4 and δe was up to 22 higher than that of case m100r0 comparison of fig 4b with fig 4c shows that the change of flow structure was similar in each when sp increased the average rate of energy reduction was slightly smaller as a whole and the range of energy reduction rates crossbars was larger fig 6b and c figs 4c and 6c show that when h c was larger than 0 16 and h p was equal to 0 14 and 0 28 the flow types were type b2 b3 or b4 and the δe was up to 15 higher than that of single embankment case when the type of flow structure became type b2 or b3 the flow formed a diamond shape due to the transverse crossing of oblique standing waves as shown in fig 3a this flow varied the water level behind the piles and increased the range of energy reduction rate orange crossbars to 12 and 26 at the most against sp 1 5 and 2 25 respectively fig 6b and c when the type of flow structure became type b4 the range of energy reduction rate black crossbars decreased i e around 3 5 fig 6b and c shows that when h p was small h p 0 07 and the type of flow structure became type b4 δe gradually decreased more than that of when h p was equal to 0 14 or 0 28 the result is that δe was almost the same as that of the single embankment case when h c was larger than 0 32 however the δe was up to 19 higher than that of the single embankment case although the flow structure was type b4 as shown in fig 6b the reason seems to be the effect of the drag force of piles when h p was small h p 0 07 and h c was large h c 0 32 the δe was trivial because h p is insignificant as compared to the water depth at the piles h pf and the effect on flow of the drag force by piles was small on the other hand when both h p h p 0 14 and h c were h c 0 32 large the δe was quite large because h p was similar to the water depth at the piles h pf the effects of pile diameter and the physical scale of the model with the same number of rows of piles and sp were investigated for 1 row cases m100r1si m50r1si d 8 mm and m50r1si d 4 mm and for 2 row cases m100r2si m50r2si d 8 mm and m50r2si d 4 mm and are shown in fig 8 a and b respectively together with pileless cases cases m100r0 and m50r0 for comparison the δe of cases m50r1si d 4 mm and m50r2si d 4 mm were not much different from that of cases m50r1si d 8 mm and m50r2si d 8 mm respectively in addition fig 8a and b shows that the δe of 1 100 scale m100r0 m100r1si and m100r2si and 1 50 m50r0 m50r1si and m50r2si have a similar trend therefore the effects of pile diameter and physical scale of the model on δe could be considered small when the number of rows of piles and sp are constant 3 3 relationship between flow structure and hydrodynamic force fig 9 shows the drag force on cylinder d see section 2 3 for cases m100r0 m100r1si and m100r2si when h p 0 07 the drag forces in cases m100r1si and m100r2si were almost the same as case m100r0 when h c was around 0 1 fig 9 this is because the hydraulic jump had already occurred and reduced the energy upstream of the cylinder d for all cases m100r0 m100r1si and m100r2si when h c was larger than 0 22 the drag forces behind the lined piles of cases m100r1si and m100r2si were smaller than that of case m100r0 due to drag of piles although the piles were submerged type a6 and b4 when the h c increased the drag force of case m100r0 increased but the differences in drag forces between case m100r0 and cases m100r1si and m100r2si were almost the same this means that the larger h c the smaller the reduction rate of drag force by piles this was the same trend as δe when h p was 0 07 as already shown in figs 6b and 7a 4 discussion 4 1 energy reduction comparing compound and single embankment systems revealed that the increase of δe is affected only by the drag of lined piles in types a6 b2 and b4 and a hydraulic jump around the lined piles in types a1 a2 a3 and b1 types a3 a4 and b3 affected the increase of δe due to the drag of lined piles and collision of a free nap flow and the downstream bed of piles in type a5 the increase of δe is affected by the drag of lined piles and eddies generated just behind the lined piles fathi moghadam et al 2011 conducted experiments on forced hydraulic jumps in a stilling basin and showed that the sill height and position affects the sequent depth ratio and shortening of the basin length they also showed that the higher the height of the end sill the more energy is reduced at shorter distances these results are closely related to type a2 in which jumping occurs in type a2 the higher the piles the more easily the hydraulic jump can occur and also increase the energy dissipation rate in types a1 a2 a3 and b1 the maximum difference of δe between a compound system and a single embankment system was 23 due to the occurrence of a hydraulic jump around the lined piles tanaka and igarashi 2016 investigated the energy reduction by a double embankment system and suggested that the energy reduction rate δe due to a hydraulic jump in the double embankment system was larger by up to around 20 in maximum than in a single embankment system in types a3 a4 and b3 the maximum difference in δe between a compound system and a single embankment system was 22 because a free nap flow like a ski jump collides with the downstream bed of piles wu et al 2016 showed that a compound system combining a ski jump and a stepped spillway reduces the flow energy especially for large unit discharge in addition tanaka and igarashi 2016 demonstrated that in a double embankment system the δe due to collision of a free nap flow that jumped from the second embankment in a flume bed is similar to the δe due to a hydraulic jump in the present study the energy reduction rates of free nap flow types type a3 and a4 and a hydraulic jump type type a2 were also similar as shown in figs 6a and 7a in type b2 the rate in the area where the flow collided with piles and the flow cross sectional area a rate was large because the piles are in an emergent condition therefore the difference of δe between a compound system and a single embankment system increased up to 22 at the most with an increase in h c on the other hand when the piles were in the submerged condition type a5 a6 and b4 the rate a rate was small because the flow passed over the piles in type a5 the maximum difference of δe between a compound system and a single embankment system was 22 in maximum due to occurrence of an eddy just behind the lined piles although the piles were submerged however in types a6 and b4 eddies were not observed because the standing density of piles was small therefore the difference in δe between the compound system and the single embankment system decreased to 1 minimum with an increase in h c because the effect of drag by piles decreased yusaiyin and tanaka 2009 conducted wind tunnel experiments to investigate the effects of windbreak width on wind direction and spacing of cylinders on the difference of velocity above and inside cylinders many studies discussed the optimal porosity of a windbreak for reducing the velocity near the bed behind the windbreak and the optimal was shown to be 20 30 cornelis and gabriels 2005 the optimal condition for reducing the energy generated by the eddies when the flow depth around piles increased and the piles were submerged should also be investigated in the future 4 2 water surface fluctuation behind lined piles and the change of flow structure in types a1 a2 and a3 water surface fluctuations behind the piles were small on the other hand in types b2 and b3 the fluctuations were large due to the transverse crossing of oblique standing waves the range of energy reduction rates crossbars due to this difference of water levels in different locations was larger when the spacing between piles was greater the range of energy reduction rates crossbars in types b2 and b3 of case m100r2ss as shown in fig 7b was 7 maximum smaller than that in types b2 and b3 of case m100r1ss as shown in fig 6b this result suggests that one of the most important effects of a second row of lined piles is to prevent the occurrence of standing waves therefore if large spacing between piles is needed the number of pile rows should be increased moreover the range of energy reduction rates crossbars was small when the piles were submerged types a5 a6 and b4 although the standing wave was generated in type b4 this is because the flow above piles reduced the effect of standing waves table 3 summarizes the suitable flow type types a1 a2 a3 a4 a5 and b1 in view of energy reduction δe the differences in the energy reduction rate between case m100r0 δem100r0 and the other cases δe and standing wave formation in the table the recommended types are those where a standing wave was not generated and the δe was high a1 and b1 are suitable flow types because δe δe m100r0 was small but δe was high 81 8 86 6 and a standing wave was not generated the δe for flow types a2 b2 and b3 were a little large 50 4 85 5 when h c was small δe δe m100r0 for these flow types were small but δe themselves were high in addition a standing wave was not generated thus type a2 is the most suitable flow type when the number of rows of piles was one a standing wave was generated in types b2 and b3 therefore the recommendation level of these types is moderate the flow types a3 a4 and a5 are suitable flow types because these δe were a little large 59 3 78 5 δe δe m100r0 were high and a standing wave was not generated when the amount of water at the piles h pf was very large compared with h p both δe and δe δe m100r0 for type a6 and b4 were small however the recommendation of type a6 is moderate because δe δe m100r0 was large when h pf was similar to h p and a standing wave was not generated moreover a standing wave was generated in type b4 and thus the recommendation level is low this shows that the change of flow structure following pattern a types a1 a2 a3 a4 a5 and a6 is better than that of pattern b types b1 b2 b3 and b4 when case m100r1sd as shown in figs 4a and 6a is compared with case m100r2si as shown in figs 5a and 7a the change of flow structure for both is in pattern a and the trend of the δe with respect to h c shows a similar trend in addition fig 4b case m100r1si and 5a case m100r2si show that their sp takes a value similar to 1 5 however the flow patterns are completely different because the number of lines in the downstream direction is different when fig 5b is compared with fig 4b and c the flows show a similar pattern pattern b these results show that the change of flow structure was affected not only by sp but also by the number of rows of piles in the downstream direction further the resistance of piles in case m100r2ss is not enough to change the flow from supercritical to subcritical irtem et al 2009 conducted experiments to investigate the effects of wooden cylinders with leaves cl in a coastal forest on tsunami run up heights and concluded that the run up heights for cl were reduced by around 22 compared with that for wooden cylinders without leaves cn when cl and cn were placed in the staggered arrangement considering the actual case corresponding to this study if lined piles are replaced with real trees resistance provided by tree trunks might decrease because the spacing should be larger to allow for growth however resistance can increase when trees with a dense crown of which crown height is low and the spatial density of leaves and branches is high are used the force of standing waves also can be reduced by the damping effect of the tree crowns 4 3 comparison of effects of resp and ps on flow structures and energy reduction this study discussed changes of energy reduction and flow structures due to a compound system with an embankment and downstream lined piles because various parameters affect the energy reduction and flow structures their effects on flow structures and energy reduction should be further clarified in order to use the information for the effective design of a compound defense system as already discussed energy reduction rates δe are significantly affected by whether the piles are emergent or submerged emergent piles are affected by the overflowing water depth pile height and embankment height therefore the non dimensional parameter ps eq 2 was defined in our experiments the emergent submerged condition was clearly distinguished when the β in eq 2 was 0 7 resistance from lined piles significantly affected the δe and flow structures therefore the non dimensional arrangement of lined piles resp consisting of spacing diameter and number of rows of lined piles was defined in eq 1 the values of resp were 0 57 0 40 0 31 0 61 and 0 47 for cases m100r1sd m100r1si m100r1ss m100r2si and m100r2ss respectively as already mentioned the change of flow structure pattern for case m100r1sd and case m100r2si was pattern a the change of flow structures in pattern a occurred when the resp was larger than around 0 5 fig 10 shows the relationship between resp and ps when the resp was larger than around 0 5 and the ps was less than around 1 2 the flow type became type a1 a2 a3 or a4 thus the energy reduction was high and a standing wave immediately downstream of piles did not form the zone can be recommended for effective mitigation of overflowing water from an embankment in extreme tsunami events 4 4 control of scour length and depth behind an embankment the 2011 japan tsunami generated large scoured regions behind sea embankments at many places along a coast tanaka and sato 2015 and breaching of the embankment occurred in many places tappin et al 2012 driftwood was also produced in the scoured regions tanaka et al 2013 there are many studies of the scour around one circular cylinder e g dargahi 1990 debnath and chaudhuri 2010 however most of the studies are related to subcritical conditions in addition not many quantitative studies were conducted using lined cylinders on the other hand yagci et al 2017 carried out experiments to investigate the clear water scour around hexagonal arrays of circular cylinders in steady flow conditions and showed that thin cylinders placed in a circle reduced the scour volume and scour depth behind them compared to a thick cylinder whose diameter was the same as the circle in addition hamidifar et al 2017 investigated the effect of a bed sill as a countermeasure against scour the study showed that the maximum scour depth in front of and behind the sill was greater and smaller respectively than that without a sill based on this information the scour depth may decrease behind the piles in our study and the embankment may become resilient although our study didn t investigate this furthermore because the flow passes into the piles to the downstream side moderately there is a possibility that the scour depth in front of the piles also decreases for the purpose of decreasing the scour depth behind an embankment the piles may affect the scour mechanism and reduce the size of the scoured region however more study is needed on this point by conducting experiments on the mobile bed condition 5 summary the following conclusions were derived from the flume study 1 in the compound system the flow structure after overtopping the embankment can be classified into ten types types a1 a2 a3 a4 a5 a6 b1 b2 b3 and b4 non dimensional overflow water depth h c non dimensional pile spacing sp number of rows of piles and especially non dimensional pile height h p affected the occurrence of a hydraulic jump in front of lined piles only h c and h p affects whether the piles are emergent or submerged in addition the flow structure was not affected by the model scale and the diameter of piles when the number of rows of lined piles and sp were kept constant 2 the compound system reduced energy by 1 23 over the single embankment system due to a hydraulic jump drag force of piles an eddy just behind the piles and collision of a free nap flow and the downstream bed of piles the difference in the energy reduction between the compound system and the single embankment system was low for small overflow depths although the piles were submerged type a6 or b4 in the compound system the δe was still up to 19 higher at the maximum against the same level of piles and water depth than that of a single embankment case due to the drag force by the piles however as the water depth at the piles h pf increased the δe gradually decreased and approached the rate for a single embankment the change of drag force behind the piles showed a similar trend with δe 3 in type b2 or b3 flow transverse crossing of oblique standing waves formed a diamond shape that resulted in variation in water level and consequently reduction of energy loss locally the greater the spacing of piles the greater the range of the energy reduction rate however the range of an energy reduction rate can be reduced by increasing the numbers of rows of lined piles further the water surface fluctuation behind the lined piles decreased when the piles were submerged type a5 a6 and b4 the recommended flow types for tsunami mitigation are those where standing waves are not generated and the δe is high thus the tsunami mitigation effect is large in types a1 a2 a3 a4 a5 and b1 4 the recommended condition is a non dimensional arrangement of lined piles resp that is larger than around 0 5 and the non dimensional parameter whether piles are emergent or submerged ps is less than around 1 2 for the compound defense system with embankment and lined piles behind embankment this study conducted experiments using fixed bed conditions however lined piles behind an embankment may reduce the local scour around them thus reducing erosion behind the embankment and making the embankment more resilient more study is needed on this point by conducting experiments with mobile bed condition acknowledgements this study was partly funded by a jsps grant in aid for scientific research no 15h02987 
23219,for mitigating tsunamis that overtop an embankment flume tests were conducted to clarify the energy reduction of a tsunami due to a compound defense system by a combination of a sea embankment and lined vertical piles behind the embankment the relationship between the flow structure and energy reduction was investigated with changing pile height spacing and number of rows the flow structure was classified into 10 types and the patterns were classified into two the energy reduction increased with smaller spacing between lined piles and the reduction of energy and fluid force behind piles gradually decreased when the piles were submerged in some cases energy reduction became very low or energy was locally concentrated because standing waves were generated behind the piles two important parameters were proposed resp consisting of pile spacing pile diameter and number of lines of piles in the downstream direction and ps comprising overflowing water depth pile height and embankment height ps discriminates whether the piles are emergent or submerged and resp classifies the change in the flow structure pattern recommended design criteria to reduce tsunami energy and to prevent the formation of the standing waves downstream of piles were elucidated by these two parameters keywords energy reduction hydraulic jump overflow from embankment compound defense 1 introduction the 2011 great east japan tsunami extensively destroyed parts of sea walls tsunami gates large embankments tappin et al 2012 and coastal forests tanaka et al 2013 thus the tsunami caused catastrophic damage to people and buildings in the tohoku and kanto districts of japan udo et al 2012 suppasri et al 2013 and revealed the limits of using only a sea embankment as defense after the tsunami the ministry of land infrastructure transport and tourism japan mlit classified tsunamis as level 1 and level 2 the recurrence period of the magnitude for level 1 tsunamis is defined as around 100 years while that for level 2 tsunamis is within hundreds to a thousand years because a level 2 tsunami overtops an embankment a compound defense system is proposed for level 2 tsunamis to mitigate damage to the hinterland however the optimum compound defense system for mitigating a level 2 tsunami is still unknown recently the number of studies that propose compound defense systems i e embankment with coastal forest tanaka et al 2014 tokida and tanimoto 2014 igarashi and tanaka 2016 forest and moat usman et al 2014 moat behind embankment mineura et al 2013 tsujimoto et al 2014 dune and canal niimi et al 2013 rahman et al 2016 2017 barrier behind embankment matsuyama et al 2012 hybrid system with low embankment and forest temmerman et al 2013 and double embankments tanaka and igarashi 2016 has increased when a forest is introduced in the downstream part of an embankment the forest can reduce the tsunami energy by resistance if the resistance provided by a forest is large enough to change the flow from supercritical to subcritical it also can decrease the tsunami energy by causing a hydraulic jump however not many studies have been conducted for that objective in a double embankment system igarashi and tanaka 2016 the second embankment has the risk of being washed out by a tsunami if it is made of soil even in that case reduction of the energy of a tsunami can still be expected when piles are set inside the second embankment and appear after the second embankment was eroded and washed away to decrease the erosion of an embankment and behind it hidden piles or short but dense plants such as bushes also have the capacity to increase the resistance to erosion thus it is very important to investigate the effectiveness of a narrow width forest or piles behind an embankment for reducing the energy that overtops an embankment the effect and limitation of coastal forests had already discussed in shuto 1987 before the 2011 tsunami in addition there are many studies of numerical simulations to evaluate the effects of a coastal forest when tsunami and forest characteristics are changed hiraishi and harada 2003 harada and imamura 2006 nandasena et al 2012 hiraishi and harada 2003 also carried out experiments and showed that a greenbelt composed of tropical trees reduces the tsunami water level flow velocity and pressure tanaka et al 2014 compared the mitigation effect of an embankment and forest during the 2011 japanese tsunami and revealed the importance of the forest by their post tsunami survey and numerical study similar effects can be expected for piles if the spacing of piles or small bush type trees is close enough to affect the flow upstream of piles a hydraulic jump may be generated it is widely known that a hydraulic jump can dissipate tsunami energy ahmed et al 2014 moussa et al 2016 pasha and tanaka 2016 2017 it is also known that a ski jump type of flow can dissipate energy wu et al 2016 if a free nap flow of a ski jump type is generated around the piles or trees by resistance tsunami energy can be dissipated due to collision with the downstream bed of piles or trees although no hydraulic jump is generated the resistance of circular cylinders changes with changes in the spacing of the cylinders takemura and tanaka 2007 and their arrangement li and shen 1973 in addition the combination of sparse and dense cylinders affects the reflection of the tsunami iimura and tanaka 2012 irtem et al 2009 showed that the tsunami run up height for a slope with wooden cylinders placed in a staggered arrangement was decreased compared with that of cylinders in a rectilinear arrangement however few experimental studies of supercritical flow against circular cylinders have been reported in addition more knowledge about conditions for generation of a hydraulic jump around lined cylinders is needed therefore a flume study was conducted to clarify the relationship between the energy reduction and the flow structure when a tsunami passes through a compound defense system i e a combination of embankment and piles lined cylinders towards the land side 2 materials and methods 2 1 experimental apparatus and procedures fig 1 shows the experimental setup the compound system was proposed to reduce the energy of overflowing tsunami water by a hydraulic jump and or resistance of piles this study changed the pile height pile spacing and number of lined piles and investigated the relationship between the flow structure and energy reduction as a first step a steady flow condition was set in an open channel flume with the energy reduction ratio for various compound defense models on a physical scale of 1 100 and 1 50 as shown in fig 1 the flume length and width were 14 m and 0 5 m respectively for setting hydraulic conditions froude similarity was used for the model experiments on a physical scale of 1 100 a wooden embankment model 14 5 cm high was set on the flume bottom for the pile models wooden circular cylinders 0 4 cm in diameter were used and they were set in a single row at regular intervals along the embankment or they were placed in two rows in a staggered arrangement one and two rows of piles were selected as shown in fig 1a and b respectively the spacings between cylinders for one and two rows sp were set as 0 3 0 6 and 0 9 cm and 0 6 and 0 9 cm respectively these five cases were named m100r1sd m100r1si m100r1ss m100r2si and m100r2ss as the convention for case names m100 indicates that the model scale is equal to 1 100 r1 and r2 indicate that the number of rows is 1 and 2 respectively sd si and ss indicate that the pile spacings are dense intermediate and sparse respectively for each of these five cases three pile heights h p were selected 1 2 and 4 cm the distance from the embankment toe to the front line of the piles was constant at 33 cm in addition two cases m50r1si and m50r2si both of whose physical scale are 1 50 were tested to confirm the effects of physical scale on flow structures in cases m50r1si and m50r2si only the small pile height 2 cm was conducted due to the limitation of the pump flow rate to investigate the effect of pile diameter two pile diameters 0 4 0 8 cm were additionally tested in cases m50r1si and m50r2si under the number of rows of lined piles and non dimensional pile spacing sp d were kept constant moreover only the embankment case case m100r0 and m50r0 was tested for comparing the effectiveness of the compound system cases the experimental condition is summarized in table 1 2 2 parameters used in this study using the model and hydraulic parameters shown in fig 1 five non dimensional parameters were defined in this study non dimensional pile spacing sp was defined as sp sp d where sp and d are the spacing between the piles and the diameter of a pile respectively sp was set as 0 75 1 5 and 2 25 non dimensional pile height h p was defined as h p h p h e where h p and h e are the pile height and embankment height respectively h p were set as 0 07 0 14 and 0 28 for comparison of results non dimensional overflow water depth h c was defined as h c h c h e where h c is the critical depth on top of the embankment in cases in which the physical scale of the model was 1 100 or 1 50 the flow structure was investigated in relation to h c in the range of approximately 0 08 0 37 or 0 08 to 0 22 respectively 2 2 1 non dimensional arrangement of lined piles resp resistance of lined piles affects the flow structure behind piles therefore the non dimensional arrangement of lined piles resp was defined as 1 re s p d s p d α d s p d l where α is 0 or 1 when the number of rows is 1 or 2 respectively and l is the distance in between the row of lined piles as shown in fig 1 on the right hand side of eq 1 the first term means the ratio of a unit length in the direction along the embankment sp d and the diameter of a pile in the first row d the second term also means the ratio but it includes the effect of l when l approaches 0 while keeping α as 1 two row condition resp approaches to 2d sp d it correctly expresses the one row and double density condition in addition resp shows that the effect of lined piles of the second row becomes 0 when l becomes infinite 2 2 2 non dimensional parameter on whether piles are emergent or submerged ps the relationship among pile heights overflow water depths and embankment heights affects whether piles are emergent or submerged so a non dimensional pile and water surface parameter ps was defined as 2 p s h c h p β h c h e h p h e β where β is a constant that expresses the backwater rise due to piles the effect of h p is smaller than that of h c because the backwater rise around piles due to changing h p is smaller than the rise of water level around piles by changing h c therefore β in eq 2 should be less than 1 0 2 3 methods for evaluating reduction of tsunami energy the overflow water depth from the embankment h c and water depth behind the piles h 2 were measured in all cases in some cases fluctuations in the water surface were observed behind the piles with time and space and hence maximum and minimum h 2 were measured and their average value was calculated for estimating the tsunami mitigation effect of the piles this study defined the energy reduction rate δe as follows 3 δ e e 1 e 2 e 1 100 where e 1 and e 2 were the energies at which h c and h 2 were measured respectively and were calculated from bernoulli s theorem to confirm the location of h c on top of the embankment where the froude number equals 1 the flow discharge was measured by using a triangular notch 2 4 methods for evaluating fluid force behind lined piles for directly evaluating the effect of an embankment piles compound system on fluid force reduction behind the lined piles the drag force on a cylinder cylinder d with diameter of 4 mm was measured by a force gauge kss company ltd lb60 10n at the place where h 2 was measured for cases m100r0 m100r1si and m100r2ss when h p was 0 07 cylinder d was set downstream of piles where the flow structure itself was not changed and it measured only the drag force 3 results 3 1 classification of flow structure in the single embankment case energy reduction rates δe were estimated to be approximately 38 81 by flume tests because overflowing water from the embankment collided with the bed in the compound system the flow structure after overtopping the embankment was classified into ten types according to sp when sp was small 0 75 and h p was 0 07 0 14 and 0 28 the flow pattern can be classified into six types for h c 0 08 0 37 as shown in fig 2 a with the increase in non dimensional overflow water depth h c the type of flow structure changed from types a1 a2 a3 a4 a5 to a6 this change of flow structure was defined as pattern a in this study when h c was small 0 08 and h p was 0 07 and 0 14 the flow is in the supercritical condition between embankment and piles while it becomes subcritical behind the piles type a1 by further increasing h c 0 14 0 21 when h p was 0 07 and 0 14 the water retained around piles was washed away and type a3 was generated in this type the flow used the piles like a ski jump a free nap flow collided with the downstream bed of piles and a hydraulic jump occurred in succession when h c was further increased 0 23 0 25 and h p was 0 14 the hydraulic jump downstream of the piles was not generated type a4 with a further increase in h c 0 21 0 36 when h p was 0 07 and 0 14 the water depth just at the front side of the upstream piles h pf as shown in fig 1a became larger than the pile height which resulted in eddy formation instead of a free nap flow just behind the piles this is due to the large difference in flow velocity inside the piles and over the piles type a5 increasing h c further 0 21 0 36 when h p was 0 07 did not generate an eddy and the effect of resistance of piles became smaller type a6 when h p was 0 28 type a1 and type a3 were generated when h c were 0 08 and 0 35 respectively when h p was 0 28 and h c was 0 14 0 32 a hydraulic jump occurred in front of the piles type a2 when sp was large 1 5 2 25 four flow patterns were observed for h c 0 08 0 37 as shown in fig 2b with an increase in non dimensional over flow water depth h c the type of flow structure changed from type b1 to b2 to b3 to b4 this change of flow structure was defined as pattern b in this study when h c was small 0 08 a hydraulic jump occurred behind the piles but separately type b1 when further increasing h c the hydraulic jump was not generated behind the piles in this case when the flow passed through the piles in a supercritical flow splashes and oblique standing waves fig 3 a type b2 were generated just behind the piles therefore the water depth and water surface fluctuation became large fig 3a and b shows the images of flow structure behind the lined piles in case m100r1ss h p 0 14 h c 0 20 and case m100r2ss h p 0 14 h c 0 22 respectively by further increasing h c the standing wave was still generated and splashes became like a free nap flow type b3 type b3 is similar to type a4 but a standing wave was not observed in type a4 by further increasing h c the water at the piles h pf became deeper than the piles height and in this case just behind piles neither the free nap flow was generated nor the eddy formation was observed because the difference in flow velocity inside the piles and over the piles was small type b4 a standing wave was also generated in type b4 table 2 summarizes the change of flow structure in each case a figure of flow structure types which has h c on the vertical axis and h p on the cross axis was plotted with a different color for each flow structure as shown in fig 4a b 4c 5a and 5 b for cases m100r1sd m100r1si m100r1ss m100r2si and m100r2ss respectively flow structure types of cases m50r1si and m50r2si were also plotted in figs 4b and 5a respectively the type of flow structure was judged from the video footage of the experiment in the figure the boundary lines that classify the flow type are shown drawn figs 4 and 5 show that when h c was larger than 0 2 and h p was 0 07 or h c was larger than 0 3 and h p was 0 14 the water depth at the piles h pf was higher than the pile height even if sp was 0 75 1 5 or 2 25 and the physical scale of the model was 1 100 or 1 50 therefore the type of flow structure became type a5 a6 or b4 it shows that the relationship between pile height and water depth at the piles depends on the relationship between h c and h p not sp and the physical scale of the model figs 4a and 5a suggest that the pile height was important whether a hydraulic jump occurred in front of the lined piles or not when the piles were short h p 0 75 1 5 a free nap flow on the lined piles like a ski jump easily occurred although a hydraulic jump was not generated in front of the lined piles 3 2 relationship between flow structure and energy reduction rate δe the energy reduction rate δe defined in eq 3 is shown in fig 6a b 6c 7a and 7 b for cases m100r1sd m100r1si m100r1ss m100r2si and m100r2ss respectively in some cases the water level immediately behind the lined piles varied which resulted in a wide range of energy reduction rates although the non dimensional overflow water depth was constant therefore crossbars indicating the range of energy reduction rate were drawn on the figure for comparison the δe for a single embankment case case m100r0 is also included in figs 6 and 7 when h c was less than 0 15 the difference of δe between a single embankment case and a compound system was very small because even in the single embankment case tsunami energy could be reduced and δe was large 70 81 as shown in figs 6 and 7 figs 4a and 6a show that when h c was larger than 0 21 and h p was equal to 0 14 and 0 28 the flow types were type a2 a3 a4 or a5 and the energy reduction rate δe was up to 23 higher at maximum than that of case m100r0 however when h p was equal to 0 07 and the flow type became type a6 the δe gradually decreased and almost equaled that of case m100r0 the difference in δe between the compound system in type a6 black parallelogram and single embankment black cross was only 8 at the minimum fig 6a figs 4b and 6b show that when h c was larger than 0 16 and h p was equal to 0 14 and 0 28 the flow types were type b2 b3 or b4 and δe was up to 22 higher than that of case m100r0 comparison of fig 4b with fig 4c shows that the change of flow structure was similar in each when sp increased the average rate of energy reduction was slightly smaller as a whole and the range of energy reduction rates crossbars was larger fig 6b and c figs 4c and 6c show that when h c was larger than 0 16 and h p was equal to 0 14 and 0 28 the flow types were type b2 b3 or b4 and the δe was up to 15 higher than that of single embankment case when the type of flow structure became type b2 or b3 the flow formed a diamond shape due to the transverse crossing of oblique standing waves as shown in fig 3a this flow varied the water level behind the piles and increased the range of energy reduction rate orange crossbars to 12 and 26 at the most against sp 1 5 and 2 25 respectively fig 6b and c when the type of flow structure became type b4 the range of energy reduction rate black crossbars decreased i e around 3 5 fig 6b and c shows that when h p was small h p 0 07 and the type of flow structure became type b4 δe gradually decreased more than that of when h p was equal to 0 14 or 0 28 the result is that δe was almost the same as that of the single embankment case when h c was larger than 0 32 however the δe was up to 19 higher than that of the single embankment case although the flow structure was type b4 as shown in fig 6b the reason seems to be the effect of the drag force of piles when h p was small h p 0 07 and h c was large h c 0 32 the δe was trivial because h p is insignificant as compared to the water depth at the piles h pf and the effect on flow of the drag force by piles was small on the other hand when both h p h p 0 14 and h c were h c 0 32 large the δe was quite large because h p was similar to the water depth at the piles h pf the effects of pile diameter and the physical scale of the model with the same number of rows of piles and sp were investigated for 1 row cases m100r1si m50r1si d 8 mm and m50r1si d 4 mm and for 2 row cases m100r2si m50r2si d 8 mm and m50r2si d 4 mm and are shown in fig 8 a and b respectively together with pileless cases cases m100r0 and m50r0 for comparison the δe of cases m50r1si d 4 mm and m50r2si d 4 mm were not much different from that of cases m50r1si d 8 mm and m50r2si d 8 mm respectively in addition fig 8a and b shows that the δe of 1 100 scale m100r0 m100r1si and m100r2si and 1 50 m50r0 m50r1si and m50r2si have a similar trend therefore the effects of pile diameter and physical scale of the model on δe could be considered small when the number of rows of piles and sp are constant 3 3 relationship between flow structure and hydrodynamic force fig 9 shows the drag force on cylinder d see section 2 3 for cases m100r0 m100r1si and m100r2si when h p 0 07 the drag forces in cases m100r1si and m100r2si were almost the same as case m100r0 when h c was around 0 1 fig 9 this is because the hydraulic jump had already occurred and reduced the energy upstream of the cylinder d for all cases m100r0 m100r1si and m100r2si when h c was larger than 0 22 the drag forces behind the lined piles of cases m100r1si and m100r2si were smaller than that of case m100r0 due to drag of piles although the piles were submerged type a6 and b4 when the h c increased the drag force of case m100r0 increased but the differences in drag forces between case m100r0 and cases m100r1si and m100r2si were almost the same this means that the larger h c the smaller the reduction rate of drag force by piles this was the same trend as δe when h p was 0 07 as already shown in figs 6b and 7a 4 discussion 4 1 energy reduction comparing compound and single embankment systems revealed that the increase of δe is affected only by the drag of lined piles in types a6 b2 and b4 and a hydraulic jump around the lined piles in types a1 a2 a3 and b1 types a3 a4 and b3 affected the increase of δe due to the drag of lined piles and collision of a free nap flow and the downstream bed of piles in type a5 the increase of δe is affected by the drag of lined piles and eddies generated just behind the lined piles fathi moghadam et al 2011 conducted experiments on forced hydraulic jumps in a stilling basin and showed that the sill height and position affects the sequent depth ratio and shortening of the basin length they also showed that the higher the height of the end sill the more energy is reduced at shorter distances these results are closely related to type a2 in which jumping occurs in type a2 the higher the piles the more easily the hydraulic jump can occur and also increase the energy dissipation rate in types a1 a2 a3 and b1 the maximum difference of δe between a compound system and a single embankment system was 23 due to the occurrence of a hydraulic jump around the lined piles tanaka and igarashi 2016 investigated the energy reduction by a double embankment system and suggested that the energy reduction rate δe due to a hydraulic jump in the double embankment system was larger by up to around 20 in maximum than in a single embankment system in types a3 a4 and b3 the maximum difference in δe between a compound system and a single embankment system was 22 because a free nap flow like a ski jump collides with the downstream bed of piles wu et al 2016 showed that a compound system combining a ski jump and a stepped spillway reduces the flow energy especially for large unit discharge in addition tanaka and igarashi 2016 demonstrated that in a double embankment system the δe due to collision of a free nap flow that jumped from the second embankment in a flume bed is similar to the δe due to a hydraulic jump in the present study the energy reduction rates of free nap flow types type a3 and a4 and a hydraulic jump type type a2 were also similar as shown in figs 6a and 7a in type b2 the rate in the area where the flow collided with piles and the flow cross sectional area a rate was large because the piles are in an emergent condition therefore the difference of δe between a compound system and a single embankment system increased up to 22 at the most with an increase in h c on the other hand when the piles were in the submerged condition type a5 a6 and b4 the rate a rate was small because the flow passed over the piles in type a5 the maximum difference of δe between a compound system and a single embankment system was 22 in maximum due to occurrence of an eddy just behind the lined piles although the piles were submerged however in types a6 and b4 eddies were not observed because the standing density of piles was small therefore the difference in δe between the compound system and the single embankment system decreased to 1 minimum with an increase in h c because the effect of drag by piles decreased yusaiyin and tanaka 2009 conducted wind tunnel experiments to investigate the effects of windbreak width on wind direction and spacing of cylinders on the difference of velocity above and inside cylinders many studies discussed the optimal porosity of a windbreak for reducing the velocity near the bed behind the windbreak and the optimal was shown to be 20 30 cornelis and gabriels 2005 the optimal condition for reducing the energy generated by the eddies when the flow depth around piles increased and the piles were submerged should also be investigated in the future 4 2 water surface fluctuation behind lined piles and the change of flow structure in types a1 a2 and a3 water surface fluctuations behind the piles were small on the other hand in types b2 and b3 the fluctuations were large due to the transverse crossing of oblique standing waves the range of energy reduction rates crossbars due to this difference of water levels in different locations was larger when the spacing between piles was greater the range of energy reduction rates crossbars in types b2 and b3 of case m100r2ss as shown in fig 7b was 7 maximum smaller than that in types b2 and b3 of case m100r1ss as shown in fig 6b this result suggests that one of the most important effects of a second row of lined piles is to prevent the occurrence of standing waves therefore if large spacing between piles is needed the number of pile rows should be increased moreover the range of energy reduction rates crossbars was small when the piles were submerged types a5 a6 and b4 although the standing wave was generated in type b4 this is because the flow above piles reduced the effect of standing waves table 3 summarizes the suitable flow type types a1 a2 a3 a4 a5 and b1 in view of energy reduction δe the differences in the energy reduction rate between case m100r0 δem100r0 and the other cases δe and standing wave formation in the table the recommended types are those where a standing wave was not generated and the δe was high a1 and b1 are suitable flow types because δe δe m100r0 was small but δe was high 81 8 86 6 and a standing wave was not generated the δe for flow types a2 b2 and b3 were a little large 50 4 85 5 when h c was small δe δe m100r0 for these flow types were small but δe themselves were high in addition a standing wave was not generated thus type a2 is the most suitable flow type when the number of rows of piles was one a standing wave was generated in types b2 and b3 therefore the recommendation level of these types is moderate the flow types a3 a4 and a5 are suitable flow types because these δe were a little large 59 3 78 5 δe δe m100r0 were high and a standing wave was not generated when the amount of water at the piles h pf was very large compared with h p both δe and δe δe m100r0 for type a6 and b4 were small however the recommendation of type a6 is moderate because δe δe m100r0 was large when h pf was similar to h p and a standing wave was not generated moreover a standing wave was generated in type b4 and thus the recommendation level is low this shows that the change of flow structure following pattern a types a1 a2 a3 a4 a5 and a6 is better than that of pattern b types b1 b2 b3 and b4 when case m100r1sd as shown in figs 4a and 6a is compared with case m100r2si as shown in figs 5a and 7a the change of flow structure for both is in pattern a and the trend of the δe with respect to h c shows a similar trend in addition fig 4b case m100r1si and 5a case m100r2si show that their sp takes a value similar to 1 5 however the flow patterns are completely different because the number of lines in the downstream direction is different when fig 5b is compared with fig 4b and c the flows show a similar pattern pattern b these results show that the change of flow structure was affected not only by sp but also by the number of rows of piles in the downstream direction further the resistance of piles in case m100r2ss is not enough to change the flow from supercritical to subcritical irtem et al 2009 conducted experiments to investigate the effects of wooden cylinders with leaves cl in a coastal forest on tsunami run up heights and concluded that the run up heights for cl were reduced by around 22 compared with that for wooden cylinders without leaves cn when cl and cn were placed in the staggered arrangement considering the actual case corresponding to this study if lined piles are replaced with real trees resistance provided by tree trunks might decrease because the spacing should be larger to allow for growth however resistance can increase when trees with a dense crown of which crown height is low and the spatial density of leaves and branches is high are used the force of standing waves also can be reduced by the damping effect of the tree crowns 4 3 comparison of effects of resp and ps on flow structures and energy reduction this study discussed changes of energy reduction and flow structures due to a compound system with an embankment and downstream lined piles because various parameters affect the energy reduction and flow structures their effects on flow structures and energy reduction should be further clarified in order to use the information for the effective design of a compound defense system as already discussed energy reduction rates δe are significantly affected by whether the piles are emergent or submerged emergent piles are affected by the overflowing water depth pile height and embankment height therefore the non dimensional parameter ps eq 2 was defined in our experiments the emergent submerged condition was clearly distinguished when the β in eq 2 was 0 7 resistance from lined piles significantly affected the δe and flow structures therefore the non dimensional arrangement of lined piles resp consisting of spacing diameter and number of rows of lined piles was defined in eq 1 the values of resp were 0 57 0 40 0 31 0 61 and 0 47 for cases m100r1sd m100r1si m100r1ss m100r2si and m100r2ss respectively as already mentioned the change of flow structure pattern for case m100r1sd and case m100r2si was pattern a the change of flow structures in pattern a occurred when the resp was larger than around 0 5 fig 10 shows the relationship between resp and ps when the resp was larger than around 0 5 and the ps was less than around 1 2 the flow type became type a1 a2 a3 or a4 thus the energy reduction was high and a standing wave immediately downstream of piles did not form the zone can be recommended for effective mitigation of overflowing water from an embankment in extreme tsunami events 4 4 control of scour length and depth behind an embankment the 2011 japan tsunami generated large scoured regions behind sea embankments at many places along a coast tanaka and sato 2015 and breaching of the embankment occurred in many places tappin et al 2012 driftwood was also produced in the scoured regions tanaka et al 2013 there are many studies of the scour around one circular cylinder e g dargahi 1990 debnath and chaudhuri 2010 however most of the studies are related to subcritical conditions in addition not many quantitative studies were conducted using lined cylinders on the other hand yagci et al 2017 carried out experiments to investigate the clear water scour around hexagonal arrays of circular cylinders in steady flow conditions and showed that thin cylinders placed in a circle reduced the scour volume and scour depth behind them compared to a thick cylinder whose diameter was the same as the circle in addition hamidifar et al 2017 investigated the effect of a bed sill as a countermeasure against scour the study showed that the maximum scour depth in front of and behind the sill was greater and smaller respectively than that without a sill based on this information the scour depth may decrease behind the piles in our study and the embankment may become resilient although our study didn t investigate this furthermore because the flow passes into the piles to the downstream side moderately there is a possibility that the scour depth in front of the piles also decreases for the purpose of decreasing the scour depth behind an embankment the piles may affect the scour mechanism and reduce the size of the scoured region however more study is needed on this point by conducting experiments on the mobile bed condition 5 summary the following conclusions were derived from the flume study 1 in the compound system the flow structure after overtopping the embankment can be classified into ten types types a1 a2 a3 a4 a5 a6 b1 b2 b3 and b4 non dimensional overflow water depth h c non dimensional pile spacing sp number of rows of piles and especially non dimensional pile height h p affected the occurrence of a hydraulic jump in front of lined piles only h c and h p affects whether the piles are emergent or submerged in addition the flow structure was not affected by the model scale and the diameter of piles when the number of rows of lined piles and sp were kept constant 2 the compound system reduced energy by 1 23 over the single embankment system due to a hydraulic jump drag force of piles an eddy just behind the piles and collision of a free nap flow and the downstream bed of piles the difference in the energy reduction between the compound system and the single embankment system was low for small overflow depths although the piles were submerged type a6 or b4 in the compound system the δe was still up to 19 higher at the maximum against the same level of piles and water depth than that of a single embankment case due to the drag force by the piles however as the water depth at the piles h pf increased the δe gradually decreased and approached the rate for a single embankment the change of drag force behind the piles showed a similar trend with δe 3 in type b2 or b3 flow transverse crossing of oblique standing waves formed a diamond shape that resulted in variation in water level and consequently reduction of energy loss locally the greater the spacing of piles the greater the range of the energy reduction rate however the range of an energy reduction rate can be reduced by increasing the numbers of rows of lined piles further the water surface fluctuation behind the lined piles decreased when the piles were submerged type a5 a6 and b4 the recommended flow types for tsunami mitigation are those where standing waves are not generated and the δe is high thus the tsunami mitigation effect is large in types a1 a2 a3 a4 a5 and b1 4 the recommended condition is a non dimensional arrangement of lined piles resp that is larger than around 0 5 and the non dimensional parameter whether piles are emergent or submerged ps is less than around 1 2 for the compound defense system with embankment and lined piles behind embankment this study conducted experiments using fixed bed conditions however lined piles behind an embankment may reduce the local scour around them thus reducing erosion behind the embankment and making the embankment more resilient more study is needed on this point by conducting experiments with mobile bed condition acknowledgements this study was partly funded by a jsps grant in aid for scientific research no 15h02987 
