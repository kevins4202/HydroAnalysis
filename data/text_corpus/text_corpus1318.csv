index,text
6590,a three dimensional coupled groundwater reactive transport and equilibrium chemistry model is presented that simulates the fate and transport of major salt ions in agricultural groundwater systems that span broad regions the uzf rt3d sec model amends the base model uzf rt3d by coupling it with a new salinity equilibrium chemistry sec module to simulate the movement and transformation of major salt ions calcium magnesium sodium potassium sulfate chloride bicarbonate and carbonate due to advection dispersion source sink mixing sulfur cycling redox reactions precipitation dissolution aqueous complexation and cation exchange the coupling procedure and the considered reactions make the model applicable for simulating regional scale agricultural aquifer systems with data efficiency and an acceptable processing time the model receives flow information from the modflow uzf flow model which simulates variably saturated groundwater flow in an efficient manner over regional scales for use in agricultural areas the model also accounts for crop uptake soil organic matter decomposition and mineralization immobilization of carbon nitrogen and sulfur species the model is applied to a salinity impaired regional scale 500 km2 agricultural area within the irrigated valley of the arkansas river in southeastern colorado it is calibrated and tested against salt ion groundwater concentrations measured in monitoring wells soil salinity measurements from throughout the region and total salt loads discharging from the aquifer to the stream network of the arkansas river results indicate that the model represents well the overall magnitude and spatiotemporal trends of soil salinity and groundwater salinity in the aquifer along with salt loading to streams and therefore can be used to investigate best management practices for salt remediation this along with findings indicating that the inclusion of equilibrium chemistry is vital for producing the correct magnitude of salt ion concentrations and mass loadings render a tool useful for regional investigation of other highly salinized aquifer systems keywords salinity groundwater reactive transport model equilibrium chemistry precipitation dissolution irrigation 1 introduction high salinity in groundwater and soils afflicts many areas of the world specifically arid and semi arid agricultural regions that rely on irrigation for sustaining crop yield reduction in crop yield is an important economic consequence of salt build up in the root zone in many regions of the world including iran jalali 2007 jamshidzadeh et al 2011 ebrahimi et al 2016 india singh 2005 jeevanandam et al 2007 misra et al 2007 lorenzen et al 2012 the western united states e g san joaquin valley in california schoups et al 2006 pakistan mahmood et al 2001 qureshi et al 2008 latif et al 2009 china pereira et al 2007 chen et al 2010 wang et al 2018 and australia herczeg et al 2001 tweed et al 2007 skrzypek et al 2013 high salinity can occur due to waterlogging from shallow groundwater with associated evaporative upflux morway and gates 2012 harrington and cook 2014 dissolution of salt minerals such as gypsum caso4 calcite caco3 and halite nacl harrington and cook 2014 farid et al 2015 and seawater intrusion in coastal areas shammas and jacks 2007 sherif et al 2011 blanco et al 2013 the impact of possible remediation practices on high groundwater and soil salinity often is assessed using models that attempt to capture the major hydrologic processes and chemical reactions that govern the transport of salt species in coupled soil aquifer systems these models also are used to provide insights into the nature of processes that govern salt species transport in these systems models are employed at a variety of spatial scales ranging from one dimensional 1d soil profiles to river basins and include varying degrees of complexity from simple advective transport to multi species reactive transport integrating equilibrium and kinetic chemistry as summarized in table 1 several models include many of the governing physical and chemical processes for salt fate and transport phreeqc is a 1d model developed to perform a variety of aqueous geochemical calculations in saturated media parkhust and appelo 1999 unsatchem šimůnek and suarez 1994 includes chemical reactions such as precipitation dissolution of salt minerals cation exchange and complexation to simulate spatio temporal concentration of major salt ions in soil water systems hydrus 1d šimůnek et al 2005 a finite element model for simulating the movement of water and multiple solutes in variably saturated porous media was amended to include the unsatchem module for major salt ion chemistry šimůnek et al 2012 multidimensional modeling capability of hydrus has been developed as well the hp1 model couples hydrus 1d with phreeqc to address a broader range of ions but is restricted to 1d transport jacques et al 2003 jacques and šimůnek 2005 the second and third versions of hpx were developed later to incorporate two dimensional 2d and three dimensional 3d modeling capability hydrogeochem is a numerical fluid flow model which iteratively solves 3d fluid flow and geochemical transport equations yeh et al 2004 for comparison traits of the uzf rt3d sec model presented here also are included in table 1 most notably uzf rt3d sec simulates all major salinity processes in a 3d variably saturated groundwater flow system due to the linkage with modflow the model can also simulate salt mass exchange between the aquifer and surface water features rivers streams lakes reservoirs etc other models besides those summarized in table 1 link geochemistry and multi species reactive transport in saturated or variably saturated porous media e g pht3d prommer et al 2003 vam2d huyakorn et al 1991 dynamix narasimhan et al 1986 phast parkhust et al 2004 leachm wagenet and hutson 1987 however they have not been applied to salt fate and transport and do not always include the necessary chemical reactions e g cation exchange or are limited to analysis of the saturated zone e g phast pht3d moreover these models typically are applied over small spatial scales e g soil profiles at experimental field plots goncalves et al 2006 forkutsa et al 2009 tafteh and sepaskhah 2012 rasouli et al 2013 due to high computational costs and extensive data requirements a second subset of salinity models are those whose application at a large spatial scale catchment to river basin have been reported such tools are useful for the evaluation of agro environmental health and economic vitality at a regional planning level however they may not include the chemical processes e g precipitation dissolution that often govern salt ion concentration in variably saturated groundwater systems or are computationally inefficient table 2 shows a list of salt transport modeling studies applied at the regional scale 102 103 km2 and selected features of the respective model used for each study the area of the study region and the modeled physical and chemical processes are included a hydro salinity model that couples modhms with unsatchem was used by schoups et al 2005 to simulate subsurface salt transport and storage in a 1400 km2 region of the san joaquin valley the coupling of the two models for 3d salinity reactive transport however is not explained in the paper and the modeling system does not account for element carbon nitrogen sulfur mass cycling in the plant soil system lin and garcia 2008 applied watsuit a steady state model that calculates soil water interaction in the root zone in colorado s lower arkansas river valley to determine the salinity of deep percolation water they modified watsuit to simulate dynamic conditions with a monthly time step and applied the model to simulate unsaturated flow for a 12 month period in the root zone of fields sahysmod oosterbaan 2005 is an integrated agro hydro salinity model amenable to the analysis of large agricultural areas but handles processes based exclusively on water and salt balances and does not account for chemical reactions sahysmod has been applied to simulate the water and salt behavior in the semi arid irrigated area of haryana state in india where waterlogging and salinization have impacted the region for more than 40 years singh and panda 2012 tuteja et al 2003 assessed the effect of land use changes on salt and water balance in the mandagery creek catchment of new south wales australia using catsalt a distributed water balance model linked with a salt transport module burkhalter and gates 2005 2006 developed and applied an mt3d model incorporating a one dimensional mass balance in the unsaturated zone to simulate weekly soil and aquifer salt concentration across an irrigated region of colorado s lower arkansas river valley the model assumed only advective transport not accounting for kinetic and equilibrium chemical reactions tavakoli kivi and bailey 2017 simulated the groundwater fate and transport of so4 in the same region but were not able to reproduce the correct magnitude of concentration in groundwater due to the neglect of equilibrium chemistry reactions e g precipitation dissolution of salt minerals in the modeling framework overall the chemical processes that often regulate salt species fate and transport such as precipitation dissolution complexation cation exchange first order degradation and redox reactions have not been represented in modeling applications at a large spatial scale nevertheless the degradation of aquifers and streams by the accumulation of salts as well as their remediation is brought about by practices and processes that interact from field to field over vast spatial extents models are needed that can adequately simulate these practices and processes to better understand salinization over regional landscapes and explore land and water management alternatives for mitigation moreover there is a need to demonstrate in a data rich environment the potential for such models to reasonably capture the major processes that determine the severity and distribution of salinity over a regional scale this study presents a finite difference numerical model that simulates the fate and transport of major salt ions in large scale variably saturated groundwater systems while accounting for major salt inputs equilibrium chemical reactions oxidation reduction reactions and the cycling of carbon c nitrogen n and sulfur s in the plant soil system the modeling framework consists of groundwater flow modeling by modflow and reactive transport modeling by uzf rt3d bailey et al 2013a coupled with a new salinity equilibrium chemistry sec module processes simulated by modflow include 1d flow in the unsaturated zone evapotranspiration et from crops and natural vegetation groundwater pumping canal seepage 3d groundwater flow in the saturated zone upflux through the vadose zone and water exchange with streams morway et al 2013 uzf rt3d bailey et al 2013a is a finite difference fortran code that simulates reactive transport of multiple interacting chemical species in variably saturated groundwater flow systems using flow and source sink output from the modflow model this paper presents uzf rt3d sec which allows the modeling framework to simulate the fate and transport of major salt ions calcium ca magnesium mg sodium na potassium k sulfate so4 chloride cl and bicarbonate hco3 in the aquifer system unique features of this framework include the new sec module which simulates chemical equilibrium reactions for salt ions such as precipitation dissolution of salt minerals e g gypsum caso4 in anticipation of model use in other regions worldwide the salinity module source code has been designed for ease of including additional salt minerals that may be present in other groundwater systems the use of modflow s uzf unsaturated zone flow package which assumes vertical homogeneity of the unsaturated zone and neglects the diffusive term in the richards equation thus demanding less computational effort and data support than models that solve the full richards equation hence providing a suitable tool for simulating variably saturated flow and transport at the regional scale to determine downward vertical flux the kinematic wave approximation is used with et extracted from water stored within the soil root zone as a sink term within the equation when a specified lower limit of readily available soil water is reached et is then supplied by upflux from the water table using a linear function of depth to the water table up to a specified maximum extinction depth morway et al 2013 harbaugh 2005 the use of c n and s cycling modules developed for uzf rt3d bailey et al 2013b tavakoli kivi and bailey 2017 n cycling can affect so4 concentration in soil and groundwater due to redox sensitivity and nitrate no3 can oxidize so4 from shale material which underlies many alluvial aquifers worldwide these modules also include organic matter decomposition and mineralization plant uptake sorption oxidation reduction and fertilizer loading 2 salinity fate and transport in an agricultural groundwater system the fate and transport of major salt ions in an irrigated agricultural region are depicted in fig 1 the cycling of c and n are included bailey et al 2013b due to their effect on s cycling and so4 chemical reduction and the release of so4 from pyrite fes2 in the presence of o2 and no3 these conditions are not present in all aquifer systems but pyrite is present in bedrock and outcropped marine shale in many regions worldwide cycling of s mass occurs as organic s is incorporated via plowing into soil organic matter composed of litter fast decomposing and humus slow decomposing then mineralized to so4 and then taken up by crop roots during the growing season s mass also can be added to the root zone via fertilizer so4 can be chemically reduced via a microbially mediated chemical reduction reaction frind et al 1990 inhibited by the presence of o2 and no3 due to the succession of terminal electron e acceptor processes furthermore so4 can be released from fes2 via autotrophic reduction of o2 and no3 frind et al 1990 postma et al 1991 pauwels et al 1998 so4 mass along with the mass of the other major anions cl co3 hco3 and cations mg ca na can be added to the subsurface via irrigation water and seeped surface water canal water stream water irrigation water can be derived either from surface water or from groundwater via pumping if salt minerals e g caso4 caco3 and nacl are present in the soil and aquifer sediments dissolution of the salt solids or precipitation out of the solution can occur resulting in an increase or decrease in salt ion concentration in the groundwater and soil water in addition complexation of the dissolved species and cation exchange reactions can occur once in the groundwater system the salt ions can be transported through the aquifer and to surface water discharge sites if concentrations exceed saturation limits then precipitation to salt solids can occur 3 model development the transport of m reactive species can be written in terms of concentrations c i as miller and benson 1983 steefel and lasaga 1994 šimůnek and suarez 1994 carrayrou et al 2004 ezzedine 2015 1 c i t l c i x t f j c 1 c m where l denotes the transport model such as advection and diffusion and fj represents the chemical sub models such as precipitation dissolution this section describes the uzf rt3d transport and chemical kinetics model followed by a description of the new sec module 3 1 salinity transport and chemical kinetics the base solute reactive transport model is uzf rt3d bailey et al 2013b which receives groundwater flow data from a modflow nwt niswonger et al 2011 model that employs the unsaturated zone flow uzf package niswonger et al 2006 and solves the following system of advection dispersion reaction adr equations for the dissolved phase species and the reaction equations for solid phase species in variably saturated groundwater systems using a finite difference approach bailey et al 2013a 2a c k θ t r k x i θ v i c k x i θ d ij c k x j q f c f k θ r f ρ b c k t ρ b c k t k 1 2 m 2b c l ε t α l p s ε r s l 1 2 n where ck and cl are the concentration of the k th dissolved phase solute m f l f 3 and l th solid phase species m s l s 3 respectively with f denoting the fluid phase d ij is the hydrodynamic dispersion coefficient l 2 t 1 v is the pore velocity l b t 1 with b denoting the bulk phase θ is the volumetric water content l f 3 l b 3 q f is the volumetric flux of water representing sources and sinks l f 3 t 1 l b 3 such as irrigation water canal and seepage groundwater discharge to the river or pumped groundwater c f is the concentration of solute in the source or sink water m f l f 3 r f represents the rate of the reactions that occur in the dissolved phase m f l f 3 t 1 r j is the retardation factor for species j and is equal to 1 ρ b k d j θ where ρ b is the bulk density of the porous media m b l b 3 and k d j is the partitioning coefficient for the jth species l f 3 m b c k is the total solid phase concentration of aqueous species k which considers precipitation dissolution mm 1 c k is the total exchanged phase concentration of aqueous species k mm 1 ps is the application rate of after harvest stover mass kg ha 1 α l is the portion of the stover mass attributed to the solute ε is the volumetric solid content l s 3 l b 3 and is equal to 1 ϕ with ϕ representing porosity and rs is the reaction rate with s denoting the solid phase uzf rt3d uses output from a modflow nwt niswonger et al 2011 that uses the uzf package niwsonger et al 2006 for v and qf eq 2b represents change in soil organic matter e g humus using the form of the adr equation in eq 2a the transport of so4 s and ca are written as follows with the equations for the other major ions mg na k co3 hco3 cl similar to the ca equation 3a c s o 4 s θ t r s o 4 s x i θ v i c s o 4 s x i θ d ij c s o 4 s x j q f c f s o 4 s f s o 4 s u s o 4 s ε r s s min r s s imm θ r f s o 4 s auto r f s o 4 s het ρ b c s o 4 s t 3b c ca θ t r ca x i θ v i c ca x i θ d ij c ca x j q f c f ca u ca ρ b c ca t ρ b c ca t the so4 s transport equation is unique from the others in that it includes mineralization immobilization due to s cycling as well as microbially mediated chemical reduction and autotrophic oxidation equations for s in the litter pool ls in the humus pool hs and in the manure pool ms also are included in the uzf rt3d model but not shown here see tavakoli kivi and bailey 2017 for the so4 s eq 3a f so4 s is the inorganic fertilizer application of s m f l b 3 t 1 u so4 s is the uptake rate m f l b 3 t 1 min and imm signify mineralization and immobilization respectively and auto and het represent autotrophic and heterotrophic chemical reduction respectively more detail of processes such as the influence of o2 and no3 on the fate and transport of so4 s nitrification and microbially mediated chemical reduction of o2 and no3 are summarized in bailey et al 2013a and bailey et al 2015 3 2 salinity equilibrium chemistry module for uzf rt3d the sec module predicts major ion solute chemistry in a variably saturated groundwater system the chemical system considered in the sec module is presented in table 3 and includes eight aqueous components ten complexed species five solid species and four exchange species these components are selected due to their presence in the majority of soil aquifer systems additional components can be included if needed for a particular study site the module includes the major physical chemical processes for salt ions precipitation dissolution of salt solids aqueous complexation and cation exchange as these processes are contained in numerous other water quality models only the basic procedure of implementation algorithms is discussed here with full equations provided in supplementary material 3 2 1 solution chemistry algorithm similar to other models such as phreeqc parkhust and appelo 2013 and minteqa2 allison and kevin 1991 paz garcia et al 2013 the concentration of ions at equilibrium is determined using the stoichiometric approach of solving both mass balance and mass action equations simultaneously the approach incorporates the newton raphson method for solving the non linear systems of equations the law of mass action determines the concentration of each ion with the concentration of reactants and products relates using an equilibrium constant k 4 a a b b c c d d 5 k c c d d a a b b where a b c and d represent reactants and a b c and d are constants and where parentheses denote solute activities every possible reaction for the component species listed in table 3 must be written in the form of eq 4 following standard procedure the activity coefficient is calculated using the ionic strength within either the debye huckle or davis equations described in supplementary material mass balance equations are written for each ion e g for so4 6 so 4 t so 4 2 caso 4 0 mgso 4 0 naso 4 kso 4 where t denotes the total concentration of the aqueous component and brackets indicate the molality of the species within the solution the total concentration of each species in the solution is the summation of free ions and the complexed forms of that ion salt ion mass is assumed to be subject to complexation cation exchange and precipitation dissolution complexation the presence of aqueous complexes increases the solubility of minerals since complexation lowers the activity of the free ion appelo and postma 2005 the ten considered complexed species are shown in table 3 based on the law of mass action the equilibrium constants are defined for the complexed species caso 4 0 and caco 3 0 as 7 k 1 ca 2 so 4 2 caso 4 0 8 k 2 ca 2 co 3 2 caco 3 0 the equilibrium constants for the remaining eight complexed species are defined in the supplementary material and values for all ten equilibrium constants are listed in table 4 cation exchange uzf rt3d bailey et al 2013a simulates sorption onto soil particles using the linear freundlich or langmuir sorption isotherms however the use of isotherms ignores the electrostatic effects of the charges cation exchange replace ability must be calculated considering electrostatic forces to determine the adsorbed ion to the soil particles and the released ion from particles to the solution with the order of replace ability determined by coulomb s law and found to be na k mg ca the gapon equation is used to simulate exchangeable amount see supplementary material and values of the associated selectivity coefficients are listed in table 5 precipitation dissolution this process accounts for the dissolution and precipitation of solid salt minerals such as caso4 the stoichiometric reaction for a salt solid ab s and the free ions a aq and b aq is 9 ab s a aq b aq if the solution is super saturated then the concentration of a aq and b aq will decrease as ab s precipitates out of solution on the other hand if the solution is under saturated the concentration of the species will increase as ab s dissolves into a aq and b aq salt solids included in the present sec module are caso4 caco3 mgco3 mgso4 and nacl since they are common in many groundwater environments see table 3 each mineral and accompanying reaction has a solubility product table 6 for the sec module solids are added to the system one at a time the solid with lower solubility precipitates first and the direction of each reaction precipitation or dissolution is determined comparing the solubility limits of each specific solid 3 2 2 verification of the sec module before applying the coupled model to the regional scale study section 4 the sec module was tested for accuracy by comparing model results with data presented by lucia et al 2015 in a study of c sequestration that used a new algorithm for determining the equilibrium solubility limits over newton s method the system considers a mixture of co3 ca and mg with 0 0362 0 0181 and 0 0362 molalities respectively which is representative of ion concentrations in most of the reservoirs in their study region with the ion concentrations suggesting the precipitation of ca or mg salts the result of this comparison is shown in table 7 with a maximum difference between the two models of 0 04 3 2 3 implementing the sec module in uzf rt3d the sec module is written in fortran for ease of linking with uzf rt3d and is divided into three sub modules one each for precipitation dissolution aqueous complexation and cation exchange with internal iteration criteria and an additional global criteria although most of these reactions are time dependent but fast it is assumed that the reactions have time enough to reach equilibrium aqueous reversible reactions have high kinetic rates which makes the mentioned assumption legitimate paz garcia et al 2013 the solution strategy and calculation steps are summarized in fig 2 first the concentration of each ion is provided to the precipitation dissolution sub module starting with the salt mineral that potentially precipitates first the precipitation dissolution sub module continues until the internal criteria is satisfied which is set to 0 01 for salt ion concentrations before and after precipitation dissolution reactions occur for all possible salt solids once the new equilibrium concentration has been determined by the precipitation dissolution sub module the complexation sub module is run and the concentration of free ions and complexed species is calculated the updated concentrations of the ions then are provided to the cation exchange sub module which updates the concentrations calculations within each sub module are repeated until the criterion for ionic strength is fulfilled the flow of data and calculations in the precipitation dissolution sub module are shown in fig 3 with the five solids considered successively to determine the direction of reaction precipitation or dissolution the saturation index qsp equal to the product of the ion pair concentrations is calculated if qsp is equal to ksp the solution is in equilibrium with respect to the solid and neither precipitation nor dissolution will take place if qsp is less than ksp the solution is under saturated with respect to the solid and dissolution will occur until qsp is equal to ksp if there is enough salt mineral mass available for saturation to be reached then only a portion of the salt mineral will be dissolved otherwise all of the present salt mineral will be dissolved if qsp is greater than ksp the solution is over saturated with respect to the solid and precipitation will occur until equilibrium has been reached the general governing equation eq 1 has two terms on the right hand side the first term includes the transport processes and the second term considers the reactions within the sec module because of the second term eq 1 is highly non linear hence coupling between the transport and chemical calculations of uzf rt3d and the sec module is performed using a sequential non iterative approach walsh et al 1984 yeh and tripathi 1989 barry et al 2000 schoups et al 2006 carrayrou et al 2004 in which the transport and chemical kinetic equations of uzf rt3d are followed by internal iterations for equilibrium chemical reactions the calculation steps of the coupled model with inputs from modflow nwt are shown in fig 4 for each time step uzf rt3d first solves for concentration of each solute at each finite difference grid cell according to advection dispersion source sink mixing solutes entering leaving the aquifer via groundwater sources sinks and kinetic reactions with the latter including the cycling of c n and s concentrations for each ion at each grid cell are then provided to the sec module with ion concentrations updated using the methods described in the previous section the fifth and sixth terms on the right hand side of eq 2a are equal to zero for the species that are not included in the sec module the updated concentrations are then provided for the start of the next time step with this coupling proceeding until the end of the simulation in this coupling the local equilibrium concept is adopted in which the duration of the selected time step is assumed long enough for all interactions between chemical constituents to reach equilibrium rubin 1983 javadi and al najjar 2007 al hamdan and reddy 2008 4 model application at the regional scale 4 1 study region lower arkansas river valley colorado usa the uzf rt3d sec model was applied to a 500 km2 stream aquifer system within the lower arkansas river valley larv in southeastern colorado fig 5 for more than 130 years the region has been one of the most productive agricultural areas in colorado crops include alfalfa melons corn beans sorghum wheat grass and vegetables the climate is semi arid with average monthly rainfall ranging from 0 7 cm during the period october march to 5 0 cm during the period april september irrigation is practiced from march to november with irrigation water diverted from the arkansas river via six irrigation canals or 575 pumping wells see fig 5 for locations from the alluvial aquifer due to the low rainfall in the region within the upstream study region there are eight tributary drainages and three surface storage reservoirs allocating water on the basis of prior appropriation water rights the region is impaired by high salinity in groundwater surface water and soil caused by the existence of salt minerals particularly gypsum caso4 waterlogging in the shallow subsurface konikow and person 1985 hukkinen 1993 goff et al 1998 morway and gates 2012 gates et al 2002 2016 and evaporative concentration fig 6 shows salt ion proportions from the analysis of 389 groundwater samples in the study region using a piper diagram piper 1944 illustrating the hydro geochemical facies of samples the samples were collected between 2006 and 2009 from the monitoring wells shown in fig 5 results indicate that the majority of the samples are type ca so4 due to the dominant presence of gypsum frequency histograms of ctds cso4 s and cca in groundwater samples are shown in fig 7 a c respectively comparing the spatio temporal average ctds in the groundwater 2732 mg l with the estimated maximum permissible ctds value for irrigation without crop yield reduction 700 mg l ayers and westcot 1985 indicates the severity of salinization in the region also the secondary epa drinking water standard for cso4 is 250 mg l much less than the observed average of 630 mg l for cso4 s in the study region previous studies have estimated average crop yield reduction of up to 7 in the region due to high salinity in the soil root zone gates et al 2002 morway and gates 2012 the groundwater flow patterns in the study region have been simulated by morway et al 2013 who used modflow with the uzf package for unsaturated zone flow niswonger et al 2006 the region is discretized into 250 m by 250 m grid cells horizontally and three layers vertically from ground surface to the shale bedrock average depth is 15 m the model accounts for infiltrated rainwater and irrigation water which result in deep percolation that recharges the unconfined aquifer seepage from irrigation canals and reservoirs along with occasional seepage from the arkansas river and its tributaries are other key components of subsurface influx groundwater pumping from wells upflux from the shallow water table et from cropped and naturally vegetated areas and discharge to the arkansas river and its tributaries are key components of subsurface discharge morway et al 2013 the model was run for the period 1999 2007 which was extended in a later study through 2009 bailey et al 2014 as example model input and output the calibrated cell by cell values of hydraulic conductivity m d are shown in fig 8 a and the cell by cell average depth to water table during the simulation period is shown in fig 8b the uzf rt3d sec model uses the flow patterns and sources sinks from the modflow model with the same areal discretization but with six vertical layers spanning the depth between the ground surface and the shale bedrock the top two layers are each 0 5 m in thickness to simulate solute chemistry and c n and s cycling in the root zone the third layer is 1 0 m and the thickness of the remaining three layers is divided evenly over the remaining depth to the shale bedrock shultz et al 2018 previously calibrated the uzf rt3d component of the model in the region for redox reactions involving o2 no3 and selenium and tavakoli kivi and bailey 2017 calibrated it for s cycling the model is run from january 1 2006 to october 31 2009 using daily time steps concentration of the major ions in both surface water irrigation and groundwater irrigation is accounted for for surface irrigation with water derived from adjacent irrigation canals the concentrations are specified using results from the analysis of canal water samples which were taken periodically in the river near the canal diversion during the simulation period see table s2 in supplementary material for concentration values for groundwater irrigation concentration values of the ions are simulated by uzf rt3d sec at the location of the well screen layer 4 of the model for areas where water from canals tributaries and the arkansas river seeps into the aquifer the salt ion concentrations in the surface water are estimated from field samples collected during the simulation period see table s2 in supplementary material for values crop parameters are provided for each crop type in the larv study region see fig 9 for spatial distribution of crop type in 2006 these parameters govern the management and growth of each crop and include the typical planting harvesting and plowing dates fertilizer application and uptake root growth and death and c n and c s ratios parameters for organic matter decomposition oxidation reduction reactions crop uptake and linear sorption also are provided for c n and s cycling and for the chemical reduction of o2 no3 and so4 in groundwater these values are the same as those used in the s cycling and so4 transport model of tavakoli kivi and bailey 2017 and are included in supplementary material tables s3 and s4 parameters used in the sec module are the same as those described in section 3 see tables 3 7 the initial spatial distribution of salt minerals caso4 and caco3 which is mapped to the individual grid cells is based on a soil survey performed by the usda s natural resources conservation service nrcs https websoilsurvey sc egov usda gov app websoilsurvey aspx data for caso4 and caco3 are expressed as a percent by weight with values up to 45 and 8 respectively for the minerals 4 2 model calibration and testing 4 2 1 comparing model results with field data estimation of model parameters in the coupled model involved analyzing solute concentrations and groundwater salt ion mass loadings during a spin up simulation and during the 2006 2008 calibration period with field data from 2008 to 2009 used as testing data the spin up simulation was included to achieve steady seasonal fluctuations of salt ion concentration in the aquifer and a steady fluctuation of groundwater salt ion mass loading to the arkansas river and was prepared by repeating the cropping and flow pattern for the year 2006 for 10 years using crop and chemical reaction parameters from bailey et al 2014 the comparison of model results with measured values during the calibration and testing periods was conducted in a manner advocated by konikow 2011 with the objective of reproducing major trends and spatio temporal statistics rather than time series of concentrations at point locations of measurement e g monitoring wells the scale of a model grid cell being 107 108 times larger than that of a measurement location within the cell with this objective model results were tested against observed spatio temporal averages of concentration for each salt ion with spatial averages occurring by irrigation command area fig 10 due to the unique water rights priority irrigation and cultivation histories of each command area results also are compared using the frequency distribution of concentration for each salt ion these comparisons are performed for each salt ion in the saturated zone of the aquifer for the soil root zone the frequency distribution of ctds is compared between the model and values derived from more than 54 000 electromagnetic induction measurements in relation to saturated paste soil electrical conductivity ece in many fields scattered across the study region morway and gates 2012 the estimated ece values ds m are converted to ctds mg l using a relationship that exists between ece and ctds in groundwater samples collected in the saturated zone gates et al 2016 for the model ctds for each grid cell in the top 2 layers of the model is computed by summing the simulated concentrations of the ions since the ece values were estimated using saturated paste extracts from field soil samples only model results from cells with a near saturation water content above 95 were included in the frequency distribution comparison in addition to using groundwater solute concentrations for model testing stochastic river mass balance calculations for the stream system gates et al 2018 were used to determine the approximate daily mass loadings of so4 and tds to the arkansas river that are not accounted for by measured loading from the tributaries it is assumed that a substantial portion of the unaccounted for mass loading especially during the non irrigation season can be attributed to mass loading from the aquifer to the arkansas river and thereby provides an additional test for model results 4 2 2 parameter estimation methodology estimation of parameters in the sec module was performed using a joint manual and automated calibration approach to achieve a satisfactory match between observed and simulated target variables target variables include spatially averaged cso4 s cca cmg cna ccl chno3 and ctds in the saturated zone spatially averaged ctds of soil water in the root zone the relative frequency distribution of all major salt ions in the saturated zone the relative frequency distribution of ctds in soil water in the root zone and groundwater mass loading of so4 and tds to the arkansas river a variant of the brier score bs brier 1950 which compares the relative frequency distribution of two sample sets and commonly is used to evaluate probability distribution performance is computed in this study for a relative frequency histogram of nb classes or bins as 10 bs 1 n b 1 n b f i o i 2 where fi is the relative frequency of simulated values in the i th bin and oi is the relative frequency of observed values in the i th bin the value of bs ranges between 0 and 1 providing a measure here of the average discrepancy between simulated and observed relative frequency with values of bs closer to 0 indicating a better match as part of the initial step of the calibration process the solid salt contents in the soil profile and in the aquifer were manually adjusted within the range of values reported in the nrcs soil survey data to yield simulated ctds values in the soil root zone and aquifer that were similar to the observed soil and aquifer data preliminary simulations also indicated that model results are strongly dependent on the solubility product ksp for each salt represented in the model which are governed by temperature and ph since the temperature in the root zone and in the deep layers of the aquifer differs seasonally a value of ksp was assigned to each of the saturated and unsaturated zones for each salt mineral once the salt distribution was determined the pest parameter estimation software doherty 2007 was used to refine the solubility products of each salt solid pest adjusts selected parameters in sequential simulation runs to minimize the objective function which is the sum of the squared weighted residuals between the observed and simulated values 11 φ i n v w i o v i m v i 2 where φ is the objective function nv is the number of target variables w i is the weight assigned to the ith target variable and o v i and m v i are the observed and simulated values of the ith target variable respectively the value of w i for each target variable is calculated as the product of an uncertainty weight and a unit discrepancy weight the uncertainty weight was calculated as the inverse of an estimated coefficient of variation cv reflective of the relative uncertainty in the observations of the target variable the unit discrepancy weight was determined by unifying the sum of the square of each observed variable value an iterative approach using both the spin up simulation and the 2006 2008 simulation was used in the model calibration procedure due to the dependence of initial concentrations in 2006 on the long term spin up simulation initial ksp values for the sec module were assigned from the literature table 6 the overall procedure is as follows a establish a preliminary set of initial conditions for the 2006 2008 simulation using a 30 year spin up simulation which included manual adjustment of solid salt contents in the soil and aquifer to achieve reasonable similarity between simulated and observed ctds values b use pest to provide an estimate of ksp values according to command area c re run the spin up simulation with the new set of ksp values to establish new initial conditions with comparisons made to estimated so4 and tds mass loading to the arkansas river the spin up simulation was re run using ksp values until the groundwater salinity mass loadings at the end of the spin up simulation matched well with the range of observed daily groundwater salinity mass loadings during the 2006 2008 period d a further adjustment was made comparing the model results to observed values within the test period by manually adjusting the ksp values to achieve the best match between simulated and observed salt ion concentrations in the saturated zone values of ksp were assigned to each canal command area for both the soil root zone and the saturated zone and were estimated using pest considering the target values parameter values resulting from the uzf rt3d sec calibration process are shown in table 8 all of which fall within the range of values reported in the literature 4 3 calibration and testing results fig 11 a e show the cell by cell computed cso4 s cca and ctds values in groundwater averaged over the 2006 2009 simulation period high levels of cso4 s and ctds occur principally in the rocky ford highline canal command area and in the holbrook canal command area see fig 10 typically areas of high cca coincide with areas of high cso4 s indicative of the presence of gypsum the areas of highest concentration often are far from the arkansas river indicating that mass loadings of tds to the river are lower than what could be expected if the plumes of high concentration groundwater move towards the river over the coming years fig 11 b d and f shows a spatial comparison between the simulated and observed cso4 s cca and ctds values in groundwater averaged over the 2006 2009 period the observed values for 2006 2009 period were averaged for each monitoring well and the kriging method was used to construct contour plots based upon observed values kriging uses statistical interpolation to estimate concentrations at locations between observed values while the calibrated modflow uzf and uzf rt3d sec models use the governing flow and reactive transport equations thus the methods are not directly comparable nevertheless model results demonstrate the capability of the model to reproduce overall observed spatial patterns of groundwater salinity in particular the zones of observed high salinity in the rocky ford highline and holbrook canal command areas have been captured by the model the comparison between the simulated and observed average values within each canal command area for cso4 s cca cmg and ctds in groundwater is shown in fig 12 for both the calibration and testing periods whiskers on the plotted observed values represent standard deviation of an assumed normal distribution with cv 0 43 estimated following the method described in bailey et al 2014 to account for uncertainty due to measurement error and scale discrepancy considering this uncertainty model results are favorable compared to the observed values interestingly simulated and observed values for cso4 s and ctds have a better match for the testing period than for the calibration period the spatio temporal average of simulated values of cso4 s within a grid cells in layer 4 over the entire region is 512 mg l for the calibration period and 510 mg l for the testing period compared with respective average observed values of 655 mg l and 509 mg l layer 4 is chosen as the target layer since the groundwater monitoring wells typically are screened at a depth corresponding to the elevation represented by layer 4 in the model for ctds average simulated values in layer 4 are 2822 mg l and 2845 mg l for the calibration and testing periods respectively while average observed values are 3003 mg l and 2813 mg l for the calibration and testing periods figs 13 and 14 show relative frequency histograms for simulated values of cso4 s cca cmg cna ccl and chco3 in groundwater in layer 4 and for observed values although the previous comparison was made between the average values over the command region these plots demonstrate the model s ability to reproduce the distributions of concentrations across the region and over the model calibration and testing periods eleven bins are used to create the relative frequency histograms up to a value of 20 000 mg l with a twelfth bin representing values above 20 000 mg l the values of bs for cso4 s cca and cmg in groundwater for the calibration period are 0 04 0 06 and 0 03 and for the testing period are 0 04 0 07 and 0 04 respectively indicating the model accurately replicates not only the averages of each concentration but also the frequency distributions of the observed data the bs values for cna ccl and chco3 for the calibration period are 0 12 0 01 and 0 14 respectively and for the testing period are 0 11 0 01 and 0 13 the bs value for simulated chco3 and cna reveals poorer model performance for these specific ions the main source of hco3 in groundwater is the dissolution of caco3 which is also a source of co3 the sec module currently does not fully accommodate the c cycle in a closed system instead the simple dissolution formula for caco3 in eq 34 is used millero 2001 as a result the model under predicts chco3 the main source of na is dissolution of nacl in the larv as shown in fig 6 most of the groundwater samples are ca so4 type thus under predicting chco3 and cna does not compromise the validity of this and similar applications in terms of total salinity transport and storage by including the full c cycle and considering the partial co2 pressure chco3 would be calculated as a secondary component in caco3 dissolution although not used in parameter estimation time series of measured and simulated values of cso4 s and cca are shown in fig 15 for three monitoring wells in the study region poor matches see well 204 for cca can result in these point by points comparisons in part due to the large discrepancy between the model grid scale and the observation scale nevertheless in general the model yields values of similar magnitude to the field data if desired cell by cell chemical reaction parameters could be calibrated albeit with great computational effort and at the risk of over fitting to yield better matches with point measurements however the purpose of the model is to reproduce general spatial and temporal trends and distributions fig 16 shows the simulated cell by cell values of ctds in the root zone top 1 m soil water averaged over the 2006 2009 simulation period high soil salinity 10 000 mg l occurs in many areas in the region principally in the fields irrigated by the catlin and rocky ford highline canals see fig 10 and along timpas creek and crooked arroyo and certain reaches of the arkansas river the severity of the problem in regards to potential impact on crop yield is apparent when compared to permissible limits of ctds to avoid yield reduction for alfalfa and corn the dominant crops in the larv assuming an average soil water content at 40 of saturation in irrigated fields over the region threshold ctds values of 4300 mg l and 5100 mg l can be estimated for corn and alfalfa respectively grieve et al 2012 gates et al 2016 the average value of ctds computed over the region and over the simulation period was 4993 mg l suggesting that a substantial area is suffering from crop yield reduction these results are comparable with the conclusions of morway and gates 2012 for this same region with 22 of locations surveyed exceeding the crop yield threshold also higher ctds values are expected in areas with shallow groundwater where more salt enters the root zone by upflux from saline groundwater morway and gates 2012 comparing the water table depth plot fig 8b with the location of high ctds in fig 16 complies with the same conclusion the average value of simulated ctds for cells with near saturated soil conditions see section 4 2 1 is 4034 mg l which matches favorably with the average observed ctds of 4180 mg l in soil saturated extract samples the relative frequency histograms of simulated and observed ctds values for near saturated soil conditions are shown in fig 17 the value of bs is 0 03 indicating that the model can be employed to satisfactorily estimate soil salinity over a regional scale allowing subsequent estimation of impacts on crop yields the simulated daily average so4 and tds mass loadings from groundwater to the arkansas river kg day are shown in fig 18 with a comparison to statistics of the stochastic river mass balance estimates of total unaccounted for mass loading the model predicted groundwater mass loading to the river typically is well within the stochastic mean minus one standard deviation and is below the stochastic mean this is to be expected since the stochastic mass balance results include loading from unaccounted for surface water returns to the river in addition to groundwater mass loading 5 summary and conclusions the uzf rt3d variably saturated multi species reactive transport model was amended to include equilibrium chemical reactions for application to salt affected agricultural groundwater systems the developed salinity equilibrium chemistry sec module includes precipitation dissolution aqueous complexation and cation exchange equilibrium reactions for the major cations and anions calcium magnesium sodium potassium sulfate chloride bicarbonate and carbonate the module is imbedded into the uzf rt3d modeling code to allow the fate and reactive transport of these ions to be simulated in both the unsaturated and saturated zones of an aquifer system the resulting uzf rt3d sec model also includes routines for simulation of the cycling of c n and s in the plant soil system with redox reactions and sorption included for dissolved oxygen ammonium nitrate and sulfate that is amenable to regional scale analysis of salinization calculation of groundwater solution temperature and ph non equilibrium reactions between the solid phase and the soil solution due to heterogeneities effects of chemical precipitation and dissolution on soil porosity impact of partial co2 pressure on the full c cycle and consideration of high ionic strength i 0 5 were not directly considered in the current analysis the potential effects of such processes should be examined in future model refinements the model is showcased in application to a 500 km2 irrigated groundwater system along the lower arkansas river alluvial aquifer system in southeastern colorado with model results tested against a large dataset of observed salt concentrations and estimates of groundwater salt ion mass loading to the river findings indicate that including the sec module results in simulated salt ion concentration values that approach the high concentrations observed in the study region addressing a deficiency noted by tavakoli kivi and bailey 2017 in their earlier modeling of sulfur and the sulfate ion in the arkansas river valley using uzf rt3d of key importance is the ability of the model to reasonably predict over a broad landscape not only groundwater salt concentrations but also soil salinity which can be used to determine impact on crop yield along with loadings to the river network which affect downstream irrigated areas the fully calibrated model now can be used to investigate best management practices for salt remediation in the colorado s lower arkansas river valley and shows potential for application to similar salt affected regions worldwide acknowledgments this study was made possible by the cooperative assistance of more than 120 landowners in colorado s lower arkansas river basin and by numerous water agencies major financial support was provided by grants from the us agency for international development through the us pakistan center for advanced studies in water 10035947 s1 the national integrated water quality program of the usda national institute of food and agriculture 2014 51130 22491 the colorado department of public health and environment po faa wqc1349262 the colorado agricultural experiment station col00684 the southeastern colorado water conservancy district the lower arkansas valley water conservancy district and the united states bureau of reclamation r09ap60007 the views and conclusions contained in this document are those of the authors and should not be interpreted as representing the opinions or policies of the government of colorado or the us government appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 02 040 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6590,a three dimensional coupled groundwater reactive transport and equilibrium chemistry model is presented that simulates the fate and transport of major salt ions in agricultural groundwater systems that span broad regions the uzf rt3d sec model amends the base model uzf rt3d by coupling it with a new salinity equilibrium chemistry sec module to simulate the movement and transformation of major salt ions calcium magnesium sodium potassium sulfate chloride bicarbonate and carbonate due to advection dispersion source sink mixing sulfur cycling redox reactions precipitation dissolution aqueous complexation and cation exchange the coupling procedure and the considered reactions make the model applicable for simulating regional scale agricultural aquifer systems with data efficiency and an acceptable processing time the model receives flow information from the modflow uzf flow model which simulates variably saturated groundwater flow in an efficient manner over regional scales for use in agricultural areas the model also accounts for crop uptake soil organic matter decomposition and mineralization immobilization of carbon nitrogen and sulfur species the model is applied to a salinity impaired regional scale 500 km2 agricultural area within the irrigated valley of the arkansas river in southeastern colorado it is calibrated and tested against salt ion groundwater concentrations measured in monitoring wells soil salinity measurements from throughout the region and total salt loads discharging from the aquifer to the stream network of the arkansas river results indicate that the model represents well the overall magnitude and spatiotemporal trends of soil salinity and groundwater salinity in the aquifer along with salt loading to streams and therefore can be used to investigate best management practices for salt remediation this along with findings indicating that the inclusion of equilibrium chemistry is vital for producing the correct magnitude of salt ion concentrations and mass loadings render a tool useful for regional investigation of other highly salinized aquifer systems keywords salinity groundwater reactive transport model equilibrium chemistry precipitation dissolution irrigation 1 introduction high salinity in groundwater and soils afflicts many areas of the world specifically arid and semi arid agricultural regions that rely on irrigation for sustaining crop yield reduction in crop yield is an important economic consequence of salt build up in the root zone in many regions of the world including iran jalali 2007 jamshidzadeh et al 2011 ebrahimi et al 2016 india singh 2005 jeevanandam et al 2007 misra et al 2007 lorenzen et al 2012 the western united states e g san joaquin valley in california schoups et al 2006 pakistan mahmood et al 2001 qureshi et al 2008 latif et al 2009 china pereira et al 2007 chen et al 2010 wang et al 2018 and australia herczeg et al 2001 tweed et al 2007 skrzypek et al 2013 high salinity can occur due to waterlogging from shallow groundwater with associated evaporative upflux morway and gates 2012 harrington and cook 2014 dissolution of salt minerals such as gypsum caso4 calcite caco3 and halite nacl harrington and cook 2014 farid et al 2015 and seawater intrusion in coastal areas shammas and jacks 2007 sherif et al 2011 blanco et al 2013 the impact of possible remediation practices on high groundwater and soil salinity often is assessed using models that attempt to capture the major hydrologic processes and chemical reactions that govern the transport of salt species in coupled soil aquifer systems these models also are used to provide insights into the nature of processes that govern salt species transport in these systems models are employed at a variety of spatial scales ranging from one dimensional 1d soil profiles to river basins and include varying degrees of complexity from simple advective transport to multi species reactive transport integrating equilibrium and kinetic chemistry as summarized in table 1 several models include many of the governing physical and chemical processes for salt fate and transport phreeqc is a 1d model developed to perform a variety of aqueous geochemical calculations in saturated media parkhust and appelo 1999 unsatchem šimůnek and suarez 1994 includes chemical reactions such as precipitation dissolution of salt minerals cation exchange and complexation to simulate spatio temporal concentration of major salt ions in soil water systems hydrus 1d šimůnek et al 2005 a finite element model for simulating the movement of water and multiple solutes in variably saturated porous media was amended to include the unsatchem module for major salt ion chemistry šimůnek et al 2012 multidimensional modeling capability of hydrus has been developed as well the hp1 model couples hydrus 1d with phreeqc to address a broader range of ions but is restricted to 1d transport jacques et al 2003 jacques and šimůnek 2005 the second and third versions of hpx were developed later to incorporate two dimensional 2d and three dimensional 3d modeling capability hydrogeochem is a numerical fluid flow model which iteratively solves 3d fluid flow and geochemical transport equations yeh et al 2004 for comparison traits of the uzf rt3d sec model presented here also are included in table 1 most notably uzf rt3d sec simulates all major salinity processes in a 3d variably saturated groundwater flow system due to the linkage with modflow the model can also simulate salt mass exchange between the aquifer and surface water features rivers streams lakes reservoirs etc other models besides those summarized in table 1 link geochemistry and multi species reactive transport in saturated or variably saturated porous media e g pht3d prommer et al 2003 vam2d huyakorn et al 1991 dynamix narasimhan et al 1986 phast parkhust et al 2004 leachm wagenet and hutson 1987 however they have not been applied to salt fate and transport and do not always include the necessary chemical reactions e g cation exchange or are limited to analysis of the saturated zone e g phast pht3d moreover these models typically are applied over small spatial scales e g soil profiles at experimental field plots goncalves et al 2006 forkutsa et al 2009 tafteh and sepaskhah 2012 rasouli et al 2013 due to high computational costs and extensive data requirements a second subset of salinity models are those whose application at a large spatial scale catchment to river basin have been reported such tools are useful for the evaluation of agro environmental health and economic vitality at a regional planning level however they may not include the chemical processes e g precipitation dissolution that often govern salt ion concentration in variably saturated groundwater systems or are computationally inefficient table 2 shows a list of salt transport modeling studies applied at the regional scale 102 103 km2 and selected features of the respective model used for each study the area of the study region and the modeled physical and chemical processes are included a hydro salinity model that couples modhms with unsatchem was used by schoups et al 2005 to simulate subsurface salt transport and storage in a 1400 km2 region of the san joaquin valley the coupling of the two models for 3d salinity reactive transport however is not explained in the paper and the modeling system does not account for element carbon nitrogen sulfur mass cycling in the plant soil system lin and garcia 2008 applied watsuit a steady state model that calculates soil water interaction in the root zone in colorado s lower arkansas river valley to determine the salinity of deep percolation water they modified watsuit to simulate dynamic conditions with a monthly time step and applied the model to simulate unsaturated flow for a 12 month period in the root zone of fields sahysmod oosterbaan 2005 is an integrated agro hydro salinity model amenable to the analysis of large agricultural areas but handles processes based exclusively on water and salt balances and does not account for chemical reactions sahysmod has been applied to simulate the water and salt behavior in the semi arid irrigated area of haryana state in india where waterlogging and salinization have impacted the region for more than 40 years singh and panda 2012 tuteja et al 2003 assessed the effect of land use changes on salt and water balance in the mandagery creek catchment of new south wales australia using catsalt a distributed water balance model linked with a salt transport module burkhalter and gates 2005 2006 developed and applied an mt3d model incorporating a one dimensional mass balance in the unsaturated zone to simulate weekly soil and aquifer salt concentration across an irrigated region of colorado s lower arkansas river valley the model assumed only advective transport not accounting for kinetic and equilibrium chemical reactions tavakoli kivi and bailey 2017 simulated the groundwater fate and transport of so4 in the same region but were not able to reproduce the correct magnitude of concentration in groundwater due to the neglect of equilibrium chemistry reactions e g precipitation dissolution of salt minerals in the modeling framework overall the chemical processes that often regulate salt species fate and transport such as precipitation dissolution complexation cation exchange first order degradation and redox reactions have not been represented in modeling applications at a large spatial scale nevertheless the degradation of aquifers and streams by the accumulation of salts as well as their remediation is brought about by practices and processes that interact from field to field over vast spatial extents models are needed that can adequately simulate these practices and processes to better understand salinization over regional landscapes and explore land and water management alternatives for mitigation moreover there is a need to demonstrate in a data rich environment the potential for such models to reasonably capture the major processes that determine the severity and distribution of salinity over a regional scale this study presents a finite difference numerical model that simulates the fate and transport of major salt ions in large scale variably saturated groundwater systems while accounting for major salt inputs equilibrium chemical reactions oxidation reduction reactions and the cycling of carbon c nitrogen n and sulfur s in the plant soil system the modeling framework consists of groundwater flow modeling by modflow and reactive transport modeling by uzf rt3d bailey et al 2013a coupled with a new salinity equilibrium chemistry sec module processes simulated by modflow include 1d flow in the unsaturated zone evapotranspiration et from crops and natural vegetation groundwater pumping canal seepage 3d groundwater flow in the saturated zone upflux through the vadose zone and water exchange with streams morway et al 2013 uzf rt3d bailey et al 2013a is a finite difference fortran code that simulates reactive transport of multiple interacting chemical species in variably saturated groundwater flow systems using flow and source sink output from the modflow model this paper presents uzf rt3d sec which allows the modeling framework to simulate the fate and transport of major salt ions calcium ca magnesium mg sodium na potassium k sulfate so4 chloride cl and bicarbonate hco3 in the aquifer system unique features of this framework include the new sec module which simulates chemical equilibrium reactions for salt ions such as precipitation dissolution of salt minerals e g gypsum caso4 in anticipation of model use in other regions worldwide the salinity module source code has been designed for ease of including additional salt minerals that may be present in other groundwater systems the use of modflow s uzf unsaturated zone flow package which assumes vertical homogeneity of the unsaturated zone and neglects the diffusive term in the richards equation thus demanding less computational effort and data support than models that solve the full richards equation hence providing a suitable tool for simulating variably saturated flow and transport at the regional scale to determine downward vertical flux the kinematic wave approximation is used with et extracted from water stored within the soil root zone as a sink term within the equation when a specified lower limit of readily available soil water is reached et is then supplied by upflux from the water table using a linear function of depth to the water table up to a specified maximum extinction depth morway et al 2013 harbaugh 2005 the use of c n and s cycling modules developed for uzf rt3d bailey et al 2013b tavakoli kivi and bailey 2017 n cycling can affect so4 concentration in soil and groundwater due to redox sensitivity and nitrate no3 can oxidize so4 from shale material which underlies many alluvial aquifers worldwide these modules also include organic matter decomposition and mineralization plant uptake sorption oxidation reduction and fertilizer loading 2 salinity fate and transport in an agricultural groundwater system the fate and transport of major salt ions in an irrigated agricultural region are depicted in fig 1 the cycling of c and n are included bailey et al 2013b due to their effect on s cycling and so4 chemical reduction and the release of so4 from pyrite fes2 in the presence of o2 and no3 these conditions are not present in all aquifer systems but pyrite is present in bedrock and outcropped marine shale in many regions worldwide cycling of s mass occurs as organic s is incorporated via plowing into soil organic matter composed of litter fast decomposing and humus slow decomposing then mineralized to so4 and then taken up by crop roots during the growing season s mass also can be added to the root zone via fertilizer so4 can be chemically reduced via a microbially mediated chemical reduction reaction frind et al 1990 inhibited by the presence of o2 and no3 due to the succession of terminal electron e acceptor processes furthermore so4 can be released from fes2 via autotrophic reduction of o2 and no3 frind et al 1990 postma et al 1991 pauwels et al 1998 so4 mass along with the mass of the other major anions cl co3 hco3 and cations mg ca na can be added to the subsurface via irrigation water and seeped surface water canal water stream water irrigation water can be derived either from surface water or from groundwater via pumping if salt minerals e g caso4 caco3 and nacl are present in the soil and aquifer sediments dissolution of the salt solids or precipitation out of the solution can occur resulting in an increase or decrease in salt ion concentration in the groundwater and soil water in addition complexation of the dissolved species and cation exchange reactions can occur once in the groundwater system the salt ions can be transported through the aquifer and to surface water discharge sites if concentrations exceed saturation limits then precipitation to salt solids can occur 3 model development the transport of m reactive species can be written in terms of concentrations c i as miller and benson 1983 steefel and lasaga 1994 šimůnek and suarez 1994 carrayrou et al 2004 ezzedine 2015 1 c i t l c i x t f j c 1 c m where l denotes the transport model such as advection and diffusion and fj represents the chemical sub models such as precipitation dissolution this section describes the uzf rt3d transport and chemical kinetics model followed by a description of the new sec module 3 1 salinity transport and chemical kinetics the base solute reactive transport model is uzf rt3d bailey et al 2013b which receives groundwater flow data from a modflow nwt niswonger et al 2011 model that employs the unsaturated zone flow uzf package niswonger et al 2006 and solves the following system of advection dispersion reaction adr equations for the dissolved phase species and the reaction equations for solid phase species in variably saturated groundwater systems using a finite difference approach bailey et al 2013a 2a c k θ t r k x i θ v i c k x i θ d ij c k x j q f c f k θ r f ρ b c k t ρ b c k t k 1 2 m 2b c l ε t α l p s ε r s l 1 2 n where ck and cl are the concentration of the k th dissolved phase solute m f l f 3 and l th solid phase species m s l s 3 respectively with f denoting the fluid phase d ij is the hydrodynamic dispersion coefficient l 2 t 1 v is the pore velocity l b t 1 with b denoting the bulk phase θ is the volumetric water content l f 3 l b 3 q f is the volumetric flux of water representing sources and sinks l f 3 t 1 l b 3 such as irrigation water canal and seepage groundwater discharge to the river or pumped groundwater c f is the concentration of solute in the source or sink water m f l f 3 r f represents the rate of the reactions that occur in the dissolved phase m f l f 3 t 1 r j is the retardation factor for species j and is equal to 1 ρ b k d j θ where ρ b is the bulk density of the porous media m b l b 3 and k d j is the partitioning coefficient for the jth species l f 3 m b c k is the total solid phase concentration of aqueous species k which considers precipitation dissolution mm 1 c k is the total exchanged phase concentration of aqueous species k mm 1 ps is the application rate of after harvest stover mass kg ha 1 α l is the portion of the stover mass attributed to the solute ε is the volumetric solid content l s 3 l b 3 and is equal to 1 ϕ with ϕ representing porosity and rs is the reaction rate with s denoting the solid phase uzf rt3d uses output from a modflow nwt niswonger et al 2011 that uses the uzf package niwsonger et al 2006 for v and qf eq 2b represents change in soil organic matter e g humus using the form of the adr equation in eq 2a the transport of so4 s and ca are written as follows with the equations for the other major ions mg na k co3 hco3 cl similar to the ca equation 3a c s o 4 s θ t r s o 4 s x i θ v i c s o 4 s x i θ d ij c s o 4 s x j q f c f s o 4 s f s o 4 s u s o 4 s ε r s s min r s s imm θ r f s o 4 s auto r f s o 4 s het ρ b c s o 4 s t 3b c ca θ t r ca x i θ v i c ca x i θ d ij c ca x j q f c f ca u ca ρ b c ca t ρ b c ca t the so4 s transport equation is unique from the others in that it includes mineralization immobilization due to s cycling as well as microbially mediated chemical reduction and autotrophic oxidation equations for s in the litter pool ls in the humus pool hs and in the manure pool ms also are included in the uzf rt3d model but not shown here see tavakoli kivi and bailey 2017 for the so4 s eq 3a f so4 s is the inorganic fertilizer application of s m f l b 3 t 1 u so4 s is the uptake rate m f l b 3 t 1 min and imm signify mineralization and immobilization respectively and auto and het represent autotrophic and heterotrophic chemical reduction respectively more detail of processes such as the influence of o2 and no3 on the fate and transport of so4 s nitrification and microbially mediated chemical reduction of o2 and no3 are summarized in bailey et al 2013a and bailey et al 2015 3 2 salinity equilibrium chemistry module for uzf rt3d the sec module predicts major ion solute chemistry in a variably saturated groundwater system the chemical system considered in the sec module is presented in table 3 and includes eight aqueous components ten complexed species five solid species and four exchange species these components are selected due to their presence in the majority of soil aquifer systems additional components can be included if needed for a particular study site the module includes the major physical chemical processes for salt ions precipitation dissolution of salt solids aqueous complexation and cation exchange as these processes are contained in numerous other water quality models only the basic procedure of implementation algorithms is discussed here with full equations provided in supplementary material 3 2 1 solution chemistry algorithm similar to other models such as phreeqc parkhust and appelo 2013 and minteqa2 allison and kevin 1991 paz garcia et al 2013 the concentration of ions at equilibrium is determined using the stoichiometric approach of solving both mass balance and mass action equations simultaneously the approach incorporates the newton raphson method for solving the non linear systems of equations the law of mass action determines the concentration of each ion with the concentration of reactants and products relates using an equilibrium constant k 4 a a b b c c d d 5 k c c d d a a b b where a b c and d represent reactants and a b c and d are constants and where parentheses denote solute activities every possible reaction for the component species listed in table 3 must be written in the form of eq 4 following standard procedure the activity coefficient is calculated using the ionic strength within either the debye huckle or davis equations described in supplementary material mass balance equations are written for each ion e g for so4 6 so 4 t so 4 2 caso 4 0 mgso 4 0 naso 4 kso 4 where t denotes the total concentration of the aqueous component and brackets indicate the molality of the species within the solution the total concentration of each species in the solution is the summation of free ions and the complexed forms of that ion salt ion mass is assumed to be subject to complexation cation exchange and precipitation dissolution complexation the presence of aqueous complexes increases the solubility of minerals since complexation lowers the activity of the free ion appelo and postma 2005 the ten considered complexed species are shown in table 3 based on the law of mass action the equilibrium constants are defined for the complexed species caso 4 0 and caco 3 0 as 7 k 1 ca 2 so 4 2 caso 4 0 8 k 2 ca 2 co 3 2 caco 3 0 the equilibrium constants for the remaining eight complexed species are defined in the supplementary material and values for all ten equilibrium constants are listed in table 4 cation exchange uzf rt3d bailey et al 2013a simulates sorption onto soil particles using the linear freundlich or langmuir sorption isotherms however the use of isotherms ignores the electrostatic effects of the charges cation exchange replace ability must be calculated considering electrostatic forces to determine the adsorbed ion to the soil particles and the released ion from particles to the solution with the order of replace ability determined by coulomb s law and found to be na k mg ca the gapon equation is used to simulate exchangeable amount see supplementary material and values of the associated selectivity coefficients are listed in table 5 precipitation dissolution this process accounts for the dissolution and precipitation of solid salt minerals such as caso4 the stoichiometric reaction for a salt solid ab s and the free ions a aq and b aq is 9 ab s a aq b aq if the solution is super saturated then the concentration of a aq and b aq will decrease as ab s precipitates out of solution on the other hand if the solution is under saturated the concentration of the species will increase as ab s dissolves into a aq and b aq salt solids included in the present sec module are caso4 caco3 mgco3 mgso4 and nacl since they are common in many groundwater environments see table 3 each mineral and accompanying reaction has a solubility product table 6 for the sec module solids are added to the system one at a time the solid with lower solubility precipitates first and the direction of each reaction precipitation or dissolution is determined comparing the solubility limits of each specific solid 3 2 2 verification of the sec module before applying the coupled model to the regional scale study section 4 the sec module was tested for accuracy by comparing model results with data presented by lucia et al 2015 in a study of c sequestration that used a new algorithm for determining the equilibrium solubility limits over newton s method the system considers a mixture of co3 ca and mg with 0 0362 0 0181 and 0 0362 molalities respectively which is representative of ion concentrations in most of the reservoirs in their study region with the ion concentrations suggesting the precipitation of ca or mg salts the result of this comparison is shown in table 7 with a maximum difference between the two models of 0 04 3 2 3 implementing the sec module in uzf rt3d the sec module is written in fortran for ease of linking with uzf rt3d and is divided into three sub modules one each for precipitation dissolution aqueous complexation and cation exchange with internal iteration criteria and an additional global criteria although most of these reactions are time dependent but fast it is assumed that the reactions have time enough to reach equilibrium aqueous reversible reactions have high kinetic rates which makes the mentioned assumption legitimate paz garcia et al 2013 the solution strategy and calculation steps are summarized in fig 2 first the concentration of each ion is provided to the precipitation dissolution sub module starting with the salt mineral that potentially precipitates first the precipitation dissolution sub module continues until the internal criteria is satisfied which is set to 0 01 for salt ion concentrations before and after precipitation dissolution reactions occur for all possible salt solids once the new equilibrium concentration has been determined by the precipitation dissolution sub module the complexation sub module is run and the concentration of free ions and complexed species is calculated the updated concentrations of the ions then are provided to the cation exchange sub module which updates the concentrations calculations within each sub module are repeated until the criterion for ionic strength is fulfilled the flow of data and calculations in the precipitation dissolution sub module are shown in fig 3 with the five solids considered successively to determine the direction of reaction precipitation or dissolution the saturation index qsp equal to the product of the ion pair concentrations is calculated if qsp is equal to ksp the solution is in equilibrium with respect to the solid and neither precipitation nor dissolution will take place if qsp is less than ksp the solution is under saturated with respect to the solid and dissolution will occur until qsp is equal to ksp if there is enough salt mineral mass available for saturation to be reached then only a portion of the salt mineral will be dissolved otherwise all of the present salt mineral will be dissolved if qsp is greater than ksp the solution is over saturated with respect to the solid and precipitation will occur until equilibrium has been reached the general governing equation eq 1 has two terms on the right hand side the first term includes the transport processes and the second term considers the reactions within the sec module because of the second term eq 1 is highly non linear hence coupling between the transport and chemical calculations of uzf rt3d and the sec module is performed using a sequential non iterative approach walsh et al 1984 yeh and tripathi 1989 barry et al 2000 schoups et al 2006 carrayrou et al 2004 in which the transport and chemical kinetic equations of uzf rt3d are followed by internal iterations for equilibrium chemical reactions the calculation steps of the coupled model with inputs from modflow nwt are shown in fig 4 for each time step uzf rt3d first solves for concentration of each solute at each finite difference grid cell according to advection dispersion source sink mixing solutes entering leaving the aquifer via groundwater sources sinks and kinetic reactions with the latter including the cycling of c n and s concentrations for each ion at each grid cell are then provided to the sec module with ion concentrations updated using the methods described in the previous section the fifth and sixth terms on the right hand side of eq 2a are equal to zero for the species that are not included in the sec module the updated concentrations are then provided for the start of the next time step with this coupling proceeding until the end of the simulation in this coupling the local equilibrium concept is adopted in which the duration of the selected time step is assumed long enough for all interactions between chemical constituents to reach equilibrium rubin 1983 javadi and al najjar 2007 al hamdan and reddy 2008 4 model application at the regional scale 4 1 study region lower arkansas river valley colorado usa the uzf rt3d sec model was applied to a 500 km2 stream aquifer system within the lower arkansas river valley larv in southeastern colorado fig 5 for more than 130 years the region has been one of the most productive agricultural areas in colorado crops include alfalfa melons corn beans sorghum wheat grass and vegetables the climate is semi arid with average monthly rainfall ranging from 0 7 cm during the period october march to 5 0 cm during the period april september irrigation is practiced from march to november with irrigation water diverted from the arkansas river via six irrigation canals or 575 pumping wells see fig 5 for locations from the alluvial aquifer due to the low rainfall in the region within the upstream study region there are eight tributary drainages and three surface storage reservoirs allocating water on the basis of prior appropriation water rights the region is impaired by high salinity in groundwater surface water and soil caused by the existence of salt minerals particularly gypsum caso4 waterlogging in the shallow subsurface konikow and person 1985 hukkinen 1993 goff et al 1998 morway and gates 2012 gates et al 2002 2016 and evaporative concentration fig 6 shows salt ion proportions from the analysis of 389 groundwater samples in the study region using a piper diagram piper 1944 illustrating the hydro geochemical facies of samples the samples were collected between 2006 and 2009 from the monitoring wells shown in fig 5 results indicate that the majority of the samples are type ca so4 due to the dominant presence of gypsum frequency histograms of ctds cso4 s and cca in groundwater samples are shown in fig 7 a c respectively comparing the spatio temporal average ctds in the groundwater 2732 mg l with the estimated maximum permissible ctds value for irrigation without crop yield reduction 700 mg l ayers and westcot 1985 indicates the severity of salinization in the region also the secondary epa drinking water standard for cso4 is 250 mg l much less than the observed average of 630 mg l for cso4 s in the study region previous studies have estimated average crop yield reduction of up to 7 in the region due to high salinity in the soil root zone gates et al 2002 morway and gates 2012 the groundwater flow patterns in the study region have been simulated by morway et al 2013 who used modflow with the uzf package for unsaturated zone flow niswonger et al 2006 the region is discretized into 250 m by 250 m grid cells horizontally and three layers vertically from ground surface to the shale bedrock average depth is 15 m the model accounts for infiltrated rainwater and irrigation water which result in deep percolation that recharges the unconfined aquifer seepage from irrigation canals and reservoirs along with occasional seepage from the arkansas river and its tributaries are other key components of subsurface influx groundwater pumping from wells upflux from the shallow water table et from cropped and naturally vegetated areas and discharge to the arkansas river and its tributaries are key components of subsurface discharge morway et al 2013 the model was run for the period 1999 2007 which was extended in a later study through 2009 bailey et al 2014 as example model input and output the calibrated cell by cell values of hydraulic conductivity m d are shown in fig 8 a and the cell by cell average depth to water table during the simulation period is shown in fig 8b the uzf rt3d sec model uses the flow patterns and sources sinks from the modflow model with the same areal discretization but with six vertical layers spanning the depth between the ground surface and the shale bedrock the top two layers are each 0 5 m in thickness to simulate solute chemistry and c n and s cycling in the root zone the third layer is 1 0 m and the thickness of the remaining three layers is divided evenly over the remaining depth to the shale bedrock shultz et al 2018 previously calibrated the uzf rt3d component of the model in the region for redox reactions involving o2 no3 and selenium and tavakoli kivi and bailey 2017 calibrated it for s cycling the model is run from january 1 2006 to october 31 2009 using daily time steps concentration of the major ions in both surface water irrigation and groundwater irrigation is accounted for for surface irrigation with water derived from adjacent irrigation canals the concentrations are specified using results from the analysis of canal water samples which were taken periodically in the river near the canal diversion during the simulation period see table s2 in supplementary material for concentration values for groundwater irrigation concentration values of the ions are simulated by uzf rt3d sec at the location of the well screen layer 4 of the model for areas where water from canals tributaries and the arkansas river seeps into the aquifer the salt ion concentrations in the surface water are estimated from field samples collected during the simulation period see table s2 in supplementary material for values crop parameters are provided for each crop type in the larv study region see fig 9 for spatial distribution of crop type in 2006 these parameters govern the management and growth of each crop and include the typical planting harvesting and plowing dates fertilizer application and uptake root growth and death and c n and c s ratios parameters for organic matter decomposition oxidation reduction reactions crop uptake and linear sorption also are provided for c n and s cycling and for the chemical reduction of o2 no3 and so4 in groundwater these values are the same as those used in the s cycling and so4 transport model of tavakoli kivi and bailey 2017 and are included in supplementary material tables s3 and s4 parameters used in the sec module are the same as those described in section 3 see tables 3 7 the initial spatial distribution of salt minerals caso4 and caco3 which is mapped to the individual grid cells is based on a soil survey performed by the usda s natural resources conservation service nrcs https websoilsurvey sc egov usda gov app websoilsurvey aspx data for caso4 and caco3 are expressed as a percent by weight with values up to 45 and 8 respectively for the minerals 4 2 model calibration and testing 4 2 1 comparing model results with field data estimation of model parameters in the coupled model involved analyzing solute concentrations and groundwater salt ion mass loadings during a spin up simulation and during the 2006 2008 calibration period with field data from 2008 to 2009 used as testing data the spin up simulation was included to achieve steady seasonal fluctuations of salt ion concentration in the aquifer and a steady fluctuation of groundwater salt ion mass loading to the arkansas river and was prepared by repeating the cropping and flow pattern for the year 2006 for 10 years using crop and chemical reaction parameters from bailey et al 2014 the comparison of model results with measured values during the calibration and testing periods was conducted in a manner advocated by konikow 2011 with the objective of reproducing major trends and spatio temporal statistics rather than time series of concentrations at point locations of measurement e g monitoring wells the scale of a model grid cell being 107 108 times larger than that of a measurement location within the cell with this objective model results were tested against observed spatio temporal averages of concentration for each salt ion with spatial averages occurring by irrigation command area fig 10 due to the unique water rights priority irrigation and cultivation histories of each command area results also are compared using the frequency distribution of concentration for each salt ion these comparisons are performed for each salt ion in the saturated zone of the aquifer for the soil root zone the frequency distribution of ctds is compared between the model and values derived from more than 54 000 electromagnetic induction measurements in relation to saturated paste soil electrical conductivity ece in many fields scattered across the study region morway and gates 2012 the estimated ece values ds m are converted to ctds mg l using a relationship that exists between ece and ctds in groundwater samples collected in the saturated zone gates et al 2016 for the model ctds for each grid cell in the top 2 layers of the model is computed by summing the simulated concentrations of the ions since the ece values were estimated using saturated paste extracts from field soil samples only model results from cells with a near saturation water content above 95 were included in the frequency distribution comparison in addition to using groundwater solute concentrations for model testing stochastic river mass balance calculations for the stream system gates et al 2018 were used to determine the approximate daily mass loadings of so4 and tds to the arkansas river that are not accounted for by measured loading from the tributaries it is assumed that a substantial portion of the unaccounted for mass loading especially during the non irrigation season can be attributed to mass loading from the aquifer to the arkansas river and thereby provides an additional test for model results 4 2 2 parameter estimation methodology estimation of parameters in the sec module was performed using a joint manual and automated calibration approach to achieve a satisfactory match between observed and simulated target variables target variables include spatially averaged cso4 s cca cmg cna ccl chno3 and ctds in the saturated zone spatially averaged ctds of soil water in the root zone the relative frequency distribution of all major salt ions in the saturated zone the relative frequency distribution of ctds in soil water in the root zone and groundwater mass loading of so4 and tds to the arkansas river a variant of the brier score bs brier 1950 which compares the relative frequency distribution of two sample sets and commonly is used to evaluate probability distribution performance is computed in this study for a relative frequency histogram of nb classes or bins as 10 bs 1 n b 1 n b f i o i 2 where fi is the relative frequency of simulated values in the i th bin and oi is the relative frequency of observed values in the i th bin the value of bs ranges between 0 and 1 providing a measure here of the average discrepancy between simulated and observed relative frequency with values of bs closer to 0 indicating a better match as part of the initial step of the calibration process the solid salt contents in the soil profile and in the aquifer were manually adjusted within the range of values reported in the nrcs soil survey data to yield simulated ctds values in the soil root zone and aquifer that were similar to the observed soil and aquifer data preliminary simulations also indicated that model results are strongly dependent on the solubility product ksp for each salt represented in the model which are governed by temperature and ph since the temperature in the root zone and in the deep layers of the aquifer differs seasonally a value of ksp was assigned to each of the saturated and unsaturated zones for each salt mineral once the salt distribution was determined the pest parameter estimation software doherty 2007 was used to refine the solubility products of each salt solid pest adjusts selected parameters in sequential simulation runs to minimize the objective function which is the sum of the squared weighted residuals between the observed and simulated values 11 φ i n v w i o v i m v i 2 where φ is the objective function nv is the number of target variables w i is the weight assigned to the ith target variable and o v i and m v i are the observed and simulated values of the ith target variable respectively the value of w i for each target variable is calculated as the product of an uncertainty weight and a unit discrepancy weight the uncertainty weight was calculated as the inverse of an estimated coefficient of variation cv reflective of the relative uncertainty in the observations of the target variable the unit discrepancy weight was determined by unifying the sum of the square of each observed variable value an iterative approach using both the spin up simulation and the 2006 2008 simulation was used in the model calibration procedure due to the dependence of initial concentrations in 2006 on the long term spin up simulation initial ksp values for the sec module were assigned from the literature table 6 the overall procedure is as follows a establish a preliminary set of initial conditions for the 2006 2008 simulation using a 30 year spin up simulation which included manual adjustment of solid salt contents in the soil and aquifer to achieve reasonable similarity between simulated and observed ctds values b use pest to provide an estimate of ksp values according to command area c re run the spin up simulation with the new set of ksp values to establish new initial conditions with comparisons made to estimated so4 and tds mass loading to the arkansas river the spin up simulation was re run using ksp values until the groundwater salinity mass loadings at the end of the spin up simulation matched well with the range of observed daily groundwater salinity mass loadings during the 2006 2008 period d a further adjustment was made comparing the model results to observed values within the test period by manually adjusting the ksp values to achieve the best match between simulated and observed salt ion concentrations in the saturated zone values of ksp were assigned to each canal command area for both the soil root zone and the saturated zone and were estimated using pest considering the target values parameter values resulting from the uzf rt3d sec calibration process are shown in table 8 all of which fall within the range of values reported in the literature 4 3 calibration and testing results fig 11 a e show the cell by cell computed cso4 s cca and ctds values in groundwater averaged over the 2006 2009 simulation period high levels of cso4 s and ctds occur principally in the rocky ford highline canal command area and in the holbrook canal command area see fig 10 typically areas of high cca coincide with areas of high cso4 s indicative of the presence of gypsum the areas of highest concentration often are far from the arkansas river indicating that mass loadings of tds to the river are lower than what could be expected if the plumes of high concentration groundwater move towards the river over the coming years fig 11 b d and f shows a spatial comparison between the simulated and observed cso4 s cca and ctds values in groundwater averaged over the 2006 2009 period the observed values for 2006 2009 period were averaged for each monitoring well and the kriging method was used to construct contour plots based upon observed values kriging uses statistical interpolation to estimate concentrations at locations between observed values while the calibrated modflow uzf and uzf rt3d sec models use the governing flow and reactive transport equations thus the methods are not directly comparable nevertheless model results demonstrate the capability of the model to reproduce overall observed spatial patterns of groundwater salinity in particular the zones of observed high salinity in the rocky ford highline and holbrook canal command areas have been captured by the model the comparison between the simulated and observed average values within each canal command area for cso4 s cca cmg and ctds in groundwater is shown in fig 12 for both the calibration and testing periods whiskers on the plotted observed values represent standard deviation of an assumed normal distribution with cv 0 43 estimated following the method described in bailey et al 2014 to account for uncertainty due to measurement error and scale discrepancy considering this uncertainty model results are favorable compared to the observed values interestingly simulated and observed values for cso4 s and ctds have a better match for the testing period than for the calibration period the spatio temporal average of simulated values of cso4 s within a grid cells in layer 4 over the entire region is 512 mg l for the calibration period and 510 mg l for the testing period compared with respective average observed values of 655 mg l and 509 mg l layer 4 is chosen as the target layer since the groundwater monitoring wells typically are screened at a depth corresponding to the elevation represented by layer 4 in the model for ctds average simulated values in layer 4 are 2822 mg l and 2845 mg l for the calibration and testing periods respectively while average observed values are 3003 mg l and 2813 mg l for the calibration and testing periods figs 13 and 14 show relative frequency histograms for simulated values of cso4 s cca cmg cna ccl and chco3 in groundwater in layer 4 and for observed values although the previous comparison was made between the average values over the command region these plots demonstrate the model s ability to reproduce the distributions of concentrations across the region and over the model calibration and testing periods eleven bins are used to create the relative frequency histograms up to a value of 20 000 mg l with a twelfth bin representing values above 20 000 mg l the values of bs for cso4 s cca and cmg in groundwater for the calibration period are 0 04 0 06 and 0 03 and for the testing period are 0 04 0 07 and 0 04 respectively indicating the model accurately replicates not only the averages of each concentration but also the frequency distributions of the observed data the bs values for cna ccl and chco3 for the calibration period are 0 12 0 01 and 0 14 respectively and for the testing period are 0 11 0 01 and 0 13 the bs value for simulated chco3 and cna reveals poorer model performance for these specific ions the main source of hco3 in groundwater is the dissolution of caco3 which is also a source of co3 the sec module currently does not fully accommodate the c cycle in a closed system instead the simple dissolution formula for caco3 in eq 34 is used millero 2001 as a result the model under predicts chco3 the main source of na is dissolution of nacl in the larv as shown in fig 6 most of the groundwater samples are ca so4 type thus under predicting chco3 and cna does not compromise the validity of this and similar applications in terms of total salinity transport and storage by including the full c cycle and considering the partial co2 pressure chco3 would be calculated as a secondary component in caco3 dissolution although not used in parameter estimation time series of measured and simulated values of cso4 s and cca are shown in fig 15 for three monitoring wells in the study region poor matches see well 204 for cca can result in these point by points comparisons in part due to the large discrepancy between the model grid scale and the observation scale nevertheless in general the model yields values of similar magnitude to the field data if desired cell by cell chemical reaction parameters could be calibrated albeit with great computational effort and at the risk of over fitting to yield better matches with point measurements however the purpose of the model is to reproduce general spatial and temporal trends and distributions fig 16 shows the simulated cell by cell values of ctds in the root zone top 1 m soil water averaged over the 2006 2009 simulation period high soil salinity 10 000 mg l occurs in many areas in the region principally in the fields irrigated by the catlin and rocky ford highline canals see fig 10 and along timpas creek and crooked arroyo and certain reaches of the arkansas river the severity of the problem in regards to potential impact on crop yield is apparent when compared to permissible limits of ctds to avoid yield reduction for alfalfa and corn the dominant crops in the larv assuming an average soil water content at 40 of saturation in irrigated fields over the region threshold ctds values of 4300 mg l and 5100 mg l can be estimated for corn and alfalfa respectively grieve et al 2012 gates et al 2016 the average value of ctds computed over the region and over the simulation period was 4993 mg l suggesting that a substantial area is suffering from crop yield reduction these results are comparable with the conclusions of morway and gates 2012 for this same region with 22 of locations surveyed exceeding the crop yield threshold also higher ctds values are expected in areas with shallow groundwater where more salt enters the root zone by upflux from saline groundwater morway and gates 2012 comparing the water table depth plot fig 8b with the location of high ctds in fig 16 complies with the same conclusion the average value of simulated ctds for cells with near saturated soil conditions see section 4 2 1 is 4034 mg l which matches favorably with the average observed ctds of 4180 mg l in soil saturated extract samples the relative frequency histograms of simulated and observed ctds values for near saturated soil conditions are shown in fig 17 the value of bs is 0 03 indicating that the model can be employed to satisfactorily estimate soil salinity over a regional scale allowing subsequent estimation of impacts on crop yields the simulated daily average so4 and tds mass loadings from groundwater to the arkansas river kg day are shown in fig 18 with a comparison to statistics of the stochastic river mass balance estimates of total unaccounted for mass loading the model predicted groundwater mass loading to the river typically is well within the stochastic mean minus one standard deviation and is below the stochastic mean this is to be expected since the stochastic mass balance results include loading from unaccounted for surface water returns to the river in addition to groundwater mass loading 5 summary and conclusions the uzf rt3d variably saturated multi species reactive transport model was amended to include equilibrium chemical reactions for application to salt affected agricultural groundwater systems the developed salinity equilibrium chemistry sec module includes precipitation dissolution aqueous complexation and cation exchange equilibrium reactions for the major cations and anions calcium magnesium sodium potassium sulfate chloride bicarbonate and carbonate the module is imbedded into the uzf rt3d modeling code to allow the fate and reactive transport of these ions to be simulated in both the unsaturated and saturated zones of an aquifer system the resulting uzf rt3d sec model also includes routines for simulation of the cycling of c n and s in the plant soil system with redox reactions and sorption included for dissolved oxygen ammonium nitrate and sulfate that is amenable to regional scale analysis of salinization calculation of groundwater solution temperature and ph non equilibrium reactions between the solid phase and the soil solution due to heterogeneities effects of chemical precipitation and dissolution on soil porosity impact of partial co2 pressure on the full c cycle and consideration of high ionic strength i 0 5 were not directly considered in the current analysis the potential effects of such processes should be examined in future model refinements the model is showcased in application to a 500 km2 irrigated groundwater system along the lower arkansas river alluvial aquifer system in southeastern colorado with model results tested against a large dataset of observed salt concentrations and estimates of groundwater salt ion mass loading to the river findings indicate that including the sec module results in simulated salt ion concentration values that approach the high concentrations observed in the study region addressing a deficiency noted by tavakoli kivi and bailey 2017 in their earlier modeling of sulfur and the sulfate ion in the arkansas river valley using uzf rt3d of key importance is the ability of the model to reasonably predict over a broad landscape not only groundwater salt concentrations but also soil salinity which can be used to determine impact on crop yield along with loadings to the river network which affect downstream irrigated areas the fully calibrated model now can be used to investigate best management practices for salt remediation in the colorado s lower arkansas river valley and shows potential for application to similar salt affected regions worldwide acknowledgments this study was made possible by the cooperative assistance of more than 120 landowners in colorado s lower arkansas river basin and by numerous water agencies major financial support was provided by grants from the us agency for international development through the us pakistan center for advanced studies in water 10035947 s1 the national integrated water quality program of the usda national institute of food and agriculture 2014 51130 22491 the colorado department of public health and environment po faa wqc1349262 the colorado agricultural experiment station col00684 the southeastern colorado water conservancy district the lower arkansas valley water conservancy district and the united states bureau of reclamation r09ap60007 the views and conclusions contained in this document are those of the authors and should not be interpreted as representing the opinions or policies of the government of colorado or the us government appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 02 040 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6591,drought is a recurring natural hazard that significantly affects the economy and environment of large areas worldwide it is therefore imperative to develop techniques that enable comprehensive monitoring and assessment of drought here we propose a novel drought index combined climatologic deviation index ccdi that encompasses all the aspects of meteorologic agricultural hydrologic and human induced drought occurrences critical to the proposed framework is the concept of combining deviations in precipitation and terrestrial water storage observed by gravity recovery and climate experiment grace satellites from climatologic normal conditions as a measure of drought in order to evaluate the applicability of this new index it is analyzed over four major river basins in india i e ganga krishna godavari and mahanadi the propounded drought index ccdi has demonstrated its ability to identify drought events and render rational quantification of its severity results also depict an improved understanding of holistic drought conditions compared to other available drought indices comparison of ccdi with commonly used drought indices highlighted some of the fundamental differences while demonstrating good correspondence with pdsi r 0 79 and grace dsi r 0 94 further it is evident that in almost all the river basins there have been at least two drought periods with intensities ranging from d1 moderate drought to d4 exceptional drought the longest drought period extending for 36 months from july 2002 to june 2005 is observed in the krishna basin results from this study show appreciable reliance on the potential for quantifying droughts using ccdi which will only improve with better quantification and extended availability of terrestrial water storage observations from the recently launched grace follow on mission keywords drought river basins grace combined climatologic deviation index ccdi trend analysis eof analysis 1 introduction droughts are one of the most complex natural disasters that have potentially drastic consequences for agriculture ecosystems economy and society wilhite 2000 mo 2011 over the past few decades drought related catastrophes have escalated with changing climate across the world though with varying severities allen et al 2011 in india the frequency of drought occurrence has increased abnormally since 1965 with the past few years being under almost continuous drought shewale and kumar 2005 the situation is further exacerbated by increasing water demands due to growing population and industrialization as a result nearly 32 of the country is prone to different degrees of water stress and drought conditions mishra et al 2009 moreover increasing water demand often leads to conflict amongst competing water users that becomes pronounced during drought periods hence it is absolutely critical to monitor assess and quantify droughts at river basin scales for proper implementation and evaluation of management and mitigation strategies owing to the complex nature of drought events and the involvement of various hydrologic and atmospheric processes a diverse variety of drought monitoring indices have evolved over time heim 2000 the palmer drought severity index pdsi established by palmer 1965 and standardized precipitation index spi mckee et al 1993 have been employed extensively for drought monitoring over the last few decades hayes et al 2011 some of the most recently developed drought indices include standardized precipitation evapotranspiration index spei vicente serrano et al 2010 total storage deficit index tsdi yirdaw et al 2008 grace dsi zhao et al 2017a multivariate standardized drought index msdi hao and aghakouchak 2014 standardized runoff index sri shukla and wood 2008 streamflow drought index sdi nabaltis and tsakiris 2009 normalized difference vegetation index ndvi rouse et al 1973 and vegetation drought response index vegdri brown et al 2008 while most of these indices are based on model simulations or observations of land surface states and fluxes only a few are based on remote sensing techniques in fact until the launch of gravity recovery and climate experiment grace satellites in 2002 tapley et al 2004 drought monitoring using remote sensing techniques were only restricted to agricultural droughts that too using vegetation indices kogan 1997 singh et al 2003 bhuiyan et al 2006 it is only recently that direct observations of terrestrial water storage tws from grace e g yirdaw et al 2008 agboma et al 2009 long et al 2013 girotto et al 2017 or its deviation from climatologic mean thomas et al 2014 zhao et al 2017a b have been used as a metric for drought characterization in spite of the plethora of drought indices considerable debate still exists on the effectiveness of each index as a drought monitor and its applicability for practical purposes it is therefore necessary to formulate a holistic drought index that comprehends all the aspects of meteorologic agricultural and hydrologic droughts that can be employed consistently over regions with varied climatic conditions this will further assist in the proper identification assessment and monitoring of drought which is imperative for improved preparedness and management of resources on the ground over time drought indices have developed into a decisive factor for monitoring drought and thus a key component of early drought warning systems svoboda et al 2002 vicente serrano et al 2011 despite their wide applicability even the most popular indices like pdsi and spi have their own set of limitations for example spi values may show disparity due to changes in the length of precipitation record and the shape and scale parameters of the fitted gamma distribution function moreover spi is solely based on precipitation data and hence underestimates the role of other critical climatic factors which actually can have a notable impact on drought conditions similarly pdsi is often limited by its complex empirical derivation and dependence on the regional climatology of mid western united states keyantash and dracup 2002 it has also been observed that pdsi is not spatially comparable owing to the weighted factors derived from the data of the nine climatic regions of u s a which are aggregated annually further pdsi also lacks the adaptability to the intrinsic multiscalar nature of drought which is crucial for understanding the impacts of drought over different hydrological systems recent studies by mishra and singh 2010 and dai 2011 presented an exhaustive evaluation of the competency and limitations of these indices besides quantification of new indices studies on drought have focused on governing causes e g cook et al 2007 hoerling et al 2014 frequency e g gregory 1989 huang et al 2014 onset and recovery e g mo 2011 hao and aghakouchak 2014 and trend analysis e g rajeevan et al 2008 dai 2011 2013 mallya et al 2016 while a majority of the earlier studies in india has been on drought characterization e g bhalme and mooley 1980 sikka 1999 others have been case studies of particular drought years like 1987 2002 2004 and 2009 krishnamurti et al 1989 gadgil et al 2003 sikka 2003 francis and gadgil 2010 krishnamurti et al 2010 further these studies have been predominantly based on rainfall data only chowdhury et al 1989 guhathakurta 2003 pai et al 2011 and reveal little information about the state of land water storage at the same time drought monitoring in india has been for the most part restricted to quantification of agricultural and economic losses spatial and temporal characterization of drought at the basin scales has never been assessed using a holistic representation of drought moa 2009 in fact the drought management system practiced in india emphasizes on a relief based approach and does little towards prevention by appraising the developing water stress conditions thus there is clearly a need for a holistic metric for drought monitoring that would be applicable over diverse geographic regions at large spatial scales in this study a comprehensive drought index referred to as the combined climatologic deviation index ccdi has been developed that accounts for the combined effect of variations in precipitation and tws this novel index is assessed over four major river basins fig 1 of india in addition ccdi is compared with other commonly used drought indices like pdsi spei spi and sri and also with grace dsi which is a purely grace based index in order to explore the competency of the index to discern the occurrence of droughts this new index complements existing drought indices for an improved understanding of the complexities of drought 2 data 2 1 precipitation in this study we use precipitation estimates computed as the mean of three different datasets namely global precipitation climatology project gpcp cpc merged analysis of precipitation cmap and noaa s precipitation reconstruction over land prec l for the time period of april 2002 to april 2015 gpcp monthly precipitation analysis version 2 2 adler et al 2003 data is one of the most precise datasets generated using satellite and gauge based measurements this monthly dataset is available from 1979 to the present with a spatial resolution of 2 5 2 5 global grids similarly the cmap dataset is produced by merging observations from a large network of rain gauges with precipitation estimates from several satellite based sensors infrared and microwave this analysis produces monthly datasets of precipitation on a 2 5 2 5 latitude longitude grids that extend back to 1979 prec l is a monthly 1 1 gridded global terrestrial precipitation dataset computed by interpolating gauge observations from the global historical climatology network ghcn version 2 and the climate prediction center climate anomaly monitoring system cams dataset through optimal interpolation techniques this dataset covers a time span from 1948 to present all of the three above mentioned dataset are available at http www esrl noaa gov psd 2 2 terrestrial water storage anomaly twsa from grace gravity recovery and climate experiment grace satellites launched in 2002 tapley et al 2004 measures the gravimetric departures caused by a combination of hydrological processes the estimates of twsa obtained subsequent to the elimination of atmospheric and oceanic influences along with the effects of solid earth tides from grace data solutions wahr et al 2004 chen et al 2005a b accounts for all stores of water above and underneath the land surface however grace satellites are incapable of identifying variations in the individual components of tws such as snow surface water or groundwater rather grace provides highly accurate estimates of column integrated variations in tws for a given region grace derived continuous gravimetric solutions have been instrumental in determining regional changes in groundwater storage famiglietti et al 2011 famiglietti 2014 castle et al 2014 soni and syed 2015 glaciers and ice sheets shepherd et al 2012 gardner et al 2013 and tws variations induced by hydrologic extremes like flood and drought morishita and heki 2008 long et al 2013 reager et al 2014 thomas et al 2014 sinha et al 2017 important contributions are also noted in the quantification of hydrologic fluxes such as river discharge syed et al 2010 and evapotranspiration seo et al 2009 syed et al 2014 we use the monthly jpl mascon solutions rl05m 1 v02 of land water storage from grace that is gridded 0 5 0 5 and scaled by the nasa jet propulsion laboratory following the methodology provided by landerer and swenson 2012 available at http grace jpl nasa gov this data includes all the latest post processing techniques which are detailed in watkins et al 2015 and wiese et al 2016 in this study we have utilized 157 months tws variations starting from april 2002 to april 2015 missing months in the dataset are replaced with the climatologic median of that particular calendar month the jpl rl05m grace mascon solution wiese et al 2016 is a unique framework that parameterizes the earth s gravity field into 3 equal area spherical cap mass concentrations mascons no post processing filters are required to remove the correlated errors in jpl rl05m grace mascon solution as it is diminished during the data inversion process watkins et al 2015 prior to the application of the two post processing algorithms to the solution corrections for glacial isostatic adjustment gia and earthquakes are applied the coastline resolution improvement cri filter isolates land and ocean mass inside the mascons along the coast lines it has been observed that within a mascon regions with skewed ratios of land to ocean area have lower efficiency of the cri filter thus caution must be taken while interpreting results within these mascons further jpl rl05m grace mascon solution does not require any smoothing filter as equal area 3 spherical cap mascons acts as an inherent smoothing function on the true gravity signal reducing signal strengths at spatial scales smaller than about 3 however implementation of the gridded scaling factors restores those lost signals despite the efficacy of the scaling factors limitations exist in their application to long term groundwater changes landerer and swenson 2012 the scaling factors provided with the jpl mascons are derived using the technique detailed in landerer and swenson 2012 note that as the mascons feature a 0 5 0 5 gridded resolution the land surface model community land model clm used to derive the scaling factors also offer 0 5 0 5 grids this facilitates the ability to generate a global set of 0 5 0 5 gridded scaling factors for continental hydrology by simple multiplication of the two fields which reallocates the mass inside each 3 mascon proportionally both the cri filter and scaling factors reduce the leakage errors effectively residual errors account for grace measurement errors plus the lost inter annual geophysical signals 2 3 self calibrated palmer drought severity index sc pdsi palmer 1965 formulated the pdsi in order to estimate moisture supply and demand within a two layer soil model using precipitation and temperature in order to improve the spatial comparability wells et al 2004 proposed a self calibrating pdsi sc pdsi by replacing the empirically derived fixed values of the climatic characteristic k and the duration factors 0 897 and 1 3 used by palmer 1965 which was based on data from the central united states with values automatically calculated using historical climatic data of a specific region in this study we utilize monthly self calibrated globally gridded 2 5 2 5 pdsi data http www esrl noaa gov psd for the period of april 2002 to december 2014 dataset used and the methodology applied to compute self calibrated pdsi is elaborated in dai et al 2004 and dai 2011 2 4 standardized precipitation index spi the standardized precipitation index spi mckee et al 1993 is a multivariate meteorological drought index based on probability distribution of precipitation spi values are dimensionless and are computed by fitting a gamma distribution function to precipitation values during the time month period here we have computed spi for the time scales of 1 month 3 month 6 month and 12 month using the ensemble mean of three different precipitation datasets i e gpcp cmap and prec l 2 5 standardized precipitation evapotranspiration index spei spei datasets 1 month spei 3 month spei 6 month spei and 12 month spei used here is directly obtained from institutional repository of the spanish national research council csic https digital csic es for the time period of april 2002 to december 2014 the spei is a multi scalar drought index based on two climatic parameters precipitation and potential evapotranspiration vicente serrano et al 2010 beguería et al 2010 spei has been computed utilizing global 0 5 gridded climate research unit cru ts3 monthly precipitation dataset available at http badc nerc ac uk browse badc cru data and potential evapotranspiration pe estimated using thornthwaite s method 2 6 standardized runoff index sri standardized runoff index is a multivariate hydrological drought index computed by fitting a lognormal distribution function to runoff estimates shukla and wood 2008 sri is very similar to spi and is also dimensionless in this study we have used the noah 2 dataset of gldas to compute sri estimates for the respective river basins studied here similar to spi and spei all the mentioned time scales of sri have been utilized in this study note that in this study 3 month 6 month and 12 month spi spei and sri is only utilized for assessing correlation with ccdi at different time scales 2 7 grace dsi grace dsi is a standardized drought severity index exclusively based on grace derived tws we have utilized monthly estimates of jpl mascon solutions rl05m 1 v02 of land water storage from grace to compute grace dsi following the algorithm provided in zhao et al 2017a 2 8 temperature here we have utilized the monthly global gridded station data of air temperature provided by the university of delaware the dataset is 0 5 gridded and is available for a period of january 1901 december 2014 the dataset only provides the temperature estimates for the land 3 overview of concept drought is one of the most intricate and least apprehended amongst all natural hazards hagman 1984 fundamental to the comprehension of drought is the ability to recognize its initiation and termination and to assess the characteristics of a drought event such as its intensity recovery time and spatial extent due to its complex nature association with numerous natural processes and human interventions a wide variety of drought indices utilizing various parameters have emerged over time heim 2000 keyantash and dracup 2002 mishra and singh 2010 what adds to the complexity of the problem is the lack of a standard definition and corresponding ground truth observations since drought is perceived by its effect on the various realms of the natural environment the criticality of the parameters used for the identification of drought events and the quantification of its severity is constantly argued upon in this study we combine deviations of precipitation and twsa grace based from their climatologic normal conditions to formulate a novel drought index precipitation being the only source of influx into the hydrological system its incorporation in the formulation of a drought index is crucial and thoroughly logical consideration of precipitation in a drought monitoring index is decisive because of its higher frequency variability in comparison to any other hydrologic variables vicente serrano et al 2010 also the effects of climate change are intuitively reflected in the variations of precipitation evidences of large scale change in patterns of precipitation have been found to be associated with climate change trenberth 2005 hence precipitation along with its high variability captures the impacts of climate change which is pivotal for exacerbating hydrological extremes like drought even though precipitation is a primary factor contributing to drought conditions the effect of drought is ultimately subjective to the status of water stored in the different land water storage components accordingly we include observations of twsa from grace in addition to precipitation in our consideration for devising a novel drought monitoring index moreover twsa incorporates the possible impacts of stress on water resources that are induced by increasing population and non sustainable utilization of water resources for economic growth as well as for ensuring food security this is especially true for india where groundwater storage is being depleted at an alarming rate rodell et al 2009 consequently the development and continuity of drought conditions can be considerably influenced by anthropogenic activities hence it is crucial to jointly consider the contributions from both precipitation and twsa while developing a holistic drought monitoring index the rationale behind combining the two concerned parameters is to encompass every aspect of drought that is either induced entirely by deficiencies in precipitation twsa or by partial contributions from both the relative contribution of these parameters in triggering a drought event is difficult to ascertain and will vary both in space and time depending on numerous hydroclimatological factors and it is not essential that precipitation and twsa must be correlated for the emergence of drought conditions syed et al 2008 has shown earlier that variations in twsa were differently correlated with precipitation and et in different latitudes furthermore even if there is no change in precipitation significant storage anomaly can be created due to anthropogenic activities e g groundwater extraction only in essence when a drought is recorded by our proposed index it is either due to deficit in precipitation and or in land water storage relative to normal conditions besides drought is a multiscalar phenomenon that involves response from various components of the hydrological system e g soil moisture groundwater surface water reservoirs to precipitation inputs at noticeably different time periods which may or may not even overlap changnon and easterling 1989 elfatih et al 1999 pandey and ramasastri 2001 vicente serrano et al 2010 precipitation has a higher frequency of variation operating over short time scales but this generates variable time scales of response in the hydrologic system for example soil moisture and river discharge generate shorter time scale variations while reservoir and deeper groundwater storage respond at much longer time scales therefore it is extremely important to incorporate these different time scales of response in order to identify drought conditions some of the existing drought indices e g spi and spei makes explicit consideration of these time scales based on the presumption that droughts have definite periods of cyclicity such as 3 6 9 12 months and has categorized drought accordingly mckee et al 1993 1995 vicente serrano and lópez moreno 2005 vicente serrano 2006 by making these assumptions it is in fact ignored that natural systems may respond differently with varying time and space however by combining variations in precipitation and twsa we will be able to capture the entire range of variations associated with the different components of terrestrial hydrology essentially the proposed index includes the effect of short term variations as well as tendencies trends through precipitation and lower frequency or long term variations through the incorporation of land water storage variations this combination thereby apprehends the multiscalar nature of drought without having to make explicit considerations for various types of droughts based on time scales overall the proposed index incorporates the role of water input precipitation and land water storage variations hence this novel index has the potential to identify intensification of drought severity in the context of reduced precipitation which may be due to a changing climate as well as escalating stress on the groundwater resources as a consequence of enhanced population demand in our consideration twsa and precipitation anomaly are represented in a relative manner which is with respect to normal climatologic conditions and that too using standardized units consequently it is independent of the relative contributions of precipitation and twsa also note that this index abides by the multitudinous definition keyantash and dracup 2002 of drought by acknowledging deviations in water input and responses of different natural components of the hydrologic system therefore the incorporation of twsa and precipitation estimates in the computation of a drought index is physically discernible practically applicable theoretically justified and an efficient way to encompass the multi temporal responses of a variety of natural system responding to drought conditions 4 methods 4 1 computation of ccdi in this study we propose a novel combined climatologic deviation index ccdi in order to characterize drought conditions over four major river basins of india by integrating the contributions of precipitation anomalies pa and terrestrial water storage anomalies twsa in contrast most prior studies have either considered below average precipitation guhathakurta 2003 or depletion in tws thomas et al 2014 as a measure of drought condition grace derived twsa comprises of mass change within the vertically integrated land water storage column therefore ccdi responds to variations in surface near surface and deeper groundwater storages however grace can neither differentiate between the contributions of individual storage component nor can it isolate the impact of human activity the rationale behind the present formulation is that a drought condition is not just a reflection of below normal precipitation or depleted tws but a culmination of both hence the contribution of hydrologic influx in terms of precipitation and prevailing hydrologic storage conditions terrestrial water storage anomaly are indispensable for assessing drought conditions therefore the decisive factor for the assertion of drought condition is the combined deviations incurred due to the joint impact of departures from normal precipitation amount and terrestrial water storage more precisely here we classify drought non drought condition on the basis of deviations from normal conditions climatologic quantified in terms of the combined impact of water influx and storage during a particular month furthermore drought being an obscure phenomenon a number of factors can be associated with the incidence of a particular drought event in order to quantify the impact of a drought event it is also essential to apprehend its actual emergence termination and intensity apart from precipitation which is the primary influx of water into the land system drought assessments based on deviations in runoff and et augments the possibility of under or over estimation of the magnitude and extent of a drought event this is because these parameters respond to water shortage conditions differently both in terms of magnitude and time scale hence instead of making explicit considerations of the above mentioned variables tws renders an integrated measure that imparts significant controls on the spatio temporal variations of et and runoff considering the discussed aspects the proposed index contends to be an improvement over the existing drought indices in this study we produced monthly time series of twsa by averaging grace observations over each of the four river basins shown in fig 1 the river basin mask was obtained from 0 5 0 5 globally gridded river basin mask of global terrestrial network for river discharge gtn r to demarcate the boundaries of major river basins in india http www bafg de grdc similarly we have produced basin averaged monthly times of precipitation which we took as an ensemble mean of different datasets 1 p a i p i p μ a precipitation anomaly pa time series is computed eq 1 as deviations of monthly precipitation pi values from its mean pµ of the study period and twsa is acquired directly from grace satellite solutions precipitation and storage provide distinct interesting information regarding the development and cessation of a drought event subsequently we computed the mean monthly climatology of pa paclim and twsa twsaclim for each river basin by taking the mean of all the values for each calendar month within the 13 year data span e g for the month of january the mean of all the 13 january months within the timeseries are evaluated eqs 2 and 3 this climatology is thus considered to represent normal conditions of all the inputs and storage for any particular month and hence serves as the standard for quantifying their deviations note that even though it is advisable to compute climatology on the basis of long term data here we are restricted by the limited availability of grace observations adopting proper datasets for deriving the proposed index is crucial in this study we aim at developing an index that qualifies to recognize different aspects e g meteorological hydrological of drought as well as drought events that differ in time scales precipitation has a pronounced connection with drought mccandless 2014 as it is the primary input in the hydrological cycle over a region bounded by topography moreover precipitation has high frequency variability both in space and time and hence possesses the potential to bring about immediate effect over a region at short time scales these episodic variations in precipitation are more likely to affect surface water storage components compared to those underneath the surface however absence of precipitation can initiate a meteorological drought that can later develop into agricultural or hydrological drought if scarcity of water continues grace derived twsa is distinct from precipitation in that it records the cumulative effect of persistent low precipitation that can happen over enduring drought events also there are times when these two signals are contradictory for example in spite of substantial precipitation hydrological drought can persist if precipitation fails to impact the subsurface storage thus a drought index should be capable of capturing the prolonged effect of storage deficit as well as respond to excessive or deficient spells of moisture input our consideration of joint variations in precipitation and twsa enables ccdi to encompass both of these aspects of comprehensive drought monitoring the residuals in pa pares and twsa twsares eqs 4 and 5 are combined to evaluate combined deviations cd eq 6 which is subsequently standardized in order to compute the combined climatologic deviation index ccdi eq 7 the standardization method involves removal of the mean cdµ of the timeseries from each of the monthly estimates and dividing it by the standard deviation of the timeseries cdσ hence ccdi has a zero mean and standard deviation of 1 2 p a j c lim j 1 12 p a i j n 3 tws a j c lim j 1 12 tws a i j n 4 p a i res p a i p a i j c lim 5 twsa i res twsa i twsa i j c lim 6 c d i p a i res t w s a i res 7 ccd i i c d i c d μ c d σ where n is the total count of each calendar month the subscript i varies from 1 to 157 months j for 1 to 12 representing each calendar month of a year µ for mean and σ for standard deviation the subscripts clim and res stands for climatology and residual timeseries respectively the drought categories of ccdi are derived using the threshold percentiles used in united states drought monitor usdm svoboda et al 2002 the drought categories are designated as d0 d1 d2 d3 and d4 which correspond to 30th 20th 10th 5th and 2nd percentiles respectively ccdi recognizes both dry and wet conditions and is detailed in table 1 note that the categorization of drought classes table 1 presented in this study is entirely based on the range of ccdi values obtained for the four major river basins of india discerning the characteristics of drought like onset recovery and severity is crucial for assessing the processes and impacts associated with a drought event wilhite 2000 mishra and singh 2010 here we have analysed the onset recovery and severity s of the drought events identified by ccdi over the four major river basins of india in order to inspect the acuteness of the drought events for this we have utilized the threshold level method yevjevich 1967 hisdal et al 2004 to identify the onset and recovery of a drought event in our assumption when ccdi falls on or below the threshold ccdi 0 28 level a drought event starts onset t 1 and it continues until the threshold ccdi 0 28 is again surpassed recovery t n severity s t is the measure of the acuteness of a drought event it is quantified as a product of the mean of the deficit m t in ccdi ccdi 0 28 of a particular drought event ccdi threshold and the duration t months through which the event persists t t yevjevich 1967 thomas et al 2014 sinha et al 2017 ccdi being dimensionless severity of drought events computed using ccdi also does not have any unit thus drought severity s is represented as 8 s t m t t t here t denotes occurrence of a specific drought event although the severity s of a drought event can only be estimated after its termination it can serve as a tool for inter comparison of drought events identified by other indices 4 2 trend analysis in order to the assess trends in the basin scale estimates of ccdi we have employed the modified mann kendall test hamed and rao 1998 before implementing the trend test the effects of autocorrelation and seasonality were removed by fitting a first order autoregressive ar 1 model and an annual and semi annual cycle modified mann kendall trend test also removes the impact of serial correlation in the time series hence the empirical significance levels of the modified test are more accurate than the nominal significance levels a non parametric trend estimate sen 1968 is first removed from the timeseries and the autocorrelation between the ranks of the observations rank correlation coefficient is a measure of correlation i e a number that shows how closely two sets of data are linked is calculated significant autocorrelations at 5 significance level or 95 confidence level are then utilized to assess the modified variance of the statistic the significance value p value of the test is calculated utilizing the variance 4 3 frequency analysis the concept of frequency in drought related studies is implemented to designate how many times drought events have affected a particular geographic location over a specific time period drought frequencies computed over long time periods are useful for a proper understanding of the hydrological system as well as for implementing precautionary measures for drought mitigation due to lack of data availability drought frequency computed and analyzed in this study is based on data for the period of april 2002 to april 2015 following potop and možný 2011 the frequency of droughts observed by ccdi is calculated as the ratio of n m for each of the river basins in the ratio n is the number of consecutive months with ccdi values less than zero and m is the total number of months of the study period note that we have only considered those consecutive months which exhibit ccdi 0 28 for a minimum span of 3 months 4 4 empirical orthogonal functions eof analysis empirical orthogonal function analysis is a multivariate statistical technique used to reduce the dimensionality of large datasets in order to reveal the dominant patterns of spatio temporal variability the advantage of eof analysis is that it accentuates the resemblance and dissimilarity in demonstrating the data which is difficult to analyze eofs has been extensively used in climate studies like determining rainfall patterns basalirwa et al 1999 aravena and luckman 2009 controls and patterns of hydrologic variables famiglietti et al 1995 syed et al 2004 trends dai 2011 and inter annual and inter decadal variability modes kawamura 1994 the primary goal of eofs obukhov 1947 fukuoka 1951 lorenz 1956 was to disintegrate a continuous space time field x t s where t and s indicates time and spatial location respectively and can be represented as 9 x t s k 1 m c k t u k s where m is the number of modes present x t s stands for the original time series as a function of time t and space s uk s show the spatial modes of the major factors which accounts for the temporal variations of z and ck t is the principal component that depicts the variations of the amplitude of each eof with time in essence eof analysis aims to create a new set of variables that apprehend most of the observed variance from the data by a linear combination of the original variables fundamental to the eof method is that the modes are orthogonal in its simplest formulation eof analysis is the computation of eigenvector and eigen value of a covariance or a correlation matrix computed from a group of original time series data where eigenvectors are the coefficient of orthogonal transformation and eigen values are variances of principal components the eigenvectors are often referred to as modes or loadings in practice most of the data variance is typically explained by the first few modes first two is considered in this study higher modes with small variance generally have noisy amplitude or loading patterns eof analysis aims to detect a relatively small number of independent variables which emanate almost as much as original information as possible without the redundancy in the dataset 5 results in order to assess the potential of the ccdi developed here it is compared and analysed in four major river basins of india these river basins i e ganga 861 452 sq km krishna 258 948 sq km godavari 312 812 sq km and mahanadi 141 589 sq km are diverse in terms of their area and geography together these basins comprise about 47 8 of the total geographic area of india a major part of these river basins viz ganga krishna godavari and mahanadi are covered with agricultural lands accounting for 65 57 75 86 59 57 and 54 27 of the total area respectively and is largely dependent on groundwater for irrigation shown in fig 2 are the timeseries of ccdi for the four major river basins of india here the solid green lines stand for ccdi red bands represent periods of major drought defined by ccdi values and confirmed by anecdotal reporting in india nraa 2013 here we assume that any dry spell continuing for three or more months will only be considered for drought characterization thomas et al 2014 intermittent wet spells within a dry spell sustaining three or less than three months will be assessed as a temporary anomaly within the persisting dry spell fig 2a shows the occurrence of four drought periods in ganga basin i e during oct 2007 may 2008 de1ganga feb 2009 may 2011 de2ganga feb 2012 may 2013 de3ganga and apr 2014 apr 2015 de4ganga in this study each of the drought events identified by ccdi is represented as de followed by the order of the drought event and having the name of the river basin in the superscript as for example the first drought event of ganga basin is represented as de1ganga apropos of the index de2ganga and de4ganga are characterized as d3 extreme drought conditions while de1ganga and de3ganga are representing d1 moderate and d4 exceptional drought conditions respectively de2ganga is the longest as well as the most severe drought event identified in the ganga basin persisting for 28 months and having a severity of 28 92 in fig 2b amongst the four drought events observed in krishna basin one is categorized as d4 exceptional drought while the other exhibits d2 severe drought conditions the longest drought spell and the highest severity amongst all the river basins continuing for 36 months de1krishna jul 2002 june 2005 is also observed in this region in the godavari basin fig 2c three drought spells are noted over the periods of july 2002 may 2003 de1godavari mar 2004 aug 2005 de2godavari and sep 2008 apr 2010 de3godavari with regards to ccdi de1godavari and de3godavari took 11 and 20 months to recover from the state of drought and are characterized as d4 exceptional and d3 extreme drought conditions respectively the longest drought period de3mahanadi observed in the mahanadi basin fig 2d extended for 30 months from oct 2008 mar 2011 with d4 exceptional drought intensity in addition two other drought events de1mahanadi and de2mahanadi indicating d4 exceptional drought conditions have also been identified in the region a detailed record of the drought events of all the four river basins are given in table s1 see supplementary material the timeseries of ccdi in ganga basin show decreasing annual trend of 0 08 yr 1 in contrast krishna godavari and mahanadi river basins show an increasing trend of 0 018 yr 1 0 06 yr 1 and 0 04 yr 1 respectively hence it is important to note that ccdi depicts continuously deteriorating drought condition in one of the major river basins which represents a significant portion of the entire country however ganga basin shows the highest monthly frequency of 0 41 while droughts in mahanadi basin are least frequent 0 35 the monthly drought frequencies in krishna and godavari basins are 0 39 and 0 31 respectively fig 3 demonstrates the comparison between monthly estimates of ccdi and other commonly used drought indices like grace dsi pdsi 1 month spi 1 month sri and 1 month spei in all the four river basins the comparison is restricted to the concurrent data period of april 2002 december 2014 direct comparison of different drought indices is complicated by the varied computational techniques and a wide range of values associated with the different categories of drought intensity to enable a meaningful comparison and to avoid contrariety in this study a collective representation of the intensities of various drought indices are made using a unified scale of drought categorization which is the united states drought monitor usdm in order to assign a common classification scheme z score standardization is applied to all the indices thus all the indices have a zero mean and standard deviation of one the distinguishing responses of ccdi to the hydrological extremes concede skilfully with the other indices compared here it is also important to recognize that because the formulation of ccdi incorporates impact of both influx and storage variations disparity in comportment with other indices are anticipated spi and spei are more sensitive to precipitation and evapotranspiration rates as a consequence high frequency variations are observed in their timeseries this can also be the possible reason behind the decent correlation of ccdi with spi and poor correlation with spei sri shows a better correlation with ccdi the justification behind this is the comparatively lower frequency variations in sri as because runoff relies on land water characteristics however it has been observed that ccdi has a gradual improvement in correlation values with spi and sri as the time scale of these indices increase see table s2 on the contrary correlation with spei remains poor regardless of the increase in its time scale amongst all the drought indices temporal variations of grace dsi are best correlated with ccdi the estimated correlation coefficients between ccdi and grace dsi are 0 94 p 0 05 0 88 p 0 05 0 89 p 0 05 and 0 86 p 0 05 for ganga krishna godavari and mahanadi river basins respectively the most likely reason behind the noted compatibility is the similarity in the utilization of grace data however unlike ccdi grace dsi does not include an explicit contribution from precipitation which exhibits a high degree of variability in space and time thus owing to the spatio temporal heterogeneity in precipitation estimates differences in ccdi and grace dsi would be more prominent over humid regions and smaller spatial scales in comparison to when they are averaged over large river basins and semi arid regions consequently ccdi will bear the advantage of being more effective in regions that exhibit greater variations in magnitude and intensity of precipitation the estimated correlation coefficients between ccdi and pdsi in ganga krishna godavari and mahanadi are 0 42 p 0 05 0 79 p 0 05 0 74 p 0 05 and 0 67 p 0 05 respectively although ccdi and pdsi are not highly correlated the fundamentals of computation of both the indices imply similitude fig 4 demonstrates the contrast in the drought characteristics of the events identified by ccdi pdsi and grace dsi due to the high frequency variations observed in spi spei and sri and their relatively poor correlation with ccdi this comparison is limited to pdsi and grace dsi only drought events identified by pdsi grace dsi and ccdi are shown in red black and blue colours respectively all of the drought events identified by ccdi in the four river basins are marked in the figure in ganga and krishna basins intensities of drought events identified by ccdi vary between d1 to d4 and d2 to d4 whereas for godavari and mahanadi basins the range extends from d3 to d4 it is also important to notice that there exists variation in the category of individual drought events identified by ccdi pdsi and grace dsi in each of the river basins for example de3godavari and de2mahanadi show d3 extreme drought and d4 exceptional drought categories while the corresponding drought events identified by pdsi grace dsi depict d1 d4 and d1 d3 drought categories respectively the onset month of each drought event is the initiation of each horizontal line in the x axis and its length signifies the recovery time of that particular drought event the position of the horizontal lines in the y axis marks the category of that drought event with respect to the usdm drought classification scheme while the onset of some of the drought events identified by ccdi is almost contemporaneous de3ganga de1krishna de1godavari and de3mahanadi with pdsi some of them are significantly different de4ganga de2krishna de3krishna de2godavari and de2mahanadi correspondingly an emergence of drought events like de3godavari and de2mahanadi are contemporaneous to few drought events identified by grace dsi however the recovery times severity and category of drought events identified by pdsi and grace dsi are immensely different from those identified using ccdi it is also evident that drought events identified by ccdi are also portrayed by pdsi as two separate drought events with different onset and recovery time besides there are a number of occasions when pdsi june 2002 january 2003 ganga september 2004 december 2004 ganga august 2006 january 2007 ganga and october 2011 june 2012 godavari exhibit drought condition while no drought is identified by ccdi the observed variability in the drought characteristics onset severity and recovery time and drought category of drought events by ccdi pdsi and grace dsi signifies the probable underestimation of the impact of a particular drought event as well as the actual drought conditions by the commonly used drought indices shown in fig 5 are the spatial patterns of ccdi precipitation and temperature averaged over individual drought periods in each of the river basins the primary objective here is to make a qualitative assessment of compatibility in the spatial distribution of drought non drought conditions with those of two most crucial hydrometeorologic variables associated with drought consequently the focus here is on the regions where there is correspondence amongst the variables rather than the individual pixel values the colour scale used for each of the parameters in all of the four river basins has also been modified accordingly all the maps in this plot are displayed in 0 5 degree gridded resolution and individual pixels are indicative of values averaged over the drought periods observed in each basin due to the lack of data contemporaneity the comparison is restricted to the time period of april 2002 and december 2014 in general the correspondence of ccdi with climatic variables like precipitation and temperature are more conspicuous in krishna and godavari river basins in comparison to ganga and mahanadi river basins in fig 5a scanty rainfall and high temperature impacts during de2ganga and de4ganga are successfully recorded by ccdi the central and south eastern part of ganga basin predominantly experienced the adverse effects of drought during de2ganga while in course of de4 ganga north western eastern and central part encountered the major drought effects during de4krishna in fig 5b almost the entire basin experienced drought condition except a few areas in the southern western and north eastern parts of krishna basin throughout de2krishna most intense drought is observed in the eastern central and northern parts of the basin although the northern and southern part of the basin encountered extensive drought condition during de1krishna the circumstances were drastic in the western proximities of the basin the mentioned context is nearly well supported by low precipitation and high temperature values in those areas in the godavari basin fig 5c during de1godavari the impact of drought was devastating almost the entire basin exhibited acute drought condition during de1godavari it is also evident that during de3godavari drought effects are profound mainly in the eastern central and northern sectors while western part of the basin witnessed relatively wet condition this is also apparent from the spatial plots of precipitation and temperature which skilfully ratifies the prevailing drought conditions similar characteristics are observed in the mahanadi basin fig 5d as well in which all the three drought events showed significant heterogeneity in their spatial structure the overall discrepancies noted here can perhaps be attributed to human induced changes in ccdi hence in river basin like ganga where human induced changes are prominent conformity with natural variables like precipitation and temperature are less conspicuous in contrast the spatial correspondence between ccdi and precipitation and temperature are significantly appreciable in krishna and godavari river basins fig 6 shows the spatial patterns of variability using empirical orthogonal function eof analysis of ccdi for the period of april 2002 till april 2015 fig 6a and 6b are the spatial patterns of the leading modes of eofs of monthly ccdi in the four river basins the variances covered by first second principal component over ganga krishna godavari and mahanadi basins are 47 8 22 6 64 9 13 73 3 11 4 and 78 9 10 5 respectively the areas shown in blue represent drying condition while the areas marked yellow are indicative of wetting condition this study illustrates the progression of the spatial patterns of variance of ccdi with time which imparts precious knowledge about the temporal evolution of the majority of the dynamic regions the spatial pattern of eof1 depicts that the eastern and western parts of ganga basin and central parts of the other three river basins have a high propensity to droughts in contrast central portions of ganga basin areas of eastern and north western krishna basin western godavari basin and southern mahanadi basin represent tendency towards wet conditions since this analysis in four river basins is done at local grid box level poor sampling of precipitation and the continuous withdrawal of groundwater from various parts of india may have also affected the grace measurements hence these could be probable reasons behind the sharp difference in drought intensities observed across the river basins the second mode eof2 are consistent with the teleconnection patterns like enso and indian ocean dipole iod which is further supported by the close correspondence observed between the time series of second principal component and nino 3 4 sst index and dipole mode index fig s1 therefore the two dominant eofs signify the two different modes of variability and are unrestrained by the dataset utilized 6 summary and conclusion in this study we develop a novel drought index combined climatologic deviation index ccdi which combines deviations in precipitation and terrestrial water storage from normal climatologic conditions to ascertain the effectiveness and applicability of the index it is evaluated over four major river basins in india the index ccdi aptly manifest it s potential to identify and monitor droughts over large river basins through a comprehensive assessment of the integrated hydrologic deficit as well as the tendency of wetting or drying represented by recent precipitation events results discussed here demonstrate and highlight the temporal variability of droughts in india with implications for better understanding of onset and termination of actual drought conditions results impart immense confidence on the potential of ccdi major drought events reported in each of the river basins correspond well with those characterized by ccdi this is irrespective of whether the drought event was persistent in all the basins e g drought of 2009 2010 or restricted to certain river basins as isolated events besides it is important to note that some of the drought events characterized by ccdi were not reported previously due to the lack of exhaustive measures that could capture the multi dimensionality of droughts based on combined deviations onset severity and recovery time of each of the drought events have been evaluated drought events recognized by ccdi are well endorsed by low precipitation and high temperature conditions observed in all of the four river basins this further corroborates the occurrence of drought events that are hydrometeorologically supported however the degree of spatial conformity between ccdi and temperature precipitation is more pronounced in some basins compared to others the reason behind this disparity can be imputed to the human induced and natural changes due to deficit in both precipitation and storage the spatial correspondence between ccdi and temperature precipitation are more conspicuous in the basins where combined deviations are primarily driven by natural processes whereas in river basins with more prolific human interference uniformity in the spatial variation of ccdi and natural variables like temperature and precipitation are poorly reconcilable a comparison of temporal consistency in basin averaged estimates of ccdi and other commonly used drought indices highlight important fundamental differences between them from this analysis it is evident that ccdi estimates averaged over large river basins are best correlated with that of grace dsi however the difference between these two indices would be more prominent when analyzed over regions with diverse hydro climatological conditions this is because averaging over larger river basin scales diminishes the contribution of precipitation which shows significant spatial heterogeneity the primary reason for the relatively low correlation between ccdi and other indices is their foundational difference while almost all the indices represent natural droughts only ccdi represents both natural and human induced drought occurrences furthermore most of the indices manifest near surface or meteorological condition while ccdi being a grace based index accounts for the entire vertical land water column including surface and subsurface components the computation of pdsi features a water budget approach unlike that of other indices which comprehend one or two parameters for drought assessment hence pdsi can be considered to be somewhat similar to ccdi in comparison to other indices which is duly reflected in the conformity between the two but pdsi does not incorporate contributions from the storage component in their computation which is critical for drought assessment it is also apparent that different indices respond differently to the same drought event for example some of the drought events identified by ccdi has even been depicted as wet periods by some of the indices a part of these discrepancies can be attributed to fundamental differences in their formulation and their inherent limitations for example while the computation of spi and sri involves precipitation and runoff respectively spei is based on the integration of precipitation and potential evapotranspiration on the other hand pdsi is computed using a number of water balance parameters this also explains why ccdi is better correlated with pdsi in comparison to spi spei and sri differences in drought categories onset and recovery identified by ccdi and grace dsi denote the significance of the fact that a drought condition is not just a reflection of below normal precipitation or depleted tws but an amalgamation of both therefore we suggest that ccdi could serve as an alternative and complementary metric for comprehensive drought characterization every new index is faced with the question of its efficacy over existing indices with respect to this we have to acknowledge that drought is resultant of the nexus between the anomalous behaviour of a number of factors hence it is obvious to appraise the intensity and severity of drought events by incorporating a multitude of factors instead of relying on a single parameter since the very definition of drought is multitudinous it would be exemplary if all the factors responsible for triggering droughts could be integrated for a proper understanding of the phenomenon in this regard the formulation of ccdi with a holistic consideration of terrestrial hydrology can be considered as a significant improvement that can firmly serve its purpose also note that the primary objective behind formulating ccdi is to develop a robust drought index incorporating a variety of hydrometeorologic factors responsible for its occurrence to enable holistic monitoring of drought over large spatial scales the choice of a drought index from a stakeholder s perspective may vary in accordance with the geographic location climatic conditions and the objective of using a drought index however ccdi will be particularly beneficial for assessing droughts over large regions but at smaller spatial scales as well as depending on the specific objective of the stakeholder the choice of a drought index may vary the patterns represented by the eofs successively explain most of the observed variability the first leading mode of ccdi portrays the spatial variability in terms of drying and wetting trends in various parts of the four river basins illustrated by lower and higher eigen values respectively the second mode represents the impact of enso on indian climate with significant drying during the el niño events which is further corroborated by the timeseries of pc 2 moreover the modes of variability concur with the reported droughts as well as the drought affected areas a detailed analysis of ccdi shows that krishna basin experienced the longest drought period of 36 months aug jul 2002 june 2005 amongst all the four river basins which was of exceptional drought category the godavari and mahanadi river basins encountered three drought spells amidst which the drought of oct 2008 mar 2011 in mahanadi basin lasted for 30 months trends in basin averaged timeseries of ccdi are observed to be consistently decreasing in ganga basin on the contrary an increasing annual trend is observed in krishna godavari and mahanadi river basins ccdi has several notable advantages over the existing drought indices despite the simplistic computation i e devoid of intensive numerical model simulation parameterization and calibration the index ccdi incorporates multiscalar characteristics of drought along with the ability to implicitly account for human induced effects on drought assessment most importantly the index efficiently determines the aggravation of drought severity by virtue of reduced precipitation probably due to climate change in addition to that from increasing stress on groundwater resources by virtue of growing demand for fresh water the index also guarantees robustness since it is potentially competent to apprehend the multiscalar nature of drought without making explicit computation of it at various time scales grace observations effectively represent monthly variations in column integrated land water storage and are practically ineffectual to apprehend the factors inducing changes in it hence the utilization of grace observations in ccdi accredits it to represent both natural and human induced drought occurrences unlike other commonly used drought indices the utilization of combined deviations as the computational basis of this index makes it physically interpretable and co relatable with the general perception of drought conditions which is in contrast to the implied inferences drawn from those based solely on hydrologic surrogates like precipitation evapotranspiration and runoff furthermore the inclusion of land water storage enables ccdi to refrain from getting biased by episodic and high frequency variations in hydrologic fluxes thus ccdi is a holistic metric that is capable of making comprehensive characterization of drought over large spatial scales moreover the efficacy of ccdi in comparison to other grace based indices will be high in regions of frequent rainfall variations than in dry areas where precipitation is scarce this is due to the fact that in dry regions where changes in precipitation are negligible variations in tws can be considered as the driving factor for drought occurrences moreover implementation of combined deviations also offers a more comprehensive assessment of actual drought characteristics like onset severity and recovery time which are often underestimated by commonly used drought indices errors in ccdi can be attributed to errors in precipitation as well as in twsa estimates from grace errors in individual precipitation datasets tend to average out as we have taken the mean of the three independent precipitation datasets error in precipitation further reduces when a spatial average over all the grids in each river basin is computed residual errors in grace tws can lead to underestimation of twsa values which can propagate to ccdi thereby causing underestimation of actual drought conditions this is particularly true for spatial representation of grace data in 0 5 0 5 grids using the scaling factor this is beacuse the scaling factors are essentially based on hydrologic model simulations that may not be able to capture neither the actual amplitude nor the full range of inter annual variations in twsa weise et al 2016 furthermore the inter annual variability caused by human activities may not be appropriately represented in the models used for the computation of scale factors nevertheless the application of scaling factor provides some information on spatial variability to the sub mascons while conserving the mass and mass trends of the individual mascons overall errors in precipitation are better constrained while errors in grace tend to increase with finer spatial and temporal resolution landerer and swenson 2012 accordingly the gridded 0 5 0 5 representation of drought shown in fig 5 should be interpreted with caution especially when quantifying how the ccdi values in individual pixels are changing in space readers must consider that individual pixel values of grace data reproduced in this 0 5 0 5 resolution using scaling factor are highly prone to errors that will propagate into ccdi values of each pixel however averaging ccdi values of each pixel over individual drought periods varying from months to years reduces the error to some extent therefore if the objective of the user is to analyze magnitudes of ccdi in each pixel it is highly recommended that computation of ccdi should be made in the native grace resolution i e 3 3 besides due to the limited temporal expanse of grace data most of the analysis including the computation of climatology had to be restricted to short periods only this could also impact the computation of deviations from normal hydrologic conditions which essentially forms the basis of ccdi computation however improvements and continuity in the grace dataset through the grace follow on http gracefo jpl nasa gov mission can significantly improve the efficacy of the index overall the ccdi is a novel index that is complementary and shows promising results further the ease of computation and availability of datasets utilized in public domain imparts universal applicability of the proposed index the results presented further demonstrate the ability of the proposed methodology to elucidate climatic extreme events like droughts and their comprehensive monitoring over regional to global scales furthermore in a country like india with diverse climatic conditions and differential rainfall amounts it is extremely necessary to employ a metric like ccdi that can quantify all the aspects of meteorologic agricultural and hydrologic droughts with regard to combined deviations the methodology presented here is expected to produce improved results with its implementation over regions with disparate hydro climatic characteristics and promote exploration of its applicability as an operational drought monitor for disaster management programs conflict of interest the authors declared that there is no conflict of interest acknowledgement we would like to thank the department of science and technology ministry of science and technology government of india for providing the funding for this research under the fast track programme project no sr ftp es 176 2010 g we also like to extend our gratitude towards the editor and the five anonymous reviewers whose comments have significantly improved the quality of the manuscript the authors also acknowledge ms sridevi jadav mr shashank bhusan and mr robin prince for their help and support during the course of this work a portion of this work was conducted at the jet propulsion laboratory california institute of technology under contract with nasa this work was supported by funding from the nasa grace science team appendix a supplementary material supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 02 053 appendix a supplementary material the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 
6591,drought is a recurring natural hazard that significantly affects the economy and environment of large areas worldwide it is therefore imperative to develop techniques that enable comprehensive monitoring and assessment of drought here we propose a novel drought index combined climatologic deviation index ccdi that encompasses all the aspects of meteorologic agricultural hydrologic and human induced drought occurrences critical to the proposed framework is the concept of combining deviations in precipitation and terrestrial water storage observed by gravity recovery and climate experiment grace satellites from climatologic normal conditions as a measure of drought in order to evaluate the applicability of this new index it is analyzed over four major river basins in india i e ganga krishna godavari and mahanadi the propounded drought index ccdi has demonstrated its ability to identify drought events and render rational quantification of its severity results also depict an improved understanding of holistic drought conditions compared to other available drought indices comparison of ccdi with commonly used drought indices highlighted some of the fundamental differences while demonstrating good correspondence with pdsi r 0 79 and grace dsi r 0 94 further it is evident that in almost all the river basins there have been at least two drought periods with intensities ranging from d1 moderate drought to d4 exceptional drought the longest drought period extending for 36 months from july 2002 to june 2005 is observed in the krishna basin results from this study show appreciable reliance on the potential for quantifying droughts using ccdi which will only improve with better quantification and extended availability of terrestrial water storage observations from the recently launched grace follow on mission keywords drought river basins grace combined climatologic deviation index ccdi trend analysis eof analysis 1 introduction droughts are one of the most complex natural disasters that have potentially drastic consequences for agriculture ecosystems economy and society wilhite 2000 mo 2011 over the past few decades drought related catastrophes have escalated with changing climate across the world though with varying severities allen et al 2011 in india the frequency of drought occurrence has increased abnormally since 1965 with the past few years being under almost continuous drought shewale and kumar 2005 the situation is further exacerbated by increasing water demands due to growing population and industrialization as a result nearly 32 of the country is prone to different degrees of water stress and drought conditions mishra et al 2009 moreover increasing water demand often leads to conflict amongst competing water users that becomes pronounced during drought periods hence it is absolutely critical to monitor assess and quantify droughts at river basin scales for proper implementation and evaluation of management and mitigation strategies owing to the complex nature of drought events and the involvement of various hydrologic and atmospheric processes a diverse variety of drought monitoring indices have evolved over time heim 2000 the palmer drought severity index pdsi established by palmer 1965 and standardized precipitation index spi mckee et al 1993 have been employed extensively for drought monitoring over the last few decades hayes et al 2011 some of the most recently developed drought indices include standardized precipitation evapotranspiration index spei vicente serrano et al 2010 total storage deficit index tsdi yirdaw et al 2008 grace dsi zhao et al 2017a multivariate standardized drought index msdi hao and aghakouchak 2014 standardized runoff index sri shukla and wood 2008 streamflow drought index sdi nabaltis and tsakiris 2009 normalized difference vegetation index ndvi rouse et al 1973 and vegetation drought response index vegdri brown et al 2008 while most of these indices are based on model simulations or observations of land surface states and fluxes only a few are based on remote sensing techniques in fact until the launch of gravity recovery and climate experiment grace satellites in 2002 tapley et al 2004 drought monitoring using remote sensing techniques were only restricted to agricultural droughts that too using vegetation indices kogan 1997 singh et al 2003 bhuiyan et al 2006 it is only recently that direct observations of terrestrial water storage tws from grace e g yirdaw et al 2008 agboma et al 2009 long et al 2013 girotto et al 2017 or its deviation from climatologic mean thomas et al 2014 zhao et al 2017a b have been used as a metric for drought characterization in spite of the plethora of drought indices considerable debate still exists on the effectiveness of each index as a drought monitor and its applicability for practical purposes it is therefore necessary to formulate a holistic drought index that comprehends all the aspects of meteorologic agricultural and hydrologic droughts that can be employed consistently over regions with varied climatic conditions this will further assist in the proper identification assessment and monitoring of drought which is imperative for improved preparedness and management of resources on the ground over time drought indices have developed into a decisive factor for monitoring drought and thus a key component of early drought warning systems svoboda et al 2002 vicente serrano et al 2011 despite their wide applicability even the most popular indices like pdsi and spi have their own set of limitations for example spi values may show disparity due to changes in the length of precipitation record and the shape and scale parameters of the fitted gamma distribution function moreover spi is solely based on precipitation data and hence underestimates the role of other critical climatic factors which actually can have a notable impact on drought conditions similarly pdsi is often limited by its complex empirical derivation and dependence on the regional climatology of mid western united states keyantash and dracup 2002 it has also been observed that pdsi is not spatially comparable owing to the weighted factors derived from the data of the nine climatic regions of u s a which are aggregated annually further pdsi also lacks the adaptability to the intrinsic multiscalar nature of drought which is crucial for understanding the impacts of drought over different hydrological systems recent studies by mishra and singh 2010 and dai 2011 presented an exhaustive evaluation of the competency and limitations of these indices besides quantification of new indices studies on drought have focused on governing causes e g cook et al 2007 hoerling et al 2014 frequency e g gregory 1989 huang et al 2014 onset and recovery e g mo 2011 hao and aghakouchak 2014 and trend analysis e g rajeevan et al 2008 dai 2011 2013 mallya et al 2016 while a majority of the earlier studies in india has been on drought characterization e g bhalme and mooley 1980 sikka 1999 others have been case studies of particular drought years like 1987 2002 2004 and 2009 krishnamurti et al 1989 gadgil et al 2003 sikka 2003 francis and gadgil 2010 krishnamurti et al 2010 further these studies have been predominantly based on rainfall data only chowdhury et al 1989 guhathakurta 2003 pai et al 2011 and reveal little information about the state of land water storage at the same time drought monitoring in india has been for the most part restricted to quantification of agricultural and economic losses spatial and temporal characterization of drought at the basin scales has never been assessed using a holistic representation of drought moa 2009 in fact the drought management system practiced in india emphasizes on a relief based approach and does little towards prevention by appraising the developing water stress conditions thus there is clearly a need for a holistic metric for drought monitoring that would be applicable over diverse geographic regions at large spatial scales in this study a comprehensive drought index referred to as the combined climatologic deviation index ccdi has been developed that accounts for the combined effect of variations in precipitation and tws this novel index is assessed over four major river basins fig 1 of india in addition ccdi is compared with other commonly used drought indices like pdsi spei spi and sri and also with grace dsi which is a purely grace based index in order to explore the competency of the index to discern the occurrence of droughts this new index complements existing drought indices for an improved understanding of the complexities of drought 2 data 2 1 precipitation in this study we use precipitation estimates computed as the mean of three different datasets namely global precipitation climatology project gpcp cpc merged analysis of precipitation cmap and noaa s precipitation reconstruction over land prec l for the time period of april 2002 to april 2015 gpcp monthly precipitation analysis version 2 2 adler et al 2003 data is one of the most precise datasets generated using satellite and gauge based measurements this monthly dataset is available from 1979 to the present with a spatial resolution of 2 5 2 5 global grids similarly the cmap dataset is produced by merging observations from a large network of rain gauges with precipitation estimates from several satellite based sensors infrared and microwave this analysis produces monthly datasets of precipitation on a 2 5 2 5 latitude longitude grids that extend back to 1979 prec l is a monthly 1 1 gridded global terrestrial precipitation dataset computed by interpolating gauge observations from the global historical climatology network ghcn version 2 and the climate prediction center climate anomaly monitoring system cams dataset through optimal interpolation techniques this dataset covers a time span from 1948 to present all of the three above mentioned dataset are available at http www esrl noaa gov psd 2 2 terrestrial water storage anomaly twsa from grace gravity recovery and climate experiment grace satellites launched in 2002 tapley et al 2004 measures the gravimetric departures caused by a combination of hydrological processes the estimates of twsa obtained subsequent to the elimination of atmospheric and oceanic influences along with the effects of solid earth tides from grace data solutions wahr et al 2004 chen et al 2005a b accounts for all stores of water above and underneath the land surface however grace satellites are incapable of identifying variations in the individual components of tws such as snow surface water or groundwater rather grace provides highly accurate estimates of column integrated variations in tws for a given region grace derived continuous gravimetric solutions have been instrumental in determining regional changes in groundwater storage famiglietti et al 2011 famiglietti 2014 castle et al 2014 soni and syed 2015 glaciers and ice sheets shepherd et al 2012 gardner et al 2013 and tws variations induced by hydrologic extremes like flood and drought morishita and heki 2008 long et al 2013 reager et al 2014 thomas et al 2014 sinha et al 2017 important contributions are also noted in the quantification of hydrologic fluxes such as river discharge syed et al 2010 and evapotranspiration seo et al 2009 syed et al 2014 we use the monthly jpl mascon solutions rl05m 1 v02 of land water storage from grace that is gridded 0 5 0 5 and scaled by the nasa jet propulsion laboratory following the methodology provided by landerer and swenson 2012 available at http grace jpl nasa gov this data includes all the latest post processing techniques which are detailed in watkins et al 2015 and wiese et al 2016 in this study we have utilized 157 months tws variations starting from april 2002 to april 2015 missing months in the dataset are replaced with the climatologic median of that particular calendar month the jpl rl05m grace mascon solution wiese et al 2016 is a unique framework that parameterizes the earth s gravity field into 3 equal area spherical cap mass concentrations mascons no post processing filters are required to remove the correlated errors in jpl rl05m grace mascon solution as it is diminished during the data inversion process watkins et al 2015 prior to the application of the two post processing algorithms to the solution corrections for glacial isostatic adjustment gia and earthquakes are applied the coastline resolution improvement cri filter isolates land and ocean mass inside the mascons along the coast lines it has been observed that within a mascon regions with skewed ratios of land to ocean area have lower efficiency of the cri filter thus caution must be taken while interpreting results within these mascons further jpl rl05m grace mascon solution does not require any smoothing filter as equal area 3 spherical cap mascons acts as an inherent smoothing function on the true gravity signal reducing signal strengths at spatial scales smaller than about 3 however implementation of the gridded scaling factors restores those lost signals despite the efficacy of the scaling factors limitations exist in their application to long term groundwater changes landerer and swenson 2012 the scaling factors provided with the jpl mascons are derived using the technique detailed in landerer and swenson 2012 note that as the mascons feature a 0 5 0 5 gridded resolution the land surface model community land model clm used to derive the scaling factors also offer 0 5 0 5 grids this facilitates the ability to generate a global set of 0 5 0 5 gridded scaling factors for continental hydrology by simple multiplication of the two fields which reallocates the mass inside each 3 mascon proportionally both the cri filter and scaling factors reduce the leakage errors effectively residual errors account for grace measurement errors plus the lost inter annual geophysical signals 2 3 self calibrated palmer drought severity index sc pdsi palmer 1965 formulated the pdsi in order to estimate moisture supply and demand within a two layer soil model using precipitation and temperature in order to improve the spatial comparability wells et al 2004 proposed a self calibrating pdsi sc pdsi by replacing the empirically derived fixed values of the climatic characteristic k and the duration factors 0 897 and 1 3 used by palmer 1965 which was based on data from the central united states with values automatically calculated using historical climatic data of a specific region in this study we utilize monthly self calibrated globally gridded 2 5 2 5 pdsi data http www esrl noaa gov psd for the period of april 2002 to december 2014 dataset used and the methodology applied to compute self calibrated pdsi is elaborated in dai et al 2004 and dai 2011 2 4 standardized precipitation index spi the standardized precipitation index spi mckee et al 1993 is a multivariate meteorological drought index based on probability distribution of precipitation spi values are dimensionless and are computed by fitting a gamma distribution function to precipitation values during the time month period here we have computed spi for the time scales of 1 month 3 month 6 month and 12 month using the ensemble mean of three different precipitation datasets i e gpcp cmap and prec l 2 5 standardized precipitation evapotranspiration index spei spei datasets 1 month spei 3 month spei 6 month spei and 12 month spei used here is directly obtained from institutional repository of the spanish national research council csic https digital csic es for the time period of april 2002 to december 2014 the spei is a multi scalar drought index based on two climatic parameters precipitation and potential evapotranspiration vicente serrano et al 2010 beguería et al 2010 spei has been computed utilizing global 0 5 gridded climate research unit cru ts3 monthly precipitation dataset available at http badc nerc ac uk browse badc cru data and potential evapotranspiration pe estimated using thornthwaite s method 2 6 standardized runoff index sri standardized runoff index is a multivariate hydrological drought index computed by fitting a lognormal distribution function to runoff estimates shukla and wood 2008 sri is very similar to spi and is also dimensionless in this study we have used the noah 2 dataset of gldas to compute sri estimates for the respective river basins studied here similar to spi and spei all the mentioned time scales of sri have been utilized in this study note that in this study 3 month 6 month and 12 month spi spei and sri is only utilized for assessing correlation with ccdi at different time scales 2 7 grace dsi grace dsi is a standardized drought severity index exclusively based on grace derived tws we have utilized monthly estimates of jpl mascon solutions rl05m 1 v02 of land water storage from grace to compute grace dsi following the algorithm provided in zhao et al 2017a 2 8 temperature here we have utilized the monthly global gridded station data of air temperature provided by the university of delaware the dataset is 0 5 gridded and is available for a period of january 1901 december 2014 the dataset only provides the temperature estimates for the land 3 overview of concept drought is one of the most intricate and least apprehended amongst all natural hazards hagman 1984 fundamental to the comprehension of drought is the ability to recognize its initiation and termination and to assess the characteristics of a drought event such as its intensity recovery time and spatial extent due to its complex nature association with numerous natural processes and human interventions a wide variety of drought indices utilizing various parameters have emerged over time heim 2000 keyantash and dracup 2002 mishra and singh 2010 what adds to the complexity of the problem is the lack of a standard definition and corresponding ground truth observations since drought is perceived by its effect on the various realms of the natural environment the criticality of the parameters used for the identification of drought events and the quantification of its severity is constantly argued upon in this study we combine deviations of precipitation and twsa grace based from their climatologic normal conditions to formulate a novel drought index precipitation being the only source of influx into the hydrological system its incorporation in the formulation of a drought index is crucial and thoroughly logical consideration of precipitation in a drought monitoring index is decisive because of its higher frequency variability in comparison to any other hydrologic variables vicente serrano et al 2010 also the effects of climate change are intuitively reflected in the variations of precipitation evidences of large scale change in patterns of precipitation have been found to be associated with climate change trenberth 2005 hence precipitation along with its high variability captures the impacts of climate change which is pivotal for exacerbating hydrological extremes like drought even though precipitation is a primary factor contributing to drought conditions the effect of drought is ultimately subjective to the status of water stored in the different land water storage components accordingly we include observations of twsa from grace in addition to precipitation in our consideration for devising a novel drought monitoring index moreover twsa incorporates the possible impacts of stress on water resources that are induced by increasing population and non sustainable utilization of water resources for economic growth as well as for ensuring food security this is especially true for india where groundwater storage is being depleted at an alarming rate rodell et al 2009 consequently the development and continuity of drought conditions can be considerably influenced by anthropogenic activities hence it is crucial to jointly consider the contributions from both precipitation and twsa while developing a holistic drought monitoring index the rationale behind combining the two concerned parameters is to encompass every aspect of drought that is either induced entirely by deficiencies in precipitation twsa or by partial contributions from both the relative contribution of these parameters in triggering a drought event is difficult to ascertain and will vary both in space and time depending on numerous hydroclimatological factors and it is not essential that precipitation and twsa must be correlated for the emergence of drought conditions syed et al 2008 has shown earlier that variations in twsa were differently correlated with precipitation and et in different latitudes furthermore even if there is no change in precipitation significant storage anomaly can be created due to anthropogenic activities e g groundwater extraction only in essence when a drought is recorded by our proposed index it is either due to deficit in precipitation and or in land water storage relative to normal conditions besides drought is a multiscalar phenomenon that involves response from various components of the hydrological system e g soil moisture groundwater surface water reservoirs to precipitation inputs at noticeably different time periods which may or may not even overlap changnon and easterling 1989 elfatih et al 1999 pandey and ramasastri 2001 vicente serrano et al 2010 precipitation has a higher frequency of variation operating over short time scales but this generates variable time scales of response in the hydrologic system for example soil moisture and river discharge generate shorter time scale variations while reservoir and deeper groundwater storage respond at much longer time scales therefore it is extremely important to incorporate these different time scales of response in order to identify drought conditions some of the existing drought indices e g spi and spei makes explicit consideration of these time scales based on the presumption that droughts have definite periods of cyclicity such as 3 6 9 12 months and has categorized drought accordingly mckee et al 1993 1995 vicente serrano and lópez moreno 2005 vicente serrano 2006 by making these assumptions it is in fact ignored that natural systems may respond differently with varying time and space however by combining variations in precipitation and twsa we will be able to capture the entire range of variations associated with the different components of terrestrial hydrology essentially the proposed index includes the effect of short term variations as well as tendencies trends through precipitation and lower frequency or long term variations through the incorporation of land water storage variations this combination thereby apprehends the multiscalar nature of drought without having to make explicit considerations for various types of droughts based on time scales overall the proposed index incorporates the role of water input precipitation and land water storage variations hence this novel index has the potential to identify intensification of drought severity in the context of reduced precipitation which may be due to a changing climate as well as escalating stress on the groundwater resources as a consequence of enhanced population demand in our consideration twsa and precipitation anomaly are represented in a relative manner which is with respect to normal climatologic conditions and that too using standardized units consequently it is independent of the relative contributions of precipitation and twsa also note that this index abides by the multitudinous definition keyantash and dracup 2002 of drought by acknowledging deviations in water input and responses of different natural components of the hydrologic system therefore the incorporation of twsa and precipitation estimates in the computation of a drought index is physically discernible practically applicable theoretically justified and an efficient way to encompass the multi temporal responses of a variety of natural system responding to drought conditions 4 methods 4 1 computation of ccdi in this study we propose a novel combined climatologic deviation index ccdi in order to characterize drought conditions over four major river basins of india by integrating the contributions of precipitation anomalies pa and terrestrial water storage anomalies twsa in contrast most prior studies have either considered below average precipitation guhathakurta 2003 or depletion in tws thomas et al 2014 as a measure of drought condition grace derived twsa comprises of mass change within the vertically integrated land water storage column therefore ccdi responds to variations in surface near surface and deeper groundwater storages however grace can neither differentiate between the contributions of individual storage component nor can it isolate the impact of human activity the rationale behind the present formulation is that a drought condition is not just a reflection of below normal precipitation or depleted tws but a culmination of both hence the contribution of hydrologic influx in terms of precipitation and prevailing hydrologic storage conditions terrestrial water storage anomaly are indispensable for assessing drought conditions therefore the decisive factor for the assertion of drought condition is the combined deviations incurred due to the joint impact of departures from normal precipitation amount and terrestrial water storage more precisely here we classify drought non drought condition on the basis of deviations from normal conditions climatologic quantified in terms of the combined impact of water influx and storage during a particular month furthermore drought being an obscure phenomenon a number of factors can be associated with the incidence of a particular drought event in order to quantify the impact of a drought event it is also essential to apprehend its actual emergence termination and intensity apart from precipitation which is the primary influx of water into the land system drought assessments based on deviations in runoff and et augments the possibility of under or over estimation of the magnitude and extent of a drought event this is because these parameters respond to water shortage conditions differently both in terms of magnitude and time scale hence instead of making explicit considerations of the above mentioned variables tws renders an integrated measure that imparts significant controls on the spatio temporal variations of et and runoff considering the discussed aspects the proposed index contends to be an improvement over the existing drought indices in this study we produced monthly time series of twsa by averaging grace observations over each of the four river basins shown in fig 1 the river basin mask was obtained from 0 5 0 5 globally gridded river basin mask of global terrestrial network for river discharge gtn r to demarcate the boundaries of major river basins in india http www bafg de grdc similarly we have produced basin averaged monthly times of precipitation which we took as an ensemble mean of different datasets 1 p a i p i p μ a precipitation anomaly pa time series is computed eq 1 as deviations of monthly precipitation pi values from its mean pµ of the study period and twsa is acquired directly from grace satellite solutions precipitation and storage provide distinct interesting information regarding the development and cessation of a drought event subsequently we computed the mean monthly climatology of pa paclim and twsa twsaclim for each river basin by taking the mean of all the values for each calendar month within the 13 year data span e g for the month of january the mean of all the 13 january months within the timeseries are evaluated eqs 2 and 3 this climatology is thus considered to represent normal conditions of all the inputs and storage for any particular month and hence serves as the standard for quantifying their deviations note that even though it is advisable to compute climatology on the basis of long term data here we are restricted by the limited availability of grace observations adopting proper datasets for deriving the proposed index is crucial in this study we aim at developing an index that qualifies to recognize different aspects e g meteorological hydrological of drought as well as drought events that differ in time scales precipitation has a pronounced connection with drought mccandless 2014 as it is the primary input in the hydrological cycle over a region bounded by topography moreover precipitation has high frequency variability both in space and time and hence possesses the potential to bring about immediate effect over a region at short time scales these episodic variations in precipitation are more likely to affect surface water storage components compared to those underneath the surface however absence of precipitation can initiate a meteorological drought that can later develop into agricultural or hydrological drought if scarcity of water continues grace derived twsa is distinct from precipitation in that it records the cumulative effect of persistent low precipitation that can happen over enduring drought events also there are times when these two signals are contradictory for example in spite of substantial precipitation hydrological drought can persist if precipitation fails to impact the subsurface storage thus a drought index should be capable of capturing the prolonged effect of storage deficit as well as respond to excessive or deficient spells of moisture input our consideration of joint variations in precipitation and twsa enables ccdi to encompass both of these aspects of comprehensive drought monitoring the residuals in pa pares and twsa twsares eqs 4 and 5 are combined to evaluate combined deviations cd eq 6 which is subsequently standardized in order to compute the combined climatologic deviation index ccdi eq 7 the standardization method involves removal of the mean cdµ of the timeseries from each of the monthly estimates and dividing it by the standard deviation of the timeseries cdσ hence ccdi has a zero mean and standard deviation of 1 2 p a j c lim j 1 12 p a i j n 3 tws a j c lim j 1 12 tws a i j n 4 p a i res p a i p a i j c lim 5 twsa i res twsa i twsa i j c lim 6 c d i p a i res t w s a i res 7 ccd i i c d i c d μ c d σ where n is the total count of each calendar month the subscript i varies from 1 to 157 months j for 1 to 12 representing each calendar month of a year µ for mean and σ for standard deviation the subscripts clim and res stands for climatology and residual timeseries respectively the drought categories of ccdi are derived using the threshold percentiles used in united states drought monitor usdm svoboda et al 2002 the drought categories are designated as d0 d1 d2 d3 and d4 which correspond to 30th 20th 10th 5th and 2nd percentiles respectively ccdi recognizes both dry and wet conditions and is detailed in table 1 note that the categorization of drought classes table 1 presented in this study is entirely based on the range of ccdi values obtained for the four major river basins of india discerning the characteristics of drought like onset recovery and severity is crucial for assessing the processes and impacts associated with a drought event wilhite 2000 mishra and singh 2010 here we have analysed the onset recovery and severity s of the drought events identified by ccdi over the four major river basins of india in order to inspect the acuteness of the drought events for this we have utilized the threshold level method yevjevich 1967 hisdal et al 2004 to identify the onset and recovery of a drought event in our assumption when ccdi falls on or below the threshold ccdi 0 28 level a drought event starts onset t 1 and it continues until the threshold ccdi 0 28 is again surpassed recovery t n severity s t is the measure of the acuteness of a drought event it is quantified as a product of the mean of the deficit m t in ccdi ccdi 0 28 of a particular drought event ccdi threshold and the duration t months through which the event persists t t yevjevich 1967 thomas et al 2014 sinha et al 2017 ccdi being dimensionless severity of drought events computed using ccdi also does not have any unit thus drought severity s is represented as 8 s t m t t t here t denotes occurrence of a specific drought event although the severity s of a drought event can only be estimated after its termination it can serve as a tool for inter comparison of drought events identified by other indices 4 2 trend analysis in order to the assess trends in the basin scale estimates of ccdi we have employed the modified mann kendall test hamed and rao 1998 before implementing the trend test the effects of autocorrelation and seasonality were removed by fitting a first order autoregressive ar 1 model and an annual and semi annual cycle modified mann kendall trend test also removes the impact of serial correlation in the time series hence the empirical significance levels of the modified test are more accurate than the nominal significance levels a non parametric trend estimate sen 1968 is first removed from the timeseries and the autocorrelation between the ranks of the observations rank correlation coefficient is a measure of correlation i e a number that shows how closely two sets of data are linked is calculated significant autocorrelations at 5 significance level or 95 confidence level are then utilized to assess the modified variance of the statistic the significance value p value of the test is calculated utilizing the variance 4 3 frequency analysis the concept of frequency in drought related studies is implemented to designate how many times drought events have affected a particular geographic location over a specific time period drought frequencies computed over long time periods are useful for a proper understanding of the hydrological system as well as for implementing precautionary measures for drought mitigation due to lack of data availability drought frequency computed and analyzed in this study is based on data for the period of april 2002 to april 2015 following potop and možný 2011 the frequency of droughts observed by ccdi is calculated as the ratio of n m for each of the river basins in the ratio n is the number of consecutive months with ccdi values less than zero and m is the total number of months of the study period note that we have only considered those consecutive months which exhibit ccdi 0 28 for a minimum span of 3 months 4 4 empirical orthogonal functions eof analysis empirical orthogonal function analysis is a multivariate statistical technique used to reduce the dimensionality of large datasets in order to reveal the dominant patterns of spatio temporal variability the advantage of eof analysis is that it accentuates the resemblance and dissimilarity in demonstrating the data which is difficult to analyze eofs has been extensively used in climate studies like determining rainfall patterns basalirwa et al 1999 aravena and luckman 2009 controls and patterns of hydrologic variables famiglietti et al 1995 syed et al 2004 trends dai 2011 and inter annual and inter decadal variability modes kawamura 1994 the primary goal of eofs obukhov 1947 fukuoka 1951 lorenz 1956 was to disintegrate a continuous space time field x t s where t and s indicates time and spatial location respectively and can be represented as 9 x t s k 1 m c k t u k s where m is the number of modes present x t s stands for the original time series as a function of time t and space s uk s show the spatial modes of the major factors which accounts for the temporal variations of z and ck t is the principal component that depicts the variations of the amplitude of each eof with time in essence eof analysis aims to create a new set of variables that apprehend most of the observed variance from the data by a linear combination of the original variables fundamental to the eof method is that the modes are orthogonal in its simplest formulation eof analysis is the computation of eigenvector and eigen value of a covariance or a correlation matrix computed from a group of original time series data where eigenvectors are the coefficient of orthogonal transformation and eigen values are variances of principal components the eigenvectors are often referred to as modes or loadings in practice most of the data variance is typically explained by the first few modes first two is considered in this study higher modes with small variance generally have noisy amplitude or loading patterns eof analysis aims to detect a relatively small number of independent variables which emanate almost as much as original information as possible without the redundancy in the dataset 5 results in order to assess the potential of the ccdi developed here it is compared and analysed in four major river basins of india these river basins i e ganga 861 452 sq km krishna 258 948 sq km godavari 312 812 sq km and mahanadi 141 589 sq km are diverse in terms of their area and geography together these basins comprise about 47 8 of the total geographic area of india a major part of these river basins viz ganga krishna godavari and mahanadi are covered with agricultural lands accounting for 65 57 75 86 59 57 and 54 27 of the total area respectively and is largely dependent on groundwater for irrigation shown in fig 2 are the timeseries of ccdi for the four major river basins of india here the solid green lines stand for ccdi red bands represent periods of major drought defined by ccdi values and confirmed by anecdotal reporting in india nraa 2013 here we assume that any dry spell continuing for three or more months will only be considered for drought characterization thomas et al 2014 intermittent wet spells within a dry spell sustaining three or less than three months will be assessed as a temporary anomaly within the persisting dry spell fig 2a shows the occurrence of four drought periods in ganga basin i e during oct 2007 may 2008 de1ganga feb 2009 may 2011 de2ganga feb 2012 may 2013 de3ganga and apr 2014 apr 2015 de4ganga in this study each of the drought events identified by ccdi is represented as de followed by the order of the drought event and having the name of the river basin in the superscript as for example the first drought event of ganga basin is represented as de1ganga apropos of the index de2ganga and de4ganga are characterized as d3 extreme drought conditions while de1ganga and de3ganga are representing d1 moderate and d4 exceptional drought conditions respectively de2ganga is the longest as well as the most severe drought event identified in the ganga basin persisting for 28 months and having a severity of 28 92 in fig 2b amongst the four drought events observed in krishna basin one is categorized as d4 exceptional drought while the other exhibits d2 severe drought conditions the longest drought spell and the highest severity amongst all the river basins continuing for 36 months de1krishna jul 2002 june 2005 is also observed in this region in the godavari basin fig 2c three drought spells are noted over the periods of july 2002 may 2003 de1godavari mar 2004 aug 2005 de2godavari and sep 2008 apr 2010 de3godavari with regards to ccdi de1godavari and de3godavari took 11 and 20 months to recover from the state of drought and are characterized as d4 exceptional and d3 extreme drought conditions respectively the longest drought period de3mahanadi observed in the mahanadi basin fig 2d extended for 30 months from oct 2008 mar 2011 with d4 exceptional drought intensity in addition two other drought events de1mahanadi and de2mahanadi indicating d4 exceptional drought conditions have also been identified in the region a detailed record of the drought events of all the four river basins are given in table s1 see supplementary material the timeseries of ccdi in ganga basin show decreasing annual trend of 0 08 yr 1 in contrast krishna godavari and mahanadi river basins show an increasing trend of 0 018 yr 1 0 06 yr 1 and 0 04 yr 1 respectively hence it is important to note that ccdi depicts continuously deteriorating drought condition in one of the major river basins which represents a significant portion of the entire country however ganga basin shows the highest monthly frequency of 0 41 while droughts in mahanadi basin are least frequent 0 35 the monthly drought frequencies in krishna and godavari basins are 0 39 and 0 31 respectively fig 3 demonstrates the comparison between monthly estimates of ccdi and other commonly used drought indices like grace dsi pdsi 1 month spi 1 month sri and 1 month spei in all the four river basins the comparison is restricted to the concurrent data period of april 2002 december 2014 direct comparison of different drought indices is complicated by the varied computational techniques and a wide range of values associated with the different categories of drought intensity to enable a meaningful comparison and to avoid contrariety in this study a collective representation of the intensities of various drought indices are made using a unified scale of drought categorization which is the united states drought monitor usdm in order to assign a common classification scheme z score standardization is applied to all the indices thus all the indices have a zero mean and standard deviation of one the distinguishing responses of ccdi to the hydrological extremes concede skilfully with the other indices compared here it is also important to recognize that because the formulation of ccdi incorporates impact of both influx and storage variations disparity in comportment with other indices are anticipated spi and spei are more sensitive to precipitation and evapotranspiration rates as a consequence high frequency variations are observed in their timeseries this can also be the possible reason behind the decent correlation of ccdi with spi and poor correlation with spei sri shows a better correlation with ccdi the justification behind this is the comparatively lower frequency variations in sri as because runoff relies on land water characteristics however it has been observed that ccdi has a gradual improvement in correlation values with spi and sri as the time scale of these indices increase see table s2 on the contrary correlation with spei remains poor regardless of the increase in its time scale amongst all the drought indices temporal variations of grace dsi are best correlated with ccdi the estimated correlation coefficients between ccdi and grace dsi are 0 94 p 0 05 0 88 p 0 05 0 89 p 0 05 and 0 86 p 0 05 for ganga krishna godavari and mahanadi river basins respectively the most likely reason behind the noted compatibility is the similarity in the utilization of grace data however unlike ccdi grace dsi does not include an explicit contribution from precipitation which exhibits a high degree of variability in space and time thus owing to the spatio temporal heterogeneity in precipitation estimates differences in ccdi and grace dsi would be more prominent over humid regions and smaller spatial scales in comparison to when they are averaged over large river basins and semi arid regions consequently ccdi will bear the advantage of being more effective in regions that exhibit greater variations in magnitude and intensity of precipitation the estimated correlation coefficients between ccdi and pdsi in ganga krishna godavari and mahanadi are 0 42 p 0 05 0 79 p 0 05 0 74 p 0 05 and 0 67 p 0 05 respectively although ccdi and pdsi are not highly correlated the fundamentals of computation of both the indices imply similitude fig 4 demonstrates the contrast in the drought characteristics of the events identified by ccdi pdsi and grace dsi due to the high frequency variations observed in spi spei and sri and their relatively poor correlation with ccdi this comparison is limited to pdsi and grace dsi only drought events identified by pdsi grace dsi and ccdi are shown in red black and blue colours respectively all of the drought events identified by ccdi in the four river basins are marked in the figure in ganga and krishna basins intensities of drought events identified by ccdi vary between d1 to d4 and d2 to d4 whereas for godavari and mahanadi basins the range extends from d3 to d4 it is also important to notice that there exists variation in the category of individual drought events identified by ccdi pdsi and grace dsi in each of the river basins for example de3godavari and de2mahanadi show d3 extreme drought and d4 exceptional drought categories while the corresponding drought events identified by pdsi grace dsi depict d1 d4 and d1 d3 drought categories respectively the onset month of each drought event is the initiation of each horizontal line in the x axis and its length signifies the recovery time of that particular drought event the position of the horizontal lines in the y axis marks the category of that drought event with respect to the usdm drought classification scheme while the onset of some of the drought events identified by ccdi is almost contemporaneous de3ganga de1krishna de1godavari and de3mahanadi with pdsi some of them are significantly different de4ganga de2krishna de3krishna de2godavari and de2mahanadi correspondingly an emergence of drought events like de3godavari and de2mahanadi are contemporaneous to few drought events identified by grace dsi however the recovery times severity and category of drought events identified by pdsi and grace dsi are immensely different from those identified using ccdi it is also evident that drought events identified by ccdi are also portrayed by pdsi as two separate drought events with different onset and recovery time besides there are a number of occasions when pdsi june 2002 january 2003 ganga september 2004 december 2004 ganga august 2006 january 2007 ganga and october 2011 june 2012 godavari exhibit drought condition while no drought is identified by ccdi the observed variability in the drought characteristics onset severity and recovery time and drought category of drought events by ccdi pdsi and grace dsi signifies the probable underestimation of the impact of a particular drought event as well as the actual drought conditions by the commonly used drought indices shown in fig 5 are the spatial patterns of ccdi precipitation and temperature averaged over individual drought periods in each of the river basins the primary objective here is to make a qualitative assessment of compatibility in the spatial distribution of drought non drought conditions with those of two most crucial hydrometeorologic variables associated with drought consequently the focus here is on the regions where there is correspondence amongst the variables rather than the individual pixel values the colour scale used for each of the parameters in all of the four river basins has also been modified accordingly all the maps in this plot are displayed in 0 5 degree gridded resolution and individual pixels are indicative of values averaged over the drought periods observed in each basin due to the lack of data contemporaneity the comparison is restricted to the time period of april 2002 and december 2014 in general the correspondence of ccdi with climatic variables like precipitation and temperature are more conspicuous in krishna and godavari river basins in comparison to ganga and mahanadi river basins in fig 5a scanty rainfall and high temperature impacts during de2ganga and de4ganga are successfully recorded by ccdi the central and south eastern part of ganga basin predominantly experienced the adverse effects of drought during de2ganga while in course of de4 ganga north western eastern and central part encountered the major drought effects during de4krishna in fig 5b almost the entire basin experienced drought condition except a few areas in the southern western and north eastern parts of krishna basin throughout de2krishna most intense drought is observed in the eastern central and northern parts of the basin although the northern and southern part of the basin encountered extensive drought condition during de1krishna the circumstances were drastic in the western proximities of the basin the mentioned context is nearly well supported by low precipitation and high temperature values in those areas in the godavari basin fig 5c during de1godavari the impact of drought was devastating almost the entire basin exhibited acute drought condition during de1godavari it is also evident that during de3godavari drought effects are profound mainly in the eastern central and northern sectors while western part of the basin witnessed relatively wet condition this is also apparent from the spatial plots of precipitation and temperature which skilfully ratifies the prevailing drought conditions similar characteristics are observed in the mahanadi basin fig 5d as well in which all the three drought events showed significant heterogeneity in their spatial structure the overall discrepancies noted here can perhaps be attributed to human induced changes in ccdi hence in river basin like ganga where human induced changes are prominent conformity with natural variables like precipitation and temperature are less conspicuous in contrast the spatial correspondence between ccdi and precipitation and temperature are significantly appreciable in krishna and godavari river basins fig 6 shows the spatial patterns of variability using empirical orthogonal function eof analysis of ccdi for the period of april 2002 till april 2015 fig 6a and 6b are the spatial patterns of the leading modes of eofs of monthly ccdi in the four river basins the variances covered by first second principal component over ganga krishna godavari and mahanadi basins are 47 8 22 6 64 9 13 73 3 11 4 and 78 9 10 5 respectively the areas shown in blue represent drying condition while the areas marked yellow are indicative of wetting condition this study illustrates the progression of the spatial patterns of variance of ccdi with time which imparts precious knowledge about the temporal evolution of the majority of the dynamic regions the spatial pattern of eof1 depicts that the eastern and western parts of ganga basin and central parts of the other three river basins have a high propensity to droughts in contrast central portions of ganga basin areas of eastern and north western krishna basin western godavari basin and southern mahanadi basin represent tendency towards wet conditions since this analysis in four river basins is done at local grid box level poor sampling of precipitation and the continuous withdrawal of groundwater from various parts of india may have also affected the grace measurements hence these could be probable reasons behind the sharp difference in drought intensities observed across the river basins the second mode eof2 are consistent with the teleconnection patterns like enso and indian ocean dipole iod which is further supported by the close correspondence observed between the time series of second principal component and nino 3 4 sst index and dipole mode index fig s1 therefore the two dominant eofs signify the two different modes of variability and are unrestrained by the dataset utilized 6 summary and conclusion in this study we develop a novel drought index combined climatologic deviation index ccdi which combines deviations in precipitation and terrestrial water storage from normal climatologic conditions to ascertain the effectiveness and applicability of the index it is evaluated over four major river basins in india the index ccdi aptly manifest it s potential to identify and monitor droughts over large river basins through a comprehensive assessment of the integrated hydrologic deficit as well as the tendency of wetting or drying represented by recent precipitation events results discussed here demonstrate and highlight the temporal variability of droughts in india with implications for better understanding of onset and termination of actual drought conditions results impart immense confidence on the potential of ccdi major drought events reported in each of the river basins correspond well with those characterized by ccdi this is irrespective of whether the drought event was persistent in all the basins e g drought of 2009 2010 or restricted to certain river basins as isolated events besides it is important to note that some of the drought events characterized by ccdi were not reported previously due to the lack of exhaustive measures that could capture the multi dimensionality of droughts based on combined deviations onset severity and recovery time of each of the drought events have been evaluated drought events recognized by ccdi are well endorsed by low precipitation and high temperature conditions observed in all of the four river basins this further corroborates the occurrence of drought events that are hydrometeorologically supported however the degree of spatial conformity between ccdi and temperature precipitation is more pronounced in some basins compared to others the reason behind this disparity can be imputed to the human induced and natural changes due to deficit in both precipitation and storage the spatial correspondence between ccdi and temperature precipitation are more conspicuous in the basins where combined deviations are primarily driven by natural processes whereas in river basins with more prolific human interference uniformity in the spatial variation of ccdi and natural variables like temperature and precipitation are poorly reconcilable a comparison of temporal consistency in basin averaged estimates of ccdi and other commonly used drought indices highlight important fundamental differences between them from this analysis it is evident that ccdi estimates averaged over large river basins are best correlated with that of grace dsi however the difference between these two indices would be more prominent when analyzed over regions with diverse hydro climatological conditions this is because averaging over larger river basin scales diminishes the contribution of precipitation which shows significant spatial heterogeneity the primary reason for the relatively low correlation between ccdi and other indices is their foundational difference while almost all the indices represent natural droughts only ccdi represents both natural and human induced drought occurrences furthermore most of the indices manifest near surface or meteorological condition while ccdi being a grace based index accounts for the entire vertical land water column including surface and subsurface components the computation of pdsi features a water budget approach unlike that of other indices which comprehend one or two parameters for drought assessment hence pdsi can be considered to be somewhat similar to ccdi in comparison to other indices which is duly reflected in the conformity between the two but pdsi does not incorporate contributions from the storage component in their computation which is critical for drought assessment it is also apparent that different indices respond differently to the same drought event for example some of the drought events identified by ccdi has even been depicted as wet periods by some of the indices a part of these discrepancies can be attributed to fundamental differences in their formulation and their inherent limitations for example while the computation of spi and sri involves precipitation and runoff respectively spei is based on the integration of precipitation and potential evapotranspiration on the other hand pdsi is computed using a number of water balance parameters this also explains why ccdi is better correlated with pdsi in comparison to spi spei and sri differences in drought categories onset and recovery identified by ccdi and grace dsi denote the significance of the fact that a drought condition is not just a reflection of below normal precipitation or depleted tws but an amalgamation of both therefore we suggest that ccdi could serve as an alternative and complementary metric for comprehensive drought characterization every new index is faced with the question of its efficacy over existing indices with respect to this we have to acknowledge that drought is resultant of the nexus between the anomalous behaviour of a number of factors hence it is obvious to appraise the intensity and severity of drought events by incorporating a multitude of factors instead of relying on a single parameter since the very definition of drought is multitudinous it would be exemplary if all the factors responsible for triggering droughts could be integrated for a proper understanding of the phenomenon in this regard the formulation of ccdi with a holistic consideration of terrestrial hydrology can be considered as a significant improvement that can firmly serve its purpose also note that the primary objective behind formulating ccdi is to develop a robust drought index incorporating a variety of hydrometeorologic factors responsible for its occurrence to enable holistic monitoring of drought over large spatial scales the choice of a drought index from a stakeholder s perspective may vary in accordance with the geographic location climatic conditions and the objective of using a drought index however ccdi will be particularly beneficial for assessing droughts over large regions but at smaller spatial scales as well as depending on the specific objective of the stakeholder the choice of a drought index may vary the patterns represented by the eofs successively explain most of the observed variability the first leading mode of ccdi portrays the spatial variability in terms of drying and wetting trends in various parts of the four river basins illustrated by lower and higher eigen values respectively the second mode represents the impact of enso on indian climate with significant drying during the el niño events which is further corroborated by the timeseries of pc 2 moreover the modes of variability concur with the reported droughts as well as the drought affected areas a detailed analysis of ccdi shows that krishna basin experienced the longest drought period of 36 months aug jul 2002 june 2005 amongst all the four river basins which was of exceptional drought category the godavari and mahanadi river basins encountered three drought spells amidst which the drought of oct 2008 mar 2011 in mahanadi basin lasted for 30 months trends in basin averaged timeseries of ccdi are observed to be consistently decreasing in ganga basin on the contrary an increasing annual trend is observed in krishna godavari and mahanadi river basins ccdi has several notable advantages over the existing drought indices despite the simplistic computation i e devoid of intensive numerical model simulation parameterization and calibration the index ccdi incorporates multiscalar characteristics of drought along with the ability to implicitly account for human induced effects on drought assessment most importantly the index efficiently determines the aggravation of drought severity by virtue of reduced precipitation probably due to climate change in addition to that from increasing stress on groundwater resources by virtue of growing demand for fresh water the index also guarantees robustness since it is potentially competent to apprehend the multiscalar nature of drought without making explicit computation of it at various time scales grace observations effectively represent monthly variations in column integrated land water storage and are practically ineffectual to apprehend the factors inducing changes in it hence the utilization of grace observations in ccdi accredits it to represent both natural and human induced drought occurrences unlike other commonly used drought indices the utilization of combined deviations as the computational basis of this index makes it physically interpretable and co relatable with the general perception of drought conditions which is in contrast to the implied inferences drawn from those based solely on hydrologic surrogates like precipitation evapotranspiration and runoff furthermore the inclusion of land water storage enables ccdi to refrain from getting biased by episodic and high frequency variations in hydrologic fluxes thus ccdi is a holistic metric that is capable of making comprehensive characterization of drought over large spatial scales moreover the efficacy of ccdi in comparison to other grace based indices will be high in regions of frequent rainfall variations than in dry areas where precipitation is scarce this is due to the fact that in dry regions where changes in precipitation are negligible variations in tws can be considered as the driving factor for drought occurrences moreover implementation of combined deviations also offers a more comprehensive assessment of actual drought characteristics like onset severity and recovery time which are often underestimated by commonly used drought indices errors in ccdi can be attributed to errors in precipitation as well as in twsa estimates from grace errors in individual precipitation datasets tend to average out as we have taken the mean of the three independent precipitation datasets error in precipitation further reduces when a spatial average over all the grids in each river basin is computed residual errors in grace tws can lead to underestimation of twsa values which can propagate to ccdi thereby causing underestimation of actual drought conditions this is particularly true for spatial representation of grace data in 0 5 0 5 grids using the scaling factor this is beacuse the scaling factors are essentially based on hydrologic model simulations that may not be able to capture neither the actual amplitude nor the full range of inter annual variations in twsa weise et al 2016 furthermore the inter annual variability caused by human activities may not be appropriately represented in the models used for the computation of scale factors nevertheless the application of scaling factor provides some information on spatial variability to the sub mascons while conserving the mass and mass trends of the individual mascons overall errors in precipitation are better constrained while errors in grace tend to increase with finer spatial and temporal resolution landerer and swenson 2012 accordingly the gridded 0 5 0 5 representation of drought shown in fig 5 should be interpreted with caution especially when quantifying how the ccdi values in individual pixels are changing in space readers must consider that individual pixel values of grace data reproduced in this 0 5 0 5 resolution using scaling factor are highly prone to errors that will propagate into ccdi values of each pixel however averaging ccdi values of each pixel over individual drought periods varying from months to years reduces the error to some extent therefore if the objective of the user is to analyze magnitudes of ccdi in each pixel it is highly recommended that computation of ccdi should be made in the native grace resolution i e 3 3 besides due to the limited temporal expanse of grace data most of the analysis including the computation of climatology had to be restricted to short periods only this could also impact the computation of deviations from normal hydrologic conditions which essentially forms the basis of ccdi computation however improvements and continuity in the grace dataset through the grace follow on http gracefo jpl nasa gov mission can significantly improve the efficacy of the index overall the ccdi is a novel index that is complementary and shows promising results further the ease of computation and availability of datasets utilized in public domain imparts universal applicability of the proposed index the results presented further demonstrate the ability of the proposed methodology to elucidate climatic extreme events like droughts and their comprehensive monitoring over regional to global scales furthermore in a country like india with diverse climatic conditions and differential rainfall amounts it is extremely necessary to employ a metric like ccdi that can quantify all the aspects of meteorologic agricultural and hydrologic droughts with regard to combined deviations the methodology presented here is expected to produce improved results with its implementation over regions with disparate hydro climatic characteristics and promote exploration of its applicability as an operational drought monitor for disaster management programs conflict of interest the authors declared that there is no conflict of interest acknowledgement we would like to thank the department of science and technology ministry of science and technology government of india for providing the funding for this research under the fast track programme project no sr ftp es 176 2010 g we also like to extend our gratitude towards the editor and the five anonymous reviewers whose comments have significantly improved the quality of the manuscript the authors also acknowledge ms sridevi jadav mr shashank bhusan and mr robin prince for their help and support during the course of this work a portion of this work was conducted at the jet propulsion laboratory california institute of technology under contract with nasa this work was supported by funding from the nasa grace science team appendix a supplementary material supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 02 053 appendix a supplementary material the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 
6592,among various stream temperature models those based on nonlinear regression frequently attract attention due to their simplicity and small number of required variables among such approaches the logistic regression model developed twenty years ago for weekly data is still widely used in various scientific studies that require quick and simple calculation of stream water temperature the model has been modified a number of times in recent years to capture the relationship between daily stream water temperatures air temperatures and discharge in this study we propose further modifications of the logistic regression model that do not require any additional variables that may be hard to measure the proposed models capture the relationship between the stream temperature and the declination of the sun the air temperature and the discharge from a number of recent observations the proposed approaches are tested on six rivers located in diverse orographic conditions of temperate climate zones of europe and usa although the proposed models remain very simple their performances are competitive against the performances of more advanced semi physical or data driven models keywords stream water temperature modelling logistic regression mohseni s model air2stream artificial neural networks model calibration 1 introduction various kinds of stream water temperature models have been developed so far ranging from physical ones dugdale et al 2017 that aim at a physical description of thermal and radiation fluxes between air bedrock and river body to data driven models benyahya et al 2007 that search for a relationship between river temperature and specific mainly hydro climatic variables without getting into physical processes at all physically based models sinokrot and stefan 1993 yearsley 2009 van vliet et al 2012 sun et al 2015 beaufort et al 2016 gallice et al 2016 kwon and koo 2017 are the best tools for stream temperature modelling in well monitored catchments however they often require information on a large number of predictors that are frequently unavailable apart from stream temperature forecasting see e g ouellet proulx et al 2017 and references therein stream temperature models are frequently needed to project the stream temperatures in future climatic conditions webb et al 2008 watts et al 2015 arora et al 2016 knouft and ficklin 2017 soto 2018 or to evaluate the water temperatures in rivers where it is not measured grabowski et al 2016 sohrabi et al 2017 jackson et al 2017 2018 in such cases the applicability of physically based models is limited and hence simpler models are needed in recent two decades a large number of data driven models have been proposed for stream temperature simulation including various forms of regression mohseni et al 1998 koch and grunewald 2010 grbic et al 2013 cole et al 2014 letcher et al 2016 sohrabi et al 2017 zhu et al 2019 the nearest neighbours approach st hilaire et al 2012 or shallow artificial neural networks ann chenard and caissie 2008 sahoo et al 2009 jeong et al 2013 hadzima nyarko et al 2014 piotrowski et al 2015 shi et al 2018 zhu et al 2018 alongside some regression based approaches are proposed to transfer the information on air and stream temperature models between catchments isaak et al 2012 jackson et al 2017 2018 however to be applicable to future climatic conditions or to streams where water temperature is currently not measured regression models cannot include autoregressive terms nor perform bias corrections various kinds of stream temperature models have been compared in many papers wehrly et al 2009 sahoo et al 2009 bustillo et al 2014 cole et al 2014 piotrowski et al 2015 kwak et al 2017 laanaya et al 2017 piotrowski and napiorkowski 2018 zhu et al 2018 arora et al 2018 zhu et al 2019 but although simple regression based models often perform poorly laanaya et al 2017 arora et al 2018 zhu et al 2019 there is no firm widely accepted conclusion on the superiority of specific models against all the others apart from linear regression probably the simplest among the water temperature models is the logistic regression model proposed twenty years ago by mohseni et al 1998 to describe the relationship between weekly data of stream and air temperatures interestingly despite its extreme simplicity and passing time the mohseni et al 1998 model is still widely used in numerous practical applications moreover contrary to the suggestion of mohseni et al 1998 researchers frequently use the model for daily water temperature data for example the basic mohseni et al 1998 model was used to evaluate daily water temperatures in a paper published in the nature journal thackeray et al 2016 which address the phenological sensitivity of atlantic salmon to climatic conditions the mohseni et al 1998 model was also used for monthly data by basarin et al 2016 to study trends and variability of water temperature in the danube river for daily data by brown et al 2016 to analyse the impact of temperatures of inflowing streams on water temperature in the yaquina estuary oregon usa for 7 day moving average data by buccola et al 2016 to project future water temperatures in the north santiam river oregon usa for daily data by meredith et al 2017 to find trends in both anchor ice prevalence and summer temperatures in the logan river utah usa for daily data by feng et al 2018 to study the thermal response of alpine rivers to heat waves or for daily data by shrestha et al 2018 to evaluate water temperatures needed to simulate trace metal dynamics in the zenne river belgium kamarianakis et al 2016 used the mohseni et al 1998 method as part of their mixed river temperature forecasting model in the study aimed at electric grid reliability of thermal power plants lubega and stillwell 2018 used the mohseni et al 1998 approach with parameters fitted to 14 day long moving average data to evaluate inlet water temperatures to the system of rivers in illinois usa payet burin et al 2018 used the mohseni et al 1998 model within their water power model of the iberian peninsula developed to evaluate the cooling requirements for thermal power plants in future climatic conditions trimmel et al 2018 used mohseni s et al 1998 model to evaluate maximum stream temperatures in the pinka river austria that were needed as upstream boundary conditions for modelling the impact of vegetation shading on the expected rise of stream temperatures in future climatic conditions niemeyer et al 2018 used the mohseni et al 1998 model to calculate the daily headwater temperature of streams inflowing into the river network system with multiple stratified reservoirs in the tennessee river basin usa as we may see from this short review the basic variant of the mohseni et al 1998 model developed 20 years ago is still widely applied in current studies that aim at making links between stream water temperatures and climate change the impact on organic biota or energy production somehow in parallel various modifications to the mohseni et al 1998 model have been proposed in numerous studies to improve its performance especially for daily data for which the basic mohseni et al 1998 model was not dedicated even though it is widely used van vliet et al 2011 added a linear relationship with runoff to the mohseni et al 1998 approach and proposed to consider the lag effect of the relationship between discharge and air temperature on one hand and stream temperature on the other in their approach the optimal lag time needs to be estimated independently for each river koch and grunewald 2010 proposed to use weighted mean air temperatures from recent observations as inputs to the mohseni et al 1998 logistic regression model instead of the concomittent or the most recent air temperature koch and grunewald 2010 tested various methods to set optimal weights for preceding air temperature measurements and to choose the number of recent measurements that are needed to obtain the best results they found that exponentially decreasing weights lead to the best performance and that the air temperatures from the last several days should be used in the weighted average the approach has been further developed by soto 2016 2018 who specified a detailed procedure of setting the exponential weights in another study kamarianakis et al 2016 proposed to divide the parameters of mohseni s et al 1998 model in two parts the first part representing fixed averaged over various locations model parameters and the second part representing site specific derivations from the averaged dynamics the present paper aims at modifying the mohseni et al 1998 logistic regression model to improve its performance for daily data our goal is to develop a very simple and widely applicable logistic regression model that does not require measurements of any additional variables apart from those already used in existing versions of the mohseni et al 1998 approach we seek models based on the mohseni et al 1998 approach that after calibration could perform similarly well for independent testing data as the more sophisticated semi physical or data driven models we assume that the models may be applied to study stream temperatures under future climatic conditions or to extrapolate stream temperature measurements for periods when it was not measured hence we do not consider autoregressive approaches in our research however we use information on the declination of the sun in our models as in piotrowski et al 2014 which is basically the simplest substitute for solar radiation as declination of the sun may be almost precisely evaluated for each location on earth and changes very slowly at a millennia scale it adds virtually no uncertainty and requires no measurements hence may be used at no costs improving the performance when logistic regression models are applied at moderate or higher latitudes the remaining sections of the paper are organized as follows we briefly discuss six catchments which serve as our study sites in section 2 in section 3 we present details of previous versions of the mohseni et al 1998 based logistic regression models introduce our modifications and briefly present other models used for comparison semi physically based air2stream toffolon and piccolroaz 2015 and data based anns haykin 1999 in section 4 we define the comparison criteria and calibration methods used section 5 is devoted to the choice of the best variants of each considered model and to the comparison between the performances of various logistic regression models semi physical air2stream and data based anns finally section 6 concludes the paper 2 study sites and data the present study is based on data collected from six catchments located in temperate climate zones of usa poland and switzerland between 43 n and 54 n the brief description of each catchment is given in table 1 the catchments are located in both lowland mountainous and high mountain areas with different frequencies of snowy conditions and different variability of air and stream temperatures we use time series of daily data that are at least 9 years long in the case of all catchments but one biala tarnowska poland we use measurements from a single hydrological and relatively closely located single meteorological station in the case of the biala tarnowska catchment the air temperature measurements from various locations across the catchment see table 1 for details were averaged into the lumped air temperature data by the thiessen polygons method thiessen and alter 1911 the data from each catchment were chronologically divided into the calibration and testing sets see table 1 for details on each set testing sets are composed of roughly the last 1 3 of the data and are not used during calibration of the models at all the final comparison between the performances of the models is based on these testing data 3 methods in this section we present historical variants of mohseni et al 1998 based logistic regression models section 3 1 the new versions of logistic regression model section 3 2 and semi physical and data based models used for comparison section 3 3 3 1 variants of logistic regression models 3 1 1 basic logistic regression model logr1 mohseni et al 1998 the basic logistic regression model proposed by mohseni et al 1998 for weekly data relates the stream water temperature with air temperature by using the following equation 1 t i s a b a 1 exp c d t i a where t i s is the stream water temperature at time i t i a is the air temperature at time i the only input variable and a b c and d are four model parameters note that we use different notation than mohseni et al 1998 to simplify representation that will be used also for the newly proposed variants representing the lower a and upper b bound of water temperature the slope at inflection point of logistic regression c and the air temperature at inflection point d the parameter c may be estimated as mohseni et al 1998 2 c 4 tan θ b a however as the angle θ still needs to be found eq 2 does not change the number of unknown parameters and we may search for c directly nonlinear parameters need to be calibrated to data by some optimization procedure frequently one among variants of newton s based method press et al 1990 3 1 2 modified logistic regression model 2 logr2 van vliet et al 2011 in many studies the daily relationship between air and stream temperatures are of interest for which the basic mohseni et al 1998 model does not perform well in order to be better suited to daily data the mohseni et al 1998 model has been modified by van vliet et al 2011 who introduced inverse linear relationship with discharge q i which become the second input variable such that 3 t i s a b a 1 exp c d t i l a g 1 a e q i l a g 1 and proposed that the relationship between the stream temperature and the two input variables will be described with the time lag denoted as l a g 1 for which the performance of the model is the best van vliet et al 2011 suggested to search for the best lag1 value between 0 and 20 days but in the present study tests with lag1 higher than 5 turned out to be unnecessary we use the notation lag1 to point out that we choose only the value from a single day among recent measurements and distinguish it from the cases when all recent lag measurements e g measurements from 0 to lag recent days are considered for modelling for example in our notation lag1 3 means that only measurement collected 3 days ago is used and lag 3 means that measurements taken at the current day 0 1 2 and 3 days ago are used note that in the van vliet et al 2011 model eq 3 e is the fifth parameter to be calibrated 3 1 3 modified logistic regression model 3 logr3 koch and grunewald 2010 soto 2016 koch and grunewald 2010 proposed a different modification to the mohseni et al 1998 model they kept a similar equation to mohseni et al 1998 4 t i s a b a 1 exp c d t i aw but instead of t i a air temperature measured at the day i they related stream temperature to weighted average t i aw of a number of observations denoted as lag of air temperature precedent to day i they checked various numbers of lag days and various ways of determining the weights associated with particular measurements koch and grunewald 2010 found that best results are obtained with lag set to several days catchment dependent and with exponential weights used for weighted averaging of air temperatures collected at recent lag days the t i aw is evaluated as 5 t i aw j 0 lag w j t i j a the weights wj attributed to particular days sum up to unity koch and grunewald 2010 and are here determined according to the procedure similar to that described by soto 2016 6 w t 0 1 w t j w t j 1 exp f j j 1 l a g w j w t j 0 lag w t j where f is another apart from a b c and d parameter of the model that is to be calibrated 3 2 new modifications of logistic regression models logistic regression models discussed in section 3 1 keep the number of parameters limited to 4 or 5 such parameters have clear physical meaning however apart from the van vliet et al 2011 variant basic versions of such models e g mohseni et al 1998 koch and grunewald 2010 and soto 2016 consider only the relationship between stream and air temperatures which is hardly sufficient arismendi et al 2014 the high cost of such an approach is a lack of knowledge on thermal relationships between stream temperature air temperature and discharge in recent time steps and what is not less important the declination of the sun 3 2 1 new logistic regression model 1 nlogr1 koch and grunewald 2010 claimed that they found little if any correlation between water temperature and discharge hence they do not include any term related to q i however one may easily include the relationship based on van vliet et al 2011 to the koch and grunewald 2010 version such that 7 t i s a b a 1 exp c d t i aw e q i w where q i w is the weighted average of recent lag measurements of discharge using the same weights w i that were determined for the air temperature in eq 6 3 2 2 new logistic regression model 2 nlogr2 more importantly radiation fluxes often have significant impact on stream temperatures mohseni and stefan 1999 but are frequently unmeasured however instead of radiation measurements we may always consider the relationship between the stream temperature and the declination of the sun for example in a logistic manner as with the air temperature this information may be important especially for catchments located in higher latitudes where the amount of thermal fluxes connected with radiation is to some degree a function of the declination of the sun to distinguish early spring and late summer processes we may also consider the difference in the declination of the sun between two recent consecutive days piotrowski et al 2014 hence the following modification to the koch and grunewald 2010 model may be suggested 8 t i s a b a 1 exp c d t i aw e q i w g 1 exp h k d s i l 1 exp m n d d s i where d s i and dd s i are the declination of the sun at day i and the difference in declination of the sun in two consecutive days i and i 1 respectively both proposed variants eqs 7 and 8 retain the simplicity of the koch and grunewald 2010 approach and keep the number of parameters low moreover the declination of the sun is readily evaluated for each location on earth without any measurements and discharge has already been used in the van vliet et al 2011 variant therefore both models do not require any additional measurements or costs than previous logistic regression models 3 2 3 new logistic regression model 3 nlogr3 our final idea is the extension of the mohseni et al 1998 model eq 1 in a similar way as the model given in eq 8 the new model may be evolved as a series of logistic functions with respect to the air temperature and linear functions with respect to the discharge measurements at different time lags and include the relationship with the declination of the sun the extended multiple logistic regression model created may be defined as 9 t i s a g 1 exp h k d s i l 1 exp m n d d s i j 0 lag b j 1 exp c j d j t i j a e j q i j where a g h k l m n b0 blag c0 clag d0 dlag e0 elag are model parameters t i a is the air temperature observed at day i q i is the discharge observed at day i j is a dummy variable attributed to lag and d s i and dd s i are the declination of the sun at day i and the difference in the declination of the sun in the two recent consecutive days i and i 1 respectively choosing the proper number of recent daily measurements lag is important for model performance from previous studies van vliet et al 2011 koch and grunewald 2010 soto 2016 we may expect that using information on daily temperatures and possibly discharges from at least several recent days may be profitable hence in section 5 we will study the impact of the choice of lag on model performance considering 30 different lag values in this study all considered variants of the logistic regression models are calibrated by means of the levenberg marquardt algorithm marquardt 1963 hagan and menhaj 1994 although this is a local search algorithm it is quick and often sufficient to find a good solution to this particular optimization problem 3 3 competitive semi physical and data driven models the performance of simple logistic regression approaches needs to be verified against other kinds of models we have chosen three kinds of data driven and semi physical models for comparison linear regression ann and air2stream 3 3 1 linear regression model linr linear regression models are the simplest data based methods to evaluate stream water temperature based on external variables they have been applied in a large number of studies see discussion and references in caissie 2006 and more recent applications in krider et al 2013 kamarianakis et al 2016 jackson et al 2017 here we test the following version of a linear regression model 10 t i s a 1 a 2 d s i a 3 d d s i j 0 lag a 4 j t i j a a 5 l a g j q i j because the relationship between variables is linear we consider a large range of lag values between 0 and 29 days as only linear parameters are used in the model their values are determined by the least squares approach using the calibration data only see section 2 and table 1 for a definition of the calibration set on each considered river 3 3 2 shallow artificial neural networks ann shallow artificial neural networks ann haykin 1999 are more advanced data driven models that have found numerous applications in various scientific disciplines including the simulation of water temperature in rivers sahoo et al 2006 2009 chenard and caissie 2008 daigle et al 2009 mckenna et al 2010 jeong et al 2013 hadzima nyarko et al 2014 piotrowski et al 2015 rabi et al 2015 liu et al 2016 temizyurek and dadaser celik 2018 zhu et al 2019 we add the word shallow to anns to distinguish them from deep neural networks that have become famous for image recognition or speech processing in recent years lecun et al 2015 but are not applicable to our tasks although various ann types exist zhang 2018 the most popular multi layer perceptron neural networks with three layers and a logistic activation function perform well in hydrological studies shamseldin et al 2002 including river temperature modelling to use ann first a vector of input x and output ts variables must be chosen classical multi layer perceptron ann consists of three layers haykin 1999 zhang 2018 an input hidden and output one each layer contains a pre set number of processing entities so called nodes the number of input nodes in i e the number of nodes in the input layer equals the number of input variables however there is no widely accepted method of choosing which variables to use in ann and this choice is often done by trial and error the number of hidden nodes hn also have to be evaluated empirically wang et al 2015 but the number of output nodes equals the number of output variables in our case 1 the stream temperature for clarity we mark the vector of observed values of stream temperature by tso contrary to the simulated ones ts in this study we include within input variables the most recent observations of d s i dd s i and q i those observed at day i but the number of recent air temperature measurements lag in t i j a j 0 lag needed to be evaluated empirically together with the number of hidden nodes hn we test 15 different lag values i e lag 0 14 and 10 hn values i e hn 1 10 using higher lag and hn would lead to over parameterized anns evaluating the number of input variables in for a specific lag is hence straightforward as in 4 l a g 4 because we have fixed three input variables d s i dd s i and q i and t i j a considered starts from j 0 for example if lag 2 the input vector x i that is used to compute stream temperature for i th date t i s by ann is composed of x i 1 d s i x i 2 d d s i x i 3 q i x i 4 t i a x i 5 t i 1 a x i 6 t i 2 a after specifying input variables output variables and the numbers of nodes in and hn in ann all input variables are linearly scaled to a 0 1 interval by setting x ik x ik x maxk x maxk x mink where xmaxk and xmink are the maximum and the minimum values of k th input variable respectively the value of the scaled output is computed by ann as 11 t i s v 0 j 1 hn v j 1 exp w j 0 k 1 in w kj x ik where v and w are matrixes of ann parameters that are to be calibrated finally by re scaling of t i s simulated values of stream temperatures are obtained as t i s t min so t i s t max so t min so such re scaled t i s values are then used to evaluate the performance of the model anns are calibrated by means of the levenberg marquardt algorithm with the mean square error mse as an objective function see eq 14 in section 4 for details we must note here however that anns are general approximators hornik et al 1989 for which overfitting i e fitting the model not only to the signal but also to the noise present in the data does occur geman et al 1992 prechlet 1998 and may be harmful when using the calibrated model for previously unseen data as the effect of overfitting may also seriously affect the performance of anns for hydrological data piotrowski and napiorkowski 2013 some methods to avoid it must be used here we use a classical and often efficient early stopping approach based on prechlet s 1998 work when applying anns the calibration data set is divided into two non overlapping sub sets so called training sub set composed of chronologically the first 2 3 of measurements included in the calibration set and validation sub set composed of the remaining 1 3 of measurements included in the calibration set during ann calibration the steps of the calibration algorithm are based solely on derivatives and objective function values mse computed for the training data set however mse values for the validation set are also computed even though they are not used by the calibration algorithm and the solution set of ann parameters with the lowest value of the objective function mse found so far for the validation data is remembered after calibration this remembered solution with the lowest mse for the validation sub set is considered the best and applied to the testing data this way the effect of overfitting is diminished as data on which the final choice of the best solution is done are not used by the optimization algorithm during calibration the testing set for which the final opinion on the model performance is given is fully independent of training and validation data and is exactly the same as in the case of other models considered in this study 3 3 3 air2stream model the semi physical air2stream model toffolon and piccolroaz 2015 is based on lumped heat budget exchange between an unknown volume of water in the river its tributaries and atmosphere 12 ρ c p v d t w dt a h ρ c p i q i t w i q t w where v is an unknown volume of water of river reach with surface area a and water temperature tw ρ is the water density with specific heat capacity at constant pressure cp h is a net heat flux between air and water qi is a discharge from i th water source either tributary or groundwater with water temperature twi q is a discharge below tributaries and t is time the eq 12 is parameterized and simplified in the air2stream model toffolon and piccolroaz 2015 to 13 d t w dt 1 θ a 4 a 1 a 2 t a a 3 t w θ a 5 a 6 cos 2 π t t y a 7 a 8 t w θ q q q t 2 t 1 1 t 1 t 2 q t d t where ta is an air temperature ty is a duration of the year in the same units as t hence in days in this study θ is the dimensionless streamflow q is a reference value averaged over the time series from t1 to t2 in this study over the whole calibration set and a1 a8 are model parameters following toffolon and piccolroaz 2015 eq 13 is solved by the 4th order runge kutta method and the modelled negative stream temperatures are set to 0 c as water temperature observed on the first day is used as the initial condition the 30 day warm up period is set tw simulations for the first 30 days are not used to compute objective function values the model has been discussed in more detail and successfully compared with other approaches in toffolon and piccolroaz 2015 and piccolroaz et al 2016 its sensitivity to the calibration method has been studied in piotrowski and napiorkowski 2018 as shown in toffolon and piccolroaz 2015 the simplified 7 parameter version of the air2stream model with a 4 0 may perform not worse than the full 8 parameter version for many catchments although proposed only recently the air2stream model has already found numerous practical applications in hydrological and biological studies casas mulet et al 2016 fenocchi et al 2017 raman vinna et al 2018 cai et al 2018 arora et al 2018 4 methodology of model comparison and calibration in this study the performance of three well known logistic regression models three newly proposed logistic regression models and three semi physical and data driven models are compared namely 1 classical mohseni et al 1998 logistic regression logr1 eq 1 2 van vliet et al 2011 modification of the mohseni et al 1998 model logr2 eq 3 3 koch and grunewald 2010 modification of the mohseni et al 1998 model with exponential weights based on soto s 2016 method logr3 eqs 4 and 6 4 the koch and grunewald 2010 approach with added relationship with discharge as in van vliet et al 2011 the exponential weights are applied to both air temperature and discharge nlogr1 eq 7 5 the koch and grunewald 2010 approach with added relationship with discharge as in van vliet et al 2011 and with added relationship with declination of the sun nlogr2 eq 8 6 the logistic regression model with a series of logistic functions nlogr3 eq 9 7 the linear regression model with air temperature discharge and declination of the sun used as input variables linr eq 10 8 artificial neural networks ann their multi layer perceptron variant with a logistic activation function used in a hidden layer ann eq 11 9 the semi physical air2stream model air2stream eq 13 for all considered models the mean square error is used mse as an objective function during calibration 14 mse 1 n i 1 n t i s t i so 2 where t i so is an observed value of stream temperature at day i t i s is a simulated value of stream temperature for day i and n is the number of days used in a particular set calibration or testing in the case of ann models we divide the calibration set into training and validation sub sets hence n may also count the number of observations in each sub set parameters of the linear regression model are set by the least squares approach which yields a unique optimal solution all logistic regression and ann models are calibrated by means of the levenberg marquardt algorithm marquardt 1963 hagan and menhaj 1994 with up to 400 iterations and numerical approximation of derivatives the levenberg marquardt algorithm has turned out to be very successful in hydrological applications see adamowski and karapataki 2010 however in the case of the air2stream model derivative free approaches are needed we use a global optimization algorithm namely differential evolution storn and price 1997 see das et al 2016 opara and arabas 2019 for an excellent recent reviews on differential evolution in general variant based on covariance matrix learning and bimodal distribution parameter setting called cobide wang et al 2014 the selected algorithm turned out to be the best choice in research aimed at searching for the most effective calibration method of this model piotrowski and napiorkowski 2018 all control parameter settings of cobide are the same as discussed in piotrowski and napiorkowski 2018 evolutionary algorithms to which cobide belongs are global search methods i e are capable of searching for the global best solution contrary to derivative based methods but as a result they require a much longer calibration time than some other optimization algorithms posik et al 2012 especially gradient or hessian based methods like the levenberg marquardt algorithm as the performance of evolutionary algorithms highly depends on the allowed number of function calls piotrowski et al 2017 for air2stream we set this number to 20 000 in this study as in piotrowski and napiorkowski 2018 for calibration of the models for each river only calibration data sets are used note that as discussed in more detail in section 3 3 2 in the case of the ann model calibration data are divided into training and validation sub sets to allow the early stopping approach to be applied to prevent ann from overfitting as we use highly different models for comparison the range of their parameters from which initial solutions are to be sampled when optimization algorithms are initialized do differ in the case of logistic regression models we use different ranges for initialization of different parameters see table 2 such ranges are generally based on the results obtained by mohseni et al 1998 in their initial research in the case of the ann model as discussed in section 3 3 2 we generate initial parameters from 0 1 interval in the case of the air2stream model we used the same range of parameters as in piotrowski and napiorkowski 2018 see table 2 these ranges are based on the toffolon and piccolroaz 2015 suggestion provided in their fortran code link available in the toffolon and piccolroaz 2015 paper note that when calibrating air2stream parameters cobide searches for the air2stream solutions only within the bounds that are the same as initialization ranges of its parameters contrary to the levenberg marquardt algorithm in which the search is unbounded for both the ann and logistic regression models as the levenberg marquardt algorithm which is used for ann and logistic regression models is a local search procedure that may be trapped in a local optimum we repeat optimization of each model for every river 50 times with different randomly generated initial solutions then from these 50 runs we choose the 30 best solutions according to the mse for the calibration data set and compute the mean performance of the particular model for the calibration and testing data according to these 30 selected solutions we call it mse30 further in the paper this allows us to skip some poor solutions found if the levenberg marquardt algorithm got stuck in the local optimum as we reject the 20 poorest out of 50 runs before we compute the mean performance to avoid inconsistency in comparison among models the same procedure is used for the air2stream model even though it is calibrated by the global search algorithm in the case of linear regression we obtain a single best solution by means of the least squares approach for each river hence the above procedure would give the same solution as a single fit however although mean or root mean square errors are widely used to compare various stream temperature models chenard and caissie 2008 wehrly et al 2009 sahoo et al 2009 koch and grunewald 2010 grbic et al 2013 jeong et al 2013 bustillo et al 2014 piotrowski et al 2015 letcher et al 2016 laanaya et al 2017 kwak et al 2017 zhu et al 2018 arora et al 2018 it do not account for the number of model parameters hence as a second way of choosing the best approach both the best variant of the particular model and the overall best model in this study akaike information criterion aic akaike 1973 is used we apply a version of aic developed for the least squares approach which is defined as burnham and anderson 2002 15 aic n ln mse 2 k where n is the number of data in our case the number of days used for calibration k is the number of model parameters 1 and mse is the mean square error from eq 14 as with mse the smaller the value of aic the better the model is to compare different models or variants of the same model we compute aic30 in the same way as mse30 by averaging the 30 best aic values out of 50 repetitions however as comparisons based on mse and aic are performed independently and aic depend on the number of model parameters k the best 30 cases according to aic may not be the same as the best 30 cases according to mse note also that depending on the model the number of parameters may vary for different variants for example in the case of ann or nlogr3 or may be fixed for all variants as in the case of logr1 or nlogr2 however even if the number of parameters in each variant of the model is fixed still mse30 may point at slightly different variants than aic30 this is because when computing aic the value of ln mse is used not mse hence after averaging over 30 values of a particular criteria the same model variant will not necessarily be chosen as the best one according to mse30 and aic30 5 results and discussion before we compare the performance of the proposed modified logistic regression models against other approaches we have to choose the best configuration of each considered model the exception is the logr1 approach mohseni et al 1998 that has just a single variant the choice for the best configurations of a particular model are made twice by independently comparing mse30 and aic30 criteria 5 1 logr2 model configurations to use the logr2 model van vliet et al 2011 eq 3 the number of lag days lag1 must be chosen by trial and error for each catchment we test the logr2 model with lag1 set to values between 0 and 5 the mse30 and aic30 see section 4 for the definition values for the calibration and testing data sets are given in table 3 the number of parameters is fixed for each variant logr2 model has 5 parameters hence k that appears in eq 15 equals 6 we find that low lag1 values 0 or 1 depending on the catchment lead to the best results irrespectively of whether mse30 or aic30 are considered we choose the values that perform best on the calibration data set bolded in table 3 in further comparisons interestingly for five out of six catchments the variants that performed best for the calibration data were also the best for the testing set only in the case of the cedar river was a choice other than the one based on the calibration data set marginally better but the difference was of no practical meaning we also observe that the inappropriate choice of lag1 may highly affect the results 5 2 logr3 model configurations in the logr3 model koch and grunewald 2010 see eqs 4 6 one needs to choose the number of recent daily measurements of air temperature lag that is used to compute the weighted average we have tested this model with 30 different lag values between 0 and 29 the number of parameters is fixed for each variant k 6 the mse30 and aic30 results obtained for the calibration and testing data are shown in fig 1 we see that for each considered stream the model performance initially improves when daily air temperatures from additional recent days are added however when the lag value exceeds 10 days no clear improvement is observed and results for the testing data may even deteriorate when lag becomes too large as shown in table 4 the best values of lag chosen according to the calibration data set highly depends on the catchment and vary from 4 to 27 however it makes almost no difference whether mse30 or aic30 is used as a criterion 5 3 nlogr1 model configurations the nlogr1 model with k 7 see eq 7 was developed by adding the relation with discharge as in van vliet et al 2011 to the logr3 model koch and grunewald 2010 we consider lag between 0 and 29 the overall relationship between the model performance and lag time in days is almost identical for the nlogr1 and logr3 models see fig 2 and table 4 irrespective of which criteria mse30 or aic30 are used 5 4 nlogr2 model configurations in the nlogr2 model with k 13 eq 8 we add discharge and the declination of the sun to koch and grunewald s 2010 model logr3 this makes the relationship between the number of considered lag days again tested between 0 and 29 and the model performance slightly more complicated see fig 3 in the case of the nlogr2 model for five out of six catchments the best results are obtained when the number of lag days is not smaller than 20 the irondequoit creek is an exception where the optimal lag value equals 12 the same best lag values are determined by both the mse30 and aic30 criteria it means that information on the declination of the sun often allows the model to effectively benefit from a larger number of recent air temperature measurements 5 5 nlogr3 model configurations the performance of the nlogr3 model eq 9 also depends on the number of recent measurements of air temperature and discharge the number of parameters differ for each variant and is related with the lag value such that k 7 4 l a g 1 hence k varies from 11 to 127 we again consider lag values between 0 and 29 visually see fig 4 in all catchments apart from the fanno creek the improvement for both calibration and testing data is observed with increasing lag values until data from at least 15 recent days are considered the best results for calibration data are obtained with even larger lag values between 24 and 29 according to mse30 and between 15 and 29 according to aic30 see table 4 interestingly the best lag values found by mse30 and aic30 differ for only two rivers located in gentle landscapes the fanno creek and to much smaller degree the irondequoit creek importantly according to fig 4 model performance for the testing data often does not deteriorate with higher lag values irrespective of whether the mse30 or aic30 criterion is used the suprasl river is an exception and in half of the testing cases the biala tarnowska river the dischmabach river or the irondequoit creek it even keeps improving hence the large number of model parameters often does not harm performance of the model and information on air temperatures and discharges even from the entire recent month may be beneficial 5 6 linr model configurations according to the mse criterion when the least squares approach is used to fit the linear regression model to calibration data the more variables used the better the performance or in the worst case scenario equal performance is obtained hence one cannot choose the best set of input variables for the linear regression model based on the mse for calibration data this choice may only be done according to criteria that consider a number of parameters aic in this study or subjectively in fig 5 we show the relationship between the values of mse and aic obtained for the specific variant of the linear regression model and the number of recent days from which air temperature and discharge data are used for calibration clearly for calibration data mse decreases when lag is increasing for testing data such improvement ceased to be clearly visible for lag values larger than 10 even though using larger lags does not harm the performance however contrary to mse the values of aic do not constantly improve with increasing lag values even for the calibration set specific lag values chosen according to aic for calibration data are given in table 4 in the case of the suprasl river the best lag is as low as 5 but for other catchments it varies between 19 and 29 as a choice based on the mse we decided subjectively to set lag to 20 for each river note also that as a single best solution is always determined by the least squares approach for the linear model fitted to a specific calibration data set there is no need to perform a number of repetitions hence we do not discuss mse30 or aic30 here as it would be equal to the mse and aic from a single solution respectively 5 7 ann model configurations the choice of ann configuration is more difficult as we have to consider both the optimal value of lag that is related with the number of ann inputs in see section 3 3 2 and the optimal number of hidden nodes hn we test all possible combinations of ann variants with lag 0 14 lag 0 means that only the current day is considered and hn 1 10 the number of parameters for each ann is related to the number of hidden nodes and lag values such that k 2 2 h n l a g 4 h n k varies from 8 to 202 the results are given graphically in figs 6 9 where mse30 and aic30 values for the calibration and testing data are shown the best ann structures chosen for each catchment according to the mse30 and aic30 criteria computed for calibration data are given in table 5 note that although in figs 6 9 a different scale is used for each catchment and criterion the scale is kept the same for calibration and validation sets of a particular catchment and criterion this allows verification of whether the performance obtained for the testing and calibration data differs note also that the worst results are sometimes truncated to allow a better view of the differences between different good lag and hn configurations although during ann training the calibration data were divided into training and validation sub sets see section 3 3 2 for discussion and justification we do not discuss the performance for these sub sets separately as they are not important for comparison against logistic regression models we observe that ann architectures chosen according to the mse30 and aic30 criteria computed for the calibration data sets often differ the cedar river is the exception in some cases seriously in the case of the suprasl and dischmabach rivers with the exception of the cedar river anns chosen according to aic30 are smaller than those chosen according to mse30 for half of the catchments namely the suprasl fanno creek and dischmabach rivers the ann variants chosen according to mse30 perform noticeably poorer mse30 for the testing data differs by more than 10 on the testing data than anns chosen according to aic30 in the case of other three catchments the differences are marginal the choice of the right ann configuration is a well known problem related with overfitting but this is not the subject of the present study interested readers are referred to geman et al 1992 prechlet 1998 liu et al 2008 piotrowski and napiorkowski 2013 or perez sanchez et al 2018 here we may only note that contrary to what was observed for other tested models in the case of anns aic30 criterion leads to more appropriate choices of model architecture it chooses smaller anns that overall perform better on independent data than the mse30 5 8 air2stream model version as discussed in section 3 3 2 the simplified 7 parameter version of the air2stream model may perform competitively to the full version of air2stream with 8 parameters toffolon and piccolroaz 2015 hence we test both air2stream versions with 7 and 8 parameters the results are given in table 6 it may be seen that according to the calibration data the version with 8 parameters performs either slightly better or almost equally to the version with 7 parameters irrespectively of whether mse30 or aic30 are compared the results are however more disputable for the testing data the 8 parameter version of air2stream performs hugely better than the version with 7 parameters for the biala tarnowska river and a bit better for the dischmabach river however the version with 7 parameters marginally outperforms the 8 parameter version for the irondequoit creek and the cedar river in the case of the remaining two rivers there is barely any difference nonetheless as the models have to be chosen according to the calibration data we use the full air2stream version with 8 parameters in further parts of the study 5 9 comparison between new logistic regression approaches and other stream temperature models the choices of specific variants of each model by means of the mse30 and aic30 criteria have been discussed in sections 5 1 5 8 results obtained from the variants of particular models chosen according to mse30 are summarized in tables 7 10 tables 7 and 8 present comparisons between variants of models chosen according to the mse30 criterion for the calibration table 7 and testing table 8 data the choice of variants of models were obviously based on the calibration data only however in some cases the best possible performance of a specific model may differ from the 30 run averaged value hence in tables 8 and 9 we show the lowest mse found for the calibration and the lowest mse found for the validation data out of 50 runs of the chosen variant of a particular model the results from variants chosen according to the aic30 criteria are given in tables 11 14 as variants of the models chosen according to aic30 may differ from those selected according to mse30 the whole comparison is repeated we choose the variant of each model according to aic30 but to make results comparable with the choices reported in tables 7 10 in tables 11 12 we show two different criteria computed for the chosen variant aic30 and mse30 consequently in tables 13 and 14 we show the best mse and the best aic from 50 runs of the chosen variant of the model even though some differences are observed we may note the high compatibility between comparisons based on aic30 and mse30 let us first discuss the performance of historical logistic regression models irrespective of which criteria are used for both the calibration and testing data the logr3 logistic regression model koch and grunewald 2010 performs far better than the historical logr1 mohseni et al 1998 or logr2 van vliet et al 2011 models on each stream this means that using information on air temperatures that occurred in recent days is always advantageous the performance of the logr3 model koch and grunewald 2010 may be improved for each catchment and data set by the proposed nlogr2 model which is basically a logr3 approach with added information on the discharge and the declination of the sun see eq 8 this advantage must be attributed in large part to the declination of the sun as when it is skipped in the nlogr1 model see eq 7 the improvement over the logr3 approach koch and grunewald 2010 is either much weaker or not observed at all the discussed results are independent of the criteria used mse30 aic30 best aic or best mse from 50 runs surprisingly on the testing data the nlogr2 model is outperformed by the basic linear regression linr on two according to aic30 or three according to mse30 out of six streams the fanno creek the cedar river and only when comparison is based on aic30 the dischmabach creek see tables 8 and 12 which is not a great result it may be even more surprising that the basic mohseni et al 1998 model logr1 that is as discussed in the introduction so frequently used in practical applications is outperformed by linear regression on each catchment irrespective of which criteria or data set are used our third proposed logistic regression model nlogr3 which includes information on the declination of the sun air temperatures and discharge values from a number of recent days eq 9 performs better than all historical variants of logistic regression or the nlogr1 model nlogr3 is also better than the other recently proposed model nlogr2 but not on every river out of the two models nlogr3 or nlogr2 the one to choose depends on the data and assumed criteria as nlogr2 that has much fewer parameters than nlogr3 performs relatively better when akaike information criterion is used for selection nlogr3 performs better against linr than nlogr2 does but for the testing data it is still outperformed for the fanno creek see tables 8 and 12 and only when aic30 is considered the cedar river skipping simple regression models the newly proposed nlogr3 approach eq 9 turns out slightly better or at least competitive against the semi physical air2stream model for the calibration data the new nlogr3 model is better than air2stream on four or five out of six streams depending on the criterion used for the testing data according to mse30 the nlogr3 model clearly outperforms air2stream on three lowland or hilly streams the fanno creek the irondequoit creek and the suprasl river and performs just marginally poorer on two mountainous ones the dischmabach creek and the cedar river the only river on which air2stream clearly outperforms the new approach is the mountainous biala tarnowska river see table 8 what may be due to the high complexity of reasons causing stream temperature variations in rivers in southern poland zelazny et al 2018 that hamper the performance of simple data based models when aic30 is used for comparison results from the nlogr3 model are less encouraging as due to the larger number of parameters it loses to air2stream on 4 rivers winning on only two however the version with a smaller number of parameters nlogr2 performs better winning against air2stream on three rivers when aic30 is used comparisons with anns are not encouraging for all tested models including the two new ones nlogr3 and nlogr2 irrespective of whether mse30 or aic30 are considered for both the calibration and testing data a properly determined version of ann outperforms both new approaches on five out of six catchments according to mse30 the new models are better only for the suprasl river see table 8 when aic30 values are compared only nlogr2 outperforms ann on this catchment interestingly on the fanno creek ann although much better than all other nonlinear models turns out to be inferior to linear regression when the testing data are considered 5 10 discussion based on the results given above can the new approaches nlogr2 and nlogr3 eqs 8 and 9 we skip nlogr1 here as it is clearly outperformed by the two be considered useful for practical applications let us discuss this in a few points 1 among the two new models nlogr3 performs better than nlogr2 on most rivers but the difference depends to some extent on the criteria used for comparison if we use mse30 in which case the number of parameters is not considered nlogr3 outperforms nlogr2 on 5 rivers and loses just marginally on the sixth however according to aic30 which takes into account the number of parameters nlogr3 is better on four catchments but nlogr2 is better on two others lowland ones hence both models may have some merit but nlogr3 would be the first bet 2 the nlogr3 model performs much better than the historical logistic regression models despite the fact that it does not require any additional variables that may be hard to obtain although nlogr3 has many parameters this neither hinders calibration by means of the levenberg marquardt algorithm nor negatively affects the performance on the testing data sets when mse30 is used as a comparison criterion however when aic30 is used opinion on the performance of nlogr3 model is automatically affected by the large number of parameters hence if the number of parameters is considered a problem nlogr2 is an alternative that outperforms all historical logistic regression models using a relatively small number of parameters 3 when mse30 is used for comparison both newly proposed models nlogr3 and nlogr2 outperform the semi physical air2strem model on lowland or hilly rivers but perform poorer on mountainous rivers when aic30 is considered this is still true for nlogr2 model but not necessarily for nlogr3 such results do not allow one to claim that the new approaches are better than air2stream but they are at least competitive alternative 4 both newly proposed models are inferior to anns if the ann configuration is properly chosen according to our results there is no doubt about that however choosing the correct ann configuration requires a large amount of pre computations to be done for each river separately as can be seen from figs 6 9 an ad hoc chosen ann variant may perform much poorer than the newly proposed model to summarize we may say that the two newly proposed models nlogr3 and nlogr2 eqs 9 and 8 may be useful for simple and quick calculations of stream temperatures that do not require much additional work they also perform favourably against a semi physical model on lowland or hilly catchments and on any type of catchments they lead to much more accurate results than the historical mohseni et al 1998 model that is still widely used in practice 6 conclusions in the present study new variants of the logistic regression model have been proposed for the stream temperature simulation on daily data the proposed approaches do not need any additional measurements than those already used by logistic regression models proposed by mohseni et al 1998 van vliet et al 2011 koch and grunewald 2010 or soto 2016 performance of the two newly proposed models nlogr3 eq 9 and nlogr2 eq 8 is encouraging both models are very simple and use information on air temperature and discharge from a number of recent days as well as the declination of the sun as input variables however they differ significantly in the number of parameters the nlogr2 model has 13 parameters the number of parameters of nlogr3 depends on the number of recent measurements considered and is often much larger nonetheless despite the large number of parameters for testing data that are independent from calibration nlogr3 performs much better than the former logistic regression models and in most cases it is also better than the nlogr2 model the six catchments on which models are tested are located in temperate climatic conditions in the northern hemisphere between 43 n and 54 n but in highly different orographic conditions spanning from flat lowlands to highly mountainous catchments the catchment areas of selected streams vary between 40 and 1000 km2 among the six considered streams two are lowland and flat one is covered by gentle hills two are mountainous in the upper part and relatively flat in the lower part with highly different climatic conditions and one is located in the high mountains the only feature of the proposed nlogr3 and nlogr2 models that needs to be chosen by the user is the number of recent daily measurements of air temperature and discharge this is relatively easily done by performing a number of calibrations for various numbers of recent days in this study from 0 when only the current measurements are considered to 29 and choosing this number for which the mean performance of the model is the best according to the calibration data this choice may be based on criteria that do not consider the number of parameters like mean square error similar approaches have been widely applied in the literature for various logistic regression models koch and grunewald 2010 van vliet et al 2011 soto 2016 or by criteria that explicitly account for the number of parameters like akaike information criterion akaike 1973 both ways are tested in this study however to calibrate logistic regression models gradient based calibration procedures are classically used which search for the local optima some such local optima may be very poor hence we skip a number of the poorest solutions when the mean performance of the model over a number of repeated calibrations is computed it turns out that in the vast majority of cases there is basically very little difference in the number of lag days chosen according to mean square errors and the akaike information criterion the chosen number of recent days considered for the newly proposed model have been successfully validated on the calibration independent data wide scale comparison between the proposed nlogr2 and nlogr3 models and 1 a number of other logistic regression variants mohseni et al 1998 koch and grunewald 2010 van vliet et al 2011 soto 2016 2 simple linear regression 3 a more advanced data driven model namely multi layer perceptron artificial neural networks ann that have been widely used in the literature chenard and caissie 2008 sahoo et al 2009 jeong et al 2013 hadzima nyarko et al 2014 piotrowski et al 2015 shi et al 2018 temizyurek and dadaser celik 2018 and 4 a recently proposed semi physical air2stream model that has already found numerous applications casas mulet et al 2016 fenocchi et al 2017 raman vinna et al 2018 cai et al 2018 arora et al 2018 have been conducted on the chosen six streams the choice of the best variants of competing methods were also based on both mean square error and the akaike information criterion it turned out that with the exception of anns both criteria point at similar variants of models however in the case of anns akaike information criterion often chooses smaller networks than mean square error and such choices are confirmed by slightly better performance on independent testing data sets overall if properly chosen the ann model turned out to be the best approach on four out of six streams although the newly proposed models turned out generally inferior to anns they perform slightly better or at least not worse than the semi physical air2stream model and much better than other logistic regression variants in comparison with the air2stream model the proposed approaches turned out especially well suited for lowland rivers considering the relative simplicity of our newly proposed approaches in comparison with air2stream and anns and the susceptibility of the ann model to the choice of its architecture and the high risk of ann overfitting to noise present in the sample geman et al 1992 prechlet 1998 piotrowski and napiorkowski 2013 perez sanchez et al 2018 the proposed approach may be considered as an easily applicable and relatively well performing alternative to more complicated models conflict of interest the authors declare that they have no conflict of interest acknowledgment the research published in this paper has been financed from the national science centre poland grant number 2016 21 b st10 02516 2017 2020 authors are very grateful to dr marco toffolon and dr sebastiano piccolroaz for making the fortran code of the air2stream model widely available on the web page authors are very grateful to dr scott jackson from the institute of molecular biology and biophysics eth zurich for his help in language editing and corrections 
6592,among various stream temperature models those based on nonlinear regression frequently attract attention due to their simplicity and small number of required variables among such approaches the logistic regression model developed twenty years ago for weekly data is still widely used in various scientific studies that require quick and simple calculation of stream water temperature the model has been modified a number of times in recent years to capture the relationship between daily stream water temperatures air temperatures and discharge in this study we propose further modifications of the logistic regression model that do not require any additional variables that may be hard to measure the proposed models capture the relationship between the stream temperature and the declination of the sun the air temperature and the discharge from a number of recent observations the proposed approaches are tested on six rivers located in diverse orographic conditions of temperate climate zones of europe and usa although the proposed models remain very simple their performances are competitive against the performances of more advanced semi physical or data driven models keywords stream water temperature modelling logistic regression mohseni s model air2stream artificial neural networks model calibration 1 introduction various kinds of stream water temperature models have been developed so far ranging from physical ones dugdale et al 2017 that aim at a physical description of thermal and radiation fluxes between air bedrock and river body to data driven models benyahya et al 2007 that search for a relationship between river temperature and specific mainly hydro climatic variables without getting into physical processes at all physically based models sinokrot and stefan 1993 yearsley 2009 van vliet et al 2012 sun et al 2015 beaufort et al 2016 gallice et al 2016 kwon and koo 2017 are the best tools for stream temperature modelling in well monitored catchments however they often require information on a large number of predictors that are frequently unavailable apart from stream temperature forecasting see e g ouellet proulx et al 2017 and references therein stream temperature models are frequently needed to project the stream temperatures in future climatic conditions webb et al 2008 watts et al 2015 arora et al 2016 knouft and ficklin 2017 soto 2018 or to evaluate the water temperatures in rivers where it is not measured grabowski et al 2016 sohrabi et al 2017 jackson et al 2017 2018 in such cases the applicability of physically based models is limited and hence simpler models are needed in recent two decades a large number of data driven models have been proposed for stream temperature simulation including various forms of regression mohseni et al 1998 koch and grunewald 2010 grbic et al 2013 cole et al 2014 letcher et al 2016 sohrabi et al 2017 zhu et al 2019 the nearest neighbours approach st hilaire et al 2012 or shallow artificial neural networks ann chenard and caissie 2008 sahoo et al 2009 jeong et al 2013 hadzima nyarko et al 2014 piotrowski et al 2015 shi et al 2018 zhu et al 2018 alongside some regression based approaches are proposed to transfer the information on air and stream temperature models between catchments isaak et al 2012 jackson et al 2017 2018 however to be applicable to future climatic conditions or to streams where water temperature is currently not measured regression models cannot include autoregressive terms nor perform bias corrections various kinds of stream temperature models have been compared in many papers wehrly et al 2009 sahoo et al 2009 bustillo et al 2014 cole et al 2014 piotrowski et al 2015 kwak et al 2017 laanaya et al 2017 piotrowski and napiorkowski 2018 zhu et al 2018 arora et al 2018 zhu et al 2019 but although simple regression based models often perform poorly laanaya et al 2017 arora et al 2018 zhu et al 2019 there is no firm widely accepted conclusion on the superiority of specific models against all the others apart from linear regression probably the simplest among the water temperature models is the logistic regression model proposed twenty years ago by mohseni et al 1998 to describe the relationship between weekly data of stream and air temperatures interestingly despite its extreme simplicity and passing time the mohseni et al 1998 model is still widely used in numerous practical applications moreover contrary to the suggestion of mohseni et al 1998 researchers frequently use the model for daily water temperature data for example the basic mohseni et al 1998 model was used to evaluate daily water temperatures in a paper published in the nature journal thackeray et al 2016 which address the phenological sensitivity of atlantic salmon to climatic conditions the mohseni et al 1998 model was also used for monthly data by basarin et al 2016 to study trends and variability of water temperature in the danube river for daily data by brown et al 2016 to analyse the impact of temperatures of inflowing streams on water temperature in the yaquina estuary oregon usa for 7 day moving average data by buccola et al 2016 to project future water temperatures in the north santiam river oregon usa for daily data by meredith et al 2017 to find trends in both anchor ice prevalence and summer temperatures in the logan river utah usa for daily data by feng et al 2018 to study the thermal response of alpine rivers to heat waves or for daily data by shrestha et al 2018 to evaluate water temperatures needed to simulate trace metal dynamics in the zenne river belgium kamarianakis et al 2016 used the mohseni et al 1998 method as part of their mixed river temperature forecasting model in the study aimed at electric grid reliability of thermal power plants lubega and stillwell 2018 used the mohseni et al 1998 approach with parameters fitted to 14 day long moving average data to evaluate inlet water temperatures to the system of rivers in illinois usa payet burin et al 2018 used the mohseni et al 1998 model within their water power model of the iberian peninsula developed to evaluate the cooling requirements for thermal power plants in future climatic conditions trimmel et al 2018 used mohseni s et al 1998 model to evaluate maximum stream temperatures in the pinka river austria that were needed as upstream boundary conditions for modelling the impact of vegetation shading on the expected rise of stream temperatures in future climatic conditions niemeyer et al 2018 used the mohseni et al 1998 model to calculate the daily headwater temperature of streams inflowing into the river network system with multiple stratified reservoirs in the tennessee river basin usa as we may see from this short review the basic variant of the mohseni et al 1998 model developed 20 years ago is still widely applied in current studies that aim at making links between stream water temperatures and climate change the impact on organic biota or energy production somehow in parallel various modifications to the mohseni et al 1998 model have been proposed in numerous studies to improve its performance especially for daily data for which the basic mohseni et al 1998 model was not dedicated even though it is widely used van vliet et al 2011 added a linear relationship with runoff to the mohseni et al 1998 approach and proposed to consider the lag effect of the relationship between discharge and air temperature on one hand and stream temperature on the other in their approach the optimal lag time needs to be estimated independently for each river koch and grunewald 2010 proposed to use weighted mean air temperatures from recent observations as inputs to the mohseni et al 1998 logistic regression model instead of the concomittent or the most recent air temperature koch and grunewald 2010 tested various methods to set optimal weights for preceding air temperature measurements and to choose the number of recent measurements that are needed to obtain the best results they found that exponentially decreasing weights lead to the best performance and that the air temperatures from the last several days should be used in the weighted average the approach has been further developed by soto 2016 2018 who specified a detailed procedure of setting the exponential weights in another study kamarianakis et al 2016 proposed to divide the parameters of mohseni s et al 1998 model in two parts the first part representing fixed averaged over various locations model parameters and the second part representing site specific derivations from the averaged dynamics the present paper aims at modifying the mohseni et al 1998 logistic regression model to improve its performance for daily data our goal is to develop a very simple and widely applicable logistic regression model that does not require measurements of any additional variables apart from those already used in existing versions of the mohseni et al 1998 approach we seek models based on the mohseni et al 1998 approach that after calibration could perform similarly well for independent testing data as the more sophisticated semi physical or data driven models we assume that the models may be applied to study stream temperatures under future climatic conditions or to extrapolate stream temperature measurements for periods when it was not measured hence we do not consider autoregressive approaches in our research however we use information on the declination of the sun in our models as in piotrowski et al 2014 which is basically the simplest substitute for solar radiation as declination of the sun may be almost precisely evaluated for each location on earth and changes very slowly at a millennia scale it adds virtually no uncertainty and requires no measurements hence may be used at no costs improving the performance when logistic regression models are applied at moderate or higher latitudes the remaining sections of the paper are organized as follows we briefly discuss six catchments which serve as our study sites in section 2 in section 3 we present details of previous versions of the mohseni et al 1998 based logistic regression models introduce our modifications and briefly present other models used for comparison semi physically based air2stream toffolon and piccolroaz 2015 and data based anns haykin 1999 in section 4 we define the comparison criteria and calibration methods used section 5 is devoted to the choice of the best variants of each considered model and to the comparison between the performances of various logistic regression models semi physical air2stream and data based anns finally section 6 concludes the paper 2 study sites and data the present study is based on data collected from six catchments located in temperate climate zones of usa poland and switzerland between 43 n and 54 n the brief description of each catchment is given in table 1 the catchments are located in both lowland mountainous and high mountain areas with different frequencies of snowy conditions and different variability of air and stream temperatures we use time series of daily data that are at least 9 years long in the case of all catchments but one biala tarnowska poland we use measurements from a single hydrological and relatively closely located single meteorological station in the case of the biala tarnowska catchment the air temperature measurements from various locations across the catchment see table 1 for details were averaged into the lumped air temperature data by the thiessen polygons method thiessen and alter 1911 the data from each catchment were chronologically divided into the calibration and testing sets see table 1 for details on each set testing sets are composed of roughly the last 1 3 of the data and are not used during calibration of the models at all the final comparison between the performances of the models is based on these testing data 3 methods in this section we present historical variants of mohseni et al 1998 based logistic regression models section 3 1 the new versions of logistic regression model section 3 2 and semi physical and data based models used for comparison section 3 3 3 1 variants of logistic regression models 3 1 1 basic logistic regression model logr1 mohseni et al 1998 the basic logistic regression model proposed by mohseni et al 1998 for weekly data relates the stream water temperature with air temperature by using the following equation 1 t i s a b a 1 exp c d t i a where t i s is the stream water temperature at time i t i a is the air temperature at time i the only input variable and a b c and d are four model parameters note that we use different notation than mohseni et al 1998 to simplify representation that will be used also for the newly proposed variants representing the lower a and upper b bound of water temperature the slope at inflection point of logistic regression c and the air temperature at inflection point d the parameter c may be estimated as mohseni et al 1998 2 c 4 tan θ b a however as the angle θ still needs to be found eq 2 does not change the number of unknown parameters and we may search for c directly nonlinear parameters need to be calibrated to data by some optimization procedure frequently one among variants of newton s based method press et al 1990 3 1 2 modified logistic regression model 2 logr2 van vliet et al 2011 in many studies the daily relationship between air and stream temperatures are of interest for which the basic mohseni et al 1998 model does not perform well in order to be better suited to daily data the mohseni et al 1998 model has been modified by van vliet et al 2011 who introduced inverse linear relationship with discharge q i which become the second input variable such that 3 t i s a b a 1 exp c d t i l a g 1 a e q i l a g 1 and proposed that the relationship between the stream temperature and the two input variables will be described with the time lag denoted as l a g 1 for which the performance of the model is the best van vliet et al 2011 suggested to search for the best lag1 value between 0 and 20 days but in the present study tests with lag1 higher than 5 turned out to be unnecessary we use the notation lag1 to point out that we choose only the value from a single day among recent measurements and distinguish it from the cases when all recent lag measurements e g measurements from 0 to lag recent days are considered for modelling for example in our notation lag1 3 means that only measurement collected 3 days ago is used and lag 3 means that measurements taken at the current day 0 1 2 and 3 days ago are used note that in the van vliet et al 2011 model eq 3 e is the fifth parameter to be calibrated 3 1 3 modified logistic regression model 3 logr3 koch and grunewald 2010 soto 2016 koch and grunewald 2010 proposed a different modification to the mohseni et al 1998 model they kept a similar equation to mohseni et al 1998 4 t i s a b a 1 exp c d t i aw but instead of t i a air temperature measured at the day i they related stream temperature to weighted average t i aw of a number of observations denoted as lag of air temperature precedent to day i they checked various numbers of lag days and various ways of determining the weights associated with particular measurements koch and grunewald 2010 found that best results are obtained with lag set to several days catchment dependent and with exponential weights used for weighted averaging of air temperatures collected at recent lag days the t i aw is evaluated as 5 t i aw j 0 lag w j t i j a the weights wj attributed to particular days sum up to unity koch and grunewald 2010 and are here determined according to the procedure similar to that described by soto 2016 6 w t 0 1 w t j w t j 1 exp f j j 1 l a g w j w t j 0 lag w t j where f is another apart from a b c and d parameter of the model that is to be calibrated 3 2 new modifications of logistic regression models logistic regression models discussed in section 3 1 keep the number of parameters limited to 4 or 5 such parameters have clear physical meaning however apart from the van vliet et al 2011 variant basic versions of such models e g mohseni et al 1998 koch and grunewald 2010 and soto 2016 consider only the relationship between stream and air temperatures which is hardly sufficient arismendi et al 2014 the high cost of such an approach is a lack of knowledge on thermal relationships between stream temperature air temperature and discharge in recent time steps and what is not less important the declination of the sun 3 2 1 new logistic regression model 1 nlogr1 koch and grunewald 2010 claimed that they found little if any correlation between water temperature and discharge hence they do not include any term related to q i however one may easily include the relationship based on van vliet et al 2011 to the koch and grunewald 2010 version such that 7 t i s a b a 1 exp c d t i aw e q i w where q i w is the weighted average of recent lag measurements of discharge using the same weights w i that were determined for the air temperature in eq 6 3 2 2 new logistic regression model 2 nlogr2 more importantly radiation fluxes often have significant impact on stream temperatures mohseni and stefan 1999 but are frequently unmeasured however instead of radiation measurements we may always consider the relationship between the stream temperature and the declination of the sun for example in a logistic manner as with the air temperature this information may be important especially for catchments located in higher latitudes where the amount of thermal fluxes connected with radiation is to some degree a function of the declination of the sun to distinguish early spring and late summer processes we may also consider the difference in the declination of the sun between two recent consecutive days piotrowski et al 2014 hence the following modification to the koch and grunewald 2010 model may be suggested 8 t i s a b a 1 exp c d t i aw e q i w g 1 exp h k d s i l 1 exp m n d d s i where d s i and dd s i are the declination of the sun at day i and the difference in declination of the sun in two consecutive days i and i 1 respectively both proposed variants eqs 7 and 8 retain the simplicity of the koch and grunewald 2010 approach and keep the number of parameters low moreover the declination of the sun is readily evaluated for each location on earth without any measurements and discharge has already been used in the van vliet et al 2011 variant therefore both models do not require any additional measurements or costs than previous logistic regression models 3 2 3 new logistic regression model 3 nlogr3 our final idea is the extension of the mohseni et al 1998 model eq 1 in a similar way as the model given in eq 8 the new model may be evolved as a series of logistic functions with respect to the air temperature and linear functions with respect to the discharge measurements at different time lags and include the relationship with the declination of the sun the extended multiple logistic regression model created may be defined as 9 t i s a g 1 exp h k d s i l 1 exp m n d d s i j 0 lag b j 1 exp c j d j t i j a e j q i j where a g h k l m n b0 blag c0 clag d0 dlag e0 elag are model parameters t i a is the air temperature observed at day i q i is the discharge observed at day i j is a dummy variable attributed to lag and d s i and dd s i are the declination of the sun at day i and the difference in the declination of the sun in the two recent consecutive days i and i 1 respectively choosing the proper number of recent daily measurements lag is important for model performance from previous studies van vliet et al 2011 koch and grunewald 2010 soto 2016 we may expect that using information on daily temperatures and possibly discharges from at least several recent days may be profitable hence in section 5 we will study the impact of the choice of lag on model performance considering 30 different lag values in this study all considered variants of the logistic regression models are calibrated by means of the levenberg marquardt algorithm marquardt 1963 hagan and menhaj 1994 although this is a local search algorithm it is quick and often sufficient to find a good solution to this particular optimization problem 3 3 competitive semi physical and data driven models the performance of simple logistic regression approaches needs to be verified against other kinds of models we have chosen three kinds of data driven and semi physical models for comparison linear regression ann and air2stream 3 3 1 linear regression model linr linear regression models are the simplest data based methods to evaluate stream water temperature based on external variables they have been applied in a large number of studies see discussion and references in caissie 2006 and more recent applications in krider et al 2013 kamarianakis et al 2016 jackson et al 2017 here we test the following version of a linear regression model 10 t i s a 1 a 2 d s i a 3 d d s i j 0 lag a 4 j t i j a a 5 l a g j q i j because the relationship between variables is linear we consider a large range of lag values between 0 and 29 days as only linear parameters are used in the model their values are determined by the least squares approach using the calibration data only see section 2 and table 1 for a definition of the calibration set on each considered river 3 3 2 shallow artificial neural networks ann shallow artificial neural networks ann haykin 1999 are more advanced data driven models that have found numerous applications in various scientific disciplines including the simulation of water temperature in rivers sahoo et al 2006 2009 chenard and caissie 2008 daigle et al 2009 mckenna et al 2010 jeong et al 2013 hadzima nyarko et al 2014 piotrowski et al 2015 rabi et al 2015 liu et al 2016 temizyurek and dadaser celik 2018 zhu et al 2019 we add the word shallow to anns to distinguish them from deep neural networks that have become famous for image recognition or speech processing in recent years lecun et al 2015 but are not applicable to our tasks although various ann types exist zhang 2018 the most popular multi layer perceptron neural networks with three layers and a logistic activation function perform well in hydrological studies shamseldin et al 2002 including river temperature modelling to use ann first a vector of input x and output ts variables must be chosen classical multi layer perceptron ann consists of three layers haykin 1999 zhang 2018 an input hidden and output one each layer contains a pre set number of processing entities so called nodes the number of input nodes in i e the number of nodes in the input layer equals the number of input variables however there is no widely accepted method of choosing which variables to use in ann and this choice is often done by trial and error the number of hidden nodes hn also have to be evaluated empirically wang et al 2015 but the number of output nodes equals the number of output variables in our case 1 the stream temperature for clarity we mark the vector of observed values of stream temperature by tso contrary to the simulated ones ts in this study we include within input variables the most recent observations of d s i dd s i and q i those observed at day i but the number of recent air temperature measurements lag in t i j a j 0 lag needed to be evaluated empirically together with the number of hidden nodes hn we test 15 different lag values i e lag 0 14 and 10 hn values i e hn 1 10 using higher lag and hn would lead to over parameterized anns evaluating the number of input variables in for a specific lag is hence straightforward as in 4 l a g 4 because we have fixed three input variables d s i dd s i and q i and t i j a considered starts from j 0 for example if lag 2 the input vector x i that is used to compute stream temperature for i th date t i s by ann is composed of x i 1 d s i x i 2 d d s i x i 3 q i x i 4 t i a x i 5 t i 1 a x i 6 t i 2 a after specifying input variables output variables and the numbers of nodes in and hn in ann all input variables are linearly scaled to a 0 1 interval by setting x ik x ik x maxk x maxk x mink where xmaxk and xmink are the maximum and the minimum values of k th input variable respectively the value of the scaled output is computed by ann as 11 t i s v 0 j 1 hn v j 1 exp w j 0 k 1 in w kj x ik where v and w are matrixes of ann parameters that are to be calibrated finally by re scaling of t i s simulated values of stream temperatures are obtained as t i s t min so t i s t max so t min so such re scaled t i s values are then used to evaluate the performance of the model anns are calibrated by means of the levenberg marquardt algorithm with the mean square error mse as an objective function see eq 14 in section 4 for details we must note here however that anns are general approximators hornik et al 1989 for which overfitting i e fitting the model not only to the signal but also to the noise present in the data does occur geman et al 1992 prechlet 1998 and may be harmful when using the calibrated model for previously unseen data as the effect of overfitting may also seriously affect the performance of anns for hydrological data piotrowski and napiorkowski 2013 some methods to avoid it must be used here we use a classical and often efficient early stopping approach based on prechlet s 1998 work when applying anns the calibration data set is divided into two non overlapping sub sets so called training sub set composed of chronologically the first 2 3 of measurements included in the calibration set and validation sub set composed of the remaining 1 3 of measurements included in the calibration set during ann calibration the steps of the calibration algorithm are based solely on derivatives and objective function values mse computed for the training data set however mse values for the validation set are also computed even though they are not used by the calibration algorithm and the solution set of ann parameters with the lowest value of the objective function mse found so far for the validation data is remembered after calibration this remembered solution with the lowest mse for the validation sub set is considered the best and applied to the testing data this way the effect of overfitting is diminished as data on which the final choice of the best solution is done are not used by the optimization algorithm during calibration the testing set for which the final opinion on the model performance is given is fully independent of training and validation data and is exactly the same as in the case of other models considered in this study 3 3 3 air2stream model the semi physical air2stream model toffolon and piccolroaz 2015 is based on lumped heat budget exchange between an unknown volume of water in the river its tributaries and atmosphere 12 ρ c p v d t w dt a h ρ c p i q i t w i q t w where v is an unknown volume of water of river reach with surface area a and water temperature tw ρ is the water density with specific heat capacity at constant pressure cp h is a net heat flux between air and water qi is a discharge from i th water source either tributary or groundwater with water temperature twi q is a discharge below tributaries and t is time the eq 12 is parameterized and simplified in the air2stream model toffolon and piccolroaz 2015 to 13 d t w dt 1 θ a 4 a 1 a 2 t a a 3 t w θ a 5 a 6 cos 2 π t t y a 7 a 8 t w θ q q q t 2 t 1 1 t 1 t 2 q t d t where ta is an air temperature ty is a duration of the year in the same units as t hence in days in this study θ is the dimensionless streamflow q is a reference value averaged over the time series from t1 to t2 in this study over the whole calibration set and a1 a8 are model parameters following toffolon and piccolroaz 2015 eq 13 is solved by the 4th order runge kutta method and the modelled negative stream temperatures are set to 0 c as water temperature observed on the first day is used as the initial condition the 30 day warm up period is set tw simulations for the first 30 days are not used to compute objective function values the model has been discussed in more detail and successfully compared with other approaches in toffolon and piccolroaz 2015 and piccolroaz et al 2016 its sensitivity to the calibration method has been studied in piotrowski and napiorkowski 2018 as shown in toffolon and piccolroaz 2015 the simplified 7 parameter version of the air2stream model with a 4 0 may perform not worse than the full 8 parameter version for many catchments although proposed only recently the air2stream model has already found numerous practical applications in hydrological and biological studies casas mulet et al 2016 fenocchi et al 2017 raman vinna et al 2018 cai et al 2018 arora et al 2018 4 methodology of model comparison and calibration in this study the performance of three well known logistic regression models three newly proposed logistic regression models and three semi physical and data driven models are compared namely 1 classical mohseni et al 1998 logistic regression logr1 eq 1 2 van vliet et al 2011 modification of the mohseni et al 1998 model logr2 eq 3 3 koch and grunewald 2010 modification of the mohseni et al 1998 model with exponential weights based on soto s 2016 method logr3 eqs 4 and 6 4 the koch and grunewald 2010 approach with added relationship with discharge as in van vliet et al 2011 the exponential weights are applied to both air temperature and discharge nlogr1 eq 7 5 the koch and grunewald 2010 approach with added relationship with discharge as in van vliet et al 2011 and with added relationship with declination of the sun nlogr2 eq 8 6 the logistic regression model with a series of logistic functions nlogr3 eq 9 7 the linear regression model with air temperature discharge and declination of the sun used as input variables linr eq 10 8 artificial neural networks ann their multi layer perceptron variant with a logistic activation function used in a hidden layer ann eq 11 9 the semi physical air2stream model air2stream eq 13 for all considered models the mean square error is used mse as an objective function during calibration 14 mse 1 n i 1 n t i s t i so 2 where t i so is an observed value of stream temperature at day i t i s is a simulated value of stream temperature for day i and n is the number of days used in a particular set calibration or testing in the case of ann models we divide the calibration set into training and validation sub sets hence n may also count the number of observations in each sub set parameters of the linear regression model are set by the least squares approach which yields a unique optimal solution all logistic regression and ann models are calibrated by means of the levenberg marquardt algorithm marquardt 1963 hagan and menhaj 1994 with up to 400 iterations and numerical approximation of derivatives the levenberg marquardt algorithm has turned out to be very successful in hydrological applications see adamowski and karapataki 2010 however in the case of the air2stream model derivative free approaches are needed we use a global optimization algorithm namely differential evolution storn and price 1997 see das et al 2016 opara and arabas 2019 for an excellent recent reviews on differential evolution in general variant based on covariance matrix learning and bimodal distribution parameter setting called cobide wang et al 2014 the selected algorithm turned out to be the best choice in research aimed at searching for the most effective calibration method of this model piotrowski and napiorkowski 2018 all control parameter settings of cobide are the same as discussed in piotrowski and napiorkowski 2018 evolutionary algorithms to which cobide belongs are global search methods i e are capable of searching for the global best solution contrary to derivative based methods but as a result they require a much longer calibration time than some other optimization algorithms posik et al 2012 especially gradient or hessian based methods like the levenberg marquardt algorithm as the performance of evolutionary algorithms highly depends on the allowed number of function calls piotrowski et al 2017 for air2stream we set this number to 20 000 in this study as in piotrowski and napiorkowski 2018 for calibration of the models for each river only calibration data sets are used note that as discussed in more detail in section 3 3 2 in the case of the ann model calibration data are divided into training and validation sub sets to allow the early stopping approach to be applied to prevent ann from overfitting as we use highly different models for comparison the range of their parameters from which initial solutions are to be sampled when optimization algorithms are initialized do differ in the case of logistic regression models we use different ranges for initialization of different parameters see table 2 such ranges are generally based on the results obtained by mohseni et al 1998 in their initial research in the case of the ann model as discussed in section 3 3 2 we generate initial parameters from 0 1 interval in the case of the air2stream model we used the same range of parameters as in piotrowski and napiorkowski 2018 see table 2 these ranges are based on the toffolon and piccolroaz 2015 suggestion provided in their fortran code link available in the toffolon and piccolroaz 2015 paper note that when calibrating air2stream parameters cobide searches for the air2stream solutions only within the bounds that are the same as initialization ranges of its parameters contrary to the levenberg marquardt algorithm in which the search is unbounded for both the ann and logistic regression models as the levenberg marquardt algorithm which is used for ann and logistic regression models is a local search procedure that may be trapped in a local optimum we repeat optimization of each model for every river 50 times with different randomly generated initial solutions then from these 50 runs we choose the 30 best solutions according to the mse for the calibration data set and compute the mean performance of the particular model for the calibration and testing data according to these 30 selected solutions we call it mse30 further in the paper this allows us to skip some poor solutions found if the levenberg marquardt algorithm got stuck in the local optimum as we reject the 20 poorest out of 50 runs before we compute the mean performance to avoid inconsistency in comparison among models the same procedure is used for the air2stream model even though it is calibrated by the global search algorithm in the case of linear regression we obtain a single best solution by means of the least squares approach for each river hence the above procedure would give the same solution as a single fit however although mean or root mean square errors are widely used to compare various stream temperature models chenard and caissie 2008 wehrly et al 2009 sahoo et al 2009 koch and grunewald 2010 grbic et al 2013 jeong et al 2013 bustillo et al 2014 piotrowski et al 2015 letcher et al 2016 laanaya et al 2017 kwak et al 2017 zhu et al 2018 arora et al 2018 it do not account for the number of model parameters hence as a second way of choosing the best approach both the best variant of the particular model and the overall best model in this study akaike information criterion aic akaike 1973 is used we apply a version of aic developed for the least squares approach which is defined as burnham and anderson 2002 15 aic n ln mse 2 k where n is the number of data in our case the number of days used for calibration k is the number of model parameters 1 and mse is the mean square error from eq 14 as with mse the smaller the value of aic the better the model is to compare different models or variants of the same model we compute aic30 in the same way as mse30 by averaging the 30 best aic values out of 50 repetitions however as comparisons based on mse and aic are performed independently and aic depend on the number of model parameters k the best 30 cases according to aic may not be the same as the best 30 cases according to mse note also that depending on the model the number of parameters may vary for different variants for example in the case of ann or nlogr3 or may be fixed for all variants as in the case of logr1 or nlogr2 however even if the number of parameters in each variant of the model is fixed still mse30 may point at slightly different variants than aic30 this is because when computing aic the value of ln mse is used not mse hence after averaging over 30 values of a particular criteria the same model variant will not necessarily be chosen as the best one according to mse30 and aic30 5 results and discussion before we compare the performance of the proposed modified logistic regression models against other approaches we have to choose the best configuration of each considered model the exception is the logr1 approach mohseni et al 1998 that has just a single variant the choice for the best configurations of a particular model are made twice by independently comparing mse30 and aic30 criteria 5 1 logr2 model configurations to use the logr2 model van vliet et al 2011 eq 3 the number of lag days lag1 must be chosen by trial and error for each catchment we test the logr2 model with lag1 set to values between 0 and 5 the mse30 and aic30 see section 4 for the definition values for the calibration and testing data sets are given in table 3 the number of parameters is fixed for each variant logr2 model has 5 parameters hence k that appears in eq 15 equals 6 we find that low lag1 values 0 or 1 depending on the catchment lead to the best results irrespectively of whether mse30 or aic30 are considered we choose the values that perform best on the calibration data set bolded in table 3 in further comparisons interestingly for five out of six catchments the variants that performed best for the calibration data were also the best for the testing set only in the case of the cedar river was a choice other than the one based on the calibration data set marginally better but the difference was of no practical meaning we also observe that the inappropriate choice of lag1 may highly affect the results 5 2 logr3 model configurations in the logr3 model koch and grunewald 2010 see eqs 4 6 one needs to choose the number of recent daily measurements of air temperature lag that is used to compute the weighted average we have tested this model with 30 different lag values between 0 and 29 the number of parameters is fixed for each variant k 6 the mse30 and aic30 results obtained for the calibration and testing data are shown in fig 1 we see that for each considered stream the model performance initially improves when daily air temperatures from additional recent days are added however when the lag value exceeds 10 days no clear improvement is observed and results for the testing data may even deteriorate when lag becomes too large as shown in table 4 the best values of lag chosen according to the calibration data set highly depends on the catchment and vary from 4 to 27 however it makes almost no difference whether mse30 or aic30 is used as a criterion 5 3 nlogr1 model configurations the nlogr1 model with k 7 see eq 7 was developed by adding the relation with discharge as in van vliet et al 2011 to the logr3 model koch and grunewald 2010 we consider lag between 0 and 29 the overall relationship between the model performance and lag time in days is almost identical for the nlogr1 and logr3 models see fig 2 and table 4 irrespective of which criteria mse30 or aic30 are used 5 4 nlogr2 model configurations in the nlogr2 model with k 13 eq 8 we add discharge and the declination of the sun to koch and grunewald s 2010 model logr3 this makes the relationship between the number of considered lag days again tested between 0 and 29 and the model performance slightly more complicated see fig 3 in the case of the nlogr2 model for five out of six catchments the best results are obtained when the number of lag days is not smaller than 20 the irondequoit creek is an exception where the optimal lag value equals 12 the same best lag values are determined by both the mse30 and aic30 criteria it means that information on the declination of the sun often allows the model to effectively benefit from a larger number of recent air temperature measurements 5 5 nlogr3 model configurations the performance of the nlogr3 model eq 9 also depends on the number of recent measurements of air temperature and discharge the number of parameters differ for each variant and is related with the lag value such that k 7 4 l a g 1 hence k varies from 11 to 127 we again consider lag values between 0 and 29 visually see fig 4 in all catchments apart from the fanno creek the improvement for both calibration and testing data is observed with increasing lag values until data from at least 15 recent days are considered the best results for calibration data are obtained with even larger lag values between 24 and 29 according to mse30 and between 15 and 29 according to aic30 see table 4 interestingly the best lag values found by mse30 and aic30 differ for only two rivers located in gentle landscapes the fanno creek and to much smaller degree the irondequoit creek importantly according to fig 4 model performance for the testing data often does not deteriorate with higher lag values irrespective of whether the mse30 or aic30 criterion is used the suprasl river is an exception and in half of the testing cases the biala tarnowska river the dischmabach river or the irondequoit creek it even keeps improving hence the large number of model parameters often does not harm performance of the model and information on air temperatures and discharges even from the entire recent month may be beneficial 5 6 linr model configurations according to the mse criterion when the least squares approach is used to fit the linear regression model to calibration data the more variables used the better the performance or in the worst case scenario equal performance is obtained hence one cannot choose the best set of input variables for the linear regression model based on the mse for calibration data this choice may only be done according to criteria that consider a number of parameters aic in this study or subjectively in fig 5 we show the relationship between the values of mse and aic obtained for the specific variant of the linear regression model and the number of recent days from which air temperature and discharge data are used for calibration clearly for calibration data mse decreases when lag is increasing for testing data such improvement ceased to be clearly visible for lag values larger than 10 even though using larger lags does not harm the performance however contrary to mse the values of aic do not constantly improve with increasing lag values even for the calibration set specific lag values chosen according to aic for calibration data are given in table 4 in the case of the suprasl river the best lag is as low as 5 but for other catchments it varies between 19 and 29 as a choice based on the mse we decided subjectively to set lag to 20 for each river note also that as a single best solution is always determined by the least squares approach for the linear model fitted to a specific calibration data set there is no need to perform a number of repetitions hence we do not discuss mse30 or aic30 here as it would be equal to the mse and aic from a single solution respectively 5 7 ann model configurations the choice of ann configuration is more difficult as we have to consider both the optimal value of lag that is related with the number of ann inputs in see section 3 3 2 and the optimal number of hidden nodes hn we test all possible combinations of ann variants with lag 0 14 lag 0 means that only the current day is considered and hn 1 10 the number of parameters for each ann is related to the number of hidden nodes and lag values such that k 2 2 h n l a g 4 h n k varies from 8 to 202 the results are given graphically in figs 6 9 where mse30 and aic30 values for the calibration and testing data are shown the best ann structures chosen for each catchment according to the mse30 and aic30 criteria computed for calibration data are given in table 5 note that although in figs 6 9 a different scale is used for each catchment and criterion the scale is kept the same for calibration and validation sets of a particular catchment and criterion this allows verification of whether the performance obtained for the testing and calibration data differs note also that the worst results are sometimes truncated to allow a better view of the differences between different good lag and hn configurations although during ann training the calibration data were divided into training and validation sub sets see section 3 3 2 for discussion and justification we do not discuss the performance for these sub sets separately as they are not important for comparison against logistic regression models we observe that ann architectures chosen according to the mse30 and aic30 criteria computed for the calibration data sets often differ the cedar river is the exception in some cases seriously in the case of the suprasl and dischmabach rivers with the exception of the cedar river anns chosen according to aic30 are smaller than those chosen according to mse30 for half of the catchments namely the suprasl fanno creek and dischmabach rivers the ann variants chosen according to mse30 perform noticeably poorer mse30 for the testing data differs by more than 10 on the testing data than anns chosen according to aic30 in the case of other three catchments the differences are marginal the choice of the right ann configuration is a well known problem related with overfitting but this is not the subject of the present study interested readers are referred to geman et al 1992 prechlet 1998 liu et al 2008 piotrowski and napiorkowski 2013 or perez sanchez et al 2018 here we may only note that contrary to what was observed for other tested models in the case of anns aic30 criterion leads to more appropriate choices of model architecture it chooses smaller anns that overall perform better on independent data than the mse30 5 8 air2stream model version as discussed in section 3 3 2 the simplified 7 parameter version of the air2stream model may perform competitively to the full version of air2stream with 8 parameters toffolon and piccolroaz 2015 hence we test both air2stream versions with 7 and 8 parameters the results are given in table 6 it may be seen that according to the calibration data the version with 8 parameters performs either slightly better or almost equally to the version with 7 parameters irrespectively of whether mse30 or aic30 are compared the results are however more disputable for the testing data the 8 parameter version of air2stream performs hugely better than the version with 7 parameters for the biala tarnowska river and a bit better for the dischmabach river however the version with 7 parameters marginally outperforms the 8 parameter version for the irondequoit creek and the cedar river in the case of the remaining two rivers there is barely any difference nonetheless as the models have to be chosen according to the calibration data we use the full air2stream version with 8 parameters in further parts of the study 5 9 comparison between new logistic regression approaches and other stream temperature models the choices of specific variants of each model by means of the mse30 and aic30 criteria have been discussed in sections 5 1 5 8 results obtained from the variants of particular models chosen according to mse30 are summarized in tables 7 10 tables 7 and 8 present comparisons between variants of models chosen according to the mse30 criterion for the calibration table 7 and testing table 8 data the choice of variants of models were obviously based on the calibration data only however in some cases the best possible performance of a specific model may differ from the 30 run averaged value hence in tables 8 and 9 we show the lowest mse found for the calibration and the lowest mse found for the validation data out of 50 runs of the chosen variant of a particular model the results from variants chosen according to the aic30 criteria are given in tables 11 14 as variants of the models chosen according to aic30 may differ from those selected according to mse30 the whole comparison is repeated we choose the variant of each model according to aic30 but to make results comparable with the choices reported in tables 7 10 in tables 11 12 we show two different criteria computed for the chosen variant aic30 and mse30 consequently in tables 13 and 14 we show the best mse and the best aic from 50 runs of the chosen variant of the model even though some differences are observed we may note the high compatibility between comparisons based on aic30 and mse30 let us first discuss the performance of historical logistic regression models irrespective of which criteria are used for both the calibration and testing data the logr3 logistic regression model koch and grunewald 2010 performs far better than the historical logr1 mohseni et al 1998 or logr2 van vliet et al 2011 models on each stream this means that using information on air temperatures that occurred in recent days is always advantageous the performance of the logr3 model koch and grunewald 2010 may be improved for each catchment and data set by the proposed nlogr2 model which is basically a logr3 approach with added information on the discharge and the declination of the sun see eq 8 this advantage must be attributed in large part to the declination of the sun as when it is skipped in the nlogr1 model see eq 7 the improvement over the logr3 approach koch and grunewald 2010 is either much weaker or not observed at all the discussed results are independent of the criteria used mse30 aic30 best aic or best mse from 50 runs surprisingly on the testing data the nlogr2 model is outperformed by the basic linear regression linr on two according to aic30 or three according to mse30 out of six streams the fanno creek the cedar river and only when comparison is based on aic30 the dischmabach creek see tables 8 and 12 which is not a great result it may be even more surprising that the basic mohseni et al 1998 model logr1 that is as discussed in the introduction so frequently used in practical applications is outperformed by linear regression on each catchment irrespective of which criteria or data set are used our third proposed logistic regression model nlogr3 which includes information on the declination of the sun air temperatures and discharge values from a number of recent days eq 9 performs better than all historical variants of logistic regression or the nlogr1 model nlogr3 is also better than the other recently proposed model nlogr2 but not on every river out of the two models nlogr3 or nlogr2 the one to choose depends on the data and assumed criteria as nlogr2 that has much fewer parameters than nlogr3 performs relatively better when akaike information criterion is used for selection nlogr3 performs better against linr than nlogr2 does but for the testing data it is still outperformed for the fanno creek see tables 8 and 12 and only when aic30 is considered the cedar river skipping simple regression models the newly proposed nlogr3 approach eq 9 turns out slightly better or at least competitive against the semi physical air2stream model for the calibration data the new nlogr3 model is better than air2stream on four or five out of six streams depending on the criterion used for the testing data according to mse30 the nlogr3 model clearly outperforms air2stream on three lowland or hilly streams the fanno creek the irondequoit creek and the suprasl river and performs just marginally poorer on two mountainous ones the dischmabach creek and the cedar river the only river on which air2stream clearly outperforms the new approach is the mountainous biala tarnowska river see table 8 what may be due to the high complexity of reasons causing stream temperature variations in rivers in southern poland zelazny et al 2018 that hamper the performance of simple data based models when aic30 is used for comparison results from the nlogr3 model are less encouraging as due to the larger number of parameters it loses to air2stream on 4 rivers winning on only two however the version with a smaller number of parameters nlogr2 performs better winning against air2stream on three rivers when aic30 is used comparisons with anns are not encouraging for all tested models including the two new ones nlogr3 and nlogr2 irrespective of whether mse30 or aic30 are considered for both the calibration and testing data a properly determined version of ann outperforms both new approaches on five out of six catchments according to mse30 the new models are better only for the suprasl river see table 8 when aic30 values are compared only nlogr2 outperforms ann on this catchment interestingly on the fanno creek ann although much better than all other nonlinear models turns out to be inferior to linear regression when the testing data are considered 5 10 discussion based on the results given above can the new approaches nlogr2 and nlogr3 eqs 8 and 9 we skip nlogr1 here as it is clearly outperformed by the two be considered useful for practical applications let us discuss this in a few points 1 among the two new models nlogr3 performs better than nlogr2 on most rivers but the difference depends to some extent on the criteria used for comparison if we use mse30 in which case the number of parameters is not considered nlogr3 outperforms nlogr2 on 5 rivers and loses just marginally on the sixth however according to aic30 which takes into account the number of parameters nlogr3 is better on four catchments but nlogr2 is better on two others lowland ones hence both models may have some merit but nlogr3 would be the first bet 2 the nlogr3 model performs much better than the historical logistic regression models despite the fact that it does not require any additional variables that may be hard to obtain although nlogr3 has many parameters this neither hinders calibration by means of the levenberg marquardt algorithm nor negatively affects the performance on the testing data sets when mse30 is used as a comparison criterion however when aic30 is used opinion on the performance of nlogr3 model is automatically affected by the large number of parameters hence if the number of parameters is considered a problem nlogr2 is an alternative that outperforms all historical logistic regression models using a relatively small number of parameters 3 when mse30 is used for comparison both newly proposed models nlogr3 and nlogr2 outperform the semi physical air2strem model on lowland or hilly rivers but perform poorer on mountainous rivers when aic30 is considered this is still true for nlogr2 model but not necessarily for nlogr3 such results do not allow one to claim that the new approaches are better than air2stream but they are at least competitive alternative 4 both newly proposed models are inferior to anns if the ann configuration is properly chosen according to our results there is no doubt about that however choosing the correct ann configuration requires a large amount of pre computations to be done for each river separately as can be seen from figs 6 9 an ad hoc chosen ann variant may perform much poorer than the newly proposed model to summarize we may say that the two newly proposed models nlogr3 and nlogr2 eqs 9 and 8 may be useful for simple and quick calculations of stream temperatures that do not require much additional work they also perform favourably against a semi physical model on lowland or hilly catchments and on any type of catchments they lead to much more accurate results than the historical mohseni et al 1998 model that is still widely used in practice 6 conclusions in the present study new variants of the logistic regression model have been proposed for the stream temperature simulation on daily data the proposed approaches do not need any additional measurements than those already used by logistic regression models proposed by mohseni et al 1998 van vliet et al 2011 koch and grunewald 2010 or soto 2016 performance of the two newly proposed models nlogr3 eq 9 and nlogr2 eq 8 is encouraging both models are very simple and use information on air temperature and discharge from a number of recent days as well as the declination of the sun as input variables however they differ significantly in the number of parameters the nlogr2 model has 13 parameters the number of parameters of nlogr3 depends on the number of recent measurements considered and is often much larger nonetheless despite the large number of parameters for testing data that are independent from calibration nlogr3 performs much better than the former logistic regression models and in most cases it is also better than the nlogr2 model the six catchments on which models are tested are located in temperate climatic conditions in the northern hemisphere between 43 n and 54 n but in highly different orographic conditions spanning from flat lowlands to highly mountainous catchments the catchment areas of selected streams vary between 40 and 1000 km2 among the six considered streams two are lowland and flat one is covered by gentle hills two are mountainous in the upper part and relatively flat in the lower part with highly different climatic conditions and one is located in the high mountains the only feature of the proposed nlogr3 and nlogr2 models that needs to be chosen by the user is the number of recent daily measurements of air temperature and discharge this is relatively easily done by performing a number of calibrations for various numbers of recent days in this study from 0 when only the current measurements are considered to 29 and choosing this number for which the mean performance of the model is the best according to the calibration data this choice may be based on criteria that do not consider the number of parameters like mean square error similar approaches have been widely applied in the literature for various logistic regression models koch and grunewald 2010 van vliet et al 2011 soto 2016 or by criteria that explicitly account for the number of parameters like akaike information criterion akaike 1973 both ways are tested in this study however to calibrate logistic regression models gradient based calibration procedures are classically used which search for the local optima some such local optima may be very poor hence we skip a number of the poorest solutions when the mean performance of the model over a number of repeated calibrations is computed it turns out that in the vast majority of cases there is basically very little difference in the number of lag days chosen according to mean square errors and the akaike information criterion the chosen number of recent days considered for the newly proposed model have been successfully validated on the calibration independent data wide scale comparison between the proposed nlogr2 and nlogr3 models and 1 a number of other logistic regression variants mohseni et al 1998 koch and grunewald 2010 van vliet et al 2011 soto 2016 2 simple linear regression 3 a more advanced data driven model namely multi layer perceptron artificial neural networks ann that have been widely used in the literature chenard and caissie 2008 sahoo et al 2009 jeong et al 2013 hadzima nyarko et al 2014 piotrowski et al 2015 shi et al 2018 temizyurek and dadaser celik 2018 and 4 a recently proposed semi physical air2stream model that has already found numerous applications casas mulet et al 2016 fenocchi et al 2017 raman vinna et al 2018 cai et al 2018 arora et al 2018 have been conducted on the chosen six streams the choice of the best variants of competing methods were also based on both mean square error and the akaike information criterion it turned out that with the exception of anns both criteria point at similar variants of models however in the case of anns akaike information criterion often chooses smaller networks than mean square error and such choices are confirmed by slightly better performance on independent testing data sets overall if properly chosen the ann model turned out to be the best approach on four out of six streams although the newly proposed models turned out generally inferior to anns they perform slightly better or at least not worse than the semi physical air2stream model and much better than other logistic regression variants in comparison with the air2stream model the proposed approaches turned out especially well suited for lowland rivers considering the relative simplicity of our newly proposed approaches in comparison with air2stream and anns and the susceptibility of the ann model to the choice of its architecture and the high risk of ann overfitting to noise present in the sample geman et al 1992 prechlet 1998 piotrowski and napiorkowski 2013 perez sanchez et al 2018 the proposed approach may be considered as an easily applicable and relatively well performing alternative to more complicated models conflict of interest the authors declare that they have no conflict of interest acknowledgment the research published in this paper has been financed from the national science centre poland grant number 2016 21 b st10 02516 2017 2020 authors are very grateful to dr marco toffolon and dr sebastiano piccolroaz for making the fortran code of the air2stream model widely available on the web page authors are very grateful to dr scott jackson from the institute of molecular biology and biophysics eth zurich for his help in language editing and corrections 
6593,large scale vegetation restoration generally reduces local water yield and influences river ecosystem health thus scientific evaluation of vegetation restoration consequences is necessary for maintaining the stability of the surface water system and water cycle in semi arid regions in this study we compared the efficiencies of different typical grasslands in regulating runoff and sediment yields and proposed feasible suggestions suiting for local environments four grasslands including two gramineae species elymus dahuricus and bromus inermis and two legume species medicago sativa and trifolium repens were tested during a two year period with simulated rainfall experiments and using bare land as control three replicates were done for each treatment and fifteen plots with a slope of 20 were constructed three indices were used to assess the runoff and sediment yields reduction capacity of the grasslands including runoff reduction benefit rrb sediment reduction benefit srb and soil infiltration rate sir the results showed that rrb and srb were significantly different p 0 05 among treatments across the two year experiments the values of srb increased considerably in the second year in particular the values of srb for e dahuricus and b inermis was 98 79 and 98 07 respectively while that of rrb was 11 84 and 4 01 respectively the two gramineae grasslands showed greater effectiveness in sediment reduction and runoff maintenance than the two legume species owing to the dense fibrous roots and higher biological soil crust coverage therefore gramineae grasslands can be considered as a suitable management practice to achieve the socio ecological sustainability of the semi arid areas during vegetation restoration keywords grassland runoff yield sediment yield semi arid areas vegetation restoration 1 introduction due to low vegetation cover harsh winters and extreme rainfall events soil erosion has become a severe problem in semi arid areas worldwide wei et al 2007 soil erosion leads to the deterioration of soil physical chemical and biological properties loss of nutrients and even loss of cropland soil erosion also brings about fluvial sediment deposition kinnell 2012 rienzi 2013 heavy sedimentation can lead to flood risks frequent sandstorm events with declining air quality deterioration of water quality and landscapes and loss of biodiversity li and fang 2016 vegetation restoration has been considered as one of the key strategies for soil erosion control due to its effects on the improvement of soil properties and microenvironment and the consequent effects on the reduction of runoff and sediment yields cao et al 2011 fiener et al 2011 garcía ruiz 2010 wei et al 2007 however precipitation is the main source of water supply in semi arid areas leung et al 2015 the surface flow after rainfall events generally forms river base flow and is critical to ensure the sustainability of socio ecological systems in semi arid areas with limited water resources cao et al 2010 li et al 2017 robinson et al 2003 previous studies have reported that changes in river stream flow are mainly affected by precipitation temperature and land use johnson et al 2009 palmer et al 2009 over the past half century 1950 2000 large scale vegetation restoration reduces the conversion of rainfall to runoff cao et al 2011 farley et al 2005 gao et al 2015 lópez vicente et al 2017 thus leading to the lower river flow and even influencing river ecosystems health cao et al 2010 li et al 2017 lana renault et al 2018 therefore there is a scientific and practical need to maintain surface runoff while controlling soil loss to achieve the sustainability of ecological systems during vegetation restoration many studies have dealt with the effectiveness of different vegetation species on soil erosion control sun et al 2006 indicated that forestation notably reduced runoff by more than 50 on the chinese loess plateau xu et al 2009 found that two herbs artemisia gmelinii and pulicaria chrysantha had greater improvements on soil quality and reducing runoff and soil loss than a small shrub ajania potaninii which has minimal effectiveness in contrast dense shrubs are the most effective land use type in reducing soil erosion in mediterranean landscapes lanznaster et al 2010 lópez vicente et al 2011 the impacts of vegetation restoration on soil erosion control are influenced by numerous factors such as the climate slope gradient and soil texture anache et al 2018 li and fang 2016 based on this background a systematic investigation of the efficiency of different land use types on water erosion control in global semi arid areas has been carried out by a meta analysis liu et al unpublished results compared to shrublands and forestlands grasslands generally show the greatest effectiveness for sediment control but exhibit lower runoff reduction efficiency the dense canopies of forestlands and shrublands intercept rainfall thus greatly reducing runoff pizarro et al 2006 wei et al 2007 at the soil surface plant roots physically combine with soil particles providing a mechanical barrier to soil and water movement gyssels et al 2005 de baets et al 2007 indicated that grasslands with a shallow but dense lateral spreading rooting pattern led to the highest potential of erosion reduction and highly increased the resistance of the topsoil against concentrated flow erosion however scrubland and forestland may not cover the entire soil surface drawing a patchy distribution of vegetation and thus leading to the occurrence of uncontrolled soil erosion in the areas without grass under the canopies of the shrubs and trees arnaez et al 2015 furthermore forestland with high soil moisture consumption generally lead to soil desiccation which exacerbates environmental degradation in semi arid areas cao et al 2011 wang et al 2007 reported that the overall survival rate of trees in afforestation projects from 1952 to 2005 was only 24 in contrast wang et al 2012 noted that grassland was a better choice than plantations for controlling soil erosion while using minimal water therefore grassland consume less water than forestland and appears as a better choice for achieving the combined goal of soil loss control and water conservation in semi arid areas previous studies mostly compared the effects of different vegetation types on soil erosion control but the knowledge in the quantification of the performance of sediment reduction and runoff maintenance in different grasslands is lacking ideally species that maintain moderate surface runoff while storing enough rainwater to meet the demands of growth can control soil loss and may contribute to the improvement of local environments ultimately in this study four typical grasslands which were the most commonly used during vegetation restoration were selected to study the hydrological response of the soil under simulated rainfall experiments the main objective was to evaluate the main reasons that explained the different runoff and sediment yields obtained with the four grasslands these findings could offer a theoretical guidance to achieve the combined goal of sediment reduction and runoff maintenance during vegetation restoration in semi arid areas 2 materials and methods 2 1 experimental conditions the simulated rainfall experiments were carried out in the state key laboratory of soil erosion and dryland farming on the loess plateau in yangling shaanxi province china e 107 59 108 08 n 34 14 34 20 the climate ranges between semi arid and semi humid with a mean annual temperature of 12 9 c the annual mean precipitation and evapotranspiration is 637 6 mm and 884 0 mm respectively zhao et al 2014 most of the precipitation occurs as short duration and high intensity rainstorms in the summer months between june and september a side sprinkle precipitation set up system in which rainfall intensities can be precisely controlled by adjusting the nozzle size and water pressure was used in the experiments pan and shangguan 2006 deionized water which was prepared by reverse osmosis and collected in a water tank was used in all rainfall simulations bormann et al 2010 the height of the rainfall simulator was up to 16 m the simulated storm was of above 85 uniformity the raindrop distribution and size could be controlled by varying the type of needles and their receptacles hignett et al 1995 wang et al 2005 the raindrop diameter was 0 5 2 mm and the mean velocity was 4 78 m s 1 the mean rainfall kinetic energy per unit time per unit area was 0 2193 j m 2 s 1 calibrations of rainfall intensities were conducted prior to the experiments and never differed from the target intensities by more than 10 each experimental steel plot was 1 1 m in length 0 8 m in width and 0 25 m in depth pan and shangguan 2006 zhao et al 2014 and was fitted with four wheels for free movement fig 1 a metal runoff collector was set at the bottom of the plot to direct runoff into a container apertures were formed at the bottom of each plot to allow soil water to freely infiltrate the slope of each experimental plot was set at 20 which is considered as the critical slope to develop gully erosion tang et al 1998 to simulate the field conditions as much as possible the original soil used in this study was a loessial loam collected from shenmu county which is located in the water wind erosion crisscross region on the loess plateau the main properties of the final experimental soil were listed in table 1 2 2 experiment setup soil was gently crushed before passing through a 10 mm sieve and the sieved soil was thoroughly mixed to minimize the differences among treatments then the soil was packed in each plot in two 10 cm layers at a 1 35 g cm 3 bulk density additionally each soil layer was raked lightly before the next layer was packed to diminish the discontinuity the four selected grasslands were medicago sativa m sativa trifolium repens t repens elymus dahuricus e dahuricus and bromus inermis b inermis which are the most common grasslands during vegetation restoration in the loess plateau according to the local convention the plot grasslands were established in the spring of 2013 a total of five strips were planted with a row spacing of 20 cm bare land was set as the control treatment thus there were five experimental treatments with three replicate plots for each treatment yielding a total of 15 plots all plots were placed outdoor and irrigated during the first weeks to ensure plant survival but plants completely grew under natural conditions later and mainly depended on rainfall for growing compared with natural grasslands differences in soil conditions vegetation types and other hydro climatological factors were minimized in the present study two rainfall experiments were carried out in 2013 and 2014 respectively one day before the rainfall experiments a specialized soil auger of 1 cm diameter was used to determine the soil water content of different treatments according to the measured values different amounts of water were sprayed with a commonly used household sprayer to minimize the differences in antecedent soil water content among treatments soil water content was adjusted to 15 gravimetrically for all plots at the beginning of the experiments pan and shangguan 2006 2 3 measurements and methods according to tang 2004 most of the heavy rainfall intensity in the loess plateau ranges between 100 and 150 mm h 1 the simulated rainfall intensity was set at 120 mm h 1 and each simulation lasted 120 min such a high rainfall intensity was chosen as it is usually a typical intensity of storm that causes serious soil erosion in this region zhou and wang 1992 some studies also selected 120 mm h 1 which corresponds to heavy rain on the loess plateau fang et al 2015 lu et al 2017 pan and shangguan 2006 all rainfall events generating runoff were recorded during each event the runoff and sediments produced every five minutes were collected in plastic buckets after settling of the turbid water the volume of clear water was regarded as the runoff amount the weight of the soil in the bucket after oven drying was taken as the sediment yield to calculate the vegetation coverage vc before each rainfall event three to five jpg format photos were taken using a digital camera the lens and the plot were paralleled and the distance between the two was always the same the vegetation cover was then determined using photoshop cs 3 0 and image j software package huang et al 2013a b biological soil crusts were observed in the upper millimeters of the topsoil and were composed of bacteria algae fungi lichens and bryophytes in different proportions belnap et al 2001 swenson et al 2018 the biological soil crust coverage bscc was calculated following the same approach of the vegetation coverage three metrics i e runoff reduction benefit rrb sediment reduction benefit srb and soil infiltration rate sir mm min 1 were employed to represent the capacity of the different treatments to regulate runoff and sediments and the calculation of each metric was as follows zhao et al 2014 1 rrb r b r v r b 100 2 srb s b s v s b 100 3 sir r i cos α 10 r v s t where rb and rv are the runoff volume ml for the bare land and vegetated plots respectively sb and sv are the sediment yield g for the bare land and vegetated plots respectively ri is the rainfall intensity mm min 1 s is the plot area receiving rainfall cm2 t is the rainfall duration min α is the slope gradient and 10 is the coefficient for dimension conversion in particular eq 3 is based on the assumption of ignoring the evapotranspiration and interception of water by vegetation during rainfall events 2 4 data analysis the results in this article were expressed as mean standard error se of mean the differences in runoff and sediment characteristics among the different treatments were compared by using one way analysis of variance anova procedure all statistical analyses were performed using the software program spss 12 0 spss inc chicago il usa and figures were drawn using sigmaplot 8 0 systat software inc san jose ca usa the statistical significance was evaluated at the 0 05 level 3 results 3 1 runoff volume and sediment yield the time to runoff initiation vegetation coverage biological soil crust coverage runoff volume and sediment yield for the different treatments during the two year experiments were shown in table 2 the bscc and vc of all treatments clearly increased in the second year compared with the values obtained in the first year in spite of plant ages the values of bscc and vc for b inermis and t repens were the highest followed by e dahuricus m sativa and bare land moreover the difference among the five treatments reached a significant level p 0 05 the difference in time to runoff initiation among the treatments was also statistically significant p 0 05 the time in the bare land plots was significantly higher than that observed in the plots with grasslands during the first year but it was the lowest during the second year bromus inermis 141 10 l and t repens 153 08 l produced larger amounts of runoff in the first year but lower amounts in the second year 145 03 l and 133 04 l respectively there were significant differences in sediment yield among treatments in both years f 290 69 p 0 05 for the first year f 81 13 p 0 05 for the second year grasslands produced significantly less sediment yield compared with bare land moreover m sativa produced the highest sediment yields among the different grasslands regardless of the planting ages table 2 3 2 runoff rate sediment rate and sir the runoff rates showed similar changing trends in all treatments during the two year measurements fig 2 a fig 2c the initial runoff rate was relatively low but increased sharply later the initial runoff rate of t repens was the highest in the first year but the lowest in the second year runoff rate reached steady state conditions at 40 min in the first year but became stable earlier i e at 20 30 min in the second year the sediment yield rate slowed down and finally reached steady state conditions and the stabilization time was similar with that of runoff rate due to rill erosion bare land showed a slight increase in runoff rate and sediment yield rate at 95 min fig 2a b and a similar phenomenon appeared in m sativa at 55 min fig 2a b the dynamic process of sir for different treatments was shown in fig 3 the sirs of t repens e dahuricus and b inermis were all lower than that of bare land and m sativa fig 3a after slope runoff generation sir gently decreased however a different trend was observed in the second year when sir significantly decreased at the initial stage and then gradually became stable trifolium repens showed the lowest initial sir among all treatments fig 3b 3 3 runoff reduction benefit and sediment reduction benefit the runoff reduction benefit rrb and sediment reduction benefit srb for the different grasslands during the two year experiments were shown in fig 4 a lower value of rrb represents a better ability of runoff maintenance for grasslands and a higher value of srb represents a better effectiveness of grasslands in sediment reduction in the first year all grasslands showed very low rrbs with the mean value ranging from 31 13 t repens to 11 69 m sativa in the second year the rrbs of the different grasslands slightly increased when compared with the first year with the mean value ranging from 15 58 m sativa to 12 02 t repens overall all grasslands showed high srbs greater than65 during the two year experiments the srb of m sativa was significantly p 0 05 lower than those obtained in the other grasslands however no significant difference was observed among t repens e dahuricus and b inermis moreover a great increase in srb from the first year to the second year was found for all grasslands 4 discussions e dahuricus and b inermis as gramineae grasslands have abundant fibrous roots for the legume species t repens is abundant in fibrous roots while m sativa has a different root architecture with tap roots fan et al 2016 vamerali et al 2003 grasslands especially e dahuricus b inermis and t repens significantly reduced sediment yield when compared with bare land in our study these results were consistent with those reported by wu et al 2010 who proved that vegetation significantly decreased soil erosion and improved soil physical chemical and biological properties plant growth could improve soil conditions through fine root network development and litter accumulation which forms a virtuous cycle to control soil loss gyssels et al 2005 xu et al 2009 wu et al 2016 thus grasslands with accumulated fibrous roots in shallow soil had better effects on reducing sediment yield the results showed that grasslands had relatively lower runoff reduction benefits compared to the superior sediment reduction benefits fig 4 in particular grasslands had higher surface runoff compared with bare land in the first year very likely due to the presence of the root systems leung et al 2015 found that roots occupied soil pores while growing initially affecting both soil saturated hydraulic conductivity and infiltration rate which led to increased runoff grassland had more abundant fine roots in the shallow soil compared with forestland and those fine roots decreased infiltration by clogging the soil pore space archer et al 2002 additionally roots physically combined with soil particles at the soil surface gyssels et al 2005 gradually reduced the infiltration rate and increased the runoff rate due to a surface seal formation until a steady state condition was reached lópez vicente et al 2016 smets et al 2011 another reason might be that grassland had a significantly higher biological soil crust coverage bscc than bare land table 2 biological soil crusts could create an impermeable seal by swelling sheath material during imbibition favoring soil water repellence that was markedly increased in both intensity and persistence thus leading to more rapid ponding lópez vicente and navas 2012 zhang et al 2014 the time to runoff and infiltration rate of bare land and m sativa were obviously higher than those of the other grasslands in the initial stage of rainfall table 2 fig 3 higher bscc may prevent infiltration which would lead to decreased infiltration rate and consequently increased surface runoff biological soil crusts modified the surface micro topography which reduced the speed of water flow and the connectivity of water and sediments among source areas concurrently rodríguez caballero et al 2012 singh and liu 2004 the grasslands with the higher bscc had significantly positive effects on regulating runoff and sediment yields several studies found that infiltration rates in grasslands can be either higher or lower than bare land at different stages of plant growth mašíček et al 2013 zhao et al 2014 in this study the runoff amounts in the plots with b inermis and t repens were significantly lower than those measured in the other grasslands and bare land plots in the second year table 2 additionally the initial infiltration rate was relatively higher fig 3 possibly due to the particularly high vegetation coverage vc bromus inermis and t repens with higher vc correspondingly had more dense root systems which grew maturely in the second year similar results were found by meek et al 1989 who suggested that channels or macropores formed by the decomposition of roots increased infiltration rates and decreased runoff in addition decaying roots increased soil organic matter content which in turn influenced the infiltration capacity due to the change in the burrowing activity and biomass of earthworms fischer et al 2014 plant roots significantly affected soil hydrological processes by forming preferential pathways and increasing hydraulic conductivity which would facilitate the storage and uptake of water and nutrient archer et al 2002 wu et al 2017 although the decomposition of fine roots increased the infiltration rate and decreased runoff volume in the second year the runoff reduction benefit rrb of grasslands were still low in general grassland substantially maintained runoff while reducing sediment yield during the rainfall simulations in this study the differences in erosion process among the different grasslands were attributed to the presence of biological soil crusts vegetation cover and root systems in general grasslands showed comprehensive effects on sediment reduction and runoff maintenance especially the gramineae grasslands with abundant fibrous roots therefore gramineae grasslands maintained moderate surface runoff while storing enough rainwater to meet the demands of growth and controlled soil loss thus they contribute to the improvement of the local environment ultimately with regard to the development of ecological environment in semi arid areas where water is limited gramineae grasslands as typical vegetation type during vegetation restoration could be considered for soil loss control as well as water resources conservation although our study determined the runoff maintenance and sediment reduction performance of different grasslands during the two year experiments there are still some limitations this study was conducted by means of outdoor simulated rainfall experiments and lasted for only two years which might mask the possible time variability in relation torunoff maintenance and sediment reduction performance of grasslands it is unclear that whether grasslands still have great effectiveness in sediment reduction and runoff maintenance under long term planting therefore further studies should be focused on analyzing the effects of grasslands with different planted ages on regulating runoff and sediment yield based on long term field experiments despite these limitations the analysis of sediment reduction and runoff maintenance performance of different grasslands is useful and can potentially contribute to achieve the sustainability of ecological systems during vegetation restoration in semi arid areas 5 conclusions this study confirmed the different dynamic effects caused by four typical grasslands during vegetation restoration on runoff and sediment reduction through two year simulated rainfall experiments the runoff reduction benefit rrb sediments reduction benefit srb and soil infiltration rate sir significantly differed p 0 05 among the different treatments and during the two years and the values of srb greatly increased in the second year indicating that grasslands contributed to greater benefits in soil loss control with increasing planting ages due to the presence of abundant fibrous roots and higher biological soil crust the values of rrb were relatively lower grasslands generally had a greater impact on sediment yield than on runoff volume the two gramineae grasslands reduced sediment yield by more than 90 and showed a better effectiveness in sediment reduction and runoff maintenance and were considered as a suitable management practice to ensure the sustainability of ecological environments during vegetation restoration in semi arid areas acknowledgment we thank dr manuel lópez vicente and dr he honghua for improving the language of this article and also thank the editors and anonymous reviewers for their constructive comments and suggestions on this work this research was funded by projects of national natural science foundation of china nsfc41722107 41525003 the west light foundation of the chinese academy of science xab2015a04 and the youth talent plan foundation of northwest a f university 2452018025 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 03 008 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6593,large scale vegetation restoration generally reduces local water yield and influences river ecosystem health thus scientific evaluation of vegetation restoration consequences is necessary for maintaining the stability of the surface water system and water cycle in semi arid regions in this study we compared the efficiencies of different typical grasslands in regulating runoff and sediment yields and proposed feasible suggestions suiting for local environments four grasslands including two gramineae species elymus dahuricus and bromus inermis and two legume species medicago sativa and trifolium repens were tested during a two year period with simulated rainfall experiments and using bare land as control three replicates were done for each treatment and fifteen plots with a slope of 20 were constructed three indices were used to assess the runoff and sediment yields reduction capacity of the grasslands including runoff reduction benefit rrb sediment reduction benefit srb and soil infiltration rate sir the results showed that rrb and srb were significantly different p 0 05 among treatments across the two year experiments the values of srb increased considerably in the second year in particular the values of srb for e dahuricus and b inermis was 98 79 and 98 07 respectively while that of rrb was 11 84 and 4 01 respectively the two gramineae grasslands showed greater effectiveness in sediment reduction and runoff maintenance than the two legume species owing to the dense fibrous roots and higher biological soil crust coverage therefore gramineae grasslands can be considered as a suitable management practice to achieve the socio ecological sustainability of the semi arid areas during vegetation restoration keywords grassland runoff yield sediment yield semi arid areas vegetation restoration 1 introduction due to low vegetation cover harsh winters and extreme rainfall events soil erosion has become a severe problem in semi arid areas worldwide wei et al 2007 soil erosion leads to the deterioration of soil physical chemical and biological properties loss of nutrients and even loss of cropland soil erosion also brings about fluvial sediment deposition kinnell 2012 rienzi 2013 heavy sedimentation can lead to flood risks frequent sandstorm events with declining air quality deterioration of water quality and landscapes and loss of biodiversity li and fang 2016 vegetation restoration has been considered as one of the key strategies for soil erosion control due to its effects on the improvement of soil properties and microenvironment and the consequent effects on the reduction of runoff and sediment yields cao et al 2011 fiener et al 2011 garcía ruiz 2010 wei et al 2007 however precipitation is the main source of water supply in semi arid areas leung et al 2015 the surface flow after rainfall events generally forms river base flow and is critical to ensure the sustainability of socio ecological systems in semi arid areas with limited water resources cao et al 2010 li et al 2017 robinson et al 2003 previous studies have reported that changes in river stream flow are mainly affected by precipitation temperature and land use johnson et al 2009 palmer et al 2009 over the past half century 1950 2000 large scale vegetation restoration reduces the conversion of rainfall to runoff cao et al 2011 farley et al 2005 gao et al 2015 lópez vicente et al 2017 thus leading to the lower river flow and even influencing river ecosystems health cao et al 2010 li et al 2017 lana renault et al 2018 therefore there is a scientific and practical need to maintain surface runoff while controlling soil loss to achieve the sustainability of ecological systems during vegetation restoration many studies have dealt with the effectiveness of different vegetation species on soil erosion control sun et al 2006 indicated that forestation notably reduced runoff by more than 50 on the chinese loess plateau xu et al 2009 found that two herbs artemisia gmelinii and pulicaria chrysantha had greater improvements on soil quality and reducing runoff and soil loss than a small shrub ajania potaninii which has minimal effectiveness in contrast dense shrubs are the most effective land use type in reducing soil erosion in mediterranean landscapes lanznaster et al 2010 lópez vicente et al 2011 the impacts of vegetation restoration on soil erosion control are influenced by numerous factors such as the climate slope gradient and soil texture anache et al 2018 li and fang 2016 based on this background a systematic investigation of the efficiency of different land use types on water erosion control in global semi arid areas has been carried out by a meta analysis liu et al unpublished results compared to shrublands and forestlands grasslands generally show the greatest effectiveness for sediment control but exhibit lower runoff reduction efficiency the dense canopies of forestlands and shrublands intercept rainfall thus greatly reducing runoff pizarro et al 2006 wei et al 2007 at the soil surface plant roots physically combine with soil particles providing a mechanical barrier to soil and water movement gyssels et al 2005 de baets et al 2007 indicated that grasslands with a shallow but dense lateral spreading rooting pattern led to the highest potential of erosion reduction and highly increased the resistance of the topsoil against concentrated flow erosion however scrubland and forestland may not cover the entire soil surface drawing a patchy distribution of vegetation and thus leading to the occurrence of uncontrolled soil erosion in the areas without grass under the canopies of the shrubs and trees arnaez et al 2015 furthermore forestland with high soil moisture consumption generally lead to soil desiccation which exacerbates environmental degradation in semi arid areas cao et al 2011 wang et al 2007 reported that the overall survival rate of trees in afforestation projects from 1952 to 2005 was only 24 in contrast wang et al 2012 noted that grassland was a better choice than plantations for controlling soil erosion while using minimal water therefore grassland consume less water than forestland and appears as a better choice for achieving the combined goal of soil loss control and water conservation in semi arid areas previous studies mostly compared the effects of different vegetation types on soil erosion control but the knowledge in the quantification of the performance of sediment reduction and runoff maintenance in different grasslands is lacking ideally species that maintain moderate surface runoff while storing enough rainwater to meet the demands of growth can control soil loss and may contribute to the improvement of local environments ultimately in this study four typical grasslands which were the most commonly used during vegetation restoration were selected to study the hydrological response of the soil under simulated rainfall experiments the main objective was to evaluate the main reasons that explained the different runoff and sediment yields obtained with the four grasslands these findings could offer a theoretical guidance to achieve the combined goal of sediment reduction and runoff maintenance during vegetation restoration in semi arid areas 2 materials and methods 2 1 experimental conditions the simulated rainfall experiments were carried out in the state key laboratory of soil erosion and dryland farming on the loess plateau in yangling shaanxi province china e 107 59 108 08 n 34 14 34 20 the climate ranges between semi arid and semi humid with a mean annual temperature of 12 9 c the annual mean precipitation and evapotranspiration is 637 6 mm and 884 0 mm respectively zhao et al 2014 most of the precipitation occurs as short duration and high intensity rainstorms in the summer months between june and september a side sprinkle precipitation set up system in which rainfall intensities can be precisely controlled by adjusting the nozzle size and water pressure was used in the experiments pan and shangguan 2006 deionized water which was prepared by reverse osmosis and collected in a water tank was used in all rainfall simulations bormann et al 2010 the height of the rainfall simulator was up to 16 m the simulated storm was of above 85 uniformity the raindrop distribution and size could be controlled by varying the type of needles and their receptacles hignett et al 1995 wang et al 2005 the raindrop diameter was 0 5 2 mm and the mean velocity was 4 78 m s 1 the mean rainfall kinetic energy per unit time per unit area was 0 2193 j m 2 s 1 calibrations of rainfall intensities were conducted prior to the experiments and never differed from the target intensities by more than 10 each experimental steel plot was 1 1 m in length 0 8 m in width and 0 25 m in depth pan and shangguan 2006 zhao et al 2014 and was fitted with four wheels for free movement fig 1 a metal runoff collector was set at the bottom of the plot to direct runoff into a container apertures were formed at the bottom of each plot to allow soil water to freely infiltrate the slope of each experimental plot was set at 20 which is considered as the critical slope to develop gully erosion tang et al 1998 to simulate the field conditions as much as possible the original soil used in this study was a loessial loam collected from shenmu county which is located in the water wind erosion crisscross region on the loess plateau the main properties of the final experimental soil were listed in table 1 2 2 experiment setup soil was gently crushed before passing through a 10 mm sieve and the sieved soil was thoroughly mixed to minimize the differences among treatments then the soil was packed in each plot in two 10 cm layers at a 1 35 g cm 3 bulk density additionally each soil layer was raked lightly before the next layer was packed to diminish the discontinuity the four selected grasslands were medicago sativa m sativa trifolium repens t repens elymus dahuricus e dahuricus and bromus inermis b inermis which are the most common grasslands during vegetation restoration in the loess plateau according to the local convention the plot grasslands were established in the spring of 2013 a total of five strips were planted with a row spacing of 20 cm bare land was set as the control treatment thus there were five experimental treatments with three replicate plots for each treatment yielding a total of 15 plots all plots were placed outdoor and irrigated during the first weeks to ensure plant survival but plants completely grew under natural conditions later and mainly depended on rainfall for growing compared with natural grasslands differences in soil conditions vegetation types and other hydro climatological factors were minimized in the present study two rainfall experiments were carried out in 2013 and 2014 respectively one day before the rainfall experiments a specialized soil auger of 1 cm diameter was used to determine the soil water content of different treatments according to the measured values different amounts of water were sprayed with a commonly used household sprayer to minimize the differences in antecedent soil water content among treatments soil water content was adjusted to 15 gravimetrically for all plots at the beginning of the experiments pan and shangguan 2006 2 3 measurements and methods according to tang 2004 most of the heavy rainfall intensity in the loess plateau ranges between 100 and 150 mm h 1 the simulated rainfall intensity was set at 120 mm h 1 and each simulation lasted 120 min such a high rainfall intensity was chosen as it is usually a typical intensity of storm that causes serious soil erosion in this region zhou and wang 1992 some studies also selected 120 mm h 1 which corresponds to heavy rain on the loess plateau fang et al 2015 lu et al 2017 pan and shangguan 2006 all rainfall events generating runoff were recorded during each event the runoff and sediments produced every five minutes were collected in plastic buckets after settling of the turbid water the volume of clear water was regarded as the runoff amount the weight of the soil in the bucket after oven drying was taken as the sediment yield to calculate the vegetation coverage vc before each rainfall event three to five jpg format photos were taken using a digital camera the lens and the plot were paralleled and the distance between the two was always the same the vegetation cover was then determined using photoshop cs 3 0 and image j software package huang et al 2013a b biological soil crusts were observed in the upper millimeters of the topsoil and were composed of bacteria algae fungi lichens and bryophytes in different proportions belnap et al 2001 swenson et al 2018 the biological soil crust coverage bscc was calculated following the same approach of the vegetation coverage three metrics i e runoff reduction benefit rrb sediment reduction benefit srb and soil infiltration rate sir mm min 1 were employed to represent the capacity of the different treatments to regulate runoff and sediments and the calculation of each metric was as follows zhao et al 2014 1 rrb r b r v r b 100 2 srb s b s v s b 100 3 sir r i cos α 10 r v s t where rb and rv are the runoff volume ml for the bare land and vegetated plots respectively sb and sv are the sediment yield g for the bare land and vegetated plots respectively ri is the rainfall intensity mm min 1 s is the plot area receiving rainfall cm2 t is the rainfall duration min α is the slope gradient and 10 is the coefficient for dimension conversion in particular eq 3 is based on the assumption of ignoring the evapotranspiration and interception of water by vegetation during rainfall events 2 4 data analysis the results in this article were expressed as mean standard error se of mean the differences in runoff and sediment characteristics among the different treatments were compared by using one way analysis of variance anova procedure all statistical analyses were performed using the software program spss 12 0 spss inc chicago il usa and figures were drawn using sigmaplot 8 0 systat software inc san jose ca usa the statistical significance was evaluated at the 0 05 level 3 results 3 1 runoff volume and sediment yield the time to runoff initiation vegetation coverage biological soil crust coverage runoff volume and sediment yield for the different treatments during the two year experiments were shown in table 2 the bscc and vc of all treatments clearly increased in the second year compared with the values obtained in the first year in spite of plant ages the values of bscc and vc for b inermis and t repens were the highest followed by e dahuricus m sativa and bare land moreover the difference among the five treatments reached a significant level p 0 05 the difference in time to runoff initiation among the treatments was also statistically significant p 0 05 the time in the bare land plots was significantly higher than that observed in the plots with grasslands during the first year but it was the lowest during the second year bromus inermis 141 10 l and t repens 153 08 l produced larger amounts of runoff in the first year but lower amounts in the second year 145 03 l and 133 04 l respectively there were significant differences in sediment yield among treatments in both years f 290 69 p 0 05 for the first year f 81 13 p 0 05 for the second year grasslands produced significantly less sediment yield compared with bare land moreover m sativa produced the highest sediment yields among the different grasslands regardless of the planting ages table 2 3 2 runoff rate sediment rate and sir the runoff rates showed similar changing trends in all treatments during the two year measurements fig 2 a fig 2c the initial runoff rate was relatively low but increased sharply later the initial runoff rate of t repens was the highest in the first year but the lowest in the second year runoff rate reached steady state conditions at 40 min in the first year but became stable earlier i e at 20 30 min in the second year the sediment yield rate slowed down and finally reached steady state conditions and the stabilization time was similar with that of runoff rate due to rill erosion bare land showed a slight increase in runoff rate and sediment yield rate at 95 min fig 2a b and a similar phenomenon appeared in m sativa at 55 min fig 2a b the dynamic process of sir for different treatments was shown in fig 3 the sirs of t repens e dahuricus and b inermis were all lower than that of bare land and m sativa fig 3a after slope runoff generation sir gently decreased however a different trend was observed in the second year when sir significantly decreased at the initial stage and then gradually became stable trifolium repens showed the lowest initial sir among all treatments fig 3b 3 3 runoff reduction benefit and sediment reduction benefit the runoff reduction benefit rrb and sediment reduction benefit srb for the different grasslands during the two year experiments were shown in fig 4 a lower value of rrb represents a better ability of runoff maintenance for grasslands and a higher value of srb represents a better effectiveness of grasslands in sediment reduction in the first year all grasslands showed very low rrbs with the mean value ranging from 31 13 t repens to 11 69 m sativa in the second year the rrbs of the different grasslands slightly increased when compared with the first year with the mean value ranging from 15 58 m sativa to 12 02 t repens overall all grasslands showed high srbs greater than65 during the two year experiments the srb of m sativa was significantly p 0 05 lower than those obtained in the other grasslands however no significant difference was observed among t repens e dahuricus and b inermis moreover a great increase in srb from the first year to the second year was found for all grasslands 4 discussions e dahuricus and b inermis as gramineae grasslands have abundant fibrous roots for the legume species t repens is abundant in fibrous roots while m sativa has a different root architecture with tap roots fan et al 2016 vamerali et al 2003 grasslands especially e dahuricus b inermis and t repens significantly reduced sediment yield when compared with bare land in our study these results were consistent with those reported by wu et al 2010 who proved that vegetation significantly decreased soil erosion and improved soil physical chemical and biological properties plant growth could improve soil conditions through fine root network development and litter accumulation which forms a virtuous cycle to control soil loss gyssels et al 2005 xu et al 2009 wu et al 2016 thus grasslands with accumulated fibrous roots in shallow soil had better effects on reducing sediment yield the results showed that grasslands had relatively lower runoff reduction benefits compared to the superior sediment reduction benefits fig 4 in particular grasslands had higher surface runoff compared with bare land in the first year very likely due to the presence of the root systems leung et al 2015 found that roots occupied soil pores while growing initially affecting both soil saturated hydraulic conductivity and infiltration rate which led to increased runoff grassland had more abundant fine roots in the shallow soil compared with forestland and those fine roots decreased infiltration by clogging the soil pore space archer et al 2002 additionally roots physically combined with soil particles at the soil surface gyssels et al 2005 gradually reduced the infiltration rate and increased the runoff rate due to a surface seal formation until a steady state condition was reached lópez vicente et al 2016 smets et al 2011 another reason might be that grassland had a significantly higher biological soil crust coverage bscc than bare land table 2 biological soil crusts could create an impermeable seal by swelling sheath material during imbibition favoring soil water repellence that was markedly increased in both intensity and persistence thus leading to more rapid ponding lópez vicente and navas 2012 zhang et al 2014 the time to runoff and infiltration rate of bare land and m sativa were obviously higher than those of the other grasslands in the initial stage of rainfall table 2 fig 3 higher bscc may prevent infiltration which would lead to decreased infiltration rate and consequently increased surface runoff biological soil crusts modified the surface micro topography which reduced the speed of water flow and the connectivity of water and sediments among source areas concurrently rodríguez caballero et al 2012 singh and liu 2004 the grasslands with the higher bscc had significantly positive effects on regulating runoff and sediment yields several studies found that infiltration rates in grasslands can be either higher or lower than bare land at different stages of plant growth mašíček et al 2013 zhao et al 2014 in this study the runoff amounts in the plots with b inermis and t repens were significantly lower than those measured in the other grasslands and bare land plots in the second year table 2 additionally the initial infiltration rate was relatively higher fig 3 possibly due to the particularly high vegetation coverage vc bromus inermis and t repens with higher vc correspondingly had more dense root systems which grew maturely in the second year similar results were found by meek et al 1989 who suggested that channels or macropores formed by the decomposition of roots increased infiltration rates and decreased runoff in addition decaying roots increased soil organic matter content which in turn influenced the infiltration capacity due to the change in the burrowing activity and biomass of earthworms fischer et al 2014 plant roots significantly affected soil hydrological processes by forming preferential pathways and increasing hydraulic conductivity which would facilitate the storage and uptake of water and nutrient archer et al 2002 wu et al 2017 although the decomposition of fine roots increased the infiltration rate and decreased runoff volume in the second year the runoff reduction benefit rrb of grasslands were still low in general grassland substantially maintained runoff while reducing sediment yield during the rainfall simulations in this study the differences in erosion process among the different grasslands were attributed to the presence of biological soil crusts vegetation cover and root systems in general grasslands showed comprehensive effects on sediment reduction and runoff maintenance especially the gramineae grasslands with abundant fibrous roots therefore gramineae grasslands maintained moderate surface runoff while storing enough rainwater to meet the demands of growth and controlled soil loss thus they contribute to the improvement of the local environment ultimately with regard to the development of ecological environment in semi arid areas where water is limited gramineae grasslands as typical vegetation type during vegetation restoration could be considered for soil loss control as well as water resources conservation although our study determined the runoff maintenance and sediment reduction performance of different grasslands during the two year experiments there are still some limitations this study was conducted by means of outdoor simulated rainfall experiments and lasted for only two years which might mask the possible time variability in relation torunoff maintenance and sediment reduction performance of grasslands it is unclear that whether grasslands still have great effectiveness in sediment reduction and runoff maintenance under long term planting therefore further studies should be focused on analyzing the effects of grasslands with different planted ages on regulating runoff and sediment yield based on long term field experiments despite these limitations the analysis of sediment reduction and runoff maintenance performance of different grasslands is useful and can potentially contribute to achieve the sustainability of ecological systems during vegetation restoration in semi arid areas 5 conclusions this study confirmed the different dynamic effects caused by four typical grasslands during vegetation restoration on runoff and sediment reduction through two year simulated rainfall experiments the runoff reduction benefit rrb sediments reduction benefit srb and soil infiltration rate sir significantly differed p 0 05 among the different treatments and during the two years and the values of srb greatly increased in the second year indicating that grasslands contributed to greater benefits in soil loss control with increasing planting ages due to the presence of abundant fibrous roots and higher biological soil crust the values of rrb were relatively lower grasslands generally had a greater impact on sediment yield than on runoff volume the two gramineae grasslands reduced sediment yield by more than 90 and showed a better effectiveness in sediment reduction and runoff maintenance and were considered as a suitable management practice to ensure the sustainability of ecological environments during vegetation restoration in semi arid areas acknowledgment we thank dr manuel lópez vicente and dr he honghua for improving the language of this article and also thank the editors and anonymous reviewers for their constructive comments and suggestions on this work this research was funded by projects of national natural science foundation of china nsfc41722107 41525003 the west light foundation of the chinese academy of science xab2015a04 and the youth talent plan foundation of northwest a f university 2452018025 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 03 008 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6594,this study is a review to the special issue on artificial intelligence ai methods for groundwater level gwl modeling and forecasting and presents a brief overview of the most popular ai techniques along with the bibliographic reviews of the experiences of the authors over past years and the reviewing and comparison of the obtained results accordingly 67 journal papers published from 2001 to 2018 were reviewed in the terms of the features and abilities of the modeling approaches input data consideration prediction time steps data division etc from the reviewed papers it can be concluded that despite some weaknesses if the ai methods properly be developed they can successfully be used to simulate and forecast the gwl time series in different aquifers since some of the stages of the ai modeling are based on the experience or trial and error procedures it is useful to review them in the special application on gwl modeling many partial and general results were achieved from the reviewed papers which can provide applicable guidelines for researchers who want to perform similar works in this field several new ideas in the related area of research are also presented in this study for developing innovative methods and for improving the quality of the modeling keywords groundwater level forecasting artificial intelligence neural networks review wavelet 1 introduction measurement and analysis of the groundwater level gwl in aquifers is an important and useful task in the management of the groundwater resources and the knowledge about the gwl variations can be used for quantifying the groundwater availability the gwl variations in wells provide a direct measure of the impact of groundwater development and important information about aquifer dynamics is often embedded in the continuously recorded gwl time series butler et al 2013 therefore the modeling and predicting of gwl is necessary for water managers and engineers to qualify and quantify groundwater resources and to maintain a balance between supply and demands for gwl modeling conceptual or physical based models are traditionally the main tool however they have some practical limitations including the need for large amount of data and input parameters in many cases data is limited on one hand and obtaining accurate predictions is more important than understanding underlying mechanisms on the other hand and therefore the black box artificial intelligence ai models can be a suitable alternative although there are different methods for modeling and predicting gwl in aquifers such as conceptual physical numerical statistical etc methods however in recent years ai methods have been used for their simplicity and acceptable results and many researches have investigated the performance of ai models for gwl modeling in different parts of the world this study is a review of those papers that have used ai methods for modeling and forecasting gwl of course these methods have some weaknesses such as overtraining low generalizability risk of using unrelated data incorrect modeling with inappropriate methods and so on however their simplicity of use high speed run and acceptable accuracy without the need to know the problems physics have led many researchers to apply them it should be noted that it is the nature or perhaps the defect of the ai models that if they were developed for the prediction of a specified time series the accurate results could not necessarily be derived in the similar ones but the major advantage of ai models is the nonlinear and complicated phenomena modeling without the need for full understanding underlying mechanisms rajaee and boroumand 2015 therefore the use of ai approaches in gwl modeling has steadily increased and attracted interest of many researchers in the world in order to develop new and better ai approaches for gwl modeling it is important to investigate what has been done with ai models and current researches and there is a need for researchers to know what other scholars have done in this regard many review papers have been recently published that have explored using ai models in hydrology e g solomatine 2005 or in different hydrological and water resources fields e g maier et al 2010 in the field of river variables modeling and wu et al 2014 in the field of water quality modeling while no review paper is find that has centered on the specific use of ai models for gwl modeling and forecasting each hydrological phenomenon has its own characteristics and it is reasonable that the use of ai models in gwl modeling to be reviewed individually nourani et al 2014 have cited and reviewed some wavelet ai studies in gwl modeling 5 papers however in the best knowledge of the authors there is not yet an individual and comprehensive review paper evaluating the application of ai methods in gwl modeling and forcasting the current review study presents and compares the details of the journal papers dealing with the ai methods for gwl modeling and forecasting in the terms of the features and abilities of the modeling approaches the input data consideration the quantity and quality of used data the study areas and aquifers the prediction time steps the data division etc 67 papers are reviewed in this study these papers have been published in the international journals belongs to the famous publications such as elsevier springer iwa wiley asce etc during the period from 2001 to 2018 the papers were found from searching the web using the relevant key words and were chosen because they were published in well known international journals in the fields of hydrology water resources and ai sciences based on the search journal of hydrology elsevier with 12 papers and water resources management springer with 11 papers are the journals that have been published the most papers in this regard also hydrological processes wiley journal of hydroinformatics iwa hydrogeology journal springer and computers geosciences elsevier each one have been published three papers in this regard the rest of the journals a total of 29 journals that had papers in this regard have been published one or two papers so far table 1 fig 1 shows number of published papers regarding ai in gwl modeling reviewed in this study with respect to year of publication as can be seen such publications have increased in recent years therefore due to the interest of researchers in this field and given the difficulty of conceptual numerical gwl modeling this review was provided to help new researches in this field details of the selected papers are given in table 1 where the papers on the subject of gwl modeling with ai methods are comparing regarding to the authors and year of publication journals and impact factor if region of study type of utilized ai methods hydrological input variables time steps and range of total data the abbreviations used in the table 1 have been explained in the end of the table in the following some very commonly used ai methods for modeling gwl are addressed the methods include artificial neural networks ann adaptive neuro fuzzy inference system anfis genetic programming gp support vector machine svm and some hybrid models such as wavelet ai models firstly a brief description of each method is presented and thereafter the related conducted studies are cited and reviewed this is followed by general results and discussion conclusions and recommendations for future avenues of research 2 artificial intelligence methods for gwl modeling 2 1 artificial neural networks ann for gwl modeling 2 1 1 introductory anns are computational models inspired by biological neural networks they can be used to approximate functions that are generally unknown or to predict future values of possibly noisy time series based on past histories anns are composed of simple elements operating in parallel as in nature the connections between elements largely determine the network function beale et al 2010 a common ann comprised of multiple elements called neurons processing elements and connection pathways that link them the neurons having similar properties are grouped in one single layer typically three separate layers exist in an ann namely input hidden and output layers the input layer takes input variables which in the case of gwl forecasting are usually the precipitation temperature gwl etc time series in the hidden and output layers each neuron passes its weighted and biased input through a desired transfer activation function to produce a result anns are trained with a sample data so that a particular input leads to a specific target output training means tuning the adjustable network parameters called weights and biases to optimize the network performance the training process can be done with various training learning algorithms the levenberg marquardt lm algorithm the back propagation bp algorithm the bayesian regularization br algorithm and the gradient descent with momentum and adaptive learning rate back propagation gdx algorithm are examples of most used training algorithms in the literature different ann types have been widely described in the literature however several types of them are briefly presented here the feed forward neural networks fnns propagate input signal through the network in a forward direction layer by layer the multilayer perceptron mlp network as a historical fnn consists of an input layer one or more hidden layers and one output layer the recurrent neural networks rnn feed the outputs of the hidden layer back to itself in the rnns an additional layer is interconnected with the hidden layer that plays the role of the network history the radial basis function rbf networks are also feed forward but have only one hidden layer that uses gaussian transfer function and a standard euclidean distance to measure how far an input vector is from a specific center vector the amount of euclidean distance is transferred by the gaussian function that determines the output of the layer rbf networks tend to learn much faster than a fnn the self organizing map som network as a kind of anns consists of one input layer and one output layer called kohonen layer the input layer is fully connected to the output layer the som is trained using an unsupervised competitive training algorithm the n dimensional input vector is sent through the network and the euclidean distance between the weight vector and the input vector is computed the training process will be continued to select best neurons that reduce the distance between the weights and inputs an advantage of the som is to map high dimensional input space into low dimensional space regardless of the type of utilized ann they have some common modeling stages fig 2 shows the typical stages of using anns for gwl simulation and forecasting 2 1 2 bibliographic review recent experiments in gwl modeling have reported that anns may offer a promising alternative for conceptual methods in one of the first studies coulibaly et al 2001 compared three types of ann models using gwl precipitation and temperature time series as the inputs of models to simulate average monthly gwl in the gondo aquifer burkina faso simulation results showed that the rnn is most efficient compared to the static structure input delay ann and rbf ann lallahem et al 2005 evaluated ann for estimating the monthly gwl in an unconfined chalky aquifer in northern france the input data was the gwl of 13 piezometers rainfall mean temperature precipitation and potential evapotranspiration and the main objective was to simulate the gwl in a selected piezometer the simulations revealed the merit of using mlp models daliakopoulos et al 2005 tested seven different ann models with various architectures and training algorithms for monthly gwl forecasting in the island of crete greece the input variables were the past gwl temperature precipitation and river discharge the fnn trained with the lm algorithm had the best results nayak et al 2006 investigated the potential of mlp trained with bp algorithm in forecasting the monthly gwl in an unconfined coastal aquifer in india the input variables were selected as precipitation canal releases and gwl of the observation well and two neighboring wells the performance was good for 1 and 2 month ahead forecasting but was deteriorated after 2 month krishna et al 2008 applied several ann training algorithms to predict monthly gwl in an urban coastal aquifer in andhra pradesh state india it was found that the fnn trained with lm algorithm is a good choice compared to br and rbf algorithms in their study gwl were also predicted in neighboring wells using model parameters from the best network of a well mohammadi 2008 tested modflow and two types of ann i e mlp and rnn to simulate the monthly gwl of a karstic aquifer located in iran he used data sets generated by modflow for training of the anns the results indicated that ann models needed less input data and took less time to run compared to modflow nourani et al 2008 compared six different types of anns for spatiotemporal gwl forecasting in tabriz aquifer iran the monthly gwl in central well precipitation mean temperature and average discharge were selected as the inputs the optimal ann was a fnn trained with lm algorithm which was then applied to forecast gwls of selected wells as the spatial model feng et al 2008 applied fnn to investigate the effects of 7 factors i e initial gwl precipitation evaporation water reservoir inflow population synthesis irrigation ratio and irrigation area on monthly gwl in shiyang river basin china sensitivity analysis with the models demonstrated that groundwater extraction for irrigation is the predominant factor responsible for declining gwl tsanis et al 2014 developed a fnn trained with the lm algorithm with five input variables i e precipitation temperature runoff gwl and specific yield for forecasting the monthly gwl in messara valley crete greece they used a deterministic component which linked precipitation with the seasonal recharge of the aquifer and projected the seasonal average precipitations results showed that the specific yield marginally improved the forecasting but the linearly projected precipitation component drastically increased the forecasting banerjee et al 2009 used fnn model trained with lm algorithm to predict the monthly gwl of four diversified wells in kurmapally watershed hyderabad india they have not mentioned the used input variables but forecasted the gwl considering varying recharge and pumping conditions yang et al 2009 applied the bp ann and the integrated time series its models to forecast monthly average gwl in the western jilin province of china the input variables were only the past gwls at different intervals of time the simulation results indicated that both ann and its models were accurate in reproducing the gwls but in the test phase the ann was superior to the its mohanty et al 2010 developed three different training algorithms viz lm br and gdx algorithms for weekly gwl forecasting in a tropical humid region eastern india the inputs to the models consisted of precipitation pan evaporation river stage water level in the drain pumping rate and gwl in the previous week the br algorithm was found slightly superior to the two other algorithms chen et al 2010 combined the theory of som and rbf the proposed model could decide the number of rbf ann hidden units with using the two dimensional feature map which is constructed by som the inputs were the monthly average gwls of six wells in southern taiwan while the output was the monthly average gwl of an individual well the results showed that the four site input model was more competent compared to the single site model and six site model one year later chen et al 2011 combined of the som and bp ann for the same study area here the model inputs were the monthly average gwls of ten wells while the output was the gwl of an individual well it was found that the multi site som bp ann model provided the most accurate predictions in comparison to the autoregressive integrated moving average arima and single ann models trichakis et al 2011 simulated daily gwl by mlp at a well located in the karstic artesian edward s aquifer in texas usa the input variables were the day number precipitation pumping and gwl the testing data were used to check the ability of the mlp to interpolate or extrapolate in other wells in the region the results showed that there was a need for exact knowledge of pumping from each well in karstic aquifers as it was difficult to simulate the sudden drops and rises sreekanth et al 2011 compared the fnn trained with lm algorithm and anfis for estimation of the gwl of the maheshwaram watershed india the inputs included the monthly gwl in 22 wells along with rainfall temperature evaporation and relative humidity the results showed that the fnn provided better accuracy compared to anfis rakhshandehroo et al 2012 used fnn rbf rnn and a generalized regression neural network for monthly gwl prediction in shiraz plain iran the precipitation gwl temperature evaporation and runoff were utilized as the input data best performances were achieved by fnn and rnn networks respectively taormina et al 2012 applied fnn for long period simulations of hourly gwls in a coastal unconfined aquifer sited in the lagoon of venice italy the fnn was first trained to perform one hour ahead predictions using past gwl rainfall and evapotranspiration data after the training simulations were produced by feeding back the computed outputs in place of past observed data the fnn reconstructed accurate gwl for long periods at least six months relying only on the rainfall and evapotranspiration data sahoo and jha 2013 compared mlp trained with lm algorithm and multi linear regression mlr approach in monthly gwl forecasting considering rainfall temperature river stage gwl and 11 seasonal dummy variables as inputs the study area was konan basin located in kochi japan they concluded that mlp models have better results however considering the practical advantages of the mlr it was recommended as a cost effective gwl modeling tool ying et al 2014 compared the rbf ann arima and its models for gwl forecasting of two wells in jilin china monthly gwl was the only variable used to develop the models they concluded that for forecasting the dynamics of the gwl the rbf ann is preferable but for analyzing gwl variation the its and arima may be more appropriate juan et al 2015 developed two fnn models one with three inputs previous gwl temperature and precipitation and another with two inputs temperature and precipitation only to forecast the daily variations of the supra permafrost gwl in the qinghai tibet plateau china the fnns were trained with lm algorithm and the results indicated that the three inputs model produced better accuracy performance however if there are no field observations of the gwl the models developed using only two inputs also have good accuracy gholami et al 2015 used a mlp trained with lm algorithm to simulate annual gwl fluctuations of two wells located in an alluvial aquifer of the caspian sea southern coasts iran for the period from 1912 to 2013 the tree ring diameter and the precipitation during the growing season were the input parameters for the mlp and the gwl during the growing season was the output the results showed that the integration of dendrochronology and ann renders a high degree of accuracy in the simulation of annual gwl mohanty et al 2015 applied fnn for simultaneous forecasting of the weekly gwl in 18 wells located over a river basin in india the inputs were selected as rainfall pan evaporation river stage water level in the surface drain pumping rates of 18 sites and gwls of 18 sites in the previous week which led to 40 input nodes and 18 output nodes comparison between the lm br and gdx training algorithms showed that the gdx was the most suitable algorithm for the study area sun et al 2016 applied an mlp trained with lm algorithm to forecast the daily gwl in a freshwater swamp forest of singapore the inputs to the model were the surrounding reservoir levels and rainfall the results revealed that mlp produced better prediction with a leading time of 1 day compared to mlr wunsch et al 2018 used the nonlinear autoregressive with exogenous inputs neural network narx for gwl forecasting of several wells in southwest germany precipitation and temperature were chosen as input variables all input and target time series were decomposed using the seasonal trend based on loess algorithm to detect significant time lags and determine input and feedback delays needed for narx application the results showed that narx is suited to perform gwl predictions for uninfluenced observation wells even though the number of input variables is limited ghose et al 2018 developed the rnn model to forecast monthly gwl of a well in odisha india as a function of rainfall temperature humidity runoff and evapotranspiration from the results evapotranspiration and runoff were the influencing parameters which affect the gwl and inclusion of them improved the model efficiency lee et al 2018 applied the fnn to predict hourly gwl of 8 observation wells located in yangpyeong riverside area south korea they investigate the relative impacts of the input variables and as a result used the river level and pumping rates from two extraction wells as input variables while the precipitation was found to be a weak influencing factor and therefore it was not used as an input variable kouziokas et al 2018 used multiple fnn with various network structures and training algorithms to forecast the daily gwl of a well located in montgomery county pennsylvania usa using the humidity precipitation and temperature as input variables the fnn with the lm training algorithm was the best model 2 1 3 results an assessment of the various studies on ann modeling of the gwl revealed the following issues 1 the ann models can be extended easily from univariate to multivariate cases compared to the conceptual models and the model complexity can be varied simply by altering the transfer function training algorithm or network architecture similar to the regression models the input variables can be considered based on an empirical proof or a correlation analysis the results of the reviewed papers also indicated that anns capture the complex non linear behavior of the gwl time series relatively better than the regular regression models such as arima and mlr 2 the reviews reveal that the lm algorithm is the most popular training algorithm used to train anns for gwl modeling the lm algorithm is a modification of the classic newton algorithm used for finding an optimum solution to a minimization problem the lm algorithm is often characterized as more stable and efficient and some researchers point out that it is faster and less easily trapped in local minima than other training algorithms daliakopoulos et al 2005 zounemat kermani et al 2013 in a study of comparison the performance of rbf and lm feed forward anns for predicting daily watershed runoff concluded that lm algorithm is superior to the rbf in prediction of one day ahead base and high flows but the rbf algorithm outperformed the lm in predicting flood events the gwl time series do not possess a characteristic such as flood in runoff time series therefore it seems that the superiority of lm in gwl modeling correspond to the results of the study of zounemat kermani et al 2013 3 the three layers fnn with the sigmoid transfer function in the hidden layer and linear transfer function in output layer is the most common structure of ann for gwl modeling the sigmoid function is differentiable continuous and monotonically increasing in its domain and it is the most frequently employed function in modeling ravansalar and rajaee 2015 it should be mentioned that in the majority of reviewed papers the structure of ann and number of hidden neurons were achieved by a trial and error procedure 2 2 adaptive neuro fuzzy inference system anfis for gwl modeling 2 2 1 introductory the adaptive neuro fuzzy inference system is a combination of an adaptive neural network an and a fuzzy inference system fis thus it has potential to capture the benefits of two methods in a single framework jang 1993 introduced architecture and a learning procedure for the anfis that uses a neural network learning algorithm for constructing a set of fuzzy if then rules with appropriate membership functions mfs from the specified input output pairs the fis corresponds to a set of fuzzy if then rules that have learning capability to approximate nonlinear functions there are two approaches for fis namely mamdani and sugeno the differences between these two approaches arise from the consequent part mamdani s approach uses fuzzy mfs whereas sugeno s approach uses linear or constant mfs the anfis is an ai method with flexible mathematical construction which is capable of identifying complex nonlinearity and uncertainties due to randomness and imprecision between variables without attempting to reach an understanding as to the nature of the phenomena this approach is capable of approximating any real continuous function on a compact set to any degree of accuracy thus in parameter estimation forecasting where the given data are such that the system associates measurable system variables with an internal system parameter a functional mapping may be constructed by anfis that approximates the process of estimation of the internal system parameter more information on anfis can be found in jang 1993 2 2 2 bibliographic review in the area of gwl modeling with anfis kholghi and hosseini 2009 applied the ordinary kriging and anfis for spatial interpolation of gwl in an unconfined aquifer in qazvin iran they use the gwl data of 95 wells for training and testing the models the gaussian mf was used in the anfis models the results showed that the contour plot of isopieze lines estimated by anfis was more efficient than those by kriging jalalkamali et al 2011 investigated the abilities of anfis and ann with various combinations of monthly temperature rainfall and gwls in two neighboring wells as the inputs to predict the gwl of another well located in kerman plain iran the results showed that applying the gwls of the current and one month before of the well and the neighboring wells was the best input combination to predict gwl and the anfis models using gaussian mf had better results compared to the anns shirmohammadi et al 2013 applied system identification time series and anfis models to predict monthly gwl in mashhad plain iran the only input variable of the models was the precipitation in the anfis models they tested several mfs such as triangular gaussian and bell shaped functions the results showed that the bell shaped mf had the best performance and the anfis model outperformed both time series and system identification models emamgholizadeh et al 2014 compared ann and anfis in forecasting of monthly gwl in bastam plain iran they considered the rainfall recharge irrigation returned flow and pumping rates from water wells as input data and found that anfis outperformed the ann the results showed that applying anfis with different structures had the most accuracy when it used with trapezoidal mf mirzavand et al 2015 investigated the abilities of anfis and svr in estimating monthly gwl fluctuation in the kashan plain iran by using the inputs of stream flow evaporation spring discharge aquifer discharge and rainfall the results indicated that the anfis model using bell shaped mf performed better than the svr khaki et al 2015 applied ann and anfis to simulate monthly average gwl in the langat basin malaysia the gwl rainfall humidity evaporation minimum temperature and maximum temperature were applied as the input variables of the models the obtained results of the anfis models were superior to those of anns and in the anfis models the bell shaped mf outperformed the gaussian mf gong et al 2015 tested the validity of ann svm and anfis in the prediction of the monthly gwl for two wells near lake okeechobee in florida united states the precipitation temperature past gwls and lake level were used as input data the results showed that the gwl predictions from anfis and svm were more accurate than that from ann 2 2 3 results the review of cited studies on anfis modeling of the gwl showed that 1 in the cited papers applying anfis as an alternative approach to predict the gwl leads to more accurate results in comparison with the ann since anfis integrates both neural networks and fuzzy logic principles it is more likely to deal with non stationary time series more effectively 2 in three studies i e shirmohammadi et al 2013 mirzavand et al 2015 khaki et al 2015 the bell shaped mf was the best in comparison with other mfs while in two studies i e kholghi and hosseini 2009 jalalkamali et al 2011 the gaussian mf yielded higher accuracy and in the study of emamgholizadeh et al 2014 the trapezoidal mf was the best in comparison of others in the meanwhile gong et al 2015 have not mentioned anything about the used mf generally there was not any exact method for choosing the mfs in the reviewed papers and instead a trial and error procedure was used for finding an appropriate mf so use of those mfs which do not cause overfitting and give least error can be recommended 2 3 genetic programming gp for gwl modeling 2 3 1 introductory the gp as a generalization of genetic algorithm ga is an evolutionary algorithm based on biological evolution inspired by darwinian theories of natural selection and survival of the fittest the gp considers an initial population of randomly generated equations which are achieved from the random variables numbers and functions the function involves arithmetic operators and other mathematical functions e g sin cos etc or user defined expressions which should be chosen based on some understanding of the process the initial population is then applied to an evolutionary process to evaluate the fitness of the evolved programs by defining a fitness function in forecasting problems the root mean squared error rmse between forecasted and observed data is often used as the fitness function the programs that best fit the data are then selected to produce better program through two genetic operators crossover and mutation the evolution process is repeated and driven towards to find expressions which describe the data and give the best performance of the model 2 3 2 bibliographic review shiri et al 2013 investigated the abilities of gp anfis ann svm and arima techniques for daily gwl forecasting in korea the gwl rainfall and evapotranspiration data were used as the inputs of the models for gp models the root relative squared error was employed as the fitness function the results showed that gp models were superior compared to other models fallah mehdipour et al 2013 compared the capability of the gp and anfis to predict and simulate monthly gwls in three wells in the karaj plain of iran the precipitation evaporation and gwls were used as the inputs of the models they have noted that the fitness function of gp was considered an error criterion but they have not mentioned the type of it results showed that in the gp models the average errors were less compared to the anfis models 2 3 3 results originally developed for optimization problems the gp was extended to solve forecasting problems such as gwl forecasting in this case the minimum error e g rmse between forecasted and observed gwls has been applied as the fitness function of the gp although among other ai methods the gp may not be the best way to forecast the gwl in the two aforementioned studies this model outperformed other models similar to the ann and anfis in the reviewed gp papers the input parameters were chosen based on a combination of empirical and trial and error analysis the low number of papers on gwl modeling via gp demonstrates the need to investigate more about application of gp and in gwl modeling 2 4 support vector machine svm for gwl modeling 2 4 1 introductory the svm is a statistical machine learning theory it has not a priori determined structure but the input vectors supporting the model structure are selected through a model training process vapnik 1998 this machine learning method is based on the extension of the idea of identifying a hyper plane that separates two classes in classification a svm constructs hyper planes in an infinite dimensional space which can be used for classification regression or other tasks the mappings used by svm schemes are designed to ensure that dot products may be computed easily in terms of the variables in the original space by defining them in terms of a kernel function selected to suit the problem the svm can also be used as a regression method the support vector regression svr method uses the same principles as the svm for classification with only a few minor differences the svr generalization performance depends on a good setting of some parameters and the kernel function the svr parameters represent some constants like regularization constant and kernel function constant and control the prediction regression model complexity the kernel function changes the dimensionality of the input space to perform the regression task with more confidence a full mathematical overview of svm is presented by vapnik 1998 originally developed for classification it was extended to solve prediction problems and in this capacity was used in hydrology related tasks 2 4 2 bibliographic review yoon et al 2011 developed ann and svm models for predicting gwl fluctuations of two wells at a coastal aquifer in south korea considering a six hourly time step the past gwl precipitation and tide level were selected as the inputs of the models it was found that the past gwl was the most effective input variable for the study site and tide level was more effective than precipitation the results showed that the performance of the svm was better than the ann yoon et al 2016 utilized a weighted error function approach to improve the performance of ann and svm models for the prediction of daily gwl in response to rainfall the input variables were gwl and rainfall data in south korea the comparison of the models showed that the recursive prediction performance of the svm was superior the ann huang et al 2017 used the chaos theory to select the best input lags of gwl time series and developed the svm and bp ann models using the particle swarm optimization method to obtain the parameters of svm the models were applied to predict the daily weekly and monthly gwl in china the chaotic svm model had higher accuracy than the linear svm and chaotic bp ann models nie et al 2017 employed precipitation evaporation and temperature as the inputs of svm and rbf ann models to forecast monthly gwl in jilin province china the svm model was more accurate and had fewer uncertainties caused by errors in the measurements of the inputs and outputs mukherjee and ramachandran 2018 applied the grace satellite terrestrial water storage tws data along with meteorological variables precipitation min and max temperature humidity and wind to predict gwl with the svr ann and linear regression models the results showed that tws is a highly significant variable to model gwl and the svr was the best model guzman et al 2018 compared svr and narx ann models for gwl prediction of an irrigation well located in the southeastern usa they evaluated the best combination from three input variables i e daily gwl precipitation and evapotranspiration data for each model the gwl precipitation scenario provides the optimal combination for model inputs and the svr was superior to the ann tang et al 2018 concluded that the least square svm perform better than classical svm and some other ai models in gwl forecasting the only input variable was the hourly gwl of four observation wells located in northern uk 2 4 3 results the svms svrs are powerful machine learning methods that have been developed and applied for many classification prediction problems over past years although the number of published papers considering gwl modeling via svm is low however it should be noted that svm has been used for predicting of many time series for a myriad of practical applications in the world in the svm modeling the appropriate selection of the kernel function and parameter values is critical in the five of seven aforementioned papers the rbf kernel function was selected whereas in the two other ones i e yoon et al 2011 and mukherjee and ramachandran 2018 the utilized kernel function was not mentioned over period of years the rbf function has become the choice of many researchers as the kernel function for svr because of its accuracy and reliable performance suryanarayana et al 2014 for selecting the optimum parameters of svm model most of the papers have employed a procedure like trial and error except huang et al 2017 that have been used the particle swarm optimization method to obtain the optimum parameters of svm 2 5 hybrid ai techniques for gwl modeling 2 5 1 introductory since it has been revealed that the ai models have some limitations with the nonlinear and non stationary processes some hybrid modeling approaches which include certain data preprocessing and or combine different ai techniques have been also developed in the recent years to increase the capabilities of the ai methods combining different ai methods in different stages of the modeling and applying efficient methods for input data pre processing make the developing of these models more effective for example the gp technique can be used to optimize the ai input variables and or ai regulation parameters in another example the geostatistical techniques such as kriging can be combined with the ai methods for spatiotemporal gwl modeling according to the capability of geostatistics tools in spatial estimation hybrid ai geostatistic models have been applied in some papers to use their potential for spatiotemporal simulation of gwl the wavelet analysis is an example for the data pre processing which has been widely used in gwl modeling wavelet analysis is applied for de noising compression and decomposition of input data time series wavelet is a time dependent spectral analysis that unravels time series in the time frequency space to provide a time scale description of the processes and their relationships daubechies 1990 the wavelet analysis can be performed continuously or discretely the continuous wavelet transform cwt can operate at every scale but it requires a lot of computational time and generates a large amount of data in many studies the discrete wavelet transform dwt was used where only a subset of scales and positions are chosen to make the calculations in the wavelet ai models cited in scientific papers the decomposed sub time series were used as the inputs of ai models instead of the main time series the schematic structure of some of hybrid ai models for gwl modeling is shown in fig 3 2 5 2 bibliographic review afterwards the ai methods were developed for prediction problems the researchers tried to combine different type of them to overcome the shortcomings and increase their accuracy almost since 2011 there has been an interest in application of the wavelet analysis in combination with different ai methods adamowski and chan 2011 used a wavelet ann model for gwl forecasting at two sites in quebec canada the monthly total precipitation average temperature and average gwl were decomposed at two levels by wavelets and imposed to the ann the model was found to provide more accurate gwl forecasts compared to the ann and arima models nourani et al 2011 presented an ann geostatistics methodology for spatiotemporal prediction of gwl in shabestar plain which adjoins to urmieh lake as a coastal aquifer in iran monthly gwls data from 11 piezometers rainfall and lake water levels were the inputs of ann the ann was trained for each piezometer to predict the gwl of the next month then kriging was applied to the outputs from ann models in order to estimate gwl at any desired point in the plain kisi and shiri 2012 investigated the ability of a wavelet anfis model to perform one two and three day ahead gwl forecasting of two wells located in illinois state usa using only past daily gwl data they found that excluding the detail coefficients from the inputs and using only approximation components significantly increase the accuracy of anfis models the hybrid model outperformed anfis particularly for two and three day ahead forecasts moosavi et al 2013a applied a number of different structures for ann anfis wavelet ann and wavelet anfis models to evaluate their performances to forecast gwl with 1 2 3 and 4 months ahead under two case studies in mashhad plain iran it was demonstrated that wavelet transform can improve the accuracy of forecasting it has been also shown that the forecasts made by wavelet anfis models are more accurate than those by other models they found that the decomposition level in wavelet transform should be determined according to the periodicity and seasonality of data series moosavi et al 2013b also investigated the optimum structures of wavelet ann and wavelet anfis models for gwl forecasting in the same case studies they used the optimization taguchi method to assess different factors affecting the performance of models it was revealed that transfer functions of ann membership function types of anfis and the mother wavelet type are the most important factors comparison of optimal models demonstrated the better performance of wavelet anfis maheswaran and khosa 2013 showed that wavelet based nonlinear as wavelet volterra model performed better than wavelet ann and wavelet linear regression models for gwl forecasting the study area was northern saanich peninsula canada and the inputs of the models were the level five decomposed monthly average gwl time series suryanarayana et al 2014 predicted monthly gwl of three observation wells in the city of visakhapatnam india using wavelet svr modeling the monthly data of precipitation maximum temperature mean temperature and gwl for the period 2001 2012 are used as the input variables results indicated that wavelet svr model gives better accuracy compared with svr ann and arima models he et al 2014 linked wavelet and fractal theory methods to ann for gwl forecasting of three sites located in ganzhou region northwest china the fractal dimension was convenient for quantitatively describing the irregularity or randomness of time series data the results showed that this model is suitable for sites at which the fractal dimension of the wavelet decomposition detail components is large tapoglou et al 2014 combined ann fuzzy logic and kriging in order to simulate the spatial and temporal distribution of gwl in an area across the isar river in bavaria germany the daily data including the gwls in 64 wells the surface water elevation at five observation points across the river temperature and rainfall were used as input variables to the 64 anns different ann architectures and variogram models were tested together with the use or not of a fuzzy logic system the isocontour maps were presented for the hydraulic head the best results were achieved with the use of the fuzzy logic system and by utilizing the power law variogram yang et al 2015 developed a wavelet ann and an its model to predict gwl of a shallow coastal aquifer in fujian province china the input was only the monthly gwl time series of two representative wells the wavelet ann models provided more accurate results compared to the its models khalil et al 2015 compared mlr ann wavelet mlr wavelet ann and a wavelet ensemble ann model for the forecasting of gwls as a result of recharge via tailings from an abandoned mine in quebec canada the wavelet ensemble ann consisted of a group of wavelet ann members where each of these members was trained for the same problem and then combined to produce the output the daily tailing recharge total precipitation and mean air temperature were used as inputs while the output was gwl for lead times of 1 day 1 week and 1 month the wavelet ensemble ann model performed best for each of the three lead times nourani et al 2015 proposed a wavelet entropy data pre processing approach for ann based gwl modeling they used the som based clustering technique to identify spatially homogeneous clusters of gwl data and the wavelet transform to extract the non stationary gwl runoff and rainfall time series the results indicated that the som method decreased the dimensionality of the input variables and the wavelet analysis increased the performance of the ann model jha and sahoo 2015 developed five hybrid ann ga models for simulating spatio temporal gwl in konan basin japan the relevant input variables such as rainfall max and min temperature river stage and gwl have been considered to simulate gwl at 17 sites the inputs and parameters of the ann were optimized using ga optimization technique the ga was superior to the commonly used trial and error method for determining optimal ann architecture and inputs chang et al 2016 combined the som the nonlinear autoregressive with exogenous inputs narx network and the kriging for predicting monthly gwl in zhuoshui river basin taiwan based on hydrologic data such as rainfall stream flow and gwl the som was used to classify the spatiotemporal patterns of regional gwl the narx was used to predict the mean of regional gwl and the kriging was used to interpolate the predictions into finer grids of locations consequently the prediction of a gwl map was obtained han et al 2016 coupled som and a statistical method to predict spatiotemporal monthly gwl in an arid irrigation district in the western hexi corridor northwest china the som was applied to identify spatially homogeneous clusters of wells and the gwl forecasting was performed through developing a stepwise cluster multisite inference model with various predictors including climate conditions well extractions surface runoffs reservoir operations and gwl measurements at previous steps hosseini et al 2016 combined ann and ant colony optimization aco to simulate the gwl in shabestar plain iran the back propagation ann was utilized to reproduce gwl variations using the input variables including rainfall average discharge temperature evaporation and some annual time series then aco was used to optimize and find initial connection weights and biases of a bp algorithm during the training phase they found that the hybrid model could reduce overtraining nourani and mousavi 2016 presented a hybrid wavelet ai meshless model for spatiotemporal gwl modeling in miandoab plain iran in this way firstly monthly gwl in different wells were de noised using threshold based wavelet method and the impact of de noised and noisy data was compared in temporal gwl modeling by ann and anfis then both ann and anfis models were calibrated using gwl data of each well rainfall and runoff to predict the gwl at one month ahead finally the simulated gwls were considered as interior conditions for the multi quadric rbf based solve of governing partial differential equation of groundwater flow to estimate gwl at any desired point within the plain the results showed that the wavelet de noising approach can enhance the performance of the modeling ebrahimi and rajaee 2017 investigated the effect of wavelet analysis on the training of the ann mlr and svr approaches in simulating gwl the only input variable was the monthly gwl data of two wells in the qom plain iran the results showed that for both wells the meyer wavelet produced better results compared to the other wavelets and the wavelet mlr and wavelet svr were the best models for the wells 1 and 2 respectively barzegar et al 2017 combined wavelet with ann and group method of data handling gmdh models for forecasting the monthly gwl in azarbijan iran the gwl time series were decomposed with different wavelets at two levels and the stepwise selection was used to select appropriate lag times as the inputs of the models to combine the advantages of different wavelets a least squares boosting algorithm was applied the boosting multi wavelet ann models provided the best performances wen et al 2017 applied wavelet ann with three different input combinations i e 1 gwl only 2 climatic data and 3 gwl and climatic data to forecast the monthly gwl of two wells in zhangye basin china the model with only gwl as its input yielded the best performance for one month forecasts however for two and three monthly forecasts the model with gwl and climatic data as inputs was superior rakhshandehroo et al 2018 used wavelet ann trained with improved harmony search algorithm to forecast the long term daily gwl of two wells in southeast usa the only input variable was the daily gwl and the one year ahead prediction with the proposed model was acceptable yu et al 2018 compared the wavelet ann and wavelet svr models in forecasting of monthly gwl of 3 wells in northwest china four wavelet decomposition levels were employed to decompose input time series discharge evapotranspiration and gwl the results showed that the wavelet svr performed better than wavelet ann zare and koch 2018 used wavelet anfis model with several combinations of gwl and precipitation as the inputs to simulate monthly gwl in the miandarband plain iran the results indicated that using the symlet mother wavelet with two decomposition levels outperformed other models 2 5 3 results in the last years development of hybrid modeling approaches is seen and in particular there has been an increasing interest in wavelets ai approaches for gwl modeling these studies have shown that the hybrid coupling models performed better than the regular models as a downside however these models have also been criticized on various aspects and in particular the risk posed by overtraining of the model and the difficulties of parameter estimation using heuristic methods maheswaran and khosa 2013 a review of the various studies on hybrid ai modeling of the gwl revealed the following issues 1 by using the hybrid models and in particular wavelet analysis to extract the input time series a greater understanding and ability to simulate gwl can be achieved the results of the studies explored in this section have revealed a higher degree of efficiency of hybrid models compared with single models in accurately forecasting gwl 2 in the all reviewed wavelet ai papers the dwt has been applied to decompose time series rather than cwt in addition to the simplicity of using dwt this can partly be due to the nature of gwl time series because they are recorded discretely furthermore the gwl is linked with several hydrological phenomena thus use of dwt at specific levels which likely refers to hourly daily or monthly effects appears to be more useful than application of cwt which generates much more redundant information 3 the more frequently mother wavelets used for gwl decomposition are db2 and db4 which have been considered as the appropriate mother wavelets according to the nourani et al 2014 similarity in shape between the mother wavelet and the time series is often the best guideline in choosing a reliable mother wavelet therefore it can be an indication of a relative similarity between the general shape of gwl time series and daubechies family wavelets 4 according to the study of maheswaran and khosa 2012 in the field of hydrological forecasting some mother wavelet forms that have a compact support showed better performance in the case of time series that have a short memory with transient features in contrast mother wavelets with a wider support yielded better forecasting efficiencies with regard to the time series that have long term features therefore in the case of gwl time series it does not seem that compact wavelets to be suitable for decomposition because the gwl time series have long term features rather than transient features and therefore the wavelets with a wider support are more compatible with the time series 5 in the aforementioned wavelet based papers five papers adamowski and chan 2011 moosavi et al 2013a b nourani et al 2015 ebrahimi and rajaee 2017 have used the decomposition level 2 two papers suryanarayana et al 2014 wen et al 2017 have used the decomposition level 4 and one paper maheswaran and khosa 2013 has used the decomposition level 5 as the optimum decomposition levels in the meanwhile in kisi and shiri 2012 yang et al 2015 and rakhshandehroo et al 2018 the decomposition levels were not mentioned according to nourani et al 2014 decomposition level l contains l details and as an example in the case of monthly modeling denotes 2 n month mode where n 1 2 l so 22 month mode is nearly seasonally mode when multilevel sub signals are entered in the wavelet ann models as input nodes their assigned weights by the ann method will be different at different decomposition levels therefore high weights will be applied to the high levels of the time series rajaee 2011 3 general results and discussions in this section some general results derived from the 67 reviewed papers such as the results related to the considering time steps input variables data set size data division study areas and type of aquifers etc have been mentioned and discussed 3 1 time step selection in the case of utilized time steps the majority of ai models reviewed in this study have been considered the monthly time steps for gwl modeling the distribution of the utilized time steps is given in fig 4 as can be seen the monthly time step was used in 46 of the 67 papers reviewed followed by daily 11 papers daily 4 papers and weekly 4 papers time steps a number of different time steps i e 6 hourly multi monthly and annually were used in some of the papers reviewed as well the high use of the monthly time steps can be related to the high availability of monthly recorded gwl data compared to other time steps in the most parts of the world the gwls do not have often significant hourly daily or even weekly variations however in some areas like coastal aquifers yoon et al 2011 taormina et al 2012 or areas near the lake of dams lee et al 2018 the gwls are under influence of tidal lake effects and may have hourly or daily variations 3 2 input data consideration fig 5 shows the input variables that have been employed in ai gwl modeling according to the reviewed papers from fig 5 it can be found that the past steps of the gwl time series is the most frequently used input variable for ai models to forecast the gwl among 67 papers 52 papers have been employed the gwl as an input variable even 12 papers have been considered the gwl as a single auto correlated input variable without any other exogenous input variable as well as the gwl the precipitation has been frequently used 48 times as an input variable furthermore some hydrological time series such as temperature river discharge surface runoff evapotranspiration surface water lake level pumping rates extraction from wells and humidity have been also used as the input variables in the reviewed papers other employed input variables such as irrigation patterns population day number seasonal dummy variables tree rings etc have been used to a lesser extent in the reviewed papers and it seems that some of them cannot be easily accommodated at the stage of input consideration although in the stage of input consideration some of the hydrological time series have been used more than the others however it should be noted that the input data selection has been mostly based on data availability in the study area rather than a physical analysis for the required data in the meanwhile this cannot be considered as a weakness of these studies because in many regions data is limited and also it is the nature of ai models that they can work with any data however it is better that a statistical analysis and in particular a correlation analysis be done with different data before employing them for modeling in order to obtain suitable input pattern for ai models 3 3 data set size according to the table 1 the number of total sample data sets applied for gwl modeling varies from 23 sets banerjee et al 2009 to 23 850 sets taormina et al 2012 generally the more samples especially for training can ensure better performance of model giving a better chance for locating global minimum of the error function provided that an overtraining does not happen during training however there are some cases that we may not be able to even collect 40 samples for training the model like the data of annual tree rings in gholami et al 2015 the quality of the available data and the relevance of the input data with the desired output are also important since a large amount of irrelevant data can hinder the model performance by confusing the training process tsanis et al 2014 there therefore has to be a balance between the quantity of data and the relevancy to the output in the all 67 reviewed papers there was not any fixed rule that say how to get an optimum data set size required for ai modeling it seems that considering the available data experimental or perhaps trial and error tools were used here from table 1 it can be seen that the majority of studies have been applied a data set size between 100 and 200 sets and perhaps this can be considered as a suitable data set size in the meanwhile it can be found that ai models are capable to deal with different size of data set but there was not any certain comment in the reviewed papers about that in each sample size i e big or small what should we do for optimizing the model performance e g which training algorithm is better for small sample size in ann it seems trial and error procedures have been used here 3 4 data division in the case of data division for training validation and testing tasks there was not a specific rule in the reviewed papers which explain how to consider an optimum amount for each sub data set in some of the reviewed papers the total data set were divided into three parts and in some others into two parts fig 6 in the three part data division the first part was used as a training or calibration set the second part as a validation set to ascertain that the model is generalizing and to stop the training before overfitting and the third part for a testing of the model in the prediction stage the names of these three parts i e training validation and test parts of course may be different in some papers for example in wunsch et al 2018 the word validation has been used for testing set and vice versa but according to the reviewed papers two parts data division i e using only the training and testing sets is also acceptable in the modeling of gwl time series considering the fact that some researchers do not mention the validation step as can be seen from fig 6 most of papers have used two parts data division training and testing sets while some papers have included the validation set too among 46 papers that have used two parts data division the training testing sets respectively vary from 56 to 44 juan et al 2015 to 90 10 maheswaran and khosa 2013 khalil et al 2015 of the total data with an average of approximately 70 30 in the remaining 20 papers that have added the validation set the training validation and testing sets are averagely 60 18 and 22 of total data respectively it should be noted that in banerjee et al 2009 there was not any explanation about the validation or testing sets and the performance criteria has been only mentioned for the training data 3 5 study areas and type of aquifers fig 7 shows the number of reviewed papers with respect to the countries where the study areas are located a large number of the study areas are located in iran 19 out of 67 cases this point maybe shows the interest of iranian researchers in this field but it can also be due to the aridity semi aridity of regions like iran such that the surface water resources are low and the groundwater is the most available water resource and therefore the gwl data are more available than the surface water data china with 11 and india with 9 case studies are placed in the next categories in this regard rest of the world can also be seen from the fig 7 it should be noted that the types of aquifers under study i e whether they were confined unconfined karstic sandy etc were briefly explained in the most papers according to the descriptions about the study areas in the reviewed papers the most of aquifers were unconfined with alluvial materials like sand silt clay gravel etc and only a few of them were semi confined or karstic chalky coastal etc it is known that the black box ai techniques are useful for prediction and forecasting but they are not built using insights on the physical processes involved in this type of modeling the knowledge about the underlying mechanisms is not necessary and the main purpose is obtaining accurate forecasts 3 6 used software programs more than half of the papers reviewed in this study have mentioned the software programs used for ai modeling while the rest have preferred not to mention the used software program fig 8 shows number of times that different software programs were used to develop ann anfis gp and svm models for gwl forecasting it should be noted that in fig 8 the hybrid models are also considered as can be seen the matlab is the most used software program the matlab software program has different ai toolboxes that allow the user to easily apply them for the desired purpose with the least needs for coding other software programs have been also used for example the neurosolutions mohammadi 2008 jha and sahoo 2015 gholami et al 2015 qnet emamgholizadeh et al 2014 and r mukherjee and ramachandran 2018 software programs have been used in some cases for developing the ann even the programming languages such as visual basic tapoglou et al 2014 and c yoon et al 2011 shiri et al 2013 have been used in several papers the genexpro is a software program in the field of gp and evolutionary computation that has been used by shiri et al 2013 details regarding these software programs can be found on the web and we do not discuss about them here although many papers have not mentioned the used software it seems that the matlab software program is a good choice for development of the ai models 3 7 incorrect development of ai models for gwl forecasting the incorrect development of ai models for gwl forecasting can be occurred in different stages of the modeling it may be occurred during the input data consideration if the data are insufficient incorrect or irrelevant we should not expect the model to have correct forecasts when importing the inputs to the model it is also important whether the inputs are average or related to a specific time for example in the monthly time steps it is important to know whether the input data are related to the monthly average or to a specific day in each month and whether they are recorded in the same day of each month or not i e whether the record period is 30 days or longer or shorter use of too many inputs is also caused by input redundancy where they may provide redundant information and cause overfitting and therefore the real world forecasted gwl to be incorrect the incorrect development can also be during the data division in training validation and testing sub sets when the data have not been appropriately divided the training validation and testing sub sets should have the same statistical properties in order to develop the best possible model maier et al 2010 a number of best ways for considering the input data and input data division can be found in maier et al 2010 one of the most common mistakes occurs when developing hybrid wavelet al models some recent wavelet based hydrological including gwl forecasting models have been incorrectly developed and cannot properly be used for real world forecasting problems quilty and adamowski 2018 according to the quilty and adamowski 2018 the incorrect development of wavelet based forecasting models occurs during wavelet decomposition and as a result imports error into the model inputs the origin of this error is due to the boundary condition that is linked to the wavelet decomposition in three main issues i e using future data inappropriately selecting decomposition levels and wavelet filters and not properly partitioning training validation and testing data the future data issue occurs when a given wavelet requires data from the future of the time series to calculate a wavelet or scaling coefficient in the present for solving this problem the causal wavelet algorithms such as a trous and maximal overlap dwt should be used since they do not use future data in addition to the not using the future data the causal algorithms reduce the number of wavelet and scaling coefficients affected by the boundary condition which must be removed from the input sub time series to have a real world forecasting model the partitioning issue is also solved when using causal wavelet algorithms but the wavelet must be applied to the testing predicting set one record at a time and then the forecast must be calculated through the model for each testing predicting record and so on quilty and adamowski 2018 in the current review study several ai methods for gwl modeling were investigated by surveying the recent published researches in this field here one of the important issues is exploring which ai method works better and can best simulate the gwl it seems that the answer to this question can be different in different studies according to the table 1 among 67 papers the ann anfis gp and svm were respectively declared as the most appropriate models by 28 6 2 and 7 papers while 17 papers used hybrid wavelet ai models and 7 papers applied other hybrid ai models and reported that hybrid models led to better modeling it appears that in the last few years more attention has been paid to apply hybrid models so that application of hybrid models leads to better results in comparison with single ai models in particular the pre processing of input data by common tools such as wavelet analysis has frequently been used in this area to achieve better modeling performance 4 conclusions and recommendations the ai methods have been used for gwl modeling as well as other hydrological and environmental modeling in this study 67 papers dealing with ai methods in gwl modeling which were published in 29 international journals from 2001 to 2018 were reviewed from these papers it was found that ai methods can successfully be used to simulate and predict the gwl time series in different aquifers this kind of modeling is based on an ai effort to find natural relationships between gwl and different hydrological variables without the need for constructing any conceptual model the ai models can be useful when it is difficult to build an adequate knowledge driven simulation model due to the lack of the ability to satisfactorily construct a mathematical physical model of the underlying processes these models have several key stages including input data consideration input data division regulation of the model features training testing etc which if all the stages carefully be developed it is expected that the model performance to be good however it should be noted that there was not a fixed rule for these stages such that different studies performed each stage based on an empirical manner and or trial and error procedure considering available data and existing conditions the obtained results from this review study that were embedded in two separated parts i e the results of each ai method and the general results and discussion can provide many guidelines for researchers to perform similar works in the related field develop innovative methods and improve the quality of modeling for this purpose the following recommendations can also be suggested 1 the ai methods can be linked to conceptual numerical models such as modflow to develop integrated modular models such that each method covers the weak points of the other method for example if an ai model generates accurate gwl forecasts in a special aquifer it can be used to prepare and complete gwl data required for modflow as the input according to mohammadi 2008 the anns needed less input data and took less time to run compared to modflow therefore using anns and other ai methods can decrease the computations of modflow which are very time consuming in another example the gwl data sets estimated by modflow can be used to train ai models if there was not enough real data 2 more attention should be given in the stage of input consideration in order to select appropriate input variables and lag times in the reviewed papers the input variables were often selected based on data availability or using simple user defined relationships more analytical methods or model based approaches can be applied to determine input significance as suggested by wu et al 2014 in particular utilizing the gwl time series as the most widely used and most important input variable for ai gwl forecasting should be more investigated the gwl fluctuations provide a direct measure of the impact of groundwater development and important information about the aquifer dynamics is embedded in gwl time series so it can be said that the future of gwl is predictable form the past gwl furthermore in the stage of input consideration the non causal wavelets such as a trous and maximal overlap dwt can be explored to unravel the component features of different input variables in order to determine the lags correlation and interaction between the hydrological variables and gwl 3 regarding different ai methods to simulate the gwl it can be said that it is not practically possible to recommend one particular type of ai model for a given problem however it is clear that a hybrid coupled model likely perform better than a single ai model different types of ai techniques can be tested at the different stages of the gwl modeling to select the best ai method in each stage and then combine them to have an optimum modeling performance 4 in the wavelet decomposition of the gwl border effects as well as the caution of causality which occurs in the beginning and end of the decomposed sub time series is an area that has received a little attention in the most papers which have used wavelet ai models for gwl modeling so this topic can be raised for the new researches the decomposition of the total data set at once or each sub data set i e training validation and testing sets separately and the ways to prepare the decomposed sub time series for applying them as the model input is an interesting subject deserving further investigation 5 according to the quilty and adamowski 2018 some wavelet based hydrological models have been incorrectly developed and the solution is the use of non causal wavelet algorithms such as a trous and maximal overlap dwt algorithms since this has not been done so far in gwl forecasting the use of these wavelet algorithms should be addressed in a new study 
6594,this study is a review to the special issue on artificial intelligence ai methods for groundwater level gwl modeling and forecasting and presents a brief overview of the most popular ai techniques along with the bibliographic reviews of the experiences of the authors over past years and the reviewing and comparison of the obtained results accordingly 67 journal papers published from 2001 to 2018 were reviewed in the terms of the features and abilities of the modeling approaches input data consideration prediction time steps data division etc from the reviewed papers it can be concluded that despite some weaknesses if the ai methods properly be developed they can successfully be used to simulate and forecast the gwl time series in different aquifers since some of the stages of the ai modeling are based on the experience or trial and error procedures it is useful to review them in the special application on gwl modeling many partial and general results were achieved from the reviewed papers which can provide applicable guidelines for researchers who want to perform similar works in this field several new ideas in the related area of research are also presented in this study for developing innovative methods and for improving the quality of the modeling keywords groundwater level forecasting artificial intelligence neural networks review wavelet 1 introduction measurement and analysis of the groundwater level gwl in aquifers is an important and useful task in the management of the groundwater resources and the knowledge about the gwl variations can be used for quantifying the groundwater availability the gwl variations in wells provide a direct measure of the impact of groundwater development and important information about aquifer dynamics is often embedded in the continuously recorded gwl time series butler et al 2013 therefore the modeling and predicting of gwl is necessary for water managers and engineers to qualify and quantify groundwater resources and to maintain a balance between supply and demands for gwl modeling conceptual or physical based models are traditionally the main tool however they have some practical limitations including the need for large amount of data and input parameters in many cases data is limited on one hand and obtaining accurate predictions is more important than understanding underlying mechanisms on the other hand and therefore the black box artificial intelligence ai models can be a suitable alternative although there are different methods for modeling and predicting gwl in aquifers such as conceptual physical numerical statistical etc methods however in recent years ai methods have been used for their simplicity and acceptable results and many researches have investigated the performance of ai models for gwl modeling in different parts of the world this study is a review of those papers that have used ai methods for modeling and forecasting gwl of course these methods have some weaknesses such as overtraining low generalizability risk of using unrelated data incorrect modeling with inappropriate methods and so on however their simplicity of use high speed run and acceptable accuracy without the need to know the problems physics have led many researchers to apply them it should be noted that it is the nature or perhaps the defect of the ai models that if they were developed for the prediction of a specified time series the accurate results could not necessarily be derived in the similar ones but the major advantage of ai models is the nonlinear and complicated phenomena modeling without the need for full understanding underlying mechanisms rajaee and boroumand 2015 therefore the use of ai approaches in gwl modeling has steadily increased and attracted interest of many researchers in the world in order to develop new and better ai approaches for gwl modeling it is important to investigate what has been done with ai models and current researches and there is a need for researchers to know what other scholars have done in this regard many review papers have been recently published that have explored using ai models in hydrology e g solomatine 2005 or in different hydrological and water resources fields e g maier et al 2010 in the field of river variables modeling and wu et al 2014 in the field of water quality modeling while no review paper is find that has centered on the specific use of ai models for gwl modeling and forecasting each hydrological phenomenon has its own characteristics and it is reasonable that the use of ai models in gwl modeling to be reviewed individually nourani et al 2014 have cited and reviewed some wavelet ai studies in gwl modeling 5 papers however in the best knowledge of the authors there is not yet an individual and comprehensive review paper evaluating the application of ai methods in gwl modeling and forcasting the current review study presents and compares the details of the journal papers dealing with the ai methods for gwl modeling and forecasting in the terms of the features and abilities of the modeling approaches the input data consideration the quantity and quality of used data the study areas and aquifers the prediction time steps the data division etc 67 papers are reviewed in this study these papers have been published in the international journals belongs to the famous publications such as elsevier springer iwa wiley asce etc during the period from 2001 to 2018 the papers were found from searching the web using the relevant key words and were chosen because they were published in well known international journals in the fields of hydrology water resources and ai sciences based on the search journal of hydrology elsevier with 12 papers and water resources management springer with 11 papers are the journals that have been published the most papers in this regard also hydrological processes wiley journal of hydroinformatics iwa hydrogeology journal springer and computers geosciences elsevier each one have been published three papers in this regard the rest of the journals a total of 29 journals that had papers in this regard have been published one or two papers so far table 1 fig 1 shows number of published papers regarding ai in gwl modeling reviewed in this study with respect to year of publication as can be seen such publications have increased in recent years therefore due to the interest of researchers in this field and given the difficulty of conceptual numerical gwl modeling this review was provided to help new researches in this field details of the selected papers are given in table 1 where the papers on the subject of gwl modeling with ai methods are comparing regarding to the authors and year of publication journals and impact factor if region of study type of utilized ai methods hydrological input variables time steps and range of total data the abbreviations used in the table 1 have been explained in the end of the table in the following some very commonly used ai methods for modeling gwl are addressed the methods include artificial neural networks ann adaptive neuro fuzzy inference system anfis genetic programming gp support vector machine svm and some hybrid models such as wavelet ai models firstly a brief description of each method is presented and thereafter the related conducted studies are cited and reviewed this is followed by general results and discussion conclusions and recommendations for future avenues of research 2 artificial intelligence methods for gwl modeling 2 1 artificial neural networks ann for gwl modeling 2 1 1 introductory anns are computational models inspired by biological neural networks they can be used to approximate functions that are generally unknown or to predict future values of possibly noisy time series based on past histories anns are composed of simple elements operating in parallel as in nature the connections between elements largely determine the network function beale et al 2010 a common ann comprised of multiple elements called neurons processing elements and connection pathways that link them the neurons having similar properties are grouped in one single layer typically three separate layers exist in an ann namely input hidden and output layers the input layer takes input variables which in the case of gwl forecasting are usually the precipitation temperature gwl etc time series in the hidden and output layers each neuron passes its weighted and biased input through a desired transfer activation function to produce a result anns are trained with a sample data so that a particular input leads to a specific target output training means tuning the adjustable network parameters called weights and biases to optimize the network performance the training process can be done with various training learning algorithms the levenberg marquardt lm algorithm the back propagation bp algorithm the bayesian regularization br algorithm and the gradient descent with momentum and adaptive learning rate back propagation gdx algorithm are examples of most used training algorithms in the literature different ann types have been widely described in the literature however several types of them are briefly presented here the feed forward neural networks fnns propagate input signal through the network in a forward direction layer by layer the multilayer perceptron mlp network as a historical fnn consists of an input layer one or more hidden layers and one output layer the recurrent neural networks rnn feed the outputs of the hidden layer back to itself in the rnns an additional layer is interconnected with the hidden layer that plays the role of the network history the radial basis function rbf networks are also feed forward but have only one hidden layer that uses gaussian transfer function and a standard euclidean distance to measure how far an input vector is from a specific center vector the amount of euclidean distance is transferred by the gaussian function that determines the output of the layer rbf networks tend to learn much faster than a fnn the self organizing map som network as a kind of anns consists of one input layer and one output layer called kohonen layer the input layer is fully connected to the output layer the som is trained using an unsupervised competitive training algorithm the n dimensional input vector is sent through the network and the euclidean distance between the weight vector and the input vector is computed the training process will be continued to select best neurons that reduce the distance between the weights and inputs an advantage of the som is to map high dimensional input space into low dimensional space regardless of the type of utilized ann they have some common modeling stages fig 2 shows the typical stages of using anns for gwl simulation and forecasting 2 1 2 bibliographic review recent experiments in gwl modeling have reported that anns may offer a promising alternative for conceptual methods in one of the first studies coulibaly et al 2001 compared three types of ann models using gwl precipitation and temperature time series as the inputs of models to simulate average monthly gwl in the gondo aquifer burkina faso simulation results showed that the rnn is most efficient compared to the static structure input delay ann and rbf ann lallahem et al 2005 evaluated ann for estimating the monthly gwl in an unconfined chalky aquifer in northern france the input data was the gwl of 13 piezometers rainfall mean temperature precipitation and potential evapotranspiration and the main objective was to simulate the gwl in a selected piezometer the simulations revealed the merit of using mlp models daliakopoulos et al 2005 tested seven different ann models with various architectures and training algorithms for monthly gwl forecasting in the island of crete greece the input variables were the past gwl temperature precipitation and river discharge the fnn trained with the lm algorithm had the best results nayak et al 2006 investigated the potential of mlp trained with bp algorithm in forecasting the monthly gwl in an unconfined coastal aquifer in india the input variables were selected as precipitation canal releases and gwl of the observation well and two neighboring wells the performance was good for 1 and 2 month ahead forecasting but was deteriorated after 2 month krishna et al 2008 applied several ann training algorithms to predict monthly gwl in an urban coastal aquifer in andhra pradesh state india it was found that the fnn trained with lm algorithm is a good choice compared to br and rbf algorithms in their study gwl were also predicted in neighboring wells using model parameters from the best network of a well mohammadi 2008 tested modflow and two types of ann i e mlp and rnn to simulate the monthly gwl of a karstic aquifer located in iran he used data sets generated by modflow for training of the anns the results indicated that ann models needed less input data and took less time to run compared to modflow nourani et al 2008 compared six different types of anns for spatiotemporal gwl forecasting in tabriz aquifer iran the monthly gwl in central well precipitation mean temperature and average discharge were selected as the inputs the optimal ann was a fnn trained with lm algorithm which was then applied to forecast gwls of selected wells as the spatial model feng et al 2008 applied fnn to investigate the effects of 7 factors i e initial gwl precipitation evaporation water reservoir inflow population synthesis irrigation ratio and irrigation area on monthly gwl in shiyang river basin china sensitivity analysis with the models demonstrated that groundwater extraction for irrigation is the predominant factor responsible for declining gwl tsanis et al 2014 developed a fnn trained with the lm algorithm with five input variables i e precipitation temperature runoff gwl and specific yield for forecasting the monthly gwl in messara valley crete greece they used a deterministic component which linked precipitation with the seasonal recharge of the aquifer and projected the seasonal average precipitations results showed that the specific yield marginally improved the forecasting but the linearly projected precipitation component drastically increased the forecasting banerjee et al 2009 used fnn model trained with lm algorithm to predict the monthly gwl of four diversified wells in kurmapally watershed hyderabad india they have not mentioned the used input variables but forecasted the gwl considering varying recharge and pumping conditions yang et al 2009 applied the bp ann and the integrated time series its models to forecast monthly average gwl in the western jilin province of china the input variables were only the past gwls at different intervals of time the simulation results indicated that both ann and its models were accurate in reproducing the gwls but in the test phase the ann was superior to the its mohanty et al 2010 developed three different training algorithms viz lm br and gdx algorithms for weekly gwl forecasting in a tropical humid region eastern india the inputs to the models consisted of precipitation pan evaporation river stage water level in the drain pumping rate and gwl in the previous week the br algorithm was found slightly superior to the two other algorithms chen et al 2010 combined the theory of som and rbf the proposed model could decide the number of rbf ann hidden units with using the two dimensional feature map which is constructed by som the inputs were the monthly average gwls of six wells in southern taiwan while the output was the monthly average gwl of an individual well the results showed that the four site input model was more competent compared to the single site model and six site model one year later chen et al 2011 combined of the som and bp ann for the same study area here the model inputs were the monthly average gwls of ten wells while the output was the gwl of an individual well it was found that the multi site som bp ann model provided the most accurate predictions in comparison to the autoregressive integrated moving average arima and single ann models trichakis et al 2011 simulated daily gwl by mlp at a well located in the karstic artesian edward s aquifer in texas usa the input variables were the day number precipitation pumping and gwl the testing data were used to check the ability of the mlp to interpolate or extrapolate in other wells in the region the results showed that there was a need for exact knowledge of pumping from each well in karstic aquifers as it was difficult to simulate the sudden drops and rises sreekanth et al 2011 compared the fnn trained with lm algorithm and anfis for estimation of the gwl of the maheshwaram watershed india the inputs included the monthly gwl in 22 wells along with rainfall temperature evaporation and relative humidity the results showed that the fnn provided better accuracy compared to anfis rakhshandehroo et al 2012 used fnn rbf rnn and a generalized regression neural network for monthly gwl prediction in shiraz plain iran the precipitation gwl temperature evaporation and runoff were utilized as the input data best performances were achieved by fnn and rnn networks respectively taormina et al 2012 applied fnn for long period simulations of hourly gwls in a coastal unconfined aquifer sited in the lagoon of venice italy the fnn was first trained to perform one hour ahead predictions using past gwl rainfall and evapotranspiration data after the training simulations were produced by feeding back the computed outputs in place of past observed data the fnn reconstructed accurate gwl for long periods at least six months relying only on the rainfall and evapotranspiration data sahoo and jha 2013 compared mlp trained with lm algorithm and multi linear regression mlr approach in monthly gwl forecasting considering rainfall temperature river stage gwl and 11 seasonal dummy variables as inputs the study area was konan basin located in kochi japan they concluded that mlp models have better results however considering the practical advantages of the mlr it was recommended as a cost effective gwl modeling tool ying et al 2014 compared the rbf ann arima and its models for gwl forecasting of two wells in jilin china monthly gwl was the only variable used to develop the models they concluded that for forecasting the dynamics of the gwl the rbf ann is preferable but for analyzing gwl variation the its and arima may be more appropriate juan et al 2015 developed two fnn models one with three inputs previous gwl temperature and precipitation and another with two inputs temperature and precipitation only to forecast the daily variations of the supra permafrost gwl in the qinghai tibet plateau china the fnns were trained with lm algorithm and the results indicated that the three inputs model produced better accuracy performance however if there are no field observations of the gwl the models developed using only two inputs also have good accuracy gholami et al 2015 used a mlp trained with lm algorithm to simulate annual gwl fluctuations of two wells located in an alluvial aquifer of the caspian sea southern coasts iran for the period from 1912 to 2013 the tree ring diameter and the precipitation during the growing season were the input parameters for the mlp and the gwl during the growing season was the output the results showed that the integration of dendrochronology and ann renders a high degree of accuracy in the simulation of annual gwl mohanty et al 2015 applied fnn for simultaneous forecasting of the weekly gwl in 18 wells located over a river basin in india the inputs were selected as rainfall pan evaporation river stage water level in the surface drain pumping rates of 18 sites and gwls of 18 sites in the previous week which led to 40 input nodes and 18 output nodes comparison between the lm br and gdx training algorithms showed that the gdx was the most suitable algorithm for the study area sun et al 2016 applied an mlp trained with lm algorithm to forecast the daily gwl in a freshwater swamp forest of singapore the inputs to the model were the surrounding reservoir levels and rainfall the results revealed that mlp produced better prediction with a leading time of 1 day compared to mlr wunsch et al 2018 used the nonlinear autoregressive with exogenous inputs neural network narx for gwl forecasting of several wells in southwest germany precipitation and temperature were chosen as input variables all input and target time series were decomposed using the seasonal trend based on loess algorithm to detect significant time lags and determine input and feedback delays needed for narx application the results showed that narx is suited to perform gwl predictions for uninfluenced observation wells even though the number of input variables is limited ghose et al 2018 developed the rnn model to forecast monthly gwl of a well in odisha india as a function of rainfall temperature humidity runoff and evapotranspiration from the results evapotranspiration and runoff were the influencing parameters which affect the gwl and inclusion of them improved the model efficiency lee et al 2018 applied the fnn to predict hourly gwl of 8 observation wells located in yangpyeong riverside area south korea they investigate the relative impacts of the input variables and as a result used the river level and pumping rates from two extraction wells as input variables while the precipitation was found to be a weak influencing factor and therefore it was not used as an input variable kouziokas et al 2018 used multiple fnn with various network structures and training algorithms to forecast the daily gwl of a well located in montgomery county pennsylvania usa using the humidity precipitation and temperature as input variables the fnn with the lm training algorithm was the best model 2 1 3 results an assessment of the various studies on ann modeling of the gwl revealed the following issues 1 the ann models can be extended easily from univariate to multivariate cases compared to the conceptual models and the model complexity can be varied simply by altering the transfer function training algorithm or network architecture similar to the regression models the input variables can be considered based on an empirical proof or a correlation analysis the results of the reviewed papers also indicated that anns capture the complex non linear behavior of the gwl time series relatively better than the regular regression models such as arima and mlr 2 the reviews reveal that the lm algorithm is the most popular training algorithm used to train anns for gwl modeling the lm algorithm is a modification of the classic newton algorithm used for finding an optimum solution to a minimization problem the lm algorithm is often characterized as more stable and efficient and some researchers point out that it is faster and less easily trapped in local minima than other training algorithms daliakopoulos et al 2005 zounemat kermani et al 2013 in a study of comparison the performance of rbf and lm feed forward anns for predicting daily watershed runoff concluded that lm algorithm is superior to the rbf in prediction of one day ahead base and high flows but the rbf algorithm outperformed the lm in predicting flood events the gwl time series do not possess a characteristic such as flood in runoff time series therefore it seems that the superiority of lm in gwl modeling correspond to the results of the study of zounemat kermani et al 2013 3 the three layers fnn with the sigmoid transfer function in the hidden layer and linear transfer function in output layer is the most common structure of ann for gwl modeling the sigmoid function is differentiable continuous and monotonically increasing in its domain and it is the most frequently employed function in modeling ravansalar and rajaee 2015 it should be mentioned that in the majority of reviewed papers the structure of ann and number of hidden neurons were achieved by a trial and error procedure 2 2 adaptive neuro fuzzy inference system anfis for gwl modeling 2 2 1 introductory the adaptive neuro fuzzy inference system is a combination of an adaptive neural network an and a fuzzy inference system fis thus it has potential to capture the benefits of two methods in a single framework jang 1993 introduced architecture and a learning procedure for the anfis that uses a neural network learning algorithm for constructing a set of fuzzy if then rules with appropriate membership functions mfs from the specified input output pairs the fis corresponds to a set of fuzzy if then rules that have learning capability to approximate nonlinear functions there are two approaches for fis namely mamdani and sugeno the differences between these two approaches arise from the consequent part mamdani s approach uses fuzzy mfs whereas sugeno s approach uses linear or constant mfs the anfis is an ai method with flexible mathematical construction which is capable of identifying complex nonlinearity and uncertainties due to randomness and imprecision between variables without attempting to reach an understanding as to the nature of the phenomena this approach is capable of approximating any real continuous function on a compact set to any degree of accuracy thus in parameter estimation forecasting where the given data are such that the system associates measurable system variables with an internal system parameter a functional mapping may be constructed by anfis that approximates the process of estimation of the internal system parameter more information on anfis can be found in jang 1993 2 2 2 bibliographic review in the area of gwl modeling with anfis kholghi and hosseini 2009 applied the ordinary kriging and anfis for spatial interpolation of gwl in an unconfined aquifer in qazvin iran they use the gwl data of 95 wells for training and testing the models the gaussian mf was used in the anfis models the results showed that the contour plot of isopieze lines estimated by anfis was more efficient than those by kriging jalalkamali et al 2011 investigated the abilities of anfis and ann with various combinations of monthly temperature rainfall and gwls in two neighboring wells as the inputs to predict the gwl of another well located in kerman plain iran the results showed that applying the gwls of the current and one month before of the well and the neighboring wells was the best input combination to predict gwl and the anfis models using gaussian mf had better results compared to the anns shirmohammadi et al 2013 applied system identification time series and anfis models to predict monthly gwl in mashhad plain iran the only input variable of the models was the precipitation in the anfis models they tested several mfs such as triangular gaussian and bell shaped functions the results showed that the bell shaped mf had the best performance and the anfis model outperformed both time series and system identification models emamgholizadeh et al 2014 compared ann and anfis in forecasting of monthly gwl in bastam plain iran they considered the rainfall recharge irrigation returned flow and pumping rates from water wells as input data and found that anfis outperformed the ann the results showed that applying anfis with different structures had the most accuracy when it used with trapezoidal mf mirzavand et al 2015 investigated the abilities of anfis and svr in estimating monthly gwl fluctuation in the kashan plain iran by using the inputs of stream flow evaporation spring discharge aquifer discharge and rainfall the results indicated that the anfis model using bell shaped mf performed better than the svr khaki et al 2015 applied ann and anfis to simulate monthly average gwl in the langat basin malaysia the gwl rainfall humidity evaporation minimum temperature and maximum temperature were applied as the input variables of the models the obtained results of the anfis models were superior to those of anns and in the anfis models the bell shaped mf outperformed the gaussian mf gong et al 2015 tested the validity of ann svm and anfis in the prediction of the monthly gwl for two wells near lake okeechobee in florida united states the precipitation temperature past gwls and lake level were used as input data the results showed that the gwl predictions from anfis and svm were more accurate than that from ann 2 2 3 results the review of cited studies on anfis modeling of the gwl showed that 1 in the cited papers applying anfis as an alternative approach to predict the gwl leads to more accurate results in comparison with the ann since anfis integrates both neural networks and fuzzy logic principles it is more likely to deal with non stationary time series more effectively 2 in three studies i e shirmohammadi et al 2013 mirzavand et al 2015 khaki et al 2015 the bell shaped mf was the best in comparison with other mfs while in two studies i e kholghi and hosseini 2009 jalalkamali et al 2011 the gaussian mf yielded higher accuracy and in the study of emamgholizadeh et al 2014 the trapezoidal mf was the best in comparison of others in the meanwhile gong et al 2015 have not mentioned anything about the used mf generally there was not any exact method for choosing the mfs in the reviewed papers and instead a trial and error procedure was used for finding an appropriate mf so use of those mfs which do not cause overfitting and give least error can be recommended 2 3 genetic programming gp for gwl modeling 2 3 1 introductory the gp as a generalization of genetic algorithm ga is an evolutionary algorithm based on biological evolution inspired by darwinian theories of natural selection and survival of the fittest the gp considers an initial population of randomly generated equations which are achieved from the random variables numbers and functions the function involves arithmetic operators and other mathematical functions e g sin cos etc or user defined expressions which should be chosen based on some understanding of the process the initial population is then applied to an evolutionary process to evaluate the fitness of the evolved programs by defining a fitness function in forecasting problems the root mean squared error rmse between forecasted and observed data is often used as the fitness function the programs that best fit the data are then selected to produce better program through two genetic operators crossover and mutation the evolution process is repeated and driven towards to find expressions which describe the data and give the best performance of the model 2 3 2 bibliographic review shiri et al 2013 investigated the abilities of gp anfis ann svm and arima techniques for daily gwl forecasting in korea the gwl rainfall and evapotranspiration data were used as the inputs of the models for gp models the root relative squared error was employed as the fitness function the results showed that gp models were superior compared to other models fallah mehdipour et al 2013 compared the capability of the gp and anfis to predict and simulate monthly gwls in three wells in the karaj plain of iran the precipitation evaporation and gwls were used as the inputs of the models they have noted that the fitness function of gp was considered an error criterion but they have not mentioned the type of it results showed that in the gp models the average errors were less compared to the anfis models 2 3 3 results originally developed for optimization problems the gp was extended to solve forecasting problems such as gwl forecasting in this case the minimum error e g rmse between forecasted and observed gwls has been applied as the fitness function of the gp although among other ai methods the gp may not be the best way to forecast the gwl in the two aforementioned studies this model outperformed other models similar to the ann and anfis in the reviewed gp papers the input parameters were chosen based on a combination of empirical and trial and error analysis the low number of papers on gwl modeling via gp demonstrates the need to investigate more about application of gp and in gwl modeling 2 4 support vector machine svm for gwl modeling 2 4 1 introductory the svm is a statistical machine learning theory it has not a priori determined structure but the input vectors supporting the model structure are selected through a model training process vapnik 1998 this machine learning method is based on the extension of the idea of identifying a hyper plane that separates two classes in classification a svm constructs hyper planes in an infinite dimensional space which can be used for classification regression or other tasks the mappings used by svm schemes are designed to ensure that dot products may be computed easily in terms of the variables in the original space by defining them in terms of a kernel function selected to suit the problem the svm can also be used as a regression method the support vector regression svr method uses the same principles as the svm for classification with only a few minor differences the svr generalization performance depends on a good setting of some parameters and the kernel function the svr parameters represent some constants like regularization constant and kernel function constant and control the prediction regression model complexity the kernel function changes the dimensionality of the input space to perform the regression task with more confidence a full mathematical overview of svm is presented by vapnik 1998 originally developed for classification it was extended to solve prediction problems and in this capacity was used in hydrology related tasks 2 4 2 bibliographic review yoon et al 2011 developed ann and svm models for predicting gwl fluctuations of two wells at a coastal aquifer in south korea considering a six hourly time step the past gwl precipitation and tide level were selected as the inputs of the models it was found that the past gwl was the most effective input variable for the study site and tide level was more effective than precipitation the results showed that the performance of the svm was better than the ann yoon et al 2016 utilized a weighted error function approach to improve the performance of ann and svm models for the prediction of daily gwl in response to rainfall the input variables were gwl and rainfall data in south korea the comparison of the models showed that the recursive prediction performance of the svm was superior the ann huang et al 2017 used the chaos theory to select the best input lags of gwl time series and developed the svm and bp ann models using the particle swarm optimization method to obtain the parameters of svm the models were applied to predict the daily weekly and monthly gwl in china the chaotic svm model had higher accuracy than the linear svm and chaotic bp ann models nie et al 2017 employed precipitation evaporation and temperature as the inputs of svm and rbf ann models to forecast monthly gwl in jilin province china the svm model was more accurate and had fewer uncertainties caused by errors in the measurements of the inputs and outputs mukherjee and ramachandran 2018 applied the grace satellite terrestrial water storage tws data along with meteorological variables precipitation min and max temperature humidity and wind to predict gwl with the svr ann and linear regression models the results showed that tws is a highly significant variable to model gwl and the svr was the best model guzman et al 2018 compared svr and narx ann models for gwl prediction of an irrigation well located in the southeastern usa they evaluated the best combination from three input variables i e daily gwl precipitation and evapotranspiration data for each model the gwl precipitation scenario provides the optimal combination for model inputs and the svr was superior to the ann tang et al 2018 concluded that the least square svm perform better than classical svm and some other ai models in gwl forecasting the only input variable was the hourly gwl of four observation wells located in northern uk 2 4 3 results the svms svrs are powerful machine learning methods that have been developed and applied for many classification prediction problems over past years although the number of published papers considering gwl modeling via svm is low however it should be noted that svm has been used for predicting of many time series for a myriad of practical applications in the world in the svm modeling the appropriate selection of the kernel function and parameter values is critical in the five of seven aforementioned papers the rbf kernel function was selected whereas in the two other ones i e yoon et al 2011 and mukherjee and ramachandran 2018 the utilized kernel function was not mentioned over period of years the rbf function has become the choice of many researchers as the kernel function for svr because of its accuracy and reliable performance suryanarayana et al 2014 for selecting the optimum parameters of svm model most of the papers have employed a procedure like trial and error except huang et al 2017 that have been used the particle swarm optimization method to obtain the optimum parameters of svm 2 5 hybrid ai techniques for gwl modeling 2 5 1 introductory since it has been revealed that the ai models have some limitations with the nonlinear and non stationary processes some hybrid modeling approaches which include certain data preprocessing and or combine different ai techniques have been also developed in the recent years to increase the capabilities of the ai methods combining different ai methods in different stages of the modeling and applying efficient methods for input data pre processing make the developing of these models more effective for example the gp technique can be used to optimize the ai input variables and or ai regulation parameters in another example the geostatistical techniques such as kriging can be combined with the ai methods for spatiotemporal gwl modeling according to the capability of geostatistics tools in spatial estimation hybrid ai geostatistic models have been applied in some papers to use their potential for spatiotemporal simulation of gwl the wavelet analysis is an example for the data pre processing which has been widely used in gwl modeling wavelet analysis is applied for de noising compression and decomposition of input data time series wavelet is a time dependent spectral analysis that unravels time series in the time frequency space to provide a time scale description of the processes and their relationships daubechies 1990 the wavelet analysis can be performed continuously or discretely the continuous wavelet transform cwt can operate at every scale but it requires a lot of computational time and generates a large amount of data in many studies the discrete wavelet transform dwt was used where only a subset of scales and positions are chosen to make the calculations in the wavelet ai models cited in scientific papers the decomposed sub time series were used as the inputs of ai models instead of the main time series the schematic structure of some of hybrid ai models for gwl modeling is shown in fig 3 2 5 2 bibliographic review afterwards the ai methods were developed for prediction problems the researchers tried to combine different type of them to overcome the shortcomings and increase their accuracy almost since 2011 there has been an interest in application of the wavelet analysis in combination with different ai methods adamowski and chan 2011 used a wavelet ann model for gwl forecasting at two sites in quebec canada the monthly total precipitation average temperature and average gwl were decomposed at two levels by wavelets and imposed to the ann the model was found to provide more accurate gwl forecasts compared to the ann and arima models nourani et al 2011 presented an ann geostatistics methodology for spatiotemporal prediction of gwl in shabestar plain which adjoins to urmieh lake as a coastal aquifer in iran monthly gwls data from 11 piezometers rainfall and lake water levels were the inputs of ann the ann was trained for each piezometer to predict the gwl of the next month then kriging was applied to the outputs from ann models in order to estimate gwl at any desired point in the plain kisi and shiri 2012 investigated the ability of a wavelet anfis model to perform one two and three day ahead gwl forecasting of two wells located in illinois state usa using only past daily gwl data they found that excluding the detail coefficients from the inputs and using only approximation components significantly increase the accuracy of anfis models the hybrid model outperformed anfis particularly for two and three day ahead forecasts moosavi et al 2013a applied a number of different structures for ann anfis wavelet ann and wavelet anfis models to evaluate their performances to forecast gwl with 1 2 3 and 4 months ahead under two case studies in mashhad plain iran it was demonstrated that wavelet transform can improve the accuracy of forecasting it has been also shown that the forecasts made by wavelet anfis models are more accurate than those by other models they found that the decomposition level in wavelet transform should be determined according to the periodicity and seasonality of data series moosavi et al 2013b also investigated the optimum structures of wavelet ann and wavelet anfis models for gwl forecasting in the same case studies they used the optimization taguchi method to assess different factors affecting the performance of models it was revealed that transfer functions of ann membership function types of anfis and the mother wavelet type are the most important factors comparison of optimal models demonstrated the better performance of wavelet anfis maheswaran and khosa 2013 showed that wavelet based nonlinear as wavelet volterra model performed better than wavelet ann and wavelet linear regression models for gwl forecasting the study area was northern saanich peninsula canada and the inputs of the models were the level five decomposed monthly average gwl time series suryanarayana et al 2014 predicted monthly gwl of three observation wells in the city of visakhapatnam india using wavelet svr modeling the monthly data of precipitation maximum temperature mean temperature and gwl for the period 2001 2012 are used as the input variables results indicated that wavelet svr model gives better accuracy compared with svr ann and arima models he et al 2014 linked wavelet and fractal theory methods to ann for gwl forecasting of three sites located in ganzhou region northwest china the fractal dimension was convenient for quantitatively describing the irregularity or randomness of time series data the results showed that this model is suitable for sites at which the fractal dimension of the wavelet decomposition detail components is large tapoglou et al 2014 combined ann fuzzy logic and kriging in order to simulate the spatial and temporal distribution of gwl in an area across the isar river in bavaria germany the daily data including the gwls in 64 wells the surface water elevation at five observation points across the river temperature and rainfall were used as input variables to the 64 anns different ann architectures and variogram models were tested together with the use or not of a fuzzy logic system the isocontour maps were presented for the hydraulic head the best results were achieved with the use of the fuzzy logic system and by utilizing the power law variogram yang et al 2015 developed a wavelet ann and an its model to predict gwl of a shallow coastal aquifer in fujian province china the input was only the monthly gwl time series of two representative wells the wavelet ann models provided more accurate results compared to the its models khalil et al 2015 compared mlr ann wavelet mlr wavelet ann and a wavelet ensemble ann model for the forecasting of gwls as a result of recharge via tailings from an abandoned mine in quebec canada the wavelet ensemble ann consisted of a group of wavelet ann members where each of these members was trained for the same problem and then combined to produce the output the daily tailing recharge total precipitation and mean air temperature were used as inputs while the output was gwl for lead times of 1 day 1 week and 1 month the wavelet ensemble ann model performed best for each of the three lead times nourani et al 2015 proposed a wavelet entropy data pre processing approach for ann based gwl modeling they used the som based clustering technique to identify spatially homogeneous clusters of gwl data and the wavelet transform to extract the non stationary gwl runoff and rainfall time series the results indicated that the som method decreased the dimensionality of the input variables and the wavelet analysis increased the performance of the ann model jha and sahoo 2015 developed five hybrid ann ga models for simulating spatio temporal gwl in konan basin japan the relevant input variables such as rainfall max and min temperature river stage and gwl have been considered to simulate gwl at 17 sites the inputs and parameters of the ann were optimized using ga optimization technique the ga was superior to the commonly used trial and error method for determining optimal ann architecture and inputs chang et al 2016 combined the som the nonlinear autoregressive with exogenous inputs narx network and the kriging for predicting monthly gwl in zhuoshui river basin taiwan based on hydrologic data such as rainfall stream flow and gwl the som was used to classify the spatiotemporal patterns of regional gwl the narx was used to predict the mean of regional gwl and the kriging was used to interpolate the predictions into finer grids of locations consequently the prediction of a gwl map was obtained han et al 2016 coupled som and a statistical method to predict spatiotemporal monthly gwl in an arid irrigation district in the western hexi corridor northwest china the som was applied to identify spatially homogeneous clusters of wells and the gwl forecasting was performed through developing a stepwise cluster multisite inference model with various predictors including climate conditions well extractions surface runoffs reservoir operations and gwl measurements at previous steps hosseini et al 2016 combined ann and ant colony optimization aco to simulate the gwl in shabestar plain iran the back propagation ann was utilized to reproduce gwl variations using the input variables including rainfall average discharge temperature evaporation and some annual time series then aco was used to optimize and find initial connection weights and biases of a bp algorithm during the training phase they found that the hybrid model could reduce overtraining nourani and mousavi 2016 presented a hybrid wavelet ai meshless model for spatiotemporal gwl modeling in miandoab plain iran in this way firstly monthly gwl in different wells were de noised using threshold based wavelet method and the impact of de noised and noisy data was compared in temporal gwl modeling by ann and anfis then both ann and anfis models were calibrated using gwl data of each well rainfall and runoff to predict the gwl at one month ahead finally the simulated gwls were considered as interior conditions for the multi quadric rbf based solve of governing partial differential equation of groundwater flow to estimate gwl at any desired point within the plain the results showed that the wavelet de noising approach can enhance the performance of the modeling ebrahimi and rajaee 2017 investigated the effect of wavelet analysis on the training of the ann mlr and svr approaches in simulating gwl the only input variable was the monthly gwl data of two wells in the qom plain iran the results showed that for both wells the meyer wavelet produced better results compared to the other wavelets and the wavelet mlr and wavelet svr were the best models for the wells 1 and 2 respectively barzegar et al 2017 combined wavelet with ann and group method of data handling gmdh models for forecasting the monthly gwl in azarbijan iran the gwl time series were decomposed with different wavelets at two levels and the stepwise selection was used to select appropriate lag times as the inputs of the models to combine the advantages of different wavelets a least squares boosting algorithm was applied the boosting multi wavelet ann models provided the best performances wen et al 2017 applied wavelet ann with three different input combinations i e 1 gwl only 2 climatic data and 3 gwl and climatic data to forecast the monthly gwl of two wells in zhangye basin china the model with only gwl as its input yielded the best performance for one month forecasts however for two and three monthly forecasts the model with gwl and climatic data as inputs was superior rakhshandehroo et al 2018 used wavelet ann trained with improved harmony search algorithm to forecast the long term daily gwl of two wells in southeast usa the only input variable was the daily gwl and the one year ahead prediction with the proposed model was acceptable yu et al 2018 compared the wavelet ann and wavelet svr models in forecasting of monthly gwl of 3 wells in northwest china four wavelet decomposition levels were employed to decompose input time series discharge evapotranspiration and gwl the results showed that the wavelet svr performed better than wavelet ann zare and koch 2018 used wavelet anfis model with several combinations of gwl and precipitation as the inputs to simulate monthly gwl in the miandarband plain iran the results indicated that using the symlet mother wavelet with two decomposition levels outperformed other models 2 5 3 results in the last years development of hybrid modeling approaches is seen and in particular there has been an increasing interest in wavelets ai approaches for gwl modeling these studies have shown that the hybrid coupling models performed better than the regular models as a downside however these models have also been criticized on various aspects and in particular the risk posed by overtraining of the model and the difficulties of parameter estimation using heuristic methods maheswaran and khosa 2013 a review of the various studies on hybrid ai modeling of the gwl revealed the following issues 1 by using the hybrid models and in particular wavelet analysis to extract the input time series a greater understanding and ability to simulate gwl can be achieved the results of the studies explored in this section have revealed a higher degree of efficiency of hybrid models compared with single models in accurately forecasting gwl 2 in the all reviewed wavelet ai papers the dwt has been applied to decompose time series rather than cwt in addition to the simplicity of using dwt this can partly be due to the nature of gwl time series because they are recorded discretely furthermore the gwl is linked with several hydrological phenomena thus use of dwt at specific levels which likely refers to hourly daily or monthly effects appears to be more useful than application of cwt which generates much more redundant information 3 the more frequently mother wavelets used for gwl decomposition are db2 and db4 which have been considered as the appropriate mother wavelets according to the nourani et al 2014 similarity in shape between the mother wavelet and the time series is often the best guideline in choosing a reliable mother wavelet therefore it can be an indication of a relative similarity between the general shape of gwl time series and daubechies family wavelets 4 according to the study of maheswaran and khosa 2012 in the field of hydrological forecasting some mother wavelet forms that have a compact support showed better performance in the case of time series that have a short memory with transient features in contrast mother wavelets with a wider support yielded better forecasting efficiencies with regard to the time series that have long term features therefore in the case of gwl time series it does not seem that compact wavelets to be suitable for decomposition because the gwl time series have long term features rather than transient features and therefore the wavelets with a wider support are more compatible with the time series 5 in the aforementioned wavelet based papers five papers adamowski and chan 2011 moosavi et al 2013a b nourani et al 2015 ebrahimi and rajaee 2017 have used the decomposition level 2 two papers suryanarayana et al 2014 wen et al 2017 have used the decomposition level 4 and one paper maheswaran and khosa 2013 has used the decomposition level 5 as the optimum decomposition levels in the meanwhile in kisi and shiri 2012 yang et al 2015 and rakhshandehroo et al 2018 the decomposition levels were not mentioned according to nourani et al 2014 decomposition level l contains l details and as an example in the case of monthly modeling denotes 2 n month mode where n 1 2 l so 22 month mode is nearly seasonally mode when multilevel sub signals are entered in the wavelet ann models as input nodes their assigned weights by the ann method will be different at different decomposition levels therefore high weights will be applied to the high levels of the time series rajaee 2011 3 general results and discussions in this section some general results derived from the 67 reviewed papers such as the results related to the considering time steps input variables data set size data division study areas and type of aquifers etc have been mentioned and discussed 3 1 time step selection in the case of utilized time steps the majority of ai models reviewed in this study have been considered the monthly time steps for gwl modeling the distribution of the utilized time steps is given in fig 4 as can be seen the monthly time step was used in 46 of the 67 papers reviewed followed by daily 11 papers daily 4 papers and weekly 4 papers time steps a number of different time steps i e 6 hourly multi monthly and annually were used in some of the papers reviewed as well the high use of the monthly time steps can be related to the high availability of monthly recorded gwl data compared to other time steps in the most parts of the world the gwls do not have often significant hourly daily or even weekly variations however in some areas like coastal aquifers yoon et al 2011 taormina et al 2012 or areas near the lake of dams lee et al 2018 the gwls are under influence of tidal lake effects and may have hourly or daily variations 3 2 input data consideration fig 5 shows the input variables that have been employed in ai gwl modeling according to the reviewed papers from fig 5 it can be found that the past steps of the gwl time series is the most frequently used input variable for ai models to forecast the gwl among 67 papers 52 papers have been employed the gwl as an input variable even 12 papers have been considered the gwl as a single auto correlated input variable without any other exogenous input variable as well as the gwl the precipitation has been frequently used 48 times as an input variable furthermore some hydrological time series such as temperature river discharge surface runoff evapotranspiration surface water lake level pumping rates extraction from wells and humidity have been also used as the input variables in the reviewed papers other employed input variables such as irrigation patterns population day number seasonal dummy variables tree rings etc have been used to a lesser extent in the reviewed papers and it seems that some of them cannot be easily accommodated at the stage of input consideration although in the stage of input consideration some of the hydrological time series have been used more than the others however it should be noted that the input data selection has been mostly based on data availability in the study area rather than a physical analysis for the required data in the meanwhile this cannot be considered as a weakness of these studies because in many regions data is limited and also it is the nature of ai models that they can work with any data however it is better that a statistical analysis and in particular a correlation analysis be done with different data before employing them for modeling in order to obtain suitable input pattern for ai models 3 3 data set size according to the table 1 the number of total sample data sets applied for gwl modeling varies from 23 sets banerjee et al 2009 to 23 850 sets taormina et al 2012 generally the more samples especially for training can ensure better performance of model giving a better chance for locating global minimum of the error function provided that an overtraining does not happen during training however there are some cases that we may not be able to even collect 40 samples for training the model like the data of annual tree rings in gholami et al 2015 the quality of the available data and the relevance of the input data with the desired output are also important since a large amount of irrelevant data can hinder the model performance by confusing the training process tsanis et al 2014 there therefore has to be a balance between the quantity of data and the relevancy to the output in the all 67 reviewed papers there was not any fixed rule that say how to get an optimum data set size required for ai modeling it seems that considering the available data experimental or perhaps trial and error tools were used here from table 1 it can be seen that the majority of studies have been applied a data set size between 100 and 200 sets and perhaps this can be considered as a suitable data set size in the meanwhile it can be found that ai models are capable to deal with different size of data set but there was not any certain comment in the reviewed papers about that in each sample size i e big or small what should we do for optimizing the model performance e g which training algorithm is better for small sample size in ann it seems trial and error procedures have been used here 3 4 data division in the case of data division for training validation and testing tasks there was not a specific rule in the reviewed papers which explain how to consider an optimum amount for each sub data set in some of the reviewed papers the total data set were divided into three parts and in some others into two parts fig 6 in the three part data division the first part was used as a training or calibration set the second part as a validation set to ascertain that the model is generalizing and to stop the training before overfitting and the third part for a testing of the model in the prediction stage the names of these three parts i e training validation and test parts of course may be different in some papers for example in wunsch et al 2018 the word validation has been used for testing set and vice versa but according to the reviewed papers two parts data division i e using only the training and testing sets is also acceptable in the modeling of gwl time series considering the fact that some researchers do not mention the validation step as can be seen from fig 6 most of papers have used two parts data division training and testing sets while some papers have included the validation set too among 46 papers that have used two parts data division the training testing sets respectively vary from 56 to 44 juan et al 2015 to 90 10 maheswaran and khosa 2013 khalil et al 2015 of the total data with an average of approximately 70 30 in the remaining 20 papers that have added the validation set the training validation and testing sets are averagely 60 18 and 22 of total data respectively it should be noted that in banerjee et al 2009 there was not any explanation about the validation or testing sets and the performance criteria has been only mentioned for the training data 3 5 study areas and type of aquifers fig 7 shows the number of reviewed papers with respect to the countries where the study areas are located a large number of the study areas are located in iran 19 out of 67 cases this point maybe shows the interest of iranian researchers in this field but it can also be due to the aridity semi aridity of regions like iran such that the surface water resources are low and the groundwater is the most available water resource and therefore the gwl data are more available than the surface water data china with 11 and india with 9 case studies are placed in the next categories in this regard rest of the world can also be seen from the fig 7 it should be noted that the types of aquifers under study i e whether they were confined unconfined karstic sandy etc were briefly explained in the most papers according to the descriptions about the study areas in the reviewed papers the most of aquifers were unconfined with alluvial materials like sand silt clay gravel etc and only a few of them were semi confined or karstic chalky coastal etc it is known that the black box ai techniques are useful for prediction and forecasting but they are not built using insights on the physical processes involved in this type of modeling the knowledge about the underlying mechanisms is not necessary and the main purpose is obtaining accurate forecasts 3 6 used software programs more than half of the papers reviewed in this study have mentioned the software programs used for ai modeling while the rest have preferred not to mention the used software program fig 8 shows number of times that different software programs were used to develop ann anfis gp and svm models for gwl forecasting it should be noted that in fig 8 the hybrid models are also considered as can be seen the matlab is the most used software program the matlab software program has different ai toolboxes that allow the user to easily apply them for the desired purpose with the least needs for coding other software programs have been also used for example the neurosolutions mohammadi 2008 jha and sahoo 2015 gholami et al 2015 qnet emamgholizadeh et al 2014 and r mukherjee and ramachandran 2018 software programs have been used in some cases for developing the ann even the programming languages such as visual basic tapoglou et al 2014 and c yoon et al 2011 shiri et al 2013 have been used in several papers the genexpro is a software program in the field of gp and evolutionary computation that has been used by shiri et al 2013 details regarding these software programs can be found on the web and we do not discuss about them here although many papers have not mentioned the used software it seems that the matlab software program is a good choice for development of the ai models 3 7 incorrect development of ai models for gwl forecasting the incorrect development of ai models for gwl forecasting can be occurred in different stages of the modeling it may be occurred during the input data consideration if the data are insufficient incorrect or irrelevant we should not expect the model to have correct forecasts when importing the inputs to the model it is also important whether the inputs are average or related to a specific time for example in the monthly time steps it is important to know whether the input data are related to the monthly average or to a specific day in each month and whether they are recorded in the same day of each month or not i e whether the record period is 30 days or longer or shorter use of too many inputs is also caused by input redundancy where they may provide redundant information and cause overfitting and therefore the real world forecasted gwl to be incorrect the incorrect development can also be during the data division in training validation and testing sub sets when the data have not been appropriately divided the training validation and testing sub sets should have the same statistical properties in order to develop the best possible model maier et al 2010 a number of best ways for considering the input data and input data division can be found in maier et al 2010 one of the most common mistakes occurs when developing hybrid wavelet al models some recent wavelet based hydrological including gwl forecasting models have been incorrectly developed and cannot properly be used for real world forecasting problems quilty and adamowski 2018 according to the quilty and adamowski 2018 the incorrect development of wavelet based forecasting models occurs during wavelet decomposition and as a result imports error into the model inputs the origin of this error is due to the boundary condition that is linked to the wavelet decomposition in three main issues i e using future data inappropriately selecting decomposition levels and wavelet filters and not properly partitioning training validation and testing data the future data issue occurs when a given wavelet requires data from the future of the time series to calculate a wavelet or scaling coefficient in the present for solving this problem the causal wavelet algorithms such as a trous and maximal overlap dwt should be used since they do not use future data in addition to the not using the future data the causal algorithms reduce the number of wavelet and scaling coefficients affected by the boundary condition which must be removed from the input sub time series to have a real world forecasting model the partitioning issue is also solved when using causal wavelet algorithms but the wavelet must be applied to the testing predicting set one record at a time and then the forecast must be calculated through the model for each testing predicting record and so on quilty and adamowski 2018 in the current review study several ai methods for gwl modeling were investigated by surveying the recent published researches in this field here one of the important issues is exploring which ai method works better and can best simulate the gwl it seems that the answer to this question can be different in different studies according to the table 1 among 67 papers the ann anfis gp and svm were respectively declared as the most appropriate models by 28 6 2 and 7 papers while 17 papers used hybrid wavelet ai models and 7 papers applied other hybrid ai models and reported that hybrid models led to better modeling it appears that in the last few years more attention has been paid to apply hybrid models so that application of hybrid models leads to better results in comparison with single ai models in particular the pre processing of input data by common tools such as wavelet analysis has frequently been used in this area to achieve better modeling performance 4 conclusions and recommendations the ai methods have been used for gwl modeling as well as other hydrological and environmental modeling in this study 67 papers dealing with ai methods in gwl modeling which were published in 29 international journals from 2001 to 2018 were reviewed from these papers it was found that ai methods can successfully be used to simulate and predict the gwl time series in different aquifers this kind of modeling is based on an ai effort to find natural relationships between gwl and different hydrological variables without the need for constructing any conceptual model the ai models can be useful when it is difficult to build an adequate knowledge driven simulation model due to the lack of the ability to satisfactorily construct a mathematical physical model of the underlying processes these models have several key stages including input data consideration input data division regulation of the model features training testing etc which if all the stages carefully be developed it is expected that the model performance to be good however it should be noted that there was not a fixed rule for these stages such that different studies performed each stage based on an empirical manner and or trial and error procedure considering available data and existing conditions the obtained results from this review study that were embedded in two separated parts i e the results of each ai method and the general results and discussion can provide many guidelines for researchers to perform similar works in the related field develop innovative methods and improve the quality of modeling for this purpose the following recommendations can also be suggested 1 the ai methods can be linked to conceptual numerical models such as modflow to develop integrated modular models such that each method covers the weak points of the other method for example if an ai model generates accurate gwl forecasts in a special aquifer it can be used to prepare and complete gwl data required for modflow as the input according to mohammadi 2008 the anns needed less input data and took less time to run compared to modflow therefore using anns and other ai methods can decrease the computations of modflow which are very time consuming in another example the gwl data sets estimated by modflow can be used to train ai models if there was not enough real data 2 more attention should be given in the stage of input consideration in order to select appropriate input variables and lag times in the reviewed papers the input variables were often selected based on data availability or using simple user defined relationships more analytical methods or model based approaches can be applied to determine input significance as suggested by wu et al 2014 in particular utilizing the gwl time series as the most widely used and most important input variable for ai gwl forecasting should be more investigated the gwl fluctuations provide a direct measure of the impact of groundwater development and important information about the aquifer dynamics is embedded in gwl time series so it can be said that the future of gwl is predictable form the past gwl furthermore in the stage of input consideration the non causal wavelets such as a trous and maximal overlap dwt can be explored to unravel the component features of different input variables in order to determine the lags correlation and interaction between the hydrological variables and gwl 3 regarding different ai methods to simulate the gwl it can be said that it is not practically possible to recommend one particular type of ai model for a given problem however it is clear that a hybrid coupled model likely perform better than a single ai model different types of ai techniques can be tested at the different stages of the gwl modeling to select the best ai method in each stage and then combine them to have an optimum modeling performance 4 in the wavelet decomposition of the gwl border effects as well as the caution of causality which occurs in the beginning and end of the decomposed sub time series is an area that has received a little attention in the most papers which have used wavelet ai models for gwl modeling so this topic can be raised for the new researches the decomposition of the total data set at once or each sub data set i e training validation and testing sets separately and the ways to prepare the decomposed sub time series for applying them as the model input is an interesting subject deserving further investigation 5 according to the quilty and adamowski 2018 some wavelet based hydrological models have been incorrectly developed and the solution is the use of non causal wavelet algorithms such as a trous and maximal overlap dwt algorithms since this has not been done so far in gwl forecasting the use of these wavelet algorithms should be addressed in a new study 
