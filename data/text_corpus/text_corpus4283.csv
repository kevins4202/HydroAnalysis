index,text
21415,this paper investigates the problem of precise trajectory tracking control of an autonomous underwater vehicle auv under parameter perturbations and external disturbances to design a data driven control scheme with high tracking accuracy and strong robustness a compensated model free adaptive control mfac scheme is proposed by combining an extended state observer eso specifically a data driven structure improved linear eso sleso is derived to online estimate the model approximation error generated by pseudo jacobian matrix estimation in the typical mfac scheme another problem of the typical mfac is that it cannot be directly applied to robotic systems with rotation in the inertial frame to tackle this issue a two loop controller architecture is used to design the proposed sleso mfac scheme in addition the structure of the mathematical model of auvs and force analysis are used in mfac design for the first time thus providing a straightforward initial value setting method with explicit physical interpretation and helping to judge if the assumptions in the mfac scheme can be satisfied furthermore the stability analysis of the designed control system is given finally the robustness and effectiveness of the proposed sleso mfac scheme are substantiated via simulations and comparisons using a realistic dynamic model of the falcon auv abbreviations mfac model free adaptive control sleso structure improved linear extended state observer dld dynamic linearization data pjm pseudo jacobian matrix iae integral of absolute error mae maximum absolute error keywords data driven anti disturbance parameter perturbation model free adaptive control extended state observer autonomous underwater vehicle 1 introduction underwater robots especially autonomous underwater vehicles auvs have attracted considerable attention in marine research cui et al 2017 compared with human occupied vehicles and remotely operated vehicles auvs can complete tasks independently and flexibly with a wide scope of movement therefore they have been extensively applied in submarine geomorphology observation kamaev et al 2017 marine environment monitoring tonacci et al 2015 underwater rescue and detection cao et al 2020 etc to exploit the potential benefits provided by auvs high precision trajectory tracking control has become a crucial issue gan et al 2017 many researches have been conducted on the trajectory tracking control of auvs for decades however up to now there are still severe challenges in practice 1 an auv is a complex system with strong coupling and high nonlinearity and it is difficult to obtain an accurate dynamic model for the control system design gan et al 2017 2 the unknown parametric perturbations always exist in auv dynamic modeling especially when dealing with the time varying hydrodynamic coefficients during auvs executing tasks different altitude temperature gradients and densities of water will cause the variation of hydrodynamic coefficients 3 auvs inevitably suffer from unknown external environmental disturbances such as ocean currents waves wind and tides accordingly the exact dynamic model of auv may not be known a priori therefore the control methods relying on accurate dynamic models such as state feedback linearization kamarlouei and ghassemi 2016 and linear nonlinear model predictive control li and yan 2016 shen et al 2016a zhang et al 2019 are difficult to implement in practice as a result the auv control system is required to have a robust capability of online self adjusting and adapting to a time varying environment to address the challenges of parametric perturbations and unknown external disturbances a number of control methods have been introduced in recent years such as adaptive control robust control and disturbance observer based control specifically adaptive control fossen and sagatun 1991 sarhadi et al 2017 has been extensively used for auv systems because it does not require an accurate mathematical model also owing to its insensitivity to parametric uncertainty robust control especially sliding mode control zhang et al 2018 yan et al 2019 and back stepping control cho et al 2020 have been widely used as well another effective solution is disturbance observers including sliding mode observer na et al 2013 high gain observer fernandes et al 2015 finite time disturbance observer ni et al 2017 yan and yu 2018 and extended state observer eso yang et al 2019 han 2009 ren et al 2019 guerrero et al 2020 nevertheless the above studies belong to model based control it is obvious that the dynamic modeling of auvs and the parameter identification process are complicated time consuming and of high cost especially the hydrodynamic coefficients are usually calculated using computational fluid dynamics methods or towing tank experimental data analysis cui et al 2017 this motivates us to develop data driven control schemes for auv trajectory tracking up to now many data driven control approaches have been proposed such as model free adaptive control mfac hou and jin 2011 neural network nn based control gao et al 2017 duan et al 2020 virtual reference feedback tuning vrft campi and savaresi 2006 and unfalsified control uc van helvoort et al 2007 in particular mfac is proposed by hou based on dynamic linearization technique hou and jin 2011 in mfac scheme equivalent dynamic linearization data models are built to replace the mathematical models of the controlled plants only using the real time measurement i o data it is an attractive option for auv systems from an implementation point of view note that the training process and offline learning are impractical and expensive for uncertain auv systems therefore many data driven schemes e g nn based control which require training processes with rather rich offline input output i o data of the open loop system are difficult to apply in practice in contrary mfac is an online self adjusting scheme with lower cost and real time control which does not require any external testing signals or training process moreover it can be easily implemented with small computational burden as a result mfac is more suitable for auvs in practice in addition the convergence and stability of mfac for discrete time nonlinear systems are guaranteed which is a highlighted feature compared with other data driven control approaches hou and jin 2011 such as vrft and uc unfortunately the typical mfac focuses on building an approximate data model by pseudo jacobian matrix pjm estimation based on the online i o data in other words the model approximation error i e error between the real system and the dynamic data model generated by pjm estimation always exists especially when the system is subjected to sudden changes in the system state stochastic external disturbances and parameter perturbations the corresponding error will be even larger seriously deteriorating the control performance in the typical mfac scheme how to design a mfac scheme with high tracking accuracy and strong robustness however is still an open issue in the literature to tackle the above issue disturbance observers can be employed specifically the model approximation error can be estimated by the observer in real time and then compensated in control input in particular the eso proposed by han han 2009 is attractive for auv systems in which the combination of system uncertainties and external disturbances is considered as the total disturbances and further regarded as a new state owing to its simple and decoupling design eso has been widely applied to various practical systems e g robot control ren et al 2019 motor control zhou et al 2020 and energy control liu et al 2016 in recent years some works applied typical mfac to robotic systems such as li et al 2019 in which mfac is used in auv heading control however another two major limitations still remain in its application to complicated robotic systems on the one hand to the best of authors knowledge mfac has not been applied to multiple input multiple output mimo coupling robotic systems with rotation in the literature it should be noted that a common assumption in the mfac scheme i e the unchanged sign of all the elements of pjm cannot be satisfied for robotic systems with rotation because of the rotation matrix in other words the typical mfac cannot be directly applied to robotic systems with rotation in the inertial frame on the other hand the empirical initial value setting in pjm estimation is difficult yet plays a crucial role in implementation of the mfac scheme to be specific the control system will be unstable if the initial value is not properly set however the initial value setting method in the mfac scheme has not been discussed in the literature in this paper a structure improved linear extended state observer sleso based mfac scheme is proposed for the trajectory tracking control of auvs with parameter perturbations and stochastic external disturbances the proposed sleso mfac scheme is a data driven and anti disturbance control framework to ensure that the mfac scheme can be applied to auv systems with rotation a two loop controller architecture is employed and then the sleso mfac scheme is designed in the non inertial frame i e the body fixed frame attached to the center of gravity of the auv in this paper this design method can avoid the influence of the rotation matrix of the auv on pjm estimation within this architecture a proportional differential pd kinematic controller is designed in the outer loop to generate desired velocity profiles and the proposed scheme is designed as the inner loop controller the design process of the sleso mfac scheme is summarized as follows firstly the dynamic model of auv in the body fixed frame is transformed into a dynamic linearization data dld model with incremental total disturbance term by using the structure of auv dynamic model the intuitive correspondence between system mathematical model and data driven model can be obtained it can provide guidance for crucial initial value setting in mfac scheme and it can help to judge if the assumptions in mfac scheme can be satisfied for auv systems secondly the pjm of the dld model is estimated by the modified projection algorithm using the online i o data of the auv system in particular the straightforward initial value setting method of pjm estimation is proposed for the first time moreover the setting guidance of parameters in the reset algorithm of pjm estimation is also given to the best of authors knowledge however parameter setting is still a challenge in existing literature of mfac scheme thirdly to estimate the incremental total disturbance term of the dld model a data driven sleso is derived by improving the structure of traditional linear eso tleso it can accelerate the disturbance estimation convergence with much smaller gains then the detailed design of the observer gain matrix of sleso is given at last a mfac method is designed to achieve velocity tracking and compensate the disturbances estimated by sleso then the stability analysis of the pjm estimation the stability analysis of sleso and that of the inner closed loop control system are presented finally comparative simulations with the typical mfac using a realistic falcon dynamic model with three different scenarios are conducted the effectiveness and robustness of the proposed sleso mfac scheme towards stochastic disturbances hydrodynamic uncertainties sudden changes of the system state and measurement noise are validated in simulations moreover a comprehensive discussions are also presented related to the limitations and solutions of the proposed scheme analyses and solutions of control input spikes comparisons and combinations of model based and data driven disturbance observes etc the main contributions of this paper are threefold 1 a sleso mfac scheme is proposed by introducing a data driven sleso to online estimate the model approximation error generated by pjm estimation compared with the typical mfac the proposed control scheme can achieve higher tracking accuracy and stronger robustness towards disturbances and sudden changes in system dynamics in addition the number of reset times in pjm estimation is greatly reduced in the proposed control scheme 2 utilizing the two loop controller architecture this paper provides design guidance of mfac scheme for all robotic systems with rotation for the first time it solves the problem that the typical mfac cannot be directly applied to robotic systems with rotation in the inertial frame due to an important assumption in pjm estimation is unsatisfied 3 a straightforward initial value setting method of pjm estimation for auv systems is first proposed with explicit physical interpretation specifically the structure of mathematical model of auv and force analysis are used for the initial value setting in this paper note that the initial value setting is crucial in mfac scheme since the control system will be unstable if the initial value is not properly set however the issue has not been discussed in the literature in addition the usage of the structural information of dynamic model can help to judge if the assumptions in mfac scheme can be satisfied for auv systems the remainder of this paper is organized as follows section 2 presents the dynamic models of auv in both body fixed and earth fixed inertial frames and formulates the problem in section 3 the detailed design procedure of the sleso mfac scheme and the stability analysis are given in section 4 the implementation details comparison design simulation results as well as comprehensive discussions are introduced finally conclusions are drawn in section 5 2 problem formulation auvs usually move with 6 degrees of freedoms dofs in a three dimensional space to simplify the controller design and analysis this paper focuses on the horizontal plane motion of an auv with 3 dofs two coordinate frames are introduced an earth fixed inertial frame e and a body fixed frame b attached to the center of gravity of the auv as shown in fig 1 the nomenclature is defined in table 1 the kinematic equation of the auv that translates the body fixed velocity into the earth fixed velocity can be written as follows 1 η j η v where j η is a coordinate transformation matrix i e rotation matrix given by j η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 for an auv the well established 6 dof dynamic model in the body fixed frame is as follows fossen 2002 2 m v c v v d v v g η d η v τ where m denotes the inertia matrix including added mass c v represents the state dependent matrix of coriolis and centripetal terms d v is the hydrodynamic damping and lift matrix g η represents the vector of gravitational forces and moments respectively and d η v is the model s uncertainty vector which is induced by external oceanic disturbances and unmodeled hydrodynamics in the horizontal plane three assumptions are introduced shen et al 2016b 1 the auv s structure is symmetric 2 mass distribution is homogeneous 3 the pitch and roll motions are neglected under these assumptions the dynamic model in the body fixed frame in the horizontal plane is simplified to a 3 dof nonlinear dynamic equation as follows 3 m v h v v d η v τ where m m r b m a d d m r b denotes the rigid body mass matrix and m a d d represents the added mass matrix h v c v d v the system parameter matrices in 3 are simplified as shen et al 2016b m r b m 0 0 0 m 0 0 0 i z m a d d x u 0 0 0 y v 0 0 0 n r c v 0 0 m y v v 0 0 m x u u m y v v m x u u 0 d v x u d u u 0 0 0 y v d v v 0 0 0 n r d r r the dynamic model in the earth fixed inertial frame can be obtained by combining 1 and 3 4 m η η η h η η η η d η η τ where m η η m j 1 η h η η η c η η j 1 η d η η j 1 η m η η j j 1 m η η m x u cos ψ m x u sin ψ 0 m y v sin ψ m y v cos ψ 0 0 0 i z n r h η η h 11 h 12 h 13 h 21 h 22 h 23 h 31 h 32 h 33 where h 11 x u d u cos ψ x sin ψ y cos ψ m x u sin ψ ψ h 12 x u d u cos ψ x sin ψ y sin ψ m y v cos ψ ψ h 13 m y v sin ψ x cos ψ y h 21 y v d v sin ψ x cos ψ y sin ψ m x u cos ψ ψ h 22 y v d v sin ψ x cos ψ y cos ψ m y v sin ψ ψ h 23 m x u cos ψ x sin ψ y h 31 m y v sin ψ x cos ψ y cos ψ m x u cos ψ x sin ψ y sin ψ h 32 m y v sin ψ x cos ψ y sin ψ m x u cos ψ x sin ψ y cos ψ h 33 n r d r ψ it can be seen that the trajectory tracking control of auv is challenging due to the nonlinearity and coupled dynamics in model 4 moreover in practical applications it is impossible to obtain the accurate hydrodynamic coefficients or disturbances therefore it is necessary to develop a model free controller with online model estimation and real time disturbance compensation the control objective of this paper is to develop a sleso mfac scheme for precise trajectory tracking control of auvs under unknown external disturbances and time varying hydrodynamic parameters here position η and the velocity of the auv in the body fixed frame v can be measured in real time by sensors see remark 5 while all system parameters are unknown then a proper control input τ t can be designed using the online i o data to make the auv achieve precisely tracking of the reference trajectory η d t i e the trajectory tracking error lim t e t lim t η d t η t 0 3 controller design and analysis in this section the proposed sleso mfac scheme and stability analysis are presented the sleso mfac scheme is shown in fig 2 which consists of a data model parameter estimator i e pjm estimator an observer based total disturbance estimator i e sleso and a controller with disturbance compensation i e mfac to apply the sleso mfac scheme to auv systems with rotation a two loop controller architecture is employed in the outer loop a pd kinematic controller is designed to generate desired velocity profiles to minimize the accumulated error between the real and desired trajectories in the inner loop a controller based on sleso mfac scheme is designed to ensure that the reference velocity generated by the outer loop controller can be accurately tracked by the auv the block diagram of the proposed controller design is shown in fig 3 3 1 outer loop controller from the kinematic equation 1 the nominal velocity v d of the auv in the body fixed frame for a desired trajectory η d t x d t y d t ψ d t t is given as follows 5 v d k 1 j t ψ d k 1 η d k 1 then a pd feedback control law is designed to stabilize the tracking error the desired velocity command to the inner loop is given by 6 v d k 1 v d k 1 j t ψ d k 1 k p 1 e η k k d 1 e η k where v d represents the desired velocity of the auv in the body fixed frame e η k η d k 1 η k e η k η d k 1 j ψ k v k k p 1 d i a g k p 1 k p 1 k p 1 k d 1 d i a g k d 1 k d 1 k d 1 3 2 dynamics discretization and transformation in this subsection the continuous time dynamic model 3 is transformed into a discrete time one at first which is further transformed into a dld model because v k v k and η k are fixed matrices at the k th moment h v and d η v are also fixed simultaneously the sampling time for the auv control is selected as t assume that v t v k t v k τ t τ k t τ k k t t k 1 t therefore the dynamics of the auv system can be approximated by the following form 7 m v k h v k v k d k τ k as m is a symmetric positive definite matrix and v k v k 1 v k t for the sample period of t the k th moment discrete time form of the auv dynamic model is approximated as follows 8 v k 1 t m 1 τ k i t m 1 h v k v k t m 1 d k from 8 we have δ v k 1 v k 1 v k t m 1 δ τ k i t m 1 h v k v k i t m 1 h v k 1 v k 1 t m 1 d k d k 1 let δ ζ k i t m 1 h v k v k i t m 1 h v k 1 v k 1 δ d 1 k t m 1 d k d k 1 t m 1 δ d k f k δ ζ k δ d 1 k the discrete time dynamic model can be transformed into 9 δ v k 1 t m 1 δ τ k f k it can be seen that the partial derivatives of the right hand side of eq 8 with respect to control inputs τ k are continuous and the system is generalized lipschitz for system 8 with δ τ k 0 for each fixed k there must exist pjm φ c k such that 8 can be transformed into the following equivalent dld model hou and jin 2011 10 δ v k 1 φ c k δ τ k f k where φ c k ϕ 11 k ϕ 12 k ϕ 13 k ϕ 21 k ϕ 22 k ϕ 23 k ϕ 31 k ϕ 32 k ϕ 33 k and φ c k b f k is defined as the variation of total disturbance i e the incremental total disturbance term assumption 1 the incremental total disturbance term f k is assumed to be bounded δ f k 1 which is defined as the variation of f k is also assumed to be bounded when the sample time is short enough remark 1 specifically the incremental total disturbance term f k compensates the error between the real auv system and the dld model moreover f k represents the variation of total disturbance i e the variation of disturbance related term δ d 1 k and hydrodynamics related term δ ζ k between the k 1 th and k th moments in addition the assumption above is reasonable and acceptable from a practical point of view 3 3 pjm estimation by modified projection algorithm in this subsection the modified projection algorithm is employed to estimate pjm φ c k in the equivalent dld model 10 based on the system s i o data besides the crucial initial value setting method for pjm estimation and the setting guidance for parameters in the reset algorithm are proposed assumption 2 pjm φ c k is a diagonally dominant matrix in the following sense i e ϕ i j k b 1 b 2 ϕ i i k α b 2 i 1 2 3 j 1 2 3 i j α 1 b 2 2 b 1 2 α 1 and the sign of all the elements of φ c k is unchanged hou and jin 2011 remark 2 according to 9 and 10 it is obvious that φ c k is approximately equal to t m 1 from the auv dynamic model in the body fixed frame 3 t m 1 is a diagonal constant matrix therefore the assumptions of diagonally dominant matrix and the unchanged sign of all the elements of φ c k in the mfac scheme can be satisfied on the other hand the initial value of pjm estimation φ ˆ c 1 can be set as a diagonal matrix note that by using the structural information of the auv dynamic model the intuitive correspondence between the system s mathematical model and data driven model can be obtained it is helpful in judging whether mfac can be applied to auv systems i e whether the assumptions in the mfac scheme can be satisfied for auv systems in addition it can facilitate the mfac design and provide guidance for initial value setting remark 3 assumption 2 is a common assumption in the mfac scheme the unchanged sign of all elements of φ c k is similar to the control direction in model based control methods hou and jin 2011 it can be seen that φ c k describes a direct mapping from the variation of control input to the variation of system output in other words for an auv if the controller is designed in the earth fixed inertial frame then φ c k describes a mapping from δ τ k to δ η k 1 in this case according to the dynamic model in the earth fixed inertial frame 4 the sign of elements in φ c k will be changed due to j ψ if the auv moves with rotation i e the assumption cannot be satisfied in the earth fixed inertial frame similarly for all robotic systems with rotation the mfac scheme should be designed in a non inertial frame e g the body fixed frame in this paper to avoid influences of the rotation matrix on pjm estimation besides compared with the dynamic model in the body fixed frame 3 the nonlinearity and coupled dynamics are much stronger in the dynamic model in the earth fixed inertial frame 4 thereby increasing the difficulty in the controller design as a result it is necessary to design the mfac scheme for auv in the body fixed frame here a two loop controller architecture is recommended according to the dld model 10 a cost function of pjm estimation is given as follows 11 j φ c k δ v k φ c k δ τ k 1 f k 1 2 μ φ c k φ ˆ c k 1 2 where μ 0 is a penalty factor on δ φ ˆ c k here φ ˆ c k is the estimation of φ c k by applying the first order taylor expansion to φ c k δ τ k 1 in φ c φ ˆ c k 1 and minimizing the cost function 11 the pjm estimation can be obtained using the modified projection algorithm 12 φ ˆ c k φ ˆ c k 1 η δ v k φ ˆ c k 1 δ τ k 1 f ˆ k 1 δ τ t k 1 μ δ τ k 1 2 where η 0 2 is a step size constant here f ˆ k 1 is defined as the estimation of the incremental total disturbance term f k 1 the reset algorithm of φ ˆ c is as follows 13 ϕ ˆ i i k ϕ ˆ i i 1 if ϕ ˆ i i k b 2 or ϕ ˆ i i k α b 2 or s i g n ϕ ˆ i i k s i g n ϕ ˆ i i 1 ϕ ˆ i j k ϕ ˆ i j 1 if ϕ ˆ i j k b 1 or s i g n ϕ ˆ i j k s i g n ϕ ˆ i j 1 i j where ϕ ˆ i j 1 is the initial value of ϕ ˆ i j k i 1 2 3 j 1 2 3 note that the reset algorithm 13 can be used to improve the pjm estimation stability when tracking the time varying trajectory in particular when the state of auv suddenly changes or large disturbances and uncertainties occur in the auv system the robustness of the pjm estimation will be guaranteed by using the reset algorithm furthermore the straightforward setting method of φ ˆ c 1 and the setting guidance for parameters in the reset algorithm i e α b 1 b 2 are proposed for the first time for φ ˆ c 1 setting it should be noted that the control performance of the mfac scheme is quite sensitive to φ ˆ c 1 especially the sign of each element in φ ˆ c 1 in particular the control system will be unstable if φ ˆ c 1 is not properly set therefore a straightforward setting method for φ ˆ c 1 with physical interpretation is crucial according to remark 2 φ ˆ c 1 can be set as a diagonal matrix using the structure of mathematical model of auv in addition from remark 3 φ c k describes a direct mapping from the variation of thrust force δ τ k to the variation of velocity δ v k 1 for an auv in the body fixed frame according to the force analysis of the auv τ f u f v m i t and v u v r t are in the same direction in other words τ has positive effects on v therefore φ ˆ c 1 can be set as a positive definite diagonal matrix the setting of α b 1 and b 2 determines the range of pjm estimation therefore they are also important to the performance of pjm estimation it is obvious that the decrease in the range of pjm estimation especially φ ˆ i i k will improve the robustness and adaptation of the algorithm with respect to sudden changes in the system however if the range of φ ˆ i i k is selected to be very small then the number of reset times of φ ˆ c will increase greatly deteriorating the tracking performances as a result there exist trade offs among different design considerations 3 4 disturbance estimation by sleso in this subsection a data driven second order sleso is derived to estimate the incremental total disturbance term f k in the dld model 10 first a data driven tleso is designed then a data driven sleso is developed to improve the observation performance of tleso the state variables are defined as z 1 k v k z 2 k f k where z 2 k r 3 is unknown but bounded the system dld model 10 can be rewritten in the following state space form 14 z 1 k 1 z 1 k φ c k δ τ k z 2 k z 2 k 1 z 2 k f k 1 f k define z ˆ i k as the estimation of z i k and e o i k z i k z ˆ i k i 1 2 as estimation errors then the data driven tleso is constructed as follows 15 z ˆ 1 k 1 z ˆ 1 k φ ˆ c k δ τ k z ˆ 2 k t β 01 e o 1 k z ˆ 2 k 1 z ˆ 2 k t β 02 e o 1 k where β 0 i r 3 3 are the gain matrices of tleso i 1 2 which are diagonal positive definite here ω o 0 is defined as the observer bandwidth the observer gains are usually selected as β 01 2 ω o 0 0 0 2 ω o 0 0 0 2 ω o β 02 ω o 2 0 0 0 ω o 2 0 0 0 ω o 2 it is obvious that only the velocity estimation error e o 1 k is used in estimating all the state variables as a result the tleso 15 completes the tracking of z 1 first and then z 2 i e the incremental total disturbance sequentially in this case when e o 1 k becomes small high gains will be necessary to achieve a good estimation of z 2 i e the value of β 02 should be selected to be large however this limitation will aggravate the initial peaking phenomenon and phase lag seriously deteriorating the control performances and even damaging the robot to cope with this problem and improve the convergence rate and estimation performances motivated by sun and zhang 2017 the structure of tleso can be further modified as sleso 16 z ˆ 1 k 1 z ˆ 1 k φ ˆ c k δ τ k z ˆ 2 k t β 1 e o 1 k z ˆ 2 k 1 z ˆ 2 k t β 2 e o 2 k in the estimation of z 2 k in sleso 16 the disturbance estimation error e o 2 k is used instead of e o 1 k according to 14 and 16 e o 2 k can be derived as follows 17 e o 2 k z 2 k z ˆ 2 k e o 1 k 1 e o 1 k t β 1 e o 1 k let the pjm estimation error φ c k φ c k φ ˆ c k then the observer error dynamics can be written in the state space as follows 18 δ e o 1 k 1 t β 1 e o 1 k e o 2 k t φ c k δ τ k t δ e o 2 k 1 t β 2 e o 2 k δ f k 1 t let e o k e o 1 k e o 2 k t then 18 is transformed into 19 δ e o k 1 t a e e o k e 1 φ c k δ τ k t e 2 δ f k 1 t where a e β 1 i t 0 β 2 e 1 i 0 e 2 0 i i is an identity matrix and 0 is a zero matrix respectively the characteristic polynomial of the observer error dynamics is as follows 20 p λ λ 2 i β 1 β 2 λ i β 1 β 2 i for the sake of simplicity all poles of sleso in three channels are placed at the same position i e ω o thus the characteristic polynomial 20 can be rewritten as follows p λ β 1 λ i β 2 λ i λ ω o 2 i toward this end the observer gains are obtained as follows β 1 ω o 0 0 0 ω o 0 0 0 ω o β 2 ω o 0 0 0 ω o 0 0 0 ω o note ω o is the only parameter to be tuned in the sleso and t ω o 2 should be satisfied to guarantee the observer convergence then f ˆ k z ˆ 2 k remark 4 compared with the tleso design 15 e o 2 k is used to estimate f k in sleso 16 as a result the gain in sleso i e β 2 can be smaller than that in tleso i e β 02 therefore the peaking phenomenon due to high gains of tleso is alleviated in sleso besides compared with tleso sleso can greatly reduce the phase lag while improving the convergence rate and estimation accuracy of incremental total disturbance f k 3 5 mfac algorithm in this subsection a mfac method is designed to achieve velocity tracking and compensate the incremental total disturbance term estimated by the sleso consider the following criterion function of control input 21 j τ k v d k 1 v k 1 2 λ τ k τ k 1 2 where v d k 1 is the desired velocity generated by the outer loop controller and λ is a weighting constant by substituting 10 into the cost function 21 differentiating 21 with respect to τ k and then setting it as zero the control law is derived as follows 22 τ k τ k 1 ρ φ ˆ t c k v d k 1 v k f k λ φ ˆ c k 2 where ρ is a step size constant which is added to make 22 general and will be further used in the stability analysis it is obvious that λ is not only a penalty factor for δ τ k but also a constraint to suppress the φ c k from changing too quickly to improve the convergence rate and control performance pd feedback is introduced to the control law and f k estimated by f ˆ k in sleso is compensated in the controller finally the proposed mfac law can be designed as follows 23 τ k τ k 1 ρ φ ˆ t c k k p 2 e v k k d 2 δ e v k t f ˆ k λ φ ˆ c k 2 where the control error e v k v d k 1 v k k p 2 d i a g k p 2 k p 2 k p 2 k d 2 d i a g k d 2 k d 2 k d 2 the proposed sleso mfac scheme which consists of the control law 23 the observer 16 and the pjm estimation 12 is designed only using the online i o data of the auv meanwhile the incremental total disturbance term estimated by sleso is compensated in the control input in real time hence the proposed sleso mfac scheme is a typical data driven and anti disturbance control framework which can guarantee the tracking performance with high tracking accuracy and strong robustness 3 6 stability analysis in this subsection the convergences of the pjm estimation and sleso and that of the inner closed loop control system are analyzed respectively 3 6 1 convergence of the pjm estimation a typical stability analysis approach proposed by hou and jin 2011 is employed theorem 1 for an auv system satisfying assumptions 1 and 2 the pjm estimated value φ ˆ c k obtained by the modified projection algorithm and the estimation error φ c k are bounded the proof of theorem 1 is given in appendix a 3 6 2 convergence of sleso a typical stability analysis method for the discrete linear eso scheme proposed by shao et al 2008 is employed theorem 2 for an auv system satisfying assumptions 1 and 2 ω o 0 t ω o 2 there exist positive constants σ i j 0 such that the estimation errors e o i finally satisfy e o i j σ i j i 1 2 j 1 2 3 where σ i j and e o i j represent the j t h element of σ i and e o i respectively moreover the incremental total disturbance term f ˆ k estimated by sleso is bounded the proof of theorem 2 is given in appendix b 3 6 3 convergence of the inner closed loop inspired by hou and jin 2011 a typical stability analysis method for the mfac scheme is employed theorem 3 if an auv system satisfying assumptions 1 and 2 is controlled by the proposed control scheme then the following two properties will hold 1 the tracking error sequence is always bounded 2 the closed loop system is bounded input bounded output bibo stable the proof of theorem 3 is given in appendix c 4 simulation results in this section simulations were conducted to demonstrate the effectiveness and robustness of the proposed sleso mfac scheme for comparison simulations of mfac proposed by hou and jin 2011 were also given these two control algorithms were applied to the same experimental auv respectively three different scenarios with different trajectories were designed to verify the control performance of the proposed tracking controller 4 1 parameter selection to demonstrate the practical feasibility of the developed controller parameters were extracted from the realistic experimentally identified dynamic model of a falcon auv proctor 2014 which is an underwater vehicle developed at the university of victoria canada the detailed model parameters of auv are listed as follows shen et al 2016b mass m 116 kg moment of inertia in yaw i z 13 1 kg m 2 and hydrodynamic coefficients x u 167 6 y v 477 2 n r 15 9 x u 26 9 y v 35 8 n r 3 5 d u 241 3 d v 503 8 d r 76 9 the available control signals of actuators are considered to be f u m a x f u m i n 2000 n f v m a x f v m i n 2000 n m i m a x m i m i n 1000 n m besides the falcon auv is a redundant system equipped with four thrusts for the specific platform falcon the generalized forces and moments τ f u f v m i t can be calculated by the proposed control scheme then a thrust allocation strategy should be designed to calculate the required thruster actuation that is needed from each separate thruster in order to generate forces and moments equal to τ in recent years plenty of thrust allocation methods have been investigated in the literature johansen and fossen 2013 such as using the moore penrose pseudoinverse shen et al 2016b or a damped pseudoinverse hoffmann 2018 of the thruster configuration matrix multi objective optimization methods xia et al 2020 etc in this paper the thrust allocation strategy is not discussed in detail since it is beyond the scope of this paper in order to show the performance of the proposed control scheme in the presence of measurement noise an additive white gaussian noise with a signal to noise ratio snr of 90 db was added to each output data i e position η and velocity v using matlab function awgn furthermore to test the robustness of the proposed inner loop controller with respect to large measurement noise additive white gaussian noises with different snrs were added to the velocity measurements which will be described in detail in the design of scenario 1 for the purpose of comparison the simulations of mfac proposed by hou and jin 2011 were also conducted in which the dld model was 24 δ v k 1 φ c k δ τ k then the mfac algorithm can be summarized as 25 φ ˆ c k φ ˆ c k 1 η δ v k φ ˆ c k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 26 τ k τ k 1 ρ φ ˆ t c k k p 2 e v k k d 2 δ e v k t λ φ ˆ c k 2 the reset algorithm for φ ˆ c was the same as the proposed method for all simulations the controller parameters were identically set and all gains also remained unchanged the controller and observer parameters were set as follows and the sampling time t 0 01 s 1 in the outer loop controller k p 1 d i a g 1 1 1 and k d 1 d i a g 0 5 0 5 0 5 specifically to verify the control performance of the inner loop controller the gains in the outer loop controller were selected to be small in other words the control performance can be improved in practice when the pd gains were set larger 2 in the pjm estimation algorithm α 1 25 b 1 0 1 b 2 0 8 and μ 50 η 1 the initial value of the estimated pjm φ ˆ c was set as φ ˆ c 1 d i a g 1 1 1 3 in the mfac algorithm ρ 1 λ 0 5 k p 2 d i a g 30 30 30 and k d 2 d i a g 20 20 20 4 at last the observer bandwidth of the sleso was set as ω o 15 rad s to evaluate the control performance quantitatively the integral of absolute error iae and the maximum absolute error mae were used ren et al 2019 i e i a e x y m 0 t 1 e x e y d t i a e ψ r a d 0 t 1 e ψ d t m a e x y m max max e x max e y m a e ψ r a d max e ψ where t 1 represents the total tracking time obviously random quantities exist in all scenarios as a result repeated testing is necessary therefore for each scenario we have run the same tests for 5 times and the mean of iae the standard deviation of iae and the maximum of mae were used as performance metrics specifically m i a e x y represents the mean of i a e x y in 5 tests m i a e ψ represents the mean of i a e ψ s i a e x y represents the standard deviation of i a e x y s i a e ψ represents the standard deviation of i a e ψ m m a e x y represents the maximum of m a e x y m m a e ψ represents the maximum of m a e ψ respectively remark 5 implementation of the controller in practical application of the proposed control algorithm the position η x y ψ t and the velocity of auv in the body fixed frame v u v r t need to be measured in real time by sensors the visual positioning system vps can be used to measure the global frame coordinate x y of the auv and an inertial measurement unit imu can be used to calculate the absolute angle ψ of the auv in addition the velocity of auv in the body fixed frame v can be measured by the doppler velocity log dvl 4 2 scenarios design to test the effectiveness and robustness of the proposed sleso mfac scheme three different scenarios were considered scenario 1 nominal case and robustness tests towards sudden changes in the reference velocity and measurement noises under this scenario the auv was commanded to track a square trajectory the 40 s square reference trajectory was set as follows x d m 0 5 t 0 s t 10 s 5 10 s t 20 s 5 0 5 t 20 20 s t 30 s 0 30 s t 40 s y d m 0 0 s t 10 s 0 5 t 10 10 s t 20 s 5 20 s t 30 s 5 0 5 t 30 30 s t 40 s ψ d rad 0 0 s t 10 s π t 10 15 10 s t 20 s 2 π 3 20 s t 30 s 2 π 3 π 6 sin π t 30 6 30 s t 40 s to test the control performance in the nominal case the auv moved in the absence of external disturbances or parametric uncertainties note that the square trajectory has sudden changes in the reference velocity at each corner and the translational motion and direction suddenly change at the same time hence it can be used to test the effectiveness and robustness of the proposed control scheme furthermore the robustness tests under measurement noises were conducted to compare the robustness of the proposed sleso mfac scheme and mfac with respect to velocity measurement noise additive white gaussian noises with different snrs were added to velocity measurement i e v to mainly verify the control performance of the inner loop controller only slight noises were added to position measurement i e η in fact the velocity measurement noise is usually much larger in practice specifically 6 tests were conducted as listed in table 2 where s n r v represents the snr in velocity measurement and s n r η represents the snr in position measurement respectively in particular test 0 refers to the nominal performance of the auv in the absence of measurement noise under this scenario the initial position and yaw angle of the auv were set as x 0 y 0 ψ 0 t 0 0 0 t and the initial velocities were set as u 0 v 0 r 0 t 0 5 0 0 t scenario 2 robustness test towards external disturbances under this scenario the auv was commanded to track a lemniscate trajectory the 40 s lemniscate reference trajectory was set as follows x d m 2 sin π t 20 y d m 2 sin π t 10 ψ d rad π t 15 in the first 10 s the auv moved in the nominal case between 10 s and 40 s sudden persistent external disturbances d d u d v d r were added the external disturbances were set as different types in three channels to simulate wave and wind on the surface of water d u was set as low frequency stochastic disturbance the low frequency stochastic disturbance signals were generated by producing 50 random samples over 30 s one sample every 0 6 s using matlab function rand and linear interpolation was used to deduce the disturbance signal between two consecutive samples the range of stochastic disturbance was set from 400 n to 400 n d v was set as a high amplitude sinusoidal function d v 500 sin t n the range of control input is f v m a x f v m i n 2000 n and d r was set as a step function d r 400 n m under this scenario the initial position and yaw angle of the auv were set as x 0 y 0 ψ 0 t 0 0 0 t and the initial velocities were set as u 0 v 0 r 0 t 0 3 0 6 π 15 t scenario 3 robustness test towards parametric uncertainties under this scenario the auv was commanded to track a circle reference trajectory the 40 s circle reference trajectory was set as follows x d m 3 cos π t 20 y d m 3 sin π t 20 ψ d rad π t 10 to test the effectiveness of the controller and its robustness with respect to parametric uncertainties especially hydrodynamic parameters the internal parameters with 100 uncertainties were generated as follows δ m m δ i z i z δ x u x u s i n t π 6 δ y v y v s i n t π 5 δ n r n r s i n 0 8 t δ x u x u s i n 0 8 t π 4 δ y v y v s i n 0 8 t π 3 δ n r n r s i n 0 8 t δ d u d u s i n t π 6 δ d v d v s i n t π 5 δ d r d r s i n 0 8 t π 4 specifically δ represents uncertainties e g the hydrodynamic coefficient x u was set as x u δ x u in simulations it is obvious that all the corresponding hydrodynamic coefficients were time varying under this scenario the initial position and yaw angle of the auv were set as x 0 y 0 ψ 0 t 3 0 0 t and the initial velocities were set as u 0 v 0 r 0 t 0 0 5 π 10 t 4 3 simulation results and analysis 4 3 1 scenario 1 under scenario 1 5 repeated tests have been run and the corresponding performance indexes are listed in tables 3 and 4 pick one test arbitrarily and the simulation results are shown in fig 4 in the nominal case as shown in fig 4 a c the tracking performances have been greatly improved using the proposed sleso mfac scheme and the tracking errors were much smaller compared with those of mfac it can be observed from table 3 that miae siae and mmae of the proposed control scheme were much smaller compared with those of mfac this is because there are errors in the dld model estimated by the mfac scheme compared with the real system even if the auv moves in the absence of external disturbances or parametric uncertainties which will be estimated by sleso and then compensated for the robustness test towards sudden changes in the reference velocity attention should be paid to the corners of the square trajectory when the reference velocity suddenly changed the proposed control scheme can rapidly converge to a steady state with much smaller overshoot and a shorter settling time compared with mfac furthermore the results of robustness tests to velocity measurement noise are listed in table 4 with the snr of velocity measurement noise s n r v decreased the tracking accuracy in the mfac scheme was reduced greatly especially when s n r v was under 30 db however the robustness with respect to velocity measurement noise was greatly improved in the proposed control scheme therefore the proposed sleso mfac scheme has strong robustness towards sudden changes in the reference velocity and measurement noise and the scheme can achieve satisfying tracking performances in the nominal case with high convergence accuracy and fast convergence rate because it can compensate the model approximation error generated by pjm estimation 4 3 2 scenario 2 under scenario 2 5 repeated tests have been run and the corresponding performance indexes are listed in table 5 pick one test arbitrarily and the simulation results are shown in fig 5 as shown in fig 5 a c the tracking performances of the proposed control scheme significantly outperformed those of the mfac scheme on the one hand the tracking errors of the proposed control scheme were significantly smaller compared with those of mfac and accurately tracking can be maintained even in the presence of persistent and time varying external disturbances as can be also observed from table 5 on the other hand attention should be paid to t 10 s when three types of external disturbances i e low frequency stochastic disturbance high amplitude sinusoidal function and step function were suddenly added the proposed control scheme can rapidly converge to a steady state with much smaller overshoot and a shorter settling time compared with mfac scheme the observation performance of sleso in fig 5 e demonstrates that the designed observer can quickly and accurately estimate the time varying incremental total disturbance term f k the real external disturbance for auv is shown in fig 5 f from remark 1 f k includes the variation of disturbance δ d 1 k by comparing fig 5 e and f it is obvious that the variation of external disturbance was well estimated by sleso 4 3 3 scenario 3 under scenario 3 5 repeated tests have been run and the corresponding performance indexes are listed in table 6 pick one test arbitrarily and the simulation results are shown in fig 6 as shown in fig 6 a b the proposed sleso mfac scheme achieved excellent tracking performances first the tracking errors of the proposed control scheme were significantly smaller than mfac in the presence of 100 parametric uncertainties which is also verified in table 6 in addition it is noticed that at the initial stage the proposed scheme can rapidly converge to the reference with much smaller overshoot than the typical mfac the observation performance of sleso is shown in fig 6 d from remark 1 the incremental total disturbance term f k includes the variation of hydrodynamic uncertainties from fig 6 d it is obvious that f ˆ k estimated by sleso presented sinusoidal fluctuations meanwhile hydrodynamic parameters uncertainties were designed as sinusoidal functions indicating that the proposed sleso achieved good estimation performance of the variation of hydrodynamic uncertainties in summary simulation results have verified that compared with mfac the proposed sleso mfac scheme can achieve significantly superior tracking performance specifically the proposed scheme has higher tracking accuracy faster convergence rate and stronger robustness in the presence of stochastic external disturbances complex hydrodynamic uncertainties sudden changes in the reference velocity and measurement noise compared with the typical mfac scheme 4 4 discussion for the robustness test towards sudden changes in the reference velocity as shown in fig 4 the proposed control scheme can rapidly converge to a steady state compared with mfac it is obvious that when the auv s state of motion suddenly changed the reset algorithm in the mfac scheme was used to ensure that the pjm estimation has stronger robustness and adaptation to the abrupt changes in systems as shown in fig 4 f at the same time however the model approximation error will greatly increase in the mfac scheme thereby deteriorating the tracking performances on the other hand the model approximation error f k in the proposed control scheme was estimated by sleso which was further compensated in control input in real time fig 4 e shows f ˆ k estimated by sleso as a result the tracking performance is superior in the proposed sleso mfac scheme for the robustness tests towards velocity measurement noise as listed in table 4 robustness was greatly improved in the proposed control scheme this is because that along with the increase in velocity measurement noise the model estimation performance in the mfac scheme will be greatly deteriorated however in the proposed control scheme the model approximation error will be estimated and compensated in real time hence its tracking performance will be guaranteed when measurement noise exists nevertheless when the measurement noise is very large the tracking performance of the proposed control scheme will get worse because of the data driven design the relevant details will be discussed in remark 6 remark 6 limitations and solutions of the proposed scheme the proposed sleso mfac scheme is a data driven control scheme however in practical applications measurements are never perfect the i o data may be distorted by all kinds of noises or suffered from data dropouts because of failing sensors actuators or network failures bu et al 2012 and this will deteriorate the control performance of the proposed scheme and even cause damage to the actuator under serious conditions as shown in table 4 when the measurement noise was set very large the tracking performance of the proposed control scheme will get worse even if it worked well than the typical mfac scheme this limitation is common in data driven control schemes and many researches have been conducted to cope with this problem in bu et al 2012 a modified mfac algorithm is proposed with decreasing gain to attenuate the measurement disturbance in xie et al 2018 the measurement noise and data dropouts are estimated and eliminated by feedback compensation periodically in sun et al 2020 a hybrid data driven and model assisted control strategy is proposed to reduce the sensor noise effect on the actuator by a modified eso design which will be discussed in detail in remark 8 moreover adaptive filtering algorithms akhtar 2016 low pass filters li et al 2019 etc can be used to smooth measurement noise and compensate the data dropouts in the robustness test towards external disturbances and parametric uncertainties the proposed control scheme can achieve superior tracking performance compared with the mfac scheme this is because that sleso can estimate the variations of disturbances and hydrodynamic uncertainties in real time in particular attention should be paid in two aspects firstly when the auv system is suffered from time varying parameter perturbation the pjm of the system also changes significantly in real time however the pjm estimation algorithm always attempts to capture any change of the pjm as a result as shown in fig 6 f φ ˆ c was frequently reset and had large oscillations in the mfac scheme to keep estimating the time varying pjm the frequent reset of φ ˆ c will increase the model approximation error and then deteriorate the tracking performances on the other hand however as shown in fig 6 e the number of reset times of φ ˆ c was greatly reduced in the proposed control scheme this is because that sleso can handle most hydrodynamic uncertainties which can help to reduce the estimation burden of the pjm estimation algorithm thus lead to a sensitivity reduction to the time varying parameter perturbation and disturbances secondly in fig 6 d and fig 5 e at the initial stage both f ˆ k estimated by sleso were large it is clear that φ ˆ c needs a settling time to achieve satisfying estimation results hence the model approximation error was large at the initial stage this can explain the rapid convergence of the proposed control scheme at the initial stage furthermore the convergence time of the proposed scheme should be discussed for practical application of auv firstly at the initial stage of scenario 1 and scenario 2 the proposed control scheme achieved very fast convergence to the reference trajectory in nominal case secondly under scenario 1 take the second corner for example t 20 s where the reference velocity suddenly changed the proposed control scheme only took about 0 5 s to converge to the reference trajectory and it can be noticed that the mfac scheme took a longer time to converge to the reference than the proposed control scheme thirdly under scenario 2 take the third channel orientation tracking for example the proposed control scheme took about 5 5 s to converge to the reference when a high magnitude step disturbance was added at t 10 s it converged faster to the desired value than the mfac scheme in spite of the added disturbances fourthly under scenario 3 time varying parametric uncertainties were added to the auv system take the second channel y tracking for example the proposed control scheme took about 3 s to converge to the reference obviously the convergence of the proposed algorithm was faster than the mfac scheme despite with the time varying parametric uncertainties in summary the proposed control scheme can achieve fast convergence to the reference trajectory in nominal case as well as in the presence of sudden changes in the reference velocity stochastic external disturbances and time varying hydrodynamic uncertainties as a result the proposed control scheme is practical for real auvs what is more the rate of convergence of the proposed control scheme can be improved by increasing the control parameters k p 1 k d 1 k p 2 k d 2 and ω o which should be tuned based on specific requirements in practical applications remark 7 analyses and solutions of control input spikes it is well known that control input signals with huge spikes cannot be achieved by real actuators and even may cause damage to the actuator under serious conditions however in the simulations input spikes occurred in scenario 1 and scenario 2 while not occurred in scenario 3 as shown in figs 4 d 5 d and 6 c it can be found that when the auv s reference velocity suddenly changed or the auv was suffered from sharply changed disturbances include internal and external disturbance the input spikes occurred and the greater the sudden changes were the more severe the input spiking phenomenon became nevertheless when the auv was suffered from slowly changed disturbances or no added disturbances the input spikes did not occur this is because when sudden changes happened in the auv system the proposed control scheme tried hard to produce large control input to make sure the system can converge rapidly to a steady state to handle the control input spikes in the proposed control scheme two solutions can be adopted firstly the proportional gain k p 2 and the differential gain k d 2 can be tuned smaller secondly in practical applications we can limit the variation of control input per sampling period to satisfy the actuator constraint to be specific τ is designed as follows for the sake of simplicity τ is expressed for each channel i e τ f u f v m i t τ 1 τ 2 τ 3 t τ i k τ i k i f min δ τ i δ τ i k max δ τ i τ i k 1 max δ τ i i f δ τ i k max δ τ i τ i k 1 min δ τ i i f δ τ i k min δ τ i where min δ τ i max δ τ i represents the achievable variation of control input per sampling period of the real actuator i i 1 2 3 δ τ i k τ i k τ i k 1 represents the variation of control input per sampling period this solution is necessary under the two circumstances a when the added disturbances have greatly sharp changes parameter tuning may not work well b when the added disturbances only have one or few sudden changes it is not worth to tune k p 2 and k d 2 small during the whole control process it should be noted that the aforementioned solutions will attenuate the control variables and thus weaken the controller performance i e will reduce the convergence rate and the tracking accuracy of the proposed scheme as a result trade offs should be considered among different design requirements to verify the effectiveness of the two solutions simulations with square trajectory tracking were designed because the input spiking phenomenon in scenario 1 was the most severe among three scenarios the three comparative simulations were designed as follows a original setting k p 2 d i a g 30 30 30 and k d 2 d i a g 20 20 20 b parameter tuning k p 2 d i a g 10 10 10 and k d 2 d i a g 10 10 10 c actuator constraint parameter tuning max δ τ i min δ τ i 200 n i 1 2 and max δ τ 3 min δ τ 3 200 n m and k p 2 d i a g 10 10 10 k d 2 d i a g 10 10 10 the simulation results are shown in fig 7 as shown in fig 7 c d the input spiking phenomenon was greatly restrained by parameter tuning and adding actuator constraint specifically the amplitudes of spikes were greatly reduced and the input signals changed slowly and as shown in fig 7 a b the proposed sleso mfac scheme can still guarantee tracking to the square trajectory under the two solutions however the convergence rate and the tracking accuracy were reduced than the original setting therefore trade offs should be made among different design considerations remark 8 discussions on model based and data driven disturbance observes the current disturbance estimation strategies can be divided into two categories model based design and data driven design a recent overview on disturbance observers is given in chen et al 2016 the bulk of researches on disturbance estimation focus on model based design in which the exactly dynamic models or structures are required as a priori such as fixed time disturbance observer ni et al 2017 sliding mode observer yin et al 2017 etc this feature makes model based disturbance observers impractical for time varying systems with complicated modeling process and parameter identification process like the auv system from this perspective the data driven disturbance observers are more attractive options for the system whose exactly dynamic model is difficult to get however the data driven disturbance observers also have limitations on the one hand it is still difficult for the data driven control design and parameter tuning with black box type models when no dynamic model information is available on the other hand when the data driven disturbance observers response to the measurement noise the actuators may suffer from fluctuating and wear damaging sun et al 2020 in these respects the model based disturbance observers are more attractive than the data driven design what is more using precisely known model information in disturbance observer design can improve disturbance estimation performances sun et al 2019 therefore for the system whose precise dynamic model is easily accessible the model based disturbance observers are recommended how to merge the advantages and overcome the shortcomings of each paradigm is a significant problem to research however it is still an open issue in the literature to handle the first limitation of the data driven design the structure of dynamic model or physical intuition to the actual systems can be used in controller design and parameter tuning as aforementioned in this paper on the other hand to cope with the second limitation of the data driven eso inspired by sun et al 2016 a hybrid data driven and model assisted control strategy is proposed in li et al 2019 this strategy can reduce the sensor noise effect on the actuator by incorporating some dynamic model information into traditional data driven eso design the incorporated model information can help to reduce the estimation burden of the data driven eso thus lead to a sensitivity reduction to the measurement noise to some extent sun et al 2020 future work will focus on improving the sleso mfac design by combining the merits of model based and data driven ideas 5 conclusions in this paper a sleso mfac scheme was proposed for realizing a precise trajectory tracking control of an auv under parameter perturbations and external disturbances this scheme was an attractive option from an implementation point of view on the one hand it did not require any model parameters and only relied on the online i o data by the mfac on the other hand compared with the typical mfac scheme it can achieve excellent tracking performances with high control accuracy and strong robustness based on the strategy of compensated approximate model by the sleso specifically the detailed design of mfac for auv systems with rotation was proposed for the first time this contained the design within a two loop controller architecture the transformation of dld model using the structure of dynamic model of auv and a straightforward initial value setting method besides a data driven sleso was derived to estimate the incremental total disturbance term which was further compensated in the control input in real time stability analyses showed that the sleso mfac based inner closed loop control system was bibo stable comparative simulations were conducted using a falcon dynamic model with identified parameters and results showed the effectiveness and robustness of the proposed control scheme moreover a comprehensive discussions and future work are also presented at last it should also be pointed out that the proposed scheme can be extended to 6 dof auvs conveniently as well as other robotic systems credit authorship contribution statement xiaohan li conceptualization methodology software validation formal analysis investigation writing original draft chao ren conceptualization writing review editing shugen ma supervision writing review editing xinshan zhu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national key r d program of china no 2017yfc0306200 and the tianjin natural science foundation no 18jcqnjc04600 appendix a proof of theorem 1 let φ ˆ c k ϕ ˆ 1 t k ϕ ˆ 2 t k ϕ ˆ 3 t k t ϕ ˆ i k ϕ ˆ i 1 k ϕ ˆ i 2 k ϕ ˆ i 3 k f k f 1 k f 2 k f 3 k t δ v k δ v 1 k δ v 2 k δ v 3 k t i 1 2 3 eq 12 can be rewritten as a 1 ϕ ˆ i k ϕ ˆ i k 1 η δ v i k ϕ ˆ i k 1 δ τ k 1 f ˆ i k 1 δ τ t k 1 μ δ τ k 1 2 where δ v i k ϕ i k 1 δ τ k 1 f i k 1 i 1 2 3 let ϕ i k ϕ ˆ i k ϕ i k f i k f ˆ i k f i k by subtracting ϕ i k from both sides of a 1 we have a 2 ϕ i k ϕ i k 1 ϕ i k 1 ϕ i k η ϕ i k 1 δ τ k 1 f i k 1 δ τ t k 1 μ δ τ k 1 2 since φ c k b we have ϕ i k 1 ϕ i k 2 b taking norm on the both sides of a 2 yields a 3 ϕ i k ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 η f i k 1 δ τ t k 1 μ δ τ k 1 2 ϕ i k 1 ϕ i k ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 η f i k 1 δ τ t k 1 μ δ τ k 1 2 2 b according to theorem 2 e o 2 i is bounded i e f i k 1 is bounded whose detailed proof is in the next part assume that δ τ k 1 is bounded when the sample time is short enough then we have a 4 η f i k 1 δ τ t k 1 μ δ τ k 1 2 2 b c a 5 ϕ i k ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 c squaring the first term on the right hand side of a 5 we have a 6 ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 2 η ϕ i k 1 δ τ k 1 2 μ δ τ k 1 2 η δ τ k 1 2 μ δ τ k 1 2 2 ϕ i k 1 2 there exist 0 η 2 and μ 0 such that η δ τ k 1 2 μ δ τ k 1 2 2 0 let 0 d 1 we have a 7 ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 2 d ϕ i k 1 note that we only need the existence of constant d instead of its exact value substituting a 7 into a 5 we have a 8 ϕ i k d ϕ i k 1 c d k 1 ϕ i 1 c 1 d k 1 1 d then ϕ i k is bounded from a 8 furthermore ϕ ˆ i k and φ ˆ c k are bounded since φ c k b appendix b proof of theorem 2 for the sake of simplicity the convergence of the proposed sleso is derived for each channel let e o j k e o 1 j k e o 2 j k t j 1 2 3 represent x y ψ channel respectively according to 18 the observer error dynamics of sleso for each channel can be rewritten as follows b 1 e o j k 1 a j e o j k e 1 ϕ j k δ τ k e 2 δ f j k 1 where a j 1 t β 1 j 1 0 1 t β 2 j e 1 1 0 e 2 0 1 then the nominal system of b 1 is obtained as follows b 2 e o j k 1 a j e o j k only when all the characteristic roots of a j are distributed in the unit circle will the designed sleso be stable the characteristic polynomial of a j is derived as follows b 3 z i a j z 1 t β 1 j 1 0 z 1 t β 2 j z 2 t β 1 j t β 2 j 2 z t 2 β 1 j β 2 j t β 1 j t β 2 j 1 substituting z w 1 w 1 into b 3 for bilinear transformation the characteristic polynomial in w domain is as follows b 4 t 2 β 1 j β 2 j w 2 2 t β 1 j 2 t β 2 j 2 t 2 β 1 j β 2 j w t 2 β 1 j β 2 j 2 t β 1 j 2 t β 2 j 4 0 according to the routh criterion the conditions for a j being stable are b 5 t 2 β 1 j β 2 j 0 2 t β 1 j 2 t β 2 j 2 t 2 β 1 j β 2 j 0 t 2 β 1 j β 2 j 2 t β 1 j 2 t β 2 j 4 0 from the design of observer gains β 1 j β 2 j ω o 0 substituting it into b 5 we have b 6 t 2 ω o 2 0 t ω o 2 t ω o 2 2 0 therefore when t ω o 2 a j will be stable and the system will be globally asymptotically stable because of the incremental total disturbance and pjm estimation error the steady state error exists then from b 1 when the system achieves a steady state it satisfies b 7 lim k e o 1 j k e o 2 j k ϕ j k δ τ k t ω o lim k e o 2 j k δ f j k 1 t ω o from assumption 1 δ f k 1 is bounded and δ f j c j the steady state error can be derived as b 8 e o 1 j k c j t 2 ω o 2 ϕ j k δ τ k t ω o σ 1 j e o 2 j k c j t ω o σ 2 j j 1 2 3 then e o i k i 1 2 is bounded at last f ˆ k is also bounded since f k is bounded from assumption 1 appendix c proof of theorem 3 assume that v d k 1 v d k when the sample time is short enough based on the equivalent dld model 10 we have c 1 e v k 1 e v k φ c k δ τ k f k substituting the mfac 23 into c 1 we have c 2 e v k 1 i ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k p 2 k d 2 t e v k ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k d 2 t e v k 1 ρ φ c k φ ˆ t c k λ φ ˆ c k 2 f ˆ k f k by referring to the detailed process of proof in hou and jin 2011 we can draw the following similar conclusion there exists ε 1 0 such that c 3 i ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k p 2 k d 2 t v i ρ k p 2 k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 v s i ρ k p 2 k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 ε 1 1 ρ k p 2 k d 2 t m 1 ε 1 d 1 1 2 where s a is the spectral radius of matrix a and 0 ρ 1 inspired by hou and jin 2011 the following conclusion can be drawn there exists ε 2 0 such that c 4 ρ φ c k φ ˆ t c k λ φ ˆ c k 2 v s ρ φ c k φ ˆ t c k λ φ ˆ c k 2 ε 2 ρ m 2 ε 2 d 2 1 2 due to the space limitation the detailed process of proof is omitted from c 4 the following conclusion can be deduced similarly there exists ε 3 0 such that c 5 ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k d 2 t v ρ k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 v s ρ k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 ε 3 ρ k d 2 t m 2 ε 3 d 3 1 2 assume that there exists δ 0 such that e v k v e v k 1 v δ when the sample time is short enough according to assumption 1 and theorem 2 f k and f ˆ k are bounded i e there exists d 4 0 d 5 0 such that f ˆ k v d 4 f k v d 5 let d 6 2 max d 1 d 3 1 2 i e d 6 1 and a d 6 2 δ d 2 d 4 d 5 from c 2 we can derive c 6 e v k 1 v d 1 e v k v d 3 e v k 1 v d 2 f ˆ k v f k v d 6 2 e v k v e v k v δ d 2 d 4 d 5 d 6 e v k v d 6 2 δ d 2 d 4 d 5 d 6 e v k v a d 6 k e v 1 v a 1 d 6 k 1 d 6 thus the conclusion 1 of theorem 3 is the direct result of c 6 since v d k and e v k are all bounded then v k also will be bounded thus the conclusion 2 of theorem 3 is proved 
21415,this paper investigates the problem of precise trajectory tracking control of an autonomous underwater vehicle auv under parameter perturbations and external disturbances to design a data driven control scheme with high tracking accuracy and strong robustness a compensated model free adaptive control mfac scheme is proposed by combining an extended state observer eso specifically a data driven structure improved linear eso sleso is derived to online estimate the model approximation error generated by pseudo jacobian matrix estimation in the typical mfac scheme another problem of the typical mfac is that it cannot be directly applied to robotic systems with rotation in the inertial frame to tackle this issue a two loop controller architecture is used to design the proposed sleso mfac scheme in addition the structure of the mathematical model of auvs and force analysis are used in mfac design for the first time thus providing a straightforward initial value setting method with explicit physical interpretation and helping to judge if the assumptions in the mfac scheme can be satisfied furthermore the stability analysis of the designed control system is given finally the robustness and effectiveness of the proposed sleso mfac scheme are substantiated via simulations and comparisons using a realistic dynamic model of the falcon auv abbreviations mfac model free adaptive control sleso structure improved linear extended state observer dld dynamic linearization data pjm pseudo jacobian matrix iae integral of absolute error mae maximum absolute error keywords data driven anti disturbance parameter perturbation model free adaptive control extended state observer autonomous underwater vehicle 1 introduction underwater robots especially autonomous underwater vehicles auvs have attracted considerable attention in marine research cui et al 2017 compared with human occupied vehicles and remotely operated vehicles auvs can complete tasks independently and flexibly with a wide scope of movement therefore they have been extensively applied in submarine geomorphology observation kamaev et al 2017 marine environment monitoring tonacci et al 2015 underwater rescue and detection cao et al 2020 etc to exploit the potential benefits provided by auvs high precision trajectory tracking control has become a crucial issue gan et al 2017 many researches have been conducted on the trajectory tracking control of auvs for decades however up to now there are still severe challenges in practice 1 an auv is a complex system with strong coupling and high nonlinearity and it is difficult to obtain an accurate dynamic model for the control system design gan et al 2017 2 the unknown parametric perturbations always exist in auv dynamic modeling especially when dealing with the time varying hydrodynamic coefficients during auvs executing tasks different altitude temperature gradients and densities of water will cause the variation of hydrodynamic coefficients 3 auvs inevitably suffer from unknown external environmental disturbances such as ocean currents waves wind and tides accordingly the exact dynamic model of auv may not be known a priori therefore the control methods relying on accurate dynamic models such as state feedback linearization kamarlouei and ghassemi 2016 and linear nonlinear model predictive control li and yan 2016 shen et al 2016a zhang et al 2019 are difficult to implement in practice as a result the auv control system is required to have a robust capability of online self adjusting and adapting to a time varying environment to address the challenges of parametric perturbations and unknown external disturbances a number of control methods have been introduced in recent years such as adaptive control robust control and disturbance observer based control specifically adaptive control fossen and sagatun 1991 sarhadi et al 2017 has been extensively used for auv systems because it does not require an accurate mathematical model also owing to its insensitivity to parametric uncertainty robust control especially sliding mode control zhang et al 2018 yan et al 2019 and back stepping control cho et al 2020 have been widely used as well another effective solution is disturbance observers including sliding mode observer na et al 2013 high gain observer fernandes et al 2015 finite time disturbance observer ni et al 2017 yan and yu 2018 and extended state observer eso yang et al 2019 han 2009 ren et al 2019 guerrero et al 2020 nevertheless the above studies belong to model based control it is obvious that the dynamic modeling of auvs and the parameter identification process are complicated time consuming and of high cost especially the hydrodynamic coefficients are usually calculated using computational fluid dynamics methods or towing tank experimental data analysis cui et al 2017 this motivates us to develop data driven control schemes for auv trajectory tracking up to now many data driven control approaches have been proposed such as model free adaptive control mfac hou and jin 2011 neural network nn based control gao et al 2017 duan et al 2020 virtual reference feedback tuning vrft campi and savaresi 2006 and unfalsified control uc van helvoort et al 2007 in particular mfac is proposed by hou based on dynamic linearization technique hou and jin 2011 in mfac scheme equivalent dynamic linearization data models are built to replace the mathematical models of the controlled plants only using the real time measurement i o data it is an attractive option for auv systems from an implementation point of view note that the training process and offline learning are impractical and expensive for uncertain auv systems therefore many data driven schemes e g nn based control which require training processes with rather rich offline input output i o data of the open loop system are difficult to apply in practice in contrary mfac is an online self adjusting scheme with lower cost and real time control which does not require any external testing signals or training process moreover it can be easily implemented with small computational burden as a result mfac is more suitable for auvs in practice in addition the convergence and stability of mfac for discrete time nonlinear systems are guaranteed which is a highlighted feature compared with other data driven control approaches hou and jin 2011 such as vrft and uc unfortunately the typical mfac focuses on building an approximate data model by pseudo jacobian matrix pjm estimation based on the online i o data in other words the model approximation error i e error between the real system and the dynamic data model generated by pjm estimation always exists especially when the system is subjected to sudden changes in the system state stochastic external disturbances and parameter perturbations the corresponding error will be even larger seriously deteriorating the control performance in the typical mfac scheme how to design a mfac scheme with high tracking accuracy and strong robustness however is still an open issue in the literature to tackle the above issue disturbance observers can be employed specifically the model approximation error can be estimated by the observer in real time and then compensated in control input in particular the eso proposed by han han 2009 is attractive for auv systems in which the combination of system uncertainties and external disturbances is considered as the total disturbances and further regarded as a new state owing to its simple and decoupling design eso has been widely applied to various practical systems e g robot control ren et al 2019 motor control zhou et al 2020 and energy control liu et al 2016 in recent years some works applied typical mfac to robotic systems such as li et al 2019 in which mfac is used in auv heading control however another two major limitations still remain in its application to complicated robotic systems on the one hand to the best of authors knowledge mfac has not been applied to multiple input multiple output mimo coupling robotic systems with rotation in the literature it should be noted that a common assumption in the mfac scheme i e the unchanged sign of all the elements of pjm cannot be satisfied for robotic systems with rotation because of the rotation matrix in other words the typical mfac cannot be directly applied to robotic systems with rotation in the inertial frame on the other hand the empirical initial value setting in pjm estimation is difficult yet plays a crucial role in implementation of the mfac scheme to be specific the control system will be unstable if the initial value is not properly set however the initial value setting method in the mfac scheme has not been discussed in the literature in this paper a structure improved linear extended state observer sleso based mfac scheme is proposed for the trajectory tracking control of auvs with parameter perturbations and stochastic external disturbances the proposed sleso mfac scheme is a data driven and anti disturbance control framework to ensure that the mfac scheme can be applied to auv systems with rotation a two loop controller architecture is employed and then the sleso mfac scheme is designed in the non inertial frame i e the body fixed frame attached to the center of gravity of the auv in this paper this design method can avoid the influence of the rotation matrix of the auv on pjm estimation within this architecture a proportional differential pd kinematic controller is designed in the outer loop to generate desired velocity profiles and the proposed scheme is designed as the inner loop controller the design process of the sleso mfac scheme is summarized as follows firstly the dynamic model of auv in the body fixed frame is transformed into a dynamic linearization data dld model with incremental total disturbance term by using the structure of auv dynamic model the intuitive correspondence between system mathematical model and data driven model can be obtained it can provide guidance for crucial initial value setting in mfac scheme and it can help to judge if the assumptions in mfac scheme can be satisfied for auv systems secondly the pjm of the dld model is estimated by the modified projection algorithm using the online i o data of the auv system in particular the straightforward initial value setting method of pjm estimation is proposed for the first time moreover the setting guidance of parameters in the reset algorithm of pjm estimation is also given to the best of authors knowledge however parameter setting is still a challenge in existing literature of mfac scheme thirdly to estimate the incremental total disturbance term of the dld model a data driven sleso is derived by improving the structure of traditional linear eso tleso it can accelerate the disturbance estimation convergence with much smaller gains then the detailed design of the observer gain matrix of sleso is given at last a mfac method is designed to achieve velocity tracking and compensate the disturbances estimated by sleso then the stability analysis of the pjm estimation the stability analysis of sleso and that of the inner closed loop control system are presented finally comparative simulations with the typical mfac using a realistic falcon dynamic model with three different scenarios are conducted the effectiveness and robustness of the proposed sleso mfac scheme towards stochastic disturbances hydrodynamic uncertainties sudden changes of the system state and measurement noise are validated in simulations moreover a comprehensive discussions are also presented related to the limitations and solutions of the proposed scheme analyses and solutions of control input spikes comparisons and combinations of model based and data driven disturbance observes etc the main contributions of this paper are threefold 1 a sleso mfac scheme is proposed by introducing a data driven sleso to online estimate the model approximation error generated by pjm estimation compared with the typical mfac the proposed control scheme can achieve higher tracking accuracy and stronger robustness towards disturbances and sudden changes in system dynamics in addition the number of reset times in pjm estimation is greatly reduced in the proposed control scheme 2 utilizing the two loop controller architecture this paper provides design guidance of mfac scheme for all robotic systems with rotation for the first time it solves the problem that the typical mfac cannot be directly applied to robotic systems with rotation in the inertial frame due to an important assumption in pjm estimation is unsatisfied 3 a straightforward initial value setting method of pjm estimation for auv systems is first proposed with explicit physical interpretation specifically the structure of mathematical model of auv and force analysis are used for the initial value setting in this paper note that the initial value setting is crucial in mfac scheme since the control system will be unstable if the initial value is not properly set however the issue has not been discussed in the literature in addition the usage of the structural information of dynamic model can help to judge if the assumptions in mfac scheme can be satisfied for auv systems the remainder of this paper is organized as follows section 2 presents the dynamic models of auv in both body fixed and earth fixed inertial frames and formulates the problem in section 3 the detailed design procedure of the sleso mfac scheme and the stability analysis are given in section 4 the implementation details comparison design simulation results as well as comprehensive discussions are introduced finally conclusions are drawn in section 5 2 problem formulation auvs usually move with 6 degrees of freedoms dofs in a three dimensional space to simplify the controller design and analysis this paper focuses on the horizontal plane motion of an auv with 3 dofs two coordinate frames are introduced an earth fixed inertial frame e and a body fixed frame b attached to the center of gravity of the auv as shown in fig 1 the nomenclature is defined in table 1 the kinematic equation of the auv that translates the body fixed velocity into the earth fixed velocity can be written as follows 1 η j η v where j η is a coordinate transformation matrix i e rotation matrix given by j η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 for an auv the well established 6 dof dynamic model in the body fixed frame is as follows fossen 2002 2 m v c v v d v v g η d η v τ where m denotes the inertia matrix including added mass c v represents the state dependent matrix of coriolis and centripetal terms d v is the hydrodynamic damping and lift matrix g η represents the vector of gravitational forces and moments respectively and d η v is the model s uncertainty vector which is induced by external oceanic disturbances and unmodeled hydrodynamics in the horizontal plane three assumptions are introduced shen et al 2016b 1 the auv s structure is symmetric 2 mass distribution is homogeneous 3 the pitch and roll motions are neglected under these assumptions the dynamic model in the body fixed frame in the horizontal plane is simplified to a 3 dof nonlinear dynamic equation as follows 3 m v h v v d η v τ where m m r b m a d d m r b denotes the rigid body mass matrix and m a d d represents the added mass matrix h v c v d v the system parameter matrices in 3 are simplified as shen et al 2016b m r b m 0 0 0 m 0 0 0 i z m a d d x u 0 0 0 y v 0 0 0 n r c v 0 0 m y v v 0 0 m x u u m y v v m x u u 0 d v x u d u u 0 0 0 y v d v v 0 0 0 n r d r r the dynamic model in the earth fixed inertial frame can be obtained by combining 1 and 3 4 m η η η h η η η η d η η τ where m η η m j 1 η h η η η c η η j 1 η d η η j 1 η m η η j j 1 m η η m x u cos ψ m x u sin ψ 0 m y v sin ψ m y v cos ψ 0 0 0 i z n r h η η h 11 h 12 h 13 h 21 h 22 h 23 h 31 h 32 h 33 where h 11 x u d u cos ψ x sin ψ y cos ψ m x u sin ψ ψ h 12 x u d u cos ψ x sin ψ y sin ψ m y v cos ψ ψ h 13 m y v sin ψ x cos ψ y h 21 y v d v sin ψ x cos ψ y sin ψ m x u cos ψ ψ h 22 y v d v sin ψ x cos ψ y cos ψ m y v sin ψ ψ h 23 m x u cos ψ x sin ψ y h 31 m y v sin ψ x cos ψ y cos ψ m x u cos ψ x sin ψ y sin ψ h 32 m y v sin ψ x cos ψ y sin ψ m x u cos ψ x sin ψ y cos ψ h 33 n r d r ψ it can be seen that the trajectory tracking control of auv is challenging due to the nonlinearity and coupled dynamics in model 4 moreover in practical applications it is impossible to obtain the accurate hydrodynamic coefficients or disturbances therefore it is necessary to develop a model free controller with online model estimation and real time disturbance compensation the control objective of this paper is to develop a sleso mfac scheme for precise trajectory tracking control of auvs under unknown external disturbances and time varying hydrodynamic parameters here position η and the velocity of the auv in the body fixed frame v can be measured in real time by sensors see remark 5 while all system parameters are unknown then a proper control input τ t can be designed using the online i o data to make the auv achieve precisely tracking of the reference trajectory η d t i e the trajectory tracking error lim t e t lim t η d t η t 0 3 controller design and analysis in this section the proposed sleso mfac scheme and stability analysis are presented the sleso mfac scheme is shown in fig 2 which consists of a data model parameter estimator i e pjm estimator an observer based total disturbance estimator i e sleso and a controller with disturbance compensation i e mfac to apply the sleso mfac scheme to auv systems with rotation a two loop controller architecture is employed in the outer loop a pd kinematic controller is designed to generate desired velocity profiles to minimize the accumulated error between the real and desired trajectories in the inner loop a controller based on sleso mfac scheme is designed to ensure that the reference velocity generated by the outer loop controller can be accurately tracked by the auv the block diagram of the proposed controller design is shown in fig 3 3 1 outer loop controller from the kinematic equation 1 the nominal velocity v d of the auv in the body fixed frame for a desired trajectory η d t x d t y d t ψ d t t is given as follows 5 v d k 1 j t ψ d k 1 η d k 1 then a pd feedback control law is designed to stabilize the tracking error the desired velocity command to the inner loop is given by 6 v d k 1 v d k 1 j t ψ d k 1 k p 1 e η k k d 1 e η k where v d represents the desired velocity of the auv in the body fixed frame e η k η d k 1 η k e η k η d k 1 j ψ k v k k p 1 d i a g k p 1 k p 1 k p 1 k d 1 d i a g k d 1 k d 1 k d 1 3 2 dynamics discretization and transformation in this subsection the continuous time dynamic model 3 is transformed into a discrete time one at first which is further transformed into a dld model because v k v k and η k are fixed matrices at the k th moment h v and d η v are also fixed simultaneously the sampling time for the auv control is selected as t assume that v t v k t v k τ t τ k t τ k k t t k 1 t therefore the dynamics of the auv system can be approximated by the following form 7 m v k h v k v k d k τ k as m is a symmetric positive definite matrix and v k v k 1 v k t for the sample period of t the k th moment discrete time form of the auv dynamic model is approximated as follows 8 v k 1 t m 1 τ k i t m 1 h v k v k t m 1 d k from 8 we have δ v k 1 v k 1 v k t m 1 δ τ k i t m 1 h v k v k i t m 1 h v k 1 v k 1 t m 1 d k d k 1 let δ ζ k i t m 1 h v k v k i t m 1 h v k 1 v k 1 δ d 1 k t m 1 d k d k 1 t m 1 δ d k f k δ ζ k δ d 1 k the discrete time dynamic model can be transformed into 9 δ v k 1 t m 1 δ τ k f k it can be seen that the partial derivatives of the right hand side of eq 8 with respect to control inputs τ k are continuous and the system is generalized lipschitz for system 8 with δ τ k 0 for each fixed k there must exist pjm φ c k such that 8 can be transformed into the following equivalent dld model hou and jin 2011 10 δ v k 1 φ c k δ τ k f k where φ c k ϕ 11 k ϕ 12 k ϕ 13 k ϕ 21 k ϕ 22 k ϕ 23 k ϕ 31 k ϕ 32 k ϕ 33 k and φ c k b f k is defined as the variation of total disturbance i e the incremental total disturbance term assumption 1 the incremental total disturbance term f k is assumed to be bounded δ f k 1 which is defined as the variation of f k is also assumed to be bounded when the sample time is short enough remark 1 specifically the incremental total disturbance term f k compensates the error between the real auv system and the dld model moreover f k represents the variation of total disturbance i e the variation of disturbance related term δ d 1 k and hydrodynamics related term δ ζ k between the k 1 th and k th moments in addition the assumption above is reasonable and acceptable from a practical point of view 3 3 pjm estimation by modified projection algorithm in this subsection the modified projection algorithm is employed to estimate pjm φ c k in the equivalent dld model 10 based on the system s i o data besides the crucial initial value setting method for pjm estimation and the setting guidance for parameters in the reset algorithm are proposed assumption 2 pjm φ c k is a diagonally dominant matrix in the following sense i e ϕ i j k b 1 b 2 ϕ i i k α b 2 i 1 2 3 j 1 2 3 i j α 1 b 2 2 b 1 2 α 1 and the sign of all the elements of φ c k is unchanged hou and jin 2011 remark 2 according to 9 and 10 it is obvious that φ c k is approximately equal to t m 1 from the auv dynamic model in the body fixed frame 3 t m 1 is a diagonal constant matrix therefore the assumptions of diagonally dominant matrix and the unchanged sign of all the elements of φ c k in the mfac scheme can be satisfied on the other hand the initial value of pjm estimation φ ˆ c 1 can be set as a diagonal matrix note that by using the structural information of the auv dynamic model the intuitive correspondence between the system s mathematical model and data driven model can be obtained it is helpful in judging whether mfac can be applied to auv systems i e whether the assumptions in the mfac scheme can be satisfied for auv systems in addition it can facilitate the mfac design and provide guidance for initial value setting remark 3 assumption 2 is a common assumption in the mfac scheme the unchanged sign of all elements of φ c k is similar to the control direction in model based control methods hou and jin 2011 it can be seen that φ c k describes a direct mapping from the variation of control input to the variation of system output in other words for an auv if the controller is designed in the earth fixed inertial frame then φ c k describes a mapping from δ τ k to δ η k 1 in this case according to the dynamic model in the earth fixed inertial frame 4 the sign of elements in φ c k will be changed due to j ψ if the auv moves with rotation i e the assumption cannot be satisfied in the earth fixed inertial frame similarly for all robotic systems with rotation the mfac scheme should be designed in a non inertial frame e g the body fixed frame in this paper to avoid influences of the rotation matrix on pjm estimation besides compared with the dynamic model in the body fixed frame 3 the nonlinearity and coupled dynamics are much stronger in the dynamic model in the earth fixed inertial frame 4 thereby increasing the difficulty in the controller design as a result it is necessary to design the mfac scheme for auv in the body fixed frame here a two loop controller architecture is recommended according to the dld model 10 a cost function of pjm estimation is given as follows 11 j φ c k δ v k φ c k δ τ k 1 f k 1 2 μ φ c k φ ˆ c k 1 2 where μ 0 is a penalty factor on δ φ ˆ c k here φ ˆ c k is the estimation of φ c k by applying the first order taylor expansion to φ c k δ τ k 1 in φ c φ ˆ c k 1 and minimizing the cost function 11 the pjm estimation can be obtained using the modified projection algorithm 12 φ ˆ c k φ ˆ c k 1 η δ v k φ ˆ c k 1 δ τ k 1 f ˆ k 1 δ τ t k 1 μ δ τ k 1 2 where η 0 2 is a step size constant here f ˆ k 1 is defined as the estimation of the incremental total disturbance term f k 1 the reset algorithm of φ ˆ c is as follows 13 ϕ ˆ i i k ϕ ˆ i i 1 if ϕ ˆ i i k b 2 or ϕ ˆ i i k α b 2 or s i g n ϕ ˆ i i k s i g n ϕ ˆ i i 1 ϕ ˆ i j k ϕ ˆ i j 1 if ϕ ˆ i j k b 1 or s i g n ϕ ˆ i j k s i g n ϕ ˆ i j 1 i j where ϕ ˆ i j 1 is the initial value of ϕ ˆ i j k i 1 2 3 j 1 2 3 note that the reset algorithm 13 can be used to improve the pjm estimation stability when tracking the time varying trajectory in particular when the state of auv suddenly changes or large disturbances and uncertainties occur in the auv system the robustness of the pjm estimation will be guaranteed by using the reset algorithm furthermore the straightforward setting method of φ ˆ c 1 and the setting guidance for parameters in the reset algorithm i e α b 1 b 2 are proposed for the first time for φ ˆ c 1 setting it should be noted that the control performance of the mfac scheme is quite sensitive to φ ˆ c 1 especially the sign of each element in φ ˆ c 1 in particular the control system will be unstable if φ ˆ c 1 is not properly set therefore a straightforward setting method for φ ˆ c 1 with physical interpretation is crucial according to remark 2 φ ˆ c 1 can be set as a diagonal matrix using the structure of mathematical model of auv in addition from remark 3 φ c k describes a direct mapping from the variation of thrust force δ τ k to the variation of velocity δ v k 1 for an auv in the body fixed frame according to the force analysis of the auv τ f u f v m i t and v u v r t are in the same direction in other words τ has positive effects on v therefore φ ˆ c 1 can be set as a positive definite diagonal matrix the setting of α b 1 and b 2 determines the range of pjm estimation therefore they are also important to the performance of pjm estimation it is obvious that the decrease in the range of pjm estimation especially φ ˆ i i k will improve the robustness and adaptation of the algorithm with respect to sudden changes in the system however if the range of φ ˆ i i k is selected to be very small then the number of reset times of φ ˆ c will increase greatly deteriorating the tracking performances as a result there exist trade offs among different design considerations 3 4 disturbance estimation by sleso in this subsection a data driven second order sleso is derived to estimate the incremental total disturbance term f k in the dld model 10 first a data driven tleso is designed then a data driven sleso is developed to improve the observation performance of tleso the state variables are defined as z 1 k v k z 2 k f k where z 2 k r 3 is unknown but bounded the system dld model 10 can be rewritten in the following state space form 14 z 1 k 1 z 1 k φ c k δ τ k z 2 k z 2 k 1 z 2 k f k 1 f k define z ˆ i k as the estimation of z i k and e o i k z i k z ˆ i k i 1 2 as estimation errors then the data driven tleso is constructed as follows 15 z ˆ 1 k 1 z ˆ 1 k φ ˆ c k δ τ k z ˆ 2 k t β 01 e o 1 k z ˆ 2 k 1 z ˆ 2 k t β 02 e o 1 k where β 0 i r 3 3 are the gain matrices of tleso i 1 2 which are diagonal positive definite here ω o 0 is defined as the observer bandwidth the observer gains are usually selected as β 01 2 ω o 0 0 0 2 ω o 0 0 0 2 ω o β 02 ω o 2 0 0 0 ω o 2 0 0 0 ω o 2 it is obvious that only the velocity estimation error e o 1 k is used in estimating all the state variables as a result the tleso 15 completes the tracking of z 1 first and then z 2 i e the incremental total disturbance sequentially in this case when e o 1 k becomes small high gains will be necessary to achieve a good estimation of z 2 i e the value of β 02 should be selected to be large however this limitation will aggravate the initial peaking phenomenon and phase lag seriously deteriorating the control performances and even damaging the robot to cope with this problem and improve the convergence rate and estimation performances motivated by sun and zhang 2017 the structure of tleso can be further modified as sleso 16 z ˆ 1 k 1 z ˆ 1 k φ ˆ c k δ τ k z ˆ 2 k t β 1 e o 1 k z ˆ 2 k 1 z ˆ 2 k t β 2 e o 2 k in the estimation of z 2 k in sleso 16 the disturbance estimation error e o 2 k is used instead of e o 1 k according to 14 and 16 e o 2 k can be derived as follows 17 e o 2 k z 2 k z ˆ 2 k e o 1 k 1 e o 1 k t β 1 e o 1 k let the pjm estimation error φ c k φ c k φ ˆ c k then the observer error dynamics can be written in the state space as follows 18 δ e o 1 k 1 t β 1 e o 1 k e o 2 k t φ c k δ τ k t δ e o 2 k 1 t β 2 e o 2 k δ f k 1 t let e o k e o 1 k e o 2 k t then 18 is transformed into 19 δ e o k 1 t a e e o k e 1 φ c k δ τ k t e 2 δ f k 1 t where a e β 1 i t 0 β 2 e 1 i 0 e 2 0 i i is an identity matrix and 0 is a zero matrix respectively the characteristic polynomial of the observer error dynamics is as follows 20 p λ λ 2 i β 1 β 2 λ i β 1 β 2 i for the sake of simplicity all poles of sleso in three channels are placed at the same position i e ω o thus the characteristic polynomial 20 can be rewritten as follows p λ β 1 λ i β 2 λ i λ ω o 2 i toward this end the observer gains are obtained as follows β 1 ω o 0 0 0 ω o 0 0 0 ω o β 2 ω o 0 0 0 ω o 0 0 0 ω o note ω o is the only parameter to be tuned in the sleso and t ω o 2 should be satisfied to guarantee the observer convergence then f ˆ k z ˆ 2 k remark 4 compared with the tleso design 15 e o 2 k is used to estimate f k in sleso 16 as a result the gain in sleso i e β 2 can be smaller than that in tleso i e β 02 therefore the peaking phenomenon due to high gains of tleso is alleviated in sleso besides compared with tleso sleso can greatly reduce the phase lag while improving the convergence rate and estimation accuracy of incremental total disturbance f k 3 5 mfac algorithm in this subsection a mfac method is designed to achieve velocity tracking and compensate the incremental total disturbance term estimated by the sleso consider the following criterion function of control input 21 j τ k v d k 1 v k 1 2 λ τ k τ k 1 2 where v d k 1 is the desired velocity generated by the outer loop controller and λ is a weighting constant by substituting 10 into the cost function 21 differentiating 21 with respect to τ k and then setting it as zero the control law is derived as follows 22 τ k τ k 1 ρ φ ˆ t c k v d k 1 v k f k λ φ ˆ c k 2 where ρ is a step size constant which is added to make 22 general and will be further used in the stability analysis it is obvious that λ is not only a penalty factor for δ τ k but also a constraint to suppress the φ c k from changing too quickly to improve the convergence rate and control performance pd feedback is introduced to the control law and f k estimated by f ˆ k in sleso is compensated in the controller finally the proposed mfac law can be designed as follows 23 τ k τ k 1 ρ φ ˆ t c k k p 2 e v k k d 2 δ e v k t f ˆ k λ φ ˆ c k 2 where the control error e v k v d k 1 v k k p 2 d i a g k p 2 k p 2 k p 2 k d 2 d i a g k d 2 k d 2 k d 2 the proposed sleso mfac scheme which consists of the control law 23 the observer 16 and the pjm estimation 12 is designed only using the online i o data of the auv meanwhile the incremental total disturbance term estimated by sleso is compensated in the control input in real time hence the proposed sleso mfac scheme is a typical data driven and anti disturbance control framework which can guarantee the tracking performance with high tracking accuracy and strong robustness 3 6 stability analysis in this subsection the convergences of the pjm estimation and sleso and that of the inner closed loop control system are analyzed respectively 3 6 1 convergence of the pjm estimation a typical stability analysis approach proposed by hou and jin 2011 is employed theorem 1 for an auv system satisfying assumptions 1 and 2 the pjm estimated value φ ˆ c k obtained by the modified projection algorithm and the estimation error φ c k are bounded the proof of theorem 1 is given in appendix a 3 6 2 convergence of sleso a typical stability analysis method for the discrete linear eso scheme proposed by shao et al 2008 is employed theorem 2 for an auv system satisfying assumptions 1 and 2 ω o 0 t ω o 2 there exist positive constants σ i j 0 such that the estimation errors e o i finally satisfy e o i j σ i j i 1 2 j 1 2 3 where σ i j and e o i j represent the j t h element of σ i and e o i respectively moreover the incremental total disturbance term f ˆ k estimated by sleso is bounded the proof of theorem 2 is given in appendix b 3 6 3 convergence of the inner closed loop inspired by hou and jin 2011 a typical stability analysis method for the mfac scheme is employed theorem 3 if an auv system satisfying assumptions 1 and 2 is controlled by the proposed control scheme then the following two properties will hold 1 the tracking error sequence is always bounded 2 the closed loop system is bounded input bounded output bibo stable the proof of theorem 3 is given in appendix c 4 simulation results in this section simulations were conducted to demonstrate the effectiveness and robustness of the proposed sleso mfac scheme for comparison simulations of mfac proposed by hou and jin 2011 were also given these two control algorithms were applied to the same experimental auv respectively three different scenarios with different trajectories were designed to verify the control performance of the proposed tracking controller 4 1 parameter selection to demonstrate the practical feasibility of the developed controller parameters were extracted from the realistic experimentally identified dynamic model of a falcon auv proctor 2014 which is an underwater vehicle developed at the university of victoria canada the detailed model parameters of auv are listed as follows shen et al 2016b mass m 116 kg moment of inertia in yaw i z 13 1 kg m 2 and hydrodynamic coefficients x u 167 6 y v 477 2 n r 15 9 x u 26 9 y v 35 8 n r 3 5 d u 241 3 d v 503 8 d r 76 9 the available control signals of actuators are considered to be f u m a x f u m i n 2000 n f v m a x f v m i n 2000 n m i m a x m i m i n 1000 n m besides the falcon auv is a redundant system equipped with four thrusts for the specific platform falcon the generalized forces and moments τ f u f v m i t can be calculated by the proposed control scheme then a thrust allocation strategy should be designed to calculate the required thruster actuation that is needed from each separate thruster in order to generate forces and moments equal to τ in recent years plenty of thrust allocation methods have been investigated in the literature johansen and fossen 2013 such as using the moore penrose pseudoinverse shen et al 2016b or a damped pseudoinverse hoffmann 2018 of the thruster configuration matrix multi objective optimization methods xia et al 2020 etc in this paper the thrust allocation strategy is not discussed in detail since it is beyond the scope of this paper in order to show the performance of the proposed control scheme in the presence of measurement noise an additive white gaussian noise with a signal to noise ratio snr of 90 db was added to each output data i e position η and velocity v using matlab function awgn furthermore to test the robustness of the proposed inner loop controller with respect to large measurement noise additive white gaussian noises with different snrs were added to the velocity measurements which will be described in detail in the design of scenario 1 for the purpose of comparison the simulations of mfac proposed by hou and jin 2011 were also conducted in which the dld model was 24 δ v k 1 φ c k δ τ k then the mfac algorithm can be summarized as 25 φ ˆ c k φ ˆ c k 1 η δ v k φ ˆ c k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 26 τ k τ k 1 ρ φ ˆ t c k k p 2 e v k k d 2 δ e v k t λ φ ˆ c k 2 the reset algorithm for φ ˆ c was the same as the proposed method for all simulations the controller parameters were identically set and all gains also remained unchanged the controller and observer parameters were set as follows and the sampling time t 0 01 s 1 in the outer loop controller k p 1 d i a g 1 1 1 and k d 1 d i a g 0 5 0 5 0 5 specifically to verify the control performance of the inner loop controller the gains in the outer loop controller were selected to be small in other words the control performance can be improved in practice when the pd gains were set larger 2 in the pjm estimation algorithm α 1 25 b 1 0 1 b 2 0 8 and μ 50 η 1 the initial value of the estimated pjm φ ˆ c was set as φ ˆ c 1 d i a g 1 1 1 3 in the mfac algorithm ρ 1 λ 0 5 k p 2 d i a g 30 30 30 and k d 2 d i a g 20 20 20 4 at last the observer bandwidth of the sleso was set as ω o 15 rad s to evaluate the control performance quantitatively the integral of absolute error iae and the maximum absolute error mae were used ren et al 2019 i e i a e x y m 0 t 1 e x e y d t i a e ψ r a d 0 t 1 e ψ d t m a e x y m max max e x max e y m a e ψ r a d max e ψ where t 1 represents the total tracking time obviously random quantities exist in all scenarios as a result repeated testing is necessary therefore for each scenario we have run the same tests for 5 times and the mean of iae the standard deviation of iae and the maximum of mae were used as performance metrics specifically m i a e x y represents the mean of i a e x y in 5 tests m i a e ψ represents the mean of i a e ψ s i a e x y represents the standard deviation of i a e x y s i a e ψ represents the standard deviation of i a e ψ m m a e x y represents the maximum of m a e x y m m a e ψ represents the maximum of m a e ψ respectively remark 5 implementation of the controller in practical application of the proposed control algorithm the position η x y ψ t and the velocity of auv in the body fixed frame v u v r t need to be measured in real time by sensors the visual positioning system vps can be used to measure the global frame coordinate x y of the auv and an inertial measurement unit imu can be used to calculate the absolute angle ψ of the auv in addition the velocity of auv in the body fixed frame v can be measured by the doppler velocity log dvl 4 2 scenarios design to test the effectiveness and robustness of the proposed sleso mfac scheme three different scenarios were considered scenario 1 nominal case and robustness tests towards sudden changes in the reference velocity and measurement noises under this scenario the auv was commanded to track a square trajectory the 40 s square reference trajectory was set as follows x d m 0 5 t 0 s t 10 s 5 10 s t 20 s 5 0 5 t 20 20 s t 30 s 0 30 s t 40 s y d m 0 0 s t 10 s 0 5 t 10 10 s t 20 s 5 20 s t 30 s 5 0 5 t 30 30 s t 40 s ψ d rad 0 0 s t 10 s π t 10 15 10 s t 20 s 2 π 3 20 s t 30 s 2 π 3 π 6 sin π t 30 6 30 s t 40 s to test the control performance in the nominal case the auv moved in the absence of external disturbances or parametric uncertainties note that the square trajectory has sudden changes in the reference velocity at each corner and the translational motion and direction suddenly change at the same time hence it can be used to test the effectiveness and robustness of the proposed control scheme furthermore the robustness tests under measurement noises were conducted to compare the robustness of the proposed sleso mfac scheme and mfac with respect to velocity measurement noise additive white gaussian noises with different snrs were added to velocity measurement i e v to mainly verify the control performance of the inner loop controller only slight noises were added to position measurement i e η in fact the velocity measurement noise is usually much larger in practice specifically 6 tests were conducted as listed in table 2 where s n r v represents the snr in velocity measurement and s n r η represents the snr in position measurement respectively in particular test 0 refers to the nominal performance of the auv in the absence of measurement noise under this scenario the initial position and yaw angle of the auv were set as x 0 y 0 ψ 0 t 0 0 0 t and the initial velocities were set as u 0 v 0 r 0 t 0 5 0 0 t scenario 2 robustness test towards external disturbances under this scenario the auv was commanded to track a lemniscate trajectory the 40 s lemniscate reference trajectory was set as follows x d m 2 sin π t 20 y d m 2 sin π t 10 ψ d rad π t 15 in the first 10 s the auv moved in the nominal case between 10 s and 40 s sudden persistent external disturbances d d u d v d r were added the external disturbances were set as different types in three channels to simulate wave and wind on the surface of water d u was set as low frequency stochastic disturbance the low frequency stochastic disturbance signals were generated by producing 50 random samples over 30 s one sample every 0 6 s using matlab function rand and linear interpolation was used to deduce the disturbance signal between two consecutive samples the range of stochastic disturbance was set from 400 n to 400 n d v was set as a high amplitude sinusoidal function d v 500 sin t n the range of control input is f v m a x f v m i n 2000 n and d r was set as a step function d r 400 n m under this scenario the initial position and yaw angle of the auv were set as x 0 y 0 ψ 0 t 0 0 0 t and the initial velocities were set as u 0 v 0 r 0 t 0 3 0 6 π 15 t scenario 3 robustness test towards parametric uncertainties under this scenario the auv was commanded to track a circle reference trajectory the 40 s circle reference trajectory was set as follows x d m 3 cos π t 20 y d m 3 sin π t 20 ψ d rad π t 10 to test the effectiveness of the controller and its robustness with respect to parametric uncertainties especially hydrodynamic parameters the internal parameters with 100 uncertainties were generated as follows δ m m δ i z i z δ x u x u s i n t π 6 δ y v y v s i n t π 5 δ n r n r s i n 0 8 t δ x u x u s i n 0 8 t π 4 δ y v y v s i n 0 8 t π 3 δ n r n r s i n 0 8 t δ d u d u s i n t π 6 δ d v d v s i n t π 5 δ d r d r s i n 0 8 t π 4 specifically δ represents uncertainties e g the hydrodynamic coefficient x u was set as x u δ x u in simulations it is obvious that all the corresponding hydrodynamic coefficients were time varying under this scenario the initial position and yaw angle of the auv were set as x 0 y 0 ψ 0 t 3 0 0 t and the initial velocities were set as u 0 v 0 r 0 t 0 0 5 π 10 t 4 3 simulation results and analysis 4 3 1 scenario 1 under scenario 1 5 repeated tests have been run and the corresponding performance indexes are listed in tables 3 and 4 pick one test arbitrarily and the simulation results are shown in fig 4 in the nominal case as shown in fig 4 a c the tracking performances have been greatly improved using the proposed sleso mfac scheme and the tracking errors were much smaller compared with those of mfac it can be observed from table 3 that miae siae and mmae of the proposed control scheme were much smaller compared with those of mfac this is because there are errors in the dld model estimated by the mfac scheme compared with the real system even if the auv moves in the absence of external disturbances or parametric uncertainties which will be estimated by sleso and then compensated for the robustness test towards sudden changes in the reference velocity attention should be paid to the corners of the square trajectory when the reference velocity suddenly changed the proposed control scheme can rapidly converge to a steady state with much smaller overshoot and a shorter settling time compared with mfac furthermore the results of robustness tests to velocity measurement noise are listed in table 4 with the snr of velocity measurement noise s n r v decreased the tracking accuracy in the mfac scheme was reduced greatly especially when s n r v was under 30 db however the robustness with respect to velocity measurement noise was greatly improved in the proposed control scheme therefore the proposed sleso mfac scheme has strong robustness towards sudden changes in the reference velocity and measurement noise and the scheme can achieve satisfying tracking performances in the nominal case with high convergence accuracy and fast convergence rate because it can compensate the model approximation error generated by pjm estimation 4 3 2 scenario 2 under scenario 2 5 repeated tests have been run and the corresponding performance indexes are listed in table 5 pick one test arbitrarily and the simulation results are shown in fig 5 as shown in fig 5 a c the tracking performances of the proposed control scheme significantly outperformed those of the mfac scheme on the one hand the tracking errors of the proposed control scheme were significantly smaller compared with those of mfac and accurately tracking can be maintained even in the presence of persistent and time varying external disturbances as can be also observed from table 5 on the other hand attention should be paid to t 10 s when three types of external disturbances i e low frequency stochastic disturbance high amplitude sinusoidal function and step function were suddenly added the proposed control scheme can rapidly converge to a steady state with much smaller overshoot and a shorter settling time compared with mfac scheme the observation performance of sleso in fig 5 e demonstrates that the designed observer can quickly and accurately estimate the time varying incremental total disturbance term f k the real external disturbance for auv is shown in fig 5 f from remark 1 f k includes the variation of disturbance δ d 1 k by comparing fig 5 e and f it is obvious that the variation of external disturbance was well estimated by sleso 4 3 3 scenario 3 under scenario 3 5 repeated tests have been run and the corresponding performance indexes are listed in table 6 pick one test arbitrarily and the simulation results are shown in fig 6 as shown in fig 6 a b the proposed sleso mfac scheme achieved excellent tracking performances first the tracking errors of the proposed control scheme were significantly smaller than mfac in the presence of 100 parametric uncertainties which is also verified in table 6 in addition it is noticed that at the initial stage the proposed scheme can rapidly converge to the reference with much smaller overshoot than the typical mfac the observation performance of sleso is shown in fig 6 d from remark 1 the incremental total disturbance term f k includes the variation of hydrodynamic uncertainties from fig 6 d it is obvious that f ˆ k estimated by sleso presented sinusoidal fluctuations meanwhile hydrodynamic parameters uncertainties were designed as sinusoidal functions indicating that the proposed sleso achieved good estimation performance of the variation of hydrodynamic uncertainties in summary simulation results have verified that compared with mfac the proposed sleso mfac scheme can achieve significantly superior tracking performance specifically the proposed scheme has higher tracking accuracy faster convergence rate and stronger robustness in the presence of stochastic external disturbances complex hydrodynamic uncertainties sudden changes in the reference velocity and measurement noise compared with the typical mfac scheme 4 4 discussion for the robustness test towards sudden changes in the reference velocity as shown in fig 4 the proposed control scheme can rapidly converge to a steady state compared with mfac it is obvious that when the auv s state of motion suddenly changed the reset algorithm in the mfac scheme was used to ensure that the pjm estimation has stronger robustness and adaptation to the abrupt changes in systems as shown in fig 4 f at the same time however the model approximation error will greatly increase in the mfac scheme thereby deteriorating the tracking performances on the other hand the model approximation error f k in the proposed control scheme was estimated by sleso which was further compensated in control input in real time fig 4 e shows f ˆ k estimated by sleso as a result the tracking performance is superior in the proposed sleso mfac scheme for the robustness tests towards velocity measurement noise as listed in table 4 robustness was greatly improved in the proposed control scheme this is because that along with the increase in velocity measurement noise the model estimation performance in the mfac scheme will be greatly deteriorated however in the proposed control scheme the model approximation error will be estimated and compensated in real time hence its tracking performance will be guaranteed when measurement noise exists nevertheless when the measurement noise is very large the tracking performance of the proposed control scheme will get worse because of the data driven design the relevant details will be discussed in remark 6 remark 6 limitations and solutions of the proposed scheme the proposed sleso mfac scheme is a data driven control scheme however in practical applications measurements are never perfect the i o data may be distorted by all kinds of noises or suffered from data dropouts because of failing sensors actuators or network failures bu et al 2012 and this will deteriorate the control performance of the proposed scheme and even cause damage to the actuator under serious conditions as shown in table 4 when the measurement noise was set very large the tracking performance of the proposed control scheme will get worse even if it worked well than the typical mfac scheme this limitation is common in data driven control schemes and many researches have been conducted to cope with this problem in bu et al 2012 a modified mfac algorithm is proposed with decreasing gain to attenuate the measurement disturbance in xie et al 2018 the measurement noise and data dropouts are estimated and eliminated by feedback compensation periodically in sun et al 2020 a hybrid data driven and model assisted control strategy is proposed to reduce the sensor noise effect on the actuator by a modified eso design which will be discussed in detail in remark 8 moreover adaptive filtering algorithms akhtar 2016 low pass filters li et al 2019 etc can be used to smooth measurement noise and compensate the data dropouts in the robustness test towards external disturbances and parametric uncertainties the proposed control scheme can achieve superior tracking performance compared with the mfac scheme this is because that sleso can estimate the variations of disturbances and hydrodynamic uncertainties in real time in particular attention should be paid in two aspects firstly when the auv system is suffered from time varying parameter perturbation the pjm of the system also changes significantly in real time however the pjm estimation algorithm always attempts to capture any change of the pjm as a result as shown in fig 6 f φ ˆ c was frequently reset and had large oscillations in the mfac scheme to keep estimating the time varying pjm the frequent reset of φ ˆ c will increase the model approximation error and then deteriorate the tracking performances on the other hand however as shown in fig 6 e the number of reset times of φ ˆ c was greatly reduced in the proposed control scheme this is because that sleso can handle most hydrodynamic uncertainties which can help to reduce the estimation burden of the pjm estimation algorithm thus lead to a sensitivity reduction to the time varying parameter perturbation and disturbances secondly in fig 6 d and fig 5 e at the initial stage both f ˆ k estimated by sleso were large it is clear that φ ˆ c needs a settling time to achieve satisfying estimation results hence the model approximation error was large at the initial stage this can explain the rapid convergence of the proposed control scheme at the initial stage furthermore the convergence time of the proposed scheme should be discussed for practical application of auv firstly at the initial stage of scenario 1 and scenario 2 the proposed control scheme achieved very fast convergence to the reference trajectory in nominal case secondly under scenario 1 take the second corner for example t 20 s where the reference velocity suddenly changed the proposed control scheme only took about 0 5 s to converge to the reference trajectory and it can be noticed that the mfac scheme took a longer time to converge to the reference than the proposed control scheme thirdly under scenario 2 take the third channel orientation tracking for example the proposed control scheme took about 5 5 s to converge to the reference when a high magnitude step disturbance was added at t 10 s it converged faster to the desired value than the mfac scheme in spite of the added disturbances fourthly under scenario 3 time varying parametric uncertainties were added to the auv system take the second channel y tracking for example the proposed control scheme took about 3 s to converge to the reference obviously the convergence of the proposed algorithm was faster than the mfac scheme despite with the time varying parametric uncertainties in summary the proposed control scheme can achieve fast convergence to the reference trajectory in nominal case as well as in the presence of sudden changes in the reference velocity stochastic external disturbances and time varying hydrodynamic uncertainties as a result the proposed control scheme is practical for real auvs what is more the rate of convergence of the proposed control scheme can be improved by increasing the control parameters k p 1 k d 1 k p 2 k d 2 and ω o which should be tuned based on specific requirements in practical applications remark 7 analyses and solutions of control input spikes it is well known that control input signals with huge spikes cannot be achieved by real actuators and even may cause damage to the actuator under serious conditions however in the simulations input spikes occurred in scenario 1 and scenario 2 while not occurred in scenario 3 as shown in figs 4 d 5 d and 6 c it can be found that when the auv s reference velocity suddenly changed or the auv was suffered from sharply changed disturbances include internal and external disturbance the input spikes occurred and the greater the sudden changes were the more severe the input spiking phenomenon became nevertheless when the auv was suffered from slowly changed disturbances or no added disturbances the input spikes did not occur this is because when sudden changes happened in the auv system the proposed control scheme tried hard to produce large control input to make sure the system can converge rapidly to a steady state to handle the control input spikes in the proposed control scheme two solutions can be adopted firstly the proportional gain k p 2 and the differential gain k d 2 can be tuned smaller secondly in practical applications we can limit the variation of control input per sampling period to satisfy the actuator constraint to be specific τ is designed as follows for the sake of simplicity τ is expressed for each channel i e τ f u f v m i t τ 1 τ 2 τ 3 t τ i k τ i k i f min δ τ i δ τ i k max δ τ i τ i k 1 max δ τ i i f δ τ i k max δ τ i τ i k 1 min δ τ i i f δ τ i k min δ τ i where min δ τ i max δ τ i represents the achievable variation of control input per sampling period of the real actuator i i 1 2 3 δ τ i k τ i k τ i k 1 represents the variation of control input per sampling period this solution is necessary under the two circumstances a when the added disturbances have greatly sharp changes parameter tuning may not work well b when the added disturbances only have one or few sudden changes it is not worth to tune k p 2 and k d 2 small during the whole control process it should be noted that the aforementioned solutions will attenuate the control variables and thus weaken the controller performance i e will reduce the convergence rate and the tracking accuracy of the proposed scheme as a result trade offs should be considered among different design requirements to verify the effectiveness of the two solutions simulations with square trajectory tracking were designed because the input spiking phenomenon in scenario 1 was the most severe among three scenarios the three comparative simulations were designed as follows a original setting k p 2 d i a g 30 30 30 and k d 2 d i a g 20 20 20 b parameter tuning k p 2 d i a g 10 10 10 and k d 2 d i a g 10 10 10 c actuator constraint parameter tuning max δ τ i min δ τ i 200 n i 1 2 and max δ τ 3 min δ τ 3 200 n m and k p 2 d i a g 10 10 10 k d 2 d i a g 10 10 10 the simulation results are shown in fig 7 as shown in fig 7 c d the input spiking phenomenon was greatly restrained by parameter tuning and adding actuator constraint specifically the amplitudes of spikes were greatly reduced and the input signals changed slowly and as shown in fig 7 a b the proposed sleso mfac scheme can still guarantee tracking to the square trajectory under the two solutions however the convergence rate and the tracking accuracy were reduced than the original setting therefore trade offs should be made among different design considerations remark 8 discussions on model based and data driven disturbance observes the current disturbance estimation strategies can be divided into two categories model based design and data driven design a recent overview on disturbance observers is given in chen et al 2016 the bulk of researches on disturbance estimation focus on model based design in which the exactly dynamic models or structures are required as a priori such as fixed time disturbance observer ni et al 2017 sliding mode observer yin et al 2017 etc this feature makes model based disturbance observers impractical for time varying systems with complicated modeling process and parameter identification process like the auv system from this perspective the data driven disturbance observers are more attractive options for the system whose exactly dynamic model is difficult to get however the data driven disturbance observers also have limitations on the one hand it is still difficult for the data driven control design and parameter tuning with black box type models when no dynamic model information is available on the other hand when the data driven disturbance observers response to the measurement noise the actuators may suffer from fluctuating and wear damaging sun et al 2020 in these respects the model based disturbance observers are more attractive than the data driven design what is more using precisely known model information in disturbance observer design can improve disturbance estimation performances sun et al 2019 therefore for the system whose precise dynamic model is easily accessible the model based disturbance observers are recommended how to merge the advantages and overcome the shortcomings of each paradigm is a significant problem to research however it is still an open issue in the literature to handle the first limitation of the data driven design the structure of dynamic model or physical intuition to the actual systems can be used in controller design and parameter tuning as aforementioned in this paper on the other hand to cope with the second limitation of the data driven eso inspired by sun et al 2016 a hybrid data driven and model assisted control strategy is proposed in li et al 2019 this strategy can reduce the sensor noise effect on the actuator by incorporating some dynamic model information into traditional data driven eso design the incorporated model information can help to reduce the estimation burden of the data driven eso thus lead to a sensitivity reduction to the measurement noise to some extent sun et al 2020 future work will focus on improving the sleso mfac design by combining the merits of model based and data driven ideas 5 conclusions in this paper a sleso mfac scheme was proposed for realizing a precise trajectory tracking control of an auv under parameter perturbations and external disturbances this scheme was an attractive option from an implementation point of view on the one hand it did not require any model parameters and only relied on the online i o data by the mfac on the other hand compared with the typical mfac scheme it can achieve excellent tracking performances with high control accuracy and strong robustness based on the strategy of compensated approximate model by the sleso specifically the detailed design of mfac for auv systems with rotation was proposed for the first time this contained the design within a two loop controller architecture the transformation of dld model using the structure of dynamic model of auv and a straightforward initial value setting method besides a data driven sleso was derived to estimate the incremental total disturbance term which was further compensated in the control input in real time stability analyses showed that the sleso mfac based inner closed loop control system was bibo stable comparative simulations were conducted using a falcon dynamic model with identified parameters and results showed the effectiveness and robustness of the proposed control scheme moreover a comprehensive discussions and future work are also presented at last it should also be pointed out that the proposed scheme can be extended to 6 dof auvs conveniently as well as other robotic systems credit authorship contribution statement xiaohan li conceptualization methodology software validation formal analysis investigation writing original draft chao ren conceptualization writing review editing shugen ma supervision writing review editing xinshan zhu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national key r d program of china no 2017yfc0306200 and the tianjin natural science foundation no 18jcqnjc04600 appendix a proof of theorem 1 let φ ˆ c k ϕ ˆ 1 t k ϕ ˆ 2 t k ϕ ˆ 3 t k t ϕ ˆ i k ϕ ˆ i 1 k ϕ ˆ i 2 k ϕ ˆ i 3 k f k f 1 k f 2 k f 3 k t δ v k δ v 1 k δ v 2 k δ v 3 k t i 1 2 3 eq 12 can be rewritten as a 1 ϕ ˆ i k ϕ ˆ i k 1 η δ v i k ϕ ˆ i k 1 δ τ k 1 f ˆ i k 1 δ τ t k 1 μ δ τ k 1 2 where δ v i k ϕ i k 1 δ τ k 1 f i k 1 i 1 2 3 let ϕ i k ϕ ˆ i k ϕ i k f i k f ˆ i k f i k by subtracting ϕ i k from both sides of a 1 we have a 2 ϕ i k ϕ i k 1 ϕ i k 1 ϕ i k η ϕ i k 1 δ τ k 1 f i k 1 δ τ t k 1 μ δ τ k 1 2 since φ c k b we have ϕ i k 1 ϕ i k 2 b taking norm on the both sides of a 2 yields a 3 ϕ i k ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 η f i k 1 δ τ t k 1 μ δ τ k 1 2 ϕ i k 1 ϕ i k ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 η f i k 1 δ τ t k 1 μ δ τ k 1 2 2 b according to theorem 2 e o 2 i is bounded i e f i k 1 is bounded whose detailed proof is in the next part assume that δ τ k 1 is bounded when the sample time is short enough then we have a 4 η f i k 1 δ τ t k 1 μ δ τ k 1 2 2 b c a 5 ϕ i k ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 c squaring the first term on the right hand side of a 5 we have a 6 ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 2 η ϕ i k 1 δ τ k 1 2 μ δ τ k 1 2 η δ τ k 1 2 μ δ τ k 1 2 2 ϕ i k 1 2 there exist 0 η 2 and μ 0 such that η δ τ k 1 2 μ δ τ k 1 2 2 0 let 0 d 1 we have a 7 ϕ i k 1 η ϕ i k 1 δ τ k 1 δ τ t k 1 μ δ τ k 1 2 2 d ϕ i k 1 note that we only need the existence of constant d instead of its exact value substituting a 7 into a 5 we have a 8 ϕ i k d ϕ i k 1 c d k 1 ϕ i 1 c 1 d k 1 1 d then ϕ i k is bounded from a 8 furthermore ϕ ˆ i k and φ ˆ c k are bounded since φ c k b appendix b proof of theorem 2 for the sake of simplicity the convergence of the proposed sleso is derived for each channel let e o j k e o 1 j k e o 2 j k t j 1 2 3 represent x y ψ channel respectively according to 18 the observer error dynamics of sleso for each channel can be rewritten as follows b 1 e o j k 1 a j e o j k e 1 ϕ j k δ τ k e 2 δ f j k 1 where a j 1 t β 1 j 1 0 1 t β 2 j e 1 1 0 e 2 0 1 then the nominal system of b 1 is obtained as follows b 2 e o j k 1 a j e o j k only when all the characteristic roots of a j are distributed in the unit circle will the designed sleso be stable the characteristic polynomial of a j is derived as follows b 3 z i a j z 1 t β 1 j 1 0 z 1 t β 2 j z 2 t β 1 j t β 2 j 2 z t 2 β 1 j β 2 j t β 1 j t β 2 j 1 substituting z w 1 w 1 into b 3 for bilinear transformation the characteristic polynomial in w domain is as follows b 4 t 2 β 1 j β 2 j w 2 2 t β 1 j 2 t β 2 j 2 t 2 β 1 j β 2 j w t 2 β 1 j β 2 j 2 t β 1 j 2 t β 2 j 4 0 according to the routh criterion the conditions for a j being stable are b 5 t 2 β 1 j β 2 j 0 2 t β 1 j 2 t β 2 j 2 t 2 β 1 j β 2 j 0 t 2 β 1 j β 2 j 2 t β 1 j 2 t β 2 j 4 0 from the design of observer gains β 1 j β 2 j ω o 0 substituting it into b 5 we have b 6 t 2 ω o 2 0 t ω o 2 t ω o 2 2 0 therefore when t ω o 2 a j will be stable and the system will be globally asymptotically stable because of the incremental total disturbance and pjm estimation error the steady state error exists then from b 1 when the system achieves a steady state it satisfies b 7 lim k e o 1 j k e o 2 j k ϕ j k δ τ k t ω o lim k e o 2 j k δ f j k 1 t ω o from assumption 1 δ f k 1 is bounded and δ f j c j the steady state error can be derived as b 8 e o 1 j k c j t 2 ω o 2 ϕ j k δ τ k t ω o σ 1 j e o 2 j k c j t ω o σ 2 j j 1 2 3 then e o i k i 1 2 is bounded at last f ˆ k is also bounded since f k is bounded from assumption 1 appendix c proof of theorem 3 assume that v d k 1 v d k when the sample time is short enough based on the equivalent dld model 10 we have c 1 e v k 1 e v k φ c k δ τ k f k substituting the mfac 23 into c 1 we have c 2 e v k 1 i ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k p 2 k d 2 t e v k ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k d 2 t e v k 1 ρ φ c k φ ˆ t c k λ φ ˆ c k 2 f ˆ k f k by referring to the detailed process of proof in hou and jin 2011 we can draw the following similar conclusion there exists ε 1 0 such that c 3 i ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k p 2 k d 2 t v i ρ k p 2 k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 v s i ρ k p 2 k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 ε 1 1 ρ k p 2 k d 2 t m 1 ε 1 d 1 1 2 where s a is the spectral radius of matrix a and 0 ρ 1 inspired by hou and jin 2011 the following conclusion can be drawn there exists ε 2 0 such that c 4 ρ φ c k φ ˆ t c k λ φ ˆ c k 2 v s ρ φ c k φ ˆ t c k λ φ ˆ c k 2 ε 2 ρ m 2 ε 2 d 2 1 2 due to the space limitation the detailed process of proof is omitted from c 4 the following conclusion can be deduced similarly there exists ε 3 0 such that c 5 ρ φ c k φ ˆ t c k λ φ ˆ c k 2 k d 2 t v ρ k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 v s ρ k d 2 t φ c k φ ˆ t c k λ φ ˆ c k 2 ε 3 ρ k d 2 t m 2 ε 3 d 3 1 2 assume that there exists δ 0 such that e v k v e v k 1 v δ when the sample time is short enough according to assumption 1 and theorem 2 f k and f ˆ k are bounded i e there exists d 4 0 d 5 0 such that f ˆ k v d 4 f k v d 5 let d 6 2 max d 1 d 3 1 2 i e d 6 1 and a d 6 2 δ d 2 d 4 d 5 from c 2 we can derive c 6 e v k 1 v d 1 e v k v d 3 e v k 1 v d 2 f ˆ k v f k v d 6 2 e v k v e v k v δ d 2 d 4 d 5 d 6 e v k v d 6 2 δ d 2 d 4 d 5 d 6 e v k v a d 6 k e v 1 v a 1 d 6 k 1 d 6 thus the conclusion 1 of theorem 3 is the direct result of c 6 since v d k and e v k are all bounded then v k also will be bounded thus the conclusion 2 of theorem 3 is proved 
21416,the offshore industry operates increasingly large installations in exposed areas requiring high reliability and availability downtime of complex offshore systems leads to significant financial losses towards year round offshore installation and maintenance service this research focuses on the identification of weather robust vessel designs even though it might seem that the motions of a larger vessel will be more favorable than those of a smaller vessel this research shows that this hypothesis is not necessarily true it will be shown that for certain vessel parameters the performance of a larger vessel is not better than that of a smaller vessel this investigation aims to provide knowledge for a more holistic vessel design optimization approach to enable ship designers and operators to design and select an offshore vessel with main dimensions and hydrostatic parameters providing optimal seakeeping performance for a given operation and environment the key aspect is a mission dependent optimization of hull dimensions including loading condition parameters aiming for a hull design where natural periods of important responses such as pitch and roll are significantly distinct from the dominating wave periods for this purpose a novel parameter for seakeeping performance evaluation the operability robustness index ori will be used keywords offshore vessel seakeeping performance kpi design parameter operability robustness index percentage operability 1 introduction the optimization of seakeeping performance is the improvement of the vessel s capability to efficiently execute its mission despite adverse weather conditions comstock and keane 1980 the investigation of the dependency of vessel dimensions and loading conditions on the behavioral vessel response in waves is crucial for the determination of operational performance as well as the design and selection of the best suited vessel strategies for identification and benchmarking of operational performance based on non exceedance of specified motion limitations remain a significant area of interest for hull optimization a practical approach for the assessment of vessel motion performance in waves will support ship designers and operators to design and select the best suited vessel for defined operational scenarios the proposed methodology is applicable for a wide range of offshore vessels such as offshore construction vessel ocv inspection maintenance and repair vessel imr anchor handling vessel ahv platform supply vessel psv as well as accommodation vessel and crew transfer vessel a tendency towards increasingly rough weather conditions triggered by climate change young and ribal 2019 combined with a growing financial pressure within the complete offshore value chain mellbye et al 2017 leads to the need of a more thorough evaluation and optimization of mission oriented seakeeping performance during the last decade designers operators and clients working in the oil and gas business indicated a demand for larger ocvs mainly to ensure high operational performance by minimizing the risk for delays due to possible weather related waiting time the fact that vessel size is not necessarily decisive for the assessment of seakeeping performance is known in literature papanikolaou 2014 however it is commonly misinterpreted within the offshore construction industry therefore the presented research shall contribute to the identification of potential for performance improvement aiming for increased mission performance and or a reduction in vessel size and thus operational costs although ship design is always a balance of various functions this is a feasible approach at an early design stage since an increased ocv hull size is often motivated by seakeeping optimization purpose and not loading requirements as it is usually the case for other ship types the quest for an optimal vessel design minimizing the adverse impact and degradation of ship performance caused by the sea environment has been an intense area of research for decades in commercial navigation vertical accelerations and relative motions between hull and wave are identified as critical for favorable seakeeping performance faltinsen 1990 it is therefore reasonable that the minimization of heave pitch and vertical ship motions as well as accelerations exclusively at forward speed have been the main research objectives lewis 1955 investigated the influence of a forebody design on seakeeping performance in extreme weather conditions this paper experimentally compared the u shaped series 60 hull model with another model having the same main dimensions and buoyancy distribution but with extreme v shaped sections in the forebody swaan and vossers 1961 and swaan 1961 extended these tests in regular bow waves 10 and 50 off head seas comparing seakeeping performance of the original u shaped series 60 hull with three other models with differently v shaped bow sections and at two forward speeds bengtsson 1962 extended the test series with seven models for a larger range of forward speeds in regular head seas in 1965 he extended his series by further investigations of the influence of block coefficient and ballast draught condition on seakeeping performance bengtsson 1965 bales and cummins 1970 performed parametric seakeeping calculations in a relatively large study using seven parametrically altered design parameters adopted on a simplified hull design ewing 1967 performed numerical seakeeping analysis on the series 60 model which was continued and extended by yourkov 1973 and beukelman and huijser 1976 the progress in numerical calculations allowed loukakis 1975 to investigate seakeeping performance in head waves for seventy two hull forms for the extended series 60 design loukakis findings for heave pitch bending moment and added resistance are presented as seakeeping tables allowing the linear interpolation of the results as function of principle hull characteristics froude number and sea state as a result of the presented studies it can be concluded that the ship length appeared to have a greater influence on seakeeping performance while the forebody section shape and the block coefficient showed a smaller influence on seakeeping performance beukelman and huijser 1976 generally local hull modifications show a minor impact on motion performance whereas the increase in hull length results in a noticeable increase in performance lloyd 1989 accordingly larger ships tend to be more comfortable than smaller ships and the increase in hull size will result in improved seakeeping performance seakeeping performance assessment must therefore be considered at an early stage in the design process before the major proportions and dimensions of the hull have been settled lloyd 1989 in more recent years the research focus has been rather on the optimization procedures of particular vessel designs than on the exploration of the designs parameters influence on seakeeping performance being the primary objective of the current study the influence of design parameters on ship motions has been a research topic in the past decades and is relatively well understood nonetheless norwegian offshore vessel designers are indicating strong interest in further investigations of the impact of vessel design characteristics on seakeeping performance in the context of offshore lifting operations roll and pitch are generally most critical motion components while vertical motion components can be compensated by the crane s automated heave compensation system horizontal crane tip motions as a result mainly from roll cannot be compensated and limit operability especially during the lift in air phase the focus of this work is on the systematic presentation of the influence of design parameters on roll at zero ship speed to identify and benchmark mission oriented seakeeping performance for this purpose the percentage operability and the operational robustness index ori introduced by gutsch et al 2016 2017 will be utilized both performance parameters are suitable for the identification and benchmarking of mission oriented vessel capabilities related to a selected motion parameter sea area and season a comparison between the two parameters will be presented and the differences in application and analysis will be discussed based on selected results from a large database of motion transfer functions of parametrically re sized geometric similar vessel designs the basic hull geometry is provided by a ship designer representing a typical modern offshore construction vessel in operation since 2014 the origin of this design is agreed to be confidential however the complete rao database can be used for further investigation and is accessible online by using the vessel response tool freely accessible on vrt sintef no 2 assessment of operational performance marine operations especially walk to work w2w and lifting operations over the vessel s hull side require a specialized vessel designs with high operability dnv gl s offshore standard for marine operations states a marine operation shall be designed to bring an object from one defined safe condition to another dnv gl 2011 the term safe condition refers to a condition in which the object is exposed to the same level of risk for damage or loss as in the in place condition however between those safe conditions the object will be exposed to movements and water impact forces which must not exceed a maximum tolerable level defined in terms of motion limitation criteria such as motion displacements velocities or accelerations information on motion limitations or non exceedance criteria are used for vessel operability analysis together with weather hindcast data leading to a determination of the vessel s operability often also referred to as seakeeping theperformance vessel operability is defined as the ability to carry out the vessel s mission safely while the environmental impact represented by the waves degrades this operability compared to the calm water condition in order to optimize operability vessel motions must be minimized lower vessel motion levels will be achieved by moving natural periods of vessel motions outside the range of typical wave periods encountered in the sea area of interest and by increasing the damping effectiveness an example of an effective damping device to reduce roll motions are bilge keels the overall purpose of seakeeping optimization is to reduce the vessel s sensitivity to environmental conditions therefore increasing operability availability and safety towards year round offshore operations to evaluate of vessel operability a study of wave induced vessel response characteristics is essential as an example lifting operability will be optimized by minimizing crane tip motions generally it can be differentiated between vessel motions excited by first and second order wave forces while second order forces leading to drift motions can be substantially minimized by a well tuned dynamic positioning dp system motions excited by first order wave forces cannot be completely suppressed horizontal and vertical motions in the wave period frequency range are mainly caused by the vessel s heave roll and pitch motions and can be minimized by well chosen design parameters which will be further addressed although roll motions can be efficiently reduced by damping devices such as bilge keels and roll reduction tanks rrts which on one hand are a well proven strategy to reduce unwanted roll motions for w2w operations on the other hand however free surface rrts reduce vessel stability due to the effect of the free surface the use of those highly efficient roll damping devices might be a risk during the execution of marine operations directly affecting the vessel s stability such as offshore lifting or anchor handling operations the stability reduction due to a rrt has most likely been one of the leading reasons to the capsizing accident of the ahv bourbon dolphin analyzed by lyng et al 2008 furthermore response optimization can be achieved to some degree by particular hull shapes with a reduced water line area such as specialized multihull designs examples being small waterplane area twin hull swath and semi submersible designs yet those specialized vessels are rather rare exceptions among offshore vessels and will not be further discussed 2 1 phases of a lifting operation a subsea crane operation over the vessel s hull side can be divided into five operational phases summarized in table 1 each phase is associated with specific hazards which have to be identified during the planning process and evaluated during vessel design and selection to be kept within acceptable limits generally horizontal crane tip displacements and periods are more critical during lift off and object in air lift while relative vertical velocities and accelerations may be critical in the splash zone the lift through the water column may become critical especially for deep water operations due to the elasticity and the weight of the lifting line the longer crane wire will affect the natural vertical period of the crane system the accordance of this natural period with for example the roll period must be avoided finally an accurate dp system and a limited absolute vertical velocity at crane tip position is required to allow the object to be safely positioned and landed on the seabed 2 2 seakeeping analysis a seakeeping analysis is based on the detailed knowledge of the planned operational task mission requirements as illustrated in fig 1 define the starting point of an operability analysis for the design or the selection of a suitable vessel information on the required payload the ship speed the motion limitation s the preferred wave heading and the expected weather must be available the required payload determines the vessel s mass distribution and will affect its hydrostatic properties and thus its response characteristics in waves the combination of the wave spectrum expected at the sea area and season of interest with the general vessel response characteristics leads to the actual vessel behavioral response a comparison with mission dependent motion limitations including possible limitations based on sensitive on board equipment leads to the overall vessel seakeeping performance besides technical aspects contributing to seakeeping performance the evaluation of human factors including crew competence organization and safety components will complete the analysis the individual calculation steps towards a seakeeping performance value such as the percentage operability percop or the operational robustness index ori are shown in fig 2 by using the hydrodynamic characteristics of the hull including mass distribution wave heading and ship speed the transfer function of the hull motions characterized by the response amplitude operator rao and phase angle can be determined for the current study the raos are calculated with sintef ocean s vessel response calculation software veres based on linear strip theory salvesen et al 1970 fathi 2017 assuming linear behavior the harmonic excitation of the vessel due to a wave of the frequency ω yields a phase shifted harmonic response of the same frequency the rao describes the ratio between the response output signal s j ω and the wave excitation input signal ζ ω for each six degrees of freedom 6dof motion mode j circular wave frequency ω and heading β this motion transfer function provides a full correlation of the hydrodynamic motion characteristics for a defined heading β and ship speed in regular waves 1 h j ω β s j ω β ζ ω the raos determined within the current study accounted for viscous roll damping due to frictional shear stress on the hull surface kato 1957 eddy damping ikeda et al 1977a and lift damping from pressure variation along the naked hull himeno 1981 damping contributions from bilge keels due to normal forces ikeda et al 1976 and hull pressure created by the presence of the bilge keels ikeda et al 1977b the damping contribution of a typical bilge keel size being a third of the hull length l h u l l 3 by 30 cm width is assumed at zero speed wave radiation damping is obtained from analysis of each single strip contributions of non linear damping effects are included using a significant wave height of 2 m to linearize the non linear roll damping component according to the recommendation by dnv gl for the north sea and north atlantic the jonswap joint north sea wave project wave spectrum with a variable peakedness parameter γ describing both steep wind driven and longer swell dominated waves is used dnv gl 2017 section 3 5 5 5 once the suitable sea state spectra s ζ ω t p with the associated range of peak periods are established the stochastic analysis begins with the determination of the desired response spectra s j ω β t p by multiplying the sea state spectra by the squared absolute value of the rao for each mode j 2 s j ω β t p h j ω β 2 s ζ ω t p from the area enclosed by the response spectra standard deviation σ j β t p and significant double amplitudes η j s β t p for the individual heading β are determined 3 σ j β t p 0 s j ω β t p d ω 4 η j s β t p 4 σ j β t p finally the maximum tolerable significant wave height h s t o l t p can be calculated by multiplying the maximum tolerable motion criteria σ j t o l with the ratio of the significant wave height and the values obtained from eq 3 5 h s t o l β t p σ j t o l h s σ j β t p by comparison of the maximal tolerable wave height h s t o l β t p for the individual heading β with the wave scatter diagram from a defined sea area and season the percentage operability p o p β can be determined for the selected heading generally percentage operability expresses the percentage of the time where the vessel can satisfy the maximum tolerable operability limitation criteria o p t o l m a x for a given sea state described by h s and t p the minimization of roll motions is a major objective during offshore vessel design for the vessel design as well as in the scenario of a vessel selection process during operational planning the selection of a correct quantitative motion limitation value is less important than the general capability of the vessel to show high operability even for low and thus strict motion limitations to satisfy this characteristic the operability analysis will be performed for several motion limitations between zero and a maximum limit this allows to create a curve showing percentage operability performance p o p evolving between zero and the specified maximum tolerable operational limit o p t o l m a x as indicated by the large graph on fig 3 based on the initial steepness of the curve the vessel with the highest operability for strict motion limitations can be identified generally the steeper the curve showing a higher gradient the better the global performance for this analysis the maximum tolerable operational limit can be chosen rather freely but must be kept constant throughout the complete benchmarking process for the analysis of roll performance this can be a maximum tolerable root mean square rms value for roll of 1 or even 2 fig 3 shows an example that the roll limitation criterion of 2 0 rms leads to an absolute percentage operability percop of about 100 for all variations of gmt during north sea summer season while the initial steepness of the compared loading condition indicates different motion sensitivity levels on smaller waves the new operability robustness index ori is introduced as eq 6 to express the global performance of a ship for a selected motion criterion the ori is expressed as a single benchmark parameter by the dimensionless ratio of the area enclosed by the curves on the large graph in fig 3 exemplarily indicated by the gray area below the red curve and the maximum theoretically possible operability which is be equivalent to the product of o p t o l m a x and 100 operability indicated by the black dashed rectangular line the small graph on fig 3 represents the development of the ori over the motion limitation extracted from the large percentage operability percop graph 6 o r i 0 o p t o l m a x p o p o p t o l d o p t o l o p t o l m a x 100 for the quantification of response based operability this new performance parameter was first introduced by gutsch et al 2016 and is used by gutsch et al 2017 and sandvik et al 2018 in comparison to the absolute percop value the use of the ori has clear advantages for benchmarking of the relative response performance of different vessel designs since the ori includes the evaluation of the percop for a specified range of operational limits including low and hence strict values the result of the performance assessment is less dependent on the choice of the maximum allowable limitation value for this reason the ori provides a broader view on response based vessel performance therefore complementary to the percop the ori is perceived as a quality index for vessel performance in waves with respect to a selected motion criterion and is therefore perfectly suitable as key performance indicator kpi for seakeeping performance 3 parametric design variation a parametric investigation utilizing the geometry of a modern offshore construction vessel ocv design is conducted the applied geometry is scaled to five different hull lengths l h u l l between 80 m and 160 m for these parent hull geometries of five different hull length l h u l l the beam b 0 is adapted to represent a realistic average length to beam ratio l h u l l b 0 as found to be typical for ocvs of each corresponding length for this reason the length dependent l b ratio of fifty currently operating ocvs of hull lengths between 67 m and 180 m is analyzed the following polynomial formulation is found 7 b 0 1 6 762 1 0 5 l h u l l 2 730 1 0 2 2 627 l h u l l the hydrodynamic characteristics of the initial vessel designs with average length to beam ratio l h u l l b 0 are indicated in table 2 based on the initial vessel designs with five hull lengths and the typical beams b0 derived from eq 7 as indicated in table 2 the actual beam b is increased and reduced in steps of one meter to a range of plus minus three meters resulting in a set of 35 different hull sizes as shown in table 3 for each of the 35 hull designs the roll response amplitude is analyzed for nine draughts d between 5 m and 9 m and nine transverse metacentric heights gmt between 1 m and 5 m see fig 4 resulting in a database of 2835 response amplitude operators raos for geometrically similar vessel designs since the height of the metacenter is defined by the cross sectional geometry of the vessel the vertical center of gravity vcg is adjusted in order to achieve the desired gmt value the distribution of mass in transverse mass moment of inertia for roll r 44 0 35 b e a m and longitudinal mass moment of inertia for pitch r 55 0 25 l p p length between perpendiculars direction is kept constant for all vessel designs all parameters are treated as isolated variables by taking into account their relation and dependency on other vessel parameters which are adapted as shown in table 4 the ranges of the parameter variations from lowest to highest intentionally exceed their typical ranges for ocvs especially for gmt the isolated variation of single parameters irrespective of its subsequent physical relationship to other parameters might be an academic approach with vessel particulars which are not always applicable in a real vessel design however it provides the researcher with a method to identify important parameters that influence operability the dependencies of the altered parameters on other vessel characteristics are shown in table 4 a variation of the mass moment of inertia for roll r44 and pitch r55 is not carried out since the controllability of this value is usually very limited in practical operation nevertheless results from a small parametric study for r44 are published by gutsch et al 2016 2017 4 analysis of roll amplitude the seakeeping performance of geometric similar offshore vessel designs is analyzed to investigate the influence of the variation of hull length l beam b draught d and transverse metacentric height gmt in the north sea 56 52n 3 24e and north atlantic 65 29n 7 32e both during the winter and summer seasons as environmental information metocean hindcast data obtained between 1958 and 2016 provided by the norwegian meteorological institute is used the performance is benchmarked in terms of percentage operability percop and the operational robustness index ori all results presented in this chapter are calculated based on vessel motion characteristics at zero speed further a wave heading of 30 corresponding to bow quartering seas 1 1 in veres a wave heading angle of 0 corresponds to head seas 90 corresponds to beam seas and 180 corresponds to following seas and a limiting roll angle of 0 5 1 0 and 2 0 root mean square rms are exemplarily chosen for the analysis in practical day to day work the limitations should be evaluated individually according to the requirements of the specific offshore operation the wave heading of 30 off bow represents a typical situation during an offshore lifting task or a w2w operation the choice of this wave angle is considered although a wave angle of 15 corresponding to almost head seas could be preferred in practical operations to minimize roll and still provide favorable wave shielding effects for e g the splash zone area however to simplify the calculations a long crested wave spectrum is chosen for the analysis therefore the slightly larger wave angle of 30 shall provide slightly more roll response and account for a potentially more scattered wave energy spreading in real sea conditions the choice of the long crested sea spectrum is based on practical reasons due to the comparative nature of the study main focus is placed on the comparison of relative results between the different designs with the objective to provide understanding of influencing factors allowing a better identification of favorable vessel design parameters for this purpose the long crested sea spectrum is regarded as more appropriate than a short crested directional wave spectrum which would rather allow the best possible modeling of real sea conditions but also involves further influencing factors which must be taken into consideration in the analysis of the results in order to limit the amount of results a reduced set of results with the most relevant variations is selected the interested reader is invited to perform further analysis using the online vessel response tool freely available on vrt sintef no 4 1 presentation of results the results for the variation of length fig 5 beam figs 7 and 8 draught figs 10 and 11 and gmt figs 13 and 14 are illustrated by the percop red graph 2 2 for the representation of the results in coloured figures please refer to the open access web version of this article related to primary ordinate and the ori blue graph 2 related to secondary ordinate for both performance benchmarks the same roll angle limitation criteria are used for each limitation criterion a set of five curves that show the results of the different hull lengths over the related parameter as indicated below the abscissa the related hull lengths are indicated for the variation of beam by arrows figs 7 and 8 whereas for the variation of draught and gmt each hull length is presented separately in a sub diagram figs 7 8 10 11 13 and 14 additionally the results are visualized as color maps 2 indicating the numerical variation of the investigated parameters for the 2 rms roll angle limitation criterion these color maps are shown for the variation of length in fig 6 for beam in fig 9 for draught in fig 12 and for gmt in fig 15 as in the diagrams the color maps show the results obtained during winter season in north sea and north atlantic in a table like presentation for each altered vessel parameter per rows while in columns on the left side the absolute value for the percop and the ori are shown followed by the mean value and the spreading of the results for each vessel length finally on the right side the deviation that means the relative difference of the mean value is presented the definition of the color code is indicated in the legend below and can be summarized as followed from left to right side the color code 2 behind the absolute value indicates the level of the result above 75 for percop and 0 5 for ori in green and below that value in red a fully developed green color indicates a value approaching 100 for percop or 1 0 for ori respectively a fully developed red color indicates a value of 50 or lower for percop and approaching 0 0 for ori the color scale is selected individually to best represent the deviating levels of the result the color bar behind the mean value and the spread shows the percop in red for its range between 0 and 100 and the ori in blue for its range between 0 and 1 the color code behind the deviation to the mean value indicates the level of an increase above 0 for percop and 0 0 for ori in green and decrease below that value in red a fully developed green color indicates a deviation to the mean of 25 for percop and 0 2 for ori a fully developed red color indicates a deviation to the mean of 25 for percop and 0 2 for ori again the color scale is selected individually to better present the deviating levels of the result the individual levels for the color codes are selected according to the general range of the presented results and since an increase or decrease of 20 to 25 indicate a significant performance gain or loss compared to an average value and will considerably influence vessel performance 4 2 winter season versus summer season the analysis of the vessel performance during winter versus summer season shows a significant increase in roll performance expressed in terms of percop and ori during the summer season figs 5 7 8 10 11 13 and 14 the absolute difference between the highest and lowest performance is nominated as spread in fig 6 it is larger for the season and area with the roughest weather condition which generally is north atlantic and winter season while it is significantly smaller during summer season when the performance characteristics are generally adequate for all vessels this is especially observed in the analysis of the percop while the ori is still capable of indicating the differences between the designs the percop value converges against 100 and is not capable of indicating performance variations this is related to the fact that the percop indicates the absolute performance for the chosen limitation criterion therefore the percop value approaches a value close to 100 during the summer season almost regardless of the vessel s capabilities during the winter season this is the case for the percop value when calculated for a fairly calm environmental condition such as encountered during summer season and or for a rather large motion limitation such as the 2 rms roll value or higher therefore if the result for the percop approaches 100 representing the maximum achievable value for percop a proper performance assessment and benchmarking of the deviating vessel designs becomes impossible in comparison to the percop the ori accounts for the development of the percop on its complete course of this behavior between zero and the chosen maximum motion limitation therefore the ori behaves qualitatively similar but approaching its maximum possible value of 1 0 slower consequently the ori allows vessel performance assessment to be more independent of the chosen environmental condition and level of limitation criteria aiming for year round offshore operations a design optimization focusing on the improvement of operability during the winter season is required therefore this research will mostly focus on the analysis of design dependent results for percop and ori during the winter season 4 3 north sea versus north atlantic as a general remark it can be stated that roll performance results expressed in terms of percop and ori are higher in north sea than in the north atlantic independently of the investigated vessel design the comparison between north sea versus north atlantic winter season indicates that the north sea has a larger increase in roll performance for shorter vessels between 80 m and 100 m hull length while this increase is reduced for longer vessels between 140 m and 160 m fig 5 the results analyzed for the north atlantic however show with a larger operability gain for longer hull lengths being the opposite behavior this may be an indication that in a more holistic cost benefit evaluation process an optimal seakeeping performance may be identified for hull lengths which are in most cases generally shorter in the north sea than in the north atlantic however a more detailed analysis of the influence of specific design variations indicates deviating behavior due to the different dominating wave peak period tp as discussed in section 4 7 4 4 variation of length for most of the results roll performance is improving with larger hull lengths l h u l l and vessel displacements as shown in fig 5 this tendency is expected since for each length a common length to beam ratio l h u l l b 0 is chosen to satisfy the demand for using typical vessel dimensions as described in section 3 therefore the beam b 0 is adopted as a length dependent parameter and is increased according to eq 7 the main vessel parameters for the variation of length are indicated in table 2 generally a larger vessel is expected to show less roll amplitude than a smaller vessel in a similar sea state therefore it can be expected that the larger vessel and therefore the more expensive vessel will show an increase in operability exceptions to this general rule will be a focus of this investigation and can be found especially for the variation of beam section 4 5 and the variation of gmt section 4 7 4 5 variation of beam favorable results in terms of percop and ori are found in the variation of beam as well for small vessel beams and shorter hull lengths in the north sea for l h u l l 80 m and the north atlantic for l h u l l 100 m as well as for large vessel beams and larger hull lengths in the north sea for l h u l l 100 m and in the north atlantic for l h u l l 120 m figs 7 and 8 this means that for example during the north atlantic winter season the percop for the 2 rms roll criterion of an 80 m vessel with a beam of 15 3 m is around 80 and cannot be amplified by increasing the hull length unless the hull is at least 140 m long and has a beam of more than 29 m this tendency is strongest during the winter season in the north atlantic and is less pronounced during the winter season in the north sea and even more reduced during the summer season figs 7 and 8 comparing the impact of the variation of beam in terms of deviation to its mean value of the individual length the largest increase in percop of 13 5 absolute 84 6 in north sea and 26 0 absolute 80 1 in north atlantic is found for the short vessel design with l h u l l 80 m and b 15 3 m the shortest vessel also shows the largest spread of percop results within the same hull length of 18 7 for north sea and 37 8 for north atlantic for the 2 rms roll limitation criterion whereas the results for the ori are not showing a similar large spread in the results for the shortest hull length especially the influence of the beam variation in the north sea shows less spread for shorter hull length indicating that the results for a more restrictive limitation criterion might be better for wider hulls given that gmt can be kept small in the north sea the ori value shows that for the 80 m vessel an especially narrow and wide vessel will be favorable while in the north atlantic the narrow hull of this hull length performs clearly better than the wide hull this behavior is opposite for l h u l l 100 m in the north sea and l h u l l 120 m in the north atlantic from the results for the variation of beam it can be seen that the information value of percop as performance indicator highly depends on the choice of the level for the maximal acceptable limitation criterion this can be acceptable if a vessel will be selected for a certain operational task however for design purposes the ori provides a more general limitation criterion less dependent on the limitation criterion level nevertheless the results of both benchmarking criteria especially for intermediate hull lengths are dependent on the choice of the specific sea area providing a certain wave energy spectrum for individual peak periods commonly the results of the beam variation show that typical length to beam rations for offshore vessels as used for the mid range settings shown in table 2 show rather unfavorable seakeeping performance 4 6 variation of draught the variation of draught is performed for all ship lengths corresponding a draught range between 5 m and 9 m in 0 5 m steps generally the variation of draught shows minor impact on percop and ori a slightly beneficial performance is found for large draughts at shorter hull length l h u l l 100 m and thus smaller beam values b 0 21 30 m as well as for low draught for longer hull length l h u l l 120 m and thus larger beam values b 0 24 30 m figs 10 and 11 the largest spread in terms of percop of about 14 9 can be found in the results for the north atlantic for the 80 m long vessel design fig 12 the impact of draught variation on roll performance is rather small for the medium sized hull designs of 100 m and 120 m hull length the results for the ori are in accordance with the results for the percop in contrast to the variation of beam and gmt the draught variation has no influence on the vessel s natural roll period and thus shows similar results for both sea areas the variation of draught will rather influence roll damping due to minor viscous and more considerable added mass effects especially the larger roll reduction for smaller draught and longer and wider vessel designs can be explained by increased added mass effects similar to a catamaran a flat and wide cross sectional shape may induce more vertical than rotatory motions at the outside hull area therefore the heave like motion component may increase roll damping due to added mass effects for low draught at larger beams it may be noted that for the variation of draught the vertical center of gravity vcg is adjusted to keep a constant gmt as indicated in table 4 4 7 variation of metacentric height the variation of metacentric height gmt is performed for all ship lengths for gmt values between 1 m and 5 m in 0 5 m steps the gmt level is strongly affecting the vessel s roll period and shows thus a strong influence on roll performance in terms of perop and ori in the analyzed sea areas figs 13 and 14 to obtain small roll angles generally a small gmt value resulting in a longer roll period with soft motion characteristics as well as a large gmt value resulting in a shorter roll period with stiff motion characteristics is favorable the unfavorable region of low performance gmt is shifting from smaller gmt values of around 2 0 m for shorter vessel designs 80 m to larger gmt values of around 4 0 m for longer vessel designs 160 m fig 15 the results of percop for the vessel design with g m t 4 5 m are marked in figs 13 and 14 by color coded circles referring to the similar colored raos shown in fig 16 especially the results analyzed for the north atlantic winter season indicate for the shortest hull length l h u l l 80 m a significantly better roll performance than for the larger vessel l h u l l 160 m with the same gmt value the corresponding absolute percop values can be found additionally in fig 15 see column showing results for g m t 4 5 m an explanation for this atypical result is indicated in fig 16 showing the raos for the five corresponding vessel designs in relation to the wave occurrences shown as accumulation of hs per tp over the wave peak period tp this presentation indicates that the sensitive period of the maximal response amplitude of the small designs is clearly distinct from the dominating wave periods observed during the north atlantic winter season while this is not the case for the analysis performed for the north sea winter season hence the roll response amplitude of the smaller vessel is favorable above the large vessel operating during the north atlantic winter season it has to be noted that there are existing stability requirements limiting small gmt values not allowing it to fall below a value in an order of around 1 0 m considering g m t 1 5 m it can be concluded that shorter vessels l h u l l 120 m show a higher operational performance for larger gmt values g m t 4 5 m and large vessels l h u l l 140 m show a higher operational performance for smaller gmt values the influence on maximal tolerable accelerations of a softer versus a stiffer vessel must be further evaluated 5 summary the selection and optimization of a vessel design to perform a specific offshore operational task considering costs and operational aspects is not straightforward and requires detailed comparative operability analyses however according to information provided by offshore vessel designer s today s common practice is to perform seakeeping analysis for the approval of a final design only although it might be expected that roll amplitudes of a larger vessel will be smaller and hence more favorable than those of a smaller vessel this study shows that this assumption is not always true a key aspect of a design process should be the mission dependent optimization of hull dimensions including loading condition parameters aiming for a design where natural periods of important responses such as pitch and roll are significantly different from the dominating wave periods this research focuses on the quantification of the relative impact of design variations on seakeeping performance at zero speed aiming for the identification of weather robust vessel designs as a requirement to operate safely in higher sea states for the identification and benchmarking of mission oriented vessel capabilities this research utilizes two seakeeping performance parameters the percentage operability percop and the newly developed operational robustness index ori the paper presents that a well established percop performance indicator is a suitable parameter for operational planning and vessel selection if all operational details are available while the ori clearly indicates advantages for design optimization during the early ship design process and for vessel selection in circumstances when operational limitations sea area or season are not specified as a consequence the ori can be judged as the more robust performance criterion since it is less sensitive to user input in this analysis the advantages of the ori are described in cases when seakeeping performance is generally good and when the percop value converges against 100 and hence does not indicate a generally better performing vessel while the ori remains capable of indicating differences in performance results of a parametric study of design characteristics indicate a significant influence on roll performance for the variation of hull length beam and metacentric height gmt whereas minor deviations for the variation of draught are found as a general result it can be concluded that seakeeping performance is often increasing with vessel dimensions however this rule does not necessarily apply to the selection of beam and gmt parameters as an example from the results of the beam variation during north atlantic winter season favorable seakeeping performance is found for small vessel beams and shorter hull length as well as for large vessel beams and larger hull length to further illustrate this the roll performance of an 80 m vessel with a beam of 15 3 m is around 80 and cannot be improved by increasing hull length unless the hull is at least 140 m long and has a beam of more than 29 m similar to the choice of the hull beam the choice of the vertical center of gravity and hence gmt is strongly influencing the vessel s roll performance favorable results are found for both small and large gmt values whereas for ocvs often adopted gmt values of 2 m to 3 m show an unfavorable roll performance and thus larger roll angles the advantage of a larger gmt value is more pronounced for shorter hull length which is resulting in the fact that the shortest hull length of 80 m with a gmt parameter of 4 5 m performs significantly better than the largest vessel of 160 m length with the same gmt value as an explanation of this phenomenon it is indicated that in such cases the peak period for the maximum amplitude of the response amplitude operator rao for roll clearly differs from the peak period of the dominating wave energy due to the large amount of data generated in this research project the presented study is limited to the analysis of the impact of hull length beam draught and gmt variation on seakeeping performance utilizing the roll amplitude criterion at zero speed and 30 wave heading therefore the interested reader is invited to perform further analysis using the vessel response tool for free online available on vrt sintef no 6 conclusion the study has shown that vessel size is not always the decisive parameter for the determination of seakeeping performance therefore the simple rule bigger is better does not apply in all cases the findings on the variation of beam and gmt show that commonly adopted values are rather unfavorable regarding roll performance therefore a significant potential for the minimization of the vessel s roll amplitude and thus the improvement of seakeeping performance is given this potential must be used for design optimization and will contribute to increased operability towards year round offshore operations as well as to cost reductions of offshore installation and maintenance services as benchmarking parameter this investigation utilizes a novel seakeeping performance indicator the operability robustness index ori and compares its application with the widely known percentage operability value the comparison of these two performance indicators clearly indicate the advantage of using the ori for seakeeping optimization the ori can be judged as the more robust performance indicator identifying improvements in seakeeping performance for a selected sea area more correctly independently of the magnitude of the limitation criterion additional to the results presented the reader is invited to further explore the ori as seakeeping performance criterion for offshore vessels using the vessel response tool accessible for free on vrt sintef no credit authorship contribution statement martin gutsch conceptualization methodology formal analysis investigation writing original draft writing review editing visualization sverre steen supervision writing review editing florian sprenger supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was made possible through the centre of research based innovation sfi move financially supported by the norwegian research council nfr project number 237929 and the consortium partners http www ntnu edu move 
21416,the offshore industry operates increasingly large installations in exposed areas requiring high reliability and availability downtime of complex offshore systems leads to significant financial losses towards year round offshore installation and maintenance service this research focuses on the identification of weather robust vessel designs even though it might seem that the motions of a larger vessel will be more favorable than those of a smaller vessel this research shows that this hypothesis is not necessarily true it will be shown that for certain vessel parameters the performance of a larger vessel is not better than that of a smaller vessel this investigation aims to provide knowledge for a more holistic vessel design optimization approach to enable ship designers and operators to design and select an offshore vessel with main dimensions and hydrostatic parameters providing optimal seakeeping performance for a given operation and environment the key aspect is a mission dependent optimization of hull dimensions including loading condition parameters aiming for a hull design where natural periods of important responses such as pitch and roll are significantly distinct from the dominating wave periods for this purpose a novel parameter for seakeeping performance evaluation the operability robustness index ori will be used keywords offshore vessel seakeeping performance kpi design parameter operability robustness index percentage operability 1 introduction the optimization of seakeeping performance is the improvement of the vessel s capability to efficiently execute its mission despite adverse weather conditions comstock and keane 1980 the investigation of the dependency of vessel dimensions and loading conditions on the behavioral vessel response in waves is crucial for the determination of operational performance as well as the design and selection of the best suited vessel strategies for identification and benchmarking of operational performance based on non exceedance of specified motion limitations remain a significant area of interest for hull optimization a practical approach for the assessment of vessel motion performance in waves will support ship designers and operators to design and select the best suited vessel for defined operational scenarios the proposed methodology is applicable for a wide range of offshore vessels such as offshore construction vessel ocv inspection maintenance and repair vessel imr anchor handling vessel ahv platform supply vessel psv as well as accommodation vessel and crew transfer vessel a tendency towards increasingly rough weather conditions triggered by climate change young and ribal 2019 combined with a growing financial pressure within the complete offshore value chain mellbye et al 2017 leads to the need of a more thorough evaluation and optimization of mission oriented seakeeping performance during the last decade designers operators and clients working in the oil and gas business indicated a demand for larger ocvs mainly to ensure high operational performance by minimizing the risk for delays due to possible weather related waiting time the fact that vessel size is not necessarily decisive for the assessment of seakeeping performance is known in literature papanikolaou 2014 however it is commonly misinterpreted within the offshore construction industry therefore the presented research shall contribute to the identification of potential for performance improvement aiming for increased mission performance and or a reduction in vessel size and thus operational costs although ship design is always a balance of various functions this is a feasible approach at an early design stage since an increased ocv hull size is often motivated by seakeeping optimization purpose and not loading requirements as it is usually the case for other ship types the quest for an optimal vessel design minimizing the adverse impact and degradation of ship performance caused by the sea environment has been an intense area of research for decades in commercial navigation vertical accelerations and relative motions between hull and wave are identified as critical for favorable seakeeping performance faltinsen 1990 it is therefore reasonable that the minimization of heave pitch and vertical ship motions as well as accelerations exclusively at forward speed have been the main research objectives lewis 1955 investigated the influence of a forebody design on seakeeping performance in extreme weather conditions this paper experimentally compared the u shaped series 60 hull model with another model having the same main dimensions and buoyancy distribution but with extreme v shaped sections in the forebody swaan and vossers 1961 and swaan 1961 extended these tests in regular bow waves 10 and 50 off head seas comparing seakeeping performance of the original u shaped series 60 hull with three other models with differently v shaped bow sections and at two forward speeds bengtsson 1962 extended the test series with seven models for a larger range of forward speeds in regular head seas in 1965 he extended his series by further investigations of the influence of block coefficient and ballast draught condition on seakeeping performance bengtsson 1965 bales and cummins 1970 performed parametric seakeeping calculations in a relatively large study using seven parametrically altered design parameters adopted on a simplified hull design ewing 1967 performed numerical seakeeping analysis on the series 60 model which was continued and extended by yourkov 1973 and beukelman and huijser 1976 the progress in numerical calculations allowed loukakis 1975 to investigate seakeeping performance in head waves for seventy two hull forms for the extended series 60 design loukakis findings for heave pitch bending moment and added resistance are presented as seakeeping tables allowing the linear interpolation of the results as function of principle hull characteristics froude number and sea state as a result of the presented studies it can be concluded that the ship length appeared to have a greater influence on seakeeping performance while the forebody section shape and the block coefficient showed a smaller influence on seakeeping performance beukelman and huijser 1976 generally local hull modifications show a minor impact on motion performance whereas the increase in hull length results in a noticeable increase in performance lloyd 1989 accordingly larger ships tend to be more comfortable than smaller ships and the increase in hull size will result in improved seakeeping performance seakeeping performance assessment must therefore be considered at an early stage in the design process before the major proportions and dimensions of the hull have been settled lloyd 1989 in more recent years the research focus has been rather on the optimization procedures of particular vessel designs than on the exploration of the designs parameters influence on seakeeping performance being the primary objective of the current study the influence of design parameters on ship motions has been a research topic in the past decades and is relatively well understood nonetheless norwegian offshore vessel designers are indicating strong interest in further investigations of the impact of vessel design characteristics on seakeeping performance in the context of offshore lifting operations roll and pitch are generally most critical motion components while vertical motion components can be compensated by the crane s automated heave compensation system horizontal crane tip motions as a result mainly from roll cannot be compensated and limit operability especially during the lift in air phase the focus of this work is on the systematic presentation of the influence of design parameters on roll at zero ship speed to identify and benchmark mission oriented seakeeping performance for this purpose the percentage operability and the operational robustness index ori introduced by gutsch et al 2016 2017 will be utilized both performance parameters are suitable for the identification and benchmarking of mission oriented vessel capabilities related to a selected motion parameter sea area and season a comparison between the two parameters will be presented and the differences in application and analysis will be discussed based on selected results from a large database of motion transfer functions of parametrically re sized geometric similar vessel designs the basic hull geometry is provided by a ship designer representing a typical modern offshore construction vessel in operation since 2014 the origin of this design is agreed to be confidential however the complete rao database can be used for further investigation and is accessible online by using the vessel response tool freely accessible on vrt sintef no 2 assessment of operational performance marine operations especially walk to work w2w and lifting operations over the vessel s hull side require a specialized vessel designs with high operability dnv gl s offshore standard for marine operations states a marine operation shall be designed to bring an object from one defined safe condition to another dnv gl 2011 the term safe condition refers to a condition in which the object is exposed to the same level of risk for damage or loss as in the in place condition however between those safe conditions the object will be exposed to movements and water impact forces which must not exceed a maximum tolerable level defined in terms of motion limitation criteria such as motion displacements velocities or accelerations information on motion limitations or non exceedance criteria are used for vessel operability analysis together with weather hindcast data leading to a determination of the vessel s operability often also referred to as seakeeping theperformance vessel operability is defined as the ability to carry out the vessel s mission safely while the environmental impact represented by the waves degrades this operability compared to the calm water condition in order to optimize operability vessel motions must be minimized lower vessel motion levels will be achieved by moving natural periods of vessel motions outside the range of typical wave periods encountered in the sea area of interest and by increasing the damping effectiveness an example of an effective damping device to reduce roll motions are bilge keels the overall purpose of seakeeping optimization is to reduce the vessel s sensitivity to environmental conditions therefore increasing operability availability and safety towards year round offshore operations to evaluate of vessel operability a study of wave induced vessel response characteristics is essential as an example lifting operability will be optimized by minimizing crane tip motions generally it can be differentiated between vessel motions excited by first and second order wave forces while second order forces leading to drift motions can be substantially minimized by a well tuned dynamic positioning dp system motions excited by first order wave forces cannot be completely suppressed horizontal and vertical motions in the wave period frequency range are mainly caused by the vessel s heave roll and pitch motions and can be minimized by well chosen design parameters which will be further addressed although roll motions can be efficiently reduced by damping devices such as bilge keels and roll reduction tanks rrts which on one hand are a well proven strategy to reduce unwanted roll motions for w2w operations on the other hand however free surface rrts reduce vessel stability due to the effect of the free surface the use of those highly efficient roll damping devices might be a risk during the execution of marine operations directly affecting the vessel s stability such as offshore lifting or anchor handling operations the stability reduction due to a rrt has most likely been one of the leading reasons to the capsizing accident of the ahv bourbon dolphin analyzed by lyng et al 2008 furthermore response optimization can be achieved to some degree by particular hull shapes with a reduced water line area such as specialized multihull designs examples being small waterplane area twin hull swath and semi submersible designs yet those specialized vessels are rather rare exceptions among offshore vessels and will not be further discussed 2 1 phases of a lifting operation a subsea crane operation over the vessel s hull side can be divided into five operational phases summarized in table 1 each phase is associated with specific hazards which have to be identified during the planning process and evaluated during vessel design and selection to be kept within acceptable limits generally horizontal crane tip displacements and periods are more critical during lift off and object in air lift while relative vertical velocities and accelerations may be critical in the splash zone the lift through the water column may become critical especially for deep water operations due to the elasticity and the weight of the lifting line the longer crane wire will affect the natural vertical period of the crane system the accordance of this natural period with for example the roll period must be avoided finally an accurate dp system and a limited absolute vertical velocity at crane tip position is required to allow the object to be safely positioned and landed on the seabed 2 2 seakeeping analysis a seakeeping analysis is based on the detailed knowledge of the planned operational task mission requirements as illustrated in fig 1 define the starting point of an operability analysis for the design or the selection of a suitable vessel information on the required payload the ship speed the motion limitation s the preferred wave heading and the expected weather must be available the required payload determines the vessel s mass distribution and will affect its hydrostatic properties and thus its response characteristics in waves the combination of the wave spectrum expected at the sea area and season of interest with the general vessel response characteristics leads to the actual vessel behavioral response a comparison with mission dependent motion limitations including possible limitations based on sensitive on board equipment leads to the overall vessel seakeeping performance besides technical aspects contributing to seakeeping performance the evaluation of human factors including crew competence organization and safety components will complete the analysis the individual calculation steps towards a seakeeping performance value such as the percentage operability percop or the operational robustness index ori are shown in fig 2 by using the hydrodynamic characteristics of the hull including mass distribution wave heading and ship speed the transfer function of the hull motions characterized by the response amplitude operator rao and phase angle can be determined for the current study the raos are calculated with sintef ocean s vessel response calculation software veres based on linear strip theory salvesen et al 1970 fathi 2017 assuming linear behavior the harmonic excitation of the vessel due to a wave of the frequency ω yields a phase shifted harmonic response of the same frequency the rao describes the ratio between the response output signal s j ω and the wave excitation input signal ζ ω for each six degrees of freedom 6dof motion mode j circular wave frequency ω and heading β this motion transfer function provides a full correlation of the hydrodynamic motion characteristics for a defined heading β and ship speed in regular waves 1 h j ω β s j ω β ζ ω the raos determined within the current study accounted for viscous roll damping due to frictional shear stress on the hull surface kato 1957 eddy damping ikeda et al 1977a and lift damping from pressure variation along the naked hull himeno 1981 damping contributions from bilge keels due to normal forces ikeda et al 1976 and hull pressure created by the presence of the bilge keels ikeda et al 1977b the damping contribution of a typical bilge keel size being a third of the hull length l h u l l 3 by 30 cm width is assumed at zero speed wave radiation damping is obtained from analysis of each single strip contributions of non linear damping effects are included using a significant wave height of 2 m to linearize the non linear roll damping component according to the recommendation by dnv gl for the north sea and north atlantic the jonswap joint north sea wave project wave spectrum with a variable peakedness parameter γ describing both steep wind driven and longer swell dominated waves is used dnv gl 2017 section 3 5 5 5 once the suitable sea state spectra s ζ ω t p with the associated range of peak periods are established the stochastic analysis begins with the determination of the desired response spectra s j ω β t p by multiplying the sea state spectra by the squared absolute value of the rao for each mode j 2 s j ω β t p h j ω β 2 s ζ ω t p from the area enclosed by the response spectra standard deviation σ j β t p and significant double amplitudes η j s β t p for the individual heading β are determined 3 σ j β t p 0 s j ω β t p d ω 4 η j s β t p 4 σ j β t p finally the maximum tolerable significant wave height h s t o l t p can be calculated by multiplying the maximum tolerable motion criteria σ j t o l with the ratio of the significant wave height and the values obtained from eq 3 5 h s t o l β t p σ j t o l h s σ j β t p by comparison of the maximal tolerable wave height h s t o l β t p for the individual heading β with the wave scatter diagram from a defined sea area and season the percentage operability p o p β can be determined for the selected heading generally percentage operability expresses the percentage of the time where the vessel can satisfy the maximum tolerable operability limitation criteria o p t o l m a x for a given sea state described by h s and t p the minimization of roll motions is a major objective during offshore vessel design for the vessel design as well as in the scenario of a vessel selection process during operational planning the selection of a correct quantitative motion limitation value is less important than the general capability of the vessel to show high operability even for low and thus strict motion limitations to satisfy this characteristic the operability analysis will be performed for several motion limitations between zero and a maximum limit this allows to create a curve showing percentage operability performance p o p evolving between zero and the specified maximum tolerable operational limit o p t o l m a x as indicated by the large graph on fig 3 based on the initial steepness of the curve the vessel with the highest operability for strict motion limitations can be identified generally the steeper the curve showing a higher gradient the better the global performance for this analysis the maximum tolerable operational limit can be chosen rather freely but must be kept constant throughout the complete benchmarking process for the analysis of roll performance this can be a maximum tolerable root mean square rms value for roll of 1 or even 2 fig 3 shows an example that the roll limitation criterion of 2 0 rms leads to an absolute percentage operability percop of about 100 for all variations of gmt during north sea summer season while the initial steepness of the compared loading condition indicates different motion sensitivity levels on smaller waves the new operability robustness index ori is introduced as eq 6 to express the global performance of a ship for a selected motion criterion the ori is expressed as a single benchmark parameter by the dimensionless ratio of the area enclosed by the curves on the large graph in fig 3 exemplarily indicated by the gray area below the red curve and the maximum theoretically possible operability which is be equivalent to the product of o p t o l m a x and 100 operability indicated by the black dashed rectangular line the small graph on fig 3 represents the development of the ori over the motion limitation extracted from the large percentage operability percop graph 6 o r i 0 o p t o l m a x p o p o p t o l d o p t o l o p t o l m a x 100 for the quantification of response based operability this new performance parameter was first introduced by gutsch et al 2016 and is used by gutsch et al 2017 and sandvik et al 2018 in comparison to the absolute percop value the use of the ori has clear advantages for benchmarking of the relative response performance of different vessel designs since the ori includes the evaluation of the percop for a specified range of operational limits including low and hence strict values the result of the performance assessment is less dependent on the choice of the maximum allowable limitation value for this reason the ori provides a broader view on response based vessel performance therefore complementary to the percop the ori is perceived as a quality index for vessel performance in waves with respect to a selected motion criterion and is therefore perfectly suitable as key performance indicator kpi for seakeeping performance 3 parametric design variation a parametric investigation utilizing the geometry of a modern offshore construction vessel ocv design is conducted the applied geometry is scaled to five different hull lengths l h u l l between 80 m and 160 m for these parent hull geometries of five different hull length l h u l l the beam b 0 is adapted to represent a realistic average length to beam ratio l h u l l b 0 as found to be typical for ocvs of each corresponding length for this reason the length dependent l b ratio of fifty currently operating ocvs of hull lengths between 67 m and 180 m is analyzed the following polynomial formulation is found 7 b 0 1 6 762 1 0 5 l h u l l 2 730 1 0 2 2 627 l h u l l the hydrodynamic characteristics of the initial vessel designs with average length to beam ratio l h u l l b 0 are indicated in table 2 based on the initial vessel designs with five hull lengths and the typical beams b0 derived from eq 7 as indicated in table 2 the actual beam b is increased and reduced in steps of one meter to a range of plus minus three meters resulting in a set of 35 different hull sizes as shown in table 3 for each of the 35 hull designs the roll response amplitude is analyzed for nine draughts d between 5 m and 9 m and nine transverse metacentric heights gmt between 1 m and 5 m see fig 4 resulting in a database of 2835 response amplitude operators raos for geometrically similar vessel designs since the height of the metacenter is defined by the cross sectional geometry of the vessel the vertical center of gravity vcg is adjusted in order to achieve the desired gmt value the distribution of mass in transverse mass moment of inertia for roll r 44 0 35 b e a m and longitudinal mass moment of inertia for pitch r 55 0 25 l p p length between perpendiculars direction is kept constant for all vessel designs all parameters are treated as isolated variables by taking into account their relation and dependency on other vessel parameters which are adapted as shown in table 4 the ranges of the parameter variations from lowest to highest intentionally exceed their typical ranges for ocvs especially for gmt the isolated variation of single parameters irrespective of its subsequent physical relationship to other parameters might be an academic approach with vessel particulars which are not always applicable in a real vessel design however it provides the researcher with a method to identify important parameters that influence operability the dependencies of the altered parameters on other vessel characteristics are shown in table 4 a variation of the mass moment of inertia for roll r44 and pitch r55 is not carried out since the controllability of this value is usually very limited in practical operation nevertheless results from a small parametric study for r44 are published by gutsch et al 2016 2017 4 analysis of roll amplitude the seakeeping performance of geometric similar offshore vessel designs is analyzed to investigate the influence of the variation of hull length l beam b draught d and transverse metacentric height gmt in the north sea 56 52n 3 24e and north atlantic 65 29n 7 32e both during the winter and summer seasons as environmental information metocean hindcast data obtained between 1958 and 2016 provided by the norwegian meteorological institute is used the performance is benchmarked in terms of percentage operability percop and the operational robustness index ori all results presented in this chapter are calculated based on vessel motion characteristics at zero speed further a wave heading of 30 corresponding to bow quartering seas 1 1 in veres a wave heading angle of 0 corresponds to head seas 90 corresponds to beam seas and 180 corresponds to following seas and a limiting roll angle of 0 5 1 0 and 2 0 root mean square rms are exemplarily chosen for the analysis in practical day to day work the limitations should be evaluated individually according to the requirements of the specific offshore operation the wave heading of 30 off bow represents a typical situation during an offshore lifting task or a w2w operation the choice of this wave angle is considered although a wave angle of 15 corresponding to almost head seas could be preferred in practical operations to minimize roll and still provide favorable wave shielding effects for e g the splash zone area however to simplify the calculations a long crested wave spectrum is chosen for the analysis therefore the slightly larger wave angle of 30 shall provide slightly more roll response and account for a potentially more scattered wave energy spreading in real sea conditions the choice of the long crested sea spectrum is based on practical reasons due to the comparative nature of the study main focus is placed on the comparison of relative results between the different designs with the objective to provide understanding of influencing factors allowing a better identification of favorable vessel design parameters for this purpose the long crested sea spectrum is regarded as more appropriate than a short crested directional wave spectrum which would rather allow the best possible modeling of real sea conditions but also involves further influencing factors which must be taken into consideration in the analysis of the results in order to limit the amount of results a reduced set of results with the most relevant variations is selected the interested reader is invited to perform further analysis using the online vessel response tool freely available on vrt sintef no 4 1 presentation of results the results for the variation of length fig 5 beam figs 7 and 8 draught figs 10 and 11 and gmt figs 13 and 14 are illustrated by the percop red graph 2 2 for the representation of the results in coloured figures please refer to the open access web version of this article related to primary ordinate and the ori blue graph 2 related to secondary ordinate for both performance benchmarks the same roll angle limitation criteria are used for each limitation criterion a set of five curves that show the results of the different hull lengths over the related parameter as indicated below the abscissa the related hull lengths are indicated for the variation of beam by arrows figs 7 and 8 whereas for the variation of draught and gmt each hull length is presented separately in a sub diagram figs 7 8 10 11 13 and 14 additionally the results are visualized as color maps 2 indicating the numerical variation of the investigated parameters for the 2 rms roll angle limitation criterion these color maps are shown for the variation of length in fig 6 for beam in fig 9 for draught in fig 12 and for gmt in fig 15 as in the diagrams the color maps show the results obtained during winter season in north sea and north atlantic in a table like presentation for each altered vessel parameter per rows while in columns on the left side the absolute value for the percop and the ori are shown followed by the mean value and the spreading of the results for each vessel length finally on the right side the deviation that means the relative difference of the mean value is presented the definition of the color code is indicated in the legend below and can be summarized as followed from left to right side the color code 2 behind the absolute value indicates the level of the result above 75 for percop and 0 5 for ori in green and below that value in red a fully developed green color indicates a value approaching 100 for percop or 1 0 for ori respectively a fully developed red color indicates a value of 50 or lower for percop and approaching 0 0 for ori the color scale is selected individually to best represent the deviating levels of the result the color bar behind the mean value and the spread shows the percop in red for its range between 0 and 100 and the ori in blue for its range between 0 and 1 the color code behind the deviation to the mean value indicates the level of an increase above 0 for percop and 0 0 for ori in green and decrease below that value in red a fully developed green color indicates a deviation to the mean of 25 for percop and 0 2 for ori a fully developed red color indicates a deviation to the mean of 25 for percop and 0 2 for ori again the color scale is selected individually to better present the deviating levels of the result the individual levels for the color codes are selected according to the general range of the presented results and since an increase or decrease of 20 to 25 indicate a significant performance gain or loss compared to an average value and will considerably influence vessel performance 4 2 winter season versus summer season the analysis of the vessel performance during winter versus summer season shows a significant increase in roll performance expressed in terms of percop and ori during the summer season figs 5 7 8 10 11 13 and 14 the absolute difference between the highest and lowest performance is nominated as spread in fig 6 it is larger for the season and area with the roughest weather condition which generally is north atlantic and winter season while it is significantly smaller during summer season when the performance characteristics are generally adequate for all vessels this is especially observed in the analysis of the percop while the ori is still capable of indicating the differences between the designs the percop value converges against 100 and is not capable of indicating performance variations this is related to the fact that the percop indicates the absolute performance for the chosen limitation criterion therefore the percop value approaches a value close to 100 during the summer season almost regardless of the vessel s capabilities during the winter season this is the case for the percop value when calculated for a fairly calm environmental condition such as encountered during summer season and or for a rather large motion limitation such as the 2 rms roll value or higher therefore if the result for the percop approaches 100 representing the maximum achievable value for percop a proper performance assessment and benchmarking of the deviating vessel designs becomes impossible in comparison to the percop the ori accounts for the development of the percop on its complete course of this behavior between zero and the chosen maximum motion limitation therefore the ori behaves qualitatively similar but approaching its maximum possible value of 1 0 slower consequently the ori allows vessel performance assessment to be more independent of the chosen environmental condition and level of limitation criteria aiming for year round offshore operations a design optimization focusing on the improvement of operability during the winter season is required therefore this research will mostly focus on the analysis of design dependent results for percop and ori during the winter season 4 3 north sea versus north atlantic as a general remark it can be stated that roll performance results expressed in terms of percop and ori are higher in north sea than in the north atlantic independently of the investigated vessel design the comparison between north sea versus north atlantic winter season indicates that the north sea has a larger increase in roll performance for shorter vessels between 80 m and 100 m hull length while this increase is reduced for longer vessels between 140 m and 160 m fig 5 the results analyzed for the north atlantic however show with a larger operability gain for longer hull lengths being the opposite behavior this may be an indication that in a more holistic cost benefit evaluation process an optimal seakeeping performance may be identified for hull lengths which are in most cases generally shorter in the north sea than in the north atlantic however a more detailed analysis of the influence of specific design variations indicates deviating behavior due to the different dominating wave peak period tp as discussed in section 4 7 4 4 variation of length for most of the results roll performance is improving with larger hull lengths l h u l l and vessel displacements as shown in fig 5 this tendency is expected since for each length a common length to beam ratio l h u l l b 0 is chosen to satisfy the demand for using typical vessel dimensions as described in section 3 therefore the beam b 0 is adopted as a length dependent parameter and is increased according to eq 7 the main vessel parameters for the variation of length are indicated in table 2 generally a larger vessel is expected to show less roll amplitude than a smaller vessel in a similar sea state therefore it can be expected that the larger vessel and therefore the more expensive vessel will show an increase in operability exceptions to this general rule will be a focus of this investigation and can be found especially for the variation of beam section 4 5 and the variation of gmt section 4 7 4 5 variation of beam favorable results in terms of percop and ori are found in the variation of beam as well for small vessel beams and shorter hull lengths in the north sea for l h u l l 80 m and the north atlantic for l h u l l 100 m as well as for large vessel beams and larger hull lengths in the north sea for l h u l l 100 m and in the north atlantic for l h u l l 120 m figs 7 and 8 this means that for example during the north atlantic winter season the percop for the 2 rms roll criterion of an 80 m vessel with a beam of 15 3 m is around 80 and cannot be amplified by increasing the hull length unless the hull is at least 140 m long and has a beam of more than 29 m this tendency is strongest during the winter season in the north atlantic and is less pronounced during the winter season in the north sea and even more reduced during the summer season figs 7 and 8 comparing the impact of the variation of beam in terms of deviation to its mean value of the individual length the largest increase in percop of 13 5 absolute 84 6 in north sea and 26 0 absolute 80 1 in north atlantic is found for the short vessel design with l h u l l 80 m and b 15 3 m the shortest vessel also shows the largest spread of percop results within the same hull length of 18 7 for north sea and 37 8 for north atlantic for the 2 rms roll limitation criterion whereas the results for the ori are not showing a similar large spread in the results for the shortest hull length especially the influence of the beam variation in the north sea shows less spread for shorter hull length indicating that the results for a more restrictive limitation criterion might be better for wider hulls given that gmt can be kept small in the north sea the ori value shows that for the 80 m vessel an especially narrow and wide vessel will be favorable while in the north atlantic the narrow hull of this hull length performs clearly better than the wide hull this behavior is opposite for l h u l l 100 m in the north sea and l h u l l 120 m in the north atlantic from the results for the variation of beam it can be seen that the information value of percop as performance indicator highly depends on the choice of the level for the maximal acceptable limitation criterion this can be acceptable if a vessel will be selected for a certain operational task however for design purposes the ori provides a more general limitation criterion less dependent on the limitation criterion level nevertheless the results of both benchmarking criteria especially for intermediate hull lengths are dependent on the choice of the specific sea area providing a certain wave energy spectrum for individual peak periods commonly the results of the beam variation show that typical length to beam rations for offshore vessels as used for the mid range settings shown in table 2 show rather unfavorable seakeeping performance 4 6 variation of draught the variation of draught is performed for all ship lengths corresponding a draught range between 5 m and 9 m in 0 5 m steps generally the variation of draught shows minor impact on percop and ori a slightly beneficial performance is found for large draughts at shorter hull length l h u l l 100 m and thus smaller beam values b 0 21 30 m as well as for low draught for longer hull length l h u l l 120 m and thus larger beam values b 0 24 30 m figs 10 and 11 the largest spread in terms of percop of about 14 9 can be found in the results for the north atlantic for the 80 m long vessel design fig 12 the impact of draught variation on roll performance is rather small for the medium sized hull designs of 100 m and 120 m hull length the results for the ori are in accordance with the results for the percop in contrast to the variation of beam and gmt the draught variation has no influence on the vessel s natural roll period and thus shows similar results for both sea areas the variation of draught will rather influence roll damping due to minor viscous and more considerable added mass effects especially the larger roll reduction for smaller draught and longer and wider vessel designs can be explained by increased added mass effects similar to a catamaran a flat and wide cross sectional shape may induce more vertical than rotatory motions at the outside hull area therefore the heave like motion component may increase roll damping due to added mass effects for low draught at larger beams it may be noted that for the variation of draught the vertical center of gravity vcg is adjusted to keep a constant gmt as indicated in table 4 4 7 variation of metacentric height the variation of metacentric height gmt is performed for all ship lengths for gmt values between 1 m and 5 m in 0 5 m steps the gmt level is strongly affecting the vessel s roll period and shows thus a strong influence on roll performance in terms of perop and ori in the analyzed sea areas figs 13 and 14 to obtain small roll angles generally a small gmt value resulting in a longer roll period with soft motion characteristics as well as a large gmt value resulting in a shorter roll period with stiff motion characteristics is favorable the unfavorable region of low performance gmt is shifting from smaller gmt values of around 2 0 m for shorter vessel designs 80 m to larger gmt values of around 4 0 m for longer vessel designs 160 m fig 15 the results of percop for the vessel design with g m t 4 5 m are marked in figs 13 and 14 by color coded circles referring to the similar colored raos shown in fig 16 especially the results analyzed for the north atlantic winter season indicate for the shortest hull length l h u l l 80 m a significantly better roll performance than for the larger vessel l h u l l 160 m with the same gmt value the corresponding absolute percop values can be found additionally in fig 15 see column showing results for g m t 4 5 m an explanation for this atypical result is indicated in fig 16 showing the raos for the five corresponding vessel designs in relation to the wave occurrences shown as accumulation of hs per tp over the wave peak period tp this presentation indicates that the sensitive period of the maximal response amplitude of the small designs is clearly distinct from the dominating wave periods observed during the north atlantic winter season while this is not the case for the analysis performed for the north sea winter season hence the roll response amplitude of the smaller vessel is favorable above the large vessel operating during the north atlantic winter season it has to be noted that there are existing stability requirements limiting small gmt values not allowing it to fall below a value in an order of around 1 0 m considering g m t 1 5 m it can be concluded that shorter vessels l h u l l 120 m show a higher operational performance for larger gmt values g m t 4 5 m and large vessels l h u l l 140 m show a higher operational performance for smaller gmt values the influence on maximal tolerable accelerations of a softer versus a stiffer vessel must be further evaluated 5 summary the selection and optimization of a vessel design to perform a specific offshore operational task considering costs and operational aspects is not straightforward and requires detailed comparative operability analyses however according to information provided by offshore vessel designer s today s common practice is to perform seakeeping analysis for the approval of a final design only although it might be expected that roll amplitudes of a larger vessel will be smaller and hence more favorable than those of a smaller vessel this study shows that this assumption is not always true a key aspect of a design process should be the mission dependent optimization of hull dimensions including loading condition parameters aiming for a design where natural periods of important responses such as pitch and roll are significantly different from the dominating wave periods this research focuses on the quantification of the relative impact of design variations on seakeeping performance at zero speed aiming for the identification of weather robust vessel designs as a requirement to operate safely in higher sea states for the identification and benchmarking of mission oriented vessel capabilities this research utilizes two seakeeping performance parameters the percentage operability percop and the newly developed operational robustness index ori the paper presents that a well established percop performance indicator is a suitable parameter for operational planning and vessel selection if all operational details are available while the ori clearly indicates advantages for design optimization during the early ship design process and for vessel selection in circumstances when operational limitations sea area or season are not specified as a consequence the ori can be judged as the more robust performance criterion since it is less sensitive to user input in this analysis the advantages of the ori are described in cases when seakeeping performance is generally good and when the percop value converges against 100 and hence does not indicate a generally better performing vessel while the ori remains capable of indicating differences in performance results of a parametric study of design characteristics indicate a significant influence on roll performance for the variation of hull length beam and metacentric height gmt whereas minor deviations for the variation of draught are found as a general result it can be concluded that seakeeping performance is often increasing with vessel dimensions however this rule does not necessarily apply to the selection of beam and gmt parameters as an example from the results of the beam variation during north atlantic winter season favorable seakeeping performance is found for small vessel beams and shorter hull length as well as for large vessel beams and larger hull length to further illustrate this the roll performance of an 80 m vessel with a beam of 15 3 m is around 80 and cannot be improved by increasing hull length unless the hull is at least 140 m long and has a beam of more than 29 m similar to the choice of the hull beam the choice of the vertical center of gravity and hence gmt is strongly influencing the vessel s roll performance favorable results are found for both small and large gmt values whereas for ocvs often adopted gmt values of 2 m to 3 m show an unfavorable roll performance and thus larger roll angles the advantage of a larger gmt value is more pronounced for shorter hull length which is resulting in the fact that the shortest hull length of 80 m with a gmt parameter of 4 5 m performs significantly better than the largest vessel of 160 m length with the same gmt value as an explanation of this phenomenon it is indicated that in such cases the peak period for the maximum amplitude of the response amplitude operator rao for roll clearly differs from the peak period of the dominating wave energy due to the large amount of data generated in this research project the presented study is limited to the analysis of the impact of hull length beam draught and gmt variation on seakeeping performance utilizing the roll amplitude criterion at zero speed and 30 wave heading therefore the interested reader is invited to perform further analysis using the vessel response tool for free online available on vrt sintef no 6 conclusion the study has shown that vessel size is not always the decisive parameter for the determination of seakeeping performance therefore the simple rule bigger is better does not apply in all cases the findings on the variation of beam and gmt show that commonly adopted values are rather unfavorable regarding roll performance therefore a significant potential for the minimization of the vessel s roll amplitude and thus the improvement of seakeeping performance is given this potential must be used for design optimization and will contribute to increased operability towards year round offshore operations as well as to cost reductions of offshore installation and maintenance services as benchmarking parameter this investigation utilizes a novel seakeeping performance indicator the operability robustness index ori and compares its application with the widely known percentage operability value the comparison of these two performance indicators clearly indicate the advantage of using the ori for seakeeping optimization the ori can be judged as the more robust performance indicator identifying improvements in seakeeping performance for a selected sea area more correctly independently of the magnitude of the limitation criterion additional to the results presented the reader is invited to further explore the ori as seakeeping performance criterion for offshore vessels using the vessel response tool accessible for free on vrt sintef no credit authorship contribution statement martin gutsch conceptualization methodology formal analysis investigation writing original draft writing review editing visualization sverre steen supervision writing review editing florian sprenger supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was made possible through the centre of research based innovation sfi move financially supported by the norwegian research council nfr project number 237929 and the consortium partners http www ntnu edu move 
21417,a marine riser operated in deepwater could encounter harsh environmental conditions and exhibit complex vibration phenomena which require thorough investigation especially using nonlinear geometric diagnosis the aim of this paper was to propose a theoretical formulation for undertaking large amplitude vibration analysis of a deepwater marine riser conveying oscillatory internal fluid flow the work energy principle based on virtual displacement was utilized to formulate the riser mathematical model accounting for internal strain energy and external work done the geometric nonlinearity of the riser regarding extensible elastica theory was considered which accounted for axial stretching and the large deformed curvature of the riser the finite element method was utilized to form the equation of the motion system for solving numerical solutions based on taylor s series expansion the stiffness matrices with second order nonlinear dynamic displacements of the riser were regarded in the equation of motion the hydrodynamic ocean force modeled in terms of the squared riser velocity also yielded the nonlinear hydrodynamic damping matrix the inertial force initiated by the pulsatile flow of transported fluid was taken into account as a harmonic oscillation representing the pump operation performing the newmark time integration incorporated direct iteration on the equation of motion provided the nonlinear vibration response a thorough parametric study was accomplished which investigated the influences of geometric nonlinearity the forcing frequencies of a hydrodynamic wave and an internal pulsatile flow on the large amplitude dynamic response characteristics of a deepwater riser keywords elastica theory finite element method internal pulsatile flow large amplitude vibration marine riser nonlinear geometry 1 introduction in offshore petroleum drilling and production processes the marine riser which is a slender vertical pipe has been used as equipment for conveying crude oil from the seafloor up to a storage or production unit on the sea surface sparks 2007 in addition to its own weight particularly for deepwater operations the riser will also probably confront progressive hydrostatic pressure violent ocean current and wave forces and large varying axial tension along the riser length chen et al 2012 these environmental loadings exerted on a marine riser system with geometric nonlinearities will lead to complex vibration phenomena such as large amplitude vibration klaycham et al 2014 klaycham et al 2017 klaycham et al 2018 internal pulsatile flow and severe slugging induced vibration monprapussorn et al 2007 cabrera miranda and paik 2018 onuoha et al 2018 and vortex induced vibration viv duan et al 2018 yuan et al 2018 in addition to such loadings klaycham et al 2020 studied vessel sway and heave induced riser motion by using application of the penalty method for the riser in three dimensions li et al 2018 also applied the vector form intrinsic finite element method to analyze the nonlinear dynamic of hanging riser caused by wave force and top end vessel motion these dynamic features are of interest to understand the riser structural behavior to prevent it undergoing fatigue failure from viv thorsen et al 2019 coupled sway heave motion of top end vessel and to control riser vibration hong and shah 2018 in addition the nonlinear geometry chatjigeorgiou 2008 regarding the response of the riser structure leads to an increase in the complexity of the dynamic analysis that requires a deep and comprehensive computational investigation the analysis of a deepwater riser operation begins with finding its static configuration however linear analysis with an assumption of small deflection may be inadequate from state of the art reviews over the past several decades many researchers have developed alternative model formulations and solution methods that capture a large displacement analysis of the riser chucheepsakul et al 2003 chai and varyani 2006 athisakul et al 2012 2014 gay neto et al 2014 beyond static analysis nonlinear dynamic analysis is necessary to consider the nonlinear environmental forces at least for the hydrodynamic ocean force which is nonlinear in nature and generates complex dynamic phenomena moreover different types of environmental loadings are always combined together to predict a realistic dynamic response of riser for example the response originated by viv pulsatile flow of transported fluid and top end excitation which can be found in bar avi 2000 monprapussorn et al 2007 srinil et al 2011 chen et al 2015 and lei et al 2014 these previous works presented the vibration response of the marine riser excited by combined environmental loads which was capable of reasonably describing nonlinear dynamic characteristics however their results published in the literature were based on the assumption of a small vibration amplitude many research works have provided various interesting specific problems concerning the internal unsteady flow or pulsatile flow of a transporting fluid monprapussorn et al 2007 presented the vibration response of a flexible riser conveying a pulsatile flow of transporting fluid in which the effects of constant acceleration the pulsatile frequency and the oscillatory amplitude of the internal fluid velocity bar avi 2000 ni et al 2014 mcdonald and sri namachchivaya 2005 on riser vibration characteristics are illustrated intensively dai et al 2014 presented the viv of a long vertical marine pipe carrying a pulsating flow their results demonstrated that for the lock in condition of a certain mode the internal pulsating flow has an evident influence on the vibration of the pipe only for the same mode of parametric resonance luo et al 2016 zhang et al 2017 however various issues have been presented continually in the available literature concerning pipe conveying pulsating flow related to a viscoelastic pipe model yang et al 2007 subharmonic resonance sri namchchivaya 1989 and the principal parametric and internal resonances of a pipe panda and kar 2008 among others as the marine riser is actually subjected to severe and complex dynamic loadings especially in deep water chung and cheng 1996 cheng et al 2018 meng et al 2018 the linearized vibration theory representing small amplitude vibration behavior may be insufficient monprapussorn et al 2007 takafuji and martins 2012 there have been few research studies regarding large amplitude vibration of the riser such as kaewunruen et al 2005 and klaycham et al 2017 but their studies were limited only to free vibration analysis of a riser in shallow water y h 300 m the solution for large amplitude forced vibration of a deepwater riser conveying a pulsatile flow has been not reported in such previous works this lack of study leads to interesting challenges regarding vibration characteristics with a nonlinear geometric effect consequently the main objective of the current work was to present an analysis of large amplitude forced vibrations of a deepwater marine riser conveying an oscillatory flow of transported fluid according to large amplitude vibration geometric nonlinearity using the nonlinear stiffness matrix based on taylor s series expansion is taken into account in the equation of riser motion the nonlinear loadings produced by the ocean current and wave forces are of concern which further yields the nonlinear hydrodynamic damping matrix the hydrodynamic added mass matrix and the time dependent force vector the oscillatory flow of the internal transported fluid is also taken into consideration for the excitation of external force the forced vibration response of the riser is calculated computationally by using the time domain approach based on numerical time integration newmark s method the contribution of the nonlinear geometric effect is assessed through comparative computations between the large amplitude vibration lav and small amplitude vibration sav analyses special attention is paid to the effects of a hydrodynamic wave and the unsteady flow of internal fluid on the nonlinear vibration responses of the riser 2 model formulation as a marine riser vibrates around its static configuration large displacement static analysis needs to be evaluated first when it is subjected to time independent loads athisakul et al 2002 this static configuration with a hinged hinged support condition is utilized as an initial position for the riser vibration analysis the theoretical model for static analysis used in this study was based on the variational model formulation proposed by chucheepsakul et al 2003 which can capture large displacement as shown in fig 1 the position deformation and kinematics of the riser are prescribed using the 2 dimensional cartesian coordinate system x y for an undeformed state the position vector of the riser is defined by r p o x o i ˆ y o j ˆ in which i ˆ and j ˆ represent the rectangular unit vectors in the horizontal and vertical directions respectively while x o and y o represent the horizontal and vertical undeformed positions along the riser length the riser top end is located at the coordinates x x h and y y h an appropriate tension n a h is applied to the top end of the riser to keep its equilibrium position according to imposed time independent loads the riser weight the buoyancy force the quasi static drag force caused by the hydrodynamic current as well as the centrifugal force induced by transported fluid flow the riser is moved to the static equilibrium position r p s x s i ˆ y s j ˆ the nonlinear finite element procedure was utilized for finding the numerical solution of the riser static configuration as presented in athisakul et al 2002 regarding vibration analysis the riser is excited by time dependent loads and displaced from a static state r p s x s i ˆ y s j ˆ to dynamic equilibrium positions as represented by a position vector r p x i ˆ y j ˆ in which x and y are the horizontal and vertical positions respectively 1a x x s u d 1b y y s v d the variables u d and v d are the dynamic displacements in the horizontal and vertical directions respectively which need to be calculated in the dynamic analysis procedure the detailed derivation of the model formulation is provided in the following subsections 2 1 excitation forces exerted on riser the excitation forces concerned in this study comprised 1 the inertial force caused by riser motion 2 the inertial force of internal transported fluid and 3 hydrodynamic forces of current and wave particles first the inertial force of riser motion is derived from newton s law of momentum conservation obtained by multiplying the riser mass m p and its acceleration similar to the inertial force of the riser the inertial force of the internal transported fluid is also calculated by multiplying the transported fluid mass m i and its acceleration based on eulerian mechanics the absolute acceleration of the internal transported fluid can be derived and expressed in terms of riser geometry separated into components in the horizontal a f x and vertical a f y directions as huang 1993 2a a f x u d 1 2 s s x s 2 s s 3 u d x s s s 3 v d v i s 2 κ s s s v i s 2 3 x s s s d v i d d t 4 2b a f y v d 1 x s s s 3 u d 2 s s 1 s s 3 v d v i s 2 κ s x s s s v i s 2 3 1 s s d v i d d t 4 each term in eq 2 could contribute to 1 the initial transported fluid mass force 2 coriolis damping force 3 centrifugal force and 4 unsteady flow induced excitation force respectively where these forces are proportional to the transported fluid mass the prime and dot notations associated with the parameters in eq 2 represent the derivatives with respect to the parameters y s and time t respectively which are utilized entirely in this article the variables u d and v d are the horizontal and vertical acceleration respectively of the riser κ s and s s are the initial static curvature and the differential arc length respectively of the riser in the static equilibrium state bar avi 2000 which can be expressed as 3a κ s x s 1 x s 2 3 2 3b s s 1 x s 2 as shown in eq 2 the absolute acceleration of the transported fluid is contributed by its velocity which is composed of two parts quasi static part v i s and a dynamic part v i d the dynamic part is prescribed by the expression bar avi 2000 4 v i d a i o t v i a cos ω i t in eq 4 the first term represents the transient state where t is the time variable and a i o is the constant acceleration of fluctuation velocity the second term is representative of a pump that generates an oscillatory flow in which v i a and ω i are the velocity amplitude and fluctuation frequency of the transported fluid respectively the hydrodynamic wave force is calculated based on the morison model morison et al 1950 this force includes three components the added mass force the hydrodynamic damping force and the hydrodynamic excitation force to this end the extended morison hydrodynamic forces in the x and y directions are provided by chucheepsakul et al 2003 5 f h f h x f h y c a 0 0 c a u d v d added mass force c e q x c e q x y c e q x y c e q y u d v d hydrodynamic damping force c d x v h x 2 c m v h x c d x y 1 v h x 2 hydrodynamic excitation the hydrodynamic force provided in eq 5 consists of three terms the added mass force the hydrodynamic damping force and the excitation force which further contribute to the mass matrix damping matrix and excitation force vector of the riser system respectively the variables c a ρ e a e c a and c m ρ e a e c m are the coefficients of equivalent added mass and inertia forces respectively c a is the added mass coefficient c m c a 1 is the inertia coefficient ρ e is the density of seawater d e is the outer diameter of the riser and a e is the cross sectional area of seawater replaced by the riser the symbol v h x is the hydrodynamic velocity which is comprised of the horizontal current velocity and the wave velocity as 6 v h x v c v w where v c is the current velocity which depends on the vertical coordinate the profile of the current velocity monprapussorn et al 2004 can be expressed in a polynomial function as 7 v c v c h y s y b y h y b n the symbol v c h is the current velocity at the mean sea level and the parameters y b and y h are defined in fig 1 in this study the index n 1 7 is used for the tidal current profile in the numerical investigations the oscillatory wave velocity v w is a function of the vertical coordinate and the time which can be expressed as 8 v w v w a cos ω w t where ω w is the wave frequency the velocity amplitude of the wave particle v w a v w a y s is varied exponentially along a vertical coordinate which can be expressed as 9 v w a ζ a ω w e k y s y b y h y b in which ζ a denotes the wave amplitude k ω w 2 g is the wave number and g is the gravitational acceleration referring to eq 5 the detailed derivation of the coefficients of equivalent hydrodynamic damping force c e q x c e q y c e q x y and the coefficients of equivalent drag force c d x c d x y 1 can be seen in chucheepsakul et al 2003 it should be noted that the variables c e q x c e q y and c e q x y are nonlinear terms arising from the square of the relative velocity between seawater and the riser 2 2 large amplitude equation of motion the mathematical model capable of capturing the large amplitude motion of the riser is formulated based on a variational approach using the principle of virtual displacement the total virtual work formulation is composed of virtual strain energy and external virtual work first the virtual strain energy due to axial stretching and bending deformation of the riser system is given by 10 δ u 0 y h n a δ ε b κ κ s δ κ s s d y s it should be noted that throughout this study the prime notation represents the derivative with respect to the variable y s the symbol b e i p is the bending rigidity e and i p are the elastic modulus of the riser material and the moment of inertia of the riser respectively from eq 10 the expression for axial tension n a is given by 11 n a n a s e a p ε d the symbol a p is the cross sectional area of the riser as shown in eq 11 the axial tension consists of two parts the static tension n a s and dynamic tension e a p ε d however concerning large amplitude motion keeping the nonlinear terms the nonlinear dynamic axial strain ε d used in this present work can be expressed based on the updated lagrangian descriptor monprapussorn et al 2007 as 12 ε d 1 s s 2 x s u d v d u d 2 2 v d 2 2 where s s is the differential arc length of the riser at static state as given in eq 3b performing the variation to eq 12 the virtual dynamic axial strain is expressed as 13 δ ε d 1 s s 2 x s u d δ u d 1 v d δ v d with large amplitude motion the exact curvature κ at dynamic state accepting elastica theory can be given as 14 κ x y x y s 3 x s u d 1 v d x s u d v d s 3 in which s is the differential arc length of the riser at the dynamic state as given by 15 s x 2 y 2 x s u d 2 1 v d 2 applying the variation to eq 14 one obtains the virtual dynamic curvature as 16 δ κ 1 s 2 y s δ u d x s δ v d y s 3 κ x δ u d x s 3 κ y δ v d substituting eqs 11 16 in eq 10 the virtual strain energy of the riser can be rearranged into the form δ u 0 y h n a s e a p ε d s s x s u d δ u d 1 v d δ v d d y s 17 0 y h b κ κ s s 2 y s δ u d x s δ v d y s 3 κ x δ u d x s 3 κ y δ v d s s d y s external virtual work of the riser system includes the work produced by the effective weight w a the initial forces of the riser m p u d m p v d the internal transporting fluid motions m i a f x m i a f y and the hydrodynamic force f h x f h y which is expressed as 18 δ w 0 y h f h x m p u d m i a f x δ u d w a f h y m p v d m i a f y δ v d s s d y s where m p and m i are the mass per unit length of the riser and internal fluid respectively the detailed derivations of the external forces in eq 18 are provided in the previous subsection based on the work energy principle the total virtual work consists of the virtual strain energy and external work done δ π δ u δ w which is expressed using eqs 17 and 18 19 δ π 0 y h n a s e a p ε d s s x s u d δ u d 1 v d δ v d d y s 0 y h b κ κ s s 2 y s δ u d x s δ v d y s 3 κ x δ u d x s 3 κ y δ v d s s d y s 0 y h f h x m p u d m i a f x δ u d w a f h y m p v d m i a f y δ v d s s d y s to form a nonlinear equation for the motion of a riser the expressions of force in eqs 2 and 3 are utilized and replaced in eq 19 substituting eq 1 into eq 19 and expanding the nonlinear terms based on taylor s series two nonlinear governing equations of the riser vibration can be expressed by rearranging each term according to the order of nonlinearities as follows including horizontal and vertical dynamic equilibrium equations respectively as shown in eqs 20a and 20b 20a δ π x 0 y h n a s s s e a p s s 3 x s 2 u d e a p s s 3 x s v d δ u d e a p s s 3 3 2 x s u d u d 3 4 x s v d 3 4 u d v d δ u d e a p s s 3 u d 2 2 u d u d v d 2 v d δ u d b s s 5 u d x s v d δ u d b κ s s s 4 2 x s u s 1 x s 2 v d δ u d 3 2 b s s 5 x s v d v d 2 v d u d x s v d u d v d δ u d 2 b s s 5 v d 2 u d u d v d v d δ u d s s c a u d c e q x u d c e q x y v d c d x 2 v c v w v w 2 c m v w δ u d s s m p m i u d m i v i s 2 s s x s 2 s s 3 u d m i v i s x s s s 3 v d δ u d s s m i x s s s d v i d d t δ u d s s m i v i s 2 s s 2 u d δ u d d y s 0 20b δ π y 0 y h e a p s s 3 x s u d n a s s s e a p s s 3 v d δ v d e a p s s 3 3 4 u d 3 4 x s v d u d 3 2 v d v d δ v d e a p s s 3 u d v d 2 u d v d 2 2 v d δ v d b s s 5 x s u d x s 2 v d δ v d b κ s s s 4 1 x s 2 u d 2 x s v d δ v d 3 2 b s s 5 x s v d u d x s u d v d δ v d 3 2 b s s 5 x s u d v d x s v d u d u d 2 x s u d v d δ v d 2 b s s 5 u d v d u d u d 2 v d δ v d s s c a v d c e q y v d c e q x y u d c d x y 1 2 v c v w v w 2 δ v d s s m p m i v d m i v i s x s s s 3 u d m i v i s 2 s s y s 2 s s 3 v d δ v d s s m i s s d v i d d t δ v d s s m i v i s 2 s s 2 v d δ v d d y s 0 2 3 finite element formulation to form the nonlinear equation of motion and find the numerical solution the finite element method is applied in this procedure the riser model is divided into a finite number of elements along the vertical coordinate y s each element of the riser has an equal length along the vertical projection of l y h n e l e m in which n e l e m is an amount of discretized element the dynamic displacements u d and v d at any points of the riser within the element are calculated approximately using the shape function cook et al 2002 by separation of the variables the displacement vector u d can be expressed in terms of the element nodal degree of freedom vector d d and the shape function matrix n as 21 u d u d v d t n y s d d t where n and d d can be expressed as 22a n n 51 n 52 n 53 0 0 0 n 54 n 55 n 56 0 0 0 0 0 0 n 51 n 52 n 53 0 0 0 n 54 n 55 n 56 22b d d u 1 d u 1 d u 1 d v 1 d v 1 d v 1 d u 2 d u 2 d u 2 d v 2 d v 2 d v 2 d t where n 5 i is the component of the fifth degree polynomial shape function athisakul et al 2011 using an approximated expression of eq 21 and further applying the stationary condition π d d δ d d 0 to eqs 20a and 20b with some mathematical manipulations provide the nonlinear dynamic equilibrium equation capable of capturing large amplitude motion as 23 m d d c g d d k l k n 1 k n 2 d d f the equation of motion eq 23 is generally obtained by assembling the element equation where the operator i 1 n e l e m is used instead for its representation to this end the vectors d d i 1 n e l e m d d d d and d d are the nodal displacement nodal velocity and nodal acceleration vectors of the global system respectively the total mass matrix m the total hydrodynamic damping matrix c and total gyroscopic matrix g can be respectively expressed as 24a m i 1 n e l e m 0 l n t s s m p m i c a 1 0 0 1 n d y s 24b c i 1 n e l e m 0 l n t s s c e q x c e q x y c e q x y c e q y n d y s 24c g i 1 n e l e m 0 l n t m i v i s 2 x s 2 s s 2 x s s s 2 x s s s 2 2 1 s s 2 n d y s the total linear stiffness matrix is contributed from 25 k l i 1 n e l e m k l a k b 1 l k l b 2 in which their corresponding element matrices are calculated from the following integral expressions 26a k l a 0 l n t n a s m i v i s 2 s s 1 0 0 1 e a p s s 3 x s 2 x s x s 1 n d y s 26b k l b 1 0 l n t b s s 5 1 x s x s x s 2 n d y s 26c k b 2 l 0 l n t b κ s s s 4 2 x s 1 x s 2 1 x s 2 2 x s n d y s the total first order nonlinear stiffness matrix is assembled from its element matrix 27 k n 1 i 1 n e l e m k a 1 n 1 k b 1 n 1 in which their corresponding element matrices are 28a k a 1 n 1 0 l n t 3 4 e a p s s 3 2 x s u d x s v d u d x s v d u d 2 v d n d y s k b 1 n 1 0 l n t 3 2 b s s 5 0 0 x s v d x s u d n d y s 0 l n t 3 2 b s s 5 0 x s v d 0 x s u d n d y s 28b 0 l n t 3 2 b s s 5 2 v d x s v d u d x s v d u d 2 x s u d n d y s the total second order nonlinear stiffness matrix is formed by 29 k n 2 i 1 n e l e m k a 1 n 2 k b 1 n 2 the above element matrices in eq 29 are 30a k n 2 a 1 0 l n t 1 2 e a p s s 3 u d 2 u d v d u d v d v d 2 n d y s 30b k b 1 n 2 0 l n t 2 b s s 5 v d 2 u d v d u d v d u d 2 n d y s the total excitation vector comprising the hydrodynamic current and wave forces as well as internal unsteady flow is obtained by 31 f i 1 n e l e m 0 l n t s s c d x 2 v c v w v w 2 c m v w m i x s s s d v i d d t c d x y 1 2 v c v w v w 2 m i s s d v i d d t d y s as shown in eq 31 differentiation to eq 4 and using the rule of trigonometry leads to the relative acceleration of transported fluid as given in eq 32a in addition the acceleration of wave particle v w can be calculated by differentiating eq 8 as given in eq 32b 32a d v i d d t a i o ω i v i a cos ω i t π 2 32b v w v w a ω w cos ω w t π 2 the equation of motion eq 23 yields the nonlinear initial value problem arising from time dependent terms of the damping matrix and the stiffness matrix thus the numerical integration based on the time domain approach is convenient to solve this equation the newmark method newmark 1959 is utilized which is probably most extensively used as an algorithm for the integration of equations of structural dynamics the parameters γ 1 2 β 1 4 gay neto 2016 are specified for the constant average acceleration scheme in the numerical integration process the time step size is set to δ t 0 005 s which provides acceptable accuracy for the numerical integration result for the iteration process the error norm of 10 8 atadan et al 1997 is used to check the convergent criteria of the generalized nodal displacement and nodal velocity the initial guess values of nodal velocity and nodal displacement forming the nonlinear hydrodynamic damping matrix and nonlinear stiffness matrices are utilized from the results of the last iteratively computation in the previous time step in this study the average iteration number was 3 4 for each integration time step to implement the finite element algorithm and numerical integration process in house software was developed which is coded in the fortran 90 language 3 numerical results this section starts with numerical validation followed by the static and nonlinear free vibration analyses of the riser and is completed by computing the forced vibration analysis with the excitation forces of a hydrodynamic wave bar avi 2000 and internal pulsatile flow in the last two subsections 3 1 numerical validations two particular examples of validation are provided in this subsection to check the validity and efficiency of the riser model formulation and the developed in house software implementing the finite element algorithm the accuracy of the static large displacement analysis was presented previously in athisakul et al 2002 2012 however the current paper only investigates the verification on the nonlinear dynamic analysis according to the proposed model formulation the first validation example investigates the large amplitude free vibration of a simply supported beam the present riser model is simplified to be a straight beam by neglecting an initial static curvature the hydrodynamic damping matrix and force vector are also omitted in the equation of motion for free vibration analysis for this example the beam slenderness ratio is 971 kaewunruen et al 2005 the nonlinear fundamental frequency of beam is obtained by solving the eigenvalue problem press et al 1992 incorporating direct iteration where the detailed procedures can be seen in klaycham et al 2017 the nonlinear fundamental frequency ratios ω n ω l 2 of the simply supported beam for various values of the non dimensional vibration amplitudes are given in table 1 the variables ω l and ω n represent the linear and nonlinear natural frequencies respectively the non dimensional amplitude is represented by the ratio of the vibration amplitude to the radius of gyration a r for the linear solution of the natural frequency the specified normalized vibration amplitude is set to zero as shown in table 1 the nonlinear vibrating characteristic of the beam is the hardening type of nonlinearity where the nonlinear frequency ratio increases as the given vibration amplitude increases the comparative results show good agreement of the solutions compared with the available numerical solutions in the literature sarma and varadan 1983 ganapathi et al 1998 kaewunruen et al 2005 the next validation example checks the nonlinear natural frequency of the riser for various horizontal top end offsets δ x h y h which are verified with those presented by klaycham et al 2017 their results are based on the primarily mathematical model proposed by chucheepsakul and huang 1989 which was derived from the rod theory this numerical simulation utilizes the data summarized in table 2 example 1 fig 2 graphically shows the relationships between the nonlinear natural frequency ratio ω n ω l 2 and the non dimensional amplitude of vibration a r 0 to 5 and good agreement can be found when those results are compared with the data presented by klaycham et al 2017 however in contrast to the beam characteristics given previously both softening and hardening behaviors could appear in the nonlinear free vibration characteristics of the riser depending on its top end offset these results arise from the geometric stiffness because the increase in curvature decreases the nonlinear frequency ratio mukhopadhyay and sheikh 1995 however more discussion has been provided in klaycham et al 2017 3 2 static configuration and nonlinear free vibration characteristics before evaluating the forced vibration response it is necessary to find the static equilibrium configuration and to successively investigate the free vibration analysis see more detailed procedures in athisakul et al 2012 and klaycham et al 2017 these results of static and free vibration analyses will assist in increasing understanding of the fundamental dynamic response caused by the external excitation forces performing numerical simulation based on the input parameters summarized in table 2 example 2 the static configuration and natural dynamic configurations for the lowest five fundamental modes are obtained as illustrated in fig 3 to evaluate the natural dynamic configuration the normalized dynamic displacements or mode shapes are scaled up by 140 times and later added to the coordinate of the static equilibrium position in addition these normalized mode shapes for the normal and tangential modal displacements are shown in fig 4 a and b respectively which can be calculated by 33a v n d u d cos θ s v d sin θ s 33b u n d u d sin θ s v d cos θ s where θ s tan 1 x s represents an angle measured from the vertical to the corresponding tangential direction of the riser curve the results show that because of the large initial static curvature see fig 2 of this example the distribution curve of normal displacement for the 1st fundamental mode appears with two peaks one inflection point like the natural vibration characteristics of an arch structure shi et al 2017 and increases up to six peaks for the 5th fundamental mode however for the tangential displacement in fig 4 b only one peak can be found from the curve of the 1st fundamental mode and this increases up to five peaks for the 5th fundamental mode the natural frequency for the first five fundamental modes of the riser are also summarized in table 3 fig 5 shows the relationships between the nonlinear frequency ratio of the riser and the dimensionless amplitude of vibration for the 1st to the 5th modes it reveals that the lower mode 1st to 3rd modes contributes a hardening type with a free vibration characteristic especially for large vibration amplitude this result is due to the effect of nonlinear geometry induces an additional stiffness which causes to increase the nonlinear natural frequency then the nonlinear frequency to linear frequency ratio is larger than 1 0 ω n ω l 2 1 0 for higher vibration modes 4th to 5th modes the effect of nonlinear geometry causes to decrease the stiffness and the nonlinear natural frequency then the riser vibration behaves like a softening type ω n ω l 2 1 0 and the degree of softening also increases as the vibration amplitude increases to investigate the forced vibration response two cases of excitation forces are examined the first case investigates the hydrodynamic wave force while the other case considers the oscillatory flow of internal transported fluid which are presented consecutively in the next subsections 3 3 hydrodynamic wave excitation a nonlinear forced vibration response is performed with a large amplitude motion of the riser subjected to the hydrodynamic force of the oscillatory wave the properties of the riser given in table 2 example 2 are used in this parametric investigation the wave amplitude is specified as ζ a 10 0 m three different values of the wave frequencies are performed ω w 0 2983 0 4839 and 0 6831 rad s which are close to the first three fundamental frequencies ω l 1 ω l 2 and ω l 3 of the riser respectively these numerical computations have been performed afterward from the static analysis provided in the previous subsection fig 6 a and b show the time histories of the normal and tangential displacements respectively at a specified location y s 500 m mid depth for different wave frequencies the abbreviations sav and lav denote the small amplitude and large amplitude vibrations analyses respectively in the case of lav the nonlinear stiffness matrices are included in the numerical computation whereas they are linearized for exclusion in the sav analysis fig 6 a and b show that the displacement time history of the riser caused by the hydrodynamic wave is close to the harmonic response oscillation which exhibits excitation force characteristics eqs 8 and 9 this observation is consistent with kirk 1985 it also shows that the response at the mid depth location takes an approximate time for synchronization of 20 s to reach a stable periodic motion as the riser is quite taut and nearly vertical the wave force could contribute to the normal displacement much more than tangential displacement it is also evident that the time history of the displacement curve is asymmetric about its static position in other words the effect of the hydrodynamic current and the wave are to shift the mean dynamic position up away from the static equilibrium position by approximately 0 5 m and 0 1 m for normal and tangential displacements respectively actually depending on forcing frequency of the wave due to the damping effect of the current as it flows past the riser bar avi 2000 as shown in fig 6 a and b since the given wave frequencies are close to the natural frequencies of the riser system the riser responses are conformable to the fundamental parametric resonance alfosail and younis 2019 the given wave frequency which corresponds to the first natural vibration mode of the riser ω w ω l 1 results in a larger vibration amplitude than those simulated from another value of wave frequencies ω w ω l 2 and ω w ω l 3 from this result it can be concluded that the first fundamental modal vibration makes a more substantial contribution than other higher modes kirk 1985 because the riser is the long slender structure by considering the length to diameter ratio the stiffness of the riser is essentially dominated by the axial stiffness in comparing with bending stiffness then the tangential displacement contributing to the axial stiffness is more sensitive to the geometric nonlinearity than the normal displacement as shown in fig 6 by comparing the sav and lav analyses this figure shows that the effect of nonlinear geometry has a greater influence on tangential displacement than normal displacement it produces the softening type only when the riser vibrates in the positive tangential direction t ˆ as shown in fig 6 b this is due to the longitudinal vibration amplitude being amplified by the effect of axial stiffness nonlinearity as the effect of geometric nonlinearity is sensitive to low wave frequency the time history of phase spaces between displacement and velocity only for computation of ω w ω l 1 are shown in fig 7 from this figure the phase space responses look like an asymmetric circle it also reveals that for motion in the normal direction the results of lav analysis are effectively undifferentiable from those of sav however for motion in the tangential direction the time history of phase space for the lav analysis is substantially shifted away from such sav this is due to the nonlinear effect contributing to the axial vibration mode especially when the tangential velocity is positive see fig 7 b fig 8 a and b show the distributions of displacement amplitudes or the enveloped displacement curve in the normal and tangential directions respectively along the vertical coordinate for different wave frequencies as shown in fig 8 a for normal displacement amplitude there are two peaks in the distribution of the displacement amplitude when the wave frequency is equal to the natural frequency for the 1st vibration mode of the riser system there are three and four peaks in the distributions of the displacement amplitude when the wave frequencies are equal to the natural frequencies of the 2nd and the 3rd vibration modes respectively these results are also in agreement with the natural mode shapes in free vibration analysis as shown in fig 4 see curves for 1st 2nd and 3rd modes in the same manner as illustrated in fig 8 b the resonance phenomenon and the contribution of each fundamental mode shape on forced vibration analysis are also found when considering the tangential displacement amplitude comparing the sav curve to the lav curve in fig 8 a and b respectively the contribution of the nonlinear geometric effect is very sensitive to a low forcing frequency this result occurs because when ω w is equal to ω l 1 the effect of geometric nonlinearity has a strong influence on the response amplitude of riser vibration it seems to soften the riser system as its simulation provides a larger vibration amplitude than that from the sav analysis then especially for wave excitation the assumption of a linearized small vibration amplitude sav causes an underestimate in the analysis particularly around the location of maximum displacement amplitude fig 8 a and b it is well known that for a deepwater riser the riser system is dominated by the axial stiffness resulting from tangential displacement klaycham et al 2017 therefore the nonlinear effect produced by nonlinear geometry also has a greater contribution to the tangential displacement than to normal displacement especially when the softening nonlinearity occurs as shown in fig 8 a and b this result is due to for hardening nonlinearity the additional stiffness caused by nonlinear geometry is more accumulated which undergoes a less effect from the ocean loadings in addition this nonlinear phenomenon strongly influences riser motion especially when the vibration amplitude becomes larger the time histories of the displacement contour along the vertical coordinate of the riser are shown in fig 9 a and b for normal and tangential displacements respectively since the contribution of the nonlinear geometric effect is very sensitive to a low forcing frequency only numerical simulation for ω w ω l 1 with lav analysis is provided these results clearly show that the displacement contour for the overall riser length is also compatible with the vibration characteristics at a mid depth location as given in previous figures using fast fourier transform for different wave frequencies the response frequency of the normal and tangential motions at a mid depth location of the riser are shown in fig 10 a and b respectively from these figures the frequency responses of the riser are close to 0 047 0 077 and 0 109 hz respectively which are approximately equal to the frequency of the hydrodynamic wave these response frequencies are dominated by a single frequency which is consistent with the periodic response as discussed previously 3 4 oscillatory flow of transported fluid excitation the effect of the unsteady flow of the transporting fluid on the dynamic response is considered in this subsection the hydrodynamic wave force is also taken into account with the amplitude and frequency of a wave being fixed at ζ a 10 0 m and ω w 0 2983 ω l 1 rad s respectively the constant flow acceleration and the fluctuation velocity amplitude of the transported fluid are specified as a i o 2 0 m s2 and v i a 5 0 m s respectively three different values of the pulsatile frequency of internal flow such as ω i 0 2983 0 4839 and 0 6831 rad s which coincide with the riser natural frequencies ω l 1 ω l 2 and ω l 3 are performed in the numerical computations fig 11 a and b illustrate the time histories of the normal and tangential displacements respectively at a specified location y s 500 m mid depth the time history of displacements seems to be a periodic response the closely harmonic response characteristic appears when the fluctuation frequency of the transported fluid is equal to the wave frequency ω i ω w ω l 1 however when the fluctuation frequency of the transported fluid is not equal to that of hydrodynamic wave force for ω i ω l 2 and ω i ω l 3 the vibration characteristic is a periodic response with a beating phenomenon monprapussorn et al 2007 because the riser is dominated by two different forcing frequencies ocean wave and pulsatile frequencies of internal flow in other words these displacement responses are contributed to from two periodic components one due to the ocean wave and the other due to the internal pulsatile flow this result is also similar to the frequency domain analysis using fast fourier transform as given in fig 12 a and b from these figures the responses of the riser are dominated by two frequencies with the first being the forcing frequency of the hydrodynamic wave force which is close to 0 047 hz while the second is dominated by the pulsatile frequency of the transporting fluid which are equal to 0 077 and 0 109 hz respectively because the pulsatile flow has a much stronger influence on the normal displacement centrifugal force the effect of the beating phenomenon on the tangential displacement is less obvious than for normal displacement regarding the effect of nonlinearity produced by large amplitude motion as seen from fig 11 a and b the resulting nonlinear stiffness has a small effect on the time history of riser displacement at least for the mid depth location y s 500 m of the riser fig 13 a and b represent the distributions of displacement amplitudes in the normal and tangential directions respectively along the vertical coordinate of the riser the amplitude response for the case of uniform flow of internal fluid a i o 0 m s2 and v i a 0 m s analyzed from previous section ω w ω l 1 is also plotted in this figures to compare with the case of oscillatory flow considering eq 4 and eq 32 it can be seen that the fluctuation frequency of the transported fluid affects directly the frequency of the excitation force since the variation in fluctuation frequency may induce instability caused by parametric resonances panda and kar 2007 wang et al 2018 of the riser oscillation it is not necessary for the fluctuation frequency to always increase the vibration amplitude of the riser this result can be confirmed as is graphically illustrated in fig 13 a and b the displacement amplitude which is computed from ω i ω l 1 is smaller than the displacement amplitudes simulated from ω i ω l 2 and ω i ω l 3 this result is due to the phase lag between the combined excitation forces being π 2 radians see eqs 4 8 and 32 so that the displacement responses from these two forces may cancel each other directly when the forcing frequencies of the combined excitation forces are identical to each other the effect of the phase lag between the combined excitation forces also provides the hardening phenomena as shown in fig 13 a and b the geometric nonlinearity causes a hardening behaviour especially at the position of maximum vibration amplitude however at the other riser position the softening behavior of nonlinearity could appear in addition the lower pulsatile frequency contributes a higher effect of geometric nonlinearity on riser response than the higher frequency considering the pattern of displacement amplitudes in fig 13 a and b for different fluctuation frequencies of the transported fluid there are two peaks and one peak on the distributions of normal displacement and tangential displacement amplitudes respectively which correspond to the first fundamental vibration mode shape this result confirms that the response amplitude of the riser is dominated by the forcing frequency of the hydrodynamic wave ω w ω l 1 but the forcing frequency of the internal pulsatile flow has minimal influence fig 14 a and b illustrate the time histories of the displacement contour along the vertical coordinate of the riser for normal and tangential displacements respectively only numerical simulation for ω i ω l 3 with lav analysis is provided in these figures these results clearly show that the displacement contour of the overall riser length also has vibration characteristics at a mid depth location as given in previous figures 4 conclusions large amplitude forced vibration analysis of a deepwater marine riser carrying internal pulsating flow was investigated the variational formulation concerning large amplitude vibration was developed based on the work energy principle and extensible elastica theory the nonlinear stiffness up to a second order of the riser displacement was regarded in the equation of motion which was further integrated along a time variable using the newmark method incorporated direct iteration the dynamic response of the riser caused by the hydrodynamic wave was a closely harmonic response which accepted the ocean wave forces characteristic the effect of the forcing frequency influenced both the displacement amplitude patterns and their values which was consistent with the parametric resonance of the oscillation phenomenon if the forcing frequency was close to the natural frequencies of the riser system it yielded the resonance phenomenon and the amplitude of vibration became larger the natural vibration for the first mode of the riser system was a major contribution to the forced dynamic response than their higher modes the pattern of displacement amplitude was also acceptable with the fundamental mode shape of the riser because the axial stiffness strongly dominated the vibration characteristics of a deepwater riser the contribution of the nonlinear effect produced by nonlinear geometry had a greater influence on the tangential displacement than normal displacement in addition the contribution of the nonlinear geometric effect was sensitive to low wave frequency and caused the riser to be a softening type the linearized small amplitude of vibration caused an underestimate of analysis especially at the location of maximum vibration amplitude the combination of the internal pulsatile flow and environmental ocean wave force yielded of the periodic response with the beating phenomenon only when their forcing frequencies were not identical to each other the pattern of the amplitude response was more sensitive to the forcing frequency of the hydrodynamic wave than that of the internal pulsatile flow the pulsatile flow dominated the riser since it acted in axial compression and stiffened the riser system especially at the location of maximum vibration amplitude however at other location the softening behavior of nonlinearity could appear credit authorship contribution statement karun klaycham conceptualization methodology software writing original draft validation formal analysis funding acquisition chainarong athisakul investigation writing review editing project administration somchai chucheepsakul investigation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was financially supported by the thailand research fund trf under contract no mrg6280051 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107966 
21417,a marine riser operated in deepwater could encounter harsh environmental conditions and exhibit complex vibration phenomena which require thorough investigation especially using nonlinear geometric diagnosis the aim of this paper was to propose a theoretical formulation for undertaking large amplitude vibration analysis of a deepwater marine riser conveying oscillatory internal fluid flow the work energy principle based on virtual displacement was utilized to formulate the riser mathematical model accounting for internal strain energy and external work done the geometric nonlinearity of the riser regarding extensible elastica theory was considered which accounted for axial stretching and the large deformed curvature of the riser the finite element method was utilized to form the equation of the motion system for solving numerical solutions based on taylor s series expansion the stiffness matrices with second order nonlinear dynamic displacements of the riser were regarded in the equation of motion the hydrodynamic ocean force modeled in terms of the squared riser velocity also yielded the nonlinear hydrodynamic damping matrix the inertial force initiated by the pulsatile flow of transported fluid was taken into account as a harmonic oscillation representing the pump operation performing the newmark time integration incorporated direct iteration on the equation of motion provided the nonlinear vibration response a thorough parametric study was accomplished which investigated the influences of geometric nonlinearity the forcing frequencies of a hydrodynamic wave and an internal pulsatile flow on the large amplitude dynamic response characteristics of a deepwater riser keywords elastica theory finite element method internal pulsatile flow large amplitude vibration marine riser nonlinear geometry 1 introduction in offshore petroleum drilling and production processes the marine riser which is a slender vertical pipe has been used as equipment for conveying crude oil from the seafloor up to a storage or production unit on the sea surface sparks 2007 in addition to its own weight particularly for deepwater operations the riser will also probably confront progressive hydrostatic pressure violent ocean current and wave forces and large varying axial tension along the riser length chen et al 2012 these environmental loadings exerted on a marine riser system with geometric nonlinearities will lead to complex vibration phenomena such as large amplitude vibration klaycham et al 2014 klaycham et al 2017 klaycham et al 2018 internal pulsatile flow and severe slugging induced vibration monprapussorn et al 2007 cabrera miranda and paik 2018 onuoha et al 2018 and vortex induced vibration viv duan et al 2018 yuan et al 2018 in addition to such loadings klaycham et al 2020 studied vessel sway and heave induced riser motion by using application of the penalty method for the riser in three dimensions li et al 2018 also applied the vector form intrinsic finite element method to analyze the nonlinear dynamic of hanging riser caused by wave force and top end vessel motion these dynamic features are of interest to understand the riser structural behavior to prevent it undergoing fatigue failure from viv thorsen et al 2019 coupled sway heave motion of top end vessel and to control riser vibration hong and shah 2018 in addition the nonlinear geometry chatjigeorgiou 2008 regarding the response of the riser structure leads to an increase in the complexity of the dynamic analysis that requires a deep and comprehensive computational investigation the analysis of a deepwater riser operation begins with finding its static configuration however linear analysis with an assumption of small deflection may be inadequate from state of the art reviews over the past several decades many researchers have developed alternative model formulations and solution methods that capture a large displacement analysis of the riser chucheepsakul et al 2003 chai and varyani 2006 athisakul et al 2012 2014 gay neto et al 2014 beyond static analysis nonlinear dynamic analysis is necessary to consider the nonlinear environmental forces at least for the hydrodynamic ocean force which is nonlinear in nature and generates complex dynamic phenomena moreover different types of environmental loadings are always combined together to predict a realistic dynamic response of riser for example the response originated by viv pulsatile flow of transported fluid and top end excitation which can be found in bar avi 2000 monprapussorn et al 2007 srinil et al 2011 chen et al 2015 and lei et al 2014 these previous works presented the vibration response of the marine riser excited by combined environmental loads which was capable of reasonably describing nonlinear dynamic characteristics however their results published in the literature were based on the assumption of a small vibration amplitude many research works have provided various interesting specific problems concerning the internal unsteady flow or pulsatile flow of a transporting fluid monprapussorn et al 2007 presented the vibration response of a flexible riser conveying a pulsatile flow of transporting fluid in which the effects of constant acceleration the pulsatile frequency and the oscillatory amplitude of the internal fluid velocity bar avi 2000 ni et al 2014 mcdonald and sri namachchivaya 2005 on riser vibration characteristics are illustrated intensively dai et al 2014 presented the viv of a long vertical marine pipe carrying a pulsating flow their results demonstrated that for the lock in condition of a certain mode the internal pulsating flow has an evident influence on the vibration of the pipe only for the same mode of parametric resonance luo et al 2016 zhang et al 2017 however various issues have been presented continually in the available literature concerning pipe conveying pulsating flow related to a viscoelastic pipe model yang et al 2007 subharmonic resonance sri namchchivaya 1989 and the principal parametric and internal resonances of a pipe panda and kar 2008 among others as the marine riser is actually subjected to severe and complex dynamic loadings especially in deep water chung and cheng 1996 cheng et al 2018 meng et al 2018 the linearized vibration theory representing small amplitude vibration behavior may be insufficient monprapussorn et al 2007 takafuji and martins 2012 there have been few research studies regarding large amplitude vibration of the riser such as kaewunruen et al 2005 and klaycham et al 2017 but their studies were limited only to free vibration analysis of a riser in shallow water y h 300 m the solution for large amplitude forced vibration of a deepwater riser conveying a pulsatile flow has been not reported in such previous works this lack of study leads to interesting challenges regarding vibration characteristics with a nonlinear geometric effect consequently the main objective of the current work was to present an analysis of large amplitude forced vibrations of a deepwater marine riser conveying an oscillatory flow of transported fluid according to large amplitude vibration geometric nonlinearity using the nonlinear stiffness matrix based on taylor s series expansion is taken into account in the equation of riser motion the nonlinear loadings produced by the ocean current and wave forces are of concern which further yields the nonlinear hydrodynamic damping matrix the hydrodynamic added mass matrix and the time dependent force vector the oscillatory flow of the internal transported fluid is also taken into consideration for the excitation of external force the forced vibration response of the riser is calculated computationally by using the time domain approach based on numerical time integration newmark s method the contribution of the nonlinear geometric effect is assessed through comparative computations between the large amplitude vibration lav and small amplitude vibration sav analyses special attention is paid to the effects of a hydrodynamic wave and the unsteady flow of internal fluid on the nonlinear vibration responses of the riser 2 model formulation as a marine riser vibrates around its static configuration large displacement static analysis needs to be evaluated first when it is subjected to time independent loads athisakul et al 2002 this static configuration with a hinged hinged support condition is utilized as an initial position for the riser vibration analysis the theoretical model for static analysis used in this study was based on the variational model formulation proposed by chucheepsakul et al 2003 which can capture large displacement as shown in fig 1 the position deformation and kinematics of the riser are prescribed using the 2 dimensional cartesian coordinate system x y for an undeformed state the position vector of the riser is defined by r p o x o i ˆ y o j ˆ in which i ˆ and j ˆ represent the rectangular unit vectors in the horizontal and vertical directions respectively while x o and y o represent the horizontal and vertical undeformed positions along the riser length the riser top end is located at the coordinates x x h and y y h an appropriate tension n a h is applied to the top end of the riser to keep its equilibrium position according to imposed time independent loads the riser weight the buoyancy force the quasi static drag force caused by the hydrodynamic current as well as the centrifugal force induced by transported fluid flow the riser is moved to the static equilibrium position r p s x s i ˆ y s j ˆ the nonlinear finite element procedure was utilized for finding the numerical solution of the riser static configuration as presented in athisakul et al 2002 regarding vibration analysis the riser is excited by time dependent loads and displaced from a static state r p s x s i ˆ y s j ˆ to dynamic equilibrium positions as represented by a position vector r p x i ˆ y j ˆ in which x and y are the horizontal and vertical positions respectively 1a x x s u d 1b y y s v d the variables u d and v d are the dynamic displacements in the horizontal and vertical directions respectively which need to be calculated in the dynamic analysis procedure the detailed derivation of the model formulation is provided in the following subsections 2 1 excitation forces exerted on riser the excitation forces concerned in this study comprised 1 the inertial force caused by riser motion 2 the inertial force of internal transported fluid and 3 hydrodynamic forces of current and wave particles first the inertial force of riser motion is derived from newton s law of momentum conservation obtained by multiplying the riser mass m p and its acceleration similar to the inertial force of the riser the inertial force of the internal transported fluid is also calculated by multiplying the transported fluid mass m i and its acceleration based on eulerian mechanics the absolute acceleration of the internal transported fluid can be derived and expressed in terms of riser geometry separated into components in the horizontal a f x and vertical a f y directions as huang 1993 2a a f x u d 1 2 s s x s 2 s s 3 u d x s s s 3 v d v i s 2 κ s s s v i s 2 3 x s s s d v i d d t 4 2b a f y v d 1 x s s s 3 u d 2 s s 1 s s 3 v d v i s 2 κ s x s s s v i s 2 3 1 s s d v i d d t 4 each term in eq 2 could contribute to 1 the initial transported fluid mass force 2 coriolis damping force 3 centrifugal force and 4 unsteady flow induced excitation force respectively where these forces are proportional to the transported fluid mass the prime and dot notations associated with the parameters in eq 2 represent the derivatives with respect to the parameters y s and time t respectively which are utilized entirely in this article the variables u d and v d are the horizontal and vertical acceleration respectively of the riser κ s and s s are the initial static curvature and the differential arc length respectively of the riser in the static equilibrium state bar avi 2000 which can be expressed as 3a κ s x s 1 x s 2 3 2 3b s s 1 x s 2 as shown in eq 2 the absolute acceleration of the transported fluid is contributed by its velocity which is composed of two parts quasi static part v i s and a dynamic part v i d the dynamic part is prescribed by the expression bar avi 2000 4 v i d a i o t v i a cos ω i t in eq 4 the first term represents the transient state where t is the time variable and a i o is the constant acceleration of fluctuation velocity the second term is representative of a pump that generates an oscillatory flow in which v i a and ω i are the velocity amplitude and fluctuation frequency of the transported fluid respectively the hydrodynamic wave force is calculated based on the morison model morison et al 1950 this force includes three components the added mass force the hydrodynamic damping force and the hydrodynamic excitation force to this end the extended morison hydrodynamic forces in the x and y directions are provided by chucheepsakul et al 2003 5 f h f h x f h y c a 0 0 c a u d v d added mass force c e q x c e q x y c e q x y c e q y u d v d hydrodynamic damping force c d x v h x 2 c m v h x c d x y 1 v h x 2 hydrodynamic excitation the hydrodynamic force provided in eq 5 consists of three terms the added mass force the hydrodynamic damping force and the excitation force which further contribute to the mass matrix damping matrix and excitation force vector of the riser system respectively the variables c a ρ e a e c a and c m ρ e a e c m are the coefficients of equivalent added mass and inertia forces respectively c a is the added mass coefficient c m c a 1 is the inertia coefficient ρ e is the density of seawater d e is the outer diameter of the riser and a e is the cross sectional area of seawater replaced by the riser the symbol v h x is the hydrodynamic velocity which is comprised of the horizontal current velocity and the wave velocity as 6 v h x v c v w where v c is the current velocity which depends on the vertical coordinate the profile of the current velocity monprapussorn et al 2004 can be expressed in a polynomial function as 7 v c v c h y s y b y h y b n the symbol v c h is the current velocity at the mean sea level and the parameters y b and y h are defined in fig 1 in this study the index n 1 7 is used for the tidal current profile in the numerical investigations the oscillatory wave velocity v w is a function of the vertical coordinate and the time which can be expressed as 8 v w v w a cos ω w t where ω w is the wave frequency the velocity amplitude of the wave particle v w a v w a y s is varied exponentially along a vertical coordinate which can be expressed as 9 v w a ζ a ω w e k y s y b y h y b in which ζ a denotes the wave amplitude k ω w 2 g is the wave number and g is the gravitational acceleration referring to eq 5 the detailed derivation of the coefficients of equivalent hydrodynamic damping force c e q x c e q y c e q x y and the coefficients of equivalent drag force c d x c d x y 1 can be seen in chucheepsakul et al 2003 it should be noted that the variables c e q x c e q y and c e q x y are nonlinear terms arising from the square of the relative velocity between seawater and the riser 2 2 large amplitude equation of motion the mathematical model capable of capturing the large amplitude motion of the riser is formulated based on a variational approach using the principle of virtual displacement the total virtual work formulation is composed of virtual strain energy and external virtual work first the virtual strain energy due to axial stretching and bending deformation of the riser system is given by 10 δ u 0 y h n a δ ε b κ κ s δ κ s s d y s it should be noted that throughout this study the prime notation represents the derivative with respect to the variable y s the symbol b e i p is the bending rigidity e and i p are the elastic modulus of the riser material and the moment of inertia of the riser respectively from eq 10 the expression for axial tension n a is given by 11 n a n a s e a p ε d the symbol a p is the cross sectional area of the riser as shown in eq 11 the axial tension consists of two parts the static tension n a s and dynamic tension e a p ε d however concerning large amplitude motion keeping the nonlinear terms the nonlinear dynamic axial strain ε d used in this present work can be expressed based on the updated lagrangian descriptor monprapussorn et al 2007 as 12 ε d 1 s s 2 x s u d v d u d 2 2 v d 2 2 where s s is the differential arc length of the riser at static state as given in eq 3b performing the variation to eq 12 the virtual dynamic axial strain is expressed as 13 δ ε d 1 s s 2 x s u d δ u d 1 v d δ v d with large amplitude motion the exact curvature κ at dynamic state accepting elastica theory can be given as 14 κ x y x y s 3 x s u d 1 v d x s u d v d s 3 in which s is the differential arc length of the riser at the dynamic state as given by 15 s x 2 y 2 x s u d 2 1 v d 2 applying the variation to eq 14 one obtains the virtual dynamic curvature as 16 δ κ 1 s 2 y s δ u d x s δ v d y s 3 κ x δ u d x s 3 κ y δ v d substituting eqs 11 16 in eq 10 the virtual strain energy of the riser can be rearranged into the form δ u 0 y h n a s e a p ε d s s x s u d δ u d 1 v d δ v d d y s 17 0 y h b κ κ s s 2 y s δ u d x s δ v d y s 3 κ x δ u d x s 3 κ y δ v d s s d y s external virtual work of the riser system includes the work produced by the effective weight w a the initial forces of the riser m p u d m p v d the internal transporting fluid motions m i a f x m i a f y and the hydrodynamic force f h x f h y which is expressed as 18 δ w 0 y h f h x m p u d m i a f x δ u d w a f h y m p v d m i a f y δ v d s s d y s where m p and m i are the mass per unit length of the riser and internal fluid respectively the detailed derivations of the external forces in eq 18 are provided in the previous subsection based on the work energy principle the total virtual work consists of the virtual strain energy and external work done δ π δ u δ w which is expressed using eqs 17 and 18 19 δ π 0 y h n a s e a p ε d s s x s u d δ u d 1 v d δ v d d y s 0 y h b κ κ s s 2 y s δ u d x s δ v d y s 3 κ x δ u d x s 3 κ y δ v d s s d y s 0 y h f h x m p u d m i a f x δ u d w a f h y m p v d m i a f y δ v d s s d y s to form a nonlinear equation for the motion of a riser the expressions of force in eqs 2 and 3 are utilized and replaced in eq 19 substituting eq 1 into eq 19 and expanding the nonlinear terms based on taylor s series two nonlinear governing equations of the riser vibration can be expressed by rearranging each term according to the order of nonlinearities as follows including horizontal and vertical dynamic equilibrium equations respectively as shown in eqs 20a and 20b 20a δ π x 0 y h n a s s s e a p s s 3 x s 2 u d e a p s s 3 x s v d δ u d e a p s s 3 3 2 x s u d u d 3 4 x s v d 3 4 u d v d δ u d e a p s s 3 u d 2 2 u d u d v d 2 v d δ u d b s s 5 u d x s v d δ u d b κ s s s 4 2 x s u s 1 x s 2 v d δ u d 3 2 b s s 5 x s v d v d 2 v d u d x s v d u d v d δ u d 2 b s s 5 v d 2 u d u d v d v d δ u d s s c a u d c e q x u d c e q x y v d c d x 2 v c v w v w 2 c m v w δ u d s s m p m i u d m i v i s 2 s s x s 2 s s 3 u d m i v i s x s s s 3 v d δ u d s s m i x s s s d v i d d t δ u d s s m i v i s 2 s s 2 u d δ u d d y s 0 20b δ π y 0 y h e a p s s 3 x s u d n a s s s e a p s s 3 v d δ v d e a p s s 3 3 4 u d 3 4 x s v d u d 3 2 v d v d δ v d e a p s s 3 u d v d 2 u d v d 2 2 v d δ v d b s s 5 x s u d x s 2 v d δ v d b κ s s s 4 1 x s 2 u d 2 x s v d δ v d 3 2 b s s 5 x s v d u d x s u d v d δ v d 3 2 b s s 5 x s u d v d x s v d u d u d 2 x s u d v d δ v d 2 b s s 5 u d v d u d u d 2 v d δ v d s s c a v d c e q y v d c e q x y u d c d x y 1 2 v c v w v w 2 δ v d s s m p m i v d m i v i s x s s s 3 u d m i v i s 2 s s y s 2 s s 3 v d δ v d s s m i s s d v i d d t δ v d s s m i v i s 2 s s 2 v d δ v d d y s 0 2 3 finite element formulation to form the nonlinear equation of motion and find the numerical solution the finite element method is applied in this procedure the riser model is divided into a finite number of elements along the vertical coordinate y s each element of the riser has an equal length along the vertical projection of l y h n e l e m in which n e l e m is an amount of discretized element the dynamic displacements u d and v d at any points of the riser within the element are calculated approximately using the shape function cook et al 2002 by separation of the variables the displacement vector u d can be expressed in terms of the element nodal degree of freedom vector d d and the shape function matrix n as 21 u d u d v d t n y s d d t where n and d d can be expressed as 22a n n 51 n 52 n 53 0 0 0 n 54 n 55 n 56 0 0 0 0 0 0 n 51 n 52 n 53 0 0 0 n 54 n 55 n 56 22b d d u 1 d u 1 d u 1 d v 1 d v 1 d v 1 d u 2 d u 2 d u 2 d v 2 d v 2 d v 2 d t where n 5 i is the component of the fifth degree polynomial shape function athisakul et al 2011 using an approximated expression of eq 21 and further applying the stationary condition π d d δ d d 0 to eqs 20a and 20b with some mathematical manipulations provide the nonlinear dynamic equilibrium equation capable of capturing large amplitude motion as 23 m d d c g d d k l k n 1 k n 2 d d f the equation of motion eq 23 is generally obtained by assembling the element equation where the operator i 1 n e l e m is used instead for its representation to this end the vectors d d i 1 n e l e m d d d d and d d are the nodal displacement nodal velocity and nodal acceleration vectors of the global system respectively the total mass matrix m the total hydrodynamic damping matrix c and total gyroscopic matrix g can be respectively expressed as 24a m i 1 n e l e m 0 l n t s s m p m i c a 1 0 0 1 n d y s 24b c i 1 n e l e m 0 l n t s s c e q x c e q x y c e q x y c e q y n d y s 24c g i 1 n e l e m 0 l n t m i v i s 2 x s 2 s s 2 x s s s 2 x s s s 2 2 1 s s 2 n d y s the total linear stiffness matrix is contributed from 25 k l i 1 n e l e m k l a k b 1 l k l b 2 in which their corresponding element matrices are calculated from the following integral expressions 26a k l a 0 l n t n a s m i v i s 2 s s 1 0 0 1 e a p s s 3 x s 2 x s x s 1 n d y s 26b k l b 1 0 l n t b s s 5 1 x s x s x s 2 n d y s 26c k b 2 l 0 l n t b κ s s s 4 2 x s 1 x s 2 1 x s 2 2 x s n d y s the total first order nonlinear stiffness matrix is assembled from its element matrix 27 k n 1 i 1 n e l e m k a 1 n 1 k b 1 n 1 in which their corresponding element matrices are 28a k a 1 n 1 0 l n t 3 4 e a p s s 3 2 x s u d x s v d u d x s v d u d 2 v d n d y s k b 1 n 1 0 l n t 3 2 b s s 5 0 0 x s v d x s u d n d y s 0 l n t 3 2 b s s 5 0 x s v d 0 x s u d n d y s 28b 0 l n t 3 2 b s s 5 2 v d x s v d u d x s v d u d 2 x s u d n d y s the total second order nonlinear stiffness matrix is formed by 29 k n 2 i 1 n e l e m k a 1 n 2 k b 1 n 2 the above element matrices in eq 29 are 30a k n 2 a 1 0 l n t 1 2 e a p s s 3 u d 2 u d v d u d v d v d 2 n d y s 30b k b 1 n 2 0 l n t 2 b s s 5 v d 2 u d v d u d v d u d 2 n d y s the total excitation vector comprising the hydrodynamic current and wave forces as well as internal unsteady flow is obtained by 31 f i 1 n e l e m 0 l n t s s c d x 2 v c v w v w 2 c m v w m i x s s s d v i d d t c d x y 1 2 v c v w v w 2 m i s s d v i d d t d y s as shown in eq 31 differentiation to eq 4 and using the rule of trigonometry leads to the relative acceleration of transported fluid as given in eq 32a in addition the acceleration of wave particle v w can be calculated by differentiating eq 8 as given in eq 32b 32a d v i d d t a i o ω i v i a cos ω i t π 2 32b v w v w a ω w cos ω w t π 2 the equation of motion eq 23 yields the nonlinear initial value problem arising from time dependent terms of the damping matrix and the stiffness matrix thus the numerical integration based on the time domain approach is convenient to solve this equation the newmark method newmark 1959 is utilized which is probably most extensively used as an algorithm for the integration of equations of structural dynamics the parameters γ 1 2 β 1 4 gay neto 2016 are specified for the constant average acceleration scheme in the numerical integration process the time step size is set to δ t 0 005 s which provides acceptable accuracy for the numerical integration result for the iteration process the error norm of 10 8 atadan et al 1997 is used to check the convergent criteria of the generalized nodal displacement and nodal velocity the initial guess values of nodal velocity and nodal displacement forming the nonlinear hydrodynamic damping matrix and nonlinear stiffness matrices are utilized from the results of the last iteratively computation in the previous time step in this study the average iteration number was 3 4 for each integration time step to implement the finite element algorithm and numerical integration process in house software was developed which is coded in the fortran 90 language 3 numerical results this section starts with numerical validation followed by the static and nonlinear free vibration analyses of the riser and is completed by computing the forced vibration analysis with the excitation forces of a hydrodynamic wave bar avi 2000 and internal pulsatile flow in the last two subsections 3 1 numerical validations two particular examples of validation are provided in this subsection to check the validity and efficiency of the riser model formulation and the developed in house software implementing the finite element algorithm the accuracy of the static large displacement analysis was presented previously in athisakul et al 2002 2012 however the current paper only investigates the verification on the nonlinear dynamic analysis according to the proposed model formulation the first validation example investigates the large amplitude free vibration of a simply supported beam the present riser model is simplified to be a straight beam by neglecting an initial static curvature the hydrodynamic damping matrix and force vector are also omitted in the equation of motion for free vibration analysis for this example the beam slenderness ratio is 971 kaewunruen et al 2005 the nonlinear fundamental frequency of beam is obtained by solving the eigenvalue problem press et al 1992 incorporating direct iteration where the detailed procedures can be seen in klaycham et al 2017 the nonlinear fundamental frequency ratios ω n ω l 2 of the simply supported beam for various values of the non dimensional vibration amplitudes are given in table 1 the variables ω l and ω n represent the linear and nonlinear natural frequencies respectively the non dimensional amplitude is represented by the ratio of the vibration amplitude to the radius of gyration a r for the linear solution of the natural frequency the specified normalized vibration amplitude is set to zero as shown in table 1 the nonlinear vibrating characteristic of the beam is the hardening type of nonlinearity where the nonlinear frequency ratio increases as the given vibration amplitude increases the comparative results show good agreement of the solutions compared with the available numerical solutions in the literature sarma and varadan 1983 ganapathi et al 1998 kaewunruen et al 2005 the next validation example checks the nonlinear natural frequency of the riser for various horizontal top end offsets δ x h y h which are verified with those presented by klaycham et al 2017 their results are based on the primarily mathematical model proposed by chucheepsakul and huang 1989 which was derived from the rod theory this numerical simulation utilizes the data summarized in table 2 example 1 fig 2 graphically shows the relationships between the nonlinear natural frequency ratio ω n ω l 2 and the non dimensional amplitude of vibration a r 0 to 5 and good agreement can be found when those results are compared with the data presented by klaycham et al 2017 however in contrast to the beam characteristics given previously both softening and hardening behaviors could appear in the nonlinear free vibration characteristics of the riser depending on its top end offset these results arise from the geometric stiffness because the increase in curvature decreases the nonlinear frequency ratio mukhopadhyay and sheikh 1995 however more discussion has been provided in klaycham et al 2017 3 2 static configuration and nonlinear free vibration characteristics before evaluating the forced vibration response it is necessary to find the static equilibrium configuration and to successively investigate the free vibration analysis see more detailed procedures in athisakul et al 2012 and klaycham et al 2017 these results of static and free vibration analyses will assist in increasing understanding of the fundamental dynamic response caused by the external excitation forces performing numerical simulation based on the input parameters summarized in table 2 example 2 the static configuration and natural dynamic configurations for the lowest five fundamental modes are obtained as illustrated in fig 3 to evaluate the natural dynamic configuration the normalized dynamic displacements or mode shapes are scaled up by 140 times and later added to the coordinate of the static equilibrium position in addition these normalized mode shapes for the normal and tangential modal displacements are shown in fig 4 a and b respectively which can be calculated by 33a v n d u d cos θ s v d sin θ s 33b u n d u d sin θ s v d cos θ s where θ s tan 1 x s represents an angle measured from the vertical to the corresponding tangential direction of the riser curve the results show that because of the large initial static curvature see fig 2 of this example the distribution curve of normal displacement for the 1st fundamental mode appears with two peaks one inflection point like the natural vibration characteristics of an arch structure shi et al 2017 and increases up to six peaks for the 5th fundamental mode however for the tangential displacement in fig 4 b only one peak can be found from the curve of the 1st fundamental mode and this increases up to five peaks for the 5th fundamental mode the natural frequency for the first five fundamental modes of the riser are also summarized in table 3 fig 5 shows the relationships between the nonlinear frequency ratio of the riser and the dimensionless amplitude of vibration for the 1st to the 5th modes it reveals that the lower mode 1st to 3rd modes contributes a hardening type with a free vibration characteristic especially for large vibration amplitude this result is due to the effect of nonlinear geometry induces an additional stiffness which causes to increase the nonlinear natural frequency then the nonlinear frequency to linear frequency ratio is larger than 1 0 ω n ω l 2 1 0 for higher vibration modes 4th to 5th modes the effect of nonlinear geometry causes to decrease the stiffness and the nonlinear natural frequency then the riser vibration behaves like a softening type ω n ω l 2 1 0 and the degree of softening also increases as the vibration amplitude increases to investigate the forced vibration response two cases of excitation forces are examined the first case investigates the hydrodynamic wave force while the other case considers the oscillatory flow of internal transported fluid which are presented consecutively in the next subsections 3 3 hydrodynamic wave excitation a nonlinear forced vibration response is performed with a large amplitude motion of the riser subjected to the hydrodynamic force of the oscillatory wave the properties of the riser given in table 2 example 2 are used in this parametric investigation the wave amplitude is specified as ζ a 10 0 m three different values of the wave frequencies are performed ω w 0 2983 0 4839 and 0 6831 rad s which are close to the first three fundamental frequencies ω l 1 ω l 2 and ω l 3 of the riser respectively these numerical computations have been performed afterward from the static analysis provided in the previous subsection fig 6 a and b show the time histories of the normal and tangential displacements respectively at a specified location y s 500 m mid depth for different wave frequencies the abbreviations sav and lav denote the small amplitude and large amplitude vibrations analyses respectively in the case of lav the nonlinear stiffness matrices are included in the numerical computation whereas they are linearized for exclusion in the sav analysis fig 6 a and b show that the displacement time history of the riser caused by the hydrodynamic wave is close to the harmonic response oscillation which exhibits excitation force characteristics eqs 8 and 9 this observation is consistent with kirk 1985 it also shows that the response at the mid depth location takes an approximate time for synchronization of 20 s to reach a stable periodic motion as the riser is quite taut and nearly vertical the wave force could contribute to the normal displacement much more than tangential displacement it is also evident that the time history of the displacement curve is asymmetric about its static position in other words the effect of the hydrodynamic current and the wave are to shift the mean dynamic position up away from the static equilibrium position by approximately 0 5 m and 0 1 m for normal and tangential displacements respectively actually depending on forcing frequency of the wave due to the damping effect of the current as it flows past the riser bar avi 2000 as shown in fig 6 a and b since the given wave frequencies are close to the natural frequencies of the riser system the riser responses are conformable to the fundamental parametric resonance alfosail and younis 2019 the given wave frequency which corresponds to the first natural vibration mode of the riser ω w ω l 1 results in a larger vibration amplitude than those simulated from another value of wave frequencies ω w ω l 2 and ω w ω l 3 from this result it can be concluded that the first fundamental modal vibration makes a more substantial contribution than other higher modes kirk 1985 because the riser is the long slender structure by considering the length to diameter ratio the stiffness of the riser is essentially dominated by the axial stiffness in comparing with bending stiffness then the tangential displacement contributing to the axial stiffness is more sensitive to the geometric nonlinearity than the normal displacement as shown in fig 6 by comparing the sav and lav analyses this figure shows that the effect of nonlinear geometry has a greater influence on tangential displacement than normal displacement it produces the softening type only when the riser vibrates in the positive tangential direction t ˆ as shown in fig 6 b this is due to the longitudinal vibration amplitude being amplified by the effect of axial stiffness nonlinearity as the effect of geometric nonlinearity is sensitive to low wave frequency the time history of phase spaces between displacement and velocity only for computation of ω w ω l 1 are shown in fig 7 from this figure the phase space responses look like an asymmetric circle it also reveals that for motion in the normal direction the results of lav analysis are effectively undifferentiable from those of sav however for motion in the tangential direction the time history of phase space for the lav analysis is substantially shifted away from such sav this is due to the nonlinear effect contributing to the axial vibration mode especially when the tangential velocity is positive see fig 7 b fig 8 a and b show the distributions of displacement amplitudes or the enveloped displacement curve in the normal and tangential directions respectively along the vertical coordinate for different wave frequencies as shown in fig 8 a for normal displacement amplitude there are two peaks in the distribution of the displacement amplitude when the wave frequency is equal to the natural frequency for the 1st vibration mode of the riser system there are three and four peaks in the distributions of the displacement amplitude when the wave frequencies are equal to the natural frequencies of the 2nd and the 3rd vibration modes respectively these results are also in agreement with the natural mode shapes in free vibration analysis as shown in fig 4 see curves for 1st 2nd and 3rd modes in the same manner as illustrated in fig 8 b the resonance phenomenon and the contribution of each fundamental mode shape on forced vibration analysis are also found when considering the tangential displacement amplitude comparing the sav curve to the lav curve in fig 8 a and b respectively the contribution of the nonlinear geometric effect is very sensitive to a low forcing frequency this result occurs because when ω w is equal to ω l 1 the effect of geometric nonlinearity has a strong influence on the response amplitude of riser vibration it seems to soften the riser system as its simulation provides a larger vibration amplitude than that from the sav analysis then especially for wave excitation the assumption of a linearized small vibration amplitude sav causes an underestimate in the analysis particularly around the location of maximum displacement amplitude fig 8 a and b it is well known that for a deepwater riser the riser system is dominated by the axial stiffness resulting from tangential displacement klaycham et al 2017 therefore the nonlinear effect produced by nonlinear geometry also has a greater contribution to the tangential displacement than to normal displacement especially when the softening nonlinearity occurs as shown in fig 8 a and b this result is due to for hardening nonlinearity the additional stiffness caused by nonlinear geometry is more accumulated which undergoes a less effect from the ocean loadings in addition this nonlinear phenomenon strongly influences riser motion especially when the vibration amplitude becomes larger the time histories of the displacement contour along the vertical coordinate of the riser are shown in fig 9 a and b for normal and tangential displacements respectively since the contribution of the nonlinear geometric effect is very sensitive to a low forcing frequency only numerical simulation for ω w ω l 1 with lav analysis is provided these results clearly show that the displacement contour for the overall riser length is also compatible with the vibration characteristics at a mid depth location as given in previous figures using fast fourier transform for different wave frequencies the response frequency of the normal and tangential motions at a mid depth location of the riser are shown in fig 10 a and b respectively from these figures the frequency responses of the riser are close to 0 047 0 077 and 0 109 hz respectively which are approximately equal to the frequency of the hydrodynamic wave these response frequencies are dominated by a single frequency which is consistent with the periodic response as discussed previously 3 4 oscillatory flow of transported fluid excitation the effect of the unsteady flow of the transporting fluid on the dynamic response is considered in this subsection the hydrodynamic wave force is also taken into account with the amplitude and frequency of a wave being fixed at ζ a 10 0 m and ω w 0 2983 ω l 1 rad s respectively the constant flow acceleration and the fluctuation velocity amplitude of the transported fluid are specified as a i o 2 0 m s2 and v i a 5 0 m s respectively three different values of the pulsatile frequency of internal flow such as ω i 0 2983 0 4839 and 0 6831 rad s which coincide with the riser natural frequencies ω l 1 ω l 2 and ω l 3 are performed in the numerical computations fig 11 a and b illustrate the time histories of the normal and tangential displacements respectively at a specified location y s 500 m mid depth the time history of displacements seems to be a periodic response the closely harmonic response characteristic appears when the fluctuation frequency of the transported fluid is equal to the wave frequency ω i ω w ω l 1 however when the fluctuation frequency of the transported fluid is not equal to that of hydrodynamic wave force for ω i ω l 2 and ω i ω l 3 the vibration characteristic is a periodic response with a beating phenomenon monprapussorn et al 2007 because the riser is dominated by two different forcing frequencies ocean wave and pulsatile frequencies of internal flow in other words these displacement responses are contributed to from two periodic components one due to the ocean wave and the other due to the internal pulsatile flow this result is also similar to the frequency domain analysis using fast fourier transform as given in fig 12 a and b from these figures the responses of the riser are dominated by two frequencies with the first being the forcing frequency of the hydrodynamic wave force which is close to 0 047 hz while the second is dominated by the pulsatile frequency of the transporting fluid which are equal to 0 077 and 0 109 hz respectively because the pulsatile flow has a much stronger influence on the normal displacement centrifugal force the effect of the beating phenomenon on the tangential displacement is less obvious than for normal displacement regarding the effect of nonlinearity produced by large amplitude motion as seen from fig 11 a and b the resulting nonlinear stiffness has a small effect on the time history of riser displacement at least for the mid depth location y s 500 m of the riser fig 13 a and b represent the distributions of displacement amplitudes in the normal and tangential directions respectively along the vertical coordinate of the riser the amplitude response for the case of uniform flow of internal fluid a i o 0 m s2 and v i a 0 m s analyzed from previous section ω w ω l 1 is also plotted in this figures to compare with the case of oscillatory flow considering eq 4 and eq 32 it can be seen that the fluctuation frequency of the transported fluid affects directly the frequency of the excitation force since the variation in fluctuation frequency may induce instability caused by parametric resonances panda and kar 2007 wang et al 2018 of the riser oscillation it is not necessary for the fluctuation frequency to always increase the vibration amplitude of the riser this result can be confirmed as is graphically illustrated in fig 13 a and b the displacement amplitude which is computed from ω i ω l 1 is smaller than the displacement amplitudes simulated from ω i ω l 2 and ω i ω l 3 this result is due to the phase lag between the combined excitation forces being π 2 radians see eqs 4 8 and 32 so that the displacement responses from these two forces may cancel each other directly when the forcing frequencies of the combined excitation forces are identical to each other the effect of the phase lag between the combined excitation forces also provides the hardening phenomena as shown in fig 13 a and b the geometric nonlinearity causes a hardening behaviour especially at the position of maximum vibration amplitude however at the other riser position the softening behavior of nonlinearity could appear in addition the lower pulsatile frequency contributes a higher effect of geometric nonlinearity on riser response than the higher frequency considering the pattern of displacement amplitudes in fig 13 a and b for different fluctuation frequencies of the transported fluid there are two peaks and one peak on the distributions of normal displacement and tangential displacement amplitudes respectively which correspond to the first fundamental vibration mode shape this result confirms that the response amplitude of the riser is dominated by the forcing frequency of the hydrodynamic wave ω w ω l 1 but the forcing frequency of the internal pulsatile flow has minimal influence fig 14 a and b illustrate the time histories of the displacement contour along the vertical coordinate of the riser for normal and tangential displacements respectively only numerical simulation for ω i ω l 3 with lav analysis is provided in these figures these results clearly show that the displacement contour of the overall riser length also has vibration characteristics at a mid depth location as given in previous figures 4 conclusions large amplitude forced vibration analysis of a deepwater marine riser carrying internal pulsating flow was investigated the variational formulation concerning large amplitude vibration was developed based on the work energy principle and extensible elastica theory the nonlinear stiffness up to a second order of the riser displacement was regarded in the equation of motion which was further integrated along a time variable using the newmark method incorporated direct iteration the dynamic response of the riser caused by the hydrodynamic wave was a closely harmonic response which accepted the ocean wave forces characteristic the effect of the forcing frequency influenced both the displacement amplitude patterns and their values which was consistent with the parametric resonance of the oscillation phenomenon if the forcing frequency was close to the natural frequencies of the riser system it yielded the resonance phenomenon and the amplitude of vibration became larger the natural vibration for the first mode of the riser system was a major contribution to the forced dynamic response than their higher modes the pattern of displacement amplitude was also acceptable with the fundamental mode shape of the riser because the axial stiffness strongly dominated the vibration characteristics of a deepwater riser the contribution of the nonlinear effect produced by nonlinear geometry had a greater influence on the tangential displacement than normal displacement in addition the contribution of the nonlinear geometric effect was sensitive to low wave frequency and caused the riser to be a softening type the linearized small amplitude of vibration caused an underestimate of analysis especially at the location of maximum vibration amplitude the combination of the internal pulsatile flow and environmental ocean wave force yielded of the periodic response with the beating phenomenon only when their forcing frequencies were not identical to each other the pattern of the amplitude response was more sensitive to the forcing frequency of the hydrodynamic wave than that of the internal pulsatile flow the pulsatile flow dominated the riser since it acted in axial compression and stiffened the riser system especially at the location of maximum vibration amplitude however at other location the softening behavior of nonlinearity could appear credit authorship contribution statement karun klaycham conceptualization methodology software writing original draft validation formal analysis funding acquisition chainarong athisakul investigation writing review editing project administration somchai chucheepsakul investigation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was financially supported by the thailand research fund trf under contract no mrg6280051 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107966 
21418,vortex induced vibrations viv are generally evaluated with relatively simpler two dimensional 2d methods using direct numerical simulation dns large eddy simulation les or ranse based reynolds averaged navier stokes equations methods computationally these 2d approaches have relatively lower costs which make them more suitable for such applications however 2d flow assumes that there are no tip flows at both ends or no cross flows along the moving body cellular shedding which also adds three dimensionality in viv is also neglected this study proposes a simpler 2d computational approach that accounts for the three dimensional 3d flow for viv a three dimensionality factor is introduced to the forced vibration equation which allows calibration of numerical solutions with experiments numerical model presented in this study is developed for practical engineering approaches and takes all three dimensional effects into account the model is tested with two different experimental setups the first one is with the experiments carried out at the ata nutku ship model testing laboratory and the second is with the experiments published in the literature results of this study show that as the effects of tip flow cellular shedding and cross flows increase range of synchronization decreases the other outcome of this study is that the method adopted in this paper can be used to enhance numerical simulations of vibrating bodies in fluids keywords flow induced motions 2d viv 3d viv effect of aspect ratio tip flow abbreviations 2d two dimensional 3d three dimensional cfd computational fluid dynamics dns direct numerical simulation fsi fluid structure interaction les large eddy simulation ranse reynolds averaged navier stokes equations re reynolds number trsl transition shear layer viv vortex induced vibrations vivace vortex induced vibrations aquatic clean energy symbols a acceleration of the cylinder a amplitude a non dimensional amplitude a d c mechanical damping c a added mass coefficient in still water c l lift coefficient calculated by cfd c z lift coefficient calculated by math model c z v o r lift coefficient due to vortex shedding calculated by math model d cylinder diameter f n v natural frequency in vacuum f n w natural frequency in still water f o s c oscillation frequency f t u r b turbulence term in n s equations f v non dimensional frequency in vacuum f o s c f n v f non dimensional frequency in water f o s c f n w f fluid force f p o t potential part of the fluid force f v o r fluid force due to vortex shedding k spring stiffness l cylinder length m d displaced mass m o s c oscillating mass m mass ratio p pressure t time δ t time step size u flow velocity along x direction u flow velocity u reduced velocity u v reduced velocity in vacuum w flow velocity along z direction w c velocity of the cylinder w t test section width x horizontal direction z vertical direction z c vertical position of cylinder α three dimensionality factor ζ damping coefficient ζ v damping coefficient in vacuum ρ fluid density φ total phase difference φ v o r phase difference due to vortex shedding ω n v natural frequency in vacuum in radians ω o s c oscillation frequency in radians 1 introduction in studies involving vortex induced vibrations numerical methods are used to provide better understanding of experimental work at times these methods may even constitute the entire work in either case a numerical study should be capable of representing realistic experimental conditions however many studies in the literature greatly simplify this flow induced motion and implement a two dimensional domain cross flows cellular shedding and tip effects cannot be modeled with this type of numerical approach the chaotic nature of vortex induced vibrations is greatly reduced this might be a fair assumption in cases where only comparisons regarding the effect of parameters are required however in engineering applications the objects in the fluid have finite length the flow is significantly different at the tips which alters its response flow escaping through the tips also excite additional cross flows and cellular shedding although two dimensional flow is unable to resolve for such phenomena it is an indispensable approach in numerical simulations considering that it greatly reduces computational time in this study we focus on enhancing two dimensional computational approach by considering the three dimensionality of the flow and tweaking the forced vibration equation accordingly viv involves highly complex fluid structure interaction process therefore the flow is highly nonlinear there are numerous assumptions to numerically present solutions 2d flow approximation is one of the widely used assumptions in this field as longitudinal deviations of the vortex shedding process along the cylinder are neglected this presents a simpler approach while still providing good results high number of papers in the related literature adopt 2d flow assumptions to numerically approach the viv problem and some notable studies can be given as guilmineau and queutey 2002 pan et al 2007 wanderley et al 2008 wu et al 2014 khan et al 2018 pigazzini et al 2018 along many others number of 3d numerical studies are limited when compared to 2d numerical studies limited number of studies are due to need for higher number of elements a notable reduction in time step size and moreover more advanced turbulence model the methods are first established using 2d flow approximation and then these results are extended to 3d models blackburn and karniadakis 1993 have used spectral element method for 2d simulations approximately a decade later dong and karniadakis 2005 used the same method and presented 3d numerical results for a stationary and oscillating cylinder with reynolds number of r e 10000 using dns the authors used two level parallel algorithm to handle computational cost saltara et al 2011 used arbitrary lagrangian eulerian ale formulation to solve for 3d viv and obtained good fit with experiments some other numerical studies focus on the difference between 2d and 3d flow assumptions zhao et al 2014 identified the difference between the flow transition from 2d to 3d in the lock in regime bin a rahman 2015 numerically and experimentally studied the flow around a cylinder in viv having different aspect ratios the author observed that lock in region decreases with a decrease in the aspect ratio of the cylinder and no lock in was achieved when the aspect ratio is 0 5 zhao et al 2014 numerically proved that 2d and 3d numerical simulations are identical for low reynolds number flows authors also mention the need for 3d simulations for increasing reynolds numbers this study was made for a cylinder in viv for reynolds number range of 30 000 r e 120 000 which is at trsl3 transition shear layer 3 flow regime as identified by zdravkovich 2003 therefore it is considered that 3d flow phenomenon such as cross flows or cellular shedding may play an important role in viv if the aspect ratio of the cylinder is high and the flow can escape through the tips dejong and liang 2014 also found the same results and showed that as the reynolds number increases the flow behaves more like 3d authors showed significantly small difference between 2d and 3d assumptions for r e 350 but concluded that as the r e increases the vorticities are not constrained to be shed uniformly along the span wise direction this turns 2d flow assumptions invalid to represent a highly 3d viv case this study focuses on a cylinder in viv with only one degree of freedom the cylinder is smooth and can only move perpendicularly to the flow the cylinder is assumed to be submerged deep in water and located far from the seabed therefore no free surface or bottom boundary effects are present based on these assumptions in this study we propose a three dimensionality factor to enhance 2d numerical flow solutions to viv remaining part of the study is organized as follows section 2 explains the motivation of this study and presents two distinct examples to highlight the effect of fluid loss from the tips section 3 presents the physical interpretation of the three dimensionality factor section 4 presents our numerical approach and numerical implementation in simulations section 5 shows an example of the insufficiency of linear mathematical models in using the three dimensionality factor in section 6 we present our numerical results obtained for different three dimensionality factors the underlying physical phenomena is considered and explained by calculating vortex force total force and the phase difference between cylinder and vortex shedding applications of the proposed three dimensionality factor to two different experimental setups are also given in the same section in section 7 we discuss the necessity of including the three dimensionality factor in 2d numerical simulations and finally we present our conclusions in section 8 2 motivation of this study vortex induced vibrations are highly non linear as stated previously and mathematically approaching this problem is highly complex there are numerous assumptions in different mathematical models for example potential based models ignore viscosity but include an added mass term in the models to account for viscosity related phenomena computational fluid dynamics cfd based approaches usually utilize rans equations where only the largest flow features are considered and a simple 2d approach which is the focus of this study viv experiments are usually conducted in relatively sheltered environments in these environments flow is uniform free surface and bottom boundaries are sufficiently far away and the oscillating body extends to side boundaries as much as possible to avoid additional chaos in the flow however these can hardly be observed in nature and the flow is usually non uniform and 3d this additional complexity in real flows cannot be modeled with the existing computational approaches sumner et al 2004 stated that free ends of an oscillating body can change the whole flow in the fluid domain cylinders with smaller aspect ratios create additional complexity in computational studies due to flow that escapes through the tips one of the first viv experiments was conducted by feng 1968 when govardhan and williamson 2000 tried to reproduce results of feng using similar flow parameters thirty years later it was found that there is a different viv response which is given in fig 1 govardhan and williamson 2000 attributed this difference to the 3d flow in feng s experiments in their study authors mentioned that end plates at the free ends of the cylinder were used to encourage 2d flow fig 1 reveals that the maximum achieved amplitudes were approximately same in both experiments but the range of synchronization was broader than feng the idea of introducing an additional term in the mathematical model of viv was born from this figure clearly cylinder used more of its surface area in govardhan and williamson s experiment as end plates smooth the flow at each end another example is present in kinaci et al 2016 authors have tried similar flow parameters in two different laboratory setups yet obtained two distinct viv behaviors in their experiments the oscillating mass was m o s c 1 7 k g natural frequency in water was f n w 1 1 h z and the damping coefficient was ζ 0 02 the comparison is given in fig 2 the results presented in fig 2 are similar to those results given in fig 1 the range of synchronization is broader and amplitudes are higher in the laboratory setup that favors 2d flow 3 physical interpretation of the three dimensionality factor to explain and present 3d flow using a 2d mathematical approach the fluid force applied on the moving body must be adjusted the underlying reason is that the oscillating body fails to use all parts when it is subjected to flow escaping from its tips kawamura et al 1984 have investigated the flow around a finite circular cylinder established on a flat plate and experimentally found that wake flow changes from the root of the cylinder to the tips authors also provided an illustrative figure given in fig 3 and showed wake modes along cylinders with different aspect ratios in that figure it is clearly seen that karman vortex disappears in the cylinder with shorter aspect ratio and there are only root and tip vortexes however as the aspect ratio increases there is a karman vortex growing at the middle parts of the cylinder this karman vortex is the main contributor to oscillatory motion in viv 2d flow assumptions in mathematical models lead to assuming that karman vortex covers the whole body of the cylinder in other words this type of assumption expresses that the cylinder is using 100 of the flow finite cylinders with a free tip at the end inevitably lose some parts of their body to the trailing vortex and these parts are not producing lift this loss must be included in the mathematical models and the three dimensionality factor is believed to cover for this gap in computations loss of flow through the free ends of the cylinders are investigated in more detail in the review paper of sumner 2013 the additional term in the mathematical model is presented in the next section this term however should change the range of synchronization dramatically while changing the amplitude response of the cylinder as explained in section 2 the effect of the proposed additional term in this paper significantly alters the upper branch of the viv response and this is proved in the following sections 4 details of the numerical study the details of the numerical approach implemented in this study is given in this section first the numerical approach to determine the displacement of the cylinder in time is presented then numerical implementation of the approach using a computation fluid dynamics based method is explained 4 1 numerical approach a cylinder fails to use all the fluid force that can act on the cylinder it loses some part of the flow as explained in the previous section therefore only a part of this force should be included in calculations fluid force is scaled by introducing a three dimensionality factor called α and integrating it in the vibration equation integration of α into the forced vibration equation for a cylinder in a steady flow attached with springs on both ends is 1 m o s c z c c z c k z c α f t fig 4 has the diagram that summarizes the physics of the problem here m o s c is the total mass of the oscillating body c is the total damping only due to the mechanical parts of the body such as springs k is the spring stiffness and f t is the fluid force acting on the body at each time step z c is the vertical position of the cylinder and z c and z c are the first and second derivatives of the displacement indicating the velocity and the acceleration of the body respectively as implied f t is a function of time and 2d flow assumption takes the maximum of α 1 α value should be lower for real flows showing 3d behavior equation 1 separates the mechanical vibration indicated on the left hand side and the fluid force applied on the body indicated on the right hand side this type of discretization allows a better computational approach the fluid force is calculated at each time step while the position of the body is calculated by the properties of the moving body when acceleration term z c is alone on the left hand side and equation 1 is rewritten we obtain 2 z c α f t c z c k z c m o s c f t is calculated by the navier stokes equation c k and m o s c are known beforehand from the properties of the moving body unknown elements in equation 2 are acceleration z c the velocity z c and the displacement z c however the relationship between these three terms 3 d z c z c d t z c d t d t reduce unknown elements to one when acceleration term is found velocity and displacement can be calculated using equation 3 rewriting equation 3 numerically form two equations which are 4 z c t 1 z c t w c t 1 δ t 5 w c t 1 w c t a t 1 δ t t denotes time while t 1 indicates next time step in these equations δ t is time step size w c is vertical velocity z c and a is acceleration z c of the moving body by placing equation 5 into equation 4 displacement can be given as 6 z c t 1 z c t w c t δ t a t 1 δ t 2 in short equation 6 is the numerical rearrangement of equation 3 the acceleration term a t 1 z c in equation 6 can be calculated by using equation 2 rewriting equation 2 in numerical form 7 a t 1 a t α f t 1 c w c t k z c t m o s c the acceleration term can be calculated by equation 7 given the initial acceleration a t velocity w c t and displacement z c t of the moving body as already stated f is the fluid force and f t 1 is found by navier stokes equations for next time step to find the displacement of the moving body equation 7 is placed inside equation 6 to form 8 z c t 1 z c t w c t δ t a t α f t 1 c w c t k z c t m o s c δ t 2 equation 8 gives the displacement of the moving body at each time step the cylinder is positioned at origin and stationary at t 0 therefore 9 z c 0 w c 0 a 0 0 the fluid force is responsible for the movement of the body notice that z c t 1 0 when f t 1 0 therefore a flow velocity must be present for the body to have a displacement stated by equation 8 making use of the initial conditions given in equation 9 and writing equation 8 for first time step forms the following equation 10 z c 1 z c 0 w c 0 δ t a 0 α f 1 c w c 0 k z c 0 m o s c δ t 2 α f 1 m o s c δ t 2 the displacement at each time step can be calculated using equation 8 and the initial conditions provided in equation 9 there are also other forms of numerical approach to solving the displacement of the cylinder a fourth order runge kutta method was utilized by zhu and yao 2015 to solve the equations of motion zou et al 2019 have also implemented a similar approach and they also used fourth order runge kutta the model presented in this section reflects the authors approach to numerically solve cylinder oscillation in time the flow diagram of the mathematical procedure given in this section is briefly explained in fig 5 as implied in the flow diagram given in fig 5 the mathematical procedure adopts a two way fluid structure interaction fsi approach a stationary body is first excited by the fluid and moves transversely to the flow which forms the first part of the fsi this vertical movement in the flow disturbs and changes flow characteristics around the body and forms the second part of the fsi the fluid causes oscillation of the body and in return this fluid is affected from this oscillation the response of the fluid is based on momentum equations 2d forms of the navier stokes equations are given as 11 ρ u t u u x w u z p x μ 2 u x 2 2 u z 2 f t u r b x 12 ρ w t u w x w w z p z μ 2 w x 2 2 w z 2 f t u r b z in these equations f t u r b represents terms related to turbulence and depends on adopted turbulence model placing pressure terms in navier stokes equations presents fluid force f t applied on the oscillating body and may be used for modelling two way fsi problem presented in this study 4 2 numerical implementation next section shows that utilizing three dimensionality factor with the linear mathematical models remains incapable of adjusting the range of synchronization of viv this is because instead of solving the flow with linear mathematical models these models only help reconstructing fluid force with α to calibrate the upper branch response of viv phase differences must also be reconstructed therefore momentum equations must be solved 2d navier stokes equations are presented in equations 11 and 12 these equations must be solved along the complete fluid domain with continuity equation this can be achieved by adopting a finite volume method in this paper momentum equations are solved with this numerical method the size of computational domain is 35 d x 14 d where d denotes the cylinder diameter the dimensions of the fluid domain were selected considering sufficient space for vortex motions zou et al 2019 and assuring that cylinder motion is not affected by the top and bottom walls raghavan et al 2009 the domain has two distinct regions in terms of mesh properties the first region consists of quadrilateral elements and moves together with the cylinder implementation of quadrilateral elements help reducing the number of elements and helps better visualization of flow details kinaci 2016 the second region consists of remaining fluid domain and this region is stationary in this region triangular elements are used and these elements are deformable as the cylinder oscillates the first region moves together with the cylinder into the second region the deformable triangular elements are reconstructed at each time step with respect to movement of the first region a view of the computational domain is given in fig 6 a summary of selections in the pre processing stage of the numerical simulations are given in table 1 initially there were total of 12 000 elements 7000 in region 1 and 5000 in region 2 in the computational domain the cylinder surface was modeled by 100 elements elements were π d 100 wide the first cell height which is very important in time step size calculations with the aid of cfl condition was 0 003 d the vicinity of the cylinder was meshed using an o grid type of meshing remaining parts of region 1 wake had a structured mesh a similar grid structure was implemented to solve viv flow around rough cylinders by gao et al 2018 due cylinder motions and the first domain surrounding it triangular elements in region 2 may get regenerated sometimes especially when the cylinder motions are large triangular elements split and the number of elements in the domain increase drastically such increase in the number of triangular elements prevents the deformable elements from becoming highly skewed the authors noted elements as high as 50 000 more than four times of the initial while simulating the upper branch response of the cylinder new elements formed with cylinder oscillation can be seen in fig 7 smaller triangular elements just around the first domain can be seen in this figure when compared with fig 6 this type of dynamic meshing strategy works as follows dobrucali and kinaci 2017 the cylinder moves to compress decompress the triangular elements around region 1 elements can be compressed until reaching a prescribed value if the prescribed value is exceeded the triangular element splits into two new elements a k ω s s t turbulence model was used to only consider largest features of the flow ranse turbulence models are insufficient to analyze the wake modes of viv but these models are sufficient to assess quantitative data such as amplitude and frequency responses sarpkaya 2004 pressure velocity coupling was made with simple algorithm momentum turbulent kinetic energy and specific dissipation rate were all first order upwind the time step size was selected according to cfl condition the results were obtained for a minimum t 10 s of flow simulation the time step size was selected as δ t 0 0025 s which is about δ t f n w 450 for 2dof viv for 3d cylinders martins and avila 2019 used δ t f n w 200 and state that lower values of time step size do not significantly alter numerical results the time step size was chosen based on two dimensional cfl condition maximum courant number for simulations was approximately c m a x 1 number of inner iterations per time step was selected as 50 such high inner iteration was selected to keep the residuals as low as possible this way flow details near the boundaries can accurately be predicted before running transient mode of numerical simulations flow around stationary cylinder was solved first with a steady approach small numerical errors during the transient stage may eventually accumulate to cause significant errors in numerical simulations results of steady flow around the stationary cylinder are used as an initial condition at the beginning of the transient stage t 0 using steady flow as a preamble for unsteady case reduces the risk of errors in numerical simulations 4 3 validation of numerical approach our numerical approach was validated with benchmark experiments of khalak and williamson 1996 their experiments are used by many researchers who conduct numerical simulations to compare their results with measured data amplitude and frequency response of circular cylinder was measured at trsl2 flow regime reynolds number range is around 3000 r e 12000 although the experiments were conducted in water results were presented with respect to reduced velocity in vacuum u v u f n v d comparison of our results with experiments of khalak and williamson 1996 and numerical results of guilmineau and queutey 2002 pan et al 2007 wanderley et al 2008 and wu et al 2014 are given in fig 8 4 4 grid and time step dependency dependency of results on grid structure and time step size was tested for a cylinder that has a mass ratio of m 1 725 at a reduced velocity of u 6 natural frequency in still water is f n w 1 1183 the flow is taken as strictly two dimensional so α 1 three different grids and three different time steps were tested results are given in table 2 as it can be seen from table 2 all results are very close to each other median values of number of cells and time step size were used in the rest of this study fluid domain was represented by 12 000 elements using a time step size of δ t 0 0025 s 5 altering existing linear mathematical models with three dimensionality factor introduction of correction term α adds further nonlinearity in computations therefore using it with the existing linear mathematical models does not serve to intended purpose given in section 2 before moving on to present the generated results using the procedure explained in this study α is tested with a linear math model first this model conventionally uses variables calculated in vacuum for simplicity to prevent any added mass terms therefore a similar approach is also used here let us assume an arbitrarily defined and non dimensional amplitude and frequency response for a cylinder in viv dictated by the equations 13 a u v 6 f o r u v 5 u v 40 0 75 f o r 5 u v 10 u v 6 8 3 f o r u v 10 14 f v u v 6 u v in these equations is the reduced velocity in vacuum a is the non dimensional amplitude a d and f v is the oscillation frequency non dimensionalized by the natural frequency in vacuum f o s c f n v mass ratio of this cylinder is m 1 natural frequency in vacuum is f n v 1 and the damping coefficient in vacuum is ζ v 0 05 for simplicity rewriting equation 1 without the correction term α and plugging in ζ v c 2 m o s c k and ω n v k m o s c would return 15 m o s c z c 2 ζ v ω n v z c ω n v 2 z c f t assuming that the cylinder motion is purely sinusoidal moving with a frequency ω o s c it is possible to set 16 z c t a sin ω o s c t 17 f t 1 2 ρ d l u 2 c z sin ω o s c t φ taking the first and second derivatives of equation 16 and placing these equations into equation 15 gives us 18 m o s c a ω o s c 2 sin ω o s c t 2 ζ v ω n v a ω o s c cos ω o s c t ω n v 2 a sin ω o s c t 1 2 ρ d l u 2 c z sin ω o s c t φ collecting sine and cosine terms in equation 18 shows two distinct equations setting ω o s c 2 π f o s c ω n v 2 π f n v and non dimensionalizing the equation by 19 a a d m m o s c m d f v f o s c f n v u v u f n v d will reduce the linear mathematical model to two equations after some algebraic transformations 20 c z cos φ 2 π 3 a m 1 f v 2 u v 2 21 c z sin φ 4 π 3 a m ζ v f v u v 2 in equations 20 and 21 c z is the total lift coefficient provided by the fluid which is non dimensionalized by morison equation and φ is total phase difference let us also assume that we want to scale the fluid force by α 0 5 and compare the viv response with α 1 the scaling of the fluid force is made by 22 c z α c z comparison of the amplitude responses for α 0 5 and α 1 is given in fig 9 the lift coefficient and phase difference graphs are given in fig 10 the lift coefficient of the cylinder for α 0 5 is half of α 1 as per equation 22 and the phase difference remains constant for both α this is because the scaling was only applied to fluid force but not to phase difference the results appear on the viv response as a linear decrement in the amplitudes fig 9 due to constant phase difference therefore range of synchronization remains constant for both α three dimensionality of the flow changes the phase difference as well as the fluid force and these changes in the phase difference must also be considered for better approximation of the viv response which forms the major drawback of linear mathematical model 6 results using three dimensionality correction term along with numerical procedure explained in previous sections results were computed for a smooth cylinder with 1dof and moving transversely to the flow these results are presented in this section three dimensionality factor was also tested in two different experimental setups the first one was the water channel located in the ata nutku ship model testing laboratory of istanbul technical university the second test was conducted for experiments published in literature carried out at a towing tank in ferdowsi university of mashhad iran 6 1 numerical results with scaling the lift force in this section numerical results are given for scaling the lift force and they are compared with strictly two dimensional case α 1 details of oscillator system are given in table 3 the natural frequency in still water is non dimensionalized by the added mass coefficient in still water although it is believed that a recent study may alter the current perspective on the added mass bernitsas et al 2019 this subject is still discussed in the field there are certain studies on added mass changing with the flow velocity vikestad et al 2000 but non dimensionalization process in current literature still relies on constant added mass coefficient therefore in this study c a was taken as a constant and equal to 1 in calculation of the oscillator system particulars reynolds number is varied between 30 000 and 120 000 which lies on the trsl3 flow regime as identified by zdravkovich 2003 this is a relatively unexplored viv region due to the chaotic nature of the flow at these flow speeds kinaci 2016 the results are presented for three different correction terms α 0 5 α 0 7 α 0 87 and α 1 the case of α 1 presents a full 2d flow amplitude and frequency responses of the cylinder at different α are given in fig 11 upper branch clearly narrows with increasing α and this can be seen in amplitude response of the cylinder in fig 11 left as the cylinder loses more part at its tips and fails to use of the force generated by the fluid range of synchronization shrinks and the end of the upper branch moves to u 7 at α 0 5 when it was u 11 12 at α 1 there is also a notable reduction in the amplitudes in lower branch with decreasing α the oscillation frequency for all cases of α is given in fig 11 right in that figure the frequency f is non dimensionalized by natural frequency in water f o s c f n w when these frequencies are compared with schematic illustration by sumer and fredsoe 2006 given in fig 12 narrowing of the range of synchronization or lock in regime can be seen from frequency response as well to specifically identify lock in region at each α this schematic illustration is used lock in region i e range of synchronization at each α as per sumer and fredsoe 2006 are listed in table 4 it was shown in previous sections that the linear mathematical model failed to narrow down range of synchronization in the model it was possible to scale the fluid force but not the phase difference and this led to a total reduction in amplitude response on the other hand width of the upper branch remained constant to understand how the mathematical approach presented in this paper changed the upper branch we have to take a look at what happens to fluid force and phase difference using amplitude and frequency responses obtained numerically however simulations in this study are made for viv in water and it is possible to carry the mathematical model one step further before representing these results the total force given in equation 1 can be decomposed into two namely the potential force f p o t which is related to the added mass and the vortex force f v o r due to periodic vortex shedding from the cylinder potential force f p o t can be expressed by 23 f p o t c a m d z c m a z c where m d is displaced mass m a is added mass and c a 1 is added mass coefficient in still water similar to the model provided in section 5 if the same procedure is applied for viv in water we get 24 c z v o r cos φ v o r 2 a π 3 m 1 1 f 2 u 2 25 c z v o r sin φ v o r 4 a π 3 ζ f m 1 u 2 equations 24 and 25 are in non dimensional form following relations were used during the non dimensionalization process 26 a a d m m o s c m d f f o s c f n w u v u f n w d in these equations c z v o r is vortex force coefficient while φ v o r is phase difference between oscillation and vortex shedding the results are shown in fig 13 the fluid force in numerical calculations shows a perplexing behavior as vortex force coefficients of α 0 5 are higher than α 0 7 for u 5 except a single point at u 8 however as already stated before force itself is not the only driving mechanism of the oscillation amplitude phase difference also plays significant role on this process when vortex phase difference graph is observed it can be seen that this graph is also changing with varying α three dimensionality factor majorly affects amplitudes in lower branch as seen in fig 11 left to obtain a better insight of the physics behind this branch displacement versus total lift coefficient c l generated by cfd simulations in time is given in fig 14 for each α it should be reminded here that the total lift coefficient c l obtained from cfd simulations is not equal to c z v o r vortex force is only a component of the total force it can be observed from this figure that fluid force is out of phase with the oscillation for all cases as the total lift coefficient opposes displacement this is compliant with fig 13 as φ v o r 150 o at u 10 for each α amplitudes are higher for greater α due to decreasing total lift that acts reversely to oscillation of the cylinder until now underlying mechanism of how the three dimensionality factor changes the flow aspects was implicitly shown by presenting viv responses mathematically obtained phase differences etc physically three dimensionality factor changes boundary layer separation along the cylinder vortex shedding phenomenon becomes inherently different as the flow escapes through the tips i e α is reduced to visualize the effect of α flow around the cylinder in viv was captured at four different instances positions of the cylinder at these instances are summarized below position 1 the cylinder is at the origin and moving upwards position 2 the cylinder is at its upper extreme and will go down position 3 the cylinder is at the origin and moving downwards position 4 the cylinder is at its lower extreme and will go up the velocity vectors around the cylinder in viv at u 10 are given for α 1 left and α 0 5 right in fig 15 reversed flow after separation can clearly be seen in the wake region of the cylinder although given for rough cylinders with two strips on its surface a similar figure is also present in zhu et al 2018 at u 9 79 and may be used for comparison wang et al 2019 provide instantaneous views of cylinder wake for smooth cylinders for similar positions 6 2 application to experiments carried out at ata nutku ship model testing laboratory viv experiments were carried out at the circulation tunnel located at ata nutku ship model testing laboratory the tunnel has a test section width of 1 5 m and a depth of 0 64 m the blockage ratio at each section is 12 5 a view of the channel is given in fig 16 left the channel streams a uniform steady current towards the stationary viv apparatus a digital rpm controller is used to scale the velocity of the current over the range 0 u 1 56 m s the experimental setup consists of a horizontal cylinder hanging down from the main frame and standing inside the streaming water channel the viv apparatus can be seen in fig 16 right and the experimental conditions are given in table 5 the viv motion was captured by the open source electronics platform arduino arduino boards have a number of facilities for communicating with computers other boards sensors microcontrollers etc a functional code was developed to run with 16 mhz clock speed arduino mega 2560 board a pair of compatible ultrasonic sensors were used to receive the reflecting sound waves over moving components of the viv system the sensor can store 40 data points a second stored data was processed and denoised by the help of wavelets tool of matlab software eventually processed experimental results were compared with numerical simulations comparison of results are given in fig 17 experiments have returned a very narrow upper branch as it can be seen from fig 17 left numerical simulations with no three dimensionality the α 1 case had a wider range of synchronization as compared to experiments this range has narrowed down as three dimensionality was introduced into simulations the α 0 7 case 6 3 application to experiments carried out at towing tank results presented in this subsection are given for an experimental setup with low cylinder length as compared to the test section width experiments were carried out at a towing tank test conditions are given in table 6 the experimental setup of modir et al 2016 had a test section width of 50 c m but authors only tested a cylinder of length l 38 c m the flow could easily escape through the tips from 12 c m gap between cylinder and test section walls this fact should be considered in two dimensional numerical simulations and in our case it was handled by low α input comparisons of amplitude response for α 0 60 0 65 and 0 70 with experiments are given in fig 18 restriction of force using three dimensionality factor in the vibration equation helps limiting range of synchronization as presented in this figure change in α does not change the beginning of upper branch where the sudden jump in the amplitude response occurs on the other hand three dimensionality factor is effective on changing the end of upper branch where amplitudes start to drop for the experimental results presented in modir et al 2016 three dimensionality factor of experimental setup was found as α 0 60 7 discussion existing linear mathematical models allow to reconstruct the forces and phase differences at each reduced velocity by considering available viv responses of amplitude and frequency one of the novelties of this study is presenting a three dimensionality factor to enhance 2d numerical simulations however implementation of this correction term within linear math models do not help to limit range of synchronization of viv this method only helps to reduce amplitude response range of synchronization mainly handles phase difference in oscillation and vortex shedding linear math models fail to solve flow but allow to calculate fluid force with existing amplitude and frequency responses however only changing fluid force in these models is insufficient to capture flow characteristics of viv therefore momentum equations must be solved utilizing three dimensionality factor in the forced vibration equation adopting the methodology proposed in this study both fluid force and phase differences are adjusted to better approximation of the motion characteristics adding α into calculations to represent three dimensionality allows analyzing how amplitude response and lock in mechanism can reduce although the correction term which represents three dimensionality of the system changes the vortex force as presented in fig 13 left this term also changes phase difference between vortex shedding and cylinder oscillation shown in fig 13 right karman vortex in the wake region shown in fig 3 vanishes and the cylinder loses main supporting vortex that allows the cylinder to vibrate at high amplitudes viv behavior of the cylinder is significantly changed furthermore drastic change in phase difference at lower α reflects as a narrower range of synchronization region 8 conclusion in this study a numerical approach is presented to include 3d effects in 2d flow simulations the fluid force is scaled with respect to a correction term called three dimensionality factor and denoted by α momentum equations are solved for these variables forces on the moving body are found at each time step by the finite volume method the scaled fluid force is used at the right hand side of the forced vibration equation to solve oscillating motion of the body along with the methodology used in this paper the three dimensionality factor allows to calibrate range of synchronization of viv utilization of this factor with only linear mathematical models fails to satisfy the intended purpose since with such an approach only the fluid force can be changed the correction term is useful when the real flow is numerically solved by adjusting the phase difference as well besides calibrating calculations the three dimensionality factor also allows revealing the underlying physics of how amplitude and range of synchronization of the cylinder oscillation changes it was the focus of this study to reveal the 3d nature of viv flow and enhance 2d simulations with a three dimensionality factor applied to the fluid force in the vibration equation this correction term was randomly selected and applied in numerical simulations however as for the selection of α further studies need to be conducted viv response in different media and at different flow speeds show distinct behavior as there are many studies in the literature showing this difference it is believed that the difference in results are due to additional complexity of the added mass in water future studies can extend this method numerically and computationally to understand the effect of media and reynolds number credit authorship contribution statement aytekin duranay software investigation funding acquisition omer kemal kinaci conceptualization methodology validation data curation writing original draft writing review editing visualization supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author is supported financially by the turkish lloyd 
21418,vortex induced vibrations viv are generally evaluated with relatively simpler two dimensional 2d methods using direct numerical simulation dns large eddy simulation les or ranse based reynolds averaged navier stokes equations methods computationally these 2d approaches have relatively lower costs which make them more suitable for such applications however 2d flow assumes that there are no tip flows at both ends or no cross flows along the moving body cellular shedding which also adds three dimensionality in viv is also neglected this study proposes a simpler 2d computational approach that accounts for the three dimensional 3d flow for viv a three dimensionality factor is introduced to the forced vibration equation which allows calibration of numerical solutions with experiments numerical model presented in this study is developed for practical engineering approaches and takes all three dimensional effects into account the model is tested with two different experimental setups the first one is with the experiments carried out at the ata nutku ship model testing laboratory and the second is with the experiments published in the literature results of this study show that as the effects of tip flow cellular shedding and cross flows increase range of synchronization decreases the other outcome of this study is that the method adopted in this paper can be used to enhance numerical simulations of vibrating bodies in fluids keywords flow induced motions 2d viv 3d viv effect of aspect ratio tip flow abbreviations 2d two dimensional 3d three dimensional cfd computational fluid dynamics dns direct numerical simulation fsi fluid structure interaction les large eddy simulation ranse reynolds averaged navier stokes equations re reynolds number trsl transition shear layer viv vortex induced vibrations vivace vortex induced vibrations aquatic clean energy symbols a acceleration of the cylinder a amplitude a non dimensional amplitude a d c mechanical damping c a added mass coefficient in still water c l lift coefficient calculated by cfd c z lift coefficient calculated by math model c z v o r lift coefficient due to vortex shedding calculated by math model d cylinder diameter f n v natural frequency in vacuum f n w natural frequency in still water f o s c oscillation frequency f t u r b turbulence term in n s equations f v non dimensional frequency in vacuum f o s c f n v f non dimensional frequency in water f o s c f n w f fluid force f p o t potential part of the fluid force f v o r fluid force due to vortex shedding k spring stiffness l cylinder length m d displaced mass m o s c oscillating mass m mass ratio p pressure t time δ t time step size u flow velocity along x direction u flow velocity u reduced velocity u v reduced velocity in vacuum w flow velocity along z direction w c velocity of the cylinder w t test section width x horizontal direction z vertical direction z c vertical position of cylinder α three dimensionality factor ζ damping coefficient ζ v damping coefficient in vacuum ρ fluid density φ total phase difference φ v o r phase difference due to vortex shedding ω n v natural frequency in vacuum in radians ω o s c oscillation frequency in radians 1 introduction in studies involving vortex induced vibrations numerical methods are used to provide better understanding of experimental work at times these methods may even constitute the entire work in either case a numerical study should be capable of representing realistic experimental conditions however many studies in the literature greatly simplify this flow induced motion and implement a two dimensional domain cross flows cellular shedding and tip effects cannot be modeled with this type of numerical approach the chaotic nature of vortex induced vibrations is greatly reduced this might be a fair assumption in cases where only comparisons regarding the effect of parameters are required however in engineering applications the objects in the fluid have finite length the flow is significantly different at the tips which alters its response flow escaping through the tips also excite additional cross flows and cellular shedding although two dimensional flow is unable to resolve for such phenomena it is an indispensable approach in numerical simulations considering that it greatly reduces computational time in this study we focus on enhancing two dimensional computational approach by considering the three dimensionality of the flow and tweaking the forced vibration equation accordingly viv involves highly complex fluid structure interaction process therefore the flow is highly nonlinear there are numerous assumptions to numerically present solutions 2d flow approximation is one of the widely used assumptions in this field as longitudinal deviations of the vortex shedding process along the cylinder are neglected this presents a simpler approach while still providing good results high number of papers in the related literature adopt 2d flow assumptions to numerically approach the viv problem and some notable studies can be given as guilmineau and queutey 2002 pan et al 2007 wanderley et al 2008 wu et al 2014 khan et al 2018 pigazzini et al 2018 along many others number of 3d numerical studies are limited when compared to 2d numerical studies limited number of studies are due to need for higher number of elements a notable reduction in time step size and moreover more advanced turbulence model the methods are first established using 2d flow approximation and then these results are extended to 3d models blackburn and karniadakis 1993 have used spectral element method for 2d simulations approximately a decade later dong and karniadakis 2005 used the same method and presented 3d numerical results for a stationary and oscillating cylinder with reynolds number of r e 10000 using dns the authors used two level parallel algorithm to handle computational cost saltara et al 2011 used arbitrary lagrangian eulerian ale formulation to solve for 3d viv and obtained good fit with experiments some other numerical studies focus on the difference between 2d and 3d flow assumptions zhao et al 2014 identified the difference between the flow transition from 2d to 3d in the lock in regime bin a rahman 2015 numerically and experimentally studied the flow around a cylinder in viv having different aspect ratios the author observed that lock in region decreases with a decrease in the aspect ratio of the cylinder and no lock in was achieved when the aspect ratio is 0 5 zhao et al 2014 numerically proved that 2d and 3d numerical simulations are identical for low reynolds number flows authors also mention the need for 3d simulations for increasing reynolds numbers this study was made for a cylinder in viv for reynolds number range of 30 000 r e 120 000 which is at trsl3 transition shear layer 3 flow regime as identified by zdravkovich 2003 therefore it is considered that 3d flow phenomenon such as cross flows or cellular shedding may play an important role in viv if the aspect ratio of the cylinder is high and the flow can escape through the tips dejong and liang 2014 also found the same results and showed that as the reynolds number increases the flow behaves more like 3d authors showed significantly small difference between 2d and 3d assumptions for r e 350 but concluded that as the r e increases the vorticities are not constrained to be shed uniformly along the span wise direction this turns 2d flow assumptions invalid to represent a highly 3d viv case this study focuses on a cylinder in viv with only one degree of freedom the cylinder is smooth and can only move perpendicularly to the flow the cylinder is assumed to be submerged deep in water and located far from the seabed therefore no free surface or bottom boundary effects are present based on these assumptions in this study we propose a three dimensionality factor to enhance 2d numerical flow solutions to viv remaining part of the study is organized as follows section 2 explains the motivation of this study and presents two distinct examples to highlight the effect of fluid loss from the tips section 3 presents the physical interpretation of the three dimensionality factor section 4 presents our numerical approach and numerical implementation in simulations section 5 shows an example of the insufficiency of linear mathematical models in using the three dimensionality factor in section 6 we present our numerical results obtained for different three dimensionality factors the underlying physical phenomena is considered and explained by calculating vortex force total force and the phase difference between cylinder and vortex shedding applications of the proposed three dimensionality factor to two different experimental setups are also given in the same section in section 7 we discuss the necessity of including the three dimensionality factor in 2d numerical simulations and finally we present our conclusions in section 8 2 motivation of this study vortex induced vibrations are highly non linear as stated previously and mathematically approaching this problem is highly complex there are numerous assumptions in different mathematical models for example potential based models ignore viscosity but include an added mass term in the models to account for viscosity related phenomena computational fluid dynamics cfd based approaches usually utilize rans equations where only the largest flow features are considered and a simple 2d approach which is the focus of this study viv experiments are usually conducted in relatively sheltered environments in these environments flow is uniform free surface and bottom boundaries are sufficiently far away and the oscillating body extends to side boundaries as much as possible to avoid additional chaos in the flow however these can hardly be observed in nature and the flow is usually non uniform and 3d this additional complexity in real flows cannot be modeled with the existing computational approaches sumner et al 2004 stated that free ends of an oscillating body can change the whole flow in the fluid domain cylinders with smaller aspect ratios create additional complexity in computational studies due to flow that escapes through the tips one of the first viv experiments was conducted by feng 1968 when govardhan and williamson 2000 tried to reproduce results of feng using similar flow parameters thirty years later it was found that there is a different viv response which is given in fig 1 govardhan and williamson 2000 attributed this difference to the 3d flow in feng s experiments in their study authors mentioned that end plates at the free ends of the cylinder were used to encourage 2d flow fig 1 reveals that the maximum achieved amplitudes were approximately same in both experiments but the range of synchronization was broader than feng the idea of introducing an additional term in the mathematical model of viv was born from this figure clearly cylinder used more of its surface area in govardhan and williamson s experiment as end plates smooth the flow at each end another example is present in kinaci et al 2016 authors have tried similar flow parameters in two different laboratory setups yet obtained two distinct viv behaviors in their experiments the oscillating mass was m o s c 1 7 k g natural frequency in water was f n w 1 1 h z and the damping coefficient was ζ 0 02 the comparison is given in fig 2 the results presented in fig 2 are similar to those results given in fig 1 the range of synchronization is broader and amplitudes are higher in the laboratory setup that favors 2d flow 3 physical interpretation of the three dimensionality factor to explain and present 3d flow using a 2d mathematical approach the fluid force applied on the moving body must be adjusted the underlying reason is that the oscillating body fails to use all parts when it is subjected to flow escaping from its tips kawamura et al 1984 have investigated the flow around a finite circular cylinder established on a flat plate and experimentally found that wake flow changes from the root of the cylinder to the tips authors also provided an illustrative figure given in fig 3 and showed wake modes along cylinders with different aspect ratios in that figure it is clearly seen that karman vortex disappears in the cylinder with shorter aspect ratio and there are only root and tip vortexes however as the aspect ratio increases there is a karman vortex growing at the middle parts of the cylinder this karman vortex is the main contributor to oscillatory motion in viv 2d flow assumptions in mathematical models lead to assuming that karman vortex covers the whole body of the cylinder in other words this type of assumption expresses that the cylinder is using 100 of the flow finite cylinders with a free tip at the end inevitably lose some parts of their body to the trailing vortex and these parts are not producing lift this loss must be included in the mathematical models and the three dimensionality factor is believed to cover for this gap in computations loss of flow through the free ends of the cylinders are investigated in more detail in the review paper of sumner 2013 the additional term in the mathematical model is presented in the next section this term however should change the range of synchronization dramatically while changing the amplitude response of the cylinder as explained in section 2 the effect of the proposed additional term in this paper significantly alters the upper branch of the viv response and this is proved in the following sections 4 details of the numerical study the details of the numerical approach implemented in this study is given in this section first the numerical approach to determine the displacement of the cylinder in time is presented then numerical implementation of the approach using a computation fluid dynamics based method is explained 4 1 numerical approach a cylinder fails to use all the fluid force that can act on the cylinder it loses some part of the flow as explained in the previous section therefore only a part of this force should be included in calculations fluid force is scaled by introducing a three dimensionality factor called α and integrating it in the vibration equation integration of α into the forced vibration equation for a cylinder in a steady flow attached with springs on both ends is 1 m o s c z c c z c k z c α f t fig 4 has the diagram that summarizes the physics of the problem here m o s c is the total mass of the oscillating body c is the total damping only due to the mechanical parts of the body such as springs k is the spring stiffness and f t is the fluid force acting on the body at each time step z c is the vertical position of the cylinder and z c and z c are the first and second derivatives of the displacement indicating the velocity and the acceleration of the body respectively as implied f t is a function of time and 2d flow assumption takes the maximum of α 1 α value should be lower for real flows showing 3d behavior equation 1 separates the mechanical vibration indicated on the left hand side and the fluid force applied on the body indicated on the right hand side this type of discretization allows a better computational approach the fluid force is calculated at each time step while the position of the body is calculated by the properties of the moving body when acceleration term z c is alone on the left hand side and equation 1 is rewritten we obtain 2 z c α f t c z c k z c m o s c f t is calculated by the navier stokes equation c k and m o s c are known beforehand from the properties of the moving body unknown elements in equation 2 are acceleration z c the velocity z c and the displacement z c however the relationship between these three terms 3 d z c z c d t z c d t d t reduce unknown elements to one when acceleration term is found velocity and displacement can be calculated using equation 3 rewriting equation 3 numerically form two equations which are 4 z c t 1 z c t w c t 1 δ t 5 w c t 1 w c t a t 1 δ t t denotes time while t 1 indicates next time step in these equations δ t is time step size w c is vertical velocity z c and a is acceleration z c of the moving body by placing equation 5 into equation 4 displacement can be given as 6 z c t 1 z c t w c t δ t a t 1 δ t 2 in short equation 6 is the numerical rearrangement of equation 3 the acceleration term a t 1 z c in equation 6 can be calculated by using equation 2 rewriting equation 2 in numerical form 7 a t 1 a t α f t 1 c w c t k z c t m o s c the acceleration term can be calculated by equation 7 given the initial acceleration a t velocity w c t and displacement z c t of the moving body as already stated f is the fluid force and f t 1 is found by navier stokes equations for next time step to find the displacement of the moving body equation 7 is placed inside equation 6 to form 8 z c t 1 z c t w c t δ t a t α f t 1 c w c t k z c t m o s c δ t 2 equation 8 gives the displacement of the moving body at each time step the cylinder is positioned at origin and stationary at t 0 therefore 9 z c 0 w c 0 a 0 0 the fluid force is responsible for the movement of the body notice that z c t 1 0 when f t 1 0 therefore a flow velocity must be present for the body to have a displacement stated by equation 8 making use of the initial conditions given in equation 9 and writing equation 8 for first time step forms the following equation 10 z c 1 z c 0 w c 0 δ t a 0 α f 1 c w c 0 k z c 0 m o s c δ t 2 α f 1 m o s c δ t 2 the displacement at each time step can be calculated using equation 8 and the initial conditions provided in equation 9 there are also other forms of numerical approach to solving the displacement of the cylinder a fourth order runge kutta method was utilized by zhu and yao 2015 to solve the equations of motion zou et al 2019 have also implemented a similar approach and they also used fourth order runge kutta the model presented in this section reflects the authors approach to numerically solve cylinder oscillation in time the flow diagram of the mathematical procedure given in this section is briefly explained in fig 5 as implied in the flow diagram given in fig 5 the mathematical procedure adopts a two way fluid structure interaction fsi approach a stationary body is first excited by the fluid and moves transversely to the flow which forms the first part of the fsi this vertical movement in the flow disturbs and changes flow characteristics around the body and forms the second part of the fsi the fluid causes oscillation of the body and in return this fluid is affected from this oscillation the response of the fluid is based on momentum equations 2d forms of the navier stokes equations are given as 11 ρ u t u u x w u z p x μ 2 u x 2 2 u z 2 f t u r b x 12 ρ w t u w x w w z p z μ 2 w x 2 2 w z 2 f t u r b z in these equations f t u r b represents terms related to turbulence and depends on adopted turbulence model placing pressure terms in navier stokes equations presents fluid force f t applied on the oscillating body and may be used for modelling two way fsi problem presented in this study 4 2 numerical implementation next section shows that utilizing three dimensionality factor with the linear mathematical models remains incapable of adjusting the range of synchronization of viv this is because instead of solving the flow with linear mathematical models these models only help reconstructing fluid force with α to calibrate the upper branch response of viv phase differences must also be reconstructed therefore momentum equations must be solved 2d navier stokes equations are presented in equations 11 and 12 these equations must be solved along the complete fluid domain with continuity equation this can be achieved by adopting a finite volume method in this paper momentum equations are solved with this numerical method the size of computational domain is 35 d x 14 d where d denotes the cylinder diameter the dimensions of the fluid domain were selected considering sufficient space for vortex motions zou et al 2019 and assuring that cylinder motion is not affected by the top and bottom walls raghavan et al 2009 the domain has two distinct regions in terms of mesh properties the first region consists of quadrilateral elements and moves together with the cylinder implementation of quadrilateral elements help reducing the number of elements and helps better visualization of flow details kinaci 2016 the second region consists of remaining fluid domain and this region is stationary in this region triangular elements are used and these elements are deformable as the cylinder oscillates the first region moves together with the cylinder into the second region the deformable triangular elements are reconstructed at each time step with respect to movement of the first region a view of the computational domain is given in fig 6 a summary of selections in the pre processing stage of the numerical simulations are given in table 1 initially there were total of 12 000 elements 7000 in region 1 and 5000 in region 2 in the computational domain the cylinder surface was modeled by 100 elements elements were π d 100 wide the first cell height which is very important in time step size calculations with the aid of cfl condition was 0 003 d the vicinity of the cylinder was meshed using an o grid type of meshing remaining parts of region 1 wake had a structured mesh a similar grid structure was implemented to solve viv flow around rough cylinders by gao et al 2018 due cylinder motions and the first domain surrounding it triangular elements in region 2 may get regenerated sometimes especially when the cylinder motions are large triangular elements split and the number of elements in the domain increase drastically such increase in the number of triangular elements prevents the deformable elements from becoming highly skewed the authors noted elements as high as 50 000 more than four times of the initial while simulating the upper branch response of the cylinder new elements formed with cylinder oscillation can be seen in fig 7 smaller triangular elements just around the first domain can be seen in this figure when compared with fig 6 this type of dynamic meshing strategy works as follows dobrucali and kinaci 2017 the cylinder moves to compress decompress the triangular elements around region 1 elements can be compressed until reaching a prescribed value if the prescribed value is exceeded the triangular element splits into two new elements a k ω s s t turbulence model was used to only consider largest features of the flow ranse turbulence models are insufficient to analyze the wake modes of viv but these models are sufficient to assess quantitative data such as amplitude and frequency responses sarpkaya 2004 pressure velocity coupling was made with simple algorithm momentum turbulent kinetic energy and specific dissipation rate were all first order upwind the time step size was selected according to cfl condition the results were obtained for a minimum t 10 s of flow simulation the time step size was selected as δ t 0 0025 s which is about δ t f n w 450 for 2dof viv for 3d cylinders martins and avila 2019 used δ t f n w 200 and state that lower values of time step size do not significantly alter numerical results the time step size was chosen based on two dimensional cfl condition maximum courant number for simulations was approximately c m a x 1 number of inner iterations per time step was selected as 50 such high inner iteration was selected to keep the residuals as low as possible this way flow details near the boundaries can accurately be predicted before running transient mode of numerical simulations flow around stationary cylinder was solved first with a steady approach small numerical errors during the transient stage may eventually accumulate to cause significant errors in numerical simulations results of steady flow around the stationary cylinder are used as an initial condition at the beginning of the transient stage t 0 using steady flow as a preamble for unsteady case reduces the risk of errors in numerical simulations 4 3 validation of numerical approach our numerical approach was validated with benchmark experiments of khalak and williamson 1996 their experiments are used by many researchers who conduct numerical simulations to compare their results with measured data amplitude and frequency response of circular cylinder was measured at trsl2 flow regime reynolds number range is around 3000 r e 12000 although the experiments were conducted in water results were presented with respect to reduced velocity in vacuum u v u f n v d comparison of our results with experiments of khalak and williamson 1996 and numerical results of guilmineau and queutey 2002 pan et al 2007 wanderley et al 2008 and wu et al 2014 are given in fig 8 4 4 grid and time step dependency dependency of results on grid structure and time step size was tested for a cylinder that has a mass ratio of m 1 725 at a reduced velocity of u 6 natural frequency in still water is f n w 1 1183 the flow is taken as strictly two dimensional so α 1 three different grids and three different time steps were tested results are given in table 2 as it can be seen from table 2 all results are very close to each other median values of number of cells and time step size were used in the rest of this study fluid domain was represented by 12 000 elements using a time step size of δ t 0 0025 s 5 altering existing linear mathematical models with three dimensionality factor introduction of correction term α adds further nonlinearity in computations therefore using it with the existing linear mathematical models does not serve to intended purpose given in section 2 before moving on to present the generated results using the procedure explained in this study α is tested with a linear math model first this model conventionally uses variables calculated in vacuum for simplicity to prevent any added mass terms therefore a similar approach is also used here let us assume an arbitrarily defined and non dimensional amplitude and frequency response for a cylinder in viv dictated by the equations 13 a u v 6 f o r u v 5 u v 40 0 75 f o r 5 u v 10 u v 6 8 3 f o r u v 10 14 f v u v 6 u v in these equations is the reduced velocity in vacuum a is the non dimensional amplitude a d and f v is the oscillation frequency non dimensionalized by the natural frequency in vacuum f o s c f n v mass ratio of this cylinder is m 1 natural frequency in vacuum is f n v 1 and the damping coefficient in vacuum is ζ v 0 05 for simplicity rewriting equation 1 without the correction term α and plugging in ζ v c 2 m o s c k and ω n v k m o s c would return 15 m o s c z c 2 ζ v ω n v z c ω n v 2 z c f t assuming that the cylinder motion is purely sinusoidal moving with a frequency ω o s c it is possible to set 16 z c t a sin ω o s c t 17 f t 1 2 ρ d l u 2 c z sin ω o s c t φ taking the first and second derivatives of equation 16 and placing these equations into equation 15 gives us 18 m o s c a ω o s c 2 sin ω o s c t 2 ζ v ω n v a ω o s c cos ω o s c t ω n v 2 a sin ω o s c t 1 2 ρ d l u 2 c z sin ω o s c t φ collecting sine and cosine terms in equation 18 shows two distinct equations setting ω o s c 2 π f o s c ω n v 2 π f n v and non dimensionalizing the equation by 19 a a d m m o s c m d f v f o s c f n v u v u f n v d will reduce the linear mathematical model to two equations after some algebraic transformations 20 c z cos φ 2 π 3 a m 1 f v 2 u v 2 21 c z sin φ 4 π 3 a m ζ v f v u v 2 in equations 20 and 21 c z is the total lift coefficient provided by the fluid which is non dimensionalized by morison equation and φ is total phase difference let us also assume that we want to scale the fluid force by α 0 5 and compare the viv response with α 1 the scaling of the fluid force is made by 22 c z α c z comparison of the amplitude responses for α 0 5 and α 1 is given in fig 9 the lift coefficient and phase difference graphs are given in fig 10 the lift coefficient of the cylinder for α 0 5 is half of α 1 as per equation 22 and the phase difference remains constant for both α this is because the scaling was only applied to fluid force but not to phase difference the results appear on the viv response as a linear decrement in the amplitudes fig 9 due to constant phase difference therefore range of synchronization remains constant for both α three dimensionality of the flow changes the phase difference as well as the fluid force and these changes in the phase difference must also be considered for better approximation of the viv response which forms the major drawback of linear mathematical model 6 results using three dimensionality correction term along with numerical procedure explained in previous sections results were computed for a smooth cylinder with 1dof and moving transversely to the flow these results are presented in this section three dimensionality factor was also tested in two different experimental setups the first one was the water channel located in the ata nutku ship model testing laboratory of istanbul technical university the second test was conducted for experiments published in literature carried out at a towing tank in ferdowsi university of mashhad iran 6 1 numerical results with scaling the lift force in this section numerical results are given for scaling the lift force and they are compared with strictly two dimensional case α 1 details of oscillator system are given in table 3 the natural frequency in still water is non dimensionalized by the added mass coefficient in still water although it is believed that a recent study may alter the current perspective on the added mass bernitsas et al 2019 this subject is still discussed in the field there are certain studies on added mass changing with the flow velocity vikestad et al 2000 but non dimensionalization process in current literature still relies on constant added mass coefficient therefore in this study c a was taken as a constant and equal to 1 in calculation of the oscillator system particulars reynolds number is varied between 30 000 and 120 000 which lies on the trsl3 flow regime as identified by zdravkovich 2003 this is a relatively unexplored viv region due to the chaotic nature of the flow at these flow speeds kinaci 2016 the results are presented for three different correction terms α 0 5 α 0 7 α 0 87 and α 1 the case of α 1 presents a full 2d flow amplitude and frequency responses of the cylinder at different α are given in fig 11 upper branch clearly narrows with increasing α and this can be seen in amplitude response of the cylinder in fig 11 left as the cylinder loses more part at its tips and fails to use of the force generated by the fluid range of synchronization shrinks and the end of the upper branch moves to u 7 at α 0 5 when it was u 11 12 at α 1 there is also a notable reduction in the amplitudes in lower branch with decreasing α the oscillation frequency for all cases of α is given in fig 11 right in that figure the frequency f is non dimensionalized by natural frequency in water f o s c f n w when these frequencies are compared with schematic illustration by sumer and fredsoe 2006 given in fig 12 narrowing of the range of synchronization or lock in regime can be seen from frequency response as well to specifically identify lock in region at each α this schematic illustration is used lock in region i e range of synchronization at each α as per sumer and fredsoe 2006 are listed in table 4 it was shown in previous sections that the linear mathematical model failed to narrow down range of synchronization in the model it was possible to scale the fluid force but not the phase difference and this led to a total reduction in amplitude response on the other hand width of the upper branch remained constant to understand how the mathematical approach presented in this paper changed the upper branch we have to take a look at what happens to fluid force and phase difference using amplitude and frequency responses obtained numerically however simulations in this study are made for viv in water and it is possible to carry the mathematical model one step further before representing these results the total force given in equation 1 can be decomposed into two namely the potential force f p o t which is related to the added mass and the vortex force f v o r due to periodic vortex shedding from the cylinder potential force f p o t can be expressed by 23 f p o t c a m d z c m a z c where m d is displaced mass m a is added mass and c a 1 is added mass coefficient in still water similar to the model provided in section 5 if the same procedure is applied for viv in water we get 24 c z v o r cos φ v o r 2 a π 3 m 1 1 f 2 u 2 25 c z v o r sin φ v o r 4 a π 3 ζ f m 1 u 2 equations 24 and 25 are in non dimensional form following relations were used during the non dimensionalization process 26 a a d m m o s c m d f f o s c f n w u v u f n w d in these equations c z v o r is vortex force coefficient while φ v o r is phase difference between oscillation and vortex shedding the results are shown in fig 13 the fluid force in numerical calculations shows a perplexing behavior as vortex force coefficients of α 0 5 are higher than α 0 7 for u 5 except a single point at u 8 however as already stated before force itself is not the only driving mechanism of the oscillation amplitude phase difference also plays significant role on this process when vortex phase difference graph is observed it can be seen that this graph is also changing with varying α three dimensionality factor majorly affects amplitudes in lower branch as seen in fig 11 left to obtain a better insight of the physics behind this branch displacement versus total lift coefficient c l generated by cfd simulations in time is given in fig 14 for each α it should be reminded here that the total lift coefficient c l obtained from cfd simulations is not equal to c z v o r vortex force is only a component of the total force it can be observed from this figure that fluid force is out of phase with the oscillation for all cases as the total lift coefficient opposes displacement this is compliant with fig 13 as φ v o r 150 o at u 10 for each α amplitudes are higher for greater α due to decreasing total lift that acts reversely to oscillation of the cylinder until now underlying mechanism of how the three dimensionality factor changes the flow aspects was implicitly shown by presenting viv responses mathematically obtained phase differences etc physically three dimensionality factor changes boundary layer separation along the cylinder vortex shedding phenomenon becomes inherently different as the flow escapes through the tips i e α is reduced to visualize the effect of α flow around the cylinder in viv was captured at four different instances positions of the cylinder at these instances are summarized below position 1 the cylinder is at the origin and moving upwards position 2 the cylinder is at its upper extreme and will go down position 3 the cylinder is at the origin and moving downwards position 4 the cylinder is at its lower extreme and will go up the velocity vectors around the cylinder in viv at u 10 are given for α 1 left and α 0 5 right in fig 15 reversed flow after separation can clearly be seen in the wake region of the cylinder although given for rough cylinders with two strips on its surface a similar figure is also present in zhu et al 2018 at u 9 79 and may be used for comparison wang et al 2019 provide instantaneous views of cylinder wake for smooth cylinders for similar positions 6 2 application to experiments carried out at ata nutku ship model testing laboratory viv experiments were carried out at the circulation tunnel located at ata nutku ship model testing laboratory the tunnel has a test section width of 1 5 m and a depth of 0 64 m the blockage ratio at each section is 12 5 a view of the channel is given in fig 16 left the channel streams a uniform steady current towards the stationary viv apparatus a digital rpm controller is used to scale the velocity of the current over the range 0 u 1 56 m s the experimental setup consists of a horizontal cylinder hanging down from the main frame and standing inside the streaming water channel the viv apparatus can be seen in fig 16 right and the experimental conditions are given in table 5 the viv motion was captured by the open source electronics platform arduino arduino boards have a number of facilities for communicating with computers other boards sensors microcontrollers etc a functional code was developed to run with 16 mhz clock speed arduino mega 2560 board a pair of compatible ultrasonic sensors were used to receive the reflecting sound waves over moving components of the viv system the sensor can store 40 data points a second stored data was processed and denoised by the help of wavelets tool of matlab software eventually processed experimental results were compared with numerical simulations comparison of results are given in fig 17 experiments have returned a very narrow upper branch as it can be seen from fig 17 left numerical simulations with no three dimensionality the α 1 case had a wider range of synchronization as compared to experiments this range has narrowed down as three dimensionality was introduced into simulations the α 0 7 case 6 3 application to experiments carried out at towing tank results presented in this subsection are given for an experimental setup with low cylinder length as compared to the test section width experiments were carried out at a towing tank test conditions are given in table 6 the experimental setup of modir et al 2016 had a test section width of 50 c m but authors only tested a cylinder of length l 38 c m the flow could easily escape through the tips from 12 c m gap between cylinder and test section walls this fact should be considered in two dimensional numerical simulations and in our case it was handled by low α input comparisons of amplitude response for α 0 60 0 65 and 0 70 with experiments are given in fig 18 restriction of force using three dimensionality factor in the vibration equation helps limiting range of synchronization as presented in this figure change in α does not change the beginning of upper branch where the sudden jump in the amplitude response occurs on the other hand three dimensionality factor is effective on changing the end of upper branch where amplitudes start to drop for the experimental results presented in modir et al 2016 three dimensionality factor of experimental setup was found as α 0 60 7 discussion existing linear mathematical models allow to reconstruct the forces and phase differences at each reduced velocity by considering available viv responses of amplitude and frequency one of the novelties of this study is presenting a three dimensionality factor to enhance 2d numerical simulations however implementation of this correction term within linear math models do not help to limit range of synchronization of viv this method only helps to reduce amplitude response range of synchronization mainly handles phase difference in oscillation and vortex shedding linear math models fail to solve flow but allow to calculate fluid force with existing amplitude and frequency responses however only changing fluid force in these models is insufficient to capture flow characteristics of viv therefore momentum equations must be solved utilizing three dimensionality factor in the forced vibration equation adopting the methodology proposed in this study both fluid force and phase differences are adjusted to better approximation of the motion characteristics adding α into calculations to represent three dimensionality allows analyzing how amplitude response and lock in mechanism can reduce although the correction term which represents three dimensionality of the system changes the vortex force as presented in fig 13 left this term also changes phase difference between vortex shedding and cylinder oscillation shown in fig 13 right karman vortex in the wake region shown in fig 3 vanishes and the cylinder loses main supporting vortex that allows the cylinder to vibrate at high amplitudes viv behavior of the cylinder is significantly changed furthermore drastic change in phase difference at lower α reflects as a narrower range of synchronization region 8 conclusion in this study a numerical approach is presented to include 3d effects in 2d flow simulations the fluid force is scaled with respect to a correction term called three dimensionality factor and denoted by α momentum equations are solved for these variables forces on the moving body are found at each time step by the finite volume method the scaled fluid force is used at the right hand side of the forced vibration equation to solve oscillating motion of the body along with the methodology used in this paper the three dimensionality factor allows to calibrate range of synchronization of viv utilization of this factor with only linear mathematical models fails to satisfy the intended purpose since with such an approach only the fluid force can be changed the correction term is useful when the real flow is numerically solved by adjusting the phase difference as well besides calibrating calculations the three dimensionality factor also allows revealing the underlying physics of how amplitude and range of synchronization of the cylinder oscillation changes it was the focus of this study to reveal the 3d nature of viv flow and enhance 2d simulations with a three dimensionality factor applied to the fluid force in the vibration equation this correction term was randomly selected and applied in numerical simulations however as for the selection of α further studies need to be conducted viv response in different media and at different flow speeds show distinct behavior as there are many studies in the literature showing this difference it is believed that the difference in results are due to additional complexity of the added mass in water future studies can extend this method numerically and computationally to understand the effect of media and reynolds number credit authorship contribution statement aytekin duranay software investigation funding acquisition omer kemal kinaci conceptualization methodology validation data curation writing original draft writing review editing visualization supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author is supported financially by the turkish lloyd 
21419,in this paper a semi analytical method was developed to find the vertical accelerations of array of semi submerged elastic circular floaters in regular waves in this process it was assumed that the fluid is inviscid incompressible and irrational flow furthermore incident wavelength was relatively large in comparison to the floaters cross section using slender body theory and matched asymptotic expansions the inner solution close to the body section composed of suitable radiation solution at large distance from floaters by this method the governing equation on the diffracted wave of each floater was expressed as a simple function of fourier modes of incident waves finally using linear wave theory the relationship between the incident radiated and diffracted waves on an array of floaters was established in fourier modes the model results demonstrate good agreement with those of the boundary element method a series of experimental tests were also performed for model validation the results show that as the wavenumber increases the floater hydro elastic interaction is becoming important furthermore the floaters on upstream have larger significant vertical motions in comparison to a single floater in waves keywords elastic torus vertical acceleration asymptotic expansion slender body theory hydro elastic interaction far field and near field solution 1 introduction marine aquaculture plays an essential role in bridging the gap between reducing wild fishing and increasing global demand for food since 1980 global aquaculture production has been grown annually by more than 8 however this growth declined to a moderate 5 8 during the period 2001 2016 nevertheless aquaculture continues to grow faster than other major food production segments fao 2018 the marine aquaculture cages are built in different types and sizes these cages can be mounted close together to form clusters that feed on a feeding platform and withstand strong currents and waves circular cages are arranged in mooring grids in single double or triple rows with common space between them which is usually selected as a multiplication of radius of their circular floater see fig 1 from an engineering standpoint the problem of wave floater interaction can involve large relative vertical floater motions large local floater accelerations wave overtopping and out of water phenomena as well as hydro elastic effects and hydrodynamic interaction between floaters in the cluster of cages fig 2 shows a deformed circular floater of fish cage due to environmental conditions in structures with significant weights fixed at a specific location acceleration creates large forces in joints and mooring lines an example of such structures is the floaters of aquaculture fish cages the dynamic loads of sea waves in these structures cause intermittent accelerations in the different parts of the structure consequently the force from these accelerations is applied to joints mooring lines and netting system understanding the nature of these accelerations is useful in the process of designing building and fatigue analyse of these structures as the cages are arranged in an array the hydrodynamic interaction between floaters is a challenging problem due to radiated and diffracted waves from other floaters therefore this complicated problem is considered in this study analytical or semi analytical solutions of wave incident to structures have always been attractive among researchers for example kagemoto and yue 1986 considered the three dimensional 3d water wave diffraction and radiation by a structure consisting of several separate members in the linearized potential flow other researchers such as newman 1997 li and faltinsen 2012 and li et al 2018 also paid attention to analytical or semi analytical methods slender body theory is prevalent to analyse the motions of marine structures in waves if wavelength λ is small enough respect to the inline body length l and comparable with the transverse body length a strip theory results with the leading order inner solution at each two dimensional 2d wave body interaction end effects are a source of inaccuracy or inconsistency in slender body theory for a body whose longitudinal axis is a closed curve without ends the end effects are absent for example in a torus with circular cross section of minor radius a and larger circle of major radius c the torus is slender if a c the hydrodynamic characteristics of such body shape are simplified by the lack of end effects and axisymmetric geometry newman 1997 based on hydrodynamic models we divided the studies of sea loads on floater of aquaculture fish cages in three general categories they are morison equation models potential flow models and computational fluid dynamic cfd models following a brief literature review on these categories have been presented with the assumption of strip theory many researchers used morison equation to find the wave or current forces on the floater part of aquaculture fish cages ormberg 1991 huang et al 2006 li et al 2007 zhao et al 2009 dong et al 2010 bai et al 2015 and zhao et al 2015 used morison equation and curved beam theory for investigating the elastic response of a circular floater in waves xu et al 2011 assessed the hydrodynamic response of a cage system using lumped mass method and rigid body kinematics theory li et al 2013 considered the hydroelectricity in the morison equation they modeled the net and floater with truss and beam element respectively and considered the non linearity in geometry deformation and motions bai et al 2016 assessed the fatigue analysis of high density polyethylene hdpe floating system in waves based on the deterministic method and finite element fe analysis and morison equation zhao et al 2019 developed a numerical model to investigate the deformations and stress distribution of floating pipes of fish cage subjected to flow the modeling approach was based on the combination of the fe method fem using the shell element to simulate the floating pipes and the hydrodynamic model improved from the morison equation and lumped mass method xu et al 2017 used a fe model for the structural analysis of the floating collar of a metal fish cage in waves in their work the hydrodynamic loads were calculated from the generalized morison equation the dynamic behaviour of a fish cage collar in waves and currents was investigated using a numerical model based on morison equation and fem by huang et al 2016 2018 the floating collar and mooring system were divided into a series of line segments modeled by straight massless model segments with a node at each end hydrodynamic response of a cage system under combinations of current and wave loading based on a morison force model was carried out by cifuentes and kim 2017 in their work the cage system include floating collar netting and ballast was modeled by a combination of line elements the earlier studies of wave induced responses on floating torus based on potential flow belong to davis 1975 who considered the forced vertical motions of a torus with arbitrary relative dimension and the short wavelength compared with both torus radius newman 1997 analyzed the motions of a floating torus oscillating in incident waves under the assumption that the wavelength is comparable with the radius of the body section and is small compared with the larger radius of the torus he solved the heave and surge radiation problems by simple applications of the method of matched asymptotic expansions li and faltinsen 2012 and also li 2017 developed a low frequency slender body theory for the vertical added mass damping and wave excitation loads on a single elastic semi submerged torus using matched asymptotic expansions with a near field and far field solution in their study a beam model described the elasticity effect of the torus li et al 2016 studied the longitudinal motions and vertical accelerations of a floating torus as well as wave motion inside the torus by model tests and second order potential flow theory in regular deep water waves they found a reasonable agreement between results in particular for the linear problem and small wave steepness a 3d weak scatter model with partly nonlinear effects as well as a 3d linear frequency domain method based on potential flow were used by li et al 2018 to model the vertical acceleration of an elastic circular collar of a floating fish farm in regular deep water waves due to the geometric and structural complexity of fish cages the direct cfd simulation of a fish farm is unrealistic recent researches using cfd has been limited to many geometric simplifications kristiansen and faltinsen 2008 developed a cfd numerical wave tank for nonlinear wave body interaction on a 2d fixed semi submerged circular cylinder tang et al 2017 used a cfd method in the combination with fem to model a flexible net panel xu et al 2018 developed a hydrodynamic model based on cfd method to obtain the hydrodynamic coefficients of a rigid segment of a fish cage collar yao et al 2016 modeled the current loads on a net cage considering the fluid structure interaction fsi they used the mass spring model for net cage and the finite volume method fvm for flow field ong et al 2017 performed 2d simulations to investigate the free surface waves past two semi submerged horizontal circular cylinders in tandem by solving the unsteady reynolds averaged navier stokes equations uranse the broad literature as above shows that despite few studies performed on the hydrodynamics of fish cages in waves the interaction of elastic floater parts of cages has not been considered therefore the objective of this paper is to develop a semi analytical method based on slender body theory and matched asymptotic expansions to describe the hydrodynamic interaction of hdpe elastic floaters in incident waves in this procedure two simpler 2d problems are solved separately instead of solving a complex 3d problem one of them is the inner solution close to the body section near field solution and another one is radiation solution at large distance of floater far field solution the inner solution is simplified because it is 2d whereas the outer solution is simplified by neglecting the body boundary condition these solutions are matched in an overlap region to constitute a complete solution therefore the main novelty of this research work is developing a semi analytical method to model the sea wave interaction with an array of elastic floaters in short the present study can be considered as a continuation of li 2017 who worked on a single elastic semi submerged torus it is expected from their work that if we use tandem fish cages instead of single one the radiated wave generated by one floater can affect other tori the elastic motions of floaters and the wave scattering are another source of hydrodynamic interaction between cages which adds to complexity of the problem therefore the structure of this paper is as follows in section 2 after the problem description the governing equations are presented in the following the hydrodynamic potentials for tori interactions are derived these are scattering of incident waves by the structure and radiated potential due to associated body movement and elastic motions finally in this section the exciting forces are derived and the hydrodynamic response of each torus is calculated section 3 describes the experimental tests were performed for mathematical model validation in section 4 the results on analytical numerical and experimental models are presented in this section first the present method was verified by bem based software and validated with experimental tests after that the involving parameters such as floater dimensions the distance between floaters and bending stiffness of floaters are studied and the results are presented and discussed finally in section 5 some conclusions are drawn 2 mathematical formulation in this section the mathematical formulation of the problem is presented in detail 2 1 problem description the analytical formulation is developed considering one rows of semi submerged circular floaters with the large radius c the cross section radius a the bending stiffness e i and the distance center to center of l i j see fig 3 a the fluid is considered as inviscid incompressible and irrotational flow the incident wave is a regular deep water wave with amplitude ζ 0 propagating along the positive x axis based on the linear wave theory the deep water implies when h λ 2 where h is the water depth and λ is the wavelength therefore according to dean and dalrymple 1991 the incident wave potential in deep waters is expressed as 1 i 0 ζ 0 g ω e x p ϑ z i ϑ x i ω t where ω is the wave frequency g is the gravity acceleration ϑ ω 2 g is the wavenumber z is the vertical axis positive upwards x is the wave propagation direction t is the time variable and i 1 is the imaginary number see also fig 3b and c the long length wave assumption means the wavelength is long relative to the cross sectional diameter of the floater a linear frequency domain solution for the vertical response of tori will be analytically derived based on matched asymptotic expansions in this expansion the solution performs for far field and near field in a way to be matched in far field solution the cross section of the floater is neglected while in the near field the details of this cross sectional is considered as shown in fig 3b in far field view the cylindrical coordinate system ρ β z is used with z 0 on free surface and z positive upwards the direction β 0 is chosen to coincide with the incident wave propagation the torus consists of a tube with a main radius c large radius and a cross section radius a minor radius where c a the body located in z 0 plane at a distance ρ c from the vertical axis with respect to the local cartesian coordinate we have x ρ cos β y ρ sin β and z z in near field solution the local cartesian coordinate system oy z and polar coordinate system or θ are used see fig 3c 2 2 governing equations the motion of a torus located in the array is affected by diffracted and radiated waves from other tori therefore based on the linear wave theory the velocity potential on the jth torus in the array is expressed in the form of the following general equation 2 i t j i 0 j i 1 i j n r i d i 0 i d i in which n is the number of tori in the array i 0 j is the velocity potential due to incident wave r i is the radiated potential due to motion of the ith torus in the location of jth torus d i 0 i is the diffracted wave by ith torus in the location of jth torus due to incident wave i 0 i to ith torus d i is the diffracted wave by ith torus in the location of jth torus due to other incident waves to the ith torus to solve the problem a step by step solution is used in the first step it is assumed that each torus movement is independent of other tori the motion of each torus is determined then the radiated and diffracted waves by each torus are also calculated these waves are considered as incident waves to other tori this procedure is continuing until the motions are converging to a special value therefore in the above formula when using step by step solution all terms except d i are known the unknown d i should be determined by implementing the body boundary condition in the solution method we first derivate the essential formula for solving the problem as well as the solution for the vertical motion of a single torus in regular waves as flow is considered irrotational and incompressible the velocity potential satisfies the laplace equation 3 2 2 x 2 2 y 2 2 z 2 0 the body boundary condition is as the following 4 n u b n on body surface in which u b is the body velocity and n n ρ n β n z is the unit normal vector on the body surface because of the wavefield and the torus geometrical symmetry the vertical motion w of the torus can be expressed by the following cosine fourier series 5 w s a 0 t n 1 a n t cos n β where a 0 t a 0 a e i ω t and a n t a n a e i ω t the term a 0 and a 1 cos β describe heave at the torus axis and vertical motion due to pitch motion respectively the higher terms in series represent the elastic motions as we assumed a c ε 1 a o 1 c o 1 ε n ρ o 1 n β o ε n z o 1 β o ε the physical conditions on the above problem are following the low frequency slender body theory consequently 6 1 c β ρ z thus the 3d laplace equation reduces to a 2d equation in the polar coordinate system as defined in fig 3c 7 2 r 2 1 r r 1 r 2 2 θ 2 0 similarly the body boundary condition of eq 4 is replaced by 8 r u b r n r on r a where u b r is the normal velocity component of the local cross section of the torus velocity u b and n r is the normal component of the local cross section of the unit normal vector n since we consider vertical motions of a body on the free surface the outer solution arises by distributing 3d sources along the torus center line which should satisfy the radiation condition at infinity the near field inner and far field outer solutions are matched in an overlap region c ε ρ c far from the torus in the inner region but very close to the torus in the outer region this method is useful to be able to solve two separate problems analytically the inner solution is simplified because it is 2d whereas the outer solution is simplified by neglecting the body boundary condition 2 3 far field solution the governing equations for velocity potential f in the far field are 9 2 f 0 10 ϑ f f z 0 on z 0 with referring to fig 3b the coordinates of the torus center line can be expressed as 11 ξ c cos α η c s i n α ζ 0 the field point has coordinates x y z and source point has coordinates ξ η ζ in the far field view ζ 0 for each fourier mode we consider separate vertical motions the associated source density varies as q n c o s n α exp i ω t along the center line of the torus therefore the far field velocity potential can be expressed as 12 f q n exp iωt 4 π c 0 cos nα g x y z ξ η ζ d α on ζ 0 havelock 1942 1955 presented the following source expression green function 13 g x y z ξ η ζ 1 r 1 r 4 ϑ π 0 ϑ c o s k z ζ k s i n k z ζ k 0 k r k 2 ϑ 2 d k 2 π ϑ e x p ϑ z ζ y 0 ϑ r 2 i π ϑ e x p ϑ z ζ j 0 ϑ r where r x ξ 2 y η 2 z ζ 2 is the distance from field point to the source point and r x ξ 2 y η 2 z ζ 2 r x ξ 2 y η 2 furthermore j 0 and y 0 are the bessel function of the first kind and second kind of zero order respectively and k 0 is the modified bessel function of zero order with assumption that ϑ a is small and in far from torus body i e ρ c 0 all local waves decay and the fluid potential is expressed by asymptotic expansion of eq 12 as following 14a o f i c q n π ϑ j n ϑ c h n ϑ ρ exp ϑ z i ω t cos n β for ρ c 14b o f i c q n π ϑ h n ϑ c j n ϑ ρ exp ϑ z i ω t cos n β for ρ c where h n ϑ ρ j n ϑ ρ i y n ϑ ρ is the hankel function of the first kind the above equations have error of order o 1 ϑ 3 ρ 3 ϑ 2 z 2 γ 3 ϑ z ϑ 2 c 2 1 ϑ 2 c 2 z 2 c 2 ρ 2 for ρ c and error of order o ϑ 2 ρ 2 ϑ 2 z 2 γ 3 z 2 c 2 ρ 2 for ρ c where γ ρ c ρ 2 c 2 z 2 eq 14a is used as the basic solution to express the radiation potential due to motion of a torus in mode n and in close to other tori the application of this equation will be described in sections 2 6 and 2 7 eq 14b can be used to express the wavefield inside of tours but with enough distance from torus body li 2017 derived an inner expansion of eq 12 by assuming that ϑ a is small 15 i f c q n exp i ω t π cos n β 1 ϑ z ln 8 c r k n ϑ z ϑ θ y 1 ϑ z ϑ c π 2 1 2 j n ϑ c y n ϑ c i j n ϑ c 2 ϑ π c 4 1 ϑ z 0 2 π h 0 ϑ r ρ c cos n μ d μ where h 0 ϑ r is the struve function and k 0 0 and k n 2 1 1 3 1 5 1 2 n 1 for n 1 the source strength q n can be found by equating the far field potential with the near field one 2 4 near field solution in near field description the detail of flow filed in the torus cross section is considered with slender body theory assumption the velocity potential assumed to be constant in the tangential direction of the torus thus the governing equation for near field velocity potential n is the 2d laplace equation eq 7 therefore the linearized free surface and body boundary conditions can be expressed as following 16 ϑ n n z 0 on z 0 17 n r v 3 n θ cos θ cos n β on r a z 0 where v 3 n θ is the vertical motion of fluid particles on the body surface generally a function of θ li 2017 used ursell 1949 studies to find the near field potential here we modified his derivate in a form to be suitable for computational practice as follows 18 n v 3 n c o s n β a 0 n 1 ϑ z ln 8 c r k n c n ϑ z ϑ θ y m 1 a 2 m n a 2 m c o s 2 m θ r 2 m ϑ c o s 2 m 1 θ 2 m 1 r 2 m 1 the coefficients q n and c n in eqs 15 and 18 are found by equating the far field potential with the near field one hence r in the near field expression and the far field potential is implemented as close as possible to the torus the result is 19 c n π ϑ c π 2 j n ϑ c i π j n ϑ c 2 1 4 0 2 π h 0 ϑ c 2 1 c o s μ cos n μ d μ 20 q n v 3 n π a 0 n the body boundary condition eq 17 leads to the following equation 21 a 0 n ϑ c o s θ ln 8 c a k n c n 1 a ϑ θ s i n θ m 1 a 2 m n 2 m c o s 2 m θ a ϑ c o s 2 m 1 θ v 3 n θ cos θ the terms a 0 n and a 2 m n lead to an infinite system of equations which can be truncated and solved using numerical methods 2 5 governing equation on the vertical motion of torus considering the curvature and axial stiffness the equation for the vertical motion w of the torus is based on euler bernoulli for curved beam as 22 m 2 w t 2 ρ w g b ω w e i 4 w s 4 e i c 2 2 w s 2 s t a s w s f 3 s a d d e d m a s s d a m p i n g f 3 s w a v e e x c i t f 3 s m o o r i n g f 3 s a d j t o r i the above equation is similar to formula used by li 2017 here we add the term f 3 s a d j t o r i to the formula to consider the influence of hydrodynamic interactions of adjacent tori in this equation s c 1 β and m is the torus mass per unit length term e i c 2 2 ω s 2 considers the curvature effect of the torus f 3 s m o o r i n g is the vertical component of the mooring line forces t a s is the axial stiffness which is calculated by static analysis of the moored torus furthermore f 3 s a d d e d m a s s d a m p i n g is the vertical added mass and damping force per unit length of the torus and f 3 s w a v e e x c i t is the vertical wave excitation force per unit length of the torus the term ρ w g b ω is caused by the change of the buoyancy force due to the motion w here ρ w is the mass density of water and g is the gravitational acceleration since we consider a semi submerged torus b ω is 2a as for low structural modes the structural damping is small it was neglected with assumption of low frequency slender body theory and using asymptotic expansion with near field and far field solution the velocity potential and consequently the vertical motion of single torus can be found li 2017 we added new terms j 1 j i n f 3 d j n f f k j n to the available formulation for the vertical motion of torus in array the derivated formula for amplitude of vertical motions in mode n is as following 23 a 0 a i ζ 0 1 π ϑ a 4 ρ g b ω ω 2 a 33 0 i ω b 33 0 exp ϑ z m i j 0 ϑ c t a j 1 j i n f 3 d j 0 f f k j 0 ω 2 m a 33 0 i ω b 33 0 ρ g b ω 24 a n a i ζ 0 1 π ϑ a 4 ρ g b ω ω 2 a 33 n i ω b 33 n exp ϑ z m 2 i n 1 j n ϑ c t b j 1 j i n f 3 d j n f f k j n ω 2 m a 33 n i ω b 33 n ρ g b ω e i c 4 n 4 n 2 t c f o r n 0 25 t a 1 2 π 0 2 π i 1 n o m t p 3 δ β β i d β 26 t b 1 π 0 2 π i 1 n o m t p 3 δ β β i d β 27 t c 1 π c 2 m 1 i 1 n o m a m a n 2 t a s i β i β i 1 d β j 1 j i n f 3 d j n f f k j n represents the froude krylov and diffracted forces due to incident waves to the i t h torus from other tori t p 3 is the vertical component of pre tension of the mooring lines and n o m points to number of mooring lines β i describes the attachment positions between mooring lines and the torus and δ is the dirac delta function the axial tension t a s i can be calculated in a simplified manner as described by kristiansen and faltinsen 2015 the term t c in eq 27 demonstrates the coupling effect between different modes a 33 n and b 33 n are the added mass and damping in mode n and z m 4 a 3 π is the center of wetted part of the cross section of the torus 2 6 solution to hydrodynamic interaction between tori the main objective of this research is to calculate the hydrodynamic interaction between tori it means we are calculating the term j 1 j i n f 3 d j n f f k j n on eqs 23 and 24 in eqs 14a and 15 we developed the outer expansion named o f and inner expansion named i f for source distribution on the center line of torus respectively in eq 18 the inner solution named n was developed here the way we used them to solve the problem of hydrodynamic interaction between tori is explained based on the linear wave theory the diffracted wave of jth torus d j should satisfy the body surface boundary condition hence 28 d j n i j n n i 1 i j n r i d i 0 i d i where n is the normal vector on the body surface d i and d j are both unknown and should be determined we express all velocity potentials in the form ϕ ρ β exp ϑ z i ω t the term ϕ ρ β is expressed in the fourier modes therefore we have 29 ϕ ρ β n 0 ϕ n cos n β 2 7 far field velocity potential due to radiation considering v 3 n a n where a n is the vertical velocity in mode n implementing it into eq 20 and using eq 14a the radiation velocity potential is obtained as the following 30 ϕ r n ϑ c ω π 2 a 0 n a n a j n ϑ c h n ϑ ρ cos n β using fourier series the velocity potential due to motion of ith torus on jth torus on mode m is expressed as following 31 ϕ r i j m n 0 r m n i j cos m β in which 32 r m n i j a n i c r n i m n i j and 33 c r n ϑ c ω π 2 a 0 n j n ϑ c 34 i m n i j ε m π 0 2 π h n ϑ ρ i j cos n β i j cos m β d β where ε m 1 2 for m 0 and ε m 1 for m 0 with refer to fig 4 when jth torus is located on the upstream of ith torus ρ i j and β i j are as following 35 ρ i j u ρ j 2 l i j 2 2 ρ j l i j cos β j β i j u tan 1 ρ j sin β j l i j ρ j cos β j and when jth torus is located on the downstream of ith torus ρ i j and β i j are expressed as 36 ρ i j d ρ j 2 l i j 2 2 ρ j l i j cos β j β i j d π tan 1 ρ j sin β j l i j ρ j cos β j 2 8 far field velocity potential due to diffraction of incident wave the incident wave to the ith torus can be expressed by following fourier series involving bessel function as 37 i 0 i g ζ 0 exp ϑ z i ω t ω exp i ϑ l i j 0 ϑ c n 1 2 i n j n ϑ c cos n β exp ϑ z i ω t n 0 ϕ i 0 i n cos n β n 0 i 0 i n cos n β where l i is the distance of center of ith torus from global coordinate system therefore the normal velocity due to incident wave on the near field solution is 38 d i 0 n n i 0 n n i 0 n c n c i 0 n z n z where n c sin θ n z cos θ and i 0 n z ϑ cos θ i 0 n using the principle of differential equations the above differential equation is separated into two independent differential equations which include the first and second terms in the right hand side of the equation implementing them in the system of eq 21 the following system of equations is derived 39 a 0 s n ϑ c o s θ ln 8 c a k n c n 1 a ϑ θ s i n θ m 1 a 2 m s n 2 m c o s 2 m θ a ϑ c o s 2 m 1 θ ϕ i 0 n c sin θ exp ϑ a cos θ and 40 a 0 n ϑ c o s θ ln 8 c a k n c n 1 a ϑ θ s i n θ m 1 a 2 m n 2 m c o s 2 m θ a ϑ c o s 2 m 1 θ ϑ cos θ ϕ i 0 n exp ϑ a cos θ ϕ i 0 n c and ϕ i 0 n is considered constant in the cross section of the torus multiplying both sides of eq 39 by cos 2 n θ and using the orthogonal properties of sine and cosine functions and integrating it from π 2 to π 2 lead to a 2 m s n 0 for 0 1 2 using taylor expansion we can approximate the right hand side of eq 40 as a function of cos θ similar to the previous one multiplying both sides of eq 40 by c o s 2 n θ and integrating from π 2 to π 2 lead to an infinite system of equations which can be truncated and solved by numerical methods unknowns a 2 m n is also determined with reference to far field solution eq 14a the diffracted potential is obtained as 41 ϕ d i 0 n c d n h n 1 ϑ ρ ϕ i 0 n where 42 c d n i c ϑ 2 π 2 a 0 n j n ϑ c eq 41 expresses the relation between incident wave at mode n ϕ i 0 n and diffracted wave ϕ d i 0 n by the torus at far from it therefore the above solution can also be used to describe the diffracted wave because of other incident waves to the torus similar to radiation the diffracted waves ϕ i 0 n from ith torus in location of jth torus can be expressed by fourier series as 43 ϕ d i 0 i j m n 0 d 0 m n i j cos m β where 44 d 0 m n i j c d n i m n i j 2 9 general solution to incident wave from other torus far from torus the diffracted waves from ith torus can be expressed by following 45 ϕ d i n 0 d n i h n ϑ ρ i cos n β i this potential in location of jth torus is expressed in the fourier s mode m by following form 46 ϕ d i j m n 0 d n i d m n i j cos m β where 47 d m n i j i m n i j with regards to eq 41 the general solution of eq 28 can be expressed as following 48 d j m c d m i 1 i j n r i j m d i 0 i j m d i j m implementing the values of eqs 31 41 and 46 to eq 48 the following system of equations is derived as 49 d m j c d m i 1 i j n n 0 d n i d m n i j c d m i 0 i j n n 0 r m n i j d 0 m n i j i j 1 n m 0 the above system of equations is truncated for limit of modes n m o d e and by solving them the unknown d m j is determined for j 1 n and m 0 n m o d e therefore the total incident velocity potential to jth torus in array in mode m is expressed as 50 ϕ i t j m ϕ i 0 j m i 1 i j n n 0 n m o d e r m n i j d n i d m n i j d 0 m n i j cos m β in this equation ϕ i 0 j m is the velocity potential on mode m from main incident wave eq 1 to jth torus r m n i j is the radiated potential from ith torus because of motion on mode n of this torus see also eq 5 d n i d m n i j is the scattered wave from ith torus because of all incident waves except the main incident wave to ith torus and d 0 m n i j is the scattered wave from ith torus because of main incident wave to this torus therefore 51 i t j m 0 n m o d e ϕ i t j m exp ϑ z i ω t cos m β 2 10 calculating the exciting forces the exciting force can be divided into two terms froude krylov and diffraction forces the froude krylov term is calculated by integrating the pressure around wetted surface of the torus therefore p ρ w i t j m t f f k i ω ρ w ϕ i t j m s where s s j exp ϑ z n z d s 2 a 1 π ϑ a 4 ϑ 2 a 2 3 s j is the wetted surface of the cross section of torus and n z is vertical component of normal vector on body surface consequently we have 52 f f k j m i ω ρ w s ϕ i t j m generally calculating the diffracted waves is associated with solving the diffraction problem here with the assumption that the torus cross section is relatively small in comparison to wavelength we used the following approximation for diffraction force 53 f 3 d j m a 33 m a 3 ζ b 33 m w ζ where w ζ z and a 3 ζ 2 z t are the vertical velocity and accelerations of water particles respectively the best place for their approximation is on z z m li 2017 used the same manner for estimating the diffraction force therefore 54 f 3 d j m ϑ b 33 m i ω a 33 m exp ϑ z m ϕ i t j m the above value is implemented into eqs 23 and 24 to calculate the vertical motion of each torus in the array and the solution is completed 3 experimental tests experimental tests were performed in iis ocean engineering basin at the university of tokyo in january to june 2019 the objective was to measure the vertical accelerations at specified locations on the floaters as the surface gravity waves have the essential role in the generated forces the froude number scaling was used therefore it is not possible to satisfy the reynolds number simultaneously which describes the viscus effects also the keulegan carpenter number is small leading to negligible flow separation hence the potential flow assumption can describe fluid behavior the viscous damping is a matter that can not be neglected in the case of flow separation this may be considerable in steep waves with short period when overtopping and out of flows phenomena occure a schematic view of the test set up is shown in fig 5 other parameters are described in table 1 the ocean basin had 50 0 m length 10 0 m breadth and 5 0 m depth the wave tank was equipped with a plunger type wave maker and a damping beach covered by porous mat to increase its energy dissipation ability the wave maker is controlled by software to estimate the necessary stroke of the piston for generating linear waves with a given height and period the model was chosen from standard type corrugated tubes which are used to cover the electric cables in houses the corrugations were covered by waterproof adhesive electrical tape to obtain a constant cross section see fig 6 a and c the model scale was 1 25 the parameters were chosen such that the values be in the range of typical existing floaters the structural bending stiffness e i was estimated by using the static deflection equation δ p l 3 3 e i of a cantilever beam of length l and with a fixed end support at one end and load p applied at the other end of the beam e i was estimated by measuring the deflection δ see fig 6b the hdpe pipes which are widely used in aquaculture fish farming have young s modulus of elasticity e 0 8 1 gpa with reference to model scaling the model has realistic bending stiffness three floaters were attached to the stationary carriage in the middle of the tank by nearly horizontal mooring lines at the front aft and lateral positions as shown in fig 5 they were connected to the floaters through 8 attachment points with equal intervals as shown in this figure the semi suspended chains with 3 n average suspended weight was used at the end of attachment to implement tension as a linear function of the displacement to the mooring lines the semi suspended chains act as a linear spring and impose the tori to maintain their initial positions during the test special attention should be paid for tension in mooring lines very small tension leads to relatively large longitudinal motions of the floaters when they are tested at large wave steepnesses and long wave periods on the other hand the large tension or inequivalent tension on mooring lines causes that the circular shape of the floaters change to an oval shape controlling the relative motions between floaters is another challenge therefore if the pretension in mooring lines is not distributed correctly a desirable distance between floaters is not achieved in another word during the tests large relative motion causes the change of initial distance between floaters moreover many precautions should be made to do the desirable tests the floaters were semi submerged in calm conditions where the initial distance between center to center of two adjacent floaters was equal to 3 c the vertical accelerations were measured by accelerometers at β 0 π 4 π 2 and π the wave probe was installed upstream during the test also in conjunction with every test one test was performed to measure the undisturbed wave height in the absence of floaters in the tank in such test condition the wave parameters were measured in the location of the middle floater center see fig 6 incident waves with different wave steepnesses h λ 1 60 1 30 and 1 15 were tested nevertheless the actual wave height in location of the floaters is slightly different from those set to the wave maker software because of the waves decay the wave period t varied within 0 45 1 5 s with the time step 0 025 s a part of test wave conditions are presented in table 2 all test cases were repeated two to five times a waiting time of three to 8 min between each test was chosen to let the waves damp out the preliminary tests showed that in general nearly steady state conditions are reached after 10 waves the measured signals from all sensors went through an amplifier and the acquisition data were stored with a sampling frequency of 100 hz the discrete fourier transform dft was used to find each harmonic contribution in time series the steady state time window was band pass filtered in order to remove noise out of the prescribed frequency range the lowe pass and high pass cut off frequencies were 0 95 t and 1 05 t 1 95 t and 2 05 t and 2 95 t and 3 05 t in order to get first second and third harmonics of accelerations respectively the higher harmonic acceleration does not have special contribution in time series see fig 7 after implementing the cut off frequencies and removal of the noises the time series of each harmonic motions was replotted consequently the mean value of extremum which describes the envelope curve was found in software as the amplitude of acceleration in each harmonic motions w a f the mean acceleration was calculated using fourier series by finding the maximum value of the following formula 55 w t w a 1 f cos 2 π f t w a 2 f cos 4 π f t w a 3 f cos 6 π f t where w a 1 f w a 2 f and w a 3 f are the amplitude of accelerations at first second and third harmonic motions respectively and f 1 t is the wave frequency large vertical and horizontal motions with significant hydro elastic effects as well as waves over topping and out of water phenomena were observed on the floater at small wave period and large wave steepness tests in these test conditions the fluid behavior should be described by nonlinear and viscous effects the objective of the experimental test was the semi analytical model validation therefore the experiments were limited to special cases theoretically the influence of wide range of parameters can be investigated in this study therefore after establishment of the model and ensuring the range of its validity investigation of the other predominant parameters is the mission of the semi analytical model 4 results and discussion in this section the results on analytical numerical and experimental models are presented 4 1 numerical model description and mesh sensitivity analysis the numerical model was used for analytical results verification this model was generated in ansys aqwa software which uses 3d bem for modeling the diffraction and radiation problems the current version of this software is only capable of modeling rigid structures in sea waves therefore comparing the results of our model with those of this software is limited to rigid tori nevertheless in this section before using the numerical model its grid independency is examined for this purpose the accuracy of the numerical model in calculating the maximum and minimum free surface elevation for scattered wave filed around a single fixed torus with a 0 45 m a c 0 024 and non dimensional wavenumbers ϑ a 0 15 and ϑ a 0 25 has been investigated see also figs 10b and 11b these values are calculated in 2000 10 384 elements on the torus body surface and the results are shown in fig 8 a in this figure horizontal axis shows the number of elements n e and two vertical axis show the maximum and minimum values of free surface elevations as the results illustrate for about 5924 elements and more the maximum and minimum of free surface elevation converge to a certain value and the results are independent of the number of grids therefore in all numerical modeling of this research 5924 elements were considered on the surface of each torus fig 8b shows the zoom view of element distributions on the torus body 4 2 model verification for scattered wavefield around single torus the scattered wavefield around a single fixed torus can be calculated by adding the incident velocity potential to the summation of fourier terms on eq 41 hence 56 s i 0 exp ϑ z i ω t n 0 c d n ϕ i 0 n h n ϑ ρ cos n β with assumption of linear wave theory the free surface elevation can be expressed as 57 ζ re 1 g s t where r e means the real part of expression the scattered wave amplitude ζ a ζ 0 around a fixed rigid torus for a 0 45 a c 0 024 and ϑ a 0 05 0 15 and 0 25 are shown in figs 9 11 respectively the corresponding ansys aqwa results also presented on the right hand side of each figure as these figures demonstrate there is a good agreement between the general patterns of wave contours of two methods the origin of some superficial differences observed between these results is using different softwares to produce two figures the ansys aqwa results are also shown for wave amplitude inside of the torus if the maximum or minimum wave height occur inside of the torus see figs 10b and 11b the color spectrum resolution decreases outside the torus and causes the color appearance of two methods to be different to clarify the issue we compared the wave amplitude at different radial distances by two methods in one diagram see fig 12 it should be noted that the wavefield inside of the floater can be presented by rewriting eq 56 as s i 0 exp ϑ z i ω t n 0 c d n ϕ i 0 n j n ϑ ρ cos n β and c d n in eq 42 as c d n i c ϑ 2 π 2 a 0 n h n ϑ c the outer expansion for velocity potential eq 14b is based on that ρ c consequently eq 56 does not give a realistic solution about wave potential near torus body therefore the above correction presents an approximate solution for wavefield inside the torus but at a far distance from its body the inaccuracy of the model results inside of the torus and especially near torus body cases large unrealistic value for wave height in this area therefore presenting the model results for this area causes reduction of graph resolution in other areas outside of the torus thus we did not present the analytical model results inside of the torus it should be noted that this inaccuracy in calculating the wavefield near floater body does not make the model inefficient in calculating the hydrodynamic forces and wave induced responses from this point of view the exciting forces are calculated in the manner described in subsection 2 10 in this method there is no need to calculate the diffraction potential on the torus body and the froude krylov and diffraction forces are calculated directly from the velocity potential of incident waves using eqs 52 and 54 the strength of the analytical model is that it is able to calculate the scattered and radiated wave from one tori in adjacent to other tori in eqs 52 and 54 these waves are considered as incident waves to other tori the results of the present method and ansys aqwa for scattered wave amplitude in front β π and aft β 0 of a semi submerged circular rigid floater with a c 0 024 as a function of non dimensional radial distance ρ c are shown in fig 12 in this figure ζ a ζ 0 is the non dimensional wave amplitude ζ 0 is incident wave amplitude the results show that as ρ c increases the accuracy of the present method increases and this method has calculated the maximum and minimum location and the amount of wave height appropriately the inaccuracy near the floater body ρ c 1 is not important because to evaluate the tori interactions it is necessary to correctly estimate the scattered wavefield from one torus to vicinity of another one an error analysis was performed using root mean square error rmse of maximum free surface elevation for each wave condition this parameter was also calculated for all comparison points and presented in table 3 as this table shows the maximum error 6 5 with r m s e 0 05 occurred at ϑ a 0 15 and β π meanwhile the rmse for all waves conditions is less than 0 037 4 3 model verification for wavefield around array of torus in this subsection the results of present modeling and ansys aqwa software for wavefield around three rigid tori are compared the analytical model considers just the heave and pitch motions as calculated by solving the system eq 49 and implementing d n i on eq 50 the tori arrangement is as shown in fig 5 also in ansys aqwa model the system is restricted such that the tori have only vertical heave and pitch motions in the analytical model the total velocity potential on the cylindrical coordinate system at the middle torus see fig 3 is expressed by the following formula 58 t i 0 exp ϑ z i ω t n 0 ϕ 1 n ϕ 2 n ϕ 3 n where ϕ 1 n c d n exp i ϑ l 12 ϕ i 0 n c r n a n a 1 d n 1 h n ϑ ρ 12 cos n β 12 ϕ 2 n c d n ϕ i 0 n c r n a n a 2 d n 2 h n ϑ ρ cos n β ϕ 3 n c d n exp i ϑ l 32 ϕ i 0 n c r n a n a 3 d n 3 h n ϑ ρ 32 cos n β 32 ϕ i 0 0 j 0 ϑ ρ and for n 0 ϕ i 0 n 2 i n j n ϑ ρ here the superscript number on a n points to the torus number in the array replacing s in eq 57 by t the free surface elevation is calculated the non dimensional wave amplitude ζ a ζ 0 includes scattered and radiated waves around 3 rigid tori for a 0 45 a c 0 024 l 12 l 23 3 c and ϑ a 0 05 0 15 and 0 2 are presented in figs 13 15 respectively the corresponding ansys aqwa results are also displayed beneath our results in each figure as the figures demonstrate there is a good agreement between the general patterns of wave contours of two methods the reason for existence of some superficial differences in these figures has been previously discussed in the description of figs 9 11 as was mentioned before the governing equations derived here are only applicable for wavefield outside of the tori therefore the wavefield inside of tori has not been presented for analytical model results the current versions of ansys aqwa software are only capable of modeling the rigid structures in sea waves therefore comparing the results of our model with the results of this software was limited to rigid tori 4 4 model validation with experimental test using eqs 23 and 24 the amplitude of vertical acceleration of i th torus is calculated by the following formula 59 w ω 2 n 0 a n a i cos n β here we validated the model results with the experimental test of three tori with the arrangement as shown in fig 5 the non dimensional vertical acceleration w c g ζ 0 on the middle torus for a 0 019 m c 0 75 m l 12 l 23 3 c and e i 0 426 n m 2 as function of non dimensional wavenumber ϑ a are shown in fig 16 at β 0 and β π the horizontal tension t p on the mooring lines is 3 n for a better view of the accelerations the single torus accelerations are also shown on the graph as expected at small wavenumbers for ϑ a 0 10 the tori do not have significant hydrodynamic interactions nevertheless after that with increasing the wavenumber the hydro elastic interaction between tori occurs as ϑ a increases the middle torus accelerations increases less than the single torus in waves it is due this fact that with increasing the wavenumber a part of wave reflected by the upper torus and the transmitted wave to the middle torus is decreased the other phenomenon which is evident in these figures is the oscillating behavior of acceleration versus ϑ a hence the acceleration has local extremum while its general behavior has an increasing rate versus ϑ a the main cause of this comes back to the radiation phenomenon that has complicated behavior as ϑ a increases error analysis of analytical results against experimental test performed and revealed that for β 0 rmse 0 49 and maximum error is 23 at ϑ a 0 29 with an average error of 7 5 while for β π rmse 0 65 and maximum error is 28 at ϑ a 0 29 with an average error of 8 in this analysis the average of experimental results at each measuring wavenumber are considered as one data which was compared against corresponding analytical results the data related to ϑ a 0 3577 were neglected due to the large divergence between experimental and analytical results it can be concluded that the model succeeded to predict the true accelerations at small and moderate ϑ a nonetheless as ϑ a increases the divergence between model and experimental results is increased this is due to the assumption of small ϑ a in the formula this is also true for those terms in eqs 23 and 24 which previously extracted by li 2017 the internal structure damping and the radial motions which are neglected here are another source of error these two parameters increase as the vertical motion increases on the other hand a large number of uncertainties occurred during the experiment for example the radial motions due to elastic deformations of the tori cause the changes in longitudinal distances between tori during the tests these changes had a negative effect on the accuracy of the results also the torus elastic deformations at large wave steepness overtopping and out of water phenomena changing the tori shape from circular to an oval shape in steep wave conditions the tori structural damping and also the non compliance of the tori with ideal elastic materials were another source of errors nevertheless for the actual sea wave spectrum and conventional fish cages ϑ a is less than 0 25 where the model has enough accuracy in this area the magnitude of vertical accelerations at β π 4 and π 2 are relatively small in comparison with acceleration at β 0 and π therefore they have not been presented here see also fig 17 b the non dimensional vertical acceleration w c g ζ 0 for a single torus with c 0 75 m a c 0 0253 e i 0 464 nm 2 and e i 23 74 nm 2 at β 0 π 2 and π with pre tension t p 5 0 n on mooring line are shown in fig 17 the corresponding experimental and wamit software results from li et al 2016 2018 are also presented in each figure as the results illustrate here the present method has enough accuracy in predicting the vertical accelerations at β 0 and π for e i 0 464 nm 2 at β π 2 the results of the present method do not match enough with experiments nonetheless the magnitude of accelerations is relatively smaller than those for β 0 and π therefore this inaccuracy does not affect the practical application of the method also there is a good agreement between the results of this method with those of wamit which uses high order 3d bem here also the error analysis was performed for analytical results against those results from wamit software and experimental test rmse and the maximum error of accelerations for the above wave conditions are presented in table 4 as this table shows the maximum error of 12 with rmse 0 31 occurred at e i 0 464 nm 2 and β 0 furthermore as fig 14c illustrates this relatively larger error occurred at only one point at ϑ a 0 22 hence we can say that there is good agreement between the analytical model and those of experimental results 4 5 other results of analytical model the non dimensional vertical acceleration w c g ζ 0 for three tori as shown in fig 5 with a 0 019 m a c 0 0253 and e i 0 426 nm 2 for the distance between tori l 0 5 c 1 0 c 1 5 c and 2 0 c at β π and β 0 are presented in figs 18 and 19 respectively in which up middle and down stand for the upstream the middle and the downstream tori as a c neglecting a respect to c l l i j 2 c represents the distance between external faces of two adjacent tori for small wavenumbers ϑ a 0 1 the tori have quasi static motion in waves and do not have significant effect on wavefiled therefore all tori in array encounter the same vertical acceleration as a single torus in waves but for ϑ a 0 1 the upper tori reflect a part of the wave and somehow shielding effect occurs as expected the downstream torus motions are smaller than those for the single torus the first torus located on the upstream and even the second torus which here is the middle one are the special cases because a part of the transmitted wave is reflected again by the downstream floaters and these floaters may encounter to larger wave loads for ϑ a 0 2 the radiation due to torus motions influences the accelerations consequently as ϑ a increases one source of oscillatory behavior of acceleration comes back to this phenomenon the vertical motions of the middle torus at β 0 and π and the downstream torus at β π decrease with increasing the distance between tori but the vertical motion of the downstream torus at β 0 does not have meaningful behavior as l increases l c and l 2 c are the semi rest position of the upstream torus in these locations the torus vertical motions are the same as the single torus in waves and the torus does not encounter by other tori interactions but for l 0 5 c and 1 5 c at ϑ a 0 2 0 25 the vertical motions are larger than those for the single torus see fig 18a c 19a and 19c as an estimate for conventional fish cages and depends on tori distances the peak value of accelerations is up to 35 larger than the acceleration of single torus in waves see figs 18c 19a and 19c the other investigated parameter is the effect of bending stiffness e i on vertical accelerations fig 20 shows the vertical acceleration for a single torus in waves with a 0 019 m a c 0 0253 and e i 0 3 0 45 and 0 6 nm 2 and for nearly rigid torus with e i 23 74 nm 2 and full rigid torus the results illustrate that as e i increases the vertical acceleration is decreased for example as e i doubles from 0 3 to 0 6 nm 2 the vertical acceleration for v a 0 15 0 25 decreased by 35 at downstream part of the floater at β 0 the effect of bending stiffness e i on vertical accelerations of tori array in waves is assessed for a c 0 0253 at l c and e i 0 3 0 45 and 0 6 nm 2 and for nearly rigid torus with e i 23 74 nm 2 and full rigid torus the results are presented in figs 21 and 22 for the upstream and the middle torus respectively it is evident from these figures that as e i increases the vertical accelerations decreased this fact can be explained by referring to eqs 23 and 24 whereas e i increases a n a i decreased subsequently it is expected that also a decrease in total accelerations occur also as e i decreases each floater has larger elastic motions leading to larger radiated waves consequently radiation also influences the tori it should be noted that for three tori the acceleration dependency on e i is smaller than single torus in waves see also fig 20 as an estimation when e i increased by two times from 0 3 nm 2 to 0 6 nm 2 the peak value of accelerations reduced by 10 while as described previously this reduction for single torus is about 35 since the accelerations on the downstream torus in comparison to other tori are relatively small the assessment here is limited to the upstream and the middle tours only see also figs 18 and 19 another parameter considered here is the torus relative dimension a c this parameter was assessed for a c 0 0253 0 0316 0 0395 and 0 0495 at a 0 019 m and e i 0 426 nm 2 two consecutive a c are selected so that the higher value is 25 bigger than the lower value as for different a c the main radius of two corresponding tori is different here for the correct judgment the absolute value of accelerations was divided by g ζ 0 then they are compared with each other the results are shown for the single torus in fig 23 and also for three tori arrangement l c in figs 24 and 25 as these figures illustrate for ϑ a 0 1 in both single torus and array of tori the accelerations are independent of a c and tori with different a c has the same accelerations but after that at constant cross section a torus with larger a c has smaller accelerations as a result for single torus in waves the difference between the maximum value of the acceleration of two consecutive a c is about 8 for three tori however by increasing a c the accelerations are generally decreased nevertheless this decreasing accelerations have many local extrema due to tori interactions the accelerations of the upper torus at β 0 are higher than in other locations therefore these accelerations are considered in more details see fig 24b as seen the difference between accelerations of two consecutive a c is mostly less than 8 it can be concluded that in conventional fish cages at the constant cross section when the dimensional ratio decreased by 25 the peak value of accelerations may increase by 8 however depend on other involving parameters each case should be assessed individually similar to the previous case for e i assessment since the acceleration on the downstream torus is relatively small in comparison to other tori therefore the assessment here is limited to the upstream and the middle torus only 5 conclusion torus with the absence of body ends and axisymmetric geometry is a unique example of a slender floating body in waves in this study a semi analytical model based on slender body theory and matched asymptotic expansions was developed to find the vertical motions of an array of elastic circular floaters in regular waves considering hydro elastic interaction between floaters and using linear wave theory the governing equations on relation between incident diffracted and radiated waves on the floaters were established in fourier modes and the velocity potential was determined in flow domain therefore the wavefield around floaters is also described after determination of the incident waves on each floater the wave induced loads were calculated the developed model was verified by bem based software ansys aqwa and wamit also a series of experimental tests were performed for model validation both comparisons demonstrated that the model has reasonable accuracy based on mathematical formulation and the real physical problem in the light of the most important results of this research the following conclusions can be drawn far away from the structure the diffracted wave from tours can be expressed as a simple function of fourier modes of incident waves for ϑ a 0 1 the floaters do not demonstrate significant interactions however after that as ϑ a increases the floaters acceleration in downstream is smaller than that of single torus in waves for ϑ a 0 15 the first and the second torus in the upstream may encounter larger accelerations in comparison to a single torus in waves the peak value of accelerations for first torus in upstream is larger than the acceleration of single torus in waves up to 35 floaters with larger bending stiffness encounter smaller accelerations as an estimation when e i increases by two times the peak value of accelerations reduces by 10 for three tori in waves while this reduction for single torus is about 35 in floaters of conventional fish cages with constant cross section as a c decreases by 25 the peak value of accelerations increases by 8 unlisted references since 1980 aqwa 2019 credit authorship contribution statement ataollah gharechae conceptualization methodology formal analysis software investigation writing original draft mohammad javad ketabdari conceptualization supervision project administration resources writing review editing daisuke kitazawa investigation supervision resources writing review editing qiao li investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21419,in this paper a semi analytical method was developed to find the vertical accelerations of array of semi submerged elastic circular floaters in regular waves in this process it was assumed that the fluid is inviscid incompressible and irrational flow furthermore incident wavelength was relatively large in comparison to the floaters cross section using slender body theory and matched asymptotic expansions the inner solution close to the body section composed of suitable radiation solution at large distance from floaters by this method the governing equation on the diffracted wave of each floater was expressed as a simple function of fourier modes of incident waves finally using linear wave theory the relationship between the incident radiated and diffracted waves on an array of floaters was established in fourier modes the model results demonstrate good agreement with those of the boundary element method a series of experimental tests were also performed for model validation the results show that as the wavenumber increases the floater hydro elastic interaction is becoming important furthermore the floaters on upstream have larger significant vertical motions in comparison to a single floater in waves keywords elastic torus vertical acceleration asymptotic expansion slender body theory hydro elastic interaction far field and near field solution 1 introduction marine aquaculture plays an essential role in bridging the gap between reducing wild fishing and increasing global demand for food since 1980 global aquaculture production has been grown annually by more than 8 however this growth declined to a moderate 5 8 during the period 2001 2016 nevertheless aquaculture continues to grow faster than other major food production segments fao 2018 the marine aquaculture cages are built in different types and sizes these cages can be mounted close together to form clusters that feed on a feeding platform and withstand strong currents and waves circular cages are arranged in mooring grids in single double or triple rows with common space between them which is usually selected as a multiplication of radius of their circular floater see fig 1 from an engineering standpoint the problem of wave floater interaction can involve large relative vertical floater motions large local floater accelerations wave overtopping and out of water phenomena as well as hydro elastic effects and hydrodynamic interaction between floaters in the cluster of cages fig 2 shows a deformed circular floater of fish cage due to environmental conditions in structures with significant weights fixed at a specific location acceleration creates large forces in joints and mooring lines an example of such structures is the floaters of aquaculture fish cages the dynamic loads of sea waves in these structures cause intermittent accelerations in the different parts of the structure consequently the force from these accelerations is applied to joints mooring lines and netting system understanding the nature of these accelerations is useful in the process of designing building and fatigue analyse of these structures as the cages are arranged in an array the hydrodynamic interaction between floaters is a challenging problem due to radiated and diffracted waves from other floaters therefore this complicated problem is considered in this study analytical or semi analytical solutions of wave incident to structures have always been attractive among researchers for example kagemoto and yue 1986 considered the three dimensional 3d water wave diffraction and radiation by a structure consisting of several separate members in the linearized potential flow other researchers such as newman 1997 li and faltinsen 2012 and li et al 2018 also paid attention to analytical or semi analytical methods slender body theory is prevalent to analyse the motions of marine structures in waves if wavelength λ is small enough respect to the inline body length l and comparable with the transverse body length a strip theory results with the leading order inner solution at each two dimensional 2d wave body interaction end effects are a source of inaccuracy or inconsistency in slender body theory for a body whose longitudinal axis is a closed curve without ends the end effects are absent for example in a torus with circular cross section of minor radius a and larger circle of major radius c the torus is slender if a c the hydrodynamic characteristics of such body shape are simplified by the lack of end effects and axisymmetric geometry newman 1997 based on hydrodynamic models we divided the studies of sea loads on floater of aquaculture fish cages in three general categories they are morison equation models potential flow models and computational fluid dynamic cfd models following a brief literature review on these categories have been presented with the assumption of strip theory many researchers used morison equation to find the wave or current forces on the floater part of aquaculture fish cages ormberg 1991 huang et al 2006 li et al 2007 zhao et al 2009 dong et al 2010 bai et al 2015 and zhao et al 2015 used morison equation and curved beam theory for investigating the elastic response of a circular floater in waves xu et al 2011 assessed the hydrodynamic response of a cage system using lumped mass method and rigid body kinematics theory li et al 2013 considered the hydroelectricity in the morison equation they modeled the net and floater with truss and beam element respectively and considered the non linearity in geometry deformation and motions bai et al 2016 assessed the fatigue analysis of high density polyethylene hdpe floating system in waves based on the deterministic method and finite element fe analysis and morison equation zhao et al 2019 developed a numerical model to investigate the deformations and stress distribution of floating pipes of fish cage subjected to flow the modeling approach was based on the combination of the fe method fem using the shell element to simulate the floating pipes and the hydrodynamic model improved from the morison equation and lumped mass method xu et al 2017 used a fe model for the structural analysis of the floating collar of a metal fish cage in waves in their work the hydrodynamic loads were calculated from the generalized morison equation the dynamic behaviour of a fish cage collar in waves and currents was investigated using a numerical model based on morison equation and fem by huang et al 2016 2018 the floating collar and mooring system were divided into a series of line segments modeled by straight massless model segments with a node at each end hydrodynamic response of a cage system under combinations of current and wave loading based on a morison force model was carried out by cifuentes and kim 2017 in their work the cage system include floating collar netting and ballast was modeled by a combination of line elements the earlier studies of wave induced responses on floating torus based on potential flow belong to davis 1975 who considered the forced vertical motions of a torus with arbitrary relative dimension and the short wavelength compared with both torus radius newman 1997 analyzed the motions of a floating torus oscillating in incident waves under the assumption that the wavelength is comparable with the radius of the body section and is small compared with the larger radius of the torus he solved the heave and surge radiation problems by simple applications of the method of matched asymptotic expansions li and faltinsen 2012 and also li 2017 developed a low frequency slender body theory for the vertical added mass damping and wave excitation loads on a single elastic semi submerged torus using matched asymptotic expansions with a near field and far field solution in their study a beam model described the elasticity effect of the torus li et al 2016 studied the longitudinal motions and vertical accelerations of a floating torus as well as wave motion inside the torus by model tests and second order potential flow theory in regular deep water waves they found a reasonable agreement between results in particular for the linear problem and small wave steepness a 3d weak scatter model with partly nonlinear effects as well as a 3d linear frequency domain method based on potential flow were used by li et al 2018 to model the vertical acceleration of an elastic circular collar of a floating fish farm in regular deep water waves due to the geometric and structural complexity of fish cages the direct cfd simulation of a fish farm is unrealistic recent researches using cfd has been limited to many geometric simplifications kristiansen and faltinsen 2008 developed a cfd numerical wave tank for nonlinear wave body interaction on a 2d fixed semi submerged circular cylinder tang et al 2017 used a cfd method in the combination with fem to model a flexible net panel xu et al 2018 developed a hydrodynamic model based on cfd method to obtain the hydrodynamic coefficients of a rigid segment of a fish cage collar yao et al 2016 modeled the current loads on a net cage considering the fluid structure interaction fsi they used the mass spring model for net cage and the finite volume method fvm for flow field ong et al 2017 performed 2d simulations to investigate the free surface waves past two semi submerged horizontal circular cylinders in tandem by solving the unsteady reynolds averaged navier stokes equations uranse the broad literature as above shows that despite few studies performed on the hydrodynamics of fish cages in waves the interaction of elastic floater parts of cages has not been considered therefore the objective of this paper is to develop a semi analytical method based on slender body theory and matched asymptotic expansions to describe the hydrodynamic interaction of hdpe elastic floaters in incident waves in this procedure two simpler 2d problems are solved separately instead of solving a complex 3d problem one of them is the inner solution close to the body section near field solution and another one is radiation solution at large distance of floater far field solution the inner solution is simplified because it is 2d whereas the outer solution is simplified by neglecting the body boundary condition these solutions are matched in an overlap region to constitute a complete solution therefore the main novelty of this research work is developing a semi analytical method to model the sea wave interaction with an array of elastic floaters in short the present study can be considered as a continuation of li 2017 who worked on a single elastic semi submerged torus it is expected from their work that if we use tandem fish cages instead of single one the radiated wave generated by one floater can affect other tori the elastic motions of floaters and the wave scattering are another source of hydrodynamic interaction between cages which adds to complexity of the problem therefore the structure of this paper is as follows in section 2 after the problem description the governing equations are presented in the following the hydrodynamic potentials for tori interactions are derived these are scattering of incident waves by the structure and radiated potential due to associated body movement and elastic motions finally in this section the exciting forces are derived and the hydrodynamic response of each torus is calculated section 3 describes the experimental tests were performed for mathematical model validation in section 4 the results on analytical numerical and experimental models are presented in this section first the present method was verified by bem based software and validated with experimental tests after that the involving parameters such as floater dimensions the distance between floaters and bending stiffness of floaters are studied and the results are presented and discussed finally in section 5 some conclusions are drawn 2 mathematical formulation in this section the mathematical formulation of the problem is presented in detail 2 1 problem description the analytical formulation is developed considering one rows of semi submerged circular floaters with the large radius c the cross section radius a the bending stiffness e i and the distance center to center of l i j see fig 3 a the fluid is considered as inviscid incompressible and irrotational flow the incident wave is a regular deep water wave with amplitude ζ 0 propagating along the positive x axis based on the linear wave theory the deep water implies when h λ 2 where h is the water depth and λ is the wavelength therefore according to dean and dalrymple 1991 the incident wave potential in deep waters is expressed as 1 i 0 ζ 0 g ω e x p ϑ z i ϑ x i ω t where ω is the wave frequency g is the gravity acceleration ϑ ω 2 g is the wavenumber z is the vertical axis positive upwards x is the wave propagation direction t is the time variable and i 1 is the imaginary number see also fig 3b and c the long length wave assumption means the wavelength is long relative to the cross sectional diameter of the floater a linear frequency domain solution for the vertical response of tori will be analytically derived based on matched asymptotic expansions in this expansion the solution performs for far field and near field in a way to be matched in far field solution the cross section of the floater is neglected while in the near field the details of this cross sectional is considered as shown in fig 3b in far field view the cylindrical coordinate system ρ β z is used with z 0 on free surface and z positive upwards the direction β 0 is chosen to coincide with the incident wave propagation the torus consists of a tube with a main radius c large radius and a cross section radius a minor radius where c a the body located in z 0 plane at a distance ρ c from the vertical axis with respect to the local cartesian coordinate we have x ρ cos β y ρ sin β and z z in near field solution the local cartesian coordinate system oy z and polar coordinate system or θ are used see fig 3c 2 2 governing equations the motion of a torus located in the array is affected by diffracted and radiated waves from other tori therefore based on the linear wave theory the velocity potential on the jth torus in the array is expressed in the form of the following general equation 2 i t j i 0 j i 1 i j n r i d i 0 i d i in which n is the number of tori in the array i 0 j is the velocity potential due to incident wave r i is the radiated potential due to motion of the ith torus in the location of jth torus d i 0 i is the diffracted wave by ith torus in the location of jth torus due to incident wave i 0 i to ith torus d i is the diffracted wave by ith torus in the location of jth torus due to other incident waves to the ith torus to solve the problem a step by step solution is used in the first step it is assumed that each torus movement is independent of other tori the motion of each torus is determined then the radiated and diffracted waves by each torus are also calculated these waves are considered as incident waves to other tori this procedure is continuing until the motions are converging to a special value therefore in the above formula when using step by step solution all terms except d i are known the unknown d i should be determined by implementing the body boundary condition in the solution method we first derivate the essential formula for solving the problem as well as the solution for the vertical motion of a single torus in regular waves as flow is considered irrotational and incompressible the velocity potential satisfies the laplace equation 3 2 2 x 2 2 y 2 2 z 2 0 the body boundary condition is as the following 4 n u b n on body surface in which u b is the body velocity and n n ρ n β n z is the unit normal vector on the body surface because of the wavefield and the torus geometrical symmetry the vertical motion w of the torus can be expressed by the following cosine fourier series 5 w s a 0 t n 1 a n t cos n β where a 0 t a 0 a e i ω t and a n t a n a e i ω t the term a 0 and a 1 cos β describe heave at the torus axis and vertical motion due to pitch motion respectively the higher terms in series represent the elastic motions as we assumed a c ε 1 a o 1 c o 1 ε n ρ o 1 n β o ε n z o 1 β o ε the physical conditions on the above problem are following the low frequency slender body theory consequently 6 1 c β ρ z thus the 3d laplace equation reduces to a 2d equation in the polar coordinate system as defined in fig 3c 7 2 r 2 1 r r 1 r 2 2 θ 2 0 similarly the body boundary condition of eq 4 is replaced by 8 r u b r n r on r a where u b r is the normal velocity component of the local cross section of the torus velocity u b and n r is the normal component of the local cross section of the unit normal vector n since we consider vertical motions of a body on the free surface the outer solution arises by distributing 3d sources along the torus center line which should satisfy the radiation condition at infinity the near field inner and far field outer solutions are matched in an overlap region c ε ρ c far from the torus in the inner region but very close to the torus in the outer region this method is useful to be able to solve two separate problems analytically the inner solution is simplified because it is 2d whereas the outer solution is simplified by neglecting the body boundary condition 2 3 far field solution the governing equations for velocity potential f in the far field are 9 2 f 0 10 ϑ f f z 0 on z 0 with referring to fig 3b the coordinates of the torus center line can be expressed as 11 ξ c cos α η c s i n α ζ 0 the field point has coordinates x y z and source point has coordinates ξ η ζ in the far field view ζ 0 for each fourier mode we consider separate vertical motions the associated source density varies as q n c o s n α exp i ω t along the center line of the torus therefore the far field velocity potential can be expressed as 12 f q n exp iωt 4 π c 0 cos nα g x y z ξ η ζ d α on ζ 0 havelock 1942 1955 presented the following source expression green function 13 g x y z ξ η ζ 1 r 1 r 4 ϑ π 0 ϑ c o s k z ζ k s i n k z ζ k 0 k r k 2 ϑ 2 d k 2 π ϑ e x p ϑ z ζ y 0 ϑ r 2 i π ϑ e x p ϑ z ζ j 0 ϑ r where r x ξ 2 y η 2 z ζ 2 is the distance from field point to the source point and r x ξ 2 y η 2 z ζ 2 r x ξ 2 y η 2 furthermore j 0 and y 0 are the bessel function of the first kind and second kind of zero order respectively and k 0 is the modified bessel function of zero order with assumption that ϑ a is small and in far from torus body i e ρ c 0 all local waves decay and the fluid potential is expressed by asymptotic expansion of eq 12 as following 14a o f i c q n π ϑ j n ϑ c h n ϑ ρ exp ϑ z i ω t cos n β for ρ c 14b o f i c q n π ϑ h n ϑ c j n ϑ ρ exp ϑ z i ω t cos n β for ρ c where h n ϑ ρ j n ϑ ρ i y n ϑ ρ is the hankel function of the first kind the above equations have error of order o 1 ϑ 3 ρ 3 ϑ 2 z 2 γ 3 ϑ z ϑ 2 c 2 1 ϑ 2 c 2 z 2 c 2 ρ 2 for ρ c and error of order o ϑ 2 ρ 2 ϑ 2 z 2 γ 3 z 2 c 2 ρ 2 for ρ c where γ ρ c ρ 2 c 2 z 2 eq 14a is used as the basic solution to express the radiation potential due to motion of a torus in mode n and in close to other tori the application of this equation will be described in sections 2 6 and 2 7 eq 14b can be used to express the wavefield inside of tours but with enough distance from torus body li 2017 derived an inner expansion of eq 12 by assuming that ϑ a is small 15 i f c q n exp i ω t π cos n β 1 ϑ z ln 8 c r k n ϑ z ϑ θ y 1 ϑ z ϑ c π 2 1 2 j n ϑ c y n ϑ c i j n ϑ c 2 ϑ π c 4 1 ϑ z 0 2 π h 0 ϑ r ρ c cos n μ d μ where h 0 ϑ r is the struve function and k 0 0 and k n 2 1 1 3 1 5 1 2 n 1 for n 1 the source strength q n can be found by equating the far field potential with the near field one 2 4 near field solution in near field description the detail of flow filed in the torus cross section is considered with slender body theory assumption the velocity potential assumed to be constant in the tangential direction of the torus thus the governing equation for near field velocity potential n is the 2d laplace equation eq 7 therefore the linearized free surface and body boundary conditions can be expressed as following 16 ϑ n n z 0 on z 0 17 n r v 3 n θ cos θ cos n β on r a z 0 where v 3 n θ is the vertical motion of fluid particles on the body surface generally a function of θ li 2017 used ursell 1949 studies to find the near field potential here we modified his derivate in a form to be suitable for computational practice as follows 18 n v 3 n c o s n β a 0 n 1 ϑ z ln 8 c r k n c n ϑ z ϑ θ y m 1 a 2 m n a 2 m c o s 2 m θ r 2 m ϑ c o s 2 m 1 θ 2 m 1 r 2 m 1 the coefficients q n and c n in eqs 15 and 18 are found by equating the far field potential with the near field one hence r in the near field expression and the far field potential is implemented as close as possible to the torus the result is 19 c n π ϑ c π 2 j n ϑ c i π j n ϑ c 2 1 4 0 2 π h 0 ϑ c 2 1 c o s μ cos n μ d μ 20 q n v 3 n π a 0 n the body boundary condition eq 17 leads to the following equation 21 a 0 n ϑ c o s θ ln 8 c a k n c n 1 a ϑ θ s i n θ m 1 a 2 m n 2 m c o s 2 m θ a ϑ c o s 2 m 1 θ v 3 n θ cos θ the terms a 0 n and a 2 m n lead to an infinite system of equations which can be truncated and solved using numerical methods 2 5 governing equation on the vertical motion of torus considering the curvature and axial stiffness the equation for the vertical motion w of the torus is based on euler bernoulli for curved beam as 22 m 2 w t 2 ρ w g b ω w e i 4 w s 4 e i c 2 2 w s 2 s t a s w s f 3 s a d d e d m a s s d a m p i n g f 3 s w a v e e x c i t f 3 s m o o r i n g f 3 s a d j t o r i the above equation is similar to formula used by li 2017 here we add the term f 3 s a d j t o r i to the formula to consider the influence of hydrodynamic interactions of adjacent tori in this equation s c 1 β and m is the torus mass per unit length term e i c 2 2 ω s 2 considers the curvature effect of the torus f 3 s m o o r i n g is the vertical component of the mooring line forces t a s is the axial stiffness which is calculated by static analysis of the moored torus furthermore f 3 s a d d e d m a s s d a m p i n g is the vertical added mass and damping force per unit length of the torus and f 3 s w a v e e x c i t is the vertical wave excitation force per unit length of the torus the term ρ w g b ω is caused by the change of the buoyancy force due to the motion w here ρ w is the mass density of water and g is the gravitational acceleration since we consider a semi submerged torus b ω is 2a as for low structural modes the structural damping is small it was neglected with assumption of low frequency slender body theory and using asymptotic expansion with near field and far field solution the velocity potential and consequently the vertical motion of single torus can be found li 2017 we added new terms j 1 j i n f 3 d j n f f k j n to the available formulation for the vertical motion of torus in array the derivated formula for amplitude of vertical motions in mode n is as following 23 a 0 a i ζ 0 1 π ϑ a 4 ρ g b ω ω 2 a 33 0 i ω b 33 0 exp ϑ z m i j 0 ϑ c t a j 1 j i n f 3 d j 0 f f k j 0 ω 2 m a 33 0 i ω b 33 0 ρ g b ω 24 a n a i ζ 0 1 π ϑ a 4 ρ g b ω ω 2 a 33 n i ω b 33 n exp ϑ z m 2 i n 1 j n ϑ c t b j 1 j i n f 3 d j n f f k j n ω 2 m a 33 n i ω b 33 n ρ g b ω e i c 4 n 4 n 2 t c f o r n 0 25 t a 1 2 π 0 2 π i 1 n o m t p 3 δ β β i d β 26 t b 1 π 0 2 π i 1 n o m t p 3 δ β β i d β 27 t c 1 π c 2 m 1 i 1 n o m a m a n 2 t a s i β i β i 1 d β j 1 j i n f 3 d j n f f k j n represents the froude krylov and diffracted forces due to incident waves to the i t h torus from other tori t p 3 is the vertical component of pre tension of the mooring lines and n o m points to number of mooring lines β i describes the attachment positions between mooring lines and the torus and δ is the dirac delta function the axial tension t a s i can be calculated in a simplified manner as described by kristiansen and faltinsen 2015 the term t c in eq 27 demonstrates the coupling effect between different modes a 33 n and b 33 n are the added mass and damping in mode n and z m 4 a 3 π is the center of wetted part of the cross section of the torus 2 6 solution to hydrodynamic interaction between tori the main objective of this research is to calculate the hydrodynamic interaction between tori it means we are calculating the term j 1 j i n f 3 d j n f f k j n on eqs 23 and 24 in eqs 14a and 15 we developed the outer expansion named o f and inner expansion named i f for source distribution on the center line of torus respectively in eq 18 the inner solution named n was developed here the way we used them to solve the problem of hydrodynamic interaction between tori is explained based on the linear wave theory the diffracted wave of jth torus d j should satisfy the body surface boundary condition hence 28 d j n i j n n i 1 i j n r i d i 0 i d i where n is the normal vector on the body surface d i and d j are both unknown and should be determined we express all velocity potentials in the form ϕ ρ β exp ϑ z i ω t the term ϕ ρ β is expressed in the fourier modes therefore we have 29 ϕ ρ β n 0 ϕ n cos n β 2 7 far field velocity potential due to radiation considering v 3 n a n where a n is the vertical velocity in mode n implementing it into eq 20 and using eq 14a the radiation velocity potential is obtained as the following 30 ϕ r n ϑ c ω π 2 a 0 n a n a j n ϑ c h n ϑ ρ cos n β using fourier series the velocity potential due to motion of ith torus on jth torus on mode m is expressed as following 31 ϕ r i j m n 0 r m n i j cos m β in which 32 r m n i j a n i c r n i m n i j and 33 c r n ϑ c ω π 2 a 0 n j n ϑ c 34 i m n i j ε m π 0 2 π h n ϑ ρ i j cos n β i j cos m β d β where ε m 1 2 for m 0 and ε m 1 for m 0 with refer to fig 4 when jth torus is located on the upstream of ith torus ρ i j and β i j are as following 35 ρ i j u ρ j 2 l i j 2 2 ρ j l i j cos β j β i j u tan 1 ρ j sin β j l i j ρ j cos β j and when jth torus is located on the downstream of ith torus ρ i j and β i j are expressed as 36 ρ i j d ρ j 2 l i j 2 2 ρ j l i j cos β j β i j d π tan 1 ρ j sin β j l i j ρ j cos β j 2 8 far field velocity potential due to diffraction of incident wave the incident wave to the ith torus can be expressed by following fourier series involving bessel function as 37 i 0 i g ζ 0 exp ϑ z i ω t ω exp i ϑ l i j 0 ϑ c n 1 2 i n j n ϑ c cos n β exp ϑ z i ω t n 0 ϕ i 0 i n cos n β n 0 i 0 i n cos n β where l i is the distance of center of ith torus from global coordinate system therefore the normal velocity due to incident wave on the near field solution is 38 d i 0 n n i 0 n n i 0 n c n c i 0 n z n z where n c sin θ n z cos θ and i 0 n z ϑ cos θ i 0 n using the principle of differential equations the above differential equation is separated into two independent differential equations which include the first and second terms in the right hand side of the equation implementing them in the system of eq 21 the following system of equations is derived 39 a 0 s n ϑ c o s θ ln 8 c a k n c n 1 a ϑ θ s i n θ m 1 a 2 m s n 2 m c o s 2 m θ a ϑ c o s 2 m 1 θ ϕ i 0 n c sin θ exp ϑ a cos θ and 40 a 0 n ϑ c o s θ ln 8 c a k n c n 1 a ϑ θ s i n θ m 1 a 2 m n 2 m c o s 2 m θ a ϑ c o s 2 m 1 θ ϑ cos θ ϕ i 0 n exp ϑ a cos θ ϕ i 0 n c and ϕ i 0 n is considered constant in the cross section of the torus multiplying both sides of eq 39 by cos 2 n θ and using the orthogonal properties of sine and cosine functions and integrating it from π 2 to π 2 lead to a 2 m s n 0 for 0 1 2 using taylor expansion we can approximate the right hand side of eq 40 as a function of cos θ similar to the previous one multiplying both sides of eq 40 by c o s 2 n θ and integrating from π 2 to π 2 lead to an infinite system of equations which can be truncated and solved by numerical methods unknowns a 2 m n is also determined with reference to far field solution eq 14a the diffracted potential is obtained as 41 ϕ d i 0 n c d n h n 1 ϑ ρ ϕ i 0 n where 42 c d n i c ϑ 2 π 2 a 0 n j n ϑ c eq 41 expresses the relation between incident wave at mode n ϕ i 0 n and diffracted wave ϕ d i 0 n by the torus at far from it therefore the above solution can also be used to describe the diffracted wave because of other incident waves to the torus similar to radiation the diffracted waves ϕ i 0 n from ith torus in location of jth torus can be expressed by fourier series as 43 ϕ d i 0 i j m n 0 d 0 m n i j cos m β where 44 d 0 m n i j c d n i m n i j 2 9 general solution to incident wave from other torus far from torus the diffracted waves from ith torus can be expressed by following 45 ϕ d i n 0 d n i h n ϑ ρ i cos n β i this potential in location of jth torus is expressed in the fourier s mode m by following form 46 ϕ d i j m n 0 d n i d m n i j cos m β where 47 d m n i j i m n i j with regards to eq 41 the general solution of eq 28 can be expressed as following 48 d j m c d m i 1 i j n r i j m d i 0 i j m d i j m implementing the values of eqs 31 41 and 46 to eq 48 the following system of equations is derived as 49 d m j c d m i 1 i j n n 0 d n i d m n i j c d m i 0 i j n n 0 r m n i j d 0 m n i j i j 1 n m 0 the above system of equations is truncated for limit of modes n m o d e and by solving them the unknown d m j is determined for j 1 n and m 0 n m o d e therefore the total incident velocity potential to jth torus in array in mode m is expressed as 50 ϕ i t j m ϕ i 0 j m i 1 i j n n 0 n m o d e r m n i j d n i d m n i j d 0 m n i j cos m β in this equation ϕ i 0 j m is the velocity potential on mode m from main incident wave eq 1 to jth torus r m n i j is the radiated potential from ith torus because of motion on mode n of this torus see also eq 5 d n i d m n i j is the scattered wave from ith torus because of all incident waves except the main incident wave to ith torus and d 0 m n i j is the scattered wave from ith torus because of main incident wave to this torus therefore 51 i t j m 0 n m o d e ϕ i t j m exp ϑ z i ω t cos m β 2 10 calculating the exciting forces the exciting force can be divided into two terms froude krylov and diffraction forces the froude krylov term is calculated by integrating the pressure around wetted surface of the torus therefore p ρ w i t j m t f f k i ω ρ w ϕ i t j m s where s s j exp ϑ z n z d s 2 a 1 π ϑ a 4 ϑ 2 a 2 3 s j is the wetted surface of the cross section of torus and n z is vertical component of normal vector on body surface consequently we have 52 f f k j m i ω ρ w s ϕ i t j m generally calculating the diffracted waves is associated with solving the diffraction problem here with the assumption that the torus cross section is relatively small in comparison to wavelength we used the following approximation for diffraction force 53 f 3 d j m a 33 m a 3 ζ b 33 m w ζ where w ζ z and a 3 ζ 2 z t are the vertical velocity and accelerations of water particles respectively the best place for their approximation is on z z m li 2017 used the same manner for estimating the diffraction force therefore 54 f 3 d j m ϑ b 33 m i ω a 33 m exp ϑ z m ϕ i t j m the above value is implemented into eqs 23 and 24 to calculate the vertical motion of each torus in the array and the solution is completed 3 experimental tests experimental tests were performed in iis ocean engineering basin at the university of tokyo in january to june 2019 the objective was to measure the vertical accelerations at specified locations on the floaters as the surface gravity waves have the essential role in the generated forces the froude number scaling was used therefore it is not possible to satisfy the reynolds number simultaneously which describes the viscus effects also the keulegan carpenter number is small leading to negligible flow separation hence the potential flow assumption can describe fluid behavior the viscous damping is a matter that can not be neglected in the case of flow separation this may be considerable in steep waves with short period when overtopping and out of flows phenomena occure a schematic view of the test set up is shown in fig 5 other parameters are described in table 1 the ocean basin had 50 0 m length 10 0 m breadth and 5 0 m depth the wave tank was equipped with a plunger type wave maker and a damping beach covered by porous mat to increase its energy dissipation ability the wave maker is controlled by software to estimate the necessary stroke of the piston for generating linear waves with a given height and period the model was chosen from standard type corrugated tubes which are used to cover the electric cables in houses the corrugations were covered by waterproof adhesive electrical tape to obtain a constant cross section see fig 6 a and c the model scale was 1 25 the parameters were chosen such that the values be in the range of typical existing floaters the structural bending stiffness e i was estimated by using the static deflection equation δ p l 3 3 e i of a cantilever beam of length l and with a fixed end support at one end and load p applied at the other end of the beam e i was estimated by measuring the deflection δ see fig 6b the hdpe pipes which are widely used in aquaculture fish farming have young s modulus of elasticity e 0 8 1 gpa with reference to model scaling the model has realistic bending stiffness three floaters were attached to the stationary carriage in the middle of the tank by nearly horizontal mooring lines at the front aft and lateral positions as shown in fig 5 they were connected to the floaters through 8 attachment points with equal intervals as shown in this figure the semi suspended chains with 3 n average suspended weight was used at the end of attachment to implement tension as a linear function of the displacement to the mooring lines the semi suspended chains act as a linear spring and impose the tori to maintain their initial positions during the test special attention should be paid for tension in mooring lines very small tension leads to relatively large longitudinal motions of the floaters when they are tested at large wave steepnesses and long wave periods on the other hand the large tension or inequivalent tension on mooring lines causes that the circular shape of the floaters change to an oval shape controlling the relative motions between floaters is another challenge therefore if the pretension in mooring lines is not distributed correctly a desirable distance between floaters is not achieved in another word during the tests large relative motion causes the change of initial distance between floaters moreover many precautions should be made to do the desirable tests the floaters were semi submerged in calm conditions where the initial distance between center to center of two adjacent floaters was equal to 3 c the vertical accelerations were measured by accelerometers at β 0 π 4 π 2 and π the wave probe was installed upstream during the test also in conjunction with every test one test was performed to measure the undisturbed wave height in the absence of floaters in the tank in such test condition the wave parameters were measured in the location of the middle floater center see fig 6 incident waves with different wave steepnesses h λ 1 60 1 30 and 1 15 were tested nevertheless the actual wave height in location of the floaters is slightly different from those set to the wave maker software because of the waves decay the wave period t varied within 0 45 1 5 s with the time step 0 025 s a part of test wave conditions are presented in table 2 all test cases were repeated two to five times a waiting time of three to 8 min between each test was chosen to let the waves damp out the preliminary tests showed that in general nearly steady state conditions are reached after 10 waves the measured signals from all sensors went through an amplifier and the acquisition data were stored with a sampling frequency of 100 hz the discrete fourier transform dft was used to find each harmonic contribution in time series the steady state time window was band pass filtered in order to remove noise out of the prescribed frequency range the lowe pass and high pass cut off frequencies were 0 95 t and 1 05 t 1 95 t and 2 05 t and 2 95 t and 3 05 t in order to get first second and third harmonics of accelerations respectively the higher harmonic acceleration does not have special contribution in time series see fig 7 after implementing the cut off frequencies and removal of the noises the time series of each harmonic motions was replotted consequently the mean value of extremum which describes the envelope curve was found in software as the amplitude of acceleration in each harmonic motions w a f the mean acceleration was calculated using fourier series by finding the maximum value of the following formula 55 w t w a 1 f cos 2 π f t w a 2 f cos 4 π f t w a 3 f cos 6 π f t where w a 1 f w a 2 f and w a 3 f are the amplitude of accelerations at first second and third harmonic motions respectively and f 1 t is the wave frequency large vertical and horizontal motions with significant hydro elastic effects as well as waves over topping and out of water phenomena were observed on the floater at small wave period and large wave steepness tests in these test conditions the fluid behavior should be described by nonlinear and viscous effects the objective of the experimental test was the semi analytical model validation therefore the experiments were limited to special cases theoretically the influence of wide range of parameters can be investigated in this study therefore after establishment of the model and ensuring the range of its validity investigation of the other predominant parameters is the mission of the semi analytical model 4 results and discussion in this section the results on analytical numerical and experimental models are presented 4 1 numerical model description and mesh sensitivity analysis the numerical model was used for analytical results verification this model was generated in ansys aqwa software which uses 3d bem for modeling the diffraction and radiation problems the current version of this software is only capable of modeling rigid structures in sea waves therefore comparing the results of our model with those of this software is limited to rigid tori nevertheless in this section before using the numerical model its grid independency is examined for this purpose the accuracy of the numerical model in calculating the maximum and minimum free surface elevation for scattered wave filed around a single fixed torus with a 0 45 m a c 0 024 and non dimensional wavenumbers ϑ a 0 15 and ϑ a 0 25 has been investigated see also figs 10b and 11b these values are calculated in 2000 10 384 elements on the torus body surface and the results are shown in fig 8 a in this figure horizontal axis shows the number of elements n e and two vertical axis show the maximum and minimum values of free surface elevations as the results illustrate for about 5924 elements and more the maximum and minimum of free surface elevation converge to a certain value and the results are independent of the number of grids therefore in all numerical modeling of this research 5924 elements were considered on the surface of each torus fig 8b shows the zoom view of element distributions on the torus body 4 2 model verification for scattered wavefield around single torus the scattered wavefield around a single fixed torus can be calculated by adding the incident velocity potential to the summation of fourier terms on eq 41 hence 56 s i 0 exp ϑ z i ω t n 0 c d n ϕ i 0 n h n ϑ ρ cos n β with assumption of linear wave theory the free surface elevation can be expressed as 57 ζ re 1 g s t where r e means the real part of expression the scattered wave amplitude ζ a ζ 0 around a fixed rigid torus for a 0 45 a c 0 024 and ϑ a 0 05 0 15 and 0 25 are shown in figs 9 11 respectively the corresponding ansys aqwa results also presented on the right hand side of each figure as these figures demonstrate there is a good agreement between the general patterns of wave contours of two methods the origin of some superficial differences observed between these results is using different softwares to produce two figures the ansys aqwa results are also shown for wave amplitude inside of the torus if the maximum or minimum wave height occur inside of the torus see figs 10b and 11b the color spectrum resolution decreases outside the torus and causes the color appearance of two methods to be different to clarify the issue we compared the wave amplitude at different radial distances by two methods in one diagram see fig 12 it should be noted that the wavefield inside of the floater can be presented by rewriting eq 56 as s i 0 exp ϑ z i ω t n 0 c d n ϕ i 0 n j n ϑ ρ cos n β and c d n in eq 42 as c d n i c ϑ 2 π 2 a 0 n h n ϑ c the outer expansion for velocity potential eq 14b is based on that ρ c consequently eq 56 does not give a realistic solution about wave potential near torus body therefore the above correction presents an approximate solution for wavefield inside the torus but at a far distance from its body the inaccuracy of the model results inside of the torus and especially near torus body cases large unrealistic value for wave height in this area therefore presenting the model results for this area causes reduction of graph resolution in other areas outside of the torus thus we did not present the analytical model results inside of the torus it should be noted that this inaccuracy in calculating the wavefield near floater body does not make the model inefficient in calculating the hydrodynamic forces and wave induced responses from this point of view the exciting forces are calculated in the manner described in subsection 2 10 in this method there is no need to calculate the diffraction potential on the torus body and the froude krylov and diffraction forces are calculated directly from the velocity potential of incident waves using eqs 52 and 54 the strength of the analytical model is that it is able to calculate the scattered and radiated wave from one tori in adjacent to other tori in eqs 52 and 54 these waves are considered as incident waves to other tori the results of the present method and ansys aqwa for scattered wave amplitude in front β π and aft β 0 of a semi submerged circular rigid floater with a c 0 024 as a function of non dimensional radial distance ρ c are shown in fig 12 in this figure ζ a ζ 0 is the non dimensional wave amplitude ζ 0 is incident wave amplitude the results show that as ρ c increases the accuracy of the present method increases and this method has calculated the maximum and minimum location and the amount of wave height appropriately the inaccuracy near the floater body ρ c 1 is not important because to evaluate the tori interactions it is necessary to correctly estimate the scattered wavefield from one torus to vicinity of another one an error analysis was performed using root mean square error rmse of maximum free surface elevation for each wave condition this parameter was also calculated for all comparison points and presented in table 3 as this table shows the maximum error 6 5 with r m s e 0 05 occurred at ϑ a 0 15 and β π meanwhile the rmse for all waves conditions is less than 0 037 4 3 model verification for wavefield around array of torus in this subsection the results of present modeling and ansys aqwa software for wavefield around three rigid tori are compared the analytical model considers just the heave and pitch motions as calculated by solving the system eq 49 and implementing d n i on eq 50 the tori arrangement is as shown in fig 5 also in ansys aqwa model the system is restricted such that the tori have only vertical heave and pitch motions in the analytical model the total velocity potential on the cylindrical coordinate system at the middle torus see fig 3 is expressed by the following formula 58 t i 0 exp ϑ z i ω t n 0 ϕ 1 n ϕ 2 n ϕ 3 n where ϕ 1 n c d n exp i ϑ l 12 ϕ i 0 n c r n a n a 1 d n 1 h n ϑ ρ 12 cos n β 12 ϕ 2 n c d n ϕ i 0 n c r n a n a 2 d n 2 h n ϑ ρ cos n β ϕ 3 n c d n exp i ϑ l 32 ϕ i 0 n c r n a n a 3 d n 3 h n ϑ ρ 32 cos n β 32 ϕ i 0 0 j 0 ϑ ρ and for n 0 ϕ i 0 n 2 i n j n ϑ ρ here the superscript number on a n points to the torus number in the array replacing s in eq 57 by t the free surface elevation is calculated the non dimensional wave amplitude ζ a ζ 0 includes scattered and radiated waves around 3 rigid tori for a 0 45 a c 0 024 l 12 l 23 3 c and ϑ a 0 05 0 15 and 0 2 are presented in figs 13 15 respectively the corresponding ansys aqwa results are also displayed beneath our results in each figure as the figures demonstrate there is a good agreement between the general patterns of wave contours of two methods the reason for existence of some superficial differences in these figures has been previously discussed in the description of figs 9 11 as was mentioned before the governing equations derived here are only applicable for wavefield outside of the tori therefore the wavefield inside of tori has not been presented for analytical model results the current versions of ansys aqwa software are only capable of modeling the rigid structures in sea waves therefore comparing the results of our model with the results of this software was limited to rigid tori 4 4 model validation with experimental test using eqs 23 and 24 the amplitude of vertical acceleration of i th torus is calculated by the following formula 59 w ω 2 n 0 a n a i cos n β here we validated the model results with the experimental test of three tori with the arrangement as shown in fig 5 the non dimensional vertical acceleration w c g ζ 0 on the middle torus for a 0 019 m c 0 75 m l 12 l 23 3 c and e i 0 426 n m 2 as function of non dimensional wavenumber ϑ a are shown in fig 16 at β 0 and β π the horizontal tension t p on the mooring lines is 3 n for a better view of the accelerations the single torus accelerations are also shown on the graph as expected at small wavenumbers for ϑ a 0 10 the tori do not have significant hydrodynamic interactions nevertheless after that with increasing the wavenumber the hydro elastic interaction between tori occurs as ϑ a increases the middle torus accelerations increases less than the single torus in waves it is due this fact that with increasing the wavenumber a part of wave reflected by the upper torus and the transmitted wave to the middle torus is decreased the other phenomenon which is evident in these figures is the oscillating behavior of acceleration versus ϑ a hence the acceleration has local extremum while its general behavior has an increasing rate versus ϑ a the main cause of this comes back to the radiation phenomenon that has complicated behavior as ϑ a increases error analysis of analytical results against experimental test performed and revealed that for β 0 rmse 0 49 and maximum error is 23 at ϑ a 0 29 with an average error of 7 5 while for β π rmse 0 65 and maximum error is 28 at ϑ a 0 29 with an average error of 8 in this analysis the average of experimental results at each measuring wavenumber are considered as one data which was compared against corresponding analytical results the data related to ϑ a 0 3577 were neglected due to the large divergence between experimental and analytical results it can be concluded that the model succeeded to predict the true accelerations at small and moderate ϑ a nonetheless as ϑ a increases the divergence between model and experimental results is increased this is due to the assumption of small ϑ a in the formula this is also true for those terms in eqs 23 and 24 which previously extracted by li 2017 the internal structure damping and the radial motions which are neglected here are another source of error these two parameters increase as the vertical motion increases on the other hand a large number of uncertainties occurred during the experiment for example the radial motions due to elastic deformations of the tori cause the changes in longitudinal distances between tori during the tests these changes had a negative effect on the accuracy of the results also the torus elastic deformations at large wave steepness overtopping and out of water phenomena changing the tori shape from circular to an oval shape in steep wave conditions the tori structural damping and also the non compliance of the tori with ideal elastic materials were another source of errors nevertheless for the actual sea wave spectrum and conventional fish cages ϑ a is less than 0 25 where the model has enough accuracy in this area the magnitude of vertical accelerations at β π 4 and π 2 are relatively small in comparison with acceleration at β 0 and π therefore they have not been presented here see also fig 17 b the non dimensional vertical acceleration w c g ζ 0 for a single torus with c 0 75 m a c 0 0253 e i 0 464 nm 2 and e i 23 74 nm 2 at β 0 π 2 and π with pre tension t p 5 0 n on mooring line are shown in fig 17 the corresponding experimental and wamit software results from li et al 2016 2018 are also presented in each figure as the results illustrate here the present method has enough accuracy in predicting the vertical accelerations at β 0 and π for e i 0 464 nm 2 at β π 2 the results of the present method do not match enough with experiments nonetheless the magnitude of accelerations is relatively smaller than those for β 0 and π therefore this inaccuracy does not affect the practical application of the method also there is a good agreement between the results of this method with those of wamit which uses high order 3d bem here also the error analysis was performed for analytical results against those results from wamit software and experimental test rmse and the maximum error of accelerations for the above wave conditions are presented in table 4 as this table shows the maximum error of 12 with rmse 0 31 occurred at e i 0 464 nm 2 and β 0 furthermore as fig 14c illustrates this relatively larger error occurred at only one point at ϑ a 0 22 hence we can say that there is good agreement between the analytical model and those of experimental results 4 5 other results of analytical model the non dimensional vertical acceleration w c g ζ 0 for three tori as shown in fig 5 with a 0 019 m a c 0 0253 and e i 0 426 nm 2 for the distance between tori l 0 5 c 1 0 c 1 5 c and 2 0 c at β π and β 0 are presented in figs 18 and 19 respectively in which up middle and down stand for the upstream the middle and the downstream tori as a c neglecting a respect to c l l i j 2 c represents the distance between external faces of two adjacent tori for small wavenumbers ϑ a 0 1 the tori have quasi static motion in waves and do not have significant effect on wavefiled therefore all tori in array encounter the same vertical acceleration as a single torus in waves but for ϑ a 0 1 the upper tori reflect a part of the wave and somehow shielding effect occurs as expected the downstream torus motions are smaller than those for the single torus the first torus located on the upstream and even the second torus which here is the middle one are the special cases because a part of the transmitted wave is reflected again by the downstream floaters and these floaters may encounter to larger wave loads for ϑ a 0 2 the radiation due to torus motions influences the accelerations consequently as ϑ a increases one source of oscillatory behavior of acceleration comes back to this phenomenon the vertical motions of the middle torus at β 0 and π and the downstream torus at β π decrease with increasing the distance between tori but the vertical motion of the downstream torus at β 0 does not have meaningful behavior as l increases l c and l 2 c are the semi rest position of the upstream torus in these locations the torus vertical motions are the same as the single torus in waves and the torus does not encounter by other tori interactions but for l 0 5 c and 1 5 c at ϑ a 0 2 0 25 the vertical motions are larger than those for the single torus see fig 18a c 19a and 19c as an estimate for conventional fish cages and depends on tori distances the peak value of accelerations is up to 35 larger than the acceleration of single torus in waves see figs 18c 19a and 19c the other investigated parameter is the effect of bending stiffness e i on vertical accelerations fig 20 shows the vertical acceleration for a single torus in waves with a 0 019 m a c 0 0253 and e i 0 3 0 45 and 0 6 nm 2 and for nearly rigid torus with e i 23 74 nm 2 and full rigid torus the results illustrate that as e i increases the vertical acceleration is decreased for example as e i doubles from 0 3 to 0 6 nm 2 the vertical acceleration for v a 0 15 0 25 decreased by 35 at downstream part of the floater at β 0 the effect of bending stiffness e i on vertical accelerations of tori array in waves is assessed for a c 0 0253 at l c and e i 0 3 0 45 and 0 6 nm 2 and for nearly rigid torus with e i 23 74 nm 2 and full rigid torus the results are presented in figs 21 and 22 for the upstream and the middle torus respectively it is evident from these figures that as e i increases the vertical accelerations decreased this fact can be explained by referring to eqs 23 and 24 whereas e i increases a n a i decreased subsequently it is expected that also a decrease in total accelerations occur also as e i decreases each floater has larger elastic motions leading to larger radiated waves consequently radiation also influences the tori it should be noted that for three tori the acceleration dependency on e i is smaller than single torus in waves see also fig 20 as an estimation when e i increased by two times from 0 3 nm 2 to 0 6 nm 2 the peak value of accelerations reduced by 10 while as described previously this reduction for single torus is about 35 since the accelerations on the downstream torus in comparison to other tori are relatively small the assessment here is limited to the upstream and the middle tours only see also figs 18 and 19 another parameter considered here is the torus relative dimension a c this parameter was assessed for a c 0 0253 0 0316 0 0395 and 0 0495 at a 0 019 m and e i 0 426 nm 2 two consecutive a c are selected so that the higher value is 25 bigger than the lower value as for different a c the main radius of two corresponding tori is different here for the correct judgment the absolute value of accelerations was divided by g ζ 0 then they are compared with each other the results are shown for the single torus in fig 23 and also for three tori arrangement l c in figs 24 and 25 as these figures illustrate for ϑ a 0 1 in both single torus and array of tori the accelerations are independent of a c and tori with different a c has the same accelerations but after that at constant cross section a torus with larger a c has smaller accelerations as a result for single torus in waves the difference between the maximum value of the acceleration of two consecutive a c is about 8 for three tori however by increasing a c the accelerations are generally decreased nevertheless this decreasing accelerations have many local extrema due to tori interactions the accelerations of the upper torus at β 0 are higher than in other locations therefore these accelerations are considered in more details see fig 24b as seen the difference between accelerations of two consecutive a c is mostly less than 8 it can be concluded that in conventional fish cages at the constant cross section when the dimensional ratio decreased by 25 the peak value of accelerations may increase by 8 however depend on other involving parameters each case should be assessed individually similar to the previous case for e i assessment since the acceleration on the downstream torus is relatively small in comparison to other tori therefore the assessment here is limited to the upstream and the middle torus only 5 conclusion torus with the absence of body ends and axisymmetric geometry is a unique example of a slender floating body in waves in this study a semi analytical model based on slender body theory and matched asymptotic expansions was developed to find the vertical motions of an array of elastic circular floaters in regular waves considering hydro elastic interaction between floaters and using linear wave theory the governing equations on relation between incident diffracted and radiated waves on the floaters were established in fourier modes and the velocity potential was determined in flow domain therefore the wavefield around floaters is also described after determination of the incident waves on each floater the wave induced loads were calculated the developed model was verified by bem based software ansys aqwa and wamit also a series of experimental tests were performed for model validation both comparisons demonstrated that the model has reasonable accuracy based on mathematical formulation and the real physical problem in the light of the most important results of this research the following conclusions can be drawn far away from the structure the diffracted wave from tours can be expressed as a simple function of fourier modes of incident waves for ϑ a 0 1 the floaters do not demonstrate significant interactions however after that as ϑ a increases the floaters acceleration in downstream is smaller than that of single torus in waves for ϑ a 0 15 the first and the second torus in the upstream may encounter larger accelerations in comparison to a single torus in waves the peak value of accelerations for first torus in upstream is larger than the acceleration of single torus in waves up to 35 floaters with larger bending stiffness encounter smaller accelerations as an estimation when e i increases by two times the peak value of accelerations reduces by 10 for three tori in waves while this reduction for single torus is about 35 in floaters of conventional fish cages with constant cross section as a c decreases by 25 the peak value of accelerations increases by 8 unlisted references since 1980 aqwa 2019 credit authorship contribution statement ataollah gharechae conceptualization methodology formal analysis software investigation writing original draft mohammad javad ketabdari conceptualization supervision project administration resources writing review editing daisuke kitazawa investigation supervision resources writing review editing qiao li investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
