index,text
25400,for policy applications the need to improve the resolution of environmental variables is crucial air pollution assessment indeed requires the use of air pollutant concentration fields at a high resolution to better evaluate the exposure of citizens in this paper we propose a fast proxy based downscaling strategy to downscale air quality modelling results using the fraction of the pollutant concentration influenced by precursor emissions in a given cell the approach combines in an additive way i a classically interpolated background pollutant fraction with ii a proxy based concentration derived from the emissions the proxy based pollutant fraction is spread over the high resolution mesh into the surrounding cells with a gaussian approach to account for diffusion effects the evaluation of our approach against observations shows its relevance to create reliable air pollution concentration fields at a higher resolution starting from a coarse resolution modelling results graphical abstract example of high resolution map over madrid image 1 keywords modelling air quality downscaling emissions inventory abbreviations clc corine land cover cnn convolutional neural network ctm chemistry transport model gnfr gridding nomenclature for reporting hr high resolution hrg high resolution grid lr low resolution lrg low resolution grid mos model output statistic mqi model quality indicator pm particulate matter pm10 pm with diameter below 10 µm pm2 5 pm with diameter below 2 5 µm rmse root mean square error data availability the softawre and data are available at https zenodo org record 7407932 1 introduction in its last report of the european environment agency around 25 of the european urban population remains exposed to air quality exceeding the european union air quality standards leading to about 400 000 premature deaths yearly eea 2019 to assess air pollutants exposure identify the sources of pollution and develop strategies to curb air pollution air quality models are essential tools expected to be more and more robust and computationally efficient with time denby et al 2020 jiang et al 2020 mu et al 2022 ramacher et al 2021 sokhi et al 2022 terrenoire et al 2015 in practice a chemistry transport model generally operates up to 1 km resolution sufficient to show the variability of concentrations over large cities in europe or district levels in megacities like in china or india but this resolution is not sufficient for many cities of smaller size another challenge of working at finer scale relates to the availability of fine scale emissions inventories while the downscaling of large scale emissions using proxy e g population road large point sources data approaches as done in the several model pre processing binkowski and roselle 2003 menut et al 2021 ramacher et al 2021 is a solution this remains a first guess estimate modelling outputs statistics mos techniques are common methods to adapt ctm outputs to observations and remove the model bias based on functions of diagnostic variables like meteorological data these methods based on kriging algorithms have been used for air pollution operational forecasting beauchamp et al 2017 2018 malherbe et al 2014 these methods can associate ancillary variables like emissions inventories to better reallocate the concentrations of primary pollutants however applying kriging methods can still take several minutes to hours on a single processor to generate high resolution maps over large regions this method is not adapted to online uses or to personal computers recently denby et al 2020 mu et al 2022 have developed a proxy based downscaling approach for the emep model currently statistical methods using deep learning approach lecun et al 2015 based on convolutional neural network cnn architectures can provide a framework to perform quick high resolution simulations bessagnet et al 2019 2021 dong et al 2014 sorek hamer et al 2022 xing et al 2020 these methods capture the main patterns as a complex model would do while keeping a sufficient accuracy these methods remain however complex to design and improvements are needed to better account for the long range transport of pollutants and chemical processes in this study we present a fast alternative methodology to downscale low resolution lr simulation outputs to higher resolution hr compared to the approach developed for emep as in mu et al 2022 this approach can be used to any model outputs and account for meteorological parameters to better calibrate the gaussian kernel parameters an application and an evaluation of the methodology is provided our application focus on no2 pm2 5 and pm10 concentrations 2 the downscaling methodology 2 1 the method the objective is to downscale the 2d air pollutant concentrations of the ctm output fields to a finer grid with a given longitude and latitude scale ratio this methodology can be applied to any air quality models the principle of our method is described in the following text together with the required assumptions and more detailed in appendix a 1 and a 2 with a glossary of all variables the basis is to define a high resolution grid hrg as a subgrid matching the low resolution grid lrg with a constant scale ratio all over the domain in our case the lrg covers europe at 0 1 0 1 and we use a scale ratio in longitude and latitude of 10 to 1 to get a hrg at 0 01 0 01 resolution we split the pollutant concentration into two main fractions one that results from longer time scale processes and is not impacted by emissions at coarse resolutions and the second that is governed by faster time scale processes and is strongly dependent on local emissions for particulate matter this distinction is coherent with the split between primary and secondary fractions as well as natural sources the detailed description of this split is provided in equation 3 of appendix a the secondary fraction of pollutants shows in general smooth patterns compared to the primary fraction paolella et al 2018 schaap et al 2015 but more rigorously the patterns would depend on the wind speed and the grid cell size there is also a limit for the fine scale resolution where ctms applies parameterisations which not solve the processes at the appropriate resolution this limit depends on the way the ctm parameterize these sub grid processes for instance lin et al 2022 show a large increase of the secondary fraction close to roads due to fast chemical processes using cfd computational fluid dynamic models however to refine the calculation the second fraction related to the primary emission can be split into two fractions since primary species are also affected by regional transport and natural emissions therefore a resulting split into three fractions is considered as i non primary fraction ii long range primary fraction and iii local primary fraction the sequence of the algorithm can be summarized as follows see appendix a 1 and a 2 for mathematical details and particularly fig a1 for a coarse cell pollutant concentration c a percentage γ of the primary fraction which is directly influenced by a primary precursor is rescaled using proxy data representative of each emission activity sector over the hrg and then diffused using a gaussian filtering approach according to a methodology described later the remaining concentration fraction composed of the part of primary dominated by transport and the non primary fraction made of secondary species and including also the natural fraction is interpolated from the lrg to the hrg and added to the primary fraction diffused by the previous gaussian approach each pollutant is associated to a precursor nitrogen oxides nox no no2 for nitrogen dioxides no2 ppm10 for the primary fraction of pm10 and ppm2 5 for the primary fraction of pm2 5 the downscaled proxy based concentrations is proportional to the ratio χ of the fine hrg to the mother coarse mesh lrg emissions of the precursor equation 3 of appendix a1 this step aims at reallocating the load of precursor over the fine emissions grid a minimum value set as the minimum obtained over all coarse interpolated concentrations is fixed to avoid zero values two cases exist to evaluate the proxy based concentrations 1 we have access to a fine grid emission inventory and this ratio χ is directly computed on the basis of the hrg emission inventory the proxy is simply the fine scale emission inventory 2 only the lrg emissions are available and a preliminary downscaling of the emission inventory is required using adequate activity specific proxies if the emission ratio χ requires the use of proxy to downscale the lr emission inventory as it is the case in our application we must first calculate an activity specific proxy defined as the ratio between its hr value and the sum of all values within a mother coarse grid actually any positive number can be assigned to this ratio as it is normalized by the coarse grid sum if the sum is equal to zero we assign a uniform value e g 0 01 if 100 fine grid cells are present in the coarse grid cell this method is fully conservative in the sense that the average of the fine resolution equals the coarse value afterwards a multi gaussian filtering technique see appendix a 2 is applied to diffuse the downscaled concentrations according to the annual mean meteorological conditions for the given cell the vertical diffusion k and the 10 m wind speed u do mostly govern the dispersion in our modelling strategy through the product k u the higher this product is the higher is the dispersion corresponding to high sigma value in the gaussian filters this product ranges from 10 to 150 m3 s 1 on annual average across the domain from overland surfaces close to the alps to coastal and ocean areas in our example presented later it is important to note that the wind direction is not taken into account we consider an isotropic gaussian dispersion the scheme in fig 1 displays the downscaling procedure for a regular coarse grid cell of 0 1 resolution downscaled with a scaling factor of 10 therefore to a fine mesh of 0 01 resolution fig a1 in appendix provides a more detailed visualization in 2d of the downscaling procedure 2 2 required data the proposed method requires first the annual concentrations output fields and associated precursor emissions on a regular grid lrg from a chemistry transport model bessagnet et al 2016 binkowski and roselle 2003 ciarelli et al 2017 menut et al 2021 simpson et al 2012 from the lrg we define a hrg grid using a constant scaling factor to create a hrg that matches exactly the lrg for instance a 0 10 0 10 resolution grid is downscaled to 0 01 0 01 with a scaling factor of 10 in both directions two meteorological variables the wind speed and the vertical diffusion coefficient must also be stored over the lrg grid and interpolated over the hrg grid to calculate the dispersion coefficient σ applied in the gaussian filtering approach second because a fine scale emission inventory is not available in our application we use a hrg proxy database to refine the emissions in our work nine proxies differentiate the main activity sectors based on databases described hereafter table 1 the corine land cover clc for 2018 is one of the datasets produced within the frame of the copernicus land monitoring service referring to land cover land use status clc provides consistent and thematically detailed information on land cover e g industry off road aviation harbours etc and land cover changes across europe at 100 100 m resolution clc 2020 feranec et al 2016 the clc tiff file for 2018 freely available clc 2020 is pre processed with gdal gdal 2022 procedures using an aggregating method based on the median to create ind off avi and har proxies over the hrg indeed to downgrade the proxy that has a higher resolution than 0 01 over the 0 01 grid from the 100 m resolution database we select the value which appears most often of all the sampled points at 100 m resolution in the 0 01 grid the usgs us geophysical survey world land cover database at 30 s arc broxton et al 2014 is used to reallocate agricultural and anthropogenic emissions cro and art the population density at 30 s arc from the gridded population of the word project ciesin 2018 is used to create a population density data pop and a residential emission proxy res based on terrenoire et al 2015 this proxy being a function of the logarithm of the population density the traffic proxy tra is a mix of a road database identifying the major roads complemented by the population density to identify the urban areas as explained in mailler et al 2017 a proxy derived from the clc database can only provide an information over the main european countries therefore for other countries like ukraine russia north african countries the information will be missing and no downscaling will be possible over these zones 3 application of the method our test case aims at creating hr concentration maps for no2 pm10 and pm2 5 from a ctm simulation at lr for the year 2015 the lr domain extends from 15 05 w to 36 95 e longitude and from 30 05 n to 71 45 n latitude grid centres with a horizontal resolution of 0 1 0 1 therefore 521 415 grid cells the final hr grid rigorously covers the same area at 0 01 0 01 resolution therefore 5210 4150 grid cells 3 1 generation of ctm outputs in this study the emep off line regional transport chemistry model version rv 34 simpson et al 2012 is used to analyse the relationship between air pollutant emissions and concentrations over europe the vertical structure has 20 levels with the first located around 50 m the emep model is fed with raw meteorological fields from the european centre for medium range weather forecasting ecmwf ifs for the meteorological year 2015 owens and hewson 2018 the temporal resolution of the meteorological input data is daily with 3 h time step the meteorological fields are retrieved on a 0 1 0 1 longitude latitude coordinate projection vertically the 60 eta levels ifs fields are interpolated onto the 20 emep sigma levels the mars equilibrium module is used to calculate the partitioning between gas and fine mode aerosol phase in the system of inorganics species sulfate nitrate ammonium binkowski and shankar 1995 more information on the gas and aerosol partitioning meteorological driver land cover model physics and chemistry are given in simpson et al 2012 the emep emission dataset mareckova et al 2019 at 0 1 resolution is used with a gnfr gridding nomenclature for reporting level 1 breakdown ceip 2019 emissions vertically redistributed by activity sector according to bieser et al 2011 simpson et al 2012 the simulation grid is a subset of the emep grid perfect coincidence of grid cell centres to avoid undesirable spatial interpolations which could lead to some discrepancies yearly annual concentrations are provided for pm2 5 pm10 and no2 over the lrg of 0 1 0 1 together with the annual emissions totals detailed by gnfr sectors to apply the downscaling methodology we use the association between the gnfr activity sector and proxy as in table 2 only the surface emissions below 184 m according to the vertical distribution developed by bieser et al 2011 classically used in ctm this fraction is reported in table 2 3 2 evaluation of the downscaling method the airbase dataset airbase 2022 is used to evaluate the performance of the downscaling for the annual averages of no2 pm2 5 and pm10 in 2015 the eea s air quality database consists of a multi annual time series of air quality measurement data and calculated statistics for a number of air pollutants for this evaluation background rural peri urban and urban stations are selected the calculated statistics are bias rmse and correlation as well as the mqi model quality indicator jrc 2022 kushta et al 2019 for detailed description of the statistical indicators see appendix b as displayed in table 3 and fig 2 the downscaling method leads to an overall improvement in terms of statistics at the european level for most pollutants looking at individual countries the improvement of error statistics remains low in the supplementary data of appendix c figs s1 s6 the improvement is usually larger in terms of bias which is improved from about 1 to 1 5 μg m 3 for no2 and pm in urban areas however on annual average all statistics improve if we consider all type of stations in general the correlation for no2 in urban areas slightly improved to obtain a better improvement an increase of the spatial resolution of emissions should be accompanied by an improvement of the resolution of meteorology which is in line with findings of other studies baertsch ritter et al 2004 fenech et al 2018 jiang et al 2020 mircea et al 2016 at last it is important to observe that rural concentrations are very slightly influenced since the methodology mainly targets an improvement over urbanized and industrialized areas finally the bias improvement leads to improve the performances on mqi even if the improvement exists it remains low as already been observed by colette et al 2014 at the european scale with a fine scale simulation with a ctm over europe at 2 km the correlation can even be deteriorated if the emission inventory is too inaccurate adding a more detailed top down description of emission variability can also introduce a noisy signal which can deteriorate the realism of a simulation based on physical processes the choice of proxy is probably crucial and can be improved in further developments or other applications figs 3 and 4 show the effect of the downscaling methodology on concentration maps over two regions in europe particularly for no2 cities and roads appear on the hr maps see also fig s7 in supplementary data of appendix c over the north of italy over the seas no gains are obtained because we do not have implemented a proxy at 30 s arc for shipping routes the only difference is due to the interpolation regardless of the pollutant our methodology clearly improves results on urban areas for pm2 5 additional details appear at fine resolution close to lyon in france with small cities appearing in the functional urban area however also shown in fig s8 over the north of italy the impact of downscaling over areas affected by pm high concentrations the improvement is less visible compared to no2 since pm is driven by large scale processes 4 conclusion the proposed proxy based downscaling approach leads to increasing the pollutant fraction that is directly related to the local emissions its application leads to improved concentration maps where details appear clearly in vicinity of the sources close to cities industries and major roads this improvement could be used for instance to better assess population exposure to air pollution when a hr emission inventory is available the downscaling proxy is straightforwardly the hr emission dataset which can be aggregated at lr resolution to simulate air pollutant concentrations unfortunately this case is not the most frequent implying to downscale the lr emissions with a proxy based approach e g land use and other ancillary data note that this approach can lead to some inconsistencies if proxies are not coherent with the lr emission inventory sectors our application belong to the second case it highlights the added value of the downscaling in better estimating concentration fields one of the main limitations come from the secondary fractions which are interpolated at coarse grid level the assumption being that the formation of these species is governed by slow processes larger time scales than those related to the transport from one coarse grid cell to another therefore the current downscaling procedure might be less effective for very coarse grid cells on the other hand the proxy based downscaling procedure relies on the assumption that the pollutant concentration of interest mostly depends on local precursor emissions so that a direct relation must exist between the pollutant and its emitted precursor this assumption also depends on the chosen resolution and would not work well if a too fine resolution is selected the quality of the downscaling depends on the quality of the full modelling systems so that e g if a lr simulation overestimates urban concentrations the resulting downscaled will increase this overestimation but still improving the spatial correlation if the resulting hr emission inventory is of good quality the methodology has been evaluated for all background rural urban and peri urban stations for no2 pm10 and pm2 5 in europe the bias improves in most parts of europe the spatial correlation is not affected although for no2 the hr spatial correlation is lower the code runs fast and takes about 30 s for one pollutant to downscale a lr simulation field on a standard machine under a linux os intel r xeon r platinum 8168 cpu 2 70 ghz for a given pollutant a 90 mbytes netcdf file is produced in our case a by product of our methodology is to provide a hr emission inventory detailed by activity sectors based on proxies as a perspective of this work this post processing modelling methodology will also be evaluated with a direct simulation at 0 01 resolution with the same modelling emep set up at 0 1 to evaluate the capacity of this method to mimic a hr model simulation with all chemistry and physics processes on board also the implementation of the mean wind direction to create a fast python module to create an asymmetric gaussian kernel will be investigated to account for a more realistic spatial pattern of primary pollutants dispersion credit author statement bertrand bessagnet conceptualization data curation formal analysis investigation methodology software visualization roles writing original draft writing review editing enrico pisoni project administration conceptualization investigation software review editing philippe thunis project administration conceptualization investigation review editing laurent létinois software review editing alexander de meij data curation review editing software and data availability the main dataset and software are available the scripts which create the proxy file in netcdf are available on request name of the software downscaler developers bertrand bessagnet enrico pisoni alexander de meij laurent létinois philippe thunis contact information bertrand bessagnet ec europa eu year first available 2022 program language python and shell cost free software availability https zenodo org record 7407932 program size 186 mb funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a a 1 detailed description of the algorithms here below a definition of each variable is provided capital letters for indices and variables refer to the lrg low resolution grid while lower cases are reserved to the hrg high resolution grid i j grid cell coordinates of the lrg i for longitude j for latitude n x n y number of longitude and latitude indexes of the lrg grid respectively i j grid cell coordinates of the hrg i for longitude j for latitude n x n y number of longitude and latitude indexes of the hrg grid respectively nsx scaling factor on longitude integer for downscaling nsy scaling factor on latitude integer for downscaling c pollutant concentration over the lrg from the lr simulation c pollutant concentration over the hrg e pollutant precursor emission over the lrg ton per grid cell e pollutant precursor emission over the hrg ton per grid cell f fraction of ground surface emission p s indices for primary and non primary fractions secondary and natural of the pollutant concentration respectively r index for the corresponding precursor emission x virtual primary concentration in a coarse grid influenced for the correspondent emission of the cell evaluate by a box model ω index for activity sectors φ associated proxy to the activity sector θ value of 1 to count fine grid cells in a coarse grid cell γ contribution fraction between 0 and 1 of the primary fraction due to the cell emission itself σ sigma parameter in grid index unit of the gaussian filter σ b correspond to a class bin b χ ratio of the fine to the mother coarse mesh emissions of the precursor the primary concentration with star exponent represents its value based on the downscaling with the proxy based approach the accentuation sign is the result of a classic interpolation for a given concentration on the hrg it corresponds here to a simple linear interpolation from the closest lrg concentration selecting the four lrg grid points surrounding the hrg grid cell centre the main algorithm is presented in equations 1 4 the entire concentration c is decomposed in its primary and non primary secondary fraction naturals sources for pm for no2 we assume that the non primary fraction does not exist however natural and agricultural no emissions exists but cannot be isolated in our calculations this assumption could lead to overestimate the urban concentration of no2 in urban areas first we estimate the fraction γ as detailed in equations 1 and 2 as the fraction of primary fraction influenced by the given coarse cell out of the total primary concentration accounting for the influence of the regional transport from neighbouring cells according to bessagnet et al 2019 for a given cell i j the concentration x of a primary fraction due only to its local precursor emission e at the cell is estimated on a yearly average under neutral conditions as 1 x δ x δ y 8 k u e e emission flux of the precursor pollutant μg m 2 s 1 k vertical eddy diffusion coefficient of the given cell m2 s 1 u wind speed of the given cell m s 1 δ x x axis dimension of the cell m δ y y axis dimension of the cell m each pollutant is associated to a precursor pollutant r linked to the primary pollutant p nox for no2 ppm10 for the primary fraction of pm10 and ppm2 5 for the primary fraction of pm2 5 for no2 an implicit assumption is that nox emission is mostly converted in no2 concentrations for our scales using equation 1 in other words given a primary precursor emissions we try to evaluate what should be the concentrations resulting from the emission in the cell due to only this emission at the cell thanks to a box model without chemistry this virtual concentration x is used to calculate the fraction of the primary fraction which come from outside the cell it comes to calculate γ over the coarse grid 2 γ i j δ x δ y 8 k u e i j c i j γ is uniform over the coarse grid and is applied later in the algorithm for all fine cells i j belonging to a coarse grid cell i j second the concentration c at fine scale is computed as the sum of i the fraction γ from equation 2 of the primary component of c downscaled over the hrg ii the non primary fraction as well as the remaining fraction 1 γ of the primary component simply interpolated from the lrg to the hrg the downscaled value of the primary fraction is afterwards diffused using a gaussian filtering approach according a methodology described later the downscaled proxy based concentrations with proxy c i j p is proportional to the interpolated coarse concentrations ratio χ i j p r which is the fraction of fine cell emission of the corresponding coarse cell emission a minimum value is set to the minimum value of all coarse concentrations interpolated over the entire domain to avoid values equal to zero a multi gaussian filtering technique f i l t e r σ see details in the following appendix a 2 is applied to diffuse the downscaled concentrations according to the annual mean meteorological conditions for the given cell two cases are identified a we have access to a fine grid emission inventory and this ratio is directly computed on the basis of the hrg emission inventory b only the emissions are available on the lrg and a preliminary downscaling of the emission inventory is required using adequate activity specific proxies φ associated to each given activity sector ω this emission ratio is then multiplied by the total number of fine cells within a mother coarse grid cell i j i j θ equation 3 3 c i j c i j p c i j s c i j s i n t e r p c i j s c i j p i n t e r p c i j p l i n e a r i n t e r p o l a t i o n f r o m l r g t o h r g c i j c i j p p r i m a r y 1 γ i j i j i j c i j p r e m a i n i n g p r i m a r y c i j s n o n p r i m a r y c i j p f i l t e r σ c i j p w i t h c i j p max γ i j i j i j c i j p χ i j p r i j i j θ min 1 i n x 1 j n y c i j p a n d θ 1 χ i j p r ω e i j ω r i j i j ω e i j ω r if the emission ratio χ i j p r requires the use of proxy to downscale the lr emission inventory case b discussed before as it is the case in our application we must first calculate an activity specific proxy defined as the ratio between its hr value and the sum of all values within a mother coarse grid cell as detailed in eq 4 actually any real positive number can be assigned to this ratio δ i j ω φ because in fine y i j ω φ is normalized by the coarse grid sum over the coarse grid i j i j δ i j ω φ if the sum i j i j δ i j ω φ is equal to zero we assign a uniform value to y i j ω φ e g 0 01 if 100 fine grid cells are present in the coarse grid cell 4 i f e i j ω r d o e s n o t e x i s t i j i j e i j ω r y i j ω φ e i j ω r f ω i f i j i j δ i j ω φ 0 y i j ω φ δ i j ω φ i j i j δ i j ω φ i f i j i j δ i j ω φ 0 y i j ω φ θ i j i j θ w i t h θ 1 ω i j i j y i j ω φ 1 the emission e i j ω r for each grid cell by activity sector ω is actually the ground fraction f ω below 184 m table 2 according to the vertical distribution used in the emep model the scheme in fig a1 visualizes the downscaling procedure for a regular coarse grid mesh of 0 1 resolution with scaling factors of 10 both in latitude and longitude this part of the code is written in python van rossum and drake 2009 the use of a regular hrg which perfectly matches the lrg with uniform scaling factors allows a very fast computing thanks to the numpy and scipy libraries harris et al 2020 virtanen et al 2020 fig a 1 visual description of the downscaling methodology applied to grid resolutions corresponding to our application example the hatched cell is the grid of interest in this example the bilinear interpolation at this point requires the coarse grid cell concentrations c i j c i 1 j c i 1 j 1 and c i j 1 here we consider nsx nsy 10 10 for the example fig a 1 a 2 the gaussian filtering technique f i l t e r σ to account for atmospheric dispersion processes between high resolution grid cells and obtain a more realistic field of primary concentrations c we use here a gaussian dispersion equation and apply it using the scipy python library which offers the possibility to smooth a 2d array using a gaussian approach this type of filtering is appropriate since gaussian equations correspond to analytical solutions of the dispersion in air pollution modelling a 2d gaussian filter g for a given σ grid index unit is defined as 5 c i j k 1 n x l 1 n y c k l g k l σ i k j l g k l σ i k j l 1 2 π σ k l 2 e i k 2 j l 2 2 σ k l 2 i k w i k w j l w j l w g k l σ i k j l 1 i k and j l are the new coordinate system on both axes from cell k l of the hrg grid corresponding to the new origin i k 0 j l 0 σ depends on dispersion conditions and has to be evaluated first for each grid cell w is the size of the footprint with the width 2 w 1 of the regular squared windows centered over the cell k l where the central cell is diffused in 2d this windows width is defined by the python procedure using a specific input parameter and a dependency with σ the computation is then optimized to avoid useless calculations over the full grid since g quickly tends to 0 when i k 2 j l 2 2 σ k l 2 becomes very large an increase of σ implies an increase of the computation time actually the resulting diffused concentration by the gaussian filter at cell i j is c as 6 c 1 2 π σ 2 c then by using equations 1 and 6 which provides in a stationary regime the concentration produced by the cell emission σ 2 is estimated for a fine grid cell as 7 σ 2 1 2 π 8 k u δ x δ y c e in practice to save computing time and benefit from existing compact libraries we simplify the use of a gaussian filtering by using only 20 classes b of sigma σ b discrete scale of σ with a step of 0 5 defined by the list in equation 7 to apply the gaussian filtering approach the step and the number of classes can be changed but these values provide a satisfactory results in our case after several tests 8 i f σ 0 5 σ b 0 i f 0 5 σ 1 σ b 0 5 i f 1 σ 1 5 σ b 1 i f σ 10 σ b 10 the filtering technique of scipy called scipy ndimage gaussian filter virtanen et al 2020 is then applied for the hrg by class of σ called σ b as previously defined and the final concentrations is the sum over all classes b as 9 f i l t e r σ c i j p b k 1 n x l 1 n y c k l p g k l σ b i k j l this approach is therefore fully additive appendix b error statistics used to evaluate model performance m and o refer respectively with model and observations data and n is the number of observations u 95 is the 95th percentile measurement uncertainty of the observed concentration level and β is the coefficient that scales the proportionality of the bias to the measurement uncertainty kushta et al 2019 bias b i a s m o with m 1 n i 1 n m i and o 1 n i 1 n o i root mean square error r m s e 1 n i 1 n m i o i 2 correlation coefficient r i 1 n m i m o i o i 1 n m i m 2 i 1 n o i o 2 model quality index m q i i m i o i β u 95 o i w i t h β 2 appendix c supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix c supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105692 
25400,for policy applications the need to improve the resolution of environmental variables is crucial air pollution assessment indeed requires the use of air pollutant concentration fields at a high resolution to better evaluate the exposure of citizens in this paper we propose a fast proxy based downscaling strategy to downscale air quality modelling results using the fraction of the pollutant concentration influenced by precursor emissions in a given cell the approach combines in an additive way i a classically interpolated background pollutant fraction with ii a proxy based concentration derived from the emissions the proxy based pollutant fraction is spread over the high resolution mesh into the surrounding cells with a gaussian approach to account for diffusion effects the evaluation of our approach against observations shows its relevance to create reliable air pollution concentration fields at a higher resolution starting from a coarse resolution modelling results graphical abstract example of high resolution map over madrid image 1 keywords modelling air quality downscaling emissions inventory abbreviations clc corine land cover cnn convolutional neural network ctm chemistry transport model gnfr gridding nomenclature for reporting hr high resolution hrg high resolution grid lr low resolution lrg low resolution grid mos model output statistic mqi model quality indicator pm particulate matter pm10 pm with diameter below 10 µm pm2 5 pm with diameter below 2 5 µm rmse root mean square error data availability the softawre and data are available at https zenodo org record 7407932 1 introduction in its last report of the european environment agency around 25 of the european urban population remains exposed to air quality exceeding the european union air quality standards leading to about 400 000 premature deaths yearly eea 2019 to assess air pollutants exposure identify the sources of pollution and develop strategies to curb air pollution air quality models are essential tools expected to be more and more robust and computationally efficient with time denby et al 2020 jiang et al 2020 mu et al 2022 ramacher et al 2021 sokhi et al 2022 terrenoire et al 2015 in practice a chemistry transport model generally operates up to 1 km resolution sufficient to show the variability of concentrations over large cities in europe or district levels in megacities like in china or india but this resolution is not sufficient for many cities of smaller size another challenge of working at finer scale relates to the availability of fine scale emissions inventories while the downscaling of large scale emissions using proxy e g population road large point sources data approaches as done in the several model pre processing binkowski and roselle 2003 menut et al 2021 ramacher et al 2021 is a solution this remains a first guess estimate modelling outputs statistics mos techniques are common methods to adapt ctm outputs to observations and remove the model bias based on functions of diagnostic variables like meteorological data these methods based on kriging algorithms have been used for air pollution operational forecasting beauchamp et al 2017 2018 malherbe et al 2014 these methods can associate ancillary variables like emissions inventories to better reallocate the concentrations of primary pollutants however applying kriging methods can still take several minutes to hours on a single processor to generate high resolution maps over large regions this method is not adapted to online uses or to personal computers recently denby et al 2020 mu et al 2022 have developed a proxy based downscaling approach for the emep model currently statistical methods using deep learning approach lecun et al 2015 based on convolutional neural network cnn architectures can provide a framework to perform quick high resolution simulations bessagnet et al 2019 2021 dong et al 2014 sorek hamer et al 2022 xing et al 2020 these methods capture the main patterns as a complex model would do while keeping a sufficient accuracy these methods remain however complex to design and improvements are needed to better account for the long range transport of pollutants and chemical processes in this study we present a fast alternative methodology to downscale low resolution lr simulation outputs to higher resolution hr compared to the approach developed for emep as in mu et al 2022 this approach can be used to any model outputs and account for meteorological parameters to better calibrate the gaussian kernel parameters an application and an evaluation of the methodology is provided our application focus on no2 pm2 5 and pm10 concentrations 2 the downscaling methodology 2 1 the method the objective is to downscale the 2d air pollutant concentrations of the ctm output fields to a finer grid with a given longitude and latitude scale ratio this methodology can be applied to any air quality models the principle of our method is described in the following text together with the required assumptions and more detailed in appendix a 1 and a 2 with a glossary of all variables the basis is to define a high resolution grid hrg as a subgrid matching the low resolution grid lrg with a constant scale ratio all over the domain in our case the lrg covers europe at 0 1 0 1 and we use a scale ratio in longitude and latitude of 10 to 1 to get a hrg at 0 01 0 01 resolution we split the pollutant concentration into two main fractions one that results from longer time scale processes and is not impacted by emissions at coarse resolutions and the second that is governed by faster time scale processes and is strongly dependent on local emissions for particulate matter this distinction is coherent with the split between primary and secondary fractions as well as natural sources the detailed description of this split is provided in equation 3 of appendix a the secondary fraction of pollutants shows in general smooth patterns compared to the primary fraction paolella et al 2018 schaap et al 2015 but more rigorously the patterns would depend on the wind speed and the grid cell size there is also a limit for the fine scale resolution where ctms applies parameterisations which not solve the processes at the appropriate resolution this limit depends on the way the ctm parameterize these sub grid processes for instance lin et al 2022 show a large increase of the secondary fraction close to roads due to fast chemical processes using cfd computational fluid dynamic models however to refine the calculation the second fraction related to the primary emission can be split into two fractions since primary species are also affected by regional transport and natural emissions therefore a resulting split into three fractions is considered as i non primary fraction ii long range primary fraction and iii local primary fraction the sequence of the algorithm can be summarized as follows see appendix a 1 and a 2 for mathematical details and particularly fig a1 for a coarse cell pollutant concentration c a percentage γ of the primary fraction which is directly influenced by a primary precursor is rescaled using proxy data representative of each emission activity sector over the hrg and then diffused using a gaussian filtering approach according to a methodology described later the remaining concentration fraction composed of the part of primary dominated by transport and the non primary fraction made of secondary species and including also the natural fraction is interpolated from the lrg to the hrg and added to the primary fraction diffused by the previous gaussian approach each pollutant is associated to a precursor nitrogen oxides nox no no2 for nitrogen dioxides no2 ppm10 for the primary fraction of pm10 and ppm2 5 for the primary fraction of pm2 5 the downscaled proxy based concentrations is proportional to the ratio χ of the fine hrg to the mother coarse mesh lrg emissions of the precursor equation 3 of appendix a1 this step aims at reallocating the load of precursor over the fine emissions grid a minimum value set as the minimum obtained over all coarse interpolated concentrations is fixed to avoid zero values two cases exist to evaluate the proxy based concentrations 1 we have access to a fine grid emission inventory and this ratio χ is directly computed on the basis of the hrg emission inventory the proxy is simply the fine scale emission inventory 2 only the lrg emissions are available and a preliminary downscaling of the emission inventory is required using adequate activity specific proxies if the emission ratio χ requires the use of proxy to downscale the lr emission inventory as it is the case in our application we must first calculate an activity specific proxy defined as the ratio between its hr value and the sum of all values within a mother coarse grid actually any positive number can be assigned to this ratio as it is normalized by the coarse grid sum if the sum is equal to zero we assign a uniform value e g 0 01 if 100 fine grid cells are present in the coarse grid cell this method is fully conservative in the sense that the average of the fine resolution equals the coarse value afterwards a multi gaussian filtering technique see appendix a 2 is applied to diffuse the downscaled concentrations according to the annual mean meteorological conditions for the given cell the vertical diffusion k and the 10 m wind speed u do mostly govern the dispersion in our modelling strategy through the product k u the higher this product is the higher is the dispersion corresponding to high sigma value in the gaussian filters this product ranges from 10 to 150 m3 s 1 on annual average across the domain from overland surfaces close to the alps to coastal and ocean areas in our example presented later it is important to note that the wind direction is not taken into account we consider an isotropic gaussian dispersion the scheme in fig 1 displays the downscaling procedure for a regular coarse grid cell of 0 1 resolution downscaled with a scaling factor of 10 therefore to a fine mesh of 0 01 resolution fig a1 in appendix provides a more detailed visualization in 2d of the downscaling procedure 2 2 required data the proposed method requires first the annual concentrations output fields and associated precursor emissions on a regular grid lrg from a chemistry transport model bessagnet et al 2016 binkowski and roselle 2003 ciarelli et al 2017 menut et al 2021 simpson et al 2012 from the lrg we define a hrg grid using a constant scaling factor to create a hrg that matches exactly the lrg for instance a 0 10 0 10 resolution grid is downscaled to 0 01 0 01 with a scaling factor of 10 in both directions two meteorological variables the wind speed and the vertical diffusion coefficient must also be stored over the lrg grid and interpolated over the hrg grid to calculate the dispersion coefficient σ applied in the gaussian filtering approach second because a fine scale emission inventory is not available in our application we use a hrg proxy database to refine the emissions in our work nine proxies differentiate the main activity sectors based on databases described hereafter table 1 the corine land cover clc for 2018 is one of the datasets produced within the frame of the copernicus land monitoring service referring to land cover land use status clc provides consistent and thematically detailed information on land cover e g industry off road aviation harbours etc and land cover changes across europe at 100 100 m resolution clc 2020 feranec et al 2016 the clc tiff file for 2018 freely available clc 2020 is pre processed with gdal gdal 2022 procedures using an aggregating method based on the median to create ind off avi and har proxies over the hrg indeed to downgrade the proxy that has a higher resolution than 0 01 over the 0 01 grid from the 100 m resolution database we select the value which appears most often of all the sampled points at 100 m resolution in the 0 01 grid the usgs us geophysical survey world land cover database at 30 s arc broxton et al 2014 is used to reallocate agricultural and anthropogenic emissions cro and art the population density at 30 s arc from the gridded population of the word project ciesin 2018 is used to create a population density data pop and a residential emission proxy res based on terrenoire et al 2015 this proxy being a function of the logarithm of the population density the traffic proxy tra is a mix of a road database identifying the major roads complemented by the population density to identify the urban areas as explained in mailler et al 2017 a proxy derived from the clc database can only provide an information over the main european countries therefore for other countries like ukraine russia north african countries the information will be missing and no downscaling will be possible over these zones 3 application of the method our test case aims at creating hr concentration maps for no2 pm10 and pm2 5 from a ctm simulation at lr for the year 2015 the lr domain extends from 15 05 w to 36 95 e longitude and from 30 05 n to 71 45 n latitude grid centres with a horizontal resolution of 0 1 0 1 therefore 521 415 grid cells the final hr grid rigorously covers the same area at 0 01 0 01 resolution therefore 5210 4150 grid cells 3 1 generation of ctm outputs in this study the emep off line regional transport chemistry model version rv 34 simpson et al 2012 is used to analyse the relationship between air pollutant emissions and concentrations over europe the vertical structure has 20 levels with the first located around 50 m the emep model is fed with raw meteorological fields from the european centre for medium range weather forecasting ecmwf ifs for the meteorological year 2015 owens and hewson 2018 the temporal resolution of the meteorological input data is daily with 3 h time step the meteorological fields are retrieved on a 0 1 0 1 longitude latitude coordinate projection vertically the 60 eta levels ifs fields are interpolated onto the 20 emep sigma levels the mars equilibrium module is used to calculate the partitioning between gas and fine mode aerosol phase in the system of inorganics species sulfate nitrate ammonium binkowski and shankar 1995 more information on the gas and aerosol partitioning meteorological driver land cover model physics and chemistry are given in simpson et al 2012 the emep emission dataset mareckova et al 2019 at 0 1 resolution is used with a gnfr gridding nomenclature for reporting level 1 breakdown ceip 2019 emissions vertically redistributed by activity sector according to bieser et al 2011 simpson et al 2012 the simulation grid is a subset of the emep grid perfect coincidence of grid cell centres to avoid undesirable spatial interpolations which could lead to some discrepancies yearly annual concentrations are provided for pm2 5 pm10 and no2 over the lrg of 0 1 0 1 together with the annual emissions totals detailed by gnfr sectors to apply the downscaling methodology we use the association between the gnfr activity sector and proxy as in table 2 only the surface emissions below 184 m according to the vertical distribution developed by bieser et al 2011 classically used in ctm this fraction is reported in table 2 3 2 evaluation of the downscaling method the airbase dataset airbase 2022 is used to evaluate the performance of the downscaling for the annual averages of no2 pm2 5 and pm10 in 2015 the eea s air quality database consists of a multi annual time series of air quality measurement data and calculated statistics for a number of air pollutants for this evaluation background rural peri urban and urban stations are selected the calculated statistics are bias rmse and correlation as well as the mqi model quality indicator jrc 2022 kushta et al 2019 for detailed description of the statistical indicators see appendix b as displayed in table 3 and fig 2 the downscaling method leads to an overall improvement in terms of statistics at the european level for most pollutants looking at individual countries the improvement of error statistics remains low in the supplementary data of appendix c figs s1 s6 the improvement is usually larger in terms of bias which is improved from about 1 to 1 5 μg m 3 for no2 and pm in urban areas however on annual average all statistics improve if we consider all type of stations in general the correlation for no2 in urban areas slightly improved to obtain a better improvement an increase of the spatial resolution of emissions should be accompanied by an improvement of the resolution of meteorology which is in line with findings of other studies baertsch ritter et al 2004 fenech et al 2018 jiang et al 2020 mircea et al 2016 at last it is important to observe that rural concentrations are very slightly influenced since the methodology mainly targets an improvement over urbanized and industrialized areas finally the bias improvement leads to improve the performances on mqi even if the improvement exists it remains low as already been observed by colette et al 2014 at the european scale with a fine scale simulation with a ctm over europe at 2 km the correlation can even be deteriorated if the emission inventory is too inaccurate adding a more detailed top down description of emission variability can also introduce a noisy signal which can deteriorate the realism of a simulation based on physical processes the choice of proxy is probably crucial and can be improved in further developments or other applications figs 3 and 4 show the effect of the downscaling methodology on concentration maps over two regions in europe particularly for no2 cities and roads appear on the hr maps see also fig s7 in supplementary data of appendix c over the north of italy over the seas no gains are obtained because we do not have implemented a proxy at 30 s arc for shipping routes the only difference is due to the interpolation regardless of the pollutant our methodology clearly improves results on urban areas for pm2 5 additional details appear at fine resolution close to lyon in france with small cities appearing in the functional urban area however also shown in fig s8 over the north of italy the impact of downscaling over areas affected by pm high concentrations the improvement is less visible compared to no2 since pm is driven by large scale processes 4 conclusion the proposed proxy based downscaling approach leads to increasing the pollutant fraction that is directly related to the local emissions its application leads to improved concentration maps where details appear clearly in vicinity of the sources close to cities industries and major roads this improvement could be used for instance to better assess population exposure to air pollution when a hr emission inventory is available the downscaling proxy is straightforwardly the hr emission dataset which can be aggregated at lr resolution to simulate air pollutant concentrations unfortunately this case is not the most frequent implying to downscale the lr emissions with a proxy based approach e g land use and other ancillary data note that this approach can lead to some inconsistencies if proxies are not coherent with the lr emission inventory sectors our application belong to the second case it highlights the added value of the downscaling in better estimating concentration fields one of the main limitations come from the secondary fractions which are interpolated at coarse grid level the assumption being that the formation of these species is governed by slow processes larger time scales than those related to the transport from one coarse grid cell to another therefore the current downscaling procedure might be less effective for very coarse grid cells on the other hand the proxy based downscaling procedure relies on the assumption that the pollutant concentration of interest mostly depends on local precursor emissions so that a direct relation must exist between the pollutant and its emitted precursor this assumption also depends on the chosen resolution and would not work well if a too fine resolution is selected the quality of the downscaling depends on the quality of the full modelling systems so that e g if a lr simulation overestimates urban concentrations the resulting downscaled will increase this overestimation but still improving the spatial correlation if the resulting hr emission inventory is of good quality the methodology has been evaluated for all background rural urban and peri urban stations for no2 pm10 and pm2 5 in europe the bias improves in most parts of europe the spatial correlation is not affected although for no2 the hr spatial correlation is lower the code runs fast and takes about 30 s for one pollutant to downscale a lr simulation field on a standard machine under a linux os intel r xeon r platinum 8168 cpu 2 70 ghz for a given pollutant a 90 mbytes netcdf file is produced in our case a by product of our methodology is to provide a hr emission inventory detailed by activity sectors based on proxies as a perspective of this work this post processing modelling methodology will also be evaluated with a direct simulation at 0 01 resolution with the same modelling emep set up at 0 1 to evaluate the capacity of this method to mimic a hr model simulation with all chemistry and physics processes on board also the implementation of the mean wind direction to create a fast python module to create an asymmetric gaussian kernel will be investigated to account for a more realistic spatial pattern of primary pollutants dispersion credit author statement bertrand bessagnet conceptualization data curation formal analysis investigation methodology software visualization roles writing original draft writing review editing enrico pisoni project administration conceptualization investigation software review editing philippe thunis project administration conceptualization investigation review editing laurent létinois software review editing alexander de meij data curation review editing software and data availability the main dataset and software are available the scripts which create the proxy file in netcdf are available on request name of the software downscaler developers bertrand bessagnet enrico pisoni alexander de meij laurent létinois philippe thunis contact information bertrand bessagnet ec europa eu year first available 2022 program language python and shell cost free software availability https zenodo org record 7407932 program size 186 mb funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a a 1 detailed description of the algorithms here below a definition of each variable is provided capital letters for indices and variables refer to the lrg low resolution grid while lower cases are reserved to the hrg high resolution grid i j grid cell coordinates of the lrg i for longitude j for latitude n x n y number of longitude and latitude indexes of the lrg grid respectively i j grid cell coordinates of the hrg i for longitude j for latitude n x n y number of longitude and latitude indexes of the hrg grid respectively nsx scaling factor on longitude integer for downscaling nsy scaling factor on latitude integer for downscaling c pollutant concentration over the lrg from the lr simulation c pollutant concentration over the hrg e pollutant precursor emission over the lrg ton per grid cell e pollutant precursor emission over the hrg ton per grid cell f fraction of ground surface emission p s indices for primary and non primary fractions secondary and natural of the pollutant concentration respectively r index for the corresponding precursor emission x virtual primary concentration in a coarse grid influenced for the correspondent emission of the cell evaluate by a box model ω index for activity sectors φ associated proxy to the activity sector θ value of 1 to count fine grid cells in a coarse grid cell γ contribution fraction between 0 and 1 of the primary fraction due to the cell emission itself σ sigma parameter in grid index unit of the gaussian filter σ b correspond to a class bin b χ ratio of the fine to the mother coarse mesh emissions of the precursor the primary concentration with star exponent represents its value based on the downscaling with the proxy based approach the accentuation sign is the result of a classic interpolation for a given concentration on the hrg it corresponds here to a simple linear interpolation from the closest lrg concentration selecting the four lrg grid points surrounding the hrg grid cell centre the main algorithm is presented in equations 1 4 the entire concentration c is decomposed in its primary and non primary secondary fraction naturals sources for pm for no2 we assume that the non primary fraction does not exist however natural and agricultural no emissions exists but cannot be isolated in our calculations this assumption could lead to overestimate the urban concentration of no2 in urban areas first we estimate the fraction γ as detailed in equations 1 and 2 as the fraction of primary fraction influenced by the given coarse cell out of the total primary concentration accounting for the influence of the regional transport from neighbouring cells according to bessagnet et al 2019 for a given cell i j the concentration x of a primary fraction due only to its local precursor emission e at the cell is estimated on a yearly average under neutral conditions as 1 x δ x δ y 8 k u e e emission flux of the precursor pollutant μg m 2 s 1 k vertical eddy diffusion coefficient of the given cell m2 s 1 u wind speed of the given cell m s 1 δ x x axis dimension of the cell m δ y y axis dimension of the cell m each pollutant is associated to a precursor pollutant r linked to the primary pollutant p nox for no2 ppm10 for the primary fraction of pm10 and ppm2 5 for the primary fraction of pm2 5 for no2 an implicit assumption is that nox emission is mostly converted in no2 concentrations for our scales using equation 1 in other words given a primary precursor emissions we try to evaluate what should be the concentrations resulting from the emission in the cell due to only this emission at the cell thanks to a box model without chemistry this virtual concentration x is used to calculate the fraction of the primary fraction which come from outside the cell it comes to calculate γ over the coarse grid 2 γ i j δ x δ y 8 k u e i j c i j γ is uniform over the coarse grid and is applied later in the algorithm for all fine cells i j belonging to a coarse grid cell i j second the concentration c at fine scale is computed as the sum of i the fraction γ from equation 2 of the primary component of c downscaled over the hrg ii the non primary fraction as well as the remaining fraction 1 γ of the primary component simply interpolated from the lrg to the hrg the downscaled value of the primary fraction is afterwards diffused using a gaussian filtering approach according a methodology described later the downscaled proxy based concentrations with proxy c i j p is proportional to the interpolated coarse concentrations ratio χ i j p r which is the fraction of fine cell emission of the corresponding coarse cell emission a minimum value is set to the minimum value of all coarse concentrations interpolated over the entire domain to avoid values equal to zero a multi gaussian filtering technique f i l t e r σ see details in the following appendix a 2 is applied to diffuse the downscaled concentrations according to the annual mean meteorological conditions for the given cell two cases are identified a we have access to a fine grid emission inventory and this ratio is directly computed on the basis of the hrg emission inventory b only the emissions are available on the lrg and a preliminary downscaling of the emission inventory is required using adequate activity specific proxies φ associated to each given activity sector ω this emission ratio is then multiplied by the total number of fine cells within a mother coarse grid cell i j i j θ equation 3 3 c i j c i j p c i j s c i j s i n t e r p c i j s c i j p i n t e r p c i j p l i n e a r i n t e r p o l a t i o n f r o m l r g t o h r g c i j c i j p p r i m a r y 1 γ i j i j i j c i j p r e m a i n i n g p r i m a r y c i j s n o n p r i m a r y c i j p f i l t e r σ c i j p w i t h c i j p max γ i j i j i j c i j p χ i j p r i j i j θ min 1 i n x 1 j n y c i j p a n d θ 1 χ i j p r ω e i j ω r i j i j ω e i j ω r if the emission ratio χ i j p r requires the use of proxy to downscale the lr emission inventory case b discussed before as it is the case in our application we must first calculate an activity specific proxy defined as the ratio between its hr value and the sum of all values within a mother coarse grid cell as detailed in eq 4 actually any real positive number can be assigned to this ratio δ i j ω φ because in fine y i j ω φ is normalized by the coarse grid sum over the coarse grid i j i j δ i j ω φ if the sum i j i j δ i j ω φ is equal to zero we assign a uniform value to y i j ω φ e g 0 01 if 100 fine grid cells are present in the coarse grid cell 4 i f e i j ω r d o e s n o t e x i s t i j i j e i j ω r y i j ω φ e i j ω r f ω i f i j i j δ i j ω φ 0 y i j ω φ δ i j ω φ i j i j δ i j ω φ i f i j i j δ i j ω φ 0 y i j ω φ θ i j i j θ w i t h θ 1 ω i j i j y i j ω φ 1 the emission e i j ω r for each grid cell by activity sector ω is actually the ground fraction f ω below 184 m table 2 according to the vertical distribution used in the emep model the scheme in fig a1 visualizes the downscaling procedure for a regular coarse grid mesh of 0 1 resolution with scaling factors of 10 both in latitude and longitude this part of the code is written in python van rossum and drake 2009 the use of a regular hrg which perfectly matches the lrg with uniform scaling factors allows a very fast computing thanks to the numpy and scipy libraries harris et al 2020 virtanen et al 2020 fig a 1 visual description of the downscaling methodology applied to grid resolutions corresponding to our application example the hatched cell is the grid of interest in this example the bilinear interpolation at this point requires the coarse grid cell concentrations c i j c i 1 j c i 1 j 1 and c i j 1 here we consider nsx nsy 10 10 for the example fig a 1 a 2 the gaussian filtering technique f i l t e r σ to account for atmospheric dispersion processes between high resolution grid cells and obtain a more realistic field of primary concentrations c we use here a gaussian dispersion equation and apply it using the scipy python library which offers the possibility to smooth a 2d array using a gaussian approach this type of filtering is appropriate since gaussian equations correspond to analytical solutions of the dispersion in air pollution modelling a 2d gaussian filter g for a given σ grid index unit is defined as 5 c i j k 1 n x l 1 n y c k l g k l σ i k j l g k l σ i k j l 1 2 π σ k l 2 e i k 2 j l 2 2 σ k l 2 i k w i k w j l w j l w g k l σ i k j l 1 i k and j l are the new coordinate system on both axes from cell k l of the hrg grid corresponding to the new origin i k 0 j l 0 σ depends on dispersion conditions and has to be evaluated first for each grid cell w is the size of the footprint with the width 2 w 1 of the regular squared windows centered over the cell k l where the central cell is diffused in 2d this windows width is defined by the python procedure using a specific input parameter and a dependency with σ the computation is then optimized to avoid useless calculations over the full grid since g quickly tends to 0 when i k 2 j l 2 2 σ k l 2 becomes very large an increase of σ implies an increase of the computation time actually the resulting diffused concentration by the gaussian filter at cell i j is c as 6 c 1 2 π σ 2 c then by using equations 1 and 6 which provides in a stationary regime the concentration produced by the cell emission σ 2 is estimated for a fine grid cell as 7 σ 2 1 2 π 8 k u δ x δ y c e in practice to save computing time and benefit from existing compact libraries we simplify the use of a gaussian filtering by using only 20 classes b of sigma σ b discrete scale of σ with a step of 0 5 defined by the list in equation 7 to apply the gaussian filtering approach the step and the number of classes can be changed but these values provide a satisfactory results in our case after several tests 8 i f σ 0 5 σ b 0 i f 0 5 σ 1 σ b 0 5 i f 1 σ 1 5 σ b 1 i f σ 10 σ b 10 the filtering technique of scipy called scipy ndimage gaussian filter virtanen et al 2020 is then applied for the hrg by class of σ called σ b as previously defined and the final concentrations is the sum over all classes b as 9 f i l t e r σ c i j p b k 1 n x l 1 n y c k l p g k l σ b i k j l this approach is therefore fully additive appendix b error statistics used to evaluate model performance m and o refer respectively with model and observations data and n is the number of observations u 95 is the 95th percentile measurement uncertainty of the observed concentration level and β is the coefficient that scales the proportionality of the bias to the measurement uncertainty kushta et al 2019 bias b i a s m o with m 1 n i 1 n m i and o 1 n i 1 n o i root mean square error r m s e 1 n i 1 n m i o i 2 correlation coefficient r i 1 n m i m o i o i 1 n m i m 2 i 1 n o i o 2 model quality index m q i i m i o i β u 95 o i w i t h β 2 appendix c supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix c supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105692 
25401,accurate and timely flood prediction can reduce the risk of flooding bolster preparedness and help build resilience in this study we have developed a flood forecasting system prototype and checked its potential for carrying out operational flood forecasting in the state of nebraska this system builds upon some of the core components of the iowa flood information system ifis which is a state of the art platform widely recognized around the world we implemented our platform on a pilot basin in nebraska elkhorn river basin by installing eight stream sensors and setting up the hydrologic model component of ifis i e the hillslope link model hlm due to their importance in the midwest we particularly emphasized the snow processes and developed an improved hlm model that can account for different aspects of snow rain snow partitioning snowmelt and snow accumulation through simple parameterizations results show that the more thorough treatment of snow processes in the hydrologic model as proposed herein leads to better flood peak simulations in this paper we discuss different steps involved in developing the flood forecasting system prototype along with the associated challenges and opportunities keywords flood forecasting snow hydrology ifis hlm bridge vulnerability data availability we have added a software availability section in the manuscript with the required information 1 introduction the midwestern united states region shows substantial spatial heterogeneity in flood peaks with discrete seasonality villarini et al 2011 nebraska has distinct hydrologic and hydroclimatic characteristics which show sharp seasonal peaks in flood frequencies one remarkable feature of the great plains of nebraska is the maximum summer rainfall zhang et al 2001 the storms originating from the rocky mountains and traveling across midwest and causing heavy precipitation mainly from may to july over nebraska are responsible for some of the major floods in the great plains of nebraska villarini et al 2011 flood peaks associated with these storms have a significant influence on the upper tail of the flood peak distribution of nebraska villarini et al 2011 1 1 major floods their drivers and impacts in nebraska mesoscale convective system mcss storms play an important role in nebraska s climatology and they lead to a sharp seasonal flood peak in the region during late june of the year budikova et al 2010 changnon and kunkel 2006 junker et al 1999 these storms caused the disastrous flood in 1993 in midwest significantly impacting nebraska kunkel et al 1994 a similar anomalous total rainfall of 400mm along with high surface soil moisture and antecedent conditions resulted in the flood of 2008 and massive damage worth more than two million dollars budikova et al 2010 xiao et al 2013 the united states geological survey usgs has characterized both the 1993 and 2008 floods in the midwest as 500 year floods dirmeyer and kinter 2009 there is also a link between the tornadic system of thunderstorms and the climatology of floods in the great plains of nebraska zhang et al 2001 zhang et al 2001 showed these characteristics through a study of heavy floods in pebble and maple creeks because of storms that occurred in late june and early august of 1996 recently in 2019 eastern nebraska western iowa and southeastern south dakota got shallow temperatures and a historic high snowfall during the early days of the year resulting in a large amount of swe of 30 100 mm by march flanagan et al 2019 during the same period this region had frozen rivers and ground with 60 90 mm frost depth preventing the usual infiltration flanagan et al 2019 these conditions combined with the record breaking storm causing rain on snow events and rapid melting of snow produced excessive runoff and overwhelmed the rivers and streams in the region flanagan et al 2019 as of august 2019 estimates this flooding cost has reached more than three billion dollars flanagan et al 2019 these major flood events call for an efficient flood monitoring system for the state to mitigate the impacts of such disasters in the future 1 2 existing flood monitoring efforts in nebraska currently the nebraska department of natural resources nednr and the u s army corps of engineers usace monitor the incoming precipitations carry out hydrologic modeling and examine the variations in streamflow nednr 2022 nednr provides information regarding present flood conditions in nebraska through various flood maps nednr 2022 nednr s floodplain interactive map is an interactive interface that dispenses knowledge about floodplains and management interactive maps department of natural nebraska department of natural resources 2022 it runs with the support of resources like federal emergency management agency fema national flood hazard layer data nhfl constituting the present day flood data for the entire united states fema 2022 besides fema nfhl nednr utilizes the service of usgs real time flows and noaa flood stage maps to monitor flood conditions in nebraska noaa 2022 nednr takes care of flood hazard mitigation in the state to reduce the risk and severity caused by flooding nednr 2022 besides nednr other agencies such as usace fema nebraska emergency management agency nema nebraska department of transportation ndot and national flood insurance program nfip help in developing and interpreting flood and flood plain data as a part of their floodplain management services nednr 2022 national weather service nws advanced hydrologic prediction services provides stream forecasts at certain locations in nebraska noaa 2022 moreover the state makes use of the national water model nwm forecasts of streamflow at around 4000 locations in the continental united states conus and guides millions of sites that lack traditional stream forecasts office of water prediction 2022 national center for atmospheric research s ncar weather research and forecasting hydrologic model wrf hydro is the core model behind nwm gochis et al 2020 over the conus the short range streamflow forecasts of nwm are available every hour maidment and dugger 2016 even though there are existing resources for flood related assessments the state of nebraska will benefit significantly from the development of a state of the art system to enable seamless flood monitoring and forecasting this will address some of the shortcomings of the existing resources for example increasing forecast lead and reducing forecast uncertainty are two pressing needs to provide accurate and timely warnings to the community also many flood forecasting systems operate on a continental scale where the underlying rainfall runoff models generally work with a larger spatial resolution this factor can compromise the accuracy of flood prediction locally besides many of the underlying models of the regional hydrologic monitoring systems in nebraska do not consider snow processes while the runoff generation in midwestern basins is highly affected by snow accumulation bradley et al 2013 flyr et al 2013 hdr engineering 2013 this often leads to an inaccurate flood prediction 1 3 applicability of the iowa flood information system ifis prototype in nebraska there exist several state of the art flood forecasting systems around the world table 1 provides details of some well known operational flood forecasting systems the details are taken from emerton et al 2016 and kauffeldt et al 2016 many of these models include snow parameterizations for instance the wrf hydro model uses snowpack and frozen ground parameterizations based on koren et al 1999 which was later modified to incorporate the effects of canopy processes gochis et al 2020 niu and yang 2004 similarly the variable infiltration capacity vic model uses parameterizations equivalent to that proposed by anderson 1968 to simulate snow accumulation and snowmelt liang et al 1994 however the flood forecasting systems using these models often lack focus on community level flood information and run on larger grid scales that might not coincide with the actual local scale physical process ifis addresses these aspects of flood forecasting along with resolving several flood related challenges ifis is a web platform that provides facts and figures of real time flood conditions flood related data visualizations flood forecasts etc for more than a thousand communities in iowa krajewski et al 2017 after the disastrous flood of 2008 the iowa flood center ifc was established with one of the key goals of developing hydrologic models and real time flood forecasting tools for better predictions and information about floods krajewski et al 2017 ifc developed a high resolution streamflow forecasting system for iowa state that works based on hillslope link model hlm and could make predictions every 15 min for nearly 2000 locations krajewski et al 2017 later ifc developed the ifis a web based platform to provide real time flood information to the communities of iowa ifis s operation is supported by a conceptual rainfall runoff model hlm mantilla et al 2022 quintero et al 2016 2020b this model consists of multiple ordinary differential equations odes in a tree structured format representing the water flow and balance in each hillslope small et al 2013 ifis provides services that include flood inundation maps real time flood conditions flood forecasts flood related data applications information and visualizations demir and krajewski 2013 a critical strength of the ifis system is real time flood estimations ifis calculates rainfall accumulations products at 5 min daily and two week intervals krajewski et al 2017 this enables ifis to deliver flood information and alerts almost instantly compared to many other operational real time flood forecasting systems this is a remarkable feature as given in table 1 ifis system runs the model at a higher resolution hillslope scale of size 0 1 km2 compared to the flood forecasting systems in table 1 and it provides risk estimates in a community oriented way ifc 2022 mantilla et al 2022 hlm the underlying model of the ifis system has been used in various studies demonstrating the strength of the model elsaadani et al 2017 show that the non linear routing method used in hlm performs better than the routing in routing application for parallel computation of discharge rapid which uses a muskingum based method quintero et al 2020a use hlm based simulations to develop a flood potential index for iowa hlm has undergone several previous modifications to improve performance mantilla et al 2022 presently there is a potential for improvement in the representation of snow processes in hlm although the model can receive snow forcing it does not have any parameterizations to estimate swe snowmelt or frozen ground this absence of snow parameterization is speculated as the main reason for ifis s failure in the prediction of the historic spring flood that occurred in 2019 across the states of iowa nebraska and south dakota snow could play a substantial role in the hydrology of catchments in the midwest this region receives significant snow during the winter suriano 2022 snow accumulation heavily affects runoff generation in the midwest suriano 2022 therefore incorporating snow processes in flood prediction models in the midwestern region including nebraska is crucial through this work we are trying to improve the hlm by introducing snow processes in the model structure we modified the existing design by adding a new storage layer holding snow water equivalent swe this new parameterization encompasses a simple degree day factor model martinec 1975 for estimating meltwater we introduced different rain snow portioning schemes into the system and evaluated the performance of hlm we also refined the present parameterizations to account for the occurrence of frozen ground and its effect in assessing streamflow after successfully testing the parameterization we implemented the upgraded model for a pilot basin in nebraska to show the potential of an operational flood forecasting system for the state to support our case similar to the ifc we installed streamflow gauging stations across the pilot basin where we can collect data and assimilate it into the model we also developed a simple web interface showing simulated hydrographs anywhere in the basin this article discusses the materials and methods required for implementing an improved hlm model in a pilot basin in nebraska including the improved model equations with snow parameterization then we show the results obtained followed by some discussion about possible amendments and challenges related to an operational flood forecasting system finally we finish the article by concluding with remarks from this work 2 materials and methods 2 1 data in this study for the preliminary validation of the proposed parameterization of the snow process which is newly added to the hlm structure we used north american land data assimilation system nldas 2 precipitation potential evapotranspiration and temperature forcing from 2015 to 2020 mitchell et al 2004 xia et al 2012 we used precipitation and temperature aggregated into a daily resolution for two different locations in nebraska for the initial validation of modified model equations the hourly temperature aggregated for the elkhorn basin fig 1 was used in hlm simulations we provided monthly aggregated potential evapotranspiration as a lower frequency does not significantly improve the results for validating the proposed snow parameterization we acquired swe data of daily 4 km gridded swe and snow depth from assimilated in situ and modeled data over the conterminous u s version 1 broxton et al 2019 zeng et al 2018 from the national snow and ice data center nsidc this data provides daily swe and snow depth at a spatial resolution of 4km 4km for the conterminous united states conus we collected the swe data for the same period as the simulation 2015 2020 and resampled it to the resolution of nldas 2 forcing data using linear interpolation we use multi radar multi sensor quantitative precipitation estimate mrms qpe for precipitation forcing to the hlm model based flood forecasts mrms qpe products have an update cycle of as low as 2 minutes and a latency of around 1 5 hours making them suitable for operational flood forecasting systems zhang et al 2016 mrms system incorporates data from about 180 radars and almost 7000 rain gauges at an hourly scale to correct the biases in radar data many operational flood forecasting systems in the eastern u s utilizes mrms qpe products to monitor flood conditions zhang et al 2016 we use the observed data obtained from usgs stations to evaluate the model s performance there are eight usgs stations in the elkhorn river basin for which we have hourly discharge data although there is a gap in many of the discharge data during the winter period these were filled with estimated values by usgs kimbrough et al 2006 usgs 2023 we also use the usgs observed data to update the river stages in our retrospective flood forecasting model for 2019 the ifc has advanced streamflow gauging sensors which automatically collect the stream level data and transfer it to ifis every 15 minutes this data can be later assimilated into the flood modeling system to correct the river flow estimates we have installed eight sensors across the elkhorn river basin which are already functional these sensors mounted to the bridge side emit sonar signals toward the stream to measure the distance from the sensor to the water level fig 1 shows the locations of sensors we installed across the elkhorn river basin these locations were decided based on field visits and gis analysis where we tried to cover streams of different orders ifc creates an ensemble of rating curves to account for the uncertainty of channel roughness and energy surface slope a set of 100 combinations for slope and manning s values sampled uniformly over their feasible ranges was selected each set of combinations gives a different rating curve the resulting ensemble of equally likely rating curves can be described using quantiles that represent uncertainty through the range of variation of discharge and stage the representation of ratings is presented in the form of the 50 median 5 and 95 quantiles topographic and hydrologic information was provided by the nebraska department of transportation ndot supplementary fig 1 shows in green the cross sections surveyed for each site and supplementary table 1 shows the hydrologic data used to set up a steady flow model downstream boundary conditions were based on a normal depth assumption using an energy surface slope estimated from the bottom of the channel profile captured in the survey data near the downstream study limit manning s coefficient range was set to between 0 03 and 0 045 which is used in the channel sections of the step backwater hec ras model the selected range is supported by the experience of previous projects and the literature barnes 1969 gilles et al 2012 quintero et al 2021 for the floodplain we used the nebraska land use data map 2015 produced by the nednr nednr 2022 to assign roughness values that were selected based on typical values provided by the hec ras hydraulic reference manual version 4 1 chow 1959 french 1985 u s army corps of engineers 2010 supplementary fig 2 a summary of datasets used in this study is given in table 2 2 2 hillslope link model hlm the current operational real time flood monitoring system relies on hlm mantilla et al 2022 this conceptual model employs the quintessential leaky bucket perception of a watershed hlm divides the entire watershed into a large number of individual hillslopes each hillslope has multiple water storage layers where water from each layer flows to the subsequent layer below as well as to the stream based on parameterizations relevant to the processes a schematic representation of this parameterization hlm nosnow is given in fig 2 a equation 1 2 3 represents a change of storage with respect to time in each layer of a hillslope the change in each layer equals the difference between the incoming and outgoing water flux equation 1 represents the change in storage in the ponding top layer where the incoming flux is precipitation p t and outgoing fluxes are infiltration q p t surface runoff q p l and evaporation from surface e p for the second layer represented by equation 2 the incoming flux is infiltration and outgoing fluxes are deep percolation q t s and evaporation from the second layer e t similarly for third layer the incoming flux is deep percolation and outgoing fluxes are subsurface runoff q s l and evaporation from the third layer e s as represented by equation 3 the hillslopes are connected in a tree structured format where water from each hillslope adds up and contributes to the streamflow this results in a massive system of odes linked as a tree structure solving this system of odes provides outputs of desired variables such as streamflow 1 d s p d t p t q p l q p t e p 2 d s t d t q p t q t s e t 3 d s s d t q t s q s l e s 2 3 improvements to the hlm model we introduce an updated conceptual model structure for hlm by including snow processes hlm psnow as shown in fig 2b in this update there are two major components we added to the system 1 rain snow partitioning rsp schemes and 2 a new storage layer of swe this study compares the two models previous and updated and reports the results we considered the option of using different rain snow partitioning of the incoming precipitation this precipitation provided as forcing is divided into snow and rainfall based on three different rsp schemes these schemes are shown in fig 3 the first rsp scheme is premised on a base temperature tb if the temperature exceeds tb all precipitation is considered rainfall and otherwise snow the base temperature tb should be calibrated to find the optimum performance the second rsp scheme is characterized by representing snow fraction fraction of snow in the incoming total precipitation as a linear stepwise function of the air temperature jordan 1991 the third rsp scheme is based on that proposed by wang et al 2019 where snow fraction is obtained following a sigmoid function of wet bulb temperature in this scheme the parsimony of the model is compromised compared to earlier versions as the implementation of this scheme requires an additional input of relative humidity the swe storage layer ssnow is conceptually located above the ponding layer sp this new layer stores the accumulated snow and the change in swe with respect to time is given by the addition of new snow and subtraction of outgoing melt water and snow evaporation as represented using equation 4 the amount of meltwater is calculated using a simple degree day factor ddf model martinec 1975 as described in equation 5 where d mmocd 1 is the degree day factor the amount of meltwater cannot be greater than the existing swe therefore the minimum of meltwater and swe is taken after portioning the total precipitation into rainfall prain and snow psnow the amount of snow is added to this layer and rain is directly entered into the ponding layer the ponding layer will have an additional meltwater component from the snow accumulation layer above it as a result the equation representing the ponding layer looks like equation 6 for subsequent layers there are no changes therefore the equations remain the same as that of the earlier version with the new snow layer implementation the hlm can now simulate swe as a new output variable which can be used to study further the role of snow in the hydrology and water resources of the region we should note that a previous update in the hlm considered including swe as an external forcing velasquez et al in review 4 d s s w e d t p s n o w q m e l t p e s n o w 5 q m e l t p min d t t s s w e 6 d s p d t p r a i n q p l q p t q m e l t p e p 2 4 implementation of the improved ifis system prototype in this study we found that the absence of snow processes in the modeling framework shortens the ability of hlm to predict streamflow efficiently especially in the midwest where snow plays a vital role in the water cycle we introduce a new simple parameterization as discussed in section 2 3 the methodology followed to implement the prototype flood forecasting system with the new parameterization is shown in fig 4 initially we tested this new set of odes using matlab ode solvers by writing a prototype code representing the vertical water flow in a single hillslope and solving the odes we could obtain preliminary results of patterns of water in each storage layer including swe from the newly added layer this allowed a proof of concept on whether the new parameterization could be representative of the actual process before altering the source code once tested successfully we updated the model source code by adding this improved hlm structure as a new model inside the numerical solver toolbox for hlm differential equations additional forcing of temperature can be provided in the format of regular storm files binary storm files or uniform storm files when the updated source code was ready we set up and compiled these source codes in crane a high performance computer of holland computing center at the university of nebraska lincoln the required forcings are made available in crane in hlm the inputs can be provided in several formats including ascii text files e g str ustr and mon files databases e g postgresql database and binary files in our case precipitation files are stored in binary format whereas temperature recordings are aggregated for the basin and provided through uniform storm ustr files then we manually tuned the parameters to obtain the realistic runoff from the model and compared them with observed usgs discharge measurements next we created a postgresql stonebraker and rowe 1986 database to insert observed discharge measurements from usgs stations and the newly installed sensors this postgresql database aids the smooth assimilation of sensor measurements into hlm we can add the real time measurements into this database and update the model simulated river discharges instantly to convert the stream level data measured by new sensors into streamflow data we developed rating curves the ifc developed a methodology to obtain a stage discharge relationship using the step backwater model with the hydrologic engineer center s river analysis system hec ras quintero et al 2021 we set up one dimensional 1d hydraulic models for every location where sensors are installed to obtain a stage discharge relationship supplementary fig 1 rating curves are subject to multiple sources of uncertainty in particular synthetic curves developed with hydraulic models are sensitive to the characterization of the channel geometry e g the number of cross sections and the spacing between them bottom slope and discretization of the finite element mesh among others as well as model parameters e g manning s roughness coefficient of the channel quintero et al 2021 the uncertainty for manning s roughness coefficient is not available because this parameter is not directly measured but assessed through a visual comparison of previous studies arcement and schneider 1984 despite extensive efforts to determine channel roughness its estimation continues to be subjective and can lead even for common situations to errors as high as 30 bray 1979 we downloaded the mrms data from the archives of iowa environmental mesonet of iowa state university these files were initially in grib format which we later cropped for the elkhorn region and converted to binary file format in holland computing center hpc these binary files are the fastest way for the model to read the forcing data since in this work we intend to show the potential of a flood forecasting system for nebraska through a retrospective analysis we forced the model for a time period of 2018 and 2019 of this 2018 is considered a spin up time for the model we saved the model snapshot at the end of 2018 hlm provides the option of saving the model stages at any timestep as a rec file and provided it as an initial condition for the 2019 simulation we also set up a postgresql database consisting of observed streamflow measurements from usgs from which we regularly update the model streamflow stages this process automatically replaces the model produced values with observed values at these locations the hlm works based on a system of ordinary differential equations arranged in a tree topology structure as discussed in section 2 2 the computation of solutions for this system of odes is achieved using the asynchronous asynch software package created by ifc small et al 2013 the primary application of asynch solvers is finding solutions for distributed hydrologic models of catchments asynch uses dense output runge kutta methods to solve the equations at each hillslope the input forcing such as precipitation potential evapotranspiration and temperature can be transferred through several file formats as well as taken from a structured query language sql database similarly we can produce outputs in different formats and display and use them for studies in the present world web interfaces are the most viable way of providing information to the public we developed a simple web interface code available in github repository that shows the stream network map of the elkhorn basin where the user can click anywhere and the hydrograph at that location will be displayed this web interface is developed using python with dash and plotly libraries plotly technologies inc 2015 we use mapbox tools to develop a basemap for this web interface fig 5 shows the screenshot of the web interface it is essential to note that this interface is a part of our prototype flood forecasting system and a preliminary version to set the ground for improvisation 2 5 bridge vulnerability for the eight newly installed sensor locations we estimated the vulnerability of bridges to flood peril two critical factors on which the bridge vulnerability depends are the time to peak at these locations and the elevation of bridges from the bottom of the river the higher the time to peak the lower the vulnerability and the higher the elevation of bridges the lower the vulnerability the time to peak values are calculated by ingesting the model with an arbitrary constant rainfall across the basin this was realized with the uniform storm files ustr type of forcing in hlm then we obtained the streamflow at these locations produced by the model and the time difference between the peak flow and centroid of the storm which gives time to peak the elevation of bridges from the bottom of the river was already measured during their installation once these two quantities were obtained simply plotting one across another would give a sense of the vulnerability of bridges to flood peril 3 results from the prototype system of odes created in matlab for initial validation with an additional storage layer for snow we obtained the simulated swe supplementary fig 3 shows the comparison of simulated swe with that of observed values from nsidc data we compared this for two different locations in nebraska initial results were satisfactory as the output from the new storage layer could pick up the swe patterns well supplementary fig 3b shows that the model produced similar values for the norfolk region in 2019 and 2020 however since these were preliminary results from a single grid data it does not represent the connection between different hillslopes as in hlm we simulated the hydrographs for 2019 as the historic flood during march is our point of interest flanagan et al 2019 using the currently used hlm and a new version of the model including the snow parameterization we compared both hydrographs with the observed hydrographs at five locations across the elkhorn basin the results suggest that the hlm with snow parameterization outperforms the current version of hlm in predicting the peak flow in the midwest during march 2019 fig 6 shows that the hlm without snow could not capture the peak flow at any seven stations in contrast the hydrographs from the model with snow parameterization show peaks corresponding to observed peaks this implies that snow processes majorly drove the flooding in march 2019 supplementary fig 5 shows the model simulated streamflow after assimilating the usgs data note that we could not use streamflow measurements from the newly installed sensors because they were not available at the time of the 2019 spring flood event fig 7 shows the plot between the time to peak and bridge elevation illustrating the different exposure levels of eight bridges across the elkhorn river basin the higher the time to peak the lower the vulnerability and the higher the elevation of bridges the lower the vulnerability therefore the vulnerability increases as we move closer to the plot s origin we can see that bridge near stuart ne is the most vulnerable to flood disasters whereas the bridge near norfolk ne is the least vulnerable the bridge vulnerability study demonstrates a practical application of hlm we can use this model to assess bridge vulnerability for any point in the river network given the height of the bridge highlighting its application of the model in the transportation sector fig 8 shows the results of synthetic rating curves obtained with the hydraulic model for each site the solid black line and the gray area around it show the median and the 5 and 95 quantiles of the uncertainty range based on the 100 rating curves using the model 4 discussion this study investigated the potential of a real time flood forecasting system for nebraska by implementing a prototype on the elkhorn river basin we used the hydrologic model hlm of the ifis system and enhanced it to account for snow processes our results demonstrate how a simple conceptual modification in the model can significantly improve its performance which is also supported by the literature mai et al 2022 roy et al 2017a in nebraska snow processes produce the major portion of runoff barnett et al 2005 a recent flood in 2019 showed the importance of snow generated runoff in the occurrence of peak flows flanagan et al 2019 by including snow parameterizations hlm could more realistically simulate the hydrology of snow processes thus improving its peak flow prediction performance we implemented the hlm source codes on the university of nebraska lincoln s high performance computer this flood forecasting framework can be expanded to a larger region including snow dominated areas with minimal requirements for forcing data since the hlm conducts simulations by solving odes at the hillslope scale which corresponds to the actual hydrologic processes it can provide discharge estimates at any stream location though the accuracy of the first few orders of streams can be low as seen in fig 6 the decomposition of hillslope links from the dem of a region can be done easily with the help of openly available tools github 2023 a major strength of hlm making it suitable for flood forecasting is that it is less susceptible to the spatial variability of parameters mantilla et al 2022 the error associated with each hillslope simulation gets canceled as it travels from lower to higher orders of streams a hypothesis proven by mandapaka et al 2009 while hlm can serve as a hydrologic model to simulate river discharge it requires further work to transform it into an operational real time flood forecasting system an operational flood forecasting system should include collecting and inputting the most recent forcing data such as precipitation and temperature depending on the model used solving the model across multiple basins assimilating the observed discharge data and potentially other variables from sensors and timely updating a user interface to disseminate the flood information to the stakeholders the most critical and challenging task is to make all these components run simultaneously and seamlessly in an automatic manner it is crucial to integrate real time forcing data with the maximum possible lead time there are several potential candidates for this for example multi radar multi sensor quantitative precipitation estimation mrms qpe rainfall products are useful to ensure lower latency which means that we can predict an imminent flood well ahead of time thereby providing effective early warning satellite based precipitation estimates can also be used for near real time streamflow monitoring roy et al 2017b 2017c 2020 numerical precipitation forecasts such as global forecasting systems gfs are useful for forecasting streamflow ahead of time streamflow information from upstream can be used to predict streamflow with lead time downstream furthermore time series modeling of streamflow can help generate forecasts with lead the ifc uses nexrad radar based rainfall accumulation data processed every 5 minutes from 7 radars covering iowa krajewski et al 2013 seo and krajewski 2015 every 15 minutes they pull the rainfall estimates up to the forecast issuance time to produce a streamflow forecast for up to 10 days one of the ways to potentially improve forecast skills would be through the use of robust quantitative precipitation forecasts qpf the efficiency of the qpf method used for flood forecasting is critical as the error in qpf would propagate to flow predictions in ifc exploring the potential of qpf methods is an ongoing activity krajewski et al 2017 we could also implement time series modeling using statistical and machine learning methods to estimate streamflow in any case it is important that the forecast errors and uncertainties are thoroughly analyzed and their sources are detected and addressed as necessary the flood forecasting system we worked on is based on hlm simulations and streamflow observations we could leverage data and resources from a variety of sources e g nws usgs usace noaa and integrate them into the proposed system this would enable us to disseminate several layers of information we can add open flow modeling to provide 3d flood inundation views at several locations across the state which would assist in efficient communication with the public this will require the collection and processing of bathymetry data of the channels inundation maps can be generated focusing on the communities and such maps can also assist national flood insurance program nfip establishing an operational flood forecasting system comes with multiple challenges one among them is integrating all components of the flood forecasting system efficiently this involves running the model collecting and assimilating data and circulating the information for such a task to accomplish we need experts from the fields of hydrology water resource engineering computer science and social science working together while hydrologists and water resource engineers work on the modeling and conceptual sides of the system computer scientists are necessary to aid them in terms of data management utilizing high performance computing resources and web interface social scientists can add different dimensions of the community and efficiently gather stakeholder feedback in nebraska we can utilize the holland computing center hcc at the university of nebraska lincoln for computational resources another big challenge in setting up an operational flood forecasting system is the calibration of the model across all basins in the state the hlm currently does not have an automatic calibration scheme to calibrate the model we have to identify sensitive parameters based on experience in model runs and manually tune the parameters to give the best results this process is supported by knowledge about the catchment properties manually calibrating the model is often tedious because it involves several trial and error simulations as there can be many combinations with few sensitive parameters one solution to this problem is to structure an automatic calibration framework for hlm the way hlm is set up i e at every hillslope it produces a large number of parameters for a given basin which can be computationally way too expensive to tackle for the commonly used automatic calibration algorithms however parameter regionalization techniques where distributed model parameters are derived from other hydroclimatic and catchment features can be useful in this regard in addition to the abovementioned challenges we must continuously monitor an operational flood forecasting system to maintain its efficiency some of the undertakings necessary to achieve this are 1 frequent examinations of the sensors 2 data management checking and filtering the data coming into the model 3 bug identification and fixing in the model source code and 4 upkeeping the web interface a dedicated team of experts is essential to accomplish these tasks along with that we must constantly work to pursue the challenges of model uncertainties and how the uncertainty in hydrologic predictions can be communicated to decision makers and the general public as proposed by 23 unsolved problems in hydrology blöschl et al 2019 from a technical standpoint it will be important to develop a system that translates the river stages obtained from model simulations to estimated flood depths and extends we could think of a python library that includes all the necessary functions for information extraction the ifc currently has a similar library which can be implemented for the nebraska basins this would help in the development of the information system for efficient communication with the public through interactive maps and other visualizations water infrastructures such as reservoirs and groundwater wells can influence the hydrologic processes which affect the occurrence of floods dang et al 2016 we have not looked into the role of water infrastructure in regulating floods in the region in this study nednr together with usace constructs various structures such as dams and levees to divert water away from areas that might cause more damage nednr 2022 it would be interesting to study how these structures impact flood mitigation 5 conclusions this article presents the methodology we followed to implement a flood forecasting system prototype for a pilot basin in nebraska we discuss the ifis system and our improvements to its underlying hydrologic model hlm to include snow processes we set up the components of a flood forecasting system prototype which includes 1 sensors measuring stream level 2 synthetic rating curves 3 hydrologic model upgraded hlm with necessary inputs 4 assimilation of the observed stream data into the model and 5 web interface we discuss the opportunities and challenges in developing a full fledged operational flood forecasting platform besides we analyzed the vulnerability of eight bridges to flood peril based on a methodology that can be expanded to other bridges our results substantiate the fact that incorporating snow processes is crucial in flood forecasting in cold regions e g nebraska in this case this was evident in the simulation of the 2019 spring flood where accounting for snow processes improved the simulation of the peak flow more specifically the addition of our proposed snow parameterizations to the hlm showed significant improvement in predicting the 2019 march flood in the elkhorn river basin as compared to the version of the model without snow parameterizations furthermore our results also show that oftentimes simple improvements to the model structure can significantly improve the accuracy of a model from a modeling perspective hlm appears to be a strong candidate for the operational implementation of a flood monitoring and forecasting platform in the state of nebraska findings from this work strongly support the idea of a statewide expansion of the platform and the development of an operational flood information system targeting community welfare and engagement a platform like this will also provide policymakers with accurate information and gainful facts about flooding in a timely manner thereby enabling more informed decision making software availability name of the software asynch hlm psnow developer sinan rasiya koya nicolas giron tirthankar roy contact information ssinanrk2 huskers unl edu year first available 2022 program language c source code availability https github com sinanrk asynch git program size 14 3 mb declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment funding for this research was provided by the mid america transportation center via a grant from the u s department of transportation s university transportation centers program usdot utc grant number for matc 69a3551747107 we also acknowledge the holland computing center hcc staff for their support with high performance computing and the ndot personnel who collected the channel data appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105693 
25401,accurate and timely flood prediction can reduce the risk of flooding bolster preparedness and help build resilience in this study we have developed a flood forecasting system prototype and checked its potential for carrying out operational flood forecasting in the state of nebraska this system builds upon some of the core components of the iowa flood information system ifis which is a state of the art platform widely recognized around the world we implemented our platform on a pilot basin in nebraska elkhorn river basin by installing eight stream sensors and setting up the hydrologic model component of ifis i e the hillslope link model hlm due to their importance in the midwest we particularly emphasized the snow processes and developed an improved hlm model that can account for different aspects of snow rain snow partitioning snowmelt and snow accumulation through simple parameterizations results show that the more thorough treatment of snow processes in the hydrologic model as proposed herein leads to better flood peak simulations in this paper we discuss different steps involved in developing the flood forecasting system prototype along with the associated challenges and opportunities keywords flood forecasting snow hydrology ifis hlm bridge vulnerability data availability we have added a software availability section in the manuscript with the required information 1 introduction the midwestern united states region shows substantial spatial heterogeneity in flood peaks with discrete seasonality villarini et al 2011 nebraska has distinct hydrologic and hydroclimatic characteristics which show sharp seasonal peaks in flood frequencies one remarkable feature of the great plains of nebraska is the maximum summer rainfall zhang et al 2001 the storms originating from the rocky mountains and traveling across midwest and causing heavy precipitation mainly from may to july over nebraska are responsible for some of the major floods in the great plains of nebraska villarini et al 2011 flood peaks associated with these storms have a significant influence on the upper tail of the flood peak distribution of nebraska villarini et al 2011 1 1 major floods their drivers and impacts in nebraska mesoscale convective system mcss storms play an important role in nebraska s climatology and they lead to a sharp seasonal flood peak in the region during late june of the year budikova et al 2010 changnon and kunkel 2006 junker et al 1999 these storms caused the disastrous flood in 1993 in midwest significantly impacting nebraska kunkel et al 1994 a similar anomalous total rainfall of 400mm along with high surface soil moisture and antecedent conditions resulted in the flood of 2008 and massive damage worth more than two million dollars budikova et al 2010 xiao et al 2013 the united states geological survey usgs has characterized both the 1993 and 2008 floods in the midwest as 500 year floods dirmeyer and kinter 2009 there is also a link between the tornadic system of thunderstorms and the climatology of floods in the great plains of nebraska zhang et al 2001 zhang et al 2001 showed these characteristics through a study of heavy floods in pebble and maple creeks because of storms that occurred in late june and early august of 1996 recently in 2019 eastern nebraska western iowa and southeastern south dakota got shallow temperatures and a historic high snowfall during the early days of the year resulting in a large amount of swe of 30 100 mm by march flanagan et al 2019 during the same period this region had frozen rivers and ground with 60 90 mm frost depth preventing the usual infiltration flanagan et al 2019 these conditions combined with the record breaking storm causing rain on snow events and rapid melting of snow produced excessive runoff and overwhelmed the rivers and streams in the region flanagan et al 2019 as of august 2019 estimates this flooding cost has reached more than three billion dollars flanagan et al 2019 these major flood events call for an efficient flood monitoring system for the state to mitigate the impacts of such disasters in the future 1 2 existing flood monitoring efforts in nebraska currently the nebraska department of natural resources nednr and the u s army corps of engineers usace monitor the incoming precipitations carry out hydrologic modeling and examine the variations in streamflow nednr 2022 nednr provides information regarding present flood conditions in nebraska through various flood maps nednr 2022 nednr s floodplain interactive map is an interactive interface that dispenses knowledge about floodplains and management interactive maps department of natural nebraska department of natural resources 2022 it runs with the support of resources like federal emergency management agency fema national flood hazard layer data nhfl constituting the present day flood data for the entire united states fema 2022 besides fema nfhl nednr utilizes the service of usgs real time flows and noaa flood stage maps to monitor flood conditions in nebraska noaa 2022 nednr takes care of flood hazard mitigation in the state to reduce the risk and severity caused by flooding nednr 2022 besides nednr other agencies such as usace fema nebraska emergency management agency nema nebraska department of transportation ndot and national flood insurance program nfip help in developing and interpreting flood and flood plain data as a part of their floodplain management services nednr 2022 national weather service nws advanced hydrologic prediction services provides stream forecasts at certain locations in nebraska noaa 2022 moreover the state makes use of the national water model nwm forecasts of streamflow at around 4000 locations in the continental united states conus and guides millions of sites that lack traditional stream forecasts office of water prediction 2022 national center for atmospheric research s ncar weather research and forecasting hydrologic model wrf hydro is the core model behind nwm gochis et al 2020 over the conus the short range streamflow forecasts of nwm are available every hour maidment and dugger 2016 even though there are existing resources for flood related assessments the state of nebraska will benefit significantly from the development of a state of the art system to enable seamless flood monitoring and forecasting this will address some of the shortcomings of the existing resources for example increasing forecast lead and reducing forecast uncertainty are two pressing needs to provide accurate and timely warnings to the community also many flood forecasting systems operate on a continental scale where the underlying rainfall runoff models generally work with a larger spatial resolution this factor can compromise the accuracy of flood prediction locally besides many of the underlying models of the regional hydrologic monitoring systems in nebraska do not consider snow processes while the runoff generation in midwestern basins is highly affected by snow accumulation bradley et al 2013 flyr et al 2013 hdr engineering 2013 this often leads to an inaccurate flood prediction 1 3 applicability of the iowa flood information system ifis prototype in nebraska there exist several state of the art flood forecasting systems around the world table 1 provides details of some well known operational flood forecasting systems the details are taken from emerton et al 2016 and kauffeldt et al 2016 many of these models include snow parameterizations for instance the wrf hydro model uses snowpack and frozen ground parameterizations based on koren et al 1999 which was later modified to incorporate the effects of canopy processes gochis et al 2020 niu and yang 2004 similarly the variable infiltration capacity vic model uses parameterizations equivalent to that proposed by anderson 1968 to simulate snow accumulation and snowmelt liang et al 1994 however the flood forecasting systems using these models often lack focus on community level flood information and run on larger grid scales that might not coincide with the actual local scale physical process ifis addresses these aspects of flood forecasting along with resolving several flood related challenges ifis is a web platform that provides facts and figures of real time flood conditions flood related data visualizations flood forecasts etc for more than a thousand communities in iowa krajewski et al 2017 after the disastrous flood of 2008 the iowa flood center ifc was established with one of the key goals of developing hydrologic models and real time flood forecasting tools for better predictions and information about floods krajewski et al 2017 ifc developed a high resolution streamflow forecasting system for iowa state that works based on hillslope link model hlm and could make predictions every 15 min for nearly 2000 locations krajewski et al 2017 later ifc developed the ifis a web based platform to provide real time flood information to the communities of iowa ifis s operation is supported by a conceptual rainfall runoff model hlm mantilla et al 2022 quintero et al 2016 2020b this model consists of multiple ordinary differential equations odes in a tree structured format representing the water flow and balance in each hillslope small et al 2013 ifis provides services that include flood inundation maps real time flood conditions flood forecasts flood related data applications information and visualizations demir and krajewski 2013 a critical strength of the ifis system is real time flood estimations ifis calculates rainfall accumulations products at 5 min daily and two week intervals krajewski et al 2017 this enables ifis to deliver flood information and alerts almost instantly compared to many other operational real time flood forecasting systems this is a remarkable feature as given in table 1 ifis system runs the model at a higher resolution hillslope scale of size 0 1 km2 compared to the flood forecasting systems in table 1 and it provides risk estimates in a community oriented way ifc 2022 mantilla et al 2022 hlm the underlying model of the ifis system has been used in various studies demonstrating the strength of the model elsaadani et al 2017 show that the non linear routing method used in hlm performs better than the routing in routing application for parallel computation of discharge rapid which uses a muskingum based method quintero et al 2020a use hlm based simulations to develop a flood potential index for iowa hlm has undergone several previous modifications to improve performance mantilla et al 2022 presently there is a potential for improvement in the representation of snow processes in hlm although the model can receive snow forcing it does not have any parameterizations to estimate swe snowmelt or frozen ground this absence of snow parameterization is speculated as the main reason for ifis s failure in the prediction of the historic spring flood that occurred in 2019 across the states of iowa nebraska and south dakota snow could play a substantial role in the hydrology of catchments in the midwest this region receives significant snow during the winter suriano 2022 snow accumulation heavily affects runoff generation in the midwest suriano 2022 therefore incorporating snow processes in flood prediction models in the midwestern region including nebraska is crucial through this work we are trying to improve the hlm by introducing snow processes in the model structure we modified the existing design by adding a new storage layer holding snow water equivalent swe this new parameterization encompasses a simple degree day factor model martinec 1975 for estimating meltwater we introduced different rain snow portioning schemes into the system and evaluated the performance of hlm we also refined the present parameterizations to account for the occurrence of frozen ground and its effect in assessing streamflow after successfully testing the parameterization we implemented the upgraded model for a pilot basin in nebraska to show the potential of an operational flood forecasting system for the state to support our case similar to the ifc we installed streamflow gauging stations across the pilot basin where we can collect data and assimilate it into the model we also developed a simple web interface showing simulated hydrographs anywhere in the basin this article discusses the materials and methods required for implementing an improved hlm model in a pilot basin in nebraska including the improved model equations with snow parameterization then we show the results obtained followed by some discussion about possible amendments and challenges related to an operational flood forecasting system finally we finish the article by concluding with remarks from this work 2 materials and methods 2 1 data in this study for the preliminary validation of the proposed parameterization of the snow process which is newly added to the hlm structure we used north american land data assimilation system nldas 2 precipitation potential evapotranspiration and temperature forcing from 2015 to 2020 mitchell et al 2004 xia et al 2012 we used precipitation and temperature aggregated into a daily resolution for two different locations in nebraska for the initial validation of modified model equations the hourly temperature aggregated for the elkhorn basin fig 1 was used in hlm simulations we provided monthly aggregated potential evapotranspiration as a lower frequency does not significantly improve the results for validating the proposed snow parameterization we acquired swe data of daily 4 km gridded swe and snow depth from assimilated in situ and modeled data over the conterminous u s version 1 broxton et al 2019 zeng et al 2018 from the national snow and ice data center nsidc this data provides daily swe and snow depth at a spatial resolution of 4km 4km for the conterminous united states conus we collected the swe data for the same period as the simulation 2015 2020 and resampled it to the resolution of nldas 2 forcing data using linear interpolation we use multi radar multi sensor quantitative precipitation estimate mrms qpe for precipitation forcing to the hlm model based flood forecasts mrms qpe products have an update cycle of as low as 2 minutes and a latency of around 1 5 hours making them suitable for operational flood forecasting systems zhang et al 2016 mrms system incorporates data from about 180 radars and almost 7000 rain gauges at an hourly scale to correct the biases in radar data many operational flood forecasting systems in the eastern u s utilizes mrms qpe products to monitor flood conditions zhang et al 2016 we use the observed data obtained from usgs stations to evaluate the model s performance there are eight usgs stations in the elkhorn river basin for which we have hourly discharge data although there is a gap in many of the discharge data during the winter period these were filled with estimated values by usgs kimbrough et al 2006 usgs 2023 we also use the usgs observed data to update the river stages in our retrospective flood forecasting model for 2019 the ifc has advanced streamflow gauging sensors which automatically collect the stream level data and transfer it to ifis every 15 minutes this data can be later assimilated into the flood modeling system to correct the river flow estimates we have installed eight sensors across the elkhorn river basin which are already functional these sensors mounted to the bridge side emit sonar signals toward the stream to measure the distance from the sensor to the water level fig 1 shows the locations of sensors we installed across the elkhorn river basin these locations were decided based on field visits and gis analysis where we tried to cover streams of different orders ifc creates an ensemble of rating curves to account for the uncertainty of channel roughness and energy surface slope a set of 100 combinations for slope and manning s values sampled uniformly over their feasible ranges was selected each set of combinations gives a different rating curve the resulting ensemble of equally likely rating curves can be described using quantiles that represent uncertainty through the range of variation of discharge and stage the representation of ratings is presented in the form of the 50 median 5 and 95 quantiles topographic and hydrologic information was provided by the nebraska department of transportation ndot supplementary fig 1 shows in green the cross sections surveyed for each site and supplementary table 1 shows the hydrologic data used to set up a steady flow model downstream boundary conditions were based on a normal depth assumption using an energy surface slope estimated from the bottom of the channel profile captured in the survey data near the downstream study limit manning s coefficient range was set to between 0 03 and 0 045 which is used in the channel sections of the step backwater hec ras model the selected range is supported by the experience of previous projects and the literature barnes 1969 gilles et al 2012 quintero et al 2021 for the floodplain we used the nebraska land use data map 2015 produced by the nednr nednr 2022 to assign roughness values that were selected based on typical values provided by the hec ras hydraulic reference manual version 4 1 chow 1959 french 1985 u s army corps of engineers 2010 supplementary fig 2 a summary of datasets used in this study is given in table 2 2 2 hillslope link model hlm the current operational real time flood monitoring system relies on hlm mantilla et al 2022 this conceptual model employs the quintessential leaky bucket perception of a watershed hlm divides the entire watershed into a large number of individual hillslopes each hillslope has multiple water storage layers where water from each layer flows to the subsequent layer below as well as to the stream based on parameterizations relevant to the processes a schematic representation of this parameterization hlm nosnow is given in fig 2 a equation 1 2 3 represents a change of storage with respect to time in each layer of a hillslope the change in each layer equals the difference between the incoming and outgoing water flux equation 1 represents the change in storage in the ponding top layer where the incoming flux is precipitation p t and outgoing fluxes are infiltration q p t surface runoff q p l and evaporation from surface e p for the second layer represented by equation 2 the incoming flux is infiltration and outgoing fluxes are deep percolation q t s and evaporation from the second layer e t similarly for third layer the incoming flux is deep percolation and outgoing fluxes are subsurface runoff q s l and evaporation from the third layer e s as represented by equation 3 the hillslopes are connected in a tree structured format where water from each hillslope adds up and contributes to the streamflow this results in a massive system of odes linked as a tree structure solving this system of odes provides outputs of desired variables such as streamflow 1 d s p d t p t q p l q p t e p 2 d s t d t q p t q t s e t 3 d s s d t q t s q s l e s 2 3 improvements to the hlm model we introduce an updated conceptual model structure for hlm by including snow processes hlm psnow as shown in fig 2b in this update there are two major components we added to the system 1 rain snow partitioning rsp schemes and 2 a new storage layer of swe this study compares the two models previous and updated and reports the results we considered the option of using different rain snow partitioning of the incoming precipitation this precipitation provided as forcing is divided into snow and rainfall based on three different rsp schemes these schemes are shown in fig 3 the first rsp scheme is premised on a base temperature tb if the temperature exceeds tb all precipitation is considered rainfall and otherwise snow the base temperature tb should be calibrated to find the optimum performance the second rsp scheme is characterized by representing snow fraction fraction of snow in the incoming total precipitation as a linear stepwise function of the air temperature jordan 1991 the third rsp scheme is based on that proposed by wang et al 2019 where snow fraction is obtained following a sigmoid function of wet bulb temperature in this scheme the parsimony of the model is compromised compared to earlier versions as the implementation of this scheme requires an additional input of relative humidity the swe storage layer ssnow is conceptually located above the ponding layer sp this new layer stores the accumulated snow and the change in swe with respect to time is given by the addition of new snow and subtraction of outgoing melt water and snow evaporation as represented using equation 4 the amount of meltwater is calculated using a simple degree day factor ddf model martinec 1975 as described in equation 5 where d mmocd 1 is the degree day factor the amount of meltwater cannot be greater than the existing swe therefore the minimum of meltwater and swe is taken after portioning the total precipitation into rainfall prain and snow psnow the amount of snow is added to this layer and rain is directly entered into the ponding layer the ponding layer will have an additional meltwater component from the snow accumulation layer above it as a result the equation representing the ponding layer looks like equation 6 for subsequent layers there are no changes therefore the equations remain the same as that of the earlier version with the new snow layer implementation the hlm can now simulate swe as a new output variable which can be used to study further the role of snow in the hydrology and water resources of the region we should note that a previous update in the hlm considered including swe as an external forcing velasquez et al in review 4 d s s w e d t p s n o w q m e l t p e s n o w 5 q m e l t p min d t t s s w e 6 d s p d t p r a i n q p l q p t q m e l t p e p 2 4 implementation of the improved ifis system prototype in this study we found that the absence of snow processes in the modeling framework shortens the ability of hlm to predict streamflow efficiently especially in the midwest where snow plays a vital role in the water cycle we introduce a new simple parameterization as discussed in section 2 3 the methodology followed to implement the prototype flood forecasting system with the new parameterization is shown in fig 4 initially we tested this new set of odes using matlab ode solvers by writing a prototype code representing the vertical water flow in a single hillslope and solving the odes we could obtain preliminary results of patterns of water in each storage layer including swe from the newly added layer this allowed a proof of concept on whether the new parameterization could be representative of the actual process before altering the source code once tested successfully we updated the model source code by adding this improved hlm structure as a new model inside the numerical solver toolbox for hlm differential equations additional forcing of temperature can be provided in the format of regular storm files binary storm files or uniform storm files when the updated source code was ready we set up and compiled these source codes in crane a high performance computer of holland computing center at the university of nebraska lincoln the required forcings are made available in crane in hlm the inputs can be provided in several formats including ascii text files e g str ustr and mon files databases e g postgresql database and binary files in our case precipitation files are stored in binary format whereas temperature recordings are aggregated for the basin and provided through uniform storm ustr files then we manually tuned the parameters to obtain the realistic runoff from the model and compared them with observed usgs discharge measurements next we created a postgresql stonebraker and rowe 1986 database to insert observed discharge measurements from usgs stations and the newly installed sensors this postgresql database aids the smooth assimilation of sensor measurements into hlm we can add the real time measurements into this database and update the model simulated river discharges instantly to convert the stream level data measured by new sensors into streamflow data we developed rating curves the ifc developed a methodology to obtain a stage discharge relationship using the step backwater model with the hydrologic engineer center s river analysis system hec ras quintero et al 2021 we set up one dimensional 1d hydraulic models for every location where sensors are installed to obtain a stage discharge relationship supplementary fig 1 rating curves are subject to multiple sources of uncertainty in particular synthetic curves developed with hydraulic models are sensitive to the characterization of the channel geometry e g the number of cross sections and the spacing between them bottom slope and discretization of the finite element mesh among others as well as model parameters e g manning s roughness coefficient of the channel quintero et al 2021 the uncertainty for manning s roughness coefficient is not available because this parameter is not directly measured but assessed through a visual comparison of previous studies arcement and schneider 1984 despite extensive efforts to determine channel roughness its estimation continues to be subjective and can lead even for common situations to errors as high as 30 bray 1979 we downloaded the mrms data from the archives of iowa environmental mesonet of iowa state university these files were initially in grib format which we later cropped for the elkhorn region and converted to binary file format in holland computing center hpc these binary files are the fastest way for the model to read the forcing data since in this work we intend to show the potential of a flood forecasting system for nebraska through a retrospective analysis we forced the model for a time period of 2018 and 2019 of this 2018 is considered a spin up time for the model we saved the model snapshot at the end of 2018 hlm provides the option of saving the model stages at any timestep as a rec file and provided it as an initial condition for the 2019 simulation we also set up a postgresql database consisting of observed streamflow measurements from usgs from which we regularly update the model streamflow stages this process automatically replaces the model produced values with observed values at these locations the hlm works based on a system of ordinary differential equations arranged in a tree topology structure as discussed in section 2 2 the computation of solutions for this system of odes is achieved using the asynchronous asynch software package created by ifc small et al 2013 the primary application of asynch solvers is finding solutions for distributed hydrologic models of catchments asynch uses dense output runge kutta methods to solve the equations at each hillslope the input forcing such as precipitation potential evapotranspiration and temperature can be transferred through several file formats as well as taken from a structured query language sql database similarly we can produce outputs in different formats and display and use them for studies in the present world web interfaces are the most viable way of providing information to the public we developed a simple web interface code available in github repository that shows the stream network map of the elkhorn basin where the user can click anywhere and the hydrograph at that location will be displayed this web interface is developed using python with dash and plotly libraries plotly technologies inc 2015 we use mapbox tools to develop a basemap for this web interface fig 5 shows the screenshot of the web interface it is essential to note that this interface is a part of our prototype flood forecasting system and a preliminary version to set the ground for improvisation 2 5 bridge vulnerability for the eight newly installed sensor locations we estimated the vulnerability of bridges to flood peril two critical factors on which the bridge vulnerability depends are the time to peak at these locations and the elevation of bridges from the bottom of the river the higher the time to peak the lower the vulnerability and the higher the elevation of bridges the lower the vulnerability the time to peak values are calculated by ingesting the model with an arbitrary constant rainfall across the basin this was realized with the uniform storm files ustr type of forcing in hlm then we obtained the streamflow at these locations produced by the model and the time difference between the peak flow and centroid of the storm which gives time to peak the elevation of bridges from the bottom of the river was already measured during their installation once these two quantities were obtained simply plotting one across another would give a sense of the vulnerability of bridges to flood peril 3 results from the prototype system of odes created in matlab for initial validation with an additional storage layer for snow we obtained the simulated swe supplementary fig 3 shows the comparison of simulated swe with that of observed values from nsidc data we compared this for two different locations in nebraska initial results were satisfactory as the output from the new storage layer could pick up the swe patterns well supplementary fig 3b shows that the model produced similar values for the norfolk region in 2019 and 2020 however since these were preliminary results from a single grid data it does not represent the connection between different hillslopes as in hlm we simulated the hydrographs for 2019 as the historic flood during march is our point of interest flanagan et al 2019 using the currently used hlm and a new version of the model including the snow parameterization we compared both hydrographs with the observed hydrographs at five locations across the elkhorn basin the results suggest that the hlm with snow parameterization outperforms the current version of hlm in predicting the peak flow in the midwest during march 2019 fig 6 shows that the hlm without snow could not capture the peak flow at any seven stations in contrast the hydrographs from the model with snow parameterization show peaks corresponding to observed peaks this implies that snow processes majorly drove the flooding in march 2019 supplementary fig 5 shows the model simulated streamflow after assimilating the usgs data note that we could not use streamflow measurements from the newly installed sensors because they were not available at the time of the 2019 spring flood event fig 7 shows the plot between the time to peak and bridge elevation illustrating the different exposure levels of eight bridges across the elkhorn river basin the higher the time to peak the lower the vulnerability and the higher the elevation of bridges the lower the vulnerability therefore the vulnerability increases as we move closer to the plot s origin we can see that bridge near stuart ne is the most vulnerable to flood disasters whereas the bridge near norfolk ne is the least vulnerable the bridge vulnerability study demonstrates a practical application of hlm we can use this model to assess bridge vulnerability for any point in the river network given the height of the bridge highlighting its application of the model in the transportation sector fig 8 shows the results of synthetic rating curves obtained with the hydraulic model for each site the solid black line and the gray area around it show the median and the 5 and 95 quantiles of the uncertainty range based on the 100 rating curves using the model 4 discussion this study investigated the potential of a real time flood forecasting system for nebraska by implementing a prototype on the elkhorn river basin we used the hydrologic model hlm of the ifis system and enhanced it to account for snow processes our results demonstrate how a simple conceptual modification in the model can significantly improve its performance which is also supported by the literature mai et al 2022 roy et al 2017a in nebraska snow processes produce the major portion of runoff barnett et al 2005 a recent flood in 2019 showed the importance of snow generated runoff in the occurrence of peak flows flanagan et al 2019 by including snow parameterizations hlm could more realistically simulate the hydrology of snow processes thus improving its peak flow prediction performance we implemented the hlm source codes on the university of nebraska lincoln s high performance computer this flood forecasting framework can be expanded to a larger region including snow dominated areas with minimal requirements for forcing data since the hlm conducts simulations by solving odes at the hillslope scale which corresponds to the actual hydrologic processes it can provide discharge estimates at any stream location though the accuracy of the first few orders of streams can be low as seen in fig 6 the decomposition of hillslope links from the dem of a region can be done easily with the help of openly available tools github 2023 a major strength of hlm making it suitable for flood forecasting is that it is less susceptible to the spatial variability of parameters mantilla et al 2022 the error associated with each hillslope simulation gets canceled as it travels from lower to higher orders of streams a hypothesis proven by mandapaka et al 2009 while hlm can serve as a hydrologic model to simulate river discharge it requires further work to transform it into an operational real time flood forecasting system an operational flood forecasting system should include collecting and inputting the most recent forcing data such as precipitation and temperature depending on the model used solving the model across multiple basins assimilating the observed discharge data and potentially other variables from sensors and timely updating a user interface to disseminate the flood information to the stakeholders the most critical and challenging task is to make all these components run simultaneously and seamlessly in an automatic manner it is crucial to integrate real time forcing data with the maximum possible lead time there are several potential candidates for this for example multi radar multi sensor quantitative precipitation estimation mrms qpe rainfall products are useful to ensure lower latency which means that we can predict an imminent flood well ahead of time thereby providing effective early warning satellite based precipitation estimates can also be used for near real time streamflow monitoring roy et al 2017b 2017c 2020 numerical precipitation forecasts such as global forecasting systems gfs are useful for forecasting streamflow ahead of time streamflow information from upstream can be used to predict streamflow with lead time downstream furthermore time series modeling of streamflow can help generate forecasts with lead the ifc uses nexrad radar based rainfall accumulation data processed every 5 minutes from 7 radars covering iowa krajewski et al 2013 seo and krajewski 2015 every 15 minutes they pull the rainfall estimates up to the forecast issuance time to produce a streamflow forecast for up to 10 days one of the ways to potentially improve forecast skills would be through the use of robust quantitative precipitation forecasts qpf the efficiency of the qpf method used for flood forecasting is critical as the error in qpf would propagate to flow predictions in ifc exploring the potential of qpf methods is an ongoing activity krajewski et al 2017 we could also implement time series modeling using statistical and machine learning methods to estimate streamflow in any case it is important that the forecast errors and uncertainties are thoroughly analyzed and their sources are detected and addressed as necessary the flood forecasting system we worked on is based on hlm simulations and streamflow observations we could leverage data and resources from a variety of sources e g nws usgs usace noaa and integrate them into the proposed system this would enable us to disseminate several layers of information we can add open flow modeling to provide 3d flood inundation views at several locations across the state which would assist in efficient communication with the public this will require the collection and processing of bathymetry data of the channels inundation maps can be generated focusing on the communities and such maps can also assist national flood insurance program nfip establishing an operational flood forecasting system comes with multiple challenges one among them is integrating all components of the flood forecasting system efficiently this involves running the model collecting and assimilating data and circulating the information for such a task to accomplish we need experts from the fields of hydrology water resource engineering computer science and social science working together while hydrologists and water resource engineers work on the modeling and conceptual sides of the system computer scientists are necessary to aid them in terms of data management utilizing high performance computing resources and web interface social scientists can add different dimensions of the community and efficiently gather stakeholder feedback in nebraska we can utilize the holland computing center hcc at the university of nebraska lincoln for computational resources another big challenge in setting up an operational flood forecasting system is the calibration of the model across all basins in the state the hlm currently does not have an automatic calibration scheme to calibrate the model we have to identify sensitive parameters based on experience in model runs and manually tune the parameters to give the best results this process is supported by knowledge about the catchment properties manually calibrating the model is often tedious because it involves several trial and error simulations as there can be many combinations with few sensitive parameters one solution to this problem is to structure an automatic calibration framework for hlm the way hlm is set up i e at every hillslope it produces a large number of parameters for a given basin which can be computationally way too expensive to tackle for the commonly used automatic calibration algorithms however parameter regionalization techniques where distributed model parameters are derived from other hydroclimatic and catchment features can be useful in this regard in addition to the abovementioned challenges we must continuously monitor an operational flood forecasting system to maintain its efficiency some of the undertakings necessary to achieve this are 1 frequent examinations of the sensors 2 data management checking and filtering the data coming into the model 3 bug identification and fixing in the model source code and 4 upkeeping the web interface a dedicated team of experts is essential to accomplish these tasks along with that we must constantly work to pursue the challenges of model uncertainties and how the uncertainty in hydrologic predictions can be communicated to decision makers and the general public as proposed by 23 unsolved problems in hydrology blöschl et al 2019 from a technical standpoint it will be important to develop a system that translates the river stages obtained from model simulations to estimated flood depths and extends we could think of a python library that includes all the necessary functions for information extraction the ifc currently has a similar library which can be implemented for the nebraska basins this would help in the development of the information system for efficient communication with the public through interactive maps and other visualizations water infrastructures such as reservoirs and groundwater wells can influence the hydrologic processes which affect the occurrence of floods dang et al 2016 we have not looked into the role of water infrastructure in regulating floods in the region in this study nednr together with usace constructs various structures such as dams and levees to divert water away from areas that might cause more damage nednr 2022 it would be interesting to study how these structures impact flood mitigation 5 conclusions this article presents the methodology we followed to implement a flood forecasting system prototype for a pilot basin in nebraska we discuss the ifis system and our improvements to its underlying hydrologic model hlm to include snow processes we set up the components of a flood forecasting system prototype which includes 1 sensors measuring stream level 2 synthetic rating curves 3 hydrologic model upgraded hlm with necessary inputs 4 assimilation of the observed stream data into the model and 5 web interface we discuss the opportunities and challenges in developing a full fledged operational flood forecasting platform besides we analyzed the vulnerability of eight bridges to flood peril based on a methodology that can be expanded to other bridges our results substantiate the fact that incorporating snow processes is crucial in flood forecasting in cold regions e g nebraska in this case this was evident in the simulation of the 2019 spring flood where accounting for snow processes improved the simulation of the peak flow more specifically the addition of our proposed snow parameterizations to the hlm showed significant improvement in predicting the 2019 march flood in the elkhorn river basin as compared to the version of the model without snow parameterizations furthermore our results also show that oftentimes simple improvements to the model structure can significantly improve the accuracy of a model from a modeling perspective hlm appears to be a strong candidate for the operational implementation of a flood monitoring and forecasting platform in the state of nebraska findings from this work strongly support the idea of a statewide expansion of the platform and the development of an operational flood information system targeting community welfare and engagement a platform like this will also provide policymakers with accurate information and gainful facts about flooding in a timely manner thereby enabling more informed decision making software availability name of the software asynch hlm psnow developer sinan rasiya koya nicolas giron tirthankar roy contact information ssinanrk2 huskers unl edu year first available 2022 program language c source code availability https github com sinanrk asynch git program size 14 3 mb declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment funding for this research was provided by the mid america transportation center via a grant from the u s department of transportation s university transportation centers program usdot utc grant number for matc 69a3551747107 we also acknowledge the holland computing center hcc staff for their support with high performance computing and the ndot personnel who collected the channel data appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105693 
25402,this paper presents a technical approach to link a watershed model and surface water quality model to study the effects of agricultural conservation practices on the water quality of a receiving water body the annagnps watershed model was applied to simulate runoff and loads of sediment and nutrients into beasley lake the simulated results were used as boundary conditions for cche wq water quality model to simulate the concentrations of water quality constituents in the oxbow lake in this model the interactions between sediment and water quality constituents were considered this integrated modeling system can be used to simulate flow sediment and nutrient processes in both the watershed and waterbody systematically two modeling were calibrated and validated using measured data in beasley lake watershed the validated modeling system was applied to analyze the effects of cropping and tillage systems on the water quality of the receiving water body keywords annagnps cche wq integrated modeling system conservation practices beasley lake watershed data availability data will be made available on request 1 software and data availability two software was used for this study name of software annagnps version 5 6 developers ronald l bingner fred d theurer yongping yuan and encarnación v taguas first year available version 1 0 1998 version 5 6 2018 hardware requirement pc program language fortran program size 7 8 mb availability https www ars usda gov southeast area oxford ms national sedimentation laboratory watershed physical processes research docs annagnps pollutant loading model license free name of software cche wq developers xiaobo chao yafei jia and tingting zhu first year available version 1 0 2006 version 2 0 2019 hardware requirement pc program language fortran program size 10 5 mb availability https www ncche olemiss edu cche2d3d wq license free model test data available in the installation package 2 introduction managing water quality of freshwater resources is challenging but necessary for the benefit of human health economic development and ecosystem integrity anthropogenic changes to water quality can negatively impact aquatic ecosystem services and result in eutrophication hypoxia and decreased biodiversity while internal processes are important inputs from agricultural production and practices in watersheds drive water body responses through additions of sediment nutrients and other pollutants conservation practices cps such as edge of field buffers cover crops and conservation tillage have been used to reduce nonpoint source pollution the effectiveness of these practices is generally evaluated in terms of the reductions of nonpoint source runoff pollution therefore linking information from watershed loads to the receiving waterbodies is critical for developing a useful tool to evaluate the overall effectiveness of cps implemented in watersheds for water quality management in recent years watershed models including annualized agricultural nonpoint source pollution annagnps bingner et al 2018 soil water assessment tool swat neitsch et al 2011 hydrological simulation program fortran hspf bicknell et al 2001 and mike systeme hydrologique europeen mike she dhi 2014 have become useful and effective tools to assess the effectiveness of cps in reducing loads of runoff sediment nutrients or other pollutants in the watershed chaubey et al 2010 xie et al 2015 borah et al 2019 however these measures may have limitations by just considering the runoff response without considering the receiving waterbody response to various cps surface water quality models e g water analysis simulation program wasp wool et al 2001 corps of engineers integrated compartment water quality model ce qual icm cerco and cole 1995 delft3d water quality model delft3d waq delft hydraulics 2003 environmental fluid dynamics code efdc ji 2008 and center for computational hydroscience and engineering water quality model cche wq chao et al 2010 have been effectively applied to assess water quality in surface water bodies however those models need inlet discharge and nutrients sediment concentrations where the measured data are normally not available linking a watershed model is a mean to approximate inflow conditions to better simulate water quality conditions within waterbodies the annagnps model has been widely applied to simulate runoff sediment erosion and nonpoint sources pollutants in many watersheds baginska et al 2003 abdelwahab et al 2018 momm et al 2019 nahkala et al 2021 wangbingner et al 2021 cche wq model has been successfully applied to simulate surface water quality constitutes in receiving waterbodies camacho et al 2019 chao et al 2010 2021 therefore both models were selected to develop an integrated modeling system for the water quality management the objectives of this research are to 1 develop a technical approach to link the annagnps watershed model and cche wq water quality model to study the flow sediment and nutrient processes throughout the entire watershed system 2 use the integrated modeling system to analyze the response of water quality in a surface water body to the agricultural conservation practices in this system annagnps was applied to simulate the runoff and loads of sediment and nutrients exported from the watershed simulated results were used as boundary conditions for cche wq to simulate concentrations of sediment nutrients and phytoplankton in receiving waterbodies in recent years annagnps and cche wq have been successfully applied to simulate the flow sediment and water quality in beasley lake watershed blw fig 1 an agricultural watershed in mississippi usa locke et al 2008 yuan et al 2008 lizotte et al 2017 chao et al 2018 locke et al 2020 yasarer et al 2020 the proposed technical approach was tested using blw the integrated modeling system was first calibrated and validated using measured data under the existing conditions it was then applied to simulate scenarios with various cropping and tillage systems this system can be used to analyze the responses of water quality in both the watershed and receiving waterbody to various agricultural practices and evaluate the effectiveness of cps in improving water quality 3 materials and methods 3 1 study site blw located in sunflower county mississippi is a relatively closed system the sunflower river levee defines the northern part of the watershed boundary and a large forested area is located on the eastern side of the watershed fig 1 it was selected as one of the conservation effect assessment project ceap benchmark watersheds to assess environmental benefits derived from implementing usda conservation programs the watershed has a total drainage area of approximately 6 25 km2 and the receiving beasley lake is an oxbow lake 0 25 0 30km2 formed from a cutoff meander of the sunflower river surface water quality in this region suffers from excessive nonpoint pollutants such as nutrients sediment and pesticides that are transported from agricultural fields cps such as constructed wetlands establishment of grassed buffers sediment retention ponds reduced no tillage have been implemented in this watershed to reduce nonpoint source pollution locke 2004 2008 lizotte et al 2021 from 2002 to 2004 weekly 2002 to biweekly 2003 2004 lake surface water samples top 10 cm were collected at stations b1 b2 and b3 by researchers at national sedimentation laboratory nsl lake in situ water quality measurements of temperature conductivity ph and dissolved oxygen do were collected simultaneously with surface water sampling using a calibrated ysi 556 handheld multiparameter meter yellow springs instruments inc yellow springs oh usa water samples were preserved on wet ice and transported to nsl for laboratory water chemistry analysis water quality variables of suspended sediment dissolved nitrogen nitrite and nitrate attached organic nitrogen dissolved inorganic phosphorus po4 attached organic phosphorus and chlorophyll a were measured according to methods described in lizotte et al 2014 2017 2021 runoff water quality samples were collected from 1996 to 2000 at two sites bl1 bl3 fig 1 using automated samplers isco model 3700 portable sampler isco inc lincoln ne usa and runoff flow was measured using acoustic doppler instruments isco model 4150 and 4250 flow logger and meter isco inc lincoln ne usa samples collected were flow proportional bulk composite during each runoff event and then sub sampled in the laboratory prior to analysis sub samples were analyzed for total suspended sediment and nutrient concentrations nutrients included dissolved nitrogen nitrite and nitrate attached organic nitrogen dissolved inorganic phosphorus po4 and attached organic phosphorus rebich 2004 those measured water quality and runoff data were used for model calibration and validation the average water depth of the lake is about 2 1 m and wind shear is the major driving force for flow hydrodynamics due to wind driving this relatively closed lake system can be considered a well mixed system previously published research conducted on the beasley lake measured water quality data showed that after accounting for seasonal and year to year variation variations of lake surface water quality constituents at stations b1 b2 and b3 were not statistically significantly different from one another and could be combined lizotte et al 2014 2017 2021 therefore a well mixed model was developed based on cche wq to simulate the lake water quality 3 2 integrated modeling system this is the first time the annagnps watershed model and cche wq water quality model were linked together to simulate flow sediment and nutrient processes throughout the entire watershed and receiving water body fig 2 land management and watershed processes were simulated with annagnps v5 6 and resulting runoff and loads of sediments and nutrients were used as inlet boundary conditions for the cche wq model to simulate water quality constituents in the receiving waterbody the alternative cps can be set as input conditions for annagnps and their effects on the water quality in both the watershed and receiving waterbody can be analyzed using this integrated modeling system 3 3 annagnps model annagnps version 5 6 generates results at a daily time step but was designed to simulate long term chemical and sediment dynamics within agricultural watersheds bingner et al 2018 the basic model structure consists of hierarchical cells that are connected to reaches where flow is simulated and routed through the watershed using topographic inputs the topographic parameterization tool for annagnps topagnps module subdivides the watershed into cells that are connected to a simulated channel network the cell size and channel network are created based on the concentrated source area csa and minimum source channel length mscl settings the spatial variability of soils and land use are accounted for by overlaying these geospatial layers with the cell mesh or manually inputting characteristics for individual fields cells runoff sediment and pollutant loadings can be predicted from precipitation rain or snow and irrigation events at this time groundwater interactions were not considered in the model in this annagnps simulation for blw the cells and stream network of a watershed were generated based on a 1 m resolution light detection and ranging lidar derived digital elevation model dem using the topagnps module the dem was manually corrected to represent flow through culverts and ditches to represent hydrology within the watershed the original lidar data can be found at the usgs lidar explorer map nationalmap gov the simulation had an average cell size of 0 0075km2 and median size of 0 0042km2 using a concentrated source area csa setting of 1 m and a minimum source channel length mscl of 25 m soil properties were obtained from the natural resources conservation service nrcs soil web survey database for sunflower county mississippi nrcs 2020 the spatially dominant soil type in each cell was used to represent the conditions of that cell land use was manually assigned to cells based on management data supplied by producers general management operation schedules were developed for each crop and tillage practice using long term records volunteered from producers in the watershed and combined with the corresponding operation from the revised universal soil loss equation rusle management database management schedules used in each scenario simulation are reported in supplementary table 1 s table 1 daily minimum and maximum temperature and precipitation inputs were obtained from the beasley lake nrcs soil and climate analysis network scan weather station for the duration of the model warm up and simulation period with gaps in the data infilled from the nearest global historical climate network weather station in moorhead ms ghcnd usc00226009 33 45 n 90 5167 w approximately 16 kilometers northeast of beasley lake dew point and solar radiation were generated by the annagnps version of climate data generator model gem hanson and johnson 1998 for beasley lake watershed simulation the model was set with a 2 year warm up period followed by a simulation starting from 1995 until 2014 the simulation results in the period of 1 1 2002 12 16 2004 was chosen for model evaluation the runoff from each cell was calculated using the soil conservation service curve number cn method usda soil conservation service 1985 the model routes the physical and chemical constituents from each cell into the stream network and finally to the watershed outlet in this watershed all runoff is directed into ditches which drain into beasley lake there is no baseflow in these ditch systems and therefore no need to separate streamflow into baseflow and runoff components in general the outputs of annagnps include runoff suspended sediment ss at multiple grain sizes dissolved and sediment associated nitrogen and phosphorus and several pesticides all model outputs can be obtained at any desired location such as specific cells stream reaches feedlots gullies or point sources for blw the outputs include time series of runoff loads of dissolved nitrogen assumed to be primarily nitrate no3 dissolved and attached adsorbed inorganic phosphorus i e po4 attached nitrogen i e organic nitrogen on attached organic phosphorus op and ss these data can be converted to time series of runoff flow discharge m3 s and concentrations of no3 po4 on op and ss mg l and used as inlet boundary conditions for cche wq to simulate water quality constituents in beasley lake the critical input data for the annagnps model was listed in table 1 3 4 cche wq model cche wq simulates temporal and spatial variations of the major water quality interacting processes including phytoplankton kinetics nutrient cycles and dissolved oxygen balance the concentrations of eight general water quality constituents ammonia nh4 no3 po4 phytoplankton as chlorophyll a chl carbonaceous biochemical oxygen demand cbod dissolved oxygen do on and op are simulated the sediment associated water quality processes including the effect of ss on the growth of phytoplankton adsorption desorption between nutrients and ss and release of nutrients from bed sediment are also simulated in cche wq the phytoplankton biomass is represented by the concentration of chl which can be obtained from the growth rate death rate and settling rate of phytoplankton the growth rate is mainly affected by the availability of nutrients light and temperature wool et al 2001 1 p g p max k n k l k t where p g is the growth rate of phytoplankton day 1 p max is the maximum growth rate day 1 k n k l and k t are growth factors due to inorganic nutrients light and water temperature which have ranges between 0 and 1 the light growth factor k l is obtained by integrating steele s equation over one day of time interval and water depth ditoro et al 1971 chapra 1997 2 k l 2 72 f d k a h exp i s d f d i o e k a h exp i s d f d i o where f d is the fractional daylength 0 f d 1 h is the water depth m i sd is the daily averaged light intensity at the water surface ly day i o is the optimal light intensity for phytoplankton growth ly day k a is the light attenuation coefficient m 1 which can be expressed by wool et al 2001 chao et al 2007 3 k a k b 0 0088 c c h l 0 054 c c h l 0 67 0 0452 c s where k b is the background light extinction coefficient m 1 c chl is the concentration of chlorophyll μg l and c s is the ss concentration mg l eq 3 shows that k a is significantly affected by the ss concentration the temperature growth factor k t can be calculated using the formula proposed by cerco and cole 1995 in which k t increases to the maximum value 1 at an optimal temperature and then decreases at higher temperatures in the numerical models the optimal temperature is normally set as one value and this value may vary with species in cche wq model the optimal temperature can be set as one value or a range processes of adsorption desorption between dissolved nutrients and ss are much faster than biological reactions therefore these processes can be assumed to reach equilibrium instantly at each time step in the numerical model wool et al 2001 in cche wq the processes of adsorption desorption were described by the langmuir isotherm and the dissolved and particulate nutrient concentrations were calculated using the formula proposed by chao et al 2010 4 c d 1 2 c 0 1 k a d c s q m c 0 1 k a d c s q m 2 4 c s q m k a d 5 c p 1 2 c 0 1 k a d c s q m c 0 1 k a d c s q m 2 4 c s q m k a d where c d and c p are dissolved and particulate nutrient concentrations mg l respectively c 0 is the nutrient initial concentrations mg l k ad is the equilibrium partition coefficient l mg q m is the maximum adsorption capacity mg n mg ss and c s is the concentration of ss mg l the release rate of nutrients from bed sediment is determined by the gradient of nutrient concentrations across the water sediment interface ditoro et al 1971 momm et al 2017 and it is also affected by water temperature dissolved oxygen do concentration and ph value at the bed sediment layer romero et al 2003 the bed release rate was calculated using the formula proposed by chao et al 2010 6 s b e d k d c b c w θ b t 20 k d o k d o c d o p h 7 k p h p h 7 where s bed is the bed release rate of nutrients g m 2 day k d is the diffusive exchange coefficient m day at the water sediment interface c w and c b are the dissolved concentration of nutrients in water and bed sediment layer mg l respectively θ b is the temperature coefficient c do is the do concentration at the bed sediment layer mg l k do is the release parameter due to the do concentration mg l k ph is the release parameter due to the ph the variations of spatial distributions of water quality constituents in beasley lake are very small and this lake can be considered as a well mixed system lizotte et al 2014 cche wq was integrated into a well mixed flow model to simulate the concentrations of water quality constituents the water balance equation can be written as 7 d v d t d a h d t q i n q o u t q e q p q g where v is the volume of the lake water m 3 t is the time s a is the surface area of the lake m 2 h is the water depth m q in is the inflow discharge m 3 s and can be obtained from annagnps q out is the outflow discharge m 3 s q e is the flow decreasing rate due to the evaporation m 3 s q p is the flow increasing rate due to the precipitation m 3 s q g is the groundwater discharge m 3 s the general mass balance equation of a well mixed lake can be written as 8 d c v d t q i n c i n q o u t c v s c where c is the concentration of mass mg l which can be the concentrations of chlorophyll nutrients and ss c in is the mass concentration in the inflow mg l and can be obtained from annagnps σs c is the effective source terms of mass mg l s which can be calculated by 9 s c s r s s e t s b e d h where s r is the source term due to chemical and biological reactions mg l s which can be calculated for each water quality constituent chao et al 2010 s set is the sink term due to settling mg l s s bed can be calculate using eq 6 in a well mixed model water depth water volume and surface area are important variables to simulate the water balance eq 7 in the model simulation the computational domain in the horizontal direction is generated using the two dimensional cche mesh generator at each generated grid the corresponding water depth can be obtained based on the simulated water surface elevation and the local bed elevation therefore the water volume of the lake and its surface area can be calculated with high accuracy at each time step when the water surface elevation changes the water volume as well as the surface area can also be obtained accordingly in a general well mixed model it is assumed that the transportation of mass can be ignored and the mass concentrations in the water body are uniformly distributed horizontally and vertically however eq 2 shows the phytoplankton growth factor due to light is significantly affected by the local water depth in the lake using the generated 2d computational mesh the local water depth can be obtained and the growth factor at each grid can be calculated at each time step this model takes the advantage of 2d computational mesh to calculate the source terms eq 8 of each individual element and integrate them for solving the total mass in the water body which significantly improve the accuracy of mass balance in the model for the cche wq simulations in beasley lake the daily runoff nutrient and ss loads were provided by annagnps and converted to time series inlet boundary conditions as described above the bed elevations of the lake were measured by nsl the climate data including hourly wind solar radiation air temperature and relative humidity and daily precipitation were obtained from the usda nrcs national water and climate center scan site beasley lake nrcs 2020 the model was applied to simulate the water surface elevation temperature and concentrations of ss nutrients and chlorophyll chl in the model simulation the time step was set to 3600 seconds the critical input data for cche wq model was listed in table 1 3 5 integrated model test calibrations validations and simulation scenarios of conservation tillage practices the integrated models fig 2 were tested using blw under the existing conditions year 2002 2004 as the watershed simulation used land cover and management practices based on farmer reported information the conditions were mostly soybean with a small amount of wheat cotton and milo planted in 2002 in annagnps and cche wq models there are some empirical formulas which may cause uncertainties for model simulations to reduce the uncertainties and improve the model applicability it is often necessary to conduct model calibration and validation salimi et al 2016 ahmadisharaf et al 2019 for calibration runs the model parameters in the cche wq model were adjusted repeatedly to obtain a reasonable reproduction of the field measured data for model validation those calibrated parameters were kept same the simulated results were compared to the field measurements and performances of the integrated models were assessed using statistical analysis the annagnps model has been developed to utilize input parameters from publicly available databases as well as information collected in house such as climate soil and crop management operations as beasley lake is a small watershed and most of the model inputs are well known due to extensive local work in this watershed this reduces the needs for calibration of model parameters in general annagnps model parameters require little to no calibration since the model utilizes readily accepted databases for users to describe the model inputs and has been shown to produce acceptable results in the study region as well as many watersheds around the world yuan et al 2003 2005 das et al 2008 chahor et al 2014 many parameters in the cche wq model need to be manually calibrated the recommended range of each parameter was obtained from laboratory field measurements or suggested by others ditoro et al 1971 wool et al 2001 bubba et al 2003 chao et al 2010 table 3 simple sensitivity analysis was conducted to determine the realistic parameters for beasley lake water quality simulation in the water quality model phytoplankton is the most important constituent and the parameters related to its growth death such as the maximum growth rate optimal light intensity for phytoplankton growth and background light extinction coefficient were calibrated first all the calibrated parameters listed in table 3 were kept same for the model validation run the annagnps model simulated runoff were statistically assessed with measured data using the coefficient of determination r2 nash sutcliffe efficiency nse and percent bias pbias the cche wq simulated water quality constituents and were assessed using mean error root mean square error rmse normalized rmse rmse observed mean index of agreement d willmott 1984 and correlation coefﬁcient r computed for each case to evaluate model performance after model validation the capabilities of integrated modeling system were tested for analyzing the sensitivity of cropping and tillage systems on the lake water quality in blw six simulation scenarios were designed three variations of tillage including no tillage no till reduced tillage red till and conventional tillage conv till for two different crops cotton and soybeans conceptually conventional tillage involves the most disturbance to soil structure and is generally described as tillage and bed preparation in the fall after crop harvest with tillage again in the spring prior to planting the next crop locke et al 2020 reduced tillage is an agricultural best management practice that reduces the frequency and intensity of conventional tillage described above and is a recommended usda natural resources conservation usda nrcs practice in the united states to mitigate topsoil erosion usda nrcs practice 345 no tillage management is an agricultural best management practice where cropped soil is not tilled in any condition to further mitigate topsoil erosion and improve soil health and is a recommended usda nrcs practice in the united states usda nrcs practice 329 these practices were chosen as they were used throughout the watershed during the study period cotton and soybeans are also common crops in the mississippi delta soybeans have been the dominant crop since the 1960 s and cotton has historically been important with less acreage planted recently yasarer et al 2020 within blw there was a transition from predominately cotton to soybean around 2002 lizotte et al 2021 therefore these crops were chosen within the scenarios to test the integrated modeling system as those designed scenarios were used to analyze the effects of tillage and associated crops on the lake water quality the crop was set as monocrop and the management operations in each year were set to be the same supplementary table 1 s table 1 lists the dates and management operations for each crop tillage scenario in the annagnps simulations the dates of these management practices were estimated based on typical schedules and did not reflect the intricacies of implementing these practices around weather wet fields and multiple fields on a farm in the soybean simulations no fertilizer was added as this was not observed within the watershed however in the cotton simulations nitrogen fertilizer was applied using average rates from the management history 4 results and discussion 4 1 calibration and validation of the integrated modeling system for the annagnps model calibration run the curve number was adjusted repeatedly to obtain a reasonable reproduction of the field measured data but the best results were found with the original curve number value which was calculated based on the land use soil type and antecedent soil moisture annagnps has been previously applied to simulated runoff sediment and nutrients in blw yuan et al 2003 2005 2008 yasarer et al 2017 lizotte et al 2017 the recommended model parameters from previous studies including initial contents of nutrients in soil plant nutrient uptake ratios nutrient mineralization ratio were used in this study table 2 the daily loads of runoff sediment and nutrients in blw were simulated a three year period from 1 1 2002 to 12 16 2004 was chosen for model runoff validation fig 3 shows the simulated runoff are generally in agreement with measured data in bl1 and bl3 sub watersheds with the r2 values of 0 721 and 0 816 nse values of 0 7 and 0 51 pbias values of 1 43 and 5 3 respectively a period from 1 1 2002 to 12 31 2002 was selected for the cche wq model calibration run to run a new case initial conditions may cause some uncertainties for model simulations to reduce those uncertainties a one week warm up period was used for modeling in this period the water level and water quality conditions were same as their initial conditions to determine the calibrated parameters simple sensitivity analysis was conducted based on the recommended ranges of each parameter table 3 the simulated results were compared with field measurements in beasley lake fig 4 for model validation run to reduce the uncertainties caused by the initial conditions the starting time for model simulation was set as same as that for model calibration run 0 00 1 1 2002 a period from 1 1 2002 to 12 16 2004 two years longer than calibration period was chosen for model validation the time series of temperature and concentrations of nh4 no3 po4 chl bod do on op and ss were obtained using cche wq fig 4 shows the simulated concentrations of chl nh4 no3 and po4 concentrations in the lake in comparison to measured values supplementary table 2 s table 2 summarizes the statistical analysis of the observed and simulated temperature t chl nh4 no3 po4 on and ss concentrations in the lake temperature was accurately predicted with low mean error and high index of agreement chlorophyll trends were also captured by the model fig 4a but overall underpredicted by about 22 s table 2 the model was not able to reproduce temporal trends as accurately as the mean value such a dissonance in measured and predicted values could be due to the biweekly measured timestep which did not overlap with the hourly simulated time step it is well known the phytoplankton processes are highly complex and challenging to simulate and need further study to mathematically replicate the mean value of nh4 concentrations were very low 0 03mg l during the simulation period in summer due to the uptake of phytoplankton the concentration of nh4 could be lower than 0 01mg l the simulated mean concentration of nh4 is about 10 greater than the measured data fig 4b s table 2 for no3 the model captured the general trend in winter and spring no3 is slightly higher due to higher rainfall runoff and erosion fig 4c simulated mean value was 1 1 overestimated like chl the rmse is also relatively high for no3 s table 2 observed data in beasley lake showed that po4 is relatively high and the no3 and nh4 are limiting nutrients for the growth of phytoplankton lizotte et al 2017 therefore the growth of phytoplankton significantly affects no3 concentrations and errors in simulating chl may also affect the accuracy of no3 results po4 concentrations were generally in agreement with the observed data fig 4d compared with the measured po4 data the simulated mean value is about 22 overestimated concentrations of on op and ss were also simulated and compared with available measured data on and ss like the above presented simulation results the model captures the general trends of the measured data with simulated mean errors 20 s table 2 based on these results the model seemed capable of reproducing general patterns of water quality constituents mean values of the model results were in good agreement with measured data and simulated mean errors were normally 20 simulated trends for phosphorus were much better than that for nitrogen model capability for simulating time series of water quality constituents was not as good as the mean values especially for nitrogen and chlorophyll chlorophyll dynamics were particularly challenging to predict as there are many algal species that may peak at different times throughout the season due to the availability of micro and macro nutrients lizotte et al 2014 2017 with nitrogen availability and chlorophyll production so closely tied in this system error propagates from the prediction of one component to the other another potential reason for errors in simulating the water quality time series are the mismatches in frequency of sample collection compared to model output in addition the errors of inlet boundary conditions produced by annagnps may also affect lake water quality simulations however the model results are reasonable especially for providing long term predictions and comparisons of different outcomes from watershed management scenarios 4 2 effects of conservation tillage practices on water quality 4 2 1 cotton tillage scenarios to compare the effect of tillage for cotton scenarios the values from the conv till were used as the benchmark in general no till and red till practices reduced the soil erosion and they increased the runoff by 2 and 8 compared to the conv till scenario red till and no till could reduce the loads of ss to 62 and 36 of the amounts of conv till s table 3 with respect to nutrients red till and no till generally reduced nutrient loads except for no3 red till and no till reduced po4 by 9 and 16 of the amounts of conv till however no3 increased by 18 and 6 due to the application of nitrogen fertilizer and slightly increased runoff s table 3 the main differences between conv till red till and no till were the reduction of soil disturbance due to the application of additional nitrogen fertilizer red till and no till resulted in more no3 released from the fields as red till had higher runoff the loads of no3 were slightly greater than that for no till fig 5 shows the time series concentrations of water quality constitutions in the lake for three cotton tillage scenarios ss concentrations were mainly affected by runoff loads from the watershed during periods with higher ss loads the concentration of lake ss was also higher red till and no till reduced mean ss concentrations by 62 and 37 of the amount of conv till s table 4 which were consistent to reductions in ss loads in the watershed in winter and spring ss concentrations were generally higher than those in summer and fall compared with the conv till for cotton red till and no till increased the mean chl concentrations by about 32 and 36 respectively s table 4 growth of phytoplankton is mainly affected by inorganic nutrients and ss in the lake increases of inorganic nutrients can promote phytoplankton growth while ss could increase the light attenuation coefficient k a in eq 3 and limit phytoplankton growth red till and no till reduced the concentrations of lake inorganic nutrients which may reduce the growth of phytoplankton i e concentration of chl however they also reduced ss concentration which may increase the light growth factor k l in eq 2 and promote phytoplankton growth and eventually increase chl concentration in most of the simulation periods conv till had the lowest chl concentration fig 5a however in some periods with lower ss concentration such as may june september 2002 march 2003 april september 2004 relatively higher nutrient concentrations resulted in a higher phytoplankton growth rate conv till had the highest chl concentration red till and no till reduced nutrients and ss and increased the chl concentrations in most simulation periods but for periods with lower ss concentration they reduced chl concentrations model results indicate a threshold period where ss concentrations are low enough where light is not limiting phytoplankton growth but nutrients are abundant enough to stimulate growth better control of algal blooms would require additional cps to further reduce nutrients during these periods lake nutrient concentrations are affected by the nutrient loads as well as lake biogeochemical processes phytoplankton growth needs inorganic nutrients while organic nutrients may be released due to phytoplankton senescence additionally organic nutrients can be converted to inorganic nutrients due to mineralization in these scenario studies it was assumed that all dissolved inorganic nitrogen was mainly in the form of no3 so there was no simulated nh4 load from the watershed fig 5b shows nh4 concentrations in the lake were relatively low and were not directly influenced by tillage practices however tillage practices affected chl concentrations and other nutrients which may influence nh4 concentration for no3 red till and no till increased loads by 18 and 6 relative to conv till s table 3 however they reduced lake no3 concentration by 33 and 57 relative to conv till s table 4 lake no3 concentrations are influenced not only by loads but also by lake biogeochemical processes such as nitrification mineralization and phytoplankton growth death while red till and no till scenarios produced slightly higher no3 loads they also reduced ss increased water clarity increased phytoplankton growth which resulted in no3 reductions in the lake fig 5c shows no till practice reduced no3 concentrations in all simulation periods while red till reduced the concentration in almost all periods except a short period in june 2003 in this period red till no3 loads were much higher than conv till and resulted in higher lake no3 concentrations higher no3 loads could affect the lake no3 for a short period in general red till and no till reduced mean lake no3 concentrations similar to other nutrients red till and no till reduced loads of po4 and sediment into the lake which resulted in lake po4 concentrations reduced for the entire simulation period with mean concentrations reduced by 26 and 31 compared to conv till fig 5d s table 4 4 2 2 soybean tillage scenarios except for no3 nutrients and ss loads from the soybean scenarios were similar in magnitude to the cotton scenarios nitrate was nine times lower in soybean scenarios compared to cotton because nitrogen fertilizer was not applied values of conv till for soybean were set as a benchmark for comparison in general red till and no till reduced soil erosion and they slightly increased runoff by 8 compared to the conv till scenario red till and no till reduced loads of ss to 57 and 21 compared to conv till red till and no till scenarios reduced nutrient loads from the watershed for inorganic nutrients red till and no till reduced no3 by 39 and po4 by 13 and 22 compared to conv till s table 5 within the lake fig 6 shows the time series lake water quality concentrations for three soybean tillage scenarios similar to cotton scenarios ss concentrations were only affected by watershed loads in periods with higher ss load lake ss concentration was also higher red till and no till reduced mean ss concentrations to 56 and 21 of conv till amounts s table 6 which were very close to watershed ss loads in general during winter and spring ss concentrations were higher than summer and fall general trends of chl concentration were similar in both soybean and cotton scenarios since there was no fertilizer applied to soybean scenarios mean chl concentrations for conv till red till and no till were lower than cotton scenarios mean chl concentrations for the three soybean tillage scenarios were quite close and their differences were about 5 s table 6 in general conv till had the highest nutrient and ss concentrations and nutrients may stimulate the phytoplankton growth while ss can limit its growth for most of the simulation period conv till had the lowest chl concentration because of relatively higher ss concentrations however in some periods with lower ss concentrations such as september 2002 march 2003 and april and september 2004 relatively higher nutrient concentrations and higher phytoplankton growth rate conv till had the highest chl concentration fig 6a general trends of concentrations of inorganic nutrients for the three soybean tillage scenarios were similar to those for cotton scenarios fig 6b d lake nh4 concentrations were relatively low and were not sensitive to tillage practices lake nh4 could be influenced by chl concentrations and other nutrients red till and no till could reduce concentrations of nh4 by 17 and 31 compared to conv till red till and no till reduced the mean and time series concentrations of nutrients no3 po4 throughout the simulation period since there was no additional nitrogen fertilizer applied for soybean scenarios mean no3 concentrations were lower than those for cotton scenarios while po4 concentrations were similar to the cotton scenarios for inorganic nutrients red till reduced no3 by 68 and po4 by 22 compared to conv till while no till could further reduce no3 by 84 and po4 by 29 compared to conv till s table 6 5 conclusions an integrated modeling system was successfully developed linking the annagnps watershed model with cche wq lake water quality model to simulate flow sediment and nutrients processes throughout the entire watershed waterbody system in the integrated system annagnps produced runoff loads of nutrients no3 po4 on and op and ss that were converted to inlet boundary conditions for cche wq to simulate water quality in the receiving waterbody this integrated modeling system can provide acceptable inflow boundary conditions for receiving water body where the measured data is not available this system provides useful tools to analyze the agricultural practices on the water quality in the watershed and receiving water body these integrated models were calibrated and validated using measured data in blw simulation results demonstrated the integrated model system reproduces the general patterns of the water quality constituents reasonably with mean values of modeled results in general agreement with measured data the simulated trends and magnitudes for phosphorus were better than that for nitrogen or chlorophyll in the lake model components the validated modeling system was applied to simulate six agricultural scenarios of varying tillage practices and crops within blw to analyze the lake water quality responses modeled results showed conv till red till and no till reduced watershed loads and lake ss concentration for both cotton and soybean scenarios in general red till and no till reduced nutrient loads except no3 for cotton scenarios due to the additional application of nitrogen fertilizer however they reduced lake nutrient concentrations lake chl concentration is mainly impacted by inorganic nutrients and ss and there is a need to better understand the relationship between lake nutrients ss and phytoplankton to improve model performance this study demonstrates the capabilities of integrated watershed and water quality modeling system for analyzing lake water quality responses to the agricultural practices this integrated modeling system can be used to assess the impact of alternative cps on the water quality for the entire watershed which is useful to evaluate trade offs in management practices for water quality improvement declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported in part by the u s department of agriculture agricultural research service through the cooperative agreement no 6060 13000 030 00d between the usda ars national sedimentation laboratory usda ars nsl and the university of mississippi national center for computational hydroscience and engineering ncche it is also partially funded by nasa s applied sciences water resources program award 80nssc22k0932 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105691 
25402,this paper presents a technical approach to link a watershed model and surface water quality model to study the effects of agricultural conservation practices on the water quality of a receiving water body the annagnps watershed model was applied to simulate runoff and loads of sediment and nutrients into beasley lake the simulated results were used as boundary conditions for cche wq water quality model to simulate the concentrations of water quality constituents in the oxbow lake in this model the interactions between sediment and water quality constituents were considered this integrated modeling system can be used to simulate flow sediment and nutrient processes in both the watershed and waterbody systematically two modeling were calibrated and validated using measured data in beasley lake watershed the validated modeling system was applied to analyze the effects of cropping and tillage systems on the water quality of the receiving water body keywords annagnps cche wq integrated modeling system conservation practices beasley lake watershed data availability data will be made available on request 1 software and data availability two software was used for this study name of software annagnps version 5 6 developers ronald l bingner fred d theurer yongping yuan and encarnación v taguas first year available version 1 0 1998 version 5 6 2018 hardware requirement pc program language fortran program size 7 8 mb availability https www ars usda gov southeast area oxford ms national sedimentation laboratory watershed physical processes research docs annagnps pollutant loading model license free name of software cche wq developers xiaobo chao yafei jia and tingting zhu first year available version 1 0 2006 version 2 0 2019 hardware requirement pc program language fortran program size 10 5 mb availability https www ncche olemiss edu cche2d3d wq license free model test data available in the installation package 2 introduction managing water quality of freshwater resources is challenging but necessary for the benefit of human health economic development and ecosystem integrity anthropogenic changes to water quality can negatively impact aquatic ecosystem services and result in eutrophication hypoxia and decreased biodiversity while internal processes are important inputs from agricultural production and practices in watersheds drive water body responses through additions of sediment nutrients and other pollutants conservation practices cps such as edge of field buffers cover crops and conservation tillage have been used to reduce nonpoint source pollution the effectiveness of these practices is generally evaluated in terms of the reductions of nonpoint source runoff pollution therefore linking information from watershed loads to the receiving waterbodies is critical for developing a useful tool to evaluate the overall effectiveness of cps implemented in watersheds for water quality management in recent years watershed models including annualized agricultural nonpoint source pollution annagnps bingner et al 2018 soil water assessment tool swat neitsch et al 2011 hydrological simulation program fortran hspf bicknell et al 2001 and mike systeme hydrologique europeen mike she dhi 2014 have become useful and effective tools to assess the effectiveness of cps in reducing loads of runoff sediment nutrients or other pollutants in the watershed chaubey et al 2010 xie et al 2015 borah et al 2019 however these measures may have limitations by just considering the runoff response without considering the receiving waterbody response to various cps surface water quality models e g water analysis simulation program wasp wool et al 2001 corps of engineers integrated compartment water quality model ce qual icm cerco and cole 1995 delft3d water quality model delft3d waq delft hydraulics 2003 environmental fluid dynamics code efdc ji 2008 and center for computational hydroscience and engineering water quality model cche wq chao et al 2010 have been effectively applied to assess water quality in surface water bodies however those models need inlet discharge and nutrients sediment concentrations where the measured data are normally not available linking a watershed model is a mean to approximate inflow conditions to better simulate water quality conditions within waterbodies the annagnps model has been widely applied to simulate runoff sediment erosion and nonpoint sources pollutants in many watersheds baginska et al 2003 abdelwahab et al 2018 momm et al 2019 nahkala et al 2021 wangbingner et al 2021 cche wq model has been successfully applied to simulate surface water quality constitutes in receiving waterbodies camacho et al 2019 chao et al 2010 2021 therefore both models were selected to develop an integrated modeling system for the water quality management the objectives of this research are to 1 develop a technical approach to link the annagnps watershed model and cche wq water quality model to study the flow sediment and nutrient processes throughout the entire watershed system 2 use the integrated modeling system to analyze the response of water quality in a surface water body to the agricultural conservation practices in this system annagnps was applied to simulate the runoff and loads of sediment and nutrients exported from the watershed simulated results were used as boundary conditions for cche wq to simulate concentrations of sediment nutrients and phytoplankton in receiving waterbodies in recent years annagnps and cche wq have been successfully applied to simulate the flow sediment and water quality in beasley lake watershed blw fig 1 an agricultural watershed in mississippi usa locke et al 2008 yuan et al 2008 lizotte et al 2017 chao et al 2018 locke et al 2020 yasarer et al 2020 the proposed technical approach was tested using blw the integrated modeling system was first calibrated and validated using measured data under the existing conditions it was then applied to simulate scenarios with various cropping and tillage systems this system can be used to analyze the responses of water quality in both the watershed and receiving waterbody to various agricultural practices and evaluate the effectiveness of cps in improving water quality 3 materials and methods 3 1 study site blw located in sunflower county mississippi is a relatively closed system the sunflower river levee defines the northern part of the watershed boundary and a large forested area is located on the eastern side of the watershed fig 1 it was selected as one of the conservation effect assessment project ceap benchmark watersheds to assess environmental benefits derived from implementing usda conservation programs the watershed has a total drainage area of approximately 6 25 km2 and the receiving beasley lake is an oxbow lake 0 25 0 30km2 formed from a cutoff meander of the sunflower river surface water quality in this region suffers from excessive nonpoint pollutants such as nutrients sediment and pesticides that are transported from agricultural fields cps such as constructed wetlands establishment of grassed buffers sediment retention ponds reduced no tillage have been implemented in this watershed to reduce nonpoint source pollution locke 2004 2008 lizotte et al 2021 from 2002 to 2004 weekly 2002 to biweekly 2003 2004 lake surface water samples top 10 cm were collected at stations b1 b2 and b3 by researchers at national sedimentation laboratory nsl lake in situ water quality measurements of temperature conductivity ph and dissolved oxygen do were collected simultaneously with surface water sampling using a calibrated ysi 556 handheld multiparameter meter yellow springs instruments inc yellow springs oh usa water samples were preserved on wet ice and transported to nsl for laboratory water chemistry analysis water quality variables of suspended sediment dissolved nitrogen nitrite and nitrate attached organic nitrogen dissolved inorganic phosphorus po4 attached organic phosphorus and chlorophyll a were measured according to methods described in lizotte et al 2014 2017 2021 runoff water quality samples were collected from 1996 to 2000 at two sites bl1 bl3 fig 1 using automated samplers isco model 3700 portable sampler isco inc lincoln ne usa and runoff flow was measured using acoustic doppler instruments isco model 4150 and 4250 flow logger and meter isco inc lincoln ne usa samples collected were flow proportional bulk composite during each runoff event and then sub sampled in the laboratory prior to analysis sub samples were analyzed for total suspended sediment and nutrient concentrations nutrients included dissolved nitrogen nitrite and nitrate attached organic nitrogen dissolved inorganic phosphorus po4 and attached organic phosphorus rebich 2004 those measured water quality and runoff data were used for model calibration and validation the average water depth of the lake is about 2 1 m and wind shear is the major driving force for flow hydrodynamics due to wind driving this relatively closed lake system can be considered a well mixed system previously published research conducted on the beasley lake measured water quality data showed that after accounting for seasonal and year to year variation variations of lake surface water quality constituents at stations b1 b2 and b3 were not statistically significantly different from one another and could be combined lizotte et al 2014 2017 2021 therefore a well mixed model was developed based on cche wq to simulate the lake water quality 3 2 integrated modeling system this is the first time the annagnps watershed model and cche wq water quality model were linked together to simulate flow sediment and nutrient processes throughout the entire watershed and receiving water body fig 2 land management and watershed processes were simulated with annagnps v5 6 and resulting runoff and loads of sediments and nutrients were used as inlet boundary conditions for the cche wq model to simulate water quality constituents in the receiving waterbody the alternative cps can be set as input conditions for annagnps and their effects on the water quality in both the watershed and receiving waterbody can be analyzed using this integrated modeling system 3 3 annagnps model annagnps version 5 6 generates results at a daily time step but was designed to simulate long term chemical and sediment dynamics within agricultural watersheds bingner et al 2018 the basic model structure consists of hierarchical cells that are connected to reaches where flow is simulated and routed through the watershed using topographic inputs the topographic parameterization tool for annagnps topagnps module subdivides the watershed into cells that are connected to a simulated channel network the cell size and channel network are created based on the concentrated source area csa and minimum source channel length mscl settings the spatial variability of soils and land use are accounted for by overlaying these geospatial layers with the cell mesh or manually inputting characteristics for individual fields cells runoff sediment and pollutant loadings can be predicted from precipitation rain or snow and irrigation events at this time groundwater interactions were not considered in the model in this annagnps simulation for blw the cells and stream network of a watershed were generated based on a 1 m resolution light detection and ranging lidar derived digital elevation model dem using the topagnps module the dem was manually corrected to represent flow through culverts and ditches to represent hydrology within the watershed the original lidar data can be found at the usgs lidar explorer map nationalmap gov the simulation had an average cell size of 0 0075km2 and median size of 0 0042km2 using a concentrated source area csa setting of 1 m and a minimum source channel length mscl of 25 m soil properties were obtained from the natural resources conservation service nrcs soil web survey database for sunflower county mississippi nrcs 2020 the spatially dominant soil type in each cell was used to represent the conditions of that cell land use was manually assigned to cells based on management data supplied by producers general management operation schedules were developed for each crop and tillage practice using long term records volunteered from producers in the watershed and combined with the corresponding operation from the revised universal soil loss equation rusle management database management schedules used in each scenario simulation are reported in supplementary table 1 s table 1 daily minimum and maximum temperature and precipitation inputs were obtained from the beasley lake nrcs soil and climate analysis network scan weather station for the duration of the model warm up and simulation period with gaps in the data infilled from the nearest global historical climate network weather station in moorhead ms ghcnd usc00226009 33 45 n 90 5167 w approximately 16 kilometers northeast of beasley lake dew point and solar radiation were generated by the annagnps version of climate data generator model gem hanson and johnson 1998 for beasley lake watershed simulation the model was set with a 2 year warm up period followed by a simulation starting from 1995 until 2014 the simulation results in the period of 1 1 2002 12 16 2004 was chosen for model evaluation the runoff from each cell was calculated using the soil conservation service curve number cn method usda soil conservation service 1985 the model routes the physical and chemical constituents from each cell into the stream network and finally to the watershed outlet in this watershed all runoff is directed into ditches which drain into beasley lake there is no baseflow in these ditch systems and therefore no need to separate streamflow into baseflow and runoff components in general the outputs of annagnps include runoff suspended sediment ss at multiple grain sizes dissolved and sediment associated nitrogen and phosphorus and several pesticides all model outputs can be obtained at any desired location such as specific cells stream reaches feedlots gullies or point sources for blw the outputs include time series of runoff loads of dissolved nitrogen assumed to be primarily nitrate no3 dissolved and attached adsorbed inorganic phosphorus i e po4 attached nitrogen i e organic nitrogen on attached organic phosphorus op and ss these data can be converted to time series of runoff flow discharge m3 s and concentrations of no3 po4 on op and ss mg l and used as inlet boundary conditions for cche wq to simulate water quality constituents in beasley lake the critical input data for the annagnps model was listed in table 1 3 4 cche wq model cche wq simulates temporal and spatial variations of the major water quality interacting processes including phytoplankton kinetics nutrient cycles and dissolved oxygen balance the concentrations of eight general water quality constituents ammonia nh4 no3 po4 phytoplankton as chlorophyll a chl carbonaceous biochemical oxygen demand cbod dissolved oxygen do on and op are simulated the sediment associated water quality processes including the effect of ss on the growth of phytoplankton adsorption desorption between nutrients and ss and release of nutrients from bed sediment are also simulated in cche wq the phytoplankton biomass is represented by the concentration of chl which can be obtained from the growth rate death rate and settling rate of phytoplankton the growth rate is mainly affected by the availability of nutrients light and temperature wool et al 2001 1 p g p max k n k l k t where p g is the growth rate of phytoplankton day 1 p max is the maximum growth rate day 1 k n k l and k t are growth factors due to inorganic nutrients light and water temperature which have ranges between 0 and 1 the light growth factor k l is obtained by integrating steele s equation over one day of time interval and water depth ditoro et al 1971 chapra 1997 2 k l 2 72 f d k a h exp i s d f d i o e k a h exp i s d f d i o where f d is the fractional daylength 0 f d 1 h is the water depth m i sd is the daily averaged light intensity at the water surface ly day i o is the optimal light intensity for phytoplankton growth ly day k a is the light attenuation coefficient m 1 which can be expressed by wool et al 2001 chao et al 2007 3 k a k b 0 0088 c c h l 0 054 c c h l 0 67 0 0452 c s where k b is the background light extinction coefficient m 1 c chl is the concentration of chlorophyll μg l and c s is the ss concentration mg l eq 3 shows that k a is significantly affected by the ss concentration the temperature growth factor k t can be calculated using the formula proposed by cerco and cole 1995 in which k t increases to the maximum value 1 at an optimal temperature and then decreases at higher temperatures in the numerical models the optimal temperature is normally set as one value and this value may vary with species in cche wq model the optimal temperature can be set as one value or a range processes of adsorption desorption between dissolved nutrients and ss are much faster than biological reactions therefore these processes can be assumed to reach equilibrium instantly at each time step in the numerical model wool et al 2001 in cche wq the processes of adsorption desorption were described by the langmuir isotherm and the dissolved and particulate nutrient concentrations were calculated using the formula proposed by chao et al 2010 4 c d 1 2 c 0 1 k a d c s q m c 0 1 k a d c s q m 2 4 c s q m k a d 5 c p 1 2 c 0 1 k a d c s q m c 0 1 k a d c s q m 2 4 c s q m k a d where c d and c p are dissolved and particulate nutrient concentrations mg l respectively c 0 is the nutrient initial concentrations mg l k ad is the equilibrium partition coefficient l mg q m is the maximum adsorption capacity mg n mg ss and c s is the concentration of ss mg l the release rate of nutrients from bed sediment is determined by the gradient of nutrient concentrations across the water sediment interface ditoro et al 1971 momm et al 2017 and it is also affected by water temperature dissolved oxygen do concentration and ph value at the bed sediment layer romero et al 2003 the bed release rate was calculated using the formula proposed by chao et al 2010 6 s b e d k d c b c w θ b t 20 k d o k d o c d o p h 7 k p h p h 7 where s bed is the bed release rate of nutrients g m 2 day k d is the diffusive exchange coefficient m day at the water sediment interface c w and c b are the dissolved concentration of nutrients in water and bed sediment layer mg l respectively θ b is the temperature coefficient c do is the do concentration at the bed sediment layer mg l k do is the release parameter due to the do concentration mg l k ph is the release parameter due to the ph the variations of spatial distributions of water quality constituents in beasley lake are very small and this lake can be considered as a well mixed system lizotte et al 2014 cche wq was integrated into a well mixed flow model to simulate the concentrations of water quality constituents the water balance equation can be written as 7 d v d t d a h d t q i n q o u t q e q p q g where v is the volume of the lake water m 3 t is the time s a is the surface area of the lake m 2 h is the water depth m q in is the inflow discharge m 3 s and can be obtained from annagnps q out is the outflow discharge m 3 s q e is the flow decreasing rate due to the evaporation m 3 s q p is the flow increasing rate due to the precipitation m 3 s q g is the groundwater discharge m 3 s the general mass balance equation of a well mixed lake can be written as 8 d c v d t q i n c i n q o u t c v s c where c is the concentration of mass mg l which can be the concentrations of chlorophyll nutrients and ss c in is the mass concentration in the inflow mg l and can be obtained from annagnps σs c is the effective source terms of mass mg l s which can be calculated by 9 s c s r s s e t s b e d h where s r is the source term due to chemical and biological reactions mg l s which can be calculated for each water quality constituent chao et al 2010 s set is the sink term due to settling mg l s s bed can be calculate using eq 6 in a well mixed model water depth water volume and surface area are important variables to simulate the water balance eq 7 in the model simulation the computational domain in the horizontal direction is generated using the two dimensional cche mesh generator at each generated grid the corresponding water depth can be obtained based on the simulated water surface elevation and the local bed elevation therefore the water volume of the lake and its surface area can be calculated with high accuracy at each time step when the water surface elevation changes the water volume as well as the surface area can also be obtained accordingly in a general well mixed model it is assumed that the transportation of mass can be ignored and the mass concentrations in the water body are uniformly distributed horizontally and vertically however eq 2 shows the phytoplankton growth factor due to light is significantly affected by the local water depth in the lake using the generated 2d computational mesh the local water depth can be obtained and the growth factor at each grid can be calculated at each time step this model takes the advantage of 2d computational mesh to calculate the source terms eq 8 of each individual element and integrate them for solving the total mass in the water body which significantly improve the accuracy of mass balance in the model for the cche wq simulations in beasley lake the daily runoff nutrient and ss loads were provided by annagnps and converted to time series inlet boundary conditions as described above the bed elevations of the lake were measured by nsl the climate data including hourly wind solar radiation air temperature and relative humidity and daily precipitation were obtained from the usda nrcs national water and climate center scan site beasley lake nrcs 2020 the model was applied to simulate the water surface elevation temperature and concentrations of ss nutrients and chlorophyll chl in the model simulation the time step was set to 3600 seconds the critical input data for cche wq model was listed in table 1 3 5 integrated model test calibrations validations and simulation scenarios of conservation tillage practices the integrated models fig 2 were tested using blw under the existing conditions year 2002 2004 as the watershed simulation used land cover and management practices based on farmer reported information the conditions were mostly soybean with a small amount of wheat cotton and milo planted in 2002 in annagnps and cche wq models there are some empirical formulas which may cause uncertainties for model simulations to reduce the uncertainties and improve the model applicability it is often necessary to conduct model calibration and validation salimi et al 2016 ahmadisharaf et al 2019 for calibration runs the model parameters in the cche wq model were adjusted repeatedly to obtain a reasonable reproduction of the field measured data for model validation those calibrated parameters were kept same the simulated results were compared to the field measurements and performances of the integrated models were assessed using statistical analysis the annagnps model has been developed to utilize input parameters from publicly available databases as well as information collected in house such as climate soil and crop management operations as beasley lake is a small watershed and most of the model inputs are well known due to extensive local work in this watershed this reduces the needs for calibration of model parameters in general annagnps model parameters require little to no calibration since the model utilizes readily accepted databases for users to describe the model inputs and has been shown to produce acceptable results in the study region as well as many watersheds around the world yuan et al 2003 2005 das et al 2008 chahor et al 2014 many parameters in the cche wq model need to be manually calibrated the recommended range of each parameter was obtained from laboratory field measurements or suggested by others ditoro et al 1971 wool et al 2001 bubba et al 2003 chao et al 2010 table 3 simple sensitivity analysis was conducted to determine the realistic parameters for beasley lake water quality simulation in the water quality model phytoplankton is the most important constituent and the parameters related to its growth death such as the maximum growth rate optimal light intensity for phytoplankton growth and background light extinction coefficient were calibrated first all the calibrated parameters listed in table 3 were kept same for the model validation run the annagnps model simulated runoff were statistically assessed with measured data using the coefficient of determination r2 nash sutcliffe efficiency nse and percent bias pbias the cche wq simulated water quality constituents and were assessed using mean error root mean square error rmse normalized rmse rmse observed mean index of agreement d willmott 1984 and correlation coefﬁcient r computed for each case to evaluate model performance after model validation the capabilities of integrated modeling system were tested for analyzing the sensitivity of cropping and tillage systems on the lake water quality in blw six simulation scenarios were designed three variations of tillage including no tillage no till reduced tillage red till and conventional tillage conv till for two different crops cotton and soybeans conceptually conventional tillage involves the most disturbance to soil structure and is generally described as tillage and bed preparation in the fall after crop harvest with tillage again in the spring prior to planting the next crop locke et al 2020 reduced tillage is an agricultural best management practice that reduces the frequency and intensity of conventional tillage described above and is a recommended usda natural resources conservation usda nrcs practice in the united states to mitigate topsoil erosion usda nrcs practice 345 no tillage management is an agricultural best management practice where cropped soil is not tilled in any condition to further mitigate topsoil erosion and improve soil health and is a recommended usda nrcs practice in the united states usda nrcs practice 329 these practices were chosen as they were used throughout the watershed during the study period cotton and soybeans are also common crops in the mississippi delta soybeans have been the dominant crop since the 1960 s and cotton has historically been important with less acreage planted recently yasarer et al 2020 within blw there was a transition from predominately cotton to soybean around 2002 lizotte et al 2021 therefore these crops were chosen within the scenarios to test the integrated modeling system as those designed scenarios were used to analyze the effects of tillage and associated crops on the lake water quality the crop was set as monocrop and the management operations in each year were set to be the same supplementary table 1 s table 1 lists the dates and management operations for each crop tillage scenario in the annagnps simulations the dates of these management practices were estimated based on typical schedules and did not reflect the intricacies of implementing these practices around weather wet fields and multiple fields on a farm in the soybean simulations no fertilizer was added as this was not observed within the watershed however in the cotton simulations nitrogen fertilizer was applied using average rates from the management history 4 results and discussion 4 1 calibration and validation of the integrated modeling system for the annagnps model calibration run the curve number was adjusted repeatedly to obtain a reasonable reproduction of the field measured data but the best results were found with the original curve number value which was calculated based on the land use soil type and antecedent soil moisture annagnps has been previously applied to simulated runoff sediment and nutrients in blw yuan et al 2003 2005 2008 yasarer et al 2017 lizotte et al 2017 the recommended model parameters from previous studies including initial contents of nutrients in soil plant nutrient uptake ratios nutrient mineralization ratio were used in this study table 2 the daily loads of runoff sediment and nutrients in blw were simulated a three year period from 1 1 2002 to 12 16 2004 was chosen for model runoff validation fig 3 shows the simulated runoff are generally in agreement with measured data in bl1 and bl3 sub watersheds with the r2 values of 0 721 and 0 816 nse values of 0 7 and 0 51 pbias values of 1 43 and 5 3 respectively a period from 1 1 2002 to 12 31 2002 was selected for the cche wq model calibration run to run a new case initial conditions may cause some uncertainties for model simulations to reduce those uncertainties a one week warm up period was used for modeling in this period the water level and water quality conditions were same as their initial conditions to determine the calibrated parameters simple sensitivity analysis was conducted based on the recommended ranges of each parameter table 3 the simulated results were compared with field measurements in beasley lake fig 4 for model validation run to reduce the uncertainties caused by the initial conditions the starting time for model simulation was set as same as that for model calibration run 0 00 1 1 2002 a period from 1 1 2002 to 12 16 2004 two years longer than calibration period was chosen for model validation the time series of temperature and concentrations of nh4 no3 po4 chl bod do on op and ss were obtained using cche wq fig 4 shows the simulated concentrations of chl nh4 no3 and po4 concentrations in the lake in comparison to measured values supplementary table 2 s table 2 summarizes the statistical analysis of the observed and simulated temperature t chl nh4 no3 po4 on and ss concentrations in the lake temperature was accurately predicted with low mean error and high index of agreement chlorophyll trends were also captured by the model fig 4a but overall underpredicted by about 22 s table 2 the model was not able to reproduce temporal trends as accurately as the mean value such a dissonance in measured and predicted values could be due to the biweekly measured timestep which did not overlap with the hourly simulated time step it is well known the phytoplankton processes are highly complex and challenging to simulate and need further study to mathematically replicate the mean value of nh4 concentrations were very low 0 03mg l during the simulation period in summer due to the uptake of phytoplankton the concentration of nh4 could be lower than 0 01mg l the simulated mean concentration of nh4 is about 10 greater than the measured data fig 4b s table 2 for no3 the model captured the general trend in winter and spring no3 is slightly higher due to higher rainfall runoff and erosion fig 4c simulated mean value was 1 1 overestimated like chl the rmse is also relatively high for no3 s table 2 observed data in beasley lake showed that po4 is relatively high and the no3 and nh4 are limiting nutrients for the growth of phytoplankton lizotte et al 2017 therefore the growth of phytoplankton significantly affects no3 concentrations and errors in simulating chl may also affect the accuracy of no3 results po4 concentrations were generally in agreement with the observed data fig 4d compared with the measured po4 data the simulated mean value is about 22 overestimated concentrations of on op and ss were also simulated and compared with available measured data on and ss like the above presented simulation results the model captures the general trends of the measured data with simulated mean errors 20 s table 2 based on these results the model seemed capable of reproducing general patterns of water quality constituents mean values of the model results were in good agreement with measured data and simulated mean errors were normally 20 simulated trends for phosphorus were much better than that for nitrogen model capability for simulating time series of water quality constituents was not as good as the mean values especially for nitrogen and chlorophyll chlorophyll dynamics were particularly challenging to predict as there are many algal species that may peak at different times throughout the season due to the availability of micro and macro nutrients lizotte et al 2014 2017 with nitrogen availability and chlorophyll production so closely tied in this system error propagates from the prediction of one component to the other another potential reason for errors in simulating the water quality time series are the mismatches in frequency of sample collection compared to model output in addition the errors of inlet boundary conditions produced by annagnps may also affect lake water quality simulations however the model results are reasonable especially for providing long term predictions and comparisons of different outcomes from watershed management scenarios 4 2 effects of conservation tillage practices on water quality 4 2 1 cotton tillage scenarios to compare the effect of tillage for cotton scenarios the values from the conv till were used as the benchmark in general no till and red till practices reduced the soil erosion and they increased the runoff by 2 and 8 compared to the conv till scenario red till and no till could reduce the loads of ss to 62 and 36 of the amounts of conv till s table 3 with respect to nutrients red till and no till generally reduced nutrient loads except for no3 red till and no till reduced po4 by 9 and 16 of the amounts of conv till however no3 increased by 18 and 6 due to the application of nitrogen fertilizer and slightly increased runoff s table 3 the main differences between conv till red till and no till were the reduction of soil disturbance due to the application of additional nitrogen fertilizer red till and no till resulted in more no3 released from the fields as red till had higher runoff the loads of no3 were slightly greater than that for no till fig 5 shows the time series concentrations of water quality constitutions in the lake for three cotton tillage scenarios ss concentrations were mainly affected by runoff loads from the watershed during periods with higher ss loads the concentration of lake ss was also higher red till and no till reduced mean ss concentrations by 62 and 37 of the amount of conv till s table 4 which were consistent to reductions in ss loads in the watershed in winter and spring ss concentrations were generally higher than those in summer and fall compared with the conv till for cotton red till and no till increased the mean chl concentrations by about 32 and 36 respectively s table 4 growth of phytoplankton is mainly affected by inorganic nutrients and ss in the lake increases of inorganic nutrients can promote phytoplankton growth while ss could increase the light attenuation coefficient k a in eq 3 and limit phytoplankton growth red till and no till reduced the concentrations of lake inorganic nutrients which may reduce the growth of phytoplankton i e concentration of chl however they also reduced ss concentration which may increase the light growth factor k l in eq 2 and promote phytoplankton growth and eventually increase chl concentration in most of the simulation periods conv till had the lowest chl concentration fig 5a however in some periods with lower ss concentration such as may june september 2002 march 2003 april september 2004 relatively higher nutrient concentrations resulted in a higher phytoplankton growth rate conv till had the highest chl concentration red till and no till reduced nutrients and ss and increased the chl concentrations in most simulation periods but for periods with lower ss concentration they reduced chl concentrations model results indicate a threshold period where ss concentrations are low enough where light is not limiting phytoplankton growth but nutrients are abundant enough to stimulate growth better control of algal blooms would require additional cps to further reduce nutrients during these periods lake nutrient concentrations are affected by the nutrient loads as well as lake biogeochemical processes phytoplankton growth needs inorganic nutrients while organic nutrients may be released due to phytoplankton senescence additionally organic nutrients can be converted to inorganic nutrients due to mineralization in these scenario studies it was assumed that all dissolved inorganic nitrogen was mainly in the form of no3 so there was no simulated nh4 load from the watershed fig 5b shows nh4 concentrations in the lake were relatively low and were not directly influenced by tillage practices however tillage practices affected chl concentrations and other nutrients which may influence nh4 concentration for no3 red till and no till increased loads by 18 and 6 relative to conv till s table 3 however they reduced lake no3 concentration by 33 and 57 relative to conv till s table 4 lake no3 concentrations are influenced not only by loads but also by lake biogeochemical processes such as nitrification mineralization and phytoplankton growth death while red till and no till scenarios produced slightly higher no3 loads they also reduced ss increased water clarity increased phytoplankton growth which resulted in no3 reductions in the lake fig 5c shows no till practice reduced no3 concentrations in all simulation periods while red till reduced the concentration in almost all periods except a short period in june 2003 in this period red till no3 loads were much higher than conv till and resulted in higher lake no3 concentrations higher no3 loads could affect the lake no3 for a short period in general red till and no till reduced mean lake no3 concentrations similar to other nutrients red till and no till reduced loads of po4 and sediment into the lake which resulted in lake po4 concentrations reduced for the entire simulation period with mean concentrations reduced by 26 and 31 compared to conv till fig 5d s table 4 4 2 2 soybean tillage scenarios except for no3 nutrients and ss loads from the soybean scenarios were similar in magnitude to the cotton scenarios nitrate was nine times lower in soybean scenarios compared to cotton because nitrogen fertilizer was not applied values of conv till for soybean were set as a benchmark for comparison in general red till and no till reduced soil erosion and they slightly increased runoff by 8 compared to the conv till scenario red till and no till reduced loads of ss to 57 and 21 compared to conv till red till and no till scenarios reduced nutrient loads from the watershed for inorganic nutrients red till and no till reduced no3 by 39 and po4 by 13 and 22 compared to conv till s table 5 within the lake fig 6 shows the time series lake water quality concentrations for three soybean tillage scenarios similar to cotton scenarios ss concentrations were only affected by watershed loads in periods with higher ss load lake ss concentration was also higher red till and no till reduced mean ss concentrations to 56 and 21 of conv till amounts s table 6 which were very close to watershed ss loads in general during winter and spring ss concentrations were higher than summer and fall general trends of chl concentration were similar in both soybean and cotton scenarios since there was no fertilizer applied to soybean scenarios mean chl concentrations for conv till red till and no till were lower than cotton scenarios mean chl concentrations for the three soybean tillage scenarios were quite close and their differences were about 5 s table 6 in general conv till had the highest nutrient and ss concentrations and nutrients may stimulate the phytoplankton growth while ss can limit its growth for most of the simulation period conv till had the lowest chl concentration because of relatively higher ss concentrations however in some periods with lower ss concentrations such as september 2002 march 2003 and april and september 2004 relatively higher nutrient concentrations and higher phytoplankton growth rate conv till had the highest chl concentration fig 6a general trends of concentrations of inorganic nutrients for the three soybean tillage scenarios were similar to those for cotton scenarios fig 6b d lake nh4 concentrations were relatively low and were not sensitive to tillage practices lake nh4 could be influenced by chl concentrations and other nutrients red till and no till could reduce concentrations of nh4 by 17 and 31 compared to conv till red till and no till reduced the mean and time series concentrations of nutrients no3 po4 throughout the simulation period since there was no additional nitrogen fertilizer applied for soybean scenarios mean no3 concentrations were lower than those for cotton scenarios while po4 concentrations were similar to the cotton scenarios for inorganic nutrients red till reduced no3 by 68 and po4 by 22 compared to conv till while no till could further reduce no3 by 84 and po4 by 29 compared to conv till s table 6 5 conclusions an integrated modeling system was successfully developed linking the annagnps watershed model with cche wq lake water quality model to simulate flow sediment and nutrients processes throughout the entire watershed waterbody system in the integrated system annagnps produced runoff loads of nutrients no3 po4 on and op and ss that were converted to inlet boundary conditions for cche wq to simulate water quality in the receiving waterbody this integrated modeling system can provide acceptable inflow boundary conditions for receiving water body where the measured data is not available this system provides useful tools to analyze the agricultural practices on the water quality in the watershed and receiving water body these integrated models were calibrated and validated using measured data in blw simulation results demonstrated the integrated model system reproduces the general patterns of the water quality constituents reasonably with mean values of modeled results in general agreement with measured data the simulated trends and magnitudes for phosphorus were better than that for nitrogen or chlorophyll in the lake model components the validated modeling system was applied to simulate six agricultural scenarios of varying tillage practices and crops within blw to analyze the lake water quality responses modeled results showed conv till red till and no till reduced watershed loads and lake ss concentration for both cotton and soybean scenarios in general red till and no till reduced nutrient loads except no3 for cotton scenarios due to the additional application of nitrogen fertilizer however they reduced lake nutrient concentrations lake chl concentration is mainly impacted by inorganic nutrients and ss and there is a need to better understand the relationship between lake nutrients ss and phytoplankton to improve model performance this study demonstrates the capabilities of integrated watershed and water quality modeling system for analyzing lake water quality responses to the agricultural practices this integrated modeling system can be used to assess the impact of alternative cps on the water quality for the entire watershed which is useful to evaluate trade offs in management practices for water quality improvement declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported in part by the u s department of agriculture agricultural research service through the cooperative agreement no 6060 13000 030 00d between the usda ars national sedimentation laboratory usda ars nsl and the university of mississippi national center for computational hydroscience and engineering ncche it is also partially funded by nasa s applied sciences water resources program award 80nssc22k0932 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105691 
25403,the sediment transport and erosion prediction step model is methodically described in this paper the step model was implemented at a 3 47 km 3 47 km grid resolution in the kalisapi sub watershed central java indonesia it was calibrated and validated in the period of 2003 2008 and 2010 2014 respectively the result shows that the step model functions satisfactorily at monthly and annual time window in the calibration and validation periods in both periods the step model is able to produce fruitful annual sediment transport rates with r2 values of 0 71 and 0 9 in the calibration and validation period respectively moreover the step model exhibits more equitable spatial variability than that of the widely known usle model correspondingly it can be surmised that the step model is capable of simulating spatial and temporal variability of sediment transport from a watershed at monthly and annual time scales keywords sediment transport soil erosion physical model distributed model data availability no data was used for the research described in the article software and data availability the software named step which stands for sediment transport and erosion prediction is written using python version 3 6 language by research team of civil engineering department jenderal soedirman university the main source code sizes 1 7 mb this software has been tested and should work on almost all python 3 6 compilers or higher at present time the software can only be run through command line in windows or terminal in mac and linux operating system the final version of the software is publicly and freely available in 2021 at https bitbucket org yantounsoed step src master the input data for study area of this manuscript in txt format are also available in the repository the size of the input data is 21 7 mb for application in different location the input data size should depend on the area and grid size for further information questions can be sent to yanto unsoed ac id 1 introduction the rate of sediment transport has been continuously increasing in a near exponential means due to human disturbance on land cover in the forms of massive deforestation agricultural expansion infrastructure development etc borrelli et al 2017a within a watershed increasing sediment transport causes loss of fertile soil layer ding et al 2015 surface water quality reduction and impaired drainage networks montgomery et al 2014 and intensification of flooding risk nones 2019 sinnakaudan et al 2003 hence sustainable watershed management requires better understanding on the quantitative impacts of land use and land cover lulc changes on the spatial and temporal variability of sediment transport spatial distributed erosion model is a useful tool to represent variability of sediment transport across a watershed alatorre et al 2012 in addition continuous erosion model is imperative to capture temporal variability of sediment transport patault et al 2019 many models have been developed to estimate erosion yield in recent decades the example of existing erosion models includes usle with all its variants wischmeier and smith 1978 dream ramsankaran et al 2013 test van dijk and bruijnzeel 2003 swat efdc shin et al 2019 cascade tangi et al 2019 and bahsym zoboli et al 2020 however not all of the existing models is able to portray spatial and temporal distribution of sediment transport this is because not all eroded soil particles are transported to the downstream as some of them are deposited shortly after they are scoured thus to model sediment transport modelling soil deposition is vital two main energy sources driving soil erosion are wind and water at a large scale soil erosion due to water movement is dominant gruver 2013 it is estimated that nearly 20 of global surface land is influenced by accelerated water erosion schröter et al 2005 water induced soil erosion can happen due to rainfall impact splash erosion overland flow sheet erosion concentrated flow rill and gully erosion fu et al 2019 rill erosion can be fully removed by cultivation such that it can be ignored for long term soil erosion yield aksoy and kavvas 2005 on the other hand sheet erosion is an erosion form causing major land degradation problems worldwide ramsankaran et al 2013 sheet erosion occurs immediately after a rainfall event when the top soil layer gets saturated splash erosion accelerates the saturation process as splashed soil grains will cover and reduce the soil pores consequently higher rate of splash erosion results in a greater rate of sheet erosion however both splash and sheet erosion take effect when the eroded soil particles are transported out of the basin to do this particle flow rate must be larger than the particle deposition rate accordingly this study focuses on the modelling of splash erosion sheet erosion and deposition as the main components of sediment transport splash erosion sheet erosion and deposition are associated with hydrological processes by which the outputs of hydrological model become the inputs of sediment transport model to model sediment transport therefore coupling soil erosion and deposition model with the most appropriated spatially distributed hydrological model is beneficial soil and water assessment tool swat is the most powerful tool that combines hydrological model and soil erosion model arnold et al 1998 2012 neitsch et al 2011 it has been applied in various hydrological settings bieger et al 2015 masih et al 2011 shi and huang 2021 shin et al 2019 in swat model runoff is generated using scs curve number and green amt infiltration method while erosion rate is modelled using musle the primary drawback of swat model is that it requires a lot of number of model parameters and data that makes calibration process wearying on the other hand variable infiltration capacity vic a physically based fully distributed hydrological model that uses subgrid scale variability of land cover requires fewer model input variables compared to swat liang et al 1994 1996 moreover vic performs calculation at grid scale but it uses statistical distribution to manage subgrid scale heterogeneity that makes efficient computational time liang et al 1994 the vic has been successfully applied to model hydrological processes across the world liang et al 1996 nijssen et al 2014 sheffield and wood 2007 shukla et al 2013 te linde et al 2008 yanto et al 2017b zhao et al 2011 with the ability to separately yield overland and base flow vic model can be extended to simulate soil erosion however this kind of model is currently unavailable alternatively coupling vic model with a stand alone erosion model was done the water erosion prediction project wepp is a soil erosion model that is paired with vic in a number of studies gould et al 2016 mao et al 2010 wang et al 2018 wepp model incorporates sheet and rill erosion flanagan et al 2001 to pair those two models wepp model simply takes vic outputs as one of its inputs mao et al 2010 the main contribution of this study is the development of sediment transport and erosion prediction step model which combines vic runoff generation and erosion processes in a different way compared to wepp first it simulates splash erosion and sheet erosion and calculate sediment transport as the deduction of erosion by deposition second it uses both vic outputs overland flow and inputs rainfall and land cover class data as step inputs this enables step model to be embedded in the vic model in the model development parsimonious model is favourable to do this step model formulates erosion and deposition processes in a simple fashion such that the number of model parameters are as minimum as possible to show this the paper is organized as follows i explanation of detailed model structure and algorithm ii description of model input and its parameterization iii implementation calibration and validation of step model in a selected watershed iv discussion of spatial and temporal variability of simulated sediment transport v sensitivity of step model vi model applicability and limitation vii conclusive remarks 2 model structure and formulation the step model is a grid based model by which computation of sediment transport rate is independently performed in a grid as shown in fig 1 following the model structure of vic sediment transport within an area of interest such as watershed can only occur via flow channel such that non channel flow between grid cells is ignored liang et al 1994 1996 ideally area based aggregation is performed using a routing model lohmann et al 1996 1998 in the current version cumulative streamflow and sediment transport at watershed scale is calculated by aggregating the grid scale streamflow and sediment transport magnitude within the considered region routing model for the step model will be developed separately this is done as the routing model will take the output of the step model as the input in addition as flow characteristics and sediment transport processes in the stream and those on the ground surface are unlike different mathematical model should be applied accordingly advection dispersion equation will be considered to represent sediment transport in the routing model lee et al 2023 step model consists of three self regulating model components namely splash erosion sheet erosion and deposition splash erosion is defined as a function of rainfall and land cover while sheet erosion is a function of topography land surface overland flow and soil properties moreover deposition is outlined as a function of soil and water properties here we calculated sediment transport as the net difference between total erosion addition of splash and sheet erosion and deposition rate santos et al 2001 according to santos et al 2001 sediment transport φ kg m 2 s 1 is written as 1 φ e i e r d where e i is the rate of sediment by rainfall impact kg m 2 s 1 e r is the rate of sediment removal by overland flow shear stress kg m 2 s 1 and d is the rate of sediment deposition kg m 2 s 1 considering uniform rainfall depth r in each grid e i is expressed as follow aksoy and kavvas 2005 2 e i α r 2 where α is a throughfall coefficient the value of α ranges from 0 to 1 where the value of 0 represents an entirely covered land surface the value of 1 characterizes a completely open space and the values in between denote the fraction of covered areas it implies that when the surface is completely wrapped no splash erosion e i occurs conversely when the surface is fully uncovered the splash erosion e i will occur at a maximum rate primarily depending on the rainfall depth r in this study parameter α is defined as a function of land cover whereby each land cover type is assigned a unique value of α sheet erosion e r strikes when flowing water removes soil particles on the land surface to make this happens it requires the acting force to be greater than the resisting force the acting force comes from the turbulence of flowing water while the resisting force originates from the cohesion between soil particles that prevents soil particles to detach echoing the vic model in formulating hydrologic processes sheet erosion e r arises when the soil infiltration capacity is exceeded by a rainfall event to represent this e r is defined as follow lopes and lane 1988 3 e r k r τ 1 5 where k r is a soil detachability factor for shear stress kg m n 1 5 s 1 and τ is an average effective shear stress n m 2 it is important to note that producing effective shear stress τ from flowing water requires energy gradient under uniform flow condition the energy gradient is governed by the decreasing rate of water surface and bed surface which is also the same as friction slope correspondingly τ is formulated as follow 4 τ γ r h s f where γ is the specific weight of water n m 3 r h is the hydraulics radius m and s f is the friction slope hydraulic radius r h defined as a ratio of cross sectional area and wet perimeter is derived from continuity and manning equation to do this flow depth is first computed using the following derivation using manning equation eq 6 continuity equation eq 5 is then converted to obtain eq 7 5 q v a 6 v 1 n r h 2 3 s f 1 2 7 q 1 n r h 2 3 s f 1 2 a where q is the overland flow discharge m3 s 1 n is a manning coefficient m1 3 s 1 v is the mean of one dimensional flow velocity m s 1 and a is the cross section area m2 in this model sediment transport φ calculation is solved in a grid such that flow depth can be simply computed as cross section area divided by flow width which is same as the grid size using this approach flow depth can be derived the full derivation is not shown here for simplification and presented in eq 8 8 s f 3 2 b 5 h 5 4 n 3 q 3 h 2 n 3 q 3 b 2 0 with b is the grid size m and h is the flow depth m the flow depth h is obtained by finding the real root of eq 8 while manual calculation is complicated the real roots of a high order polynomial such as eq 8 can be easily computed using fsolve module in python the programming language used for the step model once the flow depth found hydraulic radius can be easily computed the deposition rate d is defined as follow lopes and lane 1988 9 d ε v s c where ε is a coefficient that depends on the soil and fluid properties nondimensional c is the sediment concentration kg m 3 and v s is the particle fall velocity m s 1 for a spherical particle the downward movement is produced by gravitational force the movement is accelerated by the size and weight of particle and decelerated by fluid viscosity and expressed as follows 10 v s f 0 γ s γ γ g d s and 11 f 0 2 3 36 v 2 g d s 3 γ s γ 1 36 v 2 g d s 3 γ s γ 1 where γ s is the specific weight of sediment n m 3 v is the kinematic viscosity of water m2 s 1 d s is the mean diameter of sediment m and g is the gravitational acceleration m s 2 novotny and chesters 1989 defined sediment concentration as a function of overland flow discharge q and expressed as follow 12 c q ω 1 where ω ranges from 1 2 to 1 5 3 model input and parameterization each component in step model has uncorrelated inputs based on the model formulation described in the previous section table 1 summarizes the input of step model to properly represent the natural features an appropriate number must be assigned to each model input some inputs are fixed while others are varied in time and space which depend on the various factors suitable values for model inputs can be either measured or estimated from valid literatures or sources parameterization of each model input is illustrated as follows daily rainfall depth r is cumulative rainfall recorded each day as shown in fig 1 the values are extracted from vic meteorological forcing data throughfall coefficient α is expressed as a ratio of throughfall to total rainfall to parameterize throughfall coefficient α 11 vegetation cover classes of vic model by liang et al 1994 are used throughfall coefficient α for each vegetation class is estimated from various sources bäse et al 2012 dunkerley 2010 levia et al 2019 lin et al 2020 sidle and ziegler 2017 zou et al 2015 table 2 displays the values of α for each vegetation class in the sheet erosion e r computation trustworthy soil detachability factor k r in the unit suggested by lopes and lane 1988 is unobtainable during literature search to deal with this uncertainty this parameter is adjusted in the calibration process batista et al 2021 friction slope s f is defined as the slope of model grid derived from digital elevation model dem in here we used the dem product of shuttle radar topography mission srtm with spatial resolution nearly 30 m around the line of equator that was downloaded from https srtm csi cgiar org srtmdata for model with larger grid size the value of slope generated from srtm 30 m dem is averaged over the grid overland flow discharge q is generated from vic model to run the vic model we followed model input setup and calibration as implemented by yanto et al 2017b manning coefficient n reflecting the land surface roughness greatly depends on the land cover class to implement this each land cover class within the model subgrid is assigned with a unique value as presented in table 3 brunner and ceiwr hec 2016 chow 1959 again for larger grid size the manning s value n for each model grid is averaged from all pixels inside the grid for deposition d formulation the mean sediment diameter d s and the specific weight γ s are obtained from grain size analysis of the sediment collected in the watershed s downstream additionally as kinematic viscosity of water v varies with temperature its value at ambient temperature of 20 c is selected which is 1 004 10 6 m2 s 1 for sediment concentration coefficient c the value of 1 5 is arbitrarily taken from the proposed range moreover lopes lane 1988 set the value of soil and fluid properties ε is 0 5 dimensionless while the soil detachability factor k r is 2 2 kg m n 1 5 s 1 however those values are applicable for erosion model with the sediment diameter of 0 5 mm for sediment transport model with smaller sediment grain those values need to be estimated unfortunately there is no guidance on the appropriate values for certain soil particle diameters to handle this value tuning is applied for soil and fluid properties ε and soil detachability factor k r during the calibration process 4 model implementation 4 1 study area the first implementation of step model is in the kalisapi sub watershed within serayu watershed the largest watershed in central java indonesia fig 2 the area of kalisapi sub watershed is about 134 23 km2 which is covered dominantly by forest agriculture and mix vegetated area the slope in the study area ranges from 0 to 46 hydrologically the annual rainfall in the region ranges from 2 000 to 3 000 mm with high rainfall occurs in the wet season from october to march and low rainfall happens in the dry season from april to september streamflow data collected from 2003 to 2016 shows annual discharge of 15 69 m3 s 4 2 vic model running vic model is prerequisite for the implementation of step model vic model was developed and calibrated following the study by yanto et al 2017b in that study vic model was built at 1 8 x 1 8 grid resolution in here vic model is developed at a 1 32 x 1 32 grid size which is equal to around 3 47 km this was done to cover spatial variability of hydrological processes of the relatively small sub watershed of kalisapi to this end all inputs for vic model implementation in this study including soil vegetation cover and meteorological forcing were downscaled from yanto et al 2017a 2017b the vic model was run at a daily time scale in the period of 1985 2014 during the vic model implementation land cover data were kept constant we assumed that land use changes from human disturbance in the kalisapi sub watershed are relatively insignificant as it is located in remote area the vic model was calibrated and validated at a daily time step using measured streamflow time series data provided by the public works agency of banjarnegara central java indonesia the observations cover the period of 2003 2014 we removed the data of 2009 due to considerable missing data in certain months as a result we set the calibration period of 2003 2008 and the validation period of 2010 2014 detailed description on the model setup and calibration method can be found in yanto et al 2017b 4 3 step model following the vic model we setup and run the step model at a daily time step for the period of 1985 2014 while most of model parameter values can be supplied from vic outputs and dem data parameterization of the mean of diameter d s and the specific weight γ s of the sediment needs a field measurement here the value of d s and γ s for kalisapi sub watershed is 0 058 mm and 2 312 kg m 3 respectively for soil detachability factor k r and soil and fluid properties ε parameter where the value is uncertain we performed manual fine tuning process to produce the most appropriate values of sediment transport the search of these parameters value was stopped when the mass ratio of annual step sediment load and synthetic observation described in the following section in the calibration period 2003 2008 reaches 1 4 3 usle model we used usle model to validate spatial variability of soil erosion produced by the step model the usle model is the most widely used soil erosion model in the last 80 years and has been employed to predict soil loss rate in 109 countries alewell et al 2019 belasri and lakhouili 2016 devatha et al 2015 drzewiecki et al 2014 novotný et al 2016 it predicts long term annual soil loss rate produced by sheet or rill erosion borrelli et al 2017a in the usle model soil loss is expressed as a multiplication of rainfall erosivity soil erodibility topographical factor vegetation cover and land use practices and formulated by wischmeier and smith 1978 as follow a r k l s c p where a is the potential long term annual soil loss tons ha 1 year 1 r is the rainfall erosivity which is calculated as 2 21 p 1 36 where p is the monthly rainfall k is the soil erodibility factor that is estimated from soil type l s is the slope length gradient factor which is derived from digital elevation method dem and c p reflects crop and management factors that are generated from land cover product in the original form variable c and p are separated in here those factors are combined to develop usle model for the study area rainfall depth data were collected from the center of water resources research and development ministry of public works indonesia which extend from 1985 to 2014 soil type was obtained from the soil research office agency of agricultural research and development ministry of agricultural indonesia elevation data used in this study were originated from srtm dem at 30 m resolution moreover land cover and land use data were derived from landsat 8 product downloaded from usgs website to this end the usle model was setup at 30 m 30 m grid resolution following the resolution of the dem spatial variability of the usle model input is presented in fig 3 the usle model was then run in the period of 2003 2008 to match the calibration period of the step model 5 model validation model validation is important in determining the accuracy of a model kerr and goethel 2013 it can be technically done by directly compare the model output with observed data or with output of widely used existing models eldridge and roelke 2012 here the step model was validated both in temporal and spatial scales 5 1 temporal validation validating simulated sediment transport φ time series with field observation is fiercely expected as the field measurement is often assumed to be error free janjić et al 2018 unfortunately field observation data in this study are limited in terms of time coverage and continuity i e field measurement was done in certain days in a short time period to manage this two types of time series observation are employed field observation and synthetic observation the latter was introduced in order to have longer time series data that still hold the principal features of the field observation the systematic procedure to derive both types of observation is described as follows field observation is obtained by measuring suspended sediment concentration and streamflow in the downstream and multiplying them to get daily suspended sediment transport gray and simões 2008 the streamflow was recorded in the kalisapi dam while sediment concentration was measured 500 m to the upstream to catch more fraction of suspended sediment to total sediment for simplicity this will be denoted as q s in the rest of the document and is formulated below 13 q s k c s q w where q s is the sediment transport tons day 1 c s is the suspended sediment concentration kg m 3 q w is the streamflow m3 s 1 and k is a coefficient to convert unit of the equation variables nondimensional suspended sediment concentration was irregularly measured during the period of june 2019 february 2020 the depth integration sampling technique was adopted to acquire sediment sample following the method suggested by yuqian 1989 this was done by moving the sampler continuously at a constant transient rate along the vertical direction in the middle of the stream cross section yuqian 1989 the sample was then analysed using standard procedure of hydrometer method in the laboratory to get sediment concentration ashworth et al 2001 streamflow data on the dates same as field measurement were collected from stream gauge station in the kalisapi dam which is operated by the public works agency of banjarnegara central java indonesia synthetic observation for the rest of manuscript will be expressed as q s s is generated using the following procedures i develop linear relationship between field observation and measured streamflow ii generate long term streamflow using vic model that was setup using static land cover over the running period iii estimate sediment transport using streamflow and linear relationship of field observation and measured streamflow this approach is applicable when the correlation between field observation and measured streamflow is strong with correlation coefficient r2 to be higher than 0 9 temporal validation is done in 2 two ways first time series between step simulated sediment transport φ and synthetic observation q s s is evaluated graphically using time series and numerically using the values of r2 and nash sutcliffe efficiency nse second due to the difference in the length of data probability distribution function is applied to investigate the resemblance of step simulation φ and field observation q s 5 2 spatial validation while sediment transport q s time series data can be collected from field measurement measuring spatial sediment transport is technically and economically unviable to handle this spatial validation was done for erosion component of step model which consists of splash erosion e i and sheet erosion e r for the rest of the manuscript step erosion e refers to the summation of splash erosion e i and sheet erosion e r as mentioned previously the most popular usle model was used to validate the spatial performance of the step model as for temporal validation 2 two approaches are also exploited first spatial distribution of step erosion e is compared visually with soil erosion yields from usle model second annual rate of soil erosion is quantitatively compared between the two models 6 results and discussion 6 1 sediment transport observation as many as 46 field measurements have been conducted intermittently 5 times a month during the period of june 2019 to february 2020 where 50 of the data were collected in june october dry season and the rest 50 were measured in november february wet season hence the field observation represents the seasonal variability of the suspended sediment transport q s fig 4 in the figures all values are standardized i e the values are subtracted by standard deviation and divided by the mean as shown in fig 4a the field observed sediment transport q s is low from june to november 2019 and increasing from december 2019 to february 2020 moreover seasonal variability of the sediment transport q s is parallel to streamflow q w and suspended sediment concentration c s in order to generate synthetic observations relationship of streamflow q w and suspended sediment concentration c s fig 4b and correlation of streamflow q w and sediment transport q s fig 4c are investigated in the figures the red line represents regression line while the blue line is 1 1 line the closer the regression line to the 1 1 line the stronger the relationship of the variables as can be seen in fig 4a and b streamflow q w has stronger correlation with sediment transport q s r2 0 92 rather than with suspended sediment concentration c s r2 0 58 furthermore linear model of streamflow q w and suspended sediment transport q s can be formulated as y 0 96 x where y is sediment transport q s tons day 1 and x is streamflow q w m3 s 1 the intercept of the linear regression equation can be ignored as the value is close to 0 using that equation synthetic observations q s s were generated 6 2 streamflow simulation fig 5 shows daily streamflow q w simulated by vic model along with the observation for both calibration period 2003 2008 and validation period 2010 2014 time series plot is presented to inspect the ability of vic simulation in mimicking the temporal variability of observed streamflow q w we used scatter plot to investigate relationship between simulation and observation accompanied by regression line red and 1 1 line blue the closer the points and regression line to 1 1 line the better the simulation it can be observed from the time series that the simulation tends to underestimate the observation for both low and high flow this could happen due to the quality of data or the model behaviour the vic model was calibrated automatically using borg multiobjective evolutionary algorithm borg moea which has an ability to always find the optimum solutions given the set of model parameters hadka and reed 2013 however it is tough to achieve the best solutions when the data quality is poor the poor data quality in this region has been profoundly discussed by yanto et al 2017b the other possibility is the model behaviour in generating streamflow q w during the calibration model parameters were changed to generate streamflow that matches the observation it is likely that the vic model tried to produce more overland flow q and less baseflow to fit the high flow during the wet season as a result when the streamflow generation is dictated heavily by baseflow in dry season where overland flow q is absent the vic model produces lower streamflow on the other hand although the regression line deviates to the bottom of 1 1 line it can be noted that the simulated streamflow is able to reproduce the seasonal variability of the observed streamflow q w with quite good performance the nash sutcliffe efficiency nse value of the relationship is 0 48 which is moderately good for daily streamflow simulation krause et al 2005 moriasi et al 2007 6 3 temporal variability of sediment transport step model is designed to simulate sediment transport φ at a daily time step hence a sediment transport φ time series can be constructed using the step model outputs accordingly temporal variability of sediment transport φ can be investigated fig 6 shows temporal variability of the step simulated sediment transport φ and the synthetic sediment transport observation q s s in the form of time series and scatter plot through the plots model performance at a daily monthly and annual time window can be visually and quantitatively assessed as shown in fig 6a b c the step simulated sediment transport φ time series is able to encapsulate the sequential trend of the synthetic sediment transport q s s at a daily monthly and annual time step respectively at daily and monthly time scale the simulation tends to overrate the high sediment transport q s s and undervalue the low sediment transport q s s this is coherent with the vic model output where streamflow simulation is lower than the observation in all cases fig 5a however seasonal variability of the sediment transport q s s can be thoroughly captured by the step model on the other hand annual sediment transport q s s in the calibration period is properly summarized as shown by similar temporal trend and mass balance the ratio of simulated sediment transport φ and synthetic sediment transport q s s is 1 which indicates equal sediment mass relationship of step simulation φ and synthetic observation q s s at daily monthly and annual time scale can be examined using scatterplot and 1 1 line good correlation arises when the scattered points fall adjacent to the 1 1 line in the entire range of observations it can be seen in fig 6d e f the points spread away from the 1 1 line particularly for high values moreover it can also be observed that the points disperse more on the upper left of the 1 1 line it denotes that the simulation overemphasizes the observation in the monthly and annual time scale the scattered points drop closer to the 1 1 line compared to the daily time scale features this indicates the capability of the step model φ in capturing temporal variability of synthetic observation q s s both in monthly and annual time scale while the value of r2 decreases from 0 82 to 0 71 the nse value increases from 0 52 to 0 68 for the monthly and annual time scale respectively model performance in the validation period is strongly in conformity with that of the calibration period in the validation period the ratio of annual step simulated φ and synthetic observed sediment transport q s s is 1 05 compared to that of the calibration period the r2 and nse values consistently improve from monthly to annual time scale whereby r2 raises from 0 83 to 0 9 the nse heightens from 0 55 to 0 73 investigating the capability of the step model in mimicking temporal variability of field observation is compulsory however this is impracticable as there is no overlap on the time period of the model and field measurement alternatively we used probability density function pdf to evaluate the likelihood of the step simulated φ synthetic observed q s s and field observed suspended sediment transport q s the result is presented in fig 8 as shown in fig 8 the step suspended sediment transport φ has equivalent likelihood of occurrences with the field observation q s particularly for the sediment load stretching from 0 to 30 tons day however the chance to produce high rate of sediment transport 30 tons day between step simulation synthetic and field observation is the same compared to synthetic observation q s s both step sediment transport φ and field observation q s have higher probability to have low rate approximately 0 10 tons day and lower probability to produce medium rate approximately 10 30 tons day this indicates that step model is competent in reproducing the observed sediment transport distribution 6 4 spatial variability of erosion prediction the step model performance in modelling spatial erosion e was verified using soil loss from the usle model fig 9 the usle model for the study region was developed with higher grid resolution 30 m 30 m than the step model 3 47 km 3 47 km to compare the spatial pattern the ulse erosion was averaged on the same grid as the step model it can be noted that the erosion rate of usle model is approximately ten times larger than that of step model the highest erosion rate of usle model is 4 22 tons ha 1 yr 1 while the largest rate of step model erosion e is 0 37 tons ha 1 yr 1 this occurs as the step model was forced to match erosion and sediment transport of a single soil grain size in this study we used the grain size of 0 058 mm on the other hand usle model predicts erosion of various sizes of soil grain indicated by a range of erodibility values k shown in fig 3 kruk 2021 consequently not all soil grain sizes are counted in the step erosion model resulting in the lower erosion rate fig 9 shows that large erosion of step model takes place in the middle parts while large erosion of usle model occurs in the southern perimeter of the kalisapi sub watershed the divergence between the spatial variability of step erosion e and usle erosion can be traced from the type of erosions modelled by those models as previously stated the step model mainly simulates splash and sheet erosion while usle model was developed for sheet or rill erosion borrelli et al 2017b splash erosion is mostly affected by canopy layer as indicated by the similarity between soil erodibility k map fig 2 and usle soil erosion in contrast sheet or rill erosion is controlled by soil type as denoted by the likeness of land use factor c p fig 3 and step erosion e fig 9 6 5 model sensitivity assessing the sensitivity of a model to parameter changes is important to make effective calibration process this is done by altering calibration parameters with numbers around the calibrated value and comparing the model outputs in here sensitivity analysis was performed by changing parameter of soil and fluid properties of deposition ε and soil detachability factor for shear stress k r and comparing the ratio of annual sediment transport between observation q s s and simulation φ we used the range of 1 10 5 to 1 10 3 and 4 10 4 to 7 10 4 for ε and k r values respectively the result is shown in fig 10 as presented in fig 10 the model output changes very slightly from 0 997 to 1 001 when the soil and fluid properties of deposition ε increases from 10 5 to 10 3 on the other hand exponential changes from 1 53 to 0 87 are observed on the model output when the soil detachability factor k r alters from 4 10 4 to 7 10 4 accordingly it can be concluded that the step model is sensitive to the soil detachability factor for shear stress k r 6 5 model applicability and limitation the step model aims to simulate sediment transport from a watershed the sediment transport is defined as the sum of splash and sheet erosion subtracted by deposition currently the model data are available for the small sub watershed of kalisapi in central java indonesia the model data arrangement can be extended to global scale using global data sets of vic model nijssen et al 2014 and dem data from https srtm csi cgiar org srtmdata and estimated suspended sediment diameter mean calibration of step model can be straightforwardly performed as it only requires two model parameters which are coefficient of soil and fluid properties for deposition ε and soil detachability factor k r for shear stress moreover it is found that the step model is only sensitive to the change of soil detachability factor k r which makes the calibration process simpler and quicker unlike usle model step model reveals the resemblance of land cover variability such that it is preferable to study the impact of land cover change on soil erosion and sediment transport across from the aforementioned benefits of step model some limitations exist while the model is able to imitate the spatial variability of erosion e and temporal variability of sediment transport φ at coarser resolution its performance at finer grid size has not been verified furthermore the portion of each component splash erosion e i sheet erosion e r and deposition d has not been tested this is mainly due to the inadequate observed data to validate those variables it can be reported that the annual sheet erosion rate is in the order of 105 times larger than the splash erosion and deposition the result shows that fitting sediment transport rate through model calibration does not automatically fit erosion and deposition individually accordingly multi objective calibration is requisite to reproduce accurate rate of sediment transport and its components in the current application accumulated sediment transport of a watershed from the grid cells was calculated by aggregating the grid based sediment transport this approach limits the inference of spatio temporal distribution of sediment transport as low accuracy of modelled sediment transport particularly for a short time scale model is detected as shown in figs 6 and 7 7 conclusions the step model structure and formulation are described in this paper the model is implemented in the kalisapi sub watershed calibrated and validated using synthetic observation q s s in the period of 2003 2008 and 2010 2014 respectively model performance is validated using field observation q s and synthetic observation q s s to evaluate temporal variability of sediment transport φ moreover assessment of spatial soil erosion e was performed using usle model it is demonstrated the step model works properly in generating daily suspended sediment transport φ moreover it is also confirmed that the performance of step model is noble and tends to enhance with the increase of model time step in addition spatial variability of soil erosion e from the step model is more associated with land cover map than that of usle model this is the benefit of the combination of vic and step model where land cover is used for runoff generation and erosion computation furthermore it is presented that the step model is sensitive to the soil detachability factor k r correspondingly it can be deduced that the step model functions appropriately to simulate spatial and temporal variability of sediment transport φ declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study is partially funded by the university of jenderal soedirman purwokerto indonesia for the collection of field observation data appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105686 
25403,the sediment transport and erosion prediction step model is methodically described in this paper the step model was implemented at a 3 47 km 3 47 km grid resolution in the kalisapi sub watershed central java indonesia it was calibrated and validated in the period of 2003 2008 and 2010 2014 respectively the result shows that the step model functions satisfactorily at monthly and annual time window in the calibration and validation periods in both periods the step model is able to produce fruitful annual sediment transport rates with r2 values of 0 71 and 0 9 in the calibration and validation period respectively moreover the step model exhibits more equitable spatial variability than that of the widely known usle model correspondingly it can be surmised that the step model is capable of simulating spatial and temporal variability of sediment transport from a watershed at monthly and annual time scales keywords sediment transport soil erosion physical model distributed model data availability no data was used for the research described in the article software and data availability the software named step which stands for sediment transport and erosion prediction is written using python version 3 6 language by research team of civil engineering department jenderal soedirman university the main source code sizes 1 7 mb this software has been tested and should work on almost all python 3 6 compilers or higher at present time the software can only be run through command line in windows or terminal in mac and linux operating system the final version of the software is publicly and freely available in 2021 at https bitbucket org yantounsoed step src master the input data for study area of this manuscript in txt format are also available in the repository the size of the input data is 21 7 mb for application in different location the input data size should depend on the area and grid size for further information questions can be sent to yanto unsoed ac id 1 introduction the rate of sediment transport has been continuously increasing in a near exponential means due to human disturbance on land cover in the forms of massive deforestation agricultural expansion infrastructure development etc borrelli et al 2017a within a watershed increasing sediment transport causes loss of fertile soil layer ding et al 2015 surface water quality reduction and impaired drainage networks montgomery et al 2014 and intensification of flooding risk nones 2019 sinnakaudan et al 2003 hence sustainable watershed management requires better understanding on the quantitative impacts of land use and land cover lulc changes on the spatial and temporal variability of sediment transport spatial distributed erosion model is a useful tool to represent variability of sediment transport across a watershed alatorre et al 2012 in addition continuous erosion model is imperative to capture temporal variability of sediment transport patault et al 2019 many models have been developed to estimate erosion yield in recent decades the example of existing erosion models includes usle with all its variants wischmeier and smith 1978 dream ramsankaran et al 2013 test van dijk and bruijnzeel 2003 swat efdc shin et al 2019 cascade tangi et al 2019 and bahsym zoboli et al 2020 however not all of the existing models is able to portray spatial and temporal distribution of sediment transport this is because not all eroded soil particles are transported to the downstream as some of them are deposited shortly after they are scoured thus to model sediment transport modelling soil deposition is vital two main energy sources driving soil erosion are wind and water at a large scale soil erosion due to water movement is dominant gruver 2013 it is estimated that nearly 20 of global surface land is influenced by accelerated water erosion schröter et al 2005 water induced soil erosion can happen due to rainfall impact splash erosion overland flow sheet erosion concentrated flow rill and gully erosion fu et al 2019 rill erosion can be fully removed by cultivation such that it can be ignored for long term soil erosion yield aksoy and kavvas 2005 on the other hand sheet erosion is an erosion form causing major land degradation problems worldwide ramsankaran et al 2013 sheet erosion occurs immediately after a rainfall event when the top soil layer gets saturated splash erosion accelerates the saturation process as splashed soil grains will cover and reduce the soil pores consequently higher rate of splash erosion results in a greater rate of sheet erosion however both splash and sheet erosion take effect when the eroded soil particles are transported out of the basin to do this particle flow rate must be larger than the particle deposition rate accordingly this study focuses on the modelling of splash erosion sheet erosion and deposition as the main components of sediment transport splash erosion sheet erosion and deposition are associated with hydrological processes by which the outputs of hydrological model become the inputs of sediment transport model to model sediment transport therefore coupling soil erosion and deposition model with the most appropriated spatially distributed hydrological model is beneficial soil and water assessment tool swat is the most powerful tool that combines hydrological model and soil erosion model arnold et al 1998 2012 neitsch et al 2011 it has been applied in various hydrological settings bieger et al 2015 masih et al 2011 shi and huang 2021 shin et al 2019 in swat model runoff is generated using scs curve number and green amt infiltration method while erosion rate is modelled using musle the primary drawback of swat model is that it requires a lot of number of model parameters and data that makes calibration process wearying on the other hand variable infiltration capacity vic a physically based fully distributed hydrological model that uses subgrid scale variability of land cover requires fewer model input variables compared to swat liang et al 1994 1996 moreover vic performs calculation at grid scale but it uses statistical distribution to manage subgrid scale heterogeneity that makes efficient computational time liang et al 1994 the vic has been successfully applied to model hydrological processes across the world liang et al 1996 nijssen et al 2014 sheffield and wood 2007 shukla et al 2013 te linde et al 2008 yanto et al 2017b zhao et al 2011 with the ability to separately yield overland and base flow vic model can be extended to simulate soil erosion however this kind of model is currently unavailable alternatively coupling vic model with a stand alone erosion model was done the water erosion prediction project wepp is a soil erosion model that is paired with vic in a number of studies gould et al 2016 mao et al 2010 wang et al 2018 wepp model incorporates sheet and rill erosion flanagan et al 2001 to pair those two models wepp model simply takes vic outputs as one of its inputs mao et al 2010 the main contribution of this study is the development of sediment transport and erosion prediction step model which combines vic runoff generation and erosion processes in a different way compared to wepp first it simulates splash erosion and sheet erosion and calculate sediment transport as the deduction of erosion by deposition second it uses both vic outputs overland flow and inputs rainfall and land cover class data as step inputs this enables step model to be embedded in the vic model in the model development parsimonious model is favourable to do this step model formulates erosion and deposition processes in a simple fashion such that the number of model parameters are as minimum as possible to show this the paper is organized as follows i explanation of detailed model structure and algorithm ii description of model input and its parameterization iii implementation calibration and validation of step model in a selected watershed iv discussion of spatial and temporal variability of simulated sediment transport v sensitivity of step model vi model applicability and limitation vii conclusive remarks 2 model structure and formulation the step model is a grid based model by which computation of sediment transport rate is independently performed in a grid as shown in fig 1 following the model structure of vic sediment transport within an area of interest such as watershed can only occur via flow channel such that non channel flow between grid cells is ignored liang et al 1994 1996 ideally area based aggregation is performed using a routing model lohmann et al 1996 1998 in the current version cumulative streamflow and sediment transport at watershed scale is calculated by aggregating the grid scale streamflow and sediment transport magnitude within the considered region routing model for the step model will be developed separately this is done as the routing model will take the output of the step model as the input in addition as flow characteristics and sediment transport processes in the stream and those on the ground surface are unlike different mathematical model should be applied accordingly advection dispersion equation will be considered to represent sediment transport in the routing model lee et al 2023 step model consists of three self regulating model components namely splash erosion sheet erosion and deposition splash erosion is defined as a function of rainfall and land cover while sheet erosion is a function of topography land surface overland flow and soil properties moreover deposition is outlined as a function of soil and water properties here we calculated sediment transport as the net difference between total erosion addition of splash and sheet erosion and deposition rate santos et al 2001 according to santos et al 2001 sediment transport φ kg m 2 s 1 is written as 1 φ e i e r d where e i is the rate of sediment by rainfall impact kg m 2 s 1 e r is the rate of sediment removal by overland flow shear stress kg m 2 s 1 and d is the rate of sediment deposition kg m 2 s 1 considering uniform rainfall depth r in each grid e i is expressed as follow aksoy and kavvas 2005 2 e i α r 2 where α is a throughfall coefficient the value of α ranges from 0 to 1 where the value of 0 represents an entirely covered land surface the value of 1 characterizes a completely open space and the values in between denote the fraction of covered areas it implies that when the surface is completely wrapped no splash erosion e i occurs conversely when the surface is fully uncovered the splash erosion e i will occur at a maximum rate primarily depending on the rainfall depth r in this study parameter α is defined as a function of land cover whereby each land cover type is assigned a unique value of α sheet erosion e r strikes when flowing water removes soil particles on the land surface to make this happens it requires the acting force to be greater than the resisting force the acting force comes from the turbulence of flowing water while the resisting force originates from the cohesion between soil particles that prevents soil particles to detach echoing the vic model in formulating hydrologic processes sheet erosion e r arises when the soil infiltration capacity is exceeded by a rainfall event to represent this e r is defined as follow lopes and lane 1988 3 e r k r τ 1 5 where k r is a soil detachability factor for shear stress kg m n 1 5 s 1 and τ is an average effective shear stress n m 2 it is important to note that producing effective shear stress τ from flowing water requires energy gradient under uniform flow condition the energy gradient is governed by the decreasing rate of water surface and bed surface which is also the same as friction slope correspondingly τ is formulated as follow 4 τ γ r h s f where γ is the specific weight of water n m 3 r h is the hydraulics radius m and s f is the friction slope hydraulic radius r h defined as a ratio of cross sectional area and wet perimeter is derived from continuity and manning equation to do this flow depth is first computed using the following derivation using manning equation eq 6 continuity equation eq 5 is then converted to obtain eq 7 5 q v a 6 v 1 n r h 2 3 s f 1 2 7 q 1 n r h 2 3 s f 1 2 a where q is the overland flow discharge m3 s 1 n is a manning coefficient m1 3 s 1 v is the mean of one dimensional flow velocity m s 1 and a is the cross section area m2 in this model sediment transport φ calculation is solved in a grid such that flow depth can be simply computed as cross section area divided by flow width which is same as the grid size using this approach flow depth can be derived the full derivation is not shown here for simplification and presented in eq 8 8 s f 3 2 b 5 h 5 4 n 3 q 3 h 2 n 3 q 3 b 2 0 with b is the grid size m and h is the flow depth m the flow depth h is obtained by finding the real root of eq 8 while manual calculation is complicated the real roots of a high order polynomial such as eq 8 can be easily computed using fsolve module in python the programming language used for the step model once the flow depth found hydraulic radius can be easily computed the deposition rate d is defined as follow lopes and lane 1988 9 d ε v s c where ε is a coefficient that depends on the soil and fluid properties nondimensional c is the sediment concentration kg m 3 and v s is the particle fall velocity m s 1 for a spherical particle the downward movement is produced by gravitational force the movement is accelerated by the size and weight of particle and decelerated by fluid viscosity and expressed as follows 10 v s f 0 γ s γ γ g d s and 11 f 0 2 3 36 v 2 g d s 3 γ s γ 1 36 v 2 g d s 3 γ s γ 1 where γ s is the specific weight of sediment n m 3 v is the kinematic viscosity of water m2 s 1 d s is the mean diameter of sediment m and g is the gravitational acceleration m s 2 novotny and chesters 1989 defined sediment concentration as a function of overland flow discharge q and expressed as follow 12 c q ω 1 where ω ranges from 1 2 to 1 5 3 model input and parameterization each component in step model has uncorrelated inputs based on the model formulation described in the previous section table 1 summarizes the input of step model to properly represent the natural features an appropriate number must be assigned to each model input some inputs are fixed while others are varied in time and space which depend on the various factors suitable values for model inputs can be either measured or estimated from valid literatures or sources parameterization of each model input is illustrated as follows daily rainfall depth r is cumulative rainfall recorded each day as shown in fig 1 the values are extracted from vic meteorological forcing data throughfall coefficient α is expressed as a ratio of throughfall to total rainfall to parameterize throughfall coefficient α 11 vegetation cover classes of vic model by liang et al 1994 are used throughfall coefficient α for each vegetation class is estimated from various sources bäse et al 2012 dunkerley 2010 levia et al 2019 lin et al 2020 sidle and ziegler 2017 zou et al 2015 table 2 displays the values of α for each vegetation class in the sheet erosion e r computation trustworthy soil detachability factor k r in the unit suggested by lopes and lane 1988 is unobtainable during literature search to deal with this uncertainty this parameter is adjusted in the calibration process batista et al 2021 friction slope s f is defined as the slope of model grid derived from digital elevation model dem in here we used the dem product of shuttle radar topography mission srtm with spatial resolution nearly 30 m around the line of equator that was downloaded from https srtm csi cgiar org srtmdata for model with larger grid size the value of slope generated from srtm 30 m dem is averaged over the grid overland flow discharge q is generated from vic model to run the vic model we followed model input setup and calibration as implemented by yanto et al 2017b manning coefficient n reflecting the land surface roughness greatly depends on the land cover class to implement this each land cover class within the model subgrid is assigned with a unique value as presented in table 3 brunner and ceiwr hec 2016 chow 1959 again for larger grid size the manning s value n for each model grid is averaged from all pixels inside the grid for deposition d formulation the mean sediment diameter d s and the specific weight γ s are obtained from grain size analysis of the sediment collected in the watershed s downstream additionally as kinematic viscosity of water v varies with temperature its value at ambient temperature of 20 c is selected which is 1 004 10 6 m2 s 1 for sediment concentration coefficient c the value of 1 5 is arbitrarily taken from the proposed range moreover lopes lane 1988 set the value of soil and fluid properties ε is 0 5 dimensionless while the soil detachability factor k r is 2 2 kg m n 1 5 s 1 however those values are applicable for erosion model with the sediment diameter of 0 5 mm for sediment transport model with smaller sediment grain those values need to be estimated unfortunately there is no guidance on the appropriate values for certain soil particle diameters to handle this value tuning is applied for soil and fluid properties ε and soil detachability factor k r during the calibration process 4 model implementation 4 1 study area the first implementation of step model is in the kalisapi sub watershed within serayu watershed the largest watershed in central java indonesia fig 2 the area of kalisapi sub watershed is about 134 23 km2 which is covered dominantly by forest agriculture and mix vegetated area the slope in the study area ranges from 0 to 46 hydrologically the annual rainfall in the region ranges from 2 000 to 3 000 mm with high rainfall occurs in the wet season from october to march and low rainfall happens in the dry season from april to september streamflow data collected from 2003 to 2016 shows annual discharge of 15 69 m3 s 4 2 vic model running vic model is prerequisite for the implementation of step model vic model was developed and calibrated following the study by yanto et al 2017b in that study vic model was built at 1 8 x 1 8 grid resolution in here vic model is developed at a 1 32 x 1 32 grid size which is equal to around 3 47 km this was done to cover spatial variability of hydrological processes of the relatively small sub watershed of kalisapi to this end all inputs for vic model implementation in this study including soil vegetation cover and meteorological forcing were downscaled from yanto et al 2017a 2017b the vic model was run at a daily time scale in the period of 1985 2014 during the vic model implementation land cover data were kept constant we assumed that land use changes from human disturbance in the kalisapi sub watershed are relatively insignificant as it is located in remote area the vic model was calibrated and validated at a daily time step using measured streamflow time series data provided by the public works agency of banjarnegara central java indonesia the observations cover the period of 2003 2014 we removed the data of 2009 due to considerable missing data in certain months as a result we set the calibration period of 2003 2008 and the validation period of 2010 2014 detailed description on the model setup and calibration method can be found in yanto et al 2017b 4 3 step model following the vic model we setup and run the step model at a daily time step for the period of 1985 2014 while most of model parameter values can be supplied from vic outputs and dem data parameterization of the mean of diameter d s and the specific weight γ s of the sediment needs a field measurement here the value of d s and γ s for kalisapi sub watershed is 0 058 mm and 2 312 kg m 3 respectively for soil detachability factor k r and soil and fluid properties ε parameter where the value is uncertain we performed manual fine tuning process to produce the most appropriate values of sediment transport the search of these parameters value was stopped when the mass ratio of annual step sediment load and synthetic observation described in the following section in the calibration period 2003 2008 reaches 1 4 3 usle model we used usle model to validate spatial variability of soil erosion produced by the step model the usle model is the most widely used soil erosion model in the last 80 years and has been employed to predict soil loss rate in 109 countries alewell et al 2019 belasri and lakhouili 2016 devatha et al 2015 drzewiecki et al 2014 novotný et al 2016 it predicts long term annual soil loss rate produced by sheet or rill erosion borrelli et al 2017a in the usle model soil loss is expressed as a multiplication of rainfall erosivity soil erodibility topographical factor vegetation cover and land use practices and formulated by wischmeier and smith 1978 as follow a r k l s c p where a is the potential long term annual soil loss tons ha 1 year 1 r is the rainfall erosivity which is calculated as 2 21 p 1 36 where p is the monthly rainfall k is the soil erodibility factor that is estimated from soil type l s is the slope length gradient factor which is derived from digital elevation method dem and c p reflects crop and management factors that are generated from land cover product in the original form variable c and p are separated in here those factors are combined to develop usle model for the study area rainfall depth data were collected from the center of water resources research and development ministry of public works indonesia which extend from 1985 to 2014 soil type was obtained from the soil research office agency of agricultural research and development ministry of agricultural indonesia elevation data used in this study were originated from srtm dem at 30 m resolution moreover land cover and land use data were derived from landsat 8 product downloaded from usgs website to this end the usle model was setup at 30 m 30 m grid resolution following the resolution of the dem spatial variability of the usle model input is presented in fig 3 the usle model was then run in the period of 2003 2008 to match the calibration period of the step model 5 model validation model validation is important in determining the accuracy of a model kerr and goethel 2013 it can be technically done by directly compare the model output with observed data or with output of widely used existing models eldridge and roelke 2012 here the step model was validated both in temporal and spatial scales 5 1 temporal validation validating simulated sediment transport φ time series with field observation is fiercely expected as the field measurement is often assumed to be error free janjić et al 2018 unfortunately field observation data in this study are limited in terms of time coverage and continuity i e field measurement was done in certain days in a short time period to manage this two types of time series observation are employed field observation and synthetic observation the latter was introduced in order to have longer time series data that still hold the principal features of the field observation the systematic procedure to derive both types of observation is described as follows field observation is obtained by measuring suspended sediment concentration and streamflow in the downstream and multiplying them to get daily suspended sediment transport gray and simões 2008 the streamflow was recorded in the kalisapi dam while sediment concentration was measured 500 m to the upstream to catch more fraction of suspended sediment to total sediment for simplicity this will be denoted as q s in the rest of the document and is formulated below 13 q s k c s q w where q s is the sediment transport tons day 1 c s is the suspended sediment concentration kg m 3 q w is the streamflow m3 s 1 and k is a coefficient to convert unit of the equation variables nondimensional suspended sediment concentration was irregularly measured during the period of june 2019 february 2020 the depth integration sampling technique was adopted to acquire sediment sample following the method suggested by yuqian 1989 this was done by moving the sampler continuously at a constant transient rate along the vertical direction in the middle of the stream cross section yuqian 1989 the sample was then analysed using standard procedure of hydrometer method in the laboratory to get sediment concentration ashworth et al 2001 streamflow data on the dates same as field measurement were collected from stream gauge station in the kalisapi dam which is operated by the public works agency of banjarnegara central java indonesia synthetic observation for the rest of manuscript will be expressed as q s s is generated using the following procedures i develop linear relationship between field observation and measured streamflow ii generate long term streamflow using vic model that was setup using static land cover over the running period iii estimate sediment transport using streamflow and linear relationship of field observation and measured streamflow this approach is applicable when the correlation between field observation and measured streamflow is strong with correlation coefficient r2 to be higher than 0 9 temporal validation is done in 2 two ways first time series between step simulated sediment transport φ and synthetic observation q s s is evaluated graphically using time series and numerically using the values of r2 and nash sutcliffe efficiency nse second due to the difference in the length of data probability distribution function is applied to investigate the resemblance of step simulation φ and field observation q s 5 2 spatial validation while sediment transport q s time series data can be collected from field measurement measuring spatial sediment transport is technically and economically unviable to handle this spatial validation was done for erosion component of step model which consists of splash erosion e i and sheet erosion e r for the rest of the manuscript step erosion e refers to the summation of splash erosion e i and sheet erosion e r as mentioned previously the most popular usle model was used to validate the spatial performance of the step model as for temporal validation 2 two approaches are also exploited first spatial distribution of step erosion e is compared visually with soil erosion yields from usle model second annual rate of soil erosion is quantitatively compared between the two models 6 results and discussion 6 1 sediment transport observation as many as 46 field measurements have been conducted intermittently 5 times a month during the period of june 2019 to february 2020 where 50 of the data were collected in june october dry season and the rest 50 were measured in november february wet season hence the field observation represents the seasonal variability of the suspended sediment transport q s fig 4 in the figures all values are standardized i e the values are subtracted by standard deviation and divided by the mean as shown in fig 4a the field observed sediment transport q s is low from june to november 2019 and increasing from december 2019 to february 2020 moreover seasonal variability of the sediment transport q s is parallel to streamflow q w and suspended sediment concentration c s in order to generate synthetic observations relationship of streamflow q w and suspended sediment concentration c s fig 4b and correlation of streamflow q w and sediment transport q s fig 4c are investigated in the figures the red line represents regression line while the blue line is 1 1 line the closer the regression line to the 1 1 line the stronger the relationship of the variables as can be seen in fig 4a and b streamflow q w has stronger correlation with sediment transport q s r2 0 92 rather than with suspended sediment concentration c s r2 0 58 furthermore linear model of streamflow q w and suspended sediment transport q s can be formulated as y 0 96 x where y is sediment transport q s tons day 1 and x is streamflow q w m3 s 1 the intercept of the linear regression equation can be ignored as the value is close to 0 using that equation synthetic observations q s s were generated 6 2 streamflow simulation fig 5 shows daily streamflow q w simulated by vic model along with the observation for both calibration period 2003 2008 and validation period 2010 2014 time series plot is presented to inspect the ability of vic simulation in mimicking the temporal variability of observed streamflow q w we used scatter plot to investigate relationship between simulation and observation accompanied by regression line red and 1 1 line blue the closer the points and regression line to 1 1 line the better the simulation it can be observed from the time series that the simulation tends to underestimate the observation for both low and high flow this could happen due to the quality of data or the model behaviour the vic model was calibrated automatically using borg multiobjective evolutionary algorithm borg moea which has an ability to always find the optimum solutions given the set of model parameters hadka and reed 2013 however it is tough to achieve the best solutions when the data quality is poor the poor data quality in this region has been profoundly discussed by yanto et al 2017b the other possibility is the model behaviour in generating streamflow q w during the calibration model parameters were changed to generate streamflow that matches the observation it is likely that the vic model tried to produce more overland flow q and less baseflow to fit the high flow during the wet season as a result when the streamflow generation is dictated heavily by baseflow in dry season where overland flow q is absent the vic model produces lower streamflow on the other hand although the regression line deviates to the bottom of 1 1 line it can be noted that the simulated streamflow is able to reproduce the seasonal variability of the observed streamflow q w with quite good performance the nash sutcliffe efficiency nse value of the relationship is 0 48 which is moderately good for daily streamflow simulation krause et al 2005 moriasi et al 2007 6 3 temporal variability of sediment transport step model is designed to simulate sediment transport φ at a daily time step hence a sediment transport φ time series can be constructed using the step model outputs accordingly temporal variability of sediment transport φ can be investigated fig 6 shows temporal variability of the step simulated sediment transport φ and the synthetic sediment transport observation q s s in the form of time series and scatter plot through the plots model performance at a daily monthly and annual time window can be visually and quantitatively assessed as shown in fig 6a b c the step simulated sediment transport φ time series is able to encapsulate the sequential trend of the synthetic sediment transport q s s at a daily monthly and annual time step respectively at daily and monthly time scale the simulation tends to overrate the high sediment transport q s s and undervalue the low sediment transport q s s this is coherent with the vic model output where streamflow simulation is lower than the observation in all cases fig 5a however seasonal variability of the sediment transport q s s can be thoroughly captured by the step model on the other hand annual sediment transport q s s in the calibration period is properly summarized as shown by similar temporal trend and mass balance the ratio of simulated sediment transport φ and synthetic sediment transport q s s is 1 which indicates equal sediment mass relationship of step simulation φ and synthetic observation q s s at daily monthly and annual time scale can be examined using scatterplot and 1 1 line good correlation arises when the scattered points fall adjacent to the 1 1 line in the entire range of observations it can be seen in fig 6d e f the points spread away from the 1 1 line particularly for high values moreover it can also be observed that the points disperse more on the upper left of the 1 1 line it denotes that the simulation overemphasizes the observation in the monthly and annual time scale the scattered points drop closer to the 1 1 line compared to the daily time scale features this indicates the capability of the step model φ in capturing temporal variability of synthetic observation q s s both in monthly and annual time scale while the value of r2 decreases from 0 82 to 0 71 the nse value increases from 0 52 to 0 68 for the monthly and annual time scale respectively model performance in the validation period is strongly in conformity with that of the calibration period in the validation period the ratio of annual step simulated φ and synthetic observed sediment transport q s s is 1 05 compared to that of the calibration period the r2 and nse values consistently improve from monthly to annual time scale whereby r2 raises from 0 83 to 0 9 the nse heightens from 0 55 to 0 73 investigating the capability of the step model in mimicking temporal variability of field observation is compulsory however this is impracticable as there is no overlap on the time period of the model and field measurement alternatively we used probability density function pdf to evaluate the likelihood of the step simulated φ synthetic observed q s s and field observed suspended sediment transport q s the result is presented in fig 8 as shown in fig 8 the step suspended sediment transport φ has equivalent likelihood of occurrences with the field observation q s particularly for the sediment load stretching from 0 to 30 tons day however the chance to produce high rate of sediment transport 30 tons day between step simulation synthetic and field observation is the same compared to synthetic observation q s s both step sediment transport φ and field observation q s have higher probability to have low rate approximately 0 10 tons day and lower probability to produce medium rate approximately 10 30 tons day this indicates that step model is competent in reproducing the observed sediment transport distribution 6 4 spatial variability of erosion prediction the step model performance in modelling spatial erosion e was verified using soil loss from the usle model fig 9 the usle model for the study region was developed with higher grid resolution 30 m 30 m than the step model 3 47 km 3 47 km to compare the spatial pattern the ulse erosion was averaged on the same grid as the step model it can be noted that the erosion rate of usle model is approximately ten times larger than that of step model the highest erosion rate of usle model is 4 22 tons ha 1 yr 1 while the largest rate of step model erosion e is 0 37 tons ha 1 yr 1 this occurs as the step model was forced to match erosion and sediment transport of a single soil grain size in this study we used the grain size of 0 058 mm on the other hand usle model predicts erosion of various sizes of soil grain indicated by a range of erodibility values k shown in fig 3 kruk 2021 consequently not all soil grain sizes are counted in the step erosion model resulting in the lower erosion rate fig 9 shows that large erosion of step model takes place in the middle parts while large erosion of usle model occurs in the southern perimeter of the kalisapi sub watershed the divergence between the spatial variability of step erosion e and usle erosion can be traced from the type of erosions modelled by those models as previously stated the step model mainly simulates splash and sheet erosion while usle model was developed for sheet or rill erosion borrelli et al 2017b splash erosion is mostly affected by canopy layer as indicated by the similarity between soil erodibility k map fig 2 and usle soil erosion in contrast sheet or rill erosion is controlled by soil type as denoted by the likeness of land use factor c p fig 3 and step erosion e fig 9 6 5 model sensitivity assessing the sensitivity of a model to parameter changes is important to make effective calibration process this is done by altering calibration parameters with numbers around the calibrated value and comparing the model outputs in here sensitivity analysis was performed by changing parameter of soil and fluid properties of deposition ε and soil detachability factor for shear stress k r and comparing the ratio of annual sediment transport between observation q s s and simulation φ we used the range of 1 10 5 to 1 10 3 and 4 10 4 to 7 10 4 for ε and k r values respectively the result is shown in fig 10 as presented in fig 10 the model output changes very slightly from 0 997 to 1 001 when the soil and fluid properties of deposition ε increases from 10 5 to 10 3 on the other hand exponential changes from 1 53 to 0 87 are observed on the model output when the soil detachability factor k r alters from 4 10 4 to 7 10 4 accordingly it can be concluded that the step model is sensitive to the soil detachability factor for shear stress k r 6 5 model applicability and limitation the step model aims to simulate sediment transport from a watershed the sediment transport is defined as the sum of splash and sheet erosion subtracted by deposition currently the model data are available for the small sub watershed of kalisapi in central java indonesia the model data arrangement can be extended to global scale using global data sets of vic model nijssen et al 2014 and dem data from https srtm csi cgiar org srtmdata and estimated suspended sediment diameter mean calibration of step model can be straightforwardly performed as it only requires two model parameters which are coefficient of soil and fluid properties for deposition ε and soil detachability factor k r for shear stress moreover it is found that the step model is only sensitive to the change of soil detachability factor k r which makes the calibration process simpler and quicker unlike usle model step model reveals the resemblance of land cover variability such that it is preferable to study the impact of land cover change on soil erosion and sediment transport across from the aforementioned benefits of step model some limitations exist while the model is able to imitate the spatial variability of erosion e and temporal variability of sediment transport φ at coarser resolution its performance at finer grid size has not been verified furthermore the portion of each component splash erosion e i sheet erosion e r and deposition d has not been tested this is mainly due to the inadequate observed data to validate those variables it can be reported that the annual sheet erosion rate is in the order of 105 times larger than the splash erosion and deposition the result shows that fitting sediment transport rate through model calibration does not automatically fit erosion and deposition individually accordingly multi objective calibration is requisite to reproduce accurate rate of sediment transport and its components in the current application accumulated sediment transport of a watershed from the grid cells was calculated by aggregating the grid based sediment transport this approach limits the inference of spatio temporal distribution of sediment transport as low accuracy of modelled sediment transport particularly for a short time scale model is detected as shown in figs 6 and 7 7 conclusions the step model structure and formulation are described in this paper the model is implemented in the kalisapi sub watershed calibrated and validated using synthetic observation q s s in the period of 2003 2008 and 2010 2014 respectively model performance is validated using field observation q s and synthetic observation q s s to evaluate temporal variability of sediment transport φ moreover assessment of spatial soil erosion e was performed using usle model it is demonstrated the step model works properly in generating daily suspended sediment transport φ moreover it is also confirmed that the performance of step model is noble and tends to enhance with the increase of model time step in addition spatial variability of soil erosion e from the step model is more associated with land cover map than that of usle model this is the benefit of the combination of vic and step model where land cover is used for runoff generation and erosion computation furthermore it is presented that the step model is sensitive to the soil detachability factor k r correspondingly it can be deduced that the step model functions appropriately to simulate spatial and temporal variability of sediment transport φ declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study is partially funded by the university of jenderal soedirman purwokerto indonesia for the collection of field observation data appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2023 105686 
25404,freshwater availability in the coastal zone is threatened by overexploitation seawater intrusion and global change recent advances in parallel computing of coupled variable density groundwater flow and salt transport models enable the construction of large scale high resolution models key to support sound policy making here we present the construction of a nationwide coupled variable density groundwater flow and salt transport model for the netherlands derived from the existing nationwide groundwater flow model construction of the model is fully scripted in a reproducible and transparent version controlled workflow aiding regular updating and stakeholder trust in model results a 3d groundwater salinity distribution was interpolated from over 2m available measurements using multiple indicator kriging as a starting condition in the model calculation of a high end sea level rise scenario shows the added benefit of large scale groundwater salinity modelling for policy making the presented approach is generally applicable to groundwater flow models of coastal aquifers keywords coastal aquifers salt intrusion groundwater modelling parallel computing the netherlands 1 introduction coastal lowlands are amongst the world s most densely populated areas owing to their mild relief fertile soils and easy access to transport connections and fish stocks nicholls and small 2002 shallow groundwater in coastal lowlands is often saline as a result of recent sea water intrusion werner et al 2013 marine transgressions delsman et al 2014 van engelen et al 2021 hung van pham et al 2019 larsen et al 2017 meyer et al 2019 zamrsky et al 2020 storm surges paldor and michael 2021 xiao et al 2019 yang et al 2013 2018 or tsunamis illangasekare et al 2006 liu and tokunaga 2019 or over exploitation of coastal aquifers custodio and bruggeman 1987 dibaj et al 2020 salinization issues in coastal lowlands are likely to be exacerbated by population growth climate change and sea level rise haasnoot et al 2020 loáiciga et al 2011 michael et al 2013 oude essink et al 2010 vandenbohede et al 2008 xiao et al 2021 optimal planning for sustainable use of coastal fresh groundwater resources can greatly benefit from numerical modelling of these resources on different scales however modelling coupled variable density groundwater flow and salt transport is complex and is hampered by numerical issues large computational demands and data availability oude essink 2003 werner et al 2013 the number of published large scale 2m cells and above variable density groundwater flow and coupled salt transport models is therefore limited e g van engelen et al 2019 huizer et al 2016 meyer et al 2019 oude essink et al 2010 most reported variable density groundwater flow and coupled salt transport models are of limited spatial extent or have coarse resolution e g dibaj et al 2020 faneca sànchez et al 2012 lu et al 2013 mabrouk et al 2019 sulzbacher et al 2012 vandenbohede et al 2008 yang et al 2015 recent distributed memory parallelization of the seawat modelling code offers speedups of over two orders of magnitude verkaik et al 2021 making large scale variable density groundwater flow and salt transport models with manageable runtimes feasible van engelen et al 2021 verkaik et al 2021 one key example of difficulties in data availability is the difficult to obtain 3d distribution of present day groundwater salinity as a model starting condition recent measurements of groundwater salinity are generally sparse the quality of the measurements varies and groundwater salinity may seriously vary within short distances driven by relatively minor head gradients de louw et al 2011 while airborne geophysics promises cost effective large scale monitoring of groundwater salinity delsman et al 2018 faneca sànchez et al 2012 siemon et al 2011 the availability of airborne data is still limited cannot be collected in urbanized areas and is less reliable with increasing depth the lack of a present day groundwater salinity distribution has prompted several researchers to assume steady state starting conditions obtained by a spin up period applying current boundary conditions e g souza and voss 1987 vandenbohede et al 2011 vandenbohede and lebbe 2002 coastal groundwater systems are however rarely in equilibrium given the usually long timescales involved and present day groundwater salinity distributions often still reflect events occurring thousands or even millions of years ago delsman et al 2014 van engelen et al 2021 hung van pham et al 2019 meisler et al 1984 meyer et al 2019 post et al 2013 zamrsky et al 2018 a collaborative effort of different research and government institutes drinking water companies and engineering firms in the netherlands started in 2005 to jointly develop a national hydrological modelling instrument the netherlands hydrological instrument nhi de lange et al 2014 the nhi has since further developed into a common repository of hydro geo logical data and regional and national scale modelling tools for the netherlands http www nhi nu central to the nhi is a transparent reproducible collaborative modelling approach where modeler s adaptations to hydro geo logical parameters are reviewed and fed into the common repository de lange et al 2014 since de lange et al 2014 the national scale hydrological model has been renamed to lhm landelijk hydrologisch model dutch for nationwide hydrological model the lhm model is widely used for national studies for e g fresh water supply management prinsen et al 2013 water quality assessment vermaat et al 2016 climate change adaptation studies haasnoot et al 2020 or drought risk management mens et al 2021 groundwater salinity variations strongly influence groundwater flow in coastal aquifers in addition saline groundwater exfiltration negatively affects surface water quality and is a key concern for water managers however no nationwide variable density groundwater flow model for the netherlands currently exists limiting scenario studies for e g the possible adaptation to sea level rise haasnoot et al 2020 or drought risk management mens et al 2021 in this paper we outline the construction of a probabilistic 3d groundwater salinity distribution of the netherlands based on the interpolation of over 2 6m unique measurement locations of different measurement types we further present the construction of a nationwide variable density groundwater flow and coupled groundwater salt transport model of the netherlands 31m active cells based on the existing lhm groundwater flow model and the newly constructed 3d groundwater salinity distribution and show the usefulness of the model by calculating effects of a sea level rise scenario on groundwater salinity model construction is fully scripted open source within a workflow manager ensuring transparent and reproducible model results the scripted workflow facilitates continuous updating of the groundwater flow and salt transport model within the nhi collaborative modelling approach de lange et al 2014 we finally discuss benefits of our approach based on the presented case study 2 groundwater salinity in the netherlands the netherlands is a low lying country situated in the delta of the rhine meuse and scheldt rivers the country is bordered in the west by the north sea average annual precipitation surplus amounts to 190 mm knmi 2020 the hydrogeology is characterized by soft sedimentary tertiary pleistocene and holocene deposits of marine fluvial aeolian and glacial origin thickness of these intercalated sandy and clayey deposits increases from only a few meters in the east to about 700 m in the north west sea level rise during the holocene resulted in the deposition of marine and fluvial clays in the western half of the country intersected by sandy riverbed and creek bed deposits weerts et al 2005 thick organic deposits were concurrently formed in extensive freshwater marshes dufour 2000 human influence increased from the 11th century ad onwards van de ven 1993 anthropogenic drainage river embankment and peat extraction resulted in widespread land subsidence erkens et al 2016 currently about a third of the netherlands is situated below mean sea level msl fig 1 a groundwater in the netherlands is brackish to saline within a few meters below surface level in large parts of the coastal zone fig 1b further inland groundwater salinity occurs at larger depths and is of connate tertiary origin halite dissolution is a source of saline groundwater where zechstein diapirs have protruded upward stuyfzand and stuurman 1994 conversely groundwater salinity in the coastal region of the netherlands originates mainly from free convective infiltration during holocene marine transgressions delsman et al 2014 post et al 2003 subsequent subsidence caused by anthropogenic drainage and land reclamation has resulted in groundwater and hence saline groundwater to flow upwards delsman et al 2014 shallow saline groundwater rises up into the rootzone de louw et al 2011 or exfiltrates to and thereby salinizes surface water delsman et al 2013 de louw et al 2010 the upward flow of saline groundwater has adverse consequences on agricultural production in the coastal regions of the netherlands raats 2015 and has caused abandonment of drinking water supply wells stuyfzand 1996 3 methods 3 1 3d groundwater salinity distribution 3 1 1 data collection and pre processing we collected hydrogeochemical analyses from the netherlands database of subsurface data dino https www dinoloket nl we additionally collected hydrogeochemical analyses from relevant organisations in the netherlands drinking water companies provincial authorities water boards that were not already present in the dino database apart from direct measurements of groundwater chemistry a variety of geophysical techniques exist that contain information on groundwater salinity we obtained vertical electrical soundings ves resistivity and electromagnetic bore logs electrical cone penetration tests and data from different airborne electromagnetic aem surveys that were carried out in the netherlands notable data sources include the extensive ves survey that was carried out in the 1960s van dam et al 1967 and the recent aem surveys in different parts of the netherlands e g delsman et al 2018 faneca sànchez et al 2012 these geophysical techniques either measure or model the bulk ground conductivity or its reciprocal bulk ground resistivity bore logging and electrical cone penetration tests ecpt measure a vertical profile of bulk ground conductivity surface ves or airborne techniques require inversion of the measured signal to obtain a vertical image kirsch 2006 siemon et al 2009 bulk ground conductivity in sedimentary settings such as the netherlands is influenced by both the electrical properties of the sediment matrix and the conductivity of the pore water especially in the presence of clayey sediments delsman et al 2018 converted bulk ground conductivity from a large scale aem survey in the dutch southwestern coastal zone freshem to pore water conductivity stochastically including uncertainty estimates for both lithology and electromagnetic properties we used these aem survey results as is for all other geophysical measurements we opted for a pragmatic approach and included only measurements in sandy sediments assigning a fixed formation factor of four goes et al 2009 de louw et al 2011 to convert from bulk ground conductivity to pore water conductivity our classification of sandy sediments was based on the existing hydrogeological databases geotop up to 50 m below msl van der meulen et al 2013 stafleu et al 2011 and regis ii from 50 m below msl onwards van der meulen et al 2013 vernes and van doorn 2005 depth intervals of bore logs and ecpts were downscaled to 1 m intervals interpreted ves layers were assigned at the depth of the center of the ves layer as is common practice in the netherlands we expressed groundwater salinity in chloride concentration hydrogeochemical analyses all included chloride concentration for available time series we retained the most recent measurement after a standard interquartile range outlier removal procedure groundwater conductivity as derived from geophysical measurements was converted to chloride concentration using a linear equation following delsman et al 2018 de louw et al 2011 chloride is the dominant anion in groundwater in the netherlands its concentration can be considered linear with conductivity for conductivities over 2 5 ms cm de louw et al 2011 3 1 2 interpolation workflow measurement values are uncertain as a result of analytical or measurement uncertainty uncertainty in the steps from actual geophysical measurement to derived chlorinity value or resulting from changes that have occurred since the time of the measurement measurements were assigned an uncertainty value based on the type of measurement the variability within the original time series and the age of the most recent measurement measurement uncertainty was calculated as follows u t o t a l max u t u t s f a with u total the assigned measurement uncertainty u t the measurement uncertainty of the measurement type table 1 u ts the standard deviation of the measurement time series if applicable and f a an age correction factor this factor was set to increase linearly from 1 if the measurement was done in the year 2000 or more recently to 10 if the measurement dated from 1900 or before note that we opted to include even old measurements to maximize the spatial distribution of available measurements uncertainty values in table 1 were based on a monte carlo error propagation for the different measurement types starting from 3 analytical uncertainty relative standard deviation delsman et al 2013 for chemical analyses additional uncertainty was subsequently added for the conversion of electrical conductivity to chloride de louw et al 2011 and formation factor uncertainty for ecpts and bore logging delsman et al 2018 plus finally ves inversion model uncertainty vandenbohede et al 2015 we further guided the interpolation by including fictitious or soft data in the interpolation to reflect more qualitative notions of the groundwater salinity distribution these well established notions e g delsman et al 2014 pauw et al 2017 post et al 2003 stuyfzand and stuurman 1994 as well as based on more theoretical considerations hanor 1994a 1994b involve the presence of saline groundwater beneath the north and wadden sea bordering the netherlands and the presence of brackish to saline groundwater at greater depths onshore the general lack of measurement data in these locations would otherwise cause extrapolation of existing measurements well outside their spatial support for the specific case of dunes bordering the sea this would mean extrapolating the fresh groundwater reserves found beneath the dune area seaward soft data were added offshore at 10 km intervals and at 50 m depth intervals salinity concentration was set to modeled seawater concentration at the given location zijl et al 2018 onshore soft data points were included at 10 km intervals at the geohydrological base and given a concentration reflecting existing maps of the 0 15 g l cl and 1 g l cl interface tno gdn 2020 where these interfaces did not intersect the geohydrological base concentration was set to 18 g l cl within the extent of the holocene marine transgression in the netherlands vos et al 2011 and where tertiary marine clay layers are present uncertainty of these soft data was set to fixed values based on expert judgement table 1 spatial interpolation was carried out using multiple indicator kriging journel 1983 of the cumulative distribution function cdf of the constructed set of chloride measurements for 7 indicator values 0 15 0 5 1 0 3 0 5 0 10 0 15 0 g l cl the indicator values were chosen with emphasis on lower values and to reflect important values from a water management perspective e g 0 15 g l cl is the drinking water threshold for chloride for the freshem aem survey delsman et al 2018 non parametric cdfs were available for every measurement point for all other measurements a normal cdf was used mean measurement value stdev measurement uncertainty freshem aem data was excluded from variogram modelling to prevent these data dominating the estimation no further declustering deutsch and journel 1998 was applied as the remaining data were relatively well distributed geographically fig 3 d vertical anisotropy was determined from directional variograms to be 120 horizontal vertical the model variogram was derived for the median indicator 3 g l cl and kept equal across indicators after interpolation cdfs with invalid order relations were corrected by averaging upward and downward corrections following deutsch and journel 1998 median interpolation results were tested using cross validation in a representative area denoted as cross validation area interpolation in fig 1a cross validation was only tested against recent chemical analyses as these were deemed the most certain input data type we additionally analyzed cross validation results after classifying input data and results to put more emphasis on lower value fresh measurements the interpolation workflow was programmed in a combination of the julia programming language bezanson et al 2017 and the r implementation of gstat pebesma and graeler 2019 it was computed in parallel across 36 cpus the workflow is available at https gitlab com deltares imod nhi fresh salt 3 1 3 surface water salinity distribution surface water salinity data were collected from relevant water authorities we used median values from time series after the year 2000 given its dense network of artificial waterways adjacent surface water bodies in the netherlands can often bear no relation to one another salinity measurements were therefore interpolated ordinary kriging spherical variogram within constructed polygons of distinct connected water bodies 3 2 coupled variable density groundwater flow and salt transport model 3 2 1 model construction we created a nation wide coupled variable density groundwater flow and salt transport model lhm fresh salt based on the existing national groundwater flow model lhm national policy studies use both models in conjunction with lhm fresh salt groundwater salinity results used as input for lhm model calculations e g delsman et al 2022 mens et al 2019 2021 as consistency between lhm and lhm fresh salt models is important we kept changes in parameter values and boundary conditions to a minimum lhm fresh salt model extent and horizontal resolution are equal to the lhm model covering the entire netherlands at a horizontal resolution of 250 250 m2 see model boundary in fig 1a given runtimes and memory requirements of the resulting high resolution nation wide model we used a parallelized implementation called imod wq of verkaik et al 2021 of the widely used seawat code langevin et al 2008 imod wq has already successfully been used in e g van engelen et al 2019 2021 the lhm model has discretized the subsurface in 8 aquifers and models intermediate aquitards implicitly as a resistance between successive aquifers quasi 3d approach solute transport modelling however requires a full 3d approach with explicitly modeled aquitards and a higher vertical resolution a procedure was developed to reproducibly generate a full 3d vertical discretization from the lhm 8 model layer discretization fig 2 step 1 first aquitards are explicitly included as additional model layers thereby increasing the number of model layers to 15 all confined aquifers and overlying aquitards are then subdivided in a preset number of layers 6 for lhm model layer 2 5 for lhm model layers 3 to 6 lhm model layers 7 and 8 are not further subdivided model layers are subsequently assigned to either the aquifer or aquitard depending on their respective thickness while ensuring aquifer contiguity the top phreatic aquifer is subdivided in a varying number of model layers maximum 9 depending on the thickness of the top model layer unassigned cells in these top layers are set to inactive minimum thickness of layers was set to 1 m for numerical computation time reasons e g the courant number criterion zheng and wang 1999 model parameters of the 8 layer lhm model were mapped onto the 39 layers of the lhm fresh salt model horizontal and vertical hydraulic conductivities were then calculated from transmissivity and vertical resistance values of the original model layers and new model layer thicknesses fig 2 step 2 even though model parameters are never physical but in reality effective parameters conditional on the chosen model structure kirchner 2006 we consider this approach justified as the model structure is not altered but merely subdivided the procedure increases the number of model layers from 8 to 39 ensures aquifer connectivity and allows for a consistent link between lhm and lhm fresh salt model layers facilitating the translation of parameter values between the models and allows for easy comparison of results between models note that flow results of the lhm model are not transferred to lhm fresh salt lhm fresh salt independently calculates groundwater flow all model layers except the model layers for the top phreatic aquifer are contiguous throughout the model a prerequisite of modflow seawat note that the recent modflow 6 version no longer necessitates continuous layering hughes et al 2017 groundwater recharge was applied at the top active layer as a long term average value derived from calculations with the lhm model the latter calculating recharge using the implicitly coupled soil vegetation atmosphere transfer model metaswap de lange et al 2014 van walsum and groenendijk 2008 note that this approach overlooks possible evaporative enrichment of salts in the soil we consider this allowable given the annual excess precipitation in the netherlands resetting soil concentrations every winter surface water boundary conditions were taken from the lhm model and assigned to lhm fresh salt model layers based on 1 the original lhm model layer and 2 elevation of river bottom or drainage level surface water salt concentration was assigned based on interpolated surface water salinity section 3 1 3 agricultural drainage was similarly derived from the lhm model and assigned to the appropriate lhm fresh salt model layer lhm model groundwater extraction wells were assigned to lhm fresh salt model layers based on known filter depths and distributed over multiple layers if necessary fig 2 step 3 we set the starting groundwater salinity to be the 50th percentile of the constructed 3d groundwater salinity distribution section 3 1 and set the corresponding model start time to be the year 2000 the approximate median measurement date of the original measurements we removed physically unrealistic salinity inversions in the 3d groundwater salinity distribution by filling salinity inversions with overlying salinity in the case of negligible vertical hydraulic resistance between the inversion and the overlying high salinity groundwater longitudinal dispersivity was set at 1 m similar to values used in comparable settings delsman et al 2014 lebbe 1999 oude essink et al 2010 horizontal and vertical transversal dispersivity was set at 0 1 and 0 01 m respectively zheng and wang 1999 we assigned a uniform molecular diffusion coefficient of 10 9 m2 s 1 fig 2 step 4 after initial conversion of the quantitative groundwater model lhm to a groundwater flow and salt transport model lhm fresh salt the latter model was checked for inconsistencies in boundary conditions and problematic cells in terms of calculation times related to the stability criteria for solute solvers zheng and wang 1999 we developed automated procedures to remove such problematic in cell combinations of higher level infiltrating and lower level draining boundary conditions nevertheless some manual corrections at specific locations remained necessary these specific corrections were also scripted to ensure reproducibility all corrections were registered for correction in future versions of the lhm model we further distributed groundwater extraction wells over surrounding cells and locally increased model layer thickness if calculated time steps related to large groundwater flow velocities and vertical model layer dimension became too small fig 2 step 5 the resulting model consisted of over 31m active cells uses 33 4 gb of ram while calculation time was about 75 min per year on 24 cpus the entire workflow of constructing the lhm fresh salt model from the lhm model and additional data is scripted in a collection of python scripts these scripts make extensive use of the imod python library an open source library that facilitates scripted modflow modelling using large datasets visser and bootsma 2022 scripts are contained within an open source workflow manager snakemake mölder et al 2021 that relates input and output of the various scripts and ensures proper order of execution the collection of scripts and workflow is version controlled and publicly available at https gitlab com deltares imod nhi fresh salt 3 2 2 calibration validation and sea level rise scenario subsurface parameters transmissivity and vertical resistance and drainage parameters of the lhm model were recently calibrated on stationary heads using a zoned non linear parameter estimation approach levenberg marquardt algorithm as implemented in the imod software janssen et al 2020 vermeulen et al 2020 the median head residual after calibration was 0 03 m janssen et al 2020 these parameters are also implemented in lhm fresh salt for reasons of consistency between models no further calibration of flow parameters was performed the lhm model serves as the benchmark for the lhm fresh salt model again as the model structure was not changed significantly between models we consider calibration results for the lhm model to be valid for the lhm fresh salt model as well no calibration or validation of transport specific parameters was performed calibration or validation on groundwater salinity concentrations is ineffectual as groundwater salinity changes generally occur over timescales longer than recorded in the measurements and modeled concentrations merely reflect inputted starting conditions calibration on non traditional observations such as salt fluxes or age tracers delsman et al 2016 meyer et al 2018 schilling et al 2019 was not attempted given the limited available data america et al 2021 and expected involved calculation times we however verified correct conversion of lhm to lhm fresh salt by comparing head results of both models excluding variable density in the lhm fresh salt for correct comparison we assessed plausibility of lhm fresh salt results using limited available data on salt fluxes to surface water we further qualitatively assessed modeled changes in groundwater salinity as large changes are indicative of mismatches between modeled groundwater flow and the starting condition salinity distribution qualitative sensitivity analyses were performed to evaluate implemented effective porosity values varied between 0 3 and 0 48 and between 0 1 and 0 5 for sandy and clayey layers respectively on model outcomes finally we investigated model response to a long term sea level rise scenario sea level was implemented to rise up to 3 m above current sea level by the year 2278 haasnoot et al 2018 2019 in this scenario water level in open estuaries rises with sea level rise while closed off estuaries kept their current water level groundwater recharge remained unchanged results were compared to an autonomous model run with constant boundary conditions over the same time period this was done to isolate sea level rise effects from ongoing changes in groundwater salinity due to historical landscape evolution as groundwater salinity has not yet reached equilibrium with present day boundary conditions delsman et al 2014 4 results 4 1 groundwater salinity distribution in total groundwater salinity measurements at 2 6m x y z locations were collected at 0 9m x y locations fig 3 note that 2 2m of the 2 6m measurements locations were part of the large scale freshem airborne em survey in the southwestern part of the netherlands delsman et al 2018 measurements were not spread evenly across chloride concentration vast majority of measurements is fresh groundwater fig 3a depth skewed towards shallow measurements fig 3b or measurement year wide distribution skewed towards more recent measurements median 2000 fig 3c distribution of measurements over depth and measurement year varies geographically with specific areas having been collected during specific surveys notable examples are the nationwide ves campaign in the 1960s and 70s dam et al 1967 the large scale freshem airborne survey of 2014 2015 in the southwestern province of zeeland delsman et al 2018 or the lake ijssel and lake marker area where the majority of data stems from a survey that analyzed groundwater samples at depths of 20 and 50 m during the 1970s and 80s 3d multiple indicator kriging resulted in a 3d representation of the estimated probability of groundwater chloride concentration on a rectilinear grid of 250 250 m2 in the horizontal and of varying thickness ranging from 2 to 20 m in the vertical fig 4 cross validation in a representative subarea revealed a mean error of 0 05 g l cl and a mean absolute error of 0 87 g l cl table 2 classified cross validation revealed a mean error of 0 13 classes and a mean absolute error of 0 57 classes interpolation results show a clear pattern of groundwater salinization in the western coastal region of the netherlands and fresh groundwater reserves in the east groundwater is brackish to saline to approximately at least 30 km from the coastline with localized occurrences of brackish groundwater further inland fig 4a uncertainty of the interpolation result is larger in the coastal region and generally increases with depth the uncertainty is reflecting the larger spread in measurement values in the coastal region and the relative lack of measurements at greater depths note that brackish to saline groundwater does additionally occur further inland at greater depths below the vertical extent of the interpolation result set to the hydrogeological base of the lhm model the 3d groundwater salinity distribution has been made publicly available through the nhi data portal https data nhi nu 4 2 variable density groundwater flow and salt transport model lhm fresh salt a nationwide variable density groundwater flow and salt transport model lhm fresh salt was constructed using our documented scripted workflow since the first inception of the lhm fresh salt model two updated version were constructed following recent updates to the lhm groundwater flow model currently at version 4 1 head differences with the original lhm groundwater flow model are minor when variable density is not included in lhm fresh salt model calculations median head difference 1 6 10 3 m 9 4 10 2 m 10th 90th percentile range larger differences are explainable from conceptual differences between the lhm and lhm fresh salt models fig 5 conceptual differences include the fully 3d groundwater flow calculation in the lhm fresh salt model versus the quasi 3d approach in the lhm model introducing additional resistance to vertical flow i in fig 5b especially large in the southeastern higher elevation limestone region and the spatial and vertical distribution of extraction wells or boundary fluxes in lhm fresh salt as compared to lhm ii in fig 5b with variable density included in lhm fresh salt calculation head differences between the two models increase with increasing groundwater salinity with maximum fresh water head differences reaching well over 2 m for the deepest model layers fig 5c and d validation of calculated salt fluxes to surface water generally showed plausible results 60 of compared polders met set plausibility criteria acacia water and consultancy 2021 america et al 2021 delsman et al 2020 this validation is however hampered by scant availability of measurement data as measurements of only five polders are available and mostly based on non recent data assessment of modeled changes in the groundwater salinity distribution revealed several areas where the initial salinity distribution appears not to be in steady state with the prevailing hydrologic boundary conditions while some of these are likely indicative of model error and warrant further research most notable the coastal dune areas and the southwestern province of zeeland most changes were deemed to be expected given the physiographical changes occurring over the past several centennia america et al 2021 delsman et al 2014 evaluation of the effect of varying effective porosity values in the model revealed a significant and expected effect of effective porosity on the modeled depth of the 100 year groundwater age boundary mean difference 8 4 m stdev 13 2 m between assigned low and high values the constructed lhm fresh salt model was used to calculate a sea level rise scenario with the sea rising 3 m by the year 2278 fig 6 shows results of head and salt load increase caused by 3 m year 2278 sea level rise salt load is defined here as the chloride mass flowing upward from the first aquifer into the overlying confining layer where it exfiltrates to surface water fig 6 results are relative to a constant present day boundary conditions scenario to isolate the effect of sea level rise the groundwater salinity distribution is not in equilibrium with present day boundary conditions and will still be adapting to historical landscape changes over the model period e g delsman et al 2014 oude essink et al 2010 sea level rise effects are generally limited to about 10 km inland from the coast or open estuaries regional differences in the landward extent of sea level rise effects are caused by hydrogeological differences landward extent in the southwest of the netherlands are for instance caused by locally low aquifer thickness and hence transmissivity increase in salt load fig 6b shows a generally comparable geographical pattern to the head increase the geographical pattern is however limited to exfiltration areas with brackish to saline groundwater the head increase in the center of the netherlands bordering the open rhine meuse estuary where groundwater salinity is low is therefore not mirrored in a salt load increase fig 7 shows the development of both sea level rise and the total salt load increase over the model period up to the year 2278 the increase of total salt load is not linear with sea level rise but shows an acceleration over time head increase in the aquifer is the first driver of salt load this head increase is directly related to the local hydrogeological conditions and linear with sea level rise and occurs near instantaneous over the longer time scales considered here however landward and upward flow of higher salinity infiltrated saline groundwater starts to contribute to increased salt loads causing the observed acceleration 5 discussion the netherlands hydrological instrument nhi is a long term collaborative effort to improve hydro geo logical data and modelling for water management in the netherlands and serves as the de facto knowledge basis for water related policy making in the netherlands this paper presents the addition of a nationwide 3d groundwater salinity distribution and variable density groundwater flow and salt transport model to the nhi geostatistical mapping of groundwater salinity using available point measurements is commonplace and different techniques have been applied by different researchers various kriging methods including multiple indicator kriging e g abdelhamid et al 2016 arslan 2012 triantafilis et al 2004 or machine learning sahour et al 2020 geostatistical mapping is however generally restricted to 2d gunnink et al 2021 present a large scale 3d mapping of groundwater salinity in vietnam using a largely similar approach as the one presented in this article we however include measurement uncertainty for each individual data point in our approach related to the measurement itself to the translation of bulk resistivity to chloride and to possible changes that have occurred since the measurement as did gunnink et al 2021 we showed that geostatistical mapping of groundwater salinity measurements to provide a 3d distribution of groundwater salinity is feasible for large scale groundwater systems and provides valuable information for sustainable water management applying additional monte carlo methods sequential indicator simulation e g gunnink et al 2021 to estimate the uncertainty of fresh groundwater volumes is left for future work notwithstanding the interpolation approach errors still exist in the interpolation result as the available data density is especially at greater depths unable to fully capture existing groundwater salinity variations when used as initial groundwater salinity distribution in a variable density groundwater flow and salt transport model the groundwater salinity distribution will likely not be in equilibrium with model boundary conditions resulting in difficult to detect model artefacts the use of airborne geophysics to map groundwater salinity at high detail has started to become more common delsman et al 2018 faneca sànchez et al 2012 fitterman and deszcz pan 1998 jørgensen et al 2012 knight et al 2018 rahman et al 2021 siemon et al 2009 2011 sulzbacher et al 2012 tosi et al 2022 with advances being made to separate groundwater salinity from the acquired signal and quantify the associated uncertainty delsman et al 2018 king et al 2018 2020 we designed our interpolation workflow to easily accommodate new available salinity data from e g future airborne surveys the netherlands hydrological instrument is annually updated reflecting continuously improving knowledge on hydro geo logical parameters and processes in the netherlands de lange et al 2014 allowing regular updates of the constructed variable density groundwater and coupled salt transport model is therefore paramount to our approach constructing a variable density groundwater model from an existing groundwater flow model is however far from straightforward first additional data is required most prominently the distribution of groundwater salinity at model start the scripted construction of the groundwater salinity distribution satisfies this data requirement second solving the advection dispersion equation imposes possibly limiting discretization restrictions to satisfy either courant or péclet number limitations oude essink 2003 several scripted procedures were implemented to prevent excessive groundwater flow velocities that necessitate small numerical time steps and hence long calculation times although still some manual corrections were necessary in model construction our approach greatly accelerated the model building process our scripted model building workflow facilitates regular construction of a variable density groundwater flow and salt transport model from annually updated versions of the nationwide groundwater flow model two such updated versions of the lhm fresh salt model have since been constructed the transparent and reproducible open source workflow further aided stakeholder trust in model results the lhm fresh salt model itself has not been calibrated rather adopting calibrated model parameters directly from the lhm model as model structure is kept almost equal between models effective model parameters kirchner 2006 were considered transferable between lhm and lhm fresh salt transport specific parameters however were left uncalibrated and only qualitatively tested for plausibility calibration to non traditional targets is generally recognized to improve calibration of groundwater models when compared to calibrating against only head observations delsman et al 2016 schilling et al 2019 the repeatable construction of a groundwater transport model based on a groundwater flow model offers the possibility to calibrate against different targets such as age delsman et al 2014 meyer et al 2018 recharge origin delsman et al 2014 or groundwater salinity patterns delsman et al 2016 benefiting parameterization of both models using the lhm fresh salt model to calibrate to such targets was not possible within this research but is a clear direction for future study efforts must be then made to obtain the required observational data as available data is currently too scarce for such an effort in addition care must be taken to account for the long timescales involved in groundwater flow in large scale models the ensuing dependency of modeled concentrations on the starting condition and the occurring landscape changes and hence changes in boundary conditions over the involved timescales delsman et al 2014 show the importance of changing boundary conditions to shape the evolution of groundwater in coastal aquifers while also showing paleo modelling as a way to take such changes into account paleo modelling has since been shown to be feasible even for large scale 3d variable density groundwater flow and salt transport models van engelen et al 2019 meyer et al 2019 we applied the parallel computation of variable density groundwater flow and coupled salt transport developed by verkaik et al 2021 to drastically reduce model calculation times our model size of 31m active cells exceeds previous large variable density groundwater and salt transport models reported in literature such as the 2 7m cells sand engine model huizer et al 2016 the 5 9m cells pzh model oude essink et al 2010 the 2m cells nile delta paleo reconstruction model van engelen et al 2019 or the 4 5 m cells danish german border paleo reconstruction model meyer et al 2019 our example shows that with parallel computing and careful model construction large scale modelling of variable density groundwater flow and salt transport has become feasible even without the use of supercomputer infrastructure calculated landward groundwater salinity effects of a 3 m sea level rise scenario serves as an example of the societal relevance of large scale variable density groundwater flow and salt transport models modelling results showed the significant impact of sea level rise on a coastal groundwater system transient modelling of salt transport over centennial time scales was shown to be crucial to the projection of future groundwater salinity given the cumulative influence of the slow flow of groundwater and dissolved salts through porous media over these time scales freshwater availability is under stress in coastal aquifers around the world van engelen et al 2022 signifying a global need for variable density groundwater flow and salt transport models to inform policy decisions in coastal zones in this paper we show that the construction and utility of such models is greatly facilitated by a scripted model construction workflow a scripted interpolation workflow and advances in parallel computation the presented scripted workflow facilitates regular updating of the model ensures consistency with existing groundwater models allows conjunctive calibration and use of models and increases transparency and thereby stakeholder trust in model results consistency between groundwater flow models and variable density groundwater flow and salt transport models aids transferability of parameters and simplifies their conjunctive use in policy research these benefits are not limited to the presented case as the presented approach is transferable to coastal aquifers around the world software and data availability interpolating and modelling workflows are available at https gitlab com deltares imod nhi fresh salt model software imod wq is available open source at https oss deltares nl web imod the netherlands 3d groundwater salinity and other model inputs are available from the nhi data portal https data nhi nu input data for the presented workflow are available from https doi org 10 5281 zenodo 7419219 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank manuscript editor f sarrazin and two anonymous reviewers for their help in improving this manuscript 
25404,freshwater availability in the coastal zone is threatened by overexploitation seawater intrusion and global change recent advances in parallel computing of coupled variable density groundwater flow and salt transport models enable the construction of large scale high resolution models key to support sound policy making here we present the construction of a nationwide coupled variable density groundwater flow and salt transport model for the netherlands derived from the existing nationwide groundwater flow model construction of the model is fully scripted in a reproducible and transparent version controlled workflow aiding regular updating and stakeholder trust in model results a 3d groundwater salinity distribution was interpolated from over 2m available measurements using multiple indicator kriging as a starting condition in the model calculation of a high end sea level rise scenario shows the added benefit of large scale groundwater salinity modelling for policy making the presented approach is generally applicable to groundwater flow models of coastal aquifers keywords coastal aquifers salt intrusion groundwater modelling parallel computing the netherlands 1 introduction coastal lowlands are amongst the world s most densely populated areas owing to their mild relief fertile soils and easy access to transport connections and fish stocks nicholls and small 2002 shallow groundwater in coastal lowlands is often saline as a result of recent sea water intrusion werner et al 2013 marine transgressions delsman et al 2014 van engelen et al 2021 hung van pham et al 2019 larsen et al 2017 meyer et al 2019 zamrsky et al 2020 storm surges paldor and michael 2021 xiao et al 2019 yang et al 2013 2018 or tsunamis illangasekare et al 2006 liu and tokunaga 2019 or over exploitation of coastal aquifers custodio and bruggeman 1987 dibaj et al 2020 salinization issues in coastal lowlands are likely to be exacerbated by population growth climate change and sea level rise haasnoot et al 2020 loáiciga et al 2011 michael et al 2013 oude essink et al 2010 vandenbohede et al 2008 xiao et al 2021 optimal planning for sustainable use of coastal fresh groundwater resources can greatly benefit from numerical modelling of these resources on different scales however modelling coupled variable density groundwater flow and salt transport is complex and is hampered by numerical issues large computational demands and data availability oude essink 2003 werner et al 2013 the number of published large scale 2m cells and above variable density groundwater flow and coupled salt transport models is therefore limited e g van engelen et al 2019 huizer et al 2016 meyer et al 2019 oude essink et al 2010 most reported variable density groundwater flow and coupled salt transport models are of limited spatial extent or have coarse resolution e g dibaj et al 2020 faneca sànchez et al 2012 lu et al 2013 mabrouk et al 2019 sulzbacher et al 2012 vandenbohede et al 2008 yang et al 2015 recent distributed memory parallelization of the seawat modelling code offers speedups of over two orders of magnitude verkaik et al 2021 making large scale variable density groundwater flow and salt transport models with manageable runtimes feasible van engelen et al 2021 verkaik et al 2021 one key example of difficulties in data availability is the difficult to obtain 3d distribution of present day groundwater salinity as a model starting condition recent measurements of groundwater salinity are generally sparse the quality of the measurements varies and groundwater salinity may seriously vary within short distances driven by relatively minor head gradients de louw et al 2011 while airborne geophysics promises cost effective large scale monitoring of groundwater salinity delsman et al 2018 faneca sànchez et al 2012 siemon et al 2011 the availability of airborne data is still limited cannot be collected in urbanized areas and is less reliable with increasing depth the lack of a present day groundwater salinity distribution has prompted several researchers to assume steady state starting conditions obtained by a spin up period applying current boundary conditions e g souza and voss 1987 vandenbohede et al 2011 vandenbohede and lebbe 2002 coastal groundwater systems are however rarely in equilibrium given the usually long timescales involved and present day groundwater salinity distributions often still reflect events occurring thousands or even millions of years ago delsman et al 2014 van engelen et al 2021 hung van pham et al 2019 meisler et al 1984 meyer et al 2019 post et al 2013 zamrsky et al 2018 a collaborative effort of different research and government institutes drinking water companies and engineering firms in the netherlands started in 2005 to jointly develop a national hydrological modelling instrument the netherlands hydrological instrument nhi de lange et al 2014 the nhi has since further developed into a common repository of hydro geo logical data and regional and national scale modelling tools for the netherlands http www nhi nu central to the nhi is a transparent reproducible collaborative modelling approach where modeler s adaptations to hydro geo logical parameters are reviewed and fed into the common repository de lange et al 2014 since de lange et al 2014 the national scale hydrological model has been renamed to lhm landelijk hydrologisch model dutch for nationwide hydrological model the lhm model is widely used for national studies for e g fresh water supply management prinsen et al 2013 water quality assessment vermaat et al 2016 climate change adaptation studies haasnoot et al 2020 or drought risk management mens et al 2021 groundwater salinity variations strongly influence groundwater flow in coastal aquifers in addition saline groundwater exfiltration negatively affects surface water quality and is a key concern for water managers however no nationwide variable density groundwater flow model for the netherlands currently exists limiting scenario studies for e g the possible adaptation to sea level rise haasnoot et al 2020 or drought risk management mens et al 2021 in this paper we outline the construction of a probabilistic 3d groundwater salinity distribution of the netherlands based on the interpolation of over 2 6m unique measurement locations of different measurement types we further present the construction of a nationwide variable density groundwater flow and coupled groundwater salt transport model of the netherlands 31m active cells based on the existing lhm groundwater flow model and the newly constructed 3d groundwater salinity distribution and show the usefulness of the model by calculating effects of a sea level rise scenario on groundwater salinity model construction is fully scripted open source within a workflow manager ensuring transparent and reproducible model results the scripted workflow facilitates continuous updating of the groundwater flow and salt transport model within the nhi collaborative modelling approach de lange et al 2014 we finally discuss benefits of our approach based on the presented case study 2 groundwater salinity in the netherlands the netherlands is a low lying country situated in the delta of the rhine meuse and scheldt rivers the country is bordered in the west by the north sea average annual precipitation surplus amounts to 190 mm knmi 2020 the hydrogeology is characterized by soft sedimentary tertiary pleistocene and holocene deposits of marine fluvial aeolian and glacial origin thickness of these intercalated sandy and clayey deposits increases from only a few meters in the east to about 700 m in the north west sea level rise during the holocene resulted in the deposition of marine and fluvial clays in the western half of the country intersected by sandy riverbed and creek bed deposits weerts et al 2005 thick organic deposits were concurrently formed in extensive freshwater marshes dufour 2000 human influence increased from the 11th century ad onwards van de ven 1993 anthropogenic drainage river embankment and peat extraction resulted in widespread land subsidence erkens et al 2016 currently about a third of the netherlands is situated below mean sea level msl fig 1 a groundwater in the netherlands is brackish to saline within a few meters below surface level in large parts of the coastal zone fig 1b further inland groundwater salinity occurs at larger depths and is of connate tertiary origin halite dissolution is a source of saline groundwater where zechstein diapirs have protruded upward stuyfzand and stuurman 1994 conversely groundwater salinity in the coastal region of the netherlands originates mainly from free convective infiltration during holocene marine transgressions delsman et al 2014 post et al 2003 subsequent subsidence caused by anthropogenic drainage and land reclamation has resulted in groundwater and hence saline groundwater to flow upwards delsman et al 2014 shallow saline groundwater rises up into the rootzone de louw et al 2011 or exfiltrates to and thereby salinizes surface water delsman et al 2013 de louw et al 2010 the upward flow of saline groundwater has adverse consequences on agricultural production in the coastal regions of the netherlands raats 2015 and has caused abandonment of drinking water supply wells stuyfzand 1996 3 methods 3 1 3d groundwater salinity distribution 3 1 1 data collection and pre processing we collected hydrogeochemical analyses from the netherlands database of subsurface data dino https www dinoloket nl we additionally collected hydrogeochemical analyses from relevant organisations in the netherlands drinking water companies provincial authorities water boards that were not already present in the dino database apart from direct measurements of groundwater chemistry a variety of geophysical techniques exist that contain information on groundwater salinity we obtained vertical electrical soundings ves resistivity and electromagnetic bore logs electrical cone penetration tests and data from different airborne electromagnetic aem surveys that were carried out in the netherlands notable data sources include the extensive ves survey that was carried out in the 1960s van dam et al 1967 and the recent aem surveys in different parts of the netherlands e g delsman et al 2018 faneca sànchez et al 2012 these geophysical techniques either measure or model the bulk ground conductivity or its reciprocal bulk ground resistivity bore logging and electrical cone penetration tests ecpt measure a vertical profile of bulk ground conductivity surface ves or airborne techniques require inversion of the measured signal to obtain a vertical image kirsch 2006 siemon et al 2009 bulk ground conductivity in sedimentary settings such as the netherlands is influenced by both the electrical properties of the sediment matrix and the conductivity of the pore water especially in the presence of clayey sediments delsman et al 2018 converted bulk ground conductivity from a large scale aem survey in the dutch southwestern coastal zone freshem to pore water conductivity stochastically including uncertainty estimates for both lithology and electromagnetic properties we used these aem survey results as is for all other geophysical measurements we opted for a pragmatic approach and included only measurements in sandy sediments assigning a fixed formation factor of four goes et al 2009 de louw et al 2011 to convert from bulk ground conductivity to pore water conductivity our classification of sandy sediments was based on the existing hydrogeological databases geotop up to 50 m below msl van der meulen et al 2013 stafleu et al 2011 and regis ii from 50 m below msl onwards van der meulen et al 2013 vernes and van doorn 2005 depth intervals of bore logs and ecpts were downscaled to 1 m intervals interpreted ves layers were assigned at the depth of the center of the ves layer as is common practice in the netherlands we expressed groundwater salinity in chloride concentration hydrogeochemical analyses all included chloride concentration for available time series we retained the most recent measurement after a standard interquartile range outlier removal procedure groundwater conductivity as derived from geophysical measurements was converted to chloride concentration using a linear equation following delsman et al 2018 de louw et al 2011 chloride is the dominant anion in groundwater in the netherlands its concentration can be considered linear with conductivity for conductivities over 2 5 ms cm de louw et al 2011 3 1 2 interpolation workflow measurement values are uncertain as a result of analytical or measurement uncertainty uncertainty in the steps from actual geophysical measurement to derived chlorinity value or resulting from changes that have occurred since the time of the measurement measurements were assigned an uncertainty value based on the type of measurement the variability within the original time series and the age of the most recent measurement measurement uncertainty was calculated as follows u t o t a l max u t u t s f a with u total the assigned measurement uncertainty u t the measurement uncertainty of the measurement type table 1 u ts the standard deviation of the measurement time series if applicable and f a an age correction factor this factor was set to increase linearly from 1 if the measurement was done in the year 2000 or more recently to 10 if the measurement dated from 1900 or before note that we opted to include even old measurements to maximize the spatial distribution of available measurements uncertainty values in table 1 were based on a monte carlo error propagation for the different measurement types starting from 3 analytical uncertainty relative standard deviation delsman et al 2013 for chemical analyses additional uncertainty was subsequently added for the conversion of electrical conductivity to chloride de louw et al 2011 and formation factor uncertainty for ecpts and bore logging delsman et al 2018 plus finally ves inversion model uncertainty vandenbohede et al 2015 we further guided the interpolation by including fictitious or soft data in the interpolation to reflect more qualitative notions of the groundwater salinity distribution these well established notions e g delsman et al 2014 pauw et al 2017 post et al 2003 stuyfzand and stuurman 1994 as well as based on more theoretical considerations hanor 1994a 1994b involve the presence of saline groundwater beneath the north and wadden sea bordering the netherlands and the presence of brackish to saline groundwater at greater depths onshore the general lack of measurement data in these locations would otherwise cause extrapolation of existing measurements well outside their spatial support for the specific case of dunes bordering the sea this would mean extrapolating the fresh groundwater reserves found beneath the dune area seaward soft data were added offshore at 10 km intervals and at 50 m depth intervals salinity concentration was set to modeled seawater concentration at the given location zijl et al 2018 onshore soft data points were included at 10 km intervals at the geohydrological base and given a concentration reflecting existing maps of the 0 15 g l cl and 1 g l cl interface tno gdn 2020 where these interfaces did not intersect the geohydrological base concentration was set to 18 g l cl within the extent of the holocene marine transgression in the netherlands vos et al 2011 and where tertiary marine clay layers are present uncertainty of these soft data was set to fixed values based on expert judgement table 1 spatial interpolation was carried out using multiple indicator kriging journel 1983 of the cumulative distribution function cdf of the constructed set of chloride measurements for 7 indicator values 0 15 0 5 1 0 3 0 5 0 10 0 15 0 g l cl the indicator values were chosen with emphasis on lower values and to reflect important values from a water management perspective e g 0 15 g l cl is the drinking water threshold for chloride for the freshem aem survey delsman et al 2018 non parametric cdfs were available for every measurement point for all other measurements a normal cdf was used mean measurement value stdev measurement uncertainty freshem aem data was excluded from variogram modelling to prevent these data dominating the estimation no further declustering deutsch and journel 1998 was applied as the remaining data were relatively well distributed geographically fig 3 d vertical anisotropy was determined from directional variograms to be 120 horizontal vertical the model variogram was derived for the median indicator 3 g l cl and kept equal across indicators after interpolation cdfs with invalid order relations were corrected by averaging upward and downward corrections following deutsch and journel 1998 median interpolation results were tested using cross validation in a representative area denoted as cross validation area interpolation in fig 1a cross validation was only tested against recent chemical analyses as these were deemed the most certain input data type we additionally analyzed cross validation results after classifying input data and results to put more emphasis on lower value fresh measurements the interpolation workflow was programmed in a combination of the julia programming language bezanson et al 2017 and the r implementation of gstat pebesma and graeler 2019 it was computed in parallel across 36 cpus the workflow is available at https gitlab com deltares imod nhi fresh salt 3 1 3 surface water salinity distribution surface water salinity data were collected from relevant water authorities we used median values from time series after the year 2000 given its dense network of artificial waterways adjacent surface water bodies in the netherlands can often bear no relation to one another salinity measurements were therefore interpolated ordinary kriging spherical variogram within constructed polygons of distinct connected water bodies 3 2 coupled variable density groundwater flow and salt transport model 3 2 1 model construction we created a nation wide coupled variable density groundwater flow and salt transport model lhm fresh salt based on the existing national groundwater flow model lhm national policy studies use both models in conjunction with lhm fresh salt groundwater salinity results used as input for lhm model calculations e g delsman et al 2022 mens et al 2019 2021 as consistency between lhm and lhm fresh salt models is important we kept changes in parameter values and boundary conditions to a minimum lhm fresh salt model extent and horizontal resolution are equal to the lhm model covering the entire netherlands at a horizontal resolution of 250 250 m2 see model boundary in fig 1a given runtimes and memory requirements of the resulting high resolution nation wide model we used a parallelized implementation called imod wq of verkaik et al 2021 of the widely used seawat code langevin et al 2008 imod wq has already successfully been used in e g van engelen et al 2019 2021 the lhm model has discretized the subsurface in 8 aquifers and models intermediate aquitards implicitly as a resistance between successive aquifers quasi 3d approach solute transport modelling however requires a full 3d approach with explicitly modeled aquitards and a higher vertical resolution a procedure was developed to reproducibly generate a full 3d vertical discretization from the lhm 8 model layer discretization fig 2 step 1 first aquitards are explicitly included as additional model layers thereby increasing the number of model layers to 15 all confined aquifers and overlying aquitards are then subdivided in a preset number of layers 6 for lhm model layer 2 5 for lhm model layers 3 to 6 lhm model layers 7 and 8 are not further subdivided model layers are subsequently assigned to either the aquifer or aquitard depending on their respective thickness while ensuring aquifer contiguity the top phreatic aquifer is subdivided in a varying number of model layers maximum 9 depending on the thickness of the top model layer unassigned cells in these top layers are set to inactive minimum thickness of layers was set to 1 m for numerical computation time reasons e g the courant number criterion zheng and wang 1999 model parameters of the 8 layer lhm model were mapped onto the 39 layers of the lhm fresh salt model horizontal and vertical hydraulic conductivities were then calculated from transmissivity and vertical resistance values of the original model layers and new model layer thicknesses fig 2 step 2 even though model parameters are never physical but in reality effective parameters conditional on the chosen model structure kirchner 2006 we consider this approach justified as the model structure is not altered but merely subdivided the procedure increases the number of model layers from 8 to 39 ensures aquifer connectivity and allows for a consistent link between lhm and lhm fresh salt model layers facilitating the translation of parameter values between the models and allows for easy comparison of results between models note that flow results of the lhm model are not transferred to lhm fresh salt lhm fresh salt independently calculates groundwater flow all model layers except the model layers for the top phreatic aquifer are contiguous throughout the model a prerequisite of modflow seawat note that the recent modflow 6 version no longer necessitates continuous layering hughes et al 2017 groundwater recharge was applied at the top active layer as a long term average value derived from calculations with the lhm model the latter calculating recharge using the implicitly coupled soil vegetation atmosphere transfer model metaswap de lange et al 2014 van walsum and groenendijk 2008 note that this approach overlooks possible evaporative enrichment of salts in the soil we consider this allowable given the annual excess precipitation in the netherlands resetting soil concentrations every winter surface water boundary conditions were taken from the lhm model and assigned to lhm fresh salt model layers based on 1 the original lhm model layer and 2 elevation of river bottom or drainage level surface water salt concentration was assigned based on interpolated surface water salinity section 3 1 3 agricultural drainage was similarly derived from the lhm model and assigned to the appropriate lhm fresh salt model layer lhm model groundwater extraction wells were assigned to lhm fresh salt model layers based on known filter depths and distributed over multiple layers if necessary fig 2 step 3 we set the starting groundwater salinity to be the 50th percentile of the constructed 3d groundwater salinity distribution section 3 1 and set the corresponding model start time to be the year 2000 the approximate median measurement date of the original measurements we removed physically unrealistic salinity inversions in the 3d groundwater salinity distribution by filling salinity inversions with overlying salinity in the case of negligible vertical hydraulic resistance between the inversion and the overlying high salinity groundwater longitudinal dispersivity was set at 1 m similar to values used in comparable settings delsman et al 2014 lebbe 1999 oude essink et al 2010 horizontal and vertical transversal dispersivity was set at 0 1 and 0 01 m respectively zheng and wang 1999 we assigned a uniform molecular diffusion coefficient of 10 9 m2 s 1 fig 2 step 4 after initial conversion of the quantitative groundwater model lhm to a groundwater flow and salt transport model lhm fresh salt the latter model was checked for inconsistencies in boundary conditions and problematic cells in terms of calculation times related to the stability criteria for solute solvers zheng and wang 1999 we developed automated procedures to remove such problematic in cell combinations of higher level infiltrating and lower level draining boundary conditions nevertheless some manual corrections at specific locations remained necessary these specific corrections were also scripted to ensure reproducibility all corrections were registered for correction in future versions of the lhm model we further distributed groundwater extraction wells over surrounding cells and locally increased model layer thickness if calculated time steps related to large groundwater flow velocities and vertical model layer dimension became too small fig 2 step 5 the resulting model consisted of over 31m active cells uses 33 4 gb of ram while calculation time was about 75 min per year on 24 cpus the entire workflow of constructing the lhm fresh salt model from the lhm model and additional data is scripted in a collection of python scripts these scripts make extensive use of the imod python library an open source library that facilitates scripted modflow modelling using large datasets visser and bootsma 2022 scripts are contained within an open source workflow manager snakemake mölder et al 2021 that relates input and output of the various scripts and ensures proper order of execution the collection of scripts and workflow is version controlled and publicly available at https gitlab com deltares imod nhi fresh salt 3 2 2 calibration validation and sea level rise scenario subsurface parameters transmissivity and vertical resistance and drainage parameters of the lhm model were recently calibrated on stationary heads using a zoned non linear parameter estimation approach levenberg marquardt algorithm as implemented in the imod software janssen et al 2020 vermeulen et al 2020 the median head residual after calibration was 0 03 m janssen et al 2020 these parameters are also implemented in lhm fresh salt for reasons of consistency between models no further calibration of flow parameters was performed the lhm model serves as the benchmark for the lhm fresh salt model again as the model structure was not changed significantly between models we consider calibration results for the lhm model to be valid for the lhm fresh salt model as well no calibration or validation of transport specific parameters was performed calibration or validation on groundwater salinity concentrations is ineffectual as groundwater salinity changes generally occur over timescales longer than recorded in the measurements and modeled concentrations merely reflect inputted starting conditions calibration on non traditional observations such as salt fluxes or age tracers delsman et al 2016 meyer et al 2018 schilling et al 2019 was not attempted given the limited available data america et al 2021 and expected involved calculation times we however verified correct conversion of lhm to lhm fresh salt by comparing head results of both models excluding variable density in the lhm fresh salt for correct comparison we assessed plausibility of lhm fresh salt results using limited available data on salt fluxes to surface water we further qualitatively assessed modeled changes in groundwater salinity as large changes are indicative of mismatches between modeled groundwater flow and the starting condition salinity distribution qualitative sensitivity analyses were performed to evaluate implemented effective porosity values varied between 0 3 and 0 48 and between 0 1 and 0 5 for sandy and clayey layers respectively on model outcomes finally we investigated model response to a long term sea level rise scenario sea level was implemented to rise up to 3 m above current sea level by the year 2278 haasnoot et al 2018 2019 in this scenario water level in open estuaries rises with sea level rise while closed off estuaries kept their current water level groundwater recharge remained unchanged results were compared to an autonomous model run with constant boundary conditions over the same time period this was done to isolate sea level rise effects from ongoing changes in groundwater salinity due to historical landscape evolution as groundwater salinity has not yet reached equilibrium with present day boundary conditions delsman et al 2014 4 results 4 1 groundwater salinity distribution in total groundwater salinity measurements at 2 6m x y z locations were collected at 0 9m x y locations fig 3 note that 2 2m of the 2 6m measurements locations were part of the large scale freshem airborne em survey in the southwestern part of the netherlands delsman et al 2018 measurements were not spread evenly across chloride concentration vast majority of measurements is fresh groundwater fig 3a depth skewed towards shallow measurements fig 3b or measurement year wide distribution skewed towards more recent measurements median 2000 fig 3c distribution of measurements over depth and measurement year varies geographically with specific areas having been collected during specific surveys notable examples are the nationwide ves campaign in the 1960s and 70s dam et al 1967 the large scale freshem airborne survey of 2014 2015 in the southwestern province of zeeland delsman et al 2018 or the lake ijssel and lake marker area where the majority of data stems from a survey that analyzed groundwater samples at depths of 20 and 50 m during the 1970s and 80s 3d multiple indicator kriging resulted in a 3d representation of the estimated probability of groundwater chloride concentration on a rectilinear grid of 250 250 m2 in the horizontal and of varying thickness ranging from 2 to 20 m in the vertical fig 4 cross validation in a representative subarea revealed a mean error of 0 05 g l cl and a mean absolute error of 0 87 g l cl table 2 classified cross validation revealed a mean error of 0 13 classes and a mean absolute error of 0 57 classes interpolation results show a clear pattern of groundwater salinization in the western coastal region of the netherlands and fresh groundwater reserves in the east groundwater is brackish to saline to approximately at least 30 km from the coastline with localized occurrences of brackish groundwater further inland fig 4a uncertainty of the interpolation result is larger in the coastal region and generally increases with depth the uncertainty is reflecting the larger spread in measurement values in the coastal region and the relative lack of measurements at greater depths note that brackish to saline groundwater does additionally occur further inland at greater depths below the vertical extent of the interpolation result set to the hydrogeological base of the lhm model the 3d groundwater salinity distribution has been made publicly available through the nhi data portal https data nhi nu 4 2 variable density groundwater flow and salt transport model lhm fresh salt a nationwide variable density groundwater flow and salt transport model lhm fresh salt was constructed using our documented scripted workflow since the first inception of the lhm fresh salt model two updated version were constructed following recent updates to the lhm groundwater flow model currently at version 4 1 head differences with the original lhm groundwater flow model are minor when variable density is not included in lhm fresh salt model calculations median head difference 1 6 10 3 m 9 4 10 2 m 10th 90th percentile range larger differences are explainable from conceptual differences between the lhm and lhm fresh salt models fig 5 conceptual differences include the fully 3d groundwater flow calculation in the lhm fresh salt model versus the quasi 3d approach in the lhm model introducing additional resistance to vertical flow i in fig 5b especially large in the southeastern higher elevation limestone region and the spatial and vertical distribution of extraction wells or boundary fluxes in lhm fresh salt as compared to lhm ii in fig 5b with variable density included in lhm fresh salt calculation head differences between the two models increase with increasing groundwater salinity with maximum fresh water head differences reaching well over 2 m for the deepest model layers fig 5c and d validation of calculated salt fluxes to surface water generally showed plausible results 60 of compared polders met set plausibility criteria acacia water and consultancy 2021 america et al 2021 delsman et al 2020 this validation is however hampered by scant availability of measurement data as measurements of only five polders are available and mostly based on non recent data assessment of modeled changes in the groundwater salinity distribution revealed several areas where the initial salinity distribution appears not to be in steady state with the prevailing hydrologic boundary conditions while some of these are likely indicative of model error and warrant further research most notable the coastal dune areas and the southwestern province of zeeland most changes were deemed to be expected given the physiographical changes occurring over the past several centennia america et al 2021 delsman et al 2014 evaluation of the effect of varying effective porosity values in the model revealed a significant and expected effect of effective porosity on the modeled depth of the 100 year groundwater age boundary mean difference 8 4 m stdev 13 2 m between assigned low and high values the constructed lhm fresh salt model was used to calculate a sea level rise scenario with the sea rising 3 m by the year 2278 fig 6 shows results of head and salt load increase caused by 3 m year 2278 sea level rise salt load is defined here as the chloride mass flowing upward from the first aquifer into the overlying confining layer where it exfiltrates to surface water fig 6 results are relative to a constant present day boundary conditions scenario to isolate the effect of sea level rise the groundwater salinity distribution is not in equilibrium with present day boundary conditions and will still be adapting to historical landscape changes over the model period e g delsman et al 2014 oude essink et al 2010 sea level rise effects are generally limited to about 10 km inland from the coast or open estuaries regional differences in the landward extent of sea level rise effects are caused by hydrogeological differences landward extent in the southwest of the netherlands are for instance caused by locally low aquifer thickness and hence transmissivity increase in salt load fig 6b shows a generally comparable geographical pattern to the head increase the geographical pattern is however limited to exfiltration areas with brackish to saline groundwater the head increase in the center of the netherlands bordering the open rhine meuse estuary where groundwater salinity is low is therefore not mirrored in a salt load increase fig 7 shows the development of both sea level rise and the total salt load increase over the model period up to the year 2278 the increase of total salt load is not linear with sea level rise but shows an acceleration over time head increase in the aquifer is the first driver of salt load this head increase is directly related to the local hydrogeological conditions and linear with sea level rise and occurs near instantaneous over the longer time scales considered here however landward and upward flow of higher salinity infiltrated saline groundwater starts to contribute to increased salt loads causing the observed acceleration 5 discussion the netherlands hydrological instrument nhi is a long term collaborative effort to improve hydro geo logical data and modelling for water management in the netherlands and serves as the de facto knowledge basis for water related policy making in the netherlands this paper presents the addition of a nationwide 3d groundwater salinity distribution and variable density groundwater flow and salt transport model to the nhi geostatistical mapping of groundwater salinity using available point measurements is commonplace and different techniques have been applied by different researchers various kriging methods including multiple indicator kriging e g abdelhamid et al 2016 arslan 2012 triantafilis et al 2004 or machine learning sahour et al 2020 geostatistical mapping is however generally restricted to 2d gunnink et al 2021 present a large scale 3d mapping of groundwater salinity in vietnam using a largely similar approach as the one presented in this article we however include measurement uncertainty for each individual data point in our approach related to the measurement itself to the translation of bulk resistivity to chloride and to possible changes that have occurred since the measurement as did gunnink et al 2021 we showed that geostatistical mapping of groundwater salinity measurements to provide a 3d distribution of groundwater salinity is feasible for large scale groundwater systems and provides valuable information for sustainable water management applying additional monte carlo methods sequential indicator simulation e g gunnink et al 2021 to estimate the uncertainty of fresh groundwater volumes is left for future work notwithstanding the interpolation approach errors still exist in the interpolation result as the available data density is especially at greater depths unable to fully capture existing groundwater salinity variations when used as initial groundwater salinity distribution in a variable density groundwater flow and salt transport model the groundwater salinity distribution will likely not be in equilibrium with model boundary conditions resulting in difficult to detect model artefacts the use of airborne geophysics to map groundwater salinity at high detail has started to become more common delsman et al 2018 faneca sànchez et al 2012 fitterman and deszcz pan 1998 jørgensen et al 2012 knight et al 2018 rahman et al 2021 siemon et al 2009 2011 sulzbacher et al 2012 tosi et al 2022 with advances being made to separate groundwater salinity from the acquired signal and quantify the associated uncertainty delsman et al 2018 king et al 2018 2020 we designed our interpolation workflow to easily accommodate new available salinity data from e g future airborne surveys the netherlands hydrological instrument is annually updated reflecting continuously improving knowledge on hydro geo logical parameters and processes in the netherlands de lange et al 2014 allowing regular updates of the constructed variable density groundwater and coupled salt transport model is therefore paramount to our approach constructing a variable density groundwater model from an existing groundwater flow model is however far from straightforward first additional data is required most prominently the distribution of groundwater salinity at model start the scripted construction of the groundwater salinity distribution satisfies this data requirement second solving the advection dispersion equation imposes possibly limiting discretization restrictions to satisfy either courant or péclet number limitations oude essink 2003 several scripted procedures were implemented to prevent excessive groundwater flow velocities that necessitate small numerical time steps and hence long calculation times although still some manual corrections were necessary in model construction our approach greatly accelerated the model building process our scripted model building workflow facilitates regular construction of a variable density groundwater flow and salt transport model from annually updated versions of the nationwide groundwater flow model two such updated versions of the lhm fresh salt model have since been constructed the transparent and reproducible open source workflow further aided stakeholder trust in model results the lhm fresh salt model itself has not been calibrated rather adopting calibrated model parameters directly from the lhm model as model structure is kept almost equal between models effective model parameters kirchner 2006 were considered transferable between lhm and lhm fresh salt transport specific parameters however were left uncalibrated and only qualitatively tested for plausibility calibration to non traditional targets is generally recognized to improve calibration of groundwater models when compared to calibrating against only head observations delsman et al 2016 schilling et al 2019 the repeatable construction of a groundwater transport model based on a groundwater flow model offers the possibility to calibrate against different targets such as age delsman et al 2014 meyer et al 2018 recharge origin delsman et al 2014 or groundwater salinity patterns delsman et al 2016 benefiting parameterization of both models using the lhm fresh salt model to calibrate to such targets was not possible within this research but is a clear direction for future study efforts must be then made to obtain the required observational data as available data is currently too scarce for such an effort in addition care must be taken to account for the long timescales involved in groundwater flow in large scale models the ensuing dependency of modeled concentrations on the starting condition and the occurring landscape changes and hence changes in boundary conditions over the involved timescales delsman et al 2014 show the importance of changing boundary conditions to shape the evolution of groundwater in coastal aquifers while also showing paleo modelling as a way to take such changes into account paleo modelling has since been shown to be feasible even for large scale 3d variable density groundwater flow and salt transport models van engelen et al 2019 meyer et al 2019 we applied the parallel computation of variable density groundwater flow and coupled salt transport developed by verkaik et al 2021 to drastically reduce model calculation times our model size of 31m active cells exceeds previous large variable density groundwater and salt transport models reported in literature such as the 2 7m cells sand engine model huizer et al 2016 the 5 9m cells pzh model oude essink et al 2010 the 2m cells nile delta paleo reconstruction model van engelen et al 2019 or the 4 5 m cells danish german border paleo reconstruction model meyer et al 2019 our example shows that with parallel computing and careful model construction large scale modelling of variable density groundwater flow and salt transport has become feasible even without the use of supercomputer infrastructure calculated landward groundwater salinity effects of a 3 m sea level rise scenario serves as an example of the societal relevance of large scale variable density groundwater flow and salt transport models modelling results showed the significant impact of sea level rise on a coastal groundwater system transient modelling of salt transport over centennial time scales was shown to be crucial to the projection of future groundwater salinity given the cumulative influence of the slow flow of groundwater and dissolved salts through porous media over these time scales freshwater availability is under stress in coastal aquifers around the world van engelen et al 2022 signifying a global need for variable density groundwater flow and salt transport models to inform policy decisions in coastal zones in this paper we show that the construction and utility of such models is greatly facilitated by a scripted model construction workflow a scripted interpolation workflow and advances in parallel computation the presented scripted workflow facilitates regular updating of the model ensures consistency with existing groundwater models allows conjunctive calibration and use of models and increases transparency and thereby stakeholder trust in model results consistency between groundwater flow models and variable density groundwater flow and salt transport models aids transferability of parameters and simplifies their conjunctive use in policy research these benefits are not limited to the presented case as the presented approach is transferable to coastal aquifers around the world software and data availability interpolating and modelling workflows are available at https gitlab com deltares imod nhi fresh salt model software imod wq is available open source at https oss deltares nl web imod the netherlands 3d groundwater salinity and other model inputs are available from the nhi data portal https data nhi nu input data for the presented workflow are available from https doi org 10 5281 zenodo 7419219 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank manuscript editor f sarrazin and two anonymous reviewers for their help in improving this manuscript 
