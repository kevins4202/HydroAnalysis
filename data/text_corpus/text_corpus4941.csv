index,text
24705,lake titicaca is home to a unique high altitude ecosystem that is suffering from increasing anthropogenic pressures it experienced its first major algal bloom in march april 2015 that had devastating consequences in the southern shallow lake basin such events are expected to intensify in the future and call for a more active and quantitative management of the lake and its watershed in this paper we describe a coupled ecohydrodynamic model to predict the lake s water quality and more particularly the risk of harmful algal blooms we have coupled a nitrogen phytoplankton zooplankton detritus npzd ecosystem model to the unstructured mesh 3d hydrodynamic model slim our high resolution multi scale model explicitly represents the exchanges between the two basins composing the lake through the narrow strait of tiquina this allowed us to study the biophysical processes driving the entire lake over the period of january 2014 to may 2015 the model has been validated against temperature profiles at several locations throughout the lake it correctly reproduces the seasonal temperature variations that drive the lake stratification and impact the vertical distributions of phytoplankton our model was able to replicate the space time dynamics of the march april 2015 algal bloom similarly to what was observed on satellite imagery we believe that our multi scale ecohydrodynamic model is a promising tool to complement field observations and hence support water management in the lake and its watershed keywords lake titicaca hydrodynamic model npzd ecosystem model algal bloom water quality slim 1 introduction with a surface area of 8372 km 2 lake titicaca is the largest freshwater lake in south america and sitting at 3812 m altitude is the highest of the world s large lakes it is nested within the altiplano a high plateau region shared by peru and bolivia in the andes mountain range lake titicaca is part of the larger titicaca desaguadero poopó salar de coipasa tdps watershed system which spans mostly over bolivia and peru and encompasses parts of northern chile the high plateau is one of the poorest areas of peru and bolivia with 73 5 of the population having at least one basic need that was not met in 2001 martine gonzales et al 2007 lake titicaca is thus one of the most important natural resources in the region historically it has been essential for the development of important andean cultures such as the tiwanaku and still provides food and raw materials to the aymara communities the lake is also a strong driver for tourism attracting millions of tourists every year unfortunately it is also subject to the inevitable impact of human activities on its ecosystem in order to ensure the welfare of the lake the countries of peru and bolivia have reached agreements on the joint management of hydrological and hydrobiological resources of the lake and its basin the autonomous binational authority of the lake titicaca water system alt was created for this purpose in 1996 insuring the responsible water management of the entire tdps system this has led to several research and sanitation projects on the bolivian side by the ministry of environment and water lake titicaca water quality has been a subject of concern in recent years over the past decade mining activities in the region have been pointed out as the cause for mercury and heavy metal contamination gammons et al 2006 monroy et al 2014 guedron et al 2017 molina et al 2017 human activities in general have been related to water quality degradation through metal and bacterial contamination ap et al 2017 antibiotics contamination duwig et al 2014 archundia et al 2017 and contamination by trace elements such as arsenic lima et al 2019 sarret et al 2019 the increasing populations of the numerous cities around the lake indicate that the contamination is likely to intensify in the years to come all of these pollutions have a negative impact on the aquatic biota and on the lake ecosystem as a whole numerous species are affected and if no actions are taken some native species such as the emblematic frog telmatobius culeus could become extinct the increasing frequency of pollution calls for an active management of the lake and its watershed however this natural ecosystem being large and complex it requires a sophisticated measurement system in order to efficiently manage water quality in this context mathematical models can be greatly beneficial since they can take into account the complexity of the ecosystem through a set of equations and can simulate its behavior under different conditions given the correct inputs a good model efficiently represents the biophysical state of the lake accomplishing the task of monitoring water quality with significantly less resources furthermore models allow us to simulate the effects of different scenarios regarding pollution and remediation this provides valuable insights when it comes to choosing appropriate solutions for investing in water quality improvements they can also help us to anticipate the impact of future anthropogenic contamination and therefore take actions in order to limit the environmental impact several models exist for this purpose and have been developed for different types of water bodies the npzd for nitrogen based nutrients phytoplankton zooplankton and detritus ecosystem model is one of the most widely used see for instance olascoaga et al 2005 luo et al 2012 tian et al 2015 this is mainly due to the fact that it is relatively simple and does not require many parameters yet it is capable of generating realistic results other variants of this type of model have also been introduced by refining some components for instance the nutrient component can be subdivided into no 3 and nh 4 or the phytoplankton can be seen as flagellates cyanobacteria and diatoms new components such as the dissolved oxygen or the silica content can also be integrated however the basic npzd type model remains the first option for most water quality modeling works in this paper we describe a coupled ecohydrodynamic model to study the nutrient plankton dynamics in lake titicaca the hydrodynamic component is covered with slim3d the 3d version of the multi scale hydrodynamic model slim 1 1 slim second generation louvain la neuve ice ocean model www slim ocean be the ecosystem component is represented with a npzd ecosystem model coupled to slim3d such a modeling approach has already been applied to many lakes including lake zurich omlin et al 2001 lake tanganyka naithani et al 2007 and lake chini sharip et al 2016 but to our knowledge this is the first application to lake titicaca the goal set for our study is to simulate the annual evolution of the lake s biophysical state and reproduce the occurrence of an algal bloom event triggered by nutrients originating from the katari river a qualitative validation of our model is performed by comparing our results with observations and the satellite imagery during the bloom event 2 material and methods in this section we describe the geography and climatology of lake titicaca before deriving the eco hydrodynamic model equations and summarizing the model forcings 2 1 study area lake titicaca is composed of two main parts lago mayor in the north 83 4 of the total surface and reaching depths of 250 m and the smaller and shallower lago menor in the south average depth of 9 m and max depth of 42 m wirrmann et al 1992 see fig 1 these two parts are connected by the strait of tiquina a short about 3 km narrow mostly less than 1 km passage with a steep sloping bathymetry that goes from about 20 m in lago menor to 50 m in lago mayor the main water inputs to the lake are rainwater 55 inflow by rivers 44 and groundwater inflows 1 the main outputs are evaporation 95 and outflow through the desaguadero river 5 other losses are negligible martine gonzales et al 2007 the main forcings that affect the water dynamics within the lake are limited to the heat and momentum exchanges with the atmosphere since the lake is situated between the latitudes of 15 2 s and 16 6 s its climate is conditioned by a dry season spanning from april to september and a warmer wet season during the rest of the year the lake surface temperatures vary from an average of 16 c at the peak of the wet season to around 12 c in the midst of the dry season daily variations have an approximate mean amplitude of 4 c winds mainly blow towards the southwest descending from the cordillera real with a mean velocity of about 1 5 m s the shallow regions of lake titicaca such as the puno bay and lago menor have been identified as the most contaminated and the most subject to algal blooming in the past years in particular the south eastern side of lake titicaca is often affected by pollution due to the important anthropogenic activities upstream the katari river which flows into lago menor fig 1 carries water that is contaminated by the highly populated city of el alto 9 22 1 0 5 inhabitants in 2018 according to the bolivian national institute of statistics and by the municipalities of viacha laja pucarani and puero perez along the river banks duwig et al 2014 ap et al 2017 archundia et al 2017 the uncontrolled urban wastewater discharges lead to high concentrations of nitrates and other nutrients that make their way to the lake where they create eutrophic conditions hence in this portion of the lake algal bloom events have become seasonal the particularly strong bloom event of march april 2015 serves as a good example fig 2 is a true color landsat 8 image of lago menor taken on the 24 th of march 2015 the algal bloom mainly covers the eastern part of the basin more than half the surface of lago menor was affected and more than two tonnes of aquatic biota deaths were reported the main algae involved during the march april 2015 bloom was carteria sp acha et al 2018 which is a type of green algae having four flagella komarkova et al 2016 have shown that algal blooms in lake titicaca can also involve cyanobacteria as is often the case for blooms associated with high concentrations of nutrients in the water they also provide a description of the species composition of phytoplankton assemblages in the lake in addition to cyanobacteria there are also dinoflagellates and green algae diatoms are not very common a description of the zooplankton species present in the lake can be found in widmer et al 1975 2 2 hydrodynamic model the spatial extent and concentration of algal blooms are directly influenced by the lake hydrodynamics here we simulate it by means of slim3d which solves the three dimensional hydrostatic equations under the boussinesq approximation on a 3d mesh made out of triangular prisms unlike traditional hydrodynamic models slim uses an unstructured horizontal mesh that accurately represents the lake topography including narrow passages such as tiquina strait it solves the model equations with the discontinuous galerkin dg finite element method which combines the accuracy of finite elements and the local conservation properties of finite volumes slim3d has been previously applied to a number of different environments such as the columbia river estuary vallaeys et al 2018 lake tanganyika delandmeter et al 2018 the burdekin river estuary delandmeter et al 2015 or the congo river estuary vallaeys et al 2020 the model governing equations can be written as follows 1 u t h u u w u z h ν h h u z ν u z f e z u g h η g ρ 0 h z η ρ ρ 0 d z 1 ρ 0 h p a 2 h u w z 0 3 t t h u t w t z h κ h h t z κ t z f relax where the unknowns are the horizontal velocity u u v the vertical velocity w and the temperature t an external mode solves the fast propagating waves to compute the free surface elevation η the temperature impacts the water density ρ through the equation of state of jackett et al 2006 the horizontal viscosity ν h follows the parametrization of smagorinsky 1963 and the horizontal diffusivity κ h the parametrization of okubo 1971 a second order turbulence closure provides the vertical viscosity ν and diffusivity κ other parameters are f the coriolis parameter ρ 0 1005 kg m 3 the constant reference density and g 9 81 m 2 s the gravitational acceleration the mathematical symbols e z h and respectively stand for the vertical unit vector pointing upward the horizontal derivative operator and the vector product operator for more information regarding these equations see vallaeys et al 2018 in our study lake titicaca is considered as an entirely closed system regarding the water mass balance and we assume equilibrium between inputs and outputs of water in order to parameterize the heat flux based on the difference between prescribed surface temperature and the computed temperature in the top layers of the lake a temperature relaxation term f relax is included in eq 3 4 f relax max z r z 0 z r τ r t surface t where the depth of the relaxation zone z r 25 m and the relaxation time τ r 5 days have been calibrated empirically this relaxation term linearly decays from a maximum value at the surface of the lake to zero when z z r 2 3 ecosystem model to assess the effect of land based activities on the lake we have developed an ecosystem model that is coupled with the hydrodynamic model it simulates the space time dynamics of four variables nitrogen based nutrients n phytoplankton p zooplankton z and detritus d the biochemical processes linking these variables together are summarized in fig 3 our model is based on the work of tian et al 2015 with some parameter values adapted to lake titicaca in a npzd model there is an uptake of nutrients by phytoplankton through photosynthesis the growing phytoplankton is subject to mortality and to grazing by zooplankton this zooplankton can redistribute nutrients through its metabolism excretions and is also subject to mortality finally the detritus stock is replenished by the dead phytoplankton and zooplankton detritus provide nutrients through remineralization and are subject to sinking forces in addition to these basic processes an external input of nutrients is added in order to simulate the contribution of nutrient rich waters from the katari river due to the upstream anthropogenic activities all the variables of the npzd model are transported by the flow it therefore runs simultaneously with the hydrodynamic model the coupling between both models is only one way as the npzd model requires the velocity and temperature fields computed by the hydrodynamic model but the latter is not influenced by the npzd model outputs the governing equations of the ecosystem model can be written as follows 5 n t a n u p λ g z ε f 1 t d d n 6 p t a p u p g z m p f 1 t p 2 d p 7 z t a z γ g z m z f 1 t z 2 d z 8 d t a d 1 γ λ g z m p f 1 t p 2 m z f 1 t z 2 ε f 1 t d s d d z d d where the advection a and diffusion d terms for a component x are defined as follows 9 a x h u x w x z 10 d x h κ h h x z κ x z where u and w are the horizontal and vertical velocities computed by the hydrodynamic model the diffusivity coefficients κ h and κ are assumed to be identical to those used in eq 3 for the temperature in eq 8 the vertical advection term with a velocity s d represents the sinking of detritus to the bottom of the lake a similar term could also be used in the phytoplankton equation to account for phytoplankton sinking here we chose not to consider it as we are mostly interested in developing a model that can predict the occurrence of algal blooms in freshwater systems algal blooms are often the result of a sudden increase in cyanobacteria these photosynthetic bacteria tend to form gas vesicles that allow them to float at the surface cyanobacteria therefore remain in the upper illuminated water layer of a stratified lake and hence increase their total daily light dose which further enhances their growth in the particular case of the 2015 algal bloom in lake titicaca which we consider in this paper acha et al 2018 have shown that the algae involved in the bloom were almost entirely carteria sp which are not cyanobacteria but a type of green algae having four flagella these algae have a small albeit non zero sinking velocity of about 0 2 m day bienfang and harrison 1984 in our npzd model we have therefore assumed that the phytoplankton compartment is only composed of bloom forming algae for which the sinking velocity is small enough to be neglected a more realistic model would of course distinguish between different phytoplankton species but this is beyond the scope of this paper the uptake u p and grazing g z terms are defined as 11 u p μ max f 1 t f 2 n f 3 i p 12 g z g max f 1 t f 4 p z nitrogen uptake is topped by a maximum growth rate for phytoplankton μ max and is influenced by the temperature through f 1 t the availability of nitrogen through f 2 n and the phytoplankton response to light through f 3 i grazing on the other hand is limited by the zooplankton maximum grazing rate g m a x by the amount of phytoplankton available for grazing through f 4 p and by temperature through f 1 t the effect of temperature on grazing and nutrient uptake is parameterized as an exponential function decreasing from an optimal temperature t o p t 13 nitrogen availability is parameterized by a michaelis menten function characterized by the half saturation constant for nitrogen uptake k n 14 solar radiation also plays an important role since it is the main driver of photosynthesis solar radiation reaches the lake surface with a surface photosynthetically active radiation par of 275 w m2 this value is particularly large since lake titicaca is situated in high altitude where solar radiation is less attenuated by the atmosphere the radiation makes its way through the water column where it is progressively absorbed by pure water phytoplankton and detritus this light attenuation is calculated as a function of water depth and phytoplankton and detritus concentrations with their respective light attenuation constants k w k c and k d as follows 15 i z i 0 exp k w z k c z η p d z k d z η d d z in the water column phytoplankton can utilize this energy for photosynthesis nevertheless the amount of par that is effectively absorbed by phytoplankton f 3 i depends on the intensity of the radiation since effects such as light inhibition take place it is parameterized using the formulation of platt et al 1980 16 where α and β are the light photosynthesis slope and the inhibition coefficient the maximum efficiency is attained at 79 w m2 when the intensity is high enough to provide significant energy to phytoplankton but small enough to avoid damaging vegetation tissues finally the effect of phytoplankton on zooplankton grazing is finally parameterized by a hill langmuir equation with a hill coefficient of 2 and the half saturation constant k p 17 all the ecosystem model parameters are summarized in table 1 for lack of field data they could neither be measured directly nor estimated by inverse modeling from observations of the n p z and d concentrations we have therefore used the same parameters values as those used by tian et al 2015 for a similar modeling study but in a different location the ecosystem model equations are solved on the same unstructured mesh as the hydrodynamic model equations by using also the dg finite element method 2 4 model settings we simulate the lake dynamics from january 2014 to june 2015 with a time step of 35 s the model takes about 3 to 4 months to spin up and reach a state in balance with the forcings as for the spatial discretization a 2d unstructured mesh is first generated with the open source mesh generator gmsh geuzaine and remacle 2009 the mesh resolution depends on the distance to the coast with a maximum mesh resolution of 300 m along the coast of lago menor and 800 m along the coast of lago mayor faraway from the coast the mesh coarsens and reaches a minimum resolution of 15 km this allows us to concentrate the computational resources where they are most needed in particular the resolution is sufficient to represent the narrow passage of tiquina connecting both basins once the horizontal mesh has been built the 3d mesh is obtained by extruding it vertically over a maximum of 15 horizontal layers called z levels depending on the water depth the vertical resolution reaches 1 m in the top layers where the biophysical processes of interest take place and coarsens to 60 m in the deepest parts of the lake in the end the 3d mesh is composed of a total of 2 1 1 0 5 triangular prismatic elements fig 4 the main forcings that drive the water movements in our model are the lake surface heat and momentum fluxes the wind data used for this purpose are that of the climate forecast system cfs provided by the national oceanic and atmospheric administration noaa this reanalysis product provides hourly time series of the u and v components of wind at 10 m over land with a horizontal resolution down to 0 5 surface temperature is extracted from the era5 climate reanalysis dataset provided by the copernicus climate change service c3s this dataset consists of hourly skin temperature with a spatial resolution of 0 25 era5 provides water surface temperatures as it takes into account water bodies when computing global skin temperatures initial water temperatures are set from 12 7 c at the surface to 12 c in the depth corresponding to typical values for january and initial water velocities and elevations are set to zero for lack of more precise field data the ecosystem model is initialized with spatially homogeneous values for n p z and d throughout the lake for the nutrients we use the average nitrogen content no 2 no 3 of 1 79 mmol n m 3 measured by cruz et al 2014 since we did not have field measurements for the other variables we used the initial values of tian et al 2015 and adjusted them so that the ratio with the nutrient concentration is the same in both systems this leads to initial values of p z and d equal to 0 45 0 22 and 0 mmol n m 3 respectively although these initial values are certainly a crude estimate of the real state of the system at the start of the simulation it is worth noting that the npzd model sensitivity to the initial conditions is rather weak after an initial spin up period of about 3 4 months the model reaches a state in balance with the forcings and hence forgets the initial condition furthermore the coupling between both models being only one way from the hydrodynamic model to the npzd model any errors in the npzd model would not impact the hydrodynamic model results as shown by the governing equations the npzd ecosystem model is driven by physical factors such as water currents or light intensity in our study we also pay particular attention to the nitrogen river flux in lago menor however little data is available to build an accurate forcing nutrients provided by the katari river during 2014 and 2015 are estimated by analyzing the river flow rate provided by the bolivian ministry of environment and water mmaya 2019 and the concentrations of contaminants provided by different studies see appendix a for details since the annual flow rates were similar during years 2010 to 2015 we consider the no 3 concentrations measured during this period as a proxy to reconstruct the monthly values for the year 2014 for instance measures taken on november 2013 are used to derive no 3 concentrations in november 2014 this way we are able to create an approximation of the anthropogenic contamination in no 3 during 2014 and 2015 fig 5 additionally since the nitrogen based nutrients in the model also take into account no 2 concentrations these are added to the n input forcing following the same no 3 no 2 ratio found in lago menor for each mmol n l of no 2 we observed 12 mmol n l of no 3 as a global mean cruz et al 2014 the total nitrogen input are thus computed as follows 18 n input n o 3 n o 2 n o 3 1 12 n o 3 13 12 n o 3 no quantitative data is available concerning ammonium or phosphorus in the lake nevertheless the concentrations of soluble reactive phosphorus srp available for phytoplankton growth are often high in lake titicaca relative to the amounts of dissolved inorganic nitrogen din no 3 no 2 nh 4 the din to srp ratio an indication of algal nutrient deficiency is usually well below 10 1 iltis et al 1992 phosphorus can thus be neglected in our study since it is not considered as a limiting element 3 results our model provides the space time evolution of the water velocity the temperature and the npzd components the results shown here are chosen in order to provide means of determining whether the model is able to accurately simulate the annual physical evolution of the lake we also study the bloom event simulated in march 2015 3 1 water current and temperature water currents are mainly influenced by the wind which blows towards the southwest through most of the year as a result surface waters tend to flow towards the south of the lake see fig 6 showing the yearly average of the surface velocity there is a global southward surface flow with a maximum velocity of about 5 cm s in the center of lago mayor on the other hand lago menor shows less pronounced currents due to its shallow nature in the cohana bay where the n input occurs currents are quite slow 2 cm s the strait of tiquina connects both parts of the lake although the flow in the passage frequently reverses there is a net average flow directed towards lago menor not shown the mean transport ranges from 0 01 to 0 03 m 2 s which leads to yearly volumes of 1 to 10 1 0 8 m 3 flowing through the strait the discharge barely exceeds 300 m 3 s although our model predicts instantaneous peaks of more than 1000 m 3 s this flux is one order of magnitude larger than the outflow through the desaguadero river or the inflow from the katari river this supports our hypothesis that the lake is a closed system with regard to water input output it also highlights the importance of modeling the circulation in the entire lake and not just in lago menor the evolution of water temperature within the lake is strongly dependent on the surface temperature during the cooler dry season the surface temperature drops from around 15 c in february to 12 5 c in july the surface temperature thus falls to values similar to the temperature in the bottom of the lake 12 c the thermocline a physical barrier separating the warmer surface waters from the underlying cooler waters is thus much less pronounced than during the wet season this weakening of the thermocline barrier leads to more vertical mixing between water layers however the water column is partially mixed as only the top portion of the water column is affected richerson 1992 our model is able to qualitatively reproduce the evolution from a strongly stratified temperature profile in the summer to an almost vertically uniform profile in the winter fig 7 for year 2014 in august 2014 it is interesting to note that there is only a 0 5 c difference between the surface and the lake bottom temperatures this is enough to restrict the vertical mixing to the top 100 m below the surface however in some years a complete temperature inversion can occur in which the deep waters are warmer than the surface waters this would result in a complete vertical mixing and occurrences of this phenomenon were recorded in the past richerson 1992 a more quantitative validation can be achieved by comparing our simulated temperature profiles with the data gathered during the cr 1407 scientific cruise that took place in july 2014 cruz et al 2014 fig 8 shows four temperature profiles on different locations around lake titicaca the root mean square error rmse is calculated between the outputs and the observations for each of the 27 profiles in order to evaluate the precision of the model the results are listed in appendix b the simulated results are close to the observations in most cases however the model shows non negligible errors in lago menor this is partially due to the surface boundary condition indeed due to the poor spatial resolution of the skin temperature data surface temperatures in the lago menor and near the edges of the lake were partially affected by the adjacent land surface temperatures during interpolation our model performs well at reproducing the temperature evolution towards the depth of the lake with a global mean error of 0 42 c the summer and winter dynamics can be further compared by looking at the temperature spatial variations along a section of the lake for the months of august and december fig 9a during the wet season december lake titicaca presents a stratified distribution of water temperature with 17 c on the surface and 12 c on the bottom of the lake see fig 9a the modeled thermocline is located between 20 and 30 m depth during the cooler dry season the surface temperature falls to values around 12 5 c the temperature gap between the surface and the bottom of the lake is much less pronounced than during the wet season the clear thermocline thus disappears and is replaced by a smoother thermal gradient the disappearance of the thermocline can be explained by the effect of the thermal inertia of the lake indeed this inertia is responsible for the slow cooling of waters therefore maintaining warmer temperatures at medium depths than near the surface this inversion of temperature is what drives the vertical movement of water since the warmer and less dense waters tend to rise 3 2 npzd components the distribution of the npzd components within lago mayor is not directly influenced by river inputs since the influx of n is restricted to lago menor also the model sensitivity to the initial conditions is weak indeed several simulations launched with different starting values for the npzd components take only a few days to reach a similar equilibrium state nutrients are mainly found in the depths of the lake fig 9b sinking detritus are also found in these areas see fig 9e and are the most important source of n through the remineralization process during periods of strong stratification phytoplankton thrives within a horizontal layer between 25 m and 80 m depth as it requires both nutrients available below and sunlight from above see fig 9c and fig 9d likewise it is common to find zooplankton in this same thriving region since it solely feeds on phytoplankton through grazing higher phytoplankton concentrations can be found near the edges of the lake this phenomenon is due to the nitrogen and detritus distributions indeed in these areas the lake is rather shallow and detritus which accumulate near the bottom are closer to the surface the remineralization process is thus particularly efficient with the higher temperatures from the proximity with the surface the high availability of nitrogen in these regions promotes phytoplankton growth our results also indicate that phytoplankton and thus zooplankton concentrations are generally higher in lago menor than in lago mayor these results agree with observations made by iltis 1992 who mentions that biomass levels during 1985 1987 were 5 to 36 times higher in lago menor than in lago mayor during periods of strong vertical mixing both phytoplankton and zooplankton are transported towards the surface in fact the phytoplankton concentration greatly increases during this period since nitrogen becomes available higher in the water column the phytoplankton is able to survive closer to the lake surface where more light is available this leads to an increase of phytoplankton and that in turn accelerates zooplankton growth 3 3 phytoplankton bloom of march 2015 during the algal bloom event of march april 2015 high concentrations of carteria sp were found in the eastern part of lago menor in fig 10 we take a closer look at lago menor on the 24 th of march 2015 nutrients concentrations are high in the cohana bay where the forcing is applied this is a shallow region with weak currents and where nutrients therefore tend to accumulate however the distribution of n in this region is not entirely homogeneous this is partly due to the current directions that disperse the nutrients and the temporal evolution of the n flux from the katari river indeed the input of nitrogen is weaker during the dry season when the river flow is weaker and the waters are less polluted currents eventually manage to bring the nutrient around the peninsula towards the north eastern part of lago menor the same currents are responsible for the spread of detritus towards the north eastern side of lago menor phytoplankton zooplankton and detritus concentrations are also high in the cohana bay this is primarily due to the high nutrient availability that drives the ecosystem forward the spread of the phytoplankton towards the north east follows the same pattern as in the satellite imagery around the same date fig 2 the algae spread within the lake following the water currents towards the north east and the center of lago menor the satellite imagery did not cover the western part of the basin a movie showing the phytoplankton evolution is provided in online resource 1 4 conclusions we have developed a multi scale eco hydrodynamic model of lake titicaca that can represent both the complex interplay between biological and physical processes at stake and the complex topography of the lake the former is achieved by coupling a state of the art 3d hydrodynamic model with a npzd ecosystem model the resulting model includes all the processes required to simulate the space time evolution of water quality in the lake the latter is achieved by using novel numerical methods based on a discontinuous galerkin finite element approximation computed on a multi scale unstructured mesh to solve the model equations it allows us to locally increase the resolution to represent small scale features such as the narrow passage between lago menor and lago mayor without affecting the overall model performance the resulting model has been validated with all the available observations our results indicate that the coupled slim npzd model is able to effectively simulate the biophysical dynamics of the lake the annual evolution of the thermocline shows a loss of stratification during july august leading to vertical mixing over the top 100 m layer this simulation concurs with the observations of richerson 1992 which serve as a validation for the hydrodynamic component of the coupled model similarly the temperature profiles extracted on july 2014 over the depth of the lake are very close to the ones observed by the scientific cruise cr 1407 cruz et al 2014 this confirms the ability of the model to reproduce the thermal stratification of the lake the lack of validation data concerning water currents prevents us to draw conclusions regarding the quality of the simulated velocity field nevertheless our results are comparable to the velocity computed by aguirr cespedes 2009 in his numerical hydrodynamic model of the lake overall the validations indicates that our model is able to effectively represent the global physical behavior of lake titicaca the npzd ecosystem model coupled to the hydrodynamic model manages to simulate the stratification of phytoplankton and zooplankton revealing a horizontal thriving zone between 25 m and 80 m below the surface during the wet season compared to the data presented in iltis 1992 and cruz et al 2014 our model struggles to reproduce the exact vertical distribution of phytoplankton in lago menor during the dry season however our model manages to correctly simulate the horizontal distribution of phytoplankton within the lake indeed fig 10 shows a spread of phytoplankton similar to what occurred during the algal bloom of march april 2015 fig 2 likewise the phytoplankton distribution in lago mayor indicates higher concentrations near the edges of the lake in shallower areas in agreement with the observations of iltis 1992 it is important to mention the structural differences between lago mayor and lago menor which make them two distinct environments with different hydrodynamics and thus different ecosystemic development schemes it is thus difficult for a unique model to harness both environments however with its variable resolution slim manages to explicitly represent exchanges between both basins through the narrow strait of tiquina this exchange flow largely exceeds rivers inflow outflow the coupled slim npzd model is thus able to provide realistic simulations of lake titicaca as a whole the model can reproduce the occurrence of vertical mixing during july august and the related consequences on the npzd components as well as the algal bloom event of march april 2015 the ability to reproduce these historic conditions given the appropriate input forcing data ensures the validity of the model and enables new research opportunities now that the water currents and the dynamics taking place can be simulated further studies regarding hydrodynamics could be conducted over the entire lake the spread of contaminants such as mercury linked to illegal mining activities or plastic pollution due to uncontrolled urban discharge can now be simulated and predicted this would help to better understand the dynamics of the spreads taking place throughout lake titicaca the long ranging impacts of these pollutions could then be estimated which could reveal the broader consequences of local contamination sources finally our model would allow to estimate the effect of climate change on the lake ecosystems by for instance assessing the impact of rising temperature and decaying nutrients on the phyto and zooplankton populations to better protect the rich biodiversity of the lake and to ensure a durable future for the local populations environmental policies are being implemented by the bolivian ministry of environment and water in this context our model is a new tool to estimate and predict the impact of human activities on lake titicaca s ecosystem we believe our model could help local authorities to actively manage the lake and the surrounding watershed for example to treat the algal bloom events threshold values of allowed nitrogen discharge could be found which would limit the proliferation of algae other uses of the model could be envisioned for other types of pollutions which could help mitigate the negative impacts of human activities on the lake biodiversity credit authorship contribution statement françois duquesne software investigation data curation writing original draft visualization valentin vallaeys methodology software validation writing review editing prem jai vidaurre investigation resources emmanuel hanert conceptualization methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments computational resources were provided by the consortium des équipements de calcul intensif céci funded by the f r s fnrs under grant no 2 5020 11 the authors also wish to acknowledge the bolivian ministry of environment and water for their help in data gathering appendix a nutrient input from the katari river due to the lack of available data concerning the nitrogen discharge of the katari river an artificial but realistic forcing is built this allows us to advance in our research although it is a potential source of error the n input forcing is computed by considering both the punctual no 3 concentrations measurements and the 2014 2015 katari river waterflow we hypothesize that the no 3 concentration remains similar each year for instance the concentration value in march 2014 is reported in march 2015 by combining the concentrations with the water flow we find the amount of no 3 discharged per second for each month in a similar way for the remaining months of the year data is extrapolated by using plausible concentration values waters are less polluted in the dry season since the delta filters out a large amounts of nitrogen certain difficulties still remain such as the estimation of the nitrogen provided by the local populations of the cohana bay or the amount leached by the neighboring livestock farming activities table a 2 shows no 3 values provided by different sources on different dates of measurements fig a 11 shows the outflow history of the katari watershed the flow rate has the same aspect during the period of 2011 to 2015 with a peak flow at around 30 m 3 s the figure is reproduced from the geovisor vibh of the mmaya mmaya 2019 appendix b temperature validation plots temperature profiles are displayed at 27 measurement locations over lake titicaca in fig b 12 cruz et al 2014 the root mean square error rmse is computed for each point by comparing observations with the corresponding simulated values at depths where observations are available appendix c validation of the vertical distribution of phytoplankton fig c 13 shows the vertical distribution of simulated phytoplankton slim model and chlorophyll a concentrations gathered by the cruz et al 2014 scientific cruise the phytoplankton qualitatively represents the observed shape of the chlorophyll a distributions although detritus also contains part of this chlorophyll a appendix d supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2020 109418 appendix d supplementary data the following is the supplementary material related to this article video s1 this video highlights phytoplankton s space time evolution during the march 2015 algal bloom event 
24705,lake titicaca is home to a unique high altitude ecosystem that is suffering from increasing anthropogenic pressures it experienced its first major algal bloom in march april 2015 that had devastating consequences in the southern shallow lake basin such events are expected to intensify in the future and call for a more active and quantitative management of the lake and its watershed in this paper we describe a coupled ecohydrodynamic model to predict the lake s water quality and more particularly the risk of harmful algal blooms we have coupled a nitrogen phytoplankton zooplankton detritus npzd ecosystem model to the unstructured mesh 3d hydrodynamic model slim our high resolution multi scale model explicitly represents the exchanges between the two basins composing the lake through the narrow strait of tiquina this allowed us to study the biophysical processes driving the entire lake over the period of january 2014 to may 2015 the model has been validated against temperature profiles at several locations throughout the lake it correctly reproduces the seasonal temperature variations that drive the lake stratification and impact the vertical distributions of phytoplankton our model was able to replicate the space time dynamics of the march april 2015 algal bloom similarly to what was observed on satellite imagery we believe that our multi scale ecohydrodynamic model is a promising tool to complement field observations and hence support water management in the lake and its watershed keywords lake titicaca hydrodynamic model npzd ecosystem model algal bloom water quality slim 1 introduction with a surface area of 8372 km 2 lake titicaca is the largest freshwater lake in south america and sitting at 3812 m altitude is the highest of the world s large lakes it is nested within the altiplano a high plateau region shared by peru and bolivia in the andes mountain range lake titicaca is part of the larger titicaca desaguadero poopó salar de coipasa tdps watershed system which spans mostly over bolivia and peru and encompasses parts of northern chile the high plateau is one of the poorest areas of peru and bolivia with 73 5 of the population having at least one basic need that was not met in 2001 martine gonzales et al 2007 lake titicaca is thus one of the most important natural resources in the region historically it has been essential for the development of important andean cultures such as the tiwanaku and still provides food and raw materials to the aymara communities the lake is also a strong driver for tourism attracting millions of tourists every year unfortunately it is also subject to the inevitable impact of human activities on its ecosystem in order to ensure the welfare of the lake the countries of peru and bolivia have reached agreements on the joint management of hydrological and hydrobiological resources of the lake and its basin the autonomous binational authority of the lake titicaca water system alt was created for this purpose in 1996 insuring the responsible water management of the entire tdps system this has led to several research and sanitation projects on the bolivian side by the ministry of environment and water lake titicaca water quality has been a subject of concern in recent years over the past decade mining activities in the region have been pointed out as the cause for mercury and heavy metal contamination gammons et al 2006 monroy et al 2014 guedron et al 2017 molina et al 2017 human activities in general have been related to water quality degradation through metal and bacterial contamination ap et al 2017 antibiotics contamination duwig et al 2014 archundia et al 2017 and contamination by trace elements such as arsenic lima et al 2019 sarret et al 2019 the increasing populations of the numerous cities around the lake indicate that the contamination is likely to intensify in the years to come all of these pollutions have a negative impact on the aquatic biota and on the lake ecosystem as a whole numerous species are affected and if no actions are taken some native species such as the emblematic frog telmatobius culeus could become extinct the increasing frequency of pollution calls for an active management of the lake and its watershed however this natural ecosystem being large and complex it requires a sophisticated measurement system in order to efficiently manage water quality in this context mathematical models can be greatly beneficial since they can take into account the complexity of the ecosystem through a set of equations and can simulate its behavior under different conditions given the correct inputs a good model efficiently represents the biophysical state of the lake accomplishing the task of monitoring water quality with significantly less resources furthermore models allow us to simulate the effects of different scenarios regarding pollution and remediation this provides valuable insights when it comes to choosing appropriate solutions for investing in water quality improvements they can also help us to anticipate the impact of future anthropogenic contamination and therefore take actions in order to limit the environmental impact several models exist for this purpose and have been developed for different types of water bodies the npzd for nitrogen based nutrients phytoplankton zooplankton and detritus ecosystem model is one of the most widely used see for instance olascoaga et al 2005 luo et al 2012 tian et al 2015 this is mainly due to the fact that it is relatively simple and does not require many parameters yet it is capable of generating realistic results other variants of this type of model have also been introduced by refining some components for instance the nutrient component can be subdivided into no 3 and nh 4 or the phytoplankton can be seen as flagellates cyanobacteria and diatoms new components such as the dissolved oxygen or the silica content can also be integrated however the basic npzd type model remains the first option for most water quality modeling works in this paper we describe a coupled ecohydrodynamic model to study the nutrient plankton dynamics in lake titicaca the hydrodynamic component is covered with slim3d the 3d version of the multi scale hydrodynamic model slim 1 1 slim second generation louvain la neuve ice ocean model www slim ocean be the ecosystem component is represented with a npzd ecosystem model coupled to slim3d such a modeling approach has already been applied to many lakes including lake zurich omlin et al 2001 lake tanganyka naithani et al 2007 and lake chini sharip et al 2016 but to our knowledge this is the first application to lake titicaca the goal set for our study is to simulate the annual evolution of the lake s biophysical state and reproduce the occurrence of an algal bloom event triggered by nutrients originating from the katari river a qualitative validation of our model is performed by comparing our results with observations and the satellite imagery during the bloom event 2 material and methods in this section we describe the geography and climatology of lake titicaca before deriving the eco hydrodynamic model equations and summarizing the model forcings 2 1 study area lake titicaca is composed of two main parts lago mayor in the north 83 4 of the total surface and reaching depths of 250 m and the smaller and shallower lago menor in the south average depth of 9 m and max depth of 42 m wirrmann et al 1992 see fig 1 these two parts are connected by the strait of tiquina a short about 3 km narrow mostly less than 1 km passage with a steep sloping bathymetry that goes from about 20 m in lago menor to 50 m in lago mayor the main water inputs to the lake are rainwater 55 inflow by rivers 44 and groundwater inflows 1 the main outputs are evaporation 95 and outflow through the desaguadero river 5 other losses are negligible martine gonzales et al 2007 the main forcings that affect the water dynamics within the lake are limited to the heat and momentum exchanges with the atmosphere since the lake is situated between the latitudes of 15 2 s and 16 6 s its climate is conditioned by a dry season spanning from april to september and a warmer wet season during the rest of the year the lake surface temperatures vary from an average of 16 c at the peak of the wet season to around 12 c in the midst of the dry season daily variations have an approximate mean amplitude of 4 c winds mainly blow towards the southwest descending from the cordillera real with a mean velocity of about 1 5 m s the shallow regions of lake titicaca such as the puno bay and lago menor have been identified as the most contaminated and the most subject to algal blooming in the past years in particular the south eastern side of lake titicaca is often affected by pollution due to the important anthropogenic activities upstream the katari river which flows into lago menor fig 1 carries water that is contaminated by the highly populated city of el alto 9 22 1 0 5 inhabitants in 2018 according to the bolivian national institute of statistics and by the municipalities of viacha laja pucarani and puero perez along the river banks duwig et al 2014 ap et al 2017 archundia et al 2017 the uncontrolled urban wastewater discharges lead to high concentrations of nitrates and other nutrients that make their way to the lake where they create eutrophic conditions hence in this portion of the lake algal bloom events have become seasonal the particularly strong bloom event of march april 2015 serves as a good example fig 2 is a true color landsat 8 image of lago menor taken on the 24 th of march 2015 the algal bloom mainly covers the eastern part of the basin more than half the surface of lago menor was affected and more than two tonnes of aquatic biota deaths were reported the main algae involved during the march april 2015 bloom was carteria sp acha et al 2018 which is a type of green algae having four flagella komarkova et al 2016 have shown that algal blooms in lake titicaca can also involve cyanobacteria as is often the case for blooms associated with high concentrations of nutrients in the water they also provide a description of the species composition of phytoplankton assemblages in the lake in addition to cyanobacteria there are also dinoflagellates and green algae diatoms are not very common a description of the zooplankton species present in the lake can be found in widmer et al 1975 2 2 hydrodynamic model the spatial extent and concentration of algal blooms are directly influenced by the lake hydrodynamics here we simulate it by means of slim3d which solves the three dimensional hydrostatic equations under the boussinesq approximation on a 3d mesh made out of triangular prisms unlike traditional hydrodynamic models slim uses an unstructured horizontal mesh that accurately represents the lake topography including narrow passages such as tiquina strait it solves the model equations with the discontinuous galerkin dg finite element method which combines the accuracy of finite elements and the local conservation properties of finite volumes slim3d has been previously applied to a number of different environments such as the columbia river estuary vallaeys et al 2018 lake tanganyika delandmeter et al 2018 the burdekin river estuary delandmeter et al 2015 or the congo river estuary vallaeys et al 2020 the model governing equations can be written as follows 1 u t h u u w u z h ν h h u z ν u z f e z u g h η g ρ 0 h z η ρ ρ 0 d z 1 ρ 0 h p a 2 h u w z 0 3 t t h u t w t z h κ h h t z κ t z f relax where the unknowns are the horizontal velocity u u v the vertical velocity w and the temperature t an external mode solves the fast propagating waves to compute the free surface elevation η the temperature impacts the water density ρ through the equation of state of jackett et al 2006 the horizontal viscosity ν h follows the parametrization of smagorinsky 1963 and the horizontal diffusivity κ h the parametrization of okubo 1971 a second order turbulence closure provides the vertical viscosity ν and diffusivity κ other parameters are f the coriolis parameter ρ 0 1005 kg m 3 the constant reference density and g 9 81 m 2 s the gravitational acceleration the mathematical symbols e z h and respectively stand for the vertical unit vector pointing upward the horizontal derivative operator and the vector product operator for more information regarding these equations see vallaeys et al 2018 in our study lake titicaca is considered as an entirely closed system regarding the water mass balance and we assume equilibrium between inputs and outputs of water in order to parameterize the heat flux based on the difference between prescribed surface temperature and the computed temperature in the top layers of the lake a temperature relaxation term f relax is included in eq 3 4 f relax max z r z 0 z r τ r t surface t where the depth of the relaxation zone z r 25 m and the relaxation time τ r 5 days have been calibrated empirically this relaxation term linearly decays from a maximum value at the surface of the lake to zero when z z r 2 3 ecosystem model to assess the effect of land based activities on the lake we have developed an ecosystem model that is coupled with the hydrodynamic model it simulates the space time dynamics of four variables nitrogen based nutrients n phytoplankton p zooplankton z and detritus d the biochemical processes linking these variables together are summarized in fig 3 our model is based on the work of tian et al 2015 with some parameter values adapted to lake titicaca in a npzd model there is an uptake of nutrients by phytoplankton through photosynthesis the growing phytoplankton is subject to mortality and to grazing by zooplankton this zooplankton can redistribute nutrients through its metabolism excretions and is also subject to mortality finally the detritus stock is replenished by the dead phytoplankton and zooplankton detritus provide nutrients through remineralization and are subject to sinking forces in addition to these basic processes an external input of nutrients is added in order to simulate the contribution of nutrient rich waters from the katari river due to the upstream anthropogenic activities all the variables of the npzd model are transported by the flow it therefore runs simultaneously with the hydrodynamic model the coupling between both models is only one way as the npzd model requires the velocity and temperature fields computed by the hydrodynamic model but the latter is not influenced by the npzd model outputs the governing equations of the ecosystem model can be written as follows 5 n t a n u p λ g z ε f 1 t d d n 6 p t a p u p g z m p f 1 t p 2 d p 7 z t a z γ g z m z f 1 t z 2 d z 8 d t a d 1 γ λ g z m p f 1 t p 2 m z f 1 t z 2 ε f 1 t d s d d z d d where the advection a and diffusion d terms for a component x are defined as follows 9 a x h u x w x z 10 d x h κ h h x z κ x z where u and w are the horizontal and vertical velocities computed by the hydrodynamic model the diffusivity coefficients κ h and κ are assumed to be identical to those used in eq 3 for the temperature in eq 8 the vertical advection term with a velocity s d represents the sinking of detritus to the bottom of the lake a similar term could also be used in the phytoplankton equation to account for phytoplankton sinking here we chose not to consider it as we are mostly interested in developing a model that can predict the occurrence of algal blooms in freshwater systems algal blooms are often the result of a sudden increase in cyanobacteria these photosynthetic bacteria tend to form gas vesicles that allow them to float at the surface cyanobacteria therefore remain in the upper illuminated water layer of a stratified lake and hence increase their total daily light dose which further enhances their growth in the particular case of the 2015 algal bloom in lake titicaca which we consider in this paper acha et al 2018 have shown that the algae involved in the bloom were almost entirely carteria sp which are not cyanobacteria but a type of green algae having four flagella these algae have a small albeit non zero sinking velocity of about 0 2 m day bienfang and harrison 1984 in our npzd model we have therefore assumed that the phytoplankton compartment is only composed of bloom forming algae for which the sinking velocity is small enough to be neglected a more realistic model would of course distinguish between different phytoplankton species but this is beyond the scope of this paper the uptake u p and grazing g z terms are defined as 11 u p μ max f 1 t f 2 n f 3 i p 12 g z g max f 1 t f 4 p z nitrogen uptake is topped by a maximum growth rate for phytoplankton μ max and is influenced by the temperature through f 1 t the availability of nitrogen through f 2 n and the phytoplankton response to light through f 3 i grazing on the other hand is limited by the zooplankton maximum grazing rate g m a x by the amount of phytoplankton available for grazing through f 4 p and by temperature through f 1 t the effect of temperature on grazing and nutrient uptake is parameterized as an exponential function decreasing from an optimal temperature t o p t 13 nitrogen availability is parameterized by a michaelis menten function characterized by the half saturation constant for nitrogen uptake k n 14 solar radiation also plays an important role since it is the main driver of photosynthesis solar radiation reaches the lake surface with a surface photosynthetically active radiation par of 275 w m2 this value is particularly large since lake titicaca is situated in high altitude where solar radiation is less attenuated by the atmosphere the radiation makes its way through the water column where it is progressively absorbed by pure water phytoplankton and detritus this light attenuation is calculated as a function of water depth and phytoplankton and detritus concentrations with their respective light attenuation constants k w k c and k d as follows 15 i z i 0 exp k w z k c z η p d z k d z η d d z in the water column phytoplankton can utilize this energy for photosynthesis nevertheless the amount of par that is effectively absorbed by phytoplankton f 3 i depends on the intensity of the radiation since effects such as light inhibition take place it is parameterized using the formulation of platt et al 1980 16 where α and β are the light photosynthesis slope and the inhibition coefficient the maximum efficiency is attained at 79 w m2 when the intensity is high enough to provide significant energy to phytoplankton but small enough to avoid damaging vegetation tissues finally the effect of phytoplankton on zooplankton grazing is finally parameterized by a hill langmuir equation with a hill coefficient of 2 and the half saturation constant k p 17 all the ecosystem model parameters are summarized in table 1 for lack of field data they could neither be measured directly nor estimated by inverse modeling from observations of the n p z and d concentrations we have therefore used the same parameters values as those used by tian et al 2015 for a similar modeling study but in a different location the ecosystem model equations are solved on the same unstructured mesh as the hydrodynamic model equations by using also the dg finite element method 2 4 model settings we simulate the lake dynamics from january 2014 to june 2015 with a time step of 35 s the model takes about 3 to 4 months to spin up and reach a state in balance with the forcings as for the spatial discretization a 2d unstructured mesh is first generated with the open source mesh generator gmsh geuzaine and remacle 2009 the mesh resolution depends on the distance to the coast with a maximum mesh resolution of 300 m along the coast of lago menor and 800 m along the coast of lago mayor faraway from the coast the mesh coarsens and reaches a minimum resolution of 15 km this allows us to concentrate the computational resources where they are most needed in particular the resolution is sufficient to represent the narrow passage of tiquina connecting both basins once the horizontal mesh has been built the 3d mesh is obtained by extruding it vertically over a maximum of 15 horizontal layers called z levels depending on the water depth the vertical resolution reaches 1 m in the top layers where the biophysical processes of interest take place and coarsens to 60 m in the deepest parts of the lake in the end the 3d mesh is composed of a total of 2 1 1 0 5 triangular prismatic elements fig 4 the main forcings that drive the water movements in our model are the lake surface heat and momentum fluxes the wind data used for this purpose are that of the climate forecast system cfs provided by the national oceanic and atmospheric administration noaa this reanalysis product provides hourly time series of the u and v components of wind at 10 m over land with a horizontal resolution down to 0 5 surface temperature is extracted from the era5 climate reanalysis dataset provided by the copernicus climate change service c3s this dataset consists of hourly skin temperature with a spatial resolution of 0 25 era5 provides water surface temperatures as it takes into account water bodies when computing global skin temperatures initial water temperatures are set from 12 7 c at the surface to 12 c in the depth corresponding to typical values for january and initial water velocities and elevations are set to zero for lack of more precise field data the ecosystem model is initialized with spatially homogeneous values for n p z and d throughout the lake for the nutrients we use the average nitrogen content no 2 no 3 of 1 79 mmol n m 3 measured by cruz et al 2014 since we did not have field measurements for the other variables we used the initial values of tian et al 2015 and adjusted them so that the ratio with the nutrient concentration is the same in both systems this leads to initial values of p z and d equal to 0 45 0 22 and 0 mmol n m 3 respectively although these initial values are certainly a crude estimate of the real state of the system at the start of the simulation it is worth noting that the npzd model sensitivity to the initial conditions is rather weak after an initial spin up period of about 3 4 months the model reaches a state in balance with the forcings and hence forgets the initial condition furthermore the coupling between both models being only one way from the hydrodynamic model to the npzd model any errors in the npzd model would not impact the hydrodynamic model results as shown by the governing equations the npzd ecosystem model is driven by physical factors such as water currents or light intensity in our study we also pay particular attention to the nitrogen river flux in lago menor however little data is available to build an accurate forcing nutrients provided by the katari river during 2014 and 2015 are estimated by analyzing the river flow rate provided by the bolivian ministry of environment and water mmaya 2019 and the concentrations of contaminants provided by different studies see appendix a for details since the annual flow rates were similar during years 2010 to 2015 we consider the no 3 concentrations measured during this period as a proxy to reconstruct the monthly values for the year 2014 for instance measures taken on november 2013 are used to derive no 3 concentrations in november 2014 this way we are able to create an approximation of the anthropogenic contamination in no 3 during 2014 and 2015 fig 5 additionally since the nitrogen based nutrients in the model also take into account no 2 concentrations these are added to the n input forcing following the same no 3 no 2 ratio found in lago menor for each mmol n l of no 2 we observed 12 mmol n l of no 3 as a global mean cruz et al 2014 the total nitrogen input are thus computed as follows 18 n input n o 3 n o 2 n o 3 1 12 n o 3 13 12 n o 3 no quantitative data is available concerning ammonium or phosphorus in the lake nevertheless the concentrations of soluble reactive phosphorus srp available for phytoplankton growth are often high in lake titicaca relative to the amounts of dissolved inorganic nitrogen din no 3 no 2 nh 4 the din to srp ratio an indication of algal nutrient deficiency is usually well below 10 1 iltis et al 1992 phosphorus can thus be neglected in our study since it is not considered as a limiting element 3 results our model provides the space time evolution of the water velocity the temperature and the npzd components the results shown here are chosen in order to provide means of determining whether the model is able to accurately simulate the annual physical evolution of the lake we also study the bloom event simulated in march 2015 3 1 water current and temperature water currents are mainly influenced by the wind which blows towards the southwest through most of the year as a result surface waters tend to flow towards the south of the lake see fig 6 showing the yearly average of the surface velocity there is a global southward surface flow with a maximum velocity of about 5 cm s in the center of lago mayor on the other hand lago menor shows less pronounced currents due to its shallow nature in the cohana bay where the n input occurs currents are quite slow 2 cm s the strait of tiquina connects both parts of the lake although the flow in the passage frequently reverses there is a net average flow directed towards lago menor not shown the mean transport ranges from 0 01 to 0 03 m 2 s which leads to yearly volumes of 1 to 10 1 0 8 m 3 flowing through the strait the discharge barely exceeds 300 m 3 s although our model predicts instantaneous peaks of more than 1000 m 3 s this flux is one order of magnitude larger than the outflow through the desaguadero river or the inflow from the katari river this supports our hypothesis that the lake is a closed system with regard to water input output it also highlights the importance of modeling the circulation in the entire lake and not just in lago menor the evolution of water temperature within the lake is strongly dependent on the surface temperature during the cooler dry season the surface temperature drops from around 15 c in february to 12 5 c in july the surface temperature thus falls to values similar to the temperature in the bottom of the lake 12 c the thermocline a physical barrier separating the warmer surface waters from the underlying cooler waters is thus much less pronounced than during the wet season this weakening of the thermocline barrier leads to more vertical mixing between water layers however the water column is partially mixed as only the top portion of the water column is affected richerson 1992 our model is able to qualitatively reproduce the evolution from a strongly stratified temperature profile in the summer to an almost vertically uniform profile in the winter fig 7 for year 2014 in august 2014 it is interesting to note that there is only a 0 5 c difference between the surface and the lake bottom temperatures this is enough to restrict the vertical mixing to the top 100 m below the surface however in some years a complete temperature inversion can occur in which the deep waters are warmer than the surface waters this would result in a complete vertical mixing and occurrences of this phenomenon were recorded in the past richerson 1992 a more quantitative validation can be achieved by comparing our simulated temperature profiles with the data gathered during the cr 1407 scientific cruise that took place in july 2014 cruz et al 2014 fig 8 shows four temperature profiles on different locations around lake titicaca the root mean square error rmse is calculated between the outputs and the observations for each of the 27 profiles in order to evaluate the precision of the model the results are listed in appendix b the simulated results are close to the observations in most cases however the model shows non negligible errors in lago menor this is partially due to the surface boundary condition indeed due to the poor spatial resolution of the skin temperature data surface temperatures in the lago menor and near the edges of the lake were partially affected by the adjacent land surface temperatures during interpolation our model performs well at reproducing the temperature evolution towards the depth of the lake with a global mean error of 0 42 c the summer and winter dynamics can be further compared by looking at the temperature spatial variations along a section of the lake for the months of august and december fig 9a during the wet season december lake titicaca presents a stratified distribution of water temperature with 17 c on the surface and 12 c on the bottom of the lake see fig 9a the modeled thermocline is located between 20 and 30 m depth during the cooler dry season the surface temperature falls to values around 12 5 c the temperature gap between the surface and the bottom of the lake is much less pronounced than during the wet season the clear thermocline thus disappears and is replaced by a smoother thermal gradient the disappearance of the thermocline can be explained by the effect of the thermal inertia of the lake indeed this inertia is responsible for the slow cooling of waters therefore maintaining warmer temperatures at medium depths than near the surface this inversion of temperature is what drives the vertical movement of water since the warmer and less dense waters tend to rise 3 2 npzd components the distribution of the npzd components within lago mayor is not directly influenced by river inputs since the influx of n is restricted to lago menor also the model sensitivity to the initial conditions is weak indeed several simulations launched with different starting values for the npzd components take only a few days to reach a similar equilibrium state nutrients are mainly found in the depths of the lake fig 9b sinking detritus are also found in these areas see fig 9e and are the most important source of n through the remineralization process during periods of strong stratification phytoplankton thrives within a horizontal layer between 25 m and 80 m depth as it requires both nutrients available below and sunlight from above see fig 9c and fig 9d likewise it is common to find zooplankton in this same thriving region since it solely feeds on phytoplankton through grazing higher phytoplankton concentrations can be found near the edges of the lake this phenomenon is due to the nitrogen and detritus distributions indeed in these areas the lake is rather shallow and detritus which accumulate near the bottom are closer to the surface the remineralization process is thus particularly efficient with the higher temperatures from the proximity with the surface the high availability of nitrogen in these regions promotes phytoplankton growth our results also indicate that phytoplankton and thus zooplankton concentrations are generally higher in lago menor than in lago mayor these results agree with observations made by iltis 1992 who mentions that biomass levels during 1985 1987 were 5 to 36 times higher in lago menor than in lago mayor during periods of strong vertical mixing both phytoplankton and zooplankton are transported towards the surface in fact the phytoplankton concentration greatly increases during this period since nitrogen becomes available higher in the water column the phytoplankton is able to survive closer to the lake surface where more light is available this leads to an increase of phytoplankton and that in turn accelerates zooplankton growth 3 3 phytoplankton bloom of march 2015 during the algal bloom event of march april 2015 high concentrations of carteria sp were found in the eastern part of lago menor in fig 10 we take a closer look at lago menor on the 24 th of march 2015 nutrients concentrations are high in the cohana bay where the forcing is applied this is a shallow region with weak currents and where nutrients therefore tend to accumulate however the distribution of n in this region is not entirely homogeneous this is partly due to the current directions that disperse the nutrients and the temporal evolution of the n flux from the katari river indeed the input of nitrogen is weaker during the dry season when the river flow is weaker and the waters are less polluted currents eventually manage to bring the nutrient around the peninsula towards the north eastern part of lago menor the same currents are responsible for the spread of detritus towards the north eastern side of lago menor phytoplankton zooplankton and detritus concentrations are also high in the cohana bay this is primarily due to the high nutrient availability that drives the ecosystem forward the spread of the phytoplankton towards the north east follows the same pattern as in the satellite imagery around the same date fig 2 the algae spread within the lake following the water currents towards the north east and the center of lago menor the satellite imagery did not cover the western part of the basin a movie showing the phytoplankton evolution is provided in online resource 1 4 conclusions we have developed a multi scale eco hydrodynamic model of lake titicaca that can represent both the complex interplay between biological and physical processes at stake and the complex topography of the lake the former is achieved by coupling a state of the art 3d hydrodynamic model with a npzd ecosystem model the resulting model includes all the processes required to simulate the space time evolution of water quality in the lake the latter is achieved by using novel numerical methods based on a discontinuous galerkin finite element approximation computed on a multi scale unstructured mesh to solve the model equations it allows us to locally increase the resolution to represent small scale features such as the narrow passage between lago menor and lago mayor without affecting the overall model performance the resulting model has been validated with all the available observations our results indicate that the coupled slim npzd model is able to effectively simulate the biophysical dynamics of the lake the annual evolution of the thermocline shows a loss of stratification during july august leading to vertical mixing over the top 100 m layer this simulation concurs with the observations of richerson 1992 which serve as a validation for the hydrodynamic component of the coupled model similarly the temperature profiles extracted on july 2014 over the depth of the lake are very close to the ones observed by the scientific cruise cr 1407 cruz et al 2014 this confirms the ability of the model to reproduce the thermal stratification of the lake the lack of validation data concerning water currents prevents us to draw conclusions regarding the quality of the simulated velocity field nevertheless our results are comparable to the velocity computed by aguirr cespedes 2009 in his numerical hydrodynamic model of the lake overall the validations indicates that our model is able to effectively represent the global physical behavior of lake titicaca the npzd ecosystem model coupled to the hydrodynamic model manages to simulate the stratification of phytoplankton and zooplankton revealing a horizontal thriving zone between 25 m and 80 m below the surface during the wet season compared to the data presented in iltis 1992 and cruz et al 2014 our model struggles to reproduce the exact vertical distribution of phytoplankton in lago menor during the dry season however our model manages to correctly simulate the horizontal distribution of phytoplankton within the lake indeed fig 10 shows a spread of phytoplankton similar to what occurred during the algal bloom of march april 2015 fig 2 likewise the phytoplankton distribution in lago mayor indicates higher concentrations near the edges of the lake in shallower areas in agreement with the observations of iltis 1992 it is important to mention the structural differences between lago mayor and lago menor which make them two distinct environments with different hydrodynamics and thus different ecosystemic development schemes it is thus difficult for a unique model to harness both environments however with its variable resolution slim manages to explicitly represent exchanges between both basins through the narrow strait of tiquina this exchange flow largely exceeds rivers inflow outflow the coupled slim npzd model is thus able to provide realistic simulations of lake titicaca as a whole the model can reproduce the occurrence of vertical mixing during july august and the related consequences on the npzd components as well as the algal bloom event of march april 2015 the ability to reproduce these historic conditions given the appropriate input forcing data ensures the validity of the model and enables new research opportunities now that the water currents and the dynamics taking place can be simulated further studies regarding hydrodynamics could be conducted over the entire lake the spread of contaminants such as mercury linked to illegal mining activities or plastic pollution due to uncontrolled urban discharge can now be simulated and predicted this would help to better understand the dynamics of the spreads taking place throughout lake titicaca the long ranging impacts of these pollutions could then be estimated which could reveal the broader consequences of local contamination sources finally our model would allow to estimate the effect of climate change on the lake ecosystems by for instance assessing the impact of rising temperature and decaying nutrients on the phyto and zooplankton populations to better protect the rich biodiversity of the lake and to ensure a durable future for the local populations environmental policies are being implemented by the bolivian ministry of environment and water in this context our model is a new tool to estimate and predict the impact of human activities on lake titicaca s ecosystem we believe our model could help local authorities to actively manage the lake and the surrounding watershed for example to treat the algal bloom events threshold values of allowed nitrogen discharge could be found which would limit the proliferation of algae other uses of the model could be envisioned for other types of pollutions which could help mitigate the negative impacts of human activities on the lake biodiversity credit authorship contribution statement françois duquesne software investigation data curation writing original draft visualization valentin vallaeys methodology software validation writing review editing prem jai vidaurre investigation resources emmanuel hanert conceptualization methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments computational resources were provided by the consortium des équipements de calcul intensif céci funded by the f r s fnrs under grant no 2 5020 11 the authors also wish to acknowledge the bolivian ministry of environment and water for their help in data gathering appendix a nutrient input from the katari river due to the lack of available data concerning the nitrogen discharge of the katari river an artificial but realistic forcing is built this allows us to advance in our research although it is a potential source of error the n input forcing is computed by considering both the punctual no 3 concentrations measurements and the 2014 2015 katari river waterflow we hypothesize that the no 3 concentration remains similar each year for instance the concentration value in march 2014 is reported in march 2015 by combining the concentrations with the water flow we find the amount of no 3 discharged per second for each month in a similar way for the remaining months of the year data is extrapolated by using plausible concentration values waters are less polluted in the dry season since the delta filters out a large amounts of nitrogen certain difficulties still remain such as the estimation of the nitrogen provided by the local populations of the cohana bay or the amount leached by the neighboring livestock farming activities table a 2 shows no 3 values provided by different sources on different dates of measurements fig a 11 shows the outflow history of the katari watershed the flow rate has the same aspect during the period of 2011 to 2015 with a peak flow at around 30 m 3 s the figure is reproduced from the geovisor vibh of the mmaya mmaya 2019 appendix b temperature validation plots temperature profiles are displayed at 27 measurement locations over lake titicaca in fig b 12 cruz et al 2014 the root mean square error rmse is computed for each point by comparing observations with the corresponding simulated values at depths where observations are available appendix c validation of the vertical distribution of phytoplankton fig c 13 shows the vertical distribution of simulated phytoplankton slim model and chlorophyll a concentrations gathered by the cruz et al 2014 scientific cruise the phytoplankton qualitatively represents the observed shape of the chlorophyll a distributions although detritus also contains part of this chlorophyll a appendix d supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2020 109418 appendix d supplementary data the following is the supplementary material related to this article video s1 this video highlights phytoplankton s space time evolution during the march 2015 algal bloom event 
24706,north american forests are threatened by changes in climate and disturbance dynamics current efforts to model future vegetation and fire dynamics are challenged by the lack of mechanistic representation of ecological processes the spatial resolution to capture landscape level heterogeneity and the ability to model regional spatial extents to address these gaps a dynamic vegetation model was adapted for regional applications to the western forests of the u s here we present lpj guess lmfirecf a dynamic vegetation model that includes the ecological processes of a dynamic global vegetation model with cohort based forest demography lpj guess and a mechanistic fire module lmfire with a newly developed routine to simulate stand replacing crown fires cf the lmfirecf fire module calculates surface fire and canopy characteristics to determine if critical conditions are met for crown fire initiation and spread and if met calculates crown fire effects adapting the model to regional applications required parameterization of dominant regional plant functional types pfts and additional model adjustments related to the representation of fire simulations driven by historical climate data from 1980 to 2016 were made to compare the two different fire modules the original globfirm and newly created lmfirecf and two different plant functional type pft parameterizations the original global vs newly created regional pfts model performance was evaluated by comparing simulation outputs to field and satellite based estimates for landscape biomass distribution dominant plant cover fire activity and forest regeneration lpj guess lmfirecf accurately represented vegetational zones with elevation and climate gradients in yellowstone national park ynp total carbon in aboveground live vegetation within ynp simulated by lpj guess lmfirecf with the regional pfts overestimated satellite based estimates by 12 44 8 tgc vs 39 9 tgc respectively in comparison an lpj guess simulation using the older globfirm fire module and global pfts resulted in total carbon in aboveground live vegetation of 225 tg c for ynp five times the satellite based estimates lpj guess lmfirecf simulated burned area and fire severity approximated satellite based observations importantly lpj guess lmfirecf simulated the large stand replacing fires of 1988 in yellowstone as emergent results without model initialization of vegetation cover or fire history lpj guess lmfirecf simulated that 25 of the area of ynp burned in 1988 compared to 36 based on field and satellite based estimates however modeled postfire regrowth was more rapid than field based estimations with simulated mean biomass 24 years postfire 40 1 1 65 mg ha 1 58 greater than field estimations 25 4 2 5 mg ha 1 yet simulated mean biomass for mature forests 100 years old without a major disturbance was 24 less than field estimations 58 4 0 8 compared to 76 6 3 5 mg ha 1 in summary lpj guess lmfirecf effectively simulates regional crown fire dynamics and vegetation to more accurately model regional biomass plant biogeography and fire activity keywords fire modeling stand replacing crown fires plant biogeography biomass turnover ecosystem modeling yellowstone national park 1 introduction changes in regional climate and disturbance characteristics threaten the resiliency and function of forested ecosystems turner et al 2019 walker et al 2019 increasing the need for regional modeling of forest and disturbance dynamics u s doe 2018 forest resiliency is defined as the capacity of a forest to absorb change and disturbance and have structure and function persist holling 1973 with increases in fire season length area burned and frequency of large fires in the boreal and temperate forests of north america dennison et al 2014 kasischke and turetsky 2006 westerling 2016 2006 there is uncertainty about the resiliency of these forests and their carbon storage turner et al 2019 walker et al 2019 in particular the extent of high severity fires that kill most or all of the trees across entire stands referred to here as stand replacing fires is increasing flannigan et al 2009 stephens et al 2014 the ability to predict future forest resiliency is dependent on the development of process based simulation models that can represent complex interactions between forest demography disturbance climatic factors and increasing atmospheric carbon dioxide u s doe 2018 therefore appropriately modeling plant geography disturbance driven biomass turnover and forest regrowth under a changing climate is critical to predicting future changes to forests persistence and function at a regional scale current common approaches to regional forest modeling are empirical models individual based simulation models that are extended to landscape applications or dynamic global vegetation models dgvms applied regionally empirical modeling including correlation regression and principal component analyses can reveal important climatic and disturbance relationships affecting forest productivity emmett et al 2019 notaro et al 2019 potter 2019 yet empirical models are often constrained by the limited number of variables included by the modeler that may fail to capture complicated feedbacks between ecological processes also since empirical models are based on correlative relationships between variables from field or remotely sensed data they rely on statistical extrapolation to make inferences about conditions or areas not explicitly measured individual based forest landscape models offer high resolution e g 2 m to 30 m spatial resolution simulations of forest dynamics mladenoff 2004 seidl et al 2012 individual based simulation models trade their high spatial resolution for limited spatial extent making regional scale simulations computationally impractical in contrast dgvms were developed for understanding feedbacks between vegetation dynamics biogeography and biogeochemistry bachelet et al 2001 moorcroft et al 2001 sitch et al 2003 at the regional to global scale dgvms are process based simulation models that represent vegetation dynamics including plant establishment growth competition and mortality the formulations within process based models are often more closely based on principles of vegetation dynamics e g canopy scaling based on optimum leaf nitrogen distribution than on empirical relationships and therefore are less dependent on statistical extrapolation for novel conditions they also incorporate physical processes e g soil hydrology and physiological processes e g photosynthesis respiration and carbon allocation important for representing ecological function the benefit of adapting a dgvm to regional applications is the inclusion of these vegetation dynamics and ecological processes that interact to determine forest resiliency further development of fire dynamics and forest demography in dgvms is needed to more accurately represent these interactions pugh et al 2019a u s doe 2018 zhu et al 2016 to capture the ecosystem responses and interactions between vegetation climate and disturbance dgvms must include comprehensive and realistic fire modules keane et al 2015 the necessity of fire module development in dgvms led to the formation of the fire modeling intercomparison project and remains an area of active research hantson et al 2020 2016 li et al 2019 rabin et al 2017 while there have been many advances improvement is needed in the representation of forest fires that burn the crowns of trees or shrubs killing most or all of the overstory pugh et al 2019a 2019b hereafter referred to as stand replacing crown fires agee 1996 scott and reinhardt 2001 currently the prominent dgvms rely upon surface fire models and empirical fire behavior models which do not include the transition of a surface fire into the canopy limiting their ability to reproduce and predict stand replacing crown fires chaste et al 2018 gavin et al 2014 hantson et al 2016 lehsten et al 2016 li et al 2012 rabin et al 2017 advances are also needed in the modeling of forest demography within dynamic vegetation models dgvms typically simulate plant functional types pfts representing multiple plant species grouped by their physical phenological and phylogenetic characteristics process based simulation models are often initiated and constrained by field or remotely sensed data prescribing the distribution of pfts or forest productivity for example in the carnegie ames stanford approach ecosystem model simulations land cover type was prescribed from satellite imagery and moderate resolution imaging spectroradiometer modis enhanced vegetation index and airborne remotely sensed coarse woody debris were used as inputs to estimate net primary productivity potter et al 2011 while initializing and constraining process based models with observational data can lead to more realistic simulation results such approaches fail to demonstrate the emergent properties of the model and thereby reduce confidence in prognostic simulations calibrating model parameters for simulated pfts and represented processes is a necessary step to improve model performance without relying on initialization of plant cover type for example improving the representation of high latitude vegetation in another dgvm organizing carbon and hydrology in dynamic ecosystems required modification of photosynthesis parameters for each simulated pft adjustment of temperature limits to tree distributions and revised tree mortality calculations zhu et al 2015 these dgvm developments have not yet included crown fire simulations nor have they been applied to all dgvms the dynamic vegetation model lpj guess is well suited for regional application because it incorporates the physiological and biophysical processes of a dgvm while simulating cohorts of pfts to represent forest demography lpj guess was developed from the dgvm lpj lund potsdam jena sitch et al 2003 which represented pfts as average populations the general ecosystem simulator guess version represents vegetation as age based cohorts allowing the representation of stand structure and mixed plant composition simulating age based cohorts is an intermediate approach between individual based and population based models adding structural complexity while minimizing computational costs to enable regional to global scale applications fisher et al 2018 in lpj guess vegetation is simulated in independent patches for each grid cell with plant establishment growth and competition represented as mechanistic processes based on first principles and empirical relationships for detailed model description see smith et al 2001 previous regional applications of lpj guess explored vegetation dynamics and plant biogeography in forests of the northeastern u s hickler et al 2004 tang et al 2012 and subregions across europe hickler et al 2012 koca et al 2006 morales et al 2007 smith et al 2008 2001 however to adapt lpj guess for regional application to western u s forest biomes several modifications were needed minor model modifications included adjustments to pedotransfer functions and the inclusion of soil parent material data section 2 2 major developments included parameterization of regional pfts to represent the composition of western forests section 2 3 in turn the carbon allocation scheme was modified to produce more realistic tree heights section 2 4 and calculations of pft specific tree crown length were added section 2 5 most importantly the fire module lmfirecf was developed to simulate the stand replacing crown fires characteristic of many western forests sections 2 6 and 2 7 the development history of the dgvms and fire modules relevant to this study is shown in fig 1 globfirm the original fire module commonly used within lpj guess represents fire occurrence size and effects using semi empirical approaches for non ignition limited ecosystems thonicke et al 2001 fire occurrence is determined daily by whether air temperature fuel moisture content and abundance of aboveground litter are above minimum thresholds fire size is represented as the fraction of a grid cell burned as a function of fire season length based on an empirical relationship between length of fire season and area burned while this approach is intuitive the simplifications overlook potential feedbacks that could be represented by a more mechanistic approach for example fire occurrence does not consider the availability of an ignition source or fuel conditions that may be limiting in some ecosystems fire size does not consider any mechanisms for fire spread thereby all fires for a season will be of the same size regardless of fuel availability and fuel moisture fire effects are represented as the fraction of biomass burnt by fire is based on a pft specific fire resistance parameter all burned live and dead biomass is considered entirely combusted and added to the annual carbon flux to the atmosphere this representation of fire effects ignores any varying resistance to fire based on age class and fails to distinguish partially burned e g standing dead woody debris and combusted fuels emitted to the atmosphere to better represent fire occurrence size and effects in lpj guess simulations we integrated lmfire a mechanistic fire module originally developed for use in lpj pfeiffer et al 2013 lmfire simulates fire occurrence behavior and impact from a more mechanistic perspective by incorporating fire danger indices with fire spread modeling pfeiffer et al 2013 thonicke et al 2010 fire occurrence is based on calculated probabilities of natural ignitions and anthropogenic burning habits instead of having fire size based on an empirical relationship with fire season length as in globfirm lmfire represents fire behavior by calculating fire rate of spread based on weather and topography following rothermel s equations rothermel 1972 it also allows multi day burning and coalescence of fires within patches more realistically representing fire behavior however it must be noted that patches are simulated independently so fire does not spread between patches or grid cells tree mortality is a function of crown scorch and cambial damage based on the current tree height and bark thickness for each pft simulating stand replacing crown fires necessitated new developments to the lmfire module now termed lmfirecf to represent crown fire cf resulting in the ecosystem model variant lpj guess lmfirecf lmfirecf assesses if critical conditions are met for crown fire initiation and spread crown fire initiation is dependent on surface fire intensity resulting in a scorch height that reaches the canopy base height crown fire spread depends on average canopy bulk density and canopy foliar moisture content meeting critical thresholds the purpose of this paper is to introduce lpj guess lmfirecf designed for regional application for western forests of the u s and to evaluate the model s performance based on regional pfts and the new fire module simulations were run to compare two different fire modules globfirm and the newly developed lmfirecf to compare the different potential pfts simulations were run with the global pfts and the newly parameterized regional pfts lpj guess lmfirecf performance was evaluated for simulated 1 landscape biomass distribution 2 dominant plant cover distributions 3 fire activity and 4 postfire forest regeneration by comparing simulated results to field and satellite based metrics simulations of yellowstone national park ynp vegetation and wildfire dynamics are used here to demonstrate the utility of lpj guess lmfirecf for regional applications in u s western forests ynp serves as a model forested landscape to study the interactions of vegetation climate and disturbance dynamics because large stand replacing crown fires have played an important role in dictating vegetation patterns since the holocene whitlock et al 2003 the 1988 yellowstone fires burned about one third of the area of ynp serving as a natural experiment and validation for fire models 2 materials and methods 2 1 study area yellowstone national park is part of the u s rocky mountains fig 2 ynp extends 8983 km2 with a mean elevation of 2400 m and an elevation range from 1610 m to 3462 m long cold winters and cool summers characterize the climate of ynp boreal cool summer under the koppen geiger climate classifications kottek et al 2006 the northern half of the park experiences warmer mean annual temperatures and lower annual precipitation relative to the southern half fig 3 vegetation distribution patterns fig 4 correspond to elevation gradients and dominant soil type despain 1990 volcanic soils are the primary soils in ynp with relatively nutrient poor rhyolitic and andesitic soils i e inceptisols as the most dominant 47 rodman et al 1996 mollisols have a higher nutrient and organic matter content and cover 22 3 of the park the remainder of ynp is covered by combined inceptisols and mollisols 6 4 bedrock and some soil 8 6 and thermal soil 2 3 areas with inceptisols in the park tend to be dominated by lodgepole pine pinus contorta forests while areas with mollisols tend to be nonforested at lower elevations forests are comprised of douglas fir pseudotsuga menziesii rocky mountain juniper juniperus scopulorum and quaking aspen populus tremuloides and nonforested areas are comprised of grasslands and sagebrush artemisia spp steppe the subalpine areas are dominated by lodgepole pine with occurrences of subalpine fir abies lasiocarpa and engelmann spruce picea engelmannii in the understory or in the canopy in the absence of fire and limber pine pinus flexilis on calcium rich soils higher elevation forested areas are often dominated by whitebark pine pinus albicaulis overall lodgepole pine dominates more than 80 of the forested area within ynp wildfire often drives vegetation dynamics in ynp with large high severity fires that kill most of the trees and initiate secondary succession occurring in the subalpine forests every 150 300 years pre european settlement higuera et al 2011 romme 1982 fire severity is defined here by the loss of aboveground vegetation and soil organic matter keeley 2009 ryan and noste 1985 with a focus on tree mortality lower elevation douglas fir forests had low severity fires with a historical frequency of every 25 60 years littell 2002 with shorter 30 year mean fire frequency in shrub and grasslands barrett 1994 higher elevation whitebark pine forests had high to mixed severity fires with a mean fire return interval of over 350 years barrett 1994 a policy of complete fire suppression was in effect since the park was founded in 1872 up to 1972 romme and despain 1989 yet efforts were not effective until about 1945 when modern fire fighting technologies became available this relatively short period of effective fire suppression is unlikely to have greatly influenced fire activity romme and despain 1989 the fires of the late twentieth century are considered comparable to fires in the early 1700s except that the vast majority of the area burned in one year 1988 romme and despain 1989 the historic fires of 1988 burned about 36 percent of the park and left a landscape mosaic of unburned areas and burned areas with varying burn severity turner et al 1994 large fire years including 1988 were associated with extreme weather conditions characterized by hot and dry summers and strong winds bessie and johnson 1995 renkin and despain 1992 westerling et al 2011 2 2 model and simulation descriptions lpj guess v 2 0 was used for simulations in this study the physiological and biophysical processes are from lpj sitch et al 2003 and other model details are given by smith et al 2001 except for the model developments described in this paper lpj guess tracks characteristics of an average individual for each age based cohort of tree and shrub pfts making the assumption that individuals of the same age in the patch have the same structure tree structure is simplified to a crown cylinder with assumed uniform distribution of carbon each grass pft is represented as a single individual lpj guess simulates dynamic vegetation in patches for each grid cell patches share environmental input values of the grid cell termed replicate patches but run independently to represent the variability of stochastic processes establishment background mortality and fire the exception is that patches are assumed to share a common propagule pool i e spatial mass effect shmida and ellner 1984 initially propagules are assumed to be available for a pft if the climatic conditions are met in the grid cell after colonization establishment of new pft saplings is dependent on the reproductive output of all cohorts of that pft in the previous year the number of saplings established per unit area per year is drawn from a poisson distribution limited by the set maximum for that pft parameter est max saplings m2 year to represent stochastic establishment variables are output as averages for the patches within a grid cell a coupled photosynthesis and hydrology module calculates plant carbon uptake limited by photosynthetically active radiation and stomatal conductance haxeltine and prentice 1996 smith et al 2001 carbon uptake is also influenced by air temperature relative to temperature optimums and atmospheric carbon dioxide concentrations lpj guess simulates light competition between pft cohorts based on their crown structure and canopy position using the lambert beer law for attenuation of light through the canopy prentice and leemans 1990 pfts also compete for soil water with uptake dependent on root distribution in the soil smith et al 2001 soil hydrology is represented as a bucket model manabe 1969 with a two layer soil profile haxeltine and prentice 1996 water infiltrates the upper soil layer 0 0 5 m through precipitation minus interception or melting snow pack soil water content is depleted by plant evapotranspiration percolation below the lower soil layer 0 5 1 5 m surface evaporation or if the upper soil layer is saturated via surface runoff the calculation of water holding capacity and other soil parameters was modified for this study to allow for the use of continuous soil texture data instead of being limited to nine soil texture classes the pedotransfer functions follow cosby et al 1984 with volumetric water holding capacity equal to the field capacity minus the water holding capacity at wilting point appendix d fig d2 for this study yellowstone national park was simulated as a landscape of 14 431 1km2 grid cells using lpj guess cartesian area lpj guess simulations were run by repeatedly selecting a year randomly from detrended historical daymet climate data 1980 2016 and static carbon dioxide concentrations 1860 value 286 4 ppm for 1000 years called a spin up which is required for lpj guess to establish soil carbon pools and for simulated vegetation to reach theoretical equilibrium with average climate each grid cell was run with 10 replicate patches to represent differences in stand structure and pft composition resulting from stochastic processes simulations were then run for 157 years 1860 2016 with transient atmospheric carbon dioxide data for years 1860 2016 detrended climate data for years 1860 1989 and historical climate data for years 1980 2016 simulations were run to compare the different fire modules globfirm and lmfirecf and different pfts global pfts and the new regional pfts pfts are listed in table 2 and described in the following section while an lpj guess lmfire crown fire routine disabled simulation for the entire ynp was not included in this study diagnostic plots comparing lmfire and lmfirecf were included in appendix f 2 3 regional pft parameterization to better represent forest demography and crown fire dynamics we replaced the more general global tree pfts that are typically used in lpj guess with species specific parameterizations for the eight dominant tree species in ynp four species lodgepole pine pinus contorta douglas fir pseudotsuga menziesii quaking aspen populus tremuloides and rocky mountain juniper juniperus scopulorum were parameterized individually due to their physical and functional similarities and geographic range overlap mccaughey and schmidt 2001 1990 whitebark pine pinus albicaulis and limber pine pinus flexilis were represented as a single high elevation 5 needle pines species pair while engelmann spruce picea engelmannii and subalpine fir abies lasiocarpa were similarly represented as a single spruce fir species pair in addition to these six species species pairs hereafter pfts a sagebrush shrub artemisia spp and two grass pfts cool grass with c3 photosynthetic pathway and warm grass with c4 photosynthetic pathway were parameterized to represent non forest vegetation table 1 values sources and citations for pft parameters are included in appendix a tables a1 a4 the bioclimatic limits for establishment and survival were based on two standard deviations below or above the mean values calculated from daymet climate for the range of a pft based on the usda forest service s forest inventory and analysis fia presence data gillespie 1999 for pfts that represent two species the more extreme bioclimatic values were used to represent a range inclusive to both species unless otherwise noted in appendix a table a1 thereby the bioclimatic limits for engelmann spruce were used for the spruce fir pft and the limits for whitebark pine were used for the high elevation 5 needle pines pft plant trait fuel loading and post fire vegetation data were collected for this study spanning foothill to alpine vegetation zones across the greater yellowstone ecosystem gye to parameterize the lpj guess and the lmfire model appendix b calibration of pft parameter values included conducting a sensitivity analysis and comparing adjustments of groups of parameters e g shade tolerance parameters effect on species dominance in a grid cell with inceptisol soils lodgepole pine background and maximum establishment rates were increased these parameter adjustments served as a proxy for lodgepole pine s improved competition against other tree pfts in nutrient poor volcanic soils the production of fire adapted cones that open when exposed to high temperatures known as serotinous cones varies amongst populations of lodgepole pines schoennagel et al 2003 serotiny was not included in lpj guess lmfirecf so all grid cells were assumed to have the same availability of propagules independent of their fire history not including a critical restraint on lodgepole pine regeneration the maximum sapling establishment rate pft specific parameter est max saplings m2 year for lodgepole pine was set to one tenth the mean stem density 24 years after fire turner et al 2004 2 4 carbon allocation modification a key model development was required for more accurate representation of tree heights previously in lpj guess v 2 0 the ratio of tree leaf area to sapwood area was based on a pft specific constant or size independent allocation retained from lpj sitch et al 2003 see eq 1 for this study tree heights were constrained by modifying the allometric relationship between the ratio of tree leaf area and sapwood cross sectional area to include tree height as a covariate a size dependent leaf to sapwood area latosa ratio was implemented decreasing the latosa parameter value for each pft cohort noted by subscripts c pft by twenty units per meter increase in tree height h based on previous relationships used by mcdowell and zaehle mcdowell et al 2002 zaehle et al 2006 1 l a t o s a c p f t 20 h c p f t l a t o s a p f t where latosapft is the maximum parameter value for a pft in turn this adjusted latosa value was then used to constrain height ensuring that each unit of leaf area is supported by an appropriate amount of transport tissue following the pipe model shinozaki et al 1964a 1964b 2 5 pft crown length in lpj guess v 2 0 crown lengths tree height minus crown base height were previously set equal to tree height for all pfts and in lmfire crown length was calculated as 33 of the height for all trees neither of which are representative of tree growth in gye species instead in lmfirecf crown length varies with height based on pft specific parameters linear and quadratic regression equations were fit to field measurements of height vs crown length for gye tree species appendix b the linear slope m and intercept b values were then used to calculate variable crown length cl based on tree height h in lpj guess lmfirecf for each pft cohort c pft 2 c l c p f t m p f t h c p f t b p f t crown base height cbh which is used in the lmfirecf module was then calculated by subtracting the crown length from the tree height 3 c b h c p f t h c p f t c l c p f t 2 6 lmfire fire module modifications our model improvement included coding the lmfire routines to operate on age based pft cohorts in lpj guess as opposed to uniformly aged populations pfeiffer et al 2013 thonicke et al 2010 enabling representation of mixed aged stand dynamics tree height diameter and bark thickness are distinguished for each age based pft cohort so in lpj guess lmfirecf fire effects can vary between canopy layers partitioning of carbon pools was based on original lmfire spitfire values pfeiffer et al 2013 thonicke et al 2010 except it was necessary to increase 1 hour fuels from 4 5 reducing 1000 hr fuels by 0 225 for regional simulations the standard fuel size classes based on the diameter of live or dead woody fuels are 0 6 cm 1 hour timelag 0 6 2 5 cm 10 hour timelag 2 5 8 0 cm 100 hour timelag and 8 cm 1000 hour timelag baker 2009 since simulated vegetation is tracked as amorphous carbon pools e g leaf sapwood heartwood the fuel size classes are calculated as fractions of total live or dead carbon 4 725 7 5 21 and 66 775 for 1 10 100 and 1000 hr fuels respectively combustion of live biomass within a simulated patch is calculated for each pft cohort and is proportional to the fraction of area burned fraction of crown scorch live carbon and a combustion fraction constant by fuel size class combustion fraction constants for live biomass killed by fire were adjusted from 100 of 1 hour fuels and 5 of 10 hour fuels chaste et al 2018 pfeiffer et al 2013 to 90 80 50 and 0 for 1 10 100 and 1000 hour fuels respectively keane et al 2011 the remaining live vegetation killed by fire is transferred to litter fractions of dead biomass combusted depend on fuel moisture content relative to its moisture of extinction by fuel size class the moisture of extinction is the fraction of moisture content above which fuel stops burning moisture of extinction values were adjusted from 0 404 0 487 0 525 0 5440 for 1 10 100 and 1000 hour fuels respectively pfeiffer et al 2013 to 0 2 for all fuel size classes based on estimates that the moisture of extinction rarely exceeds 15 30 scott and burgan 2005 other parameter values for the lmfirecf fire module are shown in appendix c table c1 2 7 crown fire dynamics a newly developed routine to simulate stand replacing crown fires cf was incorporated with lmfire and in addition to the modifications described previously result in the fire module lmfirecf in lpj guess lmfirecf to determine if crown fires cf would occur in a patch surface fire and canopy characteristics were calculated to determine if critical conditions were met for crown fire initiation cfi and crown fire spread cfs 4 c f 1 i f c f i 1 a n d i f c f s 1 0 o t h e r w i s e crown fire initiation requires a critical surface fire intensity for the start of crowning such that the scorch height reaches the canopy base height van wagner 1993 1977 scorch height sh is calculated as 5 s h 0 148 i 2 3 where i is surface fire intensity kw m 1 alexander 1982 van wagner 1973 the constant modifier was set at 0 148 as found by van wagner 1973 an increase from the 0 094 assigned by pfeiffer et al 2013 since lpj guess represents age based cohorts of pfts canopy bulk density was calculated for each horizontal canopy layer that was 1 m thick 0 5 m to determine canopy base height canopy height and average canopy bulk density canopy bulk density is the sum of leaf and 1 hour live fuel mass per unit volume of canopy as this is considered the biomass that would burn quickly to sustain crown fire spread brown et al 1991 keane et al 2005 reinhardt et al 1997 scott and reinhardt 2001 in the following equations lowercase annotations are used for age cohort crown variables and uppercase annotations are used for forest canopy variables assuming crown bulk density cbd is uniform throughout the crown length cl for the average individual representing each pft cohort c pft leaf biomass and 1 hour live fuel biomass lf class were averaged for each crown layer l from crown base height cbh to tree height h 6 c b d l c p f t l c b h h l e a f b i o m a s s c p f t l f 1 c p f t c l c p f t then crown bulk density was totaled across the number of cohorts for each pft ncpft and summed across tree pfts to get canopy bulk density cbd at each layer in the canopy 7 c b d l p f t 1 6 c 1 n c p f t c b d l c p f t canopy base height was determined as the layer height at which the summed canopy bulk density for all pft cohorts was above the minimum threshold of 0 012 kg m 3 reinhardt et al 2006 canopy height was determined as the height at which the summed canopy bulk density for all pfts dropped below the minimum threshold reinhardt et al 2006 the canopy base height was then used as the critical scorch height for crown fire initiation thereby in following with van wagner s theory 1977 when surface fire intensity reaches the critical value for scorch height to exceed canopy base height cbh crown fire is considered initiated in lmfirecf 8 c f i 1 s h c b h 0 s h c b h two criteria defined critical conditions for crown fire spread average canopy bulk density above a minimum threshold 0 10 kg m 3 reinhardt et al 2006 and canopy foliar moisture content equal to or below a maximum threshold 80 these thresholds were calibrated to yield active crown fire in lmfirecf while being consistent with values in the literature the average canopy bulk density cbdavg was calculated by averaging each layer l from canopy base height cbh to canopy height ch 9 c b d a v g l c b h c h c b d l c h c b h and the average canopy bulk density is assumed to be uniform throughout its depth keane et al 1998 canopy foliar moisture content was assumed to be within the range of 50 150 scott and reinhardt 2001 van wagner 1977 the daily water stress water scalar ratio of effective water supply to demand for each tree pft was weighted by its foliar projective cover relative to total tree cover to calculate mean daily canopy foliar moisture content in lpj guess lmfirecf if both conditions are met average canopy bulk density cbdavg and canopy foliar moisture cfm are above their respective thresholds then crown fire will spread 10 cfs 1 if cb d avg 0 10 and cfm 0 80 0 othe rwise eq 4 can then be written as 11 cf 1 if sh cbh and if cb d avg 0 10 and cfm 0 80 0 othe rwise in lpj guess lmfirecf if the critical conditions were met for both crown fire initiation and crown fire spread then active crown fire is assumed to occur killing 100 of trees in the patch scott and reinhardt 2001 if these conditions are not met mortality can still occur due to crown kill for a given pft cohort proportional to the ratio of the tree height to the scorch height pfeiffer et al 2013 which may be considered a representation of passive crown fire importantly mortality due to crown kill operates on individual pft cohorts in lpj guess lmfirecf as opposed to the average individual pft population in a patch in lpj lmfire allowing taller pft cohorts to survive within a patch from passive crown fires 2 8 driver data daymet version 3 and topowx version 1 3 0 gridded daily climate data from 1980 to 2016 were used as input for lpj guess lmfirecf oyler et al 2015 thornton et al 2017 mean monthly instantaneous downward shortwave radiation for 24 h was calculated from daymet daily daylight average incident shortwave radiation total monthly precipitation was summed from daymet daily precipitation and the number of days in a month with precipitation summed to create monthly wet days mean monthly mean minimum and maximum air temperature was calculated from daily minimum and maximum air temperature for topowx1 3 0 the modern era retrospective analysis for research and applications version 2 merra 2 gelaro et al 2017 monthly eastward wind speed of lowest model layer and northward wind speed of lowest model layer were used to calculate the horizontal wind speed vector using the pythagorean theorem then resampled using r package raster from 50 km to 1km resolution hijmans 2019 mean monthly lightning strike values were calculated from world wide lightning location network data lay 2004 due to the increase in sensors through space and time the mean monthly value across the gye for 2010 2014 was used for all pixels annual global atmospheric carbon dioxide concentrations from 1860 to 2016 le quéré et al 2018 were used for all gye pixels the multilayer soil characteristic gridded data for the conterminous united states conus soil based on the usda state soil geographic database miller and white 1998 was infilled with harmonized world soil database v 1 2 for areas with missing data fischer et al 2008 to provide continuous soil data for the region since lpj guess version 2 0 used in this study does not include soil nutrient limitations a binary soil layer appendix d figure d1 indicating whether a grid cell had inceptisol soils or not was created from ynp soil type data rodman et al 1996 processing of model driver data was completed using climate data operators schulzweida 2019 nco netcdf operators zender 2014 and r packages raster hijmans 2019 rgdal bivand et al 2018 and ncdf4 pierce 2017 2 9 model evaluation datasets the performance of lpj guess lmfirecf was evaluated in four areas biomass dominant plant cover fire activity and forest regeneration estimates of carbon in aboveground live vegetation from the usda forest service s fia field measurements gillespie 1999 of 312 plots in ynp measured between 1999 and 2009 were used to benchmark simulated live aboveground carbon in vegetation estimates of aboveground live biomass for the year 2010 from the european space agency s satellite based globbiomass project santoro 2018 were used to benchmark simulated live carbon in vegetation for all of ynp globbiomass live aboveground biomass estimates were multiplied by 0 5 to approximate carbon in live vegetation assuming carbon content of biomass is about 50 penman et al 2003 it is important to note that globbiomass estimations of carbon in vegetation are only aboveground while values simulated in lpj guess include belowground carbon in the roots which could account for about 20 30 cairns et al 1997 litton et al 2003 santantonio et al 1977 to account for this difference simulated carbon in vegetation was multiplied by 0 8 to approximate carbon in aboveground live vegetation to compare to globbiomass and fia data simulated pft distributions and cover were compared to the national park service s yellowstone 1999 cover type data a geodatabase of habitat type and land cover layers created from aerial photography and field surveys despain 1990 simulated fire area burned fire severity and fire frequency were compared to monitoring trends in burned severity mtbs data from 1984 to 2016 mtbs data access fire level geospatial data 2017 and fire perimeter data acquired from the yellowstone national park spatial analysis center provided by alex zaideman field data of forest carbon storage and leaf area index in lodgepole pine dominated sites in ynp were used to evaluate simulated postfire recovery with sites that burned in the 1988 yellowstone fires sampled 11 and 24 years postfire to measure forest recovery turner et al 2017 2016 2004 and for mature lodgepole pine forests 100 years old from a 300 year chronosequence kashian et al 2013 2012 2 10 statistical analysis normalized mean square error nmse was used to quantify the range of spatial correlation between simulated total live aboveground carbon and globbiomass estimates because it is less sensitive to extreme values than using the standard deviation and it does not require uncertainty estimates which are unavailable for simulation results kelley et al 2013 nmse was calculated as 12 n m s e i y i x i 2 i y i x i 2 where y i is the modeled value in grid cell i x i is the corresponding value in the benchmarking dataset and x i is the mean value across all grid cells in the benchmarking dataset kelley et al 2013 a nmse value of zero indicates perfect agreement values 1 suggest the model s performance is worse than the null model and more generally smaller values denote better model performance welch two sample t tests were used to compare biomass and lai for regenerating and mature lodgepole pine forests between simulation results and field estimates rstudio team 2016 the welch s test was used because it does not assume equal variance to lessen the spatial autocorrelation in the simulated data 300 points were randomly selected from the 14 000 grid cells simulated and statistical tests were performed on this smaller sample dale and fortin 2002 3 results 3 1 landscape biomass fire model development in combination with the newly parameterized regional pfts greatly improved modeled live carbon in vegetation relative to lpj guess globfirm fig 5 field data from fia plots estimated mean total live aboveground carbon to be 50 8 2 04 mg c ha 1 range 0 201 mg c ha 1 with measurements limited to forested areas estimates from field data were higher than the satellite based globbiomass estimates and lpj guess lmfirecf simulation results which included non forested grid cells globbiomass a spatially continuous dataset was our best reference for total ynp biomass estimates with estimated mean live aboveground carbon in vegetation at 27 7 mg c ha 1 with a total of 39 9 tg c for the entire ynp for the year 2010 table 3 simulated carbon in vegetation using lpj guess lmfirecf with regional pfts for 2010 resulted in a mean live aboveground carbon in vegetation of 31 mg c ha 1 with a total of 44 8 tg c for ynp a 12 overestimation compared to globbiomass benchmark data in comparison simulated carbon in vegetation using lpj guess with the globfirm fire module and global pfts resulted in mean carbon in vegetation of 156 mg c ha 1 with a total of 225 tg c for ynp five times the globbiomass estimated carbon in vegetation for ynp the simulation using globfirm with the regional pfts resulted in mean carbon in vegetation of 61 7 mg c ha 1 with a total of 89 tg c for ynp double the globbiomass estimates in summary the newly developed lpj guess lmfirecf with regional pfts showed a 97 reduction in simulated biomass estimate error compared to lpj guess globfirm with global pfts mapped distributions of lpj guess lmfirecf simulated and globbiomass estimated carbon in vegetation are shown in fig 6 a b estimates of carbon in vegetation in the areas dominated by lodgepole pine are comparable between simulated and globbiomass estimates however carbon in vegetation at higher elevation areas in ynp simulated as dominated by spruce fir fig 7 are overestimated compared to globbiomass fig 6c the areas of underestimated biomass in the western and southern edges of ynp fig 6c correspond with areas that were simulated as grass dominated that are actually forested fig 7 but where uncertainty reported as standard error was higher for globbiomass fig 6d normalized mean square error nmse values indicate that model performance was greatly improved by using the lmfirecf fire module and regional pfts but all simulation results performed worse than the null model in estimating aboveground carbon table 3 3 2 dominant plant cover for the new carbon allocation scheme the size dependent leaf area to sapwood area ratio resulted in more reasonable tree heights linear relationships between tree height and crown length showed a strong correlation for all conifers r2 ranged from 0 51 to 0 97 and a moderate correlation for the deciduous pft r2 0 34 appendix b the linear regression equations better fit the data than the quadratic regression equations so the linear slope and intercept values were used to calculate variable crown length based on height in lpj guess lmfirecf by pft to evaluate the ability of lpj guess lmfirecf to simulate dominant plant foliar projective cover the fraction of modeled area covered when under full leaf cover was mapped for each pft across ynp simulated pft foliar projective cover fig 7 corresponded well with mapped national park service s nps yellowstone primary cover types from 1999 fig 4 the simulated distribution of lodgepole pine matched well with the nps distribution with lodgepole pine dominating the largest area of yellowstone simulated spruce fir engelmann spruce and subalpine fir occurrence in higher elevation regions of the park is accurate but extensive areas are actually dominated by whitebark pine in the observational data douglas fir quaking aspen and sagebrush cover was highest at lower elevations the nonforested areas in the northern region of the park lamar valley fig 4 were simulated as grass dominated lpj guess globfirm simulated pft foliar projective cover appendix e figure e1 resulted in spruce fir dominating the largest area of yellowstone in comparison to lpj guess lmfirecf results the range of area dominated by other pfts were contracted in the lpj guess globfirm simulation lodgepole pine douglas fir and cool grasses had greatly reduced cover using the globfirm fire module in the globfirm simulation spruce fir dominated areas that lmfirecf simulated as lodgepole pine or douglas fir dominant globfirm simulated lodgepole pine dominated areas that lmfirecf simulated as cool grasslands 3 3 fire activity lpj guess lmfirecf fire activity evaluated on total area burned and burn severity was greatly improved with our modifications total area burned from 1984 to 2016 from mtbs data shows that 1988 and 2016 were the largest fire years in the record fig 8 lpj guess lmfirecf simulated 1988 as the largest fire year and 2016 as a large fire year but also simulated notable area burned in 1994 2000 2003 2008 and 2012 lpj guess lmfirecf simulated that 25 of the area of ynp burned in 1988 mtbs and yellowstone national park spatial analysis center fire mapping show that about 36 of the area of ynp burned in the1988 yellowstone fires in terms of fire severity the predominant fire regime in ynp is characterized by stand replacing crown fires to compare the fire modules a time series of live and dead combusted carbon and unconsumed carbon of fire killed trees was plotted from 1984 to 2016 fig 9 while globfirm simulated 1988 as a fire year fire severity was low throughout the simulation period in contrast lmfirecf simulated 1988 more accurately as a high severity fire year with affected carbon in vegetation proportional to area burned although lmfirecf showed a large spike in affected carbon in vegetation in 1988 70 of the carbon remained in the system as litter the discrepancy in fire severity between lmfirecf and globfirm is shown in fig 10 with lmfirecf causing a 28 reduction in aboveground carbon in live vegetation across ynp from the 1988 fires compared to insignificant perturbations in carbon due to fire for globfirm throughout the simulation period fig 10 3 4 forest regeneration lodgepole pine stands regenerated quickly after the 1988 fires in ynp both in field measurements and lpj guess lmfirecf simulations table 4 from the simulated burned area in 1988 grid cells were subset that were previously dominated by lodgepole pine 50 foliar projective cover extensively burned 80 fraction burned and did not burn again on or before 24 years postfire for these subset grid cells lpj guess lmfirecf n 240 simulated mean live aboveground biomass 25 7 1 16 mg ha 1 was seven times greater than field estimations 11 years postfire 3 38 0 65 mg ha 1 and the range was twice the field estimate table 4 in postfire year 24 simulated mean live biomass 40 1 1 65 mg ha 1 was 58 greater than field estimations 25 4 2 5 mg ha 1 but with a similar range simulated leaf area index lai was more than two times greater than field estimations 11 and 24 years postfire table 4 the time series of aboveground carbon in live vegetation lpj guess lmfirecf simulated across ynp fig 10 shows a gradual recovery with declines corresponding with fire activity comparing biomass for mature lodgepole pine forests field based estimates 76 6 3 5 mg ha 1 were greater than simulation results for both model configurations table 4 interestingly the welch two sample t test indicated no evidence of a true difference in mean between simulated results and field estimates for lai in mature forests p 0 01 indicating potential model bias in carbon allocation to sapwood carbon pools over leaf carbon pools for a subset of grid cells lpj guess globfirm n 152 was a much poorer predictor with simulated mean live biomass 54 3 1 8 mg ha 1 sixteen times greater than field estimations 11 years postfire with almost four times the range table 4 in postfire year 24 lpj guess globfirm simulated biomass had declined but the mean remained 94 greater than the field estimated based on observations biomass should continue to increase for about 90 100 years post fire kashian et al 2013 lpj guess globfirm simulated mean lai was more than three times greater than field estimated 11 years postfire and because simulated lai declined was closer to field estimated 24 years postfire but still overestimated these subset grid cells burned in 1988 and did not reburn so declines in biomass and lai were due to other forms of mortality represented in the model e g longevity carbon limitation the low severity fires simulated by lpj guess globfirm resulted in carbon in vegetation fluctuations due to fire being minor perturbations fig 10 4 discussion 4 1 landscape biomass developments included in lpj guess lmfirecf improved model performance in simulating carbon in vegetation in ynp compared to lpj guess with the globfirm fire module fig 5 the parameterization of regional pfts blue dash dot line compared to global pfts purple dotted line also improved model performance in simulating carbon total carbon in vegetation in ynp was overestimated by 12 by lpj guess lmfirecf with regional pfts green dashed line compared to globbiomass estimations solid black line a 97 reduction in simulated biomass estimate error compared to lpj guess globfirm with global pfts this demonstrates that both the newly parameterized regional pfts and the process based model developments individually and combined resulted in more accurate representation of reality individual grid cell diagnostic plots appendix f figure f1 and f2 suggest the newly developed crown fire dynamics routine specifically was a critical process based model development when the crown fire module was disabled lmfire fires occurred at lower severity and more frequently from 1980 to 2016 than when using lmfirecf figure f1 using lmfire aboveground carbon in live vegetation continued to accumulate until the late 1990 s when it gradually declined figure f2 indicative of pft longevity based mortality in lpj guess for an individual grid cell in contrast using lmfirecf maximum aboveground carbon in live vegetation is about half of the maximum using lmfire during the timeseries fig f2 the remaining discrepancy in simulated carbon in vegetation compared to satellite based estimates is the long tailed distribution simulated by lpj guess lmfirecf fig 5 which is due to the overestimation of carbon in vegetation at higher elevation areas in ynp fig 6c in our simulations these areas with over estimated biomass corresponded with areas dominated by the spruce fir pft engelmann spruce and subalpine fir fig 7 adjusting parameters for the spruce fir pft could reduce its dominance and carbon accumulation improving modeled estimates of carbon in ynp yet much of this area extent in ynp is occupied by whitebark pine in the nps s cover type data fig 4 however whitebark pine communities have suffered extensive mortality in the yellowstone region due to mountain pine beetle dendroctonus ponderosae outbreaks and white pine blister rust cronartium ribicola infections shanahan et al 2016 much of the higher elevation areas labeled as non vegetated in the satellite based globbiomass dataset could be areas of whitebark pine die off even if the high elevation pines pft were simulated to occupy these areas mortality due to bark beetle outbreaks and white pine blister rust would not be captured disturbance agents other than fire are not explicitly modeled in lpj guess v 2 0 instead a generic patch disturbance can be enabled that randomly kills patches at a user defined time interval e g 100 years further model development is needed for these pest and pathogen disturbance dynamics to be represented for the gye although there were efforts to simulate impacts of european spruce bark beetle ips typographus outbreaks in sweden jönsson et al 2012 underestimated biomass in the western side and southwest corner of ynp correspond with areas simulated as dominated by the c3 cool grass pft the distribution of the cool grass pft strongly matches climatological mean distributions of mean temperature and annual precipitation these areas are lodgepole pine dominated in the nps s yellowstone cover type data implying that the bioclimatic limits of the lodgepole pine pft may need to be adjusted to allow more growth in these areas 4 2 dominant plant cover simulating regional pfts was critical to approaching satellite based estimates of distribution of biomass in the landscape global pfts were so generalized that one pft type boreal needleleaved evergreen see table 2 dominated the landscape this implies that for regional scale resolution dgvm simulations must include more pfts to be representative of the vegetation dynamics while lodgepole pine dominates ynp there still remain important vegetation patterns with elevation that are not captured with only one productive pft the newly parameterized pfts recreated distinct vegetation types with elevation lower elevations were dominated by grass sagebrush and douglas fir typical of the region the subalpine was dominated predominately by lodgepole pine with some co occurrence of douglas fir at lower elevations and engelmann spruce and subalpine fir cw con at higher elevations the simulated dominance of lodgepole pine in ynp on non rhyolitic soils was dependent on the fire module simulating high severity crown fires lodgepole pine is a relatively fast growing species and in the absence of fire more shade tolerant and slower growing species will grow in the understory and then dominate the subalpine overstory romme 1982 however on rhyolitic soils this transition of dominant species does not occur and lodgepole continues to dominate despain 1983 in the case of ynp on non rhyolitic soils these more shade tolerant species or climax species are engelmann spruce subalpine fir and at the higher elevations whitebark pine romme 1982 simulated as two pfts spruce fir and 5 needle pines the co occurrence and dominance of the spruce fir pft in higher elevations is due to lower simulated fire activity and the absence of inceptisol soils allowing them to outcompete lodgepole pine pft the fire module globfirm failed to capture high severity fires so the spruce fir pft dominated a larger portion of ynp compared to the lmfirecf module however the dominance of whitebark pine in the highest regions of the park was missing in the distribution of the high elevation 5 needle pines pft whitebark and limber pine regardless of the fire module applied these two distinct pine species were combined into one pft due to the lack of complete knowledge of their unique bioclimatic limits and other physiological characteristics weaver 2001 needed for parameterization the actual distributions of whitebark and limber pines sometimes overlap arno and hoff 1989 mccaughey and schmidt 1990 and in the field the species can only be distinguished by their female cones and less reliably by their male cones weaver 2001 the tendency of whitebark pine to grow at higher elevations than limber pine led to the adoption of an elevation threshold rule of thumb used for vegetation simulations clark et al 2017 even in paleoecological reconstructions of regional vegetation whitebark and limber pine distributions are indistinguishable because their pollen cannot be discriminated iglesias et al 2015 current research into distinguishing bioclimatic limits between whitebark and limber pine are underway hansen et al 2016 and could lead to separate parameterization in lpj guess lmfirecf simulations the importance of representing different vegetation zones became more apparent when we consider applying lpj guess lmfirecf to simulate potential changes under projected future climate scenarios in ynp there is concern over the potential contraction of forested vegetation types and expansion of sagebrush steppe grassland vegetation types as climate becomes more or less favorable to different vegetation types hansen and phillips 2015 piekielek et al 2016 westerling et al 2011 such a vegetation type conversion would drastically reduce the amount of terrestrial stored carbon in ynp kashian et al 2006 the ability of lpj guess to simulate multiple pfts with different age based cohorts within each grid cell allows it to simulate successional dynamics and vegetation zones hickler et al 2012 2004 furthermore since vegetation zones were emergent not prescribed through initialization they demonstrate prognostic capabilities of lpj guess lmfirecf 4 3 fire activity the model development represented here focused on capturing two key aspects of fire activity that are relevant to regional and global scale fire modeling burned area and fire severity lpj guess lmfirecf simulated large areas burned in 1988 1994 2000 2003 2008 2012 and 2016 these were all years of notable fire activity in the larger gye appendix f figure f1 these years correspond to years with low precipitation indicating the sensitivity of the lmfirecf fire module to precipitation also since lmfirecf does not simulate fire suppression we expected to overestimate area burned it may be that these simulated fire years could have become larger fire years in ynp in the absence of any fire suppression efforts or with increased lightning strikes the simulated area burned is the sum of area burned within each grid cell in lmfirecf the fraction burned of a grid cell is a function of fire rate of spread slope and wind speed pfeiffer et al 2013 fire rate of spread is dependent on the amount density and moisture of fuels and wind speed the representation of area burned as determined by modeled processes allows lmfirecf simulations to be responsive to changing conditions in comparison in globfirm the fraction burned of a grid cell is based on an empirical relationship with fire season length thonicke et al 2001 see fig 2 utilizing fixed empirical relationships does not allow for the model to predict fire behavior under novel conditions a more mechanistic fire module like lmfirecf can be more flexible to novel conditions however lmfirecf has one important limitation it does not model fire spread between grid cells and thereby cannot predict fire patterns or fire size since fire occurrence is emergent in lpj guess lmfirecf as opposed to prescribed there is no expectation that spatial patterns of fire would strongly correlate with observed fire patterns on the landscape moreover it would be difficult to simulate the influence of past burned areas on restricting future fire spread under extreme weather conditions conducive to large fires fire paths are most dictated by the current wind conditions bessie and johnson 1995 lmfirecf runs at a daily timestep so it does not capture the hourly fluctuations in weather conditions that drive the spread of large fires furthermore as simulations in lpj guess are run as one grid cell at a time in sequence as opposed to all grid cells at the same timestep in parallel the model framework inhibits simulating the spread of fire between grid cells without cell to cell fire spread it is not possible to realistically simulate observed fire scars or fire extents and to include the spatial interactions of fire pattern on future fire activity the greatest improvement to modeling fire behavior in ynp presented here was the simulation of high severity stand replacing crown fires from the development of crown fire dynamics in the lmfirecf fire module in prior versions of lmfire fire dynamics were based on the surface fire equations chaste et al 2018 pfeiffer et al 2013 lmfire is most often used within lpj which does not represent forest stand structure because it simulates average individuals of a pft population lpj guess simulates age based pft cohorts simulating forest stand structure enabling the distinction between surface and crown fires when coupled with a fire module that simulates both the original fire module in lpj guess v 2 0 globfirm greatly underestimated fire severity in ynp simulations similarly with the newly developed crown fire routine disabled lpj guess lmfire simulated low severity fires appendix f figures f1 and f2 unable to represent the high severity stand replacing crown fires characteristic of the region while in theory it would be possible to calibrate the parameters in these fire modules to simulate high severity fires in a given region it diminishes the ability to also simulate mixed and low severity fires effectively optimizing parameters in a surface fire module could compensate for the lack of crown fire dynamics mimicking observations i e equifinality tang and zhuang 2008 but would not be able to provide emergent results keane 2019 wilson and botkin 1990 by developing crown fire dynamics in lmfirecf high severity fires were emergent based on complex interactions between vegetation climate and fire dynamics lmfirecf is a fire module that is applicable to various fire regimes surface or crown fire dominated as opposed to being over calibrated to fit one fire regime another important component of simulating fire severity is estimating carbon fluxes to the atmosphere due to fire in globfirm live aboveground biomass that is killed by fire and dead vegetation that is burned is considered entirely combusted and added to the flux to the atmosphere that year smith et al 2001 thonicke et al 2001 both of these assumptions are incorrect even in stand replacing crown fires the fine live and dead fuels may be combusted 1 and 10 hour fuels but only a portion of larger live and dead fuels 100 and 1000 hour fuels are combusted and instead remain in the ecosystem as deadwood in lmfire and lmfirecf a fraction of live biomass killed is assumed to combust and the rest is transferred to litter chaste et al 2018 pfeiffer et al 2013 it follows that if globfirm is calibrated to simulate high severity fires it would overestimate carbon fluxes to the atmosphere unless the module is altered by lmfirecf partitioning live biomass killed by fire into combusted or added to litter it can estimate immediate combustion and delayed decomposition or combustion in future fires carbon fluxes to the atmosphere therefore the distinction in lmfire of carbon that is combusted and carbon that is transferred to litter ensures that carbon fluxes and pools are more accurately simulated in lpj guess 4 4 forest regeneration lpj guess lmfirecf simulated more rapid lodgepole pine forest regeneration in ynp than estimated from field measurements further model developments could be implemented to improve results and these are described below post fire lodgepole pine forest regeneration as measured by stem density varied with pre fire serotiny levels fire severity and fire patch size turner et al 1997 serotiny was missing in lpj guess lmfirecf so all grid cells were assumed to have the same availability of propagules independent of their fire history not including a critical restraint on lodgepole pine regeneration more generally pft establishment was simulated as stochastic with the number of saplings randomly drawn from a poisson distribution constrained by a maximum sapling establishment rate pft specific parameter est max saplings m2 year thereby variation in stem density between grid cells is based on bioclimatic limits to establishment and survival and random probability yet the est max parameter value for lodgepole pine was set to one tenth the mean stem density 24 years after fire also biomass was simulated as lower than field estimates for mature forests implying growth curves need to be adjusted so growth rates are reduced for young cohorts growth rates are controlled by carbon assimilation allocation and allometry equations and associated parameters so these are the areas to focus further model development and calibration 4 5 future implications climate change is expected to alter the fire and vegetation dynamics in the ynp annual air temperature is expected to increase 1 to 5 c in the gye by 2099 chang and hansen 2015 the climate conditions associated with large high severity fires are predicted to become common by mid to late century westerling et al 2011 warming and drying conditions that threaten seedling survival harvey et al 2016 in conjunction with short interval severe fires are projected to affect postfire subalpine forest regeneration hansen et al 2018 hansen and turner 2019 turner et al 2019 suitable climate space for the dominant alpine and subalpine tree species is projected to decline with expansion of suitable climate space for arid shrub and grasslands hansen and phillips 2015 all of these conditions combine to threaten the resiliency of subalpine forests in ynp and weaken carbon sinks turner et al 2019 process based models can help us address pressing questions about the impact of disturbance and climate interactions on forest regeneration and carbon storage in the future process based forest simulation models firebgcv2 clark et al 2017 keane et al 2011 and iland hansen and turner 2019 turner et al 2019 have been applied to the ynp to make inferences about future dynamics while both models predict decline of lodgepole pine dominated forest on the landscape firebgc predicts that forest cover will persist as douglas fir increases on the landscape clark et al 2017 and iland shows that douglas fir could also fail to regenerate under future climate scenarios hansen et al 2018 the complexity and high resolution of iland and firebgc limit the scale of simulations to individual stands up to watersheds the advantage of lpj guess lmfirecf is that by simulating age based cohorts instead of individual trees the computational efficiency makes it possible to run simulations at regional up to global scales the higher resolution forest simulation models appear to be better suited to address stand level questions around mechanisms of regeneration failure the strength of lpj guess lmfirecf is that it can be applied to project regional level forest cover and carbon storage while capturing landscape heterogeneity at the global scale projections of the terrestrial carbon sink rely on predictions of forest biogeography disturbance turnover and forest regrowth first predictions of future vegetation cover rely on projections of human land use and land cover change arneth et al 2017 friedlingstein et al 2019 poulter et al 2011 but also projections of future forest resiliency and species distributions walker et al 2019 white et al 2000 the use of regional pfts in dgvms as presented here can enhance the ability to model forest biogeography simulating current vegetation zones along elevation and climate gradients using regional pfts also improved simulated productivity with biomass estimates drastically closer to benchmarking data than by using global pfts secondly even small changes in fire regimes could have a strong influence on the forest carbon sink pugh et al 2019a the influence of disturbance turnover on long term carbon fluxes necessitates modeling of stand replacing crown fire regimes pugh et al 2019a lpj guess lmfirecf demonstrates the potential for modeling crown fire dynamics in dgvms and the fire module described here may serve as precedent for developments in other dgvms finally forest regrowth may be responsible for more than half of the terrestrial carbon sink pugh et al 2019a dgvms need to represent forest structure and successional dynamics to best estimate forest regrowth lpj guess has been demonstrated to simulate forest structure and successional dynamics in several regional studies hickler et al 2012 2004 smith et al 2001 but further development of lpj guess lmfirecf is needed to approximate estimates of biomass regrowth rates in regions with stand replacing crown fire regimes declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements thank you to robert keane monica turner dave roberts and andrew hansen for their helpful feedback special thanks to frances ambrose for field data collection computations were performed on the hyalite high performance computing system operated and supported by university information technology research cyberinfrastructure at montana state university thank you to the staff administrators pol llovet erik bryer and jonathan hilmer among others kde acknowledges funding from an nsf graduate research fellowship award no dge 1632134 and the montana institute on ecosystems with support from nsf iia 1443108 and eps 1101342 and a phd dissertation completion award from the graduate school montana state university the research was also supported in part by nsf grant gss 1461590 and grant no g15ap00073 from the united states geological survey bp acknowledges support from nasa s terrestrial ecology program the authors would like to thank the world wide lightning location network http wwlln net a collaboration among over 50 universities and institutions for providing the lightning location data used in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2020 109417 appendix supplementary materials image application 1 image application 2 image application 3 image application 4 image application 5 image application 6 image application 7 image application 8 
24706,north american forests are threatened by changes in climate and disturbance dynamics current efforts to model future vegetation and fire dynamics are challenged by the lack of mechanistic representation of ecological processes the spatial resolution to capture landscape level heterogeneity and the ability to model regional spatial extents to address these gaps a dynamic vegetation model was adapted for regional applications to the western forests of the u s here we present lpj guess lmfirecf a dynamic vegetation model that includes the ecological processes of a dynamic global vegetation model with cohort based forest demography lpj guess and a mechanistic fire module lmfire with a newly developed routine to simulate stand replacing crown fires cf the lmfirecf fire module calculates surface fire and canopy characteristics to determine if critical conditions are met for crown fire initiation and spread and if met calculates crown fire effects adapting the model to regional applications required parameterization of dominant regional plant functional types pfts and additional model adjustments related to the representation of fire simulations driven by historical climate data from 1980 to 2016 were made to compare the two different fire modules the original globfirm and newly created lmfirecf and two different plant functional type pft parameterizations the original global vs newly created regional pfts model performance was evaluated by comparing simulation outputs to field and satellite based estimates for landscape biomass distribution dominant plant cover fire activity and forest regeneration lpj guess lmfirecf accurately represented vegetational zones with elevation and climate gradients in yellowstone national park ynp total carbon in aboveground live vegetation within ynp simulated by lpj guess lmfirecf with the regional pfts overestimated satellite based estimates by 12 44 8 tgc vs 39 9 tgc respectively in comparison an lpj guess simulation using the older globfirm fire module and global pfts resulted in total carbon in aboveground live vegetation of 225 tg c for ynp five times the satellite based estimates lpj guess lmfirecf simulated burned area and fire severity approximated satellite based observations importantly lpj guess lmfirecf simulated the large stand replacing fires of 1988 in yellowstone as emergent results without model initialization of vegetation cover or fire history lpj guess lmfirecf simulated that 25 of the area of ynp burned in 1988 compared to 36 based on field and satellite based estimates however modeled postfire regrowth was more rapid than field based estimations with simulated mean biomass 24 years postfire 40 1 1 65 mg ha 1 58 greater than field estimations 25 4 2 5 mg ha 1 yet simulated mean biomass for mature forests 100 years old without a major disturbance was 24 less than field estimations 58 4 0 8 compared to 76 6 3 5 mg ha 1 in summary lpj guess lmfirecf effectively simulates regional crown fire dynamics and vegetation to more accurately model regional biomass plant biogeography and fire activity keywords fire modeling stand replacing crown fires plant biogeography biomass turnover ecosystem modeling yellowstone national park 1 introduction changes in regional climate and disturbance characteristics threaten the resiliency and function of forested ecosystems turner et al 2019 walker et al 2019 increasing the need for regional modeling of forest and disturbance dynamics u s doe 2018 forest resiliency is defined as the capacity of a forest to absorb change and disturbance and have structure and function persist holling 1973 with increases in fire season length area burned and frequency of large fires in the boreal and temperate forests of north america dennison et al 2014 kasischke and turetsky 2006 westerling 2016 2006 there is uncertainty about the resiliency of these forests and their carbon storage turner et al 2019 walker et al 2019 in particular the extent of high severity fires that kill most or all of the trees across entire stands referred to here as stand replacing fires is increasing flannigan et al 2009 stephens et al 2014 the ability to predict future forest resiliency is dependent on the development of process based simulation models that can represent complex interactions between forest demography disturbance climatic factors and increasing atmospheric carbon dioxide u s doe 2018 therefore appropriately modeling plant geography disturbance driven biomass turnover and forest regrowth under a changing climate is critical to predicting future changes to forests persistence and function at a regional scale current common approaches to regional forest modeling are empirical models individual based simulation models that are extended to landscape applications or dynamic global vegetation models dgvms applied regionally empirical modeling including correlation regression and principal component analyses can reveal important climatic and disturbance relationships affecting forest productivity emmett et al 2019 notaro et al 2019 potter 2019 yet empirical models are often constrained by the limited number of variables included by the modeler that may fail to capture complicated feedbacks between ecological processes also since empirical models are based on correlative relationships between variables from field or remotely sensed data they rely on statistical extrapolation to make inferences about conditions or areas not explicitly measured individual based forest landscape models offer high resolution e g 2 m to 30 m spatial resolution simulations of forest dynamics mladenoff 2004 seidl et al 2012 individual based simulation models trade their high spatial resolution for limited spatial extent making regional scale simulations computationally impractical in contrast dgvms were developed for understanding feedbacks between vegetation dynamics biogeography and biogeochemistry bachelet et al 2001 moorcroft et al 2001 sitch et al 2003 at the regional to global scale dgvms are process based simulation models that represent vegetation dynamics including plant establishment growth competition and mortality the formulations within process based models are often more closely based on principles of vegetation dynamics e g canopy scaling based on optimum leaf nitrogen distribution than on empirical relationships and therefore are less dependent on statistical extrapolation for novel conditions they also incorporate physical processes e g soil hydrology and physiological processes e g photosynthesis respiration and carbon allocation important for representing ecological function the benefit of adapting a dgvm to regional applications is the inclusion of these vegetation dynamics and ecological processes that interact to determine forest resiliency further development of fire dynamics and forest demography in dgvms is needed to more accurately represent these interactions pugh et al 2019a u s doe 2018 zhu et al 2016 to capture the ecosystem responses and interactions between vegetation climate and disturbance dgvms must include comprehensive and realistic fire modules keane et al 2015 the necessity of fire module development in dgvms led to the formation of the fire modeling intercomparison project and remains an area of active research hantson et al 2020 2016 li et al 2019 rabin et al 2017 while there have been many advances improvement is needed in the representation of forest fires that burn the crowns of trees or shrubs killing most or all of the overstory pugh et al 2019a 2019b hereafter referred to as stand replacing crown fires agee 1996 scott and reinhardt 2001 currently the prominent dgvms rely upon surface fire models and empirical fire behavior models which do not include the transition of a surface fire into the canopy limiting their ability to reproduce and predict stand replacing crown fires chaste et al 2018 gavin et al 2014 hantson et al 2016 lehsten et al 2016 li et al 2012 rabin et al 2017 advances are also needed in the modeling of forest demography within dynamic vegetation models dgvms typically simulate plant functional types pfts representing multiple plant species grouped by their physical phenological and phylogenetic characteristics process based simulation models are often initiated and constrained by field or remotely sensed data prescribing the distribution of pfts or forest productivity for example in the carnegie ames stanford approach ecosystem model simulations land cover type was prescribed from satellite imagery and moderate resolution imaging spectroradiometer modis enhanced vegetation index and airborne remotely sensed coarse woody debris were used as inputs to estimate net primary productivity potter et al 2011 while initializing and constraining process based models with observational data can lead to more realistic simulation results such approaches fail to demonstrate the emergent properties of the model and thereby reduce confidence in prognostic simulations calibrating model parameters for simulated pfts and represented processes is a necessary step to improve model performance without relying on initialization of plant cover type for example improving the representation of high latitude vegetation in another dgvm organizing carbon and hydrology in dynamic ecosystems required modification of photosynthesis parameters for each simulated pft adjustment of temperature limits to tree distributions and revised tree mortality calculations zhu et al 2015 these dgvm developments have not yet included crown fire simulations nor have they been applied to all dgvms the dynamic vegetation model lpj guess is well suited for regional application because it incorporates the physiological and biophysical processes of a dgvm while simulating cohorts of pfts to represent forest demography lpj guess was developed from the dgvm lpj lund potsdam jena sitch et al 2003 which represented pfts as average populations the general ecosystem simulator guess version represents vegetation as age based cohorts allowing the representation of stand structure and mixed plant composition simulating age based cohorts is an intermediate approach between individual based and population based models adding structural complexity while minimizing computational costs to enable regional to global scale applications fisher et al 2018 in lpj guess vegetation is simulated in independent patches for each grid cell with plant establishment growth and competition represented as mechanistic processes based on first principles and empirical relationships for detailed model description see smith et al 2001 previous regional applications of lpj guess explored vegetation dynamics and plant biogeography in forests of the northeastern u s hickler et al 2004 tang et al 2012 and subregions across europe hickler et al 2012 koca et al 2006 morales et al 2007 smith et al 2008 2001 however to adapt lpj guess for regional application to western u s forest biomes several modifications were needed minor model modifications included adjustments to pedotransfer functions and the inclusion of soil parent material data section 2 2 major developments included parameterization of regional pfts to represent the composition of western forests section 2 3 in turn the carbon allocation scheme was modified to produce more realistic tree heights section 2 4 and calculations of pft specific tree crown length were added section 2 5 most importantly the fire module lmfirecf was developed to simulate the stand replacing crown fires characteristic of many western forests sections 2 6 and 2 7 the development history of the dgvms and fire modules relevant to this study is shown in fig 1 globfirm the original fire module commonly used within lpj guess represents fire occurrence size and effects using semi empirical approaches for non ignition limited ecosystems thonicke et al 2001 fire occurrence is determined daily by whether air temperature fuel moisture content and abundance of aboveground litter are above minimum thresholds fire size is represented as the fraction of a grid cell burned as a function of fire season length based on an empirical relationship between length of fire season and area burned while this approach is intuitive the simplifications overlook potential feedbacks that could be represented by a more mechanistic approach for example fire occurrence does not consider the availability of an ignition source or fuel conditions that may be limiting in some ecosystems fire size does not consider any mechanisms for fire spread thereby all fires for a season will be of the same size regardless of fuel availability and fuel moisture fire effects are represented as the fraction of biomass burnt by fire is based on a pft specific fire resistance parameter all burned live and dead biomass is considered entirely combusted and added to the annual carbon flux to the atmosphere this representation of fire effects ignores any varying resistance to fire based on age class and fails to distinguish partially burned e g standing dead woody debris and combusted fuels emitted to the atmosphere to better represent fire occurrence size and effects in lpj guess simulations we integrated lmfire a mechanistic fire module originally developed for use in lpj pfeiffer et al 2013 lmfire simulates fire occurrence behavior and impact from a more mechanistic perspective by incorporating fire danger indices with fire spread modeling pfeiffer et al 2013 thonicke et al 2010 fire occurrence is based on calculated probabilities of natural ignitions and anthropogenic burning habits instead of having fire size based on an empirical relationship with fire season length as in globfirm lmfire represents fire behavior by calculating fire rate of spread based on weather and topography following rothermel s equations rothermel 1972 it also allows multi day burning and coalescence of fires within patches more realistically representing fire behavior however it must be noted that patches are simulated independently so fire does not spread between patches or grid cells tree mortality is a function of crown scorch and cambial damage based on the current tree height and bark thickness for each pft simulating stand replacing crown fires necessitated new developments to the lmfire module now termed lmfirecf to represent crown fire cf resulting in the ecosystem model variant lpj guess lmfirecf lmfirecf assesses if critical conditions are met for crown fire initiation and spread crown fire initiation is dependent on surface fire intensity resulting in a scorch height that reaches the canopy base height crown fire spread depends on average canopy bulk density and canopy foliar moisture content meeting critical thresholds the purpose of this paper is to introduce lpj guess lmfirecf designed for regional application for western forests of the u s and to evaluate the model s performance based on regional pfts and the new fire module simulations were run to compare two different fire modules globfirm and the newly developed lmfirecf to compare the different potential pfts simulations were run with the global pfts and the newly parameterized regional pfts lpj guess lmfirecf performance was evaluated for simulated 1 landscape biomass distribution 2 dominant plant cover distributions 3 fire activity and 4 postfire forest regeneration by comparing simulated results to field and satellite based metrics simulations of yellowstone national park ynp vegetation and wildfire dynamics are used here to demonstrate the utility of lpj guess lmfirecf for regional applications in u s western forests ynp serves as a model forested landscape to study the interactions of vegetation climate and disturbance dynamics because large stand replacing crown fires have played an important role in dictating vegetation patterns since the holocene whitlock et al 2003 the 1988 yellowstone fires burned about one third of the area of ynp serving as a natural experiment and validation for fire models 2 materials and methods 2 1 study area yellowstone national park is part of the u s rocky mountains fig 2 ynp extends 8983 km2 with a mean elevation of 2400 m and an elevation range from 1610 m to 3462 m long cold winters and cool summers characterize the climate of ynp boreal cool summer under the koppen geiger climate classifications kottek et al 2006 the northern half of the park experiences warmer mean annual temperatures and lower annual precipitation relative to the southern half fig 3 vegetation distribution patterns fig 4 correspond to elevation gradients and dominant soil type despain 1990 volcanic soils are the primary soils in ynp with relatively nutrient poor rhyolitic and andesitic soils i e inceptisols as the most dominant 47 rodman et al 1996 mollisols have a higher nutrient and organic matter content and cover 22 3 of the park the remainder of ynp is covered by combined inceptisols and mollisols 6 4 bedrock and some soil 8 6 and thermal soil 2 3 areas with inceptisols in the park tend to be dominated by lodgepole pine pinus contorta forests while areas with mollisols tend to be nonforested at lower elevations forests are comprised of douglas fir pseudotsuga menziesii rocky mountain juniper juniperus scopulorum and quaking aspen populus tremuloides and nonforested areas are comprised of grasslands and sagebrush artemisia spp steppe the subalpine areas are dominated by lodgepole pine with occurrences of subalpine fir abies lasiocarpa and engelmann spruce picea engelmannii in the understory or in the canopy in the absence of fire and limber pine pinus flexilis on calcium rich soils higher elevation forested areas are often dominated by whitebark pine pinus albicaulis overall lodgepole pine dominates more than 80 of the forested area within ynp wildfire often drives vegetation dynamics in ynp with large high severity fires that kill most of the trees and initiate secondary succession occurring in the subalpine forests every 150 300 years pre european settlement higuera et al 2011 romme 1982 fire severity is defined here by the loss of aboveground vegetation and soil organic matter keeley 2009 ryan and noste 1985 with a focus on tree mortality lower elevation douglas fir forests had low severity fires with a historical frequency of every 25 60 years littell 2002 with shorter 30 year mean fire frequency in shrub and grasslands barrett 1994 higher elevation whitebark pine forests had high to mixed severity fires with a mean fire return interval of over 350 years barrett 1994 a policy of complete fire suppression was in effect since the park was founded in 1872 up to 1972 romme and despain 1989 yet efforts were not effective until about 1945 when modern fire fighting technologies became available this relatively short period of effective fire suppression is unlikely to have greatly influenced fire activity romme and despain 1989 the fires of the late twentieth century are considered comparable to fires in the early 1700s except that the vast majority of the area burned in one year 1988 romme and despain 1989 the historic fires of 1988 burned about 36 percent of the park and left a landscape mosaic of unburned areas and burned areas with varying burn severity turner et al 1994 large fire years including 1988 were associated with extreme weather conditions characterized by hot and dry summers and strong winds bessie and johnson 1995 renkin and despain 1992 westerling et al 2011 2 2 model and simulation descriptions lpj guess v 2 0 was used for simulations in this study the physiological and biophysical processes are from lpj sitch et al 2003 and other model details are given by smith et al 2001 except for the model developments described in this paper lpj guess tracks characteristics of an average individual for each age based cohort of tree and shrub pfts making the assumption that individuals of the same age in the patch have the same structure tree structure is simplified to a crown cylinder with assumed uniform distribution of carbon each grass pft is represented as a single individual lpj guess simulates dynamic vegetation in patches for each grid cell patches share environmental input values of the grid cell termed replicate patches but run independently to represent the variability of stochastic processes establishment background mortality and fire the exception is that patches are assumed to share a common propagule pool i e spatial mass effect shmida and ellner 1984 initially propagules are assumed to be available for a pft if the climatic conditions are met in the grid cell after colonization establishment of new pft saplings is dependent on the reproductive output of all cohorts of that pft in the previous year the number of saplings established per unit area per year is drawn from a poisson distribution limited by the set maximum for that pft parameter est max saplings m2 year to represent stochastic establishment variables are output as averages for the patches within a grid cell a coupled photosynthesis and hydrology module calculates plant carbon uptake limited by photosynthetically active radiation and stomatal conductance haxeltine and prentice 1996 smith et al 2001 carbon uptake is also influenced by air temperature relative to temperature optimums and atmospheric carbon dioxide concentrations lpj guess simulates light competition between pft cohorts based on their crown structure and canopy position using the lambert beer law for attenuation of light through the canopy prentice and leemans 1990 pfts also compete for soil water with uptake dependent on root distribution in the soil smith et al 2001 soil hydrology is represented as a bucket model manabe 1969 with a two layer soil profile haxeltine and prentice 1996 water infiltrates the upper soil layer 0 0 5 m through precipitation minus interception or melting snow pack soil water content is depleted by plant evapotranspiration percolation below the lower soil layer 0 5 1 5 m surface evaporation or if the upper soil layer is saturated via surface runoff the calculation of water holding capacity and other soil parameters was modified for this study to allow for the use of continuous soil texture data instead of being limited to nine soil texture classes the pedotransfer functions follow cosby et al 1984 with volumetric water holding capacity equal to the field capacity minus the water holding capacity at wilting point appendix d fig d2 for this study yellowstone national park was simulated as a landscape of 14 431 1km2 grid cells using lpj guess cartesian area lpj guess simulations were run by repeatedly selecting a year randomly from detrended historical daymet climate data 1980 2016 and static carbon dioxide concentrations 1860 value 286 4 ppm for 1000 years called a spin up which is required for lpj guess to establish soil carbon pools and for simulated vegetation to reach theoretical equilibrium with average climate each grid cell was run with 10 replicate patches to represent differences in stand structure and pft composition resulting from stochastic processes simulations were then run for 157 years 1860 2016 with transient atmospheric carbon dioxide data for years 1860 2016 detrended climate data for years 1860 1989 and historical climate data for years 1980 2016 simulations were run to compare the different fire modules globfirm and lmfirecf and different pfts global pfts and the new regional pfts pfts are listed in table 2 and described in the following section while an lpj guess lmfire crown fire routine disabled simulation for the entire ynp was not included in this study diagnostic plots comparing lmfire and lmfirecf were included in appendix f 2 3 regional pft parameterization to better represent forest demography and crown fire dynamics we replaced the more general global tree pfts that are typically used in lpj guess with species specific parameterizations for the eight dominant tree species in ynp four species lodgepole pine pinus contorta douglas fir pseudotsuga menziesii quaking aspen populus tremuloides and rocky mountain juniper juniperus scopulorum were parameterized individually due to their physical and functional similarities and geographic range overlap mccaughey and schmidt 2001 1990 whitebark pine pinus albicaulis and limber pine pinus flexilis were represented as a single high elevation 5 needle pines species pair while engelmann spruce picea engelmannii and subalpine fir abies lasiocarpa were similarly represented as a single spruce fir species pair in addition to these six species species pairs hereafter pfts a sagebrush shrub artemisia spp and two grass pfts cool grass with c3 photosynthetic pathway and warm grass with c4 photosynthetic pathway were parameterized to represent non forest vegetation table 1 values sources and citations for pft parameters are included in appendix a tables a1 a4 the bioclimatic limits for establishment and survival were based on two standard deviations below or above the mean values calculated from daymet climate for the range of a pft based on the usda forest service s forest inventory and analysis fia presence data gillespie 1999 for pfts that represent two species the more extreme bioclimatic values were used to represent a range inclusive to both species unless otherwise noted in appendix a table a1 thereby the bioclimatic limits for engelmann spruce were used for the spruce fir pft and the limits for whitebark pine were used for the high elevation 5 needle pines pft plant trait fuel loading and post fire vegetation data were collected for this study spanning foothill to alpine vegetation zones across the greater yellowstone ecosystem gye to parameterize the lpj guess and the lmfire model appendix b calibration of pft parameter values included conducting a sensitivity analysis and comparing adjustments of groups of parameters e g shade tolerance parameters effect on species dominance in a grid cell with inceptisol soils lodgepole pine background and maximum establishment rates were increased these parameter adjustments served as a proxy for lodgepole pine s improved competition against other tree pfts in nutrient poor volcanic soils the production of fire adapted cones that open when exposed to high temperatures known as serotinous cones varies amongst populations of lodgepole pines schoennagel et al 2003 serotiny was not included in lpj guess lmfirecf so all grid cells were assumed to have the same availability of propagules independent of their fire history not including a critical restraint on lodgepole pine regeneration the maximum sapling establishment rate pft specific parameter est max saplings m2 year for lodgepole pine was set to one tenth the mean stem density 24 years after fire turner et al 2004 2 4 carbon allocation modification a key model development was required for more accurate representation of tree heights previously in lpj guess v 2 0 the ratio of tree leaf area to sapwood area was based on a pft specific constant or size independent allocation retained from lpj sitch et al 2003 see eq 1 for this study tree heights were constrained by modifying the allometric relationship between the ratio of tree leaf area and sapwood cross sectional area to include tree height as a covariate a size dependent leaf to sapwood area latosa ratio was implemented decreasing the latosa parameter value for each pft cohort noted by subscripts c pft by twenty units per meter increase in tree height h based on previous relationships used by mcdowell and zaehle mcdowell et al 2002 zaehle et al 2006 1 l a t o s a c p f t 20 h c p f t l a t o s a p f t where latosapft is the maximum parameter value for a pft in turn this adjusted latosa value was then used to constrain height ensuring that each unit of leaf area is supported by an appropriate amount of transport tissue following the pipe model shinozaki et al 1964a 1964b 2 5 pft crown length in lpj guess v 2 0 crown lengths tree height minus crown base height were previously set equal to tree height for all pfts and in lmfire crown length was calculated as 33 of the height for all trees neither of which are representative of tree growth in gye species instead in lmfirecf crown length varies with height based on pft specific parameters linear and quadratic regression equations were fit to field measurements of height vs crown length for gye tree species appendix b the linear slope m and intercept b values were then used to calculate variable crown length cl based on tree height h in lpj guess lmfirecf for each pft cohort c pft 2 c l c p f t m p f t h c p f t b p f t crown base height cbh which is used in the lmfirecf module was then calculated by subtracting the crown length from the tree height 3 c b h c p f t h c p f t c l c p f t 2 6 lmfire fire module modifications our model improvement included coding the lmfire routines to operate on age based pft cohorts in lpj guess as opposed to uniformly aged populations pfeiffer et al 2013 thonicke et al 2010 enabling representation of mixed aged stand dynamics tree height diameter and bark thickness are distinguished for each age based pft cohort so in lpj guess lmfirecf fire effects can vary between canopy layers partitioning of carbon pools was based on original lmfire spitfire values pfeiffer et al 2013 thonicke et al 2010 except it was necessary to increase 1 hour fuels from 4 5 reducing 1000 hr fuels by 0 225 for regional simulations the standard fuel size classes based on the diameter of live or dead woody fuels are 0 6 cm 1 hour timelag 0 6 2 5 cm 10 hour timelag 2 5 8 0 cm 100 hour timelag and 8 cm 1000 hour timelag baker 2009 since simulated vegetation is tracked as amorphous carbon pools e g leaf sapwood heartwood the fuel size classes are calculated as fractions of total live or dead carbon 4 725 7 5 21 and 66 775 for 1 10 100 and 1000 hr fuels respectively combustion of live biomass within a simulated patch is calculated for each pft cohort and is proportional to the fraction of area burned fraction of crown scorch live carbon and a combustion fraction constant by fuel size class combustion fraction constants for live biomass killed by fire were adjusted from 100 of 1 hour fuels and 5 of 10 hour fuels chaste et al 2018 pfeiffer et al 2013 to 90 80 50 and 0 for 1 10 100 and 1000 hour fuels respectively keane et al 2011 the remaining live vegetation killed by fire is transferred to litter fractions of dead biomass combusted depend on fuel moisture content relative to its moisture of extinction by fuel size class the moisture of extinction is the fraction of moisture content above which fuel stops burning moisture of extinction values were adjusted from 0 404 0 487 0 525 0 5440 for 1 10 100 and 1000 hour fuels respectively pfeiffer et al 2013 to 0 2 for all fuel size classes based on estimates that the moisture of extinction rarely exceeds 15 30 scott and burgan 2005 other parameter values for the lmfirecf fire module are shown in appendix c table c1 2 7 crown fire dynamics a newly developed routine to simulate stand replacing crown fires cf was incorporated with lmfire and in addition to the modifications described previously result in the fire module lmfirecf in lpj guess lmfirecf to determine if crown fires cf would occur in a patch surface fire and canopy characteristics were calculated to determine if critical conditions were met for crown fire initiation cfi and crown fire spread cfs 4 c f 1 i f c f i 1 a n d i f c f s 1 0 o t h e r w i s e crown fire initiation requires a critical surface fire intensity for the start of crowning such that the scorch height reaches the canopy base height van wagner 1993 1977 scorch height sh is calculated as 5 s h 0 148 i 2 3 where i is surface fire intensity kw m 1 alexander 1982 van wagner 1973 the constant modifier was set at 0 148 as found by van wagner 1973 an increase from the 0 094 assigned by pfeiffer et al 2013 since lpj guess represents age based cohorts of pfts canopy bulk density was calculated for each horizontal canopy layer that was 1 m thick 0 5 m to determine canopy base height canopy height and average canopy bulk density canopy bulk density is the sum of leaf and 1 hour live fuel mass per unit volume of canopy as this is considered the biomass that would burn quickly to sustain crown fire spread brown et al 1991 keane et al 2005 reinhardt et al 1997 scott and reinhardt 2001 in the following equations lowercase annotations are used for age cohort crown variables and uppercase annotations are used for forest canopy variables assuming crown bulk density cbd is uniform throughout the crown length cl for the average individual representing each pft cohort c pft leaf biomass and 1 hour live fuel biomass lf class were averaged for each crown layer l from crown base height cbh to tree height h 6 c b d l c p f t l c b h h l e a f b i o m a s s c p f t l f 1 c p f t c l c p f t then crown bulk density was totaled across the number of cohorts for each pft ncpft and summed across tree pfts to get canopy bulk density cbd at each layer in the canopy 7 c b d l p f t 1 6 c 1 n c p f t c b d l c p f t canopy base height was determined as the layer height at which the summed canopy bulk density for all pft cohorts was above the minimum threshold of 0 012 kg m 3 reinhardt et al 2006 canopy height was determined as the height at which the summed canopy bulk density for all pfts dropped below the minimum threshold reinhardt et al 2006 the canopy base height was then used as the critical scorch height for crown fire initiation thereby in following with van wagner s theory 1977 when surface fire intensity reaches the critical value for scorch height to exceed canopy base height cbh crown fire is considered initiated in lmfirecf 8 c f i 1 s h c b h 0 s h c b h two criteria defined critical conditions for crown fire spread average canopy bulk density above a minimum threshold 0 10 kg m 3 reinhardt et al 2006 and canopy foliar moisture content equal to or below a maximum threshold 80 these thresholds were calibrated to yield active crown fire in lmfirecf while being consistent with values in the literature the average canopy bulk density cbdavg was calculated by averaging each layer l from canopy base height cbh to canopy height ch 9 c b d a v g l c b h c h c b d l c h c b h and the average canopy bulk density is assumed to be uniform throughout its depth keane et al 1998 canopy foliar moisture content was assumed to be within the range of 50 150 scott and reinhardt 2001 van wagner 1977 the daily water stress water scalar ratio of effective water supply to demand for each tree pft was weighted by its foliar projective cover relative to total tree cover to calculate mean daily canopy foliar moisture content in lpj guess lmfirecf if both conditions are met average canopy bulk density cbdavg and canopy foliar moisture cfm are above their respective thresholds then crown fire will spread 10 cfs 1 if cb d avg 0 10 and cfm 0 80 0 othe rwise eq 4 can then be written as 11 cf 1 if sh cbh and if cb d avg 0 10 and cfm 0 80 0 othe rwise in lpj guess lmfirecf if the critical conditions were met for both crown fire initiation and crown fire spread then active crown fire is assumed to occur killing 100 of trees in the patch scott and reinhardt 2001 if these conditions are not met mortality can still occur due to crown kill for a given pft cohort proportional to the ratio of the tree height to the scorch height pfeiffer et al 2013 which may be considered a representation of passive crown fire importantly mortality due to crown kill operates on individual pft cohorts in lpj guess lmfirecf as opposed to the average individual pft population in a patch in lpj lmfire allowing taller pft cohorts to survive within a patch from passive crown fires 2 8 driver data daymet version 3 and topowx version 1 3 0 gridded daily climate data from 1980 to 2016 were used as input for lpj guess lmfirecf oyler et al 2015 thornton et al 2017 mean monthly instantaneous downward shortwave radiation for 24 h was calculated from daymet daily daylight average incident shortwave radiation total monthly precipitation was summed from daymet daily precipitation and the number of days in a month with precipitation summed to create monthly wet days mean monthly mean minimum and maximum air temperature was calculated from daily minimum and maximum air temperature for topowx1 3 0 the modern era retrospective analysis for research and applications version 2 merra 2 gelaro et al 2017 monthly eastward wind speed of lowest model layer and northward wind speed of lowest model layer were used to calculate the horizontal wind speed vector using the pythagorean theorem then resampled using r package raster from 50 km to 1km resolution hijmans 2019 mean monthly lightning strike values were calculated from world wide lightning location network data lay 2004 due to the increase in sensors through space and time the mean monthly value across the gye for 2010 2014 was used for all pixels annual global atmospheric carbon dioxide concentrations from 1860 to 2016 le quéré et al 2018 were used for all gye pixels the multilayer soil characteristic gridded data for the conterminous united states conus soil based on the usda state soil geographic database miller and white 1998 was infilled with harmonized world soil database v 1 2 for areas with missing data fischer et al 2008 to provide continuous soil data for the region since lpj guess version 2 0 used in this study does not include soil nutrient limitations a binary soil layer appendix d figure d1 indicating whether a grid cell had inceptisol soils or not was created from ynp soil type data rodman et al 1996 processing of model driver data was completed using climate data operators schulzweida 2019 nco netcdf operators zender 2014 and r packages raster hijmans 2019 rgdal bivand et al 2018 and ncdf4 pierce 2017 2 9 model evaluation datasets the performance of lpj guess lmfirecf was evaluated in four areas biomass dominant plant cover fire activity and forest regeneration estimates of carbon in aboveground live vegetation from the usda forest service s fia field measurements gillespie 1999 of 312 plots in ynp measured between 1999 and 2009 were used to benchmark simulated live aboveground carbon in vegetation estimates of aboveground live biomass for the year 2010 from the european space agency s satellite based globbiomass project santoro 2018 were used to benchmark simulated live carbon in vegetation for all of ynp globbiomass live aboveground biomass estimates were multiplied by 0 5 to approximate carbon in live vegetation assuming carbon content of biomass is about 50 penman et al 2003 it is important to note that globbiomass estimations of carbon in vegetation are only aboveground while values simulated in lpj guess include belowground carbon in the roots which could account for about 20 30 cairns et al 1997 litton et al 2003 santantonio et al 1977 to account for this difference simulated carbon in vegetation was multiplied by 0 8 to approximate carbon in aboveground live vegetation to compare to globbiomass and fia data simulated pft distributions and cover were compared to the national park service s yellowstone 1999 cover type data a geodatabase of habitat type and land cover layers created from aerial photography and field surveys despain 1990 simulated fire area burned fire severity and fire frequency were compared to monitoring trends in burned severity mtbs data from 1984 to 2016 mtbs data access fire level geospatial data 2017 and fire perimeter data acquired from the yellowstone national park spatial analysis center provided by alex zaideman field data of forest carbon storage and leaf area index in lodgepole pine dominated sites in ynp were used to evaluate simulated postfire recovery with sites that burned in the 1988 yellowstone fires sampled 11 and 24 years postfire to measure forest recovery turner et al 2017 2016 2004 and for mature lodgepole pine forests 100 years old from a 300 year chronosequence kashian et al 2013 2012 2 10 statistical analysis normalized mean square error nmse was used to quantify the range of spatial correlation between simulated total live aboveground carbon and globbiomass estimates because it is less sensitive to extreme values than using the standard deviation and it does not require uncertainty estimates which are unavailable for simulation results kelley et al 2013 nmse was calculated as 12 n m s e i y i x i 2 i y i x i 2 where y i is the modeled value in grid cell i x i is the corresponding value in the benchmarking dataset and x i is the mean value across all grid cells in the benchmarking dataset kelley et al 2013 a nmse value of zero indicates perfect agreement values 1 suggest the model s performance is worse than the null model and more generally smaller values denote better model performance welch two sample t tests were used to compare biomass and lai for regenerating and mature lodgepole pine forests between simulation results and field estimates rstudio team 2016 the welch s test was used because it does not assume equal variance to lessen the spatial autocorrelation in the simulated data 300 points were randomly selected from the 14 000 grid cells simulated and statistical tests were performed on this smaller sample dale and fortin 2002 3 results 3 1 landscape biomass fire model development in combination with the newly parameterized regional pfts greatly improved modeled live carbon in vegetation relative to lpj guess globfirm fig 5 field data from fia plots estimated mean total live aboveground carbon to be 50 8 2 04 mg c ha 1 range 0 201 mg c ha 1 with measurements limited to forested areas estimates from field data were higher than the satellite based globbiomass estimates and lpj guess lmfirecf simulation results which included non forested grid cells globbiomass a spatially continuous dataset was our best reference for total ynp biomass estimates with estimated mean live aboveground carbon in vegetation at 27 7 mg c ha 1 with a total of 39 9 tg c for the entire ynp for the year 2010 table 3 simulated carbon in vegetation using lpj guess lmfirecf with regional pfts for 2010 resulted in a mean live aboveground carbon in vegetation of 31 mg c ha 1 with a total of 44 8 tg c for ynp a 12 overestimation compared to globbiomass benchmark data in comparison simulated carbon in vegetation using lpj guess with the globfirm fire module and global pfts resulted in mean carbon in vegetation of 156 mg c ha 1 with a total of 225 tg c for ynp five times the globbiomass estimated carbon in vegetation for ynp the simulation using globfirm with the regional pfts resulted in mean carbon in vegetation of 61 7 mg c ha 1 with a total of 89 tg c for ynp double the globbiomass estimates in summary the newly developed lpj guess lmfirecf with regional pfts showed a 97 reduction in simulated biomass estimate error compared to lpj guess globfirm with global pfts mapped distributions of lpj guess lmfirecf simulated and globbiomass estimated carbon in vegetation are shown in fig 6 a b estimates of carbon in vegetation in the areas dominated by lodgepole pine are comparable between simulated and globbiomass estimates however carbon in vegetation at higher elevation areas in ynp simulated as dominated by spruce fir fig 7 are overestimated compared to globbiomass fig 6c the areas of underestimated biomass in the western and southern edges of ynp fig 6c correspond with areas that were simulated as grass dominated that are actually forested fig 7 but where uncertainty reported as standard error was higher for globbiomass fig 6d normalized mean square error nmse values indicate that model performance was greatly improved by using the lmfirecf fire module and regional pfts but all simulation results performed worse than the null model in estimating aboveground carbon table 3 3 2 dominant plant cover for the new carbon allocation scheme the size dependent leaf area to sapwood area ratio resulted in more reasonable tree heights linear relationships between tree height and crown length showed a strong correlation for all conifers r2 ranged from 0 51 to 0 97 and a moderate correlation for the deciduous pft r2 0 34 appendix b the linear regression equations better fit the data than the quadratic regression equations so the linear slope and intercept values were used to calculate variable crown length based on height in lpj guess lmfirecf by pft to evaluate the ability of lpj guess lmfirecf to simulate dominant plant foliar projective cover the fraction of modeled area covered when under full leaf cover was mapped for each pft across ynp simulated pft foliar projective cover fig 7 corresponded well with mapped national park service s nps yellowstone primary cover types from 1999 fig 4 the simulated distribution of lodgepole pine matched well with the nps distribution with lodgepole pine dominating the largest area of yellowstone simulated spruce fir engelmann spruce and subalpine fir occurrence in higher elevation regions of the park is accurate but extensive areas are actually dominated by whitebark pine in the observational data douglas fir quaking aspen and sagebrush cover was highest at lower elevations the nonforested areas in the northern region of the park lamar valley fig 4 were simulated as grass dominated lpj guess globfirm simulated pft foliar projective cover appendix e figure e1 resulted in spruce fir dominating the largest area of yellowstone in comparison to lpj guess lmfirecf results the range of area dominated by other pfts were contracted in the lpj guess globfirm simulation lodgepole pine douglas fir and cool grasses had greatly reduced cover using the globfirm fire module in the globfirm simulation spruce fir dominated areas that lmfirecf simulated as lodgepole pine or douglas fir dominant globfirm simulated lodgepole pine dominated areas that lmfirecf simulated as cool grasslands 3 3 fire activity lpj guess lmfirecf fire activity evaluated on total area burned and burn severity was greatly improved with our modifications total area burned from 1984 to 2016 from mtbs data shows that 1988 and 2016 were the largest fire years in the record fig 8 lpj guess lmfirecf simulated 1988 as the largest fire year and 2016 as a large fire year but also simulated notable area burned in 1994 2000 2003 2008 and 2012 lpj guess lmfirecf simulated that 25 of the area of ynp burned in 1988 mtbs and yellowstone national park spatial analysis center fire mapping show that about 36 of the area of ynp burned in the1988 yellowstone fires in terms of fire severity the predominant fire regime in ynp is characterized by stand replacing crown fires to compare the fire modules a time series of live and dead combusted carbon and unconsumed carbon of fire killed trees was plotted from 1984 to 2016 fig 9 while globfirm simulated 1988 as a fire year fire severity was low throughout the simulation period in contrast lmfirecf simulated 1988 more accurately as a high severity fire year with affected carbon in vegetation proportional to area burned although lmfirecf showed a large spike in affected carbon in vegetation in 1988 70 of the carbon remained in the system as litter the discrepancy in fire severity between lmfirecf and globfirm is shown in fig 10 with lmfirecf causing a 28 reduction in aboveground carbon in live vegetation across ynp from the 1988 fires compared to insignificant perturbations in carbon due to fire for globfirm throughout the simulation period fig 10 3 4 forest regeneration lodgepole pine stands regenerated quickly after the 1988 fires in ynp both in field measurements and lpj guess lmfirecf simulations table 4 from the simulated burned area in 1988 grid cells were subset that were previously dominated by lodgepole pine 50 foliar projective cover extensively burned 80 fraction burned and did not burn again on or before 24 years postfire for these subset grid cells lpj guess lmfirecf n 240 simulated mean live aboveground biomass 25 7 1 16 mg ha 1 was seven times greater than field estimations 11 years postfire 3 38 0 65 mg ha 1 and the range was twice the field estimate table 4 in postfire year 24 simulated mean live biomass 40 1 1 65 mg ha 1 was 58 greater than field estimations 25 4 2 5 mg ha 1 but with a similar range simulated leaf area index lai was more than two times greater than field estimations 11 and 24 years postfire table 4 the time series of aboveground carbon in live vegetation lpj guess lmfirecf simulated across ynp fig 10 shows a gradual recovery with declines corresponding with fire activity comparing biomass for mature lodgepole pine forests field based estimates 76 6 3 5 mg ha 1 were greater than simulation results for both model configurations table 4 interestingly the welch two sample t test indicated no evidence of a true difference in mean between simulated results and field estimates for lai in mature forests p 0 01 indicating potential model bias in carbon allocation to sapwood carbon pools over leaf carbon pools for a subset of grid cells lpj guess globfirm n 152 was a much poorer predictor with simulated mean live biomass 54 3 1 8 mg ha 1 sixteen times greater than field estimations 11 years postfire with almost four times the range table 4 in postfire year 24 lpj guess globfirm simulated biomass had declined but the mean remained 94 greater than the field estimated based on observations biomass should continue to increase for about 90 100 years post fire kashian et al 2013 lpj guess globfirm simulated mean lai was more than three times greater than field estimated 11 years postfire and because simulated lai declined was closer to field estimated 24 years postfire but still overestimated these subset grid cells burned in 1988 and did not reburn so declines in biomass and lai were due to other forms of mortality represented in the model e g longevity carbon limitation the low severity fires simulated by lpj guess globfirm resulted in carbon in vegetation fluctuations due to fire being minor perturbations fig 10 4 discussion 4 1 landscape biomass developments included in lpj guess lmfirecf improved model performance in simulating carbon in vegetation in ynp compared to lpj guess with the globfirm fire module fig 5 the parameterization of regional pfts blue dash dot line compared to global pfts purple dotted line also improved model performance in simulating carbon total carbon in vegetation in ynp was overestimated by 12 by lpj guess lmfirecf with regional pfts green dashed line compared to globbiomass estimations solid black line a 97 reduction in simulated biomass estimate error compared to lpj guess globfirm with global pfts this demonstrates that both the newly parameterized regional pfts and the process based model developments individually and combined resulted in more accurate representation of reality individual grid cell diagnostic plots appendix f figure f1 and f2 suggest the newly developed crown fire dynamics routine specifically was a critical process based model development when the crown fire module was disabled lmfire fires occurred at lower severity and more frequently from 1980 to 2016 than when using lmfirecf figure f1 using lmfire aboveground carbon in live vegetation continued to accumulate until the late 1990 s when it gradually declined figure f2 indicative of pft longevity based mortality in lpj guess for an individual grid cell in contrast using lmfirecf maximum aboveground carbon in live vegetation is about half of the maximum using lmfire during the timeseries fig f2 the remaining discrepancy in simulated carbon in vegetation compared to satellite based estimates is the long tailed distribution simulated by lpj guess lmfirecf fig 5 which is due to the overestimation of carbon in vegetation at higher elevation areas in ynp fig 6c in our simulations these areas with over estimated biomass corresponded with areas dominated by the spruce fir pft engelmann spruce and subalpine fir fig 7 adjusting parameters for the spruce fir pft could reduce its dominance and carbon accumulation improving modeled estimates of carbon in ynp yet much of this area extent in ynp is occupied by whitebark pine in the nps s cover type data fig 4 however whitebark pine communities have suffered extensive mortality in the yellowstone region due to mountain pine beetle dendroctonus ponderosae outbreaks and white pine blister rust cronartium ribicola infections shanahan et al 2016 much of the higher elevation areas labeled as non vegetated in the satellite based globbiomass dataset could be areas of whitebark pine die off even if the high elevation pines pft were simulated to occupy these areas mortality due to bark beetle outbreaks and white pine blister rust would not be captured disturbance agents other than fire are not explicitly modeled in lpj guess v 2 0 instead a generic patch disturbance can be enabled that randomly kills patches at a user defined time interval e g 100 years further model development is needed for these pest and pathogen disturbance dynamics to be represented for the gye although there were efforts to simulate impacts of european spruce bark beetle ips typographus outbreaks in sweden jönsson et al 2012 underestimated biomass in the western side and southwest corner of ynp correspond with areas simulated as dominated by the c3 cool grass pft the distribution of the cool grass pft strongly matches climatological mean distributions of mean temperature and annual precipitation these areas are lodgepole pine dominated in the nps s yellowstone cover type data implying that the bioclimatic limits of the lodgepole pine pft may need to be adjusted to allow more growth in these areas 4 2 dominant plant cover simulating regional pfts was critical to approaching satellite based estimates of distribution of biomass in the landscape global pfts were so generalized that one pft type boreal needleleaved evergreen see table 2 dominated the landscape this implies that for regional scale resolution dgvm simulations must include more pfts to be representative of the vegetation dynamics while lodgepole pine dominates ynp there still remain important vegetation patterns with elevation that are not captured with only one productive pft the newly parameterized pfts recreated distinct vegetation types with elevation lower elevations were dominated by grass sagebrush and douglas fir typical of the region the subalpine was dominated predominately by lodgepole pine with some co occurrence of douglas fir at lower elevations and engelmann spruce and subalpine fir cw con at higher elevations the simulated dominance of lodgepole pine in ynp on non rhyolitic soils was dependent on the fire module simulating high severity crown fires lodgepole pine is a relatively fast growing species and in the absence of fire more shade tolerant and slower growing species will grow in the understory and then dominate the subalpine overstory romme 1982 however on rhyolitic soils this transition of dominant species does not occur and lodgepole continues to dominate despain 1983 in the case of ynp on non rhyolitic soils these more shade tolerant species or climax species are engelmann spruce subalpine fir and at the higher elevations whitebark pine romme 1982 simulated as two pfts spruce fir and 5 needle pines the co occurrence and dominance of the spruce fir pft in higher elevations is due to lower simulated fire activity and the absence of inceptisol soils allowing them to outcompete lodgepole pine pft the fire module globfirm failed to capture high severity fires so the spruce fir pft dominated a larger portion of ynp compared to the lmfirecf module however the dominance of whitebark pine in the highest regions of the park was missing in the distribution of the high elevation 5 needle pines pft whitebark and limber pine regardless of the fire module applied these two distinct pine species were combined into one pft due to the lack of complete knowledge of their unique bioclimatic limits and other physiological characteristics weaver 2001 needed for parameterization the actual distributions of whitebark and limber pines sometimes overlap arno and hoff 1989 mccaughey and schmidt 1990 and in the field the species can only be distinguished by their female cones and less reliably by their male cones weaver 2001 the tendency of whitebark pine to grow at higher elevations than limber pine led to the adoption of an elevation threshold rule of thumb used for vegetation simulations clark et al 2017 even in paleoecological reconstructions of regional vegetation whitebark and limber pine distributions are indistinguishable because their pollen cannot be discriminated iglesias et al 2015 current research into distinguishing bioclimatic limits between whitebark and limber pine are underway hansen et al 2016 and could lead to separate parameterization in lpj guess lmfirecf simulations the importance of representing different vegetation zones became more apparent when we consider applying lpj guess lmfirecf to simulate potential changes under projected future climate scenarios in ynp there is concern over the potential contraction of forested vegetation types and expansion of sagebrush steppe grassland vegetation types as climate becomes more or less favorable to different vegetation types hansen and phillips 2015 piekielek et al 2016 westerling et al 2011 such a vegetation type conversion would drastically reduce the amount of terrestrial stored carbon in ynp kashian et al 2006 the ability of lpj guess to simulate multiple pfts with different age based cohorts within each grid cell allows it to simulate successional dynamics and vegetation zones hickler et al 2012 2004 furthermore since vegetation zones were emergent not prescribed through initialization they demonstrate prognostic capabilities of lpj guess lmfirecf 4 3 fire activity the model development represented here focused on capturing two key aspects of fire activity that are relevant to regional and global scale fire modeling burned area and fire severity lpj guess lmfirecf simulated large areas burned in 1988 1994 2000 2003 2008 2012 and 2016 these were all years of notable fire activity in the larger gye appendix f figure f1 these years correspond to years with low precipitation indicating the sensitivity of the lmfirecf fire module to precipitation also since lmfirecf does not simulate fire suppression we expected to overestimate area burned it may be that these simulated fire years could have become larger fire years in ynp in the absence of any fire suppression efforts or with increased lightning strikes the simulated area burned is the sum of area burned within each grid cell in lmfirecf the fraction burned of a grid cell is a function of fire rate of spread slope and wind speed pfeiffer et al 2013 fire rate of spread is dependent on the amount density and moisture of fuels and wind speed the representation of area burned as determined by modeled processes allows lmfirecf simulations to be responsive to changing conditions in comparison in globfirm the fraction burned of a grid cell is based on an empirical relationship with fire season length thonicke et al 2001 see fig 2 utilizing fixed empirical relationships does not allow for the model to predict fire behavior under novel conditions a more mechanistic fire module like lmfirecf can be more flexible to novel conditions however lmfirecf has one important limitation it does not model fire spread between grid cells and thereby cannot predict fire patterns or fire size since fire occurrence is emergent in lpj guess lmfirecf as opposed to prescribed there is no expectation that spatial patterns of fire would strongly correlate with observed fire patterns on the landscape moreover it would be difficult to simulate the influence of past burned areas on restricting future fire spread under extreme weather conditions conducive to large fires fire paths are most dictated by the current wind conditions bessie and johnson 1995 lmfirecf runs at a daily timestep so it does not capture the hourly fluctuations in weather conditions that drive the spread of large fires furthermore as simulations in lpj guess are run as one grid cell at a time in sequence as opposed to all grid cells at the same timestep in parallel the model framework inhibits simulating the spread of fire between grid cells without cell to cell fire spread it is not possible to realistically simulate observed fire scars or fire extents and to include the spatial interactions of fire pattern on future fire activity the greatest improvement to modeling fire behavior in ynp presented here was the simulation of high severity stand replacing crown fires from the development of crown fire dynamics in the lmfirecf fire module in prior versions of lmfire fire dynamics were based on the surface fire equations chaste et al 2018 pfeiffer et al 2013 lmfire is most often used within lpj which does not represent forest stand structure because it simulates average individuals of a pft population lpj guess simulates age based pft cohorts simulating forest stand structure enabling the distinction between surface and crown fires when coupled with a fire module that simulates both the original fire module in lpj guess v 2 0 globfirm greatly underestimated fire severity in ynp simulations similarly with the newly developed crown fire routine disabled lpj guess lmfire simulated low severity fires appendix f figures f1 and f2 unable to represent the high severity stand replacing crown fires characteristic of the region while in theory it would be possible to calibrate the parameters in these fire modules to simulate high severity fires in a given region it diminishes the ability to also simulate mixed and low severity fires effectively optimizing parameters in a surface fire module could compensate for the lack of crown fire dynamics mimicking observations i e equifinality tang and zhuang 2008 but would not be able to provide emergent results keane 2019 wilson and botkin 1990 by developing crown fire dynamics in lmfirecf high severity fires were emergent based on complex interactions between vegetation climate and fire dynamics lmfirecf is a fire module that is applicable to various fire regimes surface or crown fire dominated as opposed to being over calibrated to fit one fire regime another important component of simulating fire severity is estimating carbon fluxes to the atmosphere due to fire in globfirm live aboveground biomass that is killed by fire and dead vegetation that is burned is considered entirely combusted and added to the flux to the atmosphere that year smith et al 2001 thonicke et al 2001 both of these assumptions are incorrect even in stand replacing crown fires the fine live and dead fuels may be combusted 1 and 10 hour fuels but only a portion of larger live and dead fuels 100 and 1000 hour fuels are combusted and instead remain in the ecosystem as deadwood in lmfire and lmfirecf a fraction of live biomass killed is assumed to combust and the rest is transferred to litter chaste et al 2018 pfeiffer et al 2013 it follows that if globfirm is calibrated to simulate high severity fires it would overestimate carbon fluxes to the atmosphere unless the module is altered by lmfirecf partitioning live biomass killed by fire into combusted or added to litter it can estimate immediate combustion and delayed decomposition or combustion in future fires carbon fluxes to the atmosphere therefore the distinction in lmfire of carbon that is combusted and carbon that is transferred to litter ensures that carbon fluxes and pools are more accurately simulated in lpj guess 4 4 forest regeneration lpj guess lmfirecf simulated more rapid lodgepole pine forest regeneration in ynp than estimated from field measurements further model developments could be implemented to improve results and these are described below post fire lodgepole pine forest regeneration as measured by stem density varied with pre fire serotiny levels fire severity and fire patch size turner et al 1997 serotiny was missing in lpj guess lmfirecf so all grid cells were assumed to have the same availability of propagules independent of their fire history not including a critical restraint on lodgepole pine regeneration more generally pft establishment was simulated as stochastic with the number of saplings randomly drawn from a poisson distribution constrained by a maximum sapling establishment rate pft specific parameter est max saplings m2 year thereby variation in stem density between grid cells is based on bioclimatic limits to establishment and survival and random probability yet the est max parameter value for lodgepole pine was set to one tenth the mean stem density 24 years after fire also biomass was simulated as lower than field estimates for mature forests implying growth curves need to be adjusted so growth rates are reduced for young cohorts growth rates are controlled by carbon assimilation allocation and allometry equations and associated parameters so these are the areas to focus further model development and calibration 4 5 future implications climate change is expected to alter the fire and vegetation dynamics in the ynp annual air temperature is expected to increase 1 to 5 c in the gye by 2099 chang and hansen 2015 the climate conditions associated with large high severity fires are predicted to become common by mid to late century westerling et al 2011 warming and drying conditions that threaten seedling survival harvey et al 2016 in conjunction with short interval severe fires are projected to affect postfire subalpine forest regeneration hansen et al 2018 hansen and turner 2019 turner et al 2019 suitable climate space for the dominant alpine and subalpine tree species is projected to decline with expansion of suitable climate space for arid shrub and grasslands hansen and phillips 2015 all of these conditions combine to threaten the resiliency of subalpine forests in ynp and weaken carbon sinks turner et al 2019 process based models can help us address pressing questions about the impact of disturbance and climate interactions on forest regeneration and carbon storage in the future process based forest simulation models firebgcv2 clark et al 2017 keane et al 2011 and iland hansen and turner 2019 turner et al 2019 have been applied to the ynp to make inferences about future dynamics while both models predict decline of lodgepole pine dominated forest on the landscape firebgc predicts that forest cover will persist as douglas fir increases on the landscape clark et al 2017 and iland shows that douglas fir could also fail to regenerate under future climate scenarios hansen et al 2018 the complexity and high resolution of iland and firebgc limit the scale of simulations to individual stands up to watersheds the advantage of lpj guess lmfirecf is that by simulating age based cohorts instead of individual trees the computational efficiency makes it possible to run simulations at regional up to global scales the higher resolution forest simulation models appear to be better suited to address stand level questions around mechanisms of regeneration failure the strength of lpj guess lmfirecf is that it can be applied to project regional level forest cover and carbon storage while capturing landscape heterogeneity at the global scale projections of the terrestrial carbon sink rely on predictions of forest biogeography disturbance turnover and forest regrowth first predictions of future vegetation cover rely on projections of human land use and land cover change arneth et al 2017 friedlingstein et al 2019 poulter et al 2011 but also projections of future forest resiliency and species distributions walker et al 2019 white et al 2000 the use of regional pfts in dgvms as presented here can enhance the ability to model forest biogeography simulating current vegetation zones along elevation and climate gradients using regional pfts also improved simulated productivity with biomass estimates drastically closer to benchmarking data than by using global pfts secondly even small changes in fire regimes could have a strong influence on the forest carbon sink pugh et al 2019a the influence of disturbance turnover on long term carbon fluxes necessitates modeling of stand replacing crown fire regimes pugh et al 2019a lpj guess lmfirecf demonstrates the potential for modeling crown fire dynamics in dgvms and the fire module described here may serve as precedent for developments in other dgvms finally forest regrowth may be responsible for more than half of the terrestrial carbon sink pugh et al 2019a dgvms need to represent forest structure and successional dynamics to best estimate forest regrowth lpj guess has been demonstrated to simulate forest structure and successional dynamics in several regional studies hickler et al 2012 2004 smith et al 2001 but further development of lpj guess lmfirecf is needed to approximate estimates of biomass regrowth rates in regions with stand replacing crown fire regimes declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements thank you to robert keane monica turner dave roberts and andrew hansen for their helpful feedback special thanks to frances ambrose for field data collection computations were performed on the hyalite high performance computing system operated and supported by university information technology research cyberinfrastructure at montana state university thank you to the staff administrators pol llovet erik bryer and jonathan hilmer among others kde acknowledges funding from an nsf graduate research fellowship award no dge 1632134 and the montana institute on ecosystems with support from nsf iia 1443108 and eps 1101342 and a phd dissertation completion award from the graduate school montana state university the research was also supported in part by nsf grant gss 1461590 and grant no g15ap00073 from the united states geological survey bp acknowledges support from nasa s terrestrial ecology program the authors would like to thank the world wide lightning location network http wwlln net a collaboration among over 50 universities and institutions for providing the lightning location data used in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2020 109417 appendix supplementary materials image application 1 image application 2 image application 3 image application 4 image application 5 image application 6 image application 7 image application 8 
24707,the responses of plants to climate change are typically reflected in the changes in leaf and flowering phenology by exploiting the strength and simplicity of repeated digital photography and color indices a majority of the phenological studies have been successful at investigating leaf phenology while flowering phenology is rarely studied using the automatic capture and analysis of repeated photography in this study we trained and tested 5 different pretrained convolutional neural network cnn algorithms to detect flowering events from images of white colored flowering trees and analyzed the possible factors that can affect the performance of the models we collected images from the web and processed the images into a binary classification dataset in which a positive label indicated a tree in bloom we also installed time lapse cameras and captured images to validate the performances of the models in the real world regarding the cnn architectures the vgg16 resnet50 resnet101 mobilenet and nasnet models were adopted and the model weights were pretrained using the imagenet 1000 dataset after 20 epochs of training with 16 005 images all of the models were successfully trained reaching over 98 test accuracy and 4 models reached over 99 test accuracy all the models also showed accurate and stable performances in detecting flowering in time series datasets with a minor inconstancy at the beginning of the flowering stages overall the nasnet model showed the best performance in both the test dataset and the time series datasets a detailed analysis of the performance revealed that the models were especially prone to misclassify images with small relative flowering areas and were affected by the number of samples in the training dataset we concluded that the preprocessing of the images and the size of the training dataset are essential for the high performance of the models compared to the architecture of the individual models furthermore in addition to the need for a larger dataset the proper resolution is required to successfully detect flowering from repeated photography and most current phenological networks do not meet this condition we suggest that mid range photography combined with cnn algorithms can be a legitimate approach to properly accumulate and automatically process the data for studying flowering phenology graphical abstract image graphical abstract 1 introduction climate change is accelerating and the impact of climate change is increasing in various aspects including physiological processes the hydrological cycle biodiversity and the phenological rhythm since temperature affects biological processes at different levels climate change is altering the phenology of living organisms in both terrestrial and aquatic biomes on the earth parmesan 2006 archetti et al 2013 in case of plants the effects of climate change on the phenology are typically reflected by the lengthening of growing seasons menzel 2000 the advancement in the first flowering dates fitter and fitter 2002 changes in the floral abundance inouye 2008 and shortened floral longevity iler et al 2013 these responses of plants lead phenological data to be highly sensitive to climate change and to serve as an effective and successful indicator menzel et al 2006 richardson et al 2013 ipcc 2007 in this respect research in plant phenology has rapidly increased and observation techniques have been widely studied and applied tang et al 2016 in relation to monitoring plant phenology the following methods are most commonly used worldwide in situ observation and several remote sensing techniques including repeated digital photography e g richardson et al 2007 crimmins and crimmins 2008 satellite images e g zhang et al 2003 and unmanned aerial vehicles e g klosterman et al 2018 since in situ observation requires high labor costs and possesses difficulties in securing the spatiotemporal consistency of the data lori et al 2018 remote sensing is more commonly used and getting more popular especially repeated digital photography combined with online phenology networks have become one of the most common and powerful techniques to study phenology due to its better accuracy and consistency compared to other remote sensing techniques moore et al 2016 these networks which have been established in several nations since the 2000s are now proceeding to form a global network with high spatiotemporal resolution that has accumulated massive image data resulting in a growing demand for automatic analysis richardson et al 2009 wingate et al 2015 regarding the processing of the data current networks mainly focus on investigating leaf phenology using vegetation color indices and have been successful in recognizing the leaf out and leaf fall transition dates keenan et al 2014 moore et al 2016 however flowering phenology has not been extensively studied with respect to the automatic observation and analysis because the majority of phenological observations using repeated photography is conducted at the landscape scale alberton et al 2017 which is unsuitable for monitoring individual flowering events in addition the images of flowered trees tend to show complex reflectance patterns in addition to the leaves thus making current analysis techniques inapplicable more specifically flowers take up a much smaller proportion than leaves do in most flowered tree images in addition the pixels of flowers generally display high contrast and brightness values which lead to them being more subject to illumination changes liu et al 2016 and it being hard to distinguish flowers from the sky or reflected sunlight especially in the images captured from a distance however with the recent advancements in machine learning algorithms and computer hardware much progress has been made in image processing and pattern recognition among the numerous machine learning algorithms convolutional neural networks cnns are considered as the state of the art approach showing superior performance for solving various kinds of computer vision and pattern recognition problems krizhevsky et al 2012 mao et al 2016 inspired by the structure of the animal visual cortex cnns consist of several convolutional and pooling layers that enable the extraction of different levels of features from data hubel and wiesel 1968 khan et al 2019 here we briefly describe the major improvements proposed in cnn architectures cnns gained immense popularity especially after alexnet won the 2012 imagenet large scale visual recognition challenge ilsvrc 2012 since then several innovational improvements to cnn architectures have been proposed through consistent research improvements to cnn architectures began with the deepening of the network as in vggnet which consisted of more convolutional layers but had a smaller size simonyan and zisserman 2014 however when the network deepened low level layers could not be trained successfully due to the vanishing gradient problem to solve this problem skip connections between layers were introduced in resnet he et al 2016 meanwhile in an attempt to make a much lighter model even with a slight compromise in accuracy lightweight models including mobilenet were presented howard et al 2017 recently however several studies adopted machine learning to build the optimal architecture automatically rather than hand designing the structure as one of these nasnet utilizing a recurrent neural network rnn as the architect achieved state of the art performance at the time it was published zoph et al 2018 the innovations of cnns are still ongoing and the impacts of cnns are consistently broadening in various academic fields in the case of ecological studies cnns are utilized with multi scale observations from the leaf level to the regional scale including the following taxonomic identification using leaves lee et al 2015 hedjazi et al 2017 and flowers liu et al 2016 gogul and kumar 2017 wildlife detection in marine ecosystems maire et al 2015 gray et al 2019 and terrestrial ecosystems kellenberger et al 2018 and applications in forestry including vegetation cover mapping nijhawan et al 2017 processing lidar derived forest inventory data mizoguchi et al 2017 ayrey and hayes 2018 and change detection katarki et al 2019 however the potential of cnns has not yet been fully exploited in plant phenology only a few studies adopted cnns to analyze the phenological images obtained by repeated digital photography yalcin 2017 utilized a cnn to analyze the growth stages of several agricultural plants bayr and puschmann 2019 employed a cnn to locate woody vegetation in repeated photographs and perform change detection correia et al 2020 adopted a cnn object detector to quantitatively measure the budbursts of trees these studies however relied only on extracting leaf features from time series images but studies on detecting flowering events are rare in this study we developed and tested machine learning based detection algorithms that can detect flowering events from repeated photographs here to not compromise the accuracy to achieve general applicability we narrowed down our scope of the problem to deal with only white colored flowers compared to others white is the brightest but achromatic color that is most sensitively affected by illumination changes we tested cnns with different architectures and layer sizes to find the most suitable algorithm we fine tuned several pretrained cnns and compared the performances of the models we also utilized several time lapse flowering images captured at mid range to validate the performance under real world conditions and interpreted the misclassifications using cnn visualization techniques we expect that our proposed method will be useful to further research related to the detection of flowers with other chromatic colors moreover visualization and interpretation techniques adopted in this study will be a good example of unveiling the malfunctioning of cnns in ecological data with continuous distribution proper interpretation of data driven models e g neural networks could bridge the gap between conventional process based models possibly enabling ensembles of these models more specifically we aim to address the following research objectives 1 to develop a system that can detect flowering events 2 to investigate the performances of different cnn architectures and find the possible factors that can affect the models performances and 3 to validate the method using time series flowering data obtained from real field conditions 2 materials and methods 2 1 datasets 2 1 1 binary flowering classification dataset a binary classification dataset that consists of two classes was prepared for the training and testing of the models for the white flowered wf class images of trees and shrubs that particularly bloom white colored flowers regardless of species or age were downloaded in addition for the opposite class not flowered nf images with similar compositions but without flowers were downloaded the images of trees and shrubs without leaves were also included for better flexibility all the images were downloaded from various sources such as imagenet and google images deng et al 2009 the search terms were the scientific and general names of flowering trees easily found in the republic of korea including cornus kousa chionanthus retusus magnolia kobus prunus yedoensis and sorbus alnifolia the related images provided by google were also favorable showing a large number of flowered images with highly relative picture composition and flowered area meanwhile for nf class images of the above mentioned species that did not retain any flower petal were collected for validation every image sample in the training and test datasets was manually reviewed to ensure that the classification label was accurate then only images with a higher resolution than the input size of the classification algorithms as listed in table 2 were utilized after resizing to match the input size of each cnn architecture the number of images in both groups after preprocessing was 10 000 each fig 1 2 1 2 time series flowering dataset to validate the performances of the models with real field data time lapse images that contain progressive changes in their flowering were utilized for testing they were captured from phenology observation systems installed in the university forest phenology network of korea http phenocam tk from three observation systems located in seoul national university forests the republic of korea we selected four datasets that contain white blooming species flowering including cornus kousa magnolia denudata and prunus yedoensis fig 2 to establish the observation systems raspberry pi 3 model b and raspberry pi camera module v2 raspberry pi foundation cambridge uk units were utilized using the automation module in a raspberry pi the images were obtained every hour from 06 00 to 18 00 and only the images captured at noon were used during the highest solar elevation the greatest reflectance values from the subject could be captured by minimizing the shadows of other objects thus creating a clear contrast the species captured duration and location of each time series dataset are described in table 1 2 1 3 data augmentation before applying data augmentation the entire dataset was split into two subsets 80 16 005 images for training and 20 3 995 images for testing in the training dataset three different types of data augmentation methods were performed brightness adjustment horizontal flipping and random shifting in the case of a brightness adjustment the brightness was enhanced by multiplying each pixel value with a random factor ranging from 0 7 to 1 3 regarding random shifting the images were shifted in the horizontal random direction left or right up to one fifth of the image s width which was also randomly decided the empty regions generated on the opposite side of the shifting direction were filled with the reflected mirrored pixel values of the original image all augmentation methods were combined randomly when they were applied during the training process fig 3 2 2 model implementation 2 2 1 cnn architectures to build our models we selected 5 popular cnn architectures that achieved considerable accuracy including vgg 16 resnet50 resnet101 mobilenet and nasnet table 2 all cnn architectures which were pretrained using imagenet 1000 dataset were fine tuned using our training dataset all models were implemented using the following methods 1 truncate the final layer of each pretrained cnn architecture 2 insert a layer that flattens the output of the truncated cnn 3 apply dropout to the flattened layer and 4 insert a fully connected layer as the final output layer 2 2 2 training details when training cnn models with the entire dataset a small number of images which is referred to as the batch size were sequentially used to update the model parameters before these images were input into the model data augmentation processes were applied concurrently considering the sufficient number of training samples in each class we enabled all layers in the cnn architecture to be trainable the following hyper parameters were used by each model 10 5 as the learning rate adam as the optimizer kingma and ba 2014 a 0 5 dropout rate for the fully connected layer the softmax classifier as the final output layer and a relatively small batch size of 4 to improve efficiency and achieve better performance masters and luschi 2018 each model was trained until the maximum test accuracy did not increase for two consecutive epochs for a more detailed analysis of the performance in the training process each epoch was equally divided into 25 steps and the validation accuracy at each step was assessed 2 3 visualization of convolutional neural networks to localize the flowered region and interpret the misclassification results from cnn models gradient weighted class activation mapping grad cam was utilized to obtain the localization result of both the wf and nf classes selvaraju et al 2017 grad cam is one of the most frequently adopted methods that provides a heatmap highlighting the relevant region for predicting each class from a specific layer in a cnn we obtained the grad cam heatmap of the flowered and unflowered regions by following steps 1 calculate the gradient values using the classification model s output score of each class with respect to the feature maps of the target convolutional layer 2 apply global average pooling to each feature map 3 multiply the average values by each corresponding feature map and 4 combine them into a single heatmap and select only the positive values using the rectified linear unit function grad cam heatmaps were calculated from each model using the following cnn layers block5 conv3 in vgg 16 conv5 block3 out in resnet50 conv5 block3 out in resnet101 conv pw 13 in mobilenet and activation 260 in nasnet 2 4 hardware and software specifications all machine learning algorithms were trained and tested in a software environment using the windows 10 pro 64 bit operating system with python version 3 6 5 keras was utilized as the deep learning framework our hardware specifications are as follows an intel core i7 8700 k cpu 32gb of ram and an nvidia gtx 1080 ti gpu to test the inference time of each model in the onboard observation system a raspberry pi model 3 b was utilized all datasets model weights and python scripts can be found on github at github com treephysiologysnu whiteflowerdetection 3 results 3 1 quantitative comparison of the models performances 3 1 1 test dataset accuracy table 3 shows the comparison of the models performances on the test dataset for different kinds of cnn models all models were tested using each of the most accurate model weights obtained during the learning process fig 4 all cnn models were trained successfully reaching over 98 test accuracy and did not show any substantial difference among the listed cnn models the nasnet and mobilenet models showed the highest and lowest accuracies at 99 87 and 98 58 respectively in the benchmark performances of existing papers the model performances for imagenet datasets were recorded in the order of nasnet resnet 101 resnet 50 vgg 16 and mobilenet in this study the test dataset accuracy followed the same order interestingly all models equally exhibited more weakness to false negatives than false positives which means that they tended to misclassify more images of flowered trees as not flowered than vice versa the vgg 16 resnet50 and resnet101 models classified more than 20 cases as false negatives with relatively few false positives the nasnet model misclassified only 4 cases as false negatives with no false positives 3 1 2 learning curve fig 4 shows the learning curve of each cnn model in the training process the test accuracy at each validation step in the early stage of training is shown in fig 4 a in the figure each model showed different initial learning speeds until the 7th training step which corresponds with epoch 0 28 for instance the vgg 16 model showed the most rapid increase reaching over 90 accuracy in the second training step the nasnet and mobilenet models were trained slower than the vgg model reaching 90 accuracy at the 5th and 10th training steps respectively in case of the resnet models the accuracy declined in the first 4 training steps but it rapidly increased from the 4th step to 7th step and they reached 90 accuracy until the first epoch the vgg 16 model showed the fastest training and highest accuracy but was met by the nasnet and resnet models later on during the early stages of training all models were progressively improved and the accuracies were consistently overlapped between one another at the second epoch the nasnet and vgg 16 showed the highest accuracy and mobilenet showed the lowest accuracy the accuracy scores in the middle and late stages of training are shown in fig 4 b all models were improved along with the iteration of the training dataset but also showed temporary declines in their accuracies more specifically the nasnet model consistently recorded the highest accuracy during the training and showed less fluctuation in contrast the accuracy of the mobilenet model was improved by the greatest extent by 4 0 but it showed the lowest accuracy among the 5 models in the end vgg 16 and the two resnet models showed comparable final accuracies and showed relatively greater fluctuations than the other models all models reached their final accuracy from the 10th to 15th epochs except nasnet which had its best accuracy recorded at the 16th epoch 3 2 qualitative results 3 2 1 predicting and localizing real world flower images in this section we present qualitative inference results from the detection model tested on images with various picture compositions illuminations and flowering patterns the prediction score of each image is normalized and presented as a confidence probability using the softmax function along with the confidence probability grad cam visualization results for white flowered and unflowered regions are shown as overlapping heatmaps in figs 5 and 6 it is noteworthy that in this study all grad cam results were obtained using vgg 16 which provided the most intuitive and interpretable results owing to its simple architecture the differences in grad cam results between the models are presented in section 4 4 fig 5 shows the prediction and visualization results of the flowered images that the model classified properly in figs 5 a to d the confidence probability of each image from the model is presented and the model correctly predicts these with high confidence values in figs 5 e to h the grad cam localization results for the wf class are shown the results correspond with the exact boundaries of the actual flowering area in each image in fig 5 e the model properly localized the flowered region even when there are multiple flowering crowns in the image in case of fig 5 g the model discriminated the flowered region from the background that also has a white color in fig 5 h the prediction and localization results from the model were still accurate even in the image captured under relatively dark illumination figs 5 i to j show the localization results for the nf class here the model seems to capture and localize the green vegetation as nf instances since we utilized images of unflowered tree crowns for the training data of the nf class in fig 5 i the model localized the vegetation in the ground and a fraction of the mountain above the flowered crowns as an nf region in figs 5 k and l the model captured the vegetation in the background and also the stem of the flowered tree however in fig 5 j the model improperly localized the dark colored instances that are not actual vegetation fig 6 shows the prediction and localization results of the flowered images that the model misclassified in fig 6 a the model showed unstable performance when there were flowered trees along with unflowered trees in the visualization results of the wf and nf classes as shown in figs 6 d and g each heatmap region corresponds with a flowered crown and unflowered crown respectively which indicates that even though the model successfully captured the flowered region it was affected by the other unflowered vegetation and then predicted it as nf in the end in fig 6 b the illumination of the original image is greatly affected due to the backlight and the model could not conduct proper detection in figs 6 e and h the model partially localized the fraction of the flowered region but detected the majority of the flowered but shaded crown and trees as nf in fig 6 c the image contains sparsely patterned flowers in this case the model could not properly capture even a small fraction of the flowered region and instead recognized it as an nf region 3 2 3 performance on time series flowering dataset in this section we present the analysis results of the time series flowering dataset obtained from time lapse cameras installed in university forests in south korea fig 7 shows the results for the images that captured the progressive flowering of cornus kousa the prediction probability of each cnn model is shown as a gradient heatmap and the phenological timestamps are annotated as bbch growth stage keys as described in table 4 meier 1997 the cnn models detected flowering at 5 to 7 days after f10 but one or two days earlier or on the same date of f50 in the flower falling stages all models showed identical responses when predicting not flowered on the same date of fa90 more specifically each model showed different responses in the early stage of flowering from doy 136 to 139 the nasnet model first detected flowering on doy 136 with a high confidence value of 90 68 and then consistently showed an assertive response of 100 in this stage mobilenet also predicted flowering at doy 136 but showed a temporary misclassification on doy 137 resnet50 started to predict flowering from doy 137 with a slightly lower confidence of 77 85 the vgg16 and resnet101 models tended to respond later than the other models detecting flowering from doy 138 from doy 140 to 158 when there were not many changes in the extent of retaining flowers all models showed equally accurate and stable prediction results despite the changes in the weather conditions and illumination in the images on doy 159 the vgg16 resnet50 resnet101 and mobilenet models still predicted flowering with a confidence value of over 88 while nasnet alone classified it as nf with a low confidence of 51 42 then when the majority of the flower petals had fallen on the date of fa90 all models predicted it as nf we also analyzed other time series datasets as presented in the supplemental material figures s1 s2 and s3 likewise in the other time series datasets all models mostly showed identical responses in the middle and the end of the flowering stages while the prediction in the initial stages was not consistent between the models all models detected as flowering from the same date of f10 or one day after f10 two to 5 days before f50 and continued detecting as flowering until one to three days before fa90 4 discussions 4 1 a review on the models performances in this study we trained and tested 5 pretrained cnn algorithms to detect the flowering events of white colored flowers using the dataset consisting of two classes all models were successfully trained as shown in table 3 in the table all cnn models except mobilenet achieved over 99 accuracy while mobilenet also showed comparable accuracy of 98 58 the accuracies of the different model architectures did not show substantial differences and the results from the time series datasets revealed the high performance of all models on real world data figs 7 s1 s2 and s3 this successful performance could be achieved by utilizing a relatively large training dataset which consisted of 8000 training samples per class and by narrowing down the scope of the problem to binary classification in addition the minor differences in the accuracies indicated that the laborious tasks of manually designing the architecture and training the model from scratch are not necessary in comparison with other studies yalcin 2017 utilized a pretrained cnn architecture and a classical machine learning approach based on texture extraction with the naïve bayes classifier to classify 6 growth stages from the time series images of 6 different crops the classical approach showed accuracies from 71 43 to 82 41 on the test dataset while the cnn algorithm showed accuracies from 73 76 to 87 14 these relatively lower accuracies seemed to be derived from the insufficient amount of training data per class and with the indiscrete categorization of classes in detail despite the images being augmented by cropping only approximately 30 images per each growth stage and crop species were utilized for training this lack of original images before augmentation can be a weakness in securing the good performance of models it has also been reported by carpentier et al 2018 in an earlier study that showed that the amount of original data which was the bark images of individual trees had a greater impact on cnn models accuracy than the total amount of augmented data the power of a large training dataset was also verified by liu et al 2016 in a study that showed an improvement in the classification accuracy on the oxford 102 flower dataset by almost 4 from 80 66 in the previous approaches to 84 02 by using an additional dataset that consisted of a relatively larger number of samples per class meanwhile in this study only two classes showed high accuracies with discrete discrimination between them in real world applications if the total number of samples is fixed the number of samples in each class is traded off with the number of classes resulting in lower accuracies in classification into many classes varying performance of the same cnn model with different classification categories has also been reported by willi et al 2019 for identifying animal species with camera trap images with four different datasets using resnet18 in this study the same dataset was compared in two ways first the dataset was divided into two categories empty or nonempty binary classification second the dataset was divided into multiple categories of corresponding species from 9 to 51 multi label classification resnet showed varying performances across four datasets but showed better performance in binary classification than in multi label classification the accuracy of the multi label classification model ranged from 88 7 to 92 7 whereas that of the binary classification ranged from 91 2 to 98 0 however as the subdivision of classes can provide useful information to users an increment of classes compromising a slight decrease in the test accuracy can also be practical in fact according to abramovich and pensky 2019 increasing classes could improve accuracies in certain settings which is mainly attributed to the inclusion of weaker significant features that were previously not manifested in fewer classes furthermore in cases of high inter class similarities other accuracy metrics can be applied such as top 5 error error rate when the true label correct label is not among the models top 5 predictions as adopted in numerous studies with large classification categories krizhevsky et al 2017 4 2 weakness of the models on false negative cases as described in table 3 all cnn models classified 4 to 19 more cases as false negatives than false positives indicating that the models were more prone to misclassify flowered images as nf rather than vice versa to investigate this issue we aggregated all misclassified validation dataset samples from the 5 models and analyzed the possible reasons using grad cam in the false positive cases which models misclassified as wf the errors mostly originated in a specific region showing bright color mixed with leaves especially due to the reflection and permeation of sunlight through the branches or other white objects that are not trees in addition in the false negative cases a majority of the misclassifications originated due to more various reasons such as the following a small relative flowering area sparse flowering patterns that the model cannot recognize properly and mixed composition with the opposite nf class more specifically this is supported by the grad cam analysis results as presented in figs 8 and 9 in fig 8 which shows the grad cam results of the false positive cases the areas that confused the models are highlighted as an activation heatmap of the wf class the models seemed to especially recognize the areas where the rays of the sun were reflected and permeated through leaves or where there were other white colored objects such as snow and rocks which appeared as flowered regions here the model did not confuse the solid white region of the sky as a flowered region but only as a mixed area with leaves in case of false negatives as shown in fig 9 the models were mostly affected by the relatively small areas of flowered regions sparse flowering patterns captured at a relatively close range that models cannot recognize transformed colors of flowered regions due to illumination changes and an insufficient resolution to show the detailed information of the flowered region these misclassifications are mainly derived from the characteristics of the training dataset in which the majority of the image samples had concentrated flowering patterns with relatively large flowering areas these results can be improved by adding additional training samples with different flowering patterns 4 3 effects of the relative flowering area on model performance as mentioned in section 4 2 the models seemed to be confused by the flowering images with relatively small flowering areas to conduct additional analysis we captured and download several flowered images that have varying resolutions and compositions to inspect how the relative flowering area affects the performance of the models in fig 10 all the models detected the flowered tree images properly when the relative flowering area was over 20 but had misclassifications at the points where the relative area was below 20 comparing the models the nasnet model showed the most powerful performance by having only one misclassified case and a confident prediction probability overall on the other hand the other models had the same 4 misclassifications in the range from 5 14 to 17 93 of the relative flowering area more specifically vgg 16 and two resnet models showed misclassification in low flowered areas up to 17 93 while mobilenet showed an upper limit of 14 44 and nasnet showed a single misclassification of 8 58 these results accord with the previous results from the time series flowering dataset in the previous results in fig 7 all models began to classify the images as wf starting at the point when the relative flowering area was over 19 58 on doy 137 these numbers indicate that there is a certain lower limit of the relative flowering area where the misclassifications start to increase thus indicating that a proper resolution and composition of the observation target trees are critical for high performance 4 4 varying performances of models in time series datasets as described in section 3 2 3 predictions of the models varied in the early stages of flowering but were similar in the middle and late flowering stages fig 7 to investigate this issue we first reviewed each model s grad cam results calculated in the early middle and late stages fig 11 by reviewing the whole time series dataset we found that each model showed varying activation areas vgg 16 showed the largest area activated with high relevance resnet50 and 101 showed lesser area activated with similar location mobilenet showed lesser but bigger spots and contained seemingly unrelated areas and nasnet showed lesser and the smallest spots with high relevance it can thus be inferred that vgg 16 and the two resnet models utilize large areas in their classification whereas mobilenet and nasnet can recognize the locally existing features but mobilenet showed irrelevant regions these differences might explain the varying performances in the early stages of flowering nasnet showed the most robust and earliest response by successful activation of the localized flowered region in doy 136 and 137 the vgg 16 and resnet models showed delayed response as they required a larger area of flowers although they could still capture the relevant region in doy 136 and 137 resulting in proper classification of resnet50 in doy 137 and mobilenet was activated by irrelevant regions resulting in proper but falsely induced classification in doy 136 these results are in accordance with those from the previous section fig 10 where nasnet showed misclassification in the lowest upper limit of flowered area followed by mobilenet and vgg 16 with the two resnet models being equal meanwhile stable performance in the late stages of flowering doy 138 unlike in the early stages could be explained by the similarity of features with the samples in the training dataset most nf samples consisted of images that contained mature crowns which were also observed in the late flowering stages as the petals fell in contrast early stages is characterized by adolescent leaves or no leaves at all in some cases resulting in unstable performance with indecisive predictions this could be improved by adding more nf training samples with other conditions including crowns with adolescent leaves or with only branches 4 5 effect of number of training images on model accuracy as mentioned in previous sections we trained and tested all models with the training and test datasets that consisted of 16 005 and 3 995 images respectively using the training dataset all models were repeatedly trained for 20 epochs and the maximum test accuracy was recorded to investigate the effect of the number of training samples on the model accuracy we have evaluated all 5 cnn models performance after training them with different numbers of training samples fig 12 each training was repeated and monitored until they were trained with the same number of samples utilized in the training models with the full dataset which is 320 100 in total then the maximum test accuracy that the models reached during the training process was recorded in the figure the performances of the models were gradually improved as the number of training samples increased except for the temporary decline shown in the nasnet and two resnet models more specifically the nasnet model recorded with relatively low accuracy of 97 45 with 2500 samples but it later showed the most consistent and largest increase in accuracy with the exception of 12 500 samples the mobilenet model also showed a consistent improvement but recorded the lowest accuracy regardless of the number of training samples the resnet50 and resnet101 models showed the same temporary decline in accuracy at 5000 7500 and 10 000 training samples respectively and consistently improved after that the vgg16 model which also showed consistent improvement did not show substantial improvement after 10 000 samples in addition the resnet50 resnet101 and vgg16 models reached similar levels of accuracy with the full dataset at 15 000 samples and the mobilenet model reached the same level at 12 500 samples on the other hand the nasnet model was not trained sufficiently even with 15 000 samples indicating that the nasnet model had the highest complexity among the 5 models and it required the most samples to reach the maximum accuracy these results indicate that various numbers of training samples lead to higher accuracy than simply repeating training with a dataset consisting of a small number of images and the improvement due to the increase in the number of training samples was restricted by the models complexity 5 conclusion this study showed that cnn models could successfully detect flowering events with high accuracy all the models showed high performance in both testing and real world time series datasets without substantial differences between the various model architectures the performances of the models were rather subject to the gap between the training images and the input image and the size of the training dataset the gap which mainly originated from the small relative flowering area can be bridged by proper preprocessing methods such as setting the region of interest to contain only the relevant flowering region as the relative flowering area increases in turn in addition after training with different numbers of samples it was found that the model performance was substantially affected by the quantity thus suggesting the need for both high quality and high quantity datasets for successful applications furthermore the majority of the phenological networks are focused on assessing leaf phenology with time series images captured at the landscape scale the resolution of which cannot contain sufficient information of flowers therefore we propose mid range and high resolution repeated photography using cnn algorithms as the proper approach to capture the flowering phenology of individual trees funding this work was supported by the r d program for forest science technology project no 2014109c10 2020 aa01 provided by korea forest service korea forestry promotion institute daejeon 35208 republic of korea and the establishment of foundation for impact based forecasting in the mountainous area and development of customized service system of orographic weather data project no fe0500 2018 02 provided by national institute of forest science seoul 08826 republic of korea r d program for forest science technology project no 2020185d10 2122 aa02 provided by korea forest service korea forestry promotion institute credit authorship contribution statement tae kyung kim conceptualization visualization methodology software validation writing original draft writing review editing sukyung kim conceptualization methodology data curation myoungsoo won resources funding acquisition jong hwan lim resources funding acquisition sukhee yoon resources funding acquisition keunchang jang resources funding acquisition kye han lee resources yeong dae park resources hyun seok kim conceptualization writing review editing project administration supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we are thankful for the support of the mt chilbo seoul national university forest and seoul national university arboretum gwanak and suwon and their staffs supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2020 109419 appendix supplementary materials image application 1 
24707,the responses of plants to climate change are typically reflected in the changes in leaf and flowering phenology by exploiting the strength and simplicity of repeated digital photography and color indices a majority of the phenological studies have been successful at investigating leaf phenology while flowering phenology is rarely studied using the automatic capture and analysis of repeated photography in this study we trained and tested 5 different pretrained convolutional neural network cnn algorithms to detect flowering events from images of white colored flowering trees and analyzed the possible factors that can affect the performance of the models we collected images from the web and processed the images into a binary classification dataset in which a positive label indicated a tree in bloom we also installed time lapse cameras and captured images to validate the performances of the models in the real world regarding the cnn architectures the vgg16 resnet50 resnet101 mobilenet and nasnet models were adopted and the model weights were pretrained using the imagenet 1000 dataset after 20 epochs of training with 16 005 images all of the models were successfully trained reaching over 98 test accuracy and 4 models reached over 99 test accuracy all the models also showed accurate and stable performances in detecting flowering in time series datasets with a minor inconstancy at the beginning of the flowering stages overall the nasnet model showed the best performance in both the test dataset and the time series datasets a detailed analysis of the performance revealed that the models were especially prone to misclassify images with small relative flowering areas and were affected by the number of samples in the training dataset we concluded that the preprocessing of the images and the size of the training dataset are essential for the high performance of the models compared to the architecture of the individual models furthermore in addition to the need for a larger dataset the proper resolution is required to successfully detect flowering from repeated photography and most current phenological networks do not meet this condition we suggest that mid range photography combined with cnn algorithms can be a legitimate approach to properly accumulate and automatically process the data for studying flowering phenology graphical abstract image graphical abstract 1 introduction climate change is accelerating and the impact of climate change is increasing in various aspects including physiological processes the hydrological cycle biodiversity and the phenological rhythm since temperature affects biological processes at different levels climate change is altering the phenology of living organisms in both terrestrial and aquatic biomes on the earth parmesan 2006 archetti et al 2013 in case of plants the effects of climate change on the phenology are typically reflected by the lengthening of growing seasons menzel 2000 the advancement in the first flowering dates fitter and fitter 2002 changes in the floral abundance inouye 2008 and shortened floral longevity iler et al 2013 these responses of plants lead phenological data to be highly sensitive to climate change and to serve as an effective and successful indicator menzel et al 2006 richardson et al 2013 ipcc 2007 in this respect research in plant phenology has rapidly increased and observation techniques have been widely studied and applied tang et al 2016 in relation to monitoring plant phenology the following methods are most commonly used worldwide in situ observation and several remote sensing techniques including repeated digital photography e g richardson et al 2007 crimmins and crimmins 2008 satellite images e g zhang et al 2003 and unmanned aerial vehicles e g klosterman et al 2018 since in situ observation requires high labor costs and possesses difficulties in securing the spatiotemporal consistency of the data lori et al 2018 remote sensing is more commonly used and getting more popular especially repeated digital photography combined with online phenology networks have become one of the most common and powerful techniques to study phenology due to its better accuracy and consistency compared to other remote sensing techniques moore et al 2016 these networks which have been established in several nations since the 2000s are now proceeding to form a global network with high spatiotemporal resolution that has accumulated massive image data resulting in a growing demand for automatic analysis richardson et al 2009 wingate et al 2015 regarding the processing of the data current networks mainly focus on investigating leaf phenology using vegetation color indices and have been successful in recognizing the leaf out and leaf fall transition dates keenan et al 2014 moore et al 2016 however flowering phenology has not been extensively studied with respect to the automatic observation and analysis because the majority of phenological observations using repeated photography is conducted at the landscape scale alberton et al 2017 which is unsuitable for monitoring individual flowering events in addition the images of flowered trees tend to show complex reflectance patterns in addition to the leaves thus making current analysis techniques inapplicable more specifically flowers take up a much smaller proportion than leaves do in most flowered tree images in addition the pixels of flowers generally display high contrast and brightness values which lead to them being more subject to illumination changes liu et al 2016 and it being hard to distinguish flowers from the sky or reflected sunlight especially in the images captured from a distance however with the recent advancements in machine learning algorithms and computer hardware much progress has been made in image processing and pattern recognition among the numerous machine learning algorithms convolutional neural networks cnns are considered as the state of the art approach showing superior performance for solving various kinds of computer vision and pattern recognition problems krizhevsky et al 2012 mao et al 2016 inspired by the structure of the animal visual cortex cnns consist of several convolutional and pooling layers that enable the extraction of different levels of features from data hubel and wiesel 1968 khan et al 2019 here we briefly describe the major improvements proposed in cnn architectures cnns gained immense popularity especially after alexnet won the 2012 imagenet large scale visual recognition challenge ilsvrc 2012 since then several innovational improvements to cnn architectures have been proposed through consistent research improvements to cnn architectures began with the deepening of the network as in vggnet which consisted of more convolutional layers but had a smaller size simonyan and zisserman 2014 however when the network deepened low level layers could not be trained successfully due to the vanishing gradient problem to solve this problem skip connections between layers were introduced in resnet he et al 2016 meanwhile in an attempt to make a much lighter model even with a slight compromise in accuracy lightweight models including mobilenet were presented howard et al 2017 recently however several studies adopted machine learning to build the optimal architecture automatically rather than hand designing the structure as one of these nasnet utilizing a recurrent neural network rnn as the architect achieved state of the art performance at the time it was published zoph et al 2018 the innovations of cnns are still ongoing and the impacts of cnns are consistently broadening in various academic fields in the case of ecological studies cnns are utilized with multi scale observations from the leaf level to the regional scale including the following taxonomic identification using leaves lee et al 2015 hedjazi et al 2017 and flowers liu et al 2016 gogul and kumar 2017 wildlife detection in marine ecosystems maire et al 2015 gray et al 2019 and terrestrial ecosystems kellenberger et al 2018 and applications in forestry including vegetation cover mapping nijhawan et al 2017 processing lidar derived forest inventory data mizoguchi et al 2017 ayrey and hayes 2018 and change detection katarki et al 2019 however the potential of cnns has not yet been fully exploited in plant phenology only a few studies adopted cnns to analyze the phenological images obtained by repeated digital photography yalcin 2017 utilized a cnn to analyze the growth stages of several agricultural plants bayr and puschmann 2019 employed a cnn to locate woody vegetation in repeated photographs and perform change detection correia et al 2020 adopted a cnn object detector to quantitatively measure the budbursts of trees these studies however relied only on extracting leaf features from time series images but studies on detecting flowering events are rare in this study we developed and tested machine learning based detection algorithms that can detect flowering events from repeated photographs here to not compromise the accuracy to achieve general applicability we narrowed down our scope of the problem to deal with only white colored flowers compared to others white is the brightest but achromatic color that is most sensitively affected by illumination changes we tested cnns with different architectures and layer sizes to find the most suitable algorithm we fine tuned several pretrained cnns and compared the performances of the models we also utilized several time lapse flowering images captured at mid range to validate the performance under real world conditions and interpreted the misclassifications using cnn visualization techniques we expect that our proposed method will be useful to further research related to the detection of flowers with other chromatic colors moreover visualization and interpretation techniques adopted in this study will be a good example of unveiling the malfunctioning of cnns in ecological data with continuous distribution proper interpretation of data driven models e g neural networks could bridge the gap between conventional process based models possibly enabling ensembles of these models more specifically we aim to address the following research objectives 1 to develop a system that can detect flowering events 2 to investigate the performances of different cnn architectures and find the possible factors that can affect the models performances and 3 to validate the method using time series flowering data obtained from real field conditions 2 materials and methods 2 1 datasets 2 1 1 binary flowering classification dataset a binary classification dataset that consists of two classes was prepared for the training and testing of the models for the white flowered wf class images of trees and shrubs that particularly bloom white colored flowers regardless of species or age were downloaded in addition for the opposite class not flowered nf images with similar compositions but without flowers were downloaded the images of trees and shrubs without leaves were also included for better flexibility all the images were downloaded from various sources such as imagenet and google images deng et al 2009 the search terms were the scientific and general names of flowering trees easily found in the republic of korea including cornus kousa chionanthus retusus magnolia kobus prunus yedoensis and sorbus alnifolia the related images provided by google were also favorable showing a large number of flowered images with highly relative picture composition and flowered area meanwhile for nf class images of the above mentioned species that did not retain any flower petal were collected for validation every image sample in the training and test datasets was manually reviewed to ensure that the classification label was accurate then only images with a higher resolution than the input size of the classification algorithms as listed in table 2 were utilized after resizing to match the input size of each cnn architecture the number of images in both groups after preprocessing was 10 000 each fig 1 2 1 2 time series flowering dataset to validate the performances of the models with real field data time lapse images that contain progressive changes in their flowering were utilized for testing they were captured from phenology observation systems installed in the university forest phenology network of korea http phenocam tk from three observation systems located in seoul national university forests the republic of korea we selected four datasets that contain white blooming species flowering including cornus kousa magnolia denudata and prunus yedoensis fig 2 to establish the observation systems raspberry pi 3 model b and raspberry pi camera module v2 raspberry pi foundation cambridge uk units were utilized using the automation module in a raspberry pi the images were obtained every hour from 06 00 to 18 00 and only the images captured at noon were used during the highest solar elevation the greatest reflectance values from the subject could be captured by minimizing the shadows of other objects thus creating a clear contrast the species captured duration and location of each time series dataset are described in table 1 2 1 3 data augmentation before applying data augmentation the entire dataset was split into two subsets 80 16 005 images for training and 20 3 995 images for testing in the training dataset three different types of data augmentation methods were performed brightness adjustment horizontal flipping and random shifting in the case of a brightness adjustment the brightness was enhanced by multiplying each pixel value with a random factor ranging from 0 7 to 1 3 regarding random shifting the images were shifted in the horizontal random direction left or right up to one fifth of the image s width which was also randomly decided the empty regions generated on the opposite side of the shifting direction were filled with the reflected mirrored pixel values of the original image all augmentation methods were combined randomly when they were applied during the training process fig 3 2 2 model implementation 2 2 1 cnn architectures to build our models we selected 5 popular cnn architectures that achieved considerable accuracy including vgg 16 resnet50 resnet101 mobilenet and nasnet table 2 all cnn architectures which were pretrained using imagenet 1000 dataset were fine tuned using our training dataset all models were implemented using the following methods 1 truncate the final layer of each pretrained cnn architecture 2 insert a layer that flattens the output of the truncated cnn 3 apply dropout to the flattened layer and 4 insert a fully connected layer as the final output layer 2 2 2 training details when training cnn models with the entire dataset a small number of images which is referred to as the batch size were sequentially used to update the model parameters before these images were input into the model data augmentation processes were applied concurrently considering the sufficient number of training samples in each class we enabled all layers in the cnn architecture to be trainable the following hyper parameters were used by each model 10 5 as the learning rate adam as the optimizer kingma and ba 2014 a 0 5 dropout rate for the fully connected layer the softmax classifier as the final output layer and a relatively small batch size of 4 to improve efficiency and achieve better performance masters and luschi 2018 each model was trained until the maximum test accuracy did not increase for two consecutive epochs for a more detailed analysis of the performance in the training process each epoch was equally divided into 25 steps and the validation accuracy at each step was assessed 2 3 visualization of convolutional neural networks to localize the flowered region and interpret the misclassification results from cnn models gradient weighted class activation mapping grad cam was utilized to obtain the localization result of both the wf and nf classes selvaraju et al 2017 grad cam is one of the most frequently adopted methods that provides a heatmap highlighting the relevant region for predicting each class from a specific layer in a cnn we obtained the grad cam heatmap of the flowered and unflowered regions by following steps 1 calculate the gradient values using the classification model s output score of each class with respect to the feature maps of the target convolutional layer 2 apply global average pooling to each feature map 3 multiply the average values by each corresponding feature map and 4 combine them into a single heatmap and select only the positive values using the rectified linear unit function grad cam heatmaps were calculated from each model using the following cnn layers block5 conv3 in vgg 16 conv5 block3 out in resnet50 conv5 block3 out in resnet101 conv pw 13 in mobilenet and activation 260 in nasnet 2 4 hardware and software specifications all machine learning algorithms were trained and tested in a software environment using the windows 10 pro 64 bit operating system with python version 3 6 5 keras was utilized as the deep learning framework our hardware specifications are as follows an intel core i7 8700 k cpu 32gb of ram and an nvidia gtx 1080 ti gpu to test the inference time of each model in the onboard observation system a raspberry pi model 3 b was utilized all datasets model weights and python scripts can be found on github at github com treephysiologysnu whiteflowerdetection 3 results 3 1 quantitative comparison of the models performances 3 1 1 test dataset accuracy table 3 shows the comparison of the models performances on the test dataset for different kinds of cnn models all models were tested using each of the most accurate model weights obtained during the learning process fig 4 all cnn models were trained successfully reaching over 98 test accuracy and did not show any substantial difference among the listed cnn models the nasnet and mobilenet models showed the highest and lowest accuracies at 99 87 and 98 58 respectively in the benchmark performances of existing papers the model performances for imagenet datasets were recorded in the order of nasnet resnet 101 resnet 50 vgg 16 and mobilenet in this study the test dataset accuracy followed the same order interestingly all models equally exhibited more weakness to false negatives than false positives which means that they tended to misclassify more images of flowered trees as not flowered than vice versa the vgg 16 resnet50 and resnet101 models classified more than 20 cases as false negatives with relatively few false positives the nasnet model misclassified only 4 cases as false negatives with no false positives 3 1 2 learning curve fig 4 shows the learning curve of each cnn model in the training process the test accuracy at each validation step in the early stage of training is shown in fig 4 a in the figure each model showed different initial learning speeds until the 7th training step which corresponds with epoch 0 28 for instance the vgg 16 model showed the most rapid increase reaching over 90 accuracy in the second training step the nasnet and mobilenet models were trained slower than the vgg model reaching 90 accuracy at the 5th and 10th training steps respectively in case of the resnet models the accuracy declined in the first 4 training steps but it rapidly increased from the 4th step to 7th step and they reached 90 accuracy until the first epoch the vgg 16 model showed the fastest training and highest accuracy but was met by the nasnet and resnet models later on during the early stages of training all models were progressively improved and the accuracies were consistently overlapped between one another at the second epoch the nasnet and vgg 16 showed the highest accuracy and mobilenet showed the lowest accuracy the accuracy scores in the middle and late stages of training are shown in fig 4 b all models were improved along with the iteration of the training dataset but also showed temporary declines in their accuracies more specifically the nasnet model consistently recorded the highest accuracy during the training and showed less fluctuation in contrast the accuracy of the mobilenet model was improved by the greatest extent by 4 0 but it showed the lowest accuracy among the 5 models in the end vgg 16 and the two resnet models showed comparable final accuracies and showed relatively greater fluctuations than the other models all models reached their final accuracy from the 10th to 15th epochs except nasnet which had its best accuracy recorded at the 16th epoch 3 2 qualitative results 3 2 1 predicting and localizing real world flower images in this section we present qualitative inference results from the detection model tested on images with various picture compositions illuminations and flowering patterns the prediction score of each image is normalized and presented as a confidence probability using the softmax function along with the confidence probability grad cam visualization results for white flowered and unflowered regions are shown as overlapping heatmaps in figs 5 and 6 it is noteworthy that in this study all grad cam results were obtained using vgg 16 which provided the most intuitive and interpretable results owing to its simple architecture the differences in grad cam results between the models are presented in section 4 4 fig 5 shows the prediction and visualization results of the flowered images that the model classified properly in figs 5 a to d the confidence probability of each image from the model is presented and the model correctly predicts these with high confidence values in figs 5 e to h the grad cam localization results for the wf class are shown the results correspond with the exact boundaries of the actual flowering area in each image in fig 5 e the model properly localized the flowered region even when there are multiple flowering crowns in the image in case of fig 5 g the model discriminated the flowered region from the background that also has a white color in fig 5 h the prediction and localization results from the model were still accurate even in the image captured under relatively dark illumination figs 5 i to j show the localization results for the nf class here the model seems to capture and localize the green vegetation as nf instances since we utilized images of unflowered tree crowns for the training data of the nf class in fig 5 i the model localized the vegetation in the ground and a fraction of the mountain above the flowered crowns as an nf region in figs 5 k and l the model captured the vegetation in the background and also the stem of the flowered tree however in fig 5 j the model improperly localized the dark colored instances that are not actual vegetation fig 6 shows the prediction and localization results of the flowered images that the model misclassified in fig 6 a the model showed unstable performance when there were flowered trees along with unflowered trees in the visualization results of the wf and nf classes as shown in figs 6 d and g each heatmap region corresponds with a flowered crown and unflowered crown respectively which indicates that even though the model successfully captured the flowered region it was affected by the other unflowered vegetation and then predicted it as nf in the end in fig 6 b the illumination of the original image is greatly affected due to the backlight and the model could not conduct proper detection in figs 6 e and h the model partially localized the fraction of the flowered region but detected the majority of the flowered but shaded crown and trees as nf in fig 6 c the image contains sparsely patterned flowers in this case the model could not properly capture even a small fraction of the flowered region and instead recognized it as an nf region 3 2 3 performance on time series flowering dataset in this section we present the analysis results of the time series flowering dataset obtained from time lapse cameras installed in university forests in south korea fig 7 shows the results for the images that captured the progressive flowering of cornus kousa the prediction probability of each cnn model is shown as a gradient heatmap and the phenological timestamps are annotated as bbch growth stage keys as described in table 4 meier 1997 the cnn models detected flowering at 5 to 7 days after f10 but one or two days earlier or on the same date of f50 in the flower falling stages all models showed identical responses when predicting not flowered on the same date of fa90 more specifically each model showed different responses in the early stage of flowering from doy 136 to 139 the nasnet model first detected flowering on doy 136 with a high confidence value of 90 68 and then consistently showed an assertive response of 100 in this stage mobilenet also predicted flowering at doy 136 but showed a temporary misclassification on doy 137 resnet50 started to predict flowering from doy 137 with a slightly lower confidence of 77 85 the vgg16 and resnet101 models tended to respond later than the other models detecting flowering from doy 138 from doy 140 to 158 when there were not many changes in the extent of retaining flowers all models showed equally accurate and stable prediction results despite the changes in the weather conditions and illumination in the images on doy 159 the vgg16 resnet50 resnet101 and mobilenet models still predicted flowering with a confidence value of over 88 while nasnet alone classified it as nf with a low confidence of 51 42 then when the majority of the flower petals had fallen on the date of fa90 all models predicted it as nf we also analyzed other time series datasets as presented in the supplemental material figures s1 s2 and s3 likewise in the other time series datasets all models mostly showed identical responses in the middle and the end of the flowering stages while the prediction in the initial stages was not consistent between the models all models detected as flowering from the same date of f10 or one day after f10 two to 5 days before f50 and continued detecting as flowering until one to three days before fa90 4 discussions 4 1 a review on the models performances in this study we trained and tested 5 pretrained cnn algorithms to detect the flowering events of white colored flowers using the dataset consisting of two classes all models were successfully trained as shown in table 3 in the table all cnn models except mobilenet achieved over 99 accuracy while mobilenet also showed comparable accuracy of 98 58 the accuracies of the different model architectures did not show substantial differences and the results from the time series datasets revealed the high performance of all models on real world data figs 7 s1 s2 and s3 this successful performance could be achieved by utilizing a relatively large training dataset which consisted of 8000 training samples per class and by narrowing down the scope of the problem to binary classification in addition the minor differences in the accuracies indicated that the laborious tasks of manually designing the architecture and training the model from scratch are not necessary in comparison with other studies yalcin 2017 utilized a pretrained cnn architecture and a classical machine learning approach based on texture extraction with the naïve bayes classifier to classify 6 growth stages from the time series images of 6 different crops the classical approach showed accuracies from 71 43 to 82 41 on the test dataset while the cnn algorithm showed accuracies from 73 76 to 87 14 these relatively lower accuracies seemed to be derived from the insufficient amount of training data per class and with the indiscrete categorization of classes in detail despite the images being augmented by cropping only approximately 30 images per each growth stage and crop species were utilized for training this lack of original images before augmentation can be a weakness in securing the good performance of models it has also been reported by carpentier et al 2018 in an earlier study that showed that the amount of original data which was the bark images of individual trees had a greater impact on cnn models accuracy than the total amount of augmented data the power of a large training dataset was also verified by liu et al 2016 in a study that showed an improvement in the classification accuracy on the oxford 102 flower dataset by almost 4 from 80 66 in the previous approaches to 84 02 by using an additional dataset that consisted of a relatively larger number of samples per class meanwhile in this study only two classes showed high accuracies with discrete discrimination between them in real world applications if the total number of samples is fixed the number of samples in each class is traded off with the number of classes resulting in lower accuracies in classification into many classes varying performance of the same cnn model with different classification categories has also been reported by willi et al 2019 for identifying animal species with camera trap images with four different datasets using resnet18 in this study the same dataset was compared in two ways first the dataset was divided into two categories empty or nonempty binary classification second the dataset was divided into multiple categories of corresponding species from 9 to 51 multi label classification resnet showed varying performances across four datasets but showed better performance in binary classification than in multi label classification the accuracy of the multi label classification model ranged from 88 7 to 92 7 whereas that of the binary classification ranged from 91 2 to 98 0 however as the subdivision of classes can provide useful information to users an increment of classes compromising a slight decrease in the test accuracy can also be practical in fact according to abramovich and pensky 2019 increasing classes could improve accuracies in certain settings which is mainly attributed to the inclusion of weaker significant features that were previously not manifested in fewer classes furthermore in cases of high inter class similarities other accuracy metrics can be applied such as top 5 error error rate when the true label correct label is not among the models top 5 predictions as adopted in numerous studies with large classification categories krizhevsky et al 2017 4 2 weakness of the models on false negative cases as described in table 3 all cnn models classified 4 to 19 more cases as false negatives than false positives indicating that the models were more prone to misclassify flowered images as nf rather than vice versa to investigate this issue we aggregated all misclassified validation dataset samples from the 5 models and analyzed the possible reasons using grad cam in the false positive cases which models misclassified as wf the errors mostly originated in a specific region showing bright color mixed with leaves especially due to the reflection and permeation of sunlight through the branches or other white objects that are not trees in addition in the false negative cases a majority of the misclassifications originated due to more various reasons such as the following a small relative flowering area sparse flowering patterns that the model cannot recognize properly and mixed composition with the opposite nf class more specifically this is supported by the grad cam analysis results as presented in figs 8 and 9 in fig 8 which shows the grad cam results of the false positive cases the areas that confused the models are highlighted as an activation heatmap of the wf class the models seemed to especially recognize the areas where the rays of the sun were reflected and permeated through leaves or where there were other white colored objects such as snow and rocks which appeared as flowered regions here the model did not confuse the solid white region of the sky as a flowered region but only as a mixed area with leaves in case of false negatives as shown in fig 9 the models were mostly affected by the relatively small areas of flowered regions sparse flowering patterns captured at a relatively close range that models cannot recognize transformed colors of flowered regions due to illumination changes and an insufficient resolution to show the detailed information of the flowered region these misclassifications are mainly derived from the characteristics of the training dataset in which the majority of the image samples had concentrated flowering patterns with relatively large flowering areas these results can be improved by adding additional training samples with different flowering patterns 4 3 effects of the relative flowering area on model performance as mentioned in section 4 2 the models seemed to be confused by the flowering images with relatively small flowering areas to conduct additional analysis we captured and download several flowered images that have varying resolutions and compositions to inspect how the relative flowering area affects the performance of the models in fig 10 all the models detected the flowered tree images properly when the relative flowering area was over 20 but had misclassifications at the points where the relative area was below 20 comparing the models the nasnet model showed the most powerful performance by having only one misclassified case and a confident prediction probability overall on the other hand the other models had the same 4 misclassifications in the range from 5 14 to 17 93 of the relative flowering area more specifically vgg 16 and two resnet models showed misclassification in low flowered areas up to 17 93 while mobilenet showed an upper limit of 14 44 and nasnet showed a single misclassification of 8 58 these results accord with the previous results from the time series flowering dataset in the previous results in fig 7 all models began to classify the images as wf starting at the point when the relative flowering area was over 19 58 on doy 137 these numbers indicate that there is a certain lower limit of the relative flowering area where the misclassifications start to increase thus indicating that a proper resolution and composition of the observation target trees are critical for high performance 4 4 varying performances of models in time series datasets as described in section 3 2 3 predictions of the models varied in the early stages of flowering but were similar in the middle and late flowering stages fig 7 to investigate this issue we first reviewed each model s grad cam results calculated in the early middle and late stages fig 11 by reviewing the whole time series dataset we found that each model showed varying activation areas vgg 16 showed the largest area activated with high relevance resnet50 and 101 showed lesser area activated with similar location mobilenet showed lesser but bigger spots and contained seemingly unrelated areas and nasnet showed lesser and the smallest spots with high relevance it can thus be inferred that vgg 16 and the two resnet models utilize large areas in their classification whereas mobilenet and nasnet can recognize the locally existing features but mobilenet showed irrelevant regions these differences might explain the varying performances in the early stages of flowering nasnet showed the most robust and earliest response by successful activation of the localized flowered region in doy 136 and 137 the vgg 16 and resnet models showed delayed response as they required a larger area of flowers although they could still capture the relevant region in doy 136 and 137 resulting in proper classification of resnet50 in doy 137 and mobilenet was activated by irrelevant regions resulting in proper but falsely induced classification in doy 136 these results are in accordance with those from the previous section fig 10 where nasnet showed misclassification in the lowest upper limit of flowered area followed by mobilenet and vgg 16 with the two resnet models being equal meanwhile stable performance in the late stages of flowering doy 138 unlike in the early stages could be explained by the similarity of features with the samples in the training dataset most nf samples consisted of images that contained mature crowns which were also observed in the late flowering stages as the petals fell in contrast early stages is characterized by adolescent leaves or no leaves at all in some cases resulting in unstable performance with indecisive predictions this could be improved by adding more nf training samples with other conditions including crowns with adolescent leaves or with only branches 4 5 effect of number of training images on model accuracy as mentioned in previous sections we trained and tested all models with the training and test datasets that consisted of 16 005 and 3 995 images respectively using the training dataset all models were repeatedly trained for 20 epochs and the maximum test accuracy was recorded to investigate the effect of the number of training samples on the model accuracy we have evaluated all 5 cnn models performance after training them with different numbers of training samples fig 12 each training was repeated and monitored until they were trained with the same number of samples utilized in the training models with the full dataset which is 320 100 in total then the maximum test accuracy that the models reached during the training process was recorded in the figure the performances of the models were gradually improved as the number of training samples increased except for the temporary decline shown in the nasnet and two resnet models more specifically the nasnet model recorded with relatively low accuracy of 97 45 with 2500 samples but it later showed the most consistent and largest increase in accuracy with the exception of 12 500 samples the mobilenet model also showed a consistent improvement but recorded the lowest accuracy regardless of the number of training samples the resnet50 and resnet101 models showed the same temporary decline in accuracy at 5000 7500 and 10 000 training samples respectively and consistently improved after that the vgg16 model which also showed consistent improvement did not show substantial improvement after 10 000 samples in addition the resnet50 resnet101 and vgg16 models reached similar levels of accuracy with the full dataset at 15 000 samples and the mobilenet model reached the same level at 12 500 samples on the other hand the nasnet model was not trained sufficiently even with 15 000 samples indicating that the nasnet model had the highest complexity among the 5 models and it required the most samples to reach the maximum accuracy these results indicate that various numbers of training samples lead to higher accuracy than simply repeating training with a dataset consisting of a small number of images and the improvement due to the increase in the number of training samples was restricted by the models complexity 5 conclusion this study showed that cnn models could successfully detect flowering events with high accuracy all the models showed high performance in both testing and real world time series datasets without substantial differences between the various model architectures the performances of the models were rather subject to the gap between the training images and the input image and the size of the training dataset the gap which mainly originated from the small relative flowering area can be bridged by proper preprocessing methods such as setting the region of interest to contain only the relevant flowering region as the relative flowering area increases in turn in addition after training with different numbers of samples it was found that the model performance was substantially affected by the quantity thus suggesting the need for both high quality and high quantity datasets for successful applications furthermore the majority of the phenological networks are focused on assessing leaf phenology with time series images captured at the landscape scale the resolution of which cannot contain sufficient information of flowers therefore we propose mid range and high resolution repeated photography using cnn algorithms as the proper approach to capture the flowering phenology of individual trees funding this work was supported by the r d program for forest science technology project no 2014109c10 2020 aa01 provided by korea forest service korea forestry promotion institute daejeon 35208 republic of korea and the establishment of foundation for impact based forecasting in the mountainous area and development of customized service system of orographic weather data project no fe0500 2018 02 provided by national institute of forest science seoul 08826 republic of korea r d program for forest science technology project no 2020185d10 2122 aa02 provided by korea forest service korea forestry promotion institute credit authorship contribution statement tae kyung kim conceptualization visualization methodology software validation writing original draft writing review editing sukyung kim conceptualization methodology data curation myoungsoo won resources funding acquisition jong hwan lim resources funding acquisition sukhee yoon resources funding acquisition keunchang jang resources funding acquisition kye han lee resources yeong dae park resources hyun seok kim conceptualization writing review editing project administration supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we are thankful for the support of the mt chilbo seoul national university forest and seoul national university arboretum gwanak and suwon and their staffs supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2020 109419 appendix supplementary materials image application 1 
24708,this paper models the population dynamics and competition of two sympatric species of lizards liolaemus cyanogaster and liolaemus tenuis under the following scenarios a population dynamics of each species b competition to thermoregulate and c competition for the substrate the hypothesis was that a variant of the lotka volterra model is able to explain patterns related to population dynamics and competition between both species the data used come from a study carried out between spring and autumn of 2011 2012 and 2013 in the chilean locality of nonguén valley with these data we estimate the number of individuals of each species as well as their body temperature and the place where it was found on the ground or higher the model analyzed was appropriate for the three scenarios studied and it described a parsimonious coexistence between the species and a point of equilibrium that turned out to be an asymptotically stable attractor that is if these species start with a certain initial amount they will always reach an equitable final amount keywords competence lizards modelation population dynamics thermoregulation 1 introduction living beings can compete for food water space light the possibility of mating or other necessary resources to survive and reproduce townsend et al 2008 and references included therein competition exists when the resource is limited when resources are finite in nature and only some individuals in a population manage to get the necessary to survive it refers to intraspecific competition for these scarce resources if resources are limited the increase in population decreases the amount of resources for each individual and reduces the aptitude of the population in turn the growth rate of the population decreases with the increase of interspecific competition which negatively affects density on the other hand the fall in the growth rate with the increase in population follows models represented by logistic functions since survival growth and reproduction of individuals are the final effects of competition townsend et al 2008 in both theoretical and mathematical research and publications see in baigent 2010 díaz et al 2010 sternberg 2010 mendoza herrera 2012 jaramillo mejía et al 2013 samanta and gómez aíza 2014 and in the references they make there as in applications to situations of intra and interspecific competition of diverse nature see in lacitignola and tebaldi 2005 formoso 2010 ossa 2011 suris campos et al 2013 montaño and sánchez yáñez 2014 may cen 2016 used lotka volterra equations for predator prey competition however in the reviewed literature we did not find this model to describe the behavior of the species l cyanogaster and l tenuis climate change affected the temperature sinervo et al 2010 that is one of the most important factors in the biological adaptation atkinson 1994 and both the world diversity of reptiles and the abundance of their populations are declining gibbons et al 2000 sinervo et al 2010 thus the ability of a reptile to control its body temperature is vital according to kiernan 2014 ectotherms such as lizards achieve thermoregulation by actively using their behavioral adjustments behavioral and physiological of which the selection of micro habitats is more important than postural adjustments the structural properties of the habitat influences the capacities of some lizards to thermoregulate efficiently even many of the costs associated with thermoregulation can be reduced by inhabiting sectors with ambient temperatures similar to their preferred body temperature in the same way as most people acquire and maintain body temperature by going back and forth between different micro habitats where they can gain or lose heat the above reasons are those that allow proposing thermoregulation and micro habitat susceptible to competition thus the place where the lizards inhabit will facilitate or hinder their survival a suitable habitat for them is the valle de nonguén which is a central southern zone of chile where remnants of the deciduous forest of the city of concepción remain gajardo 1995 in this place it is possible the sighting of the snake tachymenis chilensis and the lizards liolaemus lemniscatus liolaemus chiliensis liolaemus cyanogaster and liolaemus tenuis demangel 2016 the objective of this study was to show other applications of a variant of the lotka volterra model and to present new models that predict the population dynamics of two sympatric populations of the genus liolaemus competing for thermoregulation and for substrate the hypothesis of this research was that the proposed models consistently predict the size of the population 2 material and methods 2 1 data collection the study was developed during september and may of 2011 2012 and 2013 in valle de nonguén according to the general classification of köppen this locality shows a climate of type csb warm temperate with winter rains and warm summer use of the micro habitat and daily activity we walked the sites continuously along a linear transect of approximately 6 m in width and 100 m in length during the entire day that lasts the daily activity of both species of lizards 09 00 a m at 7 00 p m we walked the transects in the same direction and place to reduce the probability of registering more than once the same individual of the population two types of substrates can be distinguished in the habitat of l tenuis and l cyanogaster a high system characterized by the presence of fallen trunks or tall trees above the 0 2 m of soil b low system consisting of areas in direct contact with the ground or between low scrub less than 0 20 m in height at the beginning of each walk we recorded the temperature of the substrate and the ambient temperature 0 3 m above the ground with a thermometer with a cu constant digi sense 8523 00 thermocouple for each observed lizard we recorded the body temperature species type of substrate high or low and its temperature tables 1 5 show the numerical data collected for each species in these tables rate is the estimated proportion of increase in what is registered in a measurement with respect to the previous one table 1 presents the number of individuals of the species l tenuis and table 2 those of the species l cyanogaster sighted on the ground and on fallen trunks or in low scrub at different times of the day tables 3 and 4 show the substrate temperatures where each individual of the respective species was observed where the heat index represents an estimate of the average temperature consumed by the observed individuals which is given by the following expression heat index substrate temperatures number of individuals observed table 5 presents an estimate of the monthly occupancy ratio of the highest system for each of the species which we use as an indicator of competition for the substrate 2 2 modeling assumptions and mathematical model proposed before analyzing the mathematical model we want to emphasize that we chose the lotka volterra model instead of other kind of models mainly because of its tractability the equations that govern it are linear in equilibrium which allows many species to be included in the model this results is very useful in the theory of ecological communities the equations thus compensate for a dynamic description of erratic accuracy with a manageable model of communities close to equilibrium schoener 1976 when analyzing systems of differential equations on r n of the form d dt x 1 x 1 f 1 x d dt x 2 x 2 f 2 x d dt x n x n f n x undoubtedly the one that stands out is the study of the standard lotka volterra models which are known as general n species lotka volterra systems where f i r n r n is smooth and it is such that f i x r i j 1 n c i j x j for some constant r i r i 1 n x x 1 x n and constant real matrix c c i j next we will analyze the lotka volterra system that models the dynamics of two interacting populations 2 2 1 predator prey let n t denote the prey population and p t the predator population at time t 0 the following are the simplest assumptions of the predator prey model 1 in the absence of predators p 0 the per capita prey growth rate 1 n d dt n of the prey population n was constant but fell linearly as a function of predator population p when predation was present p 0 2 if there is a predator presence the per capita growth rate will have a reduction in an amount proportional to the predator population at each moment 3 in the absence of prey n 0 the per capita growth rate of the predator 1 p d dt p was constant and negative and increased linearly with the prey population n when prey was present n 0 4 the contribution of prey to the relative growth rate of predators is proportional to the number of preys at that time based on the previous hypotheses the lotka volterra model results as the following system of differential equations 1 n d dt n c 11 c 12 p 1 p d dt p c 21 n c 22 where the parameters c 11 c 12 c 21 c 22 0 are constants ecological considerations according to baigent 2010 there are several points of criticism worth noting for the volterra lotka model changing the birth and death rates does nothing but change the period of the oscillation i e no population can dominate and there is no possibility of either population being driven to extinction for certain ecological conditions fitness of species etc one would expect one species to win regardless of initial conditions in addition the system is structurally unstable any model is an approximation of a real system for a model to be successful one would expect that typically a small modification to the model would produce similar results i e would give a topologically unchanged phase space picture 2 2 2 competition baigent 2010 reminds us that for a single population of density n the simplest density dependent per capita growth rate is linear and gives rise to the logistic equation 1 d dt n ρ n 1 n k the density k is the maximum population density that the environment can carry and is called the environmental carrying capacity the quadratic term in 1 represents competition between members of the same population for resources i e intraspecific competition for a model of competition within an environment supporting two species there are two types of competition intraspecific and interspecific the latter being competition between the two different species to build a simple model for such competition we start with two independent logistic models for the population densities n 1 n 2 and add an extra term in each to model the interspecific competition 2 d dt n 1 ρ 1 n 1 1 n 1 k 1 c 1 n 2 d dt n 2 ρ 2 n 2 1 n 2 k 2 c 2 n 1 baigent 2010 points out that in the absence of interspecific competition each species grows to its respective carrying capacity the relative sizes of c 1 c 2 0 determine the competitiveness of each species baigent 2010 calls system 2 a competitive two species logistic model observing that the species l tenuis and l cyanogarster cohabit in the same micro habitat and although they compete for space and food they coexist harmoniously without predating we conclude that their population dynamics could be modeled by the system 2 that allows cooperative coexistence between species written in terms that are more interpretable this model is governed by the system of differential equations 3 baigent 2010 díaz et al 2010 mendoza herrera 2012 jaramillo mejía et al 2013 samanta and gómez aíza 2014 on the other hand even when lizards live in a three dimensional space as a first approach to model them we use a one dimensional idealized system of differential equations because in everything we investigate we do not find spatial models in more than one dimension and this would be a future work by perform 3 d dt n t r t n t k t n t α t c n c k t d dt n c r c n c k c n c α c t n t k c where the subscripts t and c correspond to the species l tenuis and l cyanogaster respectively in addition n i is the size number of individuals of species i k i is the load capacity maximum number of individuals that can live in a stable way in the population of species i where i t c represent the species under study in turn α t c is the coefficient of competition per capita on the species t of the species c number of individuals of the species c that is equivalent to one of the species t and α c t is the coefficient of competition per capita on the species c of species t number of individuals of species t that equals one of species c on the other hand r i i t c are rates whose definition will depend on the situation to be modeled 2 3 parameters selection in the model from tables 1 and 2 it is obtained that the maximum number of individuals of each species are 40 and 37 respectively therefore the load capacities are given by 4 k t 40 and k c 37 it follows that the species remain in a stable equilibrium that is both species exert a lesser competitive effect on the other species than on themselves deducting that k t k c α t c and k c k t α c t from of these last two inequalities and the load capacity values given in 4 it is concluded that 5 α t c 40 37 1 081 and α c t 37 40 0 925 3 results depending on what is measured with the rate r i we have the three modeled situations described in the following subsections 3 1 population dynamics of each species in this case r i measures the intrinsic rate of increase of species i for i t c considering the load capacities given in 4 and the rates of the respective species recorded in tables 1 and 2 we obtain that r t 0 675 and r c 0 514 with these rates and according to what is established in 5 the most appropriate per capita competencies are α t c 0 900 and α c t 0 800 because this guarantees that the equilibrium point stays in the first quadrant since a different case would be meaningless real biological when replacing these values in the lotka volterra model and using matlab to solve it we obtain the vector field presented in fig 1 the concept of vector field phase diagram is explained in the subsection interpretation of results the real solution that we obtained was n t 23 7147 and n c 17 8261 3 2 competition to thermoregulate for this situation r i is the rate of increase by heat of species i for i t c taking into account the values given in 4 and the maximum rates highlighted with of the respective species recorded in tables 3 and 4 we obtain that r t 0 574 and r c 0 426 with these rates and the restrictions given in relation 5 it is found that α t c 0 880 and α c t 0 780 are the most appropriate coefficients for this type of competition because they guarantee a biologically stable equilibrium point substituting these parameters in the model 3 and solving the vector field given in fig 2 is achieved the real solution that we obtained was n t 23 7554 and n c 18 3319 3 3 competition by substrate let now r i the rate of increase by the occupation of the high system of species i for i t c with the values given in 4 and considering the maximum rates highlighted with of the species l tenuis and l cyanogaster respectively given in table 5 we obtain that r t 0 390 and r c 0 553 these rates and the inequalities 5 allow writing that α t c 0 831 and α c t 0 750 are the most appropriate coefficients for this case of competition fig 3 presents the corresponding vector field the solution found when solving the system of differential equations was n t 24 2512 and n c 18 2288 so it is concluded that the species l tenuis and l cyanogaster are limited to their effective niches that is the species l tenuis tends to approach 24 individuals and the species l cyanogaster to 18 individuals in the three cases studied 4 discussion 4 1 interpretation of results the system of equations 6 baigent 2010 sternberg 2010 corresponds to 3 where a r t b r t k t c r t α t c k t d r c e r c α c t k c and f r c k c are in function of the parameters calculated in sections 3 1 3 3 6 d dt n t n t a b n t c n c d dt n c n c d e n t f n t observe that a and d represent the constant growth rate of each species b and f are the logistic terms of each of the equations 6 that is they are the coefficients that govern intraspecies competition while c and e are the coefficients responsible for the interaction interspecies baigent 2010 sternberg 2010 if b f c e which happens in the three situations studied then the intra species interaction predominates over the interspecies that is a stable equilibrium is reached which also receives the name of stable coexistence baigent 2010 following we will explain the phase diagrams in order to understand the situations depicted in figs 1 3 the fig 4 shows the isoclines lines with positive slope that divide the first quadrant in four regions denoted by i ii iii and iv their cut points with the coordinate axes literals given in eqs 6 and the slope field represented by the arrows which converge to the equilibrium point e note that at the points of the x isocline when d dt n t 0 the trajectories have vertical slope and at the points of the y isocline when d dt n c 0 the trajectories have slope horizontal baigent 2010 on the other hand the families of trajectories map or phase diagram that converge to equilibrium point e as concluded from the slope analysis presented in fig 4 are shown in fig 5 4 2 discussion of results according to the data collected the trunks seem to be the ideal micro habitat for both species 100 for the l tenuis species and 90 for the l cyanogaster species and the way these two species make use of the trunks either for thermoregulation or for substrate is captured by the proposed mathematical model from a mathematical perspective figs 1 3 plot the velocity vectors at each point n t n c as small arrows pointing in the direction leading to the equilibrium point only if is that it exists and the size of the arrows represents the speed of convergence towards this point which is the solution of the system of differential equations 3 in addition the equilibrium point found is an asymptotically stable attractor sternberg 2010 called stable coexistence that is the intraspecies interaction predominates over the interspecies and therefore it achieves a stable equilibrium baigent 2010 the point e represents this in fig 4 on the other hand the phase diagrams showed parsimonious coexistence among the species studied with an almost constant ratio close to unity with the l tenuis species always being a little larger without doubt these are not species that depredate each other but neither do they coexist cooperatively and in the three analyzed forms see sections 3 1 3 3 they behave according to the competitive two species logistic model baigent 2010 díaz et al 2010 mendoza herrera 2012 jaramillo mejía et al 2013 conclusions the competitive two species logistic model which is a variant of the lotka volterra predator prey system once again coincides with the real world as it consistently modeled the population dynamics of the two species of lizards l cyanogaster and l tenuis that we studied furthermore this model had the flexibility to model competition for thermoregulation and competition for substrate between these two sympatric species of lizards the competitive model analyzed efficiently described the parsimonious coexistence that occurs between the studied species showing that these species are similar to each other in their abilities to appropriate and extract energy from common resources and show reciprocity in the costs of interference finally each of the three competencies analyzed led to a single point of coexistence a stable equilibrium declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the corresponding author would like to thank research projects diubb 172409 gi c diubb 192408 2 r and fondo de apoyo a la participación a eventos internacionales fapei at universidad del bío bío chile the authors thank the anonymous reviewers and the editor of this journal for their valuable time and their careful comments and suggestions with which the quality of this paper has been improved 
24708,this paper models the population dynamics and competition of two sympatric species of lizards liolaemus cyanogaster and liolaemus tenuis under the following scenarios a population dynamics of each species b competition to thermoregulate and c competition for the substrate the hypothesis was that a variant of the lotka volterra model is able to explain patterns related to population dynamics and competition between both species the data used come from a study carried out between spring and autumn of 2011 2012 and 2013 in the chilean locality of nonguén valley with these data we estimate the number of individuals of each species as well as their body temperature and the place where it was found on the ground or higher the model analyzed was appropriate for the three scenarios studied and it described a parsimonious coexistence between the species and a point of equilibrium that turned out to be an asymptotically stable attractor that is if these species start with a certain initial amount they will always reach an equitable final amount keywords competence lizards modelation population dynamics thermoregulation 1 introduction living beings can compete for food water space light the possibility of mating or other necessary resources to survive and reproduce townsend et al 2008 and references included therein competition exists when the resource is limited when resources are finite in nature and only some individuals in a population manage to get the necessary to survive it refers to intraspecific competition for these scarce resources if resources are limited the increase in population decreases the amount of resources for each individual and reduces the aptitude of the population in turn the growth rate of the population decreases with the increase of interspecific competition which negatively affects density on the other hand the fall in the growth rate with the increase in population follows models represented by logistic functions since survival growth and reproduction of individuals are the final effects of competition townsend et al 2008 in both theoretical and mathematical research and publications see in baigent 2010 díaz et al 2010 sternberg 2010 mendoza herrera 2012 jaramillo mejía et al 2013 samanta and gómez aíza 2014 and in the references they make there as in applications to situations of intra and interspecific competition of diverse nature see in lacitignola and tebaldi 2005 formoso 2010 ossa 2011 suris campos et al 2013 montaño and sánchez yáñez 2014 may cen 2016 used lotka volterra equations for predator prey competition however in the reviewed literature we did not find this model to describe the behavior of the species l cyanogaster and l tenuis climate change affected the temperature sinervo et al 2010 that is one of the most important factors in the biological adaptation atkinson 1994 and both the world diversity of reptiles and the abundance of their populations are declining gibbons et al 2000 sinervo et al 2010 thus the ability of a reptile to control its body temperature is vital according to kiernan 2014 ectotherms such as lizards achieve thermoregulation by actively using their behavioral adjustments behavioral and physiological of which the selection of micro habitats is more important than postural adjustments the structural properties of the habitat influences the capacities of some lizards to thermoregulate efficiently even many of the costs associated with thermoregulation can be reduced by inhabiting sectors with ambient temperatures similar to their preferred body temperature in the same way as most people acquire and maintain body temperature by going back and forth between different micro habitats where they can gain or lose heat the above reasons are those that allow proposing thermoregulation and micro habitat susceptible to competition thus the place where the lizards inhabit will facilitate or hinder their survival a suitable habitat for them is the valle de nonguén which is a central southern zone of chile where remnants of the deciduous forest of the city of concepción remain gajardo 1995 in this place it is possible the sighting of the snake tachymenis chilensis and the lizards liolaemus lemniscatus liolaemus chiliensis liolaemus cyanogaster and liolaemus tenuis demangel 2016 the objective of this study was to show other applications of a variant of the lotka volterra model and to present new models that predict the population dynamics of two sympatric populations of the genus liolaemus competing for thermoregulation and for substrate the hypothesis of this research was that the proposed models consistently predict the size of the population 2 material and methods 2 1 data collection the study was developed during september and may of 2011 2012 and 2013 in valle de nonguén according to the general classification of köppen this locality shows a climate of type csb warm temperate with winter rains and warm summer use of the micro habitat and daily activity we walked the sites continuously along a linear transect of approximately 6 m in width and 100 m in length during the entire day that lasts the daily activity of both species of lizards 09 00 a m at 7 00 p m we walked the transects in the same direction and place to reduce the probability of registering more than once the same individual of the population two types of substrates can be distinguished in the habitat of l tenuis and l cyanogaster a high system characterized by the presence of fallen trunks or tall trees above the 0 2 m of soil b low system consisting of areas in direct contact with the ground or between low scrub less than 0 20 m in height at the beginning of each walk we recorded the temperature of the substrate and the ambient temperature 0 3 m above the ground with a thermometer with a cu constant digi sense 8523 00 thermocouple for each observed lizard we recorded the body temperature species type of substrate high or low and its temperature tables 1 5 show the numerical data collected for each species in these tables rate is the estimated proportion of increase in what is registered in a measurement with respect to the previous one table 1 presents the number of individuals of the species l tenuis and table 2 those of the species l cyanogaster sighted on the ground and on fallen trunks or in low scrub at different times of the day tables 3 and 4 show the substrate temperatures where each individual of the respective species was observed where the heat index represents an estimate of the average temperature consumed by the observed individuals which is given by the following expression heat index substrate temperatures number of individuals observed table 5 presents an estimate of the monthly occupancy ratio of the highest system for each of the species which we use as an indicator of competition for the substrate 2 2 modeling assumptions and mathematical model proposed before analyzing the mathematical model we want to emphasize that we chose the lotka volterra model instead of other kind of models mainly because of its tractability the equations that govern it are linear in equilibrium which allows many species to be included in the model this results is very useful in the theory of ecological communities the equations thus compensate for a dynamic description of erratic accuracy with a manageable model of communities close to equilibrium schoener 1976 when analyzing systems of differential equations on r n of the form d dt x 1 x 1 f 1 x d dt x 2 x 2 f 2 x d dt x n x n f n x undoubtedly the one that stands out is the study of the standard lotka volterra models which are known as general n species lotka volterra systems where f i r n r n is smooth and it is such that f i x r i j 1 n c i j x j for some constant r i r i 1 n x x 1 x n and constant real matrix c c i j next we will analyze the lotka volterra system that models the dynamics of two interacting populations 2 2 1 predator prey let n t denote the prey population and p t the predator population at time t 0 the following are the simplest assumptions of the predator prey model 1 in the absence of predators p 0 the per capita prey growth rate 1 n d dt n of the prey population n was constant but fell linearly as a function of predator population p when predation was present p 0 2 if there is a predator presence the per capita growth rate will have a reduction in an amount proportional to the predator population at each moment 3 in the absence of prey n 0 the per capita growth rate of the predator 1 p d dt p was constant and negative and increased linearly with the prey population n when prey was present n 0 4 the contribution of prey to the relative growth rate of predators is proportional to the number of preys at that time based on the previous hypotheses the lotka volterra model results as the following system of differential equations 1 n d dt n c 11 c 12 p 1 p d dt p c 21 n c 22 where the parameters c 11 c 12 c 21 c 22 0 are constants ecological considerations according to baigent 2010 there are several points of criticism worth noting for the volterra lotka model changing the birth and death rates does nothing but change the period of the oscillation i e no population can dominate and there is no possibility of either population being driven to extinction for certain ecological conditions fitness of species etc one would expect one species to win regardless of initial conditions in addition the system is structurally unstable any model is an approximation of a real system for a model to be successful one would expect that typically a small modification to the model would produce similar results i e would give a topologically unchanged phase space picture 2 2 2 competition baigent 2010 reminds us that for a single population of density n the simplest density dependent per capita growth rate is linear and gives rise to the logistic equation 1 d dt n ρ n 1 n k the density k is the maximum population density that the environment can carry and is called the environmental carrying capacity the quadratic term in 1 represents competition between members of the same population for resources i e intraspecific competition for a model of competition within an environment supporting two species there are two types of competition intraspecific and interspecific the latter being competition between the two different species to build a simple model for such competition we start with two independent logistic models for the population densities n 1 n 2 and add an extra term in each to model the interspecific competition 2 d dt n 1 ρ 1 n 1 1 n 1 k 1 c 1 n 2 d dt n 2 ρ 2 n 2 1 n 2 k 2 c 2 n 1 baigent 2010 points out that in the absence of interspecific competition each species grows to its respective carrying capacity the relative sizes of c 1 c 2 0 determine the competitiveness of each species baigent 2010 calls system 2 a competitive two species logistic model observing that the species l tenuis and l cyanogarster cohabit in the same micro habitat and although they compete for space and food they coexist harmoniously without predating we conclude that their population dynamics could be modeled by the system 2 that allows cooperative coexistence between species written in terms that are more interpretable this model is governed by the system of differential equations 3 baigent 2010 díaz et al 2010 mendoza herrera 2012 jaramillo mejía et al 2013 samanta and gómez aíza 2014 on the other hand even when lizards live in a three dimensional space as a first approach to model them we use a one dimensional idealized system of differential equations because in everything we investigate we do not find spatial models in more than one dimension and this would be a future work by perform 3 d dt n t r t n t k t n t α t c n c k t d dt n c r c n c k c n c α c t n t k c where the subscripts t and c correspond to the species l tenuis and l cyanogaster respectively in addition n i is the size number of individuals of species i k i is the load capacity maximum number of individuals that can live in a stable way in the population of species i where i t c represent the species under study in turn α t c is the coefficient of competition per capita on the species t of the species c number of individuals of the species c that is equivalent to one of the species t and α c t is the coefficient of competition per capita on the species c of species t number of individuals of species t that equals one of species c on the other hand r i i t c are rates whose definition will depend on the situation to be modeled 2 3 parameters selection in the model from tables 1 and 2 it is obtained that the maximum number of individuals of each species are 40 and 37 respectively therefore the load capacities are given by 4 k t 40 and k c 37 it follows that the species remain in a stable equilibrium that is both species exert a lesser competitive effect on the other species than on themselves deducting that k t k c α t c and k c k t α c t from of these last two inequalities and the load capacity values given in 4 it is concluded that 5 α t c 40 37 1 081 and α c t 37 40 0 925 3 results depending on what is measured with the rate r i we have the three modeled situations described in the following subsections 3 1 population dynamics of each species in this case r i measures the intrinsic rate of increase of species i for i t c considering the load capacities given in 4 and the rates of the respective species recorded in tables 1 and 2 we obtain that r t 0 675 and r c 0 514 with these rates and according to what is established in 5 the most appropriate per capita competencies are α t c 0 900 and α c t 0 800 because this guarantees that the equilibrium point stays in the first quadrant since a different case would be meaningless real biological when replacing these values in the lotka volterra model and using matlab to solve it we obtain the vector field presented in fig 1 the concept of vector field phase diagram is explained in the subsection interpretation of results the real solution that we obtained was n t 23 7147 and n c 17 8261 3 2 competition to thermoregulate for this situation r i is the rate of increase by heat of species i for i t c taking into account the values given in 4 and the maximum rates highlighted with of the respective species recorded in tables 3 and 4 we obtain that r t 0 574 and r c 0 426 with these rates and the restrictions given in relation 5 it is found that α t c 0 880 and α c t 0 780 are the most appropriate coefficients for this type of competition because they guarantee a biologically stable equilibrium point substituting these parameters in the model 3 and solving the vector field given in fig 2 is achieved the real solution that we obtained was n t 23 7554 and n c 18 3319 3 3 competition by substrate let now r i the rate of increase by the occupation of the high system of species i for i t c with the values given in 4 and considering the maximum rates highlighted with of the species l tenuis and l cyanogaster respectively given in table 5 we obtain that r t 0 390 and r c 0 553 these rates and the inequalities 5 allow writing that α t c 0 831 and α c t 0 750 are the most appropriate coefficients for this case of competition fig 3 presents the corresponding vector field the solution found when solving the system of differential equations was n t 24 2512 and n c 18 2288 so it is concluded that the species l tenuis and l cyanogaster are limited to their effective niches that is the species l tenuis tends to approach 24 individuals and the species l cyanogaster to 18 individuals in the three cases studied 4 discussion 4 1 interpretation of results the system of equations 6 baigent 2010 sternberg 2010 corresponds to 3 where a r t b r t k t c r t α t c k t d r c e r c α c t k c and f r c k c are in function of the parameters calculated in sections 3 1 3 3 6 d dt n t n t a b n t c n c d dt n c n c d e n t f n t observe that a and d represent the constant growth rate of each species b and f are the logistic terms of each of the equations 6 that is they are the coefficients that govern intraspecies competition while c and e are the coefficients responsible for the interaction interspecies baigent 2010 sternberg 2010 if b f c e which happens in the three situations studied then the intra species interaction predominates over the interspecies that is a stable equilibrium is reached which also receives the name of stable coexistence baigent 2010 following we will explain the phase diagrams in order to understand the situations depicted in figs 1 3 the fig 4 shows the isoclines lines with positive slope that divide the first quadrant in four regions denoted by i ii iii and iv their cut points with the coordinate axes literals given in eqs 6 and the slope field represented by the arrows which converge to the equilibrium point e note that at the points of the x isocline when d dt n t 0 the trajectories have vertical slope and at the points of the y isocline when d dt n c 0 the trajectories have slope horizontal baigent 2010 on the other hand the families of trajectories map or phase diagram that converge to equilibrium point e as concluded from the slope analysis presented in fig 4 are shown in fig 5 4 2 discussion of results according to the data collected the trunks seem to be the ideal micro habitat for both species 100 for the l tenuis species and 90 for the l cyanogaster species and the way these two species make use of the trunks either for thermoregulation or for substrate is captured by the proposed mathematical model from a mathematical perspective figs 1 3 plot the velocity vectors at each point n t n c as small arrows pointing in the direction leading to the equilibrium point only if is that it exists and the size of the arrows represents the speed of convergence towards this point which is the solution of the system of differential equations 3 in addition the equilibrium point found is an asymptotically stable attractor sternberg 2010 called stable coexistence that is the intraspecies interaction predominates over the interspecies and therefore it achieves a stable equilibrium baigent 2010 the point e represents this in fig 4 on the other hand the phase diagrams showed parsimonious coexistence among the species studied with an almost constant ratio close to unity with the l tenuis species always being a little larger without doubt these are not species that depredate each other but neither do they coexist cooperatively and in the three analyzed forms see sections 3 1 3 3 they behave according to the competitive two species logistic model baigent 2010 díaz et al 2010 mendoza herrera 2012 jaramillo mejía et al 2013 conclusions the competitive two species logistic model which is a variant of the lotka volterra predator prey system once again coincides with the real world as it consistently modeled the population dynamics of the two species of lizards l cyanogaster and l tenuis that we studied furthermore this model had the flexibility to model competition for thermoregulation and competition for substrate between these two sympatric species of lizards the competitive model analyzed efficiently described the parsimonious coexistence that occurs between the studied species showing that these species are similar to each other in their abilities to appropriate and extract energy from common resources and show reciprocity in the costs of interference finally each of the three competencies analyzed led to a single point of coexistence a stable equilibrium declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the corresponding author would like to thank research projects diubb 172409 gi c diubb 192408 2 r and fondo de apoyo a la participación a eventos internacionales fapei at universidad del bío bío chile the authors thank the anonymous reviewers and the editor of this journal for their valuable time and their careful comments and suggestions with which the quality of this paper has been improved 
24709,permanent grasslands host a high plant diversity which sustains many ecosystem services thus understanding how composition of the plant community responds to different management practices under given soil and climatic conditions is crucial for making best use of grasslands modeling approaches may be used to explain the manifold interactions involved to sustain this diversity we developed the dynamic process based ecological model dynagram to simulate the seasonal aboveground vegetation dynamics of semi natural grasslands the model allows specifying plant community by any number of species the predictive power of the model was assessed by simulating the dynamics of a virtual mountain grassland in response to four typical management scenarios under constant climatic conditions over several decades in our experiments we modelled an assemblage of seven species representing contrasted plant functional types we compared model outputs to compositions inferred from floristic records conducted in the french jura mountains irrespective of initial conditions the simulated community converged to four distinct compositions that primarily reflected management overall the results matched the functional composition inferred for each of the scenarios from the botanical records convergence in functional composition was reached in less than 15 years under grazing scenarios but not less than 50 years under mowing scenarios at quasi equilibrium the highest vegetation diversity was obtained for extensive grazing and the lowest for extensive mowing overall this study introduces a novel and relatively simple approach to model competition and adaptation processes in plant community dynamics thus providing a response to the key challenge of modeling multi species grasslands keywords grassland model hayfield interspecific competition pasture plant community dynamics process based model vegetation dynamics introduction semi natural permanent grasslands occupy a large fraction of european territories and are the milestone of agricultural practices in mountain areas gaujour et al 2012 these ecosystems are often hotspots of biodiversity sustaining many ecosystem services and facing various disturbances of anthropogenic or natural origin species composition and diversity of the grassland plant communities are strongly influenced by their current and past management myers et al 2000 while intensification or abandonment lead in many cases to severe reduction of plant diversity rosenthal 2010 van calster et al 2008 some temperate european grasslands managed for a long time with low intensity of mowing or grazing present the world record of species richness at fine scale wilson et al 2012 models developed in the past to simulate the dynamics of vegetation composition in grasslands have mostly targeted the landscape scale such as woodpam gillet 2008 peringer et al 2013 or the global scale such as lpjml rolinski et al 2018 rather than the field scale also grassland models published so far focused on monospecific swards duru et al 2009 mccall and bishop hurley 2003 schapendonk et al 1998 mixtures of a grass and a legume species lazzarotto et al 2009 thornley 1998 or a multispecies community constant in time jouven et al 2006a riedo et al 1998 lingra is a sink source model simulating the productivity of lolium perenne in european grasslands schapendonk et al 1998 lingra and modvege jouven et al 2006a focus on the productivity dynamics of the plant community whose composition is constant over time and described by one species or four functional types respectively taubert et al 2012 reviewed thirteen grassland models finding that only two described explicitly the plant community by more than three different species or functional types gras a succession compartment model siehoff et al 2011 and steppe a gap model of semiarid grasslands coffin and lauenroth 1990 however neither gras nor steppe simulate plant biomass in a recent review van oijen et al 2018 distinguished three categories of grassland models empirical integrated and process based the latter comprising ecological biogeochemical and agricultural models for all of them there is a need to incorporate biodiversity to in particular improve knowledge and predictions of the ecosystem services provided by permanent grasslands van oijen et al 2020 taubert et al 2012 concluded that in practice only two contrasted formalisms have been explored so far to predict changes in the composition of grassland plant communities following a gradient of complexity on one hand ecological grassland models characterized by elegant mathematics represent plant biomass or cover dynamics based on resource competition processes tilman 1980 1982 or tolerance to external disturbances such as gras siehoff et al 2011 on the other hand more complex spatially explicit individual based grassland models may include a high number of plant species or plant functional types pfts these models can consider above and below ground intra and inter specific competition among plant individuals or organs allowing simulations of metacommunities of many pfts typical examples are ibc grass weiss et al 2014 or ecohyd lohmann et al 2017 among other models falling into this category may et al 2009 soussana et al 2012 taubert et al 2012 to be able to simulate in detail the interactions between the soil the vegetation and the atmosphere biogeochemical models tend to be rich in parameters and variables van oijen et al 2018 complexity can be reduced by resorting to plant functional types in grassland models pfts are specified by combining parameters from a set of functionally related species such as legumes perennial grasses or erect forbs typically a pft is a group of species with similar functional traits and therefore similar responses to constraints and disturbances such as management practices and similar contributions to ecosystem services such as forage production graux et al 2016 in this context incorporating an explicit description of vegetation diversity multiplies the dimension of the parameter space leading to high complexity and models that could be difficult to control a possible solution is to consider re usable components that can be coupled with a single instance of a generic crop model to simulate explicitly seasonal changes in taxonomic and functional composition of managed grasslands this approach has been implemented in cosmo confalonieri 2014 movedi et al 2019 as summarized by moulin et al 2018 very few grassland models have been designed to simulate both composition and biomass changes in multispecies semi natural grasslands used as pastures or and hayfields a requirement for understanding diversity productivity stability relationships this gap has also been emphasized by kipling et al 2016 currently few process based models exist to explain or predict the intricacies of the relation between biodiversity productivity and the long term stability of the vegetation assemblage van oijen et al 2018 thus it appears crucial to develop a dynamic grassland model of that includes an explicit description of diversity and addresses both plant composition and biomass growth for various forms of land use following the generic approach allowing the inclusion of any level of diversity introduced by moulin et al 2018 the aim of this paper is to provide a comprehensive description of the dynamic grassland model dynagram and to explore its behavior under different management conditions one important choice for building dynagram was to restrict the ecophysiological description to essential processes in order to minimize the dimension of the parameter space hence to simplify species parameter estimations and to save computation time in this respect even if the purpose of dynagram appears very similar to that of cosmo the approaches are different as mentioned before cosmo requires to be coupled with a complex biogeochemical model to run vegetation simulations as opposed to this dynagram basically a mechanistic model of resource competition tilman 1980 is a stand alone solution it represents the regulation of green biomass and plant competition from the standpoint of resource dynamics but this approach is refined by integrating ecophysiological and biophysical details inherited from modvege jouven et al 2006a and soil processes from prograss lazzarotto et al 2009 a recent adaptation of modvege the moorepark st gilles grass growth model most gg has been developed in the context of irish pastures ruelle et al 2018 this dynamic model describes the daily grass growth for grazing systems at the paddock level including a spatially explicit structure and a soil nitrogen compartment these models have been validated with real data calanca et al 2016 and most gg is still the object of new developments ruelle et al 2018 in contrast to modvege most gg and gras siehoff et al 2011 which assume a constant plant community composition we integrated in dynagram a generic description of the vegetation as a set of any number of plant species or species groups pfts in a previous paper moulin et al 2018 we compared simulation results from alternative instances of a preliminary version of dynagram that only differ by the identity and number of state variables plant species or pfts describing the green biomass in the present paper we focus on a typical grassland plant community made of seven frequent and potentially dominant species representative of each pft observed in european mid mountain mesic grasslands we explore the response of the functional composition of this modelled plant community to various management scenarios under realistic climatic conditions the overarching goal of this paper is to present the model formalism and to discuss model behavior with selected simulation experiments that we conducted for illustrative purposes only in these experiments we address the following research questions 1 how are diversity and composition of the plant community affected by several years or decades of constant land use grazing or mowing and management intensity extensive or intensive 2 to what extent do management induced differences in the simulated plant community reflect differences in relative cover of species or pfts inferred from floristic records of mesic grasslands 3 how does the initial composition of the plant community influence its adaptation to management conditions 4 does the response time of the simulated community dynamics depend on management type and intensity methods model description dynagram is a mechanistic process based model for simulating the seasonal growth of the aboveground biomass and the seasonal course of the botanical composition in mixed temperate grasslands under various conditions of climate soil and management moulin et al 2018 it consists of three submodels with state variables table 1 and forcing variables connected as shown in fig 1 in this section we present the key assumptions and the main equations of the model a comprehensive description of dynagram is given in appendix a online supplementary material overview and main assumptions the climate submodel contains four forcing variables defined as the daily records of mean temperature t c precipitation p mm photosynthetic active radiation par mj m 2 and potential evapotranspiration pet mm the second submodel addresses grassland vegetation in terms of n state variables bi representing the green biomass of each species or pft i kg dm ha 1 as species and pfts are alternatives to the same variables the term species will be used hereafter to refer to either species or pfts plant growth and senescence are formulated in a similar manner as in the lingra model schapendonk et al 1998 with adaptations as implemented in modvege jouven et al 2006a plant growth is driven by radiation with interception depending on the leaf area index lai and limited by temperature soil water and radiation intensity senescence is a function of the age of the sward the lai is calculated diagnostically from the aboveground biomass the soil submodel contains three state variables two of them describe the amount of available soil resources namely mineral nitrogen nm kg n ha 1 and water reserve wr the third corresponds to a pool of soil organic nitrogen no kg n ha 1 supplied by the senescence of standing biomass and litter decomposition this soil organic nitrogen is mineralized to soluble mineral nitrogen nm nitrate or ammonium that becomes available for plant uptake according to the formulation used in prograss lazzarotto et al 2009 and introduced by previous authors kirschbaum 2000 paul et al 2003 schwinning et al 1999 this loop of consumption degradation of nitrogen implicitly present in three forms mineral in the soil solution organic in the soil and in the biomass is an important feature of dynagram as it directly supports interspecific resource competition overall the model consists of a non linear system of n 3 ordinary differential equations odes built under simplifying assumptions introduced to limit to a minimum the dimensions of the parameter space herbaceous vegetation is only described by green biomass mainly leaves thus implicitly excluding belowground biomass roots storage organs and the reproductive parts of the plants flowers fruits hence the model does not account for seed production and recruitment from the seedbank and for allocation strategies although maximal canopy height is taken into account to contrast mowing impact on species the model ignores the time dependent height distribution of plants assuming that the competition for light within the canopy only depends on the relative proportions of the leaf area index see below and considers a very simplified representation of the aging processes inherited from modvege moreover the model neglects symbiotic fixation of atmospheric nitrogen by legumes and denitrification in the soil plant biomass dynamics for a given species i green biomass dynamics is described by the following equations for clarity reason only the dependence on state and forcing variables is indicated 1 d b i d t g r i μ i s e n t m o w i b i g r a z i b i 2 g r i g r i b i p a r s e a t r r e d p a r n r e d i n m t r e d i t w r e d i w r p e t a r e d i where g r i expresses the actual growth rate of a given species i g r i b i p a r expresses potential growth as a function of standing biomass b i and photosynthetic active radiation p a r and s e a t is an empirical representation of the seasonal pattern of shoot growth jouven et al 2006a in addition r r e d n r e d i t r e d i w r e d i and a r e d i are the growth reducers associated with radiation soil mineral n availability temperature soil water status and cattle trampling respectively μ i s e n t is the seasonal sink associated with senescence m o w i b i and g r a z i b i are the biomass removal rates due to mowing and grazing respectively as in lingra and modvege potential growth is described by an ivlev function of the total leaf area index l a i t o t weighted according to the proportion of lai accounted for by the individual species thornley and johnson 1990 setting 3 l a i i b i s l a i b i 10 l a m 4 l a i t o t j 1 n l a i j b j we have 5 g r i b i p a r 10 p a r r u e max 1 exp α l a i t o t l a i i b i l a i t o t in eqs 3 to 5 r u e max is the maximum radiation use efficiency of the whole canopy α the extinction coefficient s l a i the specific leaf area of species i and l a m the percentage of laminae for the sake of simplicity and following modvege we assume the same values of lam α and rue max for all species the factor 10 in eq 5 ensures unit consistency growth limitation associated with soil mineral n availability is modelled as a holling type iii function 6 n r e d i n m n m 2 k i 2 n m 2 where k i is the half saturation term corresponding to the amount of mineral n resource for which the vegetation growth rate could reach half its maximum if the other resources are not limiting this parameter ki traduces for a given species i its nutrient requirement for its growth for the sake of compactness details concerning other reducers and functions involved in eqs 1 and 2 viz r r e d t r e d i w r e d i a r e d i s e a and sen can be found in appendix a online supplementary material the last two terms on the right hand side of eq 1 are the rates of defoliation associated with mowing and grazing both are modelled as pulse wise functions removal of aboveground biomass by mowing is assumed proportional to the standing green biomass of each species whereby the proportionality factor λ i also varies among species to account for differences in the vertical distribution of biomass λ i has been estimated according to the maximal canopy height hi of the given species i and a cutting height of 5 cm as expressed by λ i h i 0 05 h i 7 m o w i b i λ i b i the approach adopted to model removal of aboveground biomass by grazing is based on the assumption that each livestock unit consumes a predefined amount of biomass in such a way that the loss of biomass by each species depends on appetence ρ i and relative abundance of the species denoting by s d the stocking density expressed in adult bovine units per hectare abu ha 1 where 1 abu is equivalent to a dairy cow by κ the daily consumption of an adult bovine unit kg dm abu 1 d 1 and again assuming a holling type iii functional response we have 8 g r a z i b i κ s d ρ i b i 2 1 j 1 n ρ j b j 2 in the model growth competition among species occurs at different levels competition for light depends on laii eq 5 competition for nutrients on δi and ki eq 6 more details in appendix a online supplementary material in addition different responses to environmental constraints appendix a online supplementary material fig a 1 also provide advantages or disadvantages under specific conditions as well as impacts of moving and grazing eqs 7 and 8 soil nitrogen and water dynamics the dynamics of soil organic n n o soil mineral n n m and soil water reserve w r is described by the following differential equations 9 d n o d t i 1 n δ i c o μ i s e n t b i n d s d φ o θ t m i n t w m i n w r n o 10 d n m d t θ t m i n t w m i n w r n o n u s d φ m λ n m i 1 n δ i c m g r i b i p a r r r e d p a r n r e d i n m t r e d i t w r e d i w r p e t a r e d i s e a t 11 d w r d t p a e t b i w r p e t δ b i w r p e t p the first term on the right hand side of eq 9 represents the input of organic n through plant residues as determined by senescence the second is the input through dung deposition from grazing cattle the third the input by organic fertilizer and the last negative one the rate of mineralization as modulated by temperature and soil water availability the mineralization rate appears again in eq 10 with the opposite sign representing here an input of mineral n the second term on the right hand side of eq 10 is the input through urine deposition from grazing cattle the third the input from mineral n fertilizer the fourth the loss by leaching whereas the last one represents plant n uptake finally eq 11 gives the soil water budget as the difference between precipitation and evapotranspiration plus deep percolation eqs 9 and 10 follow the approach adopted in prograss lazzarotto et al 2009 whereas eq 11 is consistent with the solution implemented in modvege jouven et al 2006a details concerning the functions t m i n w m i n sen λ aet and δ can be found in appendix a online supplementary material community diversity to measure community diversity dynagram uses simpson evenness index that is inverse simpson diversity divided by the number of species n hill 1973 moulin et al 2018 12 e b 1 n i 1 n b i b t o t 2 1 where b t o t i 1 n b i is the total green biomass of the whole community parameterization dynagram includes 36 global parameters along with 9 n species specific parameters and n 3 initial condition values for state variables appendix b online supplementary material table b1 provides a complete list of the parameters including definition units default values and references we obtained values of the global parameters from literature in addition we estimated species parameters based on various sources see appendix a online supplementary material numerical integration we implemented dynagram in r language r core team 2020 we numerically solved the ode system with the function ode in the r package desolve soetaert et al 2010 using the euler method and an integration time step of one day the appropriateness of the time step was verified by comparing standard outputs with those obtained from running the model with a smaller time step the pertinence of the numerical solution scheme was further tested by replacing ode with the function lsoda in the same r package the latter being an ode solver that automatically switches between stiff and non stiff methods no sensible difference in the solution was detected however the choice of a discrete time integration method euler solver with dt 1 can lead to negative biomass values after defoliation events to prevent the inadvertent definitive loss of species we introduced a minimal residual amount of biomass remaining after any disturbance b m i n 1 5 kg dm ha 1 model variables and parameters to show the model ability to capture the response of grassland communities to management practices we considered a fictitious grassland illustrative of european mountain pastures and hayfields this theoretical grassland does not correspond to a real specific site but vegetation climate soil and land use have been specified to be characteristic to those commonly observed in the pontarlier region french jura mountains at 900 m a s l elevation in this region permanent grasslands represent a large fraction of the agricultural area they are extensively to intensively managed to sustain dairy farming for pdo cheese production mauchamp et al 2014 we retrieved climatic data for pontarlier from the e obs v19 0e database cornes et al 2018 we selected within this climatic time series covering the period 1981 to 2018 the year 2004 to be representative of the climatic conditions in this area we designed the climate forcing variables as repetitions of the daily records for this standard year 2004 it results that interannual variation of weather conditions is neglected in this study to avoid confounding effects of specific years on the response of vegetation to management scenarios however the considered climate forcing variables impact the seasonal dynamics of the state variables soil properties are controlled by five parameters in the model initial amount of mineral and organic n maximal mineralization rate θ and levels of the permanent wilting point pwp and the water holding capacity whc values were estimated from the soil atlas of europe european soil bureau network 2005 and maps of indicators of soil hydraulic properties for europe european soil data centre 2016 soil parameter values are given in appendix b online supplementary material table b1 anthropogenic disturbances were modelled by four agricultural management scenarios typical of the french jura mountains differing by the type of defoliation and by the intensity of agricultural practices including fertilization extensive or intensive grazing and extensive or intensive mowing table 2 based on a theoretical assessment of the impact on dynagram simulations of the number of state variables describing the vegetation moulin et al 2018 we chose n 7 state variables to describe the plant community corresponding to seven pfts we considered the four pfts of grasses cruz et al 2002 duru et al 2009 built on plant functional traits for nutrient acquisition and tolerance to defoliation pft a corresponds to early and fast growing grasses in fertile and frequently disturbed grasslands whereas at the opposite pft d describes late and slow growing grasses in infertile and unfrequently disturbed grasslands we added three lifeforms of dicots tall erect forbs e small rosette and creeping forbs r and legumes l then to specify values for each of the nine species specific parameters table 3 we selected a single representative species for each of the seven pfts among the most frequent and abundant species in the pontarlier region according to previous botanical surveys perronne et al 2014 details on the estimation of values for the species specific parameters are available in appendix a online supplementary material this selection of seven species represents a wide diversity of life strategies as evidenced by their distribution in the csr triangle shown in fig 2 grime 1977 pierce et al 2017 the community dynamics simulated by dynagram is explained by tradeoffs among the three life strategies of grime 1977 a competitive ability c leading to high potential growth gri function of sla i the tolerance to a stress on resources s mainly determined by nredi function of ki or wredi function of ηi and a resistance to defoliation events r driven by ρ i σ i and λ i numerical experiments two numerical experiments were performed with dynagram they illustrate the potential application of the model and should be considered as a proof of concept of the proposed approach rather than a model validation the results of a third one related to the comparison of dynagram and modvege is available in appendix d online supplementary material impact of management on community composition effects of management practices on the simulated botanical composition research question 1 were assessed by simulations under the four management scenarios described in table 2 starting from the same initial composition we defined the latter by an even distribution of all species seasonal biomass dynamics at final state was obtained after a repetition of the same management scheme and the same seasonal weather conditions for the year 2004 over twenty years for extensive grazing and intensive mowing management we also compared the seasonal dynamics of the four plant growth reducers introduced in eq 1 reducer values were computed at the community level by averaging the seven species values weighted by their relative biomass because soil organic nitrogen showed a very slow dynamics fig c2 online supplementary material appendix c the whole system would require a very long simulation time to reach equilibrium however we expect community composition to reach more rapidly a quasi stable state characterized by very low variations simulated in the community structure due to its faster dynamics to check this we complemented this first experiment by an analysis for each of the four management regimes of the convergence time necessary to reach a community structure close to the cyclic attractor thus we introduced a measure of stability by comparing a synthetic index of community diversity simpson evenness eb between successive years for each julian day t we computed relative differences as the ratio e b t e b t 365 e b t 365 mean year to year changes were computed for the vegetation period i e from april 1 to september 30 over 100 years to assess the realism of the simulated functional composition research question 2 we compared model simulation outputs to observed data in the selected case study area we extracted from phytobase a phytosociological database gillet 2015 68 floristic relevés of permanent grasslands sampled at 800 900 m a s l elevation in the french jura mountains i e under the climatic conditions close to those at pontarlier we classified the relevés into four management categories deduced from their phytosociological classification ferrez et al 2011 gentiano luteae cynosuretum cristati was assigned to extensive grazing 9 relevés lolio perennis plantaginetum majoris lolio perennis cynosuretum cristati and alchemillo monticolae cynosuretum cristati to intensive grazing 13 relevés euphorbio brittingeri trisetetum flavescentis to extensive mowing 18 relevés and alchemillo monticolae brometum hordeacei to intensive mowing 28 relevés these 68 floristic relevés of mesic permanent grasslands have been recorded at different sites seasons and years each of the observed 195 species was assigned to a pft and we computed the mean relative cover of each pft in each management category in addition we compared the relative cover of the seven species selected in the model simulations among the four management categories thus we obtained two representations of the observed functional composition in response to four contrasted land use types directly comparable to previous dynagram simulation outputs sensitivity to initial conditions in a second simulation experiment we assessed the impact of the initial community composition on vegetation dynamics under contrasted management practices research question 3 for this purpose we performed an analysis of the model sensitivity to the initial quantitative composition of the plant community by varying the relative proportion of each species at the beginning of each simulation the 1st of january at year 1 eight initial compositions were considered seven of them were defined by a strong dominance half of the initial total biomass of each one of the species in turn the last one was built from an even distribution of all species as in our first experiment sensitivity to the eight initial conditions were assessed under the four contrasted management scenarios described in table 2 repeated every year identical soil and climatic conditions were considered for all these simulations as explained above in section 2 2 we compared the simulated compositions obtained respectively at years 10 and 50 by representing mean biomass values of each species within the vegetation period from april 1 to september 30 then to address the question of the impact of management on the convergence time research question 4 a 100 year time horizon was considered assuming for a given practice that all initial assemblages converge to the same final state we summarized each community structure by its simpson evenness we compared time series of mean and standard deviation of the simpson evenness obtained from the eight initial community structures under the four management scenarios within the vegetation period results impact of management on community composition markedly distinct community patterns emerged after 20 year simulations for the four management scenarios fig 3 despite the same initial conditions in all four cases this result indicates that the simulated community composition was strongly influenced by management both in term of intensity and type of defoliation it highlights the ability of dynagram to express the chief influence of management practices on community dynamics as extensive grazing and intensive mowing resulted in very contrasted biomass and community patterns fig 3a and 3d we chose these two management scenarios to show how they differ in terms of seasonal change of the weighted mean stress reducers and disturbance defoliation factors figs 4 a and 4b and net growth rates of the different pfts figs 4c and 4d dominance of species in fig 3 resulted inherently from high actual growth rates in figs 4c and 4d nitrogen availability played a key role among the limiting factors fig 4a and b in contrast to limitations associated with temperature and water which did not differ between the two management scenarios thus the sigmoid holling iii functional response appears as a key function in our model to describe competition for limiting resources among species and to explain the observed shift of dominant species with land use intensification this function explains how the shortage in mineral n resource affects negatively the growth rate of each species as each unit of biomass produced requires the consumption of a certain amount of mineral n the dependence on nm in eq 6 along with differences in the value of the half saturation constant k i explain how species compete and share the resource once it becomes limiting under intensive mowing fertilization can prevent mineral n stress leading to values of nred close to 1 for all species in summer fig 4b nevertheless mineral fertilization led to higher total biomass values associated with a dominance of the competitive and productive pfts a b and r fig 3b and 3d alleviation of nutrient stress following each fertilization event fig 4b hence favored the growth of pfts a b and r fig 4d higher sla values provided an additional competitive advantage to pfts b and r under high nutrient availability table 3 extensive management scenarios led to a dominance of pfts c and d as expected for grasslands established in poor environments and subject to low defoliation intensity fig 3a and 3c the highest diversity was reached under extensive grazing corresponding to an intermediate level of disturbance when comparing the two grazing regimes the higher total biomass simulated in spring under intensive grazing fig 3b may be explained by the first fertilization event that restricted effects of the nutrient reducer in this circumstance the overall net growth rate in spring was higher than the daily forage consumption by cattle κ sd fig 4c the opposite process occurred in summer with forage consumption higher than biomass production leading at the end of the grazing period to a standing biomass twice as low for the intensive than the extensive scenario in the model simulations time to convergence to a quasi periodic state from a given initial community structure was primarily determined by the land use type grazing or mowing and only secondarily by the intensity of the management practices fig 5 for both grazing scenarios the interannual rate of change of the diversity index decreased to below 0 1 within 20 simulation years by contrast under extensive and intensive mowing the rate of change of the diversity index increased to a maximum between 20 and 25 years before decreasing to less than 0 1 only after 40 or 50 years the rate of change after 100 simulation years remained slightly higher for the intensive than for the extensive management scenarios whatever the landuse type this was due to the slow accumulation of organic nitrogen in the soil in case of intensive fertilization which caused a slow but continuous adaptation of the plant community even after many decades in addition to these differences among management scenarios the system dynamics was characterized by i transient patterns with relatively high interannual rate of change rate of change 0 5 in the short term 5 years ii a quasi periodic state with an interannual rate of change 0 1 in the medium term 50 years and iii an asymptotic cyclic state in the long term more than 250 years not shown a thorough investigation of interannual changes in the system is provided in appendix c online supplementary material the comparison of model outputs to expected species or functional compositions revealed in spite of obvious divergences in the details common overall features fig 6 pfts a b and r showed higher relative biomass or cover in intensive than in extensive pastures and meadows at the expense of c and d which are stress tolerant but less competitive in fertile and frequently disturbed grasslands extensive grazing was the best management practice to sustain the coexistence of all pfts at long term among grass species pft a e g lolium perenne was favored by intensive grazing pft b e g poa trivialis by intensive mowing and pft c e g trisetum flavescens by extensive mowing differences between simulated and expected composition were due partly 1 to the uncertainty of the management conditions deduced from the typology of the observed vegetation and 2 to the heterogeneity of response to management type and intensity among species of each pft deviations were pronounced in particular in relation to the relative cover of legumes trifolium pratense in fig 6b or all species of pft l in fig 6c and erect forbs ranunculus acris in fig 6b or all species of pft e in fig 6c grasses belonging to pft d disappeared in simulated intensive grazing and extensive mowing scenarios fig 6a but not in intensive pastures and extensive hayfields fig 6c this was due to the choice of deschampsia cespitosa as representative species for pft d this species being relatively rare in mesic managed grasslands but dominant in wet abandoned grasslands fig 6b other species belonging to this pft d were more frequently observed such as cynosurus cristatus a diagnostic species of extensive pastures nicod et al 2019 this could explain an under representation of the pft d in fig 6b model sensitivity to initial conditions after ten years of any grazing regime extensive or intensive all assemblages converged to a same composition fig 7 b regardless of initial community structures fig 7a by contrast under any mowing regime extensive or intensive the initial composition was still reflected in the plant community after 10 years of simulation fig 7b more specifically for a sward initially dominated by one of the three pfts a b or r assemblages s1 s2 and s6 which we identified as codominant in the long term for an intensive mowing management scenario fig 3d the state after 10 years was still transient the latter was characterized by significantly higher values of the relative biomass of each of these pfts than specified in the initial conditions fig 7b a similar behavior was observed for the extensive mowing scenario where an initial dominance of the pfts c or l assemblages s3 and s7 led after 10 years to an over representation of these pfts fig 7b after 50 years of simulation most differences vanished except for assemblage s7 under extensive mowing higher biomass of trifolium pratense and for s1 higher biomass of lolium perenne s2 larger dominance of poa trivialis and s6 higher biomass of taraxacum officinale under intensive mowing fig 7c the total green biomass averaged over the vegetation period was only slightly affected by the initial composition with comparably low values under mowing than under grazing after 50 years as all eight initial community assemblages tended to converge to a single final state fig 7 we used simpson evenness eb as a synthetic descriptor of community diversity to compare convergence dynamics the standard deviation of eb values obtained for each management scenario was used to show when the impact of these initial structures on transient community diversity were vanishing fig 8 as assemblages s1 to s7 described a same uneven pft diversity pattern they presented an equal initial evenness eb 0 49 assemblage s8 was built from a perfectly even pft distribution corresponding to a maximal initial evenness eb 1 under both grazing management scenarios plant community converged rapidly 10 years toward a same composition vanishing standard deviation of the simpson evenness eventually this diversity index remained constant for extensive grazing and tended to slightly decrease for intensive grazing likely due to the previously mentioned slow increase in soil organic nitrogen in contrast the simulation time required for convergence from various initial species distributions under mowing was considerably longer 50 years convergence was fully achieved after 65 years for the extensive mowing scenario but only at the end of the simulation period 100 years for the intensive mowing scenario despite low differences in eb values among the eight community structures being as it is this result nevertheless confirms that under constant climate forcing all assemblages explored for a given management converged to the same final seasonal pattern from a theoretical perspective this guarantees the independence of the equilibrium state from initial community composition in addition after 100 years of simulation the simpson evenness values obtained for extensive grazing were more than twice higher as those found with intensive mowing interestingly this final diversity index was higher for extensive than for intensive grazing but was lower for extensive than for intensive mowing discussion with dynagram we introduce a relatively simple modeling solution to include the key notion of community dynamics in grassland models by defining a generic structure in which interspecific interactions rely on resource competition and life strategies another approach has been proposed with the cosmo module by confalonieri 2014 cosmo can coupled to any biogeochemical crop model providing means for incorporating biodiversity in grassland models cosmo has been recently validated with experimental data movedi et al 2019 however the absence of state variables to describe the herbaceous species prevents the model to explicitly reproduce the competition within the assemblage a point that we tackled with dynagram the results support our strategy of choosing a common formulation of growth for all species and indicate that the formulation of a potential growth reduced by environmental limitations introduced by schapendonk et al 1998 can provide realistic simulations they also highlight the model capacity to predict a multi species sward dynamics with a composition substantially explained by land use fig 3 the latter having been identified as an important driver of biodiversity by botkin et al 2007 and van calster et al 2008 addressing the research question 1 by comparing impacts of contrasted management scenarios we highlight the importance of soil nutrient availability in determining the seasonal community pattern fig 4 the latter showed a clear response to grassland management type and intensity which was eventually reflected in contrasting values of the nutrient reducer term nred this finding is in agreement with results obtained with the prograss model lazzarotto et al 2009 we examined the realism of the simulated community dynamics in terms of taxonomic and functional composition due to the difficulty to access repeated measurements of green biomass for individual species in semi natural permanent grasslands we relied on floristic relevés from a phytosociological database gillet 2015 and a phytosociological classification ferrez et al 2011 to define typical grassland compositions for management categories comparable to those defined in our four scenarios it turns out that a fine tuning of some uncertain species specific parameters was required to get simulation results close to observed vegetation structures after that dynagram was able to reflect management induced differences in relative cover or pfts research question 2 regardless of the management scenario the initial composition of the plant community had a small impact on the long term functional composition research question 3 confirming the key role of land use type and intensity and complementing the answer to research question 1 however simulations revealed that in the short to medium term the diversity of the plant community was far more sensitive to the initial composition under mowing than under grazing management fig 7 moreover starting from an even initial species distribution the interannual rate of change of simpson evenness peaked between 20 and 25 years in case of extensive or intensive mowing contrasting the relatively fast decline under the grazing scenarios fig 5 the faster stabilization of functional composition and diversity predicted for grazing suggests that pastures could be more stable than hay meadows on the other hand management intensity had only a minor impact on the convergence speed our results suggest that response time of the simulated community dynamics is more affected by the management type than by its intensity answering to our last research question 4 the time required for the community to reach a quasi periodic state ranged from 10 to more than 50 years that is much longer than the twelve months reported for other process based grassland models e g confalonieri 2014 higher diversity levels considered in this study implying a higher number of complex interactions among species could explain the longer time required in dynagram to stabilize the composition the ode system at the core of dynagram is highly non linear with many influences of the state variables on the dynamics of each other as highlighted by eq 5 growth rate of one pft i depends directly on its biomass bi but also of the biomass of the n 1 other pfts which impact i its potential growth according to the relative contribution of laii to laitot and ii the available mineral n which is necessarily consumed to produce any amount of biomass bi as shown in eqs 6 and 10 whatever the initial composition the model predicts that extensive grazing maximizes community diversity highest values of the evenness index eb in the long term whereas extensive mowing results in the lowest evenness fig 8 this is in accordance with the observation that grazing tends to be more beneficial to biodiversity than mowing tälle et al 2016 this result also matches the expectations of the intermediate disturbance hypothesis dengler et al 2014 siehoff et al 2011 under an extensive grazing management the absence of fertilization of mineral or organic origin prevents competitive exclusion while the low level of defoliation allows an even coexistence of all functional types in the plant community defoliations could thus explain the long term coexistence of more species than expected from the availability of essential resources contrary to the predictions of the tradeoff based niche theory rooted on a simple resource reduction competition model tilman 1980 as stressed in the model description section 2 in terms of model formalism dynagram inherited many of the approaches implemented in modvege with respect to growth a comparison of dynagram and modvege at the community level is provided in appendix d online supplementary material results showed the capacity of dynagram to simulate accurately the seasonal dynamics of herbage growth and standing biomass even after relaxing the assumptions of constant species composition and constant nutrient availability implicit in modvege fig d1 this implies that dynagram is able to capture key mechanisms of forage production defined by jouven et al 2006a modvege has been validated with respect to field observations from massif central france jouven et al 2006b the jura mountains and the swiss central plateau switzerland calanca et al 2016 in addition a modified version of modvege in which nitrogen and soil water components were included was validated with experimental data in uk ruelle et al 2018 therefore the model comparison presented in appendix d online supplementary material can also be seen as an indirect verification of the performance of dynagram moreover further support concerning the appropriateness of dynagram to simulate the dynamics of managed temperate grasslands comes from a comparison of model outputs and field measurements from the oensingen field experiment ammann et al 2020 conducted by moulin 2018 conclusion compared to structurally more complex grassland models we developed dynagram with few processes this resulted in a parsimonious and flexible model that permits describing grassland vegetation by any number of species or species groups the choice a minimalistic description of grassland dynamics allowed minimizing the computational requirements only a few seconds of computational time are needed to run a 10 year simulation on a standard personal computer however the simple structure of dynagram has limitations by considering only the green aboveground biomass and focusing on leaf functional traits we neglected belowground biomass dynamics roots and reserve organs and associated processes including processes involved in the nutrient cycling the lack of allocation strategies from the equations describing plant growth implies that the simulated green biomass of some species can be under or over represented moreover by assuming parameters lam α and rue max to be the same for all species specificity of potential growth function for each species only stands on the slai values vegetative reproduction plays a major role in mountain permanent grasslands largely dominated by perennial species perronne et al 2014 yet seed reproduction may be important especially in case of severe disturbances mcintyre et al 1995 omission of the processes governing seed bank dynamics in dynagram could be one of the reasons for the discrepancies between simulated and observed community composition despite these limitations we expect that dynagram can contribute to better understand the relationship between biodiversity and productivity and in turn the one between plant diversity and ecosystem services matching one of the challenges for grassland models identified by van oijen et al 2018 and kipling et al 2016 to date three approaches have been followed to incorporate diversity in grassland models 1 associate plant diversity to a constant or dynamic metric 2 considering assemblages of multiple species or plant functional types without an explicit formulation of competition and selection processes as in cosmo 3 representing multi species community dynamics based on an explicit formulation of resource competition and tolerance to stress and disturbance in this study we followed the latter strategy the formulation of dynagram complies with five out of six criteria given by taubert et al 2012 with respect to modeling of complex communities the criteria met by dynagram refer to 1 species richness 2 resource limitation light nutrients water 3 management practices mowing grazing fertilizing 4 model simplicity and 5 interspecific competition for resources to keep the model simple we did not comply with the sixth criterion which concerns the representation of belowground competition processes for the same reason we did not follow the individual based approach proposed by taubert et al 2012 which includes for a high number of species above and below ground intra and inter specific competition by explicitly modeling the dynamics of a key nutrient nitrogen and by describing plant community diversity with dedicated state variables dynagram provides answers to perspectives raised by confalonieri 2014 and jouven et al 2006b recently ruelle et al 2018 presented a very interesting refinement of modvege with a component describing soil resource dynamics and integrating plant growth into a spatially explicit structure the success of these last developments stresses the value of relatively simple models for advancing our understanding of how grasslands respond to management and environmental forcing finally the model described in this paper provides a promising basis for future work further developments of dynagram are already ongoing to address specific questions and practical problems such as for instance interactions between fossorial vole outbreaks and vegetation dynamics in the context of climate change credit author statement this document will be send when the paper will be accepted for publication without any credit of author statement you may please consider that all authors have contributed in equal way for this paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research takes place in the long term ecological research lter site jurassian arc http zaaj univ fcomte fr lang en which supports long term interdisciplinary research on the dynamics of mountain social ecological systems in the jura mountains our work will be integrated and will contribute to a wide range of activities coordinated by the national centre for climate services nccs https www nccs admin ch aiming at establishing a web based knowledge hub that supports climate smart decision making supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2020 109345 including four appendices appendix a full description of the dynamic grassland model dynagram appendix b model variables and parameters appendix c convergence of the system to a quasi periodic state appendix d comparison of community level dynagram and modvege outputs the r code used to perform the numerical integration of the dynagram model and to generate the figures of this article including supplementary figures in the online supplementary material are available online the code is divided in several scripts allowing the reader to reproduce all the exposed figures and is available at https github com fgillet3 dynagram appendix supplementary materials image application 1 image application 2 image application 3 image application 4 
24709,permanent grasslands host a high plant diversity which sustains many ecosystem services thus understanding how composition of the plant community responds to different management practices under given soil and climatic conditions is crucial for making best use of grasslands modeling approaches may be used to explain the manifold interactions involved to sustain this diversity we developed the dynamic process based ecological model dynagram to simulate the seasonal aboveground vegetation dynamics of semi natural grasslands the model allows specifying plant community by any number of species the predictive power of the model was assessed by simulating the dynamics of a virtual mountain grassland in response to four typical management scenarios under constant climatic conditions over several decades in our experiments we modelled an assemblage of seven species representing contrasted plant functional types we compared model outputs to compositions inferred from floristic records conducted in the french jura mountains irrespective of initial conditions the simulated community converged to four distinct compositions that primarily reflected management overall the results matched the functional composition inferred for each of the scenarios from the botanical records convergence in functional composition was reached in less than 15 years under grazing scenarios but not less than 50 years under mowing scenarios at quasi equilibrium the highest vegetation diversity was obtained for extensive grazing and the lowest for extensive mowing overall this study introduces a novel and relatively simple approach to model competition and adaptation processes in plant community dynamics thus providing a response to the key challenge of modeling multi species grasslands keywords grassland model hayfield interspecific competition pasture plant community dynamics process based model vegetation dynamics introduction semi natural permanent grasslands occupy a large fraction of european territories and are the milestone of agricultural practices in mountain areas gaujour et al 2012 these ecosystems are often hotspots of biodiversity sustaining many ecosystem services and facing various disturbances of anthropogenic or natural origin species composition and diversity of the grassland plant communities are strongly influenced by their current and past management myers et al 2000 while intensification or abandonment lead in many cases to severe reduction of plant diversity rosenthal 2010 van calster et al 2008 some temperate european grasslands managed for a long time with low intensity of mowing or grazing present the world record of species richness at fine scale wilson et al 2012 models developed in the past to simulate the dynamics of vegetation composition in grasslands have mostly targeted the landscape scale such as woodpam gillet 2008 peringer et al 2013 or the global scale such as lpjml rolinski et al 2018 rather than the field scale also grassland models published so far focused on monospecific swards duru et al 2009 mccall and bishop hurley 2003 schapendonk et al 1998 mixtures of a grass and a legume species lazzarotto et al 2009 thornley 1998 or a multispecies community constant in time jouven et al 2006a riedo et al 1998 lingra is a sink source model simulating the productivity of lolium perenne in european grasslands schapendonk et al 1998 lingra and modvege jouven et al 2006a focus on the productivity dynamics of the plant community whose composition is constant over time and described by one species or four functional types respectively taubert et al 2012 reviewed thirteen grassland models finding that only two described explicitly the plant community by more than three different species or functional types gras a succession compartment model siehoff et al 2011 and steppe a gap model of semiarid grasslands coffin and lauenroth 1990 however neither gras nor steppe simulate plant biomass in a recent review van oijen et al 2018 distinguished three categories of grassland models empirical integrated and process based the latter comprising ecological biogeochemical and agricultural models for all of them there is a need to incorporate biodiversity to in particular improve knowledge and predictions of the ecosystem services provided by permanent grasslands van oijen et al 2020 taubert et al 2012 concluded that in practice only two contrasted formalisms have been explored so far to predict changes in the composition of grassland plant communities following a gradient of complexity on one hand ecological grassland models characterized by elegant mathematics represent plant biomass or cover dynamics based on resource competition processes tilman 1980 1982 or tolerance to external disturbances such as gras siehoff et al 2011 on the other hand more complex spatially explicit individual based grassland models may include a high number of plant species or plant functional types pfts these models can consider above and below ground intra and inter specific competition among plant individuals or organs allowing simulations of metacommunities of many pfts typical examples are ibc grass weiss et al 2014 or ecohyd lohmann et al 2017 among other models falling into this category may et al 2009 soussana et al 2012 taubert et al 2012 to be able to simulate in detail the interactions between the soil the vegetation and the atmosphere biogeochemical models tend to be rich in parameters and variables van oijen et al 2018 complexity can be reduced by resorting to plant functional types in grassland models pfts are specified by combining parameters from a set of functionally related species such as legumes perennial grasses or erect forbs typically a pft is a group of species with similar functional traits and therefore similar responses to constraints and disturbances such as management practices and similar contributions to ecosystem services such as forage production graux et al 2016 in this context incorporating an explicit description of vegetation diversity multiplies the dimension of the parameter space leading to high complexity and models that could be difficult to control a possible solution is to consider re usable components that can be coupled with a single instance of a generic crop model to simulate explicitly seasonal changes in taxonomic and functional composition of managed grasslands this approach has been implemented in cosmo confalonieri 2014 movedi et al 2019 as summarized by moulin et al 2018 very few grassland models have been designed to simulate both composition and biomass changes in multispecies semi natural grasslands used as pastures or and hayfields a requirement for understanding diversity productivity stability relationships this gap has also been emphasized by kipling et al 2016 currently few process based models exist to explain or predict the intricacies of the relation between biodiversity productivity and the long term stability of the vegetation assemblage van oijen et al 2018 thus it appears crucial to develop a dynamic grassland model of that includes an explicit description of diversity and addresses both plant composition and biomass growth for various forms of land use following the generic approach allowing the inclusion of any level of diversity introduced by moulin et al 2018 the aim of this paper is to provide a comprehensive description of the dynamic grassland model dynagram and to explore its behavior under different management conditions one important choice for building dynagram was to restrict the ecophysiological description to essential processes in order to minimize the dimension of the parameter space hence to simplify species parameter estimations and to save computation time in this respect even if the purpose of dynagram appears very similar to that of cosmo the approaches are different as mentioned before cosmo requires to be coupled with a complex biogeochemical model to run vegetation simulations as opposed to this dynagram basically a mechanistic model of resource competition tilman 1980 is a stand alone solution it represents the regulation of green biomass and plant competition from the standpoint of resource dynamics but this approach is refined by integrating ecophysiological and biophysical details inherited from modvege jouven et al 2006a and soil processes from prograss lazzarotto et al 2009 a recent adaptation of modvege the moorepark st gilles grass growth model most gg has been developed in the context of irish pastures ruelle et al 2018 this dynamic model describes the daily grass growth for grazing systems at the paddock level including a spatially explicit structure and a soil nitrogen compartment these models have been validated with real data calanca et al 2016 and most gg is still the object of new developments ruelle et al 2018 in contrast to modvege most gg and gras siehoff et al 2011 which assume a constant plant community composition we integrated in dynagram a generic description of the vegetation as a set of any number of plant species or species groups pfts in a previous paper moulin et al 2018 we compared simulation results from alternative instances of a preliminary version of dynagram that only differ by the identity and number of state variables plant species or pfts describing the green biomass in the present paper we focus on a typical grassland plant community made of seven frequent and potentially dominant species representative of each pft observed in european mid mountain mesic grasslands we explore the response of the functional composition of this modelled plant community to various management scenarios under realistic climatic conditions the overarching goal of this paper is to present the model formalism and to discuss model behavior with selected simulation experiments that we conducted for illustrative purposes only in these experiments we address the following research questions 1 how are diversity and composition of the plant community affected by several years or decades of constant land use grazing or mowing and management intensity extensive or intensive 2 to what extent do management induced differences in the simulated plant community reflect differences in relative cover of species or pfts inferred from floristic records of mesic grasslands 3 how does the initial composition of the plant community influence its adaptation to management conditions 4 does the response time of the simulated community dynamics depend on management type and intensity methods model description dynagram is a mechanistic process based model for simulating the seasonal growth of the aboveground biomass and the seasonal course of the botanical composition in mixed temperate grasslands under various conditions of climate soil and management moulin et al 2018 it consists of three submodels with state variables table 1 and forcing variables connected as shown in fig 1 in this section we present the key assumptions and the main equations of the model a comprehensive description of dynagram is given in appendix a online supplementary material overview and main assumptions the climate submodel contains four forcing variables defined as the daily records of mean temperature t c precipitation p mm photosynthetic active radiation par mj m 2 and potential evapotranspiration pet mm the second submodel addresses grassland vegetation in terms of n state variables bi representing the green biomass of each species or pft i kg dm ha 1 as species and pfts are alternatives to the same variables the term species will be used hereafter to refer to either species or pfts plant growth and senescence are formulated in a similar manner as in the lingra model schapendonk et al 1998 with adaptations as implemented in modvege jouven et al 2006a plant growth is driven by radiation with interception depending on the leaf area index lai and limited by temperature soil water and radiation intensity senescence is a function of the age of the sward the lai is calculated diagnostically from the aboveground biomass the soil submodel contains three state variables two of them describe the amount of available soil resources namely mineral nitrogen nm kg n ha 1 and water reserve wr the third corresponds to a pool of soil organic nitrogen no kg n ha 1 supplied by the senescence of standing biomass and litter decomposition this soil organic nitrogen is mineralized to soluble mineral nitrogen nm nitrate or ammonium that becomes available for plant uptake according to the formulation used in prograss lazzarotto et al 2009 and introduced by previous authors kirschbaum 2000 paul et al 2003 schwinning et al 1999 this loop of consumption degradation of nitrogen implicitly present in three forms mineral in the soil solution organic in the soil and in the biomass is an important feature of dynagram as it directly supports interspecific resource competition overall the model consists of a non linear system of n 3 ordinary differential equations odes built under simplifying assumptions introduced to limit to a minimum the dimensions of the parameter space herbaceous vegetation is only described by green biomass mainly leaves thus implicitly excluding belowground biomass roots storage organs and the reproductive parts of the plants flowers fruits hence the model does not account for seed production and recruitment from the seedbank and for allocation strategies although maximal canopy height is taken into account to contrast mowing impact on species the model ignores the time dependent height distribution of plants assuming that the competition for light within the canopy only depends on the relative proportions of the leaf area index see below and considers a very simplified representation of the aging processes inherited from modvege moreover the model neglects symbiotic fixation of atmospheric nitrogen by legumes and denitrification in the soil plant biomass dynamics for a given species i green biomass dynamics is described by the following equations for clarity reason only the dependence on state and forcing variables is indicated 1 d b i d t g r i μ i s e n t m o w i b i g r a z i b i 2 g r i g r i b i p a r s e a t r r e d p a r n r e d i n m t r e d i t w r e d i w r p e t a r e d i where g r i expresses the actual growth rate of a given species i g r i b i p a r expresses potential growth as a function of standing biomass b i and photosynthetic active radiation p a r and s e a t is an empirical representation of the seasonal pattern of shoot growth jouven et al 2006a in addition r r e d n r e d i t r e d i w r e d i and a r e d i are the growth reducers associated with radiation soil mineral n availability temperature soil water status and cattle trampling respectively μ i s e n t is the seasonal sink associated with senescence m o w i b i and g r a z i b i are the biomass removal rates due to mowing and grazing respectively as in lingra and modvege potential growth is described by an ivlev function of the total leaf area index l a i t o t weighted according to the proportion of lai accounted for by the individual species thornley and johnson 1990 setting 3 l a i i b i s l a i b i 10 l a m 4 l a i t o t j 1 n l a i j b j we have 5 g r i b i p a r 10 p a r r u e max 1 exp α l a i t o t l a i i b i l a i t o t in eqs 3 to 5 r u e max is the maximum radiation use efficiency of the whole canopy α the extinction coefficient s l a i the specific leaf area of species i and l a m the percentage of laminae for the sake of simplicity and following modvege we assume the same values of lam α and rue max for all species the factor 10 in eq 5 ensures unit consistency growth limitation associated with soil mineral n availability is modelled as a holling type iii function 6 n r e d i n m n m 2 k i 2 n m 2 where k i is the half saturation term corresponding to the amount of mineral n resource for which the vegetation growth rate could reach half its maximum if the other resources are not limiting this parameter ki traduces for a given species i its nutrient requirement for its growth for the sake of compactness details concerning other reducers and functions involved in eqs 1 and 2 viz r r e d t r e d i w r e d i a r e d i s e a and sen can be found in appendix a online supplementary material the last two terms on the right hand side of eq 1 are the rates of defoliation associated with mowing and grazing both are modelled as pulse wise functions removal of aboveground biomass by mowing is assumed proportional to the standing green biomass of each species whereby the proportionality factor λ i also varies among species to account for differences in the vertical distribution of biomass λ i has been estimated according to the maximal canopy height hi of the given species i and a cutting height of 5 cm as expressed by λ i h i 0 05 h i 7 m o w i b i λ i b i the approach adopted to model removal of aboveground biomass by grazing is based on the assumption that each livestock unit consumes a predefined amount of biomass in such a way that the loss of biomass by each species depends on appetence ρ i and relative abundance of the species denoting by s d the stocking density expressed in adult bovine units per hectare abu ha 1 where 1 abu is equivalent to a dairy cow by κ the daily consumption of an adult bovine unit kg dm abu 1 d 1 and again assuming a holling type iii functional response we have 8 g r a z i b i κ s d ρ i b i 2 1 j 1 n ρ j b j 2 in the model growth competition among species occurs at different levels competition for light depends on laii eq 5 competition for nutrients on δi and ki eq 6 more details in appendix a online supplementary material in addition different responses to environmental constraints appendix a online supplementary material fig a 1 also provide advantages or disadvantages under specific conditions as well as impacts of moving and grazing eqs 7 and 8 soil nitrogen and water dynamics the dynamics of soil organic n n o soil mineral n n m and soil water reserve w r is described by the following differential equations 9 d n o d t i 1 n δ i c o μ i s e n t b i n d s d φ o θ t m i n t w m i n w r n o 10 d n m d t θ t m i n t w m i n w r n o n u s d φ m λ n m i 1 n δ i c m g r i b i p a r r r e d p a r n r e d i n m t r e d i t w r e d i w r p e t a r e d i s e a t 11 d w r d t p a e t b i w r p e t δ b i w r p e t p the first term on the right hand side of eq 9 represents the input of organic n through plant residues as determined by senescence the second is the input through dung deposition from grazing cattle the third the input by organic fertilizer and the last negative one the rate of mineralization as modulated by temperature and soil water availability the mineralization rate appears again in eq 10 with the opposite sign representing here an input of mineral n the second term on the right hand side of eq 10 is the input through urine deposition from grazing cattle the third the input from mineral n fertilizer the fourth the loss by leaching whereas the last one represents plant n uptake finally eq 11 gives the soil water budget as the difference between precipitation and evapotranspiration plus deep percolation eqs 9 and 10 follow the approach adopted in prograss lazzarotto et al 2009 whereas eq 11 is consistent with the solution implemented in modvege jouven et al 2006a details concerning the functions t m i n w m i n sen λ aet and δ can be found in appendix a online supplementary material community diversity to measure community diversity dynagram uses simpson evenness index that is inverse simpson diversity divided by the number of species n hill 1973 moulin et al 2018 12 e b 1 n i 1 n b i b t o t 2 1 where b t o t i 1 n b i is the total green biomass of the whole community parameterization dynagram includes 36 global parameters along with 9 n species specific parameters and n 3 initial condition values for state variables appendix b online supplementary material table b1 provides a complete list of the parameters including definition units default values and references we obtained values of the global parameters from literature in addition we estimated species parameters based on various sources see appendix a online supplementary material numerical integration we implemented dynagram in r language r core team 2020 we numerically solved the ode system with the function ode in the r package desolve soetaert et al 2010 using the euler method and an integration time step of one day the appropriateness of the time step was verified by comparing standard outputs with those obtained from running the model with a smaller time step the pertinence of the numerical solution scheme was further tested by replacing ode with the function lsoda in the same r package the latter being an ode solver that automatically switches between stiff and non stiff methods no sensible difference in the solution was detected however the choice of a discrete time integration method euler solver with dt 1 can lead to negative biomass values after defoliation events to prevent the inadvertent definitive loss of species we introduced a minimal residual amount of biomass remaining after any disturbance b m i n 1 5 kg dm ha 1 model variables and parameters to show the model ability to capture the response of grassland communities to management practices we considered a fictitious grassland illustrative of european mountain pastures and hayfields this theoretical grassland does not correspond to a real specific site but vegetation climate soil and land use have been specified to be characteristic to those commonly observed in the pontarlier region french jura mountains at 900 m a s l elevation in this region permanent grasslands represent a large fraction of the agricultural area they are extensively to intensively managed to sustain dairy farming for pdo cheese production mauchamp et al 2014 we retrieved climatic data for pontarlier from the e obs v19 0e database cornes et al 2018 we selected within this climatic time series covering the period 1981 to 2018 the year 2004 to be representative of the climatic conditions in this area we designed the climate forcing variables as repetitions of the daily records for this standard year 2004 it results that interannual variation of weather conditions is neglected in this study to avoid confounding effects of specific years on the response of vegetation to management scenarios however the considered climate forcing variables impact the seasonal dynamics of the state variables soil properties are controlled by five parameters in the model initial amount of mineral and organic n maximal mineralization rate θ and levels of the permanent wilting point pwp and the water holding capacity whc values were estimated from the soil atlas of europe european soil bureau network 2005 and maps of indicators of soil hydraulic properties for europe european soil data centre 2016 soil parameter values are given in appendix b online supplementary material table b1 anthropogenic disturbances were modelled by four agricultural management scenarios typical of the french jura mountains differing by the type of defoliation and by the intensity of agricultural practices including fertilization extensive or intensive grazing and extensive or intensive mowing table 2 based on a theoretical assessment of the impact on dynagram simulations of the number of state variables describing the vegetation moulin et al 2018 we chose n 7 state variables to describe the plant community corresponding to seven pfts we considered the four pfts of grasses cruz et al 2002 duru et al 2009 built on plant functional traits for nutrient acquisition and tolerance to defoliation pft a corresponds to early and fast growing grasses in fertile and frequently disturbed grasslands whereas at the opposite pft d describes late and slow growing grasses in infertile and unfrequently disturbed grasslands we added three lifeforms of dicots tall erect forbs e small rosette and creeping forbs r and legumes l then to specify values for each of the nine species specific parameters table 3 we selected a single representative species for each of the seven pfts among the most frequent and abundant species in the pontarlier region according to previous botanical surveys perronne et al 2014 details on the estimation of values for the species specific parameters are available in appendix a online supplementary material this selection of seven species represents a wide diversity of life strategies as evidenced by their distribution in the csr triangle shown in fig 2 grime 1977 pierce et al 2017 the community dynamics simulated by dynagram is explained by tradeoffs among the three life strategies of grime 1977 a competitive ability c leading to high potential growth gri function of sla i the tolerance to a stress on resources s mainly determined by nredi function of ki or wredi function of ηi and a resistance to defoliation events r driven by ρ i σ i and λ i numerical experiments two numerical experiments were performed with dynagram they illustrate the potential application of the model and should be considered as a proof of concept of the proposed approach rather than a model validation the results of a third one related to the comparison of dynagram and modvege is available in appendix d online supplementary material impact of management on community composition effects of management practices on the simulated botanical composition research question 1 were assessed by simulations under the four management scenarios described in table 2 starting from the same initial composition we defined the latter by an even distribution of all species seasonal biomass dynamics at final state was obtained after a repetition of the same management scheme and the same seasonal weather conditions for the year 2004 over twenty years for extensive grazing and intensive mowing management we also compared the seasonal dynamics of the four plant growth reducers introduced in eq 1 reducer values were computed at the community level by averaging the seven species values weighted by their relative biomass because soil organic nitrogen showed a very slow dynamics fig c2 online supplementary material appendix c the whole system would require a very long simulation time to reach equilibrium however we expect community composition to reach more rapidly a quasi stable state characterized by very low variations simulated in the community structure due to its faster dynamics to check this we complemented this first experiment by an analysis for each of the four management regimes of the convergence time necessary to reach a community structure close to the cyclic attractor thus we introduced a measure of stability by comparing a synthetic index of community diversity simpson evenness eb between successive years for each julian day t we computed relative differences as the ratio e b t e b t 365 e b t 365 mean year to year changes were computed for the vegetation period i e from april 1 to september 30 over 100 years to assess the realism of the simulated functional composition research question 2 we compared model simulation outputs to observed data in the selected case study area we extracted from phytobase a phytosociological database gillet 2015 68 floristic relevés of permanent grasslands sampled at 800 900 m a s l elevation in the french jura mountains i e under the climatic conditions close to those at pontarlier we classified the relevés into four management categories deduced from their phytosociological classification ferrez et al 2011 gentiano luteae cynosuretum cristati was assigned to extensive grazing 9 relevés lolio perennis plantaginetum majoris lolio perennis cynosuretum cristati and alchemillo monticolae cynosuretum cristati to intensive grazing 13 relevés euphorbio brittingeri trisetetum flavescentis to extensive mowing 18 relevés and alchemillo monticolae brometum hordeacei to intensive mowing 28 relevés these 68 floristic relevés of mesic permanent grasslands have been recorded at different sites seasons and years each of the observed 195 species was assigned to a pft and we computed the mean relative cover of each pft in each management category in addition we compared the relative cover of the seven species selected in the model simulations among the four management categories thus we obtained two representations of the observed functional composition in response to four contrasted land use types directly comparable to previous dynagram simulation outputs sensitivity to initial conditions in a second simulation experiment we assessed the impact of the initial community composition on vegetation dynamics under contrasted management practices research question 3 for this purpose we performed an analysis of the model sensitivity to the initial quantitative composition of the plant community by varying the relative proportion of each species at the beginning of each simulation the 1st of january at year 1 eight initial compositions were considered seven of them were defined by a strong dominance half of the initial total biomass of each one of the species in turn the last one was built from an even distribution of all species as in our first experiment sensitivity to the eight initial conditions were assessed under the four contrasted management scenarios described in table 2 repeated every year identical soil and climatic conditions were considered for all these simulations as explained above in section 2 2 we compared the simulated compositions obtained respectively at years 10 and 50 by representing mean biomass values of each species within the vegetation period from april 1 to september 30 then to address the question of the impact of management on the convergence time research question 4 a 100 year time horizon was considered assuming for a given practice that all initial assemblages converge to the same final state we summarized each community structure by its simpson evenness we compared time series of mean and standard deviation of the simpson evenness obtained from the eight initial community structures under the four management scenarios within the vegetation period results impact of management on community composition markedly distinct community patterns emerged after 20 year simulations for the four management scenarios fig 3 despite the same initial conditions in all four cases this result indicates that the simulated community composition was strongly influenced by management both in term of intensity and type of defoliation it highlights the ability of dynagram to express the chief influence of management practices on community dynamics as extensive grazing and intensive mowing resulted in very contrasted biomass and community patterns fig 3a and 3d we chose these two management scenarios to show how they differ in terms of seasonal change of the weighted mean stress reducers and disturbance defoliation factors figs 4 a and 4b and net growth rates of the different pfts figs 4c and 4d dominance of species in fig 3 resulted inherently from high actual growth rates in figs 4c and 4d nitrogen availability played a key role among the limiting factors fig 4a and b in contrast to limitations associated with temperature and water which did not differ between the two management scenarios thus the sigmoid holling iii functional response appears as a key function in our model to describe competition for limiting resources among species and to explain the observed shift of dominant species with land use intensification this function explains how the shortage in mineral n resource affects negatively the growth rate of each species as each unit of biomass produced requires the consumption of a certain amount of mineral n the dependence on nm in eq 6 along with differences in the value of the half saturation constant k i explain how species compete and share the resource once it becomes limiting under intensive mowing fertilization can prevent mineral n stress leading to values of nred close to 1 for all species in summer fig 4b nevertheless mineral fertilization led to higher total biomass values associated with a dominance of the competitive and productive pfts a b and r fig 3b and 3d alleviation of nutrient stress following each fertilization event fig 4b hence favored the growth of pfts a b and r fig 4d higher sla values provided an additional competitive advantage to pfts b and r under high nutrient availability table 3 extensive management scenarios led to a dominance of pfts c and d as expected for grasslands established in poor environments and subject to low defoliation intensity fig 3a and 3c the highest diversity was reached under extensive grazing corresponding to an intermediate level of disturbance when comparing the two grazing regimes the higher total biomass simulated in spring under intensive grazing fig 3b may be explained by the first fertilization event that restricted effects of the nutrient reducer in this circumstance the overall net growth rate in spring was higher than the daily forage consumption by cattle κ sd fig 4c the opposite process occurred in summer with forage consumption higher than biomass production leading at the end of the grazing period to a standing biomass twice as low for the intensive than the extensive scenario in the model simulations time to convergence to a quasi periodic state from a given initial community structure was primarily determined by the land use type grazing or mowing and only secondarily by the intensity of the management practices fig 5 for both grazing scenarios the interannual rate of change of the diversity index decreased to below 0 1 within 20 simulation years by contrast under extensive and intensive mowing the rate of change of the diversity index increased to a maximum between 20 and 25 years before decreasing to less than 0 1 only after 40 or 50 years the rate of change after 100 simulation years remained slightly higher for the intensive than for the extensive management scenarios whatever the landuse type this was due to the slow accumulation of organic nitrogen in the soil in case of intensive fertilization which caused a slow but continuous adaptation of the plant community even after many decades in addition to these differences among management scenarios the system dynamics was characterized by i transient patterns with relatively high interannual rate of change rate of change 0 5 in the short term 5 years ii a quasi periodic state with an interannual rate of change 0 1 in the medium term 50 years and iii an asymptotic cyclic state in the long term more than 250 years not shown a thorough investigation of interannual changes in the system is provided in appendix c online supplementary material the comparison of model outputs to expected species or functional compositions revealed in spite of obvious divergences in the details common overall features fig 6 pfts a b and r showed higher relative biomass or cover in intensive than in extensive pastures and meadows at the expense of c and d which are stress tolerant but less competitive in fertile and frequently disturbed grasslands extensive grazing was the best management practice to sustain the coexistence of all pfts at long term among grass species pft a e g lolium perenne was favored by intensive grazing pft b e g poa trivialis by intensive mowing and pft c e g trisetum flavescens by extensive mowing differences between simulated and expected composition were due partly 1 to the uncertainty of the management conditions deduced from the typology of the observed vegetation and 2 to the heterogeneity of response to management type and intensity among species of each pft deviations were pronounced in particular in relation to the relative cover of legumes trifolium pratense in fig 6b or all species of pft l in fig 6c and erect forbs ranunculus acris in fig 6b or all species of pft e in fig 6c grasses belonging to pft d disappeared in simulated intensive grazing and extensive mowing scenarios fig 6a but not in intensive pastures and extensive hayfields fig 6c this was due to the choice of deschampsia cespitosa as representative species for pft d this species being relatively rare in mesic managed grasslands but dominant in wet abandoned grasslands fig 6b other species belonging to this pft d were more frequently observed such as cynosurus cristatus a diagnostic species of extensive pastures nicod et al 2019 this could explain an under representation of the pft d in fig 6b model sensitivity to initial conditions after ten years of any grazing regime extensive or intensive all assemblages converged to a same composition fig 7 b regardless of initial community structures fig 7a by contrast under any mowing regime extensive or intensive the initial composition was still reflected in the plant community after 10 years of simulation fig 7b more specifically for a sward initially dominated by one of the three pfts a b or r assemblages s1 s2 and s6 which we identified as codominant in the long term for an intensive mowing management scenario fig 3d the state after 10 years was still transient the latter was characterized by significantly higher values of the relative biomass of each of these pfts than specified in the initial conditions fig 7b a similar behavior was observed for the extensive mowing scenario where an initial dominance of the pfts c or l assemblages s3 and s7 led after 10 years to an over representation of these pfts fig 7b after 50 years of simulation most differences vanished except for assemblage s7 under extensive mowing higher biomass of trifolium pratense and for s1 higher biomass of lolium perenne s2 larger dominance of poa trivialis and s6 higher biomass of taraxacum officinale under intensive mowing fig 7c the total green biomass averaged over the vegetation period was only slightly affected by the initial composition with comparably low values under mowing than under grazing after 50 years as all eight initial community assemblages tended to converge to a single final state fig 7 we used simpson evenness eb as a synthetic descriptor of community diversity to compare convergence dynamics the standard deviation of eb values obtained for each management scenario was used to show when the impact of these initial structures on transient community diversity were vanishing fig 8 as assemblages s1 to s7 described a same uneven pft diversity pattern they presented an equal initial evenness eb 0 49 assemblage s8 was built from a perfectly even pft distribution corresponding to a maximal initial evenness eb 1 under both grazing management scenarios plant community converged rapidly 10 years toward a same composition vanishing standard deviation of the simpson evenness eventually this diversity index remained constant for extensive grazing and tended to slightly decrease for intensive grazing likely due to the previously mentioned slow increase in soil organic nitrogen in contrast the simulation time required for convergence from various initial species distributions under mowing was considerably longer 50 years convergence was fully achieved after 65 years for the extensive mowing scenario but only at the end of the simulation period 100 years for the intensive mowing scenario despite low differences in eb values among the eight community structures being as it is this result nevertheless confirms that under constant climate forcing all assemblages explored for a given management converged to the same final seasonal pattern from a theoretical perspective this guarantees the independence of the equilibrium state from initial community composition in addition after 100 years of simulation the simpson evenness values obtained for extensive grazing were more than twice higher as those found with intensive mowing interestingly this final diversity index was higher for extensive than for intensive grazing but was lower for extensive than for intensive mowing discussion with dynagram we introduce a relatively simple modeling solution to include the key notion of community dynamics in grassland models by defining a generic structure in which interspecific interactions rely on resource competition and life strategies another approach has been proposed with the cosmo module by confalonieri 2014 cosmo can coupled to any biogeochemical crop model providing means for incorporating biodiversity in grassland models cosmo has been recently validated with experimental data movedi et al 2019 however the absence of state variables to describe the herbaceous species prevents the model to explicitly reproduce the competition within the assemblage a point that we tackled with dynagram the results support our strategy of choosing a common formulation of growth for all species and indicate that the formulation of a potential growth reduced by environmental limitations introduced by schapendonk et al 1998 can provide realistic simulations they also highlight the model capacity to predict a multi species sward dynamics with a composition substantially explained by land use fig 3 the latter having been identified as an important driver of biodiversity by botkin et al 2007 and van calster et al 2008 addressing the research question 1 by comparing impacts of contrasted management scenarios we highlight the importance of soil nutrient availability in determining the seasonal community pattern fig 4 the latter showed a clear response to grassland management type and intensity which was eventually reflected in contrasting values of the nutrient reducer term nred this finding is in agreement with results obtained with the prograss model lazzarotto et al 2009 we examined the realism of the simulated community dynamics in terms of taxonomic and functional composition due to the difficulty to access repeated measurements of green biomass for individual species in semi natural permanent grasslands we relied on floristic relevés from a phytosociological database gillet 2015 and a phytosociological classification ferrez et al 2011 to define typical grassland compositions for management categories comparable to those defined in our four scenarios it turns out that a fine tuning of some uncertain species specific parameters was required to get simulation results close to observed vegetation structures after that dynagram was able to reflect management induced differences in relative cover or pfts research question 2 regardless of the management scenario the initial composition of the plant community had a small impact on the long term functional composition research question 3 confirming the key role of land use type and intensity and complementing the answer to research question 1 however simulations revealed that in the short to medium term the diversity of the plant community was far more sensitive to the initial composition under mowing than under grazing management fig 7 moreover starting from an even initial species distribution the interannual rate of change of simpson evenness peaked between 20 and 25 years in case of extensive or intensive mowing contrasting the relatively fast decline under the grazing scenarios fig 5 the faster stabilization of functional composition and diversity predicted for grazing suggests that pastures could be more stable than hay meadows on the other hand management intensity had only a minor impact on the convergence speed our results suggest that response time of the simulated community dynamics is more affected by the management type than by its intensity answering to our last research question 4 the time required for the community to reach a quasi periodic state ranged from 10 to more than 50 years that is much longer than the twelve months reported for other process based grassland models e g confalonieri 2014 higher diversity levels considered in this study implying a higher number of complex interactions among species could explain the longer time required in dynagram to stabilize the composition the ode system at the core of dynagram is highly non linear with many influences of the state variables on the dynamics of each other as highlighted by eq 5 growth rate of one pft i depends directly on its biomass bi but also of the biomass of the n 1 other pfts which impact i its potential growth according to the relative contribution of laii to laitot and ii the available mineral n which is necessarily consumed to produce any amount of biomass bi as shown in eqs 6 and 10 whatever the initial composition the model predicts that extensive grazing maximizes community diversity highest values of the evenness index eb in the long term whereas extensive mowing results in the lowest evenness fig 8 this is in accordance with the observation that grazing tends to be more beneficial to biodiversity than mowing tälle et al 2016 this result also matches the expectations of the intermediate disturbance hypothesis dengler et al 2014 siehoff et al 2011 under an extensive grazing management the absence of fertilization of mineral or organic origin prevents competitive exclusion while the low level of defoliation allows an even coexistence of all functional types in the plant community defoliations could thus explain the long term coexistence of more species than expected from the availability of essential resources contrary to the predictions of the tradeoff based niche theory rooted on a simple resource reduction competition model tilman 1980 as stressed in the model description section 2 in terms of model formalism dynagram inherited many of the approaches implemented in modvege with respect to growth a comparison of dynagram and modvege at the community level is provided in appendix d online supplementary material results showed the capacity of dynagram to simulate accurately the seasonal dynamics of herbage growth and standing biomass even after relaxing the assumptions of constant species composition and constant nutrient availability implicit in modvege fig d1 this implies that dynagram is able to capture key mechanisms of forage production defined by jouven et al 2006a modvege has been validated with respect to field observations from massif central france jouven et al 2006b the jura mountains and the swiss central plateau switzerland calanca et al 2016 in addition a modified version of modvege in which nitrogen and soil water components were included was validated with experimental data in uk ruelle et al 2018 therefore the model comparison presented in appendix d online supplementary material can also be seen as an indirect verification of the performance of dynagram moreover further support concerning the appropriateness of dynagram to simulate the dynamics of managed temperate grasslands comes from a comparison of model outputs and field measurements from the oensingen field experiment ammann et al 2020 conducted by moulin 2018 conclusion compared to structurally more complex grassland models we developed dynagram with few processes this resulted in a parsimonious and flexible model that permits describing grassland vegetation by any number of species or species groups the choice a minimalistic description of grassland dynamics allowed minimizing the computational requirements only a few seconds of computational time are needed to run a 10 year simulation on a standard personal computer however the simple structure of dynagram has limitations by considering only the green aboveground biomass and focusing on leaf functional traits we neglected belowground biomass dynamics roots and reserve organs and associated processes including processes involved in the nutrient cycling the lack of allocation strategies from the equations describing plant growth implies that the simulated green biomass of some species can be under or over represented moreover by assuming parameters lam α and rue max to be the same for all species specificity of potential growth function for each species only stands on the slai values vegetative reproduction plays a major role in mountain permanent grasslands largely dominated by perennial species perronne et al 2014 yet seed reproduction may be important especially in case of severe disturbances mcintyre et al 1995 omission of the processes governing seed bank dynamics in dynagram could be one of the reasons for the discrepancies between simulated and observed community composition despite these limitations we expect that dynagram can contribute to better understand the relationship between biodiversity and productivity and in turn the one between plant diversity and ecosystem services matching one of the challenges for grassland models identified by van oijen et al 2018 and kipling et al 2016 to date three approaches have been followed to incorporate diversity in grassland models 1 associate plant diversity to a constant or dynamic metric 2 considering assemblages of multiple species or plant functional types without an explicit formulation of competition and selection processes as in cosmo 3 representing multi species community dynamics based on an explicit formulation of resource competition and tolerance to stress and disturbance in this study we followed the latter strategy the formulation of dynagram complies with five out of six criteria given by taubert et al 2012 with respect to modeling of complex communities the criteria met by dynagram refer to 1 species richness 2 resource limitation light nutrients water 3 management practices mowing grazing fertilizing 4 model simplicity and 5 interspecific competition for resources to keep the model simple we did not comply with the sixth criterion which concerns the representation of belowground competition processes for the same reason we did not follow the individual based approach proposed by taubert et al 2012 which includes for a high number of species above and below ground intra and inter specific competition by explicitly modeling the dynamics of a key nutrient nitrogen and by describing plant community diversity with dedicated state variables dynagram provides answers to perspectives raised by confalonieri 2014 and jouven et al 2006b recently ruelle et al 2018 presented a very interesting refinement of modvege with a component describing soil resource dynamics and integrating plant growth into a spatially explicit structure the success of these last developments stresses the value of relatively simple models for advancing our understanding of how grasslands respond to management and environmental forcing finally the model described in this paper provides a promising basis for future work further developments of dynagram are already ongoing to address specific questions and practical problems such as for instance interactions between fossorial vole outbreaks and vegetation dynamics in the context of climate change credit author statement this document will be send when the paper will be accepted for publication without any credit of author statement you may please consider that all authors have contributed in equal way for this paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research takes place in the long term ecological research lter site jurassian arc http zaaj univ fcomte fr lang en which supports long term interdisciplinary research on the dynamics of mountain social ecological systems in the jura mountains our work will be integrated and will contribute to a wide range of activities coordinated by the national centre for climate services nccs https www nccs admin ch aiming at establishing a web based knowledge hub that supports climate smart decision making supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2020 109345 including four appendices appendix a full description of the dynamic grassland model dynagram appendix b model variables and parameters appendix c convergence of the system to a quasi periodic state appendix d comparison of community level dynagram and modvege outputs the r code used to perform the numerical integration of the dynagram model and to generate the figures of this article including supplementary figures in the online supplementary material are available online the code is divided in several scripts allowing the reader to reproduce all the exposed figures and is available at https github com fgillet3 dynagram appendix supplementary materials image application 1 image application 2 image application 3 image application 4 
