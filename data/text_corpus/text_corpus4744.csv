index,text
23720,the paper presents analysis of displacement of a propulsion system shaft line and a crankshaft axis caused by temperature of marine slow speed main engine detailed information of thermal displacement of a power transmission system axis is significant during a shaft line alignment and a crankshaft springing analysis and during designing of structural health monitoring shm system a warmed up main engine is a source of deformations of an engine body as well as a ship hull in the area of an engine room and hence axis of a crankshaft and a shaft line engines producers recommend the model of parallel displacement of the crankshaft axis under the influence of an engine heat this model may be too simple in some cases especially for shm systems the paper presents computations of man b w k98mc type engine mounted on 3000 teu container ship the engine body is much stiffer than its foundation pads and ship hull double bottom boundary conditions of the engine especially for the high power marine engines correct model of the boundary conditions plays a key role during the analyses presented numerical analyses are based on temperature measurements of the main engine body and the ship hull during a sea voyage numerical analyses were performed using nastran software based on finite element method the fem model of the engine body comprised over 800 thousand degree of freedom dof the model of the ship hull contains over 200 thousand dof both models are analysed separately the mutually interaction between them is taken into account by heat transfer and special model of boundary conditions the specialized shm system dedicated to marine propulsion systems working in very bad environmental conditions is the future aim of the research keywords thermal deformations propulsion system power transmission system shaft line alignment crankshaft springing boundary conditions of propulsion system 1 introduction reliability of a marine propulsion system is closely correlated with the safety of navigation at sea two stroke slow speed main engines have been installed mostly on merchant ships since the late 70s the engines are connected to a directly driven propeller by a relatively short shaft line murawski 2003 in that propulsion systems there are no gears or flexible couplings structural health monitoring systems of the power transmission system is one of the main ways for improving safety at sea especially reliable shm systems working in heavy sea state need detailed data and characteristics of the propulsion system power transmission system crankshaft plus shaft line is loaded by strongly unsymmetrical perpendicular forces especially stern tube bearing is loaded by very heavy propeller only from one side proper shaft line alignment and crankshaft springing are one of the most important parameters during marine propulsion system reliability evaluation shaft line alignment consist in appropriate bearings moving usually vertical with the aim of its proper loads crankshaft springing is a standard method of checking loads of engine main bearings the crank deformation is measured during slow crankshaft revolution with a turning gear usage shaft line alignment is closely related with crankshaft springing during the shaft line alignment and crankshaft springing analyses knowledge of the thermal displacement of the crankshaft axis is essential murawski 2016 engines producers suggest the model of crankshaft axis thermal displacement but it is very simple they recommend the model of parallel displacement of a crankshaft axis under the influence of engine heat such a model gives us one number a value of crankshaft displacement between cold and hot propulsion system in steady state condition different for each type of an engine sometimes the displacement value is depended on the temperature difference between not running and running propulsion system in such a case the model might be too simple couplings between thermal in some cases with influence of electromagnetic field and mechanical loads of a marine propulsion system are very complicated and cannot be omitted during analyses of a main engine mounting song and moon 2016 problems with shaft line alignment and crankshaft springing are befalling especially for high powered engine mounted on optimised light with elastic hull ships fontea et al 2015 simm et al 2016 yang et al 2011 practically a relatively simple model of the thermal mechanical coupling is sufficient the engine temperature is a source of its body main bearings and crankshaft and ship hull displacement there s no need to take into account the full coupling effects occur with big elastic plastic deformations with high temperature between deformation and temperature fields because the temperature level is relatively low the temperature of the main engine body is less than 70 c see fig 8 and ship hull has no more than 42 c see table 2 similarly material steel properties was assumed as constant owing to low temperature level more important is mutual interaction between the engine body and the ship hull the heat transfer is a source of the ship hull deformation especially in the engine room area and the hull deformation is a source of added deformation of the engine body finally the displacements are a source of additional mechanical loads of propulsion system s bearings and can be measured by the shm system the target of the presented analyses is evaluation of displacements of the crankshaft and shaft line axis in the propulsion system s multiple and steady state thermal working conditions germanisher lloyd 2012 american bureau of shipping 2004 det norske veritas 2013 the hull deflections caused by buoyancy can be omitted because final shaft line alignment has to be done after ship launching still water case sea waves and ship loading condition cargo have also an influence on shaft line alignment and crankshaft springing but their characteristics and type of influence is different those problems have been discussed in other author s work murawski 2003 2005a up to now in the shaft line alignment and crankshaft springing analyses methodology an interaction of the crankshaft and shaft line was analysed in a simplified way murawski 2005a the crankshaft displacements were modelled due to working temperature and its foundation stiffness those data were evaluated based on a simple data supplied by the producer the data did not address the type of the ship boundary conditions on which the engine is mounted im et al 2017 man b w diesel a s 1995 a better mathematical model of the boundary conditions of the marine power transmission system is the aim of presented research in the literature there may be found numerous examples of the damage of the first three counting from the driving end main bearings of the main engine fontea et al 2015 man b w diesel a s 2012 one of the causes might be the imprecise mathematical model of a crankshaft proposed for the shaft line alignment analysis there have been carried out a number of analyses of man b w k98mc type engine mounted on a 3000 teu container ship marine power transmission systems are usually modelled as isolated from ship hull and engine body andersen and jensen 2014 iijima et al 2008 murawski and charchalis 2014 senjanović et al 2014a there are several reasons for this methodology difficulties with the proper oil film calculation reynolds s equation and the need for a detailed crankshaft an engine body and a ship hull fem model are one of the most important this methodology separately computation of ship hull and engine was applied in the analyses the computation of the engine s body deformation due to the gravity and its natural eigenvectors has been performed as well as the analysis of its thermal deformation in nominal work conditions also the computation of the ship hull eigenvectors and local stiffness has been performed as well as the analysis of its thermal deformation with special emphasis on main engine room area the ship hull static and dynamic stiffness characteristics were used for proper modelling the engine boundary conditions natural vibrations eigenvectors analyses were performed for checking models consistency the thermal analyses require an accurate temperature distribution on the engine s body and also on the ship hull for checking numerical calculations wide temperature measurements on the ship and her main engine supplied the proper data the temperature measurements were performed during a sea voyage 2 analysis methodology all analyses were performed on the base of finite element method zienkiewicz and taylor 2000 the finite element method is a numerical technique that gives approximate solutions to differential equations that model problems arising in physics and engineering as in simple finite difference schemes the finite element method requires a problem defined in geometrical space or domain to be subdivided into a finite number of smaller regions a mesh in finite elements each subdivision is unique and need not be orthogonal for example triangles or quadrilaterals can be used in two dimensions and tetrahedra or hexahedra in three dimensions over each finite element the unknown variables e g temperature velocity etc are approximated using known functions these functions can be linear or higher order polynomial expansions in terms of the geometrical locations nodes used to define the finite element shape the governing equations in the finite element method are integrated over each finite element and the contributions summed over the entire problem domain as a consequence of this procedure a set of finite linear equations is obtained in terms of the set of unknown parameters over the elements solutions of these equations are achieved using linear algebra techniques eight steps of the fem calculation can be distinguished discretize and select the element types select a displacement function define the strain displacement and stress strain relationships in the case of one dimensional deformation in the x direction we have strain ε x related to displacement u described by 1 ε x d u d x equation 1 applies to small strains in addition the stresses must be related to the strains through the stress strain law generally called the constitutive law the ability to define the material behavior accurately is most important in obtaining acceptable results the simplest of stress strain laws hooke s law which is often used in stress analysis has the form 2 σ x e ε x where σ x is the stress in the x direction and e is the modulus of elasticity derive the element stiffness matrix and equations assemble the element equations to obtain the global or total equations and introduce boundary conditions in this step the individual element nodal equilibrium equations are generated after that the characteristic matrix of finite elements is assembled into the global nodal equilibrium equations the implication of the direct stiffness method is the concept of continuity or compatibility which requires that the structure remains together the finally assembled global equation for dynamic problems is written in matrix form as follows 3 m u c u k u f where f is the force vector k is the stiffness matrix u is the displacement vector c is the damping matrix and m is the mass matrix solve for the unknown degrees of freedom equation 3 can be simplified to static strength analyses by expunction of elements with acceleration vector mass matrix and speed vector damping matrix simplified equation modiﬁed by the boundary conditions limits of some of the displacements is a set of simultaneous algebraic equations that can be written in expanded matrix form as follows 4 f 1 f 2 f 3 f 4 f n k 11 k 21 k 12 k 22 k 1 n k 2 n k n 1 k n 2 k n n u 1 u 2 u 3 u 4 u n solve for the element strains and stresses interpretation of the results msc software s computer programs patran nastran were used for modelling and numerical calculations during the analyses two quasi independent models were investigated a ship hull with a simplified main engine body or without engine for thermal analysis is the first one the second one detailed main engine body with a simplified model of ship hull stiffness there are several reasons for the models separation murawski 2005a 2005b two relatively big models 800 200 thousand dof are difficult to connect what is more detailedness of the dimensionally biggest model a ship hull may be smaller in comparison to a more complicated engine body another significant reason for the model separation is nonlinear foundation pads which are the connection between a ship hull engine steel foundation and an engine body the assumed model of heat propagation is different in the engine body and the ship hull analyses song et al 2016 the fem model of a 3000 teu twenty foot container equivalent unit container ship with detailed view of an engine room is presented in fig 1 the model is built mainly with using 4 nodes shell elements but the main stiffeners were modelled as 1 d beam elements the model with the local stiffeners modelled by beam elements would be too big for dynamic analyses the stiffnesses of local stiffeners were modelled by changing the material data of surrounded plates the substitutive plate with changed material into orthotropic has the same stiffnesses in all directions as real plate with local stiffener influence of water interaction on the ship hull is unskippable malenica et al 2013 senjanović et al 2014b bidikli et al 2017 the finite elements named acoustic elements are the best method in the nastran software for modelling added water mass during structure vibration analyses the approach used in this analysis is called the pressure method which is analogous to the displacement method in structural analysis except that pressures instead of displacements are computed at the fluid points the velocities and accelerations of the fluid points are analogous to forces in structural analysis the interface between the fluid and the structure may be modelled so that the grid points of the fluid are coincident with those of the structure this is called a matching mesh if not then it is called a nonmatching mesh in either case and by default coupling for the stiffness and mass is automatically computed nonstructural masses of the ship structure are mostly modelled by changing mass densities the containers are modelled as flexible cuboids with appropriate mass connected with ship hull by multi point constraint mpc elements the basic idea of using mpc is to create a set of mpc equations that gives the relation between the dofs of the two separated nodes it assumes that the two corner nodes are connected by a rigid body the fem model of the ship hull has over 200 thousands degrees of freedom the fem model of the 7 b w k98mc engine s body with detailed view of a main bearings foundation is presented in fig 2 foundation of a crankshaft in the main bearings is the most important region in the presented type of analyses the fem model of main bearings is realised by 3 d solid elements 8 nodes other part of an engine body is modelled by 4 nodes plate elements the fem model of the engine body has over 800 thousands degrees of freedom correctness accuracy and consistency of both models were checked by normal modes eigenvalues analyses in the paper the si standard unit is compulsory e g m pa the analysis consists of the following steps ship hull stiffnesses determination with particular focus on foundations of the propulsion system preparation of simplified models of stiffnesses of a ship hull in order to use them in engine body calculations verification of a ship hull simplified models by dynamic analyses of an engine body with different boundary conditions determination of thermal deformation of an engine body with selected boundary conditions performed on the base of measured temperature distribution determination of a ship hull deformation with special emphasis on propulsion system foundation performed on the base of steady state transient thermal coming from an engine body analysis repeated calculations of thermal deformation of an engine body carried out on the base of more detailed boundary conditions taking into account thermal deformation of a ship hull in an engine room area 3 stiffnesses of a ship hull a ship hull often modelled as beam is usually less stiff than a propulsion system therefore determination of ship hull stiffness in the area of propulsion plant room is very important it should be used as boundary conditions for different analyse of a propulsion system natural frequencies and modes determination is the first step of the analyses the main target of that kind of analysis is checking model coherence see chapter 2 in the author s opinion nearly each fem model even made up for a static type analysis should be checked by natural modes analysis it can be done only for the models with finite elements that have a full stiffness matrix including bending stiffnesses e g beam instead rod element due to ship hull elasticity and dimensions the lowest natural frequency is around 1 5 hz for the analysed type of ship the main excitations are inducted by a propeller 5 blades and by a main engine 7 cylinders the nominal engine speed is equal to 94 rpm therefore main excitations frequencies are equal to 7 83 hz and 10 97 hz first 50 up to 14 hz normal modes are determined for the ship the first normal mode of the ship hull 1 59 hz the superstructure 6 57 hz and the main engine body 8 77 hz are presented in figs 3 5 all natural modes and the fem model of a ship hull seem to be good and it is consistent with the author s experience compared with measurements onboard of similar ship types stiffnesses of the propulsion system foundations stern tube bearing intermediate bearings and engine s main bearings are determined by adding local forces pressures deformations of a ship double bottom are also local a deformation of stern tube bearing and intermediate bearing structures is presented in fig 6 vertical static stiffness of a foundation of a power transmission system s bearings are determined as stern tube bearing 5 55 108 n m aft intermediate bearing 7 91 108 n m fore intermediate bearing 1 02 109 n m main bearings of the engine 1 10 109 n m 4 dynamic analyses of an engine body with a simplified model of a ship hull the most interesting for the presented analysis is the value of ship hull stiffness around a main engine body three types of a model boundary conditions of an engine body foundation were analysed the first one is classic foundation arms supporting points modelling the ship hull with the main engine body foundation are completely blocked fixed deformation in the second example the ship hull stiffness was modelled by beam elements with properties which give desired stiffness values it is a good model for bearings with separate support e g intermediate bearing but this method does not take into account couplings between supporting points of a ship hull in the third method the foundation arms are modelled by a continuous cuboid with the cross section chosen for analysed engine 0 468 0 5 m with special material properties which give local stiffness equal to 1 1 109 n m an area of all propulsion systems bearings foundation was distinguished and loaded by unitary pressure murawski 2005a displacements of the bearings give me the value of the ship hull local stiffness during separate calculations the properties of the vicarious cuboid were determined in the way that the local stiffness of the cuboid was equal to the local stiffness of the ship hull with the engine foundation the young s modulus was determined as e 9 2 109 pa the model of an engine body was verified by eigenvalue vectors natural vibrations determinations it was assumed that dynamic characteristics of engine main bearings should be performed in the range of 0 30 hz because of the main excitations forces frequencies the most interesting natural mode of main bearings of an engine body is presented in fig 7 the obtained frequencies values are confronted with the author s experience in measurements and calculations and are assessed as correct the names of the shape modes are commonly used by marine engine producers the h mode describes transverse vibrations of an engine body the x mode describes torsional vibrations of an engine body values of natural frequencies for each type of boundary conditions the modelling method of a ship hull and an engine foundation were compared while the boundary conditions don t have very important influence on natural frequencies of the main bearings foundations these conditions affect the global engine eigenvalues significantly the modelling method of the boundary conditions the ship hull stiffness with the engine foundation is essential during an engine body analyses fixed nodes in the foundation arms area give us too stiff model but hull stiffness modelled by beams gives us too elastic model because of not taking into account couplings between hull areas the values of the calculated natural vibration frequencies are shown in table 1 model with a cuboid foundation is the best and it is consistent with the author s experience compared with measurements onboard of typical main engine body natural frequencies during further calculations a cuboid model will be analysed on the base of natural vibrations analyses it may be observed that stiffness of an engine body especially of main bearings foundations is high it is much higher than primary excitation frequencies of a propulsion system therefore the dynamic stiffness of the engine bearings is not much different then the static stiffness 5 thermal deformation of an engine body first step determination of thermal deformation of an engine body was performed with taking into account ship hull stiffness a model of a part of the hull was simplified by a 3 d cuboid beam with special material properties see section 4 in this part of the analysis thermal deformation of the ship hull in the engine room area is not taken into account thermal deformation of the engine body was performed on the base of measured onboard temperature distribution before the start of the thermal deformation analysis of the engine body it is necessary to determine the engine temperature distribution the temperature map has been created on the basis of the measurements carried out on the analysed engine during sea trials the temperature determination on the base of measurements is much more accurate in comparison to heat transfer calculation analysis the calculation has to be based on several values which are difficult to determine e g power of the heat source the temperatures of oil and cooling water and the coefficients of heat transfer the engine load was under stable parameters of nominal working condition the meter used for the measurement was pyrometer the temperature was measured in 60 points located around the whole engine body ten points were located regularly around the cylinder heads twenty points were located regularly on each lateral side of the engine body and ten points were located regularly on the fore and aft sides of the engine body there is a big difference between the cylinder heads and other parts of the engine body the temperature distribution was estimated using linear interpolation between the measured points and included in the numerical model the temperature of the inner parts of the engine body had to be estimated the estimation was performed on the base of lubricating oil temperature measured at the inlet and outlet as well as on the base of cooling water inlet and outlet and temperature of exhaust gases the temperature distribution of cylinder heads and other parts of the engine body is presented in fig 8 the coefficient of thermal expansion of the engine s body has been assumed as α 1 2 10 5 the temperature distribution has been applied to the engine s body analogous to the one obtained from the measurement see fig 8 thermal deformation of the main engine s body is presented in fig 9 from a point of view of the propulsion system and the main engine shaft line cooperation the most important are the displacements of the main bearings of the engine thermal displacements of the main bearings foundation in the engine body are also presented in fig 9 a diagram of vertical thermal displacement of the crankshaft axis is presented in fig 10 the circles show the places of the main bearings total vertical thermal displacement of the engine bearings in hot condition when compared to cold condition is equal to he 0 37 mm according to man b w data man b w diesel a s 1995 when the engine temperature is raised from cold 20 c to normal running temperature 55 c horizontal deformations of the crankshaft axis under the heating are negligible in spite of the temperature differences between left and right sides of the engine body this is in accordance with the marine engines manufacturers recommendations they recommend that shaft line alignment is performed only in vertical plane the numerically computed average value of the translation of the crankshaft s axis equal to 0 46 mm is greater than the one recommended by the producer 0 37 mm the difference is not particularly big below 20 but the displacement is of a hogging type it seems that the producer s assumption about the parallel translation of the crankshaft s axis is incorrect the hogging type deformation of the crankshaft results can have significant influence on the loads values coming from the shaft line the effect seems to be considerable in the precise shaft line alignment analysis presented conclusion should be treated with caution because the thermal deformation of the ship hull is not taken into account heat is flowing from the engine to the ship hull and locally it may be a source of other deformation of the engine foundation an analysis of temperature deformation of a ship hull in an engine room area is presented in the next section 6 thermal deformation of a ship hull a ship s propulsion system is a serious source of heat flowing to a ship hull especially in an engine room area a warmed up hull deforms and is a source of adjustment of engine boundary conditions conduction of heat as well as convection into air and water were taken into account during the analysis thermal radiation was omitted owing to small influence on the global thermal exchange amount thermal problems can be categorized as steady state or transient linear or nonlinear transient analyses are characterized by solution evolution over time and in addition to energy exchange with the environment involves thermal energy storage steady state analyses are concerned with state point solutions to fixed boundary condition problems the presented analysis is based on steady state linear analysis method the most general form of the steady state heat balance equation is as follows 5 k u r u t a 4 p n were k is the heat conduction matrix r is the radiation exchange matrix u is the vector of unknown temperatures t a is the temperature offset from absolute required for radiation calculations absolute temperature p is the vector of constant applied heat flows and n is the vector of temperature dependent heat flows equation 5 is inherently nonlinear due to the presence of the fourth power law radiation term in addition to the radiation term many other nonlinearities may be introduced into this equation through the coefficient matrices and boundary condition terms specifically nonlinearities are introduced by specifying the material properties and boundary conditions as temperature dependent msc nastran applies a newton raphson iteration scheme for the solution of these nonlinear equations the model of a ship hull was fully blocked boundary conditions in the midship section the fem model of a ship hull for thermal deformation calculations was deprived of the engine added stiffness of a simplified engine body disturbs the analysis together with heat flow the analysis involves also thermal deformation on the basis of a 3 d heat transfer model the final goal has been determination of the deformation resulting from the thermal load the method is based on the solution of a well known 3 d heat flow equation stationary heat flow is the basic assumption in the presented analysis in the numeric thermal analysis the thermal conductivity coefficient value for steel has been accepted equal to 43 w m k with the specific heat equal to 460 j kg k the heat flow analysis has been performed for a condition where the hold is hot and is in the thermal balance state because of lack of more precise data the coefficients of heat transfer have been accepted according to dnv classification rules by analogy to the heated cargo the coefficients of convection heat transfer values to the water have been assumed as 7400 w m2 k and the air 58 w m2 k the thermal coefficient of expansion of the engine s body has been accepted as α 1 2 10 5 a value of thermal exchange is proportional to the engine temperature and power the temperature is known described in section 5 but the heat power must be presuppositioned several iterations of computation were performed if the value of heat transferred mainly to the oil pan is equal to 0 1 of the nominal engine power then the calculated temperature in the power plant room is closely correlated with the measured ones the temperature distribution has been measured in the whole power plant room but special emphasis was put on the double bottom the hull plating and the first platform the engine load was under stable parameters of nominal working condition the meter used for the measurement was pyrometer the temperature was measured in 32 points located around the whole power plant room ten points were located regularly around the first platform eleven points were located on the double bottom and eleven were located on the hull planking closely to the double bottom the hull temperature is depended on environmental temperature therefore the hull temperature was measured two times just after shaft line alignment after ship launching and during sea trial the measurements were made on the hull plating and close point on the engine foundation the distribution and temperature values of the measured points are presented in fig 11 and table 2 the calculated temperatures correlated with the measured ones of the power plant room are presented in fig 12 and the gradient of the temperature is shown in fig 13 ship hull thermal deformation might be calculated after temperature gradients calculations of the analysed structure vertical deformations of an axis of a power transmission system foundation are the most important vertical deformation of a ship hull caused by temperature gradient was presented in fig 14 horizontal and vertical deformation of a power transmission system is presented in figs 15 and 16 horizontal deformation of a crankshaft and shaft line axis is much smaller in comparison to the vertical see figs 15 and 16 but both deformations were used during further analyses ship hull deformation around an engine was added to the fem model of the analysed engine 7 thermal deformation of an engine body second step repeated calculations of thermal deformation of an engine body were performed for a model similar to the presented in section 5 the only difference is the addition of more detailed boundary conditions taking into account thermal deformation of the ship hull in the engine room area determined in section 6 in particular determination of thermal deformation of the engine body was performed taking into account the ship hull stiffness and thermal deformations of the engine foundations the model of the part of the hull was simplified by a 3 d cuboid beam with special material properties us in section 5 but in the bottom part deformation of the ship hull was added thermal deformation of the engine body was performed on the base of measured onboard temperature distribution as previously as a result of the second step of the analysis temperature distribution with added boundary conditions a thermal displacement of the engine with the influence of the ship hull thermal deformations was determined the results for the whole engine and the foundations of the main bearings are presented in figs 17 and 18 from a point of view of the propulsion system and the main engine shaft line cooperation the most important are the displacements of the main bearings of the engine a diagram of the vertical and horizontal thermal displacement of the crankshaft axis is presented in fig 19 the circles show the places of the main bearings horizontal deformations of the crankshaft axis under the heating are much smaller in comparison to the vertical it confirms that the shaft line alignment could be performed only in the vertical plane deformations presented in fig 19 are calculated according to the absolute coordination system from the engine exploitation point of view the most important are relative deformation of the crankshaft axis against the ship hull deformed by temperature therefore vertical deformations of double bottom the engine foundation are subtracted from absolute vertical deformations of the main bearings foundations relative thermal displacement of the crankshaft axis is presented in fig 20 in the diagram the lines of total vertical thermal displacement of the engine bearings in hot condition according to man b w he 0 37 mm as well as mean value of the calculated vertical displacement are drawn the numerically computed average value of the translation of the crankshaft s axis equal to 0 86 mm is much greater than the one recommended by the producer 0 37 mm but difference of the displacement of the driving end of the crankshaft 0 305 mm is not particularly big 17 5 a hogging type calculated displacement is important it seems that the producer s assumption about the parallel translation of the crankshaft s axis is incorrect the hogging type deformation of the crankshaft results can have significant influence on the loads values coming from the shaft line the effect seems to be considerable in the precise shaft line alignment analysis the presented conclusion should be treated with caution interesting effect may be observed in fig 16 connection between the shaft line and the crankshaft is smooth inflection point is located few meters closer to the propeller direction detailed shaft line alignment calculations will show the influence of the presented deformation line of the crankshaft axis if the ship hull is elastic optimally designed the engine main bearings should be placed accordingly to the relative thermal displacement the first 3 4 bearings should be placed higher and higher but depends on the ship hull type 8 conclusions finite stiffnesses of a foundation of a shaft line mating with its bearings reactions are the cause of local deformations of a ship hull structure the boundary conditions can be modelled as a single linear spring foundation of an engine body shouldn t be modelled by local supports because 1 d spring does not take into account couplings between supporting points of a ship hull and an engine body the author proposed modelling method of engine foundation arms the boundary conditions should be modelled by a continuous cuboid with special material properties the property young modulus should have local stiffness equal to local stiffness of an analysed ship hull double bottom with the engine foundation horizontal deformations of the crankshaft axis and also shaft line axis under the heating are negligible in spite of the temperature differences between left and right sides of the engine body this is in accordance with the marine engines manufacturers recommendations they recommend that the shaft line alignment is performed only in a vertical plane the numerically computed average value of the translation of the crankshaft s axis taking into account thermal deformation of the main engine body and the ship hull is greater than the one recommended by the producer but the difference between producer s data and the calculated by the author of displacement of the driving end of the crankshaft is in the acceptable error band 17 5 it is important that the calculated displacement of the crankshaft axis is of a hogging type it seems that the producer s assumption about the parallel translation of the crankshaft s axis is only a rough approximation the hogging type of deformation can have significant influence on the loads values coming from the shaft line additional bending moment and shear force acting between the crankshaft and the shaft line the effect seems to be considerable in the precise shaft line alignment analysis presented conclusion should be treated with caution because connection between the shaft line and the crankshaft is smooth inflection point is located few meters away from the coupling detailed shaft line alignment calculations will show the influence of the presented deformation line of the crankshaft axis if a ship hull is elastic the engine s main bearings should be placed accordingly to the relative thermal displacement the first 3 4 bearings should be placed higher and higher but it depends on the ship hull type the thermal deformation of the power transmission system axis may have also big influence on the crankshaft springing especially for the first cranks it also means that the loading value of the first three main bearings may be higher than in the theory in the classical shaft line alignment analyses the presented direction of research looks promising it may allow improving installation of high power propulsion systems and avoiding failure of the engine s main bearings the worked out methodology may be used for more advanced and complete numerical computations for multiple main engine types together with specific ships hulls as a further step the propulsion system analysis methodology should be elaborated which incorporates more complex crankshaft representation including its full 3d characteristics the effect of a crankshaft s springing on the shaft line alignment should also be examined further acknowledgements the materials and data in this publication have been partly obtained through the support of the international association of maritime universities iamu and the nippon foundation in japan the authors acknowledge the supports of the iamu research project fy2017 marine structural structural failures database marstrufail and the nippon foundation in japan 
23720,the paper presents analysis of displacement of a propulsion system shaft line and a crankshaft axis caused by temperature of marine slow speed main engine detailed information of thermal displacement of a power transmission system axis is significant during a shaft line alignment and a crankshaft springing analysis and during designing of structural health monitoring shm system a warmed up main engine is a source of deformations of an engine body as well as a ship hull in the area of an engine room and hence axis of a crankshaft and a shaft line engines producers recommend the model of parallel displacement of the crankshaft axis under the influence of an engine heat this model may be too simple in some cases especially for shm systems the paper presents computations of man b w k98mc type engine mounted on 3000 teu container ship the engine body is much stiffer than its foundation pads and ship hull double bottom boundary conditions of the engine especially for the high power marine engines correct model of the boundary conditions plays a key role during the analyses presented numerical analyses are based on temperature measurements of the main engine body and the ship hull during a sea voyage numerical analyses were performed using nastran software based on finite element method the fem model of the engine body comprised over 800 thousand degree of freedom dof the model of the ship hull contains over 200 thousand dof both models are analysed separately the mutually interaction between them is taken into account by heat transfer and special model of boundary conditions the specialized shm system dedicated to marine propulsion systems working in very bad environmental conditions is the future aim of the research keywords thermal deformations propulsion system power transmission system shaft line alignment crankshaft springing boundary conditions of propulsion system 1 introduction reliability of a marine propulsion system is closely correlated with the safety of navigation at sea two stroke slow speed main engines have been installed mostly on merchant ships since the late 70s the engines are connected to a directly driven propeller by a relatively short shaft line murawski 2003 in that propulsion systems there are no gears or flexible couplings structural health monitoring systems of the power transmission system is one of the main ways for improving safety at sea especially reliable shm systems working in heavy sea state need detailed data and characteristics of the propulsion system power transmission system crankshaft plus shaft line is loaded by strongly unsymmetrical perpendicular forces especially stern tube bearing is loaded by very heavy propeller only from one side proper shaft line alignment and crankshaft springing are one of the most important parameters during marine propulsion system reliability evaluation shaft line alignment consist in appropriate bearings moving usually vertical with the aim of its proper loads crankshaft springing is a standard method of checking loads of engine main bearings the crank deformation is measured during slow crankshaft revolution with a turning gear usage shaft line alignment is closely related with crankshaft springing during the shaft line alignment and crankshaft springing analyses knowledge of the thermal displacement of the crankshaft axis is essential murawski 2016 engines producers suggest the model of crankshaft axis thermal displacement but it is very simple they recommend the model of parallel displacement of a crankshaft axis under the influence of engine heat such a model gives us one number a value of crankshaft displacement between cold and hot propulsion system in steady state condition different for each type of an engine sometimes the displacement value is depended on the temperature difference between not running and running propulsion system in such a case the model might be too simple couplings between thermal in some cases with influence of electromagnetic field and mechanical loads of a marine propulsion system are very complicated and cannot be omitted during analyses of a main engine mounting song and moon 2016 problems with shaft line alignment and crankshaft springing are befalling especially for high powered engine mounted on optimised light with elastic hull ships fontea et al 2015 simm et al 2016 yang et al 2011 practically a relatively simple model of the thermal mechanical coupling is sufficient the engine temperature is a source of its body main bearings and crankshaft and ship hull displacement there s no need to take into account the full coupling effects occur with big elastic plastic deformations with high temperature between deformation and temperature fields because the temperature level is relatively low the temperature of the main engine body is less than 70 c see fig 8 and ship hull has no more than 42 c see table 2 similarly material steel properties was assumed as constant owing to low temperature level more important is mutual interaction between the engine body and the ship hull the heat transfer is a source of the ship hull deformation especially in the engine room area and the hull deformation is a source of added deformation of the engine body finally the displacements are a source of additional mechanical loads of propulsion system s bearings and can be measured by the shm system the target of the presented analyses is evaluation of displacements of the crankshaft and shaft line axis in the propulsion system s multiple and steady state thermal working conditions germanisher lloyd 2012 american bureau of shipping 2004 det norske veritas 2013 the hull deflections caused by buoyancy can be omitted because final shaft line alignment has to be done after ship launching still water case sea waves and ship loading condition cargo have also an influence on shaft line alignment and crankshaft springing but their characteristics and type of influence is different those problems have been discussed in other author s work murawski 2003 2005a up to now in the shaft line alignment and crankshaft springing analyses methodology an interaction of the crankshaft and shaft line was analysed in a simplified way murawski 2005a the crankshaft displacements were modelled due to working temperature and its foundation stiffness those data were evaluated based on a simple data supplied by the producer the data did not address the type of the ship boundary conditions on which the engine is mounted im et al 2017 man b w diesel a s 1995 a better mathematical model of the boundary conditions of the marine power transmission system is the aim of presented research in the literature there may be found numerous examples of the damage of the first three counting from the driving end main bearings of the main engine fontea et al 2015 man b w diesel a s 2012 one of the causes might be the imprecise mathematical model of a crankshaft proposed for the shaft line alignment analysis there have been carried out a number of analyses of man b w k98mc type engine mounted on a 3000 teu container ship marine power transmission systems are usually modelled as isolated from ship hull and engine body andersen and jensen 2014 iijima et al 2008 murawski and charchalis 2014 senjanović et al 2014a there are several reasons for this methodology difficulties with the proper oil film calculation reynolds s equation and the need for a detailed crankshaft an engine body and a ship hull fem model are one of the most important this methodology separately computation of ship hull and engine was applied in the analyses the computation of the engine s body deformation due to the gravity and its natural eigenvectors has been performed as well as the analysis of its thermal deformation in nominal work conditions also the computation of the ship hull eigenvectors and local stiffness has been performed as well as the analysis of its thermal deformation with special emphasis on main engine room area the ship hull static and dynamic stiffness characteristics were used for proper modelling the engine boundary conditions natural vibrations eigenvectors analyses were performed for checking models consistency the thermal analyses require an accurate temperature distribution on the engine s body and also on the ship hull for checking numerical calculations wide temperature measurements on the ship and her main engine supplied the proper data the temperature measurements were performed during a sea voyage 2 analysis methodology all analyses were performed on the base of finite element method zienkiewicz and taylor 2000 the finite element method is a numerical technique that gives approximate solutions to differential equations that model problems arising in physics and engineering as in simple finite difference schemes the finite element method requires a problem defined in geometrical space or domain to be subdivided into a finite number of smaller regions a mesh in finite elements each subdivision is unique and need not be orthogonal for example triangles or quadrilaterals can be used in two dimensions and tetrahedra or hexahedra in three dimensions over each finite element the unknown variables e g temperature velocity etc are approximated using known functions these functions can be linear or higher order polynomial expansions in terms of the geometrical locations nodes used to define the finite element shape the governing equations in the finite element method are integrated over each finite element and the contributions summed over the entire problem domain as a consequence of this procedure a set of finite linear equations is obtained in terms of the set of unknown parameters over the elements solutions of these equations are achieved using linear algebra techniques eight steps of the fem calculation can be distinguished discretize and select the element types select a displacement function define the strain displacement and stress strain relationships in the case of one dimensional deformation in the x direction we have strain ε x related to displacement u described by 1 ε x d u d x equation 1 applies to small strains in addition the stresses must be related to the strains through the stress strain law generally called the constitutive law the ability to define the material behavior accurately is most important in obtaining acceptable results the simplest of stress strain laws hooke s law which is often used in stress analysis has the form 2 σ x e ε x where σ x is the stress in the x direction and e is the modulus of elasticity derive the element stiffness matrix and equations assemble the element equations to obtain the global or total equations and introduce boundary conditions in this step the individual element nodal equilibrium equations are generated after that the characteristic matrix of finite elements is assembled into the global nodal equilibrium equations the implication of the direct stiffness method is the concept of continuity or compatibility which requires that the structure remains together the finally assembled global equation for dynamic problems is written in matrix form as follows 3 m u c u k u f where f is the force vector k is the stiffness matrix u is the displacement vector c is the damping matrix and m is the mass matrix solve for the unknown degrees of freedom equation 3 can be simplified to static strength analyses by expunction of elements with acceleration vector mass matrix and speed vector damping matrix simplified equation modiﬁed by the boundary conditions limits of some of the displacements is a set of simultaneous algebraic equations that can be written in expanded matrix form as follows 4 f 1 f 2 f 3 f 4 f n k 11 k 21 k 12 k 22 k 1 n k 2 n k n 1 k n 2 k n n u 1 u 2 u 3 u 4 u n solve for the element strains and stresses interpretation of the results msc software s computer programs patran nastran were used for modelling and numerical calculations during the analyses two quasi independent models were investigated a ship hull with a simplified main engine body or without engine for thermal analysis is the first one the second one detailed main engine body with a simplified model of ship hull stiffness there are several reasons for the models separation murawski 2005a 2005b two relatively big models 800 200 thousand dof are difficult to connect what is more detailedness of the dimensionally biggest model a ship hull may be smaller in comparison to a more complicated engine body another significant reason for the model separation is nonlinear foundation pads which are the connection between a ship hull engine steel foundation and an engine body the assumed model of heat propagation is different in the engine body and the ship hull analyses song et al 2016 the fem model of a 3000 teu twenty foot container equivalent unit container ship with detailed view of an engine room is presented in fig 1 the model is built mainly with using 4 nodes shell elements but the main stiffeners were modelled as 1 d beam elements the model with the local stiffeners modelled by beam elements would be too big for dynamic analyses the stiffnesses of local stiffeners were modelled by changing the material data of surrounded plates the substitutive plate with changed material into orthotropic has the same stiffnesses in all directions as real plate with local stiffener influence of water interaction on the ship hull is unskippable malenica et al 2013 senjanović et al 2014b bidikli et al 2017 the finite elements named acoustic elements are the best method in the nastran software for modelling added water mass during structure vibration analyses the approach used in this analysis is called the pressure method which is analogous to the displacement method in structural analysis except that pressures instead of displacements are computed at the fluid points the velocities and accelerations of the fluid points are analogous to forces in structural analysis the interface between the fluid and the structure may be modelled so that the grid points of the fluid are coincident with those of the structure this is called a matching mesh if not then it is called a nonmatching mesh in either case and by default coupling for the stiffness and mass is automatically computed nonstructural masses of the ship structure are mostly modelled by changing mass densities the containers are modelled as flexible cuboids with appropriate mass connected with ship hull by multi point constraint mpc elements the basic idea of using mpc is to create a set of mpc equations that gives the relation between the dofs of the two separated nodes it assumes that the two corner nodes are connected by a rigid body the fem model of the ship hull has over 200 thousands degrees of freedom the fem model of the 7 b w k98mc engine s body with detailed view of a main bearings foundation is presented in fig 2 foundation of a crankshaft in the main bearings is the most important region in the presented type of analyses the fem model of main bearings is realised by 3 d solid elements 8 nodes other part of an engine body is modelled by 4 nodes plate elements the fem model of the engine body has over 800 thousands degrees of freedom correctness accuracy and consistency of both models were checked by normal modes eigenvalues analyses in the paper the si standard unit is compulsory e g m pa the analysis consists of the following steps ship hull stiffnesses determination with particular focus on foundations of the propulsion system preparation of simplified models of stiffnesses of a ship hull in order to use them in engine body calculations verification of a ship hull simplified models by dynamic analyses of an engine body with different boundary conditions determination of thermal deformation of an engine body with selected boundary conditions performed on the base of measured temperature distribution determination of a ship hull deformation with special emphasis on propulsion system foundation performed on the base of steady state transient thermal coming from an engine body analysis repeated calculations of thermal deformation of an engine body carried out on the base of more detailed boundary conditions taking into account thermal deformation of a ship hull in an engine room area 3 stiffnesses of a ship hull a ship hull often modelled as beam is usually less stiff than a propulsion system therefore determination of ship hull stiffness in the area of propulsion plant room is very important it should be used as boundary conditions for different analyse of a propulsion system natural frequencies and modes determination is the first step of the analyses the main target of that kind of analysis is checking model coherence see chapter 2 in the author s opinion nearly each fem model even made up for a static type analysis should be checked by natural modes analysis it can be done only for the models with finite elements that have a full stiffness matrix including bending stiffnesses e g beam instead rod element due to ship hull elasticity and dimensions the lowest natural frequency is around 1 5 hz for the analysed type of ship the main excitations are inducted by a propeller 5 blades and by a main engine 7 cylinders the nominal engine speed is equal to 94 rpm therefore main excitations frequencies are equal to 7 83 hz and 10 97 hz first 50 up to 14 hz normal modes are determined for the ship the first normal mode of the ship hull 1 59 hz the superstructure 6 57 hz and the main engine body 8 77 hz are presented in figs 3 5 all natural modes and the fem model of a ship hull seem to be good and it is consistent with the author s experience compared with measurements onboard of similar ship types stiffnesses of the propulsion system foundations stern tube bearing intermediate bearings and engine s main bearings are determined by adding local forces pressures deformations of a ship double bottom are also local a deformation of stern tube bearing and intermediate bearing structures is presented in fig 6 vertical static stiffness of a foundation of a power transmission system s bearings are determined as stern tube bearing 5 55 108 n m aft intermediate bearing 7 91 108 n m fore intermediate bearing 1 02 109 n m main bearings of the engine 1 10 109 n m 4 dynamic analyses of an engine body with a simplified model of a ship hull the most interesting for the presented analysis is the value of ship hull stiffness around a main engine body three types of a model boundary conditions of an engine body foundation were analysed the first one is classic foundation arms supporting points modelling the ship hull with the main engine body foundation are completely blocked fixed deformation in the second example the ship hull stiffness was modelled by beam elements with properties which give desired stiffness values it is a good model for bearings with separate support e g intermediate bearing but this method does not take into account couplings between supporting points of a ship hull in the third method the foundation arms are modelled by a continuous cuboid with the cross section chosen for analysed engine 0 468 0 5 m with special material properties which give local stiffness equal to 1 1 109 n m an area of all propulsion systems bearings foundation was distinguished and loaded by unitary pressure murawski 2005a displacements of the bearings give me the value of the ship hull local stiffness during separate calculations the properties of the vicarious cuboid were determined in the way that the local stiffness of the cuboid was equal to the local stiffness of the ship hull with the engine foundation the young s modulus was determined as e 9 2 109 pa the model of an engine body was verified by eigenvalue vectors natural vibrations determinations it was assumed that dynamic characteristics of engine main bearings should be performed in the range of 0 30 hz because of the main excitations forces frequencies the most interesting natural mode of main bearings of an engine body is presented in fig 7 the obtained frequencies values are confronted with the author s experience in measurements and calculations and are assessed as correct the names of the shape modes are commonly used by marine engine producers the h mode describes transverse vibrations of an engine body the x mode describes torsional vibrations of an engine body values of natural frequencies for each type of boundary conditions the modelling method of a ship hull and an engine foundation were compared while the boundary conditions don t have very important influence on natural frequencies of the main bearings foundations these conditions affect the global engine eigenvalues significantly the modelling method of the boundary conditions the ship hull stiffness with the engine foundation is essential during an engine body analyses fixed nodes in the foundation arms area give us too stiff model but hull stiffness modelled by beams gives us too elastic model because of not taking into account couplings between hull areas the values of the calculated natural vibration frequencies are shown in table 1 model with a cuboid foundation is the best and it is consistent with the author s experience compared with measurements onboard of typical main engine body natural frequencies during further calculations a cuboid model will be analysed on the base of natural vibrations analyses it may be observed that stiffness of an engine body especially of main bearings foundations is high it is much higher than primary excitation frequencies of a propulsion system therefore the dynamic stiffness of the engine bearings is not much different then the static stiffness 5 thermal deformation of an engine body first step determination of thermal deformation of an engine body was performed with taking into account ship hull stiffness a model of a part of the hull was simplified by a 3 d cuboid beam with special material properties see section 4 in this part of the analysis thermal deformation of the ship hull in the engine room area is not taken into account thermal deformation of the engine body was performed on the base of measured onboard temperature distribution before the start of the thermal deformation analysis of the engine body it is necessary to determine the engine temperature distribution the temperature map has been created on the basis of the measurements carried out on the analysed engine during sea trials the temperature determination on the base of measurements is much more accurate in comparison to heat transfer calculation analysis the calculation has to be based on several values which are difficult to determine e g power of the heat source the temperatures of oil and cooling water and the coefficients of heat transfer the engine load was under stable parameters of nominal working condition the meter used for the measurement was pyrometer the temperature was measured in 60 points located around the whole engine body ten points were located regularly around the cylinder heads twenty points were located regularly on each lateral side of the engine body and ten points were located regularly on the fore and aft sides of the engine body there is a big difference between the cylinder heads and other parts of the engine body the temperature distribution was estimated using linear interpolation between the measured points and included in the numerical model the temperature of the inner parts of the engine body had to be estimated the estimation was performed on the base of lubricating oil temperature measured at the inlet and outlet as well as on the base of cooling water inlet and outlet and temperature of exhaust gases the temperature distribution of cylinder heads and other parts of the engine body is presented in fig 8 the coefficient of thermal expansion of the engine s body has been assumed as α 1 2 10 5 the temperature distribution has been applied to the engine s body analogous to the one obtained from the measurement see fig 8 thermal deformation of the main engine s body is presented in fig 9 from a point of view of the propulsion system and the main engine shaft line cooperation the most important are the displacements of the main bearings of the engine thermal displacements of the main bearings foundation in the engine body are also presented in fig 9 a diagram of vertical thermal displacement of the crankshaft axis is presented in fig 10 the circles show the places of the main bearings total vertical thermal displacement of the engine bearings in hot condition when compared to cold condition is equal to he 0 37 mm according to man b w data man b w diesel a s 1995 when the engine temperature is raised from cold 20 c to normal running temperature 55 c horizontal deformations of the crankshaft axis under the heating are negligible in spite of the temperature differences between left and right sides of the engine body this is in accordance with the marine engines manufacturers recommendations they recommend that shaft line alignment is performed only in vertical plane the numerically computed average value of the translation of the crankshaft s axis equal to 0 46 mm is greater than the one recommended by the producer 0 37 mm the difference is not particularly big below 20 but the displacement is of a hogging type it seems that the producer s assumption about the parallel translation of the crankshaft s axis is incorrect the hogging type deformation of the crankshaft results can have significant influence on the loads values coming from the shaft line the effect seems to be considerable in the precise shaft line alignment analysis presented conclusion should be treated with caution because the thermal deformation of the ship hull is not taken into account heat is flowing from the engine to the ship hull and locally it may be a source of other deformation of the engine foundation an analysis of temperature deformation of a ship hull in an engine room area is presented in the next section 6 thermal deformation of a ship hull a ship s propulsion system is a serious source of heat flowing to a ship hull especially in an engine room area a warmed up hull deforms and is a source of adjustment of engine boundary conditions conduction of heat as well as convection into air and water were taken into account during the analysis thermal radiation was omitted owing to small influence on the global thermal exchange amount thermal problems can be categorized as steady state or transient linear or nonlinear transient analyses are characterized by solution evolution over time and in addition to energy exchange with the environment involves thermal energy storage steady state analyses are concerned with state point solutions to fixed boundary condition problems the presented analysis is based on steady state linear analysis method the most general form of the steady state heat balance equation is as follows 5 k u r u t a 4 p n were k is the heat conduction matrix r is the radiation exchange matrix u is the vector of unknown temperatures t a is the temperature offset from absolute required for radiation calculations absolute temperature p is the vector of constant applied heat flows and n is the vector of temperature dependent heat flows equation 5 is inherently nonlinear due to the presence of the fourth power law radiation term in addition to the radiation term many other nonlinearities may be introduced into this equation through the coefficient matrices and boundary condition terms specifically nonlinearities are introduced by specifying the material properties and boundary conditions as temperature dependent msc nastran applies a newton raphson iteration scheme for the solution of these nonlinear equations the model of a ship hull was fully blocked boundary conditions in the midship section the fem model of a ship hull for thermal deformation calculations was deprived of the engine added stiffness of a simplified engine body disturbs the analysis together with heat flow the analysis involves also thermal deformation on the basis of a 3 d heat transfer model the final goal has been determination of the deformation resulting from the thermal load the method is based on the solution of a well known 3 d heat flow equation stationary heat flow is the basic assumption in the presented analysis in the numeric thermal analysis the thermal conductivity coefficient value for steel has been accepted equal to 43 w m k with the specific heat equal to 460 j kg k the heat flow analysis has been performed for a condition where the hold is hot and is in the thermal balance state because of lack of more precise data the coefficients of heat transfer have been accepted according to dnv classification rules by analogy to the heated cargo the coefficients of convection heat transfer values to the water have been assumed as 7400 w m2 k and the air 58 w m2 k the thermal coefficient of expansion of the engine s body has been accepted as α 1 2 10 5 a value of thermal exchange is proportional to the engine temperature and power the temperature is known described in section 5 but the heat power must be presuppositioned several iterations of computation were performed if the value of heat transferred mainly to the oil pan is equal to 0 1 of the nominal engine power then the calculated temperature in the power plant room is closely correlated with the measured ones the temperature distribution has been measured in the whole power plant room but special emphasis was put on the double bottom the hull plating and the first platform the engine load was under stable parameters of nominal working condition the meter used for the measurement was pyrometer the temperature was measured in 32 points located around the whole power plant room ten points were located regularly around the first platform eleven points were located on the double bottom and eleven were located on the hull planking closely to the double bottom the hull temperature is depended on environmental temperature therefore the hull temperature was measured two times just after shaft line alignment after ship launching and during sea trial the measurements were made on the hull plating and close point on the engine foundation the distribution and temperature values of the measured points are presented in fig 11 and table 2 the calculated temperatures correlated with the measured ones of the power plant room are presented in fig 12 and the gradient of the temperature is shown in fig 13 ship hull thermal deformation might be calculated after temperature gradients calculations of the analysed structure vertical deformations of an axis of a power transmission system foundation are the most important vertical deformation of a ship hull caused by temperature gradient was presented in fig 14 horizontal and vertical deformation of a power transmission system is presented in figs 15 and 16 horizontal deformation of a crankshaft and shaft line axis is much smaller in comparison to the vertical see figs 15 and 16 but both deformations were used during further analyses ship hull deformation around an engine was added to the fem model of the analysed engine 7 thermal deformation of an engine body second step repeated calculations of thermal deformation of an engine body were performed for a model similar to the presented in section 5 the only difference is the addition of more detailed boundary conditions taking into account thermal deformation of the ship hull in the engine room area determined in section 6 in particular determination of thermal deformation of the engine body was performed taking into account the ship hull stiffness and thermal deformations of the engine foundations the model of the part of the hull was simplified by a 3 d cuboid beam with special material properties us in section 5 but in the bottom part deformation of the ship hull was added thermal deformation of the engine body was performed on the base of measured onboard temperature distribution as previously as a result of the second step of the analysis temperature distribution with added boundary conditions a thermal displacement of the engine with the influence of the ship hull thermal deformations was determined the results for the whole engine and the foundations of the main bearings are presented in figs 17 and 18 from a point of view of the propulsion system and the main engine shaft line cooperation the most important are the displacements of the main bearings of the engine a diagram of the vertical and horizontal thermal displacement of the crankshaft axis is presented in fig 19 the circles show the places of the main bearings horizontal deformations of the crankshaft axis under the heating are much smaller in comparison to the vertical it confirms that the shaft line alignment could be performed only in the vertical plane deformations presented in fig 19 are calculated according to the absolute coordination system from the engine exploitation point of view the most important are relative deformation of the crankshaft axis against the ship hull deformed by temperature therefore vertical deformations of double bottom the engine foundation are subtracted from absolute vertical deformations of the main bearings foundations relative thermal displacement of the crankshaft axis is presented in fig 20 in the diagram the lines of total vertical thermal displacement of the engine bearings in hot condition according to man b w he 0 37 mm as well as mean value of the calculated vertical displacement are drawn the numerically computed average value of the translation of the crankshaft s axis equal to 0 86 mm is much greater than the one recommended by the producer 0 37 mm but difference of the displacement of the driving end of the crankshaft 0 305 mm is not particularly big 17 5 a hogging type calculated displacement is important it seems that the producer s assumption about the parallel translation of the crankshaft s axis is incorrect the hogging type deformation of the crankshaft results can have significant influence on the loads values coming from the shaft line the effect seems to be considerable in the precise shaft line alignment analysis the presented conclusion should be treated with caution interesting effect may be observed in fig 16 connection between the shaft line and the crankshaft is smooth inflection point is located few meters closer to the propeller direction detailed shaft line alignment calculations will show the influence of the presented deformation line of the crankshaft axis if the ship hull is elastic optimally designed the engine main bearings should be placed accordingly to the relative thermal displacement the first 3 4 bearings should be placed higher and higher but depends on the ship hull type 8 conclusions finite stiffnesses of a foundation of a shaft line mating with its bearings reactions are the cause of local deformations of a ship hull structure the boundary conditions can be modelled as a single linear spring foundation of an engine body shouldn t be modelled by local supports because 1 d spring does not take into account couplings between supporting points of a ship hull and an engine body the author proposed modelling method of engine foundation arms the boundary conditions should be modelled by a continuous cuboid with special material properties the property young modulus should have local stiffness equal to local stiffness of an analysed ship hull double bottom with the engine foundation horizontal deformations of the crankshaft axis and also shaft line axis under the heating are negligible in spite of the temperature differences between left and right sides of the engine body this is in accordance with the marine engines manufacturers recommendations they recommend that the shaft line alignment is performed only in a vertical plane the numerically computed average value of the translation of the crankshaft s axis taking into account thermal deformation of the main engine body and the ship hull is greater than the one recommended by the producer but the difference between producer s data and the calculated by the author of displacement of the driving end of the crankshaft is in the acceptable error band 17 5 it is important that the calculated displacement of the crankshaft axis is of a hogging type it seems that the producer s assumption about the parallel translation of the crankshaft s axis is only a rough approximation the hogging type of deformation can have significant influence on the loads values coming from the shaft line additional bending moment and shear force acting between the crankshaft and the shaft line the effect seems to be considerable in the precise shaft line alignment analysis presented conclusion should be treated with caution because connection between the shaft line and the crankshaft is smooth inflection point is located few meters away from the coupling detailed shaft line alignment calculations will show the influence of the presented deformation line of the crankshaft axis if a ship hull is elastic the engine s main bearings should be placed accordingly to the relative thermal displacement the first 3 4 bearings should be placed higher and higher but it depends on the ship hull type the thermal deformation of the power transmission system axis may have also big influence on the crankshaft springing especially for the first cranks it also means that the loading value of the first three main bearings may be higher than in the theory in the classical shaft line alignment analyses the presented direction of research looks promising it may allow improving installation of high power propulsion systems and avoiding failure of the engine s main bearings the worked out methodology may be used for more advanced and complete numerical computations for multiple main engine types together with specific ships hulls as a further step the propulsion system analysis methodology should be elaborated which incorporates more complex crankshaft representation including its full 3d characteristics the effect of a crankshaft s springing on the shaft line alignment should also be examined further acknowledgements the materials and data in this publication have been partly obtained through the support of the international association of maritime universities iamu and the nippon foundation in japan the authors acknowledge the supports of the iamu research project fy2017 marine structural structural failures database marstrufail and the nippon foundation in japan 
23721,heave and pitch motion of an oscillating airfoil in uniform flow will cause generation of forwarding thrust applying a combination of these two motions on flexible foil one can increase thrust and therefore the efficiency this is the way that most fishes and other flying animals uses to consume less energy in this paper hydrodynamic forces and efficiency of an oscillating airfoil is investigated a code is developed based on potential flow formulation in combination with time stepping method tsm with nonlinear free shear layer dynamic approach to predict the wake behind the lifting bodies a linear morino type kutta condition has been implemented on panels adjacent to trailing edge in this methodology there is no need to define the wake shape before starting the simulation and it is an important feature in treating the hydrodynamics of submerged bodies to validate the presented algorithm some test cases were investigated comparison of propulsion performance of rigid oscillating foil with flexible undulating in different strouhal number is the novelty of our research we observe that in a wide range of frequencies undulation movements is more efficient than rigid oscillations the numerical results show a good agreement related to analytical and experimental measurements keywords boundary element method unsteady panel method time stepping method wake sheet generation flapping foil 1 introduction many scientists and engineers have been interested in flapping wing propulsion by observation of fishes birds and insects that all use oscillating foil mechanism for generation of thrust to compare the aero hydrodynamic performance of biological and man made propulsive systems to each other rozhdestvensky and ryzhov 2003 defines two specific parameters 1 relative speed ratio of the speed of swimming or flying to the maximum length of an object and 2 specific power ratio of full available power to the mass using these parameters he showed that propulsion efficiency of natural systems is drastically better than artificial ones to improve performance characteristics of man made mechanisms he suggested adopting the thrust generation mechanisms used by biological systems for man made objects some special features that distinguish propulsion efficiency of living creatures like insects birds and fishes with those created by human consists controlled aero hydro elasticity flexible geometry of propulsive surfaces self adjustment damping properties of the body resonant modes of motion etc in the early of 20th century knoller and verein 1909 and betz 1912 separately observed that the harmonic oscillations of the foil will induce both longitudinal thrust and vertical lift force components the first experimental investigation that certified the knoller betz effect has been carried out by katzmayr 1922 in 1922 simultaneously the harmonic oscillation of a wing in incompressible regime has been formulated by prandtl 1924 two years later a linearized version of prandtl s formulation has been developed by birnbaum 1924 he regarded the flapping airfoil as a two dimensional propeller and applied this solution to estimate the generated thrust force von karman and burgers 1935 observed the trailing vortex generation mechanism of flapping foil and explained the dynamic lift and drag based on location and orientation of the vortex street the observations of karman and burgers have been confirmed with flow visualization experiments carried out by polonskiy 1948 1950 he also showed the different vortex structures downstream of the lifting bodies young visualizations young and lai 2004 showed that a momentum shortage occurs in karman vortex street configuration this momentum shortage take place in time averaged velocity profiles of drag dominant wake patterns and leads to an adverse flow jet on the other hand the reverse karman vortex street configurations of thrust dominant wake pattern produce time averaged velocity profiles where show a momentum excess this momentum excess results a favorable flow jet with the invention of first generation of computers numerical methods have been developed gradually one of the widely applied methods for the investigation of the propulsive characteristics of oscillating airfoil in nonlinear formulation is panel method because of its computational efficiency as compared to the navier stokes solvers formulation of panel method is based on boundary integral equations that lead to the computation of singularity strengths over the body panels in the panel method formulation one can capture the viscous features of the flow by considering the free wake sheet generating from trailing edges downstream of the body this can be done through satisfying the kutta condition that correlates the strength of the wake panels with source doublet strengths of body panels into the equations topper 2011 solution of incompressible flow around bodies using panel method has been started by hess and smith 1962 they predict pressure and velocity distribution over 3d arbitrary non lifting bodies ten years later hess 1972 developed panel method to estimate induced forces generated by a lifting surface these researches have been supported by douglas aircraft company in these works researchers used prescribed wake shape pws model to analyze potential distribution over lifting bodies hess 1990 explained a comprehensive historical background of the panel method there has been a great deal of research into propellers and hydrofoils using panel methods or boundary element methods politis 2004 2005 2011 2016 produced a free wake panel method for a marine propeller using a boundary element formulation he used a low order panel method coupled with unsteady morino type kutta condition to capture the propeller wake roll up in 2008 mantia et al used a new formulation of unsteady kutta condition to simulate potential flow around a two dimensional oscillating foil la mantia and dabnichki 2009 they calculate hydrodynamic forces on heave pitching foil and compared the results with experimental data yonghui et al numerically studied a flapping foil for energy extraction they showed that power extracted from an oscillating air foil is mainly due to heaving rather than pitching motion xie et al 2014 in 2015 chien chou et al presented a numerical model to investigate fluid structure interaction for a 2d flow over a sinusoid pitching foil they compared the numerical results with experimental data and showed the numerical model is sufficient to predict the dynamic stall phenomenon tseng and cheng 2015 zhang and ji 2017 studied the vortex shedding and formation behind an isolated cylinder under the wake generation of an oscillating airfoil the foil was oscillated with pitch movement and in different frequencies zhang and ji 2017 in 2017 numerical versus experimental investigation of energy extraction performance of a flapping foil was performed in this study pitch and heave motion of the airfoil were adjusting through a crankshaft like structure comparison between numerical and experimental compares good agreement they also showed that higher efficiency can be achieved with larger pitch amplitude at medium frequency xu et al 2017 triantafyllou et al 1991 1993 1996 2000 2002 2004 triantafyllou and triantafyllou 1995 used panel method to model three dimensional flexible swimmer of arbitrary geometry subject to variable body deflections zhu et al 2006 have also developed a combined hydrofoil and free surface simulation using a boundary element method basically in simulation of lifting objects using boundary element method there are some techniques to model the wake sheet the earliest one is known as prescribed wake shape pws in this method the wake surface as well as body geometry should be defined using either simple linearized models or experimental observations in this approach cause of weak estimation of potential distribution over body panels calculation of forces and moments were not exact to overcome the accuracy problem wake relaxation method wrm has been adopted to the solution of steady state flow problems in this method first an initial geometry of wake sheet must be defined and then solver improves the pattern iteratively until the tangential velocity vectors on both sides of sheet converge to each other iteratively deformation of panel geometry causes more accurate doublet distribution over body surface and it helps to estimate lift forces and moments more accurately katz and plotkin 1991 another algorithm that used for unsteady simulations is time stepping method tsm in this approach there is no need to define the wake pattern before starting the simulation we just address the trailing edges as wake sheet generator lines and the free wake would be developed continuously based on mean perturbation velocity of wake nodes in this study the implementation of time stepping method for development of vortex sheet downstream the lifting bodies have been shown to verify and validate our methodology some test cases including flow over unit sphere non lifting and lifting naca 0012 and harmonic oscillating airfoil has been considered and good agreement between analytical and numerical solutions observed 2 method and materials for solving the governing equation via boundary element method it is needed to discretize the boundaries in computational domains including body and boundaries in the present study all the test cases are supposed to be in an infinite domain so that it just needed to discretize the surface of corresponding object assume an object that moves with linear velocity of v t and angular velocity of ω t in an unbounded flow domain with upstream flow velocity u t as the corresponding object is either solid or flexible thus each panel has the following instantaneous velocity vector in the inertia reference frame 1 v a t v t ω t r thus relative velocity for an observer connected to body is 2 q a t v a t u t considering inviscid incompressible and irrotational flow the continuity equation could be written in the form of laplacian of 3d velocity potential as following triantafyllou et al 2002 3 2 ϕ 0 the general solution for this equation would be every linear combination of fundamental potential functions such as sink source doublet vortex and etc based on green s second identity if ϕ and λ satisfy laplace s equation then it is possible to write equation 3 in the form of 4 2 π ϕ p s ϕ λ n d s s λ ϕ n d s for every p located on the body boundaries in this equation n is the unit normal vector of panel pointing outward of the body the kernel function λ could be any fundamental solution of potential flow like source doublet vortex or any combination of them for simplicity suppose λ as a point source with unit strength λ 1 r then it is possible to find the body perturbation velocity potential ϕ p t at any point in terms of surface integrals over the boundaries based on hess 1972 for lifting body problems to satisfy the kelvin s theorem the integral should be expanded over the wake sheet downstream the trailing edges too as shown in fig 1 which s b and s w are body and wake panels respectively so the equation 4 could be written in the form of 5 2 π ϕ p t s ϕ q t 1 r n d s s 1 r ϕ q t n d s where s s b s w and r p q is distance from point q ε s to the field point p it should be noted that because the both potential ϕ and its normal derivative are continuous across the wake sheet their contributions to the integral over s w should be zero in the time stepping method the wake sheet s w has been considered into two different regions kutta strip s k which is just adjacent to the trailing edge and free vortex sheet s f which is remainder of the wake sheet elements s w s k s f doublet intensities over kutta strip panels are unknown in each time step while the intensities of other panels are known from previous time steps to compute the perturbation velocity over p ε s w the gradient of equation 5 should be taken politis 2004 6 v m 1 4 π s n ϕ r r 3 d s 1 4 π s n ϕ r r 3 d s 1 4 π l ϕ d l r r 3 it should be noted that in this formulation v m is the mean velocity of upper and lower part of wake sheet it means 7 v m ϕ ϕ 2 as well the last integral in equation 6 is a line integral over the free part of the line bounding wake surface these integrals are equivalent to the well known biot savart formula for the calculation of induced velocities from singular vortex lines katz and plotkin 1991 expanding equation 5 for all body panels to close the system of equations some conditions should be satisfied on the boundaries the no flux kinematic boundary condition implies that triantafyllou et al 2002 8 ϕ x t n q x t ϕ w x t n another boundary condition for lifting objects is kutta condition which applies at trailing edge panels the philosophy of kutta condition is that fluid must leave the lifting body smoothly with finite velocity in our formulation we implement a linear morino type kutta condition to diminish the pressure difference between two sides of free wake sheet any pressure jump between upper and lower panels of trailing edge would cause instability in fluid flow so it implies 9 ϕ u ϕ l μ where μ is the dipole intensity of wake panel adjacent to trailing edge after calculation of influence coefficient the system of equation would be in form of 10 a ϕ b w h e r e b b ϕ n where a and b are dipole and source coefficients respectively the matrix of influence coefficients in the boundary element methods is not usually sparse and could be easily solved with iterative techniques like successive over relaxed sor or conjugate gradient cg methods in this study sor approach with relaxation factor of 1 0 was implemented 3 numerical implementation as the first step before coding the problem equation 5 should be discretized in the form of following equation politis 2011 11 2 π ϕ p t b o d y ϕ q t s b n r r 3 d s k u t t a μ q t s k n r r 3 d s b o d y s b n v r d s w a k e s f μ n r r 3 d s which includes influence coefficients of body and wake panels as mentioned before constant dipole intensity for both body and trailing vortex sheet region is used for the calculation of coefficients in the equation 12 regarding source distribution first term in the right hand side of equation 12 its intensity is analytically known at each time step and thus the surface integral can be calculated numerically considering the second term on the right hand side both μ and the geometry of its free vortex sheets are assumed to be known from previous time steps as shown in equation 12 a kutta strip is used as an additional unknown at each time step so to close the system of equation extra relations as stated in equations 8 and 9 should be used after computation of dipole intensity over the lifting body the perturbation velocity of the free vortex nodes should be calculate to determine wake roll up pattern based on ref politis 2011 formulation using constant dipole intensity equation 6 to calculate the mean perturbation velocities on free vortex sheet leads to 12 v m 1 4 π b o d y s b n v r r 3 d s 1 4 π b o d y s b ϕ d l r r 3 1 4 π w a k e s w μ d l r r 3 where source and dipole intensities and integration surface are known from previous time steps more specifically the first term is a surface integral with regular kernel for points p w a k e while the second and third terms in the right hand side are line integrals of known dipole strengths over the boundary line of each elements note that these integrals are equivalent to the well known biot savart formula to calculate the induced velocities from singular vortex lines therefore the integrals on the right hand side of equation 13 can be calculate and mean induced velocities on the trailing vortex sheet could be found in present algorithm equation 13 is directly implemented at grid points of free wake sheets with the aid of induced perturbation velocities which is known at each grid point x i i 1 m m denotes the number of nodes representing free wake of each lifting surface at current time step the new position of the nodes can be calculate using a first order approximation as follow 13 x i n e w x i o l d v m v d t 4 calculation of tangential velocity to compute forces and moments exerted from flow on the lifting body pressure distribution on the solid boundaries should be calculate directly by applying bernoulli equation 11 at each panel first of all it is needed to calculate tangential velocity by taking the surface gradient of dipole strength over lifting body 14 v s ϕ where s is used to denotes the surface gradient in case of quadrilateral panels ϕ n 1 ϕ n and ϕ n 1 denote the values of the potential at three consecutive points p 1 p 2 and p 3 centroids of panels on the body surface along u or v a pair of orthogonal directions these directions could be easily found for every panel by using a cross product between normal vector and one of the edges fig 2 also l 1 p 1 p 2 and l 2 p 2 p 3 are the physical distances between panel control points respectively along either u or v directions the tangential or surface gradient at p 2 is calculated using a central differencing scheme based on following formula 15 ϕ l u o r v f 1 l 2 f 2 l 1 l 1 l 2 where 16 f 1 ϕ n ϕ n 1 l 1 f 2 ϕ n 1 ϕ n l 2 at boundary points of the body surface a usual forward or backward difference scheme is applied by applying equation 16 along orthogonal directions corresponding potential derivatives can be found tangential perturbation velocity can be calculate as follow 17 ϕ ϕ l u e u ϕ l v e v where e u and e v are unit vectors along the element orthogonal directions it is obvious that in case of triangular grids fig 3 it is hard to find neighboring panels toward the orthogonal directions in this situation a least square approach is used to calculate surface gradient assume p n i i 0 1 2 are center of specified panel and its neighbor respectively and p 0 indicates the coordinate of one nodes in p panel using orthogonal directions one can build a transformation matrix for each panel to vanish non tangential components suppose n denotes unit normal vector of the specified panel then two other orthogonal directions can be easily found as 18 u p 0 p p 0 p v n u thus transformation matrix can be written as bellow 19 m u x u y u z v x v y v z n x n y n z so if n indicates the geometrical matrix of specified panel and its neighbors as n n 0 p n 1 p n 2 p then r m n t will map all vectors in a planar space and diminish non tangential components of them now if q i n i p with q x q y and q z as its components then following equation for each panel will minimize the square of errors with gradient components 20 i q x 2 i q x q y i q x q z i q y q x i q y 2 i q y q z i q z q x i q z q y i q z 2 ϕ x ϕ y ϕ z i ϕ n i ϕ p q x i ϕ n i ϕ p q y i ϕ n i ϕ p q z equation 21 can be write in form of a 1 ϕ b to yield the expression for gradient as ϕ a b but this is not the final value of surface gradient and should be transformed back to real space using 21 ϕ t m t ϕ where ϕ t is the tangential gradient of velocity potential in the center of panel 5 computation of forces and moments the forces and moments on the lifting body is computed by integration of pressure normal stress and friction shear stress forces over the surface of body in the boundary element methods because of inviscid fluid flow assumption just pressure forces can be captured by the solver in order to estimate friction forces the complementary methods should be exploited one approach is coupling the panel method with boundary layer equation in stream wise direction in order to determine the frictional drag coefficient another method is using experimental coefficients to estimate friction forces in this study the later method is implemented the pressure is calculated directly by applying bernoulli equation over each panel 22 p p ρ d ϕ d t 1 2 ϕ v 2 1 2 v 2 in above equation v denotes kinematic body velocity of panel and ϕ is surface gradient of velocity potential over panel then pressure forces and moments can be calculated by integrating the pressure over body panels calculation of pressure on all panels according to equation 11 one can estimate forces and moments exerted on the body from following formulas 23 f s p n d d s 24 m s r p n d d s where 25 d 0 5 ρ c d v t o t v t o t in above equation v t o t is total velocity relative to an observer in moving system and is defined as follow 26 v t o t v r e f ϕ and c d is local friction coefficient over the body surface for example for a smooth plate in turbulent flow it given by blevins 1984 27 c d 0 0986 log r e 1 22 2 to sum up the discussion the solution algorithm of our problem by time stepping method at each time step are as follows 1 allocating the kutta strip elements to apply morino boundary condition 2 solving the system of algebraic equations to find velocity potential on body panels 3 computation of mean induced velocity of wake nodes and deforming the wake sheet 4 writing output results including pressure forces body and wake positions in the format of visualization program i e paraview or tecplot 5 calculation of new position of body panels 6 repeat from step 1 6 solver verification according to the prescribed methodology a numerical code was developed before investigating the main case oscillating the airfoil in is required to verify the solver for this reason some standard and well known test cases was studied all simulations carried out on an intel core i7 3ghz cpu and total computational time on each one has been measured 6 1 flow over a sphere as a benchmark problem flow over a unit sphere was studied the upstream flow passing over the sphere is uniform with unit magnitude surface of sphere is discretized with 2004 triangular cells as stated by katz and plotkin 1991 the velocity potential over the surface can be obtained via an analytical solution as followings 28 ϕ 0 5 r u c o s θ 29 c p 1 9 4 s i n 2 θ the solution would rapidly converge in three time steps each take approximately 1 8 s pressure and velocity potential distribution diagram after ten time steps has been compared with analytical values shown in figs 5 6 the results are in good agreement with each other see fig 4 6 2 fixed foil in lifting and non lifting conditions as the second case study the flow over a naca0012 at zero angle of attack is investigated this airfoil is considered as a non lifting body the chord length and aspect ratio of the airfoil are 1 and 6 respectively the span has been divided to 20 uniform segments while the chord wise grid spacing generated with grid size ratio of 1 2 the magnitude of infinite velocity is equal to 1 m s and time step size considered by 0 1 s 10 s real time simulation is carried out this simulation lasted almost 40 s for the mentioned computer distribution of the velocity potential over the foil was compared with numerical work of gennaretti et al 1998 the contour of doublet values over the body and wake sheet is shown in fig 7 because no lift generated there is no wake roll up downstream of the body and free vortex sheet was shed as a planar surface the value of dipole distribution tends to zero over the wake sheet fig 8 shows distribution of doublets on the airfoil in chord wise direction with comparison to gennaretti results in a similar way pressure coefficient which was measured experimentally by gregory and o reilly 1973 at the mid chord section of the naca0012 compared with our numerical results and is presented in fig 9 the mentioned airfoil was studied in another simulation with 10 angle of attack to capture more precise formation of wake sheet number of grids was increased to 60 panels calculation time for 10 s simulation lasted 390 s and time step for this simulation was 0 1 s since the condition of the test case is a lifting body it is expected to see wake sheet roll up at the edges fig 10 shows development of free wake sheet at t 10 s to verify the solver distribution of pressure coefficient along the chord at mid span has been compared with experimental results of gregory and o reilly 1973 results have been shown in fig 11 and indicate a proper agreement with the benchmark 7 rigid oscillating foils body motions was not being considered in the previous simulations in this case the effect of moving boundaries in the flow has been studied a naca0012 airfoil in an unbounded flow domain with uniform upstream flow was considered three different configurations of motion including pure heaving pure pitching and flapping combined heave and pitch was performed in all simulations the velocity magnitude of the free stream flow assumed as unity and the size of time step was equal to 0 1 s the main goals of the simulations are the study of wake sheet pattern estimation of hydrodynamic forces and comparing with analytical values and computation of propulsion efficiencies in each case according to abbaspour and ebrahimi 2015 the propulsion efficiency of an oscillating airfoil is represented with two important parameters mean input power p and mean inline force f x the mean input power is expressed as 30 p 1 t 0 t p d t 1 t 0 t f y h d t 0 t m z α d t where h and f y t are lateral velocity and force component in the transverse direction respectively fig 12 also α and m z t are instantaneous angular velocity and pitching moment in transverse plane respectively finally the overall propulsion efficiency is calculated as 31 η f x u r e f p there is an analytical method to compute lift force based on thin airfoil theory katz and plotkin 1991 for this case let us assume that a thin flat plate is placed in front of a uniform flow with constant speed the time dependent chord line position can be represented by a vertical displacement h t positive in the y direction and by an instantaneous angle of attack α t fig 12 now harmonic heave and pitch motions can be written as follow 32 h h 0 sin ω t 33 α α 0 sin ω t then the lift force per unit span is katz and plotkin 1991 34 l π ρ u c c k u α h 3 4 a c c α π ρ c 2 4 u α h 1 2 a c c α where the first term is circulatory lift in steady motion and second term is the lift due to acceleration called the added mass the lift deficiency factor c k is plotted versus reduced frequency k in fig 13 which is defined as 35 k ω c 2 u the wake has a delaying effect on the circulatory part of the lift where ϕ represents the time shift effect of the wake please note that ϕ changes with the reduced frequency as shown in fig 13 table 1 shows the input parameters for three configurations for each case it takes almost 280 s to simulate 25 s of real time flow motion the average of lift force generated by the airfoil in each case has been compared with analytical formula equation 34 and is shown in fig 14 the maximum lift has been gained in flapping heaving and pitching respectively the outcome is coincide with the wake formation pattern in fig 17 which show the wake instability is a scale of magnitude of propulsion forces on the other hand the time history of lift which is derived from panel method and analytical expressions was shown in fig 15 the comparison show good agreement between the results another important parameter in this case is estimation of net thrust and propulsion efficiency which is generated by moving airfoil in this case because the fix value of velocity magnitude in upstream it implies that negative x component of total force means the foil generate thrust and positive x component means the resistant forces are dominant as shown in fig 16 mean value of thrust force in all cases is negative and it indicates that in this frequency all airfoils generate propulsion force propulsion performance in each case was calculated based on equation 31 the value of power consumption due to heave pitch motion and also generated thrust power is estimated in table 2 as well the results show that in this frequency best performance was gained in heaving motion another aspect to investigate flow around oscillating foils is the study of wake sheet pattern emanating from trailing edge fig 17 show development of free wake at t 25 s for all configurations one point that has been understood from the figures is that the intensity of wake deformation with growing the loading conditions over the body is increased this was concluded previously in table 2 with comparison of power consumption magnitude in each case more precise look at the formation of vortex lines can be obtained with cutting a plane normal to z axis at the mid span of airfoil the resultant shapes was shown in figs 18 and 17 vortex rings generated by the moving airfoil depicted by red arrows in the fig 18 it can be seen that the vortex rings strengthen while they move away from the body they are actually the von karman vortex street behind the airfoil and dissipate the input power using an energy cascade mechanism the strength and size of this vortex array is directly dependent on the magnitude of dynamic forces generated by the oscillating foil due to an inherent instability in the formulation of boundary element method their shape is much deformed as they move away the body 7 1 flexible foils undulating motion to compare the propulsion efficiency of flexible and rigid motions another case study was studied the results compared with ranse simulation of ebrahimi abbaspour and ebrahimi 2015 and show the capability of boundary element in estimation of propulsion performance of flexible bodies undulating motions of body panels correspond to a wave equation implemented on chord line of airfoil 36 y x t a 0 a 1 x a 2 x 2 sin 2 π λ x 2 π f t amplitude of motion is represented with a second order polynomial with following coefficients a 0 0 02 a 1 0 08 a 2 0 16 these parameters selected such that the motion closely prescribe the swimming of carangiform animals borazjani and sotiropoulos 2008 videler and hess 1984 based on this expression maximum excursion of trailing edge a m a x in fig 19 is always equal to 0 1 simulations carried out in strouhal numbers from 0 05 to 2 5 based on s t 2 f a m a x u the upstream velocity is set to 0 04 m s and wave length λ is equal to unity in the following the wake sheet development pattern in different moments for st 0 05 and 0 5 represented as it is shown in the figs 20 and 21 wake sheet deformation and loading condition of airfoil amplified while strouhal number increased calculation of input power and propulsion performance based on equations 30 and 31 show that in low frequencies not only no thrust force generated by the airfoil but also a resistive flow regime observed as well maximum efficiency would be gained in strouhal numbers around 0 5 fig 22 compares our results with similar study using commercial software ansys fluent by ebrahimi and abbaspour abbaspour and ebrahimi 2015 also the results of flapping rigid foil simulation in the same frequencies has been presented in this figure three important points raised from this comparison as followings a in relative high frequencies propulsion efficiency of oscillating foil with both of bem and ranse approaches tends to same value it means that the viscous effects is almost negligible with increasing the oscillation frequency this result was gained by jones et al 1998 they showed that inviscid solvers properly estimate lift force in high strouhal numbers b ignoring the frictional drag by boundary element method cause to higher estimation of propulsion performance rather than ranse method this is due to shear stresses which must be include in general form of governing equations that make some energy dissipate c in a wide range of frequencies undulation motion is more efficient than rigid oscillations biomimetic science show that generally natural mechanisms generate more power rather that man made systems 8 conclusion and future works in this study an unsteady potential boundary element method using time stepping scheme to capture wake pattern behind lifting non lifting combination of bodies has been presented the major innovation of the work is the implementation of tsm for modeling of the free vortex sheet for verification of the algorithm a number of test cases including flow over unit sphere non lifting and lifting airfoil and harmonic oscillation airfoil have been simulated in all cases good agreements between numerical and analytical results observed in selection of numerical approach one should establish a balance between time and accuracy however in the case of viscous dominant problems the accuracy of boundary element methods is lower than navier stokes methods which consider most of physical properties of the fluid flow in the fluid domain but it is best choice for pressure dominant problems because fast convergence and good accuracy there are some issues to consider for developing this unsteady solver as future plans implementation of parallel processing to reduce computational time treatment of free surface to investigate the ground effect on hydrodynamic lift force coupling with boundary layer solver to consider displacement thickness and wall shear stress coefficients and implementation of kinematics of aquatic animal locomotion for simulation of fish like swimming are the most important future works nomenclatures s ϕ tangential gradient of velocity potential c p dimensionless pressure coefficient d t time step of simulation f vector of total force on body m vector of total moment on body n normal vector of elements p input power for body movements q t instantanious velocity in global reference r p position vector of panels s b body panels s f panels on free wake sheet s k panels on kutta strip s w wake panels s t strouhal number u infinite fluid velocity at upstream v t linear velocity v m mean velocity of wake nodes η propulsion efficiency μ p t dipole distribution of wake sheet ρ fluid density ϕ p t velocity potential of body panels ω t angular velocity 
23721,heave and pitch motion of an oscillating airfoil in uniform flow will cause generation of forwarding thrust applying a combination of these two motions on flexible foil one can increase thrust and therefore the efficiency this is the way that most fishes and other flying animals uses to consume less energy in this paper hydrodynamic forces and efficiency of an oscillating airfoil is investigated a code is developed based on potential flow formulation in combination with time stepping method tsm with nonlinear free shear layer dynamic approach to predict the wake behind the lifting bodies a linear morino type kutta condition has been implemented on panels adjacent to trailing edge in this methodology there is no need to define the wake shape before starting the simulation and it is an important feature in treating the hydrodynamics of submerged bodies to validate the presented algorithm some test cases were investigated comparison of propulsion performance of rigid oscillating foil with flexible undulating in different strouhal number is the novelty of our research we observe that in a wide range of frequencies undulation movements is more efficient than rigid oscillations the numerical results show a good agreement related to analytical and experimental measurements keywords boundary element method unsteady panel method time stepping method wake sheet generation flapping foil 1 introduction many scientists and engineers have been interested in flapping wing propulsion by observation of fishes birds and insects that all use oscillating foil mechanism for generation of thrust to compare the aero hydrodynamic performance of biological and man made propulsive systems to each other rozhdestvensky and ryzhov 2003 defines two specific parameters 1 relative speed ratio of the speed of swimming or flying to the maximum length of an object and 2 specific power ratio of full available power to the mass using these parameters he showed that propulsion efficiency of natural systems is drastically better than artificial ones to improve performance characteristics of man made mechanisms he suggested adopting the thrust generation mechanisms used by biological systems for man made objects some special features that distinguish propulsion efficiency of living creatures like insects birds and fishes with those created by human consists controlled aero hydro elasticity flexible geometry of propulsive surfaces self adjustment damping properties of the body resonant modes of motion etc in the early of 20th century knoller and verein 1909 and betz 1912 separately observed that the harmonic oscillations of the foil will induce both longitudinal thrust and vertical lift force components the first experimental investigation that certified the knoller betz effect has been carried out by katzmayr 1922 in 1922 simultaneously the harmonic oscillation of a wing in incompressible regime has been formulated by prandtl 1924 two years later a linearized version of prandtl s formulation has been developed by birnbaum 1924 he regarded the flapping airfoil as a two dimensional propeller and applied this solution to estimate the generated thrust force von karman and burgers 1935 observed the trailing vortex generation mechanism of flapping foil and explained the dynamic lift and drag based on location and orientation of the vortex street the observations of karman and burgers have been confirmed with flow visualization experiments carried out by polonskiy 1948 1950 he also showed the different vortex structures downstream of the lifting bodies young visualizations young and lai 2004 showed that a momentum shortage occurs in karman vortex street configuration this momentum shortage take place in time averaged velocity profiles of drag dominant wake patterns and leads to an adverse flow jet on the other hand the reverse karman vortex street configurations of thrust dominant wake pattern produce time averaged velocity profiles where show a momentum excess this momentum excess results a favorable flow jet with the invention of first generation of computers numerical methods have been developed gradually one of the widely applied methods for the investigation of the propulsive characteristics of oscillating airfoil in nonlinear formulation is panel method because of its computational efficiency as compared to the navier stokes solvers formulation of panel method is based on boundary integral equations that lead to the computation of singularity strengths over the body panels in the panel method formulation one can capture the viscous features of the flow by considering the free wake sheet generating from trailing edges downstream of the body this can be done through satisfying the kutta condition that correlates the strength of the wake panels with source doublet strengths of body panels into the equations topper 2011 solution of incompressible flow around bodies using panel method has been started by hess and smith 1962 they predict pressure and velocity distribution over 3d arbitrary non lifting bodies ten years later hess 1972 developed panel method to estimate induced forces generated by a lifting surface these researches have been supported by douglas aircraft company in these works researchers used prescribed wake shape pws model to analyze potential distribution over lifting bodies hess 1990 explained a comprehensive historical background of the panel method there has been a great deal of research into propellers and hydrofoils using panel methods or boundary element methods politis 2004 2005 2011 2016 produced a free wake panel method for a marine propeller using a boundary element formulation he used a low order panel method coupled with unsteady morino type kutta condition to capture the propeller wake roll up in 2008 mantia et al used a new formulation of unsteady kutta condition to simulate potential flow around a two dimensional oscillating foil la mantia and dabnichki 2009 they calculate hydrodynamic forces on heave pitching foil and compared the results with experimental data yonghui et al numerically studied a flapping foil for energy extraction they showed that power extracted from an oscillating air foil is mainly due to heaving rather than pitching motion xie et al 2014 in 2015 chien chou et al presented a numerical model to investigate fluid structure interaction for a 2d flow over a sinusoid pitching foil they compared the numerical results with experimental data and showed the numerical model is sufficient to predict the dynamic stall phenomenon tseng and cheng 2015 zhang and ji 2017 studied the vortex shedding and formation behind an isolated cylinder under the wake generation of an oscillating airfoil the foil was oscillated with pitch movement and in different frequencies zhang and ji 2017 in 2017 numerical versus experimental investigation of energy extraction performance of a flapping foil was performed in this study pitch and heave motion of the airfoil were adjusting through a crankshaft like structure comparison between numerical and experimental compares good agreement they also showed that higher efficiency can be achieved with larger pitch amplitude at medium frequency xu et al 2017 triantafyllou et al 1991 1993 1996 2000 2002 2004 triantafyllou and triantafyllou 1995 used panel method to model three dimensional flexible swimmer of arbitrary geometry subject to variable body deflections zhu et al 2006 have also developed a combined hydrofoil and free surface simulation using a boundary element method basically in simulation of lifting objects using boundary element method there are some techniques to model the wake sheet the earliest one is known as prescribed wake shape pws in this method the wake surface as well as body geometry should be defined using either simple linearized models or experimental observations in this approach cause of weak estimation of potential distribution over body panels calculation of forces and moments were not exact to overcome the accuracy problem wake relaxation method wrm has been adopted to the solution of steady state flow problems in this method first an initial geometry of wake sheet must be defined and then solver improves the pattern iteratively until the tangential velocity vectors on both sides of sheet converge to each other iteratively deformation of panel geometry causes more accurate doublet distribution over body surface and it helps to estimate lift forces and moments more accurately katz and plotkin 1991 another algorithm that used for unsteady simulations is time stepping method tsm in this approach there is no need to define the wake pattern before starting the simulation we just address the trailing edges as wake sheet generator lines and the free wake would be developed continuously based on mean perturbation velocity of wake nodes in this study the implementation of time stepping method for development of vortex sheet downstream the lifting bodies have been shown to verify and validate our methodology some test cases including flow over unit sphere non lifting and lifting naca 0012 and harmonic oscillating airfoil has been considered and good agreement between analytical and numerical solutions observed 2 method and materials for solving the governing equation via boundary element method it is needed to discretize the boundaries in computational domains including body and boundaries in the present study all the test cases are supposed to be in an infinite domain so that it just needed to discretize the surface of corresponding object assume an object that moves with linear velocity of v t and angular velocity of ω t in an unbounded flow domain with upstream flow velocity u t as the corresponding object is either solid or flexible thus each panel has the following instantaneous velocity vector in the inertia reference frame 1 v a t v t ω t r thus relative velocity for an observer connected to body is 2 q a t v a t u t considering inviscid incompressible and irrotational flow the continuity equation could be written in the form of laplacian of 3d velocity potential as following triantafyllou et al 2002 3 2 ϕ 0 the general solution for this equation would be every linear combination of fundamental potential functions such as sink source doublet vortex and etc based on green s second identity if ϕ and λ satisfy laplace s equation then it is possible to write equation 3 in the form of 4 2 π ϕ p s ϕ λ n d s s λ ϕ n d s for every p located on the body boundaries in this equation n is the unit normal vector of panel pointing outward of the body the kernel function λ could be any fundamental solution of potential flow like source doublet vortex or any combination of them for simplicity suppose λ as a point source with unit strength λ 1 r then it is possible to find the body perturbation velocity potential ϕ p t at any point in terms of surface integrals over the boundaries based on hess 1972 for lifting body problems to satisfy the kelvin s theorem the integral should be expanded over the wake sheet downstream the trailing edges too as shown in fig 1 which s b and s w are body and wake panels respectively so the equation 4 could be written in the form of 5 2 π ϕ p t s ϕ q t 1 r n d s s 1 r ϕ q t n d s where s s b s w and r p q is distance from point q ε s to the field point p it should be noted that because the both potential ϕ and its normal derivative are continuous across the wake sheet their contributions to the integral over s w should be zero in the time stepping method the wake sheet s w has been considered into two different regions kutta strip s k which is just adjacent to the trailing edge and free vortex sheet s f which is remainder of the wake sheet elements s w s k s f doublet intensities over kutta strip panels are unknown in each time step while the intensities of other panels are known from previous time steps to compute the perturbation velocity over p ε s w the gradient of equation 5 should be taken politis 2004 6 v m 1 4 π s n ϕ r r 3 d s 1 4 π s n ϕ r r 3 d s 1 4 π l ϕ d l r r 3 it should be noted that in this formulation v m is the mean velocity of upper and lower part of wake sheet it means 7 v m ϕ ϕ 2 as well the last integral in equation 6 is a line integral over the free part of the line bounding wake surface these integrals are equivalent to the well known biot savart formula for the calculation of induced velocities from singular vortex lines katz and plotkin 1991 expanding equation 5 for all body panels to close the system of equations some conditions should be satisfied on the boundaries the no flux kinematic boundary condition implies that triantafyllou et al 2002 8 ϕ x t n q x t ϕ w x t n another boundary condition for lifting objects is kutta condition which applies at trailing edge panels the philosophy of kutta condition is that fluid must leave the lifting body smoothly with finite velocity in our formulation we implement a linear morino type kutta condition to diminish the pressure difference between two sides of free wake sheet any pressure jump between upper and lower panels of trailing edge would cause instability in fluid flow so it implies 9 ϕ u ϕ l μ where μ is the dipole intensity of wake panel adjacent to trailing edge after calculation of influence coefficient the system of equation would be in form of 10 a ϕ b w h e r e b b ϕ n where a and b are dipole and source coefficients respectively the matrix of influence coefficients in the boundary element methods is not usually sparse and could be easily solved with iterative techniques like successive over relaxed sor or conjugate gradient cg methods in this study sor approach with relaxation factor of 1 0 was implemented 3 numerical implementation as the first step before coding the problem equation 5 should be discretized in the form of following equation politis 2011 11 2 π ϕ p t b o d y ϕ q t s b n r r 3 d s k u t t a μ q t s k n r r 3 d s b o d y s b n v r d s w a k e s f μ n r r 3 d s which includes influence coefficients of body and wake panels as mentioned before constant dipole intensity for both body and trailing vortex sheet region is used for the calculation of coefficients in the equation 12 regarding source distribution first term in the right hand side of equation 12 its intensity is analytically known at each time step and thus the surface integral can be calculated numerically considering the second term on the right hand side both μ and the geometry of its free vortex sheets are assumed to be known from previous time steps as shown in equation 12 a kutta strip is used as an additional unknown at each time step so to close the system of equation extra relations as stated in equations 8 and 9 should be used after computation of dipole intensity over the lifting body the perturbation velocity of the free vortex nodes should be calculate to determine wake roll up pattern based on ref politis 2011 formulation using constant dipole intensity equation 6 to calculate the mean perturbation velocities on free vortex sheet leads to 12 v m 1 4 π b o d y s b n v r r 3 d s 1 4 π b o d y s b ϕ d l r r 3 1 4 π w a k e s w μ d l r r 3 where source and dipole intensities and integration surface are known from previous time steps more specifically the first term is a surface integral with regular kernel for points p w a k e while the second and third terms in the right hand side are line integrals of known dipole strengths over the boundary line of each elements note that these integrals are equivalent to the well known biot savart formula to calculate the induced velocities from singular vortex lines therefore the integrals on the right hand side of equation 13 can be calculate and mean induced velocities on the trailing vortex sheet could be found in present algorithm equation 13 is directly implemented at grid points of free wake sheets with the aid of induced perturbation velocities which is known at each grid point x i i 1 m m denotes the number of nodes representing free wake of each lifting surface at current time step the new position of the nodes can be calculate using a first order approximation as follow 13 x i n e w x i o l d v m v d t 4 calculation of tangential velocity to compute forces and moments exerted from flow on the lifting body pressure distribution on the solid boundaries should be calculate directly by applying bernoulli equation 11 at each panel first of all it is needed to calculate tangential velocity by taking the surface gradient of dipole strength over lifting body 14 v s ϕ where s is used to denotes the surface gradient in case of quadrilateral panels ϕ n 1 ϕ n and ϕ n 1 denote the values of the potential at three consecutive points p 1 p 2 and p 3 centroids of panels on the body surface along u or v a pair of orthogonal directions these directions could be easily found for every panel by using a cross product between normal vector and one of the edges fig 2 also l 1 p 1 p 2 and l 2 p 2 p 3 are the physical distances between panel control points respectively along either u or v directions the tangential or surface gradient at p 2 is calculated using a central differencing scheme based on following formula 15 ϕ l u o r v f 1 l 2 f 2 l 1 l 1 l 2 where 16 f 1 ϕ n ϕ n 1 l 1 f 2 ϕ n 1 ϕ n l 2 at boundary points of the body surface a usual forward or backward difference scheme is applied by applying equation 16 along orthogonal directions corresponding potential derivatives can be found tangential perturbation velocity can be calculate as follow 17 ϕ ϕ l u e u ϕ l v e v where e u and e v are unit vectors along the element orthogonal directions it is obvious that in case of triangular grids fig 3 it is hard to find neighboring panels toward the orthogonal directions in this situation a least square approach is used to calculate surface gradient assume p n i i 0 1 2 are center of specified panel and its neighbor respectively and p 0 indicates the coordinate of one nodes in p panel using orthogonal directions one can build a transformation matrix for each panel to vanish non tangential components suppose n denotes unit normal vector of the specified panel then two other orthogonal directions can be easily found as 18 u p 0 p p 0 p v n u thus transformation matrix can be written as bellow 19 m u x u y u z v x v y v z n x n y n z so if n indicates the geometrical matrix of specified panel and its neighbors as n n 0 p n 1 p n 2 p then r m n t will map all vectors in a planar space and diminish non tangential components of them now if q i n i p with q x q y and q z as its components then following equation for each panel will minimize the square of errors with gradient components 20 i q x 2 i q x q y i q x q z i q y q x i q y 2 i q y q z i q z q x i q z q y i q z 2 ϕ x ϕ y ϕ z i ϕ n i ϕ p q x i ϕ n i ϕ p q y i ϕ n i ϕ p q z equation 21 can be write in form of a 1 ϕ b to yield the expression for gradient as ϕ a b but this is not the final value of surface gradient and should be transformed back to real space using 21 ϕ t m t ϕ where ϕ t is the tangential gradient of velocity potential in the center of panel 5 computation of forces and moments the forces and moments on the lifting body is computed by integration of pressure normal stress and friction shear stress forces over the surface of body in the boundary element methods because of inviscid fluid flow assumption just pressure forces can be captured by the solver in order to estimate friction forces the complementary methods should be exploited one approach is coupling the panel method with boundary layer equation in stream wise direction in order to determine the frictional drag coefficient another method is using experimental coefficients to estimate friction forces in this study the later method is implemented the pressure is calculated directly by applying bernoulli equation over each panel 22 p p ρ d ϕ d t 1 2 ϕ v 2 1 2 v 2 in above equation v denotes kinematic body velocity of panel and ϕ is surface gradient of velocity potential over panel then pressure forces and moments can be calculated by integrating the pressure over body panels calculation of pressure on all panels according to equation 11 one can estimate forces and moments exerted on the body from following formulas 23 f s p n d d s 24 m s r p n d d s where 25 d 0 5 ρ c d v t o t v t o t in above equation v t o t is total velocity relative to an observer in moving system and is defined as follow 26 v t o t v r e f ϕ and c d is local friction coefficient over the body surface for example for a smooth plate in turbulent flow it given by blevins 1984 27 c d 0 0986 log r e 1 22 2 to sum up the discussion the solution algorithm of our problem by time stepping method at each time step are as follows 1 allocating the kutta strip elements to apply morino boundary condition 2 solving the system of algebraic equations to find velocity potential on body panels 3 computation of mean induced velocity of wake nodes and deforming the wake sheet 4 writing output results including pressure forces body and wake positions in the format of visualization program i e paraview or tecplot 5 calculation of new position of body panels 6 repeat from step 1 6 solver verification according to the prescribed methodology a numerical code was developed before investigating the main case oscillating the airfoil in is required to verify the solver for this reason some standard and well known test cases was studied all simulations carried out on an intel core i7 3ghz cpu and total computational time on each one has been measured 6 1 flow over a sphere as a benchmark problem flow over a unit sphere was studied the upstream flow passing over the sphere is uniform with unit magnitude surface of sphere is discretized with 2004 triangular cells as stated by katz and plotkin 1991 the velocity potential over the surface can be obtained via an analytical solution as followings 28 ϕ 0 5 r u c o s θ 29 c p 1 9 4 s i n 2 θ the solution would rapidly converge in three time steps each take approximately 1 8 s pressure and velocity potential distribution diagram after ten time steps has been compared with analytical values shown in figs 5 6 the results are in good agreement with each other see fig 4 6 2 fixed foil in lifting and non lifting conditions as the second case study the flow over a naca0012 at zero angle of attack is investigated this airfoil is considered as a non lifting body the chord length and aspect ratio of the airfoil are 1 and 6 respectively the span has been divided to 20 uniform segments while the chord wise grid spacing generated with grid size ratio of 1 2 the magnitude of infinite velocity is equal to 1 m s and time step size considered by 0 1 s 10 s real time simulation is carried out this simulation lasted almost 40 s for the mentioned computer distribution of the velocity potential over the foil was compared with numerical work of gennaretti et al 1998 the contour of doublet values over the body and wake sheet is shown in fig 7 because no lift generated there is no wake roll up downstream of the body and free vortex sheet was shed as a planar surface the value of dipole distribution tends to zero over the wake sheet fig 8 shows distribution of doublets on the airfoil in chord wise direction with comparison to gennaretti results in a similar way pressure coefficient which was measured experimentally by gregory and o reilly 1973 at the mid chord section of the naca0012 compared with our numerical results and is presented in fig 9 the mentioned airfoil was studied in another simulation with 10 angle of attack to capture more precise formation of wake sheet number of grids was increased to 60 panels calculation time for 10 s simulation lasted 390 s and time step for this simulation was 0 1 s since the condition of the test case is a lifting body it is expected to see wake sheet roll up at the edges fig 10 shows development of free wake sheet at t 10 s to verify the solver distribution of pressure coefficient along the chord at mid span has been compared with experimental results of gregory and o reilly 1973 results have been shown in fig 11 and indicate a proper agreement with the benchmark 7 rigid oscillating foils body motions was not being considered in the previous simulations in this case the effect of moving boundaries in the flow has been studied a naca0012 airfoil in an unbounded flow domain with uniform upstream flow was considered three different configurations of motion including pure heaving pure pitching and flapping combined heave and pitch was performed in all simulations the velocity magnitude of the free stream flow assumed as unity and the size of time step was equal to 0 1 s the main goals of the simulations are the study of wake sheet pattern estimation of hydrodynamic forces and comparing with analytical values and computation of propulsion efficiencies in each case according to abbaspour and ebrahimi 2015 the propulsion efficiency of an oscillating airfoil is represented with two important parameters mean input power p and mean inline force f x the mean input power is expressed as 30 p 1 t 0 t p d t 1 t 0 t f y h d t 0 t m z α d t where h and f y t are lateral velocity and force component in the transverse direction respectively fig 12 also α and m z t are instantaneous angular velocity and pitching moment in transverse plane respectively finally the overall propulsion efficiency is calculated as 31 η f x u r e f p there is an analytical method to compute lift force based on thin airfoil theory katz and plotkin 1991 for this case let us assume that a thin flat plate is placed in front of a uniform flow with constant speed the time dependent chord line position can be represented by a vertical displacement h t positive in the y direction and by an instantaneous angle of attack α t fig 12 now harmonic heave and pitch motions can be written as follow 32 h h 0 sin ω t 33 α α 0 sin ω t then the lift force per unit span is katz and plotkin 1991 34 l π ρ u c c k u α h 3 4 a c c α π ρ c 2 4 u α h 1 2 a c c α where the first term is circulatory lift in steady motion and second term is the lift due to acceleration called the added mass the lift deficiency factor c k is plotted versus reduced frequency k in fig 13 which is defined as 35 k ω c 2 u the wake has a delaying effect on the circulatory part of the lift where ϕ represents the time shift effect of the wake please note that ϕ changes with the reduced frequency as shown in fig 13 table 1 shows the input parameters for three configurations for each case it takes almost 280 s to simulate 25 s of real time flow motion the average of lift force generated by the airfoil in each case has been compared with analytical formula equation 34 and is shown in fig 14 the maximum lift has been gained in flapping heaving and pitching respectively the outcome is coincide with the wake formation pattern in fig 17 which show the wake instability is a scale of magnitude of propulsion forces on the other hand the time history of lift which is derived from panel method and analytical expressions was shown in fig 15 the comparison show good agreement between the results another important parameter in this case is estimation of net thrust and propulsion efficiency which is generated by moving airfoil in this case because the fix value of velocity magnitude in upstream it implies that negative x component of total force means the foil generate thrust and positive x component means the resistant forces are dominant as shown in fig 16 mean value of thrust force in all cases is negative and it indicates that in this frequency all airfoils generate propulsion force propulsion performance in each case was calculated based on equation 31 the value of power consumption due to heave pitch motion and also generated thrust power is estimated in table 2 as well the results show that in this frequency best performance was gained in heaving motion another aspect to investigate flow around oscillating foils is the study of wake sheet pattern emanating from trailing edge fig 17 show development of free wake at t 25 s for all configurations one point that has been understood from the figures is that the intensity of wake deformation with growing the loading conditions over the body is increased this was concluded previously in table 2 with comparison of power consumption magnitude in each case more precise look at the formation of vortex lines can be obtained with cutting a plane normal to z axis at the mid span of airfoil the resultant shapes was shown in figs 18 and 17 vortex rings generated by the moving airfoil depicted by red arrows in the fig 18 it can be seen that the vortex rings strengthen while they move away from the body they are actually the von karman vortex street behind the airfoil and dissipate the input power using an energy cascade mechanism the strength and size of this vortex array is directly dependent on the magnitude of dynamic forces generated by the oscillating foil due to an inherent instability in the formulation of boundary element method their shape is much deformed as they move away the body 7 1 flexible foils undulating motion to compare the propulsion efficiency of flexible and rigid motions another case study was studied the results compared with ranse simulation of ebrahimi abbaspour and ebrahimi 2015 and show the capability of boundary element in estimation of propulsion performance of flexible bodies undulating motions of body panels correspond to a wave equation implemented on chord line of airfoil 36 y x t a 0 a 1 x a 2 x 2 sin 2 π λ x 2 π f t amplitude of motion is represented with a second order polynomial with following coefficients a 0 0 02 a 1 0 08 a 2 0 16 these parameters selected such that the motion closely prescribe the swimming of carangiform animals borazjani and sotiropoulos 2008 videler and hess 1984 based on this expression maximum excursion of trailing edge a m a x in fig 19 is always equal to 0 1 simulations carried out in strouhal numbers from 0 05 to 2 5 based on s t 2 f a m a x u the upstream velocity is set to 0 04 m s and wave length λ is equal to unity in the following the wake sheet development pattern in different moments for st 0 05 and 0 5 represented as it is shown in the figs 20 and 21 wake sheet deformation and loading condition of airfoil amplified while strouhal number increased calculation of input power and propulsion performance based on equations 30 and 31 show that in low frequencies not only no thrust force generated by the airfoil but also a resistive flow regime observed as well maximum efficiency would be gained in strouhal numbers around 0 5 fig 22 compares our results with similar study using commercial software ansys fluent by ebrahimi and abbaspour abbaspour and ebrahimi 2015 also the results of flapping rigid foil simulation in the same frequencies has been presented in this figure three important points raised from this comparison as followings a in relative high frequencies propulsion efficiency of oscillating foil with both of bem and ranse approaches tends to same value it means that the viscous effects is almost negligible with increasing the oscillation frequency this result was gained by jones et al 1998 they showed that inviscid solvers properly estimate lift force in high strouhal numbers b ignoring the frictional drag by boundary element method cause to higher estimation of propulsion performance rather than ranse method this is due to shear stresses which must be include in general form of governing equations that make some energy dissipate c in a wide range of frequencies undulation motion is more efficient than rigid oscillations biomimetic science show that generally natural mechanisms generate more power rather that man made systems 8 conclusion and future works in this study an unsteady potential boundary element method using time stepping scheme to capture wake pattern behind lifting non lifting combination of bodies has been presented the major innovation of the work is the implementation of tsm for modeling of the free vortex sheet for verification of the algorithm a number of test cases including flow over unit sphere non lifting and lifting airfoil and harmonic oscillation airfoil have been simulated in all cases good agreements between numerical and analytical results observed in selection of numerical approach one should establish a balance between time and accuracy however in the case of viscous dominant problems the accuracy of boundary element methods is lower than navier stokes methods which consider most of physical properties of the fluid flow in the fluid domain but it is best choice for pressure dominant problems because fast convergence and good accuracy there are some issues to consider for developing this unsteady solver as future plans implementation of parallel processing to reduce computational time treatment of free surface to investigate the ground effect on hydrodynamic lift force coupling with boundary layer solver to consider displacement thickness and wall shear stress coefficients and implementation of kinematics of aquatic animal locomotion for simulation of fish like swimming are the most important future works nomenclatures s ϕ tangential gradient of velocity potential c p dimensionless pressure coefficient d t time step of simulation f vector of total force on body m vector of total moment on body n normal vector of elements p input power for body movements q t instantanious velocity in global reference r p position vector of panels s b body panels s f panels on free wake sheet s k panels on kutta strip s w wake panels s t strouhal number u infinite fluid velocity at upstream v t linear velocity v m mean velocity of wake nodes η propulsion efficiency μ p t dipole distribution of wake sheet ρ fluid density ϕ p t velocity potential of body panels ω t angular velocity 
23722,the characteristics of wave breaking in shallow waters that are of interest include whether a wave will break the type of breaking that will occur the breaking wave height breaking depth the position of breaking the wave setup and the transformation of the broken wave for given offshore wave characteristics and given bottom profile various methods have been proposed in the literature to estimate these wave breaking characteristics deo et al 2003 used a neural network approach to predict the breaking wave height and breaking depth for waves transforming over a range of simply sloped bottoms the deo et al approach is extended here to predict other characteristics of wave breaking including the type of wave breaking the position of breaking the wave setup and the rate of dissipation of wave energy in the case of waves impinging on a fringing reef observations from a series of specially conducted laboratory experiments involving monochromatic waves impinging on an idealized reef are used to develop and train respective models the input parameters to the neural network models are the ratio of offshore wave height to the shallow water depth of the flat section of the reef h 1 h s and the wave frequency parameter f h 1 g the breaker type classification model developed predicts the type of breaker with a success rate of 96 outperforming previously used criteria for classifying breaker types the numeric prediction models for the dimensionless position of wave breaking for plunging and spilling breakers for wave setup and for the reduction in energy flux across the reef have performance ratings characterized by respective correlation coefficients of 0 99 0 82 0 89 and 0 94 the modest value for the correlation between prediction and the actual result for the position of breaking of spilling breakers is believed to be associated with inaccuracies in determination of the exact position of breaking and to difficulty in visually capturing spilling breakers in observations high correlation between predicted and actual values of the reduction in energy flux across the reef is achieved in spite of the fact the model was trained using data from a wave tank that included partial reflection characterized by 7 mean deviation among non breaking waves from the downstream end of the tank the method can be extended to provide predictive models for consideration of a range of natural coastal conditions random waves and various bottom profiles and complex geometry based on training and testing of the models using representative laboratory field and or flow simulation in support of accurate prediction of near shore wave phenomena keywords breaking waves breaking classification neural network experimental investigation fringing reef 1 introduction the propagation of ocean waves from deep to shallow water has received special attention from engineers and researchers in view of the large amount of energy inherent in ocean waves as a wave travels onshore its characteristics are transformed leading to increase in the wave steepness due to shoaling and the evolution of the energy distribution over the frequency spectrum goda 1975 this energy can be impactful for nearshore structures or floating vessels in such cases it may be desirable to have the waves break upstream of the area to be protected so that some of the wave energy is dissipated that is why breakwaters are constructed to protect floating vessels and nearshore structures coastal engineering research center 1984 another coastal problem which is analyzed in coastal engineering research center 1984 and is related to breaking waves is sediment mobilization and coastal erosion a three part work presented in brocchini et al 2004 kennedy et al 2006 and piattella et al 2006 deals with the breaking wave induced macrovortices this work is based on experimental computational and analytical methods analyzing rip current effects and the mixing features of the shallow flows occurring around submerged structures used for coastal protection in many cases the natural environment can act as a breakwater where the main parameter of interest is the bottom profile in designing coastal defenses and structures it is necessary to predict the breaking wave characteristics of waves including the location where they will break the breaking wave height the type of breaking that will occur and the resulting wave setup the process of wave transformation and wave breaking is non linear stokes cnoidal and stream function theories are used to describe wave profiles preceding wave breakup dean and dalrymple 1991 dean 1972 wave evolution leading to wave breaking is typically followed numerically using methods based on the boussinesq equations yao et al 2012 peregrine 1967 a boussinesq model is derived in veeramony and svendsen 2000 for predicting breaking waves and has been extended in briganti et al 2004 to incorporate turbulence associated with a breaking wave in the surf zone the model proposed by yao et al in yao et al 2012 for the wave profile is compared with their laboratory experiments yao et al 2009 studies based on the assumption of planar beach profiles with mild constant slopes provide simplified mccowan 1894 goda 1970 or more advanced breaking criteria weggel 1972 goda 2010 for the nearshore zone a novel breaking index for fringing reefs extracted from laboratory experiments is provided in yao et al 2013 extensive research has been carried out to model the transformation of the wave height h x as well as the wave setup η x for irregular bottom shapes an approach based on an energy balance and involving consideration of one dimensional gradient of energy flux is sometimes used see for example dally et al 1985 and kweon and goda 1996 according to dally et al 1985 and yao et al 2012 the effect of bottom friction on the surf zone phenomena in fringing reef type profiles is negligible but is important in regions of mild slopes versions of the models of the type described above for wave transformation in the coastal region are used to account for various factors including wind and offshore wave conditions type of bottom profile bottom material and other features and processes the models typically require empirically determined parameters derived through statistical curve fit to laboratory or field data simple empirical criteria such as the wave height to depth ratio criterion for wave breaking are used under some conditions with the breaking position measured from the shore typically obtained from the ratio of the depth at breaking to the beach slope dean and dalrymple 1991 similarly the surf similarity parameter is an empirically derived index to classify the breaker type as a function of the bottom slope and breaking wave steepness battjes 1974 the criteria in both cases are provided for planar beach profiles with mild constant slopes an extensive experimental study to judge and compare the validity of various criteria including breaking type classification breaking location surf zone width and the incipient breaker height and depth indices is considered in yao et al 2013 modern machine learning techniques have been proposed during the last decade incorporating data mining algorithms witten et al 2011 to train models that can provide good empirical models the concept of a neural network nn for wave forecasting was introduced by deo et al in deo and naidu 1999 and deo et al 2001 the idea was extended to prediction of the wave height and depth at wave breaking deo and jagdale 2003 using a nn model that was trained based on classic criteria for wave breaking provided in coastal engineering research center 1984 and validated using several experimental data sets over a broad range of conditions here predictive neural network models for parametric characterization of wave breaking over a fringing reef in the coastal region for given offshore wave characteristics and bottom geometry are developed based on the machine learning concept and laboratory experiments the characteristics considered include classification of the type of wave breaker the position of wave breaking the wave setup downstream of position of breaking and the rate of dissipation of wave energy during breaking the machine learning technique that is chosen is the multilayer perceptron which is a type of feedforward artificial nn baum 1988 the networks are trained using observations from laboratory experiments the models for the wave characteristics are distinguished see witten et al 2011 as the classification model as providing prediction for data available in non numeric or nominal value form such as spilling plunging or non breaking waves and numeric prediction models as providing predictions for data available in numeric form such as location of breaking wave setup and energy flux the proposed method is aimed to have the following advantages 1 the method is oblivious to whether the underlying physical process is linear or nonlinear with the multilayer perceptron accommodating possible nonlinear interactions that may characterize the physical processes through seeking a statistical relationship between the input parameters and the resulting observed data 2 a matrix formulation expresses the nn in a compact form 3 it facilitates simple extensions of the training of the models through use of larger or more representative datasets for improvement and development of robust models 4 it facilitates consideration of a variety of realistic features which may be difficult to model theoretically e g offshore wind or current characteristics bottom material etc through expansion of the input attributes via a new training procedure that generates a fresh model 5 datasets can be generated from laboratory or field experiments or numerical simulations or their combination 6 evaluation and improvement of the model is achieved through field or laboratory experiments 7 nominal or non numeric attributes can be included in the form of representative integer numbers the limitations of the method include 1 the model is based on range of the data set used for training the model 2 a good distribution of samples in the training data set is required and 3 a nn model does not provide a single regression equation relating inputs and outputs instead the model serves as the equation for the relationship 2 matrix formulation of the neural network the machine learning technique chosen to predict breaking wave phenomena is based on a multilayer perceptron a type of feedforward artificial nn baum 1988 the networks are trained based on experimental datasets using a collection of open source machine learning algorithms called weka witten et al 2011 that is typically used for data mining tasks weka contains tools for data pre processing classification regression clustering association rules and visualization specifically a back propagation algorithm of the weka tool is utilized here details regarding multilayer perceptrons and the training procedure are provided in witten et al 2011 a compact mathematical formulation is presented in this section according to the multilayer perceptron concept three types of layers are identified the input the hidden and the output layers the input and output are single layers while the hidden layer can be single or multiple the following definitions along with the diagram in fig 1 establish the infrastructure for a compact description of the nn based on a matrix notation the notation is defined below i 1 m hidden layer index j 1 k m node index m number of hidden layers k i number of nodes at layer i k 0 number of attributes k m 1 number of output nodes a k 0 b y 1 attribute vector x i k i 1 1 b y 1 input vector at hidden layer i s i k i 1 b y 1 output vector at hidden layer i λ u transformation operation for an n b y 1 vector u to an n b y n diagonal matrix w i k i b y k i 1 1 weight matrix at layer i d i k i b y k i diagonal matrix v i k i b y 1 all ones vector at layer i y k m 1 b y 1 output vector the attribute vector is defined as 1 a a 1 a 2 a k 0 t which is by definition equal to the zero layer output vector i e a s 0 this perspective helps the notation to become much more compact the zero layer output vector is defined as 2 s 0 s 1 0 s 2 0 s k 0 0 t the input vector for each node in hidden layer i is defined as 3 x i 1 s i 1 t t the definition of the weight matrix is presented below the weight elements are provided by the training algorithm see backpropagation method in witten et al 2011 4 w i w 1 1 i w 1 2 i w 1 k i 1 1 i w 2 1 i w 2 2 i w 2 k i 1 1 i w k i 1 i w k i 2 i w k i k i 1 1 i in order to use the matrix formulation some special transformations need to be executed thus the transformation of an n by 1 vector u to a n by n diagonal matrix is denoted by the operator λ which is defined as 5 λ u u 1 0 0 0 u 2 0 0 0 u n the sigmoid activation function which is used within the hidden layer to define the output of each node is given by 6 s i d i 1 v i where d i λ 1 e w i x i and v i 1 1 1 t the output vector is defined as 7 y y 1 y 2 y k m 1 t the output node uses a sigmoid or a linear activation function for the classification and numeric prediction respectively the sigmoid activation function uses the same relation as in the hidden layer and by definition is equal to the output layer output vector using the hidden layer notation i e y class s m 1 thus for the wave breaking classification one obtains 8 y class d m 1 1 v m 1 for the numeric prediction the linear activation function is simply a linear combination of the weight matrix with the output layer s input vector i e 9 y numeric w m 1 x m 1 the ability provided by the nn approach to train and build models based on data obtained by a variety of methods such as numerical simulations laboratory or field experiments for various bottoms and wave conditions is very promising in addition the matrix formulation makes the use of the method very simple since a subroutine which performs the matrix operations can be called from any computer program see figs 9 and 12 3 laboratory based breaking wave data set the nn model was trained and validated using breaking wave data set obtained from laboratory experiments over an ideal fringing reef conducted in a wave tank at florida atlantic university 3 1 experimental setup the wavetank used is a fresh water filled open top tank made of transparent plexiglas it is 18 29 m long with a cross section of 1 22 m 1 22 m as depicted in fig 2 at one end a flap type wavemaker with a paddle hinged to the bottom generates the waves while at the other end a wave attenuator absorbs the wave energy see appendix c for wave absorber efficiency evaluation another absorber is placed behind the wavemaker a 0 134 slope was inserted in the tank 3 23 m away from the paddle forming the reef face a shallow water section parallel to the undisturbed free surface extends from the reef edge to the wave absorber simulating the reef flat section of an ideal fringing reef both the slope and the parallel section are made of impact resistant slippery ultra high molecular weight uhmw polyethylene with a friction coefficient of 0 19 to minimize bottom friction effects the reef height is 0 408 m the input parameters are the deep h d and shallow h s water depths which are related as h s h d 0 408 m the wavemaker camshaft radius r which is related to the length of the paddle stroke s and the wavemaker rotational frequency f for the r and h d ranges used the stroke can be approximated by a parametric linear relationship as s r h d 1 9071 h d r 0 0027 h d where all dimensions are in m the rest of the geometry is fixed the output parameters are obtained by four wave gages placed along the tank that measure the local instantaneous surface elevation η longitudinally the origin is set at the reef edge 6 27 m away from the paddle vertically it is at the undisturbed water level the x axis points to the wave propagation while the z axis positive direction is against gravity gage no1 was placed at x 1 3 14 m from the reef edge to measure the offshore wave characteristics gage no2 was placed at the reef edge x 2 to estimate wave shoaling effects gage no4 was placed at x 4 3 00 m from the reef edge to measure the wave condition at the flat section of the reef after breaking when breaking occurs gage no3 is located at x 3 where x 2 x 3 x 4 somewhere between the breaking x b and transition x t points the transition point x t is defined after basco and yamashita 1986 as the point where the mean water surface changes from essentially level to an increasing slope wave set up the actual breaking position x b was obtained from video footage of the experiments and x 3 only serves as an approximate estimate of x b the breaker type classification as plunging spilling or nonbreaking is also justified visually based on the definitions in dean and dalrymple 1991 three sets of experiments were conducted the in shore shallow water depth h s was selected for each set and the wavemaker frequency and camshaft radius which govern the paddle stroke varied generating different monochromatic offshore wave profiles for each wave condition the experiments were conducted three times in order to validate the repeatability of our measurements the three in shore shallow water depths selected were 0 095 m 0 120 m and 0 160 m and the wavemaker frequency and the camshaft radius considered were respectively in the ranges 0 35 1 60 h z and 0 064 0 140 m thereby allowing an examination of 31 combinations of wave conditions and shallow water depths see table 1 the sampling rate for the wave gages was 20 h z and each test was conducted for a period of 1 m i n a 40 s time window was identified as representing steady state conditions at each gage location yielding a discrete time series of n 801 samples per test for data analysis to eliminate the effects of residual waves from the previous test in the wave tank each test was separated from the other by an appropriate time delay 3 2 dimensionless input parameters the main length parameters that appear in the problem are the offshore wave height h 1 offshore wave length λ 1 and shallow water depth h s the non dimensional frequency of the incident wave as well as the wave setup at each position i are respectively defined as f h 1 g and η i h s the longitudinal wave breaking position is expressed in a dimensionless form as x b h s the incident wave height to shallow water depth ratio h 1 h s is as we will see later the non dimensional parameter with the highest influence during the wave transformation and breaking processes 3 3 data analysis the four capacitance wave gages have a length of 0 5 m and a linear response each they are integrated in a data acquisition system that synchronizes them and incorporates the analog to digital converters adc providing discrete time series to the host computer the data are displayed and stored in the host computer the adc resolution is 12 b i t thus the surface elevation in meters is obtained by a simple linear relation of the form η i c o u n t 0 5 2 12 1 c o u n t c o u n t 0 where c o u n t is each discrete recorded value c o u n t 0 is the discrete value that corresponds to the still water level swl and the index i 1 4 corresponds to the wave gage number c o u n t 0 is calculated as the average of the first 100 samples before the wavemaker operates η i is the discrete time series of the surface elevation since each count is recorded every 0 05 s which corresponds to η i n η i n t s where n is the sample number and t s 0 05 s is the sampling period for monochromatic waves average wave height h i and average crest and trough amplitudes a c i and a t i respectively i 1 4 are defined as mean values over a 40 s duration based on the recordings of the surface elevation in the time domain for each wave period the wave height ℋ i p is defined as the difference between the maximum and the minimum surface elevation ζ i p at station i during the wave period p p is the index number of the wave component corresponding to each wave period within the 40 s duration and m is the total number of wave components over this duration thus the average wave parameters are defined as a c i p 1 m max ζ i p m a t i p 1 m min ζ i p m and h i a c i a t i the wave setup η i is defined as the mean water level for the steady state duration i e η i n 1 n η i n n the corrected crest and trough amplitudes are defined as a t c i a t i η i and a c c i a c i η i from the spectrum of the surface elevation peaks at harmonic frequencies can be identified at x 1 the dominant frequency always matches the wavemaker frequency f while this is not always the case for the locations x 2 x 3 and x 4 on the basis that irregular waves can be treated as a superposition of regular waves with constant frequencies and amplitudes goda 1975 the amplitudes of each harmonic component is calculated by applying fast fourier transform fft to each discrete time series of the surface elevation over the 40 s steady state duration thus the wave amplitude at each location x i which corresponds to each harmonic component f m m f is estimated as a i m s η i q m where s η i q m 2 y i q m n y i is the fft of η i which by definition is y q n 1 n η n e 2 π j n 1 q 1 n q m is the spectrum sample number corresponding to frequency f m i is the gage number j is the imaginary unit m is the number of the harmonic component with m 1 corresponding to the dominant frequency n is the length of vector η i in addition the wave length λ i m wave number k i m group speed c g i m and phase speed c p i m for each test are determined from the dispersion relation applied at each gage location and for multiple harmonics based on our observations the dominant frequency along with the first 6 harmonics carry most of the wave energy so the higher harmonics are considered negligible using the same approach to consider each harmonic component independently the wave energy and energy flux are calculated as e i m 1 8 ρ g 2 a i m 2 and ℱ i m c g i m e i m respectively where ρ is the water density and g is the gravitational acceleration the total energy flux at each gage is then estimated as the sum of the wave fluxes at each harmonic component thus ℱ i m 1 6 ℱ i m 3 4 breaker type classifying the type of wave breaking is important since the type of wave breaking significantly governs the energy dissipation in the surf zone iafrat 2011 as well as flow processes downstream of breaking peregrine 1967 dally et al 1985 kweon and goda 1996 the surf similarity parameter battjes 1974 which is the standard classification criterion for plane slopes does not predict the breaker type effectively in the case of a fringing reef yao et al 2013 consistent with yao et al 2013 the ratio of incident wave height to shallow water depth h1 hs is used to characterize the classification fig 3 only three classes of wave types were observed in the laboratory tests plunging breakers spilling breakers and nonbreaking waves the criteria developed by yao et al 2013 imply that 10 plunging breakers occur if h 1 h s 0 56 11 spilling breakers occur if 0 36 h 1 h s 0 56 12 no breaking occurs if h 1 h s 0 36 in fig 3 the above criteria can be partially validated however some overlapping occurs an overall true positive rate tpr of 81 5 is achieved using traditional criteria 10 12 overlapping also occurred in the results provided in yao et al 2013 a generalized criterion is necessary to provide more accurate classification and enable prediction of the breaker types over various reef profiles materials and offshore conditions a machine learning approach is proposed in the next section 3 5 position of wave breaking a criterion is developed empirically in yao et al 2013 to distinguish between waves that break on the sloping reef face and those that break in the shallow water reef flat 13 breaking on reef face if h 1 h s 0 83 14 breaking on reef flat if h 1 h s 0 83 this criterion is found to be generally true in the present study as can be seen in fig 4 an approximate parabolic relationship between x b h s and h 1 h s is evident from the figure in the present notation breaking on the reef face implies x b h s 0 an alternative machine learning approach is proposed in section 5 that enables predicting the location of the wave breaking from the reef edge it may be observed in fig 4 that the breaking point for plunging breakers occurs earlier lower values of x b h s than for spilling breakers 3 6 energy flux the total energy flux at each gage ℱ i is estimated based on the approach described in section 3 2 according to dally et al 1985 in shallow waters the ratio of the energy flux to the water depth is proportional to the rate of energy dissipation per unit plan area e c g x the ratio of the change in the energy flux between x 1 and x 4 to the shallow water depth versus the breaker class is shown in fig 5 as expected the greater the breaker intensity the larger the energy dissipation rate consideration of the efficiency of the wave attenuator at the downstream end of the wave tank discussed in appendix c suggests that the effects of wave reflection from the end of the tank are negligible 3 7 wave setup in fig 6 the dimensionless wave setup at the reef flat within the inner region of the surf zone at wave gage no 4 is plotted as a function of the offshore wave height to shallow water depth ratio h 1 h s in addition the experimental data from yao et al 2009 are plotted together with an exponential curve fit to enable interpolation of the data it is apparent from the exponential extension that the relationship observed by yao et al 2009 agrees with experimental results of the present study the latter lie over a lower range of h 1 h s compared to those of yao et al 2009 thus η 4 h s increases with h 1 h s 4 breaker classification model breaking waves were classified using the machine learning concept with the classification based on offshore wave characteristics which represent the input attributes three classes of waves arose in the laboratory experiments conducted in this study plunging breakers spilling breakers and nonbreaking waves other breaker types did not occur due to the combination of the bottom geometry and wave features of the test cases the computational tool used to build and train the nn is the weka tool the nn model presented as a block neural network in fig 7 is supported by two other blocks at its input normalization and output classifier the non dimensional input attributes used in this study are the offshore wave height to shallow water depth ratio a 1 h 1 h s and the non dimensional input frequency a 2 f h 1 g each of the three blocks is analyzed next the high frequency cases f 1 5 h z are excluded from the training process as non representative yielding a total of 81 training instances the method is limited by the range of input attributes used to train the model i e a q a q m i n a q m a x where q is the attribute index and the limit values are a 1 m i n 0 144 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 111 4 1 normalization block the weka tool achieves excellent performance when the input attributes are normalized the normalization range is 1 to 1 for the input parameters thus the attributes are normalized using the expression 15 a q n o r m 2 a q a q m i n a q m a x a q m i n 1 4 2 neural network block the multilayer perceptron used for the classification model uses one hidden layer which corresponds to the two black nodes in fig 8 according to the formulation introduced in section 2 we have m 1 k 0 2 k 1 2 and k 2 3 thus the vectors for the feedforward algorithm are constructed as follows 16 s 0 a 1 n o r m a 2 n o r m t 17 x 1 1 s 0 t t 18 w 1 w 1 1 1 w 1 2 1 w 1 3 1 w 2 1 1 w 2 2 1 w 2 3 1 19 d 1 λ 1 e w 1 x 1 20 v 1 1 1 t 21 s 1 d 1 1 v 1 22 x 2 1 s 1 t t 23 w 2 w 1 1 2 w 1 2 2 w 1 3 2 w 2 1 2 w 2 2 2 w 2 3 2 w 3 1 2 w 3 2 2 w 3 3 2 24 d 2 λ 1 e w 2 x 2 25 v 2 1 1 1 t 26 y class d 2 1 v 2 where y class is a 3 b y 1 vector and the matrices w i arose from the training procedure a matlab function is created for the neural network block as shown in fig 9 this function can be called by a computer program with input arguments s 0 w 1 and w 2 and returns the y class vector 4 3 classifier block each node at the output layer corresponds to a class and can be identified as the three bright nodes in fig 8 the nn according to the input attribute predicts the class by activating one of the output nodes while the rest of the nodes remain inactive activation means that the value of y j tends to 1 while an inactive node means that it tends to 0 therefore the classifier block checks every node output value y j the predicted class arises from the active node the class function is defined as 27 c l a s s round j 1 3 j y j where y j is the nn output and j is the node index the class function outputs 1 2 or 3 which as in fig 3 corresponds to nonbreaking spilling and plunging classes respectively a worked example for the classification model is given in appendix b 4 4 evaluation of the classification model the model was trained using the weka tool and the resulting weight matrices were obtained 28 w 1 2 3926 16 7195 5 9197 7 1054 17 0782 2 9406 29 w 2 4 9146 11 9879 5 8598 4 3659 11 0505 11 9892 3 7734 5 3143 10 6430 in this study the laboratory data are limited and no other datasets are used thus the multilayer perceptron is evaluated based on the 10 fold cross validation method which is a simple variant of the holdout method witten et al 2011 in the 10 fold cross validation the original data set is randomly partitioned into 10 equal size subsamples of the 10 subsamples a single subsample is retained as the validation data for testing the model and the remaining 9 subsamples are used as training data the cross validation process is then repeated 10 times with each of the 10 subsamples used exactly once as the validation data the 10 results from the folds are then combined to produce a single estimation the advantage of this method is that all observations are used for both training and validation and each observation is used for validation exactly once the performance metrics based on this method are presented in table 2 and table 3 while the confusion matrix is shown in table 4 the definitions of the various performance metrics are not analyzed here for details of these definitions see witten et al 2011 the overall tpr is very high but not 100 this is due to the three incorrectly classified instances where the actual class was nonbreaking wave but the prediction suggested a spilling breaker the incorrectly classified instances correspond to a marginal case that could be classified as nonbreaking or extremely light spilling based on visual observation set 8 test 7 5 numeric prediction model the position of wave breaking the wave setup and the difference in energy flux between x 1 and x 4 are predicted using the same machine learning method as for the breaker classification model the position of wave breaking is measured from the edge of the reef as defined in fig 2 the wave setup and energy flux are estimated as described in section 3 2 weka tool is used to build and train the nn the nn model presented as a block in fig 10 is supported by two other blocks at its input normalization and output denormalization the non dimensional input attributes are again the offshore wave height to shallow water depth ratio a 1 h 1 h s and the non dimensional frequency a 2 f h 1 g the maximum and minimum limit values for the input attributes for each model are provided separately in sections 5 3 5 4 and 5 5 the normalization block is identical to the one used in the classification model thus it is not presented again the neural network and denormalization blocks are analyzed next again from the training process the high frequency cases f 1 5 h z are excluded 5 1 neural network block the multilayer perceptron used for the numeric prediction model contains one hidden layer which corresponds to the two black nodes in fig 11 according to the formulation in section 2 we have m 1 k 0 2 k 1 2 and k 2 1 thus the vectors for the feedforward algorithm are constructed as follows 30 s 0 a 1 n o r m a 2 n o r m t 31 x 1 1 s 0 t t 32 w 1 w 1 1 1 w 1 2 1 w 1 3 1 w 2 1 1 w 2 2 1 w 2 3 1 33 d 1 λ 1 e w 1 x 1 34 v 1 1 1 t 35 s 1 d 1 1 v 1 36 x 2 1 s 1 t t 37 w 2 w 1 1 2 w 1 2 2 w 1 3 2 38 y numeric w 2 x 2 where y numeric is a 1 b y 1 vector i e a scalar the matrices w i arose from the training procedure a matlab function is created for the neural network block as shown in fig 12 this function can be called with input arguments s 0 w 1 and w 2 and returns the y numeric 5 2 denormalization block each node at the output layer corresponds to a normalized numeric prediction for the output attribute value within the range of 1 to 1 and can be identified as the bright node in fig 11 a linear relation is used to denormalize the neural network block output to obtain the numeric prediction within the original range i e 39 a p r e d i c t e d y m a x y m i n y n o r m 1 2 y m i n where a p r e d i c t e d is by definition equal to a q d e n o r m i e a p r e d i c t e d a q d e n o r m y n o r m is the normalized numeric prediction and y m i n and y m a x are the minimum and maximum values of the experimental data for each of the output attributes x b h s η 4 h s and f 1 f 4 f 1 these values comprise model parameters and are provided for each model separately in sections 5 3 5 5 5 3 model for estimating position of wave breaking the model for estimating position of wave breaking was trained using the weka tool the dataset used to train the model are considered classified if they include only plunging or only spilling breaker instances and unclassified if they include both spilling and plunging instances given the limited dataset size the multilayer perceptron is again evaluated based on the 10 fold cross validation witten et al 2011 the performance metrics for the three cases are compared in table 5 the reader interested in the performance metrics definitions is referred to witten et al 2011 generally the highest performance is achieved for the model that was trained using only data for plunging breakers for this model highest correlation coefficient between predicted and actual results and the lowest error rate were achieved as is evident from table 5 and fig 13 a the spilling breaker trained model had the lowest correlation coefficient and the highest error rates table 5 and fig 13b the low performance of this model may be related to inaccuracies in determination of the exact position of breaking for spilling breakers as well as to typical difficulty in visually capturing spilling breakers duncan 2001 the model for prediction of the position of wave breaking that is trained using both plunging and spilling breakers table 5 and fig 13c performed better than the model trained using only spilling breakers the limit values for the input attributes are a 1 m i n 0 348 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 111 while the model parameters are y m i n min x b h s 1 053 and y m a x max x b h s 14 737 finally the resulting weight matrices for the unclassified method are 40 w 1 0 2911 2 3546 0 4037 5 0823 6 0686 1 7972 41 w 2 1 3828 0 7820 1 6057 5 4 evaluation of the model for estimating the wave setup the model was trained using the weka tool and the resulting weight matrices are obtained 42 w 1 0 2546 0 3184 4 9501 0 4747 2 2443 0 3817 43 w 2 1 6897 0 7684 2 7369 τhe multilayer perceptron is evaluated based on the 10 fold cross validation method the performance metrics of the numeric prediction model for the dimensionless wave setup at the location x 4 of wave gage no 4 η 4 h s are shown in table 6 the model was trained using the three datasets including all the three classes under investigation a correlation coefficient between predicted and actual results of was achieved 0 89 table 6 and fig 14 the limit values for the input attributes are a 1 m i n 0 144 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 111 while the model parameters are y m i n min η 4 h s 0 001 and y m a x max η 4 h s 0 103 5 5 evaluation of the model for estimating the energy flux difference between x 1 and x 4 the model was trained using the weka tool resulting in the following weight matrices 44 w 1 0 0168 1 0692 1 5943 0 2360 2 9062 5 1841 45 w 2 2 0263 3 0040 1 6417 τhe multilayer perceptron is evaluated based on the 10 fold cross validation method the performance metrics of the numeric prediction model for the energy flux difference between x 1 and x 4 f 1 f 4 h s are shown in table 7 the model was trained using the whole dataset including all the three classes under investigation and achieved high performance with a correlation coefficient of almost 0 95 table 7 and fig 15 the limit values for the input attributes are a 1 m i n 0 144 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 089 while the model parameters are y m i n min f 1 f 4 h s 1 295 and y m a x max f 1 f 4 h s 107 539 6 conclusions use of neural network techniques cf deo and jagdale 2003 is demonstrated in providing predictions based on empirical data of key parametric characteristics of wave breaking over a fringing reef for given characteristics of offshore waves and reef geometry the characteristics considered for given offshore wave attributes h 1 h s and f h 1 g and bottom geometry include type and position of wave breaking the wave setup downstream of breaking and the rate of energy dissipation in the form of the difference in energy flux between the incident and broken wave over the shallow water depth as demonstrated in deo and jagdale 2003 corresponding models can also be developed to provide predictions of incipient breaking wave height h b and breaker depth h b the particular empirical data used to train the neural network models are based on laboratory experiments involving monochromatic waves impinging on an idealized fringing reef a matrix formulation considered here makes use of neural networks in a straightforward and easily implementable manner in a subroutine two multilayer perceptron based models are developed trained and tested based on a single slope fringing reef for different shallow water depths the trained classification model is shown to correctly predict the type of wave breaking with a success rate of 96 implying that the neural networks method outperforms previously used criteria for classifying breaker types see yao et al 2013 for example the numeric prediction models for the dimensionless position of wave breaking for plunging breakers and for spilling breakers as well as for wave setup at x 4 and for the reduction in energy flux across the reef between locations x 1 and x 4 have performance ratings characterized by respective correlation coefficients of 0 99 0 82 0 89 and 0 94 between predicted and actual values the somewhat modest correlation 0 82 between prediction and the actual result for the position of breaking of spilling breakers is believed to be associated with inaccuracies in determination of the exact position of breaking and to the difficulty in visually capturing spilling breakers in observations high correlation 0 94 between predicted and actual values of the reduction in energy flux across the reef is achieved in spite of the fact that the model was trained using data from a wave tank that included partial reflection characterized by 7 mean deviation among non breaking waves from the downstream end of the tank the method can be extended to provide predictive models for consideration of a range of natural coastal conditions random waves and various bottom profiles and complex geometry based on training and testing of the models using representative field and laboratory observational data in support of accurate prediction of near shore wave phenomena the results of the current laboratory experiments consistent with yao et al 2009 suggest that for monochromatic waves over an idealized fringing reef the ratio of the offshore wave height and the xdownstream shallow water depth h 1 h s plays a significant role on the wave transformation features as the waves propagate inshore over the reef flat other parameters such as the dimensionless wave frequency f h 1 g also affected the wave transformation processes but to a lesser degree the main observations based on the experiments are 1 the rate of energy dissipation during breaking is estimated for different breaker types the greater the breaker intensity class the larger the rate of dissipation of energy 2 incipient breaking for plunging breakers in general occurs earlier compared to that for spilling breakers i e x b p l u n g i n g x b s p i l l i n g 3 consistent with yao et al 2009 the dimensionless wave setup at the reef flat within the surf zone η 4 h s increases with the ratio of incident wave height to shallow water depth h 1 h s 4 correlation exists between the type of wave breaking and h 1 h s as well as between the dimensionless breaking position x b h s and h 1 h s acknowledgments special thanks to ms kelly cooper and the office of naval research for sponsoring this study under grant n000141010472 and to fuxian gong for her help in conducting the laboratory experiments appendix a output parameters table a1 wave height crest and trough amplitudes at x 1 and wave setup at x i i 1 4 as measured by the wave gages mean values over three iterations values in m table a1 set test no h 1 ac 1 at 1 ῆ 1 ῆ 2 ῆ 3 ῆ 4 1 1 0 019 0 011 0 008 0 001 0 000 0 000 0 002 1 2 0 033 0 018 0 016 0 002 0 000 0 001 0 003 1 3 0 036 0 019 0 017 0 002 0 000 0 002 0 003 1 4 0 049 0 024 0 025 0 001 0 000 0 003 0 003 1 5 0 060 0 032 0 028 0 002 0 002 0 000 0 004 1 6 0 075 0 045 0 031 0 004 0 001 0 000 0 007 1 7 0 077 0 047 0 029 0 005 0 001 0 001 0 006 1 8 0 066 0 044 0 022 0 006 0 003 0 002 0 005 1 9 0 034 0 019 0 014 0 001 0 001 0 001 0 003 1 10 0 056 0 029 0 027 0 001 0 002 0 001 0 007 1 11 0 061 0 031 0 030 0 001 0 002 0 002 0 006 1 12 0 086 0 047 0 039 0 002 0 003 0 002 0 008 1 13 0 037 0 016 0 020 0 001 0 001 0 001 0 003 1 14 0 047 0 024 0 023 0 002 0 002 0 001 0 003 1 15 0 083 0 045 0 038 0 001 0 002 0 000 0 010 8 1 0 021 0 010 0 011 0 000 0 001 0 001 0 000 8 2 0 061 0 034 0 027 0 001 0 001 0 002 0 003 8 3 0 083 0 054 0 029 0 006 0 004 0 003 0 005 8 4 0 037 0 020 0 018 0 000 0 001 0 001 0 001 8 5 0 063 0 032 0 031 0 000 0 001 0 002 0 005 8 6 0 095 0 051 0 044 0 000 0 001 0 002 0 007 8 7 0 041 0 018 0 023 0 000 0 002 0 001 0 001 8 8 0 053 0 030 0 023 0 000 0 002 0 001 0 004 9 1 0 023 0 011 0 013 0 000 0 000 0 001 0 000 9 2 0 059 0 032 0 027 0 002 0 002 0 002 0 000 9 3 0 077 0 050 0 027 0 006 0 006 0 004 0 006 9 4 0 041 0 022 0 019 0 000 0 000 0 002 0 001 9 5 0 066 0 034 0 033 0 001 0 000 0 003 0 001 9 6 0 084 0 045 0 039 0 001 0 001 0 004 0 004 9 7 0 044 0 021 0 023 0 000 0 001 0 001 0 001 9 8 0 057 0 031 0 025 0 000 0 001 0 003 0 003 appendix b classification model worked example b 1 normalization block we test a spilling breaker case where a 1 0 353 a 2 0 029 thus the normalized values are calculated as see section 4 for a q m i n m a x values a 1 n o r m 2 a 1 a 1 m i n a 1 m a x a 1 m i n 1 2 0 353 0 144 0 904 0 144 1 a 1 n o r m 0 451 a 2 n o r m 2 a 2 a 2 m i n a 2 m a x a 2 m i n 1 2 0 029 0 021 0 111 0 021 1 a 2 n o r m 0 825 b 2 neural network block the attribute vector is s 0 a 1 n o r m a 2 n o r m t s 0 0 451 0 825 t the input vector for the hidden layer is x 1 1 s 0 t t x 1 1 0 451 0 825 t the weight matrix for the hidden layer is calculated from the training procedure and provided from weka tool w 1 2 393 16 719 5 920 7 105 17 078 2 941 then the diagonal matrix is calculated d 1 λ 1 e w 1 x 1 λ 1 e 2 393 16 719 5 920 7 105 17 078 2 941 1 0 451 0 825 λ 1 e 5 059 1 820 d 1 λ 158 448 7 174 d 1 158 448 0 0 7 174 v 1 1 1 t s 1 d 1 1 v 1 158 448 0 0 7 174 1 1 1 0 006 0 0 0 139 1 1 s 1 0 006 0 139 x 2 1 s 1 x 2 1 0 006 0 139 t w 2 4 915 11 988 5 860 4 366 11 051 11 989 3 773 5 314 10 643 d 2 λ 1 e w 2 x 2 λ 1 e 4 915 11 988 5 860 4 366 11 051 11 989 3 773 5 314 10 643 1 0 006 0 139 λ 1 e 5 656 2 625 2 323 d 2 λ 286 914 1 072 11 211 d 2 286 914 0 0 0 1 072 0 0 0 11 211 v 2 1 1 1 t s 2 d 2 1 v 2 286 914 0 0 0 1 072 0 0 0 11 211 1 1 1 1 0 004 0 0 0 0 933 0 0 0 0 089 1 1 1 s 2 0 004 0 933 0 089 y s 2 0 004 0 933 0 089 t b 3 classifier block using the class function we obtain the number that corresponds to the predicted class c l a s s round j 1 3 j y j round 1 y 1 2 y 2 3 y 3 c l a s s round 1 0 004 2 0 933 3 0 089 round 2 137 c l a s s 2 c l a s s 2 is interpreted as a spilling breaker which is a correct prediction appendix c wave transformation and wave absorber c 1 wave transformation the measured time series for the surface elevation η i and its wave spectrum at each of the four locations x i i 1 2 3 4 are shown in fig c1 as a first observation the shoaling effect is apparent from the increase in wave height as the wave travels from location x 1 to x 2 also the wave profile becomes skewed when it propagates from deep to shallow water creating a non symmetric profile at the reef edge the location x 3 lies within the transition region see basco and yamashita 1986 that is the region between the break point x b x 2 x b to the point x t x 4 where the mean surface elevation changes from essentially level to an increasing slope wave set up when the wave breaks at location x b it does so as a plunging fig c1 a and b or spilling breaker fig c1 c and d in fig c1 e and f the wave does not break the surface elevation η 4 at location x 4 represents a wave within the inner region that is downstream of the transition region of the surf zone fig c1 time series a c and e and wave spectrum b d and f of surface elevation for three different breaking classes as measured from the four wave gages where η i is the surface elevation in m at wave gage i 1 2 4 and s η i is the corresponding wave spectrum in m 2 h z fig c1 c 2 efficiency of wave absorber the efficiency of the wave attenuator at the downstream end of the wave tank in the laboratory experiments was evaluated based on the nonbreaking test cases using the following steps 1 the first fully developed time series for the wave profile at gage no4 was obtained and expanded over time by repeating it multiple times as a periodical signal 2 the area under the wave spectrum of this periodical signal of the first wave profile was determined 3 steps 1 and 2 were repeated for the next profiles for 40sec after the first profile 4 the deviation between the first and each of the next profiles defined as a r e a u n d e r n t h p r o f i l e a r e a u n d e r 1 s t p r o f i l e 1 were determined 5 the mean deviation from the first profile was obtained by averaging the deviations calculated in step 4 the mean deviation among all the nonbreaking cases for all sets tests iterations was less than 7 while this is not ideal for the scope of our analysis we assume that the effect of the reflection is negligible 
23722,the characteristics of wave breaking in shallow waters that are of interest include whether a wave will break the type of breaking that will occur the breaking wave height breaking depth the position of breaking the wave setup and the transformation of the broken wave for given offshore wave characteristics and given bottom profile various methods have been proposed in the literature to estimate these wave breaking characteristics deo et al 2003 used a neural network approach to predict the breaking wave height and breaking depth for waves transforming over a range of simply sloped bottoms the deo et al approach is extended here to predict other characteristics of wave breaking including the type of wave breaking the position of breaking the wave setup and the rate of dissipation of wave energy in the case of waves impinging on a fringing reef observations from a series of specially conducted laboratory experiments involving monochromatic waves impinging on an idealized reef are used to develop and train respective models the input parameters to the neural network models are the ratio of offshore wave height to the shallow water depth of the flat section of the reef h 1 h s and the wave frequency parameter f h 1 g the breaker type classification model developed predicts the type of breaker with a success rate of 96 outperforming previously used criteria for classifying breaker types the numeric prediction models for the dimensionless position of wave breaking for plunging and spilling breakers for wave setup and for the reduction in energy flux across the reef have performance ratings characterized by respective correlation coefficients of 0 99 0 82 0 89 and 0 94 the modest value for the correlation between prediction and the actual result for the position of breaking of spilling breakers is believed to be associated with inaccuracies in determination of the exact position of breaking and to difficulty in visually capturing spilling breakers in observations high correlation between predicted and actual values of the reduction in energy flux across the reef is achieved in spite of the fact the model was trained using data from a wave tank that included partial reflection characterized by 7 mean deviation among non breaking waves from the downstream end of the tank the method can be extended to provide predictive models for consideration of a range of natural coastal conditions random waves and various bottom profiles and complex geometry based on training and testing of the models using representative laboratory field and or flow simulation in support of accurate prediction of near shore wave phenomena keywords breaking waves breaking classification neural network experimental investigation fringing reef 1 introduction the propagation of ocean waves from deep to shallow water has received special attention from engineers and researchers in view of the large amount of energy inherent in ocean waves as a wave travels onshore its characteristics are transformed leading to increase in the wave steepness due to shoaling and the evolution of the energy distribution over the frequency spectrum goda 1975 this energy can be impactful for nearshore structures or floating vessels in such cases it may be desirable to have the waves break upstream of the area to be protected so that some of the wave energy is dissipated that is why breakwaters are constructed to protect floating vessels and nearshore structures coastal engineering research center 1984 another coastal problem which is analyzed in coastal engineering research center 1984 and is related to breaking waves is sediment mobilization and coastal erosion a three part work presented in brocchini et al 2004 kennedy et al 2006 and piattella et al 2006 deals with the breaking wave induced macrovortices this work is based on experimental computational and analytical methods analyzing rip current effects and the mixing features of the shallow flows occurring around submerged structures used for coastal protection in many cases the natural environment can act as a breakwater where the main parameter of interest is the bottom profile in designing coastal defenses and structures it is necessary to predict the breaking wave characteristics of waves including the location where they will break the breaking wave height the type of breaking that will occur and the resulting wave setup the process of wave transformation and wave breaking is non linear stokes cnoidal and stream function theories are used to describe wave profiles preceding wave breakup dean and dalrymple 1991 dean 1972 wave evolution leading to wave breaking is typically followed numerically using methods based on the boussinesq equations yao et al 2012 peregrine 1967 a boussinesq model is derived in veeramony and svendsen 2000 for predicting breaking waves and has been extended in briganti et al 2004 to incorporate turbulence associated with a breaking wave in the surf zone the model proposed by yao et al in yao et al 2012 for the wave profile is compared with their laboratory experiments yao et al 2009 studies based on the assumption of planar beach profiles with mild constant slopes provide simplified mccowan 1894 goda 1970 or more advanced breaking criteria weggel 1972 goda 2010 for the nearshore zone a novel breaking index for fringing reefs extracted from laboratory experiments is provided in yao et al 2013 extensive research has been carried out to model the transformation of the wave height h x as well as the wave setup η x for irregular bottom shapes an approach based on an energy balance and involving consideration of one dimensional gradient of energy flux is sometimes used see for example dally et al 1985 and kweon and goda 1996 according to dally et al 1985 and yao et al 2012 the effect of bottom friction on the surf zone phenomena in fringing reef type profiles is negligible but is important in regions of mild slopes versions of the models of the type described above for wave transformation in the coastal region are used to account for various factors including wind and offshore wave conditions type of bottom profile bottom material and other features and processes the models typically require empirically determined parameters derived through statistical curve fit to laboratory or field data simple empirical criteria such as the wave height to depth ratio criterion for wave breaking are used under some conditions with the breaking position measured from the shore typically obtained from the ratio of the depth at breaking to the beach slope dean and dalrymple 1991 similarly the surf similarity parameter is an empirically derived index to classify the breaker type as a function of the bottom slope and breaking wave steepness battjes 1974 the criteria in both cases are provided for planar beach profiles with mild constant slopes an extensive experimental study to judge and compare the validity of various criteria including breaking type classification breaking location surf zone width and the incipient breaker height and depth indices is considered in yao et al 2013 modern machine learning techniques have been proposed during the last decade incorporating data mining algorithms witten et al 2011 to train models that can provide good empirical models the concept of a neural network nn for wave forecasting was introduced by deo et al in deo and naidu 1999 and deo et al 2001 the idea was extended to prediction of the wave height and depth at wave breaking deo and jagdale 2003 using a nn model that was trained based on classic criteria for wave breaking provided in coastal engineering research center 1984 and validated using several experimental data sets over a broad range of conditions here predictive neural network models for parametric characterization of wave breaking over a fringing reef in the coastal region for given offshore wave characteristics and bottom geometry are developed based on the machine learning concept and laboratory experiments the characteristics considered include classification of the type of wave breaker the position of wave breaking the wave setup downstream of position of breaking and the rate of dissipation of wave energy during breaking the machine learning technique that is chosen is the multilayer perceptron which is a type of feedforward artificial nn baum 1988 the networks are trained using observations from laboratory experiments the models for the wave characteristics are distinguished see witten et al 2011 as the classification model as providing prediction for data available in non numeric or nominal value form such as spilling plunging or non breaking waves and numeric prediction models as providing predictions for data available in numeric form such as location of breaking wave setup and energy flux the proposed method is aimed to have the following advantages 1 the method is oblivious to whether the underlying physical process is linear or nonlinear with the multilayer perceptron accommodating possible nonlinear interactions that may characterize the physical processes through seeking a statistical relationship between the input parameters and the resulting observed data 2 a matrix formulation expresses the nn in a compact form 3 it facilitates simple extensions of the training of the models through use of larger or more representative datasets for improvement and development of robust models 4 it facilitates consideration of a variety of realistic features which may be difficult to model theoretically e g offshore wind or current characteristics bottom material etc through expansion of the input attributes via a new training procedure that generates a fresh model 5 datasets can be generated from laboratory or field experiments or numerical simulations or their combination 6 evaluation and improvement of the model is achieved through field or laboratory experiments 7 nominal or non numeric attributes can be included in the form of representative integer numbers the limitations of the method include 1 the model is based on range of the data set used for training the model 2 a good distribution of samples in the training data set is required and 3 a nn model does not provide a single regression equation relating inputs and outputs instead the model serves as the equation for the relationship 2 matrix formulation of the neural network the machine learning technique chosen to predict breaking wave phenomena is based on a multilayer perceptron a type of feedforward artificial nn baum 1988 the networks are trained based on experimental datasets using a collection of open source machine learning algorithms called weka witten et al 2011 that is typically used for data mining tasks weka contains tools for data pre processing classification regression clustering association rules and visualization specifically a back propagation algorithm of the weka tool is utilized here details regarding multilayer perceptrons and the training procedure are provided in witten et al 2011 a compact mathematical formulation is presented in this section according to the multilayer perceptron concept three types of layers are identified the input the hidden and the output layers the input and output are single layers while the hidden layer can be single or multiple the following definitions along with the diagram in fig 1 establish the infrastructure for a compact description of the nn based on a matrix notation the notation is defined below i 1 m hidden layer index j 1 k m node index m number of hidden layers k i number of nodes at layer i k 0 number of attributes k m 1 number of output nodes a k 0 b y 1 attribute vector x i k i 1 1 b y 1 input vector at hidden layer i s i k i 1 b y 1 output vector at hidden layer i λ u transformation operation for an n b y 1 vector u to an n b y n diagonal matrix w i k i b y k i 1 1 weight matrix at layer i d i k i b y k i diagonal matrix v i k i b y 1 all ones vector at layer i y k m 1 b y 1 output vector the attribute vector is defined as 1 a a 1 a 2 a k 0 t which is by definition equal to the zero layer output vector i e a s 0 this perspective helps the notation to become much more compact the zero layer output vector is defined as 2 s 0 s 1 0 s 2 0 s k 0 0 t the input vector for each node in hidden layer i is defined as 3 x i 1 s i 1 t t the definition of the weight matrix is presented below the weight elements are provided by the training algorithm see backpropagation method in witten et al 2011 4 w i w 1 1 i w 1 2 i w 1 k i 1 1 i w 2 1 i w 2 2 i w 2 k i 1 1 i w k i 1 i w k i 2 i w k i k i 1 1 i in order to use the matrix formulation some special transformations need to be executed thus the transformation of an n by 1 vector u to a n by n diagonal matrix is denoted by the operator λ which is defined as 5 λ u u 1 0 0 0 u 2 0 0 0 u n the sigmoid activation function which is used within the hidden layer to define the output of each node is given by 6 s i d i 1 v i where d i λ 1 e w i x i and v i 1 1 1 t the output vector is defined as 7 y y 1 y 2 y k m 1 t the output node uses a sigmoid or a linear activation function for the classification and numeric prediction respectively the sigmoid activation function uses the same relation as in the hidden layer and by definition is equal to the output layer output vector using the hidden layer notation i e y class s m 1 thus for the wave breaking classification one obtains 8 y class d m 1 1 v m 1 for the numeric prediction the linear activation function is simply a linear combination of the weight matrix with the output layer s input vector i e 9 y numeric w m 1 x m 1 the ability provided by the nn approach to train and build models based on data obtained by a variety of methods such as numerical simulations laboratory or field experiments for various bottoms and wave conditions is very promising in addition the matrix formulation makes the use of the method very simple since a subroutine which performs the matrix operations can be called from any computer program see figs 9 and 12 3 laboratory based breaking wave data set the nn model was trained and validated using breaking wave data set obtained from laboratory experiments over an ideal fringing reef conducted in a wave tank at florida atlantic university 3 1 experimental setup the wavetank used is a fresh water filled open top tank made of transparent plexiglas it is 18 29 m long with a cross section of 1 22 m 1 22 m as depicted in fig 2 at one end a flap type wavemaker with a paddle hinged to the bottom generates the waves while at the other end a wave attenuator absorbs the wave energy see appendix c for wave absorber efficiency evaluation another absorber is placed behind the wavemaker a 0 134 slope was inserted in the tank 3 23 m away from the paddle forming the reef face a shallow water section parallel to the undisturbed free surface extends from the reef edge to the wave absorber simulating the reef flat section of an ideal fringing reef both the slope and the parallel section are made of impact resistant slippery ultra high molecular weight uhmw polyethylene with a friction coefficient of 0 19 to minimize bottom friction effects the reef height is 0 408 m the input parameters are the deep h d and shallow h s water depths which are related as h s h d 0 408 m the wavemaker camshaft radius r which is related to the length of the paddle stroke s and the wavemaker rotational frequency f for the r and h d ranges used the stroke can be approximated by a parametric linear relationship as s r h d 1 9071 h d r 0 0027 h d where all dimensions are in m the rest of the geometry is fixed the output parameters are obtained by four wave gages placed along the tank that measure the local instantaneous surface elevation η longitudinally the origin is set at the reef edge 6 27 m away from the paddle vertically it is at the undisturbed water level the x axis points to the wave propagation while the z axis positive direction is against gravity gage no1 was placed at x 1 3 14 m from the reef edge to measure the offshore wave characteristics gage no2 was placed at the reef edge x 2 to estimate wave shoaling effects gage no4 was placed at x 4 3 00 m from the reef edge to measure the wave condition at the flat section of the reef after breaking when breaking occurs gage no3 is located at x 3 where x 2 x 3 x 4 somewhere between the breaking x b and transition x t points the transition point x t is defined after basco and yamashita 1986 as the point where the mean water surface changes from essentially level to an increasing slope wave set up the actual breaking position x b was obtained from video footage of the experiments and x 3 only serves as an approximate estimate of x b the breaker type classification as plunging spilling or nonbreaking is also justified visually based on the definitions in dean and dalrymple 1991 three sets of experiments were conducted the in shore shallow water depth h s was selected for each set and the wavemaker frequency and camshaft radius which govern the paddle stroke varied generating different monochromatic offshore wave profiles for each wave condition the experiments were conducted three times in order to validate the repeatability of our measurements the three in shore shallow water depths selected were 0 095 m 0 120 m and 0 160 m and the wavemaker frequency and the camshaft radius considered were respectively in the ranges 0 35 1 60 h z and 0 064 0 140 m thereby allowing an examination of 31 combinations of wave conditions and shallow water depths see table 1 the sampling rate for the wave gages was 20 h z and each test was conducted for a period of 1 m i n a 40 s time window was identified as representing steady state conditions at each gage location yielding a discrete time series of n 801 samples per test for data analysis to eliminate the effects of residual waves from the previous test in the wave tank each test was separated from the other by an appropriate time delay 3 2 dimensionless input parameters the main length parameters that appear in the problem are the offshore wave height h 1 offshore wave length λ 1 and shallow water depth h s the non dimensional frequency of the incident wave as well as the wave setup at each position i are respectively defined as f h 1 g and η i h s the longitudinal wave breaking position is expressed in a dimensionless form as x b h s the incident wave height to shallow water depth ratio h 1 h s is as we will see later the non dimensional parameter with the highest influence during the wave transformation and breaking processes 3 3 data analysis the four capacitance wave gages have a length of 0 5 m and a linear response each they are integrated in a data acquisition system that synchronizes them and incorporates the analog to digital converters adc providing discrete time series to the host computer the data are displayed and stored in the host computer the adc resolution is 12 b i t thus the surface elevation in meters is obtained by a simple linear relation of the form η i c o u n t 0 5 2 12 1 c o u n t c o u n t 0 where c o u n t is each discrete recorded value c o u n t 0 is the discrete value that corresponds to the still water level swl and the index i 1 4 corresponds to the wave gage number c o u n t 0 is calculated as the average of the first 100 samples before the wavemaker operates η i is the discrete time series of the surface elevation since each count is recorded every 0 05 s which corresponds to η i n η i n t s where n is the sample number and t s 0 05 s is the sampling period for monochromatic waves average wave height h i and average crest and trough amplitudes a c i and a t i respectively i 1 4 are defined as mean values over a 40 s duration based on the recordings of the surface elevation in the time domain for each wave period the wave height ℋ i p is defined as the difference between the maximum and the minimum surface elevation ζ i p at station i during the wave period p p is the index number of the wave component corresponding to each wave period within the 40 s duration and m is the total number of wave components over this duration thus the average wave parameters are defined as a c i p 1 m max ζ i p m a t i p 1 m min ζ i p m and h i a c i a t i the wave setup η i is defined as the mean water level for the steady state duration i e η i n 1 n η i n n the corrected crest and trough amplitudes are defined as a t c i a t i η i and a c c i a c i η i from the spectrum of the surface elevation peaks at harmonic frequencies can be identified at x 1 the dominant frequency always matches the wavemaker frequency f while this is not always the case for the locations x 2 x 3 and x 4 on the basis that irregular waves can be treated as a superposition of regular waves with constant frequencies and amplitudes goda 1975 the amplitudes of each harmonic component is calculated by applying fast fourier transform fft to each discrete time series of the surface elevation over the 40 s steady state duration thus the wave amplitude at each location x i which corresponds to each harmonic component f m m f is estimated as a i m s η i q m where s η i q m 2 y i q m n y i is the fft of η i which by definition is y q n 1 n η n e 2 π j n 1 q 1 n q m is the spectrum sample number corresponding to frequency f m i is the gage number j is the imaginary unit m is the number of the harmonic component with m 1 corresponding to the dominant frequency n is the length of vector η i in addition the wave length λ i m wave number k i m group speed c g i m and phase speed c p i m for each test are determined from the dispersion relation applied at each gage location and for multiple harmonics based on our observations the dominant frequency along with the first 6 harmonics carry most of the wave energy so the higher harmonics are considered negligible using the same approach to consider each harmonic component independently the wave energy and energy flux are calculated as e i m 1 8 ρ g 2 a i m 2 and ℱ i m c g i m e i m respectively where ρ is the water density and g is the gravitational acceleration the total energy flux at each gage is then estimated as the sum of the wave fluxes at each harmonic component thus ℱ i m 1 6 ℱ i m 3 4 breaker type classifying the type of wave breaking is important since the type of wave breaking significantly governs the energy dissipation in the surf zone iafrat 2011 as well as flow processes downstream of breaking peregrine 1967 dally et al 1985 kweon and goda 1996 the surf similarity parameter battjes 1974 which is the standard classification criterion for plane slopes does not predict the breaker type effectively in the case of a fringing reef yao et al 2013 consistent with yao et al 2013 the ratio of incident wave height to shallow water depth h1 hs is used to characterize the classification fig 3 only three classes of wave types were observed in the laboratory tests plunging breakers spilling breakers and nonbreaking waves the criteria developed by yao et al 2013 imply that 10 plunging breakers occur if h 1 h s 0 56 11 spilling breakers occur if 0 36 h 1 h s 0 56 12 no breaking occurs if h 1 h s 0 36 in fig 3 the above criteria can be partially validated however some overlapping occurs an overall true positive rate tpr of 81 5 is achieved using traditional criteria 10 12 overlapping also occurred in the results provided in yao et al 2013 a generalized criterion is necessary to provide more accurate classification and enable prediction of the breaker types over various reef profiles materials and offshore conditions a machine learning approach is proposed in the next section 3 5 position of wave breaking a criterion is developed empirically in yao et al 2013 to distinguish between waves that break on the sloping reef face and those that break in the shallow water reef flat 13 breaking on reef face if h 1 h s 0 83 14 breaking on reef flat if h 1 h s 0 83 this criterion is found to be generally true in the present study as can be seen in fig 4 an approximate parabolic relationship between x b h s and h 1 h s is evident from the figure in the present notation breaking on the reef face implies x b h s 0 an alternative machine learning approach is proposed in section 5 that enables predicting the location of the wave breaking from the reef edge it may be observed in fig 4 that the breaking point for plunging breakers occurs earlier lower values of x b h s than for spilling breakers 3 6 energy flux the total energy flux at each gage ℱ i is estimated based on the approach described in section 3 2 according to dally et al 1985 in shallow waters the ratio of the energy flux to the water depth is proportional to the rate of energy dissipation per unit plan area e c g x the ratio of the change in the energy flux between x 1 and x 4 to the shallow water depth versus the breaker class is shown in fig 5 as expected the greater the breaker intensity the larger the energy dissipation rate consideration of the efficiency of the wave attenuator at the downstream end of the wave tank discussed in appendix c suggests that the effects of wave reflection from the end of the tank are negligible 3 7 wave setup in fig 6 the dimensionless wave setup at the reef flat within the inner region of the surf zone at wave gage no 4 is plotted as a function of the offshore wave height to shallow water depth ratio h 1 h s in addition the experimental data from yao et al 2009 are plotted together with an exponential curve fit to enable interpolation of the data it is apparent from the exponential extension that the relationship observed by yao et al 2009 agrees with experimental results of the present study the latter lie over a lower range of h 1 h s compared to those of yao et al 2009 thus η 4 h s increases with h 1 h s 4 breaker classification model breaking waves were classified using the machine learning concept with the classification based on offshore wave characteristics which represent the input attributes three classes of waves arose in the laboratory experiments conducted in this study plunging breakers spilling breakers and nonbreaking waves other breaker types did not occur due to the combination of the bottom geometry and wave features of the test cases the computational tool used to build and train the nn is the weka tool the nn model presented as a block neural network in fig 7 is supported by two other blocks at its input normalization and output classifier the non dimensional input attributes used in this study are the offshore wave height to shallow water depth ratio a 1 h 1 h s and the non dimensional input frequency a 2 f h 1 g each of the three blocks is analyzed next the high frequency cases f 1 5 h z are excluded from the training process as non representative yielding a total of 81 training instances the method is limited by the range of input attributes used to train the model i e a q a q m i n a q m a x where q is the attribute index and the limit values are a 1 m i n 0 144 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 111 4 1 normalization block the weka tool achieves excellent performance when the input attributes are normalized the normalization range is 1 to 1 for the input parameters thus the attributes are normalized using the expression 15 a q n o r m 2 a q a q m i n a q m a x a q m i n 1 4 2 neural network block the multilayer perceptron used for the classification model uses one hidden layer which corresponds to the two black nodes in fig 8 according to the formulation introduced in section 2 we have m 1 k 0 2 k 1 2 and k 2 3 thus the vectors for the feedforward algorithm are constructed as follows 16 s 0 a 1 n o r m a 2 n o r m t 17 x 1 1 s 0 t t 18 w 1 w 1 1 1 w 1 2 1 w 1 3 1 w 2 1 1 w 2 2 1 w 2 3 1 19 d 1 λ 1 e w 1 x 1 20 v 1 1 1 t 21 s 1 d 1 1 v 1 22 x 2 1 s 1 t t 23 w 2 w 1 1 2 w 1 2 2 w 1 3 2 w 2 1 2 w 2 2 2 w 2 3 2 w 3 1 2 w 3 2 2 w 3 3 2 24 d 2 λ 1 e w 2 x 2 25 v 2 1 1 1 t 26 y class d 2 1 v 2 where y class is a 3 b y 1 vector and the matrices w i arose from the training procedure a matlab function is created for the neural network block as shown in fig 9 this function can be called by a computer program with input arguments s 0 w 1 and w 2 and returns the y class vector 4 3 classifier block each node at the output layer corresponds to a class and can be identified as the three bright nodes in fig 8 the nn according to the input attribute predicts the class by activating one of the output nodes while the rest of the nodes remain inactive activation means that the value of y j tends to 1 while an inactive node means that it tends to 0 therefore the classifier block checks every node output value y j the predicted class arises from the active node the class function is defined as 27 c l a s s round j 1 3 j y j where y j is the nn output and j is the node index the class function outputs 1 2 or 3 which as in fig 3 corresponds to nonbreaking spilling and plunging classes respectively a worked example for the classification model is given in appendix b 4 4 evaluation of the classification model the model was trained using the weka tool and the resulting weight matrices were obtained 28 w 1 2 3926 16 7195 5 9197 7 1054 17 0782 2 9406 29 w 2 4 9146 11 9879 5 8598 4 3659 11 0505 11 9892 3 7734 5 3143 10 6430 in this study the laboratory data are limited and no other datasets are used thus the multilayer perceptron is evaluated based on the 10 fold cross validation method which is a simple variant of the holdout method witten et al 2011 in the 10 fold cross validation the original data set is randomly partitioned into 10 equal size subsamples of the 10 subsamples a single subsample is retained as the validation data for testing the model and the remaining 9 subsamples are used as training data the cross validation process is then repeated 10 times with each of the 10 subsamples used exactly once as the validation data the 10 results from the folds are then combined to produce a single estimation the advantage of this method is that all observations are used for both training and validation and each observation is used for validation exactly once the performance metrics based on this method are presented in table 2 and table 3 while the confusion matrix is shown in table 4 the definitions of the various performance metrics are not analyzed here for details of these definitions see witten et al 2011 the overall tpr is very high but not 100 this is due to the three incorrectly classified instances where the actual class was nonbreaking wave but the prediction suggested a spilling breaker the incorrectly classified instances correspond to a marginal case that could be classified as nonbreaking or extremely light spilling based on visual observation set 8 test 7 5 numeric prediction model the position of wave breaking the wave setup and the difference in energy flux between x 1 and x 4 are predicted using the same machine learning method as for the breaker classification model the position of wave breaking is measured from the edge of the reef as defined in fig 2 the wave setup and energy flux are estimated as described in section 3 2 weka tool is used to build and train the nn the nn model presented as a block in fig 10 is supported by two other blocks at its input normalization and output denormalization the non dimensional input attributes are again the offshore wave height to shallow water depth ratio a 1 h 1 h s and the non dimensional frequency a 2 f h 1 g the maximum and minimum limit values for the input attributes for each model are provided separately in sections 5 3 5 4 and 5 5 the normalization block is identical to the one used in the classification model thus it is not presented again the neural network and denormalization blocks are analyzed next again from the training process the high frequency cases f 1 5 h z are excluded 5 1 neural network block the multilayer perceptron used for the numeric prediction model contains one hidden layer which corresponds to the two black nodes in fig 11 according to the formulation in section 2 we have m 1 k 0 2 k 1 2 and k 2 1 thus the vectors for the feedforward algorithm are constructed as follows 30 s 0 a 1 n o r m a 2 n o r m t 31 x 1 1 s 0 t t 32 w 1 w 1 1 1 w 1 2 1 w 1 3 1 w 2 1 1 w 2 2 1 w 2 3 1 33 d 1 λ 1 e w 1 x 1 34 v 1 1 1 t 35 s 1 d 1 1 v 1 36 x 2 1 s 1 t t 37 w 2 w 1 1 2 w 1 2 2 w 1 3 2 38 y numeric w 2 x 2 where y numeric is a 1 b y 1 vector i e a scalar the matrices w i arose from the training procedure a matlab function is created for the neural network block as shown in fig 12 this function can be called with input arguments s 0 w 1 and w 2 and returns the y numeric 5 2 denormalization block each node at the output layer corresponds to a normalized numeric prediction for the output attribute value within the range of 1 to 1 and can be identified as the bright node in fig 11 a linear relation is used to denormalize the neural network block output to obtain the numeric prediction within the original range i e 39 a p r e d i c t e d y m a x y m i n y n o r m 1 2 y m i n where a p r e d i c t e d is by definition equal to a q d e n o r m i e a p r e d i c t e d a q d e n o r m y n o r m is the normalized numeric prediction and y m i n and y m a x are the minimum and maximum values of the experimental data for each of the output attributes x b h s η 4 h s and f 1 f 4 f 1 these values comprise model parameters and are provided for each model separately in sections 5 3 5 5 5 3 model for estimating position of wave breaking the model for estimating position of wave breaking was trained using the weka tool the dataset used to train the model are considered classified if they include only plunging or only spilling breaker instances and unclassified if they include both spilling and plunging instances given the limited dataset size the multilayer perceptron is again evaluated based on the 10 fold cross validation witten et al 2011 the performance metrics for the three cases are compared in table 5 the reader interested in the performance metrics definitions is referred to witten et al 2011 generally the highest performance is achieved for the model that was trained using only data for plunging breakers for this model highest correlation coefficient between predicted and actual results and the lowest error rate were achieved as is evident from table 5 and fig 13 a the spilling breaker trained model had the lowest correlation coefficient and the highest error rates table 5 and fig 13b the low performance of this model may be related to inaccuracies in determination of the exact position of breaking for spilling breakers as well as to typical difficulty in visually capturing spilling breakers duncan 2001 the model for prediction of the position of wave breaking that is trained using both plunging and spilling breakers table 5 and fig 13c performed better than the model trained using only spilling breakers the limit values for the input attributes are a 1 m i n 0 348 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 111 while the model parameters are y m i n min x b h s 1 053 and y m a x max x b h s 14 737 finally the resulting weight matrices for the unclassified method are 40 w 1 0 2911 2 3546 0 4037 5 0823 6 0686 1 7972 41 w 2 1 3828 0 7820 1 6057 5 4 evaluation of the model for estimating the wave setup the model was trained using the weka tool and the resulting weight matrices are obtained 42 w 1 0 2546 0 3184 4 9501 0 4747 2 2443 0 3817 43 w 2 1 6897 0 7684 2 7369 τhe multilayer perceptron is evaluated based on the 10 fold cross validation method the performance metrics of the numeric prediction model for the dimensionless wave setup at the location x 4 of wave gage no 4 η 4 h s are shown in table 6 the model was trained using the three datasets including all the three classes under investigation a correlation coefficient between predicted and actual results of was achieved 0 89 table 6 and fig 14 the limit values for the input attributes are a 1 m i n 0 144 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 111 while the model parameters are y m i n min η 4 h s 0 001 and y m a x max η 4 h s 0 103 5 5 evaluation of the model for estimating the energy flux difference between x 1 and x 4 the model was trained using the weka tool resulting in the following weight matrices 44 w 1 0 0168 1 0692 1 5943 0 2360 2 9062 5 1841 45 w 2 2 0263 3 0040 1 6417 τhe multilayer perceptron is evaluated based on the 10 fold cross validation method the performance metrics of the numeric prediction model for the energy flux difference between x 1 and x 4 f 1 f 4 h s are shown in table 7 the model was trained using the whole dataset including all the three classes under investigation and achieved high performance with a correlation coefficient of almost 0 95 table 7 and fig 15 the limit values for the input attributes are a 1 m i n 0 144 a 1 m a x 0 904 a 2 m i n 0 021 and a 2 m a x 0 089 while the model parameters are y m i n min f 1 f 4 h s 1 295 and y m a x max f 1 f 4 h s 107 539 6 conclusions use of neural network techniques cf deo and jagdale 2003 is demonstrated in providing predictions based on empirical data of key parametric characteristics of wave breaking over a fringing reef for given characteristics of offshore waves and reef geometry the characteristics considered for given offshore wave attributes h 1 h s and f h 1 g and bottom geometry include type and position of wave breaking the wave setup downstream of breaking and the rate of energy dissipation in the form of the difference in energy flux between the incident and broken wave over the shallow water depth as demonstrated in deo and jagdale 2003 corresponding models can also be developed to provide predictions of incipient breaking wave height h b and breaker depth h b the particular empirical data used to train the neural network models are based on laboratory experiments involving monochromatic waves impinging on an idealized fringing reef a matrix formulation considered here makes use of neural networks in a straightforward and easily implementable manner in a subroutine two multilayer perceptron based models are developed trained and tested based on a single slope fringing reef for different shallow water depths the trained classification model is shown to correctly predict the type of wave breaking with a success rate of 96 implying that the neural networks method outperforms previously used criteria for classifying breaker types see yao et al 2013 for example the numeric prediction models for the dimensionless position of wave breaking for plunging breakers and for spilling breakers as well as for wave setup at x 4 and for the reduction in energy flux across the reef between locations x 1 and x 4 have performance ratings characterized by respective correlation coefficients of 0 99 0 82 0 89 and 0 94 between predicted and actual values the somewhat modest correlation 0 82 between prediction and the actual result for the position of breaking of spilling breakers is believed to be associated with inaccuracies in determination of the exact position of breaking and to the difficulty in visually capturing spilling breakers in observations high correlation 0 94 between predicted and actual values of the reduction in energy flux across the reef is achieved in spite of the fact that the model was trained using data from a wave tank that included partial reflection characterized by 7 mean deviation among non breaking waves from the downstream end of the tank the method can be extended to provide predictive models for consideration of a range of natural coastal conditions random waves and various bottom profiles and complex geometry based on training and testing of the models using representative field and laboratory observational data in support of accurate prediction of near shore wave phenomena the results of the current laboratory experiments consistent with yao et al 2009 suggest that for monochromatic waves over an idealized fringing reef the ratio of the offshore wave height and the xdownstream shallow water depth h 1 h s plays a significant role on the wave transformation features as the waves propagate inshore over the reef flat other parameters such as the dimensionless wave frequency f h 1 g also affected the wave transformation processes but to a lesser degree the main observations based on the experiments are 1 the rate of energy dissipation during breaking is estimated for different breaker types the greater the breaker intensity class the larger the rate of dissipation of energy 2 incipient breaking for plunging breakers in general occurs earlier compared to that for spilling breakers i e x b p l u n g i n g x b s p i l l i n g 3 consistent with yao et al 2009 the dimensionless wave setup at the reef flat within the surf zone η 4 h s increases with the ratio of incident wave height to shallow water depth h 1 h s 4 correlation exists between the type of wave breaking and h 1 h s as well as between the dimensionless breaking position x b h s and h 1 h s acknowledgments special thanks to ms kelly cooper and the office of naval research for sponsoring this study under grant n000141010472 and to fuxian gong for her help in conducting the laboratory experiments appendix a output parameters table a1 wave height crest and trough amplitudes at x 1 and wave setup at x i i 1 4 as measured by the wave gages mean values over three iterations values in m table a1 set test no h 1 ac 1 at 1 ῆ 1 ῆ 2 ῆ 3 ῆ 4 1 1 0 019 0 011 0 008 0 001 0 000 0 000 0 002 1 2 0 033 0 018 0 016 0 002 0 000 0 001 0 003 1 3 0 036 0 019 0 017 0 002 0 000 0 002 0 003 1 4 0 049 0 024 0 025 0 001 0 000 0 003 0 003 1 5 0 060 0 032 0 028 0 002 0 002 0 000 0 004 1 6 0 075 0 045 0 031 0 004 0 001 0 000 0 007 1 7 0 077 0 047 0 029 0 005 0 001 0 001 0 006 1 8 0 066 0 044 0 022 0 006 0 003 0 002 0 005 1 9 0 034 0 019 0 014 0 001 0 001 0 001 0 003 1 10 0 056 0 029 0 027 0 001 0 002 0 001 0 007 1 11 0 061 0 031 0 030 0 001 0 002 0 002 0 006 1 12 0 086 0 047 0 039 0 002 0 003 0 002 0 008 1 13 0 037 0 016 0 020 0 001 0 001 0 001 0 003 1 14 0 047 0 024 0 023 0 002 0 002 0 001 0 003 1 15 0 083 0 045 0 038 0 001 0 002 0 000 0 010 8 1 0 021 0 010 0 011 0 000 0 001 0 001 0 000 8 2 0 061 0 034 0 027 0 001 0 001 0 002 0 003 8 3 0 083 0 054 0 029 0 006 0 004 0 003 0 005 8 4 0 037 0 020 0 018 0 000 0 001 0 001 0 001 8 5 0 063 0 032 0 031 0 000 0 001 0 002 0 005 8 6 0 095 0 051 0 044 0 000 0 001 0 002 0 007 8 7 0 041 0 018 0 023 0 000 0 002 0 001 0 001 8 8 0 053 0 030 0 023 0 000 0 002 0 001 0 004 9 1 0 023 0 011 0 013 0 000 0 000 0 001 0 000 9 2 0 059 0 032 0 027 0 002 0 002 0 002 0 000 9 3 0 077 0 050 0 027 0 006 0 006 0 004 0 006 9 4 0 041 0 022 0 019 0 000 0 000 0 002 0 001 9 5 0 066 0 034 0 033 0 001 0 000 0 003 0 001 9 6 0 084 0 045 0 039 0 001 0 001 0 004 0 004 9 7 0 044 0 021 0 023 0 000 0 001 0 001 0 001 9 8 0 057 0 031 0 025 0 000 0 001 0 003 0 003 appendix b classification model worked example b 1 normalization block we test a spilling breaker case where a 1 0 353 a 2 0 029 thus the normalized values are calculated as see section 4 for a q m i n m a x values a 1 n o r m 2 a 1 a 1 m i n a 1 m a x a 1 m i n 1 2 0 353 0 144 0 904 0 144 1 a 1 n o r m 0 451 a 2 n o r m 2 a 2 a 2 m i n a 2 m a x a 2 m i n 1 2 0 029 0 021 0 111 0 021 1 a 2 n o r m 0 825 b 2 neural network block the attribute vector is s 0 a 1 n o r m a 2 n o r m t s 0 0 451 0 825 t the input vector for the hidden layer is x 1 1 s 0 t t x 1 1 0 451 0 825 t the weight matrix for the hidden layer is calculated from the training procedure and provided from weka tool w 1 2 393 16 719 5 920 7 105 17 078 2 941 then the diagonal matrix is calculated d 1 λ 1 e w 1 x 1 λ 1 e 2 393 16 719 5 920 7 105 17 078 2 941 1 0 451 0 825 λ 1 e 5 059 1 820 d 1 λ 158 448 7 174 d 1 158 448 0 0 7 174 v 1 1 1 t s 1 d 1 1 v 1 158 448 0 0 7 174 1 1 1 0 006 0 0 0 139 1 1 s 1 0 006 0 139 x 2 1 s 1 x 2 1 0 006 0 139 t w 2 4 915 11 988 5 860 4 366 11 051 11 989 3 773 5 314 10 643 d 2 λ 1 e w 2 x 2 λ 1 e 4 915 11 988 5 860 4 366 11 051 11 989 3 773 5 314 10 643 1 0 006 0 139 λ 1 e 5 656 2 625 2 323 d 2 λ 286 914 1 072 11 211 d 2 286 914 0 0 0 1 072 0 0 0 11 211 v 2 1 1 1 t s 2 d 2 1 v 2 286 914 0 0 0 1 072 0 0 0 11 211 1 1 1 1 0 004 0 0 0 0 933 0 0 0 0 089 1 1 1 s 2 0 004 0 933 0 089 y s 2 0 004 0 933 0 089 t b 3 classifier block using the class function we obtain the number that corresponds to the predicted class c l a s s round j 1 3 j y j round 1 y 1 2 y 2 3 y 3 c l a s s round 1 0 004 2 0 933 3 0 089 round 2 137 c l a s s 2 c l a s s 2 is interpreted as a spilling breaker which is a correct prediction appendix c wave transformation and wave absorber c 1 wave transformation the measured time series for the surface elevation η i and its wave spectrum at each of the four locations x i i 1 2 3 4 are shown in fig c1 as a first observation the shoaling effect is apparent from the increase in wave height as the wave travels from location x 1 to x 2 also the wave profile becomes skewed when it propagates from deep to shallow water creating a non symmetric profile at the reef edge the location x 3 lies within the transition region see basco and yamashita 1986 that is the region between the break point x b x 2 x b to the point x t x 4 where the mean surface elevation changes from essentially level to an increasing slope wave set up when the wave breaks at location x b it does so as a plunging fig c1 a and b or spilling breaker fig c1 c and d in fig c1 e and f the wave does not break the surface elevation η 4 at location x 4 represents a wave within the inner region that is downstream of the transition region of the surf zone fig c1 time series a c and e and wave spectrum b d and f of surface elevation for three different breaking classes as measured from the four wave gages where η i is the surface elevation in m at wave gage i 1 2 4 and s η i is the corresponding wave spectrum in m 2 h z fig c1 c 2 efficiency of wave absorber the efficiency of the wave attenuator at the downstream end of the wave tank in the laboratory experiments was evaluated based on the nonbreaking test cases using the following steps 1 the first fully developed time series for the wave profile at gage no4 was obtained and expanded over time by repeating it multiple times as a periodical signal 2 the area under the wave spectrum of this periodical signal of the first wave profile was determined 3 steps 1 and 2 were repeated for the next profiles for 40sec after the first profile 4 the deviation between the first and each of the next profiles defined as a r e a u n d e r n t h p r o f i l e a r e a u n d e r 1 s t p r o f i l e 1 were determined 5 the mean deviation from the first profile was obtained by averaging the deviations calculated in step 4 the mean deviation among all the nonbreaking cases for all sets tests iterations was less than 7 while this is not ideal for the scope of our analysis we assume that the effect of the reflection is negligible 
23723,this study deliberates the propagation of acoustic wave at water double porosity sediment interface with an underlying uniform elastic solid substrate a mathematical model is constituted through three layers with distinct elastic properties this layered structure contains an isotropic double porosity solid sandwiched between an overlying water and underlying uniform elastic solid the sandwiched layer is of finite thickness two types of boundary conditions impermeable and permeable at the interface of double porosity solid and elastic solid substrate are considered the closed form analytical expressions for reflection and transmission coefficients are derived theoretically for appropriate boundary conditions these expressions are calculated as a non singular system of linear algebraic equations this non singular system depends on various material parameters therefore a numerical example is used to determine the effects of various properties of sandwiched layer on reflection and transmission coefficients essences of wave frequency incident direction layer thickness pore fluid viscosity wave induced fluid flow and sealing of boundary pores on reflection and transmission coefficients are depicted graphically and discussed elaborately it is revealed that the presence of double porosity layer has a significant effect on reflection and transmission coefficients keywords plane wave sandwiched layer double porosity reflection and transmission 1 introduction it is commonly observed that situ rocks are generally heterogeneous the non uniform rock pores and cracks contain multiple fluids such as oil gas water or co2 the key issue in seismic exploration and reservoir monitoring is how to distinguishing these fluids by their seismic signatures in exploration geophysics and seismology seismic reflection and transmission methods are used to analyze the fluid content in subsurface reservoirs on the basis of wave reflection signals the feedback about ocean floor is carried out in environmental clean up processes contaminants to be removed from ground water or earth are the traces of harmful chemicals dissolved in typical liquids such as gasoline or oil in general earth is a layered structure with different elastic properties the study of reservoir characteristics such as layer thickness pore fluid viscosity radius of spherical inclusions wave induced fluid flow i e lff and sealing of boundary pores through seismic method is helpful in detecting the hydrocarbon and minerals present inside the fissured rock of the ocean floor the phenomenon of wave propagation at ocean floor is of great importance practically as well as theoretically in the various scientific fields such as hydrogeology engineering geology seismology seismology and petroleum geophysics on the basis of biot theory the phenomenon of reflection and refraction transmission at water porous interface is investigated by various authors including stoll and kan 1981 wu et al 1990 santos et al 1992 albert 1993 yang 1999 williams 2001 williams et al 2001 cui and wang 2003 denneman et al 2002 sharma 2004 ohkawa et al 2005 sharma and saini 2012 etc the latest book by carcione 2014 is also referred for relevant references and detailed procedures however to the best of our knowledge the wave propagation through double porosity solid is limited the extension of biot s poroelasticity to double porosity porous solid is carried out by berryman and wang 1995 2000 they derived the phenomenological equations for double porosity dual permeability medium they found that three longitudinal and one shear wave exist in the double porosity medium later pride and berryman 2003a b derived the governing equations for fluid saturated double porosity media by using the volume averaging technique based on the berryman and wang theory the wave propagation at the boundary of double porosity media is investigated by dai and kuang 2006a b 2008 in the recent years the main credit goes to sharma sharma 2013 2014 2015a b 2016 2017 for comprehensive discussion on wave propagation in double porosity solid sharma 2013 studied the essence of wave induced fluid flow i e lff on the wave characteristics i e phase velocity and attenuation and on the reflection of plane wave for two kinds of boundary i e permeable and impermeable of double porosity porous solid based on biot rayleigh theory ba et al 2011 sharma 2014 studied the essences of lff wave frequency pore fluid viscosity and opening of surface pores on rayleigh waves characteristics and on their particle motion in double porosity solid sharma 2015a studied the essence of lff on the wave characterizes in a transversely isotropic double porosity medium sharma 2015b modified the constitutive relations derived by berryman and wang 2000 for double porosity solid the essences of incident direction permeability wave frequency radius of spherical inclusions pore fluid viscosity and sealing of boundary pores on the wave induced flow of pore at the interface of double porosity solid under inviscid liquid layer are analyzed by sharma 2016 sharma 2017 analyzed the essences of wave inhomogeneity pore fluid viscosity and composition of double porosity on inhomogeneous propagation in double porosity dual permeability materials in the aforementioned research the phenomenon of reflection and refraction transmission is carried out at the single interface i e there is no sandwiched layer therefore keeping in view the importance of the transition layer few limited efforts have been made to study the phenomenon of reflection and refraction transmission of plane wave at a layer sandwiched between two dissimilar media some of the recent studies on reflection and transmission of seismic waves through transition layer have been carried out by various authors including sinha 1964 cerveny and vanek 1974 kuo 1992 ainslie 1996 wang et al 2013 lyu et al 2014 corredor et al 2014 chen et al 2015 sahu et al 2015 bai et al 2015 paswan et al 2016 feng et al 2016 bai et al 2016 chen et al 2017 etc lyu et al 2014 studied the reflection and transmission of wave at water porous sediment with a double porosity substrate without taking lff into account they found that the presence of double porosity substrate significantly affect the reflected wave in overlying water keeping the importance of wave induced fluid flow i e lff in mind present study considers the propagation of plane waves at water double porosity sediment interface with an underlying uniform elastic solid substrate a mathematical model is constituted through three layers with distinct elastic properties this layered structure contains an isotropic double porosity solid sandwiched between an overlying water and underlying uniform elastic solid the sandwiched layer is of finite thickness two types of boundary conditions impermeable and permeable at the interface of double porosity solid and elastic solid substrate are considered the closed form analytical expressions for reflection and transmission coefficients are derived theoretically for appropriate boundary conditions these expressions are calculated as a non singular system of linear algebraic equations this non singular system depends on various material parameters therefore a numerical example is used to determine the essences of various properties of sandwiched layer on reflection and transmission coefficients essences of wave frequency incident direction layer thickness radius of spherical inclusions pore fluid viscosity wave induced fluid flow i e lff and sealing of boundary pores on reflection and transmission coefficients are depicted graphically and discussed elaborately it is revealed that the presence of double porosity layer has s significant essence on reflection and transmission coefficients this study is motivated by the problem faced by oil excavation industries where desired products in the form of multiple fluids such as oil gas water or co2 are found within the layered structure 2 governing equations in this study we consider a mathematical model constituted through three layers with distinct elastic properties this layered structure contains an isotropic double porosity solid sandwiched between an overlying water and underlying uniform elastic solid as shown in fig 1 in cartesian coordinate system x y z z axis x axis is placed downward rightward let z 0 be the interface separating water and double porosity solid and z h represent the boundary between double porosity and uniform elastic solid where h represent the width of sandwiched layer 2 1 double porosity solid the double porosity medium is presumed to be a spherical porous solid inclusion within another spherical porous solid host medium hence there are two phases in system i e host and inclusions the pores in both phases are filled by same fluid let ψ 1 ψ 2 1 ψ 1 is the volume fraction of host inclusion medium the total porosity is given by ϕ ψ 1 ϕ 10 ψ 2 ϕ 20 where ϕ 10 ϕ 20 is the local porosity of host inclusion it is commonly accepted that the presence of fluids in the pore space of rocks causes attenuation and dispersion by the mechanism broadly known as wave induced fluid flow lff lff occurs as a passing wave creates the regions of different fluid pressures in saturated porous rock and thus induces a flow of pore fluid the wave induced fluid flow is caused by the fluid pressures difference between two regions of a saturated porous solid this pressure gradient results from the different compressibilities of these regions the lff mechanism provides a link between fluid transport properties and seismic wave signatures the wave induced flow of fluid γ across the pores in a double porosity solid is defined as ba et al 2011 sharma 2013 1 γ e 0 u e 1 v e 2 w e 0 e 1 e 2 λ 2 λ 1 λ 3 λ 4 λ 3 λ 4 ε ω 2 the above expression clearly implies that wiff comes only from the dilatations that means shear transverse wave does not contribute to the flow of pore fluid in porous aggregate the constant used in eq 1 is given by ε 1 3 ψ 2 ϕ 10 r 0 2 ρ f ι η ω χ 1 ϕ 10 where r 0 is the radius of spherical inclusions η denotes the pore fluid viscosity χ m m 1 2 are permeability coefficients ω denotes the angular frequency sharma 2013 has already studied the propagation of plane harmonic waves in double porosity solid he found that four three longitudinal and one shear waves exist in such medium the roots of the cubic equation sharma 2013 represent the propagation of three longitudinal waves p 1 p 2 p 3 with complex velocities v 1 v 2 v 3 the polarizations or displacements of fluid particles in the host medium and inclusion are given by sharma 2016 2 v γ v γ v b 0 v 4 b 1 v 2 b 2 a 0 v 4 a 1 v 2 a 2 w λ v λ v c 0 v 4 c 1 v 2 c 2 a 0 v 4 a 1 v 2 a 2 the complex velocity v 4 of lone transverse wave is given by v 4 2 n ρ 0 b 0 a 0 ρ f c 0 a 0 ρ f the polarizations or displacements of fluid particles for this wave is given by 3 v j b 0 a 0 u j w j c 0 a 0 u j j 1 2 3 the various coefficients occurring in the above expressions are given by sharma 2013 3 boundary conditions 3 1 at water double porosity solid interface z 0 the relevant boundary conditions chen et al 2015 at the interface z 0 between the water and double porosity solid are given by 4 i τ z z p i i u z u z i i i u z v z 0 i v u z w z 0 v τ z x 0 3 2 at double porosity solid elastic solid interface x h two types of boundary conditions are used a impermeable boundary and b permeable boundary the appropriate boundary conditions sharma 2013 wang et al 2013 goyal and tomer 2015 are given by 5 i u z u z e i i u x u x e i i i ζ t 0 v z 1 ζ p 1 f 0 i v ζ t 0 w z 1 ζ p 2 f 0 v τ z z σ z z v i τ z x σ z x where t 0 is scaling factor ζ 0 ζ 1 represents the permeable impermeable boundary 4 formulation of the problem a plane harmonic wave propagates with velocity v 0 and angular frequency ω through upper half space i e overlying water is incident at the boundary z 0 with an angle of incidence θ 0 consequently one wave i e p is reflected back in the upper half space four transmitted from upper interface and four reflected from lower interface waves i e p 1 p 2 p 3 s v are observed in the sandwiched double porosity solid layer i e 0 z h and two transmitted waves i e p s v are generated in the bottom substrate i e underlying elastic solid half space h z as shown in fig 1 4 1 displacements 1 in overlying water z 0 in this work wave motion is considered in x z plane therefore the displacement of liquid particles in x z plane is defined as 6 u x sin θ 0 e i w s x q 0 z t r 0 sin θ 0 e i w s x q 0 z t u z cos θ 0 e i w s x q 0 z t r 0 cos θ 0 e i w s x q 0 z t where r 0 represents the reflection coefficient for incident acoustic wave according to snell s law the horizontal slowness s sin θ 0 v 0 will be remains same for all the reflected and transmitted waves then q 0 cos θ 0 v 0 is the vertical slowness of the incident wave 2 in the double porosity layer 0 z h the displacement of material particles in this medium sharma 2016 are defined as 7 u m k 1 4 a m k t k e i w s x q k z t k 1 4 a m k r k e i w s x q k z t v m k 1 4 γ k a m k t k e i w s x q k z t k 1 4 γ k a m k r k e i w s x q k z t w m k 1 4 λ k a m k t k e i w s x q k z t k 1 4 λ k a m k r k e i w s x q k z t m x z where coefficients t k r k represent the excitation factors of transmitted reflected waves relative to the incident wave the q k v k 2 s 2 define the vertical slowness for these transmitted and reflected waves in the x z plane the polarization vectors a x k 0 a z k of these transmitted and reflected waves are defined as a x l 0 a z l s 0 q l v l l 1 2 3 for three longitudinal waves and a x 4 0 a z 4 q 4 0 s v 4 for transverse wave the magnitude of an excitation factor t k r k define the amplitude ratio of the corresponding transmitted reflected waves relative to the incident wave 3 in underlying elastic solid h z following schoenberg 1971 the displacement of particles in this medium are defined as 8 u x e sin α t p e i w sin α v p x cos α v p z t cos β t s e i w sin β v s x cos β v s z t u z e cos α t p e i w sin α v p x cos α v p z t sin β t s e i w sin β v s x cos β v s z t where t p t s define the excitation factor of transmitted p s v wave the parameters v p λ 2 μ ρ and v s μ ρ define the velocity of p and s v waves in this medium respectively 4 2 stresses 1 double porosity solid following ba et al 2011 and sharma 2013 2014 2016 the constitutive relations for double porosity solid are given by 9 τ i j λ 0 u λ 1 v λ 2 w λ 1 λ 2 γ δ i j n u u t p 1 f λ 1 u λ 3 v γ p 2 f λ 2 u λ 4 w γ where vectors u and v w denote the displacement of solid and average displacements of pore fluid particles proportional to solid frame in the host medium and inclusions respectively superscript t represents the transpose τ i j denote the stresses in porous aggregate and p 1 f p 2 f be the hydrostatic pressures in two pore fluid regimes n stands for the rigidity of the aggregate porous solid the tensor δ i j is kronecker symbol the elastic constants λ m m 0 1 2 3 4 are akin to versatile measurable quantities of porous aggregate sharma 2013 2 inviscid liquid the fluid pressure in the inviscid liquid are given by 10 p ρ o v 0 2 u where u is the displacement vector ρ 0 is the density of liquid and v 0 is the velocity of liquid particles 3 linear elastic solid constitutive relations of an isotropic elastic solid is given by 11 σ i j λ u e i μ u i j e u j i e where λ and μ are the lame s constants u e is the displacement vector 5 reflection and transmission coefficients combining the displacements 6 8 and boundary conditions 4 5 we get a system of eleven non homogeneous simultaneous linear equations in terms of eleven unknowns r 0 t 1 t 2 t 3 t 4 r 1 r 2 r 3 r 4 t p t s are as follows 12 m r 0 t 1 t 2 t 3 t 4 r 1 r 2 r 3 r 4 t p t s t n where m is a 11 11 matrix and n is a 11 1 matrix the elements of the matrices m and n are given in the appendix 6 numerical example in order to illustrate the effect of different parameters like incident direction frequency layer thickness and local fluid flow on reflection and transmission coefficients a numerical example is needed it explain the theoretical study in graphically with the help of matlab based on sharma 2013 the relevant value of material parameters of double porosity solid are given in table 1 the overlying water is specified with velocity v 0 1430 m s and density ρ 1000 kg m 3 further the elastic parameters of underlying elastic solid are λ 20 6 gpa μ 14 2 gpa and density is ρ 2460 kg m 3 7 discussion of numerical results fig 2 shows the reflection coefficient of p wave in the overlying water at different thickness of sandwiched layer for θ 0 0 90 0 if h 0 h i e eliminating the double porosity solid uniform elastic solid eq 12 represents the wave reflection and transmission at the interface of water elastic solid water double porosity solid significant effect of lff is clearly visible on reflection coefficient irrespective of all the layer thickness except h 0 moreover reflection coefficient curve corresponding to h 0 is consistent with wang et al 2013 in mathematical framework it validates that the numerical calculations are analytically correct the effect of lff is quite larger for θ 0 18 0 38 0 the maximum value of reflection coefficient is increases with the increase of layer thickness it is also observed that the critical angles are exists for each value of h in the absence or presence of lff fig 3 displays the reflection coefficient of p wave varying with frequency ω for different layer thickness h a θ 0 0 0 and b θ 0 25 0 it is observed that the effect of lff is larger at the incidence θ 0 0 0 for ω 0 hz 100 hz irrespective of each value of h the reflection coefficient decreases in the presence of lff for each value of h this implies that a weaker reflection due to the presence of lff in both cases of lff presence or absence variational pattern is alike for each value of h while at θ 0 25 0 the significant effect of lff is observed beyond ω 25 hz irrespective of h 10 m 20 m the trend of reflection coefficient is almost linear for h 1 m at the normal incidence i e θ 0 0 0 as well as θ 0 25 0 moreover at both incidence i e θ 0 0 0 and θ 0 25 0 the reflection coefficient fluctuates absence and presence of lff with increase of frequency as well as layer thickness fig 4 shows the reflection coefficient of p wave in overlying water with layer thickness h at different frequency ω a θ 0 0 0 and b θ 0 25 0 in this case almost same trend of reflection coefficient is observed as demonstrated in fig 3 it is observed that the effect of lff is larger at the incidence θ 0 0 0 for h 0 m 20 m irrespective of each value of frequency ω the reflection coefficient decreases in the presence of lff for each value of ω this implies that reflected p wave is more dispersive in the absence of lff in both cases of lff presence or absence variational pattern is alike for each value of ω while at θ 0 25 0 the significant effect of lff is observed when h 4 2 m irrespective of ω 2 π 0 05 khz 2 π 0 1 khz fig 5 a b c and d show the reflection coefficient in the overlying water as a function of pore fluid viscosity with incident direction θ 0 0 0 90 0 for ω 2 π 0 01 khz 2 π 0 1 khz 2 π 0 05 khz and 2 π 1 khz respectively fig 5 a shows that reflection coefficient curve for η 0 0001 p s s presence of lff and η 0 002 p s s presence of lff coincide with each other hence in the presence of lff the effect of pore fluid viscosity on reflection coefficient is not observed at low frequency while little bit effect is observed in the absence of lff further from fig 5 b c and d it is observed that the effect of pore fluid viscosity presence and absence of lff on reflection coefficient is increasing with the increase of frequency the wave becomes attenuated due to the presence of viscosity in pore fluid hence p wave is strongly dispersive i e frequency dependent and attenuated in nature fig 6 shows the reflection coefficient of p wave with frequency ω for spherical inclusions of two different size a θ 0 0 0 and b θ 0 25 0 it is noted that at θ 0 0 0 the reflected p wave strengthens with increase of frequency when inclusions are of very small size the inclusion size have significant effect on the reflection coefficient while at θ 0 25 0 effect of inclusion size is little bit significant fig 7 exhibits the amplitude ratios of reflected p and transmitted p 1 s v waves with incident direction θ 0 at permeable and impermeable underlying solid substrate the significant effect of flow condition at the interface of double porosity elastic solid is observed on reflected p and transmitted p 1 s v waves the trend of reflected p and transmitted p 1 s v waves at permeable boundary are almost bear analogous trend to those of the corresponding reflected and transmitted waves at impermeable boundary moreover reflected p and transmitted p 1 s v waves fluctuates irregularly when θ 0 40 0 8 conclusions in this study the reflection and transmission of plane wave at water double porosity sediment with an underlying uniform elastic solid substrate is investigated finally for particular numerical example effects of incident direction wave frequency layer thickness pore fluid viscosity radius of spherical inclusions wave induced fluid flow i e lff and sealing of boundary pores on reflection and transmission coefficients are depicted graphically some interesting consequences of present study are explained as follows 1 significant effect of lff is clearly visible on reflection coefficient irrespective of all value of layer thickness except h 0 therefore reflected p wave is sensitive to wave induced fluid flow of fluid in double porosity solid 2 at normal incidence i e θ 0 0 0 the reflected p wave is weakens in the presence of lff corresponding to each value of h 3 significant effect of flow condition at the interface of double porosity elastic solid is observed on reflected p and transmitted p 1 s v waves 4 at normal incidence the reflected p wave strengthens with increase of frequency when inclusions are of very small size while at θ 0 25 0 effect of inclusion size is little bit significant 5 in the presence of lff effect of pore fluid viscosity on reflection coefficient is not observed at low frequency the reflected p wave is strongly dispersive i e frequency dependent and attenuated in nature the study of reservoir characteristics such as layer thickness pore fluid viscosity radius of spherical inclusions wave induced fluid flow i e lff and sealing of boundary pores through seismic reflection and transmission methods is helpful in detecting the hydrocarbon and minerals present inside the fissured rock of the ocean floor on the basis of wave reflection signals the feedback about ocean floor is carried out hence the various issues resolved in this study are involved in many of the practical problems of hydrology geophysics petroleum engineering and seismology appendix the elements of matrix m are defined as m 1 1 ρ 0 v 0 m 1 2 f 1 v 1 2 n q 1 a z 1 m 1 3 f 2 v 2 2 n q 2 a z 2 m 1 4 f 3 v 3 2 n q 3 a z 3 m 1 5 f 4 v 4 2 n q 4 a z 4 m 1 6 s a x 1 q 1 a z 1 f 1 2 n q 1 a z 1 m 1 7 s a x 2 q 2 a z 2 f 2 2 n q 2 a z 2 m 1 8 s a x 3 q 3 a z 3 f 3 2 n q 3 a z 3 m 1 9 s a x 4 q 4 a z 4 f 4 2 n q 4 a z 4 m 1 10 0 m 1 11 0 m 2 1 c o s θ 0 m 2 2 a z 1 m 2 3 a z 2 m 2 4 a z 3 m 2 5 a z 4 m 2 6 a z 1 m 2 7 a z 2 m 2 8 a z 3 m 2 9 a z 4 m 2 10 0 m 2 11 0 m 3 1 0 m 3 2 1 γ 1 a z 1 m 3 3 1 γ 2 a z 2 m 3 4 1 γ 3 a z 3 m 3 5 1 γ 4 a z 4 m 3 6 1 γ 1 a z 1 m 3 7 1 γ 2 a z 2 m 3 8 1 γ 3 a z 3 m 3 9 1 γ 4 a z 4 m 3 10 0 m 3 11 0 m 4 1 0 m 4 2 1 λ 1 a z 1 m 4 3 1 λ 2 a z 2 m 4 4 1 λ 3 a z 3 m 4 5 1 λ 4 a z 4 m 4 6 1 λ 1 a z 1 m 4 7 1 λ 2 a z 2 m 4 8 1 λ 3 a z 3 m 4 9 1 λ 4 a z 4 m 4 10 0 m 4 11 0 m 5 1 0 m 5 2 n s a z 1 q 1 a x 1 m 5 3 n s a z 2 q 2 a x 2 m 5 4 n s a z 3 q 3 a x 3 m 5 5 n s a z 4 q 4 a x 4 m 5 6 n s a z 1 q 1 a x 1 m 5 7 n s a z 2 q 2 a x 2 m 5 8 n s a z 3 q 3 a x 3 m 5 9 n s a z 4 q 4 a x 4 m 5 10 0 m 5 11 0 m 6 1 0 m 6 2 a z 1 e ι ω q 1 h m 6 3 a z 2 e ι ω q 2 h m 6 4 a z 3 e ι ω q 3 h m 6 5 a z 4 e ι ω q 4 h m 6 6 a z 1 e ι ω q 1 h m 6 7 a z 2 e ι ω q 2 h m 6 8 a z 3 e ι ω q 3 h m 6 9 a z 4 e ι ω q 4 h m 6 10 cos α e ι ω cos α v p h m 6 11 sin β e ι ω cos β v s h m 7 1 0 m 7 2 a x 1 e ι ω q 1 h m 7 3 a x 2 e ι ω q 2 h m 7 4 a x 3 e ι ω q 3 h m 7 5 a x 4 e ι ω q 4 h m 7 6 a x 1 e ι ω q 1 h m 7 7 a x 2 e ι ω q 2 h m 7 8 a x 3 e ι ω q 3 h m 7 9 a x 4 e ι ω q 4 h m 7 10 sin α e ι ω cos α v p h m 7 11 cos β e ι ω cos β v s h m 8 1 0 m 8 2 ζ t 0 γ 1 a z 1 1 ζ g 1 v 1 e ι ω q 1 h m 8 3 ζ t 0 γ 2 a z 2 1 ζ g 2 v 2 e ι ω q 2 h m 8 4 ζ t 0 γ 3 a z 3 1 ζ g 3 v 3 e ι ω q 3 h m 8 5 ζ t 0 γ 4 a z 4 1 ζ g 4 v 4 e ι ω q 4 h m 8 6 ζ t 0 γ 1 a z 1 1 ζ g 1 s a x 1 q 1 a z 1 e ι ω q 1 h m 8 7 ζ t 0 γ 2 a z 2 1 ζ g 2 s a x 2 q 2 a z 2 e ι ω q 2 h m 8 8 ζ t 0 γ 3 a z 3 1 ζ g 3 s a x 3 q 3 a z 3 e ι ω q 3 h m 8 9 ζ t 0 γ 4 a z 4 1 ζ g 4 s a x 4 q 4 a z 4 e ι ω q 4 h m 8 10 0 m 8 11 0 m 9 1 0 m 9 2 ζ t 0 λ 1 a z 1 1 ζ h 1 v 1 e ι ω q 1 h m 9 3 ζ t 0 λ 2 a z 2 1 ζ h 2 v 2 e ι ω q 2 h m 9 4 ζ t 0 λ 3 a z 3 1 ζ h 3 v 3 e ι ω q 3 h m 9 5 ζ t 0 λ 4 a z 4 1 ζ h 4 v 4 e ι ω q 4 h m 9 6 ζ t 0 λ 1 a z 1 1 ζ h 1 s a x 1 q 1 a z 1 e ι ω q 1 h m 9 7 ζ t 0 λ 2 a z 2 1 ζ h 2 s a x 2 q 2 a z 2 e ι ω q 2 h m 9 8 ζ t 0 λ 3 a z 3 1 ζ h 3 s a x 3 q 3 a z 3 e ι ω q 3 h m 9 9 ζ t 0 λ 4 a z 4 1 ζ h 4 s a x 4 q 4 a z 4 e ι ω q 4 h m 9 10 0 m 9 11 0 m 10 1 0 m 10 2 f 1 v 1 2 n q 1 a z 1 e ι ω q 1 h m 10 3 f 2 v 2 2 n q 2 a z 2 e ι ω q 2 h m 10 4 f 3 v 3 2 n q 3 a z 3 e ι ω q 3 h m 10 5 f 4 v 4 2 n q 4 a z 4 e ι ω q 4 h m 10 6 f 1 s a x 1 q 1 a z 1 2 n q 1 a z 1 e ι ω q 1 h m 10 7 f 2 s a x 2 q 2 a z 2 2 n q 2 a z 2 e ι ω q 2 h m 10 8 f 3 s a x 3 q 1 a z 3 2 n q 3 a z 3 e ι ω q 3 h m 10 9 f 4 s a x 4 q 4 a z 4 2 n q 4 a z 4 e ι ω q 4 h m 10 10 λ 2 μ cos 2 α 1 v p e ι ω cos α v p h m 10 11 μ sin 2 β 1 v s e ι ω cos β v s h m 11 1 0 m 11 2 n s a z 1 q 1 a x 1 e ι ω q 1 h m 11 3 n s a z 2 q 2 a x 2 e ι ω q 2 h m 11 4 n s a z 3 q 3 a x 3 e ι ω q 3 h m 11 5 n s a z 4 q 4 a x 4 e ι ω q 4 h m 11 6 n s a z 1 q 1 a x 1 e ι ω q 1 h m 11 7 n s a z 2 q 2 a x 2 e ι ω q 2 h m 11 8 n s a z 3 q 3 a x 3 e ι ω q 3 h m 11 9 n s a z 4 q 4 a x 4 e ι ω q 4 h m 11 10 μ sin 2 α 1 v p e ι ω cos α v p h m 11 11 μ sin 2 β cos 2 β 1 v s e ι ω cos β v s h where f k λ 0 λ 1 λ 2 e 0 λ 1 λ 1 λ 2 e 1 γ k λ 2 λ 1 λ 2 e 2 λ k g k λ 1 λ 3 e 0 λ 3 λ 3 e 1 γ k λ 3 e 2 λ k h k λ 2 λ 4 e 0 λ 4 e 1 γ k λ 4 λ 4 e 2 λ k k 1 2 3 the elements of matrix n are defined as n 1 ρ 0 v 0 n 2 c o s θ 0 n 3 0 n 4 0 n 5 0 n 6 0 n 7 0 n 8 0 n 9 0 n 10 0 n 11 0 
23723,this study deliberates the propagation of acoustic wave at water double porosity sediment interface with an underlying uniform elastic solid substrate a mathematical model is constituted through three layers with distinct elastic properties this layered structure contains an isotropic double porosity solid sandwiched between an overlying water and underlying uniform elastic solid the sandwiched layer is of finite thickness two types of boundary conditions impermeable and permeable at the interface of double porosity solid and elastic solid substrate are considered the closed form analytical expressions for reflection and transmission coefficients are derived theoretically for appropriate boundary conditions these expressions are calculated as a non singular system of linear algebraic equations this non singular system depends on various material parameters therefore a numerical example is used to determine the effects of various properties of sandwiched layer on reflection and transmission coefficients essences of wave frequency incident direction layer thickness pore fluid viscosity wave induced fluid flow and sealing of boundary pores on reflection and transmission coefficients are depicted graphically and discussed elaborately it is revealed that the presence of double porosity layer has a significant effect on reflection and transmission coefficients keywords plane wave sandwiched layer double porosity reflection and transmission 1 introduction it is commonly observed that situ rocks are generally heterogeneous the non uniform rock pores and cracks contain multiple fluids such as oil gas water or co2 the key issue in seismic exploration and reservoir monitoring is how to distinguishing these fluids by their seismic signatures in exploration geophysics and seismology seismic reflection and transmission methods are used to analyze the fluid content in subsurface reservoirs on the basis of wave reflection signals the feedback about ocean floor is carried out in environmental clean up processes contaminants to be removed from ground water or earth are the traces of harmful chemicals dissolved in typical liquids such as gasoline or oil in general earth is a layered structure with different elastic properties the study of reservoir characteristics such as layer thickness pore fluid viscosity radius of spherical inclusions wave induced fluid flow i e lff and sealing of boundary pores through seismic method is helpful in detecting the hydrocarbon and minerals present inside the fissured rock of the ocean floor the phenomenon of wave propagation at ocean floor is of great importance practically as well as theoretically in the various scientific fields such as hydrogeology engineering geology seismology seismology and petroleum geophysics on the basis of biot theory the phenomenon of reflection and refraction transmission at water porous interface is investigated by various authors including stoll and kan 1981 wu et al 1990 santos et al 1992 albert 1993 yang 1999 williams 2001 williams et al 2001 cui and wang 2003 denneman et al 2002 sharma 2004 ohkawa et al 2005 sharma and saini 2012 etc the latest book by carcione 2014 is also referred for relevant references and detailed procedures however to the best of our knowledge the wave propagation through double porosity solid is limited the extension of biot s poroelasticity to double porosity porous solid is carried out by berryman and wang 1995 2000 they derived the phenomenological equations for double porosity dual permeability medium they found that three longitudinal and one shear wave exist in the double porosity medium later pride and berryman 2003a b derived the governing equations for fluid saturated double porosity media by using the volume averaging technique based on the berryman and wang theory the wave propagation at the boundary of double porosity media is investigated by dai and kuang 2006a b 2008 in the recent years the main credit goes to sharma sharma 2013 2014 2015a b 2016 2017 for comprehensive discussion on wave propagation in double porosity solid sharma 2013 studied the essence of wave induced fluid flow i e lff on the wave characteristics i e phase velocity and attenuation and on the reflection of plane wave for two kinds of boundary i e permeable and impermeable of double porosity porous solid based on biot rayleigh theory ba et al 2011 sharma 2014 studied the essences of lff wave frequency pore fluid viscosity and opening of surface pores on rayleigh waves characteristics and on their particle motion in double porosity solid sharma 2015a studied the essence of lff on the wave characterizes in a transversely isotropic double porosity medium sharma 2015b modified the constitutive relations derived by berryman and wang 2000 for double porosity solid the essences of incident direction permeability wave frequency radius of spherical inclusions pore fluid viscosity and sealing of boundary pores on the wave induced flow of pore at the interface of double porosity solid under inviscid liquid layer are analyzed by sharma 2016 sharma 2017 analyzed the essences of wave inhomogeneity pore fluid viscosity and composition of double porosity on inhomogeneous propagation in double porosity dual permeability materials in the aforementioned research the phenomenon of reflection and refraction transmission is carried out at the single interface i e there is no sandwiched layer therefore keeping in view the importance of the transition layer few limited efforts have been made to study the phenomenon of reflection and refraction transmission of plane wave at a layer sandwiched between two dissimilar media some of the recent studies on reflection and transmission of seismic waves through transition layer have been carried out by various authors including sinha 1964 cerveny and vanek 1974 kuo 1992 ainslie 1996 wang et al 2013 lyu et al 2014 corredor et al 2014 chen et al 2015 sahu et al 2015 bai et al 2015 paswan et al 2016 feng et al 2016 bai et al 2016 chen et al 2017 etc lyu et al 2014 studied the reflection and transmission of wave at water porous sediment with a double porosity substrate without taking lff into account they found that the presence of double porosity substrate significantly affect the reflected wave in overlying water keeping the importance of wave induced fluid flow i e lff in mind present study considers the propagation of plane waves at water double porosity sediment interface with an underlying uniform elastic solid substrate a mathematical model is constituted through three layers with distinct elastic properties this layered structure contains an isotropic double porosity solid sandwiched between an overlying water and underlying uniform elastic solid the sandwiched layer is of finite thickness two types of boundary conditions impermeable and permeable at the interface of double porosity solid and elastic solid substrate are considered the closed form analytical expressions for reflection and transmission coefficients are derived theoretically for appropriate boundary conditions these expressions are calculated as a non singular system of linear algebraic equations this non singular system depends on various material parameters therefore a numerical example is used to determine the essences of various properties of sandwiched layer on reflection and transmission coefficients essences of wave frequency incident direction layer thickness radius of spherical inclusions pore fluid viscosity wave induced fluid flow i e lff and sealing of boundary pores on reflection and transmission coefficients are depicted graphically and discussed elaborately it is revealed that the presence of double porosity layer has s significant essence on reflection and transmission coefficients this study is motivated by the problem faced by oil excavation industries where desired products in the form of multiple fluids such as oil gas water or co2 are found within the layered structure 2 governing equations in this study we consider a mathematical model constituted through three layers with distinct elastic properties this layered structure contains an isotropic double porosity solid sandwiched between an overlying water and underlying uniform elastic solid as shown in fig 1 in cartesian coordinate system x y z z axis x axis is placed downward rightward let z 0 be the interface separating water and double porosity solid and z h represent the boundary between double porosity and uniform elastic solid where h represent the width of sandwiched layer 2 1 double porosity solid the double porosity medium is presumed to be a spherical porous solid inclusion within another spherical porous solid host medium hence there are two phases in system i e host and inclusions the pores in both phases are filled by same fluid let ψ 1 ψ 2 1 ψ 1 is the volume fraction of host inclusion medium the total porosity is given by ϕ ψ 1 ϕ 10 ψ 2 ϕ 20 where ϕ 10 ϕ 20 is the local porosity of host inclusion it is commonly accepted that the presence of fluids in the pore space of rocks causes attenuation and dispersion by the mechanism broadly known as wave induced fluid flow lff lff occurs as a passing wave creates the regions of different fluid pressures in saturated porous rock and thus induces a flow of pore fluid the wave induced fluid flow is caused by the fluid pressures difference between two regions of a saturated porous solid this pressure gradient results from the different compressibilities of these regions the lff mechanism provides a link between fluid transport properties and seismic wave signatures the wave induced flow of fluid γ across the pores in a double porosity solid is defined as ba et al 2011 sharma 2013 1 γ e 0 u e 1 v e 2 w e 0 e 1 e 2 λ 2 λ 1 λ 3 λ 4 λ 3 λ 4 ε ω 2 the above expression clearly implies that wiff comes only from the dilatations that means shear transverse wave does not contribute to the flow of pore fluid in porous aggregate the constant used in eq 1 is given by ε 1 3 ψ 2 ϕ 10 r 0 2 ρ f ι η ω χ 1 ϕ 10 where r 0 is the radius of spherical inclusions η denotes the pore fluid viscosity χ m m 1 2 are permeability coefficients ω denotes the angular frequency sharma 2013 has already studied the propagation of plane harmonic waves in double porosity solid he found that four three longitudinal and one shear waves exist in such medium the roots of the cubic equation sharma 2013 represent the propagation of three longitudinal waves p 1 p 2 p 3 with complex velocities v 1 v 2 v 3 the polarizations or displacements of fluid particles in the host medium and inclusion are given by sharma 2016 2 v γ v γ v b 0 v 4 b 1 v 2 b 2 a 0 v 4 a 1 v 2 a 2 w λ v λ v c 0 v 4 c 1 v 2 c 2 a 0 v 4 a 1 v 2 a 2 the complex velocity v 4 of lone transverse wave is given by v 4 2 n ρ 0 b 0 a 0 ρ f c 0 a 0 ρ f the polarizations or displacements of fluid particles for this wave is given by 3 v j b 0 a 0 u j w j c 0 a 0 u j j 1 2 3 the various coefficients occurring in the above expressions are given by sharma 2013 3 boundary conditions 3 1 at water double porosity solid interface z 0 the relevant boundary conditions chen et al 2015 at the interface z 0 between the water and double porosity solid are given by 4 i τ z z p i i u z u z i i i u z v z 0 i v u z w z 0 v τ z x 0 3 2 at double porosity solid elastic solid interface x h two types of boundary conditions are used a impermeable boundary and b permeable boundary the appropriate boundary conditions sharma 2013 wang et al 2013 goyal and tomer 2015 are given by 5 i u z u z e i i u x u x e i i i ζ t 0 v z 1 ζ p 1 f 0 i v ζ t 0 w z 1 ζ p 2 f 0 v τ z z σ z z v i τ z x σ z x where t 0 is scaling factor ζ 0 ζ 1 represents the permeable impermeable boundary 4 formulation of the problem a plane harmonic wave propagates with velocity v 0 and angular frequency ω through upper half space i e overlying water is incident at the boundary z 0 with an angle of incidence θ 0 consequently one wave i e p is reflected back in the upper half space four transmitted from upper interface and four reflected from lower interface waves i e p 1 p 2 p 3 s v are observed in the sandwiched double porosity solid layer i e 0 z h and two transmitted waves i e p s v are generated in the bottom substrate i e underlying elastic solid half space h z as shown in fig 1 4 1 displacements 1 in overlying water z 0 in this work wave motion is considered in x z plane therefore the displacement of liquid particles in x z plane is defined as 6 u x sin θ 0 e i w s x q 0 z t r 0 sin θ 0 e i w s x q 0 z t u z cos θ 0 e i w s x q 0 z t r 0 cos θ 0 e i w s x q 0 z t where r 0 represents the reflection coefficient for incident acoustic wave according to snell s law the horizontal slowness s sin θ 0 v 0 will be remains same for all the reflected and transmitted waves then q 0 cos θ 0 v 0 is the vertical slowness of the incident wave 2 in the double porosity layer 0 z h the displacement of material particles in this medium sharma 2016 are defined as 7 u m k 1 4 a m k t k e i w s x q k z t k 1 4 a m k r k e i w s x q k z t v m k 1 4 γ k a m k t k e i w s x q k z t k 1 4 γ k a m k r k e i w s x q k z t w m k 1 4 λ k a m k t k e i w s x q k z t k 1 4 λ k a m k r k e i w s x q k z t m x z where coefficients t k r k represent the excitation factors of transmitted reflected waves relative to the incident wave the q k v k 2 s 2 define the vertical slowness for these transmitted and reflected waves in the x z plane the polarization vectors a x k 0 a z k of these transmitted and reflected waves are defined as a x l 0 a z l s 0 q l v l l 1 2 3 for three longitudinal waves and a x 4 0 a z 4 q 4 0 s v 4 for transverse wave the magnitude of an excitation factor t k r k define the amplitude ratio of the corresponding transmitted reflected waves relative to the incident wave 3 in underlying elastic solid h z following schoenberg 1971 the displacement of particles in this medium are defined as 8 u x e sin α t p e i w sin α v p x cos α v p z t cos β t s e i w sin β v s x cos β v s z t u z e cos α t p e i w sin α v p x cos α v p z t sin β t s e i w sin β v s x cos β v s z t where t p t s define the excitation factor of transmitted p s v wave the parameters v p λ 2 μ ρ and v s μ ρ define the velocity of p and s v waves in this medium respectively 4 2 stresses 1 double porosity solid following ba et al 2011 and sharma 2013 2014 2016 the constitutive relations for double porosity solid are given by 9 τ i j λ 0 u λ 1 v λ 2 w λ 1 λ 2 γ δ i j n u u t p 1 f λ 1 u λ 3 v γ p 2 f λ 2 u λ 4 w γ where vectors u and v w denote the displacement of solid and average displacements of pore fluid particles proportional to solid frame in the host medium and inclusions respectively superscript t represents the transpose τ i j denote the stresses in porous aggregate and p 1 f p 2 f be the hydrostatic pressures in two pore fluid regimes n stands for the rigidity of the aggregate porous solid the tensor δ i j is kronecker symbol the elastic constants λ m m 0 1 2 3 4 are akin to versatile measurable quantities of porous aggregate sharma 2013 2 inviscid liquid the fluid pressure in the inviscid liquid are given by 10 p ρ o v 0 2 u where u is the displacement vector ρ 0 is the density of liquid and v 0 is the velocity of liquid particles 3 linear elastic solid constitutive relations of an isotropic elastic solid is given by 11 σ i j λ u e i μ u i j e u j i e where λ and μ are the lame s constants u e is the displacement vector 5 reflection and transmission coefficients combining the displacements 6 8 and boundary conditions 4 5 we get a system of eleven non homogeneous simultaneous linear equations in terms of eleven unknowns r 0 t 1 t 2 t 3 t 4 r 1 r 2 r 3 r 4 t p t s are as follows 12 m r 0 t 1 t 2 t 3 t 4 r 1 r 2 r 3 r 4 t p t s t n where m is a 11 11 matrix and n is a 11 1 matrix the elements of the matrices m and n are given in the appendix 6 numerical example in order to illustrate the effect of different parameters like incident direction frequency layer thickness and local fluid flow on reflection and transmission coefficients a numerical example is needed it explain the theoretical study in graphically with the help of matlab based on sharma 2013 the relevant value of material parameters of double porosity solid are given in table 1 the overlying water is specified with velocity v 0 1430 m s and density ρ 1000 kg m 3 further the elastic parameters of underlying elastic solid are λ 20 6 gpa μ 14 2 gpa and density is ρ 2460 kg m 3 7 discussion of numerical results fig 2 shows the reflection coefficient of p wave in the overlying water at different thickness of sandwiched layer for θ 0 0 90 0 if h 0 h i e eliminating the double porosity solid uniform elastic solid eq 12 represents the wave reflection and transmission at the interface of water elastic solid water double porosity solid significant effect of lff is clearly visible on reflection coefficient irrespective of all the layer thickness except h 0 moreover reflection coefficient curve corresponding to h 0 is consistent with wang et al 2013 in mathematical framework it validates that the numerical calculations are analytically correct the effect of lff is quite larger for θ 0 18 0 38 0 the maximum value of reflection coefficient is increases with the increase of layer thickness it is also observed that the critical angles are exists for each value of h in the absence or presence of lff fig 3 displays the reflection coefficient of p wave varying with frequency ω for different layer thickness h a θ 0 0 0 and b θ 0 25 0 it is observed that the effect of lff is larger at the incidence θ 0 0 0 for ω 0 hz 100 hz irrespective of each value of h the reflection coefficient decreases in the presence of lff for each value of h this implies that a weaker reflection due to the presence of lff in both cases of lff presence or absence variational pattern is alike for each value of h while at θ 0 25 0 the significant effect of lff is observed beyond ω 25 hz irrespective of h 10 m 20 m the trend of reflection coefficient is almost linear for h 1 m at the normal incidence i e θ 0 0 0 as well as θ 0 25 0 moreover at both incidence i e θ 0 0 0 and θ 0 25 0 the reflection coefficient fluctuates absence and presence of lff with increase of frequency as well as layer thickness fig 4 shows the reflection coefficient of p wave in overlying water with layer thickness h at different frequency ω a θ 0 0 0 and b θ 0 25 0 in this case almost same trend of reflection coefficient is observed as demonstrated in fig 3 it is observed that the effect of lff is larger at the incidence θ 0 0 0 for h 0 m 20 m irrespective of each value of frequency ω the reflection coefficient decreases in the presence of lff for each value of ω this implies that reflected p wave is more dispersive in the absence of lff in both cases of lff presence or absence variational pattern is alike for each value of ω while at θ 0 25 0 the significant effect of lff is observed when h 4 2 m irrespective of ω 2 π 0 05 khz 2 π 0 1 khz fig 5 a b c and d show the reflection coefficient in the overlying water as a function of pore fluid viscosity with incident direction θ 0 0 0 90 0 for ω 2 π 0 01 khz 2 π 0 1 khz 2 π 0 05 khz and 2 π 1 khz respectively fig 5 a shows that reflection coefficient curve for η 0 0001 p s s presence of lff and η 0 002 p s s presence of lff coincide with each other hence in the presence of lff the effect of pore fluid viscosity on reflection coefficient is not observed at low frequency while little bit effect is observed in the absence of lff further from fig 5 b c and d it is observed that the effect of pore fluid viscosity presence and absence of lff on reflection coefficient is increasing with the increase of frequency the wave becomes attenuated due to the presence of viscosity in pore fluid hence p wave is strongly dispersive i e frequency dependent and attenuated in nature fig 6 shows the reflection coefficient of p wave with frequency ω for spherical inclusions of two different size a θ 0 0 0 and b θ 0 25 0 it is noted that at θ 0 0 0 the reflected p wave strengthens with increase of frequency when inclusions are of very small size the inclusion size have significant effect on the reflection coefficient while at θ 0 25 0 effect of inclusion size is little bit significant fig 7 exhibits the amplitude ratios of reflected p and transmitted p 1 s v waves with incident direction θ 0 at permeable and impermeable underlying solid substrate the significant effect of flow condition at the interface of double porosity elastic solid is observed on reflected p and transmitted p 1 s v waves the trend of reflected p and transmitted p 1 s v waves at permeable boundary are almost bear analogous trend to those of the corresponding reflected and transmitted waves at impermeable boundary moreover reflected p and transmitted p 1 s v waves fluctuates irregularly when θ 0 40 0 8 conclusions in this study the reflection and transmission of plane wave at water double porosity sediment with an underlying uniform elastic solid substrate is investigated finally for particular numerical example effects of incident direction wave frequency layer thickness pore fluid viscosity radius of spherical inclusions wave induced fluid flow i e lff and sealing of boundary pores on reflection and transmission coefficients are depicted graphically some interesting consequences of present study are explained as follows 1 significant effect of lff is clearly visible on reflection coefficient irrespective of all value of layer thickness except h 0 therefore reflected p wave is sensitive to wave induced fluid flow of fluid in double porosity solid 2 at normal incidence i e θ 0 0 0 the reflected p wave is weakens in the presence of lff corresponding to each value of h 3 significant effect of flow condition at the interface of double porosity elastic solid is observed on reflected p and transmitted p 1 s v waves 4 at normal incidence the reflected p wave strengthens with increase of frequency when inclusions are of very small size while at θ 0 25 0 effect of inclusion size is little bit significant 5 in the presence of lff effect of pore fluid viscosity on reflection coefficient is not observed at low frequency the reflected p wave is strongly dispersive i e frequency dependent and attenuated in nature the study of reservoir characteristics such as layer thickness pore fluid viscosity radius of spherical inclusions wave induced fluid flow i e lff and sealing of boundary pores through seismic reflection and transmission methods is helpful in detecting the hydrocarbon and minerals present inside the fissured rock of the ocean floor on the basis of wave reflection signals the feedback about ocean floor is carried out hence the various issues resolved in this study are involved in many of the practical problems of hydrology geophysics petroleum engineering and seismology appendix the elements of matrix m are defined as m 1 1 ρ 0 v 0 m 1 2 f 1 v 1 2 n q 1 a z 1 m 1 3 f 2 v 2 2 n q 2 a z 2 m 1 4 f 3 v 3 2 n q 3 a z 3 m 1 5 f 4 v 4 2 n q 4 a z 4 m 1 6 s a x 1 q 1 a z 1 f 1 2 n q 1 a z 1 m 1 7 s a x 2 q 2 a z 2 f 2 2 n q 2 a z 2 m 1 8 s a x 3 q 3 a z 3 f 3 2 n q 3 a z 3 m 1 9 s a x 4 q 4 a z 4 f 4 2 n q 4 a z 4 m 1 10 0 m 1 11 0 m 2 1 c o s θ 0 m 2 2 a z 1 m 2 3 a z 2 m 2 4 a z 3 m 2 5 a z 4 m 2 6 a z 1 m 2 7 a z 2 m 2 8 a z 3 m 2 9 a z 4 m 2 10 0 m 2 11 0 m 3 1 0 m 3 2 1 γ 1 a z 1 m 3 3 1 γ 2 a z 2 m 3 4 1 γ 3 a z 3 m 3 5 1 γ 4 a z 4 m 3 6 1 γ 1 a z 1 m 3 7 1 γ 2 a z 2 m 3 8 1 γ 3 a z 3 m 3 9 1 γ 4 a z 4 m 3 10 0 m 3 11 0 m 4 1 0 m 4 2 1 λ 1 a z 1 m 4 3 1 λ 2 a z 2 m 4 4 1 λ 3 a z 3 m 4 5 1 λ 4 a z 4 m 4 6 1 λ 1 a z 1 m 4 7 1 λ 2 a z 2 m 4 8 1 λ 3 a z 3 m 4 9 1 λ 4 a z 4 m 4 10 0 m 4 11 0 m 5 1 0 m 5 2 n s a z 1 q 1 a x 1 m 5 3 n s a z 2 q 2 a x 2 m 5 4 n s a z 3 q 3 a x 3 m 5 5 n s a z 4 q 4 a x 4 m 5 6 n s a z 1 q 1 a x 1 m 5 7 n s a z 2 q 2 a x 2 m 5 8 n s a z 3 q 3 a x 3 m 5 9 n s a z 4 q 4 a x 4 m 5 10 0 m 5 11 0 m 6 1 0 m 6 2 a z 1 e ι ω q 1 h m 6 3 a z 2 e ι ω q 2 h m 6 4 a z 3 e ι ω q 3 h m 6 5 a z 4 e ι ω q 4 h m 6 6 a z 1 e ι ω q 1 h m 6 7 a z 2 e ι ω q 2 h m 6 8 a z 3 e ι ω q 3 h m 6 9 a z 4 e ι ω q 4 h m 6 10 cos α e ι ω cos α v p h m 6 11 sin β e ι ω cos β v s h m 7 1 0 m 7 2 a x 1 e ι ω q 1 h m 7 3 a x 2 e ι ω q 2 h m 7 4 a x 3 e ι ω q 3 h m 7 5 a x 4 e ι ω q 4 h m 7 6 a x 1 e ι ω q 1 h m 7 7 a x 2 e ι ω q 2 h m 7 8 a x 3 e ι ω q 3 h m 7 9 a x 4 e ι ω q 4 h m 7 10 sin α e ι ω cos α v p h m 7 11 cos β e ι ω cos β v s h m 8 1 0 m 8 2 ζ t 0 γ 1 a z 1 1 ζ g 1 v 1 e ι ω q 1 h m 8 3 ζ t 0 γ 2 a z 2 1 ζ g 2 v 2 e ι ω q 2 h m 8 4 ζ t 0 γ 3 a z 3 1 ζ g 3 v 3 e ι ω q 3 h m 8 5 ζ t 0 γ 4 a z 4 1 ζ g 4 v 4 e ι ω q 4 h m 8 6 ζ t 0 γ 1 a z 1 1 ζ g 1 s a x 1 q 1 a z 1 e ι ω q 1 h m 8 7 ζ t 0 γ 2 a z 2 1 ζ g 2 s a x 2 q 2 a z 2 e ι ω q 2 h m 8 8 ζ t 0 γ 3 a z 3 1 ζ g 3 s a x 3 q 3 a z 3 e ι ω q 3 h m 8 9 ζ t 0 γ 4 a z 4 1 ζ g 4 s a x 4 q 4 a z 4 e ι ω q 4 h m 8 10 0 m 8 11 0 m 9 1 0 m 9 2 ζ t 0 λ 1 a z 1 1 ζ h 1 v 1 e ι ω q 1 h m 9 3 ζ t 0 λ 2 a z 2 1 ζ h 2 v 2 e ι ω q 2 h m 9 4 ζ t 0 λ 3 a z 3 1 ζ h 3 v 3 e ι ω q 3 h m 9 5 ζ t 0 λ 4 a z 4 1 ζ h 4 v 4 e ι ω q 4 h m 9 6 ζ t 0 λ 1 a z 1 1 ζ h 1 s a x 1 q 1 a z 1 e ι ω q 1 h m 9 7 ζ t 0 λ 2 a z 2 1 ζ h 2 s a x 2 q 2 a z 2 e ι ω q 2 h m 9 8 ζ t 0 λ 3 a z 3 1 ζ h 3 s a x 3 q 3 a z 3 e ι ω q 3 h m 9 9 ζ t 0 λ 4 a z 4 1 ζ h 4 s a x 4 q 4 a z 4 e ι ω q 4 h m 9 10 0 m 9 11 0 m 10 1 0 m 10 2 f 1 v 1 2 n q 1 a z 1 e ι ω q 1 h m 10 3 f 2 v 2 2 n q 2 a z 2 e ι ω q 2 h m 10 4 f 3 v 3 2 n q 3 a z 3 e ι ω q 3 h m 10 5 f 4 v 4 2 n q 4 a z 4 e ι ω q 4 h m 10 6 f 1 s a x 1 q 1 a z 1 2 n q 1 a z 1 e ι ω q 1 h m 10 7 f 2 s a x 2 q 2 a z 2 2 n q 2 a z 2 e ι ω q 2 h m 10 8 f 3 s a x 3 q 1 a z 3 2 n q 3 a z 3 e ι ω q 3 h m 10 9 f 4 s a x 4 q 4 a z 4 2 n q 4 a z 4 e ι ω q 4 h m 10 10 λ 2 μ cos 2 α 1 v p e ι ω cos α v p h m 10 11 μ sin 2 β 1 v s e ι ω cos β v s h m 11 1 0 m 11 2 n s a z 1 q 1 a x 1 e ι ω q 1 h m 11 3 n s a z 2 q 2 a x 2 e ι ω q 2 h m 11 4 n s a z 3 q 3 a x 3 e ι ω q 3 h m 11 5 n s a z 4 q 4 a x 4 e ι ω q 4 h m 11 6 n s a z 1 q 1 a x 1 e ι ω q 1 h m 11 7 n s a z 2 q 2 a x 2 e ι ω q 2 h m 11 8 n s a z 3 q 3 a x 3 e ι ω q 3 h m 11 9 n s a z 4 q 4 a x 4 e ι ω q 4 h m 11 10 μ sin 2 α 1 v p e ι ω cos α v p h m 11 11 μ sin 2 β cos 2 β 1 v s e ι ω cos β v s h where f k λ 0 λ 1 λ 2 e 0 λ 1 λ 1 λ 2 e 1 γ k λ 2 λ 1 λ 2 e 2 λ k g k λ 1 λ 3 e 0 λ 3 λ 3 e 1 γ k λ 3 e 2 λ k h k λ 2 λ 4 e 0 λ 4 e 1 γ k λ 4 λ 4 e 2 λ k k 1 2 3 the elements of matrix n are defined as n 1 ρ 0 v 0 n 2 c o s θ 0 n 3 0 n 4 0 n 5 0 n 6 0 n 7 0 n 8 0 n 9 0 n 10 0 n 11 0 
23724,the present paper proposes an empirical formula for maximum wave setup based on a coupled wave current model the wave model is the simulating waves nearshore swan model the current model is the finite volume community ocean model fvcom this study first evaluates the coupled model system against mean water level data collected from a series of laboratory and field experiments the model calculation agrees with the measurements then the study uses the model results from simulations with a range of wave conditions to develop an empirical formula for the maximum wave setup as a function of wave height wavelength in deep water and beach slope the formula agrees with experimental and in situ measurements and shows better performance than previous formulas keywords random waves wave setup wave current interaction swan fvcom 1 introduction wave setup or setdown defined as an increase or decrease in the mean water level with the presence of waves is a common dynamic process in the nearshore zone lentz and raubenheimer 1999 wave setup dynamics is important for understanding many coastal phenomena such as sediment transport and wave structure interaction calabrese et al 2008 hu et al 2009 the maximum wave setup elevation is a key criterion for coastal protection and coastal flooding prediction guza and thornton 1981 nielsen 1988 since the mid 20th century researchers have investigated wave setup using theoretical experimental and numerical methods considering the radiation stress caused by regular waves e g longuet higgins and stewart 1964 hereinafter lhs derived an analytical solution for the horizontal gradient of the mean sea level along the offshore direction 1 d η d x k tan β k 1 1 8 3 γ b 2 where η is the mean water level x is the offshore coordinate β represents the angle of the beach slope and γ b is the ratio of wave height to water depth at breaking and is assumed to be constant with the assumption that β constant and the solution of eq 1 battjes 1974 showed that the maximum wave setup value would occur on a beach characterized by the following expression 2 η max 5 16 γ b h b where h b is the wave height at the breaking line based on laboratory experiments bowen et al 1968 and van dorn 1976 studied the maximum setup properties of monochromatic waves with wave flumes and they found that the lhs theory agreed with their experiments battjes 1972 1974 investigated the wave setup of random waves using laboratory experiments they concluded that the maximum setup was somewhat lower than that predicted by the lhs theory most likely because the theory ignored variation in γ b since then several studies have produced field observations e g guza and thornton 1981 nielsen 1988 raubenheimer et al 2001 stockdon et al 2006 based on in situ data from natural gently sloping beaches in southern california guza and thornton 1981 proposed the following expression of the maximum mean water level 3 η max 0 17 h 0 s where h 0 s is the significant wave height the average height of the highest one third of waves or four times the standard deviation of the time series of sea surface elevation in deep water later studies extended eq 3 to a more general relationship including the iribarren number nielsen 1988 stockdon et al 2006 4 η max h 0 s ξ 0 in which ξ 0 tan β h 0 s l 0 is the iribarren number and l 0 is the wavelength in deep water obtained using the peak wave period holman and sallenger 1985 reported an empirical regression equation for the maximum setup value based on the data collected by field experiments under middle tide conditions 5 η max h 0 s 0 46 ξ 0 hanslow and nielsen 1992 produced the following empirical equation based on field measurements along the new south wales coast 6 η max 0 048 h 0 r m s l 0 s 0 5 where h 0 r m s is the root mean square wave height in deep water and l 0 s is the wavelength in deep water computed using the significant period the average period of the highest one third of waves the wave heights are assumed to obey the rayleigh distribution in deep water indicating that h 0 r m s h 0 s 2 battjes and groenendijk 2000 using datasets from ten field experiments over a range of beach and wave conditions stockdon et al 2006 developed an empirical formulation for the maximum wave setup using an iribarren like form 7 η max 0 35 tan β h 0 s l 0 0 5 although researchers have presented expressions of the maximum wave setup for both monochromatic and random waves most of the expressions for random waves are empirical formulas fitted to field observation data collected from limited places and times therefore studies have yet to explore the broad applicability of these formulas recently researchers have increasingly used numerical models to simulate wave dynamics in idealized or realistic situations for instance wolf et al 1988 developed a coupled model to investigate the interactions between waves and tides or surges schäffer et al 1993 and madsen et al 1997a 1997b simulated wave dynamics in the surf zone using a boussinesq type model and obtained good agreement between the model results and measurements more recently mellor et al 2008 developed a coupled wave circulation model to consider the influences of wave induced radiation stress on ocean circulation warner et al 2008 developed a coupled wave current sediment model to stress the role of waves on sediment transport in estuaries and coastal waters kumar et al 2012 implemented vortex force formalism in the coupled ocean atmosphere wave sediment transport modeling system coawst numerical models involve solving variations in wave parameters with time and space via a set of momentum and energy conservation equations with forcing boundary and initial conditions in contrast to field observations where forcing conditions are complex researchers can use numerical models to study wave dynamics under controlled forcing conditions based on specific purposes accordingly this study investigates maximum wave setup using a coupled wave current model the arrangement of the present paper is as follows section 2 describes the model setup and verification section 3 presents the model results and an empirical formula for the maximum wave setup section 4 shows the evaluation of this formula section 5 provides a discussion of the limitations of this approach and comparisons between this empirical formula and several previous formulations finally section 6 presents the conclusions 2 model description 2 1 model framework the present study applies a coupled wave current model system that includes the simulating waves nearshore swan wave model and the finite volume community ocean model fvcom circulation model information exchange between the two models uses model coupling toolkit mct software jacob et al 2005 larson et al 2005 the present investigation uses mct to couple swan and fvcom following the method of yang 2012 and runs the two models on the same unstructured grid both swan and fvcom run on their set of processors in the coupled system and exchange information based on a defined time interval depending on computational power and the temporal scales of the specific wave and circulation conditions fig 1 shows the information exchange between swan and fvcom the coupled model system runs on linux platforms fvcom uses the wave parameters transferred from swan to calculate the force in the form of wave induced radiation stress gradients and to generate the currents and wave setup swan uses the currents and water levels transferred from fvcom to include current and water level change effects on wave transformation and breaking processes finally the wave setup is numerically established after reaching a steady state the maximum wave setup is defined as the mean water level elevation at the interaction between wetting and drying on the beach face in the model run the minimum grid spacing is 1 7 to 1 20 of the shoreline advancement landward in the horizontal direction and is small enough to be suitably accurate for the maximum setup 2 2 wave model swan is a third generation wave model developed by delft university and is a fully discrete spectral model based on the action balance equation booij et al 1999 the mean rate of energy dissipation per unit horizontal area as a result of wave breaking uses the results of battjes and janssen 1978 based on the following expression 8 d tot 1 4 α bj q b σ 2 π h max 2 where the coefficient α bj 1 σ is the mean frequency and q b is the fraction of breaking waves and is computed as follows 9 1 q b ln q b 8 e tot h max 2 where e tot is the total wave energy the maximum wave height h max is determined in swan via h max γ b d in which γ b is the breaker index and d is the water depth then the spectral dependent energy dissipation is calculated as follows 10 s ds br σ θ d tot e tot e σ θ where e σ θ is the energy density spectrum following goda 1970 2009 the breaker index is defined as follows 11 γ b a 1 exp 1 5 π d b l 0 1 15 tan 4 3 β d b l 0 where a is the breaking coefficient and d b is the water depth at the breaking of the wave the value of a is given by the expression below according to the study of shen et al 2015 12 a 0 228 h 0 l 0 0 108 this study added eqs 11 and 12 to the swan model to determine the breaker index based on the wave parameters water depth and slope the swan model with the modified goda formula can provide good predictions of nearshore random wave breaking without manually adjusting the parameters of the breaker index shen et al 2015 2 3 circulation model the circulation model is fvcom chen et al 2003 2007 the primary governing equations in the terrain following coordinate including the influence of waves are as follows 13 η t d u x d v y w σ 0 14 u d t u 2 d x u v d y u w σ f v d g d η x g d ρ 0 x d σ 0 ρ d σ σ ρ d x 1 d σ k m u σ d f x d s x x x d s x y y s p x σ d r x x x d r x y y 15 v d t u v d x v 2 d y v w σ f u d g d η y g d ρ 0 y d σ 0 ρ d σ σ ρ d y 1 d σ k m v σ d f y d s y x x d s y y y s p y σ d r y x x d r y y y in which d represents the total water depth and d h η where h is the bottom depth and η is the height of the free surface u v and w are the x y and σ velocity components respectively f is the coriolis parameter g is the gravitational acceleration ρ and ρ 0 are the total and reference densities respectively k m is the vertical eddy viscosity coefficient parameterized using the my 2 5 turbulence submodel mellor and yamada 1982 f x and f y represent horizontal momentum diffusion terms s x x s x y s y x and s y y are horizontal radiation stress terms s p x and s p y are vertical radiation stress terms r x x r x y r y x and r y y are surface roller terms svendsen 1984 and σ is the vertical sigma coordinate and is defined as follows 16 σ z η h η z η d the two alternative representations of the wave effects on coastal waters are radiation stress and vortex force bennis et al 2011 kumar et al 2012 previous studies kumar et al 2012 moghimi et al 2013 have shown that these two representations are in general agreement regarding wave setup which is the focus in the present paper here fvcom employed the equations of mellor 2003 mellor 2013 2015 provided a corroborative and simpler derivation of the vertically dependent equations of radiation stress certain details in mellor 2003 were corrected see http shoni2 princeton edu ftp glm corrected2003 pdf this model included the radiation stress caused by waves using the theory of mellor 2015 17 s x x k e k x k x k 2 f c s f c c f s s f s c e 2 d σ 2 f c c f s s f s s 2 18 s y y k e k y k y k 2 f c s f c c f s s f s c e 2 d σ 2 f c c f s s f s s 2 19 s x y s y x k e k x k y k 2 f c s f c c in which k is the wave number k x and k y are the wave number components in the x and y directions respectively and e is the wave energy the vertical distribution functions are calculated as follows 20 f s s sinh k d 1 σ sinh k d 21 f c s cosh k d 1 σ sinh k d 22 f s c sinh k d 1 σ cosh k d 23 f c c cosh k d 1 σ cosh k d 2 4 model verification this section describes the verification of the coupled model system with experimental data from the literature table 1 lists the experiments the present investigation also includes field measurements of the sandyduck experiment the field data are from raubenheimer et al 2001 and apotsos et al 2007 to verify the model the model simulations use default values and options for most model control parameters table 2 presents the selected model parameters fig 2 shows the comparison of simulated wave height and mean water level with data following ahmed and sato 2003 and bonakdar and etemad shahidi 2011 this study further compares the model results with data using statistical parameters including the index of agreement i a correlation coefficient cc mean bias error mbe root mean squared error rmse and relative root mean squared error rrmse 24 i a 1 i 1 n x i y i 2 i 1 n x i μ y y i μ y 2 25 c c 1 n i 1 n x i μ x y i μ y 1 n i 1 n x i μ x 2 1 n i 1 n y i μ y 2 26 m b e 1 n i 1 n x i y i 27 r m s e 1 n i 1 n x i y i 2 28 r r m s e 1 n i 1 n x i y i 2 1 n i 1 n y i 2 where n is the number of the measured values x i and y i denote the predicted and measured values respectively and μ x and μ y are the corresponding mean values of the predicted and measured parameters respectively table 3 presents the statistical comparisons for six series of simulated results the model results are in good agreement with observations at laboratory and field scales the i a and cc values are higher than 0 9 while mbes rmses and rrmses are all satisfactorily small 3 results this section describes the use of the coupled model system to simulate a series of cases under controlled conditions to develop an empirical formula for the maximum wave setup fig 3 shows the schematic diagram of the test beach profile table 4 presents the test input conditions in the model run the time steps for swan and fvcom are 10 and 0 02 s respectively the time interval for information exchange between the two models is 10 s 3 1 result analysis the results of tests 25 30 shown in fig 4 a demonstrate the effects of the wave height on the maximum wave setup the maximum wave setup is positively correlated with the wave height a larger wave causes a greater wave setup the rate of increase in the maximum setup with wave height appears to decrease with increasing wave height similar features can also be found for wave period and beach slope fig 4b and c 3 2 formula development in shore normal wave cases three parameters dominate the maximum wave setup wave height wave period and beach slope holman and sallenger 1985 stockdon et al 2006 an implicit function can be expressed as follows 29 f η max h 0 r m s t p tan β 0 which can be transformed into a non dimensional form 30 f η max h 0 r m s h 0 r m s l 0 tan β 0 where l 0 the wavelength in deep water is calculated as follows 31 l 0 g t p 2 2 π fig 5 shows the relationships between η max h 0 r m s and h 0 r m s l 0 in eq 30 for seven different beach slopes by assuming that the relationship is simply a power law function the empirical formula can be expressed as 32 η max h 0 r m s α 1 h 0 r m s l 0 α 2 in which α 1 and α 2 are undetermined coefficients related to the slope fig 6 shows the fitted curves for the relationships between α 1 or α 2 and tan β obtained for seven different beach slopes the parameters α 1 and tan β show a power function relationship and α 2 is a constant this study obtains the parameters using the least square method harris 1998 33 α 1 0 274 tan β 0 538 34 α 2 0 371 therefore the empirical formula for the maximum wave setup becomes 35 η max h 0 r m s 0 274 tan β 0 538 h 0 r m s l 0 0 371 after further simplification eq 35 becomes the following 36 η max 0 274 h 0 r m s 0 629 l 0 0 371 tan β 0 538 using h 0 r m s h 0 s 2 eq 36 can be converted to a formula in terms of h 0 s 37 η max 0 220 h 0 s 0 629 l 0 0 371 tan β 0 538 4 formula evaluation 4 1 comparison with experimental measurements this subsection compares eq 36 with data collected from the different laboratory experiments listed in table 5 wave setup formulas developed from the literature are also compared to examine the feasibility of the formula developed in the present paper fig 7 shows that eq 36 agrees with the laboratory data the experimental maximum wave setup was slightly underestimated by holman and sallenger 1985 and stockdon et al 2006 but was clearly overestimated by hanslow and nielsen 1992 the formula of guza and thornton 1981 produces results comparable to the data for high wave setups but produces overestimates for low wave setups table 6 presents quantitative comparisons based on the five variables i a cc mbe rmse and rrmse the i a value of the present formula is as high as 0 99 which is greater than those of previous formulas ranging from 0 73 to 0 97 the cc between the data and the present formula is 0 99 comparable to those presented by holman and sallenger 1985 and stockdon et al 2006 and higher than those of guza and thornton 1981 0 85 and hanslow and nielsen 1992 0 94 the mbe of the present formula is negligibly small the rmse and rrmse values are 10 3 m and 0 12 respectively these are much smaller than those of previously proposed formulas 4 2 comparison with field measurements the present study also compares eq 36 with field measurements collected by hanslow and nielsen 1992 from sites along the new south wales coast because the beach slope is non uniform hanslow and nielsen 1992 gave an approximate range of profile slopes this paper uses the mean slope in the comparison fig 8 shows the performance of different empirical formulas in determining maximum wave setup overall the formula in this study shows good agreement with the data and performs better than the formula of guza and thornton 1981 which underestimates the wave setup compared with the observations the formulas of holman and sallenger 1985 and stockdon et al 2006 are satisfactory for steep slopes but underestimate the wave setup for gently sloping beaches brunswick beach and seven mile beach as with the laboratory data comparison table 7 presents detailed comparisons based on statistical measures the i a value of the present formula is 0 74 which is greater than those of previous formulas except for the formula of hanslow and nielsen 1992 0 82 the cc of the present formula 0 71 is greater than those of the other formulas the rmse and rrmse values of the present formula are 0 31 m and 0 33 respectively these two statistical values however are higher than those of hanslow and nielsen 1992 overall the formula of hanslow and nielsen 1992 seems to be slightly better than the formula of the present study this superiority seems obvious because these authors developed their formula from the field data used here whereas the present formula is independent of the data the slope data provided by hanslow and nielsen 1992 are approximate this research also evaluates the proposed formula using another more accurate dataset collected by stockdon and holman 2011 fig 9 shows the comparisons of different empirical formulas and field measurements the new formulation yields better agreement the observations of wave setup were clearly underestimated by guza and thornton 1981 but were overestimated by holman and sallenger 1985 table 7 presents the comparison of statistics for different formulas the i a and cc values of the present formula are 0 85 and 0 76 respectively which are greater than those of previous formulas the mbe of the present formula 0 02 m is negligibly small at field scale the rmse and rrmse values of the present formula are 0 19 m and 0 33 respectively which are smaller than those of the other formulas the quantitative comparisons above show that the formula proposed in the present study is better than previous formulations including the formula of stockdon et al 2006 which was developed using the same data 5 discussion based on a coupled wave current model system the present study proposed a new maximum wave setup formula and evaluated it against experimental and field measurements however the authors of this study recognize certain limitations of this approach this section also discusses the comparisons between eq 36 and the formulations of holman and sallenger 1985 and stockdon et al 2006 first this research developed the formula based on model results under idealized conditions by simulating a wide range of wave conditions table 4 and including the effects of wave breaking bottom friction wave current interaction and surface rollers certain model simplifications were present in this approach for instance the idealized cases used a uniform planar slope and did not consider complex bottom topography similarly the development process limited the formula to the cross shore only and used the jonswap spectrum to specify waves at the offshore boundary these factors may be important for wave setup at the shoreline in certain cases hsu et al 2006 guza and feddersen 2012 cox et al 2013 cohn and ruggiero 2016 park and cox 2016 some model parameters e g bottom friction in swan are tunable and may have significant effects on wave propagation to influence the wave setup sections 2 4 and 3 have applied the default or same moderate parameters table 2 in all model simulations this treatment may influence the accuracy for different cases overall the purpose of this paper is to provide a general formula that can be used for practical applications and rapid computability in the real world simple empirical formulas may not reflect complex physical processes such as nonlinear wave and current effects in certain cases e g complex bathymetry varied shoreline geometry structure and strong current effects the numerical model would provide more accurate results although it may require a longer computation time and more detailed input information second figs 7 9 show that the formulations of holman and sallenger 1985 and stockdon et al 2006 also perform well considering the allowed error range these two formulas and eq 36 are similar in terms of three essential factors wave height wavelength and beach slope are included in the formulations holman and sallenger 1985 and stockdon et al 2006 proposed that the maximum wave setup may be directly proportional to ξ 0 eqs 5 and 7 that is the relationship between the maximum wave setup and beach slope is linear in the numerical model of this study the maximum wave setup varies with the breaker index calculated by the modified goda formula as shown in eqs 11 and 12 therefore the maximum wave setup would have a nonlinear relationship with the slope the empirical formula developed from the simulated results of the coupled model system certainly shows a weak nonlinear relationship between the maximum wave setup and beach slope the maximum wave setup is approximately proportional to the square root of the slope the present formula indicates that the wave height is dominant compared to the wavelength however the formulations of holman and sallenger 1985 and stockdon et al 2006 are associated with the iribarren parameter indicating wave height and wavelength are equally important for the maximum wave setup this factor is an obvious difference between the formula of this study and previous formulas following lhs the cross shore gradient of the radiation stress which is primarily influenced by the wave height drives the wave setup therefore wave height seems to be a more important factor relative to wavelength or period in determining the wave setup 6 conclusions the present study developed an empirical formula for the maximum wave setup from a coupled wave current model system based on swan and fvcom the study first evaluated the coupled model system using wave height and mean water level data collected from laboratory and field experiments covering a broad range of wave conditions the root mean squared errors of the mean water level between the data and the counterparts from the model are less than 0 01 m and the correlation coefficients are usually higher than 0 93 this study then used the model results based on a series of practical wave conditions to develop an empirical formula for the maximum wave setup via the least square method the final formation of the proposed formula is η max 0 274 h 0 r m s 0 629 l 0 0 371 tan β 0 538 where h 0 r m s h 0 s 2 is the root mean square wave height for random waves in deep water l 0 is the wavelength in deep water obtained using the peak wave period and β is the angle of the beach slope the structure of the formula is similar to that of formulas in many previous studies but the parameter values are different specifically the proposed formula shows a weak nonlinear relationship between the maximum wave setup and the beach slope and wave height is a more important factor than the wavelength in determining the wave setup using experimental and field measurements the authors of this paper evaluated the proposed formula the two independent field datasets cover wave heights of 0 25 4 30 m wave periods of 3 7 17 0 s and beach slopes of 0 01 0 16 the root mean squared errors between the formula and the two sets of field observations are 0 31 and 0 19 m and the relative root mean squared errors for both are 0 33 the proposed formula can account for most of the observed maximum wave setup in addition this study compared the present formula to previous formulas based on experimental and field data the present formula is more reliable in terms of widespread applicability than previously proposed formulas the new empirical formula might not be applicable to complex geophysical conditions e g in front of a stiff wall structure or varied shoreline geometry future work will consider more practical wave current and topographic conditions e g obliquely incident waves and complex bathymetry acknowledgments the national key research and development program of china grant no 2017yfc1404200 the science fund for creative research groups of the national natural science foundation of china grant no 51621092 and the open fund of the state key laboratory of hydraulic engineering simulation and safety tianjin university grant no hess 1514 supported this research the authors thank the anonymous reviewers for their constructive comments especially the suggestion of using the available dataset of stockdon and holman 2011 
23724,the present paper proposes an empirical formula for maximum wave setup based on a coupled wave current model the wave model is the simulating waves nearshore swan model the current model is the finite volume community ocean model fvcom this study first evaluates the coupled model system against mean water level data collected from a series of laboratory and field experiments the model calculation agrees with the measurements then the study uses the model results from simulations with a range of wave conditions to develop an empirical formula for the maximum wave setup as a function of wave height wavelength in deep water and beach slope the formula agrees with experimental and in situ measurements and shows better performance than previous formulas keywords random waves wave setup wave current interaction swan fvcom 1 introduction wave setup or setdown defined as an increase or decrease in the mean water level with the presence of waves is a common dynamic process in the nearshore zone lentz and raubenheimer 1999 wave setup dynamics is important for understanding many coastal phenomena such as sediment transport and wave structure interaction calabrese et al 2008 hu et al 2009 the maximum wave setup elevation is a key criterion for coastal protection and coastal flooding prediction guza and thornton 1981 nielsen 1988 since the mid 20th century researchers have investigated wave setup using theoretical experimental and numerical methods considering the radiation stress caused by regular waves e g longuet higgins and stewart 1964 hereinafter lhs derived an analytical solution for the horizontal gradient of the mean sea level along the offshore direction 1 d η d x k tan β k 1 1 8 3 γ b 2 where η is the mean water level x is the offshore coordinate β represents the angle of the beach slope and γ b is the ratio of wave height to water depth at breaking and is assumed to be constant with the assumption that β constant and the solution of eq 1 battjes 1974 showed that the maximum wave setup value would occur on a beach characterized by the following expression 2 η max 5 16 γ b h b where h b is the wave height at the breaking line based on laboratory experiments bowen et al 1968 and van dorn 1976 studied the maximum setup properties of monochromatic waves with wave flumes and they found that the lhs theory agreed with their experiments battjes 1972 1974 investigated the wave setup of random waves using laboratory experiments they concluded that the maximum setup was somewhat lower than that predicted by the lhs theory most likely because the theory ignored variation in γ b since then several studies have produced field observations e g guza and thornton 1981 nielsen 1988 raubenheimer et al 2001 stockdon et al 2006 based on in situ data from natural gently sloping beaches in southern california guza and thornton 1981 proposed the following expression of the maximum mean water level 3 η max 0 17 h 0 s where h 0 s is the significant wave height the average height of the highest one third of waves or four times the standard deviation of the time series of sea surface elevation in deep water later studies extended eq 3 to a more general relationship including the iribarren number nielsen 1988 stockdon et al 2006 4 η max h 0 s ξ 0 in which ξ 0 tan β h 0 s l 0 is the iribarren number and l 0 is the wavelength in deep water obtained using the peak wave period holman and sallenger 1985 reported an empirical regression equation for the maximum setup value based on the data collected by field experiments under middle tide conditions 5 η max h 0 s 0 46 ξ 0 hanslow and nielsen 1992 produced the following empirical equation based on field measurements along the new south wales coast 6 η max 0 048 h 0 r m s l 0 s 0 5 where h 0 r m s is the root mean square wave height in deep water and l 0 s is the wavelength in deep water computed using the significant period the average period of the highest one third of waves the wave heights are assumed to obey the rayleigh distribution in deep water indicating that h 0 r m s h 0 s 2 battjes and groenendijk 2000 using datasets from ten field experiments over a range of beach and wave conditions stockdon et al 2006 developed an empirical formulation for the maximum wave setup using an iribarren like form 7 η max 0 35 tan β h 0 s l 0 0 5 although researchers have presented expressions of the maximum wave setup for both monochromatic and random waves most of the expressions for random waves are empirical formulas fitted to field observation data collected from limited places and times therefore studies have yet to explore the broad applicability of these formulas recently researchers have increasingly used numerical models to simulate wave dynamics in idealized or realistic situations for instance wolf et al 1988 developed a coupled model to investigate the interactions between waves and tides or surges schäffer et al 1993 and madsen et al 1997a 1997b simulated wave dynamics in the surf zone using a boussinesq type model and obtained good agreement between the model results and measurements more recently mellor et al 2008 developed a coupled wave circulation model to consider the influences of wave induced radiation stress on ocean circulation warner et al 2008 developed a coupled wave current sediment model to stress the role of waves on sediment transport in estuaries and coastal waters kumar et al 2012 implemented vortex force formalism in the coupled ocean atmosphere wave sediment transport modeling system coawst numerical models involve solving variations in wave parameters with time and space via a set of momentum and energy conservation equations with forcing boundary and initial conditions in contrast to field observations where forcing conditions are complex researchers can use numerical models to study wave dynamics under controlled forcing conditions based on specific purposes accordingly this study investigates maximum wave setup using a coupled wave current model the arrangement of the present paper is as follows section 2 describes the model setup and verification section 3 presents the model results and an empirical formula for the maximum wave setup section 4 shows the evaluation of this formula section 5 provides a discussion of the limitations of this approach and comparisons between this empirical formula and several previous formulations finally section 6 presents the conclusions 2 model description 2 1 model framework the present study applies a coupled wave current model system that includes the simulating waves nearshore swan wave model and the finite volume community ocean model fvcom circulation model information exchange between the two models uses model coupling toolkit mct software jacob et al 2005 larson et al 2005 the present investigation uses mct to couple swan and fvcom following the method of yang 2012 and runs the two models on the same unstructured grid both swan and fvcom run on their set of processors in the coupled system and exchange information based on a defined time interval depending on computational power and the temporal scales of the specific wave and circulation conditions fig 1 shows the information exchange between swan and fvcom the coupled model system runs on linux platforms fvcom uses the wave parameters transferred from swan to calculate the force in the form of wave induced radiation stress gradients and to generate the currents and wave setup swan uses the currents and water levels transferred from fvcom to include current and water level change effects on wave transformation and breaking processes finally the wave setup is numerically established after reaching a steady state the maximum wave setup is defined as the mean water level elevation at the interaction between wetting and drying on the beach face in the model run the minimum grid spacing is 1 7 to 1 20 of the shoreline advancement landward in the horizontal direction and is small enough to be suitably accurate for the maximum setup 2 2 wave model swan is a third generation wave model developed by delft university and is a fully discrete spectral model based on the action balance equation booij et al 1999 the mean rate of energy dissipation per unit horizontal area as a result of wave breaking uses the results of battjes and janssen 1978 based on the following expression 8 d tot 1 4 α bj q b σ 2 π h max 2 where the coefficient α bj 1 σ is the mean frequency and q b is the fraction of breaking waves and is computed as follows 9 1 q b ln q b 8 e tot h max 2 where e tot is the total wave energy the maximum wave height h max is determined in swan via h max γ b d in which γ b is the breaker index and d is the water depth then the spectral dependent energy dissipation is calculated as follows 10 s ds br σ θ d tot e tot e σ θ where e σ θ is the energy density spectrum following goda 1970 2009 the breaker index is defined as follows 11 γ b a 1 exp 1 5 π d b l 0 1 15 tan 4 3 β d b l 0 where a is the breaking coefficient and d b is the water depth at the breaking of the wave the value of a is given by the expression below according to the study of shen et al 2015 12 a 0 228 h 0 l 0 0 108 this study added eqs 11 and 12 to the swan model to determine the breaker index based on the wave parameters water depth and slope the swan model with the modified goda formula can provide good predictions of nearshore random wave breaking without manually adjusting the parameters of the breaker index shen et al 2015 2 3 circulation model the circulation model is fvcom chen et al 2003 2007 the primary governing equations in the terrain following coordinate including the influence of waves are as follows 13 η t d u x d v y w σ 0 14 u d t u 2 d x u v d y u w σ f v d g d η x g d ρ 0 x d σ 0 ρ d σ σ ρ d x 1 d σ k m u σ d f x d s x x x d s x y y s p x σ d r x x x d r x y y 15 v d t u v d x v 2 d y v w σ f u d g d η y g d ρ 0 y d σ 0 ρ d σ σ ρ d y 1 d σ k m v σ d f y d s y x x d s y y y s p y σ d r y x x d r y y y in which d represents the total water depth and d h η where h is the bottom depth and η is the height of the free surface u v and w are the x y and σ velocity components respectively f is the coriolis parameter g is the gravitational acceleration ρ and ρ 0 are the total and reference densities respectively k m is the vertical eddy viscosity coefficient parameterized using the my 2 5 turbulence submodel mellor and yamada 1982 f x and f y represent horizontal momentum diffusion terms s x x s x y s y x and s y y are horizontal radiation stress terms s p x and s p y are vertical radiation stress terms r x x r x y r y x and r y y are surface roller terms svendsen 1984 and σ is the vertical sigma coordinate and is defined as follows 16 σ z η h η z η d the two alternative representations of the wave effects on coastal waters are radiation stress and vortex force bennis et al 2011 kumar et al 2012 previous studies kumar et al 2012 moghimi et al 2013 have shown that these two representations are in general agreement regarding wave setup which is the focus in the present paper here fvcom employed the equations of mellor 2003 mellor 2013 2015 provided a corroborative and simpler derivation of the vertically dependent equations of radiation stress certain details in mellor 2003 were corrected see http shoni2 princeton edu ftp glm corrected2003 pdf this model included the radiation stress caused by waves using the theory of mellor 2015 17 s x x k e k x k x k 2 f c s f c c f s s f s c e 2 d σ 2 f c c f s s f s s 2 18 s y y k e k y k y k 2 f c s f c c f s s f s c e 2 d σ 2 f c c f s s f s s 2 19 s x y s y x k e k x k y k 2 f c s f c c in which k is the wave number k x and k y are the wave number components in the x and y directions respectively and e is the wave energy the vertical distribution functions are calculated as follows 20 f s s sinh k d 1 σ sinh k d 21 f c s cosh k d 1 σ sinh k d 22 f s c sinh k d 1 σ cosh k d 23 f c c cosh k d 1 σ cosh k d 2 4 model verification this section describes the verification of the coupled model system with experimental data from the literature table 1 lists the experiments the present investigation also includes field measurements of the sandyduck experiment the field data are from raubenheimer et al 2001 and apotsos et al 2007 to verify the model the model simulations use default values and options for most model control parameters table 2 presents the selected model parameters fig 2 shows the comparison of simulated wave height and mean water level with data following ahmed and sato 2003 and bonakdar and etemad shahidi 2011 this study further compares the model results with data using statistical parameters including the index of agreement i a correlation coefficient cc mean bias error mbe root mean squared error rmse and relative root mean squared error rrmse 24 i a 1 i 1 n x i y i 2 i 1 n x i μ y y i μ y 2 25 c c 1 n i 1 n x i μ x y i μ y 1 n i 1 n x i μ x 2 1 n i 1 n y i μ y 2 26 m b e 1 n i 1 n x i y i 27 r m s e 1 n i 1 n x i y i 2 28 r r m s e 1 n i 1 n x i y i 2 1 n i 1 n y i 2 where n is the number of the measured values x i and y i denote the predicted and measured values respectively and μ x and μ y are the corresponding mean values of the predicted and measured parameters respectively table 3 presents the statistical comparisons for six series of simulated results the model results are in good agreement with observations at laboratory and field scales the i a and cc values are higher than 0 9 while mbes rmses and rrmses are all satisfactorily small 3 results this section describes the use of the coupled model system to simulate a series of cases under controlled conditions to develop an empirical formula for the maximum wave setup fig 3 shows the schematic diagram of the test beach profile table 4 presents the test input conditions in the model run the time steps for swan and fvcom are 10 and 0 02 s respectively the time interval for information exchange between the two models is 10 s 3 1 result analysis the results of tests 25 30 shown in fig 4 a demonstrate the effects of the wave height on the maximum wave setup the maximum wave setup is positively correlated with the wave height a larger wave causes a greater wave setup the rate of increase in the maximum setup with wave height appears to decrease with increasing wave height similar features can also be found for wave period and beach slope fig 4b and c 3 2 formula development in shore normal wave cases three parameters dominate the maximum wave setup wave height wave period and beach slope holman and sallenger 1985 stockdon et al 2006 an implicit function can be expressed as follows 29 f η max h 0 r m s t p tan β 0 which can be transformed into a non dimensional form 30 f η max h 0 r m s h 0 r m s l 0 tan β 0 where l 0 the wavelength in deep water is calculated as follows 31 l 0 g t p 2 2 π fig 5 shows the relationships between η max h 0 r m s and h 0 r m s l 0 in eq 30 for seven different beach slopes by assuming that the relationship is simply a power law function the empirical formula can be expressed as 32 η max h 0 r m s α 1 h 0 r m s l 0 α 2 in which α 1 and α 2 are undetermined coefficients related to the slope fig 6 shows the fitted curves for the relationships between α 1 or α 2 and tan β obtained for seven different beach slopes the parameters α 1 and tan β show a power function relationship and α 2 is a constant this study obtains the parameters using the least square method harris 1998 33 α 1 0 274 tan β 0 538 34 α 2 0 371 therefore the empirical formula for the maximum wave setup becomes 35 η max h 0 r m s 0 274 tan β 0 538 h 0 r m s l 0 0 371 after further simplification eq 35 becomes the following 36 η max 0 274 h 0 r m s 0 629 l 0 0 371 tan β 0 538 using h 0 r m s h 0 s 2 eq 36 can be converted to a formula in terms of h 0 s 37 η max 0 220 h 0 s 0 629 l 0 0 371 tan β 0 538 4 formula evaluation 4 1 comparison with experimental measurements this subsection compares eq 36 with data collected from the different laboratory experiments listed in table 5 wave setup formulas developed from the literature are also compared to examine the feasibility of the formula developed in the present paper fig 7 shows that eq 36 agrees with the laboratory data the experimental maximum wave setup was slightly underestimated by holman and sallenger 1985 and stockdon et al 2006 but was clearly overestimated by hanslow and nielsen 1992 the formula of guza and thornton 1981 produces results comparable to the data for high wave setups but produces overestimates for low wave setups table 6 presents quantitative comparisons based on the five variables i a cc mbe rmse and rrmse the i a value of the present formula is as high as 0 99 which is greater than those of previous formulas ranging from 0 73 to 0 97 the cc between the data and the present formula is 0 99 comparable to those presented by holman and sallenger 1985 and stockdon et al 2006 and higher than those of guza and thornton 1981 0 85 and hanslow and nielsen 1992 0 94 the mbe of the present formula is negligibly small the rmse and rrmse values are 10 3 m and 0 12 respectively these are much smaller than those of previously proposed formulas 4 2 comparison with field measurements the present study also compares eq 36 with field measurements collected by hanslow and nielsen 1992 from sites along the new south wales coast because the beach slope is non uniform hanslow and nielsen 1992 gave an approximate range of profile slopes this paper uses the mean slope in the comparison fig 8 shows the performance of different empirical formulas in determining maximum wave setup overall the formula in this study shows good agreement with the data and performs better than the formula of guza and thornton 1981 which underestimates the wave setup compared with the observations the formulas of holman and sallenger 1985 and stockdon et al 2006 are satisfactory for steep slopes but underestimate the wave setup for gently sloping beaches brunswick beach and seven mile beach as with the laboratory data comparison table 7 presents detailed comparisons based on statistical measures the i a value of the present formula is 0 74 which is greater than those of previous formulas except for the formula of hanslow and nielsen 1992 0 82 the cc of the present formula 0 71 is greater than those of the other formulas the rmse and rrmse values of the present formula are 0 31 m and 0 33 respectively these two statistical values however are higher than those of hanslow and nielsen 1992 overall the formula of hanslow and nielsen 1992 seems to be slightly better than the formula of the present study this superiority seems obvious because these authors developed their formula from the field data used here whereas the present formula is independent of the data the slope data provided by hanslow and nielsen 1992 are approximate this research also evaluates the proposed formula using another more accurate dataset collected by stockdon and holman 2011 fig 9 shows the comparisons of different empirical formulas and field measurements the new formulation yields better agreement the observations of wave setup were clearly underestimated by guza and thornton 1981 but were overestimated by holman and sallenger 1985 table 7 presents the comparison of statistics for different formulas the i a and cc values of the present formula are 0 85 and 0 76 respectively which are greater than those of previous formulas the mbe of the present formula 0 02 m is negligibly small at field scale the rmse and rrmse values of the present formula are 0 19 m and 0 33 respectively which are smaller than those of the other formulas the quantitative comparisons above show that the formula proposed in the present study is better than previous formulations including the formula of stockdon et al 2006 which was developed using the same data 5 discussion based on a coupled wave current model system the present study proposed a new maximum wave setup formula and evaluated it against experimental and field measurements however the authors of this study recognize certain limitations of this approach this section also discusses the comparisons between eq 36 and the formulations of holman and sallenger 1985 and stockdon et al 2006 first this research developed the formula based on model results under idealized conditions by simulating a wide range of wave conditions table 4 and including the effects of wave breaking bottom friction wave current interaction and surface rollers certain model simplifications were present in this approach for instance the idealized cases used a uniform planar slope and did not consider complex bottom topography similarly the development process limited the formula to the cross shore only and used the jonswap spectrum to specify waves at the offshore boundary these factors may be important for wave setup at the shoreline in certain cases hsu et al 2006 guza and feddersen 2012 cox et al 2013 cohn and ruggiero 2016 park and cox 2016 some model parameters e g bottom friction in swan are tunable and may have significant effects on wave propagation to influence the wave setup sections 2 4 and 3 have applied the default or same moderate parameters table 2 in all model simulations this treatment may influence the accuracy for different cases overall the purpose of this paper is to provide a general formula that can be used for practical applications and rapid computability in the real world simple empirical formulas may not reflect complex physical processes such as nonlinear wave and current effects in certain cases e g complex bathymetry varied shoreline geometry structure and strong current effects the numerical model would provide more accurate results although it may require a longer computation time and more detailed input information second figs 7 9 show that the formulations of holman and sallenger 1985 and stockdon et al 2006 also perform well considering the allowed error range these two formulas and eq 36 are similar in terms of three essential factors wave height wavelength and beach slope are included in the formulations holman and sallenger 1985 and stockdon et al 2006 proposed that the maximum wave setup may be directly proportional to ξ 0 eqs 5 and 7 that is the relationship between the maximum wave setup and beach slope is linear in the numerical model of this study the maximum wave setup varies with the breaker index calculated by the modified goda formula as shown in eqs 11 and 12 therefore the maximum wave setup would have a nonlinear relationship with the slope the empirical formula developed from the simulated results of the coupled model system certainly shows a weak nonlinear relationship between the maximum wave setup and beach slope the maximum wave setup is approximately proportional to the square root of the slope the present formula indicates that the wave height is dominant compared to the wavelength however the formulations of holman and sallenger 1985 and stockdon et al 2006 are associated with the iribarren parameter indicating wave height and wavelength are equally important for the maximum wave setup this factor is an obvious difference between the formula of this study and previous formulas following lhs the cross shore gradient of the radiation stress which is primarily influenced by the wave height drives the wave setup therefore wave height seems to be a more important factor relative to wavelength or period in determining the wave setup 6 conclusions the present study developed an empirical formula for the maximum wave setup from a coupled wave current model system based on swan and fvcom the study first evaluated the coupled model system using wave height and mean water level data collected from laboratory and field experiments covering a broad range of wave conditions the root mean squared errors of the mean water level between the data and the counterparts from the model are less than 0 01 m and the correlation coefficients are usually higher than 0 93 this study then used the model results based on a series of practical wave conditions to develop an empirical formula for the maximum wave setup via the least square method the final formation of the proposed formula is η max 0 274 h 0 r m s 0 629 l 0 0 371 tan β 0 538 where h 0 r m s h 0 s 2 is the root mean square wave height for random waves in deep water l 0 is the wavelength in deep water obtained using the peak wave period and β is the angle of the beach slope the structure of the formula is similar to that of formulas in many previous studies but the parameter values are different specifically the proposed formula shows a weak nonlinear relationship between the maximum wave setup and the beach slope and wave height is a more important factor than the wavelength in determining the wave setup using experimental and field measurements the authors of this paper evaluated the proposed formula the two independent field datasets cover wave heights of 0 25 4 30 m wave periods of 3 7 17 0 s and beach slopes of 0 01 0 16 the root mean squared errors between the formula and the two sets of field observations are 0 31 and 0 19 m and the relative root mean squared errors for both are 0 33 the proposed formula can account for most of the observed maximum wave setup in addition this study compared the present formula to previous formulas based on experimental and field data the present formula is more reliable in terms of widespread applicability than previously proposed formulas the new empirical formula might not be applicable to complex geophysical conditions e g in front of a stiff wall structure or varied shoreline geometry future work will consider more practical wave current and topographic conditions e g obliquely incident waves and complex bathymetry acknowledgments the national key research and development program of china grant no 2017yfc1404200 the science fund for creative research groups of the national natural science foundation of china grant no 51621092 and the open fund of the state key laboratory of hydraulic engineering simulation and safety tianjin university grant no hess 1514 supported this research the authors thank the anonymous reviewers for their constructive comments especially the suggestion of using the available dataset of stockdon and holman 2011 
